!function(){"use strict";var e={380:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.services={}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addService=function(e,t){this.services[e]=t},e.prototype.getService=function(e){var t;return null!==(t=this.services[e])&&void 0!==t?t:null},e.prototype.getServices=function(){return this.services},e}();t.default=o},7:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FirefoxProxyGateway=t.ChromeProxyGateway=t.ServiceProvider=t.FirefoxNotificationsGateway=t.ChromeNotificationsGateway=t.FirefoxMessageGateway=t.ChromeMessageGateway=t.FirefoxContextMenuGateway=t.ChromeContextMenuGateway=t.FirefoxCookiesGateway=t.ChromeCookiesGateway=t.ChromeSchedule=t.ChromeTabsGateway=t.FirefoxWebrtcGateway=t.ChromeWebrtcGateway=t.ChromeStorageGateway=void 0;var r=n(o(677));t.ChromeStorageGateway=r.default;var a=n(o(572));t.ChromeWebrtcGateway=a.default;var i=n(o(230));t.FirefoxWebrtcGateway=i.default;var s=n(o(796));t.ChromeTabsGateway=s.default;var c=n(o(383));t.ChromeSchedule=c.default;var l=n(o(749));t.ChromeCookiesGateway=l.default;var u=n(o(818));t.FirefoxCookiesGateway=u.default;var h=n(o(724));t.ChromeContextMenuGateway=h.default;var d=n(o(952));t.FirefoxContextMenuGateway=d.default;var m=n(o(929));t.ChromeMessageGateway=m.default;var f=n(o(147));t.FirefoxMessageGateway=f.default;var g=n(o(533));t.ChromeNotificationsGateway=g.default;var b=n(o(496));t.FirefoxNotificationsGateway=b.default;var p=n(o(380));t.ServiceProvider=p.default;var w=n(o(683));t.ChromeProxyGateway=w.default;var y=n(o(773));t.FirefoxProxyGateway=y.default},724:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o,n,r,a){this.cookiesGateway=e,this.tabsGateway=t,this.storageGateway=o,this.config=n,this.whitelistGateway=r,this.urlParser=a,this.options={browsing:!0,cookies:!0,cached:!1}}return e.prototype.init=function(){this.whitelistGateway&&this.initContextMenus()},e.prototype.initContextMenus=function(){var e=this.config.get("contextMenusCookies"),t=navigator.language.split("-")[0];Object.keys(e).includes(t)||(t="en"),chrome.contextMenus.removeAll((function(){chrome.contextMenus.create({id:"tab_last_h",type:"normal",title:e[t].tab_last_h}),chrome.contextMenus.create({id:"tab_last_24h",type:"normal",title:e[t].tab_last_24h}),chrome.contextMenus.create({id:"tab_last_4w",type:"normal",title:e[t].tab_last_4w}),chrome.contextMenus.create({id:"tab_all_time",type:"normal",title:e[t].tab_all_time}),chrome.contextMenus.create({id:"separator1",type:"separator"}),chrome.contextMenus.create({id:"browser_last_h",type:"normal",title:e[t].browser_last_h}),chrome.contextMenus.create({id:"browser_last_24h",type:"normal",title:e[t].browser_last_24h}),chrome.contextMenus.create({id:"browser_last_4w",type:"normal",title:e[t].browser_last_4w}),chrome.contextMenus.create({id:"browser_all_time",type:"normal",title:e[t].browser_all_time}),chrome.contextMenus.create({id:"separator2",type:"separator"})})),this.whitlistMenu=chrome.contextMenus.create({id:"never_clear",type:"normal",title:e[t].never_clear}),chrome.contextMenus.onClicked.addListener((function(e,t){"tab_last_h"==e.menuItemId&&this.contextOption({type:"tab",timeframe:1}),"tab_last_24h"==e.menuItemId&&this.contextOption({type:"tab",timeframe:2}),"tab_last_4w"==e.menuItemId&&this.contextOption({type:"tab",timeframe:3}),"tab_all_time"==e.menuItemId&&this.contextOption({type:"tab",timeframe:4}),"browser_last_h"==e.menuItemId&&this.contextOption({type:"browser",timeframe:1}),"browser_last_24h"==e.menuItemId&&this.contextOption({type:"browser",timeframe:2}),"browser_last_4w"==e.menuItemId&&this.contextOption({type:"browser",timeframe:3}),"browser_all_time"==e.menuItemId&&this.contextOption({type:"browser",timeframe:4}),"never_clear"==e.menuItemId&&this.contextOption({type:"exeception",tab:t})}))},e.prototype.showContextMenuWhitelist=function(e){chrome.contextMenus.update(this.whitlistMenu,{visible:e})},e.prototype.contextOption=function(e){var t=this;if("exeception"===e.type){var o=this.urlParser.parse(e.tab.url);return this.whitelistGateway.add(o.domain),!0}Promise.all([this.storageGateway.get("checkedBrowsing"),this.storageGateway.get("checkedCookies"),this.storageGateway.get("checkedCache"),this.tabsGateway.getCurrentTab()]).then((function(o){var n=o[0],r=o[1],a=o[2],i=o[3],s=t.urlParser.parse(i[0].url);null!==n&&"1"===n?t.options.browsing=!0:null!==n&&(t.options.browsing=!1),null!==r&&"1"===r?t.options.cookies=!0:null!==r&&(t.options.cookies=!1),null!==a&&"1"===a?t.options.cached=!0:null!==a&&(t.options.cached=!1),"tab"===e.type&&t.cookiesGateway.clearCurrentTab(t.options,"."+s.domain,s.host,t.calculateTimeframe(e.timeframe)).then((function(e){t.tabsGateway.refreshTab(i[0].id)})).catch((function(e){console.log("Error in context menu clear TAB: ",e)})),"browser"===e.type&&t.cookiesGateway.clearBrowser(t.options,t.calculateTimeframe(e.timeframe)).then((function(e){t.tabsGateway.refreshTab(i[0].id)})).catch((function(e){console.log("Error in context menu clear BROWSER: ",e)}))}))},e.prototype.calculateTimeframe=function(e){switch(e){case 1:var t=36e5;break;case 2:t=864e5;break;case 3:t=24192e5;break;case 4:t=31536e7;break;default:t=36e5}return(new Date).getTime()-t},e}();t.default=o},952:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o,n,r,a){this.cookiesGateway=e,this.tabsGateway=t,this.storageGateway=o,this.config=n,this.whitelistGateway=r,this.urlParser=a,this.options={browsing:!0,cookies:!0,cached:!1}}return e.prototype.init=function(){this.whitelistGateway&&this.initContextMenus()},e.prototype.initContextMenus=function(){var e=this,t=this.config.get("contextMenusCookies"),o=navigator.language.split("-")[0];Object.keys(t).includes(o)||(o="en"),chrome.contextMenus.create({type:"normal",title:t[o].tab_last_h,onclick:function(t,o){e.contextOption({type:"tab",timeframe:1})}}),chrome.contextMenus.create({type:"normal",title:t[o].tab_last_24h,onclick:function(t,o){e.contextOption({type:"tab",timeframe:2})}}),chrome.contextMenus.create({type:"normal",title:t[o].tab_last_4w,onclick:function(t,o){e.contextOption({type:"tab",timeframe:3})}}),chrome.contextMenus.create({type:"normal",title:t[o].tab_all_time,onclick:function(t,o){e.contextOption({type:"tab",timeframe:4})}}),chrome.contextMenus.create({type:"separator"}),chrome.contextMenus.create({type:"normal",title:t[o].browser_last_h,onclick:function(t,o){e.contextOption({type:"browser",timeframe:1})}}),chrome.contextMenus.create({type:"normal",title:t[o].browser_last_24h,onclick:function(t,o){e.contextOption({type:"browser",timeframe:2})}}),chrome.contextMenus.create({type:"normal",title:t[o].browser_last_4w,onclick:function(t,o){e.contextOption({type:"browser",timeframe:3})}}),chrome.contextMenus.create({type:"normal",title:t[o].browser_all_time,onclick:function(t,o){e.contextOption({type:"browser",timeframe:4})}})},e.prototype.contextOption=function(e){var t=this;if("exeception"===e.type){var o=this.urlParser.parse(e.tab.url);return this.whitelistGateway.add(o.domain),!0}Promise.all([this.storageGateway.get("checkedBrowsing"),this.storageGateway.get("checkedCookies"),this.storageGateway.get("checkedCache"),this.tabsGateway.getCurrentTab()]).then((function(o){var n=o[0],r=o[1],a=o[2],i=o[3],s=t.urlParser.parse(i[0].url);null!==n&&"1"===n?t.options.browsing=!0:null!==n&&(t.options.browsing=!1),null!==r&&"1"===r?t.options.cookies=!0:null!==r&&(t.options.cookies=!1),null!==a&&"1"===a?t.options.cached=!0:null!==a&&(t.options.cached=!1),"tab"===e.type&&t.cookiesGateway.clearCurrentTab(t.options,"."+s.domain,s.host,t.calculateTimeframe(e.timeframe)).then((function(e){t.tabsGateway.refreshTab(i[0].id)})).catch((function(e){console.log("Error in context menu clear TAB: ",e)})),"browser"===e.type&&t.cookiesGateway.clearBrowser(t.options,t.calculateTimeframe(e.timeframe)).then((function(e){t.tabsGateway.refreshTab(i[0].id)})).catch((function(e){console.log("Error in context menu clear BROWSER: ",e)}))}))},e.prototype.calculateTimeframe=function(e){switch(e){case 1:var t=36e5;break;case 2:t=864e5;break;case 3:t=24192e5;break;case 4:t=31536e7;break;default:t=36e5}return(new Date).getTime()-t},e.prototype.showContextMenuWhitelist=function(e){},e}();t.default=o},749:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o,n,r){this.notificationsGateway=e,this.storageGateway=t,this.config=o,this.urlParser=n,this.whitelistGateway=r,this.notificationThreshold=5}return e.prototype.init=function(){},e.prototype.listCookiesTab=function(e,t){var o=0;return new Promise((function(n,r){chrome.cookies.getAll({domain:e},(function(r){for(var a=0;a<r.length;a++)r[a].domain!==e&&r[a].domain!==t||o++;n(o)}))}))},e.prototype.listCookiesBrowser=function(){return new Promise((function(e,t){chrome.cookies.getAll({},(function(t){e(t.length)}))}))},e.prototype.clearBrowser=function(e,t){var o=this,n=[".google.com"],r=this.whitelistGateway?{cacheStorage:e.cached,cookies:e.cookies,fileSystems:e.cached,indexedDB:e.cached,localStorage:e.cached,serviceWorkers:e.cached,webSQL:e.cached}:{appcache:e.cached,cache:e.cached,cacheStorage:e.cached,downloads:e.cached,history:e.history,cookies:e.cookies,fileSystems:e.cached,formData:e.cached,indexedDB:e.cached,localStorage:e.cached,pluginData:e.cached,webSQL:e.cached,serviceWorkers:e.cached};this.whitelistGateway&&(n=this.generateExlusionList());var a=this.whitelistGateway?{since:t,excludeOrigins:n}:{since:t};return new Promise((function(i,s){o.whitelistGateway&&chrome.browsingData.remove(a,r,(function(){chrome.history.search({text:"",startTime:t,maxResults:1e4},(function(t){for(var r=0,a=t;r<a.length;r++){var s=a[r],c=o.urlParser.parse(s.url);o.matchExludeDomains(c.domain,n)||chrome.history.deleteUrl({url:s.url},(function(){return!0}))}o.whitelistGateway&&(o.incrementClearedCounter(),o.setStorageDates(e,1,null)),i(!0)}))}))}))},e.prototype.clearCurrentTab=function(e,t,o,n){return this.incrementClearedCounter(),this.setStorageDates(e,0,o),Promise.all([this.clearCurrentTabCookies(e,t,o,n),this.clearCurrentTabHistory(e,t,o,n)])},e.prototype.clearCurrentTabCookies=function(e,t,o,n){return new Promise((function(n,r){var a=0;e.cookies?chrome.cookies.getAll({domain:t},(function(e){for(var r=0;r<e.length;r++)e[r].domain!==t&&e[r].domain!==o||(chrome.cookies.remove({url:"https://"+e[r].domain+e[r].path,name:e[r].name}),a++);n(a)})):n(a)}))},e.prototype.clearCurrentTabHistory=function(e,t,o,n){return new Promise((function(t,r){e.cookies?chrome.history.search({text:o,startTime:n,maxResults:1e4},(function(e){for(var o=0,n=e;o<n.length;o++){var r=n[o];chrome.history.deleteUrl({url:r.url},(function(){return!0}))}t(!0)})):t(!1)}))},e.prototype.addCookie=function(e,t,o){var n=this;return new Promise((function(r,a){var i=new Date;i.setHours(24,0,0,0);var s=Math.round(i.getTime()/1e3);chrome.cookies.set({url:e,name:t,value:o,secure:!0,domain:n.config.get("domain"),path:"/",expirationDate:s},(function(e){r({msg:!0})}))}))},e.prototype.getCookie=function(e){return void 0===e&&(e=null),new Promise((function(t,o){e?chrome.cookies.get(e,(function(e){t(e)})):o({error:!0})}))},e.prototype.generateExlusionList=function(){var e=[];return this.whitelistGateway.getAllSync().forEach((function(t){e.push("https://"+t),e.push("http://"+t)})),e},e.prototype.matchExludeDomains=function(e,t){for(var o=0;o<t.length;o++)if(t[o].includes(e))return!0;return!1},e.prototype.incrementClearedCounter=function(){var e=this;this.storageGateway.get("clearedCounter").then((function(t){var o=t?parseInt(t):0;o++,e.storageGateway.set("clearedCounter",o),o==e.notificationThreshold&&e.sendNotification()}))},e.prototype.sendNotification=function(){var e=this.config.get("notificationsCookies"),t=navigator.language.split("-")[0];Object.keys(e).includes(t)||(t="en"),this.notificationsGateway.create(e[t])},e.prototype.setStorageDates=function(e,t,o){var n=(new Date).getTime();e.browsing?(1===t?this.storageGateway.set("erasedBrowsingTimeBrowser",n.toString()):this.storageGateway.set("erasedBrowsingTime"+o,n.toString()),this.storageGateway.set("checkedBrowsing","1")):this.storageGateway.set("checkedBrowsing","0"),e.cookies?(this.storageGateway.set("erasedCookiesTime",n.toString()),this.storageGateway.set("checkedCookies","1")):this.storageGateway.set("checkedCookies","0"),e.cached?(1===t&&this.storageGateway.set("erasedCacheTime",n.toString()),this.storageGateway.set("checkedCache","1")):this.storageGateway.set("checkedCache","0")},e}();t.default=o},818:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o,n,r){this.notificationsGateway=e,this.storageGateway=t,this.config=o,this.urlParser=n,this.whitelistGateway=r,this.notificationThreshold=5}return e.prototype.init=function(){},e.prototype.listCookiesTab=function(e,t){var o=0;return new Promise((function(n,r){browser.cookies.getAll({domain:e}).then((function(r){for(var a=0;a<r.length;a++)r[a].domain!==e&&r[a].domain!==t||o++;n(o)}))}))},e.prototype.listCookiesBrowser=function(){return new Promise((function(e,t){browser.cookies.getAll({}).then((function(t){e(t.length)}))}))},e.prototype.clearBrowser=function(e,t){return this.whitelistGateway&&(this.incrementClearedCounter(),this.setStorageDates(e,1,null)),browser.browsingData.remove({since:t},{cache:e.cached,cookies:e.cookies,formData:e.cached,history:e.history,indexedDB:e.cached,serviceWorkers:e.cached})},e.prototype.addCookie=function(e,t,o){var n=this;return new Promise((function(r,a){var i=new Date;i.setHours(24,0,0,0);var s=Math.round(i.getTime()/1e3);chrome.cookies.set({url:e,name:t,value:o,secure:!0,domain:n.config.get("domain"),path:"/",expirationDate:s},(function(e){r({msg:!0})}))}))},e.prototype.getCookie=function(e){return void 0===e&&(e=null),new Promise((function(t,o){e?chrome.cookies.get(e,(function(e){t(e)})):o({error:!0})}))},e.prototype.clearCurrentTab=function(e,t,o,n){return this.incrementClearedCounter(),this.setStorageDates(e,0,o),Promise.all([this.clearCurrentTabCookies(e,t,o,n),this.clearCurrentTabHistory(e,t,o,n)])},e.prototype.clearCurrentTabCookies=function(e,t,o,n){return new Promise((function(n,r){var a=0;e.cookies?browser.cookies.getAll({domain:t}).then((function(e){for(var r=0;r<e.length;r++)e[r].domain!==t&&e[r].domain!==o||(browser.cookies.remove({url:"https://"+e[r].domain+e[r].path,name:e[r].name}).then(),a++);n(a)})):n(a)}))},e.prototype.clearCurrentTabHistory=function(e,t,o,n){return new Promise((function(t,r){e.cookies?browser.history.search({text:o,startTime:n,maxResults:1e4}).then((function(e){for(var o=0,n=e;o<n.length;o++){var r=n[o];chrome.history.deleteUrl({url:r.url},(function(){return!0}))}t(!0)})):t(!1)}))},e.prototype.sendNotification=function(){var e=this.config.get("notificationsCookies"),t=navigator.language.split("-")[0];Object.keys(e).includes(t)||(t="en"),this.notificationsGateway.create(e[t])},e.prototype.incrementClearedCounter=function(){var e=this;this.storageGateway.get("clearedCounter").then((function(t){var o=t?parseInt(t):0;o++,e.storageGateway.set("clearedCounter",o),o==e.notificationThreshold&&e.sendNotification()}))},e.prototype.setStorageDates=function(e,t,o){var n=(new Date).getTime();e.browsing?(1===t?this.storageGateway.set("erasedBrowsingTimeBrowser",n.toString()):this.storageGateway.set("erasedBrowsingTime"+o,n.toString()),this.storageGateway.set("checkedBrowsing","1")):this.storageGateway.set("checkedBrowsing","0"),e.cookies?(this.storageGateway.set("erasedCookiesTime",n.toString()),this.storageGateway.set("checkedCookies","1")):this.storageGateway.set("checkedCookies","0"),e.cached?(1===t&&this.storageGateway.set("erasedCacheTime",n.toString()),this.storageGateway.set("checkedCache","1")):this.storageGateway.set("checkedCache","0")},e}();t.default=o},929:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(o(383)),a=n(o(380)),i=function(){function e(e){this.commandListener=e,this.browserSchedule=new r.default,this.serviceProvider=a.default.getInstance()}return e.prototype.send=function(){chrome.runtime.sendMessage("hello",(function(e){}))},e.prototype.listen=function(){var e=this;chrome.runtime.onMessage.addListener((function(t,o,n){var r,a,i,s;t.command&&(a=(r=t.command.split(":"))[0],i=r[1],s=t.args?t.args:[],e.callService(a,i,s).then((function(e){n({message:"ok",payload:e})})).catch((function(e){n({message:"error",error:e})})));return t.subject&&e.callAction(t),!0}))},e.prototype.callAction=function(e){return this.commandListener.hasOwnProperty(e.subject)?this.commandListener[e.subject](e):new Promise((function(e,t){t("CommandListener or method not found")}))},e.prototype.init=function(){this.listen()},e.prototype.callService=function(e,t,o){var n;return void 0===o&&(o=[]),this.serviceProvider.getService(e)&&"function"==typeof this.serviceProvider.getService(e)[t]?(n=this.serviceProvider.getService(e))[t].apply(n,o):new Promise((function(e,t){t("Sevice or method not found")}))},e}();t.default=i},147:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.send=function(){chrome.runtime.sendMessage("hello",(function(e){}))},e.prototype.listen=function(){chrome.runtime.onMessage.addListener((function(e,t,o){e.command,o({message:"Aye!"})}))},e.prototype.init=function(){this.listen()},e}();t.default=o},533:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(o(380)),a=n(o(677)),i=function(){function e(e,t,o){this.tabsGateway=e,this.browserSchedule=t,this.configNotification=o,this.storageGateway=new a.default,this.serviceProvider=r.default.getInstance()}return e.prototype.create=function(e){var t=this;return new Promise((function(o,n){var r,a=[];e.yes_btn&&a.push({title:e.yes_btn}),e.no_btn&&a.push({title:e.no_btn}),chrome.notifications.create("",{type:"basic",iconUrl:chrome.runtime.getURL(t.configNotification.urlPath),title:e.title?e.title:"Extension",message:e.message?e.message:"Extension",buttons:a},(function(e){r=e})),chrome.notifications.onButtonClicked.addListener((function(o,n){o===r&&0===n&&e.link&&(e.link.includes(t.configNotification.optionLink)?t.serviceProvider.getService("cookiesGateway").addCookie(e.link,t.configNotification.trailStart,Buffer.from(JSON.stringify(t.configNotification.cookieValue)).toString("base64")).then((function(){t.serviceProvider.getService("tabsGateway").openTab(e.link)})):t.tabsGateway.openTab(e.link))})),chrome.notifications.onClicked.addListener((function(){e.link&&(e.link.includes(t.configNotification.optionLink)?t.browserSchedule.create("openStartTrial",{delayInMinutes:0}):t.tabsGateway.openTab(e.link))})),chrome.notifications.onClosed.addListener((function(){}))}))},e}();t.default=i},496:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(o(677)),a=function(){function e(e,t,o){this.tabsGateway=e,this.browserSchedule=t,this.configNotification=o,this.storageGateway=new r.default}return e.prototype.create=function(e){var t=this;return new Promise((function(o,n){var r="test";browser.notifications.create(r,{type:"basic",iconUrl:chrome.runtime.getURL(t.configNotification.urlPath),title:e.title?e.title:"Extension",message:e.message?e.message:"Extension"}),browser.notifications.onClicked.addListener((function(){e.link&&(e.link.includes(t.configNotification.optionLink)?(t.storageGateway.set("linkAlert",e.link),t.browserSchedule.create("openStartTrial",{delayInMinutes:0})):t.tabsGateway.openTab(e.link)),browser.notifications.clear(r).then((function(){}))})),browser.notifications.onButtonClicked.addListener((function(e,t){browser.notifications.clear(e)}))}))},e}();t.default=a},683:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var o,n,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{o=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__spreadArray||function(e,t){for(var o=0,n=t.length,r=e.length;o<n;o++,r++)e[r]=t[o];return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(o(380)),c=i(o(346)),l=function(){function e(e,t,o,n,r,a,i,l,u,h,d){var m=this;this.notificationsGateway=e,this.storageGateway=t,this.webrtcGateway=o,this.tabsGateway=n,this.config=r,this.logger=a,this.icons=i,this.urlParser=l,this.feedbackComponent=u,this.http=h,this.elasticSearchComponent=d,this.fallbackErrorActive=!1,this.authHandler=function(){return--m.retry<0?{cancel:!0}:{authCredentials:{username:m.device.token,password:m.device.tokenSecret}}},this.errorHandler=function(e){m.fallbackErrorCounter++,m.currentTabUrl&&!m.fallbackErrorActive&&m.fallbackErrorCounter>20&&m.noOfAttempts<5?(m.fallbackErrorActive=!0,console.log("RETRY CONNECTION"),m.logger.log("FAILED: ",m.proxyConnected),m.elasticSearchComponent&&m.elasticSearchComponent.add({event:"Proxy node failed",proxy_error:e.error,attempt:m.noOfAttempts}),m.noOfAttempts++,m.connect(m.countryConnected,m.excludedPagesOnConnect,m.typeConnected).then((function(){m.fallbackErrorActive=!1}))):(console.log("PENDING CONNECTION"),m.logger.log("ERROR: ",e.error))},this.errorNavigationHandler=function(e){m.activeConnection&&e.error.includes("ERR_PROXY_CERTIFICATE_INVALID")&&(console.log("RETRY CONNECTION"),m.connect(m.countryConnected,m.excludedPagesOnConnect,m.typeConnected).then((function(){m.fallbackErrorActive=!1})))},this.pacengine=new c.default(this.config,this.urlParser),this.rules=[],this.useRules=!1,this.whitelist=[],this.useWhitelist=!1,this.locations=[],this.excludedPagesOnConnect=[],this.typeConnected="browsing",this.activeConnection=!1,this.alwaysActive=!1,this.blockchainConnected=!1,this.smartLocationConnected=!1,this.device=null,this.noOfAttempts=0,this.currentTabUrl="",this.checkWhitelisted={},this.restoredConnection=!1,this.serviceProvider=s.default.getInstance(),this.proxySettingsConfig=this.config.get("proxySettings")}return e.prototype.init=function(){var e=this;return new Promise((function(t){e.disconnect().then((function(){return e.restoreConnection()})),e.initListeners(),t({msg:!0})}))},e.prototype.initListeners=function(e){return void 0===e&&(e=null),n(this,void 0,void 0,(function(){var e=this;return r(this,(function(t){return chrome.tabs.onActivated.addListener((function(t){e.reinitialize(),setTimeout((function(){(e.activeConnection||e.smartLocationConnected)&&e.setIconState(t.tabId)}),200)})),chrome.tabs.onUpdated.addListener((function(t,o,n){e.reinitialize(),n.active&&"complete"!==o.status&&n&&(e.fallbackErrorCounter=0,e.retry=10,e.setIconState(t))})),[2]}))}))},e.prototype.connect=function(e,t,o){var n=this;void 0===t&&(t=[]),void 0===o&&(o="browsing");var r=this.proxySettingsConfig.allPromisesArrayConnect.promises;t=t||[],this.storeConnectionProperties(e,t,o),t=a(a(a([],t),this.config.get("localDomains")),this.config.get("privateNetworks"));var i;i="browsing"===o?this.storageGateway.get("browsingServers"):this.storageGateway.get("streamingServers"),this.elasticSearchComponent&&this.elasticSearchComponent.add({category:"traffic",event:"Connection attempt"});var s=[i],c=["locations"];return this.proxySettingsConfig.allPromisesArrayConnect&&(c.push.apply(c,this.proxySettingsConfig.allPromisesArrayConnect.responses),r.map((function(e){s.push(n.storageGateway.get(e))}))),new Promise((function(o,r){Promise.all(s).then((function(i){var s={};if(c.map((function(e,t){s[e]=i[t]})),c.includes("device")&&!s.device)return r("Invalid device"),!1;if(!s.locations)return r("No locations for the moment"),!1;n.config.get("additionalLocations").length&&(s.locations=s.locations.concat(n.config.get("additionalLocations"))),n.locations=s.locations,c.includes("useRules")&&(n.useRules=s.useRules,n.storageGateway.set("useRulesProxy",n.useRules)),c.includes("device")&&(n.device=s.device),n.retry=10,c.includes("enabledWhitelist")&&(n.useWhitelist=s.enabledWhitelist,s.enabledWhitelist&&(s.whitelist=s.whitelist||[],t=a(a([],t),s.whitelist),n.whitelist=s.whitelist));var l=null;if(n.useRules){n.rules=s.rules,"string"==typeof n.rules&&(n.rules=JSON.parse(n.rules));var u=n.pacengine.getNodeDictFromLocations(s.locations,[]),h=n.pacengine.exportPAC(e,u,n.rules,t);l={value:{mode:"pac_script",pacScript:{data:h}},scope:"regular"}}else{var d=s.locations.find((function(t){return t.name===e}));if(!d)return r("Location not found"+e),!1;var m=d.nodes[Math.floor(Math.random()*d.nodes.length)],f=m.dnsname.split(":"),g=f[0],b=f[1],p={value:{mode:"fixed_servers",rules:{singleProxy:{scheme:"https",host:g,port:Number(b)||443},bypassList:a([],t)}},scope:"regular"};n.proxyConnected=m,l=p}return chrome.proxy.settings.set(l,(function(e){if(n.logger.log("proxy connected: ",l),n.restoredConnection&&(n.restoredConnection=!1),n.elasticSearchComponent){var t=(new Date).getTime();n.http.get(""+n.proxySettingsConfig.pingUrl+t).then((function(){n.elasticSearchComponent.add({category:"traffic",event:"Connection established"})}),(function(){n.elasticSearchComponent.add({category:"traffic",event:"Connection failed",error:"No internet"})}))}n.storageGateway.get("firstConnection").then((function(e){!e&&n.feedbackComponent&&(n.feedbackComponent.sendConnectionEvent(),n.storageGateway.set("firstConnection",1),n.elasticSearchComponent&&n.elasticSearchComponent.add({category:"traffic",event:"First connection"}))}))})),"DEFAULT"!==e?n.activeConnection=!0:n.smartLocationConnected=!0,n.blockchainConnected=!1,n.tabsGateway.getCurrentTab().then((function(e){e[0]&&n.setIconState(e[0].id)})),n.webrtcGateway.disableWebRTC(),n.fallbackErrorCounter=0,chrome.proxy.onProxyError.addListener(n.errorHandler),o({message:!0})})).catch((function(e){return r("Promise all failed"),!1}))}))},e.prototype.disconnect=function(e){var t=this;return void 0===e&&(e=!0),new Promise((function(o,n){chrome.proxy.settings.set({value:{mode:"direct"},scope:"regular"},(function(e){console.log("-- connection disabled")})),t.device=null,t.activeConnection=!1,t.blockchainConnected=!1,t.useRules=!!e&&t.useRules,t.storageGateway.set("useRulesProxy",t.useRules),chrome.proxy.onProxyError.removeListener(t.errorHandler),t.tabsGateway.getCurrentTab().then((function(e){e[0]&&t.setIconState(e[0].id)})),t.fallbackErrorActive||(t.noOfAttempts=0),t.useRules&&t.connect("DEFAULT",t.excludedPagesOnConnect,t.typeConnected),o({message:!0})}))},e.prototype.connectFixed=function(e,t){var o=this,n=this.proxySettingsConfig.connectFixed.rules;return new Promise((function(r,a){var i=e.split(":"),s=i[0],c=i[1],l={GB:"HTTPS "+s+":"+(c?c.trim():443)},u=n;"string"==typeof u&&(u=JSON.parse(u));var h={value:{mode:"pac_script",pacScript:{data:o.pacengine.exportPAC("DEFAULT",l,u,t)}},scope:"regular"};chrome.proxy.settings.set(h,(function(e){o.blockchainConnected=!0,console.log("-- connection enabled");var t=(new Date).getTime();o.elasticSearchComponent&&o.http.get(""+o.proxySettingsConfig.pingUrl+t).then((function(){o.elasticSearchComponent.add({category:"Blockchain Fallback",event:"Connection established"})}),(function(){o.elasticSearchComponent.add({category:"Blockchain Fallback",event:"Connection failed",error:"No internet"})})),o.storageGateway.set("fallbackConnected","1"),r({message:!0})}))}))},e.prototype.removeNode=function(e,t){var o=this;return new Promise((function(n,r){var a=o.locations.find((function(e){return e.name===t})),i=a.nodes.findIndex((function(t){return t===e}));a.nodes.splice(i,1)}))},e.prototype.getCurrentState=function(e,t){var o=this.pacengine.getProxyStateByURL(e,t.host,this.rules),n=!1;this.useWhitelist&&this.whitelist.map((function(e){e.includes(t.domain)&&t.domain.length>0&&(n=!0)}));var r={isDefault:"DEFAULT"===o,isLocal:"LOCAL"===o,isDirect:"OFF"===o,whitelist:n,isRuleActive:!1,customCountry:null};return r.isRuleActive=!(r.isDefault||r.isLocal),r.isRuleActive&&!r.isDirect&&(r.customCountry=o),r},e.prototype.reinitialize=function(){return n(this,void 0,void 0,(function(){var e,t,o,n,a,i,s,c,l;return r(this,(function(r){switch(r.label){case 0:return e=this,[4,this.storageGateway.get("whitelist")];case 1:return e.whitelist=r.sent(),t=this,[4,this.storageGateway.get("rules")];case 2:return t.rules=r.sent(),o=this,[4,this.storageGateway.get("device")];case 3:return o.device=r.sent(),n=this,[4,this.storageGateway.get("countryConnected")];case 4:return n.countryConnected=r.sent(),a=this,[4,this.storageGateway.get("useRulesProxy")];case 5:return a.useRules=r.sent(),i=this,[4,this.storageGateway.get("activeConnection")];case 6:return i.activeConnection=r.sent(),s=this,[4,this.storageGateway.get("alwaysActive")];case 7:return s.alwaysActive=r.sent(),c=this,[4,this.storageGateway.get("smartLocationConnected")];case 8:return c.smartLocationConnected=r.sent(),l=this,[4,this.storageGateway.get("enabledWhitelist")];case 9:return l.useWhitelist=r.sent(),"string"==typeof this.rules&&(this.rules=JSON.parse(this.rules)),[2]}}))}))},e.prototype.setIconState=function(e){return n(this,void 0,void 0,(function(){var t=this;return r(this,(function(o){return chrome.tabs.get(e,(function(e){if(t.currentTabUrl=e.url.startsWith("chrome://")?null:e.url,e.url){var o=t.urlParser.parse(e.url),n=t.getCurrentState(e.url,o);t.useRules&&n.isRuleActive&&!n.isDirect?(t.icons.setIconBadge(n.customCountry),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",n.customCountry)):t.useRules&&n.isRuleActive&&n.isDirect?(t.icons.setIconBadge("off"),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected","OFF")):t.activeConnection&&t.useWhitelist&&n.whitelist?(t.icons.setIconBadge("off"),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",null)):t.activeConnection&&!n.isDirect?(t.icons.setIconBadge(t.countryConnected),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",null)):t.device?(t.icons.setIconBadge(""),t.icons.setIconImage("disabled"),t.storageGateway.set("smartLocationConnected",null)):(t.icons.setIconBadge(""),t.icons.setIconImage("signedout"),t.storageGateway.set("smartLocationConnected",null))}})),[2]}))}))},e.prototype.toggleRules=function(e,t){var o=this;return void 0===t&&(t="smartLocation"),new Promise((function(n,r){o.activeConnection?o.connect(o.countryConnected,o.excludedPagesOnConnect,o.typeConnected):e&&"smartLocation"===t?o.connect("DEFAULT",o.excludedPagesOnConnect,o.typeConnected):o.disconnect(!1)}))},e.prototype.toggleWebRTC=function(e){return n(this,void 0,void 0,(function(){var t,o=this;return r(this,(function(n){switch(n.label){case 0:return t=this,[4,this.storageGateway.get("alwaysActive")];case 1:return t.alwaysActive=n.sent(),e?this.webrtcGateway.checkPermission().then((function(e){return e?((o.activeConnection||o.alwaysActive)&&o.webrtcGateway.disableWebRTC(),!0):(o.storageGateway.set("webrtcProtection",!1),!1)})):this.webrtcGateway.enableWebRTC(),[2]}}))}))},e.prototype.storeConnectionProperties=function(e,t,o){this.countryConnected=e,this.storageGateway.set("countryConnected",this.countryConnected),this.excludedPagesOnConnect=t,this.typeConnected=o},e.prototype.restoreConnection=function(){var e=this,t=this.proxySettingsConfig.allPromisesArrayFixConnect.promises,o=[],n=[];return this.proxySettingsConfig.allPromisesArrayFixConnect&&(n.push.apply(n,this.proxySettingsConfig.allPromisesArrayFixConnect.responses),t.map((function(t){o.push(e.storageGateway.get(t))}))),new Promise((function(t,r){Promise.all(o).then((function(t){var o={};if(n.map((function(e,n){o[e]=t[n]})),n.includes("device")){if(!o.device)return e.device=null,e.icons.setIconBadge(""),e.icons.setIconImage("signedout"),!1;e.device=o.device}1===o.activeConnection&&o.countrycode?(o.pageExcludes=o.pageExcludes||[],o.type=o.type||"browsing",e.connect(o.countrycode,o.pageExcludes,o.type).then((function(){new Date}))):o.enabledRules&&e.connect("DEFAULT",o.pageExcludes,"browsing").then()}))}))},e}();t.default=l},773:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var o,n,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{o=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__spreadArray||function(e,t){for(var o=0,n=t.length,r=e.length;o<n;o++,r++)e[r]=t[o];return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(o(346)),c=function(){function e(e,t,o,n,r,a,i,c,l,u,h){var d=this;this.notificationsGateway=e,this.storageGateway=t,this.webrtcGateway=o,this.tabsGateway=n,this.config=r,this.logger=a,this.icons=i,this.urlParser=c,this.elasticSearchComponent=l,this.feedbackComponent=u,this.http=h,this.ffProxyInfo={type:"direct",host:null,port:null},this.fallbackErrorActive=!1,this.authHandler=function(e){return--d.retry<0?{cancel:!0}:{authCredentials:{username:d.device.token,password:d.device.tokenSecret}}},this.handleProxyRequest=function(e){var t=new URL(e.url).origin,o=d.urlParser.parse(t);return d.whitelist.includes(o.host)?{type:"direct"}:d.ffProxyInfo},this.errorHandler=function(e){d.fallbackErrorCounter++,d.currentTabUrl&&!d.fallbackErrorActive&&d.fallbackErrorCounter>5&&d.noOfAttempts<5?(d.fallbackErrorActive=!0,console.log("RETRY CONNECTION"),d.noOfAttempts++,d.elasticSearchComponent&&d.elasticSearchComponent.add({event:"Proxy node failed",proxy_error:e.error,attempt:d.noOfAttempts}),d.connect(d.countryConnected,d.excludedPagesOnConnect,d.typeConnected).then((function(){d.fallbackErrorActive=!1,d.tabsGateway.refreshCurrentTab()}))):console.log("PENDING CONNECTION")},this.rules=[],this.checkWhitelisted={},this.whitelist=[],this.locations=[],this.nodeDict={},this.useRules=!1,this.useWhitelist=!1,this.activeConnection=!1,this.blockchainConnected=!1,this.pacengine=new s.default(this.config,this.urlParser),this.noOfAttempts=0,this.currentTabUrl=null,this.restoredConnection=!1,this.ffProxyInfo={type:"direct",host:null,port:null},this.init(),this.proxySettingsConfig=this.config.get("proxySettings")}return e.prototype.init=function(){var e=this;return new Promise((function(t){return e.disconnect().then((function(){return e.restoreConnection()})),chrome.tabs.onUpdated.addListener((function(t,o,n){if((e.activeConnection||e.blockchainConnected)&&n.active&&"complete"!==o.status&&n){var r=e.getCurrentState(n.url);if(e.useRules&&r.isRuleActive&&!r.isDirect){var a=null;if(e.nodeDict[r.customCountry])a=e.nodeDict[r.customCountry];else{var i=e.locations.find((function(e){return e.name===r.customCountry}));a=i.nodes[Math.floor(Math.random()*i.nodes.length)].dnsname}var s=a.split(":"),c=s[0],l=s[1];e.ffProxyInfo={type:"https",host:c,port:Number(l)||443},e.storageGateway.get("tab_rule_"+n.id).then((function(t){t!==r.customCountry&&e.storageGateway.set("tab_rule_"+n.id,r.customCountry).then((function(){chrome.tabs.reload(n.id)}))})).catch((function(){e.storageGateway.set("tab_rule_"+n.id,r.customCountry).then((function(){chrome.tabs.reload(n.id)}))}))}else if(e.useRules&&r.isRuleActive&&r.isDirect||e.useWhitelist&&r.whitelist)e.ffProxyInfo={type:"direct",host:null,port:null};else if(e.defaultNode){var u=e.defaultNode.dnsname.split(":");c=u[0],l=u[1],e.ffProxyInfo={type:"https",host:c,port:Number(l)||443}}else e.ffProxyInfo={type:"direct",host:null,port:null};e.fallbackErrorCounter=0,e.retry=10,e.setIconState(t)}})),e.initListeners(),t({msg:!0})}))},e.prototype.initListeners=function(){var e=this;chrome.tabs.onActivated.addListener((function(t){setTimeout((function(){e.setIconState(t.tabId)}),200)}))},e.prototype.connect=function(e,t,o){var n=this;void 0===o&&(o="browsing");var r=this.proxySettingsConfig.allPromisesArrayConnect.promises;t=t||[],this.storeConnectionProperties(e,t,o),t=a(a(a([],t),this.config.get("localDomains")),this.config.get("privateNetworks"));var i=["browsing"===o?this.storageGateway.get("browsingServers"):this.storageGateway.get("streamingServers")],s=["locations"];return this.proxySettingsConfig.allPromisesArrayConnect&&(s.push.apply(s,this.proxySettingsConfig.allPromisesArrayConnect.responses),r.map((function(e){i.push(n.storageGateway.get(e))}))),this.elasticSearchComponent&&this.elasticSearchComponent.add({category:"traffic",event:"Connection attempt"}),new Promise((function(t,o){Promise.all(i).then((function(a){var i={};if(s.map((function(e,t){i[e]=a[t]})),s.includes("device")&&!i.device)return n.device=null,n.icons.setIconBadge(""),n.icons.setIconImage("signedout"),!1;if(!i.locations)return console.error("No locations for the moment"),o("No locations for the moment"),!1;n.config.get("additionalLocations").length&&(i.locations=i.locations.concat(n.config.get("additionalLocations"))),s.includes("useRules")&&(n.rules=i.rules,n.useRules=i.useRules),"string"==typeof n.rules&&(n.rules=JSON.parse(n.rules)),n.locations=i.locations;var c=i.locations.find((function(t){return t.name===e}));if(!c)return console.error("Location not found"),o("Location not found"),!1;s.includes("enabledWhitelist")&&(n.useWhitelist=i.enabledWhitelist,i.enabledWhitelist&&(i.whitelist=i.whitelist||[],n.whitelist=i.whitelist)),s.includes("device")&&(n.device=i.device),n.retry=10,browser.webRequest.onAuthRequired.addListener(n.authHandler,{urls:["<all_urls>"]},["blocking"]),r.includes("useRules")&&i.useRules&&(n.nodeDict=n.pacengine.getNodeDictFromLocations(i.locations,[],!0));var l=c.nodes[Math.floor(Math.random()*c.nodes.length)];n.defaultNode=l;var u=l.dnsname.split(":"),h=u[0],d=u[1];if(n.ffProxyInfo={type:"https",host:h,port:Number(d)||443},browser.proxy.onRequest.addListener(n.handleProxyRequest,{urls:["<all_urls>"]}),n.elasticSearchComponent){var m=(new Date).getTime();n.http.get(""+n.proxySettingsConfig.pingUrl+m).then((function(){n.elasticSearchComponent.add({category:"traffic",event:"Connection established"})}),(function(){n.elasticSearchComponent.add({category:"traffic",event:"Connection failed",error:"No internet"})}))}return n.restoredConnection&&(n.tabsGateway.refreshCurrentTab(),n.restoredConnection=!1),n.webrtcGateway.disableWebRTC(),n.tabsGateway.getCurrentTab().then((function(e){e[0]&&n.setIconState(e[0].id)})),n.storageGateway.get("firstConnection").then((function(e){!e&&n.feedbackComponent&&(n.feedbackComponent.sendConnectionEvent(),n.storageGateway.set("firstConnection",1),n.elasticSearchComponent&&n.elasticSearchComponent.add({category:"traffic",event:"First connection"}))})),n.activeConnection=!0,n.blockchainConnected=!1,n.proxyConnected=l,n.fallbackErrorCounter=0,browser.proxy.onError.addListener(n.errorHandler),t({message:!0})}))}))},e.prototype.disconnect=function(){var e=this;return new Promise((function(t,o){return e.ffProxyInfo={type:"direct",host:null,port:null},e.activeConnection=!1,e.blockchainConnected=!1,browser.proxy.onRequest.removeListener(e.handleProxyRequest),browser.webRequest.onAuthRequired.removeListener(e.authHandler),browser.proxy.onError.removeListener(e.errorHandler),e.webrtcGateway.enableWebRTC(),e.tabsGateway.getCurrentTab().then((function(t){t[0]&&e.setIconState(t[0].id)})),e.fallbackErrorActive||(e.noOfAttempts=0),e.activeConnection=!1,t({message:!0})}))},e.prototype.shouldProxyRequest=function(e){return-1!==e.parentFrameId},e.prototype.connectFixed=function(e,t){var o=this,n=this.proxySettingsConfig.connectFixed.rules;return this.proxySettingsConfig.pingUrl,new Promise((function(t,r){var a=e.split(":"),i=a[0],s=a[1];if(o.ffProxyInfo={type:"https",host:i,port:Number(s)||443},o.nodeDict={GB:i+":"+(s?s.trim():443)},o.rules=n,o.useRules=!0,o.blockchainConnected=!0,o.defaultNode=null,browser.proxy.onRequest.addListener(o.handleProxyRequest,{urls:["<all_urls>"]}),browser.proxy.onError.addListener((function(e){})),o.elasticSearchComponent){var c=(new Date).getTime();o.http.get(""+o.proxySettingsConfig.pingUrl+c).then((function(){o.elasticSearchComponent.add({category:"Blockchain Fallback",event:"Connection established"})}),(function(){o.elasticSearchComponent.add({category:"Blockchain Fallback",event:"Connection failed",error:"No internet"})}))}t({message:!0})}))},e.prototype.getCurrentState=function(e){var t=this.urlParser.parse(e),o=this.pacengine.getProxyStateByURL(e,t.host,this.rules),n=!1;if(this.useWhitelist)if(this.checkWhitelisted.hasOwnProperty(t.host))this.whitelist.includes(t.host)?n=!0:delete this.checkWhitelisted[t.host];else{delete this.checkWhitelisted[t.host];for(var r=0,a=this.whitelist;r<a.length;r++){var i="/([a-zA-Zd-]+.){0,}"+a[r]+"/",s=e.match(i);if(s)return this.checkWhitelisted[t.host]=s,void(n=!0);delete this.checkWhitelisted[t.host]}}var c={isDefault:"DEFAULT"===o,isLocal:"LOCAL"===o,isDirect:"OFF"===o,whitelist:n,isRuleActive:!1,customCountry:null};return c.isRuleActive=!(c.isDefault||c.isLocal),c.isRuleActive&&!c.isDirect&&(c.customCountry=o),c},e.prototype.setIconState=function(e){var t=this;chrome.tabs.get(e,(function(e){if(t.currentTabUrl=e.url.startsWith("about:")?null:e.url,e.url){var o=t.getCurrentState(e.url);t.activeConnection&&t.useRules&&o.isRuleActive&&!o.isDirect?(t.icons.setIconBadge(o.customCountry),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",o.customCountry)):t.activeConnection&&t.useRules&&o.isRuleActive&&o.isDirect?(t.icons.setIconBadge("off"),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected","OFF")):o.whitelist&&t.activeConnection?(t.icons.setIconBadge("off"),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",null)):t.activeConnection?(t.icons.setIconBadge(t.countryConnected),t.icons.setIconImage("enabled"),t.storageGateway.set("smartLocationConnected",null)):t.device?(t.icons.setIconBadge(""),t.icons.setIconImage("disabled"),t.storageGateway.set("smartLocationConnected",null)):(t.icons.setIconBadge(""),t.icons.setIconImage("signedout"),t.storageGateway.set("smartLocationConnected",null))}}))},e.prototype.toggleRules=function(e,t){var o=this;return void 0===t&&(t="smartLocation"),new Promise((function(e,t){o.activeConnection&&o.connect(o.countryConnected,o.excludedPagesOnConnect,o.typeConnected),e({message:!0})}))},e.prototype.toggleWebRTC=function(e){return n(this,void 0,void 0,(function(){var t,o=this;return r(this,(function(n){switch(n.label){case 0:return t=this,[4,this.storageGateway.get("alwaysActive")];case 1:return t.alwaysActive=n.sent(),e?this.webrtcGateway.checkPermission().then((function(e){return e?((o.activeConnection||o.alwaysActive)&&o.webrtcGateway.disableWebRTC(),!0):(o.storageGateway.set("webrtcProtection",!1),!1)})):this.webrtcGateway.enableWebRTC(),[2]}}))}))},e.prototype.storeConnectionProperties=function(e,t,o){this.countryConnected=e,this.excludedPagesOnConnect=t,this.typeConnected=o},e.prototype.restoreConnection=function(){var e=this,t=this.proxySettingsConfig.allPromisesArrayFixConnect.promises,o=[],n=[];return this.proxySettingsConfig.allPromisesArrayFixConnect&&(n.push.apply(n,this.proxySettingsConfig.allPromisesArrayFixConnect.responses),t.map((function(t){o.push(e.storageGateway.get(t))}))),new Promise((function(t,r){Promise.all(o).then((function(o){var r={};return n.map((function(e,t){r[e]=o[t]})),n.includes("device")&&!r.device?(e.device=null,e.icons.setIconBadge(""),e.icons.setIconImage("signedout"),!1):(1===r.activeConnection&&r.countrycode&&(r.pageExcludes=r.pageExcludes||[],r.type=r.type||"browsing",e.restoredConnection=!0,e.connect(r.countrycode,r.pageExcludes,r.type).then((function(){var t=new Date;e.storageGateway.set("dateConnected",t),e.tabsGateway.refreshCurrentTab()}))),t(!0))}))}))},e}();t.default=c},346:function(e,t,o){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.config=e,this.urlParser=t,this.engine=o(776),this.engine&&(this.engine=this.engine.engine),this.pacScriptRegexp="    e.data.IPv4NotationRE = "+this.engine.data.IPv4NotationRE.toString()+";\n    e.data.localIPsRE = "+this.engine.data.localIPsRE.toString()+";\n    "}return e.prototype.serializeEngineToString=function(e){e=e||this.engine;for(var t=[],o=0,n=Object.keys(e);o<n.length;o++){var r=n[o],a=e[r].toString();switch(typeof e[r]){case"function":this.checkIfArrowFunction(a)?t.push(r+": "+a):t.push(r+": function "+a);break;case"object":t.push(r+": "+JSON.stringify(e[r]))}}return"{ "+t.join(",")+" }"},e.prototype.checkIfArrowFunction=function(e){return!(!e.includes("=>")||e.includes("{"))||e.startsWith("function")},e.prototype.exportPAC=function(e,t,o,n){return o=o||[],n=n||[],"      /*Kape extensions*/\n      function FindProxyForURL(url, host) {\n\n        var e = "+this.serializeEngineToString(this.engine)+";\n        e.data.localDomains = e.data.localDomains.concat("+JSON.stringify(n)+");\n        "+this.pacScriptRegexp+"\n\n        e.data.defaultLocation = '"+e+"';\n        e.data.nodeDict = "+JSON.stringify(t)+";\n        e.data.rulesWithOverrides = "+JSON.stringify(this.engine.mergeRuleOverrides(o,this.config.get("ruleOverrides")))+";\n\n        var res = e._getProxyState(url, host, e.data.rulesWithOverrides);\n        var cc;\n        if (res === 'LOCAL' || res === 'DIRECT' || res === 'OFF') {return 'DIRECT'};\n        if (res === 'DEFAULT') {cc = e.data.defaultLocation} else {cc = res};\n        var override = e.matchNodeOverride(host, cc);\n        if (override) {cc = override};\n\n        return e.nodeLookup(e.data.nodeDict, cc) || 'DIRECT';\n      }      "},e.prototype.getProxyStateByURL=function(e,t,o){return o=o||[],t=t||this.urlParser.parse(e).host||e,this.engine._getProxyState(e,t,o)},e.prototype.getNodeDictFromLocations=function(e,t,o){void 0===o&&(o=null);for(var n={},r=0,a=e=e.concat(t);r<a.length;r++){var i=a[r],s=i.nodes.slice(0,15).map((function(e){var t=e.dnsname.split(":"),n=t[0],r=t[1];return o?n+":"+r:"HTTPS "+n+":"+(r?r.trim():443)}));n[i.name]=s[Math.floor(Math.random()*s.length)]}return n},e}();t.default=n},776:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.engine=void 0;var r=n(o(380)).default.getInstance(),a={localDomains:r.getService("config").get("localDomains"),nodeOverrides:r.getService("config").get("nodeOverrides"),IPv4NotationRE:/^\d+\.\d+\.\d+\.\d+$/g,localIPsRE:/(^127\.)|(^192\.168\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)/};t.engine={data:a,mergeRuleOverrides:function(e,t){if(!((e?e.length:void 0)>0))return[];if(!((t?t.length:void 0)>0))return e;for(var o=0,n=e;o<n.length;o++)for(var a=n[o],i=0,s=t;i<s.length;i++){var c=s[i];c.domains.indexOf(a.domain)>-1&&(a.hosts=r.getService("util").concatUnique(a.hosts||[],c.hosts||[]))}return e},nodeLookup:function(e,t){return e[t]||!1},compareHosts:function(e,t){for(var o=0,n=e;o<n.length;o++){var r=n[o];if(this.matchWildcardDomain(t,r))return r}},compareURLs:function(e,t){for(var o=0,n=e;o<n.length;o++){var r=n[o];if(r.test(t))return r}},dnsDomainIs:function(e,t){return e.length>=t.length&&e.substring(e.length-t.length)===t},matchWildcardDomain:function(e,t){if(e&&t){var o=e===t,n=e.slice(-t.length)===t,r="."===e[e.lastIndexOf(t)-1];return o||n&&r}},matchNodeOverride:function(e,t){var o=this,n=this.data.nodeOverrides.find((function(n){return n.target_cc===t&&o.compareHosts(n.hosts,e)}));return!!n&&n.nodes},matchRules:function(e,t,o){if(!e||!e.length)return null;this.data.rulesWithOverrides||(e=this.mergeRuleOverrides(e,r.getService("config").get("ruleOverrides")));for(var n=0;n<e.length;n++){var a=e[n];if(this.matchWildcardDomain(t,a.domain)||a.hosts&&this.compareHosts(a.hosts,t))return n}return null},_getProxyState:function(e,t,o){if(e=e.toLowerCase(),this.data.IPv4NotationRE.lastIndex=0,this.data.localIPsRE.lastIndex=0,!~t.indexOf(".")&&!~t.indexOf(":"))return"LOCAL";if(this.data.IPv4NotationRE.test(t)&&this.data.localIPsRE.test(t))return"LOCAL";for(var n=0,r=this.data.localDomains;n<r.length;n++){var a=r[n];if(this.matchWildcardDomain(t,a))return"LOCAL"}var i=this.matchRules(o,t,e);return Number.isInteger(i)?o[i].cc:"DEFAULT"}}},383:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.clear=function(e){chrome.alarms.clear(e)},e.prototype.clearAll=function(){chrome.alarms.clearAll()},e.prototype.create=function(e,t){chrome.alarms.create(e,t)},e.prototype.get=function(e){return new Promise((function(t){chrome.alarms.get(e,t)}))},e}();t.default=o},677:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.get=function(e,t){return void 0===t&&(t=!1),new Promise((function(o,n){return chrome.storage.local.get(e,(function(r){r.hasOwnProperty(e)?o(r[e]):t?n("Element "+e+" not found"):o(null)}))}))},e.prototype.remove=function(e){return new Promise((function(t){return chrome.storage.local.remove(e,t)}))},e.prototype.set=function(e,t){return new Promise((function(o,n){var r;void 0!==e&&0!==e.length||(console.log("ChromeStorageGateway set invalid key",e),n("invalid key")),void 0!==t&&0!==e.length||(console.log("ChromeStorageGateway set invalid value",e),n("invalid value"));var a=((r={})[e]=t,r);return chrome.storage.local.set(a,o)}))},e.prototype.clear=function(){return new Promise((function(e){return chrome.storage.local.clear(e)}))},e}();t.default=o},796:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.urlParser=e,this.currentTab=null}return e.prototype.getCurrentTab=function(){return new Promise((function(e,t){chrome.tabs.query({currentWindow:!0,active:!0},(function(t){e(t)}))}))},e.prototype.getCurrentTabInfo=function(){var e=this;return new Promise((function(t,o){chrome.tabs.query({currentWindow:!0,active:!0},(function(n){if(n[0]){var r=n[0].url,a=e.urlParser.parse(r);t(a)}else o("Error on fetching CurrentTabInfo: no tabs[0]")}))}))},e.prototype.getTest=function(e,t,o){void 0===e&&(e=null),void 0===t&&(t=null),void 0===o&&(o=null)},e.prototype.refreshTab=function(e){return chrome.tabs.reload(e),!0},e.prototype.refreshCurrentTab=function(){return this.getCurrentTab().then((function(e){e[0]&&chrome.tabs.reload(e[0].id)})),!0},e.prototype.openTab=function(e){return new Promise((function(t,o){chrome.tabs.create({url:e}),t(!0)}))},e.prototype.isValidDomain=function(e){if(e.length>255)return!1;var t=new RegExp(/^((?:(?:(?:\w[\.\-\+]?)*)\w)+)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.(\w{2,6})$/);return e.match(t)},e.prototype.parseUrl=function(e){},e.prototype.listenToTabChange=function(){},e}();t.default=o},572:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.storageGateway=e}return e.prototype.disableWebRTC=function(){var e=this;return new Promise((function(t,o){e.storageGateway.get("webrtcProtection").then((function(e){e&&null!=chrome.privacy&&null!=chrome.privacy.network&&null!=chrome.privacy.network.webRTCIPHandlingPolicy?(chrome.privacy.network.webRTCIPHandlingPolicy.set({value:"disable_non_proxied_udp"}),t(!0)):t(!1)}))}))},e.prototype.enableWebRTC=function(){return new Promise((function(e,t){null!=chrome.privacy&&null!=chrome.privacy.network&&null!=chrome.privacy.network.webRTCIPHandlingPolicy?(chrome.privacy.network.webRTCIPHandlingPolicy.set({value:"default"}),e(!0)):e(!1)}))},e.prototype.init=function(){},e.prototype.checkPermission=function(){var e=this;return new Promise((function(t,o){chrome.privacy?t(!0):e.requestPermissions().then((function(e){t(e)}))}))},e.prototype.requestPermissions=function(){var e=["privacy"];return new Promise((function(t){return chrome.permissions.request({permissions:e},(function(e){t(e)}))}))},e}();t.default=o},230:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.disableWebRTC=function(){return new Promise((function(e,t){null!=browser.privacy&&null!=browser.privacy.network&&null!=browser.privacy.network.webRTCIPHandlingPolicy?(browser.privacy.network.webRTCIPHandlingPolicy.set({value:"proxy_only"}),e(!0)):e(!1)}))},e.prototype.enableWebRTC=function(){return new Promise((function(e,t){null!=browser.privacy&&null!=browser.privacy.network&&null!=browser.privacy.network.webRTCIPHandlingPolicy?(browser.privacy.network.webRTCIPHandlingPolicy.set({value:"default"}),e(!0)):e(!1)}))},e.prototype.init=function(){},e.prototype.checkPermission=function(){var e=this;return new Promise((function(t,o){browser.privacy?t(!0):e.requestPermissions().then((function(e){t(e)}))}))},e.prototype.requestPermissions=function(){var e={permissions:["privacy"]};return new Promise((function(t){return Promise.resolve("foobar").then((function(o){browser.permissions.request(e).then((function(e){t(e)}))}))}))},e}();t.default=o},799:function(e){e.exports=JSON.parse('{"env":{"name":"DEV"},"availableLangs":["en","de","fr","es","it","ja","kr","nl","pl","pt","ro","ru"],"siteUrl":"https://www.cyberghostvpn.com/","notificationsCookies":{"en":{"message":"Enjoying the CyberGhost Cookie Cleaner? Leave us a feedback!","yes_btn":"Sure!","no_btn":"No, thanks!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"de":{"message":"Gefällt dir der CyberGhost Cookie Cleaner? Gib uns ein Feedback!","yes_btn":"Klar!","no_btn":"Nein, danke!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"es":{"message":"¿Le gusta CyberGhost Cookie Cleaner? ¡Déjenos un comentario!","yes_btn":"¡Claro!","no_btn":"¡No, gracias!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"it":{"message":"Ti piace CyberGhost Cookie Cleaner? Lascia un feedback!","yes_btn":"Certo!","no_btn":"No, grazie!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ja":{"message":"CyberGhost Cookie Cleanerをお楽しみいただいていますか？ ぜひフィードバックをお寄せください！","yes_btn":"フィードバックを送る","no_btn":"送らない","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ko":{"message":"CyberGhost Cookie Cleaner가 마음에 드시나요? 사용자 의견을 남겨주세요!","yes_btn":"좋아요!","no_btn":"싫어요!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"nl":{"message":"Vindt u CyberGhost Cookie Cleaner leuk? Geef ons uw feedback!","yes_btn":"Graag!","no_btn":"Nee, bedankt!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"pl":{"message":"Spodobała Ci się aplikacja CyberGhost Cookie Cleaner? Przekaż nam opinię!","yes_btn":"Oczywiście!","no_btn":"Nie, dziękuję!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"pt":{"message":"Gostou do CyberGhost Cookie Cleaner? Deixe-nos um comentário!","yes_btn":"Claro!","no_btn":"Não, obrigado!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ro":{"message":"Îți place CyberGhost Cookie Cleaner? Lasă un feedback!","yes_btn":"Desigur!","no_btn":"Nu, mulţumesc!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ru":{"message":"Нравится CyberGhost Cookie Cleaner? Оставьте отзыв!","yes_btn":"Разумеется!","no_btn":"Нет, спасибо!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"fr":{"message":"Satisfait du CyberGhost Cookie Cleaner ? Laissez-nous un avis !","yes_btn":"Bien sûr !","no_btn":"Non, merci !","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"}},"contextMenusCookies":{"en":{"tab_last_h":"Last hour on this tab","tab_last_24h":"Last 24 hours on this tab","tab_last_4w":"Last 4 weeks on this tab","tab_all_time":"All time on this tab","browser_last_h":"Last hour for all browser","browser_last_24h":"Last 24 hours for all browser","browser_last_4w":"Last 4 weeks for all browser","browser_all_time":"All time for all browser","never_clear":"Never clear this site"},"de":{"tab_last_h":"Letzte Stunde auf diesem Tab","tab_last_24h":"Letzten 24 Stunden auf diesem Tab","tab_last_4w":"Letzten 4 Wochen auf diesem Tab","tab_all_time":"Die ganze Zeit auf diesem Tab","browser_last_h":"Letzte Stunde für den ganzen Browser","browser_last_24h":"Letzten 24 Stunden für den ganzen Browser","browser_last_4w":"Letzten 4 Wochen für den ganzen Browser","browser_all_time":"Die ganze Zeit für den ganzen Browser","never_clear":"Diese Seite niemals bereinigen"},"es":{"tab_last_h":"Última hora en esta pestaña","tab_last_24h":"Últimas 24 horas en esta pestaña","tab_last_4w":"Últimas 4 semanas en esta pestaña","tab_all_time":"Todo el tiempo en esta pestaña","browser_last_h":"Última hora para todos los navegadores","browser_last_24h":"Últimas 24 horas para todos los navegadores","browser_last_4w":"Últimas 4 semanas para todos los navegadores","browser_all_time":"Todo el tiempo para todos los navegadores","never_clear":"Nunca borres este sitio"},"it":{"tab_last_h":"Ultima ora in questa scheda","tab_last_24h":"Ultime 24 ore in questa scheda","tab_last_4w":"Ultime 4 settimane in questa scheda","tab_all_time":"Sempre in questa scheda","browser_last_h":"Ultima ora per tutto il browser","browser_last_24h":"Ultime 24 ore per tutti i browser","browser_last_4w":"Ultime 4 settimane per tutti i browser","browser_all_time":"Sempre per tutti i browser","never_clear":"Non cancellare mai questo sito"},"ja":{"tab_last_h":"このタブの最後の1時間","tab_last_24h":"このタブで最後の24時間","tab_last_4w":"このタブで最後の4週間","tab_all_time":"このタブのすべての時間","browser_last_h":"すべてのブラウザの最後の1時間","browser_last_24h":"すべてのブラウザで過去24時間","browser_last_4w":"すべてのブラウザで過去4週間","browser_all_time":"すべてのブラウザで常に","never_clear":"このサイトをクリアしない"},"ko":{"tab_last_h":"이 탭의 마지막 시간","tab_last_24h":"이 탭에서 지난 24 시간","tab_last_4w":"이 탭에서 지난 4 주","tab_all_time":"이 탭에서 항상","browser_last_h":"모든 브라우저의 마지막 시간","browser_last_24h":"모든 브라우저에서 지난 24 시간","browser_last_4w":"모든 브라우저에서 지난 4 주","browser_all_time":"모든 브라우저에서 항상","never_clear":"이 사이트를 지우지 마십시오"},"nl":{"tab_last_h":"Laatste uur op dit tab","tab_last_24h":"Laatste 24 uur op dit tab","tab_last_4w":"Laatste 4 weken op dit tab","tab_all_time":"Altijd op dit tab","browser_last_h":"Laatste uur voor browser","browser_last_24h":"Laatste 24 uur voor browser","browser_last_4w":"Laatste 4 weken voor browser","browser_all_time":"Alle tijd voor browser","never_clear":"Wis deze site nooit"},"pl":{"tab_last_h":"Ostatnia godzina na tej karcie","tab_last_24h":"Ostatnie 24 godziny na tej karcie","tab_last_4w":"Ostatnie 4 tygodnie w tej zakładce","tab_all_time":"Cały czas na tej karcie","browser_last_h":"Ostatnia godzina dla wszystkich przeglądarek","browser_last_24h":"Ostatnie 24 godziny dla wszystkich przeglądarek","browser_last_4w":"Ostatnie 4 tygodnie dla wszystkich przeglądarek","browser_all_time":"Cały czas dla wszystkich przeglądarek","never_clear":"Nigdy nie usuwaj tej strony"},"pt":{"tab_last_h":"Última hora nesta guia","tab_last_24h":"Últimas 24 horas nesta guia","tab_last_4w":"Últimas 4 semanas nesta guia","tab_all_time":"O tempo todo nesta guia","browser_last_h":"Última hora para todos os navegadores","browser_last_24h":"Últimas 24 horas para todos os navegadores","browser_last_4w":"Últimas 4 semanas para todos os navegadores","browser_all_time":"Todo o tempo para todo o navegador","never_clear":"Nunca limpe este site"},"ro":{"tab_last_h":"Ultima oră pe acestă filă","tab_last_24h":"Ultimele 24 de ore pe această filă","tab_last_4w":"Ultimele 4 săptămâni pe această filă","tab_all_time":"Dintotdeauna pe această filă","browser_last_h":"Ultima oră pe tot browserul","browser_last_24h":"Ultimele 24 de ore pe tot browserul","browser_last_4w":"Ultimele 4 săptămâni pe tot browserul","browser_all_time":"Dintotdeauna pe tot browserul","never_clear":"Nu curăța niciodată acest site"},"ru":{"tab_last_h":"Последний час на этой вкладке","tab_last_24h":"Последние 24 часа на этой вкладке","tab_last_4w":"Последние 4 недели на этой вкладке","tab_all_time":"Все время на этой вкладке","browser_last_h":"Последний час для всех браузеров","browser_last_24h":"Последние 24 часа для всех браузеров","browser_last_4w":"Последние 4 недели для всех браузеров","browser_all_time":"Все время для всего браузера","never_clear":"Никогда не очищать этот сайт"},"fr":{"tab_last_h":"Dernière heure sur cet onglet","tab_last_24h":"Dernières 24 heures sur cet onglet","tab_last_4w":"Dernières 4 semaines sur cet onglet","tab_all_time":"Tout le temps sur cet onglet","browser_last_h":"Dernière heure sur l\'ensemble des navigateurs","browser_last_24h":"Dernières 24 heures sur l\'ensemble des navigateurs","browser_last_4w":"Dernières 4 semaines sur l\'ensemble des navigateurs","browser_all_time":"Tout le temps sur l\'ensemble des navigateurs","never_clear":"Ne jamais effacer ce site"}}}')},27:function(e){e.exports=JSON.parse('{"env":{"name":"PRODUCTION"},"availableLangs":["en","de","fr","es","it","ja","kr","nl","pl","pt","ro","ru"],"siteUrl":"https://www.cyberghostvpn.com/","notificationsCookies":{"en":{"message":"Enjoying the CyberGhost Cookie Cleaner? Leave us a feedback!","yes_btn":"Sure!","no_btn":"No, thanks!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"de":{"message":"Gefällt dir der CyberGhost Cookie Cleaner? Gib uns ein Feedback!","yes_btn":"Klar!","no_btn":"Nein, danke!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"es":{"message":"¿Le gusta CyberGhost Cookie Cleaner? ¡Déjenos un comentario!","yes_btn":"¡Claro!","no_btn":"¡No, gracias!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"it":{"message":"Ti piace CyberGhost Cookie Cleaner? Lascia un feedback!","yes_btn":"Certo!","no_btn":"No, grazie!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ja":{"message":"CyberGhost Cookie Cleanerをお楽しみいただいていますか？ ぜひフィードバックをお寄せください！","yes_btn":"フィードバックを送る","no_btn":"送らない","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ko":{"message":"CyberGhost Cookie Cleaner가 마음에 드시나요? 사용자 의견을 남겨주세요!","yes_btn":"좋아요!","no_btn":"싫어요!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"nl":{"message":"Vindt u CyberGhost Cookie Cleaner leuk? Geef ons uw feedback!","yes_btn":"Graag!","no_btn":"Nee, bedankt!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"pl":{"message":"Spodobała Ci się aplikacja CyberGhost Cookie Cleaner? Przekaż nam opinię!","yes_btn":"Oczywiście!","no_btn":"Nie, dziękuję!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"pt":{"message":"Gostou do CyberGhost Cookie Cleaner? Deixe-nos um comentário!","yes_btn":"Claro!","no_btn":"Não, obrigado!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ro":{"message":"Îți place CyberGhost Cookie Cleaner? Lasă un feedback!","yes_btn":"Desigur!","no_btn":"Nu, mulţumesc!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"ru":{"message":"Нравится CyberGhost Cookie Cleaner? Оставьте отзыв!","yes_btn":"Разумеется!","no_btn":"Нет, спасибо!","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"},"fr":{"message":"Satisfait du CyberGhost Cookie Cleaner ? Laissez-nous un avis !","yes_btn":"Bien sûr !","no_btn":"Non, merci !","link":"https://chrome.google.com/webstore/detail/cyberghost-cookie-cleaner/pbkgifljdgkhlmlmgbalmcknbhbggmei"}},"contextMenusCookies":{"en":{"tab_last_h":"Last hour on this tab","tab_last_24h":"Last 24 hours on this tab","tab_last_4w":"Last 4 weeks on this tab","tab_all_time":"All time on this tab","browser_last_h":"Last hour for all browser","browser_last_24h":"Last 24 hours for all browser","browser_last_4w":"Last 4 weeks for all browser","browser_all_time":"All time for all browser","never_clear":"Never clear this site"},"de":{"tab_last_h":"Letzte Stunde auf diesem Tab","tab_last_24h":"Letzten 24 Stunden auf diesem Tab","tab_last_4w":"Letzten 4 Wochen auf diesem Tab","tab_all_time":"Die ganze Zeit auf diesem Tab","browser_last_h":"Letzte Stunde für den ganzen Browser","browser_last_24h":"Letzten 24 Stunden für den ganzen Browser","browser_last_4w":"Letzten 4 Wochen für den ganzen Browser","browser_all_time":"Die ganze Zeit für den ganzen Browser","never_clear":"Diese Seite niemals bereinigen"},"es":{"tab_last_h":"Última hora en esta pestaña","tab_last_24h":"Últimas 24 horas en esta pestaña","tab_last_4w":"Últimas 4 semanas en esta pestaña","tab_all_time":"Todo el tiempo en esta pestaña","browser_last_h":"Última hora para todos los navegadores","browser_last_24h":"Últimas 24 horas para todos los navegadores","browser_last_4w":"Últimas 4 semanas para todos los navegadores","browser_all_time":"Todo el tiempo para todos los navegadores","never_clear":"Nunca borres este sitio"},"it":{"tab_last_h":"Ultima ora in questa scheda","tab_last_24h":"Ultime 24 ore in questa scheda","tab_last_4w":"Ultime 4 settimane in questa scheda","tab_all_time":"Sempre in questa scheda","browser_last_h":"Ultima ora per tutto il browser","browser_last_24h":"Ultime 24 ore per tutti i browser","browser_last_4w":"Ultime 4 settimane per tutti i browser","browser_all_time":"Sempre per tutti i browser","never_clear":"Non cancellare mai questo sito"},"ja":{"tab_last_h":"このタブの最後の1時間","tab_last_24h":"このタブで最後の24時間","tab_last_4w":"このタブで最後の4週間","tab_all_time":"このタブのすべての時間","browser_last_h":"すべてのブラウザの最後の1時間","browser_last_24h":"すべてのブラウザで過去24時間","browser_last_4w":"すべてのブラウザで過去4週間","browser_all_time":"すべてのブラウザで常に","never_clear":"このサイトをクリアしない"},"ko":{"tab_last_h":"이 탭의 마지막 시간","tab_last_24h":"이 탭에서 지난 24 시간","tab_last_4w":"이 탭에서 지난 4 주","tab_all_time":"이 탭에서 항상","browser_last_h":"모든 브라우저의 마지막 시간","browser_last_24h":"모든 브라우저에서 지난 24 시간","browser_last_4w":"모든 브라우저에서 지난 4 주","browser_all_time":"모든 브라우저에서 항상","never_clear":"이 사이트를 지우지 마십시오"},"nl":{"tab_last_h":"Laatste uur op dit tab","tab_last_24h":"Laatste 24 uur op dit tab","tab_last_4w":"Laatste 4 weken op dit tab","tab_all_time":"Altijd op dit tab","browser_last_h":"Laatste uur voor browser","browser_last_24h":"Laatste 24 uur voor browser","browser_last_4w":"Laatste 4 weken voor browser","browser_all_time":"Alle tijd voor browser","never_clear":"Wis deze site nooit"},"pl":{"tab_last_h":"Ostatnia godzina na tej karcie","tab_last_24h":"Ostatnie 24 godziny na tej karcie","tab_last_4w":"Ostatnie 4 tygodnie w tej zakładce","tab_all_time":"Cały czas na tej karcie","browser_last_h":"Ostatnia godzina dla wszystkich przeglądarek","browser_last_24h":"Ostatnie 24 godziny dla wszystkich przeglądarek","browser_last_4w":"Ostatnie 4 tygodnie dla wszystkich przeglądarek","browser_all_time":"Cały czas dla wszystkich przeglądarek","never_clear":"Nigdy nie usuwaj tej strony"},"pt":{"tab_last_h":"Última hora nesta guia","tab_last_24h":"Últimas 24 horas nesta guia","tab_last_4w":"Últimas 4 semanas nesta guia","tab_all_time":"O tempo todo nesta guia","browser_last_h":"Última hora para todos os navegadores","browser_last_24h":"Últimas 24 horas para todos os navegadores","browser_last_4w":"Últimas 4 semanas para todos os navegadores","browser_all_time":"Todo o tempo para todo o navegador","never_clear":"Nunca limpe este site"},"ro":{"tab_last_h":"Ultima oră pe acestă filă","tab_last_24h":"Ultimele 24 de ore pe această filă","tab_last_4w":"Ultimele 4 săptămâni pe această filă","tab_all_time":"Dintotdeauna pe această filă","browser_last_h":"Ultima oră pe tot browserul","browser_last_24h":"Ultimele 24 de ore pe tot browserul","browser_last_4w":"Ultimele 4 săptămâni pe tot browserul","browser_all_time":"Dintotdeauna pe tot browserul","never_clear":"Nu curăța niciodată acest site"},"ru":{"tab_last_h":"Последний час на этой вкладке","tab_last_24h":"Последние 24 часа на этой вкладке","tab_last_4w":"Последние 4 недели на этой вкладке","tab_all_time":"Все время на этой вкладке","browser_last_h":"Последний час для всех браузеров","browser_last_24h":"Последние 24 часа для всех браузеров","browser_last_4w":"Последние 4 недели для всех браузеров","browser_all_time":"Все время для всего браузера","never_clear":"Никогда не очищать этот сайт"},"fr":{"tab_last_h":"Dernière heure sur cet onglet","tab_last_24h":"Dernières 24 heures sur cet onglet","tab_last_4w":"Dernières 4 semaines sur cet onglet","tab_all_time":"Tout le temps sur cet onglet","browser_last_h":"Dernière heure sur l\'ensemble des navigateurs","browser_last_24h":"Dernières 24 heures sur l\'ensemble des navigateurs","browser_last_4w":"Dernières 4 semaines sur l\'ensemble des navigateurs","browser_all_time":"Tout le temps sur l\'ensemble des navigateurs","never_clear":"Ne jamais effacer ce site"}}}')}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}!function(){class e{constructor(e){this.storageGateway=e,this.getAll().then((e=>{this.whiteList=e||[]}))}add(e){return new Promise(((t,o)=>{e.length&&(this.whiteList.length>0&&!this.whiteList.includes(e)?this.whiteList.unshift(e):this.whiteList.includes(e)||this.whiteList.push(e),this.storageGateway.set("cleaner_white_list",this.whiteList)),t(this.whiteList)}))}getAll(){return this.storageGateway.get("cleaner_white_list")}getAllSync(){return this.whiteList}remove(e){return new Promise(((t,o)=>{this.whiteList=this.whiteList.filter((t=>t!==e)),this.storageGateway.set("cleaner_white_list",this.whiteList),t(this.whiteList)}))}}class t{parse(e){var t=e.match(/^(http|https|ftp)?(?:[\:\/]*)([a-z0-9\.-]*)(?:\:([0-9]+))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i),o=new Object;if(o.protocol="",o.host="",o.port="",o.path="",o.query="",o.fragment="",o.domain="",o.subdomain="",!t)return o;if(t[1]&&(o.protocol=t[1]),t[2]&&(o.host=t[2]),t[3]&&(o.port=t[3]),t[4]&&(o.path=t[4]),t[5]&&(o.query=t[5]),t[6]&&(o.fragment=t[6]),o.host){let e=t[2].split(".");3==e.length?(o.domain=e[1]+"."+e[2],o.subdomain=e[0]):o.domain=e[0]+"."+e[1]}return o}}var n={dev:o(799),prod:o(27)};class r{constructor(){this.env="dev",this.version=chrome.runtime.getManifest().version,this.settings=n[this.env],Object.assign(this.settings,n.globals)}get(e){return this.settings.hasOwnProperty(e)?this.settings[e]:null}}var a=o(7);console.log("CyberGhost Cookie Cleaner","color:#fecb00; font-size: 32px"),new class{constructor(){this.urlParser=new t,this.isChrome="undefined"==typeof browser,console.log("Boot..."),this.storageGateway=new a.ChromeStorageGateway,this.serviceProvider=a.ServiceProvider.getInstance(),this.tabsGateway=new a.ChromeTabsGateway(this.urlParser),this.browserSchedule=new a.ChromeSchedule;const o={urlPath:"icon_128.png",trailStart:null,optionLink:null,cookieValue:{startTrial:null,time:null,salt:null}};"undefined"==typeof browser?this.notificationsGateway=new a.ChromeNotificationsGateway(this.tabsGateway,this.browserSchedule,o):this.notificationsGateway=new a.FirefoxNotificationsGateway(this.tabsGateway,this.browserSchedule,o),this.whitelistGateway=new e(this.storageGateway),this.config=new r,"undefined"==typeof browser?this.cookiesGateway=new a.ChromeCookiesGateway(this.notificationsGateway,this.storageGateway,this.config,this.urlParser,this.whitelistGateway):this.cookiesGateway=new a.FirefoxCookiesGateway(this.notificationsGateway,this.storageGateway,this.config,this.urlParser,this.whitelistGateway),this.cookiesGateway.init(),"undefined"==typeof browser?this.contextMenuGateway=new a.ChromeContextMenuGateway(this.cookiesGateway,this.tabsGateway,this.storageGateway,this.config,this.whitelistGateway,this.urlParser):this.contextMenuGateway=new a.FirefoxContextMenuGateway(this.cookiesGateway,this.tabsGateway,this.storageGateway,this.config,this.whitelistGateway,this.urlParser),this.contextMenuGateway.init(),this.mesageGateway=new a.ChromeMessageGateway({}),this.mesageGateway.init(),this.serviceProvider.addService("cookiesGateway",this.cookiesGateway),this.serviceProvider.addService("tabsGateway",this.tabsGateway),this.serviceProvider.addService("contextMenuGateway",this.contextMenuGateway),this.serviceProvider.addService("storageGateway",this.storageGateway),this.serviceProvider.addService("whitelistGateway",this.whitelistGateway),this.serviceProvider.addService("config",this.config),this.initializeListeners()}initializeListeners(){chrome.runtime.onInstalled.addListener((()=>{console.log("Application was installed")})),chrome.runtime.onStartup.addListener((()=>{})),chrome.runtime.onConnect.addListener((()=>{})),chrome.runtime.onConnectExternal.addListener((()=>{})),"undefined"==typeof browser?chrome.runtime.setUninstallURL("https://cyberghostvpn.typeform.com/to/pGOlmO"):browser.runtime.setUninstallURL("https://cyberghostvpn.typeform.com/to/pGOlmO"),chrome.tabs.onUpdated.addListener(((e,t,o)=>{if(this.isChrome){let e=this.urlParser.parse(o.url);this.tabsGateway.isValidDomain(e.domain)?this.contextMenuGateway.showContextMenuWhitelist(!0):this.contextMenuGateway.showContextMenuWhitelist(!1)}})),chrome.tabs.onActivated.addListener((e=>{setTimeout((()=>{chrome.tabs.get(e.tabId,(e=>{if(e.url===`chrome-extension://${chrome.runtime.id}/options.html`&&(chrome.tabs.create({url:"chrome://extensions/?id="+chrome.runtime.id}),chrome.tabs.remove(e.id,(function(){}))),this.isChrome){let t=this.urlParser.parse(e.url);this.tabsGateway.isValidDomain(t.domain)?this.contextMenuGateway.showContextMenuWhitelist(!0):this.contextMenuGateway.showContextMenuWhitelist(!1)}}))}),200)}))}}}()}();