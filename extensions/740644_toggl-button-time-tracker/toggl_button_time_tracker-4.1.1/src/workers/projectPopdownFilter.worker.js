const C=s=>(n,d)=>{var t,f;const h=(t=s==null?void 0:s[n])==null?void 0:t.name,u=(f=s==null?void 0:s[d])==null?void 0:f.name;return h===void 0&&u===void 0?0:h===void 0?-1:u===void 0?1:h.localeCompare(u)};function p(s){const{projects:n,clients:d,workspaces:h,tasks:u,filter:t,expandedProjects:f}=s.data,b=o=>{var e,r;return(r=i&&((e=i[o])==null?void 0:e.find(l=>l.name.toLowerCase().includes(t.toLowerCase()))))!=null?r:void 0},k=o=>{var e,r,l;return t.length>0&&!o.name.toLowerCase().includes(t.toLowerCase())?(r=(e=i==null?void 0:i[o.id])==null?void 0:e.filter(c=>c.name.toLowerCase().includes(t.toLowerCase())))!=null?r:[]:(l=i==null?void 0:i[o.id])!=null?l:[]},i=Object.values(u!=null?u:{}).reduce((o,e)=>(o[e.project_id]||(o[e.project_id]=[]),o[e.project_id].push(e),o),{}),m=Object.values(n!=null?n:{}).reduce((o,e)=>{var g,_,v,L;const r=b(e.id);if(!e.name.toLowerCase().includes(t.toLowerCase())&&!r&&!((_=d==null?void 0:d[(g=e.client_id)!=null?g:""])!=null&&_.name.toLowerCase().includes(t.toLowerCase())))return o;const l=(v=e.client_id)!=null?v:"no_client";o[e.workspace_id]===void 0&&(o[e.workspace_id]={}),o[e.workspace_id][l]===void 0&&(o[e.workspace_id][l]={});let c=[];return f!=null&&f[e.id]?c=(L=i==null?void 0:i[e.id])!=null?L:[]:t.length>0&&r&&(c=k(e)),o[e.workspace_id][l][e.id]=c,o},{}),w=[];return w.push({id:0,type:"project"}),Object.keys(m!=null?m:{}).sort(C(h)).forEach(o=>{w.push({id:Number(o),type:"workspace"}),Object.keys(m[o]).sort(C(d)).forEach(e=>{w.push({id:Number(e),type:"client"}),Object.keys(m[o][e]).sort(C(n)).forEach(r=>{w.push({id:Number(r),type:"project"}),m[o][e][r].sort(C(u)).forEach(l=>{w.push({id:l.id,type:"task"})})})})}),{items:w,tasksByProject:i}}self.onmessage=function(s){try{console.time("toggl:projectPopdownFilterWorker");const n=p(s);self.postMessage(n),console.timeEnd("toggl:projectPopdownFilterWorker")}catch(n){console.error(n,"toggl:projectPopdownFilterWorker")}};
//# sourceMappingURL=projectPopdownFilter.worker.js.map
