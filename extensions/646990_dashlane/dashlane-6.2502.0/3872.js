"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[3872],{53872:(e,t,i)=>{i.r(t),i.d(t,{Connected:()=>L});var a=i(25792),n=i(39431),s=i(24507),l=i(19122),o=i(96832),r=i(26849),c=i(8180),d=i(78346),p=i(13134),u=i(14900),m=i(63520),_=i(92077),h=i(88203),g=i(76376),y=i(86498),f=i(82994),b=i(61468),D=i(48062),k=i(45272),S=i(77063),w=i(61605),C=i(68037),I=i(67406),v=i(68593);const Z=({passkeyContent:e,spaceDetails:t,signalEditedValues:i})=>{var a;const{translate:n}=(0,h.Z)(),{shouldShowFrozenStateDialog:s}=(0,S.Ub)(),l=null!=(a=t?.teamName)?a:n("webapp_credential_edition_field_space_personal"),{userDisplayName:r,rpId:c,itemName:d,note:u,spaceId:m,id:_}=e;(0,o.useEffect)((()=>{(0,k.Nc)(D.PageView.ItemPasskeyDetails)}),[]);const g=t=>a=>{const n="string"==typeof a?a:a.target.value;i({...e,[t]:n})},y=Boolean(t?.info.forcedDomainsEnabled&&e.spaceId===t?.teamId||s);return null===s?null:(0,v.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,v.BX)(C.u,{title:n("webapp_passkey_edition_title_passkey_detail"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,v.tZ)(b.qo,{readOnly:!0,value:r,label:n("webapp_passkey_edition_field_username"),placeholder:n("webapp_passkey_edition_field_username_placeholder")},"passkeyUsername"),(0,v.tZ)(b.qZ,{label:n("webapp_credential_edition_field_website"),onChange:(e,t="")=>{if(e instanceof Event&&t)throw new Error("handleChange was called with both a ChangeEvent and key.")},showOpenWebsite:{label:n("webapp_credential_edition_field_website_action_goto"),onClick:()=>{(0,k.Kz)(new D.UserOpenExternalVaultItemLinkEvent({itemId:_,itemType:D.ItemTypeWithLink.Passkey,domainType:D.DomainType.Web})),(0,w.Yo)(new p.Y(c).getUrlWithFallbackHttpsProtocol())}},value:c}),(0,v.tZ)(b.Kx,{"data-name":"note",readOnly:s,label:n("webapp_passkey_edition_field_notes"),placeholder:n("webapp_passkey_edition_field_placeholder_no_notes"),value:u,onChange:g("note")})]}),(0,v.BX)(C.u,{title:n("webapp_passkey_edition_title_organisation"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,v.tZ)(b.qo,{value:null!=d?d:r,onChange:g("itemName"),label:n("webapp_passkey_edition_field_item_name"),placeholder:n("webapp_passkey_edition_field_item_name_placeholder"),readOnly:s},"passkeyItemName"),(0,v.tZ)(b.u,{content:n("webapp_passkey_edition_field_force_categorized",{space:l}),passThrough:!y,children:(0,v.tZ)("div",{children:(0,v.tZ)(I.M,{spaceId:m,isDisabled:y,onChange:e=>g("spaceId")(e),isUsingNewDesign:!0})})})]})]})};var T=i(26555);const A=({item:e})=>{const{routes:t}=(0,g.Xo)(),{translate:i}=(0,h.Z)(),{updateVaultItem:s}=(0,c.u)(a.L),[b,D]=(0,o.useState)(!1),k=(0,_.k6)(),S=(0,y.V)(),{spaceDetails:w}=(0,l.fV)(),[C,I]=(0,o.useState)(e),[A,L]=(0,o.useState)(!1),[x,E]=(0,o.useState)(!1),V=()=>{(0,_.uX)(t.userPasskeys)},N={confirmDeleteConfirm:i("webapp_passkey_edition_delete_confirm"),confirmDeleteDismiss:i("webapp_passkey_edition_delete_dismiss"),confirmDeleteSubtitle:i("webapp_passkey_edition_delete_text"),confirmDeleteTitle:i("webapp_passkey_edition_delete_header"),deleteSuccessToast:i("webapp_passkey_edition_name_delete_alert",{passkey:e.rpName})},U=()=>{S.showAlert(i("_common_generic_error"),u.BLW.ERROR)},G=()=>{if(w?.info.forcedDomainsEnabled&&C.spaceId!==w.teamId){const e=C.userDisplayName?.split("@")[1];if(w.info.teamDomains.includes(e))return w.teamId}return C.spaceId};return(0,v.BX)(m.zI,{itemHasBeenEdited:x,isViewingExistingItem:!0,isUsingNewDesign:!0,onNavigateOut:V,onClickDelete:()=>D(!0),onSubmit:async()=>{if(!A){L(!0);try{const a=await s({vaultItemType:n.U.Passkey,content:{...C,spaceId:G()},id:e.id});if((0,d.d6)(a)){const a=i("webapp_passkey_edition_name_update_alert",{passkey:e.rpName});S.showAlert(a,u.BLW.SUCCESS),k.push(t.userPasskeys)}else L(!1),U()}catch(e){L(!1),U()}}},formId:"edit_passkey_panel",header:(0,v.tZ)(m.V9,{icon:(0,v.tZ)(T.h,{size:"xlarge",domainURL:new p.Y(C.rpId).getRootDomain()}),title:e.rpName}),children:[(0,v.tZ)(Z,{passkeyContent:C,signalEditedValues:t=>{E(!(0,r.equals)(t,e)),I(t)},spaceDetails:w}),(0,v.tZ)(f.s,{isVisible:b,itemId:e.id,closeConfirmDeleteDialog:()=>D(!1),onDeletionSuccess:V,translations:N,vaultItemType:n.U.Passkey})]})},L=e=>{const{data:t}=(0,s.k)(a.L,"query",{vaultItemTypes:[n.U.Passkey],ids:[`{${e.match.params.uuid}}`]});return t?.passkeysResult.items.length?(0,v.tZ)(l.qc,{lee:e.lee,children:(0,v.tZ)(A,{...e,item:t.passkeysResult.items[0]})}):null}},82994:(e,t,i)=>{i.d(t,{s:()=>_}),i(96832);var a=i(61468),n=i(8180),s=i(51031),l=i(25792),o=i(88203);let r=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var c=i(65580),d=i(68593);const p=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:n})=>{const{translate:s}=(0,o.Z)(),l=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:a,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case r.LastAdmin:return a;case r.GroupSharing:return i;case r.CollectionSharing:return n;case r.Generic:return s;default:return(0,c.U)(t)}})(t,e),p=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:a,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case r.LastAdmin:return a;case r.GroupSharing:return i;case r.CollectionSharing:return n;case r.Generic:return s;default:return(0,c.U)(t)}})(t,e);return(0,d.tZ)(a.Vq,{isOpen:!0,onClose:n,title:null!=l?l:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===r.LastAdmin||r.GroupSharing||r.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),n()}}}:void 0,children:p})};var u=i(37527);const m=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:n}=(0,o.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:l,confirmDeleteDismiss:r,confirmDeleteConfirm:c}=i;return(0,d.tZ)(a.Vq,{title:l,onClose:e,isOpen:!0,dialogClassName:u.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:c,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:r,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},_=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:c,onDeletionSuccess:u,sharingStatus:_,translations:h,vaultItemType:g,isShared:y,isSharedViaUserGroup:f,isItemInCollection:b,isLastAdmin:D})=>{const{showToast:k}=(0,a.pm)(),{translate:S}=(0,o.Z)(),{deleteVaultItem:w}=(0,n.u)(l.L);if(!i)return null;let C;return(y||_?.isShared)&&(f&&(C=r.GroupSharing),D&&(C=r.LastAdmin),b&&(C=r.CollectionSharing)),C&&t?(0,d.tZ)(p,{reason:C,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(m,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await w({id:c,vaultItemType:g})).tag===s.rq.Success?(k({description:null!=(e=h.deleteSuccessToast)?e:S("webapp_personal_info_edition_delete_success_toast")}),u()):k({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){k({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}}}]);