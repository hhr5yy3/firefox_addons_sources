((e,t)=>{"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LinkGuardSDK=t():e.LinkGuardSDK=t()})(this,()=>{{var i={d:(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={},s=(i.d(t,{default:()=>e}),globalThis.SymBfw),n=globalThis.SafeWeb,u=globalThis.trackingServerSDK;Object.defineProperty(S,"MESSAGES",{get:function(){return{GET_RATINGS:"9f9b6830-134e-4e0f-bb08-93e6e270c90b",SHOW_ONE_TIME_SCAN_NOTIFICATION:"cf456bdf-3e0d-4660-df49-44dd5466c306",GET_TAB_URL:"d7b20955-55dd-46ac-89ea-adcad196c39e",GET_POPUP_DATA:"d09a4c06-4c14-4647-8b7d-05169eedaeb5",SEND_TELEMETRY:"911a78db-0224-4ed3-8b3f-da09387e350f",SET_DATA_IN_CACHE:"hjgkhhkjvhkd",GET_URLS_CACHE:"da55ef2a-eb87-4293-93fd-5853502c2b57"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"WEBMAIL_DOMAINS",{get:function(){return["mail.google.com","mail.yahoo.com","outlook.live.com","mail.aol.com","mail.yandex.ru","mail.protonmail.com","mail.zoho.com"]},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SOCIAL_MEDIA_DOMAINS",{get:function(){return["www.facebook.com","facebook.com","twitter.com","www.twitter.com"]},enumerable:!1,configurable:!0}),Object.defineProperty(S,"ATTRIBUTE_SCAN_LIST",{get:function(){return["href","codebase","cite","background","action","longdesc","src","profile","usemap","classid","data","formaction","icon","manifest","poster"]},enumerable:!1,configurable:!0}),Object.defineProperty(S,"ATTRIBUTE_IGNORE_LIST",{get:function(){return["download"]},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SUPPORTED_PROTOCOLS",{get:function(){return["http:","https:"]},enumerable:!1,configurable:!0}),Object.defineProperty(S,"URL_FILTER",{get:function(){return/^.*\.(JPG|JPEG|MP4|GIF|PNG|CSS|JS|XML|ICO|JSON|SVG|PDF|JPG:THUMB|PNG:THUMB)$/i},enumerable:!1,configurable:!0}),Object.defineProperty(S,"URL_FILTER_WITH_QUERY_PARAM",{get:function(){return/^.*\.(JPG\?|JPEG\?|MP4\?|GIF\?|PNG\?|CSS\?|JS\?|XML\?|ICO\?|JSON\?|SVG\?|PDF\?|JPG:THUMB\?|PNG:THUMB\?)/i},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SAFE_TLDS",{get:function(){return/^.*(FBCDN.NET|TWIMG.COM|GOOGLEUSERCONTENT.COM|GOOGLE.COM|MESSENGER.COM|GSTATIC.COM|YOUTUBE.COM|BLOGGER.COM|FACEBOOK.COM|MSN.COM|YAHOO.COM|TWITTER.COM)$/i},enumerable:!1,configurable:!0}),Object.defineProperty(S,"PROCESS_PAGE_TIMEOUT",{get:function(){return 1e3},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CHUNK_SIZE",{get:function(){return 30},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SETTINGS_MESSAGES",{get:function(){return{LINKGUARD_STORAGE_SETTINGS:"2b342ac6-cff2-40ee-d349-14b691e31e2e",SCAN_NOTIFICATION_SHOWN:"14ec3407-19c4-4fc3-8915-c23a036ab4c1"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"POPUP_WIDTH",{get:function(){return 233},enumerable:!1,configurable:!0}),Object.defineProperty(S,"POPUP_HEIGHT",{get:function(){return 120},enumerable:!1,configurable:!0}),Object.defineProperty(S,"POPUP_OFFSET",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(S,"ISO2_2_ISO3_locale",{get:function(){return{AX:"ALA",AF:"AFG",AL:"ALB",DZ:"DZA",AS:"ASM",AD:"AND",AO:"AGO",AI:"AIA",AQ:"ATA",AG:"ATG",AR:"ARG",AM:"ARM",AW:"ABW",AU:"AUS",AT:"AUT",AZ:"AZE",BS:"BHS",BH:"BHR",BD:"BGD",BB:"BRB",BY:"BLR",BE:"BEL",BZ:"BLZ",BJ:"BEN",BM:"BMU",BT:"BTN",BO:"BOL",BA:"BIH",BW:"BWA",BV:"BVT",BR:"BRA",IO:"IOT",BN:"BRN",BG:"BGR",BF:"BFA",BI:"BDI",KH:"KHM",CM:"CMR",CA:"CAN",CV:"CPV",KY:"CYM",CF:"CAF",TD:"TCD",CL:"CHL",CN:"CHN",CX:"CXR",CC:"CCK",CO:"COL",KM:"COM",CD:"COD",CG:"COG",CK:"COK",CR:"CRI",CI:"CIV",HR:"HRV",CU:"CUB",CY:"CYP",CZ:"CZE",DK:"DNK",DJ:"DJI",DM:"DMA",DO:"DOM",EC:"ECU",EG:"EGY",SV:"SLV",GQ:"GNQ",ER:"ERI",EE:"EST",ET:"ETH",FK:"FLK",FO:"FRO",FJ:"FJI",FI:"FIN",FR:"FRA",GF:"GUF",PF:"PYF",TF:"ATF",GA:"GAB",GM:"GMB",GE:"GEO",DE:"DEU",GH:"GHA",GI:"GIB",GR:"GRC",GL:"GRL",GD:"GRD",GP:"GLP",GU:"GUM",GT:"GTM",GN:"GIN",GW:"GNB",GY:"GUY",HT:"HTI",HM:"HMD",HN:"HND",HK:"HKG",HU:"HUN",IS:"ISL",IN:"IND",ID:"IDN",IR:"IRN",IQ:"IRQ",IE:"IRL",IL:"ISR",IT:"ITA",JM:"JAM",JP:"JPN",JO:"JOR",KZ:"KAZ",KE:"KEN",KI:"KIR",KP:"PRK",KR:"KOR",KW:"KWT",KG:"KGZ",LA:"LAO",LV:"LVA",LB:"LBN",LS:"LSO",LR:"LBR",LY:"LBY",LI:"LIE",LT:"LTU",LU:"LUX",MO:"MAC",MK:"MKD",MG:"MDG",MW:"MWI",MY:"MYS",MV:"MDV",ML:"MLI",MT:"MLT",MH:"MHL",MQ:"MTQ",MR:"MRT",MU:"MUS",YT:"MYT",MX:"MEX",FM:"FSM",MD:"MDA",MC:"MCO",MN:"MNG",MS:"MSR",MA:"MAR",MZ:"MOZ",MM:"MMR",NA:"NAM",NR:"NRU",NP:"NPL",NL:"NLD",AN:"ANT",NC:"NCL",NZ:"NZL",NI:"NIC",NE:"NER",NG:"NGA",NU:"NIU",NF:"NFK",MP:"MNP",NO:"NOR",OM:"OMN",PK:"PAK",PW:"PLW",PS:"PSE",PA:"PAN",PG:"PNG",PY:"PRY",PE:"PER",PH:"PHL",PN:"PCN",PL:"POL",PT:"PRT",PR:"PRI",QA:"QAT",RE:"REU",RO:"ROU",RU:"RUS",RW:"RWA",SH:"SHN",KN:"KNA",LC:"LCA",PM:"SPM",VC:"VCT",WS:"WSM",SM:"SMR",ST:"STP",SA:"SAU",SN:"SEN",CS:"SCG",SC:"SYC",SL:"SLE",SG:"SGP",SK:"SVK",SI:"SVN",SB:"SLB",SO:"SOM",ZA:"ZAF",GS:"SGS",ES:"ESP",LK:"LKA",SD:"SDN",SR:"SUR",SJ:"SJM",SZ:"SWZ",SE:"SWE",CH:"CHE",SY:"SYR",TW:"TWN",TJ:"TJK",TZ:"TZA",TH:"THA",TL:"TLS",TG:"TGO",TK:"TKL",TO:"TON",TT:"TTO",TN:"TUN",TR:"TUR",TM:"TKM",TC:"TCA",TV:"TUV",UG:"UGA",UA:"UKR",AE:"ARE",GB:"GBR",US:"USA",UM:"UMI",UY:"URY",UZ:"UZB",VU:"VUT",VA:"VAT",VE:"VEN",VN:"VNM",VG:"VGB",VI:"VIR",WF:"WLF",EH:"ESH",YE:"YEM",ZM:"ZMB",ZW:"ZWE"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"ISO2_2_ISO3_lang",{get:function(){return{AB:"ABK",AA:"AAR",AF:"AFR",AK:"AKA",SQ:"SQI",AM:"AMH",AR:"ARA",AN:"ARG",HY:"HYE",AS:"ASM",AV:"AVA",AE:"AVE",AY:"AYM",AZ:"AZE",BM:"BAM",BA:"BAK",EU:"EUS",BE:"BEL",BN:"BEN",BH:"BIH",BI:"BIS",BS:"BOS",BR:"BRE",BG:"BUL",MY:"MYA",CA:"CAT",CH:"CHA",CE:"CHE",NY:"NYA",ZH:"ZHO",CV:"CHV",KW:"COR",CO:"COS",CR:"CRE",HR:"HRV",CS:"CES",DA:"DAN",DV:"DIV",NL:"NLD",DZ:"DZO",EN:"ENG",EO:"EPO",ET:"EST",EE:"EWE",FO:"FAO",FJ:"FIJ",FI:"FIN",FR:"FRA",FF:"FUL",GL:"GLG",KA:"KAT",DE:"DEU",EL:"ELL",GN:"GRN",GU:"GUJ",HT:"HAT",HA:"HAU",HE:"HEB",HZ:"HER",HI:"HIN",HO:"HMO",HU:"HUN",IA:"INA",ID:"IND",IE:"ILE",GA:"GLE",IG:"IBO",IK:"IPK",IO:"IDO",IS:"ISL",IT:"ITA",IU:"IKU",JA:"JPN",JV:"JAV",KL:"KAL",KN:"KAN",KR:"KAU",KS:"KAS",KK:"KAZ",KM:"KHM",KI:"KIK",RW:"KIN",KY:"KIR",KV:"KOM",KG:"KON",KO:"KOR",KU:"KUR",KJ:"KUA",LA:"LAT",LB:"LTZ",LG:"LUG",LI:"LIM",LN:"LIN",LO:"LAO",LT:"LIT",LU:"LUB",LV:"LAV",GV:"GLV",MK:"MKD",MG:"MLG",MS:"MSA",ML:"MAL",MT:"MLT",MI:"MRI",MR:"MAR",MH:"MAH",MN:"MON",NA:"NAU",NV:"NAV",ND:"NDE",NE:"NEP",NG:"NDO",NB:"NOB",NN:"NNO",NO:"NOR",II:"III",NR:"NBL",OC:"OCI",OJ:"OJI",CU:"CHU",OM:"ORM",OR:"ORI",OS:"OSS",PA:"PAN",PI:"PLI",FA:"FAS",PL:"POL",PS:"PUS",PT:"POR",QU:"QUE",RM:"ROH",RN:"RUN",RO:"RON",RU:"RUS",SA:"SAN",SC:"SRD",SD:"SND",SE:"SME",SM:"SMO",SG:"SAG",SR:"SRP",GD:"GLA",SN:"SNA",SI:"SIN",SK:"SLK",SL:"SLV",SO:"SOM",ST:"SOT",ES:"SPA",SU:"SUN",SW:"SWA",SS:"SSW",SV:"SWE",TA:"TAM",TE:"TEL",TG:"TGK",TH:"THA",TI:"TIR",BO:"BOD",TK:"TUK",TL:"TGL",TN:"TSN",TO:"TON",TR:"TUR",TS:"TSO",TT:"TAT",TW:"TWI",TY:"TAH",UG:"UIG",UK:"UKR",UR:"URD",UZ:"UZB",VE:"VEN",VI:"VIE",VO:"VOL",WA:"WLN",CY:"CYM",WO:"WOL",FY:"FRY",XH:"XHO",YI:"YID",YO:"YOR",ZA:"ZHA",ZU:"ZUL"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SITE_DIRECTOR_VALUES",{get:function(){return{SITE_DIRECTOR_URL:"http://sitedirector.norton.com/932743328?ssdcat=SSDCAT_VALUE&env=prod&origin=nsss&displang=iso3:ISO3_LAN_CODE&displocale=iso3:ISO3_COUNTRY_CODE",COUNTRY_CODE:"ISO3_COUNTRY_CODE",LAN_CODE:"ISO3_LAN_CODE",SSD_CAT:"SSDCAT_VALUE"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SITE_DIRECTOR_VALUES_NOTIFICATION",{get:function(){return{SSD_CAT:"310",SSD_HELP_ID:"&helpid=suspiciouslink"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"STRINGS_LINK_GUARD",{get:function(){return{page_scan_notification:{title:"",ok_button:"suspicious.links.notification.ok",learn_more:"suspicious.links.notification.learnMore",description:"suspicious.links.notification.main"},popup:{header:"suspicious.links.popup.header",content:"suspicious.links.popup.content"}}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SUPPORTED_LANGUAGES",{get:function(){return{el:!0,en:!0,pt_br:!0,it:!0,ar:!0,cs:!0,es:!0,ru:!0,nl:!0,pt:!0,no:!0,nb:!0,tr:!0,ro:!0,pl:!0,fr:!0,zh_tw:!0,de:!0,da:!0,fi:!0,hu:!0,ja:!0,he:!0,zh_cn:!0,ko:!0,sv:!0}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"STRINGS_PATH",{get:function(){return"/content/i18n/linkGuardSDK"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"STRINGS",{get:function(){return{lg_strings:"lg_strings",page_scan_notification:"page_scan_notification",popup:"popup"}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CSS_FILE_NAME",{get:function(){return"linkGuard.css"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CS_FILE_NAME",{get:function(){return"linkGuardCS.js"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"SECURITY_POPUP",{get:function(){return"lg_security_popup"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"LINK_GUARD_ENABLED",{get:function(){return"f23c899e-785b-4579-a219-9b6484895030"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"TELEMETRY_CONSTANTS",{get:function(){return{PAGE:{SCAN_NOTIFICATION_SHOWN:"Linkguard_scan_notification_shown",RED_HIGHLIGHTS_SHOWN:"Linkguard_red_highlights_shown"},EVENTS:{EXTN_PAGE_VIEW:"extnPageview",EXTN_CLICK:"extnClick"},CATEGORY:{LG_NOTIFICATION:"lg_notification",LG_RED_HIGHLIGHTS:"lg_red_highlights",URL_REPUTATION:"url_reputation"},ACTION:{BAD_URL_CLICKED:"bad_url_clicked"},TYPE:{BAD_URL_CLICKED:"Linkguard_bad_url_clicked"}}},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CACHED_URLS",{get:function(){return"4529ede2-edc9-4d3e-9d3f-c791fece0a5c"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CACHE_CLEAR_ALARM",{get:function(){return"clear_cache_lg"},enumerable:!1,configurable:!0}),Object.defineProperty(S,"CACHE_CLEAR_INTERVAL_IN_MINS",{get:function(){return 10},enumerable:!1,configurable:!0});let a=S;function S(){}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},A=u.TrackingServerAnalyticsFacade;T.prototype.init=function(e){this.superParams=e.superParams,this.applicationSettings=e.applicationSettings,this.trackingServerAnalyticsFacade=new A(this.superParams,this.applicationSettings)},T.prototype.sendEvent=function(e){if(!this.trackingServerAnalyticsFacade)throw new Error("Tracking server is not initialized");e=l({},e);this.trackingServerAnalyticsFacade.sendEvent(e)};let r=new T;function T(){this.superParams={},this.trackingServerAnalyticsFacade=null,this.applicationSettings=null}var E=s.settings,u=s.utils,N=s.logger,f=u.isNil,I=a.SETTINGS_MESSAGES;d.prototype.initialize=function(){var o=this;return new Promise(function(i,r){E.loadSettingsContainer(I.LINKGUARD_STORAGE_SETTINGS,!0,function(e,t,n){!1===e||f(t)?r(n):(o.storageContainer=t,i(!0))})})},d.prototype.get=function(e){if(!f(this.storageContainer))return this.storageContainer.getObject(e);N.debug("storage not initialized")},d.prototype.set=function(e,t){f(this.storageContainer)?N.debug("storage not initialized"):this.storageContainer.setObject(e,t)};let o=new d;function d(){this.storageContainer=null}function O(e){for(var t={},n=Object.values(a.STRINGS_LINK_GUARD[e]),i=Object.keys(a.STRINGS_LINK_GUARD[e]),r=0;r<n.length;r+=1)t[i[r]]=R.getLocalizedStringFromDictionary(n[r],a.STRINGS.lg_strings);return t}var R=s.localizer,u=s.utils,L=s.extensionAdapter,_=s.logger,C=u.isNil,p=u.isntNil;g.getNotificationShownStatus=function(){return o.get(a.SETTINGS_MESSAGES.SCAN_NOTIFICATION_SHOWN)},g.openURLForScanNotification=function(){var e,t,n,i,r,o=a.SITE_DIRECTOR_VALUES_NOTIFICATION;e=o.SSD_CAT,o=o.SSD_HELP_ID,t=a.SITE_DIRECTOR_VALUES,n=t.SITE_DIRECTOR_URL,i=R.getNavigatorLanguage().split("-"),r=i[0],C(i=i[1])&&(i="US"),i=a.ISO2_2_ISO3_locale[i.toUpperCase()],r=a.ISO2_2_ISO3_lang[r.toUpperCase()],n=(n=(n=n.replace(t.COUNTRY_CODE,i)).replace(t.LAN_CODE,r)).replace(t.SSD_CAT,e),p(o)&&(n+=o),L.createTab(n)},g.showOneTimeScanNotification=function(e){var t,n,i=this;this.getNotificationShownStatus()||(t={category:(t=a.TELEMETRY_CONSTANTS).CATEGORY.URL_REPUTATION,event:t.EVENTS.EXTN_PAGE_VIEW,page:t.PAGE.SCAN_NOTIFICATION_SHOWN},o.set(a.SETTINGS_MESSAGES.SCAN_NOTIFICATION_SHOWN,!0),n=O(a.STRINGS.page_scan_notification),(e=new s.QuestionNotification(n.description,{},n.ok_button,function(){},e,n.title)).addSecondaryLink(n.learn_more,function(){return i.openURLForScanNotification()}),s.notificationCenter.addNotification(e),r.sendEvent(t))};let c=g;function g(){}function G(e,a,c,s){return new(c=c||Promise)(function(n,t){function i(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof c?t:new c(function(e){e(t)})).then(i,r)}o((s=s.apply(e,a||[])).next())})}function b(i,r){var o,a,c,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},u=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return u.next=e(0),u.throw=e(1),u.return=e(2),"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function e(n){return function(e){var t=[n,e];if(o)throw new TypeError("Generator is already executing.");for(;s=u&&t[u=0]?0:s;)try{if(o=1,a&&(c=2&t[0]?a.return:t[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,t[1])).done)return c;switch(a=0,(t=c?[2&t[0],c.value]:t)[0]){case 0:case 1:c=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((c=0<(c=s.trys).length&&c[c.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3]))s.label=t[1];else if(6===t[0]&&s.label<c[1])s.label=c[1],c=t;else{if(!(c&&s.label<c[2])){c[2]&&s.ops.pop(),s.trys.pop();continue}s.label=c[2],s.ops.push(t)}}t=r.call(i,s)}catch(e){t=[6,e],a=0}finally{o=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function M(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)a.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function U(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||((i=i||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var h=a.MESSAGES,P=s.alarmHelper,D=s.extensionAdapter,y=s.logger,u,H=(u=s.utils).isNil,K=u.isArray,B=s.constants;function m(){this.initReadyPromise=null,this.handleMessage=this.handleMessage.bind(this),this.handleMessageNotification=this.handleMessageNotification.bind(this),this.onTabActivated=this.onTabActivated.bind(this),this.onTabUpdate=this.onTabUpdate.bind(this),this.getLinkGuardEnabled=this.getLinkGuardEnabled.bind(this),this.setLinkGuardEnabled=this.setLinkGuardEnabled.bind(this)}m.prototype.injectScripts=function(i){return G(this,void 0,void 0,function(){var t,n;return b(this,function(e){switch(e.label){case 0:t=this.config.filePaths,e.label=1;case 1:return e.trys.push([1,6,,7]),[4,D.executeContentScript(i.id,"content/libs/react-latest.min.js")];case 2:return e.sent(),[4,D.executeContentScript(i.id,"content/libs/react-dom-latest.min.js")];case 3:return e.sent(),[4,D.executeContentScript(i.id,"".concat(t.csPath,"/").concat(a.CS_FILE_NAME))];case 4:return e.sent(),[4,D.insertCSS(i.id,"".concat(t.cssPath,"/").concat(a.CSS_FILE_NAME))];case 5:return e.sent(),[3,7];case 6:return n=e.sent(),y.debug("error in injecting LG related scripts ".concat(n)),[3,7];case 7:return[2]}})})},m.prototype.checkAndNotifyCS=function(n){return G(this,void 0,void 0,function(){var t;return b(this,function(e){switch(e.label){case 0:if(!this.getLinkGuardEnabled())return[2];e.label=1;case 1:return e.trys.push([1,4,,5]),t=new URL(n.url),t=t.hostname,U(U([],M(a.SOCIAL_MEDIA_DOMAINS),!1),M(a.WEBMAIL_DOMAINS),!1).includes(t)?[4,this.injectScripts(n)]:[3,3];case 2:e.sent(),e.label=3;case 3:return[3,5];case 4:return t=e.sent(),y.debug("Error in parsing the url ".concat(t)),[3,5];case 5:return[2]}})})},m.prototype.initializeListenersAndSettings=function(e,t){try{D.addMessageListener(this.handleMessage),D.addTabUpdatedEventListener(this.onTabUpdate),D.addTabActivatedEventListener(this.onTabActivated),r.init(this.config.telemetryParams),Promise.all([new Promise(function(n,i){var e=L.getExtensionURL(a.STRINGS_PATH);R.initialize(a.SUPPORTED_LANGUAGES,function(e,t){t?(_.debug("Error in loading default strings dictionary",t),i(t)):(_.debug("Loading default strings dictionary status - ".concat(e)),R.loadDictionary(a.STRINGS.lg_strings,function(e,t){t?(_.debug("Error in loading lg_strings dictionary",t),i(t)):(_.debug("Loading lg_strings status - ".concat(e)),n())}))},e)}),o.initialize()]).then(function(){e("Initialized link Guard SDK")}).catch(function(e){t("error in initializing link Guard SDK ".concat(e))})}catch(e){t("error in initializing link Guard SDK ".concat(e))}},m.prototype.initialize=function(t){return G(this,void 0,void 0,function(){var n=this;return b(this,function(e){return this.initReadyPromise||(this.config=t,this.initReadyPromise=new Promise(function(e,t){n.initializeListenersAndSettings(e,t)})),[2,this.initReadyPromise]})})},m.prototype.onTabUpdate=function(e,t,n){this.checkAndNotifyCS(n)},m.prototype.onTabActivated=function(e){var t=this;D.getTab(e.tabId,function(e){t.checkAndNotifyCS(e)})},m.prototype.getRatingsFromSafeweb=function(e,t){n.manager.getRatingsForURLs(e,function(e){e=e.map(function(e){var t=e.siteRating===n.Rating.SITE_RATING.RATING_PHISHING||e.siteRating===n.Rating.SITE_RATING.RATING_MALWARE;return{url:e.fullURL,isRewritten:t}});t(e)})},m.prototype.sendPopupData=function(n){return G(this,void 0,void 0,function(){var t;return b(this,function(e){switch(e.label){case 0:return[4,this.ready()];case 1:return e.sent(),t=O(a.STRINGS.popup),n({payload:{strings:t}}),[2]}})})},m.prototype.ready=function(){return G(this,void 0,void 0,function(){return b(this,function(e){switch(e.label){case 0:return[4,this.initReadyPromise];case 1:return e.sent(),[2]}})})},m.prototype.setLinkGuardEnabled=function(e){o.set(a.LINK_GUARD_ENABLED,e)},m.prototype.getLinkGuardEnabled=function(){var e=o.get(a.LINK_GUARD_ENABLED);return e=H(e)?!0:e},m.prototype.setDataInCache=function(i,r){return G(this,void 0,void 0,function(){var t,n;return b(this,function(e){switch(e.label){case 0:return[4,this.ready()];case 1:return e.sent(),t=(t=o.get(a.CACHED_URLS))||{scannedUrls:[],rewrittenUrls:[]},K(t.scannedUrls)||(t.scannedUrls=[]),K(t.rewrittenUrls)||(t.rewrittenUrls=[]),(n=t.scannedUrls).push.apply(n,U([],M(i),!1)),(n=t.rewrittenUrls).push.apply(n,U([],M(r),!1)),o.set(a.CACHED_URLS,t),P.setAlarm(a.CACHE_CLEAR_ALARM,{delayInMinutes:a.CACHE_CLEAR_INTERVAL_IN_MINS}),[2]}})})},m.prototype.getUrlsFromCache=function(n){return G(this,void 0,void 0,function(){var t;return b(this,function(e){switch(e.label){case 0:return[4,this.ready()];case 1:return e.sent(),t=o.get(a.CACHED_URLS),n({payload:{scannedUrls:null==t?void 0:t.scannedUrls,rewrittenUrls:null==t?void 0:t.rewrittenUrls}}),[2]}})})},m.prototype.handleAlarm=function(e){e.name===a.CACHE_CLEAR_ALARM&&o.set(a.CACHED_URLS,{})},m.prototype.sendTelemetry=function(t){return G(this,void 0,void 0,function(){return b(this,function(e){switch(e.label){case 0:return[4,this.ready()];case 1:return e.sent(),r.sendEvent(t),[2]}})})},m.prototype.handleMessage=function(e,t,n){var i=e.id,r=e.payload;switch(i){case h.GET_RATINGS:return this.getRatingsFromSafeweb(null==r?void 0:r.urls,t),!0;case h.SHOW_ONE_TIME_SCAN_NOTIFICATION:c.showOneTimeScanNotification(this.config.defaultIconURL);break;case h.GET_TAB_URL:t({payload:{url:n.url}});break;case h.GET_POPUP_DATA:return this.sendPopupData(t),!0;case h.SEND_TELEMETRY:this.sendTelemetry(null==r?void 0:r.telemetryParams);break;case B.uiConstants.NOTIFICATION.MESSAGES.DEFAULT_MESSAGE:this.handleMessageNotification(null==r?void 0:r.eventID);break;case h.SET_DATA_IN_CACHE:this.setDataInCache(r.scannedUrls,r.rewrittenUrls);break;case h.GET_URLS_CACHE:return this.getUrlsFromCache(t),!0}},m.prototype.handleMessageNotification=function(e){e&&e===B.uiConstants.NOTIFICATION.MESSAGES.SECONDARY_LINK_PRESSED&&c.openURLForScanNotification()};var F=u=new m;s.alarmHelper.registerAlarmListener(u.handleAlarm);let e={linkGuardManager:F};return t.default}});