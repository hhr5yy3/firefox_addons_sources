browser.runtime.onInstalled.addListener(function(e){var t;"install"==e.reason?(t=browser.runtime.getManifest().version,browser.tabs.create({url:"https://it.bestshopping.com/html/toolbar-cashback-faq.html?success=true&v="+t.replaceAll(".","_")}),browser.tabs.create({url:browser.runtime.getURL("options.html")}),browser.storage.local.clear(),browser.storage.local.set({tabIdJump:""},function(){}),browser.storage.local.set({merchantKeyJump:""},function(){}),browser.storage.local.set({isMinimized:""},function(){})):"update"==e.reason&&browser.storage.local.clear()}),browser.runtime.onSuspend.addListener(function(){browser.storage.local.clear()}),browser.runtime.onStartup.addListener(function(){browser.storage.local.clear()});var createdTabId=0,iconDefaultPath=(browser.tabs.onUpdated.addListener(function(e,t,o){createdTabId=e}),browser.tabs.onCreated.addListener(function(e,t,o){createdTabId=e.id}),"images/128x128.png"),iconPath="images/128x128.png",iconBlinkPath="images/logo-color-128.png";function BlinkIcon(){var e=iconDefaultPath==iconPath?iconBlinkPath:iconDefaultPath;browser.action.setIcon({path:e}),setTimeout(function(){browser.action.setIcon({path:iconPath}),setTimeout(function(){browser.action.setIcon({path:e}),setTimeout(function(){browser.action.setIcon({path:iconPath}),setTimeout(function(){browser.action.setIcon({path:e}),setTimeout(function(){browser.action.setIcon({path:iconPath})},300)},300)},300)},300)},300)}browser.runtime.onMessage.addListener(function(e,t,o){return"GetCurrentIdTab"==e.message?browser.tabs.query({active:!0,windowType:"normal",lastFocusedWindow:!0},function(e){e[0]&&o(e[0].id)}):"DeactiveCashback"==e.message?browser.tabs.sendMessage(parseInt(e.tabID),{message:"DeactiveCashback"},function(e){}):"BlinkIcon"==e.message?BlinkIcon():null!=e.path&&(iconPath=e.path,browser.action.setIcon({path:e.path})),!0}),browser.tabs.onRemoved.addListener(function(e,t){let n=e,a=-1,r=0;null!=n&&(browser.storage.local.get("tabIdJump",function(e){let o=String(e.tabIdJump).split(",");o.forEach(function(t){t==n&&(o=o.filter(function(e){return e!=t}),a=r),r++}),browser.storage.local.set({tabIdJump:o},function(){})}),browser.storage.local.get("merchantKeyJump",function(e){e=String(e.merchantKeyJump).split(",");delete e[a];let t=0,o="";e.forEach(function(e){o=0==t?e:o+","+e,t++}),browser.storage.local.set({merchantKeyJump:o},function(){})}))});