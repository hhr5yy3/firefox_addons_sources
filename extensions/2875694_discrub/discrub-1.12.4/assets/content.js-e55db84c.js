const u=(i,o)=>{browser.runtime.sendMessage(i).then(r=>{o==null||o(r)})};var l,c;(c=(l=browser.runtime.onMessage).hasListeners)!=null&&c.call(l)||browser.runtime.onMessage.addListener(function(i,o,r){var d,a;if(!document.URL.includes("moz-extension")){const{message:m}=i;switch(m){case"INJECT_BUTTON":const t=((d=document.querySelector('[aria-label="Inbox"]'))==null?void 0:d.parentElement)||((a=document.querySelector('[aria-label="Help"]'))==null?void 0:a.parentElement);if(!document.getElementById("injected_iframe_button")&&t){t.style.display="flex",t.style.flexDirection="row-reverse",t.style.alignItems="center",t.style.justifyContent="center";const e=document.createElement("iframe");e.id="injected_iframe_button",e.src=browser.runtime.getURL("button_injection.html"),e.scrolling="no",e.width=30,e.height=30,t.appendChild(e)}break;case"INJECT_DIALOG":if(!document.getElementById("injected_dialog")){const e=document.createElement("dialog");e.id="injected_dialog",e.innerHTML="<style>::-webkit-scrollbar{width:5px;}::-webkit-scrollbar-thumb{background:#f1f1f1;}::-webkit-scrollbar-track{background:#888;}</style>",e.style.padding=0,e.style.border="none",e.style.backgroundColor="transparent",e.style.overflow="auto";const n=document.createElement("iframe");n.id="injected_dialog_iframe",n.src=browser.runtime.getURL("index.html"),n.height="675px",n.width="1250px",e.appendChild(n),document.body.appendChild(e),document.getElementById("injected_dialog").showModal()}break;case"CLOSE_INJECTED_DIALOG":document.getElementById("injected_dialog")&&(document.getElementById("injected_dialog_iframe").remove(),document.getElementById("injected_dialog").remove());break;case"GET_TOKEN":window.dispatchEvent(new Event("beforeunload"));const s=document.body.appendChild(document.createElement("iframe")).contentWindow.localStorage;s.token?r(JSON.parse(s.token)):r(null)}}});export{u as passMessage};
