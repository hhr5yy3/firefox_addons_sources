/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={7871:function(e,t,r){var n,i,o;e=r.nmd(e),i=[],void 0===(o="function"==typeof(n=function(){"use strict";var t={},n=null;function i(t){if(e&&e.exports)try{return r(6528).randomBytes(t)}catch(e){}try{var i;return(self.crypto||self.msCrypto).getRandomValues(i=new Uint32Array(t)),Array.prototype.slice.call(i)}catch(e){}if(!n)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return n(t)}try{i(1)}catch(e){}function o(e,t){for(var r=0,n=0,i=0,o=e.length;i<o;++i)e.charCodeAt(i)===t.charCodeAt(i)?++r:++n;return!(r<0)&&0===n}n=null,t.setRandomFallback=function(e){n=e},t.genSaltSync=function(e,t){if("number"!=typeof(e=e||y))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2a$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(d(i(p),p)),r.join("")},t.genSalt=function(e,r,n){if("function"==typeof r&&(n=r,r=void 0),"function"==typeof e&&(n=e,e=void 0),void 0===e)e=y;else if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);function i(r){s((function(){try{r(null,t.genSaltSync(e))}catch(e){r(e)}}))}if(!n)return new Promise((function(e,t){i((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);i(n)},t.hashSync=function(e,r){if(void 0===r&&(r=y),"number"==typeof r&&(r=t.genSaltSync(r)),"string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return T(e,r)},t.hash=function(e,r,n,i){function o(n){"string"==typeof e&&"number"==typeof r?t.genSalt(r,(function(t,r){T(e,r,n,i)})):"string"==typeof e&&"string"==typeof r?T(e,r,n,i):s(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise((function(e,t){o((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);o(n)},t.compareSync=function(e,r){if("string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return 60===r.length&&o(t.hashSync(e,r.substr(0,r.length-31)),r)},t.compare=function(e,r,n,i){function a(n){"string"==typeof e&&"string"==typeof r?60===r.length?t.hash(e,r.substr(0,29),(function(e,t){e?n(e):n(null,o(t,r))}),i):s(n.bind(this,null,!1)):s(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise((function(e,t){a((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);a(n)},t.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},t.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var s="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout;function a(e){var t=[],r=0;return h.encodeUTF16toUTF8((function(){return r>=e.length?null:e.charCodeAt(r++)}),(function(e){t.push(e)})),t}var u="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],l=String.fromCharCode;function d(e,t){var r,n,i=0,o=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;i<t;){if(r=255&e[i++],o.push(u[r>>2&63]),r=(3&r)<<4,i>=t){o.push(u[63&r]);break}if(r|=(n=255&e[i++])>>4&15,o.push(u[63&r]),r=(15&n)<<2,i>=t){o.push(u[63&r]);break}r|=(n=255&e[i++])>>6&3,o.push(u[63&r]),o.push(u[63&n])}return o.join("")}function f(e,t){var r,n,i,o,s,a=0,u=e.length,d=0,f=[];if(t<=0)throw Error("Illegal len: "+t);for(;a<u-1&&d<t&&(r=(s=e.charCodeAt(a++))<c.length?c[s]:-1,n=(s=e.charCodeAt(a++))<c.length?c[s]:-1,-1!=r&&-1!=n)&&(o=r<<2>>>0,o|=(48&n)>>4,f.push(l(o)),!(++d>=t||a>=u))&&-1!=(i=(s=e.charCodeAt(a++))<c.length?c[s]:-1)&&(o=(15&n)<<4>>>0,o|=(60&i)>>2,f.push(l(o)),!(++d>=t||a>=u));)o=(3&i)<<6>>>0,o|=(s=e.charCodeAt(a++))<c.length?c[s]:-1,f.push(l(o)),++d;var h=[];for(a=0;a<d;a++)h.push(f[a].charCodeAt(0));return h}var h=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<128?t(127&r):r<2048?(t(r>>6&31|192),t(63&r|128)):r<65536?(t(r>>12&15|224),t(r>>6&63|128),t(63&r|128)):(t(r>>18&7|240),t(r>>12&63|128),t(r>>6&63|128),t(63&r|128)),r=null},decodeUTF8:function(e,t){for(var r,n,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(r=e());)if(128&r)if(192==(224&r))null===(n=e())&&s([r,n]),t((31&r)<<6|63&n);else if(224==(240&r))(null===(n=e())||null===(i=e()))&&s([r,n,i]),t((15&r)<<12|(63&n)<<6|63&i);else{if(240!=(248&r))throw RangeError("Illegal starting byte: "+r);(null===(n=e())||null===(i=e())||null===(o=e()))&&s([r,n,i,o]),t((7&r)<<18|(63&n)<<12|(63&i)<<6|63&o)}else t(r)},UTF16toUTF8:function(e,t){for(var r,n=null;null!==(r=null!==n?n:e());)r>=55296&&r<=57343&&null!==(n=e())&&n>=56320&&n<=57343?(t(1024*(r-55296)+n-56320+65536),n=null):t(r);null!==n&&t(n)},UTF8toUTF16:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<=65535?t(r):(t(55296+((r-=65536)>>10)),t(r%1024+56320)),r=null},encodeUTF16toUTF8:function(t,r){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,r)}))},decodeUTF8toUTF16:function(t,r){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,r)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(t){for(var r,n=0;null!==(r=t());)n+=e.calculateCodePoint(r);return n},calculateUTF16asUTF8:function(t){var r=0,n=0;return e.UTF16toUTF8(t,(function(t){++r,n+=e.calculateCodePoint(t)})),[r,n]}};return e}();Date.now=Date.now||function(){return+new Date};var p=16,y=10,g=16,b=100,v=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],m=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],w=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function _(e,t,r,n){var i,o=e[t],s=e[t+1];return i=n[(o^=r[0])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[1])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[2])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[3])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[4])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[5])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[6])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[7])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[8])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[9])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[10])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[11])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[12])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[13])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],i=n[(o^=(i+=n[768|255&s])^r[14])>>>24],i+=n[256|o>>16&255],i^=n[512|o>>8&255],i=n[(s^=(i+=n[768|255&o])^r[15])>>>24],i+=n[256|s>>16&255],i^=n[512|s>>8&255],o^=(i+=n[768|255&s])^r[16],e[t]=s^r[g+1],e[t+1]=o,e}function S(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|255&e[t],t=(t+1)%e.length;return{key:n,offp:t}}function k(e,t,r){for(var n,i=0,o=[0,0],s=t.length,a=r.length,u=0;u<s;u++)i=(n=S(e,i)).offp,t[u]=t[u]^n.key;for(u=0;u<s;u+=2)o=_(o,0,t,r),t[u]=o[0],t[u+1]=o[1];for(u=0;u<a;u+=2)o=_(o,0,t,r),r[u]=o[0],r[u+1]=o[1]}function x(e,t,r,n){for(var i,o=0,s=[0,0],a=r.length,u=n.length,c=0;c<a;c++)o=(i=S(t,o)).offp,r[c]=r[c]^i.key;for(o=0,c=0;c<a;c+=2)o=(i=S(e,o)).offp,s[0]^=i.key,o=(i=S(e,o)).offp,s[1]^=i.key,s=_(s,0,r,n),r[c]=s[0],r[c+1]=s[1];for(c=0;c<u;c+=2)o=(i=S(e,o)).offp,s[0]^=i.key,o=(i=S(e,o)).offp,s[1]^=i.key,s=_(s,0,r,n),n[c]=s[0],n[c+1]=s[1]}function O(e,t,r,n,i){var o,a=w.slice(),u=a.length;if(r<4||r>31){if(o=Error("Illegal number of rounds (4-31): "+r),n)return void s(n.bind(this,o));throw o}if(t.length!==p){if(o=Error("Illegal salt length: "+t.length+" != "+p),n)return void s(n.bind(this,o));throw o}r=1<<r>>>0;var c,l,d,f=0;function h(){if(i&&i(f/r),!(f<r)){for(f=0;f<64;f++)for(d=0;d<u>>1;d++)_(a,d<<1,c,l);var o=[];for(f=0;f<u;f++)o.push((a[f]>>24&255)>>>0),o.push((a[f]>>16&255)>>>0),o.push((a[f]>>8&255)>>>0),o.push((255&a[f])>>>0);return n?void n(null,o):o}for(var p=Date.now();f<r&&(f+=1,k(e,c,l),k(t,c,l),!(Date.now()-p>b)););n&&s(h)}if(Int32Array?(c=new Int32Array(v),l=new Int32Array(m)):(c=v.slice(),l=m.slice()),x(t,e,c,l),void 0!==n)h();else for(var y;;)if(void 0!==(y=h()))return y||[]}function T(e,t,r,n){var i,o,u;if("string"!=typeof e||"string"!=typeof t){if(i=Error("Invalid string / salt: Not a string"),r)return void s(r.bind(this,i));throw i}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(i=Error("Invalid salt version: "+t.substring(0,2)),r)return void s(r.bind(this,i));throw i}if("$"===t.charAt(2))o=String.fromCharCode(0),u=3;else{if("a"!==(o=t.charAt(2))&&"b"!==o&&"y"!==o||"$"!==t.charAt(3)){if(i=Error("Invalid salt revision: "+t.substring(2,4)),r)return void s(r.bind(this,i));throw i}u=4}if(t.charAt(u+2)>"$"){if(i=Error("Missing salt rounds"),r)return void s(r.bind(this,i));throw i}var c=10*parseInt(t.substring(u,u+1),10)+parseInt(t.substring(u+1,u+2),10),l=t.substring(u+3,u+25),h=a(e+=o>="a"?"\0":""),y=f(l,p);function g(e){var t=[];return t.push("$2"),o>="a"&&t.push(o),t.push("$"),c<10&&t.push("0"),t.push(c.toString()),t.push("$"),t.push(d(y,y.length)),t.push(d(e,4*w.length-1)),t.join("")}if(void 0===r)return g(O(h,y,c));O(h,y,c,(function(e,t){e?r(e,null):r(null,g(t))}),n)}return t.encodeBase64=d,t.decodeBase64=f,t})?n.apply(t,i):n)||(e.exports=o)},7426:(e,t,r)=>{"use strict";function n(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}r.d(t,{A:()=>n})},3551:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(7426);function i(e){return(0,n.A)({},e)}},1613:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};const i=function(e,t,r){var i,o=n[e];return i="string"==typeof o?o:1===t?o.one:o.other.replace("{{count}}",t.toString()),null!=r&&r.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};var o=r(5047);const s={date:(0,o.A)({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:(0,o.A)({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:(0,o.A)({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})};var a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};const u=function(e,t,r,n){return a[e]};var c=r(4797);const l={ordinalNumber:function(e,t){var r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:(0,c.A)({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:(0,c.A)({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,c.A)({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:(0,c.A)({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:(0,c.A)({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};var d=r(3091);const f={code:"en-US",formatDistance:i,formatLong:s,formatRelative:u,localize:l,match:{ordinalNumber:(0,r(6171).A)({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,d.A)({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:(0,d.A)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,d.A)({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:(0,d.A)({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:(0,d.A)({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},1858:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var n={};function i(){return n}},7044:(e,t,r)=>{"use strict";function n(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}r.d(t,{A:()=>n})},551:(e,t,r)=>{"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}r.d(t,{A:()=>n})},4188:(e,t,r)=>{"use strict";function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}r.d(t,{A:()=>n})},7767:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(4188),i=r(123),o=r(551);function s(e,t){(0,o.A)(2,arguments);var r=(0,i.A)(e).getTime(),s=(0,n.A)(t);return new Date(r+s)}},6982:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(123),i=r(551);function o(e,t){(0,i.A)(2,arguments);var r=(0,n.A)(e),o=(0,n.A)(t),s=r.getTime()-o.getTime();return s<0?-1:s>0?1:s}},2293:(e,t,r)=>{"use strict";r.d(t,{A:()=>w});var n=r(1858),i=r(6982),o=r(123),s=r(551);function a(e){(0,s.A)(1,arguments);var t=(0,o.A)(e);return function(e){(0,s.A)(1,arguments);var t=(0,o.A)(e);return t.setHours(23,59,59,999),t}(t).getTime()===function(e){(0,s.A)(1,arguments);var t=(0,o.A)(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}(t).getTime()}function u(e,t){(0,s.A)(2,arguments);var r,n=(0,o.A)(e),u=(0,o.A)(t),c=(0,i.A)(n,u),l=Math.abs(function(e,t){(0,s.A)(2,arguments);var r=(0,o.A)(e),n=(0,o.A)(t);return 12*(r.getFullYear()-n.getFullYear())+(r.getMonth()-n.getMonth())}(n,u));if(l<1)r=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-c*l);var d=(0,i.A)(n,u)===-c;a((0,o.A)(e))&&1===l&&1===(0,i.A)(e,u)&&(d=!1),r=c*(l-Number(d))}return 0===r?0:r}var c={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},l="trunc";function d(e,t,r){(0,s.A)(2,arguments);var n,i=function(e,t){return(0,s.A)(2,arguments),(0,o.A)(e).getTime()-(0,o.A)(t).getTime()}(e,t)/1e3;return((n=null==r?void 0:r.roundingMethod)?c[n]:c[l])(i)}var f=r(1613),h=r(3551),p=r(7426),y=r(7044),g=1440,b=2520,v=43200,m=86400;function w(e,t){return(0,s.A)(1,arguments),function(e,t,r){var a,c;(0,s.A)(2,arguments);var l=(0,n.q)(),w=null!==(a=null!==(c=null==r?void 0:r.locale)&&void 0!==c?c:l.locale)&&void 0!==a?a:f.A;if(!w.formatDistance)throw new RangeError("locale must contain formatDistance property");var _=(0,i.A)(e,t);if(isNaN(_))throw new RangeError("Invalid time value");var S,k,x=(0,p.A)((0,h.A)(r),{addSuffix:Boolean(null==r?void 0:r.addSuffix),comparison:_});_>0?(S=(0,o.A)(t),k=(0,o.A)(e)):(S=(0,o.A)(e),k=(0,o.A)(t));var O,T=d(k,S),A=((0,y.A)(k)-(0,y.A)(S))/1e3,E=Math.round((T-A)/60);if(E<2)return null!=r&&r.includeSeconds?T<5?w.formatDistance("lessThanXSeconds",5,x):T<10?w.formatDistance("lessThanXSeconds",10,x):T<20?w.formatDistance("lessThanXSeconds",20,x):T<40?w.formatDistance("halfAMinute",0,x):T<60?w.formatDistance("lessThanXMinutes",1,x):w.formatDistance("xMinutes",1,x):0===E?w.formatDistance("lessThanXMinutes",1,x):w.formatDistance("xMinutes",E,x);if(E<45)return w.formatDistance("xMinutes",E,x);if(E<90)return w.formatDistance("aboutXHours",1,x);if(E<g){var C=Math.round(E/60);return w.formatDistance("aboutXHours",C,x)}if(E<b)return w.formatDistance("xDays",1,x);if(E<v){var R=Math.round(E/g);return w.formatDistance("xDays",R,x)}if(E<m)return O=Math.round(E/v),w.formatDistance("aboutXMonths",O,x);if((O=u(k,S))<12){var P=Math.round(E/v);return w.formatDistance("xMonths",P,x)}var j=O%12,I=Math.floor(O/12);return j<3?w.formatDistance("aboutXYears",I,x):j<9?w.formatDistance("overXYears",I,x):w.formatDistance("almostXYears",I+1,x)}(e,Date.now(),t)}},5047:(e,t,r)=>{"use strict";function n(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}r.d(t,{A:()=>n})},4797:(e,t,r)=>{"use strict";function n(e){return function(t,r){var n;if("formatting"===(null!=r&&r.context?String(r.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,o=null!=r&&r.width?String(r.width):i;n=e.formattingValues[o]||e.formattingValues[i]}else{var s=e.defaultWidth,a=null!=r&&r.width?String(r.width):e.defaultWidth;n=e.values[a]||e.values[s]}return n[e.argumentCallback?e.argumentCallback(t):t]}}r.d(t,{A:()=>n})},3091:(e,t,r)=>{"use strict";function n(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],o=t.match(i);if(!o)return null;var s,a=o[0],u=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(u)?function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r;return}(u,(function(e){return e.test(a)})):function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r;return}(u,(function(e){return e.test(a)}));return s=e.valueCallback?e.valueCallback(c):c,{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(a.length)}}}r.d(t,{A:()=>n})},6171:(e,t,r)=>{"use strict";function n(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var i=n[0],o=t.match(e.parsePattern);if(!o)return null;var s=e.valueCallback?e.valueCallback(o[0]):o[0];return{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(i.length)}}}r.d(t,{A:()=>n})},76:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});Math.pow(10,8);var n=6e4,i=36e5,o=r(551),s=r(4188);function a(e,t){var r;(0,o.A)(1,arguments);var a=(0,s.A)(null!==(r=null==t?void 0:t.additionalDigits)&&void 0!==r?r:2);if(2!==a&&1!==a&&0!==a)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var g,b=function(e){var t,r={},n=e.split(u.dateTimeDelimiter);if(n.length>2)return r;/:/.test(n[0])?t=n[0]:(r.date=n[0],t=n[1],u.timeZoneDelimiter.test(r.date)&&(r.date=e.split(u.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length)));if(t){var i=u.timezone.exec(t);i?(r.time=t.replace(i[1],""),r.timezone=i[1]):r.time=t}return r}(e);if(b.date){var v=function(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var i=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:null===o?i:100*o,restDateString:e.slice((n[1]||n[2]).length)}}(b.date,a);g=function(e,t){if(null===t)return new Date(NaN);var r=e.match(c);if(!r)return new Date(NaN);var n=!!r[4],i=f(r[1]),o=f(r[2])-1,s=f(r[3]),a=f(r[4]),u=f(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,a,u)?function(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var i=n.getUTCDay()||7,o=7*(t-1)+r+1-i;return n.setUTCDate(n.getUTCDate()+o),n}(t,a,u):new Date(NaN);var l=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(p[t]||(y(e)?29:28))}(t,o,s)&&function(e,t){return t>=1&&t<=(y(e)?366:365)}(t,i)?(l.setUTCFullYear(t,o,Math.max(i,s)),l):new Date(NaN)}(v.restDateString,v.year)}if(!g||isNaN(g.getTime()))return new Date(NaN);var m,w=g.getTime(),_=0;if(b.time&&(_=function(e){var t=e.match(l);if(!t)return NaN;var r=h(t[1]),o=h(t[2]),s=h(t[3]);if(!function(e,t,r){if(24===e)return 0===t&&0===r;return r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,o,s))return NaN;return r*i+o*n+1e3*s}(b.time),isNaN(_)))return new Date(NaN);if(!b.timezone){var S=new Date(w+_),k=new Date(0);return k.setFullYear(S.getUTCFullYear(),S.getUTCMonth(),S.getUTCDate()),k.setHours(S.getUTCHours(),S.getUTCMinutes(),S.getUTCSeconds(),S.getUTCMilliseconds()),k}return m=function(e){if("Z"===e)return 0;var t=e.match(d);if(!t)return 0;var r="+"===t[1]?-1:1,o=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,s))return NaN;return r*(o*i+s*n)}(b.timezone),isNaN(m)?new Date(NaN):new Date(w+_+m)}var u={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},c=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,d=/^([+-])(\d{2})(?::?(\d{2}))?$/;function f(e){return e?parseInt(e):1}function h(e){return e&&parseFloat(e.replace(",","."))||0}var p=[31,null,31,30,31,30,31,31,30,31,30,31];function y(e){return e%400==0||e%4==0&&e%100!=0}},123:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(2284),i=r(551);function o(e){(0,i.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,n.A)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},2773:(e,t,r)=>{var n=r(4606);e.exports=n},3893:(e,t,r)=>{var n=/(<\/?[a-z][a-z0-9]*(?::[a-z][a-z0-9]*)?\s*(?:\s+[a-z0-9-_]+=(?:(?:'[\s\S]*?')|(?:"[\s\S]*?")))*\s*\/?>)|([^<]|<(?![a-z\/]))*/gi,i=/\s[a-z0-9-_]+\b(\s*=\s*('|")[\s\S]*?\2)?/gi,o=/(\s[a-z0-9-_]+\b\s*)(?:=(\s*('|")[\s\S]*?\3))?/gi,s=/^<[a-z]/,a=/\/>$/,u=/^<\//,c=/<\/?([a-z][a-z0-9]*)(?::([a-z][a-z0-9]*))?/i,l=/^('|")|('|")$/g,d=/^(?:area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/i,f=r(6917);function h(e,t,r){for(var h,p,y,g,b,v,m,w,_=[],S=0,k=e.match(n),x=!1,O=null,T=0,A=k.length;T<A;T++)if(p=(w=k[T]).match(c),(h=t.test(w))&&!x&&(x=!0),x){if(s.test(w)){y=a.test(w)||d.test(p[1]),g=[];for(var E=0,C=(v=w.match(i)||[]).length;E<C;E++)o.lastIndex=0,b=o.exec(v[E]),g.push({name:b[1].trim(),value:(b[2]||"").trim().replace(l,"")});(O&&O.childNodes||_).push(m=new f({nodeType:1,nodeName:p[1],namespace:p[2],attributes:g,childNodes:[],parentNode:O,startTag:w,selfCloseTag:y})),S++,!r&&h&&O&&_.push(m),y?S--:O=m}else u.test(w)?O.nodeName==p[1]&&(O=O.parentNode,S--):O.childNodes.push(new f({nodeType:3,text:w,parentNode:O}));if(0==S&&(x=!1,O=null,r))break}return r?_[0]||null:_}function p(e){this.rawHTML=e}p.prototype.getElementsByClassName=function(e){var t=new RegExp("class=('|\")(.*?\\s)?"+e+"(\\s.*?)?\\1");return h(this.rawHTML,t)},p.prototype.getElementsByTagName=function(e){var t=new RegExp("^<"+e,"i");return h(this.rawHTML,t)},p.prototype.getElementById=function(e){var t=new RegExp("id=('|\")"+e+"\\1");return h(this.rawHTML,t,!0)},p.prototype.getElementsByName=function(e){return this.getElementsByAttribute("name",e)},p.prototype.getElementsByAttribute=function(e,t){var r=new RegExp("\\s"+e+"=('|\")"+t+"\\1");return h(this.rawHTML,r)},e.exports=p},4606:(e,t,r)=>{var n=r(3893);function i(){}i.prototype.parseFromString=function(e){return new n(e)},e.exports=i},6917:e=>{function t(e){this.namespace=e.namespace||null,this.text=e.text,this._selfCloseTag=e.selfCloseTag,Object.defineProperties(this,{nodeType:{value:e.nodeType},nodeName:{value:1==e.nodeType?e.nodeName:"#text"},childNodes:{value:e.childNodes},firstChild:{get:function(){return this.childNodes[0]||null}},lastChild:{get:function(){return this.childNodes[this.childNodes.length-1]||null}},parentNode:{value:e.parentNode||null},attributes:{value:e.attributes||[]},innerHTML:{get:function(){for(var e,t="",r=0,n=this.childNodes.length;r<n;r++)t+=3===(e=this.childNodes[r]).nodeType?e.text:e.outerHTML;return t}},outerHTML:{get:function(){if(3!=this.nodeType){var e,t=(this.attributes.map((function(e){return e.name+(e.value?'="'+e.value+'"':"")}))||[]).join(" ");e="<"+this.nodeName+(t?" "+t:"")+(this._selfCloseTag?"/":"")+">",this._selfCloseTag||(e+=(this._selfCloseTag?"":this.childNodes.map((function(e){return e.outerHTML}))||[]).join(""),e+="</"+this.nodeName+">")}else e=this.textContent;return e}},textContent:{get:function(){return this.nodeType==t.TEXT_NODE?this.text:this.childNodes.map((function(e){return e.textContent})).join("").replace(/\x20+/g," ")}}})}function r(e,t,n){var i=[];if(n=!!n,3!==e.nodeType)for(var o=0,s=e.childNodes.length;o<s&&(3===e.childNodes[o].nodeType||!t(e.childNodes[o])||(i.push(e.childNodes[o]),!n));o++)i=i.concat(r(e.childNodes[o],t));return n?i[0]:i}t.prototype.getAttribute=function(e){for(var t=0,r=this.attributes.length;t<r;t++)if(this.attributes[t].name==e)return this.attributes[t].value;return null},t.prototype.getElementsByTagName=function(e){return r(this,(function(t){return t.nodeName==e}))},t.prototype.getElementsByClassName=function(e){var t=new RegExp("^(.*?\\s)?"+e+"(\\s.*?)?$");return r(this,(function(e){return e.attributes.length&&t.test(e.getAttribute("class"))}))},t.prototype.getElementById=function(e){return r(this,(function(t){return t.attributes.length&&t.getAttribute("id")==e}),!0)},t.prototype.getElementsByName=function(e){return r(this,(function(t){return t.attributes.length&&t.getAttribute("name")==e}))},t.ELEMENT_NODE=1,t.TEXT_NODE=3,e.exports=t},7284:e=>{(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{API:()=>o,CONNECTION_STATUS:()=>l,Connection:()=>w,DATA_TYPE:()=>i,ERROR_TYPE:()=>f,EVENT:()=>s,IDB_MODE:()=>u,OCCURENCE:()=>c,QUERY_OPTION:()=>a,WORKER_STATUS:()=>n,forObj:()=>S,promise:()=>p,promiseAll:()=>_,promiseResolve:()=>y});var n,i,o,s,a,u,c,l,d=function(){function e(e,t){this.type=e,this._info=t,this.message=this.getMsg()}return e.prototype.throw=function(){throw this},e.prototype.log=function(e){this.status&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.logWarning=function(){console.warn(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg=function(){return this.type,this.message},e}(),f={InvalidUpdateColumn:"invalid_update_column",UndefinedColumn:"undefined_column",UndefinedValue:"undefined_value",UndefinedColumnName:"undefined_column_name",UndefinedDbName:"undefined_database_name",UndefinedColumnValue:"undefined_column_value",NotArray:"not_array",NoValueSupplied:"no_value_supplied",ColumnNotExist:"column_not_exist",NoIndexFound:"no_index_found",InvalidOp:"invalid_operator",NullValue:"null_value",WrongDataType:"wrong_data_type",TableNotExist:"table_not_exist",DbNotExist:"db_not_exist",ConnectionAborted:"connection_aborted",ConnectionClosed:"connection_closed",NotObject:"not_object",InvalidConfig:"invalid_config",DbBlocked:"Db_blocked",IndexedDbNotSupported:"indexeddb_not_supported",NullValueInWhere:"null_value_in_where",InvalidJoinQuery:"invalid_join_query",InvalidQuery:"invalid_query",ImportScriptsFailed:"import_scripts_failed",MethodNotExist:"method_not_exist",Unknown:"unknown",InvalidMiddleware:"invalid_middleware",InvalidOrderQuery:"invalid_order_query",InvalidGroupQuery:"invalid_group_query",NoPrimaryKey:"no_primary_key"};!function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(n||(n={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(i||(i={})),function(e){e.InitDb="init_db",e.MapGet="map_get",e.MapSet="map_set",e.MapHas="map_has",e.MapDelete="map_delete",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts",e.Middleware="middleware"}(o||(o={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled",e.Upgrade="upgrade",e.Create="create",e.Open="open"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.List="list",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(a||(a={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(u||(u={})),function(e){e.First="f",e.Last="l",e.Any="a"}(c||(c={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(l||(l={}));var h,p=function(e){return new Promise(e)},y=function(e){return Promise.resolve(e)},g=function(){function e(e){this._events={},this._ctx=e}return e.prototype.on=function(e,t){return null==this._events[e]&&(this._events[e]=[]),this._events[e].push(t),this},e.prototype.off=function(e,t){if(this._events[e])if(t){var r=this._events[e].indexOf(t);this._events[e].splice(r,1)}else this._events[e]=[]},e.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=this._events[e]||[],o=0,s=i.length,a=[];return new Promise((function(e){var n=function(){o<s?function(){var e=i[o++];if(e){var n=e.call.apply(e,function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}([t._ctx],r,!1));return n&&n.then?n:Promise.resolve(n)}}().then((function(e){a.push(e),n()})):e(a)};n()}))},e.prototype.destroy=function(){this._events=null,this._ctx=null},e}(),b=function(){function e(e){this.isConOpened_=!1,this.isDbIdle_=!0,this.requestQueue_=[],this.isCodeExecuting_=!1,this.inactivityTimer_=-1e3,this.middlewares=[],this.eventBus_=new g(this),this.whiteListApi_=[o.InitDb,o.OpenDb,o.MapGet,o.MapSet,o.MapHas,o.MapDelete,o.ChangeLogStatus,o.Terminate,o.DropDb],this.isWorker=!0,this.logger=new d(null),e?(this.worker_=e,this.worker_.onmessage=this.onMessageFromWorker_.bind(this)):(this.isWorker=!1,this.initQueryManager_())}return Object.defineProperty(e.prototype,"jsstoreWorker",{get:function(){return this.$worker||self.JsStoreWorker},enumerable:!1,configurable:!0}),e.prototype.initQueryManager_=function(){var e=this.jsstoreWorker;e&&(this.queryManager=new e.QueryManager(this.processFinishedQuery_.bind(this)))},e.prototype.onMessageFromWorker_=function(e){this.processFinishedQuery_(e.data)},e.prototype.processFinishedQuery_=function(e){var t=this.requestQueue_.shift();if(t){if(this.logger.log("request ".concat(t.name," finished")),e.error)t.onError(e.error);else{switch(t.name){case o.OpenDb:case o.InitDb:this.isConOpened_=!0;break;case o.Terminate:this.isConOpened_=!1,!0===this.isWorker&&this.worker_.terminate();case o.DropDb:this.isConOpened_=!1,this.requestQueue_=[],this.isDbIdle_=!0;break;case o.CloseDb:this.isDbIdle_=!0,this.eventBus_.emit(s.RequestQueueEmpty,[]),this.requestQueue_.length>0&&this.openDb_(!1)}t.onSuccess(e.result)}this.isCodeExecuting_=!1,this.executeQry_()}},e.prototype.openDb_=function(e){void 0===e&&(e=!0);var t={name:o.OpenDb,query:{name:this.database.name,version:this.database.version},onSuccess:function(){},onError:function(e){console.error(e)}};e?this.prcoessExecutionOfQry_(t,0):this.requestQueue_.splice(0,0,t)},e.prototype.executeMiddleware_=function(e){var t=this;return p((function(r){var n=0,i=t.middlewares.length-1,o=function(){if(n<=i){var s=t.middlewares[n++](e);s&&s.then||(s=y(s)),s.then((function(e){o()}))}else r()};o()}))},e.prototype.callResultMiddleware=function(e,t){return p((function(r){var n=0,i=e.length-1,o=function(){if(n<=i){var s=e[n++](t);s.then||(s=y(s)),s.then((function(e){t=e,o()}))}else r(t)};o()}))},e.prototype.pushApi=function(e){var t=this;return new Promise((function(r,n){var i=[];e.onResult=function(e){i.push((function(t){return e(t)}))},t.executeMiddleware_(e).then((function(){e.onSuccess=function(n){t.callResultMiddleware(i,n).then((function(e){r(e)})).catch((function(t){e.onError(t)}))},e.onError=function(e){i=[],n(e)},0===t.requestQueue_.length&&(t.eventBus_.emit(s.RequestQueueFilled,[]),t.isDbIdle_&&t.isConOpened_&&([o.InitDb,o.CloseDb,o.DropDb,o.OpenDb,o.Terminate].indexOf(e.name)>=0||t.openDb_()),clearTimeout(t.inactivityTimer_)),t.prcoessExecutionOfQry_(e)})).catch(n)}))},e.prototype.prcoessExecutionOfQry_=function(e,t){this.isDbIdle_=!1,null!=t?this.requestQueue_.splice(t,0,e):this.requestQueue_.push(e),this.logger.log("request pushed: "+e.name),this.executeQry_()},e.prototype.executeQry_=function(){var e=this,t=this.requestQueue_.length;if(!this.isCodeExecuting_&&t>0){if(!0===this.isConOpened_)return void this.sendRequestToWorker_(this.requestQueue_[0]);var r=this.requestQueue_.findIndex((function(t){return e.whiteListApi_.indexOf(t.name)>=0}));r>=0&&(this.requestQueue_.splice(0,0,this.requestQueue_.splice(r,1)[0]),this.sendRequestToWorker_(this.requestQueue_[0]))}else 0===t&&!1===this.isDbIdle_&&this.isConOpened_&&(this.inactivityTimer_=setTimeout((function(){e.prcoessExecutionOfQry_({name:o.CloseDb,onSuccess:function(){},onError:function(e){console.error(e)}})}),100))},e.prototype.sendRequestToWorker_=function(e){this.isCodeExecuting_=!0,this.logger.log("request executing: "+e.name);var t={name:e.name,query:e.query};!0===this.isWorker?this.worker_.postMessage(t):this.queryManager.run(t)},e}(),v=function(){function e(e){this.con=e}return e.prototype.get=function(e){return this.con.pushApi({name:o.MapGet,query:e})},e.prototype.has=function(e){return this.con.pushApi({name:o.MapHas,query:e})},e.prototype.set=function(e,t){return this.con.pushApi({name:o.MapSet,query:{key:e,value:t}})},e.prototype.delete=function(e){return this.con.pushApi({name:o.MapDelete,query:e})},e}(),m=(h=function(e,t){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},h(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),w=function(e){function t(t){var r=e.call(this,t)||this;return r.Map=new v(r),r}return m(t,e),t.prototype.initDb=function(e){var t=this;return this.database=e,this.pushApi({name:o.InitDb,query:e}).then((function(e){var r,n=e.database;return e.isCreated&&(r=e.oldVersion?t.eventBus_.emit(s.Upgrade,n,e.oldVersion,e.newVersion):t.eventBus_.emit(s.Create,n)),(r||y()).then((function(e){return t.eventBus_.emit(s.Open,n)})).then((function(t){return e.isCreated}))}))},t.prototype.dropDb=function(){return this.pushApi({name:o.DropDb})},t.prototype.select=function(e){return this.pushApi({name:o.Select,query:e})},t.prototype.count=function(e){return this.pushApi({name:o.Count,query:e})},t.prototype.insert=function(e){return this.pushApi({name:o.Insert,query:e})},t.prototype.update=function(e){return this.pushApi({name:o.Update,query:e})},t.prototype.remove=function(e){return this.pushApi({name:o.Remove,query:e})},t.prototype.clear=function(e){return this.pushApi({name:o.Clear,query:e})},Object.defineProperty(t.prototype,"logStatus",{set:function(e){this.logger.status=e,this.pushApi({name:o.ChangeLogStatus,query:e})},enumerable:!1,configurable:!0}),t.prototype.openDb=function(e,t){var r=this;return this.pushApi({name:o.OpenDb,query:{version:t,name:e}}).then((function(e){return r.database=e,e}))},t.prototype.getDbList=function(){return console.warn("Api getDbList is recommended to use for debugging only. Do not use in code."),indexedDB.databases()},t.prototype.get=function(e){return console.warn("This API is obsolete, please use Map"),this.Map.get(e)},t.prototype.set=function(e,t){return console.warn("This API is obsolete, please use Map"),this.Map.set(e,t)},t.prototype.terminate=function(){return this.pushApi({name:o.Terminate})},t.prototype.transaction=function(e){return this.pushApi({name:o.Transaction,query:e})},t.prototype.on=function(e,t){this.eventBus_.on(e,t)},t.prototype.off=function(e,t){this.eventBus_.off(e,t)},t.prototype.union=function(e){return this.pushApi({name:o.Union,query:e})},t.prototype.intersect=function(e){return this.pushApi({name:o.Intersect,query:e})},t.prototype.addPlugin=function(e,t){return e.setup(this,t)},t.prototype.addMiddleware=function(e,t){return t?this.pushApi({name:o.Middleware,query:e}):(this.middlewares.push(e),Promise.resolve())},t.prototype.importScripts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.pushApi({name:o.ImportScripts,query:e})},t}(b),_=function(e){return Promise.all(e)},S=function(e,t){for(var r in e)t(r,e[r])};e.exports=r})()},7130:e=>{(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{QueryManager:()=>it});var n,i,o,s,a,u,c,l,d=function(e){return Promise.resolve(e)},f=function(e){return new Promise(e)},h="not_array",p="no_value_supplied",y="column_not_exist",g="no_index_found",b="null_value",v="wrong_data_type",m="table_not_exist",w="not_object",_="Db_blocked",S="indexeddb_not_supported",k="null_value_in_where",x="invalid_join_query",O="import_scripts_failed",T="method_not_exist",A="invalid_middleware";!function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(n||(n={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(i||(i={})),function(e){e.InitDb="init_db",e.MapGet="map_get",e.MapSet="map_set",e.MapHas="map_has",e.MapDelete="map_delete",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts",e.Middleware="middleware"}(o||(o={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled",e.Upgrade="upgrade",e.Create="create",e.Open="open"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.List="list",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(a||(a={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(u||(u={})),function(e){e.First="f",e.Last="l",e.Any="a"}(c||(c={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(l||(l={}));var E,C=function(){function e(e){this.columns=[],this.autoIncColumnValue={},this.columns=this.setColumn(e.columns),this.name=e.name,this.alter=e.alter||{}}return e.prototype.setColumn=function(e){var t=[],r=function(r){var i=e[r];i.name=r,i.autoIncrement&&(n.autoIncColumnValue[r]=0),i.primaryKey&&(n.primaryKey=r,n.keypath=i.keyPath||r),i.enableSearch=null==i.enableSearch||i.enableSearch;var o=n.columns.indexOf((function(e){return e.name===r}));if(o<0)t.push(i);else{var s=n.columns[o];Object.assign(s,i)}},n=this;for(var i in e)r(i);return t},e}(),R=function(){function e(){}return e.autoIncrementKey=function(e,t){return"JsStore_".concat(e,"_").concat(t,"_Value")},e.getStore=function(t){return t.tx||t.createTransaction([e.tableName]),t.objectStore(e.tableName)},e.set=function(t,r,n){var i=e.getStore(n);return f((function(e,n){var o=i.put({key:t,value:r});o.onsuccess=function(){e()},o.onerror=n}))},e.get=function(t,r){var n=e.getStore(r);return f((function(e,i){var o=n.get(r.keyRange(t));o.onsuccess=function(){var t=o.result;e(t&&t.value)},o.onerror=i}))},e.remove=function(t,r){var n=e.getStore(r);return f((function(e,i){var o=n.delete(r.keyRange(t));o.onsuccess=function(){e()},o.onerror=i}))},e.has=function(t,r){var n=e.getStore(r);return f((function(e,i){var o=n.count(r.keyRange(t));o.onsuccess=function(){var t=o.result;e(t>0)},o.onerror=i}))},e.tableName="JsStore_Meta",e.dbSchema="JsStore_DbSchema",e}(),P=function(e){this.name=e.name,this.version=e.version||1,e.tables.push({name:R.tableName,columns:{key:{primaryKey:!0},value:{enableSearch:!1}}}),this.tables=e.tables.map((function(e){return new C(e)}))},j=function(e,t){for(var r in e)t(r,e[r])},I=function(){function e(e,t){this.type=e,this.info_=t,this.message=this.getMsg_()}return e.prototype.log=function(e){this.status&&console.log(e)},e.prototype.throw=function(){throw this.get()},e.prototype.logError=function(){console.error(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.warn=function(){console.warn(this.get())},e.prototype.getMsg_=function(){var e,t,r=this.info_,n=((e={})[h]=function(){t="Supplied value is not an array"},e.undefined_column=function(){t="Column is undefined in Where"},e.undefined_value=function(){t="Value is undefined in Where"},e.undefined_column_name=function(){t="Column name is undefined '"+r.TableName+"'"},e.undefined_database_name=function(){t="Database name is not supplied"},e.undefined_column_value=function(){t="Column value is undefined"},e[p]=function(){t="No value is supplied"},e.invalid_operator=function(){t="Invalid Op Value '"+r.Op+"'"},e[y]=function(){var e=r.column;t=r.isOrder?"Column '".concat(e,"' in order query does not exist"):"Column '".concat(e,"' does not exist")},e[g]=function(){t="No index found for column '"+r.column+"'. Query can not be executed without index."},e[b]=function(){t="Null value is not allowed for column '"+r.ColumnName+"'"},e[v]=function(){t="Expected data type for the column ".concat(r.column," is ").concat(r.expected,", but received a ").concat(r.received,".")},e[m]=function(){t="Table '"+r.tableName+"' does not exist"},e.db_not_exist=function(){t="Database with name ".concat(r.dbName," does not exist")},e[w]=function(){t="supplied value is not object"},e.invalid_config=function(){t="Invalid Config '"+r.Config+" '"},e[_]=function(){t="database is blocked, cant be deleted right now"},e[k]=function(){t="Null/undefined is not allowed in where. Column '".concat(r.column,"' has null")},e[T]=function(){t="method '".concat(r,"' does not exist.")},e[S]=function(){t="Browser does not support indexeddb"},e.getInfo=function(){t=r},e[x]=function(){n.getInfo()},e[O]=function(){n.getInfo()},e[A]=function(){t="No function ".concat(r," is found.")},e),i=this.type,o=n[i];return o?o():(i||(this.type="unknown"),t=this.message),t},e}(),M=function(){function e(){this.logger=new I(null)}return e.prototype.emptyTx=function(){this.tx&&(this.tx.oncomplete=null,this.tx.onabort=null,this.tx.onerror=null,this.tx=null)},e.prototype.createTransactionIfNotExist=function(e,t){this.tx||this.createTransaction(e,t)},e.prototype.createTransaction=function(e,t){var r=this;return void 0===t&&(t=u.ReadWrite),this.tx=this.con.transaction(e,t),f((function(e,t){r.tx.oncomplete=e,r.tx.onabort=e,r.tx.onerror=t}))},e.prototype.keyRange=function(e,t){var r;switch(t){case a.Between:r=IDBKeyRange.bound(e.low,e.high,!1,!1);break;case a.GreaterThan:r=IDBKeyRange.lowerBound(e,!0);break;case a.GreaterThanEqualTo:r=IDBKeyRange.lowerBound(e);break;case a.LessThan:r=IDBKeyRange.upperBound(e,!0);break;case a.LessThanEqualTo:r=IDBKeyRange.upperBound(e);break;default:r=IDBKeyRange.only(e)}return r},e.prototype.objectStore=function(e){return this.tx.objectStore(e)},e.prototype.abortTransaction=function(){this.tx&&this.tx.abort()},e.prototype.close=function(){var e=this;return this.con&&this.con.close(),f((function(t){e.con=null,setTimeout(t,100)}))},e.prototype.initDb=function(e){var t,r=this,n=!1,i=e.version;return f((function(o,s){var a=indexedDB.open(e.name,i);a.onsuccess=function(){r.con=a.result,r.con.onversionchange=function(e){e.target.close()},o({isCreated:n,oldVersion:t,newVersion:i})},a.onerror=function(e){console.error("error",e),s(e)},a.onupgradeneeded=function(r){t=r.oldVersion;var o=r.target,s=o.result;n=!0;var a=o.transaction,u=s.objectStoreNames,c=function(e,t){var r=t.name;if(t.enableSearch&&!e.indexNames.contains(r)){var n=t.primaryKey?{unique:!0}:{unique:t.unique};n.multiEntry=t.multiEntry;var i=null==t.keyPath?r:t.keyPath;e.createIndex(r,i,n)}},l=function(e,t,r){var n=t.columns.findIndex((function(e){return e.name===r}));n>=0&&(t.columns.splice(n,1),e.deleteIndex(r))};e.tables.forEach((function(e){u.contains(e.name)||function(e){var t=e.primaryKey?{keyPath:e.keypath}:{autoIncrement:!0},r=s.createObjectStore(e.name,t);e.columns.forEach((function(e){c(r,e)}))}(e);for(var r=a.objectStore(e.name),n=t+1;n<=i;n++){var o=e.alter[n];o&&(o.add&&e.setColumn(o.add).forEach((function(t){c(r,t),e.columns.push(t)})),j(o.drop||{},(function(t){l(r,e,t)})),j(o.modify||{},(function(t,n){var i=n.multiEntry||n.keyPath||n.unique,o=e.columns.find((function(e){return e.name===t})),s=Object.assign(o,n);s.name=t,i&&(l(r,e,t),c(r,s),e.columns.push(s))})))}}));for(var d=function(t,r){var n=u.item(t);e.tables.findIndex((function(e){return e.name===n}))<0&&s.deleteObjectStore(n)},f=0,h=u.length;f<h;f++)d(f)}}))},e}(),D=function(e){return Promise.all(e)},N=function(e){return Promise.reject(e)},B=function(e){if(e instanceof I)return e.logError(),e.get();var t=void 0;return e.name?(t=new I(e.name)).message=e.message:(t=new I(e.target.error.name)).message=e.target.error.message,t.get()},U=function(){function e(){this.rowAffected=0,this.isTxQuery=!1,this.results=[]}return Object.defineProperty(e.prototype,"db",{get:function(){return this.util.db},enumerable:!1,configurable:!0}),e.prototype.table=function(e){var t=e||this.tableName;return this.db.tables.find((function(e){return e.name===t}))},e.prototype.primaryKey=function(e){var t=this.query;return!t.from&&t.store&&t.meta?t.meta.primaryKey:this.table(e).primaryKey},e.prototype.getColumnInfo=function(e,t){return this.table(t).columns.find((function(t){return t.name===e}))},e.prototype.onException=function(e,t){return console.error(e),this.util.abortTransaction(),N(function(e,t){return void 0===t&&(t="invalid_query"),e.name=t,B(e)}(e,t))},e}(),F=function(e){if(null==e)return i.Null;var t=typeof e;if("object"===t){if(Array.isArray(e))return i.Array;if(e instanceof Date)return i.DateTime}return t},z=function(e){return null==e||"number"==typeof e&&isNaN(e)},L=function(){function e(e,t){this.table=e,this.autoIncrementValue=t}return e.prototype.checkAndModifyValues=function(e){var t,r=this;this.query=e;var n=e.values,i=[];return n.every((function(n,o){return t=r.checkAndModifyValue(n),e.ignore&&t&&(i.push(o),t=null),!t})),i.forEach((function(e){n.splice(e,1)})),{err:t,values:n}},e.prototype.checkAndModifyValue=function(e){var t,r=this;return this.table.columns.every((function(n){return!(t=r.checkAndModifyColumnValue_(n,e))})),t},e.prototype.checkNotNullAndDataType_=function(e,t){if(e.notNull&&z(t[e.name]))return this.getError(b,{ColumnName:e.name});if(e.dataType&&!z(t[e.name])){var r=F(t[e.name]);if(r!==e.dataType)return this.getError(v,{column:e.name,expected:e.dataType,received:r})}},e.prototype.checkAndModifyColumnValue_=function(e,t){var r=t[e.name];if(e.autoIncrement?z(r)?t[e.name]=++this.autoIncrementValue[e.name]:F(r)===i.Number&&r>this.autoIncrementValue[e.name]&&(this.autoIncrementValue[e.name]=r):void 0!==e.default&&z(r)&&(t[e.name]=e.default),this.query.validation)return this.checkNotNullAndDataType_(e,t)},e.prototype.getError=function(e,t){return new I(e,t)},e}(),q=function(){function e(e){this.table=e}return e.prototype.check=function(e,t){var r,n=this;return typeof e===i.Object?this.table?this.table.columns.every((function(t){return t.name in e&&(r=n.checkByColumn_(t,e[t.name])),!r})):r=new I(m,{tableName:t}):r=new I(w),r},e.prototype.checkByColumn_=function(e,t){if(!0===e.notNull&&z(t))return new I(b,{ColumnName:e.name});var r=F(t),n=null!=t;if(e.dataType&&n&&r!==e.dataType&&"object"!==r)return new I(v,{column:e.name,expected:e.dataType,received:r});if(n&&"object"===r){var i=["+","-","*","/","{push}"];for(var o in t)if(i.indexOf(o)<0&&e.dataType&&r!==e.dataType)return new I(v,{column:e.name,expected:e.dataType,received:r})}},e}(),$=function(){function e(e){this.db=e}return e.prototype.validate=function(e,t){switch(e){case o.Select:case o.Remove:case o.Count:return this.checkSelect(t);case o.Insert:return this.checkInsertQuery(t);case o.Update:return this.checkUpdate(t)}},e.prototype.getTable_=function(e){return this.db.tables.find((function(t){return t.name===e}))},e.prototype.isInsertQryValid=function(e){var t,r=this.getTable_(e.into);if(r)switch(F(e.values)){case i.Array:break;case i.Null:t=new I(p);break;default:t=new I(h)}else t=new I(m,{tableName:e.into});return{table:r,log:t}},e.prototype.checkUpdate=function(e){var t=new q(this.getTable_(e.in)).check(e.set,e.in);if(t)return t;if(null!=e.where){if(t=this.checkForNullInWhere_(e))return t;this.addGreatAndLessToNotOp_(e)}},e.prototype.checkSelect=function(e){if(!e.store&&!this.getTable_(e.from))return new I(m,{tableName:e.from});if(e.where){var t=this.checkForNullInWhere_(e);if(t)return t;this.addGreatAndLessToNotOp_(e)}},e.prototype.checkForNullInWhere_=function(e){for(var t in e.where)if(null==e.where[t])return new I(k,{column:t})},e.prototype.addGreatAndLessToNotOp_=function(e){var t=e.where,r=function(e,t){return t.findIndex((function(t){return null!=e[t][a.NotEqualTo]}))>=0},n=function(e,t){var r;return t.forEach((function(t){null!=(r=e[t])[a.NotEqualTo]&&(e[t][a.GreaterThan]=r[a.NotEqualTo],void 0===e[a.Or]?(e[a.Or]={},e[a.Or][t]={}):void 0===e[a.Or][t]&&(e[a.Or][t]={}),e[a.Or][t][a.LessThan]=r[a.NotEqualTo],delete e[t][a.NotEqualTo])})),e};if(F(t)===i.Object){var o=Object.keys(t);if(r(t,o))if(1===o.length)e.where=n(t,o);else{var s=[];o.forEach((function(e){var r;s.push(n(((r={})[e]=t[e],r),[e]))})),e.where=s}}else{var u=[];t.forEach((function(e){var t=Object.keys(e);r(e,t)&&(e=n(e,t)),u.push(e)})),e.where=u}},e.prototype.checkInsertQuery=function(e){var t=this.isInsertQryValid(e),r=t.table,n=t.log;if(n)return n;if(!e.skipDataCheck){var i=new L(r,r.autoIncColumnValue).checkAndModifyValues(e),o=i.values,s=i.err;return e.values=o,s}},e}(),W=(E=function(e,t){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},E(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Q=function(e){function t(t,r){var n=e.call(this)||this;return n.valuesAffected_=[],null==t.validation&&(t.validation=!0),n.query=t,n.util=r,n.tableName=t.into,n}return W(t,e),t.prototype.execute=function(e){var t=this,r=this.db,n=new $(r).validate(o.Insert,this.query);return n?N(n):e().then((function(e){return t.insertData_(r).then((function(e){return t.query.return?t.valuesAffected_:t.rowAffected}))})).catch((function(e){return t.util.abortTransaction(),N(e)}))},t.prototype.insertData_=function(e){var t,r,n,i=this,o=this.query;return t=o.return?function(e){i.valuesAffected_.push(e)}:function(e){++i.rowAffected},n=o.upsert?"put":"add",r=o.ignore&&!i.isTxQuery?function(e){return i.util.con.transaction(o.into,u.ReadWrite).objectStore(o.into)[n](e)}:(i.isTxQuery||i.util.createTransaction([o.into,R.tableName]),i.objectStore=i.util.objectStore(i.tableName),function(e){return i.objectStore[n](e)}),D(o.values.map((function(e){return f((function(n,i){var s=r(e);s.onerror=function(e){o.ignore?n():i(e)},s.onsuccess=function(){t(e),n()}}))}))).then((function(){return R.set(R.dbSchema,e,i.util)}))},t}(U),V=void 0===self.alert&&"undefined"==typeof ServiceWorkerGlobalScope,Z=function(){try{if(indexedDB||(indexedDB=self.mozIndexedDB||self.webkitIndexedDB||self.msIndexedDB),!indexedDB)return!1;IDBTransaction=IDBTransaction||self.webkitIDBTransaction||self.msIDBTransaction,self.IDBKeyRange=self.IDBKeyRange||self.webkitIDBKeyRange||self.msIDBKeyRange}catch(e){return!1}return!0}(),H=function(e){return Array.isArray(e)},K=function(e){return Object.keys(e)},J=function(e){return K(e).length},G=function(){function e(){}return e.prototype.setCaseAndValue=function(e,t){this.caseQuery_=e,this.setValue(t)},e.prototype.setCaseAndColumn=function(e,t){return this.caseQuery_=e,this.setColumn(t),this},e.prototype.setColumn=function(e){return this.columnName_=e,this.caseColumnQuery_=this.caseQuery_[this.columnName_],this.length_=this.caseColumnQuery_.length,this},e.prototype.setValue=function(e){return this.value=e,this},e.prototype.evaluate=function(){for(var e=0;e<this.length_;e++)if(!0===this.checkCase_(this.caseColumnQuery_[e]))return this.caseColumnQuery_[e].then;var t=this.caseColumnQuery_[this.length_-1].then;return null==t?this.value[this.columnName_]:t},e.prototype.checkCase_=function(e){var t;for(t in e){switch(t){case a.GreaterThan:if(this.value[this.columnName_]>e[t])return!0;break;case a.Equal:if(this.value[this.columnName_]===e[t])return!0;break;case a.LessThan:if(this.value[this.columnName_]<e[t])return!0;break;case a.GreaterThanEqualTo:if(this.value[this.columnName_]>=e[t])return!0;break;case a.LessThanEqualTo:if(this.value[this.columnName_]<=e[t])return!0;break;case a.NotEqualTo:if(this.value[this.columnName_]!==e[t])return!0;break;case a.Between:if(this.value[this.columnName_]>e[t].low&&this.value[this.columnName_]<e[t].high)return!0}return!1}},e}(),X=function(e,t,r,n){if(!1===this.limitAtEnd&&!1===this.skipAtEnd){if(this.skipRecord)return this.limitRecord?n:r;if(this.limitRecord)return t}return e},Y=function(e){var t=this,r=!1;return function(n){var i=n.target.result;i?r&&t.results.length!==t.limitRecord?(t.shouldAddValue(i)&&t.pushResult(i.value),i.continue()):(r=!0,i.advance(t.skipRecord)):e()}},ee=function(e){var t=this,r=!1;return function(n){var i=n.target.result;i?r?(t.shouldAddValue(i)&&t.pushResult(i.value),i.continue()):(r=!0,i.advance(t.skipRecord)):e()}},te=function(e){var t=this;return function(r){var n=r.target.result;n&&t.results.length!==t.limitRecord?(t.shouldAddValue(n)&&t.pushResult(n.value),n.continue()):e()}},re=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n)&&t.pushResult(n.value),n.continue()):e()}},ne=function(e){var t,r=this,n=!1;return function(i){(t=i.target.result)?n&&r.results.length!==r.limitRecord?(r.pushResult(t.value),t.continue()):(n=!0,t.advance(r.skipRecord)):e()}},ie=function(e){var t,r=this,n=!1;return function(i){(t=i.target.result)?n?(r.pushResult(t.value),t.continue()):(n=!0,t.advance(r.skipRecord)):e()}},oe=function(e){var t,r=this;return function(n){(t=n.target.result)?(r.pushResult(t.value),t.continue()):e()}},se=function(e){var t,r=this;return function(n){(t=n.target.result)&&r.results.length!==r.limitRecord?(r.pushResult(t.value),t.continue()):e()}},ae=function(e){return e.replace(/\s/g,"")},ue=function(e){var t;if(!this.query.store)if(null==this.query.join)t=this.getColumnInfo(e);else{var r=ae(e).split("."),n=r[1];t=this.getColumnInfo(n,r[0])}if(null==t){var i=this.results[0][e];if(i)return{dataType:F(i),name:e};throw new I(y,{column:e,isOrder:!0})}return t},ce=function(e,t){return t.localeCompare(e)},le=function(e,t){return e.localeCompare(t)},de=function(e,t){return new String(t).localeCompare(e)},fe=function(e,t){return new String(e).localeCompare(t)},he=function(e,t){return t-e},pe=function(e,t){return e-t},ye=function(e,t){return t.getTime()-e.getTime()},ge=function(e,t){return e.getTime()-t.getTime()},be=function(e,t){switch(e.dataType){case i.String:return"asc"===t.type?le:ce;case i.Number:return"asc"===t.type?pe:he;case i.DateTime:return"asc"===t.type?ge:ye;default:return"asc"===t.type?fe:de}},ve=function(e){var t;e.type=me(e.type);var r=e.by,n=this.thenEvaluator;if(null!=r&&typeof r===i.Object){var o=r,s=function(e,t){return function(r,s){for(var a in o){n.setCaseAndValue(o,r);var u=n.setColumn(a).evaluate();n.setCaseAndValue(o,s);var c=n.setColumn(a).evaluate();return typeof r[u]===i.String?e(r[u],s[c]):t(r[u],s[c])}}},a="asc"===e.type?s(le,pe):s(ce,he);this.results.sort(a)}else{var u=ue.call(this,r);if(null!=u){var c=be(u,e);r=u.name,null==e.case?this.results.sort((function(e,t){return c(e[r],t[r])})):(n.setCaseAndColumn(((t={})[r]=e.case,t),r),this.results.sort((function(e,t){return c(n.setValue(e).evaluate(),n.setValue(t).evaluate())})))}}},me=function(e){return null==e?"asc":e.toLowerCase()},we=function(e){for(var t in e)return t},_e=function(e){var t,r,n=e.split("%");switch(n[1]?(t=n[1],r=n.length>2?c.Any:c.Last):(t=n[0],r=c.First),r){case c.First:return new RegExp("^".concat(t),"i");case c.Last:return new RegExp("".concat(t,"$"),"i");default:return new RegExp("".concat(t),"i")}},Se=function(e){return"object"===F(e)&&!(e instanceof RegExp)},ke=function(e){if(Se(e)){var t={};for(var r in e)t[r]=null!=e[r]&&Se(e[r])?ke(e[r]):e[r];return t}return e},xe=function(e,t,r){var n=F(e);if(n!==F(t))return!1;switch(n===i.DateTime&&(e=e.getTime(),t=t.getTime()),r){case a.GreaterThan:return e>t;case a.LessThan:return e<t;case a.LessThanEqualTo:return e<=t;case a.GreaterThanEqualTo:return e>=t;case a.NotEqualTo:return e!==t;default:var o;return"array"===n?e.length===t.length&&(e.every((function(e,r){return o=e===t[r]})),o):e===t}},Oe=function(){function e(e,t){this.where=ke(e),this.checkFlag=t}return e.prototype.remove=function(e){var t=e.pop();delete e.reduce((function(e,t){return e&&e[t]}),this.where)[t]},e.prototype.check=function(e){var t=this,r=!0;if(!this.checkFlag)return r;var n=this.where,i=function(i){if(!r)return{value:r};var o=n[i],s=e[i],u=H(s),c=H(o),l=function(e){u&&!c?s.every((function(t){return!(r=e(t))})):r=e(s)};if("object"===F(o)){var d=function(e){if(!r)return{value:r};switch(e){case a.In:l((function(e){return t.checkIn(o[a.In],e)}));break;case a.Like:l((function(e){return t.checkLike_(i,e)}));break;case a.Regex:l((function(e){return t.checkRegex(i,e)}));break;case a.Between:case a.GreaterThan:case a.LessThan:case a.GreaterThanEqualTo:case a.LessThanEqualTo:case a.NotEqualTo:l((function(r){return t.checkComparisionOp_(i,r,e)}));break;default:r=!1}};for(var f in o){var h=d(f);if("object"==typeof h)return h}}else l((function(e){return xe(o,e)}))};for(var o in n){var s=i(o);if("object"==typeof s)return s.value}return r},e.prototype.checkIn=function(e,t){return null!=e.find((function(e){return xe(e,t)}))},e.prototype.checkLike_=function(e,t){return _e(this.where[e][a.Like]).test(t)},e.prototype.checkRegex=function(e,t){return this.where[e][a.Regex].test(t)},e.prototype.checkComparisionOp_=function(e,t,r){var n=this.where[e][r];return r!=a.Between?xe(t,n,r):xe(t,n.low,">=")&&xe(t,n.high,"<=")},e}(),Te=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.limitAtEnd=!1,t.skipAtEnd=!1,t}return Te(t,e),t.prototype.goToWhereLogic=function(){var e=this,t=this.query,r=t.where,n=function(){for(var t in r)if(e.objectStore.indexNames.contains(t))return t}();if(null==n&&(n=we(r),!t.store))return N(new I(g,{column:n}));var i=r[n];if("object"!==F(i))return o=J(r)>1,this.whereChecker=new Oe(r,o),this.whereChecker.remove([n]),this.executeWhereLogic(n,i,null,"next");var o=J(i)>1||J(r)>1;this.whereChecker=new Oe(r,o);var s=we(i);switch(this.whereChecker.remove([n,s]),s){case a.Like:var u=_e(i[a.Like]);return this.executeRegexLogic(n,u);case a.Regex:return this.executeRegexLogic(n,i[a.Regex]);case a.In:return this.executeInLogic(n,i[a.In]);case a.Between:case a.GreaterThan:case a.LessThan:case a.GreaterThanEqualTo:case a.LessThanEqualTo:return this.executeWhereLogic(n,i,s,"next");case a.Aggregate:break;default:return this.executeWhereLogic(n,i,null,"next")}},t}(U),Ee=function(e,t){var r=this;return function(n){var i=n.target.result;r.results.length!==r.limitRecord&&i?(r.shouldAddValue(i)&&t(i.value),i.continue()):e()}},Ce=function(e,t){var r=this;return function(n){var i=n.target.result;i?(r.shouldAddValue(i)&&t(i.value),i.continue()):e()}},Re=function(){return Re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Re.apply(this,arguments)},Pe=function(){function e(e){this.joinQueryStack_=[],this.currentQueryStackIndex_=0,this.tablesFetched=[],this.results=[],this.select=e}return Object.defineProperty(e.prototype,"query",{get:function(){return this.select.query},enumerable:!1,configurable:!0}),e.prototype.getTable=function(e){return this.select.table(e)},e.prototype.executeSelect=function(e){return new De(e,this.select.util).execute()},e.prototype.execute=function(){var e=this,t=this.query;this.joinQueryStack_=F(t.join)===i.Object?[t.join]:t.join;var r=t.from,n=[];r&&n.push(r);for(var o=this.joinQueryStack_,s=0,a=o.length;s<a;s++){var u=o[s],c=this.getJoinTableInfo_(u.on);u.with===c.table1.table&&(c={table1:c.table2,table2:c.table1});var l=this.checkJoinQuery_(c,u);if(l)return N(l);o[s].joinTableInfo=c,u.with&&n.push(u.with)}!this.select.isTxQuery&&n.length>0&&this.select.util.createTransaction(n);var d=t.where;if(d&&!t.store){var f=this.getTable(r),h=function(e){var t;if(Array.isArray(e))t=[],e=e.filter((function(e){var r=h(e);return Object.keys(r.whereQryAfterJoin).length>0&&t.push(r.whereQryAfterJoin),!r.isWhereEmpty}));else{t={};var r=function(r){if("or"===r){var n={},i=e[r],o=function(e){f.columns.find((function(t){return t.name===e}))||(n[e]=i[e])};for(var s in i)o(s);if(J(n)>0)for(var s in t.or=n,n)delete i[s]}else f.columns.find((function(e){return e.name===r}))||(t[r]=d[r])};for(var n in e)r(n);for(var n in t)delete e[n]}return{isWhereEmpty:0===J(e),whereQryAfterJoin:t,whereQueryModified:e}},p=h(d),y=p.whereQryAfterJoin;t.where=p.whereQueryModified,p.isWhereEmpty&&delete t.where;var g=this.joinQueryStack_[0];Object.assign(g.whereJoin,y)}return this.executeSelect({from:r,where:t.where,case:t.case,flatten:t.flatten,store:t.store,meta:t.meta}).then((function(t){return e.results=t.map((function(t){var r;return(r={})[e.currentQueryStackIndex_]=t,r})),e.tablesFetched.push(o[0].joinTableInfo.table1.table),e.startExecutingJoinLogic_()}))},e.prototype.onJoinQueryFinished_=function(){if(0!==this.results.length){var e=this.select;try{var t=[],r=K(this.results[0]).length;this.results.forEach((function(e){for(var n=e[0],i=1;i<r;i++)n=Re(Re({},n),e[i]);t.push(n)})),e.results=t,e.setLimitAndSkipEvaluationAtEnd_(),e.query.flatten=null,e.processOrderBy()}catch(e){return console.error(e),N(new I(x,e.message))}}},e.prototype.startExecutingJoinLogic_=function(){var e=this,t=this.joinQueryStack_[this.currentQueryStackIndex_];if(!t)return this.onJoinQueryFinished_();try{var r=t.joinTableInfo;return this.executeSelect({from:t.with,where:t.where,case:t.case,flatten:t.flatten,store:t.store,meta:t.meta}).then((function(n){return e.jointables(t,r,n),e.tablesFetched.push(r.table2.table),++e.currentQueryStackIndex_,e.startExecutingJoinLogic_()}))}catch(e){return console.error(e),N(new I(x,e.message))}},e.prototype.jointables=function(e,t,r){var n,i,o,s,a=e.type,u=[],c=t.table1.column,l=t.table2.column,d=this.tablesFetched.indexOf(t.table1.table),f=this.currentQueryStackIndex_+1,h=e.as,p=h?function(e){for(var t in h){var r=h[t];void 0===e[r]&&(e[r]=e[t],delete e[t])}return e}:function(e){return e},y=0,g=Object.assign({},e.whereJoin),b=new Oe(g,J(g)>0);"left"===a?(s={},e.store?K(e.store).forEach((function(e){s[e]=null})):this.getTable(t.table2.table).columns.forEach((function(e){s[e.name]=null})),i=1===f?function(e,t){return t[d][c]===e[l]}:function(e,t){var r=t[d];return null!=r&&r[c]===e[l]},o=function(){0===n.length&&(n=[s])}):(i=function(e,t){return t[d][c]===e[l]},o=function(){}),this.results.forEach((function(e){n=[],r.forEach((function(t){i(t,e)&&n.push(Re({},t))})),o(),n.forEach((function(t){t=p(t),b.check(t)&&(u[y]=Re({},e),u[y++][f]=t)}))})),this.results=u},e.prototype.getJoinTableInfo_=function(e){var t=(e=ae(e)).split("="),r=t[0].split("."),n=t[1].split(".");return{table1:{table:r[0],column:r[1]},table2:{table:n[0],column:n[1]}}},e.prototype.checkJoinQuery_=function(e,t){if(t.store)return null;var r,n=e.table1,i=e.table2,o=this.getTable(n.table),s=this.getTable(i.table);t.with!==i.table&&(r=new I(x,"The 'on' condition must reference a column from the table specified in 'with'. Found '".concat(t.on,"', but '").concat(t.with,"' was provided in 'with'."))),null==o.columns.find((function(e){return e.name===n.column}))?r=new I(x,"column ".concat(n.column," does not exist in table ").concat(n.table)):null==s.columns.find((function(e){return e.name===i.column}))&&(r=new I(x,"column ".concat(i.column," does not exist in table ").concat(i.table))),null==t.as&&(t.as={}),o.columns.every((function(e){var o=s.columns.find((function(t){return t.name===e.name&&t.name!==n.column}));return null==o||null!=t.as[o.name]||(r=new I(x,"column ".concat(e.name," exist in both table ").concat(n.table," & ").concat(i.table)),!1)}));var a=t.where;if(a){var u,c=function(e,t){var r=function(r){switch(r){case"or":case"in":break;default:s.columns.find((function(e){return e.name===r}))||(t[r]=e[r],delete e[r])}};for(var n in e)r(n)};Array.isArray(a)?(u=[],a=a.filter((function(e){var t={};return c(e,t),0!==J(t)&&u.push(t),0!==J(e)}))):c(a,u={}),0===J(a)&&(t.where=null),t.whereJoin=u}else t.whereJoin={};return r},e}(),je=function(){function e(e){this.data=e}return Object.defineProperty(e.prototype,"indexNames",{get:function(){var e=K(this.data[0]);return{contains:function(t){return e.indexOf(t)>=0}}},enumerable:!1,configurable:!0}),e.prototype.index=function(e){var t=this;return{openCursor:function(r){var n={},i=0,o={continue:function(){++i,a()}},s=function(e){n.onsuccess({target:{result:e}})},a=function(){var n=t.data[i];if(n){var a=n[e];a&&(null==r||r.includes(a))?(o.key=a,o.value=n,s(o)):o.continue()}else s(null)};return d().then(a),n}}},e}(),Ie=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Me=function(){return Me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Me.apply(this,arguments)},De=function(e){function t(t,r){var n=e.call(this)||this;n.sorted=!1,n.isSubQuery=!1,n.thenEvaluator=new G,n.returnResult_=function(){if(n.results.length>0){var e=n.query;if(e.flatten){var t=[],r=new Map;e.flatten.forEach((function(e){n.results.forEach((function(n,i){n[e].forEach((function(r){var i;t.push(Me(Me({},n),((i={})[e]=r,i)))})),r.set(i,!0)}))}));var i=0;r.forEach((function(e,t){n.results.splice(t-i,1),++i})),n.results=n.results.concat(t)}n.processGroupDistinctAggr(),n.processOrderBy(),n.skipAtEnd&&n.results.splice(0,e.skip),n.limitAtEnd&&(n.results=n.results.slice(0,e.limit))}return n.results},n.query=t,n.util=r,n.tableName=t.from,n.setPushResult(),H(t.where)?(n.isArrayQry=!0,n.setLimitAndSkipEvaluationAtEnd_()):(n.skipRecord=t.skip,n.limitRecord=t.limit);var i=t.order;return i?((H(i)||i.case||"object"==typeof i.by)&&(i.idbSorting=!1),n.setLimitAndSkipEvaluationAtEnd_()):t.groupBy&&n.setLimitAndSkipEvaluationAtEnd_(),n}return Ie(t,e),t.prototype.execute=function(e){var t=this;e||(e=function(){return d(null)});var r=this.query;try{var n=new $(this.db).validate(o.Select,r);return n?N(n):e().then((function(e){return t.initTransaction_(),(null==r.join?null!=r.where?H(r.where)?t.processWhereArrayQry():t.processWhere_():t.executeWhereUndefinedLogic():t.executeJoinQuery()).then(t.returnResult_.bind(t))}))}catch(e){return this.onException(e)}},t.prototype.processWhereArrayQry=function(){var e=this;this.isArrayQry=!0;var r,n=this.query.where,i=this.primaryKey(),o=!0,s=[],u=function(){var t;return r===a.And?!0===o?s=e.results:s.length>0&&(t=[],e.results.forEach((function(e){var r;r=e[i],s.findIndex((function(e){return e[i]===r}))>=0&&t.push(e)})),s=t,t=null):(s.length>0&&e.mergeWithResults(s),s=e.results),o=!1,n.length>0?(e.results=[],l()):(e.results=s,d())},c=function(r){return new t({from:e.query.from,where:r},e.util).execute().then((function(t){return e.results=t,u()}))},l=function(){var t=n.shift(),i=t[a.Or];if(i){if(H(i))return r=a.Or,c(i);1===J(t)?(r=a.Or,t=i):r=a.And}else if(r=a.And,H(t))return c(t);return e.query.where=t,e.processWhere_().then(u)};return l()},t.prototype.initTransaction_=function(){var e=this.query.store;e?this.objectStore=new je(e):(this.isTxQuery||this.util.createTransactionIfNotExist([this.tableName],u.ReadOnly),this.objectStore=this.util.objectStore(this.tableName))},t.prototype.processWhere_=function(){var e=this;return this.shouldAddValue=function(t){var r=t.value,n=e,i=new Proxy(r,{get:function(e,t,i){var o=r[t];if(!o){var s=n.getColumnInfo(t);if(s&&s.keyPath)return s.keyPath.map((function(e){return r[e]}))}return o}});return e.whereChecker.check(i)},this.query.where.or&&this.processOrLogic_(),this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))},t.prototype.onWhereEvaluated=function(){if(this.isOr)return this.orQuerySuccess_()},t.prototype.orQuerySuccess_=function(){var e=this,r=this.query,n=this.orInfo;return this.results.length>0&&this.mergeWithResults(n.results),new t({where:n.orQuery,from:r.from,case:r.case,store:r.store,meta:r.meta},this.util).execute().then((function(t){e.mergeWithResults(t),e.isOr=!1,e.orInfo=null}))},t.prototype.processOrLogic_=function(){this.isOr=!0;var e=this.query.where;this.orInfo={orQuery:e.or,results:[]},this.setLimitAndSkipEvaluationAtEnd_(),delete e.or},t}(Ae);function Ne(e){var t=1===J(e);if(t){var r=we(e);t=1===J(e[r])}return t}De.prototype.executeInLogic=function(e,t){var r=this,n=this.skipRecord,i=function(e){0===n?r.pushResult(e):--n},o=X.call(this,re,te,Ce,Ee);return D(t.map((function(t){return f((function(n,s){var a=r.objectStore.index(e).openCursor(r.util.keyRange(t));a.onsuccess=o.call(r,n,i),a.onerror=s}))})))},De.prototype.executeWhereUndefinedLogic=function(){var e,t=this,r=this.query,n=r.store;if(n)return this.results=n,this.setLimitAndSkipEvaluationAtEnd_(),d();var i=r.order,o=this.objectStore;if(i&&!1!==i.idbSorting&&i.by){if(!o.indexNames.contains(i.by))return N(new I(y,{column:i.by,isOrder:!0}));var s=i.type&&"desc"===i.type.toLowerCase()?"prev":"next";this.sorted=!0,e=o.index(i.by).openCursor(null,s)}else e=o.openCursor();var a=X.call(this,oe,se,ie,ne);return f((function(r,n){e.onerror=n,e.onsuccess=a.call(t,r)}))},De.prototype.executeWhereLogic=function(e,t,r,n){var i=this;t=r?t[r]:t;var o=this.objectStore.index(e).openCursor(this.util.keyRange(t,r),n),s=X.call(this,re,te,ee,Y);return f((function(e,t){o.onerror=t,o.onsuccess=s.call(i,e)}))},De.prototype.executeRegexLogic=function(e,t){var r=this,n=this.skipRecord,i=function(e){0===n?r.pushResult(e):--n};this.shouldAddValue=function(e){return t.test(e.key)&&r.whereChecker.check(e.value)};var o=this.objectStore.index(e).openCursor(),s=X.call(this,re,te,Ce,Ee);return f((function(e,t){o.onerror=t,o.onsuccess=s.call(r,e,i)}))},De.prototype.setLimitAndSkipEvaluationAtEnd_=function(){this.query.limit&&(this.limitAtEnd=!0),this.query.skip&&(this.skipAtEnd=!0)},De.prototype.setPushResult=function(){var e=this,t=this.query.case;this.pushResult=t?function(r){var n;for(n in e.thenEvaluator.setCaseAndValue(t,r),t)r[n]=e.thenEvaluator.setColumn(n).evaluate();e.results.push(r)}:function(t){e.results.push(t)}},De.prototype.mergeWithResults=function(e){var t=this.results,r=this.primaryKey(),n=new Map;t.forEach((function(e){n.set(e[r],1)})),e.forEach((function(e){n.has(e[r])||t.push(e)}))},De.prototype.executeJoinQuery=function(){return new Pe(this).execute()},De.prototype.processGroupDistinctAggr=function(){var e=this.query;if(e.distinct){var t=[],r=this.results[0];for(var n in r)t.push(n);var i=this.primaryKey(),o=t.indexOf(i);t.splice(o,1),e.groupBy=t.length>0?t:null}e.groupBy?e.aggregate?this.executeAggregateGroupBy():this.processGroupBy():e.aggregate&&this.processAggregateQry()},De.prototype.processOrderBy=function(){var e=this.query.order;if(e&&this.results.length>0&&!this.sorted){var t=F(e);if(t===i.Object)ve.call(this,e);else if(t===i.Array){ve.call(this,e[0]);for(var r=function(t,r){var i=e[t-1].by,o=e[t],s=o.by,a=ue.call(n,s);if(null!=a){s=a.name,o.type=me(o.type);var u=be(a,o);n.results.sort((function(e,t){return e[i]===t[i]?u(e[s],t[s]):0}))}},n=this,o=1,s=e.length;o<s;o++)r(o)}}},De.prototype.processAggregateQry=function(){var e,t=this.results,r=t.length,n={},o=function(){var r=0;for(var n in t)r+=t[n][e]?1:0;return r},s=function(){var r=0;for(var n in t)r=r>t[n][e]?r:t[n][e];return r},a=function(){var r=1/0,n=1/0;for(var i in t)r=r<(n=t[i][e]?t[i][e]:1/0)?r:n;return r},u=function(){var r=0;for(var n in t)r+=t[n][e];return r},c=function(){return u()/r},l=this.query.aggregate;for(var d in l){var f=l[d],h=F(f),p=void 0;switch(d){case"count":p=o;break;case"max":p=s;break;case"min":p=a;break;case"sum":p=u;break;case"avg":p=c}switch(h){case i.String:e=f,n["".concat(d,"(").concat(e,")")]=p();break;case i.Array:for(var y in f)e=f[y],n["".concat(d,"(").concat(e,")")]=p()}}for(var d in n)t[0][d]=n[d];this.results=[t[0]]},De.prototype.executeAggregateGroupBy=function(){var e,t,r,n,o=this.query.groupBy,s=this.results,u=new Map,c=this.query.aggregate,l=function(){var o=function(){return r=(r=u.get(t))?r["count("+n+")"]:0,r+=s[e][n]?1:0},l=function(){return(r=(r=u.get(t))?r["list("+n+")"]:[]).push(s[e][n]),r},d=function(){return r=(r=u.get(t))?r["max("+n+")"]:0,s[e][n]=s[e][n]?s[e][n]:0,r>s[e][n]?r:s[e][n]},f=function(){return r=(r=u.get(t))?r["min("+n+")"]:1/0,s[e][n]=s[e][n]?s[e][n]:1/0,r<s[e][n]?r:s[e][n]},h=function(){return r=(r=u.get(t))?r["sum("+n+")"]:0,r+=s[e][n]?s[e][n]:0},p=function(){var i=(r=u.get(t))?r["sum("+n+")"]:0;i+=s[e][n]?s[e][n]:0,s[e]["sum("+n+")"]=i,r=r?r["count("+n+")"]:0,r+=s[e][n]?1:0,s[e]["count("+n+")"]=r};for(var y in c){var g=c[y],b=F(g),v=void 0;switch(y){case a.Count:v=o;break;case a.Max:v=d;break;case a.Min:v=f;break;case a.Sum:v=h;break;case a.Avg:v=p;break;case a.List:v=l}switch(b){case i.String:n=g,s[e]["".concat(y,"(").concat(n,")")]=v();break;case i.Array:for(var m in g)n=g[m],s[e]["".concat(y,"(").concat(n,")")]=v()}}};if(F(o)===i.String)for(e in s)t=s[e][o],l(),u.set(t,s[e]);else for(e in s){for(var d in t="",o)t+=s[e][o[d]];l(),u.set(t,s[e])}s=Array.from(u.values());var f=c.avg;if(f)if(F(f)===i.String)for(e in s){var h=s[e]["sum("+f+")"],p=s[e]["count("+f+")"];s[e]["avg("+f+")"]=h/p,c.count!==f&&delete s[e]["count("+f+")"],c.sum!==f&&delete s[e]["sum("+f+")"]}else{var y=F(c.count)===i.String,g=F(c.sum)===i.String;for(e in s)for(var d in f){var b=f[d],v=s[e]["sum("+b+")"],m=s[e]["count("+b+")"];s[e]["avg("+b+")"]=v/m,y&&(c.count!==b||-1===c.count.indexOf(b))&&delete s[e]["count("+b+")"],g&&(c.sum!==b||-1===c.sum.indexOf(b))&&delete s[e]["sum("+b+")"]}}this.results=s},De.prototype.processGroupBy=function(){var e=this.query.groupBy,t=this.results,r=new Map,n=F(e);if(n!==i.Object)if(n===i.String)for(var o in t)r.set(t[o][e],t[o]);else{var s=void 0;for(var o in t){for(var a in s="",e)s+=t[o][e[a]];r.set(s,t[o])}}else if(1===Object.keys(e).length){var u=we(e);for(var o in this.thenEvaluator.setCaseAndColumn(e,u),t)r.set(this.thenEvaluator.setValue(t[o]).evaluate(),t[o])}else for(var o in s=void 0,t){for(var a in s="",this.thenEvaluator.setCaseAndValue(e,t[o]),e)s+=this.thenEvaluator.setColumn(a).evaluate();r.set(s,t[o])}this.results=Array.from(r.values())};var Be=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n)&&++t.resultCount,n.continue()):e()}},Ue=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fe=function(e){function t(t,r){var n=e.call(this)||this;return n.resultCount=0,n.query=t,n.util=r,n.tableName=t.from,n}return Ue(t,e),t.prototype.execute=function(e){var t=this,r=new $(this.db),n=this.query,i=r.validate(o.Count,n);return i?N(i):e().then((function(e){var r;try{var i=function(){var e=new De(n,t.util);return e.isTxQuery=t.isTxQuery,e.execute().then((function(e){t.resultCount=e.length}))};t.initTransaction_(),null==n.join?null!=n.where?n.where.or||H(n.where)?r=i():(t.shouldAddValue=function(e){return t.whereChecker.check(e.value)},r=t.goToWhereLogic()):r=t.executeWhereUndefinedLogic():r=i()}catch(e){t.onException(e)}return r.then((function(e){return t.resultCount}))}))},t.prototype.initTransaction_=function(){var e=this.query.from;this.isTxQuery||this.util.createTransaction([e],u.ReadOnly),this.objectStore=this.util.objectStore(e)},t}(Ae);Fe.prototype.executeWhereUndefinedLogic=function(){var e,t,r=this,n=this.objectStore,i=n.count?(e=n.count(),function(t){return function(){r.resultCount=e.result,t()}}):(e=n.openCursor(),function(e){return function(n){(t=n.target.result)?(++r.resultCount,t.continue()):e()}});return f((function(t,r){e.onerror=r,e.onsuccess=i(t)}))},Fe.prototype.executeWhereLogic=function(e,t,r){var n,i=this;t=r?t[r]:t;var o=Ne(this.query.where),s=this.objectStore;return f((function(a,u){o&&s.count?(n=s.index(e).count(i.util.keyRange(t,r))).onsuccess=function(){i.resultCount=n.result,a()}:(n=s.index(e).openCursor(i.util.keyRange(t,r))).onsuccess=Be.call(i,a),n.onerror=u}))},Fe.prototype.executeRegexLogic=function(e,t){var r=this,n=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&r.whereChecker.check(e.value)},f((function(e,t){n.onerror=t,n.onsuccess=Be.call(r,e)}))},Fe.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore,i=n.index(e),o=Ne(this.query.where);return D(t.map((function(e){return t=e,s=r.util.keyRange(t),o&&n.count?f((function(e,t){var n=i.count(s);n.onsuccess=function(t){r.resultCount+=t.target.result,e()},n.onerror=t})):f((function(e,t){var n=i.openCursor(s);n.onsuccess=Be.call(r,e),n.onerror=t}));var t,s})))};var ze=function(e){return(H(e)?e:e.split(".")).reduce((function(e,t){return e&&e[t]}),self)},Le=function(e,t){var r=e.set,n=e.mapSet;if(n){var o=n(r,t);null!=o&&(r=o)}for(var s in r){var a=r[s];if(F(a)!==i.Object)t[s]=a;else for(var u in a){var c=a[u];switch(u){case"+":t[s]+=c;break;case"-":t[s]-=c;break;case"*":t[s]*=c;break;case"/":t[s]/=c;break;case"{push}":t[s].push(c);break;default:t[s]=a}break}}return t},qe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$e=function(e){function t(t,r){var n=e.call(this)||this;t.returnImmediate=null!=t.returnImmediate&&t.returnImmediate,n.query=t,n.util=r,n.tableName=t.in;var o=t.mapSet;if(o){var s=F(o)===i.String?ze(o):o;if(!s)throw new I(T,o);t.mapSet=s}return n}return qe(t,e),t.prototype.execute=function(e){var t=this,r=this.query;try{var n=new $(this.db).validate(o.Update,r);return n?N(n):e().then((function(e){var n=t.initTransaction(),i=[null!=r.where?r.where.or||H(r.where)?t.executeComplexLogic_():t.goToWhereLogic():t.executeWhereUndefinedLogic()];return!1===r.returnImmediate&&n&&i.push(n),D(i).then((function(){return t.rowAffected}))}))}catch(e){return this.onException(e)}},t.prototype.executeComplexLogic_=function(){var e=this,t=this.query,r=new De({from:t.in,where:t.where,ignoreCase:t.ignoreCase},this.util);return r.isTxQuery=this.isTxQuery,r.execute().then((function(r){var n,i,o=e.primaryKey(t.in),s=[];r.forEach((function(e){s.push(e[o])})),r=null;var u=((n={})[o]=((i={})[a.In]=s,i),n);return e.query.where=u,e.goToWhereLogic()}))},t.prototype.initTransaction=function(){var e,t=this.query.in;return this.isTxQuery||(e=this.util.createTransaction([t])),this.objectStore=this.util.objectStore(t),e},t}(Ae);$e.prototype.executeWhereUndefinedLogic=function(){var e=this,t=this.objectStore.openCursor();return f((function(r,n){t.onsuccess=function(t){var i=t.target.result;if(i)try{var o=i.update(Le(e.query,i.value));o.onsuccess=function(){++e.rowAffected,i.continue()},o.onerror=n}catch(e){n(e)}else r()},t.onerror=n}))},$e.prototype.executeWhereLogic=function(e,t,r){var n=this,i=this.query;t=r?t[r]:t;var o=this.objectStore.index(e).openCursor(this.util.keyRange(t,r));return f((function(e,t){o.onsuccess=function(r){var o=r.target.result;if(o)if(n.whereChecker.check(o.value))try{var s=o.update(Le(i,o.value));s.onsuccess=function(){++n.rowAffected,o.continue()},s.onerror=t}catch(e){t(e)}else o.continue();else e()},o.onerror=t}))},$e.prototype.executeRegexLogic=function(e,t){var r,n=this,i=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&n.whereChecker.check(e.value)},f((function(e,t){i.onsuccess=function(i){if(r=i.target.result)if(n.shouldAddValue(r))try{var o=r.update(Le(n.query,r.value));o.onsuccess=function(){++n.rowAffected,r.continue()},o.onerror=t}catch(e){t(e)}else r.continue();else e()},i.onerror=t}))},$e.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore.index(e),i=this.query;return D(t.map((function(e){return t=e,f((function(e,o){var s=n.openCursor(r.util.keyRange(t));s.onsuccess=function(t){var n=t.target.result;if(n){var s=n.value;if(r.whereChecker.check(s))try{var a=n.update(Le(i,s));a.onsuccess=function(){++r.rowAffected,n.continue()},a.onerror=o}catch(e){o(e)}else n.continue()}else e()},s.onerror=o}));var t})))};var We=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Qe=function(){return Qe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Qe.apply(this,arguments)},Ve=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n}return We(t,e),t.prototype.execute=function(){var e,t,r=this,n=this.query,i=0,o={},s={},a=!0,u=n.queries,c=u.length;if(u.every((function(e,t){return!(t+1<c&&e.from!==u[t+1].from&&(a=!1,1))})),a){var l=this.primaryKey(u[0].from);e=function(e){return e[l]}}else e=function(e){var t="";for(var r in e)t+=e[r];return t};var d=function(){if(i<c)return(t=new De(u[i],r.util)).execute().then((function(t){return o={},t.forEach((function(t){var r=e(t);0===i?s[r]=t:null!=s[r]&&(o[r]=t)})),i>0&&(s=Qe({},o)),++i,d()}));var a,l=[],f=void 0,h=n.skip,p=n.limit,y=!1,g=function(){l.push(o[a])},b=function(){l.length<p?g():y=!0},v=function(e){0===h?e():--h};if(f=n.skip&&n.limit?function(){v((function(){b()}))}:n.limit?b:n.skip?function(){v((function(){g()}))}:function(){g()},p){for(a in o)if(f(a),y)break}else for(a in o)f(a);return t.results=l,Object.assign(t.query,{order:n.order,join:{}}),t.processOrderBy(),t.processGroupDistinctAggr(),t.results};return d()},t}(U),Ze=function(){function e(){}return e.prototype.execute=function(e){return f((function(t,r){var n=indexedDB.deleteDatabase(e);n.onblocked=function(){var e=new I(_);return r(B(e))},n.onerror=function(e){return r(B(e))},n.onsuccess=function(){t()}}))},e}(),He=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ke=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n}return He(t,e),t.prototype.execute=function(){var e,t=this,r=this.query,n=0,i=new Map,o=!0,s=r.length;if(r.every((function(e,t){return!(t+1<s&&e.from!==r[t+1].from&&(o=!1,1))})),o){var a=this.primaryKey(r[0].from);e=function(e){return e[a]}}else e=function(e){var t="";for(var r in e)t+=e[r];return t};var u=function(){return n<r.length?new De(r[n++],t.util).execute().then((function(t){return t.forEach((function(t){i.set(e(t),t)})),u()})):Array.from(i.values())};return u()},t}(U),Je=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n.value)&&(n.delete(),++t.rowAffected),n.continue()):e()}},Ge=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xe=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n.tableName=t.from,n}return Ge(t,e),t.prototype.execute=function(e){var t,r=this,n=new $(this.db),i=this.query,s=n.validate(o.Remove,i);return s?N(s):e().then((function(e){try{r.initTransaction_(),t=null!=i.where?H(i.where)?r.processWhereArrayQry():r.processWhere_():r.executeWhereUndefinedLogic()}catch(e){return r.onException(e)}return t.then((function(){return r.rowAffected}))}))},t.prototype.processWhereArrayQry=function(){var e=this,t=new De(this.query,this.util);return t.isTxQuery=this.isTxQuery,t.execute().then((function(t){var r,n,i=[],o=e.primaryKey(e.query.from);t.forEach((function(e){i.push(e[o])})),t=null;var s=((r={})[o]=((n={})[a.In]=i,n),r);return e.query[a.Where]=s,e.processWhere_()}))},t.prototype.processWhere_=function(){var e=this;return this.shouldAddValue=function(t){return e.whereChecker.check(t)},this.query.where.or&&this.processOrLogic(),this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))},t.prototype.initTransaction_=function(){this.isTxQuery||this.util.createTransaction([this.query.from]),this.objectStore=this.util.objectStore(this.query.from)},t.prototype.onWhereEvaluated=function(){if(this.isOr)return this.orQuerySuccess_()},t.prototype.orQuerySuccess_=function(){var e=this,t=this._orInfo.OrQuery,r=we(t);if(null!=r){var n={};return n[r]=t[r],delete t[r],this.query.where=n,this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))}this.isOr=!0},t.prototype.processOrLogic=function(){this.isOr=!0;var e=this.query.where;this._orInfo={OrQuery:e.or},delete e.or},t}(Ae);Xe.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore.index(e);return D(t.map((function(e){return t=e,f((function(e,i){var o=n.openCursor(r.util.keyRange(t));o.onsuccess=Je.call(r,e),o.onerror=i}));var t})))},Xe.prototype.executeWhereUndefinedLogic=function(){var e,t=this,r=this.objectStore.openCursor();return f((function(n,i){r.onsuccess=function(r){(e=r.target.result)?(e.delete(),++t.rowAffected,e.continue()):n()},r.onerror=i}))},Xe.prototype.executeWhereLogic=function(e,t,r){var n=this;t=r?t[r]:t;var i=this.objectStore.index(e).openCursor(this.util.keyRange(t,r));return f((function(e,t){i.onsuccess=Je.call(n,e),i.onerror=t}))},Xe.prototype.executeRegexLogic=function(e,t){var r,n=this,i=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&n.whereChecker.check(e.value)},f((function(e,t){i.onsuccess=function(t){(r=t.target.result)?(n.shouldAddValue(r)&&(r.delete(),++n.rowAffected),r.continue()):e()},i.onerror=t}))};var Ye=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),et=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n.tableName=t,n}return Ye(t,e),t.prototype.execute=function(e){var t=this,r=this.query;return this.isTxQuery||this.util.createTransaction([r,R.tableName]),e().then((function(e){var n=t.util.objectStore(r).clear();try{return f((function(e,i){n.onsuccess=function(n){var o=t.table(r);for(var s in o.autoIncColumnValue)o.autoIncColumnValue[s]=0;R.set(R.dbSchema,t.util.db,t.util).then(e).catch(i)},n.onerror=i}))}catch(e){return t.onException(e)}}))},t}(U),tt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rt=function(e){function t(t,r){var n=e.call(this)||this;return n.results={},n.reqQueue=[],n.isQueryExecuting=!1,n.isTxStarted_=!1,n.query=t,n.util=r,n}return tt(t,e),t.prototype.execute=function(e){var t=this;this.beforeExecute=e;var r=this.validate();return r?N(r):(this.startExecution_(),f((function(e,r){t.onSuccess=e,t.onError=r})).then((function(e){return t.beforeExecute=null,t.log("transaction finished"),e})))},t.prototype.validate=function(){var e=this.query,t=this.notExistingTable_(e.tables);if(t)return new I(m,{tableName:t});var r=e.method;return ze(r)?void 0:new I(T,r)},t.prototype.startExecution_=function(){var e=this,t=this.query,r=function(t){return function(r){return e.pushReq_({name:t,query:r})}},n=t.method,i=ze(n);return this.log("transaction query started"),i.call(this,{data:t.data,insert:r(o.Insert),select:r(o.Select),update:r(o.Update),remove:r(o.Remove),count:r(o.Count),setResult:function(t,r){e.results[t]=r},getResult:function(t){return e.results[t]},abort:function(t){e.abortTx_(t)},start:function(){e.startTx_()}})},t.prototype.log=function(e){this.util.logger.log(e)},t.prototype.startTx_=function(){var e=this;try{this.isTxStarted_=!0;var t=this.query.tables;return t=t.concat(R.tableName),this.util.createTransaction(t).then((function(t){e.onSuccess(e.results)})).catch((function(t){e.onError(t)})),this.processExecutionOfQry_()}catch(e){this.onError(this.onException(e))}},t.prototype.onReqFinished_=function(e){var t=this.reqQueue.shift();this.log("finished request : ".concat(t.name," ")),t&&(e.error?(this.abortTx_("automatic abort of transaction due to error occured"),this.log("transaction aborted due to error occured"),this.onError(e.error)):(this.isQueryExecuting=!1,t.onSuccess&&t.onSuccess(e),this.processExecutionOfQry_()))},t.prototype.abortTx_=function(e){this.reqQueue=[],this.util.abortTransaction(),this.log("transaction aborted. Msg : ".concat(e))},t.prototype.executeRequest_=function(e){var t,r=this;this.isQueryExecuting=!0,this.log("executing request : ".concat(e.name," "));var n=this.onReqFinished_.bind(this),i=e.query,s=function(e){i.returnImmediate=!0,t=new e(i,r.util)};switch(e.name){case o.Select:s(De);break;case o.Insert:s(Q);break;case o.Update:s($e);break;case o.Remove:s(Xe);break;case o.Count:s(Fe)}t.isTxQuery=!0,t.execute(this.beforeExecute).then(n).catch((function(e){n({error:e})}))},t.prototype.pushReq_=function(e){var t=f((function(t,r){e.onSuccess=function(e){t(e)},e.onError=function(e){r(e)}}));return this.reqQueue.push(e),!0===this.isTxStarted_&&this.processExecutionOfQry_(),this.log("request pushed : ".concat(e.name)),t},t.prototype.processExecutionOfQry_=function(){!1===this.isQueryExecuting&&this.reqQueue.length>0&&this.executeRequest_(this.reqQueue[0])},t.prototype.notExistingTable_=function(e){var t=this,r=null;return e.every((function(e){return null!=t.table(e)||(r=e,!1)})),r},t}(U),nt=function(e){if(null==e)throw new Error("userDbSchema db is null");var t={name:e.name,version:e.version,tables:[]};return e.tables.forEach((function(e){var r={name:e.name,columns:{}};e.columns.forEach((function(e){r.columns[e.name]=e})),t.tables.push(r)})),t},it=function(){function e(e){this.middlewares=[],this.util=new M,this.onQryFinished=V?function(e){self.postMessage(e)}:e}return Object.defineProperty(e.prototype,"db",{get:function(){return this.util.db},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this.util.logger},enumerable:!1,configurable:!0}),e.prototype.executeMiddleware_=function(e){var t=this,r=J(this.middlewares)-1;if(r<0)return d();var n={},i=this.db;return Object.defineProperty(n,"database",{get:function(){return nt(i)}}),f((function(i){var o=0,s=function(){if(o<=r){var a=ze(t.middlewares[o++])(e,n);a&&a.then||(a=Promise.resolve(a)),a.then((function(e){s()}))}else i()};s()}))},e.prototype.executeQuery=function(e,t){var r,n=e.query,i=this,s=i.util,a=function(e,t){r=new e(n,s).execute(t)};switch(e.name){case o.OpenDb:t(),r=i.openDb(n);break;case o.InitDb:t(),r=i.initDb(n);break;case o.CloseDb:t(),r=i.closeDb();break;case o.Insert:a(Q,t);break;case o.Select:a(De,t);break;case o.Count:a(Fe,t);break;case o.Update:a($e,t);break;case o.Intersect:t(),a(Ve);break;case o.DropDb:t(),r=i.dropDb();break;case o.Terminate:t(),r=i.terminate();break;case o.Union:t(),a(Ke);break;case o.Remove:a(Xe,t);break;case o.Clear:a(et,t);break;case o.Transaction:a(rt,t);break;case o.MapGet:t(),r=R.get(n,s);break;case o.MapSet:t(),r=R.set(n.key,n.value,s);break;case o.MapHas:t(),r=R.has(n,s);break;case o.MapDelete:t(),r=R.remove(n,s);break;case o.ImportScripts:t(),r=i.importScripts_(e);break;case o.ChangeLogStatus:t(),i.logger.status=n,r=Promise.resolve();break;case o.Middleware:return t(),ze(n)?(i.middlewares.push(n),d()):N(new I(A,n));default:r=d()}return i.logger.log("Executing query ".concat(e.name," in web worker")),r},e.prototype.callMiddleware_=function(e,t){return f((function(r){var n=0,i=J(e)-1,o=function(){if(n<=i){var s=e[n++](t);s instanceof Promise||(s=d(s)),s.then((function(e){t=e,o()}))}else r(t)};o()}))},e.prototype.run=function(e){var t=this,r=[],n=[];e.onResult=function(e){r.push((function(t){return e(t)}))},e.beforeExecute=function(e){n.push((function(t){return e(t)}))},this.executeMiddleware_(e).then((function(i){return t.executeQuery(e,(function(){return t.callMiddleware_(n)})).then((function(e){return t.callMiddleware_(r,e).then((function(e){t.returnResult_({result:e})}))}))})).catch((function(e){r=[];var n={error:B(e)};t.returnResult_(n)}))},e.prototype.importScripts_=function(e){return f((function(t,r){try{importScripts.apply(void 0,e.query),t()}catch(e){r(new I(O,e.message))}}))},e.prototype.returnResult_=function(e){this.logger.log("Query finished inside web worker"),this.util&&this.util.emptyTx(),this.onQryFinished(e)},e.prototype.dropDb=function(){var e=this.db.name;return this.terminate().then((function(){return(new Ze).execute(e)}))},e.prototype.closeDb=function(){return this.util.close()},e.prototype.terminate=function(){var e=this;return this.closeDb().then((function(){e.util.db=null}))},e.prototype.openDb=function(e){var t=this;return this.closeDb().then((function(r){return(t.db&&e.name===t.db.name?t.initDb():t.initDb({name:e.name,tables:[],version:e.version})).then((function(){return t.db}))}))},e.prototype.initDb=function(e){var t=this;if(!Z)return N(new I(S));var r=e?new P(e):this.db;if(null==r)throw new Error("dbMeta is null");return this.util=new M,this.util.initDb(r).then((function(e){return R.get(R.dbSchema,t.util).then((function(n){return e.isCreated?(n&&n.tables.forEach((function(e){var t=r.tables.find((function(t){return t.name===e.name}));if(t)for(var n in e.autoIncColumnValue){var i=e.autoIncColumnValue[n];i&&(t.autoIncColumnValue[n]=i)}})),t.util.db=r,e.database=nt(t.db),R.set(R.dbSchema,r,t.util).then((function(){return e}))):R.get(R.dbSchema,t.util).then((function(r){return t.util.db=r,e.database=nt(t.db),e}))}))}))},e}();if(V){var ot=new it;self.onmessage=function(e){ot.run(e.data)}}e.exports=r})()},1124:(e,t,r)=>{e.exports={setup(e,t){e.$worker=r(7130),e.initQueryManager_()}}},9426:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(1635),i=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,n=e._value;if(t)throw r;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(r(7291).B)},8483:(e,t,r)=>{"use strict";r.d(t,{c:()=>l});var n=r(5508),i=r(2616),o=r(5604),s=r(1485),a=r(4384),u=r(1209),c=r(7008),l=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var o,s=this,a=(o=e)&&o instanceof n.vU||function(e){return e&&(0,u.T)(e.next)&&(0,u.T)(e.error)&&(0,u.T)(e.complete)}(o)&&(0,i.Uv)(o)?e:new n.Ms(e,t,r);return(0,c.Y)((function(){var e=s,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?s._subscribe(a):s._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=d(t))((function(t,i){var o=new n.Ms({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});r.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[o.s]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,s.m)(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function d(e){var t;return null!==(t=null!=e?e:a.$.Promise)&&void 0!==t?t:Promise}},9741:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var n=r(1635),i=r(7291),o=r(1179),s=function(e){function t(t,r,n){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===n&&(n=o.U);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=r,i._timestampProvider=n,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=r===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,r),i}return(0,n.C6)(t,e),t.prototype.next=function(t){var r=this,n=r.isStopped,i=r._buffer,o=r._infiniteTimeWindow,s=r._timestampProvider,a=r._windowTime;n||(i.push(t),!o&&i.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),r=this._infiniteTimeWindow,n=this._buffer.slice(),i=0;i<n.length&&!e.closed;i+=r?1:2)e.next(n[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,r=e._timestampProvider,n=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<n.length&&n.splice(0,n.length-o),!i){for(var s=r.now(),a=0,u=1;u<n.length&&n[u]<=s;u+=2)a=u;a&&n.splice(0,a+1)}},t}(i.B)},7291:(e,t,r)=>{"use strict";r.d(t,{B:()=>c});var n=r(1635),i=r(8483),o=r(2616),s=(0,r(2947).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),a=r(6174),u=r(7008),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,n.C6)(t,e),t.prototype.lift=function(e){var t=new l(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new s},t.prototype.next=function(e){var t=this;(0,u.Y)((function(){var r,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=(0,n.Ju)(t.currentObservers),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,i=r.isStopped,s=r.observers;return n||i?o.Kn:(this.currentObservers=null,s.push(e),new o.yU((function(){t.currentObservers=null,(0,a.o)(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,i=t.isStopped;r?e.error(n):i&&e.complete()},t.prototype.asObservable=function(){var e=new i.c;return e.source=this,e},t.create=function(e,t){return new l(e,t)},t}(i.c),l=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,n.C6)(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:o.Kn},t}(c)},5508:(e,t,r)=>{"use strict";r.d(t,{Ms:()=>b,vU:()=>h});var n=r(1635),i=r(1209),o=r(2616),s=r(4384),a=r(2564),u=r(2357),c=l("C",void 0,void 0);function l(e,t,r){return{kind:e,value:t,error:r}}var d=r(6744),f=r(7008),h=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,(0,o.Uv)(t)&&t.add(r)):r.destination=w,r}return(0,n.C6)(t,e),t.create=function(e,t,r){return new b(e,t,r)},t.prototype.next=function(e){this.isStopped?m(function(e){return l("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?m(l("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?m(c,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(o.yU),p=Function.prototype.bind;function y(e,t){return p.call(e,t)}var g=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){v(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){v(e)}else v(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){v(e)}},e}(),b=function(e){function t(t,r,n){var o,a,u=e.call(this)||this;(0,i.T)(t)||!t?o={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:u&&s.$.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},o={next:t.next&&y(t.next,a),error:t.error&&y(t.error,a),complete:t.complete&&y(t.complete,a)}):o=t;return u.destination=new g(o),u}return(0,n.C6)(t,e),t}(h);function v(e){s.$.useDeprecatedSynchronousErrorHandling?(0,f.l)(e):(0,a.m)(e)}function m(e,t){var r=s.$.onStoppedNotification;r&&d.f.setTimeout((function(){return r(e,t)}))}var w={closed:!0,next:u.l,error:function(e){throw e},complete:u.l}},2616:(e,t,r)=>{"use strict";r.d(t,{Kn:()=>u,yU:()=>a,Uv:()=>c});var n=r(1635),i=r(1209),o=(0,r(2947).L)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),s=r(6174),a=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,s,a;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=(0,n.Ju)(u),d=c.next();!d.done;d=c.next()){d.value.remove(this)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else u.remove(this);var f=this.initialTeardown;if((0,i.T)(f))try{f()}catch(e){a=e instanceof o?e.errors:[e]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var p=(0,n.Ju)(h),y=p.next();!y.done;y=p.next()){var g=y.value;try{l(g)}catch(e){a=null!=a?a:[],e instanceof o?a=(0,n.fX)((0,n.fX)([],(0,n.zs)(a)),(0,n.zs)(e.errors)):a.push(e)}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(s=p.return)&&s.call(p)}finally{if(r)throw r.error}}}if(a)throw new o(a)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,s.o)(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&(0,s.o)(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),u=a.EMPTY;function c(e){return e instanceof a||e&&"closed"in e&&(0,i.T)(e.remove)&&(0,i.T)(e.add)&&(0,i.T)(e.unsubscribe)}function l(e){(0,i.T)(e)?e():e.unsubscribe()}},4384:(e,t,r)=>{"use strict";r.d(t,{$:()=>n});var n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},8825:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var n=(0,r(2947).L)((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),i=r(5508);function o(e,t){var r="object"==typeof t;return new Promise((function(o,s){var a=new i.Ms({next:function(e){o(e),a.unsubscribe()},error:s,complete:function(){r?o(t.defaultValue):s(new n)}});e.subscribe(a)}))}},2922:(e,t,r)=>{"use strict";r.d(t,{z:()=>y});var n=r(8483),i=Array.isArray,o=Object.getPrototypeOf,s=Object.prototype,a=Object.keys;function u(e){if(1===e.length){var t=e[0];if(i(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&o(n)===s){var r=a(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var n;return{args:e,keys:null}}var c=r(7968),l=r(8307),d=r(7516),f=r(2100);var h=r(4878),p=r(6315);function y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,f.lI)(e),i=(0,f.ms)(e),o=u(e),s=o.args,a=o.keys;if(0===s.length)return(0,c.H)([],r);var p=new n.c(function(e,t,r){void 0===r&&(r=l.D);return function(n){g(t,(function(){for(var i=e.length,o=new Array(i),s=i,a=i,u=function(i){g(t,(function(){var u=(0,c.H)(e[i],t),l=!1;u.subscribe((0,h._)(n,(function(e){o[i]=e,l||(l=!0,a--),a||n.next(r(o.slice()))}),(function(){--s||n.complete()})))}),n)},l=0;l<i;l++)u(l)}),n)}}(s,r,a?function(e){return function(e,t){return e.reduce((function(e,r,n){return e[r]=t[n],e}),{})}(a,e)}:l.D));return i?p.pipe((0,d.I)(i)):p}function g(e,t,r){e?(0,p.N)(r,e,t):t()}},2316:(e,t,r)=>{"use strict";r.d(t,{v:()=>o});var n=r(8483),i=r(5964);function o(e){return new n.c((function(t){(0,i.Tg)(e()).subscribe(t)}))}},1701:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var n=new(r(8483).c)((function(e){return e.complete()}))},7968:(e,t,r)=>{"use strict";r.d(t,{H:()=>_});var n=r(5964),i=r(6315),o=r(2908),s=r(4878);function a(e,t){return void 0===t&&(t=0),(0,o.N)((function(r,n){r.subscribe((0,s._)(n,(function(r){return(0,i.N)(n,e,(function(){return n.next(r)}),t)}),(function(){return(0,i.N)(n,e,(function(){return n.complete()}),t)}),(function(r){return(0,i.N)(n,e,(function(){return n.error(r)}),t)})))}))}function u(e,t){return void 0===t&&(t=0),(0,o.N)((function(r,n){n.add(e.schedule((function(){return r.subscribe(n)}),t))}))}var c=r(8483);var l=r(2059),d=r(1209);function f(e,t){if(!e)throw new Error("Iterable cannot be null");return new c.c((function(r){(0,i.N)(r,t,(function(){var n=e[Symbol.asyncIterator]();(0,i.N)(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}var h=r(7541),p=r(3440),y=r(9391),g=r(8667),b=r(2471),v=r(3465),m=r(8438);function w(e,t){if(null!=e){if((0,h.l)(e))return function(e,t){return(0,n.Tg)(e).pipe(u(t),a(t))}(e,t);if((0,y.X)(e))return function(e,t){return new c.c((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(e,t);if((0,p.y)(e))return function(e,t){return(0,n.Tg)(e).pipe(u(t),a(t))}(e,t);if((0,b.T)(e))return f(e,t);if((0,g.x)(e))return function(e,t){return new c.c((function(r){var n;return(0,i.N)(r,t,(function(){n=e[l.l](),(0,i.N)(r,t,(function(){var e,t,i;try{t=(e=n.next()).value,i=e.done}catch(e){return void r.error(e)}i?r.complete():r.next(t)}),0,!0)})),function(){return(0,d.T)(null==n?void 0:n.return)&&n.return()}}))}(e,t);if((0,m.U)(e))return function(e,t){return f((0,m.C)(e),t)}(e,t)}throw(0,v.L)(e)}function _(e,t){return t?w(e,t):(0,n.Tg)(e)}},9336:(e,t,r)=>{"use strict";r.d(t,{R:()=>h});var n=r(1635),i=r(5964),o=r(8483),s=r(8452),a=r(9391),u=r(1209),c=r(7516),l=["addListener","removeListener"],d=["addEventListener","removeEventListener"],f=["on","off"];function h(e,t,r,y){if((0,u.T)(r)&&(y=r,r=void 0),y)return h(e,t,r).pipe((0,c.I)(y));var g=(0,n.zs)(function(e){return(0,u.T)(e.addEventListener)&&(0,u.T)(e.removeEventListener)}(e)?d.map((function(n){return function(i){return e[n](t,i,r)}})):function(e){return(0,u.T)(e.addListener)&&(0,u.T)(e.removeListener)}(e)?l.map(p(e,t)):function(e){return(0,u.T)(e.on)&&(0,u.T)(e.off)}(e)?f.map(p(e,t)):[],2),b=g[0],v=g[1];if(!b&&(0,a.X)(e))return(0,s.Z)((function(e){return h(e,t,r)}))((0,i.Tg)(e));if(!b)throw new TypeError("Invalid event target");return new o.c((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return b(t),function(){return v(t)}}))}function p(e,t){return function(r){return function(n){return e[r](t,n)}}}},5964:(e,t,r)=>{"use strict";r.d(t,{Tg:()=>y});var n=r(1635),i=r(9391),o=r(3440),s=r(8483),a=r(7541),u=r(2471),c=r(3465),l=r(8667),d=r(8438),f=r(1209),h=r(2564),p=r(5604);function y(e){if(e instanceof s.c)return e;if(null!=e){if((0,a.l)(e))return v=e,new s.c((function(e){var t=v[p.s]();if((0,f.T)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,i.X)(e))return b=e,new s.c((function(e){for(var t=0;t<b.length&&!e.closed;t++)e.next(b[t]);e.complete()}));if((0,o.y)(e))return y=e,new s.c((function(e){y.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,h.m)}));if((0,u.T)(e))return g(e);if((0,l.x)(e))return r=e,new s.c((function(e){var t,i;try{for(var o=(0,n.Ju)(r),s=o.next();!s.done;s=o.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}e.complete()}));if((0,d.U)(e))return t=e,g((0,d.C)(t))}var t,r,y,b,v;throw(0,c.L)(e)}function g(e){return new s.c((function(t){(function(e,t){var r,i,o,s;return(0,n.sH)(this,void 0,void 0,(function(){var a,u;return(0,n.YH)(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=(0,n.xN)(e),c.label=1;case 1:return[4,r.next()];case 2:if((i=c.sent()).done)return[3,4];if(a=i.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=c.sent(),o={error:u},[3,11];case 6:return c.trys.push([6,,9,10]),i&&!i.done&&(s=r.return)?[4,s.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},4240:(e,t,r)=>{"use strict";r.d(t,{h:()=>u});var n=r(3031),i=r(5964),o=r(1701),s=r(2100),a=r(7968);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,s.lI)(e),u=(0,s.R0)(e,1/0),c=e;return c.length?1===c.length?(0,i.Tg)(c[0]):(0,n.U)(u)((0,a.H)(c,r)):o.w}},1150:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(8483),i=r(2357),o=new n.c(i.l)},2467:(e,t,r)=>{"use strict";r.d(t,{of:()=>o});var n=r(2100),i=r(7968);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,n.lI)(e);return(0,i.H)(e,r)}},3288:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});var n=r(8483),i=r(1209);function o(e,t){var r=(0,i.T)(e)?e:function(){return e},o=function(e){return e.error(r())};return new n.c(t?function(e){return t.schedule(o,0,e)}:o)}},9697:(e,t,r)=>{"use strict";r.d(t,{O:()=>a});var n=r(8483),i=r(7903),o=r(8820),s=r(6577);function a(e,t,r){void 0===e&&(e=0),void 0===r&&(r=i.b);var a=-1;return null!=t&&((0,o.m)(t)?r=t:a=t),new n.c((function(t){var n=(0,s.v)(e)?+e-r.now():e;n<0&&(n=0);var i=0;return r.schedule((function(){t.closed||(t.next(i++),0<=a?this.schedule(void 0,a):t.complete())}),n)}))}},4878:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});var n=r(1635);function i(e,t,r,n,i){return new o(e,t,r,n,i)}var o=function(e){function t(t,r,n,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,n.C6)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(r(5508).vU)},6847:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(5964),i=r(4878),o=r(2908);function s(e){return(0,o.N)((function(t,r){var o,a=null,u=!1;a=t.subscribe((0,i._)(r,void 0,void 0,(function(i){o=(0,n.Tg)(e(i,s(e)(t))),a?(a.unsubscribe(),a=null,o.subscribe(r)):u=!0}))),u&&(a.unsubscribe(),a=null,o.subscribe(r))}))}},6978:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var n=r(7903),i=r(2908),o=r(4878);function s(e,t){return void 0===t&&(t=n.E),(0,i.N)((function(r,n){var i=null,s=null,a=null,u=function(){if(i){i.unsubscribe(),i=null;var e=s;s=null,n.next(e)}};function c(){var r=a+e,o=t.now();if(o<r)return i=this.schedule(void 0,r-o),void n.add(i);u()}r.subscribe((0,o._)(n,(function(r){s=r,a=t.now(),i||(i=t.schedule(c,e),n.add(i))}),(function(){u(),n.complete()}),void 0,(function(){s=i=null})))}))}},1900:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});var n=r(8307),i=r(2908),o=r(4878);function s(e,t){return void 0===t&&(t=n.D),e=null!=e?e:a,(0,i.N)((function(r,n){var i,s=!0;r.subscribe((0,o._)(n,(function(r){var o=t(r);!s&&e(i,o)||(s=!1,i=o,n.next(r))})))}))}function a(e,t){return e===t}},1080:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var n=r(1160),i=r(5964),o=r(2908),s=r(4878);function a(e,t){return t?function(r){return r.pipe(a((function(r,o){return(0,i.Tg)(e(r,o)).pipe((0,n.T)((function(e,n){return t(r,e,o,n)})))})))}:(0,o.N)((function(t,r){var n=0,o=null,a=!1;t.subscribe((0,s._)(r,(function(t){o||(o=(0,s._)(r,void 0,(function(){o=null,a&&r.complete()})),(0,i.Tg)(e(t,n++)).subscribe(o))}),(function(){a=!0,!o&&r.complete()})))}))}},6126:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var n=r(2908),i=r(4878);function o(e,t){return(0,n.N)((function(r,n){var o=0;r.subscribe((0,i._)(n,(function(r){return e.call(t,r,o++)&&n.next(r)})))}))}},1160:(e,t,r)=>{"use strict";r.d(t,{T:()=>o});var n=r(2908),i=r(4878);function o(e,t){return(0,n.N)((function(r,n){var o=0;r.subscribe((0,i._)(n,(function(r){n.next(e.call(t,r,o++))})))}))}},3031:(e,t,r)=>{"use strict";r.d(t,{U:()=>o});var n=r(8452),i=r(8307);function o(e){return void 0===e&&(e=1/0),(0,n.Z)(i.D,e)}},8452:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(1160),i=r(5964),o=r(2908),s=r(6315),a=r(4878);var u=r(1209);function c(e,t,r){return void 0===r&&(r=1/0),(0,u.T)(t)?c((function(r,o){return(0,n.T)((function(e,n){return t(r,e,o,n)}))((0,i.Tg)(e(r,o)))}),r):("number"==typeof t&&(r=t),(0,o.N)((function(t,n){return function(e,t,r,n,o,u,c,l){var d=[],f=0,h=0,p=!1,y=function(){!p||d.length||f||t.complete()},g=function(e){return f<n?b(e):d.push(e)},b=function(e){u&&t.next(e),f++;var l=!1;(0,i.Tg)(r(e,h++)).subscribe((0,a._)(t,(function(e){null==o||o(e),u?g(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{f--;for(var e=function(){var e=d.shift();c?(0,s.N)(t,c,(function(){return b(e)})):b(e)};d.length&&f<n;)e();y()}catch(e){t.error(e)}})))};return e.subscribe((0,a._)(t,g,(function(){p=!0,y()}))),function(){null==l||l()}}(t,n,e,r)})))}},3160:(e,t,r)=>{"use strict";r.d(t,{L:()=>u});var n=r(2908),i=r(4878),o=r(8307),s=r(9697),a=r(5964);function u(e){var t;void 0===e&&(e=1/0);var r=(t=e&&"object"==typeof e?e:{count:e}).count,u=void 0===r?1/0:r,c=t.delay,l=t.resetOnSuccess,d=void 0!==l&&l;return u<=0?o.D:(0,n.N)((function(e,t){var r,n=0,o=function(){var l=!1;r=e.subscribe((0,i._)(t,(function(e){d&&(n=0),t.next(e)}),void 0,(function(e){if(n++<u){var d=function(){r?(r.unsubscribe(),r=null,o()):l=!0};if(null!=c){var f="number"==typeof c?(0,s.O)(c):(0,a.Tg)(c(e,n)),h=(0,i._)(t,(function(){h.unsubscribe(),d()}),(function(){t.complete()}));f.subscribe(h)}else d()}else t.error(e)}))),l&&(r.unsubscribe(),r=null,o())};o()}))}},1005:(e,t,r)=>{"use strict";r.d(t,{u:()=>u});var n=r(1635),i=r(5964),o=r(7291),s=r(5508),a=r(2908);function u(e){void 0===e&&(e={});var t=e.connector,r=void 0===t?function(){return new o.B}:t,n=e.resetOnError,u=void 0===n||n,l=e.resetOnComplete,d=void 0===l||l,f=e.resetOnRefCountZero,h=void 0===f||f;return function(e){var t,n,o,l=0,f=!1,p=!1,y=function(){null==n||n.unsubscribe(),n=void 0},g=function(){y(),t=o=void 0,f=p=!1},b=function(){var e=t;g(),null==e||e.unsubscribe()};return(0,a.N)((function(e,a){l++,p||f||y();var v=o=null!=o?o:r();a.add((function(){0!==--l||p||f||(n=c(b,h))})),v.subscribe(a),!t&&l>0&&(t=new s.Ms({next:function(e){return v.next(e)},error:function(e){p=!0,y(),n=c(g,u,e),v.error(e)},complete:function(){f=!0,y(),n=c(g,d),v.complete()}}),(0,i.Tg)(e).subscribe(t))}))(e)}}function c(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(!0!==t){if(!1!==t){var a=new s.Ms({next:function(){a.unsubscribe(),e()}});return(0,i.Tg)(t.apply(void 0,(0,n.fX)([],(0,n.zs)(r)))).subscribe(a)}}else e()}},7718:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(9741),i=r(1005);function o(e,t,r){var o,s,a,u,c=!1;return e&&"object"==typeof e?(o=e.bufferSize,u=void 0===o?1/0:o,s=e.windowTime,t=void 0===s?1/0:s,c=void 0!==(a=e.refCount)&&a,r=e.scheduler):u=null!=e?e:1/0,(0,i.u)({connector:function(){return new n.m(u,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}},9050:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(3031);var i=r(2100),o=r(7968);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,n.U)(1)((0,o.H)(e,(0,i.lI)(e)))}var a=r(2908);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,i.lI)(e);return(0,a.N)((function(t,n){(r?s(e,t,r):s(e,t)).subscribe(n)}))}},3720:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var n=r(5964),i=r(2908),o=r(4878);function s(e,t){return(0,i.N)((function(r,i){var s=null,a=0,u=!1,c=function(){return u&&!s&&i.complete()};r.subscribe((0,o._)(i,(function(r){null==s||s.unsubscribe();var u=0,l=a++;(0,n.Tg)(e(r,l)).subscribe(s=(0,o._)(i,(function(e){return i.next(t?t(r,e,l,u++):e)}),(function(){s=null,c()})))}),(function(){u=!0,c()})))}))}},8975:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var n=r(1701),i=r(2908),o=r(4878);function s(e){return e<=0?function(){return n.w}:(0,i.N)((function(t,r){var n=0;t.subscribe((0,o._)(r,(function(t){++n<=e&&(r.next(t),e<=n&&r.complete())})))}))}},7791:(e,t,r)=>{"use strict";r.d(t,{Q:()=>a});var n=r(2908),i=r(4878),o=r(5964),s=r(2357);function a(e){return(0,n.N)((function(t,r){(0,o.Tg)(e).subscribe((0,i._)(r,(function(){return r.complete()}),s.l)),!r.closed&&t.subscribe(r)}))}},9099:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var n=r(1209),i=r(2908),o=r(4878),s=r(8307);function a(e,t,r){var a=(0,n.T)(e)||t||r?{next:e,error:t,complete:r}:e;return a?(0,i.N)((function(e,t){var r;null===(r=a.subscribe)||void 0===r||r.call(a);var n=!0;e.subscribe((0,o._)(t,(function(e){var r;null===(r=a.next)||void 0===r||r.call(a,e),t.next(e)}),(function(){var e;n=!1,null===(e=a.complete)||void 0===e||e.call(a),t.complete()}),(function(e){var r;n=!1,null===(r=a.error)||void 0===r||r.call(a,e),t.error(e)}),(function(){var e,t;n&&(null===(e=a.unsubscribe)||void 0===e||e.call(a)),null===(t=a.finalize)||void 0===t||t.call(a)})))})):s.D}},7903:(e,t,r)=>{"use strict";r.d(t,{b:()=>d,E:()=>l});var n=r(1635),i=function(e){function t(t,r){return e.call(this)||this}return(0,n.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(r(2616).yU),o={setInterval:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var s=o.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,(0,n.fX)([e,t],(0,n.zs)(r))):setInterval.apply(void 0,(0,n.fX)([e,t],(0,n.zs)(r)))},clearInterval:function(e){var t=o.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},s=r(6174),a=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,n.C6)(t,e),t.prototype.schedule=function(e,t){var r;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),o.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&o.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,s.o)(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(i),u=r(1179),c=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=u.U.now,e}(),l=new(function(e){function t(t,r){void 0===r&&(r=c.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,n.C6)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(c))(a),d=l},1179:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});var n={now:function(){return(n.delegate||Date).now()},delegate:void 0}},6744:(e,t,r)=>{"use strict";r.d(t,{f:()=>i});var n=r(1635),i={setTimeout:function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s=i.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,n.fX)([e,t],(0,n.zs)(r))):setTimeout.apply(void 0,(0,n.fX)([e,t],(0,n.zs)(r)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},2059:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});var n="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},5604:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var n="function"==typeof Symbol&&Symbol.observable||"@@observable"},2100:(e,t,r)=>{"use strict";r.d(t,{R0:()=>u,lI:()=>a,ms:()=>s});var n=r(1209),i=r(8820);function o(e){return e[e.length-1]}function s(e){return(0,n.T)(o(e))?e.pop():void 0}function a(e){return(0,i.m)(o(e))?e.pop():void 0}function u(e,t){return"number"==typeof o(e)?e.pop():t}},6174:(e,t,r)=>{"use strict";function n(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}r.d(t,{o:()=>n})},2947:(e,t,r)=>{"use strict";function n(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}r.d(t,{L:()=>n})},7008:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o,l:()=>s});var n=r(4384),i=null;function o(e){if(n.$.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var r=i,o=r.errorThrown,s=r.error;if(i=null,o)throw s}}else e()}function s(e){n.$.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},6315:(e,t,r)=>{"use strict";function n(e,t,r,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=t.schedule((function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(o),!i)return o}r.d(t,{N:()=>n})},8307:(e,t,r)=>{"use strict";function n(e){return e}r.d(t,{D:()=>n})},9391:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var n=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},2471:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(1209);function i(e){return Symbol.asyncIterator&&(0,n.T)(null==e?void 0:e[Symbol.asyncIterator])}},6577:(e,t,r)=>{"use strict";function n(e){return e instanceof Date&&!isNaN(e)}r.d(t,{v:()=>n})},1209:(e,t,r)=>{"use strict";function n(e){return"function"==typeof e}r.d(t,{T:()=>n})},7541:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});var n=r(5604),i=r(1209);function o(e){return(0,i.T)(e[n.s])}},8667:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});var n=r(2059),i=r(1209);function o(e){return(0,i.T)(null==e?void 0:e[n.l])}},3440:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});var n=r(1209);function i(e){return(0,n.T)(null==e?void 0:e.then)}},8438:(e,t,r)=>{"use strict";r.d(t,{C:()=>o,U:()=>s});var n=r(1635),i=r(1209);function o(e){return(0,n.AQ)(this,arguments,(function(){var t,r,i;return(0,n.YH)(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,(0,n.N3)(t.read())];case 3:return r=o.sent(),i=r.value,r.done?[4,(0,n.N3)(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,(0,n.N3)(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function s(e){return(0,i.T)(null==e?void 0:e.getReader)}},8820:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(1209);function i(e){return e&&(0,n.T)(e.schedule)}},2908:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var n=r(1209);function i(e){return function(t){if(function(e){return(0,n.T)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},7516:(e,t,r)=>{"use strict";r.d(t,{I:()=>s});var n=r(1635),i=r(1160),o=Array.isArray;function s(e){return(0,i.T)((function(t){return function(e,t){return o(t)?e.apply(void 0,(0,n.fX)([],(0,n.zs)(t))):e(t)}(e,t)}))}},2357:(e,t,r)=>{"use strict";function n(){}r.d(t,{l:()=>n})},1485:(e,t,r)=>{"use strict";r.d(t,{F:()=>i,m:()=>o});var n=r(8307);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(e)}function o(e){return 0===e.length?n.D:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}},2564:(e,t,r)=>{"use strict";r.d(t,{m:()=>o});var n=r(4384),i=r(6744);function o(e){i.f.setTimeout((function(){var t=n.$.onUnhandledError;if(!t)throw e;t(e)}))}},3465:(e,t,r)=>{"use strict";function n(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}r.d(t,{L:()=>n})},6683:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});const n="Pikabu Fixes"},8528:(e,t,r)=>{"use strict";function n(e){return console.log(e),e instanceof Error?`${e.stack}`:String(e)}r.d(t,{M:()=>n})},4365:(e,t,r)=>{"use strict";r.d(t,{$:()=>U});var n=r(3732),i=r(5140),o=r(5966),s=r(7291),a=r(4240),u=r(9050),c=r(3720),l=r(2922),d=r(1900),f=r(8825),h=r(9697),p=r(6126),y=r(1080),g=r(8483),b=r(1160),v=r(6412),m=r(5360),w=r(964),_=r(4938),S=r(7284),k=r(1124),x=r.n(k),O=r(7871);class T{static async hash(e,t=10){const r=await O.genSalt(t);return O.hash(e,r)}static async compare(e,t){return O.compare(e,t)}}var A=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};let E=class{getLastDigits(e){return Number(String(e).slice(-2))}async isCompare(e,t,r){return T.compare(`${t}-${r}`,e)}};E=A([(0,m.k)()],E);var C,R=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};const P={version:7,name:"des--booster-candidate",tables:[{name:"candidate",columns:{orderUuid:{primaryKey:!0,dataType:"string",unique:!0,notNull:!0},hash:{dataType:"string",notNull:!0},lastDigits:{dataType:"number",notNull:!0},outDate:{dataType:"string",notNull:!0},initialStoryId:{dataType:"number",default:0,notNull:!0},foundedStoryId:{dataType:"number",default:0,notNull:!0},obsolete:{dataType:"number",notNull:!0,default:0},progress:{dataType:"number",notNull:!0,default:0},success:{dataType:"number",notNull:!0,default:0},error:{dataType:"number",notNull:!0,default:0}},alter:{6:{add:{voted:{dataType:"number",notNull:!0,default:0}}},7:{add:{rejected:{dataType:"number",notNull:!0,default:0}}}}}]};let j=C=class{boosterCandidateComparatorService=v.m.get(E);_db;get db(){return this._db||(this._db=this.openDB()),this._db}async setActualCandidates(e){const t=e.map((e=>e.orderUuid));await this.markObsoleteExcept(t);const r=e.map((e=>C.toInsertStoredModel(e)));await this.insertCandidates(r)}async updateCandidate(e,t){const r=await this.db;await r.update({in:"candidate",where:{orderUuid:e},set:t})}async getCandidateByStoryId(e){const t=await this.db,r=await t.select({from:"candidate",where:{initialStoryId:e,or:{foundedStoryId:e}},limit:1});return r.length?r[0]:null}async findCandidateByStoryAndAuthorId(e,t){const r=await this.db,n=await this.getCandidateByStoryId(e);if(n)return n;const i=this.boosterCandidateComparatorService.getLastDigits(e),o=await r.select({from:"candidate",where:{lastDigits:i,initialStoryId:0,foundedStoryId:0,obsolete:0,rejected:0}});for(const r of o){if(await this.boosterCandidateComparatorService.isCompare(r.hash,e,t))return await this.updateCandidate(r.orderUuid,{foundedStoryId:e}),r}return null}async getCandidatesForUpvote(e){return(await this.db).select({from:"candidate",where:{initialStoryId:{"!=":0},obsolete:0,success:0,error:0,voted:0,rejected:0},limit:e})}async openDB(){if(_.WU!==_.Jb.Background)throw new Error("wrong runtime");const e=new S.Connection;return e.addPlugin(x()),await e.initDb(P),e}static toInsertStoredModel(e){return{orderUuid:e.orderUuid,hash:e.hash,lastDigits:e.lastDigits,outDate:e.outDate,initialStoryId:e.storyId??0,foundedStoryId:e.storyId??0,error:0,progress:0,success:0,obsolete:0,voted:0,rejected:0}}async markObsoleteExcept(e){const t=await this.db;let r;r=e.length>0?e.map((e=>({obsolete:0,orderUuid:{"!=":e}}))):{obsolete:0},await t.update({in:"candidate",where:r,set:{obsolete:1}})}async insertCandidates(e){if(!e.length)return;const t=await this.db;await t.insert({into:"candidate",values:e,ignore:!0})}};j=C=R([(0,m.k)()],j);var I=r(5825),M=r(2254),D=r(2654),N=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},B=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let U=class{boosterOrderStorageService=v.m.get(M.X);boosterCandidateStorageService=v.m.get(j);boosterCandidateApiService=w.FP;clientService=v.m.get(I.N);boosterTransactionService=v.m.get(D.E);updatedBg$=new s.B;updateOnSubscribeBg$=(0,o.n3)((()=>this.periodicUpdateOnSubscribeBg()));getCandidatesForUpvote(){return(0,a.h)(this.updateOnSubscribeBg$,this.updatedBg$).pipe((0,u.Z)(null),(0,c.n)((()=>(0,l.z)({candidates:this.boosterCandidateStorageService.getCandidatesForUpvote(),orders:this.boosterOrderStorageService.getActiveOrders()}))),(0,b.T)((({candidates:e,orders:t})=>{const r=new Set(t.map((e=>e.uuid)));return e.filter((e=>!r.has(e.orderUuid)))??null})),(0,d.F)(n.XR))}findCandidate(e,t){return(0,a.h)(this.updateOnSubscribeBg$,this.updatedBg$).pipe((0,u.Z)(null),(0,c.n)((()=>this.boosterCandidateStorageService.findCandidateByStoryAndAuthorId(e,t))),(0,d.F)(n.XR))}async markAsObsolete(e){await this.updateCandidateBg(e,{obsolete:1})}async markAsVoted(e){await this.updateCandidateBg(e,{voted:1})}async markAsRejected(e){await this.updateCandidateBg(e,{rejected:1})}async upvote(e,t,r){const n=this.boosterTransactionService.transactionClient(e,t,r);await this.updateCandidateBg(e,{progress:1});try{const t=await(0,f._)(n);await this.updateCandidateBg(e,{progress:0,success:t?1:0,error:t?0:1})}catch(t){await this.updateCandidateBg(e,{progress:0,error:1})}}periodicUpdateOnSubscribeBg(){return(0,h.O)(0,3e4).pipe((0,c.n)((()=>this.clientService.enabledUuid$)),(0,p.p)(Boolean),(0,y.p)((e=>this.updateCandidatesBg(e))),(0,o.Zm)())}async updateCandidatesBg(e){try{const t=await this.boosterCandidateApiService.boosterCandidateControllerGetCandidates(e);await this.boosterCandidateStorageService.setActualCandidates(t),this.updatedBg$.next()}catch(e){}}async updateCandidateBg(e,t){await this.boosterCandidateStorageService.updateCandidate(e,t),this.updatedBg$.next()}};N([(0,i.mM)("BoosterCandidateService.getCandidatesForUpvote"),B("design:type",Function),B("design:paramtypes",[]),B("design:returntype",g.c)],U.prototype,"getCandidatesForUpvote",null),N([(0,i.mM)("BoosterCandidateService.findCandidate"),B("design:type",Function),B("design:paramtypes",[Number,Number]),B("design:returntype",g.c)],U.prototype,"findCandidate",null),N([(0,i.mM)("BoosterCandidateService.periodicUpdateOnSubscribeBg"),B("design:type",Function),B("design:paramtypes",[]),B("design:returntype",g.c)],U.prototype,"periodicUpdateOnSubscribeBg",null),N([(0,i.up)("BoosterCandidateService.updateCandidatesBg"),B("design:type",Function),B("design:paramtypes",[String]),B("design:returntype",Promise)],U.prototype,"updateCandidatesBg",null),N([(0,i.up)("BoosterCandidateService.updateCandidateBg"),B("design:type",Function),B("design:paramtypes",[String,Object]),B("design:returntype",Promise)],U.prototype,"updateCandidateBg",null),U=N([(0,m.k)()],U)},5825:(e,t,r)=>{"use strict";r.d(t,{N:()=>S});var n=r(3732),i=r(4938),o=r(5140),s=r(5966),a=r(9426),u=r(4240),c=r(9697),l=r(3720),d=r(6126),f=r(1080),h=r(8825),p=r(8483),y=r(1160),g=r(6412),b=r(5360),v=r(964),m=r(4982),w=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},_=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let S=class{settingsService=g.m.get(m.h);boosterClientApiService=v.BN;statusBg$=new a.t(null);periodicStatusUpdateOnSubscribe$=(0,s.n3)((()=>this.periodicStatusUpdateOnSubscribeBg()));enabledUuid$=this.settingsService.settings$.pipe((0,y.T)((e=>e.booster&&e.boosterUuid||null)));status$=(0,s.n3)((()=>this.getStatusShare()));constructor(){this.firstInitializeBg()}async logout(){await this.settingsService.setKey("boosterUuid",null),await this.updateStatus()}async generateUuid(){const e=await this.boosterClientApiService.boosterClientControllerRegisterClient();if(!e.uuid)throw new Error("uuid not received");await this.settingsService.setKey("boosterUuid",e.uuid),await this.updateStatus()}async generateUuidAuto(e){const t=await this.boosterClientApiService.boosterClientControllerRegisterClientAuto(e);if(!t.uuid)throw new Error("uuid not received");await this.settingsService.setKey("boosterUuid",t.uuid),await this.updateStatus()}async setUuid(e){try{const t=await this.boosterClientApiService.boosterClientControllerGetStatus(e),r=(0,n.O9)(t.points);return await this.settingsService.setKey("boosterUuid",e),r}catch(e){return!1}}async updateStatus(){await this.updateStatusBg()}getStatusShare(){return(0,u.h)(this.statusBg$,this.periodicStatusUpdateOnSubscribe$)}async firstInitializeBg(){if(i.WU!==i.Jb.Background)return;const e=await this.settingsService.get();e.boosterFirstInitialized||(e.boosterUuid?await this.settingsService.setKey("boosterFirstInitialized",!0):(await this.settingsService.patch({booster:!0,boosterFirstInitialized:!0}),await this.generateUuidAuto(e.uuid)))}periodicStatusUpdateOnSubscribeBg(){return(0,c.O)(0,3e4).pipe((0,l.n)((()=>this.enabledUuid$)),(0,d.p)(Boolean),(0,f.p)((()=>this.updateStatusBg())),(0,s.Zm)())}async updateStatusBg(){try{const e=await(0,h._)(this.enabledUuid$);if(!e)return;const t=await this.boosterClientApiService.boosterClientControllerGetStatus(e);this.statusBg$.next(t)}catch(e){}}};w([(0,o.up)("BoosterClientService.logout"),_("design:type",Function),_("design:paramtypes",[]),_("design:returntype",Promise)],S.prototype,"logout",null),w([(0,o.up)("BoosterClientService.generateUuid"),_("design:type",Function),_("design:paramtypes",[]),_("design:returntype",Promise)],S.prototype,"generateUuid",null),w([(0,o.up)("BoosterClientService.generateUuidAuto"),_("design:type",Function),_("design:paramtypes",[String]),_("design:returntype",Promise)],S.prototype,"generateUuidAuto",null),w([(0,o.up)("BoosterClientService.setUuid"),_("design:type",Function),_("design:paramtypes",[String]),_("design:returntype",Promise)],S.prototype,"setUuid",null),w([(0,o.mM)("BoosterClientService.getStatusShare"),_("design:type",Function),_("design:paramtypes",[]),_("design:returntype",p.c)],S.prototype,"getStatusShare",null),w([(0,o.mM)("BoosterClientService.periodicStatusUpdateOnSubscribeBg"),_("design:type",Function),_("design:paramtypes",[]),_("design:returntype",p.c)],S.prototype,"periodicStatusUpdateOnSubscribeBg",null),S=w([(0,b.k)(),_("design:paramtypes",[])],S)},475:(e,t,r)=>{"use strict";r.d(t,{k:()=>m});var n=r(5140),i=r(5966),o=r(9426),s=r(4240),a=r(9697),u=r(3720),c=r(6126),l=r(1080),d=r(8825),f=r(8483),h=r(6412),p=r(5360),y=r(964),g=r(5825),b=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let m=class{boosterClientService=h.m.get(g.N);boosterClientApiService=y.Mi;conditionsBg$=new o.t(null);periodicStatusUpdateOnSubscribe$=(0,i.n3)((()=>this.periodicUpdateOnSubscribeBg()));conditions$=(0,i.n3)((()=>this.getConditionsShare()));getConditionsShare(){return(0,s.h)(this.conditionsBg$,this.periodicStatusUpdateOnSubscribe$)}periodicUpdateOnSubscribeBg(){return(0,a.O)(0,3e4).pipe((0,u.n)((()=>this.boosterClientService.enabledUuid$)),(0,c.p)(Boolean),(0,l.p)((()=>this.updateStatusBg())),(0,i.Zm)())}async updateStatusBg(){try{const e=await(0,d._)(this.boosterClientService.enabledUuid$);if(!e)return;const t=await this.boosterClientApiService.boosterOrderConditionsControllerGetOrderConditions(e);this.conditionsBg$.next(t)}catch(e){}}};b([(0,n.mM)("BoosterOrderConditionsService.getConditionsShare"),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",f.c)],m.prototype,"getConditionsShare",null),b([(0,n.mM)("BoosterOrderConditionsService.periodicUpdateOnSubscribeBg"),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",f.c)],m.prototype,"periodicUpdateOnSubscribeBg",null),m=b([(0,p.k)()],m)},2254:(e,t,r)=>{"use strict";r.d(t,{X:()=>d});var n,i=r(4938),o=r(7284),s=r(1124),a=r.n(s),u=r(5360),c=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};const l={version:1,name:"des--booster-order",tables:[{name:"order",columns:{uuid:{primaryKey:!0,dataType:"string",unique:!0,notNull:!0},outDate:{dataType:"string",notNull:!0},storyId:{dataType:"number",notNull:!0},storyTitle:{dataType:"string",notNull:!0},votesLimit:{dataType:"number",notNull:!0},votesRest:{dataType:"number",notNull:!0},votesSuccess:{dataType:"number",notNull:!0},active:{dataType:"number",notNull:!0},deleted:{dataType:"number",notNull:!0}}}]};let d=n=class{_db;get db(){return this._db||(this._db=this.openDB()),this._db}async setActualOrders(e){const t=e.map((e=>e.uuid));await this.markDeletedExcept(t);const r=e.map((e=>n.toInsertStoredModel(e)));await this.upsertCandidates(r)}async getActualOrders(){return(await this.db).select({from:"order",where:{deleted:0},order:[{by:"outDate",type:"desc"},{by:"active",type:"desc"}]})}async getActiveOrders(){return(await this.db).select({from:"order",where:{active:1,deleted:0}})}async getActualOrdersByStoryId(e){return(await this.db).select({from:"order",where:{storyId:e,deleted:0}})}async openDB(){if(i.WU!==i.Jb.Background)throw new Error("wrong runtime");const e=new o.Connection;return e.addPlugin(a()),await e.initDb(l),e}static toInsertStoredModel(e){return{active:e.active?1:0,deleted:e.deleted?1:0,outDate:e.outDate,storyId:e.storyId,storyTitle:e.storyTitle,uuid:e.uuid,votesLimit:e.votesLimit,votesRest:e.votesRest,votesSuccess:e.votesSuccess}}async upsertCandidates(e){if(!e.length)return;const t=await this.db;await t.insert({into:"order",values:e,upsert:!0})}async markDeletedExcept(e){const t=await this.db;let r;r=e.length>0?e.map((e=>({deleted:0,uuid:{"!=":e}}))):{deleted:0},await t.update({in:"order",where:r,set:{deleted:1,active:0}})}};d=n=c([(0,u.k)()],d)},2481:(e,t,r)=>{"use strict";r.d(t,{Q:()=>E});var n=r(3732),i=r(5140),o=r(5966),s=r(4188),a=r(7767),u=r(551);var c=r(7291),l=r(4240),d=r(9050),f=r(3720),h=r(1900),p=r(8825),y=r(9697),g=r(6126),b=r(1080),v=r(8483),m=r(1160),w=r(6412),_=r(5360),S=r(964),k=r(4365),x=r(5825),O=r(2254),T=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},A=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let E=class{boosterCandidateService=w.m.get(k.$);boosterOrderStorageService=w.m.get(O.X);boosterOrderApiService=S.Mi;clientService=w.m.get(x.N);updatedBg$=new c.B;updateOrdersOnSubscribeBg$=(0,o.n3)((()=>this.periodicUpdateOrdersOnSubscribeBg()));getActualOrders(){return(0,l.h)(this.updateOrdersOnSubscribeBg$,this.updatedBg$).pipe((0,d.Z)(null),(0,f.n)((()=>this.boosterOrderStorageService.getActualOrders())),(0,h.F)(n.XR))}getActualOrderOrNull(e){return(0,l.h)(this.updateOrdersOnSubscribeBg$,this.updatedBg$).pipe((0,d.Z)(null),(0,f.n)((()=>this.boosterOrderStorageService.getActualOrdersByStoryId(e))),(0,m.T)((e=>e[0]??null)),(0,h.F)(n.XR))}async delete(e){const t=await(0,p._)(this.clientService.enabledUuid$);t&&(await this.boosterOrderApiService.boosterOrderControllerDeleteOrder(e,t),await this.updateOrdersBg(t),await this.boosterCandidateService.markAsObsolete(e))}async deleteObsolete(){const e=await(0,p._)(this.clientService.enabledUuid$);e&&(await this.boosterOrderApiService.boosterOrderControllerDeleteObsolete(e),await this.updateOrdersBg(e),await this.boosterCandidateService.updateCandidatesBg(e))}async create(e,t,r){const n=function(e,t){(0,u.A)(2,arguments);var r=(0,s.A)(t);return(0,a.A)(e,6e4*r)}(Date.now(),r),i=await(0,p._)(this.clientService.enabledUuid$);if(!i)return Promise.reject("empty client uuid");await this.boosterOrderApiService.boosterOrderControllerCreateOrder({storyId:e,votesLimit:t,outDate:n.toISOString()},i),await this.updateOrdersBg(i)}periodicUpdateOrdersOnSubscribeBg(){return(0,y.O)(0,3e4).pipe((0,f.n)((()=>this.clientService.enabledUuid$)),(0,g.p)(Boolean),(0,b.p)((e=>this.updateOrdersBg(e))),(0,o.Zm)())}async updateOrdersBg(e){try{const t=await this.boosterOrderApiService.boosterOrderControllerGetOrders(e);await this.boosterOrderStorageService.setActualOrders(t),this.updatedBg$.next()}catch(e){}}};T([(0,i.mM)("BoosterOrderService.getActualOrders"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",v.c)],E.prototype,"getActualOrders",null),T([(0,i.mM)("BoosterOrderService.getActualOrderOrNull"),A("design:type",Function),A("design:paramtypes",[Number]),A("design:returntype",v.c)],E.prototype,"getActualOrderOrNull",null),T([(0,i.up)("BoosterOrderService.delete"),A("design:type",Function),A("design:paramtypes",[String]),A("design:returntype",Promise)],E.prototype,"delete",null),T([(0,i.up)("BoosterOrderService.deleteObsolete"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",Promise)],E.prototype,"deleteObsolete",null),T([(0,i.up)("BoosterOrderService.create"),A("design:type",Function),A("design:paramtypes",[Number,Number,Number]),A("design:returntype",Promise)],E.prototype,"create",null),T([(0,i.mM)("BoosterOrderService.periodicUpdateOrdersOnSubscribeBg"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",v.c)],E.prototype,"periodicUpdateOrdersOnSubscribeBg",null),E=T([(0,_.k)()],E)},9444:(e,t,r)=>{"use strict";r.d(t,{d:()=>m});var n=r(5140),i=r(5966),o=r(9426),s=r(4240),a=r(9697),u=r(3720),c=r(6126),l=r(1080),d=r(8825),f=r(8483),h=r(6412),p=r(5360),y=r(964),g=r(5825),b=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},v=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let m=class{boosterClientService=h.m.get(g.N);boosterPointsTransactionApiService=y.Fd;transactionsBg$=new o.t(null);periodicUpdateOnSubscribe$=(0,i.n3)((()=>this.periodicUpdateOnSubscribeBg()));transactions$=(0,i.n3)((()=>this.getTransactionsShare()));getTransactionsShare(){return(0,s.h)(this.transactionsBg$,this.periodicUpdateOnSubscribe$)}periodicUpdateOnSubscribeBg(){return(0,a.O)(0,3e4).pipe((0,u.n)((()=>this.boosterClientService.enabledUuid$)),(0,c.p)(Boolean),(0,l.p)((()=>this.updateTransactionsBg())),(0,i.Zm)())}async updateTransactionsBg(){try{const e=await(0,d._)(this.boosterClientService.enabledUuid$);if(!e)return;const t=await this.boosterPointsTransactionApiService.boosterPointsTransactionControllerGetHistory(e);this.transactionsBg$.next(t)}catch(e){}}};b([(0,n.mM)("BoosterPointsTransactionService.getTransactionsShare"),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",f.c)],m.prototype,"getTransactionsShare",null),b([(0,n.mM)("BoosterPointsTransactionService.periodicUpdateOnSubscribeBg"),v("design:type",Function),v("design:paramtypes",[]),v("design:returntype",f.c)],m.prototype,"periodicUpdateOnSubscribeBg",null),m=b([(0,p.k)()],m)},1591:(e,t,r)=>{"use strict";r.d(t,{b:()=>h});var n=r(3732),i=r(2316),o=r(3720),s=r(3288),a=r(2467),u=r(5360),c=r(9994),l=r(6789),d=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let h=class{storyMobileApiService;constructor(e){this.storyMobileApiService=e}getRealStoryRating(e){return(0,i.v)((()=>this.storyMobileApiService.fetchStoryPageWithoutCache(e,1))).pipe((0,o.n)((e=>{if((0,c.v)(e)||!e?.story)return(0,s.$)((()=>"Не удалось получить данные поста"));const t=e.story;return(0,n.vM)(t.story_pluses)&&(0,n.vM)(t.story_minuses)?(0,a.of)({pluses:t.story_pluses,minuses:t.story_minuses}):(0,s.$)((()=>"Данные поста не содержат информацию о рейтинге"))})))}};h=d([(0,u.k)(),f("design:paramtypes",[l.L])],h)},2654:(e,t,r)=>{"use strict";r.d(t,{E:()=>B});var n=r(3732),i=r(5140),o=r(76),s=r(2293),a=r(6126),u=r(8975),c=r(3720),l=r(7968),d=r(7903),f=r(6577),h=r(2908),p=r(5964),y=r(2947),g=r(4878),b=r(6315),v=(0,y.L)((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function m(e){throw new v(e)}var w=r(3288),_=r(6847),S=r(1160),k=r(2467),x=r(9697),O=r(8483),T=r(6412),A=r(5360),E=r(8528),C=r(2316),R=r(9099);function P(e){let t;return(0,C.v)((()=>(t=e(),t))).pipe((0,R.M)({unsubscribe:()=>t.cancel()}))}var j=r(964),I=r(5825),M=r(1591),D=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},N=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let B=class{transactionApiService=j.US;clientService=T.m.get(I.N);boosterRatingService=T.m.get(M.b);transactionClient(e,t,r){return this.clientService.enabledUuid$.pipe((0,a.p)(Boolean),(0,u.s)(1),(0,c.n)((i=>this.init(i,e,t).pipe((0,c.n)((e=>(0,l.H)(r()).pipe((0,c.n)((()=>this.confirm(i,e.uuid,t))),function(e,t){var r=(0,f.v)(e)?{first:e}:"number"==typeof e?{each:e}:e,n=r.first,i=r.each,o=r.with,s=void 0===o?m:o,a=r.scheduler,u=void 0===a?null!=t?t:d.E:a,c=r.meta,l=void 0===c?null:c;if(null==n&&null==i)throw new TypeError("No timeout provided.");return(0,h.N)((function(e,t){var r,o,a=null,c=0,d=function(e){o=(0,b.N)(t,u,(function(){try{r.unsubscribe(),(0,p.Tg)(s({meta:l,lastValue:a,seen:c})).subscribe(t)}catch(e){t.error(e)}}),e)};r=e.subscribe((0,g._)(t,(function(e){null==o||o.unsubscribe(),c++,t.next(a=e),i>0&&d(i)}),void 0,void 0,(function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null}))),!c&&d(null!=n?"number"==typeof n?n:+n-u.now():i)}))}({each:20*n.Lf.Second,with:()=>(0,w.$)((()=>"Превышено время ожидания установки плюса"))}),(0,_.W)((t=>this.error(i,e.uuid,(0,E.M)(t)).pipe((0,S.T)((()=>!1)))))))),(0,_.W)((e=>(0,k.of)(!1)))))))}init(e,t,r,n=5){return this.tryInit(e,t,r).pipe((0,c.n)((i=>{if("uuid"in i)return(0,k.of)(i);if(!n)return(0,w.$)((()=>"Исчерпан лимит попыток"));const a=(0,o.A)(i.outDate),u=(0,s.A)(a);return console.log(`Ожидаем завершения другой транзакции (${u})`),(0,x.O)(a).pipe((0,c.n)((()=>this.init(e,t,r,n-1))))})))}tryInit(e,t,r){return this.boosterRatingService.getRealStoryRating(r).pipe((0,c.n)((n=>this.initTransaction(t,r,n,e))))}initTransaction(e,t,r,n){return P((()=>this.transactionApiService.boosterTransactionControllerInit(e,t,r,n)))}confirm(e,t,r){return this.boosterRatingService.getRealStoryRating(r).pipe((0,c.n)((r=>this.confirmTransaction(t,r,e).pipe((0,S.T)((()=>!0)),(0,_.W)((()=>(0,k.of)(!1)))))))}confirmTransaction(e,t,r){return P((()=>this.transactionApiService.boosterTransactionControllerConfirm(e,t,r)))}error(e,t,r){return P((()=>this.transactionApiService.boosterTransactionControllerError(t,{errorText:r},e)))}};D([(0,i.mM)("BoosterTransactionService.init"),N("design:type",Function),N("design:paramtypes",[String,String,Number,Object]),N("design:returntype",O.c)],B.prototype,"init",null),D([(0,i.mM)("BoosterTransactionService.tryInit"),N("design:type",Function),N("design:paramtypes",[String,String,Number]),N("design:returntype",O.c)],B.prototype,"tryInit",null),D([(0,i.mM)("BoosterTransactionService.initTransaction"),N("design:type",Function),N("design:paramtypes",[String,Number,Object,String]),N("design:returntype",O.c)],B.prototype,"initTransaction",null),D([(0,i.mM)("BoosterTransactionService.confirm"),N("design:type",Function),N("design:paramtypes",[String,String,Number]),N("design:returntype",O.c)],B.prototype,"confirm",null),D([(0,i.mM)("BoosterTransactionService.confirmTransaction"),N("design:type",Function),N("design:paramtypes",[String,Object,String]),N("design:returntype",O.c)],B.prototype,"confirmTransaction",null),D([(0,i.mM)("BoosterTransactionService.error"),N("design:type",Function),N("design:paramtypes",[String,String,String]),N("design:returntype",O.c)],B.prototype,"error",null),B=D([(0,A.k)()],B)},8481:(e,t,r)=>{"use strict";r.d(t,{G:()=>n});class n extends Error{}},9994:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var n=r(3732);function i(e){return(0,n.u4)(e)&&!!e.adultError}},6789:(e,t,r)=>{"use strict";r.d(t,{L:()=>v});var n=r(5419),i=r(3732),o=r(4938),s=r(5140),a=r(8825),u=r(1160),c=r(6412),l=r(5360),d=r(6683),f=r(4031),h=r(3134),p=r(8481),y=r(9994),g=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let v=class{pikabuMobileAuthApiService=c.m.get(f.o);useAuth$=this.pikabuMobileAuthApiService.useAuth$;errorReason$=this.useAuth$.pipe((0,u.T)((e=>e?"Для доступа к данным постов с NSFW необходимо подтвердить возраст и включить опцию 18+":`Для доступа к данным постов с NSFW необходимо авторизоваться в мобильном API. Подробнее в настройках расширения ${d.u}`)));async getStoryOrFail(e){const t=await this.getStory(e);if(!t)throw new p.G("Не удалось загрузить данные поста");if((0,y.v)(t)){const e=await(0,a._)(this.errorReason$);throw new p.G(`Не удалось загрузить данные поста. ${e}`)}return t}async getStoryCommentOrFail(e,t){const r=await this.getStoryComments(e);if(!r)throw new p.G("Не удалось загрузить комментарии поста");if((0,y.v)(r)){const e=await(0,a._)(this.errorReason$);throw new p.G(`Не удалось загрузить комментарии поста. ${e}`)}const n=r.get(t);if(!n)throw new p.G("Данные комментария не найдены");return n}async getStoryVideoByWebmOrNull(e,t){const r=await this.getStoryVideosMapByWebmOrNull(e),n=r?.get(t);return n??null}async getStoryVideosMapByWebmOrNull(e){const t=await this.getStoryVideosOrNull(e);return t?new Map(t.map((e=>[e.data.webm.url,e.data]))):null}async getStoryVideosOrNull(e){const t=await this.getStory(e);if(!t||(0,y.v)(t))return null;return t.story_data.filter((function(e){return"vf"===e.type}))}async getStory(e){const t=await(0,a._)(this.useAuth$),r=await this.getStoryPage(e,1,t);return(0,y.v)(r)?r:r?.story??null}async getStoryComments(e){const t=await this.getStoryAllPagesBg(e);return(0,y.v)(t)?t:t?.comments?new Map(t?.comments.map((e=>[e.comment_id,e]))):null}async getStoryAllPagesBg(e){const t=await(0,a._)(this.useAuth$),r=await this.getStoryPage(e,1,t);if(!r)return null;if((0,y.v)(r))return r;const n=r.story.comments_count??0,i=Math.ceil(n/100);if(1===i)return r;let o=r.comments;const s=[];for(let r=2;r<=i;r++)s.push(this.getStoryPage(e,r,t));const u=await Promise.all(s);for(const e of u)e&&!(0,y.v)(e)&&(o=o.concat(e.comments));return{story:r.story,comments:o}}async getStoryPage(e,t,r){return this.fetchStoryPageWithoutCache(e,t)}async fetchStoryPageWithoutCache(e,t){try{return await this.pikabuMobileAuthApiService.fetchDataWithAuthIfLogged({controller:"story.get",queries:`_story_id=${e}&_page=${t}`,body:{story_id:e,page:t}})}catch(e){return e instanceof h.T&&(console.log(e),47===e.pikabuErrorCode)?{adultError:!0}:null}}};g([(0,n.l2)(30*i.Lf.Second),b("design:type",Function),b("design:paramtypes",[Number,String]),b("design:returntype",Promise)],v.prototype,"getStoryVideoByWebmOrNull",null),g([(0,n.l2)(30*i.Lf.Second),b("design:type",Function),b("design:paramtypes",[Number]),b("design:returntype",Promise)],v.prototype,"getStoryVideosMapByWebmOrNull",null),g([(0,n.l2)(30*i.Lf.Second),b("design:type",Function),b("design:paramtypes",[Number]),b("design:returntype",Promise)],v.prototype,"getStoryVideosOrNull",null),g([(0,n.l2)(5*i.Lf.Second),(0,s.up)("PikabuStoryApiService.getStory"),b("design:type",Function),b("design:paramtypes",[Number]),b("design:returntype",Promise)],v.prototype,"getStory",null),g([(0,n.l2)(5*i.Lf.Second),(0,s.up)("PikabuStoryApiService.getStoryComments"),b("design:type",Function),b("design:paramtypes",[Number]),b("design:returntype",Promise)],v.prototype,"getStoryComments",null),g([(0,n.l2)(30*i.Lf.Second,o.Jb.Background),b("design:type",Function),b("design:paramtypes",[Number]),b("design:returntype",Promise)],v.prototype,"getStoryAllPagesBg",null),g([(0,n.l2)(30*i.Lf.Second,o.Jb.Background),(0,s.up)("PikabuStoryApiService.getStoryPage"),b("design:type",Function),b("design:paramtypes",[Number,Number,Boolean]),b("design:returntype",Promise)],v.prototype,"getStoryPage",null),g([(0,s.up)("PikabuStoryApiService.fetchStoryPageWithoutCache"),b("design:type",Function),b("design:paramtypes",[Number,Number]),b("design:returntype",Promise)],v.prototype,"fetchStoryPageWithoutCache",null),v=g([(0,l.k)()],v)},964:(e,t,r)=>{"use strict";r.d(t,{FP:()=>g,BN:()=>b,Mi:()=>v,Fd:()=>m,US:()=>w,Ds:()=>s});class n extends Error{url;status;statusText;body;request;constructor(e,t,r){super(r),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}class i extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class o{#e;#t;#r;#n;#i;#o;#s;constructor(e){this.#e=!1,this.#t=!1,this.#r=!1,this.#n=[],this.#i=new Promise(((t,r)=>{this.#o=t,this.#s=r;const n=e=>{this.#e||this.#t||this.#r||this.#n.push(e)};return Object.defineProperty(n,"isResolved",{get:()=>this.#e}),Object.defineProperty(n,"isRejected",{get:()=>this.#t}),Object.defineProperty(n,"isCancelled",{get:()=>this.#r}),e((e=>{this.#e||this.#t||this.#r||(this.#e=!0,this.#o?.(e))}),(e=>{this.#e||this.#t||this.#r||(this.#t=!0,this.#s?.(e))}),n)}))}get[Symbol.toStringTag](){return"Cancellable Promise"}then(e,t){return this.#i.then(e,t)}catch(e){return this.#i.catch(e)}finally(e){return this.#i.finally(e)}cancel(){if(!(this.#e||this.#t||this.#r)){if(this.#r=!0,this.#n.length)try{for(const e of this.#n)e()}catch(e){return void console.warn("Cancellation threw an error",e)}this.#n.length=0,this.#s?.(new i("Request aborted"))}}get isCancelled(){return this.#r}}const s={BASE:"",VERSION:"1.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},a=e=>null!=e,u=e=>"string"==typeof e,c=e=>u(e)&&""!==e,l=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),d=e=>e instanceof FormData,f=e=>{const t=[],r=(e,n)=>{a(n)&&(Array.isArray(n)?n.forEach((t=>{r(e,t)})):"object"==typeof n?Object.entries(n).forEach((([t,n])=>{r(`${e}[${t}]`,n)})):((e,r)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(r))}`)})(e,n))};return Object.entries(e).forEach((([e,t])=>{r(e,t)})),t.length>0?`?${t.join("&")}`:""},h=async(e,t)=>"function"==typeof t?t(e):t,p=async(e,t)=>{const r=await h(t,e.TOKEN),n=await h(t,e.USERNAME),i=await h(t,e.PASSWORD),o=await h(t,e.HEADERS),s=Object.entries({Accept:"application/json",...o,...t.headers}).filter((([e,t])=>a(t))).reduce(((e,[t,r])=>({...e,[t]:String(r)})),{});if(c(r)&&(s.Authorization=`Bearer ${r}`),c(n)&&c(i)){const e=(e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}})(`${n}:${i}`);s.Authorization=`Basic ${e}`}return t.body&&(t.mediaType?s["Content-Type"]=t.mediaType:l(t.body)?s["Content-Type"]=t.body.type||"application/octet-stream":u(t.body)?s["Content-Type"]="text/plain":d(t.body)||(s["Content-Type"]="application/json")),new Headers(s)},y=(e,t)=>new o((async(r,i,o)=>{try{const i=((e,t)=>{const r=e.ENCODE_PATH||encodeURI,n=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,((e,n)=>t.path?.hasOwnProperty(n)?r(String(t.path[n])):e)),i=`${e.BASE}${n}`;return t.query?`${i}${f(t.query)}`:i})(e,t),s=(e=>{if(e.formData){const t=new FormData,r=(e,r)=>{u(r)||l(r)?t.append(e,r):t.append(e,JSON.stringify(r))};return Object.entries(e.formData).filter((([e,t])=>a(t))).forEach((([e,t])=>{Array.isArray(t)?t.forEach((t=>r(e,t))):r(e,t)})),t}})(t),c=(e=>{if(void 0!==e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):u(e.body)||l(e.body)||d(e.body)?e.body:JSON.stringify(e.body)})(t),h=await p(e,t);if(!o.isCancelled){const a=await(async(e,t,r,n,i,o,s)=>{const a=new AbortController,u={headers:o,body:n??i,method:t.method,signal:a.signal};return e.WITH_CREDENTIALS&&(u.credentials=e.CREDENTIALS),s((()=>a.abort())),await fetch(r,u)})(e,t,i,c,s,h,o),l=await(async e=>{if(204!==e.status)try{const t=e.headers.get("Content-Type");if(t)return["application/json","application/problem+json"].some((e=>t.toLowerCase().startsWith(e)))?await e.json():await e.text()}catch(e){console.error(e)}})(a),d=((e,t)=>{if(t){const r=e.headers.get(t);if(u(r))return r}})(a,t.responseHeader),f={url:i,ok:a.ok,status:a.status,statusText:a.statusText,body:d??l};((e,t)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(r)throw new n(e,t,r);if(!t.ok){const r=t.status??"unknown",i=t.statusText??"unknown",o=(()=>{try{return JSON.stringify(t.body,null,2)}catch(e){return}})();throw new n(e,t,`Generic Error: status: ${r}; status text: ${i}; body: ${o}`)}})(t,f),r(f.body)}}catch(e){i(e)}}));class g{static boosterCandidateControllerGetCandidates(e){return y(s,{method:"GET",url:"/api/booster-candidate",headers:{"X-Pf-Client-Uuid":e}})}}class b{static boosterClientControllerRegisterClient(e){return y(s,{method:"POST",url:"/api/booster-client/register",headers:{"X-Pf-Client-Uuid":e}})}static boosterClientControllerRegisterClientAuto(e,t){return y(s,{method:"POST",url:"/api/booster-client/register-auto",headers:{"X-Pf-Client-Uuid":t},query:{uuid:e}})}static boosterClientControllerGetStatus(e){return y(s,{method:"GET",url:"/api/booster-client/status",headers:{"X-Pf-Client-Uuid":e}})}}class v{static boosterOrderControllerGetOrders(e){return y(s,{method:"GET",url:"/api/booster-order",headers:{"X-Pf-Client-Uuid":e}})}static boosterOrderControllerCreateOrder(e,t){return y(s,{method:"POST",url:"/api/booster-order",headers:{"X-Pf-Client-Uuid":t},body:e,mediaType:"application/json"})}static boosterOrderControllerGetOrder(e,t){return y(s,{method:"GET",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":t}})}static boosterOrderControllerUpdateOrder(e,t,r){return y(s,{method:"PUT",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}static boosterOrderControllerDeleteOrder(e,t){return y(s,{method:"DELETE",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":t}})}static boosterOrderControllerDeleteObsolete(e){return y(s,{method:"DELETE",url:"/api/booster-order/obsolete",headers:{"X-Pf-Client-Uuid":e}})}static boosterOrderConditionsControllerGetOrderConditions(e){return y(s,{method:"GET",url:"/api/booster-order-conditions",headers:{"X-Pf-Client-Uuid":e}})}}class m{static boosterPointsTransactionControllerGetHistory(e){return y(s,{method:"GET",url:"/api/booster-points-transaction/history",headers:{"X-Pf-Client-Uuid":e}})}}class w{static boosterTransactionControllerInit(e,t,r,n){return y(s,{method:"POST",url:"/api/booster-transaction/{orderUuid}/{storyId}",path:{orderUuid:e,storyId:t},headers:{"X-Pf-Client-Uuid":n},body:r,mediaType:"application/json"})}static boosterTransactionControllerConfirm(e,t,r){return y(s,{method:"PUT",url:"/api/booster-transaction/{transactionUuid}/confirm",path:{transactionUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}static boosterTransactionControllerError(e,t,r){return y(s,{method:"PUT",url:"/api/booster-transaction/{transactionUuid}/error",path:{transactionUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}}},4031:(e,t,r)=>{"use strict";r.d(t,{o:()=>p});var n=r(5140),i=r(1160),o=r(8825),s=r(2922),a=r(6412),u=r(5360),c=r(4982),l=r(3134),d=r(746),f=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class{settingsService=a.m.get(c.h);mobileApiAuth$=this.settingsService.getKey$("mobileApiAuth");mobileApiUserId$=this.settingsService.getKey$("mobileApiUserId");pikabuMobileApiService=a.m.get(d.e);useAuth$=(0,s.z)([this.mobileApiAuth$,this.mobileApiUserId$]).pipe((0,i.T)((([e,t])=>e&&!!t)));async fetchDataWithAuthIfLogged(e){const t=await(0,o._)(this.mobileApiAuth$),r=await(0,o._)(this.mobileApiUserId$);if(!t||!r)return this.pikabuMobileApiService.fetchData(e);try{return await this.pikabuMobileApiService.fetchData({...e,body:{...e.body,user_id:r}})}catch(e){throw e instanceof l.T&&401===e.pikabuErrorCode&&(console.log("pikabuErrorCode === 401"),await this.logout()),e}}async auth(e){console.log("auth");const t=await this.pikabuMobileApiService.fetchData({controller:"user.auth",body:e}),r=Number(t.user_id);return console.log(t),await this.settingsService.patch({mobileApiUserId:r,mobileApiUserName:t.user_name}),t}async logout(){console.log("logout"),await this.settingsService.patch({mobileApiUserId:null,mobileApiUserName:null})}async fetchSettings(e){return this.pikabuMobileApiService.fetchData({controller:"settings.get",body:{user_id:`${e}`}})}async putSettings(e){return this.pikabuMobileApiService.fetchData({controller:"settings.set",body:e})}};f([(0,n.up)("PikabuMobileAuthApiService.fetchDataWithAuthIfLogged"),h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",Promise)],p.prototype,"fetchDataWithAuthIfLogged",null),f([(0,n.up)("PikabuMobileAuthApiService.auth"),h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",Promise)],p.prototype,"auth",null),f([(0,n.up)("PikabuMobileAuthApiService.logout"),h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",Promise)],p.prototype,"logout",null),f([(0,n.up)("PikabuMobileAuthApiService.fetchSettings"),h("design:type",Function),h("design:paramtypes",[String]),h("design:returntype",Promise)],p.prototype,"fetchSettings",null),f([(0,n.up)("PikabuMobileAuthApiService.putSettings"),h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",Promise)],p.prototype,"putSettings",null),p=f([(0,u.k)()],p)},3134:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});class n extends Error{pikabuErrorCode;constructor(e,t){super(e),this.pikabuErrorCode=t}static fromResponseError(e){return new n(`${e.error?.message}`,e.error?.message_code)}static fromHttpError(e){return new n(`Запрос к серверу завершился ошибкой (${e})`)}}},746:(e,t,r)=>{"use strict";r.d(t,{e:()=>d});var n=r(6891),i=r(8825);class o{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=o.hexChars,r=o.hexOut;let n,i,s,a;for(a=0;a<4;a+=1)for(i=8*a,n=e[a],s=0;s<8;s+=2)r[i+1+s]=t.charAt(15&n),n>>>=4,r[i+0+s]=t.charAt(15&n),n>>>=4;return r.join("")}static _md5cycle(e,t){let r=e[0],n=e[1],i=e[2],o=e[3];r+=(n&i|~n&o)+t[0]-680876936|0,r=(r<<7|r>>>25)+n|0,o+=(r&n|~r&i)+t[1]-389564586|0,o=(o<<12|o>>>20)+r|0,i+=(o&r|~o&n)+t[2]+606105819|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&r)+t[3]-1044525330|0,n=(n<<22|n>>>10)+i|0,r+=(n&i|~n&o)+t[4]-176418897|0,r=(r<<7|r>>>25)+n|0,o+=(r&n|~r&i)+t[5]+1200080426|0,o=(o<<12|o>>>20)+r|0,i+=(o&r|~o&n)+t[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&r)+t[7]-45705983|0,n=(n<<22|n>>>10)+i|0,r+=(n&i|~n&o)+t[8]+1770035416|0,r=(r<<7|r>>>25)+n|0,o+=(r&n|~r&i)+t[9]-1958414417|0,o=(o<<12|o>>>20)+r|0,i+=(o&r|~o&n)+t[10]-42063|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&r)+t[11]-1990404162|0,n=(n<<22|n>>>10)+i|0,r+=(n&i|~n&o)+t[12]+1804603682|0,r=(r<<7|r>>>25)+n|0,o+=(r&n|~r&i)+t[13]-40341101|0,o=(o<<12|o>>>20)+r|0,i+=(o&r|~o&n)+t[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,n+=(i&o|~i&r)+t[15]+1236535329|0,n=(n<<22|n>>>10)+i|0,r+=(n&o|i&~o)+t[1]-165796510|0,r=(r<<5|r>>>27)+n|0,o+=(r&i|n&~i)+t[6]-1069501632|0,o=(o<<9|o>>>23)+r|0,i+=(o&n|r&~n)+t[11]+643717713|0,i=(i<<14|i>>>18)+o|0,n+=(i&r|o&~r)+t[0]-373897302|0,n=(n<<20|n>>>12)+i|0,r+=(n&o|i&~o)+t[5]-701558691|0,r=(r<<5|r>>>27)+n|0,o+=(r&i|n&~i)+t[10]+38016083|0,o=(o<<9|o>>>23)+r|0,i+=(o&n|r&~n)+t[15]-660478335|0,i=(i<<14|i>>>18)+o|0,n+=(i&r|o&~r)+t[4]-405537848|0,n=(n<<20|n>>>12)+i|0,r+=(n&o|i&~o)+t[9]+568446438|0,r=(r<<5|r>>>27)+n|0,o+=(r&i|n&~i)+t[14]-1019803690|0,o=(o<<9|o>>>23)+r|0,i+=(o&n|r&~n)+t[3]-187363961|0,i=(i<<14|i>>>18)+o|0,n+=(i&r|o&~r)+t[8]+1163531501|0,n=(n<<20|n>>>12)+i|0,r+=(n&o|i&~o)+t[13]-1444681467|0,r=(r<<5|r>>>27)+n|0,o+=(r&i|n&~i)+t[2]-51403784|0,o=(o<<9|o>>>23)+r|0,i+=(o&n|r&~n)+t[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,n+=(i&r|o&~r)+t[12]-1926607734|0,n=(n<<20|n>>>12)+i|0,r+=(n^i^o)+t[5]-378558|0,r=(r<<4|r>>>28)+n|0,o+=(r^n^i)+t[8]-2022574463|0,o=(o<<11|o>>>21)+r|0,i+=(o^r^n)+t[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^r)+t[14]-35309556|0,n=(n<<23|n>>>9)+i|0,r+=(n^i^o)+t[1]-1530992060|0,r=(r<<4|r>>>28)+n|0,o+=(r^n^i)+t[4]+1272893353|0,o=(o<<11|o>>>21)+r|0,i+=(o^r^n)+t[7]-155497632|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^r)+t[10]-1094730640|0,n=(n<<23|n>>>9)+i|0,r+=(n^i^o)+t[13]+681279174|0,r=(r<<4|r>>>28)+n|0,o+=(r^n^i)+t[0]-358537222|0,o=(o<<11|o>>>21)+r|0,i+=(o^r^n)+t[3]-722521979|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^r)+t[6]+76029189|0,n=(n<<23|n>>>9)+i|0,r+=(n^i^o)+t[9]-640364487|0,r=(r<<4|r>>>28)+n|0,o+=(r^n^i)+t[12]-421815835|0,o=(o<<11|o>>>21)+r|0,i+=(o^r^n)+t[15]+530742520|0,i=(i<<16|i>>>16)+o|0,n+=(i^o^r)+t[2]-995338651|0,n=(n<<23|n>>>9)+i|0,r+=(i^(n|~o))+t[0]-198630844|0,r=(r<<6|r>>>26)+n|0,o+=(n^(r|~i))+t[7]+1126891415|0,o=(o<<10|o>>>22)+r|0,i+=(r^(o|~n))+t[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~r))+t[5]-57434055|0,n=(n<<21|n>>>11)+i|0,r+=(i^(n|~o))+t[12]+1700485571|0,r=(r<<6|r>>>26)+n|0,o+=(n^(r|~i))+t[3]-1894986606|0,o=(o<<10|o>>>22)+r|0,i+=(r^(o|~n))+t[10]-1051523|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~r))+t[1]-2054922799|0,n=(n<<21|n>>>11)+i|0,r+=(i^(n|~o))+t[8]+1873313359|0,r=(r<<6|r>>>26)+n|0,o+=(n^(r|~i))+t[15]-30611744|0,o=(o<<10|o>>>22)+r|0,i+=(r^(o|~n))+t[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~r))+t[13]+1309151649|0,n=(n<<21|n>>>11)+i|0,r+=(i^(n|~o))+t[4]-145523070|0,r=(r<<6|r>>>26)+n|0,o+=(n^(r|~i))+t[11]-1120210379|0,o=(o<<10|o>>>22)+r|0,i+=(r^(o|~n))+t[2]+718787259|0,i=(i<<15|i>>>17)+o|0,n+=(o^(i|~r))+t[9]-343485551|0,n=(n<<21|n>>>11)+i|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(o.stateIdentity),this}appendStr(e){const t=this._buffer8,r=this._buffer32;let n,i,s=this._bufferLength;for(i=0;i<e.length;i+=1){if(n=e.charCodeAt(i),n<128)t[s++]=n;else if(n<2048)t[s++]=192+(n>>>6),t[s++]=63&n|128;else if(n<55296||n>56319)t[s++]=224+(n>>>12),t[s++]=n>>>6&63|128,t[s++]=63&n|128;else{if(n=1024*(n-55296)+(e.charCodeAt(++i)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[s++]=240+(n>>>18),t[s++]=n>>>12&63|128,t[s++]=n>>>6&63|128,t[s++]=63&n|128}s>=64&&(this._dataLength+=64,o._md5cycle(this._state,r),s-=64,r[0]=r[16])}return this._bufferLength=s,this}appendAsciiStr(e){const t=this._buffer8,r=this._buffer32;let n,i=this._bufferLength,s=0;for(;;){for(n=Math.min(e.length-s,64-i);n--;)t[i++]=e.charCodeAt(s++);if(i<64)break;this._dataLength+=64,o._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}appendByteArray(e){const t=this._buffer8,r=this._buffer32;let n,i=this._bufferLength,s=0;for(;;){for(n=Math.min(e.length-s,64-i);n--;)t[i++]=e[s++];if(i<64)break;this._dataLength+=64,o._md5cycle(this._state,r),i=0}return this._bufferLength=i,this}getState(){const e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){const t=e.buffer,r=e.state,n=this._state;let i;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],i=0;i<t.length;i+=1)this._buffer8[i]=t.charCodeAt(i)}end(e=!1){const t=this._bufferLength,r=this._buffer8,n=this._buffer32,i=1+(t>>2);this._dataLength+=t;const s=8*this._dataLength;if(r[t]=128,r[t+1]=r[t+2]=r[t+3]=0,n.set(o.buffer32Identity.subarray(i),i),t>55&&(o._md5cycle(this._state,n),n.set(o.buffer32Identity)),s<=4294967295)n[14]=s;else{const e=s.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;const t=parseInt(e[2],16),r=parseInt(e[1],16)||0;n[14]=t,n[15]=r}return o._md5cycle(this._state,n),e?this._state:o._hex(this._state)}}if(o.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),o.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o.hexChars="0123456789abcdef",o.hexOut=[],o.onePassHasher=new o,"5d41402abc4b2a76b9719d911017c592"!==o.hashStr("hello"))throw new Error("Md5 self test failed.");var s=r(6412),a=r(5360),u=r(3134),c=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};const l="kmq4!2cPl)peZ";let d=class{httpService=s.m.get(n.k);async fetchData(e){const t=Date.now(),r={new_sort:1,...e.body},o=this.getHash({...e,body:r},t),s={...r,id:"iws",hash:o,token:t},a=e.queries?`?${e.queries}`:"";try{const t=await(0,i._)(this.httpService.postJson(`https://api.pikabu.ru/v1/${e.controller}${a}`,s,{mode:"same-origin"}));return t.error?Promise.reject(u.T.fromResponseError(t)):t.response}catch(e){return e instanceof n.j?Promise.reject(u.T.fromHttpError(e)):Promise.reject(e)}}getHash(e,t){const r=Object.values(e.body).sort().join(","),n=[l,e.controller,t,r].join(","),i=o.hashStr(n);return btoa(i)}};d=c([(0,a.k)()],d)},4982:(e,t,r)=>{"use strict";r.d(t,{h:()=>m});var n=r(3732),i=r(5140),o=r(5966),s=r(8825),a=r(6126),u=r(1900),c=r(8483),l=r(9099),d=r(5360),f=r(5279),h=r(2320);const p={version:31,addForeverIgnore:!0,showStoryVotes:!0,showUserRegistrationDateIndicator:!0,showCommentVotes:!0,showUserSummary:!0,showVideoLinks:!0,hideShortStoryDesign:!1,hideDonateButton:!1,boosterFirstInitialized:!1,booster:!1,boosterUuid:null,boosterOrderMinutes:30,boosterOrderPoints:10,changeReferralLinks:!0,sendStatistic:!0,requireOnboardingForExtensionMenuButton:!0,showCommentsExpanderButton:!0,expandCommentsAuto:!1,highlightVotedComments:!0,userNotesTool:!0,mobileApiAuth:!1,mobileApiUserId:null,mobileApiUserName:null};var y,g=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const v="pikabu-fixes.settings";let m=class{storageService;settings$=(0,o.n3)((()=>this.getSettingsWithCreate()));constructor(e){this.storageService=e}getKey$(e){return this.settings$.pipe((0,o.um)(e))}async get(){return(0,s._)(this.settings$)}async set(e){await this.storageService.set(v,e)}async patch(e){const t=await this.get(),r={...t,...e};(0,n.XR)(t,r)||await this.set(r)}async setKey(e,t){let r=await this.get();t!==r[e]&&(r={...r,[e]:t},await this.set(r))}getSettingsWithCreate(){return this.storageService.listen(v).pipe((0,l.M)((e=>this.checkSettings(e))),(0,a.p)(n.vM),(0,u.F)(n.XR))}async checkSettings(e){(!e||!e.version||e.version<p.version)&&(e={...p,...e,version:p.version,uuid:e?.uuid??(0,f.A)()},await this.set(e))}};g([(0,i.up)("SettingsService.set"),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",Promise)],m.prototype,"set",null),g([(0,i.up)("SettingsService.patch"),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",Promise)],m.prototype,"patch",null),g([(0,i.up)("SettingsService.setKey"),b("design:type",Function),b("design:paramtypes",["function"==typeof(y="undefined"!=typeof K&&K)?y:Object,Object]),b("design:returntype",Promise)],m.prototype,"setKey",null),g([(0,i.mM)("SettingsService.getSettingsWithCreate"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",c.c)],m.prototype,"getSettingsWithCreate",null),m=g([(0,d.k)(),b("design:paramtypes",[h.n])],m)},5388:(e,t,r)=>{"use strict";r.d(t,{b:()=>Br});var n=r(3732),i=r(5140),o=r(6891);function s(e){let t=e.length;for(;--t>=0;)e[t]=0}const a=256,u=286,c=30,l=15,d=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),f=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),h=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),p=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),y=new Array(576);s(y);const g=new Array(60);s(g);const b=new Array(512);s(b);const v=new Array(256);s(v);const m=new Array(29);s(m);const w=new Array(c);function _(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let S,k,x;function O(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}s(w);const T=e=>e<256?b[e]:b[256+(e>>>7)],A=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},E=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,A(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},C=(e,t,r)=>{E(e,r[2*t],r[2*t+1])},R=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},P=(e,t,r)=>{const n=new Array(16);let i,o,s=0;for(i=1;i<=l;i++)s=s+r[i-1]<<1,n[i]=s;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=R(n[t]++,t))}},j=e=>{let t;for(t=0;t<u;t++)e.dyn_ltree[2*t]=0;for(t=0;t<c;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},I=e=>{e.bi_valid>8?A(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},M=(e,t,r,n)=>{const i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]},D=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&M(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!M(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},N=(e,t,r)=>{let n,i,o,s,u=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+u++],n+=(255&e.pending_buf[e.sym_buf+u++])<<8,i=e.pending_buf[e.sym_buf+u++],0===n?C(e,i,t):(o=v[i],C(e,o+a+1,t),s=d[o],0!==s&&(i-=m[o],E(e,i,s)),n--,o=T(n),C(e,o,r),s=f[o],0!==s&&(n-=w[o],E(e,n,s)))}while(u<e.sym_next);C(e,256,t)},B=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,u,c=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==r[2*s]?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):r[2*s+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,r[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=n[2*u+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)D(e,r,s);u=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,r,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,r[2*u]=r[2*s]+r[2*a],e.depth[u]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,r[2*s+1]=r[2*a+1]=u,e.heap[1]=u++,D(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,d,f,h,p,y,g=0;for(h=0;h<=l;h++)e.bl_count[h]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=r[2*r[2*d+1]+1]+1,h>u&&(h=u,g++),r[2*d+1]=h,d>n||(e.bl_count[h]++,p=0,d>=a&&(p=s[d-a]),y=r[2*d],e.opt_len+=y*(h+p),o&&(e.static_len+=y*(i[2*d+1]+p)));if(0!==g){do{for(h=u-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,g-=2}while(g>0);for(h=u;0!==h;h--)for(d=e.bl_count[h];0!==d;)f=e.heap[--c],f>n||(r[2*f+1]!==h&&(e.opt_len+=(h-r[2*f+1])*r[2*f],r[2*f+1]=h),d--)}})(e,t),P(r,c,e.bl_count)},U=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<u&&i===s||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=i,0===s?(u=138,c=3):i===s?(u=6,c=3):(u=7,c=4))},F=(e,t,r)=>{let n,i,o=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<u&&i===s)){if(a<c)do{C(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(C(e,i,e.bl_tree),a--),C(e,16,e.bl_tree),E(e,a-3,2)):a<=10?(C(e,17,e.bl_tree),E(e,a-3,3)):(C(e,18,e.bl_tree),E(e,a-11,7));a=0,o=i,0===s?(u=138,c=3):i===s?(u=6,c=3):(u=7,c=4)}};let z=!1;const L=(e,t,r,n)=>{E(e,0+(n?1:0),3),I(e),A(e,r),A(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var q=(e,t,r,n)=>{let i,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),B(e,e.l_desc),B(e,e.d_desc),s=(e=>{let t;for(U(e,e.dyn_ltree,e.l_desc.max_code),U(e,e.dyn_dtree,e.d_desc.max_code),B(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*p[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?L(e,t,r,n):4===e.strategy||o===i?(E(e,2+(n?1:0),3),N(e,y,g)):(E(e,4+(n?1:0),3),((e,t,r,n)=>{let i;for(E(e,t-257,5),E(e,r-1,5),E(e,n-4,4),i=0;i<n;i++)E(e,e.bl_tree[2*p[i]+1],3);F(e,e.dyn_ltree,t-1),F(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),N(e,e.dyn_ltree,e.dyn_dtree)),j(e),n&&I(e)},$={_tr_init:e=>{z||((()=>{let e,t,r,n,i;const o=new Array(16);for(r=0,n=0;n<28;n++)for(m[n]=r,e=0;e<1<<d[n];e++)v[r++]=n;for(v[r-1]=n,i=0,n=0;n<16;n++)for(w[n]=i,e=0;e<1<<f[n];e++)b[i++]=n;for(i>>=7;n<c;n++)for(w[n]=i<<7,e=0;e<1<<f[n]-7;e++)b[256+i++]=n;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)y[2*e+1]=8,e++,o[8]++;for(;e<=255;)y[2*e+1]=9,e++,o[9]++;for(;e<=279;)y[2*e+1]=7,e++,o[7]++;for(;e<=287;)y[2*e+1]=8,e++,o[8]++;for(P(y,287,o),e=0;e<c;e++)g[2*e+1]=5,g[2*e]=R(e,5);S=new _(y,d,257,u,l),k=new _(g,f,0,c,l),x=new _(new Array(0),h,0,19,7)})(),z=!0),e.l_desc=new O(e.dyn_ltree,S),e.d_desc=new O(e.dyn_dtree,k),e.bl_desc=new O(e.bl_tree,x),e.bi_buf=0,e.bi_valid=0,j(e)},_tr_stored_block:L,_tr_flush_block:q,_tr_tally:(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(v[r]+a+1)]++,e.dyn_dtree[2*T(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{E(e,2,3),C(e,256,y),(e=>{16===e.bi_valid?(A(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var W=(e,t,r,n)=>{let i=65535&e,o=e>>>16&65535,s=0;for(;0!==r;){s=r>2e3?2e3:r,r-=s;do{i=i+t[n++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16};const Q=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var V=(e,t,r,n)=>{const i=Q,o=n+r;e^=-1;for(let r=n;r<o;r++)e=e>>>8^i[255&(e^t[r])];return~e},Z={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:K,_tr_stored_block:J,_tr_flush_block:G,_tr_tally:X,_tr_align:Y}=$,{Z_NO_FLUSH:ee,Z_PARTIAL_FLUSH:te,Z_FULL_FLUSH:re,Z_FINISH:ne,Z_BLOCK:ie,Z_OK:oe,Z_STREAM_END:se,Z_STREAM_ERROR:ae,Z_DATA_ERROR:ue,Z_BUF_ERROR:ce,Z_DEFAULT_COMPRESSION:le,Z_FILTERED:de,Z_HUFFMAN_ONLY:fe,Z_RLE:he,Z_FIXED:pe,Z_DEFAULT_STRATEGY:ye,Z_UNKNOWN:ge,Z_DEFLATED:be}=H,ve=258,me=262,we=42,_e=113,Se=666,ke=(e,t)=>(e.msg=Z[t],t),xe=e=>2*e-(e>4?9:0),Oe=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Te=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do{r=e.head[--n],e.head[n]=r>=i?r-i:0}while(--t);t=i,n=t;do{r=e.prev[--n],e.prev[n]=r>=i?r-i:0}while(--t)};let Ae=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const Ee=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},Ce=(e,t)=>{G(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ee(e.strm)},Re=(e,t)=>{e.pending_buf[e.pending++]=t},Pe=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},je=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),1===e.state.wrap?e.adler=W(e.adler,t,i,r):2===e.state.wrap&&(e.adler=V(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},Ie=(e,t)=>{let r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const u=e.strstart>e.w_size-me?e.strstart-(e.w_size-me):0,c=e.window,l=e.w_mask,d=e.prev,f=e.strstart+ve;let h=c[o+s-1],p=c[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(r=t,c[r+s]===p&&c[r+s-1]===h&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<f);if(n=ve-(f-o),o=f-ve,n>s){if(e.match_start=t,s=n,n>=a)break;h=c[o+s-1],p=c[o+s]}}}while((t=d[t&l])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead},Me=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-me)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Te(e),n+=t),0===e.strm.avail_in)break;if(r=je(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=Ae(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=Ae(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<me&&0!==e.strm.avail_in)},De=(e,t)=>{let r,n,i,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(r=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,n=e.strstart-e.block_start,r>n+e.strm.avail_in&&(r=n+e.strm.avail_in),r>i&&(r=i),r<o&&(0===r&&t!==ne||t===ee||r!==n+e.strm.avail_in))break;s=t===ne&&r===n+e.strm.avail_in?1:0,J(e,0,0,s),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,Ee(e.strm),n&&(n>r&&(n=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,r-=n),r&&(je(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==ee&&t!==ne&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(je(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,o=i>e.w_size?e.w_size:i,n=e.strstart-e.block_start,(n>=o||(n||t===ne)&&t!==ee&&0===e.strm.avail_in&&n<=i)&&(r=n>i?i:n,s=t===ne&&0===e.strm.avail_in&&r===n?1:0,J(e,e.block_start,r,s),e.block_start+=r,Ee(e.strm)),s?3:1)},Ne=(e,t)=>{let r,n;for(;;){if(e.lookahead<me){if(Me(e),e.lookahead<me&&t===ee)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Ae(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-me&&(e.match_length=Ie(e,r)),e.match_length>=3)if(n=X(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Ae(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Ae(e,e.ins_h,e.window[e.strstart+1]);else n=X(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ne?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2},Be=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<me){if(Me(e),e.lookahead<me&&t===ee)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Ae(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-me&&(e.match_length=Ie(e,r),e.match_length<=5&&(e.strategy===de||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=X(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=Ae(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(Ce(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=X(e,0,e.window[e.strstart-1]),n&&Ce(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=X(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ne?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2};function Ue(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const Fe=[new Ue(0,0,0,0,De),new Ue(4,4,8,4,Ne),new Ue(4,5,16,8,Ne),new Ue(4,6,32,32,Ne),new Ue(4,4,16,16,Be),new Ue(8,16,32,32,Be),new Ue(8,16,128,128,Be),new Ue(8,32,128,256,Be),new Ue(32,128,258,1024,Be),new Ue(32,258,258,4096,Be)];function ze(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=be,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Oe(this.dyn_ltree),Oe(this.dyn_dtree),Oe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Oe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Oe(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Le=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==we&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==_e&&t.status!==Se?1:0},qe=e=>{if(Le(e))return ke(e,ae);e.total_in=e.total_out=0,e.data_type=ge;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?we:_e,e.adler=2===t.wrap?0:1,t.last_flush=-2,K(t),oe},$e=e=>{const t=qe(e);return t===oe&&(e=>{e.window_size=2*e.w_size,Oe(e.head),e.max_lazy_match=Fe[e.level].max_lazy,e.good_match=Fe[e.level].good_length,e.nice_match=Fe[e.level].nice_length,e.max_chain_length=Fe[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},We=(e,t,r,n,i,o)=>{if(!e)return ae;let s=1;if(t===le&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==be||n<8||n>15||t<0||t>9||o<0||o>pe||8===n&&1!==s)return ke(e,ae);8===n&&(n=9);const a=new ze;return e.state=a,a.strm=e,a.status=we,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=r,$e(e)};var Qe={deflateInit:(e,t)=>We(e,t,be,15,8,ye),deflateInit2:We,deflateReset:$e,deflateResetKeep:qe,deflateSetHeader:(e,t)=>Le(e)||2!==e.state.wrap?ae:(e.state.gzhead=t,oe),deflate:(e,t)=>{if(Le(e)||t>ie||t<0)return e?ke(e,ae):ae;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===Se&&t!==ne)return ke(e,0===e.avail_out?ce:ae);const n=r.last_flush;if(r.last_flush=t,0!==r.pending){if(Ee(e),0===e.avail_out)return r.last_flush=-1,oe}else if(0===e.avail_in&&xe(t)<=xe(n)&&t!==ne)return ke(e,ce);if(r.status===Se&&0!==e.avail_in)return ke(e,ce);if(r.status===we&&0===r.wrap&&(r.status=_e),r.status===we){let t=be+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=fe||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,Pe(r,t),0!==r.strstart&&(Pe(r,e.adler>>>16),Pe(r,65535&e.adler)),e.adler=1,r.status=_e,Ee(e),0!==r.pending)return r.last_flush=-1,oe}if(57===r.status)if(e.adler=0,Re(r,31),Re(r,139),Re(r,8),r.gzhead)Re(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Re(r,255&r.gzhead.time),Re(r,r.gzhead.time>>8&255),Re(r,r.gzhead.time>>16&255),Re(r,r.gzhead.time>>24&255),Re(r,9===r.level?2:r.strategy>=fe||r.level<2?4:0),Re(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Re(r,255&r.gzhead.extra.length),Re(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=V(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Re(r,0),Re(r,0),Re(r,0),Re(r,0),Re(r,0),Re(r,9===r.level?2:r.strategy>=fe||r.level<2?4:0),Re(r,3),r.status=_e,Ee(e),0!==r.pending)return r.last_flush=-1,oe;if(69===r.status){if(r.gzhead.extra){let t=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let i=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=V(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=i,Ee(e),0!==r.pending)return r.last_flush=-1,oe;t=0,n-=i}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>t&&(e.adler=V(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=V(e.adler,r.pending_buf,r.pending-n,n)),Ee(e),0!==r.pending)return r.last_flush=-1,oe;n=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Re(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=V(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=V(e.adler,r.pending_buf,r.pending-n,n)),Ee(e),0!==r.pending)return r.last_flush=-1,oe;n=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Re(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>n&&(e.adler=V(e.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ee(e),0!==r.pending))return r.last_flush=-1,oe;Re(r,255&e.adler),Re(r,e.adler>>8&255),e.adler=0}if(r.status=_e,Ee(e),0!==r.pending)return r.last_flush=-1,oe}if(0!==e.avail_in||0!==r.lookahead||t!==ee&&r.status!==Se){let n=0===r.level?De(r,t):r.strategy===fe?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(Me(e),0===e.lookahead)){if(t===ee)return 1;break}if(e.match_length=0,r=X(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ne?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===he?((e,t)=>{let r,n,i,o;const s=e.window;for(;;){if(e.lookahead<=ve){if(Me(e),e.lookahead<=ve&&t===ee)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=e.strstart+ve;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=ve-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=X(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=X(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Ce(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ne?(Ce(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ce(e,!1),0===e.strm.avail_out)?1:2})(r,t):Fe[r.level].func(r,t);if(3!==n&&4!==n||(r.status=Se),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),oe;if(2===n&&(t===te?Y(r):t!==ie&&(J(r,0,0,!1),t===re&&(Oe(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ee(e),0===e.avail_out))return r.last_flush=-1,oe}return t!==ne?oe:r.wrap<=0?se:(2===r.wrap?(Re(r,255&e.adler),Re(r,e.adler>>8&255),Re(r,e.adler>>16&255),Re(r,e.adler>>24&255),Re(r,255&e.total_in),Re(r,e.total_in>>8&255),Re(r,e.total_in>>16&255),Re(r,e.total_in>>24&255)):(Pe(r,e.adler>>>16),Pe(r,65535&e.adler)),Ee(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?oe:se)},deflateEnd:e=>{if(Le(e))return ae;const t=e.state.status;return e.state=null,t===_e?ke(e,ue):oe},deflateSetDictionary:(e,t)=>{let r=t.length;if(Le(e))return ae;const n=e.state,i=n.wrap;if(2===i||1===i&&n.status!==we||n.lookahead)return ae;if(1===i&&(e.adler=W(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){0===i&&(Oe(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(r-n.w_size,r),0),t=e,r=n.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Me(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=Ae(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,Me(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,n.wrap=i,oe},deflateInfo:"pako deflate (from Nodeca project)"};const Ve=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ze=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const t in r)Ve(r,t)&&(e[t]=r[t])}}return e},He=e=>{let t=0;for(let r=0,n=e.length;r<n;r++)t+=e[r].length;const r=new Uint8Array(t);for(let t=0,n=0,i=e.length;t<i;t++){let i=e[t];r.set(i,n),n+=i.length}return r};let Ke=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Ke=!1}const Je=new Uint8Array(256);for(let e=0;e<256;e++)Je[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Je[254]=Je[254]=1;var Ge=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,n,i,o,s=e.length,a=0;for(i=0;i<s;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(a),o=0,i=0;o<a;i++)r=e.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=e.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},Xe=(e,t)=>{const r=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,i;const o=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){o[i++]=t;continue}let s=Je[t];if(s>4)o[i++]=65533,n+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&n<r;)t=t<<6|63&e[n++],s--;s>1?o[i++]=65533:t<65536?o[i++]=t:(t-=65536,o[i++]=55296|t>>10&1023,o[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&Ke)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r})(o,i)},Ye=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+Je[e[r]]>t?r:t};var et=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const tt=Object.prototype.toString,{Z_NO_FLUSH:rt,Z_SYNC_FLUSH:nt,Z_FULL_FLUSH:it,Z_FINISH:ot,Z_OK:st,Z_STREAM_END:at,Z_DEFAULT_COMPRESSION:ut,Z_DEFAULT_STRATEGY:ct,Z_DEFLATED:lt}=H;function dt(e){this.options=Ze({level:ut,method:lt,chunkSize:16384,windowBits:15,memLevel:8,strategy:ct},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new et,this.strm.avail_out=0;let r=Qe.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==st)throw new Error(Z[r]);if(t.header&&Qe.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Ge(t.dictionary):"[object ArrayBuffer]"===tt.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=Qe.deflateSetDictionary(this.strm,e),r!==st)throw new Error(Z[r]);this._dict_set=!0}}function ft(e,t){const r=new dt(t);if(r.push(e,!0),r.err)throw r.msg||Z[r.err];return r.result}dt.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?ot:rt,"string"==typeof e?r.input=Ge(e):"[object ArrayBuffer]"===tt.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===nt||o===it)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=Qe.deflate(r,o),i===at)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Qe.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===st;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},dt.prototype.onData=function(e){this.chunks.push(e)},dt.prototype.onEnd=function(e){e===st&&(this.result=He(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ht={Deflate:dt,deflate:ft,deflateRaw:function(e,t){return(t=t||{}).raw=!0,ft(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,ft(e,t)},constants:H};const pt=16209;var yt=function(e,t){let r,n,i,o,s,a,u,c,l,d,f,h,p,y,g,b,v,m,w,_,S,k,x,O;const T=e.state;r=e.next_in,x=e.input,n=r+(e.avail_in-5),i=e.next_out,O=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),a=T.dmax,u=T.wsize,c=T.whave,l=T.wnext,d=T.window,f=T.hold,h=T.bits,p=T.lencode,y=T.distcode,g=(1<<T.lenbits)-1,b=(1<<T.distbits)-1;e:do{h<15&&(f+=x[r++]<<h,h+=8,f+=x[r++]<<h,h+=8),v=p[f&g];t:for(;;){if(m=v>>>24,f>>>=m,h-=m,m=v>>>16&255,0===m)O[i++]=65535&v;else{if(!(16&m)){if(64&m){if(32&m){T.mode=16191;break e}e.msg="invalid literal/length code",T.mode=pt;break e}v=p[(65535&v)+(f&(1<<m)-1)];continue t}for(w=65535&v,m&=15,m&&(h<m&&(f+=x[r++]<<h,h+=8),w+=f&(1<<m)-1,f>>>=m,h-=m),h<15&&(f+=x[r++]<<h,h+=8,f+=x[r++]<<h,h+=8),v=y[f&b];;){if(m=v>>>24,f>>>=m,h-=m,m=v>>>16&255,16&m){if(_=65535&v,m&=15,h<m&&(f+=x[r++]<<h,h+=8,h<m&&(f+=x[r++]<<h,h+=8)),_+=f&(1<<m)-1,_>a){e.msg="invalid distance too far back",T.mode=pt;break e}if(f>>>=m,h-=m,m=i-o,_>m){if(m=_-m,m>c&&T.sane){e.msg="invalid distance too far back",T.mode=pt;break e}if(S=0,k=d,0===l){if(S+=u-m,m<w){w-=m;do{O[i++]=d[S++]}while(--m);S=i-_,k=O}}else if(l<m){if(S+=u+l-m,m-=l,m<w){w-=m;do{O[i++]=d[S++]}while(--m);if(S=0,l<w){m=l,w-=m;do{O[i++]=d[S++]}while(--m);S=i-_,k=O}}}else if(S+=l-m,m<w){w-=m;do{O[i++]=d[S++]}while(--m);S=i-_,k=O}for(;w>2;)O[i++]=k[S++],O[i++]=k[S++],O[i++]=k[S++],w-=3;w&&(O[i++]=k[S++],w>1&&(O[i++]=k[S++]))}else{S=i-_;do{O[i++]=O[S++],O[i++]=O[S++],O[i++]=O[S++],w-=3}while(w>2);w&&(O[i++]=O[S++],w>1&&(O[i++]=O[S++]))}break}if(64&m){e.msg="invalid distance code",T.mode=pt;break e}v=y[(65535&v)+(f&(1<<m)-1)]}}break}}while(r<n&&i<s);w=h>>3,r-=w,h-=w<<3,f&=(1<<h)-1,e.next_in=r,e.next_out=i,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=i<s?s-i+257:257-(i-s),T.hold=f,T.bits=h};const gt=15,bt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),vt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),wt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var _t=(e,t,r,n,i,o,s,a)=>{const u=a.bits;let c,l,d,f,h,p,y=0,g=0,b=0,v=0,m=0,w=0,_=0,S=0,k=0,x=0,O=null;const T=new Uint16Array(16),A=new Uint16Array(16);let E,C,R,P=null;for(y=0;y<=gt;y++)T[y]=0;for(g=0;g<n;g++)T[t[r+g]]++;for(m=u,v=gt;v>=1&&0===T[v];v--);if(m>v&&(m=v),0===v)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(b=1;b<v&&0===T[b];b++);for(m<b&&(m=b),S=1,y=1;y<=gt;y++)if(S<<=1,S-=T[y],S<0)return-1;if(S>0&&(0===e||1!==v))return-1;for(A[1]=0,y=1;y<gt;y++)A[y+1]=A[y]+T[y];for(g=0;g<n;g++)0!==t[r+g]&&(s[A[t[r+g]]++]=g);if(0===e?(O=P=s,p=20):1===e?(O=bt,P=vt,p=257):(O=mt,P=wt,p=0),x=0,g=0,y=b,h=o,w=m,_=0,d=-1,k=1<<m,f=k-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){E=y-_,s[g]+1<p?(C=0,R=s[g]):s[g]>=p?(C=P[s[g]-p],R=O[s[g]-p]):(C=96,R=0),c=1<<y-_,l=1<<w,b=l;do{l-=c,i[h+(x>>_)+l]=E<<24|C<<16|R}while(0!==l);for(c=1<<y-1;x&c;)c>>=1;if(0!==c?(x&=c-1,x+=c):x=0,g++,0==--T[y]){if(y===v)break;y=t[r+s[g]]}if(y>m&&(x&f)!==d){for(0===_&&(_=m),h+=b,w=y-_,S=1<<w;w+_<v&&(S-=T[w+_],!(S<=0));)w++,S<<=1;if(k+=1<<w,1===e&&k>852||2===e&&k>592)return 1;d=x&f,i[d]=m<<24|w<<16|h-o}}return 0!==x&&(i[h+x]=y-_<<24|64<<16),a.bits=m,0};const{Z_FINISH:St,Z_BLOCK:kt,Z_TREES:xt,Z_OK:Ot,Z_STREAM_END:Tt,Z_NEED_DICT:At,Z_STREAM_ERROR:Et,Z_DATA_ERROR:Ct,Z_MEM_ERROR:Rt,Z_BUF_ERROR:Pt,Z_DEFLATED:jt}=H,It=16180,Mt=16190,Dt=16191,Nt=16192,Bt=16194,Ut=16199,Ft=16200,zt=16206,Lt=16209,qt=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function $t(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Wt=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<It||t.mode>16211?1:0},Qt=e=>{if(Wt(e))return Et;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=It,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Ot},Vt=e=>{if(Wt(e))return Et;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Qt(e)},Zt=(e,t)=>{let r;if(Wt(e))return Et;const n=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Et:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Vt(e))},Ht=(e,t)=>{if(!e)return Et;const r=new $t;e.state=r,r.strm=e,r.window=null,r.mode=It;const n=Zt(e,t);return n!==Ot&&(e.state=null),n};let Kt,Jt,Gt=!0;const Xt=e=>{if(Gt){Kt=new Int32Array(512),Jt=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_t(1,e.lens,0,288,Kt,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_t(2,e.lens,0,32,Jt,0,e.work,{bits:5}),Gt=!1}e.lencode=Kt,e.lenbits=9,e.distcode=Jt,e.distbits=5},Yt=(e,t,r,n)=>{let i;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(t.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var er={inflateReset:Vt,inflateReset2:Zt,inflateResetKeep:Qt,inflateInit:e=>Ht(e,15),inflateInit2:Ht,inflate:(e,t)=>{let r,n,i,o,s,a,u,c,l,d,f,h,p,y,g,b,v,m,w,_,S,k,x=0;const O=new Uint8Array(4);let T,A;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Wt(e)||!e.output||!e.input&&0!==e.avail_in)return Et;r=e.state,r.mode===Dt&&(r.mode=Nt),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,c=r.hold,l=r.bits,d=a,f=u,k=Ot;e:for(;;)switch(r.mode){case It:if(0===r.wrap){r.mode=Nt;break}for(;l<16;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,O[0]=255&c,O[1]=c>>>8&255,r.check=V(r.check,O,2,0),c=0,l=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Lt;break}if((15&c)!==jt){e.msg="unknown compression method",r.mode=Lt;break}if(c>>>=4,l-=4,S=8+(15&c),0===r.wbits&&(r.wbits=S),S>15||S>r.wbits){e.msg="invalid window size",r.mode=Lt;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:Dt,c=0,l=0;break;case 16181:for(;l<16;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(r.flags=c,(255&r.flags)!==jt){e.msg="unknown compression method",r.mode=Lt;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=Lt;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=V(r.check,O,2,0)),c=0,l=0,r.mode=16182;case 16182:for(;l<32;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,O[2]=c>>>16&255,O[3]=c>>>24&255,r.check=V(r.check,O,4,0)),c=0,l=0,r.mode=16183;case 16183:for(;l<16;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=V(r.check,O,2,0)),c=0,l=0,r.mode=16184;case 16184:if(1024&r.flags){for(;l<16;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(O[0]=255&c,O[1]=c>>>8&255,r.check=V(r.check,O,2,0)),c=0,l=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(h=r.length,h>a&&(h=a),h&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+h),S)),512&r.flags&&4&r.wrap&&(r.check=V(r.check,n,h,o)),a-=h,o+=h,r.length-=h),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===a)break e;h=0;do{S=n[o+h++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S))}while(S&&h<a);if(512&r.flags&&4&r.wrap&&(r.check=V(r.check,n,h,o)),a-=h,o+=h,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===a)break e;h=0;do{S=n[o+h++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S))}while(S&&h<a);if(512&r.flags&&4&r.wrap&&(r.check=V(r.check,n,h,o)),a-=h,o+=h,S)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;l<16;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=Lt;break}c=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Dt;break;case 16189:for(;l<32;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}e.adler=r.check=qt(c),c=0,l=0,r.mode=Mt;case Mt:if(0===r.havedict)return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=c,r.bits=l,At;e.adler=r.check=1,r.mode=Dt;case Dt:if(t===kt||t===xt)break e;case Nt:if(r.last){c>>>=7&l,l-=7&l,r.mode=zt;break}for(;l<3;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}switch(r.last=1&c,c>>>=1,l-=1,3&c){case 0:r.mode=16193;break;case 1:if(Xt(r),r.mode=Ut,t===xt){c>>>=2,l-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=Lt}c>>>=2,l-=2;break;case 16193:for(c>>>=7&l,l-=7&l;l<32;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Lt;break}if(r.length=65535&c,c=0,l=0,r.mode=Bt,t===xt)break e;case Bt:r.mode=16195;case 16195:if(h=r.length,h){if(h>a&&(h=a),h>u&&(h=u),0===h)break e;i.set(n.subarray(o,o+h),s),a-=h,o+=h,u-=h,s+=h,r.length-=h;break}r.mode=Dt;break;case 16196:for(;l<14;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(r.nlen=257+(31&c),c>>>=5,l-=5,r.ndist=1+(31&c),c>>>=5,l-=5,r.ncode=4+(15&c),c>>>=4,l-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Lt;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;l<3;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.lens[E[r.have++]]=7&c,c>>>=3,l-=3}for(;r.have<19;)r.lens[E[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},k=_t(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,k){e.msg="invalid code lengths set",r.mode=Lt;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;x=r.lencode[c&(1<<r.lenbits)-1],g=x>>>24,b=x>>>16&255,v=65535&x,!(g<=l);){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(v<16)c>>>=g,l-=g,r.lens[r.have++]=v;else{if(16===v){for(A=g+2;l<A;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(c>>>=g,l-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=Lt;break}S=r.lens[r.have-1],h=3+(3&c),c>>>=2,l-=2}else if(17===v){for(A=g+3;l<A;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}c>>>=g,l-=g,S=0,h=3+(7&c),c>>>=3,l-=3}else{for(A=g+7;l<A;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}c>>>=g,l-=g,S=0,h=11+(127&c),c>>>=7,l-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Lt;break}for(;h--;)r.lens[r.have++]=S}}if(r.mode===Lt)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=Lt;break}if(r.lenbits=9,T={bits:r.lenbits},k=_t(1,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,k){e.msg="invalid literal/lengths set",r.mode=Lt;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},k=_t(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,k){e.msg="invalid distances set",r.mode=Lt;break}if(r.mode=Ut,t===xt)break e;case Ut:r.mode=Ft;case Ft:if(a>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=c,r.bits=l,yt(e,f),s=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,c=r.hold,l=r.bits,r.mode===Dt&&(r.back=-1);break}for(r.back=0;x=r.lencode[c&(1<<r.lenbits)-1],g=x>>>24,b=x>>>16&255,v=65535&x,!(g<=l);){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(b&&!(240&b)){for(m=g,w=b,_=v;x=r.lencode[_+((c&(1<<m+w)-1)>>m)],g=x>>>24,b=x>>>16&255,v=65535&x,!(m+g<=l);){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}c>>>=m,l-=m,r.back+=m}if(c>>>=g,l-=g,r.back+=g,r.length=v,0===b){r.mode=16205;break}if(32&b){r.back=-1,r.mode=Dt;break}if(64&b){e.msg="invalid literal/length code",r.mode=Lt;break}r.extra=15&b,r.mode=16201;case 16201:if(r.extra){for(A=r.extra;l<A;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;x=r.distcode[c&(1<<r.distbits)-1],g=x>>>24,b=x>>>16&255,v=65535&x,!(g<=l);){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(!(240&b)){for(m=g,w=b,_=v;x=r.distcode[_+((c&(1<<m+w)-1)>>m)],g=x>>>24,b=x>>>16&255,v=65535&x,!(m+g<=l);){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}c>>>=m,l-=m,r.back+=m}if(c>>>=g,l-=g,r.back+=g,64&b){e.msg="invalid distance code",r.mode=Lt;break}r.offset=v,r.extra=15&b,r.mode=16203;case 16203:if(r.extra){for(A=r.extra;l<A;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Lt;break}r.mode=16204;case 16204:if(0===u)break e;if(h=f-u,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Lt;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),y=r.window}else y=i,p=s-r.offset,h=r.length;h>u&&(h=u),u-=h,r.length-=h;do{i[s++]=y[p++]}while(--h);0===r.length&&(r.mode=Ft);break;case 16205:if(0===u)break e;i[s++]=r.length,u--,r.mode=Ft;break;case zt:if(r.wrap){for(;l<32;){if(0===a)break e;a--,c|=n[o++]<<l,l+=8}if(f-=u,e.total_out+=f,r.total+=f,4&r.wrap&&f&&(e.adler=r.check=r.flags?V(r.check,i,f,s-f):W(r.check,i,f,s-f)),f=u,4&r.wrap&&(r.flags?c:qt(c))!==r.check){e.msg="incorrect data check",r.mode=Lt;break}c=0,l=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;l<32;){if(0===a)break e;a--,c+=n[o++]<<l,l+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=Lt;break}c=0,l=0}r.mode=16208;case 16208:k=Tt;break e;case Lt:k=Ct;break e;case 16210:return Rt;default:return Et}return e.next_out=s,e.avail_out=u,e.next_in=o,e.avail_in=a,r.hold=c,r.bits=l,(r.wsize||f!==e.avail_out&&r.mode<Lt&&(r.mode<zt||t!==St))&&Yt(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,r.total+=f,4&r.wrap&&f&&(e.adler=r.check=r.flags?V(r.check,i,f,e.next_out-f):W(r.check,i,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Dt?128:0)+(r.mode===Ut||r.mode===Bt?256:0),(0===d&&0===f||t===St)&&k===Ot&&(k=Pt),k},inflateEnd:e=>{if(Wt(e))return Et;let t=e.state;return t.window&&(t.window=null),e.state=null,Ot},inflateGetHeader:(e,t)=>{if(Wt(e))return Et;const r=e.state;return 2&r.wrap?(r.head=t,t.done=!1,Ot):Et},inflateSetDictionary:(e,t)=>{const r=t.length;let n,i,o;return Wt(e)?Et:(n=e.state,0!==n.wrap&&n.mode!==Mt?Et:n.mode===Mt&&(i=1,i=W(i,t,r,0),i!==n.check)?Ct:(o=Yt(e,t,r,r),o?(n.mode=16210,Rt):(n.havedict=1,Ot)))},inflateInfo:"pako inflate (from Nodeca project)"};var tr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const rr=Object.prototype.toString,{Z_NO_FLUSH:nr,Z_FINISH:ir,Z_OK:or,Z_STREAM_END:sr,Z_NEED_DICT:ar,Z_STREAM_ERROR:ur,Z_DATA_ERROR:cr,Z_MEM_ERROR:lr}=H;function dr(e){this.options=Ze({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new et,this.strm.avail_out=0;let r=er.inflateInit2(this.strm,t.windowBits);if(r!==or)throw new Error(Z[r]);if(this.header=new tr,er.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Ge(t.dictionary):"[object ArrayBuffer]"===rr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=er.inflateSetDictionary(this.strm,t.dictionary),r!==or)))throw new Error(Z[r])}function fr(e,t){const r=new dr(t);if(r.push(e),r.err)throw r.msg||Z[r.err];return r.result}dr.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?ir:nr,"[object ArrayBuffer]"===rr.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=er.inflate(r,s),o===ar&&i&&(o=er.inflateSetDictionary(r,i),o===or?o=er.inflate(r,s):o===cr&&(o=ar));r.avail_in>0&&o===sr&&r.state.wrap>0&&0!==e[r.next_in];)er.inflateReset(r),o=er.inflate(r,s);switch(o){case ur:case cr:case ar:case lr:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||o===sr))if("string"===this.options.to){let e=Ye(r.output,r.next_out),t=r.next_out-e,i=Xe(r.output,e);r.next_out=t,r.avail_out=n-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==or||0!==a){if(o===sr)return o=er.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},dr.prototype.onData=function(e){this.chunks.push(e)},dr.prototype.onEnd=function(e){e===or&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=He(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var hr={Inflate:dr,inflate:fr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,fr(e,t)},ungzip:fr,constants:H};const{Deflate:pr,deflate:yr,deflateRaw:gr,gzip:br}=ht,{Inflate:vr,inflate:mr,inflateRaw:wr,ungzip:_r}=hr;var Sr=br;var kr=r(5966),xr=r(9697),Or=r(1080),Tr=r(2316),Ar=r(3160),Er=r(8825),Cr=r(8483),Rr=r(5360),Pr=r(964),jr=r(1838),Ir=r(7588),Mr=r(4784),Dr=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},Nr=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Br=class{httpService;usageErrorService;usageEventService;usageInfoService;workOnSubscribe$=(0,kr.n3)((()=>this.workOnSubscribeBg()));constructor(e,t,r,n){this.httpService=e,this.usageErrorService=t,this.usageEventService=r,this.usageInfoService=n}workOnSubscribeBg(){const e=n.Lf.Minute,t=5*n.Lf.Minute;return(0,xr.O)(e,t).pipe((0,Or.p)((()=>this.tickBg())),this.usageErrorService.catchError(),(0,kr.Zm)())}async tickBg(){const e={pikabuUser:await this.usageInfoService.getPikabuUser(),instance:await this.usageInfoService.getInstance(),environment:await this.usageInfoService.getEnvironment(),metrics:[],events:await this.usageEventService.shift(1e3)},t=(0,Tr.v)((()=>this.sendBg(e))).pipe((0,Ar.L)({count:10,delay:(e,t)=>{const r=t+1^3,i=10*n.Lf.Second*r;return(0,xr.O)(i)}}));await(0,Er._)(t)}async sendBg(e){let t=JSON.stringify(e);const r={"Content-Type":"application/json","Content-Encoding":"gzip"};t=await async function(e){const t=(new TextEncoder).encode(e);return Sr(t)}(t),await(0,Er._)(this.httpService.request({url:`${Pr.Ds.BASE}/api/extension-usage`,method:"POST",body:t,headers:r}))}};Dr([(0,i.mM)("StatisticSenderService.workOnSubscribeBg"),Nr("design:type",Function),Nr("design:paramtypes",[]),Nr("design:returntype",Cr.c)],Br.prototype,"workOnSubscribeBg",null),Br=Dr([(0,Rr.k)(),Nr("design:paramtypes",[o.k,jr.p,Ir.J,Mr.Z])],Br)},1838:(e,t,r)=>{"use strict";r.d(t,{p:()=>f});var n=r(4938),i=r(5140),o=r(6847),s=r(1701),a=r(5360),u=r(8528),c=r(7588),l=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let f=class{usageEventService;constructor(e){this.usageEventService=e}onUnhandledError(e){console.error(e),this.saveError(e)}catchError(e){return(0,o.W)((t=>(this.saveError(t),e??s.w)))}saveError(e){const t=n.WU,r=(0,u.M)(e);this.saveErrorBg(r,t)}async saveErrorBg(e,t){this.parseAndSaveErrorBg(e,t)}async parseAndSaveErrorBg(e,t){this.usageEventService.register("error",{errorStr:e,runtime:t})}};l([(0,i.up)("UsageErrorService.saveErrorBg"),d("design:type",Function),d("design:paramtypes",[String,String]),d("design:returntype",Promise)],f.prototype,"saveErrorBg",null),f=l([(0,a.k)(),d("design:paramtypes",[c.J])],f)},7588:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var n=r(4938),i=r(5140),o=r(602),s=r(5360),a=r(4982),u=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class{settingsService;_db;enabled=null;get db(){return this._db||(this._db=this.openDb()),this._db}constructor(e){this.settingsService=e;const t=n.WU===n.Jb.Background;this.settingsService.getKey$("sendStatistic").subscribe((e=>{this.enabled=e,!e&&t&&this.cleanBg()}))}async shift(e){const t=await this.db,r=await t.getAllKeys("event",null,e);if(!r.length)return[];const n=r[r.length-1],i=IDBKeyRange.upperBound(n),o=await t.getAll("event",i);return await t.delete("event",i),o}register(e,t){if(!1===this.enabled)return;const r={timestamp:Math.ceil(Date.now()/1e3),[e]:t};this.saveEvent(r)}async saveEvent(e){const t=await this.db;await t.put("event",e)}openDb(){if(n.WU!==n.Jb.Background)throw new Error("wrong runtime");return(0,o.P2)("des--usage",1,{upgrade(e){e.createObjectStore("event",{autoIncrement:!0})}})}async cleanBg(){const e=await this.db;await e.clear("event")}};u([(0,i.up)("UsageEventService.shift"),c("design:type",Function),c("design:paramtypes",[Number]),c("design:returntype",Promise)],l.prototype,"shift",null),u([(0,i.up)("UsageEventService.saveEvent"),c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"saveEvent",null),l=u([(0,s.k)(),c("design:paramtypes",[a.h])],l)},4784:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(4938),i=r(5140),o=r(8825),s=r(6412),a=r(5360),u=r(7232),c=r.n(u),l=r(4982),d=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let h=class{settingsService;extensionService=s.m.get(n.r7);pikabuUserNickname=null;constructor(e){this.settingsService=e}async setPikabuUserNickname(e){this.pikabuUserNickname=e}async getPikabuUser(){return{nickname:this.pikabuUserNickname}}async getInstance(){return{uuid:await(0,o._)(this.settingsService.getKey$("uuid"))}}async getEnvironment(){const e=this.extensionService.runtime?.getManifest(),t=await(this.extensionService.management?.getSelf()),r=c()(navigator.userAgent);return{installType:t?.installType??"other",manifestVersion:e?.manifest_version??0,extensionVersion:t?.version??"-",browserName:r.browser.name??"",browserVersion:r.browser.version??"",cpuArch:r.cpu.architecture??"",osName:r.os.name??"",osVersion:r.os.version??""}}};d([(0,i.up)("UsageInfoService.setPikabuUserNickname"),f("design:type",Function),f("design:paramtypes",[Object]),f("design:returntype",Promise)],h.prototype,"setPikabuUserNickname",null),d([(0,i.up)("UsageInfoService.getPikabuUser"),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],h.prototype,"getPikabuUser",null),d([(0,i.up)("UsageInfoService.getInstance"),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],h.prototype,"getInstance",null),d([(0,i.up)("UsageInfoService.getEnvironment"),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],h.prototype,"getEnvironment",null),h=d([(0,a.k)(),f("design:paramtypes",[l.h])],h)},2320:(e,t,r)=>{"use strict";r.d(t,{n:()=>h});var n=r(3732),i=r(5140),o=r(5966),s=r(1900),a=r(9050),u=r(3720),c=r(8483),l=r(5360),d=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let h=class{listen(e){return this.listenKeyChange(e).pipe((0,s.F)(n.XR),(0,a.Z)(null),(0,u.n)((()=>this.get(e))))}async get(e){const t=this.getBgStorage();let r;try{r=await t.get([e])}catch(e){r={}}return e in r?r[e]:null}async set(e,t){const r=this.getBgStorage();await r.set({[e]:t})}async clear(){const e=this.getBgStorage();await e.clear()}listenKeyChange(e){return this.listenChanges().pipe((0,o.um)(e))}listenChanges(){const e=this.getBgStorage();return new c.c((t=>{const r=e=>t.next(e);return e.onChanged.addListener(r),()=>e.onChanged.removeListener(r)}))}getBgStorage(){return r.g.browser?browser.storage.local:chrome.storage.sync}};d([(0,i.mM)("StorageService.get$"),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",c.c)],h.prototype,"listen",null),d([(0,i.up)("StorageService.get"),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",Promise)],h.prototype,"get",null),d([(0,i.up)("StorageService.set"),f("design:type",Function),f("design:paramtypes",[String,Object]),f("design:returntype",Promise)],h.prototype,"set",null),d([(0,i.up)("StorageService.clear"),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],h.prototype,"clear",null),h=d([(0,l.k)()],h)},6412:(e,t,r)=>{"use strict";r.d(t,{m:()=>h});var n,i=r(8698),o=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(t){var r,n=e.call(this)||this;return n.name="ServiceNotFoundError",n.normalizedIdentifier="<UNKNOWN_IDENTIFIER>","string"==typeof t?n.normalizedIdentifier=t:t instanceof i.o?n.normalizedIdentifier="Token<"+(t.name||"UNSET_NAME")+">":t&&(t.name||(null===(r=t.prototype)||void 0===r?void 0:r.name))&&(n.normalizedIdentifier="MaybeConstructable<"+t.name+">"||0),n}return o(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return'Service with "'+this.normalizedIdentifier+'" identifier was not found in the container. Register it before usage via explicitly calling the "Container.set" function or using the "@Service()" decorator.'},enumerable:!1,configurable:!0}),t}(Error),a=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(e){function t(t){var r,n=e.call(this)||this;return n.name="CannotInstantiateValueError",n.normalizedIdentifier="<UNKNOWN_IDENTIFIER>","string"==typeof t?n.normalizedIdentifier=t:t instanceof i.o?n.normalizedIdentifier="Token<"+(t.name||"UNSET_NAME")+">":t&&(t.name||(null===(r=t.prototype)||void 0===r?void 0:r.name))&&(n.normalizedIdentifier="MaybeConstructable<"+t.name+">"||0),n}return a(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return'Cannot instantiate the requested value for the "'+this.normalizedIdentifier+"\" identifier. The related metadata doesn't contain a factory or a type to instantiate."},enumerable:!1,configurable:!0}),t}(Error),c=r(6429),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},l.apply(this,arguments)},d=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n},f=function(){function e(e){this.services=[],this.id=e}return e.prototype.has=function(e){return!!this.findService(e)},e.prototype.get=function(e){var t=h.of(void 0),r=t.findService(e),n=this.findService(e);if(r&&!0===r.global)return this.getServiceValue(r);if(n)return this.getServiceValue(n);if(r&&this!==t){var i=l({},r);i.value=c._,this.set(i);var o=this.getServiceValue(i);return this.set(l(l({},i),{value:o})),o}if(r)return this.getServiceValue(r);throw new s(e)},e.prototype.getMany=function(e){var t=this;return this.findAllServices(e).map((function(e){return t.getServiceValue(e)}))},e.prototype.set=function(e,t){var r=this;if(e instanceof Array)return e.forEach((function(e){return r.set(e)})),this;if("string"==typeof e||e instanceof i.o)return this.set({id:e,type:null,value:t,factory:void 0,global:!1,multiple:!1,eager:!1,transient:!1});if("function"==typeof e)return this.set({id:e,type:e,value:t,factory:void 0,global:!1,multiple:!1,eager:!1,transient:!1});var n=l({id:new i.o("UNREACHABLE"),type:null,factory:void 0,value:c._,global:!1,multiple:!1,eager:!1,transient:!1},e),o=this.findService(n.id);return o&&!0!==o.multiple?Object.assign(o,n):this.services.push(n),n.eager&&this.get(n.id),this},e.prototype.remove=function(e){var t=this;return Array.isArray(e)?e.forEach((function(e){return t.remove(e)})):this.services=this.services.filter((function(r){return r.id!==e||(t.destroyServiceInstance(r),!1)})),this},e.prototype.reset=function(e){var t=this;switch(void 0===e&&(e={strategy:"resetValue"}),e.strategy){case"resetValue":this.services.forEach((function(e){return t.destroyServiceInstance(e)}));break;case"resetServices":this.services.forEach((function(e){return t.destroyServiceInstance(e)})),this.services=[];break;default:throw new Error("Received invalid reset strategy.")}return this},e.prototype.findAllServices=function(e){return this.services.filter((function(t){return t.id===e}))},e.prototype.findService=function(e){return this.services.find((function(t){return t.id===e}))},e.prototype.getServiceValue=function(e){var t,r=c._;if(e.value!==c._)return e.value;if(!e.factory&&!e.type)throw new u(e.id);if(e.factory)if(e.factory instanceof Array){var n=void 0;try{n=this.get(e.factory[0])}catch(t){if(!(t instanceof s))throw t;n=new e.factory[0]}r=n[e.factory[1]](this,e.id)}else r=e.factory(this,e.id);if(!e.factory&&e.type){var i=e.type,o=(null===(t=Reflect)||void 0===t?void 0:t.getMetadata("design:paramtypes",i))||[],a=this.initializeParams(i,o);a.push(this),r=new(i.bind.apply(i,d([void 0],a)))}if(e.transient||r===c._||(e.value=r),r===c._)throw new u(e.id);return e.type&&this.applyPropertyHandlers(e.type,r),r},e.prototype.initializeParams=function(e,t){var r=this;return t.map((function(t,n){var i=h.handlers.find((function(t){return(t.object===e||t.object===Object.getPrototypeOf(e))&&t.index===n}));return i?i.value(r):t&&t.name&&!r.isPrimitiveParamType(t.name)?r.get(t):void 0}))},e.prototype.isPrimitiveParamType=function(e){return["string","boolean","number","object"].includes(e.toLowerCase())},e.prototype.applyPropertyHandlers=function(e,t){var r=this;h.handlers.forEach((function(n){"number"!=typeof n.index&&(n.object.constructor===e||e.prototype instanceof n.object.constructor)&&n.propertyName&&(t[n.propertyName]=n.value(r))}))},e.prototype.destroyServiceInstance=function(e,t){if(void 0===t&&(t=!1),t||!!e.type||!!e.factory){if("function"==typeof(null==e?void 0:e.value).destroy)try{e.value.destroy()}catch(e){}e.value=c._}},e}(),h=function(){function e(){}return e.of=function(e){if(void 0===e&&(e="default"),"default"===e)return this.globalInstance;var t=this.instances.find((function(t){return t.id===e}));return t||(t=new f(e),this.instances.push(t)),t},e.has=function(e){return this.globalInstance.has(e)},e.get=function(e){return this.globalInstance.get(e)},e.getMany=function(e){return this.globalInstance.getMany(e)},e.set=function(e,t){return this.globalInstance.set(e,t),this},e.remove=function(e){return this.globalInstance.remove(e),this},e.reset=function(e){if(void 0===e&&(e="default"),"default"==e)this.globalInstance.reset(),this.instances.forEach((function(e){return e.reset()}));else{var t=this.instances.find((function(t){return t.id===e}));t&&(t.reset(),this.instances.splice(this.instances.indexOf(t),1))}return this},e.registerHandler=function(e){return this.handlers.push(e),this},e.import=function(e){return this},e.handlers=[],e.globalInstance=new f("default"),e.instances=[],e}()},5360:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});var n=r(6412),i=r(8698),o=r(6429);function s(e){return function(t){var r={id:t,type:t,factory:void 0,multiple:!1,global:!1,eager:!1,transient:!1,value:o._};e instanceof i.o||"string"==typeof e?r.id=e:e&&(r.id=e.id||t,r.factory=e.factory||void 0,r.multiple=e.multiple||!1,r.global=e.global||!1,r.eager=e.eager||!1,r.transient=e.transient||!1),n.m.set(r)}}},6429:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});var n=Symbol("EMPTY_VALUE")},8698:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var n=function(e){this.name=e}},7232:function(e,t,r){var n;!function(i,o){"use strict";var s="function",a="undefined",u="object",c="string",l="major",d="model",f="name",h="type",p="vendor",y="version",g="architecture",b="console",v="mobile",m="tablet",w="smarttv",_="wearable",S="embedded",k="Amazon",x="Apple",O="ASUS",T="BlackBerry",A="Browser",E="Chrome",C="Firefox",R="Google",P="Huawei",j="LG",I="Microsoft",M="Motorola",D="Opera",N="Samsung",B="Sharp",U="Sony",F="Xiaomi",z="Zebra",L="Facebook",q="Chromium OS",$="Mac OS",W=" Browser",Q=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},V=function(e,t){return typeof e===c&&-1!==Z(t).indexOf(Z(e))},Z=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},K=function(e,t){for(var r,n,i,a,c,l,d=0;d<t.length&&!c;){var f=t[d],h=t[d+1];for(r=n=0;r<f.length&&!c&&f[r];)if(c=f[r++].exec(e))for(i=0;i<h.length;i++)l=c[++n],typeof(a=h[i])===u&&a.length>0?2===a.length?typeof a[1]==s?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3===a.length?typeof a[1]!==s||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):o:this[a[0]]=l?a[1].call(this,l,a[2]):o:4===a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):o):this[a]=l||o;d+=2}},J=function(e,t){for(var r in t)if(typeof t[r]===u&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(V(t[r][n],e))return"?"===r?o:r}else if(V(t[r],e))return"?"===r?o:r;return t.hasOwnProperty("*")?t["*"]:e},G={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[y,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[y,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,y],[/opios[\/ ]+([\w\.]+)/i],[y,[f,D+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[y,[f,D+" GX"]],[/\bopr\/([\w\.]+)/i],[y,[f,D]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[y,[f,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[y,[f,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,y],[/quark(?:pc)?\/([-\w\.]+)/i],[y,[f,"Quark"]],[/\bddg\/([\w\.]+)/i],[y,[f,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[y,[f,"UC"+A]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[y,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[y,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[y,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[y,[f,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[y,[f,"Smart Lenovo "+A]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+A],y],[/\bfocus\/([\w\.]+)/i],[y,[f,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[y,[f,D+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[y,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[y,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[y,[f,D+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[y,[f,"MIUI"+W]],[/fxios\/([\w\.-]+)/i],[y,[f,C]],[/\bqihoobrowser\/?([\w\.]*)/i],[y,[f,"360"]],[/\b(qq)\/([\w\.]+)/i],[[f,/(.+)/,"$1Browser"],y],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1"+W],y],[/samsungbrowser\/([\w\.]+)/i],[y,[f,N+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[y,[f,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[f,"Sogou Mobile"],y],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[f,y],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[f],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[y,f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,L],y],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[f,y],[/\bgsa\/([\w\.]+) .*safari\//i],[y,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[y,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[y,[f,E+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,E+" WebView"],y],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[y,[f,"Android "+A]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,y],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[y,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[y,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[y,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,y],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],y],[/(wolvic|librewolf)\/([\w\.]+)/i],[f,y],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[y,[f,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,[y,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[f,[y,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,Z]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",Z]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,Z]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[p,N],[h,m]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[p,N],[h,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[p,x],[h,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[p,x],[h,m]],[/(macintosh);/i],[d,[p,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[p,B],[h,v]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[p,"Honor"],[h,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[p,P],[h,m]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[p,P],[h,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[p,F],[h,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[p,F],[h,m]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[p,"OPPO"],[h,v]],[/\b(opd2\d{3}a?) bui/i],[d,[p,"OPPO"],[h,m]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[p,"Vivo"],[h,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[p,"Realme"],[h,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[p,M],[h,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[p,M],[h,m]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[p,j],[h,m]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[p,j],[h,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[p,"Lenovo"],[h,m]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[p,"Nokia"],[h,v]],[/(pixel c)\b/i],[d,[p,R],[h,m]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[p,R],[h,v]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[p,U],[h,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[p,U],[h,m]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[p,"OnePlus"],[h,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[p,k],[h,m]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[p,k],[h,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,p,[h,m]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[p,T],[h,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[p,O],[h,m]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[p,O],[h,v]],[/(nexus 9)/i],[d,[p,"HTC"],[h,m]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[d,/_/g," "],[h,v]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[p,"TCL"],[h,m]],[/(itel) ((\w+))/i],[[p,Z],d,[h,J,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[p,"Acer"],[h,m]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[p,"Meizu"],[h,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[p,"Ulefone"],[h,v]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[p,"Energizer"],[h,v]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[p,"Cat"],[h,v]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[p,"Smartfren"],[h,v]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[p,"Nothing"],[h,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,d,[h,v]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,d,[h,m]],[/(surface duo)/i],[d,[p,I],[h,m]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[p,"Fairphone"],[h,v]],[/(u304aa)/i],[d,[p,"AT&T"],[h,v]],[/\bsie-(\w*)/i],[d,[p,"Siemens"],[h,v]],[/\b(rct\w+) b/i],[d,[p,"RCA"],[h,m]],[/\b(venue[\d ]{2,7}) b/i],[d,[p,"Dell"],[h,m]],[/\b(q(?:mv|ta)\w+) b/i],[d,[p,"Verizon"],[h,m]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[p,"Barnes & Noble"],[h,m]],[/\b(tm\d{3}\w+) b/i],[d,[p,"NuVision"],[h,m]],[/\b(k88) b/i],[d,[p,"ZTE"],[h,m]],[/\b(nx\d{3}j) b/i],[d,[p,"ZTE"],[h,v]],[/\b(gen\d{3}) b.+49h/i],[d,[p,"Swiss"],[h,v]],[/\b(zur\d{3}) b/i],[d,[p,"Swiss"],[h,m]],[/\b((zeki)?tb.*\b) b/i],[d,[p,"Zeki"],[h,m]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],d,[h,m]],[/\b(ns-?\w{0,9}) b/i],[d,[p,"Insignia"],[h,m]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[p,"NextBook"],[h,m]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],d,[h,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],d,[h,v]],[/\b(ph-1) /i],[d,[p,"Essential"],[h,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[p,"Envizen"],[h,m]],[/\b(trio[-\w\. ]+) b/i],[d,[p,"MachSpeed"],[h,m]],[/\btu_(1491) b/i],[d,[p,"Rotor"],[h,m]],[/(shield[\w ]+) b/i],[d,[p,"Nvidia"],[h,m]],[/(sprint) (\w+)/i],[p,d,[h,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[p,I],[h,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[p,z],[h,m]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[p,z],[h,v]],[/smart-tv.+(samsung)/i],[p,[h,w]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[p,N],[h,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,j],[h,w]],[/(apple) ?tv/i],[p,[d,x+" TV"],[h,w]],[/crkey/i],[[d,E+"cast"],[p,R],[h,w]],[/droid.+aft(\w+)( bui|\))/i],[d,[p,k],[h,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[p,B],[h,w]],[/(bravia[\w ]+)( bui|\))/i],[d,[p,U],[h,w]],[/(mitv-\w{5}) bui/i],[d,[p,F],[h,w]],[/Hbbtv.*(technisat) (.*);/i],[p,d,[h,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,H],[d,H],[h,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,d,[h,b]],[/droid.+; (shield) bui/i],[d,[p,"Nvidia"],[h,b]],[/(playstation [345portablevi]+)/i],[d,[p,U],[h,b]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[p,I],[h,b]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[p,N],[h,_]],[/((pebble))app/i],[p,d,[h,_]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[p,x],[h,_]],[/droid.+; (glass) \d/i],[d,[p,R],[h,_]],[/droid.+; (wt63?0{2,3})\)/i],[d,[p,z],[h,_]],[/droid.+; (glass) \d/i],[d,[p,R],[h,_]],[/(pico) (4|neo3(?: link|pro)?)/i],[p,d,[h,_]],[/; (quest( \d| pro)?)/i],[d,[p,L],[h,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[h,S]],[/(aeobc)\b/i],[d,[p,k],[h,S]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,m]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,m]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[y,[f,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[f,y],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[y,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,y],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[y,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,y],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[f,[y,J,G]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[y,J,G],[f,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[y,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,$],[y,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[y,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,y],[/\(bb(10);/i],[y,[f,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[y,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[y,[f,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[y,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[y,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[y,[f,E+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,q],y],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,y],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],y],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,y]]},Y=function(e,t){if(typeof e===u&&(t=e,e=o),!(this instanceof Y))return new Y(e,t).getResult();var r=typeof i!==a&&i.navigator?i.navigator:o,n=e||(r&&r.userAgent?r.userAgent:""),b=r&&r.userAgentData?r.userAgentData:o,w=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(X,t):X,_=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[f]=o,t[y]=o,K.call(t,n,w.browser),t[l]=typeof(e=t[y])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:o,_&&r&&r.brave&&typeof r.brave.isBrave==s&&(t[f]="Brave"),t},this.getCPU=function(){var e={};return e[g]=o,K.call(e,n,w.cpu),e},this.getDevice=function(){var e={};return e[p]=o,e[d]=o,e[h]=o,K.call(e,n,w.device),_&&!e[h]&&b&&b.mobile&&(e[h]=v),_&&"Macintosh"==e[d]&&r&&typeof r.standalone!==a&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[d]="iPad",e[h]=m),e},this.getEngine=function(){var e={};return e[f]=o,e[y]=o,K.call(e,n,w.engine),e},this.getOS=function(){var e={};return e[f]=o,e[y]=o,K.call(e,n,w.os),_&&!e[f]&&b&&b.platform&&"Unknown"!=b.platform&&(e[f]=b.platform.replace(/chrome os/i,q).replace(/macos/i,$)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===c&&e.length>500?H(e,500):e,this},this.setUA(n),this};Y.VERSION="1.0.40",Y.BROWSER=Q([f,y,l]),Y.CPU=Q([g]),Y.DEVICE=Q([d,p,h,b,v,w,m,_,S]),Y.ENGINE=Y.OS=Q([f,y]),typeof t!==a?(e.exports&&(t=e.exports=Y),t.UAParser=Y):r.amdO?(n=function(){return Y}.call(t,r,t,e))===o||(e.exports=n):typeof i!==a&&(i.UAParser=Y);var ee=typeof i!==a&&(i.jQuery||i.Zepto);if(ee&&!ee.ua){var te=new Y;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var r in t)ee.ua[r]=t[r]}}}("object"==typeof window?window:this)},6528:()=>{},8630:(e,t,r)=>{var n;!function(e){!function(){var t="object"==typeof globalThis?globalThis:"object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(e){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(e){}}(),n=i(e);function i(e,t){return function(r,n){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0!==t.Reflect&&(n=i(t.Reflect,n)),function(e,t){var r=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!s&&!a,c={create:s?function(){return de(Object.create(null))}:a?function(){return de({__proto__:null})}:function(){return de({})},has:u?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),d="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:ue(),f="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:ce(),h="function"==typeof WeakMap?WeakMap:le(),p=n?Symbol.for("@reflect-metadata:registry"):void 0,y=ie(),g=oe(y);function b(e,t,r,n){if(B(r)){if(!V(e))throw new TypeError;if(!H(t))throw new TypeError;return A(e,t)}if(!V(e))throw new TypeError;if(!z(t))throw new TypeError;if(!z(n)&&!B(n)&&!U(n))throw new TypeError;return U(n)&&(n=void 0),E(e,t,r=Q(r),n)}function v(e,t){function r(r,n){if(!z(r))throw new TypeError;if(!B(n)&&!K(n))throw new TypeError;I(e,t,r,n)}return r}function m(e,t,r,n){if(!z(r))throw new TypeError;return B(n)||(n=Q(n)),I(e,t,r,n)}function w(e,t,r){if(!z(t))throw new TypeError;return B(r)||(r=Q(r)),C(e,t,r)}function _(e,t,r){if(!z(t))throw new TypeError;return B(r)||(r=Q(r)),R(e,t,r)}function S(e,t,r){if(!z(t))throw new TypeError;return B(r)||(r=Q(r)),P(e,t,r)}function k(e,t,r){if(!z(t))throw new TypeError;return B(r)||(r=Q(r)),j(e,t,r)}function x(e,t){if(!z(e))throw new TypeError;return B(t)||(t=Q(t)),M(e,t)}function O(e,t){if(!z(e))throw new TypeError;return B(t)||(t=Q(t)),D(e,t)}function T(e,t,r){if(!z(t))throw new TypeError;if(B(r)||(r=Q(r)),!z(t))throw new TypeError;B(r)||(r=Q(r));var n=ae(t,r,!1);return!B(n)&&n.OrdinaryDeleteMetadata(e,t,r)}function A(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!B(n)&&!U(n)){if(!H(n))throw new TypeError;t=n}}return t}function E(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!B(o)&&!U(o)){if(!z(o))throw new TypeError;n=o}}return n}function C(e,t,r){if(R(e,t,r))return!0;var n=re(t);return!U(n)&&C(e,n,r)}function R(e,t,r){var n=ae(t,r,!1);return!B(n)&&$(n.OrdinaryHasOwnMetadata(e,t,r))}function P(e,t,r){if(R(e,t,r))return j(e,t,r);var n=re(t);return U(n)?void 0:P(e,n,r)}function j(e,t,r){var n=ae(t,r,!1);if(!B(n))return n.OrdinaryGetOwnMetadata(e,t,r)}function I(e,t,r,n){ae(r,n,!0).OrdinaryDefineOwnMetadata(e,t,r,n)}function M(e,t){var r=D(e,t),n=re(e);if(null===n)return r;var i=M(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new f,s=[],a=0,u=r;a<u.length;a++){var c=u[a];o.has(c)||(o.add(c),s.push(c))}for(var l=0,d=i;l<d.length;l++){c=d[l];o.has(c)||(o.add(c),s.push(c))}return s}function D(e,t){var r=ae(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function N(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function B(e){return void 0===e}function U(e){return null===e}function F(e){return"symbol"==typeof e}function z(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(N(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=G(e,i);if(void 0!==n){var o=n.call(e,r);if(z(o))throw new TypeError;return o}return q(e,"default"===r?"number":r)}function q(e,t){if("string"===t){var r=e.toString;if(Z(r))if(!z(i=r.call(e)))return i;if(Z(n=e.valueOf))if(!z(i=n.call(e)))return i}else{var n;if(Z(n=e.valueOf))if(!z(i=n.call(e)))return i;var i,o=e.toString;if(Z(o))if(!z(i=o.call(e)))return i}throw new TypeError}function $(e){return!!e}function W(e){return""+e}function Q(e){var t=L(e,3);return F(t)?t:W(t)}function V(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function Z(e){return"function"==typeof e}function H(e){return"function"==typeof e}function K(e){switch(N(e)){case 3:case 4:return!0;default:return!1}}function J(e,t){return e===t||e!=e&&t!=t}function G(e,t){var r=e[t];if(null!=r){if(!Z(r))throw new TypeError;return r}}function X(e){var t=G(e,o);if(!Z(t))throw new TypeError;var r=t.call(e);if(!z(r))throw new TypeError;return r}function Y(e){return e.value}function ee(e){var t=e.next();return!t.done&&t}function te(e){var t=e.return;t&&t.call(e)}function re(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ne(){var e,r,n,i;B(p)||void 0===t.Reflect||p in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=se(t.Reflect));var o=new h,s={registerProvider:a,getProvider:c,setProvider:y};return s;function a(t){if(!Object.isExtensible(s))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case B(r):r=t;break;case r===t:break;case B(n):n=t;break;case n===t:break;default:void 0===i&&(i=new f),i.add(t)}}function u(t,o){if(!B(r)){if(r.isProviderFor(t,o))return r;if(!B(n)){if(n.isProviderFor(t,o))return r;if(!B(i))for(var s=X(i);;){var a=ee(s);if(!a)return;var u=Y(a);if(u.isProviderFor(t,o))return te(s),u}}}if(!B(e)&&e.isProviderFor(t,o))return e}function c(e,t){var r,n=o.get(e);return B(n)||(r=n.get(t)),B(r)?(B(r=u(e,t))||(B(n)&&(n=new d,o.set(e,n)),n.set(t,r)),r):r}function l(e){if(B(e))throw new TypeError;return r===e||n===e||!B(i)&&i.has(e)}function y(e,t,r){if(!l(r))throw new Error("Metadata provider not registered.");var n=c(e,t);if(n!==r){if(!B(n))return!1;var i=o.get(e);B(i)&&(i=new d,o.set(e,i)),i.set(t,r)}return!0}}function ie(){var e;return!B(p)&&z(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[p]),B(e)&&(e=ne()),!B(p)&&z(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,p,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function oe(e){var t=new h,r={isProviderFor:function(e,r){var n=t.get(e);return!B(n)&&n.has(r)},OrdinaryDefineOwnMetadata:s,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:o,OrdinaryOwnMetadataKeys:a,OrdinaryDeleteMetadata:u};return y.registerProvider(r),r;function n(n,i,o){var s=t.get(n),a=!1;if(B(s)){if(!o)return;s=new d,t.set(n,s),a=!0}var u=s.get(i);if(B(u)){if(!o)return;if(u=new d,s.set(i,u),!e.setProvider(n,i,r))throw s.delete(i),a&&t.delete(n),new Error("Wrong provider for target.")}return u}function i(e,t,r){var i=n(t,r,!1);return!B(i)&&$(i.has(e))}function o(e,t,r){var i=n(t,r,!1);if(!B(i))return i.get(e)}function s(e,t,r,i){n(r,i,!0).set(e,t)}function a(e,t){var r=[],i=n(e,t,!1);if(B(i))return r;for(var o=X(i.keys()),s=0;;){var a=ee(o);if(!a)return r.length=s,r;var u=Y(a);try{r[s]=u}catch(e){try{te(o)}finally{throw e}}s++}}function u(e,r,i){var o=n(r,i,!1);if(B(o))return!1;if(!o.delete(e))return!1;if(0===o.size){var s=t.get(r);B(s)||(s.delete(i),0===s.size&&t.delete(s))}return!0}}function se(e){var t=e.defineMetadata,r=e.hasOwnMetadata,n=e.getOwnMetadata,i=e.getOwnMetadataKeys,o=e.deleteMetadata,s=new h;return{isProviderFor:function(e,t){var r=s.get(e);return!(B(r)||!r.has(t))||!!i(e,t).length&&(B(r)&&(r=new f,s.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:i,OrdinaryDeleteMetadata:o}}function ae(e,t,r){var n=y.getProvider(e,t);if(!B(n))return n;if(r){if(y.setProvider(e,t,g))return g;throw new Error("Illegal state.")}}function ue(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,J(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,i)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){if(!J(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(J(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function i(e,t){return t}function s(e,t){return[e,t]}}function ce(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}()}function le(){var e=16,t=c.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(c.has(t,e));return t[e]=!0,e}function o(e,t){if(!r.call(e,n)){if(!t)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){if("function"==typeof Uint8Array){var t=new Uint8Array(e);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):s(t,e),t}return s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function de(e){return e.__=void 0,delete e.__,e}e("decorate",b),e("metadata",v),e("defineMetadata",m),e("hasMetadata",w),e("hasOwnMetadata",_),e("getMetadata",S),e("getOwnMetadata",k),e("getMetadataKeys",x),e("getOwnMetadataKeys",O),e("deleteMetadata",T)}(n,t),void 0===t.Reflect&&(t.Reflect=e)}()}(n||(n={}))},2284:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{A:()=>n})},5419:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>_,l2:()=>E});var n=r(6412),i=r(5360),o=r(8698),s=r(3732),a=r(2316),u=r(3720),c=r(2467),l=r(7718),d=r(8483),f=r(9099),h=r(4938),p=r(321),y=r(602);class g{constructor(e){this.cache=e,this.waitPromises=new Map,this.waitObservables=new Map}wrapObservable(e,t,r=!1){if(this.waitObservables.has(e))return r&&console.log(`[${e}] from waiting observable cache`),this.waitObservables.get(e);const n=(0,a.v)(t).pipe((0,f.M)({next:t=>{r&&console.log(`[${e}] observable next`,t),this.cache.set(e,t)},finalize:()=>{r&&console.log(`[${e}] observable finalize`),this.waitObservables.delete(e)}})),i=(0,a.v)((()=>this.cache.get(e))).pipe((0,u.n)((t=>{if((0,s.O9)(t))return r&&console.log(`[${e}] from cache`),(0,c.of)(t);if(!this.waitObservables.has(e)){r&&console.log(`[${e}] create shared observable`);const t=n.pipe((0,l.t)({refCount:!0,bufferSize:1}));this.waitObservables.set(e,t)}return r&&console.log(`[${e}] wait shared observable`),this.waitObservables.get(e)})));return(0,a.v)((()=>this.waitObservables.get(e)??i))}async wrapPromise(e,t,r=!1){if(this.waitPromises.has(e))return r&&console.log(`[${e}] from waiting promise cache`),this.waitPromises.get(e);const n=await this.cache.get(e);if((0,s.O9)(n))return r&&console.log(`[${e}] from cache`),n;r&&console.log(`[${e}] waiting promise`);const i=t();this.waitPromises.set(e,i);try{const t=await i;return await this.cache.set(e,t),r&&console.log(`[${e}] promise success`),t}catch(t){return r&&console.error(`[${e}] promise error`),Promise.reject(t)}finally{this.waitPromises.delete(e)}}}let b=class{constructor(e,t){this.storage=e,this.params=t,this.autoPrune(!1)}get now(){return Date.now()}async get(e){const t=await this.storage.get(this.params.scope,e);if(t)return this.isValid(t)?t.value:void await this.storage.delete(this.params.scope,e)}async has(e){const t=await this.storage.get(this.params.scope,e);return!!t&&(!!this.isValid(t)||(await this.storage.delete(this.params.scope,e),!1))}async set(e,t){await this.storage.set(this.params.scope,e,{value:t,time:this.now})}async delete(e){await this.storage.delete(this.params.scope,e)}isValid(e){const t=this.now,r=this.params.lifetimeMs;return e.time+r>t}async prune(){await this.storage.prune(this.params.scope,this.now-this.params.lifetimeMs,this.params.size)}async size(){return this.storage.size(this.params.scope)}getWrapper(){return this.wrapper||(this.wrapper=new g(this)),this.wrapper}async autoPrune(e=!0){e&&await this.prune(),(0,s.lD)((()=>this.autoPrune()),this.params.autoPruneInterval??s.Lf.Minute)}};var v=Object.defineProperty,m=Object.getOwnPropertyDescriptor;let w=class{getCache(e){const t=n.m.get(e.type);return new b(t,e)}};w=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?m(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&v(t,r,o),o})([(0,i.k)()],w);const _=new o.o("IndexeddbCacheDbPrefix");var S=Object.defineProperty,k=Object.getOwnPropertyDescriptor;let x=class{constructor(){this.scopedDbMap=new Map}async get(e,t){return await(await this.getDBForScope(e)).get("cache",t)??null}async has(e,t){return await(await this.getDBForScope(e)).count("cache",t)>0}async set(e,t,r){const n=await this.getDBForScope(e);await n.delete("cache",t),await n.put("cache",r,t)}async delete(e,t){await(await this.getDBForScope(e)).delete("cache",t)}async prune(e,t,r){const n=await this.getDBForScope(e),i=await n.getAllKeysFromIndex("cache","by-time",IDBKeyRange.upperBound(t,!0));for(const e of i)await n.delete("cache",e);let o=await this.size(e)-r;if(o<=0)return;const s=await n.transaction("cache").store.index("by-time").openCursor(void 0,"next"),a=[];for(;s&&o--;)a.push(s.primaryKey);for(const e of a)await n.delete("cache",e)}async size(e){return(await this.getDBForScope(e)).count("cache")}async getDBForScope(e){return this.scopedDbMap.has(e)||this.scopedDbMap.set(e,this.getDBWithStore(e)),this.scopedDbMap.get(e)}async getDBWithStore(e){const t=n.m.get(_);return(0,y.P2)(`${t}${e}`,1,{upgrade(e){e.createObjectStore("cache").createIndex("by-time","time")}})}};x=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?k(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&S(t,r,o),o})([(0,i.k)()],x);var O=Object.defineProperty,T=Object.getOwnPropertyDescriptor;let A=class{constructor(){this.scopes=new Map}async get(e,t){return this.getScopedMap(e).get(t)??null}async has(e,t){return this.getScopedMap(e).has(t)}async set(e,t,r){const n=this.getScopedMap(e);n.delete(t),n.set(t,r)}async delete(e,t){this.getScopedMap(e).delete(t)}async prune(e,t,r){const n=this.getScopedMap(e);for(const[e,r]of n){if(r.time>=t)break;n.delete(e)}for(const e of n.keys()){if(n.size<=r)break;n.delete(e)}}async size(e){return this.getScopedMap(e).size}getScopedMap(e){return this.scopes.has(e)||this.scopes.set(e,new Map),this.scopes.get(e)}};A=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?T(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&O(t,r,o),o})([(0,i.k)()],A);const E=(e,t,r)=>(i,o,s)=>{if(t&&t!==h.WU)return;if(!r)switch(h.WU){case h.Jb.Background:case h.Jb.Popup:r=x;break;case h.Jb.ContentScript:case h.Jb.PageScript:r=A}const a=`${i.constructor.name}.${String(o)}`,u=Reflect.getMetadata("design:returntype",i,o),c=u===Promise,l=u===d.c;if(!c&&!l)return void console.error("method should return Promise or Observable");const f=new p.hE,y=n.m.get(w).getCache({type:r,scope:a,lifetimeMs:e,size:1e5}).getWrapper(),g=s.value;s.value=function(...e){const t=()=>g.apply(this,e),r=f.serialize(e);return l?y.wrapObservable(r,t):c?y.wrapPromise(r,t):void 0}}},3732:(e,t,r)=>{"use strict";r.d(t,{Lf:()=>a,M_:()=>n,O9:()=>u,XR:()=>l,lD:()=>f,u4:()=>c,vM:()=>d});const n=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),i=36e5,o=24*i,s=7*o;var a=(e=>(e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=i]="Hour",e[e.Day=o]="Day",e[e.Week=s]="Week",e))(a||{});function u(e){return void 0!==e}function c(e){return Object(e)===e&&"[object Object]"===toString.call(e)}function l(e,t){if(Array.isArray(e)||Array.isArray(t))return!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)&&e.every(((e,r)=>l(e,t[r])));if(c(e)&&c(t)){const r=Array.from(new Set([...Object.keys(e),...Object.keys(t)]));return 0===r.length||r.every((r=>l(e[r],t[r])))}return e===t}function d(e){return null!=e}function f(e,t){u(n.requestIdleCallback)?requestIdleCallback(e,{timeout:t}):setTimeout(e,t)}},5885:(e,t,r)=>{"use strict";r.d(t,{H:()=>d,a:()=>m});var n=r(5140),i=r(321),o=r(2467),s=r(3720),a=r(3288),u=r(8483),c=r(1160),l=r(5360);class d extends Error{constructor(e,t){super(),this.request=e,this.response=t}get statusCode(){return this.response.statusCode}get statusText(){return this.response.statusText}toString(){return`HttpError [${this.statusCode}]: ${this.statusText}`}}function f(e){const t={};for(const[r,n]of e)t[r]=n;return t}function h(e,t){return(0,o.of)(t).pipe((0,s.n)((async t=>{const r={statusCode:t.status,statusText:t.statusText,headers:f(t.headers)};if(e.parseResponseAsJson){const e=t.clone();try{r.bodyJson=await e.json()}catch(e){if(t.ok)throw e}}if(e.parseResponseAsText){const n="string"==typeof e.parseResponseAsText?e.parseResponseAsText:void 0,i=t.clone();if(!i.body)throw new Error("Response body is empty");const o=await i.body.pipeThrough(new TextDecoderStream(n)).getReader().read();r.bodyText=o.value}return r})))}const p={type:d,prefix:"HttpError",parse:function(e,t){const r=t.parse(e),n=new d(r.request,r.response);return n.stack=r.stack,n},stringify:function(e,t){return t.serialize({request:e.request,response:e.response,stack:e.stack})}};var y=Object.defineProperty,g=Object.getOwnPropertyDescriptor,b=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?g(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&y(t,r,o),o};const v=[...i.dB,p];let m=class{getJson(e,t){return this.requestJson("GET",e,t)}postJson(e,t,r){return this.requestJson("POST",e,t,r)}requestJson(e,t,r,n){const i={Accept:"application/json"};let o="";return r&&(i["Content-Type"]="application/json",o=JSON.stringify(r)),this.fetchJson({...n,url:t,method:e,body:o,headers:{...null==n?void 0:n.headers,...i}})}fetchJson(e){return this.request({...e,parseResponseAsJson:!0,parseResponseAsText:!1}).pipe((0,c.T)((e=>e.bodyJson)))}fetchText(e){return this.request({...e,parseResponseAsJson:!1,parseResponseAsText:e.parseResponseAsText??!0}).pipe((0,c.T)((e=>e.bodyText)))}request(e){return this.requestThroughFetchBg(e).pipe((0,s.n)((t=>t.ok?h(e,t):h(e,t).pipe((0,s.n)((t=>(0,a.$)((()=>new d(e,t)))))))))}requestThroughFetchBg(e){return this.fetchBg(e.url,{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,referrer:e.referrer,referrerPolicy:e.referrerPolicy,redirect:e.redirect})}fetchBg(...e){return new u.c((t=>{const r=new AbortController;try{fetch(...e).then((e=>t.next(e))).catch((e=>t.error(e))).finally((()=>t.complete()))}catch(e){t.error(e)}return()=>r.abort()}))}};b([(0,n.mM)("HttpService.request",!1,v)],m.prototype,"request",1),m=b([(0,l.k)()],m)},6891:(e,t,r)=>{"use strict";r.d(t,{j:()=>n.H,k:()=>n.a});r(8630);var n=r(5885)},3883:(e,t,r)=>{"use strict";r.d(t,{N:()=>f});var n=r(3732),i=r(4938),o=r(5140),s=r(5966),a=r(6412),u=r(5360),c=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d=(e,t,r,n)=>{for(var i,o=n>1?void 0:n?l(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&c(t,r,o),o};let f=class{openWhileSubscribed(e,t=!1){return(0,s.Cp)((()=>{const r=a.m.get(i.r7).tabs;let n=null;return this.openInNewTab(e,t).then((e=>{n=e})),()=>{if(n)try{null==r||r.remove(n)}catch(e){console.error(e)}}}))}async openInNewTab(e,t=!1){const r=a.m.get(i.r7).tabs,n=await(null==r?void 0:r.query({url:e}));if(null!=n&&n.length){for(const e of n)if(e.id)return t&&await(null==r?void 0:r.reload(e.id)),e.id;return null}const o=await(null==r?void 0:r.create({url:e}));return(null==o?void 0:o.id)??null}async reloadTabs(){const e=a.m.get(i.r7).tabs,t=await(null==e?void 0:e.query({windowType:"normal",url:this.getHosts()}));for(const r of t??[])r.id&&await(null==e?void 0:e.reload(r.id))}getHosts(){var e;const t=a.m.get(i.r7).runtime,r=null==t?void 0:t.getManifest();return r?(null==(e=r.content_scripts)?void 0:e.map((e=>e.matches)).flat().filter(n.vM))??[]:[]}};d([(0,o.mM)("NavigationService.openWhileSubscribed")],f.prototype,"openWhileSubscribed",1),d([(0,o.up)("NavigationService.openInNewTab")],f.prototype,"openInNewTab",1),d([(0,o.up)("NavigationService.reloadTabs")],f.prototype,"reloadTabs",1),f=d([(0,u.k)()],f)},2891:(e,t,r)=>{"use strict";r.d(t,{B:()=>D});var n=r(3732),i=r(5966),o=r(1701),s=r(2316),a=r(8483),u=r(7718),c=r(7791),l=r(1485),d=r(3720),f=r(3288),h=r(9050),p=r(6978),y=r(3160),g=r(9697),b=r(9741),v=r(2467),m=r(6126),w=r(8825),_=r(8452),S=r(1160),k=r(9099),x=r(6412),O=r(5360),T=r(4938);class A{constructor(e,t){this.sendEventType=e,this.listenEventType=t,this.disconnect$=o.w,this.message$=(0,s.v)((()=>this.listenMessage())).pipe((0,i.Vk)())}sendMessage(e){n.M_.postMessage({type:this.sendEventType,payload:e})}listenMessage(){return new a.c((e=>{const t=t=>{(0,n.u4)(t.data)&&t.data.type===this.listenEventType&&e.next(t.data.payload)};return n.M_.addEventListener("message",t),()=>{n.M_.removeEventListener("message",t)}}))}}class E{constructor(e){this.port=e,this.disconnect$=(0,s.v)((()=>this.listenDisconnect())).pipe((0,u.t)()),this.message$=(0,s.v)((()=>this.listenMessage())).pipe((0,c.Q)(this.disconnect$),(0,i.Vk)())}sendMessage(e){this.port.postMessage(e)}listenDisconnect(){return new a.c((e=>{const t=()=>{e.next(),e.complete()};return this.port.onDisconnect.addListener(t),()=>{this.port.onDisconnect.removeListener(t)}}))}listenMessage(){return new a.c((e=>{const t=t=>{e.next(t)};return this.port.onMessage.addListener(t),()=>{this.port.onMessage.removeListener(t)}}))}}class C{constructor(){this.extensionService=x.m.get(T.r7),this.runtime=this.extensionService.runtime,this.tabs=this.extensionService.tabs,this.disconnect$=o.w,this.message$=this.listenMessages()}async sendMessage(e){var t,r;const n=await(null==(t=this.tabs)?void 0:t.query({url:this.getHosts()}));for(const t of n??[])if(t.id)try{await(null==(r=this.tabs)?void 0:r.sendMessage(t.id,e))}catch(e){console.error(e)}}listenMessages(){return new a.c((e=>{var t;const r=t=>{e.next(t)};return null==(t=this.runtime)||t.onMessage.addListener(r),()=>{var e;return null==(e=this.runtime)?void 0:e.onMessage.removeListener(r)}}))}getHosts(){var e,t;const r=null==(e=this.runtime)?void 0:e.getManifest();return r?(null==(t=r.content_scripts)?void 0:t.map((e=>e.matches)).flat().filter(n.vM))??[]:[]}}var R=Object.defineProperty,P=Object.getOwnPropertyDescriptor;let j=class{constructor(){this.extensionId$=new b.m(1),this.extensionService=x.m.get(T.r7)}setExtensionId(e){this.extensionId$.next(e)}listenConnection(){return T.WU===T.Jb.Background?this.listenConnect():this.createConnection()}listenConnect(){return(0,n.vM)(this.extensionService.contextV3)?this.listenPortConnect():this.createTabsConnection()}listenPortConnect(){const e=this.extensionService.runtime;if(!e)throw new Error("runtime not defined");return new a.c((t=>{const r=e=>{t.next(new E(e))};return e.onConnectExternal.addListener(r),()=>{e.onConnectExternal.removeListener(r)}}))}createConnection(){return(0,n.vM)(this.extensionService.contextV3)?this.createDirectConnection():this.createContentScriptConnection()}createDirectConnection(){var e;const t=null==(e=this.extensionService.contextV3)?void 0:e.runtime;if(!t)throw new Error("runtime not defined");return this.extensionId$.pipe((0,S.T)((e=>{try{return new E(t.connect(e))}catch(e){throw console.error(t.lastError),e}})),(0,l.F)((0,d.n)((e=>e.disconnect$.pipe((0,d.n)((()=>(0,f.$)((()=>new Error("Port disconnected"))))),(0,h.Z)(e),(0,p.B)(0)))),(0,y.L)({delay:(e,t)=>(console.log(e),console.log(`PF: Connect retry count: ${t}`),(0,g.O)(t*n.Lf.Second)),resetOnSuccess:!0})))}createContentScriptConnection(){return(0,v.of)(new A("[FromPageToContent]","[FromContentToPage]"))}createTabsConnection(){return(0,v.of)(new C)}};j=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?P(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&R(t,r,o),o})([(0,O.k)()],j);var I=Object.defineProperty,M=Object.getOwnPropertyDescriptor;let D=class{constructor(){this.backgroundConnectionService=x.m.get(j),this.connection$=(0,s.v)((()=>this.backgroundConnectionService.listenConnection())).pipe((0,u.t)()),this.connectionMessage$=(0,s.v)((()=>this.listenConnectionMessage())).pipe((0,i.Vk)()),this.openedPorts$=(0,s.v)((()=>this.listenOpenedPorts())).pipe((0,u.t)()),this.connectorMessage$=(0,s.v)((()=>this.listenConnectorMessage())).pipe((0,i.Vk)())}listenMessage(e){return this.connectorMessage$.pipe((0,m.p)((t=>t.type===e)),(0,S.T)((e=>e.payload)))}async postMessage(e,t){const r={"[ConnectorMessage]":!0,type:e,payload:t},n=await(0,w._)(this.openedPorts$);for(const e of n)try{e.sendMessage(r)}catch(e){console.error(e)}}listenConnectionMessage(){return this.connection$.pipe((0,_.Z)((e=>e.message$)))}listenConnectorMessage(){return this.connectionMessage$.pipe((0,m.p)((e=>function(e){return(0,n.u4)(e)&&"[ConnectorMessage]"in e}(e))))}listenOpenedPorts(){const e=new Set;return this.connection$.pipe((0,k.M)((t=>e.add(t))),(0,_.Z)((t=>t.disconnect$.pipe((0,k.M)((()=>e.delete(t))),(0,h.Z)(t)))),(0,S.T)((()=>e)))}};D=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?M(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&I(t,r,o),o})([(0,O.k)()],D)},5140:(e,t,r)=>{"use strict";r.d(t,{mM:()=>W,up:()=>Q});r(8630);var n=r(2891),i=(r(8905),r(3732)),o=r(5966),s=r(321),a=r(6126),u=r(7903),c=r(9697);function l(e,t){return void 0===e&&(e=0),void 0===t&&(t=u.E),e<0&&(e=0),(0,c.O)(e,e,t)}var d=r(1160),f=r(2908),h=r(4878),p=r(2357),y=r(5964);var g=r(2316),b=r(1005),v=r(3720),m=r(8452),w=r(7968),_=r(9099),S=r(6847),k=r(1701),x=r(4240),O=r(7791),T=r(8483),A=r(3288);var E=r(9050),C=r(6978),R=r(8825),P=r(6412),j=r(5360),I=r(5279),M=r(4938);const D="MM.Event";function N(e){return(0,i.u4)(e)&&e.event===D}var B=Object.defineProperty,U=Object.getOwnPropertyDescriptor;const F="[EventsService.message]";let z=class{constructor(){this.events$=(0,o.n3)((()=>this.listenAllEvents())),this.serializer=new s.hE}listenEvent(e){return this.events$.pipe((0,a.p)((t=>t.type===e)))}async emitEvent(e,t){const r=(0,I.A)(),i={event:D,type:e,data:t,uuid:r};await P.m.get(n.B).postMessage(F,this.serializer.serialize(i))}listenAllEvents(){const e=P.m.get(n.B),t=l(10*i.Lf.Second);return e.listenMessage(F).pipe((0,d.T)((e=>this.serializer.parse(e))),(0,a.p)(N),(r=e=>e.uuid,o=t,(0,f.N)((function(e,t){var n=new Set;e.subscribe((0,h._)(t,(function(e){var i=r?r(e):e;n.has(i)||(n.add(i),t.next(e))}))),o&&(0,y.Tg)(o).subscribe((0,h._)(t,(function(){return n.clear()}),p.l))}))));var r,o}};z=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?U(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&B(t,r,o),o})([(0,j.k)()],z);var L=Object.defineProperty,q=Object.getOwnPropertyDescriptor;let $=class{constructor(){this.eventsService=P.m.get(z),this.runtime=M.WU,this.eventName="RemoteProcessorService.command",this.aliveIntervalMs=5e3,this.commandEvent$=(0,g.v)((()=>this.eventsService.listenEvent(this.eventName))),this.command$=this.commandEvent$.pipe((0,d.T)((e=>e.data)),(0,b.u)()),this.serializer=new s.hE}setMethodProcessor(e,t,r=0,n=!1){n&&this.log("setMethodProcessor",e);const i=this.getSubscribe(e);return(0,c.O)(r).pipe((0,v.n)((()=>i)),(0,m.Z)((r=>{const i=r.uuid,o=this.getUnsubscribe(i,e,n),s=this.getProcessorTapObserver(i,n),a=this.getSubscriptionAliveEmitter(i,n),u=(0,w.H)(t(r.input)).pipe((0,_.M)(s),(0,S.W)((e=>(this.emitCommand({type:"error",uuid:i,data:this.serializer.serialize(e)},n),k.w))));return(0,x.h)(a,u).pipe((0,O.Q)(o))})),(0,d.T)((()=>{})))}getMethodObservable(e,t,r=!1){return r&&this.log("getMethodObservable",e),(0,g.v)((()=>{r&&this.log("getMethodObservable.defer",e);const n=(0,I.A)(),i=new T.c((()=>{this.emitCommand({type:"subscribe",uuid:n,methodName:e,input:t},r)})),o=this.getCommandByUuid(n),s=o.pipe((0,a.p)((e=>"next"===e.type))),u=o.pipe((0,a.p)((e=>"error"===e.type))),l=s.pipe((0,_.M)((e=>r&&this.log("next",e))),(0,d.T)((e=>this.serializer.parse(e.data)))),p=u.pipe((0,v.n)((t=>(0,A.$)((()=>this.serializer.parse(t.data)??new Error(`unknown error from ${e}`)))))),g=this.getComplete(n,r),b=this.getSubscribeAliveEmitter(n,e,r),m=this.getSubscriptionTimeout(n,e,r);return(0,x.h)(i,b,l,p).pipe((0,O.Q)(m),(w={delay:this.aliveIntervalMs},C=1/0,null!=w&&("object"==typeof w?(S=w.count,C=void 0===S?1/0:S,E=w.delay):C=w),C<=0?function(){return k.w}:(0,f.N)((function(e,t){var r,n=0,i=function(){if(null==r||r.unsubscribe(),r=null,null!=E){var e="number"==typeof E?(0,c.O)(E):(0,y.Tg)(E(n)),i=(0,h._)(t,(function(){i.unsubscribe(),o()}));e.subscribe(i)}else o()},o=function(){var o=!1;r=e.subscribe((0,h._)(t,void 0,(function(){++n<C?r?i():o=!0:t.complete()}))),o&&i()};o()}))),(0,_.M)({unsubscribe:()=>this.emitCommand({type:"unsubscribe",uuid:n},r)}),(0,O.Q)(g));var w,S,E,C}))}getCommandByUuid(e){return this.command$.pipe((0,a.p)((t=>t.uuid===e)))}getUnsubscribe(e,t,r=!1){const n=this.getCommandByUuid(e),i=n.pipe((0,a.p)((e=>"unsubscribe"===e.type)),(0,_.M)((()=>r&&this.log(`${e}: unsubscribe command received`)))),o=n.pipe((0,a.p)((e=>"subscribe-alive"===e.type)),(0,E.Z)(null),(0,C.B)(3*this.aliveIntervalMs),(0,_.M)((()=>r&&this.warn(t,`${e}: subscribe-alive timeout`))));return(0,x.h)(i,o).pipe((0,d.T)((()=>{})))}getComplete(e,t=!1){return this.getCommandByUuid(e).pipe((0,a.p)((e=>"complete"===e.type)),(0,_.M)((()=>t&&this.log(`${e}: complete command received`)))).pipe((0,d.T)((()=>{})))}getSubscriptionTimeout(e,t,r=!1){return this.getCommandByUuid(e).pipe((0,a.p)((e=>"subscription-alive"===e.type)),(0,d.T)((()=>null)),(0,E.Z)(null),(0,C.B)(3*this.aliveIntervalMs),(0,_.M)((()=>r&&this.log(t,`${e}: subscription-alive timeout`))))}getSubscribe(e){return this.command$.pipe((0,a.p)((t=>"subscribe"===t.type&&t.methodName===e)))}getProcessorTapObserver(e,t=!1){return{next:r=>this.emitCommand({type:"next",uuid:e,data:this.serializer.serialize(r)},t),complete:()=>this.emitCommand({type:"complete",uuid:e},t)}}getSubscriptionAliveEmitter(e,t=!1){return l(this.aliveIntervalMs).pipe((0,d.T)((()=>this.emitCommand({type:"subscription-alive",uuid:e},t))),(0,a.p)((()=>!1)))}getSubscribeAliveEmitter(e,t,r=!1){return l(this.aliveIntervalMs).pipe((0,d.T)((()=>this.emitCommand({type:"subscribe-alive",methodName:t,uuid:e},r))),(0,a.p)((()=>!1)))}emitCommand(e,t=!1){this.eventsService.emitEvent(this.eventName,e),t&&this.log("emitCommand",e)}log(...e){console.log(this.runtime,...e)}warn(...e){console.warn(this.runtime,...e)}};$=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?q(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&L(t,r,o),o})([(0,j.k)()],$);const W=(e,t=!1,r=s.dB)=>{const n=new s.hE(r);return(r,i,o)=>{const s=M.WU;if(M.Jb.Background===s)return t&&console.log(e,"Background runtime (register processor)",s),void P.m.get($).setMethodProcessor(e,(e=>{var t;const i=n.parse(e);try{const e=null==(t=o.value)?void 0:t.call(function(){if(P.m.has(r.constructor))return P.m.get(r.constructor)}(),...i);return e?(0,w.H)(e):(0,A.$)((()=>new Error("expect Observable result")))}catch(e){return console.error(e),(0,A.$)((()=>e))}}),0,t).subscribe();t&&console.log(e,"other runtime (register proxy)",s),o.value=function(...r){const i=P.m.get($),o=n.serialize(r);return i.getMethodObservable(e,o,t)}}},Q=(e,t=!1,r=s.dB)=>{const n=new s.hE(r);return(r,i,o)=>{const s=M.WU;if(M.Jb.Background===s)return t&&console.log(e,"Background runtime (register processor)",s),void P.m.get($).setMethodProcessor(e,(e=>{var t;const i=n.parse(e);try{const e=null==(t=o.value)?void 0:t.call(function(){if(P.m.has(r.constructor))return P.m.get(r.constructor)}(),...i);return e&&e instanceof Promise?(0,w.H)(e):(0,A.$)((()=>new Error("expect Promise")))}catch(e){return console.error(e),(0,A.$)((()=>e))}}),0,t).subscribe();t&&console.log(e,"other runtime (register proxy)",s),o.value=function(...r){const i=P.m.get($),o=n.serialize(r),s=i.getMethodObservable(e,o,t);return(0,R._)(s)}}}},8905:(e,t,r)=>{"use strict";r(4938)},4938:(e,t,r)=>{"use strict";r.d(t,{Jb:()=>l,WU:()=>d,r7:()=>p});r(8630);var n=r(3732),i=r(5360),o=r(6412),s=r(9336),a=r(8975),u=r(7718),c=r(8825),l=(e=>(e.Background="background",e.Popup="popup",e.ContentScript="content-script",e.PageScript="page-script",e))(l||{});const d=(0,n.vM)(n.M_.chrome)?function(e){if(!(0,n.vM)(e.extension))return l.PageScript;const t=e.extension;return"declarativeNetRequest"in e?"getBackgroundPage"in t&&t.getBackgroundPage()!==n.M_?l.Popup:l.Background:l.ContentScript}(n.M_.chrome):(0,n.vM)(n.M_.browser)?function(e){const t=e.extension;return"declarativeNetRequest"in e?"getBackgroundPage"in t&&t.getBackgroundPage()!==n.M_?l.Popup:l.Background:l.ContentScript}(n.M_.browser):l.PageScript;var f=Object.defineProperty,h=Object.getOwnPropertyDescriptor;let p=class{constructor(){var e,t,r,i;this.contextV2=n.M_.browser??null,this.contextV3=this.contextV2?null:n.M_.chrome??null,this.context=this.contextV3??this.contextV2??null,this.runtime=(null==(e=this.context)?void 0:e.runtime)??null,this.tabs=(null==(t=this.context)?void 0:t.tabs)??null,this.notifications=(null==(r=this.context)?void 0:r.notifications)??null,this.management=(null==(i=this.context)?void 0:i.management)??null}};p=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?h(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&f(t,r,o),o})([(0,i.k)()],p);var y=Object.defineProperty,g=Object.getOwnPropertyDescriptor;let b=class{async loadResourceFile(e){const t=o.m.get(p).runtime;if(!t)throw new Error("runtime not available");await function(e,t="utf-8"){const r=document.getElementsByTagName("body")[0],n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.setAttribute("charset",t);const i=(0,s.R)(n,"load").pipe((0,a.s)(1),(0,u.t)(1));return r.appendChild(n),(0,c._)(i)}(t.getURL(e))}};b=((e,t,r,n)=>{for(var i,o=n>1?void 0:n?g(t,r):t,s=e.length-1;s>=0;s--)(i=e[s])&&(o=(n?i(t,r,o):i(o))||o);return n&&o&&y(t,r,o),o})([(0,i.k)()],b)},5966:(e,t,r)=>{"use strict";r.d(t,{n3:()=>w,Zm:()=>S,um:()=>k,Vk:()=>x,oB:()=>O,Cp:()=>_});var n=r(1485),i=r(1005),o=r(9741),s=r(9697),a=r(2316),u=r(8483),c=r(3720),l=r(1150),d=r(1900);var f=r(7968),h=r(9050),p=r(6978),y=r(7718),g=r(2467),b=r(2922),v=r(1160),m=r(9099);function w(e,t=10){return(0,a.v)(e).pipe(function(e=10){return(0,n.F)((0,i.u)({connector:()=>new o.m(1),resetOnRefCountZero:()=>(0,s.O)(e)}))}(t))}function _(e){return new u.c((()=>e())).pipe((0,i.u)())}function S(){return(0,n.F)((0,c.n)((()=>l.t)))}function k(e){return(0,n.F)((t=e,(0,d.F)((function(e,n){return r?r(e[t],n[t]):e[t]===n[t]}))),(0,v.T)((t=>t[e])));var t,r}function x(e=10){return(0,i.u)({resetOnRefCountZero:()=>(0,s.O)(e)})}function O(e,t=!0){const r=new Map;return(0,c.n)((n=>{const o=new Set(n);if([...r.keys()].filter((e=>!o.has(e))).forEach((e=>{r.delete(e)})),n.filter((e=>!r.has(e))).forEach((n=>{const i=(0,f.H)(e(n)).pipe(t?(0,h.Z)(null):(0,m.M)(),(0,p.B)(0),(0,y.t)({refCount:!0,bufferSize:1}));r.set(n,i)})),!n.length)return(0,g.of)([]);const a=n.map((e=>r.get(e)));return(0,b.z)(a).pipe((0,i.u)({resetOnRefCountZero:()=>(0,s.O)(1)}))}))}},321:(e,t,r)=>{"use strict";r.d(t,{dB:()=>s,hE:()=>u});var n=r(3732);const i={type:Date,prefix:"Date",parse:function(e){return new Date(e)},stringify:function(e){return e.toISOString()}},o={type:Error,prefix:"Error",parse:function(e,t){const r=t.parse(e),n=new Error(r.message);return n.name=r.name,n.stack=r.stack,n},stringify:function(e,t){return t.serialize({message:e.message,name:e.name,stack:e.stack})}},s=[i,{type:FormData,prefix:"FormData",parse:function(e,t){const r=new FormData,n=t.parse(e);for(const e in n)r.set(e,n[e]);return r},stringify:function(e,t){const r={};for(const[t,n]of e.entries())r[t]=n;return t.serialize(r)}},o,{type:Map,prefix:"Map",parse:function(e,t){const r=t.parse(e);return new Map(r)},stringify:function(e,t){const r=[...e.entries()];return t.serialize(r)}}],a=class e{constructor(e=s){this.byPrefix=new Map;for(const t of e)this.byPrefix.set(t.prefix,t)}serialize(e){const t=this.prepareToSerialize(e);return JSON.stringify(t)}parse(e){try{const t=JSON.parse(e);return this.afterParse(t)}catch{return}}prepareToSerialize(t){if(!(0,n.vM)(t))return t;if((0,n.u4)(t))for(const e in t){const r=this.prepareToSerialize(t[e]);t[e]!==r&&(t={...t,[e]:r})}if(Array.isArray(t))return t.map(this.prepareToSerialize.bind(this));for(const[,r]of this.byPrefix)if(t instanceof r.type){const n=r.stringify(t,this);return`${e.MAPPER_PREFIX}${r.prefix}${e.SEPARATOR}${n}`}return t}afterParse(t){if((0,n.u4)(t))for(const e in t)t[e]=this.afterParse(t[e]);if(Array.isArray(t))return t.map(this.afterParse.bind(this));if("string"==typeof t&&t.startsWith(e.MAPPER_PREFIX)){const[r,n]=t.split(e.SEPARATOR),i=r.replace(e.MAPPER_PREFIX,""),o=this.byPrefix.get(i);if(o)return o.parse(n,this)}return t}};a.MAPPER_PREFIX="|-MAPPER-|",a.SEPARATOR="|-DATA-|";let u=a},602:(e,t,r)=>{"use strict";r.d(t,{P2:()=>y});const n=(e,t)=>t.some((t=>e instanceof t));let i,o;const s=new WeakMap,a=new WeakMap,u=new WeakMap;let c={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return h(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function l(e){c=e(c)}function d(e){return(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(p(this),t),h(this.request)}:function(...t){return h(e.apply(p(this),t))}}function f(e){return"function"==typeof e?d(e):(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),n()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));s.set(e,t)}(e),n(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,c):e)}function h(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(h(e.result)),n()},o=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",o)}));return u.set(t,e),t}(e);if(a.has(e))return a.get(e);const t=f(e);return t!==e&&(a.set(e,t),u.set(t,e)),t}const p=e=>u.get(e);function y(e,t,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=h(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(h(s.result),e.oldVersion,e.newVersion,h(s.transaction),e)})),r&&s.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const g=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],v=new Map;function m(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(v.get(t))return v.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=b.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!g.includes(r))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),i&&o.done]))[0]};return v.set(t,o),o}l((e=>({...e,get:(t,r,n)=>m(t,r)||e.get(t,r,n),has:(t,r)=>!!m(t,r)||e.has(t,r)})));const w=["continue","continuePrimaryKey","advance"],_={},S=new WeakMap,k=new WeakMap,x={get(e,t){if(!w.includes(t))return e[t];let r=_[t];return r||(r=_[t]=function(...e){S.set(this,k.get(this)[t](...e))}),r}};async function*O(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,x);for(k.set(r,t),u.set(r,p(t));t;)yield r,t=await(S.get(r)||t.continue()),S.delete(r)}function T(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}l((e=>({...e,get:(t,r,n)=>T(t,r)?O:e.get(t,r,n),has:(t,r)=>T(t,r)||e.has(t,r)})))},1635:(e,t,r)=>{"use strict";r.d(t,{AQ:()=>d,C6:()=>i,Ju:()=>a,N3:()=>l,YH:()=>s,fX:()=>c,sH:()=>o,xN:()=>f,zs:()=>u});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}Object.create;function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function c(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function d(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{!function(e){e.value instanceof l?Promise.resolve(e.value.v).then(u,c):d(o[0][2],e)}(i[e](t))}catch(e){d(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=a(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError},5279:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const o=new Uint8Array(16);const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function a(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}const u=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const s=(e=e||{}).random??e.rng?.()??function(){if(!i){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");i=crypto.getRandomValues.bind(crypto)}return i(o)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return a(s)}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";r(8630),r(3883)})(),(()=>{"use strict";r(8630),r(5885)})(),(()=>{"use strict";var e=r(4938);const t=e.WU;t!==e.Jb.Background&&console.error(`Background EXTENSION_CURRENT_RUNTIME_TYPE: ${t}`)})(),(()=>{"use strict";r(8630)})(),(()=>{"use strict";var e=r(4938),t=(r(8630),r(3883)),n=r(6412);const i=n.m.get(t.N),o=n.m.get(e.r7).runtime;o?.onInstalled.addListener((()=>{i.reloadTabs()}))})(),(()=>{"use strict";var e=r(4938);const t=r(6412).m.get(e.r7).runtime;if(!t)throw new Error("runtime does not exist");t.onUpdateAvailable.addListener((e=>()=>{t.reload()}))})(),(()=>{"use strict";var e=r(5419);r(6412).m.set(e.Fc,"des--cache-")})(),(()=>{"use strict";var e=r(6412),t=r(4365),n=r(5825),i=r(2481),o=r(475),s=r(9444),a=r(1591),u=r(2654);e.m.get(n.N),e.m.get(t.$),e.m.get(i.Q),e.m.get(u.E),e.m.get(a.b),e.m.get(o.k),e.m.get(s.d)})(),(()=>{"use strict";var e=r(6412),t=r(5419),n=r(3732),i=r(4938),o=r(5140),s=r(6891),a=r(8825),u=r(5360),c=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let d=class{httpService=e.m.get(s.k);root="https://isla-de-muerta.com/";async getUserSummaryOrFail(e){const t=e.replaceAll(".","_"),r=await this.fetchUserIdBg(t);return{host:this.root,username:t,postsTags:await this.fetchTagsBg(r,"PostTags"),commentsTags:await this.fetchTagsBg(r,"CommentTags")}}async fetchUserIdBg(e){const t=`${this.root}user/${e}-summary`,r=await(0,a._)(this.httpService.fetchText({method:"GET",url:t})),n=new RegExp("/api/(\\d+)-live").exec(r);return n?Number(n[1]):Promise.reject()}async fetchTagsBg(e,t){const r=`${this.root}api/${e}-${t}`;return(0,a._)(this.httpService.fetchJson({method:"GET",url:r}))}};c([(0,t.l2)(n.Lf.Hour,i.Jb.PageScript),(0,t.l2)(n.Lf.Day,i.Jb.Background),(0,o.up)("MonsterApiService.getUserSummaryOrFail"),l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",Promise)],d.prototype,"getUserSummaryOrFail",null),c([(0,t.l2)(n.Lf.Week),l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",Promise)],d.prototype,"fetchUserIdBg",null),c([(0,t.l2)(n.Lf.Day),l("design:type",Function),l("design:paramtypes",[Number,String]),l("design:returntype",Promise)],d.prototype,"fetchTagsBg",null),d=c([(0,u.k)()],d),e.m.get(d)})(),(()=>{"use strict";r(6789)})(),(()=>{"use strict";var e=r(5419),t=r(3732),n=r(4938),i=r(5140),o=r(8825),s=r(6412),a=r(5360),u=r(6891),c=r(3720),l=r(3288),d=r(2467);class f{static createFromObject(e){let t=!1;for(const[r,n]of Object.entries(e))"string"==typeof n||n instanceof Blob||(t=!0);if(!t)return f.createFormData(e);const r={};for(const[t,n]of Object.entries(e))n instanceof Blob?r[t]=n:r[t]=String(n);return f.createFormData(r)}static createFormData(e){const t=new FormData;for(const[r,n]of Object.entries(e))n instanceof File?t.set(r,n,n.name):t.set(r,n);return t}}class h extends Error{}var p=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let g=class{httpService;constructor(e){this.httpService=e}ajax(e,t){return this.ajaxWithFails(e,t).pipe((0,c.n)((e=>e.result?(0,d.of)(e.data):(0,l.$)((()=>new h(e.message))))))}ajaxWithFails(e,t){const r=`https://pikabu.ru/ajax/${e}`,n=f.createFromObject(t);return this.httpService.fetchJson({url:r,method:"POST",body:n,mode:"no-cors"})}};g=p([(0,a.k)(),y("design:paramtypes",[u.k])],g);var b=r(746),v=r(2284),m=r(4188),w=r(123),_=r(551);function S(e,t){return(0,_.A)(2,arguments),function(e,t){(0,_.A)(2,arguments);var r=(0,w.A)(e),n=(0,m.A)(t);return isNaN(n)?new Date(NaN):n?(r.setDate(r.getDate()+n),r):r}(e,-(0,m.A)(t))}function k(e,t){return(0,_.A)(2,arguments),function(e,t){(0,_.A)(2,arguments);var r=(0,w.A)(e),n=(0,m.A)(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var i=r.getDate(),o=new Date(r.getTime());return o.setMonth(r.getMonth()+n+1,0),i>=o.getDate()?o:(r.setFullYear(o.getFullYear(),o.getMonth(),i),r)}(e,-(0,m.A)(t))}var x=r(2773),O=r.n(x);function T(e,t){const r=e.getElementsByClassName(t);return r?r[0]:null}function A(e,t){const r=e.getElementsByTagName(t);return r?r[0]:null}function E(e){const t=(new(O())).parseFromString(e),r=T(t,"profile_short")??T(t,"mini-profile");if(!r)throw new Error("Не удалось получить элемент профиля");const n=r.getAttribute("data-user-id");if(!n)throw new Error("Не удалось получить идентификатор пользователя");const i=Number(n),o=T(r,"profile__user-information")??T(r,"mini-profile__signup-info");if(!o)throw new Error("Не удалось получить элемент срока регистрации");const[s]=o.getElementsByTagName("span")??[],a=function(e){const t={},r={years:["год","лет"],months:["мес"],weeks:["нед"],days:["д","сут"],hours:["час"]},n=e.split(" ");for(let e=0;e<n.length;e+=2){const i=n[e]??"",o=n[e+1]??"";for(const e in r){const n=e;r[n].some((e=>o.startsWith(e)))&&(t[n]=Number(i))}}return t}(s?.textContent??""),u=T(r,"profile__nick")??A(r,"h2");if(!u)throw new Error("Не удалось получить элемент с никнеймом пользователя (блок)");const c=A(u,"a");if(!c)throw new Error("Не удалось получить элемент с никнеймом пользователя (ссылка)");const l=c.textContent??c.getAttribute("title");if(!l)throw new Error("Не удалось получить никнейм пользователя");const d=function(e,t){if((0,_.A)(2,arguments),!t||"object"!==(0,v.A)(t))return new Date(NaN);var r=t.years?(0,m.A)(t.years):0,n=t.months?(0,m.A)(t.months):0,i=t.weeks?(0,m.A)(t.weeks):0,o=t.days?(0,m.A)(t.days):0,s=t.hours?(0,m.A)(t.hours):0,a=t.minutes?(0,m.A)(t.minutes):0,u=t.seconds?(0,m.A)(t.seconds):0,c=S(k(e,n+12*r),o+7*i),l=1e3*(u+60*(a+60*s));return new Date(c.getTime()-l)}(new Date,a);return{id:i,nickname:l,registrationDateMs:d.getTime()}}var C=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},R=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let P=class{pikabuMobileApiService=s.m.get(b.e);pikabuCommonApiService=s.m.get(g);async getFromPikabuByName(e){if(!e)return console.warn("require username"),null;const t=await this.getShortUserInfoHtmlOrFailBg(e);return t?E(t):null}async getShortUserInfoHtmlOrFailBg(e){const t=this.pikabuCommonApiService.ajax(`user_info.php?${e}`,{action:"get_short_profile",user_name:e}),r=await(0,o._)(t);return r.html?r.html:null}async fetchMobileApiUser(e){return(await this.pikabuMobileApiService.fetchData({controller:"user.profile.get",body:{user_name:e},queries:`${e}`})).user}};C([(0,e.l2)(t.Lf.Week,n.Jb.Background),(0,i.up)("PikabuUserApiService.getFromPikabuByName"),R("design:type",Function),R("design:paramtypes",[String]),R("design:returntype",Promise)],P.prototype,"getFromPikabuByName",null),C([(0,e.l2)(t.Lf.Week,n.Jb.Background),(0,i.up)("PikabuUserApiService.fetchMobileApiUser"),R("design:type",Function),R("design:paramtypes",[String]),R("design:returntype",Promise)],P.prototype,"fetchMobileApiUser",null),P=C([(0,a.k)()],P)})(),(()=>{"use strict";var e=r(5966),t=r(1160),n=r(6412),i=r(4982),o=r(1838),s=r(5360),a=r(1150);class u{enable$=(0,e.n3)((()=>this.enabled().pipe((0,e.Zm)())));enabled(){return a.t}}var c=r(5388),l=function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let f=class extends u{statisticSenderService;constructor(e){super(),this.statisticSenderService=e}enabled(){return this.statisticSenderService.workOnSubscribe$}};f=l([(0,s.k)(),d("design:paramtypes",[c.b])],f);const h=[{enabledOn:"sendStatistic",featureType:f}],p=n.m.get(i.h),y=n.m.get(o.p);p.settings$.pipe((0,t.T)((e=>h.filter((t=>!t.enabledOn||e[t.enabledOn])))),(0,t.T)((e=>e.map((e=>n.m.get(e.featureType))))),(0,e.oB)((e=>e.enable$.pipe(y.catchError())))).subscribe()})(),(()=>{"use strict";r(964).Ds.BASE="https://pikabu-fixes.ru"})(),(()=>{"use strict";r(4031)})(),(()=>{"use strict";var e=r(6412),t=r(4982);e.m.get(t.h)})(),(()=>{"use strict";var e=r(4384),t=r(6412),n=r(1838);e.$.onUnhandledError=e=>{t.m.get(n.p).onUnhandledError(e)}})(),(()=>{"use strict";var e=r(6412),t=r(5388),n=r(1838),i=r(7588),o=r(4784);e.m.get(t.b),e.m.get(n.p),e.m.get(i.J),e.m.get(o.Z)})(),(()=>{"use strict";var e=r(6412),t=r(2320);e.m.get(t.n)})()})();