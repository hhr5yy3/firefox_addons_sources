!function(){'use strict';const e=()=>{const e=(navigator&&navigator.userAgent||'').toLowerCase(),t=(navigator&&navigator.vendor||'').toLowerCase(),i=null!==e.match(/(?:firefox|fxios)\/(\d+)/),n=null!==e.match(/version\/(\d+).+?safari/),a=null!==e.match(/edge\/(\d+)/)||null!==e.match(/edg\/(\d+)/),r=null!==e.match(/(?:^opera.+?version|opr)\/(\d+)/),l=/google inc/.test(t)?e.match(/(?:chrome|crios)\/(\d+)/):null;return i?'FIREFOX':n?'SAFARI':a?'EDGE':r?'OPERA':null!==l&&!r?'CHROME':void 0},t=window.top===window.self,i=e=>e?e.split('+').map((e=>{return(t=e)?(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1):'';var t})).join('+'):'',n=e=>{const t=-1!==navigator.userAgent.indexOf('Mac OS X');if(!e)return'';if(!t)return i(e);if(e.includes('⇧')||e.includes('⌥')||e.includes('⌃')||e.includes('⌘'))return e;e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace('shift','⇧')).replace('alt','⌥')).replace('right','→')).replace('left','←')).replace('right','→')).replace('pagedown','⇟')).replace('pageup','⇞')).replace('end','↘')).replace('home','↖')).replace('insert','Ins')).replace('period','.');const n=(e=(e=(e=t?e.replace('macctrl','⌃'):e.replace('ctrl','⌃')).replace('command','⌘')).replace('meta','⌘')).split('+');return n.includes('comma')&&(e=e.replace('comma',',')),n.includes('down')&&(e=e.replace('down','↓')),n.includes('up')&&(e=e.replace('up','↑')),n.includes('delete')&&(e=e.replace('delete','Del')),n.includes('del')&&(e=e.replace('del','Del')),n.includes('ins')&&(e=e.replace('ins','Ins')),n.includes('ctrl')&&(e=e.replace('ctrl','⌃')),(e=i(e)).split('+').join('')},a=e=>{const t=document.getElementsByTagName('iframe');if(0===t.length)return null;const i=((e,t)=>e.reduce(((e,i)=>{const{width:n,height:a,src:r,name:l}=t,s=window.getComputedStyle(i),o=parseInt(s.paddingLeft,10),d=parseInt(s.paddingRight,10);let u=i.clientWidth;!isNaN(o)&&o>0&&(u-=o),!isNaN(d)&&d>0&&(u-=d);const c=Math.abs(u-n)<=1&&Math.abs(i.clientHeight-a)<=1,h=i.src&&r&&i.src===r,m=i.name&&l&&i.name===l;let p=0;return c&&m&&h?p=3:c&&(h||m)||h&&m?p=2:c&&(p=1),e.push({frame:i,exactScore:p}),e}),[]).sort(((e,t)=>t.exactScore-e.exactScore))[0])([...t],e);return 0===i.exactScore?null:i},r=e=>/^[A-Za-z_-][-A-Za-z0-9_:.]*$/.test(e);for(var l='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',s='undefined'==typeof Uint8Array?[]:new Uint8Array(256),o=0;o<64;o++)s[l.charCodeAt(o)]=o;const d='form_captured',u='guess_form_type_result';let c=null;'SAFARI'!==e()&&(c='undefined'==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype?chrome:browser);const h=(e,t)=>{const i={command:e,payload:t};'object'==typeof safari&&safari.extension?safari.extension.dispatchMessage(e,t):c.runtime.sendMessage(i)},m=e=>'object'==typeof safari&&safari.extension?safari.extension.baseURI+e.substring(e.lastIndexOf('/')+1):c.runtime.getURL(e);class p{constructor(){this.ExtensionAPI=null,'SAFARI'!==e()&&('undefined'==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype?this.ExtensionAPI=chrome:this.ExtensionAPI=browser),this.request=e=>{'object'==typeof safari&&safari.extension?safari.extension.dispatchMessage(e.command,e.payload):this.ExtensionAPI.runtime.sendMessage(e)},this.on=(e,t)=>{const i=this;function n(a,r,l){return a.command&&a.command===e&&t(a.payload,(function(){i.off(n)})),a.name&&a.name===e&&t(a.message,(()=>{i.off(n)})),!0}return'object'==typeof safari&&safari.self&&safari.self.addEventListener?safari.self.addEventListener('message',n):this.ExtensionAPI.runtime.onMessage.addListener(n),n},this.off=e=>{'object'==typeof safari&&safari.self&&safari.self.removeEventListener?safari.self.removeEventListener('message',e):this.ExtensionAPI.runtime.onMessage.removeListener(e)}}}const f=new class{constructor(e){this.messageManager=new p,this.isSafariExtension='object'==typeof safari&&safari.extension}setBlockingURL(e){this.messageManager.request({command:'set_block_url',payload:{url:e}})}setBlurOnInlineMenu(e){this.isSafariExtension&&(e={...e,relay:!0}),this.messageManager.request({command:'set_menu_blur',payload:e})}setFocusOnlineMenu(e){this.isSafariExtension&&(e={...e,relay:!0}),this.messageManager.request({command:'set_menu_focus',payload:e})}fetchInlineItems(e){this.messageManager.request({command:'fetch_inline_items',payload:e})}searchItem(e){this.isSafariExtension&&(e={...e,relay:!0}),this.messageManager.request({command:'search_item',payload:e})}continueOnUnlock(e){this.isSafariExtension&&(e={...e,relay:!0}),this.messageManager.request({command:'continue_on_unlock',payload:e})}getLockStatus(){this.messageManager.request({command:'get_lock_status'})}getInlineSetting(e){this.messageManager.request({command:'fetch_inline_setting',payload:e})}onInlineSettingResult(e){this.messageManager.on('inline_setting_result',e)}onLockStateUpdated(e){this.messageManager.on('update_lock_status',e)}onInlineMenuSettingUpdate(e){this.messageManager.on('update_inline_menu_setting',e)}onInlineMenuDisplayStatus(e){this.messageManager.on('menu_display_status',e)}onSetFieldFocus(e){this.messageManager.on('active_field_focus',e)}onSaveInputData(e){this.messageManager.on('save_input_data',e)}onResizeMenu(e){this.messageManager.on('resize-menu',e)}onRemoveMenu(e){this.messageManager.on('remove_menu',e)}onInlineMenuBlocked(e){this.messageManager.on('block_inline_menu',e)}onMenuReadyToShow(e){this.messageManager.on('menu_ready_to_show',e)}getAutoFillItemOnLoad(){this.messageManager.request({command:'get_autofill_item_on_load'})}onAutofillOnLoadData(e){this.messageManager.on('autofill_onload_data',e)}onAutofillInlineItem(e){this.messageManager.on('autofill_inline_item',e)}onTabInfo(e){this.messageManager.on('tab_info',e)}handleButtonClick(e){this.messageManager.request({command:'inline_button_clicked',payload:e})}notifyIframes(e){this.messageManager.request({command:'notify_iframes',payload:e})}onIframeNotification(e){this.messageManager.on('iframe_notification',e)}saveLoginData(e){this.messageManager.request({command:'form_captured',payload:e})}sendDirtyFieldStatus(e){this.messageManager.request({command:'dirty_status',payload:e})}fetchLaunchShortcut(){return this.messageManager.request({command:'fetch_launch_shortcut'})}fetchMenuSettings(e){this.messageManager.request({command:'fetch_menu_settings',payload:e})}checkSafariConnection(e){this.messageManager.request({command:'check_safari_connection',payload:e})}onMenuSettings(e){this.messageManager.on('stored_menu_settings',e)}onUnlockAttach(e){this.messageManager.on('attach_menu_on_unlock',e)}setToggleDisplay(e){this.messageManager.request({command:'toggle_menu_display',payload:{...e,relay:!0}})}onToggleDisplay(e){this.messageManager.on('toggle_menu_display',e)}attachMenuToRect(e){this.messageManager.request({command:'attach_menu_to_rect',payload:{...e,relay:!0}})}removeAttachedMenu(e){this.messageManager.request({command:'remove_attached_menu',payload:{...e,relay:!0}})}attachMenuOnKeyDown(e){this.messageManager.request({command:'attach_menu_on_keydown',payload:{...e,relay:!0}})}dettachMenuOnKeyEvent(e){this.messageManager.request({command:'dettach_menu_on_keyevent',payload:{...e,relay:!0}})}updateMenuPosition(e){this.messageManager.request({command:'update_menu_position',payload:{...e,relay:!0}})}fetchResizeHeight(e){this.messageManager.request({command:'fetch_resize_height',payload:{...e,relay:!0}})}onAttachMenuOnKeyDown(e){this.messageManager.on('attach_menu_on_keydown',e)}onDettachMenuOnKeyEvent(e){this.messageManager.on('dettach_menu_on_keyevent',e)}onRemoveAttachedMenu(e){this.messageManager.on('remove_attached_menu',e)}onAttachMenuRect(e){this.messageManager.on('attach_menu_to_rect',e)}onUpdateMenuPosition(e){this.messageManager.on('update_menu_position',e)}onPasskeyCreation(e){this.messageManager.on('initiate_passkey_creation_response',e)}onPasskeyAuthentication(e){this.messageManager.on('initiate_passkey_authentication_response',e)}};var g='undefined'!=typeof global?global:'undefined'!=typeof self?self:'undefined'!=typeof window?window:{};function b(){throw new Error('setTimeout has not been defined')}function y(){throw new Error('clearTimeout has not been defined')}var v=b,w=y;function _(e){if(v===setTimeout)return setTimeout(e,0);if((v===b||!v)&&setTimeout)return v=setTimeout,setTimeout(e,0);try{return v(e,0)}catch(t){try{return v.call(null,e,0)}catch(t){return v.call(this,e,0)}}}'function'==typeof g.setTimeout&&(v=setTimeout),'function'==typeof g.clearTimeout&&(w=clearTimeout);var T,L=[],I=!1,E=-1;function F(){I&&T&&(I=!1,T.length?L=T.concat(L):E=-1,L.length&&D())}function D(){if(!I){var e=_(F);I=!0;for(var t=L.length;t;){for(T=L,L=[];++E<t;)T&&T[E].run();E=-1,t=L.length}T=null,I=!1,function(e){if(w===clearTimeout)return clearTimeout(e);if((w===y||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(e);try{return w(e)}catch(t){try{return w.call(null,e)}catch(t){return w.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}x.prototype.run=function(){this.fun.apply(null,this.array)};function N(){}var A=N,C=N,S=N,O=N,k=N,P=N,M=N;var R=g.performance||{},U=R.now||R.mozNow||R.msNow||R.oNow||R.webkitNow||function(){return(new Date).getTime()};var V=new Date;var z={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];L.push(new x(e,t)),1!==L.length||I||_(D)},title:'browser',browser:!0,env:{},argv:[],version:'',versions:{},on:A,addListener:C,once:S,off:O,removeListener:k,removeAllListeners:P,emit:M,binding:function(e){throw new Error('process.binding is not supported')},cwd:function(){return'/'},chdir:function(e){throw new Error('process.chdir is not supported')},umask:function(){return 0},hrtime:function(e){var t=.001*U.call(R),i=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(i-=e[0],(n-=e[1])<0&&(i--,n+=1e9)),[i,n]},platform:'browser',release:{},config:{},uptime:function(){return(new Date-V)/1e3}},B=z;function W(e){return'Minified Redux error #'+e+'; visit https://redux.js.org/Errors?code='+e+' for the full message or use the non-minified dev environment for full errors. '}var j='function'==typeof Symbol&&Symbol.observable||'@@observable',q=function(){return Math.random().toString(36).substring(7).split('').join('.')},$={INIT:'@@redux/INIT'+q(),REPLACE:'@@redux/REPLACE'+q(),PROBE_UNKNOWN_ACTION:function(){return'@@redux/PROBE_UNKNOWN_ACTION'+q()}};function H(e){if(void 0===e)return'undefined';if(null===e)return'null';var t=typeof e;switch(t){case'boolean':case'string':case'number':case'symbol':case'function':return t}if(Array.isArray(e))return'array';if(function(e){return e instanceof Date||'function'==typeof e.toDateString&&'function'==typeof e.getDate&&'function'==typeof e.setDate}(e))return'date';if(function(e){return e instanceof Error||'string'==typeof e.message&&e.constructor&&'number'==typeof e.constructor.stackTraceLimit}(e))return'error';var i=function(e){return'function'==typeof e.constructor?e.constructor.name:null}(e);switch(i){case'Symbol':case'Promise':case'WeakMap':case'WeakSet':case'Map':case'Set':return i}return t.slice(8,-1).toLowerCase().replace(/\s/g,'')}function K(e){var t=typeof e;return'production'!==B.env.NODE_ENV&&(t=H(e)),t}const G={activeField:void 0,activeFieldDir:'ltr',activeFieldPaddingX:0,activeFieldRect:void 0,locked:!0,menuOpen:!1,locale:c?c.i18n.getUILanguage():'en',inlineDisabled:!1,autoLogin:!1,autoDisplayMenu:!0,autofillInOperation:!1,autoLoginExecuted:!1,menuID:void 0,frameID:window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16),url:void 0,iframeURL:document.URL,latest_action:null,isPasskeySupported:!1,isDevToolsOpened:!1};var Y=function e(t,i,n){var a;if('function'==typeof i&&'function'==typeof n||'function'==typeof n&&'function'==typeof arguments[3])throw new Error('production'===B.env.NODE_ENV?W(0):'It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');if('function'==typeof i&&void 0===n&&(n=i,i=void 0),void 0!==n){if('function'!=typeof n)throw new Error('production'===B.env.NODE_ENV?W(1):'Expected the enhancer to be a function. Instead, received: \''+K(n)+'\'');return n(e)(t,i)}if('function'!=typeof t)throw new Error('production'===B.env.NODE_ENV?W(2):'Expected the root reducer to be a function. Instead, received: \''+K(t)+'\'');var r=t,l=i,s=[],o=s,d=!1;function u(){o===s&&(o=s.slice())}function c(){if(d)throw new Error('production'===B.env.NODE_ENV?W(3):'You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.');return l}function h(e){if('function'!=typeof e)throw new Error('production'===B.env.NODE_ENV?W(4):'Expected the listener to be a function. Instead, received: \''+K(e)+'\'');if(d)throw new Error('production'===B.env.NODE_ENV?W(5):'You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.');var t=!0;return u(),o.push(e),function(){if(t){if(d)throw new Error('production'===B.env.NODE_ENV?W(6):'You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.');t=!1,u();var i=o.indexOf(e);o.splice(i,1),s=null}}}function m(e){if(!function(e){if('object'!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error('production'===B.env.NODE_ENV?W(7):'Actions must be plain objects. Instead, the actual type was: \''+K(e)+'\'. You may need to add middleware to your store setup to handle dispatching other values, such as \'redux-thunk\' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.');if(void 0===e.type)throw new Error('production'===B.env.NODE_ENV?W(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if(d)throw new Error('production'===B.env.NODE_ENV?W(9):'Reducers may not dispatch actions.');try{d=!0,l=r(l,e)}finally{d=!1}for(var t=s=o,i=0;i<t.length;i++){(0,t[i])()}return e}return m({type:$.INIT}),(a={dispatch:m,subscribe:h,getState:c,replaceReducer:function(e){if('function'!=typeof e)throw new Error('production'===B.env.NODE_ENV?W(10):'Expected the nextReducer to be a function. Instead, received: \''+K(e));r=e,m({type:$.REPLACE})}})[j]=function(){var e,t=h;return(e={subscribe:function(e){if('object'!=typeof e||null===e)throw new Error('production'===B.env.NODE_ENV?W(11):'Expected the observer to be an object. Instead, received: \''+K(e)+'\'');function i(){e.next&&e.next(c())}return i(),{unsubscribe:t(i)}}})[j]=function(){return this},e},a}(((e=G,t)=>{switch(t.type){case'INIT_STATE':{const t={activeField:void 0,activeFieldDir:'ltr',activeFieldPaddingX:0,activeFieldRect:void 0,menuOpen:!1};return{...e,...t,latest_action:'INIT_STATE'}}case'SET_ACTIVE_FIELD':{const i={direction:'ltr',paddingLeft:'0',paddingRight:'0'},n=t.payload,a=n?window.getComputedStyle(n):i,r='rtl'===a.direction?'rtl':'ltr',l=parseFloat('rtl'===r?a.paddingLeft:a.paddingRight);return{...e,activeField:t.payload,activeFieldRect:n?JSON.parse(JSON.stringify(n.getBoundingClientRect())):void 0,activeFieldDir:r,activeFieldPaddingX:l,latest_action:'SET_ACTIVE_FIELD'}}case'UPDATE_ACTIVE_FIELD_RECT':return{...e,activeFieldRect:t.payload,latest_action:'UPDATE_ACTIVE_FIELD_RECT'};case'REMOVE_ACTIVE_FIELD':return{...e,activeField:void 0,activeFieldDir:'ltr',activeFieldPaddingX:0,activeFieldRect:void 0,menuOpen:!1,menuID:void 0,latest_action:'REMOVE_ACTIVE_FIELD'};case'BLOCK_INLINE':return{...e,activeField:void 0,activeFieldDir:'ltr',activeFieldPaddingX:0,activeFieldRect:void 0,locked:!0,menuOpen:!1,menuID:void 0,locale:'en',inlineDisabled:!0,latest_action:'BLOCK_INLINE'};case'UPDATE_LOCK_STATUS':return{...e,locked:t.payload,latest_action:'UPDATE_LOCK_STATUS'};case'UPDATE_INLINE_SETTING':return{...e,inlineDisabled:t.payload,latest_action:'UPDATE_INLINE_SETTING'};case'MENU_DISPLAY_STATUS':return t.payload?{...e,menuOpen:t.payload,latest_action:'MENU_DISPLAY_STATUS'}:{...e,menuOpen:t.payload,menuID:void 0,latest_action:'MENU_DISPLAY_STATUS'};case'UPDATE_MENU_ID':return{...e,menuID:t.payload,latest_action:'UPDATE_MENU_ID'};case'SYNC_INLINE_SETTING':{const{locked:i,inlineDisabled:n,isPasskeySupported:a,isDevToolsOpened:r}=t.payload,l=!i&&t.payload.autoLogin;return{...e,autoLogin:l,inlineDisabled:n,isPasskeySupported:a,isDevToolsOpened:r,latest_action:'SYNC_INLINE_SETTING'}}case'AUTOFILL_IN_OPERATION':return{...e,autofillInOperation:t.payload,latest_action:'AUTOFILL_IN_OPERATION'};case'AUTOLOGIN_IN_EXECUTION':return{...e,autoLoginExecuted:t.payload,latest_action:'AUTOLOGIN_IN_EXECUTION'};case'SET_TAB_URL':return{...e,url:t.payload,latest_action:'SET_TAB_URL'};case'SET_TOGGLMENU_DISPLAY':return{...e,autoDisplayMenu:!e.autoDisplayMenu,latest_action:'SET_TOGGLMENU_DISPLAY'};case'DEVTOOLS_STATE_CHANGED':return{...e,isDevToolsOpened:t.payload};default:return e}}));const X=['text','email','number','password','url','tel','search'];class Z{constructor(){this.shadowRoot=null,this.inlineButton=null,this.positionTimer=null,this.isValuedField=e=>e&&e instanceof HTMLInputElement&&X.includes(e.type),this.createShadowRoot=()=>{if(document.body)return document.createElement('ENPASS-INLINE-BUTTON').attachShadow({mode:'closed'})},this.calculateInlineIconSize=e=>e>=38?24:e<20?12:16,this.getIconURL=e=>{const t=Y.getState().locked?'locked':'unlocked';return m(`icons/icon-${t}.svg`)},this.setStyle=e=>{if(!e||!this.inlineButton||!this.shadowRoot)return;const t=window.getComputedStyle(e),i=e.getBoundingClientRect(),n=i.top,a=i.width,r=i.left,l=i.height,s=this.calculateInlineIconSize(l),o=(l-s)/2,d=parseFloat('rtl'===t.direction?t.paddingLeft:t.paddingRight),u=Math.max(o,d),c=n+o,h=a-s-u,m=r+('rtl'===t.direction?u:h),p=this.getIconURL(s);this.inlineButton.style.cssText=`\n                all: initial;\n                position: fixed;\n                z-index: 2147483647;\n                top: ${c}px;\n                left: ${m}px;\n                min-width: 12px;\n                width: ${s}px;\n                max-width: 24px;\n                min-height: 12px;\n                background-image: url(${p});\n                height: ${s}px;\n                max-height: 24px;\n                background-size: cover;\n                background-repeat: no-repeat;\n                border: none;\n                outline: 0;\n                cursor: pointer;\n            `},this.onClick=e=>{},this.draw=()=>{this.inlineButton=document.createElement('button'),this.shadowRoot=this.createShadowRoot(),this.shadowRoot&&(this.shadowRoot.appendChild(this.inlineButton),this.shadowRoot.addEventListener('mousedown',(e=>{e.stopImmediatePropagation(),e.preventDefault(),this.onClick()})))},this.attach=e=>!(!this.isValuedField(e)||this.inlineButton)&&(this.draw(),this.setStyle(e),!(!this.shadowRoot||this.shadowRoot.host.parentElement)&&(document.body.appendChild(this.shadowRoot.host),this.visibilityTracker.observe(e),this.addScrollResizeEventListener(),!0)),this.dettach=()=>{this.shadowRoot&&this.shadowRoot.host.parentElement&&(this.shadowRoot.host.parentElement.removeChild(this.shadowRoot.host),this.shadowRoot=null,this.inlineButton=null,this.visibilityTracker.disconnect(),this.isScrollResizeListenerActive&&(window.removeEventListener('scroll',this.onScrollOrResize,!0),window.removeEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!1))},this.visibilityTracker=new IntersectionObserver((e=>{e.forEach((e=>{const{width:t,height:i}=e.boundingClientRect;e.isIntersecting&&0!==t&&0!==i||this.dettach()}))})),this.onScrollOrResize=e=>{'MARQUEE'!==e.target.tagName&&this.isScrollResizeListenerActive&&(window.removeEventListener('scroll',this.onScrollOrResize,!0),window.removeEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!1,this.dettach())},this.addScrollResizeEventListener=()=>{this.isScrollResizeListenerActive||(window.addEventListener('scroll',this.onScrollOrResize,!0),window.addEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!0)}}}class J{constructor(){this.events={}}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}emit(e,...t){this.events[e]&&this.events[e].forEach((e=>e(...t)))}}class Q{constructor(){return Q.instance||(this.concealedFields=new WeakSet,Q.instance=this),Q.instance}isConcealerAttached(e){return this.concealedFields.has(e)}trackField(e){this.concealedFields.add(e)}removeFieldTracker(e){this.concealedFields.delete(e)}static getInstance(){return Q.instance||new Q}}class ee extends J{constructor(e){super();const t=Q.getInstance();t.isConcealerAttached(e)||(t.trackField(e),this.inputRef=new WeakRef(e),this.containerRef=[],this.containerRefStyles=new WeakMap,this.overlayContainer=null,this.shadowRoot=null,this.isScrollResizeListenerActive=!1,this.originalStyles={backgroundColor:this.inputRef?.deref()?.style.backgroundColor,color:this.inputRef.deref()?.style.color},this.getBackgroundColor=()=>Ye(document.URL).startsWith('https://www.amazon')?'#555':'#ccc',this.hideContent=e=>{const t=this.inputRef?.deref();if(!t)return!1;t.style.color='transparent',e&&(this.containerRef.push(new WeakRef(e)),this.containerRefStyles.set(e,{color:e.style.color}),e.style.color='transparent',this.resizeTracker=new ResizeObserver((e=>{e.length>0&&this.setStyle()})).observe(e))},this.revealContent=()=>{const e=this.inputRef?.deref();if(!e)return;const{color:t,backgroundColor:i}=this.originalStyles;e.style.backgroundColor=i,e.style.color=t,this.containerRef.forEach((e=>{const t=e?.deref(),i=this.containerRefStyles.get(t);if(i){const{color:e,backgroundColor:n}=i;t.style.backgroundColor=n,t.style.color=e}this.containerRefStyles.delete(t)})),this.containerRef=[]},this.createShadowRoot=()=>{if(document.body)return document.createElement('ENPASS-CONCEALER').attachShadow({mode:'closed'})},this.onClick=e=>{this.dettach()},this.isDarkTheme=()=>{const e=this.getOverlayTarget(),t=e||this.inputRef?.deref(),i=getComputedStyle(t),n=gt(i.getPropertyValue('background-color'));return ft(n)<127.5},this.draw=()=>{this.overlayContainer=document.createElement('div');const e=document.createElement('style');e.textContent='\n                .row {\n                    display: flex;\n                    align-items: center;\n                }\n\n                .icon {\n                    width: 20px;\n                    height: 20px;\n                    margin-right: 15px;\n                    margin-left: 15px;\n                    display: flex;\n                    align-items: center;\n                }\n\n\n                .icon img {\n                    width: 100%;\n                    height: 100%;\n                    object-fit: contain;\n                }\n\n                .dots {\n                    flex-grow: 1;\n                    text-align: left;\n                    color:#212121;\n                }\n\n                .close {\n                    margin-right: 15px;\n                    width: 20px;\n                    height: 20px;\n                    cursor: pointer;\n                    display: flex;\n                    align-items: center;\n                }\n\n                .close img {\n                    width: 100%;\n                    height: 100%;\n                    object-fit: contain;\n                }\n\n                @media (min-height: 14px) and (max-height: 28px) {\n\n                    .dots {\n                        font-size: 12px;\n                     }\n\n                     .icon {\n                         width: 12px;\n                         height: 12px;\n                     }\n\n                     .close {\n                         width: 12px;\n                         height: 12px;\n                     }\n\n                }\n\n                @media (min-height: 29px) and (max-height: 40px) {\n\n                    .dots {\n                        font-size: 16px;\n                     }\n\n                     .icon {\n                         width: 16px;\n                         height: 16px;\n                     }\n\n                     .close {\n                         width: 16px;\n                         height: 16px;\n                     }\n\n                }\n\n                @media (min-height: 41px) {\n\n                    .dots {\n                       font-size: 20px;\n                    }\n\n                    .icon {\n                        width: 20px;\n                        height: 20px;\n                    }\n\n                    .close {\n                        width: 20px;\n                        height: 20px;\n                    }\n\n                }\n\n                /* Width Breakpoints */\n                @media (min-width: 40px) and (max-width: 100px) {\n\n                }\n\n                @media (min-width: 101px) and (max-width: 140px) {\n\n                }\n\n                @media (min-width: 141px) {\n\n                }\n            ';const t=this.isDarkTheme(),i=document.createElement('div');i.classList.add('row');const n=document.createElement('div');n.classList.add('icon');const a=document.createElement('img');a.src=m(`icons/enpass_${t?'white':'blue'}.svg`),a.alt='Icon',a.classList.add('enpass_icon'),n.appendChild(a);const r=document.createElement('div');r.classList.add('dots'),r.textContent='• • • • • • • • • • • • •',i.appendChild(n),i.appendChild(r),this.overlayContainer.appendChild(i),this.shadowRoot=this.createShadowRoot(),this.shadowRoot&&(this.shadowRoot.appendChild(this.overlayContainer),this.shadowRoot.appendChild(e),this.shadowRoot.addEventListener('mousedown',(e=>{e.stopImmediatePropagation(),e.preventDefault(),this.onClick()})))},this.isFieldRemoved=e=>{const{width:t,height:i,x:n,y:a}=e;return 0===t&&0===i&&0===n&&0===a},this.getOverlayTarget=()=>{const e=this.inputRef?.deref();if(!e)return null;const t=Ye(document.URL),i='password'===e.type;if(t.startsWith('https://www.amazon')&&i){const t=e.parentElement;if('auth-password-container'===t?.id)return t}return null},this.getCSSTextString=(e,t,i)=>`width :${e}px; height:${t}px; margin:${i}; color:${this.isDarkTheme()?'#fff':'#333'}; `,this.setStyle=()=>{const e=this.getOverlayTarget(),t=e||this.inputRef?.deref(),i=t?.getBoundingClientRect(),n=i?.top,a=i?.width,r=i?.left,l=i?.height;if(!this.overlayContainer)return;let s=null,o=null;const d=l>28&&l<41?16:l>40?20:12,u=this.overlayContainer.getElementsByClassName('icon'),c=this.overlayContainer.getElementsByClassName('dots'),h=this.overlayContainer.getElementsByClassName('enpass_icon')[0],p=this.isDarkTheme();if(u&&u.length>0&&(s=u[0]),c&&c.length>0&&(o=c[0]),s&&o)if(a<=100)if(s.style.cssText=' display:none',a>40){const e=a<50?2:3;o.textContent=Array(e).fill('•').toString().replaceAll(',',' '),o.style.cssText=`\n                         font-size: ${d}px;\n                         color:${p?'#fff':'#333'};\n                         margin-left:4px\n                         `}else o.style.cssText=' display:none';else if(a>100&&a<=140)s.style.cssText=this.getCSSTextString(d,d,' 0px 6px 0px 6px'),o.textContent=Array(5).fill('•').toString().replaceAll(',',' '),o.style.cssText=`\n                     font-size: ${d}px;\n                     color:${p?'#fff':'#333'};\n                     `;else{s.style.cssText=this.getCSSTextString(d,d,' 0px 8px 0px 8px');const e=a<180?8:12;o.textContent=Array(e).fill('•').toString().replaceAll(',',' '),o.style.cssText=`\n                     font-size: ${d}px;\n                     color:${p?'#fff':'#333'};\n                     `}h.src=m(`icons/enpass_${p?'white':'blue'}.svg`),this.overlayContainer.style.cssText=`\n                    all: initial;\n                    position: fixed;\n                    z-index: 2147483647;\n                    top: ${n}px;\n                    left: ${r}px;\n                    width: ${a}px;\n                    height: ${l}px;\n                    line-height: ${l}px;\n                    background-color:  ${p?'#000':'#F6F6F6'};\n                    color:  ${p?'#fff':'#333'};\n                    border-radius: 4px;\n                    border: none;\n                    outline: 0;\n                    cursor: pointer;\n                    text-align : center;\n                    font-size: 12px;\n                    font-weight: 600;\n                    font-family: 'Arial, sans-serif';\n            `},this.attach=()=>{this.draw();const e=this.getOverlayTarget();return this.setStyle(e),this.hideContent(e),!(!this.shadowRoot||this.shadowRoot.host.parentElement)&&(document.body.appendChild(this.shadowRoot.host),this.addScrollResizeEventListener(),this.visibilityTracker.observe(this.inputRef.deref()),this.setupMutationObserver(),!0)},this.resetFieldValues=()=>{const e=this.inputRef?.deref();e&&(le(e),e.value='',re(e))},this.dettach=(e=!0)=>{this.shadowRoot&&this.shadowRoot.host.parentElement&&(e&&this.emit('instanceRemoved',this.inputRef?.deref()),t.removeFieldTracker(this.inputRef?.deref()),this.shadowRoot?.host&&document.body.removeChild(this.shadowRoot?.host),this.resetFieldValues(),this.revealContent(),this.shadowRoot=null,this.overlayContainer=null,this.inputRef=null,this.visibilityTracker?.disconnect(),this.mutationObserver?.disconnect(),this.resizeTracker?.disconnect(),this.isScrollResizeListenerActive&&(window.removeEventListener('scroll',this.onScrollOrResize,!0),window.removeEventListener('resize',this.onScrollOrResize,!0),window.removeEventListener('focusin',this.onFocus,!0),this.isScrollResizeListenerActive=!1))},this.onScrollOrResize=e=>{'MARQUEE'!==e.target.tagName&&this.setStyle()},this.onFocus=e=>{const{hostname:t}=new URL(document.URL);if(['accounts.google.com'].includes(t))return;const i=this.inputRef?.deref();i&&e.target===i&&this.dettach()},this.addScrollResizeEventListener=()=>{this.isScrollResizeListenerActive||(window.addEventListener('scroll',this.onScrollOrResize,!0),window.addEventListener('resize',this.onScrollOrResize,!0),window.addEventListener('focusin',this.onFocus,!0),this.isScrollResizeListenerActive=!0)},this.visibilityTracker=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.boundingClientRect;this.isFieldRemoved(t)&&this.dettach()}))})),this.setupMutationObserver=()=>{this.mutationObserver=new MutationObserver(this.handleMutation.bind(this)),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0})},this.handleMutation=e=>{for(const t of e)'childList'===t.type&&this.setStyle()},this.attach())}}class te{static fieldInstances=new WeakMap;static inputRefList=[];static manageConcealer(e,t,i){const{isDevToolsOpened:n}=Y.getState();if(t){if(!this.fieldInstances.has(e)&&!n){const t=new ee(e);t.on('instanceRemoved',this.removeInstanceFromMap.bind(this)),this.fieldInstances.set(e,t),this.inputRefList.push(new WeakRef(e)),i()}}else{const t=this.fieldInstances.get(e);t?.dettach(),this.fieldInstances.delete(e),i()}}static removeInstanceFromMap(){this.inputRefList.forEach((e=>{const t=this.fieldInstances.get(e.deref());t?.dettach(!1),this.fieldInstances.delete(e.deref())})),this.inputRefList=[]}}const ie=(e,t)=>{for(var i=e+'';i.length<t;)i='0'+i;return i},ne=(e,t)=>{const i=window.document.createEvent('Events');i.initEvent(e,!0,!0),t.dispatchEvent(i)},ae=(e,t)=>{let i;i=e.ownerDocument?e.ownerDocument.createEvent('HTMLEvents'):document.createEvent('HTMLEvents'),i.initEvent(t,!0,!0),e&&e.dispatchEvent(i)},re=e=>{let t=e.value;ne('input',e),ne('keyup',e),ne('blur',e),ne('change',e),''!==e.value&&e.value===t||(e.value=t)},le=e=>{let t=e.value;ne('click',e),ne('focus',e),ne('keydown',e),''===e.value&&t&&(e.value=t)},se=(e,t)=>{var i=[];e||(e=document);try{i=Array.prototype.slice.call(e.querySelectorAll(t))}catch(e){return[]}return i},oe=e=>(e||(e=document),se(e,'input, select, button , textarea')),de=e=>'string'==typeof e?e.toLowerCase():(''+e).toLowerCase(),ue=(e,t,i)=>{if(!e)return!1;e=(e=e.toLowerCase()).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,'');for(var n=0,a=t.length;n<a;n++){if(-1!==e.indexOf(t[n]))return!0;if(i)if(-1!==e.replace(/\s/gi,'').indexOf(t[n]))return!0}return!1},ce=(e,t,i)=>!!e&&(e=(e=e.toLowerCase()).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,''),t.every((function(t){if(-1!==e.indexOf(t))return!0;if(i&&-1!==e.replace(/\s/gi,'').indexOf(t))return!0;return!1}))),he=e=>e.options?{options:Array.prototype.slice.call(e.options).map((e=>{var t=e.text;return[(t=t?de(t).replace(/\s/gm,'').replace(/[~`!@$%^&*()\-_+=:;'"\[\]|\\,<.>\/?]/gm,''):null)||null,e.value]}))}:null,me=(e,t,i)=>{null!=i&&(e[t]=i)},pe=(e,t)=>e&&t?e.filter((e=>'string'==typeof t?'password'===t?e.htmlType===t||'disc'===e.cssTextSecurity:e.htmlType===t:t.constructor===Array&&-1!==t.indexOf(e.htmlType))):[],fe=e=>{var t=e.ownerDocument,i=t?t.defaultView:{};if('INPUT'===e.tagName&&'hidden'===e.type)return!1;let n=!0;const a=i.getComputedStyle?i.getComputedStyle(e,null):e.style;if(!a)return!0;if('0px'===a.width&&'0px'===a.height)return!1;for(var r;e&&e!==t;){if(e.nodeType!==Node.ELEMENT_NODE)return!0;if(!(r=i.getComputedStyle?i.getComputedStyle(e,null):e.style))return!0;if(('hidden'===r.overflow||'0'===r.opacity)&&'0px'===a.width&&'0px'===a.height)return!1;if('absolute'===r.position&&'rect(1px, 1px, 1px, 1px)'===r.clip)return!1;if('none'===r.display||n&&'hidden'==r.visibility&&'BODY'!==e.tagName)return!1;if('visible'===r.visibility&&(n=!1),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)return!0;e=e.parentNode}return e===t},ge=(e,t)=>{if(!e)return!1;var i=new RegExp(String.fromCharCode(160),'gi');e=(e=(e=(e=e.replace(i,' ')).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,'')).replace(/\s\s+/gi,' ')).trim().toLowerCase();for(var n=t.length;n--;)if(e===t[n])return!0;return!1},be=e=>{if(!e)return!1;var t=e.ownerDocument&&e.ownerDocument.documentElement?e.ownerDocument.documentElement:document,i=e.ownerDocument&&e.ownerDocument.body?e.ownerDocument.body:document.body,n=e.getBoundingClientRect(),a=window.pageXOffset||document.documentElement.scrollLeft,r=window.pageYOffset||document.documentElement.scrollTop,l=n.top+r,s=n.left+a,o=n.right+a,d=n.bottom+r,u=Math.max(i.scrollWidth,i.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth),c=Math.max(i.scrollHeight,i.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight),h=u>0&&c>0&&n.width>0&&n.height>0,m=l<0&&d>4&&d<=c&&h,p=s<0&&o>4&&o<=u&&h,f=s>=0&&s<=u&&h,g=o>=0&&o<=u&&h,b=l>=0&&l<=c&&h,y=d>=0&&d<=c&&h;return!!(b&&f&&g&&y&&h||m&&p||m&&f&&g||p&&b&&y)},ye=e=>{if(!e)return!1;var t,i=e.ownerDocument&&e.ownerDocument.documentElement?e.ownerDocument.documentElement:document,n=e.ownerDocument&&e.ownerDocument.body?e.ownerDocument.body:document.body,a=e.getBoundingClientRect(),r=Math.max(n.scrollWidth,n.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth),l=Math.max(n.scrollHeight,n.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight),s=a.left-i.clientLeft,o=a.top-i.clientTop;if(!fe(e)||!e.offsetParent||10>e.clientWidth||10>e.clientHeight)return!1;var d=e.getClientRects();if(0===d.length)return!1;for(var u=0,c=d.length;u<c;u++)if((t=d[u]).left>r||0>t.right)return!1;if(0>s||s>r||0>o||o>l)return!1;var h,m=s+(a.right>window.innerWidth?(window.innerWidth-s)/2:a.width/2),p=o+(a.bottom>window.innerHeight?(window.innerHeight-o)/2:a.height/2);for(h=e.ownerDocument.elementFromPoint(m,p);h&&h!==e&&e!==document;){const t=h.tagName,i=!!t&&'string'==typeof h.tagName;if(!!t&&'label'===h.tagName.toLowerCase()){if(t&&i&&e.labels&&e.labels.length>0)return Array.prototype.slice.call(e.labels).indexOf(h)>=0;{const t=h.getAttribute('id'),i=e.getAttribute('aria-describedby'),n=e.getAttribute('aria-labelledby');if(t&&(t===i||t===n))return!0}}h=h.parentNode}return h===e},ve=(e,t)=>{let i=e[t];if(i&&'string'==typeof i)return i;if(i&&'disabled'===t&&'boolean'==typeof i)return i;try{i=e.getAttribute(t)}catch(e){}return i&&'string'==typeof i?i:null},we=e=>{var t=null;return e&&(t=0<(t=e.replace(/^\s+|\s+$|\r?\n.*$/gm,'')).length?t:null),t?t.toLowerCase().trim():''},_e=e=>e?e.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,' '):null,Te=e=>{var t,i,n,a=[];if(e&&e.nodeType===Node.ELEMENT_NODE&&e.tagName&&'button'===e.tagName.toLowerCase())return null;if(e.labels&&e.labels.length&&0<e.labels.length)a=Array.prototype.slice.call(e.labels);else{if(e.id&&(a=a.concat(se(e,'label[for='+JSON.stringify(e.id)+']'))),e.name){t=se(e,'label[for='+JSON.stringify(e.name)+']');for(var r=0;r<t.length;r++){var l=t[r];-1===a.indexOf(l)&&a.push(l)}}e.previousElementSibling&&'LABEL'===e.previousElementSibling.tagName&&a.push(e.previousElementSibling);for(var s=e,o=e.ownerDocument;s&&s!=o;s=s.parentNode){var d=e.tagName;'label'===('string'==typeof d?d.toLowerCase():(''+d).toLowerCase())&&-1===a.indexOf(s)&&a.push(s)}}if(n=(i=e.parentNode)&&i.previousElementSibling,i&&i.nodeType===Node.ELEMENT_NODE){if(0===a.length&&'td'===i.tagName.toLowerCase()&&n&&'td'===n.tagName.toLowerCase())try{0===n.querySelectorAll('input,select,textarea').length&&a.push(n)}catch(e){}if(0===a.length&&'dd'===i.tagName.toLowerCase()&&n&&'dt'===n.tagName.toLowerCase())try{0===n.querySelectorAll('input,select,textarea').length&&a.push(n)}catch(e){}}if(a.length>0){var u=a.map((function(e){return fe(e)&&be(e)?(e=>{if(!e)return null;var t=null;return(t=e.textContent||e.innerText)?t=(t=(t=(t=t.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,' ')).replace(/\&lt;br\&gt;/gi,'\n').replace(/(&lt;([^&gt;]+)&gt;)/gi,' ')).replace(/\s/g,' ')).trim().toLowerCase():null})(e):''}));return _e(u.join(''))}return null},Le=(e,t)=>{var i;return!!e&&(i=e?(e.tagName||'').toLowerCase():'',t.constructor===Array?t.indexOf(i)>=0:t===i)},Ie=e=>{var t=!e||void 0===e||Le(e,'select option input form textarea button table iframe body head script a'.split(' '));if(!t){if(Le(e,'label')&&e.hasAttribute('for')){var i=e.getAttribute('for');if(document.getElementById(i)||document.getElementsByName(i)>0)return!0}return!(!e||void 0===e||1!==e.nodeType)&&e.querySelectorAll('select,option,input,form,textarea,button,table,iframe,body,head,script').length>0}return t},Ee=e=>{var t;for(e=e.parentElement||e.parentNode;e&&'td'!==de(e.tagName);)e=e.parentElement||e.parentNode;return e&&void 0!==e?'tr'!==(t=e.parentElement||e.parentNode).tagName.toLowerCase()||!(t=t.previousElementSibling)||'tr'!=(t.tagName+'').toLowerCase()||t.cells&&e.cellIndex>=t.cells.length?null:(t=t.cells[e.cellIndex],Ie(t)?null:(e=we(t.textContent),_e(e))):null},Fe=e=>{var t='';return 3===e.nodeType?t=e.nodeValue:1===e.nodeType&&(t=e.textContent||e.innerText),(t=we(t))?t.toLowerCase():''},De=e=>{var t=[];return xe(e,t),t=t.reverse().join(''),_e(t)},xe=(e,t)=>{for(var i,n;e&&e.previousSibling;)if(!(e=e.previousSibling).tagName||'input'!==e.tagName.toLowerCase()||!e.type||'hidden'!==e.type){if(Ie(e))return'';(n=Fe(e))&&t.push(n)}if(e&&0===t.length)for(i=null;!i;){if(!(e=e.parentElement||e.parentNode)||'FORM'===e.tagName)return;for(i=e.previousSibling;i&&!Ie(i)&&i.lastChild;)i=i.lastChild}Ie(i)||((n=Fe(i))&&t.push(n),0===t.length&&xe(i,t))},Ne=e=>{for(var t=[],i=e;i&&i.nextSibling&&(i=i.nextSibling,!Ie(i));)t.push(Fe(i));return _e(t.join(''))},Ae=e=>e?e.filter((function(e){return'hidden'!==e.htmlType})):[],Ce=(e,t)=>{if(!e)return!0;if(e.isOutsideDocument)return!0;let i=0,n=/(?:answer.*(?:security|hint|secret|challenge))|(?:(?:security|hint|secret|challenge).*answer)|(?:e.?mail.*alert)|gift|promo|coupon|maiden|comment|messageq|search|keyword|ordercode|newsletter|conditions|captcha|imageword|subscribe|txtspamcheck|turing|anti_spam_code|invoice|(?:PO\\s*#)|(?:purchase.*order)|(?:customer\\s*po)|(?:referrer)|(?:redress)|voucher|discount.*code|promo.*code|campaign.*code|(image\S?code)|smscode/i;const a=/((confirm|re[-_\s]?enter|re[-_\s]?type)[-_\s]?email)|(email[-_\s]?confirm)/i;document.URL.includes('rakuten-bank.com')||(n=new RegExp(n.source+'|(?:^|[^i])pcode','i')),t||'button'===e.htmlType||(n=new RegExp(n.source+'|'+a.source,'i')),i+=n.test(e.htmlName)?10:0,i+=n.test(e.htmlID)?10:0,i+=n.test(e.htmlTitle)?5:0,i+=n.test(e.htmlPlaceholder)?5:0;let r=0;return e.htmlLabel&&'button'!==e.htmlType?r+=!r&&n.test(e.htmlLabel)?10:0:'button'!==e.htmlType&&(r+=!r&&e?.labelData?.length<50&&n.test(e.labelData)?5:0,r+=!r&&e?.labelAria?.length<50&&n.test(e.labelAria)?5:0,e.htmlPlaceholder||r||(r+=!r&&e?.labelTop?.length<50&&n.test(e.labelTop)?5:0,r+=!r&&e?.labelRight?.length<50&&n.test(e.labelRight)?5:0,r+=!r&&e?.labelLeft?.length<50&&n.test(e.labelLeft)?5:0)),i+=r,i>0},Se=(e,t)=>{if(!e||0===e.length)return[];let i=[];for(let n,a=0,r=e.length;a<r;a++)n=e[a],Ce(n,t)||i.push(n);return i},Oe=e=>{var t=[];if(!e)return t;for(var i=0,n=e.length;i<n;i++){let n=e[i],a=n.htmlType;n.visible&&'button'!==a&&'submit'!==a&&'reset'!==a&&t.push(n)}return t},ke=(e,t)=>{var i=[];if(!e)return i;for(var n=0,a=e.length;n<a;n++)t?e[n].visible||i.push(e[n]):!e[n].visible||e[n].tabindex&&'-1'===e[n].tabindex||i.push(e[n]);return i},Pe=e=>e?window.getComputedStyle(e).webkitTextSecurity:null,Me=(e,t,i)=>{if(!e)return null;var n={};if('reset'===de(e.type))return null;var a=-1==e.maxLength?999:e.maxLength;if((!a||'number'==typeof a&&isNaN(a))&&(a=999),me(n,'htmlID',ve(e,'id')),me(n,'htmlName',ve(e,'name')),(n.htmlID&&(n.htmlID.includes('ajax')||n.htmlID.includes('csrf'))||n.htmlName&&(n.htmlName.includes('csrf')||n.htmlName.includes('ajax')))&&'password'!==e.type)return null;n.visible=fe(e),n.viewable=ye(e),n.isOutsideDocument=!be(e),n.hasForm=!!e.form,n.cssTextSecurity=Pe(e);let r=ve(e,'data-enpassid');r&&!i?n.elementNumber=r:n.pointer=e,!r&&t>=0&&!i&&(n.elementNumber=`__${t}`),me(n,'htmlClass',ve(e,'class')),me(n,'tabindex',ve(e,'tabindex')),me(n,'htmlTitle',ve(e,'title')),me(n,'userEdited',!!e.dataset.enpassusermodified),me(n,'rel',ve(e,'rel')),me(n,'htmlType',de(ve(e,'type'))),me(n,'actualType',e.getAttribute('type')),me(n,'enpassType','password'===n.htmlType?'password2':'text'),e.tagName&&'button'===e.tagName.toLowerCase()?me(n,'htmlValue',(e.textContent||e.value).trim()):me(n,'htmlValue',e.value||e.textContent),n&&n.htmlType&&'image'===n.htmlType&&(me(n,'imageAlt',ve(e,'alt')),me(n,'imageSrc',ve(e,'src'))),me(n,'checked',e.checked),me(n,'autoCompleteType',e.getAttribute('x-autocompletetype')||e.getAttribute('autocompletetype')||e.getAttribute('autocomplete')),me(n,'disabled',e.disabled),me(n,'readonly',e.readonly),me(n,'selectOption',he(e)),me(n,'aria-hidden','true'==e.getAttribute('aria-hidden')),me(n,'aria-disabled','true'==e.getAttribute('aria-disabled')),me(n,'aria-haspopup','true'==e.getAttribute('aria-haspopup')),me(n,'data-unmasked',e.dataset.unmasked),me(n,'data-stripe',ve(e,'data-stripe'));var l=de(e.type);if('hidden'!==l&&'submit'!==l){me(n,'htmlLength',a),me(n,'htmlLabel',Te(e)),me(n,'labelData',ve(e,'data-label')),n.labelData||me(n,'labelData',ve(e,'label')),me(n,'labelAria',ve(e,'aria-label')),me(n,'labelAttr',ve(e,'label')),me(n,'labelTop',Ee(e)),me(n,'labelRight',Ne(e)),me(n,'labelLeft',De(e));let t=ve(e,'placeholder');t&&!/^\d{2}\/\d{2}\/\d{4}$/.test(t)&&me(n,'htmlPlaceholder',t);!(n.htmlLabel||n.labelAria||n.labelData||n.labelTop||n.labelRight||n.labelLeft)&&!t&&'input'===e.tagName.toLowerCase()&&n.htmlValue&&(t=n.htmlValue)}return n},Re=(e,t,i)=>{e||(e=document);var n={},a=oe(e).map(((e,a)=>{var r=Me(e,a,i);if(!r)return null;var l='__'+a;return t&&(n[l]=e),e.setAttribute('data-enpassid',l),r.elementNumber=l,r}));return t&&n&&Object.keys(n).length>0&&(window.enpass||(window.enpass={}),window.enpass[t]=n),a.filter((e=>null!==e))},Ue=(e,t)=>{if(!e)return null;for(var i=[],n=0,a=e.length;n<a;n++){var r={},l=e[n],s=l.getAttribute('action'),o=l.getAttribute('id'),d=l.getAttribute('name'),u=l.getAttribute('method');'string'==typeof s&&''!==s&&(r.htmlAction=s),'string'==typeof o&&''!==o&&(r.htmlID=o),'string'==typeof d&&''!==d&&(r.htmlName=d),'string'==typeof u&&''!==u&&(r.htmlMethod=u),t.length>0&&t[n]&&(r.fields=t[n]),r.location=l.ownerDocument.URL,r.domain=l.ownerDocument.domain;const a=l.parentElement;a&&(r.parentVisibility=ye(a)),i.push(r)}return i},Ve=(e,t)=>{var i=null;if(e&&e.pointer&&e.pointer.nodeType===Node.ELEMENT_NODE)return e.pointer;if(e&&e.elementNumber){if(window.enpass&&window.state&&window.state.uuid&&window.enpass[window.state.uuid]){let t=window.enpass[window.state.uuid];t&&(i=t[e.elementNumber])}if(i)return i;i=t?t.querySelector('[data-enpassid='+e.elementNumber+']'):document.querySelector('[data-enpassid='+e.elementNumber+']')}if(e&&e.htmlID&&!i&&(i=t?t.getElementById(e.htmlID):document.getElementById(e.htmlID)),e&&e.identifier&&!i){const[t,n,a,r,,,l,s,o,,,,,,,,,,d]=e.identifier.split('||'),u=a,c='input'===t.toLowerCase()&&u?`${t}[type=${u}]`:`${t}`;if((i=Array.prototype.slice.call(document.querySelectorAll(`${c}`))[r])&&i.nodeType===Node.ELEMENT_NODE){const e=Me(i);if(!e)return null;let a=!0;s&&s!==e.autoCompleteType&&(a=!1),l&&l!==e.htmlPlaceholder&&(a=!1),o&&o!==e.htmlLabel&&(a=!1),'button'!==t&&'submit'!==n||d===e.htmlValue||(a=!1),i=a?i:null}}return i&&i.nodeType&&i.nodeType===Node.ELEMENT_NODE?i:null},ze=(e,t)=>{var i=null,n=null;return e&&e.hasForm&&(n=Ve(e,t))&&(i=n.form),i},Be=(e,t)=>{var i=[],n=[],a=[],r=[];if(!e)return null;for(var l=0,s=e.length;l<s;l++){var o=e[l],d=null,u=null;o.htmlType&&'hidden'===o.htmlType||(o.hasForm?(d=ze(o,t),-1===(u=i.indexOf(d))&&d?(i.push(d),n[u=i.length-1]?n[0].push(o):n.push([o])):n[u].push(o)):a.push(o))}i.length>0&&(r=Ue(i,n));var c={};return r.length&&(c.pageForms=r),a.length&&(c.pageFields=a),Object.keys(c).length?c:null},We=(e,t,i)=>{if(e&&0===e.length)return null;for(var n=null,a=-1,r=0;r<e.length;++r){var l=t(e[r]);l>0&&l>a&&(a=l,n=e[r])}return i?{score:a,result:n}:n},je=(e,t)=>e&&t?(Object.keys(t).forEach((i=>{e[i]=t[i]})),e):e||null,qe=e=>{if(!e)return!1;var t=document.createEvent('UIEvent');return/Edge\/\d./i.test(navigator.userAgent)?t.initEvent('submit',!0,!0):t.initEvent('submit',!0,!0,window,1),e.dispatchEvent(t),!0},$e=(e,t)=>{if(!e||''===e)return!1;let i=e.replace(/^\s+/m,'').replace(/\s+$/m,'').replace(/\s\s+/,' ').toLowerCase().trim();return t.some((t=>'function'==typeof t.test?t.test(e)||t.test(i):0<=i.indexOf(t)))},He=(e,t)=>{if(e&&t){var i=parseInt(e.elementNumber.substr(2));if(parseInt(t.elementNumber.substr(2))>i)return!0}return!1},Ke=()=>{let e=document.getElementById('recaptcha-token');if(e&&'hidden'===e.type)return!0;let t=Array.prototype.slice.call(document.querySelectorAll('img[src *= captcha]'));if(t&&!t.length&&(t=Array.prototype.slice.call(document.querySelectorAll('img[id *= captcha]'))),t&&t.length>0){let e=t.filter((e=>!!fe(e)&&!('number'==typeof e.width&&e.width<30)));if(e&&e.length>0)return!0}let i=Array.prototype.slice,n=i.call(document.querySelectorAll('input[name*=captcha]')),a=i.call(document.querySelectorAll('input[name*=Captcha]')),r=n.concat(a);if(r&&r.length>0){let e=r.filter((function(e){return fe(e)}));if(e&&e.length>0)return!0}let l=document.getElementById('captcha');if(l&&fe(l))return!0;let s=document.querySelector('iframe[src^="https://www.google.com/recaptcha/api2/anchor"]');if(s&&s.width>0&&s.height>0&&fe(s)){var o=1===s.offsetParent.classList.length&&'grecaptcha-badge'===s.offsetParent.classList[0],d=1===s.parentNode.classList.length&&'grecaptcha-logo'===s.parentNode.classList[0];return!('fixed'===s.offsetParent.style.position||'fixed'===s.parentNode.style.position||256===s.width&&60===s.height&&o&&d)}return!1},Ge=e=>{const t=['otp','one-time','one time password'],i=['otp','password'];let n=0,a=0;if(e){if('password'!==e.htmlType)return!1;if(n+=e.htmlPlaceholder&&ce(e.htmlPlaceholder,i)?100:0,n+=e.htmlLabel&&ce(e.htmlLabel,i)?100:0,n+=e.htmlID&&ce(e.htmlID,['otpwd'])?100:0,n+=e.htmlName&&ce(e.htmlName,['otpwd'])?100:0,n>0)return!1;if(a+=e.htmlPlaceholder&&ue(e.htmlPlaceholder,t)?100:0,a+=e.htmlID&&ue(e.htmlID,t)?100:0,a+=e.htmlName&&ue(e.htmlName,t)?100:0,a+=e.htmlLength&&e.htmlLength<=4&&-1!==e.htmlLength?100:0,a+=e.htmlLabel&&ue(e.htmlLabel,t)?100:0,a>0)return!0}return!1},Ye=e=>{if(e)try{return new URL(e).origin}catch(e){return''}return''},Xe=e=>{if(e)try{return new URL(e).hostname}catch(e){return''}return''},Ze=e=>{if(e){return new URL(e).pathname}return''},Je=e=>{var t=e.totp_1,i=e.totp_2,n=e.totp_1_valid,a=e.totp_2_valid,r=Math.round((new Date).getTime()/1e3);return n-r>0?t:a-r>0?i:null},Qe=e=>{if(!e)return!1;const t=(e.htmlLabel||'').toLowerCase(),i=(e.htmlID||'').toLowerCase(),n=(e.htmlName||'').toLowerCase(),a=(e.htmlPlaceholder||'').toLowerCase();if('email'===e.htmlType){if(t.includes('email')||t.includes('e mail address'))return!0;if(e.labelAria&&-1!==e.labelAria.toLowerCase().indexOf('email'))return!0}if(/mobile|username/i.test(t))return!1;if(i&&i.includes('email'))return!0;if(n&&n.includes('email'))return!0;if(t.includes('email'))return a.includes('email'),!0;return!(!a.includes('email')&&!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a))},et=e=>{var t=Re(null,e);if(!t||0==t.length){var i=(()=>{var e=[];try{for(var t=[document];t.length>0;){var i=t.shift().querySelectorAll('*');for(let n=0,a=i.length;n<a;n++){let a=i[n];a.shadowRoot&&(t.push(a.shadowRoot),e.push(a.shadowRoot))}}}catch(e){return[]}return e})();t=[];for(let e=0,n=i.length;e<n;e++){let n=Re(i[e],null,!0);t=t.concat(n)}}return{fieldDict:t,formDict:Be(t)}},tt=e=>{if(!e)return null;let t={};const i=e.getAttribute('action'),n=e.getAttribute('id'),a=e.getAttribute('name'),r=e.getAttribute('method');if('string'==typeof i&&''!==i&&(t.htmlAction=i),'string'==typeof n&&''!==n&&(t.htmlID=n),'string'==typeof a&&''!==a&&(t.htmlName=a),'string'==typeof r&&''!==r&&(t.htmlMethod=r),!ot()){const i=new URL(e.ownerDocument.URL);t.location=i.href,t.pathname=i.pathname,t.hostname=i.hostname,t.domain=e.ownerDocument.domain}return t},it=e=>{if(!e)return null;let t={};const i=tt(e),n=Array.prototype.slice.call(e.elements);if(n&&n.length>0){let e=[];for(let t=0,i=n.length;t<i;t++){let i=Me(n[t],t);i&&e.push(i)}t.fields=e}return i?{...t,...i}:t},nt=(e,t,i)=>{if(e){var n=Ve(e);n&&t&&te.manageConcealer(n,i,(()=>at(n,t)))}},at=(e,t,i)=>{if(e&&e.value!==t&&e&&t)if(document.domain?.endsWith('apple.com')||document.domain?.endsWith('hackerrank.com'))e.focus(),e.value=t,e.dispatchEvent(new KeyboardEvent('keydown',{bubbles:!0,cancelable:!0})),e.dispatchEvent(new KeyboardEvent('keypress')),e.dispatchEvent(new KeyboardEvent('keyup')),e.dispatchEvent(new Event('input',{bubbles:!0,cancelable:!0})),e.dispatchEvent(new Event('change',{bubbles:!0,cancelable:!0}));else{'www.prosperitybankusa.com'!==Xe(document.URL)&&le(e),e.value=t,re(e)}},rt=e=>{if(e){if(-1!==['div','a','input','button','span'].indexOf(e.tagName.toLowerCase())){if('input'===e.tagName.toLowerCase()){if('submit'!==e.type&&'button'!==e.type)return!1}else{if('a'===e.tagName.toLowerCase())return!e.hasAttribute('aria-selected');if('span'===e.tagName.toLowerCase()){for(let t=0;t<3;t++)if(e=e.parentElement,-1!==['div','a','input','button'].indexOf(e.tagName.toLowerCase())){if('input'!==e.tagName.toLowerCase())return!0;if('submit'!==e.type&&'button'!==e.type)return!1}return!1}}return!0}return!1}},lt=e=>{let t=document.querySelectorAll('input[data-enpassusermodified][type=password]');0===t.length&&(t=Array.prototype.slice.call(document.querySelectorAll('input[type=password]')).filter((e=>e.value)));let i=!1;if(t&&t.length>0)for(let n=0,a=t.length;n<a;n++){let a=t[n],r=a?a.form:null;if(r&&r.contains(e))return!0;if(4===a.compareDocumentPosition(e))return!0;i=!0}return i},st=(e,t,i)=>{if(!e||!t||'string'!=typeof t||i&&'string'!=typeof i)return null;let n=e;for(let e=0;e<5;e++){const e=n.parentNode;if(!e||e.nodeType!==Node.ELEMENT_NODE||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE||'body'===e.tagName.toLowerCase())return null;let a;if(t&&(a=i?e?.querySelectorAll(`${t}[type=${i}]`):e?.querySelectorAll(`${t}`)),a.length>0)return Array.prototype.slice.call(a);n=e}return null},ot=()=>null==self.origin||'null'===self.origin,dt=e=>{if(!e)return!1;const t=e.some((e=>0===e?.indexOf('https://'))),i='http:'===document.location.protocol,n=document.querySelectorAll('input[type=password]');return t&&i&&n.length>0},ut=e=>{if(!e||!e.domain)return!1;const t=e.domain,i=document.URL;return ct(i,t)},ct=(e,t)=>{if(!t||!e)return!1;const i=new URL(e),n=i.hostname,a=i.host;for(let e=0,i=t.length;e<i;++e){let i=t[e];if(!i)continue;const r=ht(n,[i])||ht(i,[n]),l=ht(a,[i])||ht(i,[a]);if(r||l)return!0}return!1};function ht(e,t){if(e&&t&&Array.isArray(t)){e=mt(e);for(let i=t.length;i--;){let n=t[i];if(e===mt(n)||n.endsWith('.'+e))return!0}}return!1}function mt(e){return e&&0===e.indexOf('www.')?e.substring(4):e}const pt=()=>{const e=Xe(document.URL);return e&&e.endsWith('enpass.io')&&e.startsWith('console')};const ft=({r:e,g:t,b:i})=>Math.sqrt(e*e*.299+t*t*.587+i*i*.114),gt=e=>{const t=e.match(/^oklab\(\s*([+-]?\d*\.?\d+)\s+([+-]?\d*\.?\d+)\s+([+-]?\d*\.?\d+)(\s*\/\s*([+-]?\d*\.?\d+)\s*)?\)$/i);if(t){const i=function(e,t,i){const n=Math.pow(e+.3963377774*t+.2158037573*i,3),a=Math.pow(e-.1055613458*t-.0638541728*i,3),r=Math.pow(e-.0894841775*t-1.291485548*i,3);return{r:4.0767416621*n-3.3077115913*a+.2309699292*r,g:-1.2684380046*n+2.6097574011*a-.3413193965*r,b:-.0041960863*n-.7034186147*a+1.707614701*r}}(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));e=function(e,t,i){const n=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055;return{r:Math.round(255*Math.max(0,Math.min(1,n(e)))),g:Math.round(255*Math.max(0,Math.min(1,n(t)))),b:Math.round(255*Math.max(0,Math.min(1,n(i))))}}(i.r,i.g,i.b)}else if(e.startsWith('#'))e=(e=>{e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,i,n)=>t+t+i+i+n+n));const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null})(e);else{const t=e.match(/\d+/g),i=parseInt(t[0],10),n=parseInt(t[1],10),a=parseInt(t[2],10),r=parseInt(t[3],10);e=0===i&&0===n&&0===a&&0===r?{r:255,g:255,b:255}:{r:parseInt(t[0],10),g:parseInt(t[1],10),b:parseInt(t[2],10)}}return e},bt=e=>{let t=0;const i='current password,current,old,old password,altes passwort,aktuelles passwort,bisheriges passwort'.split(',');var n=/(current|old|curpass|password)/i;if(e&&'password'===e.htmlType&&!e.isOutsideDocument){var a=0,r=/(new|confirm|verify|retype|again|re\s?enter)[\s\W_]?(password)/i;a+=r.test(e.htmlName)?10:0,a+=r.test(e.htmlID)?10:0,a+=r.test(e.htmlClass)?5:0,a+=r.test(e.htmlTitle)?5:0,a+=r.test(e.htmlPlaceholder)?5:0,a+=r.test(e.htmlLabel)?5:0,a+=r.test(e.autoCompleteType)?5:0;var l=0;return l+=!l&&ue(e.htmlLabel,i)?20:0,l+=!l&&ge(e.htmlLabel,['password'])?10:0,e.htmlLabel&&0===l&&a>0?0:(t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,e.htmlPlaceholder&&(t+=ge(e.htmlPlaceholder,i)?10:0),l+=l||e.htmlPlaceholder||!ue(e.labelTop,i)?0:5,l+=l||e.htmlPlaceholder||!ue(e.labelRight,i)?0:5,l+=l||e.htmlPlaceholder||!ue(e.labelLeft,i)?0:5,l+=l||e.htmlPlaceholder||!ue(e.labelData,i)?0:5,t+(l+=l||e.htmlPlaceholder||!ue(e.labelAria,i)?0:5))}return t},yt=(e,t)=>{var i=0,n='new,new password,enter new password,neues passwort,your new password,neues kennwort'.split(','),a=/(new|logon|password1)/i;if(e&&'password'===e.htmlType&&!e.isOutsideDocument){var r=0,l=/(confirm|current|old.*pass|pass.*old|curpass|verify|retype|again|signup|re\s?enter)/i;r+=l.test(e.htmlName)?10:0,r+=l.test(e.htmlID)?10:0,r+=l.test(e.htmlClass)?5:0,r+=l.test(e.htmlTitle)?5:0,r+=l.test(e.htmlPlaceholder)?5:0,r+=l.test(e.autoCompleteType)?5:0;let o=l.test(e.htmlLabel)?5:0;r+=o;var s=0;return s+=!s&&ge(e.htmlLabel,n)?20:0,s+=!s&&ue(e.htmlLabel,n)?10:0,e.htmlLabel&&(0===s&&r>0||s>0&&o>0)?0:(t&&(s+=!s&&ge(e.htmlLabel,['password'])?10:0,s+=!s&&ge(e.labelLeft,['password'])?10:0),i+=a.test(e.htmlName)?10:0,i+=a.test(e.htmlID)?10:0,i+=a.test(e.htmlClass)?5:0,i+=a.test(e.htmlTitle)?5:0,i+=ue(e.autoCompleteType,n)?10:0,e.htmlPlaceholder&&(i+=ge(e.htmlPlaceholder,n)?10:0),s+=s||e.htmlPlaceholder||!ue(e.labelTop,n)||l.test(e.labelTop)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelRight,n)||l.test(e.labelRight)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelLeft,n)||l.test(e.labelLeft)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelData,n)||l.test(e.labelData)?0:5,i+(s+=s||e.htmlPlaceholder||!ue(e.labelAria,n)||l.test(e.labelAria)?0:5))}return i},vt=e=>{var t=0,i=[/(confirm|verify|reenter|repeat|retype).+?(new)?.*?(password)/i,/(new)?.*?(password).*?(confirm|verify|reenter|repeat|retype)/i,'new password confirmation','retype new','re enter','neues passwort erneut eingeben','neues passwort wdh','passwort wiederholen','password again','kennwort wiederholen','save new password'],n=/(confirm|re[\W\s]?enter|verify|retype|again|password2|passwort2|repeat)/i;if(e&&'password'===e.htmlType&&!e.isOutsideDocument){t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,e.htmlPlaceholder&&(t+=$e(e.htmlPlaceholder,i)?10:0);var a=0;return a+=!a&&$e(e.htmlLabel,i)?10:0,a+=a||e.htmlPlaceholder||!$e(e.labelTop,i)?0:5,a+=a||e.htmlPlaceholder||!$e(e.labelRight,i)?0:5,a+=a||e.htmlPlaceholder||!$e(e.labelLeft,i)?0:5,a+=a||e.htmlPlaceholder||!$e(e.labelData,i)?0:5,t+(a+=a||e.htmlPlaceholder||!$e(e.labelAria,i)?0:5)}return t},wt=e=>{var t=0,i='reset password,save changes,change password,save,update,save password,update password,update changes,passwort ändern'.split(','),n=/(save|update|change)/i;return!e||e.isOutsideDocument||'submit'!==e.htmlType&&'button'!==e.htmlType||(t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,e.htmlValue&&(t+=ge(e.htmlValue,i)?10:0)),t},_t=(e,t,i)=>{var n=We(e,(function(e){return t(e,i)}));return null!==n&&t(n,i)>0?n:null},Tt=e=>{if(e&&0!==e.length){let a=_t(e,bt),r=_t(e,yt);!r&&a&&(r=_t(e,yt,!0)),r&&JSON.stringify(a)===JSON.stringify(r)&&(r=null);var t=_t(e,vt),i=_t(e,wt),n={};return a&&(n.currentPasswordField=a),r&&(n.newPasswordField=r),t&&(n.confirmPasswordField=t),t&&!a&&!r&&i&&(r=_t(e,yt,!0),r&&(n.newPasswordField=r)),!r&&a&&t&&(n.currentPasswordField=null,n.newPasswordField=a),!r&&!a&&t||!r&&!t?null:(i&&(n.changePasswordButton=i),Object.keys(n).length?n:null)}return null},Lt=e=>e?e.reduce((function(e,t){const i=ke(t.fields),n=i.filter((function(e){return!(e.disabled||e.isOutsideDocument||'password'!==e.htmlType&&'text'!==e.htmlType&&'email'!==e.htmlType&&'phone'!==e.htmlType)}));if(n&&n.length){let a=n.length,r=pe(n,'password');if(0===a)return e;if(a>3)if(3!==r.length){if(2!==r.length)return e}else{if(!r.every((function(e){let t=Ve(e);return t&&ye(t)&&fe(t)})))return e}else{if(!(2===r.length&&(()=>{const e=i.filter((e=>'submit'===e.htmlType&&!e.isOutsideDocument));if(1===e.length&&e[0].htmlValue){const i=e[0].htmlValue.toLowerCase();let n=['save','update','reset password'];if(t&&t.htmlAction){const e=t.htmlAction;ue(e,'resetpassword')&&(n=n.concat(['submit']))}if($e(i,n))return!0}return!1})()||a===r.length))return e}const l=je(t,Tt(i));return e.push(l),e}return e}),[]):[],It=e=>{var t=0;if(!e)return t;var i=/(update|change|security)/i,n=/(log|sign)\s?[io]n|sign[\s-]?up|access|reg|create|anmelden|(sign|log)\s[^\s]+\sin|(.*)(sign|log)[^\s]in(.*)/i,a=/update|save/i;if(e.htmlID){let t=document.getElementById(e.htmlID),i=t?t.getElementsByTagName('a'):[],n=/forgot(ten)?\Wpassword/gi;const a=e.currentPasswordField&&e.newPasswordField&&e.confirmPasswordField;for(let e=0,t=i.length;e<t;e++){let t=i[e],r=t.textContent?t.textContent.toLowerCase():'';if(!a&&n.test(r))return-1e3}}var r,l=(r=e.fields)?r.filter((e=>'button'===e.htmlType||'submit'===e.htmlType)):[],s=pe(e.fields,'password');var o=0;const d=!!(3===Oe(e.fields).length&&e.currentPasswordField&&e.newPasswordField&&e.confirmPasswordField);if(l&&l.length>0&&!d)for(var u=0,c=l.length;u<c;u++){let e=l[u];if(1===s.length){var h=/(log|sign)\s?[io]n|access|reg|create|continue|anmelden|(sign|log)\s[^\s]+\sin|(.*)(sign|log)[^\s]in(.*)/i;o+=h.test(e.htmlName)&&!a.test(e.htmlName)?2:0,o+=h.test(e.htmlID)&&!a.test(e.htmlID)?2:0,o+=h.test(e.htmlValue)&&!a.test(e.htmlValue)?2:0}else o+=n.test(e.htmlName)&&!a.test(e.htmlName)?2:0,o+=n.test(e.htmlID)&&!a.test(e.htmlID)?2:0,o+=n.test(e.htmlValue)&&!a.test(e.htmlValue)?2:0;if(o>0)return-1e3}var m=pe(e.fields,['checkbox']);if(m&&m.length>0){let e=/remember\s?me/i;for(let t=0,i=m.length;t<i;t++){var p=m[t];let i=0;if(i+=e.test(p.htmlName)?2:0,i+=e.test(p.htmlID)?2:0,i+=e.test(p.htmlValue)?2:0,i+=e.test(p.htmlLabel)?2:0,i>0)return-1e3}}if(t+=e.currentPasswordField?2:0,t+=e.newPasswordField?2:0,t+=e.confirmPasswordField?2:0,(t+=t>0&&e.changePasswordButton?2:0)>0){o+=n.test(e.htmlName)?2:0,o+=n.test(e.htmlID)?2:0,o+=n.test(e.htmlClass)?2:0;let a=Oe(e.fields).length;if(0===document.URL.indexOf('https://tracker.censhare.de')&&void 0!==e.parentVisibility&&!e.parentVisibility)return-1e3;if(3===a&&e.currentPasswordField&&e.newPasswordField&&e.confirmPasswordField&&(o=0),o>0)return-1e3;t+=i.test(e.htmlName)?2:0,t+=i.test(e.htmlID)?2:0,t+=i.test(e.htmlClass)?2:0}return t},Et=e=>{e&&0!==e.length||(e=Re());var t=null;if(e){var i=null;if(e.constructor===Array?i=Be(e):e instanceof Object&&(i=e),i&&i.pageForms&&i.pageForms.length){var n=Lt(i.pageForms);if(n&&n.length>0&&(t=We(n,It))&&It(t)>0)return t}if(i&&i.pageFields&&i.pageFields.length){const e=Tt(i.pageFields);if(e){const{newPasswordField:t,currentPasswordField:i,changePasswordButton:n}=e;if(t&&t.visible&&i&&i.visible||t&&t.visible&&n&&n.visible)return e}}}return null},Ft=[/^\W*(log|sign)\W*[oi]n\W*$/i,/^(bt).?\W*(log|sign)\W*[oi]n\W*$/i,/log\W*[oi]n (?:securely|now)/i,/(sign|log)\s[^\s]+\sin|(.*)(sign|log)[^/s]in(.*)/i,'continue','submit','weiter','accès','вход','connexion','entrar','anmelden','accedi','valider','登录','登入','ログイン','登 录','लॉग इन करें','einloggen','inloggen','ingresar','giriş','zaloguj','σύνδεση','kirjaudu','prijava','aceptar','me connecter','execute login','logga in','bejelentkezés','přihlásit','anmeldung','συνδεση','doorgaan'],Dt=['choose a strong password','使用者代碼','user code'],xt=['creditcard','dc-form','cc-form','creditcard-form','debitcard-form','creditcard-payment-form','debitcard-payment-form','payment'],Nt=['debit card number','credit card number','card number','credit card no','debit card no','card no','numar card','numéro de carte'],At=['creditcard','crdnumbr','card_number','cardnumber','creditcardnumber','cccardnumber','debitcardnumber','dccardnumber','ccnumber','cardno','card_no','cc-number','cardnum','ccnum','cc_no','ccno','dcnum'],Ct=['cvv','cvv2','cvc2','cvc','cvv number','verification code','security code','code de sécurité'],St=['cc-csc','cardcvc','cvc','cv2_number','ccvnumber','ccvnum','cvvvnum','verifycardcode','cardverificationcode','dccvv','cccvv','security_code','security-code','cardsecuritycode','securitycode','cc.security','cvc_code','cvccode','cccode','cvv','cvv2','cvv2/cvc2','cvv/cvc','cardcsc','vccpincode'],Ot=['crdexpr','card_exp_month','expmonth','expirymonth','expirationmonth','ccexpirymonth','ccexpymonth','dcexpirymonth','dcexpymonth','card_month','cardmonth','month','debitmonth','expdate_month','exmnth','cc_valid_month','cardexpirymonth','enddate','end-month','end_month','cc-exp-month','ccexpmon','vccmonth','vdcmonth','month_vcc','month_vdc'],kt=['crdexpr','card_exp_year','expyear','expiryyear','expirationyear','ccexpiryyear','ccexpyyear','dcexpiryyear','dcexpyyear','creditcard_year','card_year','cardyear','year','debityear','expdate_year','exyr','cc_valid_year','cardexpiryyear','enddate','end-year','end_year','cc-exp-year','ccexpyr','vccyear','vdcyear','year_vdc','year_vcc','expyr'],Pt=['expires','expiry year','expiry month','expiry year','expiry date','expiry','expiration date','valid thru','valid to','end date','valid till'],Mt=['expiry','expiration','card-expiration','expirationdate','expiration_date','expiration-date','expdate','exp_date','ccvaliddate','cc-valid-date','cc_valid_date','enddate','end_date','end-date','cc_exp_date','ccexpdate','cc-exp-date','crdexpr'],Rt=['cardholder\'s name','card holder\'s name','cardholder name','card holder name as it appears on card','card holders name','cardholder','name on card','name as on card','name on credit card','name on the card','name on debit card','card owner','card holder name','nume titular card','nom sur la carte'],Ut=['cc-name','card-holder','name-card','name_card','namecard','bill_name','vccname','ccname','dcname','cname','name_on_card','nameoncard','creditcardname','card_name','cardname','cardholder','cardholdername','card_holder_name','card_holder','cardowner','card_owner'],Vt=['creditcardtype','cardtype','type','type_of_card'],zt=['card type','credit card type','payment type'],Bt=['birthdate','birthday_month','birthday_year','birthday','startdate','startmonth','startyear','start_month','monthstart','month_start','yearstart','year_start','start_year','start_date','registration','register'],Wt='january,february,march,april,may,june,july,august,september,october,novemeber,december'.split(','),jt='jan,feb,mar,apr,may,june,july,aug,sept,oct,nov,dec'.split(','),qt=(e,t,i)=>{var n=2,a=.5;i||(n=10,a=5);var r=0,l=0;if(!e)return 0;if(e.constructor===Array){if(0===e.length)return 0;for(var s=0;s<e.length;++s)if(ge(e[s].toLowerCase(),t)){r=n;break}for(var o=0;o<e.length;++o)if(ue(e[o].toLowerCase(),t)){l=a;break}}else r=ge(e.toLowerCase(),t)?n:0,l=ue(e.toLowerCase(),t)?a:0;return r>=l?r:l},$t=e=>{var t=0,i=0;if(e){if(!e.viewable)return-1e3;if('tel'!==e.htmlType&&'text'!==e.htmlType&&'number'!==e.htmlType)return-1e3;if(e.htmlLength){var n=e.htmlLength;i=15===n||16===n||19===n?2:0}var a=0,r=/(expiry|holder|name|year|month|registration|register)/i;if(a+=r.test(e.htmlID)?2:0,a+=r.test(e.htmlName)?2:0,a+=r.test(e.htmlLabel)?2:0,(a+=r.test(e.htmlPlaceholder)?2:0)>0)return-1e3;if(t+=qt(e.htmlID,At),t+=qt(e.htmlName,At),t+=qt(e.htmlClass,At,!0),t+=qt(e.htmlPlaceholder,Nt),t+=qt(e.htmlLabel,Nt),t+=qt(e.labelAria,Nt,!0),t+=qt(e.labelData,Nt,!0),!e.htmlLabel){var l=0;l+=qt(e.autoCompleteType,At,!0),l+=qt(e.labelLeft,Nt,!0),l+=l?0:qt(e.labelRight,Nt,!0),t+=l+=l?0:qt(e.labelTop,Nt,!0)}return i&&t?t+i:(0!==t||e.userEdited||(t+=qt(e.htmlValue,Nt,!0)),t)}},Ht=(e,t,i)=>{var n=0,a=e.htmlType,r=e.htmlLength,l=e.htmlName,s=e.htmlID;if(!e.viewable)return-1e3;if('text'!==a&&'number'!==a&&'tel'!==a)return-1e3;if(i)for(var o=0;o<i.length;++o){var d=i[o];if(e.elementNumber===d.elementNumber)return-1e3;var u=d.htmlName,c=d.htmlID;u&&l&&(u=u.substring(0,u.length-1),n+=(l=l.substring(0,l.length-1))===u?2:0),c&&s&&(c=c.substring(0,c.length-1),n+=(s=s.substring(0,s.length-1))===c?2:0)}if(t&&r){if(n+=4!==t||4!==r&&7!==r?0:2,n+=5===t&&3===r?2:0,n+=t<4&&4===r?2:0,r<3||r>7)return-1e3;l&&l[l.length-1]===t.toString()&&(n+=2),s&&s[s.length-1]===t.toString()&&(n+=2)}return n+=qt(l,At),n+=qt(s,At),1===t&&(n+=qt(de(e.htmlLabel),Nt)),n+=qt(e.htmlClass,At,!0)},Kt=(e,t,i)=>{var n=We(e,(function(e){return Ht(e,t,i)}));return null!==n&&Ht(n,t,i)>0?n:null},Gt=e=>{let t=0,i=0,n=e.htmlType;if(!e.viewable)return-1e3;if('password'!==n&&'text'!==n&&'tel'!==n&&'number'!==n)return-1e3;!e.htmlLength||3!==e.htmlLength&&4!==e.htmlLength||(i=2),t+=qt(e.htmlLabel,Ct),t+=qt(e.htmlPlaceholder,Ct),t+=qt(e.htmlName,St),t+=qt(e.htmlID,St),t+=qt(e.autoCompleteType,St),t+=qt(e.htmlClass,St,!0);let a=0;const r=['crdnumbr','card_number','cardnumber','creditcardnumber','cccardnumber','debitcardnumber','dccardnumber','ccnumber','cardno','card_no','cc-number','cardnum','ccnum','cc_no','ccno','dcnum','registration','register','verification','6-digit','otp','one-time-code','googleauthenticator','totp','totppin','useroathcode','twofactorcode','totpcode','secondfactor','twofactortoken','2fa','twofacode','captcha','phone','anzahl'],l=ge(e.autoCompleteType,['cccsc']);return a=qt(e.htmlName,r),a>0&&!l?-1e3:(a=qt(e.htmlID,r),a>0&&!l?-1e3:(a=qt(e.labelAria,r),a>0&&!l?-1e3:(a=qt(e.htmlLabel,['card number'].concat(r)),a>0&&!l?-1e3:(t>0&&(t+=i),t))))},Yt=(e,t)=>{var i=0,n=e;if(void 0===t&&(t=!1),!e.viewable&&!t)return-1e3;if('select-one'===n.htmlType){var a=n.selectOption.options.length,r=null;if(12===a&&(r=n.selectOption.options[11][0]),13===a&&(r=n.selectOption.options[12][0]),!r)return-1e3;i+='12'===(r=r.toLowerCase())||'dec'===r||'december'===r||'12dec'===r||'dec12'===r||'12december'===r||'december12'===r||'12 - dec'===r||'dec - 12'===r||'12 - december'===r||'december (12)'===r||'12 (dec)'===r||'dec (12)'===r?2:0}else{var l=e.htmlType;if('text'!==l&&'tel'!==l&&'number'!==l)return-1e3;if(e.htmlPlaceholder)i+='mm'===e.htmlPlaceholder.toLowerCase()?2:0;e.htmlLength&&(i+=2===e.htmlLength?2:0)}i+=qt(e.htmlName,Ot),i+=qt(e.htmlID,Ot),i+=qt(e.htmlClass,Ot,!0),i+=qt(e.htmlLabel,Pt);return qt(e.htmlLabel,Bt)>0||qt(e.htmlName,Bt)>0||qt(e.htmlID,Bt)>0?-1e3:i},Xt=(e,t)=>{var i=We(e,(e=>Yt(e,t)));return null!==i&&Yt(i,t)>0?i:null},Zt=(e,t)=>{var i=0,n=e;if(void 0===t&&(t=!1),!e.viewable&&!t)return-1e3;if('select-one'===n.htmlType&&n.selectOption.options.length>1){var a=(new Date).getFullYear(),r=parseInt(a.toString().substr(2,2),10),l=parseInt(n.selectOption.options[0][0],10),s=parseInt(n.selectOption.options[1][0],10);if(a===l||a===s||r===l||r===s)i+=2;else{var o=n.selectOption.options[0][0],d=n.selectOption.options[1][0];if(o&&(-1!==o.indexOf('month')||-1!==o.indexOf('jan'))||d&&-1!==d.indexOf('jan'))return-1e3}}else{var u=e.htmlType;if('text'!==u&&'tel'!==u&&'number'!==u)return-1e3;if(e.htmlPlaceholder){var c=e.htmlPlaceholder.toLowerCase();i+='yy'===c||'yyyy'===c||'year'===c?10:0}e.htmlLength&&0!==i&&(e.htmlName&&-1===e.htmlName.indexOf('cvv')||e.htmlID&&-1===e.htmlID.indexOf('cvv')||e.htmlLabel&&-1===e.htmlLabel.indexOf('cvv'))&&(i+=2===e.htmlLength||4===e.htmlLength?2:0)}i+=qt(e.htmlName,kt),i+=qt(e.htmlID,kt),i+=qt(e.htmlClass,kt,!0),i+=qt(e.htmlLabel,Pt,!0);return qt(e.htmlLabel,Bt)>0||qt(e.htmlName,Bt)>0||qt(e.htmlID,Bt)>0?-1e3:i},Jt=(e,t)=>{var i=We(e,(e=>Zt(e,t)));return null!==i&&Zt(i,t)>0?i:null},Qt=e=>{var t=0,i=e.htmlType;if(!e.viewable)return-1e3;if('tel'!==i&&'text'!==i)return-1e3;if(t+=qt(e.htmlName,Mt),t+=qt(e.htmlID,Mt),t+=qt(e.htmlLabel,Pt),t+=qt(e.htmlClass,Mt),t+=qt(e.htmlPlaceholder,['mm yyyy']),t+=qt(e.autoCompleteType,Mt),!e.htmlLabel){var n=0;n+=qt(e.labelLeft,Pt,!0),n+=n?0:qt(e.labelRight,Pt,!0),t+=n+=n?0:qt(e.labelTop,Pt,!0)}return t>0&&(5===e.htmlLength||7===e.htmlLength)&&(t+=2),t},ei=e=>{var t=0;if(!e.viewable)return-1e3;if('text'!==e.htmlType)return-1e3;t+=qt(e.htmlLabel,Rt,!0),t+=qt(e.htmlID,Ut,!0),t+=qt(e.htmlName,Ut,!0),t+=qt(e.htmlClass,Ut),t+=qt(e.htmlPlaceholder,Rt,!0),t+=qt(e.autoCompleteType,Ut);return qt(e.htmlLabel,['save','number','registration'])>0||qt(e.htmlName,['save','registration'])>0||qt(e.htmlID,['save','registration'])>0?-1e3:t},ti=(e,t)=>{var i=0,n=e.selectOption?e.selectOption.options.length:0;if(void 0===t&&(t=!1),!e.viewable&&!t)return-1e3;if(!(n>1))return-1e3;for(var a=0;a<n;++a){var r=e.selectOption.options[a][0]?e.selectOption.options[a][0].toLowerCase():e.selectOption.options[a][0];if('visa'===r||'american express'===r||'discover'===r||'mastercard'===r||'visa electron'===r||'mastercard maestro'===r||'diners club'===r){i+=2;break}}return i+=qt(e.htmlName,Vt),i+=qt(e.htmlID,Vt),i+=qt(e.htmlClass,Vt),i+=qt(e.htmlLabel,zt)},ii=(e,t)=>{var i=We(e,(e=>ti(e,t)));return null!==i&&ti(i)>0?i:null},ni=e=>{if(!e||!e.length)return{};const t=ke(e,!1),i=null!==(n=We(t,$t))&&$t(n)>0?n:null;var n;const a=null!==(r=We(t,ei))&&ei(r)>0?r:null;var r;let l=ii(t),s=(e=>{var t=We(e,Gt);if(null!==t&&Gt(t)>0){const i=e.filter((e=>'submit'===e.actualType&&e.visible&&e.viewable&&e.hasForm)),n=i.find((e=>e.hasForm&&e.visible&&e.viewable&&'submit'===e.actualType&&$e(e.htmlValue,Ft.concat('next'))));return 1===i.length&&n&&t.hasForm?null:t}return null})(t),o=Xt(t),d=Jt(t),u=[],c=null;var h=Kt(t,1);h&&u.push(h);var m=Kt(t,2,u);m&&u.push(m);var p=Kt(t,3,u);p&&u.push(p);var f=Kt(t,4,u);f&&u.push(f);var g=null;f&&4===f.htmlLength&&(g=Kt(t,5,u)),g&&u.push(g);var b=((e,t)=>{var i=[];if(!e)return i;for(var n=0,a=e.length;n<a;n++)t?e[n].viewable||i.push(e[n]):e[n].viewable&&i.push(e[n]);return i})(e,!0);return o||(o=Xt(b,!0)),d||(d=Jt(b,!0)),l||(l=ii(b,!0)),(!o&&!d||o&&d&&o.elementNumber===d.elementNumber)&&(c=(e=>{var t=We(e,Qt);return null!==t&&Qt(t)>0?t:null})(e),c&&(o=null,d=null)),{cardNumberField:u.length>=4?null:i,cardNumberFields:u,cardHolderField:a,cardTypeField:l,cvvField:s,monthField:o,yearField:d,expiryField:c}},ai=e=>{var t=0;return(e.cardNumberField||e.cardNumberFields.length>=4)&&(t+=100),t+=e.cardHolderField?2:0,t+=e.cardTypeField?2:0,t+=e.cvvField?2:0,t+=e.monthField?2:0,(t+=e.yearField?2:0)>0&&(t+=qt(e.htmlName,xt),t+=qt(e.htmlID,xt),t+=qt(e.htmlClass,xt)),t},ri=(e,t)=>{let i=null,n=[],a=[],r=t?0:100;if(e?a=e:(n=Re(),a=Be(n)),!a)return null;if(a){const e=a;if(e&&e.pageForms&&e.pageForms.length){let t=(s=e.pageForms)?s.map((e=>je(e,ni(e.fields)))):[];if(t&&(i=We(t,ai),i&&ai(i)>r))return i}if(!i&&e&&e.pageFields&&e.pageFields.length){var l=ni(e.pageFields);return l.cardNumberField?l:null}}var s;return null},li=function(e,t,i){if(!e||!t)return!1;try{const c=document.querySelector('[data-enpassid='+e.elementNumber+']');if(c){const h=c.nodeName;if('INPUT'===h&&(c.value='year'===i&&2===e.htmlLength&&4===t.length?t.substr(2,2):t,re(c)),'SELECT'===h)for(var n=0,a=e.selectOption.options.length;n<a;++n){var r=e.selectOption.options[n],l=r&&r[0]?r[0].toLowerCase():'',s=r&&r[1]?r[1].toLowerCase():'',o=t,d=t;if('year'===i&&(l&&4===l.length&&4!==t.length&&(o='20'+t),s&&4===s.length&&(t.substr(2,2),4!==t.length&&(d='20'+t)),l&&2===l.length&&2!==t.length&&(o=t.substr(2,2)),s&&2===s.length&&2!==t.length&&(s=t.substr(2,2))),l===o.toLowerCase()||s===d.toLowerCase()){c.selectedIndex=n,ae(c,'change');break}if(!isNaN(t)){var u=t;if(1===t.length&&(u=ie(u,2)),2===t.length){if(u=parseInt(u,10),'month'===i&&(-1!==l.indexOf(Wt[u-1])||-1!==l.indexOf(jt[u-1])||-1!==s.indexOf(jt[u-1])||-1!==s.indexOf(Wt[u-1]))){c.selectedIndex=n,re(c);break}u=u.toString()}if(l===u.toLowerCase()||s===u.toLowerCase()){c.selectedIndex=n,re(c);break}}}}}catch(e){}},si=(e,t,i)=>{const n=document.querySelector('[data-enpassid='+e.elementNumber+']');n&&'INPUT'===n.nodeName?te.manageConcealer(n,t,i):i()},oi=(e,t)=>{var i=0,n=t.ccnumber,a=0,r=4;if(e){if(e.cardTypeField&&t?.cardtype&&si(e.cardTypeField,t.reveal_restricted?.includes('cardtype'),(()=>li(e.cardTypeField,t.cardtype))),e.cardNumberField&&t?.ccnumber&&si(e.cardNumberField,t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberField,t.ccnumber))),e&&e.cardNumberFields&&3===e.cardNumberFields.length&&t?.ccnumber&&(n=t.ccnumber,a=0,r=e.cardNumberFields[0].htmlLength||4,si(e.cardNumberFields[0],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[0],n.substring(a,r)))),a=r,r=r+e.cardNumberFields[1].htmlLength||r+6,si(e.cardNumberFields[1],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[1],n.substring(a,r)))),a=r,si(e.cardNumberFields[2],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[2],n.substring(a))))),e.cardNumberFields.length>=4&&t?.ccnumber&&(i=e.cardNumberFields.length,n=t.ccnumber,a=0,r=4,si(e.cardNumberFields[0],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[0],n.substring(a,r)))),a=r,r+=4,si(e.cardNumberFields[1],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[1],n.substring(a,r)))),a=r,r+=4,si(e.cardNumberFields[2],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[2],n.substring(a,r)))),4===i?(a=r,si(e.cardNumberFields[3],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[3],n.substring(a))))):(a=r,r+=4,si(e.cardNumberFields[3],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[3],n.substring(a,r)))),a=r,si(e.cardNumberFields[4],t.reveal_restricted?.includes('ccnumber'),(()=>li(e.cardNumberFields[4],n.substring(a)))))),e.cardHolderField&&t?.holderName&&si(e.cardHolderField,t.reveal_restricted?.includes('holderName'),(()=>li(e.cardHolderField,t.holderName))),e.monthField&&t?.month&&si(e.monthField,t.reveal_restricted?.includes('month'),(()=>li(e.monthField,t.month))),e.yearField&&t?.year&&si(e.yearField,t.reveal_restricted?.includes('year'),(()=>li(e.yearField,t.year))),e.expiryField&&t?.month&&t?.year){let i=t.month,n=t.year,a=e.expiryField.htmlLength,r=e.expiryField;if(r.value=i,li(r,i),5===a){const e=n.length>2?n.substring(n.length-2):n,a=r.htmlPlaceholder&&r.htmlPlaceholder.includes('/')&&e?`${i}/${e}`:i+e;a&&si(r,t.reveal_restricted?.includes('year')&&t.reveal_restricted?.includes('month'),(()=>li(r,a)))}else if(7===a)i+n&&si(r,t.reveal_restricted?.includes('year')&&t.reveal_restricted?.includes('month'),(()=>li(r,i+n)));else{const e=n?i+'/'+n:i+n;e&&si(r,t.reveal_restricted?.includes('year')&&t.reveal_restricted?.includes('month'),(()=>li(r,e)))}}e.cvvField&&t.cvv&&si(e.cvvField,t.reveal_restricted?.includes('cvv'),(()=>li(e.cvvField,t.cvv)))}},di=e=>{let t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;let i=e.htmlType;if('text'===i||'email'===i){t+='email'===i?5:0;const n=/e[_-]?mail([_-]?(id|address))?/i,a=/e[_-]?mail([\s_-]?(id|address))?/i,r=/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,l='ईमेल,correo electrónico,البريد الإلكتروني,אֶלֶקטרוֹנִי,e-post,이메일,Eメール,o email,Эл. адрес,E-naslov,อีเมล,e-posta,електронна пошта,電子郵件,电子邮件'.split(',');if(0===t){const t=ue(e.htmlPlaceholder,['name'])&&!r.test(e.htmlPlaceholder),i=ue(e.htmlPlaceholder,['user']);if(t&&!i)return 0}t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,t+=a.test(e.htmlPlaceholder)||r.test(e.htmlPlaceholder)?10:0,e.userEdited||(t+=r.test(e.htmlValue)?10:0);let s=0;if(s+=!s&&a.test(e.htmlLabel)?10:0,s+=!s&&ue(e.htmlLabel,l)?10:0,e.htmlPlaceholder){const i=e.htmlPlaceholder;ue(i,['phone','number'])&&!ue(i,['email'])&&(t-=5)}if(s+=s||e.htmlPlaceholder||!a.test(e.labelTop)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelTop,l)?0:5,s+=!s&&!e.htmlPlaceholder&&!e.htmlLabel&&e.labelRight&&e.labelRight.length<50&&a.test(e.labelRight)?5:0,s+=s||e.htmlPlaceholder||!ue(e.labelRight,l)?0:5,s+=s||e.htmlPlaceholder||!a.test(e.labelLeft)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelLeft,l)?0:5,s+=s||e.htmlPlaceholder||!a.test(e.labelData)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelData,l)?0:5,s+=s||e.htmlPlaceholder||!a.test(e.labelAria)?0:5,s+=s||e.htmlPlaceholder||!ue(e.labelAria,l)?0:5,s>0){const t=e.htmlLabel||e.labelRight||e.labelLeft||e.labelData||e.labelAria;if(t&&ue(t,['would you like to']))return 0}return t+s}return 0},ui=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType){var i=/f(irst)?[\s-_]?name/i,n='first name,पहला नाम,keresztnév,名字,Prénom,ім\'я,Vorname,etunimi,fornavn,ファーストネーム,praenomen,primeiro nome,имя'.split(',');if(Ti(e,/full name|middle name|last name|surname/i)>0)return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;return e.htmlLabel?r+=!r&&ue(e.htmlLabel,n)?10:0:(r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5),r+=r||a||!ue(e.labelData,n)?0:5,t+(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return 0},ci=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType){var i=/(l(ast)?|sur|family)[-_]?name/i,n='last name,family name,surname,अंतिम नाम,cognome,姓,nom de famille,familienname,nachname,прізвище,Фамилия,vezetéknév'.split(',');if(Ti(e,/first & last name|full name|middle name/i)>0)return 0;t+=e.htmlName&&-1===e.htmlName.indexOf('full')&&i.test(e.htmlName)?10:0,t+=e.htmlID&&-1===e.htmlID.indexOf('full')&&i.test(e.htmlID)?10:0,t+=e.htmlClass&&-1===e.htmlClass.indexOf('full')&&i.test(e.htmlClass)?5:0,t+=e.htmlTitle&&-1===e.htmlTitle.indexOf('full')&&i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n);e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;return e.htmlLabel?r+=!r&&ue(e.htmlLabel,n)?10:0:(r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5),r+=r||a||!ue(e.labelData,n)?0:5,t+(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return 0},hi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType){var i=/m(iddle)?[-_]?(name|initial)/i,n='middle name,middle initial,secondo nome,второе имя,középső név,मध्य नाम,中间名字,الاسم الأوسط,toinen nimi,deuxième nom,zweiter Vorname,ミドルネーム,nomen medium,mellomnavn'.split(',');t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;return e.htmlLabel?r+=r||!ue(e.htmlLabel,n)&&!/(^mi$)/i.test(e.htmlLabel)?0:10:(r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5),r+=r||a||!ue(e.labelData,n)?0:5,t+(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return 0},mi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType){const n=/(?:full[_-]name)|^(full|bill|customer)?(!last|!first|!middle|!family|!sur)?[-_]?name$/i,a='full name,bill name,customer name,enter name,enter your name,नाम,navn,имя,اسم,名称,név'.split(','),r='name'.split(',').concat(a),l=/(first name)|(last name)|(middle name)|(username)|(uživatelské jméno)/i;if(Ti(e,l)>0){if(!/first & last name/i.test(e.htmlPlaceholder))return 0}t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,r)||!l.test(e.htmlPlaceholder)&&ue(e.htmlPlaceholder,a)?10:0,e.userEdited||(t+=ge(e.htmlValue,r)||ue(e.htmlValue,a)?10:0);var i=0;i+=!i&&ge(e.htmlLabel,r)||!i&&ue(e.htmlLabel,a)?10:0,e.htmlPlaceholder&&'required'!==e.htmlPlaceholder||(i+=!i&&ge(e.labelTop,r)?10:i||l.test(e.labelTop)||!ue(e.labelTop,a)?0:5,i+=!i&&ge(e.labelRight,r)?10:i||l.test(e.labelRight)||!ue(e.labelRight,a)?0:5,i+=!i&&ge(e.labelLeft,r)?10:i||l.test(e.labelLeft)||!ue(e.labelLeft,a)?0:5,i+=!i&&ge(e.labelData,r)?10:i||l.test(e.labelData)||!ue(e.labelData,a)?0:5,i+=!i&&ge(e.labelAria,r)?10:i||l.test(e.labelAria)||!ue(e.labelAria,a)?0:5),t+=i}return t},pi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if(/(tel|text)/i.test(i)){var n=/((mobile|phone)[-_]?(num|number|no)?)|telephone|contact[-_]?(num|number|no)/i,a='mobile,phone,contact no,contact number,telephone,telefono,telefon,Телефон,Handynummer,手机号码,numero di cellulare,मोबाइल नंबर,फ़ोन नंबर'.toLowerCase().split(',');if(Ti(e,/email|fax/i,n)>0&&'tel'!==e.autoCompleteType)return 0;if(e.htmlLength<10)return 0;t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlTitle)?5:0,t+=ue(e.htmlPlaceholder,a)?10:0,e.userEdited||(t+=ue(e.htmlValue,a)?10:0);var r=0;r+=!r&&ue(e.htmlLabel,a)?10:0,r+=r||e.htmlPlaceholder||!ue(e.labelTop,a)?0:5,r+=r||e.htmlPlaceholder||!ue(e.labelTop,a)?0:5,r+=r||e.htmlPlaceholder||!ue(e.labelLeft,a)?0:5,r+=r||e.htmlPlaceholder||!ue(e.labelData,a)?0:5,0!==(t+=r+=r||e.htmlPlaceholder||!ue(e.labelAria,a)?0:5)||e.htmlPlaceholder||e.htmlLabel||(t+=n.test(e.htmlClass)?5:0)}return t},fi=e=>{var t=0;if(/(text|tel)/i.test(e.htmlType)){var i=/birthdate|dateofbirth$/i,n='MM/DD/YYYY,date of birth'.split(',');if(Ti(e,/(month|year|exp|anniversary)/i)>0)return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,n)?10:0;var a=0;a+=!a&&ge(e.htmlLabel,n)?10:0,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelLeft,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelData,n)?0:5,t+=a+=a||e.htmlPlaceholder||!ge(e.labelAria,n)?0:5}return t},gi=e=>{var t=0;if(/(text|select-one|number|tel)/i.test(e.htmlType)){var i=/(dob|birth)(day|date)?[-_]?(day|dd)|^day$/i,n='day,dd'.split(',');if(Ti(e,/(month|year|exp|anniversary)/i)>0)return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,n)?10:0;var a=0;if(a+=!a&&ge(e.htmlLabel,n)?10:0,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelLeft,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelData,n)?0:5,0===(t+=a+=a||e.htmlPlaceholder||!ge(e.labelAria,n)?0:5)){var r=/date\sof\sbirth/i,l=/day|dd/i;(r.test(e.htmlLabel)||r.test(e.labelTop)||r.test(e.labelRight)||r.test(e.labelData)||r.test(e.labelAria))&&(t+=l.test(e.htmlName)?10:0,t+=l.test(e.htmlID)?10:0,t+=l.test(e.htmlClass)?5:0,t+=l.test(e.htmlTitle)?5:0)}}return t},bi=e=>{var t=0;if(/(text|select-one|number|tel)/i.test(e.htmlType)){var i=/(dob|birth)(day|date)?[-_]?(month|mm)|(month)/i,n='month,mm'.split(',');if(Ti(e,/(exp|anniversary)/i)>0)return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,n)?10:0;var a=0;if(a+=!a&&ge(e.htmlLabel,n)?10:0,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelLeft,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelData,n)?0:5,0===(t+=a+=a||e.htmlPlaceholder||!ge(e.labelAria,n)?0:5)){var r=/date\sof\sbirth/i,l=/mm|month/i;(r.test(e.htmlLabel)||r.test(e.labelTop)||r.test(e.labelRight)||r.test(e.labelData)||r.test(e.labelAria))&&(t+=l.test(e.htmlName)?10:0,t+=l.test(e.htmlID)?10:0,t+=l.test(e.htmlClass)?5:0,t+=l.test(e.htmlTitle)?5:0)}}return t},yi=e=>{var t=0;if(/(text|select-one|number|tel)/i.test(e.htmlType)){var i=/(dob|birth)(day|date)?[_-]?(year|yy)|(year)/i,n='year,yy'.split(',');if(Ti(e,/(exp|anniversary)/i)>0)return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,n)?10:0;var a=0;if(a+=!a&&ge(e.htmlLabel,n)?10:0,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelTop,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelLeft,n)?0:5,a+=a||e.htmlPlaceholder||!ge(e.labelData,n)?0:5,0===(t+=a+=a||e.htmlPlaceholder||!ge(e.labelAria,n)?0:5)&&'select-one'===e.htmlType){var r=e.selectOption.options;if(r.length>10){var l=/^(18[5-9]\d|19[5-9]\d|20[0-4]\d|2050)$/g;(l.test(r[9][0])||l.test(r[9][1]))&&(t+=10)}var s=/date\sof\sbirth/i,o=/yy|year/i;(s.test(e.htmlLabel)||s.test(e.labelTop)||s.test(e.labelRight)||s.test(e.labelData)||s.test(e.labelAria))&&(t+=o.test(e.htmlName)?10:0,t+=o.test(e.htmlID)?10:0,t+=o.test(e.htmlClass)?5:0)}}return t},vi=e=>{var t=0;if(!e||!e.visible)return 0;var i=e.htmlType;if(/(select-one|text)/i.test(i)){var n=/country/i,a=/(phone|mobile|company)/i,r='country,देश,страна,国家'.split(',');if(e.htmlName&&(e.htmlName.indexOf('/')>-1||e.htmlName.indexOf('.')>-1)){let i=/(phone|mobile|company|address|city|state)/i.test(e.htmlName),a=n.test(e.htmlName);!i&&a&&(t+=10)}else t+=!a.test(e.htmlName)&&n.test(e.htmlName)?10:0;if(e.htmlID&&(e.htmlID.indexOf('/')>-1||e.htmlID.indexOf('.')>-1)){let i=/(phone|mobile|company|address|city|state)/i.test(e.htmlID),a=n.test(e.htmlID);!i&&a&&(t+=10)}else t+=!a.test(e.htmlID)&&n.test(e.htmlID)?10:0;t+=!a.test(e.htmlClass)&&n.test(e.htmlClass)?5:0,t+=!a.test(e.htmlTitle)&&n.test(e.htmlTitle)?5:0,t+=ge(e.htmlPlaceholder,r)||!a.test(e.htmlPlaceholder)&&ue(e.htmlPlaceholder,r)?10:0,'text'===i&&e.userEdited&&(t+=!a.test(e.htmlValue)&&n.test(e.htmlValue)?5:0);var l=0;return l+=l||a.test(e.htmlLabel)||!ue(e.htmlLabel,r)?0:10,l+=l||a.test(e.labelTop)||!ue(e.labelTop,r)?0:5,l+=l||a.test(e.labelRight)||!ue(e.labelRight,r)?0:5,l+=l||a.test(e.labelLeft)||!ue(e.labelLeft,r)?0:5,l+=l||a.test(e.labelData)||!ue(e.labelData,r)?0:5,t+(l+=l||a.test(e.labelAria)||!ue(e.labelAria,r)?0:5)}return 0},wi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if(/(select-one|text)/i.test(i)){var n=/(state|province|region)/i;t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,'text'===i&&e.userEdited&&(t+=n.test(e.htmlValue)?5:0);var a=0;return a+=!a&&n.test(e.htmlLabel)?10:0,a+=!a&&n.test(e.labelTop)?5:0,a+=!a&&n.test(e.labelRight)?5:0,a+=!a&&n.test(e.labelLeft)?5:0,a+=!a&&n.test(e.labelData)?5:0,t+(a+=!a&&n.test(e.labelAria)?5:0)}return 0},_i=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if(/(select-one|text)/i.test(i)){var n=/(city|town)/i;t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,'text'===i&&e.userEdited&&(t+=n.test(e.htmlValue)?5:0);var a=0;return a+=!a&&n.test(e.htmlLabel)?10:0,a+=!a&&n.test(e.labelTop)?5:0,a+=!a&&n.test(e.labelRight)?5:0,a+=!a&&n.test(e.labelLeft)?5:0,a+=!a&&n.test(e.labelData)?5:0,t+(a+=!a&&n.test(e.labelAria)?5:0)}return 0},Ti=(e,t,i)=>{var n=0;if(i){if(e.htmlName&&(e.htmlName.indexOf('/')>-1||e.htmlName.indexOf('.')>-1)){let a=t.test(e.htmlName),r=i.test(e.htmlName);a&&!r&&(n+=10)}else n+=t.test(e.htmlName)?10:0;if(e.htmlID&&(e.htmlID.indexOf('/')>-1||e.htmlID.indexOf('.')>-1)){let a=t.test(e.htmlID),r=i.test(e.htmlID);a&&!r&&(n+=10)}else n+=t.test(e.htmlID)?10:0}else n+=t.test(e.htmlName)?10:0,n+=t.test(e.htmlID)?10:0;n+=t.test(e.htmlClass)?5:0,n+=t.test(e.htmlTitle)?5:0,n+=t.test(e.htmlPlaceholder)?5:0;var a=0;if(e.htmlLabel){return a+=!a&&t.test(e.htmlLabel)?10:0,i&&i.test(e.htmlLabel)?0:n+a}return a+=!a&&t.test(e.labelTop)?10:0,a+=!a&&t.test(e.labelRight)?10:0,a+=!a&&t.test(e.labelLeft)?10:0,a+=!a&&t.test(e.labelData)?10:0,n+(a+=!a&&t.test(e.labelAria)?10:0)},Li=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if(/(textarea|text)/i.test(i)){var n=/(address|addr|street|landmark|postal.*address)/i,a=/(mail|company|name|city|state|country|phone|code|^zip$)/i,r='landmark,address,पता,Adresse,地址,osoite,Indirizzo,адрес'.toLowerCase().split(',');if(Ti(e,a,n)>0)return 0;if(e.htmlName&&(e.htmlName.indexOf('/')>-1||e.htmlName.indexOf('.')>-1)){let i=a.test(e.htmlName),r=n.test(e.htmlName);!i&&r&&(t+=10)}else t+=!a.test(e.htmlName)&&n.test(e.htmlName)?10:0;if(e.htmlID&&(e.htmlID.indexOf('/')>-1||e.htmlID.indexOf('.')>-1)){let i=a.test(e.htmlID),r=n.test(e.htmlID);!i&&r&&(t+=10)}else t+=!a.test(e.htmlID)&&n.test(e.htmlID)?10:0;t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0,'text'===i&&e.userEdited&&(t+=!a.test(e.htmlValue)&&n.test(e.htmlValue)?5:0);var l=0;return l+=!l&&ue(e.htmlLabel,r)?10:0,l+=!l&&ue(e.labelRight,r)?5:0,l+=!l&&ue(e.labelLeft,r)?5:0,l+=!l&&ue(e.labelData,r)?5:0,t+(l+=!l&&ue(e.labelAria,r)?5:0)}return 0},Ii=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType){var i=/company|(?:business.*name)|organization/i,n='company,organization,business name,firma,संगठन,组织'.split(',');if(Ti(e,/phone|fax|country/i,i))return 0;t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;r+=!r&&ue(e.htmlLabel,n)?10:0,r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5,r+=r||a||!ue(e.labelData,n)?0:5,t+=(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return t},Ei=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType||'select-one'===e.htmlType){var i=/(department)/i,n='department,विभाग,отдел,部门,dipartimento,département'.toLowerCase().split(',');t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;r+=!r&&ue(e.htmlLabel,n)?10:0,r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5,r+=r||a||!ue(e.labelData,n)?0:5,t+=(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return t},Fi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType||'select-one'===e.htmlType){var i=/(occupation)/i,n='occupation,व्यवसाय'.split(',');t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;r+=!r&&ue(e.htmlLabel,n)?10:0,r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5,r+=r||a||!ue(e.labelData,n)?0:5,t+=(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return t},Di=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;if('text'===e.htmlType||'select-one'===e.htmlType){var i=/(?:job.*(title|info))|(?:work.*(title|info))|(designaiton)/i,n='designation,job title,job position,work title,job info,work info,पद,la désignation,Bezeichnung,designatio'.toLowerCase().split(',');t+=i.test(e.htmlName)?10:0,t+=i.test(e.htmlID)?10:0,t+=i.test(e.htmlClass)?5:0,t+=i.test(e.htmlTitle)?5:0;var a=ue(e.htmlPlaceholder,n)?10:0;e.userEdited||(t+=ue(e.htmlValue,n)?10:0);var r=0;r+=!r&&ue(e.htmlLabel,n)?10:0,r+=r||a||!ue(e.labelTop,n)?0:5,r+=r||a||!ue(e.labelRight,n)?0:5,r+=r||a||!ue(e.labelLeft,n)?0:5,r+=r||a||!ue(e.labelData,n)?0:5,t+=(r+=r||a||!ue(e.labelAria,n)?0:5)+a}return t},xi=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if('text'===i||'select-one'===i||'radio'===i){var n=/(gender|sex)/i,a='gender,sex,male,female'.toLowerCase().split(',');t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0;var r=ue(e.htmlPlaceholder,a)?10:0;e.userEdited||(t+=ue(e.htmlValue,a)?10:0);var l=0;l+=!l&&ue(e.htmlLabel,a)?10:0,l+=l||r||!ue(e.labelTop,a)?0:5,l+=l||r||!ue(e.labelRight,a)?0:5,l+=l||r||!ue(e.labelLeft,a)?0:5,l+=l||r||!ue(e.labelData,a)?0:5,t+=(l+=l||r||!ue(e.labelAria,a)?0:5)+r}return t},Ni=e=>{var t=0;if(!e||!e.visible||e.isOutsideDocument)return 0;var i=e.htmlType;if('text'===i||'number'===i||'tel'===i){var n=/zip|(zip|postal|pin|post)[-_]?(code)/i,a='zipcode,pincode,postalcode,postcode,Postleitzahl,पिन कोड'.toLowerCase().split(',');t+=n.test(e.htmlName)?10:0,t+=n.test(e.htmlID)?10:0,t+=n.test(e.htmlClass)?5:0,t+=n.test(e.htmlTitle)?5:0;var r=ue(e.htmlPlaceholder,a,!0)?10:0;e.userEdited||(t+=ue(e.htmlValue,a,!0)?10:0);var l=0;l+=!l&&ue(e.htmlLabel,a,!0)?10:0,l+=l||r||!ue(e.labelTop,a,!0)?0:5,l+=l||r||!ue(e.labelRight,a,!0)?0:5,l+=l||r||!ue(e.labelLeft,a,!0)?0:5,l+=l||r||!ue(e.labelData,a,!0)?0:5,(t+=(l+=l||r||!ue(e.labelAria,a,!0)?0:5)+r)>0&&(t+=6===e.htmlLength?5:0)}return t},Ai=e=>{var t=0,i=e.htmlType;if(e.isOutsideDocument)return t;if('text'===i||'email'===i){var n='username,login name,usuari,identificación,användar,käyttäjätunnus,user id,登录名,用户名,CPR-nummer,Social Security number,bruger-id,registration number,customer id,online id,login id,personal id,customer number,registered email,account name,member number,membership number,profile number,profile id,cust no,cust id,uživatelské jméno,benutzerkennung'.toLowerCase().split(','),a=/(?:(?:login)|(?:logon.*id)|(?:user)|(?:uname))(?!.*pass)/i,r=/(?:(?:profile.*(id|number))|(?:member.*number)|(?:account.*name)|(?:customer.*(number|id))|(?:regist.*(email|number))|(?:cust.*(no|id))|(?:personal.*id)|(?:online.*id))(?!.*pass)/i,l=/f(irst|ull)?[\s-_]?name/i,s=/(l(ast)?|sur|family)[-_]?name/i,o=0;if(o+=l.test(e.htmlName)||s.test(e.htmlName)?10:0,o+=l.test(e.htmlID)||s.test(e.htmlID)?10:0,(o+=l.test(e.htmlPlaceholder)||s.test(e.htmlPlaceholder)?10:0)>0)return 0;if(e.htmlValue&&/\s/g.test(e.htmlValue))return 0;t+=a.test(e.htmlName)?20:r.test(e.htmlName)?10:0,t+=a.test(e.htmlID)?20:r.test(e.htmlID)?10:0,t+=a.test(e.htmlClass)||r.test(e.htmlClass)?5:0,t+=a.test(e.htmlTitle)||r.test(e.htmlTitle)?5:0,e.userEdited||(t+=ge(e.htmlValue,n)?10:0),e.htmlPlaceholder&&(t+=ge(e.htmlPlaceholder,n)?10:0);var d=0;return d+=!d&&ue(e.htmlLabel,n)?10:0,d+=d||e.htmlPlaceholder||!ue(e.labelTop,n)?0:5,d+=d||e.htmlPlaceholder||!ue(e.labelRight,n)?0:5,d+=d||e.htmlPlaceholder||!ue(e.labelLeft,n)?0:5,d+=d||e.htmlPlaceholder||!ue(e.labelData,n)?0:5,d+=d||e.htmlPlaceholder||!ue(e.labelAria,n)?0:5,!e.visible&&!e.viewable&&t>0&&(t/=10),t+d}return 0},Ci=(e,t,i,n,a)=>{for(var r,l=[],s=0,o=[],d=0,u=t.length;s<u;s++)(d=e(r=t[s]))>0&&(i?o.push([d,r]):o.push(r),n&&l.push(s),a?r.enpassType=a:r.enpassType||(r.enpassType=r.htmlType));if(n)for(var c=l.length-1;c>=0;c--)t.splice(l[c],1);return o},Si=e=>e?(e=Se(e,!0),e=Ae(e),Ci(di,e,!0,!0)):[],Oi=(e,t)=>{var i={};if(e&&0!==e.length||(e=Re(null)),e=Se(e,!0),e=Ae(e),i.email=Ci(di,e,!0,!0),i.fname=Ci(ui,e,!0,!0),i.lname=Ci(ci,e,!0,!0),i.mname=Ci(hi,e,!0,!0),i.fullName=Ci(mi,e,!0,!0),i.mobileNumber=Ci(pi,e,!0,!0),i.dob=Ci(fi,e,!0,!0),i.birthDay=Ci(gi,e,!0,!0),i.birthMonth=Ci(bi,e,!0,!0),i.birthYear=Ci(yi,e,!0,!0),i.country=Ci(vi,e,!0,!0),i.city=Ci(_i,e,!0,!0),i.state=Ci(wi,e,!0,!0),i.address=Ci(Li,e,!0,!0),i.company=Ci(Ii,e,!0,!0),i.department=Ci(Ei,e,!0,!0),i.occupation=Ci(Fi,e,!0,!0),i.designation=Ci(Di,e,!0,!0),i.gender=Ci(xi,e,!0,!0),i.zip=Ci(Ni,e,!0,!0),i.username=Ci(Ai,e,!0,!0),i.other=e,i=Pi(i),Object.keys(i).length){if(t){var n=[];for(const e in i)'other'!==e&&n.push(i[e]);i.allFields=n.flat().map((e=>e[1]))}return i}return!1},ki=(e,t)=>{for(var i=0,n=e.length;i<n;i++)if(e[i].htmlForm===t)return i;return-1},Pi=e=>{var t=Object.keys(e),i={};return t.forEach((function(t){e[t].length>0&&(i[t]=e[t])})),i},Mi=(e,t)=>{if(!e||!t||e.disabled)return!1;try{let o=document.querySelector('[data-enpassid='+e.elementNumber+']')||Ve(e);if(o&&('checkbox'!==e.htmlType&&'radio'!==e.htmlType&&'select-one'!==e.htmlType&&(o.value=t,re(o),(e=>{e&&-1!=='email text password number tel url'.split(' ').indexOf(e.type||'')&&(e.className+=' enpass-extension-animated-fill',setTimeout((function(){e&&e.className&&(e.className=e.className.replace(/(?:^|\s)enpass-extension-animated-fill(?!\S)/g,''))}),200))})(o)),'radio'===e.htmlType&&(o.checked=e.htmlLabel===t.toLowerCase()||e.labelRight===t.toLowerCase()||e.labelLeft===t.toLowerCase()),'select-one'===e.htmlType))for(var i=0,n=e.selectOption.options.length;i<n;++i){var a=e.selectOption.options[i],r=a[0]&&a[0].toLowerCase(),l=a[1]&&a[1].toLowerCase();if(r||l){if(r===t.toLowerCase()||l===t.toLowerCase()){o.selectedIndex=i,re(o);break}if(!isNaN(t)){var s=t;if(1===t.length&&(s=ie(s,2)),2===t.length&&(s=parseInt(s,10).toString()),r===s.toLowerCase()||l===s.toLowerCase()){o.selectedIndex=i,re(o);break}}}}}catch(e){}},Ri=(e,t,i)=>{if(!e||!t)return!1;if(e instanceof Array){if(!i){for(var n=0,a=e.length;n<a;n++){var r=e[n][1];Mi(r,t)}return!0}var l=Vi(e);if(l)return Mi(l,t),!0}return!1},Ui=(e,t)=>{if(!e||!t)return!1;if(e.fname&&t.firstname&&Ri(e.fname,t.firstname,!0),e.mname&&t.middlename&&Ri(e.mname,t.middlename,!0),e.lname&&t.lastname&&Ri(e.lname,t.lastname,!0),e.fullName){let i='';t.firstname&&(i+=t.firstname),t.middlename&&(i+=' '+t.middlename),t.lastname&&(i+=' '+t.lastname),Ri(e.fullName,i,!0)}e.email&&t.email&&Ri(e.email,t.email,!1),e.gender&&Ri(e.gender,t.gender),e.mobileNumber&&t.phonedefault&&Ri(e.mobileNumber,t.phonedefault,!1),e.company&&(t.company||t.organization)&&Ri(e.company,t.company||t.organization,!0),e.address&&(t.address||t.street)&&((e,t)=>{if(!e||!t)return!1;var i={addressLine1:'',addressLine2:''};t.addressLine1||t.address?(i.addressLine1=t.addressLine1||t.address,i.addressLine2=t.addressLine2||t.street||''):(i.addressLine1=t.street||'',i.addressLine2=t.addressLine2||'');var n=e.filter((function(e){return'textarea'===e[1].htmlType}));if(n&&n.length>0)1===n.length&&(i.addressLine2?Mi(n[0][1],i.addressLine1+', '+i.addressLine2):Mi(n[0][1],i.addressLine1)),n.length>1&&(Mi(n[0][1],i.addressLine1),Mi(n[1][1],i.addressLine2));else{if(1===e.length){const t=i.addressLine2?i.addressLine1+', '+i.addressLine2:i.addressLine1;Mi(e[0][1],t)}e.length>1&&(Mi(e[0][1],i.addressLine1),Mi(e[1][1],i.addressLine2))}})(e.address,{address:t.address,street:t.street});var i=[];if(e.zip){let t=Vi(e.zip);i.push(['zip',t])}if(e.country){let t=Vi(e.country);i.push(['country',t])}if(e.state){let t=Vi(e.state);i.push(['state',t])}if(e.city){let t=Vi(e.city);i.push(['city',t])}(i=i.sort((function(e,t){return parseInt(e[1].elementNumber.substr(2))-parseInt(t[1].elementNumber.substr(2))}))).forEach((function(e,i){var n=e[0];t[n]&&setTimeout((function(){Mi(e[1],t[n])}),500*i)})),t.dob&&((e,t)=>{var i=[];if(t&&(-1!==t.indexOf('/')?i=t.split('/'):(-1!==t.indexOf('-')||t.dob&&-1!==t.dob.indexOf('-'))&&(i=t.split('-')),0!=i.length))if(e.dob){var n=Vi(e.dob);n&&(n.htmlPlaceholder&&'dd/mm/yyyy'===n.htmlPlaceholder.toLowerCase()?Mi(n,t):Mi(n,i[1]+'/'+i[0]+'/'+i[2]))}else{if(e.birthDay){var a=Vi(e.birthDay);e.birthMonth||e.birthYear?Mi(a,i[0]):'text'===a.htmlType&&a.htmlLength>4&&Mi(a,i[0]+'/'+i[1]+'/'+i[2])}if(e.birthMonth){var r=Vi(e.birthMonth);e.birthDay||e.birthYear?Mi(r,i[1]):'text'===r.htmlType&&r.htmlLength>4&&Mi(r,i[0]+'/'+i[1]+'/'+i[2])}if(e.birthYear){var l=Vi(e.birthYear);e.birthMonth||e.birthDay?Mi(l,i[2]):'text'===l.htmlType&&l.htmlLength>4&&Mi(l,i[0]+'/'+i[1]+'/'+i[2])}}})(e,t.dob),e.occupation&&t.occupation&&Ri(e.occupation,t.occupation,!0),e.designation&&t.jobtitle&&Ri(e.designation,t.jobtitle,!0),e.username&&t.username&&Ri(e.username,t.username,!0)};function Vi(e){var t=null;if(!e)return t;for(var i=0,n=e.length,a=0;i<n;i++){var r=e[i][0],l=e[i][1];r>a&&(a=r,t=l)}return t}const zi=(e,t)=>{e||(e=Oi());var i=(e=>{var t={form:[],no_form:{}};if(!e)return t;var i=Object.keys(e);if(0===document.querySelectorAll('form').length)return{form:[],no_form:e};for(var n=0,a=i.length;n<a;n++){var r=i[n];if('other'!==r)for(var l=e[r],s=0,o=l.length;s<o;s++){var d=l[s][1],u=null;if(d&&d.hasForm&&(d.htmlID?u=document.getElementById(d.htmlID).form:d.elementNumber&&(u=document.querySelector('[data-enpassid='+d.elementNumber+']').form)),u){var c=ki(t.form,u);if(-1===c){var h={};h[r]=[l[s]],t.form.push({canbeFilled:d.viewable,htmlForm:u,fields:h})}else t.form[c].fields[r]?(d.viewable&&(t.form[c].canbeFilled=d.viewable),t.form[c].fields[r].push(l[s])):(t.form[c].fields[r]=[l[s]],d.viewable&&(t.form[c].canbeFilled=d.viewable))}else t.no_form[r]?t.no_form[r].push(l[s]):t.no_form[r]=[l[s]]}}return t})(e),n=!1;if(i&&i.form.length>0)for(var a=i.form,r=0,l=a.length;r<l;r++){var s=a[r];s.canbeFilled&&(n=!0,Ui(s.fields,t))}n||Ui(e,t)},Bi=['sign-in','log-in','signon','sign on','login','log in','login_in','signin','sign in','sign_in','log on','log_on','logon','登 录','登录','Inloggen','einloggen','giriş','zaloguj','लॉग इन करें','valider','accedi','anmelden','weiter','accès','вход','kirjaudu','zaloguj się','let me in','credentials','authentication','authenticate'],Wi=['signup','sign_up','sign up','register','create','reg','join','start','free','trial','profile','new_user'],ji=['change','change-password','creditcard','dc-form','cc-form','creditcard-form','debitcard-form','creditcard-payment-form','debitcard-payment-form','payment','newsletter','newsform','search'],qi=(e,t,i)=>{const n=['ok','next','næste','let me in','go','unlock','dalej','συνέχεια','enter','get started','verify','execute login'];let a=['forgot','remember me','stay logged in','new user','view','register','vergessen','already have an account','sign in with','login with','register','sign up','signup','join','create','регистрация','inscription','regístrate','cadastre-se','registrieren','registrazione','注册','साइन अप करें','change password','save changes','facebook','twitter','apple','enterprise sso','facebook','twitter','google','suchen','back to sign in','subscribe'],r=[];r=i&&i.length>0?i:Ft;var l=e.htmlValue||e.imageAlt,s=!1,o=0;if(l&&(e.viewable||e.disabled)){if($e(l,a))return t?o:s;0===(o+=$e(l,r)&&!$e(l,a)?10:0)&&(o+=$e(l,n)&&!$e(l,a)?5:0),o>0&&(o+=e.htmlType&&'submit'===e.htmlType?5:0,s=!0)}return(!l||!s&&e.viewable)&&(o+=$e(e.htmlID,r)?10:0,o+=$e(e.htmlName,r)?10:0,o+=$e(e.htmlClass,r)?5:0,o+=ue(e.imageAlt,r)?10:0,(o+=ue(e.imageSrc,r)?10:0)>=10&&(o+=e.htmlType&&'submit'===e.htmlType?5:0,s=!0)),t?o:s},$i=e=>{const t=['forgot','remember me','stay logged in','new user','view','register','vergessen','already have an account','sign in with','register','sign up','signup','join','create my account','регистрация','inscription','regístrate','cadastre-se','registrieren','registrazione','注册','साइन अप करें','change password','save changes','facebook','twitter','google','suchen'],i=se(null,'div[class*=btn],div[class*=button],a[class*=btn],a[class*=button],div[role=button],a[id*=btn],div[class*=Btn],div[class*=Button],a[class*=Btn],a[class*=Button],a[id*=Btn],a[role=button]');var n=0,a=null;if(i&&i.length>0){var r=[];for(let e=0,t=i.length;e<t;e++){let t=i[e],n=null;t&&(n=Array.prototype.slice.call(t.querySelectorAll('button')),n&&n.length>0?r=r.concat(n):r.push(t))}for(var l,s=r.length,o=0;o<s;o++){var d=0;if((l=r[o])&&fe(l)&&be(l)){let i=l.textContent||'';if(!i||!i.trim()){const e=l.getAttribute('aria-label');e&&(i=e.toLowerCase().trim())}if((d+=$e(i,Ft)&&!$e(i,t)?10:0)>0){var u=l.getAttribute('data-action');if(d+=(u=u?u.replace(/^\s+/m,'').replace(/\s+$/m,'').replace(/\s\s+/,' ').toLowerCase().trim():'')&&u.indexOf('submit')>=0?10:0,e){var c=Ve(e);c&&c.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_FOLLOWING?d+=10:d=0}l.tagName&&'div'===l.tagName.toLowerCase()&&l.firstElementChild&&(d=d>0?d/2:0),l.tagName&&'a'===l.tagName.toLowerCase()&&!l.onclick&&l.href&&0===l.href.indexOf(document.URL)&&(d=-100)}}d>0&&d>n&&(n=d,a=l)}}return a},Hi=(e,t,i)=>{if(!e||0===e.length)return null;var n=(()=>{if(0===document.URL.indexOf('https://www.tumblr.com/login')){var e=document.getElementById('signup_forms_submit');return Me(e)}return null})();if(n)return n;var a=pe(e,['submit','button','image']),r=0,l=null;if(a&&a.length>0){for(var s=a.length,o=0;o<s;o+=1){var d=a[o];if(!i||He(i,d)){var u=qi(d,!0,t);if(u>0){if(d.hasForm&&i&&i.hasForm)u+=ze(d)===ze(i)?50:0;u>r&&(r=u,l=d)}}}return l}return null},Ki=e=>{var t=pe(e,'password'),i=pe(e,'submit');if(3===(t=t.filter((function(e){return e.visible}))).length){var n=t[0].htmlValue,a=t[1].htmlValue,r=t[2].htmlValue,l=ze(t[0]),s=ze(t[1]),o=ze(t[2]);if(n===a&&n===r)return!1;var d=[];if(n.length>0&&-1===d.indexOf(n)&&d.push(n),a.length>0&&-1===d.indexOf(a)&&d.push(a),r.length>0&&-1===d.indexOf(r)&&d.push(r),2===d.length)return!(l&&s&&o)||l===s&&s===o}if(pe(e,['text','email','tel']).length>0)return!1;if(2===t.length){let e=!1;i&&i.length>0&&(e=i.some((function(e){return!!e.htmlValue&&'change password'===e.htmlValue.toLowerCase()})));let n=t[0]&&t[0].htmlValue?t[0].htmlValue:'',a=t[1]&&t[1].htmlValue?t[1].htmlValue:'';return n&&a&&n===a||e}if(1===t.length){if(i&&i.length>0&&qi(i[0]))return!1;var u=pe(e,'button');return!(u.length>0&&qi(u[0]))&&(_t(t,yt)||null)}return!1},Gi=(e,t,i)=>{if(!e)return 0;const n=e.htmlType;let a=0;if(['tel','text','email','password','number'].includes(n)||function(e){return'username'===e.htmlID&&'textarea'===e.htmlType}(e)){const r='email address,e mail adresse,emailadres,email or mobile number,email or phone,email id or phone number,username,nutzername,user name,login name,usuari,identificación,identifiant,användar,käyttäjätunnus,user id,登录名,用户名,CPR-nummer,Social Security number,bruger-id,registration number,customer id,online id,login id,personal id,customer number,registered email,account name,member number,membership number,profile number,profile id,profile url,cust no,cust id,uživatelské jméno,benutzerkennung,identyfikator,wpisz login,bank id,provider id,azonosító,identifier,rufnummer / nutzername,felhasználó,id code,identification'.toLowerCase().split(',');document.URL.includes('synology.com')&&r.push('account','konto');const l=/(?:(?:login)|(?:logon.*id)|(?:login.*id)|(?:user)|(?:uname)|(?:user.*(email))|(?:signup.*(email))|(?:profile.*(id|number))|(?:member.*number)|(?:account.*name)|(?:customer.*(number|id|no))|(?:regist.*(email|number))|(?:personal.*id)|(?:provider.*id)|(?:online.*id))(?!.*pass)/i,s=/(bot[\W_]|billing|shipping|dummy|fake|name.*card|card.*name|password|user[-_]?pw|dialoginput|otp|code|2fa|verification|authenticator|token|pin|secondfactor|folder|generated|recovery.*phone|remote.* identifier|user[-_]picker)/i,o=parseInt(e.elementNumber.substr(2)),d=Ve(e);if('www.aquado.de'===document.domain&&d&&(ne('focus',d),!fe(d)))return ne('blur',d),-1e3;if('password'!==n&&t&&t.length>0){if(!t.every((function(e){return o<e})))return 0}else if('password'===n&&t&&t.length>0){if(t.some((function(e){return o===e})))return 0}i&&(a+=e.htmlValue?50:0,a+=e.userEdited?50:0),a+='email'===n||e.htmlPlaceholder&&'email'===e.htmlPlaceholder.toLowerCase()?1:0,a+='password'===n?-1:0;let u=0;u+=s.test(e.htmlName)?10:0,u+=s.test(e.htmlID)?10:0,u+=s.test(e.htmlClass)?5:0,u+=s.test(e.htmlTitle)?5:0;const c=/password\smanager/gi;if(u+='id code'!==e.htmlLabel&&s.test(e.htmlLabel)&&!c.test(e.htmlLabel)?15:0,a-=u,a+=l.test(e.htmlName)?10:0,a+=l.test(e.htmlID)?10:0,a+=l.test(e.htmlClass)?5:0,a+=l.test(e.htmlTitle)?5:0,a+='username'===e.autoCompleteType&&e.visible&&!e.isOutsideDocument?40:0,0===a){const t=/(mobile|phone)/i;a+=t.test(e.htmlName)?4:0,a+=t.test(e.htmlID)?4:0,a+=t.test(e.htmlClass)?1:0,a+=t.test(e.htmlTitle)?1:0}if(e.userEdited||(a+=ge(e.htmlValue,r)?10:0),e.htmlPlaceholder){a+=ge(e.htmlPlaceholder,[...r,'user','benutzer'])?10:0;const t=['get new deals'];if(a-=ge(e.htmlPlaceholder,t)?10:0,0===a){const t=ue(e.htmlPlaceholder,['name']),i=ue(e.htmlPlaceholder,['user']);if(t&&!i)return 0}0===a&&(a+=ue(e.htmlPlaceholder,r)?10:0),0===a&&ue(e.htmlPlaceholder,['phone','mobile'])&&ue(e.htmlPlaceholder,['email'])&&(a+=10)}let h=0;if(e.visible&&(h+=!h&&ue(e.htmlLabel,r)?12:0,!e.htmlPlaceholder)){h+=!h&&ue(e.labelData,r)?5:0,h+=!h&&ue(e.labelAria,r)?5:0;const t=new RegExp(s.source+'|search','i');h||t.test(e.labelTop)||(h+=ue(e.labelTop,r)?5:0),h||t.test(e.labelRight)||(h+=ue(e.labelRight,r)?5:0),h||t.test(e.labelLeft)||(h+=ue(e.labelLeft,r)?5:0)}return a+=h,a>0&&(e.viewable?a>=10&&(a+=10):u>0?a=0:a>=10&&(a/=2)),'textarea'==e.htmlType&&a>0&&(a/=2),0===a&&'ibank.nbg.gr'===document.location.host&&'/identity/login'===document.location.pathname&&'Κωδικός χρήστη'===e.htmlPlaceholder&&(a+=10),a}return 0},Yi=(e,t,i)=>{if(!e||0===e.length)return null;var n=pe(e,'password');n&&0===n.length&&(t=null);var a=[];a=t?[t]:n.map((function(e){return parseInt(e.elementNumber.substr(2))}));for(var r=null,l=-1,s=e.length;s--;){var o=e[s],d=Gi(o,a,i);d>0&&d>l&&(l=d,r=o)}return r},Xi=(e,t)=>{if(!e||0===e.length)return null;var i=e.length,n=0,a=null;const r=['password','passwort','kennwort','hasło','heslo','salasana','पासवर्ड','密码','пароль','wachtwoord','adgangskode','contraseña','senha','mot de passe','登入密碼','網路密碼'],l=['password','密碼'],s=['user password'],o=['loginpass'];for(let t=0;t<i;t+=1){var d=e[t],u=0;if(d.visible&&!d.isOutsideDocument&&'-1'!==d.tabindex){ue(d.htmlID,o)?u+=40:u+=ue(d.htmlID,l)?8:0,ue(d.htmlName,o)?u+=30:u+=ue(d.htmlName,l)?6:0,ue(d.htmlPlaceholder,s)?u+=20:ue(d.htmlPlaceholder,Dt)?u-=100:u+=ue(d.htmlPlaceholder,r)?10:0;var c=0;c+=!c&&ue(d.htmlLabel,s)?20:0,c+=!c&&ue(d.htmlLabel,r)?10:0,c+=c||d.htmlPlaceholder||!ue(d.labelTop,r)?0:5,c+=c||d.htmlPlaceholder||!ue(d.labelRight,r)?0:5,c+=c||d.htmlPlaceholder||!ue(d.labelLeft,r)?0:5,c+=c||d.htmlPlaceholder||!ue(d.labelData,r)?0:5,(u+=c+=c||d.htmlPlaceholder||!ue(d.labelAria,r)?0:5)>0&&d.viewable&&(u+=20),u>0&&u>n&&(n=u,a=d)}}return a},Zi=(e,t)=>{if(!e||0===e.length)return null;var i=ke(e),n=Se(i),a=pe(n,'password'),r=null,l=null,s=null;if(a&&a.length>0)a=(e=>{if(!e&&0===e.length)return[];var t=[];for(let i=0,n=e.length;i<n;i++){let n=e[i];Ge(n)||t.push(n)}return t})(a),a=(e=>{if(!e&&0===e.length)return[];const t=['cvv','cvv2','cvc2','cvv number','verification code','security code','optional','dummy'],i=['dummy','bot','vcc','cardpincode','cv2_number','ccvnumber','ccvnum','cvvvnum','verifycardcode','cardverificationcode','dccvv','cccvv','security_code','security-code','cardsecuritycode','securitycode','cc.security','cvc_code','cvccode','cccode','cvv','cvv2','cvv2/cvc2','cvv/cvc','cardcsc'];for(var n=[],a=e.length;a--;){var r=e[a],l=0;'password'===r.htmlType?(l+=r.htmlPlaceholder&&ue(r.htmlPlaceholder,t)?100:0,l+=r.htmlID&&ue(r.htmlID,i)?100:0,document.domain.includes('bankofamerica.com')&&r.htmlName.includes('dummy')&&r.visible?l+=r.htmlName&&ue(r.htmlName,t.filter((e=>'dummy'!==e)))?100:0:l+=r.htmlName&&ue(r.htmlName,t)?100:0,l+=r.htmlLength&&r.htmlLength<=4&&-1!==r.htmlLength?100:0,0===(l+=r.htmlLabel&&!ue(r.htmlLabel,['passwort'])&&ue(r.htmlLabel,t)?100:0)&&n.push(e[a])):n.push(e[a])}return n.reverse()})(a),(r=Xi(a))&&ue(r.htmlLabel,['new','confirm'])?((e,t,i,n)=>{if(!(t&&e&&i&&Array.isArray(i)))return!1;const a=t.indexOf(e);if(-1===a)return!1;const r=(t.substring(0,a)+' '+t.substring(a)).split(' ').filter((e=>e));let l=r.indexOf(e);return-1!==l&&i.some((e=>{const t=r.indexOf(e);if(-1===t)return!1;let i=!1,a=!1;return n&&!n.before||(i=n&&n.strictBefore?t===l-1:t<l),n&&!n.after||(a=n&&n.strictAfter?t===l+1:t>l),i||a}))})('password',r.htmlLabel,['new','confirm'],{before:!0,strictAfter:!0,after:!0})&&(r=null):r||(r=(r=a.sort((function(e,t){return e.htmlValue.length-t.htmlValue.length})))&&r.constructor===Array&&r.length>0&&r[0].viewable?r[0]:null);else{var o=/((\b|_|-)pin(\b|_|-)|password|passwort|kennwort|(\b|_|-)passe(\b|_|-)|contraseña|senha|密码|adgangskode|hasło|wachtwoord)/i;if(n&&n.length>0){var d=n.filter((function(e){if('password'===e.htmlType&&(o.test(e.htmlID)||o.test(e.htmlName)||o.test(e.htmlPlaceholder)||o.test(e.htmlLabel)||o.test(e['label-tag'])||o.test(e['label-data'])||o.test(e['label-aria']))&&e.viewable)return!0}));d&&d.length>0&&(r=(r=d.sort((function(e,t){return e.htmlValue.length-t.htmlValue.length})))&&r.constructor===Array&&r.length>0?r[0]:null)}}if(n&&n.length>0&&!(l=r&&r.elementNumber?Yi(n,parseInt(r.elementNumber.substr(2)),t):Yi(n,null,t))&&r)for(var u=n.length,c=parseInt(r.elementNumber.substr(2)),h=u;h--;){var m=n[h],p=m.htmlType;if(parseInt(m.elementNumber.substr(2))<c&&'disc'!==m.cssTextSecurity&&('text'===p||'email'===p||'number'===p||'tel'===p)){m.labelAria&&'code'===m.labelAria.toLowerCase()||(l=m);break}}l&&r&&l===r&&('password'===r.htmlType?l=null:r=null);var f={};if(l){if(((e,t)=>{if(e){var i=/(masked)/i,n=0;if(n+=i.test(e.htmlName)?10:0,n+=i.test(e.htmlID)?10:0,n+=i.test(e.htmlClass)?5:0,(n+=i.test(e.htmlTitle)?5:0)>0)return!0}})(l)&&-1!==(location.hostname+location.pathname).indexOf('online.citi.com/US')){var g=ke(e,!0),b=Se(g),y=null;b&&b.length&&(y=r&&r.elementNumber?Yi(b,parseInt(r.elementNumber.substr(2)),t):Yi(b,null,t))}f.userField=l,f.userFieldAuthentic=y||null}if(r){const t=e.filter((e=>'submit'===e.actualType&&!e.isOutsideDocument));if(1===t.length&&t[0].htmlValue){const e=t[0].htmlValue.toLowerCase();$e(e,['save','update','reset password'])||(f.pswdField=r)}else f.pswdField=r}if(r||l)if(s=Hi(n,null,r))f.loginButton={type:'dict',target:s};else{const t=pe(e,'submit').filter((e=>{const t=(e.htmlValue||'').toLowerCase();return!(t.includes('apple')||t.includes('google'))}));let i=t[0];if(1===t.length&&i&&i.visible&&!i.isOutsideDocument){if(!i.htmlValue||!$e(i.htmlValue.toLowerCase(),['reset password'])){!function(e,t){return'http://www.heroesofnewerth.com/'===document.URL||'https://www.heroesofnewerth.com/'===document.URL||He(e,t)}(r||l,i)||i.htmlValue&&ue(i.htmlValue,['sign up','register','create','join','start','trial','subscribe'])||(f.loginButton={type:'dict',target:t[0]})}}else{var v=$i(r);if(v)f.loginButton={type:'pointer',target:v};else if('e-banking.winbank.gr'===document.location.hostname){const e=f?.pswdField?.tabindex;if(e&&'0'!==e){const t=Number(e)+1,i=document.querySelector(`input[tabindex="${t}"]`),n=i?Me(i):null;n&&qi(n)&&(f.loginButton={type:'dict',target:n})}}}}return f.userField||f.pswdField?f:null},Ji=e=>{let t=0,i=0,n=0,a=0,r=[];if(!e)return t;if(e.htmlAction?.endsWith('/search'))return-100;if(e.fields&&(r=ke(e.fields),r)){if(0===r.length||1===r.length&&('submit'===r[0].htmlType||'button'===r[0].htmlType))return t;var l=r.filter((function(e){return'button'==e.htmlType}));if(1===l.length&&l[0].htmlValue)if('subscribe'===l[0].htmlValue.toLowerCase())return t}const s=Se(r);if(Ki(s))return t;{const r=Zi(e.fields);if(r&&(e.loginFields=r,r.userField&&(i+=r.userField.viewable?30:10),r.pswdField&&(i+=r.pswdField.viewable?30:10),r.loginButton&&('dict'===r.loginButton.type&&r.loginButton.target&&(i+=r.loginButton.target.viewable?30:10),'pointer'===r.loginButton.type&&r.loginButton.target&&(i+=ye(r.loginButton.target)?30:10))),t+=ue(e.htmlID,Bi)?10:0,t+=ue(e.htmlName,Bi)?10:0,t+=ue(e.htmlClass,Bi)?5:0,n+=ue(e.htmlID,ji)?10:0,n+=ue(e.htmlName,ji)?10:0,n+=ue(e.htmlClass,ji)?5:0,a+=ue(e.htmlID,Wi)?5:0,a+=ue(e.htmlName,Wi)?5:0,a+=ue(e.htmlClass,Wi)?5:0,n>0?t-=n:a>0?t=i>0?(t+i)/4:5:t+=i,0===t){const i=['passwordreset','resetpassword','resetpwd'];t+=ue(e.htmlID,i)?10:0,t+=ue(e.htmlName,i)?10:0,t+=ue(e.location,i)?10:0;const n=s.filter((e=>'submit'!==e.htmlType||!e.htmlValue||!['cancel'].includes(e.htmlValue.toLowerCase())));if(2===n.length&&t>0){const i=pe(n,'submit');if(1===i.length&&i[0].htmlValue){const a=i[0].htmlValue.toLowerCase();if(['continue','send password reset email','send','send email'].includes(a)){const i='submit'===n[0].htmlType?n[1]:n[0];if(Qe(i))return e.loginFields={userField:i},t+10}}}}else{if(Ye(document.URL).includes('www.reddit.com')&&!r&&!s.length)return 0}return t}},Qi=(e,t)=>{var i=[],n=[],a=null;if(e)n=e;else if(i=Re(),(n=Be(i))&&n.pageForms&&1===n.pageForms.length){var r=n.pageForms[0];if(r.fields&&1===r.fields.length&&'password'===r.fields[0].htmlType){var l=pe(i,'text');l&&1===l.length&&(n={pageFields:i})}}if(!n)return null;let s=tn(n);if(s)return t?{score:200,form:s}:s;if(n&&n.pageForms&&null!==(a=We(n.pageForms,Ji,!0))&&a.score>0)return t?{score:a.score,form:a.result}:a.result;if(!a||!a.result){var o=(e=>{const t=location.hostname+location.pathname;return e?e&&0===e.length?null:-1!==t.indexOf('accounts.google.com')?e[0]:null:null})(n.pageForms);if(o)return t?{score:200,form:o}:o;if(n&&n.pageFields){var d=Zi(n.pageFields);if(d&&Object.keys(d).length>0)return t?{score:1,form:{type:'login_fields',loginFields:d}}:{type:'login_fields',loginFields:d}}}return null},en=(e,t,i)=>{if(!e)return!1;if(e&&e.userFieldAuthentic){var n=Ve(e.userFieldAuthentic,i);n&&(n.value=t.username)}if(e&&e.userField){let n=Ve(e.userField,i),a=Qe(e.userField)?t.email||t.username:t.user_name||t.username;if(n&&a){n.hasAttribute('value')&&n.removeAttribute('value'),n.hasAttribute('readonly')&&(n.readOnly=!1),di(n)>0&&t.email&&(a=t.email),te.manageConcealer(n,t?.reveal_restricted?.includes('email')||t?.reveal_restricted?.includes('username'),(()=>at(n,a)))}}if(e&&e.pswdField){var a=Ve(e.pswdField,i),r=!1;if('text'===e.pswdField.htmlType){var l=se(i,'input[type=password]');if(l&&l.length>0){var s=l.filter((function(e){return!fe(e)}));s&&s.length>0&&(ae(a,'focus'),s.forEach((function(e){fe(e)&&(e.value=t.password,r=!0)})))}}if(a&&t&&t.password&&!r){var o=t.password;if(t.append_2fa_to_password){var d=Je(t);d&&(o=t.password+d)}te.manageConcealer(a,t.reveal_restricted?.includes('password'),(()=>at(a,o)))}}},tn=e=>{if('signin.aws.amazon.com'===location.hostname){let t=document.querySelectorAll('.aws-signin-textfield'),i=document.querySelector('#password'),n=document.querySelector('#signin_button');if(i&&fe(i)&&n&&fe(n))return!1;if(t&&3===t.length&&e.pageFields){let t=null,i=null,n=null;for(let a=0,r=e.pageFields.length;a<r;a++){let r=e.pageFields[a];if('resolving_input'===r.htmlID&&(t=r),'next_button'===r.htmlID&&(n=r),t&&n&&i)break}return{loginFields:{userField:t,loginButton:{target:n,type:'dict'}},type:'login_fields'}}}return!1},nn=(e,t)=>{if((e=>{if('www.icloud.com'===location.hostname||'idmsa.apple.com'===location.hostname){var t=document.getElementById('sign-in');if(t)return t.click(),setTimeout((function(){t.click()}),1500),!0}if(location.hostname.includes('hubspot.com')){const t=Hi(e.fields);if(t)return t.pointer?.click(),!0}return!1})(e))return!0;if(t&&t.loginButton){if('pointer'===t.loginButton.type&&t.loginButton.target&&t.loginButton.target.click(),'dict'===t.loginButton.type&&t.loginButton.target){if(0===document.URL.indexOf('https://www.tumblr.com/login')&&!t.loginButton.target.visible)return;const i=Ve(t.loginButton.target,e.idoc);if(ve(i,'disabled'))return!1;if(i)return i.click(),!0}}else if(e.htmlAction&&-1===e.htmlAction.indexOf('.aspx')&&'post'===e.htmlMethod){const i=t.userField||t.pswdField;if(i){const t=Ve(i,e.idoc);if(t){const e=t.form;if(e){const i=e.parentElement,n=i?i.tagName:'';if(n&&'body'!==n.toLowerCase())return qe(t.form),!0}}}}return!1},an=(e,t)=>{if(!e||!t)return null;let i=null;const n='autofill_onload'===t.autofillType&&Tn(e);return e&&'login_fields'===e.type?(n||(i=e.loginFields),en(i,t,e.idoc)):(i=Zi(e.fields),n||en(i,t,e.idoc)),i},rn=(e,{clientData:t,uuid:i},n)=>{if(!(e&&t&&(t.email||t.username||t.user_name||t.password)))return;var a=an(e,t);if(!a&&e.loginFields){const i=e.loginFields.userField,n=e.loginFields.pwdField;if(i&&!n&&Qe(i)){let e=Ve(i);e&&t.email&&te.manageConcealer(e,t.reveal_restricted?.includes('email'),(()=>at(e,t.email)))}}let r=!1;if(e.fields&&t.totp_1){let i=on(e.fields);if(i){let e=Ve(i),n=Je(t);e&&n&&(te.manageConcealer(e,t.reveal_restricted?.includes('totp_1')||t.reveal_restricted?.includes('totp_2'),(()=>at(e,n))),r=!0)}}if(a&&t&&t.autoSubmit&&!Ke()){new Promise((function(t,i){setTimeout((()=>{if(!a?.loginButton&&!e?.htmlAction)return void i();const n=nn(e,a);r||!n?i():t()}),600)})).then((function(){return new Promise((function(e,n){if(!t.password)return void e();const r=a.pswdField;if(r&&r.visible&&r.viewable)e();else if(pt()){const i=setInterval((()=>{const a=document.getElementById('loginpassword'),r=document.querySelector('input[autocomplete="one-time-code"]'),l=document.querySelector('div[class*="container-error"]'),s=document.querySelector('div[class*="invalid-feedback"]');if(r||l||s)return clearInterval(i),void n();if(a&&t?.password){const n=document.querySelector('button[type="submit"]');return te.manageConcealer(a,t.reveal_restricted?.includes('password'),(()=>at(a,t.password))),clearInterval(i),n&&n.click(),void e()}}),500)}else setTimeout((()=>{let a=Re(null,i),r=Be(a),l=Qi(r);if(l){const i=l.loginFields?.pswdField;if(i&&i?.visible&&i?.viewable){const i=an(l,t);Ke()?e():setTimeout((()=>{nn(l,i),e()}),200)}else e()}else n()}),2200)}))}),(function(){n({isTotpExist:!0})})).then((function(){if(!t.totp_1)return void n({isTotpExist:!0});let e='www.dropbox.com'===document.domain?8e3:2e3,a=()=>{if(pt()){const e=document.querySelector('button[type="submit"]');e&&setTimeout((()=>{e.click()}),500)}};t.totp_1?setTimeout((()=>{if(ln(t,{uuid:i},n))a();else{let e='www.dropbox.com'===document.domain?1e4:2e3;setTimeout((()=>{ln(t,{uuid:i},n)&&a()}),e)}}),e):n()}),(function(){n({isTotpExist:!0})}))}else n({isTotpExist:!1})},ln=(e,t,i)=>{let n=t?.uuid,a=Re(null,n),r=on(a);if(r){let t=Ve(r),n=Je(e);if(t&&n){if(te.manageConcealer(t,e.reveal_restricted?.includes('totp_1')||e.reveal_restricted?.includes('totp_2'),(()=>at(t,n))),i&&i({isTotpExist:!0}),e.autoSubmit){let e=(e=>{var t=Hi(e,null);if(!t){var i=pe(e,'submit');if(i.length>1){var n=i.filter((function(e){return e.viewable&&e.visible}));0!==n.length&&(i=n)}let a=i[0];if(1!==i.length||!a||!a.visible||a.isOutsideDocument||a.htmlValue&&ue(a.htmlValue,['sign up','register','create','join','start','trial','subscribe','pending','verifying']))return $i();t=i[0]}return t?Ve(t):null})(a);if(e){const t=/.*enpass\.io$/gi,i=new URL(document.URL).hostname;t.test(i)?setTimeout((()=>{e.click()}),600):e.click()}else{if(-1!==Ye(document.URL).indexOf('countabout.com')){const e=document.getElementById('verifyMFABtn');e&&e.click()}}}return!0}i&&i({isTotpExist:!1})}else i&&i({isTotpExist:!1});return!1},sn=(e,{clientData:t,uuid:i},n)=>{if(!e||!t)return void n({isTotpExist:!1});if(-1!==(location.hostname+location.pathname).indexOf('accounts.google.com')){const s=e&&e.fields?e.fields:[],o=s?pe(s,'email'):null;let d=document.querySelectorAll('input[type="password"]');if(o&&1===o.length&&o[0]&&o[0].visible){const i=Ve(o[0]),s=document.querySelector('#next')||document.querySelector('#identifierNext'),u=t?.passkey_exists??!1,c=!!(t.isPasskeySupported??!1)&&u,h=function(){if(!t.password||c)return;const e=document.getElementsByName('password');if(e&&1===e.length)te.manageConcealer(e[0],t.reveal_restricted?.includes('password'),(()=>at(e[0],t.password)));else{d=document.querySelectorAll('input[type="password"]');for(var i=0,n=d.length;i<n;i++){var a=d[i];if(a&&fe(a)&&t?.password){te.manageConcealer(a,t.reveal_restricted?.includes('password'),(()=>at(a,t.password)));break}}}};var a=0,r=[function(){if(!document.querySelector('[role="presentation"][aria-busy="true"]')){var e=Qe(o[0])?t.email||t.username:t.user_name||t.username;e&&te.manageConcealer(i,t.reveal_restricted?.includes('username'),(()=>{at(i,e)}))}},function(){const e=document.getElementsByName('password');document.querySelector('[role="presentation"][aria-busy="true"]')||s&&!e[0]&&s.click()},h,h,function(){if(t.password&&!c){if(t.autoSubmit){var i=document.querySelector('#passwordNext');if(i)i.click();else if(e&&'login_fields'!==e.type){var a=Ve(e);a&&qe(a)}}n({isTotpExist:!1})}else n({isTotpExist:!1,showInlineMenu:!0})}],l=function(){const e=c?1:200;r[a++](),a<r.length&&setTimeout(l,400+a*e)};l()}else if(d&&d.length>0){for(let e=0,i=d.length;e<i;e++){const i=d[e];if(i&&fe(i)&&t?.password){te.manageConcealer(i,t.reveal_restricted?.includes('password'),(()=>at(i,t.password)));break}}n({isTotpExist:!1});const e=document.querySelector('#passwordNext')||document.querySelector('#signIn');e&&t.autoSubmit&&setTimeout((function(){e.click()}),500)}else rn(e,{clientData:t,uuid:i})}else rn(e,{clientData:t,uuid:i},n)},on=e=>{const t=[/(auth|authenticator|authorization|authentication|verification|generated|2fa|mfa|two-factor)\W(app|code|token|pin)/i,/(two|2) step verification (code|token)/i,/(two|second|2) factor (auth|token|code)/i,'2 fa code',/[6,six][-,\s]digit code/i,'pin','otp','one time code','authenticator','2fa'],i=['googleauthenticator','totp','totppin','useroathcode','twofactorcode','totpcode','secondfactor','twofactortoken','2fa',/mfa[-_]?code/i,/^twofa$/i,'twofacode','otp',/ga[\W_]code/i,/(authentication|auth|verification)[\W_](code|token|pin)/i];let n=-1;const a=['banking pin','postcard pin'];let r=null;if(!e||e.constructor===Array&&!e.length)return null;e&&e.constructor===Object&&(e=[e]);let l=!1;for(let s=0,o=e.length;s<o;s++){const o=e[s];let d=0;if(o.visible&&o.viewable&&['text','tel','number','password'].includes(o.htmlType)){d+=$e(o.htmlPlaceholder,t)?10:0,o.htmlID&&o.htmlID.toLowerCase().includes('pin')&&$e(o.htmlID,['member'])?d-=50:d+=$e(o.htmlID,i)?10:0,o.htmlName&&o.htmlName.toLowerCase().includes('pin')&&$e(o.htmlName,['member'])?d-=50:d+=$e(o.htmlName,i)?10:0;let e=0;if(o.htmlLabel&&('password'===o.htmlLabel.toLowerCase()&&(e-=10),o.htmlLabel.toLowerCase().includes('pin')&&(l=dn(),ue(o.htmlLabel,a)&&(e-=80),(l||o.htmlLength<6)&&(e-=80)),0==e&&(e+=e||!$e(o.htmlLabel,t)||$e(o.htmlLabel,['password'])?0:10),0===e&&o.htmlLabel.includes('code'))){const t=Ve(o);if(t&&t.form&&t.form.action){const i=t.form.action;i.includes('verify')&&i.includes('totp')&&(e+=5)}}if(o.htmlPlaceholder&&'000000'!==o.htmlPlaceholder&&'123456'!==o.htmlPlaceholder||(e+=!e&&$e(o.labelTop,t)?5:0,e+=!e&&$e(o.labelRight,t)?5:0,e+=!e&&$e(o.labelLeft,t)?5:0,e+=!e&&$e(o.labelData,t)?5:0,e+=!e&&$e(o.labelAria,t)?5:0),0===e&&(e+=!e&&$e(o.labelAttr,t)?5:0),d+=e,d>0&&o.viewable&&('password'===o.htmlPlaceholder?.toLowerCase()?d-=20:d+=20),0===d&&(6!==o.htmlLength&&9!==o.htmlLength||(d+=$e(o.htmlPlaceholder,['code','123456'])?10:0)),0===d&&(d+=['one-time-code'].includes(o.autoCompleteType)?10:0,d>0&&'Password'===o.htmlPlaceholder)){'https://www.bitmart.com'===Ye(document.URL)&&(d-=10)}0===d&&$e(o.htmlName,['code'])&&!o.htmlLabel&&(d+=$e(o.labelLeft,['6 stelligen code eingeben'])?10:0),d>0&&d>n&&(n=d,r=o)}}return r},dn=()=>{var e=document.querySelectorAll('a');if(!e)return!1;for(var t=0,i=e.length;t<i;t++){var n=e[t].textContent;if(n&&n.toLowerCase().includes('forgot pin'))return!0}return!1},un=e=>{var t=null;if(e&&e.hasForm){let i=Ve(e);i&&(t=i.form)}return t},cn=e=>{var t=[],i=[],n=[],a=[];if(e){for(var r=0,l=e.length;r<l;r++){var s=e[r],o=null,d=null;if(s.hasForm){if(!(o=un(s)))continue;-1===(d=t.indexOf(o))?(t.push(o),i[d=t.length-1]?i[0].push(s):i.push([s])):i[d].push(s)}else n.push(s)}t.length>0&&(a=((e,t)=>{if(!e)return null;for(var i=[],n=0,a=e.length;n<a;n++){var r={},l=e[n],s=l.getAttribute('action'),o=l.getAttribute('id'),d=l.getAttribute('name'),u=l.getAttribute('method');'string'==typeof s&&''!==s&&(r.htmlAction=s),'string'==typeof o&&''!==o&&(r.htmlID=o),'string'==typeof d&&''!==d&&(r.htmlName=d),'string'==typeof u&&''!==u&&(r.htmlMethod=u),t.length>0&&t[n]&&(r.fields=t[n]),ot()||(r.location=l.ownerDocument.URL,r.domain=l.ownerDocument.domain,r.hostname=l.ownerDocument.location.hostname,r.pathname=l.ownerDocument.location.pathname,r.iframeUrl=l.ownerDocument.URL),i.push(r)}return i})(t,i));var u={};return a.length&&(u.pageForms=a),n.length&&(u.pageFields=n),Object.keys(u).length?u:null}},hn=(e,t)=>{if(!e||!e.length)return null;for(var i=null,n=null,a=[],r=[],l=0;l<e.length;l++){var s=e[l];if(s&&(s.htmlType,s.htmlValue.length>0||s.disabled&&s.htmlPlaceholder)){const e=/(first|last|full)[-_\s]?name/i;if(!(/verificationcode/i.test(s.htmlName)||e.test(s.htmlName)||e.test(s.htmlID)||e.test(s.htmlLabel)||e.test(s.labelAria)||e.test(s.autoCompleteType))&&['text','tel','email'].includes(s.htmlType)){const e=s.htmlValue.toLowerCase();['dd/mm/yyyy'].includes(e)||r.push(s)}'password'===s.htmlType&&s.visible&&a.push(s)}}if(a.length>0){let e=a.length>2?Ci(yt,a,!1,!1,null):null;e&&e.length?(e[0].enpassType='password',i=e[0]):(a.sort((function(e,t){return t.htmlValue.length-e.htmlValue.length})),(i=Xi(a))?i.enpassType='password':a[0]&&(a[0].enpassType='password',i=a[0]))}if(r.length>0){var o=Ci(Ai,r,!0,!1,null);if(o.length>0&&(o=(o=o.sort((function(e,t){return t[0]-e[0]}))).map((function(e){return e[1]}))),o.length&&o[0])o[0].enpassType='username',n=o[0];else if(1===r.length&&r[0]){let e=r[0]?r[0].htmlValue:'';e&&e.trim()&&(r[0].enpassType='username'),n=r[0]}else{let e=r.filter((function(e){if(e&&e.htmlLength>6){if(e.userEdited&&('username'===e.autoCompleteType||'email'===e.enpassType))return!0;if(e.disabled&&'email'===e.enpassType&&e.htmlPlaceholder)return!0}return!1}));if(e&&e.length)e[0].enpassType='username',n=e[0];else{let e=r.filter((function(e){return e&&e.htmlLength>6&&('username'===e.autoCompleteType||e.userEdited)}));e.length>0&&e[0]&&(e[0].enpassType='username',n=e[0])}}}var d={};if(n){let e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,t=n.htmlValue||n.disabled&&n.htmlPlaceholder||'';t&&e.test(t)?(d.email=t,n.enpassType='email'):d.username=n.htmlValue,d.usernameID=n.elementNumber}return i&&(d.password=i.htmlValue,d.passwordID=i.elementNumber),Object.keys(d).length?d:null},mn=(e,t)=>{e||(e=Re(null));var i=Se(e),n=(e=>{if(!e||0===e.length)return null;for(var t,i=[],n=!1,a=0,r=e.length;a<r;a++){var l=e[a];if(l.userEdited||l.htmlValue&&(l.visible||l.viewable)||l.htmlPlaceholder&&l.disabled&&Qe(l)){const e=l.htmlValue.toLowerCase();if(['dd/mm/yyyy'].includes(e))continue;if(!/hidden|submit|image|textarea|reset|button/i.test(l.htmlType)||'username'===(t=l).htmlID&&'textarea'===t.htmlType){if(!n&&l.userEdited)n=!0;else if(/^enter.*$/i.test(l.htmlValue))continue;'select-one'===l.htmlType||'checkbox'===l.htmlType||'radio'===l.htmlType?l.userEdited&&i.push(l):i.push(l)}}}return n?i:[]})(i);if(!(e=>{if(!e)return!1;var t=e.reduce((function(e,t){return'password'===t.htmlType&&(e.passwordFields+=1,on(t)&&(e.totpFields+=1)),e}),{passwordFields:0,totpFields:0});return 0!==t.passwordFields&&0!==t.totpFields&&t.passwordFields===t.totpFields})(n)){var a={secure_data:{}};if(n&&n.length){var r=In(document.querySelectorAll('input[type=password]')),l=!1;if(0===r.length)(r=pe(n,'password')).length&&(l=r.some((function(e){return e.visible})));else for(var s=0,o=r.length;s<o;s++){var d=r[s];if(d.value&&fe(d)){if('yes'===d.dataset.enpassusermodified){l=!0;break}if(ye(d)&&d.value.length>7){l=!0;break}}}if(l){var u=null;n=(e=>{var t=Ci(di,e,!0,!1,null);if(t.length>0){let i=(t=t.sort((function(e,t){return t[0]-e[0]})))[0][1];i&&e.map((e=>e.elementNumber===i.elementNumber?(e.enpassType='email',e):e))}return e})(n);var c=cn(i),h=cn(n);if(c&&c.pageForms)for(var m=c.pageForms,p=0,f=m.length;p<f;p++){let e=m[p],i=t||Ki(e.fields),r=i?gn(c,e):null;if(i&&r)return{type:'update_password',secure_data:r,webform:[]};if(u=hn([...e.fields])){if(a.type='update_login',h)if(h.pageForms&&h.pageFields){if(a=pn(n))return a}else h.pageForms&&!h.pageFields?h.pageForms.length>1?(a.webform=[].concat({htmlId:'default-form',htmlName:'default-form',fields:fn(n,u),hostname:h.pageForms[1].hostname,pathname:h.pageForms[1].pathname,location:Ye(h.pageForms[1].location),iframeUrl:h.pageForms[1].location,domain:h.pageForms[1].domain}),a.formCaptureType='signup'):a.webform=h.pageForms.map((function(e){if(e.fields){let t=e.fields.map((function(e){let t=e.elementNumber;return u.usernameID&&t===u.usernameID&&(u.email?e.enpassType='email':e.enpassType='username'),u.passwordID&&t===u.passwordID&&(e.enpassType='password'),e}));Tn(e)?(a.formCaptureType='signup',e&&e.location&&(e.location=Ye(e.location))):a.formCaptureType='signin',e.fields=fn(t,u)}return e})):a.webform=[];if(u.username&&(a.secure_data.username=u.username,a.secure_data.user_name=u.username),u.email&&(a.secure_data.email=u.email),u.password)return a.secure_data.password=u.password,a}}var g=c&&c.pageFields,b=h&&h.pageFields;return pn(g,b)}}return null}},pn=(e,t)=>{if(e){let n={pageFields:e};if(Ki(n.pageFields)){let e=gn(n);if(e)return{type:'update_password',secure_data:e,webform:[]}}else{var i=hn(n.pageFields);if(i){let n={type:'update_login'};return n.secure_data={password:i.password},i.email?n.secure_data.email=i.email:n.secure_data.username=i.username,n.formCaptureType='signup',n.webform=[].concat({htmlId:'default-form',htmlName:'default-form',fields:fn(t||e,i),location:Ye(document.URL),iframeUrl:document.URL,domain:document.domain,hostname:document.location.hostname,pathname:document.location.pathname}),n}}}return null},fn=(e,t)=>e&&t?e.filter((function(e){return!(t&&t.password&&t.passwordID&&e&&'password'===e.htmlType&&e.htmlValue===t.password&&e.elementNumber!==t.passwordID)})):e,gn=(e,t)=>{if(!e)return null;var i=null;if(i=Et(t?t.fields:e.pageFields)){var n='',a='';return i.currentPasswordField&&(n=i.currentPasswordField.htmlValue),i.newPasswordField&&(a=i.newPasswordField.htmlValue),!a&&i.confirmPasswordField&&(a=i.confirmPasswordField.htmlValue),a?{oldPassword:n,newPassword:a,password:a}:null}},bn=(e,t,i)=>{if(!e||!t)return!1;var n=de(ve(t,'type')),a=ve(t,'name'),r=Te(t),l=fe(t),s=ye(t),o=!1;if(!n||!e.htmlType||n!==e.htmlType)return!1;if(o=!0,a&&e.htmlName){if(a!==e.htmlName)return!1;o=!0}if(r&&e.htmlLabel)if(r===e.htmlLabel)o=!0;else{if('meine.deutsche-bank.de'!==document.domain||0!==r.indexOf(e.htmlLabel))return!1;o=!0}return(!i||!i.viewable||s===e.viewable)&&(l===e.visible&&(!('password'!==n&&l!==e.visible&&!t.hasAttribute('onfocus'))&&o))},yn=(e,t)=>{if(!e)return null;var i=null;const n=(e,t)=>Array.prototype.slice.call(e.elements).includes(t);if(e.elementNumber&&(i=Ve(e),bn(e,i)))return t?n(t,i)?i:null:i;if(e.htmlID){const s=document.getElementById(e.htmlID);let o=r(e.htmlID)?document.querySelectorAll('#'+e.htmlID):[];if(!r(e.htmlID)&&s&&(o=[s]),1==o.length&&bn(e,i))return t?n(t,i)?i:null:i;if(o.length>1)for(var a=0,l=o.length;a<l;++a)if(i=o[a],bn(e,i,{viewable:!0}))return t?n(t,i)?i:null:i}if(e.htmlName){var s=document.getElementsByName(e.htmlName);for(let a=0,r=s.length;a<r;++a)if(i=s[a],bn(e,i))return t?n(t,i)?i:null:i}return null},vn=e=>{if(e&&e.length>0)for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n){var a=n.fieldType,r=n.fieldPointer;'checkbox'!==a&&'radio'!==a?n.fieldValue&&te.manageConcealer(r,n.reveal_restricted,(()=>at(r,n.fieldValue,n.userEdited))):'checkbox'!==a&&'radio'!==a||(r.checked=!0)}}},wn=(e,t)=>{if(!e||!t)return null;const i=t.filter((t=>{if('hidden'===t.htmlType)return!1;let i=!0,n=6;return t.elementNumber!==e.elementNumber&&(n-=1,i=!1),t.htmlType!==e.htmlType&&(n-=1,i=!1),e.tabindex&&t.tabindex!==e.tabindex&&(i=!1,n-=1),e.htmlLabel&&t.htmlLabel!==e.htmlLabel&&(i=!1,n-=1),e.htmlPlaceholder&&t.htmlPlaceholder!==e.htmlPlaceholder&&(i=!1,n-=1),e.htmlLength&&t.htmlLength!==e.htmlLength&&(i=!1,n-=1),e.disabled&&t.disabled!==e.disabled&&(i=!1,n-=1),e.viewable!==t.viewable&&e.visible!==t.visible&&(i=!1,n-=1),e.labelLeft&&t.labelLeft!==e.labelLeft&&(i=!1,n-=1),i&&6===n}));if(1===i.length){let e=i[0];return Ve(e)}return null},_n=(e,t,i,n,a)=>{if(!e)return!1;for(var r=[],l=0,s=e.length;l<s;++l){var o=e[l];if(o){if(o.hostname!==location.hostname&&o.pathname!==location.pathname)return!1;var d=o.valueMap;if(!d||0===Object.keys(d).length)continue;var u=document.querySelector('form[action= "'+o.htmlAction+'"]');if(o.htmlAction&&!u){if(o.htmlID&&'default-form'!==o.htmlID&&!document.getElementById(o.htmlID))return!1;if(o.htmlName&&'default-form'!==o.htmlName){var c=document.getElementsByName(o.htmlName);if(c&&0===c.length)return!1}}const e=o.fields,t=o?.reveal_restricted;let n=null;if(e)for(let a=0,l=e.length;a<l;a++){const l=e[a];if(n=yn(l),!n&&i&&(n=wn(l,i.fields)),!n)return!1;r.push({fieldPointer:n,fieldValue:d[l.item_field_uid]||l.htmlValue,fieldType:l.htmlType,userEdited:l.userEdited,enpassType:l.enpassType,reveal_restricted:t?.includes(l.item_field_uid?.toString())})}}}if(0===r.length)return a({isTotpExist:!0}),!1;vn(r);let h=null;n&&i&&(h=i.loginFields?i.loginFields:Zi(i.fields),en({userField:h.userField},n,i.idoc));let m=ln(t,null,a);if(t.autoSubmit&&!Ke()){var p=(e=>{if(!e&&0===e.length)return null;for(var t=[],i=[],n=[],a=0,r=null,l=0,s=e.length;l<s;++l){var o=e[l];if(o&&o.fieldPointer){var d=o.fieldPointer.form;d&&!t.includes(d)&&t.push(d),'password'===o.fieldType&&i.push(o.fieldPointer)}}if(t&&t.length>0)t.forEach((function(e){if(e){var t=e.elements;if(t)for(var i=0,a=t.length;i<a;++i){var r=t[i];('BUTTON'===r.tagName||'INPUT'===r.tagName&&['submit','button','image'].includes(r.type))&&n.push(r)}}}));else for(var u=document.querySelectorAll('input,button'),c=0,h=u.length;c<h;++c){var m=u[c];('BUTTON'===m.tagName||'INPUT'===m.tagName&&['submit','button','image'].includes(m.type))&&n.push(m)}return n&&n.length>0&&n.forEach((function(e){var t=Me(e);if(t&&i&&i.length)for(var n=0,l=i.length;n<l;++n){var s=i[n],o=s.getAttribute('data-enpassid');if(o&&t.elementNumber){var d=parseInt(o.substr(2));if(parseInt(t.elementNumber.substr(2))<d)continue}var u=qi(t,!0,null);u>0&&(e.form&&s.form&&e.form===s.form&&(u+=50),u>a&&(a=u,r=e))}})),r})(r);if(p||(!h&&i?(h=i.loginFields?i.loginFields:Zi(i.fields),p=h?h.loginButton:null):p=h?h.loginButton:null),p)new Promise((function(e,t){setTimeout((()=>{if('dict'===p.type){let e=Ve(p.target);e&&e.click()}else p.target?p.target.click():p.click();e()}),600)})).then((function(){let e='www.dropbox.com'===document.domain?8e3:2e3;setTimeout((()=>{if(m=ln(t,null,a),!m){let e='www.dropbox.com'===document.domain?1e4:2e3;setTimeout((()=>{ln(t,null,a)}),e)}}),e)}))}else a({isTotpExist:!0});return!0},Tn=(e,t=[],i)=>{if(!e)return!1;const n=['signup','sign_up','sign up','register','create','reg','join','start','trial','reset_password','get-started','accountsetup'],a=['sign up','register','get started','join','start trial','konto erstellen','jetzt anmelden',/^create\W?\S?.\W?account$/i],r='facebook,apple,twitter,linkedin,google,github,back,zurück zum,show password'.split(',');let l=0;const s=(e=[])=>{const t=e.filter((e=>e.visible&&e.viewable&&['text','email','tel'].includes(e.htmlType)));if(t&&t.length>0){const e=Oi(t);if(e){if(e.fullName&&e.fullName.length>0)return!0;if(e.fname&&e.fname.length>0)return!0}}return!1};if('login_fields'===e.type){const i=e.loginFields?e.loginFields.pswdField:null,n=Ve(i);if(n){let e=st(n,'button');e=e||st(n,'input','submit'),e=e||st(n,'input','button');const o=t.filter((e=>'password'===e.htmlType));if(o.length>1){const e=o.filter((e=>!(!e.htmlLabel||!/(confirm|verify|reenter|repeat|re\s?type).+?(new)?.*?(password)/i.test(e.htmlLabel))));if(e.length>0){const t=e[0],n=t&&t.pointer&&i&&i.pointer;(t.identifier!==i.identifier||n&&t.pointer!==i.pointer)&&(l+=10),l>0&&(l+=document.location.pathname.includes('register')?10:0)}}else{const e=o[0];e&&ue(e.htmlPlaceholder,Dt)&&(l+=20)}if(e){const i=e.filter((e=>{const t='INPUT'===e.tagName?e.value.toLowerCase():e.textContent.toLowerCase(),i=Array.prototype.slice.call(e.classList),n=i?.some((e=>$e(e,r)));return!n&&!$e(t,r)}));if(1===i.length){const e=i[0]&&'INPUT'===i[0].tagName?i[0].value.toLowerCase():i[0].textContent.toLowerCase();$e(e,a)&&(l+=20)}else 0===i.length&&(l+=s(t)?10:0)}}else l+=s(t)?10:0}else{l+=ue(e.htmlID,n)?5:0,l+=ue(e.htmlName,n)?5:0,l+=ue(e.htmlClass,n)?5:0,l>0&&(l-=ue(e.htmlID,['createsessionform'])?5:0);const t=ue(Ze(e.location),n);if(i&&i.isCreditCard)ue(Ze(e.location),['register'])||(l+=t?5:0);else{const i=Ze(e.location);i?.includes('/login')||e.location?.startsWith('https://signin.')||(l+=t?5:0)}const o=e.htmlAction;if(l>0&&o){o.startsWith('/login')||o.endsWith('/login')||o.startsWith('/signin')||o.endsWith('/signin')||'login'===o?l-=10:-1!==o.indexOf('/login/')&&(l-=5)}if(e.fields){let i=0;e.fields.filter((e=>'password'===e.htmlType&&('new-password'===e.autoCompleteType||'new-password'===e.htmlName))).length>0&&(i+=10);const n=e.fields.filter((function(e){return('button'==e.htmlType||'submit'===e.htmlType)&&e.visible}));if(1===n.length&&n[0].htmlValue){const r=n[0].htmlValue.toLowerCase();$e(r,a)?l+=20:$e(r,Ft)&&(i=0,t&&'continue'!==r&&e.htmlAction&&!e.htmlAction.includes('signup')&&(l-=5))}else{const e=n.filter((e=>{if(!('submit'===e.htmlType))return!1;return!r.some((t=>{const i=e.htmlValue?.toLowerCase();return i.includes(t)}))}));if(1===e.length&&e[0].htmlValue){const n=e[0].htmlValue.toLowerCase();if($e(n,a))l+=20;else if($e(n,Ft)){i=0,t&&(l-=5);Ye(document.URL).includes('etsy')&&(l-=5)}}else if(2===e.length){const t=e[0].htmlValue?.toLowerCase(),i=e[1].htmlValue?.toLowerCase();let n=[];t&&!['clear'].includes(t)&&n.push(t),i&&!['clear'].includes(i)&&n.push(i),1===n.length&&$e(n[0],a)&&(l+=20)}}l+=i,e.confirmPasswordField&&(l+=10),0===l&&e.fields&&e.fields.length>0&&(l+=s(e.fields)?10:0,e&&e.cvvField&&e.expiryField&&(l-=10))}}return l>0},Ln=e=>{const t=/^(what|when|how|how|where|whose|which|in|on|is).*\?/gi;var i=0;return i+=e.htmlLabel&&t.test(e.htmlLabel)?2:0,i+=e.labelData&&t.test(e.labelData)?2:0,i+=e.labelAria&&t.test(e.labelAria)?2:0,(i+=e.labelAttr&&t.test(e.labelAttr)?2:0)>0},In=e=>{if(e){var t=[];for(let i=0,n=e.length;i<n;i++){let n=e[i],a=Me(n);!fe(n)||Ln(a)||Ge(a)||t.push(n)}return t}return[]},En=()=>{const e=oe();let t=!1;return e.length>0&&(t=e.some((e=>te.fieldInstances.has(e)))),t};class Fn{constructor(){}getFieldOrder(e){if('input'===e?.tagName.toLowerCase()){let t=document.querySelectorAll(`${e.tagName}[type=${e.getAttribute('type')}]`),i=Array.prototype.slice.call(t);if(i.length>0){const t=i.indexOf(e);if(-1!==t)return t}}return Array.prototype.slice.call(document.querySelectorAll(`${e.tagName}`)).indexOf(e)}generateFieldIdentifier(e){if(e)return[e.htmlTag,e.htmlType,e.actualType,e.typeOrder,e.htmlID,e.htmlName,e.htmlPlaceholder,e.autoCompleteType,e.htmlLabel,e.tabindex,e.htmlLength,e.labelAria,e.labelAttr,e.labelData,e.hasForm,e.formId,e.formName,e.formAction,e.htmlValue].join('||')}deocodeFieldIdentifierAttributes(e){if(!e)return null;const[t,i,n,a,r,l,s,o,d,u,c,h,m,p,f,g,b,y,v]=e.split('||');return{htmlTag:t,htmlType:i,typeOrder:a,htmlID:r,htmlName:l,htmlPlaceholder:s,autoCompleteType:o,htmlLabel:d,tabindex:u,htmlLength:c,labelAria:h,labelAttr:m,labelData:p,hasForm:f,formId:g,formName:b,formAction:y,htmlValue:v,actualType:n}}extractFieldAttributes(e,t){if(!e||['reset','hidden'].includes(de(e.type)))return null;let i={};const n=de(e.type),a=['ajax','csrf'];let r=e.maxLength;if((!r||'number'==typeof r&&isNaN(r))&&(r=999),me(i,'htmlID',ve(e,'id')),me(i,'htmlName',ve(e,'name')),(i.htmlID&&a.includes(i.htmlID)||i.htmlName&&a.includes(i.htmlName))&&'password'!==n)return null;if(i.visible=fe(e),i.viewable=ye(e),i.typeOrder=this.getFieldOrder(e),i.elementNumber=`__${t}`,i.isOutsideDocument=!be(e),i.hasForm=!!e.form,i.formId=i.hasForm&&e.form.id||void 0,i.formName=i.hasForm&&e.form.name||void 0,i.formAction=i.hasForm&&e.form.action||void 0,i.cssTextSecurity=Pe(e),i.htmlTag=e.tagName,me(i,'htmlClass',ve(e,'class')),me(i,'tabindex',ve(e,'tabindex')),me(i,'htmlTitle',ve(e,'title')),me(i,'rel',ve(e,'rel')),me(i,'htmlType',de(ve(e,'type'))),me(i,'actualType',e.getAttribute('type')),me(i,'enpassType','password'===i.htmlType?'password2':'text'),e.tagName&&'button'===e.tagName.toLowerCase()){if(me(i,'htmlValue',(e.textContent||e.value).trim()),!i.htmlValue){const t=e.querySelector('svg');if(t){const e=t.getAttribute('aria-label');e&&me(i,'htmlValue',e.trim())}}}else me(i,'htmlValue',e.value||e.textContent);if(i&&i.htmlType&&'image'===i.htmlType&&(me(i,'imageAlt',ve(e,'alt')),me(i,'imageSrc',ve(e,'src'))),me(i,'checked',e.checked),me(i,'autoCompleteType',e.getAttribute('x-autocompletetype')||e.getAttribute('autocompletetype')||e.getAttribute('autocomplete')),me(i,'disabled',e.disabled),me(i,'readonly',e.readonly),me(i,'selectOption',he(e)),me(i,'aria-hidden','true'==e.getAttribute('aria-hidden')),me(i,'aria-disabled','true'==e.getAttribute('aria-disabled')),me(i,'aria-haspopup','true'==e.getAttribute('aria-haspopup')),me(i,'data-unmasked',e.dataset.unmasked),me(i,'data-stripe',ve(e,'data-stripe')),'hidden'!==n&&'submit'!==n){me(i,'htmlLength',r),me(i,'htmlLabel',Te(e)),me(i,'labelData',ve(e,'data-label')),i.labelData||me(i,'labelData',ve(e,'label')),me(i,'labelAria',ve(e,'aria-label')),me(i,'labelAttr',ve(e,'label')),me(i,'labelTop',Ee(e)),me(i,'labelRight',Ne(e)),me(i,'labelLeft',De(e));var l=ve(e,'placeholder');l&&!/^\d{2}\/\d{2}\/\d{4}$/.test(l)&&me(i,'htmlPlaceholder',l.trim())}return i.identifier=this.generateFieldIdentifier(i),i}getRawFieldFromDict(e){const{htmlTag:t,htmlType:i,typeOrder:n,htmlPlaceholder:a,autoCompleteType:r,htmlLabel:l,tabindex:s,hasForm:o,formId:d,formAction:u,htmlValue:c,actualType:h}=this.deocodeFieldIdentifierAttributes(e.identifier),m=h,p='input'===t.toLowerCase()&&m?`${t}[type=${m}]`:`${t}`;const f=Array.prototype.slice.call(document.querySelectorAll(`${p}`))[n];if(f&&f.nodeType===Node.ELEMENT_NODE){const e=this.extractFieldAttributes(f);if(!e)return null;let n=!0;return s&&s>=0&&s!==e.tabindex&&(n=!1),r&&r!==e.autoCompleteType&&(n=!1),a&&a!==e.htmlPlaceholder&&(n=!1),l&&l!==e.htmlLabel&&(n=!1),o&&o===e.hasForm&&(d&&d!==e.formId&&(n=!1),u&&u!==e.formAction&&(n=!1)),'button'!==t&&'submit'!==i||c===e.htmlValue||(n=!1),n?f:null}return null}getTrackedState(e){return e.form?this.assureFormIsTracked(e.form):this.assureFieldIsTracked(e)}assureFormIsTracked(e){let t=this.formFields.get(e);return t||(t={resetValues:new WeakMap,fieldsEdited:new WeakSet,attributes:new WeakMap,totalEditedFields:0},this.formFields.set(e,t)),t}assureFieldIsTracked(e){let t=this.pageFields.get(e);return t||(t={resetValues:new WeakMap,fieldsEdited:new WeakSet,attributes:new WeakMap,totalEditedFields:0},this.pageFields.set(e,t)),t}isFieldTacked(e){return!!e&&(e.form?this.formFields.has(e.form)&&this.formFields.get(e.form).attributes.has(e):this.pageFields.has(e)&&this.pageFields.get(e).attributes.has(e))}setTackedStateInfo(e,t){if(!e)return!1;e.form&&this.formFields.has(e.form)?this.formFields.set(e.form,t):this.pageFields.set(e,t)}trackFormFields(e){const t=oe(document);if(0===t.length)return;let i=[];t.forEach(((t,n)=>{const a=this.getTrackedState(t),r=a.attributes.has(t)&&'submit'===t.type&&a.attributes.get(t).htmlValue===(t.textContent||t.value).trim(),l=a.attributes.has(t)&&a.attributes.get(t).disabled===t.disabled;if(e||!a.attributes.has(t)||'submit'===t.type&&!r||!l){const e=this.extractFieldAttributes(t,n);if(!e)return;if(!e.visible)return;a.resetValues.set(t,e.htmlValue),a.attributes.set(t,e),i.push(e)}else i.push(a.attributes.get(t))})),this.fieldAttributes=i,this.categoriesedFieldAttributes=this.categorizeFieldsByForm(this.fieldAttributes)}categorizeFieldsByForm(e){if(!e)return null;let t=[],i=[],n=[],a=[];const r=new WeakSet;for(var l=0,s=e.length;l<s;l++){const a=e[l];let s=null,o=null;if(!a.htmlType||'hidden'!==a.htmlType)if(a.hasForm){const e=this.getRawFieldFromDict(a);if(!e||r.has(e))continue;s=e?.form,o=t.indexOf(s),-1===o&&s?(t.push(s),o=t.length-1,i[o]?i[0].push(a):i.push([a])):i[o]?.push(a),r.add(e)}else n.push(a)}t.length>0&&(a=Ue(t,i));var o={};return a.length&&(o.pageForms=a),n.length&&(o.pageFields=n),Object.keys(o).length?o:null}applyDesignation(e,{type:t,target:i}){let n=null;e instanceof HTMLElement?n=e:e&&'object'==typeof e&&(n=this.getRawFieldFromDict(e)),n&&!this.designation.has(n)&&this.designation.set(n,{type:t,target:i})}applyDesignationToLoginFields(e){if(!e)return;const{userField:t,pswdField:i}=e;this.applyDesignation(t,{target:'username',type:'login'}),this.applyDesignation(i,{target:'password',type:'login'})}getLoginForms(e){if(!e||0===e.length)return[];const t=[];for(var i=0;i<e.length;++i){Ji(e[i])>0&&t.push(e[i])}return t}detectLoginDesignation(){let e=this.getLoginForms(this.categoriesedFieldAttributes.pageForms);const t=(e,t)=>{Tn(e,t,{isLogin:!0})||e&&e.loginFields&&this.applyDesignationToLoginFields(e.loginFields)};if(e.length>0)e.forEach((e=>{t(e,this.categoriesedFieldAttributes.pageFields)}));else{const e=Qi(this.categoriesedFieldAttributes);t(e,this.categoriesedFieldAttributes.pageFields)}}detectCreditCardDesignation(){let e=ri(this.categoriesedFieldAttributes,!0);Tn(e,this.categoriesedFieldAttributes.pageFields,{isCreditCard:!0})&&(e=null),e?.cardNumberField&&this.applyDesignation(e.cardNumberField,{target:'ccnumber',type:'credit_card'}),e?.cvvField&&this.applyDesignation(e.cvvField,{target:'cvv',type:'credit_card'}),e?.cardHolderField&&this.applyDesignation(e.cardHolderField,{target:'holderName',type:'credit_card'})}detectChangePasswordDesignation(){const e=Et(this.categoriesedFieldAttributes);if(e&&(this.applyDesignation(e.currentPasswordField,{type:'login',target:'current_password'}),this.applyDesignation(e.newPasswordField,{type:'change_password',target:'new_password'}),this.applyDesignation(e.confirmPasswordField,{type:'change_password',target:'confirm_password'}),e.htmlAction&&e.htmlAction.toLowerCase().includes('resetpassword'))){const t=Si(e.fields);if(t&&1===t.length){const e=t[0];this.applyDesignation(e[1],{target:'login-email-only',type:'login'})}}}detectIdentityDesignation(){const e=Si(this.fieldAttributes);for(const[,t]of e)this.applyDesignation(t,{type:'identity',target:'email'})}trackEditedFields(e,t){if(!(e instanceof HTMLInputElement||e instanceof HTMLSelectElement))return!1;if(['checkbox','radio'].includes(e.type))return!1;const i=this.getTrackedState(e);return t?i.fieldsEdited.has(e)&&(i.fieldsEdited.delete(e),i.totalEditedFields--):i.resetValues.get(e)!==e.value?i.fieldsEdited.has(e)||(i.fieldsEdited.add(e),i.totalEditedFields++):i.fieldsEdited.has(e)&&(i.fieldsEdited.delete(e),i.totalEditedFields--),!!this.is_Field_Form_Dirty(e)&&(this.setTackedStateInfo(e,i),!0)}is_Field_Form_Dirty(e){return this.getTrackedState(e).totalEditedFields>0}extractEditedData(e,t){const i=[],n=[],a={};let r=!1;if(e&&0===e.length||!t)return{secure_data:a,editedFields:i,isPasswordEdited:r};for(let t=0,s=e.length;t<s;t++){const s=e[t],o=this.getTrackedState(s),d=o.attributes.get(s),u=!o.resetValues.has(s)||o.resetValues.get(s)===s.value;if(!o.fieldsEdited.has(s)&&u&&(!d||!d.visible||!['text','email'].includes(d.htmlType)))continue;const c=this.designation.get(s);if(['button','submit'].includes(d.htmlType)||Ce(d))continue;const h=s.value;if(h&&6===h.length&&/^\d+$/.test(h)){if(on(d))continue}else d.htmlValue=h;if('password'===d.htmlType&&(r=!0),c){if(d.enpassType=c.target,['username','email','password','current_password','new_password','ccnumber','holderName','cvv'].includes(c.target)){let e=Qe(d)&&(l=s.value,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l))?'email':c.target;e='current_password'===e?'oldPassword':e,e='new_password'===e?'newPassword':e,a[e]=s.value,d.enpassType=e}if(['current_password'].includes(c.target))continue;if(['new_password'].includes(c.target)){n.push(d);continue}}i.push(d)}var l;return 0===i.length&&n.length>0&&i.push(n[0]),{secure_data:a,editedFields:i,isPasswordEdited:r}}captureEditedData(e,t){if(!e||En())return;const i=this.getTrackedState(e),n=this.getCategoryFromDesignation(t);if('identity'===n)return;let a='update_login';'change_password'===n&&(a='update_password'),'credit_card'===n&&(a='update_creditcard');let r=[];if(e.form)r=Array.prototype.slice.call(e.form.elements);else{r=oe(document).filter((e=>!e.form))}return(({secure_data:t,editedFields:i,isPasswordEdited:n})=>{if(i.length>0){if(!n||'update_password'===a||'update_creditcard'===a)return{secure_data:t,type:a};const r=tt(e.form);if(r)return{webform:[{...r,fields:i}],secure_data:t,type:a};{let e={};return ot()||(e={location:Ye(document.URL),iframeUrl:document.URL,domain:document.domain,hostname:document.location.hostname,pathname:document.location.pathname}),{webform:[{fields:i,htmlId:'default-form',htmlName:'default-form',...e}],secure_data:t,type:a}}}})(this.extractEditedData(r,i))}getCategoryFromDesignation(e){return['username','password','email'].includes(e)?'login':['cvv','ccnumber','holderName'].includes(e)?'credit_card':['current_password','confirm_password','new_password'].includes(e)?'change_password':'identity'}isVisibleElement(e){return fe(e)}}class Dn extends Fn{constructor(e){super(e),this.formFields=new WeakMap,this.pageFields=new WeakMap,this.uuid=window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16),this.fieldAttributes=[],this.categoriesedFieldAttributes=null,this.editedPasswordFields=new WeakSet,this.designation=new WeakMap}assignDefaultDesignationToPasswordFields(e){if('password'===e.type){const i=this.getTrackedState(e).attributes.get(e),n=i?.htmlLength;if(!n||-1===n||i?.htmlLength>6){let n={type:'generate_password',target:'password'};if((t=i)&&t.htmlLabel&&['security answer','hint answer'].includes(t.htmlLabel))return null;const a=i?.htmlLabel?.toLowerCase(),r=i?.htmlPlaceholder?.toLowerCase(),l=['身分證字號','token','user code','id code','使用者代碼'];return l.includes(a)||l.includes(r)?null:(this.applyDesignation(e,n),n)}}var t}removeAttributeFromFields(e){const t=document.querySelectorAll(`[${e}]`);t.length>0&&[...t].forEach((t=>{t.removeAttribute(e)}))}getDesignation(e){if(!e)return null;if(!this.isFieldTacked(e))return this.removeAttributeFromFields('data-enpassid'),this.runTracker(),this.designation.get(e)||this.assignDefaultDesignationToPasswordFields(e);{const t=this.designation.get(e);if(t)return t;const i=this.getTrackedState(e).attributes.get(e),n=fe(e),a=ye(e),r=!be(e);if(i.visible!==n||i.viewable!==a||i.isOutsideDocument!==r)return this.runTracker(!0),this.designation.get(e)||this.assignDefaultDesignationToPasswordFields(e);if('password'===e.type)return this.runTracker(),this.designation.get(e)||this.assignDefaultDesignationToPasswordFields(e)}}runTracker(e){this.trackFormFields(e),this.detectDesignation()}detectDesignation(){this.detectChangePasswordDesignation(),this.detectLoginDesignation(),this.detectCreditCardDesignation(),this.detectIdentityDesignation()}}class xn{constructor(){this.shadowRoot=null,this.inlineMenu=null,this.isScrollResizeListenerActive=!1,this.isValuedField=e=>e&&e instanceof HTMLInputElement&&X.includes(e.type),this.createShadowRoot=()=>{if(document.body)return document.createElement('ENPASS-INLINE-MENU').attachShadow({mode:'closed'})},this.createMenu=()=>{this.shadowRoot&&!this.inlineMenu&&(this.inlineMenu=document.createElement('iframe'),this.inlineMenu.id='enpinmenu',this.setMenuSource())},this.setMenuSource=({locked:e,frameID:t,target:i,type:n,menuID:a,url:r,edited:l,shortcut:s,locale:o,theme:d,active_uuid:u,iframeURL:c})=>{let h=Y.getState().locked;if(!this.inlineMenu)return;const p=new URL(m('injected/menu/index.html'));p.searchParams.append('locked',h),p.searchParams.append('active_uuid',u),p.searchParams.append('parent_identifier',t),p.searchParams.append('parent_url',c||r),p.searchParams.append('menu_id',a),p.searchParams.append('target',i),p.searchParams.append('type',n),p.searchParams.append('edited',l),p.searchParams.append('shortcut',s),p.searchParams.append('lang',o),p.searchParams.append('theme',d),this.inlineMenu.src=p.toString()},this.focus=()=>{this.inlineMenu&&this.inlineMenu.focus()},this.show=()=>{this.inlineMenu&&this.inlineMenu.parentNode&&'visible'!==this.inlineMenu.style.visibility&&(this.inlineMenu.style.visibility='visible')},this.hide=()=>{this.inlineMenu&&this.inlineMenu.parentNode&&'hidden'!==this.inlineMenu.style.visibility&&(this.inlineMenu.style.visibility='hidden')},this.isHidden=()=>{const e=this.inlineMenu;if(e)return!(!e.parentNode||'hidden'!==e.style.visibility)},this.updatePosition=(e,t)=>{if(!this.inlineMenu)return!1;const{activeFieldRect:i,activeFieldDir:n}=e;return this.positionMenu({rect:i,dir:n,frameInfo:t,forceVisibility:!0}),!0},this.positionMenu=({dir:e,rect:t,frameInfo:i,forceVisibility:n})=>{if(this.inlineMenu){const{left:r,right:l,top:s,height:o}=t;let d='rtl'===e?window.innerWidth-l:r,u=s+o+2;if(i){const n=a(i);if(n){const{top:a,left:r,right:l}=n.frame.getBoundingClientRect(),s=(e=>{if(!e)return 0;let t=window.getComputedStyle(e)?.paddingLeft;return null!=t?parseFloat(t):0})(n.frame);u=t.y+o+2+a,d=t.x+('rtl'===e?i.width-l:r+s)}}let c=Y.getState().locked;this.inlineMenu.style.cssText=`\n                    all: initial;\n                    position: fixed;\n                    top: ${u}px;\n                    ${'rtl'===e?'right':'left'}: ${d}px;\n                    z-index: 2147483989;\n                    min-width: 240px;\n                    width:300px;\n                    max-width: 300px;\n                    min-height: 0px;\n                    height: ${c?'64px':'192px'};\n                    max-height: 192px;\n                    border: none;\n                    border-radius: 6px;\n                    box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.15), 0 2px 24px rgba(0, 0, 0, 0.07);\n                    outline: 0;\n                    visibility:${n?'visible':'hidden'};\n                `}},this.resize=(e,t)=>{this.inlineMenu&&this.inlineMenu.parentNode&&(e&&(this.inlineMenu.style.width=e+'px'),t&&(this.inlineMenu.style.height=t+'px'))},this.draw=e=>{this.shadowRoot=this.createShadowRoot(),this.inlineMenu=document.createElement('iframe'),this.inlineMenu.id='enpinmenu',this.shadowRoot&&(this.setMenuSource(e),this.shadowRoot.appendChild(this.inlineMenu))},this.attach=(e,t)=>{if(this.inlineMenu)return!1;const{activeFieldRect:i,activeFieldDir:n,frameInfo:a}=e,r=a?a.uuid:t.frameID;return this.draw({...t,active_uuid:r,iframeURL:a?.src}),!(!this.shadowRoot||this.shadowRoot.host.parentElement)&&(this.positionMenu({rect:i,dir:n,frameInfo:a}),document.body.appendChild(this.shadowRoot.host),this.addScrollResizeEventListener(),!0)},this.dettach=()=>{this.shadowRoot&&this.shadowRoot.host.parentElement&&(this.shadowRoot.host.parentElement.removeChild(this.shadowRoot.host),this.shadowRoot=null,this.inlineMenu=null,this.isScrollResizeListenerActive&&(window.removeEventListener('scroll',this.onScrollOrResize,!0),window.removeEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!1))},this.onScrollOrResize=e=>{'MARQUEE'!==e.target.tagName&&this.isScrollResizeListenerActive&&(window.removeEventListener('scroll',this.onScrollOrResize,!0),window.removeEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!1,this.dettach())},this.addScrollResizeEventListener=()=>{this.isScrollResizeListenerActive||(window.addEventListener('scroll',this.onScrollOrResize,!0),window.addEventListener('resize',this.onScrollOrResize,!0),this.isScrollResizeListenerActive=!0)}}}class Nn{constructor(){this.isValuedField=e=>e&&e instanceof HTMLInputElement&&X.includes(e.type)&&!e.readOnly,this.isSelfResource=(e,t)=>!(!t||!e)&&(!!(t instanceof Element&&t.tagName&&['enpass-inline-menu','enpass-inline-button'].includes(t.tagName.toLowerCase()))||!(!e||t!==e))}}class An extends Nn{constructor(i){super(i),t&&(this.menuManager=new xn),this.buttonManager=new Z,this.formManager=new Dn,this.options=i||{dettachMode:!1},this.positionTimer=null;const{activeField:r,inlineDisabled:l,frameID:s}=Y.getState();this.activeField=r,this.isDisabled=l,this.frameIdentifier=s,this.shortcut=void 0,this.fetchCrossFrameInfo=()=>{const{frameID:e,activeField:t}=Y.getState(),i=this.formManager?.getDesignation(t),n=this.formManager?.is_Field_Form_Dirty(t),{activeFieldRect:a,activeFieldDir:r}=Y.getState();return i?{fieldInfo:{edited:n,designation:i,activeFieldRect:a,activeFieldDir:r},frameInfo:{uuid:e,width:window.innerWidth,height:window.innerHeight,src:window.location.href,name:window.name}}:null},this.toggleMenuDisplay=(e,t)=>{const{menuOpen:i,autoDisplayMenu:n}=Y.getState();n?i&&(this.menuManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1})):this.attachMenuToRect(e,t),Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'})},this.buttonManager.onClick=e=>{const i=this.fetchCrossFrameInfo();t?this.toggleMenuDisplay(i.fieldInfo):i&&(Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'}),f.setToggleDisplay(i))},this.toggleDettachMode=e=>{if(this.options={...this.options,dettachMode:e},!this.options.dettachMode){const e=document.activeElement;e&&this.isValuedField(e)&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:e})}},this.init=e=>{Y.dispatch({type:'INIT_STATE'}),this.options?.dettachMode&&Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!0}),window.addEventListener('focusin',this.onFocus,!0),window.addEventListener('mousedown',this.onMouseDown,!0),window.addEventListener('keydown',this.keyHandler,!0),window.addEventListener('input',this.onInputchange,!0),window.addEventListener('scroll',this._onScrollOrResize,!0),window.addEventListener('resize',this._onScrollOrResize,!0);const t=document.activeElement;if(t&&this.isValuedField(t)&&!this.options.dettachMode){const{activeField:e}=Y.getState();if(t===e)return;Y.dispatch({type:'SET_ACTIVE_FIELD',payload:t})}},this.onFocus=e=>{const{target:t}=e,{activeField:i,inlineDisabled:n,menuID:a}=Y.getState();n||this.isValuedField(t)&&(i?i!==t?(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),Y.dispatch({type:'SET_ACTIVE_FIELD',payload:t})):f.setBlurOnInlineMenu({token:a}):Y.dispatch({type:'SET_ACTIVE_FIELD',payload:t}))},this.onMouseDown=i=>{const{target:n}=i,{activeField:a,frameID:r,inlineDisabled:l}=Y.getState();if(f.notifyIframes({event_type:'mousedown',target_iframe:r}),!a){if(t&&this.removeMenu(),l)return;return void(this.isValuedField(n)&&document.activeElement===n&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:n}))}if('SAFARI'===e()&&f.checkSafariConnection(),!this.isSelfResource(a,n)||l)t?Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}):(f.removeAttachedMenu(),Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),this.buttonManager?.dettach()),Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!1});else{if(n instanceof Element&&n.tagName&&['enpass-inline-button'].includes(n.tagName.toLowerCase()))return;Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!1}),this.attach(a)}},this.attachMenu=(e,i)=>{f.fetchMenuSettings({uuid:this.frameIdentifier}),f.onMenuSettings(((a,r)=>{if(this.frameIdentifier!==a.uuid)return;this.menuManager?.dettach();let l=!1;if(a){const{shortcut:t,theme:r}=a;l=i.locked?this.menuManager?.attach(e,{...i,shortcut:n(t),theme:r}):this.menuManager?.attach(e,{...i,theme:r})}else l=this.menuManager?.attach(e,{...i,theme:'0'});l&&f.onRemoveMenu(((e,i)=>{t&&(this.removeMenu(),this.buttonManager?.dettach()),i()})),r()}))},this.attachMenuToRect=(e,t)=>{const{locked:i,frameID:n,url:a,menuOpen:r,locale:l}=Y.getState();if(r)return;const s=window.crypto.getRandomValues(new Uint32Array(1))[0].toString(16);Y.dispatch({type:'UPDATE_MENU_ID',payload:s});const{activeFieldRect:o,activeFieldDir:d,designation:u}=e,{type:c,target:h}=u,m={locked:i,frameID:n,menuID:s,type:c,target:h,url:a,edited:e.edited,locale:l};this.attachMenu({activeFieldRect:o,activeFieldDir:d,frameInfo:t},m)},this.trackFieldPosition=()=>{this.positionTimer&&(clearInterval(this.positionTimer),this.positionTimer=null),this.positionTimer=setInterval((()=>{const{activeFieldRect:e,activeField:i}=Y.getState();if(i&&!i.matches(':focus'))return void(i.isConnected&&this.formManager?.isVisibleElement(i)||(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),this.dettach()));const n=i?.getBoundingClientRect();if(e&&n){const a=e.top!==n.top,r=e.left!==n.left,l=e.width!==n.width;if(a||r||l){if(!this.formManager?.isVisibleElement(i))return;if(this.formManager?.is_Field_Form_Dirty(i)){Y.dispatch({type:'UPDATE_ACTIVE_FIELD_RECT',payload:n}),this.buttonManager?.setStyle(i);const e=this.fetchCrossFrameInfo();e&&(t?this.updateMenuPosition(e.fieldInfo):f.updateMenuPosition(e))}else{t?(this.menuManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1})):f.removeAttachedMenu(),Y.dispatch({type:'UPDATE_ACTIVE_FIELD_RECT',payload:n}),this.buttonManager?.setStyle(i);const e=this.fetchCrossFrameInfo();e&&(t?this.attachMenuToRect(e.fieldInfo):f.attachMenuToRect(e))}}}}),50)},this.updateMenuPosition=(e,t)=>{const{menuOpen:i,menuID:n}=Y.getState();i?(this.menuManager?.updatePosition(e,t),f.fetchResizeHeight({token:n})):this.attachMenuToRect(e,t)},this.attach=e=>{const{autoLoginExecuted:i,autofillInOperation:n,menuOpen:a,autoDisplayMenu:r,frameID:l}=Y.getState();if(i||n)return!0;const s=this.formManager?.getDesignation(e),o=this.formManager?.is_Field_Form_Dirty(e),{activeFieldRect:d,activeFieldDir:u}=Y.getState();s&&(this.buttonManager?.attach(e),r&&(t?a||(this.attachMenuToRect({edited:o,designation:s,activeFieldRect:d,activeFieldDir:u}),this.trackFieldPosition()):this.isValuedField(e)&&(f.attachMenuToRect({fieldInfo:{edited:o,designation:s,activeFieldRect:d,activeFieldDir:u},frameInfo:{uuid:l,width:window.innerWidth,height:window.innerHeight,src:window.location.href,name:window.name}}),this.trackFieldPosition())))},this.dettach=()=>{t?this.menuManager?.dettach():f.removeAttachedMenu(),this.positionTimer&&(clearInterval(this.positionTimer),this.positionTimer=null),this.buttonManager?.dettach()},this.onActiveFieldChange=e=>{this.dettach(),this.activeField=e,e&&this.attach(e)},this.onSettingChange=e=>{this.isDisabled=e,e?this.dettach():this.init()},this.attachMenuOnKeyDown=e=>{const{menuOpen:t,locked:i,menuID:n}=Y.getState();if(t){if(i)return;f.setFocusOnlineMenu({token:n}),setTimeout((()=>{this.menuManager?.focus()}),1)}else this.attachMenuToRect(e.fieldInfo,e.frameInfo),Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'})},this.dettachMenuOnKeyEvent=()=>{this.menuManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1}),Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'})},this.keyHandler=e=>{const{menuOpen:i,activeField:n,activeFieldRect:a,activeFieldDir:r,frameID:l,autoDisplayMenu:s}=Y.getState();if('Escape'===e.key&&(t&&n&&i?this.dettachMenuOnKeyEvent():(Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'}),f.dettachMenuOnKeyEvent())),'ArrowDown'===e.key){const e=this.formManager?.getDesignation(n);if(!e)return;const i=this.formManager?.is_Field_Form_Dirty(n),o={edited:i,designation:e,activeFieldRect:a,activeFieldDir:r};n&&(t?this.attachMenuOnKeyDown({fieldInfo:o}):(s||Y.dispatch({type:'SET_TOGGLMENU_DISPLAY'}),f.attachMenuOnKeyDown({fieldInfo:o,frameInfo:{uuid:l,width:window.innerWidth,height:window.innerHeight,src:window.location.href,name:window.name}})))}},this.onInputchange=e=>{const{frameID:t}=Y.getState();e.target===this.activeField&&f.searchItem({text:e.target.value,token:t});const{autofillInOperation:i}=Y.getState(),n=this.formManager?.trackEditedFields(e.target,i);f.sendDirtyFieldStatus({isDirty:n,token:t})},this._onScrollOrResize=e=>{if('MARQUEE'===e.target.tagName)return;const{activeField:i}=Y.getState();i&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:i}),t?this.removeMenu():f.removeAttachedMenu()},this.removeMenu=()=>{clearInterval(this.positionTimer),this.positionTimer=null,this.menuManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1})},this.calculateNestedIframeInfo=e=>{if(!e||!e.frameInfo)return null;const{fieldInfo:t,frameInfo:i}=e,n=a(i);if(!n)return null;const r={uuid:i.uuid,width:window.innerWidth,height:window.innerHeight,src:window.location.href,name:window.name},{top:l,left:s,right:o}=n.frame.getBoundingClientRect(),d=t.activeFieldRect;return{fieldInfo:{...t,activeFieldRect:{...d,x:d.x+('rtl'===t.activeFieldDir?i.width-o:s),y:d.y+l}},frameInfo:r,travelledFrames:[...e.travelledFrames?e.travelFrames:[],Y.getState().frameID]}},this.removeInlineButton=()=>{this.buttonManager?.dettach()},this.release=()=>{window.removeEventListener('focusin',this.onFocus,!0),window.removeEventListener('mousedown',this.onMouseDown,!0),window.removeEventListener('keydown',this.keyHandler,!0),window.removeEventListener('input',this.onInputchange,!0),window.removeEventListener('scroll',this._onScrollOrResize,!0),window.removeEventListener('resize',this._onScrollOrResize,!0),this.dettach(),this.menuManager=null,this.buttonManager=null,this.formManager=null,this.options=void 0,this.positionTimer=null,this.activeField=null,this.isDisabled=!0,this.frameIdentifier=void 0,this.shortcut=void 0,this.unsubscribe()},this.unsubscribe=Y.subscribe((()=>{const{activeField:e,inlineDisabled:t,autoDisplayMenu:i,menuOpen:n,frameID:a}=Y.getState();this.activeField!==e&&this.onActiveFieldChange(e),this.isDisabled})),f.onUnlockAttach((e=>{if(e.uuid!==this.frameIdentifier)return;const{activeField:i}=Y.getState(),n=this.fetchCrossFrameInfo();n&&(t&&i?this.attachMenuToRect(n.fieldInfo):f.attachMenuToRect(n))})),f.onInlineMenuDisplayStatus((e=>{const{menuID:t}=Y.getState();t&&e&&e.token})),f.onSetFieldFocus((e=>{const{frameID:t,activeField:i}=Y.getState();t&&e&&e.token===t&&i&&(window.focus(),i.focus())})),f.onResizeMenu((({width:e,height:i,token:n})=>{t&&this.menuManager?.resize(e,i)})),f.onMenuReadyToShow((e=>{const{menuID:t}=Y.getState();t&&e&&e.token===t&&(Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!0}),e&&this.menuManager?.resize(e.width,e.height),this.menuManager?.isHidden()&&this.menuManager?.show())})),f.getInlineSetting({uuid:this.frameIdentifier}),f.onInlineSettingResult(((e,t)=>{if(!e||e.uuid!==this.frameIdentifier)return;const{locked:i}=e;Y.dispatch({type:'UPDATE_LOCK_STATUS',payload:i}),this.init(),t()})),f.onIframeNotification((e=>{const{frameID:t}=Y.getState();e?.target_iframe!==t&&(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),'mousedown'===e?.event_type&&(this.menuManager?.dettach(),this.buttonManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1})))})),f.onLockStateUpdated(((e,t)=>{const{locked:i,activeField:n,menuOpen:a}=Y.getState();if(Y.dispatch({type:'UPDATE_LOCK_STATUS',payload:e.locked}),i!==e.locked){n&&this.buttonManager&&this.buttonManager.setStyle(n);const t='object'==typeof safari&&safari.extension;!e.locked&&a&&t?f.continueOnUnlock():(this.menuManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1}))}})),f.onSaveInputData((({designation:e,token:t})=>{const{frameID:i}=Y.getState();if(!i||t!==i)return;const{activeField:n,url:a}=Y.getState();if(n){const t=this.formManager?.captureEditedData(n,e);t&&f.saveLoginData({...t,url:a,isManual:!0}),Y.dispatch({type:'REMOVE_ACTIVE_FIELD'})}})),f.onToggleDisplay((e=>{if(t&&e){if(e.frameInfo){a(e.frameInfo)&&this.toggleMenuDisplay(e.fieldInfo,e.frameInfo)}}else{if(!e||e.frameInfo&&e.frameInfo.uuid===s||e.travelledFrames&&e.travelledFrames.includes(s))return;const t=this.calculateNestedIframeInfo(e);t&&f.setToggleDisplay(t)}})),f.onAttachMenuRect((e=>{const{frameID:i}=Y.getState();if(t){const{menuOpen:t,menuID:i}=Y.getState();t?'keydown'===e.event&&(f.setFocusOnlineMenu({token:i}),setTimeout((()=>{this.menuManager?.focus()}),1)):this.attachMenuToRect(e.fieldInfo,e.frameInfo)}else{if(!e||e.frameInfo&&e.frameInfo.uuid===i||e.travelledFrames&&e.travelledFrames.includes(i))return;const t=this.calculateNestedIframeInfo(e);t&&f.attachMenuToRect(t)}})),f.onAttachMenuOnKeyDown((e=>{if(t&&e){if(e.frameInfo){a(e.frameInfo)&&this.attachMenuOnKeyDown(e)}}else{if(!e||e.frameInfo&&e.frameInfo.uuid===s||e.travelledFrames&&e.travelledFrames.includes(s))return;const t=this.calculateNestedIframeInfo(e);t&&f.attachMenuOnKeyDown(t)}})),f.onRemoveAttachedMenu((()=>{this.removeMenu()})),f.onDettachMenuOnKeyEvent((()=>{t&&this.dettachMenuOnKeyEvent()})),f.onUpdateMenuPosition((e=>{t&&e&&this.updateMenuPosition(e.fieldInfo,e.frameInfo)}))}}var Cn,Sn={exports:{}};Cn=Sn,function(e,t,i){if(e){for(var n,a={8:'backspace',9:'tab',13:'enter',16:'shift',17:'ctrl',18:'alt',20:'capslock',27:'esc',32:'space',33:'pageup',34:'pagedown',35:'end',36:'home',37:'left',38:'up',39:'right',40:'down',45:'ins',46:'del',91:'meta',93:'meta',224:'meta'},r={106:'*',107:'+',109:'-',110:'.',111:'/',186:';',187:'=',188:',',189:'-',190:'.',191:'/',192:'`',219:'[',220:'\\',221:']',222:'\''},l={'~':'`','!':'1','@':'2','#':'3',$:'4','%':'5','^':'6','&':'7','*':'8','(':'9',')':'0',_:'-','+':'=',':':';','"':'\'','<':',','>':'.','?':'/','|':'\\'},s={option:'alt',command:'meta',return:'enter',escape:'esc',plus:'+',mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?'meta':'ctrl'},o=1;o<20;++o)a[111+o]='f'+o;for(o=0;o<=9;++o)a[o+96]=o.toString();f.prototype.bind=function(e,t,i){var n=this;return e=e instanceof Array?e:[e],n._bindMultiple.call(n,e,t,i),n},f.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},f.prototype.trigger=function(e,t){var i=this;return i._directMap[e+':'+t]&&i._directMap[e+':'+t]({},e),i},f.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},f.prototype.stopCallback=function(e,t){if((' '+t.className+' ').indexOf(' mousetrap ')>-1)return!1;if(p(t,this.target))return!1;if('composedPath'in e&&'function'==typeof e.composedPath){var i=e.composedPath()[0];i!==e.target&&(t=i)}return'INPUT'==t.tagName||'SELECT'==t.tagName||'TEXTAREA'==t.tagName||t.isContentEditable},f.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},f.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);n=null},f.init=function(){var e=f(t);for(var i in e)'_'!==i.charAt(0)&&(f[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i))},f.init(),e.Mousetrap=f,Cn.exports&&(Cn.exports=f)}function d(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent('on'+t,i)}function u(e){if('keypress'==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return a[e.which]?a[e.which]:r[e.which]?r[e.which]:String.fromCharCode(e.which).toLowerCase()}function c(e){return'shift'==e||'ctrl'==e||'alt'==e||'meta'==e}function h(e,t,i){return i||(i=function(){if(!n)for(var e in n={},a)e>95&&e<112||a.hasOwnProperty(e)&&(n[a[e]]=e);return n}()[e]?'keydown':'keypress'),'keypress'==i&&t.length&&(i='keydown'),i}function m(e,t){var i,n,a,r=[];for(i=function(e){return'+'===e?['+']:(e=e.replace(/\+{2}/g,'+plus')).split('+')}(e),a=0;a<i.length;++a)n=i[a],s[n]&&(n=s[n]),t&&'keypress'!=t&&l[n]&&(n=l[n],r.push('shift')),c(n)&&r.push(n);return{key:n,modifiers:r,action:t=h(n,r,t)}}function p(e,i){return null!==e&&e!==t&&(e===i||p(e.parentNode,i))}function f(e){var i=this;if(e=e||t,!(i instanceof f))return new f(e);i.target=e,i._callbacks={},i._directMap={};var n,a={},r=!1,l=!1,s=!1;function o(e){e=e||{};var t,i=!1;for(t in a)e[t]?i=!0:a[t]=0;i||(s=!1)}function h(e,t,n,r,l,s){var o,d,u,h,m=[],p=n.type;if(!i._callbacks[e])return[];for('keyup'==p&&c(e)&&(t=[e]),o=0;o<i._callbacks[e].length;++o)if(d=i._callbacks[e][o],(r||!d.seq||a[d.seq]==d.level)&&p==d.action&&('keypress'==p&&!n.metaKey&&!n.ctrlKey||(u=t,h=d.modifiers,u.sort().join(',')===h.sort().join(',')))){var f=!r&&d.combo==l,g=r&&d.seq==r&&d.level==s;(f||g)&&i._callbacks[e].splice(o,1),m.push(d)}return m}function p(e,t,n,a){i.stopCallback(t,t.target||t.srcElement,n,a)||!1===e(t,n)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(t),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(t))}function g(e){'number'!=typeof e.which&&(e.which=e.keyCode);var t=u(e);t&&('keyup'!=e.type||r!==t?i.handleKey(t,function(e){var t=[];return e.shiftKey&&t.push('shift'),e.altKey&&t.push('alt'),e.ctrlKey&&t.push('ctrl'),e.metaKey&&t.push('meta'),t}(e),e):r=!1)}function b(e,t,i,l){function d(t){return function(){s=t,++a[e],clearTimeout(n),n=setTimeout(o,1e3)}}function c(t){p(i,t,e),'keyup'!==l&&(r=u(t)),setTimeout(o,10)}a[e]=0;for(var h=0;h<t.length;++h){var f=h+1===t.length?c:d(l||m(t[h+1]).action);y(t[h],f,l,e,h)}}function y(e,t,n,a,r){i._directMap[e+':'+n]=t;var l,s=(e=e.replace(/\s+/g,' ')).split(' ');s.length>1?b(e,s,t,n):(l=m(e,n),i._callbacks[l.key]=i._callbacks[l.key]||[],h(l.key,l.modifiers,{type:l.action},a,e,r),i._callbacks[l.key][a?'unshift':'push']({callback:t,modifiers:l.modifiers,action:l.action,seq:a,level:r,combo:e}))}i._handleKey=function(e,t,i){var n,a=h(e,t,i),r={},d=0,u=!1;for(n=0;n<a.length;++n)a[n].seq&&(d=Math.max(d,a[n].level));for(n=0;n<a.length;++n)if(a[n].seq){if(a[n].level!=d)continue;u=!0,r[a[n].seq]=1,p(a[n].callback,i,a[n].combo,a[n].seq)}else u||p(a[n].callback,i,a[n].combo);var m='keypress'==i.type&&l;i.type!=s||c(e)||m||o(r),l=u&&'keydown'==i.type},i._bindMultiple=function(e,t,i){for(var n=0;n<e.length;++n)y(e[n],t,i)},d(e,'keypress',g),d(e,'keydown',g),d(e,'keyup',g)}}('undefined'!=typeof window?window:null,'undefined'!=typeof window?document:null);var On=Sn.exports;!function(e){if(e){var t={},i=e.prototype.stopCallback;e.prototype.stopCallback=function(e,n,a,r){return!!this.paused||!t[a]&&!t[r]&&i.call(this,e,n,a)},e.prototype.bindGlobal=function(e,i,n){if(this.bind(e,i,n),e instanceof Array)for(var a=0;a<e.length;a++)t[e[a]]=!0;else t[e]=!0},e.init()}}('undefined'!=typeof Mousetrap?Mousetrap:void 0);const kn=e=>{var t=document.getElementById('enpass_iframe'),i=document.getElementById('enpass_spacer');window.innerWidth>=800?(t.setAttribute('style','height: 48px;width: '+window.innerWidth+'px;border: 0px;'),i.setAttribute('style','height : 48px;')):(window.innerWidth<800&&window.innerWidth>=500?t.setAttribute('style','height: 96px;width: '+window.innerWidth+'px;border: 0px;'):window.innerWidth<500&&t.setAttribute('style','height: 96px;width: 500px;border: 0px;'),i.setAttribute('style','height : 96px;'))},Pn=[/^\W*log\W*[oi]n\W*$/i,/log\W*[oi]n (?:securely|now)/i,/\W*secure\W*log\W*[oi]n/i,/^\W*sign\W*[oi]n\W*$/i,/create.*account/i,'continue','submit','weiter','ingresar','accès','вход','connexion','entrar','anmelden','accedi','valider','登录','登 录','登入','लॉग इन करें','register','sign up','signup','join','create my account','регистрация','inscription','regístrate','cadastre-se','registrieren','registrazione','注册','साइन अप करें','change password','save changes','save','einloggen','inloggen','giriş','zaloguj','σύνδεση','kirjaudu','prijava','aceptar'],Mn='SAFARI'===e();const Rn=['https://robertsspaceindustries.com','https://www.schlichtungsstelle-energie.de','https://www.icloud.com/'];function Un(){const t=e();if(!document.doctype)return null;if(['SAFARI','FIREFOX'].includes(t)&&!['about:blank'].includes(document.URL)&&!window.webauthnInterceptorFirefoxInjected){window.webauthnInterceptorFirefoxInjected=!0;const e=document.createElement('script');e.src=m('injected/scripts/webauthnInterceptor.js');(document.head||document.documentElement).prepend(e),e.remove()}}function Vn(e){if(!e)return!0;try{const{hostname:t}=new URL(document.URL);return t.endsWith(`.${e}`)||t===e}catch(e){return!1}}function zn(e){return e?new URL(e).hostname.split(/\./).slice(-2).join('.'):''}const Bn=new class{constructor(){this.hiddenInterval=null,this.inlineManager=null,this.state={uuid:Y.getState().frameID,elementClicked:null,fieldDict:null,formDict:null,guesser:{changePasswordForm:null},filler:{generated_password_item_uuid:null,generated_password_vault_uuid:null,generated_password_team_id:null},doFormCapture:!0,tabInfo:{url:null,id:void 0,domain:null},keyShortcut:{activate:null,lock:null,autofill:''},loginForm:null,creditCardForm:null,identityForm:null,iframeURL:window.location.protocol+'//'+window.location.host+window.location.pathname,frameUrls:null,isSaveDialogShown:!1,isAutoLogin:!1,inspectedTabs:[]},this.init=()=>{var t;document.addEventListener('input',this.inputHandler,!0),document.addEventListener('click',this.clickListener,!0),document.addEventListener('change',this.changeListener,!0),document.addEventListener('DOMContentLoaded',this.domContentLoadedListener),window.addEventListener('keydown',this.enterKeyPressed,!0),window.addEventListener('resize',this.resizeListener),window.addEventListener('beforeunload',this.beforeUnloadListener),Mn&&((()=>{if('SAFARI'===e()){let e=!1;const t=160;setInterval((()=>{const i=window.outerWidth-window.innerWidth>t,n=window.outerHeight-window.innerHeight>t;i||n?e||(e=!0,Y.dispatch({type:'DEVTOOLS_STATE_CHANGED',payload:!0})):(e=!1,Y.dispatch({type:'DEVTOOLS_STATE_CHANGED',payload:!1}))}),1e3)}})(),document.addEventListener('visibilitychange',(()=>{document.hidden||f.getLockStatus()}))),document.addEventListener('readystatechange',(e=>{'interactive'===e.target.readyState&&h('connect_onpageload')})),t=this.messageHandler,'object'==typeof safari&&safari.self&&safari.self.addEventListener?safari.self.addEventListener('message',(({name:e,message:i})=>{t(e,i)})):c.runtime.onMessage.addListener(((e,i,n)=>{if(!e)return;const{command:a,payload:r}=e;t(a,r,i,n)})),f.onTabInfo((e=>{e&&Y.dispatch({type:'SET_TAB_URL',payload:e.tabUrl})})),f.onInlineMenuBlocked((()=>{Y.dispatch({type:'BLOCK_INLINE'}),f.setBlockingURL(document.domain)})),f.onInlineMenuSettingUpdate((e=>{Y.dispatch({type:'UPDATE_INLINE_SETTING',payload:e.disabled}),this.inlineManager&&(this.inlineManager.removeMenu(),this.inlineManager.removeInlineButton())})),f.onAutofillOnLoadData((async e=>{const t=ot()||e?.item?.url&&dt([e.item.url]),i=Mn&&e.uuid&&e.uuid!==Y.getState().frameID,n=e.item&&!ut(e.item);if(!e.item||t||i||n)return Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!1}),void(this.inlineManager&&this.inlineManager.toggleDettachMode(!1));const a=e.item;a.secure_data.autoSubmit=!1,Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0}),Y.getState().menuOpen&&(this.inlineManager?.dettach(),Y.dispatch({type:'MENU_DISPLAY_STATUS',payload:!1}));const r={'timestripe.com':1e3,'ownyourfuture.vanguard.com':1e3,'www.agoda.com':1e3,'signin.costco.com':1e3};var l;Object.keys(r).includes(document.domain)&&await(l=r[document.domain],new Promise((e=>setTimeout(e,l))));const s=Re(),o=Be(s),d=Qi(o);if(d&&Tn(d,o.pageFields))return Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1}),void Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!1});const{isPasskeySupported:u}=Y.getState(),c={...a.secure_data,isPasskeySupported:u,autofillType:'autofill_onload'};sn(d,{clientData:c,uuid:Y.getState().uuid},(function(){h('CLEAR_TOTP_DATA'),Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1}),Y.dispatch({type:'AUTOLOGIN_IN_EXECUTION',payload:!1})}))})),f.onAutofillInlineItem((e=>{if(ot()||dt([e.url]))return;if(e.context.frame_id!==Y.getState().frameID)return;this.inlineManager&&(this.inlineManager.removeMenu(),this.inlineManager.removeInlineButton()),Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0});const{activeField:t}=Y.getState(),i=t?.form,n=it(i);te.removeInstanceFromMap();const a=()=>{Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1})};if('credit_card'===e?.type)return this.inlineManager?.buttonManager?.dettach(),this.fillCreditCardItem(e),void a();if('login'===e?.type){if(e.secure_data&&!e.secure_data.email&&!e.secure_data.username&&!e.secure_data.user_name&&!e.secure_data.password)return void a();if(this.turnOffAutoCapture(),'current_password'===e.context.fill_type){if(n){const t=Et({pageForms:[n]});t&&t.currentPasswordField&&(this.state.filler.generated_password_item_uuid=e.uuid,this.state.filler.generated_password_vault_uuid=e.vault_uuid,this.state.filler.generated_password_team_id=e.team_id,nt(t.currentPasswordField,e.secure_data.password,e.secure_data.reveal_restricted?.includes('password')))}else t&&(e.secure_data.password&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('password'),(()=>at(t,e.secure_data.password))),this.state.filler.generated_password_item_uuid=e.uuid,this.state.filler.generated_password_vault_uuid=e.vault_uuid,this.state.filler.generated_password_team_id=e.team_id);return void a()}if('login-email-only'!==e.context.fill_type){if(n){if(!(Ji(n)>0)){if(e.context&&'email'===e.context.fill_type)t&&e.secure_data.email&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)}));else if(e.context&&'username'===e.context.fill_type&&t&&e.secure_data.email){const i=Me(t);i&&Qe(i)&&e.secure_data.email?te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)})):e.secure_data.username&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('username'),(()=>{at(t,e.secure_data.username)}))}return void a()}if(e.webform){const t=((e,t,i)=>{const n=Array.isArray(t)?t[0]:t;let a=i?.formdict;if(a||(a=it(e)),`${a.hostanme+a.pathanme}`!=`${n.hostanme+n.pathanme}`)return!1;if('default-form'!==n.htmlName){if(n.htmlName&&n.htmlName!==a.htmlName)return!1;if(n.htmlAction&&n.htmlAction!==a.htmlAction)return!1}const r=n.valueMap;if(!r||0===Object.keys(r).length)return!1;const l=n.fields,s=n?.reveal_restricted,o=[];let d;if(l){for(let t=0,i=l.length;t<i;t++){const i=l[t];let n=yn(i,e);if(!n&&a&&(d=d||Re(null),n=wn(i,d)),!n)return!1;('password'!==n.type||fe(i))&&o.push({fieldPointer:n,fieldValue:r[i.item_field_uid]||i.htmlValue,fieldType:i.htmlType,userEdited:i.userEdited,enpassType:i.enpassType,reveal_restricted:s?.includes(i.item_field_uid?.toString())})}if(0===o.length)return!1}return vn(o),!0})(i,e.webform,{formdict:n});if(t)return((e,t)=>{const i=void 0!==e.isUsernameInWebForm&&e.isUsernameInWebForm,n=void 0!==e.isEmailInWebForm&&e.isEmailInWebForm,a=e.secure_data,r={username:a.username,user_name:a.user_name,email:a.email};if((!i||!n)&&t){const e=t.loginFields?t.loginFields.userField:null;en({userField:e},r,t.idoc)}})(e,n),void((e,{data:t,uuid:i},n)=>{const a={autoSubmit:t.autoSubmit,totp_1:t.totp_1,totp_1_valid:t.totp_1_valid,totp_2:t.totp_2,totp_2_valid:t.totp_2_valid};let r=ln(a,{uuid:i});if(a.autoSubmit&&!Ke()){let t=e.loginFields?e.loginFields.loginButton:null;'accounts.google.com'===location.hostname&&(t=document.querySelector('#passwordNext')||document.querySelector('#signIn')),t?new Promise((function(e,i){setTimeout((()=>{if('dict'===t.type){let e=Ve(t.target);e&&e.click()}else t.target?t.target.click():t.click();r?i():e()}),600)})).then((function(){let e='www.dropbox.com'===document.domain?8e3:2e3;setTimeout((()=>{if(!ln(a,{uuid:i},n)){let e='www.dropbox.com'===document.domain?1e4:2e3;setTimeout((()=>{ln(a,{uuid:i},n)}),e)}}),e)}),(function(){n({isTotpExist:!1})})):n({isTotpExist:!1})}else n({isTotpExist:!1})})(n,{data:e.secure_data,uuid:Y.getState().uuid},(e=>{e&&e.isTotpExist&&h('CLEAR_TOTP_DATA'),a()}))}const r={...e.secure_data,isPasskeySupported:e.isPasskeySupported};return void sn(n,{clientData:r,uuid:Y.getState().uuid},(function(i){if(i&&i.isTotpExist&&h('CLEAR_TOTP_DATA'),e.context&&'email'===e.context.fill_type)t&&!t.value&&e.secure_data.email&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)}));else if(e.context&&'username'===e.context.fill_type&&t){const i=Me(t);i&&Qe(i)&&e.secure_data.email?te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)})):e.secure_data.username&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('username'),(()=>{at(t,e.secure_data.username)}))}i?.showInlineMenu?(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),a(),document.activeElement&&e.secure_data&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:document.activeElement})):a()}))}{let i=Re(),n=Be(i),r=Qi(n);const{isPasskeySupported:l}=Y.getState(),s={...e.secure_data,isPasskeySupported:l};return void sn(r,{clientData:s,uuid:Y.getState().uuid},(function(i){if(i&&i.isTotpExist&&h('CLEAR_TOTP_DATA'),e.context&&'email'===e.context.fill_type)t&&!t.value&&e.secure_data.email&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)}));else if(e.context&&'username'===e.context.fill_type&&t){const i=Me(t);i&&Qe(i)&&e.secure_data.email?te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email)})):e.secure_data.username&&te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('username'),(()=>{at(t,e.secure_data.username)}))}i?.showInlineMenu?(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),a(),document.activeElement&&e.secure_data&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:document.activeElement})):a()}))}}if(t&&e.secure_data.email)return void te.manageConcealer(t,e.secure_data.reveal_restricted?.includes('email'),(()=>{at(t,e.secure_data.email),a()}))}if('identity'===e?.type)return n?((e,t)=>{if(!e||0===e.length)return;const i=Oi(e);Ui(i,t)})(n.fields,e?.secure_data):zi(null,e?.secure_data),void a();if('generate_password'===e?.type){if(this.state.doFormCapture=!0,'password'===e.context.fill_type){if(n){const t=n.fields.filter((e=>'password'===e.htmlType&&e.visible));if(3===t.length){const i=Tt(t);if(i){const{newPasswordField:n,confirmPasswordField:a}=i;n&&a?(nt(n,e.generated_password),nt(a,e.generated_password)):(nt(t[0],e.generated_password),nt(t[1],e.generated_password))}}else nt(t[0],e.generated_password),nt(t[1],e.generated_password)}else{at(t,e.generated_password);let i=Re(null);if(i=Se(i,!0),i=Ae(i),i=i.filter((e=>!e.hasForm&&'password'===e.htmlType)),2===i.length){const n=i[0].tabindex?parseInt(i[0].tabindex):null,a=i[1].tabindex?parseInt(i[1].tabindex):null;if(n&&a&&n===a-1){const n=Ve(i[0]),a=Ve(i[1]);at(n&&n===t?a:n,e.generated_password)}}}return a(),void this.captureDetails()}if(n){const t=Et({pageForms:[n]});if(t)return nt(t.newPasswordField,e.generated_password),nt(t.confirmPasswordField,e.generated_password),a(),void this.captureDetails()}else{let t=Re(),i=Be(t);const n=Et({pageFields:i.pageFields});if(n)return nt(n.newPasswordField,e.generated_password),nt(n.confirmPasswordField,e.generated_password),a(),void this.captureDetails()}this.generatedPasswordFiller(e),a(),this.captureDetails()}}))},this.inputHandler=e=>{if(!document.domain.includes('tiptap.dev')||document.URL.includes('https://tiptap.dev/login')){var t=null;if(e.composedPath&&!['INPUT','SELECT'].includes(e.target.tagName)){var i=e.composedPath();i&&i[0]&&(t=i[0])}else t=e.target;!t||'INPUT'!==t.tagName&&'SELECT'!==t.tagName||(t.dataset.enpassusermodified='yes')}},this.changeListener=e=>{document.domain.includes('tiptap.dev')&&!document.URL.includes('https://tiptap.dev/login')||!e.target||'radio'!==e.target.type&&'checkbox'!==e.target.type||(e.target.dataset.enpassusermodified='yes')},this.domContentLoadedListener=e=>{h('fetch_old_shortcut'),h('get_inspected_tabs_list'),Mn&&(h('fetch_shortcut_key'),window.top===window.self&&setTimeout((()=>{h('fetch_autologin_data',{uuid:this.state.uuid})}),700)),this.gatherFrameUrlsOfTab(),Ke()&&(this.state.autoSubmit=!1),window.top===window.self&&h('check_pending_dialog'),Y.subscribe(this.storeChangeHandler),f.getInlineSetting({uuid:this.state.uuid}),f.onInlineSettingResult((e=>{if(!e)return;const{isSettingDisabled:t,autoLogin:i,tab_info:n,locked:a,isPasskeySupported:r,isDevToolsOpened:l}=e;Y.dispatch({type:'SYNC_INLINE_SETTING',payload:{inlineDisabled:t,autoLogin:i,locked:a,isPasskeySupported:r,isDevToolsOpened:l}}),n&&n.tabUrl&&Y.dispatch({type:'SET_TAB_URL',payload:n.tabUrl})}))},this.storeChangeHandler=()=>{const{inlineDisabled:e,autoLogin:t,autofillInOperation:i}=Y.getState();if(e||t&&i)this.inlineManager&&this.inlineManager.toggleDettachMode(!0);else if(!this.inlineManager){if(ot())return;this.inlineManager=t?new An({dettachMode:!0}):new An}},this.enterKeyPressed=e=>{let t=e.target,i=t.type;if(!i&&e.composedPath){let n=e.composedPath();n&&n[0]&&(t=n[0],i=t.type)}if(13===e.keyCode&&('password'===i||'text'===i||'email'===i)){this.cacheUsername();let e=Array.prototype.slice.call(document.querySelectorAll('input[type=password]'));if(e=e.filter((function(e){return fe(e)})),this.filterItemOnWhichEnterKeyPressed(t)){if(e&&0===e.length&&'password'!==i)return;this.captureDetails()}}},this.resizeListener=e=>{parent===window||0===window.innerHeight&&0===window.innerWidth||h('get_tab_info')},this.beforeUnloadListener=e=>{const t=this.state.filler.generated_password_item_uuid,i=this.state.filler.generated_password_vault_uuid,n=this.state.guesser.changePasswordForm;t&&i&&n&&h(d,{url:this.state.tabInfo.url,type:'update_password',secure_data:{},event_type:'beforeunload',uuid:this.state.uuid,webForm:[]})},this.cacheUsername=()=>{if(this.state.userField&&this.state.userField.value){if(document.body.contains(this.state.userField))return void h('cache_username',{username:this.state.userField.value});var e=et(),t=e.fieldDict,i=e.formDict;this.state.fieldDict=t,this.state.formDict=i}else if('undefined'!==this.state.userField)return;var n=null;if(this.state.formDict)n=Qi(this.state.formDict,!0);else{let e=et(),t=e.fieldDict,i=e.formDict;this.state.fieldDict=t,this.state.formDict=i,n=Qi(this.state.formDict,!0)}n&&(n.form&&n.form.loginFields&&n.form.loginFields.userField?(this.state.userField=Ve(n.form.loginFields.userField),this.state.userField&&this.state.userField.value&&h('cache_username',{username:this.state.userField.value})):(this.state.userField=void 0,this.state.fieldDict=null,this.state.formDict=null))},this.filterItemOnWhichEnterKeyPressed=e=>{if(e){const t=e.getAttribute('placeholder')||'',i=e.getAttribute('class')||'',n=e.getAttribute('id')||'',a=e.getAttribute('name')||'',r=/(search|find|zoek|поиск|найти|искать|recherche|suchen|buscar|suche|ricerca|procurar|検索)/i;return t.match(r)||i.match(r)||n.match(r)||a.match(r)?null:e}return e},this.captureDetails=e=>{if(!this.state.doFormCapture||this.state.creditCardForm)return;if(En())return;let t=et().fieldDict;if(null===this.state.creditCardForm){let e=Be(t),r=ri(e);if(r){var i=r.cardNumberFields,n=r.cardNumberField,a=r.cvvField;if((e=>{if(!e)return!1;var t=e.cardNumberField,i=document.location.host;return'bmo.com'!==(0===i.indexOf('www')?i.substr(i.indexOf('.')+1):i)||!t||'siBankCard'!==t.htmlID})(r)){if(n&&n.htmlValue)return;if(a&&a.htmlValue)return;if(i&&i[0]&&i[0].htmlValue)return}}}let r=!!this.state.guesser.changePasswordForm;var l=mn(t,r);if(l&&'object'==typeof l){const t=this.state.tabInfo&&this.state.tabInfo.url?this.state.tabInfo.url:null;if('signup'===l.formCaptureType&&t){let e=new URL(this.state.tabInfo.url);l.url=e.origin}else l.url=t||document.URL;if('update_password'===l.type&&l.secure_data){let e=this.state.filler.generated_password_item_uuid,t=this.state.filler.generated_password_vault_uuid;e&&t&&(l.secure_data.item_uuid=e,l.secure_data.vault_uuid=t,l.secure_data.team_id=this.state.filler.generated_password_team_id),l.uuid=this.state.uuid}e&&e.isManual&&(l.isManual=!0)}l&&h(d,(e=>{if(!e)return null;var t=e.webform&&e.webform[0];if(!t)return e;if(t.fields){var i=t.fields.map((function(e){return e.pointer&&delete e.pointer,e}));t.fields=i,e.webform[0]=t}return e})(l))},this.gatherFrameUrlsOfTab=()=>{if(this.state.frameUrls)return this.state.frameUrls;if(window.top===window.self){var e=Array.prototype.slice.call(document.getElementsByTagName('iframe'));let t=[new URL(document.URL).hostname];if(e&&e.length>0){for(let i=0,n=e.length;i<n;i++){let n=e[i];if(n&&n.src&&0===n.src.indexOf('http')){let e=new URL(n.src).hostname;t.includes(e)||t.push(e)}}return this.state.frameUrls=t,t}return t}return null},this.cacheUsernameOnClick=e=>{var t=null;if('submit'==e.type||'button'===e.tagName.toLowerCase()?t=e.value||e.textContent:'accounts.google.com'===document.domain&&e.parentElement&&'button'===e.parentElement.tagName.toLowerCase()&&(t=e.parentElement.textContent),!t){var i=e.getAttribute('aria-labelledby');i&&document.getElementById(i)&&(t=document.getElementById(i).textContent)}t&&['next','continue'].includes(t.trim().toLowerCase())&&this.cacheUsername()},this.clickListener=e=>{let t=e?e.target:this;if(t!==this.state.elementClicked&&(this.state.elementClicked=t,setTimeout((()=>{this.state.elementClicked=null}),300),this.cacheUsernameOnClick(e.target),lt(t))){if(t=(e=>{if(e&&'font'===e.tagName.toLowerCase())for(;e&&'font'===e.tagName.toLowerCase();)e=e.parentNode;return e})(t),!rt(t)){let e=t.parentElement;if(!e||!rt(e))return;t=e}if(document.querySelector('input[data-enpassusermodified]')){var i=((e,t)=>{if(!e||!t)return null;if('accounts.google.com'===location.host&&'/signin/v2/challenge/pwd'===location.pathname&&(t=t.concat(['next'])),-1!==['button','input'].indexOf(e.tagName.toLowerCase())){if('button'===e.tagName.toLowerCase()&&!e.hasAttribute('type')||'button'===e.type.toLowerCase()){if(e.textContent&&!e.textContent.trim())return null;if($e(e.textContent,t)||$e(e.value,t))return e}if(-1!==['submit','image'].indexOf(e.type.toLowerCase())){var i=e.textContent;return i&&['`','}','=','&','{','@','?','<',')','_',',','[','^','*','#',']','>','.','(',':','~','|','-','!','/','$','i','w','a','c','n','r','o','t','e','u','back','f','b','z','d','l','p','j','v','y','clear','h','x','m','q','s','g','k','caps lock','hovering off','space','shuffle off','2','0','1','8','5','6','9','4','7','3'].includes(i.toLowerCase())?null:e}}else if(e){var n=e.getAttribute('data-action');if(n&&(n=n.replace(/^\s+/m,'').replace(/\s+$/m,'').replace(/\s\s+/,' ').toLowerCase().trim()).indexOf('submit')>=0){var a=e.textContent||e.value;if('div'===e.tagName.toLowerCase()&&e.classList.contains('button')&&a&&$e(a,t)&&!$e(a,['already have an account','sign in with']))return e}}for(var r=3;e&&e!==document&&r>=0;){var l=e.textContent||e.value||null;if(l&&-1!==['a','button'].indexOf(e.tagName.toLowerCase())&&(e.hasAttribute('type')&&'submit'===e.type.toLowerCase()||l&&$e(l,t)&&!$e(l,['already have an account','sign in with'])))return e;e=e.parentNode,r--}return null})(t,Pn);if(i)this.captureDetails();else if(i=(e=>{var t=e.ownerDocument.querySelectorAll('[role=button]');if(t)for(var i=t.length,n=0;n<i;n++)if(-1!==Array.prototype.slice.call(t[n].getElementsByTagName(e.tagName)).indexOf(e))return t[n];return null})(t),i){if(i.hasAttribute('aria-label')){let e=i.getAttribute('aria-label');if(e&&'show password'===e.toLowerCase()||'hide password'===e.toLowerCase())return}(i.getAttribute('title')&&Pn.indexOf(i.getAttribute('title').toLowerCase())>=0||i.getAttribute('alt')&&Pn.indexOf(i.getAttribute('alt').toLowerCase())>=0)&&this.captureDetails()}}}},this.guessFormType=e=>{var t=et(),i=t.fieldDict,n=t.formDict;this.state.fieldDict=i,this.state.formDict=n;var a=Qi(n,!0),r=Et(n),l=e?e.action_type:null;let s=Array.prototype.slice.call(document.querySelectorAll('input[type=\'password\']')).filter((function(e){return fe(e)})),o=!!(s&&s.length>0);const d=En();if(!o&&a&&a.form&&'login_fields'===a.form.type&&a.form.loginFields&&a.form.loginFields.pswdField&&(o=!0),r)return this.state.guesser.changePasswordForm=r,void h(u,{isChangePassword:!0,current_password:!!r.currentPasswordField,uuid:this.state.uuid,url:this.state.tabInfo.url,tabID:this.state.tabInfo.id,action_type:l,enableSaveWebform:!d&&o});if(a)return this.state.loginForm=a.form,void h(u,{isLogin:!0,uuid:this.state.uuid,url:this.state.tabInfo.url,iframeURL:ot()?'':this.state.iframeURL,tabID:this.state.tabInfo.id,action_type:l,enableSaveWebform:!d&&o,score:a.score});{const e=ri(n);if(e)return this.state.creditCardForm=e,void h(u,{isCreditcard:!0,uuid:this.state.uuid,url:this.state.tabInfo.url,tabID:this.state.tabInfo.id,action_type:l,enableSaveWebform:!1});{const e=i.filter((e=>{if(['email','text'].includes(e.htmlType)&&e.visible){if(Qe(e))return!0;if(Ai(e)>0)return!0}return!1}));e&&e.length>0?h(u,{isLogin:!0,uuid:this.state.uuid,url:this.state.tabInfo.url,iframeURL:ot()?'':this.state.iframeURL,tabID:this.state.tabInfo.id,action_type:l,enableSaveWebform:!d&&o,score:1}):o&&h(u,{isLogin:!1,uuid:this.state.uuid,url:this.state.tabInfo.url,iframeURL:ot()?'':this.state.iframeURL,tabID:this.state.tabInfo.id,enableSaveWebform:!d&&o})}}},this.setTabInfo=e=>{if(e){if(e.tabUrl)try{var t=new URL(e.tabUrl);this.state.tabInfo.domain=t.host,this.state.tabInfo.url=t.origin+t.pathname}catch(e){}if(e.tabId&&(this.state.tabInfo.id=e.tabId,Array.isArray(this.state.inspectedTabs))){const t=this.state.inspectedTabs.includes(e.tabId);Y.dispatch({type:'DEVTOOLS_STATE_CHANGED',payload:t})}}},this.messageHandler=(e,t,i,n)=>{var a,r,l;if(parent===window||!((a=document.URL)&&[/(:\/\/ad)[0-9]?\.(.*)/gi,/(:\/\/ads.)\.(.*)/gi,/(:\/\/)(adserver.*)\.(.*)/gi,/(:\/\/.*\/.*adframe.*)/gi,/(:\/\/tag)\.(admeld.*)\.(.*)/gi,/(:\/\/.*)\.(atdmt\.com\/)(.*)/gi,/(:\/\/.*)\.(doubleclick)\.(.*)/gi,/(:\/\/.*)\.(ak\.fbcdn\.net)\/(.*)/gi,/(:\/\/)(plusone\.google\.com)\/(.*)/gi,/(:\/\/)(platform\.twitter\.com)\/(widgets)\/(.*)/gi,/(:\/\/.*)\.(facebook\.com)\/(widgets|plugins|extern)\/(.*)/gi,/(:\/\/)(stats\.complex\.com)\/(.*)/gi,/(:\/\/.*)\.(addthis\.com)\/(static)\/(.*)/gi,/(:\/\/)(vitamine\.networldmedia\.net)\/(.*)/gi,/(:\/\/)(api\.tweetmeme\.com)\/(.*)/gi,/(:\/\/)(engine\.adzerk\.net)\/(.*)/gi,/(:\/\/.*)\.(atwola\.com)\/(.*)/gi,/(:\/\/.*)\.(stumbleupon\.com)\/(badge)\/(.*)/gi,/(:\/\/.*)\.(stumbleupon\.com)\/(badge)\/(.*)/gi,/(:\/\/.*)\.(bizographics\.com)\/(collect)\/(.*)/gi].some((e=>e.test(a)))||0===window.innerHeight||0===window.innerWidth))switch(e){case'gather_frame_urls':{let e=this.gatherFrameUrlsOfTab();e&&h('cache_frame_urls',{frameUrls:e});break}case'guess_form_type':{this.state.loginForm=null,this.changePasswordForm=null,this.creditCardForm=null;let e=this.gatherFrameUrlsOfTab();e&&h('cache_frame_urls',{frameUrls:e}),this.inlineManager&&this.inlineManager.removeMenu(),this.guessFormType(t);break}case'generated_password_fill':this.generatedPasswordFiller(t);break;case'tab_info':this.setTabInfo(t);break;case'FILL_TOTP':{const e=this.delayTotpDeductionBy(document.URL);setTimeout((()=>{ln(t,{uuid:this.state.uuid},(()=>{h('CLEAR_TOTP_DATA')}))}),e);break}case'fill_login_item':!1===this.state.autoSubmit&&(t.secure_data.autoSubmit=!1),this.turnOffAutoCapture(),this.inlineManager&&this.inlineManager.removeMenu(),!t||t.uuid&&t.uuid!==this.state.uuid||!ut(t)||(te.removeInstanceFromMap(),this.fillLoginItem(t));break;case'fill_credit_card_item':this.turnOffAutoCapture(),Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0}),te.removeInstanceFromMap(),!t||t.uuid&&t.uuid!==this.state.uuid||this.fillCreditCardItem(t),Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1});break;case'fill_identity_item':if(this.turnOffAutoCapture(),ot()||dt([t.url]))return;zi(null,t.secure_data);break;case'fetch_old_shortcut_result':t.shortcut_key&&this.bindShortcutKey(t.shortcut_key,'old_shortcut',(()=>{h('handle_old_shortcut')}));break;case'fetch_shortcut_key_result':this.bindShortcutKey(t.activate,'activate',(()=>{const{frameID:e,locked:t,menuOpen:i}=Y.getState();t&&i?h('launch_assistant',{request:'unlock',uuid:e}):h('launch_assistant')})),this.bindShortcutKey(t.autofill,'autofill',(()=>{h('shortcut_key_pressed')})),this.bindShortcutKey(t.lock,'lock',(()=>{h('lock_app')}));break;case'shortcut_key_changed':this.shortcutKeyChanged(t.shortcut_key);break;case'capture_form':this.captureDetails(t);break;case'disable_autosubmit':this.state.autoSubmit=!1;break;case'show_save_dialog':window.top!==window.self||this.state.isSaveDialogShown||(this.state.isSaveDialogShown=!0,(()=>{var e=document.createElement('div');e.setAttribute('id','enpass_overlay'),e.setAttribute('style','top: 0px;left: 0px;padding: 0px;height: 1px;position: fixed;z-index: 1000000099;visibility: visible;background-color: black;');var t=document.createElement('iframe');t.setAttribute('id','enpass_iframe'),t.setAttribute('scrolling','no');var i=chrome.runtime.getURL('injected/dialog/dialog.html');t.setAttribute('src',i),window.innerWidth>=800?t.setAttribute('style','height: 48px;width: '+window.innerWidth+'px;border: 0px;'):window.innerWidth<800&&window.innerWidth>=500?t.setAttribute('style','height: 80px;width: '+window.innerWidth+'px;border: 0px;'):window.innerWidth<500&&t.setAttribute('style','height: 80px;width: 500px;border: 0px;');var n=document.createElement('div');n.setAttribute('id','enpass_spacer'),n.setAttribute('style','height : 48px;'),e.appendChild(t),document.body&&(document.body.appendChild(e),document.body.insertBefore(n,document.body.firstChild)),window.addEventListener('resize',kn)})());break;case'destroy_dialog':this.state.isSaveDialogShown=!1,r=document.getElementById('enpass_overlay'),l=document.getElementById('enpass_spacer'),r&&(document.body.removeChild(r),document.body.removeChild(l),window.removeEventListener('resize',kn));break;case'autofillItem':this.fillLoginItem(t);break;case'set_inspected_tabs_list':{const e=Array.isArray(t.inspectedTabs)?t.inspectedTabs:[];if(this.state.inspectedTabs=e,e&&this.state?.tabInfo?.id){const t=e.some((e=>e===this.state?.tabInfo?.id));t&&te.removeInstanceFromMap(),Y.dispatch({type:'DEVTOOLS_STATE_CHANGED',payload:t})}break}}},this.oneTimeInputChangeHandler=()=>{this.state.filler.generated_password_item_uuid=null,this.state.filler.generated_password_vault_uuid=null,this.state.filler.generated_password_team_id=null,h('generated_password_modified',{uuid:this.state.uuid}),clearInterval(this.hiddenInterval),this.hiddenInterval=null,document.removeEventListener('input',this.oneTimeInputChangeHandler,!0)},this.generatedPasswordFiller=e=>{var t=this.state.guesser.changePasswordForm;if(e)if(e.current_password)e.uuid===this.state.uuid&&t&&(clearInterval(this.hiddenInterval),this.hiddenInterval=null,document.removeEventListener('input',this.oneTimeInputChangeHandler,!0),this.state.filler.generated_password_item_uuid=e.item_uuid,this.state.filler.generated_password_vault_uuid=e.vault_uuid,this.state.filler.generated_password_team_id=e.team_id,nt(t.currentPasswordField,e.current_password),nt(t.newPasswordField,e.generated_password),nt(t.confirmPasswordField,e.generated_password),setTimeout((()=>{document.addEventListener('input',this.oneTimeInputChangeHandler,!0)}),2e3),this.hiddenInterval=setInterval((()=>{const e=this.state.filler.generated_password_item_uuid,i=this.state.filler.generated_password_vault_uuid,n=Ve(t.currentPasswordField),a=Ve(t.newPasswordField);a?!fe(a)&&a.value&&n&&n.value&&(this.hiddenInterval&&h(d,{url:this.state.tabInfo.url,type:'update_password',secure_data:{item_uuid:e,vault_uuid:i,team_id:this.state.filler.generated_password_team_id,oldPassword:n?n.value:'',newPassword:a?a.value:'',password:a?a.value:''},event_type:'visibility',uuid:this.state.uuid,webForm:[]}),clearInterval(this.hiddenInterval),this.hiddenInterval=null):(clearInterval(this.hiddenInterval),this.hiddenInterval=null)}),1e3));else{let r=Array.prototype.slice.call(document.querySelectorAll('input[type=\'password\']'));if(!r||0===r.length)return;let l=null;t&&t.currentPasswordField&&(l=t.currentPasswordField.elementNumber);let s=[];r.forEach((function(e){let t=Me(e);s.push(t)}));let o=s.filter((function(e){return e.visible&&e.elementNumber!==l}));if(o&&0===o.length)return;if(o&&1===o.length){let t=Ve(o[0]);return void at(t,e.generated_password)}let d=o.filter((function(e){return e.viewable}));if(d&&1===d.length){let t=Ve(d[0]);return void at(t,e.generated_password)}var i=null;if(this.state.formDict)i=this.state.formDict;else{let e=Re(null,this.state.uuid);i=Be(e)}var n=null;t||(n=Qi(i));var a=[];n&&n.fields?(a=o.filter((function(e){let t=n.fields.find((function(t){return((e,t)=>{var i=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);if(i.length!=n.length)return!1;for(var a=0;a<i.length;a++){var r=i[a];if(e[r]!==t[r])return!1}return!0})(t,e)&&e.viewable}));return!t})),0===a.length&&(a=n.fields)):a=o;for(let t=0,i=a.length;t<i;t++){let i=a[t];if(i&&'password'===i.htmlType){let t=Ve(i);at(t,e.generated_password)}}}},this.fillLoginItem=e=>{if(!e)return;if(ot()||dt([e.url]))return;let t=e.secure_data;if(!(t.email||t.username||t.user_name||t.password))return;if(!this.state.loginForm){let e=Re(),t=Be(e);this.state.loginForm=Qi(t)}var i=!1;let n=e.webform;var a=t=>{t&&t.isTotpExist&&h('CLEAR_TOTP_DATA'),t?.showInlineMenu?(Y.dispatch({type:'REMOVE_ACTIVE_FIELD'}),Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1}),document.activeElement&&e.secure_data&&Y.dispatch({type:'SET_ACTIVE_FIELD',payload:document.activeElement})):Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1})};if(n)if(-1!==(location.hostname+location.pathname).indexOf('accounts.google.com'))i=!1;else if(n&&n[0]&&n[0].valueMap){let r=void 0!==e.isUsernameInWebForm&&e.isUsernameInWebForm,l=void 0!==e.isEmailInWebForm&&e.isEmailInWebForm,s={autoSubmit:t.autoSubmit,totp_1:t.totp_1,totp_1_valid:t.totp_1_valid,totp_2:t.totp_2,totp_2_valid:t.totp_2_valid};Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0}),i=_n(n,s,this.state.loginForm,r&&l?null:{username:t.username,user_name:t.user_name,email:t.email},a)}if(!(e.uuid&&e.uuid!==this.state.uuid||i)){let t=null,i=null;if(this.state.loginForm||(t=Re(),i=Be(t),this.state.loginForm=Qi(i)),this.state.loginForm){Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0});const{isPasskeySupported:t}=Y.getState(),i={...e.secure_data,isPasskeySupported:t};if(!!e.urlFillRequested&&Tn(this.state.loginForm))return;sn(this.state.loginForm,{clientData:i,uuid:Y.getState().uuid},a)}else{const i=t.filter((e=>{if(['email','text'].includes(e.htmlType)&&e.visible){if(Qe(e))return!0;if(Ai(e)>0)return!0}return!1}));if(i&&i.length>0){if(Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!0}),Qe(i[0])){const t=Ve(i[0]);at(t,e.secure_data.email||e.secure_data.username)}Y.dispatch({type:'AUTOFILL_IN_OPERATION',payload:!1})}}}},this.delayTotpDeductionBy=e=>{const t=new URL(e);if(t&&t.hostname){if(/.*okta\.com$/gi.test(t.hostname))return 1800}return 1},this.shortcutKeyChanged=e=>{e?this.bindShortcutKey(e):''===e&&(On.unbind(this.state.keyShortcut),this.state.keyShortcut=e)},this.bindShortcutKey=(e,t,i)=>{if(e){const n=e.toLowerCase();this.state&&this.state.keyShortcut&&this.state.keyShortcut[t]&&On.unbind(this.state.keyShortcut[t]),this.state.keyShortcut[t]=n,On.bindGlobal(this.state.keyShortcut[t],i,'keydown')}else this.state&&this.state.keyShortcut&&this.state.keyShortcut[t]&&On.unbind(this.state.keyShortcut[t])},this.turnOffAutoCapture=()=>{this.state.doFormCapture=!1,setTimeout((()=>{this.state.doFormCapture=!0}),1e3)},this.fillCreditCardItem=e=>{if(!ot()&&!dt([e.url]))if(this.state.creditCardForm)oi(this.state.creditCardForm,e.secure_data);else{var t=Re(),i=Be(t),n=ri(i,!0);n&&(n.cardNumberField||n.cardHolderField||n.cardTypeField||n.cvvField)&&oi(n,e.secure_data)}}}};Bn.init(),document.addEventListener('DOMContentLoaded',(()=>{const e=Ye(document.URL);Rn.includes(e)?setTimeout((()=>{Un()}),1500):Un()})),f.onPasskeyCreation((e=>{const t={command:'passkey_creation_intercepted_response',payload:Object.assign({},e)};window.postMessage(t)})),f.onPasskeyAuthentication((e=>{const t={command:'passkey_authentication_intercepted_response',payload:Object.assign({},e)};window.postMessage(t)})),window.addEventListener('message',(e=>{const t=e.data,i=t?.command,n=t?.payload,a=n?.request;if(e.origin===window.origin&&i&&a&&['passkey_creation_intercepted','passkey_authentication_intercepted'].includes(i))switch(i){case'passkey_creation_intercepted':if(a?.rp?.id||(a.rp.id=zn(document.URL)),Vn(a?.rp?.id)&&window.origin===n.origin)h('initiate_passkey_creation',Object.assign({},n));else{const{origin:e,uuid:t}=n,i={command:'passkey_creation_intercepted_response',payload:{useBrowserMethod:!0,error:{rpid:!0,description:'rpid does not match with origin'},uuid:t,origin:e}};window.postMessage(i)}break;case'passkey_authentication_intercepted':if(a?.rp?.id&&(a.rp.id=zn(document.URL)),Vn(a?.rpId)&&window.origin===n.origin)h('initiate_passkey_authentication',Object.assign({},n));else{const{origin:e,uuid:t}=n,i={command:'passkey_authentication_intercepted_response',payload:{useBrowserMethod:!0,error:{rpid:!0,description:'rpid does not match with origin'},uuid:t,origin:e}};window.postMessage(i)}}}))}();
