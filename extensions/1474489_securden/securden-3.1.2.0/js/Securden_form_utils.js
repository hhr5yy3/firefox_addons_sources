var SecurdenExtensionFormUtils={formUrlParams:[],portNumRegex:"^[1-9][0-9]*$",portValidation:"portValidation",changeParamArrayToJson:function(e){for(var t={},r=0;r<e.length;r++)t[e[r].name]=e[r].value;return t},getFormDataFromObj:function(e){return SecurdenExtensionFormUtils.changeParamArrayToJson(e.serializeArray())},getFormData:function(e){return SecurdenExtensionFormUtils.getFormDataFromObj(jQuery("#"+e))},validateForm:function(e){for(var t=!1,r=!1,n=jQuery("#"+e).find("[cyb-validate-func]"),a=jQuery("#"+e).find("[cyb-mandatory]:not([cyb-validate-func])"),i=jQuery("#"+e).find("[cyb-max-length]:not([cyb-validate-func]):not([cyb-mandatory])"),o=$("#"+e).find("[cyb-is-validate]:not([cyb-max-length]):not([cyb-validate-func]):not([cyb-mandatory])"),s=0;s<n.length;s++){var l=!0,u=!1;if(jQuery(n[s]).parent().find("[divType='errorMsg']").remove(),n[s].getAttribute("cyb-max-length")&&n[s].value.trim().length>parseInt(n[s].getAttribute("cyb-max-length"))&&(l=browser.i18n.getMessage("value_length_should_be_less_than",n[s].getAttribute("cyb-max-length")),u=!0),!u&&n[s].getAttribute("cyb-mandatory")&&0==n[s].value.trim().length&&(l=!1,u=!0),!u&&n[s].value&&n[s].value.trim().length>0){var g=n[s].getAttribute("cyb-validate-func-file");null!=g&&null!=g||(g="SecurdenExtensionValidationMethods");var c=n[s].getAttribute("cyb-validate-func"),m=window[g][c];"function"==typeof m&&(l=n[s].getAttribute("cyb-validate-func-param")?m(n[s].value,n[s].getAttribute("cyb-validate-func-param")):m(n[s].value))}l||(l=n[s].getAttribute("cyb-err-msg")),jQuery(n[s]).parent().find("[divType='errorMsg']").remove(),l&&"string"==typeof l&&(t||(n[s].scrollIntoView(),jQuery(n[s]).focus(),t=!0),jQuery(n[s]).after("<span divType='errorMsg' class='cyb-custom-error'>"+l+"</span>"))}for(s=0;s<a.length;s++){jQuery(a[s]).parent().find("[divType='errorMsg']").remove();l=!1;if(0==a[s].value.trim().length&&(l=browser.i18n.getMessage("mandatory_field_cannot_be_empty")),a[s].getAttribute("regex")&&a[s].getAttribute("regex")==SecurdenExtensionFormUtils.portNumRegex){var y=new RegExp(SecurdenExtensionFormUtils.portNumRegex),d=a[s].value.trim();y.test(d)||(l=browser.i18n.getMessage("valid_field_value"))}if(a[s].getAttribute("cyb-split-fields")){var f=a[s].value.trim();if(f){var[b,v]=f.split(/[:=]/).map((e=>e.replace(/['"]/g,"")));b&&v||(l=browser.i18n.getMessage("input_format_doesnt_match"))}}a[s].getAttribute("cyb-max-length")&&a[s].value.trim().length>parseInt(a[s].getAttribute("cyb-max-length"))&&(l=browser.i18n.getMessage("value_length_should_be_less_than",a[s].getAttribute("cyb-max-length"))),jQuery(a[s]).parent().find("[divType='errorMsg']").remove(),l&&(t||(a[s].scrollIntoView(),jQuery(a[s]).focus(),t=!0),jQuery(a[s]).after("<span divType='errorMsg' class='cyb-custom-error'>"+l+"</span>"))}for(s=0;s<i.length;s++){jQuery(i[s]).parent().find("[divType='errorMsg']").remove();l=!1;if(i[s].value.trim().length>parseInt(i[s].getAttribute("cyb-max-length"))&&(l=browser.i18n.getMessage("value_length_should_be_less_than",i[s].getAttribute("cyb-max-length"))),i[s].value.trim()&&i[s].getAttribute("validation_function")==SecurdenExtensionFormUtils.portValidation){y=new RegExp(SecurdenExtensionFormUtils.portNumRegex),d=i[s].value.trim();y.test(d)||(l=browser.i18n.getMessage("valid_field_value"))}if(i[s].value.trim()&&i[s].getAttribute("regex")&&i[s].getAttribute("regex")==SecurdenExtensionFormUtils.portNumRegex){y=new RegExp(SecurdenExtensionFormUtils.portNumRegex),d=i[s].value.trim();y.test(d)||(l=browser.i18n.getMessage("valid_field_value"))}jQuery(i[s]).parent().find("[divType='errorMsg']").remove(),l&&(t||(i[s].scrollIntoView(),jQuery(i[s]).focus(),t=!0),jQuery(i[s]).after("<span divType='errorMsg' class='cyb-custom-error'>"+l+"</span>"))}for(s=0;s<o.length;s++){jQuery(o[s]).parent().find("[divType='errorMsg']").remove();l=o[s].getAttribute("cyb-err-msg");var p=o[s].name,x=o[s].value;SecurdenExtensionFormUtils.checkIfValid(e,p,x,jQuery(o[s]),l).isError&&(t||"file"==o[s].getAttribute("type")?r=!0:(o[s].scrollIntoView(),jQuery(o[s]).focus(),t=!0))}return!t&&!r},checkIfValid:function(e,t,r,n,a){var i,o=SecurdenExtensionFormUtils.formUrlParams[e],s=!1;if($("#"+e).find("[for='"+t+"']").find("[divType='errorMsg']").remove(),jQuery(n).parent().find("[divType='errorMsg']").remove(),t in o)if(!(i=o[t]).mandatory||r&&""!=r.trim()){if(r)if(i.max_length&&r.length>i.max_length&&(s=!0,a=browser.i18n.getMessage("value_exceeds_max_length")+" : "+i.max_length),i.type){if("long"==i.type)isNaN(r)&&(s=!0,a||(a=browser.i18n.getMessage("enter_valid_number")));else if("file"==i.type){var l=r.split(".");i.file_extension&&i.file_extension.indexOf(l[l.length-1])<0&&(s=!0,a||(a=browser.i18n.getMessage("unsupported_file_type")))}}else if(i.regex){var u=new RegExp(i.regex);r.match(u)||(s=!0,a||(a=browser.i18n.getMessage("recheck_text_pattern")))}}else s=!0,a||(a=browser.i18n.getMessage("mandatory_field_cannot_be_empty"));s&&((i=o[t]).type&&"file"==i.type?this.$("#"+e).find("label[for='"+t+"']").append("<span divType='errorMsg' class='cyb-custom-error'>"+a+"</span>"):n.after("<span divType='errorMsg' class='cyb-custom-error'>"+a+"</span>"));return{isError:s}}};