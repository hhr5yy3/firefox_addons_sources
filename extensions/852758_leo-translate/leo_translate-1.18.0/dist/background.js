(()=>{"use strict";function e(e){let t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t}void 0!==chrome.contextMenus&&chrome.contextMenus.create({id:"leo-translate",title:"Translate with Leo",contexts:["selection"],onclick:(e,t)=>{chrome.tabs.sendMessage(t.id,{id:"content-open-popup",text:e.selectionText,context:""})}}),chrome.runtime.onMessage.addListener((function(t,o,n){const r=["proxy-content-mouse","proxy-content-get-data","proxy-content-open-popup","proxy-content-close-popup","proxy-content-resize-popup","proxy-content-refresh-popup"],i=["proxy-content-refresh-options"];if("background-show-notification"===t.id)chrome.notifications.create({type:"basic",title:"Leo Translate",iconUrl:"icons/icon.svg",message:(s=t.text,s.replace(/[<>]/g,""))});else if("background-get-current-host"===t.id)browser.tabs.query({currentWindow:!0,active:!0}).then((function(t){void 0!==t[0]&&chrome.runtime.sendMessage({id:"browser-action-current-host",host:e(t[0].url)})}));else{if("background-add-word-to-dictionary"===t.id)return browser.cookies.get({url:"https://api.lingualeo.com/",name:"userid"}).then((async e=>{const{word:o,translation:r,context:i}=t,s=JSON.stringify({apiVersion:"1.0.1",userId:null==e?void 0:e.value,port:"1001",data:[{action:"add",valueList:{wordValue:o,wordSetId:3,translation:{tr:r,ctx:i,pic:"https://contentcdn.lingualeo.com/uploads/1611_1361481210.jpg"}}}]}),c=await fetch("https://api.lingualeo.com/SetWords",{body:s,method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});n(c.ok&&await c.json()||{error_msg:"Couldn't add word to dictionary"})})),!0;r.indexOf(t.id)>-1?o.tab?chrome.tabs.sendMessage(o.tab.id,t):browser.tabs.query({currentWindow:!0,active:!0}).then((function(e){void 0!==e[0]&&chrome.tabs.sendMessage(e[0].id,t)})):i.indexOf(t.id)>-1&&browser.tabs.query({}).then((function(e){for(const o of e)chrome.tabs.sendMessage(o.id,t)}))}var s}))})();