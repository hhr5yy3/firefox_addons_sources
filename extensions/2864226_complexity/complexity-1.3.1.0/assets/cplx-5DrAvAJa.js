import{j as t,c as f}from"./cplx-DEt7CUyc.js";import{P as x}from"./cplx-BsCYqTWz.js";import{u as b,g as w,F as y}from"./cplx-CWPpH3dB.js";import{r as i}from"./cplx-M4JPizzD.js";import{d as C,e as h,t as c,V as B,b as j}from"./cplx-CejnDNPm.js";import{b as T}from"./cplx-DewpVJ-0.js";import{T as v}from"./cplx-Cqfmi6PF.js";import{D,a as M,b as O,c as d}from"./cplx-D6x2E8AM.js";import{u as N}from"./cplx-n_Xg7oLY.js";import{u as k}from"./cplx-hUtawQMb.js";import{$ as l}from"./cplx-BbAh7E-i.js";import{D as E}from"./cplx-Cdcyb6EG.js";import"./cplx-CVsLL7Ku.js";import"./cplx-CzQHx1MX.js";import"./cplx-DSnlyBAv.js";import"./cplx-CXGk_GMP.js";import"./cplx-BpeHHEix.js";import"./cplx-AFeO3sEC.js";import"./cplx-2ekRUlSR.js";import"./cplx-CIDXzIHh.js";import"./cplx-CvSOQQlQ.js";import"./cplx-Bzmv935M.js";import"./cplx-Bey00KRS.js";import"./cplx-DC-QQLj-.js";import"./cplx-B814hFp-.js";import"./cplx-wwbq-DDb.js";import"./cplx-BqwXc_LR.js";import"./cplx-D37zsf-y.js";import"./cplx-CZMWhpfy.js";import"./cplx-SsoyhRxE.js";import"./cplx-B42KOvrD.js";import"./cplx-km2FGkQ4.js";import"./cplx-Mn-h5XDX.js";import"./cplx-CCGYIZQf.js";import"./cplx-DD6dUv5H.js";import"./cplx-Dy60Fcq0.js";import"./cplx-CgmVhoKz.js";import"./cplx-CCS6eJc0.js";import"./cplx-B19A3gYQ.js";const L=i.memo(function({messageBlockIndex:o,hasSources:e}){const[s,r]=k({defaultText:t.jsx(C,{className:"tw-size-4"})}),{copyMessage:a,isFetching:p}=N(),u=i.useCallback(async m=>{p||await a({messageBlockIndex:o,withCitations:m,onComplete:()=>r(t.jsx(h,{className:"tw-size-4"}))})},[a,p,o,r]);return t.jsxs(D,{lazyMount:!0,unmountOnExit:!0,positioning:{placement:"bottom-end"},onSelect:({value:m})=>{u(m==="default")},children:[t.jsx(v,{content:c("plugin-better-copy-buttons:copyButton.tooltip"),children:t.jsx(M,{asChild:!0,children:t.jsx(S,{isFetching:p,icon:s,onClick:()=>!e&&u(!0)})})}),e&&t.jsxs(O,{className:"tw-font-medium",children:[t.jsxs(d,{value:"default",className:"tw-flex tw-items-center tw-gap-2",children:[t.jsx(T,{className:"tw-size-4"}),t.jsx("span",{children:c("plugin-better-copy-buttons:copyButton.options.default")})]}),t.jsxs(d,{value:"without-citations",className:"tw-flex tw-items-center tw-gap-2",children:[t.jsx(B,{className:"tw-size-4"}),t.jsx("span",{children:c("plugin-better-copy-buttons:copyButton.options.withoutCitations")})]})]})]})}),S=i.memo(i.forwardRef(function({isFetching:o,icon:e,onClick:s,...r},a){return t.jsx("div",{...r,ref:a,tabIndex:0,className:f("tw-cursor-pointer tw-rounded-md tw-p-2 tw-text-muted-foreground tw-transition-all hover:tw-bg-secondary hover:tw-text-foreground active:tw-scale-95",{"tw-cursor-not-allowed tw-opacity-50":o}),onClick:s,children:o?t.jsx(j,{className:"tw-size-4 tw-animate-spin"}):e})})),I="[data-cplx-component=message-block-bottom-bar] [data-cplx-component=cplx-better-message-copy-buttons]:not(:empty)+button[aria-label=Copy]{display:none}[data-cplx-component=message-block-bottom-bar] [data-cplx-component=cplx-better-message-copy-buttons]:empty{display:none}",g="cplx-better-message-copy-buttons";function R(){const n=b(o=>o.threadComponents.messageBlockBottomBars);return n==null?[]:n.map(o=>{if(o==null)return null;const e=l(o).find(E.THREAD.MESSAGE.BOTTOM_BAR_CHILD.COPY_BUTTON),s=l(o).find(`div[data-cplx-component="${g}"]`);if(s.length)return s[0];const r=l("<div>").internalComponentAttr(g);return e.before(r),r[0]})}function ht(){const n=R();return w({id:"cplx-better-message-copy-buttons-hide-native-buttons",css:I}),n.map((o,e)=>{var s,r;return t.jsx(x,{container:o,children:t.jsx(L,{messageBlockIndex:e,hasSources:(((r=(s=y.getState().threadComponents.messageBlocks)==null?void 0:s[e])==null?void 0:r.$sourcesHeading.length)??0)>0})},e)})}export{ht as default};
