!function(){var o=Array.prototype.forEach,n=Object.prototype.hasOwnProperty,r=Array.prototype.slice,i=0;var h={keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++i+"";return t?t+e:e},has:function(t,e){return n.call(t,e)},each:function(t,e,n){if(null!=t)if(o&&t.forEach===o)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,r=t.length;i<r;i++)e.call(n,t[i],i,t);else for(var s in t)this.has(t,s)&&e.call(n,t[s],s,t)},once:function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(this,arguments),t=null),e}}},e={on:function(t,e,n){return u(this,"on",t,[e,n])&&e&&(this._events||(this._events={}),(this._events[t]||(this._events[t]=[])).push({callback:e,context:n,ctx:n||this})),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var i=this,r=h.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,s,o,c,l,f,a;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(c=0,l=(o=t?[t]:h.keys(this._events)).length;c<l;c++)if(t=o[c],s=this._events[t]){if(this._events[t]=i=[],e||n)for(f=0,a=s.length;f<a;f++)r=s[f],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&s(n,e),i&&s(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r,s=!e&&!n;for(r in"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t),i)i[r].off(e,n,this),s&&delete this._listeners[r];return this}},l=/\s+/,u=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var s=n.split(l),o=0,c=s.length;o<c;o++)t[e].apply(t,[s[o]].concat(i));return!1}return!0},s=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],c=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,c);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}};h.each({listenTo:"on",listenToOnce:"once"},function(i,t){e[t]=function(t,e,n){return((this._listeners||(this._listeners={}))[t._listenerId||(t._listenerId=h.uniqueId("l"))]=t)[i](e,n="object"==typeof e?this:n,this),this}}),e.bind=e.on,e.unbind=e.off,e.mixin=function(e){return h.each(["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"],function(t){e[t]=this[t]},this),e},"undefined"!=typeof exports?(exports="undefined"!=typeof module&&module.exports?module.exports=e:exports).BackboneEvents=e:"function"==typeof define&&"object"==typeof define.amd?define(function(){return e}):this.BackboneEvents=e}();