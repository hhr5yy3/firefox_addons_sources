!function(){let t;function e(t,e,r,i){Object.defineProperty(t,e,{get:r,set:i,enumerable:!0,configurable:!0})}function r(t){return t&&t.__esModule?t.default:t}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},s={},a=i.parcelRequire0e4f;null==a&&((a=function(t){if(t in n)return n[t].exports;if(t in s){var e=s[t];delete s[t];var r={id:t,exports:{}};return n[t]=r,e.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){s[t]=e},i.parcelRequire0e4f=a);var o=a.register;o("1U3jF",function(t,r){var i,n,s,a,o,u;e(t.exports,"AdType",function(){return i}),e(t.exports,"MessageType",function(){return n}),e(t.exports,"ProxyRequestType",function(){return s}),(a=i||(i={})).PREROLL="preroll",a.MIDROLL="midroll",(o=n||(n={})).ContentScriptMessage="TLP_ContentScriptMessage",o.PageScriptMessage="TLP_PageScriptMessage",o.WorkerScriptMessage="TLP_WorkerScriptMessage",o.GetStoreState="TLP_GetStoreState",o.GetStoreStateResponse="TLP_GetStoreStateResponse",o.EnableFullMode="TLP_EnableFullMode",o.EnableFullModeResponse="TLP_EnableFullModeResponse",o.DisableFullMode="TLP_DisableFullMode",o.UsherResponse="TLP_UsherResponse",o.NewPlaybackAccessToken="TLP_NewPlaybackAccessToken",o.NewPlaybackAccessTokenResponse="TLP_NewPlaybackAccessTokenResponse",o.MultipleAdBlockersInUse="TLP_MultipleAdBlockersInUse",o.ClearStats="TLP_ClearStats",(u=s||(s={})).Passport="passport",u.Usher="usher",u.VideoWeaver="videoWeaver",u.GraphQL="graphQL",u.GraphQLToken="graphQLToken",u.GraphQLIntegrity="graphQLIntegrity",u.TwitchWebpage="twitchWebpage"}),o("kuQgE",function(t,r){e(t.exports,"getFetch",function(){return c});var i=a("2Zov9"),n=a("3PO1e"),s=a("lW4ZV"),o=a("e4GnD"),u=a("kEZlj"),f=a("21qmY"),l=a("8kXXm"),p=a("53Td5"),h=a("1U3jF");let g=self.fetch;function c(t){let e=[],r=new Map,i=new Set,n=null,s=null,a=null;return"page"===t.scope&&self.addEventListener("message",async e=>{if(e.data?.type!==h.MessageType.PageScriptMessage)return;let r=e.data?.message;if(r&&r.type===h.MessageType.NewPlaybackAccessToken){await b(t);let e=await P(t,n,s),r={type:h.MessageType.NewPlaybackAccessTokenResponse,newPlaybackAccessToken:e};t.sendMessageToWorkerScripts(t.twitchWorkers,r)}}),self.addEventListener("message",t=>{if(t.data?.type!==h.MessageType.PageScriptMessage&&t.data?.type!==h.MessageType.WorkerScriptMessage)return;let r=t.data?.message;if(r)switch(r.type){case h.MessageType.ClearStats:if(console.log("[TTV LOL PRO] Cleared stats (getFetch)."),!r.channelName)break;let i=r.channelName.toLowerCase();e=e.filter(t=>t.channelName!==i),s?.includes(i)&&(n=null,s=null),a?.includes(i)&&(a=null)}}),async function(u,c){let m,P;let O=u instanceof Request?u.url:u.toString();if(O.startsWith("//")){let t=`${location.protocol}${O}`;u instanceof Request?u=new Request(t,u):u=t}else if(O.startsWith("/")){let t=`${location.origin}${O}`;u instanceof Request?u=new Request(t,u):u=t}let v=(0,f.default)(O),L=d(u,c),M=!1,x=null,N=null,D=async()=>void 0!==m?m:y(u,c);t:if(null!=v&&(0,p.twitchGqlHostRegex).test(v)){if(N=h.ProxyRequestType.GraphQL,null!=(m??=await D())&&m.includes("PlaybackAccessToken")){n=L,s=m;let e=null;try{e=JSON.parse(m)}catch(t){console.error("[TTV LOL PRO] Failed to parse GraphQL request body:",t)}await b(t);let r=e?.variables?.isLive,i=e?.variables?.playerType==="frontpage",a=e?.variables?.login,o=E(a,t);if(!r||i||o){console.log("[TTV LOL PRO] Not flagging PlaybackAccessToken request: not a livestream, is frontpage, or is whitelisted.");break t}let u=m.includes("PlaybackAccessToken_Template"),f=(0,l.default)(h.ProxyRequestType.GraphQLIntegrity,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0}),p=(0,l.default)(h.ProxyRequestType.GraphQLToken,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0}),g=!u&&!f;if(t.state?.anonymousMode===!0||p&&g){let e=await A(a,t.state?.anonymousMode===!0);e?(console.log("[TTV LOL PRO] Overriding PlaybackAccessToken request…"),x=e,g=!1):console.error("[TTV LOL PRO] Failed to override PlaybackAccessToken request.")}p&&!g&&(console.log("[TTV LOL PRO] Flagging PlaybackAccessToken request…"),M=!0);break t}let e=T(L,"Client-Integrity"),r="https://gql.twitch.tv/integrity"===O,i=null!=e;if(r||i){await b(t),(0,l.default)(h.ProxyRequestType.GraphQLIntegrity,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0})&&(r?(console.debug("[TTV LOL PRO] Flagging GraphQL integrity request…"),M=!0):i&&(console.debug("[TTV LOL PRO] Flagging GraphQL request with Client-Integrity header…"),M=!0));break t}}e:if(null!=v&&(0,p.usherHostRegex).test(v)){N=h.ProxyRequestType.Usher,a=O,await b(t);let e=!O.includes("/vod/"),r=O.includes(encodeURIComponent('"player_type":"frontpage"')),i=E((0,o.default)(O),t);if(!e||r||i){console.log("[TTV LOL PRO] Not flagging Usher request: not a livestream, is frontpage, or is whitelisted.");break e}(0,l.default)(h.ProxyRequestType.Usher,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0})&&(console.debug("[TTV LOL PRO] Flagging Usher request…"),M=!0)}r:if(null!=v&&(0,p.videoWeaverHostRegex).test(v)){N=h.ProxyRequestType.VideoWeaver;let n=e.find(t=>[...t.assignedMap.values()].includes(O));if(null==n&&console.warn("[TTV LOL PRO] No associated Usher manifest found for Video Weaver request."),i.has(O))break r;let s=O;if(n?.replacementMap!=null){let t=[...n.assignedMap].find(([,t])=>t===s)?.[0];null!=t&&n.replacementMap.has(t)?s=n.replacementMap.get(t):n.replacementMap.size>0?(s=[...n.replacementMap.values()][0],console.warn(`[TTV LOL PRO] Replacement Video Weaver URL not found for '${O}'. Using first replacement URL '${s}'.`)):console.error(`[TTV LOL PRO] Replacement Video Weaver URL not found for '${O}'.`)}s!==O&&(x??=new Request(s,{...c})),await b(t);let a=(0,l.default)(h.ProxyRequestType.VideoWeaver,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0}),o=r.get(s)??0;if(a&&o<1){r.set(s,o+1);let t=new Intl.PluralRules("en-US",{type:"ordinal"}),e=new Map([["one","st"],["two","nd"],["few","rd"],["other","th"]]);console.log(`[TTV LOL PRO] Flagging ${(r=>{let i=t.select(r),n=e.get(i);return`${r}${n}`})(o+1)} request to Video Weaver URL '${s}'\u{2026}`),M=!0}}x??=new Request(u,{...c,headers:Object.fromEntries(L)}),M&&(await b(t),x=await R(x,N,t));let U=await g(x);M&&w(N,t);let C=async()=>void 0!==P?P:U.clone().text();i:if(null!=v&&(0,p.usherHostRegex).test(v)&&U.status<400){let n=!O.includes("/vod/"),s=O.includes(encodeURIComponent('"player_type":"frontpage"')),a=(0,o.default)(O),u=E(a,t);if(!n)break i;let f=I(P??=await C());null!=f?(console.debug("[TTV LOL PRO] Received Usher response:",Object.fromEntries(f)),e.push({channelName:a,assignedMap:f,replacementMap:null,consecutiveMidrollResponses:0,consecutiveMidrollCooldown:0})):console.debug("[TTV LOL PRO] Received Usher response.");let l=[...f?.values()??[]];l.forEach(t=>{r.delete(t),i.delete(t),(s||u)&&i.add(t)}),t.sendMessageToContentScript({type:h.MessageType.UsherResponse,channel:a,videoWeaverUrls:l,proxyCountry:/USER-COUNTRY="([A-Z]+)"/i.exec(P)?.[1]||void 0})}n:if(null!=v&&(0,p.videoWeaverHostRegex).test(v)&&U.status<400){let r=e.find(t=>[...t.assignedMap.values()].includes(O));if(null==r){console.warn("[TTV LOL PRO] No associated Usher manifest found for Video Weaver response.");break n}let i=(P??=await C()).toLowerCase();if(i.includes("stitched-ad")&&i.includes("midroll")){console.log("[TTV LOL PRO] Midroll ad detected."),r.consecutiveMidrollResponses+=1,r.consecutiveMidrollCooldown=15;let e=E(r.channelName,t);t.state?.optimizedProxiesEnabled===!0&&r.consecutiveMidrollResponses<=2&&!e&&await S(t,a,r)&&function(){throw Error()}(),r.replacementMap=null}else r.consecutiveMidrollCooldown>0?r.consecutiveMidrollCooldown-=1:r.consecutiveMidrollResponses=0}return U}}function d(t,e){let r=t instanceof Request?t.headers:e?.headers;return r?r instanceof Headers?new Map(r.entries()):new Map(Array.isArray(r)?r:Object.entries(r)):new Map}async function y(t,e){if(t instanceof Request)return t.clone().text();let r=e?.body;return null==r?null:r instanceof Blob?r.text():r instanceof ArrayBuffer?new TextDecoder().decode(r):r instanceof FormData?[...r.entries()].map(t=>`${t[0]}=${t[1]}`).join("&"):r.toString()}function m(t,e){return[...t.keys()].find(t=>t.toLowerCase()===e.toLowerCase())}function T(t,e){let r=m(t,e);return null!=r?t.get(r):null}async function b(t){if(null==t.state)try{let e=await t.sendMessageToContentScriptAndWaitForResponse(t.scope,{type:h.MessageType.GetStoreState},h.MessageType.GetStoreStateResponse);t.state=e.state}catch(t){console.error("[TTV LOL PRO] Failed to get store state:",t)}}function E(t,e){return!!t&&(e.state?.whitelistedChannels.map(t=>t.toLowerCase())??[]).includes(t.toLowerCase())}async function R(t,e,r){if(r.isChromium){if(!r.state?.optimizedProxiesEnabled)return t;try{await r.sendMessageToContentScriptAndWaitForResponse(r.scope,{type:h.MessageType.EnableFullMode,timestamp:Date.now(),requestType:e},h.MessageType.EnableFullModeResponse)}catch(t){console.error("[TTV LOL PRO] Failed to flag request:",t)}return t}{let e=d(t),r=T(e,"Accept");return null!=r&&r.includes(n.default)?t:(function(t,e,r){let i=m(t,e);t.set(i??e,r)}(e,"Accept",`${r||""}${n.default}`),new Request(t,{headers:Object.fromEntries(e)}))}}function w(t,e){e.isChromium&&e.state?.optimizedProxiesEnabled&&e.sendMessageToContentScript({type:h.MessageType.DisableFullMode,timestamp:Date.now(),requestType:t})}async function A(t=null,e=!1){let r=t??(0,s.default)(location.href);if(!r)return null;let i=/^\d+$/.test(r),n=new Map(document.cookie.split(";").map(t=>t.trim().split("=")).map(([t,e])=>[t,decodeURIComponent(e)]));return new Request("https://gql.twitch.tv/gql",{method:"POST",headers:Object.fromEntries(new Map([["Authorization",n.has("auth-token")&&!e?`OAuth ${n.get("auth-token")}`:"undefined"],["Client-ID","kimne78kx3ncx6brgo4mv6wki5h1ko"],["Device-ID",(0,u.default)(32)]])),body:JSON.stringify({operationName:"PlaybackAccessToken_Template",query:'query PlaybackAccessToken_Template($login: String!, $isLive: Boolean!, $vodID: ID!, $isVod: Boolean!, $playerType: String!) {  streamPlaybackAccessToken(channelName: $login, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isLive) {    value    signature   authorization { isForbidden forbiddenReasonCode }   __typename  }  videoPlaybackAccessToken(id: $vodID, params: {platform: "web", playerBackend: "mediaplayer", playerType: $playerType}) @include(if: $isVod) {    value    signature   __typename  }}',variables:{isLive:!i,login:i?"":r,isVod:i,vodID:i?r:"",playerType:"site"}})})}async function P(t,e,r){try{let e=await A(null,t.state?.anonymousMode===!0);if(null==e)return null;let r=(0,l.default)(h.ProxyRequestType.GraphQLToken,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0});r&&(e=await R(e,h.ProxyRequestType.GraphQL,t));let i=await g(e);r&&w(h.ProxyRequestType.GraphQL,t);let n=await i.json(),s=n?.data?.streamPlaybackAccessToken;if(null==s)return null;return s}catch{return null}}async function O(t,e,r){if(null==e)return null;try{let i=function(t,e){if(null==t)return null;try{let r=new URL(t);return r.searchParams.delete("acmb"),r.searchParams.set("play_session_id",(0,u.default)(32)),r.searchParams.set("sig",e.signature),r.searchParams.set("token",e.value),r.toString()}catch{return null}}(e,r);if(null==i)return null;let n=new Request(i),s=(0,l.default)(h.ProxyRequestType.Usher,{isChromium:t.isChromium,optimizedProxiesEnabled:t.state?.optimizedProxiesEnabled??!0,passportLevel:t.state?.passportLevel??0});s&&(n=await R(n,h.ProxyRequestType.Usher,t));let a=await g(n);if(s&&w(h.ProxyRequestType.Usher,t),a.status>=400)return null;return await a.text()}catch{return null}}function I(t){let e=new i.Parser;e.push(t),e.end();let r=e.manifest;return r.playlists&&0!==r.playlists.length?new Map(r.playlists.map(t=>[t.attributes.VIDEO,t.uri])):null}async function S(t,e,r){console.log("[TTV LOL PRO] Getting replacement Video Weaver URLs…");try{console.log("[TTV LOL PRO] (1/3) Getting new PlaybackAccessToken…");let i=await t.sendMessageToPageScriptAndWaitForResponse("worker",{type:h.MessageType.NewPlaybackAccessToken},h.MessageType.NewPlaybackAccessTokenResponse),n=i?.newPlaybackAccessToken;if(null==n)return console.error("[TTV LOL PRO] Failed to get new PlaybackAccessToken."),!1;console.log("[TTV LOL PRO] (2/3) Fetching new Usher manifest…");let s=await O(t,e,n);if(null==s)return console.error("[TTV LOL PRO] Failed to fetch new Usher manifest."),!1;console.log("[TTV LOL PRO] (3/3) Parsing new Usher manifest…");let a=I(s);if(null==a||0===a.size)return console.error("[TTV LOL PRO] Failed to parse new Usher manifest."),!1;console.log("[TTV LOL PRO] Replacement Video Weaver URLs:",Object.fromEntries(a)),r.replacementMap=a;let u=[...a.values()];return null!=e&&u.length>0&&t.sendMessageToContentScript({type:h.MessageType.UsherResponse,channel:(0,o.default)(e),videoWeaverUrls:u,proxyCountry:/USER-COUNTRY="([A-Z]+)"/i.exec(s)?.[1]||void 0}),!0}catch(t){return console.error("[TTV LOL PRO] Failed to get replacement Video Weaver URLs:",t),!1}}}),o("2Zov9",function(t,i){e(t.exports,"Parser",function(){return y});/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */var n=a("8apZ8"),s=a("aJbcR"),o=a("jtAad");class u extends n.default{constructor(){super(),this.buffer=""}push(t){let e;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)}}let f=function(t){let e=/([0-9.]*)?@?([0-9.]*)?/.exec(t||""),r={};return e[1]&&(r.length=parseInt(e[1],10)),e[2]&&(r.offset=parseInt(e[2],10)),r},l=function(t){let e;let r={};if(!t)return r;let i=t.split(RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n=i.length;for(;n--;)""!==i[n]&&((e=/([^=]*)=(.*)/.exec(i[n]).slice(1))[0]=e[0].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^\s+|\s+$/g,""),e[1]=e[1].replace(/^['"](.*)['"]$/g,"$1"),r[e[0]]=e[1]);return r},p=t=>{let e=t.split("x"),r={};return e[0]&&(r.width=parseInt(e[0],10)),e[1]&&(r.height=parseInt(e[1],10)),r};class h extends n.default{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(t){let e,i;if(0!==(t=t.trim()).length){if("#"!==t[0]){this.trigger("data",{type:"uri",uri:t});return}this.tagMappers.reduce((e,r)=>{let i=r(t);return i===t?e:e.concat([i])},[t]).forEach(t=>{for(let e=0;e<this.customParsers.length;e++)if(this.customParsers[e].call(this,t))return;if(0!==t.indexOf("#EXT")){this.trigger("data",{type:"comment",text:t.slice(1)});return}if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t)){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(e=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(t)){i={type:"tag",tagType:"inf"},e[1]&&(i.duration=parseFloat(e[1])),e[2]&&(i.title=e[2]),this.trigger("data",i);return}if(e=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(t)){i={type:"tag",tagType:"targetduration"},e[1]&&(i.duration=parseInt(e[1],10)),this.trigger("data",i);return}if(e=/^#EXT-X-VERSION:([0-9.]*)?/.exec(t)){i={type:"tag",tagType:"version"},e[1]&&(i.version=parseInt(e[1],10)),this.trigger("data",i);return}if(e=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(t)){i={type:"tag",tagType:"media-sequence"},e[1]&&(i.number=parseInt(e[1],10)),this.trigger("data",i);return}if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(t)){i={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(i.number=parseInt(e[1],10)),this.trigger("data",i);return}if(e=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(t)){i={type:"tag",tagType:"playlist-type"},e[1]&&(i.playlistType=e[1]),this.trigger("data",i);return}if(e=/^#EXT-X-BYTERANGE:(.*)?$/.exec(t)){i=/*@__PURE__*/r(s)(f(e[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(e=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(t)){i={type:"tag",tagType:"allow-cache"},e[1]&&(i.allowed=!/NO/.test(e[1])),this.trigger("data",i);return}if(e=/^#EXT-X-MAP:(.*)$/.exec(t)){if(i={type:"tag",tagType:"map"},e[1]){let t=l(e[1]);t.URI&&(i.uri=t.URI),t.BYTERANGE&&(i.byterange=f(t.BYTERANGE))}this.trigger("data",i);return}if(e=/^#EXT-X-STREAM-INF:(.*)$/.exec(t)){i={type:"tag",tagType:"stream-inf"},e[1]&&(i.attributes=l(e[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=p(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),this.trigger("data",i);return}if(e=/^#EXT-X-MEDIA:(.*)$/.exec(t)){i={type:"tag",tagType:"media"},e[1]&&(i.attributes=l(e[1])),this.trigger("data",i);return}if(e=/^#EXT-X-ENDLIST/.exec(t)){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(e=/^#EXT-X-DISCONTINUITY/.exec(t)){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(e=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(t)){i={type:"tag",tagType:"program-date-time"},e[1]&&(i.dateTimeString=e[1],i.dateTimeObject=new Date(e[1])),this.trigger("data",i);return}if(e=/^#EXT-X-KEY:(.*)$/.exec(t)){i={type:"tag",tagType:"key"},e[1]&&(i.attributes=l(e[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(e=/^#EXT-X-START:(.*)$/.exec(t)){i={type:"tag",tagType:"start"},e[1]&&(i.attributes=l(e[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(e=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(t)){i={type:"tag",tagType:"cue-out-cont"},e[1]?i.data=e[1]:i.data="",this.trigger("data",i);return}if(e=/^#EXT-X-CUE-OUT:(.*)?$/.exec(t)){i={type:"tag",tagType:"cue-out"},e[1]?i.data=e[1]:i.data="",this.trigger("data",i);return}if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t)){i={type:"tag",tagType:"cue-in"},e[1]?i.data=e[1]:i.data="",this.trigger("data",i);return}if((e=/^#EXT-X-SKIP:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"skip"}).attributes=l(e[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split("	")),this.trigger("data",i);return}if((e=/^#EXT-X-PART:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"part"}).attributes=l(e[1]),["DURATION"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))}),["INDEPENDENT","GAP"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/.test(i.attributes[t]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=f(i.attributes.BYTERANGE)),this.trigger("data",i);return}if((e=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"server-control"}).attributes=l(e[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/.test(i.attributes[t]))}),this.trigger("data",i);return}if((e=/^#EXT-X-PART-INF:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"part-inf"}).attributes=l(e[1]),["PART-TARGET"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))}),this.trigger("data",i);return}if((e=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"preload-hint"}).attributes=l(e[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(t){if(i.attributes.hasOwnProperty(t)){i.attributes[t]=parseInt(i.attributes[t],10);let e="BYTERANGE-LENGTH"===t?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[e]=i.attributes[t],delete i.attributes[t]}}),this.trigger("data",i);return}if((e=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"rendition-report"}).attributes=l(e[1]),["LAST-MSN","LAST-PART"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseInt(i.attributes[t],10))}),this.trigger("data",i);return}if((e=/^#EXT-X-DATERANGE:(.*)$/.exec(t))&&e[1]){(i={type:"tag",tagType:"daterange"}).attributes=l(e[1]),["ID","CLASS"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=String(i.attributes[t]))}),["START-DATE","END-DATE"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=new Date(i.attributes[t]))}),["DURATION","PLANNED-DURATION"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=parseFloat(i.attributes[t]))}),["END-ON-NEXT"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=/YES/i.test(i.attributes[t]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(t){i.attributes.hasOwnProperty(t)&&(i.attributes[t]=i.attributes[t].toString(16))});let t=/^X-([A-Z]+-)+[A-Z]+$/;for(let e in i.attributes){if(!t.test(e))continue;let r=/[0-9A-Fa-f]{6}/g.test(i.attributes[e]),n=/^\d+(\.\d+)?$/.test(i.attributes[e]);i.attributes[e]=r?i.attributes[e].toString(16):n?parseFloat(i.attributes[e]):String(i.attributes[e])}this.trigger("data",i);return}if(e=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(t)){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(e=/^#EXT-X-I-FRAMES-ONLY/.exec(t)){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(e=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(t)){(i={type:"tag",tagType:"content-steering"}).attributes=l(e[1]),this.trigger("data",i);return}if(e=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(t)){(i={type:"tag",tagType:"i-frame-playlist"}).attributes=l(e[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=p(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),this.trigger("data",i);return}if(e=/^#EXT-X-DEFINE:(.*)$/.exec(t)){(i={type:"tag",tagType:"define"}).attributes=l(e[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:t.slice(4)})})}}addParser({expression:t,customType:e,dataParser:r,segment:i}){"function"!=typeof r&&(r=t=>t),this.customParsers.push(n=>{if(t.exec(n))return this.trigger("data",{type:"custom",data:r(n),customType:e,segment:i}),!0})}addTagMapper({expression:t,map:e}){this.tagMappers.push(r=>t.test(r)?e(r):r)}}let g=t=>t.toLowerCase().replace(/-(\w)/g,t=>t[1].toUpperCase()),c=function(t){let e={};return Object.keys(t).forEach(function(r){e[g(r)]=t[r]}),e},d=function(t){let{serverControl:e,targetDuration:r,partTargetDuration:i}=t;if(!e)return;let n="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=r&&3*r,u=i&&2*i;r&&!e.hasOwnProperty(s)&&(e[s]=o,this.trigger("info",{message:`${n} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[s]<o&&(this.trigger("warn",{message:`${n} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${o})`}),e[s]=o),i&&!e.hasOwnProperty(a)&&(e[a]=3*i,this.trigger("info",{message:`${n} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),i&&e[a]<u&&(this.trigger("warn",{message:`${n} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${u}).`}),e[a]=u)};class y extends n.default{constructor(t={}){let e,i;super(),this.lineStream=new u,this.parseStream=new h,this.lineStream.pipe(this.parseStream),this.mainDefinitions=t.mainDefinitions||{},this.params=new URL(t.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;let n=this,a=[],f={},l=!1,p=function(){},g={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},y=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let m=0,T=0,b={};this.on("end",()=>{!f.uri&&(f.parts||f.preloadHints)&&(!f.map&&e&&(f.map=e),!f.key&&i&&(f.key=i),f.timeline||"number"!=typeof y||(f.timeline=y),this.manifest.preloadSegment=f)}),this.parseStream.on("data",function(t){let u,h;if(n.manifest.definitions){for(let e in n.manifest.definitions)if(t.uri&&(t.uri=t.uri.replace(`{$${e}}`,n.manifest.definitions[e])),t.attributes)for(let r in t.attributes)"string"==typeof t.attributes[r]&&(t.attributes[r]=t.attributes[r].replace(`{$${e}}`,n.manifest.definitions[e]))}({tag(){(({version(){t.version&&(this.manifest.version=t.version)},"allow-cache"(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){let e={};"length"in t&&(f.byterange=e,e.length=t.length,"offset"in t||(t.offset=m)),"offset"in t&&(f.byterange=e,e.offset=t.offset),m=e.offset+e.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.title&&(f.title=t.title),t.duration>0&&(f.duration=t.duration),0===t.duration&&(f.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key(){if(!t.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if("NONE"===t.attributes.METHOD){i=null;return}if(!t.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if("com.apple.streamingkeydelivery"===t.attributes.KEYFORMAT){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:t.attributes};return}if("com.microsoft.playready"===t.attributes.KEYFORMAT){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:t.attributes.URI};return}if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT){if(-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2))){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:(0,o.default)(t.attributes.URI.split(",")[1])};return}t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),i={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(i.iv=t.attributes.IV)},"media-sequence"(){if(!isFinite(t.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number});return}this.manifest.mediaSequence=t.number},"discontinuity-sequence"(){if(!isFinite(t.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number});return}this.manifest.discontinuitySequence=t.number,y=t.number},"playlist-type"(){if(!/VOD|EVENT/.test(t.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist});return}this.manifest.playlistType=t.playlistType},map(){e={},t.uri&&(e.uri=t.uri),t.byterange&&(e.byterange=t.byterange),i&&(e.key=i)},"stream-inf"(){if(this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||g,!t.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}f.attributes||(f.attributes={}),/*@__PURE__*/r(s)(f.attributes,t.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||g,!(t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}let e=this.manifest.mediaGroups[t.attributes.TYPE];e[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},u=e[t.attributes["GROUP-ID"]],(h={default:/yes/i.test(t.attributes.DEFAULT)}).default?h.autoselect=!0:h.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(h.language=t.attributes.LANGUAGE),t.attributes.URI&&(h.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(h.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(h.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(h.forced=/yes/i.test(t.attributes.FORCED)),u[t.attributes.NAME]=h},discontinuity(){y+=1,f.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),f.dateTimeString=t.dateTimeString,f.dateTimeObject=t.dateTimeObject;let{lastProgramDateTime:e}=this;this.lastProgramDateTime=new Date(t.dateTimeString).getTime(),null===e&&this.manifest.segments.reduceRight((t,e)=>(e.programDateTime=t-1e3*e.duration,e.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(t.duration)||t.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration});return}this.manifest.targetDuration=t.duration,d.call(this,this.manifest)},start(){if(!t.attributes||isNaN(t.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}},"cue-out"(){f.cueOut=t.data},"cue-out-cont"(){f.cueOutCont=t.data},"cue-in"(){f.cueIn=t.data},skip(){this.manifest.skip=c(t.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",t.attributes,["SKIPPED-SEGMENTS"])},part(){l=!0;let e=this.manifest.segments.length,r=c(t.attributes);f.parts=f.parts||[],f.parts.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=T),T=r.byterange.offset+r.byterange.length);let i=f.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${i} for segment #${e}`,t.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((t,e)=>{t.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${e} lacks required attribute(s): LAST-PART`})})},"server-control"(){let e=this.manifest.serverControl=c(t.attributes);e.hasOwnProperty("canBlockReload")||(e.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),d.call(this,this.manifest),e.canSkipDateranges&&!e.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){let e=this.manifest.segments.length,r=c(t.attributes),i=r.type&&"PART"===r.type;f.preloadHints=f.preloadHints||[],f.preloadHints.push(r),r.byterange&&!r.byterange.hasOwnProperty("offset")&&(r.byterange.offset=i?T:0,i&&(T=r.byterange.offset+r.byterange.length));let n=f.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${n} for segment #${e}`,t.attributes,["TYPE","URI"]),r.type)for(let t=0;t<f.preloadHints.length-1;t++){let i=f.preloadHints[t];i.type&&i.type===r.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${n} for segment #${e} has the same TYPE ${r.type} as preload hint #${t}`})}},"rendition-report"(){let e=c(t.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(e);let r=this.manifest.renditionReports.length-1,i=["LAST-MSN","URI"];l&&i.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${r}`,t.attributes,i)},"part-inf"(){this.manifest.partInf=c(t.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",t.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),d.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(c(t.attributes));let e=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${e}`,t.attributes,["ID","START-DATE"]);let i=this.manifest.dateRanges[e];i.endDate&&i.startDate&&new Date(i.endDate)<new Date(i.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),i.duration&&i.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),i.plannedDuration&&i.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});let n=!!i.endOnNext;if(n&&!i.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),n&&(i.duration||i.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),i.duration&&i.endDate){let t=i.startDate.getTime()+1e3*i.duration;this.manifest.dateRanges[e].endDate=new Date(t)}if(b[i.id]){for(let t in b[i.id])if(i[t]&&JSON.stringify(b[i.id][t])!==JSON.stringify(i[t])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}let t=this.manifest.dateRanges.findIndex(t=>t.id===i.id);this.manifest.dateRanges[t]=/*@__PURE__*/r(s)(this.manifest.dateRanges[t],i),b[i.id]=/*@__PURE__*/r(s)(b[i.id],i),this.manifest.dateRanges.pop()}else b[i.id]=i},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=c(t.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",t.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};let e=(t,e)=>{if(t in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${t}`});return}this.manifest.definitions[t]=e};if("QUERYPARAM"in t.attributes){if("NAME"in t.attributes||"IMPORT"in t.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}let r=this.params.get(t.attributes.QUERYPARAM);if(!r){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${t.attributes.QUERYPARAM}`});return}e(t.attributes.QUERYPARAM,decodeURIComponent(r));return}if("NAME"in t.attributes){if("IMPORT"in t.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in t.attributes)||"string"!=typeof t.attributes.VALUE){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${t.attributes.NAME}`});return}e(t.attributes.NAME,t.attributes.VALUE);return}if("IMPORT"in t.attributes){if(!this.mainDefinitions[t.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${t.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}e(t.attributes.IMPORT,this.mainDefinitions[t.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:t.attributes,uri:t.uri,timeline:y}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",t.attributes,["BANDWIDTH","URI"])}})[t.tagType]||p).call(n)},uri(){f.uri=t.uri,a.push(f),!this.manifest.targetDuration||"duration"in f||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),f.duration=this.manifest.targetDuration),i&&(f.key=i),f.timeline=y,e&&(f.map=e),T=0,null!==this.lastProgramDateTime&&(f.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*f.duration),f={}},comment(){},custom(){t.segment?(f.custom=f.custom||{},f.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(n)})}requiredCompatibilityversion(t,e){(t<e||!t)&&this.trigger("warn",{message:`manifest must be at least version ${e}`})}warnOnMissingAttributes_(t,e,r){let i=[];r.forEach(function(t){e.hasOwnProperty(t)||i.push(t)}),i.length&&this.trigger("warn",{message:`${t} lacks required attribute(s): ${i.join(", ")}`})}push(t){this.lineStream.push(t)}end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(t){this.parseStream.addParser(t)}addTagMapper(t){this.parseStream.addTagMapper(t)}}}),o("8apZ8",function(t,r){e(t.exports,"default",function(){return i});var i=/*#__PURE__*/function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.off=function(t,e){if(!this.listeners[t])return!1;var r=this.listeners[t].indexOf(e);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(r,1),r>-1},e.trigger=function(t){var e=this.listeners[t];if(e){if(2==arguments.length)for(var r=e.length,i=0;i<r;++i)e[i].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),s=e.length,a=0;a<s;++a)e[a].apply(this,n)}},e.dispose=function(){this.listeners={}},e.pipe=function(t){this.on("data",function(e){t.push(e)})},t}()}),o("aJbcR",function(t,e){function r(){return t.exports=r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)({}).hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,r.apply(null,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports}),o("jtAad",function(t,i){e(t.exports,"default",function(){return o});var n=a("lN2No"),s=a("fEIB3").Buffer;function o(t){for(var e=/*@__PURE__*/r(n).atob?/*@__PURE__*/r(n).atob(t):s.from(t,"base64").toString("binary"),i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);return i}}),o("lN2No",function(t,e){var r;"undefined"!=typeof window?r=window:void 0!==i?r=i:"undefined"!=typeof self?r=self:r={},t.exports=r}),o("fEIB3",function(t,r){e(t.exports,"Buffer",function(){return i},function(t){return i=t}),e(t.exports,"INSPECT_MAX_BYTES",function(){return n},function(t){return n=t});var i,n,s=a("6J5A7"),o=a("eC0iN");let u="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function f(t){if(t>0x7fffffff)throw RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,r){if("number"==typeof t){if("string"==typeof e)throw TypeError('The "string" argument must be of type string. Received type number');return g(t)}return p(t,e,r)}function p(t,e,r){if("string"==typeof t)return function(t,e){if(("string"!=typeof e||""===e)&&(e="utf8"),!l.isEncoding(e))throw TypeError("Unknown encoding: "+e);let r=0|m(t,e),i=f(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}(t,e);if(ArrayBuffer.isView(t))return function(t){if(F(t,Uint8Array)){let e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(F(t,ArrayBuffer)||t&&F(t.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(F(t,SharedArrayBuffer)||t&&F(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw TypeError('The "value" argument must not be of type number. Received type number');let i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return l.from(i,e,r);let n=function(t){var e;if(l.isBuffer(t)){let e=0|y(t.length),r=f(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||(e=t.length)!=e?f(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw TypeError('"size" argument must be of type number');if(t<0)throw RangeError('The value "'+t+'" is invalid for option "size"')}function g(t){return h(t),f(t<0?0:0|y(t))}function c(t){let e=t.length<0?0:0|y(t.length),r=f(e);for(let i=0;i<e;i+=1)r[i]=255&t[i];return r}function d(t,e,r){let i;if(e<0||t.byteLength<e)throw RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),l.prototype),i}function y(t){if(t>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||F(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return k(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(t).length;default:if(n)return i?-1:k(t).length;e=(""+e).toLowerCase(),n=!0}}function T(t,e,r){let i=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,r){let i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=e;i<r;++i)n+=V[t[i]];return n}(this,e,r);case"utf8":case"utf-8":return w(this,e,r);case"ascii":return function(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}(this,e,r);case"latin1":case"binary":return function(t,e,r){let i="";r=Math.min(t.length,r);for(let n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}(this,e,r);case"base64":var n,a;return n=e,a=r,0===n&&a===this.length?s.fromByteArray(this):s.fromByteArray(this.slice(n,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){let i=t.slice(e,r),n="";for(let t=0;t<i.length-1;t+=2)n+=String.fromCharCode(i[t]+256*i[t+1]);return n}(this,e,r);default:if(i)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function b(t,e,r){let i=t[e];t[e]=t[r],t[r]=i}function E(t,e,r,i,n){var s;if(0===t.length)return -1;if("string"==typeof r?(i=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(s=r=+r)!=s&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return -1;r=t.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:R(t,e,r,i,n);if("number"==typeof e)return(e&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):R(t,[e],r,i,n);throw TypeError("val must be string, number or Buffer")}function R(t,e,r,i,n){let s,a=1,o=t.length,u=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return -1;a=2,o/=2,u/=2,r/=2}function f(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(n){let i=-1;for(s=r;s<o;s++)if(f(t,s)===f(e,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===u)return i*a}else -1!==i&&(s-=s-i),i=-1}else for(r+u>o&&(r=o-u),s=r;s>=0;s--){let r=!0;for(let i=0;i<u;i++)if(f(t,s+i)!==f(e,i)){r=!1;break}if(r)return s}return -1}function w(t,e,r){r=Math.min(t.length,r);let i=[],n=e;for(;n<r;){let e=t[n],s=null,a=e>239?4:e>223?3:e>191?2:1;if(n+a<=r){let r,i,o,u;switch(a){case 1:e<128&&(s=e);break;case 2:(192&(r=t[n+1]))==128&&(u=(31&e)<<6|63&r)>127&&(s=u);break;case 3:r=t[n+1],i=t[n+2],(192&r)==128&&(192&i)==128&&(u=(15&e)<<12|(63&r)<<6|63&i)>2047&&(u<55296||u>57343)&&(s=u);break;case 4:r=t[n+1],i=t[n+2],o=t[n+3],(192&r)==128&&(192&i)==128&&(192&o)==128&&(u=(15&e)<<18|(63&r)<<12|(63&i)<<6|63&o)>65535&&u<1114112&&(s=u)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),n+=a}return function(t){let e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);let r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=4096));return r}(i)}function A(t,e,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>r)throw RangeError("Trying to access beyond buffer length")}function P(t,e,r,i,n,s){if(!l.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw RangeError('"value" argument is out of bounds');if(r+i>t.length)throw RangeError("Index out of range")}function O(t,e,r,i,n){D(e,i,n,t,r,7);let s=Number(e&BigInt(0xffffffff));t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s;let a=Number(e>>BigInt(32)&BigInt(0xffffffff));return t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,r}function I(t,e,r,i,n){D(e,i,n,t,r,7);let s=Number(e&BigInt(0xffffffff));t[r+7]=s,s>>=8,t[r+6]=s,s>>=8,t[r+5]=s,s>>=8,t[r+4]=s;let a=Number(e>>BigInt(32)&BigInt(0xffffffff));return t[r+3]=a,a>>=8,t[r+2]=a,a>>=8,t[r+1]=a,a>>=8,t[r]=a,r+8}function S(t,e,r,i,n,s){if(r+i>t.length||r<0)throw RangeError("Index out of range")}function v(t,e,r,i,n){return e=+e,r>>>=0,n||S(t,e,r,4,34028234663852886e22,-34028234663852886e22),o.write(t,e,r,i,23,4),r+4}function L(t,e,r,i,n){return e=+e,r>>>=0,n||S(t,e,r,8,17976931348623157e292,-17976931348623157e292),o.write(t,e,r,i,52,8),r+8}i=l,n=50,l.TYPED_ARRAY_SUPPORT=function(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,r){return p(t,e,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,r){return(h(t),t<=0)?f(t):void 0!==e?"string"==typeof r?f(t).fill(e,r):f(t).fill(e):f(t)},l.allocUnsafe=function(t){return g(t)},l.allocUnsafeSlow=function(t){return g(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(F(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),F(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,i=e.length;for(let n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){let r;if(!Array.isArray(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);if(void 0===e)for(r=0,e=0;r<t.length;++r)e+=t[r].length;let i=l.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){let e=t[r];if(F(e,Uint8Array))n+e.length>i.length?(l.isBuffer(e)||(e=l.from(e)),e.copy(i,n)):Uint8Array.prototype.set.call(i,e,n);else if(l.isBuffer(e))e.copy(i,n);else throw TypeError('"list" argument must be an Array of Buffers');n+=e.length}return i},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){let t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)b(this,e,e+1);return this},l.prototype.swap32=function(){let t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},l.prototype.swap64=function(){let t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},l.prototype.toString=function(){let t=this.length;return 0===t?"":0==arguments.length?w(this,0,t):T.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){let t="",e=n;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},u&&(l.prototype[u]=l.prototype.inspect),l.prototype.compare=function(t,e,r,i,n){if(F(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return -1;if(e>=r)return 1;if(e>>>=0,r>>>=0,i>>>=0,n>>>=0,this===t)return 0;let s=n-i,a=r-e,o=Math.min(s,a),u=this.slice(i,n),f=t.slice(e,r);for(let t=0;t<o;++t)if(u[t]!==f[t]){s=u[t],a=f[t];break}return s<a?-1:a<s?1:0},l.prototype.includes=function(t,e,r){return -1!==this.indexOf(t,e,r)},l.prototype.indexOf=function(t,e,r){return E(this,t,e,r,!0)},l.prototype.lastIndexOf=function(t,e,r){return E(this,t,e,r,!1)},l.prototype.write=function(t,e,r,i){var n,s,a,o,u,f,l,p;if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else if(isFinite(e))e>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let h=this.length-e;if((void 0===r||r>h)&&(r=h),t.length>0&&(r<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let g=!1;for(;;)switch(i){case"hex":return function(t,e,r,i){let n;r=Number(r)||0;let s=t.length-r;i?(i=Number(i))>s&&(i=s):i=s;let a=e.length;for(i>a/2&&(i=a/2),n=0;n<i;++n){let i=parseInt(e.substr(2*n,2),16);if(i!=i)break;t[r+n]=i}return n}(this,t,e,r);case"utf8":case"utf-8":return n=e,s=r,$(k(t,this.length-n),this,n,s);case"ascii":case"latin1":case"binary":return a=e,o=r,$(function(t){let e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(t),this,a,o);case"base64":return u=e,f=r,$(X(t),this,u,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return l=e,p=r,$(function(t,e){let r,i;let n=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)i=(r=t.charCodeAt(s))>>8,n.push(r%256),n.push(i);return n}(t,this.length-l),this,l,p);default:if(g)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),g=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(t,e){let r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);let i=this.subarray(t,e);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);let i=this[t],n=1,s=0;for(;++s<e&&(n*=256);)i+=this[t+s]*n;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);let i=this[t+--e],n=1;for(;e>0&&(n*=256);)i+=this[t+--e]*n;return i},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||A(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+0x1000000*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),0x1000000*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=G(function(t){U(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&C(t,this.length-8);let i=e+256*this[++t]+65536*this[++t]+0x1000000*this[++t],n=this[++t]+256*this[++t]+65536*this[++t]+0x1000000*r;return BigInt(i)+(BigInt(n)<<BigInt(32))}),l.prototype.readBigUInt64BE=G(function(t){U(t>>>=0,"offset");let e=this[t],r=this[t+7];(void 0===e||void 0===r)&&C(t,this.length-8);let i=0x1000000*e+65536*this[++t]+256*this[++t]+this[++t],n=0x1000000*this[++t]+65536*this[++t]+256*this[++t]+r;return(BigInt(i)<<BigInt(32))+BigInt(n)}),l.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);let i=this[t],n=1,s=0;for(;++s<e&&(n*=256);)i+=this[t+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||A(t,e,this.length);let i=e,n=1,s=this[t+--i];for(;i>0&&(n*=256);)s+=this[t+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},l.prototype.readInt8=function(t,e){return(t>>>=0,e||A(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||A(t,2,this.length);let r=this[t]|this[t+1]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt16BE=function(t,e){t>>>=0,e||A(t,2,this.length);let r=this[t+1]|this[t]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=G(function(t){U(t>>>=0,"offset");let e=this[t],r=this[t+7];return(void 0===e||void 0===r)&&C(t,this.length-8),(BigInt(this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24))<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+0x1000000*this[++t])}),l.prototype.readBigInt64BE=G(function(t){U(t>>>=0,"offset");let e=this[t],r=this[t+7];return(void 0===e||void 0===r)&&C(t,this.length-8),(BigInt((e<<24)+65536*this[++t]+256*this[++t]+this[++t])<<BigInt(32))+BigInt(0x1000000*this[++t]+65536*this[++t]+256*this[++t]+r)}),l.prototype.readFloatLE=function(t,e){return t>>>=0,e||A(t,4,this.length),o.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||A(t,4,this.length),o.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||A(t,8,this.length),o.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||A(t,8,this.length),o.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;P(this,t,e,r,i,0)}let n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n&255;return e+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;P(this,t,e,r,i,0)}let n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s&255;return e+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,0xffffffff,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,0xffffffff,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigUInt64LE=G(function(t,e=0){return O(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=G(function(t,e=0){return I(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e>>>=0,!i){let i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}let n=0,s=1,a=0;for(this[e]=255&t;++n<r&&(s*=256);)t<0&&0===a&&0!==this[e+n-1]&&(a=1),this[e+n]=(t/s>>0)-a&255;return e+r},l.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e>>>=0,!i){let i=Math.pow(2,8*r-1);P(this,t,e,r,i-1,-i)}let n=r-1,s=1,a=0;for(this[e+n]=255&t;--n>=0&&(s*=256);)t<0&&0===a&&0!==this[e+n+1]&&(a=1),this[e+n]=(t/s>>0)-a&255;return e+r},l.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,0x7fffffff,-0x80000000),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||P(this,t,e,4,0x7fffffff,-0x80000000),t<0&&(t=0xffffffff+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigInt64LE=G(function(t,e=0){return O(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=G(function(t,e=0){return I(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeFloatLE=function(t,e,r){return v(this,t,e,!0,r)},l.prototype.writeFloatBE=function(t,e,r){return v(this,t,e,!1,r)},l.prototype.writeDoubleLE=function(t,e,r){return L(this,t,e,!0,r)},l.prototype.writeDoubleBE=function(t,e,r){return L(this,t,e,!1,r)},l.prototype.copy=function(t,e,r,i){if(!l.isBuffer(t))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);let n=i-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,i):Uint8Array.prototype.set.call(t,this.subarray(r,i),e),n},l.prototype.fill=function(t,e,r,i){let n;if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===t.length){let e=t.charCodeAt(0);("utf8"===i&&e<128||"latin1"===i)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(n=e;n<r;++n)this[n]=t;else{let s=l.isBuffer(t)?t:l.from(t,i),a=s.length;if(0===a)throw TypeError('The value "'+t+'" is invalid for argument "value"');for(n=0;n<r-e;++n)this[n+e]=s[n%a]}return this};let M={};function x(t,e,r){M[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function N(t){let e="",r=t.length,i="-"===t[0]?1:0;for(;r>=i+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function D(t,e,r,i,n,s){if(t>r||t<e){let i;let n="bigint"==typeof e?"n":"";throw i=s>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${(s+1)*8}${n}`:`>= -(2${n} ** ${(s+1)*8-1}${n}) and < 2 ** ${(s+1)*8-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new M.ERR_OUT_OF_RANGE("value",i,t)}U(n,"offset"),(void 0===i[n]||void 0===i[n+s])&&C(n,i.length-(s+1))}function U(t,e){if("number"!=typeof t)throw new M.ERR_INVALID_ARG_TYPE(e,"number",t)}function C(t,e,r){if(Math.floor(t)!==t)throw U(t,r),new M.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}x("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),x("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError),x("ERR_OUT_OF_RANGE",function(t,e,r){let i=`The value of "${t}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>0x100000000?n=N(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=N(n)),n+="n"),i+=` It must be ${e}. Received ${n}`},RangeError);let B=/[^+/0-9A-Za-z-_]/g;function k(t,e){let r;e=e||1/0;let i=t.length,n=null,s=[];for(let a=0;a<i;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!n){if(r>56319||a+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function X(t){return s.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,r,i){let n;for(n=0;n<i&&!(n+r>=e.length)&&!(n>=t.length);++n)e[n+r]=t[n];return n}function F(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}let V=function(){let t="0123456789abcdef",e=Array(256);for(let r=0;r<16;++r){let i=16*r;for(let n=0;n<16;++n)e[i+n]=t[r]+t[n]}return e}();function G(t){return"undefined"==typeof BigInt?q:t}function q(){throw Error("BigInt not supported")}}),o("6J5A7",function(t,r){e(t.exports,"toByteArray",function(){return i},function(t){return i=t}),e(t.exports,"fromByteArray",function(){return n},function(t){return n=t}),i=function(t){var e,r,i=function(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var i=r===e?0:4-r%4;return[r,i]}(t),n=i[0],s=i[1],u=new o((n+s)*3/4-s),f=0,l=s>0?n-4:n;for(r=0;r<l;r+=4)e=a[t.charCodeAt(r)]<<18|a[t.charCodeAt(r+1)]<<12|a[t.charCodeAt(r+2)]<<6|a[t.charCodeAt(r+3)],u[f++]=e>>16&255,u[f++]=e>>8&255,u[f++]=255&e;return 2===s&&(e=a[t.charCodeAt(r)]<<2|a[t.charCodeAt(r+1)]>>4,u[f++]=255&e),1===s&&(e=a[t.charCodeAt(r)]<<10|a[t.charCodeAt(r+1)]<<4|a[t.charCodeAt(r+2)]>>2,u[f++]=e>>8&255,u[f++]=255&e),u},n=function(t){for(var e,r=t.length,i=r%3,n=[],a=0,o=r-i;a<o;a+=16383)n.push(function(t,e,r){for(var i,n=[],a=e;a<r;a+=3)n.push(s[(i=(t[a]<<16&0xff0000)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+s[i>>12&63]+s[i>>6&63]+s[63&i]);return n.join("")}(t,a,a+16383>o?o:a+16383));return 1===i?n.push(s[(e=t[r-1])>>2]+s[e<<4&63]+"=="):2===i&&n.push(s[(e=(t[r-2]<<8)+t[r-1])>>10]+s[e>>4&63]+s[e<<2&63]+"="),n.join("")};for(var i,n,s=[],a=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,l=u.length;f<l;++f)s[f]=u[f],a[u.charCodeAt(f)]=f;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63}),o("eC0iN",function(t,r){var i,n;e(t.exports,"read",function(){return i},function(t){return i=t}),e(t.exports,"write",function(){return n},function(t){return n=t}),i=function(t,e,r,i,n){var s,a,o=8*n-i-1,u=(1<<o)-1,f=u>>1,l=-7,p=r?n-1:0,h=r?-1:1,g=t[e+p];for(p+=h,s=g&(1<<-l)-1,g>>=-l,l+=o;l>0;s=256*s+t[e+p],p+=h,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=i;l>0;a=256*a+t[e+p],p+=h,l-=8);if(0===s)s=1-f;else{if(s===u)return a?NaN:1/0*(g?-1:1);a+=Math.pow(2,i),s-=f}return(g?-1:1)*a*Math.pow(2,s-i)},n=function(t,e,r,i,n,s){var a,o,u,f=8*s-n-1,l=(1<<f)-1,p=l>>1,h=23===n?5960464477539062e-23:0,g=i?0:s-1,c=i?1:-1,d=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(o=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+p>=1?e+=h/u:e+=h*Math.pow(2,1-p),e*u>=2&&(a++,u/=2),a+p>=l?(o=0,a=l):a+p>=1?(o=(e*u-1)*Math.pow(2,n),a+=p):(o=e*Math.pow(2,p-1)*Math.pow(2,n),a=0));n>=8;t[r+g]=255&o,g+=c,o/=256,n-=8);for(a=a<<n|o,f+=n;f>0;t[r+g]=255&a,g+=c,a/=256,f-=8);t[r+g-c]|=128*d}}),o("3PO1e",function(t,r){e(t.exports,"default",function(){return i});var i="TTV-LOL-PRO"}),o("lW4ZV",function(t,r){e(t.exports,"default",function(){return n});var i=a("53Td5");function n(t){if(!t)return null;let e=(0,i.twitchChannelNameRegex).exec(t);if(!e)return null;let[,r]=e;return r.toLowerCase()}}),o("53Td5",function(t,r){e(t.exports,"passportHostRegex",function(){return i}),e(t.exports,"twitchApiChannelNameRegex",function(){return n}),e(t.exports,"twitchChannelNameRegex",function(){return s}),e(t.exports,"twitchGqlHostRegex",function(){return a}),e(t.exports,"twitchTvHostRegex",function(){return o}),e(t.exports,"usherHostRegex",function(){return u}),e(t.exports,"videoWeaverHostRegex",function(){return f});let i=/^passport\.twitch\.tv$/i,n=/\/hls\/(.+)\.m3u8/i,s=/^https?:\/\/(?:www|m)\.twitch\.tv\/(?:videos\/|popout\/|moderator\/)?((?!(?:directory|jobs|p|privacy|store|turbo)\b)\w+)/i,a=/^gql\.twitch\.tv$/i,o=/^(?:www|m)\.twitch\.tv$/i,u=/^usher\.ttvnw\.net$/i,f=/^(?:[a-z0-9-]+\.playlist\.(?:live-video|ttvnw)\.net|video-weaver\.[a-z0-9-]+\.hls\.ttvnw\.net)$/i}),o("e4GnD",function(t,r){e(t.exports,"default",function(){return n});var i=a("53Td5");function n(t){let e=(0,i.twitchApiChannelNameRegex).exec(t);if(!e)return null;let[,r]=e;return r}}),o("kEZlj",function(t,r){e(t.exports,"default",function(){return i});function i(t){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let i=0;i<t;i++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}}),o("21qmY",function(t,r){e(t.exports,"default",function(){return i});function i(t){try{return new URL(t).host}catch{return null}}}),o("8kXXm",function(t,r){e(t.exports,"default",function(){return n});var i=a("1U3jF");function n(t,e){return t===i.ProxyRequestType.Passport?e.isChromium&&!e.optimizedProxiesEnabled?e.passportLevel>=0:e.passportLevel>=1:t===i.ProxyRequestType.Usher?(!e.optimizedProxiesEnabled||(!e.isChromium||!1!==e.fullModeEnabled)&&(!!e.isChromium||!1!==e.isFlagged))&&e.passportLevel>=0:t===i.ProxyRequestType.VideoWeaver?!e.optimizedProxiesEnabled||(!e.isChromium||!1!==e.fullModeEnabled)&&(!!e.isChromium||!1!==e.isFlagged):t===i.ProxyRequestType.GraphQLToken?e.isChromium?e.passportLevel>=1:e.passportLevel>=0:t===i.ProxyRequestType.GraphQLIntegrity?e.optimizedProxiesEnabled?e.passportLevel>=2:e.passportLevel>=1:t===i.ProxyRequestType.GraphQL?!!e.isChromium&&!e.optimizedProxiesEnabled&&e.passportLevel>=1||!e.isChromium&&!e.optimizedProxiesEnabled&&e.passportLevel>=2||(!e.isChromium||!1!==e.fullModeEnabled)&&(!!e.isChromium||!1!==e.isFlagged)&&(e.isChromium?e.passportLevel>=1:e.passportLevel>=0):t===i.ProxyRequestType.TwitchWebpage&&e.passportLevel>=2}}),o("5zqbW",function(t,r){e(t.exports,"getSendMessageToContentScript",function(){return o}),e(t.exports,"getSendMessageToContentScriptAndWaitForResponse",function(){return u}),e(t.exports,"getSendMessageToPageScript",function(){return f}),e(t.exports,"getSendMessageToPageScriptAndWaitForResponse",function(){return l}),e(t.exports,"getSendMessageToWorkerScripts",function(){return p}),e(t.exports,"getSendMessageToWorkerScriptsAndWaitForResponse",function(){return h});var i=a("1U3jF");function n(t,e,r){t&&t.postMessage({type:e,message:r})}async function s(t,e,r,i,s,a){return new Promise((o,u)=>{if(!t){console.warn("[TTV LOL PRO] Recipient is undefined."),o(void 0);return}let f=t=>{if(t.data?.type!==i)return;let e=t.data?.message;e&&e.type===s&&(self.removeEventListener("message",f),o(e))};self.addEventListener("message",f),n(t,e,r),setTimeout(()=>{self.removeEventListener("message",f),u(Error("Timed out waiting for message response."))},a)})}function o(){return t=>n(self,i.MessageType.ContentScriptMessage,t)}function u(){return async(t,e,r,n=5e3)=>s(self,i.MessageType.ContentScriptMessage,e,"page"===t?i.MessageType.PageScriptMessage:i.MessageType.WorkerScriptMessage,r,n)}function f(){return t=>n(self,i.MessageType.PageScriptMessage,t)}function l(){return async(t,e,r,n=5e3)=>s(self,i.MessageType.PageScriptMessage,e,"page"===t?i.MessageType.PageScriptMessage:i.MessageType.WorkerScriptMessage,r,n)}function p(){return(t,e)=>t.forEach(t=>n(t,i.MessageType.WorkerScriptMessage,e))}function h(){return async(t,e,r,n,a=5e3)=>Promise.any(t.map(t=>s(t,i.MessageType.WorkerScriptMessage,e,"page"===n?i.MessageType.PageScriptMessage:i.MessageType.WorkerScriptMessage,r,a)))}});var u=a("1U3jF"),f=a("kuQgE"),l=a("5zqbW");console.info("[TTV LOL PRO] Worker script running.");try{t=JSON.parse(getParams())}catch(t){console.error("[TTV LOL PRO] Failed to parse params:",t)}getParams=void 0;let p=(0,l.getSendMessageToContentScript)(),h=(0,l.getSendMessageToContentScriptAndWaitForResponse)(),g=(0,l.getSendMessageToPageScript)(),c=(0,l.getSendMessageToPageScriptAndWaitForResponse)(),d=(0,l.getSendMessageToWorkerScripts)(),y=(0,l.getSendMessageToWorkerScriptsAndWaitForResponse)(),m={isChromium:t.isChromium,scope:"worker",state:void 0,twitchWorkers:[],sendMessageToContentScript:p,sendMessageToContentScriptAndWaitForResponse:h,sendMessageToPageScript:g,sendMessageToPageScriptAndWaitForResponse:c,sendMessageToWorkerScripts:d,sendMessageToWorkerScriptsAndWaitForResponse:y};self.fetch=(0,f.getFetch)(m),self.addEventListener("message",t=>{if(t.data?.type!==u.MessageType.WorkerScriptMessage)return;let e=t.data?.message;if(e&&e.type===u.MessageType.GetStoreStateResponse){null==m.state?console.log("[TTV LOL PRO] Received store state from page script."):console.debug("[TTV LOL PRO] Received store state from page script.");let t=e.state;m.state=t}}),g({type:u.MessageType.GetStoreState})}();