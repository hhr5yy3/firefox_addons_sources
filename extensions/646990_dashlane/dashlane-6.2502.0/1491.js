"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[1491],{52204:(e,a,t)=>{t.r(a),t.d(a,{PaymentCardAddPanel:()=>x});var n,i=t(96832),l=t(48062),d=t(14900),r=t(78346),o=t(8180),_=t(25792),c=t(53214),p=t(39431),m=t(86498),s=t(88203),u=t(45272),y=t(92077),b=t(76376),h=t(77063),C=t(19122),w=t(12271),g=t(63520),f=t(61468),v=t(68593);const N="_common_generic_error",x=()=>{const[e,a]=(0,i.useState)(!1),[t,x]=(0,i.useState)(!1),{translate:S}=(0,s.Z)(),{routes:Z}=(0,b.Xo)(),{showAlert:I}=(0,m.V)(),{createVaultItem:V}=(0,o.u)(_.L),{currentSpaceId:k}=(0,C.fV)(),[R,B]=(0,i.useState)(),[E,X]=(0,i.useState)({itemName:"",cardNumber:"",ownerName:"",securityCode:"",expireMonth:"",expireYear:"",color:c.X.Blue1,spaceId:null!=k?k:"",note:""}),{openDialog:O,shouldShowFrozenStateDialog:P}=(0,h.Ub)();(0,i.useEffect)((()=>{(0,u.Nc)(l.PageView.ItemCreditCardCreate)}),[]),(0,i.useEffect)((()=>{P&&O()}),[P]);const L=()=>{(0,u.Nc)(l.PageView.ItemPaymentList),(0,y.uX)(Z.userPayments)};return(0,v.tZ)(g.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:e,onNavigateOut:L,submitPending:t,onSubmit:async()=>{if(t)return;const e=(0,w.u)(E);if(!e.isValid)return B(e.errorSet);x(!0);try{const e=await V({vaultItemType:p.U.PaymentCard,content:E});(0,r.d6)(e)?(I(E.itemName?S("webapp_payment_edition_name_save_alert",{paymentCard:E.itemName}):S("webapp_payment_edition_generic_save_alert"),d.BLW.SUCCESS),L()):(I(S(N),d.BLW.ERROR),x(!1))}catch(e){I(S(N),d.BLW.ERROR),x(!1)}},formId:"add_paymentcard_panel",header:(0,v.tZ)(g.V9,{icon:n||(n=(0,v.tZ)(f.AK,{type:"payment-card",size:"xlarge"})),title:S("webapp_payment_edition_header_add_payment_card")}),children:(0,v.tZ)(w.gd,{paymentCardContent:E,onValueChanged:e=>{X((a=>({...a,...e}))),a(!0)},errors:R})})}},12271:(e,a,t)=>{t.d(a,{gd:()=>k,u:()=>R});var n=t(96832),i=t(53214),l=t(48062),d=t(61468),r=t(88203),o=t(45272),_=t(77063),c=t(82207),p=t(30894),m=t(68819),s=t(67406),u=t(68037),y=t(7973),b=t(711),h=t(68593);const C=(([e,a],t="ASC")=>{const n=(new Date).getFullYear()+e,i=Math.abs(a-e)+1,l=new Array(i).fill(null).map(((e,a)=>({label:(n+a).toString(),value:n+a})));return"ASC"===t?l:l.sort((({value:e},{value:a})=>a-e))})([0,30],"ASC"),w=e=>(0,y.Z)((0,b.Z)(new Date,e),"MM"),g=new Array(12).fill(null).map(((e,a)=>w(a))).map((e=>(0,h.tZ)(d.$m,{value:e,children:e},e))),f=C.map((e=>(0,h.tZ)(d.$m,{value:JSON.stringify(e.value),children:e.label},e.value))),v=({month:e,year:a,disabled:t,onYearChange:n,onMonthChange:i})=>{const{translate:l}=(0,r.Z)();return(0,h.BX)(d.kC,{gap:"8px",children:[(0,h.tZ)(d.mg,{"data-name":"card-expiration-month",label:l("webapp_field_expiry_date_month"),value:w(Number(e)-1),onChange:e=>{i(e)},readOnly:t,sx:{flex:1},children:g}),(0,h.tZ)(d.mg,{"data-name":"card-expiration-year",label:l("webapp_field_expiry_date_year"),value:a,onChange:e=>{n(e)},readOnly:t,sx:{flex:1},children:f})]})};var N=t(79432);const x="webapp_payment_edition_field_card_action_show_note",S="webapp_payment_edition_field_card_action_hide_note",Z="webapp_payment_edition_field_cardColor_",I=e=>a=>{a&&(0,o.Kz)(new l.UserCopyVaultItemFieldEvent({itemType:l.ItemType.CreditCard,field:e,itemId:a,isProtected:!0}))},V={[i.X.Black]:`${Z}BLACK`,[i.X.Blue1]:`${Z}BLUE_1`,[i.X.Blue2]:`${Z}BLUE_2`,[i.X.Gold]:`${Z}GOLD`,[i.X.Green1]:`${Z}GREEN_1`,[i.X.Green2]:`${Z}GREEN_2`,[i.X.Orange]:`${Z}ORANGE`,[i.X.Red]:`${Z}RED`,[i.X.Silver]:`${Z}SILVER`,[i.X.White]:`${Z}WHITE`},k=({itemId:e,errors:a,paymentCardContent:t,onValueChanged:y,showCopyAlert:b,variant:C})=>{const{cardNumber:w,color:g,expireMonth:f,expireYear:Z,itemName:k,note:R,ownerName:B,securityCode:E="",spaceId:X}=t,{translate:O}=(0,r.Z)(),{shouldShowFrozenStateDialog:P}=(0,_.Ub)(),{logRevealCreditCardField:L,logCopiedCreditCardField:$}=(0,N.D)(),A=Boolean(w.length),D=Boolean(E.length),F=Boolean(R.length),U=Boolean(X),M=(0,n.useCallback)((e=>a=>{const t="string"==typeof a?a:a.target.value,n="cardNumber"===e?t.replaceAll(" ",""):t;y({[e]:n})}),[y]),{areProtectedItemsUnlocked:z,openProtectedItemsUnlocker:T}=(0,p.tY)(),[G,Y]=(0,n.useState)(!A),q=(0,n.useCallback)((a=>{e&&(0,o.Kz)(new l.UserRevealVaultItemFieldEvent({field:a,isProtected:!0,itemId:e,itemType:l.ItemType.CreditCard}))}),[e]),K=(0,n.useCallback)(((e,a)=>new Promise(((t,n)=>{if(e||z)return a(),t();T({action:m.P.Show,itemType:m.R.CreditCard,successCallback:()=>(a(),t()),cancelCallback:n})}))),[z,T]),W=(0,n.useCallback)((()=>{G||(q(l.Field.CardNumber),U&&L({field:"number",name:k})),Y((e=>!e))}),[G,q,U,L,k]),H=!z,j=(a,t)=>{a(e),b&&b(O(t))},[J,Q]=(0,n.useState)(""===E),[ee,ae]=(0,n.useState)(""===R),te=(0,n.useCallback)((()=>{J||(q(l.Field.SecurityCode),U&&L({field:"cvv",name:k})),Q((e=>!e))}),[J,q,U,L,k]),ne=()=>ae((e=>!e)),ie=Object.values(i.X).map((e=>({label:O(V[e]),value:e}))),le=A?G?w:"●●●● ●●●● ●●●● ●●●●":"";return(0,h.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,h.BX)(u.u,{title:O("webapp_payment_edition_content_card_details_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,h.tZ)(d.qo,{"data-name":"ownerName",value:B,label:O("webapp_payment_edition_field_ownerName"),placeholder:O("webapp_payment_edition_field_placeholder_no_ownerName"),onChange:M("ownerName"),disabled:!!P}),(0,h.tZ)(d.Nc,{"data-name":"cardNumber",required:!0,formatter:G?"card":void 0,label:O("webapp_payment_edition_field_cardNumber"),placeholder:O("webapp_payment_edition_field_placeholder_no_cardNumber"),isValueInitiallyVisible:G,toggleVisibilityLabel:{hide:O("webapp_payment_edition_field_card_action_hide_card_number"),show:O("webapp_payment_edition_field_card_action_show_card_number")},onValueVisibilityChangeRequest:()=>K(G,W),onCopy:e=>{e.preventDefault(),navigator.clipboard.writeText(le),U&&$({field:"number",name:k})},readOnly:!G&&A||!!P,value:le,actions:"edit"===C?[(0,h.tZ)(c.m,{data:w,checkProtected:()=>H,copyLabel:O("webapp_payment_edition_field_card_action_copy_card_number"),onCopy:()=>{j(I(l.Field.CardNumber),"webapp_payment_edition_field_cardNumber_copied"),U&&$({field:"number",name:k})}},"copy-card-number")]:void 0,onChange:M("cardNumber"),error:a?.has("cardNumber")},`cardNumber${G}`),(0,h.tZ)(d.Nc,{readOnly:!J&&D||!!P,value:J?E:"●●●",label:O("webapp_payment_edition_field_securityCode"),placeholder:O("webapp_payment_edition_field_placeholder_no_securityCode"),onValueVisibilityChangeRequest:()=>K(J,te),isValueInitiallyVisible:J,toggleVisibilityLabel:{hide:O("webapp_payment_edition_field_card_action_hide_security_code"),show:O("webapp_payment_edition_field_card_action_show_security_code")},actions:"edit"===C?[(0,h.tZ)(c.m,{checkProtected:()=>H,data:E,copyLabel:O("webapp_payment_edition_field_card_action_copy_security_code"),onCopy:()=>{j(I(l.Field.CardNumber),"webapp_payment_edition_field_securityCode_copied"),U&&$({field:"cvv",name:k})}},"copy-security-code")]:void 0,onChange:M("securityCode"),error:a?.has("securityCode")},`securityCode${J}`),(0,h.tZ)(v,{month:f,year:Z,onYearChange:M("expireYear"),onMonthChange:M("expireMonth")}),(0,h.tZ)(d.Kx,{sx:{"textarea, .readOnlyMask":{variant:"text.ds.body.standard.monospace"}},label:O("webapp_payment_edition_field_notes"),placeholder:O("webapp_payment_edition_field_placeholder_no_notes"),"data-name":"note",readOnly:!ee&&F||!!P,value:ee||!F?R:"••••",onChange:M("note"),actions:[(0,h.tZ)(d.zx,{layout:"iconOnly",icon:ee?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{K(ee,ne).catch((()=>{ae(!1)}))},"aria-label":O(ee?S:x),tooltip:O(ee?S:x)},"card-note-visibility"),..."edit"===C?[(0,h.tZ)(c.m,{data:R,checkProtected:()=>H,copyLabel:O("webapp_payment_edition_field_card_action_copy_note"),onCopy:()=>j(I(l.Field.Note),"webapp_payment_edition_field_notes_copied"),itemType:m.R.CreditCard,tooltipLocation:"right"},"copy-note")]:[]],"data-testid":"credential_edit_note_value"})]}),(0,h.BX)(u.u,{title:O("webapp_payment_edition_content_card_organization_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,h.tZ)(d.qo,{value:k,label:O("webapp_payment_edition_field_cardname"),placeholder:O("webapp_payment_edition_field_placeholder_no_cardname"),onChange:M("itemName"),disabled:!!P},"cardname"),(0,h.tZ)(d.mg,{label:O("webapp_payment_edition_field_cardColor"),placeholder:O(V[g]),value:g,onChange:M("color"),disabled:!!P,children:ie.map((e=>(0,h.tZ)(d.$m,{value:e.value,children:e.label},e.value)))},`cardColor${g}`),(0,h.tZ)(s.M,{isUsingNewDesign:!0,spaceId:null!=X?X:"",labelSx:s.e,onChange:e=>M("spaceId")(e),disabled:!!P})]})]})},R=e=>{const a=new Set;return e.cardNumber&&0!==e.cardNumber.length||a.add("cardNumber"),a.size>0?{isValid:!1,errorSet:a}:{isValid:!0}}}}]);