!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=57)}({0:function(e,t,n){"use strict";function r(){return-1!=navigator.userAgent.indexOf("Firefox")?browser:chrome}function o(){r().storage.local.get("debug",e=>{e.debug&&console&&console.log&&console.log.apply(this,arguments)})}function a(){console&&console.error&&console.error.apply(this,arguments)}function u(){void 0===u.locale_map&&TMExt_$.ajax({url:getURL("settings.json"),async:!1,dataType:"json",success:function(e){o(e),u.locale_map=e.supportLanguage,u.default_lang=e.defaultLanguage,u.l10n_map=e.l10nFolderMap}});let e=navigator.language,t=!1,n=u.locale_map,r="";for(var a=0;a<n.length;++a)if(n[a].includes(e)){r=n[a],t=!0;break}t||(r=u.default_lang);let i=r;return void 0!==u.l10n_map[r]&&(i=u.l10n_map[r]),i}function i(e,t,n){var o={action:e,params:t};r().runtime.sendMessage(o,n)}async function s(){let e=[];try{const t=await fetch(r().runtime.getURL("PbBankingList.txt"));e=(await t.text()).split("\n")}catch(e){a("getBankingList: e = "+e)}return o("getBankingList: size of banking list = "+e.length),e}function l(e,t,n,r){if(r<n)return-1;if(r-n<=1)return t===e[n]?n:t===e[r]?r:-1;let o=Math.floor((n+r)/2);return e[o]===t?o:e[o]<t?l(e,t,o,r):e[o]>t?l(e,t,n,o):-1}n.r(t),n.d(t,"getBrowser",(function(){return r})),n.d(t,"logInfo",(function(){return o})),n.d(t,"logError",(function(){return a})),n.d(t,"getCurrentLocale",(function(){return u})),n.d(t,"tbc_sendRequest",(function(){return i})),n.d(t,"getBankingList",(function(){return s})),n.d(t,"binarySearch",(function(){return l})),t.default={getBrowser:r,logInfo:o,logError:a,getCurrentLocale:u,tbc_sendRequest:i,getBankingList:s,binarySearch:l,sendMessageToActiveTab:function(e){return new Promise((t,n)=>{const o=r();o.tabs.query({active:!0,currentWindow:!0},r=>{r.length<=0?t(!1):o.tabs.sendMessage(r[0].id,e,()=>{o.runtime.lastError&&n(o.runtime.lastError.message)})})})},sha256:async function(e){let t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return[...new Uint8Array(n)].map(e=>e.toString(16).padStart(2,"0")).join("")}}},57:function(e,t,n){"use strict";n.r(t);var r=n(0);let o="tbb_inject_resources",a="tbb_open_paygurad",u="tbb_show_paygurad_tutorial",i="tbb_paygurad_check_banking_list",s=3,l=4,c=7,g=8,f=9,d=0,m=1,p=4,b=r.getBrowser();function y(e={}){return new Promise(t=>{b.tabs.query(e,e=>t(e))})}var w={setStorage:function(e){return new Promise(t=>{b.storage.local.set(e,()=>{t()})})},getStorage:function(e){return new Promise(t=>{b.storage.local.get(e,e=>{t(e)})})},removeStoreage:function(e){return new Promise(t=>{b.storage.local.remove(e,()=>{t()})})},getSystemStorageInfo:function(){return new Promise(e=>{b.system.storage.getInfo(t=>{e(t)})})},getSystemCpuInfo:function(){return new Promise(e=>{b.system.cpu.getInfo(t=>{e(t)})})},getTabInfo:y,getActiveTab:async function(){return await y({active:!0,lastFocusedWindow:!0})},getCurrentActiveWindowTabId:function(){return new Promise(e=>{const t=n=>{b.tabs.query({active:!0,lastFocusedWindow:!0},(function(r){!b.runtime.lastError&&0!==r.length&&r[0].hasOwnProperty("id")?e({ret:!0,tabId:r[0].id}):++n>=10?e({ret:!1}):setTimeout(()=>{t(n)},500)}))};t(0)})},getTab:function(e){return new Promise(t=>{b.tabs.get(e,e=>{b.runtime.lastError?t(null):t(e)})})}};const _=r.default.getBrowser(),P="[PG][Content]";let h=d,v=!1;const S=()=>h,T=()=>new Promise(e=>{window.getPgTutorialFlag=S;let t={scripts:["js/PayGuard/pgPromotion.js"],csses:["js/PayGuard/styles.css"],all_frames:!1};r.default.logInfo(P,"loadPromotionLoader: param = "+JSON.stringify(t)),_.runtime.sendMessage({action:o,parameters:t},()=>{r.default.logInfo(P,"loadPromotionLoader: sciprts are injected"),e(!0)})}),k=e=>{r.default.logInfo(P,"onShowPayguardTutorialResult: result = "+JSON.stringify(e)),e.hasOwnProperty("need_tutorial")&&!v&&(v=!0,h=e.need_tutorial,r.default.logInfo(P,"onShowPayguardTutorialResult: _tutorialFlag = "+h),h===m||h===p?_.runtime.sendMessage({action:i,url:document.location.href,tutorial_flag:h},e=>{(e=>{if(r.default.logInfo(P,"onPayGuardCheckBankingListResult: result = "+e),e)switch(h){case m:T();break;case p:T(),_.runtime.sendMessage({action:a,url:document.location.href,autoOpen:!0})}})(e)}):r.default.logInfo(P,"onShowPayguardTutorialResult: do not take action"))},j=()=>{w.getStorage({framework_status:!1,ratingResult:{}}).then(e=>{if(!e.framework_status)return void setTimeout(()=>{j()},1e3);let t=!1,n=!1;for(let o in e.ratingResult){let a=e.ratingResult[o];if(a.wtp_blocked_url===location.href){t=!0;let e=a.wtp_rating_result;switch(r.default.logInfo("checkPayguardPromotion: level = "+e),e){case s:case l:case c:case g:case f:n=!0}break}}t?n||(()=>{const e=()=>{v||(_.runtime.sendMessage({action:u},k),setTimeout(e,5e3))};e()})():setTimeout(()=>{j()},1e3)})};j()}});