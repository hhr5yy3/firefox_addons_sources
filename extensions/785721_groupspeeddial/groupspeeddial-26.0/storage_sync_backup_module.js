"use strict";(globalThis.webpackChunkgroup_speed_dial=globalThis.webpackChunkgroup_speed_dial||[]).push([[900],{5448:(t,e,r)=>{r.d(e,{G:()=>c});var o=r(2846),n=r(2542),a=r(7552),i=r(5524),s=r(6683);async function c(t){await o.M.promise;const e=o.M.GROUPS,r=new Set;for(let t=0;t<e.length;t++){const o=e[t];o.background?.type===s.sf.FILE&&r.add(o.id+o.createBackgroundFileURL());for(let t=0;t<o.dials.length;t++){const e=o.dials[t];e.url?r.add(o.id+e.url):e.multi&&Array.isArray(e.multi.links)?e.multi.links.forEach((t=>r.add(o.id+t.url))):e.providers&&Array.isArray(e.providers)&&e.providers.filter(n.Z).forEach((t=>r.add(o.id+t.url)))}}if(0!==r.size)for(const e of[a.ew.DB_IMAGE,a.ew.DB_PREVIOUS,a.ew.DB_ORIGINAL]){const o=await t.mapEachRecord(e,{filter:t=>!r.has(t.group+t.url),map:t=>({groupId:t.group,url:t.url})});for(const{groupId:r,url:n}of o)await t.removeDial(r,n).catch((t=>(0,i.vV)(`cannot delete dial from "${e}", row: [${r}, ${n}]`,t)));(0,i.cO)(`DB cleanup complete, from table: "${e}" deleted ${o.length} rows:`)}}},9232:(t,e,r)=>{r.r(e),r.d(e,{backupToSync:()=>O,getLocalStorageBackup:()=>C,getSyncBackups:()=>S});var o=r(4323);var n=r(3380),a=r(5772),i=r(5524),s=r(1374),c=r(5422),l=r(1061),d=r(7371),u=(r(2460),r(9180)),p=r(2846),f=r(1305),y=r(5448),m=r(9676),h=r(4716);const g=(0,u.Lm)(15),w=3,v=5e5,b="_bck_",A=b+"sync_backup",k=7692,I=101900,_=(t,e)=>`${b}${t}_p${e}`;async function E(){const t=(e=await browser.storage.sync.get(),Object.entries(e).filter((([t])=>t.startsWith(b))).map((([t,e])=>({key:t,strData:e,created:parseInt(t.slice(b.length)),partNumber:parseInt(t.split("_p")[1])}))));var e;const r=(0,s.vC)(t,"created").sort((0,a.s)("created",!1)).slice(w).map((t=>t.created)),o=new Set(r),{true:i,false:c}=(0,n.eg)(t,(t=>o.has(t.created)));return i.length>0&&await browser.storage.sync.remove(i.map((t=>t.key))),c}async function O(){const t=await E(),e=Math.max(0,...t.map((t=>t.created))),r=Date.now();if(r-e<g)return;await(0,m.w)(1e4,o.lQ,(()=>f.i.withDB(y.G)));const n=await async function(t){const e=JSON.stringify((0,c.E)(t));if(e.length>v)return"";const r=new h.w("compression"),o=await(0,d.v)(e);r.diff("lzma: "+o.length);const n=await(0,l.h)(o);return r.diff("base93: "+n.length),n.length>I?"":n}(p.M.serialize());try{self.localStorage.setItem(A,n)}catch(t){(0,i.vV)("localStorage backup failed",t)}const a=function(t,e){const r=new Array(Math.ceil(t.length/e)),o=Math.ceil(t.length/e);for(let n=0,a=0;n<o;++n,a+=e)r[n]=t.slice(a,a+e);return r}(n,k);0===a.length&&((0,i.vV)("too much data, won't fit in sync no matter what..."),a.push(""));const s=Object.fromEntries(a.map(((t,e)=>[_(r,e),t])));await browser.storage.sync.set(s).catch((async t=>{(0,i.vV)("backupToSync",t),await async function(){const t=await E(),e=Math.min(...t.map((t=>t.created))),r=t.filter((t=>t.created===e)).map((t=>t.key));r.length>0&&await browser.storage.sync.remove(r)}(),await browser.storage.sync.set(s)}))}async function N(t){const e=await(0,d.O)(await(0,l.A)(t));return(0,c.z)(JSON.parse(e))}async function S(){const t=await E(),e=(0,n.$z)(t,(t=>t.created));return(await Promise.all(Object.entries(e).map((async([t,e])=>{const r=e.sort((0,a.s)("partNumber")).map((t=>t.strData)).join("");if(0===r.length)return;const{groups:o,metadata:n}=await N(r);return{date:parseInt(t),groups:o,metadata:n}})))).filter(o.zz)}async function C(){const t=self.localStorage.getItem(A);if(t)return{...await N(t),date:Date.now()}}},5422:(t,e,r)=>{r.d(e,{E:()=>s,z:()=>c});var o=r(4323),n=r(2542),a=r(611);const i=function(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let t=0;t<e.length;t++)e[t]=255;for(let r=0;r<t.length;r++){const o=t.charAt(r),n=o.charCodeAt(0);if(255!==e[n])throw new TypeError(o+" is ambiguous");e[n]=r}const r=t.length,o=t.charAt(0),n=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function i(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;let a=0,i=0,s=0;for(;t[a]===o;)i++,a++;const c=(t.length-a)*n+1>>>0,l=new Uint8Array(c);for(;t[a];){let o=e[t.charCodeAt(a)];if(255===o)return;let n=0;for(let t=c-1;(0!==o||n<s)&&-1!==t;t--,n++)o+=r*l[t]>>>0,l[t]=o%256>>>0,o=o/256>>>0;if(0!==o)throw new Error("Non-zero carry");s=n,a++}let d=c-s;for(;d!==c&&0===l[d];)d++;const u=new Uint8Array(i+(c-d));let p=i;for(;d!==c;)u[p++]=l[d++];return u}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";let n=0,i=0,s=0;const c=e.length;for(;s!==c&&0===e[s];)s++,n++;const l=(c-s)*a+1>>>0,d=new Uint8Array(l);for(;s!==c;){let t=e[s],o=0;for(let e=l-1;(0!==t||o<i)&&-1!==e;e--,o++)t+=256*d[e]>>>0,d[e]=t%r>>>0,t=t/r>>>0;if(0!==t)throw new Error("Non-zero carry");i=o,s++}let u=l-i;for(;u!==l&&0===d[u];)u++;let p=o.repeat(n);for(;u<l;++u)p+=t.charAt(d[u]);return p},decodeUnsafe:i,decode:function(t){const e=i(t);if(e)return e;throw new Error("Non-base"+r+" character")}}};function s({groups:t,metadata:e,sync:r}){return{groups:t.map((t=>m(u(t)))),sync:r||{},metadata:e}}function c({groups:t,sync:e,metadata:r}){return{groups:t.map(f),sync:e||{},metadata:r||{}}}const l=t=>t?1:0,d=new class{base94=i(" !#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~");compress(t){const e=JSON.stringify(t),r=a.j.compress(e,9);return this.base94.encode(r)}decompress(t){const e=this.base94.decode(t),r=a.j.decompress(e);return JSON.parse(r)}},u=t=>[t.id,t.name,t.rows,t.cols,t.dials.map(p),t.ratio||0,t.color||0,t.background?[t.background.type,t.background.value,l(t.background.onlyName)]:0,t.archived?1:0,t.rowColor?Object.entries(t.rowColor).map((([t,e])=>[parseInt(t),e])):0,t.colColor?Object.entries(t.colColor).map((([t,e])=>[parseInt(t),e])):0,t.distraction?[]:0,t.dynamic?[t.dynamic.width,t.dynamic.height]:0,t.lock?[t.lock.passwordId,t.lock.visibility,l(t.lock.encrypted)]:0,t.list?[t.list.width,t.list.direction]:0,t.topSites?[]:0,t.iconId||0,t.container||0,t.grid?d.compress(t.grid):0,t.options||0];function p(t){const e=t.thumbnail,r=t.reload,a=t.crop,i=t.settings,s=t.text,c=t.live,d=t.multi,u=t.session,p=t.topSites,f=t.timer,y=t.weather,h=t.distraction,g=t.providers,w=t.visual,v=(0,o.f3)(t.type)||t.size?[t.name||0,t.type??null,t.url||0,t.note||0,e?[e.type||0,e.value||0,e.position||0,0,0,e.background]:0,r?[r.type||0,r.value||0,r.delay||0,r.method||0,r.cloud?[r.cloud.server]:0]:0,a?[a.scale||0,a.vrX||0,a.vrY||0,a.posX||0,a.posY||0]:0,i?[l(i.FETCH_NEW_NAME),l(i.NO_SCRIPT),i.OPEN_DIAL_IN||0,i.OPEN_IN_CONTAINER||"",i.TAG_ID||0]:0,t.created||0,t.size||0,s?[s.value||"",l(s.CLICK_TO_CLIPBOARD)]:0,g?g.map((t=>(0,n.Z)(t)?[t.type,t.url,t.name,t.icon||0,l(t.raw)]:[t.type,l(t.raw)])):0,c?[l(c.hideScrollbars),l(c.noInteraction)]:0,d?[d.links.map((({name:t,url:e,created:r})=>[t,e,r||0])),d.titleAction,d.linkAction,d.sortBy||0]:0,h?[]:0,w?[l(w.noTitle),w.padding||0,l(w.noIcon),w.titleColor||"",w.titleBackground||""]:0,u?[]:0,p?[]:0,f?[f.timers.map((t=>[t.type,t.value||""]))]:0,y?[y.theme,y.units,y.city,y.lat,y.lon,l(y.current),y.forecastDays]:0]:0;return v?m(v):v}function f(t){return{id:t[0]||0,name:t[1],rows:t[2],cols:t[3],dials:t[4].map(y),ratio:t[5]||void 0,color:t[6]||void 0,background:t[7]&&{type:t[7][0],value:t[7][1],onlyName:!!t[7][2]}||void 0,archived:!!t[8],rowColor:t[9]?Object.fromEntries(t[9]):void 0,colColor:t[10]?Object.fromEntries(t[10]):void 0,distraction:t[11]?{}:void 0,dynamic:t[12]&&{width:t[12][0],height:t[12][1]}||void 0,lock:t[13]&&{passwordId:t[13][0],visibility:t[13][1],encrypted:Boolean(t[13][2])}||void 0,list:t[14]&&{width:t[14][0],direction:t[14][1]}||void 0,topSites:t[15]&&{}||void 0,iconId:t[16]||0,container:t[17]||void 0,grid:t[18]?d.decompress(t[18]):void 0,options:t[19]||{}}}function y(t){if(!t)return{};const e={name:t[0]||void 0,type:(0,o.f3)(t[1])?t[1]:void 0,url:t[2]||void 0,note:t[3]||void 0,created:t[8]||void 0,size:t[9]||void 0};if(t[4]){const[r,o,n,a,i,s]=t[4];e.thumbnail={type:r,value:o,position:n,background:s}}if(t[5]){const[r,o,n,a,i]=t[5];if(e.reload={type:r,value:o,delay:n,method:a},i){const[t]=i;e.reload.cloud={server:t}}}if(t[6]){const[r,o,n,a,i]=t[6];e.crop={scale:r,vrX:o,vrY:n,posX:a,posY:i}}if(t[7]){const[r,o,n,a,i]=t[7];e.settings={FETCH_NEW_NAME:!!r,NO_SCRIPT:!!o,OPEN_DIAL_IN:n,OPEN_IN_CONTAINER:a,TAG_ID:i||0}}if(t[10]){const[r,o]=t[10];e.text={value:r,CLICK_TO_CLIPBOARD:!!o}}if(t[11]){const r=t[11];e.providers=r.map((t=>t[0]===n.S?{type:t[0],url:t[1],name:t[2],icon:t[3]||void 0,raw:!!t[4]}:{type:t[0],raw:!!t[1]}))}if(t[12]){const[r,o]=t[12];e.live={hideScrollbars:!!r,noInteraction:!!o}}if(t[13]){const[r,o,n,a]=t[13];e.multi={links:r.map((([t,e,r])=>({name:t,url:e,created:r}))),titleAction:o,linkAction:n,sortBy:a}}if(t[14]){const r=t[14];e.distraction=r?{}:void 0}if(t[15]){const[r,o,n,a,i]=t[15];e.visual={noTitle:!!r,padding:o,noIcon:!!n,titleColor:a,titleBackground:i}}if(t[16]){const r=t[16];e.session=r?{}:void 0}if(t[17]){const r=t[17];e.topSites=r?{}:void 0}if(t[18]){const r=t[18],o=r[0];e.timer=r?{timers:o.map((([t,e])=>({type:t,value:e})))}:void 0}if(t[19]){const[r,o,n,a,i,s,c]=t[19];e.weather={theme:r,units:o,city:n,lat:a,lon:i,current:!!s,forecastDays:c}}return e}function m(t){const e=t.findLastIndex((t=>0!==t));return t.slice(0,e+1)}},3380:(t,e,r)=>{function o(t,e){const r=[],o=[];for(let n=0;n<t.length;n++){const a=t[n];(e(a,n)?r:o).push(a)}return{true:r,false:o}}function n(t,e,r={}){for(let o=0;o<t.length;o++){const n=t[o],a=String(e(n,o)),i=r[a];i?i.push(n):r[a]=[n]}return r}function a(t,e){const r={};return Object.entries(t).forEach((([t,o])=>{r[t]=n(o,e)})),r}function i(t,e){const{true:r=[],false:o=[]}=n(t,e),a=[...r.slice(1),...o];return[r[0],a]}r.d(e,{$z:()=>n,Zg:()=>i,eg:()=>o,i8:()=>a})},1061:(t,e,r)=>{r.d(e,{A:()=>s,h:()=>i});var o=r(4681);function n(){return new Worker(r.p+"base_x.worker.worker.js")}r(1055);const a=" !#$%&'()*+,-./0123456789:;=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~";async function i(t){return(0,o.c)(n,{type:"encode",alphabet:a,buffer:t})}async function s(t){return(0,o.c)(n,{type:"decode",alphabet:a,data:t})}},7371:(t,e,r)=>{r.d(e,{v:()=>a,O:()=>i});var o=r(4681);function n(){return new Worker(r.p+"lzma_high_compressor.worker.worker.js")}r(611),r(1055);async function a(t,e=9){return(0,o.c)(n,{type:"compress",mode:e,data:t})}async function i(t){return(0,o.c)(n,{type:"decompress",byteArray:t})}},4681:(t,e,r)=>{function o(t,e){const r=t();return new Promise(((t,o)=>{r.postMessage(e),r.onmessageerror=o,r.onerror=o,r.onmessage=e=>t(e.data)})).finally((()=>r.terminate()))}r.d(e,{c:()=>o})}}]);