(()=>{var t={399:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,a=Object.create(o.prototype),s=new x(n||[]);return i(a,"_invoke",{value:A(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function y(){}function d(){}function v(){}var g={};l(g,s,(function(){return this}));var m=Object.getPrototypeOf,E=m&&m(m(L([])));E&&E!==e&&r.call(E,s)&&(g=E);var b=v.prototype=y.prototype=Object.create(g);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(i,a,s,u){var c=h(t[i],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,s,u)}),(function(t){o("throw",t,s,u)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,u)}))}u(c.arg)}var a;i(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function A(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=O(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function L(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return d.prototype=v,i(b,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:d,configurable:!0}),d.displayName=l(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},S(w.prototype),l(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(b),l(b,c,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=L,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function i(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,u,"next",t)}function u(t){i(a,n,o,s,u,"throw",t)}s(void 0)}))}}var s=r.g||window||self;s.__gobridge__||(s.__gobridge__={});var u=s.__gobridge__;e.A=function(t){var e=!1;function r(){return(r=a(o().mark((function r(){var n,i,a;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=new s.Go,r.next=3,t;case 3:return i=r.sent,r.next=6,WebAssembly.instantiate(i,n.importObject);case 6:a=r.sent,n.run(a.instance),e=!0;case 9:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return function(){r.apply(this,arguments)}(),new Proxy({},{get:function(t,r){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new Promise(function(){var t=a(o().mark((function t(i,a){var s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=function(){u[r].apply(void 0,[].concat(n,[function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return t?a(t):i.apply(void 0,r)}]))};case 1:if(e){t.next=6;break}return t.next=4,new Promise(requestAnimationFrame);case 4:t.next=1;break;case 6:if(r in u){t.next=9;break}return a('There is nothing defined with the name "'.concat(r.toString(),'"')),t.abrupt("return");case 9:if("function"==typeof u[r]){t.next=12;break}return i(u[r]),t.abrupt("return");case 12:s();case 13:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())}}})}},526:(t,e)=>{"use strict";e.byteLength=function(t){var e=s(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=s(t),a=i[0],u=i[1],c=new o(function(t,e,r){return 3*(e+r)/4-r}(0,a,u)),l=0,f=u>0?a-4:a;for(r=0;r<f;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;2===u&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,c[l++]=255&e);1===u&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e);return c},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=16383,s=0,c=n-o;s<c;s+=a)i.push(u(t,s,s+a>c?c:s+a));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=i[a],n[i.charCodeAt(a)]=a;function s(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function u(t,e,n){for(var o,i,a=[],s=e;s<n;s+=3)o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},287:(t,e,r)=>{"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const n=r(526),o=r(251),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50;const a=2147483647;function s(t){if(t>a)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,u.prototype),e}function u(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return c(t,e,r)}function c(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|d(t,e);let n=s(r);const o=n.write(t,e);o!==r&&(n=n.slice(0,o));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(W(t,Uint8Array)){const e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(W(t,ArrayBuffer)||t&&W(t.buffer,ArrayBuffer))return p(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(W(t,SharedArrayBuffer)||t&&W(t.buffer,SharedArrayBuffer)))return p(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return u.from(n,e,r);const o=function(t){if(u.isBuffer(t)){const e=0|y(t.length),r=s(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||z(t.length)?s(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return u.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return l(t),s(t<0?0:0|y(t))}function h(t){const e=t.length<0?0:0|y(t.length),r=s(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function p(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,u.prototype),n}function y(t){if(t>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||W(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return X(t).length;default:if(o)return n?-1:V(t).length;e=(""+e).toLowerCase(),o=!0}}function v(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,r);case"utf8":case"utf-8":return R(this,e,r);case"ascii":return L(this,e,r);case"latin1":case"binary":return k(this,e,r);case"base64":return T(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),z(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:E(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):E(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function E(t,e,r,n,o){let i,a=1,s=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){let n=-1;for(i=r;i<s;i++)if(c(t,i)===c(e,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===u)return n*a}else-1!==n&&(i-=i-n),n=-1}else for(r+u>s&&(r=s-u),i=r;i>=0;i--){let r=!0;for(let n=0;n<u;n++)if(c(t,i+n)!==c(e,n)){r=!1;break}if(r)return i}return-1}function b(t,e,r,n){r=Number(r)||0;const o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;const i=e.length;let a;for(n>i/2&&(n=i/2),a=0;a<n;++a){const n=parseInt(e.substr(2*a,2),16);if(z(n))return a;t[r+a]=n}return a}function S(t,e,r,n){return J(V(e,t.length-r),t,r,n)}function w(t,e,r,n){return J(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function A(t,e,r,n){return J(X(e),t,r,n)}function O(t,e,r,n){return J(function(t,e){let r,n,o;const i=[];for(let a=0;a<t.length&&!((e-=2)<0);++a)r=t.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function T(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function R(t,e,r){r=Math.min(t.length,r);const n=[];let o=e;for(;o<r;){const e=t[o];let i=null,a=e>239?4:e>223?3:e>191?2:1;if(o+a<=r){let r,n,s,u;switch(a){case 1:e<128&&(i=e);break;case 2:r=t[o+1],128==(192&r)&&(u=(31&e)<<6|63&r,u>127&&(i=u));break;case 3:r=t[o+1],n=t[o+2],128==(192&r)&&128==(192&n)&&(u=(15&e)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:r=t[o+1],n=t[o+2],s=t[o+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(u=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&s,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),o+=a}return function(t){const e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=x));return r}(n)}e.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),!u.TYPED_ARRAY_SUPPORT&&"undefined"!=typeof console&&console.error,Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(t,e,r){return c(t,e,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(t,e,r){return function(t,e,r){return l(t),t<=0?s(t):void 0!==e?"string"==typeof r?s(t).fill(e,r):s(t).fill(e):s(t)}(t,e,r)},u.allocUnsafe=function(t){return f(t)},u.allocUnsafeSlow=function(t){return f(t)},u.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==u.prototype},u.compare=function(t,e){if(W(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),W(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=u.allocUnsafe(e);let o=0;for(r=0;r<t.length;++r){let e=t[r];if(W(e,Uint8Array))o+e.length>n.length?(u.isBuffer(e)||(e=u.from(e)),e.copy(n,o)):Uint8Array.prototype.set.call(n,e,o);else{if(!u.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,o)}o+=e.length}return n},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?R(this,0,t):v.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(t,e,r,n,o){if(W(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;let i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0);const s=Math.min(i,a),c=this.slice(n,o),l=t.slice(e,r);for(let t=0;t<s;++t)if(c[t]!==l[t]){i=c[t],a=l[t];break}return i<a?-1:a<i?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":case"latin1":case"binary":return w(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function L(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function k(t,e,r){let n="";r=Math.min(t.length,r);for(let o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function I(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let o="";for(let n=e;n<r;++n)o+=Q[t[n]];return o}function _(t,e,r){const n=t.slice(e,r);let o="";for(let t=0;t<n.length-1;t+=2)o+=String.fromCharCode(n[t]+256*n[t+1]);return o}function P(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,r,n,o,i){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function N(t,e,r,n,o){F(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i,i>>=8,t[r++]=i;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,a>>=8,t[r++]=a,r}function G(t,e,r,n,o){F(e,n,o,t,r,7);let i=Number(e&BigInt(4294967295));t[r+7]=i,i>>=8,t[r+6]=i,i>>=8,t[r+5]=i,i>>=8,t[r+4]=i;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=a,a>>=8,t[r+2]=a,a>>=8,t[r+1]=a,a>>=8,t[r]=a,r+8}function Y(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function K(t,e,r,n,i){return e=+e,r>>>=0,i||Y(t,0,r,4),o.write(t,e,r,n,23,4),r+4}function j(t,e,r,n,i){return e=+e,r>>>=0,i||Y(t,0,r,8),o.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);let n=this[t+--e],o=1;for(;e>0&&(o*=256);)n+=this[t+--e]*o;return n},u.prototype.readUint8=u.prototype.readUInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),this[t]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readBigUInt64LE=$((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))})),u.prototype.readBigUInt64BE=$((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(o)})),u.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);let n=this[t],o=1,i=0;for(;++i<e&&(o*=256);)n+=this[t+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);let n=e,o=1,i=this[t+--n];for(;n>0&&(o*=256);)i+=this[t+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},u.prototype.readInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){t>>>=0,e||P(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){t>>>=0,e||P(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readBigInt64LE=$((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),u.prototype.readBigInt64BE=$((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),u.prototype.readFloatLE=function(t,e){return t>>>=0,e||P(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return t>>>=0,e||P(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return t>>>=0,e||P(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return t>>>=0,e||P(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){C(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){C(this,t,e,r,Math.pow(2,8*r)-1,0)}let o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,1,255,0),this[e]=255&t,e+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeBigUInt64LE=$((function(t,e=0){return N(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=$((function(t,e=0){return G(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);C(this,t,e,r,n-1,-n)}let o=0,i=1,a=0;for(this[e]=255&t;++o<r&&(i*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/i|0)-a&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);C(this,t,e,r,n-1,-n)}let o=r-1,i=1,a=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/i|0)-a&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeBigInt64LE=$((function(t,e=0){return N(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=$((function(t,e=0){return G(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(t,e,r){return K(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return K(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(!u.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{const i=u.isBuffer(t)?t:u.from(t,n),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=i[o%a]}return this};const B={};function D(t,e,r){B[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function U(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function F(t,e,r,n,o,i){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new B.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,r){M(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||q(e,t.length-(r+1))}(n,o,i)}function M(t,e){if("number"!=typeof t)throw new B.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,r){if(Math.floor(t)!==t)throw M(t,r),new B.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new B.ERR_BUFFER_OUT_OF_BOUNDS;throw new B.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=U(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=U(o)),o+="n"),n+=` It must be ${e}. Received ${o}`,n}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function V(t,e){let r;e=e||1/0;const n=t.length;let o=null;const i=[];for(let a=0;a<n;++a){if(r=t.charCodeAt(a),r>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function X(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function J(t,e,r,n){let o;for(o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function W(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function z(t){return t!=t}const Q=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let o=0;o<16;++o)e[n+o]=t[r]+t[o]}return e}();function $(t){return"undefined"==typeof BigInt?Z:t}function Z(){throw new Error("BigInt not supported")}},251:(t,e)=>{
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,r,n,o){var i,a,s=8*o-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?o-1:0,h=r?-1:1,p=t[e+f];for(f+=h,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+t[e+f],f+=h,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),i-=c}return(p?-1:1)*a*Math.pow(2,i-n)},e.write=function(t,e,r,n,o,i){var a,s,u,c=8*i-o-1,l=(1<<c)-1,f=l>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,y=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,o),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;t[r+p]=255&s,p+=y,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;t[r+p]=255&a,p+=y,a/=256,c-=8);t[r+p-y]|=128*d}},698:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},861:(t,e,r)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var n=r(287),o=n.Buffer;function i(t,e){for(var r in t)e[r]=t[r]}function a(t,e,r){return o(t,e,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=n:(i(n,e),e.Buffer=a),a.prototype=Object.create(o.prototype),i(o,a),a.from=function(t,e,r){if("number"==typeof t)throw new TypeError("Argument must not be a number");return o(t,e,r)},a.alloc=function(t,e,r){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=o(t);return void 0!==e?"string"==typeof r?n.fill(e,r):n.fill(e):n.fill(0),n},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return o(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},392:(t,e,r)=>{var n=r(861).Buffer;function o(t,e){this._block=n.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}o.prototype.update=function(t,e){"string"==typeof t&&(e=e||"utf8",t=n.from(t,e));for(var r=this._block,o=this._blockSize,i=t.length,a=this._len,s=0;s<i;){for(var u=a%o,c=Math.min(i-s,o-u),l=0;l<c;l++)r[u+l]=t[s+l];s+=c,(a+=c)%o==0&&this._update(r)}return this._len+=i,this},o.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=8*this._len;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(4294967295&r)>>>0,o=(r-n)/4294967296;this._block.writeUInt32BE(o,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var i=this._hash();return t?i.toString(t):i},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},t.exports=o},802:(t,e,r)=>{var n=t.exports=function(t){t=t.toLowerCase();var e=n[t];if(!e)throw new Error(t+" is not supported (we accept pull requests)");return new e};n.sha=r(816),n.sha1=r(737),n.sha224=r(710),n.sha256=r(107),n.sha384=r(827),n.sha512=r(890)},816:(t,e,r)=>{var n=r(698),o=r(392),i=r(861).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,o.call(this,64,56)}function c(t){return t<<30|t>>>2}function l(t,e,r,n){return 0===t?e&r|~e&n:2===t?e&r|e&n|r&n:e^r^n}n(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(t){for(var e,r=this._w,n=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,u=0|this._e,f=0;f<16;++f)r[f]=t.readInt32BE(4*f);for(;f<80;++f)r[f]=r[f-3]^r[f-8]^r[f-14]^r[f-16];for(var h=0;h<80;++h){var p=~~(h/20),y=0|((e=n)<<5|e>>>27)+l(p,o,i,s)+u+r[h]+a[p];u=s,s=i,i=c(o),o=n,n=y}this._a=n+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var t=i.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=u},737:(t,e,r)=>{var n=r(698),o=r(392),i=r(861).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,o.call(this,64,56)}function c(t){return t<<5|t>>>27}function l(t){return t<<30|t>>>2}function f(t,e,r,n){return 0===t?e&r|~e&n:2===t?e&r|e&n|r&n:e^r^n}n(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(t){for(var e,r=this._w,n=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,u=0|this._e,h=0;h<16;++h)r[h]=t.readInt32BE(4*h);for(;h<80;++h)r[h]=(e=r[h-3]^r[h-8]^r[h-14]^r[h-16])<<1|e>>>31;for(var p=0;p<80;++p){var y=~~(p/20),d=c(n)+f(y,o,i,s)+u+r[p]+a[y]|0;u=s,s=i,i=l(o),o=n,n=d}this._a=n+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var t=i.allocUnsafe(20);return t.writeInt32BE(0|this._a,0),t.writeInt32BE(0|this._b,4),t.writeInt32BE(0|this._c,8),t.writeInt32BE(0|this._d,12),t.writeInt32BE(0|this._e,16),t},t.exports=u},710:(t,e,r)=>{var n=r(698),o=r(107),i=r(392),a=r(861).Buffer,s=new Array(64);function u(){this.init(),this._w=s,i.call(this,64,56)}n(u,o),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var t=a.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t},t.exports=u},107:(t,e,r)=>{var n=r(698),o=r(392),i=r(861).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function u(){this.init(),this._w=s,o.call(this,64,56)}function c(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function f(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function h(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function p(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}n(u,o),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(t){for(var e,r=this._w,n=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,u=0|this._e,y=0|this._f,d=0|this._g,v=0|this._h,g=0;g<16;++g)r[g]=t.readInt32BE(4*g);for(;g<64;++g)r[g]=0|(((e=r[g-2])>>>17|e<<15)^(e>>>19|e<<13)^e>>>10)+r[g-7]+p(r[g-15])+r[g-16];for(var m=0;m<64;++m){var E=v+h(u)+c(u,y,d)+a[m]+r[m]|0,b=f(n)+l(n,o,i)|0;v=d,d=y,y=u,u=s+E|0,s=i,i=o,o=n,n=E+b|0}this._a=n+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0,this._f=y+this._f|0,this._g=d+this._g|0,this._h=v+this._h|0},u.prototype._hash=function(){var t=i.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t},t.exports=u},827:(t,e,r)=>{var n=r(698),o=r(890),i=r(392),a=r(861).Buffer,s=new Array(160);function u(){this.init(),this._w=s,i.call(this,128,112)}n(u,o),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var t=a.allocUnsafe(48);function e(e,r,n){t.writeInt32BE(e,n),t.writeInt32BE(r,n+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t},t.exports=u},890:(t,e,r)=>{var n=r(698),o=r(392),i=r(861).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function u(){this.init(),this._w=s,o.call(this,128,112)}function c(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function f(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function h(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function p(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function y(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function d(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function v(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function g(t,e){return t>>>0<e>>>0?1:0}n(u,o),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(t){for(var e=this._w,r=0|this._ah,n=0|this._bh,o=0|this._ch,i=0|this._dh,s=0|this._eh,u=0|this._fh,m=0|this._gh,E=0|this._hh,b=0|this._al,S=0|this._bl,w=0|this._cl,A=0|this._dl,O=0|this._el,T=0|this._fl,R=0|this._gl,x=0|this._hl,L=0;L<32;L+=2)e[L]=t.readInt32BE(4*L),e[L+1]=t.readInt32BE(4*L+4);for(;L<160;L+=2){var k=e[L-30],I=e[L-30+1],_=p(k,I),P=y(I,k),C=d(k=e[L-4],I=e[L-4+1]),N=v(I,k),G=e[L-14],Y=e[L-14+1],K=e[L-32],j=e[L-32+1],B=P+Y|0,D=_+G+g(B,P)|0;D=(D=D+C+g(B=B+N|0,N)|0)+K+g(B=B+j|0,j)|0,e[L]=D,e[L+1]=B}for(var U=0;U<160;U+=2){D=e[U],B=e[U+1];var F=l(r,n,o),M=l(b,S,w),q=f(r,b),H=f(b,r),V=h(s,O),X=h(O,s),J=a[U],W=a[U+1],z=c(s,u,m),Q=c(O,T,R),$=x+X|0,Z=E+V+g($,x)|0;Z=(Z=(Z=Z+z+g($=$+Q|0,Q)|0)+J+g($=$+W|0,W)|0)+D+g($=$+B|0,B)|0;var tt=H+M|0,et=q+F+g(tt,H)|0;E=m,x=R,m=u,R=T,u=s,T=O,s=i+Z+g(O=A+$|0,A)|0,i=o,A=w,o=n,w=S,n=r,S=b,r=Z+et+g(b=$+tt|0,$)|0}this._al=this._al+b|0,this._bl=this._bl+S|0,this._cl=this._cl+w|0,this._dl=this._dl+A|0,this._el=this._el+O|0,this._fl=this._fl+T|0,this._gl=this._gl+R|0,this._hl=this._hl+x|0,this._ah=this._ah+r+g(this._al,b)|0,this._bh=this._bh+n+g(this._bl,S)|0,this._ch=this._ch+o+g(this._cl,w)|0,this._dh=this._dh+i+g(this._dl,A)|0,this._eh=this._eh+s+g(this._el,O)|0,this._fh=this._fh+u+g(this._fl,T)|0,this._gh=this._gh+m+g(this._gl,R)|0,this._hh=this._hh+E+g(this._hl,x)|0},u.prototype._hash=function(){var t=i.allocUnsafe(64);function e(e,r,n){t.writeInt32BE(e,n),t.writeInt32BE(r,n+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t},t.exports=u},998:(t,e,r)=>{t=r.nmd(t),(()=>{if(void 0!==r.g);else if("undefined"!=typeof window)window.global=window;else{if("undefined"==typeof self)throw new Error("cannot export Go (neither global, window nor self is defined)");self.global=self}const e=()=>{const t=new Error("not implemented");return t.code="ENOSYS",t};if(!r.g.fs){let t="";r.g.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(e,r){t+=o.decode(r);const n=t.lastIndexOf("\n");return-1!=n&&(t=t.substr(n+1)),r.length},write(t,r,n,o,i,a){if(0!==n||o!==r.length||null!==i)return void a(e());a(null,this.writeSync(t,r))},chmod(t,r,n){n(e())},chown(t,r,n,o){o(e())},close(t,r){r(e())},fchmod(t,r,n){n(e())},fchown(t,r,n,o){o(e())},fstat(t,r){r(e())},fsync(t,e){e(null)},ftruncate(t,r,n){n(e())},lchown(t,r,n,o){o(e())},link(t,r,n){n(e())},lstat(t,r){r(e())},mkdir(t,r,n){n(e())},open(t,r,n,o){o(e())},read(t,r,n,o,i,a){a(e())},readdir(t,r){r(e())},readlink(t,r){r(e())},rename(t,r,n){n(e())},rmdir(t,r){r(e())},stat(t,r){r(e())},symlink(t,r,n){n(e())},truncate(t,r,n){n(e())},unlink(t,r){r(e())},utimes(t,r,n,o){o(e())}}}r.g.process||(r.g.process={getuid:()=>-1,getgid:()=>-1,geteuid:()=>-1,getegid:()=>-1,getgroups(){throw e()},pid:-1,ppid:-1,umask(){throw e()},cwd(){throw e()},chdir(){throw e()}}),r.g.performance||(r.g.performance={now(){const[t,e]=process.hrtime();return 1e3*t+e/1e6}});const n=new TextEncoder("utf-8"),o=new TextDecoder("utf-8");let i=new DataView(new ArrayBuffer(8));var a=[];if(r.g.Go=class{constructor(){this._callbackTimeouts=new Map,this._nextCallbackTimeoutID=1;const t=()=>new DataView(this._inst.exports.memory.buffer),e=t=>{i.setBigInt64(0,t,!0);const e=i.getFloat64(0,!0);if(0===e)return;if(!isNaN(e))return e;const r=0xffffffffn&t;return this._values[r]},s=r=>{let n=t().getBigUint64(r,!0);return e(n)},u=t=>{const e=0x7FF80000n;if("number"==typeof t)return isNaN(t)?e<<32n:0===t?e<<32n|1n:(i.setFloat64(0,t,!0),i.getBigInt64(0,!0));switch(t){case void 0:return 0n;case null:return e<<32n|2n;case!0:return e<<32n|3n;case!1:return e<<32n|4n}let r=this._ids.get(t);void 0===r&&(r=this._idPool.pop(),void 0===r&&(r=BigInt(this._values.length)),this._values[r]=t,this._goRefCounts[r]=0,this._ids.set(t,r)),this._goRefCounts[r]++;let n=1n;switch(typeof t){case"string":n=2n;break;case"symbol":n=3n;break;case"function":n=4n}return r|(e|n)<<32n},c=(e,r)=>{let n=u(r);t().setBigUint64(e,n,!0)},l=(t,e,r)=>new Uint8Array(this._inst.exports.memory.buffer,t,e),f=(t,e,r)=>{const n=new Array(e);for(let r=0;r<e;r++)n[r]=s(t+8*r);return n},h=(t,e)=>o.decode(new DataView(this._inst.exports.memory.buffer,t,e)),p=Date.now()-performance.now();this.importObject={wasi_snapshot_preview1:{fd_write:function(e,r,n,i){let s=0;if(1==e)for(let e=0;e<n;e++){let n=r+8*e,i=t().getUint32(n+0,!0),u=t().getUint32(n+4,!0);s+=u;for(let e=0;e<u;e++){let r=t().getUint8(i+e);if(13==r);else if(10==r){o.decode(new Uint8Array(a));a=[]}else a.push(r)}}return t().setUint32(i,s,!0),0},fd_close:()=>0,fd_fdstat_get:()=>0,fd_seek:()=>0,proc_exit:t=>{if(!r.g.process)throw"trying to exit with code "+t;process.exit(t)},random_get:(t,e)=>(crypto.getRandomValues(l(t,e)),0)},gojs:{"runtime.ticks":()=>p+performance.now(),"runtime.sleepTicks":t=>{setTimeout(this._inst.exports.go_scheduler,t)},"syscall/js.finalizeRef":r=>{const n=t().getUint32(e(r),!0);if(this._goRefCounts[n]--,0===this._goRefCounts[n]){const t=this._values[n];this._values[n]=null,this._ids.delete(t),this._idPool.push(n)}},"syscall/js.stringVal":(t,e)=>{const r=h(t,e);return u(r)},"syscall/js.valueGet":(t,r,n)=>{let o=h(r,n),i=e(t),a=Reflect.get(i,o);return u(a)},"syscall/js.valueSet":(t,r,n,o)=>{const i=e(t),a=h(r,n),s=e(o);Reflect.set(i,a,s)},"syscall/js.valueDelete":(t,r,n)=>{const o=e(t),i=h(r,n);Reflect.deleteProperty(o,i)},"syscall/js.valueIndex":(t,r)=>u(Reflect.get(e(t),r)),"syscall/js.valueSetIndex":(t,r,n)=>{Reflect.set(e(t),r,e(n))},"syscall/js.valueCall":(r,n,o,i,a,s,u)=>{const l=e(n),p=h(o,i),y=f(a,s);try{const e=Reflect.get(l,p);c(r,Reflect.apply(e,l,y)),t().setUint8(r+8,1)}catch(e){c(r,e),t().setUint8(r+8,0)}},"syscall/js.valueInvoke":(r,n,o,i,a)=>{try{const a=e(n),s=f(o,i);c(r,Reflect.apply(a,void 0,s)),t().setUint8(r+8,1)}catch(e){c(r,e),t().setUint8(r+8,0)}},"syscall/js.valueNew":(r,n,o,i,a)=>{const s=e(n),u=f(o,i);try{c(r,Reflect.construct(s,u)),t().setUint8(r+8,1)}catch(e){c(r,e),t().setUint8(r+8,0)}},"syscall/js.valueLength":t=>e(t).length,"syscall/js.valuePrepareString":(r,o)=>{const i=String(e(o)),a=n.encode(i);c(r,a),t().setInt32(r+8,a.length,!0)},"syscall/js.valueLoadString":(t,r,n,o)=>{const i=e(t);l(r,n).set(i)},"syscall/js.valueInstanceOf":(t,r)=>e(t)instanceof e(r),"syscall/js.copyBytesToGo":(r,n,o,i,a)=>{let s=r,u=r+4;const c=l(n,o),f=e(a);if(!(f instanceof Uint8Array||f instanceof Uint8ClampedArray))return void t().setUint8(u,0);const h=f.subarray(0,c.length);c.set(h),t().setUint32(s,h.length,!0),t().setUint8(u,1)},"syscall/js.copyBytesToJS":(r,n,o,i,a)=>{let s=r,u=r+4;const c=e(n),f=l(o,i);if(!(c instanceof Uint8Array||c instanceof Uint8ClampedArray))return void t().setUint8(u,0);const h=f.subarray(0,c.length);c.set(h),t().setUint32(s,h.length,!0),t().setUint8(u,1)}}},this.importObject.env=this.importObject.gojs}async run(t){this._inst=t,this._values=[NaN,0,null,!0,!1,r.g,this],this._goRefCounts=[],this._ids=new Map,this._idPool=[],this.exited=!1;new DataView(this._inst.exports.memory.buffer);for(;;){const t=new Promise((t=>{this._resolveCallbackPromise=()=>{if(this.exited)throw new Error("bad callback: Go program has already exited");setTimeout(t,0)}}));if(this._inst.exports._start(),this.exited)break;await t}}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(t){const e=this;return function(){const r={id:t,this:this,args:arguments};return e._pendingEvent=r,e._resume(),r.result}}},r.g.require&&r.g.require.main===t&&r.g.process&&r.g.process.versions&&!r.g.process.versions.electron){3!=process.argv.length&&process.exit(1);const t=new Go;WebAssembly.instantiate(fs.readFileSync(process.argv[2]),t.importObject).then((e=>t.run(e.instance))).catch((t=>{process.exit(1)}))}})()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,a=void 0,a=function(e,r){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,r||"default");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(i,"string"),"symbol"===t(a)?a:String(a)),o)}var i,a}const n=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.values={}}var r,n,o;return r=t,(n=[{key:"set",value:function(t,e){this.values[t]=e}},{key:"get",value:function(t){return!!this.values.hasOwnProperty(t)&&this.values[t]}}])&&e(r.prototype,n),o&&e(r,o),Object.defineProperty(r,"prototype",{writable:!1}),t}()),o="./assets",i="./images",a="./locale",s={name:"Firefox",WebRTCAddon:{id:"@webrtc-leak-shield",url:"https://addons.mozilla.org/en-US/firefox/addon/webrtc-leak-shield"},proxyAddons:["@hoxx-vpn","@setupvpncom"],exceptionAddons:["mozilla_cc3@internetdownloadmanager.com"]},u=JSON.parse('{"version":4,"update_interval_hours":6,"settings":{"tierbase_search_timeout":15000,"mainbase_search_timeout":20000,"tierbase_api_timeout":35000,"mainbase_api_timeout":30000,"proxy_search_timeout":30000,"mirror_timeout":20000,"base_ttl_days":90,"bs_consequtive_fails":42},"uibase":["https://user1.setupvpn.com","https://user2.setupvpn.com","https://user3.setupvpn.com","https://user4.setupvpn.com","https://user5.setupvpn.com","https://user6.setupvpn.com","https://user7.setupvpn.com","https://user8.setupvpn.com","https://user9.setupvpn.com","https://user10.setupvpn.com","https://user11.setupvpn.com","https://user13.setupvpn.com","https://user14.setupvpn.com","https://user15.setupvpn.com"],"mainbase":["https://icax.defined.pics","https://sxkk.mouse.pics","https://ehih.defined.pics","https://zmkj.defined.pics","https://kzfv.defined.pics","https://uabh.mouse.pics","https://1.foreground.work","https://1.awakened.work","https://1.6912044.cc","https://1.heretowe.win","https://topluok.uk","https://listitnow.org"],"tierbase":["https://lllm.mouse.pics","https://wvxm.defined.pics","https://mjgu.mouse.pics","https://xcxx.defined.pics","https://uaia.defined.pics","https://api.keepthisdomain.com","https://baseserver.uk","https://datacntech.com","https://1.default2024.uk","https://1.sahi.uk","https://1.area9.uk","https://1.allnine.uk","https://ksho.uk","https://3245.uk"],"t":1718866984900,"mirrors":["https://tierbase3.fra1.cdn.digitaloceanspaces.com/tierssv.json","https://tierbase4.s3.amazonaws.com/tierssv.json","https://pub-8029ed10cf4e4db0b3757e6b82ef7a40.r2.dev/tierssv.json","https://ams1.vultrobjects.com/tierupdate2/tierssv.json","https://mirror4.es-mad-1.linodeobjects.com/tierssv.json","https://raw.githubusercontent.com/the7c/update/master/master/ui/data.json","https://bitbucket.org/the7c/update/raw/master/edge/pub/data.json"]}');var c;function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const h={VERSION:chrome.runtime.getManifest().version,PLATFORM:s.name,BROWSERLANG:chrome.i18n.getUILanguage(),SERVERSJSONFILE:o+"/servers.json",TIERUPDATETTL:86400,VERSIONSTATUSTTL:86400,UNINSTALLPATH:"/api2/pub/removed",TESTREQUESTREGEX:/http:\/\/verify[0-9]{6,12}n[0-9]{6,12}\.com/,SERVICE:"SetupVPN",SERVICESHORT:"setupvpn",SHORTNAME:"sv",REALM:"setupvpn.com",CONTACTSUPPORTURL:"https://setupvpn.com/contact/",PACSCRIPT:"js/PAC.js",DOWNLOADLINKS:{ANDROID:"https://play.google.com/store/apps/details?id=com.setupvpn.main",DESKTOP:"http://desktopclient.net/gw/index.html#/setupvpn"},RATEUS:{LINKS:{FIREFOX:"https://addons.mozilla.org/en-US/firefox/addon/setupvpn/reviews/",CHROME:"https://chrome.google.com/webstore/detail/setupvpn-lifetime-free-vp/oofgbpoabipfcfjapgnbbjjaenockbdp/reviews",EDGE:!1},INTERVAL:2592e5,DONTASKINTERVAL:7776e6},WEBRTCADDON:{URL:s.WebRTCAddon.url,ID:s.WebRTCAddon.id},PROXYADDONS:s.proxyAddons,EXCEPTIONADDONS:s.exceptionAddons,STORAGEKEYS:(c={BASELINK:"baselink",LASTBASELINK:"lastBaselink",BASELINKNOTFOUND:"baselinkNotFound",LOCALE:"locale",LANGUAGE:"language",USERDATA:"userData",CONFIGDATA:"configData",CONFIGDATATTL:"configDataTTL",PROXYSEARCHFAILED:"proxySearchFailed",PROXYSEARCHFAILEDCOUNTRY:"proxySearchFailedCountry",PROXYSEARCHLOCK:"proxySearchLock",ISPROXYON:"isProxyOn",CURRENTPROXY:"currentSelectedProxy",DCACHE:"dCache",NOTIFICATIONS:"cachedNotifications",RATEUSNEXTTIME:"ratingNextTime",PROXYEXTENSIONS:"activeProxyExtensionList",IPLOOKUPURL:"ipLookUpUrl",STICKEDCOUNTRIES:"stickedCountries",ISCOUNTRYSORTED:"isCountrySorted",LASTSELECTEDTAB:"lastSelectedTab",BYPASSLIST:"bypassList",ISINAPPNOTIFICATIONOFF:"isInAppNotificationOff",LASTLOGINRESULT:"lastLoginResult",INSTALLID:"installId",LASTRESENDACTIVATION:"lastResendActivation",SERVERSJSON:"serversJson",TIERNEXTUPDATE:"tierNextUpdate",ERRCACHE:"errCache",ECACHE:"eCache",RCACHE:"rCache",HASHCACHE:"hashCache",BASELINKTYPE:"baselinkType",DEBUGVAL:"debugVal",TIMEOUTSETTINGS:"timeoutSettings",TEASERNEXT:"teaserNext",VERSIONSTATUSNEXTUPDATE:"versionStatusNextTime",VERSIONSTATUS:"versionStatus",LOGINTYPE:"logintype",LSER:"localeLser",COUNTRYLOCALE:"countryLocale",CONFIGHARDTTL:"configHardTTL",LASTLOGOUTREASON:"lastLogoutReason",COUNTRYSESSIONSTATE:"countrySessionState",LASTFAILEDSERVER:"lastFailedServer",LASTHB:"lastHB",BYPASSHOSTS:"bypassHosts",SHOWWP:"showWP",LASTBASELINKTTL:"lastBaselinkTTL"},f(c,"INSTALLID","installID"),f(c,"INSTALLIDTIME","installIDTime"),f(c,"VERSIONUPDATE","versionUpdate"),f(c,"READNOTIFICATION","readNotification"),f(c,"MARKEDBASELINK","markBaselink"),f(c,"MARKEDCONFIG","markedConfig"),f(c,"LASTSESSION","lastSession"),f(c,"PROXYSEARCH","proxySearch"),f(c,"NOTIFYHISTORY","notifyHistory"),f(c,"EXPIRATIONTIME","expirationTime"),f(c,"TIMELEFT","timeLeft"),c),STATUS:{BLOCKED:"BLOCKED",OK:"OK"},IMAGES:{ONICON:i+"/setupvpn-48.png",OFFICON:i+"/setupvpn-48-grey.png",HEADERLOGO:i+"/setupvpn-150.png",LOGOLARGE:i+"/setupvpn-250.png",FEATUREPINGIF:"/api2/static/sv/pinning.gif",FEATURESORTGIF:"/cdn/feature_sorting.gif",PERMERRORICON:i+"/symbol48-permission-error.png",PERMFIXGIF:"/api2/static/sv/perm-fix-sv.gif",OTHERTOOLSGIF:"/cdn/other-tools.gif"},SERVERSJSON:u,ERRORCODES:{CONNECTIONERROR:"NS_ERROR_NET_ON_CONNECTING_TO",CONNECTIONERROR2:"NS_ERROR_PROXY_CONNECTION_REFUSED",VERIFYERROR:"NS_ERROR_NET_ON_RESOLVED",VERIFYERROR2:"NS_ERROR_UNKNOWN_HOST"},LOADINGIMG:'<img src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==">'},p={PING:"/api2/p",TIER:"/api2/t/u",LANGUAGELIST:"/api2/l/l",GETLOCALE:"/api2/l/g",CONFIG:"/api/c/e",TICKETTOKEN:"/api/misc/persist",REST:"/api",REST2:"/api2",FORGOTPASS:"/api2/user/forgotpassword",PRODUCTS:"/api2/i/p",PROFILE:"/api/user/profile",AUTOPROXY:"/api2/m/debug",FEEDBACK:"/api2/m/feedback",NOTIFICATION:"/api/user/profile/notification",SUPPORT:"/api2/pub/clientsupport",DISCONNECTS:"/api/misc/disconnects",RESENDACTIVATION:"/api/user/activation/resend",CLOSEACCOUNT:"/api2/user/closeaccount",TRIAL:"/api2/user/trial",CLIENTUPDATES:"/api2/cu",REGISTER:"/api2/r/email",LOGINAUTHCODE:"/api2/c/2",CLIENT3:"/api2/c/3",WP:"/api2/wp",CREATETICKET:"/api2/support/ticket/new"},y=1e4,d=15e3,v=2e4,g=25e3,m=1e4,E=1e4;function b(t,e,r){return(e=A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A(n.key),n)}}function A(t){var e=function(t,e){if("object"!==S(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===S(e)?e:String(e)}var O=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,r=[{key:"isEmpty",value:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}},{key:"shuffleArray",value:function(t){for(var e,r,n=t.length;n;e=Math.floor(Math.random()*n),r=t[--n],t[n]=t[e],t[e]=r);return t}},{key:"loadTemplate",value:function(t,e){var r=t,n=t.match(/(?:\{)[^\{\}]*?(?:\})/g);return n?(n.forEach((function(t){var n=t.replace("{","").replace("}","");e[n]&&(r=r.replace(t,e[n]))})),r):r}},{key:"loadTemplateWithFallback",value:function(t,e,r){var n=t;return n=this.loadTemplate(t,e),n=this.loadTemplate(n,r)}},{key:"isObject",value:function(t){return"object"===S(t)&&null!==t}},{key:"isString",value:function(t){return"[object String]"===Object.prototype.toString.call(t)}},{key:"getFallbackLocale",value:function(t,e,r){return this.isObject(e)&&e.hasOwnProperty(t)&&this.isString(e[t])?e[t]:this.isObject(r)&&r.hasOwnProperty(t)&&this.isString(r[t])?r[t]:"Undefined locale"}},{key:"getConfigTTL",value:function(t,e){var r=e;return t&&Number.isInteger(t)&&(r=Math.min(Math.max(5,t),120)),Math.floor(Date.now()/1e3)+60*r}},{key:"getCurrentTime",value:function(){return Math.floor(Date.now()/1e3)}},{key:"getLocaleInStorage",value:function(){return new Promise((function(t,e){chrome.storage.local.get(h.STORAGEKEYS.LOCALE,(function(r){if(r[h.STORAGEKEYS.LOCALE])return t(r[h.STORAGEKEYS.LOCALE]);e()}))}))}},{key:"isUserPremium",value:function(t){if(0==t.user_premium)return!1;Date.now||(Date.now=function(){return(new Date).getTime()});var e=Math.floor(Date.now()/1e3);return t.user_premium>e}},{key:"getUserExpirationData",value:function(t){var e=new Date(1e3*t),r=e.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()];return e.getDate()+". "+n+" "+r}},{key:"getRandomInt",value:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}},{key:"getRandomRange",value:function(){var t={s:1e5,e:1e11};try{var e=this.getRandomInt(6,12),r=parseInt("1".padEnd(e,"0")),n=parseInt("9".padEnd(e,"9"));return t.s=r,t.e=n,t}catch(e){return t}return t}},{key:"generateIdentifierDomain",value:function(){var t=this.getRandomRange();return"test"+this.getRandomInt(t.s,t.e)}},{key:"getDateNow",value:function(){return Math.floor(Date.now()/1e3)}},{key:"getDateMid",value:function(){return Math.floor((new Date).setUTCHours(0,0,0,0)/1e3)}},{key:"openNewTab",value:function(t){chrome.tabs.create({url:t})}},{key:"setProxyStatusIcon",value:function(t){var e=t?h.IMAGES.ONICON:h.IMAGES.OFFICON;chrome.browserAction.setIcon({path:{38:e}})}},{key:"setPermissionIcon",value:function(t){var e=t?h.IMAGES.OFFICON:h.IMAGES.PERMERRORICON;chrome.browserAction.setIcon({path:{38:e}})}},{key:"showConnectionNotification",value:function(t,e,r){var n={type:"basic",title:t,message:e,iconUrl:r?h.IMAGES.ONICON:h.IMAGES.OFFICON};chrome.storage.local.get([h.STORAGEKEYS.ISINAPPNOTIFICATIONOFF,h.STORAGEKEYS.CONFIGDATA],(function(t){var e=t[h.STORAGEKEYS.CONFIGDATA],r=e&&e.uid?e.uid:"",o=t[h.STORAGEKEYS.ISINAPPNOTIFICATIONOFF];o&&!1===o[r]||chrome.notifications.create(n)}))}},{key:"showNotification",value:function(t,e){var r={type:"basic",title:t,message:e,iconUrl:h.IMAGES.ONICON};chrome.notifications.create(r)}},{key:"removePort",value:function(t){return t&&t.indexOf(":")>-1?t.substring(0,t.indexOf(":")):t}},{key:"escapeParamsOfUrl",value:function(t){var e=""+t;return e.indexOf("?")>-1&&(e=e.substr(0,e.indexOf("?"))),e}},{key:"addMetaParameter",value:function(t){return t+"&cv="+h.VERSION+"&platform="+h.PLATFORM}},{key:"getRemainingTime",value:function(t,e){if(t>1){var r=t-Math.floor(Date.now()/1e3);return r<3600?Math.floor(r/60)+" "+e.tempBlockMinutes:Math.floor(r/3600)+" "+e.tempBlockHours}return 0}},{key:"hideElement",value:function(t){t&&t.css&&t.css("display","none")}},{key:"showElement",value:function(t){t&&t.css&&t.css("display","block")}},{key:"stripProtocol",value:function(t){return t.replace("http://","").replace("https://","")}},{key:"sortObject",value:function(t){return Object.keys(t).sort().reduce((function(e,r){return e[r]=t[r],e}),{})}},{key:"getTabIdByServerType",value:function(t){if(!t)return 0;switch(t){case 0:return 0;case 1:return 1;case 2:return 2}}},{key:"openPlatformLink",value:function(t){return"desktop"===t?this.openNewTab(h.DOWNLOADLINKS.DESKTOP):"android"===t?this.openNewTab(h.DOWNLOADLINKS.ANDROID):void 0}},{key:"createUniqueId",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}},{key:"isInt",value:function(t){return!isNaN(t)&&(0|(e=parseFloat(t)))===e;var e}},{key:"hex_encode",value:function(t){t=unescape(encodeURIComponent(t));for(var e="",r=0;r<t.length;r++)e+=t.charCodeAt(r).toString(16);return e}},{key:"xor_string",value:function(t,e){t=t.split(""),e=e.split("");for(var r=t.length,n=e.length,o=String.fromCharCode,i=0;i<r;i++)t[i]=o(t[i].charCodeAt(0)^e[i%n].charCodeAt(0));return t.join("")}},{key:"randomString",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}},{key:"toqs",value:function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}},{key:"getTimeoutSettings",value:function(t){var e={mainbase_search_timeout:y,tierbase_search_timeout:d,mainbase_api_timeout:v,tierbase_api_timeout:g,proxy_search_timeout:m};try{t&&void 0!==t.settings&&(t.settings.hasOwnProperty("mainbase_search_timeout")&&this.isInt(t.settings.mainbase_search_timeout)&&t.settings.mainbase_search_timeout>=1e4&&t.settings.mainbase_search_timeout<4e4&&(e.mainbase_search_timeout=parseInt(t.settings.mainbase_search_timeout)),t.settings.hasOwnProperty("tierbase_search_timeout")&&this.isInt(t.settings.tierbase_search_timeout)&&t.settings.tierbase_search_timeout>=1e4&&t.settings.tierbase_search_timeout<4e4&&(e.tierbase_search_timeout=parseInt(t.settings.tierbase_search_timeout)),t.settings.hasOwnProperty("mainbase_api_timeout")&&this.isInt(t.settings.mainbase_api_timeout)&&t.settings.mainbase_api_timeout>=1e4&&t.settings.mainbase_api_timeout<4e4&&(e.mainbase_api_timeout=parseInt(t.settings.mainbase_api_timeout)),t.settings.hasOwnProperty("tierbase_api_timeout")&&this.isInt(t.settings.tierbase_api_timeout)&&t.settings.tierbase_api_timeout>=1e4&&t.settings.tierbase_api_timeout<4e4&&(e.tierbase_api_timeout=parseInt(t.settings.tierbase_api_timeout)),t.settings.hasOwnProperty("proxy_search_timeout")&&this.isInt(t.settings.proxy_search_timeout)&&t.settings.proxy_search_timeout>=1e4&&t.settings.proxy_search_timeout<4e4&&(e.proxy_search_timeout=parseInt(t.settings.proxy_search_timeout)))}catch(t){return e}return e}},{key:"isTimeoutSettingValid",value:function(t){return!!(t&&this.isInt(t)&&t>=1e4&&t<6e4)}},{key:"isTrialAvailable",value:function(t){return!!(t&&t.hasOwnProperty("trial")&&this.isInt(t.trial)&&t.trial>0)&&t.trial}},{key:"getUpdateHtml",value:function(t,e){return'\n\t\t\t\t<div class="update-available" id="update-app">\n\t\t\t\t\t<div class="update-available__title"><span class="update-available__notification">1</span> NEW UPDATE AVAILABLE</div>\n\t\t\t\t\t<div class="update-available__content">\n\t\t\t\t\t\t<div class="update-available__content__app">\n\t\t\t\t\t\t\t<div class="update-available__content__app__icon">\n\t\t\t\t\t\t\t\t<img src="images/symbol25.png">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="update-available__content__app__version-info">\n\t\t\t\t\t\t\t\t<div style="color: red;">Your version: '.concat(t,'</div>\n\t\t\t\t\t\t\t\t<div style="color: #007aff;">New version: ').concat(e,'</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="update-available__content__app__update">\n\t\t\t\t\t\t\t\t<div class="btn--update">UPDATE</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t')}},{key:"isValidResponse",value:function(t){return t&&"object"===S(t)&&null!==t&&t.hasOwnProperty("retcode")}},{key:"isResponseMinus20",value:function(t){return this.isValidResponse(t)&&-20===t.retcode}},{key:"isResponse200",value:function(t){return this.isValidResponse(t)&&200===t.retcode}},{key:"isResponseMinusOne",value:function(t){return this.isValidResponse(t)&&-1===t.retcode}},{key:"isResponseAuthError",value:function(t){return this.isValidResponse(t)&&-4===t.retcode}},{key:"isMaintenanceMode",value:function(t){return this.isValidResponse(t)&&-500===t.retcode}},{key:"showMinusOneError",value:function(t){this.isFunction(t)&&t("Something went wrong. Please try later again.")}},{key:"isFunction",value:function(t){return t&&"[object Function]"==={}.toString.call(t)}},{key:"getOS",value:function(){return new Promise((function(t){try{chrome.runtime.getPlatformInfo((function(e){var r="-";e&&e.os&&"string"==typeof e.os&&(r=e.os.toLowerCase()),t(r)}))}catch(e){t("-")}}))}},{key:"b64_to_utf8",value:function(t){return decodeURIComponent(escape(atob(t)))}},{key:"loadLocaleFromServer",value:function(t,e,r,n,o,i){var a=this;t.append('<div class="loadingimg"><img src="images/loading.gif"></div>'),n.request("api","getLocale",{}).then((function(t){function r(t){var r="<p style='text-align:center; padding: 10px 10xp;'>"+t+" / "+o+"</p>";e.css("display","block"),e.html(r)}return a.isResponse200(t)&&window.location.reload(!0),a.isResponseMinus20(t)?r(t.message):a.isResponseMinusOne(t)?a.showMinusOneError(r):void(a.isMaintenanceMode(t)&&(e.html('<div style="display: block;" id="maintenance-mode" class="maintenance-mode"><i class="material-icons maintenance-mode__close" id="maintenance-mode-close-icon">close</i><div class="maintenance-mode__container"><div class="maintenance-mode__icon"><i class="material-icons">build</i></div><div id="maintenance-msg" class="maintenance-mode__message"></div></div></div>'),i("#maintenance-msg").text(t.message),i("#maintenance-mode-close-icon").click((function(){location.reload()})),i("#upgrade-mode").css("display","none"),i("#dashboard-view-mode").css("display","block"),i("#header-container").css("display","none")))}))}},{key:"loadCountryLocale",value:function(t){var e=this;return new Promise((function(r,n){chrome.storage.local.get([h.STORAGEKEYS.COUNTRYLOCALE,h.STORAGEKEYS.LANGUAGE],(function(n){var o=n[h.STORAGEKEYS.COUNTRYLOCALE];if(o&&e.isObject(o))r(o);else{var i=n[h.STORAGEKEYS.LANGUAGE];t.request("api","getCountryLocale",{langCode:i}).then((function(t){t&&e.isObject(t)?r(t):r({})}))}}))}))}},{key:"genBypassList",value:function(t){try{if(t&&this.isObject(t)&&t.hasOwnProperty("mainbase")&&Array.isArray(t.mainbase)){var e=[];return t.mainbase.forEach((function(t){var r=!1;try{var n=new URL(t);n&&n.hostname&&(r=n.hostname)}catch(t){}r&&(e.includes(r)||e.push(r))})),e}return[]}catch(t){return[]}}},{key:"getServersJsonTime",value:function(t){return t&&""!=t&&t.hasOwnProperty("t")&&!isNaN(parseInt(t.t))?parseInt(t.t):0}},{key:"doTimeout",value:function(t){return new Promise((function(e){setTimeout((function(){e("TIMEOUT")}),t)}))}},{key:"doRace",value:function(t){return new Promise((function(e,r){Promise.race(t).then((function(t){e(t)}))}))}},{key:"setInstallId",value:function(){var t=this;chrome.storage.local.get([h.STORAGEKEYS.INSTALLID],(function(e){if(!e[h.STORAGEKEYS.INSTALLID]){var r,n=t.createUniqueId(),o=new Date/1;chrome.storage.local.set((b(r={},h.STORAGEKEYS.INSTALLID,n),b(r,h.STORAGEKEYS.INSTALLIDTIME,o),r))}}))}},{key:"setStorage",value:function(t){return new Promise((function(e,r){chrome.storage.local.set(t,e)}))}},{key:"getStorage",value:function(t){return new Promise((function(e,r){chrome.storage.local.get(t,e)}))}},{key:"removeStorage",value:function(t){return new Promise((function(e,r){chrome.storage.local.remove(t,e)}))}},{key:"addClickEvent",value:function(t,e){try{if(!e)return t;var r=new URL(t);return r.searchParams.append("c",e),r.href}catch(e){return t}}},{key:"delConfig",value:function(){return new Promise((function(t,e){chrome.storage.local.remove(h.STORAGEKEYS.CONFIGDATA,t)}))}}],r&&w(e.prototype,r),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();const T=new O;function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function x(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */x=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(L([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==R(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return k()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function L(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:k}}function k(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:L(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function L(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==R(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===R(i)?i:String(i)),n)}var o,i}const I=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baselink=e,this.pingLink=this.baselink+p.PING,this.secretKey=T.randomString(Math.round(3+61*Math.random())),this.parameter=btoa(T.xor_string(T.toqs(""),this.secretKey)),this.xhr=new XMLHttpRequest,this.xhr.open("POST",this.pingLink,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.setRequestHeader("Authorization","Basic "+btoa(this.secretKey+":"+T.randomString(Math.round(3+5*Math.random())))),this.xhr.timeout=r?n.tierbase_search_timeout:n.mainbase_search_timeout,this.xhr.ontimeout=this.onTimeout.bind(this),this.xhr.onreadystatechange=this.onXHRStateChanged.bind(this),this.start=this.start.bind(this)}var e,r,n;return e=t,r=[{key:"setOnDoneEvent",value:function(t){this.onDoneEvent=t}},{key:"onDone",value:function(t,e){this.onDoneEvent&&this.onDoneEvent(t,e)}},{key:"onTimeout",value:function(){}},{key:"onXHRStateChanged",value:function(){var t=this;if(4==t.xhr.readyState){if(200!=t.xhr.status)return t.onDone(t.baselink,!1);var e="";try{var r=T.xor_string(atob(t.xhr.responseText),t.secretKey);return(e=JSON.parse(r))&&200===e.retcode?t.onDone(t.baselink,!0):t.onDone(t.baselink,!1)}catch(e){return t.onDone(t.baselink,!1)}}}},{key:"startSync",value:function(){var t=this;return new Promise((function(e,r){t.setOnDoneEvent(e),t.xhr.send(t.parameter)}))}},{key:"start",value:function(){var t=this,e=this;this.xhr&&chrome.storage.local.get([h.STORAGEKEYS.USERDATA],(function(r){var n=r[h.STORAGEKEYS.USERDATA];T.getOS().then(function(){var r,o=(r=x().mark((function r(o){var i,a,s;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={cv:h.VERSION,platform:h.PLATFORM.toLowerCase(),brand:h.SHORTNAME.toLowerCase(),os:o},n&&T.isObject(n)&&n.uid&&(i.uid=n.uid),a="EXCEP",r.prev=3,r.next=6,it.isReady();case 6:return r.next=8,T.doRace([it.getHash(p.PING,i),T.doTimeout(2e3)]);case 8:a=r.sent,r.next=14;break;case 11:r.prev=11,r.t0=r.catch(3);case 14:i.e1=a,s=btoa(T.xor_string(T.toqs(i),e.secretKey)),t.xhr.send(s);case 18:case"end":return r.stop()}}),r,null,[[3,11]])})),function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){L(i,n,o,a,s,"next",t)}function s(t){L(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return o.apply(this,arguments)}}())}))}},{key:"terminate",value:function(){this.xhr&&this.xhr.abort()}}],r&&k(e.prototype,r),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function P(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */P=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==_(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function C(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function N(t,e,r,n){var o=new XMLHttpRequest,i=new Promise((function(i,a){var s=t+p.PING,u=T.randomString(Math.round(3+61*Math.random()));function c(e){n({url:s,baselink:t,isWorking:e}),i({url:s,baselink:t,isWorking:e})}o.open("POST",s,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.setRequestHeader("Authorization","Basic "+btoa(u+":"+T.randomString(Math.round(3+5*Math.random())))),o.timeout=e?r.tierbase_search_timeout:r.mainbase_search_timeout,o.ontimeout=function(){},o.onreadystatechange=function(){if(4==o.readyState){if(200!=o.status)return c(!1);var t="";try{var e=T.xor_string(atob(o.responseText),u);return(t=JSON.parse(e))&&200===t.retcode?c(!0):c(!1)}catch(t){return c(!1)}}},chrome.storage.local.get([h.STORAGEKEYS.USERDATA],(function(t){var e=t[h.STORAGEKEYS.USERDATA];T.getOS().then(function(){var t,r=(t=P().mark((function t(r){var n,i,a;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={cv:h.VERSION,platform:h.PLATFORM.toLowerCase(),brand:h.SHORTNAME.toLowerCase(),os:r},e&&T.isObject(e)&&e.uid&&(n.uid=e.uid),i="EXCEP",t.prev=3,t.next=6,it.isReady();case 6:return t.next=8,T.doRace([it.getHash(p.PING,n),T.doTimeout(2e3)]);case 8:i=t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3);case 14:n.e1=i,a=btoa(T.xor_string(T.toqs(n),u)),o.send(a);case 18:case"end":return t.stop()}}),t,null,[[3,11]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){C(i,n,o,a,s,"next",t)}function s(t){C(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t){return r.apply(this,arguments)}}())}))}));return{xhr:o,promise:i}}function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function Y(t){return function(t){if(Array.isArray(t))return K(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t,e){if("object"!==G(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===G(e)?e:String(e)}const D=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setUninstallLink(),this.setInstallId(),this.permissionChangeSubscribers=[],this.permissionController=!1,chrome.runtime.onStartup.addListener(this.onStartup.bind(this)),chrome.runtime.onInstalled.addListener(this.onInstalled.bind(this)),"firefox"!==h.PLATFORM.toLowerCase()&&(chrome.permissions.onAdded.addListener(this.onPermissionAdded.bind(this)),chrome.permissions.onRemoved.addListener(this.onPermissionRemoved.bind(this)))}var e,r,n;return e=t,(r=[{key:"subscribePermissionChange",value:function(t){this.permissionChangeSubscribers.push(t)}},{key:"registerController",value:function(t){this.permissionController=t}},{key:"isPermissionValid",value:function(){return new Promise((function(t,e){chrome.permissions.getAll((function(e){if(e&&e.origins&&e.origins.indexOf("<all_urls>")>-1)return t(!0);t(!1)}))}))}},{key:"isVersionStop",value:function(){return new Promise((function(t,e){chrome.storage.local.get([h.STORAGEKEYS.VERSIONSTATUS],(function(e){var r=e[h.STORAGEKEYS.VERSIONSTATUS];return r&&r.hasOwnProperty("action")&&"stop"==r.action&&r.hasOwnProperty("sources")&&Array.isArray(r.sources)&&r.sources.length>0&&r.hasOwnProperty("curversion")&&r.hasOwnProperty("minversion")?t(!0):t(!1)}))}))}},{key:"onPermissionAdded",value:function(t){var e=this;t&&t.origins&&t.origins.indexOf("<all_urls>")>-1&&(e.permissionChangeSubscribers.forEach((function(t){t(!0)})),e.permissionController&&e.permissionController(!0))}},{key:"onPermissionRemoved",value:function(t){var e=this;t&&t.origins&&t.origins.indexOf("<all_urls>")>-1&&(e.permissionChangeSubscribers.forEach((function(t){t(!1)})),e.permissionController&&e.permissionController(!1))}},{key:"setUninstallLink",value:function(){try{chrome.runtime.setUninstallURL&&chrome.storage.local.get([h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.INSTALLID,h.STORAGEKEYS.INSTALLIDTIME],(function(t){null!=t[h.STORAGEKEYS.BASELINK]&&chrome.runtime.getPlatformInfo((function(e){var r=t[h.STORAGEKEYS.CONFIGDATA],n=r&&r.uid?r.uid:"-",o=e&&e.os?e.os:"-",i=t[h.STORAGEKEYS.INSTALLID]?t[h.STORAGEKEYS.INSTALLID]:"-",a=t[h.STORAGEKEYS.INSTALLIDTIME]?t[h.STORAGEKEYS.INSTALLIDTIME]:"-",s="?cv="+h.VERSION+"&platform="+h.PLATFORM+"&os="+o+"&iid="+i+"&iidt="+a+"&uid="+n,u=t[h.STORAGEKEYS.BASELINK]+h.UNINSTALLPATH+s;chrome.runtime.setUninstallURL(u)}))}))}catch(t){}}},{key:"setInstallId",value:function(){T.setInstallId()}},{key:"updateVersionHistory",value:function(t){var e=h.VERSION;if(T.isObject(t)&&t.hasOwnProperty("previousVersion")&&e!==t.previousVersion){var r={t:Math.round(new Date/1),o:t.previousVersion,n:e};chrome.storage.local.get([h.STORAGEKEYS.VERSIONUPDATE],(function(t){var e,n,o,i=t[h.STORAGEKEYS.VERSIONUPDATE];Array.isArray(i)||(i=[]),i.length>9&&i.pop(),i=[r].concat(Y(i)),chrome.storage.local.set((e={},n=h.STORAGEKEYS.VERSIONUPDATE,o=i,(n=B(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e))}))}}},{key:"onStartup",value:function(){chrome.storage.local.remove([h.STORAGEKEYS.ECACHE,h.STORAGEKEYS.DCACHE,h.STORAGEKEYS.ERRCACHE,h.STORAGEKEYS.HASHCACHE])}},{key:"onInstalled",value:function(t){t&&t.reason&&("install"==t.reason&&this.setInstallId(),"update"==t.reason&&(chrome.storage.local.remove([h.STORAGEKEYS.DCACHE,h.STORAGEKEYS.ECACHE,h.STORAGEKEYS.ERRCACHE,h.STORAGEKEYS.HASHCACHE,h.STORAGEKEYS.VERSIONSTATUS,h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE,h.STORAGEKEYS.CONFIGDATA]),this.updateVersionHistory(t)))}}])&&j(e.prototype,r),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function U(t,e,r){return(e=X(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function M(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */M=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==F(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function q(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function H(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){q(i,n,o,a,s,"next",t)}function s(t){q(i,n,o,a,s,"throw",t)}a(void 0)}))}}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,X(n.key),n)}}function X(t){var e=function(t,e){if("object"!==F(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===F(e)?e:String(e)}const J=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),chrome.runtime.onInstalled.addListener(this.onInstalled.bind(this)),this.fallbackLink=h.FALLBACKLINK,this.running=0,this.worker=[],this.currentRequests=[],this.currentFound="",this.lastFound="",this.serversJson=!1,this.countOfMain=0,this.mainBaseResults=[],this.abortFlag=!1,this.turn=0,this.currentTier=!1,this.searchPort=!1,this.getMirror=this.getMirror.bind(this),this.fetchAnyMirror=this.fetchAnyMirror.bind(this),this.currentMirror=!1,this.getWorkingURL=this.getWorkingURL.bind(this),this.searchPort||this.connectPort()}var e,r,n,o,i,a,s,u,c;return e=t,r=[{key:"init",value:function(){var t=this;t.getStorageServersJson().then(t.validateStorageServersJson.bind(this)).then((function(e){t.serversJson&&(t.isMainRunning||t.isSecondRunning)||(t.serversJson=e),t.checkStorageForBaselink()}))}},{key:"validateStorageServersJson",value:function(t){return t||this.loadJsonFile()}},{key:"getStorageServersJson",value:function(){return new Promise((function(t,e){chrome.storage.local.get(h.STORAGEKEYS.SERVERSJSON,(function(e){e&&e[h.STORAGEKEYS.SERVERSJSON]?t(e[h.STORAGEKEYS.SERVERSJSON]):t(!1)}))}))}},{key:"checkStorageForBaselink",value:function(){var t=this;chrome.storage.local.get([h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.LASTBASELINK,h.STORAGEKEYS.BASELINKNOTFOUND,h.STORAGEKEYS.DEBUGVAL,h.STORAGEKEYS.LASTBASELINKTTL],(function(e){if(t.isSecondRunning)return t.onProgress(t),0;if(e[h.STORAGEKEYS.BASELINKNOTFOUND])return t.searchPort&&t.searchPort.postMessage({action:"failed"}),0;e[h.STORAGEKEYS.BASELINK]&&""!=e[h.STORAGEKEYS.BASELINK]&&(t.lastFound=e[h.STORAGEKEYS.BASELINK]);var r=parseInt(e[h.STORAGEKEYS.LASTBASELINKTTL]);if(t.currentFound=e[h.STORAGEKEYS.LASTBASELINK],t.currentFoundTTL=r&&!isNaN(r)?r:0,!t.isMainRunning){var n=e[h.STORAGEKEYS.DEBUGVAL];if(n&&("tier"==n.action||"main"==n.action))return void chrome.storage.local.remove(h.STORAGEKEYS.DEBUGVAL,(function(){"tier"==n.action?t.startTierSearch():t.startMainSearch()}));t.startMainSearch()}}))}},{key:"connectPort",value:function(){chrome.runtime.onConnect.addListener(this.onConnect.bind(this))}},{key:"onConnect",value:function(t){"basesearch-port"==t.name&&(this.searchPort=t,this.searchPort.onMessage.addListener(this.onMessage.bind(this)),this.searchPort.onDisconnect.addListener(this.onDisconnect.bind(this)))}},{key:"onMessage",value:function(){}},{key:"onDisconnect",value:function(){this.searchPort=!1}},{key:"startMainSearch",value:(c=H(M().mark((function t(){var e,r,n,o,i;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this).abortFlag=!1,e.running=0,e.mainBaseResults=[],e.baseLinks=T.shuffleArray(e.serversJson.mainbase),e.currentRequests=[],r=T.getTimeoutSettings(e.serversJson),e.isMainRunning=!0,e.isSecondRunning=!1,e.fetchAnyMirror(e.serversJson),t.prev=12,t.next=15,e.getWorkingURL(e.baseLinks,r,e.currentRequests);case 15:n=t.sent,t.next=21;break;case 18:t.prev=18,t.t0=t.catch(12);case 21:e.isMainRunning=!1,n&&T.isObject(n)&&n.hasOwnProperty("baselink")?(o=n.baselink,(i={})[h.STORAGEKEYS.BASELINK]=o,i[h.STORAGEKEYS.BASELINKTYPE]="main",i[h.STORAGEKEYS.LASTBASELINK]=o,i[h.STORAGEKEYS.LASTBASELINKTTL]=T.getDateNow()+900,chrome.storage.local.set(i,(function(){e.onFound()}))):e.startTierSearch();case 24:case"end":return t.stop()}}),t,this,[[12,18]])}))),function(){return c.apply(this,arguments)})},{key:"getCurrentFound",value:(u=H(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){chrome.storage.local.get([h.STORAGEKEYS.LASTBASELINK,h.STORAGEKEYS.LASTBASELINKTTL],(function(e){var r=parseInt(e[h.STORAGEKEYS.LASTBASELINKTTL]);t({lastbaselink:e[h.STORAGEKEYS.LASTBASELINK],lastbaselinkTTL:r&&!isNaN(r)?r:0})}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"getTimeout",value:(s=H(M().mark((function t(){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){chrome.storage.local.get([h.STORAGEKEYS.TIMEOUTSETTINGS],(function(e){var r=e[h.STORAGEKEYS.TIMEOUTSETTINGS],n=r&&T.isTimeoutSettingValid(r.mainbase_api_timeout)?r.mainbase_api_timeout:v;t(n)}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"getWorkingURL",value:(a=H(M().mark((function t(e,r,n){var o,i,a,s,u,c,l,f,h,p,y;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=function(t,e){t.forEach((function(t){try{if(e&&e.baselink==t.baselink)return;t.xhr.abort()}catch(t){}}))},a=function(t){i.push(t)},o=this,i=[],(u=e.map((function(t){var e=N(t,!1,r,a);return{xhr:e.xhr,promise:e.promise,baselink:t}}))).forEach((function(t){n.push(t)})),t.next=8,o.getTimeout();case 8:c=t.sent,l=Math.round(c/1e3),f=l>10&&l<100?l:32,h=0,p=M().mark((function t(){var r,n,a,c,l,f;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout(t,1e3)}));case 2:return t.next=4,o.getCurrentFound();case 4:if(r=t.sent,n=r.lastbaselink,a=r.lastbaselinkTTL,!((c=i.filter((function(t){return t.isWorking&&!(t.baselink==n&&a>T.getDateNow())}))).length>0)){t.next=14;break}return l=Math.floor(Math.random()*c.length),f=c[l],s(u,f),t.abrupt("return",{v:f});case 14:if(i.length!=e.length){t.next=17;break}return s(u,!1),t.abrupt("return",{v:null});case 17:h++;case 19:case"end":return t.stop()}}),t)}));case 14:if(!(h<f)){t.next=21;break}return t.delegateYield(p(),"t0",16);case 16:if("object"!==F(y=t.t0)){t.next=19;break}return t.abrupt("return",y.v);case 19:t.next=14;break;case 21:return s(u,!1),t.abrupt("return",null);case 23:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return a.apply(this,arguments)})},{key:"startTierSearch",value:function(){var t=this;t.abortFlag||(t.tierbase=t.serversJson.tierbase.slice(),t.isMainRunning=!1,t.isSecondRunning=!0,t.progressCurrent=0,t.progressEnd=t.tierbase.length,t.nextTierBaselink())}},{key:"nextTierBaselink",value:function(){var t="",e=this;chrome.storage.local.get([h.STORAGEKEYS.SERVERSJSON],(function(r){var n=r[h.STORAGEKEYS.SERVERSJSON],o=T.getServersJsonTime(n),i=T.getServersJsonTime(e.serversJson);if(o&&i&&i<o)e.isSecondRunning=!1,e.init();else{t=e.tierbase.pop();var a=T.getTimeoutSettings(e.serversJson);if(null!=t)return e.currentTier=new I(t,!0,a),e.currentTier.setOnDoneEvent(e.onTierWorkerDone.bind(e)),e.currentTier.start();if(0===e.tierbase.length)return e.onNotFound(!0);e.nextTierBaselink()}}))}},{key:"onTierWorkerDone",value:function(t,e){var r=this;if(++r.progressCurrent,r.onProgress(r),e){var n={};n[h.STORAGEKEYS.BASELINK]=t,n[h.STORAGEKEYS.BASELINKTYPE]="tier",n[h.STORAGEKEYS.LASTBASELINK]=n[h.STORAGEKEYS.BASELINK],chrome.storage.local.set(n,(function(){r.onFound(!0)}))}else r.abortFlag||setTimeout((function(){r.nextTierBaselink(1)}),600)}},{key:"abortAll",value:function(){var t=this;t.abortFlag=!0,t.cancelMainWorkers(),t.currentTier&&t.currentTier.terminate(),t.currentMirror&&t.cancelCurrentMirrorFetch(),t.onNotFound(!0)}},{key:"cancelMainWorkers",value:function(){var t=this;t.currentRequests&&Array.isArray(t.currentRequests)&&t.currentRequests.forEach((function(t){try{t.xhr.abort()}catch(t){}}))}},{key:"delConfig",value:function(){return new Promise((function(t,e){chrome.storage.local.remove(h.STORAGEKEYS.CONFIGDATA,t)}))}},{key:"onFound",value:(i=H(M().mark((function t(e){var r;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this,t.next=3,this.delConfig();case 3:it.openWP(),it.getTier(),it.getClientVersionStatus(),r.searchPort&&r.searchPort.postMessage({action:"success"}),e&&(r.isSecondRunning=!1),r.serversJson=!1,r.isMainRunning=!1,D.setUninstallLink();case 12:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"onNotFound",value:function(t){var e=this;chrome.storage.local.set(U({},h.STORAGEKEYS.BASELINKNOTFOUND,!0)),e.searchPort&&e.searchPort.postMessage({action:"failed"}),t&&(e.isSecondRunning=!1)}},{key:"onProgress",value:function(t){var e=t,r="Progress "+e.progressCurrent+" / "+e.progressEnd;e.searchPort&&e.isSecondRunning&&e.searchPort.postMessage({action:"progress",data:r})}},{key:"loadJsonFile",value:function(){var t=this;return new Promise((function(e,r){var n=new XMLHttpRequest;n.open("GET",h.SERVERSJSONFILE,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==n.readyState){var r=n.responseText,o=!1;try{o=JSON.parse(r)}catch(t){}if(o){var i,a=T.genBypassList(o),s=T.getTimeoutSettings(t.serversJson);chrome.storage.local.set((U(i={},h.STORAGEKEYS.TIMEOUTSETTINGS,s),U(i,h.STORAGEKEYS.SERVERSJSON,o),U(i,h.STORAGEKEYS.BYPASSHOSTS,a),i))}e(o)}},n.send()}))}},{key:"popupMessageHandler",value:function(t,e,r,n){switch(r){case"init":this.init(),t.postMessage({response:r,requestId:e,data:"init"});break;case"abortAll":this.abortAll(),t.postMessage({response:r,requestId:e,data:"abortAll"})}}},{key:"cacheBypass",value:function(){}},{key:"isEndpointChangeVersion",value:function(t){return!(!t||!/^(2\.|3\.[0-6]\.|3\.7\.0)/.test(t))}},{key:"validateCurrentBaselink",value:function(){var t=this;chrome.storage.local.remove(h.STORAGEKEYS.SERVERSJSON,(function(){chrome.storage.local.get([h.STORAGEKEYS.BASELINK],(function(e){var r=e[h.STORAGEKEYS.BASELINK];r&&t.loadJsonFile().then((function(e){-1===e.mainbase.indexOf(r)&&-1===e.tierbase.indexOf(r)&&chrome.storage.local.remove(h.STORAGEKEYS.BASELINK,(function(){t.init()}))}))}))}))}},{key:"onInstalled",value:function(t){var e=this;t&&t.reason&&"update"==t.reason&&(e.isEndpointChangeVersion(t.previousVersion)?this.validateCurrentBaselink():chrome.storage.local.remove(h.STORAGEKEYS.SERVERSJSON)),t&&t.reason&&"install"==t.reason&&chrome.storage.local.set(U({},h.STORAGEKEYS.SHOWWP,"installed"),(function(){e.init()}))}},{key:"cancelCurrentMirrorFetch",value:function(){try{this.currentMirror&&this.currentMirror.abort()}catch(t){}}},{key:"fetchAnyMirror",value:(o=H(M().mark((function t(e){var r,n,o;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this,!(e&&""!=e&&e.hasOwnProperty("mirrors")&&Array.isArray(e.mirrors))){t.next=19;break}n=0;case 3:if(!(n<e.mirrors.length)){t.next=19;break}if(!r.abortFlag){t.next=6;break}return t.abrupt("break",19);case 6:return o=e.mirrors[n],t.prev=7,t.next=10,r.getMirror(o);case 10:return t.abrupt("break",19);case 13:t.prev=13,t.t0=t.catch(7);case 16:n++,t.next=3;break;case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this,[[7,13]])}))),function(t){return o.apply(this,arguments)})},{key:"getMirror",value:function(t){var e=this;return new Promise((function(r,n){chrome.storage.local.get([h.STORAGEKEYS.TIMEOUTSETTINGS],(function(o){var i,a=o[h.STORAGEKEYS.TIMEOUTSETTINGS];i=a&&T.isTimeoutSettingValid(a.mirror_timeout)?a.mirror_timeout:E;var s=new XMLHttpRequest;e.currentMirror=s,s.open("GET",t,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.timeout=i,s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status){var t=s.responseText,e=!1;try{e=JSON.parse(t)}catch(t){return void n()}if(e&&""!=e&&200===e.retcode&&e.data&&e.data.hasOwnProperty("mainbase")&&Array.isArray(e.data.mainbase)&&e.data.mainbase.length>2&&e.data.hasOwnProperty("tierbase")&&Array.isArray(e.data.tierbase)&&e.data.tierbase.length>2){var o,i=T.genBypassList(e),a=T.getTimeoutSettings(e);chrome.storage.local.set((U(o={},h.STORAGEKEYS.TIMEOUTSETTINGS,a),U(o,h.STORAGEKEYS.SERVERSJSON,e.data),U(o,h.STORAGEKEYS.BYPASSHOSTS,i),o),(function(){r()}))}else n()}else n()},s.send()}))}))}}],r&&V(e.prototype,r),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());var W=r(399);r(998);const z=(0,W.A)(fetch("js/mini.wasm").then((t=>t.arrayBuffer())));function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function $(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Q(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Z(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function tt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Z(i,n,o,a,s,"next",t)}function s(t){Z(i,n,o,a,s,"throw",t)}a(void 0)}))}}function et(t,e,r){return(e=nt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nt(n.key),n)}}function nt(t){var e=function(t,e){if("object"!==Q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Q(e)?e:String(e)}var ot=r(802);const it=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n,o,i,s,u,c,l,f,y,d,v,g,m,E,b,S,w,A,O,R;return e=t,r=[{key:"prepareLoginData",value:function(t){var e,r,n;return t&&t.authcode&&(e=t.authcode),t&&t.email&&(r=t.email,t.password&&(n=ot("sha512").update(t.password).digest("hex")),t.hpassword&&(n=t.hpassword)),r&&n?{login:r,hpassword:n}:!!e&&{authcode:e}}},{key:"getCountryLocale",value:function(t,e){var r=this;r.loadCountryLocaleJsonFile(t.langCode).then((function(t){t?chrome.storage.local.set(et({},h.STORAGEKEYS.COUNTRYLOCALE,t),(function(){e&&e(t)})):r.loadCountryLocaleJsonFile("en").then((function(t){chrome.storage.local.set(et({},h.STORAGEKEYS.COUNTRYLOCALE,t),(function(){e&&e(t)}))}))}))}},{key:"loadCountryLocaleJsonFile",value:function(t){return new Promise((function(e,r){var n=new XMLHttpRequest,o=a+"/"+t+".json";n.open("GET",o,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.timeout=5e3,n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){var t=n.responseText,r=!1;try{r=JSON.parse(t)}catch(t){}e(r)}else e(!1)},n.send()}))}},{key:"promiseLogin",value:function(t){var e=this;return new Promise(function(){var r=tt($().mark((function r(n,o){var i,a;return $().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={isIgnoreFail:t},r.next=3,e.getLoginData();case 3:if(a=r.sent){r.next=6;break}return r.abrupt("return",{retcode:-4});case 6:i.userData=a,e.login(n,i);case 8:case"end":return r.stop()}}),r)})));return function(t,e){return r.apply(this,arguments)}}())}},{key:"getLoginData",value:(R=tt($().mark((function t(){return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){chrome.storage.local.get([h.STORAGEKEYS.USERDATA],(function(e){t(e[h.STORAGEKEYS.USERDATA])}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return R.apply(this,arguments)})},{key:"getLanguage",value:(O=tt($().mark((function t(e){var r,n,o;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this,n=Object.assign({},{}),o=!1,t.prev=3,t.next=6,z.doRequest(p.LANGUAGELIST,n);case 6:o=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:T.isResponse200(o)?e(o):T.isResponse200(o)||T.isResponseMinusOne(o)||T.isMaintenanceMode(o)||T.isResponseMinus20(o)?e&&e(o):chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];r.findNewBase(e)}));case 13:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t){return O.apply(this,arguments)})},{key:"getLocale",value:(A=tt($().mark((function t(e,r){var n,o,i,a,s,u;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=3,T.getStorage([h.STORAGEKEYS.LANGUAGE]);case 3:return o=t.sent,i=o[h.STORAGEKEYS.LANGUAGE],a=Object.assign({lang:i},{}),s=!1,t.prev=7,t.next=10,z.doRequest(p.GETLOCALE,a);case 10:s=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(7);case 16:if(!T.isResponse200(s)||"object"!==Q(s.translation)||null===s.translation){t.next=21;break}chrome.storage.local.set((et(u={},h.STORAGEKEYS.LOCALE,s.translation),et(u,h.STORAGEKEYS.LSER,Number.isInteger(s.serial)?s.serial:0),u),(function(){})),n.getCountryLocale({langCode:i},(function(){e(s)})),t.next=28;break;case 21:if(!(T.isResponseMinusOne(s)||T.isMaintenanceMode(s)||T.isResponseMinus20(s))){t.next=25;break}e&&e(s),t.next=28;break;case 25:if(!r||!0!==r.ignoreFail){t.next=27;break}return t.abrupt("return",e());case 27:chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 28:case"end":return t.stop()}}),t,this,[[7,13]])}))),function(t,e){return A.apply(this,arguments)})},{key:"login",value:(w=tt($().mark((function t(e,r){var n,o,i,a,s,u,c,l,f,p,y,d,v,g;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this,o=!(!r||!0!==r.isIgnoreFail),i=n.prepareLoginData(r.userData)){t.next=5;break}return t.abrupt("return",e({retcode:-4}));case 5:if(a=i.authcode,s=i.login,u=i.hpassword,a||s&&u){t.next=8;break}return t.abrupt("return",e({retcode:-4}));case 8:if(c="",!a){t.next=15;break}return t.next=12,z.getC3Auth(a.toLowerCase());case 12:c=t.sent,t.next=18;break;case 15:return t.next=17,z.getC3(s.toLowerCase(),u.toLowerCase());case 17:c=t.sent;case 18:if(!T.isResponse200(c)||!c.config){t.next=33;break}f=!!T.isObject(c.config.config_intervals)&&c.config.config_intervals.soft,p=!!T.isObject(c.config.config_intervals)&&c.config.config_intervals.hard,y=T.getConfigTTL(f,5),d=T.getConfigTTL(p,60),v={},s&&u&&(v.email=s,v.hpassword=u),a&&(v.authcode=a),c.config.uid&&(v.uid=c.config.uid),et(l={},h.STORAGEKEYS.USERDATA,v),et(l,h.STORAGEKEYS.CONFIGDATA,c.config),et(l,h.STORAGEKEYS.CONFIGDATATTL,y),et(l,h.STORAGEKEYS.CONFIGHARDTTL,d),et(l,h.STORAGEKEYS.LOGINTYPE,r.loginType),et(l,h.STORAGEKEYS.COUNTRYSESSIONSTATE,{}),et(l,h.STORAGEKEYS.LASTSESSION,[]),g=l,c.config.ipcheck_url&&(g[h.STORAGEKEYS.IPLOOKUPURL]=c.config.ipcheck_url),chrome.storage.local.set(g,(function(){return D.setUninstallLink(),e(c)})),t.next=40;break;case 33:if(!(T.isResponseAuthError(c)||T.isResponseMinusOne(c)||T.isMaintenanceMode(c)||T.isResponseMinus20(c))){t.next=38;break}return e&&e(c),t.abrupt("return");case 38:o||chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 39:return t.abrupt("return",e(c));case 40:case"end":return t.stop()}}),t,this)}))),function(t,e){return w.apply(this,arguments)})},{key:"registerAccount",value:(S=tt($().mark((function t(e,r){var n,o,i,a,s,u,c;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=4,T.getStorage([h.STORAGEKEYS.BASELINK]);case 4:if(t.sent[h.STORAGEKEYS.BASELINK]){t.next=9;break}return e&&e(!1),t.abrupt("return");case 9:return o=ot("sha512").update(r.password).digest("hex"),i=Object.assign({email:r.email,hpassword:o},{}),a=!1,t.prev=12,t.next=15,z.doRequest(p.REGISTER,i);case 15:a=t.sent,t.next=21;break;case 18:t.prev=18,t.t0=t.catch(12);case 21:if(!T.isResponse200(a)){t.next=29;break}return s={email:r.email,hpassword:o},t.next=26,T.setStorage(et({},h.STORAGEKEYS.USERDATA,s));case 26:e&&e(a),t.next=38;break;case 29:if(!(T.isResponse200(a)||T.isResponseMinus20(a)||T.isResponseMinusOne(a)||T.isMaintenanceMode(a))){t.next=33;break}e&&e(a),t.next=38;break;case 33:return t.next=35,T.getStorage([h.STORAGEKEYS.BASELINK]);case 35:u=t.sent,c=u[h.STORAGEKEYS.BASELINK],n.findNewBase(c);case 38:case"end":return t.stop()}}),t,this,[[12,18]])}))),function(t,e){return S.apply(this,arguments)})},{key:"forgotPass",value:(b=tt($().mark((function t(e,r){var n,o,i,a,s;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,o=Object.assign({},r),i=!1,t.prev=3,t.next=6,z.doRequest(p.FORGOTPASS,o);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:if(!T.isResponse200(i)){t.next=18;break}return t.next=15,T.removeStorage([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.CONFIGDATATTL]);case 15:e(i),t.next=27;break;case 18:if(!(T.isResponse200(i)||T.isResponseMinus20(i)||T.isResponseMinusOne(i)||T.isResponseAuthError(i)||T.isMaintenanceMode(i))){t.next=22;break}e&&e(i),t.next=27;break;case 22:return t.next=24,T.getStorage([h.STORAGEKEYS.BASELINK]);case 24:a=t.sent,s=a[h.STORAGEKEYS.BASELINK],n.findNewBase(s);case 27:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t,e){return b.apply(this,arguments)})},{key:"getProducts",value:(E=tt($().mark((function t(e,r){var n,o,i,a,s,u;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=(n=this).prepareLoginData(r)){t.next=4;break}return t.abrupt("return",e({retcode:-4}));case 4:return i=Object.assign({},o),a=!1,t.prev=6,t.next=9,z.doRequest(p.PRODUCTS,i);case 9:a=t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6);case 15:if(!T.isResponse200(a)){t.next=19;break}e(a),t.next=28;break;case 19:if(!(T.isResponse200(a)||T.isResponseMinusOne(a)||T.isResponseAuthError(a)||T.isMaintenanceMode(a)||T.isResponseMinus20(a))){t.next=23;break}e&&e(a),t.next=28;break;case 23:return t.next=25,T.getStorage([h.STORAGEKEYS.BASELINK]);case 25:s=t.sent,u=s[h.STORAGEKEYS.BASELINK],n.findNewBase(u);case 28:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(t,e){return E.apply(this,arguments)})},{key:"getPaymentLink",value:(m=tt($().mark((function t(e,r){var n,o,i,a,s,u,c;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=3,T.getStorage([h.STORAGEKEYS.USERDATA]);case 3:if(o=t.sent,i=o[h.STORAGEKEYS.USERDATA],a=n.prepareLoginData(i)){t.next=8;break}return t.abrupt("return",e({retcode:-4}));case 8:return s=Object.assign({productid:r.productid},a),u=p.REST2+r.endpoint,c=!1,t.prev=11,t.next=14,z.doRequest(u,s);case 14:c=t.sent,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(11);case 20:T.isResponse200(c)?e(c):T.isResponse200(c)||T.isResponseMinusOne(c)||T.isResponseAuthError(c)||T.isMaintenanceMode(c)||T.isResponseMinus20(c)?e&&e(c):chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 21:case"end":return t.stop()}}),t,this,[[11,17]])}))),function(t,e){return m.apply(this,arguments)})},{key:"verifyProxy",value:(g=tt($().mark((function t(e,r){var n,o;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object.assign({},r),o=!1,t.prev=3,t.next=6,z.doRequest(p.AUTOPROXY,n);case 6:o=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:e(o);case 13:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t,e){return g.apply(this,arguments)})},{key:"setNotificationState",value:(v=tt($().mark((function t(e,r){var n,o,i,a;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,T.getStorage([h.STORAGEKEYS.USERDATA]);case 3:return n=t.sent,o=n[h.STORAGEKEYS.USERDATA],i=Object.assign({email:o.email,hpassword:o.password,state:r.state},{}),a=!1,t.prev=7,t.next=10,z.doRequest(p.NOTIFICATION,i);case 10:a=t.sent,t.next=16;break;case 13:t.prev=13,t.t0=t.catch(7);case 16:e(a);case 17:case"end":return t.stop()}}),t,this,[[7,13]])}))),function(t,e){return v.apply(this,arguments)})},{key:"getTier",value:(d=tt($().mark((function t(e){var r,n,o,i,a,s,u,c,l,f;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=4,T.getStorage([h.STORAGEKEYS.SERVERSJSON,h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.TIERNEXTUPDATE]);case 4:if(r=t.sent,n=r[h.STORAGEKEYS.BASELINK],o=r[h.STORAGEKEYS.TIERNEXTUPDATE]?r[h.STORAGEKEYS.TIERNEXTUPDATE]:0,n){t.next=11;break}return e&&e(!1),t.abrupt("return");case 11:if(!(o<T.getDateNow())){t.next=28;break}return i=Object.assign({},{}),a=!1,t.prev=14,t.next=17,z.doRequest(p.TIER,i);case 17:a=t.sent,t.next=23;break;case 20:t.prev=20,t.t0=t.catch(14);case 23:s=h.TIERUPDATETTL,a&&""!=a&&200===a.retcode&&a.data&&a.data.hasOwnProperty("mainbase")&&Array.isArray(a.data.mainbase)&&a.data.mainbase.length>2&&a.data.hasOwnProperty("tierbase")&&Array.isArray(a.data.tierbase)?(a.hasOwnProperty("update_interval_hours")&&Number.isInteger(a.update_interval_hours)&&a.update_interval_hours>1&&a.update_interval_hours<168&&(s=60*a.update_interval_hours*60),c=T.getDateNow()+s,l=T.genBypassList(a.data),chrome.storage.local.set((et(u={},h.STORAGEKEYS.SERVERSJSON,a.data),et(u,h.STORAGEKEYS.TIERNEXTUPDATE,c),et(u,h.STORAGEKEYS.BYPASSHOSTS,l),u)),f=T.getTimeoutSettings(a.data),chrome.storage.local.set(et({},h.STORAGEKEYS.TIMEOUTSETTINGS,f))):(c=T.getDateNow()+s,chrome.storage.local.set(et({},h.STORAGEKEYS.TIERNEXTUPDATE,c))),e&&e(a),t.next=29;break;case 28:e&&e(!1);case 29:case"end":return t.stop()}}),t,this,[[14,20]])}))),function(t){return d.apply(this,arguments)})},{key:"getClientVersionStatus",value:(y=tt($().mark((function t(e,r){var n,o,i,a,s,u;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=4,T.getStorage([h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE]);case 4:if((n=t.sent)[h.STORAGEKEYS.BASELINK]){t.next=9;break}return e&&e(!1),t.abrupt("return");case 9:if(!((n[h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE]?n[h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE]:0)<T.getDateNow()||r&&!0===r.ignoreTTL)){t.next=28;break}return o=Object.assign({},{}),i=!1,t.prev=13,t.next=16,z.doRequest(p.CLIENTUPDATES,o);case 16:i=t.sent,t.next=22;break;case 19:t.prev=19,t.t0=t.catch(13);case 22:a=h.VERSIONSTATUSTTL,i&&""!=i&&200===i.retcode&&i.data&&i.data.hasOwnProperty("action")&&("update"===i.data.action||"stop"===i.data.action)&&i.data.hasOwnProperty("curversion")&&i.data.hasOwnProperty("minversion")&&i.data.hasOwnProperty("sources")&&Array.isArray(i.data.sources)&&i.data.sources.length>0?(i.hasOwnProperty("update_interval_hours")&&Number.isInteger(i.update_interval_hours)&&i.update_interval_hours>6&&i.update_interval_hours<720&&(a=60*i.update_interval_hours*60),u=T.getDateNow()+a,chrome.storage.local.set((et(s={},h.STORAGEKEYS.VERSIONSTATUS,i.data),et(s,h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE,u),s))):chrome.storage.local.remove([h.STORAGEKEYS.VERSIONSTATUS,h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE],(function(){var t=T.getDateNow()+a;chrome.storage.local.set(et({},h.STORAGEKEYS.VERSIONSTATUSNEXTUPDATE,t))})),e&&e(i),t.next=29;break;case 28:e&&e(!1);case 29:case"end":return t.stop()}}),t,this,[[13,19]])}))),function(t,e){return y.apply(this,arguments)})},{key:"sendFeedback",value:(f=tt($().mark((function t(e,r){var n,o;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object.assign({},r),o=!1,t.prev=3,t.next=6,z.doRequest(p.FEEDBACK,n);case 6:o=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:e(o);case 13:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t,e){return f.apply(this,arguments)})},{key:"closeAccount",value:(l=tt($().mark((function t(e,r){var n,o,i,a,s,u;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=3,T.getStorage([h.STORAGEKEYS.USERDATA]);case 3:if(o=t.sent,i=o[h.STORAGEKEYS.USERDATA],a=n.prepareLoginData(i)){t.next=8;break}return t.abrupt("return",e({retcode:-4}));case 8:return s=Object.assign({},a),u=!1,t.prev=10,t.next=13,z.doRequest(p.CLOSEACCOUNT,s);case 13:u=t.sent,t.next=19;break;case 16:t.prev=16,t.t0=t.catch(10);case 19:T.isResponse200(u)?chrome.storage.local.remove([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.CONFIGDATATTL],(function(){e(u)})):T.isResponse200(u)||T.isResponseMinus20(u)||T.isResponseMinusOne(u)||T.isResponseAuthError(u)||T.isMaintenanceMode(u)?e&&e(u):chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 20:case"end":return t.stop()}}),t,this,[[10,16]])}))),function(t,e){return l.apply(this,arguments)})},{key:"getTrial",value:(c=tt($().mark((function t(e,r){var n,o,i;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,o=Object.assign({},r),i=!1,t.prev=3,t.next=6,z.doRequest(p.TRIAL,o);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:T.isResponse200(i)?chrome.storage.local.remove(h.STORAGEKEYS.CONFIGDATA,(function(){e(i)})):T.isResponse200(i)||T.isResponseMinus20(i)||T.isResponseMinusOne(i)||T.isResponseAuthError(i)||T.isMaintenanceMode(i)?e&&e(i):chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 13:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t,e){return c.apply(this,arguments)})},{key:"openWP",value:(u=tt($().mark((function t(){var e,r;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,T.getStorage([h.STORAGEKEYS.SHOWWP]);case 3:if("installed"===t.sent[h.STORAGEKEYS.SHOWWP]){t.next=7;break}return t.abrupt("return");case 7:return e=Object.assign({},{}),r=!1,t.prev=9,t.next=12,z.doRequest(p.WP,e);case 12:r=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t.catch(9);case 18:if(!T.isResponse200(r)){t.next=23;break}if(!r.hasOwnProperty("wp")){t.next=23;break}return t.next=22,T.setStorage(et({},h.STORAGEKEYS.SHOWWP,"done"));case 22:T.openNewTab(r.wp);case 23:case"end":return t.stop()}}),t,this,[[9,15]])}))),function(){return u.apply(this,arguments)})},{key:"createTicket",value:(s=tt($().mark((function t(e,r){var n,o,i;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,o=Object.assign({from:r.email,subject:r.subject,body:r.message},{}),i=!1,t.prev=3,t.next=6,z.doRequest(p.CREATETICKET,o);case 6:i=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3);case 12:T.isResponse200(i)||T.isResponseMinus20(i)||T.isResponseMinusOne(i)||T.isResponseAuthError(i)||T.isMaintenanceMode(i)?e&&e(i):chrome.storage.local.get((function(t){var e=t[h.STORAGEKEYS.BASELINK];n.findNewBase(e)}));case 13:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(t,e){return s.apply(this,arguments)})},{key:"findNewBase",value:function(t){chrome.storage.local.get(h.STORAGEKEYS.BASELINK,(function(e){null!=e[h.STORAGEKEYS.BASELINK]&&t==e[h.STORAGEKEYS.BASELINK]&&chrome.storage.local.remove(h.STORAGEKEYS.BASELINK,(function(){J.init()}))}))}},{key:"popupCallback",value:function(t,e,r){return function(n){t.postMessage({response:r,requestId:e,data:n})}}},{key:"popupMessageHandler",value:function(t,e,r,n){switch(r){case"getLanguage":this.getLanguage(this.popupCallback(t,e,r));break;case"getLocale":this.getLocale(this.popupCallback(t,e,r));break;case"getCountryLocale":this.getCountryLocale(n,this.popupCallback(t,e,r));break;case"login":this.login(this.popupCallback(t,e,r),n);break;case"forgotPass":this.forgotPass(this.popupCallback(t,e,r),n);break;case"contactSupport":this.contactSupport(this.popupCallback(t,e,r),n);break;case"getProducts":this.getProducts(this.popupCallback(t,e,r),n);break;case"getPaymentLink":this.getPaymentLink(this.popupCallback(t,e,r),n);break;case"setNotificationState":this.setNotificationState(this.popupCallback(t,e,r),n);break;case"closeAccount":this.closeAccount(this.popupCallback(t,e,r),n);break;case"getTrial":this.getTrial(this.popupCallback(t,e,r),n);break;case"getClientVersionStatus":this.getClientVersionStatus(this.popupCallback(t,e,r),n);break;case"registerAccount":this.registerAccount(this.popupCallback(t,e,r),n);break;case"createTicket":this.createTicket(this.popupCallback(t,e,r),n);break;default:this.popupCallback(t,e,r)("")}}},{key:"getHash",value:(i=tt($().mark((function t(e,r){var n;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="EXCEP",t.prev=1,t.next=4,z.getHash(e,r);case 4:n=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1);case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,null,[[1,7]])}))),function(t,e){return i.apply(this,arguments)})},{key:"isReady",value:(o=tt($().mark((function t(){var e;return $().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=4,T.doRace([z.isReady(),T.doTimeout(2e3)]);case 4:return e=t.sent,t.abrupt("return",e);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(){return o.apply(this,arguments)})}],r&&rt(e.prototype,r),n&&rt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),at=["localhost","127.0.0.1","local","intra","intranet","onion"],st=["checkout.stripe.com"].concat(at);function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==ut(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ut(i)?i:String(i)),n)}var o,i}const lt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handleProxyRequest=this.handleProxyRequest.bind(this),this.handleTestRequest=this.handleTestRequest.bind(this),this.proxyConfig=!1,this.testHost=!1,this.byPassList=[]}var e,r,n;return e=t,(r=[{key:"set",value:function(t){var e=this;return new Promise((function(r,n){browser.proxy.onRequest.hasListener(e.handleTestRequest)&&browser.proxy.onRequest.removeListener(e.handleTestRequest),browser.proxy.onRequest.hasListener(e.handleProxyRequest)&&browser.proxy.onRequest.removeListener(e.handleProxyRequest),e.proxyConfig=t.proxy,e.byPassList=t.byPassList,browser.proxy.onRequest.addListener(e.handleProxyRequest,{urls:["<all_urls>"]}),r(e.proxyConfig)}))}},{key:"setTest",value:function(t,e){var r=this;return new Promise((function(n,o){browser.proxy.onRequest.hasListener(r.handleTestRequest)&&browser.proxy.onRequest.removeListener(r.handleTestRequest),browser.proxy.onRequest.hasListener(r.handleProxyRequest)&&browser.proxy.onRequest.removeListener(r.handleProxyRequest),r.proxyConfig=t,r.testHost=e,browser.proxy.onRequest.addListener(r.handleTestRequest,{urls:["<all_urls>"]}),n(t)}))}},{key:"unset",value:function(){var t=this;return new Promise((function(e,r){t.proxyConfig=!1,t.testHost=!1,t.byPassList=[],browser.proxy.onRequest.removeListener(t.handleTestRequest),browser.proxy.onRequest.removeListener(t.handleProxyRequest),e()}))}},{key:"handleTestRequest",value:function(t){return this.proxyConfig?new URL(t.url).hostname!==this.testHost?{type:"direct"}:{type:"http"===this.proxyConfig.Scheme?"http":"https",host:this.proxyConfig.Host,port:this.proxyConfig.Port}:{type:"direct"}}},{key:"handleProxyRequest",value:function(t){if(this.proxyConfig){var e=new URL(t.url);return this.byPassList.indexOf(e.hostname)>-1?{type:"direct"}:{type:"http"===this.proxyConfig.Scheme?"http":"https",host:this.proxyConfig.Host,port:this.proxyConfig.Port}}return{type:"direct"}}}])&&ct(e.prototype,r),n&&ct(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==ft(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ft(i)?i:String(i)),n)}var o,i}const pt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,o;return e=t,(r=[{key:"set",value:function(t,e){var r=this;return new Promise((function(e,o){n.set("current_proxy",t),r.getPacData(t,(function(t){lt.set(t).then(e)}))}))}},{key:"setTest",value:function(t){return new Promise((function(e,r){n.set("current_proxy",t.proxy),lt.setTest(t.proxy,t.testHost).then(e)}))}},{key:"unset",value:function(){return new Promise((function(t,e){lt.unset().then(t)}))}},{key:"getPacData",value:function(t,e){chrome.storage.local.get([h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.BYPASSLIST,h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.BYPASSHOSTS],(function(r){var n=r[h.STORAGEKEYS.CONFIGDATA],o=n&&n.uid?n.uid:"",i=r[h.STORAGEKEYS.BYPASSLIST],a=r[h.STORAGEKEYS.BYPASSHOSTS],s=r[h.STORAGEKEYS.BASELINK].replace("http://","").replace("https://","").replace("/client/","").replace("/"+h.SHORTNAME,"");s=(s=T.removePort(s)).toLowerCase();var u=[];u.push(s);var c=[];T.isUserPremium(n)&&(c=i&&i[o]?i[o]:[]),u=u.concat(st,c),a&&Array.isArray(a)&&(u=u.concat(a)),e({proxy:t,byPassList:u})}))}}])&&ht(e.prototype,r),o&&ht(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}());function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==yt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===yt(i)?i:String(i)),n)}var o,i}const vt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"set",value:function(t){return new Promise((function(e,r){pt.set(t).then((function(t){e(t)}))}))}},{key:"setTest",value:function(t){return new Promise((function(e,r){pt.setTest(t).then((function(t){e(t)}))}))}},{key:"unset",value:function(){return new Promise((function(t,e){pt.unset().then((function(){t()}))}))}}])&&dt(e.prototype,r),n&&dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function mt(t,e,r){return(e=bt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bt(n.key),n)}}function bt(t){var e=function(t,e){if("object"!==gt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===gt(e)?e:String(e)}const St=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;this.init(),e.onBeforeSendHeaders=this.onBeforeSendHeaders.bind(this),e.onPermissionChange=this.onPermissionChange.bind(this),D.subscribePermissionChange(e.onPermissionChange),D.isPermissionValid().then((function(t){t&&e.registerListeners()}))}var e,r,n;return e=t,(r=[{key:"onPermissionChange",value:function(t){t?this.registerListeners():this.removeListeners()}},{key:"registerListeners",value:function(){chrome.webRequest.onBeforeSendHeaders.hasListener(this.onBeforeSendHeaders)||chrome.webRequest.onBeforeSendHeaders.addListener(this.onBeforeSendHeaders,{urls:["<all_urls>"]})}},{key:"removeListeners",value:function(){chrome.webRequest.onBeforeSendHeaders.removeListener(this.onBeforeSendHeaders)}},{key:"init",value:function(){this.pendingRequest=[],this.currentRequest={},this.running=!1,this.cacheUsed=!1,this.identifyRunning=!1,this.identifyId=0,this.identifyLink="",this.nextEnteringKill=!1}},{key:"generateIdentifier",value:function(t){var e=this;e.identifierDomain=t.Host,e.identifierLink="https://"+t.Host+"/"+T.generateIdentifierDomain()+"/",e.uid&&(e.identifierLink=e.identifierLink+e.uid)}},{key:"startIdentifyRequest",value:function(){var t=this;chrome.storage.local.get([h.STORAGEKEYS.CURRENTPROXY],(function(e){var r=e[h.STORAGEKEYS.CURRENTPROXY];r&&T.isObject(r)&&r.Host||t.closeAllCallbacks();var n="https://"+r.Host+"/"+T.generateIdentifierDomain()+"/",o=new XMLHttpRequest;o.open("GET",n,!0),o.timeout=1e4,o.onreadystatechange=function(){if(4==o.readyState){var e=o.responseText;e&&-1!=e.indexOf("ERR_INVALID_URL")?t.tokenSuccess():t.closeAllCallbacks()}},t.identifyLink=n,t.identifyRunning=!0,o.send()}))}},{key:"useCache",value:function(t){var e=this;chrome.storage.local.get([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA],(function(r){e.setCacheUsed(!0),t({authCredentials:{username:r[h.STORAGEKEYS.CONFIGDATA].p_login?r[h.STORAGEKEYS.CONFIGDATA].p_login:"",password:r[h.STORAGEKEYS.CONFIGDATA].p_token?r[h.STORAGEKEYS.CONFIGDATA].p_token:""}})}))}},{key:"freshToken",value:function(t){var e=this;chrome.storage.local.get([h.STORAGEKEYS.USERDATA],(function(r){var n={hitReason:"getToken",userData:r[h.STORAGEKEYS.USERDATA]};it.login((function(r){T.isResponse200(r)?t({authCredentials:{username:r.config.p_login?r.config.p_login:"",password:r.config.p_token?r.config.p_token:""}}):T.isResponseMinus20(r)?chrome.storage.local.set(mt({},h.STORAGEKEYS.LASTLOGOUTREASON,r.message),(function(){chrome.storage.local.remove([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.CONFIGDATATTL,h.STORAGEKEYS.CONFIGHARDTTL],(function(){t({cancel:!0}),e.closeAllCallbacks()}))})):(t({cancel:!0}),e.closeAllCallbacks())}),n)}))}},{key:"tokenSuccess",value:function(){var t=this;chrome.storage.local.get([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA],(function(e){for(var r=0;r<t.pendingRequest.length;r++)t.pendingRequest[r]({authCredentials:{username:e[h.STORAGEKEYS.CONFIGDATA].p_login?e[h.STORAGEKEYS.CONFIGDATA].p_login:"",password:e[h.STORAGEKEYS.CONFIGDATA].p_token?e[h.STORAGEKEYS.CONFIGDATA].p_token:""}});t.init()}))}},{key:"closeAllCallbacks",value:function(){for(var t=this,e=0;e<t.pendingRequest.length;e++)t.pendingRequest[e]({cancel:!0});t.init(),vt.unset().then((function(t){chrome.storage.local.get([h.STORAGEKEYS.ISPROXYON,h.STORAGEKEYS.LOCALE],(function(t){var e;t[h.STORAGEKEYS.ISPROXYON]&&t[h.STORAGEKEYS.LOCALE]&&T.showConnectionNotification(t[h.STORAGEKEYS.LOCALE].NotifyVPNDisconnectTitle,t[h.STORAGEKEYS.LOCALE].NotifyVPNDisconnectMsg);var r=(mt(e={},h.STORAGEKEYS.ISPROXYON,!1),mt(e,h.STORAGEKEYS.CURRENTPROXY,!1),e);chrome.storage.local.set(r)}))}))}},{key:"clearTokenWatcher",value:function(){var t=this;if(t.pendingRequest.length>0){for(var e=0;e<t.pendingRequest.length;e++)t.pendingRequest[e]({cancel:!0});t.init()}}},{key:"setIdentifyId",value:function(t){this.identifyId=t}},{key:"setCurrentRequest",value:function(t){this.currentRequest=t}},{key:"setRunning",value:function(){this.running=!0}},{key:"setPendingRequest",value:function(t){this.pendingRequest.push(t)}},{key:"setNextEnteringKill",value:function(t){this.nextEnteringKill=t}},{key:"setCacheUsed",value:function(t){this.cacheUsed=t}},{key:"getNextEnteringKill",value:function(){return this.nextEnteringKill}},{key:"getIdentifyId",value:function(){return this.identifyId}},{key:"getIdentifyLink",value:function(){return this.identifyLink}},{key:"getCurrentRequest",value:function(){return this.currentRequest}},{key:"isRunning",value:function(){return this.running}},{key:"isIdentifyRunning",value:function(){return this.identifyRunning}},{key:"isCachedUsed",value:function(){return this.cacheUsed}},{key:"onBeforeSendHeaders",value:function(t){var e=this;e.isRunning()&&-1!=t.url.indexOf(e.getIdentifyLink())&&e.isIdentifyRunning()&&e.setIdentifyId(t.requestId)}}])&&Et(e.prototype,r),n&&Et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function At(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==wt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===wt(i)?i:String(i)),n)}var o,i}const Ot=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;this.init(),e.onRequestCompleted=this.onRequestCompleted.bind(this),e.onRequestError=this.onRequestError.bind(this),e.onPermissionChange=this.onPermissionChange.bind(this),D.subscribePermissionChange(e.onPermissionChange),D.isPermissionValid().then((function(t){t&&e.registerListeners()}))}var e,r,n;return e=t,(r=[{key:"onPermissionChange",value:function(t){t?this.registerListeners():this.removeListeners()}},{key:"registerListeners",value:function(){var t=this;chrome.webRequest.onCompleted.hasListener(t.onRequestCompleted)||chrome.webRequest.onCompleted.addListener(t.onRequestCompleted,{urls:["<all_urls>"]},["responseHeaders"]),chrome.webRequest.onErrorOccurred.hasListener(t.onRequestError)||chrome.webRequest.onErrorOccurred.addListener(t.onRequestError,{urls:["<all_urls>"]})}},{key:"removeListeners",value:function(){chrome.webRequest.onCompleted.removeListener(this.onRequestCompleted),chrome.webRequest.onErrorOccurred.removeListener(this.onRequestError)}},{key:"init",value:function(){this.isRunning=!1,this.startTime=0,this.onSuccess=0,this.proxyServer="",this.lastError=0,this.lastSuccess=0,this.isPendingUnset=!1,this.nRequest=[],this.nRequestCount=0,this.numberOfAllowedFails=10,this.numberOfCurrentFails=0,this.rescueURL=[]}},{key:"startSession",value:function(t){var e=this;e.init(),e.isRunning=!0,e.startTime=Date.now(),e.proxyServer=t}},{key:"stopSession",value:function(){this.abortRemainingRequests(),this.init()}},{key:"addFailedRescueRequest",value:function(t){var e=this;++e.numberOfCurrentFails,e.numberOfAllowedFails==e.numberOfCurrentFails&&kt.clearSettings()}},{key:"generateRescueURL",value:function(t){for(var e=0;e<this.numberOfAllowedFails;e++)this.rescueURL[e]="https://"+t.Host+"/"+T.generateIdentifierDomain()+"/"}},{key:"request",value:function(t,e,r){var n=this;n.nRequest[t]=new XMLHttpRequest,n.nRequest[t].open("GET",t,!0),n.nRequest[t].onreadystatechange=function(o){if(4===n.nRequest[t].readyState){var i=n.nRequest[t].responseText;i&&-1!=i.indexOf("ERR_INVALID_URL")?(window.clearInterval(e),n.abortRemainingRequests(),n.lastError=0,n.lastSuccess=0,n.isPendingUnset=!1):n.addFailedRescueRequest(r)}},++n.nRequestCount,n.nRequest[t].send(null)}},{key:"startRescueRequest",value:function(t){var e=this;chrome.storage.local.get([h.STORAGEKEYS.CURRENTPROXY],(function(t){var r=t[h.STORAGEKEYS.CURRENTPROXY];if(r&&T.isObject(r)&&r.Host){e.numberOfCurrentFails=0,e.rescueURL=[],e.nRequest=[],e.generateRescueURL(r);var n=setInterval(function(){if(e.rescueURL.length>0){var t=e.rescueURL.pop();e.request(t,n,r)}else window.clearInterval(n)}.bind(this),1e3)}}))}},{key:"setPendingUnset",value:function(t){var e=this;e.isPendingUnset=!0,setTimeout((function(){if(e.lastError,e.lastSuccess,e.isRunning&&e.lastError>e.lastSuccess){if(e.nRequestCount<100)return e.startRescueRequest(t);kt.clearSettings()}else e.lastError=0,e.lastSuccess=0,e.isPendingUnset=!1}),2e3)}},{key:"abortRemainingRequests",value:function(){var t=this;for(var e in t.nRequest)t.nRequest.hasOwnProperty(e)&&t.nRequest[e].abort()}},{key:"onRequestError",value:function(t){var e=this;(t.error==h.ERRORCODES.CONNECTIONERROR||void 0!==h.ERRORCODES.CONNECTIONERROR2&&t.error==h.ERRORCODES.CONNECTIONERROR2)&&chrome.storage.local.get([h.STORAGEKEYS.ISPROXYON,h.STORAGEKEYS.CURRENTPROXY],(function(t){t[h.STORAGEKEYS.ISPROXYON]&&e.onProxyErrorHappened(t[h.STORAGEKEYS.CURRENTPROXY])}))}},{key:"onRequestCompleted",value:function(t){t.hasOwnProperty("ip")&&this.onSuccessfulRequest()}},{key:"onSuccessfulRequest",value:function(){this.isRunning&&(this.lastSuccess=Date.now())}},{key:"onProxyErrorHappened",value:function(t){var e=this;e.isRunning&&!e.isPendingUnset&&(e.lastError=Date.now(),e.setPendingUnset(t))}}])&&At(e.prototype,r),n&&At(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Tt(t){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tt(t)}function Rt(t,e,r){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lt(n.key),n)}}function Lt(t){var e=function(t,e){if("object"!==Tt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Tt(e)?e:String(e)}const kt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),chrome.storage.onChanged.addListener(this.onSettingsChanged.bind(this)),this.clearSettings()}var e,r,n;return e=t,(r=[{key:"clearSettings",value:function(t){Ot.stopSession(),St.clearTokenWatcher(),vt.unset().then((function(){chrome.storage.local.get([h.STORAGEKEYS.ISPROXYON,h.STORAGEKEYS.LOCALE],(function(e){var r;e[h.STORAGEKEYS.ISPROXYON]&&e[h.STORAGEKEYS.LOCALE]&&T.showConnectionNotification(e[h.STORAGEKEYS.LOCALE].NotifyVPNDisconnectTitle,e[h.STORAGEKEYS.LOCALE].NotifyVPNDisconnectMsg);var n=(Rt(r={},h.STORAGEKEYS.ISPROXYON,!1),Rt(r,h.STORAGEKEYS.CURRENTPROXY,!1),Rt(r,h.STORAGEKEYS.EXPIRATIONTIME,!1),r);chrome.storage.local.set(n,(function(){t&&t()}))}))}))}},{key:"onSettingsChanged",value:function(t,e){if(-1!==Object.keys(t).indexOf(h.STORAGEKEYS.ISPROXYON)){var r=t[h.STORAGEKEYS.ISPROXYON].newValue;T.setProxyStatusIcon(r),r?Ot.startSession():Ot.stopSession()}}},{key:"popupCallback",value:function(t,e,r){return function(n){t.postMessage({response:r,requestId:e,data:n})}}},{key:"popupMessageHandler",value:function(t,e,r,n){"clearSettings"===r?this.clearSettings(this.popupCallback(t,e,r)):this.popupCallback(t,e,r)("")}}])&&xt(e.prototype,r),n&&xt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pt(n.key),n)}}function Pt(t){var e=function(t,e){if("object"!==It(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===It(e)?e:String(e)}const Ct=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"isExtInstalled",value:function(t){var e=this;return new Promise((function(r,n){e.getAllExt().then((function(e){for(var o=0;o<e.length;o++)if(e[o].id==t)return r(!0);n({reason:"not_installed"})}))}))}},{key:"isExtActive",value:function(t){var e=this;return new Promise((function(r,n){e.getAllExt().then((function(e){for(var o=0;o<e.length;o++)if(!0===e[o].enabled&&e[o].id==t)return r(!0);n({reason:"not_active"})}))}))}},{key:"cacheExtWithProxyPerm",value:function(t){this.getAllProxyExt().then(this.saveInStorage.bind(this)).then((function(e){t&&t(e)}))}},{key:"saveInStorage",value:function(t){return new Promise((function(e,r){var n,o,i;chrome.storage.local.set((n={},o=h.STORAGEKEYS.PROXYEXTENSIONS,i=t,(o=Pt(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n),(function(){e(t)}))}))}},{key:"getAllExt",value:function(){return new Promise((function(t,e){return"FIREFOX"==h.PLATFORM.toUpperCase()?browser.management.getAll().then(t):chrome.management.getAll(t)}))}},{key:"getAllProxyExt",value:function(t){var e=this;return new Promise((function(r,n){e.getAllExt().then((function(n){for(var o=[],i=0;i<n.length;i++)e.hasExtensionProxyPermission(n[i])&&chrome.runtime.id!==n[i].id&&-1===h.PROXYADDONS.indexOf(n[i].id)&&-1===h.EXCEPTIONADDONS.indexOf(n[i].id)&&n[i].enabled&&o.push(n[i]);if(t)return t(o);r(o)}))}))}},{key:"popupCallback",value:function(t,e,r){return function(n){t.postMessage({response:r,requestId:e,data:n})}}},{key:"popupMessageHandler",value:function(t,e,r,n){"cacheExtWithProxyPerm"===r&&this.cacheExtWithProxyPerm(this.popupCallback(t,e,r))}},{key:"hasExtensionProxyPermission",value:function(t){return!!(t&&t.permissions&&t.permissions.indexOf("proxy")>-1)}}])&&_t(e.prototype,r),n&&_t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Nt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Nt(i)?i:String(i)),n)}var o,i}const Yt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"isIpv4",value:function(t){var e=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(t);return null!==e&&!(e[1]>255||e[2]>255||e[3]>255||e[4]>255)}},{key:"isHostname",value:function(t){return t.match("^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]).)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$")}}])&&Gt(e.prototype,r),n&&Gt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bt(n.key),n)}}function Bt(t){var e=function(t,e){if("object"!==Kt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Kt(e)?e:String(e)}const Dt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"validate",value:function(t,e){var r=this;chrome.storage.local.get([h.STORAGEKEYS.CONFIGDATA],(function(n){var o=n[h.STORAGEKEYS.CONFIGDATA],i=o&&o.ipcheck_url?o.ipcheck_url:"undefined";i=T.stripProtocol(i);for(var a=e.newData,s=(e.currentData,r.readByNewLine(a)),u=[],c=[],l=0;l<s.length;l++){var f=r.removeUrlComponents(s[l].toLowerCase()).replace(" ","");!Yt.isIpv4(f)&&null==Yt.isHostname(f)||i==f?""!=s[l]&&c.push(s[l]):-1==u.indexOf(f)&&-1==at.indexOf(f)&&u.push(f)}var p={bypassList:u,errorLines:c,valid:u.length,invalid:c.length};return p.bypassList.length>0?r.saveBypassList(p).then(t):r.saveBypassList({bypassList:[]}).then(t)}))}},{key:"saveBypassList",value:function(t){return new Promise((function(e,r){chrome.storage.local.get([h.STORAGEKEYS.BYPASSLIST,h.STORAGEKEYS.CONFIGDATA],(function(r){var n,o,i,a=r[h.STORAGEKEYS.CONFIGDATA],s=r[h.STORAGEKEYS.BYPASSLIST];s||(s={}),s[a&&a.uid?a.uid:""]=t.bypassList,chrome.storage.local.set((n={},o=h.STORAGEKEYS.BYPASSLIST,i=s,(o=Bt(o))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n),(function(){e(t)}))}))}))}},{key:"removeUrlComponents",value:function(t){var e=T.stripProtocol(t);return e.includes("/")?e.split("/")[0]:e}},{key:"readByNewLine",value:function(t){return t.split("\n")}},{key:"popupCallback",value:function(t,e,r){return function(n){t.postMessage({response:r,requestId:e,data:n})}}},{key:"popupMessageHandler",value:function(t,e,r,n){"validate"===r&&this.validate(this.popupCallback(t,e,r),n)}}])&&jt(e.prototype,r),n&&jt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Ut(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Ut(i)?i:String(i)),n)}var o,i}const Mt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;e.registeredView=!1,e.onPermissionChanged=this.onPermissionChanged.bind(this),D.isPermissionValid().then((function(t){t||T.setPermissionIcon(t)})),D.registerController(e.onPermissionChanged)}var e,r,n;return e=t,(r=[{key:"onPermissionChanged",value:function(t){this.registeredView&&this.registeredView(t),T.setPermissionIcon(t),t||kt.clearSettings((function(){T.setPermissionIcon(t)}))}},{key:"registerView",value:function(t,e){var r=this;r.registeredView=t,e.onDisconnect.addListener(r.onViewDisconnect.bind(r))}},{key:"onViewDisconnect",value:function(){this.registeredView=!1}},{key:"popupCallback",value:function(t,e,r,n,o){return function(i){t.postMessage({response:r,requestId:e,data:i,targetMethod:r,targetApi:n,isEvent:o})}}},{key:"popupMessageHandler",value:function(t,e,r,n,o,i){"registerView"===r?this.registerView(this.popupCallback(t,e,r,o,i),t):this.popupCallback(t,e,r)("")}}])&&Ft(e.prototype,r),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()),qt={ActivationVerifyEmail:"Verify your email address",ActivationTitle:"Yay! You're Almost There.",ActivationTitle2:"Activate your account to finish your signing up.",ActivationText:"We've sent you a welcome email with an activation link. Simply click that link and afterwards login to your account.",ActivationWarning:"It can take up to 5 minutes to receive the email with an activation link. Please don't forget to check your spam and junk folder.",ActivationResendError:"You have requested this function too many times in a short amount of time. Please try again in 5 minutes.",ActivationResendSuccess:"New Activation Link Sent",AuthLoginSignTo:"Sign in to",AuthLoginAuthcodeDesc:"Enter your Auth-Code to sign in:",AuthLoginSignEmailPassword:"Sign in with Email & Password",AuthLoginSignAuthcode:"Sign in with Auth-Code",AuthLoginChangeLanguage:"Change Language",AuthCreateAuthcodeDesc:"Sign-up for free and start connecting to over 2000 servers around the globe.",AuthCreateSuccessTitle:"Yay! Your account is ready!",AuthcodeConTitle:"This is your Auth-Code",AuthcodeConClipboardCopied:"Auth-Code copied to clipboard",AuthcodeConClipboardClickCopy:"* Click on it to copy on clipboard *",AuthcodeConKeepSafe:"Keep it somewhere safe!",AuthcodeConClickShow:"Click here to show Auth-Code",AuthCreateSuccessDesc1:"This is your Auth-Code. Think of it as your key to your account. Please keep it somewhere safe!",AuthCreateSuccessDesc2:"You will need it to login to your account on other devices or when you logout.",AuthCreateLetsStart:"Let's start!",AuthFailed:"Authentication failed",EmailWarningTitle:"We're discontinuing support for Email & Password-Login",EmailWarningDesc:"You logged in with your email & password. Starting from next version, we are discontinuing support for Email&Password-Login. Therefore please copy your Auth-Code and keep it safe."};function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Vt(t,e,r){return(e=Jt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jt(n.key),n)}}function Jt(t){var e=function(t,e){if("object"!==Ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ht(e)?e:String(e)}const Wt=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.isRefreshing=!1,this.isLocaleRefreshing=!1,this.popupMessageHandler=this.popupMessageHandler.bind(this),chrome.storage.onChanged.addListener(this.onSettingsChanged.bind(this))}var e,r,n;return e=t,(r=[{key:"setRefreshList",value:function(t,e){var r=this;if(r.isRefreshing&&t)return t();r.isRefreshing=!0,setTimeout((function(){chrome.storage.local.get([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.LSER],(function(t){var e=t[h.STORAGEKEYS.LSER],n={isIgnoreFail:!0,userData:t[h.STORAGEKEYS.USERDATA]};it.login((function(t){r.isRefreshing=!1,(T.isResponseMinus20(t)||T.isResponseAuthError(t))&&chrome.storage.local.get([h.STORAGEKEYS.LOCALE],(function(e){var r=T.getFallbackLocale("AuthFailed",e[h.STORAGEKEYS.LOCALE],qt),n=T.isResponseMinus20(t)?t.message:r;chrome.storage.local.set(Vt({},h.STORAGEKEYS.LASTLOGOUTREASON,n),(function(){chrome.storage.local.remove([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.CONFIGDATATTL,h.STORAGEKEYS.CONFIGHARDTTL])}))})),(T.isResponseMinusOne(t)||T.isMaintenanceMode(t)||0===t)&&chrome.storage.local.get([h.STORAGEKEYS.CONFIGDATA],(function(t){var e=t[h.STORAGEKEYS.CONFIGDATA],r=!(!e||!e.config_intervals)&&e.config_intervals,n=!!T.isObject(r)&&r.soft,o=T.getConfigTTL(n,5);chrome.storage.local.set(Vt({},h.STORAGEKEYS.CONFIGDATATTL,o))})),(void 0===e||T.isResponse200(t)&&t.config&&t.config.l1ser>e)&&r.setLocaleRefresh()}),n)}))}),1e3),t()}},{key:"setLocaleRefresh",value:function(){var t=this;this.isLocaleRefreshing=!0,it.getLocale((function(){t.isLocaleRefreshing=!1}),{ignoreFail:!0})}},{key:"popupCallback",value:function(t,e,r){return function(n){t.postMessage({response:r,requestId:e,data:n})}}},{key:"popupMessageHandler",value:function(t,e,r,n){"setRefreshList"===r?this.setRefreshList(this.popupCallback(t,e,r),n):this.popupCallback(t,e,r)("")}},{key:"onSettingsChanged",value:function(t,e){var r=Object.keys(t);if(r.indexOf(h.STORAGEKEYS.CONFIGDATA)>-1&&r.indexOf(h.STORAGEKEYS.USERDATA)>-1){var n=void 0===t[h.STORAGEKEYS.USERDATA].newValue,o=void 0===t[h.STORAGEKEYS.CONFIGDATA].newValue;if(n&&o)return void kt.clearSettings()}if(r.indexOf(h.STORAGEKEYS.CONFIGDATA)>-1){var i=t[h.STORAGEKEYS.CONFIGDATA].newValue;i&&T.isObject(i)&&i.hasOwnProperty("user_status")&&i.user_status==h.STATUS.BLOCKED&&kt.clearSettings()}}}])&&Xt(e.prototype,r),n&&Xt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==zt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===zt(i)?i:String(i)),n)}var o,i}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.port=null,chrome.runtime.onConnect.addListener(this.onConnect.bind(this))}var e,r,n;return e=t,(r=[{key:"onConnect",value:function(t){"background-page-port"==t.name&&(this.port=t,this.port.onMessage.addListener(this.onMessage.bind(this)))}},{key:"onMessage",value:function(t){switch(t.request){case"api":it.popupMessageHandler(this.port,t.requestId,t.method,t.data);break;case"baseFinder":J.popupMessageHandler(this.port,t.requestId,t.method,t.data);break;case"ProxySetting":kt.popupMessageHandler(this.port,t.requestId,t.method,t.data);break;case"Management":Ct.popupMessageHandler(this.port,t.requestId,t.method,t.data);break;case"Bypasslist":Dt.popupMessageHandler(this.port,t.requestId,t.method,t.data);break;case"PermissionController":Mt.popupMessageHandler(this.port,t.requestId,t.method,t.data,t.request,t.isEvent);break;case"ConfigUpdater":Wt.popupMessageHandler(this.port,t.requestId,t.method,t.data,t.request,t.isEvent)}}}])&&Qt(e.prototype,r),n&&Qt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==$t(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===$t(i)?i:String(i)),n)}var o,i}const te=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}var e,r,n;return e=t,(r=[{key:"init",value:function(){var t=this,e=T.generateIdentifierDomain();t.identifierLink="http://"+e,t.isRunning=!1,t.current="",t.xhr=void 0,t.aborted=!1}},{key:"identify",value:function(t,e){var r=this;chrome.storage.local.get([h.STORAGEKEYS.TIMEOUTSETTINGS],(function(n){var o=n[h.STORAGEKEYS.TIMEOUTSETTINGS],i=o&&T.isTimeoutSettingValid(o.proxy_search_timeout)?o.proxy_search_timeout:m;void 0!==r.xhr&&r.xhr.abort(),r.init(),r.identifierLink=t,r.xhr=new XMLHttpRequest,r.xhr.open("GET",r.identifierLink,!0),r.xhr.timeout=i,r.xhr.onreadystatechange=function(){if(4==r.xhr.readyState){var t=r.xhr.responseText;t&&-1!=t.indexOf("ERR_INVALID_URL")?(St.tokenSuccess(),e(!0)):(St.init(),e(!1))}},r.xhr.send()}))}},{key:"abort",value:function(){null!=this.xhr&&this.xhr.abort()}},{key:"getIdentifierLink",value:function(){return this.identifierLink}}])&&Zt(e.prototype,r),n&&Zt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==ee(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===ee(i)?i:String(i)),n)}var o,i}const ne=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.timer=!1,this.func=e,this.interval=r}var e,r,n;return e=t,(r=[{key:"start",value:function(){this.isRunning()||(this.timer=setInterval(this.func,this.interval))}},{key:"stop",value:function(){clearInterval(this.timer),this.timer=!1}},{key:"isRunning",value:function(){return!1!==this.timer}},{key:"update",value:function(t){this.interval=t,this.isRunning()&&(this.stop(),this.start())}}])&&re(e.prototype,r),n&&re(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ie=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==oe(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function ae(t,e,r){return(e=le(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function se(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function ue(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){se(i,n,o,a,s,"next",t)}function s(t){se(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,le(n.key),n)}}function le(t){var e=function(t,e){if("object"!==oe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oe(e)?e:String(e)}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;e.init(),this.errorCodes=this.errorCodes=["net::ERR_PROXY_CONNECTION_FAILED","NS_ERROR_PROXY_CONNECTION_REFUSED"],this.onProxyStatusChanged=this.onProxyStatusChanged.bind(this),this.onRequestError=this.onRequestError.bind(this),this.closeDisconnectedTab=this.closeDisconnectedTab.bind(this),chrome.runtime.onConnect.addListener(this.onConnect.bind(this)),chrome.storage.onChanged.addListener(e.onSettingsChanged.bind(e)),chrome.webRequest.onErrorOccurred.addListener(e.onRequestError,{urls:["<all_urls>"]}),this.timeLeft=0,this.lastTimeLeft=60,this.opening=!1,this.updateIntervalTime=6e4,this.updateInterval=!1,this.updateInterval=new ne(this.countDown.bind(this),this.updateIntervalTime),this.lastMinuteInterval=new ne(this.lastMinuteCountDown.bind(this),500)}var e,r,n,o,i,a,s,u,c,l;return e=t,r=[{key:"init",value:function(){}},{key:"connectPort",value:function(t){var e=this;e.Port=t,e.Port.onMessage.addListener(e.onPortMessage.bind(this)),e.Port.onDisconnect.addListener(e.onPortDisconnect.bind(this))}},{key:"startSearch",value:(l=ue(ie().mark((function t(e){var r,n;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this,chrome.storage.local.set((ae(r={},h.STORAGEKEYS.PROXYSEARCHLOCK,!0),ae(r,h.STORAGEKEYS.PROXYSEARCH,{}),r),ue(ie().mark((function t(){var r,o;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.abortController=new AbortController,r=n.abortController.signal,t.prev=3,t.next=6,z.searchProxy(e,r);case 6:o=t.sent,t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(3),"CANCELED"!=t.t0){t.next=14;break}return t.abrupt("return");case 14:o?n.searchSuccess():n.searchFailed(e.countryCode);case 16:case"end":return t.stop()}}),t,null,[[3,9]])}))));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"searchSuccess",value:function(t){this.Port&&this.Port.postMessage({action:"success"})}},{key:"searchFailed",value:function(t){var e,r=this;chrome.storage.local.set((ae(e={},h.STORAGEKEYS.PROXYSEARCHFAILED,!0),ae(e,h.STORAGEKEYS.PROXYSEARCHFAILEDCOUNTRY,t),ae(e,h.STORAGEKEYS.PROXYSEARCHLOCK,!0),e),(function(){r.init(),r.Port&&r.Port.postMessage({action:"failed",data:t})}))}},{key:"resetAll",value:function(t){te.abort(),kt.clearSettings(t),this.init()}},{key:"abortSearch",value:function(){this.abortController&&this.abortController.abort("CANCLED")}},{key:"onPortMessage",value:function(t){switch(t.action){case"search":this.startSearch(t.data);break;case"cancel":this.abortSearch()}}},{key:"onPortDisconnect",value:function(){this.Port=!1}},{key:"onConnect",value:function(t){"proxysearch-port"==t.name&&this.connectPort(t)}},{key:"onSettingsChanged",value:function(t,e){var r=Object.keys(t);if(r.indexOf(h.STORAGEKEYS.CONFIGDATA)>-1&&r.indexOf(h.STORAGEKEYS.USERDATA)>-1){var n=void 0===t[h.STORAGEKEYS.USERDATA].newValue,o=void 0===t[h.STORAGEKEYS.CONFIGDATA].newValue;n&&o&&this.abortSearch()}"local"==e&&r.indexOf(h.STORAGEKEYS.ISPROXYON)>-1&&this.onProxyStatusChanged(t)}},{key:"getLeftTime",value:function(t){if(!(t&&T.isObject(t)&&t.hasOwnProperty("tinterval")&&t.tinterval.hasOwnProperty("every")&&t.tinterval.hasOwnProperty("page"))||T.isUserPremium(t))return 0;try{var e=parseInt(t.tinterval.every);return Number.isInteger(e)&&e>0?e:0}catch(t){return 0}}},{key:"lastMinuteCountDown",value:(c=ue(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lastTimeLeft=this.lastTimeLeft-1,0!=this.lastTimeLeft){t.next=8;break}return this.setBadge(" X ","#D2FF52"),this.lastMinuteInterval.stop(),t.next=6,T.setStorage(ae({},h.STORAGEKEYS.EXPIRATIONTIME,!0));case 6:return vt.set({Host:"127.0.0.1",Port:65534}),t.abrupt("return");case 8:this.lastTimeLeft%2==1?this.setBadge(this.lastTimeLeft+"","#D2FF52"):this.setBadge("","#D2FF52");case 9:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"countDown",value:(u=ue(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.timeLeft=this.timeLeft-1,!(this.timeLeft<2)){t.next=7;break}return this.updateInterval.stop(),this.lastTimeLeft=60,this.lastMinuteInterval.start(),t.abrupt("return");case 7:this.setBadge(this.timeLeft+" min","#D2FF52");case 8:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"setBadgeColor",value:function(t){return new Promise((function(e,r){chrome.browserAction.setBadgeBackgroundColor({color:t},e)}))}},{key:"setBadge",value:(s=ue(ie().mark((function t(e,r){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}return t.next=4,this.setBadgeColor(r);case 4:if(""===e){t.next=7;break}return t.next=7,T.setStorage(ae({},h.STORAGEKEYS.TIMELEFT,e));case 7:chrome.browserAction.setBadgeText({text:e+""});case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"onProxyStatusChanged",value:(a=ue(ie().mark((function t(e){var r,n,o,i,a;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this,!e.hasOwnProperty(h.STORAGEKEYS.ISPROXYON)){t.next=20;break}if(!1!==(n=e[h.STORAGEKEYS.ISPROXYON]).oldValue||!0!==n.newValue){t.next=12;break}return t.next=6,T.removeStorage(h.STORAGEKEYS.TIMELEFT);case 6:return t.next=8,T.getStorage([h.STORAGEKEYS.CONFIGDATA]);case 8:o=t.sent,i=o[h.STORAGEKEYS.CONFIGDATA],(a=r.getLeftTime(i))>0&&(r.timeLeft=a,this.setBadge(r.timeLeft+" min","#D2FF52"),a<2?this.lastMinuteInterval.start():this.updateInterval.start());case 12:if(!0!==n.oldValue||!1!==n.newValue){t.next=20;break}return this.updateInterval.stop(),this.lastMinuteInterval.stop(),this.setBadge(""),t.next=18,T.removeStorage(h.STORAGEKEYS.TIMELEFT);case 18:return t.next=20,r.closeDisconnectedTab();case 20:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"closeDisconnectedTab",value:(i=ue(ie().mark((function t(){var e,r;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,T.getStorage([h.STORAGEKEYS.CONFIGDATA]);case 3:if(e=t.sent,r=e[h.STORAGEKEYS.CONFIGDATA],T.isObject(r)&&r.hasOwnProperty("tinterval")&&r.tinterval.hasOwnProperty("page")&&!T.isUserPremium(r))try{chrome.tabs.query({url:r.tinterval.page},(function(t){t.length>0&&chrome.tabs.remove(t[0].id)}))}catch(t){}case 6:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"onRequestError",value:(o=ue(ie().mark((function t(e){var r,n,o,i,a;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=this).opening){t.next=3;break}return t.abrupt("return");case 3:return r.opening=!0,setTimeout((function(){r.opening=!1}),1500),t.next=7,T.getStorage([h.STORAGEKEYS.CONFIGDATA,h.STORAGEKEYS.EXPIRATIONTIME,h.STORAGEKEYS.ISPROXYON]);case 7:n=t.sent,o=n[h.STORAGEKEYS.ISPROXYON],i=n[h.STORAGEKEYS.EXPIRATIONTIME],a=n[h.STORAGEKEYS.CONFIGDATA],!0===o&&!0===i&&T.isObject(a)&&a.hasOwnProperty("tinterval")&&!T.isUserPremium(a)&&e&&e.error&&r.errorCodes.includes(e.error)&&"main_frame"==e.type&&chrome.tabs.query({url:a.tinterval.page},(function(t){t.length>0?chrome.tabs.update(t[0].id,{active:!0}):T.openNewTab(a.tinterval.page)}));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}],r&&ce(e.prototype,r),n&&ce(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function he(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */he=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==fe(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function pe(t,e,r){return(e=ge(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ye(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function de(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ye(i,n,o,a,s,"next",t)}function s(t){ye(i,n,o,a,s,"throw",t)}a(void 0)}))}}function ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ge(n.key),n)}}function ge(t){var e=function(t,e){if("object"!==fe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===fe(e)?e:String(e)}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;e.onAuthFirefoxHandler=this.onAuthFirefoxHandler.bind(this),e.onAuthChromeHandler=this.onAuthChromeHandler.bind(this),e.onPermissionChange=this.onPermissionChange.bind(this),D.subscribePermissionChange(e.onPermissionChange),D.isPermissionValid().then((function(t){t&&e.registerListeners()})),e.authPromise=this.authPromise.bind(this),e.asyncFirefoxHandle=this.asyncFirefoxHandle.bind(this),e.pending=[],e.onAuths=[],e.testReqRunning=!1,e.abortController=!1,e.testToken=""}var e,r,n,o,i,a,s,u,c;return e=t,r=[{key:"onPermissionChange",value:function(t){t?this.registerListeners():this.removeListeners()}},{key:"registerListeners",value:function(){var t=this;"FIREFOX"===h.PLATFORM.toUpperCase()?chrome.webRequest.onAuthRequired.hasListener(t.onAuthFirefoxHandler)||chrome.webRequest.onAuthRequired.addListener(t.onAuthFirefoxHandler,{urls:["<all_urls>"]},["blocking"]):chrome.webRequest.onAuthRequired.hasListener(t.onAuthChromeHandler)||chrome.webRequest.onAuthRequired.addListener(t.onAuthChromeHandler,{urls:["<all_urls>"]},["asyncBlocking"])}},{key:"removeListeners",value:function(){"FIREFOX"===h.PLATFORM.toUpperCase()?chrome.webRequest.onAuthRequired.removeListener(this.onAuthFirefoxHandler):chrome.webRequest.onAuthRequired.removeListener(this.onAuthChromeHandler)}},{key:"getCachedToken",value:function(t){var e=this;return new Promise((function(r,n){chrome.storage.local.get(h.STORAGEKEYS.CONFIGDATA,(function(n){var o=n[h.STORAGEKEYS.CONFIGDATA];if(o&&o.hasOwnProperty("p_login")&&o.hasOwnProperty("p_token")){var i=o.p_login,a=o.p_token,s={authCredentials:{username:i,password:t?e.testToken:a}};return r(s)}return r({cancel:!0})}))}))}},{key:"freshToken",value:(c=de(he().mark((function t(e){var r,n,o,i,a;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this,t.next=3,T.getStorage(h.STORAGEKEYS.CONFIGDATATTL);case 3:if(n=t.sent,(o=n[h.STORAGEKEYS.CONFIGDATATTL])&&!(o>T.getDateNow())){t.next=11;break}return t.next=8,T.setStorage(pe({},h.STORAGEKEYS.MARKEDCONFIG,!0));case 8:return t.next=10,this.getCachedToken(e);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,it.promiseLogin(!0);case 13:if(i=t.sent,!T.isResponse200(i)||!i.config){t.next=19;break}return a=i.config,t.abrupt("return",{authCredentials:{username:a.p_login,password:e?r.testToken:a.p_token}});case 19:return t.next=21,T.setStorage(pe({},h.STORAGEKEYS.MARKEDCONFIG,!0));case 21:return t.abrupt("return",{cancel:!0});case 22:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"letsWait",value:(u=de(he().mark((function t(){return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){setTimeout(t,15e3)})));case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"startTestReq",value:(s=de(he().mark((function t(){var e,r,n,o,i,a;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this).testReqRunning){t.next=22;break}return e.abortController=new AbortController,r=e.abortController.signal,e.testReqRunning=!0,t.next=7,z.testReq(r);case 7:(n=t.sent)||e.disconnectProxy(),o=0;case 11:if(!(o<e.pending.length)){t.next=20;break}return i=e.pending[o],t.next=15,e.getCachedToken();case 15:a=t.sent,i(n?a:{cancel:!0});case 17:o++,t.next=11;break;case 20:e.pending=[],e.testReqRunning=!1;case 22:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"disconnectProxy",value:(a=de(he().mark((function t(){var e,r,n,o,i;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt.unset();case 2:return t.next=4,T.getStorage([h.STORAGEKEYS.ISPROXYON,h.STORAGEKEYS.LOCALE]);case 4:return r=t.sent,n=r[h.STORAGEKEYS.ISPROXYON],o=r[h.STORAGEKEYS.LOCALE],n&&o&&T.showConnectionNotification(o.NotifyVPNDisconnectTitle,o.NotifyVPNDisconnectMsg),pe(e={},h.STORAGEKEYS.ISPROXYON,!1),pe(e,h.STORAGEKEYS.CURRENTPROXY,!1),i=e,t.next=11,T.setStorage(i);case 11:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"onAuthChromeHandler",value:(i=de(he().mark((function t(e,r){var n,o,i,a,s,u,c,l,f,h;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this,e.isProxy){t.next=4;break}return t.abrupt("return",r());case 4:return t.next=6,z.challengeAnswer(e);case 6:if(o=t.sent,i=o.isOur,a=o.isTest,s=o.mode,u=o.testIdCount,!i){t.next=44;break}if("pac"!=s){t.next=22;break}if(!a||0!=u){t.next=16;break}return t.next=14,this.getCachedToken();case 14:return c=t.sent,t.abrupt("return",r(c));case 16:if(!a||1!=u){t.next=21;break}return t.next=19,this.freshToken();case 19:return l=t.sent,t.abrupt("return",r(l));case 21:return t.abrupt("return",r({cancel:!0}));case 22:if("fixed"!=s){t.next=42;break}if(!a||0!=u){t.next=28;break}return t.next=26,this.getCachedToken();case 26:return f=t.sent,t.abrupt("return",r(f));case 28:if(!a||1!=u){t.next=33;break}return t.next=31,this.freshToken();case 31:return h=t.sent,t.abrupt("return",r(h));case 33:if(!(a&&u>1)){t.next=38;break}return t.next=36,n.disconnectProxy();case 36:return n.pending.forEach((function(t){t({cancel:!0})})),t.abrupt("return",r({cancel:!0}));case 38:return n.pending.push(r),n.testReqRunning||n.startTestReq(),t.abrupt("return",!0);case 42:t.next=45;break;case 44:return t.abrupt("return",r());case 45:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"asyncFirefoxHandle",value:function(t){var e=this,r=this;return new Promise(function(){var n=de(he().mark((function n(o,i){var a,s,u,c,l,f,h,p,y;return he().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,z.challengeAnswer(t);case 3:if(a=n.sent,s=a.isOur,u=a.isTest,c=a.mode,l=a.testIdCount,!s){n.next=41;break}if("pac"!=c){n.next=20;break}if(!u||0!=l){n.next=14;break}return n.next=12,e.getCachedToken();case 12:return f=n.sent,n.abrupt("return",o(f));case 14:if(!u||1!=l){n.next=19;break}return n.next=17,e.freshToken();case 17:return h=n.sent,n.abrupt("return",o(h));case 19:return n.abrupt("return",o({cancel:!0}));case 20:if("fixed"!=c){n.next=39;break}if(!u||0!=l){n.next=26;break}return n.next=24,e.getCachedToken();case 24:return p=n.sent,n.abrupt("return",o(p));case 26:if(!u||1!=l){n.next=31;break}return n.next=29,e.freshToken();case 29:return y=n.sent,n.abrupt("return",o(y));case 31:if(!(u&&l>1)){n.next=36;break}return n.next=34,r.disconnectProxy();case 34:return r.pending.forEach((function(t){t({cancel:!0})})),n.abrupt("return",o({cancel:!0}));case 36:r.testReqRunning||r.startTestReq(),r.pending.push(o);case 39:n.next=42;break;case 41:o();case 42:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())}},{key:"onAuthFirefoxHandler",value:(o=de(he().mark((function t(e){var r;return he().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this,e.isProxy){t.next=4;break}return t.abrupt("return");case 4:return t.abrupt("return",r.asyncFirefoxHandle(e));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"authPromise",value:function(){var t=this;return new Promise((function(e,r){t.pending.push(e)}))}}],r&&ve(e.prototype,r),n&&ve(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());var me=function(t,e){var r=t[0],n=t[1],o=t[2],i=t[3];r=be(r,n,o,i,e[0],7,-680876936),i=be(i,r,n,o,e[1],12,-389564586),o=be(o,i,r,n,e[2],17,606105819),n=be(n,o,i,r,e[3],22,-1044525330),r=be(r,n,o,i,e[4],7,-176418897),i=be(i,r,n,o,e[5],12,1200080426),o=be(o,i,r,n,e[6],17,-1473231341),n=be(n,o,i,r,e[7],22,-45705983),r=be(r,n,o,i,e[8],7,1770035416),i=be(i,r,n,o,e[9],12,-1958414417),o=be(o,i,r,n,e[10],17,-42063),n=be(n,o,i,r,e[11],22,-1990404162),r=be(r,n,o,i,e[12],7,1804603682),i=be(i,r,n,o,e[13],12,-40341101),o=be(o,i,r,n,e[14],17,-1502002290),n=be(n,o,i,r,e[15],22,1236535329),r=Se(r,n,o,i,e[1],5,-165796510),i=Se(i,r,n,o,e[6],9,-1069501632),o=Se(o,i,r,n,e[11],14,643717713),n=Se(n,o,i,r,e[0],20,-373897302),r=Se(r,n,o,i,e[5],5,-701558691),i=Se(i,r,n,o,e[10],9,38016083),o=Se(o,i,r,n,e[15],14,-660478335),n=Se(n,o,i,r,e[4],20,-405537848),r=Se(r,n,o,i,e[9],5,568446438),i=Se(i,r,n,o,e[14],9,-1019803690),o=Se(o,i,r,n,e[3],14,-187363961),n=Se(n,o,i,r,e[8],20,1163531501),r=Se(r,n,o,i,e[13],5,-1444681467),i=Se(i,r,n,o,e[2],9,-51403784),o=Se(o,i,r,n,e[7],14,1735328473),n=Se(n,o,i,r,e[12],20,-1926607734),r=we(r,n,o,i,e[5],4,-378558),i=we(i,r,n,o,e[8],11,-2022574463),o=we(o,i,r,n,e[11],16,1839030562),n=we(n,o,i,r,e[14],23,-35309556),r=we(r,n,o,i,e[1],4,-1530992060),i=we(i,r,n,o,e[4],11,1272893353),o=we(o,i,r,n,e[7],16,-155497632),n=we(n,o,i,r,e[10],23,-1094730640),r=we(r,n,o,i,e[13],4,681279174),i=we(i,r,n,o,e[0],11,-358537222),o=we(o,i,r,n,e[3],16,-722521979),n=we(n,o,i,r,e[6],23,76029189),r=we(r,n,o,i,e[9],4,-640364487),i=we(i,r,n,o,e[12],11,-421815835),o=we(o,i,r,n,e[15],16,530742520),n=we(n,o,i,r,e[2],23,-995338651),r=Ae(r,n,o,i,e[0],6,-198630844),i=Ae(i,r,n,o,e[7],10,1126891415),o=Ae(o,i,r,n,e[14],15,-1416354905),n=Ae(n,o,i,r,e[5],21,-57434055),r=Ae(r,n,o,i,e[12],6,1700485571),i=Ae(i,r,n,o,e[3],10,-1894986606),o=Ae(o,i,r,n,e[10],15,-1051523),n=Ae(n,o,i,r,e[1],21,-2054922799),r=Ae(r,n,o,i,e[8],6,1873313359),i=Ae(i,r,n,o,e[15],10,-30611744),o=Ae(o,i,r,n,e[6],15,-1560198380),n=Ae(n,o,i,r,e[13],21,1309151649),r=Ae(r,n,o,i,e[4],6,-145523070),i=Ae(i,r,n,o,e[11],10,-1120210379),o=Ae(o,i,r,n,e[2],15,718787259),n=Ae(n,o,i,r,e[9],21,-343485551),t[0]=Le(r,t[0]),t[1]=Le(n,t[1]),t[2]=Le(o,t[2]),t[3]=Le(i,t[3])},Ee=function(t,e,r,n,o,i){return e=Le(Le(e,t),Le(n,i)),Le(e<<o|e>>>32-o,r)},be=function(t,e,r,n,o,i,a){return Ee(e&r|~e&n,t,e,o,i,a)},Se=function(t,e,r,n,o,i,a){return Ee(e&n|r&~n,t,e,o,i,a)},we=function(t,e,r,n,o,i,a){return Ee(e^r^n,t,e,o,i,a)},Ae=function(t,e,r,n,o,i,a){return Ee(r^(e|~n),t,e,o,i,a)},Oe=function(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r},Te="0123456789abcdef".split(""),Re=function(t){for(var e="",r=0;r<4;r++)e+=Te[t>>8*r+4&15]+Te[t>>8*r&15];return e},xe=function(t){return function(t){for(var e=0;e<t.length;e++)t[e]=Re(t[e]);return t.join("")}(function(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)me(n,Oe(t.substring(e-64,e)));t=t.substring(e-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)o[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(me(n,o),e=0;e<16;e++)o[e]=0;return o[14]=8*r,me(n,o),n}(t))},Le=function(t,e){return t+e&4294967295};if("5d41402abc4b2a76b9719d911017c592"!=xe("hello"))Le=function(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r};const ke=xe;function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function _e(t,e,r){return(e=Ce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ce(n.key),n)}}function Ce(t){var e=function(t,e){if("object"!==Ie(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Ie(e)?e:String(e)}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;this.init(),this.qSize=10,this.batchSize=100,this.entryMaxLength=1e5,this.batchMaxLength=7e5,this.qMaxSize=2e6,this.sendInterval=9e5,this.batchInterval=new ne(e.sendCache.bind(this),this.sendInterval),this.batchInterval.start(),this.autoProxy=[],this.returnedBatches=[],this.isCaching=!1,this.isSending=!1,this.checkProxyTimeout=!1,this.sendCacheTimeout=!1,this.recacheBatchesTimeout=!1,e.onRequestError=this.onRequestError.bind(this),e.onPermissionChange=this.onPermissionChange.bind(this),e.checkProxy=this.checkProxy.bind(this),D.subscribePermissionChange(e.onPermissionChange),D.isPermissionValid().then((function(t){t&&e.registerListeners()}))}var e,r,n;return e=t,(r=[{key:"onPermissionChange",value:function(t){t?this.registerListeners():this.removeListeners()}},{key:"registerListeners",value:function(){chrome.webRequest.onErrorOccurred.hasListener(this.onRequestError)||chrome.webRequest.onErrorOccurred.addListener(this.onRequestError,{urls:["<all_urls>"]})}},{key:"removeListeners",value:function(){chrome.webRequest.onErrorOccurred.removeListener(this.onRequestError)}},{key:"init",value:function(){var t=this;t.autoProxy=[],t.isRunning=!1,t.current=""}},{key:"check",value:function(t){var e=this;t&&e.getOriginUrl(t).then((function(r){e.getUserTag().then((function(n){t.referer=r,t.errorSource=n,t.s=e.getEntrySize(t),e.autoProxy.length>1e3&&(e.autoProxy=[]),e.isEntrySizeValid(t.s)&&(e.autoProxy.push(t),e.checkProxy())}))}))}},{key:"getEntrySize",value:function(t){try{var e=JSON.stringify(t).length;return e||-1}catch(t){return-1}}},{key:"isEntrySizeValid",value:function(t){return t<this.entryMaxLength}},{key:"addItemToQ",value:function(t,e,r){var n=this;if(t&&Array.isArray(t)||(t=[]),0===t.length){var o={s:e.s,b:[e]};t.push(o)}else{(t.length>=n.qSize||r>n.qMaxSize)&&t.shift();var i=t[t.length-1];i.b.length>=n.batchSize||i.s+e.s>n.batchMaxLength?(o={s:e.s,b:[e]},t.push(o)):(i.s+=e.s,i.b.push(e))}return t}},{key:"addBatchToQ",value:function(t,e,r){var n=this;if(e&&Array.isArray(e))return e.forEach((function(e){t=n.addItemToQ(t,e,r)})),t}},{key:"pushToCache",value:function(t){var e=this;return new Promise((function(r,n){e.getBytesInUse(h.STORAGEKEYS.RCACHE).then((function(o){chrome.storage.local.get(h.STORAGEKEYS.RCACHE,(function(i){try{var a=i[h.STORAGEKEYS.RCACHE];if(Array.isArray(t))a=e.addBatchToQ(a,t,o);else{var s=Object.assign({},t);s.cv=h.VERSION,a=e.addItemToQ(a,s,o)}chrome.storage.local.set(_e({},h.STORAGEKEYS.RCACHE,a),(function(){r(t)}))}catch(t){n(t)}}))}))}))}},{key:"getBytesInUse",value:function(t){var e=this;return"firefox"==h.PLATFORM.toLowerCase()?new Promise((function(r,n){chrome.storage.local.get(t,(function(n){r(e.getEntrySize(n[t]))}))})):new Promise((function(e,r){try{chrome.storage.local.getBytesInUse(t,(function(t){e(t)}))}catch(t){e(0)}}))}},{key:"getOriginUrl",value:function(t){var e=this;return new Promise((function(r,n){return t?t&&t.hasOwnProperty("originUrl")&&t.originUrl?r(T.escapeParamsOfUrl(t.originUrl)):chrome&&chrome.tabs&&chrome.tabs.get&&t.hasOwnProperty("tabId")&&e.isInt(t.tabId)&&t.tabId>0?void chrome.tabs.get(t.tabId,(function(t){return r(T.escapeParamsOfUrl(t.url))})):r(""):r("")}))}},{key:"getUserTag",value:function(){return new Promise((function(t,e){chrome.storage.local.get(h.STORAGEKEYS.CONFIGDATA,(function(e){return e&&e[h.STORAGEKEYS.CONFIGDATA]?t(e[h.STORAGEKEYS.CONFIGDATA].uid):t("")}))}))}},{key:"doneCaching",value:function(){this.isCaching=!1,this.checkProxy()}},{key:"checkProxy",value:function(){var t=this;if(0!=t.autoProxy.length)if(t.isCaching)clearTimeout(t.checkProxyTimeout),t.checkProxyTimeout=setTimeout(t.checkProxy.bind(t),500);else{var e=t.autoProxy.pop();e.url=T.escapeParamsOfUrl(e.url),t.isCaching=!0,t.checkIsCached(e.url).then((function(r){if(r)t.doneCaching();else try{e.cacheTime=T.getDateNow(),t.pushToCache(e).then((function(){t.doneCaching()})).catch((function(e){t.doneCaching()}))}catch(e){t.doneCaching()}})).catch((function(e){t.doneCaching()}))}}},{key:"isInt",value:function(t){var e;return!isNaN(t)&&(0|(e=parseFloat(t)))===e}},{key:"checkIsCached",value:function(t){return new Promise((function(e,r){chrome.storage.local.get([h.STORAGEKEYS.HASHCACHE,h.STORAGEKEYS.BYPASSHOSTS],(function(n){var o=n[h.STORAGEKEYS.BYPASSHOSTS];try{var i=ke(t),a=new URL(t);if(null!=t.match(h.TESTREQUESTREGEX)||o&&Array.isArray(o)&&o.includes(a.hostname))return e(!0);var s=n[h.STORAGEKEYS.HASHCACHE],u=T.getDateMid();if(null!=s&&void 0!==s[u]&&void 0!==s[u][i]&&s[u][i]>=T.getDateNow())return e(!0);var c=null!=s?s:{};Object.keys(c).length>=10&&(c={});var l=T.getDateNow()-172800;Object.keys(c).forEach((function(t,e){if(c.hasOwnProperty(t)){var r=parseInt(t);(!T.isInt(r)||r<l)&&delete c[t]}})),void 0===c[u]&&(c[u]={}),void 0===c[u].length&&(c[u].length=0),c[u].length>1e3&&(c[u]={}),c[u].length+=1,c[u][i]=T.getDateNow()+3600,chrome.storage.local.set(_e({},h.STORAGEKEYS.HASHCACHE,c),(function(){e(!1)}))}catch(t){r(t)}}))}))}},{key:"recacheBatches",value:function(){var t=this;if(0!==t.returnedBatches.length){if(t.isCaching)return clearTimeout(t.recacheBatchesTimeout),void(t.recacheBatchesTimeout=setTimeout(t.recacheBatches.bind(this),500));t.isCaching=!0;var e=t.returnedBatches.pop();t.pushToCache(e).then((function(){t.isCaching=!1})).catch((function(e){t.isCaching=!1,t.recacheBatches()}))}}},{key:"isResponseValid",value:function(t){return!!t&&!!(t.hasOwnProperty("saved")&&t.hasOwnProperty("received")&&t.hasOwnProperty("retcode"))&&200===t.retcode&&!(!T.isInt(t.saved)||!T.isInt(t.received))}},{key:"getAllNotSaved",value:function(t,e){return t.saved===t.received?[]:t.saved<e.length?e.slice(t.saved):[]}},{key:"sendCache",value:function(){var t=this;t.isSending||(t.isCaching&&(clearTimeout(t.sendCacheTimeout),t.sendCacheTimeout=setTimeout(t.sendCache.bind(t),500)),t.isSending=!0,t.isCaching=!0,t.popCurrentBatch().then((function(e){t.verifyProxy(e).then((function(r){if(t.isCaching=!1,t.isSending=!1,t.isResponseValid(r)){var n=t.getAllNotSaved(r,e);n.length>0?(t.returnedBatches.push(n),t.recacheBatches()):t.sendCache()}else{if(r&&201===r.retcode)return;t.returnedBatches.push(e),t.recacheBatches()}})).catch((function(e){t.isSending=!1,t.isCaching=!1}))})).catch((function(e){t.isSending=!1,t.isCaching=!1})))}},{key:"popCurrentBatch",value:function(){return new Promise((function(t,e){chrome.storage.local.get([h.STORAGEKEYS.RCACHE,h.STORAGEKEYS.BASELINK,h.STORAGEKEYS.BASELINKTYPE],(function(r){try{var n=r[h.STORAGEKEYS.BASELINK],o=r[h.STORAGEKEYS.BASELINKTYPE];if(void 0===n)return e();if(void 0===o&&n.indexOf(h.SHORTNAME+"/client/")>-1)return e();var i=r[h.STORAGEKEYS.RCACHE];if(!i||!Array.isArray(i)||Array.isArray(i)&&0===i.length)return e();var a=i.pop().b;chrome.storage.local.set(_e({},h.STORAGEKEYS.RCACHE,i),(function(){try{a.forEach((function(t,e){a[e].cacheTime&&a[e].cacheTime<T.getDateNow()?a[e].timedelta=T.getDateNow()-a[e].cacheTime:a[e].timedelta=0})),t(a)}catch(t){e(t)}}))}catch(t){e(t)}}))}))}},{key:"verifyProxy",value:function(t){return new Promise((function(e,r){try{var n={batch:JSON.stringify(t)};it.verifyProxy((function(t){e(t)}),n)}catch(t){r(t)}}))}},{key:"onRequestError",value:function(t){t&&(t.error==h.ERRORCODES.VERIFYERROR||void 0!==h.ERRORCODES.VERIFYERROR2&&t.error==h.ERRORCODES.VERIFYERROR2)&&this.check(t)}}])&&Pe(e.prototype,r),n&&Pe(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Ne(t){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ne(t)}function Ge(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return Ye(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ye(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ke(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ke=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==Ne(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function je(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==Ne(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===Ne(i)?i:String(i)),n)}var o,i}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.originId=this.getOriginId(),this.setOriginStripListener(),this.updateIntervalTime=36e5,this.updateInterval=!1,this.updateInterval=new ne(this.getTiers.bind(this),this.updateIntervalTime),this.updateInterval.start(),this.getTiers()}var e,r,n,o,i;return e=t,r=[{key:"getOriginId",value:function(){var t=chrome.runtime.id;try{if("firefox"===h.PLATFORM.toLowerCase()){var e=new URL(browser.runtime.getURL(""));e&&e.origin&&(t=e.origin)}}catch(t){}return t}},{key:"getTiers",value:(o=Ke().mark((function t(){return Ke().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it.isReady();case 2:it.getTier();case 3:case"end":return t.stop()}}),t)})),i=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function a(t){je(i,r,n,a,s,"next",t)}function s(t){je(i,r,n,a,s,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"setOriginStripListener",value:function(){var t=this,e=["blocking","requestHeaders"];"chrome"===h.PLATFORM.toLowerCase()&&e.push("extraHeaders"),chrome.webRequest.onBeforeSendHeaders.hasListener(t.stripOrigin)&&chrome.webRequest.onBeforeSendHeaders.removeListener(t.stripOrigin);try{chrome.webRequest.onBeforeSendHeaders.addListener(t.stripOrigin.bind(t),{urls:["*://*/*"]},e)}catch(t){}}},{key:"stripOrigin",value:function(t){var e,r=[],n=Ge(t.requestHeaders);try{for(n.s();!(e=n.n()).done;){var o=e.value;o&&o.name&&"origin"===o.name.toLowerCase()&&o.value&&o.value.toLowerCase().includes(this.originId)||r.push(o)}}catch(t){n.e(t)}finally{n.f()}return{requestHeaders:r}}}],r&&Be(e.prototype,r),n&&Be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Ue(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ue=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==De(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Fe(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==De(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===De(i)?i:String(i)),n)}var o,i}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.updateIntervalTime=36e5,this.updateInterval=!1,this.updateInterval=new ne(this.getClientVersionStatus.bind(this),this.updateIntervalTime),this.updateInterval.start(),this.getClientVersionStatus()}var e,r,n,o,i;return e=t,r=[{key:"getClientVersionStatus",value:(o=Ue().mark((function t(){return Ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it.isReady();case 2:it.getClientVersionStatus();case 3:case"end":return t.stop()}}),t)})),i=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function a(t){Fe(i,r,n,a,s,"next",t)}function s(t){Fe(i,r,n,a,s,"throw",t)}a(void 0)}))},function(){return i.apply(this,arguments)})}],r&&Me(e.prototype,r),n&&Me(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function He(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */He=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function c(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),s=new T(o||[]);return n(a,"_invoke",{value:S(t,r,s)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function y(){}var d={};u(d,i,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(R([])));g&&g!==e&&r.call(g,i)&&(d=g);var m=y.prototype=h.prototype=Object.create(d);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,i,a,s){var u=l(t[n],t,i);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==qe(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,s)}),(function(t){o("throw",t,a,s)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return o("throw",t,a,s)}))}s(u.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function S(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return x()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y,n(m,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:p,configurable:!0}),p.displayName=u(y,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(b.prototype),u(b.prototype,a,(function(){return this})),t.AsyncIterator=b,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new b(c(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,i,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=R,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:R(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Ve(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function Xe(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ve(i,n,o,a,s,"next",t)}function s(t){Ve(i,n,o,a,s,"throw",t)}a(void 0)}))}}function Je(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,We(n.key),n)}}function We(t){var e=function(t,e){if("object"!==qe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===qe(e)?e:String(e)}new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isRunning=!1,this.intervalMin=5,this.isDev=60,this.updateInterval=new ne(this.update.bind(this),this.intervalMin*this.isDev*1e3),chrome.storage.onChanged.addListener(this.onStorageChanged.bind(this))}var e,r,n,o,i;return e=t,r=[{key:"update",value:(i=Xe(He().mark((function t(){var e,r,n,o;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isRunning){t.next=2;break}return t.abrupt("return");case 2:return this.isRunning=!0,t.next=5,this.fetchToken();case 5:if(e=t.sent,!T.isResponseMinus20(e)){t.next=10;break}return t.next=9,T.removeStorage([h.STORAGEKEYS.USERDATA,h.STORAGEKEYS.CONFIGDATA]);case 9:kt.clearSettings();case 10:if(!(T.isResponse200(e)&&e.hasOwnProperty("config")&&T.isObject(e.config))){t.next=19;break}return t.next=13,T.getStorage([h.STORAGEKEYS.CONFIGDATA]);case 13:if(r=t.sent,!(n=r[h.STORAGEKEYS.CONFIGDATA])||!T.isObject(n)){t.next=19;break}return o=Object.assign({},n,e.config),t.next=19,T.setStorage((i={},a=h.STORAGEKEYS.CONFIGDATA,s=o,(a=We(a))in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,i));case 19:this.isRunning=!1;case 20:case"end":return t.stop()}var i,a,s}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"fetchToken",value:(o=Xe(He().mark((function t(){var e,r;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new AbortController,t.prev=1,t.next=4,z.refreshToken(e);case 4:r=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1);case 10:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t,null,[[1,7]])}))),function(){return o.apply(this,arguments)})},{key:"getRefreshValue",value:function(t){if(!t||"object"!==qe(t)||!t.config_intervals)return 5;var e=t.config_intervals;if("object"!==qe(e)||void 0===e.refresh)return 5;var r=e.refresh;return"number"!=typeof r||r<5||r>100?5:r}},{key:"onStorageChanged",value:function(t,e){if("local"==e&&(t.hasOwnProperty(h.STORAGEKEYS.ISPROXYON)&&(t[h.STORAGEKEYS.ISPROXYON].newValue?this.updateInterval.start():this.updateInterval.stop()),t.hasOwnProperty(h.STORAGEKEYS.CONFIGDATA))){var r=t[h.STORAGEKEYS.CONFIGDATA].newValue,n=this.getRefreshValue(r);n!==this.intervalMin&&(this.intervalMin=n,this.updateInterval.update(this.intervalMin*this.isDev*1e3))}}}],r&&Je(e.prototype,r),n&&Je(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());document.ClientMeta=h,document.Endpoints=p,document.ProxyApi=vt,document.parseJson=function(t){try{return JSON.parse(t)}catch(t){return!1}}})()})();