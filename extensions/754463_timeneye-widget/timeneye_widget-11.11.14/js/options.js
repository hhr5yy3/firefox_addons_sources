TECA.defineClass("Options",{domReady:function(){var e="<span style='background-image: url(\""+chrome.runtime.getURL("images/icon48.png")+"\")'></span>";jQuery("#timeneye_widget_cont").html(TECA.Gui.jhtml("options/options_body",{timeneyeIcon:e})),TECA._.weareContentHosted=!0,TECA.Gui.message.init(),jQuery("select").selectpicker(),jQuery('[data-toggle="popover"]',jQuery("body")).popover({template:'<div class="popover popover-dark top" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),this.fillOptions(),this.fillServiceSettings(),this.fillModulesStyle(),jQuery("#teAddService").on("click",this.addPattern),jQuery("#teSaveOptions").on("click",this.saveOptions),jQuery("#closePage, #teCancel").on("click",(function(){window.close()}))},fillOptions:function(){var e=jQuery.extend({},TECA._.fixed_urlPattern),t="";for(var i in e)e.hasOwnProperty(i)&&TECA._.additional_urlPatterns.hasOwnProperty(i)&&(e[i]=e[i].concat(TECA._.additional_urlPatterns[i]));for(var i in e)if(e.hasOwnProperty(i)){t+='<div class="service-name" data-te-service="'+i+'">'+TECA.Gui.ucFirst(i);for(var r=0,n=e[i].length;r<n;r++)t+="<div>"+e[i][r],-1==TECA._.fixed_urlPattern[i].indexOf(e[i][r])&&(t+='<span class="te-delete-service"><i class="icon iconeye iconeye-android-close"></i></span>'),t+="</div>";t+="</div>"}jQuery("#teServiceList").html(t),jQuery(".te-scroll-cont").perfectScrollbar(),jQuery(".te-delete-service").unbind("click").on("click",TECA.Options.removePattern)},fillServiceSettings:function(){var e=jQuery("#te_entitiesConf");jQuery("select",e).each((function(){var e=jQuery(this).data("te-service");jQuery(this).val(TECA._.serviceSettings[e]).on("change",(function(){TECA._.serviceSettings[e]=jQuery(this).val()}))})).selectpicker("refresh"),jQuery("input",e).each((function(){var e=jQuery(this).data("te-entity");jQuery(this).val(TECA._.serviceSettings.zendesk[e]).on("change",(function(){TECA._.serviceSettings.zendesk[e]=jQuery(this).val()}))}))},fillModulesStyle:function(){var e=jQuery("#te_integrationModules");jQuery("select",e).each((function(){var e=jQuery(this).data("te-service");jQuery(this).val(TECA._.modulesStyle[e]).on("change",(function(){TECA._.modulesStyle[e]=jQuery(this).val()}))})).selectpicker("refresh")},addPattern:function(){var e,t=jQuery("#teNewService"),i=jQuery("#teIntegrationName").val(),r=jQuery.extend(!0,{},TECA._.fixed_urlPattern),n=t.val().trim();for(var a in r)r.hasOwnProperty(a)&&TECA._.additional_urlPatterns.hasOwnProperty(a)&&(r[a]=r[a].concat(TECA._.additional_urlPatterns[a]));(e=function(){var e={valid:!0,error:null};if(""!=n.replace(/ /g,"")){var t=n.split("://");if(2==t.length&&t[1].split("/").length>1)for(var i in r)r.hasOwnProperty(i)&&-1!=r[i].indexOf(n)&&(e.valid=!1,e.error="This service is already included");else e.valid=!1,e.error="Invalid url pattern"}else e.valid=!1,e.error="Impossible to include a void service";return e}()).valid?(void 0===TECA._.additional_urlPatterns[i]&&(TECA._.additional_urlPatterns[i]=[]),TECA._.additional_urlPatterns[i].push(n),jQuery('.service-name[data-te-service="'+i+'"]').append("<div>"+n+'<span class="te-delete-service"><i class="icon iconeye iconeye-android-close"></i></span></div>'),jQuery(".te-delete-service").unbind("click").on("click",TECA.Options.removePattern),t.val("")):null!=e.error&&TECA.Gui.message.danger(e.error)},removePattern:function(){var e=jQuery(this).parent().text().trim(),t=jQuery(this).parents(".service-name").data("te-service"),i=TECA._.additional_urlPatterns.hasOwnProperty(t)?TECA._.additional_urlPatterns[t].indexOf(e):-1;i>-1&&TECA._.additional_urlPatterns[t].splice(i,1),jQuery(this).parent().remove()},saveOptions:function(){chrome.storage.sync.set({additionalPatterns:TECA._.additional_urlPatterns,serviceSettings:TECA._.serviceSettings,modulesStyle:TECA._.modulesStyle},(function(){window.close()}))}});
//# sourceMappingURL=options.js.map