var guid;(e=>{(e.NSSS=e.NSSS||{}).chromeGlobal=((o,r)=>{var a={},s=o.logger,d=r.helperUtils,c=r.uiHelper,e=r.nfmEvents,t=o.utils.isNil,S=o.utils.isntNil,n=r.constants,i=r.webProtection,E=o.localizer,R=(r.uiConstants.MESSAGES,o.extensionAdapter);r.uiConstants.BLOCKPAGE.TYPE;let T=r.NSSSHelper,l=o.constants.BROWSER_TYPE,g=r.uiConstants;var u=SafeWeb.Rating.SITE_RATING;let m=r.telemetryWrapper,_=r.telemetryTrackerClient,A=r.trackerLogger;return a.THREE_IN_ONE_EXTENSION=!1,a.updatePopoverUI=function(l){R.getActiveTab(async function(e){var a,t,n,i=R.getLastError();S(i)?(s.log("Tab is not available"),s.log(i),A.logger.log("Tab is not available"+A.errorToString(i))):(i=R.getTabID(e),t=await r.extensionURLValidator.isNortonExtensionURL(e.url),a=o.localizer.getCurrentLanguageDirection(),n=T.isBlockPage(e.url),t&&!n?(t=null,t={annoyanceThreats:0,computerThreats:0,identityThreats:0,rating:1,ratingText:o.localizer.getLocalizedString("Safe"),showSafeWebSearchbox:!1,sitename:e.url,totalThreats:0},n=r.main.popoverWindowStrings(1),l({popoverStrings:n,uiStatus:t,showReportSite:!1,showFullReport:!1,direction:a})):(n=d.getSessionIDForTabID(i),(i=(t=c.uiStatusForSessionID(n,e.url)).uiStatus).customizedRating=r.chromeGlobal._getSiteRating(t.siteRating),n=r.main.popoverWindowStrings(i.rating,t.siteRating),e=t.showFullReport,l({popoverStrings:n,uiStatus:i,showReportSite:!1,showFullReport:e,direction:a})))})},a._getSiteRating=a=>{if(!t(a)){let e=null;switch(a){case u.RATING_REGIONAL_BLOCK:e="suspiciousRegionBlock";break;case n.FORMJACK_PROTECTION.SITE_RATING.FORMJACK_STATE:e="formjackProtection"}return e}},a.downloadURLAnalyzedCallback=function(a,e,t){var n=t.getRating();if(S(n.redirectPage)){chrome.downloads.cancel(a),chrome.downloads.removeFile(a);chrome.downloads.erase({id:a});var a=E.getLocalizedString("Malicious Download Detected"),i=E.getLocalizedString("Download Cancelled"),l=E.getLocalizedString("OK"),i=new o.QuestionNotification(i,{},l,()=>{},"content/images/icon-downloadblocked.png",a);o.notificationCenter.addNotification(i);let e=!1;S(t._safeWebResult)&&S(t._safeWebResult.finalRedirectedTabUrl)&&(e=d.isRatingForFinalRedirectedUrl(t._safeWebResult));l=r.main.getParentUrlForDownloadBlock(n.url);m.sendDownloadBlockTelemetry(n.url,e,l),_.sendDownloadBlockTelemetry(n.url,e,l)}},a.initialize=function(){!r.isFreshInstall&&r.NSSSHelper._resolveOnUrlParamsSet&&r.NSSSHelper._resolveOnUrlParamsSet(),R.isManifestV3Extension()&&!0===a.THREE_IN_ONE_EXTENSION&&(d.handleOmniSearch(),chrome.webRequest.onBeforeRequest.addListener(r.NSSSHelper.handleOmniSearchMv3,{urls:[r.constants.SEARCH_URL+"?omnisearch=yes*"]})),i.registerEventCallback(e.PAGE_ANALYZED,r.main.pageAnalyzedCallback),i.registerEventCallback(e.SEARCH_URLS_ANALYZED,r.main.searchURLsAnalyzedCallback),o.globals.BROWSER===o.constants.BROWSER_TYPE.FIREFOX&&g.EXTENSION_TYPE===g.THREE_IN_ONE||r.main.handleTelemetryOptOut(),!0===a.THREE_IN_ONE_EXTENSION&&(r.globalSettings.getValue(n.IS_HP_FIRST_LAUNCH),R.isManifestV3Extension()||chrome.webRequest.onBeforeRequest.addListener(r.main.handleOmniSearchEvent,{urls:[r.constants.SEARCH_URL+"?omnisearch=yes*"]},["blocking"]),r.main.initVendorConstants()),R.isManifestV3Extension()||r.isFreshInstall||r.init.updateAntiTrackerStatus(),o.globals.BROWSER!==l.CHROME&&o.globals.BROWSER!==l.FIREFOX||R.getActiveTab(e=>{t(e)||t(e.id)}),r.isFreshInstall||(o.globals.BROWSER===l.EDGE?R.getAllTabs(e=>{e.forEach(e=>{var a;T.isLandingPageURL(e.url)&&(a=R.getTabID(e),R.updateTabUrl(a,e.url))})}):r.main.injectWebCommunication())},a._alarmHandler=async function(e){switch(await r.init.ready(),e){case n.ALARM_NAMES.FETCH_ANTI_TRACKER_STATUS:case n.ALARM_NAMES.PERIODIC_ANTI_TRACKER_SCHEDULER:r.antiTrackerStatusProvider.handleAntiTrackerScheduler(e);break;case n.ALARM_NAMES.TELEMETRY_NOTIFICATION:r.main.setTelemetryNotification();break;case n.ALARM_NAMES.TELEMETRY_NOTIFICATION_AUTOHIDE:r.main.hideTelemetryNotifcation();break;case n.ALARM_NAMES.TELEMETRY_NOTIFICATION_DUE_CHECK_WAKEUP:r.main.checkTelemetryNotificationDueElapsed();break;case n.ALARM_NAMES.FORMJACK_TOUR_SCHEDULER:r.formjackTourBG.handleTourDisplayScheduler(e)}},a._alarmCallback=e=>{a._alarmHandler(e.name)},a._addEventListeners=()=>{o.alarmHelper.registerAlarmListener(a._alarmCallback),R.addTabRemovedEventListener(r.main.handleClose),R.addTabActivatedEventListener(r.main.handleActivate),R.addTabUpdatedEventListener(r.main.handleOnUpdated),R.addMessageListener(r.main.handleMessage),S(chrome.downloads)&&(chrome.downloads.onCreated.addListener(r.main.analyzeDownloadPage),i.registerEventCallback(e.DOWNLOAD_URL_ANALYZED,a.downloadURLAnalyzedCallback))},a.load=function(){a._addEventListeners(),chrome.webNavigation.onTabReplaced.addListener(r.main.handleTabReplaced),r.init.ready().then(a.initialize,function(e){s.error(e),A.logEvent(A.LOG_TYPE.ERROR,""+A.errorToString(e))})},a.loadExtension=async function(){R.isManifestV3Extension()||await T.waitForWindowLoadEvent(),a.load()},a})(e.SymBfw,e.NSSS)})(executionContext),SymBfw.utils.isntNil(chrome.runtime.onInstalled)?chrome.runtime.onInstalled.addListener(NSSS.main.handleInstall):(guid=NSSS.globalSettings.getValue(NSSS.constants.NSSS_INSTALLDATEKEY),SymBfw.utils.isNil(guid)&&setTimeout(function(){NSSS.main.handleInstall({reason:"install"})},5e3)),NSSS.chromeGlobal.loadExtension();