(self.webpackChunkchrome_extension=self.webpackChunkchrome_extension||[]).push([[17],{88319:(e,t,r)=>{"use strict";r.d(t,{H:()=>s,N:()=>a});var n=r(34549),o=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=new n.C("Amplify"),a=function(){function e(){this._components=[],this._config={},this._modules={},this.Auth=null,this.Analytics=null,this.API=null,this.Credentials=null,this.Storage=null,this.I18n=null,this.Cache=null,this.PubSub=null,this.Interactions=null,this.Pushnotification=null,this.UI=null,this.XR=null,this.Predictions=null,this.DataStore=null,this.Geo=null,this.Notifications=null,this.Logger=n.C,this.ServiceWorker=null}return e.prototype.register=function(e){i.debug("component registered in amplify",e),this._components.push(e),"function"==typeof e.getModuleName?(this._modules[e.getModuleName()]=e,this[e.getModuleName()]=e):i.debug("no getModuleName method for component",e),e.configure(this._config)},e.prototype.configure=function(e){var t=this;return e?(this._config=Object.assign(this._config,e),i.debug("amplify config",this._config),Object.entries(this._modules).forEach((function(e){var r=o(e,2),n=(r[0],r[1]);Object.keys(n).forEach((function(e){t._modules[e]&&(n[e]=t._modules[e])}))})),this._components.map((function(e){e.configure(t._config)})),this._config):this._config},e.prototype.addPluggable=function(e){e&&e.getCategory&&"function"==typeof e.getCategory&&this._components.map((function(t){t.addPluggable&&"function"==typeof t.addPluggable&&t.addPluggable(e)}))},e}(),s=new a},42438:(e,t,r)=>{"use strict";r.d(t,{O:()=>c,s:()=>u});var n=r(82622),o=r(16824),i=r(98641),a=r(26170),s=r(71805),u={service:"mobiletargeting",endpointResolver:function(e){var t=e.region;return{url:new URL("https://pinpoint.".concat(t,".").concat((0,n.R)(t)))}},retryDecider:(0,o.D)(a.F),computeDelay:i.y,userAgentValue:(0,s.fE)()},c=function(){return{"content-type":"application/json"}}},87821:(e,t,r)=>{"use strict";r.d(t,{j:()=>d});var n=r(37939),o=r(55841),i=r(64169),a=r(26170),s=r(64603),u=r(42438),c=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},d=(0,o.A)(n.C,(function(e,t){var r=e.ApplicationId,n=e.EndpointId,o=(0,u.O)(),a=new URL(t.url);return a.pathname="v1/apps/".concat((0,i.$)(r),"/endpoints/").concat((0,i.$)(n),"/inappmessages"),{method:"GET",headers:o,url:a}}),(function(e){return c(void 0,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return e.statusCode>=300?[4,(0,a.F)(e)]:[3,2];case 1:throw t.sent();case 2:return[4,(0,a.Y)(e)];case 3:return[2,{InAppMessagesResponse:{InAppMessageCampaigns:t.sent().InAppMessageCampaigns},$metadata:(0,s.j)(e)}]}}))}))}),u.s)},25471:(e,t,r)=>{"use strict";r.d(t,{t:()=>d});var n=r(37939),o=r(55841),i=r(64169),a=r(26170),s=r(64603),u=r(42438),c=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},d=(0,o.A)(n.C,(function(e,t){var r=e.ApplicationId,n=e.EventsRequest,o=(0,u.O)(),a=new URL(t.url);return a.pathname="v1/apps/".concat((0,i.$)(r),"/events"),{method:"POST",headers:o,url:a,body:JSON.stringify(null!=n?n:{})}}),(function(e){return c(void 0,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return e.statusCode>=300?[4,(0,a.F)(e)]:[3,2];case 1:throw t.sent();case 2:return[4,(0,a.Y)(e)];case 3:return[2,{EventsResponse:{Results:t.sent().Results},$metadata:(0,s.j)(e)}]}}))}))}),u.s)},85247:(e,t,r)=>{"use strict";r.d(t,{l:()=>d});var n=r(37939),o=r(55841),i=r(64169),a=r(26170),s=r(64603),u=r(42438),c=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},d=(0,o.A)(n.C,(function(e,t){var r=e.ApplicationId,n=e.EndpointId,o=e.EndpointRequest,a=(0,u.O)(),s=new URL(t.url);return s.pathname="v1/apps/".concat((0,i.$)(r),"/endpoints/").concat((0,i.$)(n)),{method:"PUT",headers:a,url:s,body:JSON.stringify(null!=o?o:{})}}),(function(e){return c(void 0,void 0,void 0,(function(){var t,r,n;return l(this,(function(o){switch(o.label){case 0:return e.statusCode>=300?[4,(0,a.F)(e)]:[3,2];case 1:throw o.sent();case 2:return[4,(0,a.Y)(e)];case 3:return t=o.sent(),r=t.Message,n=t.RequestID,[2,{MessageBody:{Message:r,RequestID:n},$metadata:(0,s.j)(e)}]}}))}))}),u.s)},68026:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=new(r(34549).C)("ClientDevice_Browser");function o(){return"undefined"==typeof window?{}:function(){if("undefined"==typeof window)return n.warn("No window object available to get browser client info"),{};var e=window.navigator;if(!e)return n.warn("No navigator object available to get browser client info"),{};var t=e.platform,r=e.product,o=e.vendor,i=e.userAgent,a=e.language,s=function(e){var t=/.+(Opera[\s[A-Z]*|OPR[\sA-Z]*)\/([0-9\.]+).*/i.exec(e);if(t)return{type:t[1],version:t[2]};var r=/.+(Trident|Edge)\/([0-9\.]+).*/i.exec(e);if(r)return{type:r[1],version:r[2]};var n=/.+(Chrome|Firefox|FxiOS)\/([0-9\.]+).*/i.exec(e);if(n)return{type:n[1],version:n[2]};var o=/.+(Safari)\/([0-9\.]+).*/i.exec(e);if(o)return{type:o[1],version:o[2]};var i=/.+(AppleWebKit)\/([0-9\.]+).*/i.exec(e);if(i)return{type:i[1],version:i[2]};var a=/.*([A-Z]+)\/([0-9\.]+).*/i.exec(e);if(a)return{type:a[1],version:a[2]};return{type:"",version:""}}(i),u=(c=/\(([A-Za-z\s].*)\)/.exec((new Date).toString()),c&&c[1]||"");var c;return{platform:t,make:r||o,model:s.type,version:s.version,appVersion:[s.type,s.version].join("/"),language:a,timezone:u}}()}var i=function(){function e(){}return e.clientInfo=function(){return o()},e.dimension=function(){return"undefined"==typeof window?(n.warn("No window object available to get browser client info"),{width:320,height:320}):{width:window.innerWidth,height:window.innerHeight}},e}()},89404:(e,t,r)=>{"use strict";r.d(t,{J:()=>ee});var n=r(34549),o=r(54769),i=r(64988),a=r(766),s=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},c=new n.C("CognitoCredentials"),l=new Promise((function(e,t){return(0,i.gy)().isBrowser?(window.gapi&&window.gapi.auth2?window.gapi.auth2:null)?(c.debug("google api already loaded"),e()):void setTimeout((function(){return e()}),2e3):(c.debug("not in the browser, directly resolved"),e())})),d=function(){function e(){this.initialized=!1,this.refreshGoogleToken=this.refreshGoogleToken.bind(this),this._refreshGoogleTokenImpl=this._refreshGoogleTokenImpl.bind(this)}return e.prototype.refreshGoogleToken=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return this.initialized?[3,2]:(c.debug("need to wait for the Google SDK loaded"),[4,l]);case 1:e.sent(),this.initialized=!0,c.debug("finish waiting"),e.label=2;case 2:return[2,this._refreshGoogleTokenImpl()]}}))}))},e.prototype._refreshGoogleTokenImpl=function(){var e=null;return(0,i.gy)().isBrowser&&(e=window.gapi&&window.gapi.auth2?window.gapi.auth2:null),e?new Promise((function(t,r){e.getAuthInstance().then((function(e){e||(c.debug("google Auth undefined"),r(new a.OI("google Auth undefined")));var n=e.currentUser.get();n.isSignedIn()?(c.debug("refreshing the google access token"),n.reloadAuthResponse().then((function(e){var r=e.id_token,n=e.expires_at;t({token:r,expires_at:n})})).catch((function(e){e&&"network_error"===e.error?r("Network error reloading google auth response"):r(new a.OI("Failed to reload google auth response"))}))):r(new a.OI("User is not signed in with Google"))})).catch((function(e){c.debug("Failed to refresh google token",e),r(new a.OI("Failed to refresh google token"))}))})):(c.debug("no gapi auth2 available"),Promise.reject("no gapi auth2 available"))},e}(),f=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},h=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},p=new n.C("CognitoCredentials"),v=new Promise((function(e,t){return(0,i.gy)().isBrowser?window.FB?(p.debug("FB SDK already loaded"),e()):void setTimeout((function(){return e()}),2e3):(p.debug("not in the browser, directly resolved"),e())})),y=function(){function e(){this.initialized=!1,this.refreshFacebookToken=this.refreshFacebookToken.bind(this),this._refreshFacebookTokenImpl=this._refreshFacebookTokenImpl.bind(this)}return e.prototype.refreshFacebookToken=function(){return f(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return this.initialized?[3,2]:(p.debug("need to wait for the Facebook SDK loaded"),[4,v]);case 1:e.sent(),this.initialized=!0,p.debug("finish waiting"),e.label=2;case 2:return[2,this._refreshFacebookTokenImpl()]}}))}))},e.prototype._refreshFacebookTokenImpl=function(){var e=null;if((0,i.gy)().isBrowser&&(e=window.FB),!e){var t="no fb sdk available";return p.debug(t),Promise.reject(new a.OI(t))}return new Promise((function(t,r){e.getLoginStatus((function(e){if(e&&e.authResponse){var n=e.authResponse,o=n.accessToken,i=1e3*n.expiresIn+(new Date).getTime();if(!o){s="the jwtToken is undefined";p.debug(s),r(new a.OI(s))}t({token:o,expires_at:i})}else{var s="no response from facebook when refreshing the jwt token";p.debug(s),r(new a.OI(s))}}),{scope:"public_profile,email"})}))},e}(),g=new d,m=new y,_=r(88319),b=r(82622),w=r(90502),S=r(29368),E=r(12215),x=r(6212),I=(0,E.q)(x.Q,[S.L,w.D]),P=r(26170),A=r(16824),T=r(98641),C=r(71805),O=r(85294),k=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},N=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},M=(0,E.q)(I,[function(){return function(e,t){return function(t){return k(this,void 0,void 0,(function(){return N(this,(function(r){return t.headers["cache-control"]="no-store",[2,e(t)]}))}))}}}]),R={service:"cognito-identity",endpointResolver:function(e){var t=e.region;return{url:new URL("https://cognito-identity.".concat(t,".").concat((0,b.R)(t)))}},retryDecider:(0,A.D)(P.F),computeDelay:T.y,userAgentValue:(0,C.fE)()};(0,O.e9)((function(){R.userAgentValue=(0,C.fE)()}));var D=function(e){return{"content-type":"application/x-amz-json-1.1","x-amz-target":"AWSCognitoIdentityService.".concat(e)}},j=function(e,t,r){return{headers:t,url:e.url,body:r,method:"POST"}},F=r(64603),L=r(55841),U=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},q=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},W=(0,L.A)(M,(function(e,t){var r=D("GetId"),n=JSON.stringify(e);return j(t,r,n)}),(function(e){return U(void 0,void 0,void 0,(function(){return q(this,(function(t){switch(t.label){case 0:return e.statusCode>=300?[4,(0,P.F)(e)]:[3,2];case 1:throw t.sent();case 2:return[4,(0,P.Y)(e)];case 3:return[2,{IdentityId:t.sent().IdentityId,$metadata:(0,F.j)(e)}]}}))}))}),R),G=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},B=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},K=function(e){return void 0===e&&(e={}),{AccessKeyId:e.AccessKeyId,SecretKey:e.SecretKey,SessionToken:e.SessionToken,Expiration:new Date(1e3*e.Expiration)}},z=(0,L.A)(M,(function(e,t){var r=D("GetCredentialsForIdentity"),n=JSON.stringify(e);return j(t,r,n)}),(function(e){return G(void 0,void 0,void 0,(function(){var t;return B(this,(function(r){switch(r.label){case 0:return e.statusCode>=300?[4,(0,P.F)(e)]:[3,2];case 1:throw r.sent();case 2:return[4,(0,P.Y)(e)];case 3:return[2,{IdentityId:(t=r.sent()).IdentityId,Credentials:K(t.Credentials),$metadata:(0,F.j)(e)}]}}))}))}),R),V=r(3976),Y=r(78868),J=function(){return J=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},J.apply(this,arguments)},H=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},Q=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},$=new n.C("Credentials"),Z="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default",X=function(){function e(e){this._gettingCredPromise=null,this._refreshHandlers={},this.Auth=void 0,this.configure(e),this._refreshHandlers.google=g.refreshGoogleToken,this._refreshHandlers.facebook=m.refreshFacebookToken}return e.prototype.getModuleName=function(){return"Credentials"},e.prototype.getCredSource=function(){return this._credentials_source},e.prototype.configure=function(e){if(!e)return this._config||{};this._config=Object.assign({},this._config,e);var t,r,n,i=this._config.refreshHandlers;return i&&(this._refreshHandlers=J(J({},this._refreshHandlers),i)),this._storage=this._config.storage,this._storage||(this._storage=(new o.i).getStorage()),this._storageSync=Promise.resolve(),"function"==typeof this._storage.sync&&(this._storageSync=this._storage.sync()),t="credentials_configured",r=null,n="Credentials has been configured successfully",Y.Y.dispatch("core",{event:t,data:r,message:n},"Credentials",Z),this._config},e.prototype.get=function(){return $.debug("getting credentials"),this._pickupCredentials()},e.prototype._getCognitoIdentityIdStorageKey=function(e){return"".concat("CognitoIdentityId-").concat(e)},e.prototype._pickupCredentials=function(){return $.debug("picking up credentials"),this._gettingCredPromise&&this._gettingCredPromise.isPending()?$.debug("getting old cred promise"):($.debug("getting new cred promise"),this._gettingCredPromise=(0,i.VN)(this._keepAlive())),this._gettingCredPromise},e.prototype._keepAlive=function(){return H(this,void 0,void 0,(function(){var e,t,r,n,o,i,a;return Q(this,(function(s){switch(s.label){case 0:if($.debug("checking if credentials exists and not expired"),(e=this._credentials)&&!this._isExpired(e)&&!this._isPastTTL())return $.debug("credentials not changed and not expired, directly return"),[2,Promise.resolve(e)];if($.debug("need to get a new credential or refresh the existing one"),t=this.Auth,!(r=void 0===t?_.H.Auth:t)||"function"!=typeof r.currentUserCredentials)return[2,this._setCredentialsForGuest()];if(this._isExpired(e)||!this._isPastTTL())return[3,6];$.debug("ttl has passed but token is not yet expired"),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,r.currentUserPoolUser()];case 2:return n=s.sent(),[4,r.currentSession()];case 3:return o=s.sent(),i=o.refreshToken,[4,new Promise((function(e,t){n.refreshSession(i,(function(r,n){return r?t(r):e(n)}))}))];case 4:return s.sent(),[3,6];case 5:return a=s.sent(),$.debug("Error attempting to refreshing the session",a),[3,6];case 6:return[2,r.currentUserCredentials()]}}))}))},e.prototype.refreshFederatedToken=function(e){$.debug("Getting federated credentials");var t=e.provider,r=e.user,n=e.token,o=e.identity_id,i=e.expires_at;i=1970===new Date(i).getFullYear()?1e3*i:i;var a=this;return $.debug("checking if federated jwt token expired"),i>(new Date).getTime()?($.debug("token not expired"),this._setCredentialsFromFederation({provider:t,token:n,user:r,identity_id:o,expires_at:i})):a._refreshHandlers[t]&&"function"==typeof a._refreshHandlers[t]?($.debug("getting refreshed jwt token from federation provider"),this._providerRefreshWithRetry({refreshHandler:a._refreshHandlers[t],provider:t,user:r})):($.debug("no refresh handler for provider:",t),this.clear(),Promise.reject("no refresh handler for provider"))},e.prototype._providerRefreshWithRetry=function(e){var t=this,r=e.refreshHandler,n=e.provider,o=e.user;return(0,a.hu)(r,[],1e4).then((function(e){return $.debug("refresh federated token sucessfully",e),t._setCredentialsFromFederation({provider:n,token:e.token,user:o,identity_id:e.identity_id,expires_at:e.expires_at})})).catch((function(e){return"string"==typeof e&&0===e.toLowerCase().lastIndexOf("network error",e.length)||t.clear(),$.debug("refresh federated token failed",e),Promise.reject("refreshing federation token failed: "+e)}))},e.prototype._isExpired=function(e){if(!e)return $.debug("no credentials for expiration check"),!0;$.debug("are these credentials expired?",e);var t=Date.now();return e.expiration.getTime()<=t},e.prototype._isPastTTL=function(){return this._nextCredentialsRefresh<=Date.now()},e.prototype._setCredentialsForGuest=function(){var e;return H(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,u,c,l,d=this;return Q(this,(function(f){switch(f.label){case 0:return $.debug("setting credentials for guest"),(null===(e=this._config)||void 0===e?void 0:e.identityPoolId)||(this._config=Object.assign({},this._config,(0,V.s)(this._config||{}).Auth)),t=this._config,r=t.identityPoolId,n=t.region,o=t.mandatorySignIn,i=t.identityPoolRegion,o?[2,Promise.reject("cannot get guest credentials when mandatory signin enabled")]:r?i||n?(s=this,[4,this._getGuestIdentityId()]):($.debug("region is not configured for getting the credentials"),[2,Promise.reject("region is not configured for getting the credentials")]):($.debug("No Cognito Identity pool provided for unauthenticated access"),[2,Promise.reject("No Cognito Identity pool provided for unauthenticated access")]);case 1:return a=s._identityId=f.sent(),u={region:null!=i?i:n},c=function(){return H(d,void 0,void 0,(function(){var e,t;return Q(this,(function(n){switch(n.label){case 0:return a?[3,2]:[4,W(u,{IdentityPoolId:r})];case 1:e=n.sent().IdentityId,this._identityId=e,n.label=2;case 2:return[4,z(u,{IdentityId:this._identityId})];case 3:return t=n.sent().Credentials,[2,{identityId:this._identityId,accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretKey,sessionToken:t.SessionToken,expiration:t.Expiration}]}}))}))},l=c().catch((function(e){return H(d,void 0,void 0,(function(){return Q(this,(function(t){throw e}))}))})),[2,this._loadCredentials(l,"guest",!1,null).then((function(e){return e})).catch((function(e){return H(d,void 0,void 0,(function(){var t,n=this;return Q(this,(function(o){switch(o.label){case 0:return"ResourceNotFoundException"!==e.name||e.message!=="Identity '".concat(a,"' not found.")?[3,2]:($.debug("Failed to load guest credentials"),[4,this._removeGuestIdentityId()]);case 1:return o.sent(),t=function(){return H(n,void 0,void 0,(function(){var e,t;return Q(this,(function(n){switch(n.label){case 0:return[4,W(u,{IdentityPoolId:r})];case 1:return e=n.sent().IdentityId,this._identityId=e,[4,z(u,{IdentityId:e})];case 2:return t=n.sent().Credentials,[2,{identityId:e,accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretKey,sessionToken:t.SessionToken,expiration:t.Expiration}]}}))}))},l=t().catch((function(e){return H(n,void 0,void 0,(function(){return Q(this,(function(t){throw e}))}))})),[2,this._loadCredentials(l,"guest",!1,null)];case 2:return[2,e]}}))}))}))]}}))}))},e.prototype._setCredentialsFromFederation=function(e){var t=this,r=e.provider,n=e.token,o=e.identity_id,i={google:"accounts.google.com",facebook:"graph.facebook.com",amazon:"www.amazon.com",developer:"cognito-identity.amazonaws.com"}[r]||r;if(!i)return Promise.reject("You must specify a federated provider");var a={};a[i]=n;var s=this._config,u=s.identityPoolId,c=s.region,l=s.identityPoolRegion;if(!u)return $.debug("No Cognito Federated Identity pool provided"),Promise.reject("No Cognito Federated Identity pool provided");if(!l&&!c)return $.debug("region is not configured for getting the credentials"),Promise.reject("region is not configured for getting the credentials");var d={region:null!=l?l:c},f=H(t,void 0,void 0,(function(){var e,t;return Q(this,(function(r){switch(r.label){case 0:return o?[3,2]:[4,W(d,{IdentityPoolId:u,Logins:a})];case 1:e=r.sent().IdentityId,o=e,r.label=2;case 2:return[4,z(d,{IdentityId:o,Logins:a})];case 3:return t=r.sent().Credentials,[2,{identityId:o,accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretKey,sessionToken:t.SessionToken,expiration:t.Expiration}]}}))})).catch((function(e){return H(t,void 0,void 0,(function(){return Q(this,(function(t){throw e}))}))}));return this._loadCredentials(f,"federated",!0,e)},e.prototype._setCredentialsFromSession=function(e){var t=this;$.debug("set credentials from session");var r=e.getIdToken().getJwtToken(),n=this._config,o=n.region,i=n.userPoolId,a=n.identityPoolId,s=n.identityPoolRegion;if(!a)return $.debug("No Cognito Federated Identity pool provided"),Promise.reject("No Cognito Federated Identity pool provided");if(!s&&!o)return $.debug("region is not configured for getting the credentials"),Promise.reject("region is not configured for getting the credentials");var u={};u["cognito-idp."+o+".amazonaws.com/"+i]=r;var c={region:null!=s?s:o},l=H(t,void 0,void 0,(function(){var e,t,r,n,o,i,s,l,d,f;return Q(this,(function(h){switch(h.label){case 0:return[4,this._getGuestIdentityId()];case 1:return(e=h.sent())?[3,3]:[4,W(c,{IdentityPoolId:a,Logins:u})];case 2:r=h.sent().IdentityId,t=r,h.label=3;case 3:return[4,z(c,{IdentityId:e||t,Logins:u})];case 4:return n=h.sent(),o=n.Credentials,i=o.AccessKeyId,s=o.Expiration,l=o.SecretKey,d=o.SessionToken,f=n.IdentityId,this._identityId=f,e?($.debug("The guest identity ".concat(e," has been successfully linked to the logins")),e===f&&$.debug("The guest identity ".concat(e," has become the primary identity")),[4,this._removeGuestIdentityId()]):[3,6];case 5:h.sent(),h.label=6;case 6:return[2,{accessKeyId:i,secretAccessKey:l,sessionToken:d,expiration:s,identityId:f}]}}))})).catch((function(e){return H(t,void 0,void 0,(function(){return Q(this,(function(t){throw e}))}))}));return this._loadCredentials(l,"userPool",!0,null)},e.prototype._loadCredentials=function(e,t,r,n){var o=this,i=this;return new Promise((function(a,s){e.then((function(e){return H(o,void 0,void 0,(function(){var o,s,u,c,l;return Q(this,(function(d){switch(d.label){case 0:if($.debug("Load credentials successfully",e),this._identityId&&!e.identityId&&(e.identityId=this._identityId),i._credentials=e,i._credentials.authenticated=r,i._credentials_source=t,i._nextCredentialsRefresh=(new Date).getTime()+3e6,"federated"===t){o=Object.assign({id:this._credentials.identityId},n.user),s=n.provider,u=n.token,c=n.expires_at,l=n.identity_id;try{this._storage.setItem("aws-amplify-federatedInfo",JSON.stringify({provider:s,token:u,user:o,expires_at:c,identity_id:l}))}catch(e){$.debug("Failed to put federated info into auth storage",e)}}return"guest"!==t?[3,2]:[4,this._setGuestIdentityId(e.identityId)];case 1:d.sent(),d.label=2;case 2:return a(i._credentials),[2]}}))}))})).catch((function(t){if(t)return $.debug("Failed to load credentials",e),$.debug("Error loading credentials",t),void s(t)}))}))},e.prototype.set=function(e,t){return"session"===t?this._setCredentialsFromSession(e):"federation"===t?this._setCredentialsFromFederation(e):"guest"===t?this._setCredentialsForGuest():($.debug("no source specified for setting credentials"),Promise.reject("invalid source"))},e.prototype.clear=function(){return H(this,void 0,void 0,(function(){return Q(this,(function(e){return this._credentials=null,this._credentials_source=null,$.debug("removing aws-amplify-federatedInfo from storage"),this._storage.removeItem("aws-amplify-federatedInfo"),[2]}))}))},e.prototype._getGuestIdentityId=function(){return H(this,void 0,void 0,(function(){var e,t;return Q(this,(function(r){switch(r.label){case 0:e=this._config.identityPoolId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._storageSync];case 2:return r.sent(),[2,this._storage.getItem(this._getCognitoIdentityIdStorageKey(e))];case 3:return t=r.sent(),$.debug("Failed to get the cached guest identityId",t),[3,4];case 4:return[2]}}))}))},e.prototype._setGuestIdentityId=function(e){return H(this,void 0,void 0,(function(){var t,r;return Q(this,(function(n){switch(n.label){case 0:t=this._config.identityPoolId,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._storageSync];case 2:return n.sent(),this._storage.setItem(this._getCognitoIdentityIdStorageKey(t),e),[3,4];case 3:return r=n.sent(),$.debug("Failed to cache guest identityId",r),[3,4];case 4:return[2]}}))}))},e.prototype._removeGuestIdentityId=function(){return H(this,void 0,void 0,(function(){var e;return Q(this,(function(t){return e=this._config.identityPoolId,$.debug("removing ".concat(this._getCognitoIdentityIdStorageKey(e)," from storage")),this._storage.removeItem(this._getCognitoIdentityIdStorageKey(e)),[2]}))}))},e.prototype.shear=function(e){return{accessKeyId:e.accessKeyId,sessionToken:e.sessionToken,secretAccessKey:e.secretAccessKey,identityId:e.identityId,authenticated:e.authenticated}},e}(),ee=new X(null);_.H.register(ee)},78868:(e,t,r)=>{"use strict";r.d(t,{Y:()=>c});var n=r(34549),o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},s=new n.C("Hub"),u="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("amplify_default"):"@@amplify_default";var c=new(function(){function e(e){this.listeners=[],this.patterns=[],this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}return e.prototype._remove=function(e,t){if(e instanceof RegExp){var r=this.patterns.find((function(t){return t.pattern.source===e.source}));if(!r)return void s.warn("No listeners for ".concat(e));this.patterns=a([],i(this.patterns.filter((function(e){return e!==r}))),!1)}else{var n=this.listeners[e];if(!n)return void s.warn("No listeners for ".concat(e));this.listeners[e]=a([],i(n.filter((function(e){return e.callback!==t}))),!1)}},e.prototype.remove=function(e,t){this._remove(e,t)},e.prototype.dispatch=function(e,t,r,n){(void 0===r&&(r=""),this.protectedChannels.indexOf(e)>-1)&&(n===u||s.warn("WARNING: ".concat(e," is protected and dispatching on it can have unintended consequences")));var i={channel:e,payload:o({},t),source:r,patternInfo:[]};try{this._toListeners(i)}catch(e){s.error(e)}},e.prototype.listen=function(e,t,r){var n,o=this;if(void 0===r&&(r="noname"),function(e){return void 0!==e.onHubCapsule}(t))s.warn("WARNING onHubCapsule is Deprecated. Please pass in a callback."),n=t.onHubCapsule.bind(t);else{if("function"!=typeof t)throw new Error("No callback supplied to Hub");n=t}if(e instanceof RegExp)this.patterns.push({pattern:e,callback:n});else{var i=this.listeners[e];i||(i=[],this.listeners[e]=i),i.push({name:r,callback:n})}return function(){o._remove(e,n)}},e.prototype._toListeners=function(e){var t=e.channel,r=e.payload,n=this.listeners[t];if(n&&n.forEach((function(n){s.debug("Dispatching to ".concat(t," with "),r);try{n.callback(e)}catch(e){s.error(e)}})),this.patterns.length>0){if(!r.message)return void s.warn("Cannot perform pattern matching without a message key");var a=r.message;this.patterns.forEach((function(t){var r=a.match(t.pattern);if(r){var n=i(r).slice(1),u=o(o({},e),{patternInfo:n});try{t.callback(u)}catch(e){s.error(e)}}}))}},e}())("__default__")},63401:(e,t,r)=>{"use strict";r.d(t,{F:()=>d});var n=r(34549),o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=new n.C("I18n"),a=function(){function e(e){this._options=null,this._lang=null,this._dict={},this._options=Object.assign({},e),this._lang=this._options.language,!this._lang&&"undefined"!=typeof window&&window&&window.navigator&&(this._lang=window.navigator.language),i.debug(this._lang)}return e.prototype.setLanguage=function(e){this._lang=e},e.prototype.get=function(e,t){if(void 0===t&&(t=void 0),!this._lang)return void 0!==t?t:e;var r=this._lang,n=this.getByLanguage(e,r);return n||(r.indexOf("-")>0&&(n=this.getByLanguage(e,r.split("-")[0])),n||(void 0!==t?t:e))},e.prototype.getByLanguage=function(e,t,r){if(void 0===r&&(r=null),!t)return r;var n=this._dict[t];return n?n[e]:r},e.prototype.putVocabulariesForLanguage=function(e,t){var r=this._dict[e];r||(r=this._dict[e]={}),this._dict[e]=o(o({},r),t)},e.prototype.putVocabularies=function(e){var t=this;Object.keys(e).map((function(r){t.putVocabulariesForLanguage(r,e[r])}))},e}(),s=r(88319),u=new n.C("I18n"),c=null,l=null,d=function(){function e(){}return e.configure=function(t){return u.debug("configure I18n"),t?(c=Object.assign({},c,t.I18n||t),e.createInstance(),c):c},e.getModuleName=function(){return"I18n"},e.createInstance=function(){u.debug("create I18n instance"),l||(l=new a(c))},e.setLanguage=function(t){return e.checkConfig(),l.setLanguage(t)},e.get=function(t,r){return e.checkConfig()?l.get(t,r):void 0===r?t:r},e.putVocabulariesForLanguage=function(t,r){return e.checkConfig(),l.putVocabulariesForLanguage(t,r)},e.putVocabularies=function(t){return e.checkConfig(),l.putVocabularies(t)},e.checkConfig=function(){return l||(l=new a(c)),!0},e}();s.H.register(d)},64988:(e,t,r)=>{"use strict";r.d(t,{Jw:()=>s,VN:()=>o,gy:()=>a,p7:()=>i,qo:()=>u});var n=r(71019),o=function(e){if(e.isResolved)return e;var t=!0,r=!1,n=!1,o=e.then((function(e){return n=!0,t=!1,e}),(function(e){throw r=!0,t=!1,e}));return o.isFullfilled=function(){return n},o.isPending=function(){return t},o.isRejected=function(){return r},o},i=function(){if("undefined"==typeof self)return!1;var e=self;return void 0!==e.WorkerGlobalScope&&self instanceof e.WorkerGlobalScope},a=function(){return{isBrowser:"undefined"!=typeof window&&void 0!==window.document,isNode:void 0!==n&&null!=n.versions&&null!=n.versions.node}},s=function(e,t,r){if(void 0===t&&(t=[]),void 0===r&&(r=[]),!c(e))return e;var n={};for(var o in e){if(e.hasOwnProperty(o))n[t.includes(o)?o:o[0].toLowerCase()+o.slice(1)]=r.includes(o)?e[o]:s(e[o],t,r)}return n},u=function(e,t,r){if(void 0===t&&(t=[]),void 0===r&&(r=[]),!c(e))return e;var n={};for(var o in e){if(e.hasOwnProperty(o))n[t.includes(o)?o:o[0].toUpperCase()+o.slice(1)]=r.includes(o)?e[o]:u(e[o],t,r)}return n},c=function(e){return!(!(e instanceof Object)||e instanceof Array||e instanceof Function||e instanceof Number||e instanceof String||e instanceof Boolean)}},34549:(e,t,r)=>{"use strict";r.d(t,{C:()=>c});var n,o=r(7025),i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},u={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5};!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE"}(n||(n={}));var c=function(){function e(e,t){void 0===t&&(t=n.WARN),this.name=e,this.level=t,this._pluggables=[]}return e.prototype._padding=function(e){return e<10?"0"+e:""+e},e.prototype._ts=function(){var e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()},e.prototype.configure=function(e){return e?(this._config=e,this._config):this._config},e.prototype._log=function(t){for(var r,o,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var c=this.level;if(e.LOG_LEVEL&&(c=e.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(c=window.LOG_LEVEL),u[t]>=u[c]){var l=console.log.bind(console);t===n.ERROR&&console.error&&(l=console.error.bind(console)),t===n.WARN&&console.warn&&(l=console.warn.bind(console));var d="[".concat(t,"] ").concat(this._ts()," ").concat(this.name),f="";if(1===a.length&&"string"==typeof a[0])l(f="".concat(d," - ").concat(a[0]));else if(1===a.length)f="".concat(d," ").concat(a[0]),l(d,a[0]);else if("string"==typeof a[0]){var h=a.slice(1);1===h.length&&(h=h[0]),f="".concat(d," - ").concat(a[0]," ").concat(h),l("".concat(d," - ").concat(a[0]),h)}else f="".concat(d," ").concat(a),l(d,a);try{for(var p=i(this._pluggables),v=p.next();!v.done;v=p.next()){var y=v.value,g={message:f,timestamp:Date.now()};y.pushLogs([g])}}catch(e){r={error:e}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}}},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.INFO],a(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.INFO],a(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.WARN],a(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.ERROR],a(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.DEBUG],a(e),!1))},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._log.apply(this,s([n.VERBOSE],a(e),!1))},e.prototype.addPluggable=function(e){e&&e.getCategoryName()===o.OU&&(this._pluggables.push(e),e.configure(this._config))},e.prototype.listPluggables=function(){return this._pluggables},e.LOG_LEVEL=null,e}()},85294:(e,t,r)=>{"use strict";r.d(t,{yl:()=>g,e9:()=>m});var n=r(37070),o=r(71019),i=function(){return void 0!==r.g},a=function(){return"undefined"!=typeof window},s=function(){return"undefined"!=typeof document},u=function(){return void 0!==o},c=function(e,t){return!!Object.keys(e).find((function(e){return e.startsWith(t)}))},l=r(71019);var d=r(71019);var f=r(71019);var h,p=[{platform:n.dT.Expo,detectionMethod:function(){return i()&&void 0!==r.g.expo}},{platform:n.dT.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:n.dT.NextJs,detectionMethod:function(){return a()&&window.next&&"object"==typeof window.next}},{platform:n.dT.Nuxt,detectionMethod:function(){return a()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:n.dT.Angular,detectionMethod:function(){var e=Boolean(s()&&document.querySelector("[ng-version]")),t=Boolean(a()&&void 0!==window.ng);return e||t}},{platform:n.dT.React,detectionMethod:function(){var e=function(e){return e.startsWith("_react")||e.startsWith("__react")};return s()&&Array.from(document.querySelectorAll("[id]")).some((function(t){return Object.keys(t).find(e)}))}},{platform:n.dT.VueJs,detectionMethod:function(){return a()&&c(window,"__VUE")}},{platform:n.dT.Svelte,detectionMethod:function(){return a()&&c(window,"__SVELTE")}},{platform:n.dT.WebUnknown,detectionMethod:function(){return a()}},{platform:n.dT.NextJsSSR,detectionMethod:function(){return i()&&(c(r.g,"__next")||c(r.g,"__NEXT"))}},{platform:n.dT.NuxtSSR,detectionMethod:function(){return i()&&void 0!==r.g.__NUXT_PATHS__}},{platform:n.dT.ReactSSR,detectionMethod:function(){return u()&&void 0!==l.env&&!!Object.keys(l.env).find((function(e){return e.includes("react")}))}},{platform:n.dT.VueJsSSR,detectionMethod:function(){return i()&&c(r.g,"__VUE")}},{platform:n.dT.AngularSSR,detectionMethod:function(){var e;return u()&&"object"==typeof f.env&&(null===(e=f.env.npm_lifecycle_script)||void 0===e?void 0:e.startsWith("ng "))||!1}},{platform:n.dT.SvelteSSR,detectionMethod:function(){return u()&&void 0!==d.env&&!!Object.keys(d.env).find((function(e){return e.includes("svelte")}))}}];var v=[],y=!1,g=function(){if(!h){if(h=(null===(e=p.find((function(e){return e.detectionMethod()})))||void 0===e?void 0:e.platform)||n.dT.ServerSideUnknown,y)for(;v.length;)v.pop()();else v.forEach((function(e){return e()}));_(n.dT.ServerSideUnknown,10),_(n.dT.WebUnknown,10)}var e;return h},m=function(e){y||v.push(e)};function _(e,t){h!==e||y||setTimeout((function(){h=void 0,y=!0,setTimeout(g,1e3)}),t)}},71805:(e,t,r)=>{"use strict";r.d(t,{OD:()=>u,fE:()=>l,Ij:()=>c});var n=r(37070),o="5.3.26",i=r(85294),a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s="aws-amplify",u=new(function(){function e(){this.userAgent="".concat(s,"/").concat(o)}return Object.defineProperty(e.prototype,"framework",{get:function(){return(0,i.yl)()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReactNative",{get:function(){return this.framework===n.dT.ReactNative||this.framework===n.dT.Expo},enumerable:!1,configurable:!0}),e.prototype.observeFrameworkChanges=function(e){(0,i.e9)(e)},e}()),c=function(e){var t=void 0===e?{}:e,r=t.category,n=t.action,a=(t.framework,[[s,o]]);return r&&a.push([r,n]),a.push(["framework",(0,i.yl)()]),a},l=function(e){return c(e).map((function(e){var t=a(e,2),r=t[0],n=t[1];return"".concat(r,"/").concat(n)})).join(" ")}},37070:(e,t,r)=>{"use strict";var n,o,i,a,s,u,c,l,d,f,h,p,v;r.d(t,{BM:()=>s,CG:()=>p,CW:()=>u,Fu:()=>a,Mv:()=>h,b7:()=>o,dT:()=>n,r5:()=>l,sZ:()=>v,zJ:()=>i}),function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(n||(n={})),function(e){e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(o||(o={})),function(e){e.Record="1",e.UpdateEndpoint="2"}(i||(i={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(a||(a={})),function(e){e.FederatedSignIn="30"}(s||(s={})),function(e){e.Subscribe="1",e.GraphQl="2"}(u||(u={})),function(e){e.None="0"}(c||(c={})),function(e){e.None="0"}(l||(l={})),function(e){e.None="0"}(d||(d={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(f||(f={})),function(e){e.Subscribe="1"}(h||(h={})),function(e){e.None="0"}(p||(p={})),function(e){e.Put="1",e.Get="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6"}(v||(v={}))},86326:(e,t,r)=>{"use strict";r.d(t,{b:()=>b});var n=r(82391),o=r(72923),i=r(88674),a=r(10670),s=r(64609),u=r(53548),c=r(42767),l=r(89404),d=r(34549),f=r(71805),h=r(3976),p=r(7025),v=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},y=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},g=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},m=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},_=new d.C("AWSCloudWatch"),b=function(){function e(e){this.configure(e),this._dataTracker={eventUploadInProgress:!1,logEvents:[]},this._currentLogBatch=[],this._initiateLogPushInterval()}return e.prototype.getProviderName=function(){return e.PROVIDER_NAME},e.prototype.getCategoryName=function(){return e.CATEGORY},e.prototype.getLogQueue=function(){return this._dataTracker.logEvents},e.prototype.configure=function(e){if(!e)return this._config||{};var t=Object.assign({},this._config,(0,h.s)(e).Logging,e);return this._config=t,this._config},e.prototype.createLogGroup=function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(o){switch(o.label){case 0:_.debug("creating new log group in CloudWatch - ",e.logGroupName),t=new n.B(e),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this._ensureCredentials()];case 2:if(!o.sent())throw new Error(p.hp);return[4,this._initCloudWatchLogs().send(t)];case 3:return[2,o.sent()];case 4:throw r=o.sent(),_.error("error creating log group - ".concat(r)),r;case 5:return[2]}}))}))},e.prototype.getLogGroups=function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(n){switch(n.label){case 0:_.debug("getting list of log groups"),t=new o.V(e),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this._ensureCredentials()];case 2:if(!n.sent())throw new Error(p.hp);return[4,this._initCloudWatchLogs().send(t)];case 3:return[2,n.sent()];case 4:throw r=n.sent(),_.error("error getting log group - ".concat(r)),r;case 5:return[2]}}))}))},e.prototype.createLogStream=function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(n){switch(n.label){case 0:_.debug("creating new log stream in CloudWatch - ",e.logStreamName),t=new i.E(e),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this._ensureCredentials()];case 2:if(!n.sent())throw new Error(p.hp);return[4,this._initCloudWatchLogs().send(t)];case 3:return[2,n.sent()];case 4:throw r=n.sent(),_.error("error creating log stream - ".concat(r)),r;case 5:return[2]}}))}))},e.prototype.getLogStreams=function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(n){switch(n.label){case 0:_.debug("getting list of log streams"),t=new a.w(e),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this._ensureCredentials()];case 2:if(!n.sent())throw new Error(p.hp);return[4,this._initCloudWatchLogs().send(t)];case 3:return[2,n.sent()];case 4:throw r=n.sent(),_.error("error getting log stream - ".concat(r)),r;case 5:return[2]}}))}))},e.prototype.getLogEvents=function(e){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(n){switch(n.label){case 0:_.debug("getting log events from stream - ",e.logStreamName),t=new s.h(e),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this._ensureCredentials()];case 2:if(!n.sent())throw new Error(p.hp);return[4,this._initCloudWatchLogs().send(t)];case 3:return[2,n.sent()];case 4:throw r=n.sent(),_.error("error getting log events - ".concat(r)),r;case 5:return[2]}}))}))},e.prototype.pushLogs=function(e){_.debug("pushing log events to Cloudwatch..."),this._dataTracker.logEvents=m(m([],g(this._dataTracker.logEvents),!1),g(e),!1)},e.prototype._validateLogGroupExistsAndCreate=function(e){return v(this,void 0,void 0,(function(){var t,r,n,o;return y(this,(function(i){switch(i.label){case 0:if(this._dataTracker.verifiedLogGroup)return[2,this._dataTracker.verifiedLogGroup];i.label=1;case 1:return i.trys.push([1,5,,6]),[4,this._ensureCredentials()];case 2:if(!i.sent())throw new Error(p.hp);return[4,this.getLogGroups({logGroupNamePrefix:e})];case 3:return"string"!=typeof(t=i.sent())&&t.logGroups&&(r=t.logGroups.filter((function(t){return t.logGroupName===e}))).length>0?(this._dataTracker.verifiedLogGroup=r[0],[2,r[0]]):[4,this.createLogGroup({logGroupName:e})];case 4:return i.sent(),[2,null];case 5:throw n=i.sent(),o="failure during log group search: ".concat(n),_.error(o),n;case 6:return[2]}}))}))},e.prototype._validateLogStreamExists=function(e,t){return v(this,void 0,void 0,(function(){var r,n,o,i;return y(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),[4,this._ensureCredentials()];case 1:if(!a.sent())throw new Error(p.hp);return[4,this.getLogStreams({logGroupName:e,logStreamNamePrefix:t})];case 2:return(r=a.sent()).logStreams&&(n=r.logStreams.filter((function(e){return e.logStreamName===t}))).length>0?(this._nextSequenceToken=n[0].uploadSequenceToken,[2,n[0]]):[4,this.createLogStream({logGroupName:e,logStreamName:t})];case 3:return a.sent(),[2,null];case 4:throw o=a.sent(),i="failure during log stream search: ".concat(o),_.error(i),o;case 5:return[2]}}))}))},e.prototype._sendLogEvents=function(e){return v(this,void 0,void 0,(function(){var t,r,n;return y(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,this._ensureCredentials()];case 1:if(!o.sent())throw new Error(p.hp);return _.debug("sending log events to stream - ",e.logStreamName),t=new u.A(e),[4,this._initCloudWatchLogs().send(t)];case 2:return[2,o.sent()];case 3:return r=o.sent(),n="failure during log push: ".concat(r),_.error(n),[3,4];case 4:return[2]}}))}))},e.prototype._initCloudWatchLogs=function(){return new c.T({region:this._config.region,credentials:this._config.credentials,customUserAgent:(0,f.Ij)(),endpoint:this._config.endpoint})},e.prototype._ensureCredentials=function(){return v(this,void 0,void 0,(function(){var e=this;return y(this,(function(t){switch(t.label){case 0:return[4,l.J.get().then((function(t){if(!t)return!1;var r=l.J.shear(t);return _.debug("set credentials for logging",r),e._config.credentials=r,!0})).catch((function(e){return _.warn("ensure credentials error",e),!1}))];case 1:return[2,t.sent()]}}))}))},e.prototype._getNextSequenceToken=function(){return v(this,void 0,void 0,(function(){var e,t;return y(this,(function(r){switch(r.label){case 0:if(this._nextSequenceToken&&this._nextSequenceToken.length>0)return[2,this._nextSequenceToken];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this._validateLogGroupExistsAndCreate(this._config.logGroupName)];case 2:return r.sent(),this._nextSequenceToken=void 0,[4,this._validateLogStreamExists(this._config.logGroupName,this._config.logStreamName)];case 3:return(e=r.sent())&&(this._nextSequenceToken=e.uploadSequenceToken),[2,this._nextSequenceToken];case 4:throw t=r.sent(),_.error("failure while getting next sequence token: ".concat(t)),t;case 5:return[2]}}))}))},e.prototype._safeUploadLogEvents=function(){return v(this,void 0,void 0,(function(){var e,t,r,n,o;return y(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this._getNextSequenceToken()];case 1:return e=i.sent(),t=0===this._currentLogBatch.length?this._getBufferedBatchOfLogs():this._currentLogBatch,r={logGroupName:this._config.logGroupName,logStreamName:this._config.logStreamName,logEvents:t,sequenceToken:e},this._dataTracker.eventUploadInProgress=!0,[4,this._sendLogEvents(r)];case 2:return n=i.sent(),this._nextSequenceToken=n.nextSequenceToken,this._dataTracker.eventUploadInProgress=!1,this._currentLogBatch=[],[2,n];case 3:if(o=i.sent(),_.error("error during _safeUploadLogEvents: ".concat(o)),!p.FE.includes(o.name))throw this._dataTracker.eventUploadInProgress=!1,o;return this._getNewSequenceTokenAndSubmit({logEvents:this._currentLogBatch,logGroupName:this._config.logGroupName,logStreamName:this._config.logStreamName}),[3,4];case 4:return[2]}}))}))},e.prototype._getBufferedBatchOfLogs=function(){for(var e=0,t=0;e<this._dataTracker.logEvents.length;){var r=this._dataTracker.logEvents[e],n=r?(new TextEncoder).encode(r.message).length+p.wl:0;if(n>p.pb){var o="Log entry exceeds maximum size for CloudWatch logs. Log size: ".concat(n,". Truncating log message.");_.warn(o),r.message=r.message.substring(0,n)}if(t+n>p.wK)break;t+=n,e++}return this._currentLogBatch=this._dataTracker.logEvents.splice(0,e),this._currentLogBatch},e.prototype._getNewSequenceTokenAndSubmit=function(e){return v(this,void 0,void 0,(function(){var t,r,n;return y(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),this._nextSequenceToken=void 0,this._dataTracker.eventUploadInProgress=!0,[4,this._getNextSequenceToken()];case 1:return t=o.sent(),e.sequenceToken=t,[4,this._sendLogEvents(e)];case 2:return r=o.sent(),this._dataTracker.eventUploadInProgress=!1,this._currentLogBatch=[],[2,r];case 3:throw n=o.sent(),_.error("error when retrying log submission with new sequence token: ".concat(n)),this._dataTracker.eventUploadInProgress=!1,n;case 4:return[2]}}))}))},e.prototype._initiateLogPushInterval=function(){var e=this;this._timer&&clearInterval(this._timer),this._timer=setInterval((function(){return v(e,void 0,void 0,(function(){var e;return y(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),this._getDocUploadPermissibility()?[4,this._safeUploadLogEvents()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return e=t.sent(),_.error("error when calling _safeUploadLogEvents in the timer interval - ".concat(e)),[3,4];case 4:return[2]}}))}))}),2e3)},e.prototype._getDocUploadPermissibility=function(){return(0!==this._dataTracker.logEvents.length||0!==this._currentLogBatch.length)&&!this._dataTracker.eventUploadInProgress},e.PROVIDER_NAME=p.xU,e.CATEGORY=p.OU,e}()},92352:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var n=r(34549),o=r(64988),i=r(88319),a=function(){function e(){this._logger=new n.C("ServiceWorker")}return Object.defineProperty(e.prototype,"serviceWorker",{get:function(){return this._serviceWorker},enumerable:!1,configurable:!0}),e.prototype.register=function(e,t){var r=this;return void 0===e&&(e="/service-worker.js"),void 0===t&&(t="/"),this._logger.debug("registering ".concat(e)),this._logger.debug("registering service worker with scope ".concat(t)),new Promise((function(n,o){if(!navigator||!("serviceWorker"in navigator))return o(new Error("Service Worker not available"));navigator.serviceWorker.register(e,{scope:t}).then((function(e){return e.installing?r._serviceWorker=e.installing:e.waiting?r._serviceWorker=e.waiting:e.active&&(r._serviceWorker=e.active),r._registration=e,r._setupListeners(),r._logger.debug("Service Worker Registration Success: ".concat(e)),n(e)})).catch((function(e){return r._logger.debug("Service Worker Registration Failed ".concat(e)),o(e)}))}))},e.prototype.enablePush=function(e){var t=this;if(!this._registration)throw new Error("Service Worker not registered");return this._publicKey=e,new Promise((function(r,n){if(!(0,o.gy)().isBrowser)return n(new Error("Service Worker not available"));t._registration.pushManager.getSubscription().then((function(n){if(!n)return t._logger.debug("User is NOT subscribed to push"),t._registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t._urlB64ToUint8Array(e)}).then((function(e){t._subscription=e,t._logger.debug("User subscribed: ".concat(JSON.stringify(e))),r(e)})).catch((function(e){t._logger.error(e)}));t._subscription=n,t._logger.debug("User is subscribed to push: ".concat(JSON.stringify(n))),r(n)}))}))},e.prototype._urlB64ToUint8Array=function(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(t),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n},e.prototype.send=function(e){this._serviceWorker&&this._serviceWorker.postMessage("object"==typeof e?JSON.stringify(e):e)},e.prototype._setupListeners=function(){var e=this;this._serviceWorker.addEventListener("statechange",(function(t){var r=e._serviceWorker.state;e._logger.debug("ServiceWorker statechange: ".concat(r)),i.H.Analytics&&"function"==typeof i.H.Analytics.record&&i.H.Analytics.record({name:"ServiceWorker",attributes:{state:r}})})),this._serviceWorker.addEventListener("message",(function(t){e._logger.debug("ServiceWorker message event: ".concat(t))}))},e}()},36525:(e,t,r)=>{"use strict";r.d(t,{l:()=>c});var n=r(10465),o=r(99821),i=r(12334),a=r(35842),s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},u=/([^\.]+)\.(?:([^\.]*)\.)?amazonaws\.com(.cn)?$/,c=function(){function e(){}return e.sign=function(e,t,r){if(e.headers=e.headers||{},e.body&&!e.data)throw new Error('The attribute "body" was found on the request object. Please use the attribute "data" instead.');var n=s(s({},e),{body:e.data,url:new URL(e.url)}),i=l(n,t,r),a=(0,o.z)(n,i);return a.url=a.url.toString(),a.headers.Authorization=a.headers.authorization,a.headers["X-Amz-Security-Token"]=a.headers["x-amz-security-token"],delete a.headers.authorization,delete a.headers["x-amz-security-token"],a},e.signUrl=function(e,t,r,n){var o="object"==typeof e?e.url:e,s="object"==typeof e?e.method:"GET",u={body:"object"==typeof e?e.body:void 0,method:s,url:new URL(o)},c=l(u,t,r,n),d=(0,i.o)(u,c);return t.session_token&&!f(c.signingService)&&d.searchParams.append(a.r2,t.session_token),d.toString()},e}(),l=function(e,t,r,o){var i=null!=t?t:{},a=i.access_key,u=i.secret_key,c=i.session_token,l=d(e.url),h=l.region,p=l.service,v=null!=r?r:{},y=v.region,g=void 0===y?h:y,m=v.service,_=void 0===m?p:m,b=s({accessKeyId:a,secretAccessKey:u},f(_)?{sessionToken:c}:{});return s({credentials:b,signingDate:n.E.getDateWithClockOffset(),signingRegion:g,signingService:_},o&&{expiration:o})},d=function(e){var t,r=(null!==(t=e.host.match(u))&&void 0!==t?t:[]).slice(1,3);return"es"===r[1]&&(r=r.reverse()),{service:r[0],region:r[1]}},f=function(e){return"iotdevicegateway"!==e}},54769:(e,t,r)=>{"use strict";r.d(t,{i:()=>i});var n={},o=function(){function e(){}return e.setItem=function(e,t){return n[e]=t,n[e]},e.getItem=function(e){return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0},e.removeItem=function(e){return delete n[e]},e.clear=function(){return n={}},e}(),i=function(){function e(){try{this.storageWindow=window.localStorage,this.storageWindow.setItem("aws.amplify.test-ls",1),this.storageWindow.removeItem("aws.amplify.test-ls")}catch(e){this.storageWindow=o}}return e.prototype.getStorage=function(){return this.storageWindow},e}()},69038:(e,t,r)=>{"use strict";r.d(t,{l:()=>s});var n=r(51145),o=r(64988),i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},a=(0,o.gy)().isBrowser,s=function(){function e(e){void 0===e&&(e={}),this.cookies=new n.A,this.store=a?window.localStorage:Object.create(null),this.cookies=e.req?new n.A(decodeURIComponent(e.req.headers.cookie)):new n.A,Object.assign(this.store,this.cookies.getAll())}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.entries(this.store).length},enumerable:!1,configurable:!0}),e.prototype.clear=function(){var e=this;Array.from(new Array(this.length)).map((function(t,r){return e.key(r)})).forEach((function(t){return e.removeItem(t)}))},e.prototype.getItem=function(e){return this.getLocalItem(e)},e.prototype.getLocalItem=function(e){return Object.prototype.hasOwnProperty.call(this.store,e)?this.store[e]:null},e.prototype.getUniversalItem=function(e){return this.cookies.get(e)},e.prototype.key=function(e){return Object.keys(this.store)[e]},e.prototype.removeItem=function(e){this.removeLocalItem(e),this.removeUniversalItem(e)},e.prototype.removeLocalItem=function(e){delete this.store[e]},e.prototype.removeUniversalItem=function(e){this.cookies.remove(e,{path:"/"})},e.prototype.setItem=function(e,t){this.setLocalItem(e,t);var r=e.split(".").pop();["LastAuthUser","accessToken","refreshToken","idToken"].includes(null!=r?r:"")&&this.setUniversalItem(e,t,{expires:new Date(Date.now()+31536e6)})},e.prototype.setLocalItem=function(e,t){this.store[e]=t},e.prototype.setUniversalItem=function(e,t,r){void 0===r&&(r={}),this.cookies.set(e,t,i(i({},r),{path:"/",sameSite:!0,secure:!a||"localhost"!==window.location.hostname}))},e}()},7025:(e,t,r)=>{"use strict";r.d(t,{FE:()=>c,OU:()=>a,hp:()=>u,pb:()=>i,wK:()=>o,wl:()=>n,xU:()=>s});var n=26,o=1048576,i=256e3,a="Logging",s="AWSCloudWatch",u="No credentials",c=["ResourceNotFoundException","InvalidSequenceTokenException"]},10465:(e,t,r)=>{"use strict";r.d(t,{E:()=>o});var n=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o={clockOffset:0,getDateWithClockOffset:function(){return o.clockOffset?new Date((new Date).getTime()+o.clockOffset):new Date},getClockOffset:function(){return o.clockOffset},getHeaderStringFromDate:function(e){return void 0===e&&(e=o.getDateWithClockOffset()),e.toISOString().replace(/[:\-]|\.\d{3}/g,"")},getDateFromHeaderString:function(e){var t=n(e.match(/^(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2}).+/),7),r=t[1],o=t[2],i=t[3],a=t[4],s=t[5],u=t[6];return new Date(Date.UTC(Number(r),Number(o)-1,Number(i),Number(a),Number(s),Number(u)))},isClockSkewed:function(e){return Math.abs(e.getTime()-o.getDateWithClockOffset().getTime())>=3e5},isClockSkewError:function(e){if(!e.response||!e.response.headers)return!1;var t=e.response.headers;return Boolean(["BadRequestException","InvalidSignatureException"].includes(t["x-amzn-errortype"])&&(t.date||t.Date))},setClockOffset:function(e){o.clockOffset=e}}},67453:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(64988),o=r(16064);const i=r.n(o)();var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};const s=function(){function e(){}return e.prototype.networkMonitor=function(t){if((0,n.gy)().isNode)return i.from([{online:!0}]);var r=(0,n.p7)()?self:window;return new i((function(t){t.next({online:r.navigator.onLine});var n=function(){return t.next({online:!0})},o=function(){return t.next({online:!1})};return r.addEventListener("online",n),r.addEventListener("offline",o),e._observers.push(t),function(){r.removeEventListener("online",n),r.removeEventListener("offline",o),e._observers=e._observers.filter((function(e){return e!==t}))}}))},e._observerOverride=function(t){var r,n,o=function(r){if(r.closed)return e._observers=e._observers.filter((function(e){return e!==r})),"continue";r.next(t)};try{for(var i=a(e._observers),s=i.next();!s.done;s=i.next()){o(s.value)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e._observers=[],e}()},766:(e,t,r)=>{"use strict";r.d(t,{L5:()=>h,OI:()=>d,gD:()=>f,hu:()=>y,yN:()=>v});var n,o=r(34549),i=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},s=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},u=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},c=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},l=new o.C("Util"),d=function(e){function t(t){var r=e.call(this,t)||this;return r.nonRetryable=!0,r}return i(t,e),t}(Error),f=function(e){return e&&e.nonRetryable};function h(e,t,r,n){return a(this,void 0,void 0,(function(){var o=this;return s(this,(function(i){if("function"!=typeof e)throw Error("functionToRetry must be a function");return[2,new Promise((function(i,d){return a(o,void 0,void 0,(function(){var o,a,h,p,v,y,g;return s(this,(function(m){switch(m.label){case 0:o=0,a=!1,p=function(){},n&&n.then((function(){a=!0,clearTimeout(h),p()})),y=function(){var n,y,g,m;return s(this,(function(s){switch(s.label){case 0:o++,l.debug("".concat(e.name," attempt #").concat(o," with this vars: ").concat(JSON.stringify(t))),s.label=1;case 1:return s.trys.push([1,3,,7]),n={},y=i,[4,e.apply(void 0,c([],u(t),!1))];case 2:return[2,(n.value=y.apply(void 0,[s.sent()]),n)];case 3:return g=s.sent(),v=g,l.debug("error on ".concat(e.name),g),f(g)?(l.debug("".concat(e.name," non retryable error"),g),[2,{value:d(g)}]):(m=r(o,t,g),l.debug("".concat(e.name," retrying in ").concat(m," ms")),!1===m||a?[2,{value:d(g)}]:[3,4]);case 4:return[4,new Promise((function(e){p=e,h=setTimeout(p,m)}))];case 5:s.sent(),s.label=6;case 6:return[3,7];case 7:return[2]}}))},m.label=1;case 1:return a?[3,3]:[5,y()];case 2:return"object"==typeof(g=m.sent())?[2,g.value]:[3,1];case 3:return d(v),[2]}}))}))}))]}))}))}var p=3e5;function v(e){void 0===e&&(e=p);return function(t){var r=100*Math.pow(2,t)+100*Math.random();return!(r>e)&&r}}var y=function(e,t,r,n){return void 0===r&&(r=p),h(e,t,v(r),n)}},32658:(e,t,r)=>{"use strict";function n(e){return e.split("").map((function(e){return e.charCodeAt(0).toString(16).padStart(2,"0")})).join("")}function o(e){return e.match(/.{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join("")}r.d(t,{l:()=>o,r:()=>n})},82622:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});var n={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},o={partitions:[n,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(e){var t,r,a=o.partitions;try{for(var s=i(a),u=s.next();!u.done;u=s.next()){var c=u.value,l=c.regions,d=c.outputs,f=c.regionRegex,h=new RegExp(f);if(l.includes(e)||h.test(e))return d.dnsSuffix}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return n.outputs.dnsSuffix}},37939:(e,t,r)=>{"use strict";r.d(t,{C:()=>u});var n=r(90502),o=r(20769),i=r(29368),a=r(12215),s=r(6212),u=(0,a.q)(s.Q,[i.L,n.D,o._])},6212:(e,t,r)=>{"use strict";r.d(t,{Q:()=>u});r(50916);var n=r(85884),o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},a=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},s=function(e){return!["HEAD","GET","DELETE"].includes(e.toUpperCase())},u=function(e,t){var r=e.url,u=e.method,c=e.headers,l=e.body,d=t.abortSignal;return i(void 0,void 0,void 0,(function(){var e,t,i,f,h,p,v;return a(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,fetch(r,{method:u,headers:c,body:s(u)?l:void 0,signal:d})];case 1:return e=a.sent(),[3,3];case 2:if((t=a.sent())instanceof TypeError)throw new Error("Network error");throw t;case 3:return i={},null===(p=e.headers)||void 0===p||p.forEach((function(e,t){i[t.toLowerCase()]=e})),f={statusCode:e.status,headers:i,body:null},h=Object.assign(null!==(v=e.body)&&void 0!==v?v:{},{text:(0,n.n)((function(){return e.text()})),blob:(0,n.n)((function(){return e.blob()})),json:(0,n.n)((function(){return e.json()}))}),[2,o(o({},f),{body:h})]}}))}))}},55841:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=function(e,t,r,a){return function(s,u){return o(void 0,void 0,void 0,(function(){var o,c,l,d;return i(this,(function(i){switch(i.label){case 0:return[4,(o=n(n({},a),s)).endpointResolver(o,u)];case 1:return c=i.sent(),[4,t(u,c)];case 2:return l=i.sent(),[4,e(l,n({},o))];case 3:return d=i.sent(),[4,r(d)];case 4:return[2,i.sent()]}}))}))}}},12215:(e,t,r)=>{"use strict";r.d(t,{q:()=>n});var n=function(e,t){return function(r,n){for(var o={},i=function(t){return e(t,n)},a=t.length-1;a>=0;a--){i=(0,t[a])(n)(i,o)}return i(r)}}},16824:(e,t,r)=>{"use strict";r.d(t,{D:()=>s});var n=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],o=function(e){return n.includes(e)},i=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},a=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},s=function(e){return function(t,r){return i(void 0,void 0,void 0,(function(){var n,i,s,u;return a(this,(function(a){switch(a.label){case 0:return null==r?[3,1]:(i=r,[3,3]);case 1:return[4,e(t)];case 2:i=a.sent(),a.label=3;case 3:return n=(null!==(u=i)&&void 0!==u?u:{}).name,s=null==t?void 0:t.statusCode,[2,d(r)||l(s,n)||o(n)||f(s,n)]}}))}))}},u=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],c=["TimeoutError","RequestTimeout","RequestTimeoutException"],l=function(e,t){return 429===e||u.includes(t)},d=function(e){return"Network error"===(null==e?void 0:e.name)},f=function(e,t){return[500,502,503,504].includes(e)||c.includes(t)}},98641:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});var n=r(766),o=3e5,i=function(e){var t=(0,n.yN)(o)(e);return!1===t?o:t}},90502:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var n=function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=function(e){var t=e.maxAttempts,r=void 0===t?3:t,n=e.retryDecider,a=e.computeDelay,c=e.abortSignal;if(r<1)throw new Error("maxAttempts must be greater than 0");return function(e,t){return function(l){var d;return o(this,void 0,void 0,(function(){var o,f,h,p,v,y;return i(this,(function(i){switch(i.label){case 0:f=null!==(d=t.attemptsCount)&&void 0!==d?d:0,p=function(){if(h)return u(h,f),h;throw u(o,f),o},i.label=1;case 1:if((null==c?void 0:c.aborted)||!(f<r))return[3,11];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,e(l)];case 3:return h=i.sent(),o=void 0,[3,5];case 4:return v=i.sent(),o=v,h=void 0,[3,5];case 5:return f=t.attemptsCount>f?t.attemptsCount:f+1,t.attemptsCount=f,[4,n(h,o)];case 6:return i.sent()?!(null==c?void 0:c.aborted)&&f<r?(y=a(f),[4,s(y,c)]):[3,8]:[3,9];case 7:i.sent(),i.label=8;case 8:return[3,1];case 9:return[2,p()];case 10:return[3,1];case 11:if(null==c?void 0:c.aborted)throw new Error("Request aborted.");return[2,p()]}}))}))}}},s=function(e,t){if(null==t?void 0:t.aborted)return Promise.resolve();var r,n,o=new Promise((function(t){n=t,r=setTimeout(t,e)}));return null==t||t.addEventListener("abort",(function e(o){clearTimeout(r),null==t||t.removeEventListener("abort",e),n()})),o},u=function(e,t){var r;"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata=n(n({},null!==(r=e.$metadata)&&void 0!==r?r:{}),{attempts:t}))}},20769:(e,t,r)=>{"use strict";r.d(t,{_:()=>u});var n=r(99821),o=function(e){return new Date(Date.now()+e)},i=function(e,t){return function(e,t){return Math.abs(o(t).getTime()-e)>=3e5}(e,t)?e-Date.now():t},a=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},s=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},u=function(e){var t,r=e.credentials,u=e.region,l=e.service,d=e.uriEscapePath,f=void 0===d||d;return function(e){return function(d){return a(this,void 0,void 0,(function(){var a,h,p,v,y,g;return s(this,(function(s){switch(s.label){case 0:return t=null!=t?t:0,g={},"function"!=typeof r?[3,2]:[4,r()];case 1:return h=s.sent(),[3,3];case 2:h=r,s.label=3;case 3:return g.credentials=h,g.signingDate=o(t),g.signingRegion=u,g.signingService=l,g.uriEscapePath=f,a=g,[4,(0,n.z)(d,a)];case 4:return p=s.sent(),[4,e(p)];case 5:return v=s.sent(),(y=c(v))&&(t=i(Date.parse(y),t)),[2,v]}}))}))}}},c=function(e){var t,r,n=(void 0===e?{}:e).headers;return null!==(r=null!==(t=null==n?void 0:n.date)&&void 0!==t?t:null==n?void 0:n.Date)&&void 0!==r?r:null==n?void 0:n["x-amz-date"]}},35842:(e,t,r)=>{"use strict";r.d(t,{EK:()=>v,FY:()=>u,H1:()=>l,MS:()=>a,VQ:()=>p,XI:()=>n,Zs:()=>o,cR:()=>s,fM:()=>g,nt:()=>y,ot:()=>f,r2:()=>c,tI:()=>i,wE:()=>h,z8:()=>m,zX:()=>d});var n="X-Amz-Algorithm",o="X-Amz-Date",i="X-Amz-Credential",a="X-Amz-Expires",s="X-Amz-Signature",u="X-Amz-SignedHeaders",c="X-Amz-Security-Token",l="authorization",d="host",f=o.toLowerCase(),h=c.toLowerCase(),p="aws4_request",v="AWS4-HMAC-SHA256",y="AWS4",g="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",m="UNSIGNED-PAYLOAD"},12334:(e,t,r)=>{"use strict";r.d(t,{o:()=>c});var n=r(35842),o=r(20531),i=r(23414),a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},u=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},c=function(e,t){var r,c,l,d,f=e.body,h=e.method,p=void 0===h?"GET":h,v=e.url,y=t.expiration,g=s(t,["expiration"]),m=(0,o.y)(g),_=m.accessKeyId,b=m.credentialScope,w=m.longDate,S=m.sessionToken,E=new URL(v);Object.entries(a(a((r={},r[n.XI]=n.EK,r[n.tI]="".concat(_,"/").concat(b),r[n.Zs]=w,r[n.FY]=n.zX,r),y&&(c={},c[n.MS]=y.toString(),c)),S&&(l={},l[n.r2]=S,l))).forEach((function(e){var t=u(e,2),r=t[0],n=t[1];E.searchParams.append(r,n)}));var x={body:f,headers:(d={},d[n.zX]=v.host,d),method:p,url:E},I=(0,i.d)(x,m);return E.searchParams.append(n.cR,I),E}},99821:(e,t,r)=>{"use strict";r.d(t,{z:()=>u});var n=r(27127),o=r(20531),i=r(35842),a=r(23414),s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},u=function(e,t){var r=(0,o.y)(t),u=r.accessKeyId,c=r.credentialScope,l=r.longDate,d=r.sessionToken,f=s({},e.headers);f[i.zX]=e.url.host,f[i.ot]=l,d&&(f[i.wE]=d);var h=s(s({},e),{headers:f}),p=(0,a.d)(h,r),v="Credential=".concat(u,"/").concat(c),y="SignedHeaders=".concat((0,n.Z)(f)),g="Signature=".concat(p);return f[i.H1]="".concat(i.EK," ").concat(v,", ").concat(y,", ").concat(g),h}},46912:(e,t,r)=>{"use strict";r.d(t,{I:()=>i,h:()=>a});var n=r(33523),o=r(60102),i=function(e,t){var r=new n.Sha256(e);return r.update(t),r.digestSync()},a=function(e,t){var r=i(e,t);return(0,o.n)(r)}},22576:(e,t,r)=>{"use strict";r.d(t,{M:()=>i});var n=r(35842),o=r(46912),i=function(e){return null==e?n.fM:a(e)?(0,o.h)(null,e):n.z8},a=function(e){return"string"==typeof e||ArrayBuffer.isView(e)||s(e)},s=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)}},23414:(e,t,r)=>{"use strict";r.d(t,{d:()=>h});var n=r(46912),o=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=function(e){return Object.entries(e).map((function(e){var t,r=o(e,2),n=r[0],i=r[1];return{key:n.toLowerCase(),value:null!==(t=null==i?void 0:i.trim().replace(/\s+/g," "))&&void 0!==t?t:""}})).sort((function(e,t){return e.key<t.key?-1:1})).map((function(e){return"".concat(e.key,":").concat(e.value,"\n")})).join("")},a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,u)},u=function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())},c=function(e,t){return void 0===t&&(t=!0),e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/"},l=r(22576),d=r(27127),f=r(35842),h=function(e,t){var r=t.credentialScope,o=t.longDate,u=t.secretAccessKey,h=t.shortDate,p=t.signingRegion,v=t.signingService,y=function(e,t){var r,n=e.body,o=e.headers,u=e.method,f=e.url;return void 0===t&&(t=!0),[u,c(f.pathname,t),(r=f.searchParams,Array.from(r).sort((function(e,t){var r=a(e,2),n=r[0],o=r[1],i=a(t,2),s=i[0],u=i[1];return n===s?o<u?-1:1:n<s?-1:1})).map((function(e){var t=a(e,2),r=t[0],n=t[1];return"".concat(s(r),"=").concat(s(n))})).join("&")),i(o),(0,d.Z)(o),(0,l.M)(n)].join("\n")}(e,t.uriEscapePath),g=function(e,t,r){return[f.EK,e,t,r].join("\n")}(o,r,(0,n.h)(null,y)),m=(0,n.h)(function(e,t,r,o){var i="".concat(f.nt).concat(e),a=(0,n.I)(i,t),s=(0,n.I)(a,r),u=(0,n.I)(s,o);return(0,n.I)(u,f.VQ)}(u,h,p,v),g);return m}},27127:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var n=function(e){return Object.keys(e).map((function(e){return e.toLowerCase()})).sort().join(";")}},20531:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var n=r(35842),o=function(e){var t,r,o=e.credentials,i=e.signingDate,a=void 0===i?new Date:i,s=e.signingRegion,u=e.signingService,c=e.uriEscapePath,l=void 0===c||c,d=o.accessKeyId,f=o.secretAccessKey,h=o.sessionToken,p=function(e){var t=e.toISOString().replace(/[:\-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}}(a),v=p.longDate,y=p.shortDate;return{accessKeyId:d,credentialScope:(t=s,r=u,"".concat(y,"/").concat(t,"/").concat(r,"/").concat(n.VQ)),longDate:v,secretAccessKey:f,sessionToken:h,shortDate:y,signingRegion:s,signingService:u,uriEscapePath:l}}},64169:(e,t,r)=>{"use strict";r.d(t,{$:()=>n});var n=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,o)},o=function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}},29368:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});var n=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i=function(e){var t=e.userAgentHeader,r=void 0===t?"x-amz-user-agent":t,i=e.userAgentValue,a=void 0===i?"":i;return function(e){return function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return 0!==a.trim().length?[3,2]:[4,e(t)];case 1:return[2,o.sent()];case 2:return n=r.toLowerCase(),t.headers[n]=t.headers[n]?"".concat(t.headers[n]," ").concat(a):a,[4,e(t)];case 3:return[2,o.sent()]}}))}))}}}},26170:(e,t,r)=>{"use strict";r.d(t,{F:()=>s,Y:()=>u});var n=r(64603),o=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=function(e){return o(void 0,void 0,void 0,(function(){var t,r,o,s,c,l,d,f,h;return i(this,(function(i){switch(i.label){case 0:return!e||e.statusCode<300?[2]:[4,u(e)];case 1:return t=i.sent(),r=function(e){var t=a(e.toString().split(/[\,\:]+/),1)[0];return t.includes("#")?t.split("#")[1]:t}(null!==(d=null!==(l=null!==(c=e.headers["x-amzn-errortype"])&&void 0!==c?c:t.code)&&void 0!==l?l:t.__type)&&void 0!==d?d:"UnknownError"),o=null!==(h=null!==(f=t.message)&&void 0!==f?f:t.Message)&&void 0!==h?h:"Unknown error",s=new Error(o),[2,Object.assign(s,{name:r,$metadata:(0,n.j)(e)})]}}))}))},u=function(e){return o(void 0,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:if(!e.body)throw new Error("Missing response payload");return[4,e.body.json()];case 1:return t=r.sent(),[2,Object.assign(t,{$metadata:(0,n.j)(e)})]}}))}))}},64603:(e,t,r)=>{"use strict";r.d(t,{j:()=>o});var n=function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=function(e){var t,r,o=e.headers,a=e.statusCode;return n(n({},i(e)?e.$metadata:{}),{httpStatusCode:a,requestId:null!==(r=null!==(t=o["x-amzn-requestid"])&&void 0!==t?t:o["x-amzn-request-id"])&&void 0!==r?r:o["x-amz-request-id"],extendedRequestId:o["x-amz-id-2"],cfId:o["x-amz-cf-id"]})},i=function(e){return"object"==typeof(null==e?void 0:e.$metadata)}},85884:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var n=function(e){var t;return function(){return t||(t=e()),t}}},35166:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o,b:()=>n});var n="undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER"):"@@INTERNAL_AWS_APPSYNC_REALTIME_PUBSUB_PROVIDER",o="x-amz-user-agent"},3976:(e,t,r)=>{"use strict";r.d(t,{s:()=>a});var n=r(34549),o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=new n.C("Parser"),a=function(e){var t,r={};if(e.aws_mobile_analytics_app_id){var n={AWSPinpoint:{appId:e.aws_mobile_analytics_app_id,region:e.aws_mobile_analytics_app_region}};r.Analytics=n}return(e.aws_cognito_identity_pool_id||e.aws_user_pools_id)&&(r.Auth={userPoolId:e.aws_user_pools_id,userPoolWebClientId:e.aws_user_pools_web_client_id,region:e.aws_cognito_region,identityPoolId:e.aws_cognito_identity_pool_id,identityPoolRegion:e.aws_cognito_region,mandatorySignIn:"enable"===e.aws_mandatory_sign_in,signUpVerificationMethod:e.aws_cognito_sign_up_verification_method||"code"}),t=e.aws_user_files_s3_bucket?{AWSS3:{bucket:e.aws_user_files_s3_bucket,region:e.aws_user_files_s3_bucket_region,dangerouslyConnectToHttpEndpointForTesting:e.aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing}}:e?e.Storage||e:{},e.Logging&&(r.Logging=o(o({},e.Logging),{region:e.aws_project_region})),e.geo&&(r.Geo=Object.assign({},e.geo),e.geo.amazon_location_service&&(r.Geo={AmazonLocationService:e.geo.amazon_location_service})),r.Analytics=Object.assign({},r.Analytics,e.Analytics),r.Auth=Object.assign({},r.Auth,e.Auth),r.Storage=Object.assign({},t),r.Logging=Object.assign({},r.Logging,e.Logging),i.debug("parse config",e,"to amplifyconfig",r),r}},26414:(e,t,r)=>{"use strict";r.d(t,{os:()=>Wt});var n,o,i=r(15215),a=r(5548),s=r(16772),u=r(11125),c=r(34549),l=r(64988),d=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},h=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(u){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},p=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},v=function(){function e(){this._state=o.Open,this.jobs=new Set}return e.prototype.add=function(t,r){var n,o;"string"==typeof t?(n=void 0,o=t):(n=t,o=r);var i=this.closedFailure(o);if(i)return i;if(void 0===n)return this.addHook(o);if("function"==typeof n)return this.addFunction(n,o);if(n instanceof e)return this.addManager(n,o);throw new Error("If `job` is provided, it must be an Observable, Function, or BackgroundProcessManager.")},e.prototype.addCleaner=function(e,t){var r=this,n=this.addHook(t),o=n.resolve,i=function(){return f(r,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,e()];case 1:return t.sent(),o(),[2]}}))}))};return n.onTerminate.then(i),i},e.prototype.addFunction=function(e,t){var r,n=e(new Promise((function(e){r=e})));return"function"==typeof(null==n?void 0:n.then)&&this.registerPromise(n,r,t),n},e.prototype.addManager=function(e,t){var r=this;this.addCleaner((function(){return f(r,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return[4,e.close()];case 1:return[2,t.sent()]}}))}))}),t)},e.prototype.addHook=function(e){var t,r,n,o=new Promise((function(e,n){t=e,r=n})),i=new Promise((function(e){n=e}));return this.registerPromise(o,n,e),{resolve:t,reject:r,onTerminate:i}},e.prototype.registerPromise=function(e,t,r){var n=this,o={promise:e,terminate:t,description:r};this.jobs.add(o),e.then((function(){n.jobs.delete(o)})).catch((function(){n.jobs.delete(o)}))},Object.defineProperty(e.prototype,"length",{get:function(){return this.jobs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pending",{get:function(){return Array.from(this.jobs).map((function(e){return e.description}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._state===o.Open},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClosing",{get:function(){return this._state===o.Closing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClosed",{get:function(){return this._state===o.Closed},enumerable:!1,configurable:!0}),e.prototype.closedFailure=function(e){if(!this.isOpen)return Promise.reject(new y(["The manager is ".concat(this.state,"."),'You tried to add "'.concat(e,'".'),"Pending jobs: [\n".concat(this.pending.map((function(e){return"    "+e})).join(",\n"),"\n]")].join("\n")))},e.prototype.close=function(){return f(this,void 0,void 0,(function(){var e,t,r,n,i;return h(this,(function(a){switch(a.label){case 0:if(!this.isOpen)return[3,2];this._state=o.Closing;try{for(e=p(Array.from(this.jobs)),t=e.next();!t.done;t=e.next()){r=t.value;try{r.terminate()}catch(e){console.warn("Failed to send termination signal to job. Error: ".concat(e.message),r)}}}catch(e){n={error:e}}finally{try{t&&!t.done&&(i=e.return)&&i.call(e)}finally{if(n)throw n.error}}return this._closingPromise=Promise.allSettled(Array.from(this.jobs).map((function(e){return e.promise}))),[4,this._closingPromise];case 1:a.sent(),this._state=o.Closed,a.label=2;case 2:return[2,this._closingPromise]}}))}))},e.prototype.open=function(){return f(this,void 0,void 0,(function(){return h(this,(function(e){switch(e.label){case 0:return this.isClosing?[4,this.close()]:[3,2];case 1:e.sent(),e.label=2;case 2:return this._state=o.Open,[2]}}))}))},e}(),y=function(e){function t(t){return e.call(this,"BackgroundManagerNotOpenError: ".concat(t))||this}return d(t,e),t}(Error);!function(e){e.Open="Open",e.Closing="Closing",e.Closed="Closed"}(o||(o={}));var g=r(78868),m=r(88319),_=r(41261),b=(r(78336),r(16064));const w=r.n(b)();var S=r(22924),E=r(29640);function x(e){return"private"!==e.allow||e.provider?"public"!==e.allow||e.provider?e.provider:E.N2.API_KEY:E.N2.USER_POOLS}function I(e){var t=e.rules,r=e.currentUser,n=new Set;return t.forEach((function(e){switch(e.allow){case E.Jw.CUSTOM:e.provider&&e.provider!==E.N2.FUNCTION||n.add(S.Tv.AWS_LAMBDA);break;case E.Jw.GROUPS:case E.Jw.OWNER:r&&(e.provider===E.N2.USER_POOLS?n.add(S.Tv.AMAZON_COGNITO_USER_POOLS):e.provider===E.N2.OIDC&&n.add(S.Tv.OPENID_CONNECT));break;case E.Jw.PRIVATE:r&&(e.provider&&e.provider!==E.N2.USER_POOLS?e.provider===E.N2.IAM&&n.add(S.Tv.AWS_IAM):n.add(S.Tv.AMAZON_COGNITO_USER_POOLS));break;case E.Jw.PUBLIC:e.provider===E.N2.IAM?n.add(S.Tv.AWS_IAM):e.provider&&e.provider!==E.N2.API_KEY||n.add(S.Tv.API_KEY)}})),Array.from(n)}var P=function(e){return function(t){var r=t.schema,n=t.modelName;return(0,i.__awaiter)(void 0,void 0,void 0,(function(){var t,o,a,u,c;return(0,i.__generator)(this,(function(l){switch(l.label){case 0:e.Auth=e.Auth||s.N,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,e.Auth.currentAuthenticatedUser()];case 2:return t=l.sent(),[3,4];case 3:return l.sent(),[3,4];case 4:return(o=r.namespaces.user.models[n].attributes)&&(a=o.find((function(e){return"auth"===e.type})),null===(c=null==a?void 0:a.properties)||void 0===c?void 0:c.rules)?(d=a.properties.rules,f=[E.Jw.CUSTOM,E.Jw.OWNER,E.Jw.GROUPS,E.Jw.PRIVATE,E.Jw.PUBLIC],h=[E.N2.FUNCTION,E.N2.USER_POOLS,E.N2.OIDC,E.N2.IAM,E.N2.API_KEY],u=(0,i.__spread)(d).sort((function(e,t){return e.allow===t.allow?h.indexOf(x(e))-h.indexOf(x(t)):f.indexOf(e.allow)-f.indexOf(t.allow)})),[2,I({currentUser:t,rules:u})]):[2,[]]}var d,f,h}))}))}},A=function(){return[]},T=r(39820),C=r(80982);const O=function(){function e(){this._queue=[],this._pending=!1}return e.prototype.isLocked=function(){return this._pending},e.prototype.acquire=function(){var e=this,t=new Promise((function(t){return e._queue.push(t)}));return this._pending||this._dispatchNext(),t},e.prototype.runExclusive=function(e){return this.acquire().then((function(t){var r;try{r=e()}catch(e){throw t(),e}return Promise.resolve(r).then((function(e){return t(),e}),(function(e){throw t(),e}))}))},e.prototype._dispatchNext=function(){this._queue.length>0?(this._pending=!0,this._queue.shift()(this._dispatchNext.bind(this))):this._pending=!1},e}();var k,N,M=r(8381),R=r.n(M),D=r(47681),j=r(88206),F=new c.C("DataStore");!function(e){e.LIST="query",e.CREATE="mutation",e.UPDATE="mutation",e.DELETE="mutation",e.GET="query"}(k||(k={})),function(e){e.CREATE="Create",e.UPDATE="Update",e.DELETE="Delete",e.GET="Get"}(N||(N={}));var L,U={_version:void 0,_lastChangedAt:void 0,_deleted:void 0},q=Object.keys(U);function W(e,t){var r=G(t),n=function(e,t){var r=[];return Object.values(t.fields).forEach((function(t){var n=t.name,o=t.type;if((0,E.ri)(o)){var i=e.nonModels[o.nonModel],a=Object.values(G(i)).map((function(e){return e.name})),s=[];Object.values(i.fields).forEach((function(t){var r=t.type,n=t.name;if((0,E.ri)(r)){var o=e.nonModels[r.nonModel];s.push(n+" { "+W(e,o)+" }")}})),r.push(n+" { "+a.join(" ")+" "+s.join(" ")+" }")}})),r}(e,t),o=function(e,t){var r=function(e){var t=[];(0,E.QC)(e)&&e.attributes.forEach((function(e){if(e.properties&&e.properties.rules){var r=e.properties.rules.find((function(e){return"owner"===e.allow}));r&&r.ownerField&&t.push(r.ownerField)}}));return t}(e);if(!t.owner&&r.includes("owner"))return["owner"];return[]}(t,r),a=Object.values(r).map((function(e){return e.name})).concat(o).concat(n);return(0,E.rm)(t)&&(a=a.concat(q).concat(function(e,t){var r=[];return Object.values(e.fields).filter((function(e){var t=e.association;return t&&Object.keys(t).length})).forEach((function(n){var o=n.name,a=n.association,s=(a||{}).connectionType;switch(s){case"HAS_ONE":case"HAS_MANY":break;case"BELONGS_TO":if((0,E.UQ)(a))if(a.targetNames&&a.targetNames.length>0){var u=(0,i.__read)((0,D.Db)(t),1)[0][e.fields[o].type.model].indexes.find((function(e){return"byPk"===(0,i.__read)(e,1)[0]})),c=u&&u[1],l=null==c?void 0:c.join(" ");r.push(o+" { "+l+" _deleted }")}else r.push(o+" { id _deleted }");break;default:throw new Error("Invalid connection type "+s)}})),r}(t,e))),a.join("\n")}function G(e){var t=e.fields;return Object.values(t).filter((function(e){return!(!(0,E.yb)(e.type)&&!(0,E.Mz)(e.type))})).reduce((function(e,t){return e[t.name]=t,e}),{})}function B(e){var t=([].concat(e.attributes||[]).find((function(e){return e&&"auth"===e.type}))||{}).properties,r=(void 0===t?{}:t).rules,n=[];return(void 0===r?[]:r).forEach((function(t){var r=t.identityClaim,o=void 0===r?"cognito:username":r,i=t.ownerField,a=void 0===i?"owner":i,s=t.operations,u=void 0===s?["create","update","delete","read"]:s,c=t.provider,l=void 0===c?"userPools":c,d=t.groupClaim,f=void 0===d?"cognito:groups":d,h=t.allow,p=void 0===h?"iam":h,v=t.groups,y=void 0===v?[]:v,g=t.groupsField,m=void 0===g?"":g,_="owner"===p;if(u.includes("read")||_){var b={identityClaim:o,ownerField:a,provider:l,groupClaim:f,authStrategy:p,groups:y,groupsField:m,areSubscriptionsPublic:!1};if(_){var w=([].concat(e.attributes||[]).find((function(e){return e&&"model"===e.type}))||{}).properties,S=(void 0===w?{}:w).subscriptions,E=(void 0===S?{}:S).level,x=void 0===E?"on":E;b.areSubscriptionsPublic=!u.includes("read")||"public"===x}_?n.push(b):n.unshift(b)}})),n}function K(e,t,r){var n,o,i,a,s=W(e,t),u=t.name,c=t.pluralName;switch(r){case"LIST":n="sync"+c,o="($limit: Int, $nextToken: String, $lastSync: AWSTimestamp, $filter: Model"+u+"FilterInput)",i="(limit: $limit, nextToken: $nextToken, lastSync: $lastSync, filter: $filter)",s="items {\n\t\t\t\t\t\t\t"+s+"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnextToken\n\t\t\t\t\t\tstartedAt";break;case"CREATE":n="create"+u,o="($input: Create"+u+"Input!)",i="(input: $input)",a=N.CREATE;break;case"UPDATE":n="update"+u,o="($input: Update"+u+"Input!, $condition: Model"+u+"ConditionInput)",i="(input: $input, condition: $condition)",a=N.UPDATE;break;case"DELETE":n="delete"+u,o="($input: Delete"+u+"Input!, $condition: Model"+u+"ConditionInput)",i="(input: $input, condition: $condition)",a=N.DELETE;break;case"GET":n="get"+u,o="($id: ID!)",i="(id: $id)",a=N.GET;break;default:throw new Error("Invalid graphQlOpType "+r)}return[[a,n,k[r]+" operation"+o+"{\n\t\t"+n+i+"{\n\t\t\t"+s+"\n\t\t}\n\t}"]]}function z(e,t,r,n,o,a,s,u,c){var l;switch(r){case E.i5.INSERT:l=N.CREATE;break;case E.i5.UPDATE:l=N.UPDATE;break;case E.i5.DELETE:l=N.DELETE;break;default:throw new Error("Invalid opType "+r)}var d=X(t,o),f=E.i5.INSERT&&c?{id:c}:{};return u(s,(0,i.__assign)((0,i.__assign)({},f),{data:JSON.stringify(o,(function(e,r){return e&&null!==r&&"object"==typeof r&&t.fields[e]&&"AWSJSON"===t.fields[e].type?JSON.stringify(r):r})),modelId:d,model:n.name,operation:l,condition:JSON.stringify(a)}))}function V(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=!0);var n={};if(!e||!Array.isArray(e.predicates))return n;var o=e.type,a=e.predicates,s="and"===o||"or"===o;n[o]=s?[]:{};var u=[];if(a.forEach((function(e){var r,n;if((0,E.f6)(e)){var o=e.field,i=e.operator,a=e.operand;if(t.includes(o))return;var s=((r={})[o]=((n={})[i]=a,n),r);u.push(s)}else{var c=V(e,t,!1);Object.keys(c).length>0&&u.push(c)}})),1===u.length){var c=(0,i.__read)(u,1)[0];if(s&&!r||s&&r&&("and"in c||"or"in c))return delete n[o],Object.assign(n,c),n}if(u.forEach((function(e){s?n[o].push(e):n[o]=e})),s){if(0===n[o].length)return{}}else if(0===Object.keys(n[o]).length)return{};return n}function Y(e,t,r){var n=function(e){var t=new Set;if(!e||!Array.isArray(e.predicates))return t;for(var r=e.predicates,n=(0,i.__spread)(r);n.length>0;){var o=n.pop();(0,E.f6)(o)?t.add(o.field):(0,E.JW)(o)&&n.push.apply(n,(0,i.__spread)(o.predicates))}return t}(r),o=(0,i.__spread)(n).join(", "),a=function(e){var t,r,n=B(e),o=new Set;try{for(var a=(0,i.__values)(n),s=a.next();!s.done;s=a.next()){var u=s.value;u.groupsField&&!u.groups.length?o.add(u.groupsField):u.ownerField&&o.add(u.ownerField)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return o}(t),s=(0,i.__spread)(a).join(", "),u=function(e){if(!e||!Array.isArray(e.predicates))return 0;for(var t=0,r=[e];r.length>0;){var n=r.pop();if((0,E.JW)(n)){var o=n.predicates;"or"===n.type&&o.length>1&&(t+=o.length),r.push.apply(r,(0,i.__spread)(o))}}return t||1}(r),c=function(e){if(!e||!Array.isArray(e.predicates))return null;for(var t=[V(e)],r=function(e){var t,r,n={};try{for(var o=(0,i.__values)(e),a=o.next();!a.done;a=o.next()){var s=a.value,u=(0,i.__read)(Object.keys(s),1)[0];if(n[u])return u;n[u]=!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return null};t.length>0;){var n=t.pop(),o=(0,i.__read)(Object.keys(n),1)[0],a=n[o];if(!Array.isArray(a))return null;var s=a.filter((function(e){return!Array.isArray(Object.values(e)[0])})),u=a.filter((function(e){return Array.isArray(Object.values(e)[0])}));if("and"===o){var c=r(s);if(c)return c}t.push.apply(t,(0,i.__spread)(u))}return null}(r);switch(e){case L.UnknownField:return"Your API was generated with an older version of the CLI that doesn't support backend subscription filtering.To enable backend subscription filtering, upgrade your Amplify CLI to the latest version and push your app by running `amplify upgrade` followed by `amplify push`";case L.MaxAttributes:var l="Your selective sync expression for "+t.name+" contains "+n.size+" different model fields: "+o+".\n\n";return a.size>0&&(l+="Note: the number of fields you can use with selective sync is affected by @auth rules configured on the model.\n\nDynamic auth modes, such as owner auth and dynamic group auth each utilize 1 field.\nYou currently have "+a.size+" dynamic auth mode(s) configured on this model: "+s+"."),l;case L.MaxCombinations:l="Your selective sync expression for "+t.name+" contains "+u+" field combinations (total number of predicates in an OR expression).\n\n";return a.size>0&&(l+="Note: the number of fields you can use with selective sync is affected by @auth rules configured on the model.\n\nDynamic auth modes, such as owner auth and dynamic group auth factor in to the number of combinations you're using.\nYou currently have "+a.size+" dynamic auth mode(s) configured on this model: "+s+"."),l;case L.RepeatedFieldname:return"Your selective sync expression for "+t.name+" contains multiple entries for "+c+" in the same AND group.";case L.NotGroup:return"Your selective sync expression for "+t.name+" uses a `not` group. If you'd like to filter subscriptions in the backend, rewrite your expression using `ne` or `notContains` operators.";case L.FieldNotInType:return""}}function J(e,t){var r=e[t.groupClaim]||[];if("string"==typeof r){var n=void 0;try{n=JSON.parse(r)}catch(e){n=r}r=[].concat(n)}return r}function H(e){var t=e.authModeStrategy,r=e.defaultAuthMode,n=e.modelName,o=e.schema;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,a,s,u=this;return(0,i.__generator)(this,(function(c){switch(c.label){case 0:e=Object.values(E.Vn),a={CREATE:[],READ:[],UPDATE:[],DELETE:[]},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Promise.all(e.map((function(e){return(0,i.__awaiter)(u,void 0,void 0,(function(){var s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,t({schema:o,modelName:n,operation:e})];case 1:return"string"==typeof(s=i.sent())?a[e]=[s]:Array.isArray(s)&&s.length?a[e]=s:a[e]=[r],[2]}}))}))})))];case 2:return c.sent(),[3,4];case 3:return s=c.sent(),F.debug("Error getting auth modes for model: "+n,s),[3,4];case 4:return[2,a]}}))}))}function Q(e){var t,r=["Request failed with status code 401","Request failed with status code 403"];return e&&e.errors?t=e.errors.find((function(e){return r.includes(e.message)})):e&&e.message&&(t=e),t?t.message:null}function $(e){var t=Object.values(j.K);return e&&e.message&&t.find((function(t){return e.message.includes(t)}))||null}function Z(e,t){return void 0===t&&(t={}),(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(e!==S.Tv.AWS_LAMBDA)return[3,6];if(r=t.authProviders,!(n=(void 0===r?{functionAuthProvider:null}:r).functionAuthProvider)||"function"!=typeof n)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n()];case 2:return[2,i.sent().token];case 3:throw o=i.sent(),new Error("Error retrieving token from `functionAuthProvider`: "+o);case 4:return[3,6];case 5:throw new Error("You must provide a `functionAuthProvider` function to `DataStore.configure` when using "+S.Tv.AWS_LAMBDA);case 6:return[2]}}))}))}function X(e,t){return(0,D.ng)(e).map((function(e){return t[e]})).join(D.Y6)}!function(e){e[e.UnknownField=0]="UnknownField",e[e.MaxAttributes=1]="MaxAttributes",e[e.MaxCombinations=2]="MaxCombinations",e[e.RepeatedFieldname=3]="RepeatedFieldname",e[e.NotGroup=4]="NotGroup",e[e.FieldNotInType=5]="FieldNotInType"}(L||(L={}));var ee=r(21436),te=function(){function e(e,t){if(!(0,E.Qs)(e.schema,t))throw new Error(e.schema.name+"."+t+" is not a relationship.");this.localModel=e,this._field=t}return e.from=function(e,t){return(0,E.Qs)(e.schema,t)?new this(e,t):null},e.allFrom=function(t){var r,n,o=[];try{for(var a=(0,i.__values)(Object.keys(t.schema.fields)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e.from(t,u);c&&o.push(c)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},Object.defineProperty(e.prototype,"localDefinition",{get:function(){return this.localModel.schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"field",{get:function(){return this._field},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localConstructor",{get:function(){return this.localModel.builder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.localAssocation.connectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localAssocation",{get:function(){return this.localDefinition.fields[this.field].association},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localJoinFields",{get:function(){return this.localAssocation.targetName?[this.localAssocation.targetName]:this.localAssocation.targetNames?this.localAssocation.targetNames:this.localPKFields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localPKFields",{get:function(){return this.localModel.pkField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteDefinition",{get:function(){var e;return null===(e=this.remoteModelType.modelConstructor)||void 0===e?void 0:e.schema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteModelType",{get:function(){return this.localDefinition.fields[this.field].type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteModelConstructor",{get:function(){return this.remoteModelType.modelConstructor.builder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remotePKFields",{get:function(){var e;return(null===(e=this.remoteModelType.modelConstructor)||void 0===e?void 0:e.pkField)||["id"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localAssociatedWith",{get:function(){return"HAS_MANY"===this.localAssocation.connectionType||"HAS_ONE"===this.localAssocation.connectionType?Array.isArray(this.localAssocation.associatedWith)?this.localAssocation.associatedWith:[this.localAssocation.associatedWith]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"explicitRemoteAssociation",{get:function(){var e;if(this.localAssociatedWith)return 1===this.localAssociatedWith.length?null===(e=this.remoteDefinition.fields[this.localAssociatedWith[0]])||void 0===e?void 0:e.association:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remoteJoinFields",{get:function(){var e,t,r;return(null===(e=this.explicitRemoteAssociation)||void 0===e?void 0:e.targetName)?[this.explicitRemoteAssociation.targetName]:(null===(t=this.explicitRemoteAssociation)||void 0===t?void 0:t.targetNames)?null===(r=this.explicitRemoteAssociation)||void 0===r?void 0:r.targetNames:this.localAssociatedWith?this.localAssociatedWith:this.remotePKFields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isComplete",{get:function(){return this.localJoinFields.length>0&&this.remoteJoinFields.length>0},enumerable:!0,configurable:!0}),e.prototype.createLocalFKObject=function(e){for(var t={},r=0;r<this.localJoinFields.length;r++)t[this.localJoinFields[r]]=e[this.remoteJoinFields[r]];return t},e.prototype.createRemoteQueryObject=function(e){for(var t={},r=0;r<this.remoteJoinFields.length;r++){var n=e[this.localJoinFields[r]];if(null==n)return null;t[this.remoteJoinFields[r]]=e[this.localJoinFields[r]]}return t},e}(),re=new c.C("DataStore"),ne="amplify-datastore",oe=function(){function e(){this.dbName=ne}return e.prototype.setUp=function(e,t,r,n,o){return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s,u=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.preSetUpChecks()];case 1:return i.sent(),this.initPromise?[3,2]:(this.initPromise=new Promise((function(e,t){u.resolve=e,u.reject=t})),[3,4]);case 2:return[4,this.initPromise];case 3:return i.sent(),[2];case 4:o&&(this.dbName=ne+"-"+o),this.schema=e,this.namespaceResolver=t,this.modelInstanceCreator=r,this.getModelConstructorByModelName=n,i.label=5;case 5:return i.trys.push([5,8,,9]),this.db?[3,7]:(a=this,[4,this.initDb()]);case 6:a.db=i.sent(),this.resolve(),i.label=7;case 7:return[3,9];case 8:return s=i.sent(),this.reject(s),[3,9];case 9:return[2]}}))}))},e.prototype.getStorenameForModel=function(e){var t=this.namespaceResolver(e),r=e.name;return(0,D.ZP)(t,r)},e.prototype.getIndexKeyValuesFromModel=function(e){var t=Object.getPrototypeOf(e).constructor,r=this.namespaceResolver(t),n=(0,D.bf)(this.schema.namespaces[r],t.name);return(0,D.jH)(e,n)},e.prototype.saveMetadata=function(e){var t=this,r=Object.getPrototypeOf(e).constructor,n=this.getStorenameForModel(r),o=this.namespaceResolver(r),i=(0,D.q8)(r.name,e,this.schema.namespaces[o],this.modelInstanceCreator,this.getModelConstructorByModelName),a=new Set,s=Object.values(i).map((function(e){var r=e.modelName,n=e.item,i=e.instance,s=(0,D.ZP)(o,r);return a.add(s),{storeName:s,item:n,instance:i,keys:(0,D.bf)(t.schema.namespaces[o],r)}})),u=this.getIndexKeyValuesFromModel(e);return{storeName:n,set:a,connectionStoreNames:s,modelKeyValues:u}},e.prototype.validateSaveCondition=function(e,t){if(e&&t){var r=T.nh.getPredicates(e),n=r.predicates,o=r.type;if(!(0,D.MJ)(t,o,n)){var i="Conditional update failed";throw re.error(i,{model:t,condition:n}),new Error(i)}}},e.prototype.load=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u=this;return(0,i.__generator)(this,(function(i){return n=this.schema.namespaces[e],o=n.relationships[t].relationTypes,a=o.map((function(t){var r=t.modelName;return(0,D.ZP)(e,r)})),s=this.getModelConstructorByModelName(e,t),a.length,[2,r.map((function(e){return u.modelInstanceCreator(s,e)}))]}))}))},e.prototype.keyValueFromPredicate=function(e,t){var r,n,o=e.predicates;if(o.length===t.length){var a=[],s=function(e){var t=o.find((function(t){return(0,E.f6)(t)&&t.field===e&&"eq"===t.operator&&null!==t.operand&&void 0!==t.operand}));t&&a.push(t.operand)};try{for(var u=(0,i.__values)(t),c=u.next();!c.done;c=u.next()){s(c.value)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return a.length===t.length?a:void 0}},e.prototype.queryMetadata=function(e,t,r){var n=this.getStorenameForModel(e),o=this.namespaceResolver(e),i=t&&T.nh.getPredicates(t),a=(0,D.bf)(this.schema.namespaces[o],e.name);return{storeName:n,namespaceName:o,queryByKey:i&&this.keyValueFromPredicate(i,a),predicates:i,hasSort:r&&r.sort,hasPagination:r&&r.limit}},e.prototype.delete=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d,f,h,p,v,y,g;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.preOpCheck()];case 1:return i.sent(),r=[],(0,D.Y_)(e)?(s=e,n=this.namespaceResolver(s),[4,this.query(s,t)]):[3,9];case 2:return o=i.sent(),void 0===t?[3,5]:[4,this.deleteTraverse(o,s,n,r)];case 3:return i.sent(),[4,this.deleteItem(r)];case 4:return i.sent(),g=r.reduce((function(e,t){var r=t.items;return e.concat(r)}),[]),[2,[o,g]];case 5:return[4,this.deleteTraverse(o,s,n,r)];case 6:return i.sent(),[4,this.deleteItem(r)];case 7:return i.sent(),g=r.reduce((function(e,t){var r=t.items;return e.concat(r)}),[]),[2,[o,g]];case 8:return[3,16];case 9:return a=e,s=Object.getPrototypeOf(a).constructor,u=this.namespaceResolver(s),c=this.getStorenameForModel(s),t?(l=this.getIndexKeyValuesFromModel(a),[4,this._get(c,l)]):[3,12];case 10:if(void 0===(d=i.sent()))return y="Model instance not found in storage",re.warn(y,{model:a}),[2,[[a],[]]];if(f=T.nh.getPredicates(t),p=(h=f).predicates,v=h.type,!(0,D.MJ)(d,v,p))throw y="Conditional update failed",re.error(y,{model:d,condition:p}),new Error(y);return[4,this.deleteTraverse([a],s,u,r)];case 11:return i.sent(),[3,14];case 12:return[4,this.deleteTraverse([a],s,u,r)];case 13:i.sent(),i.label=14;case 14:return[4,this.deleteItem(r)];case 15:return i.sent(),g=r.reduce((function(e,t){var r=t.items;return e.concat(r)}),[]),[2,[[a],g]];case 16:return[2]}}))}))},e.prototype.deleteTraverse=function(e,t,r,n){var o,a,s,u,c,l;return(0,i.__awaiter)(this,void 0,void 0,(function(){var d,f,h,p,v,y,g,m,_,b,w,S;return(0,i.__generator)(this,(function(E){switch(E.label){case 0:d=["HAS_ONE","HAS_MANY"],E.label=1;case 1:E.trys.push([1,19,20,25]),o=(0,i.__asyncValues)(e),E.label=2;case 2:return[4,o.next()];case 3:if((a=E.sent()).done)return[3,18];f=a.value,h=this.schema.namespaces[r].models[t.name],p={builder:t,schema:h,pkField:(0,D.ng)(h)},v=te.allFrom(p).filter((function(e){return d.includes(e.type)})),E.label=4;case 4:E.trys.push([4,11,12,17]),y=(0,i.__asyncValues)(v),E.label=5;case 5:return[4,y.next()];case 6:return(g=E.sent()).done?[3,10]:(m=g.value,null===(_=m.createRemoteQueryObject(f))?[3,9]:[4,this.query(m.remoteModelConstructor,T.nh.createFromFlatEqualities(m.remoteDefinition,_))]);case 7:return b=E.sent(),[4,this.deleteTraverse(b,m.remoteModelConstructor,r,n)];case 8:E.sent(),E.label=9;case 9:return[3,5];case 10:return[3,17];case 11:return w=E.sent(),c={error:w},[3,17];case 12:return E.trys.push([12,,15,16]),g&&!g.done&&(l=y.return)?[4,l.call(y)]:[3,14];case 13:E.sent(),E.label=14;case 14:return[3,16];case 15:if(c)throw c.error;return[7];case 16:return[7];case 17:return[3,2];case 18:return[3,25];case 19:return S=E.sent(),s={error:S},[3,25];case 20:return E.trys.push([20,,23,24]),a&&!a.done&&(u=o.return)?[4,u.call(o)]:[3,22];case 21:E.sent(),E.label=22;case 22:return[3,24];case 23:if(s)throw s.error;return[7];case 24:return[7];case 25:return n.push({storeName:(0,D.ZP)(r,t.name),items:e}),[2]}}))}))},e}(),ie=new c.C("DataStore"),ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.safariCompatabilityMode=!1,t.canonicalKeyPath=function(e){return t.safariCompatabilityMode?e.length>1?e:e[0]:e},t}return(0,i.__extends)(t,e),t.prototype.preSetUpChecks=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.checkPrivate()];case 1:return e.sent(),[4,this.setSafariCompatabilityMode()];case 2:return e.sent(),[2]}}))}))},t.prototype.preOpCheck=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.checkPrivate()];case 1:return e.sent(),[2]}}))}))},t.prototype.initDb=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,ee.P2(this.dbName,3,{upgrade:function(t,r,n,o){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b=this;return(0,i.__generator)(this,(function(w){switch(w.label){case 0:if(0===r)return Object.keys(this.schema.namespaces).forEach((function(e){var r=b.schema.namespaces[e];Object.keys(r.models).forEach((function(r){var n=(0,D.ZP)(e,r);b.createObjectStoreForModel(t,e,n,r)}))})),[2];if(1!==r&&2!==r||3!==n)return[3,16];w.label=1;case 1:w.trys.push([1,14,,15]),w.label=2;case 2:w.trys.push([2,11,12,13]),e=(0,i.__values)(o.objectStoreNames),a=e.next(),w.label=3;case 3:return a.done?[3,10]:(s=a.value,u=o.objectStore(s),c="tmp_"+s,u.name=c,l=this.getNamespaceAndModelFromStorename(s),d=l.namespaceName,f=l.modelName,f in this.schema.namespaces[d].models?(h=this.createObjectStoreForModel(t,d,s,f),[4,u.openCursor()]):(t.deleteObjectStore(c),[3,9]));case 4:p=w.sent(),v=0,w.label=5;case 5:return p&&p.value?[4,h.put(p.value)]:[3,8];case 6:return w.sent(),[4,p.continue()];case 7:return p=w.sent(),v++,[3,5];case 8:t.deleteObjectStore(c),ie.debug(v+" "+s+" records migrated"),w.label=9;case 9:return a=e.next(),[3,3];case 10:return[3,13];case 11:return y=w.sent(),m={error:y},[3,13];case 12:try{a&&!a.done&&(_=e.return)&&_.call(e)}finally{if(m)throw m.error}return[7];case 13:return Object.keys(this.schema.namespaces).forEach((function(e){var r=b.schema.namespaces[e],n=new Set(o.objectStoreNames);Object.keys(r.models).map((function(t){return[t,(0,D.ZP)(e,t)]})).filter((function(e){var t=(0,i.__read)(e,2)[1];return!n.has(t)})).forEach((function(r){var n=(0,i.__read)(r,2),o=n[0],a=n[1];b.createObjectStoreForModel(t,e,a,o)}))})),[3,15];case 14:throw g=w.sent(),ie.error("Error migrating IndexedDB data",g),o.abort(),g;case 15:case 16:return[2]}}))}))}})];case 1:return[2,t.sent()]}}))}))},t.prototype._get=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return"string"==typeof e?(n=e,r=this.db.transaction(n,"readonly").store.index("byPk")):r=e.index("byPk"),[4,r.get(this.canonicalKeyPath(t))];case 1:return[2,o.sent()]}}))}))},t.prototype.clear=function(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.checkPrivate()];case 1:return t.sent(),null===(e=this.db)||void 0===e||e.close(),[4,ee.MR(this.dbName)];case 2:return t.sent(),this.db=void 0,this.initPromise=void 0,[2]}}))}))},t.prototype.save=function(e,t){var r,n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w,S,x,I,P,A;return(0,i.__generator)(this,(function(T){switch(T.label){case 0:return[4,this.checkPrivate()];case 1:return T.sent(),o=this.saveMetadata(e),a=o.storeName,s=o.set,u=o.connectionStoreNames,c=o.modelKeyValues,l=this.db.transaction((0,i.__spread)([a],Array.from(s.values())),"readwrite"),d=l.objectStore(a),[4,this._get(d,c)];case 2:f=T.sent(),this.validateSaveCondition(t,f),h=[],T.label=3;case 3:T.trys.push([3,11,12,17]),p=(0,i.__asyncValues)(u),T.label=4;case 4:return[4,p.next()];case 5:return(v=T.sent()).done?[3,10]:(y=v.value,g=y.storeName,m=y.item,_=y.instance,b=y.keys,w=l.objectStore(g),S=b.map((function(e){return m[e]})),[4,this._get(w,S)]);case 6:return x=T.sent(),I=x?E.i5.UPDATE:E.i5.INSERT,(0,D.t7)(S,c)||I===E.i5.INSERT?[4,w.index("byPk").getKey(this.canonicalKeyPath(S))]:[3,9];case 7:return P=T.sent(),[4,w.put(m,P)];case 8:T.sent(),h.push([_,I]),T.label=9;case 9:return[3,4];case 10:return[3,17];case 11:return A=T.sent(),r={error:A},[3,17];case 12:return T.trys.push([12,,15,16]),v&&!v.done&&(n=p.return)?[4,n.call(p)]:[3,14];case 13:T.sent(),T.label=14;case 14:return[3,16];case 15:if(r)throw r.error;return[7];case 16:return[7];case 17:return[4,l.done];case 18:return T.sent(),[2,h]}}))}))},t.prototype.query=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,d,f=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:return[4,this.checkPrivate()];case 1:return h.sent(),n=this.queryMetadata(e,t,r),o=n.storeName,a=n.namespaceName,s=n.queryByKey,u=n.predicates,c=n.hasSort,l=n.hasPagination,[4,(0,i.__awaiter)(f,void 0,void 0,(function(){var e,t,n;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return s?[4,this.getByKey(o,s)]:[3,2];case 1:return[2,(e=i.sent())?[e]:[]];case 2:return u?[4,this.filterOnPredicate(o,u)]:[3,4];case 3:return t=i.sent(),[2,this.inMemoryPagination(t,r)];case 4:return c?[4,this.getAll(o)]:[3,6];case 5:return n=i.sent(),[2,this.inMemoryPagination(n,r)];case 6:return l?[2,this.enginePagination(o,r)]:[2,this.getAll(o)]}}))}))];case 2:return d=h.sent(),[4,this.load(a,e.name,d)];case 3:return[2,h.sent()]}}))}))},t.prototype.queryOne=function(e,t){return void 0===t&&(t=E.Vo.FIRST),(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.checkPrivate()];case 1:return i.sent(),r=this.getStorenameForModel(e),[4,this.db.transaction([r],"readonly").objectStore(r).openCursor(void 0,t===E.Vo.FIRST?"next":"prev")];case 2:return n=i.sent(),[2,(o=n?n.value:void 0)&&this.modelInstanceCreator(e,o)]}}))}))},t.prototype.batchSave=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d,f,h,p,v,y,g=this;return(0,i.__generator)(this,(function(m){switch(m.label){case 0:return[4,this.checkPrivate()];case 1:if(m.sent(),0===t.length)return[2,[]];r=e.name,n=this.namespaceResolver(e),o=this.getStorenameForModel(e),a=[],s=this.db.transaction(o,"readwrite"),u=s.store,c=function(t){var o,s,c,d,f,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return o=l.modelInstanceCreator(e,t),s=(0,D.q8)(r,o,l.schema.namespaces[n],l.modelInstanceCreator,l.getModelConstructorByModelName),c=l.getIndexKeyValuesFromModel(o),d=t._deleted,[4,u.index("byPk").getKey(l.canonicalKeyPath(c))];case 1:return f=i.sent(),d?[3,3]:(h=s.find((function(e){var t=e.instance,r=g.getIndexKeyValuesFromModel(t);return(0,D.t7)(r,c)})).instance,a.push([h,f?E.i5.UPDATE:E.i5.INSERT]),[4,u.put(h,f)]);case 2:return i.sent(),[3,5];case 3:return a.push([t,E.i5.DELETE]),f?[4,u.delete(f)]:[3,5];case 4:i.sent(),i.label=5;case 5:return[2]}}))},l=this,m.label=2;case 2:m.trys.push([2,7,8,9]),d=(0,i.__values)(t),f=d.next(),m.label=3;case 3:return f.done?[3,6]:(h=f.value,[5,c(h)]);case 4:m.sent(),m.label=5;case 5:return f=d.next(),[3,3];case 6:return[3,9];case 7:return p=m.sent(),v={error:p},[3,9];case 8:try{f&&!f.done&&(y=d.return)&&y.call(d)}finally{if(v)throw v.error}return[7];case 9:return[4,s.done];case 10:return m.sent(),[2,a]}}))}))},t.prototype.deleteItem=function(e){var t,r,n,o;return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w;return(0,i.__generator)(this,(function(S){switch(S.label){case 0:a=e.map((function(e){return e.storeName})),s=this.db.transaction((0,i.__spread)(a),"readwrite"),S.label=1;case 1:S.trys.push([1,22,23,28]),u=(0,i.__asyncValues)(e),S.label=2;case 2:return[4,u.next()];case 3:if((c=S.sent()).done)return[3,21];l=c.value,d=l.storeName,f=l.items,h=s.objectStore(d),S.label=4;case 4:S.trys.push([4,14,15,20]),p=(0,i.__asyncValues)(f),S.label=5;case 5:return[4,p.next()];case 6:return(v=S.sent()).done?[3,13]:(y=v.value)?(g=void 0,"object"!=typeof y?[3,8]:(m=this.getIndexKeyValuesFromModel(y),[4,h.index("byPk").getKey(this.canonicalKeyPath(m))])):[3,12];case 7:return g=S.sent(),[3,10];case 8:return _=y.toString(),[4,h.index("byPk").getKey(_)];case 9:g=S.sent(),S.label=10;case 10:return void 0===g?[3,12]:[4,h.delete(g)];case 11:S.sent(),S.label=12;case 12:return[3,5];case 13:return[3,20];case 14:return b=S.sent(),n={error:b},[3,20];case 15:return S.trys.push([15,,18,19]),v&&!v.done&&(o=p.return)?[4,o.call(p)]:[3,17];case 16:S.sent(),S.label=17;case 17:return[3,19];case 18:if(n)throw n.error;return[7];case 19:return[7];case 20:return[3,2];case 21:return[3,28];case 22:return w=S.sent(),t={error:w},[3,28];case 23:return S.trys.push([23,,26,27]),c&&!c.done&&(r=u.return)?[4,r.call(u)]:[3,25];case 24:S.sent(),S.label=25;case 25:return[3,27];case 26:if(t)throw t.error;return[7];case 27:return[7];case 28:return[2]}}))}))},t.prototype.checkPrivate=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,D.NX)().then((function(e){return e}))];case 1:return e.sent()?(ie.error("IndexedDB not supported in this browser's private mode"),[2,Promise.reject("IndexedDB not supported in this browser's private mode")]):[2,Promise.resolve()]}}))}))},t.prototype.setSafariCompatabilityMode=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return e=this,[4,(0,D.yq)()];case 1:return e.safariCompatabilityMode=t.sent(),!0===this.safariCompatabilityMode&&ie.debug("IndexedDB Adapter is running in Safari Compatability Mode"),[2]}}))}))},t.prototype.getNamespaceAndModelFromStorename=function(e){var t=(0,i.__read)(e.split("_"));return{namespaceName:t[0],modelName:t.slice(1).join("_")}},t.prototype.createObjectStoreForModel=function(e,t,r,n){var o=e.createObjectStore(r,{autoIncrement:!0});return this.schema.namespaces[t].relationships[n].indexes.forEach((function(e){var t=(0,i.__read)(e,3),r=t[0],n=t[1],a=t[2];o.createIndex(r,n,a)})),o},t.prototype.getByKey=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this._get(e,t)];case 1:return[2,r.sent()]}}))}))},t.prototype.getAll=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.db.getAll(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.matchingIndexQueries=function(e,t,r){var n,o,a,s,u=this,c=[],l=new Map;try{for(var d=(0,i.__values)(t),f=d.next();!f.done;f=d.next()){var h=f.value;l.set(String(h.field),h)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}var p=r.objectStore(e),v=function(t){var r,n,o=p.index(t),a=Array.isArray(o.keyPath)?o.keyPath:[o.keyPath],s=[];try{for(var d=(r=void 0,(0,i.__values)(a)),f=d.next();!f.done;f=d.next()){var h=f.value,v=l.get(h);if(!v||null===v.operand||void 0===v.operand)break;s.push(v.operand)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}s.length===a.length&&c.push((function(){return u.db.transaction(e).objectStore(e).index(t).getAll(u.canonicalKeyPath(s))}))};try{for(var y=(0,i.__values)(p.indexNames),g=y.next();!g.done;g=y.next()){v(g.value)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}return c},t.prototype.baseQueryIndex=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,d,f=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:for(n=t.predicates,o=t.type;1===n.length&&(0,E.JW)(n[0])&&"not"!==n[0].type;)o=n[0].type,n=n[0].predicates;return a=n.filter((function(e){return(0,E.f6)(e)&&"eq"===e.operator})),s=r||this.db.transaction(e),u={},"or"!==o?[3,2]:[4,Promise.all(n.filter((function(e){return(0,E.JW)(e)&&"and"===e.type})).map((function(t){return f.baseQueryIndex(e,t,s)}))).then((function(e){return e.filter((function(e){return 1===e.indexedQueries.length})).map((function(e){return e.indexedQueries}))}))];case 1:return c=h.sent(),l=n.filter((function(e){return(0,E.f6)(e)})).map((function(t){return f.matchingIndexQueries(e,[t],s)})),d=(0,i.__spread)(c,l).map((function(e){return e[0]})).filter((function(e){return e})),u=n.length>d.length?{groupType:null,indexedQueries:[]}:{groupType:"or",indexedQueries:d},[3,3];case 2:u="and"===o?{groupType:o,indexedQueries:this.matchingIndexQueries(e,a,s)}:{groupType:null,indexedQueries:[]},h.label=3;case 3:return r?[3,5]:[4,s.done];case 4:h.sent(),h.label=5;case 5:return[2,u]}}))}))},t.prototype.filterOnPredicate=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w;return(0,i.__generator)(this,(function(S){switch(S.label){case 0:return r=t.predicates,n=t.type,[4,this.baseQueryIndex(e,t)];case 1:return o=S.sent(),a=o.groupType,s=o.indexedQueries,"and"===a&&s.length>0?[4,s[0]()]:[3,3];case 2:return u=S.sent(),[3,14];case 3:if(!("or"===a&&s.length>0&&s.length<=7))return[3,12];c=new Map,S.label=4;case 4:S.trys.push([4,9,10,11]),l=(0,i.__values)(s),d=l.next(),S.label=5;case 5:return d.done?[3,8]:[4,(0,d.value)()];case 6:f=S.sent();try{for(b=void 0,h=(0,i.__values)(f),p=h.next();!p.done;p=h.next())v=p.value,y=JSON.stringify(v),c.set(y,v)}catch(e){b={error:e}}finally{try{p&&!p.done&&(w=h.return)&&w.call(h)}finally{if(b)throw b.error}}S.label=7;case 7:return d=l.next(),[3,5];case 8:return[3,11];case 9:return g=S.sent(),m={error:g},[3,11];case 10:try{d&&!d.done&&(_=l.return)&&_.call(l)}finally{if(m)throw m.error}return[7];case 11:return u=Array.from(c.values()),[3,14];case 12:return[4,this.getAll(e)];case 13:u=S.sent(),S.label=14;case 14:return[2,r?u.filter((function(e){return(0,D.MJ)(e,n,r)})):u]}}))}))},t.prototype.inMemoryPagination=function(e,t){return(0,D.Jk)(e,t)},t.prototype.enginePagination=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t?(n=t.page,o=void 0===n?0:n,a=t.limit,s=void 0===a?0:a,u=Math.max(0,o*s)||0,[4,this.db.transaction(e).objectStore(e).openCursor()]):[3,7];case 1:return(c=i.sent())&&u>0?[4,c.advance(u)]:[3,3];case 2:i.sent(),i.label=3;case 3:l=[],d="number"==typeof s&&s>0,i.label=4;case 4:return c&&c.value?(l.push(c.value),d&&l.length===s?[3,6]:[4,c.continue()]):[3,6];case 5:return c=i.sent(),[3,4];case 6:return r=l,[3,9];case 7:return[4,this.db.getAll(e)];case 8:r=i.sent(),i.label=9;case 9:return[2,r]}}))}))},t}(oe);const se=new ae;var ue=function(){var e=this;this.db=new Map,this.getAllKeys=function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,Array.from(this.db.keys())]}))}))},this.multiGet=function(t){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(r){return[2,t.reduce((function(t,r){return t.push([r,e.db.get(r)]),t}),[])]}))}))},this.multiRemove=function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(n){return t.forEach((function(t){return e.db.delete(t)})),"function"==typeof r&&r(),[2]}))}))},this.multiSet=function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(n){return t.forEach((function(t){var r=(0,i.__read)(t,2),n=r[0],o=r[1];e.setItem(n,o)})),"function"==typeof r&&r(),[2]}))}))},this.setItem=function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.db.set(t,r)]}))}))},this.removeItem=function(t){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.db.delete(t)]}))}))},this.getItem=function(t){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.db.get(t)]}))}))}};var ce="@AmplifyDatastore",le="Data",de=new Map,fe=function(){function e(){this._collectionInMemoryIndex=new Map,this.storage=new ue}return e.prototype.getCollectionIndex=function(e){return this._collectionInMemoryIndex.has(e)||this._collectionInMemoryIndex.set(e,new Map),this._collectionInMemoryIndex.get(e)},e.prototype.getMonotonicFactory=function(e){return de.has(e)||de.set(e,(0,D.fC)()),de.get(e)},e.prototype.init=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b;return(0,i.__generator)(this,(function(w){switch(w.label){case 0:return this._collectionInMemoryIndex.clear(),[4,this.storage.getAllKeys()];case 1:e=w.sent(),t=[],w.label=2;case 2:w.trys.push([2,12,13,14]),r=(0,i.__values)(e),n=r.next(),w.label=3;case 3:return n.done?[3,11]:(o=n.value,a=(0,i.__read)(o.split("::"),5),s=a[0],u=a[1],c=a[2],l=a[3],d=a[4],s!==ce?[3,10]:c!==le?[3,9]:(f=void 0,void 0!==d?[3,7]:(h=l,p=this.getMonotonicFactory(u)(),v=this.getLegacyKeyForItem(u,h),y=this.getKeyForItem(u,h,p),[4,this.storage.getItem(v)])));case 4:return g=w.sent(),[4,this.storage.setItem(y,g)];case 5:return w.sent(),[4,this.storage.removeItem(v)];case 6:return w.sent(),f=p,[3,8];case 7:f=l,w.label=8;case 8:return this.getCollectionIndex(u).set(d,f),[3,10];case 9:"Collection"===c&&t.push(o),w.label=10;case 10:return n=r.next(),[3,3];case 11:return[3,14];case 12:return m=w.sent(),_={error:m},[3,14];case 13:try{n&&!n.done&&(b=r.return)&&b.call(r)}finally{if(_)throw _.error}return[7];case 14:return t.length>0?[4,this.storage.multiRemove(t)]:[3,16];case 15:w.sent(),w.label=16;case 16:return[2]}}))}))},e.prototype.save=function(e,t,r,n){var o,a;return(0,i.__awaiter)(this,void 0,void 0,(function(){var s,u,c;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return s=(0,D.KK)(r),u=(null===(o=this.getCollectionIndex(t))||void 0===o?void 0:o.get(s))||this.getMonotonicFactory(t)(),c=this.getKeyForItem(t,n,u),null===(a=this.getCollectionIndex(t))||void 0===a||a.set(n,u),[4,this.storage.setItem(c,JSON.stringify(e))];case 1:return i.sent(),[2]}}))}))},e.prototype.batchSave=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w,S,x,I=this;return(0,i.__generator)(this,(function(P){switch(P.label){case 0:if(0===t.length)return[2,[]];n=[],o=this.getCollectionIndex(e),a=new Set,s=new Set,u=[],c={},l=function(t){var n=r.map((function(e){return t[e]})),i=t._deleted,l=o.get(n.join(D.Bi))||d.getMonotonicFactory(e)(),f=d.getKeyForItem(e,n.join(D.Bi),l);u.push(f),c[f]={ulid:l,model:t},i?a.add(f):s.add(f)},d=this;try{for(f=(0,i.__values)(t),h=f.next();!h.done;h=f.next())p=h.value,l(p)}catch(e){b={error:e}}finally{try{h&&!h.done&&(w=f.return)&&w.call(f)}finally{if(b)throw b.error}}return[4,this.storage.multiGet(u)];case 1:return v=P.sent(),y=v.filter((function(e){return!!(0,i.__read)(e,2)[1]})).reduce((function(e,t){var r=(0,i.__read)(t,1)[0];return e.add(r)}),new Set),[4,new Promise((function(e,t){if(0!==a.size){var n=Array.from(a);n.forEach((function(e){var t=r.map((function(t){return c[e].model[t]})).join(D.Bi);o.delete(t)})),I.storage.multiRemove(n,(function(r){r&&r.length>0?t(r):e()}))}else e()}))];case 2:return P.sent(),[4,new Promise((function(e,t){if(0!==s.size){var n=Array.from(s).map((function(e){return[e,JSON.stringify(c[e].model)]}));s.forEach((function(e){var t=c[e],n=t.model,i=t.ulid,a=r.map((function(e){return n[e]})).join(D.Bi);o.set(a,i)})),I.storage.multiSet(n,(function(r){r&&r.length>0?t(r):e()}))}else e()}))];case 3:P.sent();try{for(g=(0,i.__values)(u),m=g.next();!m.done;m=g.next())_=m.value,a.has(_)&&y.has(_)?n.push([c[_].model,E.i5.DELETE]):s.has(_)&&n.push([c[_].model,y.has(_)?E.i5.UPDATE:E.i5.INSERT])}catch(e){S={error:e}}finally{try{m&&!m.done&&(x=g.return)&&x.call(g)}finally{if(S)throw S.error}}return[2,n]}}))}))},e.prototype.get=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=this.getCollectionIndex(t).get(e),n=this.getKeyForItem(t,e,r),[4,this.storage.getItem(n)];case 1:return o=i.sent(),[2,o&&JSON.parse(o)]}}))}))},e.prototype.getOne=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c;return(0,i.__generator)(this,(function(l){switch(l.label){case 0:return r=this.getCollectionIndex(t),n=(0,i.__read)(e===E.Vo.FIRST?function(){var e,t,n,o,a;try{for(var s=(0,i.__values)(r),u=s.next();!u.done;u=s.next()){o=(n=(0,i.__read)(u.value,2))[0],a=n[1];break}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return[o,a]}():function(){var e,t,n,o,a;try{for(var s=(0,i.__values)(r),u=s.next();!u.done;u=s.next())o=(n=(0,i.__read)(u.value,2))[0],a=n[1]}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return[o,a]}(),2),o=n[0],a=n[1],s=this.getKeyForItem(t,o,a),(c=s)?[4,this.storage.getItem(s)]:[3,2];case 1:c=l.sent(),l.label=2;case 2:return[2,(u=c)&&JSON.parse(u)||void 0]}}))}))},e.prototype.getAll=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w;return(0,i.__generator)(this,(function(S){switch(S.label){case 0:r=this.getCollectionIndex(e),o=(n=t||{}).page,a=void 0===o?0:o,s=n.limit,u=void 0===s?0:s,c=Math.max(0,a*u)||0,l=u>0?c+u:void 0,d=[],f=0;try{for(h=(0,i.__values)(r),p=h.next();!p.done&&(v=(0,i.__read)(p.value,2),y=v[0],g=v[1],++f<=c||(d.push(this.getKeyForItem(e,y,g)),f!==l));p=h.next());}catch(e){b={error:e}}finally{try{p&&!p.done&&(w=h.return)&&w.call(h)}finally{if(b)throw b.error}}return[4,this.storage.multiGet(d)];case 1:return m=S.sent(),_=m.filter((function(e){return(0,i.__read)(e,2)[1]})).map((function(e){var t=(0,i.__read)(e,2)[1];return JSON.parse(t)})),[2,_]}}))}))},e.prototype.delete=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return r=this.getCollectionIndex(t).get(e),n=this.getKeyForItem(t,e,r),this.getCollectionIndex(t).delete(e),[4,this.storage.removeItem(n)];case 1:return o.sent(),[2]}}))}))},e.prototype.clear=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.storage.getAllKeys()];case 1:return e=r.sent(),t=e.filter((function(e){return e.startsWith(ce)})),[4,this.storage.multiRemove(t)];case 2:return r.sent(),this._collectionInMemoryIndex.clear(),[2]}}))}))},e.prototype.getKeyForItem=function(e,t,r){return this.getKeyPrefixForStoreItems(e)+"::"+r+"::"+t},e.prototype.getLegacyKeyForItem=function(e,t){return this.getKeyPrefixForStoreItems(e)+"::"+t},e.prototype.getKeyPrefixForStoreItems=function(e){return ce+"::"+e+"::"+le},e}();const he=fe;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.preSetUpChecks=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2]}))}))},t.prototype.preOpCheck=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2]}))}))},t.prototype.initDb=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(e=new he).init()];case 1:return t.sent(),[2,e]}}))}))},t.prototype.clear=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.db.clear()];case 1:return e.sent(),this.db=void 0,this.initPromise=void 0,[2]}}))}))},t.prototype.batchSave=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d,f,h,p,v=this;return(0,i.__generator)(this,(function(y){switch(y.label){case 0:if(0===t.length)return[2,[]];r=e.name,n=this.namespaceResolver(e),o=(0,D.ZP)(n,r),a=(0,D.bf)(this.schema.namespaces[n],r),s=[],u=function(t){var o=c.modelInstanceCreator(e,t),i=(0,D.q8)(r,o,c.schema.namespaces[n],c.modelInstanceCreator,c.getModelConstructorByModelName),a=c.getIndexKeyValuesPath(o),u=i.find((function(e){var t=e.instance,r=v.getIndexKeyValuesPath(t);return(0,D.t7)([r],[a])})).instance;s.push(u)},c=this;try{for(l=(0,i.__values)(t),d=l.next();!d.done;d=l.next())f=d.value,u(f)}catch(e){h={error:e}}finally{try{d&&!d.done&&(p=l.return)&&p.call(l)}finally{if(h)throw h.error}}return[4,this.db.batchSave(o,s,a)];case 1:return[2,y.sent()]}}))}))},t.prototype._get=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return r=t.join(D.Bi),[4,this.db.get(r,e)];case 1:return[2,n.sent()]}}))}))},t.prototype.save=function(e,t){var r,n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w;return(0,i.__generator)(this,(function(S){switch(S.label){case 0:return o=this.saveMetadata(e),a=o.storeName,s=o.connectionStoreNames,u=o.modelKeyValues,[4,this._get(a,u)];case 1:c=S.sent(),this.validateSaveCondition(t,c),l=[],S.label=2;case 2:S.trys.push([2,9,10,15]),d=(0,i.__asyncValues)(s),S.label=3;case 3:return[4,d.next()];case 4:return(f=S.sent()).done?[3,8]:(h=f.value,p=h.storeName,v=h.item,y=h.instance,g=h.keys,m=g.map((function(e){return v[e]})),[4,this._get(p,m)]);case 5:return _=S.sent(),b=_?E.i5.UPDATE:E.i5.INSERT,(0,D.t7)(m,u)||b===E.i5.INSERT?[4,this.db.save(v,p,g,m.join(D.Bi))]:[3,7];case 6:S.sent(),l.push([y,b]),S.label=7;case 7:return[3,3];case 8:return[3,15];case 9:return w=S.sent(),r={error:w},[3,15];case 10:return S.trys.push([10,,13,14]),f&&!f.done&&(n=d.return)?[4,n.call(d)]:[3,12];case 11:S.sent(),S.label=12;case 12:return[3,14];case 13:if(r)throw r.error;return[7];case 14:return[7];case 15:return[2,l]}}))}))},t.prototype.query=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,d,f=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:return n=this.queryMetadata(e,t,r),o=n.storeName,a=n.namespaceName,s=n.queryByKey,u=n.predicates,c=n.hasSort,l=n.hasPagination,[4,(0,i.__awaiter)(f,void 0,void 0,(function(){var e,t,n,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return s?(e=s.join(D.Bi),[4,this.getByKey(o,e)]):[3,2];case 1:return[2,(t=i.sent())?[t]:[]];case 2:return u?[4,this.filterOnPredicate(o,u)]:[3,4];case 3:return n=i.sent(),[2,this.inMemoryPagination(n,r)];case 4:return c||l?[4,this.getAll(o)]:[3,6];case 5:return a=i.sent(),[2,this.inMemoryPagination(a,r)];case 6:return[2,this.getAll(o)]}}))}))];case 1:return d=h.sent(),[4,this.load(a,e.name,d)];case 2:return[2,h.sent()]}}))}))},t.prototype.getByKey=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.db.get(t,e)];case 1:return[2,r.sent()]}}))}))},t.prototype.getAll=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.db.getAll(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.filterOnPredicate=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=t.predicates,n=t.type,[4,this.getAll(e)];case 1:return o=i.sent(),[2,r?o.filter((function(e){return(0,D.MJ)(e,n,r)})):o]}}))}))},t.prototype.inMemoryPagination=function(e,t){return(0,D.Jk)(e,t)},t.prototype.queryOne=function(e,t){return void 0===t&&(t=E.Vo.FIRST),(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return r=this.getStorenameForModel(e),[4,this.db.getOne(t,r)];case 1:return[2,(n=o.sent())&&this.modelInstanceCreator(e,n)]}}))}))},t.prototype.deleteItem=function(e){var t,r,n,o;return(0,i.__awaiter)(this,void 0,void 0,(function(){var a,s,u,c,l,d,f,h,p,v,y;return(0,i.__generator)(this,(function(g){switch(g.label){case 0:g.trys.push([0,17,18,23]),a=(0,i.__asyncValues)(e),g.label=1;case 1:return[4,a.next()];case 2:if((s=g.sent()).done)return[3,16];u=s.value,c=u.storeName,l=u.items,g.label=3;case 3:g.trys.push([3,9,10,15]),d=(0,i.__asyncValues)(l),g.label=4;case 4:return[4,d.next()];case 5:return(f=g.sent()).done?[3,8]:(h=f.value)?"object"!=typeof h?[3,7]:(p=this.getIndexKeyValuesPath(h),[4,this.db.delete(p,c)]):[3,7];case 6:g.sent(),g.label=7;case 7:return[3,4];case 8:return[3,15];case 9:return v=g.sent(),n={error:v},[3,15];case 10:return g.trys.push([10,,13,14]),f&&!f.done&&(o=d.return)?[4,o.call(d)]:[3,12];case 11:g.sent(),g.label=12;case 12:return[3,14];case 13:if(n)throw n.error;return[7];case 14:return[7];case 15:return[3,1];case 16:return[3,23];case 17:return y=g.sent(),t={error:y},[3,23];case 18:return g.trys.push([18,,21,22]),s&&!s.done&&(r=a.return)?[4,r.call(a)]:[3,20];case 19:g.sent(),g.label=20;case 20:return[3,22];case 21:if(t)throw t.error;return[7];case 22:return[7];case 23:return[2]}}))}))},t.prototype.getIndexKeyValuesPath=function(e){return this.getIndexKeyValuesFromModel(e).join(D.Bi)},t}(oe);const ve=new pe;const ye=function(){return(0,l.gy)().isBrowser&&window.indexedDB||(0,l.p7)()&&self.indexedDB?se:ve};var ge=new c.C("DataStore"),me=function(){function e(e,t,r,n,o,i){this.schema=e,this.namespaceResolver=t,this.getModelConstructorByModelName=r,this.modelInstanceCreator=n,this.adapter=o,this.sessionId=i,this.adapter=this.adapter||ye(),this.pushStream=new(R())}return e.getNamespace=function(){return{name:D.O3,relationships:{},enums:{},models:{},nonModels:{}}},e.prototype.init=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return void 0===this.initialized?[3,2]:[4,this.initialized];case 1:case 3:return r.sent(),[2];case 2:return ge.debug("Starting Storage"),this.initialized=new Promise((function(r,n){e=r,t=n})),this.adapter.setUp(this.schema,this.namespaceResolver,this.modelInstanceCreator,this.getModelConstructorByModelName,this.sessionId).then(e,t),[4,this.initialized]}}))}))},e.prototype.save=function(e,t,r,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a=this;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.init()];case 1:if(s.sent(),!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.save(e,t)];case 2:return(o=s.sent()).forEach((function(s){var u,c=(0,i.__read)(s,2),l=c[0],d=c[1],f=!!r;if((d===E.i5.UPDATE||d===E.i5.INSERT)&&!f&&null===(u=a.getChangedFieldsInput(e,l,n)))return o;var h=u||l,p=Object.getPrototypeOf(l).constructor;a.pushStream.next({model:p,opType:d,element:h,mutator:r,condition:t&&T.nh.getPredicates(t,!1)||null,savedElement:l})})),[2,o]}}))}))},e.prototype.delete=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u,c,l,d=this;return(0,i.__generator)(this,(function(f){switch(f.label){case 0:return[4,this.init()];case 1:if(f.sent(),!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.delete(e,t)];case 2:return l=i.__read.apply(void 0,[f.sent(),2]),n=l[0],o=l[1],a=(0,D.Y_)(e)?e:Object.getPrototypeOf(e||{}).constructor,s=this.namespaceResolver(a),u=this.schema.namespaces[s].models[a.name],c=new Set(n.map((function(e){return X(u,e)}))),(0,D.Y_)(e)||Array.isArray(o)||(o=[o]),o.forEach((function(n){var o,i=Object.getPrototypeOf(n).constructor;if(!(0,D.Y_)(e)){var a=X(u,n);o=c.has(a)?T.nh.getPredicates(t,!1):void 0}d.pushStream.next({model:i,opType:E.i5.DELETE,element:n,mutator:r,condition:o||null})})),[2,[n,o]]}}))}))},e.prototype.query=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.init()];case 1:if(n.sent(),!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.query(e,t,r)];case 2:return[2,n.sent()]}}))}))},e.prototype.queryOne=function(e,t){return void 0===t&&(t=E.Vo.FIRST),(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.init()];case 1:if(r.sent(),!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.queryOne(e,t)];case 2:return[2,r.sent()]}}))}))},e.prototype.observe=function(e,t,r){var n=!e,o=t&&T.nh.getPredicates(t,!1)||{},a=o.predicates,s=o.type,u=this.pushStream.observable.filter((function(e){var t=e.mutator;return!r||t!==r})).map((function(e){e.mutator;return(0,i.__rest)(e,["mutator"])}));return n||(u=u.filter((function(t){var r=t.model,n=t.element;return e===r&&(!a||!s||(0,D.MJ)(n,s,a))}))),u},e.prototype.clear=function(e){return void 0===e&&(e=!0),(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:if(this.initialized=void 0,!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.clear()];case 1:return t.sent(),e&&this.pushStream.complete(),[2]}}))}))},e.prototype.batchSave=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.init()];case 1:if(a.sent(),!this.adapter)throw new Error("Storage adapter is missing");return[4,this.adapter.batchSave(e,t)];case 2:return(n=a.sent()).forEach((function(t){var n=(0,i.__read)(t,2),a=n[0],s=n[1];o.pushStream.next({model:e,opType:s,element:a,mutator:r,condition:null})})),[2,n]}}))}))},e.prototype.getChangedFieldsInput=function(e,t,r){var n,o,a;if(!(r&&r.length))return null;var s=(0,i.__read)(r,2),u=s[0],c=s[1],l={},d=u.map((function(e){return e.path&&e.path[0]})),f=Object.getPrototypeOf(e).constructor,h=this.namespaceResolver(f),p=this.schema.namespaces[h].models[f.name].fields,v=(null===(a=this.schema.namespaces[h].keys)||void 0===a?void 0:a[f.name])||{},y=v.primaryKey,g=v.compositeKeys,m=void 0===g?[]:g;if(d.forEach((function(e){var r,n,o,a,s,u,d,f,h,v,y,g=(0,E.UQ)(null===(y=p[e])||void 0===y?void 0:y.association);if(Array.isArray(g))try{for(var _=(0,i.__values)(g),b=_.next();!b.done;b=_.next()){var w=b.value;if(!(0,D.lu)(c[w],t[w])){l[w]=void 0===t[w]?null:t[w];try{for(var S=(o=void 0,(0,i.__values)(m)),x=S.next();!x.done;x=S.next()){if((k=x.value).has(w))try{for(var I=(s=void 0,(0,i.__values)(k)),P=I.next();!P.done;P=I.next()){var A=P.value;l[A]=t[A]}}catch(e){s={error:e}}finally{try{P&&!P.done&&(u=I.return)&&u.call(I)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{x&&!x.done&&(a=S.return)&&a.call(S)}finally{if(o)throw o.error}}}}}catch(e){r={error:e}}finally{try{b&&!b.done&&(n=_.return)&&n.call(_)}finally{if(r)throw r.error}}else{var T=g||e;if(!(0,D.lu)(c[T],t[T])){l[T]=void 0===t[T]?null:t[T];try{for(var C=(0,i.__values)(m),O=C.next();!O.done;O=C.next()){var k;if((k=O.value).has(T))try{for(var N=(h=void 0,(0,i.__values)(k)),M=N.next();!M.done;M=N.next()){A=M.value;l[A]=t[A]}}catch(e){h={error:e}}finally{try{M&&!M.done&&(v=N.return)&&v.call(N)}finally{if(h)throw h.error}}}}catch(e){d={error:e}}finally{try{O&&!O.done&&(f=C.return)&&f.call(C)}finally{if(d)throw d.error}}}}})),0===Object.keys(l).length)return null;if(y&&y.length)try{for(var _=(0,i.__values)(y),b=_.next();!b.done;b=_.next()){var w=b.value;l[w]=t[w]}}catch(e){n={error:e}}finally{try{b&&!b.done&&(o=_.return)&&o.call(_)}finally{if(n)throw n.error}}var S=t.id,x=t._version,I=t._lastChangedAt,P=t._deleted;return(0,i.__assign)((0,i.__assign)({},l),{id:S,_version:x,_lastChangedAt:I,_deleted:P})},e}(),_e=function(){function e(e,t,r,n,o,i){this.mutex=new O,this.storage=new me(e,t,r,n,o,i)}return e.prototype.runExclusive=function(e){return this.mutex.runExclusive(e.bind(this,this.storage))},e.prototype.save=function(e,t,r,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(o){return[2,this.runExclusive((function(o){return o.save(e,t,r,n)}))]}))}))},e.prototype.delete=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){return[2,this.runExclusive((function(n){if((0,D.Y_)(e)){var o=e;return n.delete(o,t,r)}var i=e;return n.delete(i,t,r)}))]}))}))},e.prototype.query=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(n){return[2,this.runExclusive((function(n){return n.query(e,t,r)}))]}))}))},e.prototype.queryOne=function(e,t){return void 0===t&&(t=E.Vo.FIRST),(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){return[2,this.runExclusive((function(r){return r.queryOne(e,t)}))]}))}))},e.getNamespace=function(){return me.getNamespace()},e.prototype.observe=function(e,t,r){return this.storage.observe(e,t,r)},e.prototype.clear=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.runExclusive((function(e){return e.clear()}))];case 1:return e.sent(),[2]}}))}))},e.prototype.batchSave=function(e,t){return this.storage.batchSave(e,t)},e.prototype.init=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,this.storage.init()]}))}))},e}(),be=r(33782),we=r(14971),Se=(new(r(67453).A)).networkMonitor();new c.C("DataStore");const Ee=function(){function e(){this.connectionStatus={online:!1}}return e.prototype.status=function(){var e=this;if(this.observer)throw new Error("Subscriber already exists");return new w((function(t){return e.observer=t,e.subscription=Se.subscribe((function(r){var n=r.online;e.connectionStatus.online=n;var o=(0,i.__assign)({},e.connectionStatus);t.next(o)})),function(){clearTimeout(e.timeout),e.unsubscribe()}}))},e.prototype.unsubscribe=function(){this.subscription&&(clearTimeout(this.timeout),this.subscription.unsubscribe())},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this.unsubscribe(),[2]}))}))},e.prototype.socketDisconnected=function(){var e=this;this.observer&&"function"==typeof this.observer.next&&(this.observer.next({online:!1}),this.timeout=setTimeout((function(){var t=(0,i.__assign)({},e.connectionStatus);e.observer.next(t)}),5e3))},e}();var xe=function(){function e(e,t){this.outbox=e,this.ownSymbol=t}return e.prototype.merge=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,a,s,u;return(0,i.__generator)(this,(function(c){switch(c.label){case 0:return[4,this.outbox.getForModel(e,t,r)];case 1:return o=c.sent(),a=t._deleted,0!==o.length?[3,5]:a?(n=E.i5.DELETE,[4,e.delete(t,void 0,this.ownSymbol)]):[3,3];case 2:return c.sent(),[3,5];case 3:return[4,e.save(t,void 0,this.ownSymbol)];case 4:s=i.__read.apply(void 0,[c.sent(),1]),u=(0,i.__read)(s[0],2),n=u[1],c.label=5;case 5:return[2,n]}}))}))},e.prototype.mergePage=function(e,t,r,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,d,f;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:o=new Map;try{for(a=(0,i.__values)(r),s=a.next();!s.done;s=a.next())u=s.value,c=X(n,u),o.set(c,u)}catch(e){d={error:e}}finally{try{s&&!s.done&&(f=a.return)&&f.call(a)}finally{if(d)throw d.error}}return l=(0,i.__spread)(o.values()),[4,e.batchSave(t,l,this.ownSymbol)];case 1:return[2,h.sent()]}}))}))},e}(),Ie=function(){function e(e,t,r,n){this.schema=e,this.MutationEvent=t,this.modelInstanceCreator=r,this.ownSymbol=n}return e.prototype.enqueue=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r=this;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,e.runExclusive((function(e){return(0,i.__awaiter)(r,void 0,void 0,(function(){var r,n,o,a,s,u,c,l,d;return(0,i.__generator)(this,(function(f){switch(f.label){case 0:return r=this.schema.namespaces[D.a9].models.MutationEvent,n=T.nh.createFromAST(r,{and:[{modelId:{eq:t.modelId}},{id:{ne:this.inProgressMutationEventId}}]}),[4,e.query(this.MutationEvent,n)];case 1:return o=i.__read.apply(void 0,[f.sent(),1]),void 0!==(a=o[0])?[3,3]:[4,e.save(t,void 0,this.ownSymbol)];case 2:return f.sent(),[2];case 3:return s=t.operation,a.operation!==N.CREATE?[3,8]:s!==N.DELETE?[3,5]:[4,e.delete(this.MutationEvent,n)];case 4:return f.sent(),[3,7];case 5:return u=this.mergeUserFields(a,t),[4,e.save(this.MutationEvent.copyOf(a,(function(e){e.data=u.data})),void 0,this.ownSymbol)];case 6:f.sent(),f.label=7;case 7:return[3,12];case 8:return c=t.condition,l=JSON.parse(c),d=void 0,0!==Object.keys(l).length?[3,10]:(d=this.mergeUserFields(a,t),[4,e.delete(this.MutationEvent,n)]);case 9:f.sent(),f.label=10;case 10:return d=d||t,[4,e.save(d,void 0,this.ownSymbol)];case 11:f.sent(),f.label=12;case 12:return[2]}}))}))}))];case 1:return n.sent(),[2]}}))}))},e.prototype.dequeue=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return[4,this.peek(e)];case 1:return n=o.sent(),t?[4,this.syncOutboxVersionsOnDequeue(e,t,n,r)]:[3,3];case 2:o.sent(),o.label=3;case 3:return[4,e.delete(n)];case 4:return o.sent(),this.inProgressMutationEventId=void 0,[2,n]}}))}))},e.prototype.peek=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.queryOne(this.MutationEvent,E.Vo.FIRST)];case 1:return t=r.sent(),this.inProgressMutationEventId=t?t.id:void 0,[2,t]}}))}))},e.prototype.getForModel=function(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=this.schema.namespaces[D.a9].models.MutationEvent,o=X(r,t),[4,e.query(this.MutationEvent,T.nh.createFromAST(n,{and:{modelId:{eq:o}}}))];case 1:return[2,i.sent()]}}))}))},e.prototype.getModelIds=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,r;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return[4,e.query(this.MutationEvent)];case 1:return t=n.sent(),r=new Set,t.forEach((function(e){var t=e.modelId;return r.add(t)})),[2,r]}}))}))},e.prototype.syncOutboxVersionsOnDequeue=function(e,t,r,n){return(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,d,f,h,p,v,y,g,m=this;return(0,i.__generator)(this,(function(_){switch(_.label){case 0:return r.operation!==n?[2]:(o=t._version,a=t._lastChangedAt,t._deleted,s=(0,i.__rest)(t,["_version","_lastChangedAt","_deleted"]),u=this.removeTimestampFields(r.model,s),(c=JSON.parse(r.data))?(c._version,c._lastChangedAt,c._deleted,l=(0,i.__rest)(c,["_version","_lastChangedAt","_deleted"]),d=this.removeTimestampFields(r.model,l),(0,D.lu)(u,d,!0)?(f=this.schema.namespaces[D.a9].models.MutationEvent,h=this.schema.namespaces.user.models[r.model],p=X(h,t),v=T.nh.createFromAST(f,{and:[{modelId:{eq:p}},{id:{ne:this.inProgressMutationEventId}}]}),[4,e.query(this.MutationEvent,v)]):[2]):[2]);case 1:return(y=_.sent()).length?(g=y.map((function(e){var t=JSON.parse(e.data),r=(0,i.__assign)((0,i.__assign)({},t),{_version:o,_lastChangedAt:a});return m.MutationEvent.copyOf(e,(function(e){e.data=JSON.stringify(r)}))})),[4,e.delete(this.MutationEvent,v)]):[2];case 2:return _.sent(),[4,Promise.all(g.map((function(t){return(0,i.__awaiter)(m,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.save(t,void 0,this.ownSymbol)];case 1:return[2,r.sent()]}}))}))})))];case 3:return _.sent(),[2]}}))}))},e.prototype.mergeUserFields=function(e,t){var r=JSON.parse(e.data),n=r._version,o=r._lastChangedAt,a=r._deleted,s=(0,i.__rest)(r,["_version","_lastChangedAt","_deleted"]),u=JSON.parse(t.data),c=(u._version,u._lastChangedAt,u._deleted,(0,i.__rest)(u,["_version","_lastChangedAt","_deleted"])),l=JSON.stringify((0,i.__assign)((0,i.__assign)({_version:n,_lastChangedAt:o,_deleted:a},s),c));return this.modelInstanceCreator(this.MutationEvent,(0,i.__assign)((0,i.__assign)({},t),{data:l}))},e.prototype.removeTimestampFields=function(e,t){var r,n,o="createdAt",i="updatedAt",a=o,s=i,u=null===(r=this.schema.namespaces[D.m3].models[e].attributes)||void 0===r?void 0:r.find((function(e){return"model"===e.type})),c=null===(n=null==u?void 0:u.properties)||void 0===n?void 0:n.timestamps;return c&&(a=c[o],s=c[i]),delete t[a],delete t[s],t},e}(),Pe=r(766),Ae=r(37070),Te=function(e){return/^Connection failed: Connection Timeout/.test(e.message)},Ce=function(e){return/^Error: Request failed with status code 5\d\d/.test(e.message)},Oe={BadModel:function(){return!1},BadRecord:function(e){var t=e.message;return/^Cannot return \w+ for [\w-_]+ type/.test(t)||/^Variable '.+' has coerced Null value for NonNull type/.test(t)},ConfigError:function(){return!1},Transient:function(e){return Te(e)||Ce(e)},Unauthorized:function(e){return"Unauthorized"===e.message||/^Request failed with status code 401/.test(e.message)}},ke={BadModel:function(){return!1},BadRecord:function(){return!1},ConfigError:function(){return!1},Transient:function(e){var t=Me(e);return Te(t)||Ce(t)},Unauthorized:function(e){var t=Me(e);return/Connection failed.+Unauthorized/.test(t.message)}},Ne={BadModel:function(){return!1},BadRecord:function(e){return/^Cannot return \w+ for [\w-_]+ type/.test(e.message)},ConfigError:function(){return!1},Transient:function(e){return Te(e)||Ce(e)},Unauthorized:function(e){return"Unauthorized"===e.errorType}};function Me(e){var t=e.error;return(0,i.__read)((void 0===t?{errors:[]}:t).errors,1)[0]}function Re(e){return je(Oe,e)}function De(e){return je(Ne,e)}function je(e,t){var r,n,o=(0,i.__spread)(Object.keys(e));try{for(var a=(0,i.__values)(o),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];if(null==c?void 0:c(t))return u}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return"Unknown"}var Fe,Le,Ue=new c.C("DataStore"),qe=function(){function e(e,t,r,n,o,i,s,u,c,l,d){void 0===s&&(s={}),this.schema=e,this.storage=t,this.userClasses=r,this.outbox=n,this.modelInstanceCreator=o,this.MutationEvent=i,this.amplifyConfig=s,this.authModeStrategy=u,this.errorHandler=c,this.conflictHandler=l,this.amplifyContext=d,this.typeQuery=new WeakMap,this.processing=!1,this.runningProcesses=new v,this.amplifyContext.InternalAPI=this.amplifyContext.InternalAPI||a.G,this.generateQueries()}return e.prototype.generateQueries=function(){var e=this;Object.values(this.schema.namespaces).forEach((function(t){Object.values(t.models).filter((function(e){return e.syncable})).forEach((function(r){var n=(0,i.__read)(K(t,r,"CREATE"),1)[0],o=(0,i.__read)(K(t,r,"UPDATE"),1)[0],a=(0,i.__read)(K(t,r,"DELETE"),1)[0];e.typeQuery.set(r,[n,o,a])}))}))},e.prototype.isReady=function(){return void 0!==this.observer},e.prototype.start=function(){var e=this;return this.runningProcesses=new v,new w((function(t){e.observer=t;try{e.resume()}catch(e){throw Ue.error("mutations processor start error",e),e}return e.runningProcesses.addCleaner((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this.removeObserver(),this.pause(),[2]}))}))}))}))},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return this.removeObserver(),[4,this.runningProcesses.close()];case 1:return e.sent(),[4,this.runningProcesses.open()];case 2:return e.sent(),[2]}}))}))},e.prototype.removeObserver=function(){var e,t;null===(t=null===(e=this.observer)||void 0===e?void 0:e.complete)||void 0===t||t.call(e),this.observer=void 0},e.prototype.resume=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.runningProcesses.isOpen&&this.runningProcesses.add((function(t){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,r,n,o,a,s,u=this;return(0,i.__generator)(this,(function(c){switch(c.label){case 0:if(this.processing||!this.isReady()||!this.runningProcesses.isOpen)return[2];this.processing=!0,r=D.m3,n=function(){var n,a,c,l,d,f,h,p,v,y,g,m,_,b,w,S;return(0,i.__generator)(this,(function(x){switch(x.label){case 0:n=e.model,a=e.operation,c=e.data,l=e.condition,d=o.userClasses[n],f=void 0,h=void 0,p=void 0,x.label=1;case 1:return x.trys.push([1,4,,5]),[4,H({authModeStrategy:o.authModeStrategy,defaultAuthMode:o.amplifyConfig.aws_appsync_authenticationType,modelName:n,schema:o.schema})];case 2:return v=x.sent(),y=v[a.toUpperCase()],g=0,m=function(){return(0,i.__awaiter)(u,void 0,void 0,(function(){var o,s,u;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,9]),Ue.debug("Attempting mutation with authMode: "+y[g]),[4,this.jitteredRetry(r,n,a,c,l,d,this.MutationEvent,e,y[g],t)];case 1:return o=i.sent(),Ue.debug("Mutation sent successfully with authMode: "+y[g]),[2,o];case 2:if(s=i.sent(),!(++g>=y.length))return[3,7];Ue.debug("Mutation failed with authMode: "+y[g-1]),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:s.message,model:d.name,operation:h,errorType:Re(s),process:E.vL.sync,remoteModel:null,cause:s})];case 4:return i.sent(),[3,6];case 5:return u=i.sent(),Ue.error("Mutation error handler failed with:",u),[3,6];case 6:throw s;case 7:return Ue.debug("Mutation failed with authMode: "+y[g-1]+". Retrying with authMode: "+y[g]),[4,m()];case 8:return[2,i.sent()];case 9:return[2]}}))}))},[4,m()];case 3:return S=i.__read.apply(void 0,[x.sent(),3]),f=S[0],h=S[1],p=S[2],[3,5];case 4:return"Offline"===(_=x.sent()).message||"RetryMutation"===_.message?[2,"continue"]:[3,5];case 5:return void 0!==f?[3,7]:(Ue.debug("done retrying"),[4,o.storage.runExclusive((function(e){return(0,i.__awaiter)(u,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.outbox.dequeue(e)];case 1:return t.sent(),[2]}}))}))}))]);case 6:return x.sent(),[2,"continue"];case 7:return b=f.data[h],w=!1,[4,o.storage.runExclusive((function(e){return(0,i.__awaiter)(u,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.outbox.dequeue(e,b,a)];case 1:return t.sent(),[4,this.outbox.peek(e)];case 2:return w=void 0!==t.sent(),[2]}}))}))}))];case 8:return x.sent(),null===(s=null===(x=o.observer)||void 0===x?void 0:x.next)||void 0===s||s.call(x,{operation:a,modelDefinition:p,model:b,hasMore:w}),[2]}}))},o=this,c.label=1;case 1:return(a=this.processing&&this.runningProcesses.isOpen)?[4,this.outbox.peek(this.storage)]:[3,3];case 2:a=void 0!==(e=c.sent()),c.label=3;case 3:return a?[5,n()]:[3,5];case 4:return c.sent(),[3,1];case 5:return this.pause(),[2]}}))}))}),"mutation resume loop")];case 1:return t.sent(),[2]}}))}))},e.prototype.jitteredRetry=function(e,t,r,n,o,a,s,u,c,l){return(0,i.__awaiter)(this,void 0,void 0,(function(){var d=this;return(0,i.__generator)(this,(function(f){switch(f.label){case 0:return[4,(0,Pe.L5)((function(t,r,n,o,a,s,u){return(0,i.__awaiter)(d,void 0,void 0,(function(){var l,d,f,h,p,v,y,g,m,_,b,w,S,x,I,P,A,T,C,O,k,N,M,R,D,j,F;return(0,i.__generator)(this,(function(L){switch(L.label){case 0:return l=(0,i.__read)(this.createQueryVariables(e,t,r,n,o),5),d=l[0],f=l[1],h=l[2],p=l[3],v=l[4],[4,Z(c,this.amplifyConfig)];case 1:y=L.sent(),g={query:d,variables:f,authMode:c,authToken:y},m=0,_=this.opTypeFromTransformerOperation(r),b={category:Ae.b7.DataStore,action:Ae.CW.GraphQl},L.label=2;case 2:return L.trys.push([2,4,,17]),[4,this.amplifyContext.InternalAPI.graphql(g,void 0,b)];case 3:return[2,[L.sent(),p,v]];case 4:if(!((w=L.sent()).errors&&w.errors.length>0))return[3,15];if(S=(0,i.__read)(w.errors,1),x=S[0],I=x.originalError,P=(void 0===I?{}:I).code,A=void 0===P?null:P,"Unauthorized"===x.errorType)throw new Pe.OI("Unauthorized");if("Network Error"===x.message||"ECONNABORTED"===A){if(!this.processing)throw new Pe.OI("Offline");throw new Error("Network Error")}return"ConflictUnhandled"!==x.errorType?[3,13]:(m++,T=void 0,m>10?(T=E.$f,[3,8]):[3,5]);case 5:return L.trys.push([5,7,,8]),[4,this.conflictHandler({modelConstructor:a,localModel:this.modelInstanceCreator(a,f.input),remoteModel:this.modelInstanceCreator(a,x.data),operation:_,attempts:m})];case 6:return T=L.sent(),[3,8];case 7:return C=L.sent(),Ue.warn("conflict trycatch",C),[3,17];case 8:return T!==E.$f?[3,11]:(O=(0,i.__read)(K(this.schema.namespaces[e],v,"GET"),1),k=(0,i.__read)(O[0],3),N=k[1],M=k[2],[4,Z(c,this.amplifyConfig)]);case 9:return R=L.sent(),[4,this.amplifyContext.InternalAPI.graphql({query:M,variables:{id:f.input.id},authMode:c,authToken:R},void 0,b)];case 10:return[2,[L.sent(),N,v]];case 11:return D=this.schema.namespaces[e],j=z(D.relationships,v,_,a,T,h,s,this.modelInstanceCreator,u.id),[4,this.storage.save(j)];case 12:throw L.sent(),new Pe.OI("RetryMutation");case 13:try{this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:f.input,message:x.message,operation:r,errorType:Re(x),errorInfo:x.errorInfo,process:E.vL.mutate,cause:x,remoteModel:x.data?this.modelInstanceCreator(a,x.data):null})}catch(e){Ue.warn("Mutation error handler failed with:",e)}finally{return[2,x.data?[{data:(F={},F[p]=x.data,F)},p,v]:[]]}L.label=14;case 14:return[3,16];case 15:throw new Pe.OI(w);case 16:return[3,17];case 17:if(g)return[3,2];L.label=18;case 18:return[2]}}))}))}),[t,r,n,o,a,s,u],Be,l)];case 1:return[2,f.sent()]}}))}))},e.prototype.createQueryVariables=function(e,t,r,n,o){var a,s,u,c,l,d,f,h,p,v=this.schema.namespaces[e].models[t],y=this.schema.namespaces[e].keys[t].primaryKey,g=null===(f=v.attributes)||void 0===f?void 0:f.find((function(e){return"auth"===e.type})),m=(null===(h=null==g?void 0:g.properties)||void 0===h?void 0:h.rules.map((function(e){return e.ownerField})).filter((function(e){return e})))||["owner"],_=this.typeQuery.get(v),b=(0,i.__read)(_.find((function(e){return(0,i.__read)(e,1)[0]===r})),3),w=b[1],S=b[2],x=JSON.parse(n),I=x._version,P=(0,i.__rest)(x,["_version"]),A={};if(null==y?void 0:y.length)try{for(var T=(0,i.__values)(y),C=T.next();!C.done;C=T.next()){var O=C.value;A[O]=P[O]}}catch(e){a={error:e}}finally{try{C&&!C.done&&(s=T.return)&&s.call(T)}finally{if(a)throw a.error}}else A[D.ID]=P.id;if(r===N.DELETE)p=A;else{p={};var k=Object.values(v.fields);try{for(var M=(0,i.__values)(k),R=M.next();!R.done;R=M.next()){var j=R.value,F=j.name,L=j.type,U=j.association;if(!j.isReadOnly&&(!m.includes(F)||null!==P[F]))if((0,E.gw)(L)){if((0,E.UQ)(U)&&"BELONGS_TO"===U.connectionType){var q=(0,D.JO)(U);if(q)try{for(var W=(l=void 0,(0,i.__values)(q)),G=W.next();!G.done;G=W.next()){var B=G.value;p[B]=P[B]}}catch(e){l={error:e}}finally{try{G&&!G.done&&(d=W.return)&&d.call(W)}finally{if(l)throw l.error}}}}else(r!==N.UPDATE||P.hasOwnProperty(F))&&(p[F]=P[F])}}catch(e){u={error:e}}finally{try{R&&!R.done&&(c=M.return)&&c.call(M)}finally{if(u)throw u.error}}}var K=(0,i.__assign)((0,i.__assign)({},p),{_version:I}),z=JSON.parse(o);return[S,(0,i.__assign)({input:K},r===N.CREATE?{}:{condition:Object.keys(z).length>0?z:null}),z,w,v]},e.prototype.opTypeFromTransformerOperation=function(e){switch(e){case N.CREATE:return E.i5.INSERT;case N.DELETE:return E.i5.DELETE;case N.UPDATE:return E.i5.UPDATE;case N.GET:break;default:throw new Error("Invalid operation "+e)}},e.prototype.pause=function(){this.processing=!1},e}(),We=3e5,Ge=(0,Pe.yN)(We),Be=function(e,t,r){var n=Ge(e);return!1===n&&"Network Error"===(null==r?void 0:r.message)?We:n},Ke=r(55271).hp,ze=new c.C("DataStore");!function(e){e.CONNECTED="CONNECTED"}(Fe||(Fe={})),function(e){e[e.none=0]="none",e[e.unauth=1]="unauth",e[e.auth=2]="auth"}(Le||(Le={}));var Ve,Ye=function(){function e(e,t,r,n,o,i){void 0===r&&(r={}),void 0===i&&(i={Auth:s.N,InternalAPI:a.G,Cache:u.Y}),this.schema=e,this.syncPredicates=t,this.amplifyConfig=r,this.authModeStrategy=n,this.errorHandler=o,this.amplifyContext=i,this.typeQuery=new WeakMap,this.buffer=[],this.runningProcesses=new v}return e.prototype.buildSubscription=function(e,t,r,n,o,a,s,u){void 0===u&&(u=!1);var c=this.amplifyConfig.aws_appsync_authenticationType,l=this.getAuthorizationInfo(t,n,c,o,a,s)||{},d=l.isOwner,f=l.ownerField,h=l.ownerValue,p=(0,i.__read)(function(e,t,r,n,o,i){void 0===i&&(i=!1);var a=W(e,t),s=t.name,u="on"+r+s,c=[],l=[];return i&&(c.push("$filter: ModelSubscription"+s+"FilterInput"),l.push("filter: $filter")),n&&(c.push("$"+o+": String!"),l.push(o+": $"+o)),[r,u,"subscription operation"+(c.length?"("+c.join(",")+")":"")+"{\n\t\t\t"+u+(l.length?"("+l.join(",")+")":"")+"{\n\t\t\t\t"+a+"\n\t\t\t}\n\t\t}"]}(e,t,r,d,f,u),3);return{authMode:s,opType:p[0],opName:p[1],query:p[2],isOwner:d,ownerField:f,ownerValue:h}},e.prototype.getAuthorizationInfo=function(e,t,r,n,o,a){void 0===n&&(n={}),void 0===o&&(o={});var s=B(e);if(a===S.Tv.AWS_IAM&&s.find((function(e){return"private"===e.authStrategy&&"iam"===e.provider}))&&t===Le.unauth)return null;var u,c=s.filter((function(e){return"groups"===e.authStrategy&&["userPools","oidc"].includes(e.provider)}));return a!==S.Tv.AMAZON_COGNITO_USER_POOLS&&a!==S.Tv.OPENID_CONNECT||!c.find((function(e){var t=J(n,e),r=J(o,e);return(0,i.__spread)(t,r).find((function(t){return e.groups.find((function(e){return e===t}))}))}))?((a===S.Tv.AMAZON_COGNITO_USER_POOLS?s.filter((function(e){return"owner"===e.authStrategy&&"userPools"===e.provider})):[]).forEach((function(t){var r,o=n[t.identityClaim],i=!0!==(null===(r=e.fields[t.ownerField])||void 0===r?void 0:r.isArray)&&!t.areSubscriptionsPublic;o&&(u={authMode:S.Tv.AMAZON_COGNITO_USER_POOLS,isOwner:i,ownerField:t.ownerField,ownerValue:o})})),u||((a===S.Tv.OPENID_CONNECT?s.filter((function(e){return"owner"===e.authStrategy&&"oidc"===e.provider})):[]).forEach((function(t){var r,n=o[t.identityClaim],i=!0!==(null===(r=e.fields[t.ownerField])||void 0===r?void 0:r.isArray)&&!t.areSubscriptionsPublic;n&&(u={authMode:S.Tv.OPENID_CONNECT,isOwner:i,ownerField:t.ownerField,ownerValue:n})})),u||{authMode:a||r,isOwner:!1})):{authMode:a,isOwner:!1}},e.prototype.hubQueryCompletionListener=function(e,t){t.payload.event===be.U.SUBSCRIPTION_ACK&&e()},e.prototype.start=function(){var e=this;this.runningProcesses=this.runningProcesses||new v;var t=new w((function(t){var r,n,o=[],a={},s=Le.none;return e.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,u,c,l,d,f,h,p,v,y,m=this;return(0,i.__generator)(this,(function(_){switch(_.label){case 0:return _.trys.push([0,2,,3]),[4,this.amplifyContext.Auth.currentCredentials()];case 1:return e=_.sent(),s=e.authenticated?Le.auth:Le.unauth,[3,3];case 2:return _.sent(),[3,3];case 3:return _.trys.push([3,5,,6]),[4,this.amplifyContext.Auth.currentSession()];case 4:return u=_.sent(),r=u.getIdToken().decodePayload(),[3,6];case 5:return _.sent(),[3,6];case 6:if(_.trys.push([6,11,,12]),c=this.amplifyConfig,l=c.aws_cognito_region,d=c.Auth,!l||d&&!d.region)throw"Auth is not configured";return f=void 0,[4,this.amplifyContext.Cache.getItem("federatedInfo")];case 7:return(h=_.sent())?(f=h.token,[3,10]):[3,8];case 8:return[4,this.amplifyContext.Auth.currentAuthenticatedUser()];case 9:(p=_.sent())&&(f=p.token),_.label=10;case 10:return f&&(v=f.split(".")[1],n=JSON.parse(Ke.from(v,"base64").toString("utf8"))),[3,12];case 11:return y=_.sent(),ze.debug("error getting OIDC JWT",y),[3,12];case 12:return Object.values(this.schema.namespaces).forEach((function(e){Object.values(e.models).filter((function(e){return e.syncable})).forEach((function(u){return m.runningProcesses.isOpen&&m.runningProcesses.add((function(){return(0,i.__awaiter)(m,void 0,void 0,(function(){var c,l,d,f,h,p,v,y,m,_,b=this;return(0,i.__generator)(this,(function(w){switch(w.label){case 0:return[4,H({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:u.name,schema:this.schema})];case 1:return c=w.sent(),l=c.READ,a=(0,i.__assign)((0,i.__assign)({},a),((y={})[u.name]=((m={})[N.CREATE]=[],m[N.UPDATE]=[],m[N.DELETE]=[],m),y)),d=[N.CREATE,N.UPDATE,N.DELETE],(_={})[N.CREATE]=0,_[N.UPDATE]=0,_[N.DELETE]=0,f=_,h=T.nh.getPredicates(this.syncPredicates.get(u),!1),p=void 0!==h,v=function(c,d){return void 0===d&&(d=p),(0,i.__awaiter)(b,void 0,void 0,(function(){var p,y,m,_,b,w,S,x,I,P,A,C,O,k=this;return(0,i.__generator)(this,(function(N){switch(N.label){case 0:return p=this.buildSubscription(e,u,c,s,r,n,l[f[c]],d),y=p.opType,m=p.opName,_=p.query,b=p.isOwner,w=p.ownerField,S=p.ownerValue,[4,Z(x=p.authMode,this.amplifyConfig)];case 1:if(I=N.sent(),P={},A={category:Ae.b7.DataStore,action:Ae.CW.Subscribe},d&&h&&(P.filter=V(h)),b){if(!S)return t.error("Owner field required, sign in is needed in order to perform this operation"),[2];P[w]=S}return ze.debug("Attempting "+c+" subscription with authMode: "+l[f[c]]),C=this.amplifyContext.InternalAPI.graphql((0,i.__assign)((0,i.__assign)({query:_,variables:P},{authMode:x}),{authToken:I}),void 0,A),a[u.name][y].push(C.map((function(e){return e.value})).subscribe({next:function(e){var t=e.data,r=e.errors;if(Array.isArray(r)&&r.length>0){var n=r.map((function(e){return e.message}));return ze.warn("Skipping incoming subscription. Messages: "+n.join("\n")),void k.drainBuffer()}var o=T.nh.getPredicates(k.syncPredicates.get(u),!1),i=t[m];k.passesPredicateValidation(i,o)&&k.pushToBuffer(y,u,i),k.drainBuffer()},error:function(e){return(0,i.__awaiter)(k,void 0,void 0,(function(){var r,n,o,s,p,g;return(0,i.__generator)(this,(function(m){switch(m.label){case 0:if(r=e.error,n=(0,i.__read)((void 0===r?{errors:[]}:r).errors,1),o=n[0],s=(void 0===o?{}:o).message,p=void 0===s?"":s,d&&this.catchRTFError(p,u,h))return a[u.name][y].forEach((function(e){return e.unsubscribe()})),a[u.name][y]=[],v(c,!1),[2];if(p.includes(be.U.REALTIME_SUBSCRIPTION_INIT_ERROR)||p.includes(be.U.CONNECTION_FAILED)){if(a[u.name][y].forEach((function(e){return e.unsubscribe()})),a[u.name][y]=[],f[c]++,!(f[c]>=l.length))return ze.debug(c+" subscription failed with authMode: "+l[f[c]-1]+". Retrying with authMode: "+l[f[c]]),v(c),[2];ze.debug(c+" subscription failed with authMode: "+l[f[c]-1])}ze.warn("subscriptionError",p),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:p,model:u.name,operation:c,errorType:(_=e,je(ke,_)),process:E.vL.subscribe,remoteModel:null,cause:e})];case 2:return m.sent(),[3,4];case 3:return g=m.sent(),ze.error("Subscription error handler failed with:",g),[3,4];case 4:return"function"==typeof O&&O(),p.includes('"errorType":"Unauthorized"')||p.includes('"errorType":"OperationDisabled"')?[2]:(t.error(p),[2])}var _}))}))}})),o.push((0,i.__awaiter)(k,void 0,void 0,(function(){var e,t=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(r){O=r,e=t.hubQueryCompletionListener.bind(t,r),g.Y.listen("api",e)}))];case 1:return r.sent(),g.Y.remove("api",e),[2]}}))}))),[2]}}))}))},d.forEach((function(e){return v(e)})),[2]}}))}))}))}))})),this.runningProcesses.isOpen&&this.runningProcesses.add((function(){return Promise.all(o).then((function(){t.next(Fe.CONNECTED)}))})),[2]}}))}))}),"subscription processor new subscriber"),e.runningProcesses.addCleaner((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return Object.keys(a).forEach((function(e){a[e][N.CREATE].forEach((function(e){return e.unsubscribe()})),a[e][N.UPDATE].forEach((function(e){return e.unsubscribe()})),a[e][N.DELETE].forEach((function(e){return e.unsubscribe()}))})),[2]}))}))}))}));return[t,new w((function(t){return e.dataObserver=t,e.drainBuffer(),e.runningProcesses.addCleaner((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return this.dataObserver=null,[2]}))}))}))}))]},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.runningProcesses.close()];case 1:return e.sent(),[4,this.runningProcesses.open()];case 2:return e.sent(),[2]}}))}))},e.prototype.passesPredicateValidation=function(e,t){if(!t)return!0;var r=t.predicates,n=t.type;return(0,D.MJ)(e,n,r)},e.prototype.pushToBuffer=function(e,t,r){this.buffer.push([e,t,r])},e.prototype.drainBuffer=function(){var e=this;this.dataObserver&&(this.buffer.forEach((function(t){return e.dataObserver.next(t)})),this.buffer=[])},e.prototype.catchRTFError=function(e,t,r){var n={"UnknownArgument: Unknown field argument filter":L.UnknownField,"Filters exceed maximum attributes limit":L.MaxAttributes,"Filters combination exceed maximum limit":L.MaxCombinations,"filter uses same fieldName multiple time":L.RepeatedFieldname,"The variables input contains a field name 'not'":L.NotGroup,"The variables input contains a field that is not defined for input object type":L.FieldNotInType},o=(0,i.__read)(Object.entries(n).find((function(t){var r=(0,i.__read)(t,1)[0];return e.includes(r)}))||[],2),a=(o[0],o[1]);if(void 0!==a){var s=Y(a,t,r);return ze.warn("Backend subscriptions filtering error.\nSubscriptions filtering will be applied clientside.\n\n"+e+"\n"+s),!0}return!1},e}(),Je={items:[],nextToken:null,startedAt:null},He=new c.C("DataStore"),Qe=function(){function e(e,t,r,n,o,i){void 0===r&&(r={}),this.schema=e,this.syncPredicates=t,this.amplifyConfig=r,this.authModeStrategy=n,this.errorHandler=o,this.amplifyContext=i,this.typeQuery=new WeakMap,this.runningProcesses=new v,i.InternalAPI=i.InternalAPI||a.G,this.generateQueries()}return e.prototype.generateQueries=function(){var e=this;Object.values(this.schema.namespaces).forEach((function(t){Object.values(t.models).filter((function(e){return e.syncable})).forEach((function(r){var n=(0,i.__read)(K(t,r,"LIST"),1),o=(0,i.__read)(n[0]).slice(1);e.typeQuery.set(r,o)}))}))},e.prototype.graphqlFilterFromPredicate=function(e){if(!this.syncPredicates)return null;var t=T.nh.getPredicates(this.syncPredicates.get(e),!1);return t?V(t):null},e.prototype.retrievePage=function(e,t,r,n,o,a){return void 0===n&&(n=null),(0,i.__awaiter)(this,void 0,void 0,(function(){var s,u,c,l,d,f,h,p,v,y,g,m,_,b=this;return(0,i.__generator)(this,(function(w){switch(w.label){case 0:return s=(0,i.__read)(this.typeQuery.get(e),2),u=s[0],c=s[1],l={limit:n,nextToken:r,lastSync:t,filter:o},[4,H({authModeStrategy:this.authModeStrategy,defaultAuthMode:this.amplifyConfig.aws_appsync_authenticationType,modelName:e.name,schema:this.schema})];case 1:return d=w.sent(),f=d.READ,h=0,p=function(){return(0,i.__awaiter)(b,void 0,void 0,(function(){var t,r,n,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(!this.runningProcesses.isOpen)throw new Error("sync.retreievePage termination was requested. Exiting.");i.label=1;case 1:return i.trys.push([1,3,,5]),He.debug("Attempting sync with authMode: "+f[h]),[4,this.jitteredRetry({query:c,variables:l,opName:u,modelDefinition:e,authMode:f[h],onTerminate:a})];case 2:return t=i.sent(),He.debug("Sync successful with authMode: "+f[h]),[2,t];case 3:if(r=i.sent(),++h>=f.length){if(n=f[h-1],He.debug("Sync failed with authMode: "+n,r),$(r)||Q(r))return He.warn("User is unauthorized to query "+u+" with auth mode "+n+". No data could be returned."),[2,{data:(o={},o[u]=Je,o)}];throw r}return He.debug("Sync failed with authMode: "+f[h-1]+". Retrying with authMode: "+f[h]),[4,p()];case 4:return[2,i.sent()];case 5:return[2]}}))}))},[4,p()];case 2:return v=w.sent().data,y=v[u],g=y.items,m=y.nextToken,_=y.startedAt,[2,{nextToken:m,startedAt:_,items:g}]}}))}))},e.prototype.jitteredRetry=function(e){var t=e.query,r=e.variables,n=e.opName,o=e.modelDefinition,a=e.authMode,s=e.onTerminate;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(u){switch(u.label){case 0:return[4,(0,Pe.hu)((function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,s,u,c,l,d,f,h,p,v,y,m,_=this;return(0,i.__generator)(this,(function(b){switch(b.label){case 0:return b.trys.push([0,3,,6]),[4,Z(a,this.amplifyConfig)];case 1:return e=b.sent(),s={category:Ae.b7.DataStore,action:Ae.CW.GraphQl},[4,this.amplifyContext.InternalAPI.graphql({query:t,variables:r,authMode:a,authToken:e},void 0,s)];case 2:return[2,b.sent()];case 3:if(u=b.sent(),c=$(u)||Q(u))throw He.error("Sync processor retry error:",u),new Pe.OI(c);return l=Boolean(null===(v=null===(p=null==u?void 0:u.data)||void 0===p?void 0:p[n])||void 0===v?void 0:v.items),d=(null==u?void 0:u.errors)&&u.errors.some((function(e){return"Unauthorized"===e.errorType})),f=(null==u?void 0:u.errors)&&u.errors.filter((function(e){return"Unauthorized"!==e.errorType})),h=u,l&&(h.data[n].items=h.data[n].items.filter((function(e){return null!==e}))),l&&(null==f?void 0:f.length)?[4,Promise.all(f.map((function(e){return(0,i.__awaiter)(_,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:e.message,model:o.name,operation:n,errorType:De(e),process:E.vL.sync,remoteModel:null,cause:e})];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),He.error("Sync error handler failed with:",t),[3,3];case 3:return[2]}}))}))})))]:[3,5];case 4:b.sent(),g.Y.dispatch("datastore",{event:"nonApplicableDataReceived",data:{errors:f,modelName:o.name}}),b.label=5;case 5:if(d)throw this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:u.message,model:o.name,operation:n,errorType:De(u.errors[0]),process:E.vL.sync,remoteModel:null,cause:u}),new Pe.OI(u);if(null===(m=null===(y=h.data)||void 0===y?void 0:y[n].items)||void 0===m?void 0:m.length)return[2,h];throw u;case 6:return[2]}}))}))}),[t,r],void 0,s)];case 1:return[2,u.sent()]}}))}))},e.prototype.start=function(e){var t=this,r=this.amplifyConfig,n=r.maxRecordsToSync,o=r.syncPageSize,a=new Map,s=new w((function(r){var s=Object.values(t.schema.namespaces).reduce((function(t,r){var n,o;try{for(var a=(0,i.__values)(Array.from(r.modelTopologicalOrdering.keys())),s=a.next();!s.done;s=a.next()){var u=s.value,c=e.get(r.models[u]);t.set(r.models[u],c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return t}),new Map),u=Array.from(s.entries()).filter((function(e){return(0,i.__read)(e,1)[0].syncable})).map((function(e){var s=(0,i.__read)(e,2),u=s[0],c=(0,i.__read)(s[1],2),l=c[0],d=c[1];return t.runningProcesses.isOpen&&t.runningProcesses.add((function(e){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,s,c,f,h,p,v,y,g,m=this;return(0,i.__generator)(this,(function(_){switch(_.label){case 0:return t=!1,s=null,c=null,f=null,h=0,p=this.graphqlFilterFromPredicate(u),v=this.schema.namespaces[l].modelTopologicalOrdering.get(u.name),y=v.map((function(e){return a.get(l+"_"+e)})),g=new Promise((function(a){return(0,i.__awaiter)(m,void 0,void 0,(function(){var v,g,m,_;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all(y)];case 1:i.sent(),i.label=2;case 2:if(!this.runningProcesses.isOpen)return He.debug("Sync processor has been stopped, terminating sync for "+u.name),[2,a()];v=Math.min(n-h,o),i.label=3;case 3:return i.trys.push([3,5,,10]),[4,this.retrievePage(u,d,s,v,p,e)];case 4:return _=i.sent(),f=_.items,s=_.nextToken,c=_.startedAt,[3,10];case 5:g=i.sent(),i.label=6;case 6:return i.trys.push([6,8,,9]),[4,this.errorHandler({recoverySuggestion:"Ensure app code is up to date, auth directives exist and are correct on each model, and that server-side data has not been invalidated by a schema change. If the problem persists, search for or create an issue: https://github.com/aws-amplify/amplify-js/issues",localModel:null,message:g.message,model:u.name,operation:null,errorType:De(g),process:E.vL.sync,remoteModel:null,cause:g})];case 7:return i.sent(),[3,9];case 8:return m=i.sent(),He.error("Sync error handler failed with:",m),[3,9];case 9:return t=!0,f=[],[3,10];case 10:h+=f.length,t=null===s||h>=n,r.next({namespace:l,modelDefinition:u,items:f,done:t,startedAt:c,isFullSync:!d}),i.label=11;case 11:if(!t)return[3,2];i.label=12;case 12:return a(),[2]}}))}))})),a.set(l+"_"+u.name,g),[4,g];case 1:return _.sent(),[2]}}))}))}),"adding model "+u.name)}));Promise.all(u).then((function(){r.complete()}))}));return s},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return He.debug("stopping sync processor"),[4,this.runningProcesses.close()];case 1:return e.sent(),[4,this.runningProcesses.open()];case 2:return e.sent(),He.debug("sync processor stopped"),[2]}}))}))},e}(),$e=(0,l.gy)().isNode,Ze=new c.C("DataStore"),Xe=Symbol("sync");!function(e){e.SYNC_ENGINE_STORAGE_SUBSCRIBED="storageSubscribed",e.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED="subscriptionsEstablished",e.SYNC_ENGINE_SYNC_QUERIES_STARTED="syncQueriesStarted",e.SYNC_ENGINE_SYNC_QUERIES_READY="syncQueriesReady",e.SYNC_ENGINE_MODEL_SYNCED="modelSynced",e.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED="outboxMutationEnqueued",e.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED="outboxMutationProcessed",e.SYNC_ENGINE_OUTBOX_STATUS="outboxStatus",e.SYNC_ENGINE_NETWORK_STATUS="networkStatus",e.SYNC_ENGINE_READY="ready"}(Ve||(Ve={}));var et,tt=function(){function e(e,t,r,n,o,i,a,s,u,c,l,d,f){var h=this;void 0===c&&(c={}),this.schema=e,this.namespaceResolver=t,this.modelClasses=r,this.userModelClasses=n,this.storage=o,this.modelInstanceCreator=i,this.syncPredicates=u,this.amplifyConfig=c,this.authModeStrategy=l,this.amplifyContext=d,this.connectivityMonitor=f,this.online=!1,this.modelSyncedStatus=new WeakMap,this.connectionDisrupted=!1,this.runningProcesses=new v,this.waitForSleepState=new Promise((function(e){h.syncQueriesObservableStartSleeping=e}));var p=this.modelClasses.MutationEvent;this.outbox=new Ie(this.schema,p,i,Xe),this.modelMerger=new xe(this.outbox,Xe),this.syncQueriesProcessor=new Qe(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,s,this.amplifyContext),this.subscriptionsProcessor=new Ye(this.schema,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,s,this.amplifyContext),this.mutationsProcessor=new qe(this.schema,this.storage,this.userModelClasses,this.outbox,this.modelInstanceCreator,p,this.amplifyConfig,this.authModeStrategy,s,a,this.amplifyContext),this.datastoreConnectivity=this.connectivityMonitor||new Ee}return e.prototype.getModelSyncedStatus=function(e){return this.modelSyncedStatus.get(e)},e.prototype.start=function(e){var t=this;return new w((function(r){Ze.log("starting sync engine...");var n=[];t.runningProcesses.add((function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,o,a,s=this;return(0,i.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.setupModels(e)];case 1:return u.sent(),[3,3];case 2:return t=u.sent(),r.error(t),[2];case 3:return o=new Promise((function(e,t){s.datastoreConnectivity.status().subscribe((function(o){var a=o.online;return(0,i.__awaiter)(s,void 0,void 0,(function(){var o=this;return(0,i.__generator)(this,(function(s){return[2,this.runningProcesses.isOpen&&this.runningProcesses.add((function(s){return(0,i.__awaiter)(o,void 0,void 0,(function(){var o,u,c,l,d,f=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:return!a||this.online?[3,10]:(this.online=a,r.next({type:Ve.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),u=void 0,$e?(Ze.warn("Realtime disabled when in a server-side environment"),[3,6]):[3,1]);case 1:this.stopDisruptionListener=this.startDisruptionListener(),d=(0,i.__read)(this.subscriptionsProcessor.start(),2),o=d[0],u=d[1],h.label=2;case 2:return h.trys.push([2,4,,5]),[4,new Promise((function(e,t){s.then(t);var r=o.subscribe({next:function(t){t===Fe.CONNECTED&&e()},error:function(e){t(e),f.disconnectionHandler()(e)}});n.push(r)}))];case 3:return h.sent(),[3,5];case 4:return c=h.sent(),r.error(c),t(),[2];case 5:Ze.log("Realtime ready"),r.next({type:Ve.SYNC_ENGINE_SUBSCRIPTIONS_ESTABLISHED}),h.label=6;case 6:return h.trys.push([6,8,,9]),[4,new Promise((function(e,t){var o=f.syncQueriesObservable().subscribe({next:function(t){t.type===Ve.SYNC_ENGINE_SYNC_QUERIES_READY&&e(),r.next(t)},complete:function(){e()},error:function(e){t(e)}});o&&n.push(o)}))];case 7:return h.sent(),[3,9];case 8:return l=h.sent(),r.error(l),t(),[2];case 9:return n.push(this.mutationsProcessor.start().subscribe((function(e){var t=e.modelDefinition,n=e.model,o=e.hasMore;return f.runningProcesses.add((function(){return(0,i.__awaiter)(f,void 0,void 0,(function(){var e,a,s=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.userModelClasses[t.name],a=this.modelInstanceCreator(e,n),[4,this.storage.runExclusive((function(e){return s.modelMerger.merge(e,a,t)}))];case 1:return i.sent(),r.next({type:Ve.SYNC_ENGINE_OUTBOX_MUTATION_PROCESSED,data:{model:e,element:a}}),r.next({type:Ve.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!o}}),[2]}}))}))}),"mutation processor event")}))),$e||n.push(u.subscribe((function(e){var t=(0,i.__read)(e,3),r=(t[0],t[1]),n=t[2];return f.runningProcesses.add((function(){return(0,i.__awaiter)(f,void 0,void 0,(function(){var e,t,o=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.userModelClasses[r.name],t=this.modelInstanceCreator(e,n),[4,this.storage.runExclusive((function(e){return o.modelMerger.merge(e,t,r)}))];case 1:return i.sent(),[2]}}))}))}),"subscription dataSubsObservable event")}))),[3,11];case 10:a||(this.online=a,r.next({type:Ve.SYNC_ENGINE_NETWORK_STATUS,data:{active:this.online}}),n.forEach((function(e){return e.unsubscribe()})),n=[]),h.label=11;case 11:return e(),[2]}}))}))}),"datastore connectivity event")]}))}))}))})),this.storage.observe(null,null,Xe).filter((function(e){var t=e.model;return!0===s.getModelDefinition(t).syncable})).subscribe({next:function(e){var t=e.opType,n=e.model,a=e.element,u=e.condition;return(0,i.__awaiter)(s,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(s){return[2,this.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,s,c,l,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.schema.namespaces[this.namespaceResolver(n)],s=this.modelClasses.MutationEvent,c=this.getModelDefinition(n),l=function(e,t){return e&&Array.isArray(e.predicates)?V(e,(0,D.ng)(t)):{}}(u,c),d=z(e.relationships,this.getModelDefinition(n),t,n,a,l,s,this.modelInstanceCreator),[4,this.outbox.enqueue(this.storage,d)];case 1:return i.sent(),r.next({type:Ve.SYNC_ENGINE_OUTBOX_MUTATION_ENQUEUED,data:{model:n,element:a}}),r.next({type:Ve.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:!1}}),[4,o];case 2:return i.sent(),this.online&&this.mutationsProcessor.resume(),[2]}}))}))}),"storage event")]}))}))}}),r.next({type:Ve.SYNC_ENGINE_STORAGE_SUBSCRIBED}),[4,this.outbox.peek(this.storage)];case 4:return a=void 0===u.sent(),r.next({type:Ve.SYNC_ENGINE_OUTBOX_STATUS,data:{isEmpty:a}}),[4,o];case 5:return u.sent(),r.next({type:Ve.SYNC_ENGINE_READY}),[2]}}))}))}),"sync start")}))},e.prototype.getModelsMetadataWithNextFullSync=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,r=this;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t=Map.bind,[4,this.runningProcesses.add((function(){return r.getModelsMetadata()}),"sync/index getModelsMetadataWithNextFullSync")];case 1:return[2,new(t.apply(Map,[void 0,n.sent().map((function(t){var n=t.namespace,o=t.model,i=t.lastSync,a=t.lastFullSync,s=t.fullSyncInterval,u=(t.lastSyncPredicate,!a||a+s<e?0:i);return[r.schema.namespaces[n].models[o],[n,u]]}))]))]}}))}))},e.prototype.syncQueriesObservable=function(){var e=this;return this.online?new w((function(t){var r;e.runningProcesses.isOpen&&e.runningProcesses.add((function(n){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,o,a,s=this;return(0,i.__generator)(this,(function(u){switch(u.label){case 0:e=!1,o=function(){var o,u,c,l,d,f,h,p,v;return(0,i.__generator)(this,(function(y){switch(y.label){case 0:return o=new WeakMap,[4,a.getModelsMetadataWithNextFullSync(Date.now())];case 1:return u=y.sent(),c=new Set(u.keys()),[4,new Promise((function(e,a){s.runningProcesses.isOpen||e(),n.then((function(){return e()})),r=s.syncQueriesProcessor.start(u).subscribe({next:function(n){var a=n.namespace,u=n.modelDefinition,v=n.items,y=n.done,g=n.startedAt,m=n.isFullSync;return(0,i.__awaiter)(s,void 0,void 0,(function(){var n,s,_,b,w,S,x=this;return(0,i.__generator)(this,(function(I){switch(I.label){case 0:return n=this.userModelClasses[u.name],o.has(n)||(o.set(n,{new:0,updated:0,deleted:0}),f=(0,D.hY)(),p=void 0===p?g:Math.max(p,g)),[4,this.storage.runExclusive((function(e){return(0,i.__awaiter)(x,void 0,void 0,(function(){var t,r,a,s,c,l,d,f,h,p,y,g,m,_,b;return(0,i.__generator)(this,(function(w){switch(w.label){case 0:return[4,this.outbox.getModelIds(e)];case 1:t=w.sent(),r=[],a=v.filter((function(e){var n=X(u,e);return!t.has(n)||(r.push(e),!1)})),s=[],w.label=2;case 2:w.trys.push([2,7,8,9]),c=(0,i.__values)(r),l=c.next(),w.label=3;case 3:return l.done?[3,6]:(d=l.value,[4,this.modelMerger.merge(e,d,u)]);case 4:void 0!==(f=w.sent())&&s.push([d,f]),w.label=5;case 5:return l=c.next(),[3,3];case 6:return[3,9];case 7:return h=w.sent(),_={error:h},[3,9];case 8:try{l&&!l.done&&(b=c.return)&&b.call(c)}finally{if(_)throw _.error}return[7];case 9:return y=(p=s.push).apply,g=[s],[4,this.modelMerger.mergePage(e,n,a,u)];case 10:return y.apply(p,g.concat([i.__spread.apply(void 0,[w.sent()])])),m=o.get(n),s.forEach((function(e){var t=(0,i.__read)(e,2)[1];switch(t){case E.i5.INSERT:m.new++;break;case E.i5.UPDATE:m.updated++;break;case E.i5.DELETE:m.deleted++;break;default:throw new Error("Invalid opType "+t)}})),[2]}}))}))}))];case 1:return I.sent(),y?(s=u.name,[4,this.getModelMetadata(a,s)]):[3,4];case 2:return _=I.sent(),b=_.lastFullSync,w=_.fullSyncInterval,d=w,l=void 0===l?b:Math.max(l,m?g:b),_=this.modelClasses.ModelMetadata.copyOf(_,(function(e){e.lastSync=g,e.lastFullSync=m?g:_.lastFullSync})),[4,this.storage.save(_,void 0,Xe)];case 3:I.sent(),S=o.get(n),this.modelSyncedStatus.set(n,!0),t.next({type:Ve.SYNC_ENGINE_MODEL_SYNCED,data:{model:n,isFullSync:m,isDeltaSync:!m,counts:S}}),c.delete(u),0===c.size&&(h=(0,D.hY)()-f,e(),t.next({type:Ve.SYNC_ENGINE_SYNC_QUERIES_READY}),r.unsubscribe()),I.label=4;case 4:return[2]}}))}))},error:function(e){t.error(e)}}),t.next({type:Ve.SYNC_ENGINE_SYNC_QUERIES_STARTED,data:{models:Array.from(c).map((function(e){return e.name}))}})}))];case 2:return y.sent(),v=l?l+d-(p+h):d-h,Ze.debug("Next fullSync in "+v/1e3+" seconds. ("+new Date(Date.now()+v)+")"),[4,a.runningProcesses.add((function(t){return(0,i.__awaiter)(s,void 0,void 0,(function(){var r,n,o=this;return(0,i.__generator)(this,(function(i){return n=new Promise((function(e){r=e,setTimeout(r,v)})),t.then((function(){e=!0,o.syncQueriesObservableStartSleeping(),r()})),this.unsleepSyncQueriesObservable=r,this.syncQueriesObservableStartSleeping(),[2,n]}))}))}),"syncQueriesObservable sleep")];case 3:return y.sent(),a.unsleepSyncQueriesObservable=null,a.waitForSleepState=new Promise((function(e){s.syncQueriesObservableStartSleeping=e})),[2]}}))},a=this,u.label=1;case 1:return t.closed||e?[3,3]:[5,o()];case 2:return u.sent(),[3,1];case 3:return[2]}}))}))}),"syncQueriesObservable main")})):w.of()},e.prototype.disconnectionHandler=function(){var e=this;return function(t){be.U.CONNECTION_CLOSED!==t&&be.U.TIMEOUT_DISCONNECT!==t||e.datastoreConnectivity.socketDisconnected()}},e.prototype.unsubscribeConnectivity=function(){this.datastoreConnectivity.unsubscribe()},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return Ze.debug("stopping sync engine"),this.unsubscribeConnectivity(),this.stopDisruptionListener&&this.stopDisruptionListener(),[4,this.mutationsProcessor.stop()];case 1:return e.sent(),[4,this.subscriptionsProcessor.stop()];case 2:return e.sent(),[4,this.datastoreConnectivity.stop()];case 3:return e.sent(),[4,this.syncQueriesProcessor.stop()];case 4:return e.sent(),[4,this.runningProcesses.close()];case 5:return e.sent(),[4,this.runningProcesses.open()];case 6:return e.sent(),Ze.debug("sync engine stopped and ready to restart"),[2]}}))}))},e.prototype.setupModels=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,r,n,o,a,s,u,c,l,d,f,h,p,v=this;return(0,i.__generator)(this,(function(y){switch(y.label){case 0:t=e.fullSyncInterval,r=this.modelClasses.ModelMetadata,n=[],Object.values(this.schema.namespaces).forEach((function(e){Object.values(e.models).filter((function(e){return e.syncable})).forEach((function(t){if(n.push([e.name,t]),e.name===D.m3){var r=v.userModelClasses[t.name];v.modelSyncedStatus.set(r,!1)}}))})),a=n.map((function(e){var n=(0,i.__read)(e,2),a=n[0],s=n[1];return(0,i.__awaiter)(v,void 0,void 0,(function(){var e,n,u,c,l,d,f,h,p;return(0,i.__generator)(this,(function(v){switch(v.label){case 0:return[4,this.getModelMetadata(a,s.name)];case 1:return e=v.sent(),n=T.nh.getPredicates(this.syncPredicates.get(s),!1),u=n?JSON.stringify(n):null,void 0!==e?[3,3]:[4,this.storage.save(this.modelInstanceCreator(r,{model:s.name,namespace:a,lastSync:null,fullSyncInterval:t,lastFullSync:null,lastSyncPredicate:u}),void 0,Xe)];case 2:return d=i.__read.apply(void 0,[v.sent(),1]),f=(0,i.__read)(d[0],1),o=f[0],[3,5];case 3:return c=e.lastSyncPredicate?e.lastSyncPredicate:null,l=c!==u,[4,this.storage.save(r.copyOf(e,(function(e){e.fullSyncInterval=t,l&&(e.lastSync=null,e.lastFullSync=null,e.lastSyncPredicate=u)})))];case 4:h=i.__read.apply(void 0,[v.sent(),1]),p=(0,i.__read)(h[0],1),o=p[0],v.label=5;case 5:return[2,o]}}))}))})),s={},y.label=1;case 1:return y.trys.push([1,6,7,8]),[4,Promise.all(a)];case 2:u=i.__values.apply(void 0,[y.sent()]),c=u.next(),y.label=3;case 3:if(c.done)return[3,5];l=c.value,d=l.model,s[d]=l,y.label=4;case 4:return c=u.next(),[3,3];case 5:return[3,8];case 6:return f=y.sent(),h={error:f},[3,8];case 7:try{c&&!c.done&&(p=u.return)&&p.call(u)}finally{if(h)throw h.error}return[7];case 8:return[2,s]}}))}))},e.prototype.getModelsMetadata=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return e=this.modelClasses.ModelMetadata,[4,this.storage.query(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getModelMetadata=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return r=this.modelClasses.ModelMetadata,n=T.nh.createFromAST(this.schema.namespaces[D.a9].models[r.name],{and:[{namespace:{eq:e}},{model:{eq:t}}]}),[4,this.storage.query(r,n,{page:0,limit:1})];case 1:return o=i.__read.apply(void 0,[a.sent(),1]),[2,o[0]]}}))}))},e.prototype.getModelDefinition=function(e){var t=this.namespaceResolver(e);return this.schema.namespaces[t].models[e.name]},e.getNamespace=function(){return{name:D.a9,relationships:{},enums:{OperationType:{name:"OperationType",values:["CREATE","UPDATE","DELETE"]}},nonModels:{},models:{MutationEvent:{name:"MutationEvent",pluralName:"MutationEvents",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},data:{name:"data",type:"String",isRequired:!0,isArray:!1},modelId:{name:"modelId",type:"String",isRequired:!0,isArray:!1},operation:{name:"operation",type:{enum:"Operationtype"},isArray:!1,isRequired:!0},condition:{name:"condition",type:"String",isArray:!1,isRequired:!0}}},ModelMetadata:{name:"ModelMetadata",pluralName:"ModelsMetadata",syncable:!1,fields:{id:{name:"id",type:"ID",isRequired:!0,isArray:!1},namespace:{name:"namespace",type:"String",isRequired:!0,isArray:!1},model:{name:"model",type:"String",isRequired:!0,isArray:!1},lastSync:{name:"lastSync",type:"Int",isRequired:!1,isArray:!1},lastFullSync:{name:"lastFullSync",type:"Int",isRequired:!1,isArray:!1},fullSyncInterval:{name:"fullSyncInterval",type:"Int",isRequired:!0,isArray:!1},lastSyncPredicate:{name:"lastSyncPredicate",type:"String",isRequired:!1,isArray:!1}}}}}},e.prototype.startDisruptionListener=function(){var e=this;return g.Y.listen("api",(function(t){if("PubSub"===t.source&&t.payload.event===we._Y)switch(t.payload.data.connectionState){case be.K.ConnectionDisrupted:e.connectionDisrupted=!0;break;case be.K.Connected:e.connectionDisrupted&&e.scheduleSync(),e.connectionDisrupted=!1}}))},e.prototype.scheduleSync=function(){var e=this;return this.runningProcesses.isOpen&&this.runningProcesses.add((function(){return e.waitForSleepState.then((function(){e.unsleepSyncQueriesObservable()}))}))},e}(),rt=(0,i.__spread)(T.Qb),nt=new Map,ot=function(e,t){var r=t||new E.DW;return nt.set(r,e),r},it=function(e){if(!nt.has(e))throw new Error("Invalid predicate. Terminate your predicate with a valid condition (e.g., `p => p.field.eq('value')`) or pass `Predicates.ALL`.");return nt.get(e)},at={and:"or",or:"and",not:"and",eq:"ne",ne:"eq",gt:"le",ge:"lt",lt:"ge",le:"gt",contains:"notContains",notContains:"contains"},st=function(){function e(e,t,r){this.field=e,this.operator=t,this.operands=r,this.validate()}return e.prototype.copy=function(t){return[new e(this.field,this.operator,(0,i.__spread)(this.operands)),void 0]},e.prototype.toAST=function(){var e,t;return(e={})[this.field]=((t={})[this.operator]="between"===this.operator?[this.operands[0],this.operands[1]]:this.operands[0],t),e},e.prototype.negated=function(t){return"between"===this.operator?new ct(t,void 0,void 0,"or",[new e(this.field,"lt",[this.operands[0]]),new e(this.field,"gt",[this.operands[1]])]):"beginsWith"===this.operator?new ct(t,void 0,void 0,"not",[new e(this.field,"beginsWith",[this.operands[0]])]):new e(this.field,at[this.operator],this.operands)},e.prototype.fetch=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,Promise.reject("No implementation needed [yet].")]}))}))},e.prototype.matches=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,r,n=this;return(0,i.__generator)(this,(function(o){if(t=e[this.field],r={eq:function(){return t===n.operands[0]},ne:function(){return t!==n.operands[0]},gt:function(){return t>n.operands[0]},ge:function(){return t>=n.operands[0]},lt:function(){return t<n.operands[0]},le:function(){return t<=n.operands[0]},contains:function(){return(null==t?void 0:t.indexOf(n.operands[0]))>-1},notContains:function(){return!t||-1===t.indexOf(n.operands[0])},beginsWith:function(){return null==t?void 0:t.startsWith(n.operands[0])},between:function(){return t>=n.operands[0]&&t<=n.operands[1]}}[this.operator])return[2,r()];throw new Error("Invalid operator given: "+this.operator)}))}))},e.prototype.validate=function(){var e=this,t=function(t){var r=1===t?"argument is":"arguments are";return function(){if(e.operands.length!==t)return"Exactly "+t+" "+r+" required."}},r={eq:t(1),ne:t(1),gt:t(1),ge:t(1),lt:t(1),le:t(1),contains:t(1),notContains:t(1),beginsWith:t(1),between:function(){return t(2)()||(e.operands[0]>e.operands[1]?"The first argument must be less than or equal to the second argument.":null)}}[this.operator];if(!r)throw new Error("Non-existent operator: `"+this.operator+"()`");var n=r();if("string"==typeof n)throw new Error("Incorrect usage of `"+this.operator+"()`: "+n)},e}(),ut=(et=1,function(){return"group_"+et++}),ct=function(){function e(e,t,r,n,o,i){void 0===i&&(i=!1),this.model=e,this.field=t,this.relationshipType=r,this.operator=n,this.operands=o,this.isOptimized=i,this.groupId=ut()}return e.prototype.copy=function(t){var r=new e(this.model,this.field,this.relationshipType,this.operator,[]),n=t===this?r:void 0;return this.operands.forEach((function(e){var o=(0,i.__read)(e.copy(t),2),a=o[0],s=o[1];r.operands.push(a),n=n||s})),[r,n]},e.prototype.withFieldConditionsOnly=function(t){var r=this,n=t!==("not"===this.operator);return new e(this.model,void 0,void 0,t?at[this.operator]:this.operator,this.operands.filter((function(e){return e instanceof st})).map((function(e){return n?e.negated(r.model):e})))},e.prototype.optimized=function(t){var r=this;void 0===t&&(t=!0);var n=this.operands.map((function(t){return t instanceof e?t.optimized("not"===r.operator):t}));if(!t&&["and","or"].includes(this.operator)&&!this.field&&1===n.length){var o=n[0];if(!(o instanceof st))return o;if("between"!==o.operator)return o}return new e(this.model,this.field,this.relationshipType,this.operator,n,!0)},e.prototype.fetch=function(t,r,n){return void 0===r&&(r=[]),void 0===n&&(n=!1),(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l,d,f,h,p,v,y,g,m,_,b,w,S,E,x,I,P,A,C,O,k,N,M,R,D,j,F,L,U,q,W,G,B,K,z,V,Y,J,H,Q,$,Z,X,ee,re,ne,oe=this;return(0,i.__generator)(this,(function(ie){switch(ie.label){case 0:if(!this.isOptimized)return[2,this.optimized().fetch(t)];o=[],a=n?at[this.operator]:this.operator,s=n!==("not"===this.operator),u=this.operands.filter((function(t){return t instanceof e})),c=this.operands.filter((function(e){return e instanceof st})),ie.label=1;case 1:ie.trys.push([1,10,11,12]),l=(0,i.__values)(u),d=l.next(),ie.label=2;case 2:return d.done?[3,9]:[4,(f=d.value).fetch(t,(0,i.__spread)(r,[this.groupId]),s)];case 3:if(0===(h=ie.sent()).length)return"and"===a?[2,[]]:(o.push([]),[3,8]);if(!f.field)return[3,7];if(!(p=te.from(this.model,f.field)))return[3,5];v=[];try{for(V=void 0,y=(0,i.__values)(h),g=y.next();!g.done;g=y.next()){for(m=g.value,_=[],b=0;b<p.localJoinFields.length;b++)_.push(((J={})[p.localJoinFields[b]]={eq:m[p.remoteJoinFields[b]]},J));v.push({and:_})}}catch(e){V={error:e}}finally{try{g&&!g.done&&(Y=y.return)&&Y.call(y)}finally{if(V)throw V.error}}return x=T.nh.createFromAST(this.model.schema,{or:v}),S=(w=o).push,[4,t.query(this.model.builder,x)];case 4:return S.apply(w,[ie.sent()]),[3,6];case 5:throw new Error("Missing field metadata.");case 6:return[3,8];case 7:o.push(h),ie.label=8;case 8:return d=l.next(),[3,2];case 9:return[3,12];case 10:return E=ie.sent(),K={error:E},[3,12];case 11:try{d&&!d.done&&(z=l.return)&&z.call(l)}finally{if(K)throw K.error}return[7];case 12:return c.length>0?(x=this.withFieldConditionsOnly(s).toStoragePredicate(),P=(I=o).push,[4,t.query(this.model.builder,x)]):[3,14];case 13:return P.apply(I,[ie.sent()]),[3,16];case 14:return 0!==c.length||0!==o.length?[3,16]:(C=(A=o).push,[4,t.query(this.model.builder)]);case 15:C.apply(A,[ie.sent()]),ie.label=16;case 16:if(O=function(e){return JSON.stringify(oe.model.pkField.map((function(t){return e[t]})))},"and"===a){if(0===o.length)return[2,[]];try{for(N=(0,i.__values)(o),M=N.next();!M.done;M=N.next())if(q=M.value,void 0===k)k=new Map(q.map((function(e){return[O(e),e]})));else{R=new Map(q.map((function(e){return[O(e),e]})));try{for($=void 0,D=(0,i.__values)(k.keys()),j=D.next();!j.done;j=D.next())F=j.value,R.has(F)||k.delete(F)}catch(e){$={error:e}}finally{try{j&&!j.done&&(Z=D.return)&&Z.call(D)}finally{if($)throw $.error}}}}catch(e){H={error:e}}finally{try{M&&!M.done&&(Q=N.return)&&Q.call(N)}finally{if(H)throw H.error}}}else if("or"===a||"not"===a){k=new Map;try{for(L=(0,i.__values)(o),U=L.next();!U.done;U=L.next()){q=U.value;try{for(re=void 0,W=(0,i.__values)(q),G=W.next();!G.done;G=W.next())B=G.value,k.set(O(B),B)}catch(e){re={error:e}}finally{try{G&&!G.done&&(ne=W.return)&&ne.call(W)}finally{if(re)throw re.error}}}}catch(e){X={error:e}}finally{try{U&&!U.done&&(ee=L.return)&&ee.call(L)}finally{if(X)throw X.error}}}return[2,Array.from((null==k?void 0:k.values())||[])]}}))}))},e.prototype.matches=function(e,t){var r,n;return void 0===t&&(t=!1),(0,i.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,c,l;return(0,i.__generator)(this,(function(d){switch(d.label){case 0:return!this.field||t?[3,2]:[4,e[this.field]];case 1:return a=d.sent(),[3,3];case 2:a=e,d.label=3;case 3:if(!(o=a))return[2,!1];if("HAS_MANY"!==this.relationshipType||"function"!=typeof o[Symbol.asyncIterator])return[3,17];d.label=4;case 4:d.trys.push([4,10,11,16]),s=(0,i.__asyncValues)(o),d.label=5;case 5:return[4,s.next()];case 6:return(u=d.sent()).done?[3,9]:(c=u.value,[4,this.matches(c,!0)]);case 7:if(d.sent())return[2,!0];d.label=8;case 8:return[3,5];case 9:return[3,16];case 10:return l=d.sent(),r={error:l},[3,16];case 11:return d.trys.push([11,,14,15]),u&&!u.done&&(n=s.return)?[4,n.call(s)]:[3,13];case 12:d.sent(),d.label=13;case 13:return[3,15];case 14:if(r)throw r.error;return[7];case 15:return[7];case 16:return[2,!1];case 17:return"or"!==this.operator?[3,18]:[2,(0,D.rm)(this.operands,(function(e){return e.matches(o)}))];case 18:return"and"!==this.operator?[3,19]:[2,(0,D.Eu)(this.operands,(function(e){return e.matches(o)}))];case 19:if("not"!==this.operator)return[3,21];if(1!==this.operands.length)throw new Error("Invalid arguments! `not()` accepts exactly one predicate expression.");return[4,this.operands[0].matches(o)];case 20:return[2,!d.sent()];case 21:throw new Error("Invalid group operator!")}}))}))},e.prototype.toAST=function(){var e;if(this.field)throw new Error("Nested type conditions are not supported!");return(e={})[this.operator]=this.operands.map((function(e){return e.toAST()})),e},e.prototype.toStoragePredicate=function(){return T.nh.createFromAST(this.model.schema,this.toAST())},e.prototype.toJSON=function(){return(0,i.__assign)((0,i.__assign)({},this),{model:this.model.schema.name})},e}();function lt(e,t,r,n,o){void 0===t&&(t=!0);var a=new ct(e,r,void 0,"and",[]),s=n&&o?n:a,u=n&&o?o:a,c={};ot(s,c);var l=function(){var r=(0,i.__read)(s.copy(u),2),n=r[0],o=r[1];return{query:n,newTail:o,newLink:lt(e,t,void 0,n,o)}};["and","or"].forEach((function(n){c[n]=function(o){var i=l(),a=i.query,s=i.newTail,u=o(lt(e,t));if(!Array.isArray(u))throw new Error("Invalid predicate. `"+n+"` groups must return an array of child conditions.");return null==s||s.operands.push(new ct(e,r,void 0,n,u.map((function(e){return it(e)})))),ot(a)}})),c.not=function(n){var o=l(),i=o.query,a=o.newTail;return null==a||a.operands.push(new ct(e,r,void 0,"not",[it(n(lt(e,t)))])),ot(i)};var d=function(r){Object.defineProperty(c,r,{enumerable:!0,get:function(){var n=e.schema.allFields[r];if(n.association){if(t){if("BELONGS_TO"===n.association.connectionType||"HAS_ONE"===n.association.connectionType||"HAS_MANY"===n.association.connectionType){var o=n.type.modelConstructor;if(!o)throw new Error("Related model metadata is missing. This is a bug! Please report it.");var a=(0,i.__read)(s.copy(u),2),c=a[0],d=a[1],f=new ct(o,r,n.association.connectionType,"and",[]);return d.operands.push(f),lt(o,t,void 0,c,f)}throw new Error("Related model definition doesn't have a typedef. This is a bug! Please report it.")}throw new Error("Predication on releated models is not supported in this context.")}return rt.reduce((function(e,t){var n;return(0,i.__assign)((0,i.__assign)({},e),((n={})[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=l(),i=o.query,a=o.newTail,s=e.map((function(e){return void 0===e?null:e}));return null==a||a.operands.push(new st(r,t,s)),ot(i)},n))}),{})}})};for(var f in e.schema.allFields)d(f);return c}function dt(e){return lt(e,!1)}(0,_.ht)(!0),(0,_.YT)();var ft,ht,pt,vt,yt,gt,mt=new c.C("DataStore"),_t=((0,D.fC)(Date.now()),(0,l.gy)().isNode),bt="schemaVersion",wt=new WeakMap,St=new WeakMap,Et=function(e){var t=wt.get(e);return t?ft.namespaces[t].models[e.name]:void 0},xt=function(e){return(0,D.Y_)(e)&&wt.has(e)},It=function(e){var t=wt.get(e);if(!t)throw new Error("Namespace Resolver for '"+e.name+"' not found! This is probably a bug in '@amplify-js/datastore'.");return t},Pt=function(e){if(!e)throw new Error("Missing modelConstructor");var t=Et(e);if(!t)throw new Error("Missing modelSchema");var r=(0,D.ng)(t);if(!r)throw new Error("Could not determine PK");return lt({builder:e,schema:t,pkField:r})};new WeakMap;!function(e){e.Detached="Detached",e.DataStore="DataStore",e.API="API"}(gt||(gt={}));var At=new WeakMap;function Tt(e,t){return Array.isArray(e)?e.map((function(e){return Tt(e,t)})):e&&At.set(e,t),e}var Ct=function(){if(void 0===ft){var e="Schema is not initialized. DataStore will not function as expected. This could happen if you have multiple versions of DataStore installed. Please see https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js/#check-for-duplicate-versions";throw mt.error(e),new Error(e)}},Ot=new WeakSet;function kt(e,t){return Ot.add(t),new e(t)}var Nt,Mt,Rt=new WeakMap;(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,i.__extends)(t,e)})(Promise),function(){function e(e){this.values=e}e.prototype[Symbol.asyncIterator]=function(){var e,t=this,r=0;return{next:function(){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e?[3,2]:[4,this.values];case 1:e=n.sent(),n.label=2;case 2:return r<e.length?(t={value:e[r],done:!1},r++,[2,t]):[2,{value:null,done:!0}]}}))}))}}},e.prototype.toArray=function(e){var t,r,n=(void 0===e?{}:e).max,o=void 0===n?Number.MAX_SAFE_INTEGER:n;return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,n,a,s,u,c;return(0,i.__generator)(this,(function(l){switch(l.label){case 0:e=[],n=0,l.label=1;case 1:l.trys.push([1,6,7,12]),a=(0,i.__asyncValues)(this),l.label=2;case 2:return[4,a.next()];case 3:if((s=l.sent()).done)return[3,5];if(u=s.value,!(n<o))return[3,5];e.push(u),n++,l.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=l.sent(),t={error:c},[3,12];case 7:return l.trys.push([7,,10,11]),s&&!s.done&&(r=a.return)?[4,r.call(a)]:[3,9];case 8:l.sent(),l.label=9;case 9:return[3,11];case 10:if(t)throw t.error;return[7];case 11:return[7];case 12:return[2,e]}}))}))}}();function Dt(e){return"string"==typeof e}function jt(e){var t=e.localModel,r=e.modelConstructor,n=e.remoteModel._version;return kt(r,(0,i.__assign)((0,i.__assign)({},t),{_version:n}))}function Ft(e){mt.warn(e)}function Lt(e,t){var r;switch(e){case D.SL:r=vt[t];break;case D.m3:r=pt[t];break;case D.a9:r=ht[t];break;case D.O3:r=yt[t];break;default:throw new Error("Invalid namespace: "+e)}if(xt(r))return r;var n="Model name is not valid for namespace. modelName: "+t+", namespace: "+e;throw mt.error(n),new Error(n)}function Ut(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var r,n,o=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return r=vt.Setting,n=ft.namespaces[D.SL].models.Setting,[4,e.runExclusive((function(e){return(0,i.__awaiter)(o,void 0,void 0,(function(){var o,a;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return[4,e.query(r,T.nh.createFromAST(n,{and:{key:{eq:bt}}}),{page:0,limit:1})];case 1:return o=i.__read.apply(void 0,[s.sent(),1]),void 0===(a=o[0])||void 0===a.value?[3,4]:JSON.parse(a.value)===t?[3,3]:[4,e.clear(!1)];case 2:s.sent(),s.label=3;case 3:return[3,6];case 4:return[4,e.save(kt(r,{key:bt,value:JSON.stringify(t)}))];case 5:s.sent(),s.label=6;case 6:return[2]}}))}))}))];case 1:return a.sent(),[2]}}))}))}!function(e){e.NotRunning="Not Running",e.Starting="Starting",e.Running="Running",e.Stopping="Stopping",e.Clearing="Clearing"}(Mt||(Mt={}));var qt=function(){function e(){var e=this;this.Auth=s.N,this.InternalAPI=a.G,this.Cache=u.Y,this.amplifyConfig={},this.syncPredicates=new WeakMap,this.amplifyContext={Auth:this.Auth,InternalAPI:this.InternalAPI,Cache:this.Cache},this.runningProcesses=new v,this.state=Mt.NotRunning,this.start=function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(t){return[2,this.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,t,r,n=this;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return this.state=Mt.Starting,void 0!==this.initialized?[3,1]:(mt.debug("Starting DataStore"),this.initialized=new Promise((function(e,t){n.initResolve=e,n.initReject=t})),[3,3]);case 1:return[4,this.initialized];case 2:return o.sent(),[2];case 3:return this.storage=new _e(ft,It,Lt,kt,this.storageAdapter,this.sessionId),[4,this.storage.init()];case 4:return o.sent(),Ct(),[4,Ut(this.storage,ft.version)];case 5:return o.sent(),(e=this.amplifyConfig.aws_appsync_graphqlEndpoint)?(mt.debug("GraphQL endpoint available",e),t=this,[4,this.processSyncExpressions()]):[3,7];case 6:return t.syncPredicates=o.sent(),this.sync=new tt(ft,It,ht,pt,this.storage,kt,this.conflictHandler,this.errorHandler,this.syncPredicates,this.amplifyConfig,this.authModeStrategy,this.amplifyContext,this.connectivityMonitor),r=1e3*this.fullSyncInterval*60,Nt=this.sync.start({fullSyncInterval:r}).subscribe({next:function(e){var t=e.type,r=e.data;t===(_t?Ve.SYNC_ENGINE_SYNC_QUERIES_READY:Ve.SYNC_ENGINE_STORAGE_SUBSCRIBED)&&n.initResolve(),g.Y.dispatch("datastore",{event:t,data:r})},error:function(e){mt.warn("Sync error",e),n.initReject()}}),[3,8];case 7:mt.warn("Data won't be synchronized. No GraphQL endpoint configured. Did you forget `Amplify.configure(awsconfig)`?",{config:this.amplifyConfig}),this.initResolve(),o.label=8;case 8:return[4,this.initialized];case 9:return o.sent(),this.state=Mt.Running,[2]}}))}))}),"datastore start").catch(this.handleAddProcError("DataStore.start()"))]}))}))},this.query=function(t,r,n){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(o){return[2,this.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,o,a,s,u,c,l,d,f;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.start()];case 1:if(i.sent(),!this.storage)throw new Error("No storage to query");if(!xt(t))throw u="Constructor is not for a valid model",mt.error(u,{modelConstructor:t}),new Error(u);if("string"==typeof r&&void 0!==n&&mt.warn("Pagination is ignored when querying by id"),!(o=Et(t)))throw new Error("Invalid model definition provided!");if(a=this.processPagination(o,n),s=(0,D.ng)(o),!Dt(r))return[3,3];if(s.length>1)throw u=D.xc.queryByPkWithCompositeKeyPresent,mt.error(u,{keyFields:s}),new Error(u);return l=T.nh.createFromFlatEqualities(o,((d={})[s[0]]=r,d)),[4,this.storage.query(t,l,a)];case 2:return e=i.sent(),[3,9];case 3:return(0,E.DV)(r,o)?(l=T.nh.createForPk(o,r),[4,this.storage.query(t,l,a)]):[3,5];case 4:return e=i.sent(),[3,9];case 5:return r&&!(0,T.om)(r)?[3,7]:[4,null===(f=this.storage)||void 0===f?void 0:f.query(t,void 0,a)];case 6:return e=i.sent(),[3,9];case 7:return c=lt({builder:t,schema:o,pkField:(0,D.ng)(o)}),[4,(l=it(r(c))).fetch(this.storage)];case 8:e=i.sent(),e=(0,D.Jk)(e,a),i.label=9;case 9:return[2,Tt(Dt(r)||(0,E.DV)(r,o)?e[0]:e,gt.DataStore)]}}))}))}),"datastore query").catch(this.handleAddProcError("DataStore.query()"))]}))}))},this.save=function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(n){return[2,this.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n,o,a,s,u,c,l,d,f=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:return[4,this.start()];case 1:if(h.sent(),!this.storage)throw new Error("No storage to save to");if(e=St.get(t),n=Rt.has(t)?[Rt.get(t),{}]:void 0,o=e||n,a=t?t.constructor:void 0,!xt(a))throw s="Object is not an instance of a valid model",mt.error(s,{model:t}),new Error(s);if(!(u=Et(a)))throw new Error("Model Definition could not be found for model");return c={builder:a,schema:u,pkField:(0,D.ng)(u)},[4,this.storage.runExclusive((function(e){return(0,i.__awaiter)(f,void 0,void 0,(function(){var r,n,o,a,s,l,d,f,h;return(0,i.__generator)(this,(function(p){switch(p.label){case 0:r=te.allFrom(c).filter((function(e){return"BELONGS_TO"===e.type})),p.label=1;case 1:p.trys.push([1,6,7,8]),n=(0,i.__values)(r),o=n.next(),p.label=2;case 2:return o.done?[3,5]:(a=o.value,null===(s=a.createRemoteQueryObject(t))?[3,4]:[4,e.query(a.remoteModelConstructor,T.nh.createFromFlatEqualities(a.remoteDefinition,s))]);case 3:if(0===p.sent().length)throw new Error(["Data integrity error. You tried to save a "+u.name+" ("+JSON.stringify(t)+")",'but the instance assigned to the "'+a.field+'" property',"does not exist in the local database. If you're trying to create the related",'"'+(null===(h=a.remoteDefinition)||void 0===h?void 0:h.name)+'", you must save it independently first.'].join(" "));p.label=4;case 4:return o=n.next(),[3,2];case 5:return[3,8];case 6:return l=p.sent(),d={error:l},[3,8];case 7:try{o&&!o.done&&(f=n.return)&&f.call(n)}finally{if(d)throw d.error}return[7];case 8:return[2]}}))}))}))];case 2:return h.sent(),l=r?it(r(dt(c))).toStoragePredicate():void 0,[4,this.storage.runExclusive((function(e){return(0,i.__awaiter)(f,void 0,void 0,(function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.save(t,l,void 0,o)];case 1:return r.sent(),[2,e.query(a,T.nh.createForPk(u,t))]}}))}))}))];case 3:return d=i.__read.apply(void 0,[h.sent(),1]),[2,Tt(d[0],gt.DataStore)]}}))}))}),"datastore save").catch(this.handleAddProcError("DataStore.save()"))]}))}))},this.setConflictHandler=function(t){var r=t.DataStore;return r&&r.conflictHandler?r.conflictHandler:e.conflictHandler===jt&&t.conflictHandler?t.conflictHandler:e.conflictHandler||jt},this.setErrorHandler=function(t){var r=t.DataStore;return r&&r.errorHandler?r.errorHandler:e.errorHandler===Ft&&t.errorHandler?t.errorHandler:e.errorHandler||Ft},this.delete=function(t,r){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(n){return[2,this.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n,o,a,s,u,c,l,d,f,h;return(0,i.__generator)(this,(function(p){switch(p.label){case 0:return[4,this.start()];case 1:if(p.sent(),!this.storage)throw new Error("No storage to delete from");if(!t)throw l="Model or Model Constructor required",mt.error(l,{modelOrConstructor:t}),new Error(l);if(!xt(t))return[3,3];if(s=t,!r)throw l="Id to delete or criteria required. Do you want to delete all? Pass Predicates.ALL",mt.error(l,{identifierOrCriteria:r}),new Error(l);if(!(u=Et(s)))throw new Error("Could not find model definition for modelConstructor.");if("string"==typeof r){if((n=(0,D.ng)(u)).length>1)throw l=D.xc.deleteByPkWithCompositeKeyPresent,mt.error(l,{keyFields:n}),new Error(l);e=T.nh.createFromFlatEqualities(u,((h={})[n[0]]=r,h))}else if(!(e=(0,E.DV)(r,u)?T.nh.createForPk(u,r):it(r(dt({builder:s,schema:u,pkField:(0,D.ng)(u)}))).toStoragePredicate())||!T.nh.isValidPredicate(e))throw l="Criteria required. Do you want to delete all? Pass Predicates.ALL",mt.error(l,{condition:e}),new Error(l);return[4,this.storage.delete(s,e)];case 2:return o=i.__read.apply(void 0,[p.sent(),1]),[2,Tt(o[0],gt.DataStore)];case 3:if(a=t,s=Object.getPrototypeOf(a||{}).constructor,!xt(s))throw l="Object is not an instance of a valid model",mt.error(l,{model:a}),new Error(l);if(!(u=Et(s)))throw new Error("Could not find model definition for modelConstructor.");if(c=T.nh.createForPk(u,a),r){if("function"!=typeof r)throw l="Invalid criteria",mt.error(l,{identifierOrCriteria:r}),new Error(l);e=it(r(dt({builder:s,schema:u,pkField:(0,D.ng)(u)}))).toStoragePredicate()}else e=c;return[4,this.storage.delete(a,e)];case 4:return d=i.__read.apply(void 0,[p.sent(),1]),f=(0,i.__read)(d[0],1),[2,Tt(f[0],gt.DataStore)]}}))}))}),"datastore delete").catch(this.handleAddProcError("DataStore.delete()"))]}))}))},this.observe=function(t,r){var n,o=t&&xt(t)?t:void 0;if(t&&void 0===o){var a=t,s=a&&Object.getPrototypeOf(a).constructor;if(xt(s))return r&&mt.warn("idOrCriteria is ignored when using a model instance",{model:a,identifierOrCriteria:r}),e.observe(s,a.id);var u="The model is not an instance of a PersistentModelConstructor";throw mt.error(u,{model:a}),new Error(u)}if(r&&o&&(0,E.DV)(r,Et(o))){u=D.xc.observeWithObjectLiteral;throw mt.error(u,{objectLiteral:r}),new Error(u)}if(void 0!==r&&void 0===o){u="Cannot provide criteria without a modelConstructor";throw mt.error(u,r),new Error(u)}if(o&&!xt(o)){u="Constructor is not for a valid model";throw mt.error(u,{modelConstructor:o}),new Error(u)}if(o&&"string"==typeof r){n=it(function(e){return e.id.eq(r)}(Pt(o)))}else o&&"function"==typeof r&&(n=it(r(Pt(o))));return new w((function(t){var r;return e.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e=this;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.start()];case 1:return a.sent(),r=this.storage.observe(o).filter((function(e){var t=e.model;return It(t)===D.m3})).subscribe({next:function(r){return e.runningProcesses.isOpen&&e.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,o,a,s,u,c;return(0,i.__generator)(this,(function(l){switch(l.label){case 0:return e=r,"DELETE"===r.opType?[3,2]:(o=Et(r.model),a=(0,D.ng)(o),s=(0,D.tf)(r.element,a),[4,this.query(r.model,s)]);case 1:u=l.sent(),e=(0,i.__assign)((0,i.__assign)({},e),{element:u}),l.label=2;case 2:return(c=!n)?[3,4]:[4,n.matches(e.element)];case 3:c=l.sent(),l.label=4;case 4:return c&&t.next(e),[2]}}))}))}),"datastore observe message handler")},error:function(e){return t.error(e)},complete:function(){return t.complete()}}),[2]}}))}))}),"datastore observe observable initialization").catch(e.handleAddProcError("DataStore.observe()")).catch((function(e){t.error(e)})),e.runningProcesses.addCleaner((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return r&&r.unsubscribe(),[2]}))}))}),"DataStore.observe() cleanup")}))},this.observeQuery=function(t,r,n){return new w((function(o){var a,s,u=new Map,c=new Map,l=[],d=function(){var e=v();y(e)},f=new D.Xi({callback:d,errorHandler:o.error,maxInterval:2e3}),h=(n||{}).sort,p=h?{sort:h}:void 0;if(!Et(t))throw new Error("Could not find model definition.");t&&"function"==typeof r?s=it(r(Pt(t))):(0,T.om)(r)&&(s=void 0),e.runningProcesses.add((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){var e,n=this;return(0,i.__generator)(this,(function(h){switch(h.label){case 0:return h.trys.push([0,2,,3]),[4,this.query(t,r,p)];case 1:return h.sent().forEach((function(e){var r=X(Et(t),e);u.set(r,e)})),a=this.observe(t).subscribe((function(e){var t=e.element,r=e.model,o=e.opType;return n.runningProcesses.isOpen&&n.runningProcesses.add((function(){return(0,i.__awaiter)(n,void 0,void 0,(function(){var e,n,a,d,h,p;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=Et(r),n=X(e,t),(a=s)?[4,s.matches(t)]:[3,2];case 1:a=!i.sent(),i.label=2;case 2:if(a){if("UPDATE"!==o||!u.has(n)&&!c.has(n))return[2];l.push(n)}return"DELETE"===o?l.push(n):c.set(n,t),d=null!==(p=null===(h=this.sync)||void 0===h?void 0:h.getModelSyncedStatus(r))&&void 0!==p&&p,(c.size-l.length>=this.syncPageSize||d)&&f.resolve(),f.start(),[2]}}))}))}),"handle observeQuery observed event")})),d(),[3,3];case 2:return e=h.sent(),o.error(e),[3,3];case 3:return[2]}}))}))}),"datastore observequery startup").catch(e.handleAddProcError("DataStore.observeQuery()")).catch((function(e){o.error(e)}));var v=function(){var r,o,a=null!==(o=null===(r=e.sync)||void 0===r?void 0:r.getModelSyncedStatus(t))&&void 0!==o&&o,s=(0,i.__spread)(Array.from(u.values()),Array.from(c.values()));u.clear(),s.forEach((function(e){var r=X(Et(t),e);u.set(r,e)})),l.forEach((function(e){return u.delete(e)}));var d=Array.from(u.values());return(null==n?void 0:n.sort)&&m(d),{items:d,isSynced:a}},y=function(e){o.next(e),c.clear(),l=[]},m=function(r){var o=Et(t),i=e.processPagination(o,n),a=C.V.getPredicates(i.sort);if(a.length){var s=(0,D.Cc)(a);r.sort(s)}},_=function(e){var r,n=e.payload,o=n.event,i=n.data;o===Ve.SYNC_ENGINE_MODEL_SYNCED&&(null===(r=null==i?void 0:i.model)||void 0===r?void 0:r.name)===t.name&&(d(),g.Y.remove("datastore",_))};return g.Y.listen("datastore",_),e.runningProcesses.addCleaner((function(){return(0,i.__awaiter)(e,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return a&&a.unsubscribe(),[2]}))}))}),"datastore observequery cleaner")}))},this.configure=function(t){void 0===t&&(t={}),e.amplifyContext.Auth=e.Auth,e.amplifyContext.InternalAPI=e.InternalAPI,e.amplifyContext.Cache=e.Cache;var r=t.DataStore,n=t.authModeStrategyType,o=(t.conflictHandler,t.errorHandler,t.maxRecordsToSync),a=t.syncPageSize,s=t.fullSyncInterval,u=t.syncExpressions,c=t.authProviders,l=t.storageAdapter,d=(0,i.__rest)(t,["DataStore","authModeStrategyType","conflictHandler","errorHandler","maxRecordsToSync","syncPageSize","fullSyncInterval","syncExpressions","authProviders","storageAdapter"]);switch(e.amplifyConfig=(0,i.__assign)((0,i.__assign)({},d),e.amplifyConfig),e.conflictHandler=e.setConflictHandler(t),e.errorHandler=e.setErrorHandler(t),r&&r.authModeStrategyType||n||E.$V.DEFAULT){case E.$V.MULTI_AUTH:e.authModeStrategy=P(e.amplifyContext);break;case E.$V.DEFAULT:default:e.authModeStrategy=A}e.amplifyConfig.authProviders=r&&r.authProviders||c,e.syncExpressions=r&&r.syncExpressions||u||e.syncExpressions,e.maxRecordsToSync=r&&r.maxRecordsToSync||o||e.maxRecordsToSync||1e4,e.amplifyConfig.maxRecordsToSync=e.maxRecordsToSync,e.syncPageSize=r&&r.syncPageSize||a||e.syncPageSize||1e3,e.amplifyConfig.syncPageSize=e.syncPageSize,e.fullSyncInterval=r&&r.fullSyncInterval||s||e.fullSyncInterval||1440,e.storageAdapter=r&&r.storageAdapter||l||e.storageAdapter||void 0,e.sessionId=e.retrieveSessionId()}}return e.prototype.getModuleName=function(){return"DataStore"},e.prototype.handleAddProcError=function(e){var t=this;return function(r){throw r.message.startsWith("BackgroundManagerNotOpenError")?new Error(["DataStoreStateError: Tried to execute `"+e+'` while DataStore was "'+t.state+'".','This can only be done while DataStore is "Started" or "Stopped". To remedy:',"Ensure all calls to `stop()` and `clear()` have completed first.","If this is not possible, retry the operation until it succeeds."].join("\n")):r}},e.prototype.clear=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return Ct(),this.state=Mt.Clearing,[4,this.runningProcesses.close()];case 1:return e.sent(),void 0!==this.storage?[3,3]:(this.storage=new _e(ft,It,Lt,kt,this.storageAdapter,this.sessionId),[4,this.storage.init()]);case 2:e.sent(),e.label=3;case 3:return Nt&&!Nt.closed&&Nt.unsubscribe(),this.sync?[4,this.sync.stop()]:[3,5];case 4:e.sent(),e.label=5;case 5:return[4,this.storage.clear()];case 6:return e.sent(),this.initialized=void 0,this.storage=void 0,this.sync=void 0,this.syncPredicates=new WeakMap,[4,this.runningProcesses.open()];case 7:return e.sent(),this.state=Mt.NotRunning,[2]}}))}))},e.prototype.stop=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return this.state=Mt.Stopping,[4,this.runningProcesses.close()];case 1:return e.sent(),Nt&&!Nt.closed&&Nt.unsubscribe(),this.sync?[4,this.sync.stop()]:[3,3];case 2:e.sent(),e.label=3;case 3:return this.initialized=void 0,this.sync=void 0,[4,this.runningProcesses.open()];case 4:return e.sent(),this.state=Mt.NotRunning,[2]}}))}))},e.prototype.processPagination=function(e,t){var r,n=t||{},o=n.limit,i=n.page,a=n.sort;if(void 0!==o||void 0!==i||void 0!==a){if(void 0!==i&&void 0===o)throw new Error("Limit is required when requesting a page");if(void 0!==i){if("number"!=typeof i)throw new Error("Page should be a number");if(i<0)throw new Error("Page can't be negative")}if(void 0!==o){if("number"!=typeof o)throw new Error("Limit should be a number");if(o<0)throw new Error("Limit can't be negative")}return a&&(r=C.V.createFromExisting(e,a)),{limit:o,page:i,sort:r}}},e.prototype.processSyncExpressions=function(){return(0,i.__awaiter)(this,void 0,void 0,(function(){var e,t=this;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return this.syncExpressions&&this.syncExpressions.length?[4,Promise.all(this.syncExpressions.map((function(e){return(0,i.__awaiter)(t,void 0,void 0,(function(){var t,r,n,o,a,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,e];case 1:return t=i.sent(),r=t.modelConstructor,n=t.conditionProducer,o=Et(r),[4,this.unwrapPromise(n)];case 2:return a=i.sent(),(0,T.om)(a)?[2,[o,null]]:(s=it(a(dt({builder:r,schema:o,pkField:(0,D.ng)(o)}))).toStoragePredicate(),[2,[o,s]])}}))}))})))]:[2,new WeakMap];case 1:return e=r.sent(),[2,this.weakMapFromEntries(e)]}}))}))},e.prototype.unwrapPromise=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e()];case 1:return[2,r.sent()||e];case 2:if((t=r.sent())instanceof TypeError)return[2,e];throw t;case 3:return[2]}}))}))},e.prototype.weakMapFromEntries=function(e){return e.reduce((function(e,t){var r=(0,i.__read)(t,2),n=r[0],o=r[1];if(e.has(n)){var a=n.name;return mt.warn("You can only utilize one Sync Expression per model.\n          Subsequent sync expressions for the "+a+" model will be ignored."),e}return o&&e.set(n,o),e}),new WeakMap)},e.prototype.retrieveSessionId=function(){try{var e=sessionStorage.getItem("datastoreSessionId");if(e){var t=this.amplifyConfig.aws_appsync_graphqlEndpoint.split("/")[2];return e+"-"+(0,i.__read)(t.split("."),1)[0]}}catch(e){}},e}(),Wt=new qt;m.H.register(Wt)},39820:(e,t,r)=>{"use strict";r.d(t,{BV:()=>l,Qb:()=>u,nh:()=>d,om:()=>a});var n=r(15215),o=r(47681),i=new WeakSet;function a(e){return i.has(e)}var s=new Set(["and","or","not"]),u=new Set(["eq","ne","gt","lt","ge","le","contains","notContains","beginsWith","between"]),c=function(e){return Array.isArray(e)?e.every((function(e){return c(e)})):Object.keys(e).length<=1},l=(Symbol("A predicate that matches all records"),function(){function e(){}return Object.defineProperty(e,"ALL",{get:function(){var e=function(e){return e};return i.add(e),e},enumerable:!0,configurable:!0}),e}()),d=function(){function e(){}return e.isValidPredicate=function(t){return e.predicateGroupsMap.has(t)},e.getPredicates=function(t,r){if(void 0===r&&(r=!0),r&&!e.isValidPredicate(t))throw new Error("The predicate is not valid");return e.predicateGroupsMap.get(t)},e.createForPk=function(e,t){var r=(0,o.ng)(e),n=(0,o.jH)(t,r);return this.createFromAST(e,{and:r.map((function(e,t){var r,o=n[t];return(r={})[e]={eq:o},r}))})},e.createFromFlatEqualities=function(e,t){var r={and:Object.entries(t).map((function(e){var t,r=(0,n.__read)(e,2),o=r[0],i=r[1];return(t={})[o]={eq:i},t}))};return this.createFromAST(e,r)},e.transformGraphQLFilterNodeToPredicateAST=function(e){var t,r=this;if(!c(e))throw new Error("Invalid GraphQL Condition or subtree: "+JSON.stringify(e));if(t=e,Array.isArray(t)||0!==Object.keys(t).length){if(function(e){var t=(0,n.__spread)(Object.keys(e));return 1===t.length&&s.has(t[0])}(e)){var o=Object.keys(e)[0],i=this.transformGraphQLFilterNodeToPredicateAST(e[o]);return{type:o,predicates:Array.isArray(i)?i:[i]}}if(function(e){var t=(0,n.__spread)(Object.keys(e));return!Array.isArray(e)&&1===t.length&&u.has(t[0])}(e)){var a=Object.keys(e)[0];return{operator:a,operand:e[a]}}if(Array.isArray(e))return e.map((function(e){return r.transformGraphQLFilterNodeToPredicateAST(e)}));var l=Object.keys(e)[0];return(0,n.__assign)({field:l},this.transformGraphQLFilterNodeToPredicateAST(e[l]))}return{type:"and",predicates:[]}},e.createFromAST=function(t,r){var n={};return e.predicateGroupsMap.set(n,this.transformGraphQLFilterNodeToPredicateAST(r)),n},e.predicateGroupsMap=new WeakMap,e}()},80982:(e,t,r)=>{"use strict";r.d(t,{V:()=>n});var n=function(){function e(){}return e.createPredicateBuilder=function(t){var r=t.name,n=new Set(Object.keys(t.fields)),o=new Proxy({},{get:function(t,o,i){var a=o;if(!n.has(a))throw new Error("Invalid field for model. field: "+a+", model: "+r);return function(t){var r;return null===(r=e.sortPredicateGroupsMap.get(i))||void 0===r||r.push({field:a,sortDirection:t}),i}}});return e.sortPredicateGroupsMap.set(o,[]),o},e.isValidPredicate=function(t){return e.sortPredicateGroupsMap.has(t)},e.getPredicates=function(t,r){if(void 0===r&&(r=!0),r&&!e.isValidPredicate(t))throw new Error("The predicate is not valid");var n=e.sortPredicateGroupsMap.get(t);if(n)return n;throw new Error("Predicate group not found")},e.createFromExisting=function(t,r){if(r&&t)return r(e.createPredicateBuilder(t))},e.sortPredicateGroupsMap=new WeakMap,e}()},29640:(e,t,r)=>{"use strict";r.d(t,{$V:()=>c,$f:()=>O,Cr:()=>C,D$:()=>m,DV:()=>I,DW:()=>k,JW:()=>A,Jw:()=>n,Mz:()=>x,N2:()=>o,QC:()=>v,Qs:()=>g,UE:()=>u,UQ:()=>y,Vn:()=>l,Vo:()=>s,Yh:()=>b,f6:()=>P,gw:()=>S,i5:()=>a,iW:()=>T,ri:()=>E,rm:()=>p,vL:()=>d,yb:()=>w,zc:()=>_});var n,o,i,a,s,u,c,l,d,f=r(15215),h=r(47681);function p(e){return e&&void 0!==e.pluralName}function v(e){return p(e)&&void 0!==e.attributes}function y(e){return(null==e?void 0:e.targetName)||(null==e?void 0:e.targetNames)}function g(e,t){var r,n;return null===(n=null===(r=null==e?void 0:e.fields[t])||void 0===r?void 0:r.association)||void 0===n?void 0:n.connectionType}function m(e){return"key"===e.type&&e.properties&&e.properties.fields&&e.properties.fields.length>0}function _(e){return m(e)&&void 0===e.properties.name}function b(e){return m(e)&&void 0!==e.properties.name&&e.properties.fields.length>2}function w(e){return e&&void 0!==i[e]}function S(e){return!(!e||!e.model)}function E(e){return!(!e||!e.nonModel)}function x(e){return!(!e||!e.enum)}function I(e,t){var r=(0,h.ng)(t);return"object"==typeof e&&e&&r.every((function(t){return void 0!==e[t]}))}function P(e){return e&&void 0!==e.field}function A(e){return e&&void 0!==e.type}function T(e,t){return(0,f.__awaiter)(this,void 0,void 0,(function(){return(0,f.__generator)(this,(function(r){return[2,{modelConstructor:e,conditionProducer:t}]}))}))}!function(e){e.CUSTOM="custom",e.OWNER="owner",e.GROUPS="groups",e.PRIVATE="private",e.PUBLIC="public"}(n||(n={})),function(e){e.FUNCTION="function",e.USER_POOLS="userPools",e.OIDC="oidc",e.IAM="iam",e.API_KEY="apiKey"}(o||(o={})),function(e){e[e.ID=0]="ID",e[e.String=1]="String",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Boolean=4]="Boolean",e[e.AWSDate=5]="AWSDate",e[e.AWSTime=6]="AWSTime",e[e.AWSDateTime=7]="AWSDateTime",e[e.AWSTimestamp=8]="AWSTimestamp",e[e.AWSEmail=9]="AWSEmail",e[e.AWSJSON=10]="AWSJSON",e[e.AWSURL=11]="AWSURL",e[e.AWSPhone=12]="AWSPhone",e[e.AWSIPAddress=13]="AWSIPAddress"}(i||(i={})),function(e){e.getJSType=function(e){switch(e){case"Boolean":return"boolean";case"ID":case"String":case"AWSDate":case"AWSTime":case"AWSDateTime":case"AWSEmail":case"AWSURL":case"AWSPhone":case"AWSIPAddress":return"string";case"Int":case"Float":case"AWSTimestamp":return"number";case"AWSJSON":return"object";default:throw new Error("Invalid scalar type")}},e.getValidationFunction=function(e){switch(e){case"AWSDate":return h.YU;case"AWSTime":return h.Nb;case"AWSDateTime":return h.vM;case"AWSTimestamp":return h.m1;case"AWSEmail":return h.E8;case"AWSJSON":return h.ye;case"AWSURL":return h.RN;case"AWSPhone":return h.Y;case"AWSIPAddress":return h.hS;default:return}}}(i||(i={})),function(e){e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(a||(a={})),function(e){e[e.FIRST=0]="FIRST",e[e.LAST=1]="LAST"}(s||(s={})),function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"}(u||(u={})),function(e){e.DEFAULT="DEFAULT",e.MULTI_AUTH="MULTI_AUTH"}(c||(c={})),function(e){e.CREATE="CREATE",e.READ="READ",e.UPDATE="UPDATE",e.DELETE="DELETE"}(l||(l={})),function(e){e.sync="sync",e.mutate="mutate",e.subscribe="subscribe"}(d||(d={}));var C,O=Symbol("DISCARD");!function(e){e.LIMIT="LIMIT",e.TIMER="TIMER"}(C||(C={}));var k=function(){this.__isPredicateInternalsKeySentinel=!0}},47681:(e,t,r)=>{"use strict";r.d(t,{Bi:()=>f,Cc:()=>N,Db:()=>X,E8:()=>W,Eu:()=>j,ID:()=>d,JO:()=>ee,Jk:()=>R,KK:()=>te,MJ:()=>b,NX:()=>A,Nb:()=>L,O3:()=>m,RN:()=>B,SL:()=>v,Xi:()=>Y,Y:()=>K,Y6:()=>h,YU:()=>F,Y_:()=>S,ZP:()=>J,a9:()=>g,bf:()=>ne,fC:()=>O,hS:()=>z,hY:()=>k,jH:()=>$,lu:()=>M,m1:()=>q,m3:()=>y,ng:()=>Q,q8:()=>P,rm:()=>D,t7:()=>re,tf:()=>Z,vM:()=>U,xc:()=>p,ye:()=>G,yq:()=>T});var n,o=r(15215),i=r(48287),a=r(6163),s=r(78336),u=r(29640),c=r(16807),l=r(80982),d="id",f="#",h="-",p={idEmptyString:"An index field cannot contain an empty string value",queryByPkWithCompositeKeyPresent:"Models with composite primary keys cannot be queried by a single key value. Use object literal syntax for composite keys instead: https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/#querying-records-with-custom-primary-keys",deleteByPkWithCompositeKeyPresent:"Models with composite primary keys cannot be deleted by a single key value, unless using a predicate. Use object literal syntax for composite keys instead: https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/#querying-records-with-custom-primary-keys",observeWithObjectLiteral:"Object literal syntax cannot be used with observe. Use a predicate instead: https://docs.amplify.aws/lib/datastore/data-access/q/platform/js/#predicates"};!function(e){e.DATASTORE="datastore",e.USER="user",e.SYNC="sync",e.STORAGE="storage"}(n||(n={}));var v=n.DATASTORE,y=n.USER,g=n.SYNC,m=n.STORAGE,_=function(e){return void 0===e||null==e},b=function(e,t,r){var n,o=!1;if(0===r.length)return!0;switch(t){case"not":n="every",o=!0;break;case"and":n="every";break;case"or":n="some";break;default:throw new Error("Invalid "+t)}var i=r[n]((function(t){if((0,u.f6)(t)){var r=t.field,n=t.operator,o=t.operand,i=e[r];return w(i,n,o)}if((0,u.JW)(t)){var a=t.type,s=t.predicates;return b(e,a,s)}throw new Error("Not a predicate or group")}));return o?!i:i},w=function(e,t,r){switch(t){case"ne":return e!==r;case"eq":return e===r;case"le":return e<=r;case"lt":return e<r;case"ge":return e>=r;case"gt":return e>r;case"between":var n=(0,o.__read)(r,2),i=n[0],a=n[1];return e>=i&&e<=a;case"beginsWith":return!_(e)&&e.startsWith(r);case"contains":return!_(e)&&e.indexOf(r)>-1;case"notContains":return _(e)||-1===e.indexOf(r);default:return!1}},S=function(e){return e&&"function"==typeof e.copyOf};new WeakSet;var E,x,I=new WeakMap,P=function(e,t,r,n,o){var i=[],a=o(r.name,e).copyOf(t,(function(){}));i.unshift({modelName:e,item:a,instance:a}),I.has(r)||I.set(r,Array.from(r.modelTopologicalOrdering.keys()));var s=I.get(r);return i.sort((function(e,t){return s.indexOf(e.modelName)-s.indexOf(t.modelName)})),i},A=function(){return new Promise((function(e){var t,r=(0,s.v4)(),n=function(){E=!1,e(!0)},i=function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return t&&t.result&&"function"==typeof t.result.close?[4,t.result.close()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,indexedDB.deleteDatabase(r)];case 3:return n.sent(),E=!0,[2,e(!1)]}}))}))};return!0===E?i():!1===E||null===indexedDB?n():((t=indexedDB.open(r)).onerror=n,void(t.onsuccess=i))}))},T=function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){var e,t,r,n,i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),e=(0,s.v4)(),t="indexedDBFeatureProbeStore",r="idx",null===indexedDB?[2,!1]:void 0!==x?[2,x]:[4,new Promise((function(n){var o=indexedDB.open(e);o.onerror=function(){return n(!1)},o.onsuccess=function(){var e=o.result;n(e)},o.onupgradeneeded=function(e){var o,i=null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.result;i.onerror=function(){return n(!1)},i.createObjectStore(t,{autoIncrement:!0}).createIndex(r,["id"])}}))];case 1:if(!(n=o.sent()))throw new Error("Could not open probe DB");return i=n.transaction(t,"readwrite"),i.objectStore(t).add({id:1}),i.commit(),[4,new Promise((function(e){var o=n.transaction(t,"readonly").objectStore(t).index(r).get([1]);o.onerror=function(){return e(!1)},o.onsuccess=function(t){var r;e(null===(r=null==t?void 0:t.target)||void 0===r?void 0:r.result)}}))];case 2:return a=o.sent(),n&&"function"==typeof n.close?[4,n.close()]:[3,4];case 3:o.sent(),o.label=4;case 4:return[4,indexedDB.deleteDatabase(e)];case 5:return o.sent(),x=void 0===a,[3,7];case 6:return o.sent(),x=!1,[3,7];case 7:return[2,x]}}))}))},C=function(){return(e=1,i.Buffer.from((new c.id).random(e).toString(),"hex")).readUInt8(0)/255;var e};function O(e){var t=(0,a.BD)(C);return function(){return t(e)}}function k(){return"undefined"!=typeof performance&&performance&&"function"==typeof performance.now?0|performance.now():Date.now()}function N(e){return function(t,r){var n,i;try{for(var a=(0,o.__values)(e),s=a.next();!s.done;s=a.next()){var c=s.value,l=c.field,d=c.sortDirection===u.UE.ASCENDING?1:-1;if(t[l]<r[l])return-1*d;if(t[l]>r[l])return 1*d}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return 0}}function M(e,t,r){var n,i;void 0===r&&(r=!1);var a,s,u=e,c=t;if(u instanceof Object&&!(c instanceof Object)||!(u instanceof Object)&&c instanceof Object)return!1;if(!(u instanceof Object))return!(!r||(a=u,s=c,null!=a||null!=s))||u===c;if(Array.isArray(u)&&!Array.isArray(c)||Array.isArray(c)&&!Array.isArray(u))return!1;u instanceof Set&&c instanceof Set&&(u=(0,o.__spread)(u),c=(0,o.__spread)(c)),u instanceof Map&&c instanceof Map&&(u=Object.fromEntries(u),c=Object.fromEntries(c));var l=Object.keys(u),d=Object.keys(c);if(l.length!==d.length&&(!r||Array.isArray(u)))return!1;var f=l.length>=d.length?l:d;try{for(var h=(0,o.__values)(f),p=h.next();!p.done;p=h.next()){var v=p.value;if(!M(u[v],c[v],r))return!1}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return!0}function R(e,t){if(t&&e.length>1){if(t.sort){var r=l.V.getPredicates(t.sort);if(r.length){var n=N(r);e.sort(n)}}var o=t.page,i=void 0===o?0:o,a=t.limit,s=void 0===a?0:a,u=Math.max(0,i*s)||0,c=s>0?u+s:e.length;return e.slice(u,c)}return e}function D(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,s,u;return(0,o.__generator)(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,7]),r=(0,o.__values)(e),n=r.next(),c.label=1;case 1:return n.done?[3,4]:(i=n.value,[4,t(i)]);case 2:if(c.sent())return[2,!0];c.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return a=c.sent(),s={error:a},[3,7];case 6:try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 7:return[2,!1]}}))}))}function j(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,s,u;return(0,o.__generator)(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,7]),r=(0,o.__values)(e),n=r.next(),c.label=1;case 1:return n.done?[3,4]:(i=n.value,[4,t(i)]);case 2:if(!c.sent())return[2,!1];c.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return a=c.sent(),s={error:a},[3,7];case 6:try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 7:return[2,!0]}}))}))}var F=function(e){return!!/^\d{4}-\d{2}-\d{2}(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},L=function(e){return!!/^\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},U=function(e){return!!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2}(.\d+)?)?(Z|[+-]\d{2}:\d{2}($|:\d{2}))?$/.exec(e)},q=function(e){return!!/^\d+$/.exec(String(e))},W=function(e){return!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.exec(e)},G=function(e){try{return JSON.parse(e),!0}catch(e){return!1}},B=function(e){try{return!!new URL(e)}catch(e){return!1}},K=function(e){return!!/^\+?\d[\d\s-]+$/.exec(e)},z=function(e){return!!/((^((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))$)|(^((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?$))$/.exec(e)},V=function(){var e=this;this.promise=new Promise((function(t,r){e.resolve=t,e.reject=r}))},Y=function(){function e(e){this.limitPromise=new V,this.raceInFlight=!1,this.callback=function(){},this.defaultErrorHandler=function(e){throw void 0===e&&(e="DeferredCallbackResolver error"),new Error(e)},this.callback=e.callback,this.errorHandler=e.errorHandler||this.defaultErrorHandler,this.maxInterval=e.maxInterval||2e3}return e.prototype.startTimer=function(){var e=this;this.timerPromise=new Promise((function(t,r){e.timer=setTimeout((function(){t(u.Cr.TIMER)}),e.maxInterval)}))},e.prototype.racePromises=function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,3,4]),this.raceInFlight=!0,this.startTimer(),[4,Promise.race([this.timerPromise,this.limitPromise.promise])];case 1:return e=r.sent(),this.callback(),[3,4];case 2:return t=r.sent(),this.errorHandler(t),[3,4];case 3:return this.clear(),this.raceInFlight=!1,this.limitPromise=new V,[2,e];case 4:return[2]}}))}))},e.prototype.start=function(){this.raceInFlight||this.racePromises()},e.prototype.clear=function(){clearTimeout(this.timer)},e.prototype.resolve=function(){this.limitPromise.resolve(u.Cr.LIMIT)},e}();var J=function(e,t){return e+"_"+t},H=function(e){var t;return null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t.find(u.D$)},Q=function(e){var t=H(e);return t&&(0,u.zc)(t)?t.properties.fields:[d]},$=function(e,t){return t.map((function(t){return e[t]}))},Z=function(e,t){var r={};return t.forEach((function(t){return r[t]=e[t]})),r},X=function(e){var t={},r={};return Object.keys(e.models).forEach((function(n){var i,a;t[n]={indexes:[],relationTypes:[]},r[n]={};var s,c,l,f=e.models[n];if(Object.keys(f.fields).forEach((function(e){var r=f.fields[e];if("object"==typeof r.type&&"model"in r.type){var i=r.association.connectionType;if(t[n].relationTypes.push({fieldName:r.name,modelName:r.type.model,relationType:i,targetName:r.association.targetName,targetNames:r.association.targetNames,associatedWith:r.association.associatedWith}),"BELONGS_TO"===i){var a=ee(r.association);if(a){var s=te(a),u=t[n].indexes.find((function(e){return(0,o.__read)(e,1)[0]===s}));u||t[n].indexes.push([s,a])}}}})),f.attributes){r[n].compositeKeys=(s=f.attributes,l=(c=function(e){return e.reduce((function(e,t){var r=new Set(t);if(0===e.length)return e.push(r),e;var n=e.findIndex((function(e){return(0,o.__spread)(e).some((function(e){return r.has(e)}))}));if(n>-1){var i=new Set((0,o.__spread)(e[n],r));e[n]=i}else e.push(r);return e}),[])})(s.filter(u.Yh).map((function(e){return(0,o.__read)(e.properties.fields).slice(1)}))),c(l));var h=function(e){if(!(0,u.D$)(e))return"continue";var i=e.properties.fields;if((0,u.zc)(e))return r[n].primaryKey=i,"continue";var a=te(i),s=t[n].indexes.find((function(e){return(0,o.__read)(e,1)[0]===a}));s||t[n].indexes.push([a,i])};try{for(var p=(0,o.__values)(f.attributes),v=p.next();!v.done;v=p.next()){h(v.value)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}}r[n].primaryKey||(r[n].primaryKey=[d]),t[n].indexes.push(["byPk",r[n].primaryKey,{unique:!0}])})),[t,r]},ee=function(e){var t=null==e?void 0:e.targetName,r=null==e?void 0:e.targetNames;return Array.isArray(r)?r:"string"==typeof t?[t]:void 0},te=function(e){return e.reduce((function(e,t,r){return 0===r?t:""+e+h+t}),"")},re=function(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))},ne=function(e,t){var r,n,o=null===(n=null===(r=null==e?void 0:e.keys)||void 0===r?void 0:r[t])||void 0===n?void 0:n.primaryKey;return o||[d]}},78336:(e,t,r)=>{var n=r(60031),o=r(16564),i=o;i.v1=n,i.v4=o,e.exports=i},26041:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,o=t;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},49024:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},60031:(e,t,r)=>{var n,o,i=r(49024),a=r(26041),s=0,u=0;e.exports=function(e,t,r){var c=t&&r||0,l=t||[],d=(e=e||{}).node||n,f=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==f){var h=i();null==d&&(d=n=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=o=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),v=void 0!==e.nsecs?e.nsecs:u+1,y=p-s+(v-u)/1e4;if(y<0&&void 0===e.clockseq&&(f=f+1&16383),(y<0||p>s)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=p,u=v,o=f;var g=(1e4*(268435455&(p+=122192928e5))+v)%4294967296;l[c++]=g>>>24&255,l[c++]=g>>>16&255,l[c++]=g>>>8&255,l[c++]=255&g;var m=p/4294967296*1e4&268435455;l[c++]=m>>>8&255,l[c++]=255&m,l[c++]=m>>>24&15|16,l[c++]=m>>>16&255,l[c++]=f>>>8|128,l[c++]=255&f;for(var _=0;_<6;++_)l[c+_]=d[_];return t||a(l)}},16564:(e,t,r)=>{var n=r(49024),o=r(26041);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}}}]);