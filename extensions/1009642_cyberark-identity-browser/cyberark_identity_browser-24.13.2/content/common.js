"undefined"==typeof _idaptiveUniqueGlobal&&(_idaptiveUniqueGlobal={}),function(){var N=this;void 0===N.login&&(N.login={}),void 0===N.communication&&(N.communication={}),void 0===N.windowMessage&&(N.windowMessage={}),void 0===N.i18n&&(N.i18n={}),N.login.PasswordBlockerPosition={justBefore:-1,justAfter:1,none:0},N.windowMessage.Frames={CBEClearRootShade:"CBEClearRootShade",CBEClearFrameTimer:"CBEClearFrameTimer",CheckRootIsFrameSetRequest:"CheckRootIsFrameSetRequest",CheckRootIsFrameSetResponse:"CheckRootIsFrameSetResponse"},N.formfill.InjectedElement={overlayID:"centrify::formfill.background",className:"centrify::formfill.injectedItems"},N.common.UI=function(){},N.common.UI.prototype={defaultStyle:{"background-color":"transparent",background:"none",border:"0px","border-collapse":"separate","border-radius":0,"border-spacing":"0px","box-shadow":"none","box-sizing":"content-box","-moz-box-sizing":"content-box",color:"#000000",float:"none",clear:"none","font-family":"Verdana, Arial","font-size":"medium","font-style":"normal","font-variant":"normal","font-weight":"normal","font-size-adjust":"none","letter-spacing":"normal","line-height":"normal","white-space":"normal","word-spacing":"normal","-moz-hyphens":"manual",outline:"invert none medium","-moz-appearance":"none",transition:"none","-webkit-transform":"none",margin:"0px","min-height":"0px","min-width":"0px",padding:"0px","table-layout":"auto","empty-cells":"show","text-align":"left","text-indent":"0px","text-shadow":"none","text-transform":"none","vertical-align":"baseline",width:"auto",height:"auto",position:"static",left:"auto",top:"auto",opacity:"1"},createElement:function(e,t,i,n){var o,r,s=e.createElement(i);for(o in this.defaultStyle)try{s.style.setProperty(o,this.defaultStyle[o],"important")}catch(e){this.logWarn&&this.logWarn("Can't set default style "+o+" for tag "+i)}switch(i.toLowerCase()){case"div":case"form":case"section":case"option":case"select":case"form":r="block";break;case"table":r="table";break;case"td":case"th":r="table-cell";break;case"tr":r="table-row";break;case"col":r="table-column";break;case"li":r="list-item";break;default:r="inline"}return s.style.setProperty("display",r,"important"),this.setStyle(s,n),t&&t.appendChild(s),s},hyperscriptCreateElement(e,t,...i){var n,o,r,s,l=document.createElement(e);for([n,o]of Object.entries(t)){switch(n.toLowerCase()){case"classname":n="class";break;case"onchange":l.onchange=o;continue;case"onclick":l.onclick=o;continue;case"onkeyup":l.onkeyup=o;continue;case"onmouseover":l.onmouseover=o;continue;case"onmouseout":l.onmouseout=o;continue;case"onmousedown":l.onmousedown=o;continue;case"onmouseup":l.onmouseup=o;continue;case"blur":l.blur=o;continue;case"style":if("object"!=typeof o)break;for(let[e,t]of Object.entries(o))l.style.setProperty(e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,t)=>(t?"-":"")+e.toLowerCase()),t);continue;case void 0:this.logWarn?.(`value of key '${n}' is undfined `+l);continue}l.setAttribute(n,o)}for(r of i)for(s of Array.isArray(r)?r:[r])"string"==typeof s&&(s=document.createTextNode(s)),l.appendChild(s);return l},setStyle:function(t,e){if(t)for(var i in e)try{t.style.setProperty(i,e[i],"important")}catch(e){this.logWarn&&this.logWarn("Can't set my style "+i+" for tag "+t.tagName+". Error: "+e.message)}},removeStyle:function(t,e){if(t)for(var i in e)try{t.style.removeProperty(i)}catch(e){this.logWarn&&this.logWarn("Can't remove my style "+i+" for tag "+t.tagName)}},findPosition:function(e){var t=0,i=0;if(e.offsetParent)for(;t+=e.offsetLeft,i+=e.offsetTop,e==e.offsetParent;);return{left:t,top:i}},createArrow:function(e,t,i,n,o){i=this.findPosition(i),t=this.createElement(e,t,"div",{"background-image":"url("+n+")",position:"absolute",opacity:"0.9","z-index":"2147483647",left:i.left+4+"px",top:i.top+4+"px",width:"161px",height:"25px"});return this.createElement(e,t,"div",{"padding-top":"1px","padding-left":"40px","font-size":"12px"}).innerHTML=o,t},findCssSelectorById:function(e){var t=e.ownerDocument,i=e.tagName?.toLowerCase();return e.id&&t.getElementById(e.id)===e?i+"[id='"+this.escapeSelector(e.id)+"']":null},findCssSelectorByName:function(e){e.ownerDocument;var t=e.tagName?.toLowerCase();if(e.name){var t=t+"[name='"+this.escapeSelector(e.name)+"']",i=this.getMatchedSelector(t);if(1===i.length||1<i.length&&i[0]===e)return t}return null},findCssSelectorByClass:function(e){e.ownerDocument;var t,i,n=e.tagName?.toLowerCase();if(0<e.classList.length)for(var o=0;o<e.classList.length;o++){if(i=n+"."+e.classList.item(o),1===this.getMatchedSelector(i).length)return i;if(t=this.positionInNodeList(e,e.parentNode.children)+1,1===this.getMatchedSelector(i=i+":nth-child("+t+")").length)return i}return null},getMatchedSelector:function(e){try{return document.querySelectorAll(e)}catch(e){return[]}},findCssSelectorByType:function(e){e.ownerDocument;var t=e.tagName?.toLowerCase();if(e.type&&"string"==typeof e.type){var t=t+"[type='"+this.escapeSelector(e.type)+"']",i=this.getMatchedSelector(t);if(1===i.length||1<i.length&&i[0]===e)return t}return null},findCssSelectorByTag:function(e){e.ownerDocument;var t=e.tagName?.toLowerCase()+":nth-of-type("+(this.tagIndexInNodeList(e,e.parentNode.children)+1)+")",i=this.getMatchedSelector(t);return 1===i.length||1<i.length&&i[0]===e?t:null},findCssSelectorReliable:function(e){var t=this.findCssSelectorById(e);return t||this.findCssSelectorByName(e)||this.findCssSelectorByClass(e)||this.findCssSelectorByTag(e)||null},findCssSelectorByParent:function(e){var t,i;return e?"html"===(t=e.tagName?.toLowerCase())||"head"===t||"body"===t?t:this.findCssSelectorReliable(e)||(i=this.positionInNodeList(e,e.parentNode.children)+1,this.findCssSelectorByParent(e.parentNode)+" > "+t+":nth-child("+i+")"):null},findCssSelectorByParentStopTag:function(e,t){var i,n=e.tagName?.toUpperCase();return"html"===n.toLowerCase()||"head"===n.toLowerCase()||"body"===n.toLowerCase()?n:-1<t.indexOf(n)?this.findCssSelectorReliable(e)||n:(i=this.positionInNodeList(e,e.parentNode.children)+1,this.findCssSelectorByParentStopTag(e.parentNode,t)+" > "+n+":nth-child("+i+")")},findCssSelector:function(e,t){e.ownerDocument;var i,n=e.tagName?.toLowerCase(),o=[];return"html"===n||"head"===n||"body"===n?n:((i=this.findCssSelectorById(e))&&o.push(i),"input"!==n&&"form"!==n&&"button"!==n||(i=this.findCssSelectorByName(e))&&o.push(i),this.findParentByMultiTag(e,t=t||["FORM"])&&(i=this.findCssSelectorByParentStopTag(e,t))&&o.push(i),(t=this.findCssSelectorByClass(e))&&o.push(t),"input"!==n&&"button"!==n||(i=this.findCssSelectorByType(e))&&o.push(i),e.parentNode&&(t=this.findCssSelectorByParent(e.parentNode))&&(i=this.positionInNodeList(e,e.parentNode.children)+1,o.push(t+" > "+n+":nth-child("+i+")")),o.join(","))},escapeSelector:function(e){return e=e&&"string"==typeof e?e.replace(/([^A-Za-z0-9_\u00A1-\uFFFF-])/g,"\\$1"):e},positionInNodeList:function(e,t){for(var i=0;i<t.length;i++)if(e===t[i])return i;return-1},tagIndexInNodeList:function(e,t){for(var i=e.tagName,n=-1,o=0;o<t.length&&(i===t[o].tagName&&n++,e!==t[o]);o++);return n},isElementVisiable:function(e){if(null===e.offsetParent)return!1;if(!e.offsetWidth||!e.offsetHeight)return!1;var t=e.getBoundingClientRect(),i=e.ownerDocument.documentElement.getBoundingClientRect();if(t.right<i.left)return!1;if(t.bottom<i.top)return!1;t=e.ownerDocument.defaultView.getComputedStyle(e);if(t){if(t.display&&"none"===t.display.toLowerCase())return!1;if(t.visibility&&"hidden"===t.visibility.toLowerCase())return!1;if(t.opacity&&t.opacity<.01)return!1}return!0},findParent:function(e,t){do{if(e?.tagName===t)return e}while(e=e?.parentNode);return null},findParentByMultiTag:function(e,t){for(var i=0;i<t.length;i++){var n=this.findParent(e,t[i]);if(n)return n}return null},findSubmitForNonForm:function(e){for(;e;){var t=this.queryFirstVisibleElement(e,"[type=submit], button");if(t)return t;e=e?.parentNode}return null},animateElementStyle:function(e,t,i,n,o,r,s,l,a){var d,c,p;e&&(c={},p=this,o<=n?(d=s(o),a&&a()):(d=s(n),setTimeout(function(){p.animateElementStyle(e,t,i,n+r,o,r,s,l,a)},l)),i&&(d+=i),c[t]=d,this.setStyle(e,c))}},N.login.CentrifyBELoginBase=function(){N.common.CentrifyBEBase.call(this)},N.login.CentrifyBELoginBase.prototype={acceptedExperiences:N.brand.acceptedExperiences,acceptedBrand:N.brand.brandValue,acceptNullBrand:N.brand.acceptNullBrand,loggerName:"Login",debugDelay:N.common.DefaultValues.debugDelay,defaultSelectorPullFreq:100,defaultSelectorTimeout:1e4,defaultSleepTime:80,enterKeyTimeout:4e3,defaultCaptchaTime:3e4,warnCode:{notSignedIn:0,appKeyNotFound:1},waitUntilAllFieldFound:function(e,t,i,n,o){var r,s;t.length<=0?(this.log("waitUntilAllFieldFound check is completed successfully."),n.call(this,e,!0,o)):(r=this.querySelector(e,t[0].selector,o.version),("2.1"==o.version?!r||!this.isElementVisiable(r):!r)?(i-=this.defaultSelectorPullFreq)<0?(r=e.URL,this.logError("Cannot find any matching node for "+t[0].name+", pattern = "+t[0].selector+", url ="+r),n.call(this,e,!1,o)):(s=this,(e.defaultView||window).setTimeout(function(){s.waitUntilAllFieldFound(e,t,i,n,o)},this.defaultSelectorPullFreq)):(t.shift(),this.waitUntilAllFieldFound(e,t,i,n,o)))},clickButton:function(i,n){var e;i&&(this.userSetting.autoSubmitScriptFix&&N.browser.isChromiumBrowser()?(this.log("This is chromium Based browsers "),this.sendClickButton(i)):i.click?this.userSetting.enableMouseEventsOnButtonSubmit?["mouseover","mousedown","mouseup","click"].forEach(function(e){var t=n.createEvent("MouseEvents");t.initEvent(e,!0,!0),i.dispatchEvent(t)}):i.click():n.createEvent?((e=n.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(e)):n.createEventObject&&(e=document.createEventObject(),i.fireEvent("onclick",e)))},sendClickButton:function(e){e&&(e=this.findCssSelector(e),chrome.runtime.sendMessage({action:N.formfill.loginEventEnum.sendSubmitButton,data:e}))},logCheckPageUrl:function(e){this.log("_load "+e.URL+", referrer = "+e.referrer)},isDocIgnore:function(e){return"about:blank"==e.URL},checkPage:function(e){e&&"#document"==e.nodeName&&(this.logCheckPageUrl(e),this.isDocIgnore(e)||(this.isAppClickPage(e)?this.inAppClickPage(e):this.notInAppClickPage(e)))},isAppClickPage:function(e){var t,i;return!(!(i=/^https:\/\/+(|(\.idaptive\.app)|(\.idaptive\.qa)|(\.id\.cyberark\-everest\-dev\.com)|(\.id\.integration\-cyberark\.cloud)|(\.id\.cyberark\.cloud)|(\.id\.cyberark\-everest\-integdev\.cloud)|(\.id\.cyberark\-everest\-integdev\.cloud)|(\.integration\-cyberark\.cloud)|(\.cyberark\-everest\-dev\.com)|(\.cyberark\.cloud)|(\.cyberark\-everest\-integdev\.cloud))+\/+((run)|(uprest\/HandleAppClick))\?appkey=/i).test(e.URL)&&(t=e.location.hostname,i=/^((\/run)|(\/uprest\/HandleAppClick))\?appkey=/i,"https:"!==e.location.protocol||!i.test(e.location.pathname+e.location.search)||!N.common.matchesAlternateTenantDomain(t)))},getAppKeyFromUrl:function(e){e=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}|@~?\/[a-zA-Z0-9]+\/[^&]+/i.exec(decodeURIComponent(e.URL));return e?e[0]:null},gotoWarningPage:function(e,t,i){var n,o=e.createElement("form");for(n in o.method="post",o.action=t,i){var r=e.createElement("input");r.type="hidden",r.name=n,r.value=i[n],o.appendChild(r)}e.body.appendChild(o),o.submit()},startRedirect:function(e,t,i){chrome.runtime.sendMessage({action:"redirectUrl",data:i.applicationUrl})},inAppClickPage:function(n){var o=this;o.log("detected appclick, saving data. URL = "+n.URL),o.extractLoginInfo(n).then(e=>{var t,i;e&&((t=n.getElementById("redirect"))?(e.scheme||(e.scheme=N.login.SchemeEnum.httpHttps),e.order&&(i=e.order[0])[0]==N.login.LoginOrderEnum.iframe&&(e.iframeWhitelist=i[1].whitelist,e.iframeBlacklist=i[1].blacklist,e.order.shift()),e.originalUrl=n.URL,o.checkSecurityOnAppClick(n,t,e)):o.logError("Can't find redirect id, abort!"))})},ensurePlaceholderReplaced:function(n,o,r){var s=this;return new Promise(function(t,i){!function e(){return r<1?(s.log("password placeholder never replaced"),console.error("password placeholder never replaced"),i()):n&&n.value&&!n.value.includes(o)?t():(r-=500,void setTimeout(e,500))}()})},extractLoginInfo:function(e){var t,i,n=this.querySelector(e,"input#init-data");return n?(t=3e4,i=JSON.parse(n.value).timeout,this.ensurePlaceholderReplaced(n,"ENCRYPTION_ENFORCED",t=i?i:t).then(()=>{var e=JSON.parse(n.value),t=JSON.parse(n.value);if(t.fields)for(var i=0;i<t.fields.length;i++)void 0!==t.fields[i].value&&(t.fields[i].value="********");return this.log("loginData = "+JSON.stringify(t)),void 0===e.brand&&this.acceptNullBrand||-1<this.acceptedExperiences.indexOf(e.experience)?e:(this.log("login data is ignored because of the experience mismatch"),null)})):(this.log("no init data. URL = "+e.URL),Promise.resolve())},logIgnore:function(e){this.log("ignore "+e.URL+",  referrer = "+e.referrer)},end:function(e){try{this.clearLoginData(e)}catch(e){this.logError("fail to clear loginData - "+e)}},abort:function(e,t){this.debugMode,this.logError(t),this.end(e)},isPasswordField:function(e){if(this.log("verifying whether field is password or not"),this.userSetting.enableAutoFillForNonPasswordTypeFields){if(e&&"password"===e.type?.toLowerCase())return!0;if(getComputedStyle){var t=getComputedStyle(e,null),t=t?t.getPropertyValue("-webkit-text-security"):null;if(t&&"none"!==t)return!0}return this.checkAttributesForKeyword(e,"password")}return!e||"password"===e?.type.toLowerCase()},checkAttributesForKeyword:function(e,t){if(e&&"password"===e.type?.toLowerCase()||e&&"text"===e.type?.toLowerCase()){var i;for(i of["id","class","name","placeholder"])if(e[i]?.toLowerCase()?.includes(t))return!0}return!1},preIframeChecking:function(e,t){if(null!=e.defaultView)if(t){if(null==e.defaultView.self.origin||"null"===e.defaultView.self.origin)return this.promptWarningDiag(e,"Untrusted page <br>Cannot autofill credentials as the page is not from a trusted source"),!1;if(e.defaultView.top===e.defaultView.self){if(t.iframeBlacklist&&e.URL.match(new RegExp(t.iframeBlacklist,"i")))return this.log("url "+e.URL+" matches "+t.iframeBlacklist),!1}else if(!t.iframeWhitelist||!e.URL.match(new RegExp(t.iframeWhitelist,"i")))return this.log("url "+e.URL+" not matches "+t.iframeWhitelist),!1;this.log("url "+e.URL+" magic")}else if(e.defaultView.top!==e.defaultView.self)return!1;return!0},tryLogin:function(e,t){if(this.log("App Login starts"),t&&this.preIframeChecking(e,t))if(!t||null!=self.origin&&"null"!==self.origin){if(t){if(!this.checkContentProtocol(e,t))return this.abort(e,"http protocol error: configured https but actually http"),this.promptWarningDiag(e,"This login page is not secure.<br>The application you are trying to access is configured to require a secure, encrypted, connection (HTTPS).<br>However, this login page is not encrypted (HTTP)."),!1;if(!Array.isArray(t.fields)||0===t.fields.length)return!1;for(var i=0;i<t.fields.length;i++)if("username"===t.fields[i].name&&!t.fields[i].value||"password"===t.fields[i].name&&!t.fields[i].value)return!1;this.log("T-180 the login sequence begins.");var n=!1;if(t.order&&0!==t.order.length||(N.login.Common.initDefaultLoginOrder(t),n=!0),this.log("T-179 login order = "+t.order),!this.userSetting?.enableNewAutoFillAlgorithm)if(void 0===t.currentOrder||t.forceAutoFill)t.isMultiAccountsApp&&"true"==t.isMultiAccountsApp&&this.checkMultiAccountApp(t),n=!(t.currentOrder=0);else{if(this.log("T-178 reenter "+t.currentOrder),t.currentOrder>=t.order.length)return this.abort(e,"OrderOfBound, currentOrder = "+t.currentOrder+", total = "+t.order.length),!1;var o=t.order[t.currentOrder],r=1<=t.currentOrder?t.order[t.currentOrder-1]:null;if(o[0]===N.login.LoginOrderEnum.newPage)++t.currentOrder,n=!0;else if((!r||r[0]!=N.login.LoginOrderEnum.gotoUrl&&r[0]!=N.login.LoginOrderEnum.header401)&&o[0]!==N.login.LoginOrderEnum.sleep&&o[0]!==N.login.LoginOrderEnum.fillTotp)return this.abort(e,"Unexpected login order, expect "+N.login.LoginOrderEnum.newPage+" but got "+o[0]),!1}return(n=this.userSetting?.enabledForceAutoFill&&t.order&&0<t.order.length&&t.appkey.includes("imported_Generic_Browser_Extension_")?t.forceAutoFill=!0:n)&&!t.nextStep&&this.updateLoginData(e,t),t.IsTotpEnabled&&this.userSetting.enabledTotpAutoFill&&(t.order.some(e=>e.includes(N.login.LoginOrderEnum.fillTotp))||(N.login.Common.setTotpOrder(t,this.userSetting),this.updateLoginData(e,t))),this.userSetting?.enableNewAutoFillAlgorithm?N.v2.doLogin(t):this.userSetting?.enabledForceAutoFill&&t.forceAutoFill?(this.log("Non-catalog app login starts"),this.dynamicAutoFill(e,t)):this.executeCommands(e,t),!0}}else this.promptWarningDiag(e,"Untrusted page <br>Cannot autofill credentials as the page is not from a trusted source"),this.end(e);return!1},logSeq:function(e,t){var i=e.order[e.currentOrder],e="T-"+e.currentOrder+"/"+e.order.length+" "+i;t&&(e+=": "+t),this.log(e)},dynamicAutoFill:function(n,o){if(o.forceAutoFill){this.log("FAutoFill, started");let e=0,t=!1,i=!1;if(o.IsTotpEnabled&&o.needsTotpFill)this.executeCommandTotp(n,o,!0);else if(o.nextStep)this.wizardForm(n,o,!0);else{for(;e<3;){if(!(t=this.searchPasswordNode(n))&&(i=this.searchUsernameNode(n))){this.log("FAutoFill, App login seems to be a Wizard form"),this.wizardForm(n,o);break}if(t)break;2==e&&window.setTimeout(()=>{this.log("FAutoFill, going to wait for 3 secs to find password field"),(t=this.searchPasswordNode(n))?this.checkForUPFields(n,o):((i=this.searchUsernameNode(n))&&(this.log("FAutoFill, App login seems to be a Wizard form"),this.wizardForm(n,o)),this.log("FAutoFill, haven't able to find passwordfield after timeout.")),this.end(n)},5e3),e++}t&&(this.log("FAutoFill, intial check password, found passwordfield, determine rest of the fields"),this.checkForUPFields(n,o))}}},searchUsernameNode:function(e){var t=e.querySelectorAll("input[type=text], input[type=email]");if(0<t.length){for(let e=0;e<t.length;e++)if(!this.isInputIgnore(t[e])&&!this.isPasswordField(t[e]))return!0}else{e=e.querySelectorAll("form");if(1===e.length){var i=e[0].querySelectorAll("input");for(let e=0;e<i.length;e++){var n=i[e];if(!(this.isInputIgnore(n)||this.isPasswordField(n)||"text"!==n.type?.toLowerCase()&&"email"!==n.type?.toLowerCase()))return!0}}}return!1},searchPasswordNode:function(e){let t=e.querySelectorAll("input[type=password]");if(0<t.length?t:t=e.querySelectorAll("input[type=text]"),0<t.length)for(let e=0;e<t.length;e++)if(!this.isInputIgnore(t[e])&&this.isPasswordField(t[e]))return!0;return!1},checkForUPFields:function(t,i){let e=null;var n=this.getPasswordField(t);if(1!=n.length||this.isInputIgnore(n[0]))return 1<n.length?void this.log("FAutoFill, found more than one password field"):void 0;if(null!==(e=this.findParent(n[0],"FORM"))){this.log("FAutoFill, found the form");var o=this.getUPSelectors(e);null!==o&&(e.setAttribute("autocomplete","off"),this.fillCreds(o,i,e))}else{this.log("FAutoFill, didn't find the form for password element");let e=document.querySelectorAll("input[type=email], input[type=text]");(1===(e=1<e?.length?document.querySelectorAll("input[type=email]"):e).length||(this.log("FAutoFill, Analyzing the input field for non-form"),1===(e=this.anylzetheInputFields(t)).length))&&this.nonFormAutoFill(e[0],n[0],i)}},nonFormAutoFill:function(t,i,n){t=this.findFirstCommonAncestor(t,i);if(t){var i=t.querySelector("input[type=email], input[type=text]"),o=t.querySelector("input[type=password]");let e=t.querySelector("[type=submit], [type=button]");e=e||t.querySelector("button"),i&&o?((t={}).username=i,t.password=o,t.submit=e,t.usernameSelector=this.findCssSelector(i),t.passwordSelector=this.findCssSelector(o),t.submitSelector=e?this.findCssSelector(e):null,e&&1<this.getMatchedSelector(t.submitSelector).length&&(t.submitSelector=null),this.fillCreds(t,n,document)):(this.log("FAutoFill, couldn't able to determine fields of Non-form"),this.end(document))}},wizardForm:function(n,o,e=!1,t=!1){this.log("FAutofill, Wizard Form");var i=this.anylzetheInputFields(n),r={};let s=null;if(1!==i.length||e)if(e)window.setTimeout(()=>{this.log("FAutoFill: Calling Wizard Form step 2 password filling"),this.wizardNextStep(o,t)},1e3);else{var l,e=n.querySelectorAll("form");let t=0,i=null;1===e.length&&(e[0].querySelectorAll("input").forEach(e=>{this.isInputIgnore(e)||this.isPasswordField(e)||"text"!==e.type&&"email"!==e.type||(t++,i=e)}),1===t)&&(l=this.getSubmitSelectorFromForm(e[0]),o.fields[0].pattern=this.findCssSelector(i),l=document.querySelector(l),r.username=i,r.submit=l,e[0].setAttribute("autocomplete","off"),this.fillFirstWizardStep(n,o,r,e))}else{let e=this.findParent(i[0],"FORM");null!=e?(e.setAttribute("autocomplete","off"),s=this.queryFirstVisibleElement(e,"[type=submit], button"),r.submit=s??null):null!==(s=this.findSubmitForNonForm(i[0]))&&(r.submit=s,e=n),o.fields[0].pattern=this.findCssSelector(i[0]),r.username=i[0],this.fillFirstWizardStep(n,o,r,e)}},wizardNextStep:function(t,i){this.log("FAutoFill, Wizard form step 2 started");var n=this.getPasswordField(document);if(0<n?.length&&this.isPasswordField(n[0])){let e=this.findParent(n[0],"FORM");e?e.setAttribute("autocomplete","off"):(this.findSubmitForNonForm(n[0]),e=document),t.fields[1].pattern=this.findCssSelector(n[0]),n[0].value=t.fields[1].value,N.login.centrifyBELogin.triggerInputChangeEvents(document,n[0]),t.nextStep=!1,this.updateLoginData(document,t),this.findAndClickSubmitButton(e,n[0]),this.saveWizardFormDetails(t,i)}this.end(document)},saveWizardFormDetails:function(e,t){this.log("FAutoFill, Saving form details to App");var i={},n=document.querySelector(e.fields[0].pattern,document);i.usernameSelector=e.fields[0].pattern,i.passwordSelector=e.fields[1].pattern,null!==n&&"password"!==n.type&&this.isElementVisiable(n)||t?i.order='[["fillEnter","username"],["sleep", "3000"],["fillEnter","password"]]':i.order='[["fillEnter","username"],["waitForNewPage"],["fillEnter","password"]]',this.updateNonCatalogueApp(i,e.appkey),e.IsTotpEnabled?(e.needsTotpFill=!0,this.updateLoginData(document,e)):this.end(document)},fillFirstWizardStep:function(e,t,i,n){this.log("FAutoFill: filling first step of wizard"),t.nextStep=!0,this.updateLoginData(e,t),i.username.focus(),i.username.value=t.fields[0].value,N.login.centrifyBELogin.triggerInputChangeEvents(e,i.username),i.submit&&this.isSubmitDisabled(i.submit)&&i.submit.removeAttribute("disabled"),this.findAndClickSubmitButton(n,i.username),setTimeout(()=>{this.log("Settime out called, means no re-direction of page."),this.wizardForm(e,t,!0,!0)},4e3)},isSubmitDisabled:function(e){return!!(e?.getAttributeNames().includes("disabled")||e.getAttribute("disabled")&&""!==e?.getAttribute("disabled"))},findFirstCommonAncestor:function(e,t,i){return 0==(i=i||this.getAncestors(t)).length?null:-1<i.indexOf(e)?e:e==document?null:this.findFirstCommonAncestor(e.parentNode,t,i)},getAncestors:function(e){return e!=document?[e].concat(this.getAncestors(e.parentNode)):[e]},getSubmitSelectorFromForm:function(e){if(null!=e)return(e=this.queryFirstVisibleElement(e,"[type=submit], button"))?this.findCssSelector(e):null},getPasswordField:function(e){let t=e.querySelectorAll("input[type=password]"),i=(0<t.length?t:t=e.querySelectorAll("input[type=text]"),[]);if(0<t.length)return t.forEach(e=>{!this.isInputIgnore(e)&&this.isPasswordField(e)&&i.push(e)}),1===i.length?i:[]},getFavicon:function(){for(var e=document.getElementsByTagName("link"),t=0;t<e.length;t++)if("icon"==e[t].getAttribute("rel")||"shortcut icon"==e[t].getAttribute("rel")?.toLowerCase()||"icon shortcut"==e[t].getAttribute("rel")?.toLowerCase()){var i,n=e[t].getAttribute("href");if(n){if(-1!=n.toLowerCase().indexOf("https:")||-1!=n.toLowerCase().indexOf("http:")||0==n.indexOf("//"))return 0==n.indexOf("//")?window.location.protocol+n:n;{let e=window.location.protocol+"//"+window.location.host;return window.location.port&&(e+=":"+window.location.port),0==n.indexOf("/")?e+=n:((i=window.location.pathname.split("/")).pop(),i=i.join("/"),e+=i+"/"+n),e}}}return null},getBase64ImageFromUrl:async function(n){if(!n||""==n)return this.log("FAutofill, fav icon url is missing"),Promise.reject("Could not capture the icon");try{let i=new Image;return i.setAttribute("crossOrigin","anonymous"),new Promise((t,e)=>{i.onload=()=>{var e=document.createElement("canvas");e.width=60,e.height=60;e.getContext("2d").drawImage(i,0,0,60,60);e=e.toDataURL("image/png");t(e)},i.onerror=()=>e(this),i.src=n})}catch(e){return Promise.reject("Could not capture the icon")}},getUPSelectors:function(e){if(null===e)return null;this.log("FAutoFill, finding username and password for form elements");var t=[],i=[],n={},o=e.querySelectorAll("input");if(0<o.length)for(let e=0;e<o.length;e++)"text"!==o[e].type&&"email"!==o[e].type||this.isInputIgnore(o[e])||this.isPasswordField(o[e])||t.push(o[e]),this.isPasswordField(o[e])&&!this.isInputIgnore(o[e])&&i.push(o[e]);return 1===t.length&&1===i.length?(n.usernameSelector=this.findCssSelector(t[0]),n.passwordSelector=this.findCssSelector(i[0]),n.submitSelector=this.getSubmitSelectorFromForm(e),null!==n.submitSelector&&1<this.getMatchedSelector(n.submitSelector)&&(n.submitSelector=null),n.username=t[0],n.password=i[0],n.submit=e.querySelectorAll("[type=submit],button")[0]):this.log("Found 2 or more text fields might be corp id fields"),n},anylzetheInputFields:function(e){var t,n=[...e.querySelectorAll("input[type=email], input[type=text]")],o=["id","name","classname","placeholder","type"],r=new Set;for(t of[{keywords:["username","email","userid","user","enter username"]}].values())for(let i of t.keywords.values())for(let t of o.values()){var s=n.findIndex(e=>e[t]?.toLowerCase().includes(i));0<=s&&!this.isInputIgnore(n[s])&&r.add(n[s])}return 1===r.size?[...r]:(1<r.size&&this.log("page contains corpid field or found more fields"),[])},analyzeTotpField:function(e,t=0){this.log("Totp field searching");for(var i,n=this.getTotpAutoFillSelectors();t<3;)if(t++,0<(i=document.querySelectorAll(n)).length)return this.getMatchedFields(i);return[]},getTotpAutoFillSelectors:function(){var e=this.extractTotpAutoFillConfig();if(e){e=e.selectors;if("string"==typeof e&&""!==e)return e}return"input[type=text], input[type=number], input[type=tel], input[type=numeric], input[inputmode=numeric]"},extractTotpAutoFillConfig:function(){var e=this.userSetting.isTotpAutoFillConfigValuesEnabled,t=this.userSetting.totpAutoFillConfig;if(e&&""!==t)try{return JSON.parse(t)}catch(e){}return null},getMatchedFields:function(e){if(0<e?.length){var i=[...e],n=this.getTotpAutoFillAttributes(),e=[],o=new Set;for(let t=0;t<i.length;t++)for(let e=0;e<n.length;e++)if(!this.isInputIgnore(i[t])){var r=i[t].getAttribute(n[e]);if(r)if(this.isTotpFieldsMatching(r)){o.add(i[t]);break}}if(0===o.size)for(let e=0;e<i.length;e++){this.leftLabelContent(i[e]);this.isTotpFieldsMatching(value)&&o.add(i[e])}if(0===o.size)for(let e=0;e<i.length;e++){this.rightContentText(i[e]);this.isTotpFieldsMatching(value)&&o.add(i[e])}return 0<o.size?[...o]:(o.size<1&&this.log("Totp fields not found."),e)}return[]},getTotpAutoFillAttributes:function(){var e=this.extractTotpAutoFillConfig();if(e){e=e.attributes;if(Array.isArray(e)&&0<e.length)return e}return["id","name","classname","placeholder","autocomplete","data-component","class","data-testid"]},rightContentText:function(e){var t=[];let i=e;for(;i&&i.nextSibling&&(i=i.nextSibling,!this.isNewSectionElement(i));){var n=this.getTextContentFromElement(i);n&&t.push(n)}return t.join("")},isTotpFieldsMatching:function(e){var t=this.extractTotpAutoFillConfig();if(t){t=t.totpfieldnames;if(Array.isArray(t)&&0<t.length)return this.isTextMatching(t,e)}return this.isTextMatching(N.AutoFilltotpConstants.totpFieldNames,e)},isTextMatching:function(t,i){if(null!=t&&0!==t.length&&null!=i&&""!==i){i=i.replace(/(?:\r\n|\r|\n)/g,"").trim().toLowerCase();for(let e=0;e<t.length;e++)if(-1<i.indexOf(t[e]))return!0}return!1},leftLabelContent:function(e){return this.recurseGetSibilingText(e).reverse().join("")},isNewSectionElement:function(e){var t;return!e||(t=new Set(["html","body","button","form","head","iframe","input","option","script","select","table","textarea"]),"tagName"in e&&t.has(e.tagName.toLowerCase()))},getTextContentFromElement:function(e){return e.nodeType===Node.TEXT_NODE?this.trimAndRemoveNonPrintableText(e.nodeValue):this.trimAndRemoveNonPrintableText(e.textContent||e.innerText)},trimAndRemoveNonPrintableText:function(e){return(e||"").replace(/[^\x20-\x7E]+|\s+/g," ").trim()},recurseGetSibilingText:function(e){var t=[];let i=e;for(;i&&i.previousSibling;){if(i=i.previousSibling,this.isNewSectionElement(i))return t;let e=this.getTextContentFromElement(i);e&&t.push(e)}if(!i||t.length)return t;if(!(i=i.parentElement||i.parentNode))return t;let n=1===i?.nodeType?i.previousElementSibling:i.previousSibling;for(;n?.lastChild&&!this.isNewSectionElement(n);)n=n.lastChild;if(this.isNewSectionElement(n))return t;let o=this.getTextContentFromElement(n);return o?(t.push(o),t):this.recurseGetSibilingText(n)},isInputIgnore:function(e){var t;return e.type?!("hidden"!==(t=e.type.toLowerCase())&&"checkbox"!==t&&!e.readonly&&!e.disabled&&this.checkVisibility(e)&&"true"!=e.getAttribute("aria-hidden")&&"true"!=e.parentNode?.getAttribute("aria-hidden")):(this.log("Input type is null or undefined"),!0)},fillCreds:function(t,i,e){this.log("FAutoFill, filling the creds");var n;for(let e=0;e<i.fields.length;e++)("username"===(n=i.fields[e]).name&&n.value||"password"===n.name&&n.value)&&(t[n.name].value=n.value,N.login.centrifyBELogin.triggerInputChangeEvents(document,t[n.name]));window.setTimeout(()=>{this.userSetting.updateNonCatalogueApps&&(this.updateNonCatalogueApp(t,i.appkey),this.findAndClickSubmitButton(e,t.password),i.IsTotpEnabled?(i.needsTotpFill=!0,this.updateLoginData(document,i),window.setTimeout(()=>{this.executeCommandTotp(document,i,!0)},2e3)):this.end(document))},200)},updateNonCatalogueApp:function(t,i,n=null){var o={};if(this.log("FAutoFill, Updating app details calling api"),null!==i&&!i.startsWith("@/home")){o.appkey=i,o.icon=n,o.uselector=t.usernameSelector,o.pselector=t.passwordSelector,o.sselector=t.submitSelector,o.order=t.order??null;let e=Math.random();i=this.getFavicon();this.getBase64ImageFromUrl(i).then(e=>{this.log("FAutofill, Captured the fav icon"),o.icon=e}).catch(e=>{this.log(e),o.icon=null}).finally(()=>{chrome.runtime.sendMessage({action:N.communication.CentrifyEventEnum.centrifyServiceRequest,data:{messageId:e,input:o,path:"/uprest/UpdateNonCatalogApps",method:"post"}})})}},executeCommands:function(e,t){if(t.order.length<=t.currentOrder)this.log("no more command to run"),this.sendMessageToSWSExtension(t.applicationUrl,t.appkey),this.end(e);else{var i=t.order[t.currentOrder];switch(this.logSeq(t),i[0]){case N.login.LoginOrderEnum.click:this.executeCommandClick(e,t);break;case N.login.LoginOrderEnum.newPage:this.executeCommandNewPage(e,t);break;case N.login.LoginOrderEnum.ups:this.executeCommandUps(e,t);break;case N.login.LoginOrderEnum.sleep:this.executeCommandSleep(e,t);break;case N.login.LoginOrderEnum.fill:this.executeCommandFill(e,t);break;case N.login.LoginOrderEnum.fillEnter:this.executeCommandFillEnter(e,t);break;case N.login.LoginOrderEnum.submit:this.executeCommandSubmit(e,t);break;case N.login.LoginOrderEnum.gotoUrl:this.executeCommandGotoUrl(e,t);break;case N.login.LoginOrderEnum.header401:this.executeCommandHeader401(e,t);break;case N.login.LoginOrderEnum.checkMultiAccountLoginStatus:this.checkCheckMultiAccountLoginStatus(e,t);break;case N.login.LoginOrderEnum.captcha:this.executeCommandCaptcha(e,t);break;case N.login.LoginOrderEnum.fillTotp:this.executeCommandTotp(e,t);break;default:this.abort(e,"Unknown command in the order: "+i[0])}}},executeCommandClick:function(e,t){this.logSeq(t,"executeCommandClick");var i=t.order[t.currentOrder],i=[{selector:i[1],name:"clicks_"+i[1]}],n=void 0!==t.globalSelectorTimeout?t.globalSelectorTimeout:this.defaultSelectorTimeout;this.waitUntilAllFieldFound(e,i,n,this.executeCommandClickCallback,t)},executeCommandClickCallback:function(e,t,i){this.logSeq(i,"executeCommandClickCallback");var n,o,r=i.order[i.currentOrder],s=r[2];t||s?(n=this.querySelector(e,t=r[1],i.version))||s?(++i.currentOrder,this.updateLoginData(e,i),r=function(){o.clickButton(n,e),o.executeCommands(e,i)},(o=this).debugMode&&0<this.debugDelay?(this.log("Will click "+t+" in "+this.debugDelay+"ms"),window.setTimeout(r,this.debugDelay)):r()):this.abort(e,"The element is disappeared. Selector = "+t):this.end(e)},executeCommandNewPage:function(e,t){var i=t.order[t.currentOrder][1],n=!1;(n=i&&(this.log("skipcondition url"+i.url),i.url&&e.URL&&e.URL.match(i.url)&&(this.log("skipcondition url"+i.url),this.log("current doc url"+e.URL),n=!0),i.httpStatus)&&"200".match(i.httpStatus)?!0:n)?(this.log("The skip condition is met in waitForNewPage. No wait"),++t.currentOrder,this.updateLoginData(e,t),this.executeCommands(e,t)):(this.log("The waiting for next page load. Zzz"),this.userSetting.enabledTotpAutoFill&&t.currentOrder<=t.order.length&&t.order[t.currentOrder+1][0]===N.login.LoginOrderEnum.fillTotp&&(++t.currentOrder,this.updateLoginData(e,t),this.executeCommands(e,t)))},executeCommandUps:function(e,t){this.logSeq(t,"executeCommandUps");for(var i=[],n=0;n<t.fields.length;n++){var o=t.fields[n];i.push({selector:o.pattern,name:o.name})}t.submitPattern&&i.push({selector:t.submitPattern,name:"submit button"});var r=void 0!==t.globalSelectorTimeout?t.globalSelectorTimeout:this.defaultSelectorTimeout;this.waitUntilAllFieldFound(e,i,r,this.executeCommandUpsCallback,t)},executeCommandUpsCallback:function(o,e,r){var s,l,a,d,c;this.logSeq(r,"executeCommandUpsCallback"),e?(this.log("T-40 UPS test is completed"),s=o.URL,l=r.fields.length,a=0,d=this,(c=function(){var t,i=r.fields[a],n=d.querySelector(o,i.pattern,r.version);n?"password"!==i.name||d.isPasswordField(n)?(d.log("T-"+(l-a+10)+", setting "+i.name+", pattern = "+i.pattern+", appUrl="+s),a!=l-1||r.submitPattern?(n.focus(),(t=o.defaultView||window).setTimeout(function(){var e;n.value=i.value,d.afterFillingValue(n),o.createEvent?((e=o.createEvent("HTMLEvents")).initEvent("input",!0,!1),n.dispatchEvent(e),(e=o.createEvent("HTMLEvents")).initEvent("change",!0,!1),n.dispatchEvent(e)):n.fireEvent&&n.fireEvent("onchange"),d.triggerKeyEvent(n),a++,t.setTimeout(function(){var e;n.blur(),e=l<=a?function(){d.executeCommandSubmit(o,r)}:c,t.setTimeout(e,d.defaultSleepTime)},d.defaultSleepTime)},d.defaultSleepTime)):d.fillAndEnter(o,r,n,i)):(d.log("This is not password field, so aborting it"),d.end(o)):d.abort(o,"The "+i.name+" field doesn't exist. pattern = "+i.pattern+", url ="+s)})()):(this.log("T-40 UPS test is failed. no-go"),this.end(o))},executeCommandSleep:function(e,t){this.logSeq(t,"executeCommandSleep");var i=t.order[t.currentOrder],i=1<i.length&&0<=i[1]?i[1]:this.defaultSleepTime,n=(this.log("Sleep for "+i+"ms"),this);(e.defaultView||window).setTimeout(function(){n.log("Good morning"),++t.currentOrder,n.updateLoginData(e,t),n.executeCommands(e,t)},i)},executeCommandHeader401:function(e,t){this.userSetting.enableHeader401SuccessFix?(this.log("The command 'header401' is not supported here."),this.log("Assuming user is already logged in and going to the next step"),++t.currentOrder,this.updateLoginData(e,t),this.executeCommands(e,t)):this.abort("The command 'header401' is not supported here.")},executeCommandCaptcha:function(e,t){this.logSeq(t,"executeCommandCaptcha");var i,n=this;n.userSetting.enableCaptchaforBE?(i=1<(i=t.order[t.currentOrder]).length&&0<=i[1]?i[1]:this.defaultCaptchaTime,n=this,(e.defaultView||window).setTimeout(function(){++t.currentOrder,n.updateLoginData(e,t),n.executeCommands(e,t)},i)):(++t.currentOrder,n.updateLoginData(e,t),n.executeCommands(e,t))},executeCommandTotp:function(e,t,i=0){var n,o=this;o.userSetting.enabledTotpAutoFill?(t.IsTotpEnabled=!1,o.log("Search Totp Fields"),1<=(n=o.analyzeTotpField(e)).length?(o.log("calling totp api to get the code"),N.util.getTotp(t.appkey,function(e){isNaN(e)?o.log("Couldn't get the totp from the api"):(o.fillTotpFields(n,e),e=o.findParent(n[0],"FORM"),o.findAndClickSubmitButton(e??document,n[0]))})):o.log("Couldn't able to locate the totp field"),window.setTimeout(function(){++t.currentOrder,o.updateLoginData(e,t),o.executeCommands(e,t)},1500)):o.log("Autofill Totp is not enabled")},fillTotpFields:function(t,i){if(t.length===i.length)for(let e=0;e<t.length;e++)t[e].focus(),t[e].value=i[e],this.triggerInputChangeEvents(document,t[e]);else 0<t.length?(t[0].focus(),t[0].value=i,this.triggerInputChangeEvents(document,t[0])):this.log("Not able to fill the Totp")},getFieldByName:function(e,t){for(var i=0;i<e.fields.length;i++){var n=e.fields[i];if(n.name==t)return n}return null},findCurrentCommandField:function(e,t,i){var n,o=t.order[t.currentOrder][1],r=this.getFieldByName(t,o);r?(r=[{selector:r.pattern,name:r.name}],n=void 0!==t.globalSelectorTimeout?t.globalSelectorTimeout:this.defaultSelectorTimeout,this.waitUntilAllFieldFound(e,r,n,i,t)):this.abort(e,"Can't find a field with name, "+o)},executeCommandFill:function(e,t){this.logSeq(t,"executeCommandFill"),this.findCurrentCommandField(e,t,this.executeCommandFillCallback)},executeCommandFillCallback:function(e,t,i){this.logSeq(i,"executeCommandFillCallback");var n,o,r=e.defaultView||window,s=this;t?(t=i.order[i.currentOrder][1],n=this.getFieldByName(i,t),o=this.querySelector(e,n.pattern,i.version),"password"!==t?.toLowerCase()||this.isPasswordField(o)?o?this.fillField(e,i,o,n,!1):"2.1"==i.version?(this.log("preflightResult success, field doesn't exist, but it is LC app, continue"),++i.currentOrder,this.updateLoginData(e,i),r.setTimeout(function(){s.executeCommands(e,i)},s.defaultSleepTime)):this.abort(e,"The "+n.name+" field doesn't exist. pattern = "+n.pattern):(this.log("Field is not type of password, so not filling it and aborting"),this.end(e))):"2.1"==i.version?this.hasAnyVisibleForm(e)?(this.log("preflightResult fails, but it is LC app, continue"),++i.currentOrder,this.updateLoginData(e,i),r.setTimeout(function(){s.executeCommands(e,i)},s.defaultSleepTime)):(this.log("LC app, no visible form, should end login"),this.end(e)):this.end(e)},fillAndEnter:function(e,t,i,n){this.logSeq(t,"fillAndEnter"),this.disableFormAutoComplete(e,t);for(var o=i.parentNode;o;){if("FORM"===o.tagName){o.setAttribute("autocomplete","off"),this.log("FAC from this field switch to off");break}o=o.parentNode}this.fillField(e,t,i,n,!0)},executeCommandFillEnter:function(e,t){this.logSeq(t,"executeCommandFillEnter"),this.findCurrentCommandField(e,t,this.executeCommandFillEnterCallback)},executeCommandFillEnterCallback:function(e,t,i){this.logSeq(i,"executeCommandFillEnterCallback");var n,o,r=e.defaultView||window,s=this;t?(t=i.order[i.currentOrder][1],n=this.getFieldByName(i,t),o=this.querySelector(e,n.pattern,i.version),"password"===t&&o&&!this.isPasswordField(o)?this.abort(e," This is not a password field and we are aborting"):o?this.fillAndEnter(e,i,o,n):"2.1"==i.version?(this.log("preflightResult success, field doesn't exist, but it is LC app, continue"),++i.currentOrder,this.updateLoginData(e,i),r.setTimeout(function(){s.executeCommands(e,i)},s.defaultSleepTime)):this.abort(e,"The "+n.name+" field doesn't exist. pattern = "+n.pattern)):"2.1"==i.version?this.hasAnyVisibleForm(e)?(this.log("preflightResult fails, but it is LC app, continue"),++i.currentOrder,this.updateLoginData(e,i),r.setTimeout(function(){s.executeCommands(e,i)},s.defaultSleepTime)):(this.log("LC app, no visible form, should end login"),this.end(e)):this.end(e)},disableFormAutoComplete:function(e,t){var i=e.URL;t.formPattern&&((e=this.querySelector(e,t.formPattern,t.version))?(e.setAttribute("autocomplete","off"),this.log("T-3 FAC switch to off")):this.logWarn("cannot find form element, pattern = "+t.formPattern+", appUrl="+i))},isElementVisiable:function(e){return!(null===e.offsetParent||(e=e.ownerDocument.defaultView.getComputedStyle(e))&&e.display&&"none"===e.display.toLowerCase())},hasAnyVisibleForm:function(e){for(var t=e.getElementsByTagName("FORM"),i=!1,n=0;n<t.length;n++){var o=t[n];if(this.isElementVisiable(o)){i=!0;break}}return i},executeCommandSubmit:function(e,t){this.logSeq(t,"executeCommandSubmit");var i,n,o=e.URL,r=(this.disableFormAutoComplete(e,t),this.querySelector(e,t.submitPattern,t.version));r?(this.log("T-2, SB is in position, pattern = "+t.submitPattern),n=function(){i.log("T-0 ignite"),t.order.length<=t.currentOrder?(i.log("T+0 bomb"),i.end(e)):(++t.currentOrder,i.updateLoginData(e,t),i.clickButton(r,e),i.executeCommands(e,t)),i.log("T+1 on the sky")},(i=this).debugMode&&0<this.debugDelay?(e.title="You will be login in "+this.debugDelay+" ms",this.log("T-1: Ignite in "+this.debugDelay+" ms"),(e.defaultView||window).setTimeout(n,this.debugDelay)):n()):this.abort(e,"The submit field doesn't exist. pattern = "+t.submitPattern+", appUrl="+o)},executeCommandGotoUrl:function(e,t){this.logSeq(t,"executeCommandGotoUrl");var i=t.order[t.currentOrder][1];++t.currentOrder,this.updateLoginData(e,t),e.location=i},checkContentProtocol:function(e,t){return this.checkProtocol(e.URL,t.applicationUrl)},triggerInputChangeEvents:function(e,t){var i;e.createEvent?((i=e.createEvent("HTMLEvents")).initEvent("input",!0,!1),t.dispatchEvent(i),(i=e.createEvent("HTMLEvents")).initEvent("change",!0,!1),t.dispatchEvent(i)):t.fireEvent&&t.fireEvent("onchange"),this.triggerKeyEvent(t)},fillField:function(e,t,i,n,o){i.focus();var r=this,s=e.defaultView||window,l=0;s.setTimeout(function(){i.value=n.value,r.afterFillingValue(i,t.order[t.currentOrder][2]),N.login.centrifyBELogin.triggerInputChangeEvents(e,i),++t.currentOrder,r.updateLoginData(e,t),o&&(r.fireEnterEvents(e,i,n),r.userSetting.isAutoSubmitAfterEnterEnabled)&&(l=r.enterKeyTimeout),s.setTimeout(function(){i.blur(),r.executeCommands(e,t)},r.defaultSleepTime+l)},this.defaultSleepTime)},triggerKeyEvent:function(e){function t(e,t,i){var n;document.createEvent?((n=document.createEvent("HTMLEvents")).keyCode=i,n.initEvent(t,!1,!0),e.dispatchEvent(n)):((n=document.createEventObject()).keyCode=i,n.eventType=t,e.fireEvent("on"+n.eventType,n))}t(e,"keydown",40),t(e,"keypress",40),t(e,"keyup",40)},findAndClickSubmitButton:function(t,i){var n=["submit","login","signin","sign-in","log-in"];if(t.parentElement){var e=this.queryFirstVisibleElement(t,"input[type=submit], button[type=submit]");if(e)return this.log("fireEnterEvents: found button of type submit, clicking to submit"),void this.clickButton(e,document);if(e=this.getButtonWithIdOrClass(t,n))return this.log("fireEnterEvents: found button with id or class containing submit or login or signin keyword, clicking it to submit"),void this.clickButton(e,document)}e=this.findClosestButNotInside(t,i,"button, input[type=button]");if(e)this.log("fireEnterEvents: found closest button to the field, clicking it to submit"),this.clickButton(e,document);else{var o=["a","img","span","div"];n.push("btn");for(let e=0;e<o.length;e++){var r=o[e],r=this.findClosestButNotInside(t,i,this.getSelectorForIdorClass(r,n));if(r)return this.log("fireEnterEvents: found closest button to the field, clicking it to submit"),void this.clickButton(r,document)}t.parentElement&&"POST"===t.method.toUpperCase()?(this.log("fireEnterEvents: Found the form has method post, so using requestSubmit"),HTMLFormElement.prototype.requestSubmit.call(t)):this.log("fireEnterEvents: No selector was found, so skipping the auto submit")}},getButtonWithIdOrClass:function(e,t){Array.isArray(t)||(t=[t]);var i=[],t=(i.push(this.getSelectorForIdorClass("button",t)),i.push(this.getSelectorForIdorClass("input[type=button]",t)),i.join(","));return this.queryFirstVisibleElement(e,t)},getSelectorForIdorClass:function(t,e){return(e=Array.isArray(e)?e:[e]).map(e=>t+`[class*=${e} i], ${t}[id*=${e} i], ${t}[aria-label*=${e} i]`).join(",")},findClosestButNotInside:function(e,t,i){e=this.queryAllVisibleElements(e,i);let o=t?.getBoundingClientRect();return e&&1===e.length?e[0]:e.reduce((e,t)=>{var i,n=t.getBoundingClientRect();return!(n.bottom>o.top&&n.right>o.left&&n.top<o.bottom&&n.left<o.right)&&(!e||(i=e.getBoundingClientRect(),r(o,n)<r(o,i)))?t:e},null);function r(e,t){var i=t.right<e.left,n=e.right<t.left,o=t.bottom<e.top,r=e.bottom<t.top;return o?s(e.left,e.bottom,t.right,t.top):n&&o?s(e.left,e.top,t.right,t.bottom):o&&i?s(e.right,e.top,t.left,t.bottom):n&&r?s(e.right,e.bottom,t.left,t.top):i?e.left-t.right:n?t.left-e.right:r&i?e.top-t.bottom:r?t.top-e.bottom:0}function s(e,t,i,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(t-n,2))}},queryFirstVisibleElement:function(e,t){e=this.queryAllVisibleElements(e,t);return e&&0!==e.length?e[0]:null},queryAllVisibleElements:function(e,t){try{return Array.from(e.querySelectorAll(t)).filter(this.checkVisibility)}catch(e){return[]}},checkVisibility(e){return e.checkVisibility?e.checkVisibility():e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width!==0},afterFillingValue:function(e,t){},checkSecurityOnAppClick:function(e,t,i){},setLoginData:function(e,t){},updateLoginData:function(e,t){},clearLoginData:function(e){},notInAppClickPage:function(e){},buildContextMenu:function(e){},fireEnterEvents:function(e,t,i){},promptWarningDiag:function(e,t){},checkMultiAccountApp:function(e){},sendMessageToSWSExtension:function(e,t){}},N.common.objectExtend(N.login.CentrifyBELoginBase,N.common.CentrifyBEBase),N.common.objectExtend(N.login.CentrifyBELoginBase,N.common.UI),N.communication.CentrifyWarnDiagBase=function(){N.common.CentrifyBEBase.call(this)},N.communication.CentrifyWarnDiagBase.prototype={loggerName:"WarnDiag",setToDefaultStyle:function(e){e=e.style;e.letterSpacing="normal",e.lineHeight="normal",e.textAlign="left",e.textDecoration="none",e.textIndent="0"},addDialog:function(e,t){var i=e.createElement("div"),n=(this.setToDefaultStyle(i),i.style.position="fixed",i.style.top="0%",i.style.left="0%",i.style.width="100%",i.style.height="100%",i.style.backgroundColor="#000000",i.style.backgroundSize="cover",i.style.opacity="0.5",i.style.msFilter="progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",i.style.filter="alpha(opacity=50)",i.style.zIndex="2147483647",i.style.overflow="hidden",e.body.appendChild(i),e.createElement("div")),o=(this.setToDefaultStyle(n),n.style.position="fixed",n.style.top="50%",n.style.left="50%",n.style.width="500px",n.style.marginLeft="-250px",n.style.marginTop="-175px",n.style.backgroundColor="#ffffff",n.style.backgroundSize="cover",n.style.zIndex="2147483647",n.style.overflow="hidden",n.style.boxShadow="-3px 5px 5px rgba(0, 0, 0, 0.2)",n.style.border="1px solid #cccccc",n.style.borderRadius="4px",n.style.lineHeight="normal",e.body.appendChild(n),e.createElement("div")),r=(this.setToDefaultStyle(o),o.style.position="relative",o.style.top="0%",o.style.height="66px",o.style.backgroundColor="#ffffff",o.style.borderBottom="1px solid #cccccc",o.style.borderRadius="4px 4px 0px 0px",o.style.verticalAlign="middle",n.appendChild(o),e.createElement("img")),r=(this.setToDefaultStyle(r),r.height=17,r.width=17,r.src=N.brand.closeDialogIcon,r.style.cursor="pointer",r.style.height="17px",r.style.width="17px",r.style.position="relative",r.style.cssFloat="right",r.style.margin="26px 18px 0px 0px",r.style.verticalAlign="baseline",r.onclick=function(){i.parentNode.removeChild(i),n.parentNode.removeChild(n)},o.appendChild(r),e.createElement("img")),r=(this.setToDefaultStyle(r),r.height=40,r.width=40,r.style.height="40px",r.style.width="40px",r.src=N.brand.svgColorIcon,r.style.position="relative",r.style.cssFloat="left",r.style.margin="13px 0px 0px 26px",r.style.verticalAlign="baseline",o.appendChild(r),e.createElement("div")),o=(this.setToDefaultStyle(r),r.innerHTML=N.brand.brandLabel,r.style.position="relative",r.style.display="inline",r.style.fontFamily="arial",r.style.fontSize="18px",r.style.fontWeight="bold",r.style.textDecoration="none",r.style.margin="22px 0px 0px 16px",r.style.cssFloat="left",o.appendChild(r),e.createElement("div")),s=(this.setToDefaultStyle(o),e.createElement("img")),r=(this.setToDefaultStyle(r),s.height=48,s.width=48,s.style.height="48px",s.style.width="48px",s.src=N.brand.warningIcon,s.style.position="relative",s.style.cssFloat="left",s.style.margin="20px 20px 0px 30px",s.style.verticalAlign="baseline",n.appendChild(s),o.innerHTML=t,o.style.fontFamily="arial",o.style.fontSize="14px",o.style.color="#444444",o.style.lineHeight="20px",o.style.margin="20px 30px 40px 100px",o.style.minHeight="34px",o.style.width="380px",n.appendChild(o),e.createElement("div")),s=(this.setToDefaultStyle(r),r.style.height="50px",r.style.verticalAlign="middle",r.style.textAlign="right",n.appendChild(r),e.createElement("button"));this.setToDefaultStyle(s),s.innerHTML="Cancel",s.style.borderRadius="4px",s.style.fontSize="13px",s.style.height="30px",s.style.cursor="pointer",s.style.textAlign="center",s.style.minWidth="70px",s.style.border="1px solid #d7d7d7",s.style.backgroundColor="#0280e5",s.style.color="#ffffff",s.style.marginBottom="20px",s.style.marginLeft="20px",s.style.marginRight="30px",s.onclick=function(){i.parentNode.removeChild(i),n.parentNode.removeChild(n)},s.onmouseover=function(){this.style.backgroundColor="#0172ce"},s.onmouseout=function(){this.style.backgroundColor="#0280e5"},r.appendChild(s),this.log("Warning Dialog is added, message is: "+t)}},N.common.objectExtend(N.communication.CentrifyWarnDiagBase,N.common.CentrifyBEBase),N.communication.CentrifyBESecuCheckBase=function(){N.common.CentrifyBEBase.call(this)},N.communication.CentrifyBESecuCheckBase.prototype={loggerName:"SecuCheck",isDocIgnore:function(e){return"about:blank"==e.URL},preCheckPage:function(e){!e||"#document"!=e.nodeName||null!=e.defaultView&&e.defaultView.top!==e.defaultView.self||this.isDocIgnore(e)},setBg:function(t,i,e,n,o){var r=["-webkit-","-moz-","-ms-","-o-"];try{for(var s=0;s<r.length;s++)if(t.style["backgroundImage"]=r[s]+"linear-gradient(top , "+i+", "+e+" 48%, "+n+" 52%, "+o+")",t.style["backgroundImage"])return}catch(e){t.style.filter="progid:DXImageTransform.Microsoft.gradient( startColorstr='"+i+"', endColorstr='"+o+"',GradientType=0 )"}},setToDefaultStyle:function(e){e=e.style;e.color="#444444",e.fontFamily="Open Sans, Verdana, Arial",e.letterSpacing="normal",e.lineHeight="normal",e.textAlign="left",e.textDecoration="none",e.textIndent="0px"},setChildPodValue:function(e){},checkIfAddDialog:function(e,t){var i=t.newChildPod.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");new RegExp("^https://"+i+"((/my[^/]+)|(/home[^/]*))","i").test(e.URL)&&(this.log("The current document matches the domain of the pod which we are prompting for."),this.addDialog(e,t))},addDialog:function(e,t,i){var n=this,o=!t.currChildPod,r=e.createElement("div"),s=(this.setToDefaultStyle(r),r.style.position="fixed",r.style.top="0%",r.style.left="0%",r.style.width="100%",r.style.height="100%",r.style.backgroundColor="#000000",r.style.backgroundSize="cover",r.style.opacity="0.5",r.style.msFilter="progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",r.style.filter="alpha(opacity=50)",r.style.zIndex="2147483647",r.style.overflow="hidden",e.createElement("div")),l=(this.setToDefaultStyle(s),s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.width="500px",s.style.marginLeft="-250px",s.style.marginTop="-175px",s.style.backgroundColor="#ffffff",s.style.backgroundSize="cover",s.style.zIndex="2147483647",s.style.overflow="hidden",s.style.boxShadow="-3px 5px 5px rgba(0, 0, 0, 0.2)",s.style.border="1px solid #cccccc",s.style.borderRadius="4px",s.style.lineHeight="normal",e.createElement("div")),a=(this.setToDefaultStyle(l),l.style.position="relative",l.style.top="0%",l.style.height="66px",l.style.backgroundColor="#ffffff",l.style.borderBottom="1px solid #cccccc",l.style.borderRadius="4px 4px 0px 0px",l.style.verticalAlign="middle",s.appendChild(l),e.createElement("img")),a=(this.setToDefaultStyle(a),a.height=17,a.width=17,a.src=N.brand.closeDialogIcon,a.style.cursor="pointer",a.style.height="17px",a.style.width="17px",a.style.position="relative",a.style.cssFloat="right",a.style.margin="26px 18px 0px 0px",a.style.verticalAlign="baseline",a.onclick=function(){r.parentNode.removeChild(r),s.parentNode.removeChild(s),n.promptParams=null},l.appendChild(a),e.createElement("img")),a=(this.setToDefaultStyle(a),a.height=40,a.width=40,a.style.height="40px",a.style.width="40px",a.src=N.brand.svgColorIcon,a.style.position="relative",a.style.cssFloat="left",a.style.margin="13px 0px 0px 26px",a.style.verticalAlign="baseline",l.appendChild(a),e.createElement("div")),l=(this.setToDefaultStyle(a),a.innerHTML=N.brand.brandLabel,a.style.position="relative",a.style.display="inline",a.style.fontFamily="arial",a.style.fontSize="18px",a.style.fontWeight="bold",a.style.textDecoration="none",a.style.margin="22px 0px 0px 16px",a.style.cssFloat="left",l.appendChild(a),e.createElement("div")),d=(this.setToDefaultStyle(l),i?t.newChildPod.masterShellTenant:t.newChildPod),a=(o?l.innerHTML="Would you like to sign in the "+N.brand.brandLabel+" Browser Extension for: <b>"+d+"</b>?<br><br>This will enable Single Sign On to your applications.":(c=e.createElement("img"),this.setToDefaultStyle(a),c.height=48,c.width=48,c.style.height="48px",c.style.width="48px",c.src=N.brand.warningIcon,c.style.position="relative",c.style.cssFloat="left",c.style.margin="20px 20px 0px 30px",c.style.verticalAlign="baseline",s.appendChild(c),l.innerHTML="Warning: the "+N.brand.brandLabel+" Browser Extension has detected a sign-in to <b>"+d+"</b>; you are currently or last signed in to <b>"+t.currChildPod+"</b>.<br><br>If this was intentional, click &quot;Sign In&quot;; if this was unexpected, click &quot;Cancel&quot; and contact your system administrator immediately."),l.style.fontFamily="arial",l.style.fontSize="14px",l.style.color="#444444",l.style.lineHeight="20px",l.style.margin="20px 30px 40px 30px",l.style.minHeight="34px",l.style.width="452px",s.appendChild(l),e.createElement("div")),c=(this.setToDefaultStyle(a),a.style.height="50px",a.style.verticalAlign="middle",s.appendChild(a),e.createElement("button")),d=(this.setToDefaultStyle(c),c.innerHTML="Sign In",c.style.borderRadius="4px",c.style.fontSize="13px",c.style.height="30px",c.style.marginBottom="20px",c.style.cursor="pointer",c.style.textAlign="center",c.style.minWidth="70px",c.onclick=function(){r.parentNode.removeChild(r),s.parentNode.removeChild(s),n.showPrompt=!1,n.promptParams=null,n.setChildPodValue(t.newChildPod,i)},e.createElement("button")),n=(this.setToDefaultStyle(d),d.innerHTML="Cancel",d.style.borderRadius="4px",d.style.fontSize="13px",d.style.height="30px",d.style.cursor="pointer",d.style.textAlign="center",d.style.minWidth="70px",d.onclick=function(){r.parentNode.removeChild(r),s.parentNode.removeChild(s),n.promptParams=null},o?(c.style.border="0px",c.style.backgroundColor="#0280e5",c.style.color="#ffffff",d.style.marginBottom="",c.style.marginLeft="30px",d.style.marginRight="",c.onmouseover=function(){this.style.backgroundColor="#0172ce"},c.onmouseout=function(){this.style.backgroundColor="#0280e5"},d.style.border="1px solid #d7d7d7",d.style.backgroundColor="#f0f0f0",d.style.color="#362f2d",d.style.marginBottom="20px",d.style.marginLeft="20px",d.style.marginRight="30px",d.onmouseover=function(){this.style.backgroundColor="#e4e4e4"},d.onmouseout=function(){this.style.backgroundColor="#f0f0f0"},a.appendChild(c),a.appendChild(d)):(c.style.border="1px solid #d7d7d7",c.style.backgroundColor="#f0f0f0",c.style.color="#362f2d",c.style.marginBottom="20px",c.style.marginLeft="20px",c.style.marginRight="30px",c.onmouseover=function(){this.style.backgroundColor="#e4e4e4"},c.onmouseout=function(){this.style.backgroundColor="#f0f0f0"},d.style.border="0px",d.style.backgroundColor="#0280e5",d.style.color="#ffffff",d.style.marginBottom="",d.style.marginLeft="30px",d.style.marginRight="",d.onmouseover=function(){this.style.backgroundColor="#0172ce"},d.onmouseout=function(){this.style.backgroundColor="#0280e5"},a.appendChild(d),a.appendChild(c)),this);l=r,o=s,n.log("Displaying prompt to change portal hostname"),e.body.appendChild(l),e.body.appendChild(o)}},N.common.objectExtend(N.communication.CentrifyBESecuCheckBase,N.common.CentrifyBEBase),N.login.CentrifyBEShadeBase=function(){N.common.CentrifyBEBase.call(this)},N.login.CentrifyBEShadeBase.prototype={loggerName:"Shade",shadeTimeout:1e4,captchaShadeTimeout:5e3,icon16:N.brand.captureUILogo,closeIcon:N.brand.closeDialogIcon,spinningImage:N.brand.processingIcon,hasSentRemoveQuest:!1,checkRootDocInterval:200,isDocIgnore:function(e){return"about:blank"==e.URL},preCheckPage:function(e){!e||"#document"!=e.nodeName||this.isDocIgnore(e)||this.checkIfAddShade(e)},setBg:function(t,i,e,n,o){var r=["-webkit-","-moz-","-ms-","-o-"];try{for(var s=0;s<r.length;s++)if(t.style["backgroundImage"]=r[s]+"linear-gradient(top , "+i+", "+e+" 48%, "+n+" 52%, "+o+")",t.style["backgroundImage"])return}catch(e){t.style.filter="progid:DXImageTransform.Microsoft.gradient( startColorstr='"+i+"', endColorstr='"+o+"',GradientType=0 )"}},setToDefaultStyle:function(e){e=e.style;e.letterSpacing="normal",e.lineHeight="normal",e.textAlign="left",e.textDecoration="none",e.textIndent="0"},addShade:function(e,t,i=!1){t=void 0===t||t;var n=e.createElement("div"),o=(this.setToDefaultStyle(n),n.id="centrify::login_shade.background",n.style.position="fixed",n.style.top="0%",n.style.left="0%",n.style.width="100%",n.style.height="100%",n.style.backgroundColor="#000000",n.style.backgroundSize="cover",n.style.opacity="0.5",n.style.msFilter="progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",n.style.filter="alpha(opacity=50)",n.style.zIndex="2147483647",n.style.overflow="hidden",e.body.appendChild(n),e.createElement("div")),r=(this.setToDefaultStyle(o),o.id="centrify::login_shade.messagebox",o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.width="370px",o.style.marginLeft="-185px",o.style.height="176px",o.style.marginTop="-88px",o.style.backgroundColor="#FFFFFF",o.style.backgroundSize="cover",o.style.zIndex="2147483647",o.style.overflow="hidden",o.style.boxShadow="0px 0px 15px #4c4c4c",e.body.appendChild(o),e.createElement("div")),r=(this.setToDefaultStyle(r),r.style.backgroundColor=N.brand.landCatchUIBarColor,r.style.position="relative",r.style.float="left",r.style.height="100%",r.style.width="8px",o.appendChild(r),e.createElement("div")),s=(this.setToDefaultStyle(r),r.style.position="relative",r.style.float="right",r.style.height="100%",r.style.width="362px",o.appendChild(r),e.createElement("div")),l=(this.setToDefaultStyle(s),s.style.position="relative",s.style.top="0%",s.style.height="60px",r.appendChild(s),e.createElement("img")),l=(this.setToDefaultStyle(l),l.height=40,l.width=40,l.style.height="40px",l.style.width="40px",l.src=this.icon16,l.style.position="relative",l.style.left="16px",l.style.top="16px",l.style.verticalAlign="baseline",s.appendChild(l),e.createElement("div")),l=(this.setToDefaultStyle(l),l.innerHTML="Signing In...",l.style.position="relative",l.style.top="3px",l.style.left="22px",l.style.display="inline",l.style.fontFamily="arial",l.style.fontSize="18px",l.style.textDecoration="none",l.style.color="#363A40",s.appendChild(l),e.createElement("img")),s=(this.setToDefaultStyle(l),l.height=12,l.width=12,l.style.height="12px",l.style.width="12px",l.src=this.closeIcon,l.style.position="relative",l.style.left="202px",l.style.top="-12px",l.style.cursor="pointer",l.title="Close",l.onclick=function(){n.parentNode.removeChild(n),o.parentNode.removeChild(o)},s.appendChild(l),e.createElement("img")),l=(this.setToDefaultStyle(s),s.height=45,s.width=45,s.style.height="45px",s.style.width="45px",s.src=this.spinningImage,s.style.position="relative",s.style.top="0px",s.style.left="50%",s.style.marginLeft="-22px",r.appendChild(s),e.createElement("div")),s=(this.setToDefaultStyle(l),l.innerHTML=i?"Fill in the CAPTCHA":"Please wait while you are signed in.",l.style.position="relative",l.style.top="16px",l.style.textAlign="center",l.style.fontFamily="arial",l.style.fontSize="16px",l.style.textDecoration="none",l.style.color="#363A40",r.appendChild(l),e.defaultView||window),r=t&&i?this.captchaShadeTimeout:this.shadeTimeout;t&&s.setTimeout(function(){try{n&&n.parentNode&&n.parentNode.removeChild(n),o&&o.parentNode&&o.parentNode.removeChild(o)}catch(e){}},r),this.log("shade is added")},checkSchema:function(e){switch(e.scheme){case N.login.SchemeEnum.httpHttps:case N.login.SchemeEnum.httpOnly:case N.login.SchemeEnum.https:case N.login.SchemeEnum.any:return!0;default:return!1}},checkIfCaptchaExists:function(t){if(t?.order&&Array.isArray(t.order))for(let e=0;e<t.order.length;e++)if(t.order[e][0]===N.login.LoginOrderEnum.captcha)return!0;return!1},shadeListenerHandler:function(e){var t=e.target;switch(e.data){case N.windowMessage.Frames.CBEClearRootShade:this.log("received clear root shade event"),t.removeEventListener("message",this.shadeListener,!1),this.removeShade(document);break;case N.windowMessage.Frames.CBEClearFrameTimer:this.timerID&&t.clearInterval(this.timerID);break;case N.windowMessage.Frames.CheckRootIsFrameSetRequest:e.source.postMessage(N.windowMessage.Frames.CBEClearFrameTimer,"*"),t&&t.document&&t.document.body&&"FRAMESET"==t.document.body.tagName&&e.source.postMessage(N.windowMessage.Frames.CheckRootIsFrameSetResponse,"*");break;case N.windowMessage.Frames.CheckRootIsFrameSetResponse:document.getElementById("centrify::login_shade.background")||this.addShade(document)}},removeShade:function(e){var t=e.getElementById("centrify::login_shade.background"),t=(t&&t.parentNode.removeChild(t),e.getElementById("centrify::login_shade.messagebox"));t&&t.parentNode.removeChild(t),null==e.defaultView||e.defaultView.top===e.defaultView.self||e.defaultView.top.window===e.defaultView.self||this.hasSentRemoveQuest||(this.log("remove shade is not from root, will notify root"),e.defaultView.top.postMessage(N.windowMessage.Frames.CBEClearRootShade,"*"),this.hasSentRemoveQuest=!0)},checkIfAddShadeCallBack:function(e,t){if(t){if(null!=e.defaultView)if(e.defaultView.top===e.defaultView.self||e.defaultView.top.window===e.defaultView.self){if(e.defaultView.top.addEventListener("message",this.shadeListener,!1),e.defaultView.top&&e.defaultView.top.document&&e.defaultView.top.document.body&&"FRAMESET"==e.defaultView.top.document.body.tagName)return void this.log("root document is FRAMESET, can not inject shade on root")}else{if(!t.iframeWhitelist||!e.URL.match(new RegExp(t.iframeWhitelist,"i")))return void this.log("url "+e.URL+" not matches "+t.iframeWhitelist);if(this.checkSchema(t))return e.defaultView.self.addEventListener("message",this.shadeListener,!1),void(this.timerID=setInterval(function(){e.defaultView.top.postMessage(N.windowMessage.Frames.CheckRootIsFrameSetRequest,"*")},this.checkRootDocInterval))}if(Array.isArray(t.fields)&&0!==t.fields.length){for(var i=0;i<t.fields.length;i++)if("username"===t.fields[i].name&&!t.fields[i].value||"password"===t.fields[i].name&&!t.fields[i].value)return;this.checkSchema(t)&&(this.shadeTimeout=void 0!==t.globalSelectorTimeout&&t.globalSelectorTimeout>this.shadeTimeout?t.globalSelectorTimeout:this.shadeTimeout,e.getElementById("centrify::login_shade.background")||"null"===self.origin||(this.checkIfCaptchaExists(t)?this.addShade(document,!0,!0):this.addShade(document)))}}},checkIfAddShade:function(e){},shadeListener:function(e){}},N.common.objectExtend(N.login.CentrifyBEShadeBase,N.common.CentrifyBEBase),N.communication.CentrifyBEVersionToHostBase=function(){N.common.CentrifyBEBase.call(this)},N.communication.CentrifyBEVersionToHostBase.prototype={acceptCallerExperiences:N.brand.acceptedExperiences,acceptCallerValue:N.brand.brandValue,acceptNoCaller:N.brand.acceptNullBrand,loggerName:"Version2Host",cbeVersion:"0.0.0",browserType:"",elementRequestName:"CentrifyRequestInfo",elementResponseName:"CentrifyExtensionInfo",elementMismatchName:"ExtensionExperienceMismatch",CentrifyExternalEventEnum:{infoRequest:"_CentrifyExtensionEvent-info-request",infoResponse:"_CentrifyExtensionEvent-info-response"},isCallerIgnore:function(e){var t="",e=e.getElementsByTagName(this.elementRequestName),e=0===e.length?!this.acceptNoCaller:(t=(responseElement=e[0]).getAttribute("brand"),experience=responseElement.getAttribute("experience"),-1===this.acceptCallerExperiences.indexOf(experience));return this.log("received a version inquiry, ignored = "+e+", brand = '"+t+", experience = '"+experience+"', acceptCallerValue ='"+this.acceptCallerValue+"', acceptCallerExperiences ='"+this.acceptCallerExperiences+"', acceptNoCaller = "+this.acceptNoCaller),{result:e,requestExperience:experience}},versionListener:function(e){var t,i,n;this.log("received as version inquiry"),this.isCallerIgnore(e).result?-1===this.acceptCallerExperiences.indexOf(experience)&&(0===(i=e.getElementsByTagName(this.elementMismatchName)).length?(t=e.createElement(this.elementMismatchName),e.documentElement.appendChild(t)):t=i[0],t.setAttribute("brand",N.brand.brandValue),this.fireCallbackEvent(e,t)):(0===(i=e.getElementsByTagName(this.elementResponseName)).length?(n=e.createElement(this.elementResponseName),e.documentElement.appendChild(n)):n=i[0],n.setAttribute("version",this.cbeVersion),n.setAttribute("debugMode",this.debugMode),n.setAttribute("browserType",this.browserType),n.setAttribute("brand",N.brand.brandValue),this.fireCallbackEvent(e,n),this.log("dispatch event for version inquiry"))},fireCallbackEvent:function(e,t){e=e.createEvent("HTMLEvents");e.initEvent(this.CentrifyExternalEventEnum.infoResponse,!0,!1),t.dispatchEvent(e)}},N.common.objectExtend(N.communication.CentrifyBEVersionToHostBase,N.common.CentrifyBEBase),N.communication.CentrifyBEMultiAccountCheckBase=function(){N.common.CentrifyBEBase.call(this)},N.communication.CentrifyBEMultiAccountCheckBase.prototype={acceptCallerValue:N.brand.brandValue,acceptNoCaller:N.brand.acceptNullBrand,loggerName:"MultiAccountCheck",elementRequestName:"CentrifyRequestMultiAccountCheck",CentrifyExternalEventEnum:{multiAccountCheckRequest:"_CentrifyExtensionEvent-multiAccountCheck-request",multiAccountCheckResponse:"_CentrifyExtensionEvent-multiAccountCheck-response"},isDocIgnore:function(e){return"about:blank"==e.URL},preCheckPage:function(e){!e||"#document"!=e.nodeName||null!=e.defaultView&&e.defaultView.top!==e.defaultView.self||this.isDocIgnore(e)},setBg:function(t,i,e,n,o){var r=["-webkit-","-moz-","-ms-","-o-"];try{for(var s=0;s<r.length;s++)if(t.style["backgroundImage"]=r[s]+"linear-gradient(top , "+i+", "+e+" 48%, "+n+" 52%, "+o+")",t.style["backgroundImage"])return}catch(e){t.style.filter="progid:DXImageTransform.Microsoft.gradient( startColorstr='"+i+"', endColorstr='"+o+"',GradientType=0 )"}},setToDefaultStyle:function(e){e=e.style;e.color="#444444",e.fontFamily="Open Sans, Verdana, Arial",e.letterSpacing="normal",e.lineHeight="normal",e.textAlign="left",e.textDecoration="none",e.textIndent="0px"},checkIfAddDialog:function(e,t){this.addDialog(e,t),this.notifyDialogAdded(e,!0)},addDialog:function(e,t){var i=this,n=e.createElement("div"),o=(this.setToDefaultStyle(n),n.style.position="fixed",n.style.top="0%",n.style.left="0%",n.style.width="100%",n.style.height="100%",n.style.backgroundColor="#000000",n.style.backgroundSize="cover",n.style.opacity="0.5",n.style.msFilter="progid:DXImageTransform.Microsoft.Alpha(Opacity=50)",n.style.filter="alpha(opacity=50)",n.style.zIndex="2147483647",n.style.overflow="hidden",e.body.appendChild(n),e.createElement("div")),r=(this.setToDefaultStyle(o),o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.width="500px",o.style.marginLeft="-250px",o.style.marginTop="-175px",o.style.backgroundColor="#ffffff",o.style.backgroundSize="cover",o.style.zIndex="2147483647",o.style.overflow="hidden",o.style.boxShadow="-3px 5px 5px rgba(0, 0, 0, 0.2)",o.style.border="1px solid #cccccc",o.style.borderRadius="4px",o.style.lineHeight="normal",e.body.appendChild(o),e.createElement("div")),s=(this.setToDefaultStyle(r),r.style.position="relative",r.style.top="0%",r.style.height="66px",r.style.backgroundColor="#ffffff",r.style.borderBottom="1px solid #cccccc",r.style.borderRadius="4px 4px 0px 0px",r.style.verticalAlign="middle",o.appendChild(r),e.createElement("img")),s=(this.setToDefaultStyle(s),s.height=17,s.width=17,s.src=N.brand.closeDialogIcon,s.style.cursor="pointer",s.style.height="17px",s.style.width="17px",s.style.position="relative",s.style.cssFloat="right",s.style.margin="26px 18px 0px 0px",s.style.verticalAlign="baseline",s.onclick=function(){n.parentNode.removeChild(n),o.parentNode.removeChild(o),i.promptParams=null},r.appendChild(s),e.createElement("img")),s=(this.setToDefaultStyle(s),s.height=40,s.width=40,s.style.height="40px",s.style.width="40px",s.src=N.brand.svgColorIcon,s.style.position="relative",s.style.cssFloat="left",s.style.margin="13px 0px 0px 26px",s.style.verticalAlign="baseline",r.appendChild(s),e.createElement("div")),r=(this.setToDefaultStyle(s),s.innerHTML=N.brand.brandLabel,s.style.position="relative",s.style.display="inline",s.style.fontFamily="arial",s.style.fontSize="18px",s.style.fontWeight="bold",s.style.textDecoration="none",s.style.margin="22px 0px 0px 16px",s.style.cssFloat="left",r.appendChild(s),e.createElement("div")),s=(this.setToDefaultStyle(r),r.innerHTML="You are attempting to sign in to <b>"+t.appName+"</b>.  You are currently logged into this application using another account.  We need to sign you out first.  Do you wish to continue?",r.style.fontFamily="arial",r.style.fontSize="14px",r.style.color="#444444",r.style.lineHeight="20px",r.style.margin="20px 30px 40px 30px",r.style.minHeight="34px",r.style.width="452px",o.appendChild(r),e.createElement("div")),l=(this.setToDefaultStyle(s),s.style.height="50px",s.style.verticalAlign="middle",o.appendChild(s),i.removeDialog=function(){n.parentNode.removeChild(n),o.parentNode.removeChild(o),i.notifyDialogAdded(e,!1)},e.createElement("button")),r=(this.setToDefaultStyle(l),l.innerHTML="Yes",l.style.borderRadius="4px",l.style.fontSize="13px",l.style.height="30px",l.style.marginBottom="20px",l.style.cursor="pointer",l.style.textAlign="center",l.style.minWidth="70px",l.onclick=function(){l.disabled=!0,l.innerHTML="...",i.signOutCurAccount(e,t.appkey)},e.createElement("button"));this.setToDefaultStyle(r),r.innerHTML="No",r.style.borderRadius="4px",r.style.fontSize="13px",r.style.height="30px",r.style.cursor="pointer",r.style.textAlign="center",r.style.minWidth="70px",r.onclick=function(){i.removeDialog(),i.responseUP(e,!1)},l.style.border="0px",l.style.backgroundColor="#0280e5",l.style.color="#ffffff",r.style.marginBottom="",l.style.marginLeft="30px",r.style.marginRight="",l.onmouseover=function(){this.style.backgroundColor="#0172ce"},l.onmouseout=function(){this.style.backgroundColor="#0280e5"},r.style.border="1px solid #d7d7d7",r.style.backgroundColor="#f0f0f0",r.style.color="#362f2d",r.style.marginBottom="20px",r.style.marginLeft="20px",r.style.marginRight="30px",r.onmouseover=function(){this.style.backgroundColor="#e4e4e4"},r.onmouseout=function(){this.style.backgroundColor="#f0f0f0"},s.appendChild(l),s.appendChild(r),this.log("Dialog is added")},removeDialog:function(){},getAppId:function(e){e=e.getElementsByTagName(this.elementRequestName);return 0===e.length?null:e[0].getAttribute("appKey")},multiAccountCheckListener:function(e){this.log("receive a multi account check request");var t=this.getAppId(e);null!=t&&this.checkMultiAccount(e,t)},responseUP:function(e,t){if(t){t=e.getElementsByTagName(this.elementRequestName);if(0===t.length)return null;t[0].setAttribute("countinue","true")}e.createEvent&&((t=document.createEvent("Events")).initEvent(this.CentrifyExternalEventEnum.multiAccountCheckResponse,!0,!1),e.dispatchEvent(t))},notifyDialogAdded:function(e,t){e=e.getElementsByTagName(this.elementRequestName);if(0===e.length)return null;e[0].setAttribute("isDialogAdded",t)},checkMultiAccount:function(e,t){},signOutCurAccount:function(e,t){}},N.common.objectExtend(N.communication.CentrifyBEMultiAccountCheckBase,N.common.CentrifyBEBase),N.formfill.Highlighter=function(e,t){N.common.CentrifyBEBase.call(this),this.username={ele:e.usernamePattern?this.querySelector(t,e.usernamePattern,e.version):null},this.password={ele:e.passwordPattern?this.querySelector(t,e.passwordPattern,e.version):null},this.corpId={ele:e.corpIdPattern?this.querySelector(t,e.corpIdPattern,e.version):null},this.submit={ele:e.submitPattern?this.querySelector(t,e.submitPattern,e.version):null},this.doc=t},N.formfill.Highlighter.prototype={loggerName:"Highlighter",overlay:null,activateOne:function(e){var t;e.ele&&(e===this.username?t="Username":e===this.password?t="Password":e===this.corpId?t="Additional field":e===this.submit&&(t="Submit"),e.originalBorder=e.ele.style.border,e.ele.style.border="1px dashed red",this.createArrow(this.doc,this.overlay,e.ele,N.brand.formFillArrow,t))},activate:function(){this.overlay||(this.overlay=this.createElement(this.doc,this.doc.body,"div"),this.overlay.id=N.formfill.InjectedElement.overlayID,this.overlay.className=N.formfill.InjectedElement.className,this.activateOne(this.username),this.activateOne(this.password),this.activateOne(this.corpId),this.activateOne(this.submit))},deactivate:function(){this.overlay&&(this.doc.body.removeChild(this.overlay),this.overlay=null,this.username.ele&&(this.username.ele.style.border=this.username.originalBorder),this.password.ele&&(this.password.ele.style.border=this.password.originalBorder),this.corpId.ele&&(this.corpId.ele.style.border=this.corpId.originalBorder),this.submit.ele)&&(this.submit.ele.style.border=this.submit.originalBorder)},toString:function(){return(this.username.ele?"U":"u")+(this.password.ele?"P":"p")+(this.corpId.ele?"C":"c")+(this.submit.ele?"S":"s")}},N.common.objectExtend(N.formfill.Highlighter,N.common.CentrifyBEBase),N.common.objectExtend(N.formfill.Highlighter,N.common.UI),N.formfill.PageCheckerBase=function(e){N.common.CentrifyBEBase.call(this),this.userSetting=e},N.formfill.PageCheckerBase.prototype={checkTimeoutMS:3e4,firstCheckTime:null,loggerName:"FFCheck",isVisibleOnPage:function(e,t){var i,t=t.defaultView||window,n=!0,o=!0;return!!e&&!!(i=t.getComputedStyle(e))&&(n="hidden"!=i.visibility,o=0<e.offsetWidth||0<e.offsetHeight,(i=n&&o)||this.logTrace("The element is not visible on page "+t.location+", form filling icon should not inject"),i)},filterAndSortLogin:function(e,t){var i=[];if(N.login.centrifyBELogin.userSetting?.enableNewFilterAndSortAlgorithm){for(var n=[],o=e.reduce((e,{app:t})=>{var i=e.findIndex(e=>e.usernamePattern===t.usernamePattern&&e.submitPattern===t.submitPattern&&e.formPattern===t.formPattern&&e.version===t.version);return-1===i?e.push({usernamePattern:t.usernamePattern,submitPattern:t.submitPattern,formPattern:t.formPattern,version:t.version,apps:[t]}):e[i].apps.push(t),e},[]),r=0;r<o.length;r++){var s=o[r],l=s.version,a=s.usernamePattern?this.nameQuerySelector(t,s.usernamePattern,l):null,d=s.submitPattern?this.querySelector(t,s.submitPattern,l):null,c=s.formPattern?this.querySelector(t,s.formPattern,l):null,p=0;this.isVisibleOnPage(a,t)&&(this.logTrace("username selector matches, score = "+(p=50)),d&&(p+=25,this.logTrace("submit button selector matches, score = "+p)),c&&(p+=25,this.log("form selector matches, score = "+p)),n.push({apps:s.apps,score:p}))}n.sort(function(e,t){return t.score-e.score}),n.forEach(t=>{i.push(...t.apps.map(e=>({app:e,score:t.score})))})}else{for(r=0;r<e.length;r++){var u=e[r].app,l=u.version,a=u.usernamePattern?this.nameQuerySelector(t,u.usernamePattern,l):null,d=u.submitPattern?this.querySelector(t,u.submitPattern,l):null,c=u.formPattern?this.querySelector(t,u.formPattern,l):null,p=0;this.logTrace("Start to evaluating the app matching score on current page:"+t.location.hostname+" against the app "+u.displayName+". Current score = "+p),this.isVisibleOnPage(a,t)&&(this.logTrace("username selector matches, score = "+(p=50)),d&&(p+=25,this.logTrace("submit button selector matches, score = "+p)),c&&(p+=25,this.log("form selector matches, score = "+p)),i.push({app:u,score:p})),this.log("app "+u.appkey+" has score "+p)}i.sort(function(e,t){return t.score-e.score})}return i},determineHowToFill:function(t,i,e,n,o){var r,s=null;return this.log("start FormFilling "+t.location.hostname+", apps.length "+i.length),this.firstCheckTime&&!o||(this.firstCheckTime=e),this.logTrace("commonC:checkpage: before getMatchApps, isFlagsReset = "+o+",  firstCheckTime = "+this.firstCheckTime),0<i.length?(0===(e=this.filterAndSortLogin(i,t)).length&&N.login.centrifyBELogin.userSetting.hasWpmEntitlement&&(e=N.formfill.GeneratePassword.findAndFilterCandidateApps(t,i),e=N.login.centrifyBELogin.userSetting.enableOldPasswordFillBasedOnPermissions?e.map(e=>(e.app.eventType="resetPassword",e)).filter(function(e){return e.app.hasOwnProperty("username")&&!(!1===e.app.CanViewCreds)}):e.map(e=>(e.app.eventType="resetPassword",e))),this.log("good apps = "+e.length),0<e.length?(s=(new Date).getTime(),this.announecCandidateApps(e,t)):(this.clearUI(!0,t),n&&(r=this,(t.defaultView||window).setTimeout(function(){var e=(new Date).getTime();e-r.firstCheckTime>r.checkTimeoutMS?r.log("Checking document "+t.location+" for more than "+r.checkTimeoutMS+" ms, will stop checking"):r.determineHowToFill(t,i,e,n)},N.login.centrifyBELogin.userSetting?.enableNewFilterAndSortAlgorithm?2e3:500)))):(this.log("sorry no matching"),this.clearUI(!0,t)),s},preCheckpage:function(e){return!0},checkpage:function(t,e,i){var n;t&&t.location&&t.location.hostname&&this.userSetting&&this.userSetting.isFormFillEnabled&&this.preCheckpage(t)&&(n=(new Date).getTime(),N.login.centrifyBELogin.userSetting?.enableSPNewUI?(N.v2.setUpInlineAutoFill(t),N.v2.eventbus.subscribe(N.communication.eventBusMessageEnum.START_LOGIN,e=>{N.formfill.appFormFiller.formfill(t,e,!1)})):this.getMatchApps(t,n,e,i))},checkpageEnd:function(e,t,i,n,o){e=this.determineHowToFill(t,e,i,n,o);null===e&&(e=(new Date).getTime()),this.log("PERF: "+(e-i)+"ms - "+t.location)},clearUI:function(e,t){N.login.centrifyBELogin.userSetting?.enableSPNewUI?N.v2.removeDropDowns():this.ffNotificationBox&&(t&&this.ffNotificationBox.doc&&this.ffNotificationBox.doc.location.href!=t.location.href?this.logTrace("CommonC.js:ClearUI(waitForDropdown, doc): ffNotificationBox does not belong to "+t.location.href+", don't clear it"):(e?(this.logTrace("Formfilling UI has already been created, will clear the UI"),this.ffNotificationBox.clearNotifer()):this.ffNotificationBox.deactivate(),delete this.ffNotificationBox))},disableUI:function(e){if(this.log("commonC.js: disableUI(message): connection offline, icon should be disabled"),N.login.centrifyBELogin.userSetting?.enableSPNewUI)N.v2.eventbus.publish(N.communication.eventBusMessageEnum.FORMFILL_DISABLE,!0);else if(this.ffNotificationBox)for(var t=this.ffNotificationBox,i=0;i<t.fieldEntrys.length;i++){var n=t.fieldEntrys[i];n.icon.src=N.brand.svgGrayIcon,n.status=N.formfill.FieldEntryInlineStatus.Disable}},enableUI:function(e){if(this.log("commonC.js: enableUI(message): connection connected, icon should be enabled"),N.login.centrifyBELogin.userSetting?.enableSPNewUI)N.v2.eventbus.publish(N.communication.eventBusMessageEnum.FORMFILL_DISABLE,!1);else if(this.ffNotificationBox)for(var t=this.ffNotificationBox,i=0;i<t.fieldEntrys.length;i++){var n=t.fieldEntrys[i];n.icon.src=N.brand.svgColorIcon,n.status=N.formfill.FieldEntryInlineStatus.Enable}},getAppByKey:function(e,t){for(var i=0;i<e.length;i++)if(e[i].app.appkey===t)return e[i].app;this.logError("can't find app with appkey "+t)},nameQuerySelector:function(e,t,i){try{var n;if("2.1"!=i)return(n=this.querySelector(e,t))&&n.tagName&&"input"==n.tagName.toLowerCase()?(this.logDebug("found username element by selector: "+t),n):null;for(var o,r=t.split(","),s=0;s<r.length;s++){var l=r[s];if((a=l,!RegExp("[a-zA-Z]+\\[type","g").test(a))&&((o=this.querySelector(e,l))&&o.tagName&&"input"==o.tagName.toLowerCase()))return this.logDebug("found username element by selector of LC app: "+l),o}return null}catch(e){throw this.log("querySelector: selectors = "+t),e}var a},announecCandidateApps:function(e,t){},getMatchApps:function(e,t,i,n){}},N.common.objectExtend(N.formfill.PageCheckerBase,N.common.CentrifyBEBase),N.formfill.FieldEntryInlineStatus={Enable:"Enable",Disable:"Disable"},N.formfill.FieldEntryInlineTemplate=function(e,t,i,n){this.doc=e,this.element=t,this.apps=[],this.positioners=[],this.posResetters=[],this.loginCallback=i,this.userSetting=n},N.formfill.FieldEntryInlineTemplate.prototype={iconImage64:N.brand.svgColorIcon,iconTransparentImage64:N.brand.svgTransparentIcon,iconImage64Disable:N.brand.svgGrayIcon,closeImage64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz5WSLYsCURiFn5lxdize4jY/mmhxGQXHJtgW67TJ28Wwv2D/hvk2i0FMBmGTeEEQEaMDN9nUMMpwt4yw2DzxPYcXzodljOGBKIp6wBcwyE4zYCylXD40ljGGKIpcYA50gDfAzfg7cANWwKeU8m5nxDwIgv5wOCxUKhUPsAG7Wq16o9Go0Ol0+tlDnMPh0AO+z+ez5/s++XwerTWu69LtdhFCsFgsrCRJ3ieTya/TbDZ/gI8kSXJxHBMEAWmaUiwWqdVqTKdTTqfTw4KXywy6AFprlFK0222MMSil0Fo/xC4wsHmCMYY0TQFwHOeZxs6iuwOUSiV832e9XqOUotVqUS6X+ZfYzAbGwE0IQRiGxHHMfr9nt9txPB4JwxAhBFm8YzsrZVWv141lWWy3W67XK5fLhc1mA0Cj0TDASkq5fLk469Vp/AGp9pPQdASLsAAAAABJRU5ErkJggg==",isDropdownShowing:!1,lastSelected:null,getAppListHeight:null,isVerifyPosition:!0,needClear:!1,status:N.formfill.FieldEntryInlineStatus.Enable,loginButtonText:"Go",fillOnly:!1,closeShade:null,content:null,createDropdownBox:function(t,e){var i,l=this;this.isDropdownShowing||(this.lastSelected=null,this.shadeTop=this.createElement(this.doc,t,"div",i={position:"absolute",background:"#000000",backgroundSize:"cover",opacity:"0.2",msFilter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=20)",filter:"alpha(opacity=20)","z-index":"2147483647",left:"0px",top:"0px",width:"0px",height:"0px"}),this.setStyle(this.shadeTop,{left:"0%",top:"0%"}),this.shadeTop.className=N.formfill.InjectedElement.className,this.shadeLeft=this.createElement(this.doc,t,"div",i),this.setStyle(this.shadeLeft,{left:"0%"}),this.shadeLeft.className=N.formfill.InjectedElement.className,this.shadeRight=this.createElement(this.doc,t,"div",i),this.shadeRight.className=N.formfill.InjectedElement.className,this.shadeBottom=this.createElement(this.doc,t,"div",i),this.setStyle(this.shadeBottom,{left:"0%"}),this.shadeBottom.className=N.formfill.InjectedElement.className,this.posResetters.push(function(){l.setStyle(l.shadeRight,{width:"0px"}),l.setStyle(l.shadeBottom,{height:"0px"})}),this.positioners.push(function(e,t,i,n,o,r){var s=n.top+t.top-e.top,e=(l.setStyle(l.shadeTop,{left:-i.left+"px",top:e.top-t.top+"px",width:l.doc.body.scrollWidth+"px",height:(s=0<s?s:0)+"px"}),n.left+i.left),t=(l.setStyle(l.shadeLeft,{left:-i.left+"px",top:n.top+"px",width:(e=0<e?e:0)+"px",height:n.height+"px"}),l.doc.body.scrollWidth-e-n.width);l.setStyle(l.shadeRight,{left:n.left+n.width+"px",top:n.top+"px",width:(0<t?t:0)+"px",height:n.height+"px"});e=Math.max(l.doc.defaultView.innerHeight,l.doc.body.offsetHeight,l.doc.documentElement.scrollHeight)-s-n.height;l.setStyle(l.shadeBottom,{left:-i.left+"px",top:n.top+n.height+"px",width:l.doc.body.scrollWidth+"px",height:(0<e?e:0)+"px"})}),this.dropdownBoxShadow=this.createElement(l.doc,t,"div",{position:"absolute","z-index":"2147483647","border-radius":"4px","box-shadow":"0px 3px 5px 0px rgba(0,0,0,0.50)",visibility:"hidden"}),this.dropdownBoxShadow.className=N.formfill.InjectedElement.className,this.dropdownBox=this.createElement(l.doc,null,"iframe",{position:"absolute","z-index":"2147483647",left:"0px",top:"-500px",height:"500px",visibility:"hidden"}),this.dropdownBox.className=N.formfill.InjectedElement.className,this.dropdownBox.onload=function(e){e=e.target.contentDocument;l.dropdownBoxOnLoad(t,e),l.isDropdownShowing=!0,l.positionAll()},this.positioners.push(function(e,t,i,n,o,r){l.setStyle(l.dropdownBox,{left:r.left+"px",top:r.top+"px",width:r.width+"px",height:r.height+"px",visibility:"visible"}),l.setStyle(l.dropdownBoxShadow,{left:r.left+"px",top:r.top+8+"px",width:r.width+"px",height:r.height-9+"px",visibility:"visible"})}),this.shadeTop.onclick=i=function(){l.removeInjectedUI(),l.positioners=[],l.posResetters=[],l.isDropdownShowing=!1,l.needClear&&e()},this.shadeLeft.onclick=i,this.shadeRight.onclick=i,this.shadeBottom.onclick=i,this.closeShade=i,t.appendChild(this.dropdownBox))},dropdownBoxOnLoad:function(v,C){function e(){var a,d,e,t=N.login.centrifyBELogin.userSetting.enableCompromisedPasswordCheckForIBE,i=t&&N.login.centrifyBELogin.userSetting.isCompromisedPwdLaunchDisabled;function n(){A.lastSelected&&A.lastSelected.style.removeProperty("background"),(A.lastSelected=this).style.setProperty("background","#D2E4F8"),c&&a&&d&&m?y(E,A.loginButtonText,{autoLoginCheckBox:a,autoLoginText:d,autoLoginHelptipImg:m}):y(E,A.loginButtonText);for(var e=null,t=0;t<A.apps.length;t++)if(A.apps[t].appIndex===A.lastSelected.appIndex){e=A.apps[t];break}void 0!==e.app.setting.isAutoLoginEnabled?e.app.setting.isAutoLoginEnabled:A.userSetting.defaultAutoLoginEnabled,a&&(e.app.setting.isAutoLoginEnabled?a.checked=!0:a.checked=!1)}function o(){A.lastSelected,this.style.setProperty("background","#E5E5E5")}function r(){A.lastSelected===this?this.style.setProperty("background","#D2E4F8"):this.style.removeProperty("background")}let c=N.login.centrifyBELogin.userSetting.autoLoginUXImprovement,s=T("div",I,{"overflow-x":"hidden","overflow-y":"auto","max-height":"200px",padding:"2px 4px 2px 4px"}),l=T("ul",s,{padding:"0px",margin:"0px","list-style-type":"none","-webkit-margin-before":"0px","-webkit-margin-after":"0px","-webkit-margin-start":"0px","-webkit-margin-end":"0px","-webkit-padding-start":"0px"});for(var p=0;p<A.apps.length;p++){var u=A.apps[p],h=T("li",l,{display:"flex","align-items":"center","border-top":"2px solid white","border-bottom":"2px solid white","box-sizing":"border-box",cursor:"pointer",height:"34px",padding:"0px 8px 0px 8px","white-space":"nowrap"}),g=(h.onclick=n,h.onmouseover=o,h.onmouseout=r,h.mShared=!1,T("div",h,{"flex-grow":"1",overflow:"hidden","text-overflow":"ellipsis"}));i&&u.app.IsPwdCompromised&&"resetPassword"!==u.app.eventType&&(g.style.opacity="0.4",h.onclick=null),t&&u.app.IsPwdCompromised&&T("img",h,{height:"22px",width:"22px","margin-left":"5px"},function(e){e.src="data:image/svg+xml;base64,77u/PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTVweCIgaGVpZ2h0PSIxNnB4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxnIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIDEgLTQwNiAtNDQwICkiPgogICAgPHBhdGggZD0iTSAwIDguMzA1NTIzODA5NTIzODA5ICBDIDAgMTIuNTEzMzcxNDI4NTcxNDI4ICAzLjM1Nzg2MjUgMTUuOTI0NTcxNDI4NTcxNDMgIDcuNSAxNS45MjQ1NzE0Mjg1NzE0MyAgQyAxMS42NDIxMDAwMDAwMDAwMDEgMTUuOTI0NTcxNDI4NTcxNDMgIDE1IDEyLjUxMzM3MTQyODU3MTQyOCAgMTUgOC4zMDU1MjM4MDk1MjM4MDkgIEMgMTUgNC4wOTc2MzgwOTUyMzgwOTUgIDExLjY0MjEwMDAwMDAwMDAwMSAwLjY4NjQ3NjE5MDQ3NjE5MDQgIDcuNSAwLjY4NjQ3NjE5MDQ3NjE5MDQgIEMgMy4zNTc4NjI1IDAuNjg2NDc2MTkwNDc2MTkwNCAgMCA0LjA5NzYzODA5NTIzODA5NSAgMCA4LjMwNTUyMzgwOTUyMzgwOSAgWiBNIDYuOTA2MDc1IDkuOTg3NTgwOTUyMzgwOTUyICBMIDYuOTA2MDc1IDQuMDUyMDc2MTkwNDc2MTkgIEMgNi45MDYwNzUgMy43MTg2NjY2NjY2NjY2NjY2ICA3LjE3MjA5OTk5OTk5OTk5OTUgMy40NDgzODA5NTIzODA5NTIgIDcuNTAwMyAzLjQ0ODM4MDk1MjM4MDk1MiAgQyA3LjgyODUgMy40NDgzODA5NTIzODA5NTIgIDguMDk0NiAzLjcxODY2NjY2NjY2NjY2NjYgIDguMDk0NiA0LjA1MjA3NjE5MDQ3NjE5ICBMIDguMDk0NiA5Ljk4NzU4MDk1MjM4MDk1MiAgQyA4LjA5NDYgMTAuMzIwOTkwNDc2MTkwNDc3ICA3LjgyODUgMTAuNTkxMjM4MDk1MjM4MDk1ICA3LjUwMDMgMTAuNTkxMjM4MDk1MjM4MDk1ICBDIDcuMTcyMDk5OTk5OTk5OTk5NSAxMC41OTEyMzgwOTUyMzgwOTUgIDYuOTA2MDc1IDEwLjMyMDk5MDQ3NjE5MDQ3NyAgNi45MDYwNzUgOS45ODc1ODA5NTIzODA5NTIgIFogTSA3LjUwMDE1IDExLjQ1Mzk0Mjg1NzE0Mjg1OCAgQyA3Ljg4NzAwMDAwMDAwMDAwMDUgMTEuNDUzOTQyODU3MTQyODU4ICA4LjIwMDU3NSAxMS43NzI0OTUyMzgwOTUyMzcgIDguMjAwNTc1IDEyLjE2NTQ4NTcxNDI4NTcxNCAgQyA4LjIwMDU3NSAxMi41NTg0ICA3Ljg4NzAwMDAwMDAwMDAwMDUgMTIuODc2OTUyMzgwOTUyMzggIDcuNTAwMTUgMTIuODc2OTUyMzgwOTUyMzggIEMgNy4xMTMzNzUwMDAwMDAwMDA0IDEyLjg3Njk1MjM4MDk1MjM4ICA2Ljc5OTggMTIuNTU4NCAgNi43OTk4IDEyLjE2NTQ4NTcxNDI4NTcxNCAgQyA2Ljc5OTggMTEuNzcyNDk1MjM4MDk1MjM3ICA3LjExMzM3NTAwMDAwMDAwMDQgMTEuNDUzOTQyODU3MTQyODU4ICA3LjUwMDE1IDExLjQ1Mzk0Mjg1NzE0Mjg1OCAgWiAiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0iI2ZmMDAwMCIgc3Ryb2tlPSJub25lIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAxIDQwNiA0NDAgKSIgLz4KICA8L2c+Cjwvc3ZnPg==",e.title=N.util.getResource("compromised_pwd_help_text")}),u.app.isSharedAccout?(g.textContent=u.app.displayName,T("img",h,{height:"27px",width:"27px","margin-left":"5px"},function(e){e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIAQMAAACXljzdAAAABlBMVEX///8AAABVwtN+AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAHdElNRQfgBw8AFzATicleAAABd0lEQVRYw+2VQZKEIAxFtVyw5AgcxaPZR+ujeASXLCwyEgMkQWrG6a7qmSqyQevJ5xNJGIYePXr0eD2mQA/LU5EZVhwN7IoAeBwdgBIDOOUWAClnAeBxjOMxboIcIvjtMZdkiwFAC+YYpYWFvo1zg7JWiDAXF0aVqIpWmOlTJaoK20iAVAUxgqxqo1Ef1xNbbRNH+ud6/i1kJY9eJbSQ/YPE/oKYP0jSXzBv+XPphEw3zk77JLZJ+8S3q2QQpFlzoargjezvVdWn2vY/7BQmLay2g9/uacGH7mIbyQbVxUzahRLr8X+jeWc5OufVLTOlc17Vwkynuar6Kb3iFD7JkfpZwHylVLaOCIhaXFOVcjlHL1Mmnl1/0bTNJLDyjWTOhOpBXmXAWoKl+SMjW2l7ISUAWBoWerSMhLzPSBwjUKz5nLRiLvdBDjALhsyMgqy5H24sNzLBmviqi/MNfU9sRZZLEhhxt8nzgsBNAp10Ul3RPXr06HEdX/IKd0QwuWgIAAAAAElFTkSuQmCC"})):g.textContent=u.app.username,h.appIndex=u.appIndex,(void 0!==u.app.setting.isAutoLoginEnabled?u.app.setting.isAutoLoginEnabled&&i&&!u.app.IsPwdCompromised:A.userSetting.defaultAutoLoginEnabled)&&(e=void 0===e?h:null)}var m,f,y,b,x=null!==A.content,w=T("div",I,x?{}:{height:"50px","border-top":"1px "+S+" solid"});x?w.appendChild(A.content()):(A.fillOnly||(T("div",w,{float:"left",display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-left":"10px"},function(e){T("input",e,{height:"20px",width:"20px",margin:"0px"},function(e){(a=e).id="autoLoginCheckBox",e.type="checkbox"})}),T("div",w,{float:"left",display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-left":"5px"},function(e){d=T("label",e,{color:"#444444"},function(e){e.innerHTML="Auto Login",e["for"]=a.id})}),x=T("div",w,{float:"left",display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-left":"5px"}),m=T("img",x,{height:"16px",width:"16px"},function(t){var i;t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGN0JGRjI5NTA2MzIxMUU0OTNGMEJEMDQxMzJBQkU4QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGN0JGRjI5NjA2MzIxMUU0OTNGMEJEMDQxMzJBQkU4QiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkY3QkZGMjkzMDYzMjExRTQ5M0YwQkQwNDEzMkFCRThCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY3QkZGMjk0MDYzMjExRTQ5M0YwQkQwNDEzMkFCRThCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+MJvKEgAAANNJREFUeNpi/P//PwMlgAVETJs2DVnMBIh9gNgBiHWhYpeB+AAQbwHiMzCFWVlZEAOQQDoQ5wGxFpq4PRSHAvEkIJ6J4gIkzV1AzIfHxVpQNQwwQ5iQnJ2HrjkuLg6M0QAfVK0JsgE+WJzNQMAlPshecMCmatGiRfgMcUA2QBddFtnpOAzSRfYCqbbDARNSPJMKLiMbcIAMAw4gGwBKYddwhQGWqLwG1QMPxDPQFAZPSHjC4BNU7Rn0lAhLnnl40sQ1fEkZZshZYjMTCDBSmp0BAgwAGlo1ls0BRxsAAAAASUVORK5CYII=",t.onmouseover=function(){var e;i||(i=T("div",v,{width:"330px",background:"rgba(90,90,90,0.9)","border-radius":"5px",color:"#FFFFFF",position:"absolute","z-index":"2147483647","font-size":"12px",padding:"20px 25px"},function(e){e.innerHTML="Enabling the option will automatically sign you in using the selected account the next time you visit this app."}),e=A.findPosition(t),A.setStyle(i,{left:C.defaultView.frameElement.offsetLeft+e.left-i.offsetWidth/2+t.offsetWidth/2+"px",top:C.defaultView.frameElement.offsetTop+e.top-i.offsetHeight+"px"}))},t.onmouseout=function(){i&&(i.parentNode.removeChild(i),i=null)}}),T("div",w,{float:"left",display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-left":"5px"},function(e){})),f=function(e,t,i){var n,o,r;c&&i&&({autoLoginCheckBox:n,autoLoginText:o,autoLoginHelptipImg:r}=i,n)&&o&&r&&b(i,!0),e&&(e.disabled=!0,e.style.setProperty("background","#88C3EF"),t)&&(e.innerHTML=t)},y=function(e,t,i){var n,o,r;c&&i&&({autoLoginCheckBox:n,autoLoginText:o,autoLoginHelptipImg:r}=i,n)&&o&&r&&b(i,!1),e&&(e.disabled=!1,e.style.setProperty("background","linear-gradient(#1589DD,#0280E5)"),t)&&(e.innerHTML=t)},b=function(e,t){var i,n;c&&e&&({autoLoginCheckBox:e,autoLoginText:i,autoLoginHelptipImg:n}=e,e)&&i&&n&&(e.disabled=t,e.hidden=t,i.hidden=t,n.hidden=t)},T("div",w,{float:"right",display:"flex","flex-direction":"column","justify-content":"center",height:"100%","margin-right":"10px"},function(e){E=T("button",e,{background:"#88C3EF",border:"0px",padding:"0px",height:"30px",width:"60px","border-radius":"3px",color:"white","font-size":"13px",cursor:"pointer"},function(s){c&&a&&d&&m?f(s,A.loginButtonText,{autoLoginCheckBox:a,autoLoginText:d,autoLoginHelptipImg:m}):f(s,A.loginButtonText);var l=null;s.onclick=function(){if(s.disabled||(c&&a&&d&&m?f(s,"...",{autoLoginCheckBox:a,autoLoginText:d,autoLoginHelptipImg:m}):f(s,"...")),A.lastSelected){if(!A.fillOnly){for(var e=[],t=0;t<A.apps.length;t++){var i=A.apps[t],n=void 0!==i.app.setting.isAutoLoginEnabled?i.app.setting.isAutoLoginEnabled:A.userSetting.defaultAutoLoginEnabled,o=i.appIndex==A.lastSelected.appIndex&&a.checked;n!=o&&(n={appkey:i.app.appkey,ALupdate:{isAutoLoginEnabled:o}},e.push(n),i.app.setting.isAutoLoginEnabled=o)}Object.keys(e).length&&A.updateAutoLoginSetting(e)}var r;A.loginCallback(A.lastSelected.appIndex,A.apps,!1),null===l&&((l=T("div",v,{width:"180px",background:"rgba(225,0,0,0.9)",color:"#FFFFFF",position:"absolute","z-index":"2147483647","font-size":"14px",padding:"10px 10px","border-radius":"5px",overflow:"hidden","text-overflow":"ellipsis",visibility:"hidden"})).innerHTML="Please Log in into "+N.brand.brandLabel+" Cloud First",r=A.findPosition(E),A.setStyle(l,{left:C.defaultView.frameElement.offsetLeft+r.left-l.offsetWidth/2+E.offsetWidth/2+"px",top:C.defaultView.frameElement.offsetTop+r.top-l.offsetHeight+"px"}));addEventListener("_CentrifyExtensionEvent-failGetCFAevent",function(){A.setStyle(l,{background:"rgba(225,0,0, 0.9)",visibility:"visible"}),l.style.visibility="visible",setTimeout(function(){var e=9,t=setInterval(function(){e<=1&&(l.style.visibility="hidden",clearInterval(t)),e-=1,A.setStyle(l,{background:"rgba(225,0,0, 0."+e+")"})},80)},2e3)})}A.fillOnly&&A.closeShade()}})}),e&&a&&(a.checked=!0,n.call(e)))}var E,t,A=this,i="#FFFFFF",n="#FFFF99",S="#999999",T=(C.body.style.color="#444444",C.body.style.fontFamily="Arial",C.body.style.fontSize="16px",C.body.style.margin="0px",function(e,t,i,n){var o=C.createElement(e);if(i)for(var r in i)o.style.setProperty(r,i[r]);return n&&n(o),t.appendChild(o),o}),o=T("div",C.body,{},function(e){e.id="mainDiv"}),I=T("div",o,{width:"100%",background:i,position:"absolute",border:"1px "+S+" solid","border-radius":"4px",top:"8px","box-sizing":"border-box"},function(e){e.id="rectangleDiv",A.getAppListHeight=function(){return e.offsetHeight}}),l=T("svg",o,{position:"absolute"},function(e){e.width=16,e.height=9,A.status==N.formfill.FieldEntryInlineStatus.Enable?e.innerHTML="<svg width='16' height='9'><polyline fill='"+i+"' stroke='"+S+"' points='0,9 8,0 16,9'/></svg>":e.innerHTML="<svg width='16' height='9'><polyline fill='"+n+"' stroke='"+S+"' points='0,9 8,0 16,9'/></svg>"});this.positioners.push(function(e,t,i,n,o,r){var s=0;n.width>r.width&&(s=n.width-r.width),l.style.setProperty("left",o.left-n.left-s+(o.width/2-8)+"px")});this.status==N.formfill.FieldEntryInlineStatus.Enable?e():(o=N.ui.menuItemLabel.noInternetConnection,t=T("div",I,{height:"35px","border-top":"1px "+n+" solid","background-color":n,"border-radius":"4px"}),T("p",t,{"text-align":"Left","margin-left":"10px","margin-right":"5px","margin-top":"8px","margin-bottom":"5px","font-family":"Arial","font-size":"16px"}).innerHTML=o)},createUI:function(t,i,e=!1){var n=this;this.icon=this.createElement(this.doc,t,"img",{position:"absolute","z-index":"2147483646",cursor:"pointer",width:"0px",height:"0px"}),this.overlay=t,this.status===N.formfill.FieldEntryInlineStatus.Enable?this.icon.src=1==e?this.iconTransparentImage64:this.iconImage64:this.icon.src=this.iconImage64Disable,this.icon.className=N.formfill.InjectedElement.className,this.icon.onclick=function(e){e.stopPropagation(),n.createDropdownBox(t,i)},this.positionAll(i)},removeInjectedUI:function(){this.dropdownBox&&this.dropdownBox.parentNode&&this.dropdownBox.parentNode.removeChild(this.dropdownBox),this.shadeTop&&this.shadeTop.parentNode&&this.shadeTop.parentNode.removeChild(this.shadeTop),this.shadeLeft&&this.shadeLeft.parentNode&&this.shadeLeft.parentNode.removeChild(this.shadeLeft),this.shadeRight&&this.shadeRight.parentNode&&this.shadeRight.parentNode.removeChild(this.shadeRight),this.shadeBottom&&this.shadeBottom.parentNode&&this.shadeBottom.parentNode.removeChild(this.shadeBottom),this.dropdownBoxShadow&&this.dropdownBoxShadow.parentNode&&this.dropdownBoxShadow.parentNode.removeChild(this.dropdownBoxShadow)},setInlineIconVisibility:function(e){this.icon&&(e?this.setStyle(this.icon,{visibility:"visible"}):this.setStyle(this.icon,{visibility:"hidden"}))},isUsernameField:function(e){return!!e.type&&"radio"!==e.type&&"checkbox"!==e.type&&!e.readonly&&!e.disabled},positionAll:function(e){if(this.doc.body.contains(this.element)&&this.isElementVisiable(this.element)&&this.isUsernameField(this.element)){this.setInlineIconVisibility(!0);for(var t=0;t<this.posResetters.length;t++)this.posResetters[t]();var i=this.doc.body.getBoundingClientRect(),n=this.overlay.getBoundingClientRect(),o=this.findPosition(this.overlay),r=this.element.getBoundingClientRect(),s={left:r.left-n.left,top:r.top-n.top},r=(s.width=this.element.offsetWidth,s.height=this.element.offsetHeight,this.doc.defaultView.getComputedStyle(this.element)),l=function(e){if(e){e=e.match(/^([\d\.]+)px$/);if(e)return parseFloat(e[1])}return 0},l=(s.border={top:l(r.borderTopWidth),right:l(r.borderRightWidth),bottom:l(r.borderBottomWidth),left:l(r.borderLeftWidth)},s.padding={top:l(r.paddingTop),right:l(r.paddingRight),bottom:l(r.paddingBottom),left:l(r.paddingLeft)},s.height-s.border.top-s.border.bottom),r=.9*l,a={left:s.left+s.width-r-s.border.right-.1*l,top:s.top+l/2+s.border.top-r/2,width:r,height:r},d=this.isDropdownShowing?(l=0,400<(r=s.width)?(l=r-400,r=400):r<255&&(r=255),{left:s.left+l,top:a.top+a.height,width:r,height:this.getAppListHeight()+9}):{left:void 0,top:void 0,width:void 0,height:void 0};this.setStyle(this.icon,{left:a.left+"px",top:a.top+"px",width:a.width+"px",height:a.height+"px"});for(t=0;t<this.positioners.length;t++)this.positioners[t](i,n,o,s,a,d);this.isVerifyPosition&&((l=this.findPosition(this.element)).width=this.element.offsetWidth,l.height=this.element.offsetHeight,s.left==l.left)&&s.top==l.top&&s.width==l.width&&l.height}else this.removeInjectedUI(),this.setInlineIconVisibility(!1)},isSameHtmlElement:function(e){return this.element===e},updateAutoLoginSetting:function(e){}},N.common.objectExtend(N.formfill.FieldEntryInlineTemplate,N.common.UI),N.formfill.FieldEntryInlineBase=function(e,t,i,n){N.formfill.FieldEntryInlineTemplate.call(this,e,t,i,n);var o=this;this.setResetFill=function(){o.loginButtonText="Fill",o.fillOnly=!0,N.landcatch.monitor.passwordResetExisitingInputs.includes(t)||N.landcatch.monitor.passwordResetExisitingInputs.push(t)}},N.formfill.FieldEntryInlineBase.prototype={},N.common.objectExtend(N.formfill.FieldEntryInlineBase,N.formfill.FieldEntryInlineTemplate),N.formfill.createElements={},N.formfill.createElements.addStylesToElements=function(e,t){for(var[i,n]of Object.entries(t))if(i.endsWith(":hover"))N.formfill.createElements.HoverStyleToMouseover(e,i,n);else{var o,r=e.querySelectorAll(i);0===r.length&&console.warn("No elements match style for matcher",i);for(o of r)for(var[s,l]of Object.entries(n))o.style[s]=l}},N.formfill.createElements.HoverStyleToMouseover=function(e,t,l){t=t.slice(0,-6);e=e.querySelectorAll(t);0===e.length&&console.warn("No elements match hover style for matcher",t);for(let s of e){let i={},n={};for(var[a,d]of Object.entries(l))i[a]=s.style[a],n[a]=d;let o=null,r=null;"function"==typeof s.onmouseover&&(o=s.onmouseover),"function"==typeof s.onmouseleave&&(r=s.onmouseleave),s.onmouseover=function(){null!==o&&o();for(var[e,t]of Object.entries(n))s.style[e]=t},s.onmouseleave=function(){null!==r&&r();for(var[e,t]of Object.entries(i))s.style[e]=t}}},N.formfill.GeneratePassword=function(){N.common.CentrifyBEBase.call(this)},N.formfill.GeneratePassword.prototype={consts:{AppKeyNewPasswordMatcher:"newPasswordPattern",AppKeyConfirmPasswordMatcher:"newPasswordConfirmPattern",AppKeyCurrentPasswordMatcher:"currentPasswordPattern",InputsKeyCurrent:"current",InputsKeyNew:"new"},searchForInputs:function(t){var n=t.querySelectorAll("input[type='password']");if(3===n.length||2===n.length){var o=[...n];let i=[...n];var r,n=this.consts.InputsKeyCurrent,s=this.consts.InputsKeyNew,l=["id","name","classname","placeholder"],a={[s]:[],[n]:[]};let e=!1;for(r of[{keywords:["confirm","reenter","retype","repeat","check","password2","cmf"],type:s,isConfirm:!0},{keywords:["cur","verify","old","existing"],type:n},{keywords:["new"],type:s}].values())e:for(let i of r.keywords.values())for(let t of l.values()){var d=o.findIndex(e=>e[t]?.toLowerCase().includes(i));if(0<=d){a[r.type].push({el:o.splice(d,1)[0],how:`attr:${t}|keyword:`+i}),r.isConfirm&&(e=!0);break e}}if(1===o.length&&a[0===a[n].length&&!e||2===a[s].length?n:s].push({el:o.splice(0,1)[0],how:"leftover"}),0<o.length)console.error("could not determine which inputs to use to change password",o);else{for(var c in a)a[c]=a[c].map(e=>e.el).sort((e,t)=>i.indexOf(e)-i.indexOf(t));if(0!==a[s].length)return this.toCSSSelectors(t,a);console.error("no input found for generating passwords")}}},findAndFilterCandidateApps:function(t,e){if(0<e.filter(e=>{e=e.app[this.consts.AppKeyNewPasswordMatcher];return!!e&&0!==t.querySelectorAll(e).length}).length)return e;let i=this.searchForInputs(t);return void 0!==i?e.map(e=>this.toCandidateApp(e,i)):[]},getCSSSelector:function(e){let t=e.tagName.toLowerCase();for(var i=e.attributes,n=0;n<i.length;n++){var o=i.item(n);if(!o.value.includes("[")){if("id"===o.name)return"#"+o.value;"class"===o.name&&(t+=o.value.trim().split(" ").filter(e=>!e.startsWith("ng-")).map(e=>"."+e).join("")),"name"===o.name&&(t+=`[${o.name}=${o.value}]`)}}return t},toCSSSelectors:function(i,e){for(var t in e)e[t]=e[t].map(e=>{var e=this.getCSSSelector(e),t=i.querySelectorAll(e);return 0===t.length&&console.warn("could not find generated selector: "+e),1<t.length&&console.warn("generated selector found more than one element: "+e),e});return e},toCandidateApp:function(e,t){return(e=null===e?{app:{setting:{}},score:"75"}:e).app[this.consts.AppKeyNewPasswordMatcher]=t[this.consts.InputsKeyNew][0],1<t[this.consts.InputsKeyNew].length&&(e.app[this.consts.AppKeyConfirmPasswordMatcher]=t[this.consts.InputsKeyNew][1]),0<t[this.consts.InputsKeyCurrent].length&&(e.app[this.consts.AppKeyCurrentPasswordMatcher]=t[this.consts.InputsKeyCurrent][0]),e}},N.common.objectExtend(N.formfill.GeneratePassword,N.common.CentrifyBEBase),N.formfill.GeneratePassword=new N.formfill.GeneratePassword,N.formfill.createElements.passwordGenerator=function(i,e,n){let t=e;this.state={passMinLength:8,passMaxLength:64,passwordConfig:{uppercase:!0,lowercase:!0,symbols:!0,numbers:!0,length:16,type:"Password"}},this.createElement=function(){return t.apply(this,arguments)};for(let[e,t]of Object.entries(N.crossover.genpass))t instanceof Function&&(this[e]=function(){return t.apply(this,arguments)});this.setState=({passwordConfig:e,passMinLength:t,passMaxLength:i})=>{this.state.passwordConfig=e,t&&(this.state.passMinLength=t),i&&(this.state.passMaxLength=i)},this.props={showDetails:"none",getGeneratePasswordConfig:()=>this.state.passwordConfig,setGeneratePasswordConfig:e=>{this.state.passwordConfig=e},fillPasswordOnClick:e=>{for(var t of n){t=document.querySelector(t);t&&(t.value=e,N.login.centrifyBELogin.triggerInputChangeEvents(document,t))}i.closeShade()}},this.passwordLengthMax=64,this.passwordLengthMin=8,this.passwordStengthLevelMax=4;var e="undefined"!=typeof browser?browser?.extension?.getURL(""):`chrome-extension://${chrome?.runtime?.id}/`,o=e+"popover/images/copy-password-icon.svg",e=e+"popover/images/refresh.svg",o={".applications-header":{"background-color":"#ffffff","vertical-align":"middle",display:"flex"},".genpass-button":{width:"40%",height:"30px",margin:"10px 10px 10px 10px","border-radius":"16.5px",border:"solid 1px #1362cb","user-select":"none","-webkit-user-select":"none",cursor:"pointer","text-align":"center","font-weight":500,"font-size":"14px","background-color":"#1362cb",color:"#ffffff"},".appsPanelHead":{height:"44px","background-color":"#ffffff","vertical-align":"middle",display:"flex"},".refresh-button":{height:"20px",width:"20px",color:"#BDBDBA","background-color":"#ffffff",border:"none","border-radius":"none",padding:"0px","text-align":"center",cursor:"pointer"},".refresh-button:hover":{"background-color":"#FFFFFF",color:"#0381E4"},".applications-label.genpass-label":{"padding-top":"5px","padding-left":"5px",height:"24px","font-size":"14px","font-weight":600,color:"#2f3564"},".appsPanelHead.genpass-panel-head":{height:"30px","margin-left":"20px","border-bottom":"1px solid #dedfe4"},".genpass-password":{width:"60%",height:"20px",border:"none",padding:"0"},".password-strength-container":{"margin-top":"7px"},"#password-strength-meter":{height:"8px",width:"60%",display:"block","background-color":"#ccc","margin-left":"20px","border-radius":"6.5px",float:"left","margin-top":"7px"},"#password-strength-meter .password-strength":{display:"block",height:"8px","border-radius":"6.5px",transition:"all 500ms ease"},".password-strength":{"background-color":"green",width:"100%"},"#password-strength-indicator-wrapper":{height:"18px"},"#password-strength-indicator":{margin:"5px 9px 0px 9px","font-size":"13px","font-weight":"600",color:"#0f9861"},".copy-refresh-buttons-container":{overflow:"hidden","margin-left":"17.5px"},".copy-password-wrapper":{float:"left"},".copy-password-wrapper .refresh-button":{width:"18px"},".copy-password-icon":{width:"18px",height:"20px","background-color":"#616161","-webkit-mask-position":"center","mask-position":"center","-webkit-mask-repeat":"no-repeat","mask-repeat":"no-repeat","mask-image":`url("${o}")`,"-webkit-mask-image":`url("${o}")`},".copy-password-icon:hover":{"background-color":"#088486"},".refresh-btn-div-wrapper.refresh-genpass-wrapper":{width:"20px",height:"20px",margin:"0px 0px 0px 35px","padding-left":"initial",overflow:"hidden"},".genpass-customize-banner":{height:"20px","margin-top":"17px","background-color":"#ffffff","vertical-align":"middle",display:"flex"},".genpass-customize-label":{"padding-left":"20px","font-size":"14px","font-weight":"600",color:"#2f3564"},".genpass-config-panel":{"margin-top":"9.5px","margin-left":"20px","background-color":"#f6f6f6",display:"flex","flex-flow":"row wrap","max-width":"80%","margin-bottom":"8px"},".genpass-checkboxes":{"margin-left":"15px",float:"left"},".genpass-upper-checkbox":{"padding-top":"8px"},".genpass-lower-checkbox":{"padding-bottom":"8px"},".genpass-config-checkbox":{width:"16px",height:"16px"},".genpass-config-label":{"font-size":"14px","padding-left":"8px"},".genpass-length-container":{width:"156px",overflow:"hidden","padding-top":"13px","padding-left":"33px"},".genpass-length-label":{"font-size":"14px"},".genpass-range-container":{"padding-top":"15px"},".genpass-range-div":{float:"left","padding-top":"10px"},".genpass-range-scroll":{width:"77px",height:"6px"},".genpass-numeric-length-div":{"padding-left":"12.5px",overflow:"hidden"},".genpass-numeric-length":{width:"37.1px",height:"30px",border:"none","border-bottom":"1px solid #dedfe4",background:"#f6f6f6","text-align":"center"},".refresh-icon":{width:"20px",height:"20px","background-color":"#616161","-webkit-mask-position":"center","mask-position":"center","-webkit-mask-repeat":"no-repeat","mask-repeat":"no-repeat","mask-image":`url("${e}")`,"-webkit-mask-image":`url("${e}")`},".refresh-icon:hover":{"background-color":"#088486"}},e=this.genpassComponentInline();return N.formfill.createElements.addStylesToElements(e,o),t("div",{id:"idaptive-genpass-box"},e)},N.formfill.FieldEntryInlineGeneratePassword=function(e,t,i,n,o){N.formfill.FieldEntryInlineTemplate.call(this,e,t,i,n);let r=this.hyperscriptCreateElement;this.content=()=>r("div",{style:"display: flex; flex-direction: column; justify-content: center; height: 100%; margin-left: 5px;"},N.formfill.createElements.passwordGenerator(this,r,o))},N.formfill.FieldEntryInlineGeneratePassword.prototype={},N.common.objectExtend(N.formfill.FieldEntryInlineGeneratePassword,N.formfill.FieldEntryInlineTemplate),N.formfill.FFInlineNotiferBase=function(e,t,i){N.common.CentrifyBEBase.call(this),this.fieldEntrys=[],this.mapAppToEntry(e,t,i),this.doc=t},N.formfill.FFInlineNotiferBase.prototype={loggerName:"FFInlineNotifer",updateThreadInterval:1e3,overlay:null,updateThread:null,mapAppToEntry:function(n,o,r){for(var s=this,l=function(e,t,i){for(var n,o=null,r=0;r<t.length;r++)if(t[r].appIndex===e){o=t[r];break}o?(n=o.app,s.log("the selected app: "+n.displayName+", appkey: "+n.appkey+", fillOnly: "+i),s.login(n,i)):s.logError("The selected app has been removed")},a=-1!==this.fieldEntrys.findIndex(e=>e instanceof N.formfill.FieldEntryInlineGeneratePassword),d=0;d<n.length;d++){let e=n[d].app,t=n[d].app.eventType,i=e.usernamePattern;"resetPassword"===t&&(i=e[N.formfill.GeneratePassword.consts.AppKeyCurrentPasswordMatcher]);for(var c,p=this.querySelector(o,i,e.version),u=null,h=0;h<this.fieldEntrys.length;h++)if(this.fieldEntrys[h].isSameHtmlElement(p)){u=this.fieldEntrys[h];break}null===u&&(u=new N.formfill.FieldEntryInline(o,p,l,r),this.fieldEntrys.push(u)),"resetPassword"===t&&(u.setResetFill(),a||(c=[e[N.formfill.GeneratePassword.consts.AppKeyNewPasswordMatcher],e[N.formfill.GeneratePassword.consts.AppKeyConfirmPasswordMatcher]],p=this.querySelector(o,e[N.formfill.GeneratePassword.consts.AppKeyNewPasswordMatcher],e.version),c=new N.formfill.FieldEntryInlineGeneratePassword(o,p,null,r,c),this.fieldEntrys.push(c),N.landcatch.monitor.sendLandCatchEvent({type:N.landcatch.monitor.bhTypeEnum.forceLoginDataValues,data:{passwordGenerated:a=!0}}))),u.isDropdownShowing&&(u.removeInjectedUI(),u.isDropdownShowing=!1),u.apps.push({app:e,appIndex:d})}},activate:function(){if(!this.overlay){for(var t=this,e=!1,i=(this.overlay=this.createElement(this.doc,this.doc.body,"div",{position:"relative"}),this.overlay.id=N.formfill.InjectedElement.overlayID,this.overlay.className=N.formfill.InjectedElement.className,function(){t.deactivate()}),n=0;n<this.fieldEntrys.length;n++)this.fieldEntrys[n].createUI(this.overlay,i,e=1==n?!0:e);var o=this.doc.defaultView||window,r=function(){try{for(var e=0;e<t.fieldEntrys.length;e++)t.fieldEntrys[e].positionAll(i)}catch(e){t.logError("repositionAll: "+e),t.updateThread&&o.clearInterval(t.updateThread),o.removeEventListener("resize",this)}};0<this.updateThreadInterval&&(this.updateThread=o.setInterval(r,this.updateThreadInterval)),this.windowResizeListner=r,o.addEventListener("resize",this.windowResizeListner)}},deactivate:function(){var e;this.overlay&&(e=this.doc.defaultView||window,this.doc.body.removeChild(this.overlay),this.overlay=null,this.updateThread&&e.clearInterval(this.updateThread),this.windowResizeListner)&&e.removeEventListener("resize",this.windowResizeListner)},updateNotifer:function(e,t,i){this.logTrace("start to update Notification Box");for(var n=0;n<this.fieldEntrys.length;n++)this.fieldEntrys[n].apps=[],this.logTrace("fieldEntry: "+n+"has been cleaned");this.logTrace("start to re-map Apps to fieldEntry"),this.mapAppToEntry(e,t,i)},clearNotifer:function(){for(var e=0;e<this.fieldEntrys.length;e++){var t=this.fieldEntrys[e];t.isDropdownShowing&&(this.logTrace("Dropdown box is showing, remove formfilling UI after cancel the Dropdown box"),t.needClear=!0,t.removeInjectedUI())}this.deactivate(),this.logTrace("Formfilling UI has been removed")},login:function(e,t){}},N.common.objectExtend(N.formfill.FFInlineNotiferBase,N.common.CentrifyBEBase),N.common.objectExtend(N.formfill.FFInlineNotiferBase,N.common.UI),N.i18n.UI={get:function(e){return e},getFormat:function(){var i=arguments;if(!i||i.length<2)throw"wrong arguments";return this.get(i[0]).replace(/{(\d+)}/g,function(e,t){t=parseInt(t);return isNaN(t)||void 0===i[t+1]?e:i[t+1]})}},N.landcatch.CaptureLogBase=function(e){this.doc=e,this.logs=[],this.html=e.documentElement.outerHTML},N.landcatch.CaptureLogBase.prototype={toData:function(){var e="\0CaptureHTML\n"+encodeURI(this.html)+"\n";return this.generateDiagnosticData(e)},generateDiagnosticData:function(e){}},N.landcatch.CaptureUIBase=function(e,t,i,n){N.common.CentrifyBEBase.call(this),N.common.UI.call(this),this.doc=e,this.userSetting=t,this.captureLog=i,this.detectedApp="object"==typeof n&&null!==n?n:{},this.appDetail={name:null,description:null,url:null,icon:null,usernameField:null,passwordField:null,corpIdField:null,submitField:null,formField:null,formAction:null,version:"2"},this.defaultStyle["color"]="#444444",this.defaultStyle["font-size"]="16px"},N.landcatch.CaptureUIBase.prototype={loggerName:"LandCatchUI",LANDCATCH_WIZARD_LAYER_ID:"centrify::landcatch.wizardLayer",LANDCATCH_WIZARD_ID:"centrify::landcatch.wizard",LANDCATCH_WIZARD_Class:"centrify_landcatch_wizardClass",logo:N.brand.captureUILogo,radioButtonSpriteSheet:N.brand.radioButtons,moreInfoFlag:!1,loadUIDelay:500,helpToolTipIcon:N.brand.helpTipTool,categories:{Other:"_I18N_AppCategory_Other",Collaboration:"_I18N_AppCategory_Collaboration",Communication:"_I18N_AppCategory_Communication",CRM:"_I18N_AppCategory_CRM","Customer Service":"_I18N_AppCategory_Customer_Service",Education:"_I18N_AppCategory_Education",ERP:"_I18N_AppCategory_ERP",Finance:"_I18N_AppCategory_Finance",Government:"_I18N_AppCategory_Government","Health Care":"_I18N_AppCategory_Health_Care",HR:"_I18N_AppCategory_HR","IT and Administration":"_I18N_AppCategory_IT_and_Administration",Marketing:"_I18N_AppCategory_Marketing","News and Research":"_I18N_AppCategory_News_and_Research","Product Management":"_I18N_AppCategory_Product_Management",Productivity:"_I18N_AppCategory_Productivity","Project Management":"_I18N_AppCategory_Project_Management",Sales:"_I18N_AppCategory_Sales",Security:"_I18N_AppCategory_Security","Social Media":"_I18N_AppCategory_Social_Media","Software Development":"_I18N_AppCategory_Software_Development",Travel:"_I18N_AppCategory_Travel"},tags:{},defaultIconSize:60,wizardHeight:226,wizardsQueue:[],init:function(){this.wizardFrameLayer=this.createElement(this.doc,this.doc.body,"iframe",{position:"absolute",height:"230px","min-width":"512px",top:"20px",right:"0px","border-spacing":"0px",border:"0px","z-index":"2147483647",overflow:"hidden",visibility:"visible"}),this.wizardFrameLayer.id=this.LANDCATCH_WIZARD_LAYER_ID,this.loadIframe(this.wizardFrameLayer)},initFrame:function(o){var x=this,w=(this.moreInfoFlag=!1,o);function v(e,t,i){e=e,i=i,(e=x.createElement(w,w.body,"div",{position:"absolute",top:e+"px",right:t+"px",width:"470px",height:i+"px","border-spacing":"0px",border:"0px","z-index":"2147483647","box-shadow":"0 2px 4px 0 rgba(0,0,0,0.50)","line-height":"normal",overflow:"hidden","background-color":"#FFFFFF",opacity:0,display:"none",margin:"0px"})).id=x.LANDCATCH_WIZARD_ID,e.className=x.LANDCATCH_WIZARD_Class,x.landcatch_wizard=e,x.wizardHeight=i;t=e,x.createElement(w,t,"div",{float:"left",width:"8px",height:"100%","background-color":N.brand.landCatchUIBarColor}),i=x.createElement(w,t,"div",{height:"100%",display:"block"}),e=x.createElement(w,i,"div",{height:"auto",width:"100%",margin:"0px 0px 0px 0px",display:"block"});e.id="CBEWizTopRow",x.createElement(w,e,"img",{height:"48px",width:"48px",margin:"16px 0px 10px 19px","vertical-align":"middle"}).src=x.logo;x.createElement(w,e,"span",{margin:"16px 0px 5px 4px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400","font-size":"18px","vertical-align":"-7px","line-height":"21px","user-select":"none",width:"315px",height:"22px"}).id="CBEWizTopRow_Title";e=x.createElement(w,e,"img",{float:"right",height:"12px",width:"12px",cursor:"pointer",margin:"18px 18px 0px 0px"});e.src=N.brand.closeDialogIcon,e.onclick=function(){x.ignoreDetectedApp(x.detectedApp),x.onUnload()};x.createElement(w,i,"div",{height:"auto",width:"100%",margin:"0px 0px 0px 0px",display:"block"}).id="CBEWizMidRow";e=x.createElement(w,i,"div",{height:"auto",width:"100%",margin:"24px 0px 0px 0px",display:"block"});e.id="CBEWizBtmRow",x.createElement(w,e,"button",{display:"inline",margin:"0px 0px 10px 24px"}),x.createElement(w,e,"button",{display:"inline",margin:"0px 0px 10px 7px"}),x.createElement(w,e,"button",{display:"inline",margin:"0px 35px 10px 10px",float:"right"});return t}function C(e){return e.querySelector("span#CBEWizTopRow_Title")}function E(e){return e.querySelector("div#CBEWizMidRow")}function A(e){return e.querySelector("div#CBEWizBtmRow")}function S(e){return A(e).childNodes[0]}function T(e){return A(e).childNodes[1]}function I(e){return A(e).childNodes[2]}function F(e){x.setStyle(e,{"background-color":"#0381E4",color:"#FFFFFF","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400"}),e.onmouseover=function(){x.setStyle(e,{"background-color":"#0172ce"})},e.onmouseout=function(){x.setStyle(e,{"background-color":"#0381E4"})}}function k(e){x.setStyle(e,{"background-color":"#FDFDFD",color:"#50545A","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400"}),e.onmouseover=function(){x.setStyle(e,{"background-color":"#e4e4e4"})},e.onmouseout=function(){x.setStyle(e,{"background-color":"#FDFDFD"})}}function L(e){e.disabled=!1,x.setStyle(e,{"border-radius":"3px",border:"1px solid #d7d7d7","font-size":"13px","min-width":"60px",width:"81px",height:"33px","text-align":"center","box-shadow":"1px 1px 0 0 #E3E3E3",cursor:"pointer"})}function D(e){x.wizardsQueue.push(e),2<x.wizardsQueue.length&&x.wizardsQueue.shift()}function a(t,e){function i(e){e.success?(x.log("Success: "+JSON.stringify(e.Result)),N.common.toast.showSuccess(N.util.getResource("updated"))):(x.logError("Failed: "+e.Message),N.common.toast.showError(e.Message,!0))}function n(e){var t=e.statusCode,e=e.msg;x.logWarn("There is an error when submitting a captured app. "+e),N.common.toast.showError(200==t?e:401==t?"Unable to submit application.  You must be signed in.":null===t?"A network error has occurred.  Please try again later.":"An unknown error has occurred.  Please try submitting the application again.")}function o(){N.common.toast.showLoading("Please wait..."),x.userSetting.isEnabledLCEnhancement?N.util.updateUserCreds(e,t):N.common.encryption.encryptPasswordInPayload(e,x.centrifyServiceRequest,!0).then(e=>{x.centrifyServiceRequest("/uprest/UpdateCapturedCreds?appkey="+t,e,"post",i,n)})}function r(e){N.common.toast.clearMessage(!0),e.Result?x.userSetting.isCompromisedPwdSaveEnabled?N.common.messageBox.showWarning(N.util.getResource("compromised_pwd_warning_title"),N.util.getResource("compromised_pwd_warning_desc"),[N.util.getResource("save_compromised_pwd"),N.util.getResource("cancel")],[function(){o(),N.common.messageBox.clearMessage(!0)},function(){N.common.messageBox.clearMessage()}]):N.common.messageBox.showWarning(N.util.getResource("compromised_pwd_warning_title"),N.util.getResource("compromised_pwd_error_desc"),[N.util.getResource("close")],[function(){N.common.messageBox.clearMessage()}]):o()}N.common.toast.showLoading("Please wait..."),x.userSetting.enableCompromisedPasswordCheckForIBE&&x.userSetting.enabledCompromisedChangeFix?(x.log("Checking Compromised Status of the captured app"),N.util.getCompromisedPasswordStatus(e.Password,r)):x.userSetting.enableCompromisedPasswordCheckForIBE?N.util.checkCompromisedPasswordStatus(e.Password,r):o(),x.ignoreDetectedApp(x.detectedApp)}function r(e,t,i){var n=v(e,t,i),e=(x.setStyle(n,{display:"block"}),D(n),A(n));x.setStyle(e,{margin:"24px 0px 0px 0px"});C(n).innerHTML="Add this site to your User Portal?";var t=E(n),o=x.userSetting.enablePrivilegedApps,i=x.createElement(w,t,"div",{height:"auto",width:"100%",margin:"0px 0px 0px 0px",display:"block"}),r=x.createElement(w,i,"input",{"background-color":"#FFFFFF",color:"#363A40","font-size":"13px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400",width:"311px",height:"26px","border-radius":"3px",border:"1px solid #d7d7d7",margin:"0px 0px 0px 24px",padding:"2px 8px 2px 8px"}),e=(r.value=x.detectedApp.name+" - "+x.getTrimedUsername(x.detectedApp.usernameValue),x.createElement(w,i,"div",{display:"inline",cursor:"pointer"})),s=x.createElement(w,e,"img",{height:"8px",width:"8px",margin:"0px 0px 0px 18px"});s.src=N.brand.arrowRight;x.createElement(w,e,"span",{color:"#363A40",margin:"0px 0px 0px 9px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"700","font-size":"14px"}).innerHTML="More",e.onclick=function(){x.moreInfoFlag=!x.moreInfoFlag,x.moreInfoFlag?(s.src=N.brand.arrowDown,x.setStyle(x.wizardFrameLayer,{height:"370px"}),x.setStyle(c,{display:"block"}),x.setStyle(u,{display:"block"}),o&&x.setStyle(l,{display:"block"}),x.setStyle(n,{height:"370px"}),x.wizardHeight=370):(s.src=N.brand.arrowRight,x.setStyle(x.wizardFrameLayer,{height:"204px"}),x.setStyle(c,{display:"none"}),x.setStyle(u,{display:"none"}),o&&x.setStyle(l,{display:"none"}),x.setStyle(n,{height:"194px"}),x.wizardHeight=194)};var l,a,d,c=x.createElement(w,t,"div",{height:"auto",width:"100%",margin:"0px 0px 0px 0px",display:"none"}),p=x.createElement(w,c,"textarea",{"background-color":"#FFFFFF",color:"#363A40","font-size":"13px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400","line-height":"16px",width:"392px",height:"64px",resize:"none","border-radius":"3px",border:"1px solid #d7d7d7",margin:"16px 0px 0px 24px",padding:"3px 8px 3px 8px",overflow:"visible","overflow-x":"hidden","overflow-y":"visible","white-space":"pre-wrap"}),u=(p.placeholder="Add a description...",x.createElement(w,t,"div",{height:"auto",width:"100%",margin:"14px 0px 0px 0px",display:"none"})),h=x.createElement(w,u,"img",{width:"50px",height:"50px",border:"1px solid #d7d7d7","border-radius":"2px","vertical-align":"top",margin:"0px 0px 0px 24px",display:"inline",overflow:"hidden"}),g=(x.detectedApp.icon?h.src=x.detectedApp.icon:h.src=N.brand.genericBEIcon,x.createElement(w,u,"input",{opacity:"0",width:"1px",height:"1px",margin:"0px 10px 10px 5px",float:"right"})),i=(g.type="file",g.onchange=function(e){var t,e=e.target.files[0];e&&(h.src=null,(t=new FileReader).onload=function(e){var i=x.doc.createElement("img");i.crossOrigin="Anonymous",i.onload=function(){var e=x.doc.createElement("canvas"),t=e.getContext("2d"),t=(e.height=x.defaultIconSize,e.width=x.defaultIconSize,t.drawImage(i,0,0,x.defaultIconSize,x.defaultIconSize),e.toDataURL());1e6<t.length?(m.innerHTML="Invalid image",h.src=N.brand.genericBEIcon):h.src=t},i.onerror=function(){m.value="Invalid image"},i.src=e.target.result},t.readAsDataURL(e))},x.createElement(w,u,"button",{display:"inline",margin:"0px 10px 10px 5px"})),m=(L(i),k(i),i.innerHTML="Upload",i.onclick=function(){g.click()},x.createElement(w,u,"span",{"font-size":"12px"})),f=(o&&(l=x.createElement(w,t,"div",{height:"auto",width:"100%",margin:"10px 0px 0px 0px",display:"none"}),a=x.createElement(w,l,"input",{height:"20px",width:"20px",margin:"5px 0px 0px 24px"}),x.removeStyle(a,{"-moz-appearance":"none"}),a.id="safeCheckbox",a.type="checkbox",e=N.util.getResource("pCloud_safe_text"),(i=x.createElement(w,l,"label",{margin:"7px -221px 0px 50px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"200","font-size":"14px",float:"left"})).id="PCLOUD_TEXT",i.setAttribute("for",a.id),w.getElementById(i.id).innerHTML=e,(d=x.createElement(w,l,"img",{height:"18px",width:"18px",margin:"-11px 0px 0px 160px","vertical-align":"middle"})).src=x.helpToolTipIcon,d.id="helpTooltip",x.createElement(w,l,"div",{display:"none",width:"250px",background:"rgba(90,90,90,0.9)","border-radius":"5px",color:"#FFFFFF",position:"absolute","z-index":"2147483647","font-size":"12px",padding:"10px 15px"}).id="toolTipDiv",d.onmouseover=function(){var e=w.getElementById("toolTipDiv"),t=w.getElementById(d.id);e.style.top=t.offsetTop+10+"px",e.style.left=t.offsetLeft+10+"px",e.style.display="block",e.innerHTML=N.util.getResource("pCloud_tooltip_text")},d.onmouseout=function(){w.getElementById("toolTipDiv").style.display="none"}),S(n)),y=(f.innerHTML="Yes",L(f),F(f),T(n)),b=(y.innerHTML="No",L(y),k(y),I(n));b.innerHTML="Never",L(b),k(b),f.onclick=function(){f.disabled=!0,x.detectedApp.name=r.value.trim(),x.detectedApp.description=p.value,h.src&&h.src!=N.brand.genericBEIcon?x.detectedApp.icon=h.src:delete x.detectedApp["icon"],x.userSetting.enablePrivilegedApps&&(e=!!a.checked,x.detectedApp.isSafeSelected=e)&&(x.detectedApp.usernameValue="",x.detectedApp.passwordValue=""),x.remove();var e,t=JSON.parse(JSON.stringify(x.detectedApp));function i(){N.common.toast.showLoading("Please wait..."),x.userSetting.isEnabledLCEnhancement?N.util.createDetectedPersonalApp(t):N.common.encryption.encryptPasswordInPayload(t,x.centrifyServiceRequest,!0).then(e=>{x.centrifyServiceRequest("/uprest/CreateDetectedPersonalApp",e,"post",function(e){e.success?(x.log("Successfully Created personal app, appkey = "+e.Result.appKey),N.common.toast.showSuccess(N.util.getResource("added"))):(x.logError("Failed to create personal app "+e.Message),N.common.toast.showError(e.Message,!0))},function(e){e=e.msg;x.logWarn("There is an error when submitting a captured app. "+e),N.common.toast.showError(e)})})}function n(e){N.common.toast.clearMessage(!0),e.Result?x.userSetting.isCompromisedPwdSaveEnabled?N.common.messageBox.showWarning(N.util.getResource("compromised_pwd_warning_title"),N.util.getResource("compromised_pwd_warning_desc"),[N.util.getResource("save_compromised_pwd"),N.util.getResource("cancel")],[function(){i(),N.common.messageBox.clearMessage(!0)},function(){N.common.messageBox.clearMessage()}]):N.common.messageBox.showWarning(N.util.getResource("compromised_pwd_warning_title"),N.util.getResource("compromised_pwd_error_desc"),[N.util.getResource("close")],[function(){N.common.messageBox.clearMessage()}]):i()}t.appkey=N.util.GUID.prototype.generateGuidV4(),t.version="2.1",delete t["relatedApps"],N.common.toast.showLoading("Please wait..."),x.userSetting.enableCompromisedPasswordCheckForIBE&&x.userSetting.enabledCompromisedChangeFix?N.util.getCompromisedPasswordStatus(t.passwordValue,n):x.userSetting.enableCompromisedPasswordCheckForIBE?N.util.checkCompromisedPasswordStatus(t.passwordValue,n):i(),x.ignoreDetectedApp(x.detectedApp)},y.onclick=function(){y.disabled=!0,x.ignoreDetectedApp(x.detectedApp),x.onUnload()},b.onclick=function(){b.disabled=!0,x.ignoreDetectedApp(x.detectedApp,!0),x.onUnload()}}if(x.doc2=o,this.setStyle(w.body,{margin:"0px",padding:"0px"}),Array.isArray(x.detectedApp.relatedApps)||(x.detectedApp.relatedApps=[]),0<x.detectedApp.relatedApps.length){x.log("found related apps, show the choose update or create UI");{let e="You already have an account for this site...",t="Would you like to <b>Update</b> your existing account or <b>Add</b> this as a new account?",i=x.userSetting.enablePrivilegedApps,n=x.detectedApp.passwordGenerated&&!x.detectedApp.usernameValue;n&&(e="We noticed you changed your password...",t="Would you like to <b>Update</b> your account?<br><br>"),i&&n&&(x.detectedApp.relatedApps=x.detectedApp.relatedApps.filter(e=>!e.isPrivilegedApp));for(var o=v(0,0,222),s=(D(o),A(o)),l=(x.setStyle(s,{margin:"43px 0px 0px 0px"}),C(o).innerHTML=e,!i||(s=!!n&&0<x.detectedApp.relatedApps.length,!n)||s?x.setStyle(o,{display:"block"}):x.setStyle(o,{display:"none"}),E(o));l.firstChild;)l.removeChild(l.firstChild);x.createElement(w,l,"div",{height:"auto",width:"338px",margin:"0px 10px 0px 32px",display:"block","font-size":"16px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400"}).innerHTML=t;var d,c=S(o),p=(L(c),k(c),x.setStyle(c,{width:"91px"}),c.innerHTML=N.util.getResource("update"),c.onclick=function(){if(x.log("update the app"),c.disabled=!0,1<x.detectedApp.relatedApps.length){x.log("found more than 1 app, user need to choose");for(var e=v(0,20,x.wizardHeight),t=(D(e),x.setStyle(e,{display:"block"}),A(e)),i=(x.setStyle(t,{margin:"26px 0px 0px 0px"}),C(e).innerHTML="You have "+x.detectedApp.relatedApps.length+" accounts for this site...",E(e));i.firstChild;)i.removeChild(i.firstChild);x.createElement(w,i,"div",{margin:"0px 10px 0px 32px","font-size":"14px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400",color:"#363A40","line-height":"13px"}).innerHTML="Please select the account to update";var n=x.createElement(w,i,"select",{"background-color":"#F9F9F9",margin:"8px 10px 10px 32px",width:"392px",color:"#363A40","font-size":"13px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400",height:"26px","border-radius":"3px",border:"1px solid #d7d7d7",padding:"2px 5px 2px 5px"});x.removeStyle(n,{"-moz-appearance":"none"});for(var o=0;o<x.detectedApp.relatedApps.length;o++){var r=x.createElement(w,n,"option",{"font-size":"13px","font-family":"BE Open Sans, Arial, sans-serif","font-weight":"400"});r.text=x.detectedApp.relatedApps[o].displayName,n.add(r)}var s=S(e),l=(L(s),F(s),x.setStyle(s,{width:"91px"}),s.innerHTML=N.util.getResource("update"),s.onclick=function(){s.disabled=!0;var e=x.detectedApp.relatedApps[n.selectedIndex],t={Username:x.detectedApp.usernameValue,Password:x.detectedApp.passwordValue};a(e.appkey,t),x.remove()},T(e)),t=(L(l),k(l),x.setStyle(l,{width:"91px"}),l.innerHTML="Cancel",l.onclick=function(){l.disabled=!0,x.ignoreDetectedApp(x.detectedApp),x.onUnload()},I(e));x.setStyle(t,{display:"none"}),x.transitToNewPage()}else 1===x.detectedApp.relatedApps.length?(x.log("directly update"),e=x.detectedApp.relatedApps[0],t={Username:x.detectedApp.usernameValue,Password:x.detectedApp.passwordValue},a(e.appkey,t),x.remove()):x.log("update shoud not be called for 0 apps")},n||(L(d=T(o)),k(d),x.setStyle(d,{width:"91px"}),d.innerHTML=N.util.getResource("add"),d.onclick=function(){d.disabled=!0,r(0,20,226),x.transitToNewPage()}),I(o));L(p),k(p),p.innerHTML="Not Now",p.onclick=function(){p.disabled=!0,x.ignoreDetectedApp(x.detectedApp),x.onUnload()}}}else x.log("no related apps, show the create app UI"),r(0,0,226);setTimeout(function(){x.onLoad()},x.loadUIDelay)},removeFrame:function(){var e=document.getElementById(this.LANDCATCH_WIZARD_LAYER_ID);e&&this.doc.body.removeChild(e)},trimToLength:function(e,t){return e.length<t?e:e.substr(0,t-3)+"..."},getTrimedUsername:function(e){if(e){var t=e.indexOf("@");if(-1<t)return e.substring(0,t)}return e},shmGetPos:function(e){var t={X:0,Y:0};if(e)if(void 0!==e.offsetLeft)for(t={X:e.offsetLeft,Y:e.offsetTop};e=e.offsetParent;)t.X+=e.offsetLeft,t.Y+=e.offsetTop;else if(void 0!==e.pageX)t={X:e.pageX,Y:e.pageY};else if(void 0!==e.clientX)throw"whatsthis";return t},unloadLinearFunc1:function(e){return Math.round(462-e)},unloadLinearFunc2:function(e){return Math.round(20-e)},unloadLinearFunc3:function(e){return 1-e},remove:function(){for(var e=this.doc2.querySelectorAll("div."+this.LANDCATCH_WIZARD_Class),t=0;t<e.length;t++)this.doc2.body.removeChild(e[t]);this.landcatch_wizard=null,this.wizardsQueue=[],this.doc.body.removeChild(this.wizardFrameLayer)},onUnload:function(){var e;this.landcatch_wizard&&(this.animateElementStyle(this.landcatch_wizard,"width","px",0,100,10,this.unloadLinearFunc1,5,null),this.animateElementStyle(this.landcatch_wizard,"right","px",0,20,5,this.unloadLinearFunc2,8,null),this.animateElementStyle(this.landcatch_wizard,"opacity",null,0,1,.1,this.unloadLinearFunc3,20,null),e=this,setTimeout(function(){e.remove()},120))},loadLinearFunc1:function(e){return e},loadLinearFunc2:function(e){return Math.round(472-110/e)},onLoad:function(){this.landcatch_wizard&&(this.animateElementStyle(this.landcatch_wizard,"width","px",1,11,1,this.loadLinearFunc2,10,null),this.animateElementStyle(this.landcatch_wizard,"right","px",0,20,5,this.loadLinearFunc1,8,null),this.animateElementStyle(this.landcatch_wizard,"opacity",null,0,1,.1,this.loadLinearFunc1,20,null))},transitToNewPage:function(){var e=this.wizardsQueue[0],t=this.wizardsQueue[1],i=this;e&&t&&(this.animateElementStyle(e,"opacity",null,0,1,.1,this.unloadLinearFunc3,8,null),this.animateElementStyle(t,"opacity",null,0,1,.1,this.loadLinearFunc1,8,null),setTimeout(function(){i.doc2.body.removeChild(e),i.wizardsQueue.shift()},100))},ignoreDetectedApp:function(e,t){},centrifyServiceRequest:function(e,t,i,n,o){},loadIframe:function(e){},addToAppCache:function(e,t){},convertCapturedAppToFFRaw:function(e,t){var i={};return i.AppKey=t?"@~/apps/captured_"+e.appkey:e.appkey,i.Name=e.name,i.DisplayName=e.name,i.Url=e.url,i.Username=e.usernameValue,i.CorpIdentifier=null,i.Scheme=N.login.SchemeEnum.httpHttps,i.HostNameSuffix=e.hostnameSuffix,i.UsernameField=e.usernameField,i.PasswordField=e.passwordField,i.CorpIdField=e.corpIdField,i.SubmitField=e.submitField,i.FormField=e.formField,i.Order=e.order,i.UsernameIsShared=!t&&null,i.AppType="Web",i.WebAppType="UsernamePassword",i.WebUPAppType="BrowserExtension",i.PasswordIsSet=t,i.FormFillingEnabled=!0,i}},N.common.objectExtend(N.landcatch.CaptureUIBase,N.common.CentrifyBEBase),N.common.objectExtend(N.landcatch.CaptureUIBase,N.common.UI),N.landcatch.LoginForm=function(e){N.common.CentrifyBEBase.call(this),this.formElement=e,this.fields=[],this.LoginFields={username:[],password:[],submit:[],form:{},sameParent:!1}},N.landcatch.LoginForm.prototype={loggerName:"CaptureForm",isInputIgnore:function(e){var t;return e.type?!("hidden"!==(t=e.type.toLowerCase())&&"checkbox"!==t&&!e.readonly&&!e.disabled):(this.log("Input type is null or undefined"),!0)},getFormType:function(){return this.LoginFields.form.type},analysis:function(e){var t=this.findCssSelector(this.formElement),i=(this.log("Analysis form "+t),this.LoginFields.form.selector=t,this.formElement.querySelectorAll("input"));if(this.log("This form has "+i.length+" input fields"),this.analysisInputCount(i)){for(var n=0;n<i.length;n++)e?.includes&&e.includes(i[n])?this.log("skipping input in ignore list",i[n]):!this.isInputIgnore(i[n])&&this.isElementVisiable(i[n])&&this.fields.push(i[n]);for(n=0;n<this.fields.length;n++){var o=this.fields[n];this.analysisInputField(o),this.log("The input field type is "+o.type)}N.login.centrifyBELogin.userSetting.enableFNFCapture&&this.getSubmitSelectorFromForm(this.formElement),this.analysisFormType()}},analysisWithoutForm:function(t,i){if(this.log("Analyze the input elements which are not bound in a form"),!this.isInputIgnore(t)&&this.isElementVisiable(t)&&this.analysisInputField(t),0<this.LoginFields.password?.length){let e=null;if(e=0<i?.username?.length?document.querySelector(i.username[0].selector):e){var n=this.findFirstCommonAncestor(e,t);if(null!==n){var o=n.querySelector(this.LoginFields.password[0].selector),i=n.querySelector(i?.username[0]?.selector);let e=n.querySelectorAll("[type=submit], [type=button]");1==(e=0==e?.length?n.querySelectorAll("button"):e)?.length&&this.analysisInputField(e[0]),o===t&&i&&(this.analysisInputField(i),this.LoginFields.sameParent=!0)}}}},findFirstCommonAncestor:function(e,t,i){return 0==(i=i||this.getAncestors(t)).length?null:-1<i.indexOf(e)?e:e==document?null:this.findFirstCommonAncestor(e.parentNode,t,i)},getAncestors:function(e){return e!=document?[e].concat(this.getAncestors(e.parentNode)):[e]},analysisInputCount:function(e){return!(e.length>N.login.centrifyBELogin.userSetting.lcInputCount&&(this.log("This form has too many input fields, which is "+e.length),this.log("This is probably not a login/registration form, therefore skipping land and catch."),1))},getSubmitSelectorFromForm:function(e){var t;null!=e&&(t=[],0<(t=e.querySelectorAll("[type=submit]"))?.length||1==(t=e.querySelectorAll("button"))?.length)&&this.analysisSubmit(t[0])},analysisInputField:function(e){var t=e.type.toLowerCase();"email"===t||"text"===t?this.analysisUsername(e):"password"===t?this.analysisPassword(e):"submit"!==t&&"button"!==t&&"image"!==t||this.analysisSubmit(e)},analysisUsername:function(e){var t=this.findCssSelector(e),e=e.value;this.LoginFields.username.push({selector:t,value:e}),this.log("add a username candidate with selector "+t+" and value "+e)},analysisPassword:function(e){var t=this.findCssSelector(e),e=e.value;this.LoginFields.password.push({selector:t,value:e}),this.log("add a password candidate with selector "+t)},analysisSubmit:function(e){switch(e.tagName.toUpperCase()){case"INPUT":case"BUTTON":switch(e.type.toLowerCase()){case"submit":case"button":var t=this.findCssSelector(e),i=e.value;this.LoginFields.submit.push({selector:t,value:i}),this.log("add a submit candidate with selector "+t+" and value "+i)}}},analysisFormType:function(){1!=this.LoginFields.username.length&&2!=this.LoginFields.username.length||1!=this.LoginFields.password.length?2<this.LoginFields.username.length||1<this.LoginFields.password.length?(this.log("Form should be register form"),this.LoginFields.form.type="register"):(this.log("unknown form type"),this.LoginFields.form.type="unknown"):(this.log("Form should be login form"),this.LoginFields.form.type="login")}},N.common.objectExtend(N.landcatch.LoginForm,N.common.CentrifyBEBase),N.common.objectExtend(N.landcatch.LoginForm,N.common.UI),N.landcatch.MonitorBase=function(e){N.common.CentrifyBEBase.call(this),this.initParams=e},N.landcatch.MonitorBase.prototype={loggerName:"LandCatchMonitor",bhTypeEnum:N.landcatch.BehaviorTypesEnum,bhFieldsEnum:N.landcatch.BehaviorFieldsEnum,isRoot:!0,isEnabled:!1,isPolicyEnabled:!1,isLocalEnabled:0,isPause:!1,appDetail:{},candidateForms:[],nonFormElements:{},defaultIconSize:N.landcatch.CaptureUIBase.prototype.defaultIconSize,clickEvtTarget:null,cloudPortalPattern:/^(([^\.]+\.)(([^\.]*my[^\.]*))|(devdog)|(station)|(cloud)|(kibble))\.((centrify\.com)|(centrify\.net)|(centrify-dev\.net)|(centrify-qa\.net)|(samsungknox\.com)|(avg\.com)|(idaptive\.app)|(idaptive\.qa))/i,passwordResetExisitingInputs:[],initSetting:function(){this.userSetting=this.initParams?this.initParams.userSetting:null,this.portalHostname=this.initParams?this.initParams.portalHostname:null,this.associatedChildPod=this.initParams?this.initParams.associatedChildPod:null;var e=this.initParams?this.initParams.skippedSites:"";this.skippedSites=new Set(e?.split(";")),this.isLocalEnabled=this.initParams?this.initParams.enableLCLocal:0,this.isLocalEnabled=this.initParams?.isLoggedInShellTenant,this.loggedInShellTenantDetails=this.initParams?.loggedInShellTenantDetails,this.updateIsEnabled()},updateIsEnabled:function(){var e;this.userSetting&&(e=this.userSetting.canCreateAppInAP||this.userSetting.canCreateAppInUP,this.isPolicyEnabled=this.userSetting.enableLandCatch,this.isBrokenLC=this.userSetting.raw.enableBrokenLC,this.log("user can create app: "+e+", policy enabled: "+this.isPolicyEnabled+", local enabled: "+this.isLocalEnabled),this.isPolicyEnabled)?this.isEnabled=0<=this.isLocalEnabled&&e:this.isEnabled=!1},shouldMonitor:function(){return this.isEnabled&&!this.isPause},pause:function(){this.isPause=!0},resume:function(){this.isPause=!1},isRootDoc:function(e){var t=!0;null!=e.defaultView&&(t=e.defaultView.top===e.defaultView.self||e.defaultView.top.window===e.defaultView.self),this.log("url "+e.URL+" isRootDoc? "+t),this.isRoot=t},getTargetUrl:function(e){var t={isRoot:this.isRoot,docUrl:null};return e&&e.ownerDocument&&(t.docUrl=e.ownerDocument.URL,t.docHost=e.ownerDocument.location.hostname),t},getDocUrl:function(e){return{isRoot:this.isRoot,docUrl:e.URL,docHost:e.location.hostname}},recordElementForm:function(e){var t=this.findParent(e,"FORM");if(t){this.log("ele is belong to the form "+this.findCssSelector(t));for(var i=!1,e=new N.landcatch.LoginForm(t),n=(e.analysis(this.passwordResetExisitingInputs),0),n=0;n<this.candidateForms.length;n++)if(this.candidateForms[n].formElement===t){i=!0;break}return i?this.log("already added this form"):(this.log("this is a new form, ADD"),this.candidateForms.push(e)),e.LoginFields.form.idx=n,e}return this.log("this element is not belong to a form, TODO"),null},loginWithNonForms:function(e){var t;return N.login.centrifyBELogin.userSetting.enableFNFCapture?1===this.nonFormElements?.username?.length&&1===this.nonFormElements?.password.length?this.nonFormElements:((t=new N.landcatch.LoginForm("noform")).analysisWithoutForm(e,this.nonFormElements),{...t.LoginFields},this.nonFormElements={...t.LoginFields},t):null},registerContentEvents:function(e){var t=this;e.addEventListener("change",function(e){t.shouldMonitor()&&t.inputEventHandler(e)},!1),e.addEventListener("mouseup",function(e){t.shouldMonitor()&&t.mouseupEventHandler(e)},!1),e.addEventListener("click",function(e){t.shouldMonitor()&&t.clickEventHandler(e)},!1),e.addEventListener("keyup",function(e){t.shouldMonitor()&&t.keyupEventHandler(e)},!1),t.isBrokenLC&&e.addEventListener("input",function(e){t.shouldMonitor()&&t.inputEventHandler(e)},!1)},getElementInHead:function(e,t,i,n){n=n.toUpperCase();for(var o=e.head.getElementsByTagName(t),r=0;r<o.length;r++){var s=o[r],l=s.getAttribute(i);if(l&&l.toUpperCase()===n)return s}return null},getMetaDataContent:function(e,t,i){t=this.getElementInHead(e,"meta",t,i);return t&&t.content?((i=e.createElement("div")).innerHTML=t.content,i.childNodes[0].nodeValue.trim()):null},getAppName:function(e){var t,i=null,n=e.createElement("div");return(i=(i=(i=(i=this.getMetaDataContent(e,"name","application-name"))||this.getMetaDataContent(e,"property","og:site_name"))||this.getMetaDataContent(e,"property","og:title"))||this.getMetaDataContent(e,"name","title"))||(t=e.querySelector("html > head > title"))&&t.innerHTML&&(n.innerHTML=t.innerHTML,i=n.childNodes[0].nodeValue.trim()),i=i||e.location.hostname},getAppDescription:function(e){return this.getMetaDataContent(e,"name","description")||this.getMetaDataContent(e,"property","og:description")},getAppIcon:function(t){function i(e){var t=e.location.protocol+"//"+e.location.host+"/favicon.ico";o.getImage(e,t,function(e){o.appDetail.icon=e||null,o.sendAppDetails(o.appDetail)})}var e,n,o=this,r=this.getMetaDataContent(t,"property","og:image");r&&((n=t.createElement("a")).href=r,r=n.href),r||(e=this.getElementInHead(t,"link","rel","shortcut icon"))&&(r=e.href),r||(e=this.getElementInHead(t,"link","rel","icon"))&&(r=e.href),r?this.getImage(t,r,function(e){e?(o.appDetail.icon=e,o.sendAppDetails(o.appDetail)):i(t)}):i(t)},initAppDetail:function(e){this.appDetail.name=this.getAppName(e),this.appDetail.description=this.getAppDescription(e),this.appDetail.icon=this.getAppIcon(e)},getImage:function(n,e,o){this.log("getImage url = "+e);var r=this,t=new XMLHttpRequest;t.onload=function(){var i=n.createElement("img");i.src=n.defaultView.URL.createObjectURL(t.response),i.height=r.defaultIconSize,i.width=r.defaultIconSize,i.onload=function(){var e=n.createElement("canvas"),t=e.getContext("2d");e.height=r.defaultIconSize,e.width=r.defaultIconSize,t.drawImage(i,0,0,r.defaultIconSize,r.defaultIconSize),o(e.toDataURL())},i.onerror=function(){o(null)}},t.onerror=function(){o(null)},t.open("get",e,!0),t.responseType="blob",t.send()},startToMonitor:function(t){var e,i;t&&t.location&&t.location.hostname?this.portalHostname&&this.associatedChildPod?(e=(window.location!=window.parent.location?new URL(document.referrer):new URL(document.location.href)).hostname,i=this.userSetting.enableLCCloudDomainCheckFix?N.common.validateDomain(e):this.cloudPortalPattern.test(e),0<=e.indexOf(this.portalHostname)||0<=e.indexOf(this.associatedChildPod)||0<=e.indexOf(this.loggedInShellTenantDetails?.masterShellTenant)?this.log("landing on "+e+", which is portalHostname or associatedChildPod, skip land catch"):i?this.log("landing on cloud portal, skip land catch"):this.isPolicyEnabled?(this.isRootDoc(t),this.isRoot&&this.initAppDetail(t),this.registerContentEvents(t),this.sendNavigateEvents(t),N.v2.eventbus.subscribe(N.communication.eventBusMessageEnum.ADD_PWD_RESET_INPUT,e=>{e=t.querySelector(e);this.passwordResetExisitingInputs.includes(e)||this.passwordResetExisitingInputs.push(e)})):this.log("land and catch is not enabled, not signed in or the feature is disabled on "+t.URL)):this.log("monitor does not have portalHostname or associatedChildPod, something went wrong"):this.log("document hostname is empty or null, can't do anything")},inputEventHandler:function(e){var t,i,n,o,e=e.target;this.userSetting.enableLCBrokenSitesFix&&!e?.type&&(i=e.querySelector("input"))&&(e=i),this.passwordResetExisitingInputs.includes(e)?this.log("skipping event for a 'password' input that is filled with current password for reset"):(i=e.type?.toLowerCase(),this.userSetting.enableLCPwdCaptureInUserNameFix?("text"!=(i=N.util.isPasswordField(e)?"password":i)||N.util.isPasswordField(e))&&"email"!=i||(i="username"):"text"!=i&&"email"!=i||(i="username"),"username"==i||"password"==i?(n=this.findCssSelector(e),o=e.value,t=this.bhTypeEnum.inputChange,i={type:i,selector:n,value:o},n=this.getTargetUrl(e),(o=this.recordElementForm(e))&&"register"==o.getFormType()?this.log("the input change event is from a register form, do nothing"):(i.potentialForm=o?o.LoginFields:this.loginWithNonForms(e),o={type:t,data:i,sender:n},this.log("input "+e.type+"changes, might be a credential field"),this.sendLandCatchEvent(o))):this.log("other input type change, ignore"))},mouseupEventHandler:function(e){0==e.button&&(this.clickEvtTarget=e.target,this.processClickEvent(e))},clickEventHandler:function(e){this.clickEvtTarget&&this.clickEvtTarget==e.target||this.processClickEvent(e),this.clickEvtTarget=null},processClickEvent:function(e){var t,i,e=e.target,n=e.tagName.toLowerCase(),o=e.type?e.type.toLowerCase():null;("input"!=n||"text"!=o&&"password"!=o&&"email"!=o)&&e.className!=N.formfill.InjectedElement.className&&(n=this.findCssSelector(e),i=e.value,t=this.bhTypeEnum.mouseLClick,n={selector:n,value:i,type:o},i=this.getTargetUrl(e),o=this.recordElementForm(e),n.potentialForm=o?o.LoginFields:this.loginWithNonForms(e),n.isSubmit=!!n.sameParent||!!o&&this.checkClickSubmitBtn(e),this.sendLandCatchEvent({type:t,data:n,sender:i}))},checkClickSubmitBtn:function(e){var t,i;return!!e&&(t=!1,!(i=this.findParent(e,"INPUT"))||"button"!=i.type&&"image"!=i.type&&"submit"!=i.type||(t=!0),i=!1,(e=this.findParent(e,"BUTTON"))&&"reset"!=e.type&&(i=!0),t||i)},keyupEventHandler:function(e){var t,i,n,o;13==e.keyCode&&(t=this.bhTypeEnum.pressEnter,e=e.target,(i=this.recordElementForm(e))||this.log("The key enter does not have a form"),n=e.type?e.type.toLowerCase():null,n={selector:this.findCssSelector(e),value:e.value,type:n},o=this.getTargetUrl(e),n.potentialForm=i?i.LoginFields:this.loginWithNonForms(e),n.isSubmit=!!n.sameParent||!!i||this.checkKeyEnterSubmitBtn(e),this.sendLandCatchEvent({type:t,data:n,sender:o}))},checkKeyEnterSubmitBtn:function(e){var t,i;return!!e&&(t=!1,this.findParent(e,"INPUT")&&(t=!0),i=!1,(e=this.findParent(e,"BUTTON"))&&"reset"!=e.type&&(i=!0),t||i)},checkToShowLandCatchInline:function(){var e,t=document;return"FRAMESET"===t.body.tagName?(this.log("Sorry. land catch is not supported on this page."),!1):this.isRoot?(e=t.body.querySelector("body > div#centrify\\:\\:landcatch\\.wizard"))?(e.style.top="20px",!(e.style.right="20px")):(e=t.location.hostname,!this.skippedSites||!this.skippedSites.has(e)||(this.log(e+" belongs to the never remember sites, skip land catch"),!1)):(this.log("not root page, land catch UI should not show"),!1)},sendNavigateEvents:function(e){},sendAppDetails:function(e){},sendLandCatchEvent:function(e){}},N.common.objectExtend(N.landcatch.MonitorBase,N.common.CentrifyBEBase),N.common.objectExtend(N.landcatch.MonitorBase,N.common.UI);let t=("undefined"!=typeof browser?browser:chrome)?.runtime;t.onMessage.addListener(function(e,t){"copyText"!==e.action&&"copyPassword"!==e.action&&"copyVerificationCode"!==e.action||!function(e){var t=this;e=navigator?.clipboard?.writeText?.(e)||Promise.reject();e.then(()=>{}).catch(e=>{t.logError("failed copy to the clipboard:"+e)})}(e.textToCopy),e.durationForClearingClipboardPassword&&function(e){let t=this;t.clipboardTimer&&clearTimeout(t.clipboardTimer);t.clipboardTimer=setTimeout(()=>{var e=document.createElement("textarea");document.body.appendChild(e),e.value=" ",e.focus(),e.select(),document.execCommand("Copy"),e.remove(),clearTimeout(t.clipboardTimer)},1e3*e)}(e.durationForClearingClipboardPassword)}),window.addEventListener("message",function(e){e.source==window&&e.data.action&&"SET_CLEAR_CLIPBOARD"==e.data.action&&t.sendMessage({action:N.communication.AppsUpdaterEventEnum.setClearClipboardTimer,duration:e.data.durationForClearingClipboardPassword})})}.call(_idaptiveUniqueGlobal);