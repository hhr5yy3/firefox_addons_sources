(()=>{var bs=Object.defineProperty;var z=(Ye,Xe)=>bs(Ye,"name",{value:Xe,configurable:!0});var Xt=[];(()=>{var Ye={22923:(V,W)=>{"use strict";const g=/\s/,k={OPEN:"{",CLOSE:"}",TAG_OPEN:"<",TAG_CLOSE:">",TAG_CLOSING:"/",SEP:",",SUB_VAR:"#",ESCAPE:"'"},O="subnumeric_types",U="submessage_types",T=Object.keys(k),F=Symbol("C"),L=W=V.exports=z(function _(A){if(!(this instanceof _))return new _(A);this.opts=Object.assign({OFFSET:"offset:",[O]:["plural","selectordinal"],[U]:["plural","selectordinal","select"],allowTags:!0,requireOther:!0},k,A);for(let p=0;p<T.length;p++){const v=T[p],x=this.opts[v];if(typeof x!="string"||x.length!==1)throw new Error(`Option ${v} must be a 1-length string`);for(let a=p+1;a<T.length;a++){const o=T[a];if(this.opts[o]===x)throw new Error(`Option ${v} and ${o} cannot match`)}}},"Parser2"),d=L.prototype;d.parse=function(_){return this.parseAST({msg:String(_),i:0},null)},d.parseAST=function(_,A){const p=_.msg,v=this.opts,x=p.length,a=A&&v[O].includes(A.t),o=[];for(;_.i<x;){const r=_.i,l=p[r];if(l===v.CLOSE)if(!A)w(o,"}"),_.i++;else break;else if(l===v.OPEN||a&&l===v.SUB_VAR)w(o,this.parseElement(_,A));else if(v.allowTags&&l===v.TAG_OPEN&&!g.test(p[r+1])){const m=this.parseTag(_,A);if(m===F){A.closed=!0;break}else w(o,m)}else w(o,this.parseText(_,A));if(_.i===r)throw u(l,_.i)}return o},d.parseText=function(_,A,p=!0,v=!0,x=!1){const a=_.msg,o=this.opts,r=o.allowTags,l=a.length,m=A&&o[O].includes(A.t);let f="";for(;_.i<l;){const c=a[_.i];if(c===o.OPEN||c===o.CLOSE||r&&(c===o.TAG_OPEN||x&&(c===o.TAG_CLOSE||c===o.TAG_CLOSING))||!p&&c===o.SEP||!v&&g.test(c)||m&&c===o.SUB_VAR)break;if(c===o.ESCAPE){let S=a[++_.i];if(S===o.ESCAPE)f+=S,_.i++;else if(S===o.OPEN||S===o.CLOSE||r&&(S===o.TAG_OPEN||x&&(S===o.TAG_CLOSE||S===o.TAG_CLOSING))||m&&S===o.SUB_VAR||!v||!p)for(f+=S;++_.i<l;)if(S=a[_.i],S===o.ESCAPE)if(S=a[_.i+1],S===o.ESCAPE)f+=S,_.i++;else{_.i++;break}else f+=S;else f+=c}else _.i++,f+=c}return f},d.parseTag=function(_,A){const p=_.msg,v=_.i,x=this.opts;_.i++;let a=p[_.i],o=!1;if(a===x.TAG_CLOSING){if(!A||!A.n)throw u(a,_.i);o=!0,_.i++,b(_)}const r=this.parseText(_,null,!1,!1,!0);if(!r)return p.slice(v,_.i);if(b(_),a=p[_.i],o){if(a!==x.TAG_CLOSE)throw C(x.TAG_CLOSE,a,_.i);if(r!==A.n)throw u("tag mismatch",v);return _.i++,F}if(o=!1,a===x.TAG_CLOSING&&(o=!0,_.i++,a=p[_.i]),a!==x.TAG_CLOSE)return p.slice(v,_.i);_.i++;const l={n:r};if(o)return l;const m=this.parseAST(_,l);if(m&&m.length&&(l.c=m),!l.closed&&_.i>=p.length)throw C("closing tag",_);return delete l.closed,l},d.parseElement=function(_,A){const p=_.msg,v=this.opts,x=A&&v[O].includes(A.t);let a=p[_.i];if(x&&a===v.SUB_VAR)return _.i++,{v:A.v,t:"number"};_.i++,b(_);const o=this.parseText(_,null,!1,!1);if(!o)throw C("placeholder id",a,_.i);const r={v:o};if(b(_),a=p[_.i],a===v.CLOSE)return _.i++,r;if(a!==v.SEP)throw C(`${v.SEP} or ${v.CLOSE}`,a,_.i);_.i++,b(_);const l=this.parseText(_,null,!1,!1);if(!l)throw C("type",_);if(r.t=l,b(_),a=p[_.i],a===v.CLOSE){if(v[U].includes(r.t))throw C("sub-messages",_);return _.i++,r}else if(a!==v.SEP)throw C(`${v.SEP} or ${v.CLOSE}`,a,_.i);if(_.i++,b(_),v[O].includes(r.t)){const m=this.parseOffset(_);m&&(r.f=m,b(_))}if(v[U].includes(r.t)){const m=this.parseSubmessages(_,r),f=v.requireOther;if((Array.isArray(f)?f.includes(r.t):f)&&!m.other)throw C("other sub-message",_);r.o=m}else{const m=this.parseText(_,null,!0,!0);if(!m)throw C("format",_);r.f=m.trimRight()}if(b(_),a=p[_.i],a!==v.CLOSE)throw C(v.CLOSE,a,_.i);return _.i++,r},d.parseSubmessages=function(_,A){const p=_.msg,v=p.length,x={};for(;_.i<v&&p[_.i]!==this.opts.CLOSE;){const o=this.parseText(_,null,!0,!1);if(!o)throw C("sub-message selector",_);b(_),x[o]=this.parseSubmessage(_,A),b(_)}return x},d.parseSubmessage=function(_,A){const p=_.msg,v=this.opts;if(p[_.i]!==v.OPEN)throw C(v.OPEN,_);_.i++;const x=this.parseAST(_,A);if(p[_.i]!==v.CLOSE)throw C(v.CLOSE,_);return _.i++,x},d.parseOffset=function(_){const A=_.msg,p=this.opts.OFFSET,v=A.length;if(A.slice(_.i,_.i+p.length)!==p)return;_.i+=p.length,b(_);const x=_.i;for(;_.i<v&&/[-\d]/.test(A[_.i]);)_.i++;if(x===_.i)throw C("number",_);return+A.slice(x,_.i)};function C(_,A,p){return typeof A=="object"&&(p=A.i,A=A.msg[p]),new SyntaxError(`expected ${_} at position ${p} but found ${A||"eof"}`)}z(C,"expected");function u(_,A){return new SyntaxError(`unexpected ${_} at position ${A}`)}z(u,"unexpected");function b(_){const A=_.msg,p=A.length;for(;_.i<p&&g.test(A[_.i]);)_.i++}z(b,"skipSpace");function w(_,A){const p=_.length-1;typeof A=="string"&&typeof _[p]=="string"?_[p]+=A:_.push(A)}z(w,"mergePush")},5926:(V,W,g)=>{"use strict";g.d(W,{fi:()=>$,kZ:()=>S});var k=g(57845),O=g(23111),U=g(61378),T=g(52319);function F(P){return{scrollLeft:P.scrollLeft,scrollTop:P.scrollTop}}z(F,"getHTMLElementScroll");function L(P){return P===(0,U.Z)(P)||!(0,T.Re)(P)?(0,O.Z)(P):F(P)}z(L,"getNodeScroll");var d=g(43332),C=g(61300),u=g(4377),b=g(10710),w=g(62079);function _(P){var E=P.getBoundingClientRect(),D=(0,w.NM)(E.width)/P.offsetWidth||1,M=(0,w.NM)(E.height)/P.offsetHeight||1;return D!==1||M!==1}z(_,"isElementScaled");function A(P,E,D){D===void 0&&(D=!1);var M=(0,T.Re)(E),Z=(0,T.Re)(E)&&_(E),G=(0,u.Z)(E),Y=(0,k.Z)(P,Z,D),Q={scrollLeft:0,scrollTop:0},X={x:0,y:0};return(M||!M&&!D)&&(((0,d.Z)(E)!=="body"||(0,b.Z)(G))&&(Q=L(E)),(0,T.Re)(E)?(X=(0,k.Z)(E,!0),X.x+=E.clientLeft,X.y+=E.clientTop):G&&(X.x=(0,C.Z)(G))),{x:Y.left+Q.scrollLeft-X.x,y:Y.top+Q.scrollTop-X.y,width:Y.width,height:Y.height}}z(A,"getCompositeRect");var p=g(5618),v=g(26857),x=g(52839),a=g(49880);function o(P){var E=new Map,D=new Set,M=[];P.forEach(function(G){E.set(G.name,G)});function Z(G){D.add(G.name);var Y=[].concat(G.requires||[],G.requiresIfExists||[]);Y.forEach(function(Q){if(!D.has(Q)){var X=E.get(Q);X&&Z(X)}}),M.push(G)}return z(Z,"sort"),P.forEach(function(G){D.has(G.name)||Z(G)}),M}z(o,"order");function r(P){var E=o(P);return a.xs.reduce(function(D,M){return D.concat(E.filter(function(Z){return Z.phase===M}))},[])}z(r,"orderModifiers");function l(P){var E;return function(){return E||(E=new Promise(function(D){Promise.resolve().then(function(){E=void 0,D(P())})})),E}}z(l,"debounce");function m(P){var E=P.reduce(function(D,M){var Z=D[M.name];return D[M.name]=Z?Object.assign({},Z,M,{options:Object.assign({},Z.options,M.options),data:Object.assign({},Z.data,M.data)}):M,D},{});return Object.keys(E).map(function(D){return E[D]})}z(m,"mergeByName");var f={placement:"bottom",modifiers:[],strategy:"absolute"};function c(){for(var P=arguments.length,E=new Array(P),D=0;D<P;D++)E[D]=arguments[D];return!E.some(function(M){return!(M&&typeof M.getBoundingClientRect=="function")})}z(c,"areValidElements");function S(P){P===void 0&&(P={});var E=P,D=E.defaultModifiers,M=D===void 0?[]:D,Z=E.defaultOptions,G=Z===void 0?f:Z;return z(function(Q,X,se){se===void 0&&(se=G);var J={placement:"bottom",orderedModifiers:[],options:Object.assign({},f,G),modifiersData:{},elements:{reference:Q,popper:X},attributes:{},styles:{}},de=[],ce=!1,fe={state:J,setOptions:z(function(ue){var ve=typeof ue=="function"?ue(J.options):ue;ye(),J.options=Object.assign({},G,J.options,ve),J.scrollParents={reference:(0,T.kK)(Q)?(0,v.Z)(Q):Q.contextElement?(0,v.Z)(Q.contextElement):[],popper:(0,v.Z)(X)};var be=r(m([].concat(M,J.options.modifiers)));return J.orderedModifiers=be.filter(function(_e){return _e.enabled}),he(),fe.update()},"setOptions"),forceUpdate:z(function(){if(!ce){var ue=J.elements,ve=ue.reference,be=ue.popper;if(c(ve,be)){J.rects={reference:A(ve,(0,x.Z)(be),J.options.strategy==="fixed"),popper:(0,p.Z)(be)},J.reset=!1,J.placement=J.options.placement,J.orderedModifiers.forEach(function(N){return J.modifiersData[N.name]=Object.assign({},N.data)});for(var _e=0;_e<J.orderedModifiers.length;_e++){if(J.reset===!0){J.reset=!1,_e=-1;continue}var we=J.orderedModifiers[_e],ge=we.fn,Se=we.options,Oe=Se===void 0?{}:Se,Ce=we.name;typeof ge=="function"&&(J=ge({state:J,options:Oe,name:Ce,instance:fe})||J)}}}},"forceUpdate"),update:l(function(){return new Promise(function(le){fe.forceUpdate(),le(J)})}),destroy:z(function(){ye(),ce=!0},"destroy")};if(!c(Q,X))return fe;fe.setOptions(se).then(function(le){!ce&&se.onFirstUpdate&&se.onFirstUpdate(le)});function he(){J.orderedModifiers.forEach(function(le){var ue=le.name,ve=le.options,be=ve===void 0?{}:ve,_e=le.effect;if(typeof _e=="function"){var we=_e({state:J,name:ue,instance:fe,options:be}),ge=z(function(){},"noopFn2");de.push(we||ge)}})}z(he,"runModifierEffects");function ye(){de.forEach(function(le){return le()}),de=[]}return z(ye,"cleanupModifierEffects"),fe},"createPopper2")}z(S,"popperGenerator");var $=S()},75865:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(52319);function O(U,T){var F=T.getRootNode&&T.getRootNode();if(U.contains(T))return!0;if(F&&(0,k.Zq)(F)){var L=T;do{if(L&&U.isSameNode(L))return!0;L=L.parentNode||L.host}while(L)}return!1}z(O,"contains")},57845:(V,W,g)=>{"use strict";g.d(W,{Z:()=>F});var k=g(52319),O=g(62079),U=g(61378),T=g(16182);function F(L,d,C){d===void 0&&(d=!1),C===void 0&&(C=!1);var u=L.getBoundingClientRect(),b=1,w=1;d&&(0,k.Re)(L)&&(b=L.offsetWidth>0&&(0,O.NM)(u.width)/L.offsetWidth||1,w=L.offsetHeight>0&&(0,O.NM)(u.height)/L.offsetHeight||1);var _=(0,k.kK)(L)?(0,U.Z)(L):window,A=_.visualViewport,p=!(0,T.Z)()&&C,v=(u.left+(p&&A?A.offsetLeft:0))/b,x=(u.top+(p&&A?A.offsetTop:0))/w,a=u.width/b,o=u.height/w;return{width:a,height:o,top:x,right:v+a,bottom:x+o,left:v,x:v,y:x}}z(F,"getBoundingClientRect")},26302:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(61378);function O(U){return(0,k.Z)(U).getComputedStyle(U)}z(O,"getComputedStyle")},4377:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(52319);function O(U){return(((0,k.kK)(U)?U.ownerDocument:U.document)||window.document).documentElement}z(O,"getDocumentElement")},5618:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(57845);function O(U){var T=(0,k.Z)(U),F=U.offsetWidth,L=U.offsetHeight;return Math.abs(T.width-F)<=1&&(F=T.width),Math.abs(T.height-L)<=1&&(L=T.height),{x:U.offsetLeft,y:U.offsetTop,width:F,height:L}}z(O,"getLayoutRect")},43332:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O){return O?(O.nodeName||"").toLowerCase():null}z(k,"getNodeName")},52839:(V,W,g)=>{"use strict";g.d(W,{Z:()=>b});var k=g(61378),O=g(43332),U=g(26302),T=g(52319);function F(w){return["table","td","th"].indexOf((0,O.Z)(w))>=0}z(F,"isTableElement");var L=g(85564),d=g(3518);function C(w){return!(0,T.Re)(w)||(0,U.Z)(w).position==="fixed"?null:w.offsetParent}z(C,"getTrueOffsetParent");function u(w){var _=/firefox/i.test((0,d.Z)()),A=/Trident/i.test((0,d.Z)());if(A&&(0,T.Re)(w)){var p=(0,U.Z)(w);if(p.position==="fixed")return null}var v=(0,L.Z)(w);for((0,T.Zq)(v)&&(v=v.host);(0,T.Re)(v)&&["html","body"].indexOf((0,O.Z)(v))<0;){var x=(0,U.Z)(v);if(x.transform!=="none"||x.perspective!=="none"||x.contain==="paint"||["transform","perspective"].indexOf(x.willChange)!==-1||_&&x.willChange==="filter"||_&&x.filter&&x.filter!=="none")return v;v=v.parentNode}return null}z(u,"getContainingBlock");function b(w){for(var _=(0,k.Z)(w),A=C(w);A&&F(A)&&(0,U.Z)(A).position==="static";)A=C(A);return A&&((0,O.Z)(A)==="html"||(0,O.Z)(A)==="body"&&(0,U.Z)(A).position==="static")?_:A||u(w)||_}z(b,"getOffsetParent")},85564:(V,W,g)=>{"use strict";g.d(W,{Z:()=>T});var k=g(43332),O=g(4377),U=g(52319);function T(F){return(0,k.Z)(F)==="html"?F:F.assignedSlot||F.parentNode||((0,U.Zq)(F)?F.host:null)||(0,O.Z)(F)}z(T,"getParentNode")},61378:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O){if(O==null)return window;if(O.toString()!=="[object Window]"){var U=O.ownerDocument;return U&&U.defaultView||window}return O}z(k,"getWindow")},23111:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(61378);function O(U){var T=(0,k.Z)(U),F=T.pageXOffset,L=T.pageYOffset;return{scrollLeft:F,scrollTop:L}}z(O,"getWindowScroll")},61300:(V,W,g)=>{"use strict";g.d(W,{Z:()=>T});var k=g(57845),O=g(4377),U=g(23111);function T(F){return(0,k.Z)((0,O.Z)(F)).left+(0,U.Z)(F).scrollLeft}z(T,"getWindowScrollBarX")},52319:(V,W,g)=>{"use strict";g.d(W,{Re:()=>U,Zq:()=>T,kK:()=>O});var k=g(61378);function O(F){var L=(0,k.Z)(F).Element;return F instanceof L||F instanceof Element}z(O,"isElement");function U(F){var L=(0,k.Z)(F).HTMLElement;return F instanceof L||F instanceof HTMLElement}z(U,"isHTMLElement");function T(F){if(typeof ShadowRoot>"u")return!1;var L=(0,k.Z)(F).ShadowRoot;return F instanceof L||F instanceof ShadowRoot}z(T,"isShadowRoot")},16182:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(3518);function O(){return!/^((?!chrome|android).)*safari/i.test((0,k.Z)())}z(O,"isLayoutViewport")},10710:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(26302);function O(U){var T=(0,k.Z)(U),F=T.overflow,L=T.overflowX,d=T.overflowY;return/auto|scroll|overlay|hidden/.test(F+d+L)}z(O,"isScrollParent")},26857:(V,W,g)=>{"use strict";g.d(W,{Z:()=>d});var k=g(85564),O=g(10710),U=g(43332),T=g(52319);function F(C){return["html","body","#document"].indexOf((0,U.Z)(C))>=0?C.ownerDocument.body:(0,T.Re)(C)&&(0,O.Z)(C)?C:F((0,k.Z)(C))}z(F,"getScrollParent");var L=g(61378);function d(C,u){var b;u===void 0&&(u=[]);var w=F(C),_=w===((b=C.ownerDocument)==null?void 0:b.body),A=(0,L.Z)(w),p=_?[A].concat(A.visualViewport||[],(0,O.Z)(w)?w:[]):w,v=u.concat(p);return _?v:v.concat(d((0,k.Z)(p)))}z(d,"listScrollParents")},49880:(V,W,g)=>{"use strict";g.d(W,{BL:()=>d,Ct:()=>p,DH:()=>r,F2:()=>U,I:()=>O,MS:()=>c,N7:()=>v,Pj:()=>b,XM:()=>o,YP:()=>_,bw:()=>A,cW:()=>f,d7:()=>F,ij:()=>x,iv:()=>m,k5:()=>w,mv:()=>L,r5:()=>a,t$:()=>T,ut:()=>C,wX:()=>l,we:()=>k,xs:()=>S,zV:()=>u});var k="top",O="bottom",U="right",T="left",F="auto",L=[k,O,U,T],d="start",C="end",u="clippingParents",b="viewport",w="popper",_="reference",A=L.reduce(function($,P){return $.concat([P+"-"+d,P+"-"+C])},[]),p=[].concat(L,[F]).reduce(function($,P){return $.concat([P,P+"-"+d,P+"-"+C])},[]),v="beforeRead",x="read",a="afterRead",o="beforeMain",r="main",l="afterMain",m="beforeWrite",f="write",c="afterWrite",S=[v,x,a,o,r,l,m,f,c]},16572:(V,W,g)=>{"use strict";g.r(W),g.d(W,{afterMain:()=>k.wX,afterRead:()=>k.r5,afterWrite:()=>k.MS,applyStyles:()=>O.Z,arrow:()=>U.Z,auto:()=>k.d7,basePlacements:()=>k.mv,beforeMain:()=>k.XM,beforeRead:()=>k.N7,beforeWrite:()=>k.iv,bottom:()=>k.I,clippingParents:()=>k.zV,computeStyles:()=>T.Z,createPopper:()=>A.fi,createPopperBase:()=>w.fi,createPopperLite:()=>v,detectOverflow:()=>_.Z,end:()=>k.ut,eventListeners:()=>F.Z,flip:()=>L.Z,hide:()=>d.Z,left:()=>k.t$,main:()=>k.DH,modifierPhases:()=>k.xs,offset:()=>C.Z,placements:()=>k.Ct,popper:()=>k.k5,popperGenerator:()=>w.kZ,popperOffsets:()=>u.Z,preventOverflow:()=>b.Z,read:()=>k.ij,reference:()=>k.YP,right:()=>k.F2,start:()=>k.BL,top:()=>k.we,variationPlacements:()=>k.bw,viewport:()=>k.Pj,write:()=>k.cW});var k=g(49880),O=g(32898),U=g(63454),T=g(24502),F=g(72582),L=g(16087),d=g(48051),C=g(61150),u=g(35772),b=g(29228),w=g(5926),_=g(24041),A=g(78224),p=[F.Z,u.Z,T.Z,O.Z],v=(0,w.kZ)({defaultModifiers:p})},32898:(V,W,g)=>{"use strict";g.d(W,{Z:()=>F});var k=g(43332),O=g(52319);function U(L){var d=L.state;Object.keys(d.elements).forEach(function(C){var u=d.styles[C]||{},b=d.attributes[C]||{},w=d.elements[C];!(0,O.Re)(w)||!(0,k.Z)(w)||(Object.assign(w.style,u),Object.keys(b).forEach(function(_){var A=b[_];A===!1?w.removeAttribute(_):w.setAttribute(_,A===!0?"":A)}))})}z(U,"applyStyles");function T(L){var d=L.state,C={popper:{position:d.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(d.elements.popper.style,C.popper),d.styles=C,d.elements.arrow&&Object.assign(d.elements.arrow.style,C.arrow),function(){Object.keys(d.elements).forEach(function(u){var b=d.elements[u],w=d.attributes[u]||{},_=Object.keys(d.styles.hasOwnProperty(u)?d.styles[u]:C[u]),A=_.reduce(function(p,v){return p[v]="",p},{});!(0,O.Re)(b)||!(0,k.Z)(b)||(Object.assign(b.style,A),Object.keys(w).forEach(function(p){b.removeAttribute(p)}))})}}z(T,"effect");const F={name:"applyStyles",enabled:!0,phase:"write",fn:U,effect:T,requires:["computeStyles"]}},63454:(V,W,g)=>{"use strict";g.d(W,{Z:()=>A});var k=g(65352),O=g(5618),U=g(75865),T=g(52839),F=g(61919),L=g(72907),d=g(49534),C=g(62219),u=g(49880),b=z(function(v,x){return v=typeof v=="function"?v(Object.assign({},x.rects,{placement:x.placement})):v,(0,d.Z)(typeof v!="number"?v:(0,C.Z)(v,u.mv))},"toPaddingObject2");function w(p){var v,x=p.state,a=p.name,o=p.options,r=x.elements.arrow,l=x.modifiersData.popperOffsets,m=(0,k.Z)(x.placement),f=(0,F.Z)(m),c=[u.t$,u.F2].indexOf(m)>=0,S=c?"height":"width";if(!(!r||!l)){var $=b(o.padding,x),P=(0,O.Z)(r),E=f==="y"?u.we:u.t$,D=f==="y"?u.I:u.F2,M=x.rects.reference[S]+x.rects.reference[f]-l[f]-x.rects.popper[S],Z=l[f]-x.rects.reference[f],G=(0,T.Z)(r),Y=G?f==="y"?G.clientHeight||0:G.clientWidth||0:0,Q=M/2-Z/2,X=$[E],se=Y-P[S]-$[D],J=Y/2-P[S]/2+Q,de=(0,L.u)(X,J,se),ce=f;x.modifiersData[a]=(v={},v[ce]=de,v.centerOffset=de-J,v)}}z(w,"arrow");function _(p){var v=p.state,x=p.options,a=x.element,o=a===void 0?"[data-popper-arrow]":a;o!=null&&(typeof o=="string"&&(o=v.elements.popper.querySelector(o),!o)||(0,U.Z)(v.elements.popper,o)&&(v.elements.arrow=o))}z(_,"effect");const A={name:"arrow",enabled:!0,phase:"main",fn:w,effect:_,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]}},24502:(V,W,g)=>{"use strict";g.d(W,{Z:()=>A});var k=g(49880),O=g(52839),U=g(61378),T=g(4377),F=g(26302),L=g(65352),d=g(47408),C=g(62079),u={top:"auto",right:"auto",bottom:"auto",left:"auto"};function b(p,v){var x=p.x,a=p.y,o=v.devicePixelRatio||1;return{x:(0,C.NM)(x*o)/o||0,y:(0,C.NM)(a*o)/o||0}}z(b,"roundOffsetsByDPR");function w(p){var v,x=p.popper,a=p.popperRect,o=p.placement,r=p.variation,l=p.offsets,m=p.position,f=p.gpuAcceleration,c=p.adaptive,S=p.roundOffsets,$=p.isFixed,P=l.x,E=P===void 0?0:P,D=l.y,M=D===void 0?0:D,Z=typeof S=="function"?S({x:E,y:M}):{x:E,y:M};E=Z.x,M=Z.y;var G=l.hasOwnProperty("x"),Y=l.hasOwnProperty("y"),Q=k.t$,X=k.we,se=window;if(c){var J=(0,O.Z)(x),de="clientHeight",ce="clientWidth";if(J===(0,U.Z)(x)&&(J=(0,T.Z)(x),(0,F.Z)(J).position!=="static"&&m==="absolute"&&(de="scrollHeight",ce="scrollWidth")),J=J,o===k.we||(o===k.t$||o===k.F2)&&r===k.ut){X=k.I;var fe=$&&J===se&&se.visualViewport?se.visualViewport.height:J[de];M-=fe-a.height,M*=f?1:-1}if(o===k.t$||(o===k.we||o===k.I)&&r===k.ut){Q=k.F2;var he=$&&J===se&&se.visualViewport?se.visualViewport.width:J[ce];E-=he-a.width,E*=f?1:-1}}var ye=Object.assign({position:m},c&&u),le=S===!0?b({x:E,y:M},(0,U.Z)(x)):{x:E,y:M};if(E=le.x,M=le.y,f){var ue;return Object.assign({},ye,(ue={},ue[X]=Y?"0":"",ue[Q]=G?"0":"",ue.transform=(se.devicePixelRatio||1)<=1?"translate("+E+"px, "+M+"px)":"translate3d("+E+"px, "+M+"px, 0)",ue))}return Object.assign({},ye,(v={},v[X]=Y?M+"px":"",v[Q]=G?E+"px":"",v.transform="",v))}z(w,"mapToStyles");function _(p){var v=p.state,x=p.options,a=x.gpuAcceleration,o=a===void 0?!0:a,r=x.adaptive,l=r===void 0?!0:r,m=x.roundOffsets,f=m===void 0?!0:m,c={placement:(0,L.Z)(v.placement),variation:(0,d.Z)(v.placement),popper:v.elements.popper,popperRect:v.rects.popper,gpuAcceleration:o,isFixed:v.options.strategy==="fixed"};v.modifiersData.popperOffsets!=null&&(v.styles.popper=Object.assign({},v.styles.popper,w(Object.assign({},c,{offsets:v.modifiersData.popperOffsets,position:v.options.strategy,adaptive:l,roundOffsets:f})))),v.modifiersData.arrow!=null&&(v.styles.arrow=Object.assign({},v.styles.arrow,w(Object.assign({},c,{offsets:v.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),v.attributes.popper=Object.assign({},v.attributes.popper,{"data-popper-placement":v.placement})}z(_,"computeStyles");const A={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:_,data:{}}},72582:(V,W,g)=>{"use strict";g.d(W,{Z:()=>T});var k=g(61378),O={passive:!0};function U(F){var L=F.state,d=F.instance,C=F.options,u=C.scroll,b=u===void 0?!0:u,w=C.resize,_=w===void 0?!0:w,A=(0,k.Z)(L.elements.popper),p=[].concat(L.scrollParents.reference,L.scrollParents.popper);return b&&p.forEach(function(v){v.addEventListener("scroll",d.update,O)}),_&&A.addEventListener("resize",d.update,O),function(){b&&p.forEach(function(v){v.removeEventListener("scroll",d.update,O)}),_&&A.removeEventListener("resize",d.update,O)}}z(U,"effect");const T={name:"eventListeners",enabled:!0,phase:"write",fn:z(function(){},"fn"),effect:U,data:{}}},16087:(V,W,g)=>{"use strict";g.d(W,{Z:()=>_});var k={left:"right",right:"left",bottom:"top",top:"bottom"};function O(A){return A.replace(/left|right|bottom|top/g,function(p){return k[p]})}z(O,"getOppositePlacement");var U=g(65352),T={start:"end",end:"start"};function F(A){return A.replace(/start|end/g,function(p){return T[p]})}z(F,"getOppositeVariationPlacement");var L=g(24041),d=g(47408),C=g(49880);function u(A,p){p===void 0&&(p={});var v=p,x=v.placement,a=v.boundary,o=v.rootBoundary,r=v.padding,l=v.flipVariations,m=v.allowedAutoPlacements,f=m===void 0?C.Ct:m,c=(0,d.Z)(x),S=c?l?C.bw:C.bw.filter(function(E){return(0,d.Z)(E)===c}):C.mv,$=S.filter(function(E){return f.indexOf(E)>=0});$.length===0&&($=S);var P=$.reduce(function(E,D){return E[D]=(0,L.Z)(A,{placement:D,boundary:a,rootBoundary:o,padding:r})[(0,U.Z)(D)],E},{});return Object.keys(P).sort(function(E,D){return P[E]-P[D]})}z(u,"computeAutoPlacement");function b(A){if((0,U.Z)(A)===C.d7)return[];var p=O(A);return[F(A),p,F(p)]}z(b,"getExpandedFallbackPlacements");function w(A){var p=A.state,v=A.options,x=A.name;if(!p.modifiersData[x]._skip){for(var a=v.mainAxis,o=a===void 0?!0:a,r=v.altAxis,l=r===void 0?!0:r,m=v.fallbackPlacements,f=v.padding,c=v.boundary,S=v.rootBoundary,$=v.altBoundary,P=v.flipVariations,E=P===void 0?!0:P,D=v.allowedAutoPlacements,M=p.options.placement,Z=(0,U.Z)(M),G=Z===M,Y=m||(G||!E?[O(M)]:b(M)),Q=[M].concat(Y).reduce(function(j,H){return j.concat((0,U.Z)(H)===C.d7?u(p,{placement:H,boundary:c,rootBoundary:S,padding:f,flipVariations:E,allowedAutoPlacements:D}):H)},[]),X=p.rects.reference,se=p.rects.popper,J=new Map,de=!0,ce=Q[0],fe=0;fe<Q.length;fe++){var he=Q[fe],ye=(0,U.Z)(he),le=(0,d.Z)(he)===C.BL,ue=[C.we,C.I].indexOf(ye)>=0,ve=ue?"width":"height",be=(0,L.Z)(p,{placement:he,boundary:c,rootBoundary:S,altBoundary:$,padding:f}),_e=ue?le?C.F2:C.t$:le?C.I:C.we;X[ve]>se[ve]&&(_e=O(_e));var we=O(_e),ge=[];if(o&&ge.push(be[ye]<=0),l&&ge.push(be[_e]<=0,be[we]<=0),ge.every(function(j){return j})){ce=he,de=!1;break}J.set(he,ge)}if(de)for(var Se=E?3:1,Oe=z(function(H){var q=Q.find(function(ee){var ie=J.get(ee);if(ie)return ie.slice(0,H).every(function(re){return re})});if(q)return ce=q,"break"},"_loop2"),Ce=Se;Ce>0;Ce--){var N=Oe(Ce);if(N==="break")break}p.placement!==ce&&(p.modifiersData[x]._skip=!0,p.placement=ce,p.reset=!0)}}z(w,"flip");const _={name:"flip",enabled:!0,phase:"main",fn:w,requiresIfExists:["offset"],data:{_skip:!1}}},48051:(V,W,g)=>{"use strict";g.d(W,{Z:()=>L});var k=g(49880),O=g(24041);function U(d,C,u){return u===void 0&&(u={x:0,y:0}),{top:d.top-C.height-u.y,right:d.right-C.width+u.x,bottom:d.bottom-C.height+u.y,left:d.left-C.width-u.x}}z(U,"getSideOffsets");function T(d){return[k.we,k.F2,k.I,k.t$].some(function(C){return d[C]>=0})}z(T,"isAnySideFullyClipped");function F(d){var C=d.state,u=d.name,b=C.rects.reference,w=C.rects.popper,_=C.modifiersData.preventOverflow,A=(0,O.Z)(C,{elementContext:"reference"}),p=(0,O.Z)(C,{altBoundary:!0}),v=U(A,b),x=U(p,w,_),a=T(v),o=T(x);C.modifiersData[u]={referenceClippingOffsets:v,popperEscapeOffsets:x,isReferenceHidden:a,hasPopperEscaped:o},C.attributes.popper=Object.assign({},C.attributes.popper,{"data-popper-reference-hidden":a,"data-popper-escaped":o})}z(F,"hide");const L={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:F}},61150:(V,W,g)=>{"use strict";g.d(W,{Z:()=>F});var k=g(65352),O=g(49880);function U(L,d,C){var u=(0,k.Z)(L),b=[O.t$,O.we].indexOf(u)>=0?-1:1,w=typeof C=="function"?C(Object.assign({},d,{placement:L})):C,_=w[0],A=w[1];return _=_||0,A=(A||0)*b,[O.t$,O.F2].indexOf(u)>=0?{x:A,y:_}:{x:_,y:A}}z(U,"distanceAndSkiddingToXY");function T(L){var d=L.state,C=L.options,u=L.name,b=C.offset,w=b===void 0?[0,0]:b,_=O.Ct.reduce(function(x,a){return x[a]=U(a,d.rects,w),x},{}),A=_[d.placement],p=A.x,v=A.y;d.modifiersData.popperOffsets!=null&&(d.modifiersData.popperOffsets.x+=p,d.modifiersData.popperOffsets.y+=v),d.modifiersData[u]=_}z(T,"offset");const F={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:T}},35772:(V,W,g)=>{"use strict";g.d(W,{Z:()=>U});var k=g(47840);function O(T){var F=T.state,L=T.name;F.modifiersData[L]=(0,k.Z)({reference:F.rects.reference,element:F.rects.popper,strategy:"absolute",placement:F.placement})}z(O,"popperOffsets");const U={name:"popperOffsets",enabled:!0,phase:"read",fn:O,data:{}}},29228:(V,W,g)=>{"use strict";g.d(W,{Z:()=>A});var k=g(49880),O=g(65352),U=g(61919);function T(p){return p==="x"?"y":"x"}z(T,"getAltAxis");var F=g(72907),L=g(5618),d=g(52839),C=g(24041),u=g(47408),b=g(29852),w=g(62079);function _(p){var v=p.state,x=p.options,a=p.name,o=x.mainAxis,r=o===void 0?!0:o,l=x.altAxis,m=l===void 0?!1:l,f=x.boundary,c=x.rootBoundary,S=x.altBoundary,$=x.padding,P=x.tether,E=P===void 0?!0:P,D=x.tetherOffset,M=D===void 0?0:D,Z=(0,C.Z)(v,{boundary:f,rootBoundary:c,padding:$,altBoundary:S}),G=(0,O.Z)(v.placement),Y=(0,u.Z)(v.placement),Q=!Y,X=(0,U.Z)(G),se=T(X),J=v.modifiersData.popperOffsets,de=v.rects.reference,ce=v.rects.popper,fe=typeof M=="function"?M(Object.assign({},v.rects,{placement:v.placement})):M,he=typeof fe=="number"?{mainAxis:fe,altAxis:fe}:Object.assign({mainAxis:0,altAxis:0},fe),ye=v.modifiersData.offset?v.modifiersData.offset[v.placement]:null,le={x:0,y:0};if(J){if(r){var ue,ve=X==="y"?k.we:k.t$,be=X==="y"?k.I:k.F2,_e=X==="y"?"height":"width",we=J[X],ge=we+Z[ve],Se=we-Z[be],Oe=E?-ce[_e]/2:0,Ce=Y===k.BL?de[_e]:ce[_e],N=Y===k.BL?-ce[_e]:-de[_e],j=v.elements.arrow,H=E&&j?(0,L.Z)(j):{width:0,height:0},q=v.modifiersData["arrow#persistent"]?v.modifiersData["arrow#persistent"].padding:(0,b.Z)(),ee=q[ve],ie=q[be],re=(0,F.u)(0,de[_e],H[_e]),me=Q?de[_e]/2-Oe-re-ee-he.mainAxis:Ce-re-ee-he.mainAxis,Pe=Q?-de[_e]/2+Oe+re+ie+he.mainAxis:N+re+ie+he.mainAxis,Qe=v.elements.arrow&&(0,d.Z)(v.elements.arrow),lt=Qe?X==="y"?Qe.clientTop||0:Qe.clientLeft||0:0,et=(ue=ye?.[X])!=null?ue:0,ct=we+me-et-lt,dt=we+Pe-et,tt=(0,F.u)(E?(0,w.VV)(ge,ct):ge,we,E?(0,w.Fp)(Se,dt):Se);J[X]=tt,le[X]=tt-we}if(m){var st,ut=X==="x"?k.we:k.t$,He=X==="x"?k.I:k.F2,$e=J[se],Re=se==="y"?"height":"width",Ke=$e+Z[ut],ae=$e-Z[He],Te=[k.we,k.t$].indexOf(G)!==-1,Be=(st=ye?.[se])!=null?st:0,Le=Te?Ke:$e-de[Re]-ce[Re]-Be+he.altAxis,it=Te?$e+de[Re]+ce[Re]-Be-he.altAxis:ae,Ie=E&&Te?(0,F.q)(Le,$e,it):(0,F.u)(E?Le:Ke,$e,E?it:ae);J[se]=Ie,le[se]=Ie-$e}v.modifiersData[a]=le}}z(_,"preventOverflow");const A={name:"preventOverflow",enabled:!0,phase:"main",fn:_,requiresIfExists:["offset"]}},78224:(V,W,g)=>{"use strict";g.d(W,{fi:()=>_});var k=g(5926),O=g(72582),U=g(35772),T=g(24502),F=g(32898),L=g(61150),d=g(16087),C=g(29228),u=g(63454),b=g(48051),w=[O.Z,U.Z,T.Z,F.Z,L.Z,d.Z,C.Z,u.Z,b.Z],_=(0,k.kZ)({defaultModifiers:w})},47840:(V,W,g)=>{"use strict";g.d(W,{Z:()=>F});var k=g(65352),O=g(47408),U=g(61919),T=g(49880);function F(L){var d=L.reference,C=L.element,u=L.placement,b=u?(0,k.Z)(u):null,w=u?(0,O.Z)(u):null,_=d.x+d.width/2-C.width/2,A=d.y+d.height/2-C.height/2,p;switch(b){case T.we:p={x:_,y:d.y-C.height};break;case T.I:p={x:_,y:d.y+d.height};break;case T.F2:p={x:d.x+d.width,y:A};break;case T.t$:p={x:d.x-C.width,y:A};break;default:p={x:d.x,y:d.y}}var v=b?(0,U.Z)(b):null;if(v!=null){var x=v==="y"?"height":"width";switch(w){case T.BL:p[v]=p[v]-(d[x]/2-C[x]/2);break;case T.ut:p[v]=p[v]+(d[x]/2-C[x]/2);break;default:}}return p}z(F,"computeOffsets")},24041:(V,W,g)=>{"use strict";g.d(W,{Z:()=>P});var k=g(49880),O=g(61378),U=g(4377),T=g(61300),F=g(16182);function L(E,D){var M=(0,O.Z)(E),Z=(0,U.Z)(E),G=M.visualViewport,Y=Z.clientWidth,Q=Z.clientHeight,X=0,se=0;if(G){Y=G.width,Q=G.height;var J=(0,F.Z)();(J||!J&&D==="fixed")&&(X=G.offsetLeft,se=G.offsetTop)}return{width:Y,height:Q,x:X+(0,T.Z)(E),y:se}}z(L,"getViewportRect");var d=g(26302),C=g(23111),u=g(62079);function b(E){var D,M=(0,U.Z)(E),Z=(0,C.Z)(E),G=(D=E.ownerDocument)==null?void 0:D.body,Y=(0,u.Fp)(M.scrollWidth,M.clientWidth,G?G.scrollWidth:0,G?G.clientWidth:0),Q=(0,u.Fp)(M.scrollHeight,M.clientHeight,G?G.scrollHeight:0,G?G.clientHeight:0),X=-Z.scrollLeft+(0,T.Z)(E),se=-Z.scrollTop;return(0,d.Z)(G||M).direction==="rtl"&&(X+=(0,u.Fp)(M.clientWidth,G?G.clientWidth:0)-Y),{width:Y,height:Q,x:X,y:se}}z(b,"getDocumentRect");var w=g(26857),_=g(52839),A=g(52319),p=g(57845),v=g(85564),x=g(75865),a=g(43332);function o(E){return Object.assign({},E,{left:E.x,top:E.y,right:E.x+E.width,bottom:E.y+E.height})}z(o,"rectToClientRect");function r(E,D){var M=(0,p.Z)(E,!1,D==="fixed");return M.top=M.top+E.clientTop,M.left=M.left+E.clientLeft,M.bottom=M.top+E.clientHeight,M.right=M.left+E.clientWidth,M.width=E.clientWidth,M.height=E.clientHeight,M.x=M.left,M.y=M.top,M}z(r,"getInnerBoundingClientRect");function l(E,D,M){return D===k.Pj?o(L(E,M)):(0,A.kK)(D)?r(D,M):o(b((0,U.Z)(E)))}z(l,"getClientRectFromMixedType");function m(E){var D=(0,w.Z)((0,v.Z)(E)),M=["absolute","fixed"].indexOf((0,d.Z)(E).position)>=0,Z=M&&(0,A.Re)(E)?(0,_.Z)(E):E;return(0,A.kK)(Z)?D.filter(function(G){return(0,A.kK)(G)&&(0,x.Z)(G,Z)&&(0,a.Z)(G)!=="body"}):[]}z(m,"getClippingParents");function f(E,D,M,Z){var G=D==="clippingParents"?m(E):[].concat(D),Y=[].concat(G,[M]),Q=Y[0],X=Y.reduce(function(se,J){var de=l(E,J,Z);return se.top=(0,u.Fp)(de.top,se.top),se.right=(0,u.VV)(de.right,se.right),se.bottom=(0,u.VV)(de.bottom,se.bottom),se.left=(0,u.Fp)(de.left,se.left),se},l(E,Q,Z));return X.width=X.right-X.left,X.height=X.bottom-X.top,X.x=X.left,X.y=X.top,X}z(f,"getClippingRect");var c=g(47840),S=g(49534),$=g(62219);function P(E,D){D===void 0&&(D={});var M=D,Z=M.placement,G=Z===void 0?E.placement:Z,Y=M.strategy,Q=Y===void 0?E.strategy:Y,X=M.boundary,se=X===void 0?k.zV:X,J=M.rootBoundary,de=J===void 0?k.Pj:J,ce=M.elementContext,fe=ce===void 0?k.k5:ce,he=M.altBoundary,ye=he===void 0?!1:he,le=M.padding,ue=le===void 0?0:le,ve=(0,S.Z)(typeof ue!="number"?ue:(0,$.Z)(ue,k.mv)),be=fe===k.k5?k.YP:k.k5,_e=E.rects.popper,we=E.elements[ye?be:fe],ge=f((0,A.kK)(we)?we:we.contextElement||(0,U.Z)(E.elements.popper),se,de,Q),Se=(0,p.Z)(E.elements.reference),Oe=(0,c.Z)({reference:Se,element:_e,strategy:"absolute",placement:G}),Ce=o(Object.assign({},_e,Oe)),N=fe===k.k5?Ce:Se,j={top:ge.top-N.top+ve.top,bottom:N.bottom-ge.bottom+ve.bottom,left:ge.left-N.left+ve.left,right:N.right-ge.right+ve.right},H=E.modifiersData.offset;if(fe===k.k5&&H){var q=H[G];Object.keys(j).forEach(function(ee){var ie=[k.F2,k.I].indexOf(ee)>=0?1:-1,re=[k.we,k.I].indexOf(ee)>=0?"y":"x";j[ee]+=q[re]*ie})}return j}z(P,"detectOverflow")},62219:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O,U){return U.reduce(function(T,F){return T[F]=O,T},{})}z(k,"expandToHashMap")},65352:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O){return O.split("-")[0]}z(k,"getBasePlacement")},29852:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(){return{top:0,right:0,bottom:0,left:0}}z(k,"getFreshSideObject")},61919:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O){return["top","bottom"].indexOf(O)>=0?"x":"y"}z(k,"getMainAxisFromPlacement")},47408:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(O){return O.split("-")[1]}z(k,"getVariation")},62079:(V,W,g)=>{"use strict";g.d(W,{Fp:()=>k,NM:()=>U,VV:()=>O});var k=Math.max,O=Math.min,U=Math.round},49534:(V,W,g)=>{"use strict";g.d(W,{Z:()=>O});var k=g(29852);function O(U){return Object.assign({},(0,k.Z)(),U)}z(O,"mergePaddingObject")},3518:(V,W,g)=>{"use strict";g.d(W,{Z:()=>k});function k(){var O=navigator.userAgentData;return O!=null&&O.brands&&Array.isArray(O.brands)?O.brands.map(function(U){return U.brand+"/"+U.version}).join(" "):navigator.userAgent}z(k,"getUAString")},72907:(V,W,g)=>{"use strict";g.d(W,{q:()=>U,u:()=>O});var k=g(62079);function O(T,F,L){return(0,k.Fp)(T,(0,k.VV)(F,L))}z(O,"within");function U(T,F,L){var d=O(T,F,L);return d>L?L:d}z(U,"withinMaxClamp")},41182:function(V,W,g){(function(k,O){V.exports=W=O()})(this,function(){var k=k||function(O,U){var T;if(typeof window<"u"&&window.crypto&&(T=window.crypto),typeof self<"u"&&self.crypto&&(T=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(T=globalThis.crypto),!T&&typeof window<"u"&&window.msCrypto&&(T=window.msCrypto),!T&&typeof global<"u"&&global.crypto&&(T=global.crypto),!T)try{T=g(91054)}catch{}var F=z(function(){if(T){if(typeof T.getRandomValues=="function")try{return T.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof T.randomBytes=="function")try{return T.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},"cryptoSecureRandomInt"),L=Object.create||function(){function o(){}return z(o,"F"),function(r){var l;return o.prototype=r,l=new o,o.prototype=null,l}}(),d={},C=d.lib={},u=C.Base=function(){return{extend:function(o){var r=L(this);return o&&r.mixIn(o),(!r.hasOwnProperty("init")||this.init===r.init)&&(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var o=this.extend();return o.init.apply(o,arguments),o},init:function(){},mixIn:function(o){for(var r in o)o.hasOwnProperty(r)&&(this[r]=o[r]);o.hasOwnProperty("toString")&&(this.toString=o.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),b=C.WordArray=u.extend({init:function(o,r){o=this.words=o||[],r!=U?this.sigBytes=r:this.sigBytes=o.length*4},toString:function(o){return(o||_).stringify(this)},concat:function(o){var r=this.words,l=o.words,m=this.sigBytes,f=o.sigBytes;if(this.clamp(),m%4)for(var c=0;c<f;c++){var S=l[c>>>2]>>>24-c%4*8&255;r[m+c>>>2]|=S<<24-(m+c)%4*8}else for(var $=0;$<f;$+=4)r[m+$>>>2]=l[$>>>2];return this.sigBytes+=f,this},clamp:function(){var o=this.words,r=this.sigBytes;o[r>>>2]&=4294967295<<32-r%4*8,o.length=O.ceil(r/4)},clone:function(){var o=u.clone.call(this);return o.words=this.words.slice(0),o},random:function(o){for(var r=[],l=0;l<o;l+=4)r.push(F());return new b.init(r,o)}}),w=d.enc={},_=w.Hex={stringify:function(o){for(var r=o.words,l=o.sigBytes,m=[],f=0;f<l;f++){var c=r[f>>>2]>>>24-f%4*8&255;m.push((c>>>4).toString(16)),m.push((c&15).toString(16))}return m.join("")},parse:function(o){for(var r=o.length,l=[],m=0;m<r;m+=2)l[m>>>3]|=parseInt(o.substr(m,2),16)<<24-m%8*4;return new b.init(l,r/2)}},A=w.Latin1={stringify:function(o){for(var r=o.words,l=o.sigBytes,m=[],f=0;f<l;f++){var c=r[f>>>2]>>>24-f%4*8&255;m.push(String.fromCharCode(c))}return m.join("")},parse:function(o){for(var r=o.length,l=[],m=0;m<r;m++)l[m>>>2]|=(o.charCodeAt(m)&255)<<24-m%4*8;return new b.init(l,r)}},p=w.Utf8={stringify:function(o){try{return decodeURIComponent(escape(A.stringify(o)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(o){return A.parse(unescape(encodeURIComponent(o)))}},v=C.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new b.init,this._nDataBytes=0},_append:function(o){typeof o=="string"&&(o=p.parse(o)),this._data.concat(o),this._nDataBytes+=o.sigBytes},_process:function(o){var r,l=this._data,m=l.words,f=l.sigBytes,c=this.blockSize,S=c*4,$=f/S;o?$=O.ceil($):$=O.max(($|0)-this._minBufferSize,0);var P=$*c,E=O.min(P*4,f);if(P){for(var D=0;D<P;D+=c)this._doProcessBlock(m,D);r=m.splice(0,P),l.sigBytes-=E}return new b.init(r,E)},clone:function(){var o=u.clone.call(this);return o._data=this._data.clone(),o},_minBufferSize:0}),x=C.Hasher=v.extend({cfg:u.extend(),init:function(o){this.cfg=this.cfg.extend(o),this.reset()},reset:function(){v.reset.call(this),this._doReset()},update:function(o){return this._append(o),this._process(),this},finalize:function(o){o&&this._append(o);var r=this._doFinalize();return r},blockSize:512/32,_createHelper:function(o){return function(r,l){return new o.init(l).finalize(r)}},_createHmacHelper:function(o){return function(r,l){return new a.HMAC.init(o,l).finalize(r)}}}),a=d.algo={};return d}(Math);return k})},99968:function(V,W,g){(function(k,O){V.exports=W=O(g(41182))})(this,function(k){return function(){var O=k,U=O.lib,T=U.WordArray,F=U.Hasher,L=O.algo,d=[],C=L.SHA1=F.extend({_doReset:function(){this._hash=new T.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,b){for(var w=this._hash.words,_=w[0],A=w[1],p=w[2],v=w[3],x=w[4],a=0;a<80;a++){if(a<16)d[a]=u[b+a]|0;else{var o=d[a-3]^d[a-8]^d[a-14]^d[a-16];d[a]=o<<1|o>>>31}var r=(_<<5|_>>>27)+x+d[a];a<20?r+=(A&p|~A&v)+1518500249:a<40?r+=(A^p^v)+1859775393:a<60?r+=(A&p|A&v|p&v)-1894007588:r+=(A^p^v)-899497514,x=v,v=p,p=A<<30|A>>>2,A=_,_=r}w[0]=w[0]+_|0,w[1]=w[1]+A|0,w[2]=w[2]+p|0,w[3]=w[3]+v|0,w[4]=w[4]+x|0},_doFinalize:function(){var u=this._data,b=u.words,w=this._nDataBytes*8,_=u.sigBytes*8;return b[_>>>5]|=128<<24-_%32,b[(_+64>>>9<<4)+14]=Math.floor(w/4294967296),b[(_+64>>>9<<4)+15]=w,u.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var u=F.clone.call(this);return u._hash=this._hash.clone(),u}});O.SHA1=F._createHelper(C),O.HmacSHA1=F._createHmacHelper(C)}(),k.SHA1})},51722:function(V){(function(W,g){V.exports=g()})(this,function(){"use strict";var W=1e3,g=6e4,k=36e5,O="millisecond",U="second",T="minute",F="hour",L="day",d="week",C="month",u="quarter",b="year",w="date",_="Invalid Date",A=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},x=z(function(P,E,D){var M=String(P);return!M||M.length>=E?P:""+Array(E+1-M.length).join(D)+P},"m"),a={s:x,z:function(P){var E=-P.utcOffset(),D=Math.abs(E),M=Math.floor(D/60),Z=D%60;return(E<=0?"+":"-")+x(M,2,"0")+":"+x(Z,2,"0")},m:z(function P(E,D){if(E.date()<D.date())return-P(D,E);var M=12*(D.year()-E.year())+(D.month()-E.month()),Z=E.clone().add(M,C),G=D-Z<0,Y=E.clone().add(M+(G?-1:1),C);return+(-(M+(D-Z)/(G?Z-Y:Y-Z))||0)},"t3"),a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:C,y:b,w:d,d:L,D:w,h:F,m:T,s:U,ms:O,Q:u}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},o="en",r={};r[o]=v;var l=z(function(P){return P instanceof S},"p"),m=z(function(P,E,D){var M;if(!P)return o;if(typeof P=="string")r[P]&&(M=P),E&&(r[P]=E,M=P);else{var Z=P.name;r[Z]=P,M=Z}return!D&&M&&(o=M),M||!D&&o},"S"),f=z(function(P,E){if(l(P))return P.clone();var D=typeof E=="object"?E:{};return D.date=P,D.args=arguments,new S(D)},"w"),c=a;c.l=m,c.i=l,c.w=function(P,E){return f(P,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var S=function(){function P(D){this.$L=m(D.locale,null,!0),this.parse(D)}z(P,"M2");var E=P.prototype;return E.parse=function(D){this.$d=function(M){var Z=M.date,G=M.utc;if(Z===null)return new Date(NaN);if(c.u(Z))return new Date;if(Z instanceof Date)return new Date(Z);if(typeof Z=="string"&&!/Z$/i.test(Z)){var Y=Z.match(A);if(Y){var Q=Y[2]-1||0,X=(Y[7]||"0").substring(0,3);return G?new Date(Date.UTC(Y[1],Q,Y[3]||1,Y[4]||0,Y[5]||0,Y[6]||0,X)):new Date(Y[1],Q,Y[3]||1,Y[4]||0,Y[5]||0,Y[6]||0,X)}}return new Date(Z)}(D),this.$x=D.x||{},this.init()},E.init=function(){var D=this.$d;this.$y=D.getFullYear(),this.$M=D.getMonth(),this.$D=D.getDate(),this.$W=D.getDay(),this.$H=D.getHours(),this.$m=D.getMinutes(),this.$s=D.getSeconds(),this.$ms=D.getMilliseconds()},E.$utils=function(){return c},E.isValid=function(){return this.$d.toString()!==_},E.isSame=function(D,M){var Z=f(D);return this.startOf(M)<=Z&&Z<=this.endOf(M)},E.isAfter=function(D,M){return f(D)<this.startOf(M)},E.isBefore=function(D,M){return this.endOf(M)<f(D)},E.$g=function(D,M,Z){return c.u(D)?this[M]:this.set(Z,D)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(D,M){var Z=this,G=!!c.u(M)||M,Y=c.p(D),Q=z(function(ye,le){var ue=c.w(Z.$u?Date.UTC(Z.$y,le,ye):new Date(Z.$y,le,ye),Z);return G?ue:ue.endOf(L)},"$2"),X=z(function(ye,le){return c.w(Z.toDate()[ye].apply(Z.toDate("s"),(G?[0,0,0,0]:[23,59,59,999]).slice(le)),Z)},"l2"),se=this.$W,J=this.$M,de=this.$D,ce="set"+(this.$u?"UTC":"");switch(Y){case b:return G?Q(1,0):Q(31,11);case C:return G?Q(1,J):Q(0,J+1);case d:var fe=this.$locale().weekStart||0,he=(se<fe?se+7:se)-fe;return Q(G?de-he:de+(6-he),J);case L:case w:return X(ce+"Hours",0);case F:return X(ce+"Minutes",1);case T:return X(ce+"Seconds",2);case U:return X(ce+"Milliseconds",3);default:return this.clone()}},E.endOf=function(D){return this.startOf(D,!1)},E.$set=function(D,M){var Z,G=c.p(D),Y="set"+(this.$u?"UTC":""),Q=(Z={},Z[L]=Y+"Date",Z[w]=Y+"Date",Z[C]=Y+"Month",Z[b]=Y+"FullYear",Z[F]=Y+"Hours",Z[T]=Y+"Minutes",Z[U]=Y+"Seconds",Z[O]=Y+"Milliseconds",Z)[G],X=G===L?this.$D+(M-this.$W):M;if(G===C||G===b){var se=this.clone().set(w,1);se.$d[Q](X),se.init(),this.$d=se.set(w,Math.min(this.$D,se.daysInMonth())).$d}else Q&&this.$d[Q](X);return this.init(),this},E.set=function(D,M){return this.clone().$set(D,M)},E.get=function(D){return this[c.p(D)]()},E.add=function(D,M){var Z,G=this;D=Number(D);var Y=c.p(M),Q=z(function(J){var de=f(G);return c.w(de.date(de.date()+Math.round(J*D)),G)},"y2");if(Y===C)return this.set(C,this.$M+D);if(Y===b)return this.set(b,this.$y+D);if(Y===L)return Q(1);if(Y===d)return Q(7);var X=(Z={},Z[T]=g,Z[F]=k,Z[U]=W,Z)[Y]||1,se=this.$d.getTime()+D*X;return c.w(se,this)},E.subtract=function(D,M){return this.add(-1*D,M)},E.format=function(D){var M=this,Z=this.$locale();if(!this.isValid())return Z.invalidDate||_;var G=D||"YYYY-MM-DDTHH:mm:ssZ",Y=c.z(this),Q=this.$H,X=this.$m,se=this.$M,J=Z.weekdays,de=Z.months,ce=z(function(le,ue,ve,be){return le&&(le[ue]||le(M,G))||ve[ue].substr(0,be)},"h2"),fe=z(function(le){return c.s(Q%12||12,le,"0")},"c2"),he=Z.meridiem||function(le,ue,ve){var be=le<12?"AM":"PM";return ve?be.toLowerCase():be},ye={YY:String(this.$y).slice(-2),YYYY:this.$y,M:se+1,MM:c.s(se+1,2,"0"),MMM:ce(Z.monthsShort,se,de,3),MMMM:ce(de,se),D:this.$D,DD:c.s(this.$D,2,"0"),d:String(this.$W),dd:ce(Z.weekdaysMin,this.$W,J,2),ddd:ce(Z.weekdaysShort,this.$W,J,3),dddd:J[this.$W],H:String(Q),HH:c.s(Q,2,"0"),h:fe(1),hh:fe(2),a:he(Q,X,!0),A:he(Q,X,!1),m:String(X),mm:c.s(X,2,"0"),s:String(this.$s),ss:c.s(this.$s,2,"0"),SSS:c.s(this.$ms,3,"0"),Z:Y};return G.replace(p,function(le,ue){return ue||ye[le]||Y.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(D,M,Z){var G,Y=c.p(M),Q=f(D),X=(Q.utcOffset()-this.utcOffset())*g,se=this-Q,J=c.m(this,Q);return J=(G={},G[b]=J/12,G[C]=J,G[u]=J/3,G[d]=(se-X)/6048e5,G[L]=(se-X)/864e5,G[F]=se/k,G[T]=se/g,G[U]=se/W,G)[Y]||se,Z?J:c.a(J)},E.daysInMonth=function(){return this.endOf(C).$D},E.$locale=function(){return r[this.$L]},E.locale=function(D,M){if(!D)return this.$L;var Z=this.clone(),G=m(D,M,!0);return G&&(Z.$L=G),Z},E.clone=function(){return c.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},P}(),$=S.prototype;return f.prototype=$,[["$ms",O],["$s",U],["$m",T],["$H",F],["$W",L],["$M",C],["$y",b],["$D",w]].forEach(function(P){$[P[1]]=function(E){return this.$g(E,P[0],P[1])}}),f.extend=function(P,E){return P.$i||(P(E,S,f),P.$i=!0),f},f.locale=m,f.isDayjs=l,f.unix=function(P){return f(1e3*P)},f.en=r[o],f.Ls=r,f.p={},f})},92045:function(V){(function(W,g){V.exports=g()})(this,function(){"use strict";return function(W,g,k){W=W||{};var O=g.prototype,U={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function T(L,d,C,u){return O.fromToBase(L,d,C,u)}z(T,"i"),k.en.relativeTime=U,O.fromToBase=function(L,d,C,u,b){for(var w,_,A,p=C.$locale().relativeTime||U,v=W.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],x=v.length,a=0;a<x;a+=1){var o=v[a];o.d&&(w=u?k(L).diff(C,o.d,!0):C.diff(L,o.d,!0));var r=(W.rounding||Math.round)(Math.abs(w));if(A=w>0,r<=o.r||!o.r){r<=1&&a>0&&(o=v[a-1]);var l=p[o.l];b&&(r=b(""+r)),_=typeof l=="string"?l.replace("%d",r):l(r,d,o.l,A);break}}if(d)return _;var m=A?p.future:p.past;return typeof m=="function"?m(_):m.replace("%s",_)},O.to=function(L,d){return T(L,d,this,!0)},O.from=function(L,d){return T(L,d,this)};var F=z(function(L){return L.$u?k.utc():k()},"d");O.toNow=function(L){return this.to(F(this),L)},O.fromNow=function(L){return this.from(F(this),L)}}})},33612:(V,W,g)=>{"use strict";g.d(W,{Z:()=>T});var k=g(22527);let O=0,U=0;const F=class F extends k.default{constructor(d,C){super(d,C),this._id=`_ffz$${O++}`,this.log.info(`Using: ${this.constructor.name}`)}getReact(){if(this._react)return this._react;let d;try{d=this.getCore?.()?.intl?.react}catch{}if(d?.Component&&d.createElement)return this._react=d;if(d=this.resolve("site.web_munch")?.getModule?.("react"),d?.Component&&d.createElement)return this._react=d}getReactDom(){if(this._reactDom)return this._reactDom;let d=this.resolve("site.web_munch")?.getModule?.("react-dom");if(d?.createPortal)return this._reactDom=d}findReact(){const d=this.getReact();if(d)return Promise.resolve(d);const C=this.resolve("site.web_munch");return C?C.findModule("react"):this.waitFor("site.web_munch:registered").then(()=>this.findReact())}awaitElement(d,C,u=6e4){C||(C=document.documentElement);const b=C.querySelector(d);return b?Promise.resolve(b):new Promise((w,_)=>{const A=`${this._id}$observer`,p=C[A],v=U++,x=u&&setTimeout(()=>{const o=C[A];if(!o)return;const[r,l]=o;for(let m=0;m<l.length;m++){const f=l[m];if(f[0]===v){l.splice(m,1),f[3]("Timed out");break}}l.length||(r.disconnect(),C[A]=null)},u);if(p){p[1].push([v,d,w,_,x]);return}const a=new MutationObserver(()=>{const o=C[A];if(!o){a.disconnect();return}const r=o[1];for(let l=0;l<r.length;l++){const m=r[l],f=C.querySelector(m[1]);f&&(r.splice(l,1),l--,m[4]&&clearTimeout(m[4]),m[2](f))}r.length||(a.disconnect(),C[A]=null)});C[A]=[a,[[v,d,w,_,x]]],a.observe(C,{childList:!0,attributes:!0,characterData:!0,subtree:!0})})}};z(F,"BaseSite");let T=F},10789:(V,W,g)=>{"use strict";g.d(W,{Z:()=>x});var k=g(22527),O=g(44589),U=g(46949),T=g(83342);const F=(0,O.createElement)("span"),L=".video-player__default-player .player-controls__left-control-group",d=".video-player__default-player .player-controls__right-control-group",C=window.AudioContext&&window.DynamicsCompressorNode!=null,u=C&&window.GainNode!=null,b="setting.entry.player.volume-scroll.values",w=[{value:!1,title:"Disabled",i18n_key:`${b}.false`},{value:!0,title:"Enabled",i18n_key:`${b}.true`},{value:2,title:"Enabled with Right-Click",i18n_key:`${b}.2`},{value:3,title:"Enabled with Alt",i18n_key:`${b}.3`},{value:4,title:"Enabled with Alt + Right-Click",i18n_key:`${b}.4`},{value:5,title:"Enabled with Shift",i18n_key:`${b}.5`},{value:6,title:"Enabled with Shift + Right-Click",i18n_key:`${b}.6`},{value:7,title:"Enabled with Ctrl",i18n_key:`${b}.7`},{value:8,title:"Enabled with Ctrl + Right-Click",i18n_key:`${b}.8`}];function _(o){return o.querySelector('button[aria-label*="alt+x"]')??o.querySelector('button[aria-label]:has(path[d="M8 9H6v2h2V9zm1 0h2v2H9V9zm5 0h-2v2h2V9z"]')}z(_,"getNativeClipButton");function A(o){return o===2||o===4||o===6||o===8}z(A,"wantsRMB");function p(o,r,l){return!(A(o)&&r.button!==2&&!l||!r.altKey&&(o===3||o===4)||!r.shiftKey&&(o===5||o===6)||!r.ctrlKey&&(o===7||o===8))}z(p,"matchesEvent");function v(o){const r=o.currentTarget,l=r&&r.querySelector("figure");!l||l.classList.contains("ffz-i-t-reset-clicked")||(l.classList.toggle("ffz-i-t-reset",!1),l.classList.toggle("ffz-i-t-reset-clicked",!0),setTimeout(()=>{l.classList.toggle("ffz-i-t-reset",!0),l.classList.toggle("ffz-i-t-reset-clicked",!1)},500))}z(v,"rotateButton");const a=class a extends k.default{constructor(...r){super(...r),this.inject("i18n"),this.inject("settings"),this.inject("site.fine"),this.inject("site.css_tweaks"),this.onShortcut=this.onShortcut.bind(this),this.LEFT_CONTROLS=L,this.RIGHT_CONTROLS=d,this.registerSettings()}registerSettings(){this.settings.add("player.embed-metadata",{default:!0,ui:{path:"Player > General >> Embed and Popout",title:"Show metadata when mousing over the player.",component:"setting-check-box"}}),this.settings.add("player.cast-button.hide",{default:!1,ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Hide the Cast button."},changed:r=>this.css_tweaks.toggleHide("player-cast",r)}),this.settings.add("player.clip-button.hide-native",{default:null,requires:["player.clip-button.custom"],process:(r,l)=>l??r.get("player.clip-button.custom"),ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Hide the native Clip button.",description:"By default, this is enabled when using the setting to add a custom Clip button."},changed:r=>this.css_tweaks.toggle("player-hide-native-clip",r)}),this.settings.add("player.clip-button.custom",{default:!1,ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Display a custom Clip button.",description:"Add a custom Clip button to the player that better fits the style of the other buttons."},changed:()=>{for(const r of this.Player.instances)this.addClipButton(r)}}),this.settings.add("player.fade-pause-buffer",{default:!1,ui:{path:"Player > General >> Playback",title:"Fade the player when paused or buffering to make the UI easier to see.",component:"setting-check-box"},changed:r=>this.css_tweaks.toggle("player-fade-paused",r)}),this.settings.add("player.disable-content-warnings",{default:!1,ui:{path:"Player > General >> General",title:"Do not display content warnings.",description:"When this is enabled, FFZ will automatically skip content warnings. This feature is intended for use by adults only.",component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.skipContentWarnings(r)}}),C&&(this.settings.add("player.compressor.enable",{default:!0,ui:{path:'Player > Compressor @{"description": "These settings control optional dynamic range compression for the player, a form of audio processing that reduces the volume of loud sounds and amplifies quiet sounds, thus normalizing or compressing the volume. This uses a [DynamicsCompressorNode](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode) from the Web Audio API behind the scenes if you want to learn more."} >> General',title:"Enable the audio compressor and add an `Audio Compressor` button to the player controls.",sort:-1e3,component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.addCompressorButton(r)}}),this.settings.add("player.compressor.default",{default:!1,ui:{path:"Player > Compressor >> General",title:"Enable the compressor by default.",component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.compressPlayer(r)}}),this.settings.add("player.compressor.force-legacy",{default:!1,ui:{path:"Player > Compressor >> Advanced",title:"Force use of legacy browser API.",description:"This setting forces FrankerFaceZ to attempt to use an older browser API to create the compressor. Please reset your player after changing this setting.",component:"setting-check-box",force_seen:!0}}),this.settings.add("player.compressor.shortcut",{default:null,requires:["player.compressor.enable"],process(r,l){return r.get("player.compressor.enable")?l:null},ui:{path:"Player > Compressor >> General",title:"Shortcut Key",description:"This key sequence can be used to toggle the compressor.",component:"setting-hotkey"},changed:()=>{this.updateShortcut();for(const r of this.Player.instances)this.addCompressorButton(r)}}),u&&(this.settings.add("player.gain.enable",{default:!1,ui:{sort:-1,path:'Player > Compressor >> Gain Control @{"sort": 50, "description": "Gain Control gives you extra control over the output volume when using the Compressor by letting you adjust the volume after the compressor runs, while the built-in volume slider takes affect before the compressor. This uses a simple [GainNode](https://developer.mozilla.org/en-US/docs/Web/API/GainNode) from the Web Audio API, connected in sequence after the DynamicsCompressorNode the Compressor uses."}',title:"Enable gain control when the audio compressor is enabled.",component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.compressPlayer(r)}}),this.settings.add("player.gain.no-volume",{default:!1,requires:["player.gain.enable"],process(r,l){return r.get("player.gain.enable")?l:!1},ui:{path:"Player > Compressor >> Gain Control",title:"Force built-in volume to 100% when the audio compressor is enabled.",description:"With this enabled, the built-in volume will be hidden and the Gain Control will be the only way to change volume.",component:"setting-check-box"},changed:r=>{this.css_tweaks.toggleHide("player-gain-volume",r);for(const l of this.Player.instances)this.updateGainVolume(l)}}),this.settings.add("player.gain.scroll",{default:!1,ui:{path:"Player > Compressor >> Gain Control",title:"Scroll Adjust",description:"Adjust the gain by scrolling with the mouse wheel. This setting takes precedence over adjusting the volume by scrolling. *This setting will not work properly on streams with visible extensions when mouse interaction with extensions is allowed.*",component:"setting-select-box",data:w}}),this.settings.add("player.gain.default",{default:100,requires:["player.gain.min","player.gain.max"],process(r,l){const m=r.get("player.gain.min"),f=r.get("player.gain.max");return l/=100,l<m&&(l=m),l>f&&(l=f),l},ui:{path:"Player > Compressor >> Gain Control",title:"Default Value",component:"setting-text-box",description:"The default value for gain control, when gain control is enabled. 100% means no change in volume.",process:"to_int",bounds:[0,!0]},changed:()=>this.updateGains()}),this.settings.add("player.gain.min",{default:0,process:(r,l)=>l/100,ui:{path:"Player > Compressor >> Gain Control",title:"Minimum",component:"setting-text-box",description:`**Range:** 0 ~ 100

The minimum allowed value for gain control. 0% is effectively muted.`,process:"to_int",bounds:[0,!0,100,!0]},changed:()=>this.updateGains()}),this.settings.add("player.gain.max",{default:200,process:(r,l)=>l/100,ui:{path:"Player > Compressor >> Gain Control",title:"Maximum",component:"setting-text-box",description:`**Range:** 100 ~ 1000

The maximum allowed value for gain control. 100% is no change. 200% is double the volume.`,process:"to_int",bounds:[100,!0,1e3,!0]},changed:()=>this.updateGains()})),this.settings.add("player.compressor.threshold",{default:-50,ui:{path:'Player > Compressor >> Advanced @{"sort": 1000}',title:"Threshold",sort:0,description:`**Range:** -100 ~ 0

The decibel value above which the compression will start taking effect.`,component:"setting-text-box",process:"to_int",bounds:[-100,!0,0,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.knee",{default:40,ui:{path:"Player > Compressor >> Advanced",title:"Knee",sort:5,description:`**Range:** 0 ~ 40

A decibel value representing the range above the threshold where the curve smoothly transitions to the compressed portion.`,component:"setting-text-box",process:"to_int",bounds:[0,!0,40,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.ratio",{default:12,ui:{path:"Player > Compressor >> Advanced",title:"Ratio",sort:10,description:`**Range:** 0 ~ 20

The amount of change, in dB, needed in the input for a 1 dB change in the output.`,component:"setting-text-box",process:"to_int",bounds:[0,!0,20,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.attack",{default:0,ui:{path:"Player > Compressor >> Advanced",title:"Attack",sort:15,description:`**Range:** 0 ~ 1

The amount of time, in seconds, required to reduce the gain by 10 dB.`,component:"setting-text-box",process:"to_float",bounds:[0,!0,1,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.release",{default:.25,ui:{path:"Player > Compressor >> Advanced",title:"Release",sort:20,description:`**Range:** 0 ~ 1
The amount of time, in seconds, required to increase the gain by 10 dB.`,component:"setting-text-box",process:"to_float",bounds:[0,!0,1,!0]},changed:()=>this.updateCompressors()})),this.settings.add("player.allow-catchup",{default:!0,ui:{path:'Player > General @{"sort": -1000} >> General',title:"Allow the player to speed up to reduce delay.",description:"Twitch, by default, will apply a minor speed up to live video when you have a large delay to the broadcaster in order to catch back up with the live broadcast. This may result in audio distortion. Disable this to prevent the automatic speed changes.",component:"setting-check-box"},changed:()=>this.updatePlaybackRates()}),this.settings.add("player.mute-click",{default:!1,ui:{path:"Player > General >> Volume",title:"Mute or unmute the player by middle-clicking.",component:"setting-check-box"}}),this.settings.add("player.volume-scroll",{default:!1,ui:{path:"Player > General >> Volume",title:"Adjust volume by scrolling with the mouse wheel.",description:"*This setting will not work properly on streams with visible extensions when mouse interaction with extensions is allowed.*",component:"setting-select-box",data:w}}),this.settings.add("player.button.reset",{default:!0,ui:{path:"Player > General >> General",title:"Add a `Reset Player` button to the player controls.",description:"Double-clicking the Reset Player button attempts to reset the Twitch player's internal state, fixing playback issues without a full page refresh.",component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.addResetButton(r)}}),document.pictureInPictureEnabled&&this.settings.add("player.button.pip",{default:!0,ui:{path:"Player > General >> General",title:"Add a `Picture-in-Picture` button to the player controls.",description:"Clicking the PiP button attempts to toggle Picture-in-Picture mode for the player's video.",component:"setting-check-box"},changed:()=>{for(const r of this.Player.instances)this.addPiPButton(r)}}),this.settings.add("player.volume-scroll-steps",{default:.1,ui:{path:"Player > General >> Volume",title:"Volume scroll amount",description:"How much the volume level is changed per individual scroll input.",component:"setting-select-box",data:[{value:.1,title:"10%"},{value:.05,title:"5%"},{value:.02,title:"2%"},{value:.01,title:"1%"}]}}),this.settings.add("player.captions.font-size",{default:"",ui:{path:"Player > Closed Captioning >> Font",title:"Font Size",description:"How large should captions be. This can be a percentage, such as `10%`, or a pixel value, such as `50px`.",component:"setting-text-box"},changed:()=>this.updateCaptionsCSS()}),this.settings.add("player.captions.font-family",{default:"",ui:{path:"Player > Closed Captioning >> Font",title:"Font Family",description:"Override the font used for displaying Closed Captions.",component:"setting-combo-box",data:()=>(0,T.R7)()},changed:()=>this.updateCaptionsCSS()}),this.settings.add("player.ext-hide",{default:0,ui:{path:"Player > General >> Extensions",title:"Show Overlay Extensions",description:"**Note**: This feature does not prevent extensions from loading. Hidden extensions are merely invisible. Hiding extensions with this feature will not improve your security. To prevent extensions from loading entirely, we recommend using the [Disable Twitch Extensions browser extension](https://twitch-tools.rootonline.de/disable_twitch_extensions.php) by CommanderRoot.",component:"setting-select-box",data:[{value:2,title:"Never"},{value:1,title:"With Controls"},{value:0,title:"Always"}]},changed:r=>this.updateHideExtensions(r)}),this.settings.add("player.ext-interaction",{default:!0,ui:{path:"Player > General >> Extensions",title:"Allow mouse interaction with overlay extensions.",component:"setting-check-box"},changed:r=>this.css_tweaks.toggle("player-ext-mouse",!r)}),this.settings.add("player.no-autoplay",{default:!1,ui:{path:"Player > General >> Playback",title:"Do not automatically start playing videos or streams.",description:"Note: This feature does not apply when navigating directly from channel to channel.",component:"setting-check-box"}}),this.settings.add("player.vod.autoplay",{default:!0,ui:{path:"Player > General >> Playback",title:"Auto-play the next recommended video after a video finishes.",component:"setting-check-box"}}),this.settings.add("player.volume-always-shown",{default:!1,ui:{path:"Player > General >> Volume",title:"Keep the volume slider expanded at all times.",component:"setting-check-box"},changed:r=>this.css_tweaks.toggle("player-volume",r)}),this.settings.add("player.hide-mouse",{default:!0,ui:{path:"Player > General >> General",title:"Hide mouse when controls aren't visible.",component:"setting-check-box"},changed:r=>this.css_tweaks.toggle("player-hide-mouse",r)}),this.settings.add("player.single-click-pause",{default:!1,ui:{path:"Player > General >> Playback",title:"Pause/Unpause the player by clicking.",component:"setting-check-box"}})}async onEnable(){await this.settings.awaitProvider(),await this.settings.provider.awaitReady(),this.css_tweaks.toggleHide("player-cast",this.settings.get("player.cast-button.hide")),this.css_tweaks.toggleHide("player-gain-volume",this.settings.get("player.gain.no-volume")),this.css_tweaks.toggle("player-hide-native-clip",this.settings.get("player.clip-button.hide-native")),this.css_tweaks.toggle("player-volume",this.settings.get("player.volume-always-shown")),this.css_tweaks.toggle("player-ext-mouse",!this.settings.get("player.ext-interaction")),this.css_tweaks.toggle("player-hide-mouse",this.settings.get("player.hide-mouse")),this.css_tweaks.toggle("player-fade-paused",this.settings.get("player.fade-pause-buffer")),this.installVisibilityHook(),this.updateHideExtensions(),this.updateCaptionsCSS(),this.updateShortcut(),this.on(":reset",this.resetAllPlayers,this),this.Player.ready((r,l)=>{this.modifyPlayerClass(r);for(const m of l){const f=m.props?.playerEvents;f&&((0,O.off)(f,"Playing",m.setPlayerActive),(0,O.off)(f,"PlayerSeekCompleted",m.setPlayerActive)),m.ffzMaybeRemoveNativeListeners(),m.maybeAttachDomEventListeners(),m.ffzScheduleState(),f&&((0,O.on)(f,"Playing",m.setPlayerActive),(0,O.on)(f,"PlayerSeekCompleted",m.setPlayerActive)),this.updateGUI(m),this.compressPlayer(m),this.updatePlaybackRate(m)}}),this.Player.on("mount",r=>{this.updateGUI(r),this.compressPlayer(r),this.updatePlaybackRate(r)}),this.Player.on("update",r=>{this.updateGUI(r),this.compressPlayer(r),this.updatePlaybackRate(r)}),this.Player.on("unmount",r=>{r.ffzUninstall()}),this.on("i18n:update",()=>{for(const r of this.Player.instances)this.updateGUI(r)})}updateShortcut(){const r=this.Mousetrap=this.Mousetrap||this.resolve("site.web_munch")?.getModule?.("mousetrap")||window.Mousetrap;if(!r||!r.bind)return;this._shortcut_bound&&(r.unbind(this._shortcut_bound),this._shortcut_bound=null);const l=this.settings.get("player.compressor.shortcut");C&&l&&(0,U.isValidShortcut)(l)&&(r.bind(l,this.onShortcut),this._shortcut_bound=l)}onShortcut(r){for(const l of this.Player.instances)this.compressPlayer(l,r)}modifyPlayerClass(r){const l=this,m=r.prototype.maybeAttachDomEventListeners;r.prototype.ffzInstall=function(){if(this._ffz_installed)return;this._ffz_installed=!0,this._ffzUpdateState||(this._ffzUpdateState=this.ffzUpdateState.bind(this)),this._ffzErrorReset||(this._ffzErrorReset=l.addErrorResetButton.bind(l,this)),this._ffzReady||(this._ffzReady=this.ffzReady.bind(this));const f=this,c=this.setPlayerActive,S=this.setPlayerInactive;this.setPlayerActive=function(){return f.ffzScheduleState(),c.call(f)},this.setPlayerInactive=function(){return f.ffzScheduleState(),S.call(f)},this.ffzOnEnded=()=>{l.settings.get("player.vod.autoplay")||l.parent.awaitElement(".autoplay-vod__content-container button",this.props.containerRef||l.fine.getChildNode(this),1e3).then(P=>P.click())};const $=this.props.playerEvents;$&&((0,O.on)($,"Buffering",this._ffzUpdateState),(0,O.on)($,"Playing",this._ffzUpdateState),(0,O.on)($,"PlayerError",this._ffzUpdateState),(0,O.on)($,"PlayerError",this._ffzErrorReset),(0,O.on)($,"Ended",this._ffzUpdateState),(0,O.on)($,"Ended",this.ffzOnEnded),(0,O.on)($,"Ready",this._ffzReady),(0,O.on)($,"Idle",this._ffzUpdateState)),this.ffzStopAutoplay()},r.prototype.ffzUninstall=function(){this._ffz_state_raf&&cancelAnimationFrame(this._ffz_state_raf);const f=this.props.playerEvents;f&&this._ffzUpdateState&&((0,O.off)(f,"Playing",this._ffzUpdateState),(0,O.off)(f,"PlayerError",this._ffzUpdateState),(0,O.off)(f,"PlayerError",this._ffzErrorReset),(0,O.off)(f,"Ended",this._ffzUpdateState),(0,O.off)(f,"Ended",this.ffzOnEnded),(0,O.off)(f,"Ready",this._ffzReady),(0,O.off)(f,"Idle",this._ffzUpdateState)),this.ffzRemoveListeners(),this._ffz_state_raf=null,this._ffzUpdateState=null,this._ffzErrorReset=null,this._ffzReady=null,this.ffzOnEnded=null},r.prototype.ffzReady=function(){const f=this.props.containerRef;f&&requestAnimationFrame(()=>{const c=f.querySelectorAll(".ffz--player-reset figure");for(const S of c)S._ffz_unspin&&clearTimeout(S._ffz_unspin),S.classList.toggle("loading",!1)})},r.prototype.ffzStopAutoplay=function(){l.shouldStopAutoplay(this)&&l.stopPlayer(this.props.mediaPlayerInstance,this.props.playerEvents,this)},r.prototype.ffzScheduleState=function(){this._ffzUpdateState||(this._ffzUpdateState=this.ffzUpdateState.bind(this)),this._ffz_state_raf||(this._ffz_state_raf=requestAnimationFrame(this._ffzUpdateState))},r.prototype.ffzUpdateState=function(){this._ffz_state_raf=null;const f=this.props.containerRef;if(!f)return;const c=f.dataset;c.controls=this.state?.active||!1;let S=this.props.mediaPlayerInstance;if(!S)return;S.core&&(S=S.core);const $=S.state?.state,P=S.mediaSinkManager?.video;$==="Playing"&&P?._ffz_maybe_compress&&(P._ffz_maybe_compress=!1,l.compressPlayer(this)),P&&P._ffz_compressed!=null&&(c.compressed=P._ffz_compressed),c.ended=$==="Ended",c.paused=$==="Idle",c.buffering=$==="Buffering"},r.prototype.ffzAttachListeners=function(){const f=this.props.containerRef;!f||this._ffz_listeners||(this._ffz_listeners=!0,this._ffz_scroll_handler||(this._ffz_scroll_handler=this.ffzScrollHandler.bind(this)),this._ffz_click_handler||(this._ffz_click_handler=this.ffzClickHandler.bind(this)),this._ffz_dblclick_handler||(this._ffz_dblclick_handler=this.ffzDblClickHandler.bind(this)),this._ffz_menu_handler||(this._ffz_menu_handler=this.ffzMenuHandler.bind(this)),(0,O.on)(f,"wheel",this._ffz_scroll_handler),(0,O.on)(f,"dblclick",this._ffz_dblclick_handler),(0,O.on)(f,"mousedown",this._ffz_click_handler),(0,O.on)(f,"contextmenu",this._ffz_menu_handler))},r.prototype.ffzRemoveListeners=function(){const f=this.props.containerRef;!f||!this._ffz_listeners||(this._ffz_scroll_handler&&((0,O.off)(f,"wheel",this._ffz_scroll_handler),this._ffz_scroll_handler=null),this._ffz_click_handler&&((0,O.off)(f,"mousedown",this._ffz_click_handler),this._ffz_click_handler=null),this._ffz_menu_handler&&((0,O.off)(f,"contextmenu",this._ffz_menu_handler),this._ffz_menu_handler=null),this._ffz_dblclick_handler&&((0,O.off)(f,"dblclick",this._ffz_dblclick_handler),this._ffz_dblclick_handler=null),this._ffz_listeners=!1)},r.prototype.ffzDelayPause=function(){this._ffz_pause_timer&&clearTimeout(this._ffz_pause_timer),(this.props?.mediaPlayerInstance).isPaused()||(this._ffz_pause_timer=setTimeout(()=>{const c=this.props?.mediaPlayerInstance;c.isPaused()||c.pause()},500))},r.prototype.ffzDblClickHandler=function(f){f&&this._ffz_pause_timer&&clearTimeout(this._ffz_pause_timer)},r.prototype.ffzClickHandler=function(f){if(!f)return;const c=l.settings.get("player.volume-scroll"),S=l.settings.get("player.gain.scroll"),$=l.settings.get("player.single-click-pause"),P=A(c)||A(S);if($&&f.button===0){if(!f.target||!f.target.classList.contains("click-handler"))return;this.ffzDelayPause()}if(P&&f.button===2&&(this.ffz_rmb=!0,this.ffz_scrolled=!1),!l.settings.get("player.mute-click")||f.button!==1)return;const E=this.props?.mediaPlayerInstance;if(!E?.isMuted)return;const D=!E.isMuted();return E.setMuted(D),localStorage.setItem("video-muted",JSON.stringify({default:D})),f.preventDefault(),!1},r.prototype.ffzMenuHandler=function(f){this.ffz_rmb=!1,this.ffz_scrolled&&(f.preventDefault(),f.stopPropagation())},r.prototype.ffzScrollHandler=function(f){const c=l.settings.get("player.volume-scroll"),S=l.settings.get("player.gain.scroll"),$=l.settings.get("player.gain.no-volume"),P=S&&p(S,f,this.ffz_rmb),E=c&&p(c,f,this.ffz_rmb);if(!P&&!E)return;const D=f.wheelDelta||-(f.deltaY||f.detail||0),M=this.props?.mediaPlayerInstance,Z=M?.mediaSinkManager?.video||M?.core?.mediaSinkManager?.video,G=Z?._ffz_compressed&&Z?._ffz_gain!=null,Y=G&&P;if(!M?.getVolume)return;A(Y?S:c)&&(this.ffz_scrolled=!0);const Q=l.settings.get("player.volume-scroll-steps");if(Y){let X=Z._ffz_gain_value;X==null&&(X=l.settings.get("player.gain.default"));const se=l.settings.get("player.gain.min"),J=l.settings.get("player.gain.max");D>0?X+=Q:X-=Q,X<se&&(X=se),X>J&&(X=J),Z._ffz_gain_value=X,$&&X!==0&&(M.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1}))),l.updateGain(this)}else if(E&&!(Z._ffz_compressed&&$)){const X=Z?.volume??M.getVolume(),se=Math.max(0,Math.min(1,X+(D>0?Q:-Q)));M.setVolume(se),localStorage.volume=se,se!==0&&(M.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1})))}return f.preventDefault(),!1},r.prototype.ffzMaybeRemoveNativeListeners=function(){const f=this.props.containerRef;f&&this.listenersAttached&&((0,O.off)(f,"mouseleave",this.setPlayerInactive),(0,O.off)(f,"mouseenter",this.setPlayerActive),(0,O.off)(f,"mousemove",this.onMouseMove),this.listenersAttached=!1)},r.prototype.maybeAttachDomEventListeners=function(){try{this.ffzInstall(),this.ffzAttachListeners()}catch(f){l.log.error("Error attaching event listener.",f)}return m.call(this)}}shouldStopAutoplay(){return!1}installVisibilityHook(){if(!document.pictureInPictureEnabled){this.log.info("Skipping visibility hooks. Picture-in-Picture is not available.");return}const r=this;document.addEventListener("fullscreenchange",()=>{const l=document.fullscreenElement,m=document.pictureInPictureElement;l&&m&&(l===m||l.contains(m))&&document.exitPictureInPicture();for(const f of this.Player.instances)this.addPiPButton(f)});try{Object.defineProperty(document,"hidden",{configurable:!0,get(){return document.pictureInPictureElement!=null||r.settings.get("player.force-visible")?!1:document.visibilityState==="hidden"}})}catch(l){this.log.warn("Unable to install document visibility hook.",l)}}stopPlayer(r,l,m){if(r&&r.pause&&(r.getState?.()||r.core?.getState?.())==="Playing")r.pause();else if(l&&!l._ffz_stopping){l._ffz_stopping=!0;const f=z(()=>{m.props.mediaPlayerInstance?.pause&&(m.props.mediaPlayerInstance.pause(),(0,O.off)(l,"Playing",f),l._ffz_stopping=!1)},"immediatePause");this.log.info("Unable to immediately pause. Listening for playing event."),(0,O.on)(l,"Playing",f)}}updateCaptionsCSS(){const r=[],l=this.settings.get("player.captions.font-size");let m=this.settings.get("player.captions.font-family");if(m&&m.length){const[f,c]=(0,T.jo)(m);m=f,this._font_unloader&&this._font_unloader(),this._font_unloader=c,m.indexOf(" ")!==-1&&m.indexOf(",")===-1&&m.indexOf('"')===-1&&m.indexOf("'")===-1&&(m=`"${m}"`),F.style.fontFamily="",F.style.fontFamily=m,F.style.fontFamily&&r.push(`font-family: ${F.style.fontFamily} !important;`)}F.style.fontSize="",F.style.fontSize=l,F.style.fontSize&&r.push(`font-size: ${F.style.fontSize} !important;`),r.length?this.css_tweaks.set("captions-font",`.player-captions-container__caption-line {
	${r.join(`
	`)}
}`):this.css_tweaks.delete("captions-font")}updateHideExtensions(r){r===void 0&&(r=this.settings.get("player.ext-hide")),this.css_tweaks.toggleHide("player-ext-hover",r===1),this.css_tweaks.toggleHide("player-ext",r===2)}skipContentWarnings(r){if(!this.settings.get("player.disable-content-warnings"))return;const l=this.fine.getHostNode(r),m=l&&l.querySelector('button[data-a-target="content-classification-gate-overlay-start-watching-button"]');m&&m.click()}updateGUI(r){this.skipContentWarnings(r),this.addPiPButton(r),this.addResetButton(r),this.addClipButton(r),this.addCompressorButton(r,!1),this.addGainSlider(r,!1),this.addMetadata(r),this.emit(":update-gui",r)}areControlsDisabled(r){return r._ffz_control_state||this.findControlState(r),r._ffz_control_state?r._ffz_control_state.props.disableControls:!1}findControlState(r){r._ffz_control_state||(r._ffz_control_state=this.fine.searchTree(r,l=>l.props&&(0,U.has)(l.props,"disableControls"),200))}addGainSlider(r,l,m=0){const f=r.props.containerRef||this.fine.getChildNode(r),c=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,S=f&&f.querySelector(L);let $=c!=null&&c._ffz_compressed&&c._ffz_gain;if(this.areControlsDisabled(r)&&($=null),!S)return c&&!$?void 0:m<5?setTimeout(this.addGainSlider.bind(this,r,l,(m||0)+1),250):void 0;const P=this.settings.get("player.gain.min"),E=this.settings.get("player.gain.max");(P>=E||E<=P)&&($=null);let D,M,Z,G,Y,Q=S.querySelector(".ffz--player-gain");if(!$){Q&&Q.remove();return}if(Q){if(l)return;Z=Q.querySelector("input"),Y=Q.querySelector(".ffz--gain-value"),M=Q.querySelector(".ffz-il-tooltip"),D=Q.querySelector(".ffz-il-tooltip .ffz--p-tip"),G=Q.querySelector(".ffz-il-tooltip .ffz--p-value")}else{const de=z(()=>{let ce=Z.value/100;const fe=this.settings.get("player.gain.min"),he=this.settings.get("player.gain.max");if(ce<fe&&(ce=fe),ce>he&&(ce=he),ce==c._ffz_gain_value)return;const ye=r.props.mediaPlayerInstance,le=ye.core||ye;!this.areControlsDisabled(r)&&ce>0&&this.settings.get("player.gain.no-volume")&&le?.isMuted?.()&&(le.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1}))),c._ffz_gain_value=ce,$.gain.value=ce;const ue=he-fe,ve=(ce-fe)/ue;Y.style.width=`${ve*100}%`,G.textContent=`${Math.round(ce*100)}%`},"on_change");Q=(0,O.createElement)("div",{class:"ffz--player-gain volume-slider__slider-container tw-relative ffz-il-tooltip__container"},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-full-height"},(0,O.createElement)("label",{class:"tw-hide-accessible"},this.i18n.t("player.gain.label","Gain Control")),(0,O.createElement)("div",{class:"tw-flex tw-full-width tw-relative tw-z-above"},Z=(0,O.createElement)("input",{class:"ffz-range ffz-range--overlay",type:"range",min:"0",max:"100",step:"1","data-a-target":"player-gain-slider",value:"100"}),(0,O.createElement)("div",{class:"tw-absolute tw-border-radius-large tw-bottom-0 tw-flex tw-flex-column tw-full-width tw-justify-content-center ffz-range__fill ffz-range__fill--overlay tw-top-0 tw-z-below"},(0,O.createElement)("div",{class:"tw-border-radius-large ffz-range__fill-container"},Y=(0,O.createElement)("div",{class:"tw-border-radius-large ffz-range__fill-value ffz--gain-value","data-test-selector":"ffz-range__fill-value-selector"}))))),M=(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-center ffz-il-tooltip--up",role:"tooltip"},(0,O.createElement)("div",null,D=(0,O.createElement)("div",{class:"ffz--p-tip"}),G=(0,O.createElement)("div",{class:"tw-regular ffz--p-value"})))),Z.addEventListener("input",de),S.appendChild(Q)}let X=c._ffz_gain_value;X==null&&(X=this.settings.get("player.gain.default")),Z.min=P*100,Z.max=E*100,Z.value=X*100;const se=E-P,J=(X-P)/se;Y.style.width=`${J*100}%`,D.textContent=this.i18n.t("player.gain.label","Gain Control"),G.textContent=`${Math.round(X*100)}%`}addCompressorButton(r,l,m=0){const f=r.props.containerRef||this.fine.getChildNode(r),c=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,S=f&&f.querySelector(L),$=C&&c!=null&&this.settings.get("player.compressor.enable");if(!S)return $&&m<5?setTimeout(this.addCompressorButton.bind(this,r,l,(m||0)+1),250):void 0;let P,E,D,M,Z=S.querySelector(".ffz--player-comp");if(!$||this.areControlsDisabled(r)){Z&&Z.remove();return}if(!Z)Z=(0,O.createElement)("div",{class:"ffz--player-comp tw-inline-flex tw-relative ffz-il-tooltip__container"},M=(0,O.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-comp-button",onClick:this.compressPlayer.bind(this,r)},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,O.createElement)("div",{class:"tw-button-icon__icon"},P=(0,O.createElement)("figure",{class:"ffz-player-icon"})))),(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-left ffz-il-tooltip--up",role:"tooltip"},(0,O.createElement)("div",null,E=(0,O.createElement)("div",{class:"ffz--p-tip"}),D=(0,O.createElement)("div",{class:"ffz--p-extra tw-pd-t-05 ffz--tooltip-explain"})))),S.appendChild(Z);else{if(l)return;P=Z.querySelector("figure"),M=Z.querySelector("button"),E=Z.querySelector(".ffz-il-tooltip .ffz--p-tip"),D=Z.querySelector(".ffz-il-tooltip .ffz--p-extra")}const G=c._ffz_compressed,Y=this.canCompress(r);let Q=Y?G?this.i18n.t("player.comp_button.off","Disable Audio Compressor"):this.i18n.t("player.comp_button.on","Audio Compressor"):this.i18n.t("player.comp_button.disabled","Audio Compressor cannot be enabled when viewing Clips.");D.textContent=this.i18n.t("player.comp_button.help","See the FFZ Control Center for details. If audio breaks, please reset the player."),Y&&this._shortcut_bound&&(Q=`${Q} (${this._shortcut_bound})`),P.classList.toggle("ffz-i-comp-on",G),P.classList.toggle("ffz-i-comp-off",!G),M.disabled=!Y,M.setAttribute("aria-label",Q),E.textContent=Q}replaceVideoElement(r,l){const m=(0,O.createElement)("video"),f=l?._ffz_pregain_volume??l?.volume??r.getVolume(),c=r.isMuted();return m._ffz_gain_value=l._ffz_gain_value,m._ffz_state=l._ffz_state,m._ffz_toggled=l._ffz_toggled,m._ffz_maybe_compress=l._ffz_compressed,m.volume=f,c&&(m.muted=!0),m.playsInline=!0,this.installPlaybackRate(m),l.replaceWith(m),r.attachHTMLVideoElement(m),m}hookPlayerLoad(r){!r||r._ffz_load||(r._ffz_load=r.load,r.load=(...l)=>{try{const m=r.getHTMLVideoElement();m?._ffz_compressor&&r.attachHTMLVideoElement&&(this.log.info("Recreating video element due to player load with compressor installed."),this.replaceVideoElement(r,m))}catch(m){t.log.error("Error while handling player load.",m)}return r._ffz_load(...l)})}compressPlayer(r,l){const m=r.props.mediaPlayerInstance,f=m.core||m,c=f?.mediaSinkManager?.video;if(!c||!C)return;this.hookPlayerLoad(m),r._ffz_setSrc||(r._ffz_setSrc=r.setSrc,r.setSrc=async function(...Y){console.log("setSrc",Y);const Q=r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;return Q&&Q._ffz_compressor&&await this.resetPlayer(r),r._ffz_setSrc(...Y)}),f._ffz_setVolume||(f._ffz_setVolume=f.setVolume,f._ffz_fakeVolume=()=>{}),c._ffz_maybe_compress=!1;const S=c._ffz_compressed||!1;let $=c._ffz_toggled?c._ffz_state:this.settings.get("player.compressor.default");if(l!=null&&(l.preventDefault(),c._ffz_toggled=!0,$=!c._ffz_compressed,c._ffz_state=$),c._ffz_compressor){if(!c._ffz_comp_reset&&!this.canCompress(r)){c._ffz_comp_reset=!0,this.resetPlayer(r);return}}else{if(!$)return;this.createCompressor(r,c)}let P=c._ffz_gain;const E=u&&this.settings.get("player.gain.enable"),D=P!=null;if(($==S||l==null&&c._ffz_toggled)&&D==E)return;const M=c._ffz_context,Z=c._ffz_compressor,G=c._ffz_source;if(!(!M||!Z||!G)){if(E&&!P){let Y=c._ffz_gain_value;Y==null&&(Y=this.settings.get("player.gain.default"));try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;P=c._ffz_gain=new GainNode(M,{gain:Y})}catch{this.log.info("Unable to use new GainNode. Falling back to old method."),P=c._ffz_gain=M.createGain(),P.gain.value=Y}Z.connect(P),S&&(Z.disconnect(M.destination),P.connect(M.destination))}else!E&&P&&(Z.disconnect(P),S&&(P.disconnect(M.destination),Z.connect(M.destination)),P=c._ffz_gain=null);$!=S&&($?(G.disconnect(M.destination),G.connect(Z),P?(P.connect(M.destination),this.settings.get("player.gain.no-volume")&&(c._ffz_pregain_volume=f.getVolume(),f._ffz_setVolume(1),f.setVolume=f._ffz_fakeVolume)):Z.connect(M.destination)):(G.disconnect(Z),P?(P.disconnect(M.destination),c._ffz_pregain_volume!=null&&(f._ffz_setVolume(c._ffz_pregain_volume),f.setVolume=f._ffz_setVolume,c._ffz_pregain_volume=null)):Z.disconnect(M.destination),G.connect(M.destination))),r.props.containerRef&&(r.props.containerRef.dataset.compressed=$),c._ffz_compressed=$,this.addCompressorButton(r),this.addGainSlider(r)}}updateGainVolume(r){const l=r.props.mediaPlayerInstance,m=l.core||l,f=m?.mediaSinkManager?.video;if(!f||!f._ffz_compressed)return;const c=this.settings.get("player.gain.no-volume");c&&f._ffz_pregain_volume==null?(f._ffz_pregain_volume=m.getVolume(),m._ffz_setVolume(1),m.setVolume=m._ffz_fakeVolume):!c&&f._ffz_pregain_volume!=null&&(m._ffz_setVolume(f._ffz_pregain_volume),m.setVolume=m._ffz_setVolume,f._ffz_pregain_volume=null)}canCompress(r){if(!C)return!1;const l=r.props?.mediaPlayerInstance;if(l==null)return!1;const m=l.mediaSinkManager?.video||l.core?.mediaSinkManager?.video;return!(!m||!m.src&&!m.srcObject||m.src&&new URL(m.src).protocol!=="blob:")}createCompressor(r,l,m){if(!this.canCompress(r))return;let f=l._ffz_compressor;if(!f){if(m=m||new AudioContext,m.state==="suspended"){let S;const $=z(()=>{if(clearTimeout(S),m.removeEventListener("statechange",$),m.state==="suspended"){this.log.debug("Aborting due to browser auto-play policy.");return}this.createCompressor(r,l,m)},"evt");this.log.debug("Attempting to resume suspended AudioContext."),S=setTimeout($,100);try{m.addEventListener("statechange",$),m.resume()}catch{}return}l._ffz_context=m;let c;try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;c=l._ffz_source=new MediaElementAudioSourceNode(m,{mediaElement:l})}catch{this.log.info("Unable to use new MediaElementAudioSourceNode. Falling back to old method."),c=l._ffz_source=m.createMediaElementSource(l)}c.connect(m.destination);try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;f=l._ffz_compressor=new DynamicsCompressorNode(m)}catch{this.log.info("Unable to use new DynamicsCompressorNode. Falling back to old method."),f=l._ffz_compressor=m.createDynamicsCompressor()}if(this.settings.get("player.gain.enable")){let S,$=l._ffz_gain_value;$==null&&($=this.settings.get("player.gain.default"));try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;S=l._ffz_gain=new GainNode(m,{gain:$})}catch{this.log.info("Unable to use new GainNode. Falling back to old method."),S=l._ffz_gain=m.createGain(),S.gain.value=$}f.connect(S)}l._ffz_compressed=!1}this.updateCompressor(null,f)}updateGains(){for(const r of this.Player.instances)this.updateGain(r)}updateGain(r,l,m,f=!0){if(m||(m=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video),l==null&&(l=m?._ffz_gain),!m||!l)return;let c=m._ffz_gain_value;c==null&&(c=this.settings.get("player.gain.default")),l.gain.value=c,f&&this.addGainSlider(r)}updateCompressors(){for(const r of this.Player.instances)this.updateCompressor(r)}updateCompressor(r,l){l==null&&(l=(r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video)?._ffz_compressor),l&&(l.threshold.value=this.settings.get("player.compressor.threshold"),l.knee.value=this.settings.get("player.compressor.knee"),l.ratio.value=this.settings.get("player.compressor.ratio"),l.attack.value=this.settings.get("player.compressor.attack"),l.release.value=this.settings.get("player.compressor.release"))}updatePlaybackRates(){for(const r of this.Player.instances)this.updatePlaybackRate(r)}updatePlaybackRate(r){const l=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;l.setFFZPlaybackRate||this.installPlaybackRate(l),l.setFFZPlaybackRate(l.playbackRate)}installPlaybackRate(r){if(r.setFFZPlaybackRate)return;let l=r.playbackRate;const m=this,f=z(()=>{m.settings.get("player.allow-catchup")||Object.defineProperty(r,"playbackRate",{configurable:!0,get(){return l},set(c){(c===1||c<1||c>=1.1)&&r.setFFZPlaybackRate(c)}})},"installProperty");r.setFFZPlaybackRate=c=>{delete r.playbackRate,l=c,r.playbackRate=c,f()}}addPiPButton(r,l=0){const m=r.props.containerRef||this.fine.getChildNode(r),f=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,c=f&&document.fullscreenElement&&document.fullscreenElement.contains(f),S=m&&m.querySelector(d),$=document.pictureInPictureEnabled&&this.settings.get("player.button.pip");if(!S)return $&&l<5?setTimeout(this.addPiPButton.bind(this,r,(l||0)+1),250):void 0;let P,E,D,M=S.querySelector(".ffz--player-pip");if(!$){M&&M.remove();return}if(M)P=M.querySelector("figure"),D=M.querySelector("button"),E=M.querySelector(".ffz-il-tooltip");else{M=(0,O.createElement)("div",{class:"ffz--player-pip tw-inline-flex tw-relative ffz-il-tooltip__container"},D=(0,O.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-pip-button",onClick:this.pipPlayer.bind(this,r)},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,O.createElement)("div",{class:"tw-button-icon__icon"},P=(0,O.createElement)("figure",{class:"ffz-player-icon"})))),E=(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const Q=S.querySelector('button[data-a-target="player-theatre-mode-button"]')||S.querySelector('button[aria-label*="Theat"]')||S.querySelector('button[data-a-target="player-fullscreen-button"]');Q?S.insertBefore(M,Q.parentElement):S.appendChild(M)}const Z=!!document.pictureInPictureElement,G=!1,Y=c?this.i18n.t("player.pip_button.fs","Cannot use Picture-in-Picture when Fullscreen"):G?this.i18n.t("player.pip_button.swap","Switch Picture-in-Picture"):Z?this.i18n.t("player.pip_button.off","Exit Picture-in-Picture"):this.i18n.t("player.pip_button","Picture-in-Picture");P.classList.toggle("ffz-i-t-pip-inactive",!Z||G),P.classList.toggle("ffz-i-t-pip-active",Z&&!G),D.setAttribute("aria-label",Y),E.textContent=Y}pipPlayer(r,l){const m=r.props.mediaPlayerInstance?.mediaSinkManager?.video||r.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;!m||!document.pictureInPictureEnabled||(l&&l.preventDefault(),!(document.fullscreenElement&&document.fullscreenElement.contains(m))&&(m._ffz_pip_enter||(m.addEventListener("enterpictureinpicture",m._ffz_pip_enter=()=>{this.addPiPButton(r)}),m.addEventListener("leavepictureinpicture",m._ffz_pip_exit=()=>{this.addPiPButton(r)})),document.pictureInPictureElement?document.exitPictureInPicture():m.requestPictureInPicture()))}addClipButton(r,l=0){const m=r.props.containerRef||this.fine.getChildNode(r),f=m&&m.querySelector(d),c=this.settings.get("player.clip-button.custom");if(!f)return c&&l<5?setTimeout(this.addClipButton.bind(this,r,(l||0)+1),250):void 0;let S,$,P=f.querySelector(".ffz--player-clip");if(!c){P&&P.remove();return}if((!f.ffz_native_clip||!f.contains(f.ffz_native_clip))&&(f.ffz_native_clip=_(f)),P)$=P.querySelector("button"),S=P.querySelector(".ffz-il-tooltip");else{const M=z(G=>{const Y=_(f);Y&&Y.click()},"on_click");P=(0,O.createElement)("div",{class:"ffz--player-clip tw-inline-flex tw-relative ffz-il-tooltip__container"},$=(0,O.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-clip-button",onClick:M},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,O.createElement)("div",{class:"tw-button-icon__icon"},(0,O.createElement)("figure",{class:"ffz-player-icon ffz-i-clip"})))),S=(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const Z=f.querySelector(".ffz--player-reset button")||f.querySelector(".ffz--player-pip button")||f.querySelector('button[data-a-target="player-theatre-mode-button"]')||f.querySelector('button[aria-label*="Theat"]')||f.querySelector('button[data-a-target="player-fullscreen-button"]');Z?f.insertBefore(P,Z.parentElement):f.appendChild(P)}const E=f.ffz_native_clip,D=E?E.disabled||E.ariaDisabled==="true":!1;$.disabled=D,$.setAttribute("aria-label",S.textContent=D?E.ariaLabel||this.i18n.t("player.clip-button.disabled","Clips are Disabled"):this.i18n.t("player.clip-button","Clip (Alt+X)"))}clickClip(r,l){console.log("clicked clip",r,l)}addResetButton(r,l=0){const m=r.props.containerRef||this.fine.getChildNode(r),f=m&&m.querySelector(d),c=this.settings.get("player.button.reset");if(!f)return c&&l<5?setTimeout(this.addResetButton.bind(this,r,(l||0)+1),250):void 0;let S,$,P=f.querySelector(".ffz--player-reset");if(!c){P&&P.remove();return}if(P)$=P.querySelector("button"),S=P.querySelector(".ffz-il-tooltip");else{P=(0,O.createElement)("div",{class:"ffz--player-reset tw-inline-flex tw-relative ffz-il-tooltip__container"},$=(0,O.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-reset-button",onClick:v,onDblClick:this.resetPlayer.bind(this,r)},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,O.createElement)("div",{class:"tw-button-icon__icon"},(0,O.createElement)("figure",{class:"ffz-player-icon ffz-i-t-reset"})))),S=(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const E=f.querySelector(".ffz--player-pip button")||f.querySelector('button[data-a-target="player-theatre-mode-button"]')||f.querySelector('button[aria-label*="Theat"]')||f.querySelector('button[data-a-target="player-fullscreen-button"]');E?f.insertBefore(P,E.parentElement):f.appendChild(P)}$.setAttribute("aria-label",S.textContent=this.i18n.t("player.reset_button","Reset Player (Double-Click)"))}addErrorResetButton(r,l=0){const m=r.props.containerRef||this.fine.getChildNode(r),f=m&&m.querySelector(".content-overlay-gate"),c=this.settings.get("player.button.reset");if(!f){if(!c)return;l<2&&this.parent.awaitElement(".autoplay-vod__content-container button",this.props.containerRef||t.fine.getChildNode(this),1e3).then(()=>{this.addErrorResetButton(r,(l||0)+1)}).catch(()=>{this.log.warn("Unable to find container element for Error Reset button.")});return}let S,$,P=f.querySelector(".ffz--player-reset");if(!c){P&&P.remove();return}P?($=P.querySelector("button"),S=P.querySelector(".ffz-il-tooltip")):(P=(0,O.createElement)("div",{class:"ffz--player-reset tw-absolute tw-bottom-0 tw-right-0 ffz-il-tooltip__container tw-mg-1"},$=(0,O.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-reset-button",onClick:v,onDblClick:this.resetPlayer.bind(this,r)},(0,O.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,O.createElement)("div",{class:"tw-button-icon__icon"},(0,O.createElement)("figure",{class:"ffz-player-icon ffz-i-t-reset"})))),S=(0,O.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"})),f.appendChild(P)),$.setAttribute("aria-label",S.textContent=this.i18n.t("player.reset_button","Double-Click to Reset Player"))}resetAllPlayers(){for(const r of this.Player.instances)this.resetPlayer(r)}async resetPlayer(r,l){const m=r?r.mediaSinkManager||r.core?.mediaSinkManager?r:r?.props?.mediaPlayerInstance:null;if(l){l.preventDefault();const P=l.currentTarget,E=P&&P.querySelector("figure");if(E){if(E.classList.contains("loading"))return;E.classList.toggle("ffz-i-t-reset",!0),E.classList.toggle("ffz-i-t-reset-clicked",!1),E.classList.toggle("loading",!0),E._ffz_unspin=setTimeout(()=>{E._ffz_unspin=null,E.classList.toggle("loading",!1)},1e4)}}const f=m.getDuration?.()??1/0;let c=-1;const S=m.core||m;S._ffz_setVolume&&(S.setVolume=S._ffz_setVolume),isFinite(f)&&!isNaN(f)&&f>0&&(c=m.getPosition());const $=m.mediaSinkManager?.video||m.core?.mediaSinkManager?.video;if($?._ffz_compressor&&m.attachHTMLVideoElement){const P=this.replaceVideoElement(m,$);P._ffz_maybe_compress=!0}this.PlayerSource.check();for(const P of this.PlayerSource.instances)(!m||m===P.props?.mediaPlayerInstance)&&await P.setSrc({isNewMediaPlayerInstance:!1});c>0&&setTimeout(()=>m.seekTo(c),250)}addMetadata(r){this.metadata&&(r._ffz_md_update||(r._ffz_md_update=(0,U.debounce)(()=>requestAnimationFrame(()=>this._updateMetadata(r)),1e3,2)),r._ffz_md_update())}wantsMetadata(){return!1}_updateMetadata(r){r._ffz_cont&&!document.contains(r._ffz_cont)&&(r._ffz_cont=null);const l=this.wantsMetadata(r);if(!r._ffz_cont){if(!l)return;const m=r.props.containerRef||this.fine.getChildNode(r),f=m&&m.querySelector(d);if(!f)return;r._ffz_cont=(0,O.createElement)("div",{class:"ffz--player-meta-tray"}),f.insertBefore(r._ffz_cont,f.firstElementChild)}if(!l){r._ffz_cont.remove(),r._ffz_cont=null;return}this.updateMetadata(r)}updateMetadata(r,l){const m=r._ffz_cont;if(!m||!document.contains(m))return;l?Array.isArray(l)||(l=[l]):l=this.metadata.keys;const f=this.getData(),c=f?.props?.data?.user,S=r._ffz_meta_timers=r._ffz_meta_timers||{},$=z(E=>this.updateMetadata(r,E),"refresh_fn"),P={channel:{id:c?.id,login:f?.props?.channelLogin,display_name:c?.displayName,live:c?.stream?.id!=null,live_since:c?.stream?.createdAt},inst:r,source:f,getViewerCount:()=>0,getUserSelfImmediate:()=>null,getUserSelf:()=>null,getBroadcastID:()=>c?.id?this.getBroadcastID(r,c.id):null};for(const E of l)this.metadata.renderPlayer(E,P,m,S,$)}getUptime(r){let f=this.getData()?.props?.data?.user?.stream?.createdAt;return f?(f instanceof Date||(f=new Date(f)),(Date.now()-f.getTime())/1e3):null}getBroadcastID(r,l){if(!this.twitch_data)return Promise.resolve(null);const m=r._ffz_bcast_cache=r._ffz_bcast_cache||{};return l===m.channel_id&&Date.now()-m.saved<6e4?Promise.resolve(m.broadcast_id):new Promise(async(f,c)=>{if(m.updating){m.updating.push([f,c]);return}m.channel_id=l,m.updating=[[f,c]];let S,$;try{S=await this.twitch_data.getBroadcastID(l)}catch(E){S=null,$=E}const P=m.updating;if(m.updating=null,m.channel_id!==l){$=new Error("Outdated"),m.channel_id=null,m.broadcast_id=null,m.saved=0;for(const E of P)E[1]($);return}m.broadcast_id=S,m.saved=Date.now();for(const E of P)$?E[1]($):E[0](S)})}get playerUI(){return this.fine.searchTree(this.Player.first,l=>l.props&&l.props.uiContext,150)?.props?.uiContext}get current(){for(const r of this.Player.instances)if(r?.props?.mediaPlayerInstance)return r.props.mediaPlayerInstance;return null}};z(a,"PlayerBase");let x=a},6170:(V,W,g)=>{"use strict";g.d(W,{Z:()=>C,e:()=>u});var k=g(20857);let O,U,T,F;function L(){return O?Promise.resolve(O):new Promise((b,w)=>{if(T)return T.push([b,w]);T=[[b,w]],Promise.all([g.e(2009).then(g.t.bind(g,19404,23)),g.e(2009).then(g.t.bind(g,43496,23))]).then(_=>{O=_[0]?.default,U=_[1]?.default;const A=T;T=null;for(const p of A)p[0](O)}).catch(_=>{const A=T;T=null;for(const p of A)p[1](_)})})}z(L,"loadMD");function d(b){const w=b.renderer.rules.link_open||this.defaultRender;b.renderer.rules.link_open=function(_,A,p,v,x){const a=_[A];if(a&&a.type==="link_open"&&Array.isArray(a.attrs)){let o;for(const r of a.attrs)if(r[0]==="href"){o=r[1];break}if(o.startsWith("~")){let r;if(o==="~"){let l=A+1,m=[];for(;l<_.length;){const c=_[l],S=c?.type;if(S==="text")m.push(c);else if(S==="link_close")break;l++}m=m.map(c=>c.content).join(""),r=(0,k.Q)(m).map(c=>c.key).join(".")}else r=o.slice(1);if(r&&r.length){for(const l of a.attrs)if(l[0]==="class"){l[1]=l[1].replace(/ffz-tooltip/g,"");break}a.attrs.push(["data-settings-link",r]),a.attrs.push(["onclick",'FrankerFaceZ.get().resolve("main_menu").mdNavigate(this);return false'])}}}return w(_,A,p,v,x)}}z(d,"SettingsLinks"),d.defaultRender=function(b,w,_,A,p){return p.renderToken(b,w,_)};async function C(){if(!F){const b=await L();if(!b)return null;const w=F=new b({html:!1,linkify:!0});w.use(d),w.use(U,{attrs:{class:"ffz-tooltip",target:"_blank",rel:"noopener","data-tooltip-type":"link"}})}return F}z(C,"awaitMD");function u(b){if(F)return F;b&&C().then(w=>b(w))}z(u,"getMD")},81011:(V,W,g)=>{"use strict";g.d(W,{Z:()=>T});var k=g(17159),O=g(46949),U=g(37087);const F=class F extends k.EventEmitter{constructor(d,C){super(),this._enabled=!1,this.ephemeral=!1,this.id=-1,this.uuid=null,this.name=null,this.pause_updates=!1,this.show_toggle=!1,this._hotkey_enabled=!1,this.onShortcut=this.onShortcut.bind(this),this._hotkey_enabled=!1,this.manager=d,this.provider=d.provider,this.data=C,this.prefix=`p:${this.id}:`,this.enabled_key=`${this.prefix}:enabled`,this.ephemeral&&(this._enabled=!0,this._storage=new Map)}get data(){return{id:this.id,uuid:this.uuid,name:this.name,i18n_key:this.i18n_key,hotkey:this.hotkey,pause_updates:this.pause_updates,ephemeral:this.ephemeral,description:this.description,desc_i18n_key:this.desc_i18n_key,url:this.url,show_toggle:this.show_toggle,context:this.context}}set data(d){if(typeof d!="object")throw new TypeError("data must be an object");this.clearMatcher(),d.ephemeral&&(this.ephemeral=!0);for(const[C,u]of Object.entries(d))this[C]=u}clearMatcher(){this.matcher=null}matches(d){return this.matcher||(this.matcher=(0,U.createTester)(this.context,this.manager.filters,!1,!1,()=>this.manager.updateSoon())),this.matcher(d)}save(){this.ephemeral||this.manager.saveProfile(this.id)}getBackup(){const d={version:2,type:"profile",profile:this.data,toggled:this.toggled,values:{}};delete d.profile.ephemeral;for(const[C,u]of this.entries())d.values[C]=u;return d}async checkUpdate(){if(!this.url||this.pause_updates)return!1;const d=await(0,O.fetchJSON)(this.url);if(!d||d.type!=="profile"||!d.profile||!d.values)return!1;delete d.profile.ephemeral,delete d.profile.id,delete d.profile.uuid,delete d.profile.name,delete d.profile.i18n_key,delete d.profile.hotkey,delete d.profile.description,delete d.profile.desc_i18n_key,delete d.profile.url,delete d.profile.pause_updates,this.data=d.profile;const C=new Set(this.keys());for(const[u,b]of Object.entries(d.values))C.delete(u),this.set(u,b);for(const u of C)this.delete(u);return!0}get hotkey(){return this._hotkey}set hotkey(d){d!==this._hotkey&&(this._hotkey=d,this._hotkey_enabled&&this._updateHotkey())}get hotkey_enabled(){return this._hotkey_enabled}set hotkey_enabled(d){this._hotkey_enabled=!!d,this._updateHotkey()}_updateHotkey(){const d=this.Mousetrap=this.Mousetrap||window.Mousetrap;if(!d)return;const C=this._hotkey;this._bound_key&&(this._bound_key!==C||!this._hotkey_enabled)&&(d.unbind(this._bound_key),this._bound_key=null),this._hotkey_enabled&&C&&(0,O.isValidShortcut)(C)&&(d.bind(C,this.onShortcut),this._bound_key=C)}onShortcut(d){this.toggled=!this.toggled,d&&(d.stopPropagation(),d.preventDefault())}get toggled(){return this.ephemeral?this._enabled:this.provider.get(this.enabled_key,!0)}set toggled(d){d!==this.toggled&&(this.ephemeral?this._enabled=d:this.provider.set(this.enabled_key,d),this.emit("toggled",this,d))}setContext(d){if(this.id===0)throw new Error("cannot set context of default profile");this.context=d,this.clearMatcher(),this.save()}get(d,C){return this.ephemeral?this._storage&&this._storage.has(d)?this._storage.get(d):C??null:this.provider.get(this.prefix+d,C)}set(d,C){this.ephemeral?this._storage&&this._storage.set(d,C):this.provider.set(this.prefix+d,C),this.emit("changed",d,C,!1)}delete(d){this.ephemeral?this._storage&&this._storage.delete(d):this.provider.delete(this.prefix+d),this.emit("changed",d,void 0,!0)}has(d){return this.ephemeral?this._storage?this._storage.has(d):!1:this.provider.has(this.prefix+d)}keys(){if(this.ephemeral)return this._storage?Array.from(this._storage.keys()):[];const d=[],C=this.prefix,u=C.length;for(const b of this.provider.keys())b.startsWith(C)&&b!==this.enabled_key&&d.push(b.slice(u));return d}clear(){if(this.ephemeral){if(this._storage){const u=this.keys();this._storage.clear();for(const b of u)this.emit("changed",b,void 0,!0)}return}const d=this.prefix,C=d.length;for(const u of this.provider.keys())u.startsWith(d)&&u!==this.enabled_key&&(this.provider.delete(u),this.emit("changed",u.slice(C),void 0,!0))}*entries(){if(this.ephemeral){if(this._storage)for(const d of this._storage.entries())yield d}else{const d=this.prefix,C=d.length;for(const u of this.provider.keys())u.startsWith(d)&&u!==this.enabled_key&&(yield[u.slice(C),this.provider.get(u)])}}get size(){if(this.ephemeral)return this._storage?this._storage.size:0;const d=this.prefix;let C=0;for(const u of this.provider.keys())u.startsWith(d)&&u!==this.enabled_key&&C++;return C}};z(F,"SettingsProfile");let T=F;T.Default={id:0,uuid:"ffz_profile_default",name:"Default Profile",i18n_key:"setting.profiles.default",description:"Settings that apply everywhere on Twitch."},T.Moderation={id:1,uuid:"ffz_profile_moderation",name:"Moderation",i18n_key:"setting.profiles.moderation",description:"Settings that apply when you are a moderator of the current channel.",context:[{type:"Moderator",data:!0}]}},5227:(V,W,g)=>{"use strict";g.r(W),g.d(W,{Addon:()=>O});var k=g(22527);const U=class U extends k.default{constructor(F,L){super(F,L,!0),this.i18n=null,this.settings=null,this.inject("i18n"),this.inject("settings")}populate(F,L){return this.log.warn("[DEV-CHECK] populate() has been renamed to loadFromContext(). The populate() name is deprecated."),this.loadFromContext(F,L)}static register(F,L,d){if(typeof F=="object"&&(L=F,F=L.id||void 0),!F)if(this.name)F=this.name.toSnakeCase();else throw new Error("Unable to register module without ID.");!L&&this.info&&(L=this.info),d&&(this.version=d);const C=window.FrankerFaceZ.get(),u=C?.addons;u&&(L?(L.id=F,u.addAddon(L)):u.hasAddon(F)||u.addAddon({id:F}),d&&u.setVersion(F,d));try{C.register(`addon.${F}`,this)}catch(b){if(b instanceof Error&&b.message&&b.message.includes("Name Collision for Module")){const w=C.resolve(`addon.${F}`);w&&(w.external=!0)}throw b}}};z(U,"Addon");let O=U},38626:(V,W,g)=>{"use strict";g.r(W),g.d(W,{deserializeBlob:()=>U,isValidBlob:()=>k,serializeBlob:()=>O});function k(T){return T instanceof Blob||T instanceof File||T instanceof ArrayBuffer||T instanceof Uint8Array}z(k,"isValidBlob");async function O(T){if(!T)return null;if(T instanceof Blob)return{type:"blob",mime:T.type,buffer:await T.arrayBuffer()};if(T instanceof File)return{type:"file",mime:T.type,name:T.name,modified:T.lastModified,buffer:await T.arrayBuffer()};if(T instanceof ArrayBuffer)return{type:"ab",buffer:T};if(T instanceof Uint8Array)return{type:"u8",buffer:T.buffer};throw new TypeError("Invalid type")}z(O,"serializeBlob");function U(T){if(!T||!T.type)return null;if(T.type==="blob")return new Blob([T.buffer],{type:T.mime});if(T.type==="file")return new File([T.buffer],T.name,{type:T.mime,lastModified:T.modified});if(T.type==="ab")return T.buffer;if(T.type==="u8")return new Uint8Array(T.buffer);throw new TypeError("Invalid type")}z(U,"deserializeBlob")},98247:(V,W,g)=>{"use strict";g.d(W,{Z:()=>U});var k=g(17159),O=g(22527);const L=class L extends O.default{constructor(u,b){super(u,b),this._route=null,this._wrappers=new Map,this._known_classes=new Map,this._observer=null,this._waiting=[],this._live_waiting=null}async onEnable(u=0){this.root_element||(this.root_element=await this.parent.awaitElement(this.selector||"body #root"));let b=this.root_element?._reactRootContainer;if(b?._internalRoot?.current&&(b=b?._internalRoot),b?.current){this.react_root=b,this.react=b?.current?.child;return}if(this.root_element&&!b){let w=L.findAccessor(this.root_element,"__reactContainer");if(w){this.react_root=null,this.react=this.root_element[w];return}}if(u>500)throw new Error("Unable to find React after 25 seconds");return this.root_element=null,new Promise(w=>setTimeout(w,50)).then(()=>this.onEnable(u+1))}onDisable(){this.react_root=this.root_element=this.react=this.accessor=null}static findAccessor(u,b){for(const w in u)if(b?w.startsWith(`${b}$`):w.startsWith("__reactInternalInstance$")||w.startsWith("__reactFiber$"))return w;return null}resolveNode(u){return!u&&this.react?this.react:u instanceof Node?this.getReactInstance(u):u?._reactInternals?u._reactInternals:u?._reactInternalFiber?u._reactInternalFiber:u||null}getReactInstance(u){return this.accessor||(this.accessor=L.findAccessor(u)),this.accessor?u[this.accessor]??u._reactRootContainer?._internalRoot?.current??u._reactRootContainer?.current??null:null}getOwner(u){return u=this.resolveNode(u),u?.return??null}getParentNode(u,b=100,w=!1){return this.searchParent(u,_=>_ instanceof Node,b,0,w)}getChildNode(u,b=100,w=!1){return this.searchTree(u,_=>_ instanceof Node,b,0,w)}getHostNode(u,b=100){return this.getChildNode(u,b)}getParent(u){return this.getOwner(u)}getFirstChild(u){return this.resolveNode(u)?.child??null}getChildren(u){const b=this.resolveNode(u);if(!b)return[];const w=[];let _=b.child;for(;_;)w.push(_),_=_.sibling;return w}searchParent(u,b,w=15,_=0,A=!0){if(_>w)return null;const p=this.resolveNode(u);if(!p)return null;if(typeof b=="string"){const x=this._wrappers.get(b);if(!x)throw new Error("invalid critera");if(!x.class)return null;b=z(a=>a&&a.constructor===x.class,"criteria")}const v=p.stateNode;if(v&&b(v,p))return v;if(p.return){const x=this.searchParent(p.return,b,w,_+1,A);if(x)return x}if(A&&v?.containerInfo){const x=v.containerInfo?.parentElement,a=x&&this.getReactInstance(x);if(a){const o=this.searchParent(a,b,w,_+1,A);if(o)return o}}return null}searchParentNode(u,b,w=15,_=0,A=!0){if(_>w)return null;const p=this.resolveNode(u);if(!p)return null;if(b(p))return p;if(p.return){const x=this.searchParentNode(p.return,b,w,_+1,A);if(x)return x}const v=p.stateNode;if(A&&v?.containerInfo){const x=v.containerInfo?.parentElement,a=x&&this.getReactInstance(x);if(a){const o=this.searchParentNode(a,b,w,_+1,A);if(o)return o}}return null}searchNode(u,b,w=15,_=0,A=!0){if(_>w)return null;const p=this.resolveNode(u);if(!p)return null;if(b(p))return p;if(p._ffz_no_scan||p.stateNode?._ffz_no_scan)return null;let v=p.child;for(;v;){const a=this.searchNode(v,b,w,_+1,A);if(a)return a;v=v.sibling}const x=p.stateNode;if(A&&x?.props?.root){const a=x.props.root._reactRootContainer;if(a){let o=a._internalRoot?.current||a.current;for(;o;){const r=this.searchNode(o,b,w,_+1,A);if(r)return r;o=o.sibling}}}return null}searchTree(u,b,w=15,_=0,A=!0,p){const v=this.resolveNode(u);if(p&&!(p instanceof Set)&&(p=new Set),!v||_>w)return p||null;if(typeof b=="string"){const o=this._wrappers.get(b);if(!o)throw new Error("invalid critera");if(!o.class)return p||null;b=z(r=>r&&r.constructor===o.class,"criteria")}const x=v.stateNode;if(x&&b(x,v))if(p)p.add(x);else return x;if(v._ffz_no_scan||v.stateNode?._ffz_no_scan)return p||null;let a=v.child;for(;a;){const o=this.searchTree(a,b,w,_+1,A,p);if(o&&!p)return o;a=a.sibling}if(A&&x?.props?.root){const o=x.props.root._reactRootContainer;if(o){let r=o._internalRoot?.current||o.current;for(;r;){const l=this.searchTree(r,b,w,_+1,A,p);if(l&&!p)return l;r=r.sibling}}}return p||null}findAllMatching(u,b,w=15,_=!0,A=!1,p=0,v=!0){const x=new Set;let a=z((o,r)=>!x.has(o)&&b(o,r),"crit");for(;;){const o=A?this.searchParent(u,a,w,p,v):this.searchTree(u,a,w,p,v);if(!o)break;if(_&&!x.size){const r=o.constructor;a=z((l,m)=>!x.has(l)&&l instanceof r&&b(l,m),"crit")}x.add(o)}return x}searchAll(u,b,w=15,_=0,A=null,p=!0){const v=this.resolveNode(u);if(A||(A={seen:new Set,classes:b.map(()=>null),out:b.map(()=>({cls:null,instances:new Set,depth:null})),max_depth:_}),!v||_>w)return A.out;_>A.max_depth&&(A.max_depth=_);const x=v.stateNode;if(x){const o=x.constructor,r=A.classes.indexOf(o);if(r!==-1)A.out[r].instances.add(x);else if(!A.seen.has(o)){let l=b.length;for(;l-- >0;)if(b[l](x,v)){A.classes[l]=A.out[l].cls=o,A.out[l].instances.add(x),A.out[l].depth=_;break}A.seen.add(o)}}if(v._ffz_no_scan||v.stateNode?._ffz_no_scan)return A.out;let a=v.child;for(;a;)this.searchAll(a,b,w,_+1,A,p),a=a.sibling;if(p&&x?.props?.root){const o=x.props.root._reactRootContainer;if(o){let r=o._internalRoot&&o._internalRoot.current||o.current;for(;r;)this.searchAll(r,b,w,_+1,A,p),r=r.sibling}}return A.out}route(u){this._route=u,this._updateLiveWaiting()}_updateLiveWaiting(){const u=this._live_waiting=[],b=this._waiting_crit=[],w=this._route;if(this._waiting)for(const _ of this._waiting)_.routes===!1||!_.criteria||(!w||!_.routes?.length||_.routes.includes(w))&&(u.push(_),b.push(_.criteria));this._live_waiting.length?this._waiting_timer||this._startWaiting():this._stopWaiting()}define(u,b,w=null){if(this._wrappers.has(u))return this._wrappers.get(u);if(!b)throw new Error("cannot find definition and no criteria provided");const _=new F(u,b,w,this);this._wrappers.set(u,_);const A=this.react?this.searchAll(this.react,[b],1e3)[0]:null;return A?.cls?(_._set(A.cls,A.instances),this._known_classes.set(A.cls,_)):w!==!1&&(this._waiting.push(_),this._updateLiveWaiting()),_}wrap(u,b){let w;if(this._wrappers.has(u)?w=this._wrappers.get(u):(w=new F(u,null,null,this),this._wrappers.set(u,w)),b){if(w.class||w.criteria)throw new Error("tried setting a class on an already initialized FineWrapper");w._set(b,new Set),this._known_classes.set(b,w)}return w}_checkWaiters(u=null){if(this._live_waiting){Array.isArray(u)||(u=[u]);for(let b of u){if(!this._live_waiting.length||!this._waiting_crit)break;let w=null;if(!b&&this.react?w=this.react:b instanceof Node?w=this.getReactInstance(b):b?._reactInternals?w=b._reactInternals:b?._reactInternalFiber&&(w=b._reactInternalFiber),!w||w._ffz_no_scan||w.stateNode?._ffz_no_scan)continue;const _=this.searchAll(w,this._waiting_crit,1e3);let A=_.length;for(;A-- >0;)if(_[A].cls){const p=_[A],v=this._live_waiting.splice(A,1)[0];this._waiting_crit.splice(A,1);const x=this._waiting.indexOf(v);x!==-1&&this._waiting.splice(x,1),this.log.debug(`Found class for "${v.name}" at depth ${p.depth}`),v._set(p.cls,p.instances)}}this._live_waiting.length||this._stopWaiting()}}_startWaiting(){this.log.info("Installing MutationObserver."),this._waiting_timer=setInterval(()=>this._checkWaiters(),500),this._observer||(this._observer=new MutationObserver(u=>this._checkWaiters(u.map(b=>b.target)))),this._observer.observe(document.body,{childList:!0,subtree:!0})}_stopWaiting(){this.log.info("Stopping MutationObserver."),this._observer&&this._observer.disconnect(),this._waiting_timer&&clearInterval(this._waiting_timer),this._live_waiting=null,this._waiting_crit=null,this._waiting_timer=null}};z(L,"Fine");let U=L;const T={"will-mount":"UNSAFE_componentWillMount",mount:"componentDidMount",render:"render","receive-props":"UNSAFE_componentWillReceiveProps","should-update":"shouldComponentUpdate","will-update":"UNSAFE_componentWillUpdate",update:"componentDidUpdate",unmount:"componentWillUnmount"},d=class d extends k.EventEmitter{constructor(u,b,w,_){super(),this.name=u,this.criteria=b,this.fine=_,this.instances=new Set,this.routes=w??[],this._wrapped=new Map,this._class=null}get class(){return this._class}get first(){return this.toArray()[0]}__cleanListeners(){const u=super.__cleanListeners();for(const b of u){const w=T[b];if(w)try{this._unwrap(w)}catch{}}return u}toArray(){return Array.from(this.instances)}check(u=null,b=1e3){if(this._class||!this.criteria)return;const w=this.fine.findAllMatching(u,this.criteria,b);if(w.size){const _=Array.from(w);this._set(_[0].constructor,_)}}ready(u){this._class?u(this._class,this.instances):this.once("set",u)}each(u){for(const b of this.instances)u(b)}updateInstances(u=null,b=1e3){if(!this._class)return;const w=this.fine.findAllMatching(u,_=>_.constructor===this._class,b);for(const _ of w)_._ffz_mounted=!0,this.instances.add(_)}_set(u,b){if(this._class)throw new Error("already have a class");this._class=u,u._ffz_wrapper=this;const w=this,_=this.instances,A=u.prototype,p=A.UNSAFE_componentWillMount,v=A.componentWillUnmount,x=A.UNSAFE_componentWillMount=p?function(...o){return this._ffz_mounted=!0,_.add(this),w.emit("will-mount",this,...o),p.apply(this,o)}:function(...o){this._ffz_mounted=!0,_.add(this),w.emit("will-mount",this,...o)},a=A.componentWillUnmount=v?function(...o){return w.emit("unmount",this,...o),_.delete(this),this._ffz_mounted=!1,v.apply(this,o)}:function(...o){w.emit("unmount",this,...o),_.delete(this),this._ffz_mounted=!1};this._wrapped.set("UNSAFE_componentWillMount",[x,p]),this._wrapped.set("componentWillUnmount",[a,v]);for(const o of this.events())this._maybeWrap(o);if(b)for(const o of b)o._ffz_mounted=!0,_.add(o);this.emit("set",u,_)}_add(u){for(const b of u)this.instances.add(b)}_maybeWrap(u){const b=T[u];!this._class||!b||this._wrapped.has(b)||this._wrap(u,b)}_wrap(u,b){if(this._wrapped.has(b)||!this._class)return;const w=this,_=this._class.prototype,A=_[b],p=_[b]=A?function(...v){return this._ffz_mounted||(this._ffz_mounted=!0,w.instances.add(this),w.emit("late-mount",this)),w.emit(u,this,...v),A.apply(this,v)}:b==="shouldComponentUpdate"?function(...v){return this._ffz_mounted||(this._ffz_mounted=!0,w.instances.add(this),w.emit("late-mount",this)),w.emit(u,this,...v),!0}:function(...v){this._ffz_mounted||(this._ffz_mounted=!0,w.instances.add(this),w.emit("late-mount",this)),w.emit(u,this,...v)};this._wrapped.set(b,[p,A])}_unwrap(u){const b=this._wrapped.get(u);if(!b||!this._class)return;const w=this._class.prototype,[_,A]=b;if(w[u]!==_)throw new Error("unable to unwrap -- prototype modified");w[u]=A,this._wrapped.delete(u)}forceUpdate(){for(const u of this.instances)try{u.forceUpdate(),this.fine.emit("site:dom-update",this.name,u)}catch(b){b instanceof Error&&this.fine.log.capture(b,{tags:{fine_wrapper:this.name}}),this.fine.log.error(`An error occurred when calling forceUpdate on an instance of ${this.name}`,b)}}on(u,b,w,_,A=!1){return this._maybeWrap(u),super.on(u,b,w,_,A)}once(u,b,w,_,A=!1){return this._maybeWrap(u),super.once(u,b,w,_,A)}many(u,b,w,_,A,p=!1){return this._maybeWrap(u),super.many(u,b,w,_,A,p)}waitFor(u,b,w,_=!1){return this._maybeWrap(u),super.waitFor(u,b,w,_)}};z(d,"FineWrapper");let F=d},24431:(V,W,g)=>{"use strict";g.r(W),g.d(W,{API_SERVER:()=>L,BAD_HOTKEYS:()=>A,DEBUG:()=>k,EMQX_SERVERS:()=>$,EXTENSION:()=>O,EmoteTypes:()=>X,IS_FIREFOX:()=>M,IS_OSX:()=>P,IS_WEBKIT:()=>D,IS_WIN:()=>E,KEYS:()=>a,KNOWN_CODES:()=>r,LINK_DATA_HOSTS:()=>c,NEW_API:()=>u,PUBSUB_CLUSTERS:()=>S,REPLACEMENTS:()=>m,REPLACEMENT_BASE:()=>l,RERENDER_SETTINGS:()=>p,RESOLVERS_REQUIRE_TOS:()=>se,SENTRY_ID:()=>b,SERVER:()=>U,SERVER_OR_EXT:()=>F,STAGING_API:()=>d,STAGING_CDN:()=>C,TWITCH_EMOTE_V2:()=>o,TWITCH_GLOBAL_SETS:()=>G,TWITCH_POINTS_SETS:()=>Y,TWITCH_PRIME_SETS:()=>Q,UPDATE_BADGE_SETTINGS:()=>v,UPDATE_TOKEN_SETTINGS:()=>x,WEBKIT_CSS:()=>Z,WEIRD_EMOTE_SIZES:()=>_,WORD_SEPARATORS:()=>w,WS_CLUSTERS:()=>f});const k=localStorage.ffzDebugMode==="true"&&document.body.classList.contains("ffz-dev"),O=!0,U=k?"https://localhost:8000":"https://cdn2.frankerfacez.com";let T=`${U}/script`;O&&(T=g.p,T.endsWith("/")&&(T=T.slice(0,T.length-1)));const F=T,L="https://api.frankerfacez.com",d="https://api-staging.frankerfacez.com",C="https://cdn-staging.frankerfacez.com",u="https://api2.frankerfacez.com",b="https://74b46b3894114f399d51949c6d237489@sentry.frankerfacez.com/2",w="[\\s`~<>!-#%-\\x2A,-/:;\\x3F@\\x5B-\\x5D_\\x7B}\\u00A1\\u00A7\\u00AB\\u00B6\\u00B7\\u00BB\\u00BF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E3B\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]",_={15:[21,27],16:[22,27],17:[20,27],18:[20,27],22:[19,27],25:[25,28],26:[20,27],28:[39,27],30:[29,27],32:[21,27],33:[25,32],34:[21,28],36:[36,30],40:[21,27],41:[19,27],46:[24,24],47:[24,24],50:[18,27],52:[32,32],65:[40,30],66:[20,27],69:[41,28],73:[21,30],74:[24,30],86:[36,30],87:[24,30],92:[23,30],244:[24,30],354:[20,30],357:[28,30],360:[22,30],483:[20,18],484:[20,22],485:[27,18],486:[21,32],487:[15,32],488:[29,24],489:[20,18],490:[20,18],491:[20,18],492:[20,18],493:[20,18],494:[20,18],495:[20,18],496:[20,18],497:[20,18],498:[20,18],499:[20,18],500:[20,18],501:[20,18],1896:[20,30],1898:[26,28],1899:[22,30],1900:[33,30],1901:[24,28],1902:[27,29],1904:[24,30],1906:[24,30]},A=["f","space","k","shift+up","shift+down","esc","m","?","alt+t","alt+x"],p=["chat.name-format","chat.me-style","chat.rituals.show","chat.subs.show","chat.subs.compact","chat.actions.inline","chat.actions.hover","chat.timestamp-format","chat.points.allow-highlight","chat.filtering.display-deleted","chat.filtering.display-mod-action","chat.replies.style","chat.bits.cheer-notice","chat.filtering.hidden-tokens","chat.hype.message-style","chat.filtering.show-reasons","chat.emotes.allow-gigantify","chat.shared-chat.username-tooltip","chat.shared-chat.style"],v=["chat.badges.style","chat.badges.hidden","chat.badges.custom-mod","chat.badges.custom-vip"],x=["chat.emotes.enabled","chat.emotes.2x","chat.emotes.animated","chat.emoji.style","chat.emoji.replace-joiner","chat.bits.stack","chat.rich.enabled","chat.rich.want-mid","chat.rich.hide-tokens","chat.rich.all-links","chat.rich.minimum-level","chat.filtering.process-own","chat.filtering.mention-priority","chat.filtering.debug","chat.fix-bad-emotes","__filter:highlight-terms","__filter:highlight-users","__filter:highlight-badges","__filter:block-terms","__filter:block-users","__filter:block-badges"],a={Tab:9,Enter:13,Shift:16,Control:17,Alt:18,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Meta:91,Context:93},o="//static-cdn.jtvnw.net/emoticons/v2",r={"#-?[\\\\/]":"#-/",":-?(?:7|L)":":-7","\\&lt\\;\\]":"<]","\\:-?(S|s)":":-S","\\:-?\\\\":":-\\","\\:\\&gt\\;":":>","B-?\\)":"B-)","\\:-?[z|Z|\\|]":":-Z","\\:-?\\)":":-)","\\:-?\\(":":-(","\\:-?(p|P)":":-P","\\;-?(p|P)":";-P","\\&lt\\;3":"<3","\\:-?[\\\\/]":":-/","\\;-?\\)":";-)","R-?\\)":"R-)","[oO](_|\\.)[oO]":"O.o","[o|O](_|\\.)[o|O]":"O.o","\\:-?D":":-D","\\:-?(o|O)":":-O","\\&gt\\;\\(":">(","Gr(a|e)yFace":"GrayFace"},l=`${U}/static/replacements/`,m={15:"15-JKanStyle.png",16:"16-OptimizePrime.png",17:"17-StoneLightning.png",18:"18-TheRinger.png",22:"22-RedCoat.png",26:"26-JonCarnage.png",30:"30-BCWarrior.png",33:"33-DansGame.png",36:"36-PJSalt.png"},f={Production:[["wss://catbag.frankerfacez.com/",.25],["wss://andknuckles.frankerfacez.com/",.8],["wss://tuturu.frankerfacez.com/",.7],["wss://lilz.frankerfacez.com/",1],["wss://yoohoo.frankerfacez.com/",1],["wss://pog.frankerfacez.com/",1],["wss://ayaya.frankerfacez.com/",1],["wss://champ.frankerfacez.com/",1]],Development:[["ws://127.0.0.1:7999/",1]]},c={localhost:{title:"Local Dev Server (Port 8002)",value:"https://localhost:8002",has_sse:!0},"localhost-cf":{title:"Local Dev Worker (Wrangler, Port 8787)",value:"https://localhost:8787"},Production:{title:"Production",value:"https://link-service.workers.frankerfacez.com"}},S={Production:"https://pubsub.frankerfacez.com",Staging:"https://pubsub-staging-alt.frankerfacez.com",EMQXTest:"emqx-test",Development:"https://stendec.dev/ps/"},$=["biblethump.frankerfacez.com"],P=navigator.platform?navigator.platform.indexOf("Mac")!==-1:/OS X/.test(navigator.userAgent),E=navigator.platform?navigator.platform.indexOf("Win")!==-1:/Windows/.test(navigator.userAgent),D=navigator.userAgent.indexOf("AppleWebKit/")!==-1&&navigator.userAgent.indexOf("Edge/")===-1,M=navigator.userAgent.indexOf("Firefox/")!==-1,Z=D?"-webkit-":"",G=[0,33,42],Y=[300238151],Q=[457,793,19151,19194];var X=(J=>(J[J.Unknown=0]="Unknown",J[J.Prime=1]="Prime",J[J.Turbo=2]="Turbo",J[J.LimitedTime=3]="LimitedTime",J[J.ChannelPoints=4]="ChannelPoints",J[J.Unavailable=5]="Unavailable",J[J.Subscription=6]="Subscription",J[J.BitsTier=7]="BitsTier",J[J.Global=8]="Global",J[J.TwoFactor=9]="TwoFactor",J[J.Follower=10]="Follower",J))(X||{});const se={YouTube:{label:"You must agree to the YouTube Terms of Service to view this embed.",i18n_key:"embed.warn.youtube",i18n_links:"embed.warn.youtube.links",links:`To view YouTube embeds, you must agree to YouTube's Terms of Service:
* [Terms of Service](https://www.youtube.com/t/terms)
* [Privacy Policy](https://policies.google.com/privacy)`,i18n_accept:"embed.warn.youtube.agree",accept:"Yes, I accept the YouTube Terms of Service."}}},44589:(V,W,g)=>{"use strict";g.r(W),g.d(W,{ClickOutside:()=>r,ManagedStyle:()=>o,createElement:()=>b,findReactFragment:()=>u,hasSharedParent:()=>_,highlightJson:()=>l,off:()=>C,on:()=>d,openFile:()=>A,readFile:()=>p,sanitize:()=>x,setChildren:()=>w});var k=g(46949),O=g(24431);const U=["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","bgcolor","border","buffered","challenge","charset","checked","cite","class","code","codebase","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","data","data-*","datetime","default","defer","dir","dirname","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","integrity","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","seamless","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","type","usemap","value","width","wrap"],T=["controls","autoplay","loop"],F=document.createRange();function L(c){return c.replace(/[-_]\w/g,S=>S[1].toUpperCase())}z(L,"camelCase");function d(c,S,$,P){return c.addEventListener(S,$,P)}z(d,"on");function C(c,S,$,P){return c.removeEventListener(S,$,P)}z(C,"off");function u(c,S,$=25,P=0,E){if(!E)E=new Set;else if(E.has(c))return null;if(S(c))return c;if(P>=$)return null;if(E.add(c),c?.props?.children)if(Array.isArray(c.props.children)){for(const D of c.props.children)if(D)if(Array.isArray(D))for(const M of D){const Z=u(M,S,$,P+1,E);if(Z)return Z}else{const M=u(D,S,$,P+1,E);if(M)return M}}else{const D=u(c.props.children,S,$,P+1,E);if(D)return D}return null}z(u,"findReactFragment");function b(c,S,...$){const P=document.createElement(c);if($.length===0?$=null:$.length===1&&($=$[0]),typeof S=="string")P.className=S;else if(S){for(const E in S)if((0,k.has)(S,E)){const D=E.toLowerCase(),M=S[E];if(D==="style")if(typeof M=="string")P.style.cssText=M;else if(M&&typeof M=="object")for(const[Z,G]of Object.entries(M))(0,k.has)(P.style,Z)||(0,k.has)(Object.getPrototypeOf(P.style),Z)?P.style[Z]=G:P.style.setProperty(Z,M[Z]);else O.DEBUG&&M!=null&&console.warn("unsupported style value",M);else if(D==="dataset")if(M&&typeof M=="object")for(const Z in M)(0,k.has)(M,Z)&&(P.dataset[L(Z)]=M[Z]);else O.DEBUG&&M!=null&&console.warn("unsupported dataset value",M);else E==="dangerouslySetInnerHTML"?M&&M.__html&&(P.innerHTML=M.__html):D.startsWith("on")?P.addEventListener(D.slice(2),M):D.startsWith("data-")?P.dataset[L(D.slice(5))]=M:T.includes(D)?M&&M!=="false"&&P.setAttribute(E,M):D.startsWith("aria-")||U.includes(D)?P.setAttribute(E,M):P[E]=M}}return $&&w(P,$),P}z(b,"createElement");function w(c,S,$=!1,P=!1){if($&&window.FrankerFaceZ.get().log.warn("call to setChildren with no_sanitize set to true -- this is no longer supported"),S instanceof Node)P||(c.innerHTML=""),c.appendChild(S);else if(Array.isArray(S)){P||(c.innerHTML="");for(const E of S)if(E instanceof Node)c.appendChild(E);else if(Array.isArray(E))w(c,E,$,!0);else if(E){const D=typeof E=="string"?E:String(E);c.appendChild(document.createTextNode(D))}}else if(S){const E=typeof S=="string"?S:String(S);c.appendChild(document.createTextNode(E))}}z(w,"setChildren");function _(c,S,$){for(;c;){if(c.contains(S))return!0;c=c.parentElement,$&&(c=c instanceof Element?c.closest($):null)}return!1}z(_,"hasSharedParent");function A(c,S){return new Promise($=>{const P=document.createElement("input");P.type="file",P.accept=c,P.multiple=S;let E=!1;P.onchange=()=>{if(!E){E=!0;const D=Array.from(P.files??[]);$(S?D:D[0])}},P.click()})}z(A,"openFile");function p(c,S="utf-8"){return new Promise(($,P)=>{const E=new FileReader;E.readAsText(c,S),E.onload=()=>$(E.result),E.onerror=D=>P(D)})}z(p,"readFile");const v=document.createElement("span");function x(c){v.textContent=c;const S=v.innerHTML;return v.textContent="",S}z(x,"sanitize");let a=0;const m=class m{constructor(S){this.id=S||a++,this._blocks={},this._style=b("style",{type:"text/css",id:`ffz--managed-style--${this.id}`}),document.head.appendChild(this._style)}destroy(){this._style&&this._style.remove(),this._blocks=null,this._style=null}clear(){this._blocks={},this._style.innerHTML=""}get(S){const $=this._blocks[S];if($)return $.textContent}has(S){return!!this._blocks[S]}set(S,$,P=!1){const E=this._blocks[S];if(E){if(!P&&E.textContent===$)return;E.textContent=$}else this._style.appendChild(this._blocks[S]=document.createTextNode($))}delete(S){const $=this._blocks[S];$&&(this._style.contains($)&&this._style.removeChild($),this._blocks[S]=null)}};z(m,"ManagedStyle");let o=m;const f=class f{constructor(S,$){this.el=S,this.cb=$,this._fn=this.handleClick.bind(this),document.documentElement.addEventListener("click",this._fn)}destroy(){this._fn&&document.documentElement.removeEventListener("click",this._fn),this.cb=this.el=this._fn=null}handleClick(S){this.cb&&this.el&&!this.el.contains(S.target)&&this.cb(S)}};z(f,"ClickOutside");let r=f;function l(c,S=!1,$=1,P=30){let E="",D="";if(S&&(E="    ".repeat($-1),D="    ".repeat($)),$>P)return'<span class="ffz-ct--obj-literal">&lt;nested&gt;</span>';if(c==null)return`<span class="ffz-ct--literal" depth="${$}">null</span>`;if(typeof c=="number"||typeof c=="boolean")return`<span class="ffz-ct--literal" depth="${$}">${c}</span>`;if(typeof c=="string")return`<span class=ffz-ct--string depth="${$}">${x(JSON.stringify(c))}</span>`;if(Array.isArray(c))return`<span class="ffz-ct--obj-open" depth="${$}">[</span>`+(c.length>0?c.map(Z=>(S?`
${D}`:"")+l(Z,S,$+1,P)).join(`<span class="ffz-ct--obj-sep" depth="${$}">, </span>`)+(S?`
${E}`:""):"")+`<span class="ffz-ct--obj-close" depth="${$}">]</span>`;const M=[];for(const[Z,G]of Object.entries(c))M.length>0&&M.push(`<span class="ffz-ct--obj-sep" depth="${$}">, </span>`),S&&M.push(`
${D}`),M.push(`<span class="ffz-ct--obj-key" depth="${$}">${x(JSON.stringify(Z))}</span><span class="ffz-ct--obj-key-sep" depth="${$}">: </span>`),M.push(l(G,S,$+1,P));return`<span class="ffz-ct--obj-open" depth="${$}">{</span>${M.join("")}${M.length&&S?`
${E}`:""}<span class="ffz-ct--obj-close" depth="${$}">}</span>`}z(l,"highlightJson")},17159:(V,W,g)=>{var _;"use strict";g.r(W),g.d(W,{Detach:()=>k,EventEmitter:()=>d,FFZEvent:()=>C,FFZWaitableEvent:()=>u,HierarchicalEventEmitter:()=>b,StopPropagation:()=>O,default:()=>w});const k=Symbol("Detach"),O=Symbol("StopPropagation"),U=/([a-z])([A-Z])/g,T=/[ \t\W]/g,F=/^_+|_+$/g;String.prototype.toSlug=function(x="-"){let a=this;return a.normalize&&(a=a.normalize("NFD")),a.replace(/[\u0300-\u036f]/g,"").trim().toLowerCase().replace(/[^a-z0-9 ]/g,"").replace(/\s+/g,x)},String.prototype.toSnakeCase=function(){let x=this;return x.normalize&&(x=x.normalize("NFD")),x.replace(/[\u0300-\u036f]/g,"").trim().replace(U,"$1_$2").replace(T,"_").replace(F,"").toLowerCase()};const L=(_=class{constructor(){this.__listeners={},this.__running=new Set,this.__dead_events=0}__cleanListeners(){if(!this.__dead_events)return[];const a={},o=this.__listeners,r=[];for(const[l,m]of Object.entries(o))m?.length?a[l]=m:r.push(l);return this.__listeners=a,this.__dead_events=0,r}__sortListeners(a){if(this.__running.has(a))return;const o=this.__listeners[a];o&&o.sort((r,l)=>r[3]-l[3])}transferListeners(a){if(!(a instanceof _))throw new Error("other must also be EventEmitter");if(!(a.events().length+a.__running.size)){a.__listeners=this.__listeners,a.__dead_events=this.__dead_events,this.__listeners={},this.__dead_events=0;return}for(const[r,l]of Object.entries(this.__listeners)){if(!l||!l.length)continue;let m=a.__listeners[r];Array.isArray(m)?(m.push(...l),a.__sortListeners(r)):a.__listeners[r]=l}this.__listeners={},this.__dead_events=0}makeEvent(a){return C.makeEvent(a)}makeWaitableEvent(a){return u.makeEvent(a)}on(a,o,r,l,m=!1){if(typeof o!="function")throw new TypeError("fn must be a function");const f=[o,r,!1,l??0,m],c=this.__listeners[a];return c?(m?c.unshift(f):c.push(f),this.__sortListeners(a)):this.__listeners[a]=[f],this}once(a,o,r,l,m=!1){return this.many(a,1,o,r,l,m)}many(a,o,r,l,m,f=!1){if(typeof r!="function")throw new TypeError("fn must be a function");if(typeof o!="number"||isNaN(o)||!isFinite(o)||o<1)throw new TypeError("ttl must be a positive, finite number");const c=[r,l,o,m??0,f],S=this.__listeners[a];return S?(f?S.unshift(c):S.push(c),this.__sortListeners(a)):this.__listeners[a]=[c],this}waitFor(a,o,r,l=!1){return new Promise(m=>{const f=[(...S)=>m(S),o,1,r??0,l],c=this.__listeners[a];c?(l?c.unshift(f):c.push(f),this.__sortListeners(a)):this.__listeners[a]=[f]})}off(a,o,r){if(a==null){if(!o&&!r)throw new Error("you must provide at least one constraint when removing listeners");for(const m in Object.keys(this.__listeners))this.__running.has(m)||this.off(m,o,r);return this}if(this.__running.has(a))throw new Error("concurrent modification: tried removing event listener while event is running");let l=this.__listeners[a];return l?(!o&&!r?l=null:(l=l.filter(([m,f])=>!((!o||m===o)&&(!r||r===f))),l.length||(l=null)),this.__listeners[a]=l,l||this.__dead_events++,this):this}offContext(a,o){return this.off(a,void 0,o)}events(){return this.__cleanListeners(),Object.keys(this.__listeners)}listeners(a){const o=this.__listeners[a];return o?Array.from(o):[]}hasListeners(a){return!!this.__listeners[a]}emit(a,...o){let r=this.__listeners[a];if(!r)return;if(this.__running.has(a))throw new Error("concurrent access: tried to emit event while event is running");const l=new Set;this.__listeners[a]=null,this.__running.add(a);for(const c of r){const[S,$,P]=c;let E;try{E=S.apply($,o)}catch(D){this.log&&(this.log.capture(D,{tags:{event:a},extra:{args:o}}),this.log.error(D))}if(E===k?l.add(c):P!==!1&&(P<=1?l.add(c):c[2]=P-1),E instanceof Promise&&o[0]instanceof u&&o[0].waitFor(E),o[0]instanceof C&&o[0].propagationStopped||E===O)break}if(l.size)for(const c of l){const S=r.indexOf(c);S!==-1&&r.splice(S,1)}let m=!1;const f=this.__listeners[a];f&&(r=r.concat(f),m=!0),r.length?this.__listeners[a]=r:(this.__listeners[a]=null,this.__dead_events++),this.__running.delete(a),m&&this.__sortListeners(a)}},z(_,"_EventEmitter2"),_);L.Detach=k,L.StopPropagation=O;let d=L;const A=class A{static makeEvent(a){return new A(a)}constructor(a){this.defaultPrevented=!1,this.propagationStopped=!1,Object.assign(this,a)}_reset(){this.defaultPrevented=!1,this.propagationStopped=!1}stopPropagation(){this.propagationStopped=!0}preventDefault(){this.defaultPrevented=!0}};z(A,"FFZEvent");let C=A;const p=class p extends C{constructor(){super(...arguments),this.__waiter_results=null}static makeEvent(a){return new p(a)}_wait(){if(this.__waiter)return this.__waiter;if(!this.__promises){const o=this.__waiter_results;return this.__waiter_results=null,o?Promise.resolve(o):null}const a=this.__promises;return this.__promises=null,this.__waiter=Promise.all(a).then(o=>(this.__waiter_results?this.__waiter_results.push(...o):this.__waiter_results=o,this.__waiter=null,this._wait()??[])).catch(o=>{throw this.__waiter=null,o})}_reset(){super._reset(),this.__waiter=null,this.__waiter_results=null,this.__promises=null}waitFor(a){this.__promises?this.__promises.push(a):this.__promises=[a]}};z(p,"FFZWaitableEvent");let u=p;const v=class v extends d{constructor(a,o){super(),this.name=a||(this.constructor.name||"").toSnakeCase(),this.parent=o,o?(this.root=o.root,this.__listeners=o.__listeners,this.__running=o.__running,this.__path=a&&o.__path?`${o.__path}.${a}`:a):(this.root=this,this.__path=void 0),this.__path_parts=this.__path?this.__path.split("."):[]}get path(){return this.__path}transferListeners(a){if(!(a instanceof v&&a.root===this.root))throw new Error("Transfering listeners from a HierarchicalEventEmitter is not supported.")}abs_path(a){if(typeof a!="string"||!a.length)throw new TypeError("path must be a non-empty string");let o=0,r;const l=this.__path_parts,m=l.length;do{if(r=a.charAt(o),a.charAt(o)==="."){if(o>m)throw new Error("invalid path: reached top of stack");continue}break}while(++o<a.length);const f=r===":";if(o===0)return f&&this.__path?`${this.__path}${a}`:a;const c=l.slice(0,m-(o-1)).join("."),S=a.slice(o);if(c.length)if(S.length){if(f)return c+S}else return c;else return S;return`${c}.${S}`}on(a,o,r,l,m=!1){return super.on(this.abs_path(a),o,r,l,m)}once(a,o,r,l,m=!1){return super.once(this.abs_path(a),o,r,l,m)}many(a,o,r,l,m,f=!1){return super.many(this.abs_path(a),o,r,l,m,f)}waitFor(a,o,r,l=!1){return super.waitFor(this.abs_path(a),o,r,l)}off(a,o,r){return super.off(a&&this.abs_path(a),o,r)}listeners(a){return super.listeners(this.abs_path(a))}hasListeners(a){return super.hasListeners(this.abs_path(a))}emit(a,...o){return super.emit(this.abs_path(a),...o)}eventsWithChildren(){const a=super.events(),o=this.__path||"",r=o.length;return a.filter(l=>{const m=l.charAt(r);return l.startsWith(o)&&(m===""||m==="."||m===":")})}events(){const a=super.events(),o=this.__path||"",r=o.length;return a.filter(l=>{const m=l.charAt(r);return l.startsWith(o)&&(m===""||m===":")})}};z(v,"HierarchicalEventEmitter");let b=v;const w=b},37087:(V,W,g)=>{"use strict";g.d(W,{createTester:()=>k});function k(O,U,T=!1,F=!1,L){if(!Array.isArray(O)||!U)return T?()=>!1:()=>!0;const d=[],C=[];let u=0;for(const b of O){if(!b||!b.type)continue;const w=U[b.type];if(!w){u++,d.push(()=>!1),C.push(`f${u}`);continue}const _=w.createTest(b.data,U,L);_&&(u++,d.push(_),C.push(`f${u}`))}return d.length?d.length===1?T?b=>!d[0](b):d[0]:new Function(...C,"ctx",`return ${T?"!(":""}${C.map(b=>`${b}(ctx)`).join(F?" || ":" && ")}${T?")":""};`).bind(null,...d):T?()=>!1:()=>!0}z(k,"createTester")},83342:(V,W,g)=>{"use strict";g.d(W,{R7:()=>v,jo:()=>x});var k=g(44589);const O=g.p+"opendyslexic.css",U=["Roobert","Arial","Arial Black","Verdana","Helvetica","Tahoma","Trebuchet MS","Impact","Didot","American Typewriter","Lucida Console","Monaco","Bradley Hand","Times New Roman","Georgia","Garamond","Courier New","Brush Script MT","Comic Sans MS"],T=document.fonts?.check?U.filter(a=>document.fonts.check(`16px ${a}`)).sort():U.sort(),F=["Roboto","Open Sans","Noto Sans JP","Lato","Montserrat","Roboto Condensed","Source Sans Pro","Oswald","Poppins","Noto Sans","Roboto Mono","Raleway","Ubuntu","Merriweather","Nunito","PT Sans","Roboto Slab","Playfair Display","Lora","Rubik","Mukta","Noto Sans KR","Work Sans","Nunito Sans","Nanum Gothic","Inter","Quicksand","PT Serif","Hind Siliguri","Titilium Web","Fira Sans","Noto Serif","Noto Sans TC","Karla"],L=new Map,d=new Map;function C(a){if(d.has(a))return;const o=encodeURIComponent(a),r=(0,k.createElement)("link",{id:`ffz-font-${o}`,rel:"stylesheet",href:`https://fonts.googleapis.com/css2?family=${o}`});d.set(a,r),document.head.appendChild(r)}z(C,"loadGoogleFont");function u(a){const o=d.get(a);o&&(d.delete(a),o.remove())}z(u,"unloadGoogleFont");const b=["OpenDyslexic","OpenDyslexicAlta","OpenDyslexicMono"];let w=0,_=null;function A(){_||(_=(0,k.createElement)("link",{id:"ffz-font-opendyslexic",rel:"stylesheet",type:"text/css",href:O}),document.head.appendChild(_))}z(A,"loadOpenDyslexic");function p(){_&&(_.remove(),_=null)}z(p,"unloadOpenDyslexic");function v(){const a=[{value:"",i18n_key:"setting.font.default",title:"Default"},{separator:!0,i18n_key:"setting.font.builtin",title:"Built-in Fonts"}];for(const o of T)a.push({value:o,title:o});a.push({separator:!0,i18n_key:"setting.font.dyslexic",title:"Dyslexia Fonts"});for(const o of b)a.push({value:o,title:o});a.push({separator:!0,i18n_key:"setting.font.google",title:"Google Fonts"});for(const o of F)a.push({value:`google:${o}`,title:o});return a}z(v,"getFontsList");function x(a){if(!a)return[a,null];if(b.includes(a)){w++,w===1&&A();let o=!1;return[a,z(()=>{o||(o=!0,w--,w||p())},"unloader")]}if(a.startsWith("google:")){const o=a.slice(7),r=(L.get(o)??0)+1;L.set(o,r),r===1&&C(o);let l=!1;return[o,z(()=>{if(!l){l=!0;const f=(L.get(o)??0)-1;f>0?L.set(o,f):(L.delete(o),u(o))}},"unloader")]}return[a,null]}z(x,"useFont")},55467:(V,W,g)=>{var d;"use strict";g.r(W),g.d(W,{LogLevel:()=>O,Logger:()=>F,default:()=>L});const k={1:"debug",2:"info",4:"warn",8:"error"};var O=(C=>(C[C.Verbose=0]="Verbose",C[C.Debug=1]="Debug",C[C.Info=2]="Info",C[C.Warning=4]="Warning",C[C.Error=8]="Error",C[C.Off=99]="Off",C))(O||{});function U(){const C=localStorage.ffzLogLevel;if(!C)return null;const u=C.toUpperCase(),b=F[u];return typeof b=="number"?b:/^\d+$/.test(C)?parseInt(C,10):null}z(U,"readLSLevel");const T=(d=class{constructor(u,b,w,_){this.root=u?u.root:this,this.parent=u,this.name=b,this.root==this&&(this.init=!1,this.captured_init=[],this.label="FFZ"),this.enabled=!0,this.level=w??(u&&u.level)??U()??d.DEFAULT_LEVEL,this.raven=_||u&&u.raven,this.children={}}hi(u,b){const w=b??u.constructor?.version_info;this.info(`FrankerFaceZ v${w} (s:${u.host} f:${u.flavor} b:${w?.build} c:${w?.commit||"null"})`);try{const _=new URL(location.toString());_.search="",this.info(`Initial URL: ${_}`)}catch(_){this.warn("Unable to read location.",_)}}get(u,b){return this.children[u]||(this.children[u]=new d(this,this.name?`${this.name}.${u}`:u,b)),this.children[u]}verbose(u,...b){return this.invoke(0,u,b)}verboseColor(u,b,...w){return this.invokeColor(d.VERBOSE,u,b,w)}debug(u,...b){return this.invoke(d.DEBUG,u,b)}debugColor(u,b,...w){return this.invokeColor(d.DEBUG,u,b,w)}info(u,...b){return this.invoke(d.INFO,u,b)}infoColor(u,b,...w){return this.invokeColor(d.INFO,u,b,w)}warn(u,...b){return this.invoke(d.WARN,u,b)}warnColor(u,b,...w){return this.invokeColor(d.WARN,u,b,w)}warning(u,...b){return this.invoke(d.WARN,u,b)}warningColor(u,b,...w){return this.invokeColor(d.WARN,u,b,w)}error(u,...b){return this.invoke(d.ERROR,u,b)}errorColor(u,b,...w){return this.invokeColor(d.ERROR,u,b,w)}crumb(...u){if(this.raven)return this.raven.captureBreadcrumb(...u)}capture(u,b,...w){if(this.raven&&(b=b||{},b.logger||(b.logger=this.name),this.raven.captureException(u,b)),w.length){const _=w.shift();return this.error(_,...w)}}invokeColor(u,b,w,..._){if(!this.enabled||u<this.level)return;if(Array.isArray(w)||(w=[w]),u>0){let p=b;typeof p=="string"&&(p=p.replace(/%c/g,"")),_.length&&(p=`${p} ${_.join(" ")}`),this.root.init&&this.root.captured_init&&this.root.captured_init.push({time:Date.now(),category:this.name,message:p,level:k[u]||u}),this.crumb({message:p,category:this.name,level:k[u]||u})}const A=u<2?"color:#999999":"";this.name?(typeof b=="string"?b=`%c${this.root.label} [%c${this.name}%c]:%c ${b}`:(_.unshift(b),b=`%c${this.root.label} [%c${this.name}%c]:%c`),w.unshift("color:#755000; font-weight:bold",A,"color:#755000; font-weight:bold",A)):(typeof b=="string"?b=`%c${this.root.label}:%c ${b}`:(_.unshift(b),b=`%c${this.root.label}:%c`),w.unshift("color:#755000; font-weight:bold",A)),u<2?console.debug(b,...w,..._):u<4?console.info(b,...w,..._):u<8?console.warn(b,...w,..._):u<99&&console.error(b,...w,..._)}invoke(u,b,w){if(!this.enabled||u<this.level||u>=99)return;const _=w?[b,...w]:[b];if(u>0){const v=_.join(" ");this.root.init&&this.root.captured_init&&this.root.captured_init.push({time:Date.now(),category:this.name,message:v,level:k[u]||u}),this.crumb({message:v,category:this.name,level:k[u]||u})}const A=u<2?"color:#999999":"";let p="";if(A!=="")for(;_.length>0&&typeof _[0]=="string";)p+=" "+_.shift();this.name?_.unshift(`%c${this.root.label} [%c${this.name}%c]:%c${p}`,"color:#755000; font-weight:bold",A,"color:#755000; font-weight:bold",A):_.unshift(`%c${this.root.label}:%c${p}`,"color:#755000; font-weight:bold",A),u<2?console.debug(..._):u<4?console.info(..._):u<8?console.warn(..._):u<99&&console.error(..._)}},z(d,"_Logger2"),d);T.Levels=O,T.VERBOSE=0,T.DEBUG=1,T.INFO=2,T.WARN=4,T.WARNING=4,T.ERROR=8,T.OFF=99,T.DEFAULT_LEVEL=2;let F=T;const L=F},22527:(V,W,g)=>{var A;"use strict";g.r(W),g.d(W,{CyclicDependencyError:()=>_,LoadState:()=>U,Module:()=>C,ModuleError:()=>w,State:()=>T,buildAddonProxy:()=>b,default:()=>u});var k=g(17159),O=g(46949),U=(x=>(x[x.Unloaded=0]="Unloaded",x[x.Loading=1]="Loading",x[x.Loaded=2]="Loaded",x[x.Unloading=3]="Unloading",x))(U||{}),T=(x=>(x[x.Disabled=0]="Disabled",x[x.Enabling=1]="Enabling",x[x.Enabled=2]="Enabled",x[x.Disabling=3]="Disabling",x))(T||{});const F=/^addon\.([^.]+)(?:\.|$)/i;function L(x){return F.exec(x)?.[1]}z(L,"extractAddonId");const d=(A=class extends k.default{constructor(a,o,r){if(!o&&a instanceof A&&(o=a,a=void 0),super(a,o),this.load_dependents=null,this.dependents=null,this.references=null,this.__modules=o?o.__modules:{},this.children={},o?.__addon_id)this.__addon_id=o.__addon_id,this.__addon_root=o.__addon_root;else if(r){const m=L(this.__path);m&&(this.__addon_id=m,this.__addon_root=this)}o&&!o.children[this.name]&&(o.children[this.name]=this),this.root===this&&(this.__modules[this.__path||""]=this);let l=!!this.onLoad;if(!l){const m=this.__get_load_requires();l=Array.isArray(m)&&m.length>0}this.__load_state=l?0:2,this.__state=l||this.onEnable?0:2,this._time("instance"),this.emit(":registered",this)}get state(){return this.__state}get load_state(){return this.__load_state}get loaded(){return this.__load_state===2}get loading(){return this.__load_state===1}get enabled(){return this.__state===2}get enabling(){return this.__state===1}get addon_id(){return this.__addon_id}get addon_root(){return this.__addon_root}get addon_manifest(){if(this.__addon_id)return this.resolve("addons")?.getAddon(this.__addon_id)??this.__addon_root?.constructor?.info??void 0}get log(){return this.__log||(this.__log=this.parent&&this.parent.log?.get?.(this.name)),this.__log}set log(a){this.__log=a}_time(a){this.root.timing&&(typeof a!="object"&&(a={event:a}),a.module=this.__path||"core",this.root.timing.addEvent(a))}load(){return this.__load(this.__path,[])}unload(){return this.__unload(this.__path,[])}enable(){return this.__enable(this.__path,[])}disable(){return this.__disable(this.__path,[])}canUnload(){return this.__canUnload(this.__path,[])}canDisable(){return this.__canDisable(this.__path,[])}__load(a,o){const r=this.__path||this.name,l=this.__load_state;if(o.includes(this))return Promise.reject(new _(`cyclic load requirements when loading ${a}`,[...o,this]));if(this.load_requires)for(const m of this.load_requires){const f=this.__resolve(m);if(f instanceof A&&o.includes(f))return Promise.reject(new _(`cyclic load requirements when loading ${a}`,[...o,this,f]))}return o.push(this),l===1?this.__load_promise:l===2?Promise.resolve():l===3?Promise.reject(new w(`attempted to load module ${r} while module is being unloaded`)):(this._time("load-start"),this.__load_state=1,this.__load_promise=(async()=>{if(this.load_requires){const m=[];for(const f of this.load_requires){const c=this.__resolve(f);if(!c||!(c instanceof A))throw new w(`cannot find required module ${f} when loading ${r}`);m.push(c.__enable(a,Array.from(o)))}await Promise.all(m)}if(this.onLoad)return this._time("load-self"),this.onLoad()})().then(m=>(this.__load_state=2,this.__load_promise=null,this._time("load-end"),this.emit(":loaded",this),m)).catch(m=>{throw this.__load_state=0,this.__load_promise=null,this._time("load-end"),m}))}__canUnload(a,o){const r=this.__path||this.name,l=this.__load_state;if(o.includes(this))throw new _(`cyclic load requirements when checking if can unload ${a}`,[...o,this]);if(this.load_dependents){o.push(this);for(const m of this.load_dependents){const f=this.__resolve(m);if(f instanceof A){if(o.includes(f))throw new _(`cyclic load requirements when checking if can unload ${a}`,[...o,this,f]);if(!f.__canUnload(a,Array.from(o)))return!1}}}return l===3||l===0?!0:this.onLoad&&!this.onUnload?!1:l!==1}__unload(a,o){const r=this.__path||this.name,l=this.__load_state;if(o.includes(this))return Promise.reject(new _(`cyclic load requirements when unloading ${a}`,[...o,this]));if(this.load_dependents)for(const m of this.load_dependents){const f=this.__resolve(m);if(f instanceof A&&o.includes(f))return Promise.reject(new _(`cyclic load requirements when unloading ${a}`,[...o,this,f]))}return o.push(this),l===3?this.__load_promise:l===0?Promise.resolve():this.onLoad&&!this.onUnload?Promise.reject(new w(`attempted to unload module ${r} but module cannot be unloaded`)):l===1?Promise.reject(new w(`attempted to unload module ${r} while module is being loaded`)):(this._time("unload-start"),this.__load_state=3,this.__load_promise=(async()=>{if(this.__state!==0&&await this.disable(),this.load_dependents){const m=[];for(const f of this.load_dependents){const c=this.__resolve(f);!c||!(c instanceof A)||m.push(c.__unload(a,Array.from(o)))}await Promise.all(m)}if(this._time("unload-self"),this.onUnload)return this.onUnload()})().then(m=>(this.__load_state=0,this.__load_promise=null,this._time("unload-end"),this.emit(":unloaded",this),m)).catch(m=>{throw this.__load_state=2,this.__load_promise=null,this._time("unload-end"),m}))}__enable(a,o){const r=this.__path||this.name,l=this.__state;if(o.includes(this))return Promise.reject(new _(`cyclic requirements when enabling ${a}`,[...o,this]));if(this.requires)for(const m of this.requires){const f=this.__resolve(m);if(f instanceof A&&o.includes(f))return Promise.reject(new _(`cyclic requirements when enabling ${a}`,[...o,this,f]))}return o.push(this),l===1?this.__state_promise:l===2?Promise.resolve():l===3?Promise.reject(new w(`attempted to enable module ${r} while module is being disabled`)):(this._time("enable-start"),this.__state=1,this.__state_promise=(async()=>{const m=[],f=this.requires,c=this.__load_state;if(c===3)throw new w(`attempted to load module ${r} while module is being unloaded`);if((c===1||c===0)&&m.push(this.load()),f)for(const S of f){const $=this.__resolve(S);if(!$||!($ instanceof A))throw new w(`cannot find required module ${S} when enabling ${r}`);m.push($.__enable(a,Array.from(o)))}if(await Promise.all(m),this.onEnable)return this._time("enable-self"),this.onEnable()})().then(m=>(this.__state=2,this.__state_promise=null,this._time("enable-end"),this.emit(":enabled",this),m)).catch(m=>{throw this.__state=0,this.__state_promise=null,this._time("enable-end"),m}))}__canDisable(a,o){const r=this.__path||this.name,l=this.__state;if(o.includes(this))throw new _(`cyclic load requirements when checking if can disable ${a}`,[...o,this]);if(this.dependents){o.push(this);for(const m of this.dependents){const f=this.__resolve(m);if(f&&f instanceof A){if(o.includes(f))throw new _(`cyclic load requirements when checking if can disable ${a}`,[...o,this,f]);if(!f.__canDisable(a,Array.from(o)))return!1}}}if(l===3||l===0)return!0;if(this.onDisable){if(l===1)return!1}else return!1;return!0}__disable(a,o){const r=this.__path||this.name,l=this.__state;if(o.includes(this))return Promise.reject(new _(`cyclic requirements when disabling ${a}`,[...o,this]));if(this.dependents)for(const m of this.dependents){const f=this.__resolve(m);if(f instanceof A&&o.includes(f))return Promise.reject(new _(`cyclic requirements when disabling ${a}`,[...o,this,f]))}if(o.push(this),l===3)return this.__state_promise;if(l===0)return Promise.resolve();if(this.onDisable){if(l===1)return Promise.reject(new w(`attempted to disable module ${r} but module is being enabled`))}else return Promise.reject(new w(`attempted to disable module ${r} but module cannot be disabled`));return this._time("disable-start"),this.__state=3,this.__state_promise=(async()=>{if(this.__load_state!==2)throw new w(`attempted to disable module ${r} but module is unloaded -- weird state`);if(this.dependents){const m=[];for(const f of this.dependents){const c=this.__resolve(f);!c||!(c instanceof A)||m.push(c.__disable(a,Array.from(o)))}await Promise.all(m)}if(this.onDisable)return this._time("disable-self"),this.onDisable()})().then(m=>(this.__state=0,this.__state_promise=null,this._time("disable-end"),this.emit(":disabled",this),m)).catch(m=>{throw this.__state=2,this.__state_promise=null,this._time("disable-end"),m})}on(a,o,r,l,m=!1){return super.on(a,o,r===void 0?this:r,l,m)}once(a,o,r,l,m=!1){return super.once(a,o,r===void 0?this:r,l,m)}many(a,o,r,l,m,f=!1){return super.many(a,o,r,l===void 0?this:l,m,f)}waitFor(a,o,r,l=!1){return super.waitFor(a,o===void 0?this:o,r,l)}off(a,o,r){return super.off(a,o,r===void 0?this:r)}__resolve(a){return a instanceof A?a:this.__modules[this.abs_path(a)]}resolve(a){let o=this.__resolve(a);return o instanceof A?(this.__processModule&&(o=this.__processModule(o)),o):null}hasModule(a){return this.__modules[this.abs_path(a)]instanceof A}__get_requires(){return(0,O.has)(this,"requires")?this.requires:(0,O.has)(this.constructor,"requires")?this.constructor.requires:null}__get_load_requires(){return(0,O.has)(this,"load_requires")?this.load_requires:(0,O.has)(this.constructor,"load_requires")?this.constructor.load_requires:null}__processModule(a){if(this.__addon_id&&a.getAddonProxy){const o=this.__addon_id;if(a.__proxies||(a.__proxies={}),a.__proxies[o])return a.__proxies[o];const r=this.__resolve("addons")?.getAddon?.(o),l=a.getAddonProxy(o,r,this.__addon_root??this,this);return l!==a&&(a.__proxies[o]=l),l}return a}inject(a,o,r=!0){(a instanceof A||a&&a.prototype instanceof A)&&(r=o??!0,o=a,a=null);const l=this.requires=this.__get_requires()||[];if(o instanceof A)a||(a=o.constructor.name.toSnakeCase());else if(o&&o.prototype instanceof A)a||(a=o.name.toSnakeCase()),o=this.register(a,o);else if(a){const m=a;if(a=a.replace(/^(?:[^.]*\.)+/,""),o=this.__resolve(m),!o||!(o instanceof A))return o?o[2].push([this.__path,a]):this.__modules[this.abs_path(m)]=[[],[],[[this.__path,a]]],l.push(this.abs_path(m)),this[a]=null}else throw new TypeError("must provide a valid module name or class");if(!o)throw new Error(`cannot find module ${a} or no module provided`);return r&&l.push(o.abs_path(".")),this.enabled&&!o.enabled&&o.enable(),o.references.push([this.__path,a]),o instanceof A&&this.__processModule&&(o=this.__processModule(o)),this[a]=o}injectAs(a,o,r,l=!0){(o instanceof A||o&&o.prototype instanceof A)&&(l=r??!0,r=o,o=null);const m=this.requires=this.__get_requires()||[];if(r instanceof A)o||(o=r.constructor.name.toSnakeCase());else if(r&&r.prototype instanceof A)o||(o=r.name.toSnakeCase()),r=this.register(o,r);else if(o){const f=o;if(o=o.replace(/^(?:[^.]*\.)+/,""),r=this.__resolve(f),!r||!(r instanceof A))return r?r[2].push([this.__path,a]):this.__modules[this.abs_path(f)]=[[],[],[[this.__path,a]]],m.push(this.abs_path(f)),this[a]=null}else throw new TypeError("must provide a valid module name or class");if(!r)throw new Error(`cannot find module ${o} or no module provided`);return l&&m.push(r.abs_path(".")),this.enabled&&!r.enabled&&r.enable(),r.references.push([this.__path,a]),this.__processModule&&(r=this.__processModule(r)),this[a]=r}register(a,o,r=!1){a.prototype instanceof A&&(r=o,o=a,a=o.name.toSnakeCase());const l=this.abs_path(`.${a}`),m=o.prototype,f=this.__modules[l];if(!(m instanceof A))throw new TypeError(`Module ${a} is not subclass of Module.`);if(f instanceof A)throw new w(`Name Collision for Module ${l}`);const c=f||[[],[],[]];let S=this.__modules[l]=new o(a,this);const $=S.requires=S.__get_requires()||[],P=S.load_requires=S.__get_load_requires()||[];S.dependents=c[0],S.load_dependents=c[1],S.references=c[2];for(const E of $){const D=S.abs_path(E),M=this.__modules[D];M?Array.isArray(M)?M[0].push(l):M.dependents.push(l):this.__modules[D]=[[l],[],[]]}for(const E of P){const D=S.abs_path(E),M=this.__modules[D];M?Array.isArray(M)?M[1].push(l):M.load_dependents.push(l):this.__modules[D]=[[],[l],[]]}for(const[E,D]of c[2]){const M=this.__resolve(E);M&&!Array.isArray(M)?M[D]=S:this.log.warn(`Unable to find module "${E}" that wanted "${D}".`)}return this.__processModule&&(S=this.__processModule(S)),r&&(this[a]=S),S}async loadFromContext(a,o){o=o??this.log;const r={};for(const l of a.keys()){const m=await a(l),f=m.module||m.default,c=l.lastIndexOf("."),S=c>2?l.slice(2,c):l,$=S.endsWith("/index")?S.slice(0,-6):S;try{r[$]=this.register($,f)}catch(P){o&&P instanceof Error&&(o.capture(P,{extra:{module:$,path:l}}),o.warn(P,`Skipping ${l}`))}}return r}},z(A,"_Module2"),A);d.buildAddonProxy=b;let C=d;const u=C;function b(x,a,o,r,l,m){const f={get(c,S,$){let P=r[S];if(P!==void 0)return typeof P=="function"?P.bind(c):P;const E=l&&l[S];return x?.log&&E&&x.log.warn(`[DEV-CHECK] Accessed ${o}.${S} directly. ${typeof E=="string"?E:""}`),P=c[S],typeof P=="function"?P.bind(c):x&&P instanceof C?x.resolve(P):Reflect.get(c,S,$)}};return m?f:new Proxy(a,f)}z(b,"buildAddonProxy");const p=class p extends Error{};z(p,"ModuleError");let w=p;const v=class v extends w{constructor(a,o){super(`${a} (${o.map(r=>r.path).join(" => ")})`),this.modules=o}};z(v,"CyclicDependencyError");let _=v},46949:(V,W,g)=>{"use strict";g.r(W),g.d(W,{Mutex:()=>a,SourcedSet:()=>le,TicketLock:()=>x,TimeoutError:()=>p,TranslatableError:()=>d,addWordSeparators:()=>J,array_equals:()=>l,b64ToArrayBuffer:()=>ue,debounce:()=>o,deep_copy:()=>D,deep_equals:()=>m,escape_regex:()=>se,fetchJSON:()=>we,generateHex:()=>ye,generateUUID:()=>L,get:()=>P,getTwitchEmoteSrcSet:()=>T,getTwitchEmoteURL:()=>U,glob_to_regex:()=>ce,has:()=>b,importRsaKey:()=>_e,isValidShortcut:()=>F,makeAddonIdChecker:()=>Z,make_enum:()=>_,make_enum_flags:()=>A,map_equals:()=>c,matchScreen:()=>u,maybe_call:()=>G,normalizeAddonIdForComparison:()=>M,once:()=>r,pick_random:()=>X,set_equals:()=>S,sha256:()=>C,shallow_copy:()=>E,shallow_object_equals:()=>f,sleep:()=>w,split_chars:()=>Q,substr_count:()=>$,timeout:()=>v,truncate:()=>fe});var k=g(24431);const O=Object.prototype.hasOwnProperty;function U(N,j,H=!1,q=!0){return`${k.TWITCH_EMOTE_V2}/${N}/${H?"default":"static"}/${q?"dark":"light"}/${j==4?3:j}.0`}z(U,"getTwitchEmoteURL");function T(N,j=!1,H=!0,q=!1){return q?`${U(N,2,j,H)} 1x, ${U(N,4,j,H)} 2x`:`${U(N,1,j,H)} 1x, ${U(N,2,j,H)} 2x, ${U(N,4,j,H)} 4x`}z(T,"getTwitchEmoteSrcSet");function F(N){return N?(N=N.toLowerCase().trim(),!k.BAD_HOTKEYS.includes(N)):!1}z(F,"isValidShortcut");const L=crypto.randomUUID?()=>crypto.randomUUID():z(function N(j){return j?(j^Math.random()*16>>j/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,N)},"generateUUID2"),ge=class ge extends Error{constructor(j,H,q){super(j),this.i18n_key=H,this.data=q}toString(){const j=window.FrankerFaceZ?.get(),H=j?.resolve("i18n");return H&&this.i18n_key?H.t(this.i18n_key,this.message,this.data):this.message}};z(ge,"TranslatableError");let d=ge;async function C(N){const j=new TextEncoder().encode(N),H=await crypto.subtle.digest("SHA-256",j);return Array.from(new Uint8Array(H)).map(ie=>ie.toString(16).padStart(2,"0")).join("")}z(C,"sha256");function u(N,j){let H,q=0;for(let ee=0;ee<N.length;ee++){const ie=N[ee];if(ie.label!==j.label)continue;let re=1;j.left&&j.left===ie.left&&(re+=15),j.top&&j.top===ie.top&&(re+=15),j.width&&j.width===ie.width&&(re+=10),j.height&&j.height===ie.height&&(re+=10),j.index&&(re-=Math.abs(j.index-ee)),re>q&&(H=ie,q=re)}return H}z(u,"matchScreen");function b(N,j){return N?O.call(N,j):!1}z(b,"has");function w(N){return new Promise(j=>setTimeout(j,N))}z(w,"sleep");function _(...N){const j={};for(let H=0,q=N.length;H<q;H++){const ee=N[H];j[ee]=H,j[H]=ee}return j}z(_,"make_enum");function A(...N){const j={};j.None=0,j[0]="None";for(let H=0,q=N.length;H<q;H++){const ee=N[H],ie=Math.pow(2,H);j[ee]=ie,j[ie]=ee}return j}z(A,"make_enum_flags");const Se=class Se extends Error{constructor(j){super(j??"timeout")}};z(Se,"TimeoutError");let p=Se;function v(N,j){return new Promise((H,q)=>{let ee=!1;const ie=setTimeout(()=>{ee||(ee=!0,q(new p))},j);N.then(re=>{ee||(ee=!0,clearTimeout(ie),H(re))}).catch(re=>{ee||(ee=!0,clearTimeout(ie),q(re))})})}z(v,"timeout");const Oe=class Oe{constructor(j=1){this.limit=j,this.__active=0,this.__waiting=[]}get available(){return this.__active<this.limit}__done(){for(this.__active--;this.__active<this.limit&&this.__waiting.length>0;){this.__active++;const j=this.__waiting.shift();j&&j(this.__getTicket())}}__getTicket(){let j=!0;return()=>{j&&(j=!1,this.__done())}}wait(){return this.__active<this.limit?(this.__active++,Promise.resolve(this.__getTicket())):new Promise(j=>this.__waiting.push(j))}};z(Oe,"TicketLock");let x=Oe;const a=x;function o(N,j,H=!1){let q;if(H){const ee=z(()=>q=null,"later");return H===2?z(function(...re){q?(clearTimeout(q),q=setTimeout(()=>{q=null,N.apply(this,re)},j)):(N.apply(this,re),q=setTimeout(ee,j))},"debouncedFunction"):function(...ie){q?clearTimeout(q):N.apply(this,ie),q=setTimeout(ee,j)}}return function(...ee){q&&clearTimeout(q),q=setTimeout(N.bind(this,...ee),j)}}z(o,"debounce");function r(N){let j;return z(function(...q){if(j)return j;try{j=Promise.resolve(N.call(this,...q))}catch(ee){return Promise.reject(ee)}return j.finally(()=>j=void 0)},"onceFunction")}z(r,"once");function l(N,j){if(!Array.isArray(N)||!Array.isArray(j)||N.length!==j.length)return!1;let H=N.length;for(;H--;)if(N[H]!==j[H])return!1;return!0}z(l,"array_equals");function m(N,j,H=!1,q,ee){if(N===j)return!0;if(typeof N!=typeof j||typeof N!="object"||N===null!=(j===null))return!1;if(q||(q=new Set),ee||(ee=new Set),q.has(N)||ee.has(j))throw new Error("recursive structure detected");q.add(N),ee.add(j);const ie=Object.keys(N),re=Object.keys(j);if(!H&&!S(new Set(ie),new Set(re)))return!1;for(const me of ie)if(!m(N[me],j[me],H,new Set(q),new Set(ee)))return!1;if(H){for(const me of re)if(!ie.includes(me)&&!m(N[me],j[me],H,new Set(q),new Set(ee)))return!1}return!0}z(m,"deep_equals");function f(N,j){if(typeof N!="object"||typeof j!="object")return!1;const H=Object.keys(N);if(!S(new Set(H),new Set(Object.keys(j))))return!1;for(const q of H)if(N[q]!==j[q])return!1;return!0}z(f,"shallow_object_equals");function c(N,j){if(!(N instanceof Map)||!(j instanceof Map)||N.size!==j.size)return!1;for(const[H,q]of N)if(!j.has(H)||j.get(H)!==q)return!1;return!0}z(c,"map_equals");function S(N,j){if(!(N instanceof Set)||!(j instanceof Set)||N.size!==j.size)return!1;for(const H of N)if(!j.has(H))return!1;return!0}z(S,"set_equals");function $(N,j){let H=0,q=0;for(;q<N.length;){const ee=N.indexOf(j,q);if(ee===-1)break;H++,q=ee+1}return H}z($,"substr_count");function P(N,j){let H=N;if(typeof H=="string"){if(O.call(j,H))return j[H];H=H.split(".")}for(let q=0,ee=H.length;q<ee;q++){const ie=H[q];if(ie==="@each"){const re=H.slice(q+1);if(re.length)if(Array.isArray(j))j=j.map(me=>P(re,me));else{const me={};for(const Pe in j)O.call(j,Pe)&&(me[Pe]=P(re,j[Pe]));j=me}break}else ie==="@last"?j=j[j.length-1]:j=j[ie];if(!j)break}return j}z(P,"get2");function E(N,j=2,H){if(N==null)return N;if(N instanceof Promise||typeof N=="function")return null;if(typeof N!="object")return N;if(j===0)return null;if(H||(H=new Set),H.add(N),Array.isArray(N)){const ee=[];for(const ie of N)H.has(ie)||ee.push(E(ie,j-1,new Set(H)));return ee}const q={};for(const[ee,ie]of Object.entries(N))H.has(ie)||(q[ee]=E(ie,j-1,new Set(H)));return q}z(E,"shallow_copy");function D(N,j){if(N===null)return null;if(N===void 0)return;if(N instanceof Promise)return new Promise((q,ee)=>N.then(q).catch(ee));if(typeof N=="function")return function(...q){return N.apply(this,q)};if(N instanceof RegExp)return new RegExp(N.source,N.flags);if(N instanceof Date)return new Date(N);if(typeof N!="object")return N;if(j||(j=new Set),j.has(N))throw new Error("recursive structure detected");if(j.add(N),Array.isArray(N))return N.map(q=>D(q,new Set(j)));if(N instanceof Set){const q=new Set;for(const ee of N)typeof ee=="object"?q.add(D(ee)):q.add(ee);return q}if(N instanceof Map){const q=new Map;for(const[ee,ie]of N.entries()){let re=typeof ee=="object"?D(ee):ee,me=typeof ie=="object"?D(ie):ie;q.set(re,me)}return q}const H={};for(const[q,ee]of Object.entries(N))typeof ee=="object"?H[q]=D(ee,new Set(j)):H[q]=ee;return H}z(D,"deep_copy");function M(N){return N.toLowerCase().replace(/[\.\_\-]+/,"-")}z(M,"normalizeAddonIdForComparison");function Z(N){return N=se(M(N)),N=N.replace(/-+/g,"[._-]+"),N=N.replace(/\bbttv\b/g,"(?:bttv|betterttv)"),N=N.replace(/\b7tv\b/g,"(?:7tv|seventv)"),N=N.replace(/\bpronouns\b/g,"(?:pronouns|addon-pn)"),new RegExp("\\b"+N+"\\b","i")}z(Z,"makeAddonIdChecker");function G(N,j,...H){return typeof N=="function"?j?N.call(j,...H):N(...H):N}z(G,"maybe_call");const Y=/[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDFFF]/g;function Q(N){return N===""?[]:N.match(Y)}z(Q,"split_chars");function X(N){if(!N)return null;if(!Array.isArray(N)){const j=Object.keys(N);return N[X(j)]}return N[Math.floor(Math.random()*N.length)]}z(X,"pick_random");const se=RegExp.escape||z(function(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},"escape_regex2");function J(N){return`(^|.*?${k.WORD_SEPARATORS})(?:${N})(?=$|${k.WORD_SEPARATORS})`}z(J,"addWordSeparators");const de="/$^+.()=!|";function ce(N){if(typeof N!="string")throw new TypeError("input must be a string");let j="",H=0;for(let q=0,ee=N.length;q<ee;q++){const ie=N[q];if(de.includes(ie))j+=`\\${ie}`;else if(ie==="\\"){q++;const re=N[q];re&&(de.includes(re)?j+=`\\${re}`:j+=re)}else if(ie==="?")j+=".";else if(ie==="[")j+=ie,N[q+1]==="!"&&(q++,j+="^");else if(ie==="]")j+=ie;else if(ie==="{")j+="(?:",H++;else if(ie==="}")H>0&&(j+=")",H--);else if(ie===","&&H>0)j+="|";else if(ie==="*"){let re=1;for(;N[q+1]==="*";)re++,q++;re>1?j+=".*?":j+="[^\\s]*?"}else j+=ie}return j}z(ce,"glob_to_regex");function fe(N,j=100,H=15,q="\u2026",ee=!0,ie=!0){if(!N||!N.length)return N;ie&&(N=N.trim());let re=ee?N.indexOf(`
`):-1;if((re===-1||re>j)&&(re=j),N.length<=re)return N;let me=N.slice(0,re).trimEnd();if(H>0&&me.length>=re){let Pe=N.slice(re).search(/\s+/);if(Pe===-1&&H+re>N.length&&(Pe=N.length-re),Pe!==-1&&Pe<=H){if(N.length<=re+Pe)return N;me=N.slice(0,re+Pe)}}return me+q}z(fe,"truncate");function he(N){return N.toString(16).padStart(2,"0")}z(he,"decimalToHex");function ye(N=40){const j=new Uint8Array(N/2);return window.crypto.getRandomValues(j),Array.from(j,he).join("")}z(ye,"generateHex");const Ce=class Ce{constructor(j=!1,H){this._use_set=j,this._cache=j?new Set:[],this._sourceSortFn=H}resortSources(){this._sorted_sources=null,this._sources&&this._sources.size>1&&this._rebuild()}setSortFunction(j){this._sourceSortFn!==j&&(this._sourceSortFn=j,this.resortSources())}_sortSources(){if(!this._sources||this._sources.size===0){this._sorted_sources=[];return}if(this._sources.size===1||!this._sourceSortFn){this._sorted_sources=[...this._sources.values()];return}const j=[...this._sources?.entries()];j.sort((H,q)=>this._sourceSortFn(H[0],q[0])),this._sorted_sources=j.map(H=>H[1])}_rebuild(){if(!this._sources)return;const j=this._use_set,H=this._cache=j?new Set:[];this._sorted_sources||this._sortSources();for(const q of this._sorted_sources)for(const ee of q)j?H.add(ee):H.includes(ee)||H.push(ee)}get(j){return this._sources&&this._sources.get(j)}has(j){return this._sources?this._sources.has(j):!1}*iterateSources(){if(this._sources)for(const j of this._sources)yield j}sourceIncludes(j,H){const q=this._sources&&this._sources.get(j);return q&&q.includes(H)}includes(j){return this._use_set?this._cache.has(j):this._cache.includes(j)}delete(j){this._sources&&this._sources.has(j)&&(this._sources.delete(j),this._sorted_sources=null,this._rebuild())}extend(j,...H){this._sources||(this._sources=new Map);const q=this._sources.get(j);if(q)for(const ie of H)q.includes(ie)||q.push(ie);else this._sources.set(j,H),this._sorted_sources=null;if(this._sourceSortFn!=null&&this._sources.size>1)this._rebuild();else{const ie=this._use_set,re=this._cache;for(const me of H)ie?re.add(me):re.includes(me)||re.push(me)}}set(j,H){if(Array.isArray(H)||(H=[H]),!H.length)return this.delete(j);this._sources||(this._sources=new Map);const q=this._sources.has(j);this._sources.set(j,H),this._sorted_sources=null;const ee=this._sourceSortFn!=null&&this._sources.size>1;if(q||ee)this._rebuild();else{const ie=this._use_set,re=this._cache;for(const me of H)ie?re.add(me):re.includes(me)||re.push(me)}}push(j,H){if(!this._sources)return this.set(j,H);const q=this._sources.get(j);if(q?.length){if(q.includes(H))return}else return this.set(j,H);q.push(H),this._sourceSortFn!=null&&this._sources.size>1?this._rebuild():this._use_set?this._cache.add(H):this._cache.includes(H)||this._cache.push(H)}remove(j,H){if(!this._sources||!this._sources.has(j))return;const q=this._sources.get(j),ee=q?q.indexOf(H):-1;ee!==-1&&(q.splice(ee,1),this._rebuild())}};z(Ce,"SourcedSet");let le=Ce;function ue(N){const j=atob(N),H=j.length,q=new ArrayBuffer(H),ee=new Uint8Array(q);for(let ie=0,re=j.length;ie<re;ie++)ee[ie]=j.charCodeAt(ie);return q}z(ue,"b64ToArrayBuffer");const ve=/-----BEGIN (.+?) KEY-----/,be=/-----END (.+?) KEY-----/;function _e(N,j=["verify"]){const H=ve.exec(N),q=be.exec(N);if(!H||!q||H[1]!==q[1])throw new Error("invalid key");const ee=/\bPRIVATE\b/i.test(H[1]),ie=H.index+H[0].length,re=q.index,me=N.slice(ie,re).replace(/\n/g,"").trim(),Pe=ue(me);return crypto.subtle.importKey(ee?"pkcs8":"spki",Pe,{name:"RSA-PSS",hash:"SHA-256"},!0,j)}z(_e,"importRsaKey");function we(N,j,H=null){return fetch(N,j).then(q=>q.ok?q.json():null).catch(()=>H)}z(we,"fetchJSON")},20857:(V,W,g)=>{"use strict";g.d(W,{Q:()=>k});function k(T){return O({path:T,i:0})}z(k,"parse");function O(T){const F=T.path,L=F.length,d=[];let C=null,u=null,b=!1,w=!1;for(;T.i<L;){const _=T.i,A=F[_],p=F[_+1];if(C||(C={}),u||(u=""),A==="@"&&p==="{"){T.i++;const o=U(T);o&&Object.assign(C,o);continue}const v=A==="~"&&p===">",x=A===">"&&p===">";if(!(!x&&A===">")&&!x&&!v){u+=A,T.i++;continue}(v||x)&&T.i++,C.title=u.trim(),C.key=C.title.toSnakeCase(),C.page=w,C.tab=b,w=x,b=v,d.push(C),C=u=null,T.i++}return C&&u&&(C.title=u.trim(),C.key=C.title.toSnakeCase(),C.page=w,C.tab=b,d.push(C)),d}z(O,"parseAST");function U(T){const F=T.path,L=F.length,d=T.i;T.i++;const C=["{"];let u=!1;for(;T.i<L&&C.length;){const b=T.i,w=F[b];if(u){if(w==="\\"){T.i++;continue}(w==='"'||w==="'")&&w===u&&(C.pop(),u=!1)}else{if((w==='"'||w==="'")&&(u=w,C.push(w)),(w==="{"||w==="[")&&C.push(w),w==="]"&&C.pop()!=="[")throw new SyntaxError("Invalid JSON");if(w==="}"&&C.pop()!=="{")throw new SyntaxError("Invalid JSON")}T.i++}return JSON.parse(F.slice(d,T.i))}z(U,"parseJSON")},83269:(V,W,g)=>{"use strict";g.r(W),g.d(W,{durationForChat:()=>T,durationForURL:()=>F,duration_to_string:()=>O,getBuster:()=>k,print_duration:()=>U});function k(L=5){const d=Math.floor(Date.now()/1e3);return d-d%L}z(k,"getBuster");function O(L,d,C,u,b){const w=L%60;let _=Math.floor(L/60),A=Math.floor(_/60),p="";if(_=_%60,d){const x=Math.floor(A/24);if(A=A%24,C&&x>0)return`${p} days`;p=x>0?`${x} days, `:""}const v=u===!1||p?.length>0||A>0;return`${p}${v?`${p&&A<10?"0":""}${A}:`:""}${v&&_<10?"0":""}${_}${b?"":`:${w<10?"0":""}${w}`}`}z(O,"duration_to_string");function U(L){let d=Math.floor(L/60);const C=Math.floor(d/60);return d%=60,L%=60,`${C>0?`${C}:${d<10?"0":""}`:""}${d}:${L<10?"0":""}${L}`}z(U,"print_duration");function T(L){const d=L%60;let C=Math.floor(L/60),u=Math.floor(C/60);const b=Math.floor(u/24);return C=C%60,u=u%24,`${b>0?`${b}d`:""}${u>0?`${u}h`:""}${C>0?`${C}m`:""}${d>0?`${d}s`:""}`}z(T,"durationForChat");function F(L){const d=L%60;let C=Math.floor(L/60);const u=Math.floor(C/60);return C=C%60,`${u>0?`${u}h`:""}${C>0?`${C}m`:""}${d>0?`${d}s`:""}`}z(F,"durationForURL")},8528:(V,W,g)=>{"use strict";g.r(W),g.d(W,{DefaultOptions:()=>L,NoContent:()=>F,Tooltip:()=>d,default:()=>C,makeReference:()=>b,normalizeModifiers:()=>u});var k=g(44589),O=g(46949),U=g(78224);let T=0;const F=Symbol("NoContent"),L={html:!1,delayShow:0,delayHide:0,live:!0,tooltipClass:"ffz__tooltip",innerClass:"ffz__tooltip--inner",arrowClass:"ffz__tooltip--arrow"},_=class _{constructor(p,v,x){if(this.shift_state=!1,this.ctrl_state=!1,typeof p=="string"&&(p=document.querySelector(p)),!(p instanceof HTMLElement))throw new TypeError("invalid parent");if(this.options=Object.assign({},L,x),this.live=this.options.live,this.parent=p,this.container=this.options.container||this.parent,this.cls=v,this.options.check_modifiers&&this.installModifiers(),this.live)this.cls=v,this.elements=new Set;else{let a;if(typeof v=="string")a=Array.from(p.querySelectorAll(v));else if(Array.isArray(v))a=v;else if(v instanceof HTMLElement)a=[v];else throw new TypeError("invalid elements");this.elements=new Set(a)}if(this._accessor=`_ffz_tooltip$${T++}`,this._onMouseOut=a=>{const o=a.target;if(o&&o.dataset?.forceOpen!=="true")return this._exit(o)},!this.options.manual)if(this.live)this._onMouseOver=a=>{this.updateShift(a.shiftKey,a.ctrlKey);const o=a.target;o&&o.classList&&o.classList.contains(this.cls)&&o.dataset?.forceOpen!=="true"&&this._enter(o)},p.addEventListener("mouseover",this._onMouseOver),p.addEventListener("mouseout",this._onMouseOut);else if(this._onMouseOver=a=>{this.updateShift(a.shiftKey,a.ctrlKey);const o=a.target;this.elements.has(o)&&o.dataset.forceOpen!=="true"&&this._enter(o)},this.elements.size<=5)for(const a of this.elements)a.addEventListener("mouseenter",this._onMouseOver),a.addEventListener("mouseleave",this._onMouseOut);else p.addEventListener("mouseover",this._onMouseOver),p.addEventListener("mouseout",this._onMouseOut)}destroy(){if(this.removeModifiers(),!this.options.manual)if(this.live||this.elements.size>5)this._onMouseOver&&this.parent.removeEventListener("mouseover",this._onMouseOver),this.parent.removeEventListener("mouseout",this._onMouseOut);else for(const p of this.elements)this._onMouseOver&&p.removeEventListener("mouseenter",this._onMouseOver),p.removeEventListener("mouseleave",this._onMouseOut);for(const p of this.elements){const v=p[this._accessor];v&&v.visible&&this.hide(v),p[this._accessor]=null,p._ffz_tooltip=null}this.elements=null,this._onMouseOut=this._onMouseOver=null,this.container=null,this.parent=null}installModifiers(){this._keyUpdate||(this._keyUpdate=p=>this.updateShift(p.shiftKey,p.ctrlKey),window.addEventListener("keydown",this._keyUpdate),window.addEventListener("keyup",this._keyUpdate))}removeModifiers(){this._keyUpdate&&(window.removeEventListener("keydown",this._keyUpdate),window.removeEventListener("keyup",this._keyUpdate),this._keyUpdate=null)}updateShift(p,v){p===this.shift_state&&v===this.ctrl_state||(this.shift_state=p,this.ctrl_state=v,this._shift_af||(this._shift_af=requestAnimationFrame(()=>{if(this._shift_af=null,this.elements)for(const x of this.elements){const a=x[this._accessor];a&&a.outer&&(a.outer.dataset.shift=`${this.shift_state}`,a.outer.dataset.ctrl=`${this.ctrl_state}`,a.update())}})))}cleanup(){if(!(this.options.manual||!this.elements))for(const p of this.elements){const v=p[this._accessor];document.body.contains(p)||v&&v.visible&&this.hide(v)}}_enter(p){let v=p[this._accessor];if(v||(v=p[this._accessor]={target:p}),v.state=!0,v._show_timer&&(clearTimeout(v._show_timer),v._show_timer=null),v.visible)return;const x=(0,O.maybe_call)(this.options.delayShow,null,p,v);x===0?this.show(v):v._show_timer=setTimeout(()=>{v._show_timer=null,v.state&&this.show(v)},x)}_exit(p){const v=p[this._accessor];if(!v||(v.state=!1,v._show_timer&&(clearTimeout(v._show_timer),v._show_timer=null),!v.visible))return;const x=(0,O.maybe_call)(this.options.delayHide,null,p,v);x===0?this.hide(v):v._show_timer=setTimeout(()=>{v._show_timer=null,v.state||this.hide(v)},x)}show(p){const v=this.options,x=p.target;this.elements.add(x),x._ffz_tooltip=p,p._wait_promise=null,p.waitForDom=()=>p.element?Promise.resolve():(p._wait_promise||(p._wait_promise=new Promise(D=>p._waiter=D)),p._wait_promise),p.update=()=>p._update(),p.show=()=>{let D=x[this._accessor];D||(D=x[this._accessor]={target:x}),this.show(D)},p.hide=()=>this.hide(p),p.rerender=()=>{p.visible&&(p.hide(),p.show())};let a=(0,O.maybe_call)(v.content,null,x,p);if(a===void 0&&(a=p.target.title),p.visible||a===F||!a&&!v.onShow)return;const o=(0,k.createElement)("div",{className:v.arrowClass,"x-arrow":!0}),r=p.element=(0,k.createElement)("div",v.innerClass),l=p.outer=(0,k.createElement)("div",{className:v.tooltipClass,"data-shift":this.shift_state,"data-ctrl":this.ctrl_state},[r,o]);if(v.arrowInner&&o.appendChild((0,k.createElement)("div",v.arrowInner)),p.align&&r.classList.add(`${v.innerClass}--align-${p.align}`),p.add_class){for(const D of Array.isArray(p.add_class)?p.add_class:[p.add_class])r.classList.add(D);p.add_class=void 0}const m=(0,O.maybe_call)(v.interactive,null,x,p),f=(0,O.maybe_call)(v.hover_events,null,x,p);l.classList.toggle("interactive",m||!1),(!v.manual||f&&(v.onHover||v.onLeave||v.onMove))&&(f&&v.onMove&&l.addEventListener("mousemove",l._ffz_move_handler=D=>{this.updateShift(D.shiftKey,D.ctrlKey),v.onMove(x,p,D)}),l.addEventListener("mouseover",l._ffz_over_handler=D=>{!v.no_auto_remove&&!document.contains(x)&&this.hide(p),f&&v.onHover&&v.onHover(x,p,D),v.manual||((0,O.maybe_call)(v.interactive,null,x,p)?this._enter(x):x.dataset.forceOpen!=="true"&&this._exit(x))}),l.addEventListener("mouseout",l._ffz_out_handler=D=>{f&&v.onLeave&&v.onLeave(x,p,D),!v.manual&&x.dataset.forceOpen!=="true"&&this._exit(x)}));const c=(0,O.maybe_call)(v.html,null,x,p),S=c?"innerHTML":"textContent",$={flip:{behavior:["top","bottom","left","right"]},offset:{offset:[0,10]},arrow:{element:o}};let P=Object.assign({modifiers:$},v.popper);P.modifiers=Object.assign($,P.modifiers),v.popperConfig&&(P=v.popperConfig(x,p,P)??P),P.onUpdate=(0,O.debounce)(()=>{!v.no_auto_remove&&!document.contains(p.target)&&this.hide(p)},250);let E=x;v.no_update&&(E=b(x)),p._update=()=>{p.popper&&p.popper.forceUpdate()},p._waiter&&p._waiter(),p._waiter=null,p._wait_promise=null,a instanceof Promise?(r.innerHTML='<div class="ffz-i-zreknarf loader"></div>',a.then(D=>{if(!D)return this.hide(p);c&&(D instanceof Node||Array.isArray(D))?(r.innerHTML="",(0,k.setChildren)(r,D,v.sanitizeChildren)):r[S]=D,p._update()}).catch(D=>{this.options.logger&&this.options.logger.error("Error rendering tooltip content.",D),this.options.i18n?r.textContent=this.options.i18n.t("tooltip.render-error",`There was an error rendering this tooltip.
{err}`,{err:D}):r.textContent=`There was an error rendering this tooltip.
${D}`,p._update()})):a&&(c&&(a instanceof Node||Array.isArray(a))?(0,k.setChildren)(r,a,v.sanitizeChildren):r[S]=a),P.modifiers=u(P.modifiers),p.popper=(0,U.fi)(E,l,P),this.container.appendChild(l),p.visible=!0,v.onShow&&v.onShow(x,p)}hide(p){const v=this.options;if(v.onHide&&v.onHide(p.target,p),p.popper&&(p.popper.destroy(),p.popper=null),p.outer){const x=p.outer;x._ffz_over_handler&&x.removeEventListener("mouseover",x._ffz_over_handler),x._ffz_out_handler&&x.removeEventListener("mouseout",x._ffz_out_handler),x._ffz_move_handler&&x.removeEventListener("mousemove",x._ffz_move_handler),x.remove(),p.outer=x._ffz_out_handler=x._ffz_over_handler=null}this.live&&this.elements&&this.elements.delete(p.target),p.target._ffz_tooltip===p&&(p.target._ffz_tooltip=null),p.target[this._accessor]=null,p._update=p.rerender=p.update=w,p.element=null,p.visible=!1}};z(_,"Tooltip");let d=_;const C=d;function u(A){const p=[];for(const[v,x]of Object.entries(A)){const a={name:v};if(x&&typeof x=="object"&&!Array.isArray(x)){(0,O.has)(x,"enabled")&&(a.enabled=x.enabled);const o=Object.keys(x);(o.length>1||o.length===1&&o[0]!=="enabled")&&(a.options=x)}p.push(a)}return p}z(u,"normalizeModifiers");function b(A,p,v=0,x=0){let a;if(A instanceof HTMLElement){const r=A.getBoundingClientRect();a=r.x,p=r.y,v=r.height,x=r.width}else a=A;return{getBoundingClientRect:()=>({top:p,bottom:p+v,y:p,left:a,right:a+x,x:A,height:v,width:x}),clientWidth:x,clientHeight:v}}z(b,"makeReference");function w(){}z(w,"noop")},2356:(V,W,g)=>{"use strict";g.r(W),g.d(W,{DEFAULT_FORMATS:()=>w,DEFAULT_TYPES:()=>b,TranslationCore:()=>_,default:()=>A,getCardinalName:()=>a,getOrdinalName:()=>l});var k=g(51722),O=g.n(k),U=g(92045),T=g.n(U),F=g(46949),L=g(83269),d=g(22923),C=g.n(d);O().extend(T());const u={allowTags:!1,requireOther:!1},b={tostring(f){return`${f}`},select(f,c,S,$,P,E){const D=c.o&&(c.o[f]||c.o.other);if(D)return this._processAST(D,E,S)},plural(f,c,S,$,P,E){const D=c.o&&(c.o[`=${f}`]||c.o[a(S,f)]||c.o.other);if(D)return this._processAST(D,E,S)},selectordinal(f,c,S,$,P,E){const D=c.o&&(c.o[`=${f}`]||c.o[l(S,f)]||c.o.other);if(D)return this._processAST(D,E,S)},number(f,c){if(typeof f!="number"){let S=parseFloat(f);if((isNaN(S)||!isFinite(S))&&(S=parseInt(f,10)),isNaN(S)||!isFinite(S))return f;f=S}return this.formatNumber(f,c.f)},currency(f,c){if(typeof f!="number"){let S=parseFloat(f);if((isNaN(S)||!isFinite(S))&&(S=parseInt(f,10)),isNaN(S)||!isFinite(S))return f;f=S}return this.formatCurrency(f,c.f)},date(f,c){return this.formatDate(f,c.f)},time(f,c){return this.formatTime(f,c.f)},datetime(f,c){return this.formatDateTime(f,c.f)},duration(f){return this.formatDuration(f)},localestring(f){return this.toLocaleString(f)},relativetime(f,c){return this.formatRelativeTime(f,c.f)},humantime(f,c){return this.formatRelativeTime(f,c.f)},en_plural:f=>f!==1?"s":""},w={number:{currency:{style:"currency"},percent:{style:"percent"},long_percent:{style:"percent",minimumFractionDigits:2}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},default:{},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}},datetime:{short:{month:"numeric",day:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"},medium:{},long:{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},m=class m{constructor(c){if(c=c||{},this.warn=c.warn,this._locale=c.locale||"en",this._dayjs_locale=c.dayjsLocale||"en",this.defaultLocale=c.defaultLocale||this._locale,this.transformation=null,this.defaultDateFormat=c.defaultDateFormat??"default",this.defaultTimeFormat=c.defaultTimeFormat??"short",this.defaultDateTimeFormat=c.defaultDateTimeFormat??"medium",this.phrases=new Map,this.cache=new Map,this.numberFormats=new Map,this.currencyFormats=new Map,this.formats=Object.assign({},w),c.formats){const S=Object.keys(c.formats);for(const $ of S)this.formats[$]=Object.assign({},this.formats[$],c.formats[$])}this.types=Object.assign({},b,c.types||{}),this.parser=new(C())(Object.assign({},u,c.parserOptions)),c.phrases&&this.extend(c.phrases)}get locale(){return this._locale}set locale(c){c!==this._locale&&(this._locale=c,this.numberFormats.clear(),this.currencyFormats.clear())}toLocaleString(c){return c?.toLocaleString?c.toLocaleString(this._locale):typeof c!="string"?`${c}`:c}formatRelativeTime(c,S){const $=O()(c),P=S==="plain";try{return $.locale(this._dayjs_locale).fromNow(P)}catch{return $.fromNow(P)}}formatCurrency(c,S){let $=this.currencyFormats.get(S);return $||($=new Intl.NumberFormat(navigator.languages,{style:"currency",currency:S}),this.currencyFormats.set(S,$)),$.format(c)}formatNumber(c,S){let $=this.numberFormats.get(S);return $||(this.formats.number[S]?$=new Intl.NumberFormat(this.locale,this.formats.number[S]):typeof S=="number"?$=new Intl.NumberFormat(this.locale,{minimumFractionDigits:S,maximumFractionDigits:S}):$=new Intl.NumberFormat(this.locale),this.numberFormats.set(S,$)),$.format(c)}formatDuration(c){return(0,L.duration_to_string)(c)}formatDate(c,S){if(S||(S=this.defaultDateFormat),S&&!this.formats.date[S]){const $=O()(c);try{return $.locale(this._dayjs_locale).format(S)}catch{return $.format(S)}}return c instanceof Date||(c=new Date(c)),c.toLocaleDateString(this._locale,this.formats.date[S]||{})}formatTime(c,S){if(S||(S=this.defaultTimeFormat),S&&!this.formats.time[S]){const $=O()(c);try{return $.locale(this._dayjs_locale).format(S)}catch{return $.format(S)}}return c instanceof Date||(c=new Date(c)),c.toLocaleTimeString(this._locale,this.formats.time[S]||{})}formatDateTime(c,S){if(S||(S=this.defaultDateTimeFormat),S&&!this.formats.datetime[S]){const $=O()(c);try{return $.locale(this._dayjs_locale).format(S)}catch{return $.format(S)}}return c instanceof Date||(c=new Date(c)),c.toLocaleString(this._locale,this.formats.datetime[S]||{})}extend(c,S){const $=[];if(!c||typeof c!="object")return $;for(const P of Object.keys(c)){const E=S?P==="_"?S:`${S}.${P}`:P,D=c[P];if(typeof D=="object")$.push(...this.extend(D,E));else{let M;try{M=this.parser.parse(D)}catch(Z){this.warn&&this.warn(`Error parsing i18n phrase for key "${E}": ${D}`,Z);continue}this.phrases.set(E,D),this.cache.set(E,M),$.push(E)}}return $}unset(c,S){typeof c=="string"&&(c=[c]);const $=Array.isArray(c)?c:Object.keys(c);for(const P of $){const E=S?P==="_"?S:`${S}.${P}`:P;typeof c[P]=="object"?this.unset(c,E):(this.phrases.delete(E),this.cache.delete(E))}}has(c){return this.phrases.has(c)}set(c,S){const $=this.parser.parse(S);this.phrases.set(c,S),this.cache.set(c,$)}clear(){this.phrases.clear(),this.cache.clear()}replace(c){this.clear(),this.extend(c)}_preTransform(c,S,$,P={}){let E,D,M=$??{};if(typeof M=="number"&&(M={count:M}),!P.noCache&&this.phrases.has(c))E=this.cache.get(c)??[],D=this.locale;else if(!P.noCache&&this.cache.has(c))E=this.cache.get(c)??[],D=this.defaultLocale;else{let Z=null;try{Z=this.parser.parse(S)}catch(G){if(P.throwParse)throw G;!P.noWarn&&this.warn&&this.warn(`Error parsing i18n phrase for key "${c}": ${S}`,G),E=["parsing error"],D=this.defaultLocale}Z?(E=Z,D=this.locale,P.noCache||(this.locale===this.defaultLocale&&this.phrases.set(c,S),this.cache.set(c,Z))):(E=[],D=this.defaultLocale)}return this.transformation&&(E=this.transformation(c,E)),[E,M,D]}t(c,S,$,P){return p(this.tList(c,S,$,P))}tList(c,S,$,P){return this._processAST(...this._preTransform(c,S,$,P))}formatNode(c,S,$,P,E){if(!c||typeof c!="object")return c;$==null&&($=this.locale);const D=(0,F.get)(c.v,S);if(D==null)return null;if(c.t){const M=this.types[c.t];if(M)return M.call(this,D,c,$,P,E,S);this.warn&&this.warn(`Encountered unknown type "${c.t}" when formatting node.`)}return D}_processAST(c,S,$){const P=[];for(const E of c){const D=this.formatNode(E,S,$,P,c);D!=null&&P.push(D)}return P}};z(m,"TranslationCore");let _=m;const A=_;function p(f){return Array.isArray(f)?f.map(p).join(""):`${f}`}z(p,"listToString");let v=null,x=null;function a(f,c){return(!v||f!==x)&&(v=new Intl.PluralRules(f,{type:"cardinal"}),x=f),v.select(c)}z(a,"getCardinalName");let o=null,r=null;function l(f,c){return(!o||f!==r)&&(o=new Intl.PluralRules(f,{type:"ordinal"}),r=f),o.select(c)}z(l,"getOrdinalName")},73637:(V,W,g)=>{var k={"./af.js":[20179,1081],"./am.js":[61783,5380],"./ar-dz.js":[98136,5215],"./ar-iq.js":[82690,789],"./ar-kw.js":[62009,5151],"./ar-ly.js":[49408,1722],"./ar-ma.js":[87330,909],"./ar-sa.js":[66575,5012],"./ar-tn.js":[5742,8757],"./ar.js":[46567,3030],"./az.js":[14319,8736],"./be.js":[41737,2244],"./bg.js":[86835,6757],"./bi.js":[50045,8111],"./bm.js":[65561,9082],"./bn.js":[57602,4667],"./bo.js":[92594,3134],"./br.js":[34467,3968],"./bs.js":[53169,9248],"./ca.js":[97569,4178],"./cs.js":[30625,5123],"./cv.js":[6326,4060],"./cy.js":[49268,3166],"./da.js":[11559,4103],"./de-at.js":[12369,5954],"./de-ch.js":[71107,7168],"./de.js":[24569,300],"./dv.js":[25427,5528],"./el.js":[90524,1784],"./en-au.js":[29061,4634],"./en-ca.js":[31304,2928],"./en-gb.js":[84252,627],"./en-ie.js":[48757,2730],"./en-il.js":[98038,9],"./en-in.js":[7282,6644],"./en-nz.js":[97960,485],"./en-sg.js":[435,3949],"./en-tt.js":[90954,5818],"./en.js":[22039,427],"./eo.js":[39399,3923],"./es-do.js":[47688,4026],"./es-mx.js":[81773,2972],"./es-pr.js":[66106,5624],"./es-us.js":[18541,187],"./es.js":[23607,172],"./et.js":[29776,9040],"./eu.js":[20166,6960],"./fa.js":[28288,6633],"./fi.js":[88189,5928],"./fo.js":[49697,9627],"./fr-ca.js":[15296,7007],"./fr-ch.js":[53415,7063],"./fr.js":[4938,3674],"./fy.js":[7811,8733],"./ga.js":[3368,6020],"./gd.js":[53560,3017],"./gl.js":[85222,4466],"./gom-latn.js":[38546,6099],"./gu.js":[78309,6993],"./he.js":[41436,9706],"./hi.js":[463,7409],"./hr.js":[27147,3793],"./ht.js":[95139,3104],"./hu.js":[18224,6994],"./hy-am.js":[25976,365],"./id.js":[74970,2698],"./is.js":[799,1087],"./it-ch.js":[6071,8302],"./it.js":[97727,8744],"./ja.js":[78117,9418],"./jv.js":[22281,3496],"./ka.js":[87931,3099],"./kk.js":[52334,1494],"./km.js":[35155,6169],"./kn.js":[72879,9701],"./ko.js":[62905,5929],"./ku.js":[34078,8555],"./ky.js":[24026,2819],"./lb.js":[62619,8124],"./lo.js":[29979,1462],"./lt.js":[75887,6903],"./lv.js":[35493,2437],"./me.js":[50532,4518],"./mi.js":[73059,3883],"./mk.js":[17450,3512],"./ml.js":[66422,8996],"./mn.js":[16428,8753],"./mr.js":[35778,3294],"./ms-my.js":[40583,2593],"./ms.js":[33650,6881],"./mt.js":[6045,4863],"./my.js":[74361,3741],"./nb.js":[10697,3148],"./ne.js":[16608,3868],"./nl-be.js":[11377,7953],"./nl.js":[6987,9724],"./nn.js":[8758,9663],"./oc-lnc.js":[68064,9495],"./pa-in.js":[16767,838],"./pl.js":[28012,8705],"./pt-br.js":[19978,3639],"./pt.js":[51357,7479],"./ro.js":[71948,3905],"./ru.js":[3381,8700],"./rw.js":[79914,3128],"./sd.js":[90126,7087],"./se.js":[46319,8723],"./si.js":[99008,9797],"./sk.js":[84600,6512],"./sl.js":[64955,3951],"./sq.js":[74716,3392],"./sr-cyrl.js":[55854,1532],"./sr.js":[23534,1907],"./ss.js":[19239,7003],"./sv-fi.js":[57972,9047],"./sv.js":[43032,8919],"./sw.js":[60125,4176],"./ta.js":[1565,9872],"./te.js":[92516,5825],"./tet.js":[26712,4984],"./tg.js":[39351,4653],"./th.js":[89225,5389],"./tk.js":[48485,2355],"./tl-ph.js":[17517,2343],"./tlh.js":[35984,3508],"./tr.js":[33092,2661],"./tzl.js":[69109,6199],"./tzm-latn.js":[13637,6782],"./tzm.js":[38063,1785],"./ug-cn.js":[98490,8256],"./uk.js":[65589,6190],"./ur.js":[85859,3199],"./uz-latn.js":[96588,3290],"./uz.js":[45589,9238],"./vi.js":[41191,357],"./x-pseudo.js":[59018,6858],"./yo.js":[14163,8898],"./zh-cn.js":[9073,5352],"./zh-hk.js":[74828,8638],"./zh-tw.js":[78141,4101],"./zh.js":[42882,5235]};function O(U){if(!g.o(k,U))return Promise.resolve().then(()=>{var L=new Error("Cannot find module '"+U+"'");throw L.code="MODULE_NOT_FOUND",L});var T=k[U],F=T[0];return g.e(T[1]).then(()=>g.t(F,23))}z(O,"webpackAsyncContext"),O.keys=()=>Object.keys(k),O.id=73637,V.exports=O},38621:(V,W,g)=>{var k={"./player-ext-mouse.scss":55743,"./player-fade-paused.scss":5843,"./player-hide-mouse.scss":95746,"./player-hide-native-clip.scss":67862,"./player-volume.scss":64978};function O(T){return U(T).then(g)}z(O,"webpackAsyncContext");function U(T){return g.e(6977).then(()=>{if(!g.o(k,T)){var F=new Error("Cannot find module '"+T+"'");throw F.code="MODULE_NOT_FOUND",F}return k[T]})}z(U,"webpackAsyncContextResolve"),O.keys=()=>Object.keys(k),O.resolve=U,O.id=38621,V.exports=O},77074:(V,W,g)=>{"use strict";V.exports=g.p+"experiments.json"},91054:()=>{}},Xe={};function I(V){var W=Xe[V];if(W!==void 0)return W.exports;var g=Xe[V]={exports:{}};return Ye[V].call(g.exports,g,g.exports,I),g.exports}z(I,"__webpack_require__"),I.m=Ye,I.n=V=>{var W=V&&V.__esModule?()=>V.default:()=>V;return I.d(W,{a:W}),W},(()=>{var V=Object.getPrototypeOf?g=>Object.getPrototypeOf(g):g=>g.__proto__,W;I.t=function(g,k){if(k&1&&(g=this(g)),k&8||typeof g=="object"&&g&&(k&4&&g.__esModule||k&16&&typeof g.then=="function"))return g;var O=Object.create(null);I.r(O);var U={};W=W||[null,V({}),V([]),V(V)];for(var T=k&2&&g;typeof T=="object"&&!~W.indexOf(T);T=V(T))Object.getOwnPropertyNames(T).forEach(F=>U[F]=()=>g[F]);return U.default=()=>g,I.d(O,U),O}})(),I.d=(V,W)=>{for(var g in W)I.o(W,g)&&!I.o(V,g)&&Object.defineProperty(V,g,{enumerable:!0,get:W[g]})},I.f={},I.e=V=>Promise.all(Object.keys(I.f).reduce((W,g)=>(I.f[g](V,W),W),[])),I.u=V=>""+({9:"i18n-33",172:"i18n-44",187:"i18n-43",204:"menu-md4",208:"rich_tokens",300:"i18n-26",357:"i18n-134",365:"i18n-64",427:"i18n-38",485:"i18n-35",627:"i18n-31",789:"i18n-3",838:"i18n-98",909:"i18n-6",935:"zip",1081:"i18n-0",1087:"i18n-66",1462:"i18n-79",1494:"i18n-72",1532:"i18n-111",1722:"i18n-5",1784:"i18n-28",1785:"i18n-128",1871:"translation-ui",1907:"i18n-112",2009:"markdown",2086:"main-menu",2244:"i18n-11",2343:"i18n-123",2348:"chat",2355:"i18n-122",2437:"i18n-81",2593:"i18n-88",2597:"site-css-tweaks",2661:"i18n-125",2682:"tdata",2698:"i18n-65",2730:"i18n-32",2819:"i18n-77",2928:"i18n-30",2972:"i18n-41",3017:"i18n-55",3030:"i18n-9",3099:"i18n-71",3104:"i18n-62",3128:"i18n-104",3134:"i18n-16",3148:"i18n-92",3166:"i18n-22",3199:"i18n-131",3224:"queries",3290:"i18n-132",3294:"i18n-87",3392:"i18n-110",3496:"i18n-70",3508:"i18n-124",3512:"i18n-84",3639:"i18n-100",3674:"i18n-52",3741:"i18n-91",3793:"i18n-61",3868:"i18n-93",3883:"i18n-83",3905:"i18n-102",3923:"i18n-39",3949:"i18n-36",3951:"i18n-109",3968:"i18n-17",4026:"i18n-40",4060:"i18n-21",4101:"i18n-139",4103:"i18n-23",4164:"menu-md1",4176:"i18n-116",4178:"i18n-19",4466:"i18n-56",4518:"i18n-82",4634:"i18n-29",4653:"i18n-120",4667:"i18n-15",4863:"i18n-90",4984:"i18n-119",5012:"i18n-7",5123:"i18n-20",5151:"i18n-4",5215:"i18n-2",5235:"i18n-140",5352:"i18n-137",5380:"i18n-1",5389:"i18n-121",5528:"i18n-27",5624:"i18n-42",5818:"i18n-37",5825:"i18n-118",5928:"i18n-48",5929:"i18n-75",5954:"i18n-24",6020:"i18n-54",6099:"i18n-57",6169:"i18n-73",6190:"i18n-130",6199:"i18n-126",6512:"i18n-108",6530:"regex",6633:"i18n-47",6644:"i18n-34",6757:"i18n-12",6782:"i18n-127",6858:"i18n-135",6881:"i18n-89",6903:"i18n-80",6960:"i18n-46",6993:"i18n-58",6994:"i18n-63",7003:"i18n-113",7007:"i18n-50",7063:"i18n-51",7087:"i18n-105",7168:"i18n-25",7409:"i18n-60",7479:"i18n-101",7629:"menu-md0",7953:"i18n-94",8111:"i18n-13",8124:"i18n-78",8163:"menu-md5",8256:"i18n-129",8302:"i18n-67",8555:"i18n-76",8638:"i18n-138",8700:"i18n-103",8705:"i18n-99",8723:"i18n-106",8733:"i18n-53",8736:"i18n-10",8744:"i18n-68",8753:"i18n-86",8757:"i18n-8",8898:"i18n-136",8919:"i18n-115",8996:"i18n-85",9040:"i18n-45",9047:"i18n-114",9082:"i18n-14",9238:"i18n-133",9248:"i18n-18",9418:"i18n-69",9495:"i18n-97",9627:"i18n-49",9663:"i18n-96",9701:"i18n-74",9706:"i18n-59",9724:"i18n-95",9797:"i18n-107",9872:"i18n-117"}[V]||V)+".js",I.h=()=>"965cd6a229543443152b",I.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),I.o=(V,W)=>Object.prototype.hasOwnProperty.call(V,W),(()=>{var V={},W="frankerfacez:";I.l=(g,k,O,U)=>{if(V[g]){V[g].push(k);return}var T,F;if(O!==void 0)for(var L=document.getElementsByTagName("script"),d=0;d<L.length;d++){var C=L[d];if(C.getAttribute("src")==g||C.getAttribute("data-webpack")==W+O){T=C;break}}T||(F=!0,T=document.createElement("script"),T.charset="utf-8",T.timeout=120,I.nc&&T.setAttribute("nonce",I.nc),T.setAttribute("data-webpack",W+O),T.src=g,T.src.indexOf(window.location.origin+"/")!==0&&(T.crossOrigin="anonymous")),V[g]=[k];var u=z((w,_)=>{T.onerror=T.onload=null,clearTimeout(b);var A=V[g];if(delete V[g],T.parentNode&&T.parentNode.removeChild(T),A&&A.forEach(p=>p(_)),w)return w(_)},"onScriptComplete"),b=setTimeout(u.bind(null,void 0,{type:"timeout",target:T}),12e4);T.onerror=u.bind(null,T.onerror),T.onload=u.bind(null,T.onload),F&&document.head.appendChild(T)}})(),I.r=V=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(V,"__esModule",{value:!0})},I.j=3035,(()=>{var V;I.g.importScripts&&(V=I.g.location+"");var W=I.g.document;if(!V&&W&&(W.currentScript&&(V=W.currentScript.src),!V)){var g=W.getElementsByTagName("script");if(g.length)for(var k=g.length-1;k>-1&&!V;)V=g[k--].src}if(!V)throw new Error("Automatic publicPath is not supported in this browser");V=V.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),I.p=V})(),(()=>{var V={3035:0};I.f.j=(k,O)=>{var U=I.o(V,k)?V[k]:void 0;if(U!==0)if(U)O.push(U[2]);else{var T=new Promise((C,u)=>U=V[k]=[C,u]);O.push(U[2]=T);var F=I.p+I.u(k),L=new Error,d=z(C=>{if(I.o(V,k)&&(U=V[k],U!==0&&(V[k]=void 0),U)){var u=C&&(C.type==="load"?"missing":C.type),b=C&&C.target&&C.target.src;L.message="Loading chunk "+k+` failed.
(`+u+": "+b+")",L.name="ChunkLoadError",L.type=u,L.request=b,U[1](L)}},"loadingEnded");I.l(F,d,"chunk-"+k,k)}};var W=z((k,O)=>{var[U,T,F]=O,L,d,C=0;if(U.some(b=>V[b]!==0)){for(L in T)I.o(T,L)&&(I.m[L]=T[L]);if(F)var u=F(I)}for(k&&k(O);C<U.length;C++)d=U[C],I.o(V,d)&&V[d]&&V[d][0](),V[d]=0},"webpackJsonpCallback"),g=globalThis.ffzWebpackJsonp=globalThis.ffzWebpackJsonp||[];g.forEach(W.bind(null,0)),g.push=W.bind(null,g.push.bind(g))})();var ws={};(()=>{var Ne,We;"use strict";var V={};I.r(V),I.d(V,{to_float:()=>f,to_int:()=>m});var W={};I.r(W),I.d(W,{process_to_float:()=>$,process_to_int:()=>S});var g={};I.r(g),I.d(g,{AddonDebug:()=>ye,And:()=>G,Category:()=>_e,Channel:()=>be,Constant:()=>X,Debug:()=>he,Fullscreen:()=>ce,If:()=>Q,Invert:()=>Z,Moderator:()=>fe,Monitor:()=>ge,NativeDarkTheme:()=>ue,Or:()=>Y,Page:()=>ve,SquadMode:()=>le,TheaterMode:()=>de,Time:()=>J,Title:()=>we});var k={};I.r(k),I.d(k,{Everything:()=>ut,Experiments:()=>et,FavoriteEmotes:()=>dt,HiddenEmotes:()=>ct,Overrides:()=>tt,Profiles:()=>st});var O=I(51722),U=I.n(O),T=I(55467),F=I(22527),L=I(24431),d=I(46949),C=I(20857),u=I(81011),b=I(17159);const w=Symbol("default"),x={basic:{get(R,e){for(const s of e)if(s.has(R))return[s.get(R),[s.id]]}},object_merge:{get(R,e,s,i){const n=[],y=[];for(const h of e)if(h.has(R)){const B=h.get(R);if(!B||typeof B!="object"){i.warn(`Profile #${h.id} has an invalid value for "${R}" of type ${typeof B}. Skipping.`);continue}y.push(h.id),n.unshift(B)}if(y.length)return[Object.assign({},...n),y]}},basic_array_merge:{get(R,e,s,i){const n=[],y=[];for(const h of e)if(h.has(R)){const B=h.get(R);if(!Array.isArray(B)){i.warn(`Profile #${h.id} has an invalid value for "${R}"`);continue}y.push(h.id);for(const K of B)n.push(K)}if(y.length)return[n,y]}},array_merge:{default(R){const e=[];for(const s of R)s.t!=="inherit"&&s.t!=="skip"&&s.v&&e.push(s.v);return e},get(R,e,s,i,n){const y=[],h=[];let B=[],K=!1,te=e;s.inherit_default&&(te=[...e,w]);for(const ne of te){let oe;if(ne===w)oe=s.default,typeof oe=="function"&&(oe=oe(n));else if(ne.has(R))oe=ne.get(R);else continue;if(!Array.isArray(oe)){ne!==w&&i.warn(`Profile #${ne.id} has an invalid value for "${R}" of type ${typeof oe}. Skipping.`);continue}const Ae=[];ne!==w&&h.push(ne.id);let De=!1;for(const ze of oe)if(K=!0,ze.t==="inherit")De=!0;else{if(ze.t==="skip")continue;De?Ae.push(ze.v):y.push(ze.v)}if(B=Ae.concat(B),!De&&!s.always_inherit)break}if(K)return[y.concat(B),h]}}};function a(R,e,s){if(!R||!Array.isArray(R.requires))return!1;for(const i of R.requires){const n=s.get(i),y=e.get(i);if(typeof n!=typeof y)return!0;if(Array.isArray(n)&&Array.isArray(y)){if(!(0,d.array_equals)(y,n))return!0}else if(y instanceof Set&&n instanceof Set){if(!(0,d.set_equals)(y,n))return!0}else if(y instanceof Map&&n instanceof Map){if(!(0,d.map_equals)(y,n))return!0}else if(y!==n)return!0}return!1}z(a,"compare_requirements");const Ge=class Ge extends b.EventEmitter{constructor(e,s){super(),this.__context=null,e instanceof Ge?(this.parent=e,this.manager=e.manager,this.parent.on("context_changed",this._rebuildContext,this)):(this.parent=null,this.manager=e),this.manager.__contexts.push(this),this._context=s||{},this.__ls_listening=!1,this.__ls_wanted=new Map,this.__cache=new Map,this.__meta=new Map,this.__profiles=[],this.order=[],this._rebuildContext()}destroy(){this.parent&&this.parent.off("context_changed",this._rebuildContext,this);for(const i of this.__profiles)i.off("changed",this._onChanged,this);const e=this.manager.__contexts,s=e.indexOf(this);s!==-1&&e.splice(s,1)}_watchLS(){this.__ls_listening||(this.__ls_listening=!0,this.manager.on(":ls-update",this._onLSUpdate,this))}_unwatchLS(){this.__ls_listening&&(this.__ls_listening=!1,this.manager.off(":ls-update",this._onLSUpdate,this))}_onLSUpdate(e){const s=this.__ls_wanted.get(`ls.${e}`);if(s)for(const i of s)this._update(i,i,[])}_rebuildContext(){this.__context=this.parent?Object.assign({},this.parent.__context||this.parent._context,this._context):this._context,this.selectProfiles()||this.rebuildCache(),this.emit("context_changed")}selectProfiles(){const e=[],s=this.order=[];if(!this.manager.disable_profiles)for(const n of this.manager.__profiles)n.toggled&&n.matches(this.__context)&&(e.push(n),s.push(n.id));if((0,d.array_equals)(this.__profiles,e))return!1;const i=new Set;for(const n of this.__profiles)e.includes(n)||(n.off("changed",this._onChanged,this),i.add(n.id));for(const n of e)this.__profiles.includes(n)||(n.on("changed",this._onChanged,this),i.add(n.id));return this.__profiles=e,this.emit("profiles_changed"),this.rebuildCache(),!0}rebuildCache(){const e=this.__cache,s=this.__meta,i=this.__meta=new Map;this.__cache=new Map;for(const[n,y]of e){const h=this.get(n),B=i.get(n),K=s.get(n),te=B?B.uses:null,ne=K?K.uses:null,oe=this.manager.definitions.get(n);let Ae=!1;!Array.isArray(oe)&&oe?.equals?oe.equals==="requirements"?Ae=a(oe,this.__cache,e):typeof oe.equals=="function"&&(Ae=!oe.equals(h,y,this.__cache,e)):Array.isArray(h)&&Array.isArray(y)?Ae=!(0,d.array_equals)(h,y):h instanceof Set&&y instanceof Set?Ae=!(0,d.set_equals)(h,y):h instanceof Map&&y instanceof Map?Ae=!(0,d.map_equals)(h,y):h!==y&&(Ae=!0),Ae&&(this.emit("changed",n,h,y),this.emit(`changed:${n}`,h,y)),(0,d.array_equals)(te,ne)||(this.emit("uses_changed",n,te,ne),this.emit(`uses_changed:${n}`,te,ne))}}context(e){return new Ge(this,e)}updateContext(e){let s=!1;for(const i in e)if((0,d.has)(e,i)){const n=e[i];try{if((0,d.deep_equals)(n,this._context[i]))continue}catch{}this._context[i]=n,s=!0}s&&this._rebuildContext()}setContext(e){this._context={},this.updateContext(e)}_onChanged(e){this._update(e,e,[])}_update(e,s,i){if(this.__cache.has(e)){if(i.includes(e))throw new Error(`cyclic dependent chain when updating setting "${s}"`)}else return;i.push(e);const n=this.__cache.get(e),y=this.__meta.get(e),h=this._get(e,e,[]),B=this.__meta.get(e),K=y?y.uses:null,te=B?B.uses:null;if((0,d.array_equals)(te,K)||(this.emit("uses_changed",e,te,K),this.emit(`uses_changed:${e}`,te,K)),n===h)return;this.emit("changed",e,h,n),this.emit(`changed:${e}`,h,n);const ne=this.manager.definitions.get(e);if(!Array.isArray(ne)&&ne?.required_by)for(const oe of ne.required_by)!oe.startsWith("context.")&&!oe.startsWith("ls.")&&this._update(oe,s,Array.from(i))}_get(e,s,i){if(i.includes(e))throw new Error(`cyclic dependency when resolving setting "${s}"`);i.push(e);const n=this.manager.definitions.get(e),y=!Array.isArray(n)&&n?.type,h=y?x[y]:x.basic;if(!h)throw new Error(`non-existent setting type "${y}"`);const B=this._getRaw(e,h),K={uses:B?B[1]:null};let te=B?B[0]:void 0;if(n){if(Array.isArray(n))throw new Error(`non-existent setting "${e}" required when resolving setting "${s}"`);if(K.uses===null){const ne=n.default;typeof ne=="function"?te=ne(this):te=ne,h.default&&(te=h.default(te,n,this.manager.log))}if(n.requires)for(const ne of n.requires)if(ne.startsWith("ls.")){this._watchLS();let oe=this.__ls_wanted.get(ne);oe||this.__ls_wanted.set(ne,oe=new Set),oe.add(e)}else!ne.startsWith("context.")&&!this.__cache.has(ne)&&this._get(ne,s,Array.from(i));n.process&&(te=n.process(this,te,K))}return this.__cache.set(e,te),this.__meta.set(e,K),te}*profiles(){for(const e of this.__profiles)yield e}hasProfile(e){if(typeof e=="number"){for(const s of this.__profiles)if(s.id===e)return!0;return!1}return this.__profiles.includes(e)}_getRaw(e,s){if(!s)throw new Error(`non-existent type for ${e}`);return s.get(e,this.profiles(),this.manager.definitions.get(e),this.manager.log,this)}update(e){this._update(e,e,[])}get(e){return e.startsWith("ls.")?this.manager.getLS(e.slice(3)):e.startsWith("context.")?(0,d.get)(e.slice(8),this.__context):this.__cache.has(e)?this.__cache.get(e):this._get(e,e,[])}getChanges(e,s,i){this.onChange(e,s,i),s.call(i,this.get(e),void 0)}onChange(e,s,i){this.on(`changed:${e}`,s,i)}uses(e){return e.startsWith("ls.")||e.startsWith("context.")?null:(this.__meta.has(e)||this._get(e,e,[]),this.__meta.get(e)?.uses??null)}};z(Ge,"SettingsContext");let o=Ge;const r=Symbol("BAD");function l(R,e,s){if((typeof R!="number"||isNaN(R)||!isFinite(R))&&(R=r),R!==r){const i=s.bounds;Array.isArray(i)&&(i.length>=3?((i[1]?R<i[0]:R<=i[0])||(i[3]?R>i[2]:R>=i[2]))&&(R=r):i.length===2?typeof i[1]=="boolean"?(i[1]?R<i[0]:R<=i[0])&&(R=r):(R<i[0]||R>i[1])&&(R=r):i.length===1&&R<i[0]&&(R=r))}return R===r?e:R}z(l,"do_number");const m=z((R,e,s)=>(typeof R=="string"&&/^-?\d+$/.test(R)?R=parseInt(R,10):typeof R!="number"&&(R=r),l(R,e,s)),"to_int"),f=z((R,e,s)=>(typeof R=="string"&&/^-?[\d.]+$/.test(R)?R=parseFloat(R):typeof R!="number"&&(R=r),l(R,e,s)),"to_float");function c(R,e){if(typeof R!="number"||isNaN(R)||!isFinite(R))return!1;const s=e.bounds;if(Array.isArray(s)){if(s.length>=3){if((s[1]?R<s[0]:R<=s[0])||(s[3]?R>s[2]:R>=s[2]))return!1}else if(s.length===2){if(typeof s[1]=="boolean"){if(s[1]?R<s[0]:R<=s[0])return!1}else if(R<s[0]||R>s[1])return!1}else if(s.length===1&&R<s[0])return!1}return!0}z(c,"validators_do_number");const S=z((R,e)=>{if(typeof R=="string"&&/^-?\d+$/.test(R))R=parseInt(R,10);else if(typeof R!="number")return!1;return c(R,e)},"process_to_int"),$=z((R,e)=>{if(typeof R=="string"&&/^-?[\d.]+$/.test(R))R=parseFloat(R);else if(typeof R!="number")return!1;return c(R,e)},"process_to_float");var P=I(37087);let E=null;function D(R){I.e(6530).then(I.t.bind(I,28820,23)).then(e=>{E=e.default,R&&R()})}z(D,"loadSafety");const M=z(()=>!1,"NeverMatch"),Z={createTest(R,e,s){return(0,P.createTester)(R,e,!0,!1,s)},maxRules:1,childRules:!0,tall:!0,title:"Invert",i18n:"settings.filter.invert",default:()=>[],editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,9786))},G={createTest(R,e,s){return(0,P.createTester)(R,e,!1,!1,s)},childRules:!0,tall:!0,title:"And",i18n:"settings.filter.and",default:()=>[],editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,9786))},Y={createTest(R,e,s){return(0,P.createTester)(R,e,!1,!0,s)},childRules:!0,tall:!0,title:"Or",i18n:"settings.filter.or",default:()=>[],editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,9786))},Q={createTest(R,e,s){const i=(0,P.createTester)(R[0],e,!1,!1,s),n=(0,P.createTester)(R[1],e,!1,!1,s),y=(0,P.createTester)(R[2],e,!1,!1,s);return h=>i(h)?n(h):y(h)},childRules:!0,tall:!0,title:"If",i18n:"settings.filter.if",default:()=>[[],[],[]],editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,17907))},X={createTest(R){return R?()=>!0:M},title:"True or False",i18n:"settings.filter.true_false",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))};function se(R){if(typeof R!="string"||!R.length)return null;const e=R.indexOf(":");if(e===-1)return null;let s,i;try{s=parseInt(R.slice(0,e),10),i=parseInt(R.slice(e+1),10)}catch{return null}return s*60+i}z(se,"parseTime");const J={_captured:new Set,createTest(R){const e=se(R[0]),s=se(R[1]);return e==null||s==null?M:e<=s?()=>{J._captured.add(e),J._captured.add(s+1);const i=new Date,n=i.getHours()*60+i.getMinutes();return n>=e&&n<=s}:()=>{J._captured.add(e+1),J._captured.add(s);const i=new Date,n=i.getHours()*60+i.getMinutes();return n>=e||n<=s}},captured:()=>{const R=Array.from(J._captured);return J._captured=new Set,R.sort((e,s)=>e-s),R},title:"Time of Day",i18n:"settings.filter.time",default:()=>["08:00","18:00"],editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,64e3))},de={createTest(R){return e=>e.fullscreen?R===!1:e.ui?.theatreModeEnabled===R},title:"Theater Mode",i18n:"settings.filter.theater",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},ce={createTest(R){return e=>e.fullscreen===R},title:"Fullscreen",i18n:"settings.filter.fullscreen",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},fe={createTest(R){return e=>e.moderator===R},title:"Is Moderator",i18n:"settings.filter.moderator",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},he={createTest(R){return()=>L.DEBUG===R},title:"Is Developer Mode",i18n:"settings.filter.dev",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},ye={createTest(R){return e=>e.addonDev==R},title:"Is Addon Developer Mode",i18n:"settings.filter.addon-dev",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},le={createTest(R){return e=>e.ui?.squadModeEnabled===R},title:"Squad Mode",i18n:"settings.filter.squad",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},ue={createTest(R){const e=R?1:0;return s=>s.ui?.theme===e},title:"Dark Theme",i18n:"settings.filter.native-dark",default:!0,editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))},ve={createTest(R){if(!R)return M;const e=R.route,s=[];if(Object.keys(R.values).length){const i=window.FrankerFaceZ?.get(),n=i&&i.resolve("site.router");if(!n)return M;const y=n.getRoute(e);if(!y||!y.parts)return M;let h=1;for(const B of y.parts)if(typeof B=="object"){const K=R.values[B.name];K&&K.length&&s.push([h,K.toLowerCase()]),h++}}return i=>{if(!i.route||!i.route_data||i.route.name!==e)return!1;for(const[n,y]of s){let h=i.route_data[n];if(typeof h=="string"&&(h=h.toLowerCase()),h!==y)return!1}return!0}},tall:!0,title:"Current Page",i18n:"settings.filter.page",default:()=>({route:"front-page",values:{}}),editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,38961))},be={createTest(R){const e=R?.login,s=R?.id;if(!s&&!e)return M;if(s){if(!e)return i=>i.channelID===s}else return i=>i.channel===e;return i=>i.channelID===s||i.channelID==null&&i.channel===e},title:"Current Channel",i18n:"settings.filter.channel",default:()=>({login:null,id:null}),editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,69370))},_e={createTest(R){const e=R?.name,s=R?.id;if(!s&&!e)return M;if(s){if(!e)return i=>i.categoryID===s}else return i=>i.category===e;return i=>i.categoryID===s||i.categoryID==null&&i.category===e},title:"Current Category",i18n:"settings.filter.category",default:()=>({name:null,id:null}),editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,94344))},we={createTest(R,e,s){const i=R?.mode;let n=R?.title,y=!0;if(!n||!i)return M;if(i==="text")n=(0,d.escape_regex)(n),y=!1;else if(i==="glob")n=(0,d.glob_to_regex)(n);else if(i!=="raw")return M;if(y&&(E||D(s),!E||!E(n)))return M;let h;try{h=new RegExp(n,`g${R.sensitive?"":"i"}`)}catch{return M}return B=>(h.lastIndex=0,B.title?h.test(B.title):!1)},title:"Current Title",i18n:"settings.filter.title",default:()=>({title:"",mode:"text",sensitive:!1}),editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,43922))};let ge=null;window.getScreenDetails&&(ge={_used:!1,details:void 0,used:()=>{const R=ge._used;return ge._used=!1,R},createTest(R,e,s){if(!R?.label)return M;if(ge._used=!0,s&&ge.details===void 0){const i=window.FrankerFaceZ??window.FFZBridge,n=i?.get(),y=n?.resolve("settings");y&&y.createMonitorUpdate().then(()=>{s()})}return()=>{ge._used=!0;const i=ge.details;if(!i)return!1;const n=i.screens;return(0,d.matchScreen)(n,R)===i.currentScreen}},default:()=>({label:null}),title:"Current Monitor",i18n:"settings.filter.monitor",editor:()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,57049))});var Se=I(38626);const Oe=1,Ce=window.location.host!=="www.twitch.tv",N=window.location.host!=="www.youtube.com",Pt=class Pt extends b.EventEmitter{constructor(e){super(),this.ready=!1,this.manager=e,this.disabled=!1}static supported(){return!1}awaitReady(){return this.ready?Promise.resolve():Promise.reject(new Error("Not Implemented"))}get allowTransfer(){return this.constructor.allowTransfer}get shouldUpdate(){return this.constructor.shouldUpdate}};z(Pt,"SettingsProvider");let j=Pt;j.priority=0,j.allowTransfer=!0,j.shouldUpdate=!0;const At=class At extends j{get supportsBlobs(){return!0}isValidBlob(e){return this.supportsBlobs&&(0,Se.isValidBlob)(e)}};z(At,"AdvancedSettingsProvider");let H=At;const Ot=class Ot extends H{constructor(e){super(e),this._start_time=performance.now(),this._rpc=new Map,this._cached=new Map,this.resolved_ready=!1,this.ready=!1,this._ready_wait=null,this._blobs=null,this._last_id=0}get supportsBlobs(){return this._blobs??!1}broadcastTransfer(){}disableEvents(){}resolveReady(e,s){this.manager&&this.manager.log.info(`${this.constructor.name} ready in ${(performance.now()-this._start_time).toFixed(5)}ms`),this.resolved_ready=!0,this.ready=e,e&&this._ready_wait_resolve?this._ready_wait_resolve():!e&&this._ready_wait_fail&&this._ready_wait_fail(s)}awaitReady(){return this.resolved_ready?this.ready?Promise.resolve():Promise.reject():this._ready_wait?this._ready_wait:this._ready_wait=new Promise((e,s)=>{this._ready_wait_resolve=e,this._ready_wait_fail=s}).finally(()=>{this._ready_wait=null,this._ready_wait_resolve=null,this._ready_wait_fail=null})}get(e,s){return this._cached.has(e)?this._cached.get(e):s}set(e,s){if(s===void 0){this.has(e)&&this.delete(e);return}this._cached.set(e,s),this.rpc({ffz_type:"set",key:e,value:s}).catch(i=>this.manager.log.error("Error setting value",i)),this.emit("set",e,s,!1)}delete(e){this._cached.delete(e),this.rpc({ffz_type:"delete",key:e}).catch(s=>this.manager.log.error("Error deleting value",s)),this.emit("set",e,void 0,!0)}clear(){const e=this._cached;this._cached=new Map;for(const s of e.keys())this.emit("changed",s,void 0,!0);this.rpc("clear").catch(s=>this.manager.log.error("Error clearing storage",s))}has(e){return this._cached.has(e)}keys(){return this._cached.keys()}entries(){return this._cached.entries()}get size(){return this._cached.size}async flush(){await this.rpc("flush")}async getBlob(e){const s=await this.rpc({ffz_type:"get-blob",key:e});return s?(0,Se.deserializeBlob)(s):null}async setBlob(e,s){await this.rpc({ffz_type:"set-blob",key:e,value:await(0,Se.serializeBlob)(s)})}async deleteBlob(e){await this.rpc({ffz_type:"delete-blob",key:e})}async hasBlob(e){return this.rpc({ffz_type:"has-blob",key:e})}async clearBlobs(){await this.rpc("clear-blobs")}async blobKeys(){return this.rpc("blob-keys")}rpc(e,s){const i=++this._last_id;return new Promise((n,y)=>{this._rpc.set(i,[n,y]);let h;typeof e=="string"?h={ffz_type:e}:h=e,h.id=i,this.send(h,s)})}handleMessage(e){e.ffz_type==="ready"?this.rpc("init-load").then(s=>{this._blobs=s.blobs;for(const[i,n]of Object.entries(s.values))this._cached.set(i,n);this.resolveReady(!0)}).catch(s=>{this.resolveReady(!1,s)}):e.ffz_type==="change"?this.onChange(e):e.ffz_type==="change-blob"?this.emit("changed-blob",e.key,e.deleted):e.ffz_type==="clear-blobs"?this.emit("clear-blobs"):e.ffz_type==="reply"||e.ffz_type==="reply-error"?this.onReply(e):this.manager.log.warn("Unknown Message",e.ffz_type,e)}onChange(e){const s=e.key,i=e.value;e.deleted?(this._cached.delete(s),this.emit("changed",s,void 0,!0)):(this._cached.set(s,i),this.emit("changed",s,i,!1))}onReply(e){const s=e.id,i=e.ffz_type==="reply",n=this._rpc.get(s);if(!n)return this.manager.log.warn("Received reply for unknown ID",s);this._rpc.delete(s),i?n[0](e.reply):n[1]()}};z(Ot,"RemoteSettingsProvider");let q=Ot;const Ct=class Ct extends j{constructor(e,s){super(e),this.prefix=s=s??"FFZ:setting:";const i=this._cached=new Map,n=s.length;for(const y in localStorage)if((0,d.has)(localStorage,y)&&y.startsWith(s)){const h=localStorage.getItem(y);if(h)try{i.set(y.slice(n),JSON.parse(h))}catch{this.manager.log.warn(`unable to parse value for ${y}`,h)}}this.ready=!0,window.BroadcastChannel?(this._broadcaster=new BroadcastChannel("ffz-settings")).addEventListener("message",this._boundHandleMessage=this.handleMessage.bind(this)):window.addEventListener("storage",this._boundHandleStorage=this.handleStorage.bind(this))}static supported(){return!0}static hasContent(e){e||(e="FFZ:setting:");for(const s in localStorage)if(s.startsWith(e)&&(0,d.has)(localStorage,s))return!0;return!1}broadcastTransfer(){this.broadcast({type:"change-provider"})}removeListeners(){this._broadcaster&&(this._boundHandleMessage&&this._broadcaster.removeEventListener("message",this._boundHandleMessage),this._broadcaster.close(),this._boundHandleMessage=this._broadcaster=null),this._boundHandleStorage&&(window.removeEventListener("storage",this._boundHandleStorage),this._boundHandleStorage=null)}disableEvents(){this.removeListeners(),this.broadcast=()=>{},this.emit=()=>{}}destroy(){this.disable(),this._cached.clear()}disable(){this.removeListeners(),this.disabled=!0}flush(){}broadcast(e){this._broadcaster&&this._broadcaster.postMessage(e)}handleMessage(e){if(this.disabled||!e.isTrusted||!e.data)return;this.manager.log.debug("storage broadcast event",e.data);const{type:s,key:i}=e.data;if(s==="change-provider")this.manager.log.info("Received notice of changed settings provider."),this.emit("change-provider"),this.disable(),this.disableEvents();else if(s==="set"){const n=JSON.parse(localStorage.getItem(this.prefix+i)??"null");this._cached.set(i,n),this.emit("changed",i,n,!1)}else if(s==="delete")this._cached.delete(i),this.emit("changed",i,void 0,!0);else if(s==="clear"){const n=Array.from(this._cached.keys());this._cached.clear();for(const y of n)this.emit("changed",y,void 0,!0)}}handleStorage(e){if(!this.disabled&&(this.manager.log.debug("storage event",e),e.storageArea===localStorage&&e.key&&e.key.startsWith(this.prefix))){const s=e.key.slice(this.prefix.length);let i=e.newValue;i===null?(this._cached.delete(s),this.emit("changed",s,void 0,!0)):(i=JSON.parse(i),this._cached.set(s,i),this.emit("changed",s,i,!1))}}get(e,s){return this._cached.has(e)?this._cached.get(e):s}set(e,s){if(!this.disabled){if(s===void 0){this.has(e)&&this.delete(e);return}this._cached.set(e,s);try{localStorage.setItem(this.prefix+e,JSON.stringify(s))}catch(i){throw this.manager&&this.manager.log.error(`An error occurred while trying to save a value to localStorage for key "${this.prefix+e}"`),i&&/quota/i.test(i.toString())&&this.emit("quota-exceeded",i),i}this.broadcast({type:"set",key:e}),this.emit("set",e,s,!1)}}delete(e){this.disabled||(this._cached.delete(e),localStorage.removeItem(this.prefix+e),this.broadcast({type:"delete",key:e}),this.emit("set",e,void 0,!0))}has(e){return this._cached.has(e)}keys(){return this._cached.keys()}clear(){if(this.disabled)return;const e=this._cached;this._cached=new Map;for(const s of e.keys())localStorage.removeItem(this.prefix+s),this.emit("changed",s,void 0,!0);this.broadcast({type:"clear"})}entries(){return this._cached.entries()}get size(){return this._cached.size}};z(Ct,"LocalStorageProvider");let ee=Ct;ee.priority=-1e3,ee.title="Local Storage",ee.description="[Local Storage](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API) is available on all platforms and fast to access, but has poorly defined capacity limits and may be cleared unexpectedly. Particularly, clearing cookies and cache in your browser will likely clear Local Storage as well.";const zt=class zt extends H{constructor(e,s=!0){super(e),this._last_tx=0,this.getDB=(0,d.once)(this.getDB),this._start_time=performance.now(),this._pending=new Set,this._flush_wait=null,this._lock=new d.TicketLock,this._cached=new Map,this.ready=!1,this._ready_wait=null,s&&(window.BroadcastChannel&&(this._broadcaster=new BroadcastChannel("ffz-settings")).addEventListener("message",this._boundHandleMessage=this.handleMessage.bind(this)),this._ready_wait=this.loadSettings().then(()=>{this.manager&&this.manager.log.info(`IDB ready in ${(performance.now()-this._start_time).toFixed(5)}ms`),this.ready=!0}).catch(i=>{this.manager&&this.manager.log.error(`IDB failed after ${(performance.now()-this._start_time).toFixed(5)}ms:`,i),this.ready=!1}).finally(()=>{this._ready_wait=null}))}static supported(){return window.indexedDB!=null}static hasContent(){return new Promise(e=>{const s=window.indexedDB.open("FFZ",Oe);s.onerror=()=>e(!1),s.onupgradeneeded=i=>{i.target instanceof IDBRequest&&i.target.transaction?.abort(),e(!1)},s.onsuccess=()=>{const i=s.result;let n;try{n=i.transaction(["settings"],"readonly").objectStore("settings")}catch{return e(!1)}const y=n.getAllKeys();y.onerror=()=>{i.close(),e(!1)},y.onsuccess=()=>{const h=Array.isArray(y.result)&&y.result.length>0;return i.close(),e(h)}}})}destroy(){this.disable(),this._cached.clear()}disable(){this.disabled=!0,this.removeListeners(),this.db&&(this.db.close(),this.db=null)}removeListeners(){this._broadcaster&&(this._boundHandleMessage&&this._broadcaster.removeEventListener("message",this._boundHandleMessage),this._broadcaster.close(),this._boundHandleMessage=this._broadcaster=null)}broadcastTransfer(){this.broadcast({type:"change-provider"})}disableEvents(){this.removeListeners(),this.broadcast=()=>{},this.emit=()=>{}}_onStart(e){this._pending||(this._pending=new Set),this._pending.add(e)}_onFinish(e){this._pending&&(this._pending.delete(e),this._pending.size)||this._flush_wait_resolve&&this._flush_wait_resolve()}flush(){return this._flush_wait?this._flush_wait:!this._pending||!this._pending.size?Promise.resolve():this._flush_wait=new Promise(e=>{this._flush_wait_resolve=e}).finally(()=>{this._flush_wait_resolve=null,this._flush_wait=null})}broadcast(e){this._broadcaster&&this._broadcaster.postMessage(e)}handleMessage(e){if(this.disabled||!e.isTrusted||!e.data)return;this.manager&&this.manager.log.debug("storage broadcast event",e.data);const{type:s,key:i}=e.data;if(s==="change-provider")this.manager.log.info("Received notice of changed settings provider."),this.emit("change-provider"),this.disable(),this.disableEvents();else if(s==="set")this._get(i).then(n=>{this._cached.set(i,n),this.emit("changed",i,n,!1)}).catch(n=>this.manager&&this.manager.log.error(`Error getting setting "${i}" from database`,n));else if(s==="delete")this._cached.delete(i),this.emit("changed",i,void 0,!0);else if(s==="clear"){const n=Array.from(this._cached.keys());this._cached.clear();for(const y of n)this.emit("changed",y,void 0,!0)}else s==="set-blob"?this.emit("changed-blob",i,!1):s==="delete-blob"?this.emit("changed-blob",i,!0):s==="clear-blobs"&&this.emit("clear-blobs")}awaitReady(){return this._ready_wait?this._ready_wait:this.ready?Promise.resolve():Promise.reject()}get(e,s){return this._cached.has(e)?this._cached.get(e):s}set(e,s){if(!this.disabled){if(s===void 0){this.has(e)&&this.delete(e);return}this._cached.set(e,s),this._set(e,s).then(()=>this.broadcast({type:"set",key:e})).catch(i=>this.manager&&this.manager.log.error(`Error saving setting "${e}" to database`,i)),this.emit("set",e,s,!1)}}delete(e){this.disabled||(this._cached.delete(e),this._delete(e).catch(s=>this.manager&&this.manager.log.error(`Error deleting setting "${e}" from database`,s)).then(()=>this.broadcast({type:"delete",key:e})),this.emit("set",e,void 0,!0))}has(e){return this._cached.has(e)}keys(){return this._cached.keys()}clear(){if(this.disabled)return;const e=this._cached;this._cached=new Map;for(const s of e.keys())this.emit("changed",s,void 0,!0);this._clear().catch(s=>this.manager&&this.manager.log.error("Error clearing database",s)).then(()=>this.broadcast({type:"clear"}))}entries(){return this._cached.entries()}get size(){return this._cached.size}getDB(e=!1){if(this.db)return Promise.resolve(this.db);if(this._db_wait)return this._db_wait;let s;return this._db_wait=s=new Promise((i,n)=>{const y=window.indexedDB.open("FFZ",Oe);this._onStart(y),y.onerror=h=>{this.manager&&this.manager.log.error("Error opening database.",h),n(h),this._onFinish(y)},y.onupgradeneeded=h=>{this.manager&&this.manager.log.info(`Upgrading database from version ${h.oldVersion} to ${Oe}`);const B=y.result;B.createObjectStore("settings",{keyPath:"k"}),B.createObjectStore("blobs")},y.onsuccess=()=>{this.manager&&this.manager.log.info(`Database opened. (After: ${(performance.now()-this._start_time).toFixed(5)}ms)`),this.db=y.result;try{const h=this.db.transaction(["settings","blobs"],"readonly");h.objectStore("settings"),h.objectStore("blobs")}catch(h){this.manager&&this.manager.log.error("Database in invalid state.",h);try{this.db.close()}catch{}if(this._onFinish(y),this.db=null,e)n(h);else{const B=window.indexedDB.deleteDatabase("FFZ");this._onStart(B),B.onerror=K=>{this.manager&&this.manager.log.error("Error deleting invalid database.",K),n(K),this._onFinish(B)},B.onsuccess=()=>{this.manager&&this.manager.log.info("Deleted invalid database."),this._onFinish(B),this._db_wait=null,this.getDB(!0).then(i).catch(n)}}return}i(this.db),this._onFinish(y)}}).finally(()=>{s===this._db_wait&&(this._db_wait=null)})}async loadSettings(){const e=await this.getDB(),s=e.transaction(["settings"],"readonly"),i=s.objectStore("settings"),n=this._last_tx++;return this._onStart(n),new Promise((y,h)=>{s.onabort=K=>{this.manager&&this.manager.log.error("Transaction aborted reading settings from database.",K),this._onFinish(n),h()};const B=i.getAll();B.onsuccess=()=>{for(const K of B.result)this._cached.set(K.k,K.v);this._onFinish(n),y()},B.onerror=K=>{this.manager&&this.manager.log.error("Error reading settings from database.",K),this._onFinish(n),h()}})}async _getKeys(){const e=await this.getDB(),s=e.transaction(["settings"],"readonly"),i=s.objectStore("settings"),n=this._last_tx++;return this._onStart(n),new Promise((y,h)=>{s.onabort=K=>{this.manager&&this.manager.log.error("Transaction aborted reading keys from database.",K),this._onFinish(n),h()};const B=i.getAllKeys();B.onsuccess=()=>{this._onFinish(n),y(B.result)},B.onerror=K=>{this.manager&&this.manager.log.error("Error reading keys from database.",K),this._onFinish(n),h()}})}async _get(e){const s=await this.getDB(),i=s.transaction(["settings"],"readonly"),n=i.objectStore("settings"),y=this._last_tx++;return this._onStart(y),new Promise((h,B)=>{i.onabort=te=>{this.manager&&this.manager.log.error("Transaction aborted reading value from database.",te),this._onFinish(y),B()};const K=n.get(e);K.onerror=te=>{this.manager&&this.manager.log.error("Error reading value from database.",te),this._onFinish(y),B()},K.onsuccess=()=>{this._onFinish(y),h(K.result.v)}})}async _set(e,s){if(this.disabled)return;const i=this._last_tx++;this._onStart(i);const n=await this._lock.wait(),y=await this.getDB(),h=y.transaction(["settings"],"readwrite"),B=h.objectStore("settings");return new Promise((K,te)=>{h.onabort=oe=>{this.manager&&this.manager.log.error("Transaction aborted setting value to database.",oe),n(),this._onFinish(i),te()};const ne=B.put({k:e,v:s});ne.onerror=oe=>{this.manager&&this.manager.log.error("Error setting value to database.",oe),n(),this._onFinish(i),te()},ne.onsuccess=()=>{n(),this._onFinish(i),K()}})}async _delete(e){if(this.disabled)return;const s=this._last_tx++;this._onStart(s);const i=await this._lock.wait(),n=await this.getDB(),y=n.transaction(["settings"],"readwrite"),h=y.objectStore("settings");return new Promise((B,K)=>{y.onabort=ne=>{this.manager&&this.manager.log.error("Transaction aborted deleting value from database.",ne),i(),this._onFinish(s),K()};const te=h.delete(e);te.onerror=ne=>{this.manager&&this.manager.log.error("Error deleting value from database.",ne),i(),this._onFinish(s),K()},te.onsuccess=()=>{i(),this._onFinish(s),B()}})}async _clear(){if(this.disabled)return;const e=this._last_tx++;this._onStart(e);const s=await this._lock.wait(),i=await this.getDB(),n=i.transaction(["settings"],"readwrite"),y=n.objectStore("settings");return new Promise((h,B)=>{n.onabort=te=>{this.manager&&this.manager.log.error("Transaction aborted clearing database.",te),s(),this._onFinish(e),B()};const K=y.clear();K.onerror=te=>{this.manager&&this.manager.log.error("Error clearing database.",te),s(),this._onFinish(e),B()},K.onsuccess=()=>{s(),this._onFinish(e),h()}})}async getBlob(e){const s=await this.getDB(),i=s.transaction(["blobs"],"readonly"),n=i.objectStore("blobs");return new Promise((y,h)=>{const B=n.get(e);this._onStart(B),B.onerror=()=>{h(),this._onFinish(B)},B.onsuccess=K=>{(0,Se.isValidBlob)(B.result)?y(B.result):h(),this._onFinish(B)}})}async setBlob(e,s){if(this.disabled)return;if(!this.isValidBlob(s))throw new Error("Invalid blob type");const i=await this.getDB(),n=i.transaction(["blobs"],"readwrite"),y=n.objectStore("blobs");return new Promise((h,B)=>{const K=y.put(s,e);this._onStart(K),K.onerror=()=>{B(),this._onFinish(K)},K.onsuccess=()=>{h(),this.broadcast({type:"set-blob",key:e}),this.emit("set-blob",e,s,!1),this._onFinish(K)}})}async deleteBlob(e){if(this.disabled)return;const s=await this.getDB(),i=s.transaction(["blobs"],"readwrite"),n=i.objectStore("blobs");return new Promise((y,h)=>{const B=n.delete(e);this._onStart(B),B.onerror=()=>{h(),this._onFinish(B)},B.onsuccess=()=>{y(),this.broadcast({type:"delete-blob",key:e}),this.emit("set-blob",e,void 0,!0),this._onFinish(B)}})}async hasBlob(e){return(await this.blobKeys()).includes(e)}async clearBlobs(){if(this.disabled)return;const e=await this.getDB(),s=e.transaction(["blobs"],"readwrite"),i=s.objectStore("blobs");return new Promise((n,y)=>{const h=i.clear();this._onStart(h),h.onerror=()=>{y(),this._onFinish(h)},h.onsuccess=()=>{n(),this.broadcast({type:"clear-blobs"}),this._onFinish(h)}})}async blobKeys(){const e=await this.getDB(),s=e.transaction(["blobs"],"readonly"),i=s.objectStore("blobs");return new Promise((n,y)=>{const h=i.getAllKeys();this._onStart(h),h.onerror=()=>{y(),this._onFinish(h)},h.onsuccess=()=>{Array.isArray(h.result)?n(h.result):y(),this._onFinish(h)}})}};z(zt,"IndexedDBProvider");let ie=zt;ie.priority=10,ie.title="IndexedDB",ie.description="[IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API) is available on most platforms, and has a slightly slower initialization time than Local Storage. IndexedDB has a higher storage capacity and is less likely to be cleared unexpectedly.";const re=(Ne=class extends q{constructor(e){super(e);const s=this.frame=document.createElement("iframe");s.src=this.manager.root.host==="youtube"?"//www.youtube.com/__ffz_bridge/":"//www.twitch.tv/p/ffz_bridge/",s.id="ffz-settings-bridge",s.style.width="0",s.style.height="0",this.onMessage=this.onMessage.bind(this),window.addEventListener("message",this.onMessage),document.body.appendChild(s)}static supported(){return Ce&&N}static hasContent(){return Ne.supported()}broadcastTransfer(){}disableEvents(){}onMessage(e){const s=e.data;!s||!s.ffz_type||this.handleMessage(s)}send(e,s){typeof e=="string"&&(e={ffz_type:e});try{this.frame.contentWindow.postMessage(e,"*",s?Array.isArray(s)?s:[s]:void 0)}catch(i){this.manager.log.error("Error sending message to bridge.",i,e,s)}}},z(Ne,"_CrossOriginStorageBridge2"),Ne);re.priority=100,re.title="Cross-Origin Storage Bridge",re.description="This provider uses an `<iframe>` to synchronize storage across subdomains. Due to the `<iframe>`, this provider takes longer than others to load, but should perform roughly the same once loaded. You should be using this on non-www subdomains of Twitch unless you don't want your settings to automatically synchronize for some reason.",re.allowTransfer=!1,re.shouldUpdate=!1;let me=re;const Pe=(We=class extends q{static supported(){return L.EXTENSION}static hasContent(){return We.supported()?new Promise(e=>{let s=!1,i=null;const n=z(h=>{if(h.source===window&&h.data&&h.data.type==="ffz_from_ext"){const B=h.data.data;B?.ffz_type==="has-keys"&&(s=!0,e(B.value),y())}},"listener"),y=z(()=>{s||(s=!0,e(!1)),i&&(clearTimeout(i),i=null),window.removeEventListener("message",n)},"cleanup");window.addEventListener("message",n),window.postMessage({type:"ffz_to_ext",data:{ffz_type:"check-has-keys"}},"*"),i=setTimeout(y,1e3)}):!1}constructor(e){super(e),this.onExtMessage=this.onExtMessage.bind(this),window.addEventListener("message",this.onExtMessage)}broadcastTransfer(){}disableEvents(){}onExtMessage(e){e.source===window&&e.data?.type==="ffz_from_ext"&&e.data.data?.ffz_type&&this.handleMessage(e.data.data)}send(e,s){typeof e=="string"&&(e={ffz_type:e});try{window.postMessage({type:"ffz_to_ext",data:e},"*",s?Array.isArray(s)?s:[s]:void 0)}catch(i){this.manager.log.error("Error sending message to extension.",i,e,s)}}},z(We,"_ExtensionProvider2"),We);Pe.priority=101,Pe.title="Browser Extension Storage",Pe.description="This provider uses a browser extension service worker to store settings in a location that should not suffer from issues due to storage partitioning or cache clearing.",Pe.allowTransfer=!0,Pe.shouldUpdate=!0;let Qe=null;const lt={local:ee,idb:ie,cosb:me},et={label:"Experiment Overrides",keys:["exp-lock","experiment-overrides"]},ct={label:"Hidden Emotes",keys(R){const e=["emote-menu.hidden-sets"];for(const s of R.keys())s.startsWith("hidden-emotes.")&&e.push(s);return e}},dt={label:"Favorited Emotes",keys(R){const e=[];for(const s of R.keys())s.startsWith("favorite-emotes.")&&e.push(s);return e}},tt={label:"Name and Color Overrides",keys:["overrides.colors","overrides.names"]},st={label:"Profiles",clear(R,e){const s=["profiles"];for(const i of R.keys())/^p:\d+:/.test(i)&&s.push(i);for(const i of s)R.delete(i);e.loadProfiles()}},ut={label:"Absolutely Everything",async clear(R,e){R.clear(),R.supportsBlobs&&R instanceof H&&await R.clearBlobs(),e.loadProfiles()}};function He(R,e){try{return R.postMessage(e,"*"),!0}catch{return!1}}z(He,"postMessage");const $e=["session"],xt=class xt extends F.default{constructor(e,s){super(e,s),this.provider=null,this._active_provider="local",this.disable_profiles=!1,this.providers={};for(const[i,n]of Object.entries(lt))n.supported()&&(this.providers[i]=n);Object.seal(this.providers),this.updateSoon=(0,d.debounce)(()=>this.updateRoutes(),50,!1);try{const i=new URL(window.location).searchParams;i&&i.has("ffz-no-settings")&&(this.disable_profiles=!0)}catch{}this.__ls_scheduled=new Set,this.__ls_cache=new Map,this.__ls_hooked=!1,this._updateLS=this._updateLS.bind(this),this.__contexts=[],this.__profiles=[],this.__profile_ids={},this.__profile_uuids={},this.ui_structures=new Map,this.definitions=new Map,this.validators={};for(const i in W)(0,d.has)(W,i)&&(this.validators[i]=W[i]);this.processors={};for(const i in V)(0,d.has)(V,i)&&(this.processors[i]=V[i]);this.clearables={};for(const i in k)(0,d.has)(k,i)&&(this.clearables[i]=k[i]);this.filters={};for(const i in g)(0,d.has)(g,i)&&g[i]&&(this.filters[i]=g[i]);this._createProvider().then(i=>{this.provider=i,this.log.info(`Using Provider: ${i.constructor.name}`),i.on("changed",this._onProviderChange,this),i.on("quota-exceeded",n=>{this.emit(":quota-exceeded")}),i.on("change-provider",()=>{this.emit(":change-provider")}),this._provider_resolve&&this._provider_resolve(i)}),this.main_context=new o(this),this.main_context.on("changed",(i,n,y)=>{this.emit(`:changed:${i}`,n,y)}),this.main_context.on("uses_changed",(i,n,y)=>{this.emit(`:uses_changed:${i}`,n,y)}),this.main_context.on("context_changed",()=>this._updateContextProxies()),this._context_proxies=new Set,window.addEventListener("message",i=>{const n=i.data?.ffz_type;n==="open-settings"?this.emit("main_menu:open"):n==="request-context"&&i.source&&(this._context_proxies.add(i.source),this._updateContextProxies(i.source))}),window.addEventListener("beforeunload",()=>{for(const i of this._context_proxies)He(i,{ffz_type:"context-gone"})}),this._start_time=performance.now(),this.enable()}_updateContextProxies(e){if(!e&&!this._context_proxies.size)return;const s=JSON.parse(JSON.stringify(this.main_context._context));for(const i of $e)(0,d.has)(s,i)&&delete s[i];if(e)He(e,{ffz_type:"context-update",ctx:s});else for(const i of this._context_proxies)He(i,{ffz_type:"context-update",ctx:s})}addFilter(e,s){if(this.filters[e])return this.log.warn("Tried to add already existing filter",e);this.filters[e]=s,this.updateRoutes()}getFilterBasicEditor(){return()=>Promise.all([I.e(6530),I.e(6940),I.e(2086)]).then(I.bind(I,47178))}generateLog(){const e=[];for(const[s,i]of this.main_context.__cache.entries())e.push(`${s}: ${JSON.stringify(i)}`);return e.join(`
`)}awaitProvider(){return this.provider?Promise.resolve(this.provider):this._provider_waiter?this._provider_waiter:this._provider_waiter=new Promise((e,s)=>{this._provider_resolve=e}).finally(()=>{this._provider_waiter=null,this._provider_resolve=null})}async onEnable(){if(await this.awaitProvider(),!this.provider)throw new Error("did not get provider");await this.provider.awaitReady(),this.on("site.router:updated-routes",this.updateRoutes,this),this.loadProfiles(!0);for(const s of this.__contexts)s.selectProfiles();const e=performance.now()-this._start_time;this.log.info(`Initialization complete after ${e.toFixed(5)}ms -- Values: ${this.provider.size} -- Profiles: ${this.__profiles.length}`),this.scheduleUpdates(),this.updateClock()}async createMonitorUpdate(){const e=g?.Monitor;if(!(!e||e.details!==void 0)){e.details=null;try{window.getScreenDetails?(e.details=await window.getScreenDetails(),e.details.addEventListener("currentscreenchange",()=>{for(const s of this.__contexts)s.selectProfiles()})):e.details=!1}catch(s){this.log.error("Unable to get monitor details",s),e.details=!1}}}updateClock(){const e=g?.Time?.captured?.();if(!e?.length)return;this._time_timer&&clearTimeout(this._time_timer);const s=new Date,i=s.getHours()*60+s.getMinutes();let n=this._time_next!=null?this._time_next:null;for(const h of e)h<=i||(n==null||h<n)&&(n=h);n==null&&(n=e[0]+1440);const y=(n-i)*60*1e3-59750+(6e4-Date.now()%6e4);this._time_timer=setTimeout(()=>{for(const h of this.__contexts)h.selectProfiles();this.updateClock()},y)}_updateLSKey(e){(this.__ls_cache.has(e)||this.__ls_cache.has(`raw.${e}`))&&(this.__ls_scheduled.add(e),this.__ls_timer||(this.__ls_timer=setTimeout(this._updateLS,0)))}_hookLS(){if(this.__ls_hooked)return;this.__ls_hooked=!0;const e=localStorage.setItem,s=this;localStorage.setItem=function(i,...n){try{s._updateLSKey(i)}catch{}return e.call(this,i,...n)},this._handleLSEvent=this._handleLSEvent.bind(this),window.addEventListener("storage",this._handleLSEvent)}_handleLSEvent(e){e.key&&e.storageArea===localStorage&&this._updateLSKey(e.key)}_updateLS(){clearTimeout(this.__ls_timer),this.__ls_timer=null;const e=this.__ls_scheduled;this.__ls_scheduled=new Set;for(const s of e){const i=this.__ls_cache.has(s),n=`raw.${s}`,y=this.__ls_cache.has(n);if(!y&&!i)continue;const h=localStorage.getItem(s);if(y&&(this.__ls_cache.set(n,h),this.emit(":ls-update",n,h)),i){let B;if(h)try{B=JSON.parse(h)}catch(K){this.log.warn(`Unable to parse localStorage value as JSON for "${s}"`,K)}this.__ls_cache.set(s,B),this.emit(":ls-update",s,B)}}}getLS(e){if(this.__ls_cache.has(e))return this.__ls_cache.get(e);this.__ls_hooked||this._hookLS();const s=e.startsWith("raw."),i=localStorage.getItem(s?e.slice(4):e);let n;if(s)n=i;else try{n=i?JSON.parse(i):null}catch(y){this.log.warn(`Unable to parse localStorage value as JSON for "${e}"`,y)}return this.__ls_cache.set(e,n),n}async generateBackupFile(){const e=new Date,s=`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`;if(await this._needsZipBackup()){const n=await this._getZipBackup();return new File([n],`ffz-settings (${s}).zip`,{type:"application/zip"})}const i=await this.getSettingsDump();return new File([JSON.stringify(i)],`ffz-settings (${s}).json`,{type:"application/json;charset=utf-8"})}async _needsZipBackup(){if(await this.awaitProvider(),!this.provider||(await this.provider.awaitReady(),!(this.provider instanceof H)||!this.provider.supportsBlobs))return!1;const e=await this.provider.blobKeys();return Array.isArray(e)?e.length>0:!1}async _getZipBackup(){if(await this.awaitProvider(),!this.provider)throw new Error("provider not available");await this.provider.awaitReady();const e=(await I.e(935).then(I.t.bind(I,29597,23))).default,s=new e,i=await this.getSettingsDump();s.file("settings.json",JSON.stringify(i));const n={};if(this.provider instanceof H&&this.provider.supportsBlobs){const y=await this.provider.blobKeys();for(const h of y){const B=encodeURIComponent(h),K=await this.provider.getBlob(h);if(!K)continue;const te={key:h};if(K instanceof File)te.type="file",te.name=K.name,te.modified=K.lastModified,te.mime=K.type;else if(K instanceof Blob)te.type="blob";else if(K instanceof ArrayBuffer)te.type="ab";else if(K instanceof Uint8Array)te.type="ui8";else continue;n[B]=te,s.file(`blobs/${B}`,K)}}return s.file("blobs.json",JSON.stringify(n)),s.generateAsync({type:"blob"})}async getSettingsDump(){if(await this.awaitProvider(),!this.provider)return null;await this.provider.awaitReady();const e={version:2,type:"full",values:{}};for(const[s,i]of this.provider.entries())e.values[s]=i;return e}scheduleUpdates(){this._update_timer&&clearTimeout(this._update_timer),this._update_timer=setTimeout(()=>this.checkUpdates(),5e3)}async checkUpdates(){if(await this.awaitProvider(),await this.provider?.awaitReady(),!this.provider?.shouldUpdate)return;const e=[];for(const n of this.__profiles){if(!n||!n.url||n.pause_updates)continue;const y=n.checkUpdate();e.push(y instanceof Promise?y:Promise.resolve(y))}const s=await Promise.all(e);let i=0;for(const n of s)n&&i++;this.log.info(`Successfully refreshed ${i} of ${s.length} profiles from remote URLs.`)}getProviders(){return this.providers}getActiveProvider(){return this._active_provider}async _createProvider(){let e=localStorage.ffzProviderv2;if(e==null&&(e=localStorage.ffzProviderv2=await this.sniffProvider()),this.providers[e]){const s=new this.providers[e](this);return this._active_provider=e,s}return this._active_provider="local",new ee(this)}async sniffProvider(){const e=Array.from(Object.entries(this.providers));e.sort((s,i)=>(i[1].priority??0)-(s[1].priority??0));for(const[s,i]of e)if(i.supported()&&await i.hasContent())return s;return"local"}async changeProvider(e,s){if(!this.providers[e]||!this.providers[e].supported())throw new Error(`Invalid provider: ${e}`);if(e===this._active_provider||!this.provider)return;const i=this.provider;if(this.provider=null,i.broadcastTransfer(),s){const n=new this.providers[e](this);if(await n.awaitReady(),n.allowTransfer&&i.allowTransfer){i.disableEvents(),n.clear(),n instanceof H&&n.supportsBlobs&&await n.clearBlobs(),await n.flush();for(const[y,h]of i.entries())n.set(y,h);if(i instanceof H&&i.supportsBlobs&&n instanceof H&&n.supportsBlobs){for(const y of await i.blobKeys()){const h=await i.getBlob(y);h&&await n.setBlob(y,h)}await i.clearBlobs()}i.clear(),await i.flush(),await n.flush()}}localStorage.ffzProviderv2=e,location.reload()}_onProviderChange(e,s,i){if(e==="profiles")return this.loadProfiles();if(!e.startsWith("p:"))return;e=e.slice(2);const n=e.indexOf(":");if(n===-1)return;const y=this.__profile_ids[e.slice(0,n)],h=e.slice(n+1);y&&!y.ephemeral&&(h===":enabled"?y.emit("toggled",y,i?!0:s):y.emit("changed",h,s,i))}updateRoutes(){for(const e of this.__profiles)e.clearMatcher();for(const e of this.__contexts)e.selectProfiles();this.updateClock()}_onProfileToggled(e,s){for(const i of this.__contexts)i.selectProfiles();this.updateClock(),this.emit(":profile-toggled",e,s)}profile(e){return this.__profile_uuids[e]??this.__profile_ids[e]??null}loadProfiles(e=!1){const s=this.__profile_ids,i=this.__profile_uuids,n=this.__profiles,y=this.__profile_ids={},h=this.__profiles=[],B=this.__profile_uuids={},K=new Set(n.map(pe=>pe.id)),te=new Set,ne=new Set;let oe=this.provider?.get("profiles")??[u.Z.Moderation,u.Z.Default];oe?.length||(this.provider?.delete("profiles"),oe=[u.Z.Moderation,u.Z.Default]);let Ae=!1;for(const pe of oe)pe.uuid||(Ae=!0,pe.i18n_key===u.Z.Default.i18n_key?pe.uuid=u.Z.Default.uuid:pe.i18n_key===u.Z.Moderation.i18n_key?pe.uuid=u.Z.Moderation.uuid:pe.uuid=(0,d.generateUUID)());Ae&&this.provider?.set("profiles",oe);let De=!1,ze=!1;for(const pe of n)pe.off("toggled",this._onProfileToggled,this),pe.hotkey_enabled=!1;for(const pe of oe){const Me=pe.id,Ee=h.length,xe=s[Me],Ut=xe?n.indexOf(xe):-1;if(K.delete(Me),Ut!==Ee&&(De=!0),xe&&(0,d.deep_equals)(xe.data,pe,!0)){Ut!==Ee&&(ze=!0),h.push(y[Me]=xe),B[xe.uuid]=xe;continue}const ke=y[Me]=new u.Z(this,pe);xe?(xe.transferListeners(ke),ne.add(Me)):te.add(Me),h.push(ke),B[ke.uuid]=ke,ze=!0}for(const pe of h)pe.on("toggled",this._onProfileToggled,this),pe.hotkey_enabled=!0;if(!(!ze&&!K.size||e)){for(const pe of this.__contexts)pe.selectProfiles();this.updateClock();for(const pe of te)this.emit(":profile-created",y[pe]);for(const pe of ne)this.emit(":profile-changed",y[pe]);De&&this.emit(":profiles-reordered")}}createProfile(e={}){if(!this.enabled)throw new Error("Unable to create profile before settings have initialized. Please await enable()");if(e.id!==void 0)throw new Error("You cannot specify an ID when creating a profile.");let s=0;for(;this.__profile_ids[s];)e.ephemeral?s--:s++;e.id=s,e.uuid=(0,d.generateUUID)(),e.name||(e.name=`Unnamed Profile ${this.__profiles.length+1}`);const i=this.__profile_ids[s]=new u.Z(this,e);return this.__profile_uuids[e.uuid]=i,this.__profiles.unshift(i),i.on("toggled",this._onProfileToggled,this),i.hotkey_enabled=!0,i.ephemeral||this._saveProfiles(),this.emit(":profile-created",i),i}deleteProfile(e){if(!this.enabled)throw new Error("Unable to delete profile before settings have initialized. Please await enable()");if(typeof e=="object"&&typeof e.id=="number")e=e.id;else if(typeof e!="number")throw new Error("Invalid profile");const s=this.__profile_ids[e];if(!s)return;if(this.__profiles.length===1)throw new Error("cannot delete only profile");s.off("toggled",this._onProfileToggled,this),s.clear(),this.__profile_ids[e]=null,this.__profile_uuids[s.uuid]=null;const i=this.__profiles.indexOf(s);i!==-1&&this.__profiles.splice(i,1),s.ephemeral||this._saveProfiles(),this.emit(":profile-deleted",s)}moveProfile(e,s){if(!this.enabled)throw new Error("Unable to move profiles before settings have initialized. Please await enable()");if(typeof e=="object"&&typeof e.id=="number")e=e.id;else if(typeof e!="number")throw new Error("Invalid profile");const i=this.__profile_ids[e];if(!i)return;const n=this.__profiles,y=n.indexOf(i);y!==s&&(n.splice(s,0,...n.splice(y,1)),i.ephemeral||this._saveProfiles(),this.emit(":profiles-reordered"))}saveProfile(e){if(!this.enabled)throw new Error("Unable to save profile before settings have initialized. Please await enable()");if(typeof e=="object"&&typeof e.id=="number")e=e.id;else if(typeof e!="number")throw new Error("Invalid profile");const s=this.__profile_ids[e];s&&(s.ephemeral||this._saveProfiles(),this.emit(":profile-changed",s))}_saveProfiles(){const e=this.__profiles.filter(s=>!s.ephemeral).map(s=>s.data);if(!e){this.createProfile({name:"Default Profile",i18n_key:"setting.profiles.default",description:"Settings that apply everywhere on Twitch."});return}this.provider?.set("profiles",e);for(const s of this.__contexts)s.selectProfiles();this.updateClock()}context(e){return this.main_context.context(e)}get(e){return this.main_context.get(e)}getChanges(e,s,i){return this.main_context.getChanges(e,s,i)}onChange(e,s,i){return this.main_context.onChange(e,s,i)}uses(e){return this.main_context.uses(e)}update(e){return this.main_context.update(e)}updateContext(e){return this.main_context.updateContext(e)}setContext(e){return this.main_context.setContext(e)}getAddonProxy(e,s,i){if(!e)return this;const n={},y=L.DEBUG||s?.dev;return n.add=(h,B)=>this.add(h,B,e),n.addUI=(h,B)=>this.addUI(h,B,e),n.addClearable=(h,B)=>this.addClearable(h,B,e),(0,F.buildAddonProxy)(i,this,"settings",n)}add(e,s,i){const n=this.definitions.get(e),y=(Array.isArray(n)?n:n?.required_by)??[];s.required_by=y,s.requires=s.requires??[],s.__source=i;for(const h of s.requires){const B=this.definitions.get(h);Array.isArray(B)?B.push(e):B?B.required_by?.push(e):this.definitions.set(h,[e])}if(s.ui){const h=s.ui;if(h.path_tokens=h.path_tokens?Ke(h.path_tokens):h.path?(0,C.Q)(h.path):void 0,i&&h.path_tokens&&h.path_tokens.length>=2&&h.path_tokens[0].key==="add_ons"){const B=this.resolve("addons"),K=B?.getAddon(i);if(K){const te=h.path_tokens[1],ne=[];ne.push(`add_ons.changelog.${i}`),K.short_name&&ne.push(`add_ons.changelog.${K.short_name.toSnakeCase()}`),K.name&&ne.push(`add_ons.changelog.${K.name.toSnakeCase()}`),te.header_links=[{navigate:ne,i18n_key:"home.changelog",title:"Changelog"}]}}if(!h.key&&e&&(h.key=e),!h.key&&h.title&&(h.key=h.title.toSnakeCase()),(h.component==="setting-select-box"||h.component==="setting-combo-box")&&Array.isArray(h.data)&&!h.no_i18n){const B=`${h.i18n_key||`setting.entry.${e}`}.values`;for(const K of h.data)K.i18n_key===void 0&&K.value!==void 0&&(K.i18n_key=`${B}.${K.value}`)}}s.changed&&this.on(`:changed:${e}`,s.changed),this.definitions.set(e,s),(!n||Array.isArray(n))&&this.emit(":added-definition",e,s)}remove(e){const s=this.definitions.get(e);if(s&&!Array.isArray(s)){if(Array.isArray(s.required_by)&&s.required_by.length>0?this.definitions.set(e,s.required_by):this.definitions.delete(e),Array.isArray(s.requires))for(const i of s.requires){let n=this.definitions.get(i);if(Array.isArray(n)){const y=n.indexOf(e);y!==-1&&n.splice(y,1)}else n?.required_by&&(n=n.required_by)}s.changed&&this.off(`:changed:${e}`,s.changed),this.emit(":removed-definition",e,s)}}addUI(e,s,i){let n;s.ui?n=s:n={ui:s},n.__source=i;const y=n.ui;y.path_tokens=y.path_tokens?Ke(y.path_tokens):y.path?(0,C.Q)(y.path):void 0,!y.key&&y.title&&(y.key=y.title.toSnakeCase());const h=this.ui_structures.get(e);this.ui_structures.set(e,n),h||this.emit(":added-definition",e,n)}addClearable(e,s,i){if(typeof e=="object"){for(const[n,y]of Object.entries(e))this.addClearable(n,y,i);return}else if(typeof e!="string")throw new Error("invalid key");s&&(s.__source=i,this.clearables[e]=s)}getClearables(){return(0,d.deep_copy)(this.clearables)}addProcessor(e,s){if(typeof e=="object"){for(const[i,n]of Object.entries(e))this.addProcessor(i,n);return}else if(typeof e!="string")throw new Error("invalid key");s&&(this.processors[e]=s)}getProcessor(e){return this.processors[e]??null}getProcessors(){return(0,d.deep_copy)(this.processors)}addValidator(e,s){if(typeof e=="object"){for(const[i,n]of Object.entries(e))this.addValidator(i,n);return}else if(typeof e!="string")throw new Error("invalid key");s&&(this.validators[e]=s)}getValidator(e){return this.validators[e]??null}getValidators(){return(0,d.deep_copy)(this.validators)}};z(xt,"SettingsManager");let Re=xt;function Ke(R){for(let e=0,s=R.length;e<s;e++){const i=R[e];if(typeof i=="string"){R[e]={key:i.toSnakeCase(),title:i};continue}i.key||(i.key=i.title.toSnakeCase())}return R}z(Ke,"format_path_tokens");var ae=I(44589),Te=I(83269);const Tt=class Tt extends F.default{constructor(e,s){super(e,s),this.i18n=null,this.load_tracker=null,this.settings=null,this.should_enable=!0,this.inject("settings"),this.inject("i18n"),this.inject("load_tracker"),this.load_requires=["settings"],this.target=this.parent.flavor||"unknown",this.has_dev=!1,this.reload_required=!1,this.addons={},this.enabled_addons=[],this.versions={},this.load_tracker.schedule("chat-data","addon-initial")}onLoad(){this._loader=this.loadAddonData()}onEnable(){this.settings.addUI("add-ons",{path:'Add-Ons @{"description": "Add-Ons are additional modules, often written by other people, that can be loaded automatically by FrankerFaceZ to add new capabilities and behaviors to the extension and Twitch.", "profile_warning": false}',component:"addon-list",title:"Add-Ons",no_filter:!0,getExtraTerms:()=>Object.values(this.addons).map(e=>e.search_terms),getFFZ:()=>this,isReady:()=>this.enabled,getAddons:()=>Object.values(this.addons),getVersions:()=>(0,d.deep_copy)(this.versions),hasAddon:e=>this.hasAddon(e),getVersion:e=>this.getVersion(e),doesAddonTarget:e=>this.doesAddonTarget(e),isAddonEnabled:e=>this.isAddonEnabled(e),isAddonExternal:e=>this.isAddonExternal(e),enableAddon:e=>this.enableAddon(e),disableAddon:e=>this.disableAddon(e),reloadAddon:e=>this.reloadAddon(e),canReloadAddon:e=>this.canReloadAddon(e),isReloadRequired:()=>this.reload_required,refresh:()=>window.location.reload(),on:(...e)=>this.on(...e),off:(...e)=>this.off(...e)}),L.EXTENSION||this.settings.add("addons.dev.server",{default:!1,ui:{path:"Add-Ons >> Development",title:"Use Local Development Server",description:"Attempt to load add-ons from local development server on port 8001.",component:"setting-check-box"}}),this.on("i18n:update",this.rebuildAddonSearch,this),this.settings.provider.on("changed",this.onProviderChange,this),this._loader?.then(()=>{this.enabled_addons=this.settings.provider.get("addons.enabled",[]);for(const e of this.enabled_addons)this.hasAddon(e)&&this.doesAddonTarget(e)&&this._enableAddon(e).catch(s=>{this.log.error(`An error occured while enabling the add-on "${e}":`,s),this.log.capture(s)});this.load_tracker.notify("chat-data","addon-initial"),this.emit(":ready")})}doesAddonTarget(e){const s=this.getAddon(e);if(!s)return!1;const i=s.targets??["main"];return Array.isArray(i)?i.includes(this.target):!1}generateLog(){const e=["Known"];for(const[s,i]of Object.entries(this.addons)){if(Array.isArray(i))continue;const n=this.versions[s];e.push(`${s} | ${this.isAddonEnabled(s)?"enabled":"disabled"} | ${n?`${n} | `:""}${i.dev?"dev | ":""}${this.isAddonExternal(s)?"external | ":""}${i.short_name} v${i.version}`)}e.push(""),e.push("Modules");for(const[s,i]of Object.entries(this.__modules))i&&e.push(`${i.loaded?"loaded  ":i.loading?"loading ":"unloaded"} | ${i.enabled?"enabled ":i.enabling?"enabling":"disabled"} | ${s}`);return e.join(`
`)}onProviderChange(e,s){if(e!="addons.enabled")return;const i=Array.isArray(s)?s:[],n=[...this.enabled_addons];for(const y of n)i.includes(y)||this.disableAddon(y,!1);for(const y of i)n.includes(y)||this.enableAddon(y,!1)}async loadAddonData(){const[e,s]=await Promise.all([(0,d.fetchJSON)(`${L.SERVER_OR_EXT}/addons.json?_=${(0,Te.getBuster)(30)}`),!L.EXTENSION&&this.settings.get("addons.dev.server")?(0,d.fetchJSON)(`https://localhost:8001/script/addons.json?_=${(0,Te.getBuster)()}`):null]);if(Array.isArray(e)){const i=`${L.SERVER_OR_EXT}/addons/`;for(const n of e)n.icon&&(n.icon=new URL(n.icon,i).toString()),this.addAddon(n,!1)}if(Array.isArray(s)){this.has_dev=!0;for(const i of s)this.addAddon(i,!0)}this.settings.updateContext({addonDev:this.has_dev}),this.rebuildAddonSearch(),this.emit(":data-loaded")}setVersion(e,s){this.versions[e]=s}addAddon(e,s=!1){let i=e;const n=this.addons[i.id];this.addons[i.id]=i,i.name=i.name??i.id,i.dev=s,i.requires=i.requires||[],i.required_by=Array.isArray(n)?n:n&&n.required_by||[],i.updated&&(i.updated=new Date(i.updated)),i.created&&(i.created=new Date(i.created)),i._search=i.search_terms;for(const y of i.requires){const h=this.addons[y];Array.isArray(h)?h.push(i.id):h?h.required_by.push(i.id):this.addons[y]=[i.id]}(!n||Array.isArray(n))&&this.settings.addUI(`addon-changelog.${i.id}`,{path:`Add-Ons > Changelog > ${i.name}`,component:"changelog",force_seen:!0,addons:!0,addon:(0,d.deep_copy)(i),getFFZ:()=>this,getVersion:()=>this.versions[i.id]}),this.emit(":added",i.id,i)}rebuildAddonSearch(){for(const e of Object.values(this.addons)){if(Array.isArray(e))continue;const s=new Set([e._search,e.name,e.short_name,e.author,e.description]);this.i18n.locale!=="en"&&(e.name_i18n&&s.add(this.i18n.t(e.name_i18n,e.name)),e.short_name_i18n&&s.add(this.i18n.t(e.short_name_i18n,e.short_name)),e.author_i18n&&s.add(this.i18n.t(e.author_i18n,e.author)),e.maintainer_i18n&&s.add(this.i18n.t(e.maintainer_i18n,e.maintainer)),e.description_i18n&&s.add(this.i18n.t(e.description_i18n,e.description))),e.search_terms=[...s].map(i=>i?i.toLocaleLowerCase():"").join(`
`)}}isAddonEnabled(e){return this.isAddonExternal(e)?!0:this.enabled_addons.includes(e)}getAddon(e){const s=this.addons[e]??null;return Array.isArray(s)?null:s}hasAddon(e){return this.getAddon(e)!=null}getVersion(e){const s=this.getAddon(e);if(!s)throw new Error(`Unknown add-on id: ${e}`);const i=this.resolve(`addon.${e}`);if(i){if("version"in i)return i.version;if(i.constructor&&"version"in i.constructor)return i.constructor.version}return s.version}isAddonExternal(e){if(!this.hasAddon(e))throw new Error(`Unknown add-on id: ${e}`);const s=this.resolve(`addon.${e}`);return s?document.head.querySelector(`script#ffz-loaded-addon-${e}`)?s.external||s.constructor?.external:!0:!1}canReloadAddon(e){if(!this.hasAddon(e))throw new Error(`Unknown add-on id: ${e}`);let s=this.resolve(`addon.${e}`);if(!s||!s.canDisable()||!s.canUnload())return!1;if(s.children){for(const i of Object.values(s.children))if(!i.canDisable()||!i.canUnload())return!1}return!0}async fullyUnloadModule(e){if(!(!e||!e.addon_id)){if(e.children)for(const s of Object.values(e.children))await this.fullyUnloadModule(s);await e.disable(),await e.unload(),e.parent instanceof F.default&&e.parent.children[e.name]===e&&delete e.parent.children[e.name];for(const s of e.references){const i=this.resolve(s[0]),n=s[1];i[n]===e&&(i[n]=null)}this.emit(":fully-unload",e.addon_id),this.__modules[e.__path]===e&&delete this.__modules[e.__path],this.off(void 0,void 0,e);for(const s of this.settings.__contexts)s.off(void 0,void 0,e);for(const[s,i]of Array.from(this.settings.definitions.entries()))!Array.isArray(i)&&i?.__source===e.addon_id&&this.settings.remove(s);e.__log=null}}async reloadAddon(e){const s=this.getAddon(e),i=this.resolve("site.menu_button");if(!s)throw new Error(`Unknown add-on id: ${e}`);const n=performance.now();let y=this.resolve(`addon.${e}`);if(y)try{await this.fullyUnloadModule(y)}catch(K){throw i&&i.addToast({title_i18n:"addons.reload.toast-error",title:"Error Reloading Add-On",text_i18n:"addons.reload.toast-error.unload",text:`Unable to unload existing modules for add-on "{addon_id}":

{error}`,icon:"ffz-i-attention",addon_id:e,error:String(K)}),K}let h=document.querySelector(`script#ffz-loaded-addon-${s.id}`);h&&h.remove(),window.ffzAddonsWebpackJsonp&&(window.ffzAddonsWebpackJsonp=void 0);try{await this._enableAddon(e)}catch(K){throw i&&i.addToast({title_i18n:"addons.reload.toast-error",title:"Error Reloading Add-On",text_i18n:"addons.reload.toast-error.reload",text:`Unable to load new module for add-on "{addon_id}":

{error}`,error:String(K),icon:"ffz-i-attention",addon_id:e}),K}const B=performance.now();i&&i.addToast({title_i18n:"addons.reload.toast",title:"Reloaded Add-On",text_i18n:"addons.reload.toast.text",text:'Successfully reloaded add-on "{addon_id}" in {duration}ms.',icon:"ffz-i-info",addon_id:e,timeout:5e3,duration:Math.round(100*(B-n))/100})}async _enableAddon(e){const s=this.getAddon(e);if(!s)throw new Error(`Unknown add-on id: ${e}`);if(Array.isArray(s.load_events))for(const n of s.load_events)this.load_tracker.schedule(n,`addon.${e}`);await this.loadAddon(e);const i=this.resolve(`addon.${e}`);if(i&&!i.enabled&&await i.enable(),Array.isArray(s.load_events))for(const n of s.load_events)this.load_tracker.notify(n,`addon.${e}`,!1)}async loadAddon(e){const s=this.getAddon(e);if(!s)throw new Error(`Unknown add-on id: ${e}`);await this.i18n.loadChunk(`addon.${e}`);let i=this.resolve(`addon.${e}`);if(i){i.loaded||await i.load(),this.emit(":addon-loaded",e);return}document.head.appendChild((0,ae.createElement)("script",{id:`ffz-loaded-addon-${s.id}`,type:"text/javascript",src:s.src||`${s.dev?"https://localhost:8001/script":L.SERVER_OR_EXT}/addons/${s.id}/script.js?_=${(0,Te.getBuster)(30)}`,crossorigin:"anonymous"})),await(0,d.timeout)(this.waitFor(`addon.${e}:registered`),6e4),i=this.resolve(`addon.${e}`),i&&!i.loaded&&await i.load(),this.emit(":addon-loaded",e)}unloadAddon(e){const s=this.resolve(`addon.${e}`);if(s)return s.unload()}enableAddon(e,s=!0){const i=this.getAddon(e);if(!i)throw new Error(`Unknown add-on id: ${e}`);if(!this.isAddonEnabled(e)){if(Array.isArray(i.requires))for(const n of i.requires){if(!this.hasAddon(n))throw new Error(`Unknown add-on id: ${n}`);this.enableAddon(n)}this.emit(":addon-enabled",e),this.enabled_addons.push(e),s&&this.settings.provider.set("addons.enabled",this.enabled_addons),this.doesAddonTarget(e)&&this._enableAddon(e).catch(n=>{this.log.error(`An error occured while enabling the add-on "${e}":`,n),this.log.capture(n)})}}async disableAddon(e,s=!0){const i=this.getAddon(e);if(!i)throw new Error(`Unknown add-on id: ${e}`);if(this.isAddonExternal(e))throw new Error(`Cannot disable external add-on with id: ${e}`);if(this.isAddonEnabled(e)){if(Array.isArray(i.required_by)){const n=[];for(const y of i.required_by)n.push(this.disableAddon(y));await Promise.all(n)}this.emit(":addon-disabled",e),this.enabled_addons.splice(this.enabled_addons.indexOf(e),1),s&&this.settings.provider.set("addons.enabled",this.enabled_addons);try{const n=this.resolve(`addon.${e}`);n&&await n.disable()}catch{this.reload_required=!0,this.emit(":reload-required")}}}};z(Tt,"AddonManager");let Be=Tt;/*! js-cookie v3.0.5 | MIT */function Le(R){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var i in s)R[i]=s[i]}return R}z(Le,"js_cookie_assign");var it={read:function(R){return R[0]==='"'&&(R=R.slice(1,-1)),R.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(R){return encodeURIComponent(R).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Ie(R,e){function s(n,y,h){if(!(typeof document>"u")){h=Le({},e,h),typeof h.expires=="number"&&(h.expires=new Date(Date.now()+h.expires*864e5)),h.expires&&(h.expires=h.expires.toUTCString()),n=encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var B="";for(var K in h)h[K]&&(B+="; "+K,h[K]!==!0&&(B+="="+h[K].split(";")[0]));return document.cookie=n+"="+R.write(y,n)+B}}z(s,"set");function i(n){if(!(typeof document>"u"||arguments.length&&!n)){for(var y=document.cookie?document.cookie.split("; "):[],h={},B=0;B<y.length;B++){var K=y[B].split("="),te=K.slice(1).join("=");try{var ne=decodeURIComponent(K[0]);if(h[ne]=R.read(te,ne),n===ne)break}catch{}}return n?h[n]:h}}return z(i,"get2"),Object.create({set:s,get:i,remove:function(n,y){s(n,"",Le({},y,{expires:-1}))},withAttributes:function(n){return Ie(this.converter,Le({},this.attributes,n))},withConverter:function(n){return Ie(Le({},this.converter,n),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(R)}})}z(Ie,"init");var Ve=Ie(it,{path:"/"}),Qt=I(99968),es=I.n(Qt);const ft="experiment_overrides",Wt={expires:7,domain:".twitch.tv"},ts=I(77074);var ss=(R=>(R[R.Unknown=0]="Unknown",R[R.Device=1]="Device",R[R.User=2]="User",R[R.Channel=3]="Channel",R))(ss||{});function Es(R){return"t"in R}z(Es,"isTwitchExperiment");function Ss(R){return"description"in R}z(Ss,"isFFZExperiment");function Zt(R,e){return R.rarity<e.rarity?-1:R.rarity>e.rarity?1:R.name<e.name?-1:R.name>e.name?1:0}z(Zt,"sortExperimentLog");const nt=class nt extends F.default{constructor(e,s){super(e,s),this.settings=null,this.get=this.getAssignment,this.inject("settings"),this.settings.addUI("experiments",{path:"Debugging > Experiments",component:"experiments",no_filter:!0,getExtraTerms:()=>{const i=[];for(const[n,y]of Object.entries(this.experiments))i.push(n),y.name&&i.push(y.name),y.description&&i.push(y.description);for(const[n,y]of Object.entries(this.getTwitchExperiments()))i.push(n),y.name&&i.push(y.name);return i},is_locked:()=>this.getControlsLocked(),unlock:()=>this.unlockControls(),unique_id:()=>this.unique_id,ffz_data:()=>(0,d.deep_copy)(this.experiments),twitch_data:()=>(0,d.deep_copy)(this.getTwitchExperiments()),usingTwitchExperiment:i=>this.usingTwitchExperiment(i),getTwitchAssignment:i=>this.getTwitchAssignment(i),getTwitchType:i=>this.getTwitchType(i),hasTwitchOverride:i=>this.hasTwitchOverride(i),setTwitchOverride:(i,n)=>this.setTwitchOverride(i,n),deleteTwitchOverride:i=>this.deleteTwitchOverride(i),getAssignment:i=>this.getAssignment(i),hasOverride:i=>this.hasOverride(i),setOverride:(i,n)=>this.setOverride(i,n),deleteOverride:i=>this.deleteOverride(i),on:(...i)=>this.on(...i),off:(...i)=>this.off(...i)}),this.unique_id=Ve.get("unique_id"),this.Cookie=Ve,this.experiments={},this.cache=new Map}getControlsLocked(){if(L.DEBUG)return!1;const e=this.settings.provider.get("exp-lock",0);return isNaN(e)||!isFinite(e)?!0:Date.now()-e>=864e5}unlockControls(){this.settings.provider.set("exp-lock",Date.now())}async onLoad(){await this.loadExperiments()}async loadExperiments(){let e;try{e=await(0,d.fetchJSON)(L.DEBUG?ts:`${L.SERVER}/script/experiments.json?_=${(0,Te.getBuster)()}`)}catch(n){this.log.warn("Unable to load experiment data.",n);return}if(!e)return;this.experiments=e;const s=this.cache;this.cache=new Map;let i=0;for(const[n,y]of s.entries()){const h=this.getAssignment(n);y!==h&&(i++,this.emit(":changed",n,h,y),this.emit(`:changed:${n}`,h,y))}this.log.info(`Loaded information on ${Object.keys(e).length} experiments.${i>0?` ${i} values updated.`:""}`)}onEnable(){this.on("pubsub:command:reload_experiments",this.loadExperiments,this),this.on("pubsub:command:update_experiment",e=>{this.updateExperiment(e.key,e.data)},this)}updateExperiment(e,s){if(this.log.info(`Received updated data for experiment "${e}" via PubSub.`,s),Array.isArray(s)){const i=this.experiments[e];if(!i)return;i.groups=s}else s?.groups&&(this.experiments[e]=s);this._rebuildKey(e)}generateLog(){const e=[`Unique ID: ${this.unique_id}`,""],s=[];for(const[y,h]of Object.entries(this.experiments)){const B=this.getAssignment(y),K=this.hasOverride(y);let te=0,ne=0;for(const oe of h.groups)oe.value===B&&(te=oe.weight),ne+=oe.weight;!K&&te===ne||s.push({key:y,name:h.name,value:B,override:K,rarity:te/ne})}s.sort(Zt);for(const y of s)e.push(`FFZ | ${y.name}: ${y.value}${y.override?" (Override)":""} (r:${y.rarity})`);const i=[],n=this.settings.get("context.channel");for(const[y,h]of Object.entries(this.getTwitchExperiments())){if(!this.usingTwitchExperiment(y))continue;const B=this.getTwitchAssignment(y),K=this.hasTwitchOverride(y);let te=0,ne=0;for(const oe of h.groups)oe.value===B&&(te=oe.weight),ne+=oe.weight;!K&&te===ne||i.push({key:y,name:h.name,value:B,override:K,type:this.getTwitchTypeByKey(y),rarity:te/ne})}i.sort(Zt);for(const y of i)e.push(`Twitch | ${y.name}: ${y.value}${y.override?" (Override)":""} (r:${y.rarity}, t:${y.type}${y.type==="channel_id"?`, c:${n}`:""})`);return e.join(`
`)}getTwitchType(e){const s=this.resolve("site")?.getCore?.();return s?.experiments?.getExperimentType?s.experiments.getExperimentType(e):e===1?"device_id":e===2?"user_id":e===3?"channel_id":e}getTwitchTypeByKey(e){const s=this.getTwitchExperiments(),i=s?.[e];return i?.t?this.getTwitchType(i.t):null}getTwitchExperiments(){if(window.__twilightSettings)return window.__twilightSettings.experiments??{};const e=this.resolve("site")?.getCore?.();return e&&e.experiments.experiments||{}}usingTwitchExperiment(e){const s=this.resolve("site")?.getCore?.();return s&&(0,d.has)(s.experiments.assignments,e)}_getOverrideCookie(){const e=Ve.get(ft);let s;try{s=e?JSON.parse(e):{}}catch{s={}}return s.experiments||(s.experiments={}),s.disabled||(s.disabled=[]),s}_saveOverrideCookie(e){e&&(!e.experiments||!Object.keys(e.experiments).length)&&(!e.disabled||!e.disabled.length)&&(e=void 0),e?Ve.set(ft,JSON.stringify(e),Wt):Ve.remove(ft,Wt)}_checkExternalAccess(){let e;try{e=new Error().stack}catch(i){try{e=i.stack}catch{}}if(!e)return;e=e.split(/\s*\n+\s*/g).filter(i=>i.startsWith("at "));let s=!1;for(const i of e)if(!i.includes(L.SERVER_OR_EXT)){s=!0;break}s&&this.log.warn("Detected access by external script.")}setTwitchOverride(e,s){const i=this._getOverrideCookie(),n=i.experiments,y=i.disabled;this._checkExternalAccess(),n[e]=s;const h=y.indexOf(e);h!=-1&&y.splice(h,1),this._saveOverrideCookie(i);const B=this.resolve("site")?.getCore?.();B&&(B.experiments.overrides[e]=s),this._rebuildTwitchKey(e,!0,s)}deleteTwitchOverride(e){const s=this._getOverrideCookie(),i=s.experiments;if(this._checkExternalAccess(),!(0,d.has)(i,e))return;const n=i[e];delete i[e],this._saveOverrideCookie(s);const y=this.resolve("site")?.getCore?.();y&&delete y.experiments.overrides[e],this._rebuildTwitchKey(e,!1,n)}hasTwitchOverride(e){const s=this._getOverrideCookie(),i=s.experiments;return(0,d.has)(i,e)}getTwitchAssignment(e,s=null){const i=this.resolve("site")?.getCore?.(),n=i&&i.experiments;if(!n)return null;if(!n.hasInitialized&&n.initialize)try{n.initialize()}catch(B){this.log.warn("Error attempting to initialize Twitch experiments tracker.",B)}if(n.overrides&&n.overrides[e])return n.overrides[e];const y=n.experiments[e],h=this.getTwitchType(y?.t??0);return h==="channel_id"?n.getAssignmentById(e,{bucketing:{type:1,value:s??this.settings.get("context.channelID")}}):n.assignments?.[e]?n.assignments[e]:h==="device_id"?n.selectTreatment(e,y,this.unique_id):h==="user_id"?n.selectTreatment(e,y,this.resolve("site")?.getUser?.()?.id):null}getTwitchKeyFromName(e){const s=this.getTwitchExperiments();if(s){e=e.toLowerCase();for(const i in s)if((0,d.has)(s,i)){const n=s[i];if(n&&n.name&&n.name.toLowerCase()===e)return i}}}getTwitchAssignmentByName(e,s=null){const i=this.getTwitchKeyFromName(e);return i?this.getTwitchAssignment(i,s):null}_rebuildTwitchKey(e,s,i){const n=this.resolve("site")?.getCore?.(),y=n.experiments,h=(0,d.has)(y.assignments,e)?y.assignments[e]:null;if(h!==i){const B=s?i:h;this.emit(":twitch-changed",e,B,h),this.emit(`:twitch-changed:${e}`,B,h)}}setOverride(e,s){const i=this.settings.provider.get("experiment-overrides",{});i[e]=s,this.settings.provider.set("experiment-overrides",i),this._rebuildKey(e)}deleteOverride(e){const s=this.settings.provider.get("experiment-overrides");!s||!(0,d.has)(s,e)||(delete s[e],Object.keys(s).length?this.settings.provider.set("experiment-overrides",s):this.settings.provider.delete("experiment-overrides"),this._rebuildKey(e))}hasOverride(e){const s=this.settings.provider.get("experiment-overrides");return s?(0,d.has)(s,e):!1}getAssignment(e){if(this.cache.has(e))return this.cache.get(e);const s=this.experiments[e];if(!s)return this.log.warn(`Tried to get assignment for experiment "${e}" which is not known.`),null;const i=this.settings.provider.get("experiment-overrides"),n=i&&(0,d.has)(i,e)?i[e]:nt.selectGroup(e,s,this.unique_id??"");return this.cache.set(e,n),n}_rebuildKey(e){if(!this.cache.has(e))return;const s=this.cache.get(e);this.cache.delete(e);const i=this.getAssignment(e);i!==s&&(this.emit(":changed",e,i,s),this.emit(`:changed:${e}`,i,s))}static selectGroup(e,s,i){const n=e+i+(s.seed||""),y=s.groups.reduce((B,K)=>B+K.weight,0);let h=(es()(n).words[0]>>>0)/Math.pow(2,32);for(const B of s.groups)if(h-=B.weight/y,h<=0)return B.value;return null}};z(nt,"ExperimentManager");let ht=nt;var is=I(2356);const rs=z((R,e)=>fetch(R,e).then(s=>s.ok?s.json():null).catch(()=>null),"fetchJSON"),ns=/\s*at\s+(.+?)\s+\((.+)\)$/,os=/^(.+):\/\/(.+?)(?:\?[a-zA-Z0-9]+)?:(\d+:\d+)$/,Ht={filter(R){return R.includes(".frankerfacez.com")||R.includes("localhost")},cacheGlobally:!0},as=["/src/i18n.js","/src/utilities/vue.js"],ls=["(\u30FB`\u03C9\xB4\u30FB)",";;w;;","owo","ono","oAo","oxo","ovo;","UwU",">w<","^w^","> w >","v.v"],rt=z((R,e)=>R.map(s=>{if(typeof s=="string")return e(s);if(typeof s=="object"&&s.o){const i=Object.assign(s,{o:{}});for(const n of Object.keys(s.o))i.o[n]=rt(s.o[n],e)}return s}),"transformText"),cs=z(R=>R.replace(/(?:r|l)/g,"w").replace(/(?:R|L)/g,"W").replace(/n([aeiou])/g,"ny$1").replace(/N([aeiou])/g,"Ny$1").replace(/N([AEIOU])/g,"NY$1").replace(/ove/g,"uv").replace(/!+/g,` ${(0,d.pick_random)(ls)} `),"owo"),Kt={double:(R,e)=>[...e," ",...e],upper:(R,e)=>rt(e,s=>s.toUpperCase()),lower:(R,e)=>rt(e,s=>s.toLowerCase()),append_key:(R,e)=>[...e,` (${R})`],set_key:R=>[R],owo:(R,e)=>rt(e,cs)},Dt=class Dt extends F.default{constructor(...e){super(...e),this.inject("settings"),this._seen=new Set,this.availableLocales=["en"],this.chunks=["client"],this.localeData={en:{name:"English"}},this.loadLocales(),this.strings_loaded=!1,this.new_strings=0,this.changed_strings=0,this.capturing=!1,this.captured=new Map,this.settings.addUI("i18n.debug.open",{path:"Debugging > Localization >> Editing",component:"i18n-open",force_seen:!0}),this.settings.add("i18n.debug.capture",{default:null,process(s,i){return i===null?L.DEBUG:i},ui:{path:"Debugging > Localization >> General",title:"Enable message capture.",description:"Capture all localized strings, including variables and call locations, for the purpose of reporting them to the backend. This is used to add new strings to the translation project. By default, message capture is enabled when running in development mode.",component:"setting-check-box",force_seen:!0},changed:s=>{this.capturing=s}}),this.settings.add("i18n.debug.transform",{default:null,ui:{path:"Debugging > Localization >> General",title:"Transformation",description:"Transform all localized strings to test string coverage as well as length.",component:"setting-select-box",data:[{value:null,title:"Disabled"},{value:"upper",title:"Upper Case"},{value:"lower",title:"Lower Case"},{value:"append_key",title:"Append Key"},{value:"set_key",title:"Set to Key"},{value:"double",title:"Double"},{value:"owo",title:"owo what's this"}]},changed:s=>{this._.transformation=Kt[s],this.emit(":transform"),this.emit(":update")}}),this.settings.add("i18n.locale",{default:-1,process:(s,i)=>{if((i===-1||typeof i!="string")&&(i=s.get("context.session.languageCode")||"en"),this.availableLocales.includes(i))return i;if(i==="no"&&this.availableLocales.includes("nb"))return"nb";const n=i.indexOf("-");return n===-1?"en":(i=i.slice(0,n),this.availableLocales.includes(i)?i:"en")},ui:{path:'Appearance > Localization >> General @{"sort":-100}',title:"Language",description:"FrankerFaceZ is lovingly translated by volunteers from our community. Thank you. If you're interested in helping to translate FrankerFaceZ, please [join our Discord](https://discord.gg/UrAkGhT) and ask about localization.",component:"setting-select-box",data:(s,i)=>this.getLocaleOptions(i)},changed:s=>this.locale=s}),this.settings.add("i18n.format.date",{default:"default",ui:{path:"Appearance > Localization >> Formatting",title:"Date Format",description:"The default date format. Custom date formats are formated using the [Day.js](https://day.js.org/docs/en/display/format) library.",component:"setting-combo-box",extra:{before:!0,mode:"date",component:"format-preview"},data:()=>{const s=[],i=new Date;for(const[n,y]of Object.entries(this._.formats.date))s.push({value:n,title:`${this.formatDate(i,n)} (${n})`});return s}},changed:s=>{this._.defaultDateFormat=s,this.emit(":update")}}),this.settings.add("i18n.format.time",{default:"short",ui:{path:"Appearance > Localization >> Formatting",title:"Time Format",description:"The default time format. Custom time formats are formated using the [Day.js](https://day.js.org/docs/en/display/format) library.",component:"setting-combo-box",extra:{before:!0,mode:"time",component:"format-preview"},data:()=>{const s=[],i=new Date;for(const[n,y]of Object.entries(this._.formats.time))s.push({value:n,title:`${this.formatTime(i,n)} (${n})`});return s}},changed:s=>{this._.defaultTimeFormat=s,this.emit(":update")}}),this.settings.add("i18n.format.datetime",{default:"medium",ui:{path:"Appearance > Localization >> Formatting",title:"Date-Time Format",description:"The default combined date-time format. Custom time formats are formated using the [Day.js](https://day.js.org/docs/en/display/format) library.",component:"setting-combo-box",extra:{before:!0,mode:"datetime",component:"format-preview"},data:()=>{const s=[],i=new Date;for(const[n,y]of Object.entries(this._.formats.datetime))s.push({value:n,title:`${this.formatDateTime(i,n)} (${n})`});return s}},changed:s=>{this._.defaultDateTimeFormat=s,this.emit(":update")}})}getLocaleOptions(e){e===void 0&&(e=this.settings.get("i18n.locale"));const s=[],i=[];for(const y of this.availableLocales){const h=this.localeData[y];let B=h?.native_name||h?.name||y;h?.coverage!=null&&h?.coverage<100&&(B=this.t("i18n.locale-coverage","{name} ({coverage,number,percent} Complete)",{name:B,coverage:h.coverage/100}));const K={selected:e===y,value:y,title:B};h?.joke?i.push(K):s.push(K)}s.sort((y,h)=>y.title.localeCompare(h.title)),i.sort((y,h)=>y.title.localeCompare(h.title));let n=[{selected:e===-1,value:-1,i18n_key:"setting.appearance.localization.general.language.twitch",title:"Use Twitch's Language"}];return s.length&&(n.push({separator:!0,i18n_key:"setting.appearance.localization.general.language.languages",title:"Supported Languages"}),n=n.concat(s)),i.length&&(n.push({separator:!0,i18n_key:"setting.appearance.localization.general.language.joke",title:"Joke Languages"}),n=n.concat(i)),n}onEnable(){this.capturing=this.settings.get("i18n.debug.capture"),this.capturing&&this.loadStrings(),this._=new is.default({warn:(...e)=>this.log.warn(...e),defaultDateFormat:this.settings.get("i18n.format.date"),defaultTimeFormat:this.settings.get("i18n.format.time"),defaultDateTimeFormat:this.settings.get("i18n.format.datetime")}),window.BroadcastChannel&&(this._broadcaster=new BroadcastChannel("ffz-i18n")).addEventListener("message",this._boundHandleMessage=this.handleMessage.bind(this)),this._.transformation=Kt[this.settings.get("i18n.debug.transform")],this.locale=this.settings.get("i18n.locale")}async loadChunk(e){if(this.chunks.includes(e))return[];this.chunks.push(e);const s=this._.locale,i=await this.loadLocale(s,e),n=this._.extend(i);return n.length&&(this.log.info(`Loaded Chunk: ${e} -- Phrases: ${n.length}`),this.emit(":loaded",n),this.emit(":update")),n}broadcast(e){this._broadcaster&&this._broadcaster.postMessage(e)}getKeys(){const e=[];for(const s of this.captured.values()){const i=(0,d.deep_copy)(s);i.translation=this._.phrases.get(i.key)||i.phrase,e.push(i)}return e}requestKeys(){this.broadcast({type:"request-keys"})}updatePhrase(e,s){this.broadcast({type:"update-key",key:e,phrase:s}),this._.extend({[e]:s}),this.emit(":loaded",[e]),this.emit(":update")}handleMessage(e){const s=e.data;if(s){if(s.type==="update-key")this._.extend({[s.key]:s.phrase}),this.emit(":loaded",[s.key]),this.emit(":update");else if(s.type==="request-keys")this.broadcast({type:"keys",data:Array.from(this.captured.values())});else if(s.type==="keys"&&Array.isArray(s.data)){for(const i of s.data)this.captured.set(i.key,i);this.emit(":got-keys")}}}openUI(e=!0){this.capturing||(this.capturing=!0,this.emit(":update"));const s=this.resolve("translation_ui");e?s.openPopout():s.enable()}get dayjsLocale(){return this._?._dayjs_locale}get locale(){return this._&&this._.locale}set locale(e){this.setLocale(e)}async loadStrings(e=!1){if(this.strings_loaded&&!e||this.strings_loading)return;this.strings_loading=!0;const s=await fetch(`${L.SERVER}/script/locale/strings.json?_=${(0,Te.getBuster)(30)}`);let i;s.ok?i=await s.json():(this.log.warn(`Error Loading Strings -- Status: ${s.status}`),i=[]);for(const n of i){const y=n.id;let h=this.captured.get(y);if(h||(this.captured.set(y,h={key:y,phrase:n.default,hits:0,calls:[]}),n.source?.length&&h.calls.push(n.source)),!h.options&&n.context?.length)try{h.options=JSON.parse(n.context)}catch{}h.known=n.default,h.different=n.default!==h.phrase}this.new_strings=0,this.changed_strings=0;for(const n of this.captured.values())n.known||this.new_strings++,n.different&&this.changed_strings++;this.strings_loaded=!0,this.strings_loading=!1,this.log.info(`Loaded ${i.length} strings from the server.`),this.emit(":strings-loaded"),this.emit(":new-strings",this.new_strings),this.emit(":changed-strings",this.changed_strings)}see(e,s,i){if(!this.capturing)return;let n;try{n=new Error().stack}catch(h){try{n=h.stack}catch{}}let y=this.captured.get(e);y||(this.captured.set(e,y={key:e,phrase:s,hits:0,calls:[]}),this.strings_loaded&&(this.new_strings++,this.emit(":new-strings",this.new_strings))),s!==y.phrase&&(y.phrase=s,y.known&&s!==y.known&&!y.different&&(y.different=!0,this.changed_strings++,this.emit(":changed-strings",this.changed_strings))),y.options=this.pluckVariables(e,i),y.hits++,n&&(this.mapStackTrace?this.mapStackTrace(n,h=>this.recordCall(y,h),Ht):Promise.all([I.e(7852),I.e(1871)]).then(I.t.bind(I,58194,23)).then(h=>{this.mapStackTrace=h.mapStackTrace,this.mapStackTrace(n,B=>this.recordCall(y,B),Ht)}))}pluckVariables(e,s){const i=this._.cache.get(e);if(!i)return null;const n={};return this._doPluck(i,s,n),Object.keys(n).length?n:null}_doPluck(e,s,i){if(Array.isArray(e)){for(const n of e)this._doPluck(n,s,i);return}if(typeof e=="object"&&e.v){const n=(0,d.get)(e.v,s);if(n&&n.$$typeof)return;i[e.v]=(0,d.shallow_copy)(n)}}recordCall(e,s){if(Array.isArray(s))for(const i of s){const n=ns.exec(i);if(!n)continue;const y=os.exec(n[2]);if(!y||y[1]!=="webpack")continue;const h=y[2];if(h.includes("/node_modules/")||as.includes(h))continue;let B;if(n[1]==="MainMenu.getSettingsTree")B="FFZ Control Center";else{let K=n[1];(K==="Proxy.render"||K.startsWith("Proxy.push"))&&y[2].includes(".vue")&&(K="Vue Component"),B=`${K} (${y[2]}:${y[3]})`}e.calls.includes(B)||e.calls.push(B);return}}async loadLocales(){const e=await fetch(`${L.SERVER}/script/locale/locales.json?_=${(0,Te.getBuster)(30)}`);let s;e.ok?s=await e.json():this.log.warn(`Error Populating Locales -- Status: ${e.status}`),(!Array.isArray(s)||!s.length)&&(s=[{id:"en",name:"English",coverage:100,rtl:!1,hashes:{}}]),this.localeData={},this.availableLocales=[];for(const i of s){const n=i.id.toLowerCase();this.localeData[n]=i,this.availableLocales.push(n)}this.emit(":locales-loaded")}async loadLocale(e,s=null){if(e=e.toLowerCase(),e==="en")return{};const i=this.localeData[e]?.hashes;if(!i)return this.log.info(`Cannot Load Locale: ${e}`),{};s?Array.isArray(s)||(s=[s]):s=this.chunks;const n=this.localeData[e].id,y=[];for(const te of s){const ne=i[te];ne&&y.push(rs(`https://cdn2.frankerfacez.com/static/locale/${n}/${te}.${ne}.json`))}const h=await Promise.all(y),B={};let K=0;for(const te of h)if(te)for(const[ne,oe]of Object.entries(te))typeof oe=="string"&&oe.length>0?B[ne]=oe:K++;return K>0&&this.log.debug(`Ignored ${K} invalid values while loading ${e} chunks.`),B}async setLocale(e){e=e.toLowerCase();const s=this._.locale;if(e===s)return[];if(this._.locale=e,this._.clear(),this.log.info(`Changed Locale: ${e} -- Old: ${s}`),this.emit(":changed",e,s),this.emit(":update"),e==="en")return this.emit(":loaded",[]),this._._dayjs_locale="en",[];const i=this.localeData[e],n=await this.loadLocale(i?.id||e);let y;try{y=i?.dayjs_override||e,await this.loadDayjsLocale(y)}catch{this.log.warn(`Unable to load DayJS locale for ${e}`),y="en"}if(this._.locale!==e)throw new Error("locale has changed since we started loading");this._._dayjs_locale=y;const h=this._.extend(n);return h.length&&(this.log.info(`Loaded Locale: ${e} -- Phrases: ${h.length}`),this.emit(":loaded",h),this.emit(":update")),h}async loadDayjsLocale(e){if(!(e==="en"||e==="en-arrr"))try{await I(73637)(`./${e}.js`)}catch(s){this.log.warn(`Unable to load day.js locale data for locale "${e}"`,s)}}has(e){return this._.has(e)}formatNode(...e){return this._.formatNode(...e)}toLocaleString(...e){return this._.toLocaleString(...e)}toRelativeTime(...e){return this._.formatRelativeTime(...e)}formatNumber(...e){return this._.formatNumber(...e)}formatCurrency(...e){return this._.formatCurrency(...e)}formatDuration(...e){return this._.formatDuration(...e)}formatDate(...e){return this._.formatDate(...e)}formatTime(...e){return this._.formatTime(...e)}formatDateTime(...e){return this._.formatDateTime(...e)}t(e,...s){return this.see(e,...s),this._.t(e,...s)}tList(e,...s){return this.see(e,...s),this._.tList(e,...s)}};z(Dt,"TranslationManager");let pt=Dt;const ds=/\$/g,Vt=String.prototype.replace,us=/^\s*([^(]+?)\s*(?:\(\s*([^)]+?)\s*\))?\s*$/;function fs(R){if(!R||!R.length)return;const e=[];for(const s of R.split(/\|/g)){const i=us.exec(s);i&&e.push({fmt:i[1],extra:i[2]})}return e}z(fs,"parseFormatters");function Ps(R,e,s,i,n){const y=Array.isArray(R);if(e==null)return y?R[0]:R;let h=R;const B=typeof e=="number"?{count:e}:e;return y&&(h=h[0]),typeof h=="string"&&(h=Vt.call(h,i,(K,te,ne)=>{let oe=get(te.trim(),B);if(oe==null)return"";const Ae=fs(ne);let De=!1;if(Ae)for(const ze of Ae){const pe=n[ze.fmt];typeof pe=="function"&&(oe=pe(oe,s,B,ze.extra),De=!0)}return!De&&typeof oe=="string"&&(oe=Vt.call(oe,ds,"$$")),oe})),h}z(Ps,"transformPhrase");const kt=class kt extends F.default{constructor(e,s){super(e,s),this.settings=null,this.api=L.API_SERVER,this.cdn=L.SERVER,this.active=!1,this.inject("settings"),this.settings.add("data.use-staging",{default:!1,ui:{path:'Debugging > Data Sources >> Staging @{"sort": -1}',force_seen:!0,title:"Use staging as data source.",component:"setting-check-box"}}),this.updateStaging(!1)}onEnable(){this.settings.getChanges("data.use-staging",this.updateStaging,this)}updateStaging(e){this.active=e,this.api=e?L.STAGING_API:L.API_SERVER,this.cdn=e?L.STAGING_CDN:L.SERVER,this.emit(":updated",this.api,this.cdn)}};z(kt,"StagingSelector");let _t=kt;var hs=(R=>(R[R.Disconnected=0]="Disconnected",R[R.Connecting=1]="Connecting",R[R.Connected=2]="Connected",R))(hs||{});function ps(R){let e=R.length;const s=[R];for(;(e=R.lastIndexOf("/",e-1))!==-1;)s.push(`${R.slice(0,e)}/*`);return s.push("*"),s}z(ps,"enumerateSubs");const Mt=class Mt extends b.EventEmitter{constructor(){super(),this._ws=null,this._topics=new Set,this._live_topics=new Set,this._want_connection=!1,this._state=0,this._reconnectTimer=null,this._failedConnections=0,this._performReconnect=this._performReconnect.bind(this)}_reconnect(e=!0){if(this._reconnectTimer)return;let s=250+(e?Math.floor(this._failedConnections*(Math.random()*5e3)+5e3):0);this._reconnectTimer=setTimeout(this._performReconnect,s)}_performReconnect(){if(this._reconnectTimer=null,this._ws&&(this._ws.close(),this._ws=null,this._state=0),this._live_topics=new Set(this._topics),!this._live_topics.size)return;this._state=1;const e=new URL("wss://pubsub.workers.frankerfacez.com/ws");if(this._live_topics.size>10)e.searchParams.append("t","*");else for(const i of this._live_topics)e.searchParams.append("t",i);const s=this._ws=new WebSocket(e.toString());s.addEventListener("open",i=>{this._state=2,this._failedConnections=0,this.emit("connect",i)}),s.addEventListener("error",i=>{this.emit("error",i)}),s.addEventListener("close",i=>{this._ws=null,this._state=0,this.emit("disconnect",i),this._want_connection&&this._reconnect()}),s.addEventListener("message",i=>{if(typeof i.data=="string"){let n;try{n=JSON.parse(i.data)}catch{return}if(!n.topic||typeof n.topic!="string")return;if(this._live_topics.size>10&&!this._live_topics.has(n.topic)){let y=!1;for(const h of ps(n.topic))if(this._live_topics.has(h)){y=!0;break}if(!y)return}this.emit("message",n)}})}get connected(){return this._state===2}get connecting(){return this._state===1}get disconnected(){return this._state===0}connect(){this._want_connection=!0,this._reconnect(!1)}disconnect(){this._want_connection=!1,this._failedConnections=0,this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=null),this._ws&&(this._ws.close(),this._ws=null,this._state=0,this.emit("disconnect",null))}subscribe(e){Array.isArray(e)||(e=[e]);for(const s of e)this._topics.add(s);this._want_connection&&!(0,d.set_equals)(this._topics,this._live_topics)&&this._reconnect()}unsubscribe(e){Array.isArray(e)||(e=[e]);for(const s of e)this._topics.delete(s);this._want_connection&&!(0,d.set_equals)(this._topics,this._live_topics)&&this._reconnect()}};z(Mt,"PubSubClient");let mt=Mt;const $t=class $t extends F.default{constructor(e,s){super(e,s),this.experiments=null,this.settings=null,this.inject("settings"),this.inject("experiments"),this.settings.add("pubsub.enabled",{default:()=>this.experiments.getAssignment("worker_pubsub")??!1,ui:{path:'Debugging @{"expanded": false, "sort": 9999} > PubSub >> General',title:"Enable PubSub.",description:"Whether or not you want your client to connect to FrankerFaceZ's PubSub system. This is still in testing and should be left alone unless you know what you're doing.",force_seen:!0,component:"setting-check-box"},changed:i=>i?this.connect():this.disconnect()}),this._topics=new Map,this._client=null}onEnable(){this.subscribe(null,"global"),this.connect(),this.on("experiments:changed:worker_pubsub",this._updateSetting,this)}onDisable(){this.off("experiments:changed:worker_pubsub",this._updateSetting,this),this.disconnect(),this.unsubscribe(null,"global")}_updateSetting(){this.settings.update("pubsub.enabled")}get connected(){return this._client!=null}reconnect(){this.disconnect(),this.connect()}async connect(){if(this._client||!this.settings.get("pubsub.enabled"))return;const e=this._client=new mt;e.on("connect",()=>{this.log.info("Connected to PubSub.")}),e.on("disconnect",()=>{this.log.info("Disconnected from PubSub.")}),e.on("error",i=>{this.log.error("Error in PubSub",i)}),e.on("message",i=>{const n=i.topic,y=i.data;if(!y?.cmd){this.log.debug(`Received message on topic "${n}":`,y),this.emit(":message",n,y);return}y.topic=n,this.log.debug(`Received command on topic "${n}" for command "${y.cmd}":`,y.data),this.emit(`:command:${y.cmd}`,y.data,y)});const s=[...this._topics.keys()];e.subscribe(s),await e.connect()}disconnect(){this._client&&(this._client.disconnect(),this._client=null)}subscribe(e,...s){const i=this._topics;let n=!1;for(const y of s){let h=i.get(y);h?h.add(e):(this._client&&this._client.subscribe(y),h=new Set,h.add(e),i.set(y,h),n=!0)}n&&this.emit(":sub-change")}unsubscribe(e,...s){const i=this._topics;let n=!1;for(const y of s){const h=i.get(y);h&&(h.delete(e),h.size||(n=!0,i.delete(y),this._client&&this._client.unsubscribe(y)))}n&&this.emit(":sub-change")}get topics(){return Array.from(this._topics.keys())}};z($t,"PubSub");let gt=$t;const Rt=class Rt extends F.default{constructor(e,s){super(e,s),this.pending_loads=new Map,this.settings=null,this.should_enable=!0,this.inject("settings"),this.settings.add("chat.update-when-loaded",{default:!0,ui:{path:"Chat > Behavior >> General",title:"Update existing chat messages when loading new data.",component:"setting-check-box",description:"This may cause elements in chat to move, so you may wish to disable this when performing moderation."}})}onEnable(){this.on(":schedule",this.schedule)}schedule(e,s){let i=this.pending_loads.get(e);(!i||!i.pending||!i.timers)&&(i={pending:new Set,timers:{},success:!1},this.pending_loads.set(e,i)),!i.pending.has(s)&&(i.pending.add(s),i.timers[s]=setTimeout(()=>this.notify(e,s,!1),15e3))}notify(e,s,i=!0){const n=this.pending_loads.get(e);if(!(!n||!n.pending||!n.timers)&&(n.timers[s]&&(clearTimeout(n.timers[s]),n.timers[s]=null),!!n.pending.has(s)&&(n.pending.delete(s),i&&(n.success=!0),!n.pending.size))){const y=Object.keys(n.timers);this.log.debug("complete",e,y),n.success&&this.emit(`:complete:${e}`,y),this.pending_loads.delete(e)}}};z(Rt,"LoadTracker");let yt=Rt;var _s=I(33612),ms=I(98247),gs=I(10789),Gt=I(8528);const Lt=class Lt extends F.default{constructor(...e){super(...e),this.inject("settings"),this.inject("i18n"),this.inject("site.tooltips"),this.definitions={},this.settings.add("metadata.player-stats",{default:!1,changed:()=>this.updateMetadata("player-stats")}),this.settings.add("metadata.stream-delay-warning",{default:0}),this.settings.add("metadata.uptime",{default:2,changed:()=>this.updateMetadata("uptime")}),this.definitions.uptime={inherit:!0,no_arrow:!0,refresh(){return this.settings.get("metadata.uptime")>0},setup(s){let i=s?.channel?.live_since;if(!i)return{};i instanceof Date||(i=new Date(i));const n=Date.now();return{created:i,uptime:i?Math.floor((n-i.getTime())/1e3):-1,getBroadcastID:s.getBroadcastID}},order:2,icon:"ffz-i-clock",label(s){const i=this.settings.get("metadata.uptime");return!i||!s.created?null:(0,Te.duration_to_string)(s.uptime,!1,!1,!1,i!==2)},subtitle:()=>this.i18n.t("metadata.uptime.subtitle","Uptime"),tooltip(s){return s.created?[this.i18n.t("metadata.uptime.tooltip","Stream Uptime"),(0,ae.createElement)("div",{class:"tw-pd-t-05"},this.i18n.t("metadata.uptime.since","(since {since,datetime})",{since:s.created}))]:null},async popup(s,i){const[n,y]=await Promise.all([navigator?.permissions?.query?.({name:"clipboard-write"}).then(te=>te?.state).catch(()=>null),s.getBroadcastID()]);if(!y)return(0,ae.createElement)("div",null,this.i18n.t("metadata.uptime-no-id","Sorry, we couldn't find an archived video for the current broadcast."));const h=`https://www.twitch.tv/videos/${y}${s.uptime>0?`?t=${(0,Te.durationForURL)(s.uptime)}`:""}`,B=n==="granted"||n==="prompt",K=B?te=>(navigator.clipboard.writeText(h),te.preventDefault(),!1):null;return i.element.classList.add("ffz-balloon--lg"),(0,ae.createElement)("div",null,(0,ae.createElement)("div",{class:"tw-pd-b-1 tw-mg-b-1 tw-border-b tw-semibold"},this.i18n.t("metadata.uptime.link-to","Link to {time}",{time:(0,Te.duration_to_string)(s.uptime,!1,!1,!1,!1)})),(0,ae.createElement)("div",{class:"tw-flex tw-align-items-center"},(0,ae.createElement)("input",{class:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input tw-full-width",type:"text",value:h,onFocus:te=>te.target.select()}),B&&(0,ae.createElement)("div",{class:"tw-relative ffz-il-tooltip__container tw-mg-l-1"},(0,ae.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative","aria-label":this.i18n.t("metadata.uptime.copy","Copy to Clipboard"),onClick:K},(0,ae.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,ae.createElement)("span",{class:"tw-button-icon__icon"},(0,ae.createElement)("figure",{class:"ffz-i-docs"})))),(0,ae.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up"},this.i18n.t("metadata.uptime.copy","Copy to Clipboard")))))}},this.definitions["player-stats"]={button:!0,inherit:!0,modview:!0,refresh(){return this.settings.get("metadata.player-stats")},setup(){const s=this.resolve("site.player"),i=s.current;let n;if(!i)n=null;else if(typeof i.getPlaybackStats=="function")n=i.getPlaybackStats();else if(typeof i.getVideoInfo=="function"){const h=i.getVideoInfo();n={backendVersion:(0,d.maybe_call)(i.getVersion,i),bufferSize:h.video_buffer_size,displayResolution:`${h.vid_display_width}x${h.vid_display_height}`,fps:h.current_fps,hlsLatencyBroadcaster:h.hls_latency_broadcaster/1e3,hlsLatencyEncoder:h.hls_latency_encoder/1e3,memoryUsage:`${h.totalMemoryNumber} MB`,rate:(0,d.maybe_call)(i.getPlaybackRate,i)||1,playbackRate:h.current_bitrate,skippedFrames:h.dropped_frames,videoResolution:`${h.vid_width}x${h.vid_height}`}}else{const h=(0,d.maybe_call)(i.getVideoHeight,i)||0,B=(0,d.maybe_call)(i.getVideoWidth,i)||0,K=(0,d.maybe_call)(i.getDisplayHeight,i)||0,te=(0,d.maybe_call)(i.getDisplayWidth,i)||0;n={backendVersion:(0,d.maybe_call)(i.getVersion,i),bufferSize:(0,d.maybe_call)(i.getBufferDuration,i),displayResolution:`${te}x${K}`,videoResolution:`${B}x${h}`,videoHeight:h,videoWidth:B,displayHeight:K,displayWidth:te,rate:(0,d.maybe_call)(i.getPlaybackRate,i),fps:Math.floor((0,d.maybe_call)(i.getVideoFrameRate,i)||0),hlsLatencyBroadcaster:(0,d.maybe_call)(i.getLiveLatency,i)||0,playbackRate:Math.floor(((0,d.maybe_call)(i.getVideoBitRate,i)||0)/1e3),skippedFrames:(0,d.maybe_call)(i.getDroppedFrames,i)}}let y=!1;try{const h=i.core.state.path;if(h.includes("/api/channel/hls/")){const B=JSON.parse(new URL(h).searchParams.get("token"));y=B&&B.player_type&&B.player_type!=="site"&&B.player_type!=="popout"&&B.player_type!=="embed"?B.player_type:!1}}catch{}return!n||n.hlsLatencyBroadcaster<-100?{stats:n}:{stats:n,drift:0,rate:n.rate==null?1:n.rate,delay:n.hlsLatencyBroadcaster,old:n.hlsLatencyBroadcaster>180,tampered:y}},order:3,icon(s){return s.rate>1?"ffz-i-fast-fw":"ffz-i-gauge"},subtitle:()=>this.i18n.t("metadata.player-stats.subtitle","Latency"),label(s){if(!this.settings.get("metadata.player-stats")||!s.delay)return null;const i=s.drift>5e3?"(!) ":"";return s.old?`${i}${s.delay.toFixed(2)}s old`:`${i}${s.delay.toFixed(2)}s`},click(){const s=this.resolve("site.player"),i=s.playerUI;i&&i.setStatsOverlay(i.statsOverlay===1?0:1)},color(s){const i=this.settings.get("metadata.stream-delay-warning");if(!(i===0||!s.delay||s.old)){if(s.delay>i*2)return"#f9b6b6";if(s.delay>i)return"#fcb896"}},tooltip(s){const i=s.tampered?(0,ae.createElement)("div",{class:"tw-border-t tw-mg-t-05 tw-pd-t-05"},this.i18n.t("metadata.player-stats.tampered","Your player has an unexpected player type ({type}), which may affect your viewing experience.",{type:s.tampered})):null,n=s.drift>5e3&&(0,ae.createElement)("div",{class:"tw-border-b tw-mg-b-05 tw-pd-b-05"},this.i18n.t("metadata.player-stats.delay-warning","Your local clock seems to be off by roughly {count,number} seconds, which could make this inaccurate.",Math.round(s.drift/10)/100)),y=s.rate>1&&(0,ae.createElement)("div",{class:"tw-border-b tw-mg-b-05 tw-pd-b-05"},this.i18n.t("metadata.player-stats.rate-warning","Playing at {rate,number}x speed to reduce delay.",{rate:s.rate.toFixed(2)}));if(!s.stats||!s.delay)return[n,y,this.i18n.t("metadata.player-stats.latency-tip","Stream Latency"),i];const h=s.stats,B=this.i18n.t("metadata.player-stats.video-info",`Video: {videoResolution}p{fps}
Playback Rate: {playbackRate,number} Kbps
Dropped Frames:{skippedFrames,number}`,h),K=h.bufferSize>0?(0,ae.createElement)("div",null,this.i18n.t("metadata.player-stats.buffered","Buffered: {buffered} seconds",{buffered:h.bufferSize.toFixed(2)})):null;return s.old?[n,this.i18n.t("metadata.player-stats.video-tip","Video Information"),(0,ae.createElement)("div",{class:"tw-pd-t-05"},this.i18n.t("metadata.player-stats.broadcast-ago","Broadcast {count,number}s Ago",s.delay)),(0,ae.createElement)("div",{class:"tw-pd-t-05"},B),K,i]:[n,y,this.i18n.t("metadata.player-stats.latency-tip","Stream Latency"),(0,ae.createElement)("div",{class:"tw-pd-t-05"},B),K,i]}}}onEnable(){const e=this.tooltips.types.metadata=s=>{let i=s;if(i._ffz_stat?i=i._ffz_stat:i.classList.contains("ffz-stat")||(i=s.closest(".ffz-stat"),s._ffz_stat=i),!i)return;const n=i.dataset.key,y=this.definitions[n];return(0,d.maybe_call)(y.tooltip,this,i._ffz_data)};e.onShow=(s,i)=>{const n=s._ffz_stat||s;n.tip=i},e.onHide=s=>{const i=s._ffz_stat||s;i.tip=null,i.tip_content=null},e.popperConfig=(s,i,n)=>(n.placement="bottom",n.modifiers.flip={behavior:["bottom","top"]},n)}get keys(){return Object.keys(this.definitions)}define(e,s){this.definitions[e]=s,this.updateMetadata(e)}updateMetadata(e){const s=this.resolve("site.player");if(s)for(const i of s.Player.instances)s.updateMetadata(i,e)}async renderPlayer(e,s,i,n,y){n[e]&&clearTimeout(n[e]);let h=i.querySelector(`.ffz-stat[data-key="${e}"]`);const B=this.definitions[e],K=z(()=>{h&&(h.tooltip&&h.tooltip.destroy(),h.popper&&h.popper.destroy(),h._ffz_destroy&&h._ffz_destroy(),h._ffz_destroy=h.tooltip=h.popper=null,h.remove())},"destroy");if(!B||(s._mt||"channel")!==(B.type||"channel"))return K();try{const te=z(()=>y(e),"ref_fn");s={...s,refresh:te},B.setup&&(s=await B.setup.call(this,s));const ne=(0,d.maybe_call)(B.refresh,this,s);ne&&(n[e]=setTimeout(te,typeof ne=="number"?ne:1e3)),h=i.querySelector(`.ffz-stat[data-key="${e}"]`);let oe,Ae,De;const ze=(0,d.maybe_call)(B.label,this,s);if(!ze)return K();const pe=(0,d.maybe_call)(B.order,this,s),Me=(0,d.maybe_call)(B.color,this,s)||"";if(h){if(oe=h.querySelector(".ffz-stat-text"),!oe)return K();if(De=h.dataset.icon||"",Ae=h.dataset.color||"",h._ffz_order!==pe&&(h.style.order=h._ffz_order=pe),h.tip){const Ee=(0,d.maybe_call)(B.tooltip,this,s);h.tip_content!==Ee&&(h.tip_content=Ee,(0,ae.setChildren)(h.tip.element,Ee))}}else{let Ee=De=(0,d.maybe_call)(B.icon,this,s),xe=!1;if(B.button!==!1&&(B.popup||B.click)){xe=!0;let ke,Je;const ot=(0,d.maybe_call)(B.border,this,s),Nt=(0,d.maybe_call)(B.inherit,this,s);typeof Ee=="string"&&(Ee=(0,ae.createElement)("span",{class:"tw-mg-r-05"},(0,ae.createElement)("figure",{class:Ee}))),B.popup&&B.click?h=(0,ae.createElement)("div",{class:`tw-align-items-center tw-inline-flex tw-relative ffz-il-tooltip__container ffz-stat tw-stat ffz-stat--fix-padding ${ot?"tw-mg-r-1":"tw-mg-r-05"}`,"data-key":e,tip_content:null},ke=(0,ae.createElement)("button",{class:`tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-top-left-radius-medium ffz-core-button ffz-core-button--padded ffz-core-button--text ${Nt?"ffz-c-text-inherit":"tw-c-text-base"} tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative ${ot?"tw-border-l tw-border-t tw-border-b":"tw-regular"}${B.tooltip?" ffz-tooltip ffz-tooltip--no-mouse":""}`,"data-tooltip-type":"metadata"},(0,ae.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0 tw-justify-center tw-pd-x-1"},Ee,oe=(0,ae.createElement)("span",{class:"ffz-stat-text"}))),Je=(0,ae.createElement)("button",{class:`tw-align-items-center tw-align-middle tw-border-bottom-right-radius-medium tw-border-top-right-radius-medium ffz-core-button ffz-core-button--text ${Nt?"ffz-c-text-inherit":"tw-c-text-base"} tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative ${ot?"tw-border":"tw-regular"}${B.tooltip?" ffz-tooltip ffz-tooltip--no-mouse":""}`,"data-tooltip-type":"metadata"},(0,ae.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0 tw-justify-center"},(0,ae.createElement)("span",null,(0,ae.createElement)("figure",{class:"ffz-i-down-dir"}))))):ke=Je=h=(0,ae.createElement)("button",{class:`ffz-stat tw-align-items-center tw-align-middle ${Nt?"ffz-c-text-inherit":""} tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative ffz-stat--fix-padding ${ot?"tw-border tw-mg-r-1":"tw-regular tw-mg-r-05"}${B.tooltip?" ffz-tooltip ffz-tooltip--no-mouse":""}`,"data-tooltip-type":"metadata","data-key":e,tip_content:null},(0,ae.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0 tw-justify-center"},Ee,oe=(0,ae.createElement)("span",{class:"ffz-stat-text"}),B.popup&&!B.no_arrow&&(0,ae.createElement)("span",{class:"tw-mg-l-05"},(0,ae.createElement)("figure",{class:"ffz-i-down-dir"})))),B.click&&ke.addEventListener("click",at=>{if(h._ffz_fading||ke.disabled||ke.classList.contains("disabled")||h.disabled||h.classList.contains("disabled"))return!1;B.click.call(this,h._ffz_data,at,()=>y(e))}),B.popup&&Je.addEventListener("click",()=>{if(Je.disabled||Je.classList.contains("disabled")||h.disabled||h.classList.contains("disabled"))return!1;if(h._ffz_popup)return h._ffz_destroy();const at=[],vs=z(Fe=>at.push(Fe),"add_close_listener"),Jt=h._ffz_destroy=()=>{for(const Fe of at)try{Fe()}catch(Ze){this.log.capture(Ze,{tags:{metadata:e}}),this.log.error("Error when running a callback for pop-up destruction for metadata:",e,Ze)}if(h._ffz_outside&&h._ffz_outside.destroy(),h._ffz_popup){const Fe=h._ffz_popup;h._ffz_popup=null,Fe.destroy()}h._ffz_destroy=h._ffz_outside=null},Yt=h.closest(".video-player__overlay")||document.fullscreenElement||document.body.querySelector("#root>div")||document.body;(h._ffz_popup=new Gt.default(Yt,h,{logger:this.log,i18n:this.i18n,manual:!0,live:!1,html:!0,tooltipClass:"ffz-metadata-balloon ffz-balloon tw-block tw-border tw-elevation-1 tw-border-radius-small tw-c-background-base",arrowClass:"ffz-balloon__tail tw-overflow-hidden tw-absolute",arrowInner:"ffz-balloon__tail-symbol tw-border-t tw-border-r tw-border-b tw-border-l tw-border-radius-small tw-c-background-base tw-absolute",innerClass:"tw-pd-1",popper:{placement:"top-end",modifiers:{preventOverflow:{boundariesElement:Yt},flip:{behavior:["top","bottom","left","right"]}}},content:(Fe,Ze)=>B.popup.call(this,h._ffz_data,Ze,()=>y(e),vs),onShow:(Fe,Ze)=>setTimeout(()=>{h._ffz_outside=new ae.ClickOutside(Ze.outer,Jt)}),onHide:Jt}))._enter(h)})}else typeof Ee=="string"&&(Ee=(0,ae.createElement)("span",{class:"tw-stat__icon"},(0,ae.createElement)("figure",{class:Ee}))),h=(0,ae.createElement)("div",{class:`tw-align-items-center tw-inline-flex tw-relative ffz-il-tooltip__container ffz-stat tw-stat tw-mg-r-1${B.tooltip?" ffz-tooltip ffz-tooltip--no-mouse":""}`,"data-tooltip-type":"metadata","data-key":e,tip_content:null},Ee,oe=(0,ae.createElement)("span",{class:`${Ee?"tw-mg-l-05 ":""}ffz-stat-text tw-stat__value`})),B.click&&h.addEventListener("click",ke=>{if(h._ffz_fading||h.disabled||h.classList.contains("disabled"))return!1;B.click.call(this,h._ffz_data,ke,()=>y(e))});h._ffz_order=pe,pe!=null&&(h.style.order=pe),i.appendChild(h)}if(typeof B.icon=="function"){const Ee=(0,d.maybe_call)(B.icon,this,s);if(typeof Ee=="string"&&Ee!==De){h.dataset.icon=Ee;const xe=h.querySelector("figure");xe&&(xe.className=Ee)}}Ae!==Me&&(h.dataset.color=Me,h.style.setProperty("color",Me,"important")),h._ffz_data=s,oe.innerHTML=ze,B.disabled!==void 0&&(h.disabled=(0,d.maybe_call)(B.disabled,this,s))}catch(te){return this.log.capture(te,{tags:{metadata:e}}),this.log.error(`Error rendering metadata for ${e}`,te),K()}}};z(Lt,"Metadata");let vt=Lt;const jt=class jt extends gs.Z{constructor(...e){super(...e),this.inject("metadata",vt),this.Player=this.fine.define("highwind-player",s=>s.setPlayerActive&&s.props?.playerEvents&&s.props?.mediaPlayerInstance),this.PlayerSource=this.fine.define("player-source",s=>s.setSrc&&s.setInitialPlaybackSettings)}wantsMetadata(){return this.settings.get("player.embed-metadata")}getData(){return this.parent.data}async getBroadcastID(e,s){return this.twitch_data=await this.parent.awaitTwitchData(),super.getBroadcastID(e,s)}};z(jt,"Player");let bt=jt;const Ft=class Ft extends F.default{constructor(e,s){super(e,s),this.rules={},this.chunks={},this._toggle_state={},this._chunks_loaded=!1,this._loadChunks=(0,d.once)(this._loadChunks)}get chunks_loaded(){return this._chunks_loaded}get loader(){return this._chunk_loader}set loader(e){e!==this._chunk_loader&&(this._chunks_loaded=!1,this._chunk_loader=e)}get style(){return this._style||(this._style=new ae.ManagedStyle),this._style}toggleHide(e,s){const i=`hide--${e}`;if(s=s!=null?!!s:!this._toggle_state[i],this._toggle_state[i]!==s){if(this._toggle_state[i]=s,!s){this._style&&this._style.delete(i);return}if(!(0,d.has)(this.rules,e))throw new Error(`unknown rule "${e}" for toggleHide`);this.style.set(i,`${this.rules[e]}{display:none !important}`)}}toggle(e,s){s=s!=null?!!s:!this._toggle_state[e],this._toggle_state[e]!=s&&(this._toggle_state[e]=s,this._apply(e))}_apply(e){if(!this._toggle_state[e]){this._style&&this._style.delete(e);return}this.style.has(e)||(this._chunks_loaded?(0,d.has)(this.chunks,e)?this.style.set(e,this.chunks[e]):this.log.warn(`Unknown chunk name "${e}" for toggle()`):this._loadChunks().then(()=>this._apply(e)))}set(e,s){return this.style.set(e,s)}delete(e){this._style&&this._style.delete(e)}setVariable(e,s,i="body"){this.style.set(`var--${e}`,`${i}{--ffz-${e}:${s};}`)}deleteVariable(e){this._style&&this._style.delete(`var--${e}`)}async _loadChunks(){if(this._chunks_loaded)return;if(!this._chunk_loader){this._chunks_loaded=!0;return}const e=[];for(const s of this._chunk_loader.keys()){const i=s.slice(2,s.length-(s.endsWith(".scss")?5:4));e.push(this._chunk_loader(s).then(n=>{typeof n?.default=="string"&&(this.chunks[i]=n.default)}))}await Promise.all(e),this._chunks_loaded=!0}};z(Ft,"CSSTweaks");let wt=Ft;var qt=I(6170);const Bt=class Bt extends F.default{constructor(e,s){super(e,s),this.i18n=null,this.types={},this.inject("i18n"),this.should_enable=!0,this.types.json=i=>{const n=i.dataset.title;return[n&&(0,ae.createElement)("strong",null,n),(0,ae.createElement)("code",{className:`block${n?" pd-t-05 border-t mg-t-05":""}`,style:{fontFamily:"monospace",textAlign:"left"}},i.dataset.data)]},this.types.child=i=>{const n=i.querySelector(":scope > .ffz-tooltip-child");return n?(i._ffz_child=n,n.remove(),n.classList.remove("ffz-tooltip-child"),n):null},this.types.child.onHide=i=>{const n=i._ffz_child;n&&(i._ffz_child=null,n.remove(),i.querySelector(":scope > .ffz-tooltip-child")||(n.classList.add("ffz-tooltip-child"),i.appendChild(n)))},this.types.markdown=(i,n)=>{n.add_class="ffz-tooltip--markdown";const y=(0,qt.e)();return y?y.render(i.dataset.title):(0,qt.Z)().then(h=>h.render(i.dataset.title))},this.types.text=i=>(0,ae.sanitize)(i.dataset.title??""),this.types.html=i=>i.dataset.title,this.onFSChange=this.onFSChange.bind(this)}getAddonProxy(e,s,i){if(!e)return this;const n={},y=L.DEBUG||s?.dev;let h;return n.define=(B,K)=>(K&&(K.__source=e),this.define(B,K)),y&&(n.cleanup=()=>(i.log.warn('[DEV-CHECK] Instead of calling tooltips.cleanup(), you can emit the event "tooltips:cleanup"'),this.cleanup()),h={types:"Please use tooltips.define()"}),(0,F.buildAddonProxy)(i,this,"tooltips",n,h)}onEnable(){const e=this.getRoot();window.addEventListener("fullscreenchange",this.onFSChange),this.container=e,this.tip_element=e,this.tips=this._createInstance(e),this.on(":cleanup",this.cleanup),this.on("addon:fully-unload",s=>{let i=0;for(const[n,y]of Object.entries(this.types))y?.__source===s&&(i++,this.types[n]=void 0);i&&(this.log.debug(`Cleaned up ${i} entries when unloading addon:`,s),this.cleanup())})}define(e,s){this.types[e]=s}getRoot(){return document.querySelector(".sunlight-root")||document.querySelector("#root")||document.querySelector(".clips-root")||document.body}_createInstance(e,s="ffz-tooltip",i="text",n){return new Gt.default(e,s,{html:!0,i18n:this.i18n,live:!0,check_modifiers:!0,container:n||e,delayHide:this.checkDelayHide.bind(this,i),delayShow:this.checkDelayShow.bind(this,i),content:this.process.bind(this,i),interactive:this.checkInteractive.bind(this,i),hover_events:this.checkHoverEvents.bind(this,i),onShow:this.delegateOnShow.bind(this,i),onHide:this.delegateOnHide.bind(this,i),popperConfig:this.delegatePopperConfig.bind(this,i),popper:{placement:"top",modifiers:{flip:{}}},onHover:(y,h,B)=>{this.emit(":hover",y,h,B)},onLeave:(y,h,B)=>{this.emit(":leave",y,h,B)}})}onFSChange(){this.container||(this.container=this.getRoot());let e=this.container;document.fullscreenElement instanceof HTMLElement&&(e=document.fullscreenElement),e!==this.tip_element&&(this.tip_element=e,this.tips&&(this.tips.destroy(),this.tips=this._createInstance(e)))}cleanup(){this.tips&&this.tips.cleanup()}delegatePopperConfig(e,s,i,n){const y=s.dataset.tooltipType||e,h=this.types[y];return s.dataset.tooltipSide&&(n.placement=s.dataset.tooltipSide),h&&h.popperConfig?h.popperConfig(s,i,n):n}delegateOnShow(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];y&&y.onShow&&y.onShow(s,i)}delegateOnHide(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];y&&y.onHide&&y.onHide(s,i)}checkDelayShow(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];return y?.delayShow!=null?(0,d.maybe_call)(y.delayShow,null,s,i):0}checkDelayHide(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];return y?.delayHide!=null?(0,d.maybe_call)(y.delayHide,null,s,i):0}checkInteractive(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];return y?.interactive!=null?(0,d.maybe_call)(y.interactive,null,s,i):!1}checkHoverEvents(e,s,i){const n=s.dataset.tooltipType||e,y=this.types[n];return y?.hover_events!=null?(0,d.maybe_call)(y.hover_events,null,s,i):!1}process(e,s,i){const n=s.dataset.tooltipType||e||"text",y=s.dataset.tooltipAlign,h=this.types[n];return y&&(i.align=y),h?h(s,i):[(0,ae.createElement)("strong",null,"Unhandled Tooltip Type"),(0,ae.createElement)("code",{className:"tw-block pd-t-05 border-t mg-t-05",style:{fontFamily:"monospace",textAlign:"left"}},JSON.stringify(s.dataset,null,4))]}};z(Bt,"TooltipProvider");let Et=Bt;const ys=I.p+"player-main.css",It=class It extends _s.Z{constructor(...e){super(...e),this.inject("i18n"),this.inject(ms.Z),this.inject(bt),this.inject("tooltips",Et),this.inject("css_tweaks",wt),this.css_tweaks.loader=I(38621),this.css_tweaks.rules={"unfollow-button":".follow-btn--following","player-cast":".video-player button:has(.tw-chromecast-button__icon)","player-gain-volume":'.video-player__overlay[data-compressed="true"] .volume-slider__slider-container:not(.ffz--player-gain)',"player-ext":".video-player .extension-taskbar,.video-player .extension-container,.video-player .extensions-dock__layout,.video-player .extensions-notifications,.video-player .extensions-video-overlay-size-container,.video-player .extensions-dock__layout","player-ext-hover":'.video-player__overlay[data-controls="false"] .extension-taskbar,.video-player__overlay[data-controls="false"] .extension-container,.video-player__overlay[data-controls="false"] .extensions-dock__layout,.video-player__overlay[data-controls="false"] .extensions-notifications,.video-player__overlay[data-controls="false"] .extensions-video-overlay-size-container'},this.DataSource=this.fine.define("data-source",s=>s.consentMetadata&&s.onPlaying&&s.props&&s.props.data),this.PlayerMenu=this.fine.define("player-menu",s=>s.closeSettingsMenu&&s.state&&s.state.activeMenu&&s.getMaxMenuHeight),document.head.appendChild((0,ae.createElement)("link",{href:ys,rel:"stylesheet",type:"text/css",crossOrigin:"anonymous"}))}onEnable(){this.settings=this.resolve("settings"),this.settings.getChanges("channel.hide-unfollow",s=>this.css_tweaks.toggleHide("unfollow-button",s)),this.DataSource.on("mount",this.updateData,this),this.DataSource.on("update",this.updateData,this),this.DataSource.ready((s,i)=>{for(const n of i)this.updateData(n)}),this.PlayerMenu.on("mount",this.updateMenu,this),this.PlayerMenu.on("update",this.updateMenu,this),this.PlayerMenu.ready((s,i)=>{for(const n of i)this.updateMenu(n)}),this.on("i18n:update",()=>{for(const s of this.PlayerMenu.instances)this.updateMenu(s)});const e=z(()=>this.settings.updateContext({size:{height:window.innerHeight,width:window.innerWidth}}),"update_size");window.addEventListener("resize",e),e(),this.settings.updateContext({route:{name:"popout-player",parts:["/"],domain:"player.twitch.tv"},route_data:["/"]})}awaitTwitchData(){if(this.twitch_data)return Promise.resolve(this.twitch_data);if(this._loading_td)return new Promise((s,i)=>{this._loading_td.push([s,i])});const e=this._loading_td=[];return new Promise((s,i)=>{e.push([s,i]),Promise.all([I.e(2682).then(I.bind(I,29632)),I.e(2682).then(I.bind(I,27040))]).then(n=>{const y=n[0].default,h=n[1].default;this.inject("apollo",y),this.inject("twitch_data",h),this.twitch_data.enable().then(()=>{this._loading_td=null;for(const B of e)B[0](this.twitch_data)}).catch(B=>{this._loading_td=null;for(const K of e)K[1](B)})})})}get data(){return this.DataSource.first}updateData(e){const s=e?.props?.data?.user,i=s?.broadcastSettings,n=s?.stream?.game;this.settings.updateContext({title:i?.title,channelID:s?.id,category:n?.name,categoryID:n?.id})}updateMenu(e){const s=this.fine.getChildNode(e),i=s&&s.querySelector('div[data-a-target="player-settings-menu"]');if(!i)return;const n=e.state.activeMenu==="settings-menu__main";let y,h,B,K=i.querySelector(".ffz--cc-button");if(K)if(n)h=K.querySelector("button"),y=K.querySelector(".ffz--label"),B=K.querySelector(".ffz--version");else{K.remove();return}else{if(!n)return;const te=z(()=>{const ne=window.open("https://twitch.tv/popout/frankerfacez/chat?ffz-settings=player","_blank","resizable=yes,scrollbars=yes,width=850,height=600");ne&&ne.focus()},"handler");K=(0,ae.createElement)("div",{class:"tw-mg-t-1 tw-border-t tw-pd-t-1 tw-full-width tw-relative ffz--cc-button"},h=(0,ae.createElement)("button",{class:"tw-block tw-border-radius-medium tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive",onclick:te},(0,ae.createElement)("div",{class:"tw-align-items-center tw-flex tw-pd-05 tw-relative"},y=(0,ae.createElement)("div",{class:"ffz--label tw-flex-grow-1 tw-ellipsis"}),B=(0,ae.createElement)("div",{class:"ffz--version tw-align-items-center tw-mg-l-05 tw-c-text-alt-2 tw-white-space-nowrap"})))),i.appendChild(K)}y.textContent=h.title=this.i18n.t("site.menu_button","FrankerFaceZ Control Center"),B.textContent=this.resolve("core").constructor.version_info.toString()}};z(It,"PlayerSite");let St=It;const qe=class qe extends F.default{constructor(){super();const e=performance.now();qe.instance=this,this.host="twitch",this.flavor="player",this.name="ffz_player",this.__state=0,this.__modules.core=this,this.log=new T.default(null,null,null),this.log.label="FFZPlayer",this.log.init=!0,this.core_log=this.log.get("core"),this.log.hi(this),this.inject("settings",Re),this.inject("experiments",ht),this.inject("i18n",pt),this.inject("staging",_t),this.inject("load_tracker",yt),this.inject("pubsub",gt),this.inject("site",St),this.inject("addons",Be),this.enable().then(()=>{const s=performance.now()-e;this.core_log.info(`Initialization complete in ${s.toFixed(5)}ms.`),this.log.init=!1}).catch(s=>{this.core_log.error("An error occurred during initialization.",s),this.log.init=!1})}static get(){return qe.instance}async generateLog(){const e=[];for(const i in this.__modules){const n=this.__modules[i];n instanceof F.default&&n.generateLog&&n!=this&&e.push((async()=>{try{return[i,await(0,d.timeout)(Promise.resolve(n.generateLog()),5e3)]}catch(y){return[i,`Error: ${y}`]}})())}const s=await Promise.all(e);if(this.log.captured_init&&this.log.captured_init.length>0){const i=[];for(const n of this.log.captured_init){const y=U()(n.time).locale("en").format("H:mm:ss");i.push(`[${y}] ${n.level} | ${n.category||"core"}: ${n.message}`)}s.unshift(["initialization",i.join(`
`)])}return s.map(i=>`${i[0]}
-------------------------------------------------------------------------------
${typeof i[1]=="string"?i[1]:JSON.stringify(i[1],null,4)}`).join(`

`)}};z(qe,"FrankerFaceZ");let je=qe;je.Logger=T.default;const Ue=je.version_info=Object.freeze({major:4,minor:76,revision:4,extra:Xt?.length&&Xt[0],commit:"15c33281ad9d1b7898ab3739c0844740210b602b",build:"0",hash:I.h(),toString:()=>`${Ue.major}.${Ue.minor}.${Ue.revision}${Ue.build?`.${Ue.build}`:""}${Ue.extra||""}${L.DEBUG?"-dev":""}`});je.utilities={addon:I(5227),blobs:I(38626),constants:I(24431),dom:I(44589),events:I(17159),logging:I(55467),module:I(22527),object:I(46949),time:I(83269),tooltip:I(8528),i18n:I(2356),dayjs:I(51722),popper:I(16572)},window.FrankerFaceZ=je,window.ffz=new je})()})();})();

//# sourceMappingURL=player.js.map