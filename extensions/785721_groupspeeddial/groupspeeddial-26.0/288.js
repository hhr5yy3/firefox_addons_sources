"use strict";(globalThis.webpackChunkgroup_speed_dial=globalThis.webpackChunkgroup_speed_dial||[]).push([[288],{1879:(e,t,i)=>{i.d(t,{e:()=>C});var s=i(4323),n=i(5076),a=i(8794),o=(i(6062),i(5048)),r=i(1962),l=i(2846),c=i(6382),d=i(2221),h=i(910),u=i(9574),p=i(7865),g=i(6419),m=i(9998),w=i(744),_=i(6777),f=i(4559),y=i(8698),v=i(2924),x=i(6037),I=i(3778);const b=(0,u.m)((e=>e.REMEMBER_GROUP_RUNTIME?new h.F("lastGroup",s.s6,{storageArea:"session"}):new h.F("lastGroup",s.s6,{storageArea:"local"}))),C=new class extends c.c{_id=-1;get id(){return this._id}set id(e){this._id=l.M.groupById(e)?.id,(0,v.J)(this._id)}initPromiseResolver=(0,s.NU)();promise=this.initPromiseResolver.promise;di;activateFromEventWithDelay=this.createDelayedActivationEventHandler(600);constructor(){super()}async initialize(e){this.di=e;const t=window.location.hash;await l.M.promise,l.M.isEmpty()&&await w.b,this.id=this.extractHashGroupId(t),t||(d.lw.REMEMBER_GROUP?(0,n.J)(await b(d.lw).get().catch(s.s6),(e=>this.id=e)):(0,n.J)(await a.ne.get(),(e=>this.id=e))),window.addEventListener("hashchange",(e=>this.onHashChange(e)),!1),window.addEventListener("change_active_group",(e=>this.activate(e.detail))),await p.W;const i=(0,f.O1)();if(d.lw.SCROLL_GROUPS&&(i.onwheel=(0,f.uT)().onwheel=async e=>{if(e.buttons!==_.w.RIGHT&&e.composedPath().find((e=>e instanceof HTMLElement&&["dials-container","groups"].includes(e.id)))){const t=d.lw.SCROLL_GROUPS_REVERSE?-1:1,i=((e.deltaY||e.deltaX||e.deltaZ)>0?1:-1)*t,s=C.getCurrentGroup(),n=await s.getNeighbouringGroup(i>0?"next":"prev",d.lw.SCROLL_GROUPS_CIRCLE?"loop":"stay");n&&C.activate(n.id)}}),d.lw.ACTIVATE_GROUP_HOVER){const e=(0,y.U)(d.lw.ACTIVATE_GROUP_HOVER_DELAY);i.addEventListener("mouseover",(t=>(0,n.J)((0,o.rm)(t),(t=>e((()=>this.activate(t))))))),i.addEventListener("mouseleave",(()=>e.cancel()))}super.notifyChange(this.id),this.initPromiseResolver.resolve()}async updateActiveGroupAndRedraw(e){this.id=e,d.lw.REMEMBER_GROUP&&b(d.lw).set(e),await this.di.redrawDials(),(0,x.R)(e),super.notifyChange(e)}async onHashChange(e){const t=this.extractHashGroupId(e.newURL);t!==this.id&&await this.updateActiveGroupAndRedraw(t)}async activate(e,t=!1){await this.promise;l.M.GROUPS.find((t=>t.id===e))&&(e!==this.id||t)&&(window.location.hash=(0,o._V)(e),await this.updateActiveGroupAndRedraw(e),(0,f.O1)().dispatchEvent(new CustomEvent("change",{detail:e})))}activateFromEvent(e){0===e.button&&(0,n.J)((0,o.rm)(e),(e=>this.activate(e)))}createDelayedActivationEventHandler(e){let t,i=null,s=!1,a=Date.now();return(r,l)=>{0===r.button&&(0,n.J)(l??(0,o.rm)(r),(n=>{const o=Date.now();i!==n||o-a>e?(s=!1,i=n,clearTimeout(t),t=self.setTimeout((()=>s=!0),e)):s&&this.activate(n),a=o}))}}getCurrentGroup(){return l.M.groupById(this.id)}dialById(e){const t=this.getCurrentGroup(),i=t.dials,s=(0,o.om)(e);if(t.topSites)return new g.O(s,t.id,{name:"",url:(0,r.$H)(e).href});const n=i[s];return n}extractHashGroupId(e){e=e||"";const t=(0,o.m4)(e);let i=l.M.groupById(t);return!m.Jk&&i.topSites&&(i=l.M.GROUPS.find((e=>!e.topSites))||i),d.lw.GROUP_ICON_IN_TITLE&&(0,I.i)(i.iconId||0),i.id}}},555:(e,t,i)=>{i.d(t,{AU:()=>s,Ki:()=>a,oq:()=>n});const s=Object.freeze({container:"dial_container",head:"dial_head",body:"dial_body",icon:"dial_icon",name:"dial_name",thumbnail:"dial_thumbnail",textDial:"text_dial",dialNumber:"dial_number",tag:"dial_tag",reloadButtons:"dial_reload",is_online:"is_online"}),n=Object.freeze({is_empty_dial:"is_empty_dial",is_live_dial:"is_live_dial",is_url_dial:"is_url_dial",is_text_dial:"is_text_dial",has_list:"has_list",border_target:"border_target",is_search_dial:"is_search_dial",is_multi_dial:"is_multi_dial",is_session_dial:"is_session_dial",is_top_sites_dial:"is_top_sites_dial",is_timer_dial:"is_timer_dial",is_weather_dial:"is_weather_dial",is_group:"is_group",is_plus:"is_plus"}),a=Object.freeze({dial_list_container:"dial_list_container",dial_list_item:"multi_dial_item"})},2392:(e,t,i)=>{i.d(t,{P:()=>G});var s=i(9598),n=i(1181),a=i(4323),o=i(6898),r=i(1282),l=i(1879),c=i(1962),d=i(2100),h=i(6777),u=i(555),p=i(7302),g=i(5048),m=i(1374),w=i(3700),_=i(2460),f=i(1361),y=i(1049),v=i(5076),x=i(4559);const I='#dials a[id^="dial_"]:not(.is_empty_dial)',b="dial-selected",C="dial-checkmark",k=(0,n.do)(a.lQ);class G{options;contextMenu;rect;handlers;selectedDialsIdsPerGroup;selectedGroupsIds;callbacks;offIcon;onIcon;constructor(e){this.options=e,this.contextMenu=this.options.selectionContextMenu(this),this.rect=(0,s.z)("div",{class:"selection_rect"}),this.handlers=new f.G,this.selectedDialsIdsPerGroup=new w.j,this.selectedGroupsIds=new Set,this.callbacks=Array(),[this.offIcon,this.onIcon]=(()=>{switch(e.icons){case"check":return["check_filled (1)","check_filled (2)"];case"lock":return["padlock (7)","padlock (8)"]}})().map((e=>(0,p.Z)(`svg/${e}.svg`))),this.handlers.addListener(document.body,"keydown",(e=>"Escape"===e.key&&y.s.toggleSelection(!1))),e.activateNow&&this.activate()}get groupsCount(){return this.selectedGroupsIds.size}get dialsCount(){return(0,_.RM)([...this.selectedDialsIdsPerGroup.values()].map((e=>e.size)))}addSelectionChangeListener(e){this.callbacks.push(e),this.handlers.addOnClearHandler((()=>(0,m.E6)(this.callbacks,e)))}activate(e){const t=this;this.handlers.addClass(document.documentElement,"dials_selection_mode");for(const{groupId:t,dialIndex:i}of e||[])(0,a.Et)(i)?this.selectedDialsIdsPerGroup.add(t,(0,g.k6)(i)):this.selectedGroupsIds.add((0,g.Tf)(t));document.body.appendChild(this.rect);const i={top:0,left:0,right:0,bottom:0,startX:0,startY:0};{const e=e=>this.redrawChanges(e);d._C.register(e),this.handlers.addOnClearHandler((()=>d._C.unregister(e)))}this.redrawChanges();const s=(0,x.B)(),o=(0,x.O1)();return this.handlers.addListener(s,"mousedown",(function(e){if(e.button!==h.w.LEFT)return;t.contextMenu.close();const s=new Set(t.selectedDialsIdsPerGroup.get(l.e.id));function n(e){i.left=Math.min(i.startX,e.clientX),i.top=Math.min(i.startY,e.clientY),i.right=Math.max(i.startX,e.clientX),i.bottom=Math.max(i.startY,e.clientY),t.showSelectionRectangle(i),t.selectDials(i,s)}i.startX=i.left=e.clientX,i.startY=i.top=e.clientY,n(e),window.addEventListener("mouseup",(function(e){window.removeEventListener("mousemove",n),t.selectDials(i,s),Object.keys(i).map((e=>i[e]=0)),t.showSelectionRectangle(i)}),{once:!0}),window.addEventListener("mousemove",n)})),this.handlers.addListener(s,"dblclick",(function(e){e.stopImmediatePropagation();const t=e.target.closest(I+'[href^="#"]');t&&l.e.activate((0,g.m4)(t.href))}),{capture:!0}),this.handlers.addListener(s,"contextmenu",(function(e){(0,n.jo)(e),t.contextMenu.show(e)}),{capture:!0}),this.handlers.addListener(s,"click",k,{capture:!0}),this.handlers.addListener(s,"dragstart",k,{capture:!0}),void this.handlers.addListener(o,"mousedown",(function(e){k(e),(0,v.J)((0,g.nE)(e.composedPath()),(i=>{e.target.closest("."+C)&&t.toggleGroup(i,t.selectedGroupsIds)}))}),{capture:!0})}deactivate(){this.handlers.clearAll(),[...document.getElementsByClassName(C)].forEach(c.bf),[...document.getElementsByClassName(b)].forEach((e=>e.classList.remove(b))),this.selectedDialsIdsPerGroup.clear(),this.selectedGroupsIds.clear()}getSelectedItems(){return{selectedDialsPerGroup:this.selectedDialsIdsPerGroup.map(g.om),selectedGroups:new Set([...this.selectedGroupsIds].map(g.U0))}}showSelectionRectangle({bottom:e,left:t,right:i,top:s}){const n=this.rect.style;n.left=`${t}px`,n.top=`${s+window.scrollY}px`,n.width=i-t+"px",n.height=e-s+"px"}selectAll(){this.getDialsIdList().map(c.$H).forEach((e=>this.toggleDial(e.id))),this.redraw()}selectNone(){this.selectedDialsIdsPerGroup.get(l.e.id).clear(),this.redraw()}selectGroup(e){this.toggleGroup((0,g.Tf)(e),this.selectedGroupsIds),this.redraw()}selectDials(e,t){this.deselectDials();const i=new Set(this.getDialsIdList().map(c.$H).filter((t=>(0,o.U)(e,t.getBoundingClientRect()))).map((e=>e.id)));i.forEach((e=>this.toggleDial(e,t))),(0,r.tX)(t,i).forEach((e=>{this.toggleDial(e)})),this.redraw()}toggleDial(e,t){this.toggleItem(e,t,this.selectedDialsIdsPerGroup.get(l.e.id))}toggleGroup(e,t){this.toggleItem(e,t,this.selectedGroupsIds),this.redraw()}toggleItem(e,t,i){const s=t?.has(e);i[s?"delete":"add"](e)}deselectDials(e=l.e.id){this.selectedDialsIdsPerGroup.get(e).clear()}getDialsIdList(){return this.getDialNodes().map((e=>e.id))}getDialNodes(){return[...document.querySelectorAll(I)]}getGroupNodes(){return this.options.targetGroups?[...document.querySelectorAll('#groups a[id^="group_"]')]:[]}redraw(){this.redrawChanges(),this.callbacks.forEach((e=>e(l.e.id,this.selectedDialsIdsPerGroup.get(l.e.id),this.selectedDialsIdsPerGroup)))}redrawChanges(e=l.e.getCurrentGroup()){const t=e=>{e.appendChild((0,s.z)("div",{class:C,handlers:{onclick:k}},[(0,s.z)("img",{class:"dial_selected_state_0",src:this.offIcon}),(0,s.z)("img",{class:"dial_selected_state_1",src:this.onIcon})]))};this.getGroupNodes().filter((e=>!e.getElementsByClassName(C).length)).forEach(t),this.getDialNodes().map((e=>e.querySelector("."+u.AU.container))).filter((e=>!e?.getElementsByClassName(C).length)).forEach(t),[...document.getElementsByClassName(b)].forEach((e=>e.classList.remove(b))),[...this.selectedDialsIdsPerGroup.get(e.id),...this.selectedGroupsIds].forEach((e=>(0,c.$H)(e).classList.add(b)))}}},4497:(e,t,i)=>{i.d(t,{N:()=>b});var s=i(7590),n=i(6221),a=i(5326),o=i(7879),r=i(1879),l=i(5048),c=i(2094),d=i(2846),h=i(7283),u=i(8794),p=i(4323),g=i(9574),m=i(1049),w=i(7526),_=i(6481),f=i(2806),y=i(4298),v=i(6005),x=i(7861),I=i(5076);const b=e=>new s.t({menuBuilder:(0,a.$)({iconSize:18,itemPadding:"4px 6px",generateIds:!0,maxWidth:"600px",showShortcutsTitle:!0,darkThemeService:o.H}),customStyle:"z-index: 10;",getActionsItemsData:async t=>{const i=t.composedPath(),s=(0,I.J)((0,l.C9)(i),(e=>r.e.dialById(e))),a=s?.isGroupDial()?d.M.groupById(s.getTargetGroupId()):void 0,o=(0,g.m)((()=>u._V.get().then((e=>!!e?.length)))),b=e=>({data:{dial:t}})=>!!t&&e(t),C=b((e=>e.isNotEmptyDial())),k=()=>Array.from(e.getSelectedItems().selectedDialsPerGroup.get(r.e.id)).length>0,G=({data:{dial:t}})=>e.getSelectedItems().selectedDialsPerGroup.get(r.e.id).has(t?.index??-1),D=(0,n.H)();return{actions:{select_dials:{name:"select_dials",iconStyle:(0,h.H)(m.s.isActive?"svg/cancel.svg":"svg/selection_box.svg"),fn:()=>m.s.toggleSelection()},open_group:{name:"drag_group_hover_open",iconStyle:(0,h.H)("svg/inside.svg"),fn:()=>r.e.activate(a.id)},select_all:{name:"label_select_all",iconStyle:(0,h.H)("svg/selection_box.svg"),fn:()=>e.selectAll()},select_none:{name:"label_select_none",iconStyle:(0,h.H)("svg/selection_box_empty.svg"),fn:()=>e.selectNone()},op_cut:{name:"op_cut",iconStyle:(0,h.H)("svg/op_cut.svg"),fn:function({data:{dial:t,activeGroup:i}}){const s=Array.from(e.getSelectedItems().selectedDialsPerGroup.get(i.id));0===s.length&&s.push(t.index);u._V.set(s.map((e=>({dialIndex:e,groupId:i.id,operation:"cut"}))))},test:C},op_paste:{name:"op_paste",iconStyle:(0,h.H)("svg/op_paste.svg"),fn:async function({data:{dial:t}}){const i=await u._V.get(),s=i?.[0].groupId;await(0,_.w)(r.e.id,t?.index??-1,"paste"),e.deselectDials(s)},test:(0,p.IQ)(o)},op_delete:{name:"op_delete",iconStyle:(0,h.H)("svg/op_delete.svg"),fn:async function({data:{activeGroup:t}}){const i=t.id;await d.M.action("removeDials",{srcGroupId:i,srcDialIndexes:Array.from(e.getSelectedItems().selectedDialsPerGroup.get(i))}),e.deselectDials(i)},test:(0,p.IQ)(k,G)},convert_to_multi:{name:"convert_to_multi",iconStyle:(0,h.H)("svg/multi (1).svg"),...(0,y.kn)(),fn:async function({data:{dial:t}}){const i=r.e.id,s=Array.from(e.getSelectedItems().selectedDialsPerGroup.get(i));await f.U.mergeDials(i,s,i,t),e.deselectDials(i)},test:(0,p.IQ)(k,G,(0,p.or)(b((e=>e.isGroupDial())),b((e=>e.isUrlDial())),b((e=>e.isMultiDial()))))},move_dial_to:{name:"cm_move_dial_to",iconStyle:(0,h.H)("svg/right(0).svg"),fn:D,children:async function({data:{activeGroup:t}}){return(await d.M.getVisibleGroups()).filter((e=>e.id!==t.id)).map((t=>({menuItem:{key:"",action:`sel_move_to_group_${(0,w.V)()}_${t.name}`},action:{nameFix:t.name,iconStyle:t.styleIcon().style.cssText,async fn({data:{dial:i,activeGroup:s}}){const n=s.id,a=Array.from(e.getSelectedItems().selectedDialsPerGroup.get(n));await d.M.action("moveDials",{srcGroupId:n,destGroupId:t.id,srcDialIndexes:a.length>0?a:[i.index],destDialIndex:-1,operation:"move"}),e.deselectDials(n)}}})))},test:C},tag_dial:{name:"tag",iconStyle:(0,h.H)("icons/tags/tag (1).svg"),fn:D,children:async function(t){return(await(0,v.l)(t)).filter((e=>e.tag)).map((t=>({menuItem:t.menuItem,action:{...t.action,disabled:p.bJ,async fn(i){const{data:{dial:s,activeGroup:n}}=i,a=t.tag,o=n.id,r=Array.from(e.getSelectedItems().selectedDialsPerGroup.get(o));if(0===r.length)return t.action.fn(i);const l=await n.getDials(),c=r.map((e=>{const t=l[e];return t.settings={...t.settings,TAG_ID:a.id},{dial:t,groupId:o}}));return d.M.action("replaceDials",{list:c})}}})))},test:(0,p.Uo)(C)},share_dials:{name:"share_dials",iconStyle:(0,h.H)("icons/tags/tag (60).svg"),fn:async()=>(await(0,x.X)()).openShareDialsModal(e),test:k}},items:[...a?[{key:"",action:"open_group"}]:[],(0,c.w)(),{key:"x",action:"op_cut"},{key:"v",action:"op_paste"},{key:"d",action:"op_delete"},(0,c.w)(),{key:"",action:"convert_to_multi"},(0,c.w)(),{key:"",action:"tag_dial"},(0,c.w)(),{key:"v",action:"move_dial_to"},(0,c.w)(),{key:"",action:"share_dials"},(0,c.w)(),{key:"",action:"select_all"},{key:"",action:"select_none"},(0,c.w)(),{key:"s",action:"select_dials"}],data:{activeGroup:r.e.getCurrentGroup(),dial:s,group:a}}}})},6037:(e,t,i)=>{i.d(t,{R:()=>o});var s=i(8794),n=i(5941),a=i(4069);async function o(e){if(a.m0)return;const t=(await s.SR.get()).filter((([t])=>t===e));t.length&&(await s.SR.update((t=>t.filter((([t])=>t!==e)))),await(await(0,n.w)()).parentReload(e,t.map((([,e])=>e))))}},7590:(e,t,i)=>{i.d(t,{t:()=>h});var s=i(4323),n=i(7865),a=i(2441),o=i(1962),r=i(9598),l=i(6690),c=i(6898);const d=new a._;class h{_contextMenuNode;menuBuilder;getActionsItemsData;getX;getY;runtimeContextId;constructor({menuBuilder:e,getActionsItemsData:t,getX:i,getY:s,targetId:a,targetNode:l,runtimeContextId:c="default",customStyle:h="",closeOnEvents:u=["click","dragstart","hashchange"],closeOnTabChange:p=!0}){this._contextMenuNode=(0,r.z)("context-menu",{tabindex:0,style:"position: fixed;\nbox-shadow: 0 0 16px -3px black;\noutline: none;\nwhite-space: nowrap;\ntouch-action: manipulation;\nuser-select: none;\n"+h}),this.menuBuilder=e,this.getActionsItemsData=t,this.getX=i,this.getY=s,this.runtimeContextId=c,d.push(c,this.close),p&&browser.tabs.onActivated.addListener(this.close),u.forEach((e=>window.addEventListener(e,this.close))),e.setAutoCloseParentOnclick(this.close),this._contextMenuNode.addEventListener("click",(e=>{const t=e.target;("CONTEXT-MENU"===t.nodeName||"SEPARATOR"===t.nodeName||t.classList.contains("context-menu-items-container"))&&e.stopPropagation()}),{capture:!0}),(l||a)&&n.W.then((()=>{const e=l||a&&(0,o.$H)(a);e&&e.addEventListener("contextmenu",(e=>this.show(e)),{capture:!1})}))}close=()=>{window.removeEventListener("mouseout",this.onMouseOut),this._contextMenuNode.removeEventListener("keydown",this.onKeyDown),this.isVisible()&&(this._contextMenuNode.remove(),this.menuBuilder.menuClosed())};onMouseOut=e=>{const{clientX:t,clientY:i}=e;(t<=0||i<=0||t>=window.innerWidth||i>=window.innerHeight)&&!this.isMouseNearMenus(t,i)&&this.close()};isVisible(){return document.contains(this._contextMenuNode)}async toggle(e){if(this.isVisible())return this.close();await(0,s.BK)(0),await this.show(e)}isMouseNearMenus(e,t){const i={left:e-64,right:e+64,top:t-64,bottom:t+64};return[...document.querySelectorAll(".context-menu-items-container")].filter((e=>e.offsetParent)).map((e=>e.getBoundingClientRect())).map((e=>(0,c.U)(e,i))).some(s.zz)}async show(e=new MouseEvent("click")){e.preventDefault(),d.get(this.runtimeContextId).forEach(s.g7);const{actions:t,items:i,data:n}=await this.getActionsItemsData(e);this._contextMenuNode.replaceChildren(await this.menuBuilder.buildMenu(t,n,i)),window.addEventListener("mouseout",this.onMouseOut),this._contextMenuNode.addEventListener("keydown",this.onKeyDown),document.body.appendChild(this._contextMenuNode),this._contextMenuNode.focus();const a=this.getX?this.getX():e.clientX-2,o=this.getY?this.getY():e.clientY-2,{width:r,height:c}=this._contextMenuNode.getBoundingClientRect(),h=a+r<window.innerWidth,u=o+c<window.innerHeight;this._contextMenuNode.style.left=(0,l.px)(h?a:window.innerWidth-r),this._contextMenuNode.style.top=(0,l.px)(u?o:window.innerHeight-c)}onKeyDown=e=>{switch(e.key){case"Control":case"Alt":case"Shift":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":return;case"Escape":break;default:this.menuBuilder.handleKey(e.key,e)&&e.preventDefault(),this.close()}this.close()}}},5326:(e,t,i)=>{i.d(t,{$:()=>f});var s=i(4323),n=i(4590),a=i(6004),o=i(7813),r=i(1374),l=i(8408),c=i(7302),d=i(2689),h=i(7526),u=i(3672),p=i(9598),g=i(1181),m=i(2895),w=i(6690),_=i(1962);function f({important:e=!1,generateIds:t=!1,roundEdges:i=!1,showShortcutsTitle:f=!1,maxWidth:y="300px",itemPadding:v="6px",iconSize:x=26,hoverColor:I="#e7e7e7",activeColor:b="#d7d7d7",autoCloseParentOnClickFn:C=s.lQ,containerStyle:k="",submenuStyle:G="",darkThemeService:D={isDarkPromise:Promise.resolve(!1)}}={}){const E=t=>(0,a.DT)(t,{important:e,allToInitial:e}),S=[],$=[],P=[];let M=!0;return{setAutoCloseParentOnclick:e=>C=e,addOnClickHandler:e=>$.push(e),handleKey:function(e,t){const i=S.find((t=>t.key===e));return!!i&&(i.executeAction({data:{},actionId:i.actionId,options:{},event:t}),!0)},buildMenu:async function(e,t,i){const n=await D.isDarkPromise.catch(s.bJ),a=n?"#FFFFFF":"#000000",o=`background: ${n?"#2b2b2b":"#FFFFFF"}; color: ${a}; border: 1px solid ${a}32;`;M=!0,S.length=0;const l=(await Promise.all(i.map((i=>R(e,i,t,{mainStyle:o,darkTheme:n},S))))).filter(s.zz),c=(0,r.Ub)(l,((e,t)=>Boolean(e.isSeparator&&t.isSeparator))),d=(0,r.yf)(c,(e=>e.isSeparator)).map((e=>e.node));return(0,p.z)("div",{class:"context-menu-items-container",style:`${o}${k}`},d)},menuClosed:()=>P.forEach(s.g7)};async function R(k,D,A={},{darkTheme:N,mainStyle:L},O=[],T=!1){const H=String((0,h.V)()),z=(0,m.fF)((e=>O.push(e))),B="inline"===D.type;if("separator"===D.type)return z({id:"separator",isSeparator:!0,node:(0,p.z)("separator",{style:E(`${L}; border-left: 0; border-right: 0; border-bottom: 0; margin: 3px 0; padding: 0; display: block;`)}),executeAction:s.lQ,hideChildNode:s.lQ,actionId:D.action,children:[]});const{key:U,action:F,children:X=[],options:Y={}}=D,V=k[F];if(!V)return!1;const{name:J,nameFix:W,nameFn:Q,title:K,titleFix:j,autoTitle:Z,titleFn:q,smallName:ee,smallNameFn:te,smallNameFix:ie,proIcon:se,proLink:ne,icon:ae,iconStyle:oe,darkIconStyle:re,darkIconInvert:le,fn:ce,allowAuxClick:de,onMenu:he,onChildrenMenu:ue,onClose:pe,anchor:ge,children:me,test:we,disabled:_e,enabled:fe,checkbox:ye,checkboxIcons:ve,style:xe="",smallStyle:Ie=""}=V,be=xe.includes("background"),Ce=await se,ke={data:A,actionId:F,options:Y,event:new Event("noop")};if(pe&&P.push((()=>pe(ke))),we&&!await Promise.resolve(we(ke)).catch(s.lQ))return!1;const Ge=Ce&&ne?()=>(0,l.K)(ne,{nextToCurrent:!0,active:!0,inNewTab:!0}):(0,g.do)(s.lQ),De=!fe&&(!!Ce||!(!_e||!await Promise.resolve(_e(ke)).catch(s.bJ))),Ee=De?e=>Ge(e.event):ce,Se=!(!ge||De)&&await Promise.resolve(ge(ke)).catch(s.bJ),$e=me?await me(ke):[],Pe=$e.reduce(((e,{action:t,menuItem:i})=>(t&&(e[i.action]=t),e)),{});X.push(...$e.map((({menuItem:e})=>e)));const Me=()=>Promise.resolve(!!ye&&ye(ke)).catch(s.bJ),Re=ye&&(ve?(0,a.t$)(await Me(),{handlers:{onclick:e=>e.preventDefault()},style:E("visibility: hidden")},{style:E(`margin: 0 10px 0 0; width: ${x}px; height: ${x}px`)},{style:E("width: 100%;")},ve):(0,a.mx)(await Me(),{handlers:{onclick:e=>e.preventDefault()},style:E(`margin: 0 10px 0 0; width: ${x-3}px; height: ${x}px; appearance: checkbox; -moz-appearance: checkbox; -webkit-appearance: checkbox;`)}));async function Ae(e){Re&&(Re.checked=!Re.checked);const t=Promise.resolve(Ee(Object.assign({},ke,{event:e}))).catch(console.error);Y.showWorking?await(0,a.$A)(e.currentTarget,(()=>t),{styleContainer:`display: ${B?"inline-":""}flex; align-items: center; font-size: 14px; cursor: default; padding: ${v}; margin: 2px; user-select: none; white-space: nowrap;`,styleImg:`height: ${x}px; width: ${x}px;`,styleLabel:`${B?"display: none":""}; margin: 0 10px; max-width: ${y}; ${a.dQ}`}):await t,$.forEach((e=>e(ke))),Y.delayedClose&&await(0,s.BK)(Y.delayedClose),Y.preventClose||C()}const Ne=e=>t=>{t.stopPropagation();let i=!0;t.stopImmediatePropagation=()=>i=!1,e(t),i&&C()},Le=ie||(te?await te(ke):ee?(0,n.C8)(ee):""),Oe=await(0,d.u)(V,ke),Te=q&&await q(ke)||`${Z&&Oe||j||(K?(0,n.C8)(K):"")}\n${f&&U?(0,n.tr)("cm_shortcut_title",U):""}`.trim(),He=[],ze=(0,r.yf)((await Promise.all(X.map((e=>R(Object.assign({},k,Pe),e,A,{darkTheme:N,mainStyle:L},He,!0))))).filter(s.zz),(e=>e.isSeparator)),Be=ze.length>0,Ue=ze.some((e=>e.children.length>0));if((X.length>0||me)&&!Be)return!1;O.push(...He);const Fe=Be?(0,p.z)("div",{class:"context-menu-items-container",style:E(`${L}; position: absolute; display: none; box-shadow: 0px 0px 2px -1px; ${Ue?"":"max-height: 100vh; overflow-y: auto;"}${G}`),handlers:{...(0,o.Z5)("visibility: show; display: block;","",{important:e})}},ze.map((e=>e.node))):void 0,Xe=De?"opacity: 0.5;":"",Ye=De?Ne(Ge):T?Ne(Ae):Ae,Ve=(0,p.z)(Se?"a":"div",{...Se?{href:Se,target:"_blank"}:{},...t?{"data-testid":`cm_${F}`}:{},style:E(`display: ${B?"inline-":""}flex; align-items: center; font-size: 14px; padding: ${v}; margin: 2px; cursor: pointer; user-select: none; white-space: nowrap; \n        ${i?"border-radius: 4px;":""}\n        ${Se?"text-decoration: none; color: inherit;":""}\n        ${xe}`),title:`${Ce?`${(0,n.tr)("msg_pro_header")}\n${(0,n.tr)("msg_pro_support")}\n\n`:""}${Te}`.trim(),handlers:{onclick:Ye,...de?{onauxclick:Ye}:{},...(0,o.Z5)(be&&!Be?"filter: brightness(85%)":`background:${I}${N?"42":""};`,be&&!Be?"filter: brightness(75%)":`background:${b}${N?"84":""}`,{important:e})}},[Re||(0,p.z)("img",{style:E(`${Xe} height: ${x}px; width: ${x}px; ${le&&N?"filter: invert(1);":""}${oe||""}; ${N?re:""}`),src:ae?(0,c.Z)(ae):_.RO}),(0,p.z)("label",{style:E(`${Xe}${B?"display: none":""}; margin: 0 10px; cursor: pointer; max-width: ${y}; ${a.dQ}`),textContent:Oe}),Le&&(0,p.z)("i",{style:E(`margin-left: auto; opacity: 0.5;${Ie}`),textContent:Le}),Be&&(0,p.z)("img",{style:E("margin: 0 0 0 auto; height: 12px; opacity: 0.5;"+(N?"filter: invert(1);":"")),src:(0,c.Z)("utils/svg/keyboard-right-arrow-button.svg")}),Ce&&(0,p.z)("img",{style:E(`margin: 0 0 0 ${Le||Be?"5px":"auto"}; height: ${x}px; width: ${x}px;`),src:(0,c.Z)(Ce),handlers:{onclick:(0,g.do)(Ge)}}),Be&&(0,p.z)("div",{style:E("position: absolute; left: 0; width: 100%; align-self: start;")},Fe&&[Fe])].filter(s.zz));return Ve.addEventListener("mouseleave",(e=>{he?.(!1,e,ke),Fe&&ue?.(!1,e,ke)})),Ve.addEventListener("mouseenter",(async e=>{await(0,s.BK)(0),function(e){S.filter((t=>!t.children.find((t=>t.id===e)))).forEach((e=>e.hideChildNode()))}(H),he?.(!0,e,ke),Fe&&((0,a.eC)(Fe,"display","block"),(0,a.eC)(Fe,"top",(0,w.px)(-2-parseInt((0,u.u)(v,"","px"))||0)),M?function(){if(!Fe)return;(0,a.eC)(Fe,"left","100%");const{right:e}=Fe.getBoundingClientRect();e>window.innerWidth&&((0,a.eC)(Fe,"left",""),(0,a.eC)(Fe,"right","100%"),M=!1);const{left:t}=Fe.getBoundingClientRect();t<0&&((0,a.eC)(Fe,"left",""),(0,a.eC)(Fe,"right",`calc(100% + ${t}px)`))}():function(){if(!Fe)return;(0,a.eC)(Fe,"right","100%");const{left:e}=Fe.getBoundingClientRect();e<0&&((0,a.eC)(Fe,"right",""),(0,a.eC)(Fe,"left","100%"));const{right:t}=Fe.getBoundingClientRect();t>window.innerWidth&&((0,a.eC)(Fe,"right",""),(0,a.eC)(Fe,"left",`calc(100% - ${t-window.innerWidth}px)`))}(),function(){if(!Fe)return;const{bottom:e}=Fe.getBoundingClientRect(),t=e-window.innerHeight;t>0&&(0,a.eC)(Fe,"top",(0,w.px)(parseInt(Fe.style.top||"0")-t))}(),ue?.(!0,e,ke))})),z({id:H,actionId:F,isSeparator:!1,node:Ve,executeAction:()=>Ee(ke),key:U,children:He,hideChildNode:()=>{Fe&&((0,a.eC)(Fe,"display","none"),(0,a.eC)(Fe,"right",""),(0,a.eC)(Fe,"left",""))}})}}},3700:(e,t,i)=>{i.d(t,{j:()=>s});class s extends Map{options;constructor(e={}){super(e.entries||e.iterable),this.options=e}get(e){const t=super.get(e),i=t||new Set;return t||super.set(e,i),i}add(e,t){const i=this.get(e);return i.add(t),super.set(e,i)}remove(e,t){const i=this.get(e);return i.delete(t),super.set(e,i)}map(e){const t=new s;for(const[i,s]of this){const n=new Set;let a=0;for(const t of s)n.add(e(t,a++,i));t.set(i,n)}return t}}},6898:(e,t,i)=>{function s(e,t){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)}i.d(t,{U:()=>s})}}]);