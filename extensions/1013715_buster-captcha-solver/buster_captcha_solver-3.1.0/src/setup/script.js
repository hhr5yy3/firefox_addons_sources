(()=>{"use strict";var t,e={8085:(t,e,s)=>{var n=s(7416),a=s(1128),i=s(2024),o=s(822),r=s(4526);const l={key:0,class:"wrap"},c={class:"title"},d={class:"desc"},u={key:1,class:"manifest-desc"},p={key:1,class:"wrap"},f={class:"title"},m={class:"desc"},g=(0,o.Lk)("div",{class:"success-icon"},"ðŸŽ‰",-1),w={key:2,class:"wrap"},h={class:"title error-title"},b={class:"desc"};var v=s(4910),y=s(8618);const D={components:{[v.qw.name]:v.qw,[v.$n.name]:v.$n,[v.A_.name]:v.A_},data:function(){const t=new URL(window.location.href).searchParams,e=new URL("http://127.0.0.1/api/v1");return e.port=t.get("port"),{dataLoaded:!1,apiUrl:e.href,session:t.get("session"),browser:"",appDir:"",manifestDir:"",manifestDirEditable:!1,isInstalling:!1,isInstallSuccess:!1,isInstallError:!1}},methods:{getText:y.q4,getExtensionId:function(){let t=browser.runtime.id;return this.$env.isFirefox||(t=`${window.location.protocol}//${t}/`),t},setLocation:async function(){try{await this.location()}catch(t){this.isInstallError=!0,console.log(t.toString())}},runInstall:async function(){this.isInstalling=!0;try{await this.install()}catch(t){this.isInstallError=!0,console.log(t.toString())}finally{this.isInstalling=!1}if(this.isInstallSuccess){const t=new FormData;t.append("session",this.session),await fetch(`${this.apiUrl}/setup/close`,{method:"POST",body:t}),await browser.runtime.sendMessage({id:"clientAppInstall"})}},location:async function(){const t=new FormData;t.append("session",this.session),t.append("browser",this.browser),t.append("targetEnv",this.$env.targetEnv);const e=await fetch(`${this.apiUrl}/setup/location`,{method:"POST",body:t}),s=await e.json();if(200!==e.status)throw new Error(s.error);this.appDir=s.appDir,this.manifestDir=s.manifestDir},install:async function(){const t=new FormData;t.append("session",this.session),t.append("appDir",this.appDir),t.append("manifestDir",this.manifestDir),t.append("browser",this.browser),t.append("targetEnv",this.$env.targetEnv),t.append("extension",this.getExtensionId());const e=await fetch(`${this.apiUrl}/setup/install`,{method:"POST",body:t});if(200!==e.status)throw new Error((await e.json()).error);await(0,a.FM)(),this.isInstallSuccess=!0}},created:async function(){this.browser=(await browser.runtime.sendMessage({id:"getBrowser"})).name,await this.setLocation(),this.$env.isWindows||(this.manifestDirEditable=!0),this.dataLoaded=!0}},x=(0,s(1535).A)(D,[["render",function(t,e,s,n,a,i){const v=(0,o.g2)("vn-text-field"),y=(0,o.g2)("vn-button"),D=(0,o.g2)("vn-app");return t.dataLoaded?((0,o.uX)(),(0,o.Wv)(D,{key:0},{default:(0,o.k6)((()=>[t.isInstallSuccess||t.isInstallError?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",c,(0,r.v_)(i.getText("pageContent_installTitle")),1),(0,o.eW)(),(0,o.Lk)("div",d,(0,r.v_)(i.getText("pageContent_installDesc")),1),(0,o.eW)(),(0,o.bF)(v,{label:i.getText("inputLabel_appLocation"),modelValue:t.appDir,"onUpdate:modelValue":e[0]||(e[0]=e=>t.appDir=e),modelModifiers:{trim:!0}},null,8,["label","modelValue"]),(0,o.eW)(),t.manifestDirEditable?((0,o.uX)(),(0,o.Wv)(v,{key:0,class:"manifest-location",label:i.getText("inputLabel_manifestLocation"),modelValue:t.manifestDir,"onUpdate:modelValue":e[1]||(e[1]=e=>t.manifestDir=e),modelModifiers:{trim:!0}},null,8,["label","modelValue"])):(0,o.Q3)("",!0),(0,o.eW)(),t.manifestDirEditable?((0,o.uX)(),(0,o.CE)("div",u,(0,r.v_)(i.getText("pageContent_manifestLocationDesc")),1)):(0,o.Q3)("",!0),(0,o.eW)(),(0,o.bF)(y,{class:"button install-button",disabled:t.isInstalling||!t.appDir||t.manifestDirEditable&&!t.manifestDir,onClick:i.runInstall,variant:"elevated"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(i.getText("buttonLabel_installApp")),1)])),_:1},8,["disabled","onClick"])])),(0,o.eW)(),t.isInstallSuccess?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("div",f,(0,r.v_)(i.getText("pageContent_installSuccessTitle")),1),(0,o.eW)(),(0,o.Lk)("div",m,(0,r.v_)(i.getText("pageContent_installSuccessDesc")),1),(0,o.eW)(),g])):(0,o.Q3)("",!0),(0,o.eW)(),t.isInstallError?((0,o.uX)(),(0,o.CE)("div",w,[(0,o.Lk)("div",h,(0,r.v_)(i.getText("pageContent_installErrorTitle")),1),(0,o.eW)(),(0,o.Lk)("div",b,(0,r.v_)(i.getText("pageContent_installErrorDesc")),1),(0,o.eW)(),(0,o.bF)(y,{class:"button error-button",onClick:e[2]||(e[2]=e=>t.isInstallError=!1),variant:"elevated"},{default:(0,o.k6)((()=>[(0,o.eW)((0,r.v_)(i.getText("buttonLabel_goBack")),1)])),_:1})])):(0,o.Q3)("",!0)])),_:1})):(0,o.Q3)("",!0)}]]);window.top!==window&&async function(){await(0,a.rn)(["400 14px Roboto","500 14px Roboto"]);const t=(0,n.Ef)(x);await(0,a.K7)(t),await(0,i.H)(t),t.mount("body")}()},1128:(t,e,s)=>{s.d(e,{FM:()=>c,K7:()=>o,rL:()=>l,rn:()=>i,xB:()=>r});var n=s(786),a=s(8618);async function i(t){await Promise.allSettled(t.map((t=>document.fonts.load(t))))}async function o(t){const e=await(0,a.uo)(),s=[e.targetEnv,e.os];document.documentElement.classList.add(...s),t&&(t.config.globalProperties.$env=e)}async function r(t){return t||({appTheme:t}=await n.Ay.get("appTheme")),"auto"===t&&(t=(0,a.T6)().matches?"dark":"light"),t}function l(t){!function(t){(0,a.T6)().addEventListener("change",(function(){t()}))}(t),function(t){browser.storage.onChanged.addListener((function(e,s){"local"===s&&e.appTheme&&t()}))}(t)}async function c({start:t=!0,stop:e=!0,checkResponse:s=!0}={}){t&&await browser.runtime.sendMessage({id:"startClientApp"});const n=await browser.runtime.sendMessage({id:"messageClientApp",message:{command:"ping"}});if(e&&await browser.runtime.sendMessage({id:"stopClientApp"}),s&&(!n.success||"pong"!==n.data))throw new Error(`Client app response: ${n.data}`);return n}s(3655),s(4729)},8618:(t,e,s)=>{s.d(e,{T6:()=>l,q4:()=>i,uo:()=>r}),s(6166),s(4599),s(9191),s(9033),s(4665);var n=s(786),a=s(4729);function i(t,e){return browser.i18n.getMessage(t,e)}let o;async function r(){if(!function(){const t=a.tn?browser.runtime.getURL("/src/background/script.js"):browser.runtime.getURL("/src/background/index.html");return self.location.href===t}())return browser.runtime.sendMessage({id:"getPlatform"});let{os:t,arch:e}=await async function(){if(o)return o;if(a.tn)({platformInfo:o}=await n.Ay.get("platformInfo",{area:"session"}));else try{o=JSON.parse(window.sessionStorage.getItem("platformInfo"))}catch(t){}if(!o){let t,e;if("samsung"===a.Dm?(t="android",e=""):"safari"===a.Dm?({os:t,arch:e}=await browser.runtime.sendNativeMessage("application.id",{id:"getPlatformInfo"})):({os:t,arch:e}=await browser.runtime.getPlatformInfo()),o={os:t,arch:e},a.tn)await n.Ay.set({platformInfo:o},{area:"session"});else try{window.sessionStorage.setItem("platformInfo",JSON.stringify(o))}catch(t){}}return o}();"win"===t?t="windows":"mac"===t&&(t="macos"),["x86-32","i386"].includes(e)?e="386":["x86-64","x86_64"].includes(e)?e="amd64":e.startsWith("arm")&&(e="arm");const s="windows"===t,i="macos"===t,r="linux"===t,l="android"===t,c="ios"===t,d="ipados"===t,u=["android","ios","ipados"].includes(t),p="chrome"===a.Dm,f=["chrome","edge"].includes(a.Dm)&&/\sedg(?:e|a|ios)?\//i.test(navigator.userAgent),m="firefox"===a.Dm,g=["chrome","opera"].includes(a.Dm)&&/\sopr\//i.test(navigator.userAgent),w="safari"===a.Dm,h="samsung"===a.Dm;return{os:t,arch:e,targetEnv:a.Dm,isWindows:s,isMacos:i,isLinux:r,isAndroid:l,isIos:c,isIpados:d,isMobile:u,isChrome:p,isEdge:f,isFirefox:m,isOpera:g,isSafari:w,isSamsung:h}}function l(){return window.matchMedia("(prefers-color-scheme: dark)")}},4910:(t,e,s)=>{s.d(e,{$n:()=>a.A,A_:()=>r.A,In:()=>i.A,K0:()=>o.A,qw:()=>n.A});var n=s(4953),a=s(658),i=(s(9608),s(9737),s(4322),s(7546),s(8982),s(9945),s(5937),s(113)),o=s(5189),r=(s(8733),s(6173),s(4703),s(3068),s(382),s(5806),s(2471),s(3652),s(7626))}},s={};function n(t){var a=s[t];if(void 0!==a)return a.exports;var i=s[t]={exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,s,a,i)=>{if(!s){var o=1/0;for(d=0;d<t.length;d++){for(var[s,a,i]=t[d],r=!0,l=0;l<s.length;l++)(!1&i||o>=i)&&Object.keys(n.O).every((t=>n.O[t](s[l])))?s.splice(l--,1):(r=!1,i<o&&(o=i));if(r){t.splice(d--,1);var c=a();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[s,a,i]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.j=930,(()=>{var t={930:0};n.O.j=e=>0===t[e];var e=(e,s)=>{var a,i,[o,r,l]=s,c=0;if(o.some((e=>0!==t[e]))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(l)var d=l(n)}for(e&&e(s);c<o.length;c++)i=o[c],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(d)},s=globalThis.webpackChunkbuster=globalThis.webpackChunkbuster||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var a=n.O(void 0,[830],(()=>n(8085)));a=n.O(a)})();