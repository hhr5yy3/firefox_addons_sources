import{g as T,H as X,j as b,r as k,n as j,k as A,I as C,J as M,K as x,L as U,M as z,N as K,O as V,P as $,Q as G,c as J,a as Q,u as Z,R as B,v as ee,y as te,z as ne,w as re,S as ie}from"./cplx-CXGk_GMP.js";import{r as v}from"./cplx-M4JPizzD.js";import{j as L,s as se}from"./cplx-DEt7CUyc.js";function oe(t){const e={each(n){var r;for(let i=0;i<((r=t.frames)==null?void 0:r.length);i+=1){const s=t.frames[i];s&&n(s)}},addEventListener(n,r,i){return e.each(s=>{try{s.document.addEventListener(n,r,i)}catch{}}),()=>{try{e.removeEventListener(n,r,i)}catch{}}},removeEventListener(n,r,i){e.each(s=>{try{s.document.removeEventListener(n,r,i)}catch{}})}};return e}function ae(t){const e=t.frameElement!=null?t.parent:null;return{addEventListener:(n,r,i)=>{try{e==null||e.addEventListener(n,r,i)}catch{}return()=>{try{e==null||e.removeEventListener(n,r,i)}catch{}}},removeEventListener:(n,r,i)=>{try{e==null||e.removeEventListener(n,r,i)}catch{}}}}var D="pointerdown.outside",_="focus.outside";function ce(t){for(const e of t)if(M(e)&&j(e))return!0;return!1}var H=t=>"clientY"in t;function ue(t,e){if(!H(e)||!t)return!1;const n=t.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=e.clientY&&e.clientY<=n.top+n.height&&n.left<=e.clientX&&e.clientX<=n.left+n.width}function le(t,e){return t.y<=e.y&&e.y<=t.y+t.height&&t.x<=e.x&&e.x<=t.x+t.width}function F(t,e){if(!e||!H(t))return!1;const n=e.scrollHeight>e.clientHeight,r=n&&t.clientX>e.offsetLeft+e.clientWidth,i=e.scrollWidth>e.clientWidth,s=i&&t.clientY>e.offsetTop+e.clientHeight,l={x:e.offsetLeft,y:e.offsetTop,width:e.clientWidth+(n?16:0),height:e.clientHeight+(i?16:0)},a={x:t.clientX,y:t.clientY};return le(l,a)?r||s:!1}function de(t,e){const{exclude:n,onFocusOutside:r,onPointerDownOutside:i,onInteractOutside:s,defer:l}=e;if(!t)return;const a=T(t),m=X(t),u=oe(m),h=ae(m);function N(c){const p=A(c);if(!M(p)||!p.isConnected||x(t,p)||ue(t,c))return!1;const g=a.querySelector(`[aria-controls="${t.id}"]`);if(g){const O=U(g);if(F(c,O))return!1}const S=U(t);return F(c,S)?!1:!(n!=null&&n(p))}const o=new Set;function f(c){function p(){var O;const g=l?k:I=>I(),S=((O=c.composedPath)==null?void 0:O.call(c))??[c.target];g(()=>{if(!(!t||!N(c))){if(i||s){const I=C(i,s);t.addEventListener(D,I,{once:!0})}R(t,D,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:z(c),focusable:ce(S)}})}})}c.pointerType==="touch"?(o.forEach(g=>g()),o.add(b(a,"click",p,{once:!0})),o.add(h.addEventListener("click",p,{once:!0})),o.add(u.addEventListener("click",p,{once:!0}))):p()}const d=new Set,E=setTimeout(()=>{d.add(b(a,"pointerdown",f,!0)),d.add(h.addEventListener("pointerdown",f,!0)),d.add(u.addEventListener("pointerdown",f,!0))},0);function P(c){(l?k:g=>g())(()=>{if(!(!t||!N(c))){if(r||s){const g=C(r,s);t.addEventListener(_,g,{once:!0})}R(t,_,{bubbles:!1,cancelable:!0,detail:{originalEvent:c,contextmenu:!1,focusable:j(A(c))}})}})}return d.add(b(a,"focusin",P,!0)),d.add(h.addEventListener("focusin",P,!0)),d.add(u.addEventListener("focusin",P,!0)),()=>{clearTimeout(E),o.forEach(c=>c()),d.forEach(c=>c())}}function me(t,e){const{defer:n}=e,r=n?k:s=>s(),i=[];return i.push(r(()=>{const s=typeof t=="function"?t():t;i.push(de(s,e))})),()=>{i.forEach(s=>s==null?void 0:s())}}function R(t,e,n){const r=t.ownerDocument.defaultView||window,i=new r.CustomEvent(e,n);return t.dispatchEvent(i)}function fe(t,e){const n=r=>{r.key==="Escape"&&(r.isComposing||e==null||e(r))};return b(T(t),"keydown",n,{capture:!0})}var y={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(t=>t.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(t){var r;const e=this.indexOf(t),n=this.topMostPointerBlockingLayer()?this.indexOf((r=this.topMostPointerBlockingLayer())==null?void 0:r.node):-1;return e<n},isTopMost(t){const e=this.layers[this.count()-1];return(e==null?void 0:e.node)===t},getNestedLayers(t){return Array.from(this.layers).slice(this.indexOf(t)+1)},isInNestedLayer(t,e){return this.getNestedLayers(t).some(n=>x(n.node,e))},isInBranch(t){return Array.from(this.branches).some(e=>x(e,t))},add(t){const e=this.layers.push(t);t.node.style.setProperty("--layer-index",`${e}`)},addBranch(t){this.branches.push(t)},remove(t){const e=this.indexOf(t);e<0||(e<this.count()-1&&this.getNestedLayers(t).forEach(r=>r.dismiss()),this.layers.splice(e,1),t.style.removeProperty("--layer-index"))},removeBranch(t){const e=this.branches.indexOf(t);e>=0&&this.branches.splice(e,1)},indexOf(t){return this.layers.findIndex(e=>e.node===t)},dismiss(t){var e;(e=this.layers[this.indexOf(t)])==null||e.dismiss()},clear(){this.remove(this.layers[0].node)}},W;function q(){y.layers.forEach(({node:t})=>{t.style.pointerEvents=y.isBelowPointerBlockingLayer(t)?"none":"auto"})}function he(t){t.style.pointerEvents=""}function ye(t,e){const n=T(t),r=[];if(y.hasPointerBlockingLayer()&&!n.body.hasAttribute("data-inert")&&(W=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents="none",n.body.setAttribute("data-inert","")})),e){const i=$(e,s=>{r.push(G(s,{pointerEvents:"auto"}))});r.push(i)}return()=>{y.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=W,n.body.removeAttribute("data-inert"),n.body.style.length===0&&n.body.removeAttribute("style")}),r.forEach(i=>i()))}}function Ee(t,e){if(!t){V("[@zag-js/dismissable] node is `null` or `undefined`");return}const{onDismiss:n,pointerBlocking:r,exclude:i,debug:s}=e,l={dismiss:n,node:t,pointerBlocking:r};y.add(l),q();function a(o){var d,E;const f=A(o.detail.originalEvent);y.isBelowPointerBlockingLayer(t)||y.isInBranch(f)||((d=e.onPointerDownOutside)==null||d.call(e,o),(E=e.onInteractOutside)==null||E.call(e,o),!o.defaultPrevented&&(s&&console.log("onPointerDownOutside:",o.detail.originalEvent),n==null||n()))}function m(o){var d,E;const f=A(o.detail.originalEvent);y.isInBranch(f)||((d=e.onFocusOutside)==null||d.call(e,o),(E=e.onInteractOutside)==null||E.call(e,o),!o.defaultPrevented&&(s&&console.log("onFocusOutside:",o.detail.originalEvent),n==null||n()))}function u(o){var f;y.isTopMost(t)&&((f=e.onEscapeKeyDown)==null||f.call(e,o),!o.defaultPrevented&&n&&(o.preventDefault(),n()))}function h(o){var P;if(!t)return!1;const f=typeof i=="function"?i():i,d=Array.isArray(f)?f:[f],E=(P=e.persistentElements)==null?void 0:P.map(c=>c()).filter(M);return E&&d.push(...E),d.some(c=>x(c,o))||y.isInNestedLayer(t,o)}const N=[r?ye(t,e.persistentElements):void 0,fe(t,u),me(t,{exclude:h,onFocusOutside:m,onPointerDownOutside:a,defer:e.defer})];return()=>{y.remove(t),q(),he(t),N.forEach(o=>o==null?void 0:o())}}function be(t,e){const{defer:n}=e,r=n?k:s=>s(),i=[];return i.push(r(()=>{const s=K(t)?t():t;i.push(Ee(s,e))})),()=>{r(()=>{i.forEach(s=>s==null?void 0:s())})}}const[ke,Ae]=J({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"}),xe=t=>Q()(t,["immediate","lazyMount","onExitComplete","present","unmountOnExit"]);function pe(t,e,n){const r=t.matches("mounted","unmountSuspended");return{skip:!t.context.initial&&r,present:r,setNode(i){i&&e({type:"NODE.SET",node:i})},unmount(){e({type:"UNMOUNT"})}}}function ge(t){return Z({initial:t.present?"mounted":"unmounted",context:{node:null,styles:null,unmountAnimationName:null,prevAnimationName:null,present:!1,initial:!1,...t},exit:["clearInitial","cleanupNode"],watch:{present:["setInitial","syncPresence"]},on:{"NODE.SET":{actions:["setNode","setStyles"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]},"UNMOUNT.SUSPEND":"unmountSuspended"}},unmountSuspended:{activities:["trackAnimationEvents"],after:{ANIMATION_DURATION:{target:"unmounted",actions:["invokeOnExitComplete"]}},on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]}}},unmounted:{entry:["clearPrevAnimationName"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}}},{delays:{ANIMATION_DURATION(e){var n,r;return Y((n=e.styles)==null?void 0:n.animationDuration)+Y((r=e.styles)==null?void 0:r.animationDelay)+Ne}},actions:{setInitial(e){e.initial=!0},clearInitial(e){e.initial=!1},cleanupNode(e){e.node=null,e.styles=null},invokeOnExitComplete(e){var n;(n=e.onExitComplete)==null||n.call(e)},setNode(e,n){e.node=B(n.node)},setStyles(e,n){const r=n.node.ownerDocument.defaultView||window;e.styles=B(r.getComputedStyle(n.node))},syncPresence(e,n,{send:r}){var l;if(e.present){r({type:"MOUNT",src:"presence.changed"});return}if(!e.present&&((l=e.node)==null?void 0:l.ownerDocument.visibilityState)==="hidden"){r({type:"UNMOUNT",src:"visibilitychange"});return}const i=w(e.styles);(e.immediate?queueMicrotask:requestAnimationFrame)(()=>{var a,m;e.unmountAnimationName=i,i==="none"||i===e.prevAnimationName||((a=e.styles)==null?void 0:a.display)==="none"||((m=e.styles)==null?void 0:m.animationDuration)==="0s"?r({type:"UNMOUNT",src:"presence.changed"}):r({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName(e){(e.immediate?queueMicrotask:requestAnimationFrame)(()=>{e.prevAnimationName=w(e.styles)})},clearPrevAnimationName(e){e.prevAnimationName=null}},activities:{trackAnimationEvents(e,n,{send:r}){const i=e.node;if(!i)return;const s=a=>{var u,h;(((h=(u=a.composedPath)==null?void 0:u.call(a))==null?void 0:h[0])??a.target)===i&&(e.prevAnimationName=w(e.styles))},l=a=>{var h,N;const m=w(e.styles);(((N=(h=a.composedPath)==null?void 0:h.call(a))==null?void 0:N[0])??a.target)===i&&m===e.unmountAnimationName&&r({type:"UNMOUNT",src:"animationend"})};return i.addEventListener("animationstart",s),i.addEventListener("animationcancel",l),i.addEventListener("animationend",l),()=>{i.removeEventListener("animationstart",s),i.removeEventListener("animationcancel",l),i.removeEventListener("animationend",l)}}}})}function w(t){return(t==null?void 0:t.animationName)||"none"}function Y(t){return parseFloat(t||"0")*1e3}var Ne=16.667;ee()(["onExitComplete","present","immediate"]);const Te=t=>{const{lazyMount:e,unmountOnExit:n,present:r,...i}=t,s=v.useRef(!1),l={...i,present:r,onExitComplete:te(t.onExitComplete)},[a,m]=ne(ge(l),{context:l}),u=pe(a,m);u.present&&(s.current=!0);const h=!u.present&&!s.current&&e||n&&!u.present&&s.current,N=()=>({"data-state":r?"open":"closed",hidden:!u.present});return{ref:u.setNode,getPresenceProps:N,present:u.present,unmounted:h}},Se=t=>{var m;const{children:e,disabled:n}=t,[r,i]=v.useState((m=t.container)==null?void 0:m.current),s=v.useSyncExternalStore(ve,()=>!1,()=>!0),{getRootNode:l}=re();if(v.useEffect(()=>{i(()=>{var u;return(u=t.container)==null?void 0:u.current})},[t.container]),s||n)return L.jsx(L.Fragment,{children:e});const a=r??Pe(l);return L.jsx(L.Fragment,{children:v.Children.map(e,u=>se.createPortal(u,a))})},Pe=t=>{const e=t==null?void 0:t(),n=e.getRootNode();return ie(n)?n:T(e).body},ve=()=>()=>{};export{ke as P,Ae as a,Se as b,xe as s,be as t,Te as u};
