var hostName_="com.webex.meeting",mSession=new Map;function Session(e){var s=null,o=e,a=o.name;o.onMessage.addListener(function(e){null!=s&&s.postMessage(e)}),o.onDisconnect.addListener(function(){if(null!=s){var e={timestamp:(new Date).toUTCString(),token:a,message_type:"disconnect",message:"disconnect"};s.postMessage(e)}o=null}),this.handleError=function(e){var n={timestamp:(new Date).toUTCString(),token:a,message_type:"error",message:{error_no:-2,error_message:e}};o.postMessage(n)},this.connectNative=function(){try{(s=chrome.runtime.connectNative(hostName_)).name=a,s.onMessage.addListener(function(e){null!=o&&o.postMessage(e)}),s.onDisconnect.addListener(function(){var e="";if(null!=chrome.runtime.lastError&&null!=chrome.runtime.lastError.message&&(e=chrome.runtime.lastError.message),null!=o){var n={timestamp:(new Date).toUTCString(),token:a,message_type:"disconnect",message:e};o.postMessage(n),o.disconnect()}var t=mSession.get(s.name);mSession.delete(s.name),(s=o=null)!=t&&delete t});var e={timestamp:(new Date).toUTCString(),token:a,message_type:"hello",message:"hello"};s.postMessage(e)}catch(e){this.handleError(e.toString())}}}var Background=function(e){return e.handleClientConnect=function(e){var n=new Session(e);mSession.set(e.name,n),n.connectNative()},e.init=function(){chrome.runtime.onConnect.addListener(e.handleClientConnect),chrome.runtime.onMessage.addListener(function(e,n){})},e}(Background||{});window.addEventListener("load",function(){Background.init()},!1);