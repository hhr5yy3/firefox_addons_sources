class ContextSaver{target;contextmenuTimeout;fireEagleRightMouseupTimeout;onSave;constructor({onSave:e}){this.target=null,this.onSave=e||(()=>{}),this.registerGlobalEvents(),this.registerRuntimeChannel()}fireEagleRightMouseup(e){e.target.dispatchEvent(new MouseEvent("eagle-right-mouseup",e))}registerGlobalEvents(){const t={x:0,y:0};$(document).on("contextmenu","body",async e=>{e.altKey&&(e.preventDefault(),e.stopPropagation()),this.fireEagleRightMouseup(e)}),$(document).on("mousedown","body",async e=>{2===e.button&&(t.x=e.clientX,t.y=e.clientY)}),$(document).on("mouseup","body",async e=>{2===e.button&&this.fireEagleRightMouseup(e)}),$(document).on("eagle-right-mouseup","body",eagle.utils.debounce(async e=>{t.x&&t.y&&5<Math.sqrt(Math.pow(t.x-e.clientX,2)+Math.pow(t.y-e.clientY,2))||(t.x=0,t.y=0,e.altKey&&(e.preventDefault(),e.stopPropagation()),eagle.elementInspector.setTarget(e),this.target)||(this.target=eagle.elementInspector.getTarget(),this.target&&(clearTimeout(this.contextmenuTimeout),this.contextmenuTimeout=setTimeout(async()=>{if(e.altKey){if(!await eagle.env.isReady())return void(this.target=null);var t=e;try{var a=t.clientX,n=t.clientY;let e=$(`<div style="top: ${n-30}px; left: ${a-30}px;" class="eagle-click-effect-circle"><div></div><div></div></div>`);$("body").append(e),setTimeout(()=>{e.remove()},1e3)}catch(e){}this.onSave(this.target)}this.target=null},150)))},100,!0))}registerRuntimeChannel(){eagle.runtime.onMessage("context-save",async(e,t,a)=>{var n;await eagle.env.isReady()&&(n=eagle.elementInspector.getTarget())&&this.onSave(n)})}}