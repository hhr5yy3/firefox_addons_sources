{"version":3,"file":"background/index.js","mappings":"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","sources":["webpack://container-proxy/./src/background/BackgroundMain.ts","webpack://container-proxy/./src/domain/ProxySettings.ts","webpack://container-proxy/./src/domain/ProxyType.ts","webpack://container-proxy/./src/options/util.ts","webpack://container-proxy/./src/store/Store.ts","webpack://container-proxy/webpack/bootstrap","webpack://container-proxy/webpack/runtime/define property getters","webpack://container-proxy/webpack/runtime/hasOwnProperty shorthand","webpack://container-proxy/webpack/runtime/make namespace object","webpack://container-proxy/./src/background/index.ts"],"sourcesContent":["import { Store } from '../store/Store'\nimport { HttpProxySettings, HttpsProxySettings, ProxySettings } from '../domain/ProxySettings'\nimport { ProxyInfo, Socks5ProxyInfo } from '../domain/ProxyInfo'\nimport { ProxyType } from '../domain/ProxyType'\nimport BlockingResponse = browser.webRequest.BlockingResponse\nimport _OnAuthRequiredDetails = browser.webRequest._OnAuthRequiredDetails\nimport _OnRequestDetails = browser.proxy._OnRequestDetails\n\nconst localhosts = new Set(['localhost', '127.0.0.1', '[::1]'])\n\ntype DoNotProxy = never[]\nexport const doNotProxy: DoNotProxy = []\n\nconst emergencyBreak: Socks5ProxyInfo = {\n  type: ProxyType.Socks5,\n  host: 'emergency-break-proxy.localhost',\n  port: 1,\n  failoverTimeout: 1,\n  username: 'nonexistent user',\n  password: 'dummy password',\n  proxyDNS: true\n}\n\nexport default class BackgroundMain {\n  store: Store\n\n  constructor ({ store }: { store: Store }) {\n    this.store = store\n  }\n\n  initializeAuthListener (cookieStoreId: string, proxy: HttpProxySettings | HttpsProxySettings): void {\n    const listener: (details: _OnAuthRequiredDetails) => BlockingResponse = (details) => {\n      if (!details.isProxy) return {}\n\n      if (details.cookieStoreId !== cookieStoreId) return {}\n\n      // TODO: Fix in @types/firefox-webext-browser\n      // @ts-expect-error\n      const info = details.proxyInfo\n      if (info.host !== proxy.host || info.port !== proxy.port || info.type !== proxy.type) return {}\n\n      const result = { authCredentials: { username: proxy.username, password: proxy.password } }\n\n      browser.webRequest.onAuthRequired.removeListener(listener)\n\n      return result\n    }\n\n    browser.webRequest.onAuthRequired.addListener(\n      listener,\n      { urls: ['<all_urls>'] },\n      ['blocking']\n    )\n  }\n\n  openPreferences (browser: { runtime: any }) {\n    return () => {\n      browser.runtime.openOptionsPage()\n    }\n  }\n\n  // TODO: Fix in @types/firefox-webext-browser\n  async onRequest (requestDetails: Pick<_OnRequestDetails, 'cookieStoreId' | 'url'>): Promise<DoNotProxy | ProxyInfo[]> {\n    try {\n      const cookieStoreId = requestDetails.cookieStoreId ?? ''\n      if (cookieStoreId === '') {\n        console.error('cookieStoreId is not defined', requestDetails)\n        return doNotProxy\n      }\n\n      const proxies = await this.store.getProxiesForContainer(cookieStoreId)\n\n      if (proxies.length > 0) {\n        proxies.forEach(p => {\n          if (p.type === ProxyType.Http || p.type === ProxyType.Https) {\n            this.initializeAuthListener(cookieStoreId, p)\n          }\n        })\n\n        const result: ProxyInfo[] = proxies.filter((p: ProxySettings) => {\n          try {\n            const documentUrl = new URL(requestDetails.url)\n            const isLocalhost = localhosts.has(documentUrl.hostname)\n            if (isLocalhost && p.doNotProxyLocal) {\n              return false\n            }\n          } catch (e) {\n            console.error(e)\n          }\n\n          return true\n        }).map(p => p.asProxyInfo())\n\n        if (result.length === 0) {\n          return doNotProxy\n        }\n        return result\n      }\n\n      return doNotProxy\n    } catch (e: unknown) {\n      console.error(`Error in onRequest listener: ${e as string}`)\n      return [emergencyBreak]\n    }\n  }\n\n  run (browser: { proxy: any, browserAction: any, runtime: any }): void {\n    const filter = { urls: ['<all_urls>'] }\n\n    browser.proxy.onRequest.addListener(this.onRequest.bind(this), filter)\n\n    browser.browserAction.onClicked.addListener(this.openPreferences(browser))\n\n    browser.proxy.onError.addListener((e: Error) => {\n      console.error('Proxy error', e)\n    })\n  }\n}\n","import { ProxyType } from './ProxyType'\nimport { ProxyDao } from '../store/Store'\nimport { HttpProxyInfo, HttpsProxyInfo, ProxyInfo, Socks4ProxyInfo, Socks5ProxyInfo } from './ProxyInfo'\nimport { generateAuthorizationHeader } from '../options/util'\n\n/* eslint-disable @typescript-eslint/no-namespace,@typescript-eslint/no-redeclare */\n\nexport type ProxySettings = Socks4ProxySettings | Socks5ProxySettings | HttpProxySettings | HttpsProxySettings\n\nconst failoverTimeout = 5\n\nexport namespace ProxySettings {\n\n  export function tryFromDao (dao: ProxyDao): ProxySettings | undefined {\n    switch (dao.type) {\n      case 'socks':\n        return new Socks5ProxySettings(dao)\n      case 'socks4':\n        return new Socks4ProxySettings(dao)\n      case 'http':\n        return new HttpProxySettings(dao)\n      case 'https':\n        return new HttpsProxySettings(dao)\n      default:\n        return undefined\n    }\n  }\n}\n\nabstract class ProxySettingsBase<PI extends ProxyInfo> {\n  readonly id: string\n  readonly title: string\n  readonly host: string\n  readonly port: number\n  readonly doNotProxyLocal: boolean\n\n  protected constructor (dao: ProxyDao) {\n    this.id = dao.id\n    this.title = dao.title\n    this.host = dao.host\n    this.port = dao.port\n    this.doNotProxyLocal = dao.doNotProxyLocal\n  }\n\n  abstract get type (): PI['type']\n\n  abstract asProxyInfo (): PI\n\n  abstract asDao (): ProxyDao\n\n  get url (): string {\n    return `${this.type}://${this.host}:${this.port}`\n  }\n\n  protected baseDao (): ProxyDao {\n    return {\n      id: this.id,\n      title: this.title,\n      type: this.type,\n      host: this.host,\n      port: this.port,\n      doNotProxyLocal: this.doNotProxyLocal\n    }\n  }\n}\n\nexport class Socks5ProxySettings extends ProxySettingsBase<Socks5ProxyInfo> {\n  readonly username?: string\n  readonly password?: string\n  readonly proxyDNS: boolean\n\n  constructor (dao: ProxyDao) {\n    super(dao)\n    this.username = dao.username\n    this.password = dao.password\n    this.proxyDNS = dao.proxyDNS ?? true\n  }\n\n  get type (): ProxyType.Socks5 {\n    return ProxyType.Socks5\n  }\n\n  asProxyInfo (): Socks5ProxyInfo {\n    return {\n      type: this.type,\n      host: this.host,\n      port: this.port,\n      username: this.username ?? '',\n      password: this.password ?? '',\n      proxyDNS: this.proxyDNS,\n      failoverTimeout\n    }\n  }\n\n  asDao (): ProxyDao {\n    return { ...super.baseDao(), username: this.username, password: this.password, proxyDNS: this.proxyDNS }\n  }\n}\n\nexport class Socks4ProxySettings extends ProxySettingsBase<Socks4ProxyInfo> {\n  readonly proxyDNS: boolean\n\n  constructor (dao: ProxyDao) {\n    super(dao)\n    this.proxyDNS = dao.proxyDNS ?? true\n  }\n\n  get type (): ProxyType.Socks4 {\n    return ProxyType.Socks4\n  }\n\n  asProxyInfo (): Socks4ProxyInfo {\n    return {\n      type: this.type,\n      host: this.host,\n      port: this.port,\n      proxyDNS: this.proxyDNS,\n      failoverTimeout\n    }\n  }\n\n  asDao (): ProxyDao {\n    return { ...super.baseDao(), proxyDNS: this.proxyDNS }\n  }\n}\n\nabstract class HttpBasedProxySettings<PI extends (HttpsProxyInfo | HttpProxyInfo)> extends ProxySettingsBase<PI> {\n  readonly username?: string\n  readonly password?: string\n\n  constructor (dao: ProxyDao) {\n    super(dao)\n    this.username = dao.username\n    this.password = dao.password\n  }\n\n  asDao (): ProxyDao {\n    return { ...super.baseDao(), username: this.username, password: this.password }\n  }\n}\n\nexport class HttpsProxySettings extends HttpBasedProxySettings<HttpsProxyInfo> {\n  get type (): ProxyType.Https {\n    return ProxyType.Https\n  }\n\n  asProxyInfo (): HttpsProxyInfo {\n    return {\n      type: this.type,\n      host: this.host,\n      port: this.port,\n      proxyAuthorizationHeader: generateAuthorizationHeader(this.username ?? '', this.password ?? ''),\n      failoverTimeout\n    }\n  }\n}\n\nexport class HttpProxySettings extends HttpBasedProxySettings<HttpProxyInfo> {\n  get type (): ProxyType.Http {\n    return ProxyType.Http\n  }\n\n  asProxyInfo (): HttpProxyInfo {\n    return {\n      type: this.type,\n      host: this.host,\n      port: this.port,\n      failoverTimeout\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/no-namespace,no-redeclare,import/export */\n\nexport enum ProxyType {\n  Socks5 = 'socks',\n  Socks4 = 'socks4',\n  Http = 'http',\n  Https = 'https'\n}\n\nexport namespace ProxyType {\n  export function tryFromString (s: string): ProxyType | undefined {\n    switch (s) {\n      case 'socks':\n        return ProxyType.Socks5\n      case 'socks4':\n        return ProxyType.Socks4\n      case 'http':\n        return ProxyType.Http\n      case 'https':\n        return ProxyType.Https\n      default:\n        return undefined\n    }\n  }\n}\n","export function uuidv4 (): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, character => {\n    const random = Math.random() * 16 | 0\n    const v = character === 'x' ? random : (random & 0x3 | 0x8)\n    return v.toString(16)\n  })\n}\n\nexport function generateAuthorizationHeader (username: string, password: string): string {\n  return 'Basic ' + btoa(`${username}:${password}`)\n}\n","import { ProxyInfo } from '../domain/ProxyInfo'\nimport { ProxyType } from '../domain/ProxyType'\nimport { generateAuthorizationHeader } from '../options/util'\nimport { ProxySettings } from '../domain/ProxySettings'\nimport tryFromDao = ProxySettings.tryFromDao\n\n/* eslint-disable @typescript-eslint/no-namespace,no-redeclare,import/export */\n\nexport interface ProxyDao {\n  id: string\n  title: string\n  type: string\n  host: string\n  port: number\n  username?: string\n  password?: string\n  proxyDNS?: boolean\n  doNotProxyLocal: boolean\n}\n\nexport namespace ProxyDao {\n  export function toProxyInfo (proxy: Pick<ProxyDao, 'type' | 'host' | 'port' | 'username' | 'password' | 'proxyDNS'>): ProxyInfo | undefined {\n    const type = ProxyType.tryFromString(proxy.type)\n    if (type === undefined) {\n      return\n    }\n\n    const base = {\n      host: proxy.host,\n      port: proxy.port,\n      failoverTimeout: 5\n    }\n\n    switch (type) {\n      case ProxyType.Socks5:\n        return {\n          type,\n          ...base,\n          username: proxy.username ?? '',\n          password: proxy.password ?? '',\n          proxyDNS: proxy.proxyDNS ?? true\n        }\n      case ProxyType.Socks4:\n        return {\n          type,\n          ...base,\n          proxyDNS: proxy.proxyDNS ?? true\n        }\n      case ProxyType.Http:\n        return {\n          type,\n          ...base\n        }\n      case ProxyType.Https:\n        return {\n          type,\n          ...base,\n          proxyAuthorizationHeader: generateAuthorizationHeader(proxy.username ?? '', proxy.password ?? '')\n        }\n    }\n  }\n}\n\nexport class Store {\n  async getAllProxies (): Promise<ProxySettings[]> {\n    const proxyDaos = await this.getAllProxyDaos()\n    const result: ProxySettings[] = proxyDaos.map(tryFromDao).filter(p => p !== undefined) as ProxySettings[]\n    return result\n  }\n\n  async getProxyById (id: string): Promise<ProxySettings | null> {\n    const proxies = await this.getAllProxies()\n    const index = proxies.findIndex(p => p.id === id)\n    if (index === -1) {\n      return null\n    } else {\n      return proxies[index]\n    }\n  }\n\n  async putProxy (proxy: ProxySettings): Promise<void> {\n    const proxies = await this.getAllProxyDaos()\n    const index = proxies.findIndex(p => p.id === proxy.id)\n    if (index !== -1) {\n      proxies[index] = proxy.asDao()\n    } else {\n      proxies.push(proxy.asDao())\n    }\n\n    await this.saveProxyDaos(proxies)\n  }\n\n  async deleteProxyById (id: string): Promise<void> {\n    const proxies = await this.getAllProxyDaos()\n    const index = proxies.findIndex(p => p.id === id)\n    if (index !== -1) {\n      proxies.splice(index, 1)\n      await this.saveProxyDaos(proxies)\n    }\n  }\n\n  async getRelations (): Promise<{ [key: string]: string[] }> {\n    const result = await browser.storage.local.get('relations')\n    return result.relations as { [key: string]: string[] } ?? {}\n  }\n\n  async setContainerProxyRelation (cookieStoreId: string, proxyId: string): Promise<void> {\n    const relations = await this.getRelations()\n    relations[cookieStoreId] = [proxyId]\n\n    await browser.storage.local.set({ relations: relations })\n  }\n\n  async getProxiesForContainer (cookieStoreId: string): Promise<ProxySettings[]> {\n    const relations = await this.getRelations()\n\n    const proxyIds: string[] = relations[cookieStoreId] ?? []\n\n    if (proxyIds.length === 0) {\n      return []\n    }\n\n    const proxies = await this.getAllProxies()\n    const proxyById: { [key: string]: ProxySettings } = {}\n    proxies.forEach(function (p) { proxyById[p.id] = p })\n\n    return proxyIds.map(pId => proxyById[pId])\n      .filter(p => p !== undefined)\n      .map(fillInDefaults)\n      .map(tryFromDao)\n      .filter(p => p !== undefined) as ProxySettings[]\n  }\n\n  private async saveProxyDaos (p: ProxyDao[]): Promise<void> {\n    await browser.storage.local.set({ proxies: p })\n  }\n\n  private async getAllProxyDaos (): Promise<ProxyDao[]> {\n    const fetched = await browser.storage.local.get('proxies')\n    const proxies = (fetched as any).proxies as Array<Partial<ProxyDao>> ?? []\n\n    const proxyDaoList = proxies.map(fillInDefaults)\n    return proxyDaoList\n  }\n}\n\nfunction fillInDefaults (proxy: Partial<ProxyDao>): ProxyDao {\n  if (proxy.title === undefined) {\n    proxy.title = ''\n  }\n  if (typeof proxy.doNotProxyLocal === 'undefined') {\n    proxy.doNotProxyLocal = true\n  }\n  if (typeof proxy.proxyDNS === 'undefined') {\n    if (proxy.type === 'socks' || proxy.type === 'socks4') {\n      proxy.proxyDNS = true\n    }\n  }\n  return proxy as ProxyDao\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Store } from '../store/Store'\nimport BackgroundMain from './BackgroundMain'\n\nconsole.log('Background script started')\n\n// const browser = browser\nconst store = new Store()\n\nconst backgroundListener = new BackgroundMain({ store })\nbackgroundListener.run(browser)\n"],"names":[],"sourceRoot":""}