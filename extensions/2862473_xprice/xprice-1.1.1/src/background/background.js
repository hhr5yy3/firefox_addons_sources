(function(){"use strict";var J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var F={exports:{}};(function(r,o){(function(e,n){n(r)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:J,function(e){var n,x;if(!((x=(n=globalThis.chrome)==null?void 0:n.runtime)!=null&&x.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const g="The message port closed before a response was received.",s=t=>{const d={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(d).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class R extends WeakMap{constructor(i,c=void 0){super(c),this.createItem=i}get(i){return this.has(i)||this.set(i,this.createItem(i)),super.get(i)}}const ge=a=>a&&typeof a=="object"&&typeof a.then=="function",Z=(a,i)=>(...c)=>{t.runtime.lastError?a.reject(new Error(t.runtime.lastError.message)):i.singleCallbackArg||c.length<=1&&i.singleCallbackArg!==!1?a.resolve(c[0]):a.resolve(c)},E=a=>a==1?"argument":"arguments",me=(a,i)=>function(l,...f){if(f.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${E(i.minArgs)} for ${a}(), got ${f.length}`);if(f.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${E(i.maxArgs)} for ${a}(), got ${f.length}`);return new Promise((p,b)=>{if(i.fallbackToNoCallback)try{l[a](...f,Z({resolve:p,reject:b},i))}catch(m){console.warn(`${a} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,m),l[a](...f),i.fallbackToNoCallback=!1,i.noCallback=!0,p()}else i.noCallback?(l[a](...f),p()):l[a](...f,Z({resolve:p,reject:b},i))})},q=(a,i,c)=>new Proxy(i,{apply(l,f,p){return c.call(f,a,...p)}});let k=Function.call.bind(Object.prototype.hasOwnProperty);const O=(a,i={},c={})=>{let l=Object.create(null),f={has(b,m){return m in a||m in l},get(b,m,T){if(m in l)return l[m];if(!(m in a))return;let A=a[m];if(typeof A=="function")if(typeof i[m]=="function")A=q(a,a[m],i[m]);else if(k(c,m)){let _=me(m,c[m]);A=q(a,a[m],_)}else A=A.bind(a);else if(typeof A=="object"&&A!==null&&(k(i,m)||k(c,m)))A=O(A,i[m],c[m]);else if(k(c,"*"))A=O(A,i[m],c["*"]);else return Object.defineProperty(l,m,{configurable:!0,enumerable:!0,get(){return a[m]},set(_){a[m]=_}}),A;return l[m]=A,A},set(b,m,T,A){return m in l?l[m]=T:a[m]=T,!0},defineProperty(b,m,T){return Reflect.defineProperty(l,m,T)},deleteProperty(b,m){return Reflect.deleteProperty(l,m)}},p=Object.create(a);return new Proxy(p,f)},M=a=>({addListener(i,c,...l){i.addListener(a.get(c),...l)},hasListener(i,c){return i.hasListener(a.get(c))},removeListener(i,c){i.removeListener(a.get(c))}}),ce=new R(a=>typeof a!="function"?a:function(c){const l=O(c,{},{getContent:{minArgs:0,maxArgs:0}});a(l)}),X=new R(a=>typeof a!="function"?a:function(c,l,f){let p=!1,b,m=new Promise(y=>{b=function(S){p=!0,y(S)}}),T;try{T=a(c,l,b)}catch(y){T=Promise.reject(y)}const A=T!==!0&&ge(T);if(T!==!0&&!A&&!p)return!1;const _=y=>{y.then(S=>{f(S)},S=>{let N;S&&(S instanceof Error||typeof S.message=="string")?N=S.message:N="An unexpected error occurred",f({__mozWebExtensionPolyfillReject__:!0,message:N})}).catch(S=>{console.error("Failed to send onMessage rejected reply",S)})};return _(A?T:m),!0}),le=({reject:a,resolve:i},c)=>{t.runtime.lastError?t.runtime.lastError.message===g?i():a(new Error(t.runtime.lastError.message)):c&&c.__mozWebExtensionPolyfillReject__?a(new Error(c.message)):i(c)},Y=(a,i,c,...l)=>{if(l.length<i.minArgs)throw new Error(`Expected at least ${i.minArgs} ${E(i.minArgs)} for ${a}(), got ${l.length}`);if(l.length>i.maxArgs)throw new Error(`Expected at most ${i.maxArgs} ${E(i.maxArgs)} for ${a}(), got ${l.length}`);return new Promise((f,p)=>{const b=le.bind(null,{resolve:f,reject:p});l.push(b),c.sendMessage(...l)})},Ae={devtools:{network:{onRequestFinished:M(ce)}},runtime:{onMessage:M(X),onMessageExternal:M(X),sendMessage:Y.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:Y.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},L={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return d.privacy={network:{"*":L},services:{"*":L},websites:{"*":L}},O(t,Ae,d)};e.exports=s(chrome)}else e.exports=globalThis.browser})})(F);var K=F.exports;const u=V(K),h={INIT_CONTENT_SCRIPT:"initContentScript",TRIGGER_PRODUCT_STATS:"triggerProductStats",GET_PRODUCT_STATS_FOR_POPUP:"getProductStatsPopup",PRODUCT_STATS_RESULT:"renderProductStats",GET_PRODUCT_DETAILS:"productDetails",PRODUCT_DETAILS_RESULT:"productDetailsResult",GET_PRODUCT_SIMILAR:"productSimilar",PRODUCT_SIMILAR_RESULT:"productSimilarResult"},j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function ee(){String.prototype.lower=String.prototype.charCodeAt,String.upper=String.fromCharCode,String.prototype.title=String.prototype.charAt}(function(r,o){function e(x,g){return w(x- -701,g)}const n=r();for(;;)try{if(parseInt(e(-570,-569))/1+parseInt(e(-552,-564))/2*(parseInt(e(-568,-567))/3)+-parseInt(e(-565,-554))/4+parseInt(e(-555,-572))/5*(parseInt(e(-533,-545))/6)+parseInt(e(-554,-571))/7*(-parseInt(e(-543,-530))/8)+parseInt(e(-532,-538))/9*(parseInt(e(-569,-585))/10)+-parseInt(e(-564,-570))/11*(-parseInt(e(-537,-545))/12)===o)break;n.push(n.shift())}catch{n.push(n.shift())}})(P,-493863*1+-273070+1015449);const re=function(){let r=!0;return function(o,e){const n=r?function(){if(e){const x=e.apply(o,arguments);return e=null,x}}:function(){};return r=!1,n}}(),D=re(void 0,function(){const r={};r.WFSXK="((("+e(534,556)+"+)+"+e(558,543);const o=r;function e(n,x){return w(x-408,n)}return D[e(574,560)+e(586,571)+"ng"]()[e(559,558)+"rch"](o[e(529,547)+"XK"])[e(570,560)+e(582,571)+"ng"]()[e(518,537)+e(544,535)+e(591,575)+"or"](D)[e(572,558)+e(571,568)]("((("+e(545,556)+e(556,531)+")+$")});function w(r,o){const e=P();return w=function(n,x){return n=n-122,e[n]},w(r,o)}D();function P(){const r=["437843GSzwqZ",".+)","32394clhWCx","sea","sal","toS","low","flo","vif","pjz","map","32QOWivq","joi","rch","Cez","eMc","tri","1722684YzppOG","BvN","Nei","uct","28068mqgZcP","162ZpFwaa","kJX","wZD","+)+","ywD","tit","upp","str","Pzs","con","mat","200254mwvNkA","111260rXzVFk","21NreVFf","QYA",")+$","1851264yvQaCK","11pHubqx","BvX","WFS","yUq","dom","ran","qaq","sli","cUO","325yTpXmp"];return P=function(){return r},P()}const se=-8*-723+2105*1+-7885;ee();function U(r){const o={oyrUS:function(s,t){return s(t)},cUOjF:function(s,t){return s(t)},vifGe:function(s,t){return s===t},InQMq:function(s,t){return s===t},QnSGY:function(s){return s()},BvNrF:function(s,t){return s+t},pjzcu:function(s){return s()}};let e=o.oyrUS(btoa,o[x(-804,-804)+"jF"](encodeURIComponent,r)),n=2*-489+7*-89+-1601*-1;o[x(-794,-778)+"Ge"](e[x(-805,-784)+"ce"](-(5*-1093+4852+5*123)),"==")?(e=e[x(-805,-821)+"ce"](-568+-4*2239+9524,-(-2648+-1325*-2)),n=9914+1*847+1*-10759):o.InQMq(e[x(-805,-815)+"ce"](-(109*62+-1*943+17*-342)),"=")&&(e=e[x(-805,-802)+"ce"](-873*-2+3*1468+-6150,-(2*1693+5869+-2*4627)),n=14614+14613*-1);function x(s,t){return w(s- -949,t)}const g=o.QnSGY(ne);return o[x(-784,-791)+"rF"](te(""+o[x(-793,-806)+"cu"](G)+e+G(),g)+n,g[x(-797,-783)+x(-786,-777)+"ng"]())}function G(){const r={};r.qaqmJ=function(x,g){return x<g},r[n(814,822)+"Hi"]=function(x,g){return x*g};const o=r;let e="";for(let x=7306+1*-7306;o[n(817,831)+"mJ"](x,se);x++)e+=j[n(799,777)+"le"](Math[n(828,816)+"or"](o.yUqHi(Math[n(816,813)+"dom"](),j.length)));function n(x,g){return w(x-674,g)}return e}function B(r,o){function e(g,s){return w(g- -495,s)}const n={};n.QYAQr=function(g,s){return g/s};const x=n;return r||(r={}),r[e(-344,-330)+"t"]=Math.floor(x[e(-361,-338)+"Qr"](+new Date,2406+289*-23+-1747*-3)),r}function ne(r,o){const e={};function n(g,s){return w(s-485,g)}e[n(632,646)+"Yr"]=function(g,s){return g*s};const x=e;return Math[n(618,639)+"or"](x[n(655,646)+"Yr"](Math[n(633,627)+n(624,626)](),1565*1+-147*47+5353-(-7676+1097*7))+(1*5886+1*2179+-8062))}function te(r,o){const e={};e[g(-14,2)+"hR"]=function(s,t){return s>=t},e[g(-18,-19)+"MH"]=function(s,t){return s<=t},e[g(-42,-36)+"cR"]=function(s,t){return s%t},e[g(-56,-38)+"Fj"]=function(s,t){return s+t},e.wZDLV=function(s,t){return s<=t},e[g(-52,-40)+"tW"]=function(s,t){return s-t},e[g(-10,-25)+"hs"]=function(s,t){return s%t};const n=e,x=n[g(-10,-6)+"hs"](o,4415+-2833*3+-274*-15);function g(s,t){return w(s- -180,t)}return r.split("")[g(-23,-47)](s=>{if(s[t(-340,-321)+"ch"](/[a-z]/i)){let d=s[t(-294,-298)+"er"]();if(n[t(-302,-285)+"hR"](d,-1*-5479+-1*4657+-757)&&n[t(-280,-289)+"MH"](d,-6658+-44*122+52*233))return String[t(-347,-325)+"er"](n[t(-305,-313)+"cR"](n[t(-349,-327)+"Fj"](d-(5*-1132+600*-11+-1*-12325),x),-134*-3+7750+2*-4063)+65);if(d>=97&&n[t(-312,-329)+"LV"](d,-3833+3955*1))return String[t(-311,-325)+"er"]((n[t(-330,-323)+"tW"](d,2731+-2634*1)+x)%(-6*-1558+5268+-14590)+(-3094*-1+-5*-119+4*-898))}function t(d,R){return g(R- -271,d)}return s})[g(-21,-19)+"n"]("")}const ae="https://xprice.ro/api";async function v(r){return await fetch(W(r),{method:"GET",mode:"cors",headers:z()})}async function $(r,o){return await fetch(W(r),{method:"POST",mode:"cors",headers:z(),body:JSON.stringify(o)})}function W(r){return ae+r}function z(){return{"Content-Type":"application/json","X-Session-ID":U(Math.floor(+new Date/1e3).toString())}}function ie(r){let o;return r&&(o=new URL(r).hostname,o.startsWith("www.")&&(o=o.substring(4))),o}let I=0;async function C(r=null){if(r&&r===I)return;const e=await(await v("/config/")).json();return I=e==null?void 0:e.version,await u.storage.local.set({config:e}),await u.storage.local.set({lastConfigUpdate:Q()}),e}async function oe(){const{lastConfigUpdate:r}=await u.storage.local.get("lastConfigUpdate");r!==Q()&&await C()}async function xe(r){const o=ie(r);if(!o)return;let{config:e}=await u.storage.local.get("config");return I=e==null?void 0:e.version,(e==null?void 0:e.stores)===void 0&&(e=await C()),e==null?void 0:e.stores[o]}function Q(){return new Date().toISOString().substring(0,10)}!u.action&&u.browserAction&&(u.action=u.browserAction),u.tabs.onUpdated.addListener(async(r,o,e)=>{if(o.status!=="complete")return;const n=await xe(e.url);n&&typeof n=="object"&&u.tabs.sendMessage(r,{message:h.INIT_CONTENT_SCRIPT,domainConfig:n})}),u.runtime.onMessage.addListener(async(r,o,e)=>{var x;const n=o.tab;if(r.message===h.TRIGGER_PRODUCT_STATS){r.productPOSTData||(r.productPOSTData={}),B(r.productPOSTData,n.url);const g={url:n.url,session_id:U(JSON.stringify(r.productPOSTData))},s=await $("/product-stats/",g);if(s.ok){const t=await s.json();H((x=t.widget)==null?void 0:x.cnt,n.id);let d={message:h.PRODUCT_STATS_RESULT,found:!0,productStats:t,debugProductPOSTData:r.productPOSTData};u.tabs.sendMessage(n.id,d),C(t.conf_ver)}else H("",n.id),u.tabs.sendMessage(n.id,{message:h.PRODUCT_STATS_RESULT,found:!1,debugProductPOSTData:r.productPOSTData})}if(r.message===h.GET_PRODUCT_STATS_FOR_POPUP){let g={url:r.url,session_id:U(JSON.stringify(B({},r.url)))};const s=await $("/product-stats/?from=ext_icon",g);if(s.ok){const t=await s.json();return C(t.conf_ver),{found:!0,productStats:t}}else return{found:!1}}if(r.message===h.GET_PRODUCT_DETAILS){const g=`/product-details/${r.productId}/?hist=${r.hist}`,s=await v(g);if(s.ok){const t=await s.json();return{message:h.PRODUCT_DETAILS_RESULT,found:!0,product:t}}else return{message:h.PRODUCT_DETAILS_RESULT,found:!1}}if(r.message===h.GET_PRODUCT_SIMILAR){const g=`/product-similar/${r.productId}/`,s=await v(g);if(s.ok){const t=await s.json();return{message:h.PRODUCT_STATS_RESULT,similar:t}}else return{message:h.PRODUCT_STATS_RESULT,similar:!1}}});function H(r,o){let e=typeof r=="number"?r.toString():r;u.action.setBadgeText({text:e||null,tabId:o}),u.action.setBadgeBackgroundColor({color:r&&r>0?"green":"#eee",tabId:o})}u.runtime.onInstalled.addListener(async()=>{await C()}),u.runtime.onStartup.addListener(function(){oe().then(r=>{})})})();
