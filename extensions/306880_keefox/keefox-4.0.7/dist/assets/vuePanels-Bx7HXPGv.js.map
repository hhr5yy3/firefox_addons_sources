{"version":3,"file":"vuePanels-Bx7HXPGv.js","sources":["../../../src/panels/Panel.vue","../../../src/panels/main.ts"],"sourcesContent":["<template>\n    <v-app>\n        <PasswordGenerator\n            :standalone=\"true\"\n            :topmost=\"true\"\n            @dialog-closed=\"passwordGeneratorClosed\"\n            @copy-to-clipboard=\"copyToClipboard\"\n        />\n    </v-app>\n</template>\n\n<script lang=\"ts\">\nimport { mapState } from \"pinia\";\nimport PasswordGenerator from \"../common/components/PasswordGenerator.vue\";\nimport { Port } from \"../common/port\";\nimport { Action } from \"../common/Action\";\nimport { AddonMessage } from \"../common/AddonMessage\";\nimport useStore from \"../store\";\nimport \"../styles\";\n\nexport default {\n    components: {\n        PasswordGenerator\n    },\n    data: () => ({\n        showPasswordGenerator: false\n    }),\n    computed: {\n        ...mapState(useStore, [\n            \"showGeneratePasswordLink\",\n            \"connectionStatus\",\n            \"connectionStatusDetail\",\n            \"connected\",\n            \"databaseIsOpen\"\n        ])\n    },\n    methods: {\n        passwordGeneratorClosed: function () {\n            Port.postMessage({ action: Action.CloseAllPanels } as AddonMessage);\n        },\n        copyToClipboard: function (payload) {\n            if (payload?.value) {\n                Port.postMessage({ copyToClipboard: payload.value } as AddonMessage);\n            }\n        }\n    }\n};\n</script>\n\n<style></style>\n","import { MatchedLoginsPanel } from \"./MatchedLoginsPanel\";\nimport { FrameState } from \"../common/FrameState\";\nimport { Action } from \"../common/Action\";\nimport { KeeLog } from \"../common/Logger\";\nimport { configManager } from \"../common/ConfigManager\";\nimport { AddonMessage } from \"../common/AddonMessage\";\nimport useStore, { KeeStore } from \"../store\";\nimport { Port } from \"../common/port\";\nimport { App, createApp } from \"vue\";\nimport { createVuetify } from \"vuetify\";\nimport Panel from \"./Panel.vue\";\nimport { createPinia } from \"pinia\";\nimport { setup as i18nSetup } from \"../common/i18n\";\nimport * as components from \"vuetify/components\";\nimport * as directives from \"vuetify/directives\";\nimport { IPCPiniaPlugin } from \"../common/IPCPiniaPlugin\";\n\nlet frameState: FrameState;\n\nfunction updateFrameState(newState: FrameState) {\n    frameState = newState;\n}\n\nlet vueApp: App<Element>;\nlet store: KeeStore;\n\nasync function start() {\n    await configManager.load();\n    KeeLog.debug(\"iframe page starting\");\n    KeeLog.attachConfig(configManager.current);\n    Port.startup(\"iframe_\" + parentFrameId);\n\n    const darkTheme = params[\"theme\"] === \"dark\";\n\n    switch (params[\"panel\"]) {\n        case \"generatePassword\":\n            Port.raw.onMessage.addListener(function (m: AddonMessage) {\n                KeeLog.debug(\"In iframe script, received message from background script\");\n\n                if (m.initialState) {\n                    try {\n                        const piniaInstance = createPinia();\n                        vueApp = createApp({\n                            render: () => h(Panel, {})\n                        });\n\n                        const vuetify = createVuetify({\n                            components,\n                            directives,\n                            theme: {\n                                defaultTheme: darkTheme ? \"dark\" : \"light\",\n                                themes: {\n                                    dark: {\n                                        dark: true,\n                                        colors: {\n                                            primary: \"#1a466b\",\n                                            secondary: \"#ABB2BF\",\n                                            tertiary: \"#e66a2b\",\n                                            error: \"#C34034\",\n                                            info: \"#2196F3\",\n                                            success: \"#4CAF50\",\n                                            warning: \"#FFC107\"\n                                        }\n                                    },\n                                    light: {\n                                        dark: false,\n                                        colors: {\n                                            primary: \"#1a466b\",\n                                            secondary: \"#13334e\",\n                                            tertiary: \"#e66a2b\",\n                                            error: \"#C34034\",\n                                            info: \"#2196F3\",\n                                            success: \"#4CAF50\",\n                                            warning: \"#FFC107\"\n                                        }\n                                    }\n                                }\n                            }\n                        });\n                        piniaInstance.use(IPCPiniaPlugin);\n                        vueApp.use(vuetify);\n                        vueApp.use(piniaInstance);\n                        vueApp.config.globalProperties.$chrome = chrome;\n                        vueApp.config.globalProperties.$i18n = chrome.i18n.getMessage;\n                        store = useStore();\n\n                        store.$patch(m.initialState);\n                        vueApp.mount(\"#main\");\n\n                        //TODO:5: Could be done earlier to speed up initial rendering?\n                        Port.postMessage({\n                            action: Action.GetPasswordProfiles\n                        });\n                    } catch (e) {\n                        KeeLog.error(\"Failed to create user interface.\", e);\n                    }\n                }\n                if (m.mutation) {\n                    store.onRemoteMessage(Port.raw, m.mutation);\n                    return;\n                }\n                if (m.frameState) updateFrameState(m.frameState);\n            });\n            break;\n    }\n\n    KeeLog.info(\"iframe page ready\");\n}\n\nlet matchedLoginsPanel: MatchedLoginsPanel;\n\nconst params: { [key: string]: string } = {};\n\ndocument.location.search\n    .substr(1)\n    .split(\"&\")\n    .forEach(pair => {\n        const [key, value] = pair.split(\"=\");\n        params[key] = value;\n    });\n\nconst parentFrameId = parseInt(params[\"parentFrameId\"]);\n\n(async () => {\n    await start();\n})();\n\ni18nSetup();\n"],"names":["_resolveComponent","_openBlock","_createBlock","_withCtx","_createVNode","i18nSetup"],"mappings":"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"}