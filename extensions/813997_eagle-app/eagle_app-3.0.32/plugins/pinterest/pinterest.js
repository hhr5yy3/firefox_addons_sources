class PinterestPlugin extends SitePlugin{inject(){let t=null;const a=()=>{location.href.includes("pinterest.")&&document.querySelectorAll(['div[data-test-id="pinrep-video"] video:not([eagle-src]):not([eagle-src-loading]):not([eagle-collectable])','div[data-test-id="story-pin-closeup-page"] video:not([eagle-src]):not([eagle-src-loading]):not([eagle-collectable])','div[data-test-id="visual-content-container"] video:not([eagle-src]):not([eagle-src-loading]):not([eagle-collectable])','div[data-test-id="closeup-body-landscape"] video:not([eagle-src]):not([eagle-src-loading]):not([eagle-collectable])'].join(",")).forEach((e,t)=>{e.setAttribute("eagle-collectable","true")})};{let e=!1;setInterval(()=>{location.href==t&&e||(t=location.href,(()=>{var e=document.querySelector('div[role="main"]')||document.querySelector("div.appContent");if(null==e)return!1;{let t=new MutationObserver(e=>{a(),t.disconnect()});return t.observe(e,{childList:!0,subtree:!0}),!0}})()&&(e=!0))},500)}setInterval(()=>{0!=document.querySelectorAll("video:not([eagle-src]):not([eagle-src-loading])").length&&a()},250)}getMeta(e){var t={src:e.hasAttribute("src")&&e.getAttribute("src")||""};if(null==location.href.match("https://(.*).pinterest.(.*)")||""==t.src)return{};let a=$("[data-grid-item]").has(e);var i=a.find("a").toArray().map(e=>{var t=e.innerText;return/^\/\w+\/$/.test(e.getAttribute("href"))?"@"+t:t}).join(" ").trim();i&&(t.customTitle=i),!t.customTitle&&(a=$(e).parents('[data-test-id="closeup-lego-container"]'),i=$(a).find('[data-test-id="closeup-title"]')[0]?.innerText)&&(t.customTitle=i),t.customTitle||(t.customTitle=document.title);let l;return"IMG"==e.nodeName?l=e.getAttribute("src").split("/")[7]:"VIDEO"==e.nodeName&&(l=e.getAttribute("poster").split("/")[7]),t}async getMetaAsync(e){if("VIDEO"===e.tagName){var t=async e=>{try{var t,a=window.location.hostname,i=await(await fetch(`https://${a}/resource/PinResource/get/?source_url=%2Fpin%2F${e}%2F&data=%7B%22options%22%3A%7B%22isPrefetch%22%3Afalse%2C%22id%22%3A%22${e}%22%2C%22field_set_key%22%3A%22auth_web_main_pin%22%2C%22is_landing_page%22%3Afalse%2C%22allowStale%22%3Afalse%2C%22no_fetch_context_on_resource%22%3Afalse%7D%2C%22context%22%3A%7B%7D%7D`)).json(),l=i.resource_response?.data?.videos?.video_list?.V_720P?.url;return l||!!(t=i.resource_response?.data?.story_pin_data?.pages?.[0]?.blocks?.[0]?.video?.video_list?.V_HLSV3_MOBILE?.url)&&t.replace("hls","720p").replace("m3u8","mp4")}catch(e){return!1}};try{var a=e.closest('[data-test-id="closeup-video-with-visibility"]'),i=e.closest('[data-test-id="story-pin-closeup-page"]');return a||i?{src:await t(window.location.href.split("/")[4])}:{src:await t(e.closest("a").href.split("/")[4])}}catch(e){}}}}(()=>{var e=new PinterestPlugin;eagle.plugin.register("(.*).pinterest.(.*)",e),e.inject()})();