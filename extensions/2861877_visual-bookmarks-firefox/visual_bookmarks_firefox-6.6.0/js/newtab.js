(()=>{var e,t,n={856:(e,t,n)=>{"use strict";n.d(t,{G:()=>s,Od:()=>h,On:()=>m,Pb:()=>l,U2:()=>a,Ue:()=>c,Vx:()=>d,pB:()=>u,pk:()=>g,xh:()=>r,yC:()=>p});const o=browser.bookmarks,i=e=>e.reduce(((e,t)=>(t.children&&e.push({title:t.title,id:t.id,parentId:t.parentId,children:i(t.children)}),e)),[]);function r(){try{return o.getTree().then((e=>{const t=e[0].children.map((e=>e));return i(t)}))}catch(e){return Promise.reject(e)}}function a(e){try{return o.get(e)}catch(e){return Promise.reject(e)}}function s(e){try{return o.getChildren(e)}catch(e){return Promise.reject(e)}}function l(e){try{return o.getSubTree(e)}catch(e){return Promise.reject(e)}}function c(e){try{return o.create(e)}catch(e){return Promise.reject(e)}}function d(e,t){try{return o.update(e,t)}catch(e){return Promise.reject(e)}}function u(e,t){try{return o.move(e,t)}catch(e){return Promise.reject(e)}}function h(e){try{return o.remove(e)}catch(e){return Promise.reject(e)}}function m(e){try{return o.removeTree(e)}catch(e){return Promise.reject(e)}}function p(e){try{return o.search(e)}catch(e){return Promise.reject(e)}}function g(e,t=!1){return t?[].concat(...e.map((e=>Array.isArray(e.children)?[e,...g(e.children,!0)]:e))):[].concat(...e.map((e=>Array.isArray(e.children)?g(e.children):e)))}},724:(e,t,n)=>{"use strict";n.d(t,{t:()=>o});const o={local:{get:e=>browser.storage.local.get(e),set:e=>browser.storage.local.set(e),remove:e=>browser.storage.local.remove(e)},sync:{get:e=>browser.storage.sync.get(e),set:e=>browser.storage.sync.set(e),remove:e=>browser.storage.sync.remove(e)}}},164:(e,t,n)=>{"use strict";var o=n(339);class i extends HTMLElement{connectedCallback(){this.selectNode=(0,o.xX)("select",{id:this.selectId,name:"folder",class:"form-control","aria-label":browser.i18n.getMessage("select_folder")}),this.insertAdjacentElement("afterbegin",this.selectNode),this.#e()}disconnectedCallback(){this.#t()}static get observedAttributes(){return["folder-id","parent-folder-id","bookmark-id"]}attributeChangedCallback(){this.#n()}#n(){this.folderId=this.getAttribute("folder-id"),this.parentFolderId=this.getAttribute("parent-folder-id")??null,this.bookmarkId=this.getAttribute("bookmark-id")??null}get selectId(){return this.getAttribute("select-id")}set folders(e){if(!this.selectNode)throw new Error("custom item must be in the DOM");const t=this.#o(e);this.selectNode.innerHTML=t.join("")}set value(e){setTimeout((()=>{this.selectNode.value=e}),0)}get value(){return this.selectNode.value}#o(e){const t=this.parentFolderId?this.parentFolderId:this.folderId,n=[],o=(e,i=0)=>{for(let r of e)if(this.bookmarkId!==r.id&&r.parentId!==this.bookmarkId){let e="-".repeat(i);i>0&&(e=`&nbsp;&nbsp;${e}&nbsp;`);const a=`${e} ${r.title}`;n.push(`<option${r.id===t?" selected":""} value="${r.id}">${a}</option>`),r.children.length&&o(r.children,i+1)}};return o(e),n}#e(){this.handleSelect=this.#i.bind(this),this.handleHashChange=this.#r.bind(this),this.selectNode.addEventListener("change",this.handleSelect),document.addEventListener("changeFolder",this.handleHashChange)}#t(){this.selectNode.removeEventListener("change",this.handleSelect),document.removeEventListener("changeFolder",this.handleHashChange)}#r(e){this.value=e?.detail?.folderId}#i(e){this.dispatchEvent(new CustomEvent("vb:select:change",{detail:e.target.value,bubbles:!0,cancelable:!0}))}}window.customElements.define("vb-select-folders",i)},594:(e,t,n)=>{"use strict";n.d(t,{AL:()=>u,JA:()=>d,Km:()=>s,LZ:()=>i,Xl:()=>r,Yi:()=>o,Yq:()=>a,gH:()=>c,hY:()=>h,uM:()=>l});const o="https://www.google.com/s2/favicons?sz=32&amp;domain_url=",i='<svg class="loading" id="loading" viewBox="0 0 100 100"><defs><linearGradient id="%id%"><stop offset="5%" stop-color="#4285f4"></stop><stop offset="95%" stop-color="#b96bd6"></stop></linearGradient></defs><circle class="path" fill="none" stroke="url(#%id%)" stroke-width="8" stroke-linecap="round" cx="50" cy="50" r="40"></circle></svg>',r=20,a=/^(https?|ftp|file|edge|chrome|(chrome-)?extension):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/i,s=[{action:"new_tab",title:browser.i18n.getMessage("contextmenu_tab")},{action:"new_window",title:browser.i18n.getMessage("contextmenu_window")},{action:"new_window_incognito",title:browser.i18n.getMessage("contextmenu_incognito"),isBookmark:!0},{action:"open_all",title:browser.i18n.getMessage("contextmenu_open_all"),isFolder:!0},{action:"open_all_window",title:browser.i18n.getMessage("contextmenu_open_all_window"),isFolder:!0},{divider:!0},{action:"copy_link",title:browser.i18n.getMessage("contextmenu_copy_link"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#copy_outline"/></svg>',isBookmark:!0},{action:"edit",title:browser.i18n.getMessage("contextmenu_edit"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#edit_outline"/></svg>'},{action:"capture",title:browser.i18n.getMessage("contextmenu_capture"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#capture_outline"/></svg>',isBookmark:!0},{divider:!0},{action:"upload",title:browser.i18n.getMessage("contextmenu_upload"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#upload_outline"/></svg>'},{action:"paste_image",title:browser.i18n.getMessage("contextmenu_upload_paste"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#image_paste"/></svg>'},{divider:!0},{action:"delete_thumbnail",title:browser.i18n.getMessage("delete_thumbnail"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#hide_image"/></svg>'},{action:"remove",title:browser.i18n.getMessage("contextmenu_remove"),icon:'<svg height="24" width="24" fill="currentColor"><use xlink:href="/img/symbol.svg#delete_outline"/></svg>'}],l=[{title:"Bookmarks",value:"bookmarks"},{title:"Google",url:"https://www.google.com/search",name:"q",value:"google"},{title:"Bing",url:"https://bing.com/search",name:"q",value:"bing"},{title:"Yandex",url:"https://ya.ru/search/",name:"text",value:"yandex"},{title:"DuckDuckGo",url:"https://duckduckgo.com/",name:"q",value:"duckduckgo"},{title:"YouTube",url:"https://www.youtube.com/results",name:"search_query",value:"youtube"},{title:"Baidu",url:"https://www.baidu.com/s",name:"wd",value:"baidu"},{title:"Yahoo",url:"https://search.yahoo.com/search",name:"p",value:"yahoo"}],c=(browser.runtime.getURL("newtab.html"),!0),d={CHROME:"1",FIREFOX:"toolbar_____"},u=["0","root________"],h=["file:///","edge://","chrome://"]},301:(e,t,n)=>{"use strict";function o(e=null){const t=(e||document).querySelectorAll("[data-locale-message], [data-locale-html]");Array.prototype.slice.call(t).forEach((e=>{const t=e.getAttribute("data-locale-message")||e.getAttribute("data-locale-html");if(!t)return;const n=t.split(":");if(n.length>1){const t=n[1].split(",").map((e=>browser.i18n.getMessage(e)||e));e.hasAttribute("data-locale-html")?e.innerHTML=browser.i18n.getMessage(n[0],t):e.textContent=browser.i18n.getMessage(n[0],t)}else{const n=browser.i18n.getMessage(t.replace(/\..*/,""));if(!n)return;if(~t.indexOf("placeholder"))return void(e.placeholder=n);if(~t.indexOf(".aria-label"))return void e.setAttribute("aria-label",n);e.hasAttribute("data-locale-html")?e.innerHTML=n:e.textContent=n}}))}n.d(t,{Z:()=>o})},485:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var o=n(339),i=n(724),r=n(594);const a=Object.freeze({color_theme:"os",background_image:"background_noimage",background_external:"",default_folder_id:r.gH?r.JA.FIREFOX:r.JA.CHROME,dial_columns:7,dial_width:70,vertical_center:!1,drag_and_drop:!0,auto_generate_thumbnail:!0,enable_sync:!1,show_toolbar:!0,show_contextmenu_item:!0,show_settings_icon:!0,show_back_column:!0,show_create_column:!0,show_bookmark_title:!0,show_favicon:!0,open_link_newtab:!1,thumbnails_update_button:!0,thumbnails_update_recursive:!1,thumbnails_update_delay:.5,custom_style:"",without_confirmation:!1,services_enable:!1,services_list:[{id:(0,o.nR)(),name:"youtube",link:"https://www.youtube.com"},{id:(0,o.nR)(),name:"search",link:"https://google.com"},{id:(0,o.nR)(),name:"translate",link:"https://translate.google.com"},{id:(0,o.nR)(),name:"gmail",link:"https://mail.google.com/mail"},{id:(0,o.nR)(),name:"drive",link:"https://drive.google.com/"},{id:(0,o.nR)(),name:"photos",link:"https://photos.google.com"}],folder_preview:!1,close_tab_after_adding_bookmark:!1,logo_external:!1,logo_external_url:"https://logo.clearbit.com/{{website}}",search_engine:"bookmarks",move_to_start:!1,sort_by_date:!1,bookmarks_sorting_type:"",search_autofocus:!1,enable_virtual_pagination:!1}),s=["default_folder_id","enable_sync"],l=(()=>{let e={};return{get $(){return e},async init(){let{settings:t}=await i.t.local.get("settings");if(t?Object.assign(e,a,t):(t=Object.assign({},a),i.t.local.set({settings:t})),t.enable_sync){const{settings:e}=await i.t.sync.get("settings");Object.assign(t,e)}Object.assign(e,t)},async updateKey(t,n){if(!e)throw Error("Settings store must be initialized with the init method");e[t]=n,await i.t.local.set({settings:e}),e.enable_sync&&(s.includes(t)||this.syncToStorage())},async updateAll(t={}){Object.assign(e,t),await i.t.local.set({settings:e})},syncToStorage(){const t=JSON.parse(JSON.stringify(e));s.forEach((e=>delete t[e])),i.t.sync.set({settings:t})},async restoreFromSync(){let{settings:t}=await i.t.sync.get("settings");Object.assign(e,t),i.t.local.set({settings:e})},async resetLocal(){e=Object.assign({},a),await i.t.local.set({settings:e})},resetSync:()=>new Promise((e=>{browser.storage.sync.clear(e)}))}})()},339:(e,t,n)=>{"use strict";n.d(t,{OK:()=>h,UX:()=>m,VU:()=>c,Zb:()=>b,bl:()=>l,dl:()=>u,g9:()=>a,gw:()=>s,jq:()=>p,nR:()=>g,ol:()=>v,s1:()=>f,sW:()=>r,xX:()=>i,xy:()=>d});var o=n(594);function i(e,t={},...n){const o=document.createElement(e);for(const e in t)null!=t[e]&&Object.prototype.hasOwnProperty.call(t,e)&&o.setAttribute(e,t[e]);if(n.length&&void 0!==n[0].html)o.innerHTML=n[0].html;else if(n.length){const e=document.createDocumentFragment();n.forEach((t=>{"string"==typeof t&&(t=document.createTextNode(t)),e.appendChild(t)})),o.appendChild(e)}return o}function r(e,t,n){let o=null;return function(){const i=this,r=arguments,a=n&&!o;clearTimeout(o),o=setTimeout((()=>{o=null,n||e.apply(i,r)}),t),a&&e.apply(i,r)}}function a(e,t,n={}){const o=new CustomEvent(e,{...n});t.dispatchEvent(o)}function s(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function l(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}function c(e,t,n=[]){t=t||e,browser.notifications.create(t,{type:"basic",iconUrl:"icons/icon128.png",title:"Visual bookmarks",message:e,...!o.gH&&{buttons:n}},(function(){}))}function d(e){const t=new Image;return t.src=e,t.decode().then((()=>t))}async function u(e,t=500,n="high",o=.75){let i=await createImageBitmap(e);t&&i.height>t&&(i.close(),i=await createImageBitmap(e,{resizeHeight:t,resizeQuality:n}));const r=new OffscreenCanvas(i.width,i.height);return r.getContext("bitmaprenderer").transferFromImageBitmap(i),i.close(),r.convertToBlob({type:"image/webp",quality:o})}function h([...e]){let t=e.length;for(;t;){const n=Math.floor(Math.random()*t--);[e[t],e[n]]=[e[n],e[t]]}return e}function m(e){return e.replace(/(https?|ftps?|chrome|chrome-extension|file):\/\/\/?(www.)?/i,"").replace(/:?\/.*/i,"")}function p(e){const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.cssText="\n      position: absolute;\n      left: -9999px;\n    ",document.body.appendChild(t);const n=document.getSelection();let o=n.rangeCount>0&&n.getRangeAt(0);t.select();let i=!1;try{i=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),o&&(n.removeAllRanges(),n.addRange(o)),i}function g(){return`id${Math.floor(Math.random()*Date.now()).toString(36)}`}function f(e,t=16){return`https://www.google.com/s2/favicons?sz=${t}&domain_url=${e}`}function b(e){return e().then((e=>e)).catch(console.warn)}async function v(){try{const[e]=await navigator.clipboard.read(),t=e.types.find((e=>/image\/(jpe?g|png|webp|avif)$/.test(e)));return Boolean(t)}catch(e){return!1}}},461:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(81),i=n.n(o),r=n(645),a=n.n(r)()(i());a.push([e.id,".bookmarks-panel{--vb-popup-bottom:calc(100% + 20px);--vb-popup-btn-radius:50%;position:fixed;z-index:9000;left:0;right:0;bottom:0;width:100%;max-width:700px;display:flex;align-items:center;justify-content:space-between;gap:10px;margin-inline:auto;padding:10px;border-radius:var(--base-radius) var(--base-radius)0 0;background-color:var(--theme-background-alpha-95);box-shadow:0 0 14px rgba(0 0 0/20%);backdrop-filter:blur(10px);outline:0}.bookmarks-panel button:focus-visible{outline:2px solid var(--color-primary);outline-offset:1px}.bookmarks-panel__body{display:flex;flex-wrap:wrap;align-items:center;gap:10px}.bookmarks-panel__action,.bookmarks-panel__close{flex-shrink:0;display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;padding:0;border:0;border-radius:50%;cursor:pointer}.bookmarks-panel__action{color:var(--theme-text-color);background:var(--theme-invert-alpha-10)}.bookmarks-panel__action:hover{background:var(--theme-invert-alpha-20)}.bookmarks-panel__action svg{flex-shrink:0;fill:currentcolor;pointer-events:none}.bookmarks-panel__close{background-color:transparent;opacity:.5;transition:opacity .15s ease}.bookmarks-panel__close:hover{opacity:1}.bookmarks-panel__close svg{fill:var(--theme-text-color)}.bookmarks-panel__popup-content{width:210px;padding:5px;border-radius:var(--base-radius);box-shadow:0 4px 20px 0 rgb(51 51 51/16%)}.bookmarks-panel__popup-action{padding:5px 10px;font-size:90%;cursor:pointer;border-radius:var(--base-radius)}.bookmarks-panel__popup-action:hover{background-color:var(--theme-invert-alpha-10)}.bookmarks-panel__selector{position:relative;display:flex;gap:10px}",""]);const s=a},458:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(81),i=n.n(o),r=n(645),a=n.n(r)()(i());a.push([e.id,":host{position:fixed;z-index:1001;right:12px;bottom:20px;transform:translate3d(100%,0,0);opacity:0;will-change:transform;transition:.15s ease-in-out;transition-property:transform,opacity}:host(.is-shown){opacity:1;transform:none}.vb-scrollup__button{display:flex;align-items:center;justify-content:center;width:34px;height:34px;padding:0;border-radius:50%;border:1px solid transparent;background-color:var(--theme-background-3);cursor:pointer}.vb-scrollup__button:focus-visible{outline:2px solid var(--color-primary);outline-offset:2px}.vb-scrollup__button svg{fill:var(--theme-text-color)}",""]);const s=a},645:e=>{"use strict";
/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,i,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&a[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),i&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=i):d[4]="".concat(i)),t.push(d))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},363:function(e){
/**
 * Form Validator - v0.0.11
 * Lightweight form validation plugin
 * https://github.com/Zveromag/validator#readme
 * Copyright (c) 2021 Ivan Kuzmichov,Ivan Tarakanov.
 * MIT License
 */
e.exports=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var i={required:function(e,t){var n=!0;switch(e.el.type){case"checkbox":n=e.el.checked;break;case"radio":n=1===t.form.querySelectorAll('[type="radio"][name="'.concat(e.el.name,'"]:checked')).length;break;case"select":case"select-one":case"select-multiple":n=""!==e.el.value;break;default:n="password"===e.el.type?""!==e.el.value:""!==e.el.value.trim()}return n||e.i18n.required},minLen:function(e){return e.el.value.length>=e.param||e.i18n.minLen.replace("%s%",e.param)},maxLen:function(e){return e.el.value.length<=e.param||e.i18n.maxLen.replace("%s%",e.param)},email:function(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e.el.value)||e.i18n.email},equalTo:function(e,t){var n=t.form.querySelector("[name="+e.param+"]");if(n)return n.value.trim()===e.el.value||e.i18n.equalTo},url:function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e.el.value)||e.i18n.url},number:function(e){return/^(\d+|\.?\d+)$/.test(e.el.value)||e.i18n.number},regex:function(e,t){var n=t.options.validators.regex[e.param];return new RegExp(n.pattern).test(e.el.value)||n.error}},r={required:"This field is required",minLen:"The minimum number of characters allowed is %s%",maxLen:"The maximum allowed number of characters is %s%",email:"The e-mail field has the wrong format",phone:"The phone number is not in the correct format",number:"The entered data must be a number",equalTo:"The entered data does not match",url:"It is not a valid url"},a={showErrors:!0,checkChange:!0,checkInput:!1,checkBlur:!1,containerSelector:".form-group",errorClass:"has-error",errorHintClass:"error-hint",onSuccess:function(){},onError:function(){},onChange:function(){},onReset:function(){}},s=new RegExp(/^(minLen|maxLen|required|equalTo|email|regex|url)\((\w.*)\)/i);return function(){function e(n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t(t({},a),o),this.i18n=t(t({},r),e.i18n),this.form=n,this.formSubmit=this.validateForm.bind(this),this.formReset=this.reset.bind(this),this.inputChange=this.validateInput.bind(this),this.bindEvents()}var o,l,c;return o=e,c=[{key:"destroy",value:function(e){e instanceof Node&&(e=[e]),e instanceof NodeList&&(e=[].slice.call(e)),"string"==typeof e&&(e=[].slice.call(document.querySelectorAll(e))),e instanceof Array&&e.forEach((function(e){if("Validator"in e){var t=e.Validator;t.unbindEvents.call(t),t.form.Validator=null,delete t.form.Validator,t.form=null}}))}},{key:"run",value:function(t,n){t instanceof Node&&(t=[t]),t instanceof NodeList&&(t=[].slice.call(t)),"string"==typeof t&&(t=[].slice.call(document.querySelectorAll(t))),t instanceof Array&&t.forEach((function(t){"Validator"in t||(t.Validator=new e(t,n))}))}}],(l=[{key:"check",value:function(e){for(var t=e.value.trim(),n=e.getAttribute("data-valid"),o=[],r={el:e,i18n:this.i18n},a=n.split("|"),l=a.length,c=0;c<l;c++){var d=a[c].match(s),u=void 0;if(d?(u=d[1],void 0!==d[2]&&(r.param=d[2])):u=a[c],(""!==t||"required"===u||"equalTo"===u)&&i.hasOwnProperty(u)){var h=i[u](r,this);if(!0!==h){var m="regex"===u&&r.param?"data-valid-msg-regex-".concat(r.param):"data-valid-msg-".concat(u);h=e.getAttribute(m)||h,o.push(h)}}}return o}},{key:"validateInput",value:function(e){var t=e.target.closest("[data-valid]");if(t){var n={el:t},o=this.check(t);return o.length>0&&(n.errors=o),this.options.showErrors&&this.toggleError(n),this.options.onChange(n)}}},{key:"validateForm",value:function(e){for(var t=[],n=Array.prototype.slice.call(this.form.querySelectorAll("[data-valid]:not(:disabled)")),o=0,i=n.length;o<i;o++){var r=this.check(n[o]);0!==r.length&&t.push({el:n[o],errors:r})}return 0===t.length?this.options.onSuccess(e):(e.preventDefault(),this.options.showErrors&&this.showErrors(t),this.options.onError(t))}},{key:"reset",value:function(e){this.options.showErrors&&this.resetErrors(e.target),this.options.onReset(e)}},{key:"showErrors",value:function(e){var t=this;e.forEach((function(e){t.toggleError(e)}))}},{key:"toggleError",value:function(e){var t=e.el.closest(this.options.containerSelector),n=t.querySelector(".".concat(this.options.errorHintClass));n&&n.parentNode.removeChild(n),e.errors?(t.classList.add(this.options.errorClass),t.insertAdjacentHTML("beforeend",'<div class="'.concat(this.options.errorHintClass,'"> ').concat(e.errors.join("<br>"),"</div>"))):t.classList.remove(this.options.errorClass)}},{key:"resetErrors",value:function(e){var t=this;[].slice.call(e.querySelectorAll(".".concat(this.options.errorClass))).forEach((function(e){e.classList.remove(t.options.errorClass);var n=e.querySelector(".".concat(t.options.errorHintClass));n&&e.removeChild(n)}))}},{key:"bindEvents",value:function(){var e=this;this.form.addEventListener("submit",this.formSubmit),this.form.addEventListener("reset",this.formReset),this.options.checkChange&&this.form.addEventListener("change",this.inputChange),this.options.checkInput&&this.form.addEventListener("input",this.inputChange),this.options.checkBlur&&Array.prototype.slice.call(this.form.querySelectorAll('[data-valid]:not(:disabled):not([type="hidden"])')).forEach((function(t){t.addEventListener("blur",e.inputChange)}))}},{key:"unbindEvents",value:function(){var e=this;this.form.removeEventListener("submit",this.formSubmit),this.form.removeEventListener("reset",this.formReset),this.options.checkChange&&this.form.removeEventListener("change",this.inputChange),this.options.checkInput&&this.form.removeEventListener("input",this.inputChange),this.options.checkBlur&&Array.prototype.slice.call(this.form.querySelectorAll('[data-valid]:not(:disabled):not([type="hidden"])')).forEach((function(t){t.removeEventListener("blur",e.inputChange)}))}}])&&n(o.prototype,l),c&&n(o,c),e}()}()},636:function(e){
/*! For license information please see gmodal.js.LICENSE.txt */
"undefined"!=typeof self&&self,e.exports=(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};return(()=>{function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n.apply(this,arguments)}e.d(t,{default:()=>m});const o={checkScrollbar:function(){return window.innerWidth>document.documentElement.clientWidth},getScrollbarWidth:function(){var e=document.createElement("div");e.style.cssText="\n      width: 100px;\n      height: 100px;\n      overflow: scroll;\n      position: absolute;\n      top: -9999px;\n    ",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},isVisible:function(e){if("none"===e.style.display)return!1;var t=e.getBoundingClientRect();return t&&t.width>0&&t.height>0},emulateTransitionEnd:function(e,t){void 0===t&&(t=150);var n=!1,o=this.transitionEnd();e.addEventListener(o,(function e(t){this.removeEventListener(t.type,e),n=!0})),setTimeout((function(){if(!n){var t=document.createEvent("HTMLEvents");t.initEvent(o,!1,!1),e.dispatchEvent(t)}}),t)},transitionEnd:function(){var e={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd"},t=document.documentElement;for(var n in e)if(void 0!==t.style[n])return e[n];return!1},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=window.getComputedStyle(e)["transition-duration"],n=window.getComputedStyle(e)["transition-delay"],o=parseFloat(t),i=parseFloat(n);return o||i?(t=t.split(",")[0],n=n.split(",")[0],1e3*(parseFloat(t)+parseFloat(n))):0},customTrigger:function(e,t,o){var i;void 0===o&&(o={}),"CustomEvent"in window&&"function"==typeof window.CustomEvent?i=new CustomEvent(e,{detail:n({},o)}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,n({},o)),t.dispatchEvent(i)},onceTransitionEnd:function(e,t,n,o){void 0===o&&(o=!1),e.addEventListener(t,(function t(i){i.target===e&&(e.removeEventListener(i.type,t,o),n.call(this,i))}),o)}};function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i.apply(this,arguments)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a="gmodal-open",s="is-shown",l="is-hidden",c="has-animate",d={stickySelectors:[],animation:!0,backdrop:!0,closeBackdrop:!0,keyboard:!0},u=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'].join(","),h=function(){function e(e,t){return void 0===t&&(t={}),!!e&&(this._modal="string"==typeof e?document.querySelector(e):e,this._modal instanceof Element&&(this._modal.instance?this._modal.instance:(this._modal.instance=this,this._modal.tabIndex="-1",this._isOpen=!1,this._isTransitiong=!1,this._settings=i({},d,t),this._transitionEndEvent=o.transitionEnd(),void this._init())))}var t,n,h=e.prototype;return h._init=function(){this._body=document.body,this._modalContainer=this._modal.querySelector(".gmodal__container"),this._modalDialog=this._modal.querySelector(".gmodal__dialog"),this._modalDismiss=Array.prototype.slice.call(this._modal.querySelectorAll('[data-gmodal="dismiss"]')),this._scrollbarWidth=0,this._settings.animation&&this._modal.classList.add(c),this._observerCallback=this._observerCallback.bind(this),this._observer=new MutationObserver(this._observerCallback),this._observer.observe(this._modalDialog,{childList:!0,subtree:!0,attributes:!0}),this._attachEvents()},h._observerCallback=function(e){var t=e[0];(t.addedNodes.length||t.removedNodes.length||"attributes"===t.type)&&this._focusable()},h._stickySelectorsArray=function(){return Array.isArray(this._settings.stickySelectors)?this._settings.stickySelectors.reduce((function(e,t){var n=Array.prototype.slice.call(document.querySelectorAll(t));return e.push.apply(e,n),e}),[]):[]},h._attachEvents=function(){var e=this;this._closeHandler=function(t){t.preventDefault(),t.stopPropagation(),e.close()},this._clickOutside=function(t){e._ignoreBackdropClick?e._ignoreBackdropClick=!1:e._modalDialog.contains(t.target)||e.close()},this._dialogMouseDown=function(){e._modal.addEventListener("mouseup",(function t(n){e._modal.removeEventListener("mouseup",t),n.target===e._modal&&(e._ignoreBackdropClick=!0)}))},this._modalDismiss.forEach((function(t){t.addEventListener("click",e._closeHandler)})),this._settings.closeBackdrop&&(this._modal.addEventListener("click",this._clickOutside),this._modalDialog.addEventListener("mousedown",this._dialogMouseDown)),this._settings.keyboard&&(this._keyHandler=this._keyHandler.bind(this),this._modal.addEventListener("keydown",this._keyHandler))},h._dettachEvents=function(){var e=this;this._settings.closeBackdrop&&(this._modal.removeEventListener("click",this._clickOutside),this._modalDialog.removeEventListener("mousedown",this._dialogMouseDown)),this._modalDismiss.forEach((function(t){t.removeEventListener("click",e._closeHandler)})),this._settings.keyboard&&this._modal.removeEventListener("keydown",this._keyHandler)},h._focusable=function(){this._focusableEls=Array.prototype.slice.call(this._modal.querySelectorAll(u)).filter((function(e){return o.isVisible(e)})),this._focusableElFirst=this._focusableEls[0],this._focusableElLast=this._focusableEls[this._focusableEls.length-1]},h._keyHandler=function(e){var t=this;switch(e.which){case 9:if(0===this._focusableEls.length){e.preventDefault();break}e.shiftKey?document.activeElement!==t._focusableElFirst&&document.activeElement!==t._modal||(e.preventDefault(),t._focusableElLast.focus()):document.activeElement===t._focusableElLast&&(e.preventDefault(),t._focusableElFirst.focus());break;case 27:e.stopPropagation(),this.close()}},h._createBackdrop=function(){var e=document.createElement("div");return e.className="gmodal-backdrop",this._settings.animation&&(e.className+=" has-animate"),document.body.appendChild(e),e},h._setScrollOffset=function(){var e=this;if(this._hasScrollbar){this._scrollbarWidth=o.getScrollbarWidth();var t=this._body.style.paddingRight,n=parseFloat(getComputedStyle(this._body).paddingRight);t&&this._body.setAttribute("data-gmodal-padding",t),this._body.style.paddingRight=n+this._scrollbarWidth+"px",this._stickySelectorsArray().forEach((function(t){var n=t.style.marginRight,o=parseFloat(getComputedStyle(t).marginRight);n&&t.setAttribute("data-gmodal-margin",n),t.style.marginRight=o+e._scrollbarWidth+"px"}))}},h._resetScrollOffset=function(){this._hasScrollbar&&(this._body.style.paddingRight=this._body.getAttribute("data-gmodal-padding")||"",this._body.removeAttribute("data-gmodal-padding"),this._stickySelectorsArray().forEach((function(e){e.style.marginRight=e.getAttribute("data-gmodal-margin")||"",e.removeAttribute("data-gmodal-margin")})))},h._adjustModal=function(){this._scrollbarWidth=o.getScrollbarWidth(),this._modal.style.overflow="hidden",this._modal.style.marginRight=this._scrollbarWidth+"px"},h._resetAdjustModal=function(){this._modal.style.overflow="",this._modal.style.marginRight=""},h._hideBackdrop=function(){var e=this;if(this._backdrop)if(this._backdrop.classList.remove(s),this._settings.animation){var t=o.getTransitionDurationFromElement(this._backdrop);o.onceTransitionEnd(this._backdrop,this._transitionEndEvent,(function(){var t,n;null!=(t=e._backdrop)&&t.parentNode&&(null==(n=e._backdrop.parentNode)||n.removeChild(e._backdrop))})),o.emulateTransitionEnd(this._backdrop,t)}else this._backdrop.parentNode&&this._backdrop.parentNode.removeChild(this._backdrop)},h._hideModal=function(){if(1===this.modalsLength&&(this._body.classList.remove(a),this._resetScrollOffset()),this._modal.style.display="",this._isTransitiong=!1,this.modalsLength){var t=e.modals[this.modalsLength-1].focusEl;setTimeout((function(){null==t||t.focus()}),0)}e.modals.pop(),this.modalsLength&&e.modals[this.modalsLength-1].item.element.classList.remove(l),this._isOpen&&o.customTrigger("gmodal:close",this._modal),this._isOpen=!1},h.open=function(){var t=this;if(this._modal&&!this._isOpen&&!this._isTransitiong){this._isOpen=!0,this._focusableSave=document.activeElement,this.modalsLength||(this._hasScrollbar=o.checkScrollbar(),this._body.classList.add(a),this._setScrollOffset(),this._settings.backdrop&&(this._backdrop=this._createBackdrop(this))),o.customTrigger("gmodal:beforeopen",this._modal),this._modal.style.display="block",this._isTransitiong=!0,this._modal.scrollTop=0,this.modalsLength&&e.modals.forEach((function(e){e.item.element.classList.add(l)})),e.modals.push({item:this._modal.instance,focusEl:this._focusableSave}),setTimeout((function(){t._backdrop&&t._backdrop.classList.add(s),t._modal.classList.add(s)}),20);var n=function(){t._isTransitiong=!1,t._focusable(),t._modal.focus(),o.customTrigger("gmodal:open",t._modal)};if(this._settings.animation){this._adjustModal();var i=o.getTransitionDurationFromElement(this._modalContainer);o.onceTransitionEnd(this._modalContainer,this._transitionEndEvent,(function(){t._resetAdjustModal(),n()})),o.emulateTransitionEnd(this._modalContainer,i)}else n()}},h.close=function(e){if(void 0===e&&(e=!1),this._modal&&this._isOpen&&!this._isTransitiong)if(o.customTrigger("gmodal:beforeclose",this._modal),this._modal.classList.remove(s),this._hideBackdrop(),this._isTransitiong=!0,this._settings.animation&&!e){var t=o.getTransitionDurationFromElement(this._modalContainer);o.onceTransitionEnd(this._modalContainer,this._transitionEndEvent,this._hideModal.bind(this)),o.emulateTransitionEnd(this._modalContainer,t)}else this._hideModal()},e.closeAll=function(){if(this.modals.length){var e=!1,t=this.modals[0].item._hasScrollbar;this.modals.slice().reverse().forEach((function(n,o){0===o?n.item._hasScrollbar=t:e=!0,n.item.close(e)}))}},h.destroy=function(){var e=this;this._modal&&(this._isOpen=!1,this._observer&&this._observer.disconnect(),this._backdrop&&this._backdrop.parentNode&&this._backdrop.parentNode.removeChild(this._backdrop),this._hideModal(),this._modal.classList.remove(c,s),this._dettachEvents(),delete this._modal.instance,Object.keys(this).forEach((function(t){delete e[t]})))},t=e,(n=[{key:"element",get:function(){return this._modal}},{key:"modalsLength",get:function(){return e.modals.length}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();h.modals=[];const m=h})(),t.default})()},474:(e,t,n)=>{"use strict";
/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{ZP:()=>at});function c(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var d=c(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),u=c(/Edge/i),h=c(/firefox/i),m=c(/safari/i)&&!c(/chrome/i)&&!c(/android/i),p=c(/iP(ad|od|hone)/i),g=c(/chrome/i)&&c(/android/i),f={capture:!1,passive:!1};function b(e,t,n){e.addEventListener(t,n,!d&&f)}function v(e,t,n){e.removeEventListener(t,n,!d&&f)}function _(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function w(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function y(e,t,n,o){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&_(e,t):_(e,t))||o&&e===n)return e;if(e===n)break}while(e=w(e))}return null}var k,E=/\s+/g;function x(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(E," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(E," ")}}function C(e,t,n){var o=e&&e.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=n+("string"==typeof n?"":"px")}}function S(e,t){var n="";if("string"==typeof e)n=e;else do{var o=C(e,"transform");o&&"none"!==o&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function L(e,t,n){if(e){var o=e.getElementsByTagName(t),i=0,r=o.length;if(n)for(;i<r;i++)n(o[i],i);return o}return[]}function T(){var e=document.scrollingElement;return e||document.documentElement}function A(e,t,n,o,i){if(e.getBoundingClientRect||e===window){var r,a,s,l,c,u,h;if(e!==window&&e.parentNode&&e!==T()?(a=(r=e.getBoundingClientRect()).top,s=r.left,l=r.bottom,c=r.right,u=r.height,h=r.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,h=window.innerWidth),(t||n)&&e!==window&&(i=i||e.parentNode,!d))do{if(i&&i.getBoundingClientRect&&("none"!==C(i,"transform")||n&&"static"!==C(i,"position"))){var m=i.getBoundingClientRect();a-=m.top+parseInt(C(i,"border-top-width")),s-=m.left+parseInt(C(i,"border-left-width")),l=a+r.height,c=s+r.width;break}}while(i=i.parentNode);if(o&&e!==window){var p=S(i||e),g=p&&p.a,f=p&&p.d;p&&(l=(a/=f)+(u/=f),c=(s/=g)+(h/=g))}return{top:a,left:s,bottom:l,right:c,width:h,height:u}}}function D(e,t,n){for(var o=$(e,!0),i=A(e)[t];o;){var r=A(o)[n];if(!("top"===n||"left"===n?i>=r:i<=r))return o;if(o===T())break;o=$(o,!1)}return!1}function O(e,t,n,o){for(var i=0,r=0,a=e.children;r<a.length;){if("none"!==a[r].style.display&&a[r]!==je.ghost&&(o||a[r]!==je.dragged)&&y(a[r],n.draggable,e,!1)){if(i===t)return a[r];i++}r++}return null}function I(e,t){for(var n=e.lastElementChild;n&&(n===je.ghost||"none"===C(n,"display")||t&&!_(n,t));)n=n.previousElementSibling;return n||null}function M(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===je.clone||t&&!_(e,t)||n++;return n}function B(e){var t=0,n=0,o=T();if(e)do{var i=S(e),r=i.a,a=i.d;t+=e.scrollLeft*r,n+=e.scrollTop*a}while(e!==o&&(e=e.parentNode));return[t,n]}function $(e,t){if(!e||!e.getBoundingClientRect)return T();var n=e,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=C(n);if(n.clientWidth<n.scrollWidth&&("auto"==i.overflowX||"scroll"==i.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==i.overflowY||"scroll"==i.overflowY)){if(!n.getBoundingClientRect||n===document.body)return T();if(o||t)return n;o=!0}}}while(n=n.parentNode);return T()}function N(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function X(e,t){return function(){if(!k){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),k=setTimeout((function(){k=void 0}),t)}}}function P(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function j(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}var F="Sortable"+(new Date).getTime();function R(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==C(e,"display")&&e!==je.ghost){t.push({target:e,rect:A(e)});var n=i({},t[t.length-1].rect);if(e.thisAnimationDuration){var o=S(e,!0);o&&(n.top-=o.f,n.left-=o.e)}e.fromRect=n}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var o=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var i=!1,r=0;t.forEach((function(e){var t=0,n=e.target,a=n.fromRect,s=A(n),l=n.prevFromRect,c=n.prevToRect,d=e.rect,u=S(n,!0);u&&(s.top-=u.f,s.left-=u.e),n.toRect=s,n.thisAnimationDuration&&N(l,s)&&!N(a,s)&&(d.top-s.top)/(d.left-s.left)==(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}(d,l,c,o.options)),N(s,a)||(n.prevFromRect=a,n.prevToRect=s,t||(t=o.options.animation),o.animate(n,d,s,t)),t&&(i=!0,r=Math.max(r,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),i?e=setTimeout((function(){"function"==typeof n&&n()}),r):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,o){if(o){C(e,"transition",""),C(e,"transform","");var i=S(this.el),r=i&&i.a,a=i&&i.d,s=(t.left-n.left)/(r||1),l=(t.top-n.top)/(a||1);e.animatingX=!!s,e.animatingY=!!l,C(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),C(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),C(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){C(e,"transition",""),C(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),o)}}}}var H=[],U={initializeByDefault:!0},q={mount:function(e){for(var t in U)U.hasOwnProperty(t)&&!(t in e)&&(e[t]=U[t]);H.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),H.push(e)},pluginEvent:function(e,t,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var r=e+"Global";H.forEach((function(o){t[o.pluginName]&&(t[o.pluginName][r]&&t[o.pluginName][r](i({sortable:t},n)),t.options[o.pluginName]&&t[o.pluginName][e]&&t[o.pluginName][e](i({sortable:t},n)))}))},initializePlugins:function(e,t,n,o){for(var i in H.forEach((function(o){var i=o.pluginName;if(e.options[i]||o.initializeByDefault){var r=new o(e,t,e.options);r.sortable=e,r.options=e.options,e[i]=r,s(n,r.defaults)}})),e.options)if(e.options.hasOwnProperty(i)){var r=this.modifyOption(e,i,e.options[i]);void 0!==r&&(e.options[i]=r)}},getEventProperties:function(e,t){var n={};return H.forEach((function(o){"function"==typeof o.eventProperties&&s(n,o.eventProperties.call(t[o.pluginName],e))})),n},modifyOption:function(e,t,n){var o;return H.forEach((function(i){e[i.pluginName]&&i.optionListeners&&"function"==typeof i.optionListeners[t]&&(o=i.optionListeners[t].call(e[i.pluginName],n))})),o}};function Y(e){var t=e.sortable,n=e.rootEl,o=e.name,r=e.targetEl,a=e.cloneEl,s=e.toEl,l=e.fromEl,c=e.oldIndex,h=e.newIndex,m=e.oldDraggableIndex,p=e.newDraggableIndex,g=e.originalEvent,f=e.putSortable,b=e.extraEventProperties;if(t=t||n&&n[F]){var v,_=t.options,w="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||d||u?(v=document.createEvent("Event")).initEvent(o,!0,!0):v=new CustomEvent(o,{bubbles:!0,cancelable:!0}),v.to=s||n,v.from=l||n,v.item=r||n,v.clone=a,v.oldIndex=c,v.newIndex=h,v.oldDraggableIndex=m,v.newDraggableIndex=p,v.originalEvent=g,v.pullMode=f?f.lastPutMode:void 0;var y=i(i({},b),q.getEventProperties(o,t));for(var k in y)v[k]=y[k];n&&n.dispatchEvent(v),_[w]&&_[w].call(t,v)}}var W=["evt"],z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.evt,r=l(n,W);q.pluginEvent.bind(je)(e,t,i({dragEl:K,parentEl:G,ghostEl:Z,rootEl:J,nextEl:Q,lastDownEl:ee,cloneEl:te,cloneHidden:ne,dragStarted:ge,putSortable:le,activeSortable:je.active,originalEvent:o,oldIndex:oe,oldDraggableIndex:re,newIndex:ie,newDraggableIndex:ae,hideGhostForTarget:$e,unhideGhostForTarget:Ne,cloneNowHidden:function(){ne=!0},cloneNowShown:function(){ne=!1},dispatchSortableEvent:function(e){V({sortable:t,name:e,originalEvent:o})}},r))};function V(e){Y(i({putSortable:le,cloneEl:te,targetEl:K,rootEl:J,oldIndex:oe,oldDraggableIndex:re,newIndex:ie,newDraggableIndex:ae},e))}var K,G,Z,J,Q,ee,te,ne,oe,ie,re,ae,se,le,ce,de,ue,he,me,pe,ge,fe,be,ve,_e,we=!1,ye=!1,ke=[],Ee=!1,xe=!1,Ce=[],Se=!1,Le=[],Te="undefined"!=typeof document,Ae=p,De=u||d?"cssFloat":"float",Oe=Te&&!g&&!p&&"draggable"in document.createElement("div"),Ie=function(){if(Te){if(d)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var n=C(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=O(e,0,t),r=O(e,1,t),a=i&&C(i),s=r&&C(r),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+A(i).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+A(r).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&a.float&&"none"!==a.float){var d="left"===a.float?"left":"right";return!r||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return i&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=o&&"none"===n[De]||r&&"none"===n[De]&&l+c>o)?"vertical":"horizontal"},Be=function(e){function t(e,n){return function(o,i,r,a){var s=o.options.group.name&&i.options.group.name&&o.options.group.name===i.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(o,i,r,a),n)(o,i,r,a);var l=(n?o:i).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},o=e.group;o&&"object"==r(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},$e=function(){!Ie&&Z&&C(Z,"display","none")},Ne=function(){!Ie&&Z&&C(Z,"display","")};Te&&!g&&document.addEventListener("click",(function(e){if(ye)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ye=!1,!1}),!0);var Xe=function(e){if(K){e=e.touches?e.touches[0]:e;var t=(i=e.clientX,r=e.clientY,ke.some((function(e){var t=e[F].options.emptyInsertThreshold;if(t&&!I(e)){var n=A(e),o=i>=n.left-t&&i<=n.right+t,s=r>=n.top-t&&r<=n.bottom+t;return o&&s?a=e:void 0}})),a);if(t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[F]._onDragOver(n)}}var i,r,a},Pe=function(e){K&&K.parentNode[F]._isOutsideThisEl(e.target)};function je(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=s({},t),e[F]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==je.supportPointer&&"PointerEvent"in window&&!m,emptyInsertThreshold:5};for(var o in q.initializePlugins(this,e,n),n)!(o in t)&&(t[o]=n[o]);for(var i in Be(t),this)"_"===i.charAt(0)&&"function"==typeof this[i]&&(this[i]=this[i].bind(this));this.nativeDraggable=!t.forceFallback&&Oe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?b(e,"pointerdown",this._onTapStart):(b(e,"mousedown",this._onTapStart),b(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(b(e,"dragover",this),b(e,"dragenter",this)),ke.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),s(this,R())}function Fe(e,t,n,o,i,r,a,s){var l,c,h=e[F],m=h.options.onMove;return!window.CustomEvent||d||u?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=o,l.related=i||t,l.relatedRect=r||A(t),l.willInsertAfter=s,l.originalEvent=a,e.dispatchEvent(l),m&&(c=m.call(h,l,a)),c}function Re(e){e.draggable=!1}function He(){Se=!1}function Ue(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function qe(e){return setTimeout(e,0)}function Ye(e){return clearTimeout(e)}je.prototype={constructor:je,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(fe=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,K):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,o=this.options,i=o.preventOnFilter,r=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=o.filter;if(function(e){Le.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var o=t[n];o.checked&&Le.push(o)}}(n),!K&&!(/mousedown|pointerdown/.test(r)&&0!==e.button||o.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!m||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=y(s,o.draggable,n,!1))&&s.animated||ee===s)){if(oe=M(s),re=M(s,o.draggable),"function"==typeof c){if(c.call(this,e,s,this))return V({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),z("filter",t,{evt:e}),void(i&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(o){if(o=y(l,o.trim(),n,!1))return V({sortable:t,rootEl:o,name:"filter",targetEl:s,fromEl:n,toEl:n}),z("filter",t,{evt:e}),!0}))))return void(i&&e.cancelable&&e.preventDefault());o.handle&&!y(l,o.handle,n,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,n){var o,i=this,r=i.el,a=i.options,s=r.ownerDocument;if(n&&!K&&n.parentNode===r){var l=A(n);if(J=r,G=(K=n).parentNode,Q=K.nextSibling,ee=n,se=a.group,je.dragged=K,ce={target:K,clientX:(t||e).clientX,clientY:(t||e).clientY},me=ce.clientX-l.left,pe=ce.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,K.style["will-change"]="all",o=function(){z("delayEnded",i,{evt:e}),je.eventCanceled?i._onDrop():(i._disableDelayedDragEvents(),!h&&i.nativeDraggable&&(K.draggable=!0),i._triggerDragStart(e,t),V({sortable:i,name:"choose",originalEvent:e}),x(K,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){L(K,e.trim(),Re)})),b(s,"dragover",Xe),b(s,"mousemove",Xe),b(s,"touchmove",Xe),b(s,"mouseup",i._onDrop),b(s,"touchend",i._onDrop),b(s,"touchcancel",i._onDrop),h&&this.nativeDraggable&&(this.options.touchStartThreshold=4,K.draggable=!0),z("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(u||d))o();else{if(je.eventCanceled)return void this._onDrop();b(s,"mouseup",i._disableDelayedDrag),b(s,"touchend",i._disableDelayedDrag),b(s,"touchcancel",i._disableDelayedDrag),b(s,"mousemove",i._delayedDragTouchMoveHandler),b(s,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&b(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(o,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){K&&Re(K),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;v(e,"mouseup",this._disableDelayedDrag),v(e,"touchend",this._disableDelayedDrag),v(e,"touchcancel",this._disableDelayedDrag),v(e,"mousemove",this._delayedDragTouchMoveHandler),v(e,"touchmove",this._delayedDragTouchMoveHandler),v(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?b(document,"pointermove",this._onTouchMove):b(document,t?"touchmove":"mousemove",this._onTouchMove):(b(K,"dragend",this),b(J,"dragstart",this._onDragStart));try{document.selection?qe((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(we=!1,J&&K){z("dragStarted",this,{evt:t}),this.nativeDraggable&&b(document,"dragover",Pe);var n=this.options;!e&&x(K,n.dragClass,!1),x(K,n.ghostClass,!0),je.active=this,e&&this._appendGhost(),V({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(de){this._lastX=de.clientX,this._lastY=de.clientY,$e();for(var e=document.elementFromPoint(de.clientX,de.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(de.clientX,de.clientY))!==t;)t=e;if(K.parentNode[F]._isOutsideThisEl(e),t)do{if(t[F]){if(t[F]._onDragOver({clientX:de.clientX,clientY:de.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Ne()}},_onTouchMove:function(e){if(ce){var t=this.options,n=t.fallbackTolerance,o=t.fallbackOffset,i=e.touches?e.touches[0]:e,r=Z&&S(Z,!0),a=Z&&r&&r.a,s=Z&&r&&r.d,l=Ae&&_e&&B(_e),c=(i.clientX-ce.clientX+o.x)/(a||1)+(l?l[0]-Ce[0]:0)/(a||1),d=(i.clientY-ce.clientY+o.y)/(s||1)+(l?l[1]-Ce[1]:0)/(s||1);if(!je.active&&!we){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Z){r?(r.e+=c-(ue||0),r.f+=d-(he||0)):r={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");C(Z,"webkitTransform",u),C(Z,"mozTransform",u),C(Z,"msTransform",u),C(Z,"transform",u),ue=c,he=d,de=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Z){var e=this.options.fallbackOnBody?document.body:J,t=A(K,!0,Ae,!0,e),n=this.options;if(Ae){for(_e=e;"static"===C(_e,"position")&&"none"===C(_e,"transform")&&_e!==document;)_e=_e.parentNode;_e!==document.body&&_e!==document.documentElement?(_e===document&&(_e=T()),t.top+=_e.scrollTop,t.left+=_e.scrollLeft):_e=T(),Ce=B(_e)}x(Z=K.cloneNode(!0),n.ghostClass,!1),x(Z,n.fallbackClass,!0),x(Z,n.dragClass,!0),C(Z,"transition",""),C(Z,"transform",""),C(Z,"box-sizing","border-box"),C(Z,"margin",0),C(Z,"top",t.top),C(Z,"left",t.left),C(Z,"width",t.width),C(Z,"height",t.height),C(Z,"opacity","0.8"),C(Z,"position",Ae?"absolute":"fixed"),C(Z,"zIndex","100000"),C(Z,"pointerEvents","none"),je.ghost=Z,e.appendChild(Z),C(Z,"transform-origin",me/parseInt(Z.style.width)*100+"% "+pe/parseInt(Z.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,o=e.dataTransfer,i=n.options;z("dragStart",this,{evt:e}),je.eventCanceled?this._onDrop():(z("setupClone",this),je.eventCanceled||((te=j(K)).removeAttribute("id"),te.draggable=!1,te.style["will-change"]="",this._hideClone(),x(te,this.options.chosenClass,!1),je.clone=te),n.cloneId=qe((function(){z("clone",n),je.eventCanceled||(n.options.removeCloneOnHide||J.insertBefore(te,K),n._hideClone(),V({sortable:n,name:"clone"}))})),!t&&x(K,i.dragClass,!0),t?(ye=!0,n._loopId=setInterval(n._emulateDragOver,50)):(v(document,"mouseup",n._onDrop),v(document,"touchend",n._onDrop),v(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",i.setData&&i.setData.call(n,o,K)),b(document,"drop",n),C(K,"transform","translateZ(0)")),we=!0,n._dragStartId=qe(n._dragStarted.bind(n,t,e)),b(document,"selectstart",n),ge=!0,m&&C(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,o,r,a=this.el,s=e.target,l=this.options,c=l.group,d=je.active,u=se===c,h=l.sort,m=le||d,p=this,g=!1;if(!Se){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=y(s,l.draggable,a,!0),j("dragOver"),je.eventCanceled)return g;if(K.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||p._ignoreWhileAnimating===s)return H(!1);if(ye=!1,d&&!l.disabled&&(u?h||(o=G!==J):le===this||(this.lastPutMode=se.checkPull(this,d,K,e))&&c.checkPut(this,d,K,e))){if(r="vertical"===this._getDirection(e,s),t=A(K),j("dragOverValid"),je.eventCanceled)return g;if(o)return G=J,R(),this._hideClone(),j("revert"),je.eventCanceled||(Q?J.insertBefore(K,Q):J.appendChild(K)),H(!0);var f=I(a,l.draggable);if(!f||function(e,t,n){var o=A(I(n.el,n.options.draggable)),i=10;return t?e.clientX>o.right+i||e.clientX<=o.right&&e.clientY>o.bottom&&e.clientX>=o.left:e.clientX>o.right&&e.clientY>o.top||e.clientX<=o.right&&e.clientY>o.bottom+i}(e,r,this)&&!f.animated){if(f===K)return H(!1);if(f&&a===e.target&&(s=f),s&&(n=A(s)),!1!==Fe(J,a,K,t,s,n,e,!!s))return R(),f&&f.nextSibling?a.insertBefore(K,f.nextSibling):a.appendChild(K),G=a,U(),H(!0)}else if(f&&function(e,t,n){var o=A(O(n.el,0,n.options,!0)),i=10;return t?e.clientX<o.left-i||e.clientY<o.top&&e.clientX<o.right:e.clientY<o.top-i||e.clientY<o.bottom&&e.clientX<o.left}(e,r,this)){var b=O(a,0,l,!0);if(b===K)return H(!1);if(n=A(s=b),!1!==Fe(J,a,K,t,s,n,e,!1))return R(),a.insertBefore(K,b),G=a,U(),H(!0)}else if(s.parentNode===a){n=A(s);var v,_,w,k=K.parentNode!==a,E=!function(e,t,n){var o=n?e.left:e.top,i=n?e.right:e.bottom,r=n?e.width:e.height,a=n?t.left:t.top,s=n?t.right:t.bottom,l=n?t.width:t.height;return o===a||i===s||o+r/2===a+l/2}(K.animated&&K.toRect||t,s.animated&&s.toRect||n,r),S=r?"top":"left",L=D(s,"top","top")||D(K,"top","top"),T=L?L.scrollTop:void 0;if(fe!==s&&(_=n[S],Ee=!1,xe=!E&&l.invertSwap||k),v=function(e,t,n,o,i,r,a,s){var l=o?e.clientY:e.clientX,c=o?n.height:n.width,d=o?n.top:n.left,u=o?n.bottom:n.right,h=!1;if(!a)if(s&&ve<c*i){if(!Ee&&(1===be?l>d+c*r/2:l<u-c*r/2)&&(Ee=!0),Ee)h=!0;else if(1===be?l<d+ve:l>u-ve)return-be}else if(l>d+c*(1-i)/2&&l<u-c*(1-i)/2)return function(e){return M(K)<M(e)?1:-1}(t);if((h=h||a)&&(l<d+c*r/2||l>u-c*r/2))return l>d+c/2?1:-1;return 0}(e,s,n,r,E?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,xe,fe===s),0!==v){var B=M(K);do{B-=v,w=G.children[B]}while(w&&("none"===C(w,"display")||w===Z))}if(0===v||w===s)return H(!1);fe=s,be=v;var $=s.nextElementSibling,N=!1,X=Fe(J,a,K,t,s,n,e,N=1===v);if(!1!==X)return 1!==X&&-1!==X||(N=1===X),Se=!0,setTimeout(He,30),R(),N&&!$?a.appendChild(K):s.parentNode.insertBefore(K,N?$:s),L&&P(L,0,T-L.scrollTop),G=K.parentNode,void 0===_||xe||(ve=Math.abs(_-A(s)[S])),U(),H(!0)}if(a.contains(K))return H(!1)}return!1}function j(l,c){z(l,p,i({evt:e,isOwner:u,axis:r?"vertical":"horizontal",revert:o,dragRect:t,targetRect:n,canSort:h,fromSortable:m,target:s,completed:H,onMove:function(n,o){return Fe(J,a,K,t,n,A(n),e,o)},changed:U},c))}function R(){j("dragOverAnimationCapture"),p.captureAnimationState(),p!==m&&m.captureAnimationState()}function H(t){return j("dragOverCompleted",{insertion:t}),t&&(u?d._hideClone():d._showClone(p),p!==m&&(x(K,le?le.options.ghostClass:d.options.ghostClass,!1),x(K,l.ghostClass,!0)),le!==p&&p!==je.active?le=p:p===je.active&&le&&(le=null),m===p&&(p._ignoreWhileAnimating=s),p.animateAll((function(){j("dragOverAnimationComplete"),p._ignoreWhileAnimating=null})),p!==m&&(m.animateAll(),m._ignoreWhileAnimating=null)),(s===K&&!K.animated||s===a&&!s.animated)&&(fe=null),l.dragoverBubble||e.rootEl||s===document||(K.parentNode[F]._isOutsideThisEl(e.target),!t&&Xe(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function U(){ie=M(K),ae=M(K,l.draggable),V({sortable:p,name:"change",toEl:a,newIndex:ie,newDraggableIndex:ae,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){v(document,"mousemove",this._onTouchMove),v(document,"touchmove",this._onTouchMove),v(document,"pointermove",this._onTouchMove),v(document,"dragover",Xe),v(document,"mousemove",Xe),v(document,"touchmove",Xe)},_offUpEvents:function(){var e=this.el.ownerDocument;v(e,"mouseup",this._onDrop),v(e,"touchend",this._onDrop),v(e,"pointerup",this._onDrop),v(e,"touchcancel",this._onDrop),v(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ie=M(K),ae=M(K,n.draggable),z("drop",this,{evt:e}),G=K&&K.parentNode,ie=M(K),ae=M(K,n.draggable),je.eventCanceled||(we=!1,xe=!1,Ee=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ye(this.cloneId),Ye(this._dragStartId),this.nativeDraggable&&(v(document,"drop",this),v(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),m&&C(document.body,"user-select",""),C(K,"transform",""),e&&(ge&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Z&&Z.parentNode&&Z.parentNode.removeChild(Z),(J===G||le&&"clone"!==le.lastPutMode)&&te&&te.parentNode&&te.parentNode.removeChild(te),K&&(this.nativeDraggable&&v(K,"dragend",this),Re(K),K.style["will-change"]="",ge&&!we&&x(K,le?le.options.ghostClass:this.options.ghostClass,!1),x(K,this.options.chosenClass,!1),V({sortable:this,name:"unchoose",toEl:G,newIndex:null,newDraggableIndex:null,originalEvent:e}),J!==G?(ie>=0&&(V({rootEl:G,name:"add",toEl:G,fromEl:J,originalEvent:e}),V({sortable:this,name:"remove",toEl:G,originalEvent:e}),V({rootEl:G,name:"sort",toEl:G,fromEl:J,originalEvent:e}),V({sortable:this,name:"sort",toEl:G,originalEvent:e})),le&&le.save()):ie!==oe&&ie>=0&&(V({sortable:this,name:"update",toEl:G,originalEvent:e}),V({sortable:this,name:"sort",toEl:G,originalEvent:e})),je.active&&(null!=ie&&-1!==ie||(ie=oe,ae=re),V({sortable:this,name:"end",toEl:G,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){z("nulling",this),J=K=G=Z=Q=te=ee=ne=ce=de=ge=ie=ae=oe=re=fe=be=le=se=je.dragged=je.ghost=je.clone=je.active=null,Le.forEach((function(e){e.checked=!0})),Le.length=ue=he=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":K&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,o=0,i=n.length,r=this.options;o<i;o++)y(e=n[o],r.draggable,this.el,!1)&&t.push(e.getAttribute(r.dataIdAttr)||Ue(e));return t},sort:function(e,t){var n={},o=this.el;this.toArray().forEach((function(e,t){var i=o.children[t];y(i,this.options.draggable,o,!1)&&(n[e]=i)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(o.removeChild(n[e]),o.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return y(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var o=q.modifyOption(this,e,t);n[e]=void 0!==o?o:t,"group"===e&&Be(n)},destroy:function(){z("destroy",this);var e=this.el;e[F]=null,v(e,"mousedown",this._onTapStart),v(e,"touchstart",this._onTapStart),v(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(v(e,"dragover",this),v(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),ke.splice(ke.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ne){if(z("hideClone",this),je.eventCanceled)return;C(te,"display","none"),this.options.removeCloneOnHide&&te.parentNode&&te.parentNode.removeChild(te),ne=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ne){if(z("showClone",this),je.eventCanceled)return;K.parentNode!=J||this.options.group.revertClone?Q?J.insertBefore(te,Q):J.appendChild(te):J.insertBefore(te,K),this.options.group.revertClone&&this.animate(K,te),C(te,"display",""),ne=!1}}else this._hideClone()}},Te&&b(document,"touchmove",(function(e){(je.active||we)&&e.cancelable&&e.preventDefault()})),je.utils={on:b,off:v,css:C,find:L,is:function(e,t){return!!y(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:X,closest:y,toggleClass:x,clone:j,index:M,nextTick:qe,cancelNextTick:Ye,detectDirection:Me,getChild:O},je.get=function(e){return e[F]},je.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(je.utils=i(i({},je.utils),e.utils)),q.mount(e)}))},je.create=function(e,t){return new je(e,t)},je.version="1.15.0";var We,ze,Ve,Ke,Ge,Ze,Je=[],Qe=!1;function et(){Je.forEach((function(e){clearInterval(e.pid)})),Je=[]}function tt(){clearInterval(Ze)}var nt=X((function(e,t,n,o){if(t.scroll){var i,r=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=T(),d=!1;ze!==n&&(ze=n,et(),We=t.scroll,i=t.scrollFn,!0===We&&(We=$(n,!0)));var u=0,h=We;do{var m=h,p=A(m),g=p.top,f=p.bottom,b=p.left,v=p.right,_=p.width,w=p.height,y=void 0,k=void 0,E=m.scrollWidth,x=m.scrollHeight,S=C(m),L=m.scrollLeft,D=m.scrollTop;m===c?(y=_<E&&("auto"===S.overflowX||"scroll"===S.overflowX||"visible"===S.overflowX),k=w<x&&("auto"===S.overflowY||"scroll"===S.overflowY||"visible"===S.overflowY)):(y=_<E&&("auto"===S.overflowX||"scroll"===S.overflowX),k=w<x&&("auto"===S.overflowY||"scroll"===S.overflowY));var O=y&&(Math.abs(v-r)<=s&&L+_<E)-(Math.abs(b-r)<=s&&!!L),I=k&&(Math.abs(f-a)<=s&&D+w<x)-(Math.abs(g-a)<=s&&!!D);if(!Je[u])for(var M=0;M<=u;M++)Je[M]||(Je[M]={});Je[u].vx==O&&Je[u].vy==I&&Je[u].el===m||(Je[u].el=m,Je[u].vx=O,Je[u].vy=I,clearInterval(Je[u].pid),0==O&&0==I||(d=!0,Je[u].pid=setInterval(function(){o&&0===this.layer&&je.active._onTouchMove(Ge);var t=Je[this.layer].vy?Je[this.layer].vy*l:0,n=Je[this.layer].vx?Je[this.layer].vx*l:0;"function"==typeof i&&"continue"!==i.call(je.dragged.parentNode[F],n,t,e,Ge,Je[this.layer].el)||P(Je[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=$(h,!1)));Qe=d}}),30),ot=function(e){var t=e.originalEvent,n=e.putSortable,o=e.dragEl,i=e.activeSortable,r=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=n||i;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(r("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function it(){}function rt(){}it.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=O(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:ot},s(it,{pluginName:"revertOnSpill"}),rt.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:ot},s(rt,{pluginName:"removeOnSpill"});je.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?b(document,"dragover",this._handleAutoScroll):this.options.supportPointer?b(document,"pointermove",this._handleFallbackAutoScroll):t.touches?b(document,"touchmove",this._handleFallbackAutoScroll):b(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?v(document,"dragover",this._handleAutoScroll):(v(document,"pointermove",this._handleFallbackAutoScroll),v(document,"touchmove",this._handleFallbackAutoScroll),v(document,"mousemove",this._handleFallbackAutoScroll)),tt(),et(),clearTimeout(k),k=void 0},nulling:function(){Ge=ze=We=Qe=Ze=Ve=Ke=null,Je.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,o=(e.touches?e.touches[0]:e).clientX,i=(e.touches?e.touches[0]:e).clientY,r=document.elementFromPoint(o,i);if(Ge=e,t||this.options.forceAutoScrollFallback||u||d||m){nt(e,this.options,r,t);var a=$(r,!0);!Qe||Ze&&o===Ve&&i===Ke||(Ze&&tt(),Ze=setInterval((function(){var r=$(document.elementFromPoint(o,i),!0);r!==a&&(a=r,et()),nt(e,n.options,r,t)}),10),Ve=o,Ke=i)}else{if(!this.options.bubbleScroll||$(r,!0)===T())return void et();nt(e,this.options,$(r,!1),!1)}}},s(e,{pluginName:"scroll",initializeByDefault:!0})}),je.mount(rt,it);const at=je}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={id:e,exports:{}};return n[e].call(r.exports,r,r.exports,i),r.exports}i.m=n,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>"js/"+{192:"webcomponents/vb-services",211:"webcomponents/vb-virtual-pagination",971:"webcomponents/vb-header"}[e]+".js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="visual-bookmarks-dev:",i.l=(n,o,r,a)=>{if(e[n])e[n].push(o);else{var s,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+r),s.src=n),e[n]=[o];var h=(t,o)=>{s.onerror=s.onload=null,clearTimeout(m);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(o))),t)return t(o)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&!e;)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../"})(),(()=>{var e={532:0};i.f.j=(t,n)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=r);var a=i.p+i.u(t),s=new Error;i.l(a,(n=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",s.name="ChunkLoadError",s.type=r,s.request=a,o[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,r,[a,s,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);if(l)l(i)}for(t&&t(n);c<a.length;c++)r=a[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=globalThis.webpackChunkvisual_bookmarks_dev=globalThis.webpackChunkvisual_bookmarks_dev||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";i(164);var e=i(339);const t="contextmenu:open",n="contextmenu:close",o="contextmenu:selection";const r=class{constructor(e,t){if("string"==typeof e&&(e=document.querySelector(e)),!(e instanceof HTMLElement))throw Error("Check the argument of the selector");this.menu=e,this.menu.active||(this.menu.active=!0,this.settings=Object.assign({tresholdMargin:10,delegateSelector:"html",scrollContainer:window},t),this.init())}init(){if(this.state=!1,this.trigger=null,this.settings.scrollContainer!==window){const e=document.querySelector(this.settings.scrollContainer);this.scrollContainer=e||window}else this.scrollContainer=window;this.menuWidth=null,this.menuHeight=null,this.menuX=null,this.menuY=null,this.attachEvents()}getDOMChildren(){this.items=Array.from(this.menu.querySelectorAll(".context-menu__link")),this.itemsLength=this.items.length}attachEvents(){this.handlerTrigger=this.handlerTrigger.bind(this),this.handlerClick=this.handlerClick.bind(this),this.handlerKeyboard=this.handlerKeyboard.bind(this),this.handlerClose=this.handlerClose.bind(this),this.scrollContainer.addEventListener("scroll",this.handlerClose),window.addEventListener("resize",this.handlerClose),document.addEventListener("contextmenu",this.handlerTrigger),document.addEventListener("keydown",this.handlerKeyboard),document.addEventListener("click",this.handlerClick)}detachEvents(){this.scrollContainer.removeEventListener("scroll",this.handlerClose),window.removeEventListener("resize",this.handlerClose),document.removeEventListener("contextmenu",this.handlerTrigger),document.removeEventListener("keydown",this.handlerKeyboard),document.removeEventListener("click",this.handlerClick)}position(e){if(this.menu.style.top=0,this.menu.style.left=0,e.clientX||e.clientY)this.menuX=e.pageX,this.menuY=e.pageY;else{const t=e.target.getBoundingClientRect();this.menuX=t.left+window.pageXOffset,this.menuY=t.top+window.pageYOffset}this.menuWidth=this.menu.offsetWidth,this.menuHeight=this.menu.offsetHeight;const t=document.documentElement.clientWidth+window.pageXOffset,n=document.documentElement.clientHeight+window.pageYOffset;t-this.menuX<this.menuWidth?this.menu.style.left=t-this.menuWidth-this.settings.tresholdMargin+"px":this.menu.style.left=`${this.menuX}px`,n-this.menuY<this.menuHeight?this.menu.style.top=n-this.menuHeight-this.settings.tresholdMargin+"px":this.menu.style.top=`${this.menuY}px`}handlerClose(){this.close()}handlerKeyboard(e){switch(e.which){case 38:this.state&&(e.preventDefault(),this.prev());break;case 40:this.state&&(e.preventDefault(),this.next());break;case 27:this.close();break;case 13:this.enter(e)}}handlerClick(e){if(!this.state)return;if(!e.target.closest(".context-menu"))return void this.close();e.preventDefault();const t=e.target.closest(".context-menu__link");this.select(t)}handlerTrigger(e){if(!this.menu||!this.menu.active)return;const t=e.target.closest(this.settings.delegateSelector);t?(e.preventDefault(),this.trigger=t,this.close(),this.open(e)):this.close()}next(){this.currentIndex=(this.currentIndex+1)%this.itemsLength,this.items[this.currentIndex].classList.contains("is-disabled")?this.next():this.mark()}prev(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.itemsLength-1),this.items[this.currentIndex].classList.contains("is-disabled")?this.prev():this.mark()}mark(){const e=this.menu.querySelector(".hover");e&&e.classList.remove("hover"),this.items[this.currentIndex].classList.add("hover")}enter(e){this.state&&(e.preventDefault(),e.stopPropagation(),this.select(this.items[this.currentIndex]))}select(t){t&&!t.classList.contains("disabled")&&((0,e.g9)(o,this.menu,{detail:{selection:t.dataset.action,trigger:this.trigger}}),this.close())}open(n){this.state||(this.state=!0,this.menu.classList.add("context-menu--open"),(0,e.g9)(t,this.menu,{detail:{trigger:this.trigger}}),this.position(n),this.currentIndex=-1,this.getDOMChildren())}close(){if(!this.state)return;this.state=!1,this.menu.classList.remove("context-menu--open");const t=this.menu.querySelector(".hover");t&&t.classList.remove("hover"),this.currentIndex=-1,(0,e.g9)(n,this.menu,{detail:{trigger:this.trigger}})}destroy(){this.menu&&this.menu.active&&(this.close(),this.detachEvents(),delete this.menu.active,Object.keys(this).forEach((e=>{delete this[e]})))}};class a extends HTMLElement{containerNode=null;menuNode=null;items=[];constructor(){super()}connectedCallback(){this.render(),this.menuInstance=new r(this.containerNode,{delegateSelector:this.triggerSelector,scrollContainer:".app"}),this.handleMenuOpen=this.handleMenuOpen.bind(this),this.handleMenuSelect=this.handleMenuSelect.bind(this),this.containerNode.addEventListener("contextmenu:open",this.handleMenuOpen),this.containerNode.addEventListener("contextmenu:selection",this.handleMenuSelect)}disconnectedCallback(){this.menuInstance.destroy(),delete this.menuInstance}get listItems(){return this.items}set listItems(e){this.diffItems(e)&&(this.items=structuredClone(e),this.setItems())}get triggerSelector(){return this.getAttribute("trigger-selector")}set triggerSelector(e){this.setAttribute("trigger-selector",e)}render(){this.containerNode=(0,e.xX)("div",{class:"context-menu"}),this.menuNode=(0,e.xX)("ul",{class:"context-menu__list"}),this.containerNode.append(this.menuNode),this.append(this.containerNode)}setItems(){const e=this.items.map((e=>{const t=e.disabled?"is-disabled":"";return e.divider?'<li class="context-menu__item context-menu__item--divider"></li>':`<li class="context-menu__item">\n          <a class="context-menu__link ${t}" data-action="${e.action}">\n            <span class="context-menu__icon">${e.icon?e.icon:""}</span>\n            <span class="">${e.title}</span>\n          </a>\n        </li>`})).join("");this.menuNode.innerHTML=e,this.menuInstance.getDOMChildren()}close(){this.menuInstance.close()}trigger(e){this.menuInstance.handlerTrigger(e)}handleMenuOpen(e){this.dispatchEvent(new CustomEvent("vb:contextmenu:open",{detail:e.detail.trigger,bubbles:!0,cancelable:!0}))}handleMenuSelect(e){this.dispatchEvent(new CustomEvent("vb:contextmenu:select",{detail:{trigger:e.detail.trigger,selection:e.detail.selection},bubbles:!0,cancelable:!0}))}diffItems(e){return JSON.stringify(this.listItems)!==JSON.stringify(e)}}window.customElements.define("vb-context-menu",a);var s=i(458);class l extends HTMLElement{scrollButton=null;connectedCallback(){this.#a(),this.#e()}disconnectedCallback(){this.#t()}get scrollSelector(){return this.getAttribute("scroll-selector")}get scrollTop(){return this.scrollContainer===window?window.scrollY:this.scrollContainer.scrollTop}get title(){return this.getAttribute("title")}set title(e){this.setAttribute("title",e)}#a(){this.classList.add("vb-scrollup"),this.scrollButton=(0,e.xX)("button",{class:"vb-scrollup__button","aria-label":"Go to the top"},{html:'<svg width="20" height="20">\n          <use xlink:href="/img/symbol.svg#arrow_upward"/>\n        </svg>'}),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`<style>${s.Z}</style>`,this.shadowRoot.append(this.scrollButton),this.scrollContainer=document.querySelector(this.scrollSelector)??window}#e(){this.handleClick=this.handleClick.bind(this),this.scrollButton.addEventListener("click",this.handleClick),this.handleScroll=this.handleScroll.bind(this),this.scrollContainer.addEventListener("scroll",this.handleScroll)}#t(){this.scrollButton.removeEventListener("click",this.handleClick),this.scrollContainer.removeEventListener("scroll",this.handleScroll)}handleScroll(){const e=this.scrollTop>1e3;this.classList.toggle("is-shown",e),this.scrollButton.disabled=!e}handleClick(e){e.preventDefault(),this.scrollContainer.scrollTo({left:0,top:0,behavior:"smooth"})}}window.customElements.define("vb-scrollup",l);var c=i(461),d=i(594);class u extends HTMLElement{panel=null;actions=[{icon:"launch",tag:"button",action:"open_all",text:browser.i18n.getMessage("open_selected")},{icon:"delete_outline",tag:"button",action:"remove",text:browser.i18n.getMessage("delete_selected")},{icon:"capture_outline",tag:"button",action:"update_thumbnails",text:browser.i18n.getMessage("thumbnails_update")}];folderId=null;foldersThree=[];set selectedFolder(e){this.folderId=e}set folders(e){this.foldersThree=e}connectedCallback(){this.#a(),this.#e()}disconnectedCallback(){this.#t()}#a(){this.classList.add("bookmarks-panel"),this.panelActions=(0,e.xX)("div",{class:"bookmarks-panel__body"}),this.closeBtn=(0,e.xX)("button",{class:"bookmarks-panel__close md-ripple","data-ripple-center":"","aria-label":browser.i18n.getMessage("btn_close")},{html:'<svg width="20" height="20"><use xlink:href="/img/symbol.svg#close"/></svg>'}),this.actionsNodes=this.actions.map((e=>{if("open_all"===e.action){const t=d.Km.filter((e=>["open_all","open_all_window","new_window_incognito"].includes(e.action))).map((e=>`<div class="bookmarks-panel__popup-action" data-action="${e.action}">${e.title}</div>`));return`<vb-popup class="bookmarks-panel__popup" label="${browser.i18n.getMessage("toggle_selected_bookmarks_popup")}">\n            <span class="bookmarks-panel__action" slot="button">\n              <svg width="20" height="20"><use xlink:href="/img/symbol.svg#${e.icon}"></use></svg>\n            </span>\n            <div class="bookmarks-panel__popup-content" slot="content">\n              ${t.join("")}\n            </div>\n          </vb-popup>`}return`<button class="bookmarks-panel__action md-ripple" data-ripple-center data-action="${e.action}" aria-label="${e.text}">\n          <svg width="20" height="20"><use xlink:href="/img/symbol.svg#${e.icon}"></use></svg>\n        </button>`})),this.selectContainer=(0,e.xX)("div",{class:"bookmarks-panel__selector"}),this.select=(0,e.xX)("vb-select-folders"),this.selectButton=(0,e.xX)("button",{id:"panel_bookmark_selector",class:"btn md-ripple",hidden:!0,disabled:!0},browser.i18n.getMessage("button_action_move")),this.selectContainer.append(this.select,this.selectButton),this.innerHTML=`<style>${c.Z}</style>`,this.panelActions.innerHTML=this.actionsNodes.join(""),this.panelActions.append(this.selectContainer),this.append(this.panelActions),this.append(this.closeBtn),this.select.value=this.folderId,this.select.folders=this.foldersThree}#e(){this.handleClickAction=this.selectAction.bind(this),this.addEventListener("click",this.handleClickAction),this.handleClose=this.close.bind(this),this.closeBtn.addEventListener("click",this.handleClose),this.handleChangeFolder=this.changeFolder.bind(this),this.select.addEventListener("vb:select:change",this.handleChangeFolder)}#t(){this.removeEventListener("click",this.handleClickAction),this.closeBtn.removeEventListener("click",this.handleClose),this.select.removeEventListener("vb:select:change",this.handleChangeFolder),this.handleChangeFolder=null,this.handleClickAction=null,this.handleClose=null}changeFolder({detail:e}){this.selectButton.hidden=this.folderId===e,this.selectButton.disabled=this.selectButton.hidden,this.selectButton.hidden?(delete this.selectButton.dataset.action,delete this.selectButton.dataset.destFolder):(this.selectButton.dataset.action="move_bookmarks",this.selectButton.dataset.destFolder=e)}selectAction(e){const t=e.target.closest("[data-action]");if(!t)return;const n=t.dataset.action,o=t.dataset.destFolder;document.dispatchEvent(new CustomEvent("vb-bookmarks-panel:action",{detail:{action:n,...o&&{destFolder:o}}}))}close(){document.dispatchEvent(new CustomEvent("vb-bookmarks-panel:close"))}}window.customElements.define("vb-bookmarks-panel",u);var h=i(636),m=i.n(h),p=i(363),g=i.n(p),f=i(485),b=i(474);const v=(()=>{const t={position:"bottom-left",modClass:"",hideByClick:!0,delay:5e3,message:"",onClose:null},n={top:{el:o("top")},"top-left":{el:o("top-left")},"top-right":{el:o("top-right")},bottom:{el:o("bottom")},"bottom-left":{el:o("bottom-left")},"bottom-right":{el:o("bottom-right")}};function o(t){return(0,e.xX)("div",{class:"toast-container toast-container"+(t?`--${t}`:"")})}return function(){const e=document.createDocumentFragment();Object.keys(n).forEach((t=>e.append(n[t].el))),document.body.append(e)}(),{show:function(o){let i=!1;const r={...t};"string"==typeof o?r.message=o:Object.assign(r,o);const a=(0,e.xX)("div",{class:`toast toast--${r.position}`},{html:`<div class="toast__message">${r.message}</div>`}),s=e=>{if(!i){if(e){if(!e.target.closest(".toast__btn"))return;i=!0}a.classList.add("is-deleting"),a.removeEventListener("click",s),setTimeout((()=>{a.remove(),r.onClose?.()}),250)}};if(r.hideByClick){const t=(0,e.xX)("button",{class:"toast__btn","aria-label":"Close"},{html:'<svg version="1.1" width="24" height="24" viewBox="0 0 24 24" fill="#000"><path d="M18.984 6.422l-5.578 5.578 5.578 5.578-1.406 1.406-5.578-5.578-5.578 5.578-1.406-1.406 5.578-5.578-5.578-5.578 1.406-1.406 5.578 5.578 5.578-5.578z"></path></svg>'});a.append(t),a.addEventListener("click",s)}const l=n[r.position];r.position.startsWith("top")?l.el.prepend(a):l.el.append(a),setTimeout((()=>{a.classList.add("toast-enter")}),16),r.delay&&setTimeout(s,r.delay)}}})(),_=v,w=(e,t)=>t.some((t=>e instanceof t));let y,k;const E=new WeakMap,x=new WeakMap,C=new WeakMap,S=new WeakMap,L=new WeakMap;let T={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return x.get(e);if("objectStoreNames"===t)return e.objectStoreNames||C.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return O(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function A(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(I(this),t),O(E.get(this))}:function(...t){return O(e.apply(I(this),t))}:function(t,...n){const o=e.call(I(this),t,...n);return C.set(o,t.sort?t.sort():[t]),O(o)}}function D(e){return"function"==typeof e?A(e):(e instanceof IDBTransaction&&function(e){if(x.has(e))return;const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",r),e.removeEventListener("abort",r)},i=()=>{t(),o()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",i),e.addEventListener("error",r),e.addEventListener("abort",r)}));x.set(e,t)}(e),w(e,y||(y=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,T):e)}function O(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("success",i),e.removeEventListener("error",r)},i=()=>{t(O(e.result)),o()},r=()=>{n(e.error),o()};e.addEventListener("success",i),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&E.set(t,e)})).catch((()=>{})),L.set(t,e),t}(e);if(S.has(e))return S.get(e);const t=D(e);return t!==e&&(S.set(e,t),L.set(t,e)),t}const I=e=>L.get(e);const M=["get","getKey","getAll","getAllKeys","count"],B=["put","add","delete","clear"],$=new Map;function N(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if($.get(t))return $.get(t);const n=t.replace(/FromIndex$/,""),o=t!==n,i=B.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!i&&!M.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,i?"readwrite":"readonly");let a=r.store;return o&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&r.done]))[0]};return $.set(t,r),r}T=(e=>({...e,get:(t,n,o)=>N(t,n)||e.get(t,n,o),has:(t,n)=>!!N(t,n)||e.has(t,n)}))(T);class X{static DB_NAME="visual-bookmarks";static DB_VERSION=1;static DB_STORE="images";static DB=null;static async#s(){return this.DB=this.DB||await function(e,t,{blocked:n,upgrade:o,blocking:i,terminated:r}={}){const a=indexedDB.open(e,t),s=O(a);return o&&a.addEventListener("upgradeneeded",(e=>{o(O(a.result),e.oldVersion,e.newVersion,O(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),s.then((e=>{r&&e.addEventListener("close",(()=>r())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),s}(this.DB_NAME,this.DB_VERSION,{upgrade(e,t){if(0===t)e.createObjectStore(X.DB_STORE,{keyPath:"id",autoIncrement:!0})},blocking(){location.reload()}}),X.DB}static async deleteDB(){if(!this.DB)return!0;try{return await this.DB.close(),await function(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),O(n).then((()=>{}))}(this.DB_NAME),this.DB=null,!0}catch(e){return console.warn(e),!1}}static async clear(){try{const e=await this.#s();return await e.clear(this.DB_STORE),!0}catch(e){return console.warn(e),!1}}static async count(){try{const e=await this.#s();return await e.count(this.DB_STORE)}catch(e){console.warn(e)}}static async add(e){try{const t=(await this.#s()).transaction(this.DB_STORE,"readwrite"),n=e.map((e=>t.store.add(e).then((t=>({id:t,...e}))))),o=await Promise.all(n);return await t.done,o}catch(e){console.warn(e)}}static async get(e){try{const t=await this.#s();return await t.get(this.DB_STORE,e)}catch(e){console.warn(e)}}static async update(e){try{const t=await this.#s();return await t.put(this.DB_STORE,e)}catch(e){console.warn(e)}}static async delete(e){try{const t=await this.#s();return await t.delete(this.DB_STORE,e)}catch(e){console.warn(e)}}static async getAllByIds(e){try{const t=await this.#s();let n=await t.transaction(this.DB_STORE).store.openCursor();const o=[];for(;n;)e.includes(n.value.id)&&o.push(n.value),n=await n.continue();return o}catch(e){console.warn(e)}}}var P=i(724),j=i(856);const F=`<div class="gmodal__container gmodal__container--popup has-center">\n  <div class="gmodal__dialog">\n    <div class="gmodal__header">\n      <div class="gmodal__title">${browser.i18n.getMessage("ext_name")}</div>\n      <button type="button" class="gmodal__close md-ripple" data-popup="reject" data-ripple-center>\n        <svg version="1.1" width="24" height="24" viewBox="0 0 24 24" fill="#000">\n          <path d="M18.984 6.422l-5.578 5.578 5.578 5.578-1.406 1.406-5.578-5.578-5.578 5.578-1.406-1.406 5.578-5.578-5.578-5.578 1.406-1.406 5.578 5.578 5.578-5.578z"></path>\n        </svg>\n      </button>\n    </div>\n    <div class="gmodal__body" id="popupBody"></div>\n    <div class="gmodal__footer text-right">\n      <button type="button" class="btn btn--clear md-ripple" data-popup="reject">${browser.i18n.getMessage("btn_close")}</button>\n      <button type="button" class="btn md-ripple" data-popup="resolve">Ok</button>\n    </div>\n  </div>\n</div>`,R=(0,e.xX)("div",{class:"gmodal gmodal--popup",id:"popup"},{html:F});const H=function(e){let t=!1;document.body.appendChild(R);const n=document.getElementById("popupBody"),o=Array.from(R.querySelectorAll("[data-popup]")),i=R.querySelector('[data-popup="resolve"]'),r=new(m())(R,{closeBackdrop:!1});return r.element.addEventListener("gmodal:open",(()=>{i.focus()})),n.textContent=e,r.open(),new Promise((e=>{const n=function(){const e=this.dataset.popup;t="resolve"===e,r.close()},i=function(){o.forEach((e=>{e.removeEventListener("click",n)})),r.element.removeEventListener("gmodal:close",i),e(!!t),t=!1,r.destroy(),R.remove()};o.forEach((e=>{e.addEventListener("click",n)})),r.element.addEventListener("gmodal:close",i)}))};async function U({permissions:e,origins:t}){return await browser.permissions.contains({permissions:e,origins:t})}class q extends HTMLAnchorElement{#l=!1;#c=null;#d=[];#u=!1;constructor(){super()}connectedCallback(){this.#a(),this.#l=!0}disconnectedCallback(){document.dispatchEvent(new CustomEvent("bookmark-removed",{detail:{id:this.id,image:this.image}}))}static get observedAttributes(){return["href","title","image","has-overlay"]}get#h(){return Boolean(this.#d.length)}#m(t){t?(this.#c=(0,e.xX)("div",{class:"bookmark__overlay"},{html:d.LZ}),this.appendChild(this.#c),this.classList.add("disable-events")):(this.#c?.remove(),this.classList.remove("disable-events"))}#p(){const e=this.querySelector(".bookmark__img");e.className="bookmark__img bookmark__img--logo",this.#u&&e.classList.add("bookmark__img--external"),e.style.backgroundImage=`url('${this.#g(this.url)}')`}#f(){if(this.hasFavicon){this.querySelector(".bookmark__favicon").src=this.faviconUrl}}attributeChangedCallback(e,t,n){if(this.#l&&t!==n){if("has-overlay"===e&&this.#m(this.hasOverlay),"title"===e){const e=this.querySelector(".bookmark__title");e&&(e.textContent=n)}if("image"===e){const e=this.querySelector(".bookmark__img");this.image?(this.isFolder?e.className="bookmark__img bookmark__img--contain":(e.className="bookmark__img",e.classList.toggle("bookmark__img--contain",this.isCustomImage)),e.style.backgroundImage=`url('${this.image}')`):this.isFolder?(e.className="bookmark__img bookmark__img--folder",e.style.backgroundImage=""):this.#p()}"href"===e&&this.hasTitle&&!this.isFolder&&(this.image||this.#p(),this.#f())}}#b(){if(this.#h){return`<div class="bookmark__summary-folder">${this.#d.map((e=>{if(e.image)return`<div class="bookmark__img bookmark__img--contain bookmark__img--children" style="background-image: url(${e.image})"></div>`;return`<div class="bookmark__img bookmark__img--logo bookmark__img--children" style="background-image: url('${this.#g(e.url)}')"></div>`})).join("")}</div>`}return'<div class="bookmark__img bookmark__img--folder"></div>'}#v(){this.classList.add("bookmark","bookmark--folder"),this.innerHTML=`<div class="bookmark__wrap">\n      <button type="button" class="bookmark__action" aria-label="${browser.i18n.getMessage("bookmark_context")}"></button>\n      ${this.hasFolderPreview?this.#b():this.image?`<div\n                class="bookmark__img bookmark__img--contain"\n                style="background-image: url(${this.image})">\n              </div>`:'<div class="bookmark__img bookmark__img--folder"></div>'}\n      ${this.hasTitle?`<div class="bookmark__caption">\n              ${this.hasFavicon?'<img src="/img/folder.svg" class="bookmark__favicon" width="16" height="16" alt="">':""}\n              <span class="bookmark__title">${this.title}</span>\n            </div>`:""}\n      ${this.isDND?`<div class="dropzone-bookmark" data-id="${this.id}"></div>`:""}\n    </div>`}#_(){this.classList.add("bookmark"),this.openNewTab&&(this.setAttribute("target","_blank"),this.setAttribute("rel","noopener noreferrer"));const e=(this.image?this.isCustomImage&&" bookmark__img--contain":this.#u&&" bookmark__img--external")||"";this.innerHTML=`<div class="bookmark__wrap">\n        <button type="button" class="bookmark__action" aria-label="${browser.i18n.getMessage("bookmark_context")}"></button>\n        ${this.image?`<div class="bookmark__img${e}" style="background-image: url('${this.image}');"></div>`:`<div class="bookmark__img bookmark__img--logo${e}" style="background-image: url('${this.#g(this.url)}')"></div>`}\n        ${this.hasTitle?`<div class="bookmark__caption">\n                ${this.hasFavicon?`<img class="bookmark__favicon" width="16" height="16" src="${this.faviconUrl}" alt="">`:""}\n                <span class="bookmark__title">${this.title}</span>\n              </div>`:""}\n      </div>`}#a(){this.isFolder?this.#v():this.#_()}#g(t){return this.#u?this.#u.replace("{{website}}",(0,e.UX)(t)):(0,e.s1)(t,32)}get serviceLogo(){return this.#u}set externalLogo(e){this.#u=e}get faviconUrl(){return(0,e.s1)(this.url)}get hasOverlay(){return this.hasAttribute("has-overlay")}set hasOverlay(e){e?this.setAttribute("has-overlay",""):this.removeAttribute("has-overlay")}get isFolder(){return this.hasAttribute("is-folder")}set isFolder(e){e?this.setAttribute("is-folder",""):this.removeAttribute("is-folder")}get id(){return this.getAttribute("data-id")}set id(e){e&&(this.setAttribute("id",`vb-${e}`),this.setAttribute("data-id",e))}get url(){return this.getAttribute("href")}set url(e){e&&this.setAttribute("href",e)}get title(){return this.getAttribute("title")||""}set title(e){e&&this.setAttribute("title",e)}get image(){return this.getAttribute("image")}set image(e){e?this.setAttribute("image",e):this.removeAttribute("image",e)}get isCustomImage(){return this.hasAttribute("is-custom-image")}set isCustomImage(e){e?this.setAttribute("is-custom-image",""):this.removeAttribute("is-custom-image")}get openNewTab(){return this.hasAttribute("open-newtab")}set openNewTab(e){e?this.setAttribute("open-newtab",""):this.removeAttribute("open-newtab")}get hasTitle(){return this.hasAttribute("has-title")}set hasTitle(e){e?this.setAttribute("has-title",""):this.removeAttribute("has-title")}get hasFavicon(){return this.hasAttribute("has-favicon")}set hasFavicon(e){e?this.setAttribute("has-favicon",""):this.removeAttribute("has-favicon")}get isDND(){return this.hasAttribute("is-dnd")}set isDND(e){e?this.setAttribute("is-dnd",""):this.removeAttribute("is-dnd")}get hasFolderPreview(){return this.hasAttribute("has-folder-preview")}set hasFolderPreview(e){e?this.setAttribute("has-folder-preview",""):this.removeAttribute("has-folder-preview")}get folderChidlren(){return this.#d}set folderChidlren(e){this.#d=e}}window.customElements.define("vb-bookmark",q,{extends:"a"});const Y=(()=>{const t=new Map,n=[],o=".dropzone-bookmark",r=document.getElementById("bookmarks"),a=document.getElementById("dial_loading");let s=!1;function l(){[...r.querySelectorAll(".is-activate")].forEach((e=>e.classList.remove("is-activate")))}function c(t){t.sortInstance=b.ZP.create(t,{group:{name:"shared",pull:"clone"},animation:200,fallbackOnBody:!0,filter:".bookmark__action",draggable:".bookmark",removeCloneOnHide:!1,ghostClass:"bookmark--ghost",chosenClass:"bookmark--chosen",preventOnFilter:!1,onStart(e){if(r.classList.add("has-dragging"),localStorage.disabledSort)return!1;var t;t=e.item,[...r.querySelectorAll(o)].forEach((e=>{(e.closest(".bookmark")||e.closest(".bookmark-btn--back")).dataset.id!==t.dataset.id&&e.classList.add("is-activate")}))},onEnd(e){r.classList.remove("has-dragging"),e.pullMode||l()},onMove:({to:e,related:t})=>!localStorage.disabledSort&&(r.querySelector(".has-highlight")?.classList.remove("has-highlight"),e.matches(o)&&e.classList.add("has-highlight"),!t.classList.contains("bookmark-btn")&&void 0),onAdd({item:t,clone:n,target:o}){const i=t.dataset.id,r={parentId:o.dataset.id,...f.X.$.move_to_start&&{index:0}};t.style.transformOrigin="center bottom",t.animate([{opacity:1,transform:"scale3d(0.475, 0.475, 0.475) translate3d(0, -20px, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)",offset:.4},{opacity:0,transform:"scale3d(0.1, 0.1, 0.1) translate3d(0, 100px, 0)",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}],550).onfinish=()=>{n.remove(),t.remove(),l(),(0,j.pB)(i,r).then((()=>{t.hasAttribute("is-folder")&&(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}})}))}},onUpdate(){Array.from(r.querySelectorAll(".bookmark")).forEach((async(e,t)=>{await(0,j.pB)(e.getAttribute("data-id"),{parentId:r.dataset.folder,index:t}).catch(console.warn)}))}})}function u(){let e=String(f.X.$.default_folder_id);return""!==window.location.hash&&(e=window.location.hash.slice(1)),e}function h(n){let o,i=!1;const r=t.get(n.id);r&&(o=r.blobUrl,i=r.custom);const a=document.createElement("a",{is:"vb-bookmark"});return Object.assign(a,{id:n.id,url:n.url,title:(0,e.gw)(n.title),parentId:n.parentId,image:o,isCustomImage:i,externalLogo:f.X.$.logo_external?f.X.$.logo_external_url:null,openNewTab:f.X.$.open_link_newtab,hasTitle:f.X.$.show_bookmark_title,hasFavicon:f.X.$.show_favicon}),a}function m(n){let o;const i=f.X.$.folder_preview;if(!i){const e=t.get(n.id);o=e?.blobUrl}const r=document.createElement("a",{is:"vb-bookmark"});return Object.assign(r,{id:n.id,url:`#${n.id}`,parentId:n.parentId,title:(0,e.gw)(n.title),isFolder:!0,hasFolderPreview:i,folderChidlren:i?p(n):[],externalLogo:f.X.$.logo_external,image:o,openNewTab:f.X.$.open_link_newtab,hasTitle:f.X.$.show_bookmark_title,hasFavicon:f.X.$.show_favicon,isDND:f.X.$.drag_and_drop}),r}function p(e){const n=t.get(e.id);return n?.children?n.children.map((e=>({...e,image:e.blobUrl}))):[]}async function g(n,i=!1){a.hidden=!1,function(){if(r.firstChild)for(;r.firstChild;)r.firstChild.remove()}();const s=n.map((e=>e.id));let l;const c=[X.getAllByIds(s)];if(f.X.$.folder_preview){l=function(t){return t.reduce(((t,n)=>{if(n.children){const o=(0,e.OK)(n.children);t.push(...o.reduce(((e,t)=>(t.children||e.push(t),e)),[]).slice(0,4))}return t}),[])}(n);const t=l.map((e=>e.id));c.push(X.getAllByIds(t))}const[d,u]=await Promise.all(c);t.clear(),d.forEach((e=>{e.blobUrl=URL.createObjectURL(e.blob),t.set(e.id,e)})),f.X.$.folder_preview&&function(e,n){const o=n.reduce(((t,n)=>{let o=e.find((e=>e.id===n.id));return o?.blob?o.blobUrl=URL.createObjectURL(o.blob):o={id:n.id,url:n.url},Array.isArray(t?.[n.parentId])||(t[n.parentId]=[]),t[n.parentId].push(o),t}),{});Object.keys(o).forEach((e=>{t.set(e,{id:e,children:o[e]})}))}(u,l),f.X.$.sort_by_date&&n.sort(((e,t)=>t.dateAdded-e.dateAdded)),"folders_top"===f.X.$.bookmarks_sorting_type?n.sort(((e,t)=>Object.hasOwn(t,"children")-Object.hasOwn(e,"children"))):"folders_bottom"===f.X.$.bookmarks_sorting_type&&n.sort(((e,t)=>Object.hasOwn(e,"children")-Object.hasOwn(t,"children")));const p=document.createDocumentFragment();for(let e of n)e.url?p.appendChild(h(e)):p.appendChild(m(e));r.appendChild(p);""!==window.location.hash&&r.dataset?.parentFolder&&f.X.$.show_back_column&&r.prepend((0,e.xX)("button",{id:"bookmark-back",class:"bookmark-btn bookmark-btn--back md-ripple","aria-label":browser.i18n.getMessage("parent_folder")},(0,e.xX)("span",{class:o.replace(".",""),"data-id":r.dataset?.parentFolder}))),i&&r.append((0,e.xX)("button",{id:"add",class:"bookmark-btn bookmark-btn--create md-ripple","data-create":"New","aria-label":browser.i18n.getMessage("new_bookmark")})),a.hidden=!0}function v(e){return f.X.$.drag_and_drop&&r.sortInstance?.options?.disabled&&r.sortInstance?.option("disabled",!1),(0,j.Pb)(e).then((t=>{if(!t[0].children)throw new Error("not_folder");return r.setAttribute("data-folder",e),t[0].parentId&&!d.AL.includes(t[0].parentId)?r.setAttribute("data-parent-folder",t[0].parentId):r.removeAttribute("data-parent-folder"),g(t[0].children,f.X.$.show_create_column)})).catch((()=>{_.show(browser.i18n.getMessage("notice_cant_find_id")),r.innerHTML=`<div class="not-found">\n              <div class="not-found__wrap">\n                <div class="not-found__icon"></div>\n                <div class="not-found__text">\n                  ${browser.i18n.getMessage("not_found_text")}\n                </div>\n                <a class="btn md-ripple" href="#1">${browser.i18n.getMessage("not_found_link_text")}</a>\n              </div>\n            </div>`}))}async function w(){const e=await async function({permissions:e,origins:t}){return await browser.permissions.request({permissions:e,origins:t})}({origins:["<all_urls>"]});if(!e){const e=browser.i18n.getMessage("notice_host_permissions")+`<br><br><button class="btn btn--primary md-ripple" data-permissions-info>${browser.i18n.getMessage("learn_more")}</button>`;_.show({message:e,delay:7e3})}return e}async function y(n,o){const i=function(t){const n=browser.i18n.getMessage("thumbnails_creation",['<strong id="progress-text">0</strong>',t]);return(0,e.xX)("div",{class:"progress-toast"},{html:`<div class="progress-toast__icon">${d.LZ}</div><div class="progress-toast__text">${n}</div>`})}(n.filter((e=>!e.isFolder)).length);document.body.append(i);const a=i.animate([{transform:"translate3D(-100%, 0, 0)"},{transform:"translate3D(0, 0, 0)"}],{duration:200,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"forwards"}),l=document.getElementById("progress-text");s=!0,(0,e.g9)("thumbnails:updating",r);for(const[e,o]of n.entries()){l.textContent=e+1;if((await k(o.url,o.id)).warning)continue;const n=await X.get(o.id),i=URL.createObjectURL(n.blob),r=t.get(o.id);r&&URL.revokeObjectURL(r.blobUrl),t.set(o.id,{...n,blobUrl:i});try{document.getElementById(`vb-${o.id}`).image=i}catch(e){}}s=!1,o&&(0,e.VU)(browser.i18n.getMessage("notice_thumbnails_update_complete")),(0,e.g9)("thumbnails:updated",r),a.reverse(),a.onfinish=()=>{i.remove()}}function k(e,t){return new Promise((n=>{browser.runtime.sendMessage({capture:{id:t,captureUrl:e}},(e=>{e.warning&&console.warn(e.warning),n(e)}))}))}async function E(){const e=n[0];if(!(await k(e.url,e.id,e.parentId)).warning){const n=await X.get(e.id),o=t.get(e.id);o&&URL.revokeObjectURL(o.blobUrl),e.isCustomImage=!1,e.image=URL.createObjectURL(n.blob),t.set(e.id,{...n,blobUrl:e.image})}e.hasOverlay=!1,n.shift(),n.length&&await E()}async function x(e,n=!1){const o=[e];if(n){const t=await(0,j.Pb)(e),n=(0,j.pk)(t[0].children,!0).map((({id:e})=>e));o.push(...n)}const i=t.get(e);return i&&URL.revokeObjectURL(i.blobUrl),t.delete(e),Promise.all(o.map((e=>X.delete(e))))}return{init:async function(){if(P.t.local.set({screen:{availWidth:window.screen.availWidth,availHeight:window.screen.availHeight}}),f.X.$.vertical_center&&r.classList.add("grid--vcenter"),f.X.$.drag_and_drop&&!f.X.$.sort_by_newest&&(new MutationObserver((e=>{for(let t of e){for(let e of t.addedNodes){if(!(e instanceof HTMLElement))continue;const t=e.querySelector(o);t&&c(t)}for(let e of t.removedNodes){if(!(e instanceof HTMLElement))continue;const t=e.querySelector(o);t&&(t.sortInstance?.destroy(),delete t.sortInstance)}}})).observe(r,{childList:!0}),c(r)),f.X.$.show_toolbar){await i.e(971).then(i.bind(i,146));const t=document.createElement("vb-header");t.setAttribute("placeholder",browser.i18n.getMessage("placeholder_input_search")),t.setAttribute("initial-folder-id",f.X.$.default_folder_id),t.setAttribute("folder-id",u()),document.querySelector("header").append(t);let n=!1;const o=(0,e.sW)((({detail:e})=>{const t=e.search.trim();!t.length&&n?(n=!1,v(u())):(n=!0,function(e){(0,j.yC)(e).then((e=>{e.length>0?(f.X.$.drag_and_drop&&r.sortInstance?.option("disabled",!0),g(e)):r.innerHTML=`<div class="empty-search">🙁 ${browser.i18n.getMessage("empty_search")}</div>`}))}(t)),document.body.classList.toggle("has-search",n)}),500),a=()=>{n=!1,v(u()),document.body.classList.remove("has-search")};t.addEventListener("vb:search",o),t.addEventListener("vb:searchreset",a)}return window.addEventListener("hashchange",(async function(){const t=u();await v(t),(0,e.g9)("changeFolder",r,{detail:{folderId:t},bubbles:!0})}),!1),document.addEventListener("bookmark-removed",(({detail:e})=>{if(!document.getElementById(`vb-${e.id}`)){URL.revokeObjectURL(e.image);const n=t.get(e.id);n&&(n.children&&n.children.forEach((e=>{e.blobUrl&&URL.revokeObjectURL(e.blobUrl)})),t.delete(e.id))}})),v(u())},createBookmark:function(t,n){const o=r.getAttribute("data-folder");return(0,j.Ue)({title:t,...n&&{url:n},parentId:o}).then((t=>{let n;return n=t.url?h(t):m(t),r.querySelector(".bookmark-btn--create").insertAdjacentElement("beforeBegin",n),t.url||(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}}),n}))},updateBookmark:async function(t,n,o,i){const r=document.getElementById(`vb-${t}`),a=await(0,j.Vx)(t,{title:n,...o&&{url:o}});if(i!==t&&i!==a.parentId){const n={parentId:i,...f.X.$.move_to_start&&{index:0}};(0,j.pB)(t,n).then((()=>{a.url||(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}}),r.remove()}))}else a.url||(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}}),r.title=a.title,r.url=a.url?a.url:`#${a.id}`;return _.show(browser.i18n.getMessage("notice_bookmark_updated")),r},removeFromBrowser:async function(t,n){const o=n?t.id:t.dataset.id;x(o,n),await(n?(0,j.On)(o):(0,j.Od)(o)),t.remove(),n&&(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}})},removeBookmark:async function(e){if(!f.X.$.without_confirmation){if(!await H(browser.i18n.getMessage("confirm_delete_bookmark")))return}const t=e.dataset.id;(0,j.Od)(t).then((()=>{e.remove(),x(t),_.show(browser.i18n.getMessage("notice_bookmark_removed"))}))},removeFolder:async function(t){if(!f.X.$.without_confirmation){if(!await H(browser.i18n.getMessage("confirm_delete_folder")))return}const{id:n}=t;x(n,!0),(0,j.On)(n).then((()=>{t.remove(),(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}}),_.show(browser.i18n.getMessage("notice_folder_removed"))}))},createScreen:async function(e,t=!1){let o=t;try{o=await w()}catch(e){}o&&e&&(e.hasOverlay=!0,n.push(e),1===n.length&&E())},uploadScreen:async function(n,o,i){n.hasOverlay=!0;const{id:r}=n,a=await(0,e.dl)(o),s=URL.createObjectURL(a),l=t.get(r);X.update({id:r,blob:a,custom:!0}),l&&URL.revokeObjectURL(l.blobUrl),t.set(r,{id:r,blob:a,blobUrl:s,custom:!0,...l?.children&&{children:l.children}}),f.X.$.folder_preview&&!i||(n.isCustomImage=!0,n.image=s),n.hasOverlay=!1,_.show(browser.i18n.getMessage("notice_thumb_image_updated"))},removeThumbnail:x,autoUpdateThumb:function(){if(s)return;const e=u();(0,j.Pb)(e).then((e=>{const t=f.X.$.thumbnails_update_recursive?(0,j.pk)(e[0].children):e[0].children.filter((e=>e.url));f.X.$.sort_by_newest&&t.sort(((e,t)=>t.dateAdded-e.dateAdded)),y(t)}))},updateSelectedThumbnails:async function(e){const t=[];for(let n of e)if(n.isFolder){const e=await(0,j.Pb)(n.id);if(f.X.$.thumbnails_update_recursive)t.push(...(0,j.pk)(e));else{const n=e[0].children.filter((e=>e.url));t.push(...n)}}else t.push(n);y(t)},moveSelectedBookmarks:async function(t,n){const o=e=>e.some((e=>!!e.children&&(e.id===n||o(e.children)))),i=[...t];for(let e=0;e<i.length;e++){const t=i[e];if(t.isFolder){const n=await(0,j.Pb)(t.id);if(o(n)){i.splice(e,1);break}}}const r=i.map((t=>(0,j.pB)(t.id,{parentId:n,...f.X.$.move_to_start&&{index:0}}).then((()=>{t.url||(0,e.g9)("updateFolderList",document,{detail:{isFolder:!0}}),t.remove()}))));return Promise.all(r)},checkHostPermissions:w}})(),W=Y;var z=i(301);const V={userStyles(){const e=f.X.$.custom_style;if(!e)return;const t=document.createElement("style");t.appendChild(document.createTextNode(e)),document.head.appendChild(t)},async setBG(){const t=document.getElementById("bg"),n=f.X.$.background_image;if(!["background_local","background_external"].includes(n))return;let o,i=!1;if("background_local"===n){const e=await X.get("background");e?.blob&&(o=URL.createObjectURL(e.blob),i=e.blob.type.startsWith("video"))}else o=f.X.$.background_external;if(o&&o&&""!==o)if(i){const n=(0,e.xX)("video",{src:o});n.muted=!0,n.loop=!0,n.autoplay=!0,t.append(n),n.addEventListener("canplay",(()=>{t.style.opacity=1,document.body.classList.add("has-image")}),{once:!0})}else t.style.backgroundImage=`url('${o}')`,(0,e.xy)(o).then((()=>{"background_local"===n&&URL.revokeObjectURL(o),document.body.classList.add("has-image")})).catch((e=>{console.warn(`Local background image resource problem: ${e}`)})).finally((()=>{t.style.opacity=1}))},calculateStyles(){const e=document.documentElement,t=document.getElementById("bookmarks"),n=parseInt(window.getComputedStyle(e).getPropertyValue("--grid-gap")),o=parseInt(f.X.$.dial_columns),i=parseInt(f.X.$.dial_width);if(e.style.setProperty("--container-width",`${i}%`),(f.X.$.show_settings_icon||f.X.$.thumbnails_update_button||f.X.$.services_enable)&&i>=95){const t=parseInt(window.getComputedStyle(e).getPropertyValue("--circ-btn-size")),n=`${t+20}px ${t+30}px`;e.style.setProperty("--container-padding-inline",n)}const r=Math.floor((t.offsetWidth-(o-1)*n)/o);e.style.setProperty("--grid-columns",r<80?"":o)}},K=function(){let e,t={},n=!1;function o(e,t){if(1!==t.which)return!0;const n=t.composedPath()[0].closest(e);if(!n)return;const o=getComputedStyle(n).position;n.classList.add("ripple-container"),"fixed"!==o&&"absolute"!==o&&(n.style.position="relative");const r=n.getAttribute("data-ripple-color")||"rgba(0,0,0, .3)",a=n.hasAttribute("data-ripple-center"),{width:s,height:l,left:c,top:d}=n.getBoundingClientRect();let u=t.clientX-c,h=t.clientY-d;const m=Math.max(s,l),p=m/2,g=function(e){const t=Object.assign(document.createElement("span"),{className:"ripple"});return e.appendChild(t),e.removeEventListener("mouseleave",i),e.removeEventListener("mouseup",i),e.removeEventListener("dragend",i),e.addEventListener("mouseleave",i),e.addEventListener("mouseup",i),e.addEventListener("dragend",i),t}(n);let f=`\n      top: ${a?"50%":h-p+"px"};\n      left: ${a?"50%":u-p+"px"};\n      width: ${m}px;\n      height: ${m}px;\n      background-color: ${r};\n    `;a&&(f+=`\n        margin-top: ${-p}px;\n        margin-left: ${-p}px;\n      `),g.setAttribute("style",f),setTimeout((()=>{g.style.cssText+="transform: scale(2.5); opacity: 0.5"}),10)}function i(){const e=this;if(!e)return;let t=null;const n=e.getElementsByClassName("ripple");if(!(n.length>0))return!1;t=n[n.length-1];const o=getComputedStyle(t)["transition-duration"],i=1e3*parseFloat(o);setTimeout((()=>{t.style.opacity=0,setTimeout((()=>{try{e.removeChild(t)}catch(e){return!1}n.length<1&&(e.style.position="")}),i)}),0)}return t.init=function(t){if(!n){if("string"!=typeof t)throw new Error("Selector must be a string");e=o.bind(null,t),document.body.addEventListener("mousedown",e),n=!0}},t.destroy=function(){n&&(document.body.removeEventListener("mousedown",e),e=null,n=!1)},t}(),G=K,Z=document.getElementById("bookmarks"),J=document.getElementById("modal"),Q=document.getElementById("formBookmark"),ee=document.getElementById("modalHead"),te=document.getElementById("modalSelectFolders"),ne=document.getElementById("title"),oe=document.getElementById("url"),ie=document.getElementById("urlWrap"),re=document.getElementById("customScreen"),ae=document.getElementById("context-menu"),se=document.getElementById("upload"),le=document.getElementById("aside_controls"),ce={tween:null,tweenActive:!1};let de,ue=[],he=null,me=!1,pe=null;function ge(t){if(me)return;const n=t.target.closest(".bookmark");if(!n)return!0;if(!t.shiftKey)return!0;t.preventDefault();let o=[];const i=n.hasAttribute("data-selected");if(t.ctrlKey||t.metaKey){const e=Array.from(document.querySelectorAll(".bookmark")),t=e.findIndex((e=>e===n)),i=e.findIndex((e=>e===(he??n)));o=e.slice(Math.min(t,i),Math.max(t,i)+1)}else o=[n];o.forEach((e=>{i?(e.removeAttribute("data-selected"),ue=ue.filter((t=>t!==e))):(e.setAttribute("data-selected",""),!ue.includes(e)&&ue.push(e))})),ue.length?(he=n,async function(){if(document.getElementById("bookmarks-panel"))return;const t=(0,e.xX)("vb-bookmarks-panel",{id:"bookmarks-panel",class:"bookmarks-panel"});t.selectedFolder=window.location.hash.slice(1)||f.X.$.default_folder_id,t.folders=await(0,j.xh)(),document.body.append(t),localStorage.setItem("disabledSort",1),ce.tweenActive=!0,ce.tween=t.animate([{transform:"translate3D(0, 100%, 0)"},{transform:"translate3D(0, 0, 0)"}],{duration:200,easing:"cubic-bezier(0.4, 0, 0.2, 1)",fill:"forwards"})}()):(he=null,fe())}function fe(){document.getElementById("bookmarks-panel")&&(he=null,ce.tweenActive&&(ue.forEach((e=>delete e.dataset.selected)),ue.length=0,localStorage.removeItem("disabledSort"),ce.tween.playbackRate=-1,ce.tween.onfinish=()=>{ce.tweenActive=!1,document.getElementById("bookmarks-panel")?.remove()}))}function be(t){const{action:n,destFolder:o}=t.detail;if(n)switch(n){case"open_all":case"open_all_window":case"new_window_incognito":!function(t,n){["open_all_window","new_window_incognito"].includes(n)?browser.windows.create({focused:!0,state:"maximized",incognito:"new_window_incognito"===n},(n=>{if(!n)return(0,e.VU)(browser.i18n.getMessage("incognito_access_note"));t.forEach((e=>{Ie(e.url,{windowId:n.id})}))})):"open_all"===n&&t.forEach((e=>{Ie(e.url)}))}(ue,n);break;case"remove":!async function(e){if(!f.X.$.without_confirmation){if(!await H(browser.i18n.getMessage("confirm_delete_selected_bookmarks")))return}await Promise.all(e.map((e=>W.removeFromBrowser(e,e.isFolder)))),fe()}(ue);break;case"update_thumbnails":!async function(e){if(!await W.checkHostPermissions())return;await W.updateSelectedThumbnails(e),fe()}(ue);break;case"move_bookmarks":!async function(e,t){await W.moveSelectedBookmarks(e,t),fe()}(ue,o)}}async function ve(){const{extension_updated:e}=await P.t.local.get("extension_updated");if(e){const e=browser.i18n.getMessage("extension_updated_notification"),t=browser.i18n.getMessage("whats_new");_.show({message:`${e}.&nbsp;&nbsp;<a href="/options.html#changelog">${t}</a>`,delay:0,onClose(){P.t.local.remove("extension_updated")}})}}function _e(){ae.close(),de.close()}function we(e){if(null!==localStorage.getItem("update_thumbnails")&&me)return e.returnValue="Are you shure?"}function ye(){me&&localStorage.removeItem("update_thumbnails"),localStorage.removeItem("disabledSort")}function ke(e){"update_thumbnails"===e.key&&(pe.disabled=!!e.newValue)}async function Ee(){await W.checkHostPermissions()&&(this.hasAttribute("disabled")||null!==localStorage.getItem("update_thumbnails")||W.autoUpdateThumb())}function xe(e){if(e.target.closest("#bookmark-back"))e.preventDefault(),window.location.hash=Z.dataset.parentFolder;else if(e.target.closest("#add"))e.preventDefault(),Ne(),de.open();else if(e.target.closest(".bookmark__action"))e.preventDefault(),e.stopPropagation(),ae.trigger(e);else if(e.target.closest(".bookmark")){const t=e.target.closest(".bookmark").href;Se(t)&&!e.shiftKey&&(e.preventDefault(),Le(t))}}function Ce(e){if(e.target.closest(".bookmark")&&1===e.button){const t=e.target.closest(".bookmark").href;Se(t)&&(e.preventDefault(),Le(t))}}function Se(e){return d.hY.some((t=>e.startsWith(t)))}function Le(e){(f.X.$.open_link_newtab?browser.tabs.create:browser.tabs.update)({url:e})}async function Te(t){let n;fe(),n=t.detail.isFolder?d.Km.filter((e=>!e.isBookmark)):d.Km.filter((e=>!e.isFolder)),t.detail.image||(n=n.filter((e=>"delete_thumbnail"!==e.action))),ae.listItems=n;const o=ae.querySelector('[data-action="paste_image"]');if(o){const t=await U({permissions:["clipboardRead"]});o.classList.toggle("is-disabled",!t||!await(0,e.ol)())}}async function Ae(t){const n=t.detail.trigger,o=t.detail.selection;switch(o){case"new_window":case"new_window_incognito":!function(e,t){try{browser.windows.create({url:e,state:"maximized",incognito:"new_window_incognito"===t})}catch(e){}}(n.href,o);break;case"open_all":case"open_all_window":!function(e,t){(0,j.G)(e).then((e=>{"open_all_window"===t?browser.windows.create({focused:!0},(t=>{e.forEach((e=>{Ie(e.url??e.id,{windowId:t.id})}))})):e.forEach((e=>{Ie(e.url??e.id)}))}))}(n.id,o);break;case"new_tab":Ie(n.href);break;case"edit":Ne(n),de.open();break;case"copy_link":(0,e.jq)(n.href),_.show(browser.i18n.getMessage("notice_link_copied"));break;case"capture":W.createScreen(n);break;case"upload":delete se.dataset.site,se.dataset.id=n.id,n.isFolder||(se.dataset.site=(0,e.UX)(n.href)),se.click();break;case"paste_image":if(!await U({permissions:["clipboardRead"]}))return;!async function(t){try{const[n]=await navigator.clipboard.read(),o=n.types.find((e=>e.startsWith("image/")));if(!o)return;const i=await n.getType(o),r=(0,e.UX)(t.href);W.uploadScreen(t,i,r)}catch(e){console.error(e.name,e.message)}}(n);break;case"delete_thumbnail":W.removeThumbnail(n.id).then((()=>{n.image=null}));break;case"remove":n.isFolder?W.removeFolder(n):W.removeBookmark(n)}}async function De(e){e.preventDefault();const t=e.target,n=t.files[0],{id:o,site:i}=t.dataset,r=document.getElementById(`vb-${o}`);if(!r)return;t.value="";const a=new Blob([new Uint8Array(await n.arrayBuffer())],{type:n.type});W.uploadScreen(r,a,i)}function Oe(){J.classList.remove("has-edit","has-add"),re.style.display="",Q.reset()}function Ie(e,t={}){e.startsWith("#")&&(e=`newtab.html${e}`);const n={url:e,active:!1};try{browser.tabs.create({...n,...t})}catch(e){}}async function Me(e){e.preventDefault();const t=e.target,n=t.getAttribute("data-action"),o=t.title.value,i=t.url.value;let r=!1,a=!1;if(i&&f.X.$.auto_generate_thumbnail&&(a=await W.checkHostPermissions()),"New"!==n){const e=te.value;r=await W.updateBookmark(n,o,i,e)}else r=await W.createBookmark(o,i);i&&a&&r&&f.X.$.auto_generate_thumbnail&&W.createScreen(r,a),r&&de.close()}function Be(e){return e[0]?.el?.focus()}async function $e(e){if(!f.X.$.without_confirmation){if(!await H(browser.i18n.getMessage("confirm_delete_image")))return}e.preventDefault();const t=this.getAttribute("data-bookmark");W.removeThumbnail(t).then((()=>{document.getElementById(`vb-${t}`).image=null,this.closest("#customScreen").style.display=""}))}async function Ne(t){if(t){J.classList.add("has-edit");const n=await(0,j.U2)(t.id).catch((e=>console.warn(e)));if(!n)return;const{id:o,url:i,parentId:r}=n[0],a=(0,e.bl)(n[0].title),s=await X.get(o);if(te.setAttribute("parent-folder-id",r),te.setAttribute("bookmark-id",o),te.folders=await(0,j.xh)(),s){const e=URL.createObjectURL(s.blob),t=re.querySelector("img");re.style.display="block",t.onload=()=>{URL.revokeObjectURL(e)},t.src=e,re.querySelector("#resetCustomImage").setAttribute("data-bookmark",o)}ee.textContent=browser.i18n.getMessage("edit_bookmark"),ne.value=a,i?(ie.style.display="",oe.value=i):ie.style.display="none",Q.setAttribute("data-action",o)}else J.classList.add("has-add"),ee.textContent=browser.i18n.getMessage("add_bookmark"),ie.style.display="",ne.value="",oe.value="",Q.setAttribute("data-action","New")}!async function(){document.documentElement.setAttribute("lang",browser.i18n.getMessage("@@ui_locale").replace("_","-")),window.addEventListener("resize",(()=>V.calculateStyles())),window.addEventListener("popstate",_e),window.addEventListener("beforeunload",we),window.addEventListener("unload",ye),window.addEventListener("storage",ke),window.addEventListener("load",ve),window.addEventListener("hashchange",fe),await f.X.init(),V.userStyles(),V.calculateStyles(),V.setBG(),(0,z.Z)(),G.init(".md-ripple"),W.init().then((()=>{f.X.$.enable_virtual_pagination&&(0,e.Zb)((()=>i.e(211).then(i.bind(i,60)))).then((()=>{document.body.insertAdjacentElement("beforeEnd",(0,e.xX)("vb-virtual-pagination",{"scrollable-selector":".app"}))}))})),de=new(m())(J,{stickySelectors:[".sticky"],closeBackdrop:!1}),de.element.addEventListener("gmodal:beforeopen",(()=>{Q.reset()})),de.element.addEventListener("gmodal:open",(()=>{"New"===Q.getAttribute("data-action")?Q.elements.title.focus():Q.elements.title.select()}));const t=new(m())("#modal-host-permissions",{stickySelectors:[".sticky"],closeBackdrop:!1}),n=document.getElementById("formBookmark");g().i18n={required:browser.i18n.getMessage("error_input_required")},g().run(n,{showErrors:!0,checkChange:!0,checkInput:!0,containerSelector:".group",errorClass:"has-error",errorHintClass:"error-hint",validators:{regex:{isValidUrl:{pattern:d.Yq,error:browser.i18n.getMessage("error_input_url")}}},onSuccess:Me,onError:Be}),f.X.$.services_enable&&i.e(192).then(i.bind(i,104)).then((()=>{const e=document.createElement("vb-services");e.classList.add("sticky"),e.servicesList=f.X.$.services_list,document.body.append(e),e.addEventListener("update",(e=>{f.X.updateKey("services_list",e.detail.services)}))})).catch((e=>{console.warn(e)})),se.addEventListener("change",De),Z.addEventListener("click",xe),Z.addEventListener("mousedown",Ce),ae.addEventListener("vb:contextmenu:select",Ae),ae.addEventListener("vb:contextmenu:open",Te),document.getElementById("resetCustomImage").addEventListener("click",$e),J.addEventListener("gmodal:close",Oe),f.X.$.show_settings_icon&&le.append((0,e.xX)("a",{id:"settings_icon",class:"circ-btn settings-link",ariaLabel:browser.i18n.getMessage("options"),href:"options.html"},{html:'<svg width="20" height="20"><use xlink:href="/img/symbol.svg#settings"/></svg>'})),document.getElementById("aside_controls").insertAdjacentElement("afterend",(0,e.xX)("vb-scrollup",{class:"sticky","scroll-selector":".app"})),f.X.$.thumbnails_update_button&&(pe=(0,e.xX)("button",{class:"circ-btn update-thumbnails","aria-label":browser.i18n.getMessage("thumbnails_update")},{html:'<svg width="20" height="20"><use xlink:href="/img/symbol.svg#capture_fill"/></svg>'}),document.getElementById("aside_controls").appendChild(pe),"true"===localStorage.getItem("update_thumbnails")&&(pe.disabled=!0),Z.addEventListener("thumbnails:updating",(function(){me=!0,pe.disabled=!0,localStorage.setItem("update_thumbnails",!0)})),Z.addEventListener("thumbnails:updated",(function(){me=!1,pe.disabled=!1,localStorage.removeItem("update_thumbnails")})),pe.addEventListener("click",Ee)),browser.runtime.onMessage.addListener((function(e){e.bookmarksUpdated&&document.hidden&&window.location.reload()})),document.addEventListener("click",(e=>{e.target.closest("[data-permissions-info]")&&t.open()})),Z.addEventListener("click",ge),document.addEventListener("vb-bookmarks-panel:action",be),document.addEventListener("vb-bookmarks-panel:close",fe),document.addEventListener("vb:search",fe),document.addEventListener("vb:searchreset",fe),document.addEventListener("keydown",(({code:e})=>{"Escape"===e&&fe()}))}()})()})();