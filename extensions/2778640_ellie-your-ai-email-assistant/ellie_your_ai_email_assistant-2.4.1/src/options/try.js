function revise(){document.getElementById("submit-test").disabled=!0,document.getElementById("revise").disabled=!0;const e=document.getElementById("mood").value,t=document.getElementById("interest").value,n=document.getElementById("try-roles").value,s=document.getElementById("try-reply-length").value;let u=document.getElementById("test-input").value;const d=document.getElementById("test-result"),{selectionStart:l,selectionEnd:m}=d,o=d.value.substr(l,m),r={type:"submit-prompt",emailText:u,revisePart:{beginning:d.value.substr(0,l),ending:d.value.substr(m),startsAt:l,endsAt:m},revisingPartText:o,mood:e,interest:t,roleUuid:n,replyLength:s};chrome.runtime.sendMessage(r,(function(e){}))}function submit_test(){document.getElementById("submit-test").disabled=!0,document.getElementById("revise").disabled=!0,document.getElementById("test-result").value="Waiting...takes a few seconds...";const e=document.getElementById("test-input").value,t=document.getElementById("mood").value,n=document.getElementById("interest").value,s=document.getElementById("try-roles").value,u=document.getElementById("try-reply-length").value,d=document.getElementById("try-models").value,l={type:"stream-prompt",emailText:e,modelOverride:"auto"===d?null:d,mood:t,interest:n,roleUuid:s,replyLength:u};chrome.runtime.sendMessage(l,(function(e){}))}function writeOutput(e,{startsAt:t=0,endsAt:n}){const s=document.getElementById("test-result").value;if(t){const e=s.substr(0,t)+s.substr(n);document.getElementById("test-result").value=e}else document.getElementById("test-result").value="";const u=document.getElementById("test-result");let d=t,l=0;!function t(){const n=e[l++];void 0!==n&&(u.value=u.value.substr(0,d)+n+u.value.substr(d),d++,setTimeout(t,10))}()}chrome.runtime.onMessage.addListener((function(e){document.getElementById("submit-test").disabled=!1,document.getElementById("revise").disabled=!1;const t=document.getElementById("test-result");if(t.value=t.value.replace("Waiting...takes a few seconds...",""),"response-stream"===e.type)t.value+=e.text;else if("response"==e.type){document.getElementById("test-result");const{revisePart:t={}}=e;writeOutput(e.text,t)}})),document.getElementById("submit-test").addEventListener("click",submit_test),document.getElementById("revise").addEventListener("click",revise);