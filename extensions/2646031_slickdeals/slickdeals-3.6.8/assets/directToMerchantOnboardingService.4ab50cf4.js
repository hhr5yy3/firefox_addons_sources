var d=Object.defineProperty;var p=(a,e,t)=>e in a?d(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var n=(a,e,t)=>(p(a,typeof e!="symbol"?e+"":e,t),t);import{az as f,aH as h,ab as m,D as s}from"./popupInitializer.bb4281b7.js";const C="dtmDisabled",c=class{constructor(e,t){n(this,"directToMerchantOffRedirectCompleteListener",null);this.userOptionsService=e,this.tabService=t}static create(){var e;return c.instance=(e=c.instance)!=null?e:new this(f.create(),h.create()),c.instance}async turnOffDirectToMerchantOnboarding(e,t){var l;const i=(l=await this.tabService.get(t))==null?void 0:l.openerTabId;await this.userOptionsService.updateOptionByKey(m.FpDirectToMerchant,!1);const r=new URL(e);r.searchParams.set(C,"1"),r.searchParams.delete("exp"),i?await s.tabs.update(i,{url:`${r}`}).then(()=>{this.directToMerchantOffRedirectCompleteListener=this.directToMerchantOffRedirectCompleteCallback.bind(this,{directToMerchantOffTabId:t,openerTabId:i}),s.tabs.onUpdated.addListener(this.directToMerchantOffRedirectCompleteListener),setTimeout(this.resolveDirectToMerchantOffRedirectCompleteCallback,4e3)}):s.tabs.update({url:`${r}`})}directToMerchantOffRedirectCompleteCallback({directToMerchantOffTabId:e,openerTabId:t},i,r){i===t&&r.status==="complete"&&this.resolveDirectToMerchantOffRedirectCompleteCallback(e)}resolveDirectToMerchantOffRedirectCompleteCallback(e){this.directToMerchantOffRedirectCompleteListener&&(s.tabs.onUpdated.removeListener(this.directToMerchantOffRedirectCompleteListener),this.directToMerchantOffRedirectCompleteListener=null,s.tabs.remove(e))}};let o=c;n(o,"instance");export{C as D,o as a};
