/*! For license information please see script.js.LICENSE.txt */
(()=>{var e,t,n={4143:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function i(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,i,s,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new r(i,s||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,r=[];if(0===this._eventsCount)return r;for(i in e=this._events)t.call(e,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,r,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var c,u,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,i),!0;case 4:return l.fn.call(l.context,t,i,r),!0;case 5:return l.fn.call(l.context,t,i,r,s),!0;case 6:return l.fn.call(l.context,t,i,r,s,a),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var g,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,i);break;case 4:l[u].fn.call(l[u].context,t,i,r);break;default:if(!c)for(g=1,c=new Array(d-1);g<d;g++)c[g-1]=arguments[g];l[u].fn.apply(l[u].context,c)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||r&&!o.once||i&&o.context!==i||a(this,s);else{for(var c=0,u=[],l=o.length;c<l;c++)(o[c].fn!==t||r&&!o[c].once||i&&o[c].context!==i)&&u.push(o[c]);u.length?this._events[s]=1===u.length?u[0]:u:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},1024:(e,t)=>{t.L=function(e,t,n,i,r){var s,a,o=8*r-i-1,c=(1<<o)-1,u=c>>1,l=-7,d=n?r-1:0,g=n?-1:1,f=e[t+d];for(d+=g,s=f&(1<<-l)-1,f>>=-l,l+=o;l>0;s=256*s+e[t+d],d+=g,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=i;l>0;a=256*a+e[t+d],d+=g,l-=8);if(0===s)s=1-u;else{if(s===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),s-=u}return(f?-1:1)*a*Math.pow(2,s-i)},t.M=function(e,t,n,i,r,s){var a,o,c,u=8*s-r-1,l=(1<<u)-1,d=l>>1,g=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,m=i?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?g/c:g*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=l?(o=0,a=l):a+d>=1?(o=(t*c-1)*Math.pow(2,r),a+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,r),a=0));r>=8;e[n+f]=255&o,f+=m,o/=256,r-=8);for(a=a<<r|o,u+=r;u>0;e[n+f]=255&a,f+=m,a/=256,u-=8);e[n+f-m]|=128*p}},4534:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Support event pages",r="20210820184257_support_event_pages";async function s(){const e={taskRegistry:{lastTaskStart:0,tabs:{},tasks:{}},storageRegistry:{},lastStorageCleanup:0};return e.storageVersion=r,browser.storage.local.set(e)}},1670:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add image sharing options",r="20210919175209_add_image_sharing_options";async function s(){const e={shareImageContextMenu:!0,shareImageAction:!0,convertSharedImage:!0};return e.storageVersion=r,browser.storage.local.set(e)}},7867:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Unsplash",r="20210928090443_add_unsplash";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["unsplash"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},4016:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>r,revision:()=>s,upgrade:()=>a});var i=n(4729);const r="Configure engines",s="20211011114043_configure_engines";async function a(){const e={};if("safari"===i.Dm){const{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["iqdb","jpDesign"];e.engines=t.concat(i),e.disabledEngines=n.concat(i)}return e.storageVersion=s,browser.storage.local.set(e)}},405:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add SHEIN",r="20211106103932_add_shein";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["shein"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},2276:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add LykDat",r="20211111071410_add_lykdat";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["lykdat"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},8722:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Wildberries",r="20211204124507_add_wildberries";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["wildberries"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},4948:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add lastEngineAccessCheck",r="20211213014048_add_lastengineaccesscheck";async function s(){const e={lastEngineAccessCheck:0};return e.storageVersion=r,browser.storage.local.set(e)}},5959:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add setContextMenuEvent",r="20211213191049_add_setcontextmenuevent";async function s(){const e={setContextMenuEvent:0};return e.storageVersion=r,browser.storage.local.set(e)}},8322:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>s,revision:()=>a,upgrade:()=>o});var i=n(8618),r=n(4729);const s="Add Google Lens",a="20220108063511_add_google_lens";async function o(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);if("safari"!==r.Dm||!await(0,i.Fr)()){const i=["googleLens"];"samsung"===r.Dm&&(t.push("mailru"),n.push("mailru")),e.engines=t.concat(i),e.disabledEngines=n.concat(i)}return e.storageVersion=a,browser.storage.local.set(e)}},5013:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add clipboard support",r="20220321163741_add_clipboard_support";async function s(){const e={autoPasteAction:!0,confirmPaste:!0};return e.storageVersion=r,browser.storage.local.set(e)}},6730:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Detect alternative image sizes",r="20220505174634_detect_alternative_image_sizes";async function s(){const e={detectAltImageDimension:!1};return e.storageVersion=r,browser.storage.local.set(e)}},4784:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Update search mode IDs",r="20220516051842_update_search_mode_ids";async function s(){const e={},{searchModeContextMenu:t,searchModeAction:n}=await browser.storage.local.get(["searchModeContextMenu","searchModeAction"]),i={select:"selectUrl",selectUpload:"selectImage",upload:"browse"};return i[t]&&(e.searchModeContextMenu=i[t]),i[n]&&(e.searchModeAction=i[n]),e.storageVersion=r,browser.storage.local.set(e)}},314:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Open images",r="20220516124148_open_images";async function s(){const e={viewImageContextMenu:!0,viewImageAction:!0,viewImageUseViewer:!0};return e.storageVersion=r,browser.storage.local.set(e)}},388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>s,revision:()=>a,upgrade:()=>o});var i=n(8618),r=n(4729);const s="Configure engines",a="20220814142801_configure_engines";async function o(){const e={};if("safari"===r.Dm&&await(0,i.Fr)()){const{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["googleLens"];e.engines=t.concat(i),e.disabledEngines=n.concat(i)}return e.storageVersion=a,browser.storage.local.set(e)}},1745:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Lexica",r="20220924083846_add_lexica";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["lexica"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},9915:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>r,revision:()=>s,upgrade:()=>a});var i=n(8618);const r="Add theme support",s="20230415111029_add_theme_support";async function a(){const e={appTheme:"auto",showContribPage:!0,showEngineIcons:!0,contribPageLastAutoOpen:0,pinActionToolbarViewImage:!0,pinActionToolbarShareImage:!1,pinActionToolbarOptions:!1,pinActionToolbarContribute:!0},{installTime:t,searchCount:n}=await browser.storage.local.get(["installTime","searchCount"]);return e.installTime=(0,i.I4)(t),e.useCount=n,await browser.storage.local.remove(["searchCount","viewImageAction","shareImageAction"]),e.storageVersion=s,browser.storage.local.set(e)}},3797:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s}),n(9849),n(1167);const i="Remove search engines",r="20230531103023_remove_search_engines";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["jingdong","mailru"];return e.engines=t.filter((function(e){return!i.includes(e)})),e.disabledEngines=n.filter((function(e){return!i.includes(e)})),e.storageVersion=r,browser.storage.local.set(e)}},9524:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Kagi",r="20230601115626_add_kagi";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["kagi"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},6390:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add search engines",r="20230624145626_add_search_engines";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["haveibeentrained","enterpix","immerse","clipretrieval"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},6673:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Freepik",r="20230716121432_add_freepik";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["freepik"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},420:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s}),n(9849),n(1167);const i="Remove Unsplash",r="20231009185955_remove_unsplash";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["unsplash"];return e.engines=t.filter((function(e){return!i.includes(e)})),e.disabledEngines=n.filter((function(e){return!i.includes(e)})),e.storageVersion=r,browser.storage.local.set(e)}},9159:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Icons8",r="20231102164602_add_icons8";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["icons8"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},3159:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add appVersion",r="20240514170322_add_appversion";async function s(){const e={appVersion:"",menuItems:[],privateMenuItems:[]};return e.storageVersion=r,browser.storage.local.set(e)}},7021:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Update search engines",r="20240529183556_update_search_engines";async function s(e){const t={},{engines:n,disabledEngines:i}=await browser.storage.local.get(["engines","disabledEngines"]);return n.splice(0,0,n.splice(n.indexOf("googleLens"),1)[0]),i.includes("googleLens")&&!i.includes("google")&&i.splice(i.indexOf("googleLens"),1),e.install&&i.push("google"),t.engines=n,t.disabledEngines=i,t.storageVersion=r,browser.storage.local.set(t)}},38:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add menuChangeEvent",r="20240619180111_add_menuchangeevent";async function s(){const e={menuChangeEvent:0,privateMenuChangeEvent:0};return await browser.storage.local.remove("setContextMenuEvent"),e.storageVersion=r,browser.storage.local.set(e)}},7911:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s}),n(9849),n(1167);const i="Remove search engines",r="20240624161944_remove_search_engines";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["haveibeentrained","enterpix","immerse","clipretrieval"];return e.engines=t.filter((function(e){return!i.includes(e)})),e.disabledEngines=n.filter((function(e){return!i.includes(e)})),e.storageVersion=r,browser.storage.local.set(e)}},957:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Lenso.ai",r="20250102095603_add_lenso.ai";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i="lenso",s=t.length-n.length;return t.splice(1,0,i),e.engines=t,s<=1&&n.push(i),8!==s||n.includes("alamy")||n.push("alamy"),e.disabledEngines=n,e.storageVersion=r,browser.storage.local.set(e)}},1172:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add WhatAnime",r="BJXdcUXOG";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("whatanime"),e.disabledEngines=n.concat("whatanime"),e.storageVersion=r,browser.storage.local.set(e)}},9981:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add installTime and searchCount",r="BJguWEHcbz";async function s(){const e={};return e.installTime=Date.now(),e.searchCount=0,e.storageVersion=r,browser.storage.local.set(e)}},9925:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Merge searchAllEngines options",r="Bk42MzXdW";async function s(){const e={},{searchAllEngines:t,searchAllEnginesLocation:n}=await browser.storage.local.get(["searchAllEngines","searchAllEnginesLocation"]);return await browser.storage.local.remove(["searchAllEngines","searchAllEnginesLocation"]),e.searchAllEnginesContextMenu=t?"menu"===n?"main":"sub":"false",e.storageVersion=r,browser.storage.local.set(e)}},864:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add showInContextMenu, searchAllEnginesAction and searchModeAction options",r="HJ5MKKGhW";async function s(){const e={showInContextMenu:!0,searchAllEnginesAction:"sub",searchModeAction:"select"};return e.storageVersion=r,browser.storage.local.set(e)}},1999:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add imgFullParse option",r="Hy1tD8ANb";async function s(){const e={imgFullParse:!1};return e.storageVersion=r,browser.storage.local.set(e)}},897:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s}),n(9849),n(1167);const i="Hide unavailable engines",r="IMMjiccGj";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["wayfair","birchlane","allmodern","jossandmain","perigold"];return e.engines=t.filter((function(e){return!i.includes(e)})),e.disabledEngines=n.filter((function(e){return!i.includes(e)})),e.storageVersion=r,browser.storage.local.set(e)}},7636:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Reddit Repost Sleuth",r="K9Esw2jiQ3";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("repostSleuth"),e.disabledEngines=n.concat("repostSleuth"),e.storageVersion=r,browser.storage.local.set(e)}},935:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add trademark and design patent search engines",r="LX20x6G8l";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["esearch","tmview","branddb","madridMonitor","auTrademark","auDesign","nzTrademark","jpDesign"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},1353:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Iqdb",r="S18hLi5tG";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("iqdb"),e.disabledEngines=n.concat("iqdb"),e.storageVersion=r,browser.storage.local.set(e)}},521:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Karma Decay",r="S1ebtZ3Uzz";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("karmaDecay"),e.disabledEngines=n.concat("karmaDecay"),e.storageVersion=r,browser.storage.local.set(e)}},8488:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Sogou engine",r="S1kNNadHZ";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("sogou"),e.disabledEngines=n.concat("sogou"),e.storageVersion=r,browser.storage.local.set(e)}},397:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Ascii2d",r="SJzIWmjKz";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("ascii2d"),e.disabledEngines=n.concat("ascii2d"),e.storageVersion=r,browser.storage.local.set(e)}},3362:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Dreamstime, Alamy and 123RF",r="ShjDMM87";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["dreamstime","alamy","123rf"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},9811:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add SauceNAO",r="SklYTwQOYf";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("saucenao"),e.disabledEngines=n.concat("saucenao"),e.storageVersion=r,browser.storage.local.set(e)}},389:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Qihoo",r="SkwaU8NlX";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("qihoo"),e.disabledEngines=n.concat("qihoo"),e.storageVersion=r,browser.storage.local.set(e)}},2888:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Pinterest",r="Syy800KkQ";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("pinterest"),e.disabledEngines=n.concat("pinterest"),e.storageVersion=r,browser.storage.local.set(e)}},8302:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>s,revision:()=>a,upgrade:()=>o}),n(9849),n(1167);var i=n(8618),r=n(4729);const s="Configure search engines",a="TshBYj8anA";async function o(){const e={},{installTime:t}=await browser.storage.local.get("installTime");let{engines:n,disabledEngines:s}=await browser.storage.local.get(["engines","disabledEngines"]);const o=[];if("samsung"===r.Dm?(n.splice(n.indexOf("auDesign"),0,"auTrademark"),s.push("auTrademark","dreamstime")):"safari"===r.Dm&&o.push("iqdb","jpDesign"),(await(0,i.m0)()||"safari"===r.Dm)&&o.push("jingdong","taobao","alibabaChina"),o.length&&(n=n.filter((function(e){return!o.includes(e)})),s=s.filter((function(e){return!o.includes(e)}))),Date.now()-t<6e4){"samsung"===r.Dm&&s.push("dreamstime");const e=["sogou","shutterstock","alamy"];s=s.filter((function(t){return!e.includes(t)}))}return n.splice(n.indexOf("baidu")+1,0,n.splice(n.indexOf("sogou"),1)[0]),e.engines=n,e.disabledEngines=s,e.storageVersion=a,browser.storage.local.set(e)}},2230:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add bypassImageHostBlocking",r="UhWEtK9gMh";async function s(){const e={bypassImageHostBlocking:!0};return e.storageVersion=r,browser.storage.local.set(e)}},7164:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add PimEyes, Stocksy United, Pond5, PIXTA and Wayfair",r="d8CIdomCW";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["pimeyes","stocksy","pond5","pixta","wayfair"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},1075:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>r,revision:()=>s,upgrade:()=>a}),n(9849),n(1167);var i=n(4729);const r="Configure engines for Samsung Internet",s="d8IK4KCtVm";async function a(){const e={};if("samsung"===i.Dm){const{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["shutterstock","dreamstime"],r=["mailru","jingdong","taobao","alibabaChina","auTrademark"];e.engines=t.filter((function(e){return!r.includes(e)})),e.disabledEngines=n.filter((function(e){return!i.includes(e)&&!r.includes(e)}))}return e.storageVersion=s,browser.storage.local.set(e)}},2701:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Mail.ru",r="ekhOvNiTsF";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]);return e.engines=t.concat("mailru"),e.disabledEngines=n.concat("mailru"),e.storageVersion=r,browser.storage.local.set(e)}},6794:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add new search engines",r="ggrr9C9pgV";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["birchlane","allmodern","jossandmain","perigold","ikea"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},7462:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add stock photo engines",r="r1H3rgx1X";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["getty","istock","shutterstock","adobestock","depositphotos"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},8546:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add searchModeContextMenu",r="r1Pvd36nz";async function s(){const e={searchModeContextMenu:"select"};return e.storageVersion=r,browser.storage.local.set(e)}},7132:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add contribPageLastOpen",r="ryY8H0EWf";async function s(){const e={contribPageLastOpen:0};return e.storageVersion=r,browser.storage.local.set(e)}},4781:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Initial version",r="ryekyizAg";async function s(){const e={engines:["google","bing","yandex","baidu","tineye"],disabledEngines:[],searchAllEngines:!0,searchAllEnginesLocation:"submenu",tabInBackgound:!1,localGoogle:!0};return e.storageVersion=r,browser.storage.local.set(e)}},1233:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Add Jingdong, Taobao and Alibaba China",r="yLciyvS5He";async function s(){const e={},{engines:t,disabledEngines:n}=await browser.storage.local.get(["engines","disabledEngines"]),i=["jingdong","taobao","alibabaChina"];return e.engines=t.concat(i),e.disabledEngines=n.concat(i),e.storageVersion=r,browser.storage.local.set(e)}},211:(e,t,n)=>{"use strict";n.r(t),n.d(t,{message:()=>i,revision:()=>r,upgrade:()=>s});const i="Initial version",r="20240514122825_initial_version";async function s(){const e={platformInfo:null,menuChangeEvent:0,privateMenuChangeEvent:0,tabRevisions:[]};return e.storageVersion=r,browser.storage.session.set(e)}},786:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>g,Hu:()=>s,XL:()=>o,eK:()=>d});var i=n(8618),r=n(4729);async function s({area:e="local"}={}){try{return await browser.storage[e].get(""),!0}catch(e){return!1}}const a={local:!1,session:!1,sync:!1};async function o({area:e="local"}={}){if(a[e])return!0;{const{storageVersion:t}=await browser.storage[e].get("storageVersion");if(t&&t===r.QB[e])return a[e]=!0,!0}return!1}async function c({area:e="local"}={}){if(!a[e])return new Promise(((t,n)=>{let i;const r=async function(){await o({area:e})?(self.clearTimeout(s),t()):i?n(new Error(`Storage (${e}) is not ready`)):self.setTimeout(r,30)},s=self.setTimeout((function(){i=!0}),6e4);r()}))}function u(e,t,{encode:n=!0}={}){return n?`${t}${(0,i.Zr)(e)}`:(0,i.ag)(e.replace(new RegExp(`^${t}`),""))}function l(e,t,{encode:n=!0}={}){if("string"==typeof e)return u(e,t,{encode:n});if(Array.isArray(e)){const i=[];for(const r of e)i.push(u(r,t,{encode:n}));return i}{const i={};for(const[r,s]of Object.entries(e))i[u(r,t,{encode:n})]=s;return i}}function d(e,t){return t?.active?l(e,t.name,{encode:!0}):e}const g={get:async function(e=null,{area:t="local",context:n=null}={}){return await c({area:t}),function(e,t){return t?.active?l(e,t.name,{encode:!1}):e}(await browser.storage[t].get(d(e,n)),n)},set:async function(e,{area:t="local",context:n=null}={}){return await c({area:t}),browser.storage[t].set(d(e,n))},remove:async function(e,{area:t="local",context:n=null}={}){return await c({area:t}),browser.storage[t].remove(d(e,n))},clear:async function({area:e="local"}={}){return await c({area:e}),browser.storage[e].clear()}}},8618:(e,t,n)=>{"use strict";n.d(t,{$u:()=>o,Fr:()=>h,GW:()=>A,HG:()=>c,I4:()=>b,JU:()=>D,Jh:()=>L,Ky:()=>S,PG:()=>k,Qw:()=>U,T6:()=>w,ZC:()=>I,Zr:()=>C,aI:()=>u,aU:()=>T,ag:()=>M,bK:()=>O,bY:()=>l,cD:()=>_,dX:()=>x,e6:()=>d,hw:()=>j,kL:()=>g,m0:()=>p,q4:()=>a,s_:()=>P,uo:()=>m,wP:()=>R,wT:()=>v}),n(6166),n(4599),n(9191),n(6831);var i=n(3236),r=n(786),s=(n(4719),n(4729));function a(e,t){return browser.i18n.getMessage(e,t)}function o({files:e=null,css:t=null,tabId:n=null,frameIds:i=[0],allFrames:r=!1,origin:a="USER"}){if(s.tn){const o={target:{tabId:n}};return r?o.target.allFrames=!0:o.target.frameIds=i,e?o.files=e:o.css=t,"safari"!==s.Dm&&(o.origin=a),browser.scripting.insertCSS(o)}{const t={frameId:i[0]};return e?t.file=e[0]:t.code=code,browser.tabs.insertCSS(n,t)}}async function c({files:e=null,func:t=null,args:n=null,tabId:i=null,frameIds:r=[0],allFrames:a=!1,world:o="ISOLATED",injectImmediately:c=!0,unwrapResults:u=!0,code:l=""}){if(s.tn){const l={target:{tabId:i},world:o};a?l.target.allFrames=!0:l.target.frameIds=r,e?l.files=e:(l.func=t,n&&(l.args=n)),"safari"!==s.Dm&&(l.injectImmediately=c);const d=await browser.scripting.executeScript(l);return u?d.map((e=>e.result)):d}{const t={frameId:r[0]};return e?t.file=e[0]:t.code=l,c&&(t.runAt="document_start"),browser.tabs.executeScript(i,t)}}async function u({url:e="",token:t="",index:n=null,active:i=!0,openerTabId:r=null,getTab:a=!1}={}){e||(e=l(t));const o={url:e,active:i};null!==n&&(o.index=n),null!==r&&(o.openerTabId=r);let c=await browser.tabs.create(o);if(a){if("samsung"===s.Dm){let t=1;for(;t<=500&&(!c||c.url!==e);)[c]=await browser.tabs.query({lastFocusedWindow:!0,url:e}),await z(20),t+=1}return c}}function l(e){return e||(e=(0,i.A)()),`${browser.runtime.getURL("/src/tab/index.html")}?id=${e}`}async function d(){const[e]=await browser.tabs.query({lastFocusedWindow:!0,active:!0});return e}async function g({tab:e,tabId:t=null}={}){if(e||null===t||(e=await browser.tabs.get(t).catch((e=>null))),e&&e.id!==browser.tabs.TAB_ID_NONE)return!0}let f;async function m(){if(!self.location.href.startsWith(browser.runtime.getURL("/src/background/")))return browser.runtime.sendMessage({id:"getPlatform"});let{os:e,arch:t}=await async function(){if(f)return f;if(s.tn)({platformInfo:f}=await r.Ay.get("platformInfo",{area:"session"}));else try{f=JSON.parse(window.sessionStorage.getItem("platformInfo"))}catch(e){}if(!f){let e,t;if("samsung"===s.Dm?(e="android",t=""):"safari"===s.Dm?({os:e,arch:t}=await browser.runtime.sendNativeMessage("application.id",{id:"getPlatformInfo"})):({os:e,arch:t}=await browser.runtime.getPlatformInfo()),f={os:e,arch:t},s.tn)await r.Ay.set({platformInfo:f},{area:"session"});else try{window.sessionStorage.setItem("platformInfo",JSON.stringify(f))}catch(e){}}return f}();"win"===e?e="windows":"mac"===e&&(e="macos"),["x86-32","i386"].includes(t)?t="386":["x86-64","x86_64"].includes(t)?t="amd64":t.startsWith("arm")&&(t="arm");const n="windows"===e,i="macos"===e,a="linux"===e,o="android"===e,c="ios"===e,u="ipados"===e,l=["android","ios","ipados"].includes(e),d="chrome"===s.Dm,g=["chrome","edge"].includes(s.Dm)&&/\sedg(?:e|a|ios)?\//i.test(navigator.userAgent),m="firefox"===s.Dm,p=["chrome","opera"].includes(s.Dm)&&/\sopr\//i.test(navigator.userAgent),h="safari"===s.Dm,w="samsung"===s.Dm;return{os:e,arch:t,targetEnv:s.Dm,isWindows:n,isMacos:i,isLinux:a,isAndroid:o,isIos:c,isIpados:u,isMobile:l,isChrome:d,isEdge:g,isFirefox:m,isOpera:p,isSafari:h,isSamsung:w}}async function p(){return(await m()).isAndroid}async function h(){return(await m()).isMobile}function w(){return window.matchMedia("(prefers-color-scheme: dark)")}function b(e){return e||(e=Date.now()),e-e%864e5}function v(){try{const{hostname:e}=new URL(browser.runtime.getURL("/src/background/script.js"));return e}catch(e){}return null}function y(e){return void 0!==e.convertToBlob}function x(e,t,{offscreen:n=!0,contextType:i="2d"}={}){let r,s;return n?r=new OffscreenCanvas(e,t):(r=document.createElement("canvas"),r.width=e,r.height=t),i&&(s=r.getContext(i)),{cnv:r,ctx:s}}async function I(e,{ctx:t,type:n="image/png",quality:i=.8,clear:r=!0}={}){let s;if(t||(t=e.getContext("2d")),y(e)){const t=await e.convertToBlob({type:n,quality:i}).catch((e=>null));t&&(s=await A(t))}else try{s=e.toDataURL(n,i)}catch(e){}return r&&t.clearRect(0,0,e.width,e.height),s}async function k(e,{ctx:t,type:n="image/png",quality:i=.8,clear:r=!0}={}){function s(){r&&t.clearRect(0,0,e.width,e.height)}if(t||(t=e.getContext("2d")),y(e)){let t;try{t=await e.convertToBlob({type:n,quality:i})}catch(e){}finally{s()}return t}return new Promise((t=>{try{e.toBlob((function(e){s(),t(e)}),n,i)}catch(e){s(),t()}}))}function _(e){return e.slice(0,100).split(",")[0].split(":")[1].split(";")[0].toLowerCase()}function E(e){const[t,n]=e.split(",");let i;i=t.endsWith(";base64")?atob(n):unescape(n);const r=i.length,s=new Uint8Array(new ArrayBuffer(r));for(let e=0;e<r;e++)s[e]=i.charCodeAt(e);return s}async function S(e){return new Uint8Array(await new Response(e).arrayBuffer())}function T(e){return new Blob([E(e)],{type:_(e)})}function A(e){return new Promise((t=>{const n=new FileReader;n.onload=e=>{t(e.target.result)},n.onerror=()=>{t()},n.onabort=()=>{t()},n.readAsDataURL(e)}))}function j(e,t){return Math.floor(Math.random()*(t-e+1))+e}function C(e,{locale:t="en-US"}={}){return e.replace(/^\p{CWU}/u,(e=>e.toLocaleUpperCase(t)))}function M(e,{locale:t="en-US"}={}){return e.replace(/^\p{CWL}/u,(e=>e.toLocaleLowerCase(t)))}function*O(e,t){let n=0;for(;n<e.length;){const i=Math.min(n+t,e.length);yield e.slice(n,i),n=i}}function P(e){return parseInt(e,10)}function R(e){const t=e.split("/").pop().replace(/(?:#|\?).*?$/,"").split(".");let n="",i="";return 1===t.length?n=t[0]:(n=t.join("."),i=t.pop().toLowerCase()),{name:n,ext:i}}function U(e){return(/(?:\.([^.]+))?$/.exec(e)[1]||"").toLowerCase()}function L(e,t){const n=function(e,{content:t=null}={}){return e=`${e}Store`,self[e]||(self[e]=t||{}),self[e]}("run");if(!n[e])return n[e]=!0,!t||t()}async function D(e,t,{timeout:n=6e4}={}){const i=[e];return n&&i.push({signal:AbortSignal.timeout(n)}),navigator.locks.request(...i,t)}function z(e){return new Promise((t=>self.setTimeout(t,e)))}},4729:(e,t,n)=>{"use strict";n.d(t,{CU:()=>a,Dm:()=>i,QB:()=>s,ZY:()=>r,tn:()=>o});const i="firefox",r=!0,s={local:"20250102095603_add_lenso.ai",session:"20240514122825_initial_version"},a="8.1.0",o=!1},4719:(e,t,n)=>{"use strict";n.d(t,{y:()=>r}),n(6166),n(4599),n(9191);const i={makeDocumentVisible:function(e){let t=document.visibilityState;document.addEventListener(e,(function(e){t=e.detail}),{capture:!0});let n=0;function i(e){e.preventDefault(),e.stopImmediatePropagation()}window.requestAnimationFrame=new Proxy(window.requestAnimationFrame,{apply(e,i,r){if("visible"===t)return Reflect.apply(e,i,r);{const e=Date.now(),t=Math.max(0,16-(e-n));return n=e+t,window.setTimeout((function(){r[0](performance.now())}),t)}}}),window.cancelAnimationFrame=new Proxy(window.cancelAnimationFrame,{apply(e,n,i){if("visible"===t)return Reflect.apply(e,n,i);window.clearTimeout(i[0])}}),Object.defineProperty(document,"visibilityState",{get:()=>"visible"}),Object.defineProperty(document,"hidden",{get:()=>!1}),Document.prototype.hasFocus=function(){return!0},window.addEventListener("pagehide",i,{capture:!0}),window.addEventListener("blur",i,{capture:!0}),document.dispatchEvent(new Event("visibilitychange")),window.dispatchEvent(new PageTransitionEvent("pageshow")),window.dispatchEvent(new FocusEvent("focus"))},setFileInputData:function(e){const t=function(e){e.stopImmediatePropagation(),window.clearTimeout(n),function(e){const t=function(e,t,n){const[i,r]=e.split(",");let s;s=i.endsWith(";base64")?atob(r):unescape(r);const a=s.length,o=new Uint8Array(new ArrayBuffer(a));for(let e=0;e<a;e++)o[e]=s.charCodeAt(e);return new File([o],n,{type:t})}(e.imageDataUrl,e.imageType,e.imageFilename),n=new class extends Array{item(e){return this[e]}}(t),i=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"files"),r=i.get;i.get=function(){const t=document.querySelector(e.selector);return this.isSameNode(t)?n:r.apply(this)},Object.defineProperty(HTMLInputElement.prototype,"files",i)}(JSON.parse(e.detail))},n=window.setTimeout((function(){document.removeEventListener(e,t,{capture:!0,once:!0})}),1e4);document.addEventListener(e,t,{capture:!0,once:!0})},hideAlert:function(){window.alert=function(){}},lexicaOverrideEventDispatch:function(){const e=HTMLInputElement.prototype.dispatchEvent;HTMLInputElement.prototype.dispatchEvent=function(t){"file"===this.type&&"click"===t.type?HTMLInputElement.prototype.dispatchEvent=e:e.apply(this,arguments)}},alibabaChinaPatchContextScript:function(){const e=Element.prototype.appendChild;Element.prototype.appendChild=function(t){return"file"===t.type&&(t.addEventListener("click",(e=>e.preventDefault()),{capture:!0,once:!0}),Element.prototype.appendChild=e),e.apply(this,arguments)};const t=window.open;window.open=function(e){if(!e.includes("tab=imageSearch"))return t.apply(this,arguments);window.location.replace(e)}},taobaoPatchContext:function(){const e=Element.prototype.appendChild;Element.prototype.appendChild=function(t){return"file"===t.type&&(t.addEventListener("click",(e=>e.preventDefault()),{capture:!0,once:!0}),Element.prototype.appendChild=e),e.apply(this,arguments)};const t=window.open;window.open=function(e){if(!e.includes("imgSearchOrigin="))return t.apply(this,arguments);window.location.replace(e)}},yandexServiceObserver:function(e){let t;const n=function(){window.Ya?.reactBus?.e["cbir:search-by-image:start"]?.length>=4?(window.clearTimeout(i),document.dispatchEvent(new Event(e))):t||window.setTimeout(n,200)},i=window.setTimeout((function(){t=!0}),6e4);n()}};function r(e){return i[e]}},7249:(e,t,n)=>{var i={"./local/20210820184257_support_event_pages.js":4534,"./local/20210919175209_add_image_sharing_options.js":1670,"./local/20210928090443_add_unsplash.js":7867,"./local/20211011114043_configure_engines.js":4016,"./local/20211106103932_add_shein.js":405,"./local/20211111071410_add_lykdat.js":2276,"./local/20211204124507_add_wildberries.js":8722,"./local/20211213014048_add_lastengineaccesscheck.js":4948,"./local/20211213191049_add_setcontextmenuevent.js":5959,"./local/20220108063511_add_google_lens.js":8322,"./local/20220321163741_add_clipboard_support.js":5013,"./local/20220505174634_detect_alternative_image_sizes.js":6730,"./local/20220516051842_update_search_mode_ids.js":4784,"./local/20220516124148_open_images.js":314,"./local/20220814142801_configure_engines.js":388,"./local/20220924083846_add_lexica.js":1745,"./local/20230415111029_add_theme_support.js":9915,"./local/20230531103023_remove_search_engines.js":3797,"./local/20230601115626_add_kagi.js":9524,"./local/20230624145626_add_search_engines.js":6390,"./local/20230716121432_add_freepik.js":6673,"./local/20231009185955_remove_unsplash.js":420,"./local/20231102164602_add_icons8.js":9159,"./local/20240514170322_add_appversion.js":3159,"./local/20240529183556_update_search_engines.js":7021,"./local/20240619180111_add_menuchangeevent.js":38,"./local/20240624161944_remove_search_engines.js":7911,"./local/20250102095603_add_lenso.ai.js":957,"./local/BJXdcUXOG.js":1172,"./local/BJguWEHcbz.js":9981,"./local/Bk42MzXdW.js":9925,"./local/HJ5MKKGhW.js":864,"./local/Hy1tD8ANb.js":1999,"./local/IMMjiccGj.js":897,"./local/K9Esw2jiQ3.js":7636,"./local/LX20x6G8l.js":935,"./local/S18hLi5tG.js":1353,"./local/S1ebtZ3Uzz.js":521,"./local/S1kNNadHZ.js":8488,"./local/SJzIWmjKz.js":397,"./local/ShjDMM87.js":3362,"./local/SklYTwQOYf.js":9811,"./local/SkwaU8NlX.js":389,"./local/Syy800KkQ.js":2888,"./local/TshBYj8anA.js":8302,"./local/UhWEtK9gMh.js":2230,"./local/d8CIdomCW.js":7164,"./local/d8IK4KCtVm.js":1075,"./local/ekhOvNiTsF.js":2701,"./local/ggrr9C9pgV.js":6794,"./local/r1H3rgx1X.js":7462,"./local/r1Pvd36nz.js":8546,"./local/ryY8H0EWf.js":7132,"./local/ryekyizAg.js":4781,"./local/yLciyvS5He.js":1233,"./session/20240514122825_initial_version.js":211};function r(e){return s(e).then(n)}function s(e){return Promise.resolve().then((()=>{if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}))}r.keys=()=>Object.keys(i),r.resolve=s,r.id=7249,e.exports=r},2365:(e,t,n)=>{"use strict";var i=n(9200),r=n(7938),s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not a function")}},602:(e,t,n)=>{"use strict";var i=n(2430),r=TypeError;e.exports=function(e,t){if(i(t,e))return e;throw new r("Incorrect invocation")}},4398:(e,t,n)=>{"use strict";var i=n(9131),r=String,s=TypeError;e.exports=function(e){if(i(e))return e;throw new s(r(e)+" is not an object")}},9013:(e,t,n)=>{"use strict";var i=n(8793),r=n(9229),s=n(5589),a=i.ArrayBuffer,o=i.TypeError;e.exports=a&&r(a.prototype,"byteLength","get")||function(e){if("ArrayBuffer"!==s(e))throw new o("ArrayBuffer expected");return e.byteLength}},4345:(e,t,n)=>{"use strict";var i=n(8793),r=n(527),s=n(9013),a=i.ArrayBuffer,o=a&&a.prototype,c=o&&r(o.slice);e.exports=function(e){if(0!==s(e))return!1;if(!c)return!1;try{return c(e,0,0),!1}catch(e){return!0}}},3112:(e,t,n)=>{"use strict";var i=n(4345),r=TypeError;e.exports=function(e){if(i(e))throw new r("ArrayBuffer is detached");return e}},985:(e,t,n)=>{"use strict";var i=n(8793),r=n(7133),s=n(9229),a=n(8663),o=n(3112),c=n(9013),u=n(5646),l=n(879),d=i.structuredClone,g=i.ArrayBuffer,f=i.DataView,m=Math.min,p=g.prototype,h=f.prototype,w=r(p.slice),b=s(p,"resizable","get"),v=s(p,"maxByteLength","get"),y=r(h.getInt8),x=r(h.setInt8);e.exports=(l||u)&&function(e,t,n){var i,r=c(e),s=void 0===t?r:a(t),p=!b||!b(e);if(o(e),l&&(e=d(e,{transfer:[e]}),r===s&&(n||p)))return e;if(r>=s&&(!n||p))i=w(e,0,s);else{var h=n&&!p&&v?{maxByteLength:v(e)}:void 0;i=new g(s,h);for(var I=new f(e),k=new f(i),_=m(s,r),E=0;E<_;E++)x(k,E,y(I,E))}return l||u(e),i}},6134:(e,t,n)=>{"use strict";var i=n(4360),r=n(8479),s=n(7457),a=function(e){return function(t,n,a){var o=i(t),c=s(o);if(0===c)return!e&&-1;var u,l=r(a,c);if(e&&n!=n){for(;c>l;)if((u=o[l++])!=u)return!0}else for(;c>l;l++)if((e||l in o)&&o[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},1512:(e,t,n)=>{"use strict";var i=n(4398),r=n(9400);e.exports=function(e,t,n,s){try{return s?t(i(n)[0],n[1]):t(n)}catch(t){r(e,"throw",t)}}},5589:(e,t,n)=>{"use strict";var i=n(7133),r=i({}.toString),s=i("".slice);e.exports=function(e){return s(r(e),8,-1)}},3650:(e,t,n)=>{"use strict";var i=n(917),r=n(9200),s=n(5589),a=n(4702)("toStringTag"),o=Object,c="Arguments"===s(function(){return arguments}());e.exports=i?s:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=o(e),a))?n:c?s(t):"Object"===(i=s(t))&&r(t.callee)?"Arguments":i}},4085:(e,t,n)=>{"use strict";var i=n(9158),r=n(4540),s=n(2428),a=n(4446);e.exports=function(e,t,n){for(var o=r(t),c=a.f,u=s.f,l=0;l<o.length;l++){var d=o[l];i(e,d)||n&&i(n,d)||c(e,d,u(t,d))}}},6308:(e,t,n)=>{"use strict";var i=n(942);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},7236:e=>{"use strict";e.exports=function(e,t){return{value:e,done:t}}},5044:(e,t,n)=>{"use strict";var i=n(6857),r=n(4446),s=n(2007);e.exports=i?function(e,t,n){return r.f(e,t,s(1,n))}:function(e,t,n){return e[t]=n,e}},2007:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},5909:(e,t,n)=>{"use strict";var i=n(6857),r=n(4446),s=n(2007);e.exports=function(e,t,n){i?r.f(e,t,s(0,n)):e[t]=n}},3129:(e,t,n)=>{"use strict";var i=n(4174),r=n(4446);e.exports=function(e,t,n){return n.get&&i(n.get,t,{getter:!0}),n.set&&i(n.set,t,{setter:!0}),r.f(e,t,n)}},8521:(e,t,n)=>{"use strict";var i=n(9200),r=n(4446),s=n(4174),a=n(8466);e.exports=function(e,t,n,o){o||(o={});var c=o.enumerable,u=void 0!==o.name?o.name:t;if(i(n)&&s(n,u,o),o.global)c?e[t]=n:a(t,n);else{try{o.unsafe?e[t]&&(c=!0):delete e[t]}catch(e){}c?e[t]=n:r.f(e,t,{value:n,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},3948:(e,t,n)=>{"use strict";var i=n(8521);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},8466:(e,t,n)=>{"use strict";var i=n(8793),r=Object.defineProperty;e.exports=function(e,t){try{r(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},6857:(e,t,n)=>{"use strict";var i=n(942);e.exports=!i((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},5646:(e,t,n)=>{"use strict";var i,r,s,a,o=n(8793),c=n(7578),u=n(879),l=o.structuredClone,d=o.ArrayBuffer,g=o.MessageChannel,f=!1;if(u)f=function(e){l(e,{transfer:[e]})};else if(d)try{g||(i=c("worker_threads"))&&(g=i.MessageChannel),g&&(r=new g,s=new d(2),a=function(e){r.port1.postMessage(null,[e])},2===s.byteLength&&(a(s),0===s.byteLength&&(f=a)))}catch(e){}e.exports=f},1466:(e,t,n)=>{"use strict";var i=n(8793),r=n(9131),s=i.document,a=r(s)&&r(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},2030:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1320:(e,t,n)=>{"use strict";var i=n(5898);e.exports="NODE"===i},824:(e,t,n)=>{"use strict";var i=n(8793).navigator,r=i&&i.userAgent;e.exports=r?String(r):""},9140:(e,t,n)=>{"use strict";var i,r,s=n(8793),a=n(824),o=s.process,c=s.Deno,u=o&&o.versions||c&&c.version,l=u&&u.v8;l&&(r=(i=l.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!r&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(r=+i[1]),e.exports=r},5898:(e,t,n)=>{"use strict";var i=n(8793),r=n(824),s=n(5589),a=function(e){return r.slice(0,e.length)===e};e.exports=a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":i.Bun&&"string"==typeof Bun.version?"BUN":i.Deno&&"object"==typeof Deno.version?"DENO":"process"===s(i.process)?"NODE":i.window&&i.document?"BROWSER":"REST"},3353:(e,t,n)=>{"use strict";var i=n(8793),r=n(2428).f,s=n(5044),a=n(8521),o=n(8466),c=n(4085),u=n(7453);e.exports=function(e,t){var n,l,d,g,f,m=e.target,p=e.global,h=e.stat;if(n=p?i:h?i[m]||o(m,{}):i[m]&&i[m].prototype)for(l in t){if(g=t[l],d=e.dontCallGetSet?(f=r(n,l))&&f.value:n[l],!u(p?l:m+(h?".":"#")+l,e.forced)&&void 0!==d){if(typeof g==typeof d)continue;c(g,d)}(e.sham||d&&d.sham)&&s(g,"sham",!0),a(n,l,g,e)}}},942:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},5457:(e,t,n)=>{"use strict";var i=n(527),r=n(2365),s=n(7315),a=i(i.bind);e.exports=function(e,t){return r(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},7315:(e,t,n)=>{"use strict";var i=n(942);e.exports=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},492:(e,t,n)=>{"use strict";var i=n(7315),r=Function.prototype.call;e.exports=i?r.bind(r):function(){return r.apply(r,arguments)}},7403:(e,t,n)=>{"use strict";var i=n(6857),r=n(9158),s=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,o=r(s,"name"),c=o&&"something"===function(){}.name,u=o&&(!i||i&&a(s,"name").configurable);e.exports={EXISTS:o,PROPER:c,CONFIGURABLE:u}},9229:(e,t,n)=>{"use strict";var i=n(7133),r=n(2365);e.exports=function(e,t,n){try{return i(r(Object.getOwnPropertyDescriptor(e,t)[n]))}catch(e){}}},527:(e,t,n)=>{"use strict";var i=n(5589),r=n(7133);e.exports=function(e){if("Function"===i(e))return r(e)}},7133:(e,t,n)=>{"use strict";var i=n(7315),r=Function.prototype,s=r.call,a=i&&r.bind.bind(s,s);e.exports=i?a:function(e){return function(){return s.apply(e,arguments)}}},7578:(e,t,n)=>{"use strict";var i=n(8793),r=n(1320);e.exports=function(e){if(r){try{return i.process.getBuiltinModule(e)}catch(e){}try{return Function('return require("'+e+'")')()}catch(e){}}}},848:(e,t,n)=>{"use strict";var i=n(8793),r=n(9200);e.exports=function(e,t){return arguments.length<2?(n=i[e],r(n)?n:void 0):i[e]&&i[e][t];var n}},5134:e=>{"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},590:(e,t,n)=>{"use strict";var i=n(3650),r=n(9325),s=n(2178),a=n(488),o=n(4702)("iterator");e.exports=function(e){if(!s(e))return r(e,o)||r(e,"@@iterator")||a[i(e)]}},1778:(e,t,n)=>{"use strict";var i=n(492),r=n(2365),s=n(4398),a=n(7938),o=n(590),c=TypeError;e.exports=function(e,t){var n=arguments.length<2?o(e):t;if(r(n))return s(i(n,e));throw new c(a(e)+" is not iterable")}},9325:(e,t,n)=>{"use strict";var i=n(2365),r=n(2178);e.exports=function(e,t){var n=e[t];return r(n)?void 0:i(n)}},8793:function(e,t,n){"use strict";var i=function(e){return e&&e.Math===Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||i("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9158:(e,t,n)=>{"use strict";var i=n(7133),r=n(9272),s=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(r(e),t)}},640:e=>{"use strict";e.exports={}},4510:(e,t,n)=>{"use strict";var i=n(848);e.exports=i("document","documentElement")},5842:(e,t,n)=>{"use strict";var i=n(6857),r=n(942),s=n(1466);e.exports=!i&&!r((function(){return 7!==Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},8060:(e,t,n)=>{"use strict";var i=n(7133),r=n(942),s=n(5589),a=Object,o=i("".split);e.exports=r((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===s(e)?o(e,""):a(e)}:a},7217:(e,t,n)=>{"use strict";var i=n(7133),r=n(9200),s=n(5210),a=i(Function.toString);r(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},1514:(e,t,n)=>{"use strict";var i,r,s,a=n(3125),o=n(8793),c=n(9131),u=n(5044),l=n(9158),d=n(5210),g=n(2316),f=n(640),m="Object already initialized",p=o.TypeError,h=o.WeakMap;if(a||d.state){var w=d.state||(d.state=new h);w.get=w.get,w.has=w.has,w.set=w.set,i=function(e,t){if(w.has(e))throw new p(m);return t.facade=e,w.set(e,t),t},r=function(e){return w.get(e)||{}},s=function(e){return w.has(e)}}else{var b=g("state");f[b]=!0,i=function(e,t){if(l(e,b))throw new p(m);return t.facade=e,u(e,b,t),t},r=function(e){return l(e,b)?e[b]:{}},s=function(e){return l(e,b)}}e.exports={set:i,get:r,has:s,enforce:function(e){return s(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=r(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return n}}}},6:(e,t,n)=>{"use strict";var i=n(4702),r=n(488),s=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[s]===e)}},9200:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},7453:(e,t,n)=>{"use strict";var i=n(942),r=n(9200),s=/#|\.prototype\./,a=function(e,t){var n=c[o(e)];return n===l||n!==u&&(r(t)?i(t):!!t)},o=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=a.data={},u=a.NATIVE="N",l=a.POLYFILL="P";e.exports=a},2178:e=>{"use strict";e.exports=function(e){return null==e}},9131:(e,t,n)=>{"use strict";var i=n(9200);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},1818:e=>{"use strict";e.exports=!1},460:(e,t,n)=>{"use strict";var i=n(848),r=n(9200),s=n(2430),a=n(6253),o=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return r(t)&&s(t.prototype,o(e))}},3973:(e,t,n)=>{"use strict";var i=n(5457),r=n(492),s=n(4398),a=n(7938),o=n(6),c=n(7457),u=n(2430),l=n(1778),d=n(590),g=n(9400),f=TypeError,m=function(e,t){this.stopped=e,this.result=t},p=m.prototype;e.exports=function(e,t,n){var h,w,b,v,y,x,I,k=n&&n.that,_=!(!n||!n.AS_ENTRIES),E=!(!n||!n.IS_RECORD),S=!(!n||!n.IS_ITERATOR),T=!(!n||!n.INTERRUPTED),A=i(t,k),j=function(e){return h&&g(h,"normal",e),new m(!0,e)},C=function(e){return _?(s(e),T?A(e[0],e[1],j):A(e[0],e[1])):T?A(e,j):A(e)};if(E)h=e.iterator;else if(S)h=e;else{if(!(w=d(e)))throw new f(a(e)+" is not iterable");if(o(w)){for(b=0,v=c(e);v>b;b++)if((y=C(e[b]))&&u(p,y))return y;return new m(!1)}h=l(e,w)}for(x=E?e.next:h.next;!(I=r(x,h)).done;){try{y=C(I.value)}catch(e){g(h,"throw",e)}if("object"==typeof y&&y&&u(p,y))return y}return new m(!1)}},9400:(e,t,n)=>{"use strict";var i=n(492),r=n(4398),s=n(9325);e.exports=function(e,t,n){var a,o;r(e);try{if(!(a=s(e,"return"))){if("throw"===t)throw n;return n}a=i(a,e)}catch(e){o=!0,a=e}if("throw"===t)throw n;if(o)throw a;return r(a),n}},7399:(e,t,n)=>{"use strict";var i=n(492),r=n(2909),s=n(5044),a=n(3948),o=n(4702),c=n(1514),u=n(9325),l=n(1982).IteratorPrototype,d=n(7236),g=n(9400),f=o("toStringTag"),m="IteratorHelper",p="WrapForValidIterator",h=c.set,w=function(e){var t=c.getterFor(e?p:m);return a(r(l),{next:function(){var n=t(this);if(e)return n.nextHandler();try{var i=n.done?void 0:n.nextHandler();return d(i,n.done)}catch(e){throw n.done=!0,e}},return:function(){var n=t(this),r=n.iterator;if(n.done=!0,e){var s=u(r,"return");return s?i(s,r):d(void 0,!0)}if(n.inner)try{g(n.inner.iterator,"normal")}catch(e){return g(r,"throw",e)}return r&&g(r,"normal"),d(void 0,!0)}})},b=w(!0),v=w(!1);s(v,f,"Iterator Helper"),e.exports=function(e,t){var n=function(n,i){i?(i.iterator=n.iterator,i.next=n.next):i=n,i.type=t?p:m,i.nextHandler=e,i.counter=0,i.done=!1,h(this,i)};return n.prototype=t?b:v,n}},2154:(e,t,n)=>{"use strict";var i=n(492),r=n(2365),s=n(4398),a=n(5134),o=n(7399),c=n(1512),u=o((function(){var e=this.iterator,t=s(i(this.next,e));if(!(this.done=!!t.done))return c(e,this.mapper,[t.value,this.counter++],!0)}));e.exports=function(e){return s(this),r(e),new u(a(this),{mapper:e})}},1982:(e,t,n)=>{"use strict";var i,r,s,a=n(942),o=n(9200),c=n(9131),u=n(2909),l=n(5270),d=n(8521),g=n(4702),f=n(1818),m=g("iterator"),p=!1;[].keys&&("next"in(s=[].keys())?(r=l(l(s)))!==Object.prototype&&(i=r):p=!0),!c(i)||a((function(){var e={};return i[m].call(e)!==e}))?i={}:f&&(i=u(i)),o(i[m])||d(i,m,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:p}},488:e=>{"use strict";e.exports={}},7457:(e,t,n)=>{"use strict";var i=n(2695);e.exports=function(e){return i(e.length)}},4174:(e,t,n)=>{"use strict";var i=n(7133),r=n(942),s=n(9200),a=n(9158),o=n(6857),c=n(7403).CONFIGURABLE,u=n(7217),l=n(1514),d=l.enforce,g=l.get,f=String,m=Object.defineProperty,p=i("".slice),h=i("".replace),w=i([].join),b=o&&!r((function(){return 8!==m((function(){}),"length",{value:8}).length})),v=String(String).split("String"),y=e.exports=function(e,t,n){"Symbol("===p(f(t),0,7)&&(t="["+h(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!a(e,"name")||c&&e.name!==t)&&(o?m(e,"name",{value:t,configurable:!0}):e.name=t),b&&n&&a(n,"arity")&&e.length!==n.arity&&m(e,"length",{value:n.arity});try{n&&a(n,"constructor")&&n.constructor?o&&m(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var i=d(e);return a(i,"source")||(i.source=w(v,"string"==typeof t?t:"")),e};Function.prototype.toString=y((function(){return s(this)&&g(this).source||u(this)}),"toString")},8226:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var i=+e;return(i>0?n:t)(i)}},2909:(e,t,n)=>{"use strict";var i,r=n(4398),s=n(2066),a=n(2030),o=n(640),c=n(4510),u=n(1466),l=n(2316),d="prototype",g="script",f=l("IE_PROTO"),m=function(){},p=function(e){return"<"+g+">"+e+"</"+g+">"},h=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},w=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;w="undefined"!=typeof document?document.domain&&i?h(i):(t=u("iframe"),n="java"+g+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):h(i);for(var r=a.length;r--;)delete w[d][a[r]];return w()};o[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(m[d]=r(e),n=new m,m[d]=null,n[f]=e):n=w(),void 0===t?n:s.f(n,t)}},2066:(e,t,n)=>{"use strict";var i=n(6857),r=n(335),s=n(4446),a=n(4398),o=n(4360),c=n(3733);t.f=i&&!r?Object.defineProperties:function(e,t){a(e);for(var n,i=o(t),r=c(t),u=r.length,l=0;u>l;)s.f(e,n=r[l++],i[n]);return e}},4446:(e,t,n)=>{"use strict";var i=n(6857),r=n(5842),s=n(335),a=n(4398),o=n(2548),c=TypeError,u=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d="enumerable",g="configurable",f="writable";t.f=i?s?function(e,t,n){if(a(e),t=o(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var i=l(e,t);i&&i[f]&&(e[t]=n.value,n={configurable:g in n?n[g]:i[g],enumerable:d in n?n[d]:i[d],writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(a(e),t=o(t),a(n),r)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},2428:(e,t,n)=>{"use strict";var i=n(6857),r=n(492),s=n(6732),a=n(2007),o=n(4360),c=n(2548),u=n(9158),l=n(5842),d=Object.getOwnPropertyDescriptor;t.f=i?d:function(e,t){if(e=o(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return a(!r(s.f,e,t),e[t])}},5809:(e,t,n)=>{"use strict";var i=n(8959),r=n(2030).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},1264:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},5270:(e,t,n)=>{"use strict";var i=n(9158),r=n(9200),s=n(9272),a=n(2316),o=n(6308),c=a("IE_PROTO"),u=Object,l=u.prototype;e.exports=o?u.getPrototypeOf:function(e){var t=s(e);if(i(t,c))return t[c];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof u?l:null}},2430:(e,t,n)=>{"use strict";var i=n(7133);e.exports=i({}.isPrototypeOf)},8959:(e,t,n)=>{"use strict";var i=n(7133),r=n(9158),s=n(4360),a=n(6134).indexOf,o=n(640),c=i([].push);e.exports=function(e,t){var n,i=s(e),u=0,l=[];for(n in i)!r(o,n)&&r(i,n)&&c(l,n);for(;t.length>u;)r(i,n=t[u++])&&(~a(l,n)||c(l,n));return l}},3733:(e,t,n)=>{"use strict";var i=n(8959),r=n(2030);e.exports=Object.keys||function(e){return i(e,r)}},6732:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},1427:(e,t,n)=>{"use strict";var i=n(492),r=n(9200),s=n(9131),a=TypeError;e.exports=function(e,t){var n,o;if("string"===t&&r(n=e.toString)&&!s(o=i(n,e)))return o;if(r(n=e.valueOf)&&!s(o=i(n,e)))return o;if("string"!==t&&r(n=e.toString)&&!s(o=i(n,e)))return o;throw new a("Can't convert object to primitive value")}},4540:(e,t,n)=>{"use strict";var i=n(848),r=n(7133),s=n(5809),a=n(1264),o=n(4398),c=r([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=s.f(o(e)),n=a.f;return n?c(t,n(e)):t}},3977:(e,t,n)=>{"use strict";var i=n(2178),r=TypeError;e.exports=function(e){if(i(e))throw new r("Can't call method on "+e);return e}},2316:(e,t,n)=>{"use strict";var i=n(6014),r=n(685),s=i("keys");e.exports=function(e){return s[e]||(s[e]=r(e))}},5210:(e,t,n)=>{"use strict";var i=n(1818),r=n(8793),s=n(8466),a="__core-js_shared__",o=e.exports=r[a]||s(a,{});(o.versions||(o.versions=[])).push({version:"3.39.0",mode:i?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6014:(e,t,n)=>{"use strict";var i=n(5210);e.exports=function(e,t){return i[e]||(i[e]=t||{})}},879:(e,t,n)=>{"use strict";var i=n(8793),r=n(942),s=n(9140),a=n(5898),o=i.structuredClone;e.exports=!!o&&!r((function(){if("DENO"===a&&s>92||"NODE"===a&&s>94||"BROWSER"===a&&s>97)return!1;var e=new ArrayBuffer(8),t=o(e,{transfer:[e]});return 0!==e.byteLength||8!==t.byteLength}))},260:(e,t,n)=>{"use strict";var i=n(9140),r=n(942),s=n(8793).String;e.exports=!!Object.getOwnPropertySymbols&&!r((function(){var e=Symbol("symbol detection");return!s(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},8479:(e,t,n)=>{"use strict";var i=n(4932),r=Math.max,s=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):s(n,t)}},8663:(e,t,n)=>{"use strict";var i=n(4932),r=n(2695),s=RangeError;e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=r(t);if(t!==n)throw new s("Wrong length or index");return n}},4360:(e,t,n)=>{"use strict";var i=n(8060),r=n(3977);e.exports=function(e){return i(r(e))}},4932:(e,t,n)=>{"use strict";var i=n(8226);e.exports=function(e){var t=+e;return t!=t||0===t?0:i(t)}},2695:(e,t,n)=>{"use strict";var i=n(4932),r=Math.min;e.exports=function(e){var t=i(e);return t>0?r(t,9007199254740991):0}},9272:(e,t,n)=>{"use strict";var i=n(3977),r=Object;e.exports=function(e){return r(i(e))}},9422:(e,t,n)=>{"use strict";var i=n(492),r=n(9131),s=n(460),a=n(9325),o=n(1427),c=n(4702),u=TypeError,l=c("toPrimitive");e.exports=function(e,t){if(!r(e)||s(e))return e;var n,c=a(e,l);if(c){if(void 0===t&&(t="default"),n=i(c,e,t),!r(n)||s(n))return n;throw new u("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},2548:(e,t,n)=>{"use strict";var i=n(9422),r=n(460);e.exports=function(e){var t=i(e,"string");return r(t)?t:t+""}},917:(e,t,n)=>{"use strict";var i={};i[n(4702)("toStringTag")]="z",e.exports="[object z]"===String(i)},7938:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},685:(e,t,n)=>{"use strict";var i=n(7133),r=0,s=Math.random(),a=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++r+s,36)}},6253:(e,t,n)=>{"use strict";var i=n(260);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},335:(e,t,n)=>{"use strict";var i=n(6857),r=n(942);e.exports=i&&r((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},3125:(e,t,n)=>{"use strict";var i=n(8793),r=n(9200),s=i.WeakMap;e.exports=r(s)&&/native code/.test(String(s))},4702:(e,t,n)=>{"use strict";var i=n(8793),r=n(6014),s=n(9158),a=n(685),o=n(260),c=n(6253),u=i.Symbol,l=r("wks"),d=c?u.for||u:u&&u.withoutSetter||a;e.exports=function(e){return s(l,e)||(l[e]=o&&s(u,e)?u[e]:d("Symbol."+e)),l[e]}},6166:(e,t,n)=>{"use strict";var i=n(6857),r=n(3129),s=n(4345),a=ArrayBuffer.prototype;i&&!("detached"in a)&&r(a,"detached",{configurable:!0,get:function(){return s(this)}})},9191:(e,t,n)=>{"use strict";var i=n(3353),r=n(985);r&&i({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return r(this,arguments.length?arguments[0]:void 0,!1)}})},4599:(e,t,n)=>{"use strict";var i=n(3353),r=n(985);r&&i({target:"ArrayBuffer",proto:!0},{transfer:function(){return r(this,arguments.length?arguments[0]:void 0,!0)}})},2306:(e,t,n)=>{"use strict";var i=n(3353),r=n(8793),s=n(602),a=n(4398),o=n(9200),c=n(5270),u=n(3129),l=n(5909),d=n(942),g=n(9158),f=n(4702),m=n(1982).IteratorPrototype,p=n(6857),h=n(1818),w="constructor",b="Iterator",v=f("toStringTag"),y=TypeError,x=r[b],I=h||!o(x)||x.prototype!==m||!d((function(){x({})})),k=function(){if(s(this,m),c(this)===m)throw new y("Abstract class Iterator not directly constructable")},_=function(e,t){p?u(m,e,{configurable:!0,get:function(){return t},set:function(t){if(a(this),this===m)throw new y("You can't redefine this property");g(this,e)?this[e]=t:l(this,e,t)}}):m[e]=t};g(m,v)||_(v,b),!I&&g(m,w)&&m[w]!==Object||_(w,k),k.prototype=m,i({global:!0,constructor:!0,forced:I},{Iterator:k})},8481:(e,t,n)=>{"use strict";var i=n(3353),r=n(3973),s=n(2365),a=n(4398),o=n(5134);i({target:"Iterator",proto:!0,real:!0},{every:function(e){a(this),s(e);var t=o(this),n=0;return!r(t,(function(t,i){if(!e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},7374:(e,t,n)=>{"use strict";var i=n(3353),r=n(492),s=n(2365),a=n(4398),o=n(5134),c=n(7399),u=n(1512),l=n(1818),d=c((function(){for(var e,t,n=this.iterator,i=this.predicate,s=this.next;;){if(e=a(r(s,n)),this.done=!!e.done)return;if(t=e.value,u(n,i,[t,this.counter++],!0))return t}}));i({target:"Iterator",proto:!0,real:!0,forced:l},{filter:function(e){return a(this),s(e),new d(o(this),{predicate:e})}})},2439:(e,t,n)=>{"use strict";var i=n(3353),r=n(3973),s=n(2365),a=n(4398),o=n(5134);i({target:"Iterator",proto:!0,real:!0},{find:function(e){a(this),s(e);var t=o(this),n=0;return r(t,(function(t,i){if(e(t,n++))return i(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},2099:(e,t,n)=>{"use strict";var i=n(3353),r=n(3973),s=n(2365),a=n(4398),o=n(5134);i({target:"Iterator",proto:!0,real:!0},{forEach:function(e){a(this),s(e);var t=o(this),n=0;r(t,(function(t){e(t,n++)}),{IS_RECORD:!0})}})},3640:(e,t,n)=>{"use strict";var i=n(3353),r=n(2154);i({target:"Iterator",proto:!0,real:!0,forced:n(1818)},{map:r})},356:(e,t,n)=>{"use strict";var i=n(3353),r=n(3973),s=n(2365),a=n(4398),o=n(5134);i({target:"Iterator",proto:!0,real:!0},{some:function(e){a(this),s(e);var t=o(this),n=0;return r(t,(function(t,i){if(e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},9849:(e,t,n)=>{"use strict";n(2306)},9558:(e,t,n)=>{"use strict";n(8481)},1167:(e,t,n)=>{"use strict";n(7374)},6210:(e,t,n)=>{"use strict";n(2439)},6658:(e,t,n)=>{"use strict";n(2099)},6831:(e,t,n)=>{"use strict";n(3640)},1177:(e,t,n)=>{"use strict";n(356)},541:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},3677:(e,t,n)=>{"use strict";let i;n.d(t,{A:()=>s});const r=new Uint8Array(16);function s(){if(!i){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");i=crypto.getRandomValues.bind(crypto)}return i(r)}},6541:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function r(e,t=0){return(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase()}},3236:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(541),r=n(3677),s=n(6541);const a=function(e,t,n){if(i.A.randomUUID&&!t&&!e)return i.A.randomUUID();const a=(e=e||{}).random||(e.rng||r.A)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return(0,s.k)(a)}},8977:e=>{"use strict";e.exports=JSON.parse('{"revisions":{"local":["ryekyizAg","Hy1tD8ANb","S1kNNadHZ","Bk42MzXdW","HJ5MKKGhW","ryY8H0EWf","BJguWEHcbz","S1ebtZ3Uzz","BJXdcUXOG","SklYTwQOYf","S18hLi5tG","SJzIWmjKz","r1Pvd36nz","r1H3rgx1X","Syy800KkQ","SkwaU8NlX","yLciyvS5He","ekhOvNiTsF","ShjDMM87","LX20x6G8l","d8CIdomCW","d8IK4KCtVm","UhWEtK9gMh","TshBYj8anA","ggrr9C9pgV","IMMjiccGj","K9Esw2jiQ3","20210820184257_support_event_pages","20210919175209_add_image_sharing_options","20210928090443_add_unsplash","20211011114043_configure_engines","20211106103932_add_shein","20211111071410_add_lykdat","20211204124507_add_wildberries","20211213014048_add_lastengineaccesscheck","20211213191049_add_setcontextmenuevent","20220108063511_add_google_lens","20220321163741_add_clipboard_support","20220505174634_detect_alternative_image_sizes","20220516051842_update_search_mode_ids","20220516124148_open_images","20220814142801_configure_engines","20220924083846_add_lexica","20230415111029_add_theme_support","20230531103023_remove_search_engines","20230601115626_add_kagi","20230624145626_add_search_engines","20230716121432_add_freepik","20231009185955_remove_unsplash","20231102164602_add_icons8","20240514170322_add_appversion","20240529183556_update_search_engines","20240619180111_add_menuchangeevent","20240624161944_remove_search_engines","20250102095603_add_lenso.ai"],"session":["20240514122825_initial_version"]}}')}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var s=i[e]={exports:{}};return n[e].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var s=Object.create(null);r.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(s,a),s},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";r(9849),r(1167),r(6210),r(6831);var e=r(3236),t=r(4143);class n extends Error{constructor(e){super(e),this.name="TimeoutError"}}class i extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const s=e=>void 0===globalThis.DOMException?new i(e):new DOMException(e),a=e=>{const t=void 0===e.reason?s("This operation was aborted."):e.reason;return t instanceof Error?t:s(t)};class o{#e=[];enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&this.#e[this.size-1].priority>=t.priority)return void this.#e.push(n);const i=function(e,t){let n=0,i=e.length;for(;i>0;){const s=Math.trunc(i/2);let a=n+s;r=e[a],t.priority-r.priority<=0?(n=++a,i-=s+1):i=s}var r;return n}(this.#e,n);this.#e.splice(i,0,n)}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}class c extends t{#t;#n;#i=0;#r;#s;#a=0;#o;#c;#e;#u;#l=0;#d;#g;#f;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:o,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#t=e.carryoverConcurrencyCount,this.#n=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#r=e.intervalCap,this.#s=e.interval,this.#e=new e.queueClass,this.#u=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#f=!0===e.throwOnTimeout,this.#g=!1===e.autoStart}get#m(){return this.#n||this.#i<this.#r}get#p(){return this.#l<this.#d}#h(){this.#l--,this.#w(),this.emit("next")}#b(){this.#v(),this.#y(),this.#c=void 0}get#x(){const e=Date.now();if(void 0===this.#o){const t=this.#a-e;if(!(t<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#b()}),t)),!0;this.#i=this.#t?this.#l:0}return!1}#w(){if(0===this.#e.size)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),0===this.#l&&this.emit("idle"),!1;if(!this.#g){const e=!this.#x;if(this.#m&&this.#p){const t=this.#e.dequeue();return!!t&&(this.emit("active"),t(),e&&this.#y(),!0)}}return!1}#y(){this.#n||void 0!==this.#o||(this.#o=setInterval((()=>{this.#v()}),this.#s),this.#a=Date.now()+this.#s)}#v(){0===this.#i&&0===this.#l&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#i=this.#t?this.#l:0,this.#I()}#I(){for(;this.#w(););}get concurrency(){return this.#d}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#d=e,this.#I()}async#k(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(e.reason)}),{once:!0})}))}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:this.#f,...t},new Promise(((i,r)=>{this.#e.enqueue((async()=>{this.#l++,this.#i++;try{t.signal?.throwIfAborted();let r=e({signal:t.signal});t.timeout&&(r=function(e,t){const{milliseconds:i,fallback:r,message:s,customTimers:o={setTimeout,clearTimeout}}=t;let c;const u=new Promise(((u,l)=>{if("number"!=typeof i||1!==Math.sign(i))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(t.signal){const{signal:n}=t;n.aborted&&l(a(n));const i=()=>{l(a(n))};n.addEventListener("abort",i,{once:!0}),e.finally((()=>{n.removeEventListener("abort",i)}))}if(i===Number.POSITIVE_INFINITY)return void e.then(u,l);const d=new n;c=o.setTimeout.call(void 0,(()=>{if(r)try{u(r())}catch(e){l(e)}else"function"==typeof e.cancel&&e.cancel(),!1===s?u():s instanceof Error?l(s):(d.message=s??`Promise timed out after ${i} milliseconds`,l(d))}),i),(async()=>{try{u(await e)}catch(e){l(e)}})()})).finally((()=>{u.clear()}));return u.clear=()=>{o.clearTimeout.call(void 0,c),c=void 0},u}(Promise.resolve(r),{milliseconds:t.timeout})),t.signal&&(r=Promise.race([r,this.#k(t.signal)]));const s=await r;i(s),this.emit("completed",s)}catch(e){if(e instanceof n&&!t.throwOnTimeout)return void i();r(e),this.emit("error",e)}finally{this.#h()}}),t),this.emit("add"),this.#w()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#g?(this.#g=!1,this.#I(),this):this}pause(){this.#g=!0}clear(){this.#e=new this.#u}async onEmpty(){0!==this.#e.size&&await this.#_("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#_("next",(()=>this.#e.size<e))}async onIdle(){0===this.#l&&0===this.#e.size||await this.#_("idle")}async#_(e,t){return new Promise((n=>{const i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#l}get isPaused(){return this.#g}}const u=function(e,t){return e===t||e!=e&&t!=t},l="object"==typeof global&&global&&global.Object===Object&&global;var d="object"==typeof self&&self&&self.Object===Object&&self;const g=l||d||Function("return this")(),f=g.Symbol;var m=Object.prototype,p=m.hasOwnProperty,h=m.toString,w=f?f.toStringTag:void 0;var b=Object.prototype.toString;var v=f?f.toStringTag:void 0;const y=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":v&&v in Object(e)?function(e){var t=p.call(e,w),n=e[w];try{e[w]=void 0;var i=!0}catch(e){}var r=h.call(e);return i&&(t?e[w]=n:delete e[w]),r}(e):function(e){return b.call(e)}(e)},x=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},I=function(e){if(!x(e))return!1;var t=y(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},k=function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!I(e)};var _=/^(?:0|[1-9]\d*)$/;const E=function(e,t,n){if(!x(n))return!1;var i=typeof t;return!!("number"==i?k(n)&&function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&_.test(e))&&e>-1&&e%1==0&&e<t}(t,n.length):"string"==i&&t in n)&&u(n[t],e)};var S=/\s/;var T=/^\s+/;const A=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&S.test(e.charAt(t)););return t}(e)+1).replace(T,""):e},j=function(e){return null!=e&&"object"==typeof e};var C=/^[-+]0x[0-9a-f]+$/i,M=/^0b[01]+$/i,O=/^0o[0-7]+$/i,P=parseInt;const R=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||j(e)&&"[object Symbol]"==y(e)}(e))return NaN;if(x(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=x(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=A(e);var n=M.test(e);return n||O.test(e)?P(e.slice(2),n?2:8):C.test(e)?NaN:+e};var U=1/0;const L=function(e){var t=function(e){return e?(e=R(e))===U||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0},D=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&E(e,t,n)?(t=0,n=i):(t=null==t?0:L(t),n=void 0===n?i:L(n)),function(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var s=Array(r);++i<r;)s[i]=e[i+t];return s}(e,t,n)):[]},z=function(e){return e!=e},q=function(e,t,n){return t==t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):function(e,t,n,i){for(var r=e.length,s=n+(i?1:-1);i?s--:++s<r;)if(t(e[s],s,e))return s;return-1}(e,z,n)};var B=Math.max;const F=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:L(n);return r<0&&(r=B(i+r,0)),q(e,t,r)};var N=r(786);async function V({area:e="local",data:t=null,silent:n=!1}={}){const i={getAvailableRevisions:async({area:e}={})=>(await Promise.resolve().then(r.t.bind(r,8977,19))).revisions[e],getCurrentRevision:async({area:e}={})=>(await browser.storage[e].get("storageVersion")).storageVersion,getRevision:async({area:e,revision:t}={})=>r(7249)(`./${e}/${t}.js`)};return"local"===e&&await async function(){if(await(0,N.Hu)({area:"sync"})){const{storageVersion:e}=await browser.storage.sync.get("storageVersion");if(e&&e.length<14){const{storageVersion:e}=await browser.storage.local.get("storageVersion");if(!e||e.length<14){const e=await browser.storage.sync.get(null);await browser.storage.local.clear(),await browser.storage.local.set(e),await browser.storage.sync.clear()}}}}(),async function(e,{area:t="local",data:n=null,silent:i=!1}={}){return async function(e,{area:t="local",data:n=null,silent:i=!1}={}){const r=await e.getAvailableRevisions({area:t}),s=await e.getCurrentRevision({area:t}),a=(c=null==(o=r)?0:o.length)?o[c-1]:void 0;var o,c;if(s===a)return;const u=D(r,F(r,s)+1,F(r,a)+1);i||console.log(`Migrating storage (${t}): ${s} => ${a}`);for(const r of u){const s=await e.getRevision({area:t,revision:r});i||console.log(`Applying revision (${t}): ${s.revision} - ${s.message}`),await s.upgrade(n)}}(e,{area:t,data:n,silent:i})}(i,{area:e,data:t,silent:n})}r(9558),r(6658),r(1177);const H=g["__core-js_shared__"];var $,W=($=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+$:"";var G=Function.prototype.toString;var K=/^\[object .+?Constructor\]$/,X=Function.prototype,J=Object.prototype,Q=X.toString,Y=J.hasOwnProperty,Z=RegExp("^"+Q.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const ee=function(e){return!(!x(e)||(t=e,W&&W in t))&&(I(e)?Z:K).test(function(e){if(null!=e){try{return G.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t},te=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ee(n)?n:void 0},ne=te(Object,"create");var ie=Object.prototype.hasOwnProperty;var re=Object.prototype.hasOwnProperty;function se(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}se.prototype.clear=function(){this.__data__=ne?ne(null):{},this.size=0},se.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},se.prototype.get=function(e){var t=this.__data__;if(ne){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ie.call(t,e)?t[e]:void 0},se.prototype.has=function(e){var t=this.__data__;return ne?void 0!==t[e]:re.call(t,e)},se.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ne&&void 0===t?"__lodash_hash_undefined__":t,this};const ae=se,oe=function(e,t){for(var n=e.length;n--;)if(u(e[n][0],t))return n;return-1};var ce=Array.prototype.splice;function ue(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}ue.prototype.clear=function(){this.__data__=[],this.size=0},ue.prototype.delete=function(e){var t=this.__data__,n=oe(t,e);return!(n<0||(n==t.length-1?t.pop():ce.call(t,n,1),--this.size,0))},ue.prototype.get=function(e){var t=this.__data__,n=oe(t,e);return n<0?void 0:t[n][1]},ue.prototype.has=function(e){return oe(this.__data__,e)>-1},ue.prototype.set=function(e,t){var n=this.__data__,i=oe(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};const le=ue,de=te(g,"Map"),ge=function(e,t){var n,i,r=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map};function fe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}fe.prototype.clear=function(){this.size=0,this.__data__={hash:new ae,map:new(de||le),string:new ae}},fe.prototype.delete=function(e){var t=ge(this,e).delete(e);return this.size-=t?1:0,t},fe.prototype.get=function(e){return ge(this,e).get(e)},fe.prototype.has=function(e){return ge(this,e).has(e)},fe.prototype.set=function(e,t){var n=ge(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};const me=fe;function pe(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new me;++t<n;)this.add(e[t])}pe.prototype.add=pe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},pe.prototype.has=function(e){return this.__data__.has(e)};const he=pe,we=function(e,t){return!(null==e||!e.length)&&q(e,t,0)>-1},be=function(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1},ve=function(e,t){return e.has(t)},ye=function(e,t,n,i){var r,s=-1,a=we,o=!0,c=e.length,u=[],l=t.length;if(!c)return u;n&&(t=function(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}(t,(r=n,function(e){return r(e)}))),i?(a=be,o=!1):t.length>=200&&(a=ve,o=!1,t=new he(t));e:for(;++s<c;){var d=e[s],g=null==n?d:n(d);if(d=i||0!==d?d:0,o&&g==g){for(var f=l;f--;)if(t[f]===g)continue e;u.push(d)}else a(t,g,i)||u.push(d)}return u},xe=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e},Ie=function(e){return j(e)&&"[object Arguments]"==y(e)};var ke=Object.prototype,_e=ke.hasOwnProperty,Ee=ke.propertyIsEnumerable;const Se=Ie(function(){return arguments}())?Ie:function(e){return j(e)&&_e.call(e,"callee")&&!Ee.call(e,"callee")},Te=Array.isArray;var Ae=f?f.isConcatSpreadable:void 0;const je=function(e){return Te(e)||Se(e)||!!(Ae&&e&&e[Ae])},Ce=function e(t,n,i,r,s){var a=-1,o=t.length;for(i||(i=je),s||(s=[]);++a<o;){var c=t[a];n>0&&i(c)?n>1?e(c,n-1,i,r,s):xe(s,c):r||(s[s.length]=c)}return s},Me=function(e){return e};var Oe=Math.max;const Pe=function(){try{var e=te(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Re=Pe?function(e,t){return Pe(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Me;var Ue=Date.now;const Le=(De=Re,ze=0,qe=0,function(){var e=Ue(),t=16-(e-qe);if(qe=e,t>0){if(++ze>=800)return arguments[0]}else ze=0;return De.apply(void 0,arguments)});var De,ze,qe;const Be=function(e){return j(e)&&k(e)};var Fe=function(e){return Le(function(e,t,n){return t=Oe(void 0===t?e.length-1:t,0),function(){for(var i=arguments,r=-1,s=Oe(i.length-t,0),a=Array(s);++r<s;)a[r]=i[t+r];r=-1;for(var o=Array(t+1);++r<t;)o[r]=i[r];return o[t]=n(a),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}(e,void 0,Me),e+"")}((function(e,t){return Be(e)?ye(e,Ce(t,1,Be,!0)):[]}));const Ne=Fe;function Ve(e){return new DataView(e.buffer,e.byteOffset)}r(1024);const He={len:1,get:(e,t)=>Ve(e).getUint8(t),put:(e,t,n)=>(Ve(e).setUint8(t,n),t+1)},$e={len:2,get:(e,t)=>Ve(e).getUint16(t,!0),put:(e,t,n)=>(Ve(e).setUint16(t,n,!0),t+2)},We={len:2,get:(e,t)=>Ve(e).getUint16(t),put:(e,t,n)=>(Ve(e).setUint16(t,n),t+2)},Ge={len:4,get:(e,t)=>Ve(e).getUint32(t,!0),put:(e,t,n)=>(Ve(e).setUint32(t,n,!0),t+4)},Ke={len:4,get:(e,t)=>Ve(e).getUint32(t),put:(e,t,n)=>(Ve(e).setUint32(t,n),t+4)},Xe={len:4,get:(e,t)=>Ve(e).getInt32(t),put:(e,t,n)=>(Ve(e).setInt32(t,n),t+4)},Je={len:8,get:(e,t)=>Ve(e).getBigUint64(t,!0),put:(e,t,n)=>(Ve(e).setBigUint64(t,n,!0),t+8)};class Qe{constructor(e,t){this.len=e,this.encoding=t,this.textDecoder=new TextDecoder(t)}get(e,t){return this.textDecoder.decode(e.subarray(t,t+this.len))}}class Ye extends Error{constructor(){super("End-Of-Stream")}}class Ze{constructor(){this.maxStreamReadSize=1048576,this.endOfStream=!1,this.peekQueue=[]}async peek(e,t,n){const i=await this.read(e,t,n);return this.peekQueue.push(e.subarray(t,t+i)),i}async read(e,t,n){if(0===n)return 0;let i=this.readFromPeekBuffer(e,t,n);if(i+=await this.readRemainderFromStream(e,t+i,n-i),0===i)throw new Ye;return i}readFromPeekBuffer(e,t,n){let i=n,r=0;for(;this.peekQueue.length>0&&i>0;){const n=this.peekQueue.pop();if(!n)throw new Error("peekData should be defined");const s=Math.min(n.length,i);e.set(n.subarray(0,s),t+r),r+=s,i-=s,s<n.length&&this.peekQueue.push(n.subarray(s))}return r}async readRemainderFromStream(e,t,n){let i=n,r=0;for(;i>0&&!this.endOfStream;){const n=Math.min(i,this.maxStreamReadSize),s=await this.readFromStream(e,t+r,n);if(0===s)break;r+=s,i-=s}return r}}class et extends Ze{constructor(e){super(),this.reader=e.getReader({mode:"byob"})}async readFromStream(e,t,n){if(this.endOfStream)throw new Ye;const i=await this.reader.read(new Uint8Array(n));return i.done&&(this.endOfStream=i.done),i.value?(e.set(i.value,t),i.value.byteLength):0}async abort(){await this.reader.cancel(),this.reader.releaseLock()}}class tt{constructor(e){this.numBuffer=new Uint8Array(8),this.position=0,this.onClose=e?.onClose,e?.abortSignal&&e.abortSignal.addEventListener("abort",(()=>{this.abort()}))}async readToken(e,t=this.position){const n=new Uint8Array(e.len);if(await this.readBuffer(n,{position:t})<e.len)throw new Ye;return e.get(n,0)}async peekToken(e,t=this.position){const n=new Uint8Array(e.len);if(await this.peekBuffer(n,{position:t})<e.len)throw new Ye;return e.get(n,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new Ye;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new Ye;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){await this.abort(),await(this.onClose?.())}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}abort(){return Promise.resolve()}}class nt extends tt{constructor(e,t){super(t),this.streamReader=e,this.fileInfo=t?.fileInfo??{}}async readBuffer(e,t){const n=this.normalizeOptions(e,t),i=n.position-this.position;if(i>0)return await this.ignore(i),this.readBuffer(e,t);if(i<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===n.length)return 0;const r=await this.streamReader.read(e,n.offset,n.length);if(this.position+=r,(!t||!t.mayBeLess)&&r<n.length)throw new Ye;return r}async peekBuffer(e,t){const n=this.normalizeOptions(e,t);let i=0;if(n.position){const t=n.position-this.position;if(t>0){const r=new Uint8Array(n.length+t);return i=await this.peekBuffer(r,{mayBeLess:n.mayBeLess}),e.set(r.subarray(t),n.offset),i-t}if(t<0)throw new Error("Cannot peek from a negative offset in a stream")}if(n.length>0){try{i=await this.streamReader.peek(e,n.offset,n.length)}catch(e){if(t?.mayBeLess&&e instanceof Ye)return 0;throw e}if(!n.mayBeLess&&i<n.length)throw new Ye}return i}async ignore(e){const t=Math.min(256e3,e),n=new Uint8Array(t);let i=0;for(;i<e;){const r=e-i,s=await this.readBuffer(n,{length:Math.min(t,r)});if(s<0)return s;i+=s}return i}abort(){return this.streamReader.abort()}supportsRandomAccess(){return!1}}class it extends tt{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo={...t?.fileInfo??{},size:e.length}}async readBuffer(e,t){if(t?.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const n=await this.peekBuffer(e,t);return this.position+=n,n}async peekBuffer(e,t){const n=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-n.position,n.length);if(!n.mayBeLess&&i<n.length)throw new Ye;return e.set(this.uint8Array.subarray(n.position,n.position+i),n.offset),i}close(){return super.close()}supportsRandomAccess(){return!0}setPosition(e){this.position=e}}function rt(e){const{byteLength:t}=e;return 6===t?e.getUint16(0)*2**32+e.getUint32(2):5===t?e.getUint8(0)*2**32+e.getUint32(1):4===t?e.getUint32(0):3===t?65536*e.getUint8(0)+e.getUint16(1):2===t?e.getUint16(0):1===t?e.getUint8(0):void 0}function st(e,t){const n=e.length,i=t.length;if(0===i)return-1;if(i>n)return-1;const r=n-i;for(let n=0;n<=r;n++){let r=!0;for(let s=0;s<i;s++)if(e[n+s]!==t[s]){r=!1;break}if(r)return n}return-1}Object.prototype.toString,new globalThis.TextDecoder("utf8"),new globalThis.TextEncoder,Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));const at={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},ot=4100;function ct(e,t,n){n={offset:0,...n};for(const[i,r]of t.entries())if(n.mask){if(r!==(n.mask[i]&e[i+n.offset]))return!1}else if(r!==e[i+n.offset])return!1;return!0}class ut{constructor(e){this.detectors=e?.customDetectors,this.tokenizerOptions={abortSignal:e?.signal},this.fromTokenizer=this.fromTokenizer.bind(this),this.fromBuffer=this.fromBuffer.bind(this),this.parse=this.parse.bind(this)}async fromTokenizer(e){const t=e.position;for(const n of this.detectors||[]){const i=await n(e);if(i)return i;if(t!==e.position)return}return this.parse(e)}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Uint8Array?e:new Uint8Array(e);var n,i;if(t?.length>1)return this.fromTokenizer((n=t,i=this.tokenizerOptions,new it(n,i)))}async fromBlob(e){return this.fromStream(e.stream())}async fromStream(e){const t=await(n=e,i=this.tokenizerOptions,new nt(new et(n),i));var n,i;try{return await this.fromTokenizer(t)}finally{await t.close()}}async toDetectionStream(e,t){const{sampleSize:n=ot}=t;let i,r;const s=e.getReader({mode:"byob"});try{const{value:e,done:t}=await s.read(new Uint8Array(n));if(r=e,!t&&e)try{i=await this.fromBuffer(e.slice(0,n))}catch(e){if(!(e instanceof Ye))throw e;i=void 0}r=e}finally{s.releaseLock()}const a=new TransformStream({async start(e){e.enqueue(r)},transform(e,t){t.enqueue(e)}}),o=e.pipeThrough(a);return o.fileType=i,o}check(e,t){return ct(this.buffer,e,t)}checkString(e,t){return this.check((n=e,[...n].map((e=>e.charCodeAt(0)))),t);var n}async parse(e){if(this.buffer=new Uint8Array(ot),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([199,113]))return{ext:"cpio",mime:"application/x-cpio"};if(this.check([96,234]))return{ext:"arj",mime:"application/x-arj"};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.parse(e);if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const t=await e.readToken(at);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),this.fromTokenizer(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:"jls",mime:"image/jls"}:{ext:"jpg",mime:"image/jpeg"};if(this.check([79,98,106,1]))return{ext:"avro",mime:"application/avro"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const n=new DataView(this.buffer.buffer),i={compressedSize:n.getUint32(18,!0),uncompressedSize:n.getUint32(22,!0),filenameLength:n.getUint16(26,!0),extraFieldLength:n.getUint16(28,!0)};if(i.filename=await e.readToken(new Qe(i.filenameLength,"utf-8")),await e.ignore(i.extraFieldLength),/classes\d*\.dex/.test(i.filename))return{ext:"apk",mime:"application/vnd.android.package-archive"};if("META-INF/mozilla.rsa"===i.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(i.filename.endsWith(".rels")||i.filename.endsWith(".xml"))switch(i.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};case"visio":return{ext:"vsdx",mime:"application/vnd.visio"}}if(i.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(i.filename.startsWith("3D/")&&i.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===i.filename&&i.compressedSize===i.uncompressedSize){let r=await e.readToken(new Qe(i.compressedSize,"utf-8"));switch(r=r.trim(),r){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===i.compressedSize){let s=-1;for(;s<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),s=st(this.buffer,new Uint8Array([80,75,3,4])),await e.ignore(s>=0?s:this.buffer.length)}else await e.ignore(i.compressedSize)}}catch(a){if(!(a instanceof Ye))throw a}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const o=new Uint8Array(8);return await e.readBuffer(o),ct(o,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/ogg; codecs=opus"}:ct(o,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:ct(o,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:ct(o,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:ct(o,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:ct(o,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&96&this.buffer[8]){const c=new Qe(4,"latin1").get(this.buffer,8).replace("\0"," ").trim();switch(c){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return c.startsWith("3g")?c.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){try{await e.ignore(1350);const u=10485760,l=new Uint8Array(Math.min(u,e.fileInfo.size));if(await e.readBuffer(l,{mayBeLess:!0}),-1!==st(l,(new TextEncoder).encode("AIPrivateData")))return{ext:"ai",mime:"application/postscript"}}catch(d){if(!(d instanceof Ye))throw d}return{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const g=await this.readTiffHeader(!1);if(g)return g}if(this.check([77,77])){const f=await this.readTiffHeader(!0);if(f)return f}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function m(){const t=await e.peekNumber(He);let n=128,i=0;for(;!(t&n)&&0!==n;)++i,n>>=1;const r=new Uint8Array(i+1);return await e.readBuffer(r),r}async function p(){const e=await m(),t=await m();t[0]^=128>>t.length-1;const n=Math.min(6,t.length),i=new DataView(e.buffer),r=new DataView(t.buffer,t.length-n,n);return{id:rt(i),len:rt(r)}}async function h(t){for(;t>0;){const n=await p();if(17026===n.id)return(await e.readToken(new Qe(n.len))).replaceAll(/\00.*$/g,"");await e.ignore(n.len),--t}}const w=await p();switch(await h(w.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/wav"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([33,66,68,78]))return{ext:"pst",mime:"application/vnd.ms-outlook"};if(this.checkString("PAR1"))return{ext:"parquet",mime:"application/x-parquet"};if(this.check([207,250,237,254]))return{ext:"macho",mime:"application/x-mach-binary"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([202,254,186,190]))return{ext:"class",mime:"application/java-vm"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("AC")){const b=new Qe(4,"latin1").get(this.buffer,2);if(b.match("^d*")&&b>=1e3&&b<=1050)return{ext:"dwg",mime:"image/vnd.dwg"}}if(this.checkString("070707"))return{ext:"cpio",mime:"application/x-cpio"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>"))return await e.ignore(8),"debian-binary"===await e.readToken(new Qe(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(this.checkString("WEBVTT")&&["\n","\r","\t"," ","\0"].some((e=>this.checkString(e,{offset:6}))))return{ext:"vtt",mime:"text/vtt"};if(this.check([137,80,78,71,13,10,26,10])){async function v(){return{length:await e.readToken(Xe),type:await e.readToken(new Qe(4,"latin1"))}}await e.ignore(8);do{const y=await v();if(y.length<0)return;switch(y.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(y.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function x(){const t=new Uint8Array(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Je))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const I=await x();let k=I.size-24;if(ct(I.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const _=new Uint8Array(16);if(k-=await e.readBuffer(_),ct(_,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(ct(_,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(k)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([255,79,255,81]))return{ext:"j2c",mime:"image/j2c"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Qe(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255]))return this.check([0,60,0,63,0,120,0,109,0,108],{offset:2})?{ext:"xml",mime:"application/xml"}:void 0;if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:"icc",mime:"application/vnd.iccprofile"};if(this.checkString("**ACE",{offset:7})&&this.checkString("**",{offset:12}))return{ext:"ace",mime:"application/x-ace-compressed"};if(this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const E=new DataView(this.buffer.buffer).getUint32(12,!0);if(E>12&&this.buffer.length>=E+16)try{const S=(new TextDecoder).decode(this.buffer.slice(16,E+16));if(JSON.parse(S).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.checkString("Kaydara FBX Binary  \0"))return{ext:"fbx",mime:"application/x.autodesk.fbx"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),function(e,t=0){const n=Number.parseInt(new Qe(6).get(e,148).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(n))return!1;let i=256;for(let n=t;n<t+148;n++)i+=e[n];for(let n=t+156;n<t+512;n++)i+=e[n];return n===i}(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254]))return this.check([60,0,63,0,120,0,109,0,108,0],{offset:2})?{ext:"xml",mime:"application/xml"}:this.check([255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0],{offset:2})?{ext:"skp",mime:"application/vnd.sketchup.skp"}:void 0;if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const t=await this.tokenizer.readToken(e?We:$e);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const t=await this.tokenizer.readToken(e?We:$e);for(let n=0;n<t;++n){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const t=(e?We:$e).get(this.buffer,2),n=(e?Ke:Ge).get(this.buffer,4);if(42===t){if(n>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(n>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}return await this.tokenizer.ignore(n),await this.readTiffIFD(e)??{ext:"tif",mime:"image/tiff"}}if(43===t)return{ext:"tif",mime:"image/tiff"}}}new Set(["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","elf","macho","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","j2c","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf","jls","pst","dwg","parquet","class","arj","cpio","ace","avro","icc","fbx","vsdx","vtt","apk"]),new Set(["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/wav","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","video/ogg","audio/ogg","audio/ogg; codecs=opus","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-elf","application/x-mach-binary","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/j2c","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","text/vtt","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd","image/jls","application/vnd.ms-outlook","image/vnd.dwg","application/x-parquet","application/java-vm","application/x-arj","application/x-cpio","application/x-ace-compressed","application/avro","application/vnd.iccprofile","application/x.autodesk.fbx","application/vnd.visio","application/vnd.android.package-archive"]);var lt=r(8618),dt=r(4729);const gt=["engines","disabledEngines","showInContextMenu","searchAllEnginesContextMenu","searchAllEnginesAction","tabInBackgound","localGoogle","imgFullParse","searchModeAction","searchModeContextMenu","bypassImageHostBlocking","shareImageContextMenu","convertSharedImage","autoPasteAction","confirmPaste","detectAltImageDimension","viewImageContextMenu","viewImageUseViewer","appTheme","showContribPage","showEngineIcons","pinActionToolbarViewImage","pinActionToolbarShareImage","pinActionToolbarOptions","pinActionToolbarContribute"],ft=browser.runtime.getURL("/src/search/index.html")+"?id={id}",mt={google:{url:{target:"https://www.google.com/searchbyimage?sbisrc=cr_1_5_2&image_url={imgUrl}",isExec:!0},image:{target:ft,isTaskId:!0}},bing:{url:{target:"https://www.bing.com/images/search?q=imgurl:{imgUrl}&view=detailv2&iss=sbi&FORM=IRSBIQ&redirecturl=https%3A%2F%2Fwww.bing.com%2Fimages%2Fdiscover%3Fform%3DHDRSC2#enterInsights"},image:{target:"https://www.bing.com/",isExec:!0}},yandex:{url:{target:"https://yandex.com/images/search?url={imgUrl}&rpt=imageview"},image:{target:"https://yandex.com/images/",isExec:!0}},baidu:{url:{target:"https://www.baidu.com/",isExec:!0},image:{target:"https://www.baidu.com/",isExec:!0}},tineye:{url:{target:"https://www.tineye.com/search/?&url={imgUrl}"},image:{target:"https://www.tineye.com/",isExec:!0}},sogou:{url:{target:"https://pic.sogou.com/ris?query={imgUrl}&flag=1&drag=0"},image:{target:"https://pic.sogou.com/",isExec:!0}},karmaDecay:{url:{target:"http://karmadecay.com/search?q={imgUrl}"},image:{target:"http://karmadecay.com/",isExec:!0}},whatanime:{url:{target:"https://trace.moe/?url={imgUrl}"},image:{target:"https://trace.moe/",isExec:!0}},saucenao:{url:{target:"https://saucenao.com/",isExec:!0},image:{target:"https://saucenao.com/",isExec:!0}},iqdb:{url:{target:"https://iqdb.org/?url={imgUrl}"},image:{target:"https://iqdb.org/",isExec:!0}},ascii2d:{url:{target:"https://ascii2d.net/search/url/{imgUrl}"},image:{target:"https://ascii2d.net/",isExec:!0}},getty:{image:{target:"https://www.gettyimages.com/",isExec:!0}},istock:{image:{target:"https://www.istockphoto.com/",isExec:!0}},shutterstock:{image:{target:"https://www.shutterstock.com/images",isExec:!0}},adobestock:{image:{target:"https://stock.adobe.com/",isExec:!0}},depositphotos:{image:{target:"https://depositphotos.com/",isExec:!0}},pinterest:{image:{target:ft,isTaskId:!0}},qihoo:{image:{target:"https://st.so.com/",isExec:!0}},taobao:{image:{target:"https://www.taobao.com/",isExec:!0}},alibabaChina:{image:{target:"https://www.1688.com/",isExec:!0}},dreamstime:{image:{target:"https://www.dreamstime.com/",isExec:!0}},alamy:{image:{target:"https://www.alamy.com/",isExec:!0}},"123rf":{image:{target:"https://www.123rf.com/",isExec:!0}},esearch:{image:{target:"https://euipo.europa.eu/eSearch/",isExec:!0}},tmview:{image:{target:"https://www.tmdn.org/tmview/#/tmview",isExec:!0}},branddb:{image:{target:"https://branddb.wipo.int/en/similarlogo",isExec:!0}},madridMonitor:{image:{target:"https://www3.wipo.int/madrid/monitor/en/",isExec:!0}},auTrademark:{image:{target:"https://search.ipaustralia.gov.au/trademarks/search/advanced",isExec:!0}},auDesign:{image:{target:"https://search.ipaustralia.gov.au/designs/search/advanced",isExec:!0}},nzTrademark:{image:{target:"https://app.iponz.govt.nz/app/TradeMarkCheck",isExec:!0}},jpDesign:{image:{target:"https://www.graphic-image.inpit.go.jp/",isExec:!0}},pimeyes:{image:{target:"https://pimeyes.com/en",isExec:!0}},stocksy:{image:{target:"https://www.stocksy.com/",isExec:!0}},pond5:{image:{target:"https://www.pond5.com/stock-images/",isExec:!0}},pixta:{image:{target:"https://www.pixtastock.com/",isExec:!0}},ikea:{image:{target:"https://www.ikea.com/",isExec:!0}},repostSleuth:{url:{target:"https://repostsleuth.com/search?targetImageMatch=60&filterSameAuthor=false",isExec:!0},image:{target:"https://repostsleuth.com/search?targetImageMatch=60&filterSameAuthor=false",isExec:!0}},shein:{image:{target:"https://m.shein.com/presearch",isExec:!0}},lykdat:{image:{target:"https://lykdat.com/",isExec:!0}},wildberries:{image:{target:"https://www.wildberries.ru/",isExec:!0}},googleLens:{url:{target:"https://www.google.com/imghp",isExec:!0},image:{target:"https://www.google.com/imghp",isExec:!0}},lexica:{url:{target:"https://lexica.art/?q={imgUrl}"},image:{target:"https://lexica.art/",isExec:!0}},kagi:{url:{target:"https://kagi.com/images",isExec:!0},image:{target:"https://kagi.com/images",isExec:!0}},freepik:{image:{target:"https://www.freepik.com/search",isExec:!0}},icons8:{image:{target:"https://icons8.com/",isExec:!0}},lenso:{url:{target:"https://lenso.ai/en/search-by-url?url={imgUrl}&utm_source=sbi",isExec:!0},image:{target:"https://lenso.ai/en?utm_source=sbi",isExec:!0}}},pt=["baidu","sogou","qihoo","taobao","alibabaChina"],ht={branddb:"wipo",madridMonitor:"wipo"},wt={getty:["dark"],istock:["dark"],depositphotos:["dark"],alamy:["dark"],"123rf":["dark"],nzTrademark:["dark"],stocksy:["dark"],lykdat:["dark"],lexica:["dark"],jpDesign:["dark"],pimeyes:["dark"],pond5:["dark"],saucenao:["dark"],ascii2d:["dark"],tmview:["dark"],pixta:["dark"],freepik:["dark"],lenso:["dark"]},bt=["iqdb","karmaDecay","tineye","whatanime","repostSleuth"],vt={"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpg","jpeg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/prs.btif":["btif","btf"],"image/prs.pti":["pti"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/webp":["webp"],"image/wmf":["wmf"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["bmp"],"image/x-pcx":["pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"]};Object.assign(vt,{"image/jxl":["jxl"]}),Object.assign({"image/aces":"","image/apng":"APNG","image/avci":"","image/avcs":"","image/avif":"AVIF","image/bmp":"BMP","image/cgm":"","image/dicom-rle":"","image/emf":"","image/fits":"","image/g3fax":"","image/gif":"GIF","image/heic":"HEIC","image/heic-sequence":"","image/heif":"HEIF","image/heif-sequence":"","image/hej2k":"","image/hsj2":"","image/ief":"","image/jls":"","image/jp2":"JP2","image/jpeg":"JPEG","image/jph":"","image/jphc":"","image/jpm":"","image/jpx":"JPX","image/jxr":"","image/jxra":"","image/jxrs":"","image/jxs":"","image/jxsc":"","image/jxsi":"","image/jxss":"","image/ktx":"","image/ktx2":"","image/png":"PNG","image/prs.btif":"","image/prs.pti":"","image/sgi":"","image/svg+xml":"SVG","image/t38":"","image/tiff":"TIFF","image/tiff-fx":"","image/vnd.adobe.photoshop":"PSD","image/vnd.airzip.accelerator.azv":"","image/vnd.dece.graphic":"","image/vnd.djvu":"","image/vnd.dvb.subtitle":"","image/vnd.dwg":"","image/vnd.dxf":"","image/vnd.fastbidsheet":"","image/vnd.fpx":"","image/vnd.fst":"","image/vnd.fujixerox.edmics-mmr":"","image/vnd.fujixerox.edmics-rlc":"","image/vnd.microsoft.icon":"ICO","image/vnd.ms-dds":"","image/vnd.ms-modi":"","image/vnd.ms-photo":"","image/vnd.net-fpx":"","image/vnd.pco.b16":"","image/vnd.tencent.tap":"","image/vnd.valve.source.texture":"","image/vnd.wap.wbmp":"","image/vnd.xiff":"","image/vnd.zbrush.pcx":"","image/webp":"WebP","image/wmf":"","image/x-3ds":"","image/x-cmu-raster":"","image/x-cmx":"","image/x-freehand":"","image/x-icon":"ICO","image/x-jng":"","image/x-mrsid-image":"","image/x-ms-bmp":"","image/x-pcx":"","image/x-pict":"","image/x-portable-anymap":"","image/x-portable-bitmap":"","image/x-portable-graymap":"","image/x-portable-pixmap":"","image/x-rgb":"","image/x-tga":"","image/x-xbitmap":"XBM","image/x-xpixmap":"","image/x-xwindowdump":""},{"image/jxl":"JPEG XL"});const yt=["google","bing","yandex","baidu","tineye","whatanime","saucenao","ascii2d","adobestock","depositphotos","pinterest","qihoo","alibabaChina","dreamstime","pimeyes","pond5","ikea","shein","lykdat","googleLens","lexica","icons8","lenso"],xt=["bing","yandex","whatanime","adobestock","alibabaChina","dreamstime","pond5","lexica"];async function It(e){return void 0===e&&(e=await N.Ay.get(["engines","disabledEngines"])),Ne(e.engines,e.disabledEngines)}async function kt(e,t,n,i){return["selectImage","capture","browse"].includes(n)||i||!e.imageUrl||!await _t(t,{bypassBlocking:"url"!==n})}async function _t(e,{bypassBlocking:t=!0}={}){let n;n=Array.isArray(e)?e:"allEngines"===e?await It():[e];const{bypassImageHostBlocking:i}=await N.Ay.get("bypassImageHostBlocking");for(const e of n)if(!mt[e].url||t&&i&&pt.includes(e))return!1;return!0}async function Et(e){const t={sessionOrigin:"",sessionType:"",sourceTabId:-1,sourceTabIndex:-1,sourceFrameId:-1,closeSourceTab:!1,searchMode:"",engineGroup:"",engines:[],options:{}};if(t.options=await N.Ay.get(gt),e.options&&(Object.assign(t.options,e.options),delete e.options),e.engine){if("allEngines"===e.engine){const e=await It(t.options);t.engineGroup="allEngines",t.engines=e}else t.engines.push(e.engine);delete e.engine}return Object.assign(t,e),"search"!==t.sessionType||t.searchMode||(t.searchMode="action"===t.sessionOrigin?t.options.searchModeAction:t.options.searchModeContextMenu),t}async function St({message:e,messageId:t,title:n,type:i="info",timeout:r=0}={}){if(n||(n=(0,lt.q4)("extensionName")),t&&(e=(0,lt.q4)(t)),"safari"===dt.Dm)return browser.runtime.sendNativeMessage("application.id",{id:"notification",message:e});{const t=await browser.notifications.create(`sbi-notification-${i}`,{type:"basic",title:n,message:e,iconUrl:"/src/assets/icons/app/icon-64.png"});return r&&self.setTimeout((()=>{browser.notifications.clear(t)}),r),t}}async function Tt({tabId:e,frameId:t=0,module:n,insert:i=!1}={}){try{const[r]=await(0,lt.HG)({func:e=>self.runStore?.[`${e}Module`],args:[n],code:`self.runStore?.['${n}Module']`,tabId:e,frameIds:[t]});if(!r&&i&&await(0,lt.HG)({files:[`/src/${n}/script.js`],tabId:e,frameIds:[t]}),r||i)return!0}catch(e){console.log(e)}return!1}async function At({activeTab:e=!1}={}){const t=[];if(e){const e=await(0,lt.e6)();e&&t.push(e)}else t.push(...await browser.tabs.query({url:["http://*/*","https://*/*"],windowType:"normal"}));for(const e of t)(0,lt.HG)({files:["/src/base/script.js"],tabId:e.id,allFrames:!0})}async function jt({tab:e,tabId:t=null}={}){return e||null===t||(e=await browser.tabs.get(t).catch((e=>null))),await(0,lt.kL)({tab:e})&&!(await(0,lt.uo)()).isMobile?e.id:null}async function Ct({url:e="",setOpenerTab:t=!0,getTab:n=!1,activeTab:i=null}={}){i||(i=await(0,lt.e6)());const r={url:e,index:i.index+1,active:!0,getTab:n};return t&&(r.openerTabId=await jt({tab:i})),(0,lt.aI)(r)}let Mt,Ot=0;async function Pt({action:e="auto",activeTab:t=null,showContribPage:n=!0}={}){if(await async function({valueChange:e=1,maxUseCount:t=1/0,minInterval:n=0}={}){if(Date.now()-Ot>=n){Ot=Date.now();const{useCount:n}=await N.Ay.get("useCount");n<t?await N.Ay.set({useCount:n+e}):n>t&&await N.Ay.set({useCount:t})}}({valueChange:1,maxUseCount:1e3}),n)return async function({minUseCount:e=0,minInstallDays:t=0,minLastOpenDays:n=0,minLastAutoOpenDays:i=0,action:r="auto",activeTab:s=null}={}){if(dt.ZY){const a=await N.Ay.get(["showContribPage","useCount","installTime","contribPageLastOpen","contribPageLastAutoOpen"]),o=(0,lt.I4)();if(a.showContribPage&&a.useCount>=e&&o-a.installTime>=864e5*t&&o-a.contribPageLastOpen>=864e5*n&&o-a.contribPageLastAutoOpen>=864e5*i)return await N.Ay.set({contribPageLastOpen:o,contribPageLastAutoOpen:o}),async function({action:e="",updateStats:t=!0,getTab:n=!1,activeTab:i=null}={}){t&&await N.Ay.set({contribPageLastOpen:(0,lt.I4)()});let r=browser.runtime.getURL("/src/contribute/index.html");return e&&(r=`${r}?action=${e}`),Ct({url:r,getTab:n,activeTab:i})}({action:r,updateStats:!1,activeTab:s,getTab:!0})}}({minUseCount:10,minInstallDays:14,minLastOpenDays:14,minLastAutoOpenDays:365,activeTab:t,action:e})}function Rt({count:e=1,reserved:t=!1}={}){const n=[];let i,r;for(t?(i=1,r=1e8):(i=100000001,r=["firefox","safari"].includes(dt.Dm)?Number.MAX_SAFE_INTEGER:2147483647);;){const t=(0,lt.hw)(i,r);if(n.includes(t)||n.push(t),n.length===e)break}return n}function Ut(e,{variant:t=""}={}){let n=e=ht[e]||e;return t&&wt[e]?.includes(t)&&(n+=`-${t}`),bt.includes(e)?{16:`src/assets/icons/engines/${n}-16.png`,32:`src/assets/icons/engines/${n}-32.png`}:{16:`src/assets/icons/engines/${n}.svg`}}function Lt(e,{name:t,type:n}={}){const i=n||e.type,r=function({name:e,type:t}={}){if(e||(e="image"),t){const n=function(e){const t=vt[e];return t?t[0]:null}(t);if(n){const i=(0,lt.Qw)(e);i?Ft(i)!==t?e=e.replace(new RegExp(`${i}$`,"i"),n):e.endsWith(i)||(e=e.replace(new RegExp(`${i}$`,"i"),i)):e=`${e}.${n}`}}return e}({name:t||e.name,type:i});return e.name!==r||e.type!==i?new File([e],r,{type:i}):e}async function Dt({blob:e,dataUrl:t,name:n}={}){e||(e=(0,lt.aU)(t));const i=await async function(e,{name:t}={}){if(!async function(e){if(e){if(e.size<=314572800)return!0;console.log(`File too large (${e.size} bytes)`)}return!1}(e))return;const n=await(0,lt.Ky)(e.slice(0,4100)).catch((e=>null));let i;if(n&&({mime:i}=await async function(e){return(new ut).fromBuffer(e)}(n)||{}),i){if(Nt(i))return Lt(e,{type:i,name:t})}else if(Nt(e.type))return Lt(e,{name:t})}(e,{name:n});if(i)return i}async function zt(e){const t=await(0,lt.GW)(e);if(t)return{imageDataUrl:t,imageFilename:e.name,imageType:e.type,imageSize:e.size}}function qt(e,t,{maxDimension:n=1/0}={}){let i,r;return e>n||t>n?(e===t&&(i=r=n),e>t&&(i=n,r=t/e*n),e<t&&(i=e/t*n,r=n)):(i=e,r=t),{width:i,height:r}}async function Bt({url:e,blob:t,query:n=!1}={}){if("undefined"==typeof Image){if(e){if(!e.startsWith("data:"))throw new Error("getImageElement does not accept image URLs in service workers");try{t=(0,lt.aU)(e)}catch{}}let n;try{n=await createImageBitmap(t),n.naturalWidth=n.width,n.naturalHeight=n.height}catch{}return n}return new Promise((i=>{if(n){const t=document.images;for(let n=0;n<t.length;n++){const r=t[n];if(r?.currentSrc===e){if(!r.complete||!r.naturalWidth)break;i(r)}}}if(e&&e.startsWith("data:")&&e.length>(["firefox","safari"].includes(dt.Dm)?31457280:1/0))try{t=(0,lt.aU)(e)}catch{}function r(n){t&&URL.revokeObjectURL(e),n?i(n):i()}t&&(e=URL.createObjectURL(t));const s=new Image;s.onload=()=>{r(s)},s.onerror=()=>{r()},s.onabort=()=>{r()},s.src=e}))}function Ft(e){for(const[t,n]of Object.entries(vt))if(n.includes(e))return t;return null}function Nt(e){return!!vt.hasOwnProperty(e)}async function Vt(e,{credentials:t=!1,timeout:n=12e4,token:i=""}={}){if(!dt.tn)return new Promise((r=>{const s=function(){try{return new content.XMLHttpRequest}catch(e){return new XMLHttpRequest}}();s.open("GET",e),n&&(s.timeout=n),s.responseType="blob",s.withCredentials=t,i&&s.setRequestHeader("Accept",i),s.onload=()=>{r(s.response)},s.onerror=()=>{r()},s.onabort=()=>{r()},s.ontimeout=()=>{r()},s.send()}));{const i={method:"GET",mode:"cors"};n&&(i.signal=function(e){if(AbortSignal.timeout)return AbortSignal.timeout(e);{const t=new AbortController;return self.setTimeout((()=>t.abort()),e),t.signal}}(n)),t&&(i.credentials="include");try{const t=await fetch(e,i);return await t.blob()}catch(e){}}}function Ht(e,t){if("image/webp"===e){if(yt.includes(t))return!0}else{if("image/avif"!==e)return!0;if(xt.includes(t))return!0}}function $t(e){if("image"===e.mediaType&&function(e,{allowDataUrl:t=!1}={}){try{if(t&&e.startsWith("data:"))return!0;if(e.length<=2048&&/^https?:$/i.test(new URL(e).protocol))return!0}catch(e){}}(e.srcUrl,{allowDataUrl:!0}))return e.srcUrl}async function Wt(e,{session:t,mustDownloadUrl:n=!1}={}){let i;if(e.startsWith("data:")){const t=await Dt({dataUrl:e});if(t){const e=await zt(t);e&&(i=e)}}else{const{name:r,type:s}=function(e){const{name:t,ext:n}=(0,lt.wP)(e);return{name:t,ext:n,type:Ft(n)}}(e);if(n=n||"share"===t.sessionType||"view"===t.sessionType&&t.options.viewImageUseViewer||"search"===t.sessionType&&("selectImage"===t.searchMode||!await _t(t.engines)||t.engines.some((e=>!Ht(s,e))))){const t=await Vt(e);if(t){const n=await Dt({blob:t,name:r});if(n){const t=await zt(n);t&&(i={imageUrl:e,...t})}}}else i={imageUrl:e,imageType:s}}return i}function Gt({port:e,checkMessage:t=null,timeout:n=12e4}={}){let i;const r=function(e){t(e)&&(i=!0)};return e.onMessage.addListener(r),new Promise(((s,a)=>{const o=function(){u(),s()},c=function(e){t(e)&&o()},u=function({throwError:t=!1}={}){self.clearTimeout(d),e.onDisconnect.removeListener(l),e.onMessage.removeListener(r),e.onMessage.removeListener(c),t&&a()},l=function(){u({throwError:!0})};e.onDisconnect.addListener(l);const d=self.setTimeout(l,n);i?o():e.onMessage.addListener(c)}))}function Kt(){return"firefox"===dt.Dm?83886080:41943040}var Xt=r(4719);function Jt(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function Qt(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const i=Jt(n);return(e,n)=>i.then((i=>n(i.transaction(t,e).objectStore(t))))}let Yt;function Zt(){return Yt||(Yt=Qt("keyval-store","keyval")),Yt}function en(e,t,n=Zt()){return n("readwrite",(n=>(n.put(t,e),Jt(n.transaction))))}Error;const tn=new c({concurrency:1}),nn=new c({concurrency:1}),rn=new class{constructor(){this.idbStore=null,this.memoryStore=null}initStore({area:e="",force:t=!1}={}){"indexeddb"===e?this.idbStore&&!t||(this.idbStore=Qt("keyval-store","keyval")):"memory"===e&&(this.memoryStore||(this.memoryStore={}))}handleError(e,{area:t=""}={}){if("indexeddb"!==t||!e?.message?.includes("connection is closing"))throw e;console.log("IndexedDB error:",e.message),this.initStore({area:t,force:!0})}async get(e,{area:t=""}={}){if(this.initStore({area:t}),"indexeddb"===t)try{return await function(e,t=Zt()){return t("readonly",(t=>Jt(t.get(e))))}(e,this.idbStore)}catch(e){this.handleError(e,{area:t})}else{if("local"===t)return(await N.Ay.get(e))[e];if("memory"===t)return this.memoryStore[e]}}async set(e,t,{area:n=""}={}){if(this.initStore({area:n}),"indexeddb"===n)try{await en(e,t,this.idbStore)}catch(i){this.handleError(i,{area:n}),await en(e,t,this.idbStore)}else"local"===n?await N.Ay.set({[e]:t}):"memory"===n&&(this.memoryStore[e]=t)}async remove(e,{area:t=""}={}){if(this.initStore({area:t}),"indexeddb"===t)try{await function(e,t=Zt()){return t("readwrite",(t=>(t.delete(e),Jt(t.transaction))))}(e,this.idbStore)}catch(e){this.handleError(e,{area:t})}else"local"===t?await N.Ay.remove(e):"memory"===t&&delete this.memoryStore[e]}};function sn(e){return{metadataKey:`metadata_${e}`,dataKey:`data_${e}`}}async function an({storageId:e,metadata:t=!1,data:n=!1,area:i="local"}={}){const{metadataKey:r,dataKey:s}=sn(e);return t&&({value:t}=await rn.get(r,{area:"local"})||{}),n&&({value:n}=await rn.get(s,{area:i})||{}),{metadata:t,data:n}}async function on({storageId:e,metadata:t=null,data:n=null,area:i="local"}={}){const{metadataKey:r,dataKey:s}=sn(e);null!==t&&await rn.set(r,{value:t},{area:"local"}),null!==n&&await rn.set(s,{value:n},{area:i})}async function cn({storageId:e,metadata:t=!1,data:n=!1,area:i="local"}={}){const{metadataKey:r,dataKey:s}=sn(e);t&&await rn.remove(r,{area:"local"}),n&&await rn.remove(s,{area:i})}async function un({storageId:e,registry:t=!0}={}){const{metadata:n}=await an({storageId:e,metadata:!0});if(n){await cn({storageId:e,data:!0,area:n.area});for(const e of n.alarms)await browser.alarms.clear(e);await cn({storageId:e,metadata:!0}),t&&(n.isTask&&await async function({taskId:e}={}){await nn.add((async function(){const{taskRegistry:t}=await N.Ay.get("taskRegistry"),n=t.tasks[e];if(n){const i=t.tabs[n.tabId];i&&i.taskId===e&&delete t.tabs[n.tabId]}delete t.tasks[e],await N.Ay.set({taskRegistry:t})}))}({taskId:e}),await async function({storageId:e}={}){await nn.add((async function(){const{storageRegistry:t}=await N.Ay.get("storageRegistry");delete t[e],await N.Ay.set({storageRegistry:t})}))}({storageId:e}))}}async function ln({storageId:e}={}){await tn.add((async function(){const{metadata:t}=await an({storageId:e,metadata:!0});t&&t.receipts&&(t.receipts.received+=1,t.receipts.received<t.receipts.expected?await on({storageId:e,metadata:t}):await un({storageId:e}))}))}const dn={addStorageItem:async function(t,{token:n="",receipts:i=null,expiryTime:r=0,area:s="local",isTask:a=!1}={}){const o=n||(0,e.A)(),c=Date.now(),u={area:s,addTime:c,receipts:i,alarms:[],isTask:a};if(r){const e=`delete-storage-item_${o}`;browser.alarms.create(e,{delayInMinutes:r}),u.alarms.push(e)}return await async function({storageId:e,addTime:t}={}){await nn.add((async function(){const{storageRegistry:n}=await N.Ay.get("storageRegistry");n[e]={addTime:t},await N.Ay.set({storageRegistry:n})}))}({storageId:o,addTime:c}),await on({storageId:o,metadata:u,data:t,area:s}),o},getStorageItem:async function({storageId:e,saveReceipt:t=!1}={}){const{metadata:n}=await an({storageId:e,metadata:!0});if(n){const{data:i}=await an({storageId:e,data:!0,area:n.area});if(i)return t&&await ln({storageId:e}),i}},deleteStorageItem:un,saveStorageItemReceipt:ln,addTaskRegistryItem:async function({taskId:e,tabId:t}={}){await nn.add((async function(){const{taskRegistry:n}=await N.Ay.get("taskRegistry"),i=Date.now();n.lastTaskStart=i,n.tabs[t]={taskId:e},n.tasks[e]={tabId:t,addTime:i},await N.Ay.set({taskRegistry:n})}))},getTaskRegistryItem:async function({taskId:e,tabId:t}={}){const{taskRegistry:n}=await N.Ay.get("taskRegistry");if(t){let e=n.tabs[t];if(!e&&["safari"].includes(dt.Dm)){const i=await async function(e){return(0,lt.JU)("tab_revisions",(async()=>{const{tabRevisions:t}=await N.Ay.get("tabRevisions",{area:"session"});for(const n of t)if(n.includes(e))return n;return null}))}(t);if(i)for(const t of i)if(e=n.tabs[t],e)break}if(e)return{taskId:e.taskId,...n.tasks[e.taskId]}}else if(e){const t=n.tasks[e];if(t)return{taskId:e,...t}}},cleanupRegistry:async function(){await nn.add((async function(){const{lastStorageCleanup:e}=await N.Ay.get("lastStorageCleanup");if(Date.now()-e>864e5){const{taskRegistry:e}=await N.Ay.get("taskRegistry");for(const[t,n]of Object.entries(e.tasks))if(Date.now()-n.addTime>36e5){const i=e.tabs[n.tabId];i&&i.taskId===t&&delete e.tabs[n.tabId],delete e.tasks[t]}await N.Ay.set({taskRegistry:e});const{storageRegistry:t}=await N.Ay.get("storageRegistry");for(const[e,n]of Object.entries(t))Date.now()-n.addTime>36e5&&(await un({storageId:e,registry:!1}),delete t[e]);await N.Ay.set({storageRegistry:t,lastStorageCleanup:Date.now()})}}))}},gn=new c({concurrency:1});function fn({tabId:e,userAgent:t}={}){browser.webRequest.onBeforeSendHeaders.addListener((function(e){for(const n of e.requestHeaders)if("user-agent"===n.name.toLowerCase()){n.value=t;break}return{requestHeaders:e.requestHeaders}}),{urls:["http://*/*","https://*/*"],tabId:e},["blocking","requestHeaders"])}async function mn(e){return new Promise(((t,n)=>{let i;i=browser.contextMenus.create(e,(function(){browser.runtime.lastError&&n(browser.runtime.lastError),t(i)}))}))}async function pn(e,{throwError:t=!1}={}){try{await browser.contextMenus.remove(e)}catch(e){if(t)throw e}}async function hn(){const e={name:"private",active:browser.extension.inIncognitoContext},{menuItems:t}=await N.Ay.get("menuItems",{context:e});for(const e of t)await pn(e);const{showInContextMenu:n}=await N.Ay.get("showInContextMenu"),i=n?await async function(){const e=await(0,lt.uo)(),t=await N.Ay.get(gt),n=["audio","editable","frame","image","link","selection","video"];e.isFirefox&&n.push("password"),e.isAndroid||n.push("page");const i=e.isFirefox&&t.showEngineIcons;let r;i&&(r=await async function(e){return e||({appTheme:e}=await N.Ay.get("appTheme")),"auto"===e&&(e=(0,lt.T6)().matches?"dark":"light"),e}(t.appTheme));const s=["http://*/*","https://*/*"];["safari","samsung"].includes(dt.Dm)||s.push("file:///*");const a=function(){try{const{protocol:e}=new URL(browser.runtime.getURL("/src/background/script.js"));return`${e}//*/*`}catch(e){}return null}(),o=!e.isSamsung&&t.searchAllEnginesContextMenu,c=t.viewImageContextMenu,u=t.shareImageContextMenu&&function(e){return!(!navigator.canShare||!e.isSafari&&(!e.isWindows&&!e.isAndroid||e.isFirefox))}(e),l=await It(t),d=[];if(1===l.length){const e=l[0],t=(0,lt.q4)("mainMenuItemTitle_engine",(0,lt.q4)(`menuItemTitle_${e}`));d.push(await bn({id:`search_${e}_1`,title:t,contexts:n,documentUrlPatterns:s})),a&&d.push(await bn({id:`search_${e}_2`,title:t,contexts:["image"],documentUrlPatterns:[a]}))}else if(l.length>1&&"main"===o){const e=(0,lt.q4)("mainMenuItemTitle_allEngines");d.push(await bn({id:"search_allEngines_1",title:e,contexts:n,documentUrlPatterns:s})),a&&d.push(await bn({id:"search_allEngines_2",title:e,contexts:["image"],documentUrlPatterns:[a]}))}else if(l.length>1){let t=!1;if(c){const e=(0,lt.q4)("menuItemTitle_viewImage");d.push(await bn({id:"view_1",title:e,contexts:n,documentUrlPatterns:s})),a&&d.push(await bn({id:"view_2",title:e,contexts:["image"],documentUrlPatterns:[a]})),t=!0}if(u){const e=(0,lt.q4)("menuItemTitle_shareImage");d.push(await bn({id:"share_1",title:e,contexts:n,documentUrlPatterns:s})),a&&d.push(await bn({id:"share_2",title:e,contexts:["image"],documentUrlPatterns:[a]})),t=!0}if(t&&!e.isSamsung&&(d.push(await bn({id:"sep_1",contexts:n,type:"separator",documentUrlPatterns:s})),a&&d.push(await bn({id:"sep_2",type:"separator",contexts:["image"],documentUrlPatterns:[a]}))),"sub"===o){const t=(0,lt.q4)("menuItemTitle_allEngines"),o=i&&Ut("allEngines",{variant:r});d.push(await bn({id:"search_allEngines_1",title:t,contexts:n,documentUrlPatterns:s,icons:o})),a&&d.push(await bn({id:"search_allEngines_2",title:t,contexts:["image"],documentUrlPatterns:[a],icons:o})),e.isSamsung||(d.push(await bn({id:"sep_3",contexts:n,type:"separator",documentUrlPatterns:s})),a&&d.push(await bn({id:"sep_4",type:"separator",contexts:["image"],documentUrlPatterns:[a]})))}for(const e of l){const t=(0,lt.q4)(`menuItemTitle_${e}`),o=i&&Ut(e,{variant:r});d.push(await bn({id:`search_${e}_1`,title:t,contexts:n,documentUrlPatterns:s,icons:o})),a&&d.push(await bn({id:`search_${e}_2`,title:t,contexts:["image"],documentUrlPatterns:[a],icons:o}))}}return d}():[];await N.Ay.set({menuItems:i.map((e=>e.id))},{context:e});try{for(const e of i)await mn(e)}catch(e){await async function(){await browser.contextMenus.removeAll()}();for(const e of i)await mn(e);throw(0,lt.Jh)("createMenuError")&&await wn(),e}}async function wn(){["chrome","edge","opera"].includes(dt.Dm)&&await N.Ay.set({menuChangeEvent:Date.now()},{area:dt.tn?"session":"local",context:{name:"private",active:!browser.extension.inIncognitoContext}})}async function bn({id:e,title:t="",contexts:n,parent:i,type:r="normal",documentUrlPatterns:s,targetUrlPatterns:a,icons:o}){const c={id:e,title:t,contexts:n,parentId:i,type:r};return browser.extension.inIncognitoContext&&(c.id+="_private"),s&&(c.documentUrlPatterns=s),a&&(c.targetUrlPatterns=a),o&&(c.icons=o),c}async function vn(t,n){const i=t.session.sourceTabId;await Tt({tabId:i,module:"base"})?(await Tt({tabId:i,module:"content"})||await(0,lt.HG)({files:["/src/content/script.js"],tabId:i}),await async function({target:t="runtime",tabId:n,frameId:i,messagePort:r,message:s,transferResponse:a=!1,openConnection:o=!1}={}){let c;if(!a)try{if("runtime"===t)return await browser.runtime.sendMessage(s);if("tab"===t)return await browser.tabs.sendMessage(n,s,{frameId:i});if("port"===t)return r.postMessage(s)}catch(e){c=e}const u=(0,e.A)(),l=Kt(),d=JSON.stringify(s),g=Boolean(c)||d.length>l,f=!Boolean(r);if(o){(r=browser.runtime.connect({name:`message_${u}`})).postMessage({id:"safari 18 regression"});const e=Gt({port:r,checkMessage:function(e){if(e.transfer?.id===u&&"connection"===e.transfer.type&&e.transfer.complete)return!0}});await e}return new Promise((async(e,c)=>{let m=[];const p=function(e){if(e.transfer?.id===u)if("chunkedMessage"===e.transfer?.type){for(const e of(0,lt.bK)(d,l))r.postMessage({transfer:{type:"chunkedMessage",data:e,id:u}});r.postMessage({transfer:{type:"chunkedMessage",complete:!0,id:u}})}else"chunkedResponse"===e.transfer?.type?e.transfer.complete?m=JSON.parse(m.join("")):m.push(e.transfer.data):"response"===e.transfer?.type&&(m=e.transfer.data)};let h;r?r.onMessage.addListener(p):(h=function(e){e.name===u&&((r=e).onMessage.addListener(p),self.setTimeout((function(){r.postMessage({transfer:{type:"connection",complete:!0,id:u}})}),100))},browser.runtime.onConnect.addListener(h));const w=function(e){if(h&&browser.runtime.onConnect.removeListener(h),r&&(r.onMessage.removeListener(p),f))try{r.disconnect()}catch(e){}e&&c(e)};let b=null;try{const e={transferId:u,transferMessage:g,transferResponse:a,openConnection:!o},c=g?{transfer:e}:{...s,transfer:e};if("runtime"===t)b=await browser.runtime.sendMessage(c);else if("tab"===t)b=await browser.tabs.sendMessage(n,c,{frameId:i});else if("port"===t){const e=Gt({port:r,checkMessage:function(e){if(e.transfer?.id===u&&"message"===e.transfer.type&&e.transfer.complete)return!0}});r.postMessage(c),await e}}catch(e){w(e)}w(),e(a?m:b)}))}({target:"tab",tabId:i,frameId:0,message:{id:"openView",...t,view:n}})):await St({messageId:"error_scriptsNotAllowed"})}async function yn(e){return(0,lt.HG)({func:()=>{"undefined"!=typeof addTouchListener&&(self.addTouchListener(),self.showPointer())},code:"\n      if (typeof addTouchListener !== 'undefined') {\n        addTouchListener();\n        showPointer();\n      }\n    ",tabId:e,allFrames:!0})}async function xn(e){return(0,lt.HG)({func:()=>{"undefined"!=typeof removeTouchListener&&(self.removeTouchListener(),self.hidePointer())},code:"\n      if (typeof removeTouchListener !== 'undefined') {\n        removeTouchListener();\n        hidePointer();\n      }\n    ",tabId:e,allFrames:!0})}async function In(e,t){["chrome","opera"].includes(dt.Dm)&&async function(){if(/ opr\//i.test(navigator.userAgent)){const{lastEngineAccessCheck:e}=await N.Ay.get("lastEngineAccessCheck");if(Date.now()-e>6048e5){await N.Ay.set({lastEngineAccessCheck:Date.now()});const e="https://www.google.com/generate_204";let t=!1;if(dt.tn){const n=Rt({reserved:!0});await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:n,addRules:[{id:n[0],action:{type:"redirect",redirect:{transform:{path:""}}},condition:{urlFilter:e,initiatorDomains:[(0,lt.wT)()],resourceTypes:["xmlhttprequest"]}}]});const i=await fetch(e,{redirect:"manual",credentials:"omit"}).catch((e=>null));i&&"opaqueredirect"===i.type&&(t=!0),await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:n})}else await new Promise((n=>{function i(){return t=!0,r(),{cancel:!0}}const r=function(){self.clearTimeout(s),browser.webRequest.onBeforeRequest.removeListener(i),n()},s=self.setTimeout(r,3e3);browser.webRequest.onBeforeRequest.addListener(i,{urls:[e],types:["xmlhttprequest"]},["blocking"]),fetch(e).catch((e=>null))}));t||await St({messageId:"error_noSearchEngineAccess"})}}}(),Array.isArray(t)||(t=[t]);const n=await browser.tabs.get(e.sourceTabId);e.sourceTabIndex=n.index;let i=!0;for(const n of t)await kn(e,n,i),i=!1}async function kn(e,t,n=!0){let i,r=n;if(n){const t=await Pt();t&&(i=t.id,e.sourceTabIndex=t.index,r=!1)}r=!e.options.tabInBackgound&&r;const s=await async function(e,t,n){const i=[];for(const r of t)(e.hasOwnProperty("imageDataUrl")||e.hasOwnProperty("imageUrl")&&await _t(r,{bypassBlocking:"url"!==n}))&&i.push(r);return i}(t,e.engines,e.searchMode);e.engines.filter((e=>!s.includes(e))).length&&await St({messageId:"error_invalidSearchMethod",type:"unsupportedError"});const a=await async function(e,t,n){const i=[];for(const r of t){const t=!Ht(e.imageType,r),s=await kt(e,r,n,t)?"image":"url",a=mt[r][s].isExec,o=mt[r][s].isTaskId;i.push({engine:r,assetType:s,isExec:a,isTaskId:o,isAltImage:t,sendsReceipt:a||o})}return i}(t,s,e.searchMode),o=a.filter((e=>e.isAltImage));let c,u;o.length&&(c=await async function(e,{newType:t="",maxSize:n=1/0,maxDimension:i=1/0,getFile:r=!1,setBlob:s=!1,throwError:a=!1}={}){try{const a=await async function({blob:e,dataUrl:t,currentType:n="",currentSize:i=0,newType:r="",maxSize:s=1/0,maxDimension:a=1/0,getBlob:o=!1}={}){s!==1/0&&(i||(e||(e=(0,lt.aU)(t)),i=e.size),a===1/0&&(a=function({maxSize:e=1/0}={}){return e&&e!==1/0?e>=8388608?1680:e>=4194304?1280:880:1/0}({maxSize:s}))),n||(n=e?.type||(0,lt.cD)(t)),r||(r=n);const c=await Bt({url:t,blob:e});let u=c.naturalWidth,l=c.naturalHeight;for(;n!==r||i>s||u>a||l>a;){const{width:t,height:n}=qt(u,l,{maxDimension:a}),{cnv:d,ctx:g}=(0,lt.dX)(t,n);if("image/jpeg"===r&&(g.fillStyle="#FFFFFF",g.fillRect(0,0,t,n)),g.drawImage(c,0,0,u,l,0,0,t,n),(o||s<1/0)&&(e=await(0,lt.PG)(d,{ctx:g,type:r,clear:!1})),!(s!==1/0&&(i=e.size)>s&&a>480))return o?e:await(0,lt.ZC)(d,{ctx:g,type:r});a-=200}return o&&!e&&(e=(0,lt.aU)(t)),o?e:t}({dataUrl:e.imageDataUrl,currentType:e.imageType,currentSize:e.imageSize,newType:t,maxSize:n,maxDimension:i,getBlob:!0});if(a){const t=Lt(a,{name:e.imageFilename});if(r)return t;const n=await zt(t);return s&&(n.imageBlob=a),n}}catch(e){if(console.log(e.toString()),a)throw e}}(t,{newType:"image/png"}),c&&(u=await dn.addStorageItem(c,{receipts:{expected:o.length,received:0},expiryTime:10,area:"indexeddb"})));const l=a.filter((e=>e.sendsReceipt&&(!u||!e.isAltImage)));let d;l.length&&(d=await dn.addStorageItem(t,{receipts:{expected:l.length,received:0},expiryTime:10,area:"indexeddb"}));let g=n;for(const n of a){let i,s;e.sourceTabIndex+=1,n.isAltImage&&u?(i=c,s=u):(i=t,s=d),await _n(e,n,i,s,r),g&&e.closeSourceTab&&(await browser.tabs.remove(e.sourceTabId),e.sourceTabId=-1,e.sourceTabIndex-=1),r=!1,g=!1}await(0,lt.m0)()&&i&&await browser.tabs.update(i,{active:!0})}async function _n(t,n,i,r,s){let a;n.sendsReceipt&&(a=await dn.addStorageItem({session:t,search:n,imageId:r},{receipts:{expected:1,received:0},expiryTime:10,isTask:!0}));const o=(0,e.A)(),c="samsung"===dt.Dm?(0,e.A)():"",u=await async function(e,t,n,i){const r=t.engine;let s=mt[r][t.assetType].target;if(t.isTaskId&&(s=s.replace("{id}",i)),"url"===t.assetType){let t=n.imageUrl;"ascii2d"!==r&&(t=encodeURIComponent(t)),s=s.replace("{imgUrl}",t),"google"!==r||e.options.localGoogle||(s=`${s}&gws_rd=cr&gl=US`)}return s}(t,n,i,a),l=[],d=await async function(e){if(await(0,lt.Fr)()){if("firefox"===dt.Dm&&["google","ikea"].includes(e))return"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36";if(["googleLens"].includes(e))return"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"}}(n.engine);d&&l.push({id:"setUserAgent",tabUrl:u,userAgent:d,beaconToken:c}),n.sendsReceipt&&l.push({id:"addTask",taskId:a});const g={tabUrl:c?(0,lt.bY)(c):u,keepHistory:!1};l.length&&(g.setupSteps=l),await dn.addStorageItem(g,{receipts:{expected:1,received:0},expiryTime:1,token:o}),c&&await dn.addStorageItem({tabUrl:u,keepHistory:!1},{receipts:{expected:1,received:0},expiryTime:1,token:c}),await(0,lt.aI)({token:o,index:t.sourceTabIndex,active:s})}async function En({tabId:e,tabUrl:t,userAgent:n,beaconToken:i}={}){if("samsung"===dt.Dm){function r(e){s(),fn({tabId:e.tabId,userAgent:n})}const s=function(){window.clearTimeout(a),browser.webRequest.onBeforeRequest.removeListener(r)},a=window.setTimeout(s,1e4);browser.webRequest.onBeforeRequest.addListener(r,{urls:[(0,lt.bY)(i)],types:["main_frame"]},["blocking"])}else await async function({tabId:e,tabUrl:t,userAgent:n}={}){const i=Rt()[0];"safari"===dt.Dm?(await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:[i],addRules:[{id:i,action:{type:"modifyHeaders",requestHeaders:[{header:"User-Agent",operation:"set",value:n}]},condition:{urlFilter:`${t}*`,resourceTypes:["font","image","main_frame","media","ping","script","stylesheet","sub_frame","websocket","xmlhttprequest","other"]}}]}),browser.alarms.create(`delete-net-request-session-rule_${i}`,{delayInMinutes:2})):dt.tn?(await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:[i],addRules:[{id:i,action:{type:"modifyHeaders",requestHeaders:[{header:"User-Agent",operation:"set",value:n}]},condition:{tabIds:[e],resourceTypes:["font","image","main_frame","media","ping","script","stylesheet","sub_frame","websocket","xmlhttprequest","other"]}}]}),browser.alarms.create(`delete-net-request-session-rule_${i}`,{delayInMinutes:2})):fn({tabId:e,userAgent:n})}({tabId:e,tabUrl:t,userAgent:n})}async function Sn(e){await Tt({tabId:e.sourceTabId,frameId:e.sourceFrameId,module:"parse"})||await(0,lt.HG)({files:["/src/parse/script.js"],tabId:e.sourceTabId,frameIds:[e.sourceFrameId]}),await browser.tabs.sendMessage(e.sourceTabId,{id:"parsePage",session:e},{frameId:e.sourceFrameId})}async function Tn(e,t){if("browse"===e.searchMode){const t=browser.runtime.getURL("/src/browse/index.html"),n=await dn.addStorageItem(e,{receipts:{expected:1,received:0},expiryTime:1});await(0,lt.aI)({url:`${t}?id=${n}`,index:e.sourceTabIndex+1,openerTabId:await jt({tabId:e.sourceTabId})})}else if("capture"===e.searchMode)await vn({session:e},"capture");else if(["selectUrl","selectImage"].includes(e.searchMode)){if(t.startsWith("file://")&&["safari","samsung"].includes(dt.Dm))return void await St({messageId:"error_invalidImageUrl_fileUrl"});await vn({session:e},"select"),await Tt({tabId:e.sourceTabId,module:"base"})&&await yn(e.sourceTabId)}}async function An(e){"samsung"===dt.Dm&&await(0,lt.kL)({tab:e})&&(e=await browser.tabs.get(e.id));const t=await Et({sessionOrigin:"action",sessionType:"search",sourceTabId:e.id,sourceTabIndex:e.index});if("url"===t.searchMode)return void await St({messageId:await(0,lt.Fr)()?"error_invalidSearchModeMobile_url":"error_invalidSearchMode_url"});const n=await It(t.options);n.length?("main"===t.options.searchAllEnginesAction&&n.length>1?(t.engineGroup="allEngines",t.engines=n):t.engines.push(n[0]),Tn(t,e.url)):await St({messageId:"error_allEnginesDisabled"})}async function jn(e,t){let n;if(t.hasOwnProperty("imageDataUrl")){const e=await dn.addStorageItem(t,{receipts:{expected:1,received:0},expiryTime:1,area:"memory"});n=`${browser.runtime.getURL("/src/view/index.html")}?id=${e}`}else n=t.imageUrl;await browser.tabs.create({url:n,index:e.sourceTabIndex+1})}async function Cn(){await hn(),await wn()}async function Mn(){const e=await N.Ay.get(["engines","disabledEngines","searchAllEnginesAction"]),t=await It(e),n=dt.tn?browser.action:browser.browserAction;return 1===t.length?(n.setTitle({title:(0,lt.q4)("actionTitle_engine",(0,lt.q4)(`menuItemTitle_${t[0]}`))}),void n.setPopup({popup:""})):"main"===e.searchAllEnginesAction&&t.length>1?(n.setTitle({title:(0,lt.q4)("actionTitle_allEngines")}),void n.setPopup({popup:""})):(n.setTitle({title:(0,lt.q4)("extensionName")}),void(t.length?n.setPopup({popup:"/src/action/index.html"}):n.setPopup({popup:""})))}async function On(e){return dn.getStorageItem({storageId:e,saveReceipt:!0})}async function Pn(e,t){if("cancelView"===e.id)"select"===e.view&&xn(t.tab.id),browser.tabs.sendMessage(t.tab.id,{id:"closeView",view:e.view},{frameId:0});else if("discardView"===e.id)"select"===e.view&&xn(t.tab.id);else if("actionPopupSubmit"===e.id)!async function(e,t,n){const{searchModeAction:i}=await N.Ay.get("searchModeAction"),r=await(0,lt.e6)(),s=await Et({sessionOrigin:"action",sessionType:"search",searchMode:i,sourceTabId:r.id,sourceTabIndex:r.index,engine:e});"browse"===i&&t?await In(s,t):"url"===i&&n?await In(s,{imageUrl:n}):Tn(s,r.url)}(e.engine,e.images,e.imageUrl);else if("imageBrowseSubmit"===e.id){const n=e.session;n.sourceTabId=t.tab.id,n.sourceTabIndex=t.tab.index,In(n,e.images)}else if("imageSelectionSubmit"===e.id)xn(t.tab.id),Sn(e.session);else if("imageConfirmationSubmit"===e.id)browser.tabs.sendMessage(t.tab.id,{id:"closeView",view:"confirm"},{frameId:0}),"search"===e.session.sessionType?await In(e.session,e.image):"view"===e.session.sessionType&&await jn(e.session,e.image);else if("imageCaptureSubmit"===e.id){const n=t.tab.id;browser.tabs.sendMessage(n,{id:"closeView",view:"capture"},{frameId:0});const i=await async function(e,t){const[n]=await(0,lt.HG)({func:()=>window.innerWidth,code:"window.innerWidth;",tabId:t});e={...e,surfaceWidth:n};return zt(Lt(await async function(e){const t=await browser.tabs.captureVisibleTab({format:"png"}),n=await Bt({url:t}),{left:i,top:r,width:s,height:a,surfaceWidth:o}=e,c=n.naturalWidth/o,{cnv:u,ctx:l}=(0,lt.dX)(s*c,a*c);return l.drawImage(n,i*c,r*c,u.width,u.height,0,0,u.width,u.height),(0,lt.PG)(u,{ctx:l})}(e)))}(e.area,n);In(e.session,i)}else if("pageParseSubmit"===e.id)"action"===e.session.sessionOrigin&&e.images.length<=1&&!e.images[0]?.mustConfirm&&browser.tabs.sendMessage(t.tab.id,{id:"closeView",view:"select"},{frameId:0}),async function(e,t){t.length?t.length>1||t[0].mustConfirm?await vn({session:e,images:t},"confirm"):"search"===e.sessionType?await In(e,t):"view"===e.sessionType&&await jn(e,t[0]):await St({messageId:"error_imageNotFound"})}(e.session,e.images);else if("initShare"===e.id)!async function(){const e=await(0,lt.e6)(),t=await Et({sessionOrigin:"action",sessionType:"share",sourceTabId:e.id,sourceTabIndex:e.index});await vn({session:t},"select"),await Tt({tabId:t.sourceTabId,module:"base"})&&await yn(t.sourceTabId)}();else if("initView"===e.id)!async function(){const e=await(0,lt.e6)(),t=await Et({sessionOrigin:"action",sessionType:"view",sourceTabId:e.id,sourceTabIndex:e.index});await vn({session:t},"select"),await Tt({tabId:t.sourceTabId,module:"base"})&&await yn(t.sourceTabId)}();else if("pageParseError"===e.id)"action"===e.session.sessionOrigin&&browser.tabs.sendMessage(t.tab.id,{id:"closeView",view:"select"},{frameId:0}),St({messageId:"error_pageParseError"});else{if("addContentRequestListener"===e.id)return async function({url:e,origin:t="",referrer:n="",tabId:i,token:r}={}){if(dt.tn){const r=Rt()[0],s={type:"modifyHeaders"},a=[];n&&a.push({header:"Referer",operation:"set",value:n});const o=[];return t&&o.push({header:"Access-Control-Allow-Origin",operation:"set",value:t},{header:"Access-Control-Allow-Credentials",operation:"set",value:"true"}),a.length&&(s.requestHeaders=a),o.length&&(s.responseHeaders=o),await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:[r],addRules:[{id:r,action:s,condition:{tabIds:[i],urlFilter:`${e}*`,resourceTypes:["xmlhttprequest","other"]}}]}),browser.alarms.create(`delete-net-request-session-rule_${r}`,{delayInMinutes:2}),r}{let t,i;const s=function(s){const a=s.requestHeaders.find((t=>"accept"===t.name.toLowerCase()&&t.value===r&&s.url===e&&"GET"===s.method));if(a&&(a.value="*/*"),a||s.requestId===t){if(t=s.requestId,n){const e=s.requestHeaders.find((e=>"referer"===e.name.toLowerCase()));e?e.value=n:s.requestHeaders.push({name:"Referer",value:n})}const e=s.requestHeaders.find((e=>"origin"===e.name.toLowerCase()));return e&&(i=e.value),{requestHeaders:s.requestHeaders}}},a=["blocking","requestHeaders"];"firefox"!==dt.Dm&&a.push("extraHeaders"),browser.webRequest.onBeforeSendHeaders.addListener(s,{urls:["<all_urls>"],types:["xmlhttprequest"]},a);const o=function(e){if(e.requestId===t&&i){const t=e.responseHeaders.find((e=>"access-control-allow-origin"===e.name.toLowerCase()));t?t.value=i:e.responseHeaders.push({name:"Access-Control-Allow-Origin",value:i});const n=e.responseHeaders.find((e=>"access-control-allow-credentials"===e.name.toLowerCase()));return n?n.value="true":e.responseHeaders.push({name:"Access-Control-Allow-Credentials",value:"true"}),{responseHeaders:e.responseHeaders}}},c=["blocking","responseHeaders"];"firefox"!==dt.Dm&&c.push("extraHeaders"),browser.webRequest.onHeadersReceived.addListener(o,{urls:["<all_urls>"],types:["xmlhttprequest"]},c);const u=function(e){e.requestId===t&&l()},l=function(){window.clearTimeout(d),browser.webRequest.onBeforeSendHeaders.removeListener(s),browser.webRequest.onHeadersReceived.removeListener(o),browser.webRequest.onCompleted.removeListener(u),browser.webRequest.onErrorOccurred.removeListener(u)},d=window.setTimeout(l,12e4);browser.webRequest.onCompleted.addListener(u,{urls:["<all_urls>"],types:["xmlhttprequest"]}),browser.webRequest.onErrorOccurred.addListener(u,{urls:["<all_urls>"],types:["xmlhttprequest"]})}}({url:e.url,origin:e.origin,referrer:e.referrer,tabId:t.tab.id,token:e.token});if("removeContentRequestListener"===e.id)await async function({ruleId:e}={}){dt.tn&&(await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:[e]}),await browser.alarms.clear(`delete-net-request-session-rule_${e}`))}({ruleId:e.ruleId});else{if("fetchImage"===e.id){const t=await Vt(e.url),n=t&&await(0,lt.GW)(t);return Promise.resolve(n)}if("notification"===e.id)St({message:e.message,messageId:e.messageId,title:e.title,type:e.type});else if("routeMessage"===e.id){const n=e.message;e.setSenderTabId&&(n.senderTabId=t.tab.id),e.setSenderFrameId&&(n.senderFrameId=t.frameId);const i=[e.messageTabId?e.messageTabId:t.tab.id,n];e.hasOwnProperty("messageFrameId")&&i.push({frameId:e.messageFrameId}),browser.tabs.sendMessage(...i)}else{if("sendNativeMessage"===e.id){const t=await browser.runtime.sendNativeMessage("application.id",e.message);return Promise.resolve({response:t})}if("getPlatform"===e.id)return(0,lt.uo)();if("storageRequest"===e.id){const n=await dn.getStorageItem({storageId:e.storageId,saveReceipt:e.saveReceipt});if(n){if(e.asyncResponse)return Promise.resolve(n);browser.tabs.sendMessage(t.tab.id,{id:"storageResponse",storageItem:n},{frameId:t.frameId})}}else if("storageReceipt"===e.id)for(const t of e.storageIds)await dn.saveStorageItemReceipt({storageId:t});else if("taskRequest"===e.id){const e=await dn.getTaskRegistryItem({tabId:t.tab.id});if(e&&Date.now()-e.addTime<6e5){const n=await dn.getStorageItem({storageId:e.taskId});n&&n.search.isExec&&async function(e,t,n){["bing"].includes(t)&&await(0,lt.$u)({files:[`/src/engines/css/${t}.css`],tabId:e}),await(0,lt.HG)({func:e=>self.taskId=e,args:[n],code:`self.taskId = '${n}'`,tabId:e}),await(0,lt.HG)({files:["/src/commons-engine/script.js"],tabId:e}),await(0,lt.HG)({files:[`/src/engines/${t}/script.js`],tabId:e})}(t.tab.id,n.search.engine,e.taskId)}}else if("optionChange"===e.id)await async function(){await Rn()}();else if("searchImage"===e.id){const{session:t,search:n,image:i}=e;"image"===n.assetType&&(i.imageBlob=(0,lt.aU)(i.imageDataUrl));try{let e;return"google"===n.engine?e=await async function({session:e,search:t,image:n}={}){const i=new FormData;i.append("encoded_image",n.imageBlob,n.imageFilename),i.append("image_url",""),i.append("sbisrc","Google Chrome 110.0.5481.78 (Official) Windows");const r=await fetch("https://www.google.com/searchbyimage/upload",{referrer:"",mode:"cors",method:"POST",body:i});let s;if(200===r.status)s=r.url;else{if(!n.imageUrl)throw new Error(`API response: ${r.status}, ${await r.text()}`);s="https:www.google.com/searchbyimage?sbisrc=cr_1_5_2&image_url="+encodeURIComponent(n.imageUrl)}return e.options.localGoogle||(s=s.replace(/(.*google\.)[a-zA-Z0-9_\-.]+(\/.*)/,"$1com$2&gws_rd=cr&gl=US")),s}({session:t,search:n,image:i}):"pinterest"===n.engine&&(e=await async function({session:e,search:t,image:n}={}){const i=new FormData;i.append("image",n.imageBlob,n.imageFilename),i.append("x","0"),i.append("y","0"),i.append("w","1"),i.append("h","1"),i.append("base_scheme","https");const r=await fetch("https://api.pinterest.com/v3/visual_search/extension/image/",{referrer:"",mode:"cors",method:"PUT",body:i}),s=await r.json();if(200!==r.status||"success"!==s.status||!s.data||!s.data.length)throw new Error("search failed");return s.data.map((e=>({page:`https://pinterest.com/pin/${e.id}/`,image:e.image_large_url,text:e.description})))}({session:t,search:n,image:i})),Promise.resolve({data:e})}catch(e){return Promise.resolve({error:e.toString()})}}else if("showPage"===e.id)await Ct({url:e.url});else{if("setupTab"===e.id)return async function(e,t){const n={};for(const i of t)"setUserAgent"===i.id?(await En({tabId:e.tab.id,tabUrl:i.tabUrl,userAgent:i.userAgent,beaconToken:i.beaconToken}),n[i.id]=""):"addTask"===i.id&&(await dn.addTaskRegistryItem({taskId:i.taskId,tabId:e.tab.id}),n[i.id]="");return n}(t,e.steps);if("executeScript"===e.id){const n=e.params;return e.setSenderTabId&&(n.tabId=t.tab.id),e.setSenderFrameId&&(n.frameIds=[t.frameId]),n.func&&(n.func=(0,Xt.y)(n.func)),(0,lt.HG)(n)}if("addStorageItem"===e.id){const t=await dn.addStorageItem(e.data,e.params);return Promise.resolve(t)}}}}}}async function Rn(){const e=[Mn];await async function(){if(await(0,lt.m0)()){if("samsung"===dt.Dm)return!0}else if(browser.contextMenus)return!0;return!1}()&&e.push(Cn),await gn.addAll(e)}async function Un({event:e=""}={}){const t=await async function({event:e=""}={}){Mt||(Mt=async function(){const e={install:!1,update:!1,session:!1,setupInstance:!1,setupSession:!1},{storageVersion:t,appVersion:n}=await browser.storage.local.get(["storageVersion","appVersion"]);return t||(e.install=!0),t===dt.QB.local&&n===dt.CU||(e.update=!0),dt.tn&&await async function(){const e=browser.extension.inIncognitoContext,t=e?"privateSession":"session",n=(await browser.storage.session.get(t))[t];if(n||await browser.storage.session.set({[t]:!0}),e)try{if(!await self.caches.has(t))return await self.caches.open(t),!0}catch(e){return!0}if(!n)return!0}()&&(e.session=!0),(e.install||e.update)&&(e.setupInstance=!0),!e.session&&dt.tn||(e.setupSession=!0),e}(),Mt.events=[]),e&&Mt.events.push(e);const t=await Mt;return Mt.events.includes("install")&&(t.setupInstance=!0),Mt.events.includes("startup")&&(t.setupSession=!0),t}({event:e});t.setupInstance&&await(0,lt.Jh)("setupInstance",(async()=>{await(0,N.XL)()||await V({data:t}),["chrome","edge","opera","samsung"].includes(dt.Dm)&&await At(),t.update&&await async function(){await N.Ay.set({appVersion:dt.CU})}()})),t.setupSession&&await(0,lt.Jh)("setupSession",(async()=>{dt.tn&&!await(0,N.XL)({area:"session"})&&await V({area:"session",silent:!0}),["samsung"].includes(dt.Dm)&&!t.setupInstance&&await At({activeTab:!0}),await Rn(),await dn.cleanupRegistry()}))}browser.contextMenus&&browser.contextMenus.onClicked.addListener((async function(e,t){"samsung"===dt.Dm&&await(0,lt.kL)({tab:t})&&(t=await browser.tabs.get(t.id));const[n,i]=e.menuItemId.split("_"),r={sessionOrigin:"context",sessionType:n,sourceTabId:t.id,sourceTabIndex:t.index,sourceFrameId:void 0!==e.frameId?e.frameId:0};"search"===n&&(r.engine=i);const s=await Et(r);if("view"===n)if(await Tt({tabId:s.sourceTabId,frameId:s.sourceFrameId,module:"base"}))await Sn(s);else{let t;const n=$t(e);n&&(t=await Wt(n,{session:s})),t?await jn(s,t):await St({messageId:"error_scriptsNotAllowed"})}else if("share"===n)await Tt({tabId:s.sourceTabId,frameId:s.sourceFrameId,module:"base"})?await Sn(s):await St({messageId:"error_scriptsNotAllowed"});else if("search"===n)if("capture"===s.searchMode)await Tt({tabId:s.sourceTabId,frameId:s.sourceFrameId,module:"base"})?await vn({session:s},"capture"):await St({messageId:"error_scriptsNotAllowed"});else if(await Tt({tabId:s.sourceTabId,frameId:s.sourceFrameId,module:"base"}))await Sn(s);else{let t;const n=$t(e);n&&(t=await Wt(n,{session:s})),t?await In(s,t):await St({messageId:"error_scriptsNotAllowed"})}})),dt.tn?browser.action.onClicked.addListener(An):browser.browserAction.onClicked.addListener(An),browser.runtime.onMessage.addListener((function(e,t,n){return function(e,t){return"safari"===dt.Dm?(e.then((function(e){void 0===e&&(e=null),t(e)})),!0):e}(async function({request:e,sender:t,requestHandler:n,messagePortProvider:i}={}){if(e.transfer?.type)return;if(t.url===self.location.href)return;"samsung"===dt.Dm&&(/^internet-extension:\/\/.*\/src\/action\/index.html/.test(t.tab?.url)&&(t.tab=null),await(0,lt.kL)({tab:t.tab})&&(t.tab=await browser.tabs.get(t.tab.id)));const r=e.transfer;if(!r)return n(e,t);{const s=r.transferId,a="function"==typeof t.disconnect;let o;if(a)o=t;else if(r.openConnection){o=t.tab?browser.tabs.connect(t.tab.id,{name:s,frameId:t.frameId}):browser.runtime.connect({name:s}),o.postMessage({id:"safari 18 regression"});const e=Gt({port:o,checkMessage:function(e){if(e.transfer?.id===s&&"connection"===e.transfer.type&&e.transfer.complete)return!0}});await e}else o=await i(s);r.transferMessage&&(e=await new Promise(((e,t)=>{const n=[],i=function(t){t.transfer?.id===s&&"chunkedMessage"===t.transfer?.type&&(t.transfer.complete?(r(),e(JSON.parse(n.join("")))):n.push(t.transfer.data))},r=function({throwError:e=!1}={}){self.clearTimeout(c),o.onDisconnect.removeListener(a),o.onMessage.removeListener(i),e&&t()},a=function(){r({throwError:!0})};o.onDisconnect.addListener(a);const c=self.setTimeout(a,12e4);o.onMessage.addListener(i),o.postMessage({transfer:{type:"chunkedMessage",id:s}})})),a&&o.postMessage({transfer:{type:"message",complete:!0,id:s}}));let c=await n(e,t);if(!a){if(!r.transferResponse)return c;void 0===c&&(c=null);try{o.postMessage({transfer:{type:"response",data:c,id:s}})}catch(e){const t=Kt(),n=JSON.stringify(c);for(const e of(0,lt.bK)(n,t))o.postMessage({transfer:{type:"chunkedResponse",data:e,id:s}});o.postMessage({transfer:{type:"chunkedResponse",complete:!0,id:s}})}}}}({request:e,sender:t,requestHandler:Pn,messagePortProvider:On}),n)})),browser.runtime.onConnect.addListener((function(e){!async function(e){if(e.name?.startsWith("message")){const t=e.name.split("_")[1];await async function(e,t){await dn.addStorageItem(t,{receipts:{expected:1,received:0},expiryTime:1,area:"memory",token:e})}(t,e),self.setTimeout((function(){e.postMessage({transfer:{type:"connection",complete:!0,id:t}})}),100)}}(e)})),browser.storage.onChanged.addListener((async function(e,t){if(await(0,N.XL)({area:dt.tn?"session":"local"})){const t=(0,N.eK)("menuChangeEvent",{name:"private",active:browser.extension.inIncognitoContext});e[t]?.newValue&&await gn.add(hn)}})),browser.alarms.onAlarm.addListener((async function({name:e}){if(e.startsWith("delete-storage-item")){const t=e.split("_")[1];await dn.deleteStorageItem({storageId:t})}else if(e.startsWith("delete-net-request-session-rule")){const t=(0,lt.s_)(e.split("_")[1]);await browser.declarativeNetRequest.updateSessionRules({removeRuleIds:[t]})}})),browser.runtime.onInstalled.addListener((async function(e){["install","update"].includes(e.reason)&&await Un({event:"install"})})),browser.runtime.onStartup.addListener((async function(){await Un({event:"startup"})})),["safari"].includes(dt.Dm)&&browser.tabs.onReplaced.addListener((async function(e,t){await async function({addedTabId:e,removedTabId:t}={}){return(0,lt.JU)("tab_revisions",(async()=>{const{tabRevisions:n}=await N.Ay.get("tabRevisions",{area:"session"});let i=!1;for(const r of n)if(r.includes(t)){r.push(e),i=!0;break}i||n.push([t,e]),await N.Ay.set({tabRevisions:n},{area:"session"})}))}({addedTabId:e,removedTabId:t})})),Un()})()})();