!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./",n(n.s=48)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r={getBrowser:function(){return window.chrome||chrome||browser}};t.a=r},function(e,t,n){var r=n(22);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(30).default,a=n(31);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?a(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=function(){function e(t){a()(this,e),this.target=t,this.events={}}return i()(e,[{key:"addListener",value:function(e,t,n){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push({caller:t,thisArg:n||this.target})}},{key:"addExclusiveListener",value:function(e,t,n){this.events[e]=[],this.events[e].push({caller:t,thisArg:n||this.target})}},{key:"dispatch",value:function(e,t){var n="[object Array]"===Object.prototype.toString.call(t)?t:[];this.events[e]&&this.events[e].forEach((function(e){e.caller.apply(e.thisArg,n)}))}},{key:"removeEventListener",value:function(e,t){var n=this;this.events[e]&&this.events[e].forEach((function(r,a){r.caller===t&&delete n.events[e][a]}))}},{key:"removeListener",value:function(e,t){this.removeEventListener(e,t)}},{key:"removeEventListeners",value:function(e){this.events[e]=[]}}]),e}();t.a=s},function(e,t,n){"use strict";var r=n(18);t.a=function(e,t,n){var a={win:{illegals:["<",">",":",'"',"/","\\","|","?","*"],max:200},linux:{illegals:["/","@","#","$","&","'"],max:256},unix:{illegals:["/"],max:256}},o="";if(n+="",e){var i=e.match(/\{[a-z]+\}/gi),s=e;i&&i.length>0&&i.forEach((function(e){var n=e.slice(1,-1),a=function(e,t){var n=r.a.getI18n(),a={id:{content:n.getMessage("id"),key:"illustId",possibleKeys:["illustId","novelId","postId"]},title:{content:n.getMessage("title"),key:"illustTitle",possibleKeys:["illustTitle","novelTitle","postTitle"]},author:{content:n.getMessage("author"),key:"userName",possibleKeys:["userName","illustAuthor"]},authorId:{content:n.getMessage("author_id"),key:"userId",possibleKeys:["userId","illustAuthorId"]},pageNum:{content:n.getMessage("page_num"),key:"pageNum",possibleKeys:["pageNum"]},year:{content:n.getMessage("year"),key:"year",possibleKeys:["year"]},month:{content:n.getMessage("month"),key:"month",possibleKeys:["month"]},day:{content:n.getMessage("day"),key:"day",possibleKeys:["day"]}}[t];if(a)for(var o=a.possibleKeys,i=0,s=o.length;i<s;i++)if(void 0!==e[o[i]])return e[o[i]]}(t,n);void 0!==a&&(s=s.replace(e,a))})),o=s||n}else o=n;return a.win.illegals.concat(a.linux.illegals,a.unix.illegals,"~").forEach((function(e){for(;o.indexOf(e)>-1;)o=o.replace(e,"_")})),0===(o=(o=o.replace(/\.*$/,"")).substr(0,a.win.max)).length?"file_".concat(Date.now()):o}},function(e,t,n){"use strict";function r(e,t,n,r,a,o,i,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),r&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),i?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=l):a&&(l=s?function(){a.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var h=u.beforeCreate;u.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:u}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(5),l=n.n(s),u=n(6),c=n.n(u),h=n(2),f=n.n(h),d=n(3),p=n.n(d);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return c()(this,n)}}var v=function(e){l()(n,e);var t=g(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a()(this,n),(r=t.call(this)).url=e,r.fetchInit=Object.assign({readAsStream:!0},o),r.fetchAbortController=null,r.fetchFallbackAbortSignal=!1,r.response=null,r.responseContentLength=null,r.responseLoadedLength=0,r.responseData=null,r.responseType="arrayBuffer",window.AbortController&&(r.fetchAbortController=new AbortController,r.fetchInit.signal=r.fetchAbortController.signal),r}return i()(n,[{key:"abort",value:function(){this.fetchAbortController&&this.fetchAbortController.abort(),this.fetchFallbackAbortSignal=!0}},{key:"readData",value:function(e){var t=this;this.fetchFallbackAbortSignal?this.dispatch("onerror",[new Error("Request aborted")]):setTimeout((function(){e.read().then((function(n){var r=n.done,a=n.value;if(r)t.dispatch("onload",["arrayBuffer"===t.responseType?new Uint8Array(t.responseData):t.responseData]);else{if("plain"===t.responseType)for(var o=0;;){var i=a.slice(o,o+1e4);if(o+=1e4,!(i.length>0))break;t.responseData+=String.fromCharCode.apply(null,i)}else"arrayBuffer"===t.responseType&&a.forEach((function(e){t.responseData.push(e)}));t.responseLoadedLength+=a.length,t.dispatch("ondata",[a]),t.dispatch("onprogress",[{totalLength:t.responseContentLength,loadedLength:t.responseLoadedLength}]),t.readData(e)}})).catch((function(e){t.dispatch("onerror",[e])}))}))}},{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=this.fetchInit.method.toUpperCase();"HEAD"!==r&&"GET"!==r&&t&&(this.fetchInit.body=t),n.globalOptions.headers&&(this.fetchInit.headers?Object.assign(this.fetchInit.headers,n.globalOptions.headers):this.fetchInit.headers=n.globalOptions.headers),fetch(this.url,this.fetchInit).then((function(t){e.response=t;var n=e.getResponseHeader("Content-Length");switch(n&&(e.responseContentLength=parseInt(n)),e.responseType){case"plain":e.responseData="";break;case"arrayBuffer":default:e.responseData=[]}e.readData(e.response.body.getReader())})).catch((function(t){e.dispatch("onerror",[t])}))}},{key:"getResponseHeader",value:function(e){return this.response&&this.response.headers.has(e)?this.response.headers.get(e):null}}],[{key:"setGlobalOptions",value:function(e){n.globalOptions=e}}]),n}(n(7).a);p()(v,"globalOptions",{}),t.a=v},function(e,t,n){"use strict";var r={props:{text:[String,Number],href:String,download:String,title:String,type:{required:!1,type:String}},computed:{buttonColor:function(){return this.type?"button--".concat(this.type):null}}},a=(n(36),n(9)),o=Object(a.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{staticClass:"button",class:e.buttonColor,attrs:{href:e.href,download:e.download,title:e.title},on:{click:function(t){return e.$emit("click")}}},[e._t("default",(function(){return[e._v(e._s(e.text))]}))],2)}),[],!1,null,"f63c183a",null);t.a=o.exports},function(e,t){e.exports=Vue},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(16),l=n.n(s),u=n(5),c=n.n(u),h=n(6),f=n.n(h),d=n(2),p=n.n(d);function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var v=function(e){c()(n,e);var t=g(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a()(this,n),(r=t.call(this,e,o)).asBlob=!0,r}return i()(n,[{key:"addListener",value:function(e,t,r){l()(p()(n.prototype),"addListener",this).call(this,e,t,r)}},{key:"download",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this;this.addListener("onload",(function(e){t.dispatch("onfinish",[t.asBlob?new Blob([e.buffer],{type:t.getResponseHeader("Content-Type")}):e.buffer])})),this.send(e)}}]),n}(n(10).a);t.a=v},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=function(){function e(t){a()(this,e),this.date=new Date(t)}return i()(e,[{key:"paddingZero",value:function(e){return(e<10?"0":"")+e}},{key:"getYear",value:function(){return this.date.getFullYear()+""}},{key:"getMonth",value:function(){return this.paddingZero(this.date.getMonth()+1)}},{key:"getDay",value:function(){return this.paddingZero(this.date.getDate())}}],[{key:"getDefault",value:function(t){if(NaN===Date.parse(t))throw Error("Invalid date time");return new e(t)}}]),e}();t.a=s},function(e,t,n){"use strict";var r=n(21),a=chrome||browser,o=n(8);t.a={methods:{downloadFile:function(e,t,n){var o=this,i=n.folder,s=void 0===i?null:i,l=n.statType,u=void 0===l?null:l,c=this,h=null;if(e instanceof Blob&&(h=e,e=URL.createObjectURL(e)),this.browserItems.enableExtTakeOverDownloads)r.b.contains({permissions:["downloads"]}).then((function(n){if(n){var i="";if(s?i+=s:c.browserItems.downloadRelativeLocation&&(i+=c.browserItems.downloadRelativeLocation),i+=t,o.isFirefox&&h){var l=new FileReader;l.readAsArrayBuffer(h),l.onload=function(e){a.runtime.sendMessage({action:"download",options:{arrayBuffer:l.result,filename:i,saveAs:c.browserItems.downloadSaveAs}})}}else r.a.download({url:e,filename:i,saveAs:c.browserItems.downloadSaveAs})}else alert("You need grant download permission for downloading using downlads setting in extension")}));else{var f=document.createElement("a");f.setAttribute("href",e),f.setAttribute("download",t),document.body.appendChild(f),f.click(),f.remove()}u&&a.runtime.sendMessage({action:"updateDownloadedStat",args:u})},getSubfolder:function(e,t){var n="";if(e){var r=e.split("/");n=(r=r.map((function(e){return""===e?"":Object(o.a)(e,t,e)}))).join("/")}return n}}}},function(e,t,n){var r=n(32);function a(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=a=Reflect.get,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=a=function(e,t,n){var a=r(e,t);if(a){var o=Object.getOwnPropertyDescriptor(a,t);return o.get?o.get.call(n):o.value}},e.exports.default=e.exports,e.exports.__esModule=!0),a(t,n,o||t)}e.exports=a,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(3),l=n.n(s),u=function(){function e(){a()(this,e)}return i()(e,null,[{key:"getExtenstion",value:function(t){for(var n=[],r=0,a=(n=(t=t.toLowerCase()).indexOf("; ")>-1?t.split("; "):[t]).length;r<a;r++)if(e.types[n[r]])return e.types[n[r]];return null}}]),e}();l()(u,"types",{"image/png":"png","image/gif":"gif","image/jpeg":"jpg","image/jpg":"jpg","text/plain":"txt","text/html":"html","application/json":"json"}),t.a=u},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(3),l=n.n(s),u=n(4),c=function(){function e(){a()(this,e),this.i18n=u.a.getBrowser().i18n}return i()(e,null,[{key:"getInstance",value:function(){return e.instance?e.instance:e.instance=new e}},{key:"getI18n",value:function(){return e.getInstance().i18n}}]),e}();l()(c,"instance",void 0),t.a=c},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(5),l=n.n(s),u=n(6),c=n.n(u),h=n(2),f=n.n(h),d=n(7);function p(e){this.maxTry=e,this.tryTimes=0}p.prototype={reset:function(){this.retryTimes=0},reachLimit:function(){return!(this.tryTimes<this.maxTry)||(this.tryTimes++,!1)}};var g=p;function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var a=f()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return c()(this,n)}}var m=function(e){l()(n,e);var t=v(n);function n(e){var r,o=e.maxTime,i=void 0===o?3:o;return a()(this,n),(r=t.call(this)).retryTicker=new g(i),r.process=null,r}return i()(n,[{key:"getRetryTime",value:function(){return this.retryTicker.tryTimes}},{key:"runProcess",value:function(){var e=this,t=this.process(this);if(t instanceof Promise)return new Promise((function(n,r){t.then((function(e){return n(e)})).catch((function(t){return e.retryTicker.reachLimit()?r(t):(e.dispatch("onretry",[t]),n(e.retry()))}))}))}},{key:"retry",value:function(){return this.runProcess()}},{key:"start",value:function(e){return this.process=e,this.runProcess()}}]),n}(d.a);t.a=m},function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(16),l=n.n(s),u=n(5),c=n.n(u),h=n(6),f=n.n(h),d=n(2),p=n.n(d),g=n(13),v=n(7),m=n(23);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var w=function(e){c()(n,e);var t=_(n);function n(e){var r,o=e.processors,i=void 0===o?1:o,s=e.requestOptions,l=void 0===s?{}:s;return a()(this,n),(r=t.call(this)).processors=i,r.requestOptions=l,r.files=[],r.successIndexes=[],r.failIndexes=[],r.progresses=[],r.queue=null,r.asBlob=!0,r}return i()(n,[{key:"dispatch",value:function(e,t){l()(p()(n.prototype),"dispatch",this).call(this,e,t)}},{key:"addListener",value:function(e,t,r){l()(p()(n.prototype),"addListener",this).call(this,e,t,r)}},{key:"abort",value:function(){this.queue.abort()}},{key:"download",value:function(){var e=this;this.queue=new m.a,this.queue.setProcessors(this.processors),this.queue.onDone=function(){e.dispatch("finish")},this.files.forEach((function(t,n){e.queue.add({file:t,index:n})})),this.queue.start((function(t){var n=t.file,r=t.index;return new Promise((function(t,a){var o=new g.a(n,Object.assign({method:"GET"},e.requestOptions));o.asBlob=e.asBlob,o.addListener("onprogress",(function(t){var n=t.totalLength,a=t.loadedLength;e.progresses[r]=a/n,e.dispatch("progress",[{progress:e.progresses.reduce((function(e,t){return e+t}))/e.files.length,successCount:e.successIndexes.length,failCount:e.failIndexes.length}])})),o.addListener("onfinish",(function(n){e.successIndexes.push(r),e.dispatch("item-finish",[{blob:e.asBlob?n:null,data:e.asBlob?null:n,index:r,download:o}]),t()})),o.addListener("onerror",(function(t){e.failIndexes.push(r),e.progresses[r]=0,e.dispatch("item-error",[t]),e.dispatch("progress",[{progress:e.progresses.reduce((function(e,t){return e+t}))/e.files.length,successCount:e.successIndexes.length,failCount:e.failIndexes.length}]),a()})),o.download()}))}))}},{key:"appendFile",value:function(e){this.files.push(e)}}]),n}(v.a);t.a=w},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return _}));var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(3),l=n.n(s),u=n(4),c=function(){function e(){a()(this,e),this.runtime=u.a.getBrowser().runtime}return i()(e,null,[{key:"getInstance",value:function(){return void 0!==e.instance?e.instance:e.instance=new e}},{key:"getRuntime",value:function(){return e.getInstance().runtime}}]),e}();l()(c,"instance",void 0);var h=c,f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local";a()(this,e),this.storage=u.a.getBrowser().storage,this.storageArea=this.storage[t]}return i()(e,[{key:"get",value:function(e){var t=this;return new Promise((function(n){t.storageArea.get(e,(function(e){n(e)}))}))}},{key:"set",value:function(e){var t=this;return new Promise((function(n){t.storageArea.set(e,(function(){n()}))}))}},{key:"remove",value:function(e){var t=this;return new Promise((function(n){t.storageArea.remove(e,(function(){n()}))}))}},{key:"onChanged",value:function(){return this.storage.onChanged}}],[{key:"getInstance",value:function(t){return void 0!==e.instance?e.instance:e.instance=new e(t)}},{key:"getStorage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local",n=e.getInstance(t);return n.storageArea}}]),e}();l()(f,"instance",void 0);var d=f,p=function(){function e(){a()(this,e),this.tabs=u.a.getBrowser().tabs}return i()(e,null,[{key:"getInstance",value:function(){return void 0!==e.instance?e.instance:e.instance=new e}},{key:"getTabs",value:function(){return e.getInstance().tabs}}]),e}();l()(p,"instance",void 0);function g(){this.browser=u.a.getBrowser(),this.autoRender=!1,this.tabId,this.backgroundColor,this.text}g.prototype={setAutoRender:function(e){this.autoRender=e},setTabId:function(e){return this.tabId=e,this.conditionRender(),this},setBackgroundColor:function(e){return this.backgroundColor=e,this.conditionRender(),this},setText:function(e){return this.text=e,this.conditionRender(),this},conditionRender:function(){this.autoRender&&this.render()},render:function(){browser.browserAction.setBadgeText({text:this.text,tabId:this.tabId}),browser.browserAction.setBadgeBackgroundColor({color:this.bgColor,tabId:this.tabId})}};var v=n(18),m=(d.getStorage(),{contains:function(e){return new Promise((function(t){u.a.getBrowser().runtime.sendMessage({action:"containsPermissions",permissions:e},(function(e){t(e)}))}))},request:function(e){return new Promise((function(t){u.a.getBrowser().runtime.sendMessage({action:"requestPermissions",permissions:e},(function(e){t(e)}))}))},remove:function(e){return new Promise((function(t){u.a.getBrowser().runtime.sendMessage({action:"removePermissions",permissions:e},(function(e){t(e)}))}))}}),_={download:function(e){return new Promise((function(t,n){var r=u.a.getBrowser();r.runtime.sendMessage({action:"download",options:e},(function(e){void 0!==e?t(e):n(r.runtime.lastError)}))}))}};h.getRuntime(),v.a.getI18n()},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";function r(){this.stack=[],this.index=0,this.complete=0,this.fail=0,this.total=0,this.onItemComplete,this.onItemFail,this.onDone,this.stopQueue=!1,this.processors=1,this.active=0}r.prototype={setProcessors:function(e){this.processors=parseInt(e)},add:function(e){this.stack.push(e),this.total=this.stack.length},next:function(){return this.index<this.stack.length&&(this.index++,this.current())},current:function(){return this.stack[this.index]},start:function(e){var t=this;if(!(this.active>=this.processors)){var n,r=this.index;(n=this.current())&&(this.active++,e(n).then((function(){t.complete++,t.onItemComplete&&t.onItemComplete.call(t)})).catch((function(){t.fail++,t.onItemFail&&t.onItemFail.call(t,r)})).finally((function(){t.active--,t.stopQueue||(t.total===t.complete+t.fail?"function"==typeof t.onDone&&t.onDone.call(t):t.next()&&t.start(e))})),this.active<this.processors&&this.next()&&this.start(e))}},abort:function(){this.stopQueue=!0}},t.a=r},function(e,t,n){var r=n(2),a=n(22),o=n(33),i=n(34);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return i(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)},e.exports.default=e.exports,e.exports.__esModule=!0,s(t)}e.exports=s,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=VueI18n},function(e,t){e.exports=locales},function(e,t,n){},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(12),l=n.n(s),u=n(25),c=n.n(u),h=n(26),f=n.n(h);l.a.use(c.a);var d=function(){function e(){a()(this,e)}return i()(e,null,[{key:"i18n",value:function(e){var t=new c.a({locale:e&&"default"!==e?e:"en",messages:{en:f.a.localeEn,zh_CN:f.a.localeZhCN}});return t}}]),e}()},function(e,t,n){"use strict";t.a={computed:{browserItems:function(){return this.$root.globalBrowserItems||this.$root.browserItems},isFirefox:function(){return this.$root.isFirefox_}},methods:{tl:function(e){return this.$t("".concat(e,".message"))},stripTags:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return"string"!=typeof e?e:e.replace(/<\/?[^>]+(>|$)/g,t.repeat(2)).trim()},routeTo:function(e){this.pushRoute({name:e})},pushRoute:function(e){return this.$router.push(e).then((function(){return Promise.resolve()})).catch((function(e){if("NavigationDuplicated"!==e.name)return Promise.reject(e)}))}}}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(2);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(22),a=n(35);function o(t,n,i){return a()?(e.exports=o=Reflect.construct,e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=o=function(e,t,n){var a=[null];a.push.apply(a,t);var o=new(Function.bind.apply(e,a));return n&&r(o,n.prototype),o},e.exports.default=e.exports,e.exports.__esModule=!0),o.apply(null,arguments)}e.exports=o,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";n(27)},function(e,t){e.exports=EpubMaker},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";e.exports=function(e,t,n,r){var a=self||window;try{try{var o;try{o=new a.Blob([e])}catch(t){(o=new(a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder)).append(e),o=o.getBlob()}var i=a.URL||a.webkitURL,s=i.createObjectURL(o),l=new a[t](s,n);return i.revokeObjectURL(s),l}catch(r){return new a[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new a[t](r,n)}}},function(e,t,n){},function(e,t,n){"use strict";n(38)},function(e,t,n){"use strict";n(39)},function(e,t,n){"use strict";n(40)},,function(e,t,n){"use strict";n.r(t);n(43);var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(3),l=n.n(s),u=n(4),c=n(14),h=n(5),f=n.n(h),d=n(6),p=n.n(d),g=n(2),v=n.n(g),m=n(13),_=n(20),w=n(7),b=n(17),y=(n(23),n(19)),k=n(8);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var I=function(e){f()(n,e);var t=x(n);function n(e){var r;return a()(this,n),(r=t.call(this)).context=e,r.chunks=[],r.filename,r.zips,r}return i()(n,[{key:"initOptions",value:function(e){var t=e.splitSize,n=e.illustrationRenameFormat,r=e.illustrationImageRenameFormat,a=e.pageNumberStartWithOne,o=void 0!==a&&a,i=e.illustrationPageNumberLength,s=e.processors,l=void 0===s?2:s;return this.splitSize=t,this.illustrationRenameFormat=n,this.illustrationImageRenameFormat=r,this.pageNumberStartWithOne=o,this.illustrationPageNumberLength=i,this.processors=l,this}},{key:"init",value:function(){this.chunks=[],this.filename=null,this.zips=null;for(var e=0;e<=this.context.pages.length-1;){var t={},n=e+this.splitSize-1;t.start=e,n>=this.context.pages.length&&(n=this.context.pages.length-1),t.end=n,this.chunks.push(t),e=t.end+1}(!this.illustrationImageRenameFormat||this.illustrationImageRenameFormat.indexOf("{pageNum}")<0)&&(this.illustrationImageRenameFormat+="{pageNum}")}},{key:"getUserId",value:function(){return this.context.userId}},{key:"getUserName",value:function(){return this.context.userName}},{key:"getId",value:function(){return this.context.illustId}},{key:"getImages",value:function(){return this.context.urls}},{key:"getThumb",value:function(){return this.getImages().thumb}},{key:"getTitle",value:function(){return this.context.illustTitle}},{key:"isR",value:function(){return!!this.context.r}},{key:"getPageRange",value:function(e){return e.start==e.end?parseInt(e.start):parseInt(e.start+1)+"-"+parseInt(e.end+1)}},{key:"getFilename",value:function(e){var t=this.chunks.length>1?"_"+this.getPageRange(e):"";return Object(k.a)(this.illustrationRenameFormat,this.context,this.context.illustId)+t+".zip"}},{key:"isSingle",value:function(){return 1===this.pagesNumber()}},{key:"pagesNumber",value:function(){return this.context.pages.length}},{key:"downloadFile",value:function(e,t,n){var r=this;new y.a({maxTime:3}).start((function(){return new Promise((function(a,o){var i=new m.a(e,{method:"GET"});i.addListener("onprogress",(function(e){var n=e.totalLength,a=e.loadedLength;r.dispatch("download-progress",[{progress:a/n},t])})),i.addListener("onerror",(function(e){console.log(e),o()})),i.addListener("onfinish",(function(e){var o=n.pageNum||0;r.context.pageNum=o;var s=r.illustrationImageRenameFormat.replace(/#.*#/g,""),l=Object(k.a)(s,r.context,o)+"."+b.a.getExtenstion(i.getResponseHeader("Content-Type"));r.dispatch("download-finish",[{blob:e,filename:l},t]),a()})),i.download()}))}))}},{key:"downloadChunk",value:function(e,t){var n=this,r=new _.a({processors:this.processors});r.asBlob=!1;for(var a=new JSZip,o=e.start;o<=e.end;o++)r.appendFile(this.context.pages[o].urls.original);r.addListener("progress",(function(e){n.dispatch("download-progress",[e,t])})),r.addListener("item-error",(function(e){n.dispatch("download-error",e)})),r.addListener("item-finish",(function(t){var r=t.data,o=t.index,i=t.download,s=e.start+o+(n.pageNumberStartWithOne?1:0),l=null;n.context.pageNum=n.getPageNumberString(s),l=Object(k.a)(n.illustrationImageRenameFormat.replace(n.isSingle()?/#.*#/g:/#/g,""),n.context,s),l+="."+b.a.getExtenstion(i.getResponseHeader("Content-Type"));var u=new Date;u.setMinutes(u.getMinutes()-u.getTimezoneOffset()),a.file(l,r,{date:u})})),r.addListener("finish",(function(){a.generateAsync({type:"blob"}).then((function(r){n.dispatch("download-finish",[{blob:r,filename:n.getFilename(e)},t])})).catch((function(e){return console.error(e)}))})),r.download()}},{key:"downloadSelected",value:function(e,t){var n=this,r=new _.a({processors:this.processors});r.asBlob=!1;var a=new JSZip;e.forEach((function(e){r.appendFile(n.context.pages[e].urls.original)})),r.addListener("progress",(function(e){n.dispatch("download-progress",[e,t,{selected:!0}])})),r.addListener("item-error",(function(e){n.dispatch("download-error",e)})),r.addListener("item-finish",(function(e){var t=e.data,r=e.index,o=e.download,i=r+(n.pageNumberStartWithOne?1:0),s=null;n.context.pageNum=n.getPageNumberString(i),s=Object(k.a)(n.illustrationImageRenameFormat.replace(n.isSingle()?/#.*#/g:/#/g,""),n.context,i),s+="."+b.a.getExtenstion(o.getResponseHeader("Content-Type"));var l=new Date;l.setMinutes(l.getMinutes()-l.getTimezoneOffset()),a.file(s,t,{date:l})})),r.addListener("finish",(function(){a.generateAsync({type:"blob"}).then((function(e){n.dispatch("download-finish",[{blob:e,filename:Object(k.a)(n.illustrationRenameFormat,n.context,n.context.illustId)+".zip"},t,{selected:!0}])})).catch((function(e){return console.error(e)}))})),r.download()}},{key:"getPageNumberString",value:function(e){if(0===this.illustrationPageNumberLength)return e;var t=e+"",n=0;return this.illustrationPageNumberLength>1?n=this.illustrationPageNumberLength:-1===this.illustrationPageNumberLength&&(n=(this.context.pages.length+"").length),t.length<n?"0".repeat(n-t.length)+t:e}}]),n}(w.a),S=n(10),T=function(){function e(){a()(this,e),this.illustContext,this.illustTool,this.browser=u.a.getBrowser()}return i()(e,[{key:"inital",value:function(e){var t=this;return new Promise((function(n){t.parseContext(e).then((function(e){n(e)}))}))}},{key:"parseContext",value:function(e){var t=this,n=this,r=c.a.getDefault(e.createDate);return new Promise((function(a,o){n.illustContext={illustId:e.illustId,illustTitle:e.illustTitle,userName:e.userName,userId:e.userId,userAcount:e.userAccount,urls:e.urls,r:e.xRestrict,id:e.illustId,title:e.illustTitle,comment:e.illustComment,description:e.description,createDate:e.createDate,uploadDate:e.uploadDate,type:"Illust",bookmarkCount:e.bookmarkCount,likeCount:e.likeCount,responseCount:e.responseCount,viewCount:e.viewCount,year:r.getYear(),month:r.getMonth(),day:r.getDay()};var i=new S.a(t.getMangaPagesUrl(),{method:"GET"});i.addListener("onload",(function(e){var t=JSON.parse(String.fromCharCode.apply(null,e));t.error?o():(n.illustContext.pages=t.body,a(n.illustContext))})),i.send()}))}},{key:"getMangaPagesUrl",value:function(){return"https://www.pixiv.net/ajax/illust/"+this.illustContext.illustId+"/pages"}},{key:"makeTool",value:function(){return this.illustTool?(this.illustTool.context=this.illustContext,this.illustTool):this.illustTool=new I(this.illustContext)}}]),e}(),R=n(24);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var B=function(e){f()(n,e);var t=z(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invalid_page";return a()(this,n),(e=t.call(this,r)).name="InvalidPageError",e}return n}(n.n(R)()(Error));function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var C=function(e){f()(n,e);var t=A(n);function n(e){var r;return a()(this,n),(r=t.call(this)).context=e,r.chunks=[],r.filename,r.zips,r}return i()(n,[{key:"initOptions",value:function(e){var t=e.splitSize,n=e.mangaRenameFormat,r=e.mangaImageRenameFormat,a=e.pageNumberStartWithOne,o=e.mangaPageNumberLength,i=e.processors;return this.splitSize=t,this.mangaRenameFormat=n,this.mangaImageRenameFormat=r,this.pageNumberStartWithOne=a,this.mangaPageNumberLength=o,this.processors=i,this}},{key:"init",value:function(){this.chunks=[],this.filename=null,this.zips=null;for(var e=0;e<=this.context.pages.length-1;){var t={},n=e+this.splitSize-1;t.start=e,n>=this.context.pages.length&&(n=this.context.pages.length-1),t.end=n,this.chunks.push(t),e=t.end+1}(!this.mangaImageRenameFormat||this.mangaImageRenameFormat.indexOf("{pageNum}")<0)&&(this.mangaImageRenameFormat+="{pageNum}")}},{key:"getUserId",value:function(){return this.context.userId}},{key:"getUserName",value:function(){return this.context.userName}},{key:"getId",value:function(){return this.context.illustId}},{key:"getImages",value:function(){return this.context.urls}},{key:"getThumb",value:function(){return this.getImages().thumb}},{key:"getTitle",value:function(){return this.context.illustTitle}},{key:"isR",value:function(){return!!this.context.r}},{key:"getPageRange",value:function(e){return e.start==e.end?parseInt(e.start):parseInt(e.start+1)+"-"+parseInt(e.end+1)}},{key:"getFilename",value:function(e){return Object(k.a)(this.mangaRenameFormat,this.context,this.context.illustId)+"_"+this.getPageRange(e)+".zip"}},{key:"downloadChunk",value:function(e,t){var n=this,r=new JSZip,a=new _.a({processors:this.processors});a.asBlob=!1;for(var o=e.start;o<=e.end;o++)a.appendFile(this.context.pages[o].urls.original);a.addListener("progress",(function(e){n.dispatch("download-progress",[e,t])})),a.addListener("item-error",(function(e){n.dispatch("download-error",e)})),a.addListener("item-finish",(function(t){var a=t.data,o=t.index,i=t.download,s=e.start+o+(n.pageNumberStartWithOne?1:0);n.context.pageNum=n.getPageNumberString(s);var l=Object(k.a)(n.mangaImageRenameFormat,n.context,s)+"."+b.a.getExtenstion(i.getResponseHeader("Content-Type")),u=new Date;u.setMinutes(u.getMinutes()-u.getTimezoneOffset()),r.file(l,a,{date:u})})),a.addListener("finish",(function(){r.generateAsync({type:"blob"}).then((function(e){n.dispatch("download-finish",[e,t])}))})),a.download()}},{key:"getPageNumberString",value:function(e){if(0===this.mangaPageNumberLength)return e;var t=e+"",n=0;return this.mangaPageNumberLength>1?n=this.mangaPageNumberLength:-1===this.mangaPageNumberLength&&(n=(this.context.pages.length+"").length),t.length<n?"0".repeat(n-t.length)+t:e}}]),n}(w.a),E=function(){function e(){a()(this,e),this.illustContext,this.mangaTool,this.browser=u.a.getBrowser()}return i()(e,[{key:"inital",value:function(e){var t=this;return new Promise((function(n){t.parseContext(e).then((function(e){n(e)}))}))}},{key:"parseContext",value:function(e){var t=this,n=this,r=c.a.getDefault(e.createDate);return new Promise((function(a,o){n.illustContext={illustId:e.illustId,illustTitle:e.illustTitle,userName:e.userName,userId:e.userId,userAcount:e.userAccount,urls:e.urls,r:e.xRestrict,id:e.illustId,title:e.illustTitle,comment:e.illustComment,description:e.description,createDate:e.createDate,uploadDate:e.uploadDate,type:"Manga",bookmarkCount:e.bookmarkCount,likeCount:e.likeCount,responseCount:e.responseCount,viewCount:e.viewCount,year:r.getYear(),month:r.getMonth(),day:r.getDay()};var i=new S.a(t.getMangaPagesUrl(),{method:"GET"});i.addListener("onload",(function(e){var t=JSON.parse(String.fromCharCode.apply(null,e));t.error?o():(n.illustContext.pages=t.body,a(n.illustContext))})),i.send()}))}},{key:"getMangaPagesUrl",value:function(){return"https://www.pixiv.net/ajax/illust/"+this.illustContext.illustId+"/pages"}},{key:"makeTool",value:function(){return this.mangaTool?(this.mangaTool.context=this.illustContext,this.mangaTool):this.mangaTool=new C(this.illustContext)}}]),e}(),P=n(37),D=n.n(P),U=function(){function e(t){a()(this,e),this.context=t,this.epubMaker=new D.a,this.epubMaker.withTemplate("idpf-wasteland")}return i()(e,[{key:"addMeta",value:function(e,t){var n="with"+e.charAt(0).toUpperCase()+e.slice(1);return"function"==typeof this.epubMaker[n]&&this.epubMaker[n](t),this}},{key:"appendSection",value:function(e){return this.epubMaker.withSection(new D.a.Section("bodymatter",null,{content:e},!1,!1)),this}},{key:"makeBook",value:function(){var e=this;return new Promise((function(t){e.epubMaker.downloadEpub((function(e){t(e)}))}))}}]),e}(),M=function(){function e(){a()(this,e),this.meta={},this.content=[]}return i()(e,[{key:"addMeta",value:function(e,t){return this.meta[e]=t,this}},{key:"appendSection",value:function(e){return e=e.replace(/<br\s*\/>/gi,"\r\n").trim(),this.content.push(e),this}},{key:"makeBook",value:function(){var e=this;["attributionUrl","author","title"].forEach((function(t){e.meta[t]&&e.content.unshift(e.meta[t])}));var t=this.content.join("\r\n".repeat(2)),n=new Blob([t],{type:"text/plain"});return Promise.resolve(n)}}]),e}(),N=function(){function e(t){a()(this,e),this.context=t}return i()(e,[{key:"getId",value:function(){return this.context.id}},{key:"getUserId",value:function(){return this.context.userId}},{key:"getUserName",value:function(){return this.context.userName}},{key:"getTitle",value:function(){return this.context.novelTitle}},{key:"isR",value:function(){return!!this.context.r}},{key:"getCover",value:function(){return this.context.novelCover}},{key:"getGenerator",value:function(e){switch(e){case"epub":return new U;case"txt":return new M;default:throw Error('Unkown generator type "'.concat(e,'"'))}}}]),e}(),L=function(){function e(){a()(this,e),this.browser=u.a.getBrowser(),this.novelContext,this.novelTool}return i()(e,[{key:"inital",value:function(e){var t=this;return new Promise((function(n){t.parseContext(e),n(t.novelContext)}))}},{key:"parseContext",value:function(e){var t=e.content.split(/[\r\n|\r|\n]\[newpage\][\r\n|\r\n]/i).map((function(e){return e.replace(/[\r\n|\r|\n]/g,"<br />")})),n=c.a.getDefault(e.createDate);this.novelContext={novelId:e.id,novelTitle:e.title,novelSections:t,novelDescription:e.description,novelCover:e.coverUrl,novelUrl:window.location.href,userId:e.userId,userName:e.userName,r:e.xRestrict,id:e.id,title:e.title,description:e.description,createDate:e.createDate,uploadDate:e.uploadDate,type:"Novel",bookmarkCount:e.bookmarkCount,likeCount:e.likeCount,responseCount:e.responseCount,viewCount:e.viewCount,year:n.getYear(),month:n.getMonth(),day:n.getDay()}}},{key:"makeTool",value:function(){return this.novelTool?(this.novelTool.context=this.novelContext,this.novelTool):this.novelTool=new N(this.novelContext)}}]),e}(),F=function(e){return new Promise((function(t){var n=new Image;n.onload=function(){t({width:n.width,height:n.height})},n.src=e}))},O=function(e,t){return new Promise((function(n){var r=new Image(t.width,t.height);r.src=e,r.addEventListener("load",(function(){var e=document.createElement("canvas");e.setAttribute("width",t.width),e.setAttribute("height",t.height),e.getContext("2d").drawImage(r,0,0,t.width,t.height),n(e)}))}))},j=n(42),H=n.n(j);function q(){return H()('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="./",r(r.s=21)}([function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)a(r,n)&&(e[n]=r[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),a);else for(var i=0;i<n;i++)e[a+i]=t[r+i]},flattenChunks:function(e){var t,r,n,a,i,s;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(s=new Uint8Array(n),a=0,t=0,r=e.length;t<r;t++)i=e[t],s.set(i,a),a+=i.length;return s}},s={arraySet:function(e,t,r,n,a){for(var i=0;i<n;i++)e[a+i]=t[r+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(n)},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";var n={};(0,r(0).assign)(n,r(13),r(16),r(8)),e.exports=n},function(e,t,r){"use strict";e.exports=function(e,t,r,n){for(var a=65535&e|0,i=e>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{i=i+(a=a+t[n++]|0)|0}while(--s);a%=65521,i%=65521}return a|i<<16|0}},function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,r,a){var i=n,s=a+r;e^=-1;for(var o=a;o<s;o++)e=e>>>8^i[255&(e^t[o])];return-1^e}},function(e,t,r){"use strict";var n=r(0),a=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var s=new n.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&i||!e.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",s=0;s<t;s++)r+=String.fromCharCode(e[s]);return r}s[254]=s[254]=1,t.string2buf=function(e){var t,r,a,i,s,o=e.length,l=0;for(i=0;i<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),s=0,i=0;s<l;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<o&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,n,a,i,o=t||e.length,f=new Array(2*o);for(n=0,r=0;r<o;)if((a=e[r++])<128)f[n++]=a;else if((i=s[a])>4)f[n++]=65533,r+=i-1;else{for(a&=2===i?31:3===i?15:7;i>1&&r<o;)a=a<<6|63&e[r++],i--;i>1?f[n++]=65533:a<65536?f[n++]=a:(a-=65536,f[n++]=55296|a>>10&1023,f[n++]=56320|1023&a)}return l(f,n)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}},function(e,t,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){(function(t){var n;n={},e.exports=n,function(e,t){e.toRGBA8=function(t){var r=t.width,n=t.height;if(null==t.tabs.acTL)return[e.toRGBA8.decodeImage(t.data,r,n,t).buffer];var a=[];null==t.frames[0].data&&(t.frames[0].data=t.data);for(var i,s=new Uint8Array(r*n*4),o=0;o<t.frames.length;o++){var l=t.frames[o],f=l.rect.x,h=l.rect.y,d=l.rect.width,u=l.rect.height,c=e.toRGBA8.decodeImage(l.data,d,u,t);if(0==o?i=c:0==l.blend?e._copyTile(c,d,u,i,r,n,f,h,0):1==l.blend&&e._copyTile(c,d,u,i,r,n,f,h,1),a.push(i.buffer),i=i.slice(0),0==l.dispose);else if(1==l.dispose)e._copyTile(s,d,u,i,r,n,f,h,0);else if(2==l.dispose){for(var _=o-1;2==t.frames[_].dispose;)_--;i=new Uint8Array(a[_]).slice(0)}}return a},e.toRGBA8.decodeImage=function(t,r,n,a){var i=r*n,s=e.decode._getBPP(a),o=Math.ceil(r*s/8),l=new Uint8Array(4*i),f=new Uint32Array(l.buffer),h=a.ctype,d=a.depth,u=e._bin.readUshort;if(6==h){var c=i<<2;if(8==d)for(var _=0;_<c;_++)l[_]=t[_];if(16==d)for(_=0;_<c;_++)l[_]=t[_<<1]}else if(2==h){var g=a.tabs.tRNS,p=-1,b=-1,v=-1;if(g&&(p=g[0],b=g[1],v=g[2]),8==d)for(_=0;_<i;_++){var w=3*_;l[S=_<<2]=t[w],l[S+1]=t[w+1],l[S+2]=t[w+2],l[S+3]=255,-1!=p&&t[w]==p&&t[w+1]==b&&t[w+2]==v&&(l[S+3]=0)}if(16==d)for(_=0;_<i;_++)w=6*_,l[S=_<<2]=t[w],l[S+1]=t[w+2],l[S+2]=t[w+4],l[S+3]=255,-1!=p&&u(t,w)==p&&u(t,w+2)==b&&u(t,w+4)==v&&(l[S+3]=0)}else if(3==h){var m=a.tabs.PLTE,y=a.tabs.tRNS,k=y?y.length:0;if(1==d)for(var x=0;x<n;x++){var z=x*o,A=x*r;for(_=0;_<r;_++){var S=A+_<<2,T=3*(U=t[z+(_>>3)]>>7-((7&_)<<0)&1);l[S]=m[T],l[S+1]=m[T+1],l[S+2]=m[T+2],l[S+3]=U<k?y[U]:255}}if(2==d)for(x=0;x<n;x++)for(z=x*o,A=x*r,_=0;_<r;_++)S=A+_<<2,T=3*(U=t[z+(_>>2)]>>6-((3&_)<<1)&3),l[S]=m[T],l[S+1]=m[T+1],l[S+2]=m[T+2],l[S+3]=U<k?y[U]:255;if(4==d)for(x=0;x<n;x++)for(z=x*o,A=x*r,_=0;_<r;_++)S=A+_<<2,T=3*(U=t[z+(_>>1)]>>4-((1&_)<<2)&15),l[S]=m[T],l[S+1]=m[T+1],l[S+2]=m[T+2],l[S+3]=U<k?y[U]:255;if(8==d)for(_=0;_<i;_++){var U;S=_<<2,T=3*(U=t[_]),l[S]=m[T],l[S+1]=m[T+1],l[S+2]=m[T+2],l[S+3]=U<k?y[U]:255}}else if(4==h){if(8==d)for(_=0;_<i;_++){S=_<<2;var B=t[E=_<<1];l[S]=B,l[S+1]=B,l[S+2]=B,l[S+3]=t[E+1]}if(16==d)for(_=0;_<i;_++){var E;S=_<<2,B=t[E=_<<2],l[S]=B,l[S+1]=B,l[S+2]=B,l[S+3]=t[E+2]}}else if(0==h){if(p=a.tabs.tRNS?a.tabs.tRNS:-1,1==d)for(_=0;_<i;_++){var I=(B=255*(t[_>>3]>>7-(7&_)&1))==255*p?0:255;f[_]=I<<24|B<<16|B<<8|B}if(2==d)for(_=0;_<i;_++)I=(B=85*(t[_>>2]>>6-((3&_)<<1)&3))==85*p?0:255,f[_]=I<<24|B<<16|B<<8|B;if(4==d)for(_=0;_<i;_++)I=(B=17*(t[_>>1]>>4-((1&_)<<2)&15))==17*p?0:255,f[_]=I<<24|B<<16|B<<8|B;if(8==d)for(_=0;_<i;_++)I=(B=t[_])==p?0:255,f[_]=I<<24|B<<16|B<<8|B;if(16==d)for(_=0;_<i;_++)B=t[_<<1],I=u(t,_<<1)==p?0:255,f[_]=I<<24|B<<16|B<<8|B}return l},e.decode=function(t){for(var r,n=new Uint8Array(t),a=8,i=e._bin,s=i.readUshort,o=i.readUint,l={tabs:{},frames:[]},f=new Uint8Array(n.length),h=0,d=0,u=[137,80,78,71,13,10,26,10],c=0;c<8;c++)if(n[c]!=u[c])throw"The input is not a PNG file!";for(;a<n.length;){var _=i.readUint(n,a);a+=4;var g=i.readASCII(n,a,4);if(a+=4,"IHDR"==g)e.decode._IHDR(n,a,l);else if("IDAT"==g){for(c=0;c<_;c++)f[h+c]=n[a+c];h+=_}else if("acTL"==g)l.tabs[g]={num_frames:o(n,a),num_plays:o(n,a+4)},r=new Uint8Array(n.length);else if("fcTL"==g){0!=d&&((z=l.frames[l.frames.length-1]).data=e.decode._decompress(l,r.slice(0,d),z.rect.width,z.rect.height),d=0);var p={x:o(n,a+12),y:o(n,a+16),width:o(n,a+4),height:o(n,a+8)},b=s(n,a+22);b=s(n,a+20)/(0==b?100:b);var v={rect:p,delay:Math.round(1e3*b),dispose:n[a+24],blend:n[a+25]};l.frames.push(v)}else if("fdAT"==g){for(c=0;c<_-4;c++)r[d+c]=n[a+c+4];d+=_-4}else if("pHYs"==g)l.tabs[g]=[i.readUint(n,a),i.readUint(n,a+4),n[a+8]];else if("cHRM"==g)for(l.tabs[g]=[],c=0;c<8;c++)l.tabs[g].push(i.readUint(n,a+4*c));else if("tEXt"==g){null==l.tabs[g]&&(l.tabs[g]={});var w=i.nextZero(n,a),m=i.readASCII(n,a,w-a),y=i.readASCII(n,w+1,a+_-w-1);l.tabs[g][m]=y}else if("iTXt"==g){null==l.tabs[g]&&(l.tabs[g]={}),w=0;var k=a;w=i.nextZero(n,k),m=i.readASCII(n,k,w-k),n[k=w+1],n[k+1],k+=2,w=i.nextZero(n,k),i.readASCII(n,k,w-k),k=w+1,w=i.nextZero(n,k),i.readUTF8(n,k,w-k),k=w+1,y=i.readUTF8(n,k,_-(k-a)),l.tabs[g][m]=y}else if("PLTE"==g)l.tabs[g]=i.readBytes(n,a,_);else if("hIST"==g){var x=l.tabs.PLTE.length/3;for(l.tabs[g]=[],c=0;c<x;c++)l.tabs[g].push(s(n,a+2*c))}else if("tRNS"==g)3==l.ctype?l.tabs[g]=i.readBytes(n,a,_):0==l.ctype?l.tabs[g]=s(n,a):2==l.ctype&&(l.tabs[g]=[s(n,a),s(n,a+2),s(n,a+4)]);else if("gAMA"==g)l.tabs[g]=i.readUint(n,a)/1e5;else if("sRGB"==g)l.tabs[g]=n[a];else if("bKGD"==g)0==l.ctype||4==l.ctype?l.tabs[g]=[s(n,a)]:2==l.ctype||6==l.ctype?l.tabs[g]=[s(n,a),s(n,a+2),s(n,a+4)]:3==l.ctype&&(l.tabs[g]=n[a]);else if("IEND"==g){var z;0!=d&&((z=l.frames[l.frames.length-1]).data=e.decode._decompress(l,r.slice(0,d),z.rect.width,z.rect.height),d=0),l.data=e.decode._decompress(l,f,l.width,l.height);break}a+=_,i.readUint(n,a),a+=4}return delete l.compress,delete l.interlace,delete l.filter,l},e.decode._decompress=function(t,r,n,a){return 0==t.compress&&(r=e.decode._inflate(r)),0==t.interlace?r=e.decode._filterZero(r,t,0,n,a):1==t.interlace&&(r=e.decode._readInterlace(r,t)),r},e.decode._inflate=function(e){return t.inflate(e)},e.decode._readInterlace=function(t,r){for(var n=r.width,a=r.height,i=e.decode._getBPP(r),s=i>>3,o=Math.ceil(n*i/8),l=new Uint8Array(a*o),f=0,h=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],c=[8,8,4,4,2,2,1],_=0;_<7;){for(var g=u[_],p=c[_],b=0,v=0,w=h[_];w<a;)w+=g,v++;for(var m=d[_];m<n;)m+=p,b++;var y=Math.ceil(b*i/8);e.decode._filterZero(t,r,f,b,v);for(var k=0,x=h[_];x<a;){for(var z=d[_],A=f+k*y<<3;z<n;){var S;if(1==i&&(S=(S=t[A>>3])>>7-(7&A)&1,l[x*o+(z>>3)]|=S<<7-((3&z)<<0)),2==i&&(S=(S=t[A>>3])>>6-(7&A)&3,l[x*o+(z>>2)]|=S<<6-((3&z)<<1)),4==i&&(S=(S=t[A>>3])>>4-(7&A)&15,l[x*o+(z>>1)]|=S<<4-((1&z)<<2)),i>=8)for(var T=x*o+z*s,U=0;U<s;U++)l[T+U]=t[(A>>3)+U];A+=i,z+=p}k++,x+=g}b*v!=0&&(f+=v*(1+y)),_+=1}return l},e.decode._getBPP=function(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth},e.decode._filterZero=function(t,r,n,a,i){var s=e.decode._getBPP(r),o=Math.ceil(a*s/8),l=e.decode._paeth;s=Math.ceil(s/8);for(var f=0;f<i;f++){var h=n+f*o,d=h+f+1,u=t[d-1];if(0==u)for(var c=0;c<o;c++)t[h+c]=t[d+c];else if(1==u){for(c=0;c<s;c++)t[h+c]=t[d+c];for(c=s;c<o;c++)t[h+c]=t[d+c]+t[h+c-s]&255}else if(0==f){for(c=0;c<s;c++)t[h+c]=t[d+c];if(2==u)for(c=s;c<o;c++)t[h+c]=255&t[d+c];if(3==u)for(c=s;c<o;c++)t[h+c]=t[d+c]+(t[h+c-s]>>1)&255;if(4==u)for(c=s;c<o;c++)t[h+c]=t[d+c]+l(t[h+c-s],0,0)&255}else{if(2==u)for(c=0;c<o;c++)t[h+c]=t[d+c]+t[h+c-o]&255;if(3==u){for(c=0;c<s;c++)t[h+c]=t[d+c]+(t[h+c-o]>>1)&255;for(c=s;c<o;c++)t[h+c]=t[d+c]+(t[h+c-o]+t[h+c-s]>>1)&255}if(4==u){for(c=0;c<s;c++)t[h+c]=t[d+c]+l(0,t[h+c-o],0)&255;for(c=s;c<o;c++)t[h+c]=t[d+c]+l(t[h+c-s],t[h+c-o],t[h+c-s-o])&255}}}return t},e.decode._paeth=function(e,t,r){var n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r},e.decode._IHDR=function(t,r,n){var a=e._bin;n.width=a.readUint(t,r),r+=4,n.height=a.readUint(t,r),r+=4,n.depth=t[r],r++,n.ctype=t[r],r++,n.compress=t[r],r++,n.filter=t[r],r++,n.interlace=t[r],r++},e._bin={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},readUint:function(e,t){return 16777216*e[t]+(e[t+1]<<16|e[t+2]<<8|e[t+3])},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},readASCII:function(e,t,r){for(var n="",a=0;a<r;a++)n+=String.fromCharCode(e[t+a]);return n},writeASCII:function(e,t,r){for(var n=0;n<r.length;n++)e[t+n]=r.charCodeAt(n)},readBytes:function(e,t,r){for(var n=[],a=0;a<r;a++)n.push(e[t+a]);return n},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(t,r,n){for(var a,i="",s=0;s<n;s++)i+="%"+e._bin.pad(t[r+s].toString(16));try{a=decodeURIComponent(i)}catch(a){return e._bin.readASCII(t,r,n)}return a}},e._copyTile=function(e,t,r,n,a,i,s,o,l){for(var f=Math.min(t,a),h=Math.min(r,i),d=0,u=0,c=0;c<h;c++)for(var _=0;_<f;_++)if(s>=0&&o>=0?(d=c*t+_<<2,u=(o+c)*a+s+_<<2):(d=(-o+c)*t-s+_<<2,u=c*a+_<<2),0==l)n[u]=e[d],n[u+1]=e[d+1],n[u+2]=e[d+2],n[u+3]=e[d+3];else if(1==l){var g=e[d+3]*(1/255),p=e[d]*g,b=e[d+1]*g,v=e[d+2]*g,w=n[u+3]*(1/255),m=n[u]*w,y=n[u+1]*w,k=n[u+2]*w,x=1-g,z=g+w*x,A=0==z?0:1/z;n[u+3]=255*z,n[u+0]=(p+m*x)*A,n[u+1]=(b+y*x)*A,n[u+2]=(v+k*x)*A}else if(2==l)g=e[d+3],p=e[d],b=e[d+1],v=e[d+2],w=n[u+3],m=n[u],y=n[u+1],k=n[u+2],g==w&&p==m&&b==y&&v==k?(n[u]=0,n[u+1]=0,n[u+2]=0,n[u+3]=0):(n[u]=p,n[u+1]=b,n[u+2]=v,n[u+3]=g);else if(3==l){if(g=e[d+3],p=e[d],b=e[d+1],v=e[d+2],w=n[u+3],m=n[u],y=n[u+1],k=n[u+2],g==w&&p==m&&b==y&&v==k)continue;if(g<220&&w>20)return!1}return!0},e.encode=function(t,r,n,a,i,s){null==a&&(a=0),null==s&&(s=!1);for(var o=new Uint8Array(t[0].byteLength*t.length+100),l=[137,80,78,71,13,10,26,10],f=0;f<8;f++)o[f]=l[f];var h=8,d=e._bin,u=e.crc.crc,c=d.writeUint,_=d.writeUshort,g=d.writeASCII,p=e.encode.compressPNG(t,r,n,a,s);c(o,h,13),g(o,h+=4,"IHDR"),c(o,h+=4,r),c(o,h+=4,n),o[h+=4]=p.depth,o[++h]=p.ctype,o[++h]=0,o[++h]=0,o[++h]=0,c(o,++h,u(o,h-17,17)),c(o,h+=4,1),g(o,h+=4,"sRGB"),o[h+=4]=1,c(o,++h,u(o,h-5,5)),h+=4;var b=t.length>1;if(b&&(c(o,h,8),g(o,h+=4,"acTL"),c(o,h+=4,t.length),c(o,h+=4,0),c(o,h+=4,u(o,h-12,12)),h+=4),3==p.ctype){for(c(o,h,3*(S=p.plte.length)),g(o,h+=4,"PLTE"),h+=4,f=0;f<S;f++){var v=3*f,w=p.plte[f],m=255&w,y=w>>8&255,k=w>>16&255;o[h+v+0]=m,o[h+v+1]=y,o[h+v+2]=k}if(c(o,h+=3*S,u(o,h-3*S-4,3*S+4)),h+=4,p.gotAlpha){for(c(o,h,S),g(o,h+=4,"tRNS"),h+=4,f=0;f<S;f++)o[h+f]=p.plte[f]>>24&255;c(o,h+=S,u(o,h-S-4,S+4)),h+=4}}for(var x=0,z=0;z<p.frames.length;z++){var A=p.frames[z];b&&(c(o,h,26),g(o,h+=4,"fcTL"),c(o,h+=4,x++),c(o,h+=4,A.rect.width),c(o,h+=4,A.rect.height),c(o,h+=4,A.rect.x),c(o,h+=4,A.rect.y),_(o,h+=4,i[z]),_(o,h+=2,1e3),o[h+=2]=A.dispose,o[++h]=A.blend,c(o,++h,u(o,h-30,30)),h+=4);var S,T=A.cimg;c(o,h,(S=T.length)+(0==z?0:4));var U=h+=4;for(g(o,h,0==z?"IDAT":"fdAT"),h+=4,0!=z&&(c(o,h,x++),h+=4),f=0;f<S;f++)o[h+f]=T[f];c(o,h+=S,u(o,U,h-U)),h+=4}return c(o,h,0),g(o,h+=4,"IEND"),c(o,h+=4,u(o,h-4,4)),h+=4,o.buffer.slice(0,h)},e.encode.compressPNG=function(t,r,n,a,i){for(var s=e.encode.compress(t,r,n,a,!1,i),o=0;o<t.length;o++){var l=s.frames[o],f=(l.rect.width,l.rect.height),h=l.bpl,d=l.bpp,u=new Uint8Array(f*h+f);l.cimg=e.encode._filterZero(l.img,f,d,h,u)}return s},e.encode.compress=function(t,r,n,a,i,s){null==s&&(s=!1);for(var o=6,l=8,f=4,h=255,d=0;d<t.length;d++)for(var u=new Uint8Array(t[d]),c=u.length,_=0;_<c;_+=4)h&=u[_+3];var g=255!=h,p={},b=[];if(0!=t.length&&(p[0]=0,b.push(0),0!=a&&a--),0!=a){var v=e.quantize(t,a,i);for(t=v.bufs,_=0;_<v.plte.length;_++)null==p[m=v.plte[_].est.rgba]&&(p[m]=b.length,b.push(m))}else for(d=0;d<t.length;d++){var w=new Uint32Array(t[d]);for(c=w.length,_=0;_<c;_++){var m=w[_];if((_<r||m!=w[_-1]&&m!=w[_-r])&&null==p[m]&&(p[m]=b.length,b.push(m),b.length>=300))break}}var y=!!g&&i,k=b.length;k<=256&&0==s&&(l=k<=2?1:k<=4?2:k<=16?4:8,i&&(l=8),g=!0);var x=[];for(d=0;d<t.length;d++){var z=new Uint8Array(t[d]),A=new Uint32Array(z.buffer),S=0,T=0,U=r,B=n,E=0;if(0!=d&&!y){for(var I=i||1==d||2==x[x.length-2].dispose?1:2,R=0,P=1e9,Z=0;Z<I;Z++){for(var N=new Uint8Array(t[d-1-Z]),L=new Uint32Array(t[d-1-Z]),D=r,M=n,C=-1,O=-1,q=0;q<n;q++)for(var F=0;F<r;F++)A[_=q*r+F]!=L[_]&&(F<D&&(D=F),F>C&&(C=F),q<M&&(M=q),q>O&&(O=q));var j=-1==C?1:(C-D+1)*(O-M+1);j<P&&(P=j,R=Z,-1==C?(S=T=0,U=B=1):(S=D,T=M,U=C-D+1,B=O-M+1))}N=new Uint8Array(t[d-1-R]),1==R&&(x[x.length-1].dispose=2);var H=new Uint8Array(U*B*4);new Uint32Array(H.buffer),e._copyTile(N,r,n,H,U,B,-S,-T,0),e._copyTile(z,r,n,H,U,B,-S,-T,3)?(e._copyTile(z,r,n,H,U,B,-S,-T,2),E=1):(e._copyTile(z,r,n,H,U,B,-S,-T,0),E=0),z=H,A=new Uint32Array(z.buffer)}var G=4*U;if(k<=256&&0==s){for(G=Math.ceil(l*U/8),H=new Uint8Array(G*B),q=0;q<B;q++){_=q*G;var K=q*U;if(8==l)for(F=0;F<U;F++)H[_+F]=p[A[K+F]];else if(4==l)for(F=0;F<U;F++)H[_+(F>>1)]|=p[A[K+F]]<<4-4*(1&F);else if(2==l)for(F=0;F<U;F++)H[_+(F>>2)]|=p[A[K+F]]<<6-2*(3&F);else if(1==l)for(F=0;F<U;F++)H[_+(F>>3)]|=p[A[K+F]]<<7-1*(7&F)}z=H,o=3,f=1}else if(0==g&&1==t.length){H=new Uint8Array(U*B*3);var Y=U*B;for(_=0;_<Y;_++){var X=3*_,V=4*_;H[X]=z[V],H[X+1]=z[V+1],H[X+2]=z[V+2]}z=H,o=2,f=3,G=3*U}x.push({rect:{x:S,y:T,width:U,height:B},img:z,bpl:G,bpp:f,blend:E,dispose:y?1:0})}return{ctype:o,depth:l,plte:b,gotAlpha:g,frames:x}},e.encode._filterZero=function(r,n,a,i,s){for(var o=[],l=0;l<5;l++)if(!(n*i>5e5)||2!=l&&3!=l&&4!=l){for(var f=0;f<n;f++)e.encode._filterLine(s,r,f,i,a,l);if(o.push(t.deflate(s)),1==a)break}for(var h,d=1e9,u=0;u<o.length;u++)o[u].length<d&&(h=u,d=o[u].length);return o[h]},e.encode._filterLine=function(t,r,n,a,i,s){var o=n*a,l=o+n,f=e.decode._paeth;if(t[l]=s,l++,0==s)for(var h=0;h<a;h++)t[l+h]=r[o+h];else if(1==s){for(h=0;h<i;h++)t[l+h]=r[o+h];for(h=i;h<a;h++)t[l+h]=r[o+h]-r[o+h-i]+256&255}else if(0==n){for(h=0;h<i;h++)t[l+h]=r[o+h];if(2==s)for(h=i;h<a;h++)t[l+h]=r[o+h];if(3==s)for(h=i;h<a;h++)t[l+h]=r[o+h]-(r[o+h-i]>>1)+256&255;if(4==s)for(h=i;h<a;h++)t[l+h]=r[o+h]-f(r[o+h-i],0,0)+256&255}else{if(2==s)for(h=0;h<a;h++)t[l+h]=r[o+h]+256-r[o+h-a]&255;if(3==s){for(h=0;h<i;h++)t[l+h]=r[o+h]+256-(r[o+h-a]>>1)&255;for(h=i;h<a;h++)t[l+h]=r[o+h]+256-(r[o+h-a]+r[o+h-i]>>1)&255}if(4==s){for(h=0;h<i;h++)t[l+h]=r[o+h]+256-f(0,r[o+h-a],0)&255;for(h=i;h<a;h++)t[l+h]=r[o+h]+256-f(r[o+h-i],r[o+h-a],r[o+h-i-a])&255}}},e.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var r=t,n=0;n<8;n++)1&r?r=3988292384^r>>>1:r>>>=1;e[t]=r}return e}(),update:function(t,r,n,a){for(var i=0;i<a;i++)t=e.crc.table[255&(t^r[n+i])]^t>>>8;return t},crc:function(t,r,n){return 4294967295^e.crc.update(4294967295,t,r,n)}},e.quantize=function(t,r,n){for(var a=[],i=0,s=0;s<t.length;s++)a.push(e.encode.alphaMul(new Uint8Array(t[s]),n)),i+=t[s].byteLength;var o=new Uint8Array(i),l=new Uint32Array(o.buffer),f=0;for(s=0;s<a.length;s++){for(var h=a[s],d=h.length,u=0;u<d;u++)o[f+u]=h[u];f+=d}var c={i0:0,i1:o.length,bst:null,est:null,tdst:0,left:null,right:null};c.bst=e.quantize.stats(o,c.i0,c.i1),c.est=e.quantize.estats(c.bst);for(var _=[c];_.length<r;){var g=0,p=0;for(s=0;s<_.length;s++)_[s].est.L>g&&(g=_[s].est.L,p=s);if(g<.001)break;var b=_[p],v=e.quantize.splitPixels(o,l,b.i0,b.i1,b.est.e,b.est.eMq255),w={i0:b.i0,i1:v,bst:null,est:null,tdst:0,left:null,right:null};w.bst=e.quantize.stats(o,w.i0,w.i1),w.est=e.quantize.estats(w.bst);var m={i0:v,i1:b.i1,bst:null,est:null,tdst:0,left:null,right:null};for(m.bst={R:[],m:[],N:b.bst.N-w.bst.N},s=0;s<16;s++)m.bst.R[s]=b.bst.R[s]-w.bst.R[s];for(s=0;s<4;s++)m.bst.m[s]=b.bst.m[s]-w.bst.m[s];m.est=e.quantize.estats(m.bst),b.left=w,b.right=m,_[p]=w,_.push(m)}_.sort((function(e,t){return t.bst.N-e.bst.N}));for(var y=0;y<a.length;y++){var k=e.quantize.planeDst,x=new Uint8Array(a[y].buffer),z=new Uint32Array(a[y].buffer),A=x.length;for(s=0;s<A;s+=4){for(var S=x[s]*(1/255),T=x[s+1]*(1/255),U=x[s+2]*(1/255),B=x[s+3]*(1/255),E=c;E.left;)E=k(E.est,S,T,U,B)<=0?E.left:E.right;z[s>>2]=E.est.rgba}a[y]=z.buffer}return{bufs:a,plte:_}},e.quantize.getNearest=function(t,r,n,a,i){if(null==t.left)return t.tdst=e.quantize.dist(t.est.q,r,n,a,i),t;var s=e.quantize.planeDst(t.est,r,n,a,i),o=t.left,l=t.right;s>0&&(o=t.right,l=t.left);var f=e.quantize.getNearest(o,r,n,a,i);if(f.tdst<=s*s)return f;var h=e.quantize.getNearest(l,r,n,a,i);return h.tdst<f.tdst?h:f},e.quantize.planeDst=function(e,t,r,n,a){var i=e.e;return i[0]*t+i[1]*r+i[2]*n+i[3]*a-e.eMq},e.quantize.dist=function(e,t,r,n,a){var i=t-e[0],s=r-e[1],o=n-e[2],l=a-e[3];return i*i+s*s+o*o+l*l},e.quantize.splitPixels=function(t,r,n,a,i,s){var o=e.quantize.vecDot;for(a-=4;n<a;){for(;o(t,n,i)<=s;)n+=4;for(;o(t,a,i)>s;)a-=4;if(n>=a)break;var l=r[n>>2];r[n>>2]=r[a>>2],r[a>>2]=l,n+=4,a-=4}for(;o(t,n,i)>s;)n-=4;return n+4},e.quantize.vecDot=function(e,t,r){return e[t]*r[0]+e[t+1]*r[1]+e[t+2]*r[2]+e[t+3]*r[3]},e.quantize.stats=function(e,t,r){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=[0,0,0,0],i=r-t>>2,s=t;s<r;s+=4){var o=e[s]*(1/255),l=e[s+1]*(1/255),f=e[s+2]*(1/255),h=e[s+3]*(1/255);a[0]+=o,a[1]+=l,a[2]+=f,a[3]+=h,n[0]+=o*o,n[1]+=o*l,n[2]+=o*f,n[3]+=o*h,n[5]+=l*l,n[6]+=l*f,n[7]+=l*h,n[10]+=f*f,n[11]+=f*h,n[15]+=h*h}return n[4]=n[1],n[8]=n[2],n[12]=n[3],n[9]=n[6],n[13]=n[7],n[14]=n[11],{R:n,m:a,N:i}},e.quantize.estats=function(t){var r=t.R,n=t.m,a=t.N,i=n[0],s=n[1],o=n[2],l=n[3],f=0==a?0:1/a,h=[r[0]-i*i*f,r[1]-i*s*f,r[2]-i*o*f,r[3]-i*l*f,r[4]-s*i*f,r[5]-s*s*f,r[6]-s*o*f,r[7]-s*l*f,r[8]-o*i*f,r[9]-o*s*f,r[10]-o*o*f,r[11]-o*l*f,r[12]-l*i*f,r[13]-l*s*f,r[14]-l*o*f,r[15]-l*l*f],d=h,u=e.M4,c=[.5,.5,.5,.5],_=0,g=0;if(0!=a)for(var p=0;p<10&&(c=u.multVec(d,c),g=Math.sqrt(u.dot(c,c)),c=u.sml(1/g,c),!(Math.abs(g-_)<1e-9));p++)_=g;var b=[i*f,s*f,o*f,l*f],v=u.dot(u.sml(255,b),c),w=b[3]<.001?0:1/b[3];return{Cov:h,q:b,e:c,L:_,eMq255:v,eMq:u.dot(c,b),rgba:(Math.round(255*b[3])<<24|Math.round(255*b[2]*w)<<16|Math.round(255*b[1]*w)<<8|Math.round(255*b[0]*w)<<0)>>>0}},e.M4={multVec:function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],e[4]*t[0]+e[5]*t[1]+e[6]*t[2]+e[7]*t[3],e[8]*t[0]+e[9]*t[1]+e[10]*t[2]+e[11]*t[3],e[12]*t[0]+e[13]*t[1]+e[14]*t[2]+e[15]*t[3]]},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},sml:function(e,t){return[e*t[0],e*t[1],e*t[2],e*t[3]]}},e.encode.alphaMul=function(e,t){for(var r=new Uint8Array(e.length),n=e.length>>2,a=0;a<n;a++){var i=a<<2,s=e[i+3];t&&(s=s<128?0:255);var o=s*(1/255);r[i+0]=e[i+0]*o,r[i+1]=e[i+1]*o,r[i+2]=e[i+2]*o,r[i+3]=s}return r}}(n,r(3))}).call(this,r(12))},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){var r,n,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var l,f=[],h=!1,d=-1;function u(){h&&l&&(h=!1,l.length?f=l.concat(f):d=-1,f.length&&c())}function c(){if(!h){var e=o(u);h=!0;for(var t=f.length;t;){for(l=f,f=[];++d<t;)l&&l[d].run();d=-1,t=f.length}l=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new _(e,t)),1!==f.length||h||o(c)},_.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){"use strict";var n=r(14),a=r(0),i=r(6),s=r(2),o=r(7),l=Object.prototype.toString;function f(e){if(!(this instanceof f))return new f(e);this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(s[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var h;if(h="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,h)))throw new Error(s[r]);this._dict_set=!0}}function h(e,t){var r=new f(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}f.prototype.push=function(e,t){var r,s,o=this.strm,f=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new a.Buf8(f),o.next_out=0,o.avail_out=f),1!==(r=n.deflate(o,s))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(i.buf2binstring(a.shrinkBuf(o.output,o.next_out))):this.onData(a.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==r);return 4===s?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==s||(this.onEnd(0),o.avail_out=0,!0)},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=f,t.deflate=h,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,h(e,t)}},function(e,t,r){"use strict";var n,a=r(0),i=r(15),s=r(4),o=r(5),l=r(2);function f(e,t){return e.msg=l[t],t}function h(e){return(e<<1)-(e>4?9:0)}function d(e){for(var t=e.length;--t>=0;)e[t]=0}function u(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(a.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function c(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,u(e.strm)}function _(e,t){e.pending_buf[e.pending++]=t}function g(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function p(e,t){var r,n,a=e.max_chain_length,i=e.strstart,s=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,f=e.window,h=e.w_mask,d=e.prev,u=e.strstart+258,c=f[i+s-1],_=f[i+s];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(f[(r=t)+s]===_&&f[r+s-1]===c&&f[r]===f[i]&&f[++r]===f[i+1]){i+=2,r++;do{}while(f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&f[++i]===f[++r]&&i<u);if(n=258-(u-i),i=u-258,n>s){if(e.match_start=t,s=n,n>=o)break;c=f[i+s-1],_=f[i+s]}}}while((t=d[t&h])>l&&0!=--a);return s<=e.lookahead?s:e.lookahead}function b(e){var t,r,n,i,l,f,h,d,u,c,_=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=_+(_-262)){a.arraySet(e.window,e.window,_,_,0),e.match_start-=_,e.strstart-=_,e.block_start-=_,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=_?n-_:0}while(--r);t=r=_;do{n=e.prev[--t],e.prev[t]=n>=_?n-_:0}while(--r);i+=_}if(0===e.strm.avail_in)break;if(f=e.strm,h=e.window,d=e.strstart+e.lookahead,u=i,c=void 0,(c=f.avail_in)>u&&(c=u),r=0===c?0:(f.avail_in-=c,a.arraySet(h,f.input,f.next_in,c,d),1===f.state.wrap?f.adler=s(f.adler,h,c,d):2===f.state.wrap&&(f.adler=o(f.adler,h,c,d)),f.next_in+=c,f.total_in+=c,c),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var r,n;;){if(e.lookahead<262){if(b(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=p(e,r)),e.match_length>=3)if(n=i._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(c(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(c(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(c(e,!1),0===e.strm.avail_out)?1:2}function w(e,t){for(var r,n,a;;){if(e.lookahead<262){if(b(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=p(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,n=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(c(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=i._tr_tally(e,0,e.window[e.strstart-1]))&&c(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(c(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(c(e,!1),0===e.strm.avail_out)?1:2}function m(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(1146),this.dyn_dtree=new a.Buf16(122),this.bl_tree=new a.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(16),this.heap=new a.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function k(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,i._tr_init(t),0):f(e,-2)}function x(e){var t,r=k(e);return 0===r&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function z(e,t,r,n,i,s){if(!e)return-2;var o=1;if(-1===t&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>9||8!==r||n<8||n>15||t<0||t>9||s<0||s>4)return f(e,-2);8===n&&(n=9);var l=new y;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=r,x(e)}n=[new m(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(b(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,c(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(c(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(c(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(c(e,!1),e.strm.avail_out),1)})),new m(4,4,8,4,v),new m(4,5,16,8,v),new m(4,6,32,32,v),new m(4,4,16,16,w),new m(8,16,32,32,w),new m(8,16,128,128,w),new m(8,32,128,256,w),new m(32,128,258,1024,w),new m(32,258,258,4096,w)],t.deflateInit=function(e,t){return z(e,t,8,15,8,0)},t.deflateInit2=z,t.deflateReset=x,t.deflateResetKeep=k,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var r,a,s,l;if(!e||!e.state||t>5||t<0)return e?f(e,-2):-2;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&4!==t)return f(e,0===e.avail_out?-5:-2);if(a.strm=e,r=a.last_flush,a.last_flush=t,42===a.status)if(2===a.wrap)e.adler=0,_(a,31),_(a,139),_(a,8),a.gzhead?(_(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),_(a,255&a.gzhead.time),_(a,a.gzhead.time>>8&255),_(a,a.gzhead.time>>16&255),_(a,a.gzhead.time>>24&255),_(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),_(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(_(a,255&a.gzhead.extra.length),_(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=o(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(_(a,0),_(a,0),_(a,0),_(a,0),_(a,0),_(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),_(a,3),a.status=113);else{var p=8+(a.w_bits-8<<4)<<8;p|=(a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(p|=32),p+=31-p%31,a.status=113,g(a,p),0!==a.strstart&&(g(a,e.adler>>>16),g(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(s=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),u(e),s=a.pending,a.pending!==a.pending_buf_size));)_(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),u(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,_(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),u(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,_(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=o(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&u(e),a.pending+2<=a.pending_buf_size&&(_(a,255&e.adler),_(a,e.adler>>8&255),e.adler=0,a.status=113)):a.status=113),0!==a.pending){if(u(e),0===e.avail_out)return a.last_flush=-1,0}else if(0===e.avail_in&&h(t)<=h(r)&&4!==t)return f(e,-5);if(666===a.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==a.lookahead||0!==t&&666!==a.status){var v=2===a.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(b(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(c(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(c(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(c(e,!1),0===e.strm.avail_out)?1:2}(a,t):3===a.strategy?function(e,t){for(var r,n,a,s,o=e.window;;){if(e.lookahead<=258){if(b(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=o[a=e.strstart-1])===o[++a]&&n===o[++a]&&n===o[++a]){s=e.strstart+258;do{}while(n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&a<s);e.match_length=258-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=i._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(c(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(c(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(c(e,!1),0===e.strm.avail_out)?1:2}(a,t):n[a.level].func(a,t);if(3!==v&&4!==v||(a.status=666),1===v||3===v)return 0===e.avail_out&&(a.last_flush=-1),0;if(2===v&&(1===t?i._tr_align(a):5!==t&&(i._tr_stored_block(a,0,0,!1),3===t&&(d(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),u(e),0===e.avail_out))return a.last_flush=-1,0}return 4!==t?0:a.wrap<=0?1:(2===a.wrap?(_(a,255&e.adler),_(a,e.adler>>8&255),_(a,e.adler>>16&255),_(a,e.adler>>24&255),_(a,255&e.total_in),_(a,e.total_in>>8&255),_(a,e.total_in>>16&255),_(a,e.total_in>>24&255)):(g(a,e.adler>>>16),g(a,65535&e.adler)),u(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?f(e,-2):(e.state=null,113===t?f(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var r,n,i,o,l,f,h,u,c=t.length;if(!e||!e.state)return-2;if(2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return-2;for(1===o&&(e.adler=s(e.adler,t,c,0)),r.wrap=0,c>=r.w_size&&(0===o&&(d(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new a.Buf8(r.w_size),a.arraySet(u,t,c-r.w_size,r.w_size,0),t=u,c=r.w_size),l=e.avail_in,f=e.next_in,h=e.input,e.avail_in=c,e.next_in=0,e.input=t,b(r);r.lookahead>=3;){n=r.strstart,i=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=2,b(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=f,e.input=h,e.avail_in=l,r.wrap=o,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";var n=r(0);function a(e){for(var t=e.length;--t>=0;)e[t]=0}var i=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);a(f);var h=new Array(60);a(h);var d=new Array(512);a(d);var u=new Array(256);a(u);var c=new Array(29);a(c);var _,g,p,b=new Array(30);function v(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function m(e){return e<256?d[e]:d[256+(e>>>7)]}function y(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function k(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function x(e,t,r){k(e,r[2*t],r[2*t+1])}function z(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function A(e,t,r){var n,a,i=new Array(16),s=0;for(n=1;n<=15;n++)i[n]=s=s+r[n-1]<<1;for(a=0;a<=t;a++){var o=e[2*a+1];0!==o&&(e[2*a]=z(i[o]++,o))}}function S(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function T(e){e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function U(e,t,r,n){var a=2*t,i=2*r;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]}function B(e,t,r){for(var n=e.heap[r],a=r<<1;a<=e.heap_len&&(a<e.heap_len&&U(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!U(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n}function E(e,t,r){var n,a,o,l,f=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*f]<<8|e.pending_buf[e.d_buf+2*f+1],a=e.pending_buf[e.l_buf+f],f++,0===n?x(e,a,t):(x(e,(o=u[a])+256+1,t),0!==(l=i[o])&&k(e,a-=c[o],l),x(e,o=m(--n),r),0!==(l=s[o])&&k(e,n-=b[o],l))}while(f<e.last_lit);x(e,256,t)}function I(e,t){var r,n,a,i=t.dyn_tree,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,f=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==i[2*r]?(e.heap[++e.heap_len]=f=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=f<2?++f:0)]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=s[2*a+1]);for(t.max_code=f,r=e.heap_len>>1;r>=1;r--)B(e,i,r);a=l;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],B(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,i[2*a]=i[2*r]+i[2*n],e.depth[a]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,i[2*r+1]=i[2*n+1]=a,e.heap[1]=a++,B(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,a,i,s,o,l=t.dyn_tree,f=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,_=t.stat_desc.max_length,g=0;for(i=0;i<=15;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(i=l[2*l[2*(n=e.heap[r])+1]+1]+1)>_&&(i=_,g++),l[2*n+1]=i,n>f||(e.bl_count[i]++,s=0,n>=c&&(s=u[n-c]),o=l[2*n],e.opt_len+=o*(i+s),d&&(e.static_len+=o*(h[2*n+1]+s)));if(0!==g){do{for(i=_-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[_]--,g-=2}while(g>0);for(i=_;0!==i;i--)for(n=e.bl_count[i];0!==n;)(a=e.heap[--r])>f||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),n--)}}(e,t),A(i,f,e.bl_count)}function R(e,t,r){var n,a,i=-1,s=t[1],o=0,l=7,f=4;for(0===s&&(l=138,f=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)a=s,s=t[2*(n+1)+1],++o<l&&a===s||(o<f?e.bl_tree[2*a]+=o:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,i=a,0===s?(l=138,f=3):a===s?(l=6,f=3):(l=7,f=4))}function P(e,t,r){var n,a,i=-1,s=t[1],o=0,l=7,f=4;for(0===s&&(l=138,f=3),n=0;n<=r;n++)if(a=s,s=t[2*(n+1)+1],!(++o<l&&a===s)){if(o<f)do{x(e,a,e.bl_tree)}while(0!=--o);else 0!==a?(a!==i&&(x(e,a,e.bl_tree),o--),x(e,16,e.bl_tree),k(e,o-3,2)):o<=10?(x(e,17,e.bl_tree),k(e,o-3,3)):(x(e,18,e.bl_tree),k(e,o-11,7));o=0,i=a,0===s?(l=138,f=3):a===s?(l=6,f=3):(l=7,f=4)}}a(b);var Z=!1;function N(e,t,r,a){k(e,0+(a?1:0),3),function(e,t,r,a){T(e),a&&(y(e,r),y(e,~r)),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}t._tr_init=function(e){Z||(!function(){var e,t,r,n,a,l=new Array(16);for(r=0,n=0;n<28;n++)for(c[n]=r,e=0;e<1<<i[n];e++)u[r++]=n;for(u[r-1]=n,a=0,n=0;n<16;n++)for(b[n]=a,e=0;e<1<<s[n];e++)d[a++]=n;for(a>>=7;n<30;n++)for(b[n]=a<<7,e=0;e<1<<s[n]-7;e++)d[256+a++]=n;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,l[8]++;for(;e<=255;)f[2*e+1]=9,e++,l[9]++;for(;e<=279;)f[2*e+1]=7,e++,l[7]++;for(;e<=287;)f[2*e+1]=8,e++,l[8]++;for(A(f,287,l),e=0;e<30;e++)h[2*e+1]=5,h[2*e]=z(e,5);_=new v(f,i,257,286,15),g=new v(h,s,0,30,15),p=new v(new Array(0),o,0,19,7)}(),Z=!0),e.l_desc=new w(e.dyn_ltree,_),e.d_desc=new w(e.dyn_dtree,g),e.bl_desc=new w(e.bl_tree,p),e.bi_buf=0,e.bi_valid=0,S(e)},t._tr_stored_block=N,t._tr_flush_block=function(e,t,r,n){var a,i,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),I(e,e.l_desc),I(e,e.d_desc),s=function(e){var t;for(R(e,e.dyn_ltree,e.l_desc.max_code),R(e,e.dyn_dtree,e.d_desc.max_code),I(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=a&&(a=i)):a=i=r+5,r+4<=a&&-1!==t?N(e,t,r,n):4===e.strategy||i===a?(k(e,2+(n?1:0),3),E(e,f,h)):(k(e,4+(n?1:0),3),function(e,t,r,n){var a;for(k(e,t-257,5),k(e,r-1,5),k(e,n-4,4),a=0;a<n;a++)k(e,e.bl_tree[2*l[a]+1],3);P(e,e.dyn_ltree,t-1),P(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),E(e,e.dyn_ltree,e.dyn_dtree)),S(e),n&&T(e)},t._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(u[r]+256+1)]++,e.dyn_dtree[2*m(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){k(e,2,3),x(e,256,f),function(e){16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,r){"use strict";var n=r(17),a=r(0),i=r(6),s=r(8),o=r(2),l=r(7),f=r(20),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==s.Z_OK)throw new Error(o[r]);if(this.header=new f,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=i.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=n.inflateSetDictionary(this.strm,t.dictionary))!==s.Z_OK))throw new Error(o[r])}function u(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}d.prototype.push=function(e,t){var r,o,l,f,d,u=this.strm,c=this.options.chunkSize,_=this.options.dictionary,g=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?u.input=i.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new a.Buf8(c),u.next_out=0,u.avail_out=c),(r=n.inflate(u,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&_&&(r=n.inflateSetDictionary(this.strm,_)),r===s.Z_BUF_ERROR&&!0===g&&(r=s.Z_OK,g=!1),r!==s.Z_STREAM_END&&r!==s.Z_OK)return this.onEnd(r),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&r!==s.Z_STREAM_END&&(0!==u.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(u.output,u.next_out),f=u.next_out-l,d=i.buf2string(u.output,l),u.next_out=f,u.avail_out=c-f,f&&a.arraySet(u.output,u.output,l,f,0),this.onData(d)):this.onData(a.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(g=!0)}while((u.avail_in>0||0===u.avail_out)&&r!==s.Z_STREAM_END);return r===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=u,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},t.ungzip=u},function(e,t,r){"use strict";var n=r(0),a=r(4),i=r(5),s=r(18),o=r(19);function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):-2}function u(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))):-2}function c(e,t){var r,n;return e?(n=new f,e.state=n,n.window=null,0!==(r=u(e,t))&&(e.state=null),r):-2}var _,g,p=!0;function b(e){if(p){var t;for(_=new n.Buf32(512),g=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,g,0,e.work,{bits:5}),p=!1}e.lencode=_,e.lenbits=9,e.distcode=g,e.distbits=5}function v(e,t,r,a){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),a>=s.wsize?(n.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((i=s.wsize-s.wnext)>a&&(i=a),n.arraySet(s.window,t,r-a,i,s.wnext),(a-=i)?(n.arraySet(s.window,t,r-a,a,0),s.wnext=a,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}t.inflateReset=d,t.inflateReset2=u,t.inflateResetKeep=h,t.inflateInit=function(e){return c(e,15)},t.inflateInit2=c,t.inflate=function(e,t){var r,f,h,d,u,c,_,g,p,w,m,y,k,x,z,A,S,T,U,B,E,I,R,P,Z=0,N=new n.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),u=e.next_out,h=e.output,_=e.avail_out,d=e.next_in,f=e.input,c=e.avail_in,g=r.hold,p=r.bits,w=c,m=_,I=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;p<16;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(2&r.wrap&&35615===g){r.check=0,N[0]=255&g,N[1]=g>>>8&255,r.check=i(r.check,N,2,0),g=0,p=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(p-=4,E=8+(15&(g>>>=4)),0===r.wbits)r.wbits=E;else if(E>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<E,e.adler=r.check=1,r.mode=512&g?10:12,g=0,p=0;break;case 2:for(;p<16;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=i(r.check,N,2,0)),g=0,p=0,r.mode=3;case 3:for(;p<32;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.head&&(r.head.time=g),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,N[2]=g>>>16&255,N[3]=g>>>24&255,r.check=i(r.check,N,4,0)),g=0,p=0,r.mode=4;case 4:for(;p<16;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=i(r.check,N,2,0)),g=0,p=0,r.mode=5;case 5:if(1024&r.flags){for(;p<16;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(N[0]=255&g,N[1]=g>>>8&255,r.check=i(r.check,N,2,0)),g=0,p=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((y=r.length)>c&&(y=c),y&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,f,d,y,E)),512&r.flags&&(r.check=i(r.check,f,y,d)),c-=y,d+=y,r.length-=y),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===c)break e;y=0;do{E=f[d+y++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E))}while(E&&y<c);if(512&r.flags&&(r.check=i(r.check,f,y,d)),c-=y,d+=y,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===c)break e;y=0;do{E=f[d+y++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E))}while(E&&y<c);if(512&r.flags&&(r.check=i(r.check,f,y,d)),c-=y,d+=y,E)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;p<16;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}g=0,p=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;p<32;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}e.adler=r.check=l(g),g=0,p=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=u,e.avail_out=_,e.next_in=d,e.avail_in=c,r.hold=g,r.bits=p,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&p,p-=7&p,r.mode=27;break}for(;p<3;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}switch(r.last=1&g,p-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(b(r),r.mode=20,6===t){g>>>=2,p-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,p-=2;break;case 14:for(g>>>=7&p,p-=7&p;p<32;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,g=0,p=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(y=r.length){if(y>c&&(y=c),y>_&&(y=_),0===y)break e;n.arraySet(h,f,d,y,u),c-=y,d+=y,_-=y,u+=y,r.length-=y;break}r.mode=12;break;case 17:for(;p<14;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(r.nlen=257+(31&g),g>>>=5,p-=5,r.ndist=1+(31&g),g>>>=5,p-=5,r.ncode=4+(15&g),g>>>=4,p-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;p<3;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.lens[L[r.have++]]=7&g,g>>>=3,p-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},I=o(0,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,I){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;A=(Z=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,S=65535&Z,!((z=Z>>>24)<=p);){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(S<16)g>>>=z,p-=z,r.lens[r.have++]=S;else{if(16===S){for(P=z+2;p<P;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(g>>>=z,p-=z,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}E=r.lens[r.have-1],y=3+(3&g),g>>>=2,p-=2}else if(17===S){for(P=z+3;p<P;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}p-=z,E=0,y=3+(7&(g>>>=z)),g>>>=3,p-=3}else{for(P=z+7;p<P;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}p-=z,E=0,y=11+(127&(g>>>=z)),g>>>=7,p-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;y--;)r.lens[r.have++]=E}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,R={bits:r.lenbits},I=o(1,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,I){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},I=o(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,I){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(c>=6&&_>=258){e.next_out=u,e.avail_out=_,e.next_in=d,e.avail_in=c,r.hold=g,r.bits=p,s(e,m),u=e.next_out,h=e.output,_=e.avail_out,d=e.next_in,f=e.input,c=e.avail_in,g=r.hold,p=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;A=(Z=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,S=65535&Z,!((z=Z>>>24)<=p);){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(A&&0==(240&A)){for(T=z,U=A,B=S;A=(Z=r.lencode[B+((g&(1<<T+U)-1)>>T)])>>>16&255,S=65535&Z,!(T+(z=Z>>>24)<=p);){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}g>>>=T,p-=T,r.back+=T}if(g>>>=z,p-=z,r.back+=z,r.length=S,0===A){r.mode=26;break}if(32&A){r.back=-1,r.mode=12;break}if(64&A){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&A,r.mode=22;case 22:if(r.extra){for(P=r.extra;p<P;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,p-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;A=(Z=r.distcode[g&(1<<r.distbits)-1])>>>16&255,S=65535&Z,!((z=Z>>>24)<=p);){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(0==(240&A)){for(T=z,U=A,B=S;A=(Z=r.distcode[B+((g&(1<<T+U)-1)>>T)])>>>16&255,S=65535&Z,!(T+(z=Z>>>24)<=p);){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}g>>>=T,p-=T,r.back+=T}if(g>>>=z,p-=z,r.back+=z,64&A){e.msg="invalid distance code",r.mode=30;break}r.offset=S,r.extra=15&A,r.mode=24;case 24:if(r.extra){for(P=r.extra;p<P;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,p-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===_)break e;if(y=m-_,r.offset>y){if((y=r.offset-y)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}y>r.wnext?(y-=r.wnext,k=r.wsize-y):k=r.wnext-y,y>r.length&&(y=r.length),x=r.window}else x=h,k=u-r.offset,y=r.length;y>_&&(y=_),_-=y,r.length-=y;do{h[u++]=x[k++]}while(--y);0===r.length&&(r.mode=21);break;case 26:if(0===_)break e;h[u++]=r.length,_--,r.mode=21;break;case 27:if(r.wrap){for(;p<32;){if(0===c)break e;c--,g|=f[d++]<<p,p+=8}if(m-=_,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?i(r.check,h,m,u-m):a(r.check,h,m,u-m)),m=_,(r.flags?g:l(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}g=0,p=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;p<32;){if(0===c)break e;c--,g+=f[d++]<<p,p+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}g=0,p=0}r.mode=29;case 29:I=1;break e;case 30:I=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=u,e.avail_out=_,e.next_in=d,e.avail_in=c,r.hold=g,r.bits=p,(r.wsize||m!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&v(e,e.output,e.next_out,m-e.avail_out)?(r.mode=31,-4):(w-=e.avail_in,m-=e.avail_out,e.total_in+=w,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?i(r.check,h,m,e.next_out-m):a(r.check,h,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===w&&0===m||4===t)&&0===I&&(I=-5),I)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&a(1,t,n,0)!==r.check?-3:v(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function(e,t){var r,n,a,i,s,o,l,f,h,d,u,c,_,g,p,b,v,w,m,y,k,x,z,A,S;r=e.state,n=e.next_in,A=e.input,a=n+(e.avail_in-5),i=e.next_out,S=e.output,s=i-(t-e.avail_out),o=i+(e.avail_out-257),l=r.dmax,f=r.wsize,h=r.whave,d=r.wnext,u=r.window,c=r.hold,_=r.bits,g=r.lencode,p=r.distcode,b=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{_<15&&(c+=A[n++]<<_,_+=8,c+=A[n++]<<_,_+=8),w=g[c&b];t:for(;;){if(c>>>=m=w>>>24,_-=m,0===(m=w>>>16&255))S[i++]=65535&w;else{if(!(16&m)){if(0==(64&m)){w=g[(65535&w)+(c&(1<<m)-1)];continue t}if(32&m){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}y=65535&w,(m&=15)&&(_<m&&(c+=A[n++]<<_,_+=8),y+=c&(1<<m)-1,c>>>=m,_-=m),_<15&&(c+=A[n++]<<_,_+=8,c+=A[n++]<<_,_+=8),w=p[c&v];r:for(;;){if(c>>>=m=w>>>24,_-=m,!(16&(m=w>>>16&255))){if(0==(64&m)){w=p[(65535&w)+(c&(1<<m)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(k=65535&w,_<(m&=15)&&(c+=A[n++]<<_,(_+=8)<m&&(c+=A[n++]<<_,_+=8)),(k+=c&(1<<m)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(c>>>=m,_-=m,k>(m=i-s)){if((m=k-m)>h&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(x=0,z=u,0===d){if(x+=f-m,m<y){y-=m;do{S[i++]=u[x++]}while(--m);x=i-k,z=S}}else if(d<m){if(x+=f+d-m,(m-=d)<y){y-=m;do{S[i++]=u[x++]}while(--m);if(x=0,d<y){y-=m=d;do{S[i++]=u[x++]}while(--m);x=i-k,z=S}}}else if(x+=d-m,m<y){y-=m;do{S[i++]=u[x++]}while(--m);x=i-k,z=S}for(;y>2;)S[i++]=z[x++],S[i++]=z[x++],S[i++]=z[x++],y-=3;y&&(S[i++]=z[x++],y>1&&(S[i++]=z[x++]))}else{x=i-k;do{S[i++]=S[x++],S[i++]=S[x++],S[i++]=S[x++],y-=3}while(y>2);y&&(S[i++]=S[x++],y>1&&(S[i++]=S[x++]))}break}}break}}while(n<a&&i<o);n-=y=_>>3,c&=(1<<(_-=y<<3))-1,e.next_in=n,e.next_out=i,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=i<o?o-i+257:257-(i-o),r.hold=c,r.bits=_}},function(e,t,r){"use strict";var n=r(0),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,l,f,h,d,u){var c,_,g,p,b,v,w,m,y,k=u.bits,x=0,z=0,A=0,S=0,T=0,U=0,B=0,E=0,I=0,R=0,P=null,Z=0,N=new n.Buf16(16),L=new n.Buf16(16),D=null,M=0;for(x=0;x<=15;x++)N[x]=0;for(z=0;z<l;z++)N[t[r+z]]++;for(T=k,S=15;S>=1&&0===N[S];S--);if(T>S&&(T=S),0===S)return f[h++]=20971520,f[h++]=20971520,u.bits=1,0;for(A=1;A<S&&0===N[A];A++);for(T<A&&(T=A),E=1,x=1;x<=15;x++)if(E<<=1,(E-=N[x])<0)return-1;if(E>0&&(0===e||1!==S))return-1;for(L[1]=0,x=1;x<15;x++)L[x+1]=L[x]+N[x];for(z=0;z<l;z++)0!==t[r+z]&&(d[L[t[r+z]]++]=z);if(0===e?(P=D=d,v=19):1===e?(P=a,Z-=257,D=i,M-=257,v=256):(P=s,D=o,v=-1),R=0,z=0,x=A,b=h,U=T,B=0,g=-1,p=(I=1<<T)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){w=x-B,d[z]<v?(m=0,y=d[z]):d[z]>v?(m=D[M+d[z]],y=P[Z+d[z]]):(m=96,y=0),c=1<<x-B,A=_=1<<U;do{f[b+(R>>B)+(_-=c)]=w<<24|m<<16|y|0}while(0!==_);for(c=1<<x-1;R&c;)c>>=1;if(0!==c?(R&=c-1,R+=c):R=0,z++,0==--N[x]){if(x===S)break;x=t[r+d[z]]}if(x>T&&(R&p)!==g){for(0===B&&(B=T),b+=A,E=1<<(U=x-B);U+B<S&&!((E-=N[U+B])<=0);)U++,E<<=1;if(I+=1<<U,1===e&&I>852||2===e&&I>592)return 1;f[g=R&p]=T<<24|U<<16|b-h|0}}return 0!==R&&(f[b+R]=x-B<<24|64<<16|0),u.bits=T,0}},function(e,t,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t,r){"use strict";r.r(t);var n,a=r(1),i=r.n(a),s=r(9),o=r.n(s),l=r(3),f=r.n(l),h=r(10),d=r.n(h),u=r(11),c=r.n(u),_=function(){function e(t){d()(this,e),this.target=t,this.events={}}return c()(e,[{key:"addListener",value:function(e,t,r){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push({caller:t,thisArg:r||this.target})}},{key:"addExclusiveListener",value:function(e,t,r){this.events[e]=[],this.events[e].push({caller:t,thisArg:r||this.target})}},{key:"dispatch",value:function(e,t){var r="[object Array]"===Object.prototype.toString.call(t)?t:[];this.events[e]&&this.events[e].forEach((function(e){e.caller.apply(e.thisArg,r)}))}},{key:"removeEventListener",value:function(e,t){var r=this;this.events[e]&&this.events[e].forEach((function(n,a){n.caller===t&&delete r.events[e][a]}))}},{key:"removeListener",value:function(e,t){this.removeEventListener(e,t)}},{key:"removeEventListeners",value:function(e){this.events[e]=[]}}]),e}(),g=Object.assign({},o.a);g.debug=(n={enable:!1,time:null},i()(n,"enable",(function(){this.enable=!0})),i()(n,"disable",(function(){this.enable=!1})),i()(n,"startTime",(function(){this.enable&&(this.time=Date.now())})),i()(n,"endTime",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.enable){var r=Date.now()-this.time;e&&this.outputTime(r,t)}})),i()(n,"outputTime",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.enable&&(t=null===t?"general":t)&&console.log(t,e)})),i()(n,"log",(function(e){this.enable&&console.log(e)})),n),g.progress={totalProgress:0,currentProgress:0,setTotalProgress:function(e){this.totalProgress=e,this.stages={}},setStageTargetProgress:function(e,t,r){if(this.stages[e])throw\'duplicated progress stage "\'+e+\'"\';this.stages[e]={targetProgress:t,steps:r}},nextStageStep:function(e){if(void 0===this.stages[e])throw\'unkown progress stage "\'+e+\'"\';var t=this.stages[e];this.currentProgress+=Math.floor(1*t.targetProgress/t.steps),g.event.dispatch("onProgress",[this.currentProgress,this.totalProgress]),g.debug.log("current progress / total progress: "+this.currentProgress+" / "+this.totalProgress)},complete:function(){this.currentProgress=this.totalProgress,g.event.dispatch("onProgress",[this.currentProgress,this.totalProgress]),g.debug.log("current progress / total progress: "+this.currentProgress+" / "+this.totalProgress)}},g.event=new _,g.encode=function(e,t,r,n,a,i){g.progress.setTotalProgress(1e3),null==n&&(n=0),null==i&&(i=!1);for(var s=new Uint8Array(e[0].byteLength*e.length+100),o=[137,80,78,71,13,10,26,10],l=0;l<8;l++)s[l]=o[l];var f=8,h=g._bin,d=g.crc.crc,u=h.writeUint,c=h.writeUshort,_=h.writeASCII,p=g.encode.compressPNG(e,t,r,n,i);u(s,f,13),_(s,f+=4,"IHDR"),u(s,f+=4,t),u(s,f+=4,r),s[f+=4]=p.depth,s[++f]=p.ctype,s[++f]=0,s[++f]=0,s[++f]=0,u(s,++f,d(s,f-17,17)),u(s,f+=4,1),_(s,f+=4,"sRGB"),s[f+=4]=1,u(s,++f,d(s,f-5,5)),f+=4;var b=e.length>1;if(b&&(u(s,f,8),_(s,f+=4,"acTL"),u(s,f+=4,e.length),u(s,f+=4,0),u(s,f+=4,d(s,f-12,12)),f+=4),3==p.ctype){u(s,f,3*(S=p.plte.length)),_(s,f+=4,"PLTE"),f+=4;for(l=0;l<S;l++){var v=3*l,w=p.plte[l],m=255&w,y=w>>8&255,k=w>>16&255;s[f+v+0]=m,s[f+v+1]=y,s[f+v+2]=k}if(u(s,f+=3*S,d(s,f-3*S-4,3*S+4)),f+=4,p.gotAlpha){u(s,f,S),_(s,f+=4,"tRNS"),f+=4;for(l=0;l<S;l++)s[f+l]=p.plte[l]>>24&255;u(s,f+=S,d(s,f-S-4,S+4)),f+=4}}g.debug.startTime();for(var x=0,z=0;z<p.frames.length;z++){var A=p.frames[z];b&&(u(s,f,26),_(s,f+=4,"fcTL"),u(s,f+=4,x++),u(s,f+=4,A.rect.width),u(s,f+=4,A.rect.height),u(s,f+=4,A.rect.x),u(s,f+=4,A.rect.y),c(s,f+=4,a[z]),c(s,f+=2,1e3),s[f+=2]=A.dispose,s[++f]=A.blend,u(s,++f,d(s,f-30,30)),f+=4);var S,T=A.cimg;u(s,f,(S=T.length)+(0==z?0:4));var U=f+=4;_(s,f,0==z?"IDAT":"fdAT"),f+=4,0!=z&&(u(s,f,x++),f+=4);for(l=0;l<S;l++)s[f+l]=T[l];u(s,f+=S,d(s,U,f-U)),f+=4}return g.debug.endTime(!0,"frames"),u(s,f,0),_(s,f+=4,"IEND"),u(s,f+=4,d(s,f-4,4)),f+=4,g.progress.complete(),s.buffer.slice(0,f)},g.encode.compressPNG=function(e,t,r,n,a){g.debug.startTime();var i=g.encode.compress(e,t,r,n,!1,a);g.debug.endTime(!0,"compress"),g.debug.startTime(),g.progress.setStageTargetProgress("compressPNG",900,e.length);for(var s=0;s<e.length;s++){var o=i.frames[s],l=(o.rect.width,o.rect.height),f=o.bpl,h=o.bpp,d=new Uint8Array(l*f+l);o.cimg=g.encode._filterZero(o.img,l,h,f,d),g.progress.nextStageStep("compressPNG")}return g.debug.endTime(!0,"filterZero"),i},g.encode.compress=function(e,t,r,n,a,i){g.progress.setStageTargetProgress("compress",100,e.length),null==i&&(i=!1);for(var s=6,o=8,l=4,f=255,h=0;h<e.length;h++)for(var d=new Uint8Array(e[h]),u=d.length,c=0;c<u;c+=4)f&=d[c+3];var _=255!=f,p={},b=[];if(0!=e.length&&(p[0]=0,b.push(0),0!=n&&n--),0!=n){var v=g.quantize(e,n,a);e=v.bufs;for(c=0;c<v.plte.length;c++){null==p[m=v.plte[c].est.rgba]&&(p[m]=b.length,b.push(m))}}else for(h=0;h<e.length;h++){var w=new Uint32Array(e[h]);for(u=w.length,c=0;c<u;c++){var m=w[c];if((c<t||m!=w[c-1]&&m!=w[c-t])&&null==p[m]&&(p[m]=b.length,b.push(m),b.length>=300))break}}var y=!!_&&a,k=b.length;k<=256&&0==i&&(o=k<=2?1:k<=4?2:k<=16?4:8,a&&(o=8),_=!0);var x=[];for(h=0;h<e.length;h++){var z=new Uint8Array(e[h]),A=new Uint32Array(z.buffer),S=0,T=0,U=t,B=r,E=0;if(0!=h&&!y){for(var I=a||1==h||2==x[x.length-2].dispose?1:2,R=0,P=1e9,Z=0;Z<I;Z++){for(var N=new Uint8Array(e[h-1-Z]),L=new Uint32Array(e[h-1-Z]),D=t,M=r,C=-1,O=-1,q=0;q<r;q++)for(var F=0;F<t;F++){A[c=q*t+F]!=L[c]&&(F<D&&(D=F),F>C&&(C=F),q<M&&(M=q),q>O&&(O=q))}var j=-1==C?1:(C-D+1)*(O-M+1);j<P&&(P=j,R=Z,-1==C?(S=T=0,U=B=1):(S=D,T=M,U=C-D+1,B=O-M+1))}N=new Uint8Array(e[h-1-R]);1==R&&(x[x.length-1].dispose=2);var H=new Uint8Array(U*B*4);new Uint32Array(H.buffer);g._copyTile(N,t,r,H,U,B,-S,-T,0),g._copyTile(z,t,r,H,U,B,-S,-T,3)?(g._copyTile(z,t,r,H,U,B,-S,-T,2),E=1):(g._copyTile(z,t,r,H,U,B,-S,-T,0),E=0),z=H,A=new Uint32Array(z.buffer)}var G=4*U;if(k<=256&&0==i){G=Math.ceil(o*U/8);for(H=new Uint8Array(G*B),q=0;q<B;q++){c=q*G;var K=q*U;if(8==o)for(F=0;F<U;F++)H[c+F]=p[A[K+F]];else if(4==o)for(F=0;F<U;F++)H[c+(F>>1)]|=p[A[K+F]]<<4-4*(1&F);else if(2==o)for(F=0;F<U;F++)H[c+(F>>2)]|=p[A[K+F]]<<6-2*(3&F);else if(1==o)for(F=0;F<U;F++)H[c+(F>>3)]|=p[A[K+F]]<<7-1*(7&F)}z=H,s=3,l=1}else if(0==_&&1==e.length){H=new Uint8Array(U*B*3);var Y=U*B;for(c=0;c<Y;c++){var X=3*c,V=4*c;H[X]=z[V],H[X+1]=z[V+1],H[X+2]=z[V+2]}z=H,s=2,l=3,G=3*U}x.push({rect:{x:S,y:T,width:U,height:B},img:z,bpl:G,bpp:l,blend:E,dispose:y?1:0}),g.progress.nextStageStep("compress")}return{ctype:s,depth:o,plte:b,gotAlpha:_,frames:x}},g.encode._filterZero=function(e,t,r,n,a){for(var i=[],s=0;s<5;s++)if(!(t*n>5e5)||2!=s&&3!=s&&4!=s){for(var o=0;o<t;o++)g.encode._filterLine(a,e,o,n,r,s);if(i.push(f.a.deflate(a)),1==r)break}for(var l,h=1e9,d=0;d<i.length;d++)i[d].length<h&&(l=d,h=i[d].length);return i[l]},g.encode._filterLine=function(e,t,r,n,a,i){var s=r*n,o=s+r,l=g.decode._paeth;if(e[o]=i,o++,0==i)for(var f=0;f<n;f++)e[o+f]=t[s+f];else if(1==i){for(f=0;f<a;f++)e[o+f]=t[s+f];for(f=a;f<n;f++)e[o+f]=t[s+f]-t[s+f-a]+256&255}else if(0==r){for(f=0;f<a;f++)e[o+f]=t[s+f];if(2==i)for(f=a;f<n;f++)e[o+f]=t[s+f];if(3==i)for(f=a;f<n;f++)e[o+f]=t[s+f]-(t[s+f-a]>>1)+256&255;if(4==i)for(f=a;f<n;f++)e[o+f]=t[s+f]-l(t[s+f-a],0,0)+256&255}else{if(2==i)for(f=0;f<n;f++)e[o+f]=t[s+f]+256-t[s+f-n]&255;if(3==i){for(f=0;f<a;f++)e[o+f]=t[s+f]+256-(t[s+f-n]>>1)&255;for(f=a;f<n;f++)e[o+f]=t[s+f]+256-(t[s+f-n]+t[s+f-a]>>1)&255}if(4==i){for(f=0;f<a;f++)e[o+f]=t[s+f]+256-l(0,t[s+f-n],0)&255;for(f=a;f<n;f++)e[o+f]=t[s+f]+256-l(t[s+f-a],t[s+f-n],t[s+f-a-n])&255}}};var p=g;self.onmessage=e=>{p.event.addListener("onProgress",(e,t)=>{self.postMessage({progress:{currentProgress:e,totalProgress:t}})});let t=p.encode(e.data.imagesData,e.data.size.width,e.data.size.height,0,e.data.delays);self.postMessage({arrayBuffer:t})}}]);',"Worker",void 0,void 0)}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var G=function(e){f()(n,e);var t=Z(n);function n(e,r,o){var i;return a()(this,n),(i=t.call(this)).status=0,i.zip=e,i.mimeType=r,i.frames=o,i.imagesData=[],i.delays=[],i.repeat=0,i.currentRepeat=0,i}return i()(n,[{key:"setRepeat",value:function(e){this.repeat=this.currentRepeat=parseInt(e)}},{key:"getImagesData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){n<t.frames.length?t.zip.file(t.frames[n].file).async("base64").then((function(n){return O("data:"+t.mimeType+";base64,"+n,e)})).then((function(a){t.imagesData.push(a.getContext("2d").getImageData(0,0,e.width,e.height).data.buffer),t.delays.push(t.frames[n].delay),t.dispatch("data",[t.frames.length*(t.repeat+1),t.frames.length*(t.repeat-t.currentRepeat)+n+1]),r(t.getImagesData(e,n+1))})):t.currentRepeat>0?(t.currentRepeat--,r(t.getImagesData(e))):r()}))}},{key:"generate",value:function(){var e=this;this.status=1,this.dispatch("start"),this.zip.file(this.frames[0].file).async("base64").then((function(t){var n="data:"+e.mimeType+";base64,"+t;F(n).then((function(t){e.getImagesData(t).then((function(){var n=new q;n.postMessage({imagesData:e.imagesData,size:t,delays:e.delays}),n.onmessage=function(t){t.data.progress?e.dispatch("progress",[t.data.progress.currentProgress/t.data.progress.totalProgress]):t.data.arrayBuffer&&(e.status=2,e.dispatch("finish",[new Blob([t.data.arrayBuffer],{type:"image/apng"})]))}}))}))}))}}]),n}(w.a),K=window.URL.createObjectURL(new Blob(["(function(b){function a(b,d){if({}.hasOwnProperty.call(a.cache,b))return a.cache[b];var e=a.resolve(b);if(!e)throw new Error('Failed to resolve module '+b);var c={id:b,require:a,filename:b,exports:{},loaded:!1,parent:d,children:[]};d&&d.children.push(c);var f=b.slice(0,b.lastIndexOf('/')+1);return a.cache[b]=c.exports,e.call(c.exports,c,c.exports,f,b),c.loaded=!0,a.cache[b]=c.exports}a.modules={},a.cache={},a.resolve=function(b){return{}.hasOwnProperty.call(a.modules,b)?a.modules[b]:void 0},a.define=function(b,c){a.modules[b]=c},a.define('/gif.worker.coffee',function(d,e,f,g){var b,c;b=a('/GIFEncoder.js',d),c=function(a){var c,e,d,f;return c=new b(a.width,a.height),a.index===0?c.writeHeader():c.firstFrame=!1,c.setTransparent(a.transparent),c.setRepeat(a.repeat),c.setDelay(a.delay),c.setQuality(a.quality),c.addFrame(a.data),a.last&&c.finish(),d=c.stream(),a.data=d.pages,a.cursor=d.cursor,a.pageSize=d.constructor.pageSize,a.canTransfer?(f=function(c){for(var b=0,d=a.data.length;b<d;++b)e=a.data[b],c.push(e.buffer);return c}.call(this,[]),self.postMessage(a,f)):self.postMessage(a)},self.onmessage=function(a){return c(a.data)}}),a.define('/GIFEncoder.js',function(e,h,i,j){function c(){this.page=-1,this.pages=[],this.newPage()}function b(a,b){this.width=~~a,this.height=~~b,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.out=new c}var f=a('/TypedNeuQuant.js',e),g=a('/LZWEncoder.js',e);c.pageSize=4096,c.charMap={};for(var d=0;d<256;d++)c.charMap[d]=String.fromCharCode(d);c.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(c.pageSize),this.cursor=0},c.prototype.getData=function(){var d='';for(var a=0;a<this.pages.length;a++)for(var b=0;b<c.pageSize;b++)d+=c.charMap[this.pages[a][b]];return d},c.prototype.writeByte=function(a){this.cursor>=c.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a},c.prototype.writeUTFBytes=function(b){for(var c=b.length,a=0;a<c;a++)this.writeByte(b.charCodeAt(a))},c.prototype.writeBytes=function(b,d,e){for(var c=e||b.length,a=d||0;a<c;a++)this.writeByte(b[a])},b.prototype.setDelay=function(a){this.delay=Math.round(a/10)},b.prototype.setFrameRate=function(a){this.delay=Math.round(100/a)},b.prototype.setDispose=function(a){a>=0&&(this.dispose=a)},b.prototype.setRepeat=function(a){this.repeat=a},b.prototype.setTransparent=function(a){this.transparent=a},b.prototype.addFrame=function(a){this.image=a,this.getImagePixels(),this.analyzePixels(),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.writePixels(),this.firstFrame=!1},b.prototype.finish=function(){this.out.writeByte(59)},b.prototype.setQuality=function(a){a<1&&(a=1),this.sample=a},b.prototype.writeHeader=function(){this.out.writeUTFBytes('GIF89a')},b.prototype.analyzePixels=function(){var g=this.pixels.length,d=g/3;this.indexedPixels=new Uint8Array(d);var a=new f(this.pixels,this.sample);a.buildColormap(),this.colorTab=a.getColormap();var b=0;for(var c=0;c<d;c++){var e=a.lookupRGB(this.pixels[b++]&255,this.pixels[b++]&255,this.pixels[b++]&255);this.usedEntry[e]=!0,this.indexedPixels[c]=e}this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent))},b.prototype.findClosest=function(e){if(this.colorTab===null)return-1;var k=(e&16711680)>>16,l=(e&65280)>>8,m=e&255,c=0,d=16777216,j=this.colorTab.length;for(var a=0;a<j;){var f=k-(this.colorTab[a++]&255),g=l-(this.colorTab[a++]&255),h=m-(this.colorTab[a]&255),i=f*f+g*g+h*h,b=parseInt(a/3);this.usedEntry[b]&&i<d&&(d=i,c=b),a++}return c},b.prototype.getImagePixels=function(){var a=this.width,g=this.height;this.pixels=new Uint8Array(a*g*3);var b=this.image,c=0;for(var d=0;d<g;d++)for(var e=0;e<a;e++){var f=d*a*4+e*4;this.pixels[c++]=b[f],this.pixels[c++]=b[f+1],this.pixels[c++]=b[f+2]}},b.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var b,a;this.transparent===null?(b=0,a=0):(b=1,a=2),this.dispose>=0&&(a=dispose&7),a<<=2,this.out.writeByte(0|a|0|b),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},b.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},b.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},b.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes('NETSCAPE2.0'),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},b.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);var b=768-this.colorTab.length;for(var a=0;a<b;a++)this.out.writeByte(0)},b.prototype.writeShort=function(a){this.out.writeByte(a&255),this.out.writeByte(a>>8&255)},b.prototype.writePixels=function(){var a=new g(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)},b.prototype.stream=function(){return this.out},e.exports=b}),a.define('/LZWEncoder.js',function(e,g,h,i){function f(y,D,C,B){function w(a,b){r[f++]=a,f>=254&&t(b)}function x(b){u(a),k=i+2,j=!0,l(i,b)}function u(b){for(var a=0;a<b;++a)h[a]=-1}function A(z,r){var g,t,d,e,y,w,s;for(q=z,j=!1,n_bits=q,m=p(n_bits),i=1<<z-1,o=i+1,k=i+2,f=0,e=v(),s=0,g=a;g<65536;g*=2)++s;s=8-s,w=a,u(w),l(i,r);a:while((t=v())!=c){if(g=(t<<b)+e,d=t<<s^e,h[d]===g){e=n[d];continue}if(h[d]>=0){y=w-d,d===0&&(y=1);do if((d-=y)<0&&(d+=w),h[d]===g){e=n[d];continue a}while(h[d]>=0)}l(e,r),e=t,k<1<<b?(n[d]=k++,h[d]=g):x(r)}l(e,r),l(o,r)}function z(a){a.writeByte(s),remaining=y*D,curPixel=0,A(s+1,a),a.writeByte(0)}function t(a){f>0&&(a.writeByte(f),a.writeBytes(r,0,f),f=0)}function p(a){return(1<<a)-1}function v(){if(remaining===0)return c;--remaining;var a=C[curPixel++];return a&255}function l(a,c){g&=d[e],e>0?g|=a<<e:g=a,e+=n_bits;while(e>=8)w(g&255,c),g>>=8,e-=8;if((k>m||j)&&(j?(m=p(n_bits=q),j=!1):(++n_bits,n_bits==b?m=1<<b:m=p(n_bits))),a==o){while(e>0)w(g&255,c),g>>=8,e-=8;t(c)}}var s=Math.max(2,B),r=new Uint8Array(256),h=new Int32Array(a),n=new Int32Array(a),g,e=0,f,k=0,m,j=!1,q,i,o;this.encode=z}var c=-1,b=12,a=5003,d=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=f}),a.define('/TypedNeuQuant.js',function(A,F,E,D){function C(A,B){function I(){o=[],q=new Int32Array(256),t=new Int32Array(a),y=new Int32Array(a),z=new Int32Array(a>>3);var c,d;for(c=0;c<a;c++)d=(c<<b+8)/a,o[c]=new Float64Array([d,d,d,0]),y[c]=e/a,t[c]=0}function J(){for(var c=0;c<a;c++)o[c][0]>>=b,o[c][1]>>=b,o[c][2]>>=b,o[c][3]=c}function K(b,a,c,e,f){o[a][0]-=b*(o[a][0]-c)/d,o[a][1]-=b*(o[a][1]-e)/d,o[a][2]-=b*(o[a][2]-f)/d}function L(j,e,n,l,k){var h=Math.abs(e-j),i=Math.min(e+j,a),g=e+1,f=e-1,m=1,b,d;while(g<i||f>h)d=z[m++],g<i&&(b=o[g++],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c),f>h&&(b=o[f--],b[0]-=d*(b[0]-n)/c,b[1]-=d*(b[1]-l)/c,b[2]-=d*(b[2]-k)/c)}function C(p,s,q){var h=2147483647,k=h,d=-1,m=d,c,j,e,n,l;for(c=0;c<a;c++)j=o[c],e=Math.abs(j[0]-p)+Math.abs(j[1]-s)+Math.abs(j[2]-q),e<h&&(h=e,d=c),n=e-(t[c]>>i-b),n<k&&(k=n,m=c),l=y[c]>>g,y[c]-=l,t[c]+=l<<f;return y[d]+=x,t[d]-=r,m}function D(){var d,b,e,c,h,g,f=0,i=0;for(d=0;d<a;d++){for(e=o[d],h=d,g=e[1],b=d+1;b<a;b++)c=o[b],c[1]<g&&(h=b,g=c[1]);if(c=o[h],d!=h&&(b=c[0],c[0]=e[0],e[0]=b,b=c[1],c[1]=e[1],e[1]=b,b=c[2],c[2]=e[2],e[2]=b,b=c[3],c[3]=e[3],e[3]=b),g!=f){for(q[f]=i+d>>1,b=f+1;b<g;b++)q[b]=d;f=g,i=d}}for(q[f]=i+n>>1,b=f+1;b<256;b++)q[b]=n}function E(j,i,k){var b,d,c,e=1e3,h=-1,f=q[i],g=f-1;while(f<a||g>=0)f<a&&(d=o[f],c=d[1]-i,c>=e?f=a:(f++,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3])))),g>=0&&(d=o[g],c=i-d[1],c>=e?g=-1:(g--,c<0&&(c=-c),b=d[0]-j,b<0&&(b=-b),c+=b,c<e&&(b=d[2]-k,b<0&&(b=-b),c+=b,c<e&&(e=c,h=d[3]))));return h}function F(){var c,f=A.length,D=30+(B-1)/3,y=f/(3*B),q=~~(y/w),n=d,o=u,a=o>>h;for(a<=1&&(a=0),c=0;c<a;c++)z[c]=n*((a*a-c*c)*m/(a*a));var i;f<s?(B=1,i=3):f%l!==0?i=3*l:f%k!==0?i=3*k:f%p!==0?i=3*p:i=3*j;var r,t,x,e,g=0;c=0;while(c<y)if(r=(A[g]&255)<<b,t=(A[g+1]&255)<<b,x=(A[g+2]&255)<<b,e=C(r,t,x),K(n,e,r,t,x),a!==0&&L(a,e,r,t,x),g+=i,g>=f&&(g-=f),c++,q===0&&(q=1),c%q===0)for(n-=n/D,o-=o/v,a=o>>h,a<=1&&(a=0),e=0;e<a;e++)z[e]=n*((a*a-e*e)*m/(a*a))}function G(){I(),F(),J(),D()}function H(){var b=[],g=[];for(var c=0;c<a;c++)g[o[c][3]]=c;var d=0;for(var e=0;e<a;e++){var f=g[e];b[d++]=o[f][0],b[d++]=o[f][1],b[d++]=o[f][2]}return b}var o,q,t,y,z;this.buildColormap=G,this.getColormap=H,this.lookupRGB=E}var w=100,a=256,n=a-1,b=4,i=16,e=1<<i,f=10,B=1<<f,g=10,x=e>>g,r=e<<f-g,z=a>>3,h=6,t=1<<h,u=z*t,v=30,o=10,d=1<<o,q=8,m=1<<q,y=o+q,c=1<<y,l=499,k=491,p=487,j=503,s=3*j;A.exports=C}),a('/gif.worker.coffee')}.call(this,this))"],{type:"text/javascript"}));function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Y=function(e){f()(n,e);var t=$(n);function n(e,r,o){var i;return a()(this,n),(i=t.call(this)).status=0,i.mimeType=r,i.frames=o,i.gif,i.zip=e,i.repeat=0,i.currentRepeat=0,i}return i()(n,[{key:"setRepeat",value:function(e){this.repeat=this.currentRepeat=parseInt(e)}},{key:"appendImageToGifFrame",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(n){t<e.frames.length?e.zip.file(e.frames[t].file).async("base64").then((function(r){var a="data:"+e.mimeType+";base64,"+r,o=new Image;o.src=a,e.gif.addFrame(o,{delay:e.frames[t].delay}),e.dispatch("data",[e.frames.length*(e.repeat+1),e.frames.length*(e.repeat-e.currentRepeat)+t+1]),n(e.appendImageToGifFrame(t+1))})):e.currentRepeat>0?(e.currentRepeat--,n(e.appendImageToGifFrame())):n()}))}},{key:"generate",value:function(){var e=this;this.status=1,this.zip.file(e.frames[0].file).async("base64").then((function(t){var n="data:"+e.mimeType+";base64,"+t,r=$extension.browserItems.ugoiraQuanlity||10;F(n).then((function(t){e.gif=new GIF({workers:4,quality:r,width:t.width,height:t.height,workerScript:K}),e.gif.on("progress",(function(t){e.dispatch("progress",[t])})),e.gif.on("finished",(function(t){e.gif.freeWorkers.forEach((function(e){e.terminate()})),e.status=2,e.dispatch("finish",[t])})),e.appendImageToGifFrame().then((function(){setTimeout((function(){e.gif.render()}),120)}))}))}))}}]),n}(w.a);function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var J=function(e){f()(n,e);var t=W(n);function n(e,r,o){var i;return a()(this,n),(i=t.call(this)).status=0,i.mimeType=r,i.frames=o,i.zip=e,i.encoder,i.repeat=0,i.currentRepeat=0,i}return i()(n,[{key:"setRepeat",value:function(e){this.repeat=this.currentRepeat=parseInt(e)}},{key:"appendImagesToWebMFrame",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){n<t.frames.length?t.zip.file(t.frames[n].file).async("base64").then((function(n){return O("data:"+t.mimeType+";base64,"+n,e)})).then((function(a){t.encoder.add(a,t.frames[n].delay),t.dispatch("data",[t.frames.length*(t.repeat+1),t.frames.length*(t.repeat-t.currentRepeat)+n+1]),r(t.appendImagesToWebMFrame(e,n+1))})):t.currentRepeat>0?(t.currentRepeat--,r(t.appendImagesToWebMFrame(e))):r()}))}},{key:"generate",value:function(){var e=this;this.status=1,this.encoder=new Whammy.Video,this.encoder.on("progress",(function(t,n){e.dispatch("progress",[n/t])})),this.zip.file(e.frames[0].file).async("base64").then((function(t){return F("data:"+e.mimeType+";base64,"+t)})).then((function(t){return e.appendImagesToWebMFrame({width:t.width,height:t.height})})).then((function(){try{e.encoder.compile(!1,(function(t){e.status=2,e.dispatch("finish",[t])}))}catch(e){console.error(e)}}))}}]),n}(w.a);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var X=function(e){f()(n,e);var t=V(n);function n(e){var r;return a()(this,n),(r=t.call(this)).context=e,r.download,r.zip,r.zipBlob,r.animationJsonFormat,r}return i()(n,[{key:"init",value:function(){var e=this,t=this;return this.download&&this.download.abort(),this.zip=new JSZip,this.zipBlob=null,this.downloadResource().then((function(n){return e.animationJsonFormat>0&&t.zip.file("animation.json",t.makeAnimationJsonContent()),t.zip.loadAsync(n)})).then((function(){return t.zip.generateAsync({type:"blob"})})).then((function(t){return e.zipBlob=t,t}))}},{key:"isReady",value:function(){return this.zipBlob}},{key:"getUserId",value:function(){return this.context.userId}},{key:"getUserName",value:function(){return this.context.userName}},{key:"getId",value:function(){return this.context.illustId}},{key:"getImages",value:function(){return this.context.urls}},{key:"getThumb",value:function(){return this.getImages().thumb}},{key:"getTitle",value:function(){return this.context.illustTitle}},{key:"isR",value:function(){return!!this.context.r}},{key:"makeAnimationJsonContent",value:function(){return 1===this.animationJsonFormat?JSON.stringify(this.context.illustFrames):2===this.animationJsonFormat?JSON.stringify({ugokuIllustData:{src:this.context.illustSrc,originalSrc:this.context.illustOriginalSrc,mime_type:this.context.illustMimeType,frames:this.context.illustFrames}}):""}},{key:"downloadResource",value:function(){var e=this;return new y.a({maxTime:3}).start((function(){return new Promise((function(t,n){e.download&&e.download.abort(),e.download=new m.a(e.context.illustOriginalSrc,{method:"GET"}),e.download.addListener("onload",(function(e){t(e)})),e.download.addListener("onprogress",(function(t){var n=t.totalLength,r=t.loadedLength;e.dispatch("progress",[r/n])})),e.download.addListener("onerror",(function(e){n(e)})),e.download.download(),e.dispatch("start")}))}))}},{key:"makeGenerator",value:function(e){var t=null;switch(e){case"gif":t=Y;break;case"webm":t=J;break;case"apng":t=G;break;default:throw Error("Invalid generator type")}return new t(this.zip,this.context.illustMimeType,this.context.illustFrames)}}]),n}(w.a),Q=function(){function e(){a()(this,e),this.illustContext,this.ugoiraTool,this.options={}}return i()(e,[{key:"inital",value:function(e){var t=this,n=e.context,r=e.options;return this.options=r,new Promise((function(e,r){t.parseContext(n).then((function(t){e(t)})).catch((function(){r()}))}))}},{key:"parseContext",value:function(e){var t=this,n=this,r=c.a.getDefault(e.createDate);return new Promise((function(a,o){n.illustContext={illustId:e.illustId,illustTitle:e.illustTitle,userName:e.userName,userId:e.userId,userAcount:e.userAccount,urls:e.urls,r:e.xRestrict,id:e.illustId,title:e.illustTitle,comment:e.illustComment,description:e.description,createDate:e.createDate,uploadDate:e.uploadDate,type:"ugoira",bookmarkCount:e.bookmarkCount,likeCount:e.likeCount,responseCount:e.responseCount,viewCount:e.viewCount,year:r.getYear(),month:r.getMonth(),day:r.getDay()};var i=new S.a(t.buildMetaUrl(t.illustContext.illustId),{method:"GET"});i.addListener("onload",(function(e){var t=JSON.parse(String.fromCharCode.apply(null,e));if(t.error)o();else{n.illustContext.illustSrc=t.body.src,n.illustContext.illustOriginalSrc=t.body.originalSrc,n.illustContext.illustFrames=t.body.frames,n.illustContext.illustMimeType=t.body.mime_type;var r=0;n.illustContext.illustFrames.forEach((function(e){r+=e.delay})),n.illustContext.illustDuration=r,a(n.illustContext)}})),i.send()}))}},{key:"buildMetaUrl",value:function(e){return"https://www.pixiv.net/ajax/illust/"+e+"/ugoira_meta"}},{key:"makeTool",value:function(){return this.ugoiraTool||(this.ugoiraTool=new X),this.ugoiraTool.context=this.illustContext,this.ugoiraTool.animationJsonFormat=this.options.animationJsonFormat,this.ugoiraTool}}]),e}(),ee=function(){function e(){a()(this,e),this.request,this.currentUrl,this.currentType,this.currentTool,this.contextData,this.ugoiraAdapter,this.mangaAdapter,this.illustAdapter,this.novelAdapter}return i()(e,[{key:"init",value:function(e){var t=this;return this.currentUrl=e,new Promise((function(n,r){t.checkPageType(e).then((function(e){t.currentType=e,n()})).catch((function(e){r(e)}))}))}},{key:"fetchIllustId",value:function(e){for(var t=[/illust_id=(\d+)/,/artworks\/(\d+)/],n=0,r=t.length;n<r;n++){var a=e.match(t[n]);if(a)return a[1]}}},{key:"checkPageType",value:function(t){var n=this;return new Promise((function(r,a){var o=n.fetchIllustId(t);o?r(n.getIllustType(o)):t.match(/novel\/show\.php\?id=\d+/)?r(e.NOVEL_TYPE):a(new B("invalid_page"))}))}},{key:"getIllustType",value:function(e){var t=this,n=this;return new Promise((function(r,a){t.request&&t.request.abort(),t.request=new S.a(t.getIllustUrl(e),{method:"GET"}),t.request.addExclusiveListener("onload",(function(e){var t=JSON.parse(String.fromCharCode.apply(null,e));t&&t.body?(n.contextData=t.body,browser.runtime.sendMessage({action:"activeIcon"}),r(t.body.illustType)):browser.runtime.sendMessage({action:"deactiveIcon"})})),t.request.addExclusiveListener("onerror",(function(e){a(e)})),t.request.send()}))}},{key:"injectPage",value:function(){var t=this;return new Promise((function(n){switch(t.currentType){case e.UGOIRA_TYPE:case e.MANGA_TYPE:case e.ILLUST_TYPE:n(t.injectIllust());break;case e.NOVEL_TYPE:n(t.injectNovel())}n()}))}},{key:"injectIllust",value:function(){var t=this;return new Promise((function(n){t.currentType===e.UGOIRA_TYPE?n(t.injectUgoiraAdapter()):t.currentType===e.MANGA_TYPE?n(t.injectMangaAdapter()):t.currentType===e.ILLUST_TYPE&&n(t.injectIllustAdapter())}))}},{key:"injectNovel",value:function(){var e=this,t=this;return new Promise((function(n,r){var a,o;e.request&&e.request.abort(),(a=t.currentUrl.match(/novel\/show\.php\?id=(\d+)/))?(o=a[1],e.request=new S.a(t.getNovelUrl(o),{method:"GET"}),e.request.responseType="plain",e.request.addExclusiveListener("onload",(function(e){var r=JSON.parse(e);if(r&&r.body)return t.contextData=r.body,n(t.injectNovelAdapter()),void browser.runtime.sendMessage({action:"activeIcon"});browser.runtime.sendMessage({action:"deactiveIcon"})})),e.request.send()):r(new B("invalid_novel_page"))}))}},{key:"getIllustUrl",value:function(e){return"https://www.pixiv.net/ajax/illust/"+e}},{key:"getNovelUrl",value:function(e){return"https://www.pixiv.net/ajax/novel/"+e}},{key:"injectUgoiraAdapter",value:function(){var e=this;return new Promise((function(t,n){e.ugoiraAdapter||(e.ugoiraAdapter=new Q),e.ugoiraAdapter.inital({context:e.contextData,options:{animationJsonFormat:window.$extension.getItem("animationJsonFormat")}}).then((function(n){var r=e.currentTool=e.ugoiraAdapter.makeTool();t(r)}))}))}},{key:"injectMangaAdapter",value:function(){var e=this;return new Promise((function(t,n){e.mangaAdapter||(e.mangaAdapter=new E),e.mangaAdapter.inital(e.contextData).then((function(n){var r=e.currentTool=e.mangaAdapter.makeTool();t(r)}))}))}},{key:"injectIllustAdapter",value:function(){var e=this;return new Promise((function(t,n){e.illustAdapter||(e.illustAdapter=new T),e.illustAdapter.inital(e.contextData).then((function(n){var r=e.currentTool=e.illustAdapter.makeTool();t(r)}))}))}},{key:"injectNovelAdapter",value:function(){var e=this;return new Promise((function(t){e.novelAdapter||(e.novelAdapter=new L),e.novelAdapter.inital(e.contextData).then((function(n){var r=e.currentTool=e.novelAdapter.makeTool();t(r)}))}))}}]),e}();l()(ee,"UNDETERMINED_TYPE",-99),l()(ee,"ILLUST_TYPE",0),l()(ee,"MANGA_TYPE",1),l()(ee,"UGOIRA_TYPE",2),l()(ee,"NOVEL_TYPE",9);var te=ee,ne=n(11),re=n(15),ae=function(){function e(){a()(this,e),this.browser=u.a.getBrowser(),this.port=null}return i()(e,[{key:"createPort",value:function(e){return this.port="string"==typeof e?this.browser.runtime.connect({name:e}):e,this}},{key:"createListener",value:function(){var e=this;this.port.onMessage.addListener((function(t,n){if(t.action&&"function"==typeof e[t.action+"Action"])e[t.action+"Action"].call(e,t.args,n)})),this.port.onDisconnect.addListener((function(){console.log("Disconnect")}))}},{key:"getRawId",value:function(t,n){if([e.illustType,e.novelType].indexOf(n)<0)throw Error('Invalid download record type "'.concat(n,'"'));return n+t}},{key:"sendMessageThroughPort",value:function(t,n,r){t.postMessage(Object.assign({channel:"".concat(e.portName,":").concat(n)},r))}},{key:"responseSuccess",value:function(e,t,n){this.sendMessageThroughPort(e,t,n?{data:n}:{})}},{key:"responseError",value:function(e,t,n){this.sendMessageThroughPort(e,t,{error:n})}},{key:"isChannel",value:function(t,n){return t==="".concat(e.portName,":").concat(n)}}]),e}();function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}l()(ae,"instance",void 0),l()(ae,"illustType","I"),l()(ae,"novelType","N"),l()(ae,"portName","download-record-port");var ie=function(e){f()(n,e);var t=oe(n);function n(){var e;return a()(this,n),(e=t.call(this)).createPort(ae.portName),e}return i()(n,[{key:"postMessage",value:function(e){try{this.port.postMessage(e)}catch(e){}}},{key:"saveDownloadRecord",value:function(e){var t=e.id,n=e.record,r=e.type;this.postMessage({action:"saveDownloadRecord",args:{id:t,record:n,type:r}})}},{key:"getDownloadRecord",value:function(e){var t=e.id,n=e.type;this.postMessage({action:"getDownloadRecord",args:{id:t,type:n}})}},{key:"getDownloadRecordsFromIds",value:function(e){var t=e.ids,n=e.responseArgs;this.postMessage({action:"getDownloadRecordsFromIds",args:{ids:t,responseArgs:n}})}},{key:"getDownload",value:function(e){var t=e.id,n=e.type;this.postMessage({action:"getDownload",args:{id:t,type:n}})}},{key:"deleteDownload",value:function(e){var t=e.id;this.postMessage({action:"deleteDownload",args:{id:t}})}},{key:"listDownloads",value:function(e){e=Object.assign({selector:{downloaded_at:{$gte:null}},sort:[{downloaded_at:"desc"}],limit:50,skip:0,query:null},e),this.postMessage({action:"listDownloads",args:e})}},{key:"clearDownloads",value:function(){this.postMessage({action:"clearDownloads"})}}],[{key:"getInstance",value:function(){return n.instance?n.instance:n.instance=new n}}]),n}(ae);l()(ie,"instance",void 0);var se={mixins:[re.a],components:{"ptk-button":ne.a},props:{tool:Object},data:function(){var e=this;return{show:!1,downloadNovelType:"",isSaved:!1,forceDownload:!1,buttons:[{type:"epub",text:this.tl("_save")+" Epub",saved:"",download:!1,blob:null,clickHandle:function(t){e.downloadNovel("epub",t)}},{type:"txt",text:this.tl("_save")+" Txt",saved:"",download:!1,blob:null,clickHandle:function(t){e.downloadNovel("txt",t)}}]}},mounted:function(){this.downloadRecordPort=ie.getInstance(),this.downloadRecordPort.port.onMessage.addListener(this.handleDownloadRecord),this.downloadRecordPort.getDownloadRecord({id:this.tool.getId(),type:ie.novelType}),browser.runtime.onConnect.addListener(this.handleConnect),this.show=!0},beforeDestroy:function(){browser.runtime.onConnect.removeListener(this.handleConnect),this.downloadRecordPort.port.onMessage.removeListener(this.handleDownloadRecord)},methods:{saveDownloadRecord:function(e){this.downloadRecordPort.saveDownloadRecord({id:this.tool.getId(),type:ie.novelType,record:Object.assign({title:this.tool.getTitle(),userId:this.tool.getUserId(),userName:this.tool.getUserName(),thumb:this.tool.getCover(),isR:this.tool.isR()},e)})},allowDownload:function(e){if(e&&this.browserItems.askDownloadSavedWork&&!this.forceDownload){if(!window.confirm(this.tl("_this_work_may_has_been_saved")))return!1;this.forceDownload=!0}return!0},updateButton:function(e,t){this.$set(this.buttons,this.buttons.indexOf(e),Object.assign(e,t))},getFilename:function(e){return Object(k.a)(this.browserItems.novelRenameFormat,this.tool.context,this.tool.context.novelId+"_"+this.tool.context.novelTitle)+"."+e},downloadNovel:function(e,t){var n=this;if(this.allowDownload(t.saved)){var r=this.tool.getGenerator(e);r.addMeta("uuid",this.tool.context.novelUrl).addMeta("author",this.tool.context.userName).addMeta("attributionUrl",this.tool.context.novelUrl).addMeta("cover",this.tool.context.novelCover).addMeta("title",this.tool.context.novelTitle),this.browserItems.novelIncludeDescription&&r.appendSection(this.tool.context.novelDescription),this.tool.context.novelSections.forEach((function(e){r.appendSection(e)})),r.makeBook().then((function(r){n.updateButton(t,{blob:r,saved:!0,download:!0}),n.downloadFile(r,n.getFilename(e),{folder:n.getSubfolder(n.browserItems.novelRelativeLocation,n.tool.context),statType:"novel"});var a={};a[e]=1,n.saveDownloadRecord(a)}))}},handleDownloadRecord:function(e,t){var n=this;e.channel===ie.portName+":get-download-record"&&void 0===e.error&&this.buttons.forEach((function(t){e.data&&1===e.data[t.type]&&n.updateButton(t,{saved:!0})}))},handleConnect:function(e){var t=this;"popup"===e.name&&e.onMessage.addListener((function(n,r,a){"fetch-info"===n.type&&e.postMessage({info:t.tool.context})}))}}},le=n(9),ue=Object(le.a)(se,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",e._l(e.buttons,(function(t,r){return n("ptk-button",{key:r,attrs:{type:t.download?"success":""},on:{click:function(e){return t.clickHandle(t)}}},[e._v(e._s(t.text)+" "+e._s(t.saved?" ✔️":""))])})),1):e._e()}),[],!1,null,null,null).exports,ce={mixins:[re.a],components:{"ptk-button":ne.a},props:{tool:C},data:function(){return{mangaTool:null,show:!1,chunks:[],buttonsInfo:{},isSaved:!1,forceDownload:!1}},watch:{isSaved:function(e){var t=this;Object.keys(this.buttonsInfo).forEach((function(n){var r=t.buttonsInfo[n];!0===e&&r.text.indexOf(" ✔️")<0?t.updateButtonInfo(r,{text:r.text+" ✔️"}):!1===e&&r.text.indexOf(" ✔️")>-1&&t.updateButtonInfo(r,{text:r.text.replace(" ✔️","")})}))}},mounted:function(){var e=this,t=this,n={};this.mangaTool=this.tool,this.downloadRecordPort=ie.getInstance(),this.downloadRecordPort.port.onMessage.addListener(this.handleDownloadRecord),this.downloadRecordPort.getDownloadRecord({id:this.mangaTool.getId(),type:ie.illustType}),this.mangaTool.initOptions({splitSize:this.browserItems.mangaPagesInChunk,mangaRenameFormat:this.browserItems.mangaRenameFormat,mangaImageRenameFormat:this.browserItems.mangaImageRenameFormat,pageNumberStartWithOne:this.browserItems.mangaPageNumberStartWithOne,mangaPageNumberLength:this.browserItems.mangaPageNumberLength,processors:parseInt(this.browserItems.downloadTasksWhenDownloadingImages)}).init(),this.chunks=this.mangaTool.chunks,this.chunks.forEach((function(r,a){n[a]={index:a,text:t.getChunkTitle(r,{singular:e.tl("_dl_page"),plural:e.tl("_dl_pages")})+(t.isSaved?" ✔️":""),filename:t.mangaTool.getFilename(r),downloadStatus:0,chunk:r,type:"",blob:null}})),this.buttonsInfo=n,this.tool.addListener("download-progress",this.downloadProgressEventHandle),this.tool.addListener("download-error",this.downloadErrorEventHandle),this.tool.addListener("download-finish",this.downloadFinishEventHandle),browser.runtime.onConnect.addListener(this.handleConnect),this.show=!0},beforeDestroy:function(){browser.runtime.onConnect.removeListener(this.handleConnect),this.downloadRecordPort.port.onMessage.removeListener(this.handleDownloadRecord),this.tool.removeListener("download-progress",this.downloadProgressEventHandle),this.tool.removeListener("download-error",this.downloadErrorEventHandle),this.tool.removeListener("download-finish",this.downloadFinishEventHandle)},methods:{saveDownloadRecord:function(e){this.isSaved=!0,this.downloadRecordPort.saveDownloadRecord({id:this.mangaTool.getId(),type:ie.illustType,record:Object.assign({title:this.tool.getTitle(),userId:this.tool.getUserId(),userName:this.tool.getUserName(),thumb:this.tool.getThumb(),isR:this.tool.isR()},e)})},allowDownload:function(e){if(e&&this.browserItems.askDownloadSavedWork&&!this.forceDownload){if(!window.confirm(this.tl("_this_work_may_has_been_saved")))return!1;this.forceDownload=!0}return!0},getChunkTitle:function(e,t){var n=t.singular,r=t.plural;return e.start===e.end?n+" "+(e.start+1):r+" "+(e.start-0+1)+"-"+(e.end-0+1)},updateButtonInfo:function(e,t){this.$set(this.buttonsInfo,e.index,Object.assign(e,t))},downloadButtonClicked:function(e){this.allowDownload(this.isSaved)&&(0===e.downloadStatus?(e.downloadStatus=1,this.mangaTool.downloadChunk(e.chunk,e)):2===e.downloadStatus&&(this.updateButtonInfo(e,{type:"success"}),this.downloadFile(e.blob,this.getFilename(e.chunk),{folder:this.getSubfolder(this.browserItems.mangaRelativeLocation,this.mangaTool.context),statType:"manga"}),this.saveDownloadRecord({manga:1})))},downloadProgressEventHandle:function(e,t){var n=e.progress,r=e.failCount;this.updateButtonInfo(t,{text:"Downloading ".concat(Math.round(100*n),"%")+(r>0?" (F:".concat(r,")"):"")})},downloadErrorEventHandle:function(){},downloadFinishEventHandle:function(e,t){var n=this.getChunkTitle(t.chunk,{singular:this.tl("_save_page"),plural:this.tl("_save_pages")});this.updateButtonInfo(t,{text:n+" ✔️",blob:e,downloadStatus:2}),this.updateButtonInfo(t,{type:"success"}),this.downloadFile(t.blob,this.getFilename(t.chunk),{folder:this.getSubfolder(this.browserItems.mangaRelativeLocation,this.mangaTool.context),statType:"manga"}),this.saveDownloadRecord({manga:1})},getFilename:function(e){return Object(k.a)(this.browserItems.mangaRenameFormat,this.mangaTool.context,this.mangaTool.context.illustId)+"_"+(e.start-0+1)+"-"+(e.end-0+1)+".zip"},handleDownloadRecord:function(e,t){e.channel===ie.portName+":get-download-record"&&void 0===e.error&&(this.isSaved=!0)},handleConnect:function(e){var t=this;"popup"===e.name&&e.onMessage.addListener((function(n,r,a){"fetch-info"===n.type&&e.postMessage({info:t.mangaTool.context})}))}}},he=Object(le.a)(ce,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",e._l(e.buttonsInfo,(function(t){return n("ptk-button",{key:t.index,attrs:{text:t.text,type:t.type},on:{click:function(n){return e.downloadButtonClicked(t)}}})})),1):e._e()}),[],!1,null,null,null).exports,fe={props:{show:{required:!0,type:Boolean,default:!1},closeOnMaskClick:{type:Boolean,default:!1}},data:function(){return{showDialog:!1}},created:function(){this.showDialog=this.show},computed:{hasHead:function(){return Array.isArray(this.$slots.head)&&this.$slots.head.length>0},hasFoot:function(){return Array.isArray(this.$slots.foot)&&this.$slots.foot.length>0}},methods:{hanldeDialogContainerClick:function(e){e.stopPropagation()},handleDialogMaskClick:function(){this.closeOnMaskClick&&this.$emit("update:show",!1)}}},de=(n(44),Object(le.a)(fe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ptk__dialog",class:{"ptk__dialog--show":e.show},on:{click:e.handleDialogMaskClick}},[n("div",{staticClass:"ptk__dialog-container",on:{click:e.hanldeDialogContainerClick}},[e.hasHead?n("div",{staticClass:"ptk__dialog-head"},[e._t("head")],2):e._e(),e._v(" "),n("div",{staticClass:"ptk__dialog-body"},[e._t("default")],2),e._v(" "),e.hasFoot?n("div",{staticClass:"ptk__dialog-foot"},[e._t("foot")],2):e._e()])])}),[],!1,null,null,null).exports),pe={mixins:[re.a],components:{"ptk-button":ne.a,"ptk-dialog":de},props:{tool:I},data:function(){return{illustTool:null,show:!1,chunks:[],buttonsInfo:{},isSaved:!1,forceDownload:!1,downloadSelectedImagesStatus:0,downloadSelectedImagesNotice:"",showSelectionDialog:!1,downloadSelectedImageButton:{},images:[],selectedImageIndexes:[]}},computed:{alwaysPack:function(){return this.browserItems.alwaysPack}},mounted:function(){this.illustTool=this.tool,this.downloadRecordPort=ie.getInstance(),this.downloadRecordPort.port.onMessage.addListener(this.handleDownloadRecord),this.downloadRecordPort.getDownloadRecord({id:this.illustTool.getId(),type:ie.illustType}),this.illustTool.initOptions({splitSize:999,illustrationRenameFormat:this.browserItems.illustrationRenameFormat,illustrationImageRenameFormat:this.browserItems.illustrationImageRenameFormat,pageNumberStartWithOne:this.browserItems.illustrationPageNumberStartWithOne,illustrationPageNumberLength:this.browserItems.illustrationPageNumberLength,processors:parseInt(this.browserItems.downloadTasksWhenDownloadingImages)}).init(),this.chunks=this.illustTool.chunks,this.images=this.illustTool.context.pages,this.initDownloadButtons(),this.tool.addListener("download-progress",this.downloadProgressEventHandle),this.tool.addListener("download-error",this.downloadErrorEventHandle),this.tool.addListener("download-finish",this.downloadFinishEventHandle),browser.runtime.onConnect.addListener(this.handleConnect),this.show=!0},beforeDestroy:function(){browser.runtime.onConnect.removeListener(this.handleConnect),this.downloadRecordPort.port.onMessage.removeListener(this.handleDownloadRecord),this.tool.removeListener("download-progress",this.downloadProgressEventHandle),this.tool.removeListener("download-finish",this.downloadFinishEventHandle)},watch:{isSaved:function(e){var t=this;Object.keys(this.buttonsInfo).forEach((function(n){var r=t.buttonsInfo[n];!0===e&&r.text.indexOf(" ✔️")<0?t.updateButtonInfo(r,{text:r.text+" ✔️"}):!1===e&&r.text.indexOf(" ✔️")>-1&&t.updateButtonInfo(r,{text:r.text.replace(" ✔️","")})}))}},methods:{initDownloadButtons:function(){var e=this,t=this,n={};t.chunks.forEach((function(r,a){var o=t.illustTool.isSingle();n[a]={index:a,text:(o&&!e.alwaysPack?e.tl("_dl_image"):t.getChunkTitle(r,{singular:e.tl("_dl_page"),plural:e.tl("_dl_pages")}))+(t.isSaved?" ✔️":""),filename:null,downloadStatus:0,chunk:r,isSingle:o,type:"",blob:null}})),t.buttonsInfo=n},saveDownloadRecord:function(e){this.isSaved=!0,this.downloadRecordPort.saveDownloadRecord({id:this.illustTool.getId(),type:ie.illustType,record:Object.assign({title:this.tool.getTitle(),userId:this.tool.getUserId(),userName:this.tool.getUserName(),thumb:this.tool.getThumb(),isR:this.tool.isR()},e)})},allowDownload:function(e){if(e&&this.browserItems.askDownloadSavedWork&&!this.forceDownload){if(!window.confirm(this.tl("_this_work_may_has_been_saved")))return!1;this.forceDownload=!0}return!0},updateButtonInfo:function(e,t){this.$set(this.buttonsInfo,e.index,Object.assign(e,t))},getChunkTitle:function(e,t){var n=t.singular,r=t.plural;return e.start===e.end?n+" "+(e.start+1):r+" "+(e.start-0+1)+"-"+(e.end-0+1)},downloadButtonClicked:function(e){this.allowDownload(this.isSaved)&&(0===e.downloadStatus?(e.downloadStatus=1,e.isSingle&&!this.alwaysPack?this.tool.downloadFile(this.tool.context.pages[0].urls.original,e,this.browserItems.pageNumberStartWithOne?1:0):this.tool.downloadChunk(e.chunk,e)):2===e.downloadStatus&&(this.updateButtonInfo(e,{type:"success"}),this.downloadFile(e.blob,e.filename,{folder:this.getSubfolder(this.browserItems.illustrationRelativeLocation,this.tool.context),statType:"illust"}),this.saveDownloadRecord({illust:1})))},downloadProgressEventHandle:function(e,t,n){var r=e.progress,a=e.failCount,o="".concat(this.tl("_downloading")," ").concat(Math.round(100*r),"%")+(a>0?" (F:".concat(a,")"):"");n&&!0===n.selected?this.downloadSelectedImagesNotice=o:this.updateButtonInfo(t,{text:o})},downloadErrorEventHandle:function(){},downloadFinishEventHandle:function(e,t,n){var r=e.blob,a=e.filename;if(n&&!0===n.selected)this.downloadSelectedImagesStatus=0,this.downloadSelectedImagesNotice="";else{var o=this.getChunkTitle(t.chunk,{singular:this.tl("_save_page"),plural:this.tl("_save_pages")});this.updateButtonInfo(t,{text:(t.isSingle?this.tl("_save_image"):o)+" ✔️",blob:r,filename:a,downloadStatus:2,type:"success"})}this.downloadFile(r,a,{folder:this.getSubfolder(this.browserItems.illustrationRelativeLocation,this.illustTool.context),statType:"illust"}),this.saveDownloadRecord({illust:1})},handleDownloadRecord:function(e,t){e.channel===ie.portName+":get-download-record"&&void 0===e.error&&(this.isSaved=!0)},handleConnect:function(e){var t=this;"popup"===e.name&&e.onMessage.addListener((function(n,r,a){"fetch-info"===n.type&&e.postMessage({info:t.illustTool.context})}))},openSelectionDialog:function(){this.showSelectionDialog=!0,console.log("open selection dialog")},selectImage:function(e){if(1===this.downloadSelectedImagesStatus)alert("Please wait download complete");else{var t=this.images[e];if(t.selected){t.selected=!1;var n=this.selectedImageIndexes.indexOf(e);n>-1&&this.selectedImageIndexes.splice(n,1)}else t.selected=!0,this.selectedImageIndexes.indexOf(e)<0&&this.selectedImageIndexes.push(e);this.$set(this.images,e,t)}},closeSelectionDialog:function(){1===this.downloadSelectedImagesStatus?alert("Please wait download complete"):this.showSelectionDialog=!1},downloadSelectedImages:function(){0===this.downloadSelectedImagesStatus&&(this.downloadSelectedImagesStatus=1,this.downloadSelectedImagesStatus=this.tl("_pending"),this.selectedImageIndexes.sort(),this.tool.downloadSelected(this.selectedImageIndexes))}}},ge=(n(45),Object(le.a)(pe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",[e._l(e.buttonsInfo,(function(t){return n("ptk-button",{key:t.index,attrs:{text:t.text,type:t.type},on:{click:function(n){return e.downloadButtonClicked(t)}}})})),e._v(" "),n("ptk-button",{attrs:{text:e.tl("_select_and_dl")},on:{click:function(t){return e.openSelectionDialog()}}}),e._v(" "),n("ptk-dialog",{attrs:{show:e.showSelectionDialog},on:{"update:show":function(t){e.showSelectionDialog=t}}},[n("template",{slot:"head"},[e._v("\n      "+e._s(e.tl("_select_images_you_want_to_download"))+"\n    ")]),e._v(" "),n("div",{staticClass:"ptk__images-selection"},e._l(e.images,(function(t,r){return n("div",{key:r,staticClass:"ptk__image-preview",class:{"ptk__image-preview--selected":t.selected},style:{background:"url("+t.urls.thumb_mini+") center center no-repeat","background-size":"95% 95%"},on:{click:function(t){return e.selectImage(r)}}},[n("div",{staticClass:"ptk__image-preview--download"},[n("svg",{attrs:{viewBox:"0 0 120 120"}},[n("polyline",{attrs:{points:"60,105 60,8"}}),e._v(" "),n("polyline",{attrs:{points:"10,57 60,8 110,57"}})])])])})),0),e._v(" "),n("template",{slot:"foot"},[e.selectedImageIndexes.length>0?n("ptk-button",{on:{click:e.downloadSelectedImages}},[1===e.downloadSelectedImagesStatus?[e._v("\n          "+e._s(e.downloadSelectedImagesNotice)+"\n        ")]:[e._v("\n          "+e._s(e.tl("_download"))+"\n        ")]],2):e._e(),e._v(" "),n("ptk-button",{on:{click:e.closeSelectionDialog}},[e._v(e._s(e.tl("_close")))])],1)],2)],2):e._e()}),[],!1,null,null,null).exports),ve=(n(21),{mixins:[re.a],components:{"ptk-button":ne.a},props:{tool:Object},data:function(){return{zipButton:{type:"",saved:!1,blob:null,text:this.tl("_preparing")},ready:!1,generatorButtons:{gif:{},apng:{},webm:{}},forceDownload:!1}},beforeMount:function(){var e=this;Object.keys(this.generatorButtons).forEach((function(t){e.$set(e.generatorButtons,t,{type:"",blob:null,status:0,saved:!1,text:"".concat(e.tl("_generate")," ").concat(t.toUpperCase())})})),this.tool.addExclusiveListener("progress",(function(t){e.zipButton.text="".concat(e.tl("_downloading")," ").concat(Math.round(100*t),"%")})),this.downloadRecordPort=ie.getInstance(),this.downloadRecordPort.port.onMessage.addListener(this.handleDownloadRecord),this.downloadRecordPort.getDownloadRecord({id:this.tool.getId(),type:ie.illustType}),this.initTool().then((function(){e.ready=!0,browser.runtime.onConnect.addListener(e.handleConnect)}))},beforeDestroy:function(){browser.runtime.onConnect.removeListener(this.handleConnect),this.downloadRecordPort.port.onMessage.removeListener(this.handleDownloadRecord)},methods:{initTool:function(){var e=this;return this.tool.init().then((function(){e.zipButton.text=e.tl("_save")+" ZIP"})).catch((function(t){console.error(t),e.zipButton.text=e.tl("_interrupted_click_to_retry")}))},saveDownloadRecord:function(e){this.downloadRecordPort.saveDownloadRecord({id:this.tool.getId(),type:ie.illustType,record:Object.assign({title:this.tool.getTitle(),userId:this.tool.getUserId(),userName:this.tool.getUserName(),thumb:this.tool.getThumb(),isR:this.tool.isR()},e)})},allowDownload:function(e){if(e&&this.browserItems.askDownloadSavedWork&&!this.forceDownload){if(!window.confirm(this.tl("_this_item_may_has_been_saved")))return!1;this.forceDownload=!0}return!0},zipButtonClickHandle:function(){this.allowDownload(this.zipButton.saved)&&(-1===this.zipButton.saved?this.initTool():this.tool.isReady()&&(this.zipButton.type="success",this.downloadFile(this.tool.zipBlob,this.getFilename()+".zip",{folder:this.getSubfolder(this.browserItems.ugoiraRelativeLocation,this.tool.context),statType:"ugoira"}),this.saveDownloadRecord({zip:1}),this.zipButton.saved=!0))},saveFile:function(e,t){this.downloadFile(e,this.getFilename()+"."+t,{folder:this.getSubfolder(this.browserItems.ugoiraRelativeLocation,this.tool.context),statType:"ugoira"}),this.generatorButtons[t].saved=1;var n={};n[t]=1,this.saveDownloadRecord(n)},generateButtonClickHandle:function(e){var t=this,n=this.generatorButtons[e];if(0===n.status||4===n.status){var r=this.tool.makeGenerator(e);this.browserItems.enableExtend&&this.tool.context.illustDuration<1e3*this.browserItems.enableWhenUnderSeconds&&r.setRepeat(Math.floor(1e3*this.browserItems.extendDuration/this.tool.context.illustDuration)+1),r.addListener("data",(function(e,r){n.status=2,n.text="".concat(t.tl("_preparing")," ").concat(Math.floor(r/e*100),"%")})),r.addListener("progress",(function(e){n.text="".concat(t.tl("_generating")," ").concat(Math.round(100*e),"%")})),r.addListener("finish",(function(r){n.status=1,n.text=t.tl("_save")+" "+e.toUpperCase(),n.type="success",n.blob=r,t.saveFile(r,e)})),r.generate()}else 1===n.status?this.saveFile(n.blob,e):2===n.status&&alert(this.tl("_generating_please_wait"))},getFilename:function(){return Object(k.a)(this.browserItems.ugoiraRenameFormat,this.tool.context,this.tool.context.illustId)},isBrowser:function(e){return new RegExp(e,"i").test(navigator.userAgent)},handleDownloadRecord:function(e,t){e.channel===ie.portName+":get-download-record"&&void 0===e.error&&(1===e.data.zip&&(this.zipButton.saved=!0),1===e.data.gif&&(this.generatorButtons.gif.saved=!0),1===e.data.apng&&(this.generatorButtons.apng.saved=!0),1===e.data.webm&&(this.generatorButtons.webm.saved=!0))},handleConnect:function(e){var t=this;"popup"===e.name&&e.onMessage.addListener((function(n,r,a){"fetch-info"===n.type&&e.postMessage({info:t.tool.context})}))}}}),me=Object(le.a)(ve,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("ptk-button",{attrs:{type:e.zipButton.type},on:{click:e.zipButtonClickHandle}},[e._v(e._s(e.zipButton.text+(e.zipButton.saved?" ✔️":"")))]),e._v(" "),e.ready?e._l(e.generatorButtons,(function(t,r){return n("ptk-button",{key:r,on:{click:function(t){return e.generateButtonClickHandle(r)}}},[e._v(e._s(t.text+(t.saved?" ✔️":"")))])})):e._e()],2)}),[],!1,null,null,null).exports,_e=function(){function e(){a()(this,e),this.browser=u.a.getBrowser(),this.port=null}return i()(e,[{key:"createPort",value:function(e){return this.port="string"==typeof e?this.browser.runtime.connect({name:e}):e,this}},{key:"createListener",value:function(){var e=this;this.port.onMessage.addListener((function(t,n){if(t.action&&"function"==typeof e[t.action+"Action"])e[t.action+"Action"].call(e,t.args,n)})),this.port.onDisconnect.addListener((function(){console.log("Disconnect")}))}},{key:"sendMessageThroughPort",value:function(t,n,r){t.postMessage({channel:"".concat(e.portName,":").concat(n),data:r})}},{key:"isChannel",value:function(t,n){return t==="".concat(e.portName,":").concat(n)}}]),e}();function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}l()(_e,"portName","illust-history-port");var be=function(e){f()(n,e);var t=we(n);function n(){var e;return a()(this,n),(e=t.call(this)).createPort(_e.portName),e}return i()(n,[{key:"postMessage",value:function(e){try{this.port.postMessage(e)}catch(e){}}},{key:"saveIllustHistory",value:function(e){this.postMessage({action:"saveIllustHistory",args:e})}},{key:"saveBatchHistories",value:function(e){var t=e.items;this.postMessage({action:"saveBatchHistories",args:{items:t}})}},{key:"countItems",value:function(e){this.postMessage({action:"countItems",args:e})}},{key:"listItems",value:function(e){this.postMessage({action:"listItems",args:e})}},{key:"searchItems",value:function(e){this.postMessage({action:"searchItems",args:e})}},{key:"deleteIllustHistory",value:function(e){return this.postMessage({action:"deleteIllustHistory",args:e})}},{key:"clearHistory",value:function(){return this.postMessage({action:"clearHistory"})}}],[{key:"getInstance",value:function(){return n.instance?n.instance:n.instance=new n}}]),n}(_e);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}l()(be,"instance",void 0);var ke=function(e){f()(n,e);var t=ye(n);function n(){var e;return a()(this,n),(e=t.call(this)).localStorage=window.localStorage,e.bindStorageEventListeners(),e}return i()(n,[{key:"bindStorageEventListeners",value:function(){var e=this;window.addEventListener("storage",(function(){e.dispatch("change",[window.localStorage])}))}},{key:"isDark",value:function(){return this.getTheme()===n.DARK_THEME}},{key:"isLight",value:function(){return this.getTheme()===n.LIGHT_THEME}},{key:"getTheme",value:function(){switch(this.localStorage.theme){case n.DARK_THEME:return n.DARK_THEME;default:return n.LIGHT_THEME}}}],[{key:"getDefault",value:function(){return n.default||(n.default=new n),n.default}}]),n}(w.a);l()(ke,"default",void 0),l()(ke,"LIGHT_THEME","light"),l()(ke,"DARK_THEME","dark");var xe={components:{"novel-tool":ue,"manga-tool":he,"illust-tool":ge,"ugoira-tool":me,"ptk-button":ne.a},data:function(){return{pageType:null,currentUrl:null,tool:null,containerShowed:!1,lastError:null,isDark:!1}},computed:{showApp:function(){return null!==this.pageType},hasError:function(){return null!==this.lastError},isUndetermined:function(){return te.UNDETERMINED_TYPE===this.pageType},isUgoira:function(){return te.UGOIRA_TYPE===this.pageType},isManga:function(){return te.MANGA_TYPE===this.pageType},isIllust:function(){return te.ILLUST_TYPE===this.pageType},isNovel:function(){return te.NOVEL_TYPE===this.pageType},iconContent:function(){return this.isUndetermined?"P?":"P*"},showContainer:function(){return this.containerShowed},userId:function(){return this.tool?parseInt(this.tool.getUserId()):0},handlerBackground:function(){return this.isDark?"#666666":"#0096fa"},handlerForeground:function(){return"#ffffff"}},beforeMount:function(){var e=this;this.illustHistoryPort=be.getInstance(),this.detector=new te,this.themeDetector=ke.getDefault(),this.isDark=this.themeDetector.isDark(),this.themeDetector.addListener("change",(function(){e.themeDetector.isDark()?e.isDark=!0:e.isDark=!1}))},mounted:function(){var e=this;new MutationObserver((function(t,n){window.location.href!==e.currentUrl&&(e.currentUrl=window.location.href,e.containerShowed=!1,e.pageType=te.UNDETERMINED_TYPE,e.lastError=null,e.injectPage())})).observe(document.querySelector("body"),{attributes:!0,childList:!0,subtree:!0}),this.currentUrl=window.location.href,this.injectPage()},methods:{injectPage:function(){var e=this,t=this;this.detector.init(this.currentUrl).then((function(){return t.detector.injectPage()})).then((function(e){t.tool=e,t.pageType=t.detector.currentType,t.containerShowed=t.browserItems.autoActivateDownloadPanel,t.browserItems.enableSaveVisitHistory&&(e.isR()&&t.browserItems.notSaveNSFWWorkInHistory||(t.isUgoira||t.isManga||t.isIllust?t.illustHistoryPort.saveIllustHistory({id:t.tool.getId(),title:t.tool.getTitle(),images:t.tool.getImages(),type:t.pageType,userId:t.tool.getUserId(),userName:t.tool.getUserName(),viewed_at:Math.round(Date.now()/1e3),r:t.tool.isR()}):t.isNovel&&t.illustHistoryPort.saveIllustHistory({id:"N"+t.tool.getId(),title:t.tool.getTitle(),image:t.tool.getCover(),isNovel:!0,userId:t.tool.getId(),userName:t.tool.getUserName(),viewed_at:Math.round(Date.now()/1e3),r:t.tool.isR()})))})).catch((function(t){console.log(t),"string"==typeof t?e.lastError=t:t instanceof Error&&("InvalidPageError"===t.name&&(e.pageType=null),e.lastError=t.message)}))},handlerClickHandle:function(){this.hasError?alert("Error: ".concat(this.lastError,", try refresh.")):(this.containerShowed=!this.containerShowed,browser.storage.local.set({guideShowed:!0}))},passToPixivOmina:function(){window.location.assign("pixiv-omina://create-download?url=".concat(encodeURIComponent(window.location.href)))}}},Ie=(n(46),Object(le.a)(xe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{ptk__container:!0},attrs:{id:e.isDark?"ptk-theme__dark":""}},[n("div",{staticClass:"ptk__container__body"},[n("div",{staticClass:"ptk__container__body-container",class:{"ptk__container__body-container--show":e.showContainer,"ptk__container__body-container--hide":!e.showApp}},[!e.showApp||e.isUndetermined||e.browserItems.guideShowed?e._e():n("div",{staticClass:"ptk__guide"},[n("div",{staticClass:"ptk__guide-body"},[n("ptk-button",{staticStyle:{display:"block"}},[e._v("Pixiv Toolkit")]),e._v(" "),n("svg",{staticStyle:{position:"relative",top:"3px"},attrs:{viewBox:"0 0 10 15",id:"ptk__guide-arrow",width:"10",height:"15",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M5 0 L5 15 L10 10 M5 15 L0 10",stroke:e.isDark?"#fff":"#333","stroke-width":"2",fill:"transparent"}})])],1)]),e._v(" "),n("div",{attrs:{id:"ptk__new-handler__wrapper"}},[n("div",{attrs:{id:"ptk__new-handler"},on:{click:e.handlerClickHandle}},[n("svg",{attrs:{viewBox:"0 0 222 40",id:"ptk__new-handler-bg",width:"222",height:"40",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 40 C 25 40, 43 27, 65 15 C 82 4, 93 0, 111 0 C 131 0, 142 4, 161 15 C 180 27, 198 40, 222 40 Z","stroke-width":"0",fill:e.hasError?"#ff3b3b":e.handlerBackground}})]),e._v(" "),e.hasError?e._e():n("svg",{attrs:{viewBox:"0 0 40 15",id:"ptk__new-handler-arrow",width:"40",height:"25",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M 0 15 L 20 0 L 40 15",stroke:e.handlerForeground,"stroke-width":"6",fill:"transparent"}}),e._v(" "),n("circle",{attrs:{cx:"0",cy:"15",r:"3","stroke-width":"0",fill:e.handlerForeground}}),e._v(" "),n("circle",{attrs:{cx:"40",cy:"15",r:"3","stroke-width":"0",fill:e.handlerForeground}})]),e._v(" "),e.hasError?n("svg",{attrs:{viewBox:"0 0 40 40",id:"ptk__new-handler-cross",width:"40",height:"40",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M0 0 L40 40",stroke:e.handlerForeground,"stroke-width":"10",fill:"transparent"}}),e._v(" "),n("path",{attrs:{d:"M0 40 L40 0",stroke:e.handlerForeground,"stroke-width":"10",fill:"transparent"}}),e._v(" "),n("circle",{attrs:{cx:"0",cy:"0",r:"5","stroke-width":"0",fill:e.handlerForeground}}),e._v(" "),n("circle",{attrs:{cx:"40",cy:"40",r:"5","stroke-width":"0",fill:e.handlerForeground}}),e._v(" "),n("circle",{attrs:{cx:"40",cy:"0",r:"5","stroke-width":"0",fill:e.handlerForeground}}),e._v(" "),n("circle",{attrs:{cx:"0",cy:"40",r:"5","stroke-width":"0",fill:e.handlerForeground}})]):e._e()])]),e._v(" "),e.isUgoira?n("ugoira-tool",{staticClass:"ptk-tool__component",attrs:{tool:e.tool}},[e._v("ugoira")]):e.isManga?n("manga-tool",{staticClass:"ptk-tool__component",attrs:{tool:e.tool}},[e._v("manga")]):e.isIllust?n("illust-tool",{staticClass:"ptk-tool__component",attrs:{tool:e.tool}},[e._v("illust")]):e.isNovel?n("novel-tool",{staticClass:"ptk-tool__component",attrs:{tool:e.tool}},[e._v("novel")]):n("div",{staticClass:"ptk-tool__component"},[n("ptk-button",{attrs:{text:"Parsing information"}})],1),e._v(" "),e.isUgoira||e.isManga||e.isIllust?n("div",{staticClass:"ptk-pixiv-omina-content"},[n("ptk-button",{attrs:{title:e.tl("_you_need_to_download_Pixiv_Omina_for_the_button_to_work")},on:{click:e.passToPixivOmina}},[e._v("Pixiv Omina")])],1):e._e()],1)])])}),[],!1,null,null,null).exports),Se=n(28),Te=n(29),Re=n(12),ze=n.n(Re);ze.a.prototype.$browser=window.browser=u.a.getBrowser(),ze.a.mixin(Te.a),browser.storage.local.get(null,(function(e){var t=Se.a.i18n(e.language),n=document.createElement("div");n.id="__ptk-app",n.style.position="fixed",n.style.left="0",n.style.bottom="0",n.style.width="100%",n.style.height="0",n.style.overflow="visible",n.style.display="none",document.body.appendChild(n),window.$extension=new ze.a({el:"#__ptk-app",i18n:t,data:function(){return{globalBrowserItems:e,isFirefox_:navigator.userAgent.toLowerCase().indexOf("firefox")>-1}},beforeMount:function(){var e=this;this.$browser.storage.onChanged.addListener((function(n){for(var r in n)e.globalBrowserItems[r]=n[r].newValue,"language"===r&&("default"===n[r].newValue?t.locale=chrome.i18n.getUILanguage().replace("-","_"):t.locale=n[r].newValue)}))},render:function(e){return e(Ie)},methods:{getItem:function(e){return this.globalBrowserItems[e]}}})}))}]);