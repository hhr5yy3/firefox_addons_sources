!function(){'use strict';const e=()=>{const e=(navigator&&navigator.userAgent||'').toLowerCase(),t=(navigator&&navigator.vendor||'').toLowerCase(),n=null!==e.match(/(?:firefox|fxios)\/(\d+)/),o=null!==e.match(/version\/(\d+).+?safari/),r=null!==e.match(/edge\/(\d+)/)||null!==e.match(/edg\/(\d+)/),i=null!==e.match(/(?:^opera.+?version|opr)\/(\d+)/),s=/google inc/.test(t)?e.match(/(?:chrome|crios)\/(\d+)/):null;return n?'FIREFOX':o?'SAFARI':r?'EDGE':i?'OPERA':null!==s&&!i?'CHROME':void 0};for(var t='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',n='undefined'==typeof Uint8Array?[]:new Uint8Array(256),o=0;o<64;o++)n[t.charCodeAt(o)]=o;let r=null;'SAFARI'!==e()&&(r='undefined'==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype?chrome:browser);const i=(e,t)=>{const n={command:e,payload:t};'object'==typeof safari&&safari.extension?safari.extension.dispatchMessage(e,t):r.runtime.sendMessage(n)},s=(e,t)=>r.i18n.getMessage(e,t),c=()=>r?r.i18n.getUILanguage():'en';var d=null,l=!1;const a='support@enpass.io',m=`<a href='mailto:${a}'>${a}</a>`;var u;function g(e){let t=document.getElementById('main_header');e&&(t.textContent=s(e)),t.style.display='block'}function _(){document.getElementById('error_description').style.display='none'}function y(e){let t=document.getElementById('error_highlight_text');e&&(t.textContent=s(e)),t.style.display='block'}function h(){document.getElementById('loader').style.display='block',document.title='Enpass',d=setTimeout((()=>{p()}),2e4)}function p(){document.title='Error Page';let e=document.getElementById('main_header'),t=document.getElementById('error_highlight_text'),n=document.getElementById('error_description'),o=document.getElementById('loader');!function(){let e=document.querySelector('.error-highlight'),t=document.querySelector('.section-header');e.classList.remove('error-highlight--success'),e.classList.add('error-highlight--error'),t.classList.remove('bg-success-header'),t.classList.add('bg-error-header')}(),e.textContent=s('error_static_main_heading'),o.style.display='none',l?(x(!0),t.textContent=s('cb_error_static_highlight'),n.textContent=s('cb_error_static_description',m),n.style.display='block',E()):(t.textContent=s('error_static_highlight'),n.textContent=s('error_static_app_not_found'),n.style.display='block',document.getElementById('footer').style.display='block',function(){const e=document.querySelector('section.body_content');document.getElementById('info_bg_run').textContent=s('instruction_app_installed'),document.getElementById('info_ext_enabled').textContent=s('instruction_extension_enabled'),document.getElementById('download_instruction').textContent=s('instruction_download_app'),document.getElementById('help_text').textContent=s('string_help'),document.getElementById('ques_desktop_app_required').textContent=s('ques_desktop_app_required'),document.getElementById('contact_support').textContent=s('string_contact','support@enpass.io'),e.style.display='block'}())}function E(){document.getElementById('connector-section').classList.add('show'),document.getElementById('connector-section').classList.remove('hide')}function f(){document.getElementById('connector-section').classList.add('hide'),document.getElementById('connector-section').classList.remove('show')}function I(){let e=document.querySelector('.error-highlight'),t=document.querySelector('.section-header');e.classList.remove('error-highlight--error'),e.classList.add('error-highlight--success'),t.classList.remove('bg-error-header'),t.classList.add('bg-success-header')}function B(){document.getElementById('footer').style.display='none'}function b(){document.querySelector('section.body_content').style.display='none'}function x(e){let t=c();!t||'ar'!==t&&'he'!==t||(e?function(){document.body.style.direction='ltr',document.getElementById('error_description').style.textAlign='left';let e=document.getElementById('retry_link');e.classList.add('retry_link'),e.classList.remove('retry_link_rtl')}():function(){document.body.style.direction='rtl',document.getElementById('error_description').style.textAlign='right';let e=document.getElementById('retry_link');e.classList.remove('retry_link'),e.classList.add('retry_link_rtl')}())}x(),b(),u=function(e){e&&'cros'===e.os?(l=!0,document.getElementById('readmore_link').setAttribute('href','https://link.enpass.io/kb/cb-getting-connection-error/')):l=!1},r.runtime.getPlatformInfo((e=>{u(e)})),document.addEventListener('DOMContentLoaded',(function(e){!function(){let e=document.getElementById('retry_link'),t=s('retry');e&&t&&(e.textContent=t);let n=document.getElementById('readmore_link'),o=s('learn_more');n&&o&&(n.textContent=o)}(),I();let t=document.getElementById('main_header'),n=document.getElementById('error_highlight_text'),o=document.getElementById('error_description');t.textContent=s('heading_app_lookup'),n.textContent=s('error_static_highlight_3'),o.style.display='none',h()})),document.getElementById('retry_link').addEventListener('click',(function(e){I();let t=document.getElementById('main_header'),n=document.getElementById('error_highlight_text'),o=document.getElementById('error_description');t.textContent=s('heading_app_lookup'),n.textContent=s('error_static_highlight_3'),o.style.display='none',h(),B(),b(),i('retry_connection')}),!0),document.getElementById('connect_btn').addEventListener('click',(function(e){let t=document.getElementById('ip_addr').value,n=document.getElementById('port').value;if(t&&n){let e=`ws://${t}:${n}`;h(),I(),B(),b(),g('heading_app_lookup'),_(),y('error_static_highlight_3'),f(),setTimeout((()=>{i('connect_details',{url:e})}),500),document.getElementById('connection_status').classList.add('hide'),document.getElementById('connection_status').classList.remove('show')}else document.getElementById('connection_status').classList.add('show'),document.getElementById('connection_status').classList.remove('hide')})),(e=>{'object'==typeof safari&&safari.self&&safari.self.addEventListener?safari.self.addEventListener('message',(({name:t,message:n})=>{e(t,n)})):r.runtime.onMessage.addListener(((t,n,o)=>{if(!t)return;const{command:r,payload:i}=t;e(r,i,n,o)}))})((function(t,n,o,r){let i=document.getElementById('main_header'),c=document.getElementById('error_highlight_text'),l=document.getElementById('error_description');switch(t){case'start_app':I(),i.textContent=s('heading_app_lookup'),c.textContent=s('error_static_highlight_3'),l.style.display='none';var a=e();if('EDGE'!==a&&'SAFARI'!==a){var m=document.createElement('iframe');m.src='enpassstart://',document.body.appendChild(m),setTimeout((()=>{document.querySelector('iframe').remove()}),1e3)}else window.location.href='enpassstart://';document.title='Enpass';break;case'show_connection_error':clearTimeout(d),p(),n&&n.show_port&&(E(),B(),b());break;case'connected_to_app':break;case'chromeos_connected':document.getElementById('connection_status').textContent='Connected';break;case'connection_details':n.connected?(h(),I(),B(),b(),g('heading_app_lookup'),_(),y('error_static_highlight_3'),f(),setTimeout((()=>{window.close()}),500)):(p(),document.getElementById('ip_addr').value=n.ip,document.getElementById('port').value=n.port,E())}}))}();
