var ver="0.5.6";var browser=browser||chrome;(function(dZ){const dS=ver;const df="com.antdm.antff";const bv="addon_welcome";const bo="addon_outdated";const t="chrome/";const d1="popup/welcomer.html";const ax=0;const bg=1;const b9=2;const ay=0;const by=1;const h=0;const bt=1;const cQ=2;const cD=0;const dP=1;const bq=2;const aj=0;const d0=1;const aI=2;const y=3;const cm=0;const bu=1;const j=2;const bm=3;const cC=4;const m=5;const d7=6;const bL=7;const X=8;const ah=9;const B=10;const dD=11;const d3=13;const bs=14;const n=0;const k=1;const bR=2;const dQ=",FLAC,";const u=31;const bc=32;const aA=33;const dt={http:u,https:u,ftp:bc,ftps:bc,magnet:aA};const dU=190;const bw=2500;const cW=6000;const bW=2500;const bd=25*1024*1024;const cN="|||";const cO="download";const dG="get_extension_state";const b6="vt_button_create";const E="vt_button_show";const aa="vt_button_close";const S="tab_removed";const ar="get_init_data";const bI="get_config";const c5=500;const r=8000;var cx="vbox_rlink";var c3="rlink";var dV="vbox_tab_removed";var bl="tab_removed2";var dv={};var dA={};var a7={};var a4=null;const aG=",MP3,MP2,OGG,AAC,AC3,FLAC,MID,";const aS=",AVI,MPEG,MP4,FLV,IFLV,MPG,QT,MOV,WEBM,MKV,ASF,MPE,ASX,F4V,3GP,3GPP,RMVB,M4V,M2TS,M1V,M2V,HLV,";const cY=",SRT,VTT,";var ea=ay;var bX=false;var Z=true;var O=true;var bF=true;var db={};var dd="";var cc="";var co="";var d6="";var D=dS;var cP="";var dM="";var d9="";var cZ="";var di={};var g={};var cb={};var a0={};var dN={};var b5={};var b7={};var d4=new Array;var al=new Array;var dq=false;var ck=true;var Q=true;var dg=0;var d=0;var b2="";var dF=0;var F={shift:false,ctrl:false,alt:false};var aE="";var aC="";var cs="";var cr="";var cq="";var aw="";var b1="";var a9="";var dR="";const bh=/:\/\/.+\/([^/]+?(?:\.([^./]+?))?)(?=[?#]|$)/;const ab=/\.([^.\\/]*?)(?=(?:\.[0-9]+)*)$/;var ds=/(?:https?:\/\/).*(?:\/|:|%2F)([\.~-\w]+)\.m3u8(?:(?:\?.*)|$)/;var a6=/(?:https?:\/\/).*rutube.ru\/.*\/([~-\w+]+)(?:\.m3u8?).*/i;var at=/(?:https?:\/\/).*video.twimg.com\/.*\/([~-\w+]+)(?:\.m3u8?).*/i;var bH=/(?:https?:\/\/).*youku.com\/playlist\/m3u8\?.*vid=([~-\w%+]+).*/i;var dL=/(?:https?:\/\/).*archive.org\/(?:details)\/([\-\w+]+).*/i;var au=/(?:https?:\/\/).*coub.com\/(?:view|embed)\/([\-\w+]+).*/i;var aB=/(?:https?:\/\/).*ok.ru\/(?:[a-z]+)\/([0-9]+)$/i;var T=/(?:https?:\/\/).*(?:fbcdn\.net\/).*\/([_0-9]+)_n\.mp4.*/i;var bT=/(?:https?:\/\/).*acs.youku.com\/h5\/mtop.youku.play.ups.appinfo.get.*[\?|&]YKPid=([\w+]+).*/i;var aP=/(?:https?:\/\/).*[\/|%]([~-\w\/\.]+)\.mpd.*/;var cl=/(?:https?:\/\/).*\/([~-\w+]+)\.(?:mp3|mp2|ogg|flac)(?:$|\?.*)/i;var aO=/(?:https?:\/\/).*player\.vimeo\.com\/.*\/([0-9]*)(?:(?:[\/|\?].*)|$)/i;var s=/(?:https?:\/\/).*(?:\.akamaized\.net|\.vimeocdn\.com)\/.*\/([a-z0-9-]+)\/sep\/video(?:[\/a-z0-9,]+)master\.json(?:$|\?.*)/i;var c7=/(?:https?:\/\/)video\.twimg\.com\/.*\/(?:([0-9]*))\/.*\.(?:m3u8|mp4)/i;var c6=/(?:https?:\/\/)video\.twimg\.com\/.*\/(?:([0-9]*))\/.*\/(?:[0-9]*x[0-9]*)\/.*(?:\.m3u8)/i;var dz={};var am={};var bx={};var ad={};var de={};var du=0;var b4=Date.now();var ct=0;var p=true;var dK=null;var an=null;var I=null;var c4=null;var dX=cR()||"";var bp=0;var aM=0;var aL=false;var ca=true;var bf=true;var bZ=dZ;function cU(ec){return Object.keys(ec).length===0&&ec.constructor===Object}function w(ec){if(ec.constructor!==Object){return 0}return Object.keys(ec).length}function bj(){if(cc){return cc+t}return""}function cg(ec){return Math.ceil(Math.random()*9763)}function bz(ed,ec){return Math.floor(Math.random()*(ec-ed))+ed}function bK(ec){this.method=ec;this.args={}}function be(){const ed=/.*(?:Firefox\/)([0-9]*).*/i;var ec=ed.exec(navigator.userAgent);if(!ec||ec.length!=2){return 0}return parseInt(ec[1])}if(!String.prototype.parseUrl){String.prototype.parseUrl=function(){let re=/^(?:([a-z]+):(?:([a-z]*):)?\/\/)?(?:([^:@]*)(?::([^:@]*))?@)?((?:[a-z0-9_-]+\.)+[a-z]{2,}|localhost|(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])\.){3}(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])))(?::(\d+))?(?:([^:\?\#]+))?(?:\?([^\#]+))?(?:\#([^\s]+))?$/i;let matches=this.match(re);if(!matches){return null}let result={scheme:matches[1]||"",subscheme:matches[2]||"",user:matches[3]||"",pass:matches[4]||"",host:matches[5],port:matches[6]||"",path:matches[7]||"",query:matches[8]||"",fragment:matches[9]||""};return result}}function aF(ej){this.m_id=this.constructor.prototype.autoincrement++;this.m_useragent=navigator.userAgent;this.m_bypass=0;this.m_isTabDel=false;var ef=dw(ej.responseHeaders,"Content-Disposition");var ec=dw(ej.responseHeaders,"Content-Type");var ed=aN(ec).toUpperCase();var ei=dw(ej.responseHeaders,"Content-Length");var eh=dw(ej.responseHeaders,"Content-Range");var eg=b3(ec,"charset");var ek=new dW(ej.url,ej);this.m_tabId=ej.tabId||0;this.m_url=ek.requestUrl||"";this.m_origurl=ek.origUrl||"";this.m_method=ek.method||"";this.m_cookies=ek.cookies||"";this.m_origin=ek.origin||"";this.m_referer=ek.referer||"";this.m_accLang=ek.accLang||"";this.m_auth=ek.auth||"";this.m_contType=ec||"";this.m_contDisp=ef||"";this.m_contRange=eh||"";this.m_contlen=ei||"";this.m_browser=ek.browser||"";this.m_charset=eg||"";this.m_timestamp=Date.now();this.m_title="";this.m_webpage="";this.m_fileName=b3(ef,"filename")||b3(ec,"name")||"";try{this.m_fileName=decodeURIComponent(escape(this.m_fileName))}catch(ee){}}aF.prototype.autoincrement=1;aF.prototype.GetPostMes=function(){if(!this.m_url||!this.m_method||!this.m_tabId){return null}var ec={cmd:cx,tabid:this.m_tabId,url:this.m_url,method:this.m_method,cookies:this.m_cookies,referer:this.m_referer,useragent:this.m_useragent,browser:this.m_browser};if(this.m_origin){ec.origin=this.m_origin}ec.acclang=this.m_accLang;ec.conttype=this.m_contType;ec.contdisp=this.m_contDisp;ec.contrange=this.m_contRange;ec.origurl=this.m_origurl;ec.contlen=this.m_contlen;ec.title=this.m_title;ec.webpage=this.m_webpage;ec.charset=this.m_charset;ec.auth=this.m_auth;return ec};function a1(eg){for(var ed in a7){var ef=a7[ed];var ee=dA[ef.m_tabId];if(!ee){if(ef.m_isTabDel||++ef.m_bypass>100){var ec=ef.GetPostMes();if(ec){c4.postMessage(ec)}delete a7[ed]}continue}if(ee.status!="complete"&&(Date.now()-ef.m_timestamp)<r){continue}if((!ee.url||ee.url.indexOf("chrome://")==0)&&(Date.now()-ef.m_timestamp)<r){continue}if(ee.title){ef.m_title=ee.title}if(ee.url){ef.m_webpage=ee.url}if(ef.m_fileName){ef.m_title=ef.m_fileName}var ec=ef.GetPostMes();if(ec){c4.postMessage(ec)}delete a7[ed]}if(w(a7)==0){clearTimeout(a4);a4=null}}function dm(ed){var ec=false;for(var ee in dv){var ef=ed.match(dv[ee]);if(ef){ec=true;break}}return ec}function A(ed){var ek=ed.url;var eh=dw(ed.responseHeaders,"Content-Type");var er=dw(ed.responseHeaders,"Content-Length")||0;var ep=dw(ed.responseHeaders,"Content-Disposition");var eo=b3(ep,"filename")||b3(eh,"name");var ef=aN(eh).toUpperCase();var es=eo;var em=false;if(es){em=true}else{es=W(ek)}var en=a5(es).toUpperCase();if(!en){en=da(ef)}var el=(ag(ed.url)==false);var ee=eb(ek,ef);if(ee){el=false}var eg=bG(en);if(bf==false&&(en=="PDF"||ef.indexOf("/PDF")>=0)){return false}if(el==false&&ea==by){if(dm(ek)||bU(ef)||aW(ef)||dH(ef)||ee||bB(en)){if(ap(ek)==true){return false}if(en=="TS"){var ec=dw(ed.responseHeaders,"Content-Range");var ei=ec.indexOf("/");if(ei!=-1){er=ec.substr(ei+1)}if(er==0){return false}}if(O==false||ea==ay){return false}if(a7[ek]||dO(ek,es)==false){return false}var eq=new aF(ed);a7[ek]=eq;if(!a4){a4=setInterval(a1,c5)}return false}}if(em==false&&en==""){return false}var et=el&&(K(en)||z(en));if(et==false&&en!=""&&eg==false){return false}if(dO(ed.url,es)==false){return false}if(dI(en)==true&&cT(ef,en)==bt){return false}if(z(en)&&er<dg){return false}if(K(en)&&er<d){return false}var ej=new dW(ek,ed);ej.dltype=bg;ej.portId=ed.port&&ed.port.id;ej.origUrl=ed.origUrl;ej.filename=es;ej.postData=dk(ed.postData,ej.postType);if(!ej.cookies&&ej.protocolId){chrome.cookies.getAll({url:ej.requestUrl},function(eu){ej.cookies=cy(eu);av(ej,ed)})}else{av(ej,ed)}if(en=="PDF"||ef.indexOf("/PDF")>=0){return false}if(bB(en)||dH(ef)){return false}return true}function c1(ed){if(ed.id){var ec=dA[ed.id];if(!ec){dA[ed.id]=ed}}}function l(ee,ed,ec){dA[ee]=ec}function e(ec){this.m_vid=this.constructor.prototype.autoincrement++;this.m_tabId=0;this.m_portId=0;this.m_nCompl=0;this.m_is_visibled=true;this.m_isMusic=false;this.m_isVSrv=false;this.m_vtype=cm;this.m_state=n;this.m_port=null;this.m_vurl="";this.m_vtag="";this.m_method="GET";this.m_origUrl="";this.m_cookies="";this.m_origin="";this.m_referer="";this.m_accLang="";this.m_contType="";this.m_contDisp="";this.m_contRange="";this.m_useragent=navigator.userAgent;this.m_audio_url="";this.m_video_url="";this.m_title="";this.m_titleParent="";this.m_webpage="";this.m_szfile=0;this.m_gr=0;this.m_eTag="";this.m_screenX=0;this.m_screenY=0;this.m_screenW=0;this.m_screenH=0;this.m_dH=0;this.m_dW=0;this.m_mozInnerScreenX=0;this.m_mozInnerScreenY=0;this.m_timestamp=Date.now();this.m_timeFRequest=0;this.m_timeFResponse=0}e.prototype.autoincrement=1;function aR(ec){return P(ec)!=""}function i(ec){return aJ(ec)!=""}function dy(ec){return aV(ec)!=""}function J(ec){return H(ec)!=""}function dn(ec){return dj(ec)!=""}function bM(ec,ed){return bJ(ec,ed)!=""}function d8(ec){return c8(ec)!=""}function cB(ec){return dY(ec)!=""}function cM(ec){return cK(ec)!=""}function ac(ec){return a(ec)!=""}function cj(ec){return aE?aE.test(ec):false}function bS(ec,ed){if(ed.toUpperCase()!="APPLICATION/DASH+XML"&&ed.toUpperCase()!="APPLICATION/F4M+XML"&&ed.toUpperCase()!="TEXT/XML"&&ed.toUpperCase()!="APPLICATION/OCTET-STREAM"){return false}if(ed.toUpperCase()=="APPLICATION/DASH+XML"){return true}return bP(ec)!=""}function eb(ec,ee){if(!ee){return false}var ed=ee.toUpperCase();if(ed.indexOf("/MP3")!=-1||ed.indexOf("/OGG")!=-1||ed.indexOf("/FLAC")!=-1||ed.indexOf("/X-MP3")!=-1||ed.indexOf("ILM/TM")!=-1||ed.indexOf("/X-OGG")!=-1||ed.indexOf("/X-FLAC")!=-1){return true}if(ec.indexOf("itunes.apple.com")>0&&ed.indexOf("/X-M4A")>0){return true}if(ed.indexOf("AUDIO/")==0&&/.*\.(?:3gp$|3gpp$|m4a$|mp4$|m4s$|mp4a$|weba$|wav$|wma$|mid$|midi$|ac3$|oga$|ogx$|ra$|ram$|aiff$|aif$|aifc$|aac$|m3u$|m3u8$|mpeg$|plj$|rpm$)(?:|\?.*)/.test(ec)==false){return true}return false}function P(ed){var ec;if(cs){ec=cs.exec(ed)}if(ec&&ec.length>=1){return ec[1]}if(cr){ec=cr.exec(ed)}if(ec&&ec.length>=1){return ec[1]}if(cq){ec=cq.exec(ed)}if(ec&&ec.length>=1){return ec[1]}return""}function ci(ec){return(cj(ec)?"VK":"")}function aJ(ed){var ec;if(aO){ec=aO.exec(ed)}if(ec&&ec.length>=1){return ec[1]}return""}function aV(ed){var ec;if(s){ec=s.exec(ed)}if(ec&&ec.length>=1){return ec[1]}return""}function aZ(ee){var ef=W(ee);if(ef==""){return""}var ed=a5(eg);var eg=ef.substr(0,ed.length-1);if(eg.length<12){var ec=ee.split("/");if(ec.length>0){eg=ec[ec.length-1]}}return eg}function H(ed){var ec=dL.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function dj(ed){var ec=au.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function bJ(ed,ef){if(ef&&ef.tabId&&ed.indexOf("expires=")>0&&ed.indexOf("srcAg=")>0&&ed.indexOf("sig=")>0){var ee=dA[ef.tabId];if(ee){ed=ee.url}}var ec=aB.exec(ed);return(ec&&ec.length>=1?ec[1]:"")}function c8(ed){var ec=T.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function dY(ed){var ec=bT.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function bP(ed){var ec=aP.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function ap(ec){var ef=ec.indexOf("?");if(ef>=0){ec=ec.substr(0,ef)}for(var ed in b7){var ee=ec.match(b7[ed]);if(ee){return true}}return false}function a(ed){if(c6.exec(ed)){return""}var ec=c7.exec(ed);if(ec&&ec.length>=1){return ec[1]}return""}function cK(ef){var ed=ef;var ec="";var ee;var eg=ef.indexOf("?");if(eg>0){ef=ef.substr(0,eg)}if(/(?:https?:\/\/).*dailymotion.com.*\.m3u8.*auth=/.test(ed)){return""}if(c6.exec(ef)){return""}if(ef.indexOf("youku.com/")>=0){if(bH){ee=bH.exec(ef)}if(ee&&ee.length>=1){ec=ee[1]}return ec}if(ef.indexOf("rutube.ru/")>=0){if(a6){ee=a6.exec(ef)}if(ee&&ee.length>=1){ec=ee[1]}return ec}if(ef.indexOf(".twimg.com/")>=0){if(at){ee=at.exec(ef)}if(ee&&ee.length>=1){ec=ee[1]}return ec}if(ds){ee=ds.exec(ef)}if(ee&&ee.length>=1){ec=ee[1];return ec}if(ed.indexOf("master.m3u8")>0){ec="master.m3u8"}return ec}function a3(ed){if(!aC){return aj}var eh=b1;var ej=a9;var ee=dR;var eg=aC.exec(ed);if(!eg||eg.length!=2){return aj}var ek=eg[1];if(ek==""){return aj}var ef=eh.split(",");if(ef.indexOf(ek)>=0){return d0}var ec=ee.split(",");if(ec.indexOf(ek)>=0){return y}var ei=ej.split(",");if(ei.indexOf(ek)>=0){return aI}return aj}function K(ec){ec=","+ec+",";return(aS.indexOf(ec)>=0)}function z(ec){ec=","+ec+",";return(aG.indexOf(ec)>=0)}function bB(ec){ec=","+ec+",";return(cY.indexOf(ec)>=0)}function cn(ee,eh,ef,eg){var ec=false;if(eh==""){return{result:false}}var ed="";var ei=b3(ef,"filename");if(!ei){ei=W(ee)}if(!ei&&eh=="VIDEO/MP4"&&eg>bd){ei="noname.mp4"}if(ei){ed=a5(ei).toUpperCase();if(!ed){ed=da(eh);ei=ei+"."+ed}if(ed){ec=K(ed)}if(ec==false&&eh=="VIDEO/MP4"&&eg>bd){ed="MP4";ec=true}}return{result:ec,fname:ei,fext:ed}}function a2(ed,ee){var ec={};ec.type=a3(ee);ec.result=(aR(ed)||ec.type!=aj);return ec}function aX(ec,ed){if(!ec){return false}if(ed.m_vtype==dZ){ed.m_vtype=cm}var ee=false;ee=aR(ec);if(ee){ed.m_vtype=m;return true}ee=J(ec);if(ee){ed.m_vtype=j;return true}ee=dn(ec);if(ee){ed.m_vtype=bm;return true}ee=bM(ec,ed);if(ee){ed.m_vtype=bs;return true}ee=d8(ec);if(ee){ed.m_vtype=cC;return true}ee=cB(ec);if(ee){ed.m_vtype=d3;return true}ee=cj(ec);if(ee){ed.m_vtype=d7;return true}ee=i(ec);if(ee){ed.m_vtype=bL;return true}ee=dy(ec);if(ee){ed.m_vtype=X;return true}ee=cM(ec);if(ee){ed.m_vtype=B;return true}ee=ac(ec);if(ee){ed.m_vtype=dD;return true}return ee}function b8(ec,ee){if(!ec){return""}if(ee.m_vtype==dZ){ee.m_vtype=cm}var ed="";ed=P(ec);if(ed){ee.m_vtype=m;return ed}ed=H(ec);if(ed){ee.m_vtype=j;return ed}ed=dj(ec);if(ed){ee.m_vtype=bm;return ed}ed=bJ(ec,ee);if(ed){ee.m_vtype=bs;return ed}ed=c8(ec);if(ed){ee.m_vtype=cC;return ed}ed=dY(ec);if(ed){ee.m_vtype=d3;return ed}ed=ci(ec);if(ed){ee.m_vtype=d7;return ed}ed=aJ(ec);if(ed){ee.m_vtype=bL;return ed}ed=aV(ec);if(ed){ee.m_vtype=X;return ed}ed=cK(ec);if(ed){ee.m_vtype=B;return ed}ed=a(ec);if(ed){ee.m_vtype=dD;return ed}ed=bP(ec);if(ed){ee.m_vtype=ah;return ed}ed=aZ(ec);if(ed){ee.m_vtype=bu;return ed}return""}function dx(ed,ee){var ec=b8(ed,ee);return ec}function bY(ed,ee,ef){var ec=a2(ed,ee);if(ec.result==true&&typeof ec.type!="undefined"){ef.m_vtype=d7}return ec}function aq(ed){var ec=aX(ed.url,ed)||aX(ed.origUrl,ed);return ec}function c(ed,eg,ee,ef){var ec=cn(ed,eg,ee,ef);return ec}function dO(ee,ed){var ec=true;var ei=ee.indexOf("?");if(ei>=0){ee=ee.substr(0,ei)}var eh="";if(ed){eh=ee;var ei=ee.lastIndexOf("/");if(ei>=0){eh=eh.substr(0,ei+1)+ed}else{eh="/"+ed}}for(var ef in b5){var eg=ee.match(b5[ef]);if(eg){ec=false;break}if(eh!=""){if(eh.match(b5[ef])){ec=false;break}}}return ec}function bU(ec){var ed=d4[ec];return(ed&&ed.type=="AUDIO")}function aW(ec){var ed=d4[ec];return(ed&&ed.type=="VIDEO")}function dH(ec){return(ec.indexOf("/X-SUBRIP")>=0||ec=="text/SRT"||ec=="text/VTT")}function cT(ef,ec,ee){if(!ef){return h}if(!ec){return bt}var eg=d4[ef];if(!eg){return h}if(ee&&eg.type.indexOf(ee.toUpperCase())<0){return bt}if(eg.ext=="*"){return cQ}else{var ed=eg.ext.split(",");if(ed.indexOf(ec)>=0){return cQ}if(dQ.indexOf(","+ec+",")>=0){return cQ}}return bt}function R(ec,ee){if(/.mpd$/i.test(ec)){return false}ee=ee.toUpperCase();for(var ed in al){if(al[ed]==ee){return true}}return false}function cR(ee){var ed;var ec=navigator.userAgent.lastIndexOf(" ");if(ec>=0){ed=navigator.userAgent.substr(ec+1)}return ed}function da(ed){var ee=d4[ed];if(!ee){return""}if(ee.ext==""||ee.ext=="*"){return""}var ec=ee.ext.split(",");if(ec.length>0){return ec[0]}return""}function G(ec){var ed=0;if(typeof ec=="string"){let protocol=ec.split("://",1).shift().toLowerCase();ed=dt[protocol]||0;if(ed==0){protocol=ec.split(":?",1).shift().toLowerCase();ed=dt[protocol]||0}}return ed}function dW(ed,ee){if(typeof ed=="string"){var ec=ed.lastIndexOf("#");if(ec>=0){ed=ed.substr(0,ec)}this.requestUrl=ed;this.protocolId=G(ed)}if(this.protocolId!=u){return}if(ee){if(ee.origUrl){var ec=ee.origUrl.lastIndexOf("#");if(ec>=0){ee.origUrl=ee.origUrl.substr(0,ec)}this.origUrl=ed}this.method=ee.method||"";this.reqHeaders=ee.requestHeaders;this.resHeaders=ee.responseHeaders;this.mimeType=aN(dw(ee.responseHeaders,"Content-Type"));this.httpHeaderProcessing()}}dW.prototype.requestUrl="";dW.prototype.urltext="";dW.prototype.urlwebpage="";dW.prototype.method="";dW.prototype.filename="";dW.prototype.referer="";dW.prototype.cookies="";dW.prototype.mimeType="";dW.prototype.userAgent=navigator.userAgent;dW.prototype.browser=cR();dW.prototype.protocolId=0;dW.prototype.portId=null;dW.prototype.dltype=ax;dW.prototype.httpHeaderProcessing=function(){var ec,ed;if(this.reqHeaders){ec=this.reqHeaders}if(ec){this.cookies||(this.cookies=dw(ec,"Cookie"));this.origin||(this.origin=dw(ec,"Origin"));this.referer||(this.referer=dw(ec,"Referer"));this.accLang||(this.accLang=dw(ec,"Accept-Language"));this.userAgent||(this.userAgent=dw(ec,"User-Agent"));this.postType||(this.postType=dw(ec,"Content-Type"));this.auth||(this.auth=dw(ec,"Authorization"));var ee=cF(ec);if(ee){this.authUser=ee[0],this.authPass=ee[1]}}};function cF(eg){var ee=dw(eg,"Authorization");if(!ee){return}var ef=ee.split(" ");if(ef.length!=2||ef[0]!="Basic"){return}try{ee=atob(ef[1])}catch(ed){return}var ec=ee.indexOf(":");if(ec<1){return}return[ee.substr(0,ec),ee.substr(ec+1)]}function W(ee){var eh=ee;var eg=eh.indexOf("?");if(eg>0){eh=eh.substr(0,eg)}if(eh.length){var ef=eh.slice(eh.length-1);if(ef=="/"){eh=eh.substr(0,eh.length-1)}}var ed=bh.exec(eh);var ei=(ed?ed[1]:"");if(eg&&(!ei||!a5(ei))){eh=ee.substr(eg+1);ed=bh.exec(eh);var ec=(ed?ed[1]:"");if(ec){ei=ec}}return(ei?ei:"")}function ce(ed){var ec=ed.lastIndexOf(".");return(ec>0?ed.substr(0,ec):ed)}function a5(ee){var ed=ab.exec(ee);var ec=(ed?ed[1]:"");return(ec?ec:"")}function b3(el,ec){if(el==null){return null}ec=ec.toLowerCase();var ee=el.split(";");for(var ef in ee){var ed=ee[ef];var ei=ed.indexOf("=");if(ei>0){var eg=ed.substr(0,ei).trim().toLowerCase();var ek=(eg[eg.length-1]=="*");if(ek){eg=eg.substr(0,eg.length-1).trim()}if(eg==ec){var eh=ed.substr(ei+1).trim();if(ek){var ej=eh.indexOf("'");if(ej>=0){eh=eh.substr(ej+1).trim()}}while(eh!=""&&(eh[0]=='"'||eh[0]=="'")){eh=eh.substr(1).trim()}if(eh[eh.length-1]=='"'||eh[eh.length-1]=="'"){eh=eh.substr(0,eh.length-1).trim()}eh=unescape(decodeURIComponent(eh));if(eh.indexOf(" ")==-1){eh=eh.replace(/\+/g," ")}return eh}}else{if(ei<0&&ed.trim().toLowerCase()==ec){return""}}}return null}function dw(ee,ec){if(ee){ec=ec.toLowerCase();for(var ed in ee){if(ee[ed].name.toLowerCase()==ec){return ee[ed].value}}}return""}function aN(ec){return(ec&&unescape(ec.split(";",1).shift().trim())||"")}function dC(ec){delete ad[ec]}function U(ef){if(dF>0&&(Date.now()-dF)>5*1000){for(var ed in F){F[ed]=false}dF=0;return false}var ee=0;for(var ec=0;ec<db.length;ec++){if(F[db[ec]]){ee++}}return(ee>0&&ee==db.length)}function bk(eg){var ed=new Array;if(eg){eg=eg.trim();var eh=eg.split(cN);for(var ec=0;ec<eh.length;ec++){var ef=eh[ec].trim();if(ef==""){continue}ef=ef.replace(/\//gi,"\\/");ef=ef.replace(/\./gi,"\\.");ef=ef.replace(/\*/gi,".*");ef=ef.replace(/\#/gi,"*");var ee=new RegExp(ef,"i");if(ee){ed.push(ee)}}}return ed}function aD(eg){var ec=eg.split("|");for(var ee in ec){var ed=ec[ee].toUpperCase().split(":");if(ed.length==3){var ef=ed[0].trim();d4[ef]={ext:ed[1].trim(),type:ed[2].trim()}}}}function b(){var ef=new Date();var eg=ef.getFullYear();var eh=ef.getMonth()+1;var ed=ef.getDate();var ec=ef.getHours();var ei=ef.getMinutes();var ee=ef.getSeconds();if(eh.toString().length==1){eh="0"+eh}if(ed.toString().length==1){ed="0"+ed}if(ec.toString().length==1){ec="0"+ec}if(ei.toString().length==1){ei="0"+ei}if(ee.toString().length==1){ee="0"+ee}return eg+"/"+eh+"/"+ed+" "+ec+":"+ei+":"+ee}function az(ei){if(!ei){return}ei=ei.replace(/\s/g,"");if(!(/^[a-z0-9\+\/\s]+\={0,2}$/i.test(ei))||ei.length%4>0){return ei}var ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var eh,ee,eg;var ed=0;var ec=[];ei=ei.replace(/=/g,"");while(ed<ei.length){eh=ef.indexOf(ei.charAt(ed));eg=ed%4;switch(eg){case 1:ec.push(String.fromCharCode(ee<<2|eh>>4));break;case 2:ec.push(String.fromCharCode((ee&15)<<4|eh>>2));break;case 3:ec.push(String.fromCharCode((ee&3)<<6|eh));break}ee=eh;ed++}return ec.join("")}function dl(ed){if(browser.runtime.lastError){console.error(browser.runtime.lastError.message);return}bX=true;switch(ed.cmd){case dG:if(ed.is_config_updated==true){x()}bF=ed.integration;ck=ed.icon_animation;if(ed.is_close_empty_tabs!=dZ){Q=ed.is_close_empty_tabs}if(ed.is_free!=dZ){dq=ed.is_free}break;case ar:cc=ed.home_url;if(cc[cc.length-1]!="/"){cc+="/"}d6=ed.copyright;dM=ed.support_email;if(ed.browser){co=ed.browser}if(ed.rs){cfg_RS=ed.rs}if(ed.rs_str){cfg_RS_str=ed.rs_str}if(ed.version){D=dS+" ["+ed.version+"]"}if(ed.default_title){browser.browserAction.setTitle({title:ed.default_title})}if(ed.vk){b2=ed.vk}if(ed.mime){aD(ed.mime)}if(ed.req_paterns){dv=bk(ed.req_paterns)}if(ed.req_pat_decl){b7=bk(ed.req_pat_decl)}if(ed.dlmime){var ec=ed.dlmime.split("|");for(var ee in ec){al.push(ec[ee].toUpperCase())}}if(ed.nver){if(/antff/i.test(ed.nver)){cP=ed.nver.replace(/antff\./gi,"");var ee=cP.lastIndexOf(".");if(ee>0){cP=cP.substr(0,ee)}}if(!cP||cA(cP,"0.3.0")<0){browser.tabs.create({url:cc+(cc[cc.length-1]!="/"?"/":"")+bo});o();return}}browser.management.get(browser.runtime.id,function(eg){g_antdm_full_ver=(eg.shortName?eg.shortName:eg.name)+"."+eg.version+" "+ed.version_ex;console.log(g_antdm_full_ver)});break;case bI:if(ed.skeys){db=ed.skeys.split(",")}d9="";di={};if(ed.ftypes){d9=","+ed.ftypes.trim()+",";if(ed.ftypes.indexOf("*")!=-1){di=br(ed.ftypes)}}if(ed.ftypes_def){cZ=","+ed.ftypes_def.trim()+","}if(ed.ftypes_exsites){cb=bk(ed.ftypes_exsites.replace(/\,/gi,cN))}if(ed.ftypes_mexsitesdef){dN=bk(ed.ftypes_mexsitesdef.replace(/\,/gi,cN))}if(ed.con1_sites){g=bk(ed.con1_sites.replace(/\,/gi,cN))}if(ed.exaddrs){b5=bk(ed.exaddrs)}if(ed.asize_min){dg=ed.asize_min}if(ed.vsize_min){d=ed.vsize_min}if(ed.vcap_exsites){a0=bk(ed.vcap_exsites.replace(/\,/gi,cN));C()}break}if(ed.id){var ef=bx[ed.id];if(ef){delete bx[parseInt(ed.id)];this[ef.method].apply(null,ef.args)}}}function br(eg){eg=eg.trim();var ed=new Array;if(eg!=""){var eh=eg.split(",");for(var ec=0;ec<eh.length;ec++){var ef=eh[ec];ef=ef.replace(/\*/gi,".*");ef="^"+ef+"$";var ee=new RegExp(ef,"i");if(ee){ed.push(ee)}}}return ed}function bG(ed){var ec=false;if(ed){if(di.length==dZ||di.length==0){ed=","+ed.toUpperCase()+",";ec=(d9.indexOf(ed)>=0)}else{for(var ee in di){var ef=ed.match(di[ee]);if(ef){ec=true;break}}}}return ec}function dI(ed){var ec=false;if(ed){ed=","+ed.toUpperCase()+",";ec=(cZ.indexOf(ed)>=0)}return ec}function Y(ed){var eg=ed.indexOf("?");if(eg>=0){ed=ed.substr(0,eg)}var ec=true;for(var ee in cb){var ef=ed.match(cb[ee]);if(ef){ec=false;break}}return ec}function dc(ed){var eg=ed.indexOf("?");if(eg>=0){ed=ed.substr(0,eg)}var ec=false;for(var ee in a0){var ef=ed.match(a0[ee]);if(ef){ec=true;break}}return ec}function ag(ed){var eg=ed.parseUrl();if(eg&&eg.host){var ec=true;for(var ee in dN){var ef=eg.host.match(dN[ee]);if(ef){ec=false;break}}}return ec}function dT(ed){var ef=ed.indexOf("#");if(ef>=0){ed=ed.substr(0,ef)}var ec=false;for(var ee in g){if(g[ee].test(ed)){ec=true;break}}return ec}function bV(ei){for(var ef in dz){var eh=dz[ef];if(eh.m_tabId==-1&&!eh.m_port&&(Date.now()-eh.m_timestamp)>bw&&aM>0){for(var ec in am){var ed=parseInt(ec.split(".")[0]);if(ed!=aM){continue}var eg=ed+".0";var ec=am[eg];if(ec){var ee=dz[eg];if(ee){c4.postMessage({cmd:aa,vid:ee.m_vid})}eh.m_tabId=ed;eh.m_port=ec;dz[eg]=eh;delete dz[ef]}break}}if(eh.m_is_visibled==true){if(!eh.m_rect&&++eh.m_gr%2){continue}if(!eh.m_port&&(Date.now()-eh.m_timestamp)>2*bw){var eg=eh.m_tabId+".0";var ec=am[eg];if(ec&&!dz[eg]){eh.m_port=ec;dz[eg]=eh;delete dz[ef]}}bQ(eh.m_port)}}if(b2&&!aw){if(b2.gvr1){aE=new RegExp(az(b2.gvr1),"i")}if(b2.gvr2){aC=new RegExp(az(b2.gvr2),"i")}if(b2.gap1){cs=new RegExp(az(b2.gap1),"i")}if(b2.gap2){cr=new RegExp(az(b2.gap2),"i")}if(b2.gap3){cq=new RegExp(az(b2.gap3),"i")}aw=b2.dstr1;b1=b2.mtype;a9=b2.atype;dR=b2.vtype;b2=""}}function bQ(ec){if(ec==null||ec.m_id==null){return}var ed=dz[ec.m_id];if(ed==null||!ed.m_tabId){return}chrome.tabs.get(ed.m_tabId,function(ef){if(ef==dZ){return}if(ed.m_nCompl++<10&&ef.status!="complete"){setTimeout(bV,1000)}else{ed.m_state=k;ed.m_timeFRequest=Date.now();ed.m_timeFResponse=0;ed.m_webpage=ef.url;var eg={cmd:"get_video_rect",id:ec.m_id,requestUrl:ed.m_vurl,referer:ed.m_referer,origUrl:ed.m_origUrl};try{ec.postMessage(eg)}catch(ee){b0(ed,false)}}})}function dk(ed,ej){if(ed==null||ed.formData==null){return null}var ei=aN(ej).toLowerCase();var ec="";if(ei=="application/x-www-form-urlencoded"){for(var ef in ed.formData){var ee=ed.formData[ef];ec=ec+(ec?"&":"")+ef+"="+encodeURIComponent(ee)}}else{if(ei=="multipart/form-data"){var eh=b3(ej,"boundary");if(!eh){eh="----WebKitFormBoundary"+Math.random().toString(36).substr(2)}for(var ef in ed.formData){var ee=ed.formData[ef];for(var eg=0;eg<ee.length;eg++){ec+="--"+eh+'\r\nContent-Disposition: form-data; name="'+ef+'"\r\n\r\n'+ee[eg]+"\r\n"}}ec+="--"+eh+"--\r\n"}else{return null}}return ec}function eb(ec,ee){if(!ee){return false}var ed=ee.toUpperCase();if(ed.indexOf("/MP3")!=-1||ed.indexOf("/OGG")!=-1||ed.indexOf("/FLAC")!=-1||ed.indexOf("/X-MP3")!=-1||ed.indexOf("ILM/TM")!=-1||ed.indexOf("/X-OGG")!=-1||ed.indexOf("/X-FLAC")!=-1){return true}if(ec.indexOf("itunes.apple.com")>0&&ed.indexOf("/X-M4A")>0){return true}if(ed.indexOf("AUDIO/")==0&&/.*\.(?:3gp$|3gpp$|m4a$|mp4$|m4s$|mp4a$|weba$|wav$|wma$|mid$|midi$|ac3$|oga$|ogx$|ra$|ram$|aiff$|aif$|aifc$|aac$|m3u$|m3u8$|plj$|rpm$)(?:|\?.*)/.test(ec)==false){return true}return false}function cf(ed){var eo=ed.url;if(Z==false){return false}if(bF==false){return false}if(ap(eo)==true){return false}if(ed.statusCode<200||300<=ed.statusCode){return false}if(eo=="about:blank"){return false}if(eo=="about:newtab"){return false}if(ea==by){return A(ed)}if(eo.indexOf("chrome-extension://")>=0){return false}var ec=dw(ed.responseHeaders,"Content-Range");var ek=dw(ed.responseHeaders,"Content-Type");var eD=dw(ed.responseHeaders,"Content-Length")||0;var ey=dw(ed.responseHeaders,"Content-Disposition");var ew=dw(ed.responseHeaders,"Server");var ej=aN(ek).toUpperCase();var eu=b3(ey,"filename")||b3(ek,"name");var eh=eu?eu:W(eo);var ex=a5(eh).toUpperCase();if(eo.indexOf("zee5")>=0&&eo.indexOf("stream.m3u8")>=0){return false}if(/.*(?:\/search\/audio\/)*(?:\.mp3$)/.test(eo)){return false}if(ed.isVSrv==false&&K(ex)==false&&ej!="VIDEO/MP4"&&z(ex)==false&&ex!="MPD"&&ej!="APPLICATION/DASH+XML"&&(!eu||eu&&/.*\.(?:m3u8$|m3u$)/.test(eu)==false)){ed.m_timestamp=Date.now();return A(ed)}var eA=ed.isVSrv;if(eA&&bM(eo,ed)){var eg=dA[ed.tabId];if(eg){eo=eg.url}}if(eA==false&&eo.indexOf(".ts")>=0){var eE=W(eo);var er=a5(eE).toUpperCase();if(er=="TS"){var ec=dw(ed.responseHeaders,"Content-Range");var em=ec.indexOf("/");if(em!=-1){eD=ec.substr(em+1)}eA=eD>0}}if(eA==false){eA=ed.isVSrv=bS(eo,ej);if(eA){ed.m_vtype=ah}}if(eA==false){var es=c(eo,ej,ey,eD);if(es.result==true){if(dO(eo,es.fname)&&es.fext){eA=(cT(ej,es.fext,"video")==cQ);if(eA==false){eA=(cT("VIDEO/MP4",es.fext,"video")==cQ)}if(eA){ed.m_vtype=bu;if(eD>=bd){ed.isVSrv=true}}}}}if(eA==false&&(ej=="APPLICATION/OCTET-STREAM-M3U8"||ej=="APPLICATION/X-MPEGURL"||ej=="APPLICATION/VND.APPLE.MPEGURL")){var ef=ed.tabId+"."+ed.frameId;var ei=dz[ef];if(ei&&ei.m_vurl!=eo&&(Date.now()-ei.m_timestamp)<bw){return false}ed.m_vtype=B;eA=ed.isVSrv=true}var ee=false;if(eA==false){ee=eb(eo,ej)}var ep=false;if(eA){ep=(ag(eo)==false&&eo.indexOf("videoplayback")==-1);if(ep){eA=false}}if(eA==true||ee==true){if(O==false){return false}if(ee==true&&eD&&eD<dg){return false}if(eA==true&&eD&&eD<d&&ed.isVSrv==false){return false}var en=new dW(eo,ed);var ef=ed.tabId+"."+ed.frameId;if(eo.indexOf("/watch?")>=0){er=er}var ei=dz[ef];if(ei){if(ei.m_vurl==eo){ei.m_timestamp=Date.now()}if(ei.m_vurl.indexOf("youku.com/playlist/m3u8")>=0&&ed.isVSrv==false){return false}if(ei.m_vtype==B&&ed.m_vtype==B&&(ei.m_portId==0||ei.m_portId!=0&&ei.m_portId!=ef)&&/.*\/(index[-\w+]+)\.m3u8(?:$|\?.*)/.test(ei.m_vurl)==false&&eo.indexOf("rutube.ru")<0&&eo.indexOf("/yahoomovies/")<0&&eo.indexOf("master.m3u8")<0&&eo.indexOf("manufest.m3u8")<0&&eo.indexOf("playlist.m3u8")<0){return false}}var eB=false;var el=bY((ei?ei.m_vurl:en.requestUrl),en.requestUrl,ed);if(el.result==true&&typeof el.type!="undefined"){if(ei==null){ei=new e}var eC=el.type;if(eC==d0){ei.m_vurl=en.requestUrl;ei.m_audio_url=en.requestUrl;ei.m_video_url=en.requestUrl;eB=true}else{if(eC==aI){if(ei.m_vurl.indexOf(aw)>=0){ei.m_vtype=m}ei.m_audio_url=en.requestUrl;eB=true}else{if(eC==y){if(ei.m_vurl.indexOf(aw)>=0){ei.m_vtype=m}ei.m_video_url=en.requestUrl;eB=true}else{if(ei.m_vtag!=""&&ei.m_vtag!=dx(en.requestUrl,ed)){c4.postMessage({cmd:aa,vid:ei.m_vid});delete dz[ef];ei=dZ}else{if(ej.indexOf("AUDIO")>=0){ei.m_audio_url=en.requestUrl}if(ej.indexOf("VIDEO")>=0){ei.m_video_url=en.requestUrl}eB=true}}}}}if(ei){if(ei.m_isVSrv&&ei.m_vtype==d3&&ed.m_vtype==B){return false}if(ei.m_vtype==ah&&ed.m_vtype!=ah){return false}if(ei.m_vtype==B&&ed.m_vtype==cC&&/(?:https?:\/\/).*dailymotion.com.*/.test(ed.initiator)){return false}if(ei.m_vtype==B&&ed.m_vtype==d7){return false}if(ei.m_vtype==B&&ed.m_vtype==B){var eE=W(eo);eE=ce(eE);if(eE.length<=2){return false}var ez=dx(en.requestUrl,ed);if(!(/[0-7]+[pP]?$/i.test(ei.m_vtag))&&/[0-7]+[pP]?$/i.test(ez)){return false}}if(ei.m_vtype==B&&ed.m_vtype==B){var eE=W(eo);const ev=/.*([0-9]+)x([0-9]+).*\.m3u8$/i;if(eE&&ev.test(eE)){return false}}if(ei.m_vtype==B&&ed.m_vtype==B&&(Date.now()-ei.m_timestamp)<2*bw){return false}if(ei.m_referer.indexOf("solarmoviez.ru")>=0){return false}if((Date.now()-ei.m_timestamp)<bw&&aw&&ei.m_vurl.indexOf(aw)>=0){var et=dx(en.requestUrl,ed);if(ei.m_vtag!=et&&et!="VK"){return false}}if(ei.m_isVSrv&&ed.isVSrv==false){return false}if(ei.m_isVSrv&&ei.m_vurl==en.referer&&ed.m_vtype!=X){return false}}if(ei==null){ei=new e}ei.m_isMusic=ee;ei.m_isVSrv=ed.isVSrv;if(ei.m_vurl!=en.requestUrl&&eB==false){ei.m_audio_url="";ei.m_video_url=""}if(eB==false||ei.m_vurl==""){ei.m_vurl=en.requestUrl}ei.m_method=en.method;ei.m_origUrl=en.origUrl;if(eB==false||ei.m_vtag==""){ei.m_vtag=dx(en.requestUrl,ed)}ei.m_cookies=en.cookies;ei.m_origin=en.origin;ei.m_referer=en.referer;ei.m_accLang=en.accLang;ei.m_contType=ek;ei.m_contDisp=ey;ei.m_contRange=ec;ei.m_szfile=eD;ei.m_state=n;ei.m_vtype=ed.m_vtype;ei.m_tabId=ed.tabId;ei.m_portId=ef;ei.m_auth=en.auth;ei.m_timestamp=Date.now();ei.m_isVDL=ed.isVDL;dz[ef]=ei;var eq=am[ef];if(!ei.m_cookies){chrome.cookies.getAll({url:en.requestUrl},function(eF){ei.m_cookies=cy(eF)})}if(eq){ei.m_port=eq;bQ(eq)}return false}return false}function av(ed,ec){if(ed.urlwebpage||ec.tabId<=0){bD(ed)}else{chrome.tabs.get(ec.tabId,function(ee){if(ee&&ee.url&&ee.url!="about:blank"&&ee.url!="about:newtab"){ed.urlwebpage=ee.url}bD(ed)})}}function q(ee,ec){if(ee){ec=ec.toLowerCase();for(var ed=0;ed<ee.requestHeaders.length;ed++){if(ee.requestHeaders[ed].name.toLowerCase()==ec){return ee.requestHeaders[ed].value}}}return""}function bn(ed){if(ed.tabId<0){return}if(bX==false){return}if(Z==false){return}if(bF==false){return}if(U()==true){return}if(ed.method=="POST"&&ed.requestBody&&ed.requestBody.formData){var ec=ad[ed.requestId];if(ec){ec.requestbody=ed.requestBody}else{ad[ed.requestId]=ed}}}function V(eg){if(eg.method=="POST"&&eg.url.indexOf("antdownloadmanager.com/cgi/contact")!=-1&&g_antdm_full_ver){var ef=g_antdm_full_ver+(cfg_RS_str?cfg_RS_str:"")+" "+dX;eg.requestHeaders.push({name:"AntDM-Ver",value:ef});return{requestHeaders:eg.requestHeaders}}if(eg.tabId==0){return dC(eg.requestId)}if(bX==false){return dC(eg.requestId)}if(Z==false){return dC(eg.requestId)}if(bF==false){return dC(eg.requestId)}if(U()==true){return dC(eg.requestId)}if(eg.method!="GET"&&eg.method!="POST"){return dC(eg.requestId)}var ec=ad[eg.requestId];if(ec){eg.port=ec.port;eg.postData=ec.requestBody;eg.origUrl=ec.origUrl||ec.url}else{if(Y(eg.url)==false){return dC(eg.requestId)}}eg.isVSrv=aq(eg);if(eg.isVSrv){if(O==false){return dC(eg.requestId)}}if(dT(eg.url)){var ed=eg.tabId+"."+eg.frameId+"."+eg.url;if(!de[ed]){de[ed]=eg.url;var ee=new dW(eg.url,eg);ee.dltype=bg;ee.portId=eg.port&&eg.port.id;ee.postData=dk(eg.postData,ee.postType);browser.tabs.get(eg.tabId,function(ej){if(ej&&ej.url&&ej.url!="about:blank"&&ej.url!="about:newtab"){ee.urlwebpage=ej.url}bD(ee)})}dC(eg.requestId);return{cancel:true}}if(w(ad)>dU){for(var ei in ad){var eh=ad[ei].m_timestamp;if(eh&&(Date.now()-eh)>bw*4){dC(ei)}}}eg.m_timestamp=Date.now();ad[eg.requestId]=eg}function af(ec){if(bX==false){return dC(ec.requestId)}if(Z==false){return dC(ec.requestId)}if(bF==false){return dC(ec.requestId)}if(U()==true){return dC(ec.requestId)}var ee=ad[ec.requestId];if(!ee){return}if(ee.type=="image"){return dC(ec.requestId)}if(ea==ay){var ef=dw(ec.responseHeaders,"Content-Type");if(ef){if(ef.indexOf("image/")==0){return dC(ec.requestId)}}}var ed=parseInt(ec.statusLine.split(" ",2).pop());ee.statusCode=ed;ee.statusLine=ec.statusLine;ee.responseHeaders=ec.responseHeaders;if(cf(ee)==true){if(Q){dp(ee)}return{cancel:true}}}function dp(ec){if(ec.frameId||ec.tabId<=0){return}browser.tabs.get(ec.tabId,function(eh){if(!ec.dl_cnt_waiting){ec.dl_cnt_waiting=0}if(eh.status=="loading"&&(eh.url==""||eh.url=="about:blank"||ec.url==eh.url||ec.origUrl==eh.url)){browser.tabs.remove(eh.id,function(){});var ee=ec.url.parseUrl();if(ee&&ee.host){var ed=ee.host}if(ec.origUrl){ee=ec.origUrl.parseUrl();if(ee&&ee.host){var eg=ee.host}}var ei=q(ec,"Referer");if(ei){ee=ei.parseUrl();if(ee&&ee.host){var ef=ee.host}}browser.tabs.query({},function(en){for(var em=en.length-1;em>=0;em--){var ek=en[em].url;var eo=ek.indexOf("#");if(eo>0){ek=ek.substr(0,eo)}if(ek){var ej=ek.parseUrl();if(ej&&ej.host){if(ej.host==ed||ej.host==eg||ej.host==ef){try{browser.tabs.update(en[em].id,{selected:true})}catch(el){}return}}}}});return}if(ec.dl_cnt_waiting>20||eh.status=="complete"){if(eh.status=="complete"){browser.tabs.executeScript(ec.tabId,{code:"if(history.length<2)close();"})}setTimeout(function(){browser.tabs.executeScript(ec.tabId,{code:"var id=setTimeout(function(){},0);while(id--)clearTimeout(id);window.stop();"})},3000);return}if(ec.dl_cnt_waiting++<30){setTimeout(dp,1000,ec)}})}function cS(ec){dC(ec.requestId)}function ae(ed){try{browser.webRequest.onBeforeRequest.addListener(bn,{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame","object","xmlhttprequest","media"]},["requestBody"]);browser.webRequest.onBeforeSendHeaders.addListener(V,{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame","stylesheet","script","image","font","object","xmlhttprequest","ping","csp_report","media","websocket","other"]},["blocking","requestHeaders"]);browser.webRequest.onHeadersReceived.addListener(af,{urls:["http://*/*","https://*/*","ftp://*/*"],types:["main_frame","sub_frame","stylesheet","script","image","font","object","xmlhttprequest","ping","csp_report","media","websocket","other"]},["blocking","responseHeaders"]);browser.webRequest.onErrorOccurred.addListener(cS,{urls:["<all_urls>"],types:["main_frame","sub_frame","object","xmlhttprequest","media"]});try{browser.downloads.onDeterminingFilename.addListener(cG)}catch(ec){console.error("onDeterminingFilename::"+ec)}}catch(ec){}}function dr(ee,ef){var ec={cmd:dG};ec[ee]=ef;try{c4.postMessage(ec)}catch(ed){c4.onMessage.removeListener(dl);c4.disconnect();c4=browser.runtime.connectNative(df);c4.onMessage.addListener(dl);c4.postMessage(ec)}}function bO(ec){var ee=cg();delete bx[ee];var ed=new bK("DLHCH_menu_downloadLink");ed.args=arguments;bx[ee]=ed;dr("id",ee)}function cX(ee,ed){var eg=cg();var ec=ee.linkUrl;delete bx[eg];var ef=new bK("DLHCH_menu_downloadLinks");arguments[0]=ed.id;arguments[1]=true;arguments[2]=ec;arguments.length=3;ef.args=arguments;bx[eg]=ef;dr("id",eg)}function bb(ee,ed){var eg=cg();var ec=ee.linkUrl;delete bx[eg];var ef=new bK("DLHCH_menu_downloadLinks");arguments[0]=ed.id;arguments[1]=false;arguments[2]=ec;arguments.length=3;ef.args=arguments;bx[eg]=ef;dr("id",eg)}function L(){function ec(ey,em){var ep=[];var es={};var eq="";var en="";var ev="";var el=!em;var eg;var et=0;if(em){eg=ey.getSelection();if(!eg||eg.isCollapsed){return ep}}else{eq=ey.documentElement.innerText,eq+="\n";en=ey.documentElement.innerHTML}var eh=ey.getElementsByTagName("a");if(eh){for(var ew=0;ew<eh.length;ew++){var eu=eh[ew];if(eu&&(el||eg.containsNode(eu,true))){var ej=eu.href;if(ej&&!es[ej]){es[ej]=ep.push([ej,eu.innerText||eu.title])}if(em&&es[ej]){eq+=eu.innerText,eq+="\n"}}}}var ek=ey.getElementsByTagName("area");if(ek){for(var ew=0;ew<ek.length;ew++){var eu=ek[ew];if(eu&&(el||eg.containsNode(eu,true))){var ej=eu.href;if(ej&&!es[ej]){es[ej]=ep.push([ej,eu.alt])}}}}var er=el&&ey.getElementsByTagName("iframe");if(er){for(var ew=0;ew<er.length;ew++){var eu=er[ew];if(eu){var ej=eu.src;if(ej&&!es[ej]){es[ej]=ep.push([ej])}eq+=eu.innerText,eq+="\n";if(eu.documentElement){en+=eu.documentElement.innerHTML}}}}var ex=em&&eg.toString();if(ex){eq+=ex,eq+="\n"}var eo=ey.getElementsByTagName("img");if(eo){for(var ew=0;ew<eo.length;ew++){var eu=eo[ew];if(eu&&(el||eg.containsNode(eu,true))){var ej=eu.src;if(ej&&!es[ej]){es[ej]=ep.push([ej,eu.alt])}if(el&&eu.onclick){ev+=eu.onclick,ev+="\n"}}}}var ei=el&&ey.getElementsByTagName("script");if(ei){for(var ew=0;ew<ei.length;ew++){ev+=ei[ew].innerText,ev+="\n"}}eh=ee(ev);for(var ew=0;eh&&ew<eh.length;ew++){var ej=eh[ew];if(ej&&!es[ej]){es[ej]=ep.push([ej])}}eh=ee(eq);for(var ew=0;eh&&ew<eh.length;ew++){var ej=eh[ew];if(ej&&!es[ej]){es[ej]=ep.push([ej])}}eh=ee(en);for(var ew=0;eh&&ew<eh.length;ew++){var ej=eh[ew];if(ej&&!es[ej]){es[ej]=ep.push([ej])}}return ep}function ee(ej){var ek=/((?:https?|ftps?):\/\/[-A-Za-z0-9+&amp;@#/%?=~_()|!:,.]*).*/;var ei,eg=[];while((ei=ek.exec(ej))&&ei.length==2){var eh=ei[1];ej=ej.substr(ei.index+eh.length);if(eg.indexOf(eh)==-1){eg.push(eh)}}return eg}function ed(ei){var eg=ec(document,ei);var en=document.getElementsByTagName("iframe");var eh=Array.prototype.push;for(var ek=0;ek<en.length;ek++){try{var em=en[ek];var el=em.contentDocument;if(el&&!em.src){eh.apply(eg,ec(el,ei))}}catch(ej){}}return eg}function ef(eg){browser.runtime.onMessage.addListener(function(ej,ei,eh){if(ej.message=="get_selected_links"){eh({urls:ed(true),page_url:window.location.href,page_title:document.title})}else{if(ej.message=="get_all_links"){eh({urls:ed(false),page_url:window.location.href,page_title:document.title})}}})}ef()}function ak(ee,ed,ec){var eg=L.toString();try{var eh=eg.match(/(?:function\x20*)([^\(]+).*/)[1]}catch(ef){console.error(" menu_CS "+ef);return}eg=eg+";"+eh+"();";browser.tabs.executeScript(ee,{code:eg},function(){browser.tabs.sendMessage(ee,{message:ed?"get_selected_links":"get_all_links"},function(ei){if(browser.runtime.lastError){console.error(browser.runtime.lastError.message);return}var em=new dW();em.dltype=b9;em.urlwebpage=ei.page_url;if(ec){em.ctx_linkUrl=ec}em.requestUrl=[];em.referer=[];em.urltext=[];em.cookies=[];var el=[];for(var ek=0,eo=0;ek<ei.urls.length;ek++){var ej=ei.urls[ek][cD];if(ej.parseUrl()==null){continue}em.requestUrl.push(ej);em.referer.push(ei.urls[ek][bq]||"");em.urltext.push(ei.urls[ek][dP]||"");if(G(ej)==u){var en=new Promise(function(er,eq){var ep=eo;browser.cookies.getAll({url:ej},function(es){em.cookies[ep]=cy(es);er()})});el.push(en)}eo++}if(em.requestUrl.length==0){window.alert(browser.i18n.getMessage("no_links_for_downloading"))}else{Promise.all(el).then(function(ep){bD(em)})}})})}function aK(ed){var ec=new dW(ed.linkUrl);ec.dltype=b9;if(ec.protocolId){if(ec.protocolId!=u){bD(ec);return}ec.urlwebpage=ed.pageUrl;browser.cookies.getAll({url:ec.requestUrl},function(ee){ec.cookies=cy(ee);bD(ec)})}}function cy(ed){var ee="";for(var ec in ed){ee&&(ee+=";");ee+=ed[ec].name;ee+="=";ee+=ed[ec].value}return ee}function aT(ed){browser.contextMenus.removeAll();var ec=browser.contextMenus.create({title:browser.i18n.getMessage("menu_parent_download"),contexts:["all"]});browser.contextMenus.create({parentId:ec,title:browser.i18n.getMessage("menu_child_download_link"),contexts:["link"],onclick:bO});browser.contextMenus.create({parentId:ec,title:browser.i18n.getMessage("menu_child_download_selected_links"),contexts:["selection"],onclick:cX});browser.contextMenus.create({parentId:ec,title:browser.i18n.getMessage("menu_child_download_all_links"),contexts:["all"],onclick:bb})}function bD(ed,ec){if(ed.requestUrl==null){return}var ee={cmd:cO,url:ed.requestUrl,urltext:ed.urltext,urlpage:ed.urlwebpage,method:ed.method,cookies:ed.cookies,referer:ed.referer,useragent:ed.userAgent,browser:ed.browser,id:cg()};if(ed.accLang){ee.acclang=ed.accLang}if(ed.auth){ee.auth=ed.auth}if(ed.authUser){ee.username=ed.authUser}if(ed.authPass){ee.password=ed.authPass}if(ed.postData){ee.postparam=ed.postData}if(ed.filename){ee.filename=ed.filename}if(ed.mimeType){ee.mime=ed.mimeType}if(ed.dltype){ee.dltype=ed.dltype}if(ed.ctx_linkUrl){ee.ctx_linkUrl=ed.ctx_linkUrl}browser.runtime.sendNativeMessage(df,ee,function(ef){if(ef.is_antdm_launched===false){window.alert(browser.i18n.getMessage("cannot_launch_app"));return}})}function N(ec){if(bX==false){return}if(Z==false){return}if(bF==false){return}if(O==false){return}am[ec.m_id]=ec;var ed=dz[ec.m_id];if(ed){ed.m_port=ec;bQ(ec)}}function cI(ec){if(bX==false){return}if(Z==false){return}if(bF==false){return}if(O==false){return}if(ec.sender.tab==null||ec.sender.tab.id==null){return}ec.onMessage.addListener(v.bind(this,ec));ec.onDisconnect.addListener(dh);if(ec.sender.frameId!=null){ec.m_id=ec.sender.tab.id+"."+ec.sender.frameId;N(ec);return}browser.webNavigation.getAllFrames({tabId:ec.sender.tab.id},function(ef){for(var ed=0;ed<ef.length;ed++){var ee=ef[ed];if(!ee.errorOccurred&&ee.url==ec.sender.url){ec.m_id=ec.sender.tab.id+"."+ee.frameId;N(ec);break}}})}function bE(ec,ed){for(var ee in ad){if(ad[ee].port===ec){dC(ee)}}if(am[ec.m_id]===ec){delete am[ec.m_id]}cw(ec)}function ao(ec){if(am[ec.m_port.m_id]){if(!ec.m_title||ec.m_title==ec.m_title_dis){delete ec.m_title_dis;return}}if(++ec.m_cnt_dis<=6){setTimeout(ao,1000,ec);return}delete ec.m_cnt_dis;c4.postMessage({cmd:aa,vid:ec.m_vid});if(ec.m_state!=n){delete dz[ec.m_port.m_id]}}function cw(ec,ed){var ee=dz[ec.m_id];if(ee&&ee.m_port===ec){if(ee.m_state==n&&(ee.m_vtype==bL||ee.m_vtype==X||ee.m_vurl.indexOf("youku.com")>=0)&&(Date.now()-ee.m_timestamp)<bw*2){return}if(ed||ee.m_vtype==d7){c4.postMessage({cmd:aa,vid:ee.m_vid});delete dz[ee.m_port.m_id]}else{ee.m_cnt_dis=0;ee.m_title_dis=ee.m_title;b0(ee,false);setTimeout(ao,1000,ee)}}}function dh(ec){if(ec.sender.tab==null||ec.sender.tab.id==null){return}if(ec.sender.frameId!=null){ec.m_id=ec.sender.tab.id+"."+ec.sender.frameId;bE(ec);return}chrome.webNavigation.getAllFrames({tabId:ec.sender.tab.id},function(ef){for(var ed=0;ed<ef.length;ed++){var ee=ef[ed];if(!ee.errorOccurred&&ee.url==ec.sender.url){ec.m_id=ec.sender.tab.id+"."+ee.frameId;bE(ec,ee.frameId);break}}})}function cv(ed,ec){if(!ed||!ec){return true}if(ed.indexOf(ec)>=0||ec.indexOf(ed)>=0){return true}if(ed.length>=10&&ec.length>=10){let tag11=ed.substr(0,ed.length/2);let tag12=ed.substr(ed.length/2);let tag21=ed.substr(0,ec.length/2);let tag22=ed.substr(ec.length/2);if(ed.indexOf(tag21)>=0||ed.indexOf(tag22)>=0){return true}if(ec.indexOf(tag11)>=0||ec.indexOf(tag12)>=0){return true}}return false}function cp(ed,ec){if(Z==false){return}if(bF==false){return}if(O==false){return}if(ed.m_id==null){return}var ee;if(ec.cmd=="get_parent__rect"){ee=dz[ec.id];if(!ee){return}if(ec.title){ee.m_titleParent=ec.title}if(ec.screenW&&ec.screenH){ee.m_screenX=ec.screenX;ee.m_screenY=ec.screenY;ee.m_screenW=ec.screenW;ee.m_screenH=ec.screenH}ee.m_dH=ec.dH;ee.m_dW=ec.dW;ee.m_mozInnerScreenX=ec.mozInnerScreenX;ee.m_mozInnerScreenY=ec.mozInnerScreenY;if(ec.rect){ee.m_rect=ec.rect;if(ee.m_rectVideo){var em=ee.m_rectVideo.right-ee.m_rectVideo.left;var eg=ee.m_rectVideo.bottom-ee.m_rectVideo.top;var ef=ec.rect.right-ec.rect.left;var el=ec.rect.bottom-ec.rect.top;if((em/eg*0.9>ef/el||ef/el>em/eg*1.1)&&(aw==""||ee.m_vurl.indexOf(aw)==-1)){delete ee.m_rect}}}else{delete ee.m_rect}}else{ee=dz[ed.m_id];if(!ee){return}if(cv(ee.m_eTag,ec.etag)==false){ba(ed.m_id);return}ee.m_timeFResponse=Date.now();ee.m_state=bR;ee.m_eTag=ec.etag;if(ec.screenW&&ec.screenH){ee.m_screenX=ec.screenX;ee.m_screenY=ec.screenY;ee.m_screenW=ec.screenW;ee.m_screenH=ec.screenH}ee.m_dH=ec.dH;ee.m_dW=ec.dW;ee.m_mozInnerScreenX=ec.mozInnerScreenX;ee.m_mozInnerScreenY=ec.mozInnerScreenY;if(ec.title&&ec.title!=""){ee.m_title=ec.title}if(!ee.m_webpage&&ec.parent_baseURI&&ec.parent_baseURI!=""){ee.m_webpage=ec.parent_baseURI}if(ec.rect){ee.m_rect=ec.rect;ee.m_rectVideo=ec.rect;var ej=ed.m_id.split(".");if(ej[1]!="0"){var ei=ej[0]+".0";var ek=am[ei];if(ek){var eh={cmd:"get_parent_rect",id:ed.m_id,yttag:ee.m_vtag};if(ec.parent_id){eh.element_id=ec.parent_id}if(ec.parent_name){eh.element_name=ec.parent_name}if(ec.parent_class){eh.element_class=ec.parent_class}if(ec.parent_baseURI){eh.element_baseURI=ec.parent_baseURI}ek.postMessage(eh)}return}}}if(!ee.m_title&&!ee.m_titleParent){return}var eh={cmd:b6,vid:ee.m_vid,tabid:ee.m_tabId,url:ee.m_vurl,method:ee.m_method,useragent:ee.m_useragent,browser:dX,title:ee.m_titleParent||"",title2:ee.m_title||"",webpage:ee.m_webpage,screenX:ee.m_screenX,screenY:ee.m_screenY,screenW:ee.m_screenW,screenH:ee.m_screenH,dH:ee.m_dH,dW:ee.m_dW,mozInnerScreenX:ee.m_mozInnerScreenX,mozInnerScreenY:ee.m_mozInnerScreenY,visible:ee.m_is_visibled};if(eh.title==""){eh.title=eh.title2}ee.m_state=bR;if(ee.m_audio_url!=""){eh.audiourl=ee.m_audio_url}if(ee.m_video_url!=""){eh.videourl=ee.m_video_url}if(ee.m_contType!=""){eh.conttype=ee.m_contType}if(ee.m_contDisp!=""){eh.contdisp=ee.m_contDisp}if(ee.m_contRange!=""){eh.contrange=ee.m_contRange}if(ee.m_origin!=""){eh.origin=ee.m_origin}if(ee.m_cookies!=""){eh.cookies=ee.m_cookies}if(ee.m_referer!=""){eh.referer=ee.m_referer}if(ee.m_accLang!=""){eh.acclang=ee.m_accLang}if(ee.m_szfile>0){eh.szfile=ee.m_szfile}if(ee.m_auth){eh.auth=ee.m_auth}if(ee.m_rect){eh.top=parseInt(ee.m_rect.top).toString();eh.left=parseInt(ee.m_rect.left).toString();eh.right=parseInt(ee.m_rect.right).toString();eh.bottom=parseInt(ee.m_rect.bottom).toString()}if(!ee.m_rect&&ee.m_isVDL){delete dz[ee.m_portId];return}c4.postMessage(eh)}function bC(ec){dF=Date.now();if(F[ec.key]!=null){F[ec.key]=(ec.state=="keydown")}}function v(ec,ed){switch(ed.cmd){case"get_video__rect":cp(ec,ed);break;case"get_parent__rect":cp(ec,ed);break;case"tab_was__scrolled":bV();break;case"on_key__press":bC(ed);break}}function aQ(ec){dr("id",0)}function x(ec){if(!cc){c4.postMessage({cmd:ar})}c4.postMessage({cmd:bI})}function dE(ef,ec){if(bX==false){return}if(bF==false){return}if(Z==false){return}if(O==false){return}var ee=ef.tabId+"."+ef.frameId;var ed=am[ee];if(ed){var eg=dz[ee];if(ec&&eg&&ef.url==eg.m_vurl){return}if(eg&&eg.m_vurl.indexOf(aw)>=0&&(Date.now()-eg.m_timestamp)<bw){return}cw(ed,true)}cV(ef.tabId)}function cV(ec){try{if(typeof ContentScript=="function"){var ee=ContentScript.toString();var ef=ee.match(/(?:function\x20*)([^\(]+).*/)[1]}else{if(dd){ee=dd;var ef=ee.match(/(?:function\x20*)([^\(]+).*/)[1]}}if(ef){ee=ee+";"+ef+"();";chrome.tabs.executeScript(ec,{code:ee.toString(),runAt:"document_start",allFrames:true},function(eg){chrome.runtime.lastError})}}catch(ed){}}function f(ec){if(ec.length==0){return}for(var ef in dz){var eg=dz[ef];eg.m_is_visibled=false;for(var ee=0;ec&&ee<ec.length;ee++){try{if(ec[ee].active==true&&eg.m_port.sender&&eg.m_port.sender.tab&&eg.m_port.sender.tab.id==ec[ee].id&&eg.m_port.sender.tab.windowId==ec[ee].windowId){eg.m_is_visibled=true;break}}catch(ed){}}b0(eg)}}function cu(ec){if(bX==false){return}if(Z==false){return}if(bF==false){return}if(O==false){return}try{chrome.tabs.query({windowId:ec,active:true},f)}catch(ed){}}function C(){if(aM>0){chrome.tabs.get(aM,function(ec){var ed=aL;aL=(ec&&ec.url?dc(ec.url):false);if(ed!=aL){dK=setInterval(aH,0)}})}}function cE(ec){aM=ec.tabId;if(bX==false){return}if(Z==false){return}if(bF==false){return}if(O==false){return}C();setTimeout(function(){C()},bw);for(var ed in dz){var ee=dz[ed];ee.m_is_visibled=(ee.m_tabId==ec.tabId);b0(ee)}}function b0(ee,ec){if(ec==dZ){ec=ee.m_is_visibled}if(ee.m_last_visibled&&ee.m_last_visibled==ec){return}ee.m_last_visibled=ec;var ed={cmd:E,vid:ee.m_vid,tabid:ee.m_tabId,visibled:ec};c4.postMessage(ed)}function ba(ec){var ed=dz[ec];if(ed){c4.postMessage({cmd:aa,vid:ed.m_vid,tabid:ed.m_tabId});delete dz[ec]}}function cJ(ef,ed){if(bp==ef){bp=0}if(bX==false){return}for(var eg in am){if(am[eg].m_id){var ec=am[eg].m_id.split(".")[0];if(ec==ef){delete am[eg]}}}for(var ee in a7){var eh=a7[ee];if(eh.m_tabId==ef){if((Date.now()-eh.m_timestamp)<bw){eh.m_isTabDel=true;continue}delete a7[ee]}}c4.postMessage({cmd:dV,tabid:ef});delete dA[ef]}function cG(ec,eh){if(bX==false){eh();return}if(Z==false){eh();return}if(bF==false){eh();return}if(U()==true||ec.fileSize==0||ec.fileSize==-1||ec.url.indexOf("ftp://")<0){eh();return}var ei=decodeURIComponent(ec.filename);var ed=a5(ei).toUpperCase();if(bG(ed)==false){eh();return}browser.downloads.cancel(ec.id,function(){browser.downloads.erase({id:ec.id})});var eg=ec.id;var ee=new dW(decodeURIComponent(ec.url));ee.dltype=bg;ee.filename=ei;ee.referer=ec.referrer;delete bx[eg];var ef=new bK("DLHCH_Download");arguments[0]=ee;ef.args=arguments;bx[eg]=ef;dr("id",eg);return true}var cH=function(ec){if(bp){chrome.tabs.update(bp,{active:true})}else{chrome.tabs.create({url:d1},function(ed){if(chrome.runtime.lastError){return}bp=ed.id})}};function bN(ec){return dE(ec,true)}function ai(ec){aQ();an=setInterval(aQ,cW);I=setInterval(bV,bW)}function c9(ec){browser.storage.sync.get("is_extension_enabled",function(ed){browser.storage.sync.get("is_extension_video_enabled",function(ee){if(ed.is_extension_enabled==ec){Z=true;browser.storage.sync.set({is_extension_enabled:true})}else{Z=ed.is_extension_enabled}if(ee.is_extension_video_enabled==ec){O=true;browser.storage.sync.set({is_extension_video_enabled:true})}else{O=ee.is_extension_video_enabled}if(Z&&bX){ct=2;clearTimeout(dK);dK=setInterval(aH,100);aT()}else{clearTimeout(dK);ct=2;dK=null;if(bX){browser.browserAction.setIcon({path:{19:"icons/app19_disabled.png",38:"icons/app38_disabled.png"}})}else{browser.browserAction.setIcon({path:{19:"icons/app19_disabled_x.png",38:"icons/app38_disabled_x.png"}})}}})})}function dJ(){for(var ec in dz){var ed=dz[ec];c4.postMessage({cmd:aa,vid:ed.m_vid,tabid:ed.m_tabId});delete dz[ec]}}function d2(){for(var ed in a7){delete a7[ed]}for(var ec in dA){c4.postMessage({cmd:dV,tabid:ec});delete dA[ec]}}function c2(ec){Z=ec;browser.storage.sync.set({is_extension_enabled:ec},function(ee){c9()});if(ec==false){for(var ed in ad){dC(ed)}}}function bA(ec){O=ec;browser.storage.sync.set({is_extension_video_enabled:ec},function(ed){c9()});if(ec==false){dJ()}}function cd(ec){if(cc){browser.tabs.create({url:cc+(cc[cc.length-1]!="/"?"/":"")+bv})}else{setTimeout(cd,1000)}}function aY(ec){browser.storage.sync.get("is_installed",function(ed){if(bX==false){setTimeout(aY,Date.now()-b4<3000?500:3000);return}if(!ed.is_installed){browser.storage.sync.set({is_installed:true});setTimeout(cd,250);c2(true);bA(true)}else{c9()}browser.storage.sync.get("vmode",function(ee){if(ee.vmode==by){ea=by}})});browser.storage.sync.get("is_welcomer",function(ed){if(!ed.is_welcomer){browser.storage.sync.set({is_welcomer:true});setTimeout(function(){if(bX==false){cH()}},2000)}browser.browserAction.setIcon({path:{19:"icons/app19_disabled.png",38:"icons/app38_disabled.png"}})});browser.storage.sync.get("rateit",function(ed){if(ed.rateit===false){ca=false}});browser.storage.sync.get("cap_pdf",function(ed){if(ed.cap_pdf===false){bf=false}})}function aH(ed){clearTimeout(dK);if(dK==null||Z==false||bF==false||bX==false){dK=setInterval(aH,bw);browser.browserAction.setIcon({path:{19:"icons/app19_disabled.png",38:"icons/app38_disabled.png"}});return}if(ct==0&&ck==true){if(O){if(aL){browser.browserAction.setIcon({path:{19:"icons/app19_vcap1.png",38:"icons/app38_vcap1.png"}})}else{browser.browserAction.setIcon({path:{19:"icons/app19_enabled1.png",38:"icons/app38_enabled1.png"}})}}else{browser.browserAction.setIcon({path:{19:"icons/app19_disvideo1.png",38:"icons/app38_disvideo1.png"}})}ct=1;dK=setInterval(aH,350)}else{if(ct==1&&ck==true){if(O){if(aL){browser.browserAction.setIcon({path:{19:"icons/app19_vcap2.png",38:"icons/app38_vcap2.png"}})}else{browser.browserAction.setIcon({path:{19:"icons/app19_enabled2.png",38:"icons/app38_enabled2.png"}})}}else{browser.browserAction.setIcon({path:{19:"icons/app19_disvideo2.png",38:"icons/app38_disvideo2.png"}})}ct=2;dK=setInterval(aH,200)}else{var ec=bz(10,25)*1000;if(O){if(aL){browser.browserAction.setIcon({path:{19:"icons/app19_vcap.png",38:"icons/app38_vcap.png"}})}else{browser.browserAction.setIcon({path:{19:"icons/app19_enabled.png",38:"icons/app38_enabled.png"}})}}else{browser.browserAction.setIcon({path:{19:"icons/app19_disvideo.png",38:"icons/app38_disvideo.png"}})}if(du>0&&Date.now()-du<5000){return}du=Date.now();ct=0;dK=setInterval(aH,ec)}}}function c0(ed){try{a8();c4=browser.runtime.connectNative(df);c4.onMessage.addListener(dl);aY();ai();ae();c9();browser.runtime.onMessage.addListener(ch);browser.runtime.onConnect.addListener(cI);browser.webNavigation.onCommitted.addListener(dE);browser.webNavigation.onHistoryStateUpdated.addListener(bN);browser.tabs.onCreated.addListener(c1);browser.tabs.onUpdated.addListener(l);browser.windows.onFocusChanged.addListener(cu);browser.tabs.onActivated.addListener(cE);browser.tabs.onRemoved.addListener(cJ);window.DLHCH_Download=bD;window.DLHCH_menu_downloadLink=aK;window.DLHCH_menu_downloadLinks=ak}catch(ec){console.log("Initialize EXCEPTION "+ec)}}var o=function(ec){browser.storage.sync.remove("rateit");browser.storage.sync.remove("is_installed");browser.management.uninstallSelf()};function M(ec){return ea}function dB(ec){if(ec!=ay&&ec!=by){return}ea=ec;browser.storage.sync.set({vmode:ec});(ec==0?d2():dJ())}function aU(ec){return ca}function d5(ec){ca=ec;browser.storage.sync.set({rateit:ec})}function bi(ec){return bf}function cL(ec){bf=ec;browser.storage.sync.set({cap_pdf:ec})}function cz(ed){var ee=ed.split(".");var ec=0;for(var eg=ee.length-1,ef=0;eg>=0&&ef<=3;eg--,ef++){var eh=0;if(ef==0){eh=1}else{if(ef==1){eh=10000}else{if(ef==2){eh=10000*10000}else{if(ef==3){eh=10000*10000*10000}}}}ec=ec+ee[eg]*eh}return ec}function cA(ef,ed){var ee=cz(ef);var ec=cz(ed);if(ee==ec){return 0}return ee>ec?1:-1}function ch(ed,ee,ec){switch(ed.mes){case"get_extension_settings":let obj={mes:ed.mes+"_answer",native_is_available:bX,is_addon_enabled:(Z&&bF),is_addon_video_enabled:O,native_is_free:dq,native_home_url:cc,native_copyright:d6,native_support_email:dM,native_version:D,is_capture_pdf:bi(),is_rate_it:aU(),vmode:M()};chrome.runtime.sendMessage(obj);break;case"set_addon_enabled":c2(ed.bool_value);break;case"set_addon_video_enabled":bA(ed.bool_value);break;case"open_welcomer":cH();break;case"set_capture_pdf":cL(ed.bool_value);break;case"set_vmode":dB(ed.value);break;case"set_rate_it":d5(ed.bool_value);break;case"":break}}function a8(ec){}return new c0()})();function ContentScript(){if(window.antdm_is_script_present){return}else{window.antdm_is_script_present=true}var c={16:"shift",17:"ctrl",18:"alt"};var m=0;var n=0;var q=null;if(!String.prototype.parseUrl){String.prototype.parseUrl=function(){let re=/^(?:([a-z]+):(?:([a-z]*):)?\/\/)?(?:([^:@]*)(?::([^:@]*))?@)?((?:[a-z0-9_-]+\.)+[a-z]{2,}|localhost|(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])\.){3}(?:(?:[01]?\d\d?|2[0-4]\d|25[0-5])))(?::(\d+))?(?:([^:\?\#]+))?(?:\?([^\#]+))?(?:\#([^\s]+))?$/i;let matches=this.match(re);if(!matches){return null}let result={scheme:matches[1]||"",subscheme:matches[2]||"",user:matches[3]||"",pass:matches[4]||"",host:matches[5],port:matches[6]||"",path:matches[7]||"",query:matches[8]||"",fragment:matches[9]||""};return result}}function j(w){var v=window.devicePixelRatio;var t=document.width;var u=document.body.scrollWidth;if(t&&u){v=t==u?0:t/u}return v}function h(t){return typeof(t)==="string"||t instanceof String}function r(t){if(!t){return""}if(t.indexOf("http://")==0){t=t.substr(7)}else{if(t.indexOf("https://")==0){t=t.substr(8)}}return t}function l(y){try{if(!y){return null}var u=y.clientWidth;var C=y.clientHeight;if(u<150||C<100){return null}var z=document.documentElement;var x=z.scrollWidth||z.clientWidth;var t=z.scrollHeight||z.clientHeight;var B=y.getBoundingClientRect();if(B.y<0){var E=y.parentElement.getBoundingClientRect();B.x=E.x;B.y=E.y}var w=B.left+y.clientLeft;var A=B.top+y.clientTop;if(w>=x||A>=t){return null}var D=j();var F={left:Math.ceil(w*D),top:Math.ceil(A*D),right:Math.ceil((w+u)*D),bottom:Math.ceil((A+C)*D)};return F}catch(v){}return null}function k(z){try{var N=["VIDEO","AUDIO","OBJECT","EMBED","FRAME","IFRAME"];var I=r(z.requestUrl);var M=r(z.origUrl);var t=r(z.referer);var R=0;var H,w,D,v,y;var P=document.activeElement;if(P.tagName&&N.indexOf(P.tagName)>=0){w=P}for(var K in N){var Q=N[K];var O=document.getElementsByTagName(N[K]);for(var J=0;J<O.length;J++){var P=O[J];var u=l(P);if(!u){continue}var L=window.getComputedStyle(P);if(L&&L.visibility=="hidden"){continue}if(K==3&&P.type.toLowerCase()!="application/x-shockwave-flash"){continue}var x=P.src||P.data||P.baseURI;if(!h(x)){x=""}if(x&&((I&&x.indexOf(I)>=0)||(M&&x.indexOf(M)>=0))){H=P;break}if(P.poster&&((I&&P.poster.indexOf(I)>=0)||(M&&P.poster.indexOf(M)>=0))){H=P;break}if(P.outerHTML&&((I&&P.outerHTML.indexOf(I)>=0)||(M&&P.outerHTML.indexOf(M)>=0))){H=P;break}if(w||D){continue}if(x==t){D=P;continue}var G=u.right-u.left;var F=u.bottom-u.top;var E=G*F;if(E>R&&1.25<G/F&&G/F<2){R=E;v=P}if(!y){y=P}}if(H){break}}var C=(H||w||D||v||y);if(C&&C.tagName=="EMBED"&&!(C.clientWidth||C.clientHeight)){var B=C.parentElement;if(B.tagName=="OBJECT"){C=B}}return C}catch(A){console.error(A)}}function b(u){var t=[];if(u){var x=u.parseUrl();if(x&&x.path){if(x.query){x.path=x.path+"/"+x.query}var w=x.path.split("/");for(var v=0;v<w.length;v++){if(w[v].length<3){w.splice(v--,1)}else{t.push({tag:w[v],n:0,frame:null})}}}}return t}function e(w,D,E,x,v){var G=b(x);var C=[];C.push(window);C=Array.prototype.concat.apply(C,document.getElementsByTagName("FRAME"));C=Array.prototype.concat.apply(C,document.getElementsByTagName("IFRAME"));for(var z=0;z<C.length;z++){var u=C[z];if(w&&w==u.id){return u}if(D&&D==u.name){return u}if(E&&E==u.className){return u}if(x&&u.document&&x==u.document.URL){return u}if(x&&x==u.src){return u}if(v&&u.src&&u.src.indexOf(v)>0){return u}}for(var z=0;z<C.length;z++){for(var y=0;C[z].src&&y<G.length;y++){var t=C[z].src;var F=G[y].tag;if(C[z].src.indexOf(G[y].tag)>0){G[y].n++;G[y].frame=u}}}var A=0;var B=null;for(var z=0;z<G.length;z++){if(G[z].n==1&&G[z].frame){if(A++>1){break}B=G[z].frame}}if(A==1&&B){return B}return null}function f(){var u="";try{u=window.top.document.title;if(u){return u}}catch(t){}try{u=window.document.title;if(u){return u}}catch(t){}try{u=document.querySelector("meta[property='og:title']").getAttribute("content");if(u){return u}}catch(t){}try{u=window.top.document.URL;if(u){return r(u)}}catch(t){}try{u=window.top.document.baseURI;if(u){return r(u)}}catch(t){}try{u=window.document.URL;if(u){return r(u)}}catch(t){}try{u=window.document.baseURI;if(u){return r(u)}}catch(t){}return""}function o(v){var B=f();var x={cmd:"get_video__rect",id:v.id};if(B){x.title=B}var t=window.devicePixelRatio;var D=window.document.documentElement.clientWidth||window.document.body.clientWidth||0;var z=window.document.documentElement.clientHeight||window.document.body.clientHeight||0;x.screenY=Math.ceil(window.screenY*t);x.screenX=Math.ceil(window.screenX*t);x.screenH=Math.ceil(z*t);x.screenW=Math.ceil(D*t);x.dH=Math.ceil((window.outerHeight-window.innerHeight)*t);x.dW=Math.ceil((window.outerWidth-window.innerWidth)*t);x.mozInnerScreenX=Math.ceil(window.mozInnerScreenX*t);x.mozInnerScreenY=Math.ceil(window.mozInnerScreenY*t);var y=k(v);if(y){x.etag=(y.id?y.id:"");if(!x.etag){x.etag+=(y.className?y.className:"")+(y.name?y.name:"")}var A=l(y);if(A){x.rect=A;x.etag=(y.id?y.id:"");if(!x.etag){x.etag+=(y.className?y.className:"")+(y.name?y.name:"")}try{var C=y.parentElement;x.parent_id=C.id||"";x.parent_name=C.name||"";x.parent_class=C.className||"";x.parent_baseURI=C.baseURI||""}catch(u){}}}q.postMessage(x)}function a(A){var z=f();var v={cmd:"get_parent__rect",id:A.id};if(z){v.title=z}var B=window.devicePixelRatio;var t=window.document.documentElement.clientWidth||window.document.body.clientWidth||0;var u=window.document.documentElement.clientHeight||window.document.body.clientHeight||0;v.screenY=Math.ceil(window.screenY*B);v.screenX=Math.ceil(window.screenX*B);v.screenW=Math.ceil(t*B);v.screenH=Math.ceil(u*B);v.dH=Math.ceil((window.outerHeight-window.innerHeight)*B);v.dW=Math.ceil((window.outerWidth-window.innerWidth)*B);v.mozInnerScreenX=Math.ceil(window.mozInnerScreenX*B);v.mozInnerScreenY=Math.ceil(window.mozInnerScreenY*B);var y=e(A.element_id,A.element_name,A.element_class,A.element_baseURI,A.yttag);if(y){var x=l(y);if(x){v.rect=x}}q.postMessage(v)}function p(t){switch(t.cmd){case"get_parent_rect":a(t);break;case"get_video_rect":o(t);break}}function d(t){if(window.scrollY!=m||window.scrollX!=n){m=window.scrollY;n=window.scrollX;q.postMessage({cmd:"tab_was__scrolled"})}}function i(t){if(c[t.keyCode]){q.postMessage({cmd:"on_key__press",key:c[t.keyCode],state:t.type})}}function s(t){window.removeEventListener("scroll");window.removeEventListener("keydown");window.removeEventListener("keyup");q=null;window.antdm_is_script_present=false}function g(){q=browser.runtime.connect();q.onMessage.addListener(p);q.onDisconnect.addListener(s);window.addEventListener("scroll",d,true);window.addEventListener("keydown",i,true);window.addEventListener("keyup",i,true)}g()};