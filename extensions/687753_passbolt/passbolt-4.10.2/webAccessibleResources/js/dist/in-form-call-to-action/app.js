/*! For license information please see app.js.LICENSE.txt */
(()=>{var e,t={946:(e,t,s)=>{const n=s(815),r=s(207),o=s(627);n.scripting||(n.scripting=new r(n)),n.storage.session||(n.storage.session=new o),n.action||(n.action=n.browserAction),e.exports=n},207:e=>{e.exports=class{constructor(e){this.browser=e}async executeScript(e){return e.func?await this._insertJsFunc(e):this._insertJsFiles(e)}insertCSS(e){let t=null;const s=e.files;for(let n=s.length-1;n>=0;--n){const r={file:s[n],runAt:"document_end",frameId:e.target?.frameIds[0]};t=this._createCssCallback(e.target.tabId,r,t)}t&&t()}_createJsCallback(e,t,s){return()=>chrome.tabs.executeScript(e,t,s)}_createCssCallback(e,t,s){return()=>chrome.tabs.insertCSS(e,t,s)}_insertJsFiles(e){let t=null;const s=e.files;for(let n=s.length-1;n>=0;--n){const r={file:s[n],runAt:"document_end",frameId:e.target?.frameIds[0]};t=this._createJsCallback(e.target.tabId,r,t)}t&&t()}async _insertJsFunc(e){const t=JSON.stringify(e.args),s=`;${e.func.name}.apply(window, ${t});`,n={code:e.func.toString()+s,runAt:"document_end",frameId:e.target?.frameIds[0]},r=await this.browser.tabs.executeScript(e.target.tabId,n);return r?.map((e=>({result:e})))}}},627:e=>{e.exports=class{constructor(){this._storedData={}}async get(e){const t=typeof e;if("string"!==t&&"undefined"!==t)throw new Error(`Expected keys type of "string" but received an unsopprted type: ${t}`);return e?this._storedData[e]?{[e]:this._storedData[e]}:{}:this._storedData}async set(e){if("object"!=typeof e)throw new Error('Expected keys type of "object" but received an unsopprted type: '+typeof e);for(const t in e)this._storedData[t]=JSON.parse(JSON.stringify(e[t]))}async remove(e){delete this._storedData[e]}async clear(){this._storedData={}}}},876:(e,t,s)=>{"use strict";var n=s(540),r=s(961),o=s(556),a=s.n(o);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},i.apply(null,arguments)}const c=n.createContext({user:null,users:null,roles:null,rememberMeOptions:{},resources:null,resource:null,shareResources:null,selectedResources:null,selectedUser:null,folders:null,resourceCommentId:null,mustRefreshComments:!1,siteSettings:null,userSettings:null,onCheckIsAuthenticatedRequested:null}),l=c;class u extends n.Component{constructor(e){super(e),this.state=this.defaultState,this.bindEventHandlers()}componentDidMount(){this.props.context.port.on("passbolt.auth.after-logout",this.handleUserLoggedOut.bind(this)),this.props.context.port.on("passbolt.auth.after-login",this.handleUserLoggedIn.bind(this)),this.checkAuthenticationStatus()}async handleUserLoggedIn(){const e=await this.props.context.port.request("passbolt.in-form-cta.suggested-resources");this.setState({status:{isActive:!0,suggestedResourcesCount:e}})}handleUserLoggedOut(){this.setState({status:{isActive:!1,suggestedResourcesCount:0}})}get defaultState(){return{isReady:!1,status:{isActive:!1,suggestedResourcesCount:null}}}get suggestedResourcesCount(){return this.state.status.suggestedResourcesCount}get logoNumber(){return this.suggestedResourcesCount>5?"5-plus":this.suggestedResourcesCount}bindEventHandlers(){this.handleIconClick=this.handleIconClick.bind(this)}handleIconClick(){this.execute()}async checkAuthenticationStatus(){const{isAuthenticated:e,isMfaRequired:t}=await this.props.context.port.request("passbolt.in-form-cta.check-status"),s=e&&!t;let n=0;s&&(n=await this.props.context.port.request("passbolt.in-form-cta.suggested-resources")),this.setState({isReady:!0,status:{isActive:s,suggestedResourcesCount:n}})}execute(){this.props.context.port.request("passbolt.in-form-cta.execute")}render(){const e=this.state.status.isActive?this.logoNumber:"inactive";return n.createElement(n.Fragment,null,this.state.isReady&&n.createElement("a",{onClick:this.handleIconClick},n.createElement("div",{className:"in-form-icon"},n.createElement("div",{className:`in-form-icon-logo in-form-icon-logo--${e}`}))))}}u.propTypes={context:a().any};const d=(h=u,class extends n.Component{render(){return n.createElement(c.Consumer,null,(e=>n.createElement(h,i({context:e},this.props))))}});var h;class p extends n.Component{constructor(e){super(e),this.state=this.defaultState}get defaultState(){return{port:this.props.port}}render(){return n.createElement(l.Provider,{value:this.state},n.createElement("div",{className:"web-integration"},n.createElement(d,null)))}}p.propTypes={port:a().object};const g=p;var f=s(11);const m=class{constructor(){this._locked=!1,this._queue=[]}acquire(){return this._locked?new Promise((e=>this._queue.push(e))):(this._locked=!0,Promise.resolve())}release(){const e=this._queue.shift();e?e():this._locked=!1}};var b=s(946);const y=class{constructor(e){if(this._listeners={},this.lock=new m,this.onConnectErrorHandler={},void 0===e)throw Error("A port name is required.");if("string"!=typeof e)throw Error("The port name should be a valid string.");this._name=e}connect(){let e;const t=new Promise((t=>{e=t}));try{this._port=b.runtime.connect({name:this._name})}catch(e){throw this.onConnectErrorHandler.callback(),e}return this._connected=!0,this.initListener(),this.once("passbolt.port.ready",e),t}initListener(){this._port.onDisconnect.addListener((()=>{console.warn(`port disconnected from addon code: ${this._name}`),this._connected=!1})),this._port.onMessage.addListener((e=>{this._onMessage(e)}))}_onMessage(e){const t=JSON.parse(e),s=t[0];if(Array.isArray(this._listeners[s])){const e=this._listeners[s];for(let n=0;n<e.length;n++){const r=e[n],o=Array.prototype.slice.call(t,1);r.callback.apply(this,o),r.once&&(this._listeners[s].splice(n,1),0===this._listeners[s].length&&delete this._listeners[s],n--)}}}_addListener(e,t,s){Array.isArray(this._listeners[e])||(this._listeners[e]=[]),this._listeners[e].push({name:e,callback:t,once:s})}on(e,t){this._addListener(e,t,!1)}once(e,t){this._addListener(e,t,!0)}async emit(...e){const t=JSON.stringify(e);await this.connectIfDisconnected(),this._port.postMessage(t)}request(e,...t){const s=(0,f.A)(),n=[e,s].concat(t);return new Promise(((e,t)=>{this.once(s,((s,...n)=>{"SUCCESS"===s?e.apply(null,n):"ERROR"===s&&t.apply(null,n)})),this.emit.apply(this,n)}))}async connectIfDisconnected(){try{await this.lock.acquire(),this._connected||await this.connect()}finally{this.lock.release()}}onConnectError(e){this.onConnectErrorHandler.callback=e}};!async function(){const e=new URLSearchParams(window.location.search).get("passbolt"),t=new y(e);await t.connect();const s=document.createElement("div");document.body.appendChild(s),r.render(n.createElement(g,{port:t}),s)}()}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var o=s[e]={exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,s,r,o)=>{if(!s){var a=1/0;for(u=0;u<e.length;u++){for(var[s,r,o]=e[u],i=!0,c=0;c<s.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((e=>n.O[e](s[c])))?s.splice(c--,1):(i=!1,o<a&&(a=o));if(i){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[s,r,o]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={524:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var r,o,[a,i,c]=s,l=0;if(a.some((t=>0!==e[t]))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(c)var u=c(n)}for(t&&t(s);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},s=self.dataInFormCallToActionChunkLoadingGlobal=self.dataInFormCallToActionChunkLoadingGlobal||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=n.O(void 0,[96],(()=>n(876)));r=n.O(r)})();