"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[1738],{48094:(e,a,t)=>{t.d(a,{D:()=>l});var n=t(61468),o=t(96832),i=t(68593);const l=(0,o.forwardRef)((({label:e,name:a,value:t,placeholder:l,options:c,disabled:_,dataName:r="localeFormat",onChange:d},u)=>{const p=(0,o.useMemo)((()=>c.map((e=>(0,i.tZ)(n.$m,{value:e.value,children:e.label},e.value)))),[c]);return(0,i.tZ)(n.mg,{ref:u,name:a,label:e,placeholder:l,"data-name":r,value:t,onChange:d,readOnly:_,children:p},"country")}));l.displayName="CountryField"},31738:(e,a,t)=>{t.r(a),t.d(a,{BankAccountAddView:()=>N});var n=t(96832),o=t(8180),i=t(78346),l=t(61468),c=t(25792),_=t(44105),r=t(39431),d=t(14900),u=t(48062),p=t(86498),s=t(76376),m=t(39649),b=t(49023),I=t(88203),y=t(45272),C=t(92077),B=t(77063),f=t(63520),h=t(8940),k=t(24507),w=t(93314);var v,g=t(68593);const A="_common_generic_error",N=({lee:e})=>{var a;const[t,N]=(0,n.useState)(!1),[E,S]=(0,n.useState)(!1),[P,D]=(0,n.useState)(new Set),L=(0,n.useRef)(null),{createVaultItem:R}=(0,o.u)(c.L),{routes:O}=(0,s.Xo)(),{openDialog:V,shouldShowFrozenStateDialog:F}=(0,B.Ub)();(0,n.useEffect)((()=>{(0,y.Nc)(u.PageView.ItemBankStatementCreate);const e=setTimeout((()=>{L.current?.focus()}),b.sc);return()=>clearTimeout(e)}),[]),(0,n.useEffect)((()=>{F&&V()}),[F]);const[U,Z]=(0,n.useState)({bankCode:"",country:_.c[e.globalState.locale.country]||_.c.US,IBAN:"",BIC:"",accountName:"",ownerName:"",spaceId:null!=(a=(0,m.B)(e.globalState))?a:""}),x=(e=>{const{data:a}=(0,k.k)(c.L,"query",{vaultItemTypes:[r.U.Identity],propertyFilters:null!==e?[{property:"spaceId",value:e}]:void 0,propertySorting:{property:"lastUse",direction:w.S.Descend}});return a&&a.identitiesResult.matchCount?(e=>{var a;const{firstName:t,lastName:n}=null!=(a=e.filter(Boolean).find((e=>""!==e.firstName.trim()||""!==e.lastName.trim())))?a:{firstName:"",lastName:""};return[t,n].join(" ").trim()})(a.identitiesResult.items):""})(U.spaceId),H=""!==x;(0,n.useEffect)((()=>{""!==x&&Z((e=>({...e,owner:x})))}),[H]);const{translate:T}=(0,I.Z)(),{showAlert:z}=(0,p.V)(),q=()=>{(0,y.Nc)(u.PageView.ItemPaymentList),(0,C.uX)(O.userPayments)},M=(0,n.useCallback)(((e,a=!1)=>{Z((a=>({...a,...e}))),a||N(!0)}),[]);return(0,g.tZ)(f.zI,{isUsingNewDesign:!0,isViewingExistingItem:!1,itemHasBeenEdited:t,formId:"bank-account-add-form",onNavigateOut:q,onSubmit:async()=>{if(E)return;const e=(0,h.e)(U);if(!e.isValid)return D(e.errorSet);S(!0);try{const e=await R({vaultItemType:r.U.BankAccount,content:U});(0,i.d6)(e)?(z(U.accountName?T("webapp_payment_edition_bank_account_name_save_alert",{accountName:U.accountName}):T("webapp_payment_edition_bank_account_generic_save_alert"),d.BLW.SUCCESS),q()):(z(T(A),d.BLW.ERROR),S(!1))}catch(e){z(T(A),d.BLW.ERROR),S(!1)}},header:(0,g.tZ)(f.V9,{icon:v||(v=(0,g.tZ)(l.AK,{type:"bank-account",size:"xlarge"})),title:T("webapp_payment_edition_header_add_bank_account")}),children:(0,g.tZ)(h.o,{bankAccount:U,errors:P,ref:L,onValueChanged:M,variant:"add"})})}},8940:(e,a,t)=>{t.d(a,{o:()=>V,e:()=>F});var n=t(96832),o=t(44105),i=t(48062),l=t(61468),c=t(88203),_=t(45272),r=t(77063),d=t(82207),u=t(68819),p=t(67406),s=t(30309);const m="webapp_payment_edition_field_bank_account_BIC",b="webapp_payment_edition_field_bank_account_no_BIC_placeholder",I="webapp_payment_edition_field_bank_account_account_number",y="webapp_payment_edition_field_bank_account_no_account_number_placeholder",C="webapp_payment_alert_bank_account_BIC_copied",B="webapp_payment_alert_bank_account_account_number_copied";var f=t(48038),h=t(5465);const k={},w=e=>e!==k,v=[];var g=t(68037),A=t(48094),N=t(79432),E=t(68593);const S="webapp_payment_edition_field_bank_account_action_hide",P="webapp_payment_edition_field_bank_account_action_show",D="webapp_payment_edition_field_bank_account_country",L="webapp_payment_edition_field_bank_account_bank_name",R=(e,a)=>e.filter((e=>!(o.c[e]===o.c.UNIVERSAL||o.c[e]===o.c.NO_TYPE))).map((e=>({label:a(`country_name_${o.c[e]}`),value:o.c[e]}))).sort(((e,a)=>e.label.localeCompare(a.label))),O=(e,a)=>{const{bankAccount:t,errors:O=new Set,onValueChanged:V}=e,{bankCode:F,accountName:U,IBAN:Z,BIC:x,ownerName:H,spaceId:T,country:z}=t,q=Z.length>0,M=x.length>0,X=Boolean(T),[$,K]=(0,n.useState)(!M),[W,j]=(0,n.useState)(!q),{translate:G}=(0,c.Z)(),{shouldShowFrozenStateDialog:Y}=(0,r.Ub)(),{logRevealBankAccountField:J,logCopiedBankAccountField:Q}=(0,N.D)(),ee="edit"===e.variant?!e.areProtectedItemsUnlocked:void 0,ae=(e=>{switch(e){case s.cH.MX:return{IBAN:"webapp_payment_edition_field_bank_account_CLABE",BIC:m,IBAN_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_CLABE_placeholder",BIC_PLACEHOLDER:b,IBAN_COPIED:"webapp_payment_alert_bank_account_CLABE_copied",BIC_COPIED:C};case s.cH.GB:return{IBAN:I,BIC:"webapp_payment_edition_field_bank_account_sort_code",IBAN_PLACEHOLDER:y,BIC_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_sort_code_placeholder",IBAN_COPIED:B,BIC_COPIED:"webapp_payment_alert_bank_account_sort_code_copied"};case s.cH.US:return{IBAN:I,BIC:"webapp_payment_edition_field_bank_account_routing_number",IBAN_PLACEHOLDER:y,BIC_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_routing_number_placeholder",IBAN_COPIED:B,BIC_COPIED:"webapp_payment_alert_bank_account_routing_number_copied"};default:return{IBAN:"webapp_payment_edition_field_bank_account_IBAN",BIC:m,IBAN_PLACEHOLDER:"webapp_payment_edition_field_bank_account_no_IBAN_placeholder",BIC_PLACEHOLDER:b,IBAN_COPIED:"webapp_payment_alert_bank_account_IBAN_copied",BIC_COPIED:C}}})(z),te=(0,n.useCallback)((e=>a=>{const t="string"==typeof a?a:a.target.value;V({[e]:t})}),[V]),ne="edit"===e.variant?a=>{(0,_.Kz)(new i.UserRevealVaultItemFieldEvent({field:a,isProtected:!0,itemId:e.itemId,itemType:i.ItemType.BankStatement}))}:void 0,oe="edit"===e.variant?(a,t)=>new Promise(((n,o)=>{if(a||e.areProtectedItemsUnlocked)return t(),n();ee&&"function"==typeof e.openProtectedItemsUnlocker&&e.openProtectedItemsUnlocker({action:u.P.Show,itemType:u.R.CreditCard,successCallback:()=>(t(),n()),cancelCallback:o})})):void 0,ie=()=>{!$&&ne&&(ne(i.Field.Bic),X&&J({name:U,field:i.Field.Bic,country:z})),K((e=>!e))},le=()=>{!W&&ne&&(ne(i.Field.Iban),X&&J({name:U,field:i.Field.Iban,country:z})),j((e=>!e))},ce="edit"===e.variant?a=>{(0,_.Kz)(new i.UserCopyVaultItemFieldEvent({itemType:i.ItemType.BankStatement,field:i.Field.Bic,itemId:e.itemId,isProtected:!0})),X&&Q({name:U,field:i.Field.Bic,country:z}),a&&e.onCopy(G(ae.BIC_COPIED))}:void 0,_e="edit"===e.variant?a=>{(0,_.Kz)(new i.UserCopyVaultItemFieldEvent({itemType:i.ItemType.BankStatement,field:i.Field.Iban,itemId:e.itemId,isProtected:!0})),X&&Q({name:U,field:i.Field.Iban,country:z}),a&&e.onCopy(G(ae.IBAN_COPIED))}:void 0,re=(e=>{const a=(()=>{const e=n.useRef(k),a=(0,f.qr)({queryConfig:{query:h.C.getAllBanks}},[]);return w(e.current)||a.status!==f.rq.Success||(e.current=a.data),e.current})();return n.useMemo((()=>{var t;if(!w(a))return v;const n=(null!=(t=a[e])?t:[]).slice();return n.sort(((e,a)=>e.localizedString.localeCompare(a.localizedString))),n}),[a,e])})(z),de=re!==v,ue=(0,n.useMemo)((()=>re.map((e=>({label:e.localizedString,value:`${e.code}`})))),[re]);(0,n.useEffect)((()=>{var e;void 0===(e=F,ue.find((({value:a})=>a===e)))&&ue.length>0&&V({bankCode:ue[0].value},!0),""!==F&&!ue.length&&de&&V({bankCode:""})}),[F,t,ue,de,V]);const pe=(0,n.useMemo)((()=>{const e=Object.keys(o.c);return(0,E.tZ)(A.D,{label:G(D),placeholder:G(D)+z,disabled:!!Y,options:R(e,G),value:z,onChange:te("country")})}),[z,te,Y,G]),se=(0,n.useMemo)((()=>ue.length>0?(0,E.tZ)(l.mg,{label:G(L),placeholder:G(L)+F,onChange:te("bankCode"),value:F,readOnly:!!Y,children:ue.map((e=>(0,E.tZ)(l.$m,{value:e.value,children:e.label},e.value)))},`${z}bank`):null),[F,ue,z,te,Y,G]);return(0,E.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,E.BX)(g.u,{title:G("webapp_payment_edition_content_bank_details_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,E.tZ)(l.qo,{value:H,label:G("webapp_payment_edition_field_bank_account_owner_name"),placeholder:G("webapp_payment_edition_field_bank_account_no_owner_name_placeholder"),onChange:te("ownerName"),disabled:!!Y,ref:a},"owner"),(0,E.tZ)(l.Nc,{required:!0,label:G(ae.IBAN),placeholder:G(ae.IBAN_PLACEHOLDER),"data-name":"IBAN",readOnly:!W&&q||!!Y,isValueInitiallyVisible:W,toggleVisibilityLabel:{hide:G(S),show:G(P)},onValueVisibilityChangeRequest:oe?()=>oe?.(W,le):void 0,actions:_e&&void 0!==ee?[(0,E.tZ)(d.m,{data:Z,checkProtected:()=>ee,onCopy:_e,itemType:u.R.BankAccount},"copy-iban")]:void 0,value:W?Z:"●●●●●●●●●●●●●●●●",onChange:te("IBAN"),error:O.has("IBAN")},"IBAN"),(0,E.tZ)(l.Nc,{readOnly:!$&&M||!!Y,value:$?x:"●●●●●●",label:G(ae.BIC),placeholder:G(ae.BIC_PLACEHOLDER),isValueInitiallyVisible:$,toggleVisibilityLabel:{hide:G(S),show:G(P)},onValueVisibilityChangeRequest:oe?()=>oe?.($,ie):void 0,actions:ce&&void 0!==ee?[(0,E.tZ)(d.m,{data:x,checkProtected:()=>ee,onCopy:ce,itemType:u.R.BankAccount},"copy-bic")]:void 0,onChange:te("BIC"),error:O.has("BIC")},"BIC"),pe,se]}),(0,E.BX)(g.u,{title:G("webapp_payment_edition_content_bank_organization_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,E.tZ)(l.qo,{value:U,label:G("webapp_payment_edition_field_bank_account_name"),placeholder:G("webapp_payment_edition_field_bank_account_no_name_placeholder"),onChange:te("accountName"),disabled:!!Y},"name"),(0,E.tZ)(p.M,{isUsingNewDesign:!0,spaceId:null!=T?T:"",labelSx:p.e,onChange:e=>te("spaceId")(e),disabled:!!Y})]})]})},V=(0,n.forwardRef)(O),F=e=>e.IBAN&&0!==e.IBAN.length?{isValid:!0}:{isValid:!1,errorSet:new Set(["IBAN"])}}}]);