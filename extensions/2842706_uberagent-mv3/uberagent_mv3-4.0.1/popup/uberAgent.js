console.debug("Popup script started");const o=document.getElementById("SliderCheckbox");o==null&&console.error("CRITICAL ERROR: Unable to find the slider checkbox");let a=!0,t;async function r(){try{const e=await browser.storage.managed.get({EnableBrowserDataCollection:!1});e.EnableBrowserDataCollection!=null?(t=e.EnableBrowserDataCollection,a=!1,console.info("Read configuration from managed storage. Data collection enabled: ",e.EnableBrowserDataCollection)):console.error("No configuration value found in managed storage")}catch(e){console.info(`Managed storage configuration not available: <${e}>. Letting the user decide.`)}if(a){try{const e=await browser.storage.local.get("EnableBrowserDataCollection");e.EnableBrowserDataCollection!=null?(t=e.EnableBrowserDataCollection,console.info("Read configuration from local storage. Data collection enabled: ",e.EnableBrowserDataCollection)):console.info("No configuration found in local storage. Data collection enabled: ",t)}catch(e){console.info("Unable to read local storage: ",e)}o.addEventListener("change",i)}n()}async function i(){t=o.checked,console.warn("Data collection enabled: ",o.checked),n();try{await browser.storage.local.set({EnableBrowserDataCollection:o.checked})}catch(e){console.error("Unable to write to local storage: ",e);return}window.addEventListener("blur",()=>{console.warn("ðŸš¨ Data collection settings changed by the user. Reloading extension..."),browser.runtime.reload()})}function n(){const e=document.getElementById("uberAgentExtensionStatus");e==null&&console.error("CRITICAL ERROR: Unable to find the status text");const l=document.getElementById("SliderLabel");l==null&&console.error("CRITICAL ERROR: Unable to find the slider label"),o.checked=t,a?o.disabled=!1:(o.disabled=!0,o.style.visibility="hidden",l.style.visibility="hidden"),t?(e.textContent="Data collection is enabled",l.title="Click to disable data collection"):(e.textContent="Data collection is disabled",l.title="Click to enable data collection")}r();
