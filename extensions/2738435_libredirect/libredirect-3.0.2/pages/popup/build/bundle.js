var app=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(n)}function a(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o;function i(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function l(e,t,n,r){if(e){const s=u(e,t,n,r);return e[0](s)}}function u(e,n,r,s){return e[1]&&s?t(r.ctx.slice(),e[1](s(n))):r.ctx}function h(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|s[r];return e}return t.dirty|s}return t.dirty}function $(e,t,n,r,s,a){if(s){const c=u(t,n,r,a);e.p(c,s)}}function p(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function m(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function d(e,t){const n={};t=new Set(t);for(const r in e)t.has(r)||"$"===r[0]||(n[r]=e[r]);return n}function f(e,t){e.appendChild(t)}function g(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode&&e.parentNode.removeChild(e)}function b(e){return document.createElement(e)}function v(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function x(e){return document.createTextNode(e)}function y(){return x(" ")}function k(){return x("")}function P(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function q(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}const I=["width","height"];function C(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const r in t)null==t[r]?e.removeAttribute(r):"style"===r?e.style.cssText=t[r]:"__value"===r?e.value=e[r]=t[r]:n[r]&&n[r].set&&-1===I.indexOf(r)?e[r]=t[r]:q(e,r,t[r])}function _(e,t){for(const n in t)q(e,n,t[n])}function M(e,t,n){e.classList[n?"add":"remove"](t)}let W;function R(e){W=e}function L(){if(!W)throw new Error("Function called outside component initialization");return W}function T(e){L().$$.on_destroy.push(e)}function O(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const z=[],S=[];let A=[];const E=[],U=Promise.resolve();let N=!1;function j(e){A.push(e)}const B=new Set;let H=0;function Z(){if(0!==H)return;const e=W;do{try{for(;H<z.length;){const e=z[H];H++,R(e),D(e.$$)}}catch(e){throw z.length=0,H=0,e}for(R(null),z.length=0,H=0;S.length;)S.pop()();for(let e=0;e<A.length;e+=1){const t=A[e];B.has(t)||(B.add(t),t())}A.length=0}while(z.length);for(;E.length;)E.pop()();N=!1,B.clear(),R(e)}function D(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(j)}}const Q=new Set;let Y;function G(){Y={r:0,c:[],p:Y}}function K(){Y.r||s(Y.c),Y=Y.p}function X(e,t){e&&e.i&&(Q.delete(e),e.i(t))}function F(e,t,n,r){if(e&&e.o){if(Q.has(e))return;Q.add(e),Y.c.push((()=>{Q.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}function V(e,t){const n={},r={},s={$$scope:1};let a=e.length;for(;a--;){const c=e[a],o=t[a];if(o){for(const e in c)e in o||(r[e]=1);for(const e in o)s[e]||(n[e]=o[e],s[e]=1);e[a]=o}else for(const e in c)s[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function J(e){e&&e.c()}function ee(e,t,r,c){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,r),c||j((()=>{const t=e.$$.on_mount.map(n).filter(a);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),i.forEach(j)}function te(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];A.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),A=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ne(e,t){-1===e.$$.dirty[0]&&(z.push(e),N||(N=!0,U.then(Z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function re(t,n,a,c,o,i,l,u=[-1]){const h=W;R(t);const $=t.$$={fragment:null,ctx:[],props:i,update:e,not_equal:o,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||h.$$.root};l&&l($.root);let p=!1;if($.ctx=a?a(t,n.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return $.ctx&&o($.ctx[e],$.ctx[e]=s)&&(!$.skip_bound&&$.bound[e]&&$.bound[e](s),p&&ne(t,e)),n})):[],$.update(),p=!0,s($.before_update),$.fragment=!!c&&c($.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);$.fragment&&$.fragment.l(e),e.forEach(w)}else $.fragment&&$.fragment.c();n.intro&&X(t.$$.fragment),ee(t,n.target,n.anchor,n.customElement),Z()}R(h)}class se{$destroy(){te(this,1),this.$destroy=e}$on(t,n){if(!a(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ae(e){return e[~~(e.length*Math.random())]}function ce(e){return new Promise((async t=>{let n,r=new XMLHttpRequest;r.timeout=5e3,r.ontimeout=()=>t(5e3),r.onerror=()=>t(),r.onreadystatechange=()=>{if(2==r.readyState)if(200==r.status){let e=(new Date).getTime();r.abort(),t(e-n)}else t(5e3+r.status)},r.open("GET",`${e}?_=${(new Date).getTime()}`,!0),n=(new Date).getTime(),r.send(null)}))}function oe(e){return new Promise((async t=>{let n,r=0;for(let s=0;s<3;s++)if(n=await ce(e),0!=s){if(n>=5e3)return void t(n);r+=n}r=parseInt(r/3),t(r)}))}function ie(e,t){let n=[];t>e.length&&(t=e.length);for(let r=0;r<t;r++){const t=e[Math.floor(Math.random()*e.length)];n.push(t)}return n}window.browser=window.browser||window.chrome;var le={getRandomInstance:ae,getNextInstance:function(e,t){const n=t.indexOf(e);return-1===n?ae(t):t[(n+1)%t.length]},protocolHost:function(e){if(e.pathname=e.pathname.replace(/\/$/,""),e.username&&e.password)return`${e.protocol}//${e.username}:${e.password}@${e.host}${e.pathname}`;if("/TekstoLibre/"==e.pathname&&e.host.endsWith("github.io"))return`${e.protocol}//${e.host}${e.pathname.slice(0,-1)}`;const t="/"!=e.pathname?e.pathname:"";return`${e.protocol}//${e.host}${t}`},getList:function(e){return new Promise((t=>{let n;if("github"==e.fetchInstances)n="https://raw.githubusercontent.com/libredirect/instances/main/data.json";else{if("codeberg"!=e.fetchInstances)return t("disabled");n="https://codeberg.org/LibRedirect/instances/raw/branch/main/data.json"}const r=new XMLHttpRequest;r.open("GET",n,!0),r.onreadystatechange=()=>{if(200===r.status&&r.readyState==XMLHttpRequest.DONE)return t(JSON.parse(r.responseText))},r.onerror=()=>t(),r.ontimeout=()=>t(),r.send(null)}))},getBlacklist:function(e){return new Promise((t=>{let n;if("github"==e.fetchInstances)n="https://raw.githubusercontent.com/libredirect/instances/main/blacklist.json";else{if("codeberg"!=e.fetchInstances)return t("disabled");n="https://codeberg.org/LibRedirect/instances/raw/branch/main/blacklist.json"}const r=new XMLHttpRequest;r.open("GET",n,!0),r.onreadystatechange=()=>{200===r.status&&r.readyState==XMLHttpRequest.DONE&&t(JSON.parse(r.responseText))},r.onerror=()=>t(),r.ontimeout=()=>t(),r.send(null)}))},getConfig:function(){return new Promise((e=>{fetch("/config.json").then((e=>e.text())).then((t=>{e(JSON.parse(t))}))}))},getOptions:function(){return new Promise((e=>browser.storage.local.get("options",(t=>e(t.options)))))},getPingCache:function(){return new Promise((e=>browser.storage.local.get("pingCache",(t=>e(t.pingCache??{})))))},ping:oe,addressToLatLng:function(e){const t=new XMLHttpRequest;if(t.open("GET",`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(e)}&format=json&limit=1`,!1),t.send(),200==t.status){const e=JSON.parse(t.responseText)[0];return e?{coordinate:`${e.lat},${e.lon}`,boundingbox:`${e.boundingbox[2]},${e.boundingbox[1]},${e.boundingbox[3]},${e.boundingbox[0]}`}:{}}},getQuery:function(e){let t="";return e.searchParams.has("q")?t=e.searchParams.get("q"):e.searchParams.has("query")&&(t=e.searchParams.has("query")),t},prefsEncoded:function(e){return new URLSearchParams(e).toString()},convertMapCentre:function(e){let[t,n,r]=[null,null,null];const s=e.pathname.match(/@(-?\d[0-9.]*),(-?\d[0-9.]*),(\d{1,2})[.z]/);return s?[,n,t,r]=s:e.searchParams.has("center")&&([t,n]=e.searchParams.get("center").split(","),r=e.searchParams.get("zoom")??"17"),{zoom:r,lon:n,lat:t}},randomInstances:ie,style:function(e,t){const n=function(e,t){const n={text:"#fff",bgMain:"#121212",bgSecondary:"#202020",active:"#fbc117",danger:"#f04141",lightGrey:"#c3c3c3"},r={text:"black",bgMain:"white",bgSecondary:"#e4e4e4",active:"#fb9817",danger:"#f04141",lightGrey:"#c3c3c3"};return"dark"==e.theme?n:"light"==e.theme?r:t.matchMedia("(prefers-color-scheme: dark)").matches?n:r}(e,t);return`--text: ${n.text};\n  --bg-main: ${n.bgMain};\n  --bg-secondary: ${n.bgSecondary};\n  --active: ${n.active};\n  --danger: ${n.danger};\n  --light-grey: ${n.lightGrey};`},autoPickInstance:async function(e,t){if(t){const n=e.findIndex((e=>t.href.startsWith(e)));n>=0&&e.splice(n,1)}const n=ie(e,5),r=await Promise.all([...n.map((async e=>[e,await oe(e)]))]);return r.sort(((e,t)=>e[1]-t[1])),r[0][0]}};const ue=void 0===browser.runtime.getBrowserInfo;let he,$e;async function pe(){$e=await le.getOptions(),he=await le.getConfig()}function me(e,t,n,r){let s=[];if(t)n[t]&&(s=n[t]);else for(const t in r.services[e].frontends)n[t]&&s.push(...n[t]);return s}function de(e,t,n,r,s){let a=n.services[e].targets;s&&"excludeTargets"in n.services[e].frontends[s]&&("search"===e&&r.search.redirectGoogle||(a=a.filter((t=>!n.services[e].frontends[s].excludeTargets.includes(a.indexOf(t))))));for(const e in a){if(new RegExp(a[e]).test(t.href))return!0}return!1}function fe(e,t,n,r,s,a){if("main_frame"!=t&&"sub_frame"!=t&&"image"!=t)return;let c,o;if(a||1!=$e.redirectOnlyInIncognito||s){for(const i in he.services){if(!a&&!$e[i].enabled)continue;if(!a&&1==$e[i].redirectOnlyInIncognito&&!s)continue;if(o=$e[i].frontend,he.services[i].frontends[o].desktopApp&&"main_frame"!=t&&"main_frame"!=$e[i].redirectType&&(o=$e[i].embedFrontend),!de(i,e,he,$e,o)){o=null;continue}if("main_frame"!=t&&r&&"sub_frame"==$e[i].redirectType&&de(i,r,he,$e,o))return;if(he.services[i].embeddable&&t!=$e[i].redirectType&&"both"!=$e[i].redirectType)return"block"==$e[i].unsupportedUrls?"CANCEL":void 0;let l=$e[o];if(void 0===l)break;if(he.services[i].frontends[o].localhost&&"localhost"==$e[i].instance)c=`http://${o}.localhost:8080`;else{if(0===l.length)return`https://no-instance.libredirect.invalid?frontend=${encodeURIComponent(o)}&url=${encodeURIComponent(e.href)}`;c=le.getRandomInstance(l)}if(n&&l.includes(n.origin))return"main_frame"==t?"BYPASSTAB":null;break}if(o)return function(e,t,n,r){switch(n){case"hyperpipe":for(const t of[...e.searchParams.keys()])"q"!==t&&e.searchParams.delete(t);return`${r}${e.pathname}${e.search}`.replace(/\/search\?q=.*/,(e=>e.replace("?q=","/")));case"searx":case"searxng":for(const t of[...e.searchParams.keys()])"q"!==t&&e.searchParams.delete(t);return`${r}/${e.search}`;case"whoogle":for(const t of[...e.searchParams.keys()])"q"!==t&&e.searchParams.delete(t);return`${r}/search${e.search}`;case"4get":{const t=e.searchParams.get("q");return null!==t?`${r}/web?s=${encodeURIComponent(t)}`:r}case"librey":for(const t in e.searchParams.keys())"q"!=t&&e.searchParams.delete(t);return`${r}/search.php${e.search}`;case"yattee":return e.searchParams.delete("si"),e.href.replace(/^https?:\/{2}/,"yattee://");case"freetube":case"freetubePwa":return e.searchParams.delete("si"),"freetube://"+e.href;case"poketube":if(e.searchParams.delete("si"),e.pathname.startsWith("/channel")){const t=/\/channel\/(.*)\/?$/.exec(e.pathname);if(t)return`${r}/channel?id=${t[1]}${e.search}`}return/\/@[a-z]+\//.exec(e.pathname)?r:`${r}${e.pathname}${e.search}`;case"libMedium":case"scribe":{const t=e.hostname.match(/^(link|cdn-images-\d+|.*)\.medium\.com/);if(t&&t.length>1){const n=t[1];if("link"!=n||!n.startsWith("cdn-images"))return`${r}/@${n}${e.pathname}${e.search}`}return`${r}${e.pathname}${e.search}`}case"translite":case"simplyTranslate":return`${r}/${e.search}`;case"send":case"mozhi":return r;case"libreTranslate":return`${r}/${e.search.replace("sl","source").replace("tl","target").replace("text","q")}`;case"osm":{if(t&&"earth.google.com"===t.host)return r;let n={layers:"mapnik"},s="#";const a=le.convertMapCentre(e);if(a.zoom&&a.lon&&a.lat&&(s=`#map=${a.zoom}/${a.lon}/${a.lat}`),e.pathname.includes("/embed")){const t=le.getQuery(e);let{coordinate:s,boundingbox:a}=le.addressToLatLng(t);return n.bbox=a,n.marker=s,`${r}/export/embed.html?${le.prefsEncoded(n)}`}if(e.pathname.includes("/dir")){if(e.searchParams.has("travelmode")){const t={driving:"fossgis_osrm_car",walking:"fossgis_osrm_foot",bicycling:"fossgis_osrm_bike",transit:"fossgis_osrm_car"};n.engine=t[e.searchParams.get("travelmode")]}const t=/\/dir\/([^@/]+)\/([^@/]+)\/@-?\d[0-9.]*,-?\d[0-9.]*,\d{1,2}[.z]/.exec(e.pathname),a=/\/dir\/([^@/]+)\//.exec(e.pathname);if(t){const e=le.addressToLatLng(decodeURIComponent(t[1])).coordinate??"",r=le.addressToLatLng(decodeURIComponent(t[2])).coordinate??"";n.route=`${e};${r}`}else if(a){const e=le.addressToLatLng(decodeURIComponent(a[1])).coordinate??"";n.route=`${e};`}else{const t=le.addressToLatLng(e.searchParams.get("origin")).coordinate??"",r=le.addressToLatLng(e.searchParams.get("destination")).coordinate??"";n.route=`${t};${r}`}return`${r}/directions?${le.prefsEncoded(n)}${s}`}const c=/\/place\/(.*?)\//;if(e.pathname.match(c))return`${r}/search?query=${e.pathname.match(c)[1]}${s}`;if(e.searchParams.has("ll")){const[t,n]=e.searchParams.get("ll").split(",");return`${r}/search?query=${t}%2C${n}`}if(e.searchParams.has("viewpoint")){const[t,n]=e.searchParams.get("viewpoint").split(",");return`${r}/search?query=${t}%2C${n}`}const o=le.getQuery(e);return o?`${r}/search?query="${o}${s}&${le.prefsEncoded(n)}`:`${r}/${s}&${le.prefsEncoded(n)}`}case"breezeWiki":{let t,n="";return e.hostname.match(/^[a-zA-Z0-9-]+\.(?:fandom|wikia)\.com/)?(t=e.hostname.match(/^[a-zA-Z0-9-]+(?=\.(?:fandom|wikia)\.com)/),t="www"!=t&&t?`/${t}`:"",n=e.pathname):(t=e.pathname.match(/(?<=wiki\/w:c:)[a-zA-Z0-9-]+(?=:)/),t?(t="/"+t+"/wiki/",n=e.pathname.match(/(?<=wiki\/w:c:[a-zA-Z0-9-]+:).+/)):t=""),e.href.search(/Special:Search\?query/)>-1?`${r}${t}${n}${e.search}`.replace(/Special:Search\?query/,"search?q").replace(/\/wiki/,""):`${r}${t}${n}${e.search}`}case"rimgo":return e.href.search(/^https?:\/{2}(?:[im]\.)?stack\./)>-1?`${r}/stack${e.pathname}${e.search}`:`${r}${e.pathname}${e.search}`;case"redlib":case"libreddit":{const t=e.hostname.match(/^(?:(?:external-)?preview|i)(?=\.redd\.it)/);if(!t)return`${r}${e.pathname}${e.search}`;switch(t[0]){case"preview":return`${r}/preview/pre${e.pathname}${e.search}`;case"external-preview":return`${r}/preview/external-pre${e.pathname}${e.search}`;case"i":return`${r}/img${e.pathname}`}return r}case"teddit":return/^(?:(?:external-)?preview|i)\.redd\.it/.test(e.hostname)?""==e.search?`${r}${e.pathname}?teddit_proxy=${e.hostname}`:`${r}${e.pathname}${e.search}&teddit_proxy=${e.hostname}`:`${r}${e.pathname}${e.search}`;case"eddrit":return/^(?:(?:external-)?preview|i)\.redd\.it/.test(e.hostname)?r:`${r}${e.pathname}${e.search}`;case"neuters":{const t=e.pathname;return t.startsWith("/article/")||t.startsWith("/pf/")||t.startsWith("/arc/")||t.startsWith("/resizer/")?r:`${r}${t}`}case"dumb":return e.pathname.endsWith("-lyrics")?`${r}${e.pathname}`:`${r}${e.pathname}${e.search}`;case"intellectual":return`${r}${e.pathname}${e.search}`;case"ruralDictionary":return e.pathname.includes("/define.php")||e.pathname.includes("/random.php")||"/"==e.pathname?`${r}${e.pathname}${e.search}`:r;case"anonymousOverflow":{if("stackoverflow.com"==e.hostname){const t=/^\/a\/(\d+)\/?/.exec(e.pathname);return t?`${r}/questions/${t[1]}${e.search}`:`${r}${e.pathname}${e.search}`}if("/"==e.pathname||""==e.pathname)return`${r}${e.pathname}${e.search}`;const t=e.href.match(/https?:\/{2}(?:([a-zA-Z0-9-]+)\.)?stackexchange\.com\//);if(t&&t.length>1)return`${r}/exchange/${t[1]}${e.pathname}${e.search}`;const n=e.hostname.match(/(?:[a-zA-Z]+\.)?(?:askubuntu\.com|mathoverflow\.net|serverfault\.com|stackapps\.com|superuser\.com|stackoverflow\.com)/);return n?`${r}/exchange/${n[0]}${e.pathname}${e.search}`:`${r}${e.pathname}${e.search}`}case"biblioReads":return`${r}${e.pathname}${e.search}`;case"wikiless":{let t=e.host.split(".");return"wikipedia"!=t[0]&&"www"!=t[0]&&("m"==t[0]?e.searchParams.append("mobileaction","toggle_view_mobile"):e.searchParams.append("lang",t[0]),"m"==t[1]&&e.searchParams.append("mobileaction","toggle_view_mobile")),`${r}${e.pathname}${e.search}${e.hash}`}case"proxiTok":return e.pathname.startsWith("/email")?r:`${r}${e.pathname}${e.search}`;case"waybackClassic":{const t=/^\/\web\/(?:[0-9]+)?\*\/(.*)/.exec(e.pathname);if(t){const e=t[1];return`${r}/cgi-bin/history.cgi?utf8=✓&q=${encodeURIComponent(e)}`}const n=/(^\/\web\/([0-9]+)\/.*)/.exec(e.pathname);if(n){let e=n[1];return e=e.replace(n[2],n[2]+"if_"),`https://web.archive.org${e}`}return}case"gothub":return"gist.github.com"==e.hostname?`${r}/gist${e.pathname}${e.search}`:"raw.githubusercontent.com"==e.hostname?`${r}/raw${e.pathname}${e.search}`:`${r}${e.pathname}${e.search}`;case"mikuInvidious":if("bilibili.com"==e.hostname||"www.bilibili.com"==e.hostname||"b23.tv"==e.hostname)return`${r}${e.pathname}${e.search}`;if("space.bilibili.com"==e.hostname)return`${r}/space${e.pathname}${e.search}`;case"tent":if("bandcamp.com"==e.hostname&&"/search"==e.pathname){const t=e.searchParams.get("q");return`${r}/search.php?query=${encodeURIComponent(t)}`}if(e.hostname.endsWith("bandcamp.com")){const t=/^(.*)\.bandcamp\.com/.exec(e.hostname)[1];if("/"==e.pathname||"/music"==e.pathname)return`${r}/artist.php?name=${t}`;{const n=/^\/(.*)\/(.*)/.exec(e.pathname);if(n)return`${r}/release.php?artist=${t}&type=${n[1]}&name=${n[2]}`}}if("f4.bcbits.com"==e.hostname)return`${r}/image.php?file=${/\/img\/(.*)/.exec(e.pathname)[1]}`;if("t4.bcbits.com"==e.hostname){const t=/\/stream\/(.*)\/(.*)\/(.*)/.exec(e.pathname);if(t){const n=t[1],s=t[2],a=t[3],c=e.searchParams.get("token");return`${r}/audio.php/?directory=${n}&format=${s}&file=${a}&token=${encodeURIComponent(c)}`}}case"binternet":return"i.pinimg.com"==e.hostname?`${r}/image_proxy.php?url=${e.href}`:`${r}${e.pathname}${e.search}`;case"laboratory":{let t=e.pathname;return"/"==t&&(t=""),`${r}/${e.hostname}${t}${e.search}`}case"quetre":{const t=/([a-z]+)\.quora\.com/.exec(e.hostname);if(t){const n=t[1];return e.searchParams.append("lang",n),`${r}${e.pathname}${e.search}`}return`${r}${e.pathname}${e.search}`}case"liteXiv":case"pixivFe":{const t=/\/[a-z]{1,3}\/(.*)/.exec(e.pathname);return t?`${r}/${t[1]}${e.search}`:`${r}${e.pathname}${e.search}`}case"invidious":return e.searchParams.delete("si"),"youtu.be"==e.hostname||e.hostname.endsWith("youtube.com")&&e.pathname.startsWith("/live")?`${r}/watch?v=${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}${e.search.replace("?","&")}`:e.hostname.endsWith("youtube.com")&&e.pathname.startsWith("/redirect?")?e.href:`${r}${e.pathname}${e.search}`;case"freetubeMusic":return"youtu.be"==e.hostname||e.hostname.endsWith("youtube.com")&&e.pathname.startsWith("/live")?`freetube://youtube.com/watch?v=${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}`:"freetube://"+e.href;case"invidiousMusic":return"youtu.be"==e.hostname||e.hostname.endsWith("youtube.com")&&e.pathname.startsWith("/live")?`${r}/watch?v=${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}`:`${r}${e.pathname}${e.search}`;case"materialious":if(e.searchParams.delete("si"),"youtu.be"==e.hostname||e.hostname.endsWith("youtube.com")&&e.pathname.startsWith("/live"))return`${r}/watch/${e.pathname.substring(e.pathname.lastIndexOf("/")+1)}${e.search.replace("?","&")}`;if(e.hostname.endsWith("youtube.com")){if(e.pathname.startsWith("/watch")){if(e.searchParams.has("v")){const t=e.searchParams.get("v");return e.searchParams.delete("v"),`${r}/watch/${t}${e.search.replace("?","&")}`}return`${r}/watch/${e.search.replace("?","&")}`}if(e.pathname.startsWith("/results")){if(e.searchParams.has("search_query")){const t=e.searchParams.get("search_query");return e.searchParams.delete("search_query"),`${r}/search/${t}${e.search.replace("?","&")}`}return`${r}/search/${e.search.replace("?","&")}`}if(e.pathname.startsWith("/redirect?"))return e.href}return`${r}${e.pathname}${e.search}`;case"libremdb":if(e.pathname.startsWith("/Name"))for(const[t,n]of e.searchParams.entries())return`${r}/title/${encodeURIComponent(t)}`;return`${r}${e.pathname}${e.search}`;case"tuboYoutube":return e.searchParams.delete("si"),e.pathname.startsWith("/channel")?`${r}/channel?url=${encodeURIComponent(e.href)}`:e.pathname.startsWith("/watch")?`${r}/stream?url=${encodeURIComponent(e.href)}`:r;case"tuboSoundcloud":return"/"==e.pathname?`${r}?kiosk?serviceId=1`:e.pathname.match(/^\/[^\/]+(\/$|$)/)?`${r}/channel?url=${encodeURIComponent(e.href)}`:e.pathname.match(/^\/[^\/]+\/[^\/]+/)?`${r}/stream?url=${encodeURIComponent(e.href)}`:r;case"twineo":case"safetwitch":return e.hostname.startsWith("clips.")?`${r}/clip${e.pathname}${e.search}`:`${r}${e.pathname}${e.search}`;case"tekstoLibre":return`${r}/?${e.pathname.slice(1)}`;case"skyview":return"/"==e.pathname?r:`${r}?url=${encodeURIComponent(e.href)}`;case"nitter":{let t=new URLSearchParams(e.search);if(t.delete("ref_src"),t.delete("ref_url"),t.delete("s"),t.delete("t"),t=t.toString(),""!==t&&(t=`?${t}`),"pbs"===e.host.split(".")[0]||"video"===e.host.split(".")[0])try{const[,n,s,a]=t.match(/(.*)\?format=(.*)&(.*)/),c=encodeURIComponent(`${n}.${s}?${a}`);return`${r}/pic${e.pathname}${c}`}catch{return`${r}/pic${e.pathname}${t}`}return e.pathname.split("/").includes("tweets")?`${r}${e.pathname.replace("/tweets","")}${t}`:"t.co"==e.host?`${r}/t.co${e.pathname}`:`${r}${e.pathname}${t}#m`}case"priviblur":{if("www.tumblr.com"==e.hostname)return`${r}${e.pathname}${e.search}`;if(e.hostname.startsWith("assets"))return`${r}/tblr/assets${e.pathname}${e.search}`;if(e.hostname.startsWith("static"))return`${r}/tblr/static${e.pathname}${e.search}`;const t=/^([0-9]+)\.media\.tumblr\.com/.exec(e.hostname);if(t)return`${r}/tblr/media/${t[1]}${e.pathname}${e.search}`;const n=/^(?:www\.)?([a-z\d-]+)\.tumblr\.com/.exec(e.hostname);if(n){const t=n[1];return e.pathname.startsWith("/post")?`${r}/${t}${e.pathname.slice(5)}${e.search}`:`${r}/${t}${e.pathname}${e.search}`}return`${r}${e.pathname}${e.search}`}case"freetar":if(e.pathname.startsWith("/search.php"))return e.searchParams.set("search_term",e.searchParams.get("value")),e.searchParams.delete("value"),e.searchParams.delete("search_type"),`${r}/search${e.search}`;if(e.pathname.startsWith("/artist"))return;return`${r}${e.pathname}${e.search}`;case"ratAintTieba":return e.searchParams.delete("ie"),`${r}${e.pathname}${e.search}`;case"shoelace":{const t=/^\/(?:(?:(?:[^\/])?\/post)|t)\/([^\/])/.exec(e.pathname);return t?`${r}/t/${t[1]}${e.search}`:`${r}${e.pathname}${e.search}`}case"skunkyArt":{if(e.pathname.startsWith("/search"))return`${r}${e.pathname}${e.search}&type=all`;const t=/^\/(.*?)\/art\/(.*)\/?/.exec(e.pathname);if(t)return`${r}/post/${t[1]}/${t[2]}${e.search}`;const n=/^\/([^\/]+)$/.exec(e.pathname);if(n)return`${r}/group_user?q=${n[1]}&type=about`;const s=/^\/(.*?)\/gallery(\/$|$)$/.exec(e.pathname);return s?`${r}/group_user?q=${s[1]}&type=gallery`:`${r}${e.pathname}${e.search}`}case"ytify":{if(e.pathname.startsWith("/watch"))return`${r}/?s=${encodeURIComponent(e.searchParams.get("v"))}`;const t=/\/channel\/([^\/]+)/.exec(e.pathname);return t?`${r}/list?channel=${t[1]}`:e.pathname.startsWith("/playlist")?`${r}/list?playlists=${encodeURIComponent(e.searchParams.get("list"))}`:`${r}${e.pathname}${e.search}`}case"koub":if(e.pathname.startsWith("/view/")||e.pathname.startsWith("/stories/"))return`${r}${e.pathname}${e.search}`;if(/^\/([^\/]+)\/?$/.exec(e.pathname))return`${r}/account${e.pathname}${e.search}`;case"piped":case"pipedMaterial":case"cloudtube":case"lightTube":case"viewtube":e.searchParams.delete("si");default:return`${r}${e.pathname}${e.search}`}}(e,n,o,c)}}async function ge(e){let t=await le.getOptions(),n=await le.getConfig();for(const r in n.services){let s=t[r].frontend;if(null!=t[s]&&(!(t[s].findIndex((t=>e.href.startsWith(t)))<0)||e.href.startsWith(`http://${s}.localhost:8080`)))switch(r){case"youtube":case"imdb":case"imgur":case"tiktok":case"reddit":case"imdb":case"snopes":case"urbanDictionary":case"quora":case"twitter":case"medium":return`${n.services[r].url}${e.pathname}${e.search}`;case"fandom":{let t=e.pathname.match(/^\/([a-zA-Z0-9-]+)\/wiki\/(.*)/);return t?`https://${t[1]}.fandom.com/wiki/${t[2]}`:void 0}case"wikipedia":{const t=e.searchParams.get("lang");return null!=t?`https://${t}.wikipedia.org${e.pathname}${e.search}${e.hash}`:`https://wikipedia.org${e.pathname}${e.search}${e.hash}`}case"stackOverflow":if(e.pathname.startsWith("/questions/"))return`https://stackoverflow.com${e.pathname}${e.search}`;if(e.pathname.startsWith("/exchange/")){const t=/\/exchange\/(.*?)(\/.*)/.exec(e.pathname);if(t)return`https://${t[1]}.stackexchange.com${t[2]}`}return;case"tekstowo":return`${n.services[r].url}/${e.search.slice(1)}`;case"goodreads":return`https://goodreads.com${e.pathname}${e.search}`;default:return}}}window.browser=window.browser||window.chrome,pe(),browser.storage.onChanged.addListener(pe);const we={materialious:["https://app.materialio.us"],viewtube:["https://viewtube.io"],piped:["https://pipedapi-libre.kavin.rocks"],pipedMaterial:["https://piped-material.xn--17b.net"],cloudtube:["https://tube.cadence.moe"],lightTube:["https://tube.kuylar.dev"],poketube:["https://poketube.fun"],proxiTok:["https://proxitok.pabloferreiro.es"],redlib:["https://safereddit.com"],eddrit:["https://eddrit.com"],scribe:["https://scribe.rip"],libMedium:["https://md.vern.cc"],quetre:["https://quetre.iket.me"],libremdb:["https://libremdb.iket.me"],simplyTranslate:["https://simplytranslate.org"],translite:["https://tl.bloat.cat"],mozhi:["https://mozhi.aryak.me"],searxng:["https://search.bus-hit.me"],"4get":["https://4get.ca"],rimgo:["https://rimgo.vern.cc"],hyperpipe:["https://hyperpipe.surge.sh"],osm:["https://www.openstreetmap.org"],breezeWiki:["https://breezewiki.com"],neuters:["https://neuters.de"],dumb:["https://dm.vern.cc"],intellectual:["https://intellectual.insprill.net"],ruralDictionary:["https://rd.vern.cc"],anonymousOverflow:["https://code.whatever.social"],suds:["https://sd.vern.cc"],unfunny:["https://uf.vern.cc"],soprano:["https://sp.vern.cc"],meme:["https://mm.vern.cc"],waybackClassic:["https://wayback-classic.net"],tent:["https://tent.sny.sh"],wolfreeAlpha:["https://gqq.gitlab.io","https://uqq.gitlab.io"],laboratory:["https://lab.vern.cc"],binternet:["https://bn.bloat.cat"],pixivFe:["https://pixivfe.exozy.me"],liteXiv:["https://litexiv.exozy.me"],indestructables:["https://indestructables.private.coffee"],destructables:["https://ds.vern.cc"],safetwitch:["https://safetwitch.drgns.space"],twineo:["https://twineo.exozy.me"],proxigram:["https://ig.opnxng.com"],tuboYoutube:["https://tubo.migalmoreno.com"],tuboSoundcloud:["https://tubo.migalmoreno.com"],tekstoLibre:["https://davilarek.github.io/TekstoLibre"],skyview:["https://skyview.social"],priviblur:["https://pb.bloat.cat"],nitter:["https://nitter.privacydev.net"],pasted:["https://pasted.drakeerv.com"],freetar:["https://freetar.de"],ratAintTieba:["https://rat.fis.land"],shoelace:["https://shoelace.mint.lgbt"],skunkyArt:["https://skunky.bloat.cat"],ytify:["https://ytify.netlify.app"],nerdsForNerds:["https://nn.vern.cc"],koub:["https://koub.clovius.club"]};async function be(){let e=await le.getConfig(),t={};for(const n in e.services){t[n]={};for(const r in e.services[n].options)t[n][r]=e.services[n].options[r];for(const r in e.services[n].frontends)e.services[n].frontends[r].instanceList&&(t[r]=[])}return t.exceptions={url:[],regex:[]},t.theme="detect",t.popupServices=["youtube","tiktok","imgur","reddit","quora","translate","maps"],t.fetchInstances="github",t.redirectOnlyInIncognito=!1,t={...t,...we},t}var ve={redirect:fe,redirectAsync:async function(e,t,n,r,s,a){return await pe(),fe(e,t,n,r,s,a)},computeServiceFrontend:async function(e){const t=await le.getConfig(),n=await le.getOptions();for(const r in t.services){if(de(r,e,t,n))return{service:r,frontend:null};for(const s in t.services[r].frontends){const a=me(r,s,n,t).findIndex((t=>e.href.startsWith(t)));if(a>=0)return{service:r,frontend:s}}}},reverse:ge,initDefaults:function(){return new Promise((e=>{browser.storage.local.clear((async()=>{$e=await be(),browser.storage.local.set({options:$e},(()=>e()))}))}))},processUpdate:function(e){return new Promise((async t=>{const n=await le.getConfig();let r=e??await le.getOptions();const s=await be();for(const e in r)if(e in s){if("object"==typeof e&&null!==e)for(const t in r[e])t in s[e]||delete r[e][t]}else delete r[e];r.popupServices=r.popupServices.filter((e=>e in n.services));for(const[e,t]of Object.entries(s))e in r||(r[e]=t);for(const[e,t]of Object.entries(n.services)){r[e].frontend in t.frontends||(r[e]=t.options);for(const n in t.options)n in r[e]||(r[e][n]=t.options[n])}browser.storage.local.clear((()=>{browser.storage.local.set({options:r},(()=>{t(r)}))}))}))},copyRaw:async function(e){const t=await ge(e);if(t)if(ue){var n=document.createElement("textarea");n.textContent=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),n.blur(),document.body.removeChild(n)}else navigator.clipboard.writeText(t)},switchInstance:function(e,t){return new Promise((async n=>{let r=await le.getOptions(),s=await le.getConfig();if(le.protocolHost(e),t){const s=r[r[t].frontend];if(void 0!==s){const t=le.getNextInstance(e.origin,s);if(t)return n(`${t}${e.pathname}${e.search}`)}}else for(const t in s.services){let s=r[r[t].frontend];if(void 0===s)continue;const a=s.findIndex((t=>e.href.startsWith(t)));if(a<0)continue;if(s.splice(a,1),0===s.length)return n();const c=le.getNextInstance(e.origin,s);if(c)return n(`${c}${e.pathname}${e.search}`)}n()}))},isException:function(e){if(!$e)return!1;if(!$e.exceptions)return!1;let t=$e.exceptions;if(t&&e){if(t.url)for(let n of t.url)if(n=new URL(n),n=n.href.replace(/^http:\/\//,"https://"),n==e.href)return!0;if(t.regex)for(const n of t.regex)if(new RegExp(n).test(e.href))return!0}return!1}};function xe(e){let n,r,s,a;const c=e[2].default,o=l(c,e,e[1],null);let i=[e[0]],u={};for(let e=0;e<i.length;e+=1)u=t(u,i[e]);return{c(){n=b("div"),o&&o.c(),C(n,u),M(n,"svelte-j9pcac",!0)},m(t,c){g(t,n,c),o&&o.m(n,null),r=!0,s||(a=P(n,"click",e[3]),s=!0)},p(e,[t]){o&&o.p&&(!r||2&t)&&$(o,c,e,e[1],r?h(c,e[1],t,null):p(e[1]),null),C(n,u=V(i,[1&t&&e[0]])),M(n,"svelte-j9pcac",!0)},i(e){r||(X(o,e),r=!0)},o(e){F(o,e),r=!1},d(e){e&&w(n),o&&o.d(e),s=!1,a()}}}function ye(e,n,r){let{$$slots:s={},$$scope:a}=n;return e.$$set=e=>{r(0,n=t(t({},n),m(e))),"$$scope"in e&&r(1,a=e.$$scope)},[n=m(n),a,s,function(t){O.call(this,e,t)}]}class ke extends se{constructor(e){super(),re(this,e,ye,xe,c,{})}}function Pe(e){let n,r;const s=e[2].default,a=l(s,e,e[1],null);let c=[e[0]],o={};for(let e=0;e<c.length;e+=1)o=t(o,c[e]);return{c(){n=b("span"),a&&a.c(),C(n,o),M(n,"svelte-1auan3b",!0)},m(e,t){g(e,n,t),a&&a.m(n,null),r=!0},p(e,[t]){a&&a.p&&(!r||2&t)&&$(a,s,e,e[1],r?h(s,e[1],t,null):p(e[1]),null),C(n,o=V(c,[1&t&&e[0]])),M(n,"svelte-1auan3b",!0)},i(e){r||(X(a,e),r=!0)},o(e){F(a,e),r=!1},d(e){e&&w(n),a&&a.d(e)}}}function qe(e,n,r){const s=[];let a=d(n,s),{$$slots:c={},$$scope:o}=n;return e.$$set=e=>{n=t(t({},n),m(e)),r(0,a=d(n,s)),"$$scope"in e&&r(1,o=e.$$scope)},[a,o,c]}class Ie extends se{constructor(e){super(),re(this,e,qe,Pe,c,{})}}function Ce(t){let n,r;return{c(){n=v("svg"),r=v("path"),q(r,"d","M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"),q(n,"xmlns","http://www.w3.org/2000/svg"),q(n,"height","24px"),q(n,"width","24px"),q(n,"viewBox","0 0 24 24"),q(n,"preserveAspectRatio","xMinYMin meet"),q(n,"fill","currentColor")},m(e,t){g(e,n,t),f(n,r)},p:e,i:e,o:e,d(e){e&&w(n)}}}class _e extends se{constructor(e){super(),re(this,e,null,Ce,c,{})}}function Me(t){let n,r;return{c(){n=v("svg"),r=v("path"),q(r,"d","M 17,20 V 11 Q 17,10.175 16.412,9.587 15.825,9 15,9 H 6.8 L 8.4,7.4 7,6 3,10 7,14 8.4,12.6 6.8,11 H 15 v 9 z"),q(r,"id","path2"),q(n,"xmlns","http://www.w3.org/2000/svg"),q(n,"height","24px"),q(n,"width","24px"),q(n,"viewBox","0 0 24 24"),q(n,"preserveAspectRatio","xMinYMin meet"),q(n,"fill","currentColor")},m(e,t){g(e,n,t),f(n,r)},p:e,i:e,o:e,d(e){e&&w(n)}}}class We extends se{constructor(e){super(),re(this,e,null,Me,c,{})}}function Re(t){let n,r;return{c(){n=v("svg"),r=v("path"),q(r,"d","M7 20v-9q0-.825.588-1.413Q8.175 9 9 9h8.2l-1.6-1.6L17 6l4 4-4 4-1.4-1.4 1.6-1.6H9v9Z"),q(n,"xmlns","http://www.w3.org/2000/svg"),q(n,"height","24px"),q(n,"width","24px"),q(n,"viewBox","0 0 24 24"),q(n,"preserveAspectRatio","xMinYMin meet"),q(n,"fill","currentColor")},m(e,t){g(e,n,t),f(n,r)},p:e,i:e,o:e,d(e){e&&w(n)}}}class Le extends se{constructor(e){super(),re(this,e,null,Re,c,{})}}function Te(n){let r,a,c,o,i=[n[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"24px"},{width:"24px"},{viewBox:"0 0 24 24"},{preserveAspectRatio:"xMinYMin meet"},{fill:"currentColor"}],l={};for(let e=0;e<i.length;e+=1)l=t(l,i[e]);return{c(){r=v("svg"),a=v("path"),q(a,"d","M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"),_(r,l)},m(e,t){g(e,r,t),f(r,a),c||(o=[P(r,"click",n[1]),P(r,"keydown",null)],c=!0)},p(e,[t]){_(r,l=V(i,[1&t&&e[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"24px"},{width:"24px"},{viewBox:"0 0 24 24"},{preserveAspectRatio:"xMinYMin meet"},{fill:"currentColor"}]))},i:e,o:e,d(e){e&&w(r),c=!1,s(o)}}}function Oe(e,n,r){const s=[];let a=d(n,s);return e.$$set=e=>{n=t(t({},n),m(e)),r(0,a=d(n,s))},[a,function(t){O.call(this,e,t)}]}class ze extends se{constructor(e){super(),re(this,e,Oe,Te,c,{})}}function Se(n){let r,a,c,o,i=[n[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"24px"},{width:"24px"},{viewBox:"0 0 24 24"},{preserveAspectRatio:"xMinYMin meet"},{fill:"currentColor"}],l={};for(let e=0;e<i.length;e+=1)l=t(l,i[e]);return{c(){r=v("svg"),a=v("path"),q(a,"d","m9.25 22-.4-3.2q-.325-.125-.612-.3-.288-.175-.563-.375L4.7 19.375l-2.75-4.75 2.575-1.95Q4.5 12.5 4.5 12.337v-.675q0-.162.025-.337L1.95 9.375l2.75-4.75 2.975 1.25q.275-.2.575-.375.3-.175.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3.287.175.562.375l2.975-1.25 2.75 4.75-2.575 1.95q.025.175.025.337v.675q0 .163-.05.338l2.575 1.95-2.75 4.75-2.95-1.25q-.275.2-.575.375-.3.175-.6.3l-.4 3.2Zm2.8-6.5q1.45 0 2.475-1.025Q15.55 13.45 15.55 12q0-1.45-1.025-2.475Q13.5 8.5 12.05 8.5q-1.475 0-2.488 1.025Q8.55 10.55 8.55 12q0 1.45 1.012 2.475Q10.575 15.5 12.05 15.5Z"),_(r,l)},m(e,t){g(e,r,t),f(r,a),c||(o=[P(r,"click",n[1]),P(r,"keydown",null)],c=!0)},p(e,[t]){_(r,l=V(i,[1&t&&e[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"24px"},{width:"24px"},{viewBox:"0 0 24 24"},{preserveAspectRatio:"xMinYMin meet"},{fill:"currentColor"}]))},i:e,o:e,d(e){e&&w(r),c=!1,s(o)}}}function Ae(e,n,r){const s=[];let a=d(n,s);return e.$$set=e=>{n=t(t({},n),m(e)),r(0,a=d(n,s))},[a,function(t){O.call(this,e,t)}]}class Ee extends se{constructor(e){super(),re(this,e,Ae,Se,c,{})}}const Ue=[];function Ne(t,n=e){let r;const s=new Set;function a(e){if(c(t,e)&&(t=e,r)){const e=!Ue.length;for(const e of s)e[1](),Ue.push(e,t);if(e){for(let e=0;e<Ue.length;e+=2)Ue[e][0](Ue[e+1]);Ue.length=0}}}return{set:a,update:function(e){a(e(t))},subscribe:function(c,o=e){const i=[c,o];return s.add(i),1===s.size&&(r=n(a)||e),c(t),()=>{s.delete(i),0===s.size&&r&&(r(),r=null)}}}}const je=Ne(null),Be=Ne(null),He=Ne("general");function Ze(n){let r,c,o,i,l=[{class:c=document.body.dir},n[2],{type:"checkbox"}],u={};for(let e=0;e<l.length;e+=1)u=t(u,l[e]);return{c(){r=b("input"),C(r,u),M(r,"svelte-1i76whx",!0)},m(e,t){g(e,r,t),r.autofocus&&r.focus(),r.checked=n[0],o||(i=[P(r,"change",n[3]),P(r,"change",(function(){a(n[1])&&n[1].apply(this,arguments)}))],o=!0)},p(e,[t]){n=e,C(r,u=V(l,[{class:c},4&t&&n[2],{type:"checkbox"}])),1&t&&(r.checked=n[0]),M(r,"svelte-1i76whx",!0)},i:e,o:e,d(e){e&&w(r),o=!1,s(i)}}}function De(e,n,r){const s=["checked","onChange"];let a=d(n,s),{checked:c}=n,{onChange:o}=n;return e.$$set=e=>{n=t(t({},n),m(e)),r(2,a=d(n,s)),"checked"in e&&r(0,c=e.checked),"onChange"in e&&r(1,o=e.onChange)},[c,o,a,function(){c=this.checked,r(0,c)}]}class Qe extends se{constructor(e){super(),re(this,e,De,Ze,c,{checked:0,onChange:1})}}function Ye(e){let t;function n(e,t){return"svgMono"==e[2]?Ke:Ge}let r=n(e),s=r(e);return{c(){s.c(),t=k()},m(e,n){s.m(e,n),g(e,t,n)},p(e,a){r===(r=n(e))&&s?s.p(e,a):(s.d(1),s=r(e),s&&(s.c(),s.m(t.parentNode,t)))},d(e){s.d(e),e&&w(t)}}}function Ge(e){let t,n,r;return{c(){t=b("img"),i(t.src,n=`/assets/images/${e[0].value}-icon.${e[2]}`)||q(t,"src",n),q(t,"alt",r=e[0].label)},m(e,n){g(e,t,n)},p(e,s){5&s&&!i(t.src,n=`/assets/images/${e[0].value}-icon.${e[2]}`)&&q(t,"src",n),1&s&&r!==(r=e[0].label)&&q(t,"alt",r)},d(e){e&&w(t)}}}function Ke(e){let t;function n(e,t){return"dark"==e[1]?Fe:Xe}let r=n(e),s=r(e);return{c(){s.c(),t=k()},m(e,n){s.m(e,n),g(e,t,n)},p(e,a){r===(r=n(e))&&s?s.p(e,a):(s.d(1),s=r(e),s&&(s.c(),s.m(t.parentNode,t)))},d(e){s.d(e),e&&w(t)}}}function Xe(e){let t,n,r;return{c(){t=b("img"),i(t.src,n=`/assets/images/${e[0].value}-icon.svg`)||q(t,"src",n),q(t,"alt",r=e[0].label)},m(e,n){g(e,t,n)},p(e,s){1&s&&!i(t.src,n=`/assets/images/${e[0].value}-icon.svg`)&&q(t,"src",n),1&s&&r!==(r=e[0].label)&&q(t,"alt",r)},d(e){e&&w(t)}}}function Fe(e){let t,n,r;return{c(){t=b("img"),i(t.src,n=`/assets/images/${e[0].value}-icon-light.svg`)||q(t,"src",n),q(t,"alt",r=e[0].label)},m(e,n){g(e,t,n)},p(e,s){1&s&&!i(t.src,n=`/assets/images/${e[0].value}-icon-light.svg`)&&q(t,"src",n),1&s&&r!==(r=e[0].label)&&q(t,"alt",r)},d(e){e&&w(t)}}}function Ve(t){let n,r=t[2]&&Ye(t);return{c(){r&&r.c(),n=k()},m(e,t){r&&r.m(e,t),g(e,n,t)},p(e,[t]){e[2]?r?r.p(e,t):(r=Ye(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:e,o:e,d(e){r&&r.d(e),e&&w(n)}}}function Je(e,t,n){let r,s,a,{details:c}=t;const o=je.subscribe((e=>n(3,s=e))),i=Be.subscribe((e=>n(4,a=e)));let l;return T((()=>{o(),i()})),e.$$set=e=>{"details"in e&&n(0,c=e.details)},e.$$.update=()=>{8&e.$$.dirty&&s&&("dark"==s.theme?n(1,l="dark"):"light"==s.theme?n(1,l="light"):window.matchMedia("(prefers-color-scheme: dark)").matches?n(1,l="dark"):n(1,l="light")),17&e.$$.dirty&&n(2,r=a.services[c.value].imageType)},[c,l,r,s,a]}class et extends se{constructor(e){super(),re(this,e,Je,Ve,c,{details:0})}}function tt(e){let t,n=e[3].services[e[0]].name+"";return{c(){t=x(n)},m(e,n){g(e,t,n)},p(e,r){9&r&&n!==(n=e[3].services[e[0]].name+"")&&function(e,t){t=""+t,e.data!==t&&(e.data=t)}(t,n)},d(e){e&&w(t)}}}function nt(e){let t,n,r,a,c,o,i,l,u,h,$,p,m,d;return n=new et({props:{details:{value:e[0],label:e[3].services[e[0]].name}}}),a=new Ie({props:{$$slots:{default:[tt]},$$scope:{ctx:e}}}),i=new Qe({props:{class:"margin margin_"+document.body.dir,label:"Enable",checked:e[2][e[0]].enabled,onChange:e[6]}}),u=new ze({props:{class:"interactive"}}),u.$on("click",e[7]),$=new Ee({props:{class:"interactive"}}),$.$on("click",e[8]),{c(){t=b("div"),J(n.$$.fragment),r=y(),J(a.$$.fragment),c=y(),o=b("div"),J(i.$$.fragment),l=y(),J(u.$$.fragment),h=y(),J($.$$.fragment),q(t,"class","interactive margin margin_"+document.body.dir+" svelte-q238x3"),q(o,"class","svelte-q238x3")},m(s,w){g(s,t,w),ee(n,t,null),f(t,r),ee(a,t,null),g(s,c,w),g(s,o,w),ee(i,o,null),f(o,l),ee(u,o,null),f(o,h),ee($,o,null),p=!0,m||(d=[P(t,"keydown",null),P(t,"click",e[5])],m=!0)},p(e,t){const r={};9&t&&(r.details={value:e[0],label:e[3].services[e[0]].name}),n.$set(r);const s={};2057&t&&(s.$$scope={dirty:t,ctx:e}),a.$set(s);const c={};5&t&&(c.checked=e[2][e[0]].enabled),5&t&&(c.onChange=e[6]),i.$set(c)},i(e){p||(X(n.$$.fragment,e),X(a.$$.fragment,e),X(i.$$.fragment,e),X(u.$$.fragment,e),X($.$$.fragment,e),p=!0)},o(e){F(n.$$.fragment,e),F(a.$$.fragment,e),F(i.$$.fragment,e),F(u.$$.fragment,e),F($.$$.fragment,e),p=!1},d(e){e&&w(t),te(n),te(a),e&&w(c),e&&w(o),te(i),te(u),te($),m=!1,s(d)}}}function rt(e){let t,n;return t=new ke({props:{$$slots:{default:[nt]},$$scope:{ctx:e}}}),{c(){J(t.$$.fragment)},m(e,r){ee(t,e,r),n=!0},p(e,[n]){const r={};2063&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(X(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function st(e,t,n){const r=window.browser||window.chrome;let s,a;const c=je.subscribe((e=>n(2,s=e))),o=Be.subscribe((e=>n(3,a=e)));T((()=>{c(),o()}));let{serviceKey:i}=t,{url:l}=t;return e.$$set=e=>{"serviceKey"in e&&n(0,i=e.serviceKey),"url"in e&&n(1,l=e.url)},[i,l,s,a,r,()=>r.tabs.create({url:a.services[i].url},(()=>{window.close()})),e=>{n(2,s[i].enabled=e.target.checked,s),je.set(s)},async()=>r.tabs.update({url:await ve.switchInstance(l,i)},(()=>{window.close()})),()=>r.tabs.create({url:r.runtime.getURL(`pages/options/index.html#services:${i}`)},(()=>{window.close()}))]}class at extends se{constructor(e){super(),re(this,e,st,rt,c,{serviceKey:0,url:1})}}function ct(n){let r,s,a=[n[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"20px"},{viewBox:"0 -960 960 960"},{width:"20px"},{fill:"currentColor"}],c={};for(let e=0;e<a.length;e+=1)c=t(c,a[e]);return{c(){r=v("svg"),s=v("path"),q(s,"d","M144-144v-178l342-342-54-53 51-51 72 72 110.22-110.22q4.45-4.45 11.11-7.11Q683-816 691-816t15 2.5q7 2.5 12 7.5l87 88q4.55 5.83 7.27 12.64 2.73 6.8 2.73 14.58t-2.66 14.44q-2.67 6.66-7.11 11.1L696-556l72 73-51 51-54-54-341 342H144Zm72-72h76l320-320-75-76-321 320v76Zm424-385 90-91-38-39-91 90 39 40Zm0 0-39-40 39 40Z"),_(r,c)},m(e,t){g(e,r,t),f(r,s)},p(e,[t]){_(r,c=V(a,[1&t&&e[0],{xmlns:"http://www.w3.org/2000/svg"},{height:"20px"},{viewBox:"0 -960 960 960"},{width:"20px"},{fill:"currentColor"}]))},i:e,o:e,d(e){e&&w(r)}}}function ot(e,n,r){const s=[];let a=d(n,s);return e.$$set=e=>{n=t(t({},n),m(e)),r(0,a=d(n,s))},[a]}class it extends se{constructor(e){super(),re(this,e,ot,ct,c,{})}}function lt(e,t,n){const r=e.slice();return r[21]=t[n],r}function ut(e){let t,n;return t=new ke({props:{class:"interactive",$$slots:{default:[$t]},$$scope:{ctx:e}}}),t.$on("click",e[10]),{c(){J(t.$$.fragment)},m(e,r){ee(t,e,r),n=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(X(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function ht(t){let n,r=(t[8].i18n.getMessage("redirect")||"Redirect")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function $t(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[ht]},$$scope:{ctx:e}}}),r=new Le({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function pt(e){let t,n,r,s;const a=[dt,mt],c=[];function o(e,t){return e[0][e[5]].length>1?0:1}return t=o(e),n=c[t]=a[t](e),{c(){n.c(),r=k()},m(e,n){c[t].m(e,n),g(e,r,n),s=!0},p(e,s){let i=t;t=o(e),t===i?c[t].p(e,s):(G(),F(c[i],1,1,(()=>{c[i]=null})),K(),n=c[t],n?n.p(e,s):(n=c[t]=a[t](e),n.c()),X(n,1),n.m(r.parentNode,r))},i(e){s||(X(n),s=!0)},o(e){F(n),s=!1},d(e){c[t].d(e),e&&w(r)}}}function mt(e){let t,n,r,s;return t=new ke({props:{class:"interactive "+(e[7]?"disabled":""),$$slots:{default:[gt]},$$scope:{ctx:e}}}),t.$on("click",e[13]),r=new ke({props:{class:"interactive "+(e[7]?"disabled":""),$$slots:{default:[bt]},$$scope:{ctx:e}}}),r.$on("click",e[14]),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const s={};128&n&&(s.class="interactive "+(e[7]?"disabled":"")),16777216&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const a={};128&n&&(a.class="interactive "+(e[7]?"disabled":"")),16777216&n&&(a.$$scope={dirty:n,ctx:e}),r.$set(a)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function dt(e){let t,n,r,s=e[2]&&vt(e);return n=new ke({props:{class:"interactive",$$slots:{default:[Pt]},$$scope:{ctx:e}}}),n.$on("click",e[12]),{c(){s&&s.c(),t=y(),J(n.$$.fragment)},m(e,a){s&&s.m(e,a),g(e,t,a),ee(n,e,a),r=!0},p(e,r){e[2]?s?(s.p(e,r),4&r&&X(s,1)):(s=vt(e),s.c(),X(s,1),s.m(t.parentNode,t)):s&&(G(),F(s,1,1,(()=>{s=null})),K());const a={};16777216&r&&(a.$$scope={dirty:r,ctx:e}),n.$set(a)},i(e){r||(X(s),X(n.$$.fragment,e),r=!0)},o(e){F(s),F(n.$$.fragment,e),r=!1},d(e){s&&s.d(e),e&&w(t),te(n,e)}}}function ft(t){let n,r,s,a=(t[8].i18n.getMessage("remove")||"Remove")+"",c=(t[8].i18n.getMessage("autoPickInstance")||"Auto Pick Instance")+"";return{c(){n=x(a),r=x("\n          +\n          "),s=x(c)},m(e,t){g(e,n,t),g(e,r,t),g(e,s,t)},p:e,d(e){e&&w(n),e&&w(r),e&&w(s)}}}function gt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[ft]},$$scope:{ctx:e}}}),r=new it({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function wt(t){let n,r=(t[8].i18n.getMessage("autoPickInstance")||"Auto Pick Instance")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function bt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[wt]},$$scope:{ctx:e}}}),r=new it({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function vt(e){let t,n;return t=new ke({props:{class:"interactive",$$slots:{default:[yt]},$$scope:{ctx:e}}}),t.$on("click",e[11]),{c(){J(t.$$.fragment)},m(e,r){ee(t,e,r),n=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(X(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function xt(t){let n,r=(t[8].i18n.getMessage("switchInstance")||"Switch Instance")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function yt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[xt]},$$scope:{ctx:e}}}),r=new ze({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function kt(t){let n,r,s,a=(t[8].i18n.getMessage("remove")||"Remove")+"",c=(t[8].i18n.getMessage("switchInstance")||"Switch Instance")+"";return{c(){n=x(a),r=x("\n          +\n          "),s=x(c)},m(e,t){g(e,n,t),g(e,r,t),g(e,s,t)},p:e,d(e){e&&w(n),e&&w(r),e&&w(s)}}}function Pt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[kt]},$$scope:{ctx:e}}}),r=new ze({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function qt(e){let t,n,r,s;return t=new ke({props:{class:"interactive",$$slots:{default:[Ct]},$$scope:{ctx:e}}}),t.$on("click",e[15]),r=new ke({props:{class:"interactive",$$slots:{default:[Mt]},$$scope:{ctx:e}}}),r.$on("click",e[16]),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const s={};16777216&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const a={};16777216&n&&(a.$$scope={dirty:n,ctx:e}),r.$set(a)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function It(t){let n,r=(t[8].i18n.getMessage("copyOriginal")||"Copy Original")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function Ct(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[It]},$$scope:{ctx:e}}}),r=new _e({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function _t(t){let n,r=t[8].i18n.getMessage("redirectToOriginal")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function Mt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[_t]},$$scope:{ctx:e}}}),r=new We({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function Wt(e){let t;return{c(){t=b("hr")},m(e,n){g(e,t,n)},d(e){e&&w(t)}}}function Rt(e){let t,n,r,s;return t=new at({props:{serviceKey:e[6],url:e[1]}}),{c(){J(t.$$.fragment),n=y(),r=b("hr")},m(e,a){ee(t,e,a),g(e,n,a),g(e,r,a),s=!0},p(e,n){const r={};64&n&&(r.serviceKey=e[6]),2&n&&(r.url=e[1]),t.$set(r)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),e&&w(r)}}}function Lt(e){let t,n;return t=new at({props:{serviceKey:e[21],url:e[1]}}),{c(){J(t.$$.fragment)},m(e,r){ee(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.serviceKey=e[21]),2&n&&(r.url=e[1]),t.$set(r)},i(e){n||(X(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Tt(e){let t,n,r=e[6]!==e[21]&&Lt(e);return{c(){r&&r.c(),t=k()},m(e,s){r&&r.m(e,s),g(e,t,s),n=!0},p(e,n){e[6]!==e[21]?r?(r.p(e,n),65&n&&X(r,1)):(r=Lt(e),r.c(),X(r,1),r.m(t.parentNode,t)):r&&(G(),F(r,1,1,(()=>{r=null})),K())},i(e){n||(X(r),n=!0)},o(e){F(r),n=!1},d(e){r&&r.d(e),e&&w(t)}}}function Ot(t){let n,r=t[8].i18n.getMessage("settings")+"";return{c(){n=x(r)},m(e,t){g(e,n,t)},p:e,d(e){e&&w(n)}}}function zt(e){let t,n,r,s;return t=new Ie({props:{class:"margin",$$slots:{default:[Ot]},$$scope:{ctx:e}}}),r=new Ee({}),{c(){J(t.$$.fragment),n=y(),J(r.$$.fragment)},m(e,a){ee(t,e,a),g(e,n,a),ee(r,e,a),s=!0},p(e,n){const r={};16777216&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){s||(X(t.$$.fragment,e),X(r.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),s=!1},d(e){te(t,e),e&&w(n),te(r,e)}}}function St(e){let t,n,r,s,a,c,o,i,l,u,h,$=e[4]&&ut(e),p=e[6]&&e[5]&&pt(e),m=e[3]&&qt(e),d=(e[4]||e[2]||e[3])&&Wt(),v=e[6]&&Rt(e),x=e[0].popupServices,k=[];for(let t=0;t<x.length;t+=1)k[t]=Tt(lt(e,x,t));const P=e=>F(k[e],1,1,(()=>{k[e]=null}));return u=new ke({props:{class:"interactive",$$slots:{default:[zt]},$$scope:{ctx:e}}}),u.$on("click",e[17]),{c(){t=b("div"),$&&$.c(),n=y(),p&&p.c(),r=y(),m&&m.c(),s=y(),d&&d.c(),a=y(),v&&v.c(),c=y();for(let e=0;e<k.length;e+=1)k[e].c();o=y(),i=b("hr"),l=y(),J(u.$$.fragment),q(t,"class",document.body.dir)},m(e,w){g(e,t,w),$&&$.m(t,null),f(t,n),p&&p.m(t,null),f(t,r),m&&m.m(t,null),f(t,s),d&&d.m(t,null),f(t,a),v&&v.m(t,null),f(t,c);for(let e=0;e<k.length;e+=1)k[e]&&k[e].m(t,null);f(t,o),f(t,i),f(t,l),ee(u,t,null),h=!0},p(e,[i]){if(e[4]?$?($.p(e,i),16&i&&X($,1)):($=ut(e),$.c(),X($,1),$.m(t,n)):$&&(G(),F($,1,1,(()=>{$=null})),K()),e[6]&&e[5]?p?(p.p(e,i),96&i&&X(p,1)):(p=pt(e),p.c(),X(p,1),p.m(t,r)):p&&(G(),F(p,1,1,(()=>{p=null})),K()),e[3]?m?(m.p(e,i),8&i&&X(m,1)):(m=qt(e),m.c(),X(m,1),m.m(t,s)):m&&(G(),F(m,1,1,(()=>{m=null})),K()),e[4]||e[2]||e[3]?d||(d=Wt(),d.c(),d.m(t,a)):d&&(d.d(1),d=null),e[6]?v?(v.p(e,i),64&i&&X(v,1)):(v=Rt(e),v.c(),X(v,1),v.m(t,c)):v&&(G(),F(v,1,1,(()=>{v=null})),K()),67&i){let n;for(x=e[0].popupServices,n=0;n<x.length;n+=1){const r=lt(e,x,n);k[n]?(k[n].p(r,i),X(k[n],1)):(k[n]=Tt(r),k[n].c(),X(k[n],1),k[n].m(t,o))}for(G(),n=x.length;n<k.length;n+=1)P(n);K()}const l={};16777216&i&&(l.$$scope={dirty:i,ctx:e}),u.$set(l)},i(e){if(!h){X($),X(p),X(m),X(v);for(let e=0;e<x.length;e+=1)X(k[e]);X(u.$$.fragment,e),h=!0}},o(e){F($),F(p),F(m),F(v),k=k.filter(Boolean);for(let e=0;e<k.length;e+=1)F(k[e]);F(u.$$.fragment,e),h=!1},d(e){e&&w(t),$&&$.d(),p&&p.d(),m&&m.d(),d&&d.d(),v&&v.d(),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(k,e),te(u)}}}function At(e,t,n){const r=window.browser||window.chrome;let s;const a=je.subscribe((e=>n(0,s=e))),c=Be.subscribe((e=>e));let o,i,l,u,h,$;T((()=>{a(),c()})),r.tabs.query({active:!0,currentWindow:!0},(async e=>{e[0].url&&(n(1,o=new URL(e[0].url)),ve.switchInstance(o).then((e=>n(2,i=e))),ve.reverse(o).then((e=>n(3,l=e))),ve.redirectAsync(o,"main_frame",null,null,!1,!0).then((e=>n(4,u=e))),ve.computeServiceFrontend(o).then((e=>n(6,({service:$,frontend:h}=e),$,n(5,h)))))}));let p=!1;async function m(){n(7,p=!0);const e=(await le.getList(s))[h].clearnet,t=await le.autoPickInstance(e,o);s[h].push(t),je.set(s),n(7,p=!1)}return[s,o,i,l,u,h,$,p,r,m,()=>{r.tabs.query({active:!0,currentWindow:!0},(e=>{r.runtime.sendMessage({message:"redirect",tabId:e[0].id},(()=>{r.tabs.update({url:u},(()=>{window.close()}))}))}))},async()=>r.tabs.update({url:i},(()=>{window.close()})),async()=>{const e=s[h].findIndex((e=>o.href.startsWith(e)));s[h].splice(e,1),je.set(s);const t=await ve.switchInstance(o,$);r.tabs.update({url:t},(()=>{window.close()}))},async()=>{const e=s[h].findIndex((e=>o.href.startsWith(e)));s[h].splice(e,1),je.set(s),await m(),r.tabs.update({url:await ve.switchInstance(o,$)},(()=>{window.close()}))},async()=>{await m(),r.tabs.update({url:await ve.switchInstance(o,$)},(()=>{window.close()}))},()=>ve.copyRaw(o),()=>{r.tabs.query({active:!0,currentWindow:!0},(e=>{r.runtime.sendMessage({message:"reverse",tabId:e[0].id},(()=>{r.tabs.update({url:l},(()=>{window.close()}))}))}))},()=>r.tabs.create({url:r.runtime.getURL("pages/options/index.html")},(()=>{window.close()}))]}class Et extends se{constructor(e){super(),re(this,e,At,St,c,{})}}function Ut(t){let n;return{c(){n=b("p"),n.textContent="Loading..."},m(e,t){g(e,n,t)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Nt(e){let t,n,r;return n=new Et({}),{c(){t=b("div"),J(n.$$.fragment),q(t,"class","main svelte-7wrfnp"),q(t,"dir","auto"),q(t,"style",e[2])},m(e,s){g(e,t,s),ee(n,t,null),r=!0},p(e,n){(!r||4&n)&&q(t,"style",e[2])},i(e){r||(X(n.$$.fragment,e),r=!0)},o(e){F(n.$$.fragment,e),r=!1},d(e){e&&w(t),te(n)}}}function jt(e){let t,n,r,s;const a=[Nt,Ut],c=[];function o(e,t){return e[0]&&e[1]?0:1}return t=o(e),n=c[t]=a[t](e),{c(){n.c(),r=k()},m(e,n){c[t].m(e,n),g(e,r,n),s=!0},p(e,[s]){let i=t;t=o(e),t===i?c[t].p(e,s):(G(),F(c[i],1,1,(()=>{c[i]=null})),K(),n=c[t],n?n.p(e,s):(n=c[t]=a[t](e),n.c()),X(n,1),n.m(r.parentNode,r))},i(e){s||(X(n),s=!0)},o(e){F(n),s=!1},d(e){c[t].d(e),e&&w(r)}}}function Bt(e,t,n){const r=window.browser||window.chrome;let s;const a=je.subscribe((e=>{e&&(n(0,s=e),r.storage.local.set({options:e}))}));let c;const o=Be.subscribe((e=>n(1,c=e)));var i;let l;return T((()=>{a(),o()})),i=async()=>{let e=await le.getOptions();e||(await ve.initDefaults(),e=await le.getOptions()),je.set(e),Be.set(await le.getConfig())},L().$$.on_mount.push(i),He.subscribe((e=>e)),e.$$.update=()=>{1&e.$$.dirty&&s&&n(2,l=le.style(s,window))},[s,c,l]}const Ht=new class extends se{constructor(e){super(),re(this,e,Bt,jt,c,{})}}({target:document.body});return Ht}();
//# sourceMappingURL=bundle.js.map
