(()=>{if(void 0===e)var e=chrome;function t(t){let n=t.action;const o=new URLSearchParams;for(const e of new FormData(t))o.append(e[0],e[1]);fetch(n,{method:"POST",headers:{Accept:"application/json"},credentials:"include",redirect:"follow",body:o}).then((e=>e.json())).then((async t=>{for(let n of t.remove)await e.runtime.sendMessage({type:"settings_remove",setting_key:n});return Object.keys(t.set).length>0?e.runtime.sendMessage({type:"settings_set",settings:t.set}).then((e=>t.redirect)):t.redirect})).then((e=>{e&&(!e.match(/#.*/)&&t.id&&(e+="#form.id"),document.location.href=e),document.location.reload()})).catch((e=>{console.log(e)}))}document.querySelectorAll("form").forEach((e=>{e.addEventListener("submit",(n=>{n.preventDefault(),t(e)}))})),document.querySelectorAll("select").forEach((e=>{let n=e.cloneNode(!0);e.parentNode.replaceChild(n,e),n.addEventListener("change",(e=>{t(n.form)}))})),document.querySelectorAll("a").forEach((t=>{t.addEventListener("click",(n=>{try{let o=new URL(t.href);o.pathname.match(/\/(.*\/)?keys\/key\/remove/)&&(n.preventDefault(),e.runtime.sendMessage({type:"settings_remove",setting_key:"key"}).then((()=>{document.location.href=o})))}catch(e){}}))}))})();