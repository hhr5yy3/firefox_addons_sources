var salContent=function(t){var e={};function n(r){if(e[r])return e[r].exports;var _=e[r]={i:r,l:!1,exports:{}};return t[r].call(_.exports,_,_.exports,n),_.l=!0,_.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var _ in t)n.d(r,_,function(e){return t[e]}.bind(null,_));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}({0:function(t,e,n){"use strict";function r(){return-1!=navigator.userAgent.indexOf("Firefox")?browser:chrome}function _(){r().storage.local.get("debug",t=>{t.debug&&console&&console.log&&console.log.apply(this,arguments)})}function o(){console&&console.error&&console.error.apply(this,arguments)}function a(){void 0===a.locale_map&&TMExt_$.ajax({url:getURL("settings.json"),async:!1,dataType:"json",success:function(t){_(t),a.locale_map=t.supportLanguage,a.default_lang=t.defaultLanguage,a.l10n_map=t.l10nFolderMap}});let t=navigator.language,e=!1,n=a.locale_map,r="";for(var o=0;o<n.length;++o)if(n[o].includes(t)){r=n[o],e=!0;break}e||(r=a.default_lang);let s=r;return void 0!==a.l10n_map[r]&&(s=a.l10n_map[r]),s}function s(t,e,n){var _={action:t,params:e};r().runtime.sendMessage(_,n)}async function u(){let t=[];try{const e=await fetch(r().runtime.getURL("PbBankingList.txt"));t=(await e.text()).split("\n")}catch(t){o("getBankingList: e = "+t)}return _("getBankingList: size of banking list = "+t.length),t}function i(t,e,n,r){if(r<n)return-1;if(r-n<=1)return e===t[n]?n:e===t[r]?r:-1;let _=Math.floor((n+r)/2);return t[_]===e?_:t[_]<e?i(t,e,_,r):t[_]>e?i(t,e,n,_):-1}n.r(e),n.d(e,"getBrowser",(function(){return r})),n.d(e,"logInfo",(function(){return _})),n.d(e,"logError",(function(){return o})),n.d(e,"getCurrentLocale",(function(){return a})),n.d(e,"tbc_sendRequest",(function(){return s})),n.d(e,"getBankingList",(function(){return u})),n.d(e,"binarySearch",(function(){return i})),e.default={getBrowser:r,logInfo:_,logError:o,getCurrentLocale:a,tbc_sendRequest:s,getBankingList:u,binarySearch:i,sendMessageToActiveTab:function(t){return new Promise((e,n)=>{const _=r();_.tabs.query({active:!0,currentWindow:!0},r=>{r.length<=0?e(!1):_.tabs.sendMessage(r[0].id,t,()=>{_.runtime.lastError&&n(_.runtime.lastError.message)})})})},sha256:async function(t){let e=(new TextEncoder).encode(t),n=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(n)].map(t=>t.toString(16).padStart(2,"0")).join("")}}},1:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return _})),n.d(e,"c",(function(){return o}));let r={STANDALONE:"Standalone",COEXIST:"Toolbar",PROMOTER:"Promoter"},_=500,o={OPEN_HELP:"tbb_open_help",OPEN_SETTINGS:"tbb_open_settings",PRELOAD:"tbb_pre_load",INJECTRESOURCES:"tbb_inject_resources",RATINGURLS:"tbb_ratingURLS",RATINGSINGLEURL:"tbb_ratingSingleURL",RATINGOUTERSOURCEURLS:"tbb_ratingOuterSourceURLs",RATINGCREATETABS:"tbb_ratingCreatTabs",INSERTRATINGRESULT:"tbc_insertRatingResult",INSERTSINGLERESULT:"tbc_insertSingleRatingResult",FEEDBACK_UNTESTED_URL:"tbc_feedback_untested_url",FEEDBACK_NAVIGATION_DURATION:"tbc_feedback_navigation_duration",OPEN_FBPS_HELP:"tbb_open_fbps_help",FEEDBACK_2_SITESAFETY:"tbb_feedback_2_sitesafety",SEND_MAIL_2_TMPLUGIN_TOOLBAR:"tbb_send_mail_2_tmplugin_toolbar",FORCE_REFRESH_PAGE:"tbb_force_refresh_page",UPDATE_GLOBAL_VARIABLES:"tbb_update_global_variables",SHOW_LOG_COLLECTION_RESULT:"tbb_show_log_collection_result",UPDATE_INIT_STORAGE:"tbc_update_init_storage",OPEN_PAYGURAD:"tbb_open_paygurad",SHOW_PAYGURAD_TUTORIAL:"tbb_show_paygurad_tutorial",PAYGUARD_CHECK_BANKING_LIST:"tbb_paygurad_check_banking_list",SEND_PAYGURAD_UBM:"tbb_send_paygurad_ubm",GET_PRODUCT_SETTINGS:"tbb_get_product_settings",OPEN_LOGIN_PAGE:"tbb_open_login_page",FEED_UBM:"feedbackUBM",SEND_UNTEST_URL_UBM:"send_untested_url_ubm",GET_INFORMATION:"tbb_get_information",GET_FRAUD_BUSTER_SECRET:"tbb_get_fraud_buster_secret",POPUP_IN_TAB:"tbc_popup_in_tab",OPEN_NEW_TAB_WITH_URL:"tbb_open_new_tab_with_url",CAN_FRAUD_BUSTER_WORK:"tbb_can_fraud_buster_work",FRAUD_BUSTER_GET_PRODUCT_INFO:"tbb_getProductInfoForFraudBuster",GET_USER_FRAUD_BUSTER_SETTING:"tbb_getUserFraudBusterSetting",SET_USER_FRAUD_BUSTER_SETTING:"tbb_setUserFraudBusterSetting",GET_FRAUD_BUSTER_IDENTITY:"tbb_getFraudBusterIdentity",ENABLED_FRAUD_BUSTER:"tbb_enabledFraudBuster",DISABLED_FRAUD_BUSTER:"tbb_disabledFraudBuster",WRITE_PRODUCT_EVENT_LOG:"tbb_writeProductEventLog",SEND_UBM:"tbb_sendUBM",UPDATE_PRODUCT_INFO:"tbb_updateProductInfo",NOTIFY_PRODUCT_INFO_CHANGE:"tbb_notifyProductInfoChange",UPDATE_EMAIL_SCANNED_COUNT:"tbb_updateEmailScannedCount",NOTIFY_SIGN_IN:"NOTIFY_SIGN_IN",GET_BANKING_LIST:"tbb_get_banking_list",SAL_SCAN:"tbb_sal_scan",OPEN_TI_WTP_EXCEPTION_PAGE:"openTiWtpExceptionPage",SHOW_NOTIFICSTION:"SHOW_NOTIFICSTION",SHOW_SALBLOCKINGPAGE:"SHOW_SALBLOCKINGPAGE",CLOSE_SALBLOCKINGPAGE:"CLOSE_SALBLOCKINGPAGE",GET_SETTINGS_FROM_TI:"GetSettingsFromTi",PS_LOCAL_PAGE_MESSAGE:"tbb_ps_local_page_message",PS_CONTENT_MESSAGE:"tbb_ps_content_message",PS_CAN_PROMOTE:"tbb_ps_can_promote",PS_GET_PROMOTION_STATUS:"tbb_ps_get_promotion_status",PS_SET_PROMOTION_STATUS:"tbb_ps_set_promotion_status",PS_CHECK_PRIVACY:"tbb_ps_check_privacy",PS_SHOW_PROMOTION_LEARNMORE:"tbb_ps_show_promtion_learn_more",PS_GET_SETTINGS:"tbb_ps_get_settings",PS_SET_SETTINGS:"tbb_ps_set_settings",PS_DATA_COLLECTION:"tbb_ps_data_collection",PS_FEEDBACK_2FA_STATUS:"tbb_ps_feedback_2fa_status",PS_REGISTER_CONTENT_PAGE:"tbb_ps_register_content_page",PS_REGISTER_LOCAL_PAGE:"tbb_ps_register_local_page",PS_OPEN_HELP_PAGE:"tbb_ps_open_help_page",PS_BROWSER_SCAN:"tbb_ps_browser_scan",PS_WEBSITE_SCAN:"tbb_ps_website_scan"}},22:function(t,e,n){"use strict";n.r(e);var r=n(0),_=n(1),o=n(4);const a=r.default.getBrowser(),s=async()=>{let t=await o.a.getStorage({framework_status:!1});if(!t.framework_status)return void setTimeout(()=>{s()},500);if(t=await o.a.getStorage({wtp_sal_status:!1}),r.default.logInfo("[SAL][Content]","storageData = "+JSON.stringify(t)),!t.wtp_sal_status)return void r.default.logInfo("[SAL][Content]","SAL is disabled");if(!document.URL||!document.documentElement.innerHTML)return void r.default.logInfo("[SAL][Content]","no document URL or content");const e=(t,e)=>{a.runtime.sendMessage({action:_.c.SAL_SCAN,params:{params:{url:t,head:"HTTP/1.1 200 OK \n        Server: Response_header/Fake\n        Product: Titanium/17\n        Content-Length: 30000\n        Content-Type: text/html\n        Connection: Keep-alive\n        ",doc:e,time:Math.floor((new Date).getTime()/1e3)}}})};e(document.URL,document.documentElement.innerHTML);const n=t=>{t.addEventListener("load",()=>{t.src&&t.contentDocument&&e(t.src,t.contentDocument.documentElement.innerHTML)})};document.querySelectorAll("iframe").forEach(t=>{n(t)}),new MutationObserver((function(t){t.forEach((function(t){if(t.addedNodes.length)for(var e=0;e<t.addedNodes.length;e++){var r=t.addedNodes[e];"IFRAME"===r.nodeName&&n(r)}}))})).observe(document,{attributes:!1,childList:!0,characterData:!1,subtree:!0})};s()},4:function(t,e,n){"use strict";let r=n(0).getBrowser();function _(t={}){return new Promise(e=>{r.tabs.query(t,t=>e(t))})}var o={setStorage:function(t){return new Promise(e=>{r.storage.local.set(t,()=>{e()})})},getStorage:function(t){return new Promise(e=>{r.storage.local.get(t,t=>{e(t)})})},removeStoreage:function(t){return new Promise(e=>{r.storage.local.remove(t,()=>{e()})})},getSystemStorageInfo:function(){return new Promise(t=>{r.system.storage.getInfo(e=>{t(e)})})},getSystemCpuInfo:function(){return new Promise(t=>{r.system.cpu.getInfo(e=>{t(e)})})},getTabInfo:_,getActiveTab:async function(){return await _({active:!0,lastFocusedWindow:!0})},getCurrentActiveWindowTabId:function(){return new Promise(t=>{const e=n=>{r.tabs.query({active:!0,lastFocusedWindow:!0},(function(_){!r.runtime.lastError&&0!==_.length&&_[0].hasOwnProperty("id")?t({ret:!0,tabId:_[0].id}):++n>=10?t({ret:!1}):setTimeout(()=>{e(n)},500)}))};e(0)})},getTab:function(t){return new Promise(e=>{r.tabs.get(t,t=>{r.runtime.lastError?e(null):e(t)})})}};n.d(e,"a",(function(){return o}))}});