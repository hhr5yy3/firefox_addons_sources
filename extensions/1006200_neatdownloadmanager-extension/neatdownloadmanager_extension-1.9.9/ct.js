var k=chrome.runtime.getURL("img/icon16.png"),x=chrome.runtime.getURL("img/close16.png"),y={"-1":"none",1:""},z={242:"240p",243:"360p",244:"480p",246:"480p",247:"720p",248:"1080p",271:"1440p",272:"2160p",278:"144p",302:"720p-60f",303:"1080p-60f",308:"1440p-60f",313:"2160p",315:"2160p-60f",335:"1080p-60f",336:"1440p-60f",337:"2160p-60f"},A=[171,172,249,250,251];function D(d){return document.getElementById(d)}window.el=D;
function E(){var d=document.location.host.toLowerCase(),g=d.length-12;return 0<=g&&d.indexOf("facebook.com",g)==g}async function F(d){try{const g=await fetch(d["2"],{mode:"no-cors"});if(g.ok){let a=await g.text();(d.ba||function(){})(a)}}catch(g){}}function G(d){var g=0,a;var b=0;for(a=d.length;b<a;b++){var c=d.charCodeAt(b);g=(g<<5)-g+c;g|=0}return g}
function H(d){return!d||0>d?" ":1E3>d?d+" Bytes":1E6>d?(d/1024).toFixed(1)+" KB":1E9>d?(d/1048576).toFixed(2)+" MB":(d/1073741824).toFixed(3)+" GB"}function I(d){return d.replace(/\\u([\d\w]{4})/gi,function(g,a){return String.fromCharCode(parseInt(a,16))})}function J(d){if(!d)return{left:0,top:0};try{var g=d.getBoundingClientRect();return g?{left:Math.round(g.left+window.pageXOffset),top:Math.round(g.top+window.pageYOffset)}:{left:0,top:0}}catch(a){return{left:0,top:0}}}
function N(d){return d?!d.fEx||"VTT"!=d.fEx.toUpperCase()&&"SRT"!=d.fEx.toUpperCase()?d["4"]||(d.fEx.toUpperCase()||"MP4")+" File  "+(H(d.fS)||d.fDu):d.fEx.toUpperCase()+" Subtitles File "+(d.fS?H(d.fS):" "):"Media File"}function O(d,g,a){this.D=d;d.i[a]=this;this.ta=a;this.J="neatTable"+a;this.O="neatHCell"+a;this.h=null;this.o=g;this.j=null;this.position={left:0,top:0};this.F=-1;this.items=[];this.S=this.R=0;this.u=this.C=!1}var P=O.prototype;
P.G=function(d){var g=Array.prototype.slice.call(arguments);g[2]=g[2].bind(this);d.addEventListener.apply(d,g.slice(1))};P.v=function(){this.h&&(this.h.style.left=this.position.left+"px",this.h.style.top=this.position.top+"px",this.h.style.zIndex+=500)};P.Z=function(d){this.K(!0);this.D.na(this.items[d])};P.K=function(d){if(!d||-1!=this.F){var g=D(this.J).rows;this.F=d?-1:-this.F;for(d=1;d<g.length;d++)g[d].style.display=y[this.F]}};
P.I=function(d){var g=this,a=D(this.J),b=this.D.N(this.items[d]);var c=a.insertRow(-1);c.cssText="all:revert;padding:0px;margin:0px;width:100%;line-height:100% !important;height:19px !important";c.style.display=y[g.F];a=c.insertCell(0);a.style.cssText="all:revert;letter-spacing:normal;line-height:100% !important;width:100%;height:19px !important;margin:0px;padding:0px;padding-left:5px;vertical-align:middle;color:black !important;cursor:default;border:dotted 1px black;background:#c9dff2 !important;direction:ltr;text-align:left;font-family:tahoma !important;font-style:normal;font-weight:bold;font-size:7pt !important";
b=N(b);if(0==d&&1==this.items.length){c=document.createElement("TABLE");c.style.cssText="all:revert;border-spacing:0px;border-collapse:separate;padding:0px;margin:0px;width:100%;border:solid 1px black;direction:ltr;line-height:100% !important";var f=c.insertRow(-1);f.style.cssText="all:revert;padding:0px;margin:0px;line-height:100% !important;height:19px !important";var e=f.insertCell(-1);e.style.cssText="all:revert;background:#c9dff2 !important;padding:0px;margin:0px;width:20px;height:19px !important;text-align:center;vertical-align:middle;line-height:100% !important";
var h=document.createElement("IMG");h.src=k;h.onclick=function(){alert("NeatDownloadManager Video/Audio Panel.")};e.appendChild(h);e=f.insertCell(-1);e.id=g.O;e.style.cssText="all:revert;letter-spacing:normal;padding:0px;margin:0px;vertical-align:middle;color:black !important;cursor:default;background:#c9dff2 !important;direction:ltr;text-align:center;font-family:tahoma !important;font-style:normal;font-weight:bold;font-size:7pt !important;height:19px !important;line-height:100% !important";e=f.insertCell(-1);
e.style.cssText="all:revert;background:#c9dff2 !important;padding:0px;margin:0px;width:20px;height:19px !important;text-align:center;vertical-align:middle;line-height:100% !important";f=document.createElement("IMG");f.src=x;f.onclick=function(){g.h.style.display="none"};e.appendChild(f);a.appendChild(c);a.style.paddingLeft="0px";a=D(g.O);a.innerText=" "+b;a.onmouseover=function(){this.style.color="red"};a.onmouseout=function(){this.style.color="black"};a.onclick=function(){0==g.u&&g.Z(0);g.u=!1}}else a.innerText=
" "+(d+1).toString()+"- "+b,a.onmouseover=function(){this.style.background="white";this.style.color="red"},a.onmouseout=function(){this.style.background="#c9dff2";this.style.color="black"},c.onmousedown=function(){g.Z(d)}};
P.L=function(d){var g=this,a=this.D.N(d),b=null,c=this.o?"absolute":"fixed";this.o&&!this.C&&(b=J(this.o));b&&(this.position={left:Math.max(0,b.left-1),top:Math.max(0,b.top-19-4)});this.h?this.v():(this.h=document.createElement("DIV"),this.h.style.cssText="all:revert;padding:0px;margin:0px;position:"+c+";z-index:100000000;width:210px;left:"+this.position.left+"px;top:"+this.position.top+"px;direction:ltr;text-align:center;background:#c9dff2 !important;line-height:100% !important;",this.h.id="neatDiv"+
this.ta,this.h.style.display=this.D.H?"":"none",document.body.appendChild(this.h),b=document.createElement("TABLE"),b.id=this.J,b.style.cssText="all:revert;border-spacing:0px;border-collapse:separate;padding:0px;margin:0px;line-height:100% !important;direction:ltr;width:100%;",this.h.appendChild(b),this.G(g.h,"mousemove",g.wa),this.G(g.h,"mousedown",g.va),this.G(g.h,"mouseup",g.T),this.G(g.h,"mouseout",g.xa),this.G(g.h,"mouseover",g.ya),this.j=setTimeout(function(){g.j=null;g.h.style.opacity=.45},
3E4));if(!(-1<this.items.indexOf(d)&&"hls"!=a["6"])){a=N(a);if(this.items.length&&(" MP4 File HQ"==a||" MP4 File LQ"==a))for(b=0;b<this.items.length;b++)if(a==N(this.D.N(this.items[b]))){this.items[b]=d;this.h.style.display=this.D.H?"":"none";this.v();return}this.items.push(d);d=this.items.length-1;a=D(g.J).rows;var f;d&&(f=D(g.O));0==d?this.I(0):1==d?(this.I(0),this.I(1),f.onclick=function(e){e.stopPropagation();e.preventDefault();0==g.u&&g.K();g.u=!1},f.innerText=" 2 Files"):(this.I(d),f.innerText=
" "+(d+1).toString()+" Files");a[0].style.display=""}};P.va=function(d){0==d.button&&(this.C=!0,this.u=!1,this.R=d.clientX,this.S=d.clientY,d.stopPropagation(),d.preventDefault())};P.wa=function(d){if(this.C){this.K(!0);var g=d.clientX-this.R,a=d.clientY-this.S;!this.u&&(this.u=g||a);this.position.left+=g;this.position.top+=a;this.R=d.clientX;this.S=d.clientY;this.v()}else this.u=!1};
P.xa=function(){this.C=!1;this.j&&(clearTimeout(this.j),this.j=null);var d=this;this.j=setTimeout(function(){d.h.style.opacity=.45;d.j=null},15E3)};P.ya=function(){this.C=!1;this.j&&(clearTimeout(this.j),this.j=null);this.h.style.opacity=1};P.T=function(){this.C=!1};
if(!window.m){var Q=function(){this.da=null;this.A={};this.i={};this.g=[];this.P=!1;this.aa=this.$=-1;this.Counter=1;this.l=null;this.H=!0;this.W=[];this.port=chrome.runtime.connect({name:"neat"});this.ga=Math.ceil(2E6*Math.random());this.port.onMessage.addListener(this.sa.bind(this));this.port.onDisconnect.addListener(this.ua.bind(this));if(E()){var a=this;this.ra=new window.MutationObserver(function(b){b.forEach(function(c){a.oa(c.target)})});this.ra.observe(document,{childList:!0,subtree:!0})}this.m(window,
"keydown",this.X,!0);this.m(window,"keyup",this.X,!0);this.m(window,"mouseup",this.T,!0);this.m(window,"resize",this.Ba);this.m(document,"DOMContentLoaded",this.ca);this.m(document,"click",this.qa)};window.m=!0;P=Q.prototype;P.pa=function(a,b){b.hd&&this.B({id:G(b.hd),1:"GET",2:b.hd,fEx:"mp4",4:" MP4 File HQ"},window.location.href,a,!1);b.sd&&this.B({id:G(b.sd),1:"GET",2:b.sd,fEx:"mp4",4:" MP4 File LQ"},window.location.href,a,!1)};P.ka=function(a){for(;(a=a.parentElement)&&1>a.querySelectorAll("video").length;);
if(a)return a.querySelectorAll("video")[0]};P.ia=function(a,b){var c=this;F({2:"https://www.facebook.com/video/embed?video_id="+b,ba:function(f){var e=/"sd_src_no_ratelimit":"(.*?)"/.exec(f),h=/"hd_src_no_ratelimit":"(.*?)"/.exec(f);e&&e.length||(e=/"sd_src":"(.*?)"/.exec(f));h&&h.length||(h=/"hd_src":"(.*?)"/.exec(f));f={sd:e&&e.length?e[1].replace(/\\/g,""):"",hd:h&&h.length?h[1].replace(/\\/g,""):""};e=c.ka(a);void 0!==e&&c.pa(e,f)}})};P.oa=function(a){var b=this;a=a.querySelectorAll('a[href*="/videos/"]');
a.length&&Array.from(a,function(c){if(!c.getAttribute("NEAT_DM")){c.setAttribute("NEAT_DM",1);var f=c.href.match(/.*\/videos\/(\d+)\/.*/i);f&&b.ia(c,f[1])}})};P.N=function(a){return this.A[a]};P.Aa=function(){this.port.postMessage([2,this.da,window.location.href,this.getTitle()])};P.ca=function(a){for(var b=this,c=document.getElementsByTagName("SCRIPT"),f,e,h,l,n=!1,r=/"progressive":\s*\[/,t=0;t<c.length;t++){var p=c[t];f=p.innerText;if(a&&!n&&-1<f.indexOf("itag")&&0>f.indexOf("signatureCipher")){for(var q=
['"formats"',"adaptiveFormats"],u=0;u<q.length;u++)e=f,h=e.indexOf(q[u]),0>h||(e=e.substr(h),h=e.indexOf("["),l=e.indexOf("]"),0>h||0>l||l<=h||(e=e.substr(h+1,l-h-1),n=this.M(e,1==u)));if(this.Ca)break}if(0<=document.location.host.toLowerCase().indexOf("vimeo")&&!p.src&&r.test(p.innerText)&&(e=p.innerText,h=e.indexOf('"progressive"'),!(0>h||(l=e.indexOf("]",h),0>l)))){e=e.substr(h,l-h+1);f=null;try{f=JSON.parse("{"+e+"}")}catch(w){}if(f){var v=f.progressive;v&&setTimeout(function(){for(var w=0;w<
v.length;w++)b.B({id:G(v[w].url),1:"GET",2:v[w].url,fEx:"mp4",4:"MP4 File "+v[w].quality},window.location.href,null,!1)},2E3);break}}}};P.M=function(a,b){var c=this,f={18:{e:"MP4",s:"360p"},22:{e:"MP4",s:"720p"},37:{e:"MP4",s:"1080p"},38:{e:"MP4",s:"1080p"},82:{e:"MP4",s:"360p"},84:{e:"MP4",s:"720p"},132:{e:"MP4",s:"240p"},151:{e:"MP4",s:"144p"}};a=I(a);a=a.replace(/\\/g,"");var e=[],h="";a=a.split("}");if(1>a.length)return!1;for(var l=0;l<a.length;l++){var n=a[l].trim(),r={},t;if(n&&!(0>n.indexOf("itag"))){var p=
n.indexOf('"url"');if(!(0>p)){p=n.indexOf('"',p+5);var q=n.indexOf('"',p+1);if(!(0>p||0>q||q<=p||(n=r.url=decodeURIComponent(n.substr(p+1,q-p-1)),p=n.indexOf("?"),0>p))){p=n.substring(p+1).split("&");for(q=0;q<p.length;q++)0==p[q].indexOf("itag=")&&(t=r.itag=parseInt(p[q].split("=").pop())),0==p[q].indexOf("dur=")&&(r.dur=parseFloat(p[q].split("=").pop())),0==p[q].indexOf("ei=")&&(r.mK=p[q].split("=").pop());n&&t&&(0<n.indexOf("signature=")||0<n.indexOf("sig="))&&(!b||r.dur)&&(b||f[t])&&(!b||z[t]||
-1<A.indexOf(t))&&(b?e.push({2:n,mme:0>A.indexOf(t)?"video":"audio",ig:t,du:r.dur,mK:r.mK,purl:window.location.href}):(n=parseInt(r.dur),h=r.timeStr=60>n?n+" sec":parseInt(n/60)+" min "+(parseInt(n%60)?parseInt(n%60)+" sec":""),e.push(r)))}}}}if(!e.length)return!1;b?setTimeout(function(){for(var u=e.length-1;0<=u;u--)c.Y(e[u],"DTC")},1800):(this.za(),setTimeout(function(){for(var u=0;u<e.length;u++){var v=e[u];c.B({id:G(v.url),ig:v.itag,1:"GET",2:v.url,fEx:f[v.itag].e,4:f[v.itag].e+" File "+f[v.itag].s+
", "+(v.timeStr||h)},window.location.href,null,!1)}},1500));return!0};P.za=function(){this.g=[];for(var a in this.i)for(var b=this.i[a],c=0;c<b.items.length;c++){var f=this.A[b.items[c]];if(f&&f.ig){this.U(a,!0);break}}};P.U=function(a,b){var c=this.i[a];if(c){if(b)for(b=0;b<c.items.length;b++)delete this.A[c.items[b]];try{document.body.removeChild(c.h),c.j&&clearTimeout(c.j)}catch(f){}delete this.i[a]}};P.na=function(a){(a=this.A[a])&&this.port.postMessage([6,a,window.location.href,this.getTitle(),
N(a)])};P.ja=function(a,b){var c=null,f=["VIDEO","AUDIO","OBJECT","EMBED"];try{var e=document.activeElement,h=0,l,n,r=e&&0<=f.indexOf(e.tagName)?e:null;r||=(e=document.elementFromPoint(this.$,this.aa))&&0<=f.indexOf(e.tagName)?e:null;for(var t=0;t<f.length;t++){for(var p=document.getElementsByTagName(f[t]),q=0;q<p.length;q++)if(e=p[q],3!=t||"application/x-shockwave-flash"==e.type.toLowerCase()){var u=e.src||e.data;if(u&&(u==a||u==b)){var v=e;break}if(r||w)var w=e;else{var B=e.clientWidth,C=e.clientHeight;
if(B&&C){var K=window.getComputedStyle(e);if(!K||"hidden"!=K.visibility){var L=B*C;C<1.4*B&&B<3*C&&L>h&&(h=L,l=e);n||=e}}}}if(v)break}(c=v||r||w||l||n)||(c=document.querySelectorAll("video,audio")[0]);if(!c)return null;if("EMBED"==c.tagName&&!c.clientWidth&&!c.clientHeight){var M=c.parentElement;"OBJECT"==M.tagName&&(c=M)}return c}catch(R){return null}};P.la=function(a){try{var b=parseInt(a.getAttribute("JM_NEAT"));b||(b=this.ga<<10|this.Counter++,a.setAttribute("JM_NEAT",b));return b}catch(c){}};
P.getTitle=function(){var a="";try{a=document.title||document.getElementsByTagName("title")[0].innerText,a=a.trim()}catch(b){}return a?a=a.replace(/[ \t\r\n\u25B6]+/g," ").trim():""};P.X=function(a){8!=a.keyCode&&46!=a.keyCode||this.port.postMessage([4,"keydown"==a.type])};P.T=function(a){0==a.button&&(this.$=a.clientX,this.aa=a.clientY)};P.Ba=function(){if(!this.P){this.P=!0;var a=this;window.setTimeout(function(){for(var b in a.i){var c=a.i[b],f=null;c.o&&(f=J(c.o));if(f){try{document.body.removeChild(c.h)}catch(e){}c.position.left=
Math.max(0,f.left-1);c.position.top=Math.max(0,f.top-19-4);document.body.appendChild(c.h)}c.v()}a.P=!1},500)}};function d(a,b){return 18>Math.abs(a.left-b.left)&&18>Math.abs(a.top-b.top)}function g(a){a=J(a.o);return!a||0>a.left||0>a.top}P.B=function(a,b,c,f){var e=this,h=-1,l=null,n;f=f&&RegExp(".*facebook.com$|.*vimeo.com$|.*youtube.com$","i").test(window.location.host)&&!(a.fEx&&"VTT"==a.fEx.toUpperCase())&&!(!a.fS||4194304<a.fS);a.id||(a.id=G(a["2"]));c||=this.ja(a["2"],b);if(!c)for(n in this.i){l=
this.i[n];h=n;break}if(!c&&!l){if(f)return;l=new O(e,null,0)}else if(!l)if(h=this.la(c),l=this.i[h],!l){if(f)return;l=new O(e,c,h);b=J(c);c={left:Math.max(0,b.left-1),top:Math.max(0,b.top-19-4)};for(n in this.i)if(n&&n!=h&&(b=this.i[n],d(c,b.position))){for(c=0;c<b.items.length;c++)l.L(b.items[c]);this.U(n,!1);break}if(0!=h&&this.i[0]){b=this.i[0];for(c=0;c<b.items.length;c++)l.L(b.items[c]);this.U(0,!1)}}else{if(f){l.v();return}}else if(f){l.v();return}e.A[a.id]=a;l.L(a.id);l.o&&g(l)&&!this.l&&(e.l=
setInterval(function(){e.ha(l)},1200))};P.ha=function(a){if(a&&a.o){var b=J(a.o);b&&(a.position={left:Math.max(0,b.left-1),top:Math.max(0,b.top-19-4)},a.v());!b||0>b.left||0>b.top||(clearInterval(this.l),this.l=null)}else clearInterval(this.l),this.l=null};P.V=function(a,b){var c=this,f=a.du,e="";e=60>f?parseInt(f)+" sec":parseInt(f/60)+" min "+(parseInt(f%60)?parseInt(f%60)+" sec":"");var h={id:G(a["2"]+b["2"]),2:a["2"],3:b["2"],ig:a.ig,4:"MKV File "+z[a.ig]+", "+e};setTimeout(function(){c.B(h,a.purl,
null,!1)},2200)};P.Y=function(a,b){if("https://www.youtube.com/"!=window.location.href.toLowerCase()&&("video"!=a.mme||z[a.ig])){a.mode=b;for(b=0;b<this.g.length;b++)if(a.ig==this.g[b].ig&&(a.mK==this.g[b].mK||2>Math.abs(a.du-this.g[b].du)))return;a.used=!1;if("video"==a.mme){var c=null;for(b=0;b<this.g.length;b++)if("audio"==this.g[b].mme&&!this.g[b].used&&(a.mK==this.g[b].mK||2>Math.abs(a.du-this.g[b].du))){this.g[b].used=!0;c=this.g[b];break}if(!c)for(b=0;b<this.g.length;b++)if("audio"==this.g[b].mme&&
(a.mK==this.g[b].mK||2>Math.abs(a.du-this.g[b].du))){this.g[b].used=!0;c=this.g[b];break}c&&(a.used=!0,this.V(a,c))}else{c=null;for(b=0;b<this.g.length;b++)if("video"==this.g[b].mme&&0==this.g[b].used&&(a.mK==this.g[b].mK||2>Math.abs(a.du-this.g[b].du))){this.g[b].used=!0;c=this.g[b];break}c&&(a.used=!0,this.V(c,a))}this.g.push(a)}};P.ma=function(a){var b=this;F({2:a,ba:function(c){for(var f=['"formats"',"adaptiveFormats"],e=0;e<f.length;e++){var h=c,l=h.indexOf(f[e]);if(!(0>l||-1<h.indexOf("signatureCipher"))){h=
h.substr(l);l=h.indexOf("[");var n=h.indexOf("]");if(0>l||0>n||n<=l)break;h=h.substr(l+1,n-l-1);b.M(h,1==e)}}}})};P.sa=function(a){var b=this;switch(a[0]){case 1:b.B(a[1],a[2],null,!0);break;case 3:var c=a[1];c&&(b.da=c);b.Aa();break;case 5:b.fa();break;case 7:b.M(a[1],a[2]);break;case 9:setTimeout(function(){b.Y(a[1],"BGH")},1400);break;case 11:b.ea();c=new URL(window.location.href);var f=c.pathname;if(!(0<=c.hostname.toLowerCase().indexOf("youtube."))){setTimeout(function(){b.ca()},2500);break}0==
f.toLowerCase().indexOf("/watch")&&b.ma(a[1]);break;case 13:c=a[1];c!=b.H&&(b.H=c,b.fa());break;case 15:alert("Extension Can't Connect to NeatDownloadManager Application, You Can : \r\n1- Check If NeatDownloadManager is Running.\r\n2- or Hold down Delete-Key and click on the Download link.\r\n3- or Disable NeatDownloadManager Extension temporarily.")}};P.m=function(a){var b=Array.prototype.slice.call(arguments);b[2]=b[2].bind(this);this.W.push(b);a.addEventListener.apply(a,b.slice(1))};P.qa=function(){for(var a in this.i)this.i[a].K(!0)};
P.ea=function(){try{for(var a in this.i)this.i[a].j&&clearTimeout(this.i[a].j),document.body.removeChild(this.i[a].h)}catch(b){}this.i={};this.A={};this.g=[];this.l&&clearInterval(this.l);this.l=null};P.fa=function(){var a=this.H?"":"none";try{for(var b in this.i)this.i[b].h.style.display=a}catch(c){}};P.ua=function(){for(var a;a=this.W.shift();){var b=a.shift();b.removeEventListener.apply(b,a)}this.ea();this.port=null;window.m=!1};new Q};
