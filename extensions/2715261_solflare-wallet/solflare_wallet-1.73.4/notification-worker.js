let connections=0;const peers=[],notificationIds=[],notificationPermissionIds=[];self.addEventListener("connect",(t=>{const e=t.ports[0];connections++,peers.push({portId:connections,port:e}),e.postMessage({portId:connections,type:"CONNECTION"}),e.addEventListener("message",(t=>{if("NOTIFICATION"===t.data.type){if(notificationIds.includes(t.data.notificationId))return;notificationIds.push(t.data.notificationId),peers.filter((e=>e.portId===t.data.portId)).forEach((e=>{e.port.postMessage(t.data)}))}else if("NOTIFICATION_PERMISSION"===t.data.type){if(notificationPermissionIds.includes(t.data.id))return;notificationPermissionIds.push(t.data.id),peers.filter((e=>e.portId===t.data.portId)).forEach((e=>{e.port.postMessage(t.data)}))}else"NOTIFICATION_RELOAD_STATE"===t.data.type&&peers.filter((e=>e.portId!==t.data.portId)).forEach((e=>{e.port.postMessage(t.data)}))})),e.start()}),!1);