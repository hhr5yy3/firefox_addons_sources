!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="02b3dcec-8c4e-4e73-9c86-1af5932a402b",t._sentryDebugIdIdentifier="sentry-dbid-02b3dcec-8c4e-4e73-9c86-1af5932a402b")}catch(t){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"orbit@1.2.2"},(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}var n="agreedToPrivacyPolicy";(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"dig",value:function(t,e,r){var n=e.reduce((function(t,e){return t&&(t[e]||0===t[e])?t[e]:null}),t);return null!==n?n:r}}],(r=null)&&e(t.prototype,r),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n})().dig(chrome.runtime.getManifest(),["applications","gecko"]);var i=function(t,e){var r;return{call:function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];clearTimeout(r),r=setTimeout((function(){t.apply(void 0,i)}),e)},cancel:function(){clearTimeout(r)}}};function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=document.createElement(t);return e&&n.classList.add(e),r&&s(n,r),n}function a(t,e,r){t.style[e]=r}function s(t,e){for(var r in e)a(t,r,e[r]);return t}function c(t){return new Promise((function(e){var r=document.querySelector(t);if(r)return e(r);var n=new MutationObserver((function(r){document.querySelector(t)&&(e(document.querySelector(t)),n.disconnect())}));n.observe(document.body,{childList:!0,subtree:!0})}))}function u(t,e){if(t)return t.substr(t.indexOf(e)+1)}function l(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;0===r&&(t.textContent=""),t.textContent+=e[r],n.scrollTop=n.scrollHeight,r!==e.length-1&&setTimeout((function(){return l(t,e,r+1,n)}),5)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t,e){if("object"!=f(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==f(e)?e:e+""}var h=chrome.runtime.getManifest().version,m=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.builder=e,this.view=null,this.isVisible=!1},e=[{key:"show",value:function(){var t=this;this.isVisible||(this.buildShadowRoot(),this.view=this.builder(),this.root.append(this.view.view||this.view.main),this.isVisible=!0,this.observer=setInterval((function(){var e=t.getMainNode();e.contains(t.wrapper)||e.append(t.wrapper)}),500))}},{key:"hide",value:function(){clearInterval(this.observer),this.observer=null,this.wrapper?.remove(),this.wrapper=null,this.root=null,this.view=null,this.isVisible=!1}},{key:"buildShadowRoot",value:function(){var t=document.createElement("orbit-wrapper");this.addStylesToWrapper(t,orbit.type);var e=document.createElement("link");e.setAttribute("href",chrome.runtime.getURL("assets/orbitStyles.css?version=".concat(h))),e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css");var r=t.attachShadow({mode:"open"});r.appendChild(e),this.wrapper=t,this.root=r,this.getMainNode().append(this.wrapper)}},{key:"getMainNode",value:function(){return document.querySelector(orbit.selectors.main)}},{key:"addStylesToWrapper",value:function(t,e){s(t,"gmail"==e?{all:"initial",width:0}:{all:"initial",position:"fixed",right:"0px",top:"0px",zIndex:2147483647,height:"100vh",width:"0"})}}],e&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const y=JSON.parse('{"main":"div[jsaction*=\\"CyXzrf:.CLIENT\\"]","emailThread":"*[data-thread-perm-id*=\\"thread-f\\"], *[data-thread-perm-id*=\\"thread-a\\"]","emailChains":".h7[role*=\\"listitem\\"], .kv[role*=\\"listitem\\"]"}');function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:e+""}var w=function(){return t=function t(e,r,n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.level=["success","info","error"].includes("success")?e:"error",this.title=r,this.body=n,this.btnText=i,this.btnAction=o},e=[{key:"render",value:function(){var t=this,e=o("div","orbit-alert");e.classList.add("orbit-alert-".concat(this.level));var r=o("img","orbit-alert-icon");r.src=this.iconForLevel(),e.appendChild(r);var n=o("div","orbit-alert-inner");e.appendChild(n);var i=document.createElement("p"),a=document.createElement("strong");if(a.textContent=this.title,i.appendChild(a),n.appendChild(i),this.body){var s=o("p");s.innerText=this.body,n.appendChild(s)}var c=o("img","orbit-alert-close");if(c.src=chrome.runtime.getURL("assets/close.svg"),c.addEventListener("click",(function(){return t.dismiss()})),e.appendChild(c),this.btnText&&this.btnAction){var u=o("a","orbit-alert-btn");u.innerText=this.btnText,u.classList.add("orbit-alert-btn-".concat(this.level));var l=this;u.addEventListener("click",(function(t){t.preventDefault(),l.btnAction.call(l)})),n.appendChild(u)}return this.container=e,e}},{key:"iconForLevel",value:function(){switch(this.level){case"success":return chrome.runtime.getURL("assets/checkmark.svg");case"info":return chrome.runtime.getURL("assets/warning.svg");case"error":return chrome.runtime.getURL("assets/exclamation.svg")}}},{key:"dismiss",value:function(){var t=this;this.container.classList.add("orbit-alert-dismissed"),setTimeout((function(){t.container.parentElement.removeChild(t.container)}),300)}}],e&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const x={main:{display:"flex",flexDirection:"column",flexGrow:"2",gap:"20px",overflow:"auto",padding:"12px",height:"calc(100% - 325px)",boxSizing:"border-box",background:"#FFFFFF",position:"relative"},content:{display:"flex",flexDirection:"column",width:"100%",height:"fit-content",justifyContent:"space-between",background:"#F3F3F3",borderRadius:"5px",fontSize:"14.5px",boxSizing:"border-box",whiteSpace:"initial",wordWrap:"break-word",border:"1px solid #F4F3F3",lineHeight:"20px",letterSpacing:"0.5px"},title:{color:"#534EC7",fontSize:"15px",fontFamily:"Inter",letterSpacing:"-0.375px",opacity:"0.9",margin:"13px 13px 0px 13px",paddingBottom:"13px",borderBottom:"1px solid rgba(0,0,0,0.1)"},response:{borderRadius:"7px",padding:"13px",fontSize:"14px",fontFamily:"Inter",letterSpacing:"-0.35px"},text:{fontSize:"16px"},question:{border:"1px solid #827FFF",borderRadius:"5px",fontSize:"14.5px",marginBottom:"10px",padding:"8px",cursor:"pointer"},suggestedPromptsHeader:{fontSize:"14.5px",color:"#847E7E",padding:"0 0 8px",display:"flex",alignItems:"center",justifyContent:"space-between"},closeSuggestedPrompt:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/snooze.svg")),backgroundRepeat:"no-repeat",backgroundSize:"12px",width:"12px",height:"12px",cursor:"pointer"}};function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function k(t){return function(t){if(Array.isArray(t))return E(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function L(t){var e=function(t,e){if("object"!=S(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==S(e)?e:e+""}var P=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e,this.element=o("div"),this.element.classList.add("orbit-response"),this.styles=x,s(this.element,this.styles.main)},e=[{key:"showSelf",value:function(){this.element.style.display="flex"}},{key:"buildContentBox",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.element,n=s(o("div","orbit-question-content"),this.styles.content);if(n.classList.add("orbit-question-generating"),e){var i=s(o("div"),{marginBottom:"10px",fontWeight:"bold"});i.innerText=e,n.appendChild(i)}var a=o("div"),c=o("div");c.classList.add("loading"),a.appendChild(c),n.appendChild(a);var u=o("div","orbit-question-controls"),l=o("div","orbit-copied-message");l.innerText="Copied!";var f=o("img","orbit-question-copy");f.src=chrome.runtime.getURL("assets/icon-copy-gray.svg"),f.title="Copy to clipboard",f.addEventListener("click",(function(e){return t.clickedCopyResponse(e,a,l)})),n.appendChild(f);var d=o("img","orbit-question-report");d.src=chrome.runtime.getURL("assets/icon-flag-gray.svg"),d.title="Report an issue",d.addEventListener("click",(function(e){return t.clickedReport(e)})),n.appendChild(d),u.appendChild(f),u.appendChild(d),u.appendChild(l),n.appendChild(u);var p=r.querySelector(".orbit-regen-prompt-btn-ctn");return p?r.insertBefore(n,p):r.appendChild(n),a}},{key:"clearAll",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.lastChild)}},{key:"createInitialAskMessage",value:function(){var t=s(o("p","orbit-initial-msg"),this.styles.text),e=o("b");e.innerText="page",t.appendChild(document.createTextNode("Ask me anything about this ")),t.appendChild(e),this.element.appendChild(t)}},{key:"buildSuggestedPromptBtn",value:function(t){var e=this,r=o("div","orbit-suggested-questions-ctn"),n=s(o("div"),this.styles.suggestedPromptsHeader),i=o("div","",this.styles.closeSuggestedPrompt);return n.appendChild(document.createTextNode("Suggested Prompts")),n.appendChild(i),r.appendChild(n),t.slice(0,2).forEach((function(t,n){var i=o("div","orbit-suggested-question",e.styles.question),a=u(t.question,": "),s=u(t.answer,": ");i.appendChild(document.createTextNode(a)),r.appendChild(i),e.clickSuggestedQuestion(i,a,s,n)})),i.addEventListener("click",(function(){var t=orbit.querySelector(".orbit-suggested-prompt-ctn"),e=orbit.querySelector(".orbit-suggested-questions-ctn");t.classList.remove("notclickable"),e.remove()})),r}},{key:"clickSuggestedQuestion",value:function(t,e,r,n){t.addEventListener("click",function(){var t=orbit.querySelector(".orbit-response"),i=orbit.querySelector(".orbit-suggested-questions-ctn"),a=orbit.querySelector(".orbit-suggested-prompt-ctn");i.remove(),a.classList.remove("notclickable"),chrome.runtime.sendMessage({action:"removeSuggestedQuestion",index:n},(function(){})),r?(this.buildContentBox(e,t),setTimeout((function(){var e=orbit.querySelector(".loading"),n=e.parentNode;e&&e.remove(),n.appendChild(o("div","orbit-suggested-question-answer")),l(k(orbit.querySelectorAll(".orbit-suggested-question-answer")).slice(-1)[0],r,0,t)}),500)):this.sidebar.chatController.userEnteredMessage(e,[],e)}.bind(this))}},{key:"expandSuggestedPromptsCtn",value:function(t){var e=orbit.querySelector(".orbit-response"),r=orbit.querySelector(".orbit-suggested-prompts-display"),n=orbit.querySelector(".orbit-initial-msg");n&&n.remove(),r.appendChild(this.buildSuggestedPromptBtn(t)),setTimeout((function(){e.scrollTop=e.scrollHeight}),100)}},{key:"appendErrorToChat",value:function(t,e){var r=new w(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"Got It",(function(){r.dismiss()}));this.element.appendChild(r.render())}},{key:"createCancelPromptBtn",value:function(){var t=o("div","orbit-cancel-prompt-btn-ctn"),e=o("div","orbit-cancel-regen-ctn"),r=o("div","orbit-stop-gen-icon");return s(r,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/Icon-stop-color.svg"),")")}),e.appendChild(r),e.appendChild(document.createTextNode("Stop generating")),t.addEventListener("click",(function(){chrome.runtime.sendMessage({action:"abortStream"},(function(){t.style.display="none",orbit.querySelector(".orbit-regen-prompt-btn-ctn").style.display="block"}))})),t.appendChild(e),t}},{key:"createRegeneratePromptButton",value:function(){var t=this,e=o("div","orbit-regen-prompt-btn-ctn"),r=o("div","orbit-cancel-regen-ctn"),n=o("div","orbit-stop-gen-icon");return s(n,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/refresh.svg"),")")}),r.appendChild(n),r.appendChild(document.createTextNode("Regenerate")),e.addEventListener("click",(function(){if(orbit.previousPrompt){e.style.display="none";var r=orbit.querySelectorAll(".orbit-response .orbit-question-content");r.length&&r[r.length-1].remove(),t.sidebar.chatController.userEnteredMessage(orbit.previousPrompt,null,orbit.displayedPrompt)}})),e.appendChild(r),e}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=arguments.length>2?arguments[2]:void 0;t.appendChild(this.element),t.appendChild(o("div","orbit-suggested-prompts-display"));var r=o("div","orbit-prompts-actions");t.appendChild(r),r.appendChild(this.createRegeneratePromptButton()),r.appendChild(this.createCancelPromptBtn()),"questions"===e&&this.createInitialAskMessage()}},{key:"clickedReport",value:function(t){var e=this;t.preventDefault(),chrome.runtime.sendMessage({action:"fetchLocalSessionHistory"},(function(t){e.sidebar.render("contact",(function(){}),{history:t},!0)}))}},{key:"clickedCopyResponse",value:function(t,e,r){t.preventDefault();var n=e.innerText;navigator.clipboard.writeText(n),r.classList.add("orbit-copied-message-visible"),setTimeout((function(){r.classList.remove("orbit-copied-message-visible")}),500)}}],e&&C(t.prototype,e),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function j(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */j=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new I(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(A([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==T(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(T(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function O(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function _(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){O(o,n,i,a,s,"next",t)}function s(t){O(o,n,i,a,s,"throw",t)}a(void 0)}))}}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A(n.key),n)}}function A(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var R=null,F=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e,this.main=o("div","orbit-suggested-prompt-view"),this.built=!1},e=[{key:"clearAll",value:function(){for(;this.main.firstChild;)this.main.removeChild(this.main.lastChild)}},{key:"buildTextAreaCtn",value:function(){var t=this,e=o("div","orbit-prompt-ctn"),r=o("textarea","orbit-prompt"),n=o("button","send-prompt-btn");return r.setAttribute("placeholder","Type here to ask"),e.appendChild(r),e.appendChild(n),s(n,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/send.svg"),")")}),r.addEventListener("keydown",(function(t){t.stopPropagation()})),r.addEventListener("keypress",(function(t){t.stopPropagation()})),r.addEventListener("keyup",(function(e){e.stopPropagation(),"Enter"!==e.key||e.shiftKey||(t.sidebar.chatController.userEnteredMessage(e.currentTarget.value),r.value="")})),n.addEventListener("click",(function(e){var n=orbit.querySelector(".orbit-prompt").value;t.sidebar.chatController.userEnteredMessage(n),r.value=""})),e}},{key:"clickSuggestedPromptBtn",value:(i=_(j().mark((function t(){var e,r=this;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=orbit.querySelector(".orbit-suggested-prompt-ctn")).addEventListener("click",_(j().mark((function t(){var n;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.classList.contains("notclickable")){t.next=2;break}return t.abrupt("return");case 2:return n=!1,t.next=5,new Promise((function(t){chrome.runtime.sendMessage({action:"getSuggestedPrompts"},(function(i){i&&(orbit.querySelector(".orbit-suggested-questions-ctn")||(new P(r.sidebar).expandSuggestedPromptsCtn(i),e.classList.add("notclickable")),n=!0),t()}))}));case 5:if(!n){t.next=7;break}return t.abrupt("return");case 7:clearTimeout(R),R=setTimeout((function(){new Promise((function(t){chrome.runtime.sendMessage({action:"getSuggestedPrompts"},(function(t){t&&(orbit.querySelector(".orbit-suggested-questions-ctn")||(new P(r.sidebar).expandSuggestedPromptsCtn(t),e.classList.add("notclickable")))}))}))}),1e3);case 9:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"buildSuggestedPromptCtn",value:function(){var t=o("div","orbit-suggested-prompt-ctn-layer"),e=o("div","orbit-suggested-prompt-ctn");e.appendChild(document.createTextNode("Suggested Prompts")),e.classList.add("notclickable"),e.classList.add("hidden");var r=o("div","orbit-suggested-prompt-toggle-btn");return s(r,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/suggest.svg"),")")}),e.appendChild(r),t.appendChild(e),t}},{key:"buildInternalComponents",value:function(){var t=o("div","orbit-prompt-hdr");t.appendChild(document.createTextNode("Ask Orbit")),t.appendChild(this.buildSuggestedPromptCtn()),this.main.appendChild(t),this.main.appendChild(this.buildTextAreaCtn())}},{key:"render",value:(n=_(j().mark((function t(){var e,r=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:document,this.buildInternalComponents(),e.appendChild(this.main),t.next=5,this.clickSuggestedPromptBtn();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"hide",value:function(){}},{key:"show",value:function(){}}],e&&I(t.prototype,e),r&&I(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}();function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function B(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */B=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==N(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(N(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function q(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function z(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){q(o,n,i,a,s,"next",t)}function s(t){q(o,n,i,a,s,"throw",t)}a(void 0)}))}}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U(n.key),n)}}function U(t){var e=function(t,e){if("object"!=N(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==N(e)?e:e+""}var V=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new F,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.promptView=e,this.sidebar=r,this.promptView.chatController=this},e=[{key:"syncCurrentEmail",value:function(){try{this.createPromptForCurrentEmail()}catch(t){console.log(t)}}},{key:"userEnteredMessage",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=orbit.querySelector(".orbit-initial-msg");o&&o.remove(),this.sidebar.goToResponseView(n||t);var a=orbit.querySelector(".orbit-regen-prompt-btn-ctn");a&&(a.style.display="none"),r=this.sidebar.storedContext||r,this.sidebar.storedContext&&(this.sidebar.storedContext=null),orbit.type&&"none"!==orbit.type&&(i=orbit.type);var s=this.sidebar.extractTitle();new Promise((function(o){Ke(!0),chrome.runtime.sendMessage({action:"submitMessage",actualPrompt:t,messages:r,title:s,displayedMessage:n||t,type:i,iconUrl:e.sidebar.extractUrlIcon()},(function(e){Ke(!1),orbit.previousPrompt=t,orbit.displayedPrompt=n}))}))}},{key:"callUrlWhenPromptClicked",value:(a=z(B().mark((function t(e){var r,n,i,o,a,s;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return r=t.sent,t.next=5,r.text();case 5:return n=t.sent,i=new DOMParser,o=i.parseFromString(n,"text/html"),(a=o.querySelectorAll("table.message")).length>7&&(a=Array.from(a).slice(a.length-7)),s=[],a.forEach((function(t){var e="\n\nFrom ";e+=t.querySelector("tr:first-child").innerText,e+=". ",e+=t.querySelector('tr:last-child font[size*="-1"]').innerText,s.push(e)})),t.abrupt("return",s);case 13:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"mapEmailSummaryType",value:function(t){return{bullets:"Provide a bullet point summary of the emails below (email_summary_bullet):",paragraphs:"Provide a detailed summary of the emails below (email_summary_detailed):",sentences:"Provide a concise summary of the emails below (email_summary_concise):"}[t]}},{key:"extractEmailContent",value:(o=z(B().mark((function t(){var e,r,n,i;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.querySelector(orbit.selectors.emailThread)){t.next=4;break}return console.warn("Could not find email thread"),t.abrupt("return","");case 4:return r=e.dataset.threadPermId,n=$e(),window.location.href.includes("#trash")&&(n=n.replace("search=all","search=trash")),window.location.href.includes("#spam")&&(n=n.replace("search=all","search=spam")),t.next=10,this.callUrlWhenPromptClicked(n+"permthid=".concat(r));case 10:return(i=t.sent).length>1&&(i=i.map((function(t,e){return"email "+(e+1)+":"+t}))),t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"createPromptForCurrentEmail",value:(i=z(B().mark((function t(){var e,r,n,i;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.querySelectorAll(orbit.selectors.emailThread).length>1?"s":"",t.next=3,this.extractEmailContent();case 3:(r=t.sent).length&&(n=this.mapEmailSummaryType(orbit.config.summaryType)||"Provide a medium summary to the email(s) below (email_summary_medium):",i=e?"Summarize each emails":"Summarize the email",this.clickedOnCard({body:r.join(". ")},i,n));case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"clickedOnCard",value:(n=z(B().mark((function t(e,r){var n,i,o=this,a=arguments;return B().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.length>2&&void 0!==a[2]?a[2]:"Summarize each email",i="chat-ele-".concat(Date.now()),this.sidebar.goToResponseView(r),Ke(!0),new Promise((function(t){chrome.runtime.sendMessage({action:"submitMessage",id:i,actualPrompt:n,displayedMessage:r,messages:e.body,title:o.sidebar.extractTitle(),iconUrl:o.sidebar.extractUrlIcon(),type:"email"},(function(t){Ke(!1),orbit.previousPrompt=n,orbit.displayedPrompt=r}))}));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})}],e&&M(t.prototype,e),r&&M(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,o,a}();function G(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var H=/^\d+[.]?[)]?\s/;const W={title:{padding:"20px 15px",display:"flex",alignItems:"center",justifyContent:"space-between",fontWeight:"600"},body:{padding:"15px",background:"#FFFFFF",borderRadius:"5px",display:"flex",flexDirection:"column",height:"calc(100% - 160px)"},inputCtn:{position:"relative",width:"100%"},input:{padding:"8px",borderRadius:"3px",border:"1px solid lightgray",color:"#2D2D2D",margin:"3px 0px",fontSize:"16px",background:"transparent",width:"100%",boxSizing:"border-box"},swapElement:{textDecoration:"underline",cursor:"pointer"},button:{background:"rgb(129, 127, 247)",color:"#FFFFFF",padding:"8px 0px",border:"none",borderRadius:"5px",height:"38px"},errorMsg:{color:"red"},gmailImage:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/googlelogo.svg"),")"),width:"20px",height:"20px",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}};function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$(n.key),n)}}function $(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Y(e)?e:e+""}var Q=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sideBar=e,this.sideBarCtn=e.page},e=[{key:"createOauthButton",value:function(t,e){var r=document.createElement("div"),n=document.createElement("div");s(n,W.gmailImage),r.appendChild(n),r.classList.add("orbit-oauth-btn");var i=o("div");return s(i,{width:"100%",textAlign:"center"}),i.innerText="Continue with ".concat(e),r.appendChild(i),r}},{key:"renderPostSignInView",value:function(){this.sideBar.render("setting",(function(){var t=document.querySelector(".orbit-sign-in-success-msg");t&&(t.style.opacity=1,setTimeout((function(){t.style.opacity=0}),3e3))}))}},{key:"createOauthElements",value:function(){var t=this;this.authContainer.appendChild(this.createDivider());var e=this.createOauthButton("assets/googlelogo.svg","Google");e.addEventListener("click",(function(){chrome.runtime.sendMessage({action:"getGoogleAuth"},(function(e){200==e.status&&t.renderPostSignInView()}))})),this.authContainer.appendChild(e)}},{key:"createDivider",value:function(){var t=document.createElement("div");return t.classList.add("orbit-auth-divider"),t.appendChild(document.createElement("div")),t.appendChild(document.createTextNode("or")),t.appendChild(document.createElement("div")),t}},{key:"addPasswordRevealer",value:function(t,e){var r=document.createElement("div"),n=document.createElement("div");r.classList.add("hide-password"),r.classList.add("s-h-hidden"),n.classList.add("show-password"),s(r,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/hide.svg"))}),s(n,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/show.svg"))}),t.appendChild(r),t.appendChild(n),r.addEventListener("click",(function(){e.setAttribute("type","password"),r.classList.add("s-h-hidden"),n.classList.remove("s-h-hidden")})),n.addEventListener("click",(function(){e.setAttribute("type","text"),n.classList.add("s-h-hidden"),r.classList.remove("s-h-hidden")}))}},{key:"createCoreElements",value:function(){this.titleElement=document.createElement("div"),this.leftArrow=document.createElement("div"),this.body=document.createElement("div"),this.emailInput=document.createElement("input"),this.swapPageText=document.createElement("div"),this.swapPageElement=document.createElement("span"),this.passwordInputCtn=document.createElement("div"),this.passwordInput=document.createElement("input"),this.continueBtn=document.createElement("button"),this.confirmPasswordCtn=document.createElement("div"),this.confirmPassword=document.createElement("input"),this.errorMessage=document.createElement("div"),this.authContainer=document.createElement("div"),this.linksContainer=document.createElement("div"),this.linksContainer.classList.add("orbit-auth-links"),this.passwordReset=document.createElement("div"),this.passwordReset.innerText+="Forgot your password? ";var t=document.createElement("a");t.href="".concat("https://orbitbymozilla.com/","users/password/new"),t.target="_blank",t.textContent="Click here to reset it",this.passwordReset.appendChild(t),this.resendConfirmation=document.createElement("div");var e=document.createElement("a");e.href="".concat("https://orbitbymozilla.com/","v1/users/confirmation/new"),e.target="_blank",e.textContent="Click here to resend the confirmation email",this.resendConfirmation.appendChild(e),this.passwordInputCtn.appendChild(this.passwordInput),this.confirmPasswordCtn.appendChild(this.confirmPassword),this.addPasswordRevealer(this.passwordInputCtn,this.passwordInput),this.addPasswordRevealer(this.confirmPasswordCtn,this.confirmPassword),this.leftArrow.innerText="Close"}},{key:"setAttributes",value:function(t){this.swapPageText.innerText="Sign in"==t?"Don't have an account? ":"Already have an account? ",this.swapPageElement.innerText="Sign in"==t?"Create account":"Sign in instead",this.continueBtn.innerText=t,this.emailInput.setAttribute("placeholder","Email"),this.passwordInput.setAttribute("placeholder","Password"),this.passwordInput.setAttribute("type","password"),this.confirmPassword.setAttribute("type","password"),this.confirmPassword.setAttribute("placeholder","Confirm password")}},{key:"appendElements",value:function(t){this.swapPageText.appendChild(this.swapPageElement),this.body.appendChild(this.emailInput),this.body.appendChild(this.passwordInputCtn),"Sign up"==t&&(this.body.appendChild(this.confirmPasswordCtn),s(this.confirmPasswordCtn,W.inputCtn),s(this.confirmPassword,W.input)),this.body.appendChild(this.linksContainer),this.linksContainer.appendChild(this.errorMessage),this.linksContainer.appendChild(this.swapPageText),"Sign in"==t&&(this.linksContainer.appendChild(this.passwordReset),this.linksContainer.appendChild(this.resendConfirmation),this.resendConfirmation.style.display="none"),this.body.appendChild(this.continueBtn),this.body.appendChild(this.authContainer),this.titleElement.appendChild(document.createTextNode(t)),this.titleElement.appendChild(this.leftArrow)}},{key:"setStylesAndClasses",value:function(){s(this.titleElement,W.title),s(this.leftArrow,W.leftArrow),s(this.body,W.body),s(this.emailInput,W.input),s(this.swapPageElement,W.swapElement),s(this.passwordInputCtn,W.inputCtn),s(this.passwordInput,W.input),s(this.continueBtn,W.button),s(this.errorMessage,W.errorMsg),this.continueBtn.classList.add("orbit-auth-btn"),this.body.classList.add("orbit-auth-ctn"),this.leftArrow.classList.add("orbit-auth-back-btn")}},{key:"setEvents",value:function(t){var e=this;this.leftArrow.addEventListener("click",(function(){e.sideBar.internalViews.headerView.clearToggle(),e.sideBar.render()})),this.swapPageElement.addEventListener("click",(function(){e.sideBarCtn.removeChild(e.titleElement),e.sideBarCtn.removeChild(e.body),e.createBody("Sign in"==t?"Sign up":"Sign in")})),this.continueBtn.addEventListener("click",(function(){e.handleFormSubmission(t)})),[this.emailInput,this.passwordInput,this.confirmPassword].forEach((function(r){r.addEventListener("focus",(function(){e.setErrorMessage("")})),r.addEventListener("keyup",(function(r){"Enter"==r.key&&e.handleFormSubmission(t)}))})),[this.passwordInput,this.confirmPassword].forEach((function(t){t.addEventListener("keyup",(function(){if(e.confirmPassword.value.length){var t=e.confirmPassword.value==e.passwordInput.value;e.confirmPassword.style.borderColor=t?"green":"red",e.setErrorMessage(t?"Passwords match":"Passwords do not match"),e.errorMessage.style.color=t?"green":"red"}}))}))}},{key:"handleFormSubmission",value:function(t){"Sign in"==t?this.signInEvent():"Sign up"==t&&this.signUpEvent()}},{key:"createBody",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sign in";this.createCoreElements(),this.setAttributes(t),this.appendElements(t),this.setStylesAndClasses(),this.setEvents(t),this.createOauthElements(),this.sideBarCtn.appendChild(this.titleElement),this.sideBarCtn.appendChild(this.body)}},{key:"signInEvent",value:function(){var t=this,e=this.emailInput.value,r=this.passwordInput.value;e.length&&r.length&&chrome.runtime.sendMessage({action:"signInUser",data:{email:e,password:r}},(function(e){e.error?(t.errorMessage.innerText=e.error,e.error.includes("confirm your email address")?t.resendConfirmation.style.display="block":t.resendConfirmation.style.display="none"):t.renderPostSignInView()}))}},{key:"signUpEvent",value:function(){var t=this,e=this.emailInput.value,r=this.passwordInput.value,n=this.confirmPassword.value;e.length&&r.length&&r==n?chrome.runtime.sendMessage({action:"signUpUser",data:{email:e,password:r}},(function(e){if(e.errors&&e.errors.length){var r=e.errors[0].message;t.setErrorMessage(r)}else 200!=e.status?t.setErrorMessage("Unknown error, please contact support"):t.sideBar.renderConfirmation()})):e.length?r.length?r!=n&&this.setErrorMessage("Passwords do not match."):this.setErrorMessage("You have to input a password."):this.setErrorMessage("Please put in a proper email")}},{key:"setErrorMessage",value:function(t){this.errorMessage.style.color="red",this.errorMessage.innerText=t}},{key:"renderSignin",value:function(){this.createBody("Sign in")}}],e&&K(t.prototype,e),r&&K(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const X={main:{width:"262px",height:"fit-content",background:"#FFFFFF",borderRadius:"7px",margin:"0px 15px 13px 15px",display:"flex",flexDirection:"column",boxSizing:"border-box",padding:"12px"},firstRow:{display:"flex",height:"fit-content",justifyContent:"space-between"},title:{fontFamily:"Inter",fontStyle:"normal",fontWeight:"400",fontSize:"15px",lineHeight:"18px",letterSpacing:"-0.025em",color:"#000000",opacity:"0.9"},description:{fontFamily:"Inter",fontWeight:"400",fontSize:"12px",lineHeight:"15px",letterSpacing:"-0.025em",color:"#000000",opacity:"0.4",marginTop:"10px"},icon:function(t){return{backgroundImage:"url(".concat(chrome.runtime.getURL("gmail"===t?"assets/r1.svg.png":"assets/r3.png"),")"),width:"32px",height:"18px",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}};function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tt(n.key),n)}}function tt(t){var e=function(t,e){if("object"!=J(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==J(e)?e:e+""}var et=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"history";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.styles=X,this.element=o("div","prompt-card"),e&&(this.text=e),this.description=r,this.iconType=n},e=[{key:"build",value:function(){s(this.element,this.styles.main),this.createTitleView(),this.createDescriptionView(),this.createIconView()}},{key:"createTitleView",value:function(){var t=o("div");t.id="fs-row",s(t,this.styles.firstRow);var e=o("div","card-title");s(e,this.styles.title),e.innerText="Show me the best noise cancellation headphones",this.text&&(e.innerText=this.text),t.appendChild(e),this.element.appendChild(t)}},{key:"createDescriptionView",value:function(){if(this.description){var t=o("div");s(t,this.styles.description),t.innerText=this.description,this.element.appendChild(t)}}},{key:"createIconView",value:function(){var t=o("div");s(t,this.styles.icon(this.iconType)),this.element.querySelector("#fs-row").appendChild(t)}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.build(),t.appendChild(this.element),e&&this.element.addEventListener("click",e,{once:!0})}}],e&&Z(t.prototype,e),r&&Z(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const rt={main:{display:"flex",flexDirection:"column",overflow:"scroll"}};function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ot(n.key),n)}}function ot(t){var e=function(t,e){if("object"!=nt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nt(e)?e:e+""}var at=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=o("div","chat-box"),this.styles=rt,s(this.element,this.styles.main)},e=[{key:"appendCard",value:function(t){var e=arguments.length>3?arguments[3]:void 0;(t?new et(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2]):new et).render(this.element,e)}},{key:"hideSelf",value:function(){this.element.style.display="none"}},{key:"showSelf",value:function(){this.element.style.display="flex"}},{key:"clearAll",value:function(){}},{key:"render",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document).appendChild(this.element)}}],e&&it(t.prototype,e),r&&it(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function ct(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==st(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(st(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ut(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function lt(t){return function(t){if(Array.isArray(t))return ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pt(n.key),n)}}function pt(t){var e=function(t,e){if("object"!=st(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=st(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==st(e)?e:e+""}var ht=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e},e=[{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=o("div","orbit-contact-container"),n=o("div","orbit-contact-top"),i=o("img","orbit-contact-back");i.src="".concat(chrome.runtime.getURL("assets/back-arrow.svg"));var a=o("span");a.textContent="Get in Touch";var s=o("div","orbit-contact-body"),c=o("p");c.textContent="Are you experiencing any issues, do you have any feedback for us or would you just like to say hi? We'd love to hear from you!";var u=o("form","orbit-contact-form");u.appendChild(this.createFormRow((function(){var e=o("select");return e.name="subject",e.required=!0,e.replaceChildren.apply(e,lt(t.createSubjectOptions())),e}))),u.appendChild(this.createFormRow((function(){var t=o("textarea");return t.name="body",t.placeholder="Your feedback",t.required=!0,t}))),u.appendChild(this.createFormRow((function(){var t=o("input");return t.type="submit",t.value="Submit Feedback",t}))),n.replaceChildren(i,a),s.replaceChildren(c,u),r.replaceChildren(n,s),this.elements={container:r,form:u,textarea:r.querySelector("textarea"),backBtn:i,submitBtn:r.querySelector("input[type=submit]")},this.elements.backBtn.addEventListener("click",(function(r){return t.clickedBack(r,e)})),this.elements.form.addEventListener("submit",(function(e){return t.formSubmitted(e)})),this.elements.textarea.addEventListener("keyup",(function(t){return t.stopPropagation()})),this.elements.textarea.addEventListener("keydown",(function(t){return t.stopPropagation()})),this.elements.textarea.addEventListener("keypress",(function(t){return t.stopPropagation()})),this.sidebar.page.appendChild(r)}},{key:"createFormRow",value:function(t){var e=o("div","orbit-form-row");return e.appendChild(t()),e}},{key:"createSubjectOptions",value:function(){return["General Inquiry","Feedback","Privacy","Other"].map((function(t){var e=o("option");return e.value=t,e.textContent=t,e}))}},{key:"clickedBack",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.history?.aiOutput?this.sidebar.render("summarize",(function(){r.history.aiOutput.forEach((function(t,n){var i=r.history.humanInput[n];e.sidebar.goToResponseView(i),e.sidebar.addServerResponse(t)})),orbit.querySelectorAll(".orbit-question-generating").forEach((function(t){t.classList?.remove("orbit-question-generating")}))}),{},!0):this.sidebar.render("setting")}},{key:"formSubmitted",value:(n=ct().mark((function t(e){var r,n=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),this.elements.submitBtn.disabled=!0,this.clearErrorText(),r={subject:this.elements.form.querySelector("select[name=subject]")?.value,body:this.elements.form.querySelector("textarea[name=body]")?.value},chrome.runtime.sendMessage({action:"submitFeedback",data:r},(function(t){return n.handleResponse(t)}));case 5:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function a(t){ut(o,r,i,a,s,"next",t)}function s(t){ut(o,r,i,a,s,"throw",t)}a(void 0)}))},function(t){return i.apply(this,arguments)})},{key:"handleResponse",value:function(t){if(this.elements.submitBtn.disabled=!1,t.success){var e=new w("success","Feedback Submitted Successfully");this.elements.form.reset(),this.elements.form.appendChild(e.render()),setTimeout((function(){return e.dismiss()}),5e3)}else if(t.message){var r=new w("error","Submission Error",t.message);this.elements.form.appendChild(r.render())}}},{key:"clearErrorText",value:function(){var t=this;this.elements.form.querySelectorAll(".orbit-alert").forEach((function(e){t.elements.form.removeChild(e)}))}}],e&&dt(t.prototype,e),r&&dt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function vt(t){var e=function(t,e){if("object"!=mt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mt(e)?e:e+""}var bt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e},e=[{key:"render",value:function(t){var e=this,r=o("div","orbit-sidebar-footer"),n=o("p");s(n,{fontSize:"13px"}),n.innerText="This content is generated by a third-party AI language model. The AI outputs may contain errors. You can report any content concerns by ";var i=o("a","orbit-footer-contact");i.setAttribute("href","#"),i.innerText="contacting us",n.appendChild(i),r.appendChild(n),r.querySelector(".orbit-footer-contact").addEventListener("click",(function(t){return e.clickedContact(t)})),t.appendChild(r)}},{key:"clickedContact",value:function(t){t.preventDefault(),this.sidebar.render("contact")}},{key:"clearAll",value:function(){}}],e&&yt(t.prototype,e),r&&yt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();const gt={main:{width:"100%",background:"#FFFFFF",display:"flex",justifyContent:"space-between",alignItems:"center",paddingBottom:"10px",paddingTop:"10px",borderBottom:"1px solid #F1F1F1"},title:{fontStyle:"normal",fontWeight:"600",fontSize:"15px",lineHeight:"18px",color:"#282828",marginLeft:"15px",display:"flex",alignItems:"center"},logo:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/orbit-logo.svg"),")"),height:"20px",width:"65px",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain",marginBottom:"1px"},button:{display:"none",width:"86px",height:"22px",textAlign:"center",alignSelf:"center",border:"1px solid #6560CC",color:"#6560CC",fontSize:"11px",fontFamily:"Inter",fontWeight:"500",background:"white",borderRadius:"4px",marginRight:"15px",padding:"0"},iconImageCtn:{width:"32px",height:"32px",overflow:"hidden",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",marginRight:"8px",backgroundImage:"linear-gradient(#17170B, #17170B), linear-gradient(to right, #cd66ff 0%, #2887ff 100%)",backgroundOrigin:"border-box",backgroundClip:"content-box, border-box",border:"2px solid transparent"},iconImage:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/orbit.gif"),")"),width:"26px",height:"26px",backgroundSize:"26px",objectFit:"contain",backgroundRepeat:"no-repeat",overflow:"hidden",borderRadius:"50%",top:"50%",left:"49%",transform:"translate(-50%, -49%)",position:"absolute"}};function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function St(t){var e=function(t,e){if("object"!=wt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wt(e)?e:e+""}var kt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.built=!1,this.styles=gt,this.element=o("div","orbit-header"),this.button=o("button","orbit-reset-btn"),this.sideBar=e,s(this.element,this.styles.main),"gmail"===orbit.type&&s(this.element,{height:"42px"})},e=[{key:"clearAll",value:function(){}},{key:"build",value:function(){var t=this;this.headerOptions=o("div","orbit-hdr-options");var e=o("div","orbit-hdr-setting-btn"),r=o("div","orbit-hdr-close-btn"),n=o("div");s(e,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/settings.svg"),")")}),s(n,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/snooze.svg"),")")}),r.appendChild(n),this.headerOptions.appendChild(e),this.headerOptions.appendChild(r),this.element.appendChild(this.createTitleView()),this.element.appendChild(this.headerOptions),this.navigateEvent(e,"setting"),r.addEventListener("click",(function(){t.sideBar.closeSidebar()}))}},{key:"clearToggle",value:function(){this.headerOptions?.childNodes?.forEach((function(t){t.classList.remove("toggled")}))}},{key:"navigateEvent",value:function(t,e){var r=this;t.addEventListener("click",(function(){r.clearToggle(),t.classList.add("toggled"),r.sideBar.render(e)}))}},{key:"toggleButton",value:function(t){var e=this.headerOptions.querySelector(".orbit-hdr-".concat(t,"-btn"));e?.classList?.add("toggled")}},{key:"setUserData",value:function(t){this.userData=t}},{key:"buildButton",value:function(){var t=this;return s(this.button,this.styles.button),this.button.innerText="Reset",this.button.addEventListener("click",(function(){t.hideButton(),t.sideBar.render()})),this.button}},{key:"createOrbitImage",value:function(){var t=o("div");s(t,this.styles.iconImageCtn);var e=o("div");return s(e,this.styles.iconImage),t.appendChild(e),t}},{key:"createTitleView",value:function(){var t=o("div"),e=o("div");t.classList.add("orbit-title"),s(t,this.styles.title),s(e,this.styles.logo);var r=this.createOrbitImage();return t.appendChild(r),t.appendChild(e),t}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.built||(this.built=!0,this.setUserData(e),this.build(),t.appendChild(this.element)),e.type&&this.toggleButton(e.type)}},{key:"displayButton",value:function(){this.button.style.display="block"}},{key:"hideButton",value:function(){this.button.style.display="none"}}],e&&xt(t.prototype,e),r&&xt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Ct(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Lt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function Tt(t){var e=function(t,e){if("object"!=Et(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Et(e)?e:e+""}var jt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e,this.page=1,this.fetchLocked=!1},e=[{key:"fetchHistory",value:function(){var t=this;this.fetchLocked||(this.fetchLocked=!0,chrome.runtime.sendMessage({action:"getChatHistory",page:this.page},(function(e){t.fetchLocked=!1,t.renderHistory(e)})))}},{key:"render",value:function(){var t=this,e=o("div"),r=o("div","orbit-auth-back-btn");s(e,{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 15px 5px",fontWeight:600}),r.innerText="Close",e.appendChild(document.createTextNode("History")),e.appendChild(r),r.addEventListener("click",(function(){t.sidebar.internalViews.headerView.clearToggle(),t.sidebar.render(null,(function(){t.sidebar.quickSummarize()}))})),this.sidebar.page.appendChild(e);var n=document.createElement("div");this.sidebar.page.appendChild(n),this.flexBox=n,s(n,{boxSizing:"content-box",padding:"10px",display:"flex",flexDirection:"column",overflow:"scroll",maxHeight:"700px"}),this.page=1,this.fetchLocked=!1,this.fetchHistory(),n.addEventListener("scroll",(function(e){var r=e.target,i=r.scrollHeight,o=r.scrollTop,a=r.clientHeight;Math.abs(i-a-o)<1&&t.fetchHistory(n)}));var i=document.createElement("a");i.classList.add("orbit-history-delete-all"),i.innerText="Clear history",i.addEventListener("click",(function(e){e.preventDefault(),t.deleteAllHistory()})),this.sidebar.page.appendChild(i)}},{key:"renderHistory",value:function(t){if(t.histories?.length){this.page+=1;var e,r=Ct(t.histories);try{for(r.s();!(e=r.n()).done;){var n=e.value,i=this.createHistoryTitle(n);i&&this.flexBox.appendChild(i)}}catch(t){r.e(t)}finally{r.f()}}else 1==this.page&&this.renderEmptyHistory()}},{key:"renderEmptyHistory",value:function(){var t=o("div","history-tile"),e=o("p");e.innerText="Summarize a page to start building your history!",t.appendChild(e),this.flexBox.replaceChildren(t)}},{key:"createHistoryTitle",value:function(t){var e,r=this,n=document.createElement("div"),i=document.createElement("div");if(i.classList.add("history-tile-text"),null!=t.title?i.innerText=t.title:i.innerText=t.chat_log.data[0].replaceAll("\n","").slice(0,100),i.title=i.innerText,t.icon_url)(e=document.createElement("img")).classList.add("tile-image-default"),e.setAttribute("src",t.icon_url),n.appendChild(e);else switch(t.message_type){case"gmail":(e=document.createElement("div")).classList.add("tile-image-gmail"),s(e,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/gmail.svg"),")")}),n.append(e);break;case"youtube":(e=document.createElement("div")).classList.add("tile-image-youtube"),s(e,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/youtube.svg"),")")}),n.append(e);break;case"gdocs":(e=document.createElement("div")).classList.add("tile-image-gdocs"),s(e,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/gdoc.svg"),")")}),n.append(e);break;default:(e=document.createElement("div")).classList.add("tile-image-default"),s(e,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/default-history-icon.svg"),")")}),n.append(e)}n.appendChild(i);var o=document.createElement("img");return o.src=chrome.runtime.getURL("assets/close.svg"),o.classList.add("orbit-history-delete"),n.appendChild(o),n.addEventListener("click",(function(e){e.target==o?r.deleteHistoryItem(t.id,n):(r.sidebar.internalViews.headerView.clearToggle(),r.sidebar.render(null,(function(){return r.sidebar.renderPreviousSession(t,t.session_token)})))})),n.classList.add("history-tile"),n}},{key:"deleteHistoryItem",value:function(t,e){e.remove(),0==this.flexBox.childElementCount&&this.renderEmptyHistory(),chrome.runtime.sendMessage({action:"deleteHistory",id:t},(function(t){}))}},{key:"deleteAllHistory",value:function(){for(;this.flexBox.lastChild;)this.flexBox.removeChild(this.flexBox.lastChild);this.page=1,this.fetchLocked=!1,this.renderEmptyHistory(),chrome.runtime.sendMessage({action:"deleteAllHistory"},(function(t){}))}}],e&&Pt(t.prototype,e),r&&Pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function _t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,a,s=[],c=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,i=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(t,e)||At(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(t){return function(t){if(Array.isArray(t))return Rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||At(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){if(t){if("string"==typeof t)return Rt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rt(t,e):void 0}}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ft(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nt(n.key),n)}}function Nt(t){var e=function(t,e){if("object"!=Ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ot(e)?e:e+""}var Bt=function(){return t=function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=o("img","orbit-settings-selector-icon");a.src=chrome.runtime.getURL("assets/".concat(n,".svg"));var s=o("h3");s.innerText=e;var c=o("div","orbit-settings-selector-top");c.append(a,s);var u=o("div","orbit-settings-options");u.append.apply(u,It(this.buildOptions(r,i))),this.view=o("div","orbit-settings-selector"),this.view.append(c,u)},(e=[{key:"buildOptions",value:function(t,e){for(var r=orbit.config[t],n=[],i=0,a=Object.entries(e);i<a.length;i++){var s=_t(a[i],2),c=s[0],u=s[1],l=o("input");l.type="radio",l.name=t,l.value=c,l.checked=c==r,l.addEventListener("change",this.onInputChanged);var f=o("span");f.innerText=u;var d=o("label");d.append(l,f),n.push(d)}return n}},{key:"onInputChanged",value:function(t){this.checked&&orbit.updateConfig(this.name,this.value)}}])&&Ft(t.prototype,e),r&&Ft(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mt(n.key),n)}}function Mt(t){var e=function(t,e){if("object"!=qt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==qt(e)?e:e+""}var Ut=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e},(e=[{key:"render",value:function(){var t=o("div","orbit-setting-strip-ctn"),e=o("div","orbit-setting-left-section-ctn"),r=o("div","orbit-setting-left-section"),n=document.createElement("div"),i=o("div",this.data.mainIcon);if(s(i,this.data.mainIconStyles),r.appendChild(i),r.appendChild(document.createTextNode(this.data.text)),e.appendChild(r),this.data.isSwitch){var a=o("label","orbit-setting-switch"),c=o("input","orbit-setting-checkbox"),u=o("span","orbit-setting-slider");c.setAttribute("type","checkbox"),a.appendChild(c),a.appendChild(u),n.appendChild(a)}else{var l=o("div",this.data.rearIcon);s(l,this.data.rearIconStyles),n.appendChild(l)}return t.appendChild(e),t.appendChild(n),this.data.callback&&t.addEventListener("click",this.data.callback),t}}])&&zt(t.prototype,e),r&&zt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Vt(t){return Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vt(t)}function Gt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Dt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wt(n.key),n)}}function Wt(t){var e=function(t,e){if("object"!=Vt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Vt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Vt(e)?e:e+""}var Yt=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sidebar=e,this.settingOptionsMeta=[{mainIcon:"orbit-setting-icon-2",mainIconStyles:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/email.svg"),")")},text:"Get in touch",rearIcon:"orbit-setting-rear-icon-1",rearIconStyles:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/right-arrow.svg"),")")},callback:function(){return r.sidebar.render("contact")}},{mainIcon:"orbit-setting-icon-3",mainIconStyles:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/faq.svg"),")")},text:"FAQs",rearIcon:"orbit-setting-rear-icon-2",rearIconStyles:{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/exit-box.svg"),")")},callback:function(){window.open("".concat("https://orbitbymozilla.com/","#faq"),"_blank")}}]},(e=[{key:"renderSettingOptionsCtn",value:function(){var t=this,e=o("div","orbit-setting-options-ctn"),r=new Bt("Orb Format","controlMode","sparkle",{standard:"Dynamic (default)",minimal:"Minimal"}),n=new Bt("Response Format","summaryType","summary-alt",{bullets:"Bullet Points",sentences:"Short Sentences",paragraphs:"Paragraphs"}),i=new Bt("Summary","autoSummarizationType","bill",{never:"Always ask to summarize content.",email:"Auto-summarize email.",youtube:"Auto-summarize YouTube.",email_and_youtube:"Auto-summarize email and YouTube."});e.append(r.view,n.view,i.view,o("div","orbit-setting-divider"));var a,s=Gt(this.settingOptionsMeta);try{for(s.s();!(a=s.n()).done;){var c=a.value;e.appendChild(new Ut(c).render())}}catch(t){s.e(t)}finally{s.f()}if(this.sidebar.userData.email){e.appendChild(o("div","orbit-setting-divider"));var u=o("div","orbit-setting-user-info-ctn");u.appendChild(document.createTextNode("User id: "));var l=o("span","orbit-setting-user-info");l.innerText=this.sidebar.userData.email,u.appendChild(l),e.appendChild(u);var f=o("div","orbit-signout-btn");f.innerText="Sign Out",e.appendChild(f),f.addEventListener("click",(function(){chrome.runtime.sendMessage({action:"signOut"},(function(e){e.ok&&t.sidebar.render("profile")}))}))}var d=o("div","orbit-sign-in-success-msg");return d.innerText="Successfully Signed In.",d.style.opacity=0,e.appendChild(d),e}},{key:"render",value:function(){var t=o("div");s(t,{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 15px 5px",fontWeight:700,fontFamily:"Metropolis, Helvetica, sans-serif"}),t.appendChild(document.createTextNode("Settings")),this.sidebar.page.appendChild(t),this.sidebar.page.appendChild(this.renderSettingOptionsCtn())}}])&&Ht(t.prototype,e),r&&Ht(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function $t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$t=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Kt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(Kt(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Qt(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function Xt(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){Qt(o,n,i,a,s,"next",t)}function s(t){Qt(o,n,i,a,s,"throw",t)}a(void 0)}))}}function Jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zt(n.key),n)}}function Zt(t){var e=function(t,e){if("object"!=Kt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Kt(e)?e:e+""}var te=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.main=o("div"),this.main.id="orbit-side-bar",this.internalViews={headerView:new kt(this),responseView:new P(this),chatView:new at,promptView:new F(this),footerView:new bt(this)},this.altViewTypes={setting:new Yt(this),history:new jt(this),contact:new ht(this)},this.chatController=new V(this.internalViews.promptView,this),this.responseBox=null,this.userData={},this.storedContext=null,this.createInnerElements(),this.postAnimationFollowUpAction=function(){},s(this.main,{width:"".concat(orbit.config.lastKnownWidth,"px"),right:"-".concat(orbit.config.lastKnownWidth,"px")}),this.main.addEventListener("transitionend",(function(t){t.target==e.main&&"right"==t.propertyName&&(e.postAnimationFollowUpAction(),e.postAnimationFollowUpAction=function(){})}))},e=[{key:"pageChanged",value:function(){this.sidebarIsVisible()&&this.closeSidebar()}},{key:"sidebarIsVisible",value:function(){return this.main.classList.contains("sidebar-translated")}},{key:"openSidebar",value:function(){this.main.classList.add("sidebar-translated")}},{key:"closeSidebar",value:function(){var t=this;this.postAnimationFollowUpAction=function(){t.main.dispatchEvent(new CustomEvent("closed"))},this.main.classList.remove("sidebar-translated"),this.resetChatSession(),this.internalViews.headerView.clearToggle()}},{key:"createInnerElements",value:function(){var t=this;this.suggestedPromptsView=o("div"),this.suggestedPromptsView.classList.add("side-bar-title"),this.widthExpander=o("div","orbit-sidebar-expander"),this.widthExpander.style.left="0px",this.page=o("div","orbit-page"),this.page.classList.add("orbit-page-none");var e=function(e){var r=e.movementX,n=parseInt(t.widthExpander.style.left),i=parseInt(t.main.style.width);t.widthExpander.style.left="".concat(n+r,"px");var o=i-r;o<335&&(o=335),orbit.hideSideBarWidth=o,t.main.style.width="".concat(o,"px"),t.main.style.right="-".concat(o,"px")},r=!1;this.widthExpander.addEventListener("mousedown",(function(t){t.preventDefault(),0==t.button&&(r=!0,document.addEventListener("mousemove",e))})),document.addEventListener("mouseup",(function(n){n.preventDefault(),0==n.button&&r&&(r=!1,document.removeEventListener("mousemove",e),t.widthExpander.style.left="0px",orbit.updateConfig("lastKnownWidth",t.main.style.width.replace("px","")))})),this.main.appendChild(this.page),this.main.appendChild(this.widthExpander)}},{key:"build",value:function(t){for(var e in this.internalViews)this.internalViews[e].render(this.page,this.userData,t)}},{key:"clearPage",value:function(){for(var t in this.internalViews)this.internalViews[t].clearAll();for(;this.page.childNodes.length>1;)this.page.removeChild(this.page.lastChild)}},{key:"renderConfirmation",value:function(){var t=this;this.clearPage(),this.internalViews.headerView.render(this.page);var e=o("div"),r=o("div");e.innerText="A confirmation email has been sent, please verify your email.",r.innerText="Back to sign in",r.addEventListener("click",(function(){return t.render("auth")})),s(e,{padding:"10px",fontSize:"14px"}),s(r,{padding:"10px",fontSize:"14px",textDecoration:"underline",cursor:"pointer"}),this.page.appendChild(e),this.page.append(r)}},{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.clearPage(),chrome.runtime.sendMessage({action:"getUserData"},function(){var o=Xt($t().mark((function o(a){return $t().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t.userData=a||{},t.resetChatSession((function(){t.internalViews.headerView.render(t.page,{type:e}),"profile"!=e&&"history"!=e&&"auth"!=e||a.email?t.altViewTypes[e]?t.altViewTypes[e].render(n):(t.build(e),t.eventsBinding()):new Q(t).renderSignin(),r()}),i);case 2:case"end":return o.stop()}}),o)})));return function(t){return o.apply(this,arguments)}}())}},{key:"eventsBinding",value:function(){this.chatViewEvent(),this.navigationEvent()}},{key:"chatViewEvent",value:function(){}},{key:"navigationEvent",value:function(){}},{key:"quickSummarize",value:function(){}},{key:"freeSummarize",value:function(){}},{key:"extractContext",value:function(){}},{key:"extractTitle",value:function(){var t=document.querySelector("h1")?.innerText?.trim();return null!=t&&""!=t||(t=document.querySelector("title").innerText?.trim()),t}},{key:"extractUrlIcon",value:function(){var t=Array.from(document.querySelectorAll('link[rel*="icon"]')).find((function(t){return[".ico","favicon","icon"].some((function(e){return t.href.includes(e)}))}));return t&&t.href}},{key:"renderPreviousSession",value:function(t,e){var r=this;t.chat_log.data.forEach((function(t,e){0!=e&&(e%2==0?r.addServerResponse(t):(t.includes("email_summary_")?t="Summarize the email":t.includes("text_summary_medium")&&t.includes("transcript")?t="Summarize the transcript":t.includes("text_summary_medium")&&(t="Summarize the page"),r.goToResponseView(t)))})),chrome.runtime.sendMessage({action:"reinstateSession",data:{sessionToken:e}})}},{key:"summarizeHighlight",value:function(t,e){var r=this,n={bullets:"Provide a bullet point summary of the text below (text_summary_bullet):",paragraphs:"Provide a detailed summary of the text below (text_summary_detailed):",sentences:"Provide a concise summary of the text below (text_summary_concise):"}[orbit.config.summaryType]||"Provide a summary of the text blow (text_summary_medium):";this.resetChatSession((function(){r.sidebarIsVisible()?(r.render(),r.chatController.userEnteredMessage(n,e,t)):(r.postAnimationFollowUpAction=function(){r.render(),r.chatController.userEnteredMessage(n,e,t)},r.openSidebar())}))}},{key:"addMessageToChat",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.internalViews?.responseView?.appendErrorToChat(t,e,r),"error"==e&&this.main.querySelector(".loading")?.remove()}},{key:"goToResponseView",value:function(t){this.internalViews.chatView.hideSelf(),this.suggestedPromptsView.innerText="CHAT SESSION",this.internalViews.responseView.showSelf(),this.responseBox=this.internalViews.responseView.buildContentBox(t),this.internalViews.responseView.element.scrollTop=this.internalViews.responseView.element.scrollHeight,this.internalViews.headerView.displayButton(),this.internalViews.headerView.clearToggle()}},{key:"addServerResponse",value:function(t){t=t?.trim(),"bullets"===orbit.config.summaryType&&t.startsWith("1")?this.responseBox.replaceChildren(function(t){var e=o("ol","orbit-content-list"),r=t.split("\n").map((function(t){t=t.replace(H,"");var e=o("li");return e.innerText=t,e}));return e.append.apply(e,G(r)),e}(t)):"bullets"===orbit.config.summaryType&&t.includes("*")?this.responseBox.replaceChildren(function(t){var e=o("ul");s(e,{paddingLeft:"20px"});for(var r=t.split("\n").map((function(t){return t.replace("*","")})),n=[],i=0;i<r.length;i++){var a=r[i];if(a.length){var c=document.createElement("li");c.style.paddingBottom="10px",c.innerText=a;var u=1,l=r[i+u];if(l&&l.trimStart().startsWith("+")){var f=document.createElement("ul");for(f.style.paddingLeft="20px",c.appendChild(f);l&&l.trimStart().startsWith("+");){var d=document.createElement("li");d.style.paddingBottom="5px",d.textContent=l.replace("+",""),f.appendChild(d),l=r[i+ ++u]}}i=i+u-1,n.push(c)}}return e.append.apply(e,n),e}(t)):function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&t.replaceChildren(),"paragraphs"==orbit.config.summaryType?t.style.whiteSpace="pre-line":t.style.whiteSpace="normal",t.textContent=e}(this.responseBox,t,!0),this.internalViews.responseView.element.scrollTop=this.internalViews.responseView.element.scrollHeight}},{key:"resetChatSession",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};arguments.length>1&&void 0!==arguments[1]&&arguments[1]?t():chrome.runtime.sendMessage({action:"clearChatSession"},t)}},{key:"openSidebarAndWait",value:(c=Xt($t().mark((function t(){var e,r=this;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Promise((function(t){r.sidebarIsVisible()?t():(r.postAnimationFollowUpAction=t,r.main.classList.add("sidebar-translated"))})),t.abrupt("return",e);case 2:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"navigateToSummary",value:(a=Xt($t().mark((function t(){var e=this;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openSidebarAndWait(),this.render("summarize",(function(){e.quickSummarize()}));case 2:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"navigateToAsk",value:(i=Xt($t().mark((function t(){return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openSidebarAndWait(),this.render("questions"),this.freeSummarize();case 3:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"navigateToSettings",value:(n=Xt($t().mark((function t(){return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openSidebarAndWait(),this.render("setting");case 2:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Jt(t.prototype,e),r&&Jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,a,c}();function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */re=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==ee(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(ee(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ne(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){ne(o,n,i,a,s,"next",t)}function s(t){ne(o,n,i,a,s,"throw",t)}a(void 0)}))}}function oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ae(n.key),n)}}function ae(t){var e=function(t,e){if("object"!=ee(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ee(e)?e:e+""}function se(t,e,r){return e=ue(e),function(t,e){if(e&&("object"==ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ce()?Reflect.construct(e,r||[],ue(t).constructor):e.apply(t,r))}function ce(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ce=function(){return!!t})()}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}function le(t,e){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},le(t,e)}var fe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),se(this,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&le(t,e)}(e,t),r=e,n=[{key:"freeSummarize",value:(a=ie(re().mark((function t(){var e=this;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.runtime.sendMessage({action:"fetchGdocContent",url:window.location.href.replace("edit","mobilebasic")},(function(t){e.storedContext=t}));case 1:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"mapSummaryType",value:function(t){return{bullets:"Provide a bullet point summary of the text below (text_summary_bullet):",paragraphs:"Provide a detailed summary of the text below (text_summary_detailed):",sentences:"Provide a concise summary of the text below (text_summary_concise):"}[t]}},{key:"quickSummarize",value:(o=ie(re().mark((function t(){var e,r=this;return re().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.mapSummaryType(orbit.config.summaryType)||"Summarize the page provided (text_summary_medium):",this.goToResponseView("Summarize the page"),new Promise((function(t){Ke(!0),chrome.runtime.sendMessage({action:"submitMessage",actualPrompt:e,messages:[],title:r.extractTitle(),iconUrl:r.extractUrlIcon(),displayedMessage:"Summarize the page",type:"gdocs",url:window.location.href.replace("edit","mobilebasic")},(function(t){Ke(!1),orbit.previousPrompt=e,orbit.displayedMessage="Summarize the page"}))}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],n&&oe(r.prototype,n),i&&oe(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(te),de=["script","style","link","noscript","iframe","img","video","audio","source","track","canvas","svg","input","button","select","textarea","form","label","fieldset","legend","datalist","output","progress","meter","menu","menuitem","applet","embed","object","param","base","area","map","frame","frameset","noframes","nav","header","footer","#mw-content-text .reflist","#mw-content-text .navbox"];function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,me(n.key),n)}}function me(t){var e=function(t,e){if("object"!=pe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pe(e)?e:e+""}function ye(t,e,r){return e=be(e),function(t,e){if(e&&("object"==pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ve()?Reflect.construct(e,r||[],be(t).constructor):e.apply(t,r))}function ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ve=function(){return!!t})()}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},be(t)}function ge(t,e){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ge(t,e)}var we=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ye(this,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ge(t,e)}(e,t),r=e,(n=[{key:"freeSummarize",value:function(){this.storedContext=this.extractContext()}},{key:"mapSummaryType",value:function(t){return{bullets:"Provide a bullet point summary of the text below (text_summary_bullet):",paragraphs:"Provide a detailed summary of the text below (text_summary_detailed):",sentences:"Provide a concise summary of the text below (text_summary_concise):"}[t]}},{key:"extractContext",value:function(){var t=document.querySelector("body");return t=t.cloneNode(!0),de.concat("orbit-wrapper").forEach((function(e){t.querySelectorAll(e).forEach((function(t){t.remove()}))})),t.innerText.replaceAll("\n","").replace(/\s+/g," ").trim()}},{key:"quickSummarize",value:function(){var t=this.extractContext(),e=this.mapSummaryType(orbit.config.summaryType)||"Summarize the page provided (text_summary_medium):";if(!t)return this.goToResponseView("Unable to extract text from page for summarization"),void this.addServerResponse("");this.chatController.userEnteredMessage(e,t,"Summarize the page")}}])&&he(r.prototype,n),i&&he(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(te);function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Se(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Se=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==xe(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(xe(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function ke(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function Ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ce(n.key),n)}}function Ce(t){var e=function(t,e){if("object"!=xe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xe(e)?e:e+""}function Le(t,e,r){return e=Te(e),function(t,e){if(e&&("object"==xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pe()?Reflect.construct(e,r||[],Te(t).constructor):e.apply(t,r))}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pe=function(){return!!t})()}function Te(t){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Te(t)}function je(t,e){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},je(t,e)}var Oe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Le(this,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(e,t),r=e,n=[{key:"freeSummarize",value:(o=Se().mark((function t(){return Se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chatController.extractEmailContent();case 2:this.storedContext=t.sent,this.storedContext=this.storedContext.join(". ");case 4:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function a(t){ke(i,r,n,a,s,"next",t)}function s(t){ke(i,r,n,a,s,"throw",t)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"quickSummarize",value:function(){this.chatController.syncCurrentEmail()}},{key:"navigationEvent",value:function(){}},{key:"chatViewEvent",value:function(){}}],n&&Ee(r.prototype,n),i&&Ee(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a}(te);function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function Ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ie=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),s=new O(n||[]);return i(a,"_invoke",{value:L(t,r,s)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",p="suspendedYield",h="executing",m="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var k=g.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(i,o,a,s){var c=f(t[i],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_e(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function L(e,r,n){var i=d;return function(o,a){if(i===h)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var u=f(e,r,n);if("normal"===u.type){if(i=n.done?m:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=m,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=f(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_e(e)+" is not iterable")}return b.prototype=g,i(k,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new C(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;j(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ae(t,e,r,n,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}function Re(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function a(t){Ae(o,n,i,a,s,"next",t)}function s(t){Ae(o,n,i,a,s,"throw",t)}a(void 0)}))}}function Fe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ne(n.key),n)}}function Ne(t){var e=function(t,e){if("object"!=_e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_e(e)?e:e+""}function Be(t,e,r){return e=ze(e),function(t,e){if(e&&("object"==_e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qe()?Reflect.construct(e,r||[],ze(t).constructor):e.apply(t,r))}function qe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qe=function(){return!!t})()}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}function Me(t,e){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Me(t,e)}var Ue=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Be(this,e)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Me(t,e)}(e,t),r=e,n=[{key:"freeSummarize",value:(s=Re(Ie().mark((function t(){return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractContext();case 2:this.storedContext=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"mapSummaryType",value:function(t){return{bullets:"Provide a bullet point summary of the transcript below (text_summary_bullet):",paragraphs:"Provide a detailed summary of the transcript below (text_summary_detailed):",sentences:"Provide a concise summary of the transcript below (text_summary_concise):"}[t]}},{key:"extractContext",value:(a=Re(Ie().mark((function t(){var e,r,n;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=document.querySelector("#primary-button.style-scope.ytd-video-description-transcript-section-renderer .yt-spec-touch-feedback-shape__fill"))){t.next=8;break}return e.click(),t.next=5,c("#segments-container yt-formatted-string");case 5:return r=document.querySelectorAll("#segments-container yt-formatted-string"),n=Array.from(r).map((function(t){return t.innerText})).join(" "),t.abrupt("return",n);case 8:return this.addMessageToChat("The video on this page could not be summarized because it lacks a transcript.","info"),t.abrupt("return","");case 10:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"quickSummarize",value:(o=Re(Ie().mark((function t(){var e,r;return Ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extractContext();case 2:if(e=t.sent,r=this.mapSummaryType(orbit.config.summaryType)||"Summarize the transcript below (text_summary_medium):",!e.length){t.next=8;break}this.chatController.userEnteredMessage(r,e,"Summarize the transcript:","youtube"),t.next=11;break;case 8:return this.goToResponseView("Unable to extract text from page for summarization"),this.addServerResponse(""),t.abrupt("return");case 11:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],n&&Fe(r.prototype,n),i&&Fe(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i,o,a,s}(te),Ve=["www.youtube.com","mail.google.com"],Ge=/(\.)(png|jpg|jpeg|gif)$/,De=function(){var t=window.location.href;return Ve.some((function(e){return t.includes(e)}))||Ge.test(t)};function He(){var t=window.location.href;!function(t){if(!t.includes("mail.google.com"))return!1;try{return We.test(t)||Ye.test(t)}catch(t){return!1}}(t)?!function(t){try{return/.*youtube\.com\/watch\?v=.*/.test(t)}catch(t){return!1}}(t)?!function(t){try{return/.*docs.google.com\/document\/.*/.test(t)}catch(t){return!1}}(t)?De()?(orbit.selectors={main:"body"},orbit.type="blocked",orbit.SideBarClass=we):(orbit.selectors={main:"body"},orbit.type="generic",orbit.SideBarClass=we):(orbit.selectors={main:"body"},orbit.type="googledoc",orbit.SideBarClass=fe):(orbit.selectors={main:"body"},orbit.type="youtube",orbit.SideBarClass=Ue):(orbit.selectors=y,orbit.type="gmail",orbit.SideBarClass=Oe)}var We=/#(inbox|all|starred|sent|imp|trash)\/[\w\d]+?/,Ye=/#(label|category|search)\/.+\/[\w\d]+?/;function Ke(t){t&&(t="disabled");var e=orbit.querySelector(".orbit-prompt"),r=orbit.querySelector(".send-prompt-btn"),n=orbit.querySelector(".orbit-suggested-prompt-ctn"),i=orbit.querySelector(".orbit-cancel-prompt-btn-ctn"),o=orbit.querySelector(".orbit-response");e&&(e.disabled=t),r&&(r.disabled=t),i&&!t&&(i.style.display="none",o.classList.remove("collapsed")),n&&!t?(n.classList.remove("notclickable"),n.classList.remove("hidden"),orbit.querySelector(".orbit-question-generating")?.classList?.remove("orbit-question-generating")):n&&t&&n.classList.add("notclickable")}function $e(){var t,e=document.querySelector("link#embedded_data_iframe");e&&(t=e.dataset.recordedSrc.split("%22")[3]),e=document.getElementById(":2i"),!t&&e&&(t=e.href&&e.href.split("ik=")[1].split("&")[0]);var r="https://mail.google.com/mail/u/".concat(window.location.href.split("/")[5],"/?ik=").concat(t,"&view=pt&search=all&");return console.info("baseUrl",r),r}function Qe(t){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Je(n.key),n)}}function Je(t){var e=function(t,e){if("object"!=Qe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qe(e)?e:e+""}var Ze=function(){return t=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.main={},this.imgctn={},this.img={},this.textName=r,this.cb=n},(e=[{key:"buildInternalComponents",value:function(){this.textBubble=document.createElement("div"),this.textBubble.innerText=this.textName,this.textBubble.classList.add("orbit-expander-text-bubble"),this.textBubble.innerText=this.textName,this.imgctn.appendChild(this.img),this.main.appendChild(this.imgctn),this.main.appendChild(this.textBubble),this.main.addEventListener("click",this.cb)}}])&&Xe(t.prototype,e),r&&Xe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function tr(t){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(t)}function er(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rr(n.key),n)}}function rr(t){var e=function(t,e){if("object"!=tr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==tr(e)?e:e+""}function nr(t,e,r){return e=or(e),function(t,e){if(e&&("object"==tr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ir()?Reflect.construct(e,r||[],or(t).constructor):e.apply(t,r))}function ir(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ir=function(){return!!t})()}function or(t){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},or(t)}function ar(t,e){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ar(t,e)}var sr=function(t){function e(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=nr(this,e,[t,r,o])).main=document.createElement("div"),n.main.classList.add("expander-item-t1"),n.main.classList.add("expander-".concat(t)),n.imgctn=document.createElement("div"),n.imgctn.classList.add("expander-item-t1-img-ctn"),n.img=document.createElement("div"),n.img.classList.add("expander-item-t1-img"),n.img.classList.add("expander-".concat(t,"-img")),s(n.img,i),n.buildInternalComponents(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(e,t),r=e,n&&er(r.prototype,n),i&&er(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ze);function cr(t){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cr(t)}function ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lr(n.key),n)}}function lr(t){var e=function(t,e){if("object"!=cr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==cr(e)?e:e+""}function fr(t,e,r){return e=pr(e),function(t,e){if(e&&("object"==cr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dr()?Reflect.construct(e,r||[],pr(t).constructor):e.apply(t,r))}function dr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(dr=function(){return!!t})()}function pr(t){return pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pr(t)}function hr(t,e){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hr(t,e)}var mr=function(t){function e(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=fr(this,e,[t,r,o])).main=document.createElement("div"),n.main.classList.add("expander-item-t2"),n.main.classList.add("expander-".concat(t)),n.imgctn=document.createElement("div"),n.imgctn.classList.add("expander-item-t2-img-ctn"),n.img=document.createElement("div"),n.img.classList.add("expander-item-t2-img"),n.img.classList.add("expander-".concat(t,"-img")),s(n.img,i),n.buildInternalComponents(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hr(t,e)}(e,t),r=e,(n=[{key:"addClassToImgCtn",value:function(t){this.imgctn.classList.add(t)}},{key:"addClassToImg",value:function(t){this.img.classList.add(t)}}])&&ur(r.prototype,n),i&&ur(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(Ze);function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function vr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,br(n.key),n)}}function br(t){var e=function(t,e){if("object"!=yr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yr(e)?e:e+""}var gr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=o("div","orbit-expander"),this.expanderIconBorder=o("div","icon-ctn-border"),this.expanderIconCtn=o("div","icon-ctn"),this.expanderIcon=o("div","icon"),this.expanderPaths=o("div","path-icon"),this.expanderIconCtn.appendChild(this.expanderIcon),this.expanderIconBorder.appendChild(this.expanderIconCtn),this.view.appendChild(this.expanderIconBorder),this.view.appendChild(this.expanderPaths),this.view.classList.add("orbit-expander-login-disabled"),s(this.expanderIcon,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/orbit.gif"))}),s(this.expanderPaths,{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/Orbit-Lines.svg"))}),s(this.view,{top:"50px",left:"-200px"}),this.expanderEvent(),this.appendItems()},e=[{key:"show",value:function(){this.view.style.display=""}},{key:"hide",value:function(){this.view.style.display="none"}},{key:"createItemOne",value:function(){var t=this,e=new sr("summarize","Summarize",{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/summary.svg"))},(function(){t.view.dispatchEvent(new CustomEvent("navigate",{detail:"summarize"}))}));this.view.appendChild(e.main)}},{key:"createItemTwo",value:function(){var t=this,e=new sr("question","Ask Orbit",{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/questions.svg"))},(function(){t.view.dispatchEvent(new CustomEvent("navigate",{detail:"ask"}))}));this.view.appendChild(e.main)}},{key:"createItemThree",value:function(){var t=this,e=new mr("history","History",{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/history.svg"))},(function(){t.view.dispatchEvent(new CustomEvent("navigate",{detail:"history"}))}));this.view.appendChild(e.main)}},{key:"createItemFour",value:function(){var t=this,e=new mr("settings","Settings",{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/settings.svg"))},(function(){t.view.dispatchEvent(new CustomEvent("navigate",{detail:"settings"}))}));this.view.appendChild(e.main)}},{key:"createItemFive",value:function(){var t=new mr("snooze","Snooze Orbit",{backgroundImage:"url(".concat(chrome.runtime.getURL("assets/snooze.svg"))},(function(){orbit.updateConfig("isEnabled",!1)}));t.addClassToImgCtn("orbit-snooze-img-ctn"),t.addClassToImg("orbit-snooze-img"),this.view.appendChild(t.main)}},{key:"appendItems",value:function(){this.createItemOne(),this.createItemTwo(),this.createItemFour(),this.createItemFive()}},{key:"expanderEvent",value:function(){var t=this;orbit.config.lastKnownLocation&&(this.view.style.top=orbit.config.lastKnownLocation.top,this.view.style.left=orbit.config.lastKnownLocation.left);var e=function(e){var r=e.movementX,n=e.movementY,i=parseInt(t.view.style.left),o=parseInt(t.view.style.top);t.view.style.left="".concat(i+r,"px"),t.view.style.top="".concat(o+n,"px")},r=!1;this.view.addEventListener("mousedown",(function(n){n.preventDefault(),0==n.button&&(r=!0,t.view.style.cursor="grab",document.addEventListener("mousemove",e))})),document.addEventListener("mouseup",(function(n){if(n.preventDefault(),0==n.button&&r){r=!1,t.view.style.cursor="",document.removeEventListener("mousemove",e);var i=parseInt(t.view.style.top.replace("px",""),10)>50?t.view.style.top:"50px";orbit.updateConfig("lastKnownLocation",{left:t.view.style.left,top:i})}}))}}],e&&vr(t.prototype,e),r&&vr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function wr(t){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(t)}function xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sr(n.key),n)}}function Sr(t){var e=function(t,e){if("object"!=wr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wr(e)?e:e+""}var kr=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastKnownPosition=e||400,this.isCurrentlyHovering=!1,this.view=o("div","orbit-fab-container"),this.view.style.bottom="".concat(this.lastKnownPosition,"px"),this.fab=o("div","orbit-fab"),this.fab.append(this.buildControls()),this.view.append(this.fab);var n=this;this.checkHoverStatus=i((function(){n.isCurrentlyDragging||(n.isCurrentlyHovering?n.expand():n.close())}),250),this.view.addEventListener("mouseenter",(function(t){return r.onMouseEnter(t)})),this.view.addEventListener("mouseleave",(function(t){return r.onMouseLeave(t)})),addEventListener("resize",(function(t){return r.onWindowResize(t)}))},e=[{key:"buildControls",value:function(){var t=this,e=this.buildControl("questions-alt","Ask Orbit a question","ask",-28,20),r=this.buildControl("summary-alt","Summarize this page","summarize",0,16),n=o("div","orbit-fab-seperator"),i=o("img","orbit-fab-orb");i.src=chrome.runtime.getURL("assets/orb.svg");var a=o("div","orbit-fab-grabber");a.style.backgroundImage="url(".concat(chrome.runtime.getURL("assets/grabber.svg"),")"),a.addEventListener("mousedown",(function(e){return t.startDrag(e)}));var s=o("div","orbit-fab-controls");return s.append(e,r,n,i,a),s}},{key:"buildControl",value:function(t,e,r,n,i){var a=this,s=o("div","orbit-fab-tooltip");s.innerText=e,s.style.left="".concat(n,"px");var c=chrome.runtime.getURL("assets/".concat(t,".svg")),u=o("div","orbit-fab-action");return u.style.backgroundImage="url(".concat(c,")"),u.style.backgroundSize="24px ".concat(i,"px"),u.addEventListener("click",(function(){a.view.dispatchEvent(new CustomEvent("navigate",{detail:r}))})),u.addEventListener("mouseenter",(function(){a.view.append(s),s.classList.add("visible")})),u.addEventListener("mouseleave",(function(){s.classList.remove("visible")})),u}},{key:"startDrag",value:function(t){var e=this;if(t.preventDefault(),0==t.button){this.view.classList.add("dragging"),this.isCurrentlyDragging=!0;var r=function(t){e.updatePosition(t.clientY)},n=function(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n),e.view.classList.remove("dragging"),e.isCurrentlyDragging=!1,e.checkHoverStatus.call(),orbit.fabPosition=e.lastKnownPosition,chrome.runtime.sendMessage({action:"saveConfig",key:"fabPosition",value:e.lastKnownPosition})};document.addEventListener("mousemove",r),document.addEventListener("mouseup",n)}}},{key:"updatePosition",value:function(t){var e=this.view.offsetHeight,r=innerHeight,n=r-e,i=r-t-e/2;i>n?i=n:i<0&&(i=0),this.view.style.bottom="".concat(i,"px"),this.lastKnownPosition=i}},{key:"onMouseEnter",value:function(t){t.preventDefault(),this.isCurrentlyHovering=!0,this.checkHoverStatus.call()}},{key:"onMouseLeave",value:function(t){t.preventDefault(),this.isCurrentlyHovering=!1,this.checkHoverStatus.call()}},{key:"onWindowResize",value:function(t){if(window.innerHeight-this.view.offsetHeight<this.lastKnownPosition){var e=window.innerHeight-this.view.offsetHeight;this.lastKnownPosition=e,this.view.style.bottom="".concat(e,"px")}}},{key:"expand",value:function(){this.fab.classList.add("orbit-fab-expanded")}},{key:"close",value:function(){this.fab.classList.remove("orbit-fab-expanded")}},{key:"show",value:function(){this.view.style.display=""}},{key:"hide",value:function(){this.view.style.display="none"}}],e&&xr(t.prototype,e),r&&xr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Er(t){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(t)}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lr(n.key),n)}}function Lr(t){var e=function(t,e){if("object"!=Er(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Er(e)?e:e+""}var Pr=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.sidebar=new m((function(){return r.buildSidebar()})),this.control=new m((function(){return r.buildControl()})),this.autoSummarize=i((function(){return r.handleNavigation({detail:"summarize"})}),1e3)},e=[{key:"buildSidebar",value:function(){var t=this,e=new this.SideBarClass;return e.main.addEventListener("closed",(function(e){return t.handleSidebarClosed(e)})),e}},{key:"buildControl",value:function(){var t,e=this;return(t="minimal"==this.config.controlMode?new kr(this.config.fabPosition):new gr).view.addEventListener("navigate",(function(t){return e.handleNavigation(t)})),t}},{key:"updateConfig",value:function(t,e){chrome.runtime.sendMessage({action:"saveConfig",key:t,value:e})}},{key:"handleConfigUpdated",value:function(t,e){this.config[t]=e,"controlMode"==t?this.config.isEnabled&&!this.sidebar.isVisible&&(this.teardown(),this.shouldRenderOnPage()&&this.control.show()):"isEnabled"==t&&(this.teardown(),e&&this.shouldRenderOnPage()&&this.control.show())}},{key:"handleSidebarClosed",value:function(t){this.sidebar.hide(),this.config.isEnabled&&"blocked"!=orbit.type&&this.config.agreedToPrivacyPolicy&&this.control.show()}},{key:"handleNavigation",value:function(t){var e=this;if(!this.config.agreedToPrivacyPolicy)return!1;switch(t.detail){case"summarize":this.control.hide(),this.sidebar.show(),setTimeout((function(){return e.sidebar.view.navigateToSummary()}),50);break;case"ask":this.control.hide(),this.sidebar.show(),setTimeout((function(){return e.sidebar.view.navigateToAsk()}),50);break;case"settings":this.control.hide(),this.sidebar.show(),setTimeout((function(){return e.sidebar.view.navigateToSettings()}),50);break;default:console.error("Unexpected navigation location ".concat(t.detail))}}},{key:"handleUrlUpdated",value:function(){this.teardown(),He(),this.shouldRenderOnPage()&&(this.shouldAutoSummarize()?this.autoSummarize.call():this.showControl())}},{key:"shouldAutoSummarize",value:function(){return!!(this.config.autoSummarizationType&&(this.config.autoSummarizationType.includes("email")&&"gmail"==this.type||this.config.autoSummarizationType.includes("youtube")&&"youtube"==this.type))}},{key:"shouldRenderOnPage",value:function(){return!(!this.config.agreedToPrivacyPolicy||!this.config.isEnabled||De()&&"gmail"!=this.type&&"youtube"!=this.type)}},{key:"showControl",value:function(){this.sidebar.hide(),this.control.show()}},{key:"teardown",value:function(){this.autoSummarize.cancel(),this.sidebar.hide(),this.control.hide()}},{key:"querySelector",value:function(t){return this.sidebar?.root?.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.sidebar?.root?.querySelectorAll(t)}}],e&&Cr(t.prototype,e),r&&Cr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();var Tr=["message"];!function(){var t=chrome.runtime.getURL("fonts/Metropolis-Regular.otf"),e=new FontFace("Metropolis",'local("Metropolis"), url('.concat(t,") format('opentype')"),{style:"normal",weight:"500"});document.fonts.add(e);var r=chrome.runtime.getURL("fonts/Metropolis-Medium.otf"),n=new FontFace("Metropolis",'local("Metropolis"), url('.concat(r,") format('opentype')"),{style:"normal",weight:"600"});document.fonts.add(n);var i=chrome.runtime.getURL("fonts/Metropolis-Bold.otf"),o=new FontFace("Metropolis",'local("Metropolis"), url('.concat(i,") format('opentype')"),{style:"normal",weight:"700"});document.fonts.add(o);var a=chrome.runtime.getURL("fonts/ClashDisplay-Medium.otf"),s=new FontFace("ClashDisplay",'local("ClashDisplay"), url('.concat(a,") format('opentype')"),{style:"normal",weight:"500"});document.fonts.add(s)}();chrome.runtime.onMessage.addListener((function(t,e,r){switch(t.message){case"startup":document.querySelectorAll('div[id^="orbit-wrapper"]').forEach((function(t){t.remove()})),document.querySelectorAll("orbit-wrapper").forEach((function(t){t.remove()}));t.message;var i=function(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}(t,Tr);window.orbit=new Pr(i),He(),orbit.shouldRenderOnPage()&&c(orbit.selectors.main).then((function(){orbit.shouldAutoSummarize()?orbit.autoSummarize.call():orbit.showControl()}));break;case"updatedUrl":orbit.handleUrlUpdated();break;case"responseStream":if(orbit&&orbit.sidebar.view){orbit.sidebar.view.addServerResponse(t.text);var o=orbit.querySelector(".orbit-cancel-prompt-btn-ctn"),a=orbit.querySelector(".orbit-response");o.style.display="flex",a.classList.add("collapsed")}break;case"orbit-summarize-highlight":orbit.control.hide(),orbit.sidebar.show(),orbit.sidebar.view.render("summarize",(function(){orbit.sidebar.view.summarizeHighlight(t.prompt,t.text)}));break;case"renderAlertMessage":orbit.sidebar.view?.addMessageToChat(t.text,t.mode,t.body);break;case"enableSuggestedPrompt":var s=orbit.querySelector(".orbit-suggested-prompt-ctn"),u=orbit.querySelector(".orbit-prompt");s&&u&&s.classList.contains("notclickable")&&!u.disabled&&(s.classList.remove("notclickable"),s.classList.remove("hidden"));break;case"agreedToPrivacyPolicy":orbit.config[n]=!0,orbit.showControl();break;case"configUpdated":orbit.handleConfigUpdated(t.key,t.value);break;case"navigate":orbit.handleNavigation({detail:t.page});break;case"handleWebsocketErrorCode":var l=function(t,e){if("DATA_TRUNCATED"==t)return"This ".concat("youtube"==e?"video transcript":"gmail"==e?"email":"page"," is a bit too large for Orbit. Therefore some context could be missing from my responses.");return console.info("Encountered unexpected error code ".concat(t," for page type ").concat(e,"!")),null}(t.code,orbit.type);l&&orbit.sidebar.view?.addMessageToChat(l,"info")}})),chrome.runtime.sendMessage({action:"startup"})})();
//# sourceMappingURL=maps/content.js.map