"use strict";(self.webpackChunk_dashlane_amphora=self.webpackChunk_dashlane_amphora||[]).push([[786],{3204:(e,t,a)=>{a.d(t,{R:()=>Ne});var r=a(52357),n=a(14676),i=a(66706),o=a(36282),s=a(68754),c=a(97203),l=a(25593),u=a(6538),d=a(62048),p=a(61582),m=a(95940),w=a(87581),g=a(29390),y=a(94152),b=a(54416),h=a(20246),f=a(54070),S=a(96023),A=a(21738),C=a(88170),I=a(89742),T=a(8504),k=a(25252),M=a(26430),P=a(70063),E=a(33538),v=a(65862),N=a(9176),R=a(38435),D=a(98768),F=a(67053),L=a(10839),U=a(56979),B=a(98716),G=a(32671),x=a(85324),V=a(95322),O=a(92169),W=a(70433),Y=a(20281),_=a(96124),K=a(53234),H=a(81042),q=a(55257),j=a(57842),z=a(11526),Z=a(78443),J=a(26131),$=a(70814),Q=a(76392),X=a(97376),ee=a(72788),te=a(48666),ae=a(27006),re=a(50691),ne=a(58164),ie=a(35475),oe=a(11512),se=a(831),ce=a(65342),le=a(11712),ue=a(5574),de=a(23297),pe=a(32446),me=a(74650),we=a(59965),ge=a(4166),ye=a(58563),be=a(35463),he=a(97111),fe=a(67051),Se=a(12892),Ae=a(20691),Ce=a(35936),Ie=a(66811),Te=a(57978),ke=a(47071),Me=a(52862),Pe=a(77404),Ee=a(70366);const ve="background",Ne=(0,r.t)(ve,[]).with({module:n.W,on:ve}).with({module:i.H,on:ve}).with({module:o.M,on:ve}).with({module:S.K,on:ve}).with({module:h.y,on:ve}).with({module:f.m,on:ve}).with({module:s.d,on:ve}).with({module:d.a,on:ve}).with({module:p.X,on:ve}).with({module:A.V,on:ve}).with({module:C.F,on:ve}).with({module:I.i,on:ve}).with({module:T.M,on:ve}).with({module:F.c,on:ve}).with({module:L._,on:ve}).with({module:U.V,on:ve}).with({module:B.I,on:ve}).with({module:G.Y,on:ve}).with({module:x.G,on:ve}).with({module:m.t,on:ve}).with({module:w.A,on:ve}).with({module:g.k,on:ve}).with({module:fe.J,on:ve}).with({module:D.r,on:ve}).with({module:O.B,on:ve}).with({module:c.f,on:ve}).with({module:W.L,on:ve}).with({module:Y.R,on:ve}).with({module:_.v,on:ve}).with({module:K.e,on:ve}).with({module:H.e,on:ve}).with({module:q.Z,on:ve}).with({module:J.g,on:ve}).with({module:$.i,on:ve}).with({module:l.J,on:ve}).with({module:u.i,on:ve}).with({module:se.J,on:ve}).with({module:z.D,on:ve}).with({module:Z.j,on:ve}).with({module:ue.Yu,on:ve}).with({module:v.Q,on:ve}).with({module:ee.L,on:ve}).with({module:te.o,on:ve}).with({module:ae.K,on:ve}).with({module:re.a,on:ve}).with({module:de.cV,on:ve}).with({module:le.B,on:ve}).with({module:N.v,on:ve}).with({module:ne.t,on:ve}).with({module:ie.B,on:ve}).with({module:ce.y,on:ve}).with({module:R.Y,on:ve}).with({module:Se.d,on:ve}).with({module:Ae.N,on:ve}).with({module:Ce.l,on:ve}).with({module:ke.U,on:ve}).with({module:k.G,on:ve}).with({module:pe.Dm,on:ve}).with({module:me.J,on:ve}).with({module:j.z,on:ve}).with({module:Ie.X,on:ve}).with({module:M.n,on:ve}).with({module:P.n,on:ve}).with({module:E.c,on:ve}).with({module:Q.v,on:ve}).with({module:Pe.c,on:ve}).with({module:oe.t,on:ve}).with({module:X.R,on:ve}).with({module:we.T,on:ve}).with({module:ge.L,on:ve}).with({module:ye.a,on:ve}).with({module:Me.d,on:ve}).with({module:Te.v,on:ve}).with({module:be.m,on:ve}).with({module:V.a,on:ve}).with({module:he.Z,on:ve}).with({module:y.X,on:ve}).with({module:b.m,on:ve}).with({module:Ee.y,on:ve}).define()},3091:(e,t,a)=>{a.d(t,{Ps:()=>I,B5:()=>Xi,sr:()=>io});var r=a(97143),n=a(99325),i=a(28136),o=a(96754),s=a(19523),c=a(99743),l=a(32412),u=a(6523),d=a(6721),p=a(87163),m=a(23647),w=a(51314),g=a(70101),y=a(71751),b=a(98057),h=a(88456),f=a(23454),S=a(13135),A=a(15349),C=a(92602);class I{getBrowserApi(){return this.browserApi}constructor(){(0,r._)(this,"browserApi",void 0),this.browserApi={action:{openPopup:n.M},runtime:{connect:i.$,getURL:o.A,onConnect:s.b,onMessage:c.p,sendMessage:l.b},storage:{local:{get:u.U,set:d.t}},tabs:{create:p.U,sendMessage:m.b,onHighlighted:w.r,onRemoved:g.$,query:y.I},webRequest:{onAuthRequired:b.E,onCompleted:h.x,onErrorOccurred:f.z},contextMenus:{onClicked:S.a,create:A.U,removeAll:C.x},crypto}}}var T=a(91459),k=a(45429),M=a(28034);const P=(e,t,a,r,n)=>{const i=e instanceof Error?e.message:String(e),o=e instanceof Error?e.stack:n.precisions,s=[n.message,i].filter((e=>void 0!==e)).join(" - ");a.carbon.logException({exceptionType:t,log:{...n,message:s,precisions:o}})};const E=e=>Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter((e=>"constructor"!==e));var v=function(e){return e.Action="autofill-engine-action",e.Command="autofill-engine-command",e}({});var N=function(e){return e.SenderFrame="SenderFrame",e.MainFrame="MainFrame",e.AllFrames="AllFrames",e}({});const R=E(new class{showWebcard(e){}updateWebcard(e){}updateWebcardItems(e,t){}updateWebcardItemDetails(e,t,a){}updateWebcardCredentialsAtRisk(e){}closeWebcard(e){}updateAutofillRecipes(e){}updateUnrecognizedElements(e){}computeContextMenuTargetInfo(e){}updateClientFrameId(e){}updateDomainAnalysisStatus(e){}applyAutofillOperations(e){}applyAutofillOperationsAndTriggerDataCapture(e){}setMasterPasswordValidationResult(e){}setPinCodeValidationResult(e){}updateTabActiveInfo(e){}updateUserLoginStatus(e){}updateUserFeatureFlips(e){}updateNewPassword(e,t){}updateSavePasswordTargetCredential(e,t){}updateSavePasswordCapturedData(e,t,a,r){}disableDashlaneOnField(e){}subscribeLiveValuesUpdate(e,t){}updateUserSubscriptionCode(e){}updateWebAuthnChallenge(e){}updateWebAuthnStatus(e){}updatePaymentUpdateAuthenticationToken(e){}webauthnCreateResponse(e,t){}webauthnGetResponse(e,t){}webauthnUseFallback(e){}webauthnStoreConditionalUiRequest(e){}webauthnConditionalUiSupported(e){}dataCopiedAlert(e,t,a,r){}copyValueToClipboard(e){}resendAnalysisResults(){}permissionToPaste(e){}storeFollowUpNotificationItemId(e){}}),D=e=>{const t={};for(const a of R)t[a]=(t,...r)=>e({messageType:v.Action,action:a,parameters:r},t);return t};var F=function(e){return e.Success="success",e.Failure="failure",e}({});const L=E(new class{analysisResultsAvailable(e){}documentComplete(){}userFocusOnElement(e){}userRightClickOnElement(e){}applyAutofillRecipe(e){}applyAutofillRecipeForOtherDataSource(e){}logAutofillPerformedEvent(e){}disableReactivationWebcards(){}startWebAuthnLoginFlow(){}completeWebAuthnLoginFlow(e,t){}startWebAuthnUserVerificationFlow(){}validateWebAuthnUserVerificationFlow(e){}generateNewPassword(e){}validateMasterPassword(e){}validatePinCode(e){}resetProtectedItemsTimerAndApplyRecipe(e){}disableAccessProtectionForVaultItem(e){}userVerificationComplete(e,t,a,r){}webcardClosed(e){}saveCredential(e,t){}updateCredential(e,t){}savePersonalData(e){}cancelSaveCredential(){}findSavePasswordTargetCredential(e,t){}captureDataFromPage(e,t){}applySelfCorrectingAutofill(e,t){}disableDashlaneOnField(e,t){}notifyLiveValuesUpdate(e,t){}logEvent(e){}logPageView(e){}logException(e,t){}getUserSubscriptionCode(){}getUserFeatureFlips(){}openNewTabWithUrl(e){}openWebapp(e){}openPopup(e){}logFormSubmit(e,t){}requestPaymentUpdateAuthenticationToken(){}webauthnCreate(e){}webauthnCreateUserConfirmed(e,t){}webauthnGet(e){}webauthnGetUserConfirmed(e,t,a){}webauthnUseOtherAuthenticator(e){}webauthnUserCanceled(e){}webauthnIsConditionalUiSupported(){}logRightClickMenu(e){}queryVaultItems(e,t){}getVaultItemDetails(e,t){}getCredentialsAtRiskByIds(e){}dataCopiedToClipboardDetected(e,t,a){}dataPasteDetected(e,t,a){}copyToClipboard(e,t,a,r){}signalPasteDecision(e,t){}webcardItemSelected(e,t,a){}removeLinkedWebsite(e,t){}sendPropertyCopiedActivityLog(e){}});class U{storePort(e){this._ports.push(e)}removePort(e){this._ports=this._ports.filter((t=>t!==e))}getPorts(e,t){return this._ports.filter((a=>a.sender?.tab?.id===e&&(!t||t===a.sender.frameId)))}constructor(){(0,r._)(this,"_ports",[])}}var B=a(41707);const G={openNewTabWithUrl:async(e,t,a,r)=>{await e.browserApi.tabs.create({url:r})},openWebapp:async(e,t,a,r)=>{await(0,B.b)(r)},openPopup:async(e,t,a,r)=>{try{await e.browserApi.action.openPopup(r)}catch(e){await(0,B.b)({})}}};var x=function(e){return e.Injected="injected",e.Webcards="webcards",e.Popup="popup",e}({}),V=a(48062);var O=a(78776),W=a(59664),Y=a(30812),_=a(63433),K=a(78346),H=a(37470),q=a(60399);async function j(e){const t=await(0,q.z)(e.grapheneClient.featureFlips.queries.userFeatureFlips());if((0,K.hx)(t))throw new Error("error in `fetchFeatureFlips`: "+t.error);return(0,K.db)(t)}async function z(e,t){const a=await(0,q.z)(e.grapheneClient.featureFlips.queries.userFeatureFlip({featureFlip:t}));if((0,K.hx)(a))throw new Error("error in `hasFeatureFlip`: "+a.error);return(0,K.db)(a)??!1}async function Z(e){return await z(e,_.S.PasskeySupport)}const J=async e=>await z(e,_.S.SharedCollectionInSaveWebcard);const $=(e,t,a=!0)=>((e,t,a,r)=>({log_type:e,category:t,date_time:(new Date).getTime(),schema_version:"1.0.0",is_sensitive:r,uuid:(0,O.Z)().toUpperCase(),properties:a}))(e,W.s.ItemUsage,t,a),Q={[Y.k.Credential]:W.b.UserCopiedCredentialField,[Y.k.BankAccount]:W.b.UserCopiedBankAccountField,[Y.k.PaymentCard]:W.b.UserCopiedCreditCardField},X=e=>{if(!e.message.includes("TIMED_OUT"))throw e},ee={logEvent:async(e,t,a,r)=>{await e.connectors.carbon.logEvent({event:r}).catch(X)},logPageView:async(e,t,a,r)=>{await e.connectors.carbon.logPageView(r).catch(X)},logException:(e,t,a,r,n)=>{const i={[x.Injected]:"injectedtsException",[x.Webcards]:"webcardsException",[x.Popup]:"popupException"};return P(n.message,i[r],e.connectors,0,{precisions:n.precisions,additionalInfo:n.additionalInfo}),Promise.resolve()},sendPropertyCopiedActivityLog:async(e,t,a,r)=>{const n=await async function(e){return await z(e,_.S.FunAuditLogs)}(e.connectors),i=await e.connectors.carbon.getNodePremiumStatus();if(n&&i.b2bStatus?.currentTeam){const t=Q[r.itemType];let a;switch(t){case W.b.UserCopiedCredentialField:a=$(t,{field:r.field,credential_domain:r.title,credential_login:r.login??""});break;case W.b.UserCopiedBankAccountField:case W.b.UserCopiedCreditCardField:a=$(t,{field:r.field,name:r.title});break;default:throw new Error("sendPropertyCopiedActivityLogHandler: unknown log type")}await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[a]})}},logFormSubmit:async(e,t,a,r,n)=>{if(!a.tab?.url||!a.url)return;if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;const i=new V.UserAutofillSubmitFormEvent({...r,fieldsFilledBy:{...r.fieldsFilledBy,manually_typed_count:r.fieldsFilledBy.manually_typed_count}}),o=new V.AnonymousAutofillSubmitFormEvent({...i,domain:{type:V.DomainType.Web,id:await(0,V.hashDomain)(n.domain)}});await e.connectors.carbon.logEvent({event:i}),await e.connectors.carbon.logEvent({event:o})},logRightClickMenu:async(e,t,a,r)=>{if(!a.tab?.url||!a.url)return;const{isRightClickMenuLive:n}=await e.state.global.get();if(!n)return;const{isFieldDetectedByAnalysisEngine:i,domain:o}=r,s={isFieldDetectedByAnalysisEngine:i,rightClickMenuFlowStep:V.RightClickMenuFlowStep.DisplayMenu},c=new V.UserRightClickMenuActionEvent(s),l=new V.AnonymousRightClickMenuActionEvent({...s,domain:{type:V.DomainType.Web,id:await(0,V.hashDomain)(o)},isNativeApp:!1});await e.connectors.carbon.logEvent({event:c}),await e.connectors.carbon.logEvent({event:l}),await e.connectors.carbon.logPageView({pageView:V.PageView.RightClickMenu,browseComponent:void 0})}};var te=a(16575);const ae={getUserSubscriptionCode:async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn){const a=await(0,te.O)(e.connectors.grapheneClient.subscriptionCode.queries.getSubscriptionCode());t.updateUserSubscriptionCode(N.SenderFrame,(0,K.d6)(a)?a.data:"")}},getUserFeatureFlips:async(e,t)=>{let a={};const{loggedIn:r}=await e.connectors.carbon.getUserLoginStatus();r&&(a=await j(e.connectors)),t.updateUserFeatureFlips(N.SenderFrame,a)}},re=async(e,t)=>{const a=(await e.state.tab.get()).persistentWebcards??{};return!Object.keys(a).some((e=>a[e].webcardType===t))},ne=async(e,t,a)=>{const r=await e.state.tab.get();return!!await re(e,a.webcardType)&&(await e.state.tab.set({...r,persistentWebcards:{...r.persistentWebcards,[a.webcardId]:a}}),t.showWebcard(N.MainFrame,a),!0)},ie=async(e,t)=>{const a=await e.state.tab.get();if(a.persistentWebcards){const{persistentWebcards:r,...n}=a,{[t]:i,...o}=r;i&&await e.state.tab.set({...n,persistentWebcards:{...o}})}},oe={webcardClosed:async(e,t,a,r)=>{await ie(e,r)}};var se=a(23501),ce=a(4427),le=a(59327),ue=a(30309),de=a(13134);const pe=e=>(0,se.Wm)(e.type);var me=function(e){return e.Fill="fill",e.Click="click",e}({}),we=function(e){return e.Automatic="automatic",e.Webcard="webcard",e.UserAppliedAutofillCorrection="autofillCorrection",e}({});const ge=e=>{return t=e.dataSource,(0,se.Wm)(t.type);var t},ye=e=>{return t=e.dataSource,(0,se.$b)(t.type);var t};var be=function(e){return e.TemporarilyDisable="temporarilyDisable",e.PermanentlyDisable="permanentlyDisable",e}({});const he={billing:{},change_password:{password:[{extraValues:[],source:{[Y.k.Credential]:"password"}},{extraValues:["new"],source:{[se.JV.NewPassword]:se.JV.NewPassword}},{extraValues:["confirmation"],source:{[se.JV.NewPassword]:se.JV.NewPassword}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}]},contact:{email:[{extraValues:[],source:{[Y.k.Credential]:"email",[Y.k.Email]:"email"}}]},default:{address:[{extraValues:[],source:{[Y.k.Address]:"addressFull"}},{extraValues:["extra"],source:{}},{extraValues:["zip"],source:{[Y.k.Address]:"zipCode"}},{extraValues:["city"],source:{[Y.k.Address]:"city"}},{extraValues:["country"],source:{[Y.k.Address]:"country"}},{extraValues:["region"],source:{[Y.k.Address]:"state"}},{extraValues:["department"],source:{[Y.k.Address]:"stateLevel2"}},{extraValues:["street"],source:{[Y.k.Address]:"addressFull"}},{extraValues:["street_number"],source:{[Y.k.Address]:"streetNumber"}},{extraValues:["door"],source:{[Y.k.Address]:"door"}},{extraValues:["building"],source:{[Y.k.Address]:"building"}},{extraValues:["code"],source:{[Y.k.Address]:"digitCode"}},{extraValues:["floor"],source:{[Y.k.Address]:"floor"}},{extraValues:["street_type"],source:{[Y.k.Address]:"streetTitle"}},{extraValues:["stairway"],source:{[Y.k.Address]:"stairs"}},{extraValues:["address_name"],source:{[Y.k.Address]:"addressName"}}],company:[{extraValues:[],source:{[Y.k.Company]:"name"}},{extraValues:["company_name"],source:{[Y.k.Company]:"name"}},{extraValues:["job"],source:{[Y.k.Company]:"jobTitle"}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[Y.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[Y.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[Y.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[Y.k.Identity]:"birthYear"}}],email:[{extraValues:[],source:{[Y.k.Email]:"email"}},{extraValues:["confirmation"],source:{[Y.k.Email]:"email"}}],id_document:[{extraValues:[],source:{}},{extraValues:["ssn"],source:{[Y.k.SocialSecurityId]:"idNumber"}},{extraValues:["tax"],source:{[Y.k.FiscalId]:"idNumber"}},{extraValues:["ssn","tax"],source:{[Y.k.SocialSecurityId]:"idNumber",[Y.k.FiscalId]:"idNumber"}}],name:[{extraValues:[],source:{[Y.k.Identity]:"fullName"}},{extraValues:["first"],source:{[Y.k.Identity]:"firstName"}},{extraValues:["last"],source:{[Y.k.Identity]:"lastName"}},{extraValues:["middle"],source:{[Y.k.Identity]:"middleName"}},{extraValues:["middle","middle_initials"],source:{[Y.k.Identity]:"middleNameInitial"}},{extraValues:["bank_account"],source:{[Y.k.BankAccount]:"owner"}},{extraValues:["credit_card"],source:{[Y.k.PaymentCard]:"ownerName"}},{extraValues:["drivers_license"],source:{[Y.k.DriverLicense]:"name"}},{extraValues:["id_card"],source:{[Y.k.IdCard]:"name"}},{extraValues:["ssn"],source:{[Y.k.SocialSecurityId]:"name"}}],phone:[{extraValues:[],source:{[Y.k.Phone]:"number"}},{extraValues:["type"],source:{[Y.k.Phone]:"type"}}],title:[{extraValues:["gender"],source:{[Y.k.Identity]:"title"}},{extraValues:["job"],source:{[Y.k.Company]:"jobTitle"}}],username:[{extraValues:[],source:{[Y.k.Identity]:"pseudo"}}]},forgot_password:{otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}]},identity:{address:[{extraValues:[],source:{[Y.k.Address]:"addressFull"}},{extraValues:["extra"],source:{}},{extraValues:["birth"],source:{[Y.k.Identity]:"birthPlace"}},{extraValues:["zip"],source:{[Y.k.Address]:"zipCode"}},{extraValues:["city"],source:{[Y.k.Address]:"city"}},{extraValues:["country"],source:{[Y.k.Address]:"country"}},{extraValues:["region"],source:{[Y.k.Address]:"state"}},{extraValues:["department"],source:{[Y.k.Address]:"stateLevel2"}},{extraValues:["street"],source:{[Y.k.Address]:"addressFull"}},{extraValues:["street_number"],source:{[Y.k.Address]:"streetNumber"}},{extraValues:["door"],source:{[Y.k.Address]:"door"}},{extraValues:["building"],source:{[Y.k.Address]:"building"}},{extraValues:["code"],source:{[Y.k.Address]:"digitCode"}},{extraValues:["floor"],source:{[Y.k.Address]:"floor"}},{extraValues:["street_type"],source:{[Y.k.Address]:"streetTitle"}},{extraValues:["stairway"],source:{[Y.k.Address]:"stairs"}},{extraValues:["address_name"],source:{[Y.k.Address]:"addressName"}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[Y.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[Y.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[Y.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[Y.k.Identity]:"birthYear"}},{extraValues:["issue","drivers_license","day"],source:{[Y.k.DriverLicense]:"issueDay"}},{extraValues:["issue","drivers_license","month"],source:{[Y.k.DriverLicense]:"issueMonth"}},{extraValues:["issue","drivers_license","year"],source:{[Y.k.DriverLicense]:"issueYear"}},{extraValues:["issue","id_card","day"],source:{[Y.k.IdCard]:"issueDay"}},{extraValues:["issue","id_card","month"],source:{[Y.k.IdCard]:"issueMonth"}},{extraValues:["issue","id_card","year"],source:{[Y.k.IdCard]:"issueYear"}},{extraValues:["issue","passport","day"],source:{[Y.k.Passport]:"issueDay"}},{extraValues:["issue","passport","month"],source:{[Y.k.Passport]:"issueMonth"}},{extraValues:["issue","passport","year"],source:{[Y.k.Passport]:"issueYear"}},{extraValues:["expiration","drivers_license","day"],source:{[Y.k.DriverLicense]:"expirationDay"}},{extraValues:["expiration","drivers_license","month"],source:{[Y.k.DriverLicense]:"expirationMonth"}},{extraValues:["expiration","drivers_license","year"],source:{[Y.k.DriverLicense]:"expirationYear"}},{extraValues:["expiration","id_card","day"],source:{[Y.k.IdCard]:"expirationDay"}},{extraValues:["expiration","id_card","month"],source:{[Y.k.IdCard]:"expirationMonth"}},{extraValues:["expiration","id_card","year"],source:{[Y.k.IdCard]:"expirationYear"}},{extraValues:["expiration","passport","day"],source:{[Y.k.Passport]:"expirationDay"}},{extraValues:["expiration","passport","month"],source:{[Y.k.Passport]:"expirationMonth"}},{extraValues:["expiration","passport","year"],source:{[Y.k.Passport]:"expirationYear"}}],id_document:[{extraValues:[],source:{}},{extraValues:["drivers_license"],source:{[Y.k.DriverLicense]:"idNumber"}},{extraValues:["drivers_license","citizenship"],source:{[Y.k.DriverLicense]:"country"}},{extraValues:["id_card"],source:{[Y.k.IdCard]:"idNumber"}},{extraValues:["id_card","citizenship"],source:{[Y.k.IdCard]:"country"}},{extraValues:["passport"],source:{[Y.k.Passport]:"idNumber"}},{extraValues:["passport","citizenship"],source:{[Y.k.Passport]:"country"}},{extraValues:["ssn"],source:{[Y.k.SocialSecurityId]:"idNumber"}},{extraValues:["ssn","citizenship"],source:{[Y.k.SocialSecurityId]:"country"}},{extraValues:["tax"],source:{[Y.k.FiscalId]:"idNumber"}},{extraValues:["tax","citizenship"],source:{[Y.k.FiscalId]:"country"}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}],website:[{extraValues:[],source:{[Y.k.PersonalWebsite]:"website"}}]},login:{action:[{extraValues:[],source:{}},{extraValues:["forgot_password"],source:{}},{extraValues:["login"],source:{[se.JV.SubmitButton]:se.JV.SubmitButton}},{extraValues:["next"],source:{[se.JV.SubmitButton]:se.JV.SubmitButton}}],email:[{extraValues:[],source:{[Y.k.Credential]:"email",[Y.k.Email]:"email"}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}],password:[{extraValues:[],source:{[Y.k.Credential]:"password",[Y.k.GeneratedPassword]:"password"}}],username:[{extraValues:[],source:{[Y.k.Credential]:"login"}},{extraValues:["secondary"],source:{[Y.k.Credential]:"secondaryLogin"}}],id_document:[{extraValues:["ssn"],source:{[Y.k.Credential]:"login",[Y.k.SocialSecurityId]:"idNumber"}},{extraValues:["tax"],source:{[Y.k.Credential]:"login",[Y.k.FiscalId]:"idNumber"}},{extraValues:["ssn","tax"],source:{[Y.k.Credential]:"login",[Y.k.SocialSecurityId]:"idNumber",[Y.k.FiscalId]:"idNumber"}}]},newsletter:{},other:{email:[{extraValues:[],source:{[Y.k.Credential]:"email",[Y.k.Email]:"email"}}],password:[{extraValues:[],source:{[Y.k.Credential]:"password",[se.JV.NewPassword]:se.JV.NewPassword}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}],username:[{extraValues:[],source:{[Y.k.Passkey]:"userDisplayName",[Y.k.Identity]:"pseudo"}}]},payment:{date:[{extraValues:[],source:{}},{extraValues:["credit_card","expiration"],source:{[Y.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","expiration","month"],source:{[Y.k.PaymentCard]:"expireMonth"}},{extraValues:["credit_card","expiration","year"],source:{[Y.k.PaymentCard]:"expireYear"}}],name:[{extraValues:[],source:{}},{extraValues:["first"],source:{[Y.k.Identity]:"firstName"}},{extraValues:["last"],source:{[Y.k.Identity]:"lastName"}},{extraValues:["bank_account"],source:{[Y.k.BankAccount]:"owner"}},{extraValues:["credit_card"],source:{[Y.k.PaymentCard]:"ownerName"}}],payment:[{extraValues:[],source:{}},{extraValues:["bank_account"],source:{[Y.k.BankAccount]:"name"}},{extraValues:["bank_account","bank_name"],source:{[Y.k.BankAccount]:"bankCode"}},{extraValues:["bank_account","bic"],source:{[Y.k.BankAccount]:"BIC"}},{extraValues:["bank_account","iban"],source:{[Y.k.BankAccount]:"IBAN"}},{extraValues:["bank_account","bank_code"],source:{[Y.k.BankAccount]:"BIC"}},{extraValues:["bank_account","number"],source:{[Y.k.BankAccount]:"IBAN"}},{extraValues:["credit_card"],source:{}},{extraValues:["credit_card","expiration"],source:{[Y.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","number"],source:{[Y.k.PaymentCard]:"cardNumber"}},{extraValues:["credit_card","cvv"],source:{[Y.k.PaymentCard]:"securityCode"}},{extraValues:["credit_card","type"],source:{[Y.k.PaymentCard]:"type"}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}]},register:{password:[{extraValues:[],source:{[se.JV.NewPassword]:se.JV.NewPassword}},{extraValues:["new"],source:{[se.JV.NewPassword]:se.JV.NewPassword}}],date:[{extraValues:[],source:{}},{extraValues:["day"],source:{}},{extraValues:["month"],source:{}},{extraValues:["year"],source:{}},{extraValues:["birth"],source:{[Y.k.Identity]:"birthDate"}},{extraValues:["birth","day"],source:{[Y.k.Identity]:"birthDay"}},{extraValues:["birth","month"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year"],source:{[Y.k.Identity]:"birthYear"}},{extraValues:["birth","month","day"],source:{[Y.k.Identity]:"birthMonth"}},{extraValues:["birth","year","day"],source:{[Y.k.Identity]:"birthYear"}},{extraValues:["credit_card","expiration"],source:{[Y.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","expiration","month"],source:{[Y.k.PaymentCard]:"expireMonth"}},{extraValues:["credit_card","expiration","year"],source:{[Y.k.PaymentCard]:"expireYear"}}],otp:[{extraValues:[],source:{[Y.k.Credential]:"otpSecret"}}],payment:[{extraValues:[],source:{}},{extraValues:["bank_account"],source:{[Y.k.BankAccount]:"name"}},{extraValues:["bank_account","bank_name"],source:{[Y.k.BankAccount]:"bankCode"}},{extraValues:["bank_account","bic"],source:{[Y.k.BankAccount]:"BIC"}},{extraValues:["bank_account","iban"],source:{[Y.k.BankAccount]:"IBAN"}},{extraValues:["bank_account","bank_code"],source:{[Y.k.BankAccount]:"BIC"}},{extraValues:["bank_account","number"],source:{[Y.k.BankAccount]:"IBAN"}},{extraValues:["credit_card"],source:{}},{extraValues:["credit_card","expiration"],source:{[Y.k.PaymentCard]:"expireDate"}},{extraValues:["credit_card","number"],source:{[Y.k.PaymentCard]:"cardNumber"}},{extraValues:["credit_card","cvv"],source:{[Y.k.PaymentCard]:"securityCode"}},{extraValues:["credit_card","type"],source:{[Y.k.PaymentCard]:"type"}}]},search:{},shipping:{},shopping_basket:{}},fe=["login","register","identity","change_password","payment","billing","shipping","forgot_password","contact","newsletter","search","shopping_basket","other","default"],Se=["action","address","age","captcha","company","consent","date","email","id_document","name","other","otp","password","payment","phone","query","title","username","website","webauthn"],Ae=["birth","day","expiration","issue","month","year"],Ce=["citizenship","drivers_license","id_card","passport","ssn","tax"],Ie=["billing","shipping"],Te=["part","extra"],ke=["bank_account","bank_code","bank_name","bic","credit_card","cvv","iban","number","swift","type"],Me=["confirmation","new","secondary"],Pe=["job","gender"],Ee={action:["change_password","forgot_login","forgot_password","login","logout","my_account","next","register","search","subscribe"],address:["address_name","birth","box","building","city","country","department","door","floor","region","stairway","street","street_number","street_type","zip","code",...Ce,...ke,...Ie,...Te],age:[],captcha:[],company:["company_name",...Pe,...Te],consent:["newsletter","privacy_policy","rememberme","terms"],date:[...Ae,...Ce,...ke],email:[...Me,"local_part","domain_part"],name:["first","last","maiden","middle","middle_initials",...Ce,...Pe,...ke,...Ie,...Te],id_document:[...Ce,...Te],other:[],otp:Te,password:[...Me,...Te],payment:[...ke,...Ie,...Te,...Ae],phone:["country","mobile","prefix","type","suffix",...Te],query:[],username:[...Me,...Te],title:Pe,website:Te,webauthn:[]},ve=e=>{const t=e.toLowerCase().split(","),a=t.filter((e=>Se.includes(e))),r=t.filter((e=>!Se.includes(e)));return a.map((e=>({main:e,extra:r.filter((t=>Ee[e].includes(t)))})))},Ne=e=>e.toLowerCase().split(",").filter((e=>fe.includes(e)));var Re=a(39431),De=a(29289);const Fe={aol:["aim"],att:["bellsouth","sbcglobal"],google:["gmail","googlemail"],live:["hotmail","outlook","msn"],orange:["wanadoo"],rediff:["rediffmail"],spectrum:["charter"],xfinity:["comcast"],yahoo:["ymail"]},Le=["frama.site","free.fr","over-blog.com","spreadshirt.com","tumblr.com","weebly.com","wordpress.com"],Ue=["netlify.app"],Be=(e,t)=>{const a=e.addressFull.split("\n");return a.length>t?a[t]:""},Ge=e=>Be(e,0),xe=e=>["GB","IE"].includes(e.localeFormat);const Ve={AL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AD:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},AZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},BE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})$/},BH:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},BA:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},BG:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},CR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},HR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},CY:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},CZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},DK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},DO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},EE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},FO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},FI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},FR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},DE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},GI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},HU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},IS:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},IE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},IL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},IT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},KZ:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},KW:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},LV:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},LB:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},LI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},LT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},LU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},MK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MU:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},MC:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},MD:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},ME:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},NL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},NO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{3})$/},PK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},PL:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},PT:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},RO:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SM:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},SA:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},RS:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},SK:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SI:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},ES:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},SE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},CH:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{1})$/},TN:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},TR:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},AE:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{3})$/},GB:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{2})$/},US:{partsPattern:/^(\w+)$/},VG:{partsPattern:/^(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})(\w{4})$/},NO_TYPE:{partsPattern:null}};var Oe=a(97607),We=a(13725);const Ye={de:{AF:"Afghanistan",EG:"Ägypten",AX:"Åland-Inseln",AL:"Albanien",DZ:"Algerien",UM:"Amerikanisch-Ozeanien",AS:"Amerikanisch-Samoa",VI:"Amerikanische Jungferninseln",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarktis",AG:"Antigua und Barbuda",GQ:"Äquatorialguinea",AR:"Argentinien",AM:"Armenien",AW:"Aruba",AC:"Ascension",AZ:"Aserbaidschan",ET:"Äthiopien",AU:"Australien",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesch",BB:"Barbados",BY:"Belarus",BE:"Belgien",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivien",BA:"Bosnien und Herzegowina",BW:"Botsuana",BR:"Brasilien",VG:"Britische Jungferninseln",IO:"Britisches Territorium im Indischen Ozean",BN:"Brunei Darussalam",BG:"Bulgarien",BF:"Burkina Faso",BI:"Burundi",EA:"Ceuta und Melilla",CL:"Chile",CN:"China",CK:"Cookinseln",CR:"Costa Rica",CI:"Côte d’Ivoire",CW:"Curaçao",DK:"Dänemark",KP:"Demokratische Volksrepublik Korea",DE:"Deutschland",DG:"Diego Garcia",DM:"Dominica",DO:"Dominikanische Republik",DJ:"Dschibuti",EC:"Ecuador",SV:"El Salvador",ER:"Eritrea",EE:"Estland",FK:"Falklandinseln",FO:"Färöer",FJ:"Fidschi",FI:"Finnland",FR:"Frankreich",GF:"Französisch-Guayana",PF:"Französisch-Polynesien",TF:"Französische Süd- und Antarktisgebiete",GA:"Gabun",GM:"Gambia",GE:"Georgien",GH:"Ghana",GI:"Gibraltar",GD:"Grenada",GR:"Griechenland",GL:"Grönland",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",IN:"Indien",ID:"Indonesien",IQ:"Irak",IR:"Iran",IE:"Irland",IS:"Island",IM:"Isle of Man",IL:"Israel",IT:"Italien",JM:"Jamaika",JP:"Japan",YE:"Jemen",JE:"Jersey",JO:"Jordanien",KY:"Kaimaninseln",KH:"Kambodscha",CM:"Kamerun",CA:"Kanada",IC:"Kanarische Inseln",CV:"Kap Verde",BQ:"Karibische Niederlande",KZ:"Kasachstan",QA:"Katar",KE:"Kenia",KG:"Kirgisistan",KI:"Kiribati",CC:"Kokosinseln",CO:"Kolumbien",KM:"Komoren",CG:"Kongo-Brazzaville",CD:"Kongo-Kinshasa",XK:"Kosovo",HR:"Kroatien",CU:"Kuba",KW:"Kuwait",LA:"Laos",LS:"Lesotho",LV:"Lettland",LB:"Libanon",LR:"Liberia",LY:"Libyen",LI:"Liechtenstein",LT:"Litauen",LU:"Luxemburg",MG:"Madagaskar",MW:"Malawi",MY:"Malaysia",MV:"Malediven",ML:"Mali",MT:"Malta",MA:"Marokko",MH:"Marshallinseln",MQ:"Martinique",MR:"Mauretanien",MU:"Mauritius",YT:"Mayotte",MK:"Mazedonien",MX:"Mexiko",FM:"Mikronesien",MC:"Monaco",MN:"Mongolei",ME:"Montenegro",MS:"Montserrat",MZ:"Mosambik",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NC:"Neukaledonien",NZ:"Neuseeland",NI:"Nicaragua",NL:"Niederlande",NE:"Niger",NG:"Nigeria",NU:"Niue",MP:"Nördliche Marianen",NF:"Norfolkinsel",NO:"Norwegen",OM:"Oman",AT:"Österreich",PK:"Pakistan",PS:"Palästinensische Autonomiegebiete",PW:"Palau",PA:"Panama",PG:"Papua-Neuguinea",PY:"Paraguay",PE:"Peru",PH:"Philippinen",PN:"Pitcairninseln",PL:"Polen",PT:"Portugal",PR:"Puerto Rico",KR:"Republik Korea",MD:"Republik Moldau",RE:"Réunion",RW:"Ruanda",RO:"Rumänien",RU:"Russische Föderation",SB:"Salomonen",ZM:"Sambia",WS:"Samoa",SM:"San Marino",ST:"São Tomé und Príncipe",SA:"Saudi-Arabien",SE:"Schweden",CH:"Schweiz",SN:"Senegal",RS:"Serbien",SC:"Seychellen",SL:"Sierra Leone",ZW:"Simbabwe",SG:"Singapur",SX:"Sint Maarten",SK:"Slowakei",SI:"Slowenien",SO:"Somalia",MO:"Sonderverwaltungsregion Macau",HK:"Sonderverwaltungszone Hongkong",ES:"Spanien",LK:"Sri Lanka",BL:"St. Barthélemy",SH:"St. Helena",KN:"St. Kitts und Nevis",LC:"St. Lucia",MF:"St. Martin",PM:"St. Pierre und Miquelon",VC:"St. Vincent und die Grenadinen",ZA:"Südafrika",SD:"Sudan",GS:"Südgeorgien und die Südlichen Sandwichinseln",SS:"Südsudan",SR:"Suriname",SJ:"Svalbard und Jan Mayen",SZ:"Swasiland",SY:"Syrien",TJ:"Tadschikistan",TW:"Taiwan",TZ:"Tansania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad und Tobago",TA:"Tristan da Cunha",TD:"Tschad",CZ:"Tschechische Republik",TN:"Tunesien",TR:"Türkei",TM:"Turkmenistan",TC:"Turks- und Caicosinseln",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",HU:"Ungarn",UY:"Uruguay",UZ:"Usbekistan",VU:"Vanuatu",VA:"Vatikanstadt",VE:"Venezuela",AE:"Vereinigte Arabische Emirate",US:"Vereinigte Staaten",GB:"Vereinigtes Königreich",VN:"Vietnam",WF:"Wallis und Futuna",CX:"Weihnachtsinsel",EH:"Westsahara",CF:"Zentralafrikanische Republik",CY:"Zypern"},en:{AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua & Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia & Herzegovina",BW:"Botswana",BR:"Brazil",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CV:"Cape Verde",BQ:"Caribbean Netherlands",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta & Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo - Brazzaville",CD:"Congo - Kinshasa",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d’Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",HK:"Hong Kong SAR China",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau SAR China",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar (Burma)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russia",RW:"Rwanda",WS:"Samoa",SM:"San Marino",ST:"São Tomé & Príncipe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia & South Sandwich Islands",KR:"South Korea",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",BL:"St. Barthélemy",SH:"St. Helena",KN:"St. Kitts & Nevis",LC:"St. Lucia",MF:"St. Martin",PM:"St. Pierre & Miquelon",VC:"St. Vincent & Grenadines",SD:"Sudan",SR:"Suriname",SJ:"Svalbard & Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad & Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks & Caicos Islands",TV:"Tuvalu",UM:"U.S. Outlying Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WF:"Wallis & Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},es:{AF:"Afganistán",AL:"Albania",DE:"Alemania",AD:"Andorra",AO:"Angola",AI:"Anguila",AQ:"Antártida",AG:"Antigua y Barbuda",SA:"Arabia Saudí",DZ:"Argelia",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaiyán",BS:"Bahamas",BD:"Bangladés",BB:"Barbados",BH:"Baréin",BE:"Bélgica",BZ:"Belice",BJ:"Benín",BM:"Bermudas",BY:"Bielorrusia",BO:"Bolivia",BA:"Bosnia-Herzegovina",BW:"Botsuana",BR:"Brasil",BN:"Brunéi",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",BT:"Bután",CV:"Cabo Verde",KH:"Camboya",CM:"Camerún",CA:"Canadá",BQ:"Caribe neerlandés",QA:"Catar",EA:"Ceuta y Melilla",TD:"Chad",CL:"Chile",CN:"China",CY:"Chipre",VA:"Ciudad del Vaticano",CO:"Colombia",KM:"Comoras",KP:"Corea del Norte",KR:"Corea del Sur",CI:"Costa de Marfil",CR:"Costa Rica",HR:"Croacia",CU:"Cuba",CW:"Curazao",DG:"Diego García",DK:"Dinamarca",DM:"Dominica",EC:"Ecuador",EG:"Egipto",SV:"El Salvador",AE:"Emiratos Árabes Unidos",ER:"Eritrea",SK:"Eslovaquia",SI:"Eslovenia",ES:"España",US:"Estados Unidos",EE:"Estonia",ET:"Etiopía",PH:"Filipinas",FI:"Finlandia",FJ:"Fiyi",FR:"Francia",GA:"Gabón",GM:"Gambia",GE:"Georgia",GH:"Ghana",GI:"Gibraltar",GD:"Granada",GR:"Grecia",GL:"Groenlandia",GP:"Guadalupe",GU:"Guam",GT:"Guatemala",GF:"Guayana Francesa",GG:"Guernesey",GN:"Guinea",GQ:"Guinea Ecuatorial",GW:"Guinea-Bisáu",GY:"Guyana",HT:"Haití",HN:"Honduras",HU:"Hungría",IN:"India",ID:"Indonesia",IR:"Irán",IQ:"Iraq",IE:"Irlanda",CX:"Isla Christmas",AC:"Isla de la Ascensión",IM:"Isla de Man",NU:"Isla Niue",NF:"Isla Norfolk",IS:"Islandia",AX:"Islas Åland",KY:"Islas Caimán",IC:"islas Canarias",CC:"Islas Cocos",CK:"Islas Cook",FO:"Islas Feroe",GS:"Islas Georgia del Sur y Sandwich del Sur",FK:"Islas Malvinas",MP:"Islas Marianas del Norte",MH:"Islas Marshall",UM:"Islas menores alejadas de EE. UU.",PN:"Islas Pitcairn",SB:"Islas Salomón",TC:"Islas Turcas y Caicos",VG:"Islas Vírgenes Británicas",VI:"Islas Vírgenes de EE. UU.",IL:"Israel",IT:"Italia",JM:"Jamaica",JP:"Japón",JE:"Jersey",JO:"Jordania",KZ:"Kazajistán",KE:"Kenia",KG:"Kirguistán",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesoto",LV:"Letonia",LB:"Líbano",LR:"Liberia",LY:"Libia",LI:"Liechtenstein",LT:"Lituania",LU:"Luxemburgo",MK:"Macedonia",MG:"Madagascar",MY:"Malasia",MW:"Malaui",MV:"Maldivas",ML:"Mali",MT:"Malta",MA:"Marruecos",MQ:"Martinica",MU:"Mauricio",MR:"Mauritania",YT:"Mayotte",MX:"México",FM:"Micronesia",MD:"Moldavia",MC:"Mónaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MZ:"Mozambique",MM:"Myanmar (Birmania)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NI:"Nicaragua",NE:"Níger",NG:"Nigeria",NO:"Noruega",NC:"Nueva Caledonia",NZ:"Nueva Zelanda",OM:"Omán",NL:"Países Bajos",PK:"Pakistán",PW:"Palau",PA:"Panamá",PG:"Papúa Nueva Guinea",PY:"Paraguay",PE:"Perú",PF:"Polinesia Francesa",PL:"Polonia",PT:"Portugal",PR:"Puerto Rico",HK:"RAE de Hong Kong (China)",MO:"RAE de Macao (China)",GB:"Reino Unido",CF:"República Centroafricana",CZ:"República Checa",CG:"República del Congo",CD:"República Democrática del Congo",DO:"República Dominicana",RE:"Reunión",RW:"Ruanda",RO:"Rumanía",RU:"Rusia",EH:"Sáhara Occidental",WS:"Samoa",AS:"Samoa Americana",BL:"San Bartolomé",KN:"San Cristóbal y Nieves",SM:"San Marino",MF:"San Martín",PM:"San Pedro y Miquelón",VC:"San Vicente y las Granadinas",SH:"Santa Elena",LC:"Santa Lucía",ST:"Santo Tomé y Príncipe",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leona",SG:"Singapur",SX:"Sint Maarten",SY:"Siria",SO:"Somalia",LK:"Sri Lanka",SZ:"Suazilandia",ZA:"Sudáfrica",SD:"Sudán",SS:"Sudán del Sur",SE:"Suecia",CH:"Suiza",SR:"Surinam",SJ:"Svalbard y Jan Mayen",TH:"Tailandia",TW:"Taiwán",TZ:"Tanzania",TJ:"Tayikistán",IO:"Territorio Británico del Océano Índico",TF:"Territorios Australes Franceses",PS:"Territorios Palestinos",TL:"Timor Oriental",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad y Tobago",TA:"Tristán da Cunha",TN:"Túnez",TM:"Turkmenistán",TR:"Turquía",TV:"Tuvalu",UA:"Ucrania",UG:"Uganda",UY:"Uruguay",UZ:"Uzbekistán",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis y Futuna",YE:"Yemen",DJ:"Yibuti",ZM:"Zambia",ZW:"Zimbabue"},fr:{AF:"Afghanistan",ZA:"Afrique du Sud",AL:"Albanie",DZ:"Algérie",DE:"Allemagne",AD:"Andorre",AO:"Angola",AI:"Anguilla",AQ:"Antarctique",AG:"Antigua-et-Barbuda",SA:"Arabie saoudite",AR:"Argentine",AM:"Arménie",AW:"Aruba",AU:"Australie",AT:"Autriche",AZ:"Azerbaïdjan",BS:"Bahamas",BH:"Bahreïn",BD:"Bangladesh",BB:"Barbade",BE:"Belgique",BZ:"Belize",BJ:"Bénin",BM:"Bermudes",BT:"Bhoutan",BY:"Biélorussie",BO:"Bolivie",BA:"Bosnie-Herzégovine",BW:"Botswana",BR:"Brésil",BN:"Brunéi Darussalam",BG:"Bulgarie",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodge",CM:"Cameroun",CA:"Canada",CV:"Cap-Vert",EA:"Ceuta et Melilla",CL:"Chili",CN:"Chine",CY:"Chypre",CO:"Colombie",KM:"Comores",CG:"Congo-Brazzaville",CD:"Congo-Kinshasa",KP:"Corée du Nord",KR:"Corée du Sud",CR:"Costa Rica",CI:"Côte d’Ivoire",HR:"Croatie",CU:"Cuba",CW:"Curaçao",DK:"Danemark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominique",EG:"Égypte",SV:"El Salvador",AE:"Émirats arabes unis",EC:"Équateur",ER:"Érythrée",ES:"Espagne",EE:"Estonie",VA:"État de la Cité du Vatican",FM:"États fédérés de Micronésie",US:"États-Unis",ET:"Éthiopie",FJ:"Fidji",FI:"Finlande",FR:"France",GA:"Gabon",GM:"Gambie",GE:"Géorgie",GH:"Ghana",GI:"Gibraltar",GR:"Grèce",GD:"Grenade",GL:"Groenland",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernesey",GN:"Guinée",GQ:"Guinée équatoriale",GW:"Guinée-Bissau",GY:"Guyana",GF:"Guyane française",HT:"Haïti",HN:"Honduras",HU:"Hongrie",CX:"Île Christmas",AC:"Île de l’Ascension",IM:"Île de Man",NF:"Île Norfolk",AX:"Îles Åland",KY:"Îles Caïmans",IC:"Îles Canaries",CC:"Îles Cocos",CK:"Îles Cook",FO:"Îles Féroé",GS:"Îles Géorgie du Sud et Sandwich du Sud",FK:"Îles Malouines",MP:"Îles Mariannes du Nord",MH:"Îles Marshall",UM:"Îles mineures éloignées des États-Unis",SB:"Îles Salomon",TC:"Îles Turques-et-Caïques",VG:"Îles Vierges britanniques",VI:"Îles Vierges des États-Unis",IN:"Inde",ID:"Indonésie",IQ:"Irak",IR:"Iran",IE:"Irlande",IS:"Islande",IL:"Israël",IT:"Italie",JM:"Jamaïque",JP:"Japon",JE:"Jersey",JO:"Jordanie",KZ:"Kazakhstan",KE:"Kenya",KG:"Kirghizistan",KI:"Kiribati",XK:"Kosovo",KW:"Koweït",RE:"La Réunion",LA:"Laos",LS:"Lesotho",LV:"Lettonie",LB:"Liban",LR:"Libéria",LY:"Libye",LI:"Liechtenstein",LT:"Lituanie",LU:"Luxembourg",MK:"Macédoine",MG:"Madagascar",MY:"Malaisie",MW:"Malawi",MV:"Maldives",ML:"Mali",MT:"Malte",MA:"Maroc",MQ:"Martinique",MU:"Maurice",MR:"Mauritanie",YT:"Mayotte",MX:"Mexique",MD:"Moldavie",MC:"Monaco",MN:"Mongolie",ME:"Monténégro",MS:"Montserrat",MZ:"Mozambique",MM:"Myanmar",NA:"Namibie",NR:"Nauru",NP:"Népal",NI:"Nicaragua",NE:"Niger",NG:"Nigéria",NU:"Niue",NO:"Norvège",NC:"Nouvelle-Calédonie",NZ:"Nouvelle-Zélande",OM:"Oman",UG:"Ouganda",UZ:"Ouzbékistan",PK:"Pakistan",PW:"Palaos",PA:"Panama",PG:"Papouasie-Nouvelle-Guinée",PY:"Paraguay",NL:"Pays-Bas",BQ:"Pays-Bas caribéens",PE:"Pérou",PH:"Philippines",PN:"Pitcairn",PL:"Pologne",PF:"Polynésie française",PR:"Porto Rico",PT:"Portugal",QA:"Qatar",HK:"R.A.S. chinoise de Hong Kong",MO:"R.A.S. chinoise de Macao",CF:"République centrafricaine",DO:"République dominicaine",CZ:"République tchèque",RO:"Roumanie",GB:"Royaume-Uni",RU:"Russie",RW:"Rwanda",EH:"Sahara occidental",BL:"Saint-Barthélemy",KN:"Saint-Christophe-et-Niévès",SM:"Saint-Marin",MF:"Saint-Martin (partie française)",SX:"Saint-Martin (partie néerlandaise)",PM:"Saint-Pierre-et-Miquelon",VC:"Saint-Vincent-et-les-Grenadines",SH:"Sainte-Hélène",LC:"Sainte-Lucie",WS:"Samoa",AS:"Samoa américaines",ST:"Sao Tomé-et-Principe",SN:"Sénégal",RS:"Serbie",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapour",SK:"Slovaquie",SI:"Slovénie",SO:"Somalie",SD:"Soudan",SS:"Soudan du Sud",LK:"Sri Lanka",SE:"Suède",CH:"Suisse",SR:"Suriname",SJ:"Svalbard et Jan Mayen",SZ:"Swaziland",SY:"Syrie",TJ:"Tadjikistan",TW:"Taïwan",TZ:"Tanzanie",TD:"Tchad",TF:"Terres australes françaises",IO:"Territoire britannique de l’océan Indien",PS:"Territoires palestiniens",TH:"Thaïlande",TL:"Timor oriental",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinité-et-Tobago",TA:"Tristan da Cunha",TN:"Tunisie",TM:"Turkménistan",TR:"Turquie",TV:"Tuvalu",UA:"Ukraine",UY:"Uruguay",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis-et-Futuna",YE:"Yémen",ZM:"Zambie",ZW:"Zimbabwe"},it:{AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antartide",AG:"Antigua e Barbuda",SA:"Arabia Saudita",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaigian",BS:"Bahamas",BH:"Bahrein",BD:"Bangladesh",BB:"Barbados",BE:"Belgio",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BY:"Bielorussia",BO:"Bolivia",BA:"Bosnia-Erzegovina",BW:"Botswana",BR:"Brasile",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambogia",CM:"Camerun",CA:"Canada",CV:"Capo Verde",BQ:"Caraibi Olandesi",EA:"Ceuta e Melilla",TD:"Ciad",CL:"Cile",CN:"Cina",CY:"Cipro",VA:"Città del Vaticano",CO:"Colombia",KM:"Comore",CD:"Congo - Kinshasa",CG:"Congo-Brazzaville",KP:"Corea del Nord",KR:"Corea del Sud",CI:"Costa d’Avorio",CR:"Costa Rica",HR:"Croazia",CU:"Cuba",CW:"Curaçao",DK:"Danimarca",DG:"Diego Garcia",DM:"Dominica",EC:"Ecuador",EG:"Egitto",SV:"El Salvador",AE:"Emirati Arabi Uniti",ER:"Eritrea",EE:"Estonia",ET:"Etiopia",RU:"Federazione Russa",FJ:"Figi",PH:"Filippine",FI:"Finlandia",FR:"Francia",GA:"Gabon",GM:"Gambia",GE:"Georgia",GS:"Georgia del Sud e isole Sandwich meridionali",DE:"Germania",GH:"Ghana",JM:"Giamaica",JP:"Giappone",GI:"Gibilterra",DJ:"Gibuti",JO:"Giordania",GR:"Grecia",GD:"Grenada",GL:"Groenlandia",GP:"Guadalupa",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GF:"Guiana Francese",GN:"Guinea",GQ:"Guinea Equatoriale",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HN:"Honduras",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Irlanda",IS:"Islanda",AC:"Isola di Ascensione",CX:"Isola di Christmas",IM:"Isola di Man",NF:"Isola Norfolk",AX:"Isole Aland",IC:"Isole Canarie",KY:"Isole Cayman",CC:"Isole Cocos",CK:"Isole Cook",FK:"Isole Falkland",FO:"Isole Faroe",MP:"Isole Marianne Settentrionali",MH:"Isole Marshall",UM:"Isole minori lontane dagli USA",PN:"Isole Pitcairn",SB:"Isole Solomon",TC:"Isole Turks e Caicos",VI:"Isole Vergini Americane",VG:"Isole Vergini Britanniche",IL:"Israele",IT:"Italia",JE:"Jersey",KZ:"Kazakistan",KE:"Kenya",KG:"Kirghizistan",KI:"Kiribati",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesotho",LV:"Lettonia",LB:"Libano",LR:"Liberia",LY:"Libia",LI:"Liechtenstein",LT:"Lituania",LU:"Lussemburgo",MG:"Madagascar",MW:"Malawi",MV:"Maldive",MY:"Malesia",ML:"Mali",MT:"Malta",MA:"Marocco",MQ:"Martinica",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Messico",FM:"Micronesia",MD:"Moldavia",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MZ:"Mozambico",MM:"Myanmar (Birmania)",NA:"Namibia",NR:"Nauru",NP:"Nepal",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NO:"Norvegia",NC:"Nuova Caledonia",NZ:"Nuova Zelanda",OM:"Oman",NL:"Paesi Bassi",PK:"Pakistan",PW:"Palau",PA:"Panamá",PG:"Papua Nuova Guinea",PY:"Paraguay",PE:"Perù",PF:"Polinesia Francese",PL:"Polonia",PT:"Portogallo",PR:"Portorico",QA:"Qatar",HK:"RAS di Hong Kong",MO:"RAS di Macao",GB:"Regno Unito",CZ:"Repubblica Ceca",CF:"Repubblica Centrafricana",MK:"Repubblica di Macedonia",DO:"Repubblica Dominicana",RE:"Réunion",RO:"Romania",RW:"Ruanda",EH:"Sahara Occidentale",KN:"Saint Kitts e Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre e Miquelon",VC:"Saint Vincent e Grenadines",BL:"Saint-Barthélemy",WS:"Samoa",AS:"Samoa Americane",SM:"San Marino",SH:"Sant’Elena",ST:"São Tomé e Príncipe",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten",SY:"Siria",SK:"Slovacchia",SI:"Slovenia",SO:"Somalia",ES:"Spagna",LK:"Sri Lanka",US:"Stati Uniti",ZA:"Sudafrica",SD:"Sudan",SS:"Sudan del Sud",SR:"Suriname",SJ:"Svalbard e Jan Mayen",SE:"Svezia",CH:"Svizzera",SZ:"Swaziland",TJ:"Tagikistan",TH:"Tailandia",TW:"Taiwan",TZ:"Tanzania",TF:"Territori australi francesi",PS:"Territori palestinesi",IO:"Territorio Britannico dell’Oceano Indiano",TL:"Timor Est",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad e Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turchia",TM:"Turkmenistan",TV:"Tuvalu",UA:"Ucraina",UG:"Uganda",HU:"Ungheria",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnam",WF:"Wallis e Futuna",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},ja:{IS:"アイスランド",IE:"アイルランド",AZ:"アゼルバイジャン",AC:"アセンション島",AF:"アフガニスタン",US:"アメリカ合衆国",AE:"アラブ首長国連邦",DZ:"アルジェリア",AR:"アルゼンチン",AW:"アルバ",AL:"アルバニア",AM:"アルメニア",AI:"アンギラ",AO:"アンゴラ",AG:"アンティグア・バーブーダ",AD:"アンドラ",YE:"イエメン",GB:"イギリス",IL:"イスラエル",IT:"イタリア",IQ:"イラク",IR:"イラン",IN:"インド",ID:"インドネシア",WF:"ウォリス・フツナ",UG:"ウガンダ",UA:"ウクライナ",UZ:"ウズベキスタン",UY:"ウルグアイ",EC:"エクアドル",EG:"エジプト",EE:"エストニア",ET:"エチオピア",ER:"エリトリア",SV:"エルサルバドル",AU:"オーストラリア",AT:"オーストリア",AX:"オーランド諸島",OM:"オマーン",NL:"オランダ",BQ:"オランダ領カリブ",GH:"ガーナ",CV:"カーボベルデ",GG:"ガーンジー",GY:"ガイアナ",KZ:"カザフスタン",QA:"カタール",CA:"カナダ",IC:"カナリア諸島",GA:"ガボン",CM:"カメルーン",GM:"ガンビア",KH:"カンボジア",GN:"ギニア",GW:"ギニアビサウ",CY:"キプロス",CU:"キューバ",CW:"キュラソー",GR:"ギリシャ",KI:"キリバス",KG:"キルギス",GT:"グアテマラ",GP:"グアドループ",GU:"グアム",KW:"クウェート",CK:"クック諸島",GL:"グリーンランド",CX:"クリスマス島",GE:"グルジア",GD:"グレナダ",HR:"クロアチア",KY:"ケイマン諸島",KE:"ケニア",CI:"コートジボワール",CC:"ココス(キーリング)諸島",CR:"コスタリカ",XK:"コソボ",KM:"コモロ",CO:"コロンビア",CG:"コンゴ共和国(ブラザビル)",CD:"コンゴ民主共和国(キンシャサ)",SA:"サウジアラビア",WS:"サモア",BL:"サン・バルテルミー島",MF:"サン・マルタン",ST:"サントメ・プリンシペ",ZM:"ザンビア",PM:"サンピエール島・ミクロン島",SM:"サンマリノ",SL:"シエラレオネ",DJ:"ジブチ",GI:"ジブラルタル",JE:"ジャージー",JM:"ジャマイカ",SY:"シリア",SG:"シンガポール",SX:"シント・マールテン",ZW:"ジンバブエ",CH:"スイス",SE:"スウェーデン",SD:"スーダン",SJ:"スバールバル諸島・ヤンマイエン島",ES:"スペイン",SR:"スリナム",LK:"スリランカ",SK:"スロバキア",SI:"スロベニア",SZ:"スワジランド",EA:"セウタ・メリリャ",SC:"セーシェル",SN:"セネガル",RS:"セルビア",KN:"セントクリストファー・ネイビス",VC:"セントビンセント・グレナディーン諸島",SH:"セントヘレナ",LC:"セントルシア",SO:"ソマリア",SB:"ソロモン諸島",TC:"タークス・カイコス諸島",TH:"タイ",TJ:"タジキスタン",TZ:"タンザニア",CZ:"チェコ共和国",TD:"チャド",TN:"チュニジア",CL:"チリ",TV:"ツバル",DG:"ディエゴガルシア島",DK:"デンマーク",DE:"ドイツ",TG:"トーゴ",TK:"トケラウ",DO:"ドミニカ共和国",DM:"ドミニカ国",TA:"トリスタン・ダ・クーニャ",TT:"トリニダード・トバゴ",TM:"トルクメニスタン",TR:"トルコ",TO:"トンガ",NG:"ナイジェリア",NR:"ナウル",NA:"ナミビア",NU:"ニウエ島",NI:"ニカラグア",NE:"ニジェール",NC:"ニューカレドニア",NZ:"ニュージーランド",NP:"ネパール",NF:"ノーフォーク島",NO:"ノルウェー",BH:"バーレーン",HT:"ハイチ",PK:"パキスタン",VA:"バチカン市国",PA:"パナマ",VU:"バヌアツ",BS:"バハマ",PG:"パプアニューギニア",BM:"バミューダ",PW:"パラオ",PY:"パラグアイ",BB:"バルバドス",PS:"パレスチナ",HU:"ハンガリー",BD:"バングラデシュ",PN:"ピトケアン諸島",FJ:"フィジー",PH:"フィリピン",FI:"フィンランド",BT:"ブータン",PR:"プエルトリコ",FO:"フェロー諸島",FK:"フォークランド諸島",BR:"ブラジル",FR:"フランス",BG:"ブルガリア",BF:"ブルキナファソ",BN:"ブルネイ",BI:"ブルンジ",VN:"ベトナム",BJ:"ベナン",VE:"ベネズエラ",BY:"ベラルーシ",BZ:"ベリーズ",PE:"ペルー",BE:"ベルギー",PL:"ポーランド",BA:"ボスニア・ヘルツェゴビナ",BW:"ボツワナ",BO:"ボリビア",PT:"ポルトガル",HN:"ホンジュラス",MH:"マーシャル諸島",MK:"マケドニア",MG:"マダガスカル",YT:"マヨット島",MW:"マラウイ",ML:"マリ",MT:"マルタ",MQ:"マルティニーク",MY:"マレーシア",IM:"マン島",FM:"ミクロネシア連邦",MM:"ミャンマー",MX:"メキシコ",MU:"モーリシャス",MR:"モーリタニア",MZ:"モザンビーク",MC:"モナコ",MV:"モルディブ",MD:"モルドバ",MA:"モロッコ",MN:"モンゴル",ME:"モンテネグロ",MS:"モントセラト",JO:"ヨルダン",LA:"ラオス",LV:"ラトビア",LT:"リトアニア",LY:"リビア",LI:"リヒテンシュタイン",LR:"リベリア",RO:"ルーマニア",LU:"ルクセンブルグ",RW:"ルワンダ",LS:"レソト",LB:"レバノン",RE:"レユニオン島",RU:"ロシア",IO:"英領インド洋地域",VG:"英領ヴァージン諸島",EH:"西サハラ",GQ:"赤道ギニア",TW:"台湾",KR:"大韓民国",CF:"中央アフリカ共和国",MO:"中華人民共和国マカオ特別行政区",HK:"中華人民共和国香港特別行政区",CN:"中国",KP:"朝鮮民主主義人民共和国",TL:"東ティモール",ZA:"南アフリカ",GS:"南ジョージア島・南サンドイッチ諸島",SS:"南スーダン",AQ:"南極",JP:"日本",GF:"仏領ギアナ",PF:"仏領ポリネシア",TF:"仏領極南諸島",VI:"米領ヴァージン諸島",AS:"米領サモア",UM:"米領太平洋諸島",MP:"北マリアナ諸島"},ko:{GH:"가나",GA:"가봉",GY:"가이아나",GM:"감비아",GG:"건지",GP:"과들루프",GT:"과테말라",GU:"괌",GD:"그레나다",GR:"그리스",GL:"그린란드",GW:"기네비쏘",GN:"기니",CV:"까뽀베르데",NA:"나미비아",NR:"나우루",NG:"나이지리아",AQ:"남극 대륙",SS:"남수단",ZA:"남아프리카",NL:"네덜란드",BQ:"네덜란드령 카리브",NP:"네팔",NO:"노르웨이",NF:"노퍽섬",NC:"뉴 칼레도니아",NZ:"뉴질랜드",NU:"니우에",NE:"니제르",NI:"니카라과",TW:"대만",KR:"대한민국",DK:"덴마크",DM:"도미니카",DO:"도미니카 공화국",DE:"독일",TL:"동티모르",DG:"디에고 가르시아",LA:"라오스",LR:"라이베리아",LV:"라트비아",RU:"러시아",LB:"레바논",LS:"레소토",RO:"루마니아",LU:"룩셈부르크",RW:"르완다",LY:"리비아",RE:"리유니온",LT:"리투아니아",LI:"리히텐슈타인",MG:"마다가스카르",MH:"마샬 군도",YT:"마요티",MO:"마카오, 중국 특별행정구",MK:"마케도니아",MW:"말라위",MY:"말레이시아",ML:"말리",MQ:"말티니크",IM:"맨 섬",MX:"멕시코",MC:"모나코",MA:"모로코",MU:"모리셔스",MR:"모리타니",MZ:"모잠비크",ME:"몬테네그로",MS:"몬트세라트",MD:"몰도바",MV:"몰디브",MT:"몰타",MN:"몽골",US:"미국",VI:"미국령 버진 아일랜드",UM:"미국령 해외 제도",MM:"미얀마",FM:"미크로네시아",VU:"바누아투",BH:"바레인",BB:"바베이도스",VA:"바티칸",BS:"바하마",BD:"방글라데시",BM:"버뮤다",BJ:"베냉",VE:"베네수엘라",VN:"베트남",BE:"벨기에",BY:"벨라루스",BZ:"벨리즈",BA:"보스니아 헤르체고비나",BW:"보츠와나",BO:"볼리비아",BI:"부룬디",BF:"부르키나파소",BT:"부탄",MP:"북마리아나제도",BG:"불가리아",BR:"브라질",BN:"브루나이",WS:"사모아",SA:"사우디아라비아",GS:"사우스조지아 사우스샌드위치 제도",CY:"사이프러스",SM:"산마리노",ST:"상투메 프린시페",MF:"생 마르탱",BL:"생 바르텔르미",PM:"생피에르 미클롱",EH:"서사하라",SN:"세네갈",RS:"세르비아",EA:"세우타 및 멜리야",KN:"세인트 키츠 네비스",LC:"세인트루시아",VC:"세인트빈센트그레나딘",SH:"세인트헬레나",SO:"소말리아",SB:"솔로몬 제도",SD:"수단",SR:"수리남",SC:"쉐이쉘",LK:"스리랑카",SJ:"스발바르제도-얀마웬섬",SZ:"스와질랜드",SE:"스웨덴",CH:"스위스",ES:"스페인",SK:"슬로바키아",SI:"슬로베니아",SY:"시리아",SL:"시에라리온",SX:"신트마르턴",SG:"싱가포르",AE:"아랍에미리트 연합",AW:"아루바",AM:"아르메니아",AR:"아르헨티나",AS:"아메리칸 사모아",IS:"아이슬란드",HT:"아이티",IE:"아일랜드",AZ:"아제르바이잔",AF:"아프가니스탄",AI:"안길라",AD:"안도라",AL:"알바니아",DZ:"알제리",AO:"앙골라",AG:"앤티가 바부다",AC:"어센션 섬",ER:"에리트리아",EE:"에스토니아",EC:"에콰도르",SV:"엘살바도르",GB:"영국",VG:"영국령 버진 아일랜드",IO:"영국령인도양식민지",YE:"예멘",OM:"오만",AU:"오스트레일리아",AT:"오스트리아",HN:"온두라스",AX:"올란드 제도",WF:"왈리스-푸투나 제도",JO:"요르단",UG:"우간다",UY:"우루과이",UZ:"우즈베키스탄",UA:"우크라이나",ET:"이디오피아",IQ:"이라크",IR:"이란",IL:"이스라엘",EG:"이집트",IT:"이탈리아",IN:"인도",ID:"인도네시아",JP:"일본",JM:"자메이카",ZM:"잠비아",JE:"저지",GQ:"적도 기니",KP:"조선 민주주의 인민 공화국",GE:"조지아",CN:"중국",CF:"중앙 아프리카 공화국",DJ:"지부티",GI:"지브롤터",ZW:"짐바브웨",TD:"차드",CZ:"체코",CL:"칠레",IC:"카나리아 제도",CM:"카메룬",KZ:"카자흐스탄",QA:"카타르",KH:"캄보디아",CA:"캐나다",KE:"케냐",KY:"케이맨제도",KM:"코모로스",XK:"코소보",CR:"코스타리카",CC:"코코스제도",CI:"코트디부아르",CO:"콜롬비아",CG:"콩고",CD:"콩고-킨샤사",CU:"쿠바",KW:"쿠웨이트",CK:"쿡제도",CW:"퀴라소",HR:"크로아티아",CX:"크리스마스섬",KG:"키르기스스탄",KI:"키리바시",TJ:"타지키스탄",TZ:"탄자니아",TH:"태국",TC:"터크스케이커스제도",TR:"터키",TG:"토고",TK:"토켈라우",TO:"통가",TM:"투르크메니스탄",TV:"투발루",TN:"튀니지",TT:"트리니다드 토바고",TA:"트리스탄다쿠나",PA:"파나마",PY:"파라과이",PK:"파키스탄",PG:"파푸아뉴기니",PW:"팔라우",PS:"팔레스타인 지구",FO:"페로제도",PE:"페루",PT:"포르투갈",FK:"포클랜드 제도",PL:"폴란드",PR:"푸에르토리코",FR:"프랑스",TF:"프랑스 남부 지방",GF:"프랑스령 기아나",PF:"프랑스령 폴리네시아",FJ:"피지",FI:"핀란드",PH:"필리핀",PN:"핏케언 섬",HU:"헝가리",HK:"홍콩, 중국 특별행정구"},pt:{AF:"Afeganistão",ZA:"África do Sul",AL:"Albânia",DE:"Alemanha",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antártida",AG:"Antígua e Barbuda",SA:"Arábia Saudita",DZ:"Argélia",AR:"Argentina",AM:"Armênia",AW:"Aruba",AU:"Austrália",AT:"Áustria",AZ:"Azerbaijão",BS:"Bahamas",BH:"Bahrein",BD:"Bangladesh",BB:"Barbados",BE:"Bélgica",BZ:"Belize",BJ:"Benin",BM:"Bermudas",BY:"Bielorrússia",BO:"Bolívia",BA:"Bósnia e Herzegovina",BW:"Botsuana",BR:"Brasil",BN:"Brunei",BG:"Bulgária",BF:"Burquina Faso",BI:"Burundi",BT:"Butão",CV:"Cabo Verde",KH:"Camboja",CA:"Canadá",QA:"Catar",KZ:"Cazaquistão",EA:"Ceuta e Melilha",TD:"Chade",CL:"Chile",CN:"China",CY:"Chipre",VA:"Cidade do Vaticano",SG:"Cingapura",CO:"Colômbia",KM:"Comores",CG:"Congo - Brazzaville",CD:"Congo - Kinshasa",KP:"Coreia do Norte",KR:"Coreia do Sul",CI:"Costa do Marfim",CR:"Costa Rica",HR:"Croácia",CU:"Cuba",CW:"Curaçao",DG:"Diego Garcia",DK:"Dinamarca",DJ:"Djibuti",DM:"Dominica",EG:"Egito",SV:"El Salvador",AE:"Emirados Árabes Unidos",EC:"Equador",ER:"Eritreia",SK:"Eslováquia",SI:"Eslovênia",ES:"Espanha",US:"Estados Unidos",EE:"Estônia",ET:"Etiópia",FJ:"Fiji",PH:"Filipinas",FI:"Finlândia",FR:"França",GA:"Gabão",GM:"Gâmbia",GH:"Gana",GE:"Geórgia",GS:"Geórgia do Sul e Ilhas Sandwich do Sul",GI:"Gibraltar",GD:"Granada",GR:"Grécia",GL:"Groenlândia",GP:"Guadalupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GY:"Guiana",GF:"Guiana Francesa",GN:"Guiné",GW:"Guiné Bissau",GQ:"Guiné Equatorial",HT:"Haiti",NL:"Holanda",HN:"Honduras",HK:"Hong Kong, RAE da China",HU:"Hungria",YE:"Iêmen",CX:"Ilha Christmas",AC:"Ilha de Ascensão",IM:"Ilha de Man",NF:"Ilha Norfolk",AX:"Ilhas Åland",KY:"Ilhas Caiman",IC:"Ilhas Canárias",CC:"Ilhas Cocos (Keeling)",CK:"Ilhas Cook",UM:"Ilhas Distantes dos EUA",FO:"Ilhas Faroe",FK:"Ilhas Malvinas",MP:"Ilhas Marianas do Norte",MH:"Ilhas Marshall",PN:"Ilhas Pitcairn",SB:"Ilhas Salomão",TC:"Ilhas Turks e Caicos",VG:"Ilhas Virgens Britânicas",VI:"Ilhas Virgens dos EUA",IN:"Índia",ID:"Indonésia",IR:"Irã",IQ:"Iraque",IE:"Irlanda",IS:"Islândia",IL:"Israel",IT:"Itália",JM:"Jamaica",JP:"Japão",JE:"Jersey",JO:"Jordânia",XK:"Kosovo",KW:"Kuwait",LA:"Laos",LS:"Lesoto",LV:"Letônia",LB:"Líbano",LR:"Libéria",LY:"Líbia",LI:"Liechtenstein",LT:"Lituânia",LU:"Luxemburgo",MO:"Macau, RAE da China",MK:"Macedônia",MG:"Madagascar",MY:"Malásia",MW:"Malawi",MV:"Maldivas",ML:"Mali",MT:"Malta",MA:"Marrocos",MQ:"Martinica",MU:"Maurício",MR:"Mauritânia",YT:"Mayotte",MX:"México",MM:"Mianmar (Birmânia)",FM:"Micronésia",MZ:"Moçambique",MD:"Moldávia",MC:"Mônaco",MN:"Mongólia",ME:"Montenegro",MS:"Montserrat",NA:"Namíbia",NR:"Nauru",NP:"Nepal",NI:"Nicarágua",NE:"Níger",NG:"Nigéria",NU:"Niue",NO:"Noruega",NC:"Nova Caledônia",NZ:"Nova Zelândia",OM:"Omã",BQ:"Países Baixos Caribenhos",PW:"Palau",PA:"Panamá",PG:"Papua-Nova Guiné",PK:"Paquistão",PY:"Paraguai",PE:"Peru",PF:"Polinésia Francesa",PL:"Polônia",PR:"Porto Rico",PT:"Portugal",KE:"Quênia",KG:"Quirguistão",KI:"Quiribati",GB:"Reino Unido",CF:"República Centro-Africana",DO:"República Dominicana",CM:"República dos Camarões",CZ:"República Tcheca",RE:"Reunião",RO:"Romênia",RW:"Ruanda",RU:"Rússia",EH:"Saara Ocidental",PM:"Saint Pierre e Miquelon",WS:"Samoa",AS:"Samoa Americana",SM:"San Marino",SH:"Santa Helena",LC:"Santa Lúcia",BL:"São Bartolomeu",KN:"São Cristóvão e Nevis",MF:"São Martinho",ST:"São Tomé e Príncipe",VC:"São Vicente e Granadinas",SN:"Senegal",SL:"Serra Leoa",RS:"Sérvia",SC:"Seychelles",SX:"Sint Maarten",SY:"Síria",SO:"Somália",LK:"Sri Lanka",SZ:"Suazilândia",SD:"Sudão",SS:"Sudão do Sul",SE:"Suécia",CH:"Suíça",SR:"Suriname",SJ:"Svalbard e Jan Mayen",TH:"Tailândia",TW:"Taiwan",TJ:"Tajiquistão",TZ:"Tanzânia",IO:"Território Britânico do Oceano Índico",TF:"Territórios Franceses do Sul",PS:"Territórios palestinos",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad e Tobago",TA:"Tristão da Cunha",TN:"Tunísia",TM:"Turcomenistão",TR:"Turquia",TV:"Tuvalu",UA:"Ucrânia",UG:"Uganda",UY:"Uruguai",UZ:"Uzbequistão",VU:"Vanuatu",VE:"Venezuela",VN:"Vietnã",WF:"Wallis e Futuna",ZM:"Zâmbia",ZW:"Zimbábue"},zh:{AL:"阿尔巴尼亚",DZ:"阿尔及利亚",AF:"阿富汗",AR:"阿根廷",AE:"阿拉伯联合酋长国",AW:"阿鲁巴",OM:"阿曼",AZ:"阿塞拜疆",AC:"阿森松岛",EG:"埃及",ET:"埃塞俄比亚",IE:"爱尔兰",EE:"爱沙尼亚",AD:"安道尔",AO:"安哥拉",AI:"安圭拉",AG:"安提瓜和巴布达",AT:"奥地利",AX:"奥兰群岛",AU:"澳大利亚",BB:"巴巴多斯",PG:"巴布亚新几内亚",BS:"巴哈马",PK:"巴基斯坦",PY:"巴拉圭",PS:"巴勒斯坦领土",BH:"巴林",PA:"巴拿马",BR:"巴西",BY:"白俄罗斯",BM:"百慕大",BG:"保加利亚",MP:"北马里亚纳群岛",BJ:"贝宁",BE:"比利时",IS:"冰岛",PR:"波多黎各",PL:"波兰",BA:"波斯尼亚和黑塞哥维那",BO:"玻利维亚",BZ:"伯利兹",BW:"博茨瓦纳",BT:"不丹",BF:"布基纳法索",BI:"布隆迪",KP:"朝鲜",GQ:"赤道几内亚",DK:"丹麦",DE:"德国",DG:"迪戈加西亚岛",TL:"东帝汶",TG:"多哥",DO:"多米尼加共和国",DM:"多米尼克",RU:"俄罗斯",EC:"厄瓜多尔",ER:"厄立特里亚",FR:"法国",FO:"法罗群岛",PF:"法属波利尼西亚",GF:"法属圭亚那",TF:"法属南部领地",MF:"法属圣马丁",VA:"梵蒂冈",PH:"菲律宾",FJ:"斐济",FI:"芬兰",CV:"佛得角",FK:"福克兰群岛",GM:"冈比亚",CG:"刚果（布）",CD:"刚果（金）",CO:"哥伦比亚",CR:"哥斯达黎加",GD:"格林纳达",GL:"格陵兰",GE:"格鲁吉亚",GG:"根西岛",CU:"古巴",GP:"瓜德罗普",GU:"关岛",GY:"圭亚那",KZ:"哈萨克斯坦",HT:"海地",KR:"韩国",NL:"荷兰",BQ:"荷兰加勒比区",SX:"荷属圣马丁",ME:"黑山共和国",HN:"洪都拉斯",KI:"基里巴斯",DJ:"吉布提",KG:"吉尔吉斯斯坦",GN:"几内亚",GW:"几内亚比绍",CA:"加拿大",GH:"加纳",IC:"加纳利群岛",GA:"加蓬",KH:"柬埔寨",CZ:"捷克共和国",ZW:"津巴布韦",CM:"喀麦隆",QA:"卡塔尔",KY:"开曼群岛",CC:"科科斯（基林）群岛",KM:"科摩罗",XK:"科索沃",CI:"科特迪瓦",KW:"科威特",HR:"克罗地亚",KE:"肯尼亚",CK:"库克群岛",CW:"库拉索",LV:"拉脱维亚",LS:"莱索托",LA:"老挝",LB:"黎巴嫩",LT:"立陶宛",LR:"利比里亚",LY:"利比亚",LI:"列支敦士登",RE:"留尼汪",LU:"卢森堡",RW:"卢旺达",RO:"罗马尼亚",MG:"马达加斯加",MV:"马尔代夫",MT:"马耳他",MW:"马拉维",MY:"马来西亚",ML:"马里",MK:"马其顿",MH:"马绍尔群岛",MQ:"马提尼克",YT:"马约特",IM:"曼岛",MU:"毛里求斯",MR:"毛里塔尼亚",US:"美国",UM:"美国本土外小岛屿",AS:"美属萨摩亚",VI:"美属维京群岛",MN:"蒙古",MS:"蒙特塞拉特",BD:"孟加拉国",PE:"秘鲁",FM:"密克罗尼西亚",MM:"缅甸",MD:"摩尔多瓦",MA:"摩洛哥",MC:"摩纳哥",MZ:"莫桑比克",MX:"墨西哥",NA:"纳米比亚",ZA:"南非",AQ:"南极洲",GS:"南乔治亚岛和南桑威齐群岛",SS:"南苏丹",NR:"瑙鲁",NI:"尼加拉瓜",NP:"尼泊尔",NE:"尼日尔",NG:"尼日利亚",NU:"纽埃",NO:"挪威",NF:"诺福克岛",PW:"帕劳",PN:"皮特凯恩群岛",PT:"葡萄牙",JP:"日本",SE:"瑞典",CH:"瑞士",SV:"萨尔瓦多",WS:"萨摩亚",RS:"塞尔维亚",SL:"塞拉利昂",SN:"塞内加尔",CY:"塞浦路斯",SC:"塞舌尔",SA:"沙特阿拉伯",BL:"圣巴泰勒米",CX:"圣诞岛",ST:"圣多美和普林西比",SH:"圣赫勒拿",KN:"圣基茨和尼维斯",LC:"圣卢西亚",SM:"圣马力诺",PM:"圣皮埃尔和密克隆群岛",VC:"圣文森特和格林纳丁斯",LK:"斯里兰卡",SK:"斯洛伐克",SI:"斯洛文尼亚",SJ:"斯瓦尔巴特和扬马延",SZ:"斯威士兰",SD:"苏丹",SR:"苏里南",SB:"所罗门群岛",SO:"索马里",TJ:"塔吉克斯坦",TW:"台湾",TH:"泰国",TZ:"坦桑尼亚",TO:"汤加",TC:"特克斯和凯科斯群岛",TA:"特里斯坦-达库尼亚群岛",TT:"特立尼达和多巴哥",TN:"突尼斯",TV:"图瓦卢",TR:"土耳其",TM:"土库曼斯坦",TK:"托克劳",WF:"瓦利斯和富图纳",VU:"瓦努阿图",GT:"危地马拉",VE:"委内瑞拉",BN:"文莱",UG:"乌干达",UA:"乌克兰",UY:"乌拉圭",UZ:"乌兹别克斯坦",GR:"希腊",ES:"西班牙",EH:"西撒哈拉",SG:"新加坡",NC:"新喀里多尼亚",NZ:"新西兰",HU:"匈牙利",EA:"休达及梅利利亚",SY:"叙利亚",JM:"牙买加",AM:"亚美尼亚",YE:"也门",IQ:"伊拉克",IR:"伊朗",IL:"以色列",IT:"意大利",IN:"印度",ID:"印度尼西亚",GB:"英国",VG:"英属维京群岛",IO:"英属印度洋领地",JO:"约旦",VN:"越南",ZM:"赞比亚",JE:"泽西岛",TD:"乍得",GI:"直布罗陀",CL:"智利",CF:"中非共和国",CN:"中国",MO:"中国澳门特别行政区",HK:"中国香港特别行政区"}},_e=e=>{switch(e){case We.f.GB:return"UK";case We.f.IE:return"IRL";case We.f.LU:return"L";case We.f.BE:return"B";case We.f.DE:return"D";case We.f.ES:return"E";case We.f.IT:return"I";case We.f.AT:return"A";default:return e}},Ke=["FR","GB","IE","LU","BE","DE","ES","IT","NL","AT","DK"],He=e=>{if(!e)return We.f.NO_TYPE;if(2===e.length&&e.toLocaleUpperCase()in We.f)return e.toLocaleUpperCase();const t=new Set,a=e.toLowerCase();for(const e in Ye){const r=Ye[e];for(const e in r)r[e].toLowerCase()===a&&t.add(e)}return 1===t.size?[...t][0]:We.f.NO_TYPE},qe=e=>{if(e){const t=(0,Oe.G3)();return(t in Ye?Ye[t]:Ye.en)[e.toLocaleUpperCase()]??e}return""};var je=function(e){return e.FORMAT_DD="FORMAT_DD",e.FORMAT_MM="FORMAT_MM",e.FORMAT_YY="FORMAT_YY",e.FORMAT_YYYY="FORMAT_YYYY",e.FORMAT_DD_MM="FORMAT_DD_MM",e.FORMAT_MM_DD="FORMAT_MM_DD",e.FORMAT_MM_YY="FORMAT_MM_YY",e.FORMAT_MM_YYYY="FORMAT_MM_YYYY",e.FORMAT_YY_MM="FORMAT_YY_MM",e.FORMAT_YYYY_MM="FORMAT_YYYY_MM",e.FORMAT_DD_MM_YY="FORMAT_DD_MM_YY",e.FORMAT_DD_MM_YYYY="FORMAT_DD_MM_YYYY",e.FORMAT_MM_DD_YY="FORMAT_MM_DD_YY",e.FORMAT_MM_DD_YYYY="FORMAT_MM_DD_YYYY",e.FORMAT_YYYY_MM_DD="FORMAT_YYYY_MM_DD",e.FORMAT_YY_MM_DD="FORMAT_YY_MM_DD",e}({}),ze=function(e){return e.SEPARATOR_NOTHING=" ",e.SEPARATOR_DOT=".",e.SEPARATOR_TIRET="-",e.SEPARATOR_SLASH="/",e}({});const Ze=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),Je=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),$e=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)});var Qe=a(95557);const Xe={1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09","1er":"1","1st":"1",jour:"none"},et={1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"10",11:"11",12:"12",janvier:"01",january:"01",januar:"01",gennaio:"01",janeiro:"01",janv:"01",jan:"01",gen:"01","1月":"01",一月:"01","01 janvier":"01","01 january":"01","01 januar":"01","01 gennaio":"01","01 janeiro":"01","01 janv":"01","01 jan":"01","01 gen":"01","01　1月":"01","01　一月":"01","janvier 01":"01","january 01":"01","januar 01":"01","gennaio 01":"01","janeiro 01":"01","janv 01":"01","jan 01":"01","gen 01":"01","1月　01":"01","一月 01":"01","1 janvier":"01","1 january":"01","1 januar":"01","1 gennaio":"01","1　1月":"01","1 一月":"01","1 janeiro":"01","1 de janeiro":"01","1 janv":"01","1 jan":"01","janvier 1":"01","january 1":"01","januar 1":"01","gennaio 1":"01","janeiro 1":"01","janv 1":"01","jan 1":"01","gen 1":"01","1月　1":"01","一月 1":"01",enero:"01","enero 1":"01","enero 01":"01","01 enero":"01","de enero":"01","de enero de":"01","de ene":"01",fevrier:"02",february:"02",februar:"02",febbraio:"02",fevereiro:"02",fevr:"02",fev:"02",feb:"02","2月":"02",二月:"02","02 fevrier":"02","02 february":"02","02 februar":"02","02 febbraio":"02","02 fevereiro":"02","02 fevr":"02","02 feb":"02","02　2月":"02","02 二月":"02","02 fev":"02","fevrier 02":"02","february 02":"02","februar 02":"02","febbraio 02":"02","fevereiro 02":"02","fevr 02":"02","feb 02":"02","2月　02":"02","二月 02":"02","fev 02":"02","2 fevrier":"02","2 february":"02","2 februar":"02","2 febbraio":"02","2 fevereiro":"02","2 fevr":"02","2 feb":"02","2　2月":"02","2 二月":"02","2 fev":"02","fevrier 2":"02","february 2":"02","februar 2":"02","febbraio 2":"02","fevereiro 2":"02","fevr 2":"02","feb 2":"02","2月　2":"02","二月 2":"02","fev 2":"02",febrero:"02","febrero 2":"02","febrero 02":"02","2 febrero":"02","de febrero":"02","de febrero de":"02","de feb":"02",mars:"03",marsa:"03",march:"03",marz:"03",marzo:"03",marco:"03",mar:"03",mrz:"03","3月":"03",三月:"03","03 mars":"03","03 marsa":"03","03 march":"03","03 marz":"03","03 marzo":"03","03 marco":"03","03 mar":"03","03　3月":"03","03 三月":"03","mars 03":"03","marsa 03":"03","march 03":"03","marz 03":"03","marzo 03":"03","marco 03":"03","mar 03":"03","mrz 03":"03","3月　03":"03","三月 03":"03","3 mars":"03","3 marsa":"03","3 march":"03","3 marz":"03","3 marzo":"03","3　3月":"03","3 三月":"03","3 marco":"03","3 mar":"03","mars 3":"03","marsa 3":"03","march 3":"03","marz 3":"03","marzo 3":"03","3月　3":"03","三月 3":"03","marco 3":"03","mar 3":"03","de marzo":"03","de marzo de":"03","de mar":"03",avril:"04",april:"04",aprile:"04",abril:"04",apr:"04","4月":"04",四月:"04",abr:"04",avr:"04","04 avril":"04","04 april":"04","04 aprile":"04","04 abril":"04","04 apr":"04","04　4月":"04","04 四月":"04","04 abr":"04","04 avr":"04","avril 04":"04","april 04":"04","aprile 04":"04","abril 04":"04","apr 04":"04","4月　04":"04","四月 04":"04","abr 04":"04","avr 04":"04","4 avril":"04","4 april":"04","4 aprile":"04","4 abril":"04","4 apr":"04","4　4月":"04","4 四月":"04","4 abr":"04","4 avr":"04","avril 4":"04","april 4":"04","abril 4":"04","apr 4":"04","4月　4":"04","四月 4":"04","abr 4":"04","avr 4":"04","de abril":"04","de abril de":"04","de abr":"04",may:"05",mai:"05",maggio:"05","5月":"05",五月:"05",maio:"05",mayo:"05","05 may":"05","05 mai":"05","05 maggio":"05","05　5月":"05","05 五月":"05","05 maio":"05","05 mayo":"05","5 mai":"05","may 05":"05","mai 05":"05","maggio 05":"05","magg 05":"05","mag 05":"05","5月　05":"05","五月 05":"05","maio 05":"05","mayo 05":"05","may 5":"05","mai 5":"05","maggio 5":"05","magg 5":"05","5月　5":"05","五月 5":"05","maio 5":"05","mayo 5":"05","5 may":"05","5 maggio":"05","5　5月":"05","5 五月":"05","5 maio":"05","5 mayo":"05","de mayo":"05","de mayo de":"05",june:"06",juni:"06",giugno:"06",junho:"06",jun:"06",juin:"06",junio:"06","6月":"06",六月:"06","06 june":"06","06 juni":"06","06 giugno":"06","06　6月":"06","06 六月":"06","06 junho":"06","06 jun":"06","06 giu":"06","06 juin":"06","06 junio":"06","june 06":"06","juni 06":"06","giugno 06":"06","6月　06":"06","六月 06":"06","junho 06":"06","jun 06":"06","giu 06":"06","6月　6":"06","六月 6":"06","juin 06":"06","junio 06":"06","6 june":"06","6 juni":"06","6 giugno":"06","6 junho":"06","6 jun":"06","6 giu":"06","6　6月":"06","6 六月":"06","6 juin":"06","6 junio":"06","june 6":"06","juni 6":"06","giugno 6":"06","junho 6":"06","jun 6":"06","giu 6":"06","juin 6":"06","junio 6":"06","de junio":"06","de junio de":"06","de jun":"06",juillet:"07",july:"07",juli:"07",luglio:"07",julho:"07",jul:"07",lug:"07","7月":"07",七月:"07",juil:"07",julio:"07","07 juillet":"07","07 july":"07","07 juli":"07","07 luglio":"07","07 julho":"07","07 jul":"07","07 lug":"07","07　7月":"07","07 七月":"07","jul 07":"07","07 juil":"07","07 julio":"07","juillet 07":"07","july 07":"07","juli 07":"07","luglio 07":"07","julho 07":"07","lug 07":"07","7月　07":"07","七月 07":"07","juil 07":"07","julio 07":"07","7 juillet":"07","7 july":"07","7 juli":"07","7 luglio":"07","7 julho":"07","7 jul":"07","7 lug":"07","7　7月":"07","7 七月":"07","7 juil":"07","7 jului":"07","juillet 7":"07","july 7":"07","juli 7":"07","luglio 7":"07","julho 7":"07","jul 7":"07","lug 7":"07","7月　7":"07","七月 7":"07","juil 7":"07","julio 7":"07","de julio":"07","de julio de":"07","de jul":"07",august:"08",agosto:"08",aug:"08",ago:"08","8月":"08",八月:"08",aout:"08",aou:"08","08 august":"08","08 agosto":"08","08 aug":"08","08 ago":"08","08　8月":"08","08 八月":"08","08 aout":"08","08 aou":"08","august 08":"08","agosto 08":"08","aug 08":"08","ago 08":"08","8月　08":"08","八月 08":"08","aout 08":"08","aou 08":"08","8 august":"08","8 agosto":"08","8 aug":"08","8 ago":"08","8　8月":"08","8 八月":"08","8 aout":"08","8 aou":"08","august 8":"08","agosto 8":"08","aug 8":"08","8月　8":"08","八月 8":"08","ago 8":"08","aout 8":"08","aou 8":"08","de agosto":"08","de agosto de":"08","de ag":"08",septembre:"09",sep:"09",sett:"09",set:"09",september:"09",settembre:"09",setembro:"09",sept:"09","9月":"09",九月:"09",septiembre:"09","09 septembre":"09","09 sep":"09","09 set":"09","09　9月":"09","09 九月":"09","09 september":"09","09 settembre":"09","09 setembro":"09","09 sept":"09","09 sett":"09","09 septiembre":"09","septembre 09":"09","sep 09":"09","sett 09":"09","set 09":"09","9月　09":"09","九月 09":"09","september 09":"09","settembre 09":"09","setembro 09":"09","sept 09":"09","septiembre 09":"09","9 septembre":"09","9 sep":"09","9 set":"09","9　9月":"09","9 九月":"09","9 september":"09","9 settembre":"09","9 setembro":"09","9 sept":"09","9 sett":"09","9 septiembre":"09","septembre 9":"09","sep 9":"09","sett 9":"09","set 9":"09","9月　9":"09","九月 9":"09","september 9":"09","settembre 9":"09","setembro 9":"09","sept 9":"09","septiembre 9":"09","de septiembre":"09","de septiembre de":"09","de sept":"09","de set":"09",octobre:"10",october:"10",oktober:"10",ottobre:"10",outubro:"10",octubre:"10",oct:"10",okt:"10",ott:"10","10月":"10",十月:"10",out:"10","10 octobre":"10","10 october":"10","10 oktober":"10","10 ottobre":"10","10 outubro":"10","10 octubre":"10","10 oct":"10","10 okt":"10","10 ott":"10","10　10月":"10","10 十月":"10","10 out":"10","octobre 10":"10","october 10":"10","oktober 10":"10","ottobre 10":"10","outubro 10":"10","octubre 10":"10","oct 10":"10","okt 10":"10","10月　10":"10","十月 10":"10","out 10":"10","de octubre":"10","de octubre de":"10","de oct":"10",november:"11",novembre:"11",novembro:"11",noviembre:"11",nov:"11","11月":"11",十一月:"11","11 november":"11","11 novembre":"11","11 novembro":"11","11 nov":"11","11　11月":"11","11 十一月":"11","11 noviembre":"11","november 11":"11","novembre 11":"11","novembro 11":"11","noviembre 11":"11","nov 11":"11","11月　11":"11","十一月 11":"11","de noviembre":"11","de noviembre de":"11","de nov":"11",decembre:"12",december:"12",dezember:"12",dicembre:"12",dezembro:"12",dec:"12",dez:"12",dic:"12","12月":"12",十二月:"12",diciembre:"12","12 decembre":"12","12 december":"12","12 dezember":"12","12 dicembre":"12","12 dezembro":"12","12 dec":"12","12 dez":"12","12 dic":"12","12　12月":"12","12 十二月":"12","12 diciembre":"12","decembre 12":"12","december 12":"12","dezember 12":"12","dicembre 12":"12","dezembro 12":"12","dec 12":"12","dez 12":"12","dic 12":"12","12月　12":"12","十二月 12":"12","diciembre 12":"12","de diciembre":"12","de diciembre de":"12","de dic":"12"},tt=e=>{if(!e)return null;const t=(0,Qe.Z)(e,"yyyy-MM-dd",new Date);return"Invalid Date"!==t.toString()?t:new Date(e)},at=(e,t=je.FORMAT_DD_MM_YYYY)=>e&&Object.keys(je).includes(e)?je[e]:t,rt=(e,t=ze.SEPARATOR_SLASH)=>e&&Object.keys(ze).includes(e)?ze[e]:t,nt=(e,t,a={day:"",month:"",year:""})=>{if(!a.day&&!a.month&&!a.year)return"";return e.split("_").slice(1).map((e=>{switch(e){case"DD":return a.day?.padStart(2,"0");case"MM":return a.month?.padStart(2,"0");case"YY":return a.year?.slice(2);case"YYYY":return a.year;default:return""}})).join(t)},it=(e,t)=>{const a={day:"",month:"",year:""};if(!t)return a;const r=new RegExp("[^A-Za-z0-9_]"),n=e.split(r),i=t.split("_").slice(1);if(n.length===i.length){const e=i.indexOf("DD"),t=i.indexOf("MM"),r=i.findIndex((e=>e.includes("YY")));a.day=e>-1?n[e]:"",a.month=t>-1?n[t]:"",a.year=r>-1?n[r]:""}return a},ot=e=>e.toLowerCase().replace(/é/g,"e").replace(/û/g,"u").replace(/ä/g,"a").replace(/[&/\\#,+()$~%.'":*?<>{}!@]/g,""),st=1,ct=1,lt=1970,ut=(e,t,a)=>!!e&&!!t&&!!a&&e===st&&t===ct&&a===lt;function dt(e){let t="",a="";return t=e.middleName?`${e.middleName} ${e.lastName}`:e.lastName2?`${e.lastName} ${e.lastName2}`:`${e.lastName}`,a=`${e.firstName} ${t}`,a}const pt=e=>{const t=tt(e.birthDate);if(t)return{day:t.getDate().toString().padStart(2,"0"),month:(t.getMonth()+1).toString().padStart(2,"0"),year:t.getFullYear().toString().padStart(4,"0")}},mt=(e,t)=>{const a=pt(e);return a?nt(at(t?.dateFormat,je.FORMAT_MM_DD_YYYY),rt(t?.dateSeparator,ze.SEPARATOR_SLASH),a):""};const wt=(e,t)=>(t.includes("expiration")?ut(e.expirationDay,e.expirationMonth,e.expirationYear):ut(e.issueDay,e.issueMonth,e.issueYear))?"":e[t].toString(),gt=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)}),yt=e=>({day:String(e.issueDay),month:String(e.issueMonth),year:String(e.issueYear)});const bt=e=>({month:e.expireMonth,year:e.expireYear}),ht=(e,t)=>{const a=bt(e);return nt(at(t?.dateFormat,je.FORMAT_MM_YY),rt(t?.dateSeparator,ze.SEPARATOR_SLASH),a)};async function ft(e,t,a,r=""){const n=r?new de.Y(r).getRootDomain():void 0;if(t===Y.k.GeneratedPassword)return e.connectors.carbon.getSingleGeneratedPasswordForAutofill(a);try{const r=await(0,q.z)(e.connectors.grapheneClient.autofillData.queries.getSingleAutofillData({itemId:a,itemType:t,rootDomain:n}));if((0,K.hx)(r))throw new Error(r.error);return r.data}catch(e){throw e instanceof Error&&(e.message="error in get single autofill data query: "+e.message),e}}async function St({context:e,vaultType:t,queryOptions:a,url:r="",limit:n,needDashlaneLinkedWebsites:i}){if(!await async function(e){return await z(e,_.S.WebcardsPerformanceImprovement)}(e.connectors)||t===Y.k.GeneratedPassword)return function({context:e,vaultType:t,queryOptions:a,url:r=""}){const n={sortToken:{sortCriteria:a?.sortCriteria??[],uniqField:"id"},filterToken:{filterCriteria:a?.filterCriteria??[]},limit:a?.maxNumberOfItems},i=new de.Y(r),o=i.getRootDomain(),s=i.getHostname(),c=i.getETLD();switch(t){case Y.k.Address:return e.connectors.carbon.getMultipleAddressesForAutofill(n).then((e=>e.items));case Y.k.BankAccount:return e.connectors.carbon.getMultipleBankAccountsForAutofill(n).then((e=>e.items));case Y.k.Company:return e.connectors.carbon.getMultipleCompaniesForAutofill(n).then((e=>e.items));case Y.k.Credential:return e.connectors.carbon.getMultipleCredentialsForAutofill({domain:Ue.includes(c)?c:o,...n}).then((e=>e.items));case Y.k.DriverLicense:return e.connectors.carbon.getMultipleDriverLicensesForAutofill(n).then((e=>e.items));case Y.k.Email:return e.connectors.carbon.getMultipleEmailsForAutofill(n).then((e=>e.items));case Y.k.FiscalId:return e.connectors.carbon.getMultipleFiscalIdsForAutofill(n).then((e=>e.items));case Y.k.GeneratedPassword:return e.connectors.carbon.getMultipleGeneratedPasswordsForAutofill(n).then((e=>e.items));case Y.k.IdCard:return e.connectors.carbon.getMultipleIdCardsForAutofill(n).then((e=>e.items));case Y.k.Identity:return e.connectors.carbon.getMultipleIdentitiesForAutofill(n).then((e=>e.items));case Y.k.Note:return e.connectors.carbon.getMultipleNotesForAutofill(n).then((e=>e.items));case Y.k.Passkey:return e.connectors.carbon.getPasskeysForDomain({...n,domain:s}).then((e=>e.items));case Y.k.Passport:return e.connectors.carbon.getMultiplePassportsForAutofill(n).then((e=>e.items));case Y.k.PaymentCard:return e.connectors.carbon.getMultiplePaymentCardsForAutofill(n).then((e=>e.items));case Y.k.PersonalWebsite:return e.connectors.carbon.getMultiplePersonalWebsitesForAutofill(n).then((e=>e.items));case Y.k.Phone:return e.connectors.carbon.getMultiplePhonesForAutofill(n).then((e=>e.items));case Y.k.SocialSecurityId:return e.connectors.carbon.getMultipleSocialSecurityIdsForAutofill(n).then((e=>e.items));default:throw new Error("Error: vault type not supported")}}({context:e,vaultType:t,queryOptions:a,url:r});try{const o=new de.Y(r),s=o.getETLD();let c=Ue.includes(s)?s:o.getRootDomain();t===Y.k.Passkey&&(c=o.getHostname());const l=t===Y.k.Credential||t===Y.k.Passkey,u=a?.sortCriteria[0],d=await(0,q.z)(e.connectors.grapheneClient.autofillData.queries.searchAutofillData({searchQuery:l?c:"",itemTypes:[t],domain:c,sorting:u?{property:u.field,direction:u.direction}:void 0,pagination:n?{pageSize:n,pageNumber:1}:void 0,needDashlaneLinkedWebsites:i}));if((0,K.hx)(d))throw new Error(d.error);return d.data.items}catch(e){throw e instanceof Error&&(e.message="error in get all autofill data query: "+e.message),e}}async function At({context:e,searchQuery:t,itemTypes:a,domain:r,sorting:n,limit:i,needDashlaneLinkedWebsites:o}){try{const s=await(0,q.z)(e.connectors.grapheneClient.autofillData.queries.searchAutofillData({searchQuery:t,itemTypes:a,domain:r,sorting:n,pagination:i?{pageSize:i,pageNumber:1}:void 0,needDashlaneLinkedWebsites:o}));if((0,K.hx)(s))throw new Error(s.tag);return s.data}catch(e){throw new Error("error in search autofill data query: "+e)}}const Ct={[Y.k.Address]:Re.U.Address,[Y.k.BankAccount]:Re.U.BankAccount,[Y.k.Company]:Re.U.Company,[Y.k.Credential]:Re.U.Credential,[Y.k.DriverLicense]:Re.U.DriversLicense,[Y.k.Email]:Re.U.Email,[Y.k.FiscalId]:Re.U.FiscalId,[Y.k.GeneratedPassword]:null,[Y.k.IdCard]:Re.U.IdCard,[Y.k.Identity]:Re.U.Identity,[Y.k.Note]:Re.U.SecureNote,[Y.k.Passkey]:Re.U.Passkey,[Y.k.Passport]:Re.U.Passport,[Y.k.PaymentCard]:Re.U.PaymentCard,[Y.k.PersonalWebsite]:Re.U.Website,[Y.k.Phone]:Re.U.Phone,[Y.k.SocialSecurityId]:Re.U.SocialSecurityId,[Y.k.Secret]:Re.U.Secret};const It={[Y.k.Address]:{addressFull:function(e,t){return"number"==typeof t?.partNumber?Be(e,t.partNumber):Ge(e)},country:e=>qe(e.country)},[Y.k.BankAccount]:{IBAN:(e,t)=>{const a=((e,t)=>{const a=e.replace(/\s+/g,"").toUpperCase(),r={full:e,compact:a,parts:[]},n=Ve[t];if(n?.partsPattern){const e=a.match(n.partsPattern);r.parts=e?.slice(1)??[]}return r})(e.IBAN,e.country);return"number"==typeof t?.partNumber?a.parts[t.partNumber]??"":a.compact}},[Y.k.Identity]:{birthDay:(e,t)=>{const a=mt(e,{dateFormat:je.FORMAT_DD,dateSeparator:ze.SEPARATOR_NOTHING});return t?.optionLabels&&t.optionValues?((e,t,a)=>{const r=t=>t===e||Xe[t]===e,n=t.findIndex(r);return n>-1?a[n]:a.find(r)??e})(a,t.optionLabels,t.optionValues):a},birthMonth:(e,t)=>{const a=mt(e,{dateFormat:je.FORMAT_MM,dateSeparator:ze.SEPARATOR_NOTHING});return t?.optionLabels&&t.optionValues?((e,t,a)=>{const r=t=>t===e||et[ot(t)]===e,n=t.findIndex(r);return n>-1?a[n]:a.find(r)??e})(a,t.optionLabels,t.optionValues):a},middleNameInitial:function(e){return`${e.middleName.split(" ").map((e=>e.charAt(0))).join(". ")}.`},fullName:dt},[Y.k.PaymentCard]:{expireMonth:(e,t)=>ht(e,{dateFormat:t?.dateFormat??je.FORMAT_MM,dateSeparator:ze.SEPARATOR_NOTHING}),cardNumber:(e,t)=>{const{cardNumber:a}=e;if("number"==typeof t?.partNumber){const e=4;return a.substr(t.partNumber*e,e)}return a}},[Y.k.Credential]:{otpSecret:function(e,t){const a=e.otpSecret;return"number"==typeof t?.partNumber&&a.length>t.partNumber?a[t.partNumber]:a},password:function(e,t){const a=e.password;return"number"==typeof t?.partNumber&&a.length>t.partNumber?a[t.partNumber]:a}},[Y.k.Passport]:{expirationDay:e=>wt(e,"expirationDay"),expirationMonth:e=>wt(e,"expirationMonth"),issueDay:e=>wt(e,"issueDay"),issueMonth:e=>wt(e,"issueMonth")}},Tt=e=>{if(e.type in It){const t=It[e.type];if(t&&e.property in t)return t[e.property]}},kt=(e,t)=>{var a;if(e.type===t.vaultType)switch(t.vaultType){case Y.k.Identity:switch(e.property){case"birthDate":return{date:pt(t),defaultFormat:je.FORMAT_MM_DD_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"birthYear":return{date:{year:t.birthYear},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING}}return;case Y.k.PaymentCard:switch(e.property){case"expireDate":return{date:bt(t),defaultFormat:je.FORMAT_MM_YY,defaultSeparator:ze.SEPARATOR_SLASH};case"expireYear":return{date:{year:t.expireYear},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING}}return;case Y.k.DriverLicense:switch(e.property){case"expirationDateFull":return{date:(a=t,{day:String(a.expirationDay),month:String(a.expirationMonth),year:String(a.expirationYear)}),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING};case"issueDateFull":return{date:Ze(t),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING}}return;case Y.k.IdCard:switch(e.property){case"expirationDateFull":return{date:Je(t),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING};case"issueDateFull":return{date:$e(t),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING}}return;case Y.k.Passport:switch(e.property){case"expirationDateFull":return{date:gt(t),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"expirationYear":return{date:{year:String(t.expirationYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING};case"issueDateFull":return{date:yt(t),defaultFormat:je.FORMAT_DD_MM_YYYY,defaultSeparator:ze.SEPARATOR_SLASH};case"issueYear":return{date:{year:String(t.issueYear)},defaultFormat:je.FORMAT_YYYY,defaultSeparator:ze.SEPARATOR_NOTHING}}return}},Mt=async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn){const a=await(0,te.O)(e.connectors.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:t}));if((0,K.d6)(a))return a.data}return[]},Pt=async e=>{const t=await(0,te.O)(e.connectors.grapheneClient.autofillSecurity.queries.isPhishingPreventionCapabilityEnabled());return!!(0,K.d6)(t)&&t.data},Et=async(e,t,a)=>{try{const r=await(0,te.O)(e.connectors.grapheneClient.autofillSecurity.queries.isPhishingPreventionDisabledForUrl({credentialUrl:t,pasteDestinationUrl:a}));return!!(0,K.d6)(r)&&r.data}catch(t){return e.logException(t,{message:"Error when checking phishing prevention for url",fileName:"get.ts",funcName:"getPhishingPreventionDisabledForUrl"}),!1}},vt=async e=>{let t={hasLimit:!1};const a=await(0,te.O)(e.connectors.grapheneClient.passwordLimit.queries.getPasswordLimitStatus());(0,K.d6)(a)&&(t=(0,K.db)(a));return{shouldShowPasswordLimitReached:t.hasLimit&&t.passwordsLeft<1,shouldShowNearPasswordLimit:t.hasLimit&&t.passwordsLeft>0&&t.passwordsLeft<=5,passwordsLeft:t.hasLimit?t.passwordsLeft:void 0,limit:t.hasLimit?t.limit:void 0}},Nt=async e=>{let t=!1,a=!1;try{const r=await async function(e){return await z(e,H.t.B2CFreeUserFrozenState)}(e.connectors),n=await e.connectors.carbon.getNodePremiumStatus(),i=n.b2bStatus?.currentTeam;if(i&&(t=i.isSoftDiscontinued&&!!i.isTrial&&(i.teamMembership.isBillingAdmin||i.teamMembership.isTeamAdmin)),r){const t=await(0,q.z)(e.connectors.grapheneClient.passwordLimit.queries.isFreeUserFrozen());a=(0,K.d6)(t)&&t.data}}catch(t){e.logException(t,{message:"Error when gathering frozen account infos",fileName:"get.ts",funcName:"checkIsAccountFrozen"})}return{isB2BDiscontinued:t,isB2CFrozen:a,isAccountFrozen:t||a}};var Rt=a(98803),Dt=function(e){return e.STEP="step",e.FINAL="final",e}({});const Ft={isRightClickMenuLive:!1};var Lt=function(e){return e.Success="Success",e.Error="Error",e}({}),Ut=function(e){return e.NotSupportedError="NotSupportedError",e.SecurityError="SecurityError",e.NotAllowedError="NotAllowedError",e.InvalidStateError="InvalidStateError",e.UnknownError="UnknownError",e}({}),Bt=function(e){return e.Create="create",e.Get="get",e}({});var Gt=function(e){return e.AutofillConfirmationPasswordLess="autofill-confirmation",e.AutofillDropdown="autofill-dropdown",e.AutologinSelection="autologin-selection",e.B2CFrozenDialog="b2c-frozen-dialog",e.DataCapture="data-capture",e.FeedbackNotification="feedback-notification",e.FollowUpNotification="follow-up-notification",e.LinkedWebsiteUpdateConfirmation="linked-website-update-confirmation",e.OnboardingNotification="notification",e.PhishingPrevention="phishing-prevention",e.SavePassword="save-password",e.UserVerification="user-verification",e.WarnGeneratedPassword="warn-generated-password",e.WebauthnCreateConfirmation="webauthn-create-confirmation",e.WebauthnGetConfirmation="webauthn-get-confirmation",e.WebauthnPasskeySelection="webauthn-passkey-selection",e}({}),xt=function(e){return e.WebauthnRequest="webauthnRequest",e.PhishingPrevention="phishingPrevention",e.PendingOperation="pendingOperation",e}({});var Vt=function(e){return e.Classic="classic",e.FixAutofillIssue="fixAutofillIssue",e.GeneratePassword="pwdGenerator",e.Reactivation="reactivation",e.WebAuthnReactivation="webAuthnReactivation",e.FieldDisabledNotification="fieldDisabledNotification",e.SelfCorrecting="selfCorrecting",e.AccountFrozen="accountFrozen",e}({});const Ot=e=>e.webcardType===Gt.AutofillDropdown;var Wt=function(e){return e.PasswordGenerationDashlaneLogin="generation",e.PossibleDuplicateRegistration="registration",e.UnsecureProtocol="unsecure",e.UnsecureIframe="unsecureIframe",e.SandboxedIframe="sandboxedIframe",e.B2BDiscontinued="b2BDiscontinued",e.NearPasswordLimit="nearPasswordLimit",e.PasswordLimitReached="passwordLimitReached",e.None="",e}({});function Yt(e,t){return void 0!==e?t[e]:void 0}Y.k.Address,V.ItemType.Address,Y.k.BankAccount,V.ItemType.BankStatement,Y.k.Company,V.ItemType.Company,Y.k.Credential,V.ItemType.Credential,Y.k.DriverLicense,V.ItemType.DriverLicence,Y.k.Email,V.ItemType.Email,Y.k.FiscalId,V.ItemType.FiscalStatement,Y.k.GeneratedPassword,V.ItemType.GeneratedPassword,Y.k.IdCard,V.ItemType.IdCard,Y.k.Identity,V.ItemType.Identity,Y.k.Passkey,V.ItemType.Passkey,Y.k.Passport,V.ItemType.Passport,Y.k.PaymentCard,V.ItemType.CreditCard,Y.k.PersonalWebsite,V.ItemType.Website,Y.k.Phone,V.ItemType.Phone,Y.k.SocialSecurityId,V.ItemType.SocialSecurity,V.FormType.Login,V.FormType.Register,V.FormType.Identity,V.FormType.ChangePassword,V.FormType.Payment,V.FormType.Billing,V.FormType.Shipping,V.FormType.ForgotPassword,V.FormType.Contact,V.FormType.Newsletter,V.FormType.Search,V.FormType.ShoppingBasket,V.FormType.Other,Wt.PasswordGenerationDashlaneLogin,V.AutofillMessageType.LoginAccountPasswordGeneration,Wt.PossibleDuplicateRegistration,V.AutofillMessageType.DuplicateRisk,Wt.UnsecureProtocol,V.AutofillMessageType.HttpUnsecureWebsite,Wt.UnsecureIframe,V.AutofillMessageType.UnsecureIframe,Wt.SandboxedIframe,V.AutofillMessageType.UnsecureIframeSandbox,Wt.PasswordLimitReached,V.AutofillMessageType.FreeAccountPasswordLimitReached,Wt.None,V.AutofillMessageType.HttpUnsecureWebsite;const _t={"cross-platform":V.AuthenticatorAttachment.CrossPlatform,platform:V.AuthenticatorAttachment.Platform},Kt={discouraged:V.AuthenticatorResidentKey.Discouraged,preferred:V.AuthenticatorResidentKey.Preferred,required:V.AuthenticatorResidentKey.Required},Ht={discouraged:V.AuthenticatorUserVerification.Discouraged,preferred:V.AuthenticatorUserVerification.Preferred,required:V.AuthenticatorUserVerification.Required},qt={[Ut.InvalidStateError]:V.PasskeyRegistrationErrorType.InvalidState,[Ut.NotAllowedError]:V.PasskeyRegistrationErrorType.NotAllowed,[Ut.NotSupportedError]:V.PasskeyRegistrationErrorType.NotSupported,[Ut.SecurityError]:V.PasskeyRegistrationErrorType.Security,[Ut.UnknownError]:V.PasskeyRegistrationErrorType.Unknown},jt={[Ut.InvalidStateError]:V.PasskeyAuthenticationErrorType.InvalidState,[Ut.NotAllowedError]:V.PasskeyAuthenticationErrorType.NotAllowed,[Ut.NotSupportedError]:V.PasskeyAuthenticationErrorType.NotSupported,[Ut.SecurityError]:V.PasskeyAuthenticationErrorType.Security,[Ut.UnknownError]:V.PasskeyAuthenticationErrorType.Unknown},zt={conditional:V.AuthenticationMediationType.Conditional,optional:V.AuthenticationMediationType.Optional,required:V.AuthenticationMediationType.Required,silent:V.AuthenticationMediationType.Silent},Zt={1:V.AlgorithmsSupported.A128Gcm,[-3]:V.AlgorithmsSupported.A128Kw,2:V.AlgorithmsSupported.A192Gcm,[-4]:V.AlgorithmsSupported.A192Kw,3:V.AlgorithmsSupported.A256Gcm,[-5]:V.AlgorithmsSupported.A256Kw,30:V.AlgorithmsSupported.AesCcm16128128,31:V.AlgorithmsSupported.AesCcm16128256,10:V.AlgorithmsSupported.AesCcm1664128,11:V.AlgorithmsSupported.AesCcm1664256,32:V.AlgorithmsSupported.AesCcm64128128,33:V.AlgorithmsSupported.AesCcm64128256,12:V.AlgorithmsSupported.AesCcm6464128,13:V.AlgorithmsSupported.AesCcm6464256,14:V.AlgorithmsSupported.AesMac128128,15:V.AlgorithmsSupported.AesMac12864,25:V.AlgorithmsSupported.AesMac256128,26:V.AlgorithmsSupported.AesMac25664,24:V.AlgorithmsSupported.ChaCha20Poly1305,[-6]:V.AlgorithmsSupported.Direct,[-12]:V.AlgorithmsSupported.DirectHkdfAes128,[-13]:V.AlgorithmsSupported.DirectHkdfAes256,[-10]:V.AlgorithmsSupported.DirectHkdfSha256,[-11]:V.AlgorithmsSupported.DirectHkdfSha512,[-32]:V.AlgorithmsSupported.EcdhEsA128Kw,[-30]:V.AlgorithmsSupported.EcdhEsA192Kw,[-34]:V.AlgorithmsSupported.EcdhEsA256Kw,[-31]:V.AlgorithmsSupported.EcdhEsHkdf256,[-26]:V.AlgorithmsSupported.EcdhEsHkdf512,[-29]:V.AlgorithmsSupported.EcdhSsA128Kw,[-33]:V.AlgorithmsSupported.EcdhSsA192Kw,[-25]:V.AlgorithmsSupported.EcdhSsA256Kw,[-27]:V.AlgorithmsSupported.EcdhSsHkdf256,[-28]:V.AlgorithmsSupported.EcdhSsHkdf512,[-8]:V.AlgorithmsSupported.EdDsa,[-7]:V.AlgorithmsSupported.Es256,[-47]:V.AlgorithmsSupported.Es256K,[-35]:V.AlgorithmsSupported.Es384,[-36]:V.AlgorithmsSupported.Es512,5:V.AlgorithmsSupported.Hmac256256,4:V.AlgorithmsSupported.Hmac25664,6:V.AlgorithmsSupported.Hmac384384,7:V.AlgorithmsSupported.Hmac512512,[-46]:V.AlgorithmsSupported.HssLms,34:V.AlgorithmsSupported.IvGeneration,[-37]:V.AlgorithmsSupported.Ps256,[-38]:V.AlgorithmsSupported.Ps384,[-39]:V.AlgorithmsSupported.Ps512,0:V.AlgorithmsSupported.Reserved,[-65535]:V.AlgorithmsSupported.Rs1,[-257]:V.AlgorithmsSupported.Rs256,[-258]:V.AlgorithmsSupported.Rs384,[-259]:V.AlgorithmsSupported.Rs512,[-40]:V.AlgorithmsSupported.RsaesOaepWithRfc8017,[-41]:V.AlgorithmsSupported.RsaesOaepWithSha256,[-42]:V.AlgorithmsSupported.RsaesOaepWithSha512,[-14]:V.AlgorithmsSupported.Sha1,[-16]:V.AlgorithmsSupported.Sha256,[-15]:V.AlgorithmsSupported.Sha25664,[-43]:V.AlgorithmsSupported.Sha384,[-44]:V.AlgorithmsSupported.Sha512,[-17]:V.AlgorithmsSupported.Sha512256,[-18]:V.AlgorithmsSupported.Shake128,[-45]:V.AlgorithmsSupported.Shake256,8:V.AlgorithmsSupported.Unassigned,[-260]:V.AlgorithmsSupported.WalnutDsa};var Jt=a(51424),$t=function(e){return e[e.None=0]="None",e[e.VaultItem=1]="VaultItem",e[e.Global=2]="Global",e}({});var Qt=a(3689);async function Xt(e){const t=await(0,q.z)(e.connectors.grapheneClient.userVerification.queries.userVerificationMethods());if((0,K.hx)(t))throw new Error("Failure getting the user verification methods");return(0,K.db)(t)}async function ea(e,t,a,r=(0,O.Z)()){const n=await Xt(e),i=[Qt.W.Biometrics,Qt.W.Pin,Qt.W.MasterPassword].find((e=>n.includes(e))),o={type:xt.PendingOperation,operation:t};return{webcardType:Gt.UserVerification,webcardId:r,formType:"login",neverAskAgainMode:$t.None,userLogin:await e.connectors.carbon.getUserLogin()??"",availableMethods:n,defaultMethod:i,usageLogDetails:a,metadata:{[xt.PendingOperation]:o}}}const ta={[Jt.MS.CannotDisable]:$t.None,[Jt.MS.DisableGeneralSetting]:$t.Global,[Jt.MS.DisableSpecificVaultItem]:$t.VaultItem},aa=async(e,t,a)=>{const r=await(0,te.O)(e.grapheneClient.autofillSecurity.queries.getAutofillProtectionContext({vaultType:a,vaultItemId:t}));return{isProtected:!!(0,K.d6)(r)&&r.data.isProtected,neverAskAgainMode:ta[(0,K.d6)(r)?r.data.disableMode:Jt.MS.CannotDisable]}},ra=async(e,t,a,r)=>{const n=await e.connectors.carbon.getIsSSOUser(),i=await e.connectors.carbon.getAccountAuthenticationType(),o=n||"masterPassword"!==i,s={source:V.AuthenticatorUserVerificationSource.Autofill},c=o?(l=r.data,{webcardId:(0,O.Z)(),webcardType:Gt.AutofillConfirmationPasswordLess,pendingOperation:l,formType:l.formClassification}):await ea(e,r,s);var l;t.showWebcard(N.MainFrame,c)},na=async(e,t,a,r)=>{await e.connectors.carbon.disableVaultItemProtection(r)};var ia=function(e){return e.SimpleItem="SimpleItem",e.EnhancedItem="EnhancedItem",e}({});const oa=e=>{if(!e)return;const{color:t,letter:a,spaceId:r,displayName:n}=e;return{color:t,letter:a,spaceId:r,displayName:n}};function sa(e){return e.type===xt.WebauthnRequest&&"request"in e}function ca(e,t){return{...e,[t.type]:t}}function la(e){return ca({},e)}var ua=function(e){return e.CopyValue="copyValue",e.ApplyAutofillDetails="applyAutofillDetails",e.Webauthn="webauthnRequest",e}({}),da=a(39442);var pa=function(e){return e.AfterLogin="webOnboardingAfterLogin",e.AfterSave="webOnboardingAfterSave",e.AfterCancel="webOnboardingAfterCancel",e}({});const ma=e=>({webcardId:(0,O.Z)(),webcardType:Gt.OnboardingNotification,configuration:e,formType:""}),wa=async(e,t,a)=>{const r=await e.connectors.carbon.getWebOnboardingMode();if(r.flowSaveCredentialOnWeb&&!r.completedSteps?.saveCredentialOnWeb){await ne(e,t,ma(a?pa.AfterSave:pa.AfterCancel));const n=a?{saveCredentialOnWeb:a}:null,i=r.completedSteps&&!r.completedSteps.saveCredentialOnWeb||r.leelooStep===da.s.SHOW_PASSWORD_SAVE_SUCCESS?da.s.SHOW_PASSWORD_SAVE_SUCCESS:null;return await e.connectors.legacyCarbon.updateWebOnboardingMode({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowSaveCredentialOnWeb:!a,leelooStep:a?i:da.s.SHOW_SAVE_SITES_DIALOG,popoverStep:null,completedSteps:{...r.completedSteps,...n}}),!0}return!1},ga=async(e,t)=>{if(a=t,!new RegExp("https://(www\\.)?dashlane\\.com/([\\w-]+/)?try-autofill-demo").test(a))return;var a;const r=await e.connectors.carbon.getWebOnboardingMode();r.flowTryAutofillOnWeb&&!r.completedSteps?.tryAutofillOnWeb&&await e.connectors.legacyCarbon.updateWebOnboardingMode({flowTryAutofillOnWeb:!1,completedSteps:{...r.completedSteps,tryAutofillOnWeb:!0}})},ya=(e,t,a)=>{const r=(n=a,{webcardId:(0,O.Z)(),webcardType:Gt.WarnGeneratedPassword,formType:n.formClassification,pendingOperation:n});var n;t.showWebcard(N.MainFrame,r)};var ba=a(45368);const ha=e=>e.split("@").pop()??"",fa=e=>e.split(".").shift()??"",Sa=e=>e.startsWith("http://"),Aa=(e,t)=>Ne(e).includes(t),Ca=(e,t)=>e.substring(e.indexOf(t)+t.length),Ia=(e,t)=>{const a=new de.Y(e),r=new de.Y(t),n=a.getRootDomain()===r.getRootDomain(),i=a.getSubdomainWithoutLeadingWww()===r.getSubdomainWithoutLeadingWww();let o=!0;r.getPathname()&&"/"!==r.getPathname()&&(o=a.getPathname()===r.getPathname());const s=((e,t,a,r)=>{const n=/^:(\d+)/m,i=Ca(e,t).match(n)??[],o=Ca(a,r).match(n)??[];return!(i.length>0)||i[0]===o[0]})(e,a.getRootDomain(),t,r.getRootDomain());return n&&i&&o&&s},Ta=(e,t)=>{const a=new de.Y(t),r=a.getETLD(),n=a.getRootDomain(),i=e.url,o=new de.Y(i),s=o.getRootDomain(),c=o.getHostname();if(Ue.includes(r)&&r!==c&&s!==n)return!1;const l=Le.includes(n);return e.subdomainOnly||l?Ia(t,i)||e.userAddedLinkedWebsites.some((e=>Ia(t,e))):e.matchType!==V.MatchType.UserAssociatedWebsite||e.userAddedLinkedWebsites.some((e=>t.includes(new de.Y(e).getHostname())))},ka=(e,t)=>"string"==typeof e&&e in t,Ma=async(e,t,a)=>{let r=a[t.property];if("email"!==t.property&&"login"!==t.property||(r||=a.email||a.login),"otpSecret"===t.property){r=a.hasOtp?await(async(e,t)=>{const a=await(0,te.O)(e.grapheneClient.otp.queries.otpCode({credentialId:t}));return(0,K.d6)(a)?a.data?.code:void 0})(e,a.id):void 0;const n=Tt(t);if(n&&"string"==typeof r&&r.length)return n({...a,otpSecret:r},t.format)}return r?.toString()},Pa=async(e,t)=>{const a=Tt(t.ingredient);if(a&&"otpSecret"!==t.ingredient.property)return a(t.vaultItem,t.ingredient.format);if(!ka(t.ingredient.property,t.vaultItem))return;if((r=t).ingredient.type===Y.k.Credential&&ka(r.ingredient.property,r.vaultItem))return await Ma(e,t.ingredient,t.vaultItem);var r;if((e=>e.ingredient.type===Y.k.Address&&ka(e.ingredient.property,e.vaultItem))(t))return((e,t)=>{let a=t[e.property];return"addressFull"===e.property&&xe(t)&&(a=`${t.streetNumber} ${t.addressFull}`),a?.toString()})(t.ingredient,t.vaultItem);const n=t.vaultItem[t.ingredient.property];return n?n.toString():void 0},Ea=async({context:e,operations:t,frameId:a,fieldId:r,ingredient:n,dataSource:i,focusedElement:o,selectedVaultItem:s})=>{if(n.type!==i.type)return;const c=await Pa(e,{ingredient:n,vaultItem:s}),l=kt(n,s);if(c||l?.date){if(t.matchType===V.MatchType.Regular&&(t.matchType=(e=>e.vaultType===Y.k.Credential?e.matchType:V.MatchType.Regular)(s)),n.type===Y.k.Credential&&"password"===n.property){const{id:e,email:a,login:r,url:n}=s;t.itemInfos={id:e,login:r||a,domain:new de.Y(n).getHostname(),type:Y.k.Credential}}if(n.type===Y.k.BankAccount||n.type===Y.k.PaymentCard){const{name:e}=s;t.itemInfos={type:n.type,item_name:e}}t[me.Fill].push({operationType:me.Fill,frameId:a,srcElementId:r,dataSource:l?.date?{type:i.type,date:l.date,format:at(n.format?.dateFormat,l.defaultFormat),separator:rt(n.format?.dateSeparator,l.defaultSeparator)}:{type:i.type,value:c},forceAutofill:o?.elementId===r&&o.frameId===a||i.type===Y.k.Credential,canCopy:s.vaultType!==Y.k.Credential||(!s.sharingStatus?.isShared||s.sharingStatus.canCopy),canEdit:s.vaultType!==Y.k.Credential||(!s.sharingStatus?.isShared||s.sharingStatus.canEdit),canView:s.vaultType!==Y.k.Credential||(!s.sharingStatus?.isShared||s.sharingStatus.canView)})}},va=async({context:e,operations:t,frameId:a,fieldId:r,ingredient:n,dataSource:i,focusedElement:o,selectedVaultItem:s})=>{if(n.type===i.type){if(i.type===se.JV.WebauthnConditionalUI)throw new Error("Cannot build fill operation for webauthn conditional UI");i.type===se.JV.NewPassword?t[me.Fill].push({operationType:me.Fill,frameId:a,srcElementId:r,dataSource:{type:Y.k.GeneratedPassword,value:i.value},forceAutofill:!0,canCopy:!1,canEdit:!1,canView:!1}):pe(n)&&s&&await Ea({context:e,operations:t,frameId:a,fieldId:r,ingredient:n,dataSource:i,focusedElement:o,selectedVaultItem:s})}},Na=async(e,t,a,r)=>{const n={formClassification:a.formClassification,requestOrigin:a.requestOrigin,tabRootDomain:new de.Y(t.tab?.url??"").getRootDomain(),[me.Fill]:[],[me.Click]:[],matchType:V.MatchType.Regular},i=a.autofillRecipe,o={context:e,operations:n,requestOrigin:a.requestOrigin,dataSource:a.dataSource,focusedElement:a.focusedElement,selectedVaultItem:r};for(const{frameId:e,srcElementId:t,ingredient:a}of i.ingredients)await va({...o,frameId:e,fieldId:t,ingredient:a});const s=i.ingredients.filter((e=>e.ingredient.type===se.JV.SubmitButton)),c=s.find((e=>e.fieldClassification.includes("login")))??s.find((e=>e.fieldClassification.includes("next")))??s[0];return o.operations[me.Fill].length>0&&c&&await(async({context:e,operations:t,frameId:a,fieldId:r,ingredient:n,dataSource:i,requestOrigin:o,selectedVaultItem:s})=>{const c=await e.state.tab.get(),l=o.type===we.Webcard&&o.webcardType===Gt.AutologinSelection,u=o.type===we.Automatic&&c.lastAutologin?.domain!==t.tabRootDomain,d=!(o.type!==we.Automatic||c.lastAutologin?.domain!==t.tabRootDomain||!c.lastAutologin.isMultiSteps||!c.lastAutologin.step||c.lastAutologin.step===Dt.FINAL||t.formClassification.includes(Dt.STEP)||t.formClassification.includes(c.lastAutologin.step));(l||u||d)&&n.type===se.JV.SubmitButton&&i.type===Y.k.Credential&&s&&"autoLogin"in s&&s.autoLogin&&t[me.Click].push({operationType:me.Click,frameId:a,srcElementId:r})})({...o,frameId:c.frameId,fieldId:c.srcElementId,ingredient:c.ingredient}),n},Ra=async(e,t,a,r)=>{if(a.tab?.url)switch(r.dataSource.type){case se.JV.WebauthnConditionalUI:break;case se.JV.NewPassword:{e.connectors.carbon.saveGeneratedPassword({password:r.dataSource.value,url:new de.Y(a.tab.url).getRootDomain()});const n=await Na(e,a,r);t.applyAutofillOperationsAndTriggerDataCapture(N.AllFrames,n)}}},Da=async(e,t,a,r)=>{if(!a.tab?.url)return;if(!ge(r))throw new Error(`Error: applyAutofillRecipeForVaultDataSourceHandler called without a VaultDataSource '${r}'`);if((await aa(e,r.dataSource.vaultId,r.dataSource.type)).isProtected)throw new Error("Error: applyAutofillRecipeForVaultDataSourceHandler called with password protected items");const n=new de.Y(a.tab.url),i=n.getRootDomain();await e.connectors.legacyCarbon.filledDataItem({dataType:le.Z[r.dataSource.type],id:r.dataSource.vaultId,url:a.tab.url});const o=await ft(e,r.dataSource.type,r.dataSource.vaultId),s=await Na(e,a,r,o);if(s[me.Fill].length>0){r.autofillRecipe.postfillRecipes&&await(async(e,t,a,r)=>{const n=a.autofillRecipe.postfillRecipes;if(!n)return;const i=Object.entries(n);for(const[n,o]of i)if((0,se.Wm)(n)){const i=await St({context:e,url:r,vaultType:n,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[],maxNumberOfItems:1},limit:1});if(i.length>0&&!(await aa(e,i[0].id,i[0].vaultType)).isProtected){const r=i[0];for(const{frameId:i,srcElementId:s,ingredient:c}of o.ingredients)await va({context:e,operations:t,frameId:i,fieldId:s,ingredient:c,dataSource:{type:n,vaultId:r.id},requestOrigin:a.requestOrigin,selectedVaultItem:r})}}})(e,s,r,i);const a=await e.state.tab.get(),{isRecipeForAutologin:c,isMultiSteps:l,step:u}=ur(r.autofillRecipe,r.formClassification);c&&s[me.Click].length>0&&await e.state.tab.set({...a,lastAutologin:{domain:i,isMultiSteps:l,step:u}}),t.applyAutofillOperations(N.AllFrames,s),await(async(e,t,a,r,n)=>{const i=n.getHostname();if(r?.vaultType===Y.k.Credential&&new de.Y(r.url).getHostname()!==i){const s=await(0,q.z)(e.grapheneClient.autofillSettings.queries.getPreferencesForCredentials({credentialIds:[r.id]})),c=await(0,q.z)(e.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:r.url})),l=(o=n,new de.Y(r.url).getRootDomain()===o.getRootDomain()&&""!==o.getSubdomain());if((!(0,K.d6)(s)||!l||"www"!==n.getSubdomain()&&s.data[0]?.onlyAutofillExactDomain)&&!r.userAddedLinkedWebsites.includes(i)&&(0,K.d6)(c)&&!c.data.includes(i)){const n={webcardId:(0,O.Z)(),webcardType:Gt.LinkedWebsiteUpdateConfirmation,formType:"",operation:{credentialId:a.dataSource.vaultId,credentialName:r.title,linkedWebsite:i}},o=await e.connectors.grapheneClient.linkedWebsites.commands.addLinkedWebsite({credentialId:a.dataSource.vaultId,linkedWebsite:i});(0,K.d6)(o)&&await ne(e,t,n)}}var o})(e,t,r,o,n)}r.dataSource.type===Y.k.Credential&&s[me.Click].length>0&&await(async(e,t)=>{const a=await e.connectors.carbon.getWebOnboardingMode();a.flowLoginCredentialOnWeb&&!a.completedSteps?.loginCredentialOnWeb&&(await ne(e,t,ma(pa.AfterLogin)),await e.connectors.legacyCarbon.updateWebOnboardingMode({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowSaveCredentialOnWeb:!1,leelooStep:da.s.SHOW_WEB_SAVE_AND_AUTOLOGIN_COMPLETED,popoverStep:null,completedSteps:{...a.completedSteps,loginCredentialOnWeb:!0}}))})(e,t)},Fa=async(e,t,a,r)=>{if(a.tab?.url){if(ge(r)){const n=await aa(e,r.dataSource.vaultId,r.dataSource.type);n.isProtected?await ra(e,t,n.neverAskAgainMode,{type:ua.ApplyAutofillDetails,data:r}):await Da(e,t,a,r)}else if(ye(r)){!await async function(e){return await z(e,_.S.DisableEmailPasswordWarning)||await z(e,_.S.DisableEmailPasswordWarningDev)}(e.connectors)&&((e,t)=>{const a=fa(t),r=Fe[a]??[a],n=fa(ha(e));return r.includes(n)})(await e.connectors.carbon.getUserLogin()??"",new de.Y(a.tab.url).getRootDomain())?ya(0,t,r):await Ra(e,t,a,r)}await ga(e,a.tab.url)}},La=" ",Ua=e=>e.reduce(((e,t)=>t.value&&"ownerName"===t.property?`${e} ${t.value}`:e),"").trim(),Ba=(e,t)=>"long"===t?`••••${La}••••${La}••••${La}${e}`:`••••${La}${e}`,Ga={[Y.k.PaymentCard]:3,[Y.k.IdCard]:6,[Y.k.Passport]:6,[Y.k.DriverLicense]:6},xa=(e,t)=>e.find((e=>e.property===t)),Va=(e,t,a)=>{const r=new Date(t,e,1),n=new Date(t,e-(Ga[a]??6),1);return{expired:new Date>=r,aboutToExpire:new Date>=n}},Oa=async(e,t,a,r)=>{const n={};return await Promise.all(r.map((async r=>{const i=await Pa(e,{ingredient:{type:t,property:r},vaultItem:a});i&&(n[r]=((e,t)=>{switch(e){case"password":return"••••••••••••";case"otpSecret":return"••• •••";case"securityCode":return"•••";case"cardNumber":return Ba(t?.slice(-4)??"","long");case"BIC":return"••••••";case"IBAN":case"idNumber":return"••••••••••••••••";default:return t??"••••"}})(r,i))}))),n},Wa=e=>{const t=xa(e,"expireMonth"),a=xa(e,"expireYear"),r={month:t?.value,year:a?.value};if(t?.value&&t.format?.dateFormat||a?.value&&a.format?.dateFormat){const e=t?.format?.dateFormat?t:a;if(e){const{month:t,year:a}=it(e.value,at(e.format?.dateFormat));r.month=t,r.year=a}}return r.year&&2===r.year.length&&(r.year=(e=>{const t=(new Date).getFullYear(),a=t.toString().slice(2),r=t.toString().slice(0,2);let n=`${r}${e}`;return Number(e)<Number(a)&&(n=`${Number(r)+1}${e}`),n})(r.year)),r},Ya=(e,t)=>{const{expireMonth:a,expireYear:r}=e,n=parseInt(r,10),i=parseInt(a,10),{expired:o,aboutToExpire:s}=Va(i,n,e.vaultType),c=!e.cardNumber,l=e.cardNumberLastDigits?Ba(e.cardNumberLastDigits,"short"):"",u=a&&r?`${a.padStart(2,"0")}/${r.slice(-2)}`:"",d=l+La.repeat(3)+u;return{type:ia.EnhancedItem,itemId:e.id,itemType:Y.k.PaymentCard,title:e.name,content:d,space:oa(t),expired:o,aboutToExpire:s&&!o,incomplete:c&&!s&&!o,paymentType:e.type,color:e.color.toLowerCase(),isProtected:!0}},_a=(e,t)=>{const a=qe(e.localeFormat),r=Ge(e),n=xe(e)?`${e.streetNumber} ${r}`:r,i=`${xe(e)?`${e.city} ${e.zipCode}`:`${e.zipCode} ${e.city}`} ${a}`,o=`${e.addressName}${" ".repeat(2)}-${" ".repeat(2)}${i}`;return{type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Address,title:n,content:o,space:oa(t),isProtected:!1}},Ka=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.BankAccount,title:e.name,content:e.owner,space:oa(t),isProtected:!1}),Ha=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Company,title:e.name,content:e.jobTitle,space:oa(t),isProtected:!1}),qa=(e,t)=>{let a=e.title;return a.match(/^".*"$/)&&(a=a.substring(1),a=a.substring(0,a.length-1)),{type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Credential,title:e.login||e.email,content:a,isLinkedWebsite:[V.MatchType.AssociatedWebsite,V.MatchType.UserAssociatedWebsite].includes(e.matchType),space:oa(t),isProtected:e.autoProtected,domain:new de.Y(e.url).getRootDomain()}},ja=["FR","US-0-AK","US-0-AL","US-0-AR","US-0-AZ","US-0-CA","US-0-CO","US-0-CT","US-0-DE","US-0-FL","US-0-GA","US-0-HI","US-0-IA","US-0-ID","US-0-IL","US-0-IN","US-0-KS","US-0-KY","US-0-LA","US-0-MA","US-0-MD","US-0-ME","US-0-MI","US-0-MN","US-0-MO","US-0-MS","US-0-MT","US-0-NC","US-0-ND","US-0-NE","US-0-NH","US-0-NJ","US-0-NM","US-0-NV","US-0-NY","US-0-OH","US-0-OK","US-0-OR","US-0-PA","US-0-RI","US-0-SC","US-0-SD","US-0-TN","US-0-TX","US-0-UT","US-0-VA","US-0-VT","US-0-WA","US-0-WI","US-0-WV","US-0-WY","US-0-WY"],za=(e,t)=>{const{expirationMonth:a,expirationYear:r}=e,{expired:n,aboutToExpire:i}=Va(a,r,e.vaultType),o=(e=>{let t="";return t=ja.includes(e.country)?e.country:ja.includes(e.state)?e.state:Ke.includes(e.country)?"eu":"US"===e.country?"US_generic":"generic",t})(e);return{type:ia.EnhancedItem,itemId:e.id,itemType:Y.k.DriverLicense,title:e.name,content:e.localeFormat,space:oa(t),expired:n,aboutToExpire:i&&!n,isProtected:!1,displayCountry:_e(e.localeFormat),country:e.localeFormat,backgroundName:o}},Za=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Email,title:e.email,content:e.name,communicationType:e.type,space:oa(t),isProtected:!1}),Ja=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.FiscalId,title:e.idNumber,content:e.localeFormat,space:oa(t),isProtected:!1}),$a=(e,t)=>{const{expirationMonth:a,expirationYear:r}=e,{expired:n,aboutToExpire:i}=Va(a,r,e.vaultType);return{type:ia.EnhancedItem,itemId:e.id,itemType:Y.k.IdCard,title:e.name,content:e.localeFormat,expired:n,aboutToExpire:i,country:e.localeFormat,displayCountry:_e(e.localeFormat),space:oa(t),isProtected:!1}};var Qa=a(35813);const Xa=e=>{if(e.day&&e.month&&4===e.year?.length){ot(e.month)in et&&ot(e.month);const t=e.month.padStart(2,"0"),a=e.day.padStart(2,"0"),r=`${e.year}-${t}-${a}`;if((0,Qa.Z)((0,Qe.Z)(r,"yyyy-MM-dd",new Date)))return r}return""},er=e=>{let t=dt(e);return e.pseudo&&(t+=` (${e.pseudo})`),t},tr=e=>{const t=[],a=(0,Oe.G3)(),r=tt(e.birthDate);if(r){const e=r.toLocaleString(a,{month:"long"}),n=r.getDate().toString().padStart(2,"0"),i=r.getFullYear().toString().padStart(4,"0");t.push(`${e} ${n}, ${i}`)}return e.birthPlace&&t.push(e.birthPlace),t.join(", ")},ar=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Identity,title:er(e),content:tr(e),space:oa(t),isProtected:!1}),rr=(e,t)=>{const{expirationMonth:a,expirationYear:r}=e,{expired:n,aboutToExpire:i}=Va(a,r,e.vaultType);return{type:ia.EnhancedItem,itemId:e.id,itemType:Y.k.Passport,title:e.name,content:e.localeFormat,country:e.localeFormat,space:oa(t),expired:n,aboutToExpire:i&&!n,isProtected:!1}},nr=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.PersonalWebsite,title:e.website,content:e.name,space:oa(t),isProtected:!1});const ir=(e,t)=>({type:ia.SimpleItem,itemId:e.id,itemType:Y.k.GeneratedPassword,title:"LAST_GENERATED_BUT_UNSAVED_PASSWORD",isTitleFixedType:!0,content:e.domain,space:oa(t),isProtected:!1,isLinkedWebsite:!1});function or(e){const{vaultItem:t,vaultType:a,premiumStatusSpace:r}=e;switch(a){case Y.k.Address:return _a(t,r);case Y.k.BankAccount:return Ka(t,r);case Y.k.Company:return Ha(t,r);case Y.k.Credential:return qa(t,r);case Y.k.DriverLicense:return za(t,r);case Y.k.Email:return Za(t,r);case Y.k.FiscalId:return Ja(t,r);case Y.k.IdCard:return $a(t,r);case Y.k.Identity:return ar(t,r);case Y.k.GeneratedPassword:return ir(t,r);case Y.k.PaymentCard:return Ya(t,r);case Y.k.Passkey:{const e=t,a=e.rpName.match(/^"(.*)"$/)?.[1]??e.rpName;return{type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Passkey,title:e.userDisplayName,content:a,isProtected:!1}}case Y.k.Passport:return rr(t,r);case Y.k.PersonalWebsite:return nr(t,r);case Y.k.Phone:return function(e,t){return{type:ia.SimpleItem,itemId:e.id,itemType:Y.k.Phone,title:e.numberInternational,content:e.name,communicationType:e.type,space:oa(t),isProtected:!1}}(t,r);case Y.k.SocialSecurityId:return function(e,t){return{type:ia.EnhancedItem,itemId:e.id,itemType:Y.k.SocialSecurityId,title:e.name,content:e.localeFormat,country:e.localeFormat,space:oa(t),isProtected:!0}}(t,r);default:throw new Error("Error: vault type not supported")}}function sr(e,t){switch(t){case Y.k.Credential:{const t=e,a=new de.Y(t.url).getRootDomain(),r=!t.sharingStatus?.isShared||t.sharingStatus.canCopy,n=!t.sharingStatus?.isShared||t.sharingStatus.canEdit,i=!t.sharingStatus?.isShared||t.sharingStatus.canView;return{type:Y.k.Credential,itemId:t.id,title:a,email:t.email,login:t.login,secondaryLogin:t.secondaryLogin,hasPassword:!!t.password,hasOTP:t.hasOtp,canCopy:r,canEdit:n,canView:i}}case Y.k.BankAccount:{const t=e;return{type:Y.k.BankAccount,itemId:t.id,title:t.name,ownerName:t.owner,hasIBAN:!!t.IBAN,hasBIC:!!t.BIC,hasBankCode:!!t.bankCode}}case Y.k.PaymentCard:{const t=e;return{type:Y.k.PaymentCard,itemId:t.id,title:t.name,ownerName:t.ownerName,hasCardNumber:!!t.cardNumber,hasSecurityCode:!!t.securityCode,expireDate:ht(t)}}default:return}}const cr=e=>e.type===Y.k.Credential&&["email","login","secondaryLogin"].includes(e.property),lr=e=>e.type===Y.k.Credential&&"password"===e.property,ur=(e,t)=>{let a=!1,r=!1;for(const{ingredient:t}of e.ingredients)if(a=a||cr(t),r=r||lr(t),a&&r)return{isRecipeForAutologin:!0,isMultiSteps:!1};return a&&!r&&t.includes(Dt.STEP)?{isRecipeForAutologin:!0,isMultiSteps:!0,step:Dt.STEP}:r&&!a&&t.includes(Dt.FINAL)?{isRecipeForAutologin:!0,isMultiSteps:!0,step:Dt.FINAL}:{isRecipeForAutologin:!1,isMultiSteps:!1}},dr=async(e,t)=>(await St({context:e,url:t,vaultType:Y.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}})).filter((e=>Ta(e,t))),pr=async(e,t,a,r)=>{if(!a.tab?.url)return;const n=a.tab.url,i=new de.Y(n).getRootDomain(),o=(e=>{for(const t of Object.keys(e)){const{recipesByField:a,formClassification:r}=e[t];for(const e of Object.keys(a)){const n=a[e].recipesBySourceType[Y.k.Credential];if(n){const{isRecipeForAutologin:a,isMultiSteps:i,step:o}=ur(n,r);if(a)return{formId:t,fieldId:e,recipe:n,isMultiSteps:i,step:o}}}}})(r);if(!o)return;const s=await dr(e,n);if(0===s.length||await(async e=>Object.keys((await e.state.tab.get()).persistentWebcards??{}).length>0)(e))return;let c=await e.connectors.carbon.getSpaces();c=c.length>1?c:[];const l={webcardId:(0,O.Z)(),webcardType:Gt.AutologinSelection,webcards:s.map((e=>or({vaultType:Y.k.Credential,vaultItem:e,premiumStatusSpace:c.find((t=>t.spaceId===e.spaceId))}))),formType:r[o.formId].formClassification,tabRootDomain:i,extensionShortcuts:await(0,Rt.Y)(),autofillRecipes:{[Y.k.Credential]:o.recipe}},u=await async function(e){return await z(e,_.S.AutofillWebAskBeforeAutologin)}(e.connectors),d=await e.state.tab.get();if(1!==s.length||u)d.lastAutologin?.domain!==i&&(t.showWebcard(N.MainFrame,l),await e.state.tab.set({...d,lastAutologin:{domain:i,isMultiSteps:o.isMultiSteps,step:o.step}}));else{if((await aa(e,s[0].id,Y.k.Credential)).isProtected)return;const r={autofillRecipe:o.recipe,dataSource:{type:Y.k.Credential,vaultId:l.webcards[0].itemId},formClassification:l.formType,requestOrigin:{type:we.Automatic}};await Fa(e,t,a,r)}},mr=e=>e.type===se.JV.NewPassword,wr=e=>e.type===Y.k.Credential&&"password"===e.property,gr=e=>(e.type===Y.k.Email||e.type===Y.k.Credential)&&"email"===e.property,yr=e=>e.type===Y.k.Credential&&"login"===e.property||e.type===Y.k.Identity&&"pseudo"===e.property,br=e=>e.type===Y.k.Credential&&"secondaryLogin"===e.property,hr=async(e,t,a)=>{const r=Object.values(e),n=await a.state.tab.get(),i=n.dataCaptureStepData,o=r.filter((({ingredients:e})=>e.some(mr))),s=r.find((({ingredients:e})=>e.some(wr)))?.value;if(!o.every((e=>e.value===o[0].value)))return;const c=o[0]?.value??s,l=r.find((({ingredients:e})=>e.some(gr)))?.value??i?.capturedData.capturedEmail,u=r.find((({ingredients:e})=>e.some(yr)))?.value??i?.capturedData.capturedLogin,d=r.find((({ingredients:e})=>e.some(br)))?.value??i?.capturedData.capturedSecondaryLogin,p=l??u,m=new de.Y(t).getRootDomain();if(c)return{capturedPassword:c,capturedEmail:l,capturedLogin:u,capturedSecondaryLogin:d,capturedEmailOrLogin:p};await a.state.tab.set({...n,dataCaptureStepData:{domain:m,capturedData:{capturedEmail:l,capturedLogin:u,capturedSecondaryLogin:d},firstStepUrl:t}})},fr=async e=>{const t=await e.state.tab.get();t.dataCaptureStepData&&await e.state.tab.set({...t,dataCaptureStepData:void 0})},Sr=e=>{const t=new de.Y(e).getRootDomainName();return"amazon"===t?new de.Y(e).getRootDomain():"microsoftonline"===t?new de.Y(e).getHostname():e},Ar=async e=>{try{const t=await(0,te.O)(e.grapheneClient.autofillSettings.queries.getUserAutofillCorrections());return(0,K.d6)(t)&&(0,ce.P)(t.data)?t.data:[]}catch(t){return e.logException(t,{message:"Error when retrieving user autofill corrections",fileName:"user-autofill-correction.ts",funcName:"getUserAutofillCorrections"}),[]}},Cr=async(e,t,a,r)=>{const n=new de.Y(t).getHostname(),i={id:(0,O.Z)(),fieldIdentifier:a,domain:n,correctedDataSource:r},o=await Ar(e),s=o.findIndex((e=>e.domain===i.domain&&e.fieldIdentifier===i.fieldIdentifier));s>=0?o[s]=i:o.push(i),e.grapheneClient.autofillSettings.commands.setUserAutofillCorrections({corrections:o})};var Ir=a(37233);const Tr=async(e,t,a)=>{const r=!1!==(await e.carbon.getGlobalExtensionSettings().catch((()=>({personalDataConsent:!1})))).personalDataConsent,n=await(0,te.O)(t.autofillSettings.queries.getAnalysisStatusOnUrl({url:a}));return r&&(0,K.d6)(n)&&n.data.analysisStatus===Ir._.ANALYSIS_ENABLED},kr=async(e,t,a,r,n)=>{const i=await Tr(e,t,n);a.updateDomainAnalysisStatus(r,i),i||a.updateAutofillRecipes(r,{})},Mr=async(e,t,a,r,n,i)=>{const o=i?await j(e):{};a.updateUserLoginStatus(r,i),a.updateUserFeatureFlips(r,o),await kr(e,t,a,r,n)};var Pr=a(89238),Er=a(15340);const vr=e=>{const t=[];return e?.appid&&t.push(V.WebauthnExtensionId.Appid),e?.credProps&&t.push(V.WebauthnExtensionId.CredProps),e?.hmacCreateSecret&&t.push(V.WebauthnExtensionId.HmacSecret),t};async function Nr({context:e,rpId:t,displayName:a,currentDomain:r}){const n=await e.connectors.carbon.getNodePremiumStatus();if(n.b2bStatus?.currentTeam){const n=$(W.b.UserAuthenticatedWithPasskey,{passkey_domain:t,current_domain:r,credential_login:a});await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[n]})}}async function Rr(e,t,a,r){const n=e.options.pubKeyCredParams.map((e=>Zt[e.alg]));return new V.AnonymousRegisterPasskeyEvent({algorithmsSupportedList:n,authenticatorAttachment:Yt(e.options.authenticatorSelection?.authenticatorAttachment,_t),authenticatorResidentKey:Yt(e.options.authenticatorSelection?.residentKey,Kt),authenticatorUserVerification:Yt(e.options.authenticatorSelection?.userVerification,Ht),domain:{type:V.DomainType.Web,id:await(0,V.hashDomain)(e.options.rp.id??"")},isRegisteredWithDashlane:t===V.CeremonyStatus.Success,msToCompleteRegistration:r,msToCompleteRegistrationTimeout:e.options.timeout,passkeyRegistrationErrorType:Yt(a,qt),passkeyRegistrationStatus:t,webauthnExtensionSupportedList:vr(e.options.extensions)})}async function Dr(e,t,a,r,n,i){r===V.CeremonyStatus.Success&&await Nr({context:e,rpId:t.options.rp.id??"",currentDomain:a.tab?.url?new de.Y(a.tab.url).getHostname():"",displayName:t.options.user.displayName}),await e.connectors.carbon.logEvent({event:await Rr(t,r,n,i)})}async function Fr(e,t,a,r){return new V.AnonymousAuthenticateWithPasskeyEvent({authenticationMediationType:Yt(e.mediation,zt),authenticatorUserVerification:Yt(e.options.userVerification,Ht),domain:{type:V.DomainType.Web,id:await(0,V.hashDomain)(e.options.rpId??"")},hasCredentialsAllowed:!!e.options.allowCredentials,isAuthenticatedWithDashlane:t===V.CeremonyStatus.Success,msToCompleteAuthentication:r,msToCompleteAuthenticationTimeout:e.options.timeout,passkeyAuthenticationErrorType:Yt(a,jt),passkeyAuthenticationStatus:t,webauthnExtensionSupportedList:vr(e.options.extensions)})}async function Lr(e,t,a,r,n,i,o){r===V.CeremonyStatus.Success&&await Nr({context:e,rpId:t.options.rpId??"",currentDomain:a.tab?.url?new de.Y(a.tab.url).getHostname():"",displayName:o??""}),await e.connectors.carbon.logEvent({event:await Fr(t,r,n,i)})}const Ur=(e,t)=>({sortToken:{sortCriteria:[{field:"lastUse",direction:"descend"}],uniqField:"rpId"},filterToken:{filterCriteria:t?[{type:"matches",value:t}]:[]},domain:e});function Br(e,t,a){const r=new de.Y(t).getHostname();return e.connectors.carbon.getPasskeysForDomain(Ur(r,a))}class Gr extends Error{constructor(e){super(),(0,r._)(this,"errorName",void 0),this.errorName=e?.logError}}class xr extends Error{constructor(e){super(),(0,r._)(this,"errorName",void 0),this.errorName=e}}var Vr=function(e){return e[e.USER_PRESENT=1]="USER_PRESENT",e[e.USER_VERIFIED=4]="USER_VERIFIED",e[e.BACKUP_ELIGIBILITY=8]="BACKUP_ELIGIBILITY",e[e.BACKUP_STATE=16]="BACKUP_STATE",e[e.ATTESTED_CRED_DATA_INCLUDED=64]="ATTESTED_CRED_DATA_INCLUDED",e[e.EXTENSION_DATA_INCLUDED=128]="EXTENSION_DATA_INCLUDED",e}({});const Or=(e,t)=>{const a=(new TextEncoder).encode(t);return e.crypto.subtle.digest("SHA-256",a)},Wr=e=>{const t=[];for(const a of e){t.push(a.id);try{const e=(0,Er.N)(a.id),r=new TextDecoder("utf-8",{fatal:!0});t.push(r.decode(e))}catch(e){}}return t},Yr=async(e,t,a,r)=>{const n=(await Br(e,t,r)).items,i=Wr(a);return a.length>0?n.filter((e=>i.includes(e.credentialId))):n},_r=e=>{if(!e?.startsWith("https://"))return;const t=new de.Y(e),a=t.getHostname();return a&&""!==a&&!t.isUrlIP()?{effectiveDomain:a,requestOrigin:e}:void 0},Kr=(e,t)=>!(e===t||t.endsWith(`.${e}`))||!1,Hr=(e,t)=>{if(0!==e.frameId&&(0!==t.parentFrameId||t.type===Bt.Create))throw new xr(Ut.NotAllowedError);const a=e.url?new URL(e.url).origin:void 0,r=e.origin??a,n=_r(r);if(!n)throw new xr(Ut.NotAllowedError);const{effectiveDomain:i,requestOrigin:o}=n,s=t.publickeyCredentialsPermissionList?.map((e=>_r(e)?.effectiveDomain));if(0!==e.frameId&&!s?.includes(i))throw new xr(Ut.NotAllowedError);if(1===t.options.hints?.length&&t.options.hints.includes("security-key"))throw new xr(Ut.NotAllowedError);return{effectiveDomain:i,requestOrigin:o}},qr=(e,t,a,r)=>{let n;const i=r;n=sa(i)?i.request:r;const o={status:"error",errorName:Ut.NotAllowedError};switch(n.type){case Bt.Create:Dr(e,n,a,V.CeremonyStatus.Cancelled),t.webauthnCreateResponse(N.AllFrames,n.requestId,o);break;case Bt.Get:Lr(e,n,a,V.CeremonyStatus.Cancelled),t.webauthnGetResponse(N.AllFrames,n.requestId,o)}return Promise.resolve()},jr=async(e,t,a)=>{const r=await e.state.tab.get();await e.state.tab.set({...r,pendingWebauthnOperations:{...r.pendingWebauthnOperations,[t]:{origin:a}}})},zr=async(e,t)=>{const a=await e.state.tab.get(),{[t]:r,...n}=a.pendingWebauthnOperations??{};return await e.state.tab.set({...a,pendingWebauthnOperations:n}),r?.origin},Zr=async(e,t,a)=>(await Promise.all(a.map((t=>e.connectors.carbon.getSinglePasskeyForAutofill(t.id))))).map((e=>({webcardItem:{...or({vaultType:Y.k.Passkey,vaultItem:e,premiumStatusSpace:rn(e,t)}),metadataKeys:[xt.WebauthnRequest]},vaultItem:e}))),Jr=e=>/[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}/i.test(e)?"uuid":"base64URL",$r=e=>crypto.getRandomValues(new Uint8Array(e)),Qr=async(e,t,a,r)=>{const n=a.type===Bt.Create?a.options.authenticatorSelection?.userVerification:a.options.userVerification,i=void 0!==n&&["discouraged","preferred","required"].includes(n)?n:"preferred";const o=(await Xt(e)).every((e=>e===Qt.W.MasterPassword||e===Qt.W.Pin)),s="preferred"===i&&!o||"required"===i;if(!a.userVerificationDone&&s){const n={source:a.type===Bt.Create?V.AuthenticatorUserVerificationSource.PasskeyRegistration:V.AuthenticatorUserVerificationSource.PasskeyLogin},i={type:ua.Webauthn,request:a},o=await ea(e,i,n,r);return t.updateWebcard(N.SenderFrame,o),"stop"}return t.closeWebcard(N.SenderFrame,r),"continue"},Xr=async(e,t,a,r,n)=>{const i=a.conditionalUiRequest;if("conditional"!==i?.mediation)return[];const{effectiveDomain:o}=Hr(t,i),s=i.options.rpId??o;if(Kr(s,o))return[];if("required"===i.options.userVerification&&await e.connectors.carbon.getIsSSOUser())return[];const c=await Yr(e,s,i.options.allowCredentials??[],n),l=await Zr(e,r,c),u=i.options.userVerification,d=(await Xt(e)).every((e=>e===Qt.W.MasterPassword||e===Qt.W.Pin));return"preferred"===u&&!d||"required"===u?l.map((({webcardItem:e,vaultItem:t})=>({webcardItem:{...e,closeOnSelect:!1},vaultItem:t}))):l},en=20,tn=async(e,t,a,r,n,i)=>{let o=[];const s=a.type,c=new de.Y(t).getRootDomain();return o=s===Y.k.GeneratedPassword?await St({context:e,url:t,vaultType:s,queryOptions:{sortCriteria:[{field:"generatedDate",direction:"descend"}],filterCriteria:[{field:"domain",type:"equals",value:c}]},limit:1,needDashlaneLinkedWebsites:i}):r?(await At({context:e,searchQuery:r,domain:t,itemTypes:[s],sorting:{property:"lastUse",direction:"descend"},limit:n,needDashlaneLinkedWebsites:i})).items:await St({context:e,url:t,vaultType:s,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]},limit:n,needDashlaneLinkedWebsites:i}),l=o,u=async r=>(!(s===Y.k.Credential)||Ta(r,t))&&(Boolean(await Pa(e,{ingredient:a,vaultItem:r}))||Boolean(kt(a,r))),Promise.all(l.map(u)).then((e=>l.filter(((t,a)=>e[a]))));var l,u};const an=async(e,t,a,r,n,i)=>{const o={warningType:Wt.None,warningContext:""};if(Sa(t))return{warningType:Wt.UnsecureProtocol,warningContext:""};if(n&&i.some((e=>e.itemType===Y.k.Credential)))return{warningType:Wt.UnsecureIframe,warningContext:"UIF@sandbox".slice(0,50)};const s=new de.Y(r).getRootDomain();if(a&&s&&a!==s){const t=(await St({context:e,vaultType:Y.k.Credential,url:r})).map((e=>e.id));if(!i.some((e=>e.itemType===Y.k.Credential&&t.includes(e.itemId))))return{warningType:Wt.UnsecureIframe,warningContext:`UIF@${r}`.slice(0,50)}}return o},rn=(e,t)=>{if("spaceId"in e)return t.find((t=>t.spaceId===e.spaceId))};async function nn(e,t,a,r,n){const i=r.autofillRecipes;let o=await e.connectors.carbon.getSpaces();o=o.length>1?o:[];const s={};let c={};const l=Object.entries(i);return await Promise.all(l.map((async([i,l])=>{const u=Object.keys(s).reduce(((e,t)=>e+t.length),0);if(!(u>=en&&(0,se.Wm)(i))){if(i===se.JV.WebauthnConditionalUI&&r.conditionalUiRequest){const t=await Xr(e,a,r,o,n);t.length>0&&(s[Y.k.Passkey]=t),c=ca(c,{type:xt.WebauthnRequest,request:r.conditionalUiRequest})}if((0,se.Wm)(i)){if(i===Y.k.Passkey&&s[Y.k.Passkey])return void e.logException(new Error("Can not create webcard items for both conditional UI and passkey autofill at the same time"),{fileName:"userFocusOnElementHandler.ts",funcName:"buildAutofillDropdownWebcardItems"});const a=await async function(e,t,a,r,n,i,o,s){const c=n.ingredients.find((({frameId:e,srcElementId:t})=>e===a.frameId&&t===a.elementId))?.ingredient;if(!c||!pe(c)||r!==c.type)return[];const l=Ne(a.formClassification);return(await tn(e,t,c,s,o)).filter((e=>!l.includes("change_password")||e.vaultType!==Y.k.Credential||!e.sharingStatus?.isShared||e.sharingStatus.canEdit)).map((e=>({webcardItem:or({vaultType:r,vaultItem:e,premiumStatusSpace:rn(e,i)}),vaultItem:e})))}(e,t,r,i,l,o,en-u+1,n);s[i]=a}}}))),{webcardItemsByType:s,metadata:c}}async function on(e,t,a,r,n){const i=await nn(e,t,a,r,n);let{webcardItemsByType:o}=i;if(Ne(r.formClassification).includes("login")&&(o[Y.k.Credential]?.length||o[Y.k.Passkey]?.length)&&(o={[Y.k.Credential]:o[Y.k.Credential]??[],[Y.k.Passkey]:o[Y.k.Passkey]??[]}),o[Y.k.Credential]?.length&&o[Y.k.Email]?.length){const e=o[Y.k.Credential].map((({vaultItem:e})=>e.email)),t=o[Y.k.Email].filter((({vaultItem:t})=>!e.includes(t.email)));o[Y.k.Email]=t}return{webcardItems:Object.values(o).flatMap((e=>e)).map((e=>e.webcardItem)),metadata:i.metadata}}async function sn(e,t,a,r){const n=t.formClassification,i=new de.Y(a).getRootDomain(),o=await vt(e),s=await Nt(e),c=e.connectors.carbon,l=await c.getPasswordGenerationSettings(),{warningType:u,warningContext:d}=await async function(e,t,a,r){const n={warningType:Wt.None,warningContext:""};if(r)return{warningType:Wt.B2BDiscontinued,warningContext:""};if(Sa(e))return{warningType:Wt.UnsecureProtocol,warningContext:""};if(Aa(t,"change_password")){const t=await a.connectors.carbon.getUserLoginStatus(),[r,n]=[new de.Y(ha(t.login)).getRootDomainName(),new de.Y(e).getRootDomainName()],i=Fe[n]??[];if(r&&(i.includes(r)||r===n))return{warningType:Wt.PasswordGenerationDashlaneLogin,warningContext:""}}if(Aa(t,"register")){const t=await St({context:a,url:e,vaultType:Y.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}});return t.length>0?{warningType:Wt.PossibleDuplicateRegistration,warningContext:t[0].id}:n}return n}(a,n,e,s.isB2BDiscontinued);return{webcardId:r??(0,O.Z)(),webcardType:Gt.AutofillDropdown,configuration:Vt.GeneratePassword,passwordLimitStatus:o,passwordGenerationSettings:l,formType:n,srcElement:t,autofillRecipes:t.autofillRecipes,warningType:u,context:d,tabRootDomain:i,showAccountFrozenStatus:s}}async function cn(e,t,a,r,n,i){const o=await async function(e,t,a,r,n,i=(0,O.Z)()){const o=n.autofillRecipes,s=new de.Y(t).getRootDomain(),{webcardItems:c,metadata:l}=await on(e,t,r,n),u=Object.keys(o).filter(se.Wm),d=n.frameSandboxed,p=n.conditionalUiRequest,m=!l[xt.WebauthnRequest],w=!!l[xt.WebauthnRequest],{warningType:g,warningContext:y}=await an(e,t,s,a,d,c);return{webcardId:i,webcardType:Gt.AutofillDropdown,configuration:Vt.Classic,items:c,moreItemsAvailable:c.length>en,formType:n.formClassification,srcElement:n,autofillRecipes:o,warningType:g,context:y,fieldType:u,tabRootDomain:s,tabUrl:t,metadata:l,withSearch:m,withNonDashlaneKeyButton:w,webauthnRequest:p}}(e,t,a,r,n,i);return 0===o.items.length&&n.autofillRecipes[se.JV.NewPassword]?sn(e,n,t,i):o}const ln=(e,t)=>({matching:e.extra.filter((e=>t.includes(e))).length,nonMatching:e.extra.filter((e=>!t.includes(e))).length+t.filter((t=>!e.extra.includes(t))).length}),un=(e,t,a,r,n)=>t>r||t===r&&a<n||t===r&&a===n&&0===Object.keys(e).length,dn=(e,t)=>{let a,r=0,n=1e3;const i=he[e][t.main];if(i){for(const e of i){const{matching:i,nonMatching:o}=ln(t,e.extraValues);a&&!un(a.source,i,o,r,n)||(a=e,r=i,n=o)}return a}},pn=(e,t,a,r,n)=>{const i=e.type===se.JV.SubmitButton?Y.k.Credential:e.type,o=n[i]??{ingredients:[]};return n[i]=o,o.ingredients.push({frameId:t,srcElementId:a,fieldClassification:r,ingredient:e}),o},mn=(e,t,a,r,n,i)=>{const o=a.context.rId,s=i[o]??{fieldId:o,frameId:a.iframeId,fieldClassification:a.classification,fieldFormat:r,persistentIdentifier:n,knownValue:!1,recipesBySourceType:{}};i[o]=s;const c=s.recipesBySourceType[t]??e;s.recipesBySourceType[t]=c},wn=(e,t)=>{const a=[];return e&&Object.keys(e).forEach((r=>{a.push({type:r,property:e[r],format:t})})),a},gn=(e,t)=>`ML@${`form-${e.context.attributes}`}@${`${t.context.type.toLowerCase()}-${t.context.attributes}`}`,yn=(e,t,a)=>{var r,n;if(r=e.classification,n="part",ve(r).some((e=>e.extra.includes(n))))return"number"==typeof a&&e.classification===t?.classification&&e.context.type===t.context.type?a+1:0},bn=(e,t,a)=>{const r={},n={};let i;return e.fields.forEach(((o,s)=>{const c=yn(o,e.fields[s-1],i),l=[],u={dateFormat:o.context.dateFormat,dateSeparator:o.context.dateSeparator,partNumber:c,optionLabels:o.context.optionLabels,optionValues:o.context.optionValues};i=c;const d=t.find((t=>t.fieldIdentifier===gn(e,o)));d?((e,t,a)=>{(0,ce.w)(t)||e.push(...wn(t.correctedDataSource,a))})(l,d,u):((e,t,a,r,n)=>{const i=Ne(a),o=ve(t);let s,c=0,l=1e3;for(const e of i)for(const t of o){const a=dn(e,t)??dn("default",t);if(!a)continue;const{matching:r,nonMatching:n}=ln(t,a.extraValues);s&&!un(s,r,n,c,l)||(s=a.source,c=r,l=n)}const u=Object.keys(s??{}).filter((e=>(0,se.Wm)(e)?!n.includes(le.Z[e]):!(0,se.$b)(e)||!n.includes(ue.dJ.KWAuthentifiant))).reduce(((e,t)=>(e[t]=(s??{})[t],e)),{});e.push(...wn(u,r)),o.some((({main:e})=>"webauthn"===e))&&!Object.keys(u).includes(se.JV.WebauthnConditionalUI)&&e.push(...wn({[se.JV.WebauthnConditionalUI]:se.JV.WebauthnConditionalUI}))})(l,o.classification,e.classification,u,a);for(const t of l){const a=pn(t,o.iframeId,o.context.rId,o.classification,n);mn(a,t.type,o,u,gn(e,o),r)}})),Aa(e.classification,"login")||((e,t)=>{const a=Object.entries(t),r=[se.JV.NewPassword,Y.k.Credential,Y.k.GeneratedPassword,Y.k.PaymentCard,Y.k.SocialSecurityId];Object.values(e).forEach((e=>{const t=Object.keys(e.recipesBySourceType);if(t.includes(se.JV.NewPassword))return;const n={};a.forEach((([e,a])=>{t.includes(e)||r.includes(e)||(n[e]={ingredients:a.ingredients})})),Object.keys(n).length>0&&Object.values(e.recipesBySourceType).forEach((e=>{e.postfillRecipes=n}))}))})(r,n),r},hn=(e,t,a)=>a.some((a=>a.fieldIdentifier===gn(t,e)&&(0,ce.w)(a))),fn=async(e,t,a)=>{const r=Object.entries(a.recipesBySourceType);for(const[n,i]of r){if(a.knownValue)return;const r=i.ingredients.find((({frameId:e,srcElementId:t})=>e===a.frameId&&t===a.fieldId));if(!r)continue;const o=r.ingredient;o.type===Y.k.Credential?a.knownValue=o.type===n&&pe(o)&&(await tn(e,"",o,new de.Y(t).getRootDomain(),en,!0)).length>0:a.knownValue=!(0,se.Wm)(n)||o.type===n&&pe(o)&&(await tn(e,t,o,void 0,en,!0)).length>0}};const Sn=(e,t,a,r)=>{Cr(e,a,r.srcElement.persistentIdentifier,"none");const n={...r.srcElement,autofillRecipes:Cn(r.srcElement),formClassification:r.formType};t.updateWebcard(N.SenderFrame,function(e,t){return{webcardId:t??(0,O.Z)(),configuration:Vt.FieldDisabledNotification,webcardType:Gt.AutofillDropdown,srcElement:e,formType:e.formClassification,autofillRecipes:e.autofillRecipes}}(n,r.webcardId))},An=(e,t,a,r,n)=>a.tab?.url?(t.disableDashlaneOnField(N.AllFrames,r.srcElement.elementId),n===be.PermanentlyDisable&&Sn(e,t,a.tab.url,r),Promise.resolve()):Promise.resolve(),Cn=(e,t)=>{const{elementId:a,frameId:r}=e,n={},i=wn(t,e.fieldFormat);for(const e of i)pn(e,r,a,"",n);return n};var In=a(96158);var Tn=a(92386);const kn=async(e,t,a,r,n)=>{const i=await n.get();if(!i.isRightClickMenuLive)try{await e.contextMenus.removeAll();const t=await(async e=>await z(e,_.S.EnableVortex))(r),a=t&&!Tn.isSafari(),o=await(0,A.U)({title:"Dashlane",contexts:[a?"all":"editable"],id:a?"dashlane-right-click-menu":"correct-autofill"});a&&(await(0,A.U)({title:"Capture the page as zip",parentId:o,id:"capture-page",contexts:["all"]}),await(0,A.U)({title:"Select an item to autofill",parentId:o,id:"correct-autofill",contexts:["editable"]})),o&&await n.set({...i,isRightClickMenuLive:!0})}catch(e){n.set({...i,isRightClickMenuLive:!1}),a(e,{message:"Failed to create the right-click menu",fileName:"userRightClickOnElementHandler.ts",funcName:"createRightClickMenu"})}};function Mn(e,t,a,r,n=(0,O.Z)()){const{warningType:i,warningContext:o}=function(e,t,a,r){const n={warningType:Wt.None,warningContext:""};return Sa(e)?{warningType:Wt.UnsecureProtocol,warningContext:""}:t&&a&&t!==a?{warningType:Wt.UnsecureIframe,warningContext:`UIF@${a}`.slice(0,50)}:r?{warningType:Wt.UnsecureIframe,warningContext:"UIF@sandbox".slice(0,50)}:n}(e,t,a,r.frameSandboxed);return{webcardId:n,configuration:Vt.SelfCorrecting,webcardType:Gt.AutofillDropdown,formType:r.formClassification,srcElement:r,autofillRecipes:{},warningType:i,context:o,fieldType:void 0,tabRootDomain:t,elementHasImpala:r.elementHasImpala}}const Pn={analysisResultsAvailable:async(e,t,a,r)=>{if(!a.tab?.url)return;const n=a.tab.url;if(!await Tr(e.connectors,e.grapheneClient,n))return void t.updateAutofillRecipes(N.AllFrames,{});const i=new de.Y(n).getRootDomain(),o=new de.Y(n).getHostname(),{loggedIn:s}=await e.connectors.carbon.getUserLoginStatus();let c=[],l=[];if(s){const t=await(0,te.O)(e.grapheneClient.autofillSettings.queries.getAutofillSettings());l=(0,K.d6)(t)?t.data.disabledSourceTypes:[],c=(await Ar(e)).filter((e=>e.domain===o))}const u=((e,t,a)=>{const r={};for(const n of e.formElements){const e=n.context.rId;r[e]={formId:e,frameId:n.iframeId,frameSandboxed:n.sandboxed,formClassification:n.classification,recipesByField:bn(n,t,a)}}return r})(r,c,l),d=((e,t)=>{const a=[];for(const r of e.formElements){const e=r.fields.filter((e=>"other"===e.classification||hn(e,r,t)));e.length>0&&a.push(...e.map((e=>({...e,persistentIdentifier:gn(r,e),formId:r.context.rId}))))}return a})(r,c),p=Object.values(u).some((e=>Object.values(e.recipesByField).some((e=>se.JV.WebauthnConditionalUI in e.recipesBySourceType)))),m=await e.state.tab.get();i!==m.lastAutologin?.domain&&await e.state.tab.set({...m,lastAutologin:void 0}),m.dataCaptureStepData&&i!==m.dataCaptureStepData.domain&&!(await Mt(e,n)).includes(m.dataCaptureStepData.domain)&&await fr(e),s&&await(async(e,t,a)=>{for(const r in a)for(const n in a[r].recipesByField)await fn(e,t,a[r].recipesByField[n])})(e,n,u),t.updateAutofillRecipes(N.AllFrames,u),t.updateUnrecognizedElements(N.AllFrames,d);!(s&&p&&(await St({context:e,url:r.url,vaultType:Y.k.Passkey,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]},limit:1})).length>0)&&await(async(e,t,a)=>{if(Sa(e))return!1;const{loggedIn:r}=await a.connectors.carbon.getUserLoginStatus();if(!r)return!1;const n=await(0,te.O)(a.grapheneClient.autofillSettings.queries.getAutofillSettings());if((0,K.d6)(n)&&n.data.isAutologinDisabled)return!1;if((await Nt(a)).isB2CFrozen)return!1;const i=t.formElements.filter((e=>Aa(e.classification,"login")));if(1!==i.length)return!1;const o=i[0];return new de.Y(o.iframeUrl).getHostname()===new de.Y(e).getHostname()&&!o.hasCaptcha&&!o.sandboxed})(n,r,e)&&await pr(e,t,a,u)},documentComplete:async(e,t,a)=>{if(!a.tab||"number"!=typeof a.frameId||!a.url)return;const r=await e.connectors.carbon.getUserLoginStatus().then((({loggedIn:e})=>e));if(t.updateClientFrameId(N.SenderFrame,a.frameId),await Mr(e.connectors,e.grapheneClient,t,N.SenderFrame,a.url,r),t.updateTabActiveInfo(N.SenderFrame,a.tab.highlighted||a.tab.active),0===a.frameId&&a.tab.id)try{await(0,In.Q)({target:{tabId:a.tab.id},origin:"USER",files:["content/webui/webui-frame.css"]})}catch{}await(async(e,t)=>{const a=await e.state.tab.get();if(a.persistentWebcards){const{persistentWebcards:r,...n}=a;if((await e.connectors.carbon.getUserLoginStatus()).loggedIn)for(const e in r)r[e].isRestoredWebcard=!0,t.showWebcard(N.MainFrame,r[e]);else await e.state.tab.set({...n})}})(e,t)},applySelfCorrectingAutofill:async(e,t,a,r,n)=>{if(!a.tab?.url)return;const{formType:i,srcElement:o,webcardId:s,context:c,warningType:l}=r;if(Cr(e,a.tab.url,o.persistentIdentifier,n.dataSource),"none"===n.dataSource)return void An(e,t,a,r,be.PermanentlyDisable);const u={...o,autofillRecipes:Cn(o,n.dataSource),formClassification:i},d={...await cn(e,a.tab.url,a.url??"",a,u,s),context:c,warningType:l};await(async(e,t,a,r,n)=>{const{autofillRecipes:i,configuration:o,formType:s,srcElement:c,webcardId:l}=r,u=n??(o===Vt.Classic&&1===r.items.length?r.items[0]:void 0);if(u){t.closeWebcard(N.SenderFrame,l);const r=i[u.itemType];r&&await Fa(e,t,a,{autofillRecipe:r,dataSource:{type:u.itemType,vaultId:u.itemId},formClassification:s,focusedElement:c,requestOrigin:{type:we.UserAppliedAutofillCorrection}})}else t.updateWebcard(N.SenderFrame,r)})(e,t,a,d,n.selectedItem)},disableDashlaneOnField:An,userRightClickOnElement:async(e,t,a,r)=>{if(!a.tab?.url||!a.url)return;if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return void await G.openWebapp(e,t,a,{});const n=(await Nt(e)).isB2CFrozen,{limit:i}=await vt(e);n&&!i&&e.logException(new Error("User is frozen but there is no known password limit"));const o=new de.Y(a.url).getRootDomain(),s=new de.Y(a.tab.url).getRootDomain(),c=n&&i?function(e,t,a=(0,O.Z)()){return{autofillRecipes:{},configuration:Vt.AccountFrozen,formType:e.formClassification,srcElement:e,webcardId:a,webcardType:Gt.AutofillDropdown,passwordLimit:t}}(r,i):Mn(a.tab.url,s,o,r);t.showWebcard(N.MainFrame,c)}};var En=a(24860),vn=a(42775);async function Nn(e,t,a,r){const n=await(0,te.O)(e.connectors.grapheneClient.autofillSettings.queries.getAutofillSettings());if((await Nt(e)).isB2CFrozen)return;if((0,K.d6)(n)&&!n.data.isFollowUpNotificationEnabled)return;const i=sr(r,a.type);if(!i)return;let o;for(o in i)""===i[o]&&delete i[o];const s={webcardType:Gt.FollowUpNotification,webcardId:(0,O.Z)(),formType:"",webcardData:i,copiedProperties:[a.property]};t.storeFollowUpNotificationItemId(N.MainFrame,i.itemId),t.showWebcard(N.MainFrame,s)}const Rn=/^[A-Za-z+\-.]+:\/\//;async function Dn(e,t,a,r,n){const i=await async function(e,t){const a=new de.Y(t.url),r=a.getRootDomain(),n=a.getHostname(),i=Rn.exec(t.url)?.[0]??"https://",o=(await Mt(e,t.url)).filter((e=>e!==r)),s=o.concat(t.userAddedLinkedWebsites.map((e=>new de.Y(e).getRootDomain())));return{rootDomain:r,hostname:n,urlProtocol:i,dashlaneDefinedLinkedWebsites:o,linkedWebsites:s}}(e,a),o=new de.Y(t),s=o.getRootDomain(),c=o.getHostname(),l=Rn.exec(t)?.[0]??"",u=r.type===Y.k.Credential,d=Sa(l)&&!Sa(i.urlProtocol),p=(d?i.urlProtocol:"")+i.rootDomain,m=(d?l:"")+s,w=!n.noPhishingAlertLimitFlagPresent&&await Et(e,p,m),g=!i.linkedWebsites.includes(s)&&(i.rootDomain!==s||Le.includes(s)&&i.hostname!==c),y=u&&i.rootDomain&&!w&&(g||d);if(y&&!n.pasteBlocked)return e.logException(new Error("Paste should have been blocked but wasn't"),{fileName:"data-paste-detected-handler.ts",funcName:"dataPasteDetectedHandler"}),{decision:"noAction"};if(y&&n.pasteBlocked){return{decision:"showWebcard",vaultItemRootDomain:p,tabRootDomain:p===m?c:m}}return{decision:"allowPaste",vaultItem:a}}const Fn={dataCopiedToClipboardDetected:async(e,t,a,r,n,i)=>{let o;if(i.type===Y.k.Credential)try{const t=await ft(e,i.type,n);o=t?await(0,vn.W)(En.x,new de.Y(t.url).getHostname()):void 0}catch(t){e.logException(t,{message:"Failed to retrieve credential domain",fileName:"user-paste-information-handler.ts",funcName:"dataCopiedToClipboardDetected"})}t.dataCopiedAlert(N.AllFrames,r,n,i,o)},dataPasteDetected:async(e,t,a,r,n,i)=>{try{const o=await async function(e,t,a,r,n){if(!t.tab?.url)throw new Error("Unexpected missing tab url");const i=await ft(e,r.type,a);if(!i)throw new Error("Can not find source item of the copy");return(await Nt(e)).isB2CFrozen?{decision:"allowPaste",vaultItem:i}:await Pt(e)&&i.vaultType===Y.k.Credential?Dn(e,t.tab.url,i,r,n):{decision:"allowPaste",vaultItem:i}}(e,a,r,n,i);"showWebcard"===o.decision?((e,t,a,r)=>{const n={webcardType:Gt.PhishingPrevention,webcardId:(0,O.Z)(),formType:"",urlOfCopiedItem:t.vaultItem,urlOfPasteDestination:t.tab,metadata:la({type:xt.PhishingPrevention,itemId:r,vaultIngredient:a})};e.showWebcard(N.MainFrame,n)})(t,{vaultItem:o.vaultItemRootDomain,tab:o.tabRootDomain},n,r):"allowPaste"===o.decision&&(i.pasteBlocked&&t.permissionToPaste(N.AllFrames,!0),await Nn(e,t,n,o.vaultItem))}catch(a){e.logException(a,{fileName:"data-paste-detected-handler.ts",funcName:"dataPasteDetectedHandler"}),i.pasteBlocked&&t.permissionToPaste(N.AllFrames,!0)}},copyToClipboard:async(e,t,a,r,n,i,o)=>{if(!a.url||!a.tab?.url)return;const s=await ft(e,n.type,r);if(!s)return;if((await aa(e,r,n.type)).isProtected){const a={type:ua.CopyValue,itemId:r,vaultIngredient:n,previouslyCopiedProperties:o},s=await e.connectors.carbon.getIsSSOUser(),c=await e.connectors.carbon.getAccountAuthenticationType(),l=s||"masterPassword"!==c,u={source:V.AuthenticatorUserVerificationSource.CopyVaultItem},d=l?{webcardId:i,webcardType:Gt.AutofillConfirmationPasswordLess,pendingCopyOperation:a,formType:"login"}:await ea(e,a,u,i);t.updateWebcard(N.MainFrame,d)}else{const a=await Pa(e,{ingredient:n,vaultItem:s});a&&t.copyValueToClipboard(N.AllFrames,a)}},signalPasteDecision:async(e,t,a,r,n)=>{if(!a.url||!a.tab?.url)return;t.permissionToPaste(N.AllFrames,r.allowedByUser);const i=n?.[xt.PhishingPrevention];r.allowedByUser&&i&&function(e){return e.type===xt.PhishingPrevention&&"itemId"in e&&"vaultIngredient"in e}(i)&&await async function(e,t,a,r,n){e.grapheneClient.autofillSecurity.commands.disablePhishingPreventionForUrl({credentialUrl:a.urlOfCopiedItem,pasteDestinationUrl:a.urlOfPasteDestination});const i=await ft(e,n.type,r);i&&await Nn(e,t,n,i)}(e,t,r,i.itemId,i.vaultIngredient)},removeLinkedWebsite:async(e,t,a,r,n)=>{await e.grapheneClient.linkedWebsites.commands.removeLinkedWebsite({credentialId:r,linkedWebsite:n})}};var Ln=a(91652);var Un=a(97334);var Bn=a(50597),Gn=a(99510),xn=a(88558),Vn=a(9519);const On=e=>{const t=e[0]>127?1:0,a=new Uint8Array(e.byteLength+2+t);return a[0]=2,a[1]=e.byteLength+t,a[2]=0,a.set(e,2+t),a},Wn=[{coseAlgorithmIdentifier:Vn.aG.ES256,async generateNewKeyPair(e){const t=e.crypto.subtle,a=await t.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]);return{publicKey:await t.exportKey("jwk",a.publicKey),privateKey:await t.exportKey("jwk",a.privateKey)}},encodePublicKey(e){if(void 0===e.x||void 0===e.y)throw new xr(Ut.UnknownError);return Bn.cv(new Map([[1,2],[3,-7],[-1,1],[-2,(0,Er.N)(e.x)],[-3,(0,Er.N)(e.y)]]))},async sign(e,t){const a=t,r=await crypto.subtle.importKey("jwk",a,{name:"ECDSA",namedCurve:"P-256"},!0,["sign"]);return(e=>{const t=e.byteLength/2,a=On(e.slice(0,t)),r=On(e.slice(t)),n=new Uint8Array(a.byteLength+r.byteLength+2);return n[0]=48,n[1]=a.byteLength+r.byteLength,n.set(a,2),n.set(r,2+a.byteLength),n})(new Uint8Array(await crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},r,e)))}}],Yn=async(e,t)=>{const a=(e=>{const t=e.map((e=>Number(e.alg)));if(0===t.length){const e=[-7,-257];t.push(...e)}return t})(t),r=await async function(e){return await z(e,_.S.CloudPasskeyDev)}(e.connectors)&&a.includes(Vn.aG.ES256);if(r)return[void 0,r];for(const e of a){const t=Wn.find((t=>t.coseAlgorithmIdentifier===e));if(t)return[t,r]}return[void 0,r]},_n=new Uint8Array(16).fill(0),Kn=new Uint8Array([83,17,38,214,231,23,65,92,147,32,61,154,166,152,18,57]),Hn=[];function qn(e){for(const t of Hn)if(e===t||e.endsWith(`.${t}`))return _n;return Kn}let jn;const zn=async(e,t,a,r,n)=>{try{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new xr(Ut.InvalidStateError);await(async(e,t,a,r,n)=>{const i=r.options.rp.id;if(r.options.excludeCredentials.length>0&&i){const a=(await Br(e,i)).items,o=Wr(r.options.excludeCredentials);if(a.some((e=>o.includes(e.credentialId))))throw t.closeWebcard(N.SenderFrame,n),new xr(Ut.InvalidStateError)}})(e,t,0,r,n);if("stop"===await Qr(e,t,r,n))return;const i=await zr(e,n);if(void 0===i)throw new xr(Ut.InvalidStateError);const o={type:"webauthn.create",challenge:r.options.challenge,origin:i,crossOrigin:!1},s=JSON.stringify(o),[c,l]=await Yn(e,r.options.pubKeyCredParams);if(l)await(async(e,t,a,r,n)=>{const i=a.options.rp.id;if(void 0===i)throw new xr(Ut.SecurityError);const{registerPasskey:o}=e.connectors.grapheneClient.cloudPasskey.queries,s=await(0,q.z)(o({request:{clientDataHash:"",options:{user:a.options.user,pubKeyCredParams:a.options.pubKeyCredParams,attestation:a.options.attestation,extensions:a.options.extensions,rp:{id:i,name:a.options.rp.name}},origin:_r(r)?.effectiveDomain??"",userVerificationDone:a.userVerificationDone}}));if((0,K.hx)(s))switch(s.error.tag){case Gn.qH.INVALID_STATE_ERROR:throw new xr(Ut.InvalidStateError);case Gn.qH.NOT_ALLOWED_ERROR:throw new xr(Ut.NotAllowedError);case Gn.qH.NOT_SUPPORTED_ERROR:throw new xr(Ut.NotSupportedError);case Gn.qH.SECURITY_ERROR:throw new xr(Ut.SecurityError);case Gn.qH.UNKNOWN_ERROR:default:throw new xr(Ut.UnknownError)}const{credentialRegisterData:c}=s.data;t.webauthnCreateResponse(N.AllFrames,a.requestId,{status:"success",value:{...c,rawId:c.id,clientDataJSON:(0,xn.K)((new TextEncoder).encode(n)),authenticatorAttachment:c.authenticatorAttachment,transports:c.transports}})})(e,t,r,i,s);else{if(void 0===c)throw new xr(Ut.NotSupportedError);{const a=await async function(e,t,a){const{publicKey:r,privateKey:n}=await e.generateNewKeyPair(a.browserApi),i=t.options.rp.id;if(void 0===i)throw new xr(Ut.SecurityError);let o,s,c=await a.connectors.carbon.getSpaces();c=c.length>1?c:[];do{o=$r(16),s=(0,xn.K)(o)}while("uuid"===Jr(s));const l=c.find((e=>""!==e.spaceId)),u=l?.settings.enableForcedCategorization,d=u?l.spaceId:"",p={credentialId:s,rpId:i,rpName:t.options.rp.name,userHandle:t.options.user.id,userDisplayName:t.options.user.displayName,counter:0,spaceId:d,keyAlgorithm:e.coseAlgorithmIdentifier,privateKey:{crv:"",d:"",ext:!0,key_ops:[],kty:"",x:"",y:"",...n}};if(!(await a.connectors.carbon.addPasskey(p)).success)throw new xr(Ut.UnknownError);return{credentialIdBuffer:o,credentialIdBase64Url:s,counter:0,publicKey:r,rpId:i}}(c,r,e),n={};r.options.extensions?.credProps&&(n.credProps={rk:!0});const i=new ArrayBuffer(2);new DataView(i).setUint16(0,a.credentialIdBuffer.byteLength,!1);const o=c.encodePublicKey(a.publicKey),l=await new Blob([qn(a.rpId),i,a.credentialIdBuffer,o]).arrayBuffer(),u=await Or(e.browserApi,a.rpId),d=new Uint8Array([Vr.USER_PRESENT|Vr.ATTESTED_CRED_DATA_INCLUDED|Vr.BACKUP_ELIGIBILITY|Vr.BACKUP_STATE|(r.userVerificationDone?Vr.USER_VERIFIED:0)]),p=new ArrayBuffer(4);new DataView(p).setUint32(0,a.counter,!1);const m=await new Blob([u,d,p,l]).arrayBuffer(),w=Bn.cv({fmt:"none",attStmt:{},authData:m}),g={type:"public-key",rawId:a.credentialIdBase64Url,id:a.credentialIdBase64Url,clientDataJSON:(0,xn.K)((new TextEncoder).encode(s)),attestationObject:(0,xn.K)(w),authenticatorAttachment:"platform",authenticatorData:(0,xn.K)(m),publicKey:(0,xn.K)(o),publicKeyAlgorithm:c.coseAlgorithmIdentifier,transports:["internal","hybrid"],clientExtensionResults:n};t.webauthnCreateResponse(N.AllFrames,r.requestId,{status:"success",value:g})}}const u=Date.now()-jn;Dr(e,r,a,V.CeremonyStatus.Success,void 0,u)}catch(n){const i=n instanceof xr?n.errorName:Ut.UnknownError;if(Dr(e,r,a,V.CeremonyStatus.Failure,i),t.webauthnCreateResponse(N.AllFrames,r.requestId,{status:"error",errorName:i}),!(n instanceof xr))throw n}};let Zn;const Jn=async(e,t,a,r,n,i)=>{try{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new xr(Ut.InvalidStateError);if("stop"===await Qr(e,t,{...r,passkeyItemId:n},i))return;const o=await zr(e,i);if(void 0===o)throw new xr(Ut.InvalidStateError);const s={type:"webauthn.get",challenge:r.options.challenge,origin:o,crossOrigin:""!==r.parentFrameOrigin&&void 0!==r.parentFrameOrigin&&r.parentFrameOrigin!==o},c=JSON.stringify(s),l=await Or(e.browserApi,c),u=await e.connectors.carbon.getPasskey(n),d=Wn.find((e=>e.coseAlgorithmIdentifier===u.keyAlgorithm));if(u.keyAlgorithm===Vn.aG.CloudPasskey){const a=r.options.rpId;if(void 0===a)throw new xr(Ut.SecurityError);const{usePasskey:i}=e.connectors.grapheneClient.cloudPasskey.queries,s=await(0,q.z)(i({id:n,request:{clientDataHash:(0,xn.K)(l),options:{rpId:a,extensions:r.options.extensions},origin:_r(o)?.effectiveDomain??"",userVerificationDone:r.userVerificationDone}}));if((0,K.hx)(s))switch(s.error.tag){case Gn.qH.INVALID_STATE_ERROR:throw new xr(Ut.InvalidStateError);case Gn.qH.NOT_ALLOWED_ERROR:throw new xr(Ut.NotAllowedError);case Gn.qH.NOT_SUPPORTED_ERROR:throw new xr(Ut.NotSupportedError);case Gn.qH.SECURITY_ERROR:throw new xr(Ut.SecurityError);case Gn.qH.UNKNOWN_ERROR:default:throw new xr(Ut.UnknownError)}const{credentialGetData:u}=s.data;t.webauthnGetResponse(N.AllFrames,r.requestId,{status:"success",value:{...u,rawId:u.id,response:{authenticatorData:u.response.authenticatorData,signature:u.response.signature,userHandle:u.response.userHandle,clientDataJSON:(0,xn.K)((new TextEncoder).encode(c))}}})}else{if(void 0===d)throw new xr(Ut.NotSupportedError);{const a=Number.isInteger(u.counter)&&0!==u.counter?u.counter+1:0;await e.connectors.carbon.updatePasskey({id:n,counter:a});const i=await Or(e.browserApi,u.rpId),o=new Uint8Array([Vr.USER_PRESENT|Vr.BACKUP_ELIGIBILITY|Vr.BACKUP_STATE|(r.userVerificationDone?Vr.USER_VERIFIED:0)]),s=new ArrayBuffer(4);new DataView(s).setUint32(0,a,!1);const p=await new Blob([i,o,s]).arrayBuffer(),m=await d.sign(await new Blob([p,l]).arrayBuffer(),u.privateKey),w=(new TextEncoder).encode(u.credentialId),g="uuid"===Jr(u.credentialId)?(0,xn.K)(w):u.credentialId,y={type:"public-key",rawId:g,id:g,response:{authenticatorData:(0,xn.K)(p),clientDataJSON:(0,xn.K)((new TextEncoder).encode(c)),signature:(0,xn.K)(m),userHandle:u.userHandle},authenticatorAttachment:"platform"};t.webauthnGetResponse(N.AllFrames,r.requestId,{status:"success",value:y})}}const p=Date.now()-Zn;Lr(e,r,a,V.CeremonyStatus.Success,void 0,p,u.userDisplayName)}catch(n){const i=n instanceof xr?n.errorName:Ut.UnknownError;if(Lr(e,r,a,V.CeremonyStatus.Failure,i),t.webauthnGetResponse(N.AllFrames,r.requestId,{status:"error",errorName:i}),!(n instanceof xr))throw n}};const $n={startWebAuthnUserVerificationFlow:async function(e,t){try{const a=(0,Un.z)(),r=await e.connectors.carbon.initUserVerificationWithWebAuthn({relyingPartyId:a});if(!r.success)return void t.updateWebAuthnStatus(N.SenderFrame,Lt.Error);const n=await e.connectors.carbon.getUserLoginStatus();t.updateWebAuthnChallenge(N.SenderFrame,{login:n.login,publicKeyOptions:r.response.publicKeyOptions})}catch(e){throw t.updateWebAuthnStatus(N.SenderFrame,Lt.Error),e}},validateWebAuthnUserVerificationFlow:async function(e,t,a,r){try{const a=await e.connectors.grapheneClient.userVerification.commands.validateWebauthnAssertion({assertion:r});t.updateWebAuthnStatus(N.SenderFrame,(0,K.d6)(a)?Lt.Success:Lt.Error)}catch(e){throw t.updateWebAuthnStatus(N.SenderFrame,Lt.Error),e}},startWebAuthnLoginFlow:async(e,t)=>{if((await e.connectors.carbon.getUserLoginStatus()).loggedIn)return void t.updateWebAuthnStatus(N.SenderFrame,Lt.Success);const a=(await e.connectors.carbon.getLocalAccounts()).find((e=>e.isLastSuccessfulLogin));if(!a||"webauthn"!==a.rememberMeType)return void t.updateWebAuthnStatus(N.SenderFrame,Lt.Error);const r=a.login,n=await e.connectors.carbon.initOpenSessionWithWebAuthnAuthenticator({login:r,relyingPartyId:self.location.host}).catch((()=>({success:!1,error:{code:Ln.bL.UNKNOWN_ERROR}})));n.success?t.updateWebAuthnChallenge(N.SenderFrame,{login:r,publicKeyOptions:n.response.publicKeyOptions}):t.updateWebAuthnStatus(N.SenderFrame,Lt.Error)},completeWebAuthnLoginFlow:async(e,t,a,r,n)=>{const i=await e.connectors.carbon.openSessionWithWebAuthnAuthenticator({login:r,credential:n}).catch((()=>({success:!1})));t.updateWebAuthnStatus(N.SenderFrame,i.success?Lt.Success:Lt.Error)},disableReactivationWebcards:async e=>{await e.connectors.carbon.setReactivationStatus({reactivationStatus:Pr._g.DISABLED})},validateMasterPassword:async(e,t,a,r)=>{const n=await e.connectors.carbon.validateMasterPassword(r);t.setMasterPasswordValidationResult(N.SenderFrame,n)},validatePinCode:async(e,t,a,r)=>{try{const a=await(0,q.z)(e.connectors.grapheneClient.pinCode.queries.isPinCodeCorrect({pinCode:r})),{isPinCodeCorrect:n}=(0,K.ho)(a),i=await async function(e){const t=await(0,te.O)(e.connectors.grapheneClient.pinCode.queries.getCurrentUserStatus()),a=(0,K.ho)(t);return a.isPinCodeEnabled?a.attemptsLeft:0}(e);t.setPinCodeValidationResult(N.SenderFrame,{success:!0,isPinCodeCorrect:n,remainingAttempts:i})}catch(e){t.setPinCodeValidationResult(N.SenderFrame,{success:!1})}},resetProtectedItemsTimerAndApplyRecipe:async(e,t,a,r)=>{const n=await e.connectors.carbon.getIsSSOUser(),i=await e.connectors.carbon.getAccountAuthenticationType();if(!(n||"masterPassword"!==i))throw new Error("In resetProtectedItemsTimerAndApplyRecipe, attempt to reset protection timer for non-passwordless user");if(!ge(r))throw new Error(`In resetProtectedItemsTimerAndApplyRecipe, called without a VaultDataSource '${r}'`);await e.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer(),await Da(e,t,a,r)},disableAccessProtectionForVaultItem:na,requestPaymentUpdateAuthenticationToken:async(e,t)=>{const a=await e.connectors.carbon.requestPaymentUpdateAuthenticationToken();t.updatePaymentUpdateAuthenticationToken(N.SenderFrame,a)},webauthnCreate:async(e,t,a,r)=>{try{jn=Date.now();if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)throw new Gr;if(await(async e=>{if(!await Z(e.connectors))throw new Gr})(e),r.userVerificationDone)throw new xr(Ut.InvalidStateError);const{effectiveDomain:n,requestOrigin:i}=Hr(a,r),o=(0,Er.N)(r.options.user.id);if(o.byteLength<1||o.byteLength>64)throw new Gr({logError:Ut.InvalidStateError});((e,t,a)=>{e.options.rp.id=e.options.rp.id??a;const r=e.options.rp.id;if(Kr(r,a))throw new Gr({logError:Ut.SecurityError})})(r,0,n);const[s,c]=await Yn(e,r.options.pubKeyCredParams);if(void 0===s&&!c)throw new Gr({logError:Ut.NotSupportedError});if(!await(async(e,t)=>{const{authenticatorSelection:a,hints:r}=t,n=await Xt(e);return("required"!==a?.userVerification||0!==n.length)&&!(!(r instanceof Array&&r.length>0)&&a?.authenticatorAttachment&&"platform"!==a.authenticatorAttachment||a?.residentKey&&"discouraged"===a.residentKey)})(e,r.options))throw new Gr({logError:Ut.NotSupportedError});const l={webcardType:Gt.WebauthnCreateConfirmation,webcardId:(0,O.Z)(),formType:"login",rpName:r.options.rp.name,userDisplayName:r.options.user.displayName,request:r};await jr(e,l.webcardId,i),t.showWebcard(N.MainFrame,l)}catch(n){const i=n instanceof xr||n instanceof Gr?n.errorName:Ut.UnknownError;if(i&&Dr(e,r,a,V.CeremonyStatus.Failure,i),t.webauthnCreateResponse(N.SenderFrame,r.requestId,{status:"useFallback",reason:"cannotRegister"}),!(n instanceof xr||n instanceof Gr))throw n}},webauthnCreateUserConfirmed:zn,webauthnGet:async(e,t,a,r)=>{try{Zn=Date.now();const{loggedIn:n}=await e.connectors.carbon.getUserLoginStatus();if(!n)throw new Gr;if(!await Z(e.connectors))throw new Gr;if(r.userVerificationDone)throw new xr(Ut.InvalidStateError);const{effectiveDomain:i}=Hr(a,r);((e,t,a)=>{e.options.rpId=e.options.rpId??a;const r=e.options.rpId;if(Kr(r,a))throw new Gr({logError:Ut.SecurityError})})(r,0,i);const o=await Xt(e);if("required"===r.options.userVerification&&0===o.length)throw new Gr({logError:Ut.NotSupportedError});if("conditional"===r.mediation)return void t.webauthnStoreConditionalUiRequest(N.SenderFrame,{...r,mediation:"conditional"});r.options.rpId=r.options.rpId??i;const s=r.options.rpId;await(async(e,t,a,r,n)=>{const{requestOrigin:i}=Hr(a,r),o=r.options.allowCredentials??[],s=await Yr(t,n,o);if(0===s.length)throw new Gr;if(1===s.length){const a=s[0],n={webcardType:Gt.WebauthnGetConfirmation,webcardId:(0,O.Z)(),formType:"login",rpName:a.rpName,request:r,allowUsingOtherAuthenticator:0===o.length,passkey:{passkeyItemId:a.id,userDisplayName:a.userDisplayName}};return await jr(t,n.webcardId,i),void e.showWebcard(N.MainFrame,n)}if(s.length>1){let a=await t.connectors.carbon.getSpaces();a=a.length>1?a:[];const n={webcardType:Gt.WebauthnPasskeySelection,webcardId:(0,O.Z)(),formType:"login",passkeys:(await Zr(t,a,s)).map((e=>e.webcardItem)),metadata:la({type:xt.WebauthnRequest,request:r})};await jr(t,n.webcardId,i),e.showWebcard(N.MainFrame,n)}})(t,e,a,r,s)}catch(n){const i=n instanceof xr||n instanceof Gr?n.errorName:Ut.UnknownError;if(i&&Lr(e,r,a,V.CeremonyStatus.Failure,i),t.webauthnGetResponse(N.SenderFrame,r.requestId,{status:"useFallback",reason:"cannotAuthenticate"}),!(n instanceof xr||n instanceof Gr))throw n}},webauthnGetUserConfirmed:Jn,webauthnUseOtherAuthenticator:(e,t,a,r)=>{let n;const i=r;switch(n=sa(i)?i.request:r,n.type){case Bt.Create:t.webauthnCreateResponse(N.AllFrames,n.requestId,{status:"useFallback",reason:"otherAuthenticator"});break;case Bt.Get:t.webauthnGetResponse(N.AllFrames,n.requestId,{status:"useFallback",reason:"otherAuthenticator"})}return Promise.resolve()},webauthnUserCanceled:qr,webauthnIsConditionalUiSupported:async(e,t,a)=>{let r=!1;try{const{loggedIn:t}=await e.connectors.carbon.getUserLoginStatus();r=t&&await Z(e.connectors)}catch(t){e.logException(t,{message:"Error when checking for passkey support",fileName:"webauthn-conditional-ui.ts",funcName:"webauthnIsConditionalUiSupportedHandler"})}t.webauthnConditionalUiSupported(N.SenderFrame,r)},userVerificationComplete:async(e,t,a,r,n,i,o)=>{if((s=r).type!==xt.PendingOperation||!("operation"in s))throw new Error("Invalid pending operation");var s;const c=r.operation;switch(c.type){case ua.ApplyAutofillDetails:await(async(e,t,a,r,n,i,o)=>{n===F.Success&&(await e.connectors.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer(),i.neverAgain&&await na(e,0,0,r.data.dataSource.vaultId),await Da(e,t,a,r.data),t.closeWebcard(N.SenderFrame,o))})(e,t,a,c,n,i,o);break;case ua.Webauthn:await(async(e,t,a,r,n,i)=>{if(n===F.Success){const n={...r.request,userVerificationDone:!0};switch(n.type){case Bt.Create:await zn(e,t,a,n,i);break;case Bt.Get:if(!n.passkeyItemId)throw await qr(e,t,a,r.request),new Error("Can not complete webauthn get operation without passkey item id");await Jn(e,t,a,n,n.passkeyItemId,i);break;default:throw new Error("Pending operation not supported")}}else await qr(e,t,a,r.request)})(e,t,a,c,n,o);break;case ua.CopyValue:await(async(e,t,a,r,n,i)=>{if(n===F.Success){if(!a.url||!a.tab?.url)return;await e.connectors.grapheneClient.autofillSecurity.commands.resetProtectedItemAutofillTimer();const{vaultIngredient:n,itemId:o,previouslyCopiedProperties:s}=r,c=await ft(e,n.type,o);if(!c)return;const l=await Pa(e,{ingredient:n,vaultItem:c}),u=sr(c,n.type);if(!u)return;const d={webcardType:Gt.FollowUpNotification,webcardId:i,formType:"",webcardData:u,copiedProperties:[...s,n.property]};l&&(t.copyValueToClipboard(N.AllFrames,l),t.updateWebcard(N.SenderFrame,d))}})(e,t,a,c,n,o);break;default:throw new Error("Pending operation not supported")}}},Qn=[Y.k.Address,Y.k.BankAccount,Y.k.Company,Y.k.Credential,Y.k.DriverLicense,Y.k.Email,Y.k.FiscalId,Y.k.IdCard,Y.k.Identity,Y.k.Passport,Y.k.PaymentCard,Y.k.PersonalWebsite,Y.k.Phone,Y.k.SocialSecurityId],Xn={userFocusOnElement:async(e,t,a,r)=>{if(e.command?.timestamp,!a.tab?.url||!a.url)return;const n=new de.Y(a.tab.url).getRootDomain(),i=await e.connectors.carbon.getUserLoginStatus(),o=await(async()=>{const e="silent_deploy";try{const t=await(0,ba.U)();return"object"==typeof t&&null!==t&&e in t&&!0===t[e]}catch{return!1}})();let s;if(i.loggedIn){s=await cn(e,a.tab.url,a.url,a,r);const t=(await Nt(e)).isB2CFrozen&&(Ot(c=s)&&"classic"===c.configuration)&&!s.metadata?.[xt.WebauthnRequest]&&s.items.every((e=>e.itemType!==Y.k.Passkey)),{limit:n}=await vt(e);t&&!n&&e.logException(new Error("User is frozen but there is no known password limit")),t&&n&&(s=await(async(e,t,a,r,n)=>{const i=Object.keys(r.autofillRecipes).filter(se.Wm),{webcardItems:o}=await on(e,a,t,r);let s;return o.length?s=o[0].itemType:i.length?s=i[0]:r.autofillRecipes[se.JV.NewPassword]&&(s=se.JV.NewPassword),{formType:r.formClassification,srcElement:r,autofillRecipes:r.autofillRecipes,webcardId:(0,O.Z)(),webcardType:Gt.AutofillDropdown,configuration:Vt.AccountFrozen,cardTitleSourceType:s,passwordLimit:n}})(e,a,a.tab.url,r,n))}else o||(s=await async function(e,t,a,r){if(await e.connectors.carbon.getReactivationStatus()===Pr._g.DISABLED)return;if(se.JV.WebauthnConditionalUI in a.autofillRecipes)return;const n={webcardId:r??(0,O.Z)(),webcardType:Gt.AutofillDropdown,configuration:Vt.Reactivation,formType:a.formClassification,srcElement:a,autofillRecipes:a.autofillRecipes,tabRootDomain:t,extensionShortcuts:await(0,Rt.Y)()},i=(await e.connectors.carbon.getLocalAccounts()).find((e=>e.isLastSuccessfulLogin));if("webauthn"===i?.rememberMeType&&!i.shouldAskMasterPassword)return{...n,configuration:Vt.WebAuthnReactivation};return n}(e,n,r));var c;if(s){const n=r.conditionalUiRequest;if(s.metadata?.[xt.WebauthnRequest]&&n){const{requestOrigin:t}=Hr(a,n);await jr(e,s.webcardId,t)}t.showWebcard(N.MainFrame,s)}},applyAutofillRecipe:Fa,applyAutofillRecipeForOtherDataSource:Ra,logAutofillPerformedEvent:async(e,t,a,r)=>{const{temporaryEmitPasswordAutofillPerformedEvent:n}=e.connectors.grapheneClient.autofillTracking.commands;let i;r.type===Y.k.Credential?(i=$(W.b.UserPerformedAutofillCredential,{credential_login:r.login,credential_domain:r.domain,autofilled_domain:new de.Y(a.url).getHostname()}),await n({credentialId:r.id})):i=$(W.b.UserPerformedAutofillPayment,{item_name:r.item_name,item_type:r.type===Y.k.BankAccount?"bank_account":"credit_card",autofilled_domain:new de.Y(a.url).getHostname()});const o=await e.connectors.carbon.getNodePremiumStatus();o.b2bStatus?.currentTeam&&await e.connectors.grapheneClient.activityLogs.commands.storeActivityLogs({activityLogs:[i]})},generateNewPassword:async(e,t,a,r)=>{const n=e.connectors.carbon,i=await n.generatePassword({settings:{digits:r.digits,letters:r.letters,avoidAmbiguous:r.avoidAmbiguous,symbols:r.symbols,length:r.length}}),[o,s]=i.success?[i.password,i.strength]:["",-1];t.updateNewPassword(N.SenderFrame,o,s)},queryVaultItems:async(e,t,a,r,n)=>{const i=a.tab?.url;if(!i)return;let o=[],s=0;if(n)o=(await on(e,i,a,{formClassification:n.formClassification,autofillRecipes:n.autofillRecipes,...n.srcElementDetails},r)).webcardItems,s=o.length;else{const t=await At({context:e,searchQuery:r,itemTypes:Qn,sorting:{property:"lastUse",direction:"descend"},limit:en});o=t.items.map((e=>or({vaultType:e.vaultType,vaultItem:e}))),s=t.count}t.updateWebcardItems(N.SenderFrame,o,s)},getVaultItemDetails:async(e,t,a,r,n)=>{let i={};switch(n){case Y.k.Address:i=await(async(e,t)=>{const a=await ft(e,Y.k.Address,t);return a?Oa(e,Y.k.Address,a,["addressFull","city","country","door","floor","state","stateCode","streetName","streetNumber","streetTitle","zipCode"]):{}})(e,r);break;case Y.k.BankAccount:i=await(async(e,t)=>{const a=await ft(e,Y.k.BankAccount,t);return a?Oa(e,Y.k.BankAccount,a,["owner","bank","BIC","IBAN"]):{}})(e,r);break;case Y.k.Company:i=await(async(e,t)=>{const a=await ft(e,Y.k.Company,t);return a?Oa(e,Y.k.Company,a,["name","jobTitle"]):{}})(e,r);break;case Y.k.Credential:i=await(async(e,t)=>{const a=await ft(e,Y.k.Credential,t);return a?Oa(e,Y.k.Credential,a,["email","login","secondaryLogin","password","otpSecret"]):{}})(e,r);break;case Y.k.DriverLicense:i=await(async(e,t)=>{const a=await ft(e,Y.k.DriverLicense,t);return a?Oa(e,Y.k.DriverLicense,a,["issueDateFull","expirationDateFull","state","idNumber"]):{}})(e,r);break;case Y.k.Email:i=await(async(e,t)=>{const a=await ft(e,Y.k.Email,t);return a?Oa(e,Y.k.Email,a,["email"]):{}})(e,r);break;case Y.k.FiscalId:i=await(async(e,t)=>{const a=await ft(e,Y.k.FiscalId,t);return a?Oa(e,Y.k.FiscalId,a,["idNumber"]):{}})(e,r);break;case Y.k.IdCard:i=await(async(e,t)=>{const a=await ft(e,Y.k.IdCard,t);return a?Oa(e,Y.k.IdCard,a,["name","country","expirationDateFull","expirationYear","expirationMonth","expirationDay","issueDateFull","issueYear","issueMonth","issueDay","idNumber"]):{}})(e,r);break;case Y.k.Identity:i=await(async(e,t)=>{const a=await ft(e,Y.k.Identity,t);return a?Oa(e,Y.k.Identity,a,["title","firstName","middleName","middleNameInitial","lastName","lastName2","pseudo","birthDate","birthPlace","age"]):{}})(e,r);break;case Y.k.Passport:i=await(async(e,t)=>{const a=await ft(e,Y.k.Passport,t);return a?Oa(e,Y.k.Passport,a,["idNumber","country","expirationDateFull","expirationDay","expirationMonth","expirationYear","issueDateFull","issueDay","issueMonth","issueYear"]):{}})(e,r);break;case Y.k.PaymentCard:i=await(async(e,t)=>{const a=await ft(e,Y.k.PaymentCard,t);return a?Oa(e,Y.k.PaymentCard,a,["ownerName","cardNumber","securityCode","expireDate"]):{}})(e,r);break;case Y.k.PersonalWebsite:i=await(async(e,t)=>{const a=await ft(e,Y.k.PersonalWebsite,t);return a?Oa(e,Y.k.PersonalWebsite,a,["website"]):{}})(e,r);break;case Y.k.Phone:i=await(async(e,t)=>{const a=await ft(e,Y.k.Phone,t);return a?Oa(e,Y.k.Phone,a,["number","numberInternational"]):{}})(e,r);break;case Y.k.SocialSecurityId:i=await(async(e,t)=>{const a=await ft(e,Y.k.SocialSecurityId,t);return a?Oa(e,Y.k.SocialSecurityId,a,["idNumber"]):{}})(e,r)}t.updateWebcardItemDetails(N.SenderFrame,r,n,i)},webcardItemSelected:(e,t,a,r,n,i)=>{const o=n[xt.WebauthnRequest];if(o){if(!sa(o))throw new Error("Invalid webauthn metadata in selected webcard item");const n=o.request;if(n.type!==Bt.Get)throw new Error("Wrong webauthn metadata type in selected webcard item");if(r.itemType!==Y.k.Passkey)throw new Error("Wrong item type associated with webauthn metadata");return Jn(e,t,a,n,r.itemId,i)}throw new Error("Unsupported webcard item")},getCredentialsAtRiskByIds:async(e,t,a,r)=>{if(await async function(e){return await z(e,_.S.InAppPasswordHealthBadges)}(e.connectors)){const a=await(0,q.z)(e.connectors.grapheneClient.passwordHealth.queries.filterCredentialsIds({spaceId:null,credentialIds:r}));if((0,K.d6)(a)){const e=a.data.reduce(((e,t)=>(t.corruptionData?.riskType&&(e[t.id]=t.corruptionData.riskType),e)),{});t.updateWebcardCredentialsAtRisk(N.SenderFrame,e)}}}},ei=e=>e.length<=18?e:`${e.slice(0,18)}...`,ti=(e,t,a)=>{const{forceCategorizationEnabled:r,forcedSpace:n}=((e,t,a)=>{const r=e.find((e=>e.settings.enableForcedCategorization&&e.settings.spaceForcedDomains.some((e=>{const r=t=>""!==e&&t&&t.includes(e);return r(a)||r(t)}))));return{forceCategorizationEnabled:void 0!==r,forcedSpace:r?.spaceId}})(e,t,a);return{spaces:e.map((({letter:e,color:t,spaceId:a,displayName:r})=>({letter:e,color:t,spaceId:a,displayName:ei(r)}))),showSpacesList:e.length>1&&!r,defaultSpace:n??""}},ai={[Y.k.Address]:e=>{if(!e[0])return;const t=xa(e,"country")?.value??"",a=He(t),r=a!==We.f.NO_TYPE?qe(a):t,n=[xa(e,"addressFull")?.value,xa(e,"city")?.value,r].filter(Boolean).join(", ");return{type:Y.k.Address,content:n,addressFull:xa(e,"addressFull")?.value??"",city:xa(e,"city")?.value??"",zipCode:xa(e,"zipCode")?.value??"",country:r,localeFormat:a}},[Y.k.Email]:e=>{if(e[0])return{type:Y.k.Email,content:xa(e,"email")?.value??"",email:xa(e,"email")?.value??""}},[Y.k.Identity]:e=>{if(!e[0])return;const t=xa(e,"birthDate"),a=xa(e,"birthDay"),r=xa(e,"birthMonth"),n=xa(e,"birthYear");let i="";t?.format?.dateFormat?i=Xa(it(t.value,at(t.format.dateFormat))):a&&r&&n&&(i=Xa({day:a.value,month:r.value,year:n.value}));const o=[xa(e,"firstName")?.value,xa(e,"lastName")?.value].filter(Boolean).join(", ");return{type:Y.k.Identity,content:o,firstName:xa(e,"firstName")?.value??"",lastName:xa(e,"lastName")?.value??"",birthDate:i,birthPlace:xa(e,"birthPlace")?.value??""}},[Y.k.PaymentCard]:e=>{const t=xa(e,"cardNumber")?.value??"",a=xa(e,"securityCode")?.value??"",r=t.replace(/\s/g,""),n=!!a&&3===a.length,i=!!r&&(e=>(e=>13===e.length)(e)||(e=>14===e.length)(e)||(e=>15===e.length)(e)||(e=>16===e.length)(e))(r);if(!e[0]||!i||!n)return;const{month:o,year:s}=Wa(e);return{type:Y.k.PaymentCard,content:xa(e,"name")?.value??"",cardName:xa(e,"name")?.value??"",ownerName:Ua(e),expireMonth:o??"",expireYear:s??"",securityCode:a,cardNumber:r}},[Y.k.Phone]:e=>{if(!e[0])return;const t=He(xa(e,"country")?.value);return{type:Y.k.Phone,content:xa(e,"number")?.value??"",number:xa(e,"number")?.value??"",localeFormat:t}},[Y.k.PersonalWebsite]:e=>{if(e[0])return{type:Y.k.PersonalWebsite,content:xa(e,"website")?.value??"",website:xa(e,"website")?.value??""}}},ri=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,ni=/^[+]?([(]?[0-9]{1,4}[)]?[-\s.]?){1,5}$/,ii={[Y.k.Address]:!0,[Y.k.BankAccount]:!1,[Y.k.Company]:!1,[Y.k.Credential]:!1,[Y.k.DriverLicense]:!1,[Y.k.Email]:!0,[Y.k.FiscalId]:!1,[Y.k.GeneratedPassword]:!1,[Y.k.IdCard]:!1,[Y.k.Identity]:!0,[Y.k.Note]:!1,[Y.k.Passkey]:!1,[Y.k.Passport]:!1,[Y.k.PaymentCard]:!0,[Y.k.PersonalWebsite]:!0,[Y.k.Phone]:!0,[Y.k.SocialSecurityId]:!1,[Y.k.Secret]:!1},oi={[Y.k.Address]:3,[Y.k.BankAccount]:0,[Y.k.Company]:0,[Y.k.Credential]:0,[Y.k.DriverLicense]:0,[Y.k.Email]:1,[Y.k.FiscalId]:0,[Y.k.GeneratedPassword]:0,[Y.k.IdCard]:0,[Y.k.Identity]:2,[Y.k.Note]:0,[Y.k.Passkey]:0,[Y.k.Passport]:0,[Y.k.PaymentCard]:3,[Y.k.PersonalWebsite]:1,[Y.k.Phone]:1,[Y.k.SocialSecurityId]:0,[Y.k.Secret]:0},si=(e,t,a)=>{if(t.type!==a)return!1;const r=new de.Y(e).isUrlValid();switch(t.type){case Y.k.Email:return!("email"===t.property&&(n=e,!ri.test(n)));case Y.k.PersonalWebsite:return!("website"===t.property&&!r);case Y.k.Phone:return!(("number"===t.property||"numberInternational"===t.property)&&!(e=>ni.test(e))(e));default:return!0}var n},ci=(e,t)=>{const a=[];return e.forEach((e=>{e.ingredients.forEach((r=>{pe(r)&&((e,t)=>e.type===t||t===Y.k.Phone&&e.type===Y.k.Address&&"country"===e.property)(r,t)&&si(e.value,r,t)&&a.push({value:e.value,property:r.property,format:r.format})}))})),(t!==Y.k.Phone||a.find((e=>"number"===e.property)))&&(t!==Y.k.Identity||a.find((({property:e})=>"firstName"===e||"lastName"===e)))&&(t!==Y.k.PaymentCard||a.find((({property:e})=>"cardNumber"===e)))?a:[]};var li=a(86342),ui=a(13252);const di=async(e,t,a)=>{const r=t.isShared?(async(e,t,a)=>{const r={collectionId:t.id,permission:ui.y3.Admin};await e.connectors.grapheneClient.sharingCollections.commands.addItemsToCollections({collectionPermissions:[r],itemIds:[a.credentialId]})})(e,t,a):(async(e,t,a)=>{await e.connectors.grapheneClient.vaultOrganization.commands.updateCollection({id:t.id,collection:{vaultItems:[{id:a.credentialId}]},operationType:li.C.APPEND_VAULT_ITEMS})})(e,t,a);await r},pi=(e,t)=>St({context:e,url:t,vaultType:Y.k.Email,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}}),mi=async(e,t,a,r)=>{const n=await e.state.tab.get(),i=await e.connectors.carbon.getUserLoginStatus(),o=new de.Y(a.url),s=o.getRootDomain(),c=o.getSubdomain(),l=o.getHostname();let u=await e.connectors.carbon.getSpaces();u=u.length>1?u:[];const d=await((e,t)=>St({context:e,url:t,vaultType:Y.k.Credential,queryOptions:{sortCriteria:[{field:"lastUse",direction:"descend"}],filterCriteria:[]}}))(e,a.url),p=await vt(e),m=await Nt(e),w=d.filter((({sharingStatus:e})=>!e?.isShared||e.canEdit)).map((e=>or({vaultType:Y.k.Credential,vaultItem:e,premiumStatusSpace:u.find((t=>t.spaceId===e.spaceId))}))),g=await(async(e,t,a)=>{if(a)return a;const r=await pi(e,t);return 1===r.length?r[0].email:""})(e,a.url,a.capturedEmailOrLogin),y=await(async(e,t)=>(await pi(e,t)).map((e=>e.email)))(e,a.url),b=await e.connectors.carbon.getIsSSOUser(),h=await e.connectors.carbon.getAccountAuthenticationType(),f=!b&&"masterPassword"===h,{showSpacesList:S,spaces:A,defaultSpace:C}=ti(await e.connectors.carbon.getSpaces(),g,l),I=await J(e.connectors),T=I?await(async e=>{const t=await(0,q.z)(e.connectors.grapheneClient.vaultOrganization.queries.queryCollections({})),a=await(0,q.z)(e.connectors.grapheneClient.sharingCollections.queries.sharedCollectionsWithItems());return[...(0,K.d6)(t)?(0,K.db)(t).collections:[],...(0,K.d6)(a)?(0,K.db)(a):[]].map((e=>"isShared"in e?e:{...e,isShared:!1})).sort(((e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase())))})(e):[],{capturedEmail:k,capturedLogin:M,capturedSecondaryLogin:P}=a,E=n.dataCaptureStepData?.firstStepUrl??a.url;return fr(e),{webcardId:r??(0,O.Z)(),webcardType:Gt.SavePassword,formType:t,capturedUsernames:{email:k??"",login:M??"",secondaryLogin:P??""},emailOrLogin:g,existingCredentialsForDomain:w,dropdownLoginOptions:y,domain:s,subdomain:c,fullDomain:l,url:Sr(E),loggedIn:i.loggedIn,allowMasterPasswordProtection:f,showSubdomainOpt:Boolean(c),space:C,showSpacesList:S,spaces:A,passwordToSave:a.newPassword,passwordLimitStatus:p,showAccountFrozenStatus:m,collections:T,showCollectionList:I&&T.length>0}},wi=async(e,t,a,r,n,i)=>{if(!await re(e,Gt.FeedbackNotification))return;if(await(async(e,t,a,r,n)=>{if(n){const o=await(0,q.z)(e.grapheneClient.vaultItemsCrud.queries.query({vaultItemTypes:[Re.U.Credential],ids:[n]})),s=await(0,q.z)(e.grapheneClient.autofillSettings.queries.getPreferencesForCredentials({credentialIds:[n]}));if((0,K.d6)(o)&&(0,K.d6)(s)&&o.data.credentialsResult.matchCount>0){const c=o.data.credentialsResult.items[0],l=await(0,q.z)(e.grapheneClient.linkedWebsites.queries.getDashlaneDefinedLinkedWebsites({url:c.URL})),u=new de.Y(c.URL),d=new de.Y(a),p=d.getHostname();if(i=d,(u.getRootDomain()!==i.getRootDomain()||""===i.getSubdomain()||"www"!==d.getSubdomain()&&s.data[0]?.onlyAutofillExactDomain)&&((e,t)=>{const{capturedPassword:a,capturedEmailOrLogin:r,capturedLogin:n,capturedEmail:i}=e,{password:o,username:s,email:c}=t,l=i&&(s.trim()===i.trim()||c.trim()===i.trim())||n&&(s.trim()===n.trim()||c.trim()===n.trim())||!1;return a===o&&(void 0===r||l)})(r,c)&&!c.linkedURLs.includes(p)&&(0,K.d6)(l)&&!l.data.includes(p)){const a={webcardType:Gt.LinkedWebsiteUpdateConfirmation,webcardId:(0,O.Z)(),formType:"",operation:{credentialId:n,credentialName:c.itemName,linkedWebsite:p}},r=await e.grapheneClient.linkedWebsites.commands.addLinkedWebsite({credentialId:n,linkedWebsite:p});return(0,K.d6)(r)&&await ne(e,t,a),!0}}}var i;return!1})(e,t,a,r,i))return;const o=await(async(e,t,a)=>{const{capturedPassword:r,capturedEmailOrLogin:n,capturedLogin:i,capturedEmail:o}=a;return(await St({context:e,url:t,vaultType:Y.k.Credential,queryOptions:{sortCriteria:[],filterCriteria:[]}})).some((e=>e.password===r&&(void 0===n||o&&(e.login.trim()===o.trim()||e.email.trim()===o.trim())||i&&(e.login.trim()===i.trim()||e.email.trim()===i.trim()))))})(e,a,r);if(!o){const i=await mi(e,n.formClassification,{newPassword:r.capturedPassword,url:a,capturedEmailOrLogin:r.capturedEmailOrLogin,capturedEmail:r.capturedEmail,capturedLogin:r.capturedLogin,capturedSecondaryLogin:r.capturedSecondaryLogin});await ne(e,t,i)&&t.subscribeLiveValuesUpdate(N.AllFrames,n.formId,i.webcardId)}},gi=async(e,t,a,r,n)=>{const i=((e,t,a,r,n)=>{const i=new de.Y(t).getHostname();return{webcardId:(0,O.Z)(),webcardType:Gt.B2CFrozenDialog,savePasswordDisplayUrl:i,formType:a,passwordLimit:r}})(0,a,r.formClassification,n);await ne(e,t,i)},yi=async(e,t,a)=>{const r=e.connectors.carbon,n=await r.getUserLoginStatus(),i=Object.keys(t).reduce(((e,a)=>{const r=t[a];if(ii[a]&&r){const t=((e,t)=>ai[e]?.(t))(a,r);t&&e.push(t)}return e}),[]);return{webcardId:(0,O.Z)(),webcardType:Gt.DataCapture,loggedIn:n.loggedIn,data:i,formType:a.formClassification}},bi=async(e,t)=>{const a=e.map((e=>async function({context:e,vaultType:t}){try{const a=Ct[t];if(a){const t=De.N[a],r=await(0,q.z)(e.connectors.grapheneClient.vaultItemsCrud.queries.query({vaultItemTypes:[a]}));if((0,K.hx)(r))throw new Error(r.tag);return r.data[t].matchCount}throw new Error("bad vault item type")}catch(e){throw new Error("error in the `getNumberOfItemsFromVault` function of the `get.ts` file: "+e)}}({context:t,vaultType:e}))),r=await Promise.all(a);return e.filter(((e,t)=>0===r[t]))},hi=async(e,t,a,r)=>{if((await Nt(e)).isB2CFrozen)return;const n=await(async(e,t)=>{const a=Object.keys(t).filter((e=>{const a=t[e]??[];return ii[e]&&a.length>=oi[e]})),r=await bi(a,e),n={};return r.forEach((e=>{n[e]=t[e]})),n})(e,a);if(Object.keys(n).length>0){const a=await yi(e,n,r);await ne(e,t,a)}};var fi=a(17476),Si=a(90294);function Ai(e){return e in ue.cH?e:ue.cH.NO_TYPE}var Ci=function(e){return e.SaveCredential="save-credential",e.UpdateCredential="update-credential",e}({});const Ii=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/i,Ti=async(e,t)=>{const{emailOrLogin:a,capturedUsernames:r,password:n,url:i,onlyForThisSubdomain:o,protectWithMasterPassword:s,spaceId:c,selectedCollection:l}=t,u=(d=a,Ii.test(d));var d;const p={email:u?a:r.email,login:u?r.login:a,secondaryLogin:r.secondaryLogin,password:n,url:i,onlyForThisSubdomain:o,protectWithMasterPassword:s,spaceId:c},m=await e.connectors.carbon.addCredential(p);return await J(e.connectors)&&l&&await di(e,l,m),m},ki={savePersonalData:async(e,t,a,r)=>{(await e.connectors.carbon.getUserLoginStatus()).loggedIn&&r.forEach((t=>{const a=(e=>{switch(e.type){case Y.k.Email:return{kwType:ue.dJ.KWEmail,origin:fi.Up.MAV_DATACAPTURE,content:{email:e.email,emailName:e.email,type:"NO_TYPE"}};case Y.k.Phone:return{kwType:ue.dJ.KWPhone,origin:fi.Up.MAV_DATACAPTURE,content:{type:Si.z.PHONE_TYPE_ANY,phoneName:e.number,number:e.number,localeFormat:Ai(e.localeFormat)}};case Y.k.Address:return{kwType:ue.dJ.KWAddress,origin:fi.Up.MAV_DATACAPTURE,content:{addressName:"",addressFull:e.addressFull,city:e.city,zipCode:e.zipCode,country:e.country,localeFormat:Ai(e.localeFormat),receiver:"",state:"",streetNumber:"",building:"",stairs:"",floor:"",door:"",digitCode:""}};case Y.k.Identity:return{kwType:ue.dJ.KWIdentity,origin:fi.Up.MAV_DATACAPTURE,content:{title:"",firstName:e.firstName,middleName:"",lastName:e.lastName,pseudo:"",birthDate:e.birthDate,birthPlace:e.birthPlace}};case Y.k.PersonalWebsite:return{kwType:ue.dJ.KWPersonalWebsite,origin:fi.Up.MAV_DATACAPTURE,content:{website:e.website,name:e.website}};case Y.k.PaymentCard:return{kwType:ue.dJ.KWPaymentMean_creditCard,origin:fi.Up.MAV_DATACAPTURE,content:{cardName:e.cardName,cardNumber:e.cardNumber,expireMonth:e.expireMonth,expireYear:e.expireYear,ownerName:e.ownerName,securityCode:e.securityCode,personalNote:""}};default:return}})(t);a&&e.connectors.legacyCarbon.savePersonalDataItem(a)}))},findSavePasswordTargetCredential:async(e,t,a,r,n)=>{const i=await(async(e,t,a)=>{if(!t)return;return(await St({context:e,url:a,vaultType:Y.k.Credential})).find((e=>e.email===t||e.login===t))})(e,r,n),o=await e.connectors.carbon.getSpaces();if(i)t.updateSavePasswordTargetCredential(N.SenderFrame,{space:i.spaceId,showSpacesList:o.length>1&&!i.isForceCategorizedSpace},{id:i.id,subdomain:new de.Y(i.url).getSubdomainWithoutLeadingWww(),onlyForThisSubdomain:i.subdomainOnly,isProtected:i.autoProtected});else{const{showSpacesList:e,defaultSpace:a}=ti(o,r,new de.Y(n).getHostname());t.updateSavePasswordTargetCredential(N.SenderFrame,{space:a,showSpacesList:e})}},captureDataFromPage:async(e,t,a,r,n)=>{const i=await e.connectors.carbon.getUserLoginStatus();let o=!1;if(!i.loggedIn)try{const t=await(0,q.z)(e.connectors.grapheneClient.loggedOutMonitoring.queries.isLoggedOutMonitoringEnabledForDevice());o=(0,K.d6)(t)&&t.data.isEnabled}catch{o=!1}if(!i.loggedIn&&!o)return;if(Object.keys(r).length<1)return;const s=Object.keys(r)[0],c=r[s].elementValues;if(!a.tab?.url||r[s].preventDataCapture)return;const l=await hr(c,a.tab.url,e);if(i.loggedIn)if(l)await(async(e,t,a,r,n,i)=>{const{limit:o}=await vt(e),s=(await Nt(e)).isB2CFrozen;s&&!o&&e.logException(new Error("User is frozen but there is no known password limit")),s&&o?await gi(e,t,a,n,o):await wi(e,t,a,r,n,i)})(e,t,a.tab.url,l,r[s],n);else{const a=(e=>{const t=Object.values(e),a=ci(t,Y.k.Address),r=ci(t,Y.k.Email),n=ci(t,Y.k.Identity),i=ci(t,Y.k.Phone),o=ci(t,Y.k.PersonalWebsite),s=ci(t,Y.k.PaymentCard);return{[Y.k.Address]:a,[Y.k.Email]:r,[Y.k.Identity]:n,[Y.k.PaymentCard]:s,[Y.k.PersonalWebsite]:o,[Y.k.Phone]:i}})(c);await hi(e,t,a,r[s])}else if(o&&l){const t=await(0,q.z)(e.connectors.grapheneClient.loggedOutMonitoring.queries.analysePasswordForRisks({password:l.capturedPassword}));if((0,K.d6)(t)){const r=t.data.isCompromised?"compromised":t.data.isWeak?"weak":"safe";e.connectors.grapheneClient.loggedOutMonitoring.commands.sendRiskyPasswordLoggedOutLog({domain:new de.Y(a.tab.url).getHostname(),dateTime:(new Date).getTime(),uuid:(0,O.Z)().toUpperCase(),healthStatus:r})}}},notifyLiveValuesUpdate:async(e,t,a,r,n)=>{if(Object.keys(r).length<1)return;const i=r[Object.keys(r)[0]].elementValues,o=await(async(e,t)=>{const a=await e.state.tab.get(),{[t]:r}=a.persistentWebcards??{};return r})(e,n);if(o&&o.webcardType===Gt.SavePassword&&a.tab?.url){const r=await hr(i,a.tab.url,e);if(r){const a=r.capturedPassword,i=r.capturedEmailOrLogin??o.emailOrLogin,s=r.capturedLogin??o.capturedUsernames.login,c=r.capturedSecondaryLogin??o.capturedUsernames.secondaryLogin,l=r.capturedEmail??o.capturedUsernames.email,u={email:l,login:s,secondaryLogin:c};if(o.passwordToSave!==a||o.emailOrLogin!==i||o.capturedUsernames.login!==s||o.capturedUsernames.email!==l||o.capturedUsernames.secondaryLogin!==c){const r={...o,passwordToSave:a,emailOrLogin:i,capturedUsernames:{email:l,login:s,secondaryLogin:c}};await(async(e,t)=>{const a=await e.state.tab.get();a.persistentWebcards&&t.webcardId in a.persistentWebcards&&await e.state.tab.set({...a,persistentWebcards:{...a.persistentWebcards,[t.webcardId]:t}})})(e,r),t.updateSavePasswordCapturedData(N.AllFrames,n,a,i,u)}fr(e)}}},saveCredential:async(e,t,a,r,n)=>{if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;const i=await e.state.tab.get(),{url:o,emailOrLogin:s}=n,c=new de.Y(o).getHostname();await ie(e,r);const{credentialId:l}=await Ti(e,n),u={webcardType:Gt.FeedbackNotification,operation:{type:Ci.SaveCredential,credentialId:l,fullDomain:c,emailOrLogin:s},webcardId:r,formType:""};await(async e=>{const t=await e.connectors.carbon.getWebOnboardingMode();return!(t.flowSaveCredentialOnWeb&&!t.completedSteps?.saveCredentialOnWeb)})(e)?(await e.state.tab.set({...i,persistentWebcards:{...i.persistentWebcards,[u.webcardId]:u}}),t.updateWebcard(N.SenderFrame,u)):(t.closeWebcard(N.SenderFrame,r),await wa(e,t,!0))},updateCredential:async(e,t,a,r,n)=>{const i=await e.state.tab.get();if(!(await e.connectors.carbon.getUserLoginStatus()).loggedIn)return;const o=new de.Y(a.tab?.url??"").getHostname(),{id:s,title:c,newPassword:l,onlyForThisSubdomain:u,spaceId:d}=n;await ie(e,r),await((e,t)=>{const{id:a,passwordToSave:r,onlyForThisSubdomain:n,spaceId:i}=t,o={id:a,update:{password:r,spaceId:i,onlyForThisSubdomain:n}};return e.connectors.carbon.updateCredential(o)})(e,{id:s,passwordToSave:l,onlyForThisSubdomain:u,spaceId:d});const p={webcardType:Gt.FeedbackNotification,operation:{type:Ci.UpdateCredential,fullDomain:o,credentialId:s,emailOrLogin:c},webcardId:r,formType:""};await e.state.tab.set({...i,persistentWebcards:{...i.persistentWebcards,[p.webcardId]:p}}),t.updateWebcard(N.SenderFrame,p)},cancelSaveCredential:async(e,t)=>{await wa(e,t,!1)}},Mi={...Pn,...$n,...Xn,...ki,...Fn,...oe,...ee,...ae,...G},Pi=["https://*/*"];class Ei{constructor(e,t,a){(0,r._)(this,"_browserApi",void 0),(0,r._)(this,"_injectedConnectors",void 0),(0,r._)(this,"_logException",void 0),(0,r._)(this,"_pendingRequestIds",[]),(0,r._)(this,"requestCompleted",(e=>{const t=this._pendingRequestIds.indexOf(e.requestId);-1!==t&&this._pendingRequestIds.splice(t,1)})),(0,r._)(this,"authRequired",(async e=>{const t=await zi(this._injectedConnectors),a={state:{global:{get:()=>{throw new Error("Global state unavailable in basic auth")},set:()=>{throw new Error("Global state unavailable in basic auth")}},tab:{get:()=>{throw new Error("Persistent tab state unavailable in basic auth")},set:()=>{throw new Error("Persistent tab state unavailable in basic auth")}}},browserApi:this._browserApi,connectors:t,grapheneClient:t.grapheneClient,logException:this._logException};if(!(await a.connectors.carbon.getUserLoginStatus()).loggedIn)return{};if(this._pendingRequestIds.includes(e.requestId))return{};this._pendingRequestIds.push(e.requestId);const r=new Promise(((e,t)=>setTimeout((()=>{t(new Error("Credential fetch timed out after 3000ms"))}),3e3))),n=dr(a,e.url),i=(await Promise.race([r,n])).filter((e=>e.autoLogin));if(i.length>0){const t=i.find((t=>new de.Y(t.url).getHostname()===new de.Y(e.url).getHostname()))??i[0];return{authCredentials:{username:t.login||t.email,password:t.password}}}return{}})),this._browserApi=e,this._injectedConnectors=t,this._logException=a}}const vi="autofill-engine-state-global",Ni="autofill-engine-state-",Ri=["http://*/*","https://*/*"],Di=e=>e?.url&&void 0!==e.id,Fi=(e,t)=>e.tabs.query({...t,url:Ri}).then((e=>e.filter(Di))),Li=e=>Fi(e,{active:!0,lastFocusedWindow:!0}),Ui=e=>(t,a)=>{const{browserApi:r,messageLogger:n,tabId:i,openPorts:o,port:s,sender:c}=e,l=s?.sender??c,u={};switch(a){case N.SenderFrame:if(!l)throw new Error("No sender provided, target SenderFrame is invalid");u.frameId=l.frameId;break;case N.MainFrame:u.frameId=0;case N.AllFrames:}s&&a===N.SenderFrame?s.postMessage(t):(r.tabs.sendMessage(i,t,u),o.getPorts(i,u.frameId).forEach((e=>e.postMessage(t))))};let Bi;const Gi=(e,t,a,r,n)=>{Bi&&Bi.unsubscribe(),Bi=n.autofillSettings.queries.getAutofillSettings().subscribe((i=>{(0,K.d6)(i)&&(async(e,t,a,r,n)=>{const[i]=await Li(e);if(i?.url){const o=Ui({browserApi:e,messageLogger:r,tabId:i.id??0,openPorts:a}),s=D(o);await kr(t,n,s,N.AllFrames,i.url)}})(e,t,a,r,n)}))};var xi=a(61441),Vi=a(56739);const Oi=async(e,t,a)=>{try{const a=(e=>e.origin??new URL(e.url??"").origin)(t);if(a===new URL(e.browserApi.runtime.getURL("")).origin||(e=>(e.id??"")===(0,Un.z)())(t))return;let r;const n=t.tab?.url||t.tab?.pendingUrl;if(n&&a&&a===new URL(n).origin){const t=await e.state.tab.get();await e.state.tab.set({...t,origin:a}),r=a}else r=(await e.state.tab.get()).origin;if(a&&n&&r&&r===new URL(n).origin)return}catch{}if("documentComplete"!==a)throw new Error("Message sender is not trusted")};var Wi=a(52913);const Yi=`^${Ni}([0-9]*)$`;async function _i(){const e=await(0,u.U)(null),t=function(e){const t=[];e.includes(vi)&&t.push(vi);const a=new RegExp(Yi);return e.reduce(((e,t)=>a.test(t)?e.concat(t):e),t)}(Object.keys(e));t.length&&(0,Wi.O)(t)}const Ki=e=>`${Ni}${e}`,Hi="Unexpected undefined global state",qi="options.useInjectScriptOnStart",ji=async(e,t,a)=>{try{const t=await(async(e,t)=>{try{return(await Promise.all(t.map((t=>e.carbon.getHasFeature(t))))).every((e=>e))}catch(e){throw new Error("Failed to get feature flips in checkFeatureInCarbonFFs",{cause:e})}})(a,["autofill_web_injectScriptOnStart","autofill_web_injectScriptOnStart_dev"]),r=await((e,t)=>e.storage.local.get(t).then((e=>Boolean(e[t]))))(e,qi);t!==r&&((e,t,a)=>{const{key:r,value:n}=a;try{return e.storage.local.set({[r]:n}).then((()=>{}))}catch(e){throw new Error(`Failed to write the ${r} FF to local storage`,{cause:e})}})(e,0,{key:qi,value:t})}catch(e){throw new Error(`Error in checkInjectScriptOnStartFF: ${e}`)}};async function zi(e){const t=await e.grapheneClientPromise;return{...e,grapheneClient:t}}const Zi=(e,t,a)=>({global:{get:async()=>{const e=await t.getState(vi);return void 0===e?(a(new Error(Hi),{fileName:"start.ts",funcName:"buildStateForTab",omitPrefix:!0}),{}):e},set:e=>t.setState(vi,e)},tab:{get:async()=>{const r=await t.getState(Ki(e));return void 0===r?(a(new Error("Unexpected undefined tab state"),{fileName:"start.ts",funcName:"buildStateForTab",omitPrefix:!0}),{}):r},set:a=>t.setState(Ki(e),a)}}),Ji=(e,t)=>({global:{get:async()=>{const a=await e.getState(vi);return void 0===a?(t(new Error(Hi),{fileName:"start.ts",funcName:"buildStateForPopup",omitPrefix:!0}),{}):a},set:t=>e.setState(vi,t)},tab:{get:()=>{throw new Error("Can't access tab state in a command called from Popup")},set:()=>{throw new Error("Can't change tab state in a command called from Popup")}}}),$i=e=>{const{browserApi:t,injectedConnectors:a,openPorts:r,stateStorage:n,message:i,messageLogger:o,launchCapture:s,port:c,sender:l,sendResponse:u}=e,d=c?.sender??l;if(!(p=i,"object"==typeof p&&null!==p&&"messageType"in p&&"cmd"in p&&"parameters"in p&&p.messageType===v.Command&&"string"==typeof p.cmd&&Array.prototype.includes.call(L,p.cmd)&&d))return!1;var p;const m=(e,t)=>{zi(a).then((a=>P(e,"autofillEngineException",a,0,t?.omitPrefix?{...t}:{...t,message:`Exception processing command ${i.cmd}`})))};return(async()=>{let e,u;const p=await zi(a);if(d.tab?.id){const a=d.tab.id;0,e={state:Zi(a,n,m),browserApi:t,command:i,connectors:p,grapheneClient:p.grapheneClient,logException:m,launchCapture:s},u=D(Ui({browserApi:t,messageLogger:o,tabId:a,openPorts:r,sender:l,port:c}))}else e={state:Ji(n,m),browserApi:t,connectors:p,grapheneClient:p.grapheneClient,logException:m},u=D(((e,t,a)=>async(t,r)=>{const n={};switch(r){case N.SenderFrame:throw new Error("target SenderFrame is invalid");case N.MainFrame:n.frameId=0;case N.AllFrames:}(await Fi(e)).forEach((r=>{r.id&&(e.tabs.sendMessage(r.id,t,n,(()=>{if("Error: Could not establish connection. Receiving end does not exist."!==e.runtime.lastError?.message)throw new Error(e.runtime.lastError?.message)})),a.getPorts(r.id,n.frameId).forEach((e=>e.postMessage(t))))}))})(t,0,r));await Oi(e,d,i.cmd),await Mi[i.cmd](e,u,d,...i.parameters)})().catch((e=>{m(e,{fileName:"start.ts",funcName:"runtimeOnMessageListener",message:""})})).finally((()=>u())),!0},Qi=async(e,t,a,r,n,{loggedIn:i},o)=>{const s=await zi(t);i&&(Gi(e,s,a,r,s.grapheneClient),kn(e,0,n,s,o),ji(e,0,s));const[c]=await Li(e);if(c?.url){const t=D(Ui({browserApi:e,messageLogger:r,tabId:c.id??0,openPorts:a}));await Mr(s,s.grapheneClient,t,N.AllFrames,c.url,i)}},Xi=(e,t,a,r)=>{const n=(e,a)=>{zi(t).then((t=>P(e,"autofillEngineException",t,0,a??{})))};try{const i=new U,o=new T.y({}),s=((e,t)=>{let a=!1;return{get:async()=>{let r=await e.getState(vi);return void 0===r?(t(new Error(Hi),{fileName:"start.ts",funcName:"startAutofillEngine"}),{}):(a||(r={...r,...Ft},await e.setState(vi,r),a=!0),r)},set:t=>e.setState(vi,t)}})(a,n);t.carbon.liveLoginStatus.on((async a=>{try{await Qi(e,t,i,r,n,a,s)}catch(e){n(e,{message:"Exception in liveLoginStatus handler",fileName:"start.ts",funcName:"startAutofillEngine"})}})),t.carbon.getUserLoginStatus().then((async a=>{try{await Qi(e,t,i,r,n,a,s)}catch(e){n(e,{message:"Exception in getUserLoginStatus promise",fileName:"start.ts",funcName:"startAutofillEngine"})}})),e.contextMenus.onClicked.addListener(((t,a)=>{if(!a?.id)throw new Error("No tab ID while handling a right-click menu interaction");if("capture-page"===t.menuItemId){const e=()=>o.activate(a,{onSuccess:(e,t)=>{(async(e,t,a,r)=>{const n=await Promise.all(t.map((async e=>{let t;if(e.binary){const a=e.blob;try{const e=await fetch(a);t=await e.blob()}catch{return null}}else t=new Blob([e.blob],{type:"text/plain"});return{name:e.filename,input:t}})).filter(Boolean));try{const t=await(0,xi.RZ)(n).blob(),r=new URL(e).hostname+"-capture.zip",i=e=>new Promise(((t,a)=>{const r=new FileReader;r.onloadend=()=>{"string"==typeof r.result?t(r.result):a(new Error("Reader result not a string"))},r.onerror=a,r.readAsDataURL(e)})),o=await i(t);a("Vortex zip download started",{downloadId:await(0,Vi.L)({url:o,filename:r,saveAs:!0}),timestamp:Date.now()})}catch(e){r(e,{message:"Exception in saveAsZip function",fileName:"start.ts",funcName:"saveAsZip"})}})(e,t,r,n),r("Vortex capture success",{timestamp:Date.now()})},onError:e=>{n(e,{message:"Exception in pageCaptureBackground.activate",fileName:"start.ts",funcName:"startAutofillEngine"})}});(0,k.r)({permissions:["downloads"]},(t=>{t?e():(0,M.W)({permissions:["downloads"]},(t=>{t&&e()}))}))}"correct-autofill"===t.menuItemId&&D(Ui({browserApi:e,messageLogger:r,tabId:a.id,openPorts:i})).computeContextMenuTargetInfo(N.AllFrames,t.frameId??0)})),e.tabs.onRemoved.addListener((e=>{a.setState(Ki(e),{}).catch((e=>{n(e,{message:"Exception in onRemoved handler",fileName:"start.ts",funcName:"startAutofillEngine"})}))})),e.tabs.onHighlighted.addListener((async a=>{try{await(async(e,t,a,r,n)=>{const i=await zi(t),{loggedIn:o}=await i.carbon.getUserLoginStatus(),s=(await Fi(e)).filter((e=>e.url&&e.id&&n.tabIds.includes(e.id)));await Promise.all(s.map((async t=>{const n=Ui({browserApi:e,messageLogger:r,tabId:t.id??0,openPorts:a}),s=D(n);await Mr(i,i.grapheneClient,s,N.AllFrames,t.url??"",o),s.updateTabActiveInfo(N.AllFrames,!0)})))})(e,t,i,r,a)}catch(e){n(e,{message:"Exception in onHighlighted handler",fileName:"start.ts",funcName:"startAutofillEngine"})}})),e.runtime.onConnect.addListener((s=>{i.storePort(s),s.onDisconnect.addListener((e=>i.removePort(e))),s.onMessage.addListener((c=>{try{return $i({browserApi:e,injectedConnectors:t,openPorts:i,stateStorage:a,messageLogger:r,message:c,port:s,launchCapture:(...e)=>{o.activate(...e)},sendResponse:()=>{}})}catch(e){return n(e,{message:"Exception in onConnect.onMessage handler",fileName:"start.ts",funcName:"startAutofillEngine"}),!1}}))})),e.runtime.onMessage.addListener(((s,c,l)=>{try{return $i({browserApi:e,injectedConnectors:t,openPorts:i,stateStorage:a,messageLogger:r,message:s,launchCapture:(...e)=>{o.activate(...e)},sender:c,sendResponse:l})}catch(e){return n(e,{message:"Exception in runtime.onMessage handler",fileName:"start.ts",funcName:"startAutofillEngine"}),!1}})),((e,t,a)=>{if(Tn.isSafari())return;const r=(e,a)=>{zi(t).then((t=>P(e,"autofillEngineException",t,0,{...a,message:"Exception during basic auth process"})))},n=new Ei(e,t,r),i=e=>{try{n.requestCompleted(e)}catch(e){r(e,{fileName:"basicAuth.ts",funcName:"registerBasicAuthListeners"})}};e.webRequest.onCompleted.addListener(i,{urls:Pi},[]),e.webRequest.onErrorOccurred.addListener(i,{urls:Pi}),e.webRequest.onAuthRequired.addListener((e=>n.authRequired(e).catch((e=>(r(e,{fileName:"basicAuth.ts",funcName:"registerBasicAuthListeners"}),{})))),{urls:Pi},[b.C.Blocking])})(e,t),_i()}catch(e){n(e,{message:"Exception while starting autofill-engine",fileName:"start.ts",funcName:"startAutofillEngine"})}};let eo=0;const to=(e,t,a)=>{eo++;const r=eo,n={type:"query",id:r,content:t},i=t=>{var n;"object"==typeof(n=t)&&null!==n&&"type"in n&&"response"===n.type&&"id"in n&&"number"==typeof n.id&&"content"in n&&t.id===r&&(a(t.content),e.onMessage.removeListener(i))};e.onMessage.addListener(i),e.postMessage(n)},ao=(e,t,a)=>{return"object"==typeof(r=e)&&null!==r&&"type"in r&&"query"===r.type&&"id"in r&&"number"==typeof r.id&&"content"in r&&a(e.content,(a=>{const r={type:"response",id:e.id,content:a};t.postMessage(r)}));var r};var ro=function(e){return e.GetWebcardInitialData="GetWebcardInitialData",e.UpdateWebcardGeometry="UpdateWebcardGeometry",e.WebcardOpened="WebcardOpened",e.WebcardClosed="WebcardClosed",e.IframeEvent="IframeEvent",e.KeyboardNavigationEvent="KeyboardNavigationEvent",e.SubscribeKeyboardNavigationEvents="SubscribeKeyboardNavigationEvents",e.RemoveSubscriptionsForClosedWebcard="RemoveSubscriptionsForClosedWebcard",e.VisibilityCheckRequest="VisibilityCheckRequest",e.GetAllowAttributeForIframe="GetAllowAttributeForIframe",e}({});const no="autofill-engine-dispatcher",io=e=>{const t=function(e,t){const a=new U;let r;return e.runtime.onConnect.addListener((e=>{e.name.startsWith(t)&&(a.storePort(e),e.onDisconnect.addListener((e=>a.removePort(e))),e.onMessage.addListener((t=>{r&&ao(t,e,((t,a)=>!(!r||!e.sender)&&r(t,e.sender,a)))})))})),{setListener:e=>{r=e},sendMessage:(e,t,r,n)=>{a.getPorts(t,r).forEach((t=>to(t,e,n)))}}}(e,no),a=function(e){let t;return e.runtime.onMessage.addListener(((e,a,r)=>t?.(e,a,r)??!1)),{setListener:e=>{t=e},sendMessage:(t,a,r,n)=>{e.tabs.sendMessage(a,t,{frameId:r},n)}}}(e),r=(e,r,n)=>{const i=r.tab?.id;if(!(i&&"number"==typeof r.frameId&&(o=e,"object"==typeof o&&null!==o&&"identifier"in o&&"options"in o&&"object"==typeof o.options&&null!==o.options&&"message"in o.options&&"string"==typeof o.options.message&&o.options.message in ro&&o.identifier===no)))return!1;var o;const{options:s}=e,c={options:{sourceFrameId:r.frameId,message:s.message},identifier:no,parameters:e.parameters};return t.sendMessage(c,i,s.targetFrameId,n),a.sendMessage(c,i,s.targetFrameId,n),!0};t.setListener(r),a.setListener(r)}}}]);