"use strict";(self.webpackChunk_passwork_extension=self.webpackChunk_passwork_extension||[]).push([[116],{43953:function(e,t,n){n.d(t,{W:function(){return o}});var i=n(71090);const o=({isInFocus:e,error:t,isPopup:n})=>(0,i.k)({invisibleInput:{opacity:0,position:"fixed",top:-20,height:10,width:10},pinInputs:{display:"grid",gridTemplateColumns:"auto auto auto auto",justifyContent:n?"center":"flex-start",gridGap:12,width:n?"100%":"fit-content",margin:n?"auto":"0 auto",marginBottom:n?"25px":0},pinCell:{boxSizing:"border-box",height:70,width:45,padding:0,position:"relative",display:"grid",placeItems:"center",borderRadius:"8px",background:e=>e.palette.popup.background,border:n=>`1px solid ${t?n.palette.error.main:e?n.palette.primary.main:n.palette.elementWithHover.backgroundHover}`},dot:{height:8,width:8,borderRadius:"50%",background:e=>e.palette.inputElements.main},caretBlink:{animation:"caretAnimation 1s infinite","@keyframes caretAnimation":{"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}},caret:{background:e=>e.palette.inputElements.main,width:"1px",height:24,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",opacity:0},setAgain:{display:"flex",justifyContent:"center",marginTop:"35px","& div":{display:"flex",alignItems:"center",cursor:"pointer"}}})},90565:function(e,t,n){var i=n(52322),o=n(47746),s=n(42921),a=n(24394),r=n(79312),l=n(2784),c=n(67876),p=n(43953),u=n(18747),d=n(31611),g=n(25539),h=n(71382),f=n(51730),m=n(95025),x=n(75234),y=n(18322),v=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((i=i.apply(e,t||[])).next())}))};const P=({value:e,isInFocus:t,showError:n,isPopup:o})=>{const{pinCell:a,dot:r,caret:l,caretBlink:c}=(0,p.W)({error:n,isInFocus:t,isPopup:o});return(0,i.jsx)(s.Z,Object.assign({sx:a},{children:e?(0,i.jsx)(s.Z,{sx:r}):(0,i.jsx)(s.Z,{sx:t?Object.assign(Object.assign({},l),c):null})}))};t.Z=({extensionUnlock:e,isPopup:t=!1,close:n,setShowError:Z,setCloseTimer:k,setTitleVariant:j,pinMode:S,navigateToSettings:b,navigateToHost:w,mandatoryPin:E,openHomePage:A})=>{const[C,I]=(0,l.useState)(!1),[O,F]=(0,l.useState)(!1),[T,H]=(0,l.useState)(""),[N,W]=(0,l.useState)(""),[G,D]=(0,l.useState)(""),[L,Y]=(0,l.useState)(!1),[z,M]=(0,l.useState)(!1),B=(0,l.useRef)(null),{pinInputs:R,invisibleInput:U,setAgain:$}=(0,p.W)({isPopup:t}),_=(0,u.z)(),V=(0,o.Z)(),{t:q}=(0,x.$G)(),K=()=>v(void 0,void 0,void 0,(function*(){if(S===g.eY.deletePin||S===g.eY.changePin)return void(N!==T?J(!0):(S===g.eY.deletePin&&(yield c.ZP.SetPin(""),b&&b(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:q("common:notification:pinRemoved")}}))),Y(!0),W(""),j&&j(g.b0.changeEnterNew)));let i=yield c.ZP.GetPinEntryAttempts();if(yield c.ZP.SetPinEntryAttempts(i+1),i=yield c.ZP.GetPinEntryAttempts(),N===T){if(yield c.ZP.SetExtensionLocked(!1),yield c.ZP.SetPinEntryAttempts(0),!t){const e=yield c.ZP.GetAutoLockSettings();e.lastActive=Date.now()/1e3,yield c.ZP.SetAutoLockSettings(e)}e()}else if(F(!0),i>=5){if(Z&&Z(!0),t)try{yield y.Z.passwork.logout()}catch(e){console.log(e)}else chrome.runtime.sendMessage({type:"endSession"},(()=>v(void 0,void 0,void 0,(function*(){}))));(0,h.G6)()?(yield c.ZP.SetPin(""),yield c.ZP.DeleteApiKey(),yield c.ZP.DeleteMasterPass(),yield c.ZP.DeleteApiToken(),yield c.ZP.DeleteCombinedToken(),yield c.ZP.DeleteUserInfo(),yield c.ZP.SetExtensionLocked(!1),yield c.ZP.DeleteLastOpenedPage(),yield c.ZP.DeleteVersionInfo(),yield c.ZP.SetHost(""),yield c.ZP.SetPinEntryAttempts(0),yield chrome.runtime.sendMessage({type:"removeContentScriptPresence"})):(yield c.ZP.SetHost(""),yield c.ZP.SetPinEntryAttempts(0),yield(0,h.s1)(!0)),setTimeout((()=>v(void 0,void 0,void 0,(function*(){!t&&n&&n(),t&&w&&w(),k&&k(!1)}))),7e3)}else J(!1)})),Q=(e=!0)=>()=>{M(e),B.current&&(e?B.current.focus():B.current.blur())};const J=e=>{e&&F(!0),setTimeout((()=>{I(!1),W(""),F(!1)}),1e3)};return(0,l.useEffect)((()=>{v(void 0,void 0,void 0,(function*(){let e="";if(t?(e=(yield c.ZP.GetPin())||"",H(e)):chrome.runtime.sendMessage({type:"getPin"},(e=>v(void 0,void 0,void 0,(function*(){e&&H(e)})))),t){const e=yield c.ZP.GetUserInfo();_((0,d.ps)({type:g.F9.setUserInfo,userInfo:e}))}}))}),[]),(0,l.useEffect)((()=>{F(!1);v(void 0,void 0,void 0,(function*(){switch(S){case g.eY.setPin:4===N.length&&0===G.length&&(j&&j(g.b0.setConfirmNew),D(N),W("")),4===N.length&&4===G.length&&(N===G?(yield c.ZP.SetPin(N),E?A&&A():b&&b(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:q("common:notification:pinSet")}}))):(I(!0),J(!0))),0===N.length&&Q(!0)();break;case g.eY.changePin:4!==N.length||L||K(),4===N.length&&0===G.length&&L&&(j&&j(g.b0.changeConfirmNew),D(N),W("")),4===N.length&&4===G.length&&L&&(N===G?(yield c.ZP.SetPin(N),b&&b(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:q("common:notification:pinChanged")}}))):J(!0)),0===N.length&&Q(!0)();break;default:0===N.length&&Q(!0)(),4===N.length&&(I(!0),K())}}))}),[N]),(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(s.Z,Object.assign({sx:R,onClick:Q(!0),onBlur:Q(!1)},{children:[(0,i.jsx)(a.Z,{sx:U,inputRef:B,onFocus:()=>M(!0),onBlur:()=>M(!1),autoFocus:!0,value:N,disabled:C,onChange:e=>{var t,n,i,o,s;const a=B.current;a.selectionStart=a.selectionEnd=5;const r=(null===(n=null===(t=e.target)||void 0===t?void 0:t.value)||void 0===n?void 0:n.replaceAll)?null===(o=null===(i=e.target)||void 0===i?void 0:i.value)||void 0===o?void 0:o.replaceAll("\n",""):null===(s=e.target)||void 0===s?void 0:s.value;(/^\d{0,4}$/.test(r)||""==r)&&W(r)}}),function(){const e=N.split("");return Array.from({length:4},((e,t)=>t)).map((t=>e[t]))}().map(((e,n)=>(0,i.jsx)(P,{isPopup:t,value:e,showError:O,isInFocus:z&&n===N.length},n)))]})),G&&(0,i.jsx)(s.Z,Object.assign({sx:$},{children:(0,i.jsxs)(s.Z,Object.assign({onClick:()=>{D(""),W(""),Q(!0)(),j&&(S===g.eY.changePin?j(g.b0.changeEnterNew):j(g.b0.setEnterNew))}},{children:[(0,i.jsx)(f.g,{src:m.Z,width:10,height:10,fill:V.palette.primary.main,style:{transform:"rotate(180deg)"}}),(0,i.jsx)(r.Z,Object.assign({component:"span"},{children:q("popup:pinSetting:setAgain")}))]}))}))]})}},26116:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var i=n(52322),o=n(2784),s=n(47746),a=n(42921),r=n(79312),l=n(71090);var c=n(75234),p=n(90565),u=n(71382),d=n(73557),g=n(39857),h=n(9321),f=n(99947),m=n(67876),x=n(91848),y=n(47591),v=n(18322),P=n(13297),Z=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((i=i.apply(e,t||[])).next())}))};var k=()=>{const{t:e}=(0,c.$G)(),t=(0,d.s0)(),n=(0,h.i)((e=>e.popupStore.userInfo)),[k,j]=(0,o.useState)(!1),{pageLockExtension:S,header:b,user:w,userName:E,link:A,errorAnimation:C,hint:I}=(({showError:e})=>(0,l.k)({pageLockExtension:{display:"grid","& h1":{fontSize:"24px",lineHeight:"30px",fontWeight:"700",color:e=>e.palette.inputElements.main,marginBottom:"50px"}},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},user:{display:"flex",flexGrow:"1",alignItems:"center",justifyContent:"flex-start",gap:"12px"},userName:{maxWidth:"180px",fontSize:"15px",lineHeight:"18px",fontWeight:"300",color:e=>e.palette.inputElements.main},link:{color:t=>e?t.palette.error.main:t.palette.primary.main,fontSize:"15px",lineHeight:"18px",fontWeight:"300",cursor:"pointer"},errorAnimation:{marginRight:"7px","& svg":{position:"static",zIndex:"2",transform:"rotate(-90deg)",animationName:"offsetToZero",animationTimingFunction:"linear",animationFillMode:"forwards","& svg":{position:"static",zIndex:"2",transform:"rotate(-90deg)",animationName:"offsetToZero",animationTimingFunction:"linear",animationFillMode:"forwards"}},"@keyframes offsetToZero":{to:{strokeDashoffset:"0"}}},hint:{maxWidth:"200px",height:"38px",textAlign:"center",fontSize:"15px",lineHeight:"20px",fontWeight:"300",letterSpacing:"0px",color:e=>e.palette.inputElements.main,margin:"0 auto 39px"}}))({showError:k}),O=(0,s.Z)(),{setPopupHeight:F}=(0,o.useContext)(P.Q);return(0,i.jsxs)(a.Z,Object.assign({sx:S},{children:[(0,i.jsxs)(a.Z,Object.assign({sx:b},{children:[(0,i.jsxs)(a.Z,Object.assign({sx:w},{children:[(0,i.jsx)(f.Z,{openSettingsPageOnClick:!1}),(0,i.jsx)(r.Z,Object.assign({component:"p",sx:E},{children:(null==n?void 0:n.fullname)||(null==n?void 0:n.name)||(null==n?void 0:n.email)||""}))]})),(0,i.jsx)(a.Z,Object.assign({sx:C},{children:k&&(0,i.jsxs)("svg",Object.assign({height:15,width:15},{children:[(0,i.jsx)("circle",{cx:7.5,cy:7.5,r:6.5,stroke:(0,y.Fq)(O.palette.error.main,.12),strokeWidth:"2",fill:"none"}),(0,i.jsx)("circle",Object.assign({cx:7.5,cy:7.5,r:6.5,stroke:O.palette.error.main,strokeWidth:"2",fill:"none"},{children:(0,i.jsx)("animate",{attributeName:"stroke-dasharray",values:"0, 41; 41, 41",dur:"7s",repeatCount:"indefinite"})}))]}))})),(0,i.jsx)(r.Z,Object.assign({onClick:()=>Z(void 0,void 0,void 0,(function*(){yield m.ZP.SetHost(""),yield m.ZP.SetPinEntryAttempts(0);try{yield v.Z.passwork.logout()}catch(e){console.log(e)}yield(0,u.s1)(!0),t("/"),F("fit-content")})),sx:A,component:"p"},{children:e("popup:unlockExtension:logOut")}))]})),(0,i.jsxs)(r.Z,Object.assign({component:"h1"},{children:[" ",e("popup:unlockExtension:title")]})),k?(0,i.jsx)(x.Z,{notificationStatus:{show:!0,type:"fail",text:e("common:notification:limitAttemptsEnterPin")},pinError:!0}):(0,i.jsx)(p.Z,{extensionUnlock:()=>Z(void 0,void 0,void 0,(function*(){const e=yield m.ZP.GetAutoLockSettings();e.lastActive=Math.floor(Date.now()/1e3),yield m.ZP.SetAutoLockSettings(e),t({pathname:"/",search:`?${(0,g.fW)({unlocked:"true"})}`})})),close:close,setShowError:j,isPopup:!0,navigateToHost:()=>{t("/"),F("fit-content")}}),(0,i.jsx)(a.Z,{children:(0,i.jsx)(r.Z,Object.assign({component:"p",sx:I},{children:e("popup:unlockExtension:hint")}))})]}))}}}]);