{"version":3,"file":"background.js","sources":["../src/scripts/browser-api.js","../src/scripts/constants.js","../src/scripts/utils.js","../src/scripts/background.js"],"sourcesContent":["const browserApi = window.chrome || browser;\n// default\nexport default browserApi;\n","import browserApi from './browser-api.js';\n\nconst TARGET = 'firefox';\nconst { runtime } = browserApi;\nconst BASE_URL = APP_ENV.BASE_URL;\nconst SEARCH_URL = APP_ENV.SEARCH_URL;\nconst STORAGE_KEY = 'ecosiaExtensionActive';\n\nexport { BASE_URL, SEARCH_URL, TARGET, STORAGE_KEY };\nexport const { version: VERSION } = runtime.getManifest();\n","import browserApi from './browser-api.js';\nimport { BASE_URL, TARGET, VERSION } from './constants.js';\n\nconst indicatorParams = { addon: TARGET, addonversion: VERSION };\n\nexport const generateURL = (pathname, extraParams) => {\n  const parsed = new URL(BASE_URL);\n  const params = new URLSearchParams({ ...extraParams, ...indicatorParams });\n  parsed.pathname = pathname;\n  parsed.search = params.toString();\n  return parsed.toString();\n};\n\nexport const generateSearchURL = (query) => generateURL('search', { q: query });\n\nexport const handleRuntimeError = () => {\n  const error = browserApi.runtime.lastError;\n  return !!error;\n};\n","import browserApi from './browser-api.js';\nimport { VERSION } from './constants.js';\nimport {\n  generateURL,\n  generateSearchURL,\n  handleRuntimeError,\n} from './utils.js';\n\nconst { browserAction, contextMenus, tabs, i18n, runtime } = browserApi;\n\nconst onClicked = () => {\n  browserApi.tabs.create({ url: generateURL('', { ref: 'icon-search' }) });\n};\n\nconst onMessageReceived = (request, sender, sendResponse) => {\n  if (request && request.reason && request.reason === 'version') {\n    sendResponse({ version: VERSION });\n  } else {\n    const errorMessage = `invalid request: ${JSON.stringify(request)}`;\n    sendResponse({ error: new Error(errorMessage) });\n  }\n  return true;\n};\n\n// Show goodbye page on extension uninstall.\nif (runtime.setUninstallURL) {\n  const uninstallURL = generateURL('uninstall', { feedback: 'true' });\n  runtime.setUninstallURL(uninstallURL);\n}\n\nbrowserAction.onClicked.addListener(onClicked);\nruntime.onMessageExternal.addListener(onMessageReceived);\n\ncontextMenus.create({\n  id: `${runtime.id}/context`,\n  title: i18n.getMessage('context_menu_search'),\n  contexts: ['selection'],\n}, () => {\n  if (runtime.lastError) {\n    handleRuntimeError();\n  }\n\n  contextMenus.onClicked.addListener((info) => {\n    tabs.create({ url: generateSearchURL(info.selectionText) });\n  });\n});\n"],"names":["browserApi","TARGET","runtime","BASE_URL","VERSION","indicatorParams","generateURL","pathname","extraParams","parsed","params","generateSearchURL","query","handleRuntimeError","browserAction","contextMenus","tabs","i18n","onClicked","onMessageReceived","request","sender","sendResponse","errorMessage","uninstallURL","info"],"mappings":"yBAAA,MAAMA,EAAa,OAAO,QAAU,QCE9BC,EAAS,UACT,CAAEC,QAAAA,CAAS,EAAGF,EACdG,EAAkB,yBAKX,CAAE,QAASC,GAAYF,EAAQ,YAAa,ECNnDG,EAAkB,CAAE,MAAOJ,EAAQ,aAAcG,CAAO,EAEjDE,EAAc,CAACC,EAAUC,IAAgB,CACpD,MAAMC,EAAS,IAAI,IAAIN,CAAQ,EACzBO,EAAS,IAAI,gBAAgB,CAAE,GAAGF,EAAa,GAAGH,CAAe,CAAE,EACzE,OAAAI,EAAO,SAAWF,EAClBE,EAAO,OAASC,EAAO,WAChBD,EAAO,UAChB,EAEaE,EAAqBC,GAAUN,EAAY,SAAU,CAAE,EAAGM,CAAK,CAAE,EAEjEC,EAAqB,IAEzB,CAAC,CADMb,EAAW,QAAQ,UCR7B,CAAE,cAAAc,EAAe,aAAAC,EAAc,KAAAC,EAAM,KAAAC,EAAM,QAAAf,CAAS,EAAGF,EAEvDkB,EAAY,IAAM,CACtBlB,EAAW,KAAK,OAAO,CAAE,IAAKM,EAAY,GAAI,CAAE,IAAK,aAAe,CAAA,CAAG,CAAA,CACzE,EAEMa,EAAoB,CAACC,EAASC,EAAQC,IAAiB,CAC3D,GAAIF,GAAWA,EAAQ,QAAUA,EAAQ,SAAW,UAClDE,EAAa,CAAE,QAASlB,CAAO,CAAE,MAC5B,CACL,MAAMmB,EAAe,oBAAoB,KAAK,UAAUH,CAAO,CAAC,GAChEE,EAAa,CAAE,MAAO,IAAI,MAAMC,CAAY,CAAG,CAAA,CAChD,CACD,MAAO,EACT,EAGA,GAAIrB,EAAQ,gBAAiB,CAC3B,MAAMsB,EAAelB,EAAY,YAAa,CAAE,SAAU,MAAM,CAAE,EAClEJ,EAAQ,gBAAgBsB,CAAY,CACtC,CAEAV,EAAc,UAAU,YAAYI,CAAS,EAC7ChB,EAAQ,kBAAkB,YAAYiB,CAAiB,EAEvDJ,EAAa,OAAO,CAClB,GAAI,GAAGb,EAAQ,EAAE,WACjB,MAAOe,EAAK,WAAW,qBAAqB,EAC5C,SAAU,CAAC,WAAW,CACxB,EAAG,IAAM,CACHf,EAAQ,WACVW,IAGFE,EAAa,UAAU,YAAaU,GAAS,CAC3CT,EAAK,OAAO,CAAE,IAAKL,EAAkBc,EAAK,aAAa,CAAC,CAAE,CAC9D,CAAG,CACH,CAAC"}