!function(){var e={44:function(e,t){"use strict";var n=/(\w+)[-_].*/;function r(e,t){if(t[e])return t[e];var r=e.match(n);if(!r)throw new Error("Can't find lang or lcale with code "+e);return t[r[1]]}function o(e){return e>1}function i(e){return 1!==e}function a(e){return 0}var s={ach:{n:2,f:o},af:{n:2,f:i},ak:{n:2,f:o},am:{n:2,f:o},an:{n:2,f:i},ar:{n:6,f:function(e){return 0===e?0:1===e?1:2===e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5}},arn:{n:2,f:o},ast:{n:2,f:i},ay:{n:1,f:a},az:{n:2,f:i},be:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},bg:{n:2,f:i},bn:{n:2,f:i},bo:{n:1,f:a},br:{n:2,f:o},brx:{n:2,f:i},bs:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ca:{n:2,f:i},cgg:{n:1,f:a},cs:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},csb:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},cy:{n:4,f:function(e){return 1===e?0:2===e?1:8!==e&&11!==e?2:3}},da:{n:2,f:i},de:{n:2,f:i},doi:{n:2,f:i},dz:{n:1,f:a},el:{n:2,f:i},en:{n:2,f:i},eo:{n:2,f:i},es:{n:2,f:i},et:{n:2,f:i},eu:{n:2,f:i},fa:{n:1,f:a},ff:{n:2,f:i},fi:{n:2,f:i},fil:{n:2,f:o},fo:{n:2,f:i},fr:{n:2,f:function(e){return e<=-2||e>=2}},fur:{n:2,f:i},fy:{n:2,f:i},ga:{n:5,f:function(e){return 1===e?0:2===e?1:e<7?2:e<11?3:4}},gd:{n:4,f:function(e){return 1===e||11===e?0:2===e||12===e?1:e>2&&e<20?2:3}},gl:{n:2,f:i},gu:{n:2,f:i},gun:{n:2,f:o},ha:{n:2,f:i},he:{n:2,f:i},hi:{n:2,f:i},hne:{n:2,f:i},hr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},hu:{n:2,f:i},hy:{n:2,f:i},id:{n:1,f:a},is:{n:2,f:function(e){return e%10!=1||e%100==11}},it:{n:2,f:i},ja:{n:1,f:a},jbo:{n:1,f:a},jv:{n:2,f:function(e){return 0!==e}},ka:{n:1,f:a},kab:{n:2,f:i},kk:{n:2,f:i},km:{n:1,f:a},kn:{n:2,f:i},ko:{n:1,f:a},ku:{n:2,f:i},kw:{n:4,f:function(e){return 1===e?0:2===e?1:3===e?2:3}},ky:{n:1,f:a},lb:{n:2,f:i},ln:{n:2,f:o},lo:{n:1,f:a},lt:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2}},lv:{n:3,f:function(e){return e%10==1&&e%100!=11?0:0!==e?1:2}},mai:{n:2,f:i},mfe:{n:2,f:o},mg:{n:2,f:o},mi:{n:2,f:o},mk:{n:2,f:function(e){return 1===e||e%10==1?0:1}},ml:{n:2,f:i},mn:{n:2,f:i},mni:{n:2,f:i},mnk:{n:3,f:function(e){return 0===e?0:1===e?1:2}},mr:{n:2,f:i},ms:{n:1,f:a},mt:{n:4,f:function(e){return 1===e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3}},my:{n:1,f:a},nah:{n:2,f:i},nap:{n:2,f:i},nb:{n:2,f:i},ne:{n:2,f:i},nl:{n:2,f:i},nn:{n:2,f:i},no:{n:2,f:i},nso:{n:2,f:i},oc:{n:2,f:o},or:{n:2,f:i},pa:{n:2,f:i},pap:{n:2,f:i},pl:{n:3,f:function(e){return 1===e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},pms:{n:2,f:i},ps:{n:2,f:i},pt:{n:2,f:i},rm:{n:2,f:i},ro:{n:3,f:function(e){return 1===e?0:0===e||e%100>0&&e%100<20?1:2}},ru:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},rw:{n:2,f:i},sah:{n:1,f:a},sat:{n:2,f:i},sco:{n:2,f:i},sd:{n:2,f:i},se:{n:2,f:i},si:{n:2,f:i},sk:{n:3,f:function(e){return 1===e?0:e>=2&&e<=4?1:2}},sl:{n:4,f:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0}},so:{n:2,f:i},son:{n:2,f:i},sq:{n:2,f:i},sr:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},su:{n:1,f:a},sv:{n:2,f:i},sw:{n:2,f:i},ta:{n:2,f:i},te:{n:2,f:i},tg:{n:2,f:o},th:{n:1,f:a},ti:{n:2,f:o},tk:{n:2,f:i},tr:{n:2,f:o},tt:{n:1,f:a},ug:{n:1,f:a},uk:{n:3,f:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}},ur:{n:2,f:i},uz:{n:2,f:o},vi:{n:1,f:a},wa:{n:2,f:o},wo:{n:1,f:a},yo:{n:2,f:i},zh:{n:1,f:a}};var c={};t.getPluralFunc=function(e){if(c[e])return c[e];var t=r(e,s),n=function(e,n){return n[+t.f(e)]};return c[e]=n,n}},429:function(e,t,n){e.exports=n(44)},970:function(e){"use strict";e.exports={appVersion:"1.2.5",appId:"jplgfhpmjnbigmhklmmbgecoobifkmpa",baseDomainURL:"https://account.proton.me",tokenDuration:1200,proxyHost:null,proxyPort:4443,singleProxyPort:!1,proxySecureCorePort:443,scheme:"https",apiDomainsExclusion:[],proxyLocalNetworkExclusion:["localhost","127.0.0.1","127.0.0.0/8","127.0.0.1:80","10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","[::1]","<local>"],signupEnabled:!0,torEnabled:!1,sentry:"https://5c4abb94f5a644b38cf8e3261dfad0e3@reports.proton.me/api/core/v4/reports/sentry/67"}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e,t=n(970),r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},i=t.appVersion,a=t.appId,s=t.baseDomainURL,c="".concat(s,"/").concat(""),u=("".concat(c,"vpn/dashboard"),"".concat(s,"/api/")),l=new URL(u).hostname,f=!0,d=t.sentry,p=o([l],r(t.apiDomainsExclusion),!1),h=t.proxyLocalNetworkExclusion,v=t.signupEnabled,y=t.torEnabled,b=t.tokenDuration,m=Math.floor(b/4),g=t.proxyHost,w=t.proxyPort,_=t.singleProxyPort,x=t.proxySecureCorePort,S=t.scheme,E=!0,k=function(){return k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},k.apply(this,arguments)},O=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},P=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){e.LOCAL="local",e.SYNC="sync",e.SESSION="session"}(e||(e={}));var T=e.LOCAL,C=e.SESSION in chrome.storage?e.SESSION:T,I=function(t){return t===e.LOCAL?localStorage:sessionStorage},D={getDefinedItem:function(e,t,n){return void 0===n&&(n=T),O(this,void 0,void 0,(function(){return P(this,(function(r){switch(r.label){case 0:return[4,this.getItem(e,t,n)];case 1:return[2,r.sent()||t]}}))}))},getItem:function(e,t,n){return void 0===t&&(t=void 0),void 0===n&&(n=T),O(this,void 0,void 0,(function(){var r,o,i,a,s;return P(this,(function(c){switch(c.label){case 0:r="bex-"+e,c.label=1;case 1:return c.trys.push([1,3,,8]),[4,new Promise((function(e){chrome.storage[n].get(r,e)}))];case 2:return"object"==typeof(o=c.sent())&&o.hasOwnProperty(r)?[2,o[r]]:[2,t];case 3:c.sent(),i=I(n),c.label=4;case 4:return c.trys.push([4,6,,7]),[4,i.getItem(r)];case 5:return"string"==typeof(a=c.sent())?[2,JSON.parse(a)]:[2,t];case 6:return c.sent(),[2,(s=window.bexStorage||(window.bexStorage={})).hasOwnProperty(e)?s[e]:t];case 7:return[3,8];case 8:return[2]}}))}))},setItem:function(e,t,n){return void 0===n&&(n=T),O(this,void 0,void 0,(function(){var r,o,i;return P(this,(function(a){switch(a.label){case 0:r="bex-"+e,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,chrome.storage[n].set((i={},i[r]=t,i))];case 2:return a.sent(),[3,4];case 3:a.sent(),o=JSON.stringify(t);try{I(n).setItem(r,o)}catch(n){(window.bexStorage||(window.bexStorage={}))[e]=t}return[3,4];case 4:return[2]}}))}))},removeItem:function(e,t){return void 0===t&&(t=T),O(this,void 0,void 0,(function(){var n;return P(this,(function(r){switch(r.label){case 0:n="bex-"+e,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,chrome.storage[t].remove(n)];case 2:return r.sent(),[3,4];case 3:r.sent();try{I(t).removeItem(n)}catch(t){delete(window.bexStorage||(window.bexStorage={}))[e]}return[3,4];case 4:return[2]}}))}))},item:function(e,t,n){void 0===t&&(t=T),void 0===n&&(n="value");var r=this;return{key:e,get:function(n){return void 0===n&&(n=void 0),r.getItem(e,n,t)},getDefined:function(n){return r.getDefinedItem(e,n,t)},load:function(n){return void 0===n&&(n=void 0),O(this,void 0,void 0,(function(){var o;return P(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,r.getItem(e,n,t)];case 1:return[2,"object"==typeof(o=i.sent())?o:{}];case 2:return i.sent(),[2,{}];case 3:return[2]}}))}))},set:function(n){return r.setItem(e,n,t)},setValue:function(e,t){var r;return void 0===t&&(t={}),this.set(k(((r={time:Date.now()})[n]=e,r),t))},remove:function(){return r.removeItem(e,t)}}},selfItem:function(e,t){return void 0===t&&(t=T),this.item(e,t,e)}};const N="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,L="8.7.0",j=globalThis;function R(e,t,n){const r=n||j,o=r.__SENTRY__=r.__SENTRY__||{},i=o[L]=o[L]||{};return i[e]||(i[e]=t())}const A=["debug","info","warn","error","log","assert","trace"],M={};function $(e){if(!("console"in j))return e();const t=j.console,n={},r=Object.keys(M);r.forEach((e=>{const r=M[e];n[e]=t[e],t[e]=r}));try{return e()}finally{r.forEach((e=>{t[e]=n[e]}))}}const U=function(){let e=!1;const t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return N?A.forEach((n=>{t[n]=(...t)=>{e&&$((()=>{j.console[n](`Sentry Logger [${n}]:`,...t)}))}})):A.forEach((e=>{t[e]=()=>{}})),t}(),G=j;function q(){if(!("fetch"in G))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function H(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}const F="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,V=j,B={};function z(e){const t=B[e];if(t)return t;let n=V[e];if(H(n))return B[e]=n.bind(V);const r=V.document;if(r&&"function"==typeof r.createElement)try{const t=r.createElement("iframe");t.hidden=!0,r.head.appendChild(t);const o=t.contentWindow;o&&o[e]&&(n=o[e]),r.head.removeChild(t)}catch(t){F&&U.warn(`Could not create sandbox iframe for ${e} check, bailing to window.${e}: `,t)}return n?B[e]=n.bind(V):n}function Y(e){B[e]=void 0}class J extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}const W=Object.prototype.toString;function K(e){switch(W.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return ae(e,Error)}}function X(e,t){return W.call(e)===`[object ${t}]`}function Z(e){return X(e,"ErrorEvent")}function Q(e){return X(e,"DOMError")}function ee(e){return X(e,"String")}function te(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function ne(e){return null===e||te(e)||"object"!=typeof e&&"function"!=typeof e}function re(e){return X(e,"Object")}function oe(e){return"undefined"!=typeof Event&&ae(e,Event)}function ie(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function ae(e,t){try{return e instanceof t}catch(e){return!1}}function se(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}var ce;function ue(e){return new fe((t=>{t(e)}))}function le(e){return new fe(((t,n)=>{n(e)}))}!function(e){e[e.PENDING=0]="PENDING";e[e.RESOLVED=1]="RESOLVED";e[e.REJECTED=2]="REJECTED"}(ce||(ce={}));class fe{constructor(e){fe.prototype.__init.call(this),fe.prototype.__init2.call(this),fe.prototype.__init3.call(this),fe.prototype.__init4.call(this),this._state=ce.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new fe(((n,r)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){r(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){r(e)}else r(e)}]),this._executeHandlers()}))}catch(e){return this.then((e=>e),e)}finally(e){return new fe(((t,n)=>{let r,o;return this.then((t=>{o=!1,r=t,e&&e()}),(t=>{o=!0,r=t,e&&e()})).then((()=>{o?n(r):t(r)}))}))}__init(){this._resolve=e=>{this._setResult(ce.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(ce.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===ce.PENDING&&(ie(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===ce.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach((e=>{e[0]||(this._state===ce.RESOLVED&&e[1](this._value),this._state===ce.REJECTED&&e[2](this._value),e[0]=!0)}))}}}function de(e){const t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(r){if(!(void 0===e||t.length<e))return le(new J("Not adding Promise because buffer limit was reached."));const o=r();return-1===t.indexOf(o)&&t.push(o),o.then((()=>n(o))).then(null,(()=>n(o).then(null,(()=>{})))),o},drain:function(e){return new fe(((n,r)=>{let o=t.length;if(!o)return n(!0);const i=setTimeout((()=>{e&&e>0&&n(!1)}),e);t.forEach((e=>{ue(e).then((()=>{--o||(clearTimeout(i),n(!0))}),r)}))}))}}}const pe=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function he(e,t=!1){const{host:n,path:r,pass:o,port:i,projectId:a,protocol:s,publicKey:c}=e;return`${s}://${c}${t&&o?`:${o}`:""}@${n}${i?`:${i}`:""}/${r?`${r}/`:r}${a}`}function ve(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function ye(e){const t="string"==typeof e?function(e){const t=pe.exec(e);if(!t)return void $((()=>{console.error(`Invalid Sentry Dsn: ${e}`)}));const[n,r,o="",i,a="",s]=t.slice(1);let c="",u=s;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const e=u.match(/^\d+/);e&&(u=e[0])}return ve({host:i,pass:o,path:c,projectId:u,port:a,protocol:n,publicKey:r})}(e):ve(e);if(t&&function(e){if(!N)return!0;const{port:t,projectId:n,protocol:r}=e;return!(["protocol","publicKey","host","projectId"].find((t=>!e[t]&&(U.error(`Invalid Sentry Dsn: ${t} missing`),!0)))||(n.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(r)?t&&isNaN(parseInt(t,10))&&(U.error(`Invalid Sentry Dsn: Invalid port ${t}`),1):(U.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(U.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(t))return t}const be=j,me=80;function ge(e,t={}){if(!e)return"<unknown>";try{let n=e;const r=5,o=[];let i=0,a=0;const s=" > ",c=s.length;let u;const l=Array.isArray(t)?t:t.keyAttrs,f=!Array.isArray(t)&&t.maxStringLength||me;for(;n&&i++<r&&(u=we(n,l),!("html"===u||i>1&&a+o.length*c+u.length>=f));)o.push(u),a+=u.length,n=n.parentNode;return o.reverse().join(s)}catch(e){return"<unknown>"}}function we(e,t){const n=e,r=[];let o,i,a,s,c;if(!n||!n.tagName)return"";if(be.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const u=t&&t.length?t.filter((e=>n.getAttribute(e))).map((e=>[e,n.getAttribute(e)])):null;if(u&&u.length)u.forEach((e=>{r.push(`[${e[0]}="${e[1]}"]`)}));else if(n.id&&r.push(`#${n.id}`),o=n.className,o&&ee(o))for(i=o.split(/\s+/),c=0;c<i.length;c++)r.push(`.${i[c]}`);const l=["aria-label","type","name","title","alt"];for(c=0;c<l.length;c++)a=l[c],s=n.getAttribute(a),s&&r.push(`[${a}="${s}"]`);return r.join("")}function _e(e,t=0){return"string"!=typeof e||0===t||e.length<=t?e:`${e.slice(0,t)}...`}function xe(e,t){if(!Array.isArray(e))return"";const n=[];for(let t=0;t<e.length;t++){const r=e[t];try{se(r)?n.push("[VueViewModel]"):n.push(String(r))}catch(e){n.push("[value cannot be serialized]")}}return n.join(t)}function Se(e,t,n=!1){return!!ee(e)&&(X(t,"RegExp")?t.test(e):!!ee(t)&&(n?e===t:e.includes(t)))}function Ee(e,t=[],n=!1){return t.some((t=>Se(e,t,n)))}function ke(e,t,n){if(!(t in e))return;const r=e[t],o=n(r);"function"==typeof o&&Pe(o,r),e[t]=o}function Oe(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){N&&U.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function Pe(e,t){try{const n=t.prototype||{};e.prototype=t.prototype=n,Oe(e,"__sentry_original__",t)}catch(e){}}function Te(e){return e.__sentry_original__}function Ce(e){if(K(e))return{message:e.message,name:e.name,stack:e.stack,...De(e)};if(oe(e)){const t={type:e.type,target:Ie(e.target),currentTarget:Ie(e.currentTarget),...De(e)};return"undefined"!=typeof CustomEvent&&ae(e,CustomEvent)&&(t.detail=e.detail),t}return e}function Ie(e){try{return t=e,"undefined"!=typeof Element&&ae(t,Element)?ge(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}var t}function De(e){if("object"==typeof e&&null!==e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}return{}}function Ne(e){return Le(e,new Map)}function Le(e,t){if(function(e){if(!re(e))return!1;try{const t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(e)){const n=t.get(e);if(void 0!==n)return n;const r={};t.set(e,r);for(const n of Object.keys(e))void 0!==e[n]&&(r[n]=Le(e[n],t));return r}if(Array.isArray(e)){const n=t.get(e);if(void 0!==n)return n;const r=[];return t.set(e,r),e.forEach((e=>{r.push(Le(e,t))})),r}return e}const je=50,Re="?",Ae=/\(error: (.*)\)/,Me=/captureMessage|captureException/;function $e(...e){const t=e.sort(((e,t)=>e[0]-t[0])).map((e=>e[1]));return(e,n=0,r=0)=>{const o=[],i=e.split("\n");for(let e=n;e<i.length;e++){const n=i[e];if(n.length>1024)continue;const a=Ae.test(n)?n.replace(Ae,"$1"):n;if(!a.match(/\S*Error: /)){for(const e of t){const t=e(a);if(t){o.push(t);break}}if(o.length>=je+r)break}}return function(e){if(!e.length)return[];const t=Array.from(e);/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop();t.reverse(),Me.test(t[t.length-1].function||"")&&(t.pop(),Me.test(t[t.length-1].function||"")&&t.pop());return t.slice(0,je).map((e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||Re})))}(o.slice(r))}}const Ue="<anonymous>";function Ge(e){try{return e&&"function"==typeof e&&e.name||Ue}catch(e){return Ue}}function qe(e,t=100,n=1/0){try{return Fe("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}function He(e,t=3,n=102400){const r=qe(e,t);return o=r,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(o))>n?He(e,t-1,n):r;var o}function Fe(e,t,n=1/0,r=1/0,o=function(){const e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){const[i,a]=o;if(null==t||["number","boolean","string"].includes(typeof t)&&!Number.isNaN(t))return t;const s=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(se(t))return"[VueViewModel]";if(re(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${Ge(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;const r=function(e){const t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(e){return`**non-serializable** (${e})`}var n}(e,t);if(!s.startsWith("[object "))return s;if(t.__sentry_skip_normalization__)return t;const c="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:n;if(0===c)return s.replace("object ","");if(i(t))return"[Circular ~]";const u=t;if(u&&"function"==typeof u.toJSON)try{return Fe("",u.toJSON(),c-1,r,o)}catch(e){}const l=Array.isArray(t)?[]:{};let f=0;const d=Ce(t);for(const e in d){if(!Object.prototype.hasOwnProperty.call(d,e))continue;if(f>=r){l[e]="[MaxProperties ~]";break}const t=d[e];l[e]=Fe(e,t,c-1,r,o),f++}return a(t),l}function Ve(e,t=[]){return[e,t]}function Be(e,t){const[n,r]=e;return[n,[...r,t]]}function ze(e,t){const n=e[1];for(const e of n){if(t(e,e[0].type))return!0}return!1}function Ye(e){return j.__SENTRY__&&j.__SENTRY__.encodePolyfill?j.__SENTRY__.encodePolyfill(e):(new TextEncoder).encode(e)}function Je(e){const[t,n]=e;let r=JSON.stringify(t);function o(e){"string"==typeof r?r="string"==typeof e?r+e:[Ye(r),e]:r.push("string"==typeof e?Ye(e):e)}for(const e of n){const[t,n]=e;if(o(`\n${JSON.stringify(t)}\n`),"string"==typeof n||n instanceof Uint8Array)o(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify(qe(n))}o(e)}}return"string"==typeof r?r:function(e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}(r)}function We(e){const t="string"==typeof e.data?Ye(e.data):e.data;return[Ne({type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),t]}const Ke={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function Xe(e){return Ke[e]}function Ze(e){if(!e||!e.sdk)return;const{name:t,version:n}=e.sdk;return{name:t,version:n}}const Qe=6e4;function et(e,{statusCode:t,headers:n},r=Date.now()){const o={...e},i=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(i)for(const e of i.trim().split(",")){const[t,n,,,i]=e.split(":",5),a=parseInt(t,10),s=1e3*(isNaN(a)?60:a);if(n)for(const e of n.split(";"))"metric_bucket"===e&&i&&!i.split(";").includes("custom")||(o[e]=r+s);else o.all=r+s}else a?o.all=r+function(e,t=Date.now()){const n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${e}`);return isNaN(r)?Qe:r-t}(a,r):429===t&&(o.all=r+6e4);return o}const tt="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,nt=64;function rt(e,t,n=de(e.bufferSize||nt)){let r={};return{send:function(o){const i=[];if(ze(o,((t,n)=>{const o=Xe(n);if(function(e,t,n=Date.now()){return function(e,t){return e[t]||e.all||0}(e,t)>n}(r,o)){const r=ot(t,n);e.recordDroppedEvent("ratelimit_backoff",o,r)}else i.push(t)})),0===i.length)return ue({});const a=Ve(o[0],i),s=t=>{ze(a,((n,r)=>{const o=ot(n,r);e.recordDroppedEvent(t,Xe(r),o)}))};return n.add((()=>t({body:Je(a)}).then((e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&tt&&U.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),r=et(r,e),e)),(e=>{throw s("network_error"),e})))).then((e=>e),(e=>{if(e instanceof J)return tt&&U.error("Skipped sending event because buffer is full."),s("queue_overflow"),ue({});throw e}))},flush:e=>n.drain(e)}}function ot(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}function it(){const e=j,t=e.crypto||e.msCrypto;let n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{const e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,(e=>(e^(15&n())>>e/4).toString(16)))}function at(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function st(e){const{message:t,event_id:n}=e;if(t)return t;const r=at(e);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function ct(e,t,n){const r=e.exception=e.exception||{},o=r.values=r.values||[],i=o[0]=o[0]||{};i.value||(i.value=t||""),i.type||(i.type=n||"Error")}function ut(e,t){const n=at(e);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...t},t&&"data"in t){const e={...r&&r.data,...t.data};n.mechanism.data=e}}function lt(e){if(e&&e.__sentry_captured__)return!0;try{Oe(e,"__sentry_captured__",!0)}catch(e){}return!1}const ft=[];function dt(e,t){for(const n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function pt(e,t,n){if(n[t.name])tt&&U.log(`Integration skipped because it was already installed: ${t.name}`);else{if(n[t.name]=t,-1===ft.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),ft.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){const n=t.preprocessEvent.bind(t);e.on("preprocessEvent",((t,r)=>n(t,r,e)))}if("function"==typeof t.processEvent){const n=t.processEvent.bind(t),r=Object.assign(((t,r)=>n(t,r,e)),{id:t.name});e.addEventProcessor(r)}tt&&U.log(`Integration installed: ${t.name}`)}}const ht=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],vt=(e={})=>({name:"InboundFilters",processEvent(t,n,r){const o=r.getOptions(),i=function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:ht],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,o);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return tt&&U.warn(`Event dropped due to being internal Sentry Error.\nEvent: ${st(e)}`),!0;if(function(e,t){if(e.type||!t||!t.length)return!1;return function(e){const t=[];e.message&&t.push(e.message);let n;try{n=e.exception.values[e.exception.values.length-1]}catch(e){}n&&n.value&&(t.push(n.value),n.type&&t.push(`${n.type}: ${n.value}`));return t}(e).some((e=>Ee(e,t)))}(e,t.ignoreErrors))return tt&&U.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${st(e)}`),!0;if(function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;const n=e.transaction;return!!n&&Ee(n,t)}(e,t.ignoreTransactions))return tt&&U.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${st(e)}`),!0;if(function(e,t){if(!t||!t.length)return!1;const n=yt(e);return!!n&&Ee(n,t)}(e,t.denyUrls))return tt&&U.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${st(e)}.\nUrl: ${yt(e)}`),!0;if(!function(e,t){if(!t||!t.length)return!0;const n=yt(e);return!n||Ee(n,t)}(e,t.allowUrls))return tt&&U.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${st(e)}.\nUrl: ${yt(e)}`),!0;return!1}(t,i)?null:t}});function yt(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return tt&&U.error(`Cannot extract url for event ${st(e)}`),null}}function bt(){return mt(j),j}function mt(e){const t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||L,t[L]=t[L]||{}}function gt(){return{traceId:it(),spanId:it().substring(16)}}const wt=1e3;function _t(){return Date.now()/wt}const xt=function(){const{performance:e}=j;if(!e||!e.now)return _t;const t=Date.now()-e.now(),n=null==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/wt}();let St;(()=>{const{performance:e}=j;if(!e||!e.now)return void(St="none");const t=36e5,n=e.now(),r=Date.now(),o=e.timeOrigin?Math.abs(e.timeOrigin+n-r):t,i=o<t,a=e.timing&&e.timing.navigationStart,s="number"==typeof a?Math.abs(a+n-r):t;i||s<t?o<=s?(St="timeOrigin",e.timeOrigin):St="navigationStart":St="dateNow"})();function Et(e,t={}){if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||xt(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:it()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{const t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}const kt="_sentrySpan";function Ot(e,t){t?Oe(e,kt,t):delete e[kt]}function Pt(e){return e[kt]}class Tt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=gt()}clone(){const e=new Tt;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Ot(e,Pt(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Et(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t="function"==typeof e?e(this):e,[n,r]=t instanceof Ct?[t.getScopeData(),t.getRequestSession()]:re(t)?[e,e.requestSession]:[],{tags:o,extra:i,user:a,contexts:s,level:c,fingerprint:u=[],propagationContext:l}=n||{};return this._tags={...this._tags,...o},this._extra={...this._extra,...i},this._contexts={...this._contexts,...s},a&&Object.keys(a).length&&(this._user=a),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),r&&(this._requestSession=r),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Ot(this,void 0),this._attachments=[],this._propagationContext=gt(),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n="number"==typeof t?t:100;if(n<=0)return this;const r={timestamp:_t(),...e},o=this._breadcrumbs;return o.push(r),this._breadcrumbs=o.length>n?o.slice(-n):o,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Pt(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:it();if(!this._client)return U.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...t,event_id:n},this),n}captureMessage(e,t,n){const r=n&&n.event_id?n.event_id:it();if(!this._client)return U.warn("No client configured on scope - will not capture message!"),r;const o=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:r},this),r}captureEvent(e,t){const n=t&&t.event_id?t.event_id:it();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(U.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((e=>{e(this)})),this._notifyingListeners=!1)}}const Ct=Tt;class It{constructor(e,t){let n,r;n=e||new Ct,r=t||new Ct,this._stack=[{scope:n}],this._isolationScope=r}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(e){throw this._popScope(),e}return ie(n)?n.then((e=>(this._popScope(),e)),(e=>{throw this._popScope(),e})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}_popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}}function Dt(){const e=mt(bt());return e.stack=e.stack||new It(R("defaultCurrentScope",(()=>new Ct)),R("defaultIsolationScope",(()=>new Ct)))}function Nt(e){return Dt().withScope(e)}function Lt(e,t){const n=Dt();return n.withScope((()=>(n.getStackTop().scope=e,t(e))))}function jt(e){return Dt().withScope((()=>e(Dt().getIsolationScope())))}function Rt(e){const t=mt(e);return t.acs?t.acs:{withIsolationScope:jt,withScope:Nt,withSetScope:Lt,withSetIsolationScope:(e,t)=>jt(t),getCurrentScope:()=>Dt().getScope(),getIsolationScope:()=>Dt().getIsolationScope()}}function At(){return Rt(bt()).getCurrentScope()}function Mt(){return Rt(bt()).getIsolationScope()}function $t(){return At().getClient()}let Ut;const Gt=new WeakMap,qt=()=>({name:"FunctionToString",setupOnce(){Ut=Function.prototype.toString;try{Function.prototype.toString=function(...e){const t=Te(this),n=Gt.has($t())&&void 0!==t?t:this;return Ut.apply(n,e)}}catch(e){}},setup(e){Gt.set(e,!0)}}),Ht=()=>{let e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){const n=e.message,r=t.message;if(!n&&!r)return!1;if(n&&!r||!n&&r)return!1;if(n!==r)return!1;if(!Vt(e,t))return!1;if(!Ft(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){const n=Bt(t),r=Bt(e);if(!n||!r)return!1;if(n.type!==r.type||n.value!==r.value)return!1;if(!Vt(e,t))return!1;if(!Ft(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return tt&&U.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){}return e=t}}};function Ft(e,t){let n=zt(e),r=zt(t);if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],o=n[e];if(t.filename!==o.filename||t.lineno!==o.lineno||t.colno!==o.colno||t.function!==o.function)return!1}return!0}function Vt(e,t){let n=e.fingerprint,r=t.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return!(n.join("")!==r.join(""))}catch(e){return!1}}function Bt(e){return e.exception&&e.exception.values&&e.exception.values[0]}function zt(e){const t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}}const Yt={},Jt={};function Wt(e,t){Yt[e]=Yt[e]||[],Yt[e].push(t)}function Kt(e,t){Jt[e]||(t(),Jt[e]=!0)}function Xt(e,t){const n=e&&Yt[e];if(n)for(const r of n)try{r(t)}catch(t){N&&U.error(`Error while triggering instrumentation handler.\nType: ${e}\nName: ${Ge(r)}\nError:`,t)}}const Zt=1e3;let Qt,en,tn;function nn(){if(!V.document)return;const e=Xt.bind(null,"dom"),t=rn(e,!0);V.document.addEventListener("click",t,!1),V.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((t=>{const n=V[t]&&V[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ke(n,"addEventListener",(function(t){return function(n,r,o){if("click"===n||"keypress"==n)try{const r=this,i=r.__sentry_instrumentation_handlers__=r.__sentry_instrumentation_handlers__||{},a=i[n]=i[n]||{refCount:0};if(!a.handler){const r=rn(e);a.handler=r,t.call(this,n,r,o)}a.refCount++}catch(e){}return t.call(this,n,r,o)}})),ke(n,"removeEventListener",(function(e){return function(t,n,r){if("click"===t||"keypress"==t)try{const n=this,o=n.__sentry_instrumentation_handlers__||{},i=o[t];i&&(i.refCount--,i.refCount<=0&&(e.call(this,t,i.handler,r),i.handler=void 0,delete o[t]),0===Object.keys(o).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,n,r)}})))}))}function rn(e,t=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(e){try{return e.target}catch(e){return null}}(n);if(function(e,t){return"keypress"===e&&(!t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(n.type,r))return;Oe(n,"_sentryCaptured",!0),r&&!r._sentryId&&Oe(r,"_sentryId",it());const o="keypress"===n.type?"input":n.type;if(!function(e){if(e.type!==en)return!1;try{if(!e.target||e.target._sentryId!==tn)return!1}catch(e){}return!0}(n)){e({event:n,name:o,global:t}),en=n.type,tn=r?r._sentryId:void 0}clearTimeout(Qt),Qt=V.setTimeout((()=>{tn=void 0,en=void 0}),Zt)}}const on="__sentry_xhr_v3__";function an(){if(!V.XMLHttpRequest)return;const e=XMLHttpRequest.prototype;ke(e,"open",(function(e){return function(...t){const n=1e3*xt(),r=ee(t[0])?t[0].toUpperCase():void 0,o=function(e){if(ee(e))return e;try{return e.toString()}catch(e){}return}(t[1]);if(!r||!o)return e.apply(this,t);this[on]={method:r,url:o,request_headers:{}},"POST"===r&&o.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const i=()=>{const e=this[on];if(e&&4===this.readyState){try{e.status_code=this.status}catch(e){}Xt("xhr",{endTimestamp:1e3*xt(),startTimestamp:n,xhr:this})}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?ke(this,"onreadystatechange",(function(e){return function(...t){return i(),e.apply(this,t)}})):this.addEventListener("readystatechange",i),ke(this,"setRequestHeader",(function(e){return function(...t){const[n,r]=t,o=this[on];return o&&ee(n)&&ee(r)&&(o.request_headers[n.toLowerCase()]=r),e.apply(this,t)}})),e.apply(this,t)}})),ke(e,"send",(function(e){return function(...t){const n=this[on];if(!n)return e.apply(this,t);void 0!==t[0]&&(n.body=t[0]);return Xt("xhr",{startTimestamp:1e3*xt(),xhr:this}),e.apply(this,t)}}))}const sn=j;let cn;function un(){if(!function(){const e=sn.chrome,t=e&&e.app&&e.app.runtime,n="history"in sn&&!!sn.history.pushState&&!!sn.history.replaceState;return!t&&n}())return;const e=V.onpopstate;function t(e){return function(...t){const n=t.length>2?t[2]:void 0;if(n){const e=cn,t=String(n);cn=t;Xt("history",{from:e,to:t})}return e.apply(this,t)}}V.onpopstate=function(...t){const n=V.location.href,r=cn;cn=n;if(Xt("history",{from:r,to:n}),e)try{return e.apply(this,t)}catch(e){}},ke(V.history,"pushState",t),ke(V.history,"replaceState",t)}const ln=100;function fn(e,t){const n=$t(),r=Mt();if(!n)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:i=ln}=n.getOptions();if(i<=0)return;const a={timestamp:_t(),...e},s=o?$((()=>o(a,t))):a;null!==s&&(n.emit&&n.emit("beforeAddBreadcrumb",s,t),r.addBreadcrumb(s,i))}function dn(){"console"in j&&A.forEach((function(e){e in j.console&&ke(j.console,e,(function(t){return M[e]=t,function(...t){Xt("console",{args:t,level:e});const n=M[e];n&&n.apply(j.console,t)}}))}))}function pn(){(function(){if("string"==typeof EdgeRuntime)return!0;if(!q())return!1;if(H(G.fetch))return!0;let e=!1;const t=G.document;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(e=H(n.contentWindow.fetch)),t.head.removeChild(n)}catch(e){N&&U.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return e})()&&ke(j,"fetch",(function(e){return function(...t){const{method:n,url:r}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){const[t,n]=e;return{url:vn(t),method:hn(n,"method")?String(n.method).toUpperCase():"GET"}}const t=e[0];return{url:vn(t),method:hn(t,"method")?String(t.method).toUpperCase():"GET"}}(t),o={args:t,fetchData:{method:n,url:r},startTimestamp:1e3*xt()};return Xt("fetch",{...o}),e.apply(j,t).then((e=>(Xt("fetch",{...o,endTimestamp:1e3*xt(),response:e}),e)),(e=>{throw Xt("fetch",{...o,endTimestamp:1e3*xt(),error:e}),e}))}}))}function hn(e,t){return!!e&&"object"==typeof e&&!!e[t]}function vn(e){return"string"==typeof e?e:e?hn(e,"url")?e.url:e.toString?e.toString():"":""}const yn=["fatal","error","warning","log","info","debug"];function bn(e){return"warn"===e?"warning":yn.includes(e)?e:"log"}function mn(e){if(!e)return{};const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};const n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:r,relative:t[5]+n+r}}const gn="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,wn="production";function _n(e,t,n,r=0){return new fe(((o,i)=>{const a=e[r];if(null===t||"function"!=typeof a)o(t);else{const s=a({...t},n);tt&&a.id&&null===s&&U.log(`Event processor "${a.id}" dropped event`),ie(s)?s.then((t=>_n(e,t,n,r+1).then(o))).then(null,i):_n(e,s,n,r+1).then(o).then(null,i)}}))}const xn="sentry.source",Sn="sentry.sample_rate",En="sentry.op",kn="sentry.origin",On="_sentryMetrics";function Pn(e){const t=e[On];if(!t)return;const n={};for(const[,[e,r]]of t)n[e]||(n[e]=[]),n[e].push(Ne(r));return n}const Tn=0,Cn=1;const In=1;function Dn(e){const{spanId:t,traceId:n}=e.spanContext(),{parent_span_id:r}=jn(e);return Ne({parent_span_id:r,span_id:t,trace_id:n})}function Nn(e){return"number"==typeof e?Ln(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?Ln(e.getTime()):xt()}function Ln(e){return e>9999999999?e/1e3:e}function jn(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();try{const{spanId:t,traceId:n}=e.spanContext();if(function(e){const t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){const{attributes:r,startTime:o,name:i,endTime:a,parentSpanId:s,status:c}=e;return Ne({span_id:t,trace_id:n,data:r,description:i,parent_span_id:s,start_timestamp:Nn(o),timestamp:Nn(a)||void 0,status:An(c),op:r[En],origin:r[kn],_metrics_summary:Pn(e)})}return{span_id:t,trace_id:n}}catch(e){return{}}}function Rn(e){const{traceFlags:t}=e.spanContext();return t===In}function An(e){if(e&&e.code!==Tn)return e.code===Cn?"ok":e.message||"unknown_error"}const Mn="_sentryRootSpan";function $n(e){return e[Mn]||e}const Un="_frozenDsc";function Gn(e,t){const n=t.getOptions(),{publicKey:r}=t.getDsn()||{},o=Ne({environment:n.environment||wn,release:n.release,public_key:r,trace_id:e});return t.emit("createDsc",o),o}function qn(e){const t=$t();if(!t)return{};const n=Gn(jn(e).trace_id||"",t),r=$n(e);if(!r)return n;const o=r[Un];if(o)return o;const i=jn(r),a=i.data||{},s=a[Sn];null!=s&&(n.sample_rate=`${s}`);const c=a[xn];return c&&"url"!==c&&(n.transaction=i.description),n.sampled=String(Rn(r)),t.emit("createDsc",n),n}function Hn(e,t){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:i}=t;!function(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,transactionName:s}=t,c=Ne(n);c&&Object.keys(c).length&&(e.extra={...c,...e.extra});const u=Ne(r);u&&Object.keys(u).length&&(e.tags={...u,...e.tags});const l=Ne(o);l&&Object.keys(l).length&&(e.user={...l,...e.user});const f=Ne(i);f&&Object.keys(f).length&&(e.contexts={...f,...e.contexts});a&&(e.level=a);s&&"transaction"!==e.type&&(e.transaction=s)}(e,t),r&&function(e,t){e.contexts={trace:Dn(t),...e.contexts},e.sdkProcessingMetadata={dynamicSamplingContext:qn(t),...e.sdkProcessingMetadata};const n=$n(t),r=jn(n).description;r&&!e.transaction&&"transaction"===e.type&&(e.transaction=r)}(e,r),function(e,t){e.fingerprint=e.fingerprint?function(e){return Array.isArray(e)?e:[e]}(e.fingerprint):[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint}(e,n),function(e,t){const n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,o),function(e,t){e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...t}}(e,i)}function Fn(e,t){const{extra:n,tags:r,user:o,contexts:i,level:a,sdkProcessingMetadata:s,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:f,propagationContext:d,transactionName:p,span:h}=t;Vn(e,"extra",n),Vn(e,"tags",r),Vn(e,"user",o),Vn(e,"contexts",i),Vn(e,"sdkProcessingMetadata",s),a&&(e.level=a),p&&(e.transactionName=p),h&&(e.span=h),c.length&&(e.breadcrumbs=[...e.breadcrumbs,...c]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),l.length&&(e.eventProcessors=[...e.eventProcessors,...l]),f.length&&(e.attachments=[...e.attachments,...f]),e.propagationContext={...e.propagationContext,...d}}function Vn(e,t,n){if(n&&Object.keys(n).length){e[t]={...e[t]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[t][r]=n[r])}}function Bn(e,t,n,r,o,i){const{normalizeDepth:a=3,normalizeMaxBreadth:s=1e3}=e,c={...t,event_id:t.event_id||n.event_id||it(),timestamp:t.timestamp||_t()},u=n.integrations||e.integrations.map((e=>e.name));!function(e,t){const{environment:n,release:r,dist:o,maxValueLength:i=250}=t;"environment"in e||(e.environment="environment"in t?n:wn);void 0===e.release&&void 0!==r&&(e.release=r);void 0===e.dist&&void 0!==o&&(e.dist=o);e.message&&(e.message=_e(e.message,i));const a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=_e(a.value,i));const s=e.request;s&&s.url&&(s.url=_e(s.url,i))}(c,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(c,u),void 0===t.type&&function(e,t){const n=j._sentryDebugIds;if(!n)return;let r;const o=zn.get(t);o?r=o:(r=new Map,zn.set(t,r));const i=Object.keys(n).reduce(((e,o)=>{let i;const a=r.get(o);a?i=a:(i=t(o),r.set(o,i));for(let t=i.length-1;t>=0;t--){const r=i[t];if(r.filename){e[r.filename]=n[o];break}}return e}),{});try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.filename&&(e.debug_id=i[e.filename])}))}))}catch(e){}}(c,e.stackParser);const l=function(e,t){if(!t)return e;const n=e?e.clone():new Ct;return n.update(t),n}(r,n.captureContext);n.mechanism&&ut(c,n.mechanism);const f=o?o.getEventProcessors():[],d=R("globalScope",(()=>new Ct)).getScopeData();if(i){Fn(d,i.getScopeData())}if(l){Fn(d,l.getScopeData())}const p=[...n.attachments||[],...d.attachments];p.length&&(n.attachments=p),Hn(c,d);return _n([...f,...d.eventProcessors],c,n).then((e=>(e&&function(e){const t={};try{e.exception.values.forEach((e=>{e.stacktrace.frames.forEach((e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)}))}))}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];const n=e.debug_meta.images;Object.keys(t).forEach((e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})}))}(e),"number"==typeof a&&a>0?function(e,t,n){if(!e)return null;const r={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((e=>({...e,...e.data&&{data:qe(e.data,t,n)}})))},...e.user&&{user:qe(e.user,t,n)},...e.contexts&&{contexts:qe(e.contexts,t,n)},...e.extra&&{extra:qe(e.extra,t,n)}};e.contexts&&e.contexts.trace&&r.contexts&&(r.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(r.contexts.trace.data=qe(e.contexts.trace.data,t,n)));e.spans&&(r.spans=e.spans.map((e=>({...e,...e.data&&{data:qe(e.data,t,n)}}))));return r}(e,a,s):e)))}const zn=new WeakMap;function Yn(e){if(e)return function(e){return e instanceof Ct||"function"==typeof e}(e)||function(e){return Object.keys(e).some((e=>Jn.includes(e)))}(e)?{captureContext:e}:e}const Jn=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function Wn(e,t){return At().captureEvent(e,t)}const Kn=j;let Xn=0;function Zn(){return Xn>0}function Qn(e,t={},n){if("function"!=typeof e)return e;try{const t=e.__sentry_wrapped__;if(t)return t;if(Te(e))return e}catch(t){return e}const r=function(){const r=Array.prototype.slice.call(arguments);try{n&&"function"==typeof n&&n.apply(this,arguments);const o=r.map((e=>Qn(e,t)));return e.apply(this,o)}catch(e){throw Xn++,setTimeout((()=>{Xn--})),function(...e){const t=Rt(bt());if(2===e.length){const[n,r]=e;return n?t.withSetScope(n,r):t.withScope(r)}t.withScope(e[0])}((n=>{var o,i;n.addEventProcessor((e=>(t.mechanism&&(ct(e,void 0,void 0),ut(e,t.mechanism)),e.extra={...e.extra,arguments:r},e))),o=e,At().captureException(o,Yn(i))})),e}};try{for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}catch(e){}Pe(r,e),Oe(e,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return e.name}})}catch(e){}return r}const er=1024,tr=(e={})=>{const t={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...e};return{name:"Breadcrumbs",setup(e){var n;t.console&&function(e){const t="console";Wt(t,e),Kt(t,dn)}(function(e){return function(t){if($t()!==e)return;const n={category:"console",data:{arguments:t.args,logger:"console"},level:bn(t.level),message:xe(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;n.message=`Assertion failed: ${xe(t.args.slice(1)," ")||"console.assert"}`,n.data.arguments=t.args.slice(1)}fn(n,{input:t.args,level:t.level})}}(e)),t.dom&&(n=function(e,t){return function(n){if($t()!==e)return;let r,o,i="object"==typeof t?t.serializeAttribute:void 0,a="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;a&&a>er&&(gn&&U.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${a} was configured. Sentry will use 1024 instead.`),a=er),"string"==typeof i&&(i=[i]);try{const e=n.event,t=function(e){return!!e&&!!e.target}(e)?e.target:e;r=ge(t,{keyAttrs:i,maxStringLength:a}),o=function(e){if(!be.HTMLElement)return null;let t=e;for(let e=0;e<5;e++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(t)}catch(e){r="<unknown>"}if(0===r.length)return;const s={category:`ui.${n.name}`,message:r};o&&(s.data={"ui.component_name":o}),fn(s,{event:n.event,name:n.name,global:n.global})}}(e,t.dom),Wt("dom",n),Kt("dom",nn)),t.xhr&&function(e){Wt("xhr",e),Kt("xhr",an)}(function(e){return function(t){if($t()!==e)return;const{startTimestamp:n,endTimestamp:r}=t,o=t.xhr[on];if(!n||!r||!o)return;const{method:i,url:a,status_code:s,body:c}=o;fn({category:"xhr",data:{method:i,url:a,status_code:s},type:"http"},{xhr:t.xhr,input:c,startTimestamp:n,endTimestamp:r})}}(e)),t.fetch&&function(e){const t="fetch";Wt(t,e),Kt(t,pn)}(function(e){return function(t){if($t()!==e)return;const{startTimestamp:n,endTimestamp:r}=t;if(r&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.error){fn({category:"fetch",data:t.fetchData,level:"error",type:"http"},{data:t.error,input:t.args,startTimestamp:n,endTimestamp:r})}else{const e=t.response;fn({category:"fetch",data:{...t.fetchData,status_code:e&&e.status},type:"http"},{input:t.args,response:e,startTimestamp:n,endTimestamp:r})}}}(e)),t.history&&function(e){const t="history";Wt(t,e),Kt(t,un)}(function(e){return function(t){if($t()!==e)return;let n=t.from,r=t.to;const o=mn(Kn.location.href);let i=n?mn(n):void 0;const a=mn(r);i&&i.path||(i=o),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),o.protocol===i.protocol&&o.host===i.host&&(n=i.relative),fn({category:"navigation",data:{from:n,to:r}})}}(e)),t.sentry&&e.on("beforeSendEvent",function(e){return function(t){$t()===e&&fn({category:"sentry."+("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:st(t)},{event:t})}}(e))}}};const nr=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],rr=(e={})=>{const t={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...e};return{name:"BrowserApiErrors",setupOnce(){t.setTimeout&&ke(Kn,"setTimeout",or),t.setInterval&&ke(Kn,"setInterval",or),t.requestAnimationFrame&&ke(Kn,"requestAnimationFrame",ir),t.XMLHttpRequest&&"XMLHttpRequest"in Kn&&ke(XMLHttpRequest.prototype,"send",ar);const e=t.eventTarget;if(e){(Array.isArray(e)?e:nr).forEach(sr)}}}};function or(e){return function(...t){const n=t[0];return t[0]=Qn(n,{mechanism:{data:{function:Ge(e)},handled:!1,type:"instrument"}}),e.apply(this,t)}}function ir(e){return function(t){return e.apply(this,[Qn(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ge(e)},handled:!1,type:"instrument"}})])}}function ar(e){return function(...t){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((e=>{e in n&&"function"==typeof n[e]&&ke(n,e,(function(t){const n={mechanism:{data:{function:e,handler:Ge(t)},handled:!1,type:"instrument"}},r=Te(t);return r&&(n.mechanism.data.handler=Ge(r)),Qn(t,n)}))})),e.apply(this,t)}}function sr(e){const t=Kn,n=t[e]&&t[e].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ke(n,"addEventListener",(function(t){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=Qn(r.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ge(r),target:e},handled:!1,type:"instrument"}}))}catch(e){}return t.apply(this,[n,Qn(r,{mechanism:{data:{function:"addEventListener",handler:Ge(r),target:e},handled:!1,type:"instrument"}}),o])}})),ke(n,"removeEventListener",(function(e){return function(t,n,r){const o=n;try{const n=o&&o.__sentry_wrapped__;n&&e.call(this,t,n,r)}catch(e){}return e.call(this,t,o,r)}})))}let cr=null;function ur(){cr=j.onerror,j.onerror=function(e,t,n,r,o){return Xt("error",{column:r,error:o,line:n,msg:e,url:t}),!(!cr||cr.__SENTRY_LOADER__)&&cr.apply(this,arguments)},j.onerror.__SENTRY_INSTRUMENTED__=!0}let lr=null;function fr(){lr=j.onunhandledrejection,j.onunhandledrejection=function(e){return Xt("unhandledrejection",e),!(lr&&!lr.__SENTRY_LOADER__)||lr.apply(this,arguments)},j.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function dr(e,t){const n=vr(e,t),r={type:t&&t.name,value:br(t)};return n.length&&(r.stacktrace={frames:n}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function pr(e,t,n,r){const o=$t(),i=o&&o.getOptions().normalizeDepth,a=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){const n=e[t];if(n instanceof Error)return n}return}(t),s={__serialized__:He(t,i)};if(a)return{exception:{values:[dr(e,a)]},extra:s};const c={exception:{values:[{type:oe(t)?t.constructor.name:r?"UnhandledRejection":"Error",value:wr(t,{isUnhandledRejection:r})}]},extra:s};if(n){const t=vr(e,n);t.length&&(c.exception.values[0].stacktrace={frames:t})}return c}function hr(e,t){return{exception:{values:[dr(e,t)]}}}function vr(e,t){const n=t.stacktrace||t.stack||"",r=function(e){if(e&&yr.test(e.message))return 1;return 0}(t),o=function(e){if("number"==typeof e.framesToPop)return e.framesToPop;return 0}(t);try{return e(n,r,o)}catch(e){}return[]}const yr=/Minified React error #\d+;/i;function br(e){const t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function mr(e,t,n,r,o){let i;if(Z(t)&&t.error){return hr(e,t.error)}if(Q(t)||X(t,"DOMException")){const o=t;if("stack"in t)i=hr(e,t);else{const t=o.name||(Q(o)?"DOMError":"DOMException"),a=o.message?`${t}: ${o.message}`:t;i=gr(e,a,n,r),ct(i,a)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}if(K(t))return hr(e,t);if(re(t)||oe(t)){return i=pr(e,t,n,o),ut(i,{synthetic:!0}),i}return i=gr(e,t,n,r),ct(i,`${t}`,void 0),ut(i,{synthetic:!0}),i}function gr(e,t,n,r){const o={};if(r&&n){const r=vr(e,n);r.length&&(o.exception={values:[{value:t,stacktrace:{frames:r}}]})}if(te(t)){const{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}function wr(e,{isUnhandledRejection:t}){const n=function(e,t=40){const n=Object.keys(Ce(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return _e(n[0],t);for(let e=n.length;e>0;e--){const r=n.slice(0,e).join(", ");if(!(r.length>t))return e===n.length?r:_e(r,t)}return""}(e),r=t?"promise rejection":"exception";if(Z(e))return`Event \`ErrorEvent\` captured as ${r} with message \`${e.message}\``;if(oe(e)){return`Event \`${function(e){try{const t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(e){}}(e)}\` (type=${e.type}) captured as ${r}`}return`Object captured as ${r} with keys: ${n}`}const _r=(e={})=>{const t={onerror:!0,onunhandledrejection:!0,...e};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(e){t.onerror&&(!function(e){!function(e){const t="error";Wt(t,e),Kt(t,ur)}((t=>{const{stackParser:n,attachStacktrace:r}=Sr();if($t()!==e||Zn())return;const{msg:o,url:i,line:a,column:s,error:c}=t,u=function(e,t,n,r){const o=e.exception=e.exception||{},i=o.values=o.values||[],a=i[0]=i[0]||{},s=a.stacktrace=a.stacktrace||{},c=s.frames=s.frames||[],u=isNaN(parseInt(r,10))?void 0:r,l=isNaN(parseInt(n,10))?void 0:n,f=ee(t)&&t.length>0?t:function(){try{return be.document.location.href}catch(e){return""}}();0===c.length&&c.push({colno:u,filename:f,function:Re,in_app:!0,lineno:l});return e}(mr(n,c||o,void 0,r,!1),i,a,s);u.level="error",Wn(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})}))}(e),xr("onerror")),t.onunhandledrejection&&(!function(e){!function(e){const t="unhandledrejection";Wt(t,e),Kt(t,fr)}((t=>{const{stackParser:n,attachStacktrace:r}=Sr();if($t()!==e||Zn())return;const o=function(e){if(ne(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch(e){}return e}(t),i=ne(o)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(o)}`}]}}:mr(n,o,void 0,r,!0);i.level="error",Wn(i,{originalException:o,mechanism:{handled:!1,type:"onunhandledrejection"}})}))}(e),xr("onunhandledrejection"))}}};function xr(e){gn&&U.log(`Global Handler attached: ${e}`)}function Sr(){const e=$t();return e&&e.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Er=()=>({name:"HttpContext",preprocessEvent(e){if(!Kn.navigator&&!Kn.location&&!Kn.document)return;const t=e.request&&e.request.url||Kn.location&&Kn.location.href,{referrer:n}=Kn.document||{},{userAgent:r}=Kn.navigator||{},o={...e.request&&e.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},i={...e.request,...t&&{url:t},headers:o};e.request=i}});function kr(e,t,n=250,r,o,i,a){if(!(i.exception&&i.exception.values&&a&&ae(a.originalException,Error)))return;const s=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;var c,u;s&&(i.exception.values=(c=Or(e,t,o,a.originalException,r,i.exception.values,s,0),u=n,c.map((e=>(e.value&&(e.value=_e(e.value,u)),e)))))}function Or(e,t,n,r,o,i,a,s){if(i.length>=n+1)return i;let c=[...i];if(ae(r[o],Error)){Pr(a,s);const i=e(t,r[o]),u=c.length;Tr(i,o,u,s),c=Or(e,t,n,r[o],o,[i,...c],i,u)}return Array.isArray(r.errors)&&r.errors.forEach(((r,i)=>{if(ae(r,Error)){Pr(a,s);const u=e(t,r),l=c.length;Tr(u,`errors[${i}]`,l,s),c=Or(e,t,n,r,o,[u,...c],u,l)}})),c}function Pr(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function Tr(e,t,n,r){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:r}}const Cr=(e={})=>{const t=e.limit||5,n=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,r,o){const i=o.getOptions();kr(dr,i.stackParser,i.maxValueLength,n,t,e,r)}}};function Ir(e){return[vt(),qt(),rr(),tr(),_r(),Cr(),Ht(),Er()]}const Dr="7";function Nr(e){const t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}function Lr(e,t){return n={sentry_key:e.publicKey,sentry_version:Dr,...t&&{sentry_client:`${t.name}/${t.version}`}},Object.keys(n).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(n[e])}`)).join("&");var n}function jr(e,t,n){return t||`${function(e){return`${Nr(e)}${e.projectId}/envelope/`}(e)}?${Lr(e,n)}`}function Rr(e,t,n,r){const o=Ze(n),i=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,n&&n.sdk);const a=function(e,t,n,r){const o=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&{sdk:t},...!!n&&r&&{dsn:he(r)},...o&&{trace:Ne({...o})}}}(e,o,r,t);delete e.sdkProcessingMetadata;return Ve(a,[[{type:i},e]])}const Ar="Not capturing exception because it's already been captured.";class Mr{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=ye(e.dsn):tt&&U.warn("No DSN provided, client will not send events."),this._dsn){const t=jr(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){const r=it();if(lt(e))return tt&&U.log(Ar),r;const o={event_id:r,...t};return this._process(this.eventFromException(e,o).then((e=>this._captureEvent(e,o,n)))),o.event_id}captureMessage(e,t,n,r){const o={event_id:it(),...n},i=te(e)?e:String(e),a=ne(e)?this.eventFromMessage(i,t,o):this.eventFromException(e,o);return this._process(a.then((e=>this._captureEvent(e,o,r)))),o.event_id}captureEvent(e,t,n){const r=it();if(t&&t.originalException&&lt(t.originalException))return tt&&U.log(Ar),r;const o={event_id:r,...t},i=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,o,i||n)),o.event_id}captureSession(e){"string"!=typeof e.release?tt&&U.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Et(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then((n=>t.flush(e).then((e=>n&&e))))):ue(!0)}close(e){return this.flush(e).then((e=>(this.getOptions().enabled=!1,this.emit("close"),e)))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];pt(this,e,this._integrations),t||dt(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=Rr(e,this._dsn,this._options._metadata,this._options.tunnel);for(const e of t.attachments||[])n=Be(n,We(e));const r=this.sendEnvelope(n);r&&r.then((t=>this.emit("afterSendEvent",e,t)),null)}sendSession(e){const t=function(e,t,n,r){const o=Ze(n);return Ve({sent_at:(new Date).toISOString(),...o&&{sdk:o},...!!r&&t&&{dsn:he(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const n=`${e}:${t}`;tt&&U.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach((e=>e(...t)))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,(e=>(tt&&U.error("Error while sending event:",e),e))):(tt&&U.error("Transport disabled"),ue({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(e,t){const n={};return t.forEach((t=>{t&&pt(e,t,n)})),n}(this,e),dt(this,e)}_updateSessionFromEvent(e,t){let n=!1,r=!1;const o=t.exception&&t.exception.values;if(o){r=!0;for(const e of o){const t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}}const i="ok"===e.status;(i&&0===e.errors||i&&n)&&(Et(e,{...n&&{status:"crashed"},errors:e.errors||Number(r||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new fe((t=>{let n=0;const r=setInterval((()=>{0==this._numProcessing?(clearInterval(r),t(!0)):(n+=1,e&&n>=e&&(clearInterval(r),t(!1)))}),1)}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,r=Mt()){const o=this.getOptions(),i=Object.keys(this._integrations);return!t.integrations&&i.length>0&&(t.integrations=i),this.emit("preprocessEvent",e,t),e.type||r.setLastEventId(e.event_id||t.event_id),Bn(o,e,t,n,this,r).then((e=>{if(null===e)return e;const t={...r.getPropagationContext(),...n?n.getPropagationContext():void 0};if(!(e.contexts&&e.contexts.trace)&&t){const{traceId:n,spanId:r,parentSpanId:o,dsc:i}=t;e.contexts={trace:Ne({trace_id:n,span_id:r,parent_span_id:o}),...e.contexts};const a=i||Gn(n,this);e.sdkProcessingMetadata={dynamicSamplingContext:a,...e.sdkProcessingMetadata}}return e}))}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then((e=>e.event_id),(e=>{if(tt){const t=e;"log"===t.logLevel?U.log(t.message):U.warn(t)}}))}_processEvent(e,t,n){const r=this.getOptions(),{sampleRate:o}=r,i=Ur(e),a=$r(e),s=e.type||"error",c=`before send for type \`${s}\``,u=void 0===o?void 0:function(e){if("boolean"==typeof e)return Number(e);const t="string"==typeof e?parseFloat(e):e;if(!("number"!=typeof t||isNaN(t)||t<0||t>1))return t;tt&&U.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(e)} of type ${JSON.stringify(typeof e)}.`)}(o);if(a&&"number"==typeof u&&Math.random()>u)return this.recordDroppedEvent("sample_rate","error",e),le(new J(`Discarding event because it's not included in the random sample (sampling rate = ${o})`,"log"));const l="replay_event"===s?"replay":s,f=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,f).then((n=>{if(null===n)throw this.recordDroppedEvent("event_processor",l,e),new J("An event processor returned `null`, will not send event.","log");if(t.data&&!0===t.data.__sentry__)return n;const o=function(e,t,n){const{beforeSend:r,beforeSendTransaction:o,beforeSendSpan:i}=e;if($r(t)&&r)return r(t,n);if(Ur(t)){if(t.spans&&i){const e=[];for(const n of t.spans){const t=i(n);t&&e.push(t)}t.spans=e}if(o)return o(t,n)}return t}(r,n,t);return function(e,t){const n=`${t} must return \`null\` or a valid event.`;if(ie(e))return e.then((e=>{if(!re(e)&&null!==e)throw new J(n);return e}),(e=>{throw new J(`${t} rejected with ${e}`)}));if(!re(e)&&null!==e)throw new J(n);return e}(o,c)})).then((r=>{if(null===r)throw this.recordDroppedEvent("before_send",l,e),new J(`${c} returned \`null\`, will not send event.`,"log");const o=n&&n.getSession();!i&&o&&this._updateSessionFromEvent(o,r);const a=r.transaction_info;if(i&&a&&r.transaction!==e.transaction){const e="custom";r.transaction_info={...a,source:e}}return this.sendEvent(r,t),r})).then(null,(e=>{if(e instanceof J)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new J(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${e}`)}))}_process(e){this._numProcessing++,e.then((e=>(this._numProcessing--,e)),(e=>(this._numProcessing--,e)))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map((t=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e[t]}}))}}function $r(e){return void 0===e.type}function Ur(e){return"transaction"===e.type}class Gr extends Mr{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};!function(e,t,n=[t],r="npm"){const o=e._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${t}`,packages:n.map((e=>({name:`${r}:@sentry/${e}`,version:L}))),version:L}),e._metadata=o}(t,"browser",["browser"],Kn.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&Kn.document&&Kn.document.addEventListener("visibilitychange",(()=>{"hidden"===Kn.document.visibilityState&&this._flushOutcomes()}))}eventFromException(e,t){return function(e,t,n,r){const o=mr(e,t,n&&n.syntheticException||void 0,r);return ut(o),o.level="error",n&&n.event_id&&(o.event_id=n.event_id),ue(o)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(e,t,n="info",r,o){const i=gr(e,t,r&&r.syntheticException||void 0,o);return i.level=n,r&&r.event_id&&(i.event_id=r.event_id),ue(i)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(gn&&U.warn("SDK not enabled, will not capture user feedback."));const t=function(e,{metadata:t,tunnel:n,dsn:r}){const o={event_id:e.event_id,sent_at:(new Date).toISOString(),...t&&t.sdk&&{sdk:{name:t.sdk.name,version:t.sdk.version}},...!!n&&!!r&&{dsn:he(r)}},i=function(e){return[{type:"user_report"},e]}(e);return Ve(o,[i])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}_flushOutcomes(){const e=this._clearOutcomes();if(0===e.length)return void(gn&&U.log("No outcomes to send"));if(!this._dsn)return void(gn&&U.log("No dsn provided, will not send outcomes"));gn&&U.log("Sending outcomes:",e);const t=(n=e,Ve((r=this._options.tunnel&&he(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:o||_t(),discarded_events:n}]]));var n,r,o;this.sendEnvelope(t)}}function qr(e,t,n,r){const o={filename:e,function:"<anonymous>"===t?Re:t,in_app:!0};return void 0!==n&&(o.lineno=n),void 0!==r&&(o.colno=r),o}const Hr=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Fr=/\((\S*)(?::(\d+))(?::(\d+))\)/,Vr=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Br=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,zr=$e(...[[30,e=>{const t=Hr.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){const e=Fr.exec(t[2]);e&&(t[2]=e[1],t[3]=e[2],t[4]=e[3])}const[e,n]=Yr(t[1]||Re,t[2]);return qr(n,e,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,e=>{const t=Vr.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){const e=Br.exec(t[3]);e&&(t[1]=t[1]||"eval",t[3]=e[1],t[4]=e[2],t[5]="")}let e=t[3],n=t[1]||Re;return[n,e]=Yr(n,e),qr(e,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]]),Yr=(e,t)=>{const n=-1!==e.indexOf("safari-extension"),r=-1!==e.indexOf("safari-web-extension");return n||r?[-1!==e.indexOf("@")?e.split("@")[0]:Re,n?`safari-extension:${t}`:`safari-web-extension:${t}`]:[e,t]};var Jr=n(429),Wr=function(e,t){Object.keys(e).forEach((function(n){t(n,e[n])}))},Kr=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xr=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Zr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Qr=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},eo={},to={},no=function(e,t,n,r,o){var i,a;void 0===r&&(r=[]),void 0===o&&(o=[]);var s=n.join("${}"),c=null===(a=null===(i=eo.contexts)||void 0===i?void 0:i[e])||void 0===a?void 0:a[s];if(c){var u=c.key,l=c.value,f=to[u]||(to[u]=function(e){var t=[];return e.replace(/\$\{[^}]+}/g,(function(e){return t.push(e.substring(2,e.length-1).trim()),""})),t}(u)),d=t(l);if(d)return d.replace(/\$\{[^}]+}/g,(function(e){var t=f.indexOf(e.substring(2,e.length-1).trim());return void 0!==r[t]?r[t]:""}))}return t&&t(Qr([void 0],Zr(o),!1))||n.reduce((function(e,t,n){return e+t+(void 0!==r[n]?r[n]:"")}),"")},ro=function(e,t){Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t})},oo=void 0,io=function(){function e(e){Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:e})}return Object.defineProperty(e.prototype,"t",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return no(this.context,(function(e){return Zr(e,1)[0]}),e,t)}}),Object.defineProperty(e.prototype,"plural",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return no(this.context,(function(t){return oo?oo(e,t):t[1===Math.abs(e)?0:1]}),t.template,t.args,n)}}),e}(),ao=function(e){return new io(e)},so={},co=/\splural ?=?([\s\S]*);?/,uo=function(e,t){var n={};Wr(t.contexts||{},(function(e,t){var r={};Wr(t,(function(e,t){r[e.replace(/\$\{[^}]+}/g,"${}")]={key:e,value:t}})),n[e]=r})),eo={headers:t.headers||{},contexts:n};var r,o=t.headers;oo=(0,Jr.getPluralFunc)((null==o?void 0:o.language)||e)||(r=function(e){var t,n=(null==e?void 0:e["plural-forms"])||"nplurals=2; plural=(n != 1);",r=null===(t=co.exec(n))||void 0===t?void 0:t[1];return r&&";"===r[r.length-1]&&(r=r.slice(0,-1)),r||"plural=(n != 1)"}(o),so[r]||(so[r]=new Function("n","args",function(e){return"return args[+ (".concat(e,")];")}(r))))},lo=function(e){return Kr(void 0,void 0,void 0,(function(){var t,n;return Xr(this,(function(r){switch(r.label){case 0:switch(e){case"es_419":case"es_AR":case"es_CL":case"es_DO":case"es_MX":e="es_LA"}return t=uo,n=[e],[4,fetch("/locales/"+e+".json")];case 1:return[4,r.sent().json()];case 2:return t.apply(void 0,n.concat([r.sent()])),[2]}}))}))},fo=function(){return navigator.language||navigator.userLanguage},po=function(e){return{be:"be_BY",ca:"ca_ES",cs:"cs_CZ",el:"el_GR",en:"en_US",hi:"hi_IN",ja:"ja_JP",ka:"ka_GE",ko:"ko_KR",nb:"nb_NO",nn:"nb_NO",no:"nb_NO",pt:"pt_BR",sl:"sl_SI",sv:"sv_SE",uk:"uk_UA",vi:"vi_VN"}[e]||e+"_"+e.toUpperCase()},ho=function(){var e=fo();if("string"!=typeof e||!e)return"en_US";var t=e.replace("-","_");return-1!==t.indexOf("_")?t:po(t)},vo=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\//g,"&#47;")},yo=function(e){return Object.keys(e)},bo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},mo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},go=[],wo=function(e,t){var n,r,o=void 0;(n={})[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(void 0,mo([],bo(e),!1)),null==o||o()},r=n,go.push(r),o=function(){go.splice(go.indexOf(r),1)}};chrome.runtime.onMessage.addListener((function(e){return go.forEach((function(t){var n=e.type,r=n?t[n]:void 0;"function"!=typeof r?t.error&&e.error&&t.error(e.error):r(e.data)})),!1}));var _o=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xo=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},So=n.g||window;So.browser||(So.browser=chrome);var Eo,ko,Oo,Po,To,Co=function(e,t){return void 0===t&&(t=void 0),new Promise((function(n,r){return _o(void 0,void 0,void 0,(function(){var o,i,a,s;return xo(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),o=function(e){var t;if(e){var o=null==e?void 0:e.result,i=null==o?void 0:o.error;if(!i||i.Warning){var a=null===(t=null===browser||void 0===browser?void 0:browser.runtime)||void 0===t?void 0:t.lastError;a?r(a.message?new Error(a.message):a):n(o)}else r(i)}},i=function(){try{var n=Date.now()+":"+Math.random(),r=browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"broadcast",requestId:n},void 0,o);return wo("answer:"+n,o),r}catch(n){return browser.runtime.sendMessage(browser.runtime.id,{type:e,data:t,respondTo:"promise"})}}(),i instanceof Promise?(a=o,[4,i]):[3,2];case 1:a.apply(void 0,[c.sent()]),c.label=2;case 2:return[3,4];case 3:return s=c.sent(),r(s),[3,4];case 4:return[2]}}))}))}))},Io=function(e,t){return void 0===t&&(t=void 0),Co(e,t)};!function(e){e.SIGN_OUT="signOut",e.SWITCH_ACCOUNT="switchAccount",e.DISCONNECT="disconnect",e.CONNECT="connect",e.CONNECTING="connecting"}(Eo||(Eo={})),function(e){e.BYPASS_LIST="bypassList"}(ko||(ko={})),function(e){e.PROXY="proxy"}(Oo||(Oo={})),function(e){e.FORK="fork",e.FORGET_ERROR="forgetError",e.LOG="log"}(Po||(Po={})),function(e){e.USER="user",e.PM_USER="pmUser",e.STATE="state"}(To||(To={}));var Do=function(){return"undefined"==typeof window||-1!==window.location.href.indexOf("_generated_background_page.html")},No=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Lo=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},jo=[],Ro=!1,Ao=D.item("logs");Ao.get().then((function(e){(null==e?void 0:e.value)&&(jo.push.apply(jo,Lo([],No(e.value),!1)),Ao.setValue(jo),Ro=!0)})),n.g.getLogs=function(){return jo.slice()};var Mo,$o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(Do())return jo.unshift(Lo([Date.now()],No(e),!1)),jo.splice(100,1e3),void(Ro&&Ao.setValue(jo));ui(Io(Po.LOG,Lo([],No(e),!1)))},Uo=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Go=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},qo=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(void 0===n.g.debugEnabled||n.g.debugEnabled)&&(console[e].apply(console,t),$o(Go([e],Uo(t),!1)))}},Ho=(qo("log"),qo("warn")),Fo=qo("error"),Vo=qo("info"),Bo=qo("debug"),zo=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};function Yo(e,t){void 0===t&&(t=!1);var n=e.Error||e.message||e;if(n instanceof Error)return n.message;if("string"==typeof n)return n;Ho(n);var r="".concat(e).replace(/^TypeError:\s+/,"");if(/\[object/.test(r)){Ho(n);var o=yo(n);return t&&0!==o.length&&"_id"!==o.join(",")?"<pre>"+vo(JSON.stringify(n,null,2))+"</pre>":ao("Error").t(Mo||(Mo=zo(["Something went wrong. If the problem persists, please try to re-install the extension"],["Something went wrong. If the problem persists, please try to re-install the extension"])))}return r}var Jo,Wo,Ko={fromSeconds:function(e,t){return(t||0)+1e3*e},fromMinutes:function(e,t){return e*this.fromSeconds(60,t)},fromHours:function(e,t){return e*this.fromMinutes(60,t)},fromDays:function(e,t){return e*this.fromHours(24,t)},toSeconds:function(e){return e/1e3},toMinutes:function(e){return this.toSeconds(e)/60},toHours:function(e){return this.toMinutes(e)/60},toDays:function(e){return this.toHours(e)/24},diffInMilliSeconds:function(e,t){return(t||Date.now())-(e||0)},diffInSeconds:function(e){return this.toSeconds(this.diffInMilliSeconds(e))},diffInMinutes:function(e){return this.toMinutes(this.diffInMilliSeconds(e))},diffInHours:function(e){return this.toHours(this.diffInMilliSeconds(e))},diffInDays:function(e){return this.toDays(this.diffInMilliSeconds(e))}},Xo=function(){return Xo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xo.apply(this,arguments)},Zo=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Qo=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ei=D.item("crash-reports-disabled"),ti=function(e){var t=e.toString();return t.includes("/envelope/")?{"content-type":"application/x-sentry-envelope"}:t.includes("/store/")?{"content-type":"application/json"}:{}},ni=function(e,t){return globalThis.fetch(e,Xo(Xo({},t),{headers:Xo(Xo(Xo({},null==t?void 0:t.headers),ti(e)),{"x-pm-uid":""})}))},ri=function(e){return function(e,t=z("fetch")){let n=0,r=0;return rt(e,(function(o){const i=o.body.length;n+=i,r++;const a={body:o.body,method:"POST",referrerPolicy:"origin",headers:e.headers,keepalive:n<=6e4&&r<15,...e.fetchOptions};if(!t)return Y("fetch"),le("No fetch implementation available");try{return t(e.url,a).then((e=>(n-=i,r--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}})))}catch(e){return Y("fetch"),n-=i,r--,le(e)}}))}(e,ni)},oi={},ii=function(e){if(e){switch("Code"in e?e.Code:void 0){case 86110:case 86111:case 86112:case 86113:case 86114:case 86115:case 86300:return}var t=Yo(e);if(!/Url already open/.test(t)){var n=Date.now();n-((null==oi?void 0:oi[t])||0)<Ko.fromMinutes(5)||(oi[t]=n,si().captureException(function(e,t){if(e instanceof Error)return e;var n=new Error(t);return n.previous=e,n}(e,t)))}}},ai=void 0,si=function(){if(ai)return ai;var e=[],t=Ir().filter((function(e){return!["BrowserApiErrors","TryCatch","Breadcrumbs","GlobalHandlers"].includes(e.name)})),n=new Gr({dsn:d,release:i,environment:/\.proton.me$/.test(l)?"prod":"test",normalizeDepth:5,transport:ri,stackParser:zr,autoSessionTracking:!1,integrations:t,sendClientReports:!1,beforeSend:function(t){return Zo(this,void 0,void 0,(function(){var n,r;return Qo(this,(function(o){switch(o.label){case 0:return[4,Zo(void 0,void 0,void 0,(function(){return Qo(this,(function(e){switch(e.label){case 0:return[4,Zo(void 0,void 0,void 0,(function(){var e;return Qo(this,(function(t){switch(t.label){case 0:return[4,ei.getDefined({value:!1})];case 1:return(e=t.sent()).value=!e.value,[2,e]}}))}))];case 1:return[2,e.sent().value]}}))}))];case 1:return o.sent()?(n=Date.now(),r=n-6e5,(e=e.filter((function(e){return e>=r}))).length>5?[2,null]:(e.push(n),[2,t])):[2,null]}}))}))}});return(ai=new Ct).setClient(n),n.init(),ai},ci=function(e){try{return e()}catch(e){throw ii(e),e}},ui=function(e){"function"==typeof(null==e?void 0:e.then)&&e.then((function(){}),ii)},li=function(e){"function"==typeof(null==e?void 0:e.catch)&&e.catch((function(){}))},fi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},di=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},pi=D.item("session",C),hi=D.item("session"),vi=function(){return fi(void 0,void 0,void 0,(function(){var e,t;return di(this,(function(n){switch(n.label){case 0:return[4,pi.load()];case 1:return(e=n.sent())&&yo(e).length?[2,e]:[4,hi.load()];case 2:return(t=n.sent())&&ui(pi.set(t)),[2,t]}}))}))},yi=D.selfItem("credentials",C),bi=function(){return yi.remove()},mi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},gi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},wi=function(e){return mi(void 0,void 0,void 0,(function(){var t,n,r;return gi(this,(function(o){switch(o.label){case 0:return[4,vi()];case 1:return t=null===(r=o.sent())||void 0===r?void 0:r.uid,n=(null==e?void 0:e.uid)||t,ui(e.persistent?hi.set(e):hi.remove()),[4,pi.set(e)];case 2:return o.sent(),n===t?[3,4]:[4,bi()];case 3:o.sent(),o.label=4;case 4:return[2]}}))}))},_i=function(e,t){void 0===t&&(t=!0),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"logout",{enumerable:!0,configurable:!0,writable:!0,value:t}),this.message||(this.message="Missing refresh token")},xi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Si=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ei=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ki=!1,Oi=[],Pi=function(e){return xi(void 0,void 0,void 0,(function(){var t,n,r;return Si(this,(function(o){switch(o.label){case 0:return e?[3,2]:[4,vi()];case 1:e=o.sent(),o.label=2;case 2:if(!e.uid||!e.refreshToken)throw new _i;return ki?[4,new Promise((function(e,t){Oi.push([e,t])}))]:[3,4];case 3:return[2,o.sent()];case 4:return o.trys.push([4,8,12,13]),ki=!0,e.expiresAt=Date.now(),[4,wi(e)];case 5:return o.sent(),[4,Qi("auth/refresh",zi("POST",{UID:e.uid,ResponseType:"token",GrantType:"refresh_token",RefreshToken:e.refreshToken,RedirectURI:e.redirectURI||"https://protonvpn.com"},{"x-pm-uid":e.uid}))];case 6:return t=o.sent(),delete e.expiresAt,e.refreshToken=t.RefreshToken,e.accessToken=t.AccessToken,[4,wi(e)];case 7:return o.sent(),Oi.forEach((function(t){(0,Ei(t,1)[0])(e)})),Oi=[],[2,e];case 8:return n=o.sent(),[4,vi()];case 9:return(r=o.sent()).expiresAt&&r.accessToken===e.accessToken?(delete r.expiresAt,[4,wi(r)]):[3,11];case 10:o.sent(),o.label=11;case 11:if(10013===n.Code){Ho(n,(new Error).stack),n=new _i(Yo(n));try{ui(Io(Eo.SIGN_OUT))}catch(e){}Oi.forEach((function(e){(0,Ei(e,2)[1])(n)})),Oi=[]}throw n;case 12:return ki=!1,[7];case 13:return[2]}}))}))},Ti=function(e){for(var t=0,n=1,r=3;r>=0;r--)t+=n*Number(e[r]),n*=256;return t},Ci=function(e,t){var n=t.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)\/(\d+)$/);if(!n)return!1;var r=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)(:\d+)?$/);return!!r&&function(e,t){var n=Math.pow(2,32-Number(t[5])),r=Ti(t.slice(1,5)),o=Ti(e.slice(1,5));return o>=r&&o<r+n}(r,n)},Ii=function(e,t){void 0===t&&(t=void 0),Co(e,t).catch((function(e){-1==="".concat((null==e?void 0:e.message)||e).indexOf("Receiving end does not exist.")&&Fo(e)}))},Di=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ni=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Li=void 0,ji=D.item("upgrade-error",e.LOCAL,"error"),Ri=function(e){Li={version:i,time:Date.now(),error:e},li(e?ji.set(Li):ji.remove())},Ai=function(){return Di(void 0,void 0,void 0,(function(){return Ni(this,(function(e){switch(e.label){case 0:return Li?[3,2]:[4,ji.get()];case 1:(Li=e.sent())||Ri(void 0),e.label=2;case 2:return Li?Li.version!==i||Date.now()-Li.time>Ko.fromHours(2)?(Ri(void 0),[2,void 0]):[2,Li.error]:[2,void 0]}}))}))},Mi=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},$i=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Ui=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t&&(e+=Math.round(t*(2*Math.random()-1))),setTimeout.apply(void 0,$i([n,e],Mi(r),!1))},Gi=function(e,t){return void 0===t&&(t=0),new Promise((function(n){Ui(e,t,n)}))},qi=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=void 0,a=function(){i=Ui(e,t,(function(){n.apply(void 0,$i([],Mi(r),!1)),a()}))};return a(),{clear:function(){clearTimeout(i)}}},Hi=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Fi=function(){return Fi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fi.apply(this,arguments)},Vi=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Bi=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},zi=function(e,t,n){return void 0===n&&(n={}),{method:e,headers:Fi({Accept:"application/json","Content-Type":"application/json"},n),body:JSON.stringify(t)}},Yi=function(){return"browser-vpn@"+i},Ji={},Wi=function(e,t,n,r,o){return Vi(void 0,void 0,void 0,(function(){var i,a,s,c,l,f,d,p,h,v,y,b;return Bi(this,(function(m){switch(m.label){case 0:if(i="".concat((null==t?void 0:t.method)||"GET"," ").concat(e),a=Ji[i]){if(a.time>=Date.now())return[2,a.response.clone()];delete Ji[i]}return(s=(null==t?void 0:t.headers)||{})["x-pm-uid"]?[3,5]:(l=r)?[3,2]:[4,vi()];case 1:l=m.sent(),m.label=2;case 2:return(c=l).expiresAt?[3,3]:(f=null==c?void 0:c.uid,d=null==c?void 0:c.accessToken,f&&d&&Object.assign(s,function(e,t){return{"x-pm-uid":e,Authorization:"Bearer ".concat(t)}}(f,d)),[3,5]);case 3:return!r&&(o||0)<Date.now()?[4,Gi(200)]:[3,5];case 4:return m.sent(),[2,Wi(e,t,n,r,o||Ko.fromSeconds(8,Date.now()))];case 5:return p=Fi(Fi({mode:"cors",credentials:"include",redirect:"follow",method:"GET"},t),{headers:Fi({"x-pm-appversion":Yi()},s)}),[4,fetch("".concat(n||u).concat(e),p)];case 6:return h=m.sent(),va(h)&&(v="".concat(h.headers.get("Retry-After")||"0"),y=Math.min(Date.now()+Ko.fromMinutes(30),/^\d+$/.test(v)?Date.now()+Ko.fromSeconds(Math.max(10,Number(v))):new Date(v).getTime()),((null===(b=Ji[i])||void 0===b?void 0:b.time)||0)<y&&(Ji[i]={time:y,response:h.clone()})),[2,h]}}))}))},Ki=function(e){return Vi(void 0,void 0,void 0,(function(){var t;return Bi(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.json()];case 1:return[2,n.sent()];case 2:throw t=n.sent(),Ho(e.status,t),new Error(ao("Error").t(ea||(ea=Hi(["Service temporarily unavailable"],["Service temporarily unavailable"]))));case 3:return[2]}}))}))},Xi=function(e,t){return Vi(void 0,void 0,void 0,(function(){var n;return Bi(this,(function(r){switch(r.label){case 0:return[4,Ki(e)];case 1:return n=r.sent(),[2,t?t(e,n):n]}}))}))},Zi=function(e){return Vi(void 0,void 0,void 0,(function(){return Bi(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,4]),[4,e.clone().json()];case 1:case 3:return[2,t.sent()];case 2:return t.sent(),[4,e.text()];case 4:return[2]}}))}))},Qi=function(e,t,n,r){return Vi(void 0,void 0,void 0,(function(){var o,i,a,s,c,u,l,f,d;return Bi(this,(function(p){switch(p.label){case 0:return[4,Ai()];case 1:if(o=p.sent())throw Ii("updateExtension",{error:o}),o;return[4,Wi(e,t,n)];case 2:return i=p.sent(),la(i)?[3,9]:[4,Zi(i)];case 3:if(a=p.sent(),(s=(null==a?void 0:a.Error)?a:new Error(a)).response=i,s&&"object"==typeof s&&(s.httpStatus=i.status),ha(a))throw Ii("updateExtension",{error:s}),Ri(a),s;return Ri(void 0),/\/?auth(\/.*)$/.test(e)||!pa(s)?[3,8]:[4,vi()];case 4:return c=p.sent(),u=c.uid,l=c.accessToken,[4,Pi(c)];case 5:return!(f=p.sent()).uid||!f.accessToken||f.uid===u&&f.accessToken===l?[3,7]:[4,Wi(e,t,n,f)];case 6:if(d=p.sent(),la(d))return[2,Xi(d,r)];p.label=7;case 7:Ho(s),p.label=8;case 8:throw s;case 9:return Ri(void 0),[2,Xi(i,r)]}}))}))};!function(e){e.UPGRADE="Upgrade"}(Jo||(Jo={})),function(e){e.MAIN_ACTION="main_action",e.SECONDARY_ACTION="secondary_action",e.LINK="link"}(Wo||(Wo={}));var ea,ta,na,ra,oa,ia,aa,sa,ca,ua,la=function(e){return e.status>=200&&e.status<300},fa=function(e,t){return"object"==typeof e&&(null==e?void 0:e.httpStatus)===t},da=function(e){return fa(e,401)},pa=function(e){return da(e)&&401===e.Code},ha=function(e){return"object"==typeof e&&5003===(null==e?void 0:e.Code)},va=function(e){return"object"==typeof e&&(429===(null==e?void 0:e.Code)||503===(null==e?void 0:e.Code))},ya=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ba=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ma=function(){return ya(void 0,void 0,void 0,(function(){var e,t,n;return ba(this,(function(r){switch(r.label){case 0:return[4,vi()];case 1:return(e=null===(t=r.sent())||void 0===t?void 0:t.accessToken)?[3,3]:[4,Pi()];case 2:e=null===(n=r.sent())||void 0===n?void 0:n.accessToken,r.label=3;case 3:return[2,e]}}))}))},ga=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},wa=function(e,t){var n=chrome.action||chrome.browserAction;n&&(ui(n.setIcon({path:browser.runtime.getURL("/img/"+e)})),"string"==typeof t&&ui(n.setTitle({title:t})))},_a={loggedOut:function(){return ao("Label").t(ta||(ta=ga(["Unprotected"],["Unprotected"])))},off:function(){return ao("Label").t(na||(na=ga(["Unprotected"],["Unprotected"])))},on:function(){return ao("Label").t(ra||(ra=ga(["Protected"],["Protected"])))},error:function(){return ao("Error").t(oa||(oa=ga(["Network error."],["Network error."])))},warning:function(){return ao("Error").t(ia||(ia=ga(["Network error."],["Network error."])))},connecting:function(){return ao("Label").t(aa||(aa=ga(["Connecting"],["Connecting"])))}},xa=void 0,Sa=function(e,t){xa&&clearTimeout(xa);var n=t||_a[e](),r=ao("Status").t(sa||(sa=ga(["Proton VPN: ",""],["Proton VPN: ",""])),n);wa("state-".concat({loggedOut:"not-logged-in",off:"unprotected-1",connecting:"unprotected-2",on:"protected"}[e]||e,".png"),r),"connecting"===e&&(xa=setTimeout((function(){wa("state-unprotected-1.png",r),xa=setTimeout((function(){Sa(e,t)}),700)}),700))},Ea=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},ka=function(e,t){var n,r;if(void 0===t&&(t=!1),function(e){return"object"==typeof e&&("NetworkError"===(null==e?void 0:e.name)||/^(NetworkError |(TypeError: )?Failed to fetch)/.test((null==e?void 0:e.message)||""))}(e)){Ho(e);var o=Zu();if(-1!==(null===(n=o.data.error)||void 0===n?void 0:n.Code)){Sa("warning"),o.data.error={httpStatus:-1,Code:-1,Warning:!0,Error:ao("Error").t(ca||(ca=Ea(["Network is unreachable"],["Network is unreachable"])))},null===(r=o.refreshState)||void 0===r||r.call(o);var i=o.data.server;Ii("changeState",{state:i?"connected":"disconnected",server:i,error:o.data.error})}if(t)throw e}ii(e)},Oa=function(e){if(!Do())throw new Error(e+" is background only")},Pa="active",Ta=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ca=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ia=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Da={},Na=!1,La=0,ja=void 0,Ra=function(e){void 0===e&&(e=!1),ja||(ja=setTimeout((function(){return Ca(void 0,void 0,void 0,(function(){var t,n,r;return Ia(this,(function(o){switch(o.label){case 0:if(clearTimeout(ja),ja=void 0,La=Date.now(),Na)return[2];Na=!0,o.label=1;case 1:return o.trys.push([1,4,5,6]),[4,$s()];case 2:if(!o.sent())throw new Error(ao("Error").t(ua||(ua=Ta(["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"],["Unable to reach the server, please try to reconnect, or to log out and log in again if the problem persists"]))));return[4,null===(r=null===(n=Zu())||void 0===n?void 0:n.connectCurrentServer)||void 0===r?void 0:r.call(n)];case 3:return o.sent(),[3,6];case 4:return t=o.sent(),e&&Du(t),[3,6];case 5:return Na=!1,[7];case 6:return[2]}}))}))}),Math.max(1,La+Ko.fromSeconds(20)-Date.now())))},Aa=function(e){var t;if("on"===(null===(t=Zu())||void 0===t?void 0:t.name)){var n=e.error;if(n)switch(n.replace(/^net::/,"").replace(/^ERR_/,"")){case"NETWORK_CHANGED":case"NETWORK_IO_SUSPENDED":Ra();break;case"TUNNEL_CONNECTION_FAILED":case"PROXY_CONNECTION_FAILED":Ra(!0)}else Da[e.requestId]&&delete Da[e.requestId]}},Ma=function(e){return!!Da[e.requestId]},$a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ua=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ga=function(e,t){return ci((function(){if(!t)throw new Error("asyncBlocking not supported");var n=setTimeout((function(){return ci((function(){t({cancel:!0})}))}),Ko.fromSeconds(Math.min(20,m)));ui(function(e){return $a(void 0,void 0,void 0,(function(){return Ua(this,(function(t){return[2,(n=function(){return $a(void 0,void 0,void 0,(function(){var t;return Ua(this,(function(n){switch(n.label){case 0:return e.isProxy?Ma(e)?[2,{cancel:!0}]:Su(e.challenger.host)?(Vo("Auth required for ",e),[4,$s()]):[3,2]:[3,2];case 1:return[2,(t=n.sent())&&Eu(t,e)||{cancel:!0}];case 2:return[2,{}]}}))}))},Zo(void 0,void 0,void 0,(function(){var e;return Qo(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),ii(e),e;case 3:return[2]}}))})))];var n}))}))}(e).then((function(r){clearTimeout(n),t(r||(e.isProxy&&Su(e.challenger.host)?{cancel:!0}:{}))})))}))},qa=function(){return ci((function(){var e;(null===(e=Zu())||void 0===e?void 0:e.proxyEnabled)&&ui($s())}))},Ha=function(){var e,t,n,r=browser.webRequest;r&&(null===(e=r.onBeforeRequest)||void 0===e||e.removeListener(qa),null===(t=r.onCompleted)||void 0===t||t.removeListener(Aa),null===(n=r.onErrorOccurred)||void 0===n||n.removeListener(Aa))},Fa=function(){var e,t,n,r,o,i,a=browser.webRequest;if(a){var s={urls:["<all_urls>"]};if(Ha(),null===(e=a.onBeforeRequest)||void 0===e||e.addListener(qa,s),!(null===(t=a.onAuthRequired)||void 0===t?void 0:t.hasListener(Ga)))try{null===(n=a.onAuthRequired)||void 0===n||n.addListener(Ga,s,["asyncBlocking","extraHeaders"])}catch(e){null===(r=a.onAuthRequired)||void 0===r||r.addListener(Ga,s,["asyncBlocking"])}null===(o=a.onCompleted)||void 0===o||o.addListener(Aa,s),null===(i=a.onErrorOccurred)||void 0===i||i.addListener(Aa,s)}},Va=function(e){var t=function(e){if("string"!=typeof e)return{};try{var t=JSON.parse(atob(e.split(".")[1]||"")||"{}");return"object"!=typeof t||t instanceof Array?{}:t}catch(e){return{}}}(null==e?void 0:e.Username);return{expiration:t.exp||0,groups:(t.grp||"").split(",").filter(Boolean),sessionId:t.sid||null}},Ba=D.selfItem("user",C),za=function(e){var t;return"object"==typeof(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.VPN)},Ya=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ja=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Wa=function(){return Ya(void 0,void 0,void 0,(function(){var e;return Ja(this,(function(t){switch(t.label){case 0:return[4,Ba.load()];case 1:return e=t.sent(),za(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}}))}))},Ka=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xa=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Za=function(t){return Ka(void 0,void 0,void 0,(function(){var n;return Xa(this,(function(r){switch(r.label){case 0:return[4,D.getItem("backoff-"+t,void 0,e.LOCAL)];case 1:return(n=r.sent())?Date.now()>n.forget?(function(t){ui(D.removeItem("backoff-"+t,e.LOCAL))}(t),[2,!1]):[2,Date.now()<=n.expiration]:[2,!1]}}))}))},Qa=function(t,n){void 0===n&&(n=5e3),ui(Ka(void 0,void 0,void 0,(function(){var r,o,i,a;return Xa(this,(function(s){switch(s.label){case 0:return[4,D.getItem("backoff-"+t,void 0,e.LOCAL)];case 1:return r=s.sent(),o=((null==r?void 0:r.increment)||0)+1,i=Date.now()+1e3*Math.min(300,Math.pow(n/1e3,(1+o)/2)),a=Date.now()+2e4+1e3*Math.max(15,Math.min(600,Math.pow(n/1e3,(2+o)/2))),[4,D.setItem("backoff-"+t,{increment:o,expiration:i,forget:a},e.LOCAL)];case 2:return s.sent(),[2]}}))})))},es=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ts=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ns=D.item("connectedServer",e.SESSION),rs=function(){return es(void 0,void 0,void 0,(function(){var e,t;return ts(this,(function(n){switch(n.label){case 0:return[4,ns.get()];case 1:return[2,!!(null===(t=null===(e=n.sent())||void 0===e?void 0:e.value)||void 0===t?void 0:t.proxyHost)]}}))}))},os=function(e){var t;return(null===(t=null==e?void 0:e.VPN)||void 0===t?void 0:t.MaxTier)||0},is=function(){var e,t=!1;n.g.browser||(n.g.browser=chrome);var r=((e={})[To.USER]=function(e){var n=e.user;t=function(e){return os(e)>0}(n)},e);return browser.runtime.onMessage.addListener((function(e){var t,n=null==e?void 0:e.event;return null===(t=r[n])||void 0===t||t.call(r,e),!1})),function(){return!t}}(),as=function(){return is()?Ko.fromMinutes(30):Ko.fromMinutes(10)},ss=function(){return is()?Ko.fromDays(1):Ko.fromHours(6)},cs=function(){return 8*ss()},us=function(){return is()?Ko.fromMinutes(20):Ko.fromMinutes(10)},ls=function(){return Ko.fromDays(10)},fs=function(){return fs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},fs.apply(this,arguments)},ds=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ps=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hs=D.item("location",e.LOCAL),vs=D.item("location-fetching",e.LOCAL);ui(hs.remove());var ys=function(){return hs.load()},bs=function(){return ds(void 0,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return ps(this,(function(c){switch(c.label){case 0:return[4,ys()];case 1:return e=c.sent(),t=as(),(n=Ko.diffInMilliSeconds(null==e?void 0:e.time)<t)?[3,3]:[4,Za("location")];case 2:n=c.sent(),c.label=3;case 3:if(n)return[2,null==e?void 0:e.location];c.label=4;case 4:return r=Date.now(),[4,vs.get()];case 5:return r-((null===(s=c.sent())||void 0===s?void 0:s.time)||0)<Ko.fromSeconds(2)?[4,Gi(200)]:[3,8];case 6:return c.sent(),[4,ys()];case 7:return o=c.sent(),Ko.diffInMilliSeconds(null==o?void 0:o.time)<t?[2,null==o?void 0:o.location]:[3,4];case 8:return[4,ds(void 0,void 0,void 0,(function(){return ps(this,(function(e){switch(e.label){case 0:return[2,!0];case 1:return[2,e.sent()]}}))}))];case 9:if(!c.sent())return[2,null==e?void 0:e.location];c.label=10;case 10:return c.trys.push([10,15,16,17]),[4,vs.setValue(null)];case 11:return c.sent(),[4,Qi("vpn/v1/location")];case 12:return(i=c.sent())?[4,hs.set({time:Date.now(),location:i})]:[3,14];case 13:c.sent(),c.label=14;case 14:return[2,i];case 15:if(a=c.sent(),Qa("location"),a instanceof _i)throw a;return[2,null==e?void 0:e.location];case 16:return ui(vs.remove()),[7];case 17:return[2]}}))}))},ms=function(e,t,n){return ds(void 0,void 0,void 0,(function(){var r,o;return ps(this,(function(i){switch(i.label){case 0:return[4,bs()];case 1:return r=i.sent(),(o=null==r?void 0:r.IP)&&(t||(t={}),t.headers=fs(fs({},t.headers),{"x-pm-netzone":o.replace(/\.\d+$/,".0"),"x-pm-country":null==r?void 0:r.Country})),[4,Qi(e,t,void 0,n)];case 2:return[2,i.sent()]}}))}))},gs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ws=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_s=function(e,t,n){return gs(void 0,void 0,void 0,(function(){var r,o,i,a,s,c;return ws(this,(function(u){switch(u.label){case 0:return[4,Wa()];case 1:if(r=(null===(c=null===(s=u.sent())||void 0===s?void 0:s.user)||void 0===c?void 0:c.VPN)||{},o=r.MaxTier,i=r.Groups,t||(t={}),"number"!=typeof o)throw new Error("Cannot fetch ".concat(e," while not authenticated"));return Object.assign(t.headers||(t.headers={}),{"x-pm-max-tier":"".concat(o)}),i&&(a=i.length,Object.assign(t.headers||(t.headers={}),1===a?{"x-pm-single-group":i.join(",")}:{"x-pm-group-count":a})),[4,ms(e,t,n)];case 2:return[2,u.sent()]}}))}))},xs=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ss=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Es=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ks=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};Oa("credentials");var Os,Ps,Ts=!1,Cs=[],Is=0,Ds=null,Ns=void 0,Ls=function(){Ds&&clearTimeout(Ds)},js=function(e,t){var n=1e3*Va(null==Ns?void 0:Ns.credentials).expiration,r=Date.now(),o=Ko.fromSeconds(e.Expire,r),i=Ko.fromSeconds(e.Expire/2,r);Ns={time:n?Math.min(n,o):o,halfLife:n?Math.min((r+n)/2,i):i,credentials:e,sessionUid:t},ui(yi.set(Ns))},Rs=function(e,t){return void 0===t&&(t=!0),Ss(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,c,u,l,f,d;return Es(this,(function(p){switch(p.label){case 0:Ts=!0,Is++,p.label=1;case 1:return p.trys.push([1,6,9,11]),Is>1?[4,Gi(Math.pow(2,Is-2)*(500+1500*Math.random()))]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,_s("vpn/v1/browser/token?Duration="+b,{headers:{"x-pm-try-number":"".concat(Is)}})];case 4:return n=p.sent(),[4,null===(c=null===(s=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===s?void 0:s.handlerBehaviorChanged)||void 0===c?void 0:c.call(s)];case 5:return p.sent(),Is=0,r=Zu(),n&&(js(n,e),r.proxyEnabled&&(Fa(),"function"==typeof r.setCredentials&&r.setCredentials(n)),Bo("Fetch at "+Date.now()+", expires at "+((null==Ns?void 0:Ns.time)||"unknown time"))),o=r.data,r.proxyEnabled&&(null===(u=o.error)||void 0===u?void 0:u.Warning)&&(delete o.error,i=(null===(l=o.server)||void 0===l?void 0:l.name)||"",Sa("on","".concat(ao("Label").t(Os||(Os=xs(["Protected"],["Protected"])))," - ").concat(i))),[2,n];case 6:return(a=p.sent())._id=Date.now()+"-"+Math.random(),t&&pa(a)?(Is--,[4,Pi()]):[3,8];case 7:return p.sent(),[2,Rs(e,!1)];case 8:try{ka(a,!0)}catch(e){return[2,void 0]}throw!function(e){return"object"==typeof e&&(2028===(null==e?void 0:e.Code)||2027===(null==e?void 0:e.Code))}(a)?"active"===Pa&&(function(e){return fa(e,403)}(a)||Is>2||!va(a))&&Du(a):(Ho(a,(new Error).stack),Iu(!0)),a;case 9:return Ts=!1,[4,null===(d=null===(f=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===f?void 0:f.handlerBehaviorChanged)||void 0===d?void 0:d.call(f)];case 10:return p.sent(),[7];case 11:return[2]}}))}))},As=function(e){return Ss(void 0,void 0,void 0,(function(){var t,n,r;return Es(this,(function(o){switch(o.label){case 0:if(Ts)return[2,new Promise((function(e,t){Cs.push([e,t])}))];if((null==Ns?void 0:Ns.halfLife)&&e&&Ns.sessionUid===e&&Date.now()<Ns.halfLife)return[2,Ns.credentials];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Rs(e)];case 2:if(1e3!==(null==(t=o.sent())?void 0:t.Code))throw new Error(Yo(t||{error:"No credentials found"}));return Cs.forEach((function(e){(0,ks(e,1)[0])(t)})),Cs=[],Ts=!1,js(t,e),n=.1*Ko.fromSeconds(t.Expire),Ls(),Ds=Ui(Ko.fromSeconds(t.Expire)-n,n,(function(){return Ss(void 0,void 0,void 0,(function(){var t,r,o,i;return Es(this,(function(a){switch(a.label){case 0:return Ds=null,[4,Ms()];case 1:return t=a.sent(),(r=((null==t?void 0:t.time)||0)>=Date.now()-2*n&&!Ts)?(o=e,[4,vi()]):[3,3];case 2:r=o===(null===(i=a.sent())||void 0===i?void 0:i.uid),a.label=3;case 3:return r&&ui(As(e)),[2]}}))}))})),[2,t];case 3:throw r=o.sent(),Cs.forEach((function(e){(0,ks(e,2)[1])(r)})),Cs=[],Ts=!1,r;case 4:return[2]}}))}))},Ms=function(){return yi.load()},$s=function(e){return void 0===e&&(e=!1),Ss(void 0,void 0,void 0,(function(){var t,n,r,o;return Es(this,(function(i){switch(i.label){case 0:return[4,vi()];case 1:return(t=null===(o=i.sent())||void 0===o?void 0:o.uid)?[4,ma()]:[2,void 0];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,5,,7]),[4,Ss(void 0,void 0,void 0,(function(){var e;return Es(this,(function(n){switch(n.label){case 0:return[4,Ms()];case 1:return((null==(e=n.sent())?void 0:e.time)||0)<Date.now()?[2,As(t)]:[2,null==e?void 0:e.credentials]}}))}))];case 4:return(n=i.sent())||!e?[2,n]:[3,7];case 5:if(r=i.sent(),!e||!da(r))throw r;return[4,wi({})];case 6:return i.sent(),[3,7];case 7:return[4,Pi()];case 8:return i.sent(),[2,$s()]}}))}))};!function(e){e.CLEAR="clear",e.DEFAULT="default",e.DISABLED="disable_non_proxied_udp"}(Ps||(Ps={}));var Us=function(e){return new Promise((function(t){chrome.privacy?e!==Ps.CLEAR?chrome.privacy.network.webRTCIPHandlingPolicy.set({value:e},(function(){chrome.privacy.network.webRTCIPHandlingPolicy.get({},(function(n){var r,o;t(("controlled_by_this_extension"===(o=null==(r=n)?void 0:r.levelOfControl)||"controllable_by_this_extension"===o?null==r?void 0:r.value:void 0)===e)}))})):chrome.privacy.network.webRTCIPHandlingPolicy.clear({},t):t(!1)}))},Gs=D.item("prevent-webrtc-leak"),qs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Hs=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Fs=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Vs=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Oa("proxy");var Bs,zs=function(e){return"fixed_servers"===e.mode},Ys=!1,Js=function(e){return new Promise((function(t){chrome.proxy&&el()?(Ys=!0,Fa(),chrome.proxy.settings.set({value:e,scope:"regular"},(function(){Ks().then((function(e){var t,n,r=null===(n=null===(t=null===browser||void 0===browser?void 0:browser.webRequest)||void 0===t?void 0:t.handlerBehaviorChanged)||void 0===n?void 0:n.call(t);return r?r.then((function(){return e})):e})).then(t)})),ui(zs(e)?qs(void 0,void 0,void 0,(function(){return Hs(this,(function(e){switch(e.label){case 0:return[4,Gs.getDefined({value:!0})];case 1:return[4,e.sent().value?Us(Ps.DISABLED):Us(Ps.CLEAR)];case 2:return e.sent(),[2]}}))})):Us(Ps.CLEAR))):t(!1)}))},Ws=function(){return new Promise((function(e){chrome.proxy?(Ys=!1,chrome.proxy.settings.clear({},(function(t){Ys||(Ha(),ui(Us(Ps.CLEAR))),e(t)}))):e(!1)}))},Ks=function(){return Fs(void 0,void 0,void 0,(function(){return Vs(this,(function(e){switch(e.label){case 0:return[4,(t=new Promise((function(e){chrome.proxy?chrome.proxy.settings.get({},(function(t){return Fs(void 0,void 0,void 0,(function(){var n,r,o,i,a;return Vs(this,(function(s){switch(s.label){case 0:return n=e,(r="controlled_by_this_extension"===(null==t?void 0:t.levelOfControl))?[3,5]:(null===(a=null==t?void 0:t.value)||void 0===a?void 0:a.mode)?(o=zs(null==t?void 0:t.value),[3,4]):[3,1];case 1:return(i="controllable_by_this_extension"===(null==t?void 0:t.levelOfControl))?[4,rs()]:[3,3];case 2:i=s.sent(),s.label=3;case 3:o=i,s.label=4;case 4:r=o,s.label=5;case 5:return n.apply(void 0,[r]),[2]}}))}))})):e(!1)})),n=Ko.fromSeconds(5),r="Unable to check proxy settings",void 0===o&&(o=Error),new Promise((function(e,i){var a=!1,s=setTimeout((function(){a=!0,i(new o(r||"Timeout"))}),n);t.then((function(t){a||(e(t),clearTimeout(s))})).catch(i)})))];case 1:return[2,e.sent()]}var t,n,r,o}))}))},Xs=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Zs=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Qs=function(e,t){return"string"==typeof e&&"string"==typeof t?e.localeCompare(t):e>t?1:e<t?-1:0},ec=(function(){function e(e){Object.defineProperty(this,"transformer",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"sortingCallbacks",{enumerable:!0,configurable:!0,writable:!0,value:[]})}Object.defineProperty(e.prototype,"getField",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this.transformer?this.transformer.apply(this,Zs([e],Xs(t),!1)):e}}),Object.defineProperty(e.prototype,"sort",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.sortingCallbacks.length&&e.sort((function(e,r){var o=t.getField.apply(t,Zs([e],Xs(n),!1)),i=t.getField.apply(t,Zs([r],Xs(n),!1)),a=0;return t.sortingCallbacks.some((function(e){return a=e(o,i)})),a}))}}),Object.defineProperty(e.prototype,"asc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push((function(t,n){return Qs(null==t?void 0:t[e],null==n?void 0:n[e])})),this}}),Object.defineProperty(e.prototype,"desc",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this.sortingCallbacks.push((function(t,n){return Qs(null==n?void 0:n[e],null==t?void 0:t[e])})),this}})}(),function(e){return function(e){return e&&"object"==typeof e&&"number"==typeof(null==e?void 0:e.time)}(e)?Date.now()-e.time:1/0}),tc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},nc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},rc={},oc=function(t,n){return tc(void 0,void 0,void 0,(function(){var r,o,i;return nc(this,(function(a){switch(a.label){case 0:return[4,Qi("vpn/v1/cities/names")];case 1:return r=a.sent(),(o=r.Cities)?(i={time:Date.now(),value:o},rc[n]=i,ui(D.setItem("city-names-"+t,i,e.LOCAL)),[2,o]):[2,{}]}}))}))},ic=function(t,n){return tc(void 0,void 0,void 0,(function(){var r;return nc(this,(function(o){switch(o.label){case 0:return rc[t]?[2,rc[t]]:[4,D.getItem("city-names-"+n,void 0,e.LOCAL)];case 1:return(r=o.sent())&&(rc[t]=r),[2,r]}}))}))},ac=function(e,t){return void 0===t&&(t=!1),tc(void 0,void 0,void 0,(function(){var n,r,o,i;return nc(this,(function(a){switch(a.label){case 0:return e,n=navigator.languages||[fo()],/^en(-.*)$/.test("".concat(n[0]||""))?[2,{}]:(r=n.join("/"),o=(e||"")+":"+r,t?[3,2]:[4,ic(o,r)]);case 1:if(i=a.sent(),ec(i)<Ko.fromDays(20))return[2,(null==i?void 0:i.value)||{}];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,oc(r,o)];case 3:return[2,a.sent()];case 4:return a.sent(),[2,{}];case 5:return[2]}}))}))};!function(e){e[e.SECURE_CORE=1]="SECURE_CORE",e[e.TOR=2]="TOR",e[e.P2P=4]="P2P",e[e.STREAMING=8]="STREAMING",e[e.IPV6=16]="IPV6",e[e.RESTRICTED=32]="RESTRICTED",e[e.PARTNER=64]="PARTNER"}(Bs||(Bs={}));var sc=function(e){return!!(e&&e.Status>0&&0==(3&(e.ServicesDown||0)))},cc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},uc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},lc=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},fc=D.item("logicals-servers",e.LOCAL),dc={},pc=function(){ui(fc.remove())},hc=function(e){return cc(void 0,void 0,void 0,(function(){var t,n,r,o,i,a;return uc(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t=null==e?void 0:e.lastModified,[4,_s("vpn/v1/logicals",{headers:{"If-Modified-Since":t||"Thu, 01 Jan 1970 00:00:00 GMT"}},(function(e,t){return{logicals:null==t?void 0:t.LogicalServers,lastModified:e.headers.get("Last-Modified")}}))];case 1:return n=s.sent(),r=n.logicals,o=n.lastModified,r.forEach(bc),ui(fc.setValue(r,{lastModified:o})),ui(ac()),[2,r];case 2:if(i=s.sent(),null==e?void 0:e.value)return function(e){return 304===(null==e?void 0:e.status)||fa(e,304)}(a=null==i?void 0:i.response)&&ui(fc.setValue(e.value,{lastModified:a.headers.get("Last-Modified")})),[2,e.value];throw i;case 3:return[2]}}))}))},vc=function(){return cc(void 0,void 0,void 0,(function(){var e;return uc(this,(function(t){switch(t.label){case 0:return[4,cc(void 0,void 0,void 0,(function(){var e,t;return uc(this,(function(n){switch(n.label){case 0:return[4,fc.get()];case 1:return e=n.sent(),t=ec(e),e&&t<ss()?[2,e.value]:e&&t<cs()?(ui(hc(e)),[2,e.value]):[4,hc(e)];case 2:return[2,n.sent()]}}))}))];case 1:return function(e){e.sort((function(e,t){if(e.SearchScore!==t.SearchScore)return Qs(t.SearchScore,e.SearchScore);if(e.ExitCountry!==t.ExitCountry)return Qs(e.ExitCountry,t.ExitCountry);var n=lc(e.Name.split("#",2),2),r=n[0],o=n[1],i=lc(t.Name.split("#",2),2),a=i[0],s=i[1];return r===a?/^\d+$/.test(o||"0")&&/^\d+$/.test(s||"0")?Qs(parseInt(o||"0",10),parseInt(s||"0",10)):Qs(o,s):Qs(r,a)}))}(e=t.sent().filter((function(e){return e.Tier<=(n.g.logicalMaxTier||2)&&(y||0==(e.Features&(Bs.TOR|Bs.RESTRICTED)))}))),e.forEach((function(e){dc[e.ID]=e})),[2,e]}}))}))},yc=function(e){return dc[e]},bc=function(e){e._up=e.Status>0&&(e.Servers||[]).some(sc)},mc=function(e){return void 0===e._up&&bc(e),e._up},gc=D.item("notifications-enabled"),wc=function(){return wc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},wc.apply(this,arguments)};function _c(e,t,n){gc.getDefined({value:!0}).then((function(r){var o;r.value&&("string"==typeof t&&(t={message:t}),null===(o=null===chrome||void 0===chrome?void 0:chrome.notifications)||void 0===o||o.create("proton-vpn-"+e,wc({type:"basic",title:"Proton VPN",iconUrl:"/img/icon-512.png"},t),n))}))}var xc,Sc=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Ec=function(e,t){var n=(e||[]).filter((function(e){return mc(e)&&t>=e.Tier})),r=1/0,o=void 0;return n.forEach((function(e){e.Score<r&&(r=e.Score,o=e)})),o},kc=function(e,t,n){var r=Ec(e,t);if(!r)throw null==n||n(new Error(ao("Error").t(xc||(xc=Sc(["Unable to find appropriate server, try to logout and login again if it persists"],["Unable to find appropriate server, try to logout and login again if it persists"]))))),new Error("Missconfigured server. Cannot find the best one.");return r},Oc=function(e){var t=((null==e?void 0:e.Servers)||[]).filter(sc);return t[Math.floor(Math.random()*t.length)]},Pc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Tc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Cc=function(e){return Pc(void 0,void 0,void 0,(function(){var t;return Tc(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,_s("vpn/v1/logicals/".concat(e,"/alternatives"))];case 1:return[2,n.sent().Alternatives||[]];case 2:return t=n.sent(),Ho(t),[2,[]];case 3:return[2]}}))}))},Ic=function(e){return Pc(void 0,void 0,void 0,(function(){var t,n,r,o;return Tc(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Cc(e)];case 1:return t=i.sent(),(n=t.length)?[2,{logical:r=t[Math.floor(Math.random()*n)],server:Oc(r)}]:[2,{}];case 2:return o=i.sent(),Ho(o,(new Error).stack),[2,{}];case 3:return[2]}}))}))},Dc=function(e,t){return Pc(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,c;return Tc(this,(function(u){switch(u.label){case 0:return[4,Ic(e)];case 1:return n=u.sent(),r=n.server,o=n.logical,r&&o?[2,{server:r,logical:o}]:[4,vc()];case 2:if(i=u.sent(),a=i.find((function(t){return t.ID===e})),!a)return[2,{}];for(s=[function(t){return t.ID!==e},function(e){return e.Tier<=a.Tier},function(e){return(e.Features&Bs.SECURE_CORE)==(a.Features&Bs.SECURE_CORE)},function(e){return e.ExitCountry===a.ExitCountry},function(e){return e.Features===(a.Features&~Bs.RESTRICTED)}];s.length>2;){if(c=Ec(i.filter((function(e){return s.every((function(t){return t(e)}))})),t),c)return[2,{logical:c,server:Oc(c)}];s.pop()}return[2,{server:r,logical:o}]}}))}))},Nc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Lc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},jc=D.item("last-choice",e.LOCAL),Rc=function(){return ui(jc.remove())},Ac=function(){return Nc(void 0,void 0,void 0,(function(){var e;return Lc(this,(function(t){switch(t.label){case 0:return[4,jc.get()];case 1:return[2,(null===(e=t.sent())||void 0===e?void 0:e.value)||{connected:!1}]}}))}))},Mc=function(e,t,n){return t.logicalId?n?n(t.logicalId):e.filter((function(e){return e.ID===t.logicalId})):e.filter((function(e){return 0==(e.Features&(Bs.TOR|Bs.RESTRICTED|Bs.PARTNER))&&(("other"!==t.filter||!(0!=(e.Features&Bs.TOR)||e.Tier>0||e.City))&&(("number"!=typeof t.tier||e.Tier===t.tier)&&((!t.excludedFeatures||0==(e.Features&t.excludedFeatures))&&((!t.requiredFeatures||0!=(e.Features&t.requiredFeatures))&&((!t.exitCountry||e.ExitCountry===t.exitCountry)&&((!t.entryCountry||e.EntryCountry===t.entryCountry)&&(!t.city||e.City===t.city)))))))}))},$c=function(e){var t;return!!(null===(t=null==e?void 0:e.User)||void 0===t?void 0:t.Name)},Uc=D.item("pmUser",C),Gc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},qc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Hc=function(){return Gc(void 0,void 0,void 0,(function(){var e;return qc(this,(function(t){switch(t.label){case 0:return[4,Qi("users")];case 1:return(e=t.sent())&&(Ru()||Cu(),ui(Uc.set({time:Date.now(),user:e}))),[2,$c(e)?e.User:e]}}))}))},Fc=function(){return Gc(void 0,void 0,void 0,(function(){var e,t,n;return qc(this,(function(r){switch(r.label){case 0:return[4,Gc(void 0,void 0,void 0,(function(){var e;return qc(this,(function(t){switch(t.label){case 0:return[4,Uc.load()];case 1:return e=t.sent(),$c(null==e?void 0:e.user)&&(e.user=e.user.User),[2,e]}}))}))];case 1:if(e=r.sent(),(t=ec(e))<(is()?Ko.fromMinutes(20):Ko.fromMinutes(10)))return[2,null==e?void 0:e.user];if(t<Ko.fromDays(3))return ui(Hc()),[2,null==e?void 0:e.user];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,Hc()];case 3:return[2,r.sent()];case 4:if(n=r.sent(),null==e?void 0:e.user)return[2,e.user];throw n;case 5:return[2]}}))}))},Vc=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Bc=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},zc=[],Yc=function(){return Vc(void 0,void 0,void 0,(function(){var e;return Bc(this,(function(t){switch(t.label){case 0:return[4,Qi("vpn/v2")];case 1:return(e=t.sent())&&(Ru()||Cu(),ui(Ba.setValue(e))),[2,e]}}))}))},Jc=function(e){return Vc(void 0,void 0,void 0,(function(){var t,n,r,o,i,a,s;return Bc(this,(function(c){switch(c.label){case 0:return[4,Wa()];case 1:if(t=c.sent(),n=ec(t),r=e&&((null===(s=t.user)||void 0===s?void 0:s.VPN.MaxTier)||0)<1,o=us(),n<(r?Ko.fromSeconds(1):o))return[2,null==t?void 0:t.user];if(!r&&n<Ko.fromDays(3))return ui(Vc(void 0,void 0,void 0,(function(){var e;return Bc(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,7]),[4,ma()];case 1:return t.sent(),[4,Yc()];case 2:return t.sent(),[3,7];case 3:return e=t.sent(),da(e)?[4,Pi()]:[3,6];case 4:return t.sent(),[4,Promise.all([Yc(),Hc()])];case 5:return t.sent(),[2];case 6:throw ka(e),e;case 7:return[2]}}))}))),[2,null==t?void 0:t.user];i=Date.now(),(zc=zc.filter((function(e){return e<i-o}))).push(i),c.label=2;case 2:return c.trys.push([2,4,5,6]),[4,Yc()];case 3:return[2,c.sent()];case 4:if(a=c.sent(),null==t?void 0:t.user)return[2,t.user];throw a;case 5:return e&&ui(Hc()),[7];case 6:return[2]}}))}))},Wc=function(e,t){return void 0===e&&(e=!1),Vc(void 0,void 0,void 0,(function(){var n,r,o,i;return Bc(this,(function(a){switch(a.label){case 0:return[4,vi()];case 1:return(null===(i=a.sent())||void 0===i?void 0:i.uid)?[4,ma()]:[2,void 0];case 2:a.sent(),a.label=3;case 3:return a.trys.push([3,5,,6]),[4,Jc(t&&(s=Date.now(),(zc=zc.filter((function(e){return e<s-us()}))).length<20))];case 4:return(n=a.sent())||!e?[2,za(n)?n.User:n]:[3,6];case 5:if(r=a.sent(),!e||!da(r))throw r;return[3,6];case 6:return[4,Pi()];case 7:return a.sent(),[4,Jc()];case 8:return o=a.sent(),[2,za(o)?o.User:o]}var s}))}))},Kc=function(e,t){return void 0===e&&(e=!1),Vc(void 0,void 0,void 0,(function(){var r;return Bc(this,(function(o){switch(o.label){case 0:return[4,Wc(e,t)];case 1:return r=o.sent(),n.g.browser||(n.g.browser=chrome),li(browser.runtime.sendMessage({event:To.USER,user:r})),[2,r]}}))}))},Xc=function(){return Kc(!0,!0)},Zc=function(){return ui(Ba.remove())},Qc=function(){return ui(Uc.remove())},eu=function(){return eu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},eu.apply(this,arguments)};function tu(e,t){void 0===t&&(t={}),t.error instanceof Error&&(t.error={message:t.error.message,stack:t.error.stack}),Ii("changeState",eu({state:e},t))}var nu,ru=D.item("split-tunneling"),ou=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},iu=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},au=function(e,t){if(e<1)return[];var n=[];return t.forEach((function(e){n.push.apply(n,iu([e.domain],ou(e.withSubDomains?["."+e.domain]:[]),!1))})),n},su=function(e,t){return function(n){return 0!=(n.Features&Bs.SECURE_CORE)===(e>0&&t.value)}},cu=function(e){return-1!==Va(e).groups.indexOf("vpn-paid")?2:0},uu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},lu=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},fu={},du=function(e,t,n,r,o){return uu(void 0,void 0,void 0,(function(){var i,a;return lu(this,(function(s){switch(s.label){case 0:return[4,Gi(o)];case 1:if(s.sent(),Date.now()-(fu[e]||0)<Ko.fromMinutes(30))return[2];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,fetch("http://".concat(e,"/vpn/v1/browser/token"),{method:"HEAD",headers:t&&n?{"x-pm-vpn-authorization":"".concat(t,".").concat(n)}:{}})];case 3:if(403===(i=s.sent()).status)return fu[e]=Date.now(),[2];if(!la(i))throw new Error("".concat(i.status||""," ").concat(i.statusText).trim());return[3,6];case 4:if(a=s.sent(),r>4)throw a;return[4,du(e,t,n,r+1,{1:500,2:Ko.fromSeconds(2),3:Ko.fromSeconds(6)}[r]||Ko.fromSeconds(12))];case 5:return s.sent(),[3,6];case 6:return[2]}}))}))},pu=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},hu=function(){return hu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},hu.apply(this,arguments)},vu=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},yu=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},bu=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},mu=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},gu=0;Oa("state");var wu=function(e){return{scheme:S,host:e.proxyHost,port:e.proxyPort}},_u=function(){var e,t;return!!(null===(t=null===(e=null==nu?void 0:nu.data)||void 0===e?void 0:e.error)||void 0===t?void 0:t.Warning)},xu={},Su=function(e){var t,n;return e===(null===(n=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost)||/^(.*\.)?protonvpn(\.net|\.com)(:\d+)?$/.test(e)||!!xu[e]};function Eu(e,t){var n,r,o=nu.data;if(!e||(null===(n=o.credsData)||void 0===n?void 0:n.Username)===e.Username&&(null===(r=o.credsData)||void 0===r?void 0:r.Password)===e.Password||Object.assign(o,{credsTry:0,credsData:e}),o.credsData)return{authCredentials:{username:o.credsData.Username,password:o.credsData.Password}}}var ku={name:"on",initializedAt:0,proxyEnabled:!1,refreshingState:!1,init:function(e){if(this.proxyEnabled=!1,nu.data=hu(hu(hu({credsData:void 0},null==e?void 0:e.data),nu.data),{starting:!0}),void 0===nu.data.server)return Tu(Pu)},connectCurrentServer:function(){var e;return vu(this,void 0,void 0,(function(){var t,n;return yu(this,(function(r){switch(r.label){case 0:return t=null===(e=null==nu?void 0:nu.data)||void 0===e?void 0:e.server,Vo(t),(n=!!t)?[4,this.setProxy(t,t.bypassList||[])]:[3,2];case 1:n=r.sent(),r.label=2;case 2:return[2,n]}}))}))},setOption:function(e,t){var n;return vu(this,void 0,void 0,(function(){return yu(this,(function(r){switch(r.label){case 0:return e===ko.BYPASS_LIST?[3,1]:[3,4];case 1:return(null===(n=null==nu?void 0:nu.data)||void 0===n?void 0:n.server)?(nu.data.server.bypassList=t,[4,this.connectCurrentServer()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[3,4];case 4:return[2]}}))}))},setProxy:function(e,t){var n,r;return void 0===t&&(t=[]),vu(this,void 0,void 0,(function(){var o,i;return yu(this,(function(a){switch(a.label){case 0:return(null===(n=nu.data)||void 0===n?void 0:n.starting)&&delete nu.data.starting,xu[e.proxyHost]=!0,[4,$s()];case 1:return o=a.sent(),(i=!o)?[3,3]:[4,Ms()];case 2:i=((null===(r=a.sent())||void 0===r?void 0:r.time)||0)<Date.now(),a.label=3;case 3:return i?(Ho(o?"Expired token":"No token"),[2,!1]):[4,Js({mode:"fixed_servers",rules:{singleProxy:wu(e),bypassList:mu(mu(mu([],bu(t),!1),bu(p),!1),bu(h),!1)}})];case 4:return a.sent()?(this.proxyEnabled=!0,ui(this.checkLogicalIsUp(o)),[2,!0]):[2,!1]}}))}))},setConnected:function(){var e,t,n;return vu(this,void 0,void 0,(function(){var r,o,i,a,s,c;return yu(this,(function(u){switch(u.label){case 0:return(null===(e=null==nu?void 0:nu.data)||void 0===e?void 0:e.server)?(r=Date.now(),o=nu,i=nu.data.server,a=nu.data.server.name,gu=r,[4,this.connectCurrentServer()]):(Du(new Error(ao("Error").t($u||($u=pu(["Server not found"],["Server not found"]))))),[2]);case 1:return u.sent()?((s=null===(t=nu.data.server)||void 0===t?void 0:t.proxyHost)&&(c=null===(n=null==nu?void 0:nu.data)||void 0===n?void 0:n.credsData,function(e,t,n){li(du(e,t,n,1,300))}(s,null==c?void 0:c.Username,null==c?void 0:c.Password)),setTimeout((function(){var e;if(o===nu&&(null===(e=nu.data.server)||void 0===e?void 0:e.name)===a){tu("connected",{server:i,error:nu.data.error});var t=a||"";Sa("on","".concat(ao("Label").t(Gu||(Gu=pu(["Protected"],["Protected"])))," - ").concat(t))}}),Math.max(1,200-(new Date).getTime()+r)),[2]):(Du(new Error(ao("Error").t(Uu||(Uu=pu(["Not able to control the browser network settings, possibly a permission is missing"],["Not able to control the browser network settings, possibly a permission is missing"]))))),[2])}}))}))},setCredentials:function(e){var t,n,r=null==e?void 0:e.Username,o=null==e?void 0:e.Password;if(r&&o){var i=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.credsData;r!==(null==i?void 0:i.Username)||o!==(null==i?void 0:i.Password)?function(e,t){if(!e||!t)return!0;var n=Va(e),r=Va(t);return n.sessionId!==r.sessionId||r.expiration>n.expiration}(i,e)&&(Object.assign(nu.data,{credsTry:0,credsData:{Username:r,Password:o}}),ui(this.setConnected())):(null===(n=nu.data)||void 0===n?void 0:n.starting)&&ui(this.setConnected())}},checkLogicalIsUp:function(e){var t,n,r,o;return vu(this,void 0,void 0,(function(){var i,a,s,c,u,l,f,d,p,h;return yu(this,(function(v){switch(v.label){case 0:if(i=Date.now(),!(a=null===(n=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.id)||i-gu<(is()?Ko.fromMinutes(20):Ko.fromMinutes(5)))return[2];s=this.initializedAt,gu=i,v.label=1;case 1:return v.trys.push([1,9,,10]),[4,Gi(500)];case 2:return v.sent(),this.proxyEnabled&&Au()?[4,_s("vpn/v1/logicals?ID[]="+a)]:[2];case 3:return(c=v.sent().LogicalServers)[0]&&mc(c[0])?[3,8]:(l=e)?[3,5]:[4,$s(!0)];case 4:l=v.sent(),v.label=5;case 5:return(u=l)?[4,Dc(a,cu(u))]:[3,8];case 6:return f=v.sent(),d=f.server,(p=f.logical)&&d&&s===Zu().initializedAt?[4,Nu(p,d,null===(o=null===(r=null==nu?void 0:nu.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.bypassList)]:[3,8];case 7:v.sent(),v.label=8;case 8:return[3,10];case 9:return h=v.sent(),ka(h),[3,10];case 10:return[2]}}))}))},refreshState:function(){var e,t,n;return vu(this,void 0,void 0,(function(){var r,o,i,a,s;return yu(this,(function(c){switch(c.label){case 0:if(this.refreshingState)return[2];this.refreshingState=!0,c.label=1;case 1:return c.trys.push([1,,10,11]),ui(this.checkLogicalIsUp()),(r=!(null===(e=nu.data)||void 0===e?void 0:e.starting))?[4,Ks()]:[3,3];case 2:r=c.sent(),c.label=3;case 3:if(r)return[2];c.label=4;case 4:return c.trys.push([4,8,,9]),[4,Ss(void 0,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return Es(this,(function(c){switch(c.label){case 0:return[4,Ms()];case 1:return e=c.sent(),t=((null==e?void 0:e.time)||0)-Date.now(),n=null==e?void 0:e.credentials,t<0&&!Ts?t<Ko.fromSeconds(-20)||!n?(r=As,[4,vi()]):[3,3]:[3,5];case 2:return[2,r.apply(void 0,[null===(a=c.sent())||void 0===a?void 0:a.uid])];case 3:return o=ui,i=As,[4,vi()];case 4:o.apply(void 0,[i.apply(void 0,[null===(s=c.sent())||void 0===s?void 0:s.uid])]),c.label=5;case 5:return[2,n]}}))}))];case 5:return(o=c.sent())?(this.setCredentials(o),[2]):_u()?[2]:(i=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server,a=(null==i?void 0:i.name)||"",tu("connecting",{server:i}),Sa("connecting",ao("Status").t(qu||(qu=pu(["Connecting to ",""],["Connecting to ",""])),a)),[4,$s(!0)]);case 6:if(o=c.sent(),!(_u()||(null==o?void 0:o.Username)&&(null==o?void 0:o.Password)))return Tu(Pu),[2];if(this.setCredentials(o),!(null===(n=null==nu?void 0:nu.data)||void 0===n?void 0:n.server))throw new Error("No server");return[4,this.connectCurrentServer()];case 7:return c.sent(),[3,9];case 8:return Du(s=c.sent()),ii(s),[3,9];case 9:return[3,11];case 10:return this.refreshingState=!1,[7];case 11:return[2]}}))}))},handleProxyRequest:function(e){var t,n,r=mu(mu([],bu(h),!1),bu((null===(n=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.bypassList)||[]),!1);if(function(e,t,n){var r=new URL(e.url),o=r.hostname;return!(-1===p.indexOf(o)||!t&&!/^\/?(api\/)?vpn\/location(\?.*)?$/.test(r.pathname))||(n||[]).some((function(t){return"."===t.charAt(0)?new RegExp(t.replace(".","\\.")+"$").test(o):!!Ci(o,t)||(/[*\\/]/.test(t)?-1!==t.indexOf("/")?new RegExp("^"+(-1===t.indexOf("//")?"([^/]+.)?":"")+t.replace(".","\\.").replace("*",".*")).test(0===t.indexOf("://")?e.url.replace(/^[a-z]+(:\/\/)/,"$1"):0===t.indexOf("//")?e.url.replace(/^[a-z]+:(\/\/)/,"$1"):e.url):new RegExp(t.replace(".","\\.").replace("*",".*")+"$").test(o):o===t)}))}(e,f,r))return{type:"direct"};var o=function(e){var t,n,r,o,i,a,s,c=hu({type:S,host:null===(n=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost,port:null===(o=null===(r=null==nu?void 0:nu.data)||void 0===r?void 0:r.server)||void 0===o?void 0:o.proxyPort},null===(i=Eu(e))||void 0===i?void 0:i.authCredentials);return c.username&&c.password&&(c.proxyAuthorizationHeader=(a=c.username,s=c.password,"Basic "+btoa(a+":"+s))),c},i=function(){var e=(null==Ns?void 0:Ns.time)||0,t=Date.now();if(e>t)return e-t<Ko.fromSeconds(10)&&ui($s(!0)),null==Ns?void 0:Ns.credentials}();if(i)return o(i);var a=function(e){return $s(!0).then((function(t){return t?o(t):vi().then((function(t){return e>0?Gi(400).then((function(){return a(e-1)})):((null==t?void 0:t.uid)?Du(new Error(ao("Error").t(Hu||(Hu=pu(["Server not found"],["Server not found"]))))):Iu(!0),{type:"direct"})}))}))};return a(3)},handleProxyAuthentication:function(e){var t,n;return vu(this,void 0,void 0,(function(){var r,o;return yu(this,(function(i){switch(i.label){case 0:return e.isProxy?Ma(e)?[2,{cancel:!0}]:(r=e.challenger.host)===(null===(n=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server)||void 0===n?void 0:n.proxyHost)||xu[r]?[4,$s()]:[3,2]:[3,2];case 1:return[2,(o=i.sent())&&Eu(o)||{cancel:!0}];case 2:return[2,void 0]}}))}))},checkConnectingState:function(e){var t,n;if(this.proxyEnabled){var r=null===(t=null==nu?void 0:nu.data)||void 0===t?void 0:t.server,o=(null==r?void 0:r.name)||"";tu("connected",{server:r,error:nu.data.error}),Sa("on","".concat(ao("Label").t(Fu||(Fu=pu(["Protected"],["Protected"])))," - ").concat(o))}else Date.now()-e>Ko.fromSeconds(30)&&Du((null===(n=nu.data)||void 0===n?void 0:n.error)||new Error("Connection timeout"))}},Ou={name:"loggedout",initializedAt:0,init:function(){return vu(this,void 0,void 0,(function(){return yu(this,(function(e){switch(e.label){case 0:return Ls(),nu.data={},Sa("loggedOut"),tu("logged-out"),[4,Ws()];case 1:return e.sent(),[2]}}))}))},checkConnectingState:function(e){Date.now()-e>Ko.fromSeconds(5)&&tu("logged-out")}},Pu={name:"off",initializedAt:0,init:function(e){var t;return vu(this,void 0,void 0,(function(){var n;return yu(this,(function(r){switch(r.label){case 0:return Ls(),nu.data={},(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.error)&&(nu.data.error=n),tu("disconnected",{error:n}),Sa(n?"error":"off",n&&Yo(n)),[4,Ws()];case 1:return r.sent(),[2]}}))}))},refreshState:function(){return vu(this,void 0,void 0,(function(){var e;return yu(this,(function(t){switch(t.label){case 0:return(e=nu.data.server&&Date.now()-this.initializedAt>Ko.fromSeconds(3))?[4,Ks()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e?[4,Lu(nu.data)]:[3,4];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},checkConnectingState:function(e){var t;Date.now()-e>Ko.fromSeconds(5)&&tu("disconnected",{error:(null===(t=nu.data)||void 0===t?void 0:t.error)||new Error("Connection initialization timeout")})}};function Tu(e){var t,n,r,o=nu||void 0;nu=Object.assign({data:{}},e,{initializedAt:Date.now()}),Vo("Switch state to "+nu.name,nu.data),null===(t=nu.init)||void 0===t||t.call(nu,o),null===(n=nu.refreshState)||void 0===n||n.call(nu),ui(ns.setValue(null===(r=nu.data)||void 0===r?void 0:r.server))}function Cu(){Tu(Pu)}function Iu(e){var t=this;Tu(Ou),pi.get().then((function(n){return vu(t,void 0,void 0,(function(){return yu(this,(function(t){return Qc(),Zc(),ui(pi.remove()),ui(hi.remove()),ui(bi()),pc(),Rc(),e&&(null==n?void 0:n.uid)&&ui(Wi("auth",{method:"DELETE"},void 0,n)),[2]}))}))})),_c("logged-out",ao("Info").t(Vu||(Vu=pu(["Logged out"],["Logged out"])))),Vo("Logged out")}function Du(e){_c("connected-server",e?"".concat(Yo(e)):ao("Info").t(Bu||(Bu=pu(["Disconnected"],["Disconnected"])))),Zu().data.error=e,Tu(Pu)}function Nu(e,t,n){var r;return vu(this,void 0,void 0,(function(){var o,i;return yu(this,(function(a){switch(a.label){case 0:return o=0!=(e.Features&Bs.SECURE_CORE),i=t.Label||"",[4,Lu({server:{id:e.ID,name:e.Name,exitIp:t.ExitIP,entryCountry:e.EntryCountry,exitCountry:e.ExitCountry,exitCity:(null===(r=e.Translations)||void 0===r?void 0:r.City)||e.City,exitEnglishCity:e.City,secureCore:o,proxyHost:g||t.Domain,proxyPort:o?x||w:w+(!_&&/^\d+$/.test(i)?parseInt(i,10):0),bypassList:n}})];case 1:return a.sent(),[2]}}))}))}function Lu(e){var t,n;return vu(this,void 0,void 0,(function(){var r,o;return yu(this,(function(i){switch(i.label){case 0:return r=ju,o=[e],[4,ns.get()];case 1:return[2,r.apply(void 0,o.concat([null===(n=null===(t=i.sent())||void 0===t?void 0:t.value)||void 0===n?void 0:n.name]))]}}))}))}function ju(e,t){var n,r;return vu(this,void 0,void 0,(function(){var o,i;return yu(this,(function(a){return delete nu.data.error,Object.assign(nu.data,e),Tu(ku),o=null===(n=null==e?void 0:e.server)||void 0===n?void 0:n.name,i=null===(r=null==e?void 0:e.server)||void 0===r?void 0:r.exitCity,t&&t===o||_c("connected-server",o?i?ao("Info").t(zu||(zu=pu(["Connected to "," in ",""],["Connected to "," in ",""])),o,i):ao("Info").t(Yu||(Yu=pu(["Connected to ",""],["Connected to ",""])),o):ao("Info").t(Ju||(Ju=pu(["Connected"],["Connected"])))),[2]}))}))}function Ru(){return nu&&"loggedout"!==nu.name}function Au(){return nu&&"on"===nu.name}function Mu(){return vu(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,c,u,l,f,d;return yu(this,(function(p){switch(p.label){case 0:return e=D.item("auto-connect"),t=D.item("secure-core"),[4,Kc()];case 1:return(n=p.sent())?[4,Promise.all([Ac(),vc(),e.getDefined({value:!0}),ru.getDefined({value:[]}),E?t.getDefined({value:!1}):new Promise((function(e){e({value:!1})}))])]:[2];case 2:return r=bu.apply(void 0,[p.sent(),5]),o=r[0],i=r[1],a=r[2],s=r[3],c=r[4],(null==o?void 0:o.connected)&&(null==a?void 0:a.value)?(u=os(n),l=Mc(i.filter(su(u,c)).filter((function(e){return u>=e.Tier})),o,(function(e){var t=yc(e);return t?[t]:[]})),l[0]?(f=("random"===o.pick?l[Math.floor(Math.random()*l.length)]:kc(l,u))||l[0],d=Oc(f),(null==d?void 0:d.ExitIP)?[4,Nu(f,d,au(u,s.value))]:[3,4]):[3,4]):[3,4];case 3:p.sent(),p.label=4;case 4:return[2]}}))}))}var $u,Uu,Gu,qu,Hu,Fu,Vu,Bu,zu,Yu,Ju,Wu=!1,Ku=[];function Xu(){return vu(this,void 0,void 0,(function(){return yu(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ma()];case 1:return[2,e.sent()?Pu:Ou];case 2:return e.sent(),[2,Ou];case 3:return[2]}}))}))}function Zu(){var e=this;return nu||(Vo("New state creation"),nu={data:{}},ns.get().then((function(t){return vu(e,void 0,void 0,(function(){var e,n;return yu(this,(function(r){switch(r.label){case 0:return(e=null==t?void 0:t.value)?[4,ju({server:e},e.name)]:[3,2];case 1:case 4:return r.sent(),[2];case 2:return Bo(null==t?void 0:t.value),n=Tu,[4,Xu()];case 3:return n.apply(void 0,[r.sent()]),[4,Mu()]}}))}))})).finally((function(){Wu=!0,Ku.forEach((function(e){e()})),Ku=[]}))),nu}var Qu=function(e){var t,n;return null===(n=null===(t=nu)||void 0===t?void 0:t.handleProxyRequest)||void 0===n?void 0:n.call(t,e)},el=function(){var e=chrome.proxy;if(!e)return!1;var t=e.onRequest;return!t||(t.hasListener(Qu)||t.addListener(Qu,{urls:["<all_urls>"]}),!0)},tl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},nl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},rl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ol=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},il=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},al=!1,sl=[],cl=D.item("servers-count",e.LOCAL),ul=function(){return rl(void 0,void 0,void 0,(function(){var e,t;return ol(this,(function(n){switch(n.label){case 0:if(al)return[2,new Promise((function(e,t){sl.push([e,t])}))];al=!0,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,Qi("vpn/servers-count")];case 2:return e=n.sent(),ui(cl.setValue(e)),sl.forEach((function(t){(0,il(t,1)[0])(e)})),[2,e];case 3:throw t=n.sent(),sl.forEach((function(e){(0,il(e,2)[1])(t)})),t;case 4:return sl=[],al=!1,[7];case 5:return[2]}}))}))},ll=function(){return rl(void 0,void 0,void 0,(function(){var e,t,n;return ol(this,(function(r){switch(r.label){case 0:return[4,cl.get()];case 1:if(e=r.sent(),t=ec(e),e&&t<ls())return[2,e.value];if(e&&t<2*ls())return ui(ul()),[2,e.value];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,ul()];case 3:return[2,r.sent()];case 4:if(n=r.sent(),null==e?void 0:e.value)return[2,e.value];throw n;case 5:return[2]}}))}))},fl=function(e,t){void 0===t&&(t=!0);var n,r=(n=e,btoa(n).trim()).replace(/\+/g,"-").replace(/\//g,"_");return t?r.replace(/=/g,""):r},dl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hl={signup:"2"},vl=function(t,n){return dl(void 0,void 0,void 0,(function(){var r,o;return pl(this,(function(i){switch(i.label){case 0:return r=fl(function(e){for(var t=[],n=16384,r=e.length,o=0;o<r;o+=n)t.push(String.fromCharCode.apply(String,e.subarray(o,o+n<r?o+n:r)));return t.join("")}(crypto.getRandomValues(new Uint8Array(32)))),[4,D.setItem("f".concat(r),{},e.LOCAL)];case 1:return i.sent(),o={app:"proton-vpn-browser-extension",appVersion:Yi(),state:r,t:n&&hl[n]||"1",plan:"vpn2022"},[2,"".concat(t,"/authorize?").concat(new URLSearchParams(o).toString())]}}))}))},yl=function(){return yl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},yl.apply(this,arguments)},bl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ml=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},gl=n.g||window;gl.browser||(gl.browser=chrome);var wl=D.item("tabs",e.LOCAL),_l=function(e){var t,n;!function(e){ui(bl(void 0,void 0,void 0,(function(){var t,n,r,o;return ml(this,(function(i){switch(i.label){case 0:return n=(t=wl).set,r=[{}],[4,wl.load({})];case 1:return[4,n.apply(t,[yl.apply(void 0,[yl.apply(void 0,r.concat([i.sent()])),(o={},o[e]=!0,o)])])];case 2:return[2,i.sent()]}}))})))}(e),ui(null===(n=(t=browser.tabs).executeScript)||void 0===n?void 0:n.call(t,e,{code:"\n\t\t\tchrome.runtime.connect();\n\t\t\twindow.addEventListener('message', (event) => {\n\t\t\t\tif (event.source != window) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tchrome.runtime.sendMessage({...event.data, tabId: ".concat(JSON.stringify(e),"});\n\t\t\t}, false);\n\t\t")}))},xl=function(e,t){return bl(void 0,void 0,void 0,(function(){var n,r,o,i,a;return ml(this,(function(s){switch(s.label){case 0:return t?(r=(n=Promise).all,e?(o=[e],[3,3]):[3,1]):[2];case 1:return a=(i=Object).keys,[4,wl.load({})];case 2:o=a.apply(i,[s.sent()]),s.label=3;case 3:return[4,r.apply(n,[o.map((function(e){return bl(void 0,void 0,void 0,(function(){var n,r,o,i,a;return ml(this,(function(s){switch(s.label){case 0:e=Number(e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,(null===(o=null===(r=browser.scripting)||void 0===r?void 0:r.executeScript)||void 0===o?void 0:o.call(r,{target:{tabId:e,allFrames:!0},func:function(e){window.postMessage(e)},args:[t]}))||(null===(a=(i=browser.tabs).executeScript)||void 0===a?void 0:a.call(i,e,{code:"\n\t\t\t\t\t\twindow.postMessage(".concat(JSON.stringify(t),");\n\t\t\t\t\t")}))];case 2:return s.sent(),[3,4];case 3:return n=s.sent(),Ho(n),[3,4];case 4:return[2]}}))}))}))])];case 4:return s.sent(),ui(wl.set({})),[2]}}))}))},Sl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},El=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},kl={},Ol=function(e,t){return Sl(void 0,void 0,void 0,(function(){var n,r;return El(this,(function(o){switch(o.label){case 0:if(n="string"==typeof e?{url:e}:e,r=t||n.url){if(kl[r])throw new Error("Url already open");kl[r]=!0,setTimeout((function(){delete kl[r]}),800)}return[4,browser.tabs.create(n)];case 1:return[2,o.sent()]}}))}))},Pl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Tl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Cl=function(e){return Pl(void 0,void 0,void 0,(function(){var t;return Tl(this,(function(n){switch(n.label){case 0:return[4,Za("openForkTab")];case 1:if(n.sent())throw new Error("Fork in progress");return Qa("openForkTab",500),t=Ol,[4,vl(s,e)];case 2:return t.apply(void 0,[n.sent(),"fork"]).then((function(e){e.id&&_l(e.id);var t=function(n){var r,o;e.id===n&&(browser.tabs.onRemoved.removeListener(t),null===(o=null===(r=browser.action)||void 0===r?void 0:r.openPopup)||void 0===o||o.call(r))};browser.tabs.onRemoved.addListener(t)})),[2]}}))}))},Il=["http://*/*","https://*/*","ftp://*/*","ws://*/*","wss://*/*","https://account.protonvpn.com/*","https://account.proton.me/*"];"https://account.proton.me"!==s&&Il.push(s+"/*");var Dl,Nl,Ll,jl,Rl,Al,Ml,$l,Ul,Gl,ql={permissions:["proxy"],origins:Il},Hl=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Fl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Vl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Bl=void 0,zl=0,Yl=function(e){Bl||(Bl=6553);var t,n=function(e,t){var n=Math.floor(e/t)*t;return n===Bl?n-100:n}(Bl,100),r=new Intl.NumberFormat("en-US",t).format(n);e&&"querySelectorAll"in e&&e.querySelectorAll(".incentive-paragraph").forEach((function(e){e.innerHTML=ao("Info").plural(n,function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new ro(e,t)}(Dl||(Dl=Hl(["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."],["High performance Swiss VPN that protects your privacy. Maximum security, more than "," server and no restrictions."])),r),"High performance Swiss VPN that protects your privacy. Maximum security, more than ".concat(r," servers and no restrictions."))}))},Jl=function(){if(Date.now()-zl>Ko.fromHours(3))return ll().then((function(e){return Bl=e.Servers,zl=Date.now(),Yl(),e}))},Wl=function(e,t,n,r){var o;if(e&&t){(r=!(void 0!==r&&!r||!chrome.proxy))&&chrome.permissions.contains(ql,(function(r){r||Wl(e,t,n,!1)}));var i=function(e){return function(t){if(t){c.classList.add("update-extension"),c.innerHTML=ao("Action").t(Nl||(Nl=Hl(["Update"],["Update"])));var n=(null==t?void 0:t.Error)||Yo(t);a[0]&&(a[0].classList.remove("incentive-paragraph"),a[0].innerHTML=" "+n),a[1]&&(a[1].style.display="none"),s&&(s.style.display="none");var r=new Error(e+": "+n);r.previous=t,ii(r)}}};null===(o=Jl())||void 0===o||o.catch(i("prepareSigningView")),e.style.display="block",t.style.display="none",n&&(n.style.display="none");var a=e.querySelectorAll("p"),s=e.querySelector("button.sign-up-button"),c=e.querySelector("button.sign-in-button");if(c.classList.remove("update-extension"),c.innerHTML=r?ao("Action").t(Ll||(Ll=Hl(["Sign in"],["Sign in"]))):ao("Action").t(jl||(jl=Hl(["Next"],["Next"]))),c.addEventListener("click",(function(){return Fl(void 0,void 0,void 0,(function(){var e;return Vl(this,(function(t){switch(t.label){case 0:return c.classList.contains("update-extension")?(ui(Ol((/^moz-extension:/.test(location.href)?{name:"Firefox",type:"firefox",pluginsUrl:"https://addons.mozilla.org/firefox/addon/proton-vpn-firefox-extension"}:{name:"Chrome",type:"chromium",pluginsUrl:"chrome://extensions/"}).pluginsUrl)),window.close(),[2]):(e=setTimeout((function(){window.close()}),200),[4,browser.permissions.request(ql)]);case 1:return t.sent()?(r||ui(Io(Oo.PROXY)),clearTimeout(e),[4,Cl()]):[2];case 2:return t.sent(),window.close(),[2]}}))}))})),setTimeout((function(){c.scrollIntoView()})),a[0]){if(!r)return a[0].classList.remove("incentive-paragraph"),void(a[0].innerHTML="<b>".concat(ao("Info").t(Rl||(Rl=Hl(["Allow VPN permissions"],["Allow VPN permissions"]))),"</b><br><br>")+ao("Info").t(Al||(Al=Hl(["To get started, youll need to enable VPN permissions on your browser."],["To get started, youll need to enable VPN permissions on your browser."])))+"<br><br>"+ao("Info").t(Ml||(Ml=Hl(["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."],["Press <b>Next</b>, then click <b>Allow</b> on the pop-up from your browser."])))+"<br><br>"+ao("Info").t($l||($l=Hl(["Then just click the Proton VPN icon to sign in."],["Then just click the Proton VPN icon to sign in."]))));a[0].classList.add("incentive-paragraph"),Yl(e)}if(!r||!v)return a[1]&&(a[1].style.display="none"),void(s&&(s.style.display="none"));a[1]&&(a[1].style.display="",a[1].innerHTML=ao("Action").t(Ul||(Ul=Hl(["New to Proton?"],["New to Proton?"])))),s&&(s.style.display="",s.innerHTML=ao("Action").t(Gl||(Gl=Hl(["Create an account"],["Create an account"]))),s.addEventListener("click",(function(){return Fl(void 0,void 0,void 0,(function(){return Vl(this,(function(e){switch(e.label){case 0:return[4,Cl("signup")];case 1:return e.sent(),null===window||void 0===window||window.close(),[2]}}))}))}))),Ai().then(i("getUpdateError"))}else ui(Cl())},Kl=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Xl=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Zl=n.g||window;Zl.browser||(Zl.browser=chrome);var Ql=function(e){return void 0===e&&(e={}),Kl(void 0,void 0,void 0,(function(){var t,n,r;return Xl(this,(function(o){switch(o.label){case 0:return Jl(),[4,wi(e)];case 1:return o.sent(),t=document.getElementById("spinner"),n=document.getElementById("sign-in-view"),r=document.getElementById("logged-view"),n&&r?(Wl(n,r,t),[2,!1]):(tu("logged-out"),[2,!1])}}))}))},ef=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},tf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},nf=n.g||window;nf.browser||(nf.browser=chrome);var rf,of,af=function(t){var n=t.state,r=t.selector;return ef(void 0,void 0,void 0,(function(){var t,o,i,a,s;return tf(this,(function(c){switch(c.label){case 0:return t="f".concat(n),[4,D.getItem(t,void 0,e.LOCAL)];case 1:if(!c.sent())throw new Error("Invalid state");return ui(D.removeItem(t)),[4,Qi("auth/sessions/forks/".concat(r))];case 2:return o=c.sent(),i=o.UID,a=o.AccessToken,s=o.RefreshToken,[2,{accessToken:a,refreshToken:s,uid:i}]}}))}))},sf=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},cf=function(){return cf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},cf.apply(this,arguments)},uf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},lf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ff=function(e){return uf(void 0,void 0,void 0,(function(){var t,n,r,o,i,s,c,u,l,f,d;return lf(this,(function(p){switch(p.label){case 0:if(!e||"object"!=typeof e)return[2];if(n=(t=e).payload,r=t.extension,o=t.token,r&&r!==a)return[2];if(i=o?{token:o}:{},!n||"object"!=typeof n)return[2,cf(cf({},i),{type:"error"})];s=n.selector,c=n.persistent,u=n.state,p.label=1;case 1:return p.trys.push([1,4,,5]),[4,af({state:u,selector:s})];case 2:return(l=p.sent()).persistent=c,[4,wi(l)];case 3:return p.sent(),ui(Xc()),[2,cf(cf({},i),{type:"success",payload:{title:ao("Info").t(rf||(rf=sf(["You're signed in"],["You're signed in"]))),message:ao("Info").t(of||(of=sf(["Open the Proton VPN browser extension to continue"],["Open the Proton VPN browser extension to continue"])))}})];case 4:return f=p.sent(),Fo(f),d=Yo(f),[2,cf(cf(cf({},i),{type:"error"}),d?{payload:{message:d}}:{})];case 5:return[2]}}))}))},df=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Oa("messaging");var hf=function(e){return df(void 0,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,u,l;return pf(this,(function(f){switch(f.label){case 0:switch(t=e.type,n=e.data,t){case Po.FORK:return[3,1];case To.USER:return[3,4];case To.PM_USER:return[3,7];case Eo.SIGN_OUT:return[3,10];case Eo.SWITCH_ACCOUNT:return[3,12];case To.STATE:return[3,14];case Eo.DISCONNECT:return[3,15];case Eo.CONNECTING:return[3,16];case Eo.CONNECT:return[3,17];case Po.FORGET_ERROR:return[3,19];case Po.LOG:return[3,20];case Oo.PROXY:return[3,21];case ko.BYPASS_LIST:return[3,22]}return[3,23];case 1:return r=xl,o=[e.tabId],[4,ff(e)];case 2:return[4,r.apply(void 0,o.concat([f.sent()]))];case 3:return f.sent(),[2,null];case 4:case 7:return[4,vi()];case 5:if(!(null===(i=f.sent())||void 0===i?void 0:i.uid))throw new Error("No session");return[4,Xc()];case 6:case 9:return[2,f.sent()];case 8:if(!(null===(a=f.sent())||void 0===a?void 0:a.uid))throw new Error("No session");return[4,(d=!0,void 0===d&&(d=!1),Gc(void 0,void 0,void 0,(function(){var e,t,n;return qc(this,(function(r){switch(r.label){case 0:return[4,vi()];case 1:return(null===(n=r.sent())||void 0===n?void 0:n.uid)?[4,ma()]:[2,void 0];case 2:r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,Fc()];case 4:return(e=r.sent())||!d?[2,e]:[3,6];case 5:if(t=r.sent(),!d||!da(t))throw t;return[3,6];case 6:return[4,Pi()];case 7:return r.sent(),[4,Fc()];case 8:return[2,r.sent()]}}))})))];case 10:return Iu(!0),[4,Ql()];case 11:case 13:case 18:return f.sent(),[3,23];case 12:return Iu(!1),[4,Ql()];case 14:return[2,Zu().data];case 15:return Du(),[3,23];case 16:return null===(c=(s=Zu()).checkConnectingState)||void 0===c||c.call(s,n.connectionAttemptTime),[3,23];case 17:return[4,Nu(n.logical,n.server,n.bypassList)];case 19:return delete Zu().data.error,[3,23];case 20:return $o(n),[3,23];case 21:return el(),[3,23];case 22:return null===(l=(u=Zu()).setOption)||void 0===l||l.call(u,t,n),[3,23];case 23:return[2,void 0]}var d}))}))},vf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},yf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},bf=function(e){return vf(void 0,void 0,void 0,(function(){var t;return yf(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,hf(e)];case 1:return[2,n.sent()];case 2:return(t=n.sent())instanceof _i?(Iu(!1),[4,Ql()]):[3,4];case 3:return n.sent(),[2,{error:t}];case 4:return[2,{error:t}];case 5:return[2]}}))}))},mf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},gf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},wf=function(){var e=0,t=new Date,n=is()?Ko.fromHours(1):Ko.fromMinutes(15);qi(n,n/5,(function(){return mf(void 0,void 0,void 0,(function(){var n,r,o;return gf(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),n=Ii,r=["logicalUpdate"],[4,cc(void 0,void 0,void 0,(function(){var e,t,n,r;return uc(this,(function(o){switch(o.label){case 0:return[4,fc.get()];case 1:return e=o.sent(),t=ec(e),!e||t>cs()?[4,hc(e)]:[3,3];case 2:return[2,o.sent()];case 3:return[4,_s("vpn/loads")];case 4:return n=o.sent().LogicalServers,r={},n.forEach((function(e){r[e.ID]=e})),e.value.forEach((function(e){r[e.ID]&&bc(Object.assign(e,r[e.ID]))})),[4,fc.set(e)];case 5:return o.sent(),[2,e.value]}}))}))];case 1:return n.apply(void 0,r.concat([i.sent()])),t=new Date,e=0,[3,3];case 2:return o=i.sent(),++e>5&&Ho("Loagical load update failed after "+e+" attempts, last update was ",t,o),[3,3];case 3:return[2]}}))}))}))},_f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},xf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sf=function(e){return _f(void 0,void 0,void 0,(function(){return xf(this,(function(t){switch(t.label){case 0:return Sa("loggedOut"),Ls(),[4,Kc(!0)];case 1:return t.sent()?e?[4,Lu({server:e})]:[3,3]:[2];case 2:case 4:return t.sent(),[2];case 3:return Cu(),[4,Mu()]}}))}))},Ef=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},kf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Of=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Pf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Oa("background"),si(),Fa(),n.g.browser||(n.g.browser=chrome),browser.runtime.onMessage.addListener((function(e){var t=new Promise((function(t){return vf(void 0,void 0,void 0,(function(){var n;return yf(this,(function(r){switch(r.label){case 0:return[4,bf(e)];case 1:return n=r.sent(),t({received:!0,success:!n||!("object"==typeof n&&n.error),result:n}),[2]}}))}))}));if("broadcast"!==e.respondTo)return t;t.then((function(t){ui(browser.runtime.sendMessage(browser.runtime.id,{type:"answer:"+e.requestId,respondTo:"none",data:function(){try{return JSON.parse(JSON.stringify(t))}catch(e){return{result:{error:"".concat(e)}}}}()}))}))})),browser.runtime.onMessageExternal.addListener((function(e){return vf(void 0,void 0,void 0,(function(){return yf(this,(function(t){switch(t.label){case 0:return e.type!==Po.FORK?[3,2]:[4,ff(e)];case 1:return[2,t.sent()];case 2:return[2]}}))}))})),setTimeout((function(){return Ef(void 0,void 0,void 0,(function(){var e,t,n;return kf(this,(function(r){switch(r.label){case 0:return Bo("Init state",(new Error).stack),[4,new Promise((function(e){Wu?e():(Ku.push(e),Zu())}))];case 1:return r.sent(),[4,ns.get()];case 2:if(e=null===(n=r.sent())||void 0===n?void 0:n.value,Bo(e),e?Au():Ru())return[3,6];Bo(e?"Not connected":"Not logged in"),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,Sf(e)];case 4:return r.sent(),[3,6];case 5:return t=r.sent(),Ii("changeState",{state:"disconnected",server:void 0,error:t}),[3,6];case 6:return setInterval((function(){return ci((function(){var e,t;null===(t=(e=Zu()).refreshState)||void 0===t||t.call(e)}))}),Ko.fromSeconds(1)),function(){var e,t=function(){bs().catch((function(e){(e instanceof _i||e.logout)&&Iu(!1)}))},n=as();qi(n,n/10,t),null===(e=navigator.connection)||void 0===e||e.addEventListener("change",t)}(),wf(),[2]}}))}))}),1),el(),ui(Kr(void 0,void 0,void 0,(function(){var e,t;return Xr(this,(function(n){switch(n.label){case 0:if("en_US"===(e=ho()))return uo(e,{}),[2];n.label=1;case 1:return n.trys.push([1,3,,8]),[4,lo(e)];case 2:return n.sent(),[3,8];case 3:if(n.sent(),(t=po(e.split("_")[0]||""))===e)return uo(e,{}),[2];n.label=4;case 4:return n.trys.push([4,6,,7]),[4,lo(t)];case 5:return n.sent(),[3,7];case 6:return n.sent(),uo("en_US",{}),[3,7];case 7:return[3,8];case 8:return[2]}}))}))),browser.runtime.onInstalled.addListener((function(e){return tl(void 0,void 0,void 0,(function(){var t;return nl(this,(function(n){switch(n.label){case 0:return"install"===e.reason?[3,1]:[3,3];case 1:return t=browser.runtime.getURL("/onboarding.html"),[4,browser.tabs.create({url:t})];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))})),browser.idle.onStateChanged.addListener((function(e){return Of(void 0,void 0,void 0,(function(){var t,n,r,o,i;return Pf(this,(function(a){switch(a.label){case 0:return function(e){Pa=e}(e),"active"!==e?[2]:"on"===(null==(t=Zu())?void 0:t.name)||-1!==(null===(o=null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.error)||void 0===o?void 0:o.httpStatus)?[3,3]:[4,ns.get()];case 1:return(n=null===(i=a.sent())||void 0===i?void 0:i.value)?[4,Lu({server:n})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}))}()}();