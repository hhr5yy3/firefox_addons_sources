(()=>{var e={636:function(e){
/*! For license information please see gmodal.js.LICENSE.txt */
"undefined"!=typeof self&&self,e.exports=(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};return(()=>{function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},s.apply(this,arguments)}e.d(t,{default:()=>g});const i={checkScrollbar:function(){return window.innerWidth>document.documentElement.clientWidth},getScrollbarWidth:function(){var e=document.createElement("div");e.style.cssText="\n      width: 100px;\n      height: 100px;\n      overflow: scroll;\n      position: absolute;\n      top: -9999px;\n    ",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},isVisible:function(e){if("none"===e.style.display)return!1;var t=e.getBoundingClientRect();return t&&t.width>0&&t.height>0},emulateTransitionEnd:function(e,t){void 0===t&&(t=150);var s=!1,i=this.transitionEnd();e.addEventListener(i,(function e(t){this.removeEventListener(t.type,e),s=!0})),setTimeout((function(){if(!s){var t=document.createEvent("HTMLEvents");t.initEvent(i,!1,!1),e.dispatchEvent(t)}}),t)},transitionEnd:function(){var e={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd"},t=document.documentElement;for(var s in e)if(void 0!==t.style[s])return e[s];return!1},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=window.getComputedStyle(e)["transition-duration"],s=window.getComputedStyle(e)["transition-delay"],i=parseFloat(t),n=parseFloat(s);return i||n?(t=t.split(",")[0],s=s.split(",")[0],1e3*(parseFloat(t)+parseFloat(s))):0},customTrigger:function(e,t,i){var n;void 0===i&&(i={}),"CustomEvent"in window&&"function"==typeof window.CustomEvent?n=new CustomEvent(e,{detail:s({},i)}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,s({},i)),t.dispatchEvent(n)},onceTransitionEnd:function(e,t,s,i){void 0===i&&(i=!1),e.addEventListener(t,(function t(n){n.target===e&&(e.removeEventListener(n.type,t,i),s.call(this,n))}),i)}};function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},n.apply(this,arguments)}function o(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a="gmodal-open",r="is-shown",l="is-hidden",c="has-animate",d={stickySelectors:[],animation:!0,backdrop:!0,closeBackdrop:!0,keyboard:!0},h=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'].join(","),u=function(){function e(e,t){return void 0===t&&(t={}),!!e&&(this._modal="string"==typeof e?document.querySelector(e):e,this._modal instanceof Element&&(this._modal.instance?this._modal.instance:(this._modal.instance=this,this._modal.tabIndex="-1",this._isOpen=!1,this._isTransitiong=!1,this._settings=n({},d,t),this._transitionEndEvent=i.transitionEnd(),void this._init())))}var t,s,u=e.prototype;return u._init=function(){this._body=document.body,this._modalContainer=this._modal.querySelector(".gmodal__container"),this._modalDialog=this._modal.querySelector(".gmodal__dialog"),this._modalDismiss=Array.prototype.slice.call(this._modal.querySelectorAll('[data-gmodal="dismiss"]')),this._scrollbarWidth=0,this._settings.animation&&this._modal.classList.add(c),this._observerCallback=this._observerCallback.bind(this),this._observer=new MutationObserver(this._observerCallback),this._observer.observe(this._modalDialog,{childList:!0,subtree:!0,attributes:!0}),this._attachEvents()},u._observerCallback=function(e){var t=e[0];(t.addedNodes.length||t.removedNodes.length||"attributes"===t.type)&&this._focusable()},u._stickySelectorsArray=function(){return Array.isArray(this._settings.stickySelectors)?this._settings.stickySelectors.reduce((function(e,t){var s=Array.prototype.slice.call(document.querySelectorAll(t));return e.push.apply(e,s),e}),[]):[]},u._attachEvents=function(){var e=this;this._closeHandler=function(t){t.preventDefault(),t.stopPropagation(),e.close()},this._clickOutside=function(t){e._ignoreBackdropClick?e._ignoreBackdropClick=!1:e._modalDialog.contains(t.target)||e.close()},this._dialogMouseDown=function(){e._modal.addEventListener("mouseup",(function t(s){e._modal.removeEventListener("mouseup",t),s.target===e._modal&&(e._ignoreBackdropClick=!0)}))},this._modalDismiss.forEach((function(t){t.addEventListener("click",e._closeHandler)})),this._settings.closeBackdrop&&(this._modal.addEventListener("click",this._clickOutside),this._modalDialog.addEventListener("mousedown",this._dialogMouseDown)),this._settings.keyboard&&(this._keyHandler=this._keyHandler.bind(this),this._modal.addEventListener("keydown",this._keyHandler))},u._dettachEvents=function(){var e=this;this._settings.closeBackdrop&&(this._modal.removeEventListener("click",this._clickOutside),this._modalDialog.removeEventListener("mousedown",this._dialogMouseDown)),this._modalDismiss.forEach((function(t){t.removeEventListener("click",e._closeHandler)})),this._settings.keyboard&&this._modal.removeEventListener("keydown",this._keyHandler)},u._focusable=function(){this._focusableEls=Array.prototype.slice.call(this._modal.querySelectorAll(h)).filter((function(e){return i.isVisible(e)})),this._focusableElFirst=this._focusableEls[0],this._focusableElLast=this._focusableEls[this._focusableEls.length-1]},u._keyHandler=function(e){var t=this;switch(e.which){case 9:if(0===this._focusableEls.length){e.preventDefault();break}e.shiftKey?document.activeElement!==t._focusableElFirst&&document.activeElement!==t._modal||(e.preventDefault(),t._focusableElLast.focus()):document.activeElement===t._focusableElLast&&(e.preventDefault(),t._focusableElFirst.focus());break;case 27:e.stopPropagation(),this.close()}},u._createBackdrop=function(){var e=document.createElement("div");return e.className="gmodal-backdrop",this._settings.animation&&(e.className+=" has-animate"),document.body.appendChild(e),e},u._setScrollOffset=function(){var e=this;if(this._hasScrollbar){this._scrollbarWidth=i.getScrollbarWidth();var t=this._body.style.paddingRight,s=parseFloat(getComputedStyle(this._body).paddingRight);t&&this._body.setAttribute("data-gmodal-padding",t),this._body.style.paddingRight=s+this._scrollbarWidth+"px",this._stickySelectorsArray().forEach((function(t){var s=t.style.marginRight,i=parseFloat(getComputedStyle(t).marginRight);s&&t.setAttribute("data-gmodal-margin",s),t.style.marginRight=i+e._scrollbarWidth+"px"}))}},u._resetScrollOffset=function(){this._hasScrollbar&&(this._body.style.paddingRight=this._body.getAttribute("data-gmodal-padding")||"",this._body.removeAttribute("data-gmodal-padding"),this._stickySelectorsArray().forEach((function(e){e.style.marginRight=e.getAttribute("data-gmodal-margin")||"",e.removeAttribute("data-gmodal-margin")})))},u._adjustModal=function(){this._scrollbarWidth=i.getScrollbarWidth(),this._modal.style.overflow="hidden",this._modal.style.marginRight=this._scrollbarWidth+"px"},u._resetAdjustModal=function(){this._modal.style.overflow="",this._modal.style.marginRight=""},u._hideBackdrop=function(){var e=this;if(this._backdrop)if(this._backdrop.classList.remove(r),this._settings.animation){var t=i.getTransitionDurationFromElement(this._backdrop);i.onceTransitionEnd(this._backdrop,this._transitionEndEvent,(function(){var t,s;null!=(t=e._backdrop)&&t.parentNode&&(null==(s=e._backdrop.parentNode)||s.removeChild(e._backdrop))})),i.emulateTransitionEnd(this._backdrop,t)}else this._backdrop.parentNode&&this._backdrop.parentNode.removeChild(this._backdrop)},u._hideModal=function(){if(1===this.modalsLength&&(this._body.classList.remove(a),this._resetScrollOffset()),this._modal.style.display="",this._isTransitiong=!1,this.modalsLength){var t=e.modals[this.modalsLength-1].focusEl;setTimeout((function(){null==t||t.focus()}),0)}e.modals.pop(),this.modalsLength&&e.modals[this.modalsLength-1].item.element.classList.remove(l),this._isOpen&&i.customTrigger("gmodal:close",this._modal),this._isOpen=!1},u.open=function(){var t=this;if(this._modal&&!this._isOpen&&!this._isTransitiong){this._isOpen=!0,this._focusableSave=document.activeElement,this.modalsLength||(this._hasScrollbar=i.checkScrollbar(),this._body.classList.add(a),this._setScrollOffset(),this._settings.backdrop&&(this._backdrop=this._createBackdrop(this))),i.customTrigger("gmodal:beforeopen",this._modal),this._modal.style.display="block",this._isTransitiong=!0,this._modal.scrollTop=0,this.modalsLength&&e.modals.forEach((function(e){e.item.element.classList.add(l)})),e.modals.push({item:this._modal.instance,focusEl:this._focusableSave}),setTimeout((function(){t._backdrop&&t._backdrop.classList.add(r),t._modal.classList.add(r)}),20);var s=function(){t._isTransitiong=!1,t._focusable(),t._modal.focus(),i.customTrigger("gmodal:open",t._modal)};if(this._settings.animation){this._adjustModal();var n=i.getTransitionDurationFromElement(this._modalContainer);i.onceTransitionEnd(this._modalContainer,this._transitionEndEvent,(function(){t._resetAdjustModal(),s()})),i.emulateTransitionEnd(this._modalContainer,n)}else s()}},u.close=function(e){if(void 0===e&&(e=!1),this._modal&&this._isOpen&&!this._isTransitiong)if(i.customTrigger("gmodal:beforeclose",this._modal),this._modal.classList.remove(r),this._hideBackdrop(),this._isTransitiong=!0,this._settings.animation&&!e){var t=i.getTransitionDurationFromElement(this._modalContainer);i.onceTransitionEnd(this._modalContainer,this._transitionEndEvent,this._hideModal.bind(this)),i.emulateTransitionEnd(this._modalContainer,t)}else this._hideModal()},e.closeAll=function(){if(this.modals.length){var e=!1,t=this.modals[0].item._hasScrollbar;this.modals.slice().reverse().forEach((function(s,i){0===i?s.item._hasScrollbar=t:e=!0,s.item.close(e)}))}},u.destroy=function(){var e=this;this._modal&&(this._isOpen=!1,this._observer&&this._observer.disconnect(),this._backdrop&&this._backdrop.parentNode&&this._backdrop.parentNode.removeChild(this._backdrop),this._hideModal(),this._modal.classList.remove(c,r),this._dettachEvents(),delete this._modal.instance,Object.keys(this).forEach((function(t){delete e[t]})))},t=e,(s=[{key:"element",get:function(){return this._modal}},{key:"modalsLength",get:function(){return e.modals.length}}])&&o(t.prototype,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();u.modals=[];const g=u})(),t.default})()},961:e=>{
/*!
 * @author ivan.kuzmichov@gmail.com
 * @source https://github.com/k-ivan/tabs-slider
 * @description Simple tabs slider in pure JavaScript
 * @license MIT
 */
window,e.exports=function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){s(1),e.exports=s(2)},function(e,t,s){},function(e,t,s){"use strict";function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e}).apply(this,arguments)}s.r(t),s.d(t,"default",(function(){return n}));class n{constructor(e,t){if("string"==typeof e&&(e=document.querySelector(e)),!(e instanceof HTMLElement))throw Error("Check the argument of the selector");this.tabs=e,this.tabs&&!this.tabs.activated&&(this.tabs.activated=!0,this.tabs.setAttribute("data-tabs-active",""),this.settings=i({animate:!0,slide:0,rtl:!1,draggable:!0,underline:!0,heightAnimate:!0,duration:500,easing:"cubic-bezier(0.0, 0.0, 0.2, 1)"},t),this._init())}_dragEvent(){const e=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);return{start:e?"touchstart":"mousedown",move:e?"touchmove":"mousemove",end:e?"touchend":"mouseup",leave:"mouseleave"}}_init(){this.tabsBarWrap=this.tabs.querySelector(".tabs__bar-wrap"),this.bar=this.tabs.querySelector(".tabs__bar"),this.content=this.tabs.querySelector(".tabs__content"),this.controls=Array.prototype.slice.call(this.bar.querySelectorAll(".tabs__controls")),this.sections=Array.prototype.slice.call(this.content.querySelectorAll(".tabs__section")),this.offset=0,this.currentId=this.settings.slide,this.slidesLen=this.sections.length,this.tabsHasOverflow=!1,this.rtl=this.settings.rtl?1:-1,this.transformProperty="transform",this.transitionProperty="transition",this._dimmensions(),this.settings.underline&&this._setSliderLine(),this.settings.draggable&&(this.dragX,this.dragY,this.delta,this.target,this.dragFlag=!1,this.isMoving=!1,this.preventClick=!1),this._addEvents(),this._checkTabsOverflow(),this.show(this.currentId)}destroy(){this._removeEvents(),this.bar.removeChild(this.line),this.content.classList.remove("has-grab"),this.controls[this.currentId].classList.remove("is-active"),this.tabs.removeAttribute("data-tabs-active"),delete this.tabs.activated,Object.keys(this).forEach((e=>{delete this[e]}))}_addEvents(){this._handlerClick=this._selectTab.bind(this),this._handlerResize=this._responsive.bind(this),this._handlerTabFocus=this._handlerTabFocus.bind(this),this._handleTabOverflow=this._checkTabsOverflow.bind(this),this.bar.addEventListener("click",this._handlerClick),this.bar.addEventListener("scroll",this._handleTabOverflow),this.content.addEventListener("focus",this._handlerTabFocus,!0),window.addEventListener("resize",this._handlerResize),this.settings.draggable&&(this.handlerStart=this._start.bind(this),this.handlerMove=this._move.bind(this),this.handlerEnd=this._end.bind(this),this.handlerLeave=this._leave.bind(this),this.handlerLink=this._click.bind(this),this.dragEvent=this._dragEvent(),this.content.addEventListener(this.dragEvent.start,this.handlerStart,{passive:!1}),this.content.addEventListener(this.dragEvent.move,this.handlerMove,{passive:!1}),this.content.addEventListener(this.dragEvent.end,this.handlerEnd),this.content.addEventListener(this.dragEvent.leave,this.handlerLeave),this.content.addEventListener("click",this.handlerLink))}_removeEvents(){this.bar.removeEventListener("click",this._handlerClick),this.bar.removeEventListener("scroll",this._handleTabOverflow),this.content.removeEventListener("focus",this._handlerTabFocus,!0),window.removeEventListener("resize",this._handlerResize),this.settings.draggable&&(this.content.removeEventListener(this.dragEvent.start,this.handlerStart,{passive:!1}),this.content.removeEventListener(this.dragEvent.move,this.handlerMove,{passive:!1}),this.content.removeEventListener(this.dragEvent.end,this.handlerEnd),this.content.removeEventListener(this.dragEvent.leave,this.handlerLeave),this.content.removeEventListener("click",this.handlerLink))}_handlerTabFocus(e){const t=e.target.closest(".tabs__section");if(!t)return;this.tabs.scrollLeft=0,this.content.scrollTop=0,setTimeout((()=>{this.content.scrollTop=0,this.tabs.scrollLeft=0}),0);const s=this.sections.indexOf(t);this.show(s)}_setSliderLine(){this.line=i(document.createElement("span"),{className:"tabs__line"}),this.bar.appendChild(this.line),this._moveSliderLine(),this.settings.animate&&(this.line.style[this.transitionProperty]=`\n        ${this.transformProperty} ${this.settings.duration}ms ${this.settings.easing}\n      `)}_scrollLeft(e,{to:t=0,duration:s=150},i){const n=e.scrollLeft;if(n===t)return i&&i();const o=Date.now(),a=()=>{const r=Date.now(),l=Math.min(1,(r-o)/s);if(e.scrollLeft=l*(t-n)+n,l>=1)return i&&i();window.requestAnimationFrame(a)};window.requestAnimationFrame(a)}_moveSliderLine(){const{offsetWidth:e,offsetLeft:t}=this.controls[this.currentId];let s=`translate3d(${t}px, 0, 0)`;this.line.style.transform=`${s} scaleX(${e/this.w})`}_checkTabsOverflow(){this.tabsHasOverflow=this.bar.offsetWidth<this.bar.scrollWidth;const e=this.tabsHasOverflow&&this.bar.scrollWidth>this.bar.scrollLeft+this.bar.offsetWidth,t=this.bar.scrollLeft>0;this.tabsBarWrap.classList.toggle("has-right-overflow",e),this.tabsBarWrap.classList.toggle("has-left-overflow",t)}_observeTabInViewport(){if(!this.tabsHasOverflow)return;const e=this.controls[this.currentId],{offsetWidth:t,offsetLeft:s}=e;let i=this.bar.scrollLeft;s<=this.bar.scrollLeft?i=s:s+t>=this.bar.scrollLeft+this.bar.offsetWidth&&(i=this.bar.scrollLeft+this.bar.offsetWidth-t),this._scrollLeft(this.bar,{to:i},(()=>{this._checkTabsOverflow()}))}_dimmensions(){this.w=this.tabs.offsetWidth;const e=this.sections[this.currentId].offsetHeight;this.sections.forEach((e=>{e.style.width=this.w+"px"})),this.content.style.width=this.w*this.sections.length+"px",this.content.style.height=e+"px"}_responsive(){this._dimmensions(),this.offset=this.rtl*(this.w*this.currentId),this._moveSlide(this.offset,!1),this._checkTabsOverflow()}_selectTab(e){const t=e.target.closest(".tabs__controls");if(!t)return;e.preventDefault();const s=this.controls.indexOf(t);s!==this.currentId&&this.show(s)}_moveSlide(e,t=!0){if(this.settings.animate){let e=t?this.settings.duration:0,s=[`${this.transformProperty} ${e}ms ${this.settings.easing}`];this.settings.heightAnimate&&s.push(`height ${e}ms ${this.settings.easing}`),this.content.style[this.transitionProperty]=s.join(",")}this.content.style[this.transformProperty]=`translate3d(${e}px, 0, 0)`;const s=this.sections[this.currentId].offsetHeight;this.content.style.height=s+"px",this.settings.underline&&this._moveSliderLine()}_click(e){this.preventClick&&e.preventDefault(),this.preventClick=!1}_start(e){if(this.dragFlag)return;let t;e.targetTouches?(this.target=e.targetTouches[0].target,t=e.targetTouches[0]):(t=e,e.preventDefault()),this.delta=0,this.dragX=t.pageX||t.clientX,this.dragY=t.pageY||t.clientY,this.dragFlag=!0,this.content.classList.add("has-grab")}_move(e){if(!this.dragFlag)return;let t=e;if(e.targetTouches){if(e.targetTouches.length>1||this.target!==e.targetTouches[0].target)return;t=e.targetTouches[0]}else"A"===e.target.nodeName&&(this.preventClick=!0);const s=t.pageX||t.clientX,i=t.pageY||t.clientY;if(this.isMoving||(this.isMoving=Math.abs(this.dragX-s)>=Math.abs(this.dragY-i)),this.isMoving){if(e.preventDefault(),this.delta=(this.dragX-s)/2,!this.settings.animate)return;this._moveSlide(this.offset-this.delta,!1)}}_swipeTo(){return this.settings.rtl?this.delta>0?this.currentId-1:this.currentId+1:this.delta<0?this.currentId-1:this.currentId+1}_end(){if(!this.dragFlag)return;const e=this._swipeTo();if(this.isMoving=!1,this.content.classList.remove("has-grab"),Math.abs(this.delta)<20||e>this.slidesLen-1||e<0)return this.dragFlag=!1,void this._moveSlide(this.offset);this.dragFlag=!1,this.target=null,this.show(e)}_leave(){this.dragFlag&&(this._moveSlide(this.offset),this.dragFlag=!1,this.preventClick=!1,this.content.classList.remove("has-grab"))}recalcStyles(){this._responsive()}show(e){(e=Math.abs(e))>=this.slidesLen&&(e=this.slidesLen-1),this.controls[this.currentId].classList.remove("is-active");const t=this.currentId;this.currentId=e,this.offset=this.rtl*(this.w*this.currentId),this._moveSlide(this.offset),this.controls[this.currentId].classList.add("is-active");const s=new CustomEvent("tabChange",{detail:{currentIndex:this.currentId,prevIndex:t,currentSlide:this.sections[this.currentId],currentTab:this.controls[this.currentId]}});this.tabs.dispatchEvent(s),this._observeTabInViewport()}}}]).default}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,s),o.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=["avif","jpg","jpeg","webp","gif","png","svg","mp4"],t=5e7,i=(browser.i18n.getMessage("contextmenu_tab"),browser.i18n.getMessage("contextmenu_window"),browser.i18n.getMessage("contextmenu_incognito"),browser.i18n.getMessage("contextmenu_open_all"),browser.i18n.getMessage("contextmenu_open_all_window"),browser.i18n.getMessage("contextmenu_copy_link"),browser.i18n.getMessage("contextmenu_edit"),browser.i18n.getMessage("contextmenu_capture"),browser.i18n.getMessage("contextmenu_upload"),browser.i18n.getMessage("contextmenu_upload_paste"),browser.i18n.getMessage("delete_thumbnail"),browser.i18n.getMessage("contextmenu_remove"),[{title:"Bookmarks",value:"bookmarks"},{title:"Google",url:"https://www.google.com/search",name:"q",value:"google"},{title:"Bing",url:"https://bing.com/search",name:"q",value:"bing"},{title:"Yandex",url:"https://ya.ru/search/",name:"text",value:"yandex"},{title:"DuckDuckGo",url:"https://duckduckgo.com/",name:"q",value:"duckduckgo"},{title:"YouTube",url:"https://www.youtube.com/results",name:"search_query",value:"youtube"},{title:"Baidu",url:"https://www.baidu.com/s",name:"wd",value:"baidu"},{title:"Yahoo",url:"https://search.yahoo.com/search",name:"p",value:"yahoo"}]),n=(browser.runtime.getURL("newtab.html"),!0),o="1",a="toolbar_____";function r(e,t={},...s){const i=document.createElement(e);for(const e in t)null!=t[e]&&Object.prototype.hasOwnProperty.call(t,e)&&i.setAttribute(e,t[e]);if(s.length&&void 0!==s[0].html)i.innerHTML=s[0].html;else if(s.length){const e=document.createDocumentFragment();s.forEach((t=>{"string"==typeof t&&(t=document.createTextNode(t)),e.appendChild(t)})),i.appendChild(e)}return i}function l(e,t,s={}){const i=new Event(e,{...s});t.dispatchEvent(i)}function c(){return`id${Math.floor(Math.random()*Date.now()).toString(36)}`}class d extends HTMLElement{connectedCallback(){this.selectNode=r("select",{id:this.selectId,name:"folder",class:"form-control","aria-label":browser.i18n.getMessage("select_folder")}),this.insertAdjacentElement("afterbegin",this.selectNode),this.#e()}disconnectedCallback(){this.#t()}static get observedAttributes(){return["folder-id","parent-folder-id","bookmark-id"]}attributeChangedCallback(){this.#s()}#s(){this.folderId=this.getAttribute("folder-id"),this.parentFolderId=this.getAttribute("parent-folder-id")??null,this.bookmarkId=this.getAttribute("bookmark-id")??null}get selectId(){return this.getAttribute("select-id")}set folders(e){if(!this.selectNode)throw new Error("custom item must be in the DOM");const t=this.#i(e);this.selectNode.innerHTML=t.join("")}set value(e){setTimeout((()=>{this.selectNode.value=e}),0)}get value(){return this.selectNode.value}#i(e){const t=this.parentFolderId?this.parentFolderId:this.folderId,s=[],i=(e,n=0)=>{for(let o of e)if(this.bookmarkId!==o.id&&o.parentId!==this.bookmarkId){let e="-".repeat(n);n>0&&(e=`&nbsp;&nbsp;${e}&nbsp;`);const a=`${e} ${o.title}`;s.push(`<option${o.id===t?" selected":""} value="${o.id}">${a}</option>`),o.children.length&&i(o.children,n+1)}};return i(e),s}#e(){this.handleSelect=this.#n.bind(this),this.handleHashChange=this.#o.bind(this),this.selectNode.addEventListener("change",this.handleSelect),document.addEventListener("changeFolder",this.handleHashChange)}#t(){this.selectNode.removeEventListener("change",this.handleSelect),document.removeEventListener("changeFolder",this.handleHashChange)}#o(e){this.value=e?.detail?.folderId}#n(e){this.dispatchEvent(new CustomEvent("vb:select:change",{detail:e.target.value,bubbles:!0,cancelable:!0}))}}window.customElements.define("vb-select-folders",d);var h=s(636),u=s.n(h),g=s(961),p=s.n(g);const m={local:{get:e=>browser.storage.local.get(e),set:e=>browser.storage.local.set(e),remove:e=>browser.storage.local.remove(e)},sync:{get:e=>browser.storage.sync.get(e),set:e=>browser.storage.sync.set(e),remove:e=>browser.storage.sync.remove(e)}},b=Object.freeze({color_theme:"os",background_image:"background_noimage",background_external:"",default_folder_id:n?a:o,dial_columns:7,dial_width:70,vertical_center:!1,drag_and_drop:!0,auto_generate_thumbnail:!0,enable_sync:!1,show_toolbar:!0,show_contextmenu_item:!0,show_settings_icon:!0,show_back_column:!0,show_create_column:!0,show_bookmark_title:!0,show_favicon:!0,open_link_newtab:!1,thumbnails_update_button:!0,thumbnails_update_recursive:!1,thumbnails_update_delay:.5,custom_style:"",without_confirmation:!1,services_enable:!1,services_list:[{id:c(),name:"youtube",link:"https://www.youtube.com"},{id:c(),name:"search",link:"https://google.com"},{id:c(),name:"translate",link:"https://translate.google.com"},{id:c(),name:"gmail",link:"https://mail.google.com/mail"},{id:c(),name:"drive",link:"https://drive.google.com/"},{id:c(),name:"photos",link:"https://photos.google.com"}],folder_preview:!1,close_tab_after_adding_bookmark:!1,logo_external:!1,logo_external_url:"https://logo.clearbit.com/{{website}}",search_engine:"bookmarks",move_to_start:!1,sort_by_date:!1,bookmarks_sorting_type:"",search_autofocus:!1,enable_virtual_pagination:!1}),_=["default_folder_id","enable_sync"],v=(()=>{let e={};return{get $(){return e},async init(){let{settings:t}=await m.local.get("settings");if(t?Object.assign(e,b,t):(t=Object.assign({},b),m.local.set({settings:t})),t.enable_sync){const{settings:e}=await m.sync.get("settings");Object.assign(t,e)}Object.assign(e,t)},async updateKey(t,s){if(!e)throw Error("Settings store must be initialized with the init method");e[t]=s,await m.local.set({settings:e}),e.enable_sync&&(_.includes(t)||this.syncToStorage())},async updateAll(t={}){Object.assign(e,t),await m.local.set({settings:e})},syncToStorage(){const t=JSON.parse(JSON.stringify(e));_.forEach((e=>delete t[e])),m.sync.set({settings:t})},async restoreFromSync(){let{settings:t}=await m.sync.get("settings");Object.assign(e,t),m.local.set({settings:e})},async resetLocal(){e=Object.assign({},b),await m.local.set({settings:e})},resetSync:()=>new Promise((e=>{browser.storage.sync.clear(e)}))}})();const f=function(){let e,t={},s=!1;function i(e,t){if(1!==t.which)return!0;const s=t.composedPath()[0].closest(e);if(!s)return;const i=getComputedStyle(s).position;s.classList.add("ripple-container"),"fixed"!==i&&"absolute"!==i&&(s.style.position="relative");const o=s.getAttribute("data-ripple-color")||"rgba(0,0,0, .3)",a=s.hasAttribute("data-ripple-center"),{width:r,height:l,left:c,top:d}=s.getBoundingClientRect();let h=t.clientX-c,u=t.clientY-d;const g=Math.max(r,l),p=g/2,m=function(e){const t=Object.assign(document.createElement("span"),{className:"ripple"});return e.appendChild(t),e.removeEventListener("mouseleave",n),e.removeEventListener("mouseup",n),e.removeEventListener("dragend",n),e.addEventListener("mouseleave",n),e.addEventListener("mouseup",n),e.addEventListener("dragend",n),t}(s);let b=`\n      top: ${a?"50%":u-p+"px"};\n      left: ${a?"50%":h-p+"px"};\n      width: ${g}px;\n      height: ${g}px;\n      background-color: ${o};\n    `;a&&(b+=`\n        margin-top: ${-p}px;\n        margin-left: ${-p}px;\n      `),m.setAttribute("style",b),setTimeout((()=>{m.style.cssText+="transform: scale(2.5); opacity: 0.5"}),10)}function n(){const e=this;if(!e)return;let t=null;const s=e.getElementsByClassName("ripple");if(!(s.length>0))return!1;t=s[s.length-1];const i=getComputedStyle(t)["transition-duration"],n=1e3*parseFloat(i);setTimeout((()=>{t.style.opacity=0,setTimeout((()=>{try{e.removeChild(t)}catch(e){return!1}s.length<1&&(e.style.position="")}),n)}),0)}return t.init=function(t){if(!s){if("string"!=typeof t)throw new Error("Selector must be a string");e=i.bind(null,t),document.body.addEventListener("mousedown",e),s=!0}},t.destroy=function(){s&&(document.body.removeEventListener("mousedown",e),e=null,s=!1)},t}(),w=f;const y=class{constructor(e,t=300){return!!e&&(this.el="string"==typeof e?document.querySelector(e):e,this.el instanceof Element&&(this.el.instance?this.el.instance:(this.el.instance=this,this.maxHeight=t,this.padding=this.getVerticalPadding(),this.initHeight=this.el.clientHeight-this.padding,this.inputHandler=this.inputHandler.bind(this),void this.el.addEventListener("input",this.inputHandler))))}getVerticalPadding(){const{paddingTop:e,paddingBottom:t}=window.getComputedStyle(this.el,null);return parseInt(e,10)+parseInt(t,10)}inputHandler(){let e=0;this.el.scrollHeight-this.padding>this.maxHeight?(this.el.style.overflowY="scroll",e=this.maxHeight):(this.el.style.overflowY="hidden",this.el.style.height="auto",e=this.el.scrollHeight-this.padding),this.initHeight>=e&&(e=this.initHeight),this.el.style.height=e+"px",function(e,t,s={}){const i=new CustomEvent(e,{...s});t.dispatchEvent(i)}("textarea-autosize",this.el,{height:e})}destroy(){this.el&&(this.el.removeEventListener("input",this.inputHandler),this.el.removeAttribute("style"),delete this.el.instance,Object.keys(this).forEach((e=>{delete this[e]})))}},k=(()=>{const e={position:"bottom-left",modClass:"",hideByClick:!0,delay:5e3,message:"",onClose:null},t={top:{el:s("top")},"top-left":{el:s("top-left")},"top-right":{el:s("top-right")},bottom:{el:s("bottom")},"bottom-left":{el:s("bottom-left")},"bottom-right":{el:s("bottom-right")}};function s(e){return r("div",{class:"toast-container toast-container"+(e?`--${e}`:"")})}return function(){const e=document.createDocumentFragment();Object.keys(t).forEach((s=>e.append(t[s].el))),document.body.append(e)}(),{show:function(s){let i=!1;const n={...e};"string"==typeof s?n.message=s:Object.assign(n,s);const o=r("div",{class:`toast toast--${n.position}`},{html:`<div class="toast__message">${n.message}</div>`}),a=e=>{if(!i){if(e){if(!e.target.closest(".toast__btn"))return;i=!0}o.classList.add("is-deleting"),o.removeEventListener("click",a),setTimeout((()=>{o.remove(),n.onClose?.()}),250)}};if(n.hideByClick){const e=r("button",{class:"toast__btn","aria-label":"Close"},{html:'<svg version="1.1" width="24" height="24" viewBox="0 0 24 24" fill="#000"><path d="M18.984 6.422l-5.578 5.578 5.578 5.578-1.406 1.406-5.578-5.578-5.578 5.578-1.406-1.406 5.578-5.578-5.578-5.578 1.406-1.406 5.578 5.578 5.578-5.578z"></path></svg>'});o.append(e),o.addEventListener("click",a)}const l=t[n.position];n.position.startsWith("top")?l.el.prepend(o):l.el.append(o),setTimeout((()=>{o.classList.add("toast-enter")}),16),n.delay&&setTimeout(a,n.delay)}}})(),E=k,L=r("div",{class:"gmodal gmodal--popup",id:"popup"},{html:`<div class="gmodal__container gmodal__container--popup has-center">\n  <div class="gmodal__dialog">\n    <div class="gmodal__header">\n      <div class="gmodal__title">${browser.i18n.getMessage("ext_name")}</div>\n      <button type="button" class="gmodal__close md-ripple" data-popup="reject" data-ripple-center>\n        <svg version="1.1" width="24" height="24" viewBox="0 0 24 24" fill="#000">\n          <path d="M18.984 6.422l-5.578 5.578 5.578 5.578-1.406 1.406-5.578-5.578-5.578 5.578-1.406-1.406 5.578-5.578-5.578-5.578 1.406-1.406 5.578 5.578 5.578-5.578z"></path>\n        </svg>\n      </button>\n    </div>\n    <div class="gmodal__body" id="popupBody"></div>\n    <div class="gmodal__footer text-right">\n      <button type="button" class="btn btn--clear md-ripple" data-popup="reject">${browser.i18n.getMessage("btn_close")}</button>\n      <button type="button" class="btn md-ripple" data-popup="resolve">Ok</button>\n    </div>\n  </div>\n</div>`});const M=function(e){let t=!1;document.body.appendChild(L);const s=document.getElementById("popupBody"),i=Array.from(L.querySelectorAll("[data-popup]")),n=L.querySelector('[data-popup="resolve"]'),o=new(u())(L,{closeBackdrop:!1});return o.element.addEventListener("gmodal:open",(()=>{n.focus()})),s.textContent=e,o.open(),new Promise((e=>{const s=function(){const e=this.dataset.popup;t="resolve"===e,o.close()},n=function(){i.forEach((e=>{e.removeEventListener("click",s)})),o.element.removeEventListener("gmodal:close",n),e(!!t),t=!1,o.destroy(),L.remove()};i.forEach((e=>{e.addEventListener("click",s)})),o.element.addEventListener("gmodal:close",n)}))},x=browser.bookmarks,T=e=>e.reduce(((e,t)=>(t.children&&e.push({title:t.title,id:t.id,parentId:t.parentId,children:T(t.children)}),e)),[]);class S{#a=null;#r=null;#l={value:null,postfix:"",format:!1,onInput:()=>{},onChange:()=>{},onBlur:()=>{}};#c;#d;constructor(e,t){if(!e)return;this.#a=e,this.#l=Object.assign({},this.#l,t),this.#c=this.#a.min||0,this.#d=this.#a.max||100;const{selectorOutput:s}=this.#a.dataset;this.#r=document.querySelector(s);const i=this.#l.value?this.#l.value:this.#a.value;this.#h(i),this.#u(i),this.#e()}#e(){this.handleInput=this.#g.bind(this),this.handleChange=this.#p.bind(this),this.handleBlur=this.#m.bind(this),this.#a.addEventListener("input",this.handleInput),this.#a.addEventListener("change",this.handleChange),this.#a.addEventListener("blur",this.handleBlur)}#u(e){const t=~~((e-this.#c)/(this.#d-this.#c)*100);this.#a.style.setProperty("--range-track-fill",`${t}%`)}#h(e){this.#r&&("function"==typeof this.#l.format&&(e=this.#l.format(e)),this.#r.textContent=`${e}${this.#l.postfix}`)}#g(e){this.#u(e.target.value),this.#h(e.target.value),this.#l.onInput(e)}#p(e){this.#u(e.target.value),this.#h(e.target.value),this.#l.onChange(e)}#m(e){this.#l.onBlur(e)}}const O=(e,t)=>t.some((t=>e instanceof t));let B,I;const C=new WeakMap,j=new WeakMap,D=new WeakMap,$=new WeakMap,A=new WeakMap;let H={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return j.get(e);if("objectStoreNames"===t)return e.objectStoreNames||D.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return P(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function F(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(I||(I=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(N(this),t),P(C.get(this))}:function(...t){return P(e.apply(N(this),t))}:function(t,...s){const i=e.call(N(this),t,...s);return D.set(i,t.sort?t.sort():[t]),P(i)}}function R(e){return"function"==typeof e?F(e):(e instanceof IDBTransaction&&function(e){if(j.has(e))return;const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",o),e.removeEventListener("abort",o)},n=()=>{t(),i()},o=()=>{s(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",o),e.addEventListener("abort",o)}));j.set(e,t)}(e),O(e,B||(B=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,H):e)}function P(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,s)=>{const i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",o)},n=()=>{t(P(e.result)),i()},o=()=>{s(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&C.set(t,e)})).catch((()=>{})),A.set(t,e),t}(e);if($.has(e))return $.get(e);const t=R(e);return t!==e&&($.set(e,t),A.set(t,e)),t}const N=e=>A.get(e);const W=["get","getKey","getAll","getAllKeys","count"],q=["put","add","delete","clear"],z=new Map;function U(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(z.get(t))return z.get(t);const s=t.replace(/FromIndex$/,""),i=t!==s,n=q.includes(s);if(!(s in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!W.includes(s))return;const o=async function(e,...t){const o=this.transaction(e,n?"readwrite":"readonly");let a=o.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[s](...t),n&&o.done]))[0]};return z.set(t,o),o}H=(e=>({...e,get:(t,s,i)=>U(t,s)||e.get(t,s,i),has:(t,s)=>!!U(t,s)||e.has(t,s)}))(H);class V{static DB_NAME="visual-bookmarks";static DB_VERSION=1;static DB_STORE="images";static DB=null;static async#b(){return this.DB=this.DB||await function(e,t,{blocked:s,upgrade:i,blocking:n,terminated:o}={}){const a=indexedDB.open(e,t),r=P(a);return i&&a.addEventListener("upgradeneeded",(e=>{i(P(a.result),e.oldVersion,e.newVersion,P(a.transaction),e)})),s&&a.addEventListener("blocked",(e=>s(e.oldVersion,e.newVersion,e))),r.then((e=>{o&&e.addEventListener("close",(()=>o())),n&&e.addEventListener("versionchange",(e=>n(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),r}(this.DB_NAME,this.DB_VERSION,{upgrade(e,t){if(0===t)e.createObjectStore(V.DB_STORE,{keyPath:"id",autoIncrement:!0})},blocking(){location.reload()}}),V.DB}static async deleteDB(){if(!this.DB)return!0;try{return await this.DB.close(),await function(e,{blocked:t}={}){const s=indexedDB.deleteDatabase(e);return t&&s.addEventListener("blocked",(e=>t(e.oldVersion,e))),P(s).then((()=>{}))}(this.DB_NAME),this.DB=null,!0}catch(e){return console.warn(e),!1}}static async clear(){try{const e=await this.#b();return await e.clear(this.DB_STORE),!0}catch(e){return console.warn(e),!1}}static async count(){try{const e=await this.#b();return await e.count(this.DB_STORE)}catch(e){console.warn(e)}}static async add(e){try{const t=(await this.#b()).transaction(this.DB_STORE,"readwrite"),s=e.map((e=>t.store.add(e).then((t=>({id:t,...e}))))),i=await Promise.all(s);return await t.done,i}catch(e){console.warn(e)}}static async get(e){try{const t=await this.#b();return await t.get(this.DB_STORE,e)}catch(e){console.warn(e)}}static async update(e){try{const t=await this.#b();return await t.put(this.DB_STORE,e)}catch(e){console.warn(e)}}static async delete(e){try{const t=await this.#b();return await t.delete(this.DB_STORE,e)}catch(e){console.warn(e)}}static async getAllByIds(e){try{const t=await this.#b();let s=await t.transaction(this.DB_STORE).store.openCursor();const i=[];for(;s;)e.includes(s.value.id)&&i.push(s.value),s=await s.continue();return i}catch(e){console.warn(e)}}}const Y=[{key:browser.i18n.getMessage("view_setting"),list:[{id:"dial_columns",title:browser.i18n.getMessage("number_of_columns"),type:"select",options:[{value:1,title:1},{value:2,title:2},{value:3,title:3},{value:4,title:4},{value:5,title:5},{value:6,title:6},{value:7,title:7},{value:8,title:8},{value:9,title:9},{value:10,title:10}]},{id:"dial_width",title:browser.i18n.getMessage("dial_width"),type:"range",min:50,max:99,step:1,data:{selectorOutput:"#dial_width_value",outputPostfix:"%"}},{id:"color_theme",title:browser.i18n.getMessage("color_theme"),type:"select",options:[{value:"dark",title:browser.i18n.getMessage("dark_theme")},{value:"light",title:browser.i18n.getMessage("light_theme")},{value:"os",title:browser.i18n.getMessage("os_theme")}]},{id:"vertical_center",title:browser.i18n.getMessage("vertical_center"),type:"switch"},{id:"logo_external",title:browser.i18n.getMessage("logo_external"),note:browser.i18n.getMessage("logo_external_note"),type:"switch"},{group:[{id:"show_toolbar",title:browser.i18n.getMessage("show_toolbar"),type:"switch"},...!n&&[{id:"search_autofocus",title:browser.i18n.getMessage("search_autofocus"),type:"switch"}]||[]]},{id:"show_settings_icon",title:browser.i18n.getMessage("show_settings_icon"),type:"switch"},{id:"show_back_column",title:browser.i18n.getMessage("show_back_column"),type:"switch"},{id:"show_create_column",title:browser.i18n.getMessage("show_create_column"),type:"switch"},{id:"show_bookmark_title",title:browser.i18n.getMessage("show_bookmark_title"),type:"switch"},{id:"show_favicon",title:browser.i18n.getMessage("show_favicon"),type:"switch"},{id:"background_image",title:browser.i18n.getMessage("background"),type:"select",options:[{value:"background_noimage",title:browser.i18n.getMessage("background_noimage")},{value:"background_external",title:browser.i18n.getMessage("background_external")},{value:"background_local",title:browser.i18n.getMessage("background_local")}]}]},{key:browser.i18n.getMessage("general_setting"),list:[{id:"default_folder_id",title:browser.i18n.getMessage("default_folder_id"),note:browser.i18n.getMessage("option_not_sync"),type:"vb-select-folders",options:[]},{id:"search_engine",title:browser.i18n.getMessage("search_engine"),type:"select",options:[]},{id:"services_enable",title:browser.i18n.getMessage("services_enable"),note:browser.i18n.getMessage("services_enable_description"),type:"switch"},{id:"folder_preview",title:browser.i18n.getMessage("folder_preview"),note:browser.i18n.getMessage("folder_preview_description"),type:"switch"},{group:[{id:"thumbnails_update_button",title:browser.i18n.getMessage("thumbnails_update_button"),note:browser.i18n.getMessage("thumbnails_update_warn"),type:"switch"},{id:"auto_generate_thumbnail",title:browser.i18n.getMessage("auto_generate_thumbnail"),type:"switch"},{id:"thumbnails_update_delay",title:browser.i18n.getMessage("thumbnails_update_delay"),note:browser.i18n.getMessage("thumbnails_update_delay_note"),type:"range",min:.5,max:15,step:.5,data:{selectorOutput:"#thumbnail_delay_output",outputPostfix:"s"}},{id:"thumbnails_update_recursive",title:browser.i18n.getMessage("thumbnails_update_recursive"),note:browser.i18n.getMessage("thumbnails_update_recursive_note",[browser.i18n.getMessage("thumbnails_update_button")]),type:"switch"}]},{id:"open_link_newtab",title:browser.i18n.getMessage("open_link_newtab"),type:"switch"},{id:"move_to_start",title:browser.i18n.getMessage("move_to_start"),type:"switch"},{id:"drag_and_drop",title:browser.i18n.getMessage("drag_and_drop"),type:"switch",data:{relationToggleId:"sort_by_date,bookmarks_sorting_type"}},{group:[{id:"sort_by_date",title:browser.i18n.getMessage("sort_by_date"),note:browser.i18n.getMessage("bookmarks_sorting_warning"),type:"switch",data:{relationToggleId:"drag_and_drop"}},{id:"bookmarks_sorting_type",title:browser.i18n.getMessage("bookmarks_sorting_type"),note:browser.i18n.getMessage("bookmarks_sorting_warning"),type:"select",data:{relationToggleId:"drag_and_drop",relationToggleValues:"folders_top,folders_bottom"},options:[{value:"",title:browser.i18n.getMessage("not_sorting")},{value:"folders_top",title:browser.i18n.getMessage("folders_on_top")},{value:"folders_bottom",title:browser.i18n.getMessage("folders_at_the_bottom")}]}]},{group:[{id:"show_contextmenu_item",title:browser.i18n.getMessage("show_contextmenu_item"),type:"switch"},{id:"close_tab_after_adding_bookmark",title:browser.i18n.getMessage("close_tab_after_adding_bookmark"),note:browser.i18n.getMessage("close_tab_after_adding_bookmark_note"),type:"switch"}]},{id:"enable_virtual_pagination",title:browser.i18n.getMessage("enable_virtual_pagination"),note:browser.i18n.getMessage("enable_virtual_pagination_note"),type:"switch"},{id:"enable_sync",title:browser.i18n.getMessage("enable_sync"),type:"switch"}]},{key:browser.i18n.getMessage("advanced_setting"),list:[{id:"without_confirmation",title:browser.i18n.getMessage("without_confirmation"),type:"switch"},{id:"clear_images",title:browser.i18n.getMessage("clear_background_locals"),type:"button",text:browser.i18n.getMessage("btn_apply")},{id:"restore_local",title:browser.i18n.getMessage("reset_local_default"),type:"button",text:browser.i18n.getMessage("btn_apply")},{id:"restore_sync",title:browser.i18n.getMessage("reset_sync_text"),type:"button",text:browser.i18n.getMessage("btn_apply")},{id:"custom_style",title:browser.i18n.getMessage("custom_style"),type:"textarea",spellcheck:!1,placeholder:browser.i18n.getMessage("placeholder_input_customstyle")},{id:"backup",title:browser.i18n.getMessage("backup_settings"),note:browser.i18n.getMessage("backup_settings_description"),type:"backup",import:{id:"import",accept:".backup"},export:{id:"export"}},{id:"toggle_clipboard_access",title:browser.i18n.getMessage("toggle_clipboard_access"),note:browser.i18n.getMessage("toggle_clipboard_access_description"),type:"switch"}]}];function K(e){const t=r("input",{id:e.id,type:"checkbox",name:e.id,class:"switch__input js-change"});Object.assign(t.dataset,e.data);const s=r("div",{class:"switch"},t,r("label",{class:"switch__label",for:e.id}));return"logo_external"===e.id?s.outerHTML+`<input\n    type="text"\n    name="logo_external_url"\n    id="logo_external_url"\n    class="form-control js-change"\n    placeholder="https://logo.clearbit.com/{{website}}"\n    spellcheck="false"\n    value=""\n    data-locale-message="external"\n    style="margin-top: 5px">\n    <small>${browser.i18n.getMessage("example_string","<code>https://logo.clearbit.com/{{website}}</code>")}</small>`:s.outerHTML}function X(e){const t=r("select",{id:e.id,name:e.id,class:"form-control js-change"},{html:e.options.map((e=>`<option value="${e.value}">${e.title}</option>`)).join("")});return Object.assign(t.dataset,e.data),"background_image"===e.id?t.outerHTML+`<div id="background_noimage" class="tbl__option js-background-settings js-change text-muted" hidden>${browser.i18n.getMessage("background_noimage_text")}</div>\n  <div id="background_local" class="tbl__option js-background-settings">\n    <div class="c-upload">\n      <form action="#0" method="post">\n        <input type="file" name="upload" id="bgFile" class="c-upload__input">\n        <label for="bgFile" class="c-upload__btn md-ripple">\n          <svg width="20" height="20" class="c-upload__icon"><use xlink:href="/img/symbol.svg#upload_outline"></use></svg>\n          <span class="c-upload__name" data-locale-message="choose_file">Изображение или видео</span>\n        </label>\n      </form>\n      <div class="c-upload__preview">\n        <div class="c-upload__remove">\n          <button class="md-ripple" data-ripple-center id="delete_upload">\n            <svg width="20" height="20"><use xlink:href="/img/symbol.svg#close"></use></svg>\n          </button>\n        </div>\n        <div id="preview_upload">\n          <div class="c-upload__preview-image"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <input type="url" id="background_external" name="external" class="form-control js-change tbl__option js-background-settings" placeholder="https://source.unsplash.com/1920x1080/daily?landscape" spellcheck="false">`:t.outerHTML}function J(e){const t=r("textarea",{class:"is-editor form-control js-change",name:e.id,id:e.id,spellcheck:e.spellcheck,placeholder:e.placeholder});return Object.assign(t.dataset,e.data),t.outerHTML}function G(e){const t=r("input",{type:e.type,class:"range__input js-range",id:e.id,name:e.id,min:e.min,max:e.max,step:e.step});Object.assign(t.dataset,e.data);return r("div",{class:"range"},t,r("span",{id:e.data.selectorOutput.replace("#","")})).outerHTML}function Q(e){return r("button",{class:"btn md-ripple",id:e.id},e.text).outerHTML}function Z(e){return r("vb-select-folders",{id:e.id,class:"js-change"}).outerHTML}function ee(e){return`<div class="btn-group btn-group--full">\n      <div class="c-upload btn">\n        <input type="file" name="import" id="${e.import.id}" class="c-upload__input" accept="${e.import.accept}">\n        <label for="${e.import.id}" class="c-upload__btn md-ripple"><span class="c-upload__name">${browser.i18n.getMessage(e.import.id)}</span></label>\n      </div>\n      <button class="btn md-ripple" id="${e.export.id}">${browser.i18n.getMessage(e.export.id)}</button>\n    </div>`}function te(e,t=!1){return`<div class="${t?"tbl__row":"tbl"}">\n    <div class="tbl__setting">\n      ${e.title}\n      ${e.note?`<div><small class="text-muted">${e.note}</small></div>`:""}\n    </div>\n    <div class="tbl__value">${function(e){let t;switch(e.type){case"switch":t=K;break;case"select":t=X;break;case"range":t=G;break;case"textarea":t=J;break;case"button":t=Q;break;case"vb-select-folders":t=Z;break;case"backup":t=ee}return t(e)}(e)}</div>\n  </div>`}let se=null,ie=null,ne=null,oe=null;function ae(e){const t=e.target;if(t.files&&t.files[0]){const e=new FileReader;e.addEventListener("load",(async e=>{try{const t=JSON.parse(e.target.result);await v.updateAll(t),function(e,t,s=[]){t=t||e,browser.notifications.create(t,{type:"basic",iconUrl:"icons/icon128.png",title:"Visual bookmarks",message:e,...!n&&{buttons:s}},(function(){}))}(browser.i18n.getMessage("import_settings_success")),setTimeout((()=>{location.reload()}),0)}catch(e){t.value="",E.show(browser.i18n.getMessage("import_settings_failed")),console.warn(e)}})),e.readAsBinaryString(t.files[0])}}function re(){const e=Object.keys(v.$).reduce(((e,t)=>(["default_folder_id","custom_dials","background_local"].includes(t)||(e[t]=v.$[t]),e)),{}),t=new Blob([JSON.stringify(e)],{type:"text/plain"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download="visual-bookmarks-settings.backup",s.click(),s.remove()}function le(){!async function(){const e=await function(){try{return x.getTree().then((e=>{const t=e[0].children.map((e=>e));return T(t)}))}catch(e){return Promise.reject(e)}}().catch((e=>console.warn(e)));if(e){const t=document.getElementById("default_folder_id");t.value=v.$.default_folder_id,t.folders=e}}(),document.getElementById("search_engine").innerHTML=i.map((e=>`<option value="${e.value}">${e.title}</option>`)).join(""),async function(){const e=document.getElementById("toggle_clipboard_access"),t=await async function({permissions:e,origins:t}){return await browser.permissions.contains({permissions:e,origins:t})}({permissions:["clipboardRead"]});e.checked=t,e.dataset.active=t}();document.getElementById("background_image").value=v.$.background_image,ce(v.$.background_image);document.getElementById("logo_external_url").value=v.$.logo_external_url;for(let e of Object.keys(v.$)){const t=document.getElementById(e);t&&t.type&&(/checkbox|radio/.test(t.type)?t.checked=v.$[e]:(t.value=v.$[e],"range"===t.type&&l("change",t),t===ne.el&&l("input",ne.el)))}}function ce(e){Array.from(document.querySelectorAll(".js-background-settings")).forEach((e=>{e.hidden=!0})),"background_local"===e&&(document.getElementById("preview_upload").innerHTML=oe?`<div class="c-upload__preview-image" style="background-image: url(${oe});"><div>`:"",document.querySelector(".c-upload__preview").hidden=!oe),document.getElementById(e).hidden=!1,ie.recalcStyles()}function de(e){const t=e.target.closest(".js-change");if(!t)return;const s=t.id;/checkbox|radio/.test(t.type)?v.updateKey(s,t.checked):v.updateKey(s,t.value),function(e){if(e.dataset.relationToggleId){const t=/checkbox|radio/,s=e.dataset.relationToggleId.split(","),i=t.test(e.type)?e.checked:e.value;s.forEach((s=>{const n=document.getElementById(s);if(t.test(n.type)&&n.checked){if("boolean"==typeof i)n.checked=!e.checked;else{const t=e.dataset.relationToggleValues.split(",");n.checked=!t.includes(i)}v.updateKey(s,n.checked)}else"SELECT"===n.tagName?n.selectedIndex=0:n.value="",v.updateKey(s,n.value)}))}}(t),"color_theme"===t.id&&window.vbToggleTheme()}async function he(){const s=this.closest("form"),i=this.files[0];if(!i)return;s.reset();const n=t<i.size;if(!e.some((e=>i.type.endsWith(e))))return E.show(browser.i18n.getMessage("alert_file_type_fail_type",[e.join(" | ")]));if(n)return E.show(browser.i18n.getMessage("alert_file_type_fail_size",[t/10**6]));s.classList.add("is-upload");const o=new Blob([new Uint8Array(await i.arrayBuffer())],{type:i.type}),a=i.type.startsWith("video")?await function(e,t=150){return new Promise(((s,i)=>{const n=URL.createObjectURL(e),o=document.createElement("video");o.src=n,o.muted=!0,o.currentTime=1,o.load(),o.onerror=i,o.onseeked=()=>{o.pause();const e=document.createElement("canvas"),i=e.getContext("2d");e.width=o.videoWidth*(t/o.videoHeight),e.height=t,i.drawImage(o,0,0,e.width,e.height),e.toBlob((e=>{s(e),URL.revokeObjectURL(n)}),"image/webp",.75)}}))}(i):await async function(e,t=500,s="high",i=.75){let n=await createImageBitmap(e);t&&n.height>t&&(n.close(),n=await createImageBitmap(e,{resizeHeight:t,resizeQuality:s}));const o=new OffscreenCanvas(n.width,n.height);return o.getContext("bitmaprenderer").transferFromImageBitmap(n),n.close(),o.convertToBlob({type:"image/webp",quality:i})}(o);oe&&URL.revokeObjectURL(oe),oe=URL.createObjectURL(a),V.update({id:"background",blob:o,blobThumbnail:a}),s.classList.remove("is-upload"),document.querySelector(".c-upload__preview").hidden=!1,document.getElementById("preview_upload").innerHTML=`<div class="c-upload__preview-image"\n            style="background-image: url(${oe});">\n          <div>`,E.show(browser.i18n.getMessage("notice_bg_image_updated")),ie.recalcStyles()}async function ue(e){if(!e.target.closest("#delete_upload"))return;if(!await M(browser.i18n.getMessage("confirm_delete_image")))return;e.preventDefault();const t=document.getElementById("preview_upload"),s=t.closest(".c-upload__preview");await V.delete("background"),oe&&(URL.revokeObjectURL(oe),oe=null),t.innerHTML="",s.hidden=!0,ie.recalcStyles(),E.show(browser.i18n.getMessage("notice_image_removed"))}function ge(){ce(this.value)}async function pe(e){e.preventDefault();await M(browser.i18n.getMessage("confirm_delete_images"))&&(await V.clear(),E.show(browser.i18n.getMessage("notice_images_removed")))}async function me(){await M(browser.i18n.getMessage("confirm_restore_default_settings"))&&(await v.resetLocal(),window.vbToggleTheme(),le(),E.show(browser.i18n.getMessage("notice_reset_default_settings")))}async function be(){await M(browser.i18n.getMessage("confirm_clear_sync_settings"))&&(await v.resetSync(),E.show(browser.i18n.getMessage("notice_sync_settings_cleared")))}function _e(){this.checked&&browser.storage.sync.getBytesInUse(null,(async e=>{if(e>0){await M(browser.i18n.getMessage("confirm_sync_remote_settings"))?(await v.restoreFromSync(),le(),window.vbToggleTheme()):(this.checked=!1,v.updateKey("enable_sync",!1))}else v.syncToStorage()}))}async function ve(e){e.preventDefault();const t=document.getElementById("toggle_clipboard_access");if("true"!==t.dataset.active){const e=await async function({permissions:e,origins:t}){return await browser.permissions.request({permissions:e,origins:t})}({permissions:["clipboardRead"]});t.dataset.active=e}else{const e=await async function({permissions:e}){return await browser.permissions.remove({permissions:e})}({permissions:["clipboardRead"]});t.dataset.active=!e}t.checked="true"===t.dataset.active}!async function(){document.documentElement.setAttribute("lang",browser.i18n.getMessage("@@ui_locale").replace("_","-")),window.settings.innerHTML=function(e){const t=[],s=[];return e.forEach((e=>{t.push(`<div class="tabs__controls md-ripple">${e.key}</div>`);const i=e?.list?.map((e=>e.group?`<div class="tbl">\n            ${e.group.map((e=>te(e,"row"))).join("")}\n          </div>`:te(e))).join("");s.push(`<div class="tabs__section">${i??""}</div>`)})),`<div class="tabs">\n      <div class="tabs__bar-wrap">\n        <div class="tabs__bar">\n          ${t.join("")}\n        </div>\n      </div>\n      <div class="tabs__content">\n        ${s.join("")}\n      </div>\n      <div class="tabs__footer">\n        <a href="newtab.html" id="save_btn" class="btn md-ripple">${browser.i18n.getMessage("btn_back")}</a>\n      </div>\n    </div>\n  `}(Y),await v.init(),window.vbToggleTheme(),function(e=null){const t=(e||document).querySelectorAll("[data-locale-message], [data-locale-html]");Array.prototype.slice.call(t).forEach((e=>{const t=e.getAttribute("data-locale-message")||e.getAttribute("data-locale-html");if(!t)return;const s=t.split(":");if(s.length>1){const t=s[1].split(",").map((e=>browser.i18n.getMessage(e)||e));e.hasAttribute("data-locale-html")?e.innerHTML=browser.i18n.getMessage(s[0],t):e.textContent=browser.i18n.getMessage(s[0],t)}else{const s=browser.i18n.getMessage(t.replace(/\..*/,""));if(!s)return;if(~t.indexOf("placeholder"))return void(e.placeholder=s);if(~t.indexOf(".aria-label"))return void e.setAttribute("aria-label",s);e.hasAttribute("data-locale-html")?e.innerHTML=s:e.textContent=s}}))}(),w.init(".md-ripple");const t=await V.get("background");t&&(oe=URL.createObjectURL(t.blobThumbnail)),Array.from(document.querySelectorAll(".js-range")).forEach((e=>{const t=e.id;new S(e,{value:v.$[t],postfix:e.dataset.outputPostfix,onBlur(e){const{value:s}=e.target;v.updateKey(t,s)},..."thumbnails_update_delay"===t&&{format:e=>parseFloat(e).toFixed(1)}})}));const s=document.querySelector(".tabs");ie=new(p())(s,{draggable:!1,slide:parseInt(localStorage.option_tab_slide)||0}),ne=new y("#custom_style"),se=new(u())(document.getElementById("modal"),{closeBackdrop:!1}),se.element.addEventListener("gmodal:open",(function(){m.local.remove("extension_updated")}));const i=browser.runtime.getManifest();document.getElementById("ext_name").textContent=i.name,document.getElementById("ext_version").textContent=`${browser.i18n.getMessage("version")} ${i.version}`,document.getElementById("modal_changelog_version").textContent=i.version,s.addEventListener("tabChange",(function(e){localStorage.option_tab_slide=e.detail.currentIndex})),ne.el.addEventListener("textarea-autosize",(function(){ie.recalcStyles()})),le(),document.querySelector(".tabs").addEventListener("change",de),document.getElementById("background_image").addEventListener("change",ge),document.getElementById("background_local").addEventListener("click",ue),document.getElementById("restore_local").addEventListener("click",me),document.getElementById("restore_sync").addEventListener("click",be),document.getElementById("enable_sync").addEventListener("change",_e),document.getElementById("clear_images").addEventListener("click",pe),document.getElementById("toggle_clipboard_access").addEventListener("change",ve),document.getElementById("export").addEventListener("click",re),document.getElementById("import").addEventListener("change",ae),document.getElementById("bgFile").addEventListener("change",he),document.getElementById("bgFile").setAttribute("accept",e.map((e=>`.${e}`)).join(", ")),document.querySelector(".info-btn").addEventListener("click",(()=>{se.open()})),"#changelog"===window.location.hash&&se.open()}()})()})();