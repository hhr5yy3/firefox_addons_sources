(()=>{"use strict";var e={576:function(e,t){var o,n=this&&this.__extends||(o=(e,t)=>(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((e,t)=>{e.__proto__=t})||((e,t)=>{for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}),o(e,t)),function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=()=>{};t.Option=r;var i=function(e){function o(t){var o=e.call(this)||this;return o.value=t,o}return n(o,e),o.prototype.exists=function(e){return e(this.value)},o.prototype.filter=function(e){return e(this.value)?this:t.none},o.prototype.filterNot=function(e){return e(this.value)?t.none:this},o.prototype.flatMap=function(e){return e(this.value)},o.prototype.fold=function(){var e=this;return t=>t(e.value)},o.prototype.forAll=function(e){return e(this.value)},o.prototype.forComprehension=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=this,n=0;n<e.length-1;++n)o=o.flatMap(e[n]);return o.map(e[e.length-1])},o.prototype.forEach=function(e){return e(this.value)},Object.defineProperty(o.prototype,"get",{get:function(){return this.value},enumerable:!0,configurable:!0}),o.prototype.getOrElse=function(){return this.value},o.prototype.getOrElseValue=function(){return this.value},Object.defineProperty(o.prototype,"isDefined",{get:()=>!0,enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isEmpty",{get:()=>!1,enumerable:!0,configurable:!0}),o.prototype.map=function(e){return s(e(this.value))},o.prototype.match=function(e){return e.some(this.value)},Object.defineProperty(o.prototype,"nonEmpty",{get:()=>!0,enumerable:!0,configurable:!0}),o.prototype.orElse=function(){return this},o.prototype.orElseValue=function(){return this},Object.defineProperty(o.prototype,"orNull",{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"orUndefined",{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"toArray",{get:function(){return[this.value]},enumerable:!0,configurable:!0}),o.prototype.toString=function(){return"Some("+this.value+")"},o}(r);t.Some=i;var l=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return n(o,e),o.prototype.exists=()=>!1,o.prototype.filter=function(){return this},o.prototype.filterNot=function(){return this},o.prototype.flatMap=()=>t.none,o.prototype.fold=e=>()=>e(),o.prototype.forAll=()=>!0,o.prototype.forComprehension=()=>t.none,o.prototype.forEach=()=>{},Object.defineProperty(o.prototype,"get",{get:()=>{throw new Error("No such element.")},enumerable:!0,configurable:!0}),o.prototype.getOrElse=e=>e(),o.prototype.getOrElseValue=e=>e,Object.defineProperty(o.prototype,"isDefined",{get:()=>!1,enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isEmpty",{get:()=>!0,enumerable:!0,configurable:!0}),o.prototype.map=()=>t.none,o.prototype.match=e=>e.none(),Object.defineProperty(o.prototype,"nonEmpty",{get:()=>!1,enumerable:!0,configurable:!0}),o.prototype.orElse=e=>e(),o.prototype.orElseValue=e=>e,Object.defineProperty(o.prototype,"orNull",{get:()=>null,enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"orUndefined",{get:()=>{},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"toArray",{get:()=>[],enumerable:!0,configurable:!0}),o.prototype.toString=()=>"None",o}(r);function s(e){return new i(e)}t.None=l,t.some=s,t.none=new l,t.option=function(e){return null==e?t.none:s(e)}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}(()=>{function e(e){let t,o=!1;return(...n)=>o?t:(o=!0,t=e(...n))}const t=e((()=>self.location.href===browser.runtime.getManifest().background.page));let n=!1;const r=browser.runtime.getPlatformInfo?browser.runtime.getPlatformInfo().then((({os:e})=>n="android"===e)):Promise.resolve(!1);let i=!1;r.then((e=>i=!e));const l=e=>browser.runtime.sendMessage(e);let s=!1,a="";l({type:"platformInfo"}).then((e=>{if(e){const{os:t,isFission:o}=e;a=t,s=o}return e}));o(576);function c(e,t){return(e=>{const t=Object.getOwnPropertyNames(e);for(let o=0;o<t.length;o++)delete e[t[o]]})(e),Object.assign(e,t)}const u={},d=async function(e){return browser.storage.onChanged.addListener((t=>{Object.entries(t).forEach((([t,{newValue:o}])=>{e[t]=o}))})),c(e,await browser.storage.local.get())}(u);var p,h,m,f,E,_,L,T;(e=>{e[e.TEXT=0]="TEXT",e[e.CLICKABLE=1]="CLICKABLE",e[e.LINK=2]="LINK",e[e.OTHER=3]="OTHER"})(p||(p={})),(e=>{e[e.UNIFORM=0]="UNIFORM",e[e.EXPONENTIAL=1]="EXPONENTIAL",e[e.INFINITE=2]="INFINITE"})(h||(h={})),(e=>{e[e.SCROLLBAR=0]="SCROLLBAR",e[e.GRAB_AND_DRAG=1]="GRAB_AND_DRAG",e[e.DYNAMIC_MULTIPLIER=2]="DYNAMIC_MULTIPLIER"})(m||(m={})),(e=>{e[e.SINGLE_CLICK=0]="SINGLE_CLICK",e[e.DOUBLE_CLICK=1]="DOUBLE_CLICK"})(f||(f={})),(e=>{e[e.NORMAL=0]="NORMAL",e[e.THIN=1]="THIN",e[e.HIDDEN=2]="HIDDEN"})(E||(E={})),(e=>{e[e.IF_PRESSED=0]="IF_PRESSED",e[e.NOT_PRESSED=1]="NOT_PRESSED"})(_||(_={})),(e=>{e[e.enabled=0]="enabled",e[e.userDisabled=1]="userDisabled",e[e.browserDisabled=2]="browserDisabled"})(L||(L={})),(e=>{e[e.smart=0]="smart",e[e.strict=1]="strict",e[e.none=2]="none",e[e.y_only=3]="y_only",e[e.x_only=4]="x_only"})(T||(T={}));let S=!1,g=!1,y=_.IF_PRESSED;async function v(){var e,t;const o=await d,n=function(e,t=!1){try{const o=new URL(e).hostname;return t&&o.startsWith("www.")?o.substring(4):o}catch(e){return""}}(location.href,!0);g=o.IS_DISABLED||(null===(e=o.DISABLED_DOMAINS)||void 0===e?void 0:e[n])||function(e={},t){const{hostname:o,pathname:n,search:r,hash:i}=new URL(t),l=(o.startsWith("www.")?o.substring(4):o)+n+r+i;return!!Object.keys(e).find((e=>e.endsWith("*")?l.startsWith(e.slice(0,-1)):l===e))}(o.DISABLED_URL,location.href)||!1,y=o.DISABLE_TYPE||_.IF_PRESSED,S=!!(null===(t=o.DISABLED_HORIZONTAL_SCROLLING_DOMAINS)||void 0===t?void 0:t[n]),await l({type:"updateIcon",status:g?L.userDisabled:L.enabled})}"moz-extension:"!==self.location.protocol&&(d.then(v),browser.storage.onChanged.addListener(v));(async()=>{0})();class w{constructor(e,t,o){this.startValue=e,this.minValue=t,this.maxValue=o,this._index=e}get current(){return this._index}get isLast(){return this._index===this.maxValue}get isFirst(){return this._index===this.minValue}setValue(e){this._index=e}getNext(){return this._index>=this.maxValue?this._index=this.minValue:++this._index}getPrevious(){return this._index<=this.minValue?this._index=this.maxValue:--this._index}map(e){const t=[],o=this._index;let n=0;do{t.push(e(this._index,n++))}while(o!==this.getNext());return t}}const b=e=>{let t=0;for(let o=0;o<e.length;o++)t+=e[o];return t};class I{constructor(e){this.size=e,this.data=Array(this.size).fill(0),this.iSeq=new w(0,0,this.size)}getTrend(){return b(this.data)}getNormalizedTrend(){const e=this.getTrend();return 0===e?0:e>0?1:-1}add(e){return this.data[this.iSeq.getNext()]=e,this}addBoolean(e){return this.data[this.iSeq.getNext()]=0===e?0:e?1:-1,this}}const O=(...e)=>{},M=(...e)=>{};Object.entries;const N=e=>(e=>!isNaN(e-parseFloat(e)))(e),D=e=>!!e,A=()=>{const e=[];return e.splice(0,0,new Promise(((t,o)=>{e.push(t,o)}))),e},R=e=>{let t=!1;return(...o)=>{t||(t=!0,e(...o))}},C=new WeakSet;const P=new WeakMap;new Set(["HTML","BODY","html","body"]);function x(e,t){var o,n;const{promise:r,resolve:i}=(()=>{const[e,t,o]=A();return{promise:e,resolve:t,reject:o}})(),l=function(e,t){switch(location.hostname){case"twitter.com":{const o=e.closest("section");if(o)return t.then((()=>o.style.setProperty("pointer-events","none","important"))),{afterScrollEnd(){o.style.removeProperty("pointer-events")}};break}case"mega.nz":{const t=".file-block-scrolling, .scroll, .ps--active-y",o=e.closest(t);if(o){if(P.has(o))return{afterEachScroll:P.get(o)};o.style.setProperty("overflow","auto","important"),o.style.setProperty("scrollbar-width","none","important");const e=()=>o.dispatchEvent(new WheelEvent("wheel"));return P.set(o,e),{afterEachScroll:e}}}}}(e,r),s=function(e,t){const o=32,n={ratioX:1,ratioY:1,clientFrame:null,isXml:!1,isFrame:!1};let r,i,l,s=0,a=0;const c=e.ownerDocument,u=c.documentElement,d=c.defaultView;n.clientFrame=d,c instanceof HTMLDocument||(n.isXml=!0);{n.isFrame=!!d.frameElement;const c=u.getElementsByTagName("body");if(!c||!c.length)return n;r=e===u?c[0]:"select"===e.nodeName.toLowerCase()?e.parentNode:e;do{try{if(i=r,!n.parentLinkNode&&i instanceof HTMLAnchorElement&&(n.parentLinkNode=i),l=3,i instanceof Element){const e=i.ownerDocument.defaultView.getComputedStyle(i).getPropertyValue("overflow");if("hidden"!==e){const t=i.nodeName.toLowerCase();if("html"===t||"body"===t||"visible"!==e){const e=i.clientWidth,o=i.clientHeight;{s=e+X(i,"border-left-width")+X(i,"border-right-width"),a=o+X(i,"border-top-width")+X(i,"border-bottom-width");const n=i.scrollHeight-o,c=i.scrollWidth-e;if("body"===t&&document.scrollingElement===document.body.parentElement&&(document.scrollingElement.scrollTopMax||document.scrollingElement.scrollLeftMax)){r=document.scrollingElement;continue}const u=i.scrollTopMax||n,d=i.scrollLeftMax||c;void 0!==u&&void 0!==d?(u>2&&d>2&&(l=0),u>2&&d<=2&&(l=1),u<=2&&d>2&&(l=2)):l=H(i.scrollWidth,s,i.scrollHeight,a,0)}}}}if(3!==l&&(0!==l&&2!==l||n.nodeToScrollX||(n.nodeToScrollX=i,s>o&&(s-=o),n.ratioX=-i.scrollWidth/s),0!==l&&1!==l||n.nodeToScrollY||(n.nodeToScrollY=i,a>o&&(a-=o),n.ratioY=-i.scrollHeight/a),n.nodeToScrollX&&n.nodeToScrollY))return n;r=i.parentNode}catch(e){return n}}while(r&&i!==u);if(n.isFrame)return n.nodeToScrollX||n.nodeToScrollY?n:x(d.frameElement.ownerDocument.documentElement,t)}return n}(e,t);if(s.resolveScrollStarted=i,l&&(s.afterEachScroll=l.afterEachScroll,s.afterScrollEnd=l.afterScrollEnd),function(e,t){if(!e.nodeToScrollX&&!e.nodeToScrollY&&location.href.startsWith("https://docs.google.com/spreadsheets/")){t.stopImmediatePropagation();const o=Array.from(document.getElementsByClassName("native-scrollbar"));if(2===o.length){const[t,n]=o;[e.nodeToScrollY,e.nodeToScrollX]=(t.className.includes("native-scrollbar-y")?o:o.reverse()).map(((e,t)=>{if(!C.has(e)){C.add(e);const{x:t,y:o,width:n,height:r}=e.getBoundingClientRect();e.dispatchEvent(new MouseEvent("mousedown",{clientX:t+n/2,clientY:o+r/2}))}const o={nodeName:e.nodeName,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,style:{setProperty:O}};return new Proxy(o,{getPrototypeOf:e=>HTMLElement.prototype,get:(e,t)=>e[t],set:(t,o,n,r)=>(e[o]=t[o]=n,!0)})})),e.ratioY=-t.scrollHeight/t.clientHeight,e.ratioX=-n.scrollWidth/n.clientWidth}}}(s,t),s.isXml&&!s.nodeToScrollX&&!s.nodeToScrollY){const e=document.scrollingElement;s.nodeToScrollX=e,s.nodeToScrollY=e,s.ratioX=-(e?e.scrollWidth/e.clientWidth:1),s.ratioY=-(e?e.scrollHeight/e.clientHeight:1)}const a=null===(o=s.nodeToScrollX)||void 0===o?void 0:o.scrollLeft,c=null===(n=s.nodeToScrollY)||void 0===n?void 0:n.scrollTop;return s.resetPosition=()=>{N(a)&&(s.nodeToScrollX.scrollLeft=a),N(c)&&(s.nodeToScrollY.scrollTop=c)},s.fixScrollBehaviorX=R((()=>{var e;return null===(e=s.nodeToScrollX.style)||void 0===e?void 0:e.setProperty("scroll-behavior","auto","important")})),s.fixScrollBehaviorY=R((()=>{var e;return null===(e=s.nodeToScrollY.style)||void 0===e?void 0:e.setProperty("scroll-behavior","auto","important")})),s.trend=new I(u.TREND_MOMENTUM_WINDOW||10),s}function X(e,t){const o=e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue(t),n=parseFloat(o);return isNaN(n)?"thin"===o?1:"medium"===o?3:"thick"===o?5:0:Math.ceil(n)}function H(e,t,o,n,r){return e<=t&&o<=n?3:e>t&&o>n?0:e>t?(o<=n-r)-0<<1:(e<=t-r)-0}let B={};const Y={setScrollObject:(e,t)=>B=x(e,t)};function F(e,t){return function(e,t,...o){for(let n=0;n<e.length;n++)if(t(e[n]))return e.splice(n,1,...o),e;return e}(e,t)}const k=e=>e[e.length-1];const U=()=>new Promise((e=>{window.requestAnimationFrame(e)}));var j;(e=>{e[e.LEFT=0]="LEFT",e[e.MIDDLE=1]="MIDDLE",e[e.RIGHT=2]="RIGHT"})(j||(j={}));const G=new class{constructor(){this.LAST_X=Array(),this.LAST_Y=Array(),this.totalScrollX=0,this.totalScrollY=0,this._isMoment=!1,this._stopMomentumFn=e=>{e instanceof KeyboardEvent&&u.DISABLE_TYPE===_.NOT_PRESSED&&(u.DISABLE_CTRL&&e.ctrlKey||u.DISABLE_ALT&&e.altKey||u.DISABLE_SHIFT&&e.shiftKey)||this.stop()},this._preventHandlingFn=e=>{e.preventDefault(),e.stopImmediatePropagation(),"auxclick"===e.type&&e.button===j.RIGHT||this.disableAccidentClick()}}toggle(e){window.removeEventListener("wheel",this._stopMomentumFn),window.removeEventListener("keydown",this._stopMomentumFn),e&&(window.addEventListener("wheel",this._stopMomentumFn),window.addEventListener("keydown",this._stopMomentumFn))}enableAccidentClick(e){this.isScrolling()&&(G.stop(),e.preventDefault(),e.stopImmediatePropagation(),window.addEventListener("click",this._preventHandlingFn,{once:!0,capture:!0}),window.addEventListener("auxclick",this._preventHandlingFn,{once:!0,capture:!0}),window.addEventListener("contextmenu",this._preventHandlingFn,{once:!0,capture:!0}))}disableAccidentClick(){window.removeEventListener("click",this._preventHandlingFn,{capture:!0}),window.removeEventListener("auxclick",this._preventHandlingFn,{capture:!0}),window.removeEventListener("contextmenu",this._preventHandlingFn,{capture:!0})}reset(){this.disableAccidentClick(),this.stop(),this.LAST_X.length=0,this.LAST_Y.length=0}mouseUp(){const e=k(this.LAST_X)||[0,0],t=k(this.LAST_Y)||[0,0],o=Math.max(e[1],t[1]);performance.now()-o<(u.MOMENTUM_STOP_DETECTION||50)&&this.doMoment()}stop(){this._isMoment=!1}addX(e){this.LAST_X.push([e,performance.now()])}addY(e){this.LAST_Y.push([e,performance.now()])}computeDeltasAndNormalize(e){const t=[];for(let o=1;o<e.length;++o){const[n,r]=e[o],[i,l]=e[o-1],s=n-i,a=r-l;t.push([s,a])}for(let e=0;e<2&&t.length>3;e++){const e=t.map((([e])=>e)),o=Math.min(...e),n=Math.max(...e);F(t,(([e])=>e===o)),F(t,(([e])=>e===n))}return t}async doMoment(){const e=this.LAST_X.slice(-10),t=this.LAST_Y.slice(-10),o=this.computeDeltasAndNormalize(e),n=this.computeDeltasAndNormalize(t);if(0===n.length&&0===o.length)return this.stop();const r=K(o),i=K(n),l=(u.ADDITIONAL_SPEED||0)/1e3,s=.01,a=r>s?r+l:r<-.01?r-l:r,c=i>s?i+l:i<-.01?i-l:i,d=Math.abs(a),p=Math.abs(c),m=a>0?1:-1,f=c>0?1:-1,E=(u.MOMENTUM_MAX_SPEED||0)/1e3,_=0===E?d:Math.min(d,E),L=0===E?p:Math.min(p,E),T=u.DURATION_PLUS||0,S=u.DURATION_MULTIPLIER||1e3,g=S*_+T,y=S*L+T,v=Math.max(g,y);B.nodeToScrollX&&(this.totalScrollX=B.nodeToScrollX.scrollLeft),B.nodeToScrollY&&(this.totalScrollY=B.nodeToScrollY.scrollTop);const w=performance.now();let b=w;const I=_/v,O=L/v;if(!v||isNaN(I)||isNaN(O))return this.stop();let M=0,N=0,D=0,A=0;for(this._isMoment=!0;this._isMoment&&(await U(),this._isMoment);){const e=performance.now(),t=e-w,o=e-b,n=100*(t/v);switch(b=e,u.MOMENTUM_FORMULA_TYPE||0){case h.INFINITE:this.moveMouseX(m*_*o),this.moveMouseY(f*L*o);break;case h.UNIFORM:{const e=m*_*t,o=f*L*t;if(t>v)return this.stop();M=e-m*I*t**2/2,D=o-f*O*t**2/2;const n=M-N,r=D-A;N=M,A=D,this.moveMouseX(n),this.moveMouseY(r)}break;case h.EXPONENTIAL:{if(t>v)return this.stop();const e=4,r=3,i=.04,l=.05,s=Math.max((i+e*_)/(e+n**r)-i,0),a=Math.max((i+e*L)/(e+n**r)-i,0),c=m*s*o,u=f*a*o;if(s>l&&this.moveMouseX(c),a>l&&this.moveMouseY(u),Math.max(s,a)<l)return this.stop()}}}}moveMouseX(e){B.nodeToScrollX instanceof Element&&(B.nodeToScrollX.scrollLeft=this.totalScrollX+=e)}moveMouseY(e){B.nodeToScrollY instanceof Element&&(B.nodeToScrollY.scrollTop=this.totalScrollY+=e)}isScrolling(){return this._isMoment&&(!B.nodeToScrollX||Math.abs(this.totalScrollX-B.nodeToScrollX.scrollLeft)<1)&&(!B.nodeToScrollY||Math.abs(this.totalScrollY-B.nodeToScrollY.scrollTop)<1)}};function K(e){let t=0;for(let o=0;o<e.length;++o){const[n,r]=e[o];t+=n/(r||1)}return t/e.length||0}const W="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,V=W?Promise.resolve():new Promise((e=>"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>e())))),[z,$]=A();Promise.resolve();new Map;new Set(["svg","path","circle","text"]);let q=[];function Z(e){const t=[...q].filter((t=>t.name===e.iframe_name));if(1===t.length)return t[0];const o=t.find((t=>{const[o,n]=function(e){const t=window.getComputedStyle(e);let o=e.clientHeight,n=e.clientWidth;return o-=parseFloat(t.paddingTop||"0")+parseFloat(t.paddingBottom||"0"),n-=parseFloat(t.paddingLeft||"0")+parseFloat(t.paddingRight||"0"),[n,o]}(t);return o===e.iframe_height&&n===e.iframe_width}));return o||document.body}V.then((()=>{q=document.getElementsByTagName("iframe")}));let J=p.OTHER;function Q(e){const t=J=function(e){const t=e.target,o=t?t.ownerDocument.defaultView.getComputedStyle(t).getPropertyValue("cursor"):"";try{const t=e.explicitOriginalTarget;return!u.SCROLL_ON_LINKS||"pointer"!==o||t instanceof HTMLSelectElement?"pointer"===o||"move"===o||oe(t,e)?p.CLICKABLE:"text"===o||te(t,e)?p.TEXT:p.OTHER:p.LINK}catch(e){return p.OTHER}}(e);return t}const ee={text:!0,email:!0,date:!0,"datetime-local":!0,month:!0,number:!0,password:!0,search:!0,tel:!0,time:!0,url:!0,week:!0},te=(e,t)=>e.nodeType===document.TEXT_NODE||t.composedPath().some((e=>"true"===e.contentEditable))||e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement&&!!ee[e.type],oe=(e,t)=>e instanceof HTMLButtonElement||e instanceof HTMLSelectElement||e instanceof HTMLOptionElement||e instanceof HTMLInputElement||!u.SCROLL_ON_TEXTAREA&&e instanceof HTMLTextAreaElement||!u.SCROLL_ON_EDITABLE_HTML&&t.composedPath().some((e=>"true"===e.contentEditable))||e instanceof HTMLObjectElement&&"application/x-shockwave-flash"===e.type;const ne={boolean:!0,number:!0,string:!0};function re(e){const t={_isFake:!0};for(const o in e){if(o.startsWith("moz"))continue;const n=e[o];ne[typeof n]&&(t[o]=n)}return t}function ie(e){return e.preventDefault=O,e.stopImmediatePropagation=O,e}var le;(e=>{e[e.SCROLLING=0]="SCROLLING",e[e.EDITING=1]="EDITING"})(le||(le={}));let se=le.SCROLLING;function ae(e){se=e}let ce=!1;var ue;(e=>{e[e.none=0]="none",e[e.horizontal=1]="horizontal",e[e.vertical=-1]="vertical"})(ue||(ue={}));let de=ue.none;class pe{constructor(){this._style=document.createElement("style"),this.injectToBody=e((()=>this.onDomLoaded()))}async onDomLoaded(){var e;await V,null===(e=document.head)||void 0===e||e.appendChild(this._style)}async loadRule(e){await this.injectToBody();const t=this._style.sheet;null==t||t.insertRule(e)}async unloadAll(){await this.injectToBody();const e=this._style.sheet;if(e)for(;e.cssRules.length>0;)e.deleteRule(0)}}const he="#cdcdcd",me="#f0f0f0",fe=(R((()=>{browser.storage.onChanged.addListener(Le),Le()})),t()),Ee=fe?null:new pe;let _e=Array();async function Le(){const e=await d;if(fe){0,_e.forEach((e=>e.unregister()));const t=Te().join("\n");_e=t?[await browser.contentScripts.register({css:[{code:t}],allFrames:!0,runAt:"document_start",matches:["<all_urls>"],excludeMatches:[[...Object.keys(e.DISABLED_DOMAINS||{}).flatMap((e=>[`*://www.${e}/*`,`*://${e}/*`])),...Object.keys(e.DISABLED_URL||{}).flatMap((e=>[`*://www.${e}`,`*://${e}`]))]].find((e=>e.length>0))})]:[]}else if(Ee){if(await Ee.unloadAll(),e.IS_DISABLED||g)return;const t=Te();await Promise.all(t.map((e=>Ee.loadRule(e))))}}function Te(){const{SCROLLBARS_WIDTH:e,SCROLLBARS_COLOR:t,SCROLLBARS_BACKGROUND:o,IS_DISABLED:n}=u;if(n)return[];const r=e||E.NORMAL,i=t||he,l=o||me;return[r===E.THIN&&"*:not(select) {scrollbar-width: thin}",r===E.HIDDEN&&"*:not(select) {scrollbar-width: none}",(i!==he||l!==me)&&`* {scrollbar-color: ${i} ${l}}`].filter(D)}const Se={[j.LEFT]:1,[j.MIDDLE]:4,[j.RIGHT]:2},ge=e((()=>document.getElementsByTagName("*").length<1e4)),ye=new pe;const ve=(()=>{try{return!W&&window.self!==window.top}catch(e){return!0}})();let we,be,Ie,Oe,Me,Ne,De,Ae=1,Re=!1,Ce=1,Pe=0,xe=0,Xe=4,He=!0,Be=1,Ye=!1,Fe=0,ke=0,Ue=0;async function je(){const e=await d;Be=e.simple_ratio_multiplier||1,Ce=e.reverse?-1:1,Pe=e.MAXIMUM_SPEED||0,xe=e.SCROLL_TYPE||0,Xe=e.MOVING_DETECTION||4,He=!(e.scroll_button_right||e.scroll_button_left||e.scroll_button_middle)||!!e.scroll_button_middle,G.toggle(!!e.MOMENTUM)}function Ge(e={}){Re||(Re=!0,window.addEventListener("contextmenu",Je,!0)),e._isFake||(ve?Qe("iframe_disableContextMenu",e):et("parent_disableContextMenu",e))}function Ke(e={}){Re&&setTimeout((()=>{Re=!1,window.removeEventListener("contextmenu",Je,!0)}),u.CONTEXT_MENU_UNBLOCK_DELAY||100),e._isFake||(ve?Qe("iframe_enableContextMenu",e):et("parent_enableContextMenu",e))}browser.runtime.onMessage.addListener((e=>{switch(e.type){case"zoom":Ae=e.zoom;break;case"ping":return Promise.resolve(!0);case"show_scrollbars":return null==Ee||Ee.unloadAll(),void["*:not(select) {scrollbar-width: auto!important}","* {scrollbar-color: auto!important}"].map((e=>null==Ee?void 0:Ee.loadRule(e)));case"iframe_mouseDown":Ve(ie(e.e));break;case"iframe_mouseUp":ze(ie(e.e));break;case"iframe_mouseMove":qe(ie(e.e));break;case"iframe_disableContextMenu":Ge(ie(e.e));break;case"iframe_enableContextMenu":Ke(ie(e.e));break;case"parent_mouseUp":ve&&ze(ie(e.e));break;case"parent_disableContextMenu":ve&&Ge(ie(e.e));break;case"parent_enableContextMenu":ve&&Ke(ie(e.e))}}));const We=()=>!B.nodeToScrollX&&!B.nodeToScrollY;function Ve(e){const t=e.button===j.MIDDLE&&He,o=e.button===j.RIGHT&&u.scroll_button_right,n=e.button===j.LEFT&&u.scroll_button_left,r=G.isScrolling();let i;if(G.enableAccidentClick(e),!function(e){const t=u.DISABLE_CTRL&&e.ctrlKey||u.DISABLE_ALT&&e.altKey||u.DISABLE_SHIFT&&e.shiftKey;return y===_.IF_PRESSED?t:!t}(e)&&!g&&(t||o||n&&r||n&&(i=Q(e))!==p.CLICKABLE&&(!e.target||!e.target.openOrClosedShadowRoot)&&(i===p.OTHER||i===p.LINK&&u.SCROLL_ON_LINKS||u.SCROLL_ON_TEXT&&se===le.SCROLLING))){!n&&u.no_prevent_default||e.preventDefault();const t=e.target||Z(e);if(Y.setScrollObject(t,e),We())if(ve)Qe("iframe_mouseDown",Object.assign(e,{iframe_name:window.name,iframe_height:window.innerHeight,iframe_width:window.innerWidth}));else if(u.DISABLE_CONTEXT_MENU_ON_MOVE)return;u.ALLOW_OTHER_MOUSE_DOWN_HANDLERS||n||e.stopImmediatePropagation(),window.addEventListener("mouseup",ze,!0),window.addEventListener("mousemove",qe,{capture:!0,passive:!0}),we=Ie=Me=e.screenX,be=Oe=Ne=e.screenY,de=ue.none,De=!u.NO_LINK_BLOCK&&(He||u.scroll_button_left&&u.SCROLL_ON_LINKS)?B.parentLinkNode:void 0,[document.documentElement,document.body].forEach((e=>{var t;null===(t=null==e?void 0:e.style)||void 0===t||t.setProperty("scroll-behavior","auto","important")}))}}function ze(e){var t,o;e._isFake||ve&&We()&&Qe("iframe_mouseUp",e),ke=0,Ue=0,Ye?(Ye=!1,De&&De.style.removeProperty("pointer-events"),e.preventDefault&&e.preventDefault(),u.MOMENTUM&&G.mouseUp(),ae(le.SCROLLING),e.button===j.LEFT&&u.scroll_button_left&&"[object ImageDocument]"===document.toString()&&document.body.addEventListener("click",(e=>e.stopImmediatePropagation()),{once:!0,capture:!0})):(u.scroll_button_left&&e.button===j.LEFT&&(window.getSelection().removeAllRanges(),u.SCROLL_ON_TEXT_EDIT_WITH===f.DOUBLE_CLICK?ae(le.SCROLLING):se=J===p.TEXT?le.EDITING:le.SCROLLING),u.PASTE_WITH_MIDDLE&&e.target instanceof HTMLElement&&((o=e.target)instanceof HTMLInputElement||o instanceof HTMLTextAreaElement||"true"===(null==o?void 0:o.contentEditable))&&(e.target.focus(),document.execCommand("paste"))),null===(t=B.afterScrollEnd)||void 0===t||t.call(B),Ke(e),window.removeEventListener("mouseup",ze,!0),window.removeEventListener("mousemove",qe,{capture:!0}),ye.unloadAll()}async function $e(e){if(u.SCROLL_ON_TEXT&&u.SCROLL_ON_TEXT_EDIT_WITH===f.DOUBLE_CLICK){e.button===j.LEFT&&u.scroll_button_left&&(await new Promise((e=>setTimeout(e,t))),ae(le.EDITING))}var t}function qe(e){var t;if(ve&&We())return void Qe("iframe_mouseMove",e);if(!e.buttons)return ze(Object.assign(ie({}),{_isFake:e._isFake})),void Ue++;Ue=0,ke++===Xe&&De&&De.style.setProperty("pointer-events","none","important"),Ye||(Ye=!0,Fe=e.buttons,B.resolveScrollStarted(),Promise.resolve().then((()=>async function(e){if(!u.NO_CSS_EDIT&&(q.length>0&&await ye.loadRule("iframe {pointer-events: none!important}"),(u.CURSOR||u.CURSOR_Y||u.CURSOR_X)&&(B.nodeToScrollY||B.nodeToScrollX)&&ge())){const t=e===ue.vertical?u.CURSOR_Y:e===ue.horizontal?u.CURSOR_X:u.CURSOR;await ye.loadRule(`* {cursor: ${t}!important}`)}}(a))),u.scroll_button_left&&u.PREVENT_TEXT_SELECTION&&window.getSelection().removeAllRanges(),u.MOMENTUM&&G.reset());const o=e.screenX,n=e.screenY;if(u.OUTSIDE_AREA_WIDTH&&function(e,t,o,n){if(Boolean(B.nodeToScrollX)!==Boolean(B.nodeToScrollY)||S){const r=u.OUTSIDE_AREA_WIDTH/2,i=Math.abs(e-o),l=Math.abs(t-n);ce=B.nodeToScrollY||S?i>r:l>r}return ce}(we,be,o,n))return B.resetPosition(),Ie=Me=we,void(Oe=Ne=be);const r=Ie-o,i=Oe-n;u.scroll_button_right&&!Re&&(r||i)&&Ge(e);const l=Math.abs(r),s=Math.abs(i),a=function(e,t){var o;const n=e===t,r=e>t;if(B.nodeToScrollX===B.nodeToScrollY)return ue.none;if(Boolean(B.nodeToScrollX)!==Boolean(B.nodeToScrollY))return B.nodeToScrollX?ue.horizontal:ue.vertical;switch(null!==(o=u.AXIS_LOCK)&&void 0!==o?o:T.strict){case T.none:return ue.none;case T.smart:return B.trend.addBoolean(e===t?0:e>t).getNormalizedTrend();case T.strict:return de||(n?ue.vertical:de=r?ue.horizontal:ue.vertical);case T.y_only:return ue.vertical;case T.x_only:return ue.horizontal;default:return ue.none}}(l,s);Ie=o,Oe=n,u.PREVENT_BIG_JUMPS&&(l>window.innerWidth/2||s>window.innerHeight/2)&&(Ie=Me=o,Oe=Ne=n);let c=(xe===m.GRAB_AND_DRAG?1:xe===m.DYNAMIC_MULTIPLIER?1/B.ratioX:B.ratioX)*Be*Ce/Ae,d=(xe===m.GRAB_AND_DRAG?1:xe===m.DYNAMIC_MULTIPLIER?1/B.ratioY:B.ratioY)*Be*Ce/Ae;Pe&&(Math.abs(c)>Pe&&(c=Pe*Math.sign(c)),Math.abs(d)>Pe&&(d=Pe*Math.sign(d)));const p=(Me-o)*c,h=(Ne-n)*d;if(Math.abs(p)>=1||Math.abs(h)>=1){const e=Math.round(p),r=Math.round(h);Me=o+(p-e)/c,Ne=n+(h-r)/d;const i=B.nodeToScrollX;if(i&&!S&&a!==ue.vertical&&(B.fixScrollBehaviorX(),i instanceof Element)){i.scrollLeft+=e;const t=i.scrollLeft;G.addX(t)}const l=B.nodeToScrollY;if(l&&a!==ue.horizontal&&(B.fixScrollBehaviorY(),l instanceof Element)){l.scrollTop+=r;const e=l.scrollTop;G.addY(e)}null===(t=B.afterEachScroll)||void 0===t||t.call(B)}}function Ze(){var e;Ye&&(ze(ie({})),G.stop(),e=j.RIGHT,Fe&Se[e]&&window.addEventListener("contextmenu",(e=>Je(e)),{capture:!0,once:!0}))}function Je(e){e.preventDefault(),e.stopImmediatePropagation()}function Qe(e,t){if(t._isFake)throw Error("INFINITE LOOP PREVENTED!!! Investigate!");return l({type:"forwardToParent",data:{type:e,e:re(t)}}).catch(M)}function et(e,t){if(t._isFake)throw Error("INFINITE LOOP PREVENTED!!! Investigate!");return l({type:"forwardToChildren",data:{type:e,e:re(t)}}).catch(M)}!async function(){browser.storage.onChanged.addListener(je),window.addEventListener("mousedown",Ve,{capture:!0});let e="";window.addEventListener("keydown",(t=>{e=t.altKey?"alt":t.ctrlKey?"ctrl":t.shiftKey?"shift":"","Escape"===t.key&&function(){if(!Ye)return;B.resetPosition(),Ze()}()}),{capture:!0,passive:!0}),window.addEventListener("keyup",(t=>{u.DISABLE_TYPE===_.NOT_PRESSED&&("ctrl"===e&&u.DISABLE_CTRL||"alt"===e&&u.DISABLE_ALT||"shift"===e&&u.DISABLE_SHIFT)&&Ze()}),{capture:!0,passive:!0}),window.addEventListener("dblclick",$e,{capture:!0,passive:!0}),l({type:"getZoom"}),await je()}()})()})();