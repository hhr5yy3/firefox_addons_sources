"use strict";function deselectCurrent(){var selection=document.getSelection();if(!selection.rangeCount)return function(){};for(var active=document.activeElement,ranges=[],i=0;i<selection.rangeCount;i++)ranges.push(selection.getRangeAt(i));switch(active.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":active.blur();break;default:active=null}return selection.removeAllRanges(),function(){"Caret"===selection.type&&selection.removeAllRanges(),selection.rangeCount||ranges.forEach(function(range){selection.addRange(range)}),active&&active.focus()}}function showCopyPasswordDialog(password){var $dialog=$("<div>");return $dialog.dialog({autoOpen:!0,create:()=>{$(".ui-dialog").wrap('<psr class="psr-modal">')},width:"200px",modal:!0,buttons:[{text:browser.i18n.getMessage("password_copy_confirm"),click:function(){copyTextToClipboard(password),$(this).dialog("close")}}]}),$dialog.append($("<h4>"+browser.i18n.getMessage("password_copy_prompt")+"</h4>")),$(".ui-dialog-titlebar").hide(),$dialog}function copyToClipboard(text,options){var mark,success=!1,options=(options=options||{}).debug||!1;try{var reselectPrevious=deselectCurrent(),range=document.createRange(),selection=document.getSelection();if((mark=document.createElement("span")).textContent=text,mark.style.all="unset",mark.style.position="fixed",mark.style.top=0,mark.style.clip="rect(0, 0, 0, 0)",mark.style.whiteSpace="pre",mark.style.webkitUserSelect="text",mark.style.MozUserSelect="text",mark.style.msUserSelect="text",mark.style.userSelect="text",document.body.appendChild(mark),range.selectNode(mark),selection.addRange(range),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");success=!0}catch(err){options&&console.error("unable to copy using execCommand: ",err),options&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",text),success=!0}catch(err){options&&console.error("unable to copy using clipboardData: ",err),options&&console.error("falling back to prompt"),showCopyPasswordDialog(text)}}finally{selection&&("function"==typeof selection.removeRange?selection.removeRange(range):selection.removeAllRanges()),mark&&document.body.removeChild(mark),reselectPrevious()}return success}