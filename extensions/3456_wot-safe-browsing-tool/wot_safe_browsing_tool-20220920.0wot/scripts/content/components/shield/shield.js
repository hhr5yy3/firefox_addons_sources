class ShieldComponent extends React.Component{constructor(e){super(e),this.isHoverListenerInit=!1,this.state={isPopupOpen:!1},this.onShieldOver=this.onShieldOver.bind(this),this.initHoverListener=this.initHoverListener.bind(this)}onShieldOver(){this.isHoverListenerInit||this.initHoverListener(),window.postMessage({type:SHIELD_HOVER_EVENT,id:this.props.containerSelector,host:this.props.host,color:this.props.shieldColor},window.location.origin)}initHoverListener(){window.addEventListener("message",e=>{if(!e.data||e.data.type!==SHIELD_HOVER_EVENT)return!0;this.setState({isPopupOpen:e.data.id===this.props.containerSelector})})}render(){const e=this.state.isPopupOpen;var t=this.props;const s=t.shieldColor,i=t.parental,o=t.childSafety,n=t.containerSelector,r=t.showAdultExtraIcon;var a=t.style;const l=void 0===a?{}:a;var d=t.additionalContainerStyle;const h=void 0===d?{}:d,c=o===NOT_SAFE&&r&&i,p=document.getElementById(n);return"invisible"===s?(p&&(p.style.width=0,p.style.height=0),React.createElement("div",null)):(p&&(p.style.minWidth="16px",p.style.height="16px"),p&&c&&Object.assign(p.style,h),React.createElement("div",{className:"shield_container",onMouseEnter:this.onShieldOver,onTouchStart:this.onShieldOver},React.createElement("div",{className:`wot_shield shield shield_${s} ${e?"popup_open":""}`,style:l}),c&&React.createElement(SvgIcon,{className:"adult_content_indicator_gray",svg:"18+gray.svg"})))}}let postMessageOnce=0;function mapStateToPros(e,t){t=this&&this.props||t;const s=getEncodedDomain(t.target),i=e.settings.shields.all===SHIELDS_LEVEL_HIGH?e.settings.shields[t.serpid]:SHIELDS_LEVEL_OFF;let o={host:s,shieldColor:"invisible",bubbleColor:"gray",childSafety:100,parental:!1};if(void 0===this||i===SHIELDS_LEVEL_OFF)return o;if(e.ratings[s]){const t=getShieldColor(e.ratings[s]).color;o={host:s,shieldColor:t,bubbleColor:e.ratings[s].color,childSafety:e.ratings[s].childSafety,parental:e.settings.parentalExtraIcon},["red","green","orange"].includes(t)&&postMessageOnce++,1===postMessageOnce&&0===e.onboarding.step&&window.postMessage({type:SHIELDS_READY},window.location.origin)}return o}mapStateToPros.dependsOnOwnProps=!0,ShieldComponent=ReactRedux.connect(mapStateToPros)(ShieldComponent);