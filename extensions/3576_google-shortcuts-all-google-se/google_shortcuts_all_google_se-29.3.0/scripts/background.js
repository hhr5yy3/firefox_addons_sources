"use strict";!function(){var n=self,y="undefined"!=typeof chrome&&chrome||{},e=y.runtime.getURL("PATH/").replace("/PATH/",""),_=e.startsWith("safari-web-extension://"),t=!_&&e.startsWith("moz-extension://"),i=!_&&!t;function p(e,r){return new Promise(function(t,n){y.notifications.create(e,r,function(){var e=y.runtime.lastError;e?n(e):t()})})}var m=y.action||y.browserAction||y.pageAction;function r(o){return new Promise(function(n,r){function e(e){var t=y.runtime.lastError;t?r(t):n(e)}try{o?m.openPopup(o,e):m.openPopup(e)}catch(e){var t=o?m.openPopup(o):m.openPopup();n(t)}})}function o(e){var t;return m.openPopup?(t=r(e),e?t.catch(function(){return r()}):t):Promise.reject(new Error("API missing"))}function h(e){m.setPopup({popup:e})}function b(){var e;h(t?null:((e=y.runtime.getManifest()).action||e.browser_action||e.page_action||{}).default_popup||"")}function s(o){return new Promise(function(n,r){y.tabs.query(o,function(e){var t=y.runtime.lastError;t?r(t):Array.isArray(e)?_&&o&&o.url?(t=e.filter(function(e){return e.url}),n(t)):n(e):r(new Error("No array returned"))}),setTimeout(n,2e3)})}function c(a){return new Promise(function(n,r){function o(e){var t=e.message||"";"openerTabId"in a&&-1!==t.indexOf("openerTabId")?(delete a.openerTabId,n(c(a))):i&&-1!==t.indexOf("Saved groups are not editable")?n():r(e)}try{y.tabs.create(a,function(e){var t=y.runtime.lastError;t?o(t):n(e)})}catch(e){o(e)}})}function a(e){n.open(e,"_blank","noopener")}function u(t){try{n.top.location.href=t}catch(e){a(t)}}function l(t,e){var o,a,n=e||null;return o=n,a={url:t},new Promise(function(n,r){y.tabs.update(o,a,function(e){var t=y.runtime.lastError;t?r(t):n(e)})}).catch(function(){if(!n)return s({active:!0,currentWindow:!0}).then(function(e){return e[0]},function(){return null}).then(function(e){if(e.id)return l(t,e.id);u(t)});u(t)})}function f(e,t,n,o){var r={url:e};return!1===t&&n&&(r.active=!1),o&&(r.openerTabId=o.id,r.index=o.index+1),c(r).then(function(e){var t,n,r;return t=e,n=o,y.tabs.group&&t&&n&&(r=n.groupId,t.groupId!==r)&&y.tabs.group({groupId:r,tabIds:t.id},function(){y.runtime.lastError||(t.groupId=r)}),e},function(){a(e)})}function v(e,t,n,r,o){if(!e)return Promise.reject(new Error("Missing URL"));if(!n){var a;if(t)return a=Boolean(r&&r.incognito),i={incognito:a,url:e},new Promise(function(n,r){y.windows.create(i,function(e){var t=y.runtime.lastError;t?r(t):n(e)})}).catch(function(){return f(e,t,n,r)});if(!1===n)return l(e,o)}var i;f(e,t,n,r)}function d(e,t,n){var r;v(y.runtime.getURL((r=y.runtime.getManifest()).options_page||(r.options_ui||{}).page||"/views/options.html"),e,t,n)}function g(e,t,n){if(e||t)return d(e,t,n);new Promise(function(e,t){y.runtime.openOptionsPage(function(){(y.runtime.lastError?t:e)()})}).catch(function(){return d(e,t,n)})}var w,I=!0;try{var S=y.i18n.getMessage("@@ui_locale");"string"==typeof S&&"und"!==S&&(w=S.replace("_","-"))}catch(e){I=!1}if(!w)try{var P=y.runtime.getManifest().default_locale;"string"==typeof P&&P.replace("_","-")}catch(e){}function A(e,t){return e&&I&&y.i18n.getMessage(e)||t||""}function L(){}function j(e){e=e.split(".");return e[0]+"."+e[1]}function x(r){var o,a=y.runtime.getManifest(),i=a.version,e=a.browser_action||a.action,t=e&&e.default_popup,e=(r.origin||"https://apps.jeurissen.co")+"/"+(r.websitePath||"")+"/",s=e+"installed",n=e+"whatsnew?installed=1",c=r.updateBadge,u=864e5*(r.passiveActionButton?1.5:4.5);function l(){o&&(o=null,v(n),y.storage.local.remove("cj_landing_lastupdated"),r.onExecute&&r.onExecute(),c)&&(m.onClicked.removeListener(l),t&&b(),!0===c)&&m.setBadgeText({text:""})}function f(){var t,n,e,r="cj_landing_update_notification";t=r,n={requireInteraction:!0,type:"basic",iconUrl:(e=(e=a).icons)?e[160]||e[80]||e[128]||e[48]||e[Object.keys(e)[0]]:null,message:A("cj_i18n_06287","Click to view changelog"),title:A("cj_i18n_06288","{APP_NAME} has been updated").replace("{APP_NAME}",a.name)},p(t,n).catch(function(e){e=e&&e.message||"";if("requireInteraction"in n&&-1!==e.indexOf("requireInteraction"))return delete n.requireInteraction,p(t,n)}),y.notifications.onClicked.addListener(function(e){e===r&&(l(),y.notifications.clear(r))})}function d(){c&&(t&&h(""),!0===c)&&(m.setBadgeBackgroundColor({color:"#EA4335"}),m.setBadgeText({text:_?"*":"âœµ"})),r.onUpdateAvailable&&r.onUpdateAvailable()}function g(){function e(){l(),y.windows.onFocusChanged.removeListener(e),y.tabs.onCreated.removeListener(e)}y.windows.onFocusChanged.addListener(e),y.tabs.onCreated.addListener(e)}y.runtime.setUninstallURL(e+"uninstalled"),y.storage.local.get(["cj_landing_lastupdated","cj_landing_versionnumber"],function(e){var t,n=Date.now();o=e.cj_landing_lastupdated,"string"!=typeof(e=e.cj_landing_versionnumber)?v(s):o||(t=j(e),j(i)!==t&&(o=n,y.storage.local.set({cj_landing_lastupdated:n}))),o&&!r.noUpdateNotice&&(r.useNotification&&y.notifications?f():(!c||(t=n,d(),u<t-o))&&g(),r.handleTrigger)&&y.runtime.onMessage.addListener(function e(t){t=t&&t.method;t&&"cjeLandingOpen"===t&&(l(),y.runtime.onMessage.removeListener(e))}),e!==i&&y.storage.local.set({cj_landing_versionnumber:i})}),m.onClicked.addListener(l),y.runtime.onStartup.addListener(L),y.runtime.onInstalled.addListener(L)}var M={3:"6",13:"202",20:"439",22:"21",38:"37",52:"421",69:"780",74:"210",76:"1230",77:"1138",82:"1605",83:"39",84:"1004",85:"1601",90:"559",92:"823",135:"901",165:"58",170:"1605",172:"23",203:"359",207:"521",218:"559",222:"1305",225:"49",236:"521",252:"666",273:"101",280:"1188",285:"6",294:"147",295:"59",296:"129",304:"70",305:"306",311:"559",320:"733",330:"898",339:"237",343:"1605",347:"605",348:"1704",349:"602",352:"1500",355:"550",358:"813",369:"11",372:"750",412:"1475",415:"256",417:"768",420:"1692",424:"693",425:"1347",431:"256",434:"73",444:"1704",445:"215",450:"1720",451:"1409",455:"665",456:"1069",459:"1373",468:"1373",471:"1499",479:"1605",481:"484",483:"484",486:"145",487:"1158",488:"1551",493:"126",494:"1373",496:"1119",500:"499",505:"1513",519:"1605",526:"1286",531:"234",540:"561",541:"1069",542:"59",546:"1286",547:"1245",558:"718",577:"240",579:"395",582:"30",585:"39",600:"442",606:"612",609:"1726",611:"687",613:"1609",614:"1609",615:"559",616:"856",620:"757",623:"129",634:"633",641:"1732",642:"395",644:"925",650:"438",651:"1431",652:"1430",653:"1720",670:"856",672:"237",673:"1117",674:"626",675:"661",678:"1692",699:"18",705:"269",707:"657",710:"1478",712:"1617",715:"780",721:"234",722:"234",723:"234",724:"234",725:"726",729:"1388",731:"158",741:"881",742:"657",743:"657",751:"750",752:"750",756:"97",764:"1069",783:"321",791:"790",792:"484",799:"590",807:"1669",817:"32",819:"1348",820:"1348",828:"1069",829:"1069",830:"1069",833:"1479",838:"244",846:"1682",855:"1669",857:"856",859:"1571",861:"353",862:"353",869:"35",874:"604",875:"604",876:"604",893:"1336",897:"1720",900:"1618",909:"559",910:"1668",917:"1337",918:"687",924:"58",932:"1339",947:"946",949:"23",950:"367",951:"11",952:"367",953:"367",956:"37",962:"1551",971:"1365",990:"49",993:"730",1e3:"1506",1010:"687",1011:"1666",1020:"1015",1040:"1216",1042:"987",1045:"987",1056:"1131",1059:"559",1076:"260",1078:"109",1080:"1069",1082:"63",1107:"901",1108:"901",1109:"271",1110:"271",1111:"271",1116:"901",1120:"1614",1127:"1007",1129:"140",1130:"97",1144:"129",1145:"439",1147:"1473",1148:"1610",1160:"594",1165:"16",1177:"787",1178:"61",1180:"61",1187:"1015",1191:"559",1193:"559",1194:"1015",1213:"129",1229:"1477",1247:"11",1271:"1666",1277:"1616",1279:"1729",1280:"1729",1292:"338",1293:"1283",1294:"1283",1295:"79",1300:"101",1301:"1281",1303:"1007",1307:"42",1308:"1007",1309:"1007",1312:"711",1319:"244",1321:"1007",1323:"1709",1329:"30",1332:"1007",1334:"1667",1335:"1333",1360:"901",1383:"901",1385:"901",1408:"1327",1411:"1007",1416:"639",1469:"1733",1480:"1007",1481:"1007",1482:"1007",1492:"1618",1504:"1630",1514:"1727",1522:"907",1567:"109",1586:"1578",1648:"288"},k=i,C=["customServicesDatabase","customShortcutsDatabase1","customShortcutsDatabase2","customShortcutsDatabase3","autoListRemoved","displayMarketplaceApps","displayMode","freezeCustomisation","gbwaConfig","hideLabel","hideSuggestions","iconBreak","noFocusActiveTab","noFocusTab","openInCurrentTab","openInNewTabChrome","shortcutIconSize","showLaunchbox","showSettings","toolbarIcon","toolbarIconDarkMode","appDarkMode","userList"];function O(o){var t=algBasics.cachePrefix+"iconDataCache",a=[],i={};browserStorage.local.getItem(t).then(function(e){e&&"object"==typeof e&&(i=e);for(var n=Object.keys(o),r=0;r<n.length;r++)!function(){var t=n[r];if(i[t])return;var e=o[t]||{},e=algBasics.getUrlIcon(e.url,e.iconUrl).then(function(e){e&&"object"==typeof e&&(i[t]=e)},function(){});a.push(e)}();return setTimeout(function(){browserStorage.local.setItem(t,i)},1e3),Promise.all(a).then(function(){browserStorage.local.setItem(t,i)})})}function B(v){browserStorage.sync.get().then(function(e){var t=v||JSON.parse(JSON.stringify(e)),n=(t.toolbarIcon&&-1!==algBasics.customActionIcons.indexOf(t.toolbarIcon)||delete t.toolbarIcon,t.userList);if(Array.isArray(n)&&0<n.length){var r=algBasics.getShortcutsList(),o=algBasics.joinCustomShortcutsDatabase([e,v]),n=function(e,t,n){for(var r=0===Object.keys(n).length,o=[],a=0;a<e.length;a++){var i=e[a],i=M[i]||i;-1===o.indexOf(i)&&(t[i]||r||n[i])&&o.push(i)}return o}(t.userList,r,o);t.userList=n;for(var a=Object.keys(o),i=0;i<a.length;i++){var s,c=a[i];-1===n.indexOf(c)?delete o[c]:(s=algBasics.cleanCustomShortcutData(o[c]),o[c]=s)}!1!==navigator.onLine&&O(o),algBasics.splitCustomShortcutsDatabase(o,t),y.storage.local.set({algCustomShortcutsDatabase:o}),delete t.customServicesDatabase}else{r=algBasics.getOgsShortcuts({}).then(function(e){if(!Array.isArray(e))return null;for(var t,n=algBasics.gbIdToShortcutIdMap,r=[],o=e[0],a=0;a<o.length;a++)(t=(t=o[a][1][0].toString())&&n[t])&&(!_||"70"!==t&&"101"!==t)&&r.push(t);return r}).catch(function(){return null}).then(function(e){Array.isArray(e)&&(n=e)});[].push(r)}!1===t.alwaysTab&&(t.openInCurrentTab=!0),delete t.alwaysTab;for(var u=Object.keys(t),l=0;l<u.length;l++){var f=u[l];-1===C.indexOf(f)&&delete t[f]}for(var d={},g=[],u=Object.keys(t),p=Object.keys(e).concat(u),m=0;m<p.length;m++){var h,b=p[m];b in t?(h=t[b],JSON.stringify(h)!==JSON.stringify(e[b])&&(d[b]=h)):g.push(b)}return(0<Object.keys(d).length?browserStorage.sync.set(d):Promise.resolve()).then(function(){if(0<g.length&&!_&&!k)return browserStorage.sync.remove(g)}).then(function(){return t},function(){return t})})}function T(){var e=y.runtime.getManifest().content_scripts;if(e)for(var t=function(){var r=e[n];s({url:r.matches}).then(function(e){for(var t=0;t<e.length;t++){var n=e[t];n.discarded||"unloaded"!==n.status&&!function(r,e){var t,n=e.css,o=e.js,a=e.all_frames,i=e.run_at;function s(e,t){var n=t.shift();n&&y.tabs[e](r,{allFrames:a,file:n,runAt:i},function(){s(e,t)})}y.scripting?(t={allFrames:a,tabId:r},n&&y.scripting.insertCSS({files:n,target:t}),o&&(t={files:o,target:t,injectImmediately:"document_start"===i},(e=e.world)&&(t.world=e),y.scripting.executeScript(t))):(n&&s("insertCSS",n),o&&s("executeScript",o))}(n.id,r)}})},n=0;n<e.length;n++)t()}function E(){browserStorage.sync.get(["toolbarIcon","toolbarIconDarkMode"]).then(function(e){var t=_?"function"==typeof matchMedia&&matchMedia("(prefers-color-scheme:dark)").matches:e.toolbarIconDarkMode;algBasics.setActionIcon(e.toolbarIcon,t)})}function D(e){e(),y.runtime.onStartup&&y.runtime.onStartup.addListener(e)}function N(){_||y.storage.local.get(null,function(e){e=Object.keys(e).filter(function(e){return"legacyExtDisplayed202404"!==e&&"algCustomShortcutsDatabase"!==e&&"workspaceBannerDisplayed"!==e&&"__sync_fallback__"!==e&&!e.startsWith("cj_landing_")&&!e.startsWith("__sync_storage__")&&!e.startsWith(algBasics.cachePrefix)});0<e.length&&y.storage.local.remove(e)}),B()}if("undefined"!=typeof document&&(document.body.textContent=""),D(E),x({handleTrigger:!0,noUpdateNotice:_,updateBadge:!0,websitePath:"g-app-launcher"}),i&&(y.runtime.onInstalled.addListener(T),y.permissions.onAdded.addListener(function(e){e=e&&e.origins;Array.isArray(e)&&0!==e.length&&T()})),N(),y.runtime.onMessage.addListener(function(e,t,n){var r=e&&e.method;if(r&&t.id===y.runtime.id){if("openActionPopup"===r)return o().then(function(e){n("success",e)},function(e){n("error",e)}),!0;"forward"===r&&(r=t.tab)&&(t=e.targetFrame,e=e.data,-1<t?y.tabs.sendMessage(r.id,e,{frameId:t}):y.tabs.sendMessage(r.id,e))}return!1}),_){var U=function(e){"activateExtension"===e?o():"openExtensionPreferences"===e&&g()};try{y.runtime.connectNative("application.id").onMessage.addListener(function(e){U(e.name,e.userInfo)})}catch(e){}}}();