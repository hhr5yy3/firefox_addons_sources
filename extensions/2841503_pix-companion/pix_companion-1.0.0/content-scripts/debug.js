var debug=function(){"use strict";var Oe=Object.defineProperty;var me=v=>{throw TypeError(v)};var Ve=(v,y,T)=>y in v?Oe(v,y,{enumerable:!0,configurable:!0,writable:!0,value:T}):v[y]=T;var ne=(v,y,T)=>Ve(v,typeof y!="symbol"?y+"":y,T),ie=(v,y,T)=>y.has(v)||me("Cannot "+T);var W=(v,y,T)=>(ie(v,y,"read from private field"),T?T.call(v):y.get(v)),B=(v,y,T)=>y.has(v)?me("Cannot add the same private member more than once"):y instanceof WeakSet?y.add(v):y.set(v,T),ue=(v,y,T,j)=>(ie(v,y,"write to private field"),j?j.call(v,T):y.set(v,T),T),X=(v,y,T)=>(ie(v,y,"access private method"),T);var Q,q,J,O,Ae,ae;function v(s){return s}var y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var j={exports:{}};(function(s,e){(function(r,t){t(s)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:y,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const t="The message port closed before a response was received.",h=l=>{const d={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(d).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class p extends WeakMap{constructor(o,u=void 0){super(u),this.createItem=o}get(o){return this.has(o)||this.set(o,this.createItem(o)),super.get(o)}}const $=g=>g&&typeof g=="object"&&typeof g.then=="function",C=(g,o)=>(...u)=>{l.runtime.lastError?g.reject(new Error(l.runtime.lastError.message)):o.singleCallbackArg||u.length<=1&&o.singleCallbackArg!==!1?g.resolve(u[0]):g.resolve(u)},E=g=>g==1?"argument":"arguments",L=(g,o)=>function(m,...x){if(x.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${E(o.minArgs)} for ${g}(), got ${x.length}`);if(x.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${E(o.maxArgs)} for ${g}(), got ${x.length}`);return new Promise((I,S)=>{if(o.fallbackToNoCallback)try{m[g](...x,C({resolve:I,reject:S},o))}catch(A){console.warn(`${g} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),m[g](...x),o.fallbackToNoCallback=!1,o.noCallback=!0,I()}else o.noCallback?(m[g](...x),I()):m[g](...x,C({resolve:I,reject:S},o))})},U=(g,o,u)=>new Proxy(o,{apply(m,x,I){return u.call(x,g,...I)}});let K=Function.call.bind(Object.prototype.hasOwnProperty);const i=(g,o={},u={})=>{let m=Object.create(null),x={has(S,A){return A in g||A in m},get(S,A,k){if(A in m)return m[A];if(!(A in g))return;let _=g[A];if(typeof _=="function")if(typeof o[A]=="function")_=U(g,g[A],o[A]);else if(K(u,A)){let N=L(A,u[A]);_=U(g,g[A],N)}else _=_.bind(g);else if(typeof _=="object"&&_!==null&&(K(o,A)||K(u,A)))_=i(_,o[A],u[A]);else if(K(u,"*"))_=i(_,o[A],u["*"]);else return Object.defineProperty(m,A,{configurable:!0,enumerable:!0,get(){return g[A]},set(N){g[A]=N}}),_;return m[A]=_,_},set(S,A,k,_){return A in m?m[A]=k:g[A]=k,!0},defineProperty(S,A,k){return Reflect.defineProperty(m,A,k)},deleteProperty(S,A){return Reflect.deleteProperty(m,A)}},I=Object.create(g);return new Proxy(I,x)},n=g=>({addListener(o,u,...m){o.addListener(g.get(u),...m)},hasListener(o,u){return o.hasListener(g.get(u))},removeListener(o,u){o.removeListener(g.get(u))}}),a=new p(g=>typeof g!="function"?g:function(u){const m=i(u,{},{getContent:{minArgs:0,maxArgs:0}});g(m)}),c=new p(g=>typeof g!="function"?g:function(u,m,x){let I=!1,S,A=new Promise(V=>{S=function(R){I=!0,V(R)}}),k;try{k=g(u,m,S)}catch(V){k=Promise.reject(V)}const _=k!==!0&&$(k);if(k!==!0&&!_&&!I)return!1;const N=V=>{V.then(R=>{x(R)},R=>{let se;R&&(R instanceof Error||typeof R.message=="string")?se=R.message:se="An unexpected error occurred",x({__mozWebExtensionPolyfillReject__:!0,message:se})}).catch(R=>{console.error("Failed to send onMessage rejected reply",R)})};return N(_?k:A),!0}),f=({reject:g,resolve:o},u)=>{l.runtime.lastError?l.runtime.lastError.message===t?o():g(new Error(l.runtime.lastError.message)):u&&u.__mozWebExtensionPolyfillReject__?g(new Error(u.message)):o(u)},w=(g,o,u,...m)=>{if(m.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${E(o.minArgs)} for ${g}(), got ${m.length}`);if(m.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${E(o.maxArgs)} for ${g}(), got ${m.length}`);return new Promise((x,I)=>{const S=f.bind(null,{resolve:x,reject:I});m.push(S),u.sendMessage(...m)})},M={devtools:{network:{onRequestFinished:n(a)}},runtime:{onMessage:n(c),onMessageExternal:n(c),sendMessage:w.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:w.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},b={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return d.privacy={network:{"*":b},services:{"*":b},websites:{"*":b}},i(l,M,d)};r.exports=h(chrome)}})})(j);var de=j.exports;const F=T(de);var oe=Object.prototype.hasOwnProperty;function ee(s,e){var r,t;if(s===e)return!0;if(s&&e&&(r=s.constructor)===e.constructor){if(r===Date)return s.getTime()===e.getTime();if(r===RegExp)return s.toString()===e.toString();if(r===Array){if((t=s.length)===e.length)for(;t--&&ee(s[t],e[t]););return t===-1}if(!r||typeof s=="object"){t=0;for(r in s)if(oe.call(s,r)&&++t&&!oe.call(e,r)||!(r in e)||!ee(s[r],e[r]))return!1;return Object.keys(e).length===t}}return s!==s&&e!==e}function G(s,...e){}const Y={debug:(...s)=>G(console.debug,...s),log:(...s)=>G(console.log,...s),warn:(...s)=>G(console.warn,...s),error:(...s)=>G(console.error,...s)};function he(s){return Array.isArray(s)?s:[s]}const fe=new Error("request for lock canceled");var we=function(s,e,r,t){function h(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function p(E){try{C(t.next(E))}catch(L){d(L)}}function $(E){try{C(t.throw(E))}catch(L){d(L)}}function C(E){E.done?l(E.value):h(E.value).then(p,$)}C((t=t.apply(s,e||[])).next())})};class xe{constructor(e,r=fe){this._value=e,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,h)=>{const l={resolve:t,reject:h,weight:e,priority:r},d=le(this._queue,p=>r<=p.priority);d===-1&&e<=this._value?this._dispatchItem(l):this._queue.splice(d+1,0,l)})}runExclusive(e){return we(this,arguments,void 0,function*(r,t=1,h=0){const[l,d]=yield this.acquire(t,h);try{return yield r(l)}finally{d()}})}waitForUnlock(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,r)?Promise.resolve():new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),ve(this._weightedWaiters[e-1],{resolve:t,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){const r=this._value;this._value-=e.weight,e.resolve([r,this._newReleaser(e.weight)])}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){const r=this._weightedWaiters[e-1];r&&(r.forEach(t=>t.resolve()),this._weightedWaiters[e-1]=[])}else{const e=this._queue[0].priority;for(let r=this._value;r>0;r--){const t=this._weightedWaiters[r-1];if(!t)continue;const h=t.findIndex(l=>l.priority<=e);(h===-1?t:t.splice(0,h)).forEach(l=>l.resolve())}}}_couldLockImmediately(e,r){return(this._queue.length===0||this._queue[0].priority<r)&&e<=this._value}}function ve(s,e){const r=le(s,t=>e.priority<=t.priority);s.splice(r+1,0,e)}function le(s,e){for(let r=s.length-1;r>=0;r--)if(e(s[r]))return r;return-1}var ye=function(s,e,r,t){function h(l){return l instanceof r?l:new r(function(d){d(l)})}return new(r||(r=Promise))(function(l,d){function p(E){try{C(t.next(E))}catch(L){d(L)}}function $(E){try{C(t.throw(E))}catch(L){d(L)}}function C(E){E.done?l(E.value):h(E.value).then(p,$)}C((t=t.apply(s,e||[])).next())})};class be{constructor(e){this._semaphore=new xe(1,e)}acquire(){return ye(this,arguments,void 0,function*(e=0){const[,r]=yield this._semaphore.acquire(1,e);return r})}runExclusive(e,r=0){return this._semaphore.runExclusive(()=>e(),1,r)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const P=Ee();function Ee(){const s={local:H("local"),session:H("session"),sync:H("sync"),managed:H("managed")},e=i=>{const n=s[i];if(n==null){const a=Object.keys(s).join(", ");throw Error(`Invalid area "${i}". Options: ${a}`)}return n},r=i=>{const n=i.indexOf(":"),a=i.substring(0,n),c=i.substring(n+1);if(c==null)throw Error(`Storage key should be in the form of "area:key", but received "${i}"`);return{driverArea:a,driverKey:c,driver:e(a)}},t=i=>i+"$",h=(i,n)=>i??n??null,l=i=>typeof i=="object"&&!Array.isArray(i)?i:{},d=async(i,n,a)=>{const c=await i.getItem(n);return h(c,(a==null?void 0:a.fallback)??(a==null?void 0:a.defaultValue))},p=async(i,n)=>{const a=t(n),c=await i.getItem(a);return l(c)},$=async(i,n,a)=>{await i.setItem(n,a??null)},C=async(i,n,a)=>{const c=t(n),w={...l(await i.getItem(c))};Object.entries(a).forEach(([M,b])=>{b==null?delete w[M]:w[M]=b}),await i.setItem(c,w)},E=async(i,n,a)=>{if(await i.removeItem(n),a!=null&&a.removeMeta){const c=t(n);await i.removeItem(c)}},L=async(i,n,a)=>{const c=t(n);if(a==null)await i.removeItem(c);else{const f=l(await i.getItem(c));he(a).forEach(w=>delete f[w]),await i.setItem(c,f)}},U=(i,n,a)=>i.watch(n,a);return{getItem:async(i,n)=>{const{driver:a,driverKey:c}=r(i);return await d(a,c,n)},getItems:async i=>{const n=new Map,a=new Map;return i.forEach(f=>{let w,M;typeof f=="string"?w=f:(w=f.key,M=f.options);const{driverArea:b,driverKey:g}=r(w),o=n.get(b)??[];n.set(b,o.concat(g)),a.set(w,M)}),(await Promise.all(Array.from(n.entries()).map(async([f,w])=>(await s[f].getItems(w)).map(b=>{const g=`${f}:${b.key}`,o=a.get(g),u=h(b.value,(o==null?void 0:o.fallback)??(o==null?void 0:o.defaultValue));return{key:g,value:u}})))).flat()},getMeta:async i=>{const{driver:n,driverKey:a}=r(i);return await p(n,a)},setItem:async(i,n)=>{const{driver:a,driverKey:c}=r(i);await $(a,c,n)},setItems:async i=>{const n=new Map;i.forEach(({key:a,value:c})=>{const{driverArea:f,driverKey:w}=r(a),M=n.get(f)??[];n.set(f,M.concat({key:w,value:c}))}),await Promise.all(Array.from(n.entries()).map(async([a,c])=>{await e(a).setItems(c)}))},setMeta:async(i,n)=>{const{driver:a,driverKey:c}=r(i);await C(a,c,n)},removeItem:async(i,n)=>{const{driver:a,driverKey:c}=r(i);await E(a,c,n)},removeItems:async i=>{const n=new Map;i.forEach(a=>{let c,f;typeof a=="string"?c=a:(c=a.key,f=a.options);const{driverArea:w,driverKey:M}=r(c),b=n.get(w)??[];b.push(M),f!=null&&f.removeMeta&&b.push(t(M)),n.set(w,b)}),await Promise.all(Array.from(n.entries()).map(async([a,c])=>{await e(a).removeItems(c)}))},removeMeta:async(i,n)=>{const{driver:a,driverKey:c}=r(i);await L(a,c,n)},snapshot:async(i,n)=>{var f;const c=await e(i).snapshot();return(f=n==null?void 0:n.excludeKeys)==null||f.forEach(w=>{delete c[w],delete c[t(w)]}),c},restoreSnapshot:async(i,n)=>{await e(i).restoreSnapshot(n)},watch:(i,n)=>{const{driver:a,driverKey:c}=r(i);return U(a,c,n)},unwatch(){Object.values(s).forEach(i=>{i.unwatch()})},defineItem:(i,n)=>{const{driver:a,driverKey:c}=r(i),{version:f=1,migrations:w={}}=n??{};if(f<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const M=async()=>{var _;const m=t(c),[{value:x},{value:I}]=await a.getItems([c,m]);if(x==null)return;const S=(I==null?void 0:I.v)??1;if(S>f)throw Error(`Version downgrade detected (v${S} -> v${f}) for "${i}"`);Y.debug(`Running storage migration for ${i}: v${S} -> v${f}`);const A=Array.from({length:f-S},(N,V)=>S+V+1);let k=x;for(const N of A)k=await((_=w==null?void 0:w[N])==null?void 0:_.call(w,k))??k;await a.setItems([{key:c,value:k},{key:m,value:{...I,v:f}}]),Y.debug(`Storage migration completed for ${i} v${f}`,{migratedValue:k})},b=(n==null?void 0:n.migrations)==null?Promise.resolve():M().catch(m=>{Y.error(`Migration failed for ${i}`,m)}),g=new be,o=()=>(n==null?void 0:n.fallback)??(n==null?void 0:n.defaultValue)??null,u=()=>g.runExclusive(async()=>{const m=await a.getItem(c);if(m!=null||(n==null?void 0:n.init)==null)return m;const x=await n.init();return await a.setItem(c,x),x});return b.then(u),{get defaultValue(){return o()},get fallback(){return o()},getValue:async()=>(await b,n!=null&&n.init?await u():await d(a,c,n)),getMeta:async()=>(await b,await p(a,c)),setValue:async m=>(await b,await $(a,c,m)),setMeta:async m=>(await b,await C(a,c,m)),removeValue:async m=>(await b,await E(a,c,m)),removeMeta:async m=>(await b,await L(a,c,m)),watch:m=>U(a,c,(x,I)=>m(x??o(),I??o())),migrate:M}}}}function H(s){const e=()=>{if(F.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if(F.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const t=F.storage[s];if(t==null)throw Error(`"browser.storage.${s}" is undefined`);return t},r=new Set;return{getItem:async t=>(await e().get(t))[t],getItems:async t=>{const h=await e().get(t);return t.map(l=>({key:l,value:h[l]??null}))},setItem:async(t,h)=>{h==null?await e().remove(t):await e().set({[t]:h})},setItems:async t=>{const h=t.reduce((l,{key:d,value:p})=>(l[d]=p,l),{});await e().set(h)},removeItem:async t=>{await e().remove(t)},removeItems:async t=>{await e().remove(t)},snapshot:async()=>await e().get(),restoreSnapshot:async t=>{await e().set(t)},watch(t,h){const l=d=>{const p=d[t];p!=null&&(ee(p.newValue,p.oldValue)||h(p.newValue??null,p.oldValue??null))};return e().onChanged.addListener(l),r.add(l),()=>{e().onChanged.removeListener(l),r.delete(l)}},unwatch(){r.forEach(t=>{e().onChanged.removeListener(t)}),r.clear()}}}async function pe(s){await P.setItem("local:activated",s)}async function ce(){return P.getItem("local:activated")}async function _e(){const s=await ce();return pe(!s)}function Ie(s){return P.watch("local:activated",s)}const Te={DEBUG:0,INFO:1,WARN:2,ERROR:3},Se="INFO";let ke;async function Me(){return P.getItem("local:log-level",{fallback:Se})}function Ce(s){Le(s)&&P.setItem("local:log-level",s).catch(ke.error)}function Le(s){return s in Te}const Re="3a23e6465af3ad22426cfa4c7e04907477a45c36",Ne={matches:["https://companion.pix.digital/debug.html","https://pix-companion-dev.osc-fr1.scalingo.io/debug.html"],main(s){const e=document.querySelector("#revision");e&&(e.innerText=Re);const r=document.querySelector("#toggle-activated");if(r){Ie(d=>{r.innerText=d?"Désactiver le filtrage":"Activer le filtrage"}),ce().then(d=>{r.innerText=d?"Désactiver le filtrage":"Activer le filtrage"}).catch(console.error),s.addEventListener(r,"click",()=>{_e().catch(console.error)});const l=document.querySelector("#log-level");l&&(l.disabled=!1,Me().then(d=>{l!=null&&(l.value=d)}).catch(console.error),s.addEventListener(l,"change",d=>{Ce(d.target.value)}))}const t=document.querySelector("#logs");t&&(P.getItem("local:logs").then(l=>{t.value=l??""}).catch(console.error),P.watch("local:logs",l=>{t.value=l??"",t.scrollTop=t.scrollHeight}));const h=document.querySelector("#clear-logs");h&&s.addEventListener(h,"click",()=>{P.setItem("local:logs","").catch(console.error)})}},Pe={BASE_URL:"/",BROWSER:"firefox",CHROME:!1,COMMAND:"build",DEV:!1,EDGE:!1,ENTRYPOINT:"debug",FIREFOX:!0,MANIFEST_VERSION:2,MODE:"production",OPERA:!1,PROD:!0,SAFARI:!1,SSR:!1,VITE_CJS_IGNORE_WARNING:"true",VITE_REVISION:"3a23e6465af3ad22426cfa4c7e04907477a45c36"},z=class z extends Event{constructor(e,r){super(z.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=r}};ne(z,"EVENT_NAME",ge("wxt:locationchange"));let re=z;function ge(s){var r;const e=typeof Pe>"u"?"build":"debug";return`${(r=F==null?void 0:F.runtime)==null?void 0:r.id}:${e}:${s}`}function $e(s){let e,r;return{run(){e==null&&(r=new URL(location.href),e=s.setInterval(()=>{let t=new URL(location.href);t.href!==r.href&&(window.dispatchEvent(new re(t,r)),r=t)},1e3))}}}const D=class D{constructor(e,r){B(this,O);B(this,Q,window.self===window.top);B(this,q);B(this,J,$e(this));this.contentScriptName=e,this.options=r,ue(this,q,new AbortController),W(this,Q)?(X(this,O,ae).call(this,{ignoreFirstEvent:!0}),X(this,O,Ae).call(this)):X(this,O,ae).call(this)}get signal(){return W(this,q).signal}abort(e){return W(this,q).abort(e)}get isInvalid(){return F.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,r){const t=setInterval(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearInterval(t)),t}setTimeout(e,r){const t=setTimeout(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearTimeout(t)),t}requestAnimationFrame(e){const r=requestAnimationFrame((...t)=>{this.isValid&&e(...t)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(e,r){const t=requestIdleCallback((...h)=>{this.signal.aborted||e(...h)},r);return this.onInvalidated(()=>cancelIdleCallback(t)),t}addEventListener(e,r,t,h){var l;r==="wxt:locationchange"&&this.isValid&&W(this,J).run(),(l=e.addEventListener)==null||l.call(e,r.startsWith("wxt:")?ge(r):r,t,{...h,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Y.debug(`Content script "${this.contentScriptName}" context invalidated`)}};Q=new WeakMap,q=new WeakMap,J=new WeakMap,O=new WeakSet,Ae=function(){window.postMessage({type:D.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")},ae=function(e){let r=!0;const t=h=>{var l,d;if(((l=h.data)==null?void 0:l.type)===D.SCRIPT_STARTED_MESSAGE_TYPE&&((d=h.data)==null?void 0:d.contentScriptName)===this.contentScriptName){const p=r;if(r=!1,p&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",t),this.onInvalidated(()=>removeEventListener("message",t))},ne(D,"SCRIPT_STARTED_MESSAGE_TYPE","wxt:content-script-started");let te=D;function je(){}function Z(s,...e){}const Fe={debug:(...s)=>Z(console.debug,...s),log:(...s)=>Z(console.log,...s),warn:(...s)=>Z(console.warn,...s),error:(...s)=>Z(console.error,...s)};return(async()=>{try{const{main:s,...e}=Ne,r=new te("debug",e);return await s(r)}catch(s){throw Fe.error('The content script "debug" crashed on startup!',s),s}})()}();
debug;
