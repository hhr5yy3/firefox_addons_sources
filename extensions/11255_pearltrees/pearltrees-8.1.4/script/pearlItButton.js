var PEARLTREES_URL = "https://www.pearltrees.com/";
var PEARLTREES_URL_HTTP = "http://www.pearltrees.com/";

var PEARLTREES_URL_BASE = ".pearltrees.com";
if (window.top === window && typeof PealtreesPearlItButton === 'undefined') { //not in an iframe

    PealtreesPearlItButton = {

        PEARL_BUTTON_SIZE : 34,
        PEARL_BUTTON_CSS_CLASS : "pearlItButton",
        PEARL_BUTTON_PICTURE_ID : 'pearlItButtonImg',
        PEARL_BUTTON_NOTE_ID : 'pearlItButtonTxt',
        PEARL_BUTTON_STYLE : {'position': 'absolute', 'display': 'none', 'cursor': 'pointer', 'z-index': '150000000', 'zIndex': '150000000', '-khtml-user-select': 'none', '-webkit-user-select': 'none', '-moz-user-select': 'none', '-ms-user-select': 'none', 'opacity': '0'},
        PEARL_BUTTON_PICTURE_IMG : 'data:image/png;base64,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',
        PEARL_BUTTON_PICTURE_IMG_HOVER : 'data:image/png;base64,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',
        PEARL_BUTTON_PICTURE_IMG_ACTIVE : 'data:image/png;base64,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',
        PEARL_BUTTON_NOTE_IMG : 'data:image/png;base64,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',
        PEARL_BUTTON_NOTE_IMG_HOVER : 'data:image/png;base64,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',
        PEARL_BUTTON_NOTE_IMG_ACTIVE : 'data:image/png;base64,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',
        PEARL_BUTTON_FAKE_FORM_ID : "pearlIt",

        EXCLUDED_LIST: [
            /^(.*?\.|)pearltrees\.com/,
            /^(.*?\.|)broceliand\.com/,
            /^(.*?\.|)broceliand\.fr/
        ],
        EXCLUDED_PATTERN: [
            /^(.)*_\/chrome\/newtab(.)*/
        ],

        VERTICAL_MIN_MARGIN : 0,
        HORIZONTAL_MIN_MARGIN : 0,
        INSIDE_IMAGE_MIN_MARGIN : 3,
        INSIDE_IMAGE_MAX_MARGIN : 23,

        pictureButton : null,
        noteButton : null,

        isInit : false,
        isLoaded : false,
        isImageAllowed : true,
        isVideoAllowed : true,
        isTextAllowed : true,

        isImageDetectionInitialized : false,
        isTextDetectionInitialized : false,

        imageButtonLayout : "tl", //tl, tr, br, bl

        waitMouseUp : null,
        dontShownOnSelection : null,
        shouldDelayButtonHide : false,
        currentTarget: "",
        lastOverTarget : null,
        currentTargetUrl : "",
        currentSelectedText : "",
        currentText: "",
        currentLayout : "",
        isHoverButton : {},
        hideTiemout : undefined,
        isFadingCss: false,
        updatedTarget : undefined,
        pearlerType : "chrome",

        init : function() {
            if (window.hasRunPTScripts) return; //Guard
            window.hasRunPTScripts = true;
            if (!PealtreesPearlItButton.isInit) {
                PealtreesPearlItButton.isInit = true;
                PealtreesPearlItButton.requestBackgroundParametersWithCallBack(function(data) {
                    if (data != null) {
                        PealtreesPearlItButton.log("PB " + typeof PTAddonConfig);
                        PealtreesPearlItButton.log("PB " + PTAddonConfig.CS_EXCLUDED_PATTERN);
                        if (!PearltreesContentHelper.isExcludedSite(location.href)) {
                            PealtreesPearlItButton.appendButtonToBody();
                            PealtreesPearlItButton.loadParameters();
                            PealtreesPearlItButton.appendFakeForm();
                        }
                        if (typeof PearltreesContextItem !== 'undefined') {
                            PearltreesContextItem.init();
                        }
                        PealtreesPearlItButton.isLoaded = true;
                    }
                    else {
                        PealtreesPearlItButton.log("No server file found !");
                    }
                });
            }
        },

        loadParameters : function() {
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                self.port.on('showOverlayNotLogged', function() {
                    PealtreesPearlItButton.showOverlayForNotLoggedUser();
                });
            }
            PealtreesPearlItButton.requestUserButtonParametersWithCallBack(function(data) {
                var res = JSON.parse(data);
                PealtreesPearlItButton.setUserParameters(res.imAllow, res.vidAllow, res.textAllow, res.imButLayout);
            });

        },

        requestBackgroundParametersWithCallBack : function(callback) {
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                self.port.once('sendPTServerConfigFile', function(data) {
                    callback(data)
                });
                self.port.emit("requestPTServerConfigFile");
            }
            else if (PealtreesPearlItButton.isChromeEnv()) {
                chrome.storage.local.get('PTConfigFile', function(data) {
                    if (typeof data.PTConfigFile !== 'undefined' && data.PTConfigFile != null) {
                        callback(data.PTConfigFile);
                    }
                    else {
                        callback(null);
                    }
                });
            }
            else if (PealtreesPearlItButton.isSafariEnv()){
                safari.self.addEventListener("message", function(event) {
                    if (event.name == "sendPTServerConfigFile")
                        callback(event.message);

                }, false);
                safari.self.tab.dispatchMessage("requestPTServerConfigFile", "requestPTServerConfigFile");
            }
        },

        requestUserButtonParametersWithCallBack : function(callback) {
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                self.port.once('sendPTButtonParameters', function(data) {
                    callback(data)
                });
                self.port.emit("requestPTButtonParameters");
            }
            else if (PealtreesPearlItButton.isChromeEnv()) {
                chrome.storage.local.get('PTButtonParameters', function(data) {
                    if (typeof data.PTButtonParameters !== 'undefined' && data.PTButtonParameters != null) {
                        callback(data.PTButtonParameters);
                    }
                    else {
                        callback('{"imAllow":false,"vidAllow":false"textAllow":false,"rightClick":false,"imButLayout":"tl"}');
                    }
                });
            }
            else if (PealtreesPearlItButton.isSafariEnv()){
                safari.self.addEventListener("message", function(event) {
                    if (event.name == "sendPTButtonParameters")
                        callback(event.message);
                }, false);
                safari.self.tab.dispatchMessage("requestPTButtonParameters", "requestPTButtonParameters");
            }
        },

        saveUserButtonParameters : function(data) {
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                self.port.emit("savePTButtonParameters", data);
            }
            else if (PealtreesPearlItButton.isChromeEnv()) {
                chrome.runtime.sendMessage("savePTButtonParameters@" + data);
            }
            else if (PealtreesPearlItButton.isSafariEnv()){
                safari.self.tab.dispatchMessage("savePTButtonParameters", data);
            }
        },

        initDetection : function() {
            if (!PearltreesContentHelper.isExcludedSite(location.href)) {
                PealtreesPearlItButton.log("initDetection : im = " + PealtreesPearlItButton.isImageAllowed + " vid = " + PealtreesPearlItButton.isVideoAllowed + " text = " + PealtreesPearlItButton.isTextAllowed);
                if (!PealtreesPearlItButton.isImageDetectionInitialized && (PealtreesPearlItButton.isImageAllowed || PealtreesPearlItButton.isVideoAllowed)) {
                    PealtreesPearlItButton.isImageDetectionInitialized = true;
                    PealtreesPearlItButton.detectOverImage();
                }
                else if (!PealtreesPearlItButton.isImageAllowed && !PealtreesPearlItButton.isVideoAllowed) {
                    PealtreesPearlItButton.isImageDetectionInitialized = false;
                    PealtreesPearlItButton.removeDetectOverImage();
                }
                if (!PealtreesPearlItButton.isTextDetectionInitialized && PealtreesPearlItButton.isTextAllowed) {
                    PealtreesPearlItButton.isTextDetectionInitialized = true;
                    PealtreesPearlItButton.detectTextSelection();
                }
                else if (PealtreesPearlItButton.isTextAllowed) {
                    PealtreesPearlItButton.isTextDetectionInitialized = false;
                    PealtreesPearlItButton.removeDetectTextSelection();
                }
            }
        },

        setUserParameters : function(imAllow, vidAllow, textAllow, imButLayout) {
            var serverParam = PealtreesPearlItButton.getServerButtonParameters();
            PealtreesPearlItButton.isImageAllowed = (imAllow && serverParam.imAllow) || false;
            PealtreesPearlItButton.isVideoAllowed = (vidAllow && serverParam.vidAllow) || false;
            PealtreesPearlItButton.isTextAllowed = (textAllow && serverParam.textAllow) || false;
            if (imButLayout == "tr" || imButLayout == "br" || imButLayout == "bl") {
                PealtreesPearlItButton.imageButtonLayout = imButLayout;
            }
            else {
                PealtreesPearlItButton.imageButtonLayout = "tl";
            }
            if (serverParam.imButLayout == "tr" || serverParam.imButLayout == "br" || serverParam.imButLayout == "bl" || serverParam.imButLayout == "tl") {
                PealtreesPearlItButton.imageButtonLayout = serverParam.imButLayout;
            }
            PealtreesPearlItButton.initDetection();
        },

        getServerButtonParameters : function() {
            var url = location.href;
            PealtreesPearlItButton.log("getServerButtonParametersForSite: " + url);
            for (var i = 0; i < PTAddonConfig.CS_BUTTON_PERMISSION_OVERRIDE.length; i++) {
                if (typeof PTAddonConfig.CS_BUTTON_PERMISSION_OVERRIDE[i].getPermission !== 'undefined'){
                    var matchingPattern =  PTAddonConfig.CS_BUTTON_PERMISSION_OVERRIDE[i];
                    var result = matchingPattern.getPermission(url);
                    if (result != null) {
                        return result;
                    }
                }
            }
            return {imAllow:true,vidAllow:true,textAllow:true,rightClick:true,imButLayout:"none"};
        },

        appendFakeForm : function() {
            var form = document.createElement('form');
            jUtils.setAttr(form, 'id', PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID);
            jUtils.setAttr(form, 'method', 'post');
            jUtils.setAttr(form, 'action', PEARLTREES_URL + "s/pearler/listFromAddons");
            jUtils.setAttr(form, 'target', pearltreesOverlay.overlayId);
            var inputs = "<input type='hidden' name='url'>";
            inputs += "<input type='hidden' name='title'>";
            inputs += "<input type='hidden' name='layout'>";
            inputs += "<input type='hidden' name='text'>";
            inputs += "<input type='hidden' name='buttonParams'>";
            inputs += "<input type='hidden' name='version' value='0.9'>";
            if (typeof form.innerHTML !== 'undefined') {
                try {
                    form.innerHTML = inputs;
                }
                catch (e) {}
                var b = jUtils.getBody();
                if (typeof b !== 'undefined') {
                    b.appendChild(form);
                }
            }
        },

        appendButtonToBody : function() {
            PealtreesPearlItButton.pictureButton = document.createElement('span');
            jUtils.setAttr(PealtreesPearlItButton.pictureButton, 'id', PealtreesPearlItButton.PEARL_BUTTON_PICTURE_ID);
            jUtils.setAttr(PealtreesPearlItButton.pictureButton, 'unselectable', 'on');
            PealtreesPearlItButton.addStyleToButton(PealtreesPearlItButton.pictureButton);
            PealtreesPearlItButton.noteButton = document.createElement('span');
            jUtils.setAttr(PealtreesPearlItButton.noteButton, 'id', PealtreesPearlItButton.PEARL_BUTTON_NOTE_ID);
            jUtils.setAttr(PealtreesPearlItButton.noteButton, 'unselectable', 'on');
            PealtreesPearlItButton.addStyleToButton(PealtreesPearlItButton.noteButton);
            //Append over&active to head style
            var css = "#" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_ID + "{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_IMG + ");}\n";
            css += "#" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_ID + ":hover{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_IMG_HOVER + ");}\n";
            css += "#" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_ID + ":active{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_PICTURE_IMG_ACTIVE + ");}\n";
            css += "#" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_ID + "{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_IMG + ");}\n";
            css += "#" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_ID + ":hover{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_IMG_HOVER + ");}\n";
            css += "#" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_ID + ":active{background-image: url(" + PealtreesPearlItButton.PEARL_BUTTON_NOTE_IMG_ACTIVE + ");}\n";
            var head = document.head || document.getElementsByTagName('head')[0];
            var style = document.createElement('style');
            style.type = 'text/css';
            if (style.styleSheet){
                style.styleSheet.cssText = css;
            }
            else {
                style.appendChild(document.createTextNode(css));
            }
            if (typeof head !== 'undefined') {
                head.appendChild(style);
            }
            PealtreesPearlItButton.bindButtonActions(PealtreesPearlItButton.pictureButton, null, true);
            PealtreesPearlItButton.bindButtonActions(PealtreesPearlItButton.noteButton, PearltreesContentHelper.TEXT_LAYOUT, false);
        },

        addStyleToButton : function(button) {
            for (key in PealtreesPearlItButton.PEARL_BUTTON_STYLE) {
                button.style[key] = PealtreesPearlItButton.PEARL_BUTTON_STYLE[key];
            }
            button.style['width'] = PealtreesPearlItButton.PEARL_BUTTON_SIZE + 'px';
            button.style['height'] = PealtreesPearlItButton.PEARL_BUTTON_SIZE + 'px';
            jUtils.setAttr(button, 'class', PealtreesPearlItButton.PEARL_BUTTON_CSS_CLASS);
            var b = jUtils.getBody();
            if (typeof b !== 'undefined') {
                b.appendChild(button);
            }
        },

        bindButtonActions : function(button, layoutAssociated, withOver) {
            jUtils.listen(button, 'click',
                function(event) {
                    event.stopPropagation();
                    PealtreesPearlItButton.log("click on button event");
                    if (layoutAssociated != null) {
                        PealtreesPearlItButton.buttonAction(layoutAssociated);
                    }
                    else {
                        PealtreesPearlItButton.buttonAction(PealtreesPearlItButton.currentLayout);
                    }
                }
            );
            jUtils.listen(button, 'mouseover',
                        function(event) {
                            PealtreesPearlItButton.shouldDelayButtonHide = false;
            });
        },

        buttonAction : function(layout) {
            if (PealtreesPearlItButton.currentLayout == PearltreesContentHelper.INVALID_IMAGE_LAYOUT) {
                PearltreesContextItem.alertSomething("invalidImage");
                PealtreesPearlItButton.currentLayout = null;
                PealtreesPearlItButton.hideButton(PearltreesContentHelper.IMAGE_LAYOUT);
                return;
            }
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                self.port.emit('openPopup', layout, PealtreesPearlItButton.currentTargetUrl, layout == PearltreesContentHelper.TEXT_LAYOUT ? encodeURIComponent(PealtreesPearlItButton.currentSelectedText) : PealtreesPearlItButton.currentText);
            }
            else {
                PealtreesPearlItButton.showOverlay(layout);
            }
        },

        showOverlay : function(layout) {
            pearltreesOverlay.showOverlay();
            var text;
            if (layout !== PearltreesContentHelper.TEXT_LAYOUT) {
                text = PealtreesPearlItButton.currentText;
            }
            else {
                text = encodeURIComponent(PealtreesPearlItButton.currentSelectedText);
            }
            PealtreesPearlItButton.requestUserButtonParametersWithCallBack(function(data) {
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'url', PealtreesPearlItButton.currentTargetUrl ? PealtreesPearlItButton.currentTargetUrl : document.URL);
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'title', document.title.replace(/^\s*|\s*$/g,''));
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'layout', layout);
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'buttonParams', data);
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'text', text);
                document.getElementById(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID).submit();
            });
        },

        showOverlayForNotLoggedUser : function() {
            pearltreesOverlay.showOverlay();
            PealtreesPearlItButton.requestUserButtonParametersWithCallBack(function(data) {
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'url', "");
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'title', "");
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'layout', "");
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'buttonParams', data);
                jUtils.setInputValue(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID, 'text', "");
                document.getElementById(PealtreesPearlItButton.PEARL_BUTTON_FAKE_FORM_ID).submit();
            });
        },

        detectOverImage : function() {
            jUtils.listen(jUtils.getBody(), 'mouseover',
                function(event) {
                    PealtreesPearlItButton.detectOverImageInternal(event, "body");
                }
            );
            jUtils.listen(window, 'mouseover',
                function(event) {
                    PealtreesPearlItButton.detectOverImageInternal(event, "window");
                }
            );
        },

        removeDetectOverImage : function() {
            jUtils.remove(jUtils.getBody(), 'mouseover',
                function(event) {
                    PealtreesPearlItButton.detectOverImageInternal(event, "body");
                }
            );
            jUtils.remove(window, 'mouseover',
                function(event) {
                    PealtreesPearlItButton.detectOverImageInternal(event, "window");
                }
            );
        },

        detectOverImageInternal : function(event, origin) {
            var test = jUtils.getElement(event);
            PealtreesPearlItButton.updatedTarget = jUtils.getElement(event);
            if (PealtreesPearlItButton.isImageAllowed || PealtreesPearlItButton.isVideoAllowed) {
                if (!PealtreesPearlItButton.isOverAllowedOnTarget(PealtreesPearlItButton.updatedTarget, document.URL)) {
                    return; //Guard to avoid bad performances in browsers
                }
            }
            if (PealtreesPearlItButton.isImageAllowed || PealtreesPearlItButton.isVideoAllowed) {
                PealtreesPearlItButton.isImagePearlabled(test, origin, PealtreesPearlItButton.showPearlableItem, false);
            }
            if (PealtreesPearlItButton.isVideoAllowed) {
                PealtreesPearlItButton.lastOverTarget = test;
                PearltreesContentHelper.isVideoPearlabled(test, origin, PealtreesPearlItButton.showPearlableItem, function() {});
            }
        },

        isOverAllowedOnTarget : function(target, url) {
            var tagName = target.tagName;
            for (var i = 0; i < PTAddonConfig.CS_ALLOWED_TAG_LIST.length; i++) {
                if (tagName === PTAddonConfig.CS_ALLOWED_TAG_LIST[i]) {
                    for (var j = 0; j < PTAddonConfig.CS_RESTRICT_BY_TAG_LIST.length; j++) {
                        if (tagName === PTAddonConfig.CS_RESTRICT_BY_TAG_LIST[j].tagName) {
                            return PTAddonConfig.CS_RESTRICT_BY_TAG_LIST[j].isAllowed(url, target)
                        }
                    }
                    return true;
                }
            }
            return false;
        },

        showPearlableItem : function(target, url, layout, pageUrl, origin, specialOffset) {
            if (PealtreesPearlItButton.lastOverTarget != target) {
                return;
            }
            if (!PealtreesPearlItButton.isImageAllowed && layout === PearltreesContentHelper.IMAGE_LAYOUT) {
                return;
            }
            if (!PealtreesPearlItButton.isVideoAllowed && (layout === PearltreesContentHelper.VIDEO_EMBED_LAYOUT || layout === PearltreesContentHelper.VIDEO_LAYOUT)) {
                return;
            }
            PealtreesPearlItButton.currentTargetUrl = pageUrl ? pageUrl : document.URL;
            PealtreesPearlItButton.currentLayout = layout;
            PealtreesPearlItButton.currentText = url;
            PealtreesPearlItButton.log("show pearlable item on : " + PealtreesPearlItButton.currentTargetUrl);
            PealtreesPearlItButton.currentTarget = target;
            try {
                jUtils.listen(document, 'mousemove', PealtreesPearlItButton.mouseOutStillOverImageInternal);
                jUtils.listen(document, PealtreesPearlItButton.getScrollEventName(), PealtreesPearlItButton.mouseOutStillOverImageInternal);
                document.PTElement = target;
                document.PTLayout = layout;
                document.PTOrigin = origin;
                document.PTSpecialOffset = specialOffset;
            } catch (e) {
                try {
                    jUtils.listen(target.parentNode, 'mouseleave', PealtreesPearlItButton.mouseOutImage);
                    PealtreesPearlItButton.currentTarget = target.parentNode;
                    PealtreesPearlItButton.currentTarget.layout = layout;
                    PealtreesPearlItButton.currentTarget.origin = origin;
                } catch (e) {}
            }
            var offset = jUtils.getOffset(target);
            if (!offset) {
                return;
            }
            var top = offset.top;
            var left = offset.left;
    //		if (PealtreesPearlItButton.isNeedScrollSite()) {
    //			top = jUtils.scrollTop() + top;
    //		}
    //		if (top < jUtils.scrollTop()) {
    //			if (!PealtreesPearlItButton.isNeedScrollSite()) {
    //				top = jUtils.scrollTop();
    //			}
    //		}
            if (typeof specialOffset != 'undefined' && specialOffset != null && layout === PearltreesContentHelper.IMAGE_LAYOUT) {
                if (PealtreesPearlItButton.imageButtonLayout == "tr") {
                    top += specialOffset.top;
                    left += offset.width - specialOffset.left - PealtreesPearlItButton.PEARL_BUTTON_SIZE;
                }
                else if (PealtreesPearlItButton.imageButtonLayout == "br") {
                    top += offset.height - specialOffset.top - PealtreesPearlItButton.PEARL_BUTTON_SIZE;
                    left += offset.width - specialOffset.left - PealtreesPearlItButton.PEARL_BUTTON_SIZE;
                }
                else if (PealtreesPearlItButton.imageButtonLayout == "bl") {
                    top += offset.height - specialOffset.top - PealtreesPearlItButton.PEARL_BUTTON_SIZE;
                    left += specialOffset.left;
                }
                else {//tl by default
                    top += specialOffset.top;
                    left += specialOffset.left;
                }
            }
            else if (typeof specialOffset != 'undefined' && specialOffset != null && (layout === PearltreesContentHelper.VIDEO_EMBED_LAYOUT || layout === PearltreesContentHelper.VIDEO_LAYOUT)) {
                top += specialOffset.top;
                left += specialOffset.left;
            }
            if (target.tagName == "OBJECT" || (PealtreesPearlItButton.isFirefoxEnv() && (layout === PearltreesContentHelper.VIDEO_EMBED_LAYOUT || layout === PearltreesContentHelper.VIDEO_LAYOUT) && target.tagName !== "IMG")) {
                left = left - PealtreesPearlItButton.PEARL_BUTTON_SIZE;
            }
            PealtreesPearlItButton.log(" WILL showButtonNewtToElement top = " + top + ", left = " + left + ", layout = " + PearltreesContentHelper.IMAGE_LAYOUT + ", origin = " + origin + ", scrollTop = " + jUtils.scrollTop());
            PealtreesPearlItButton.shouldDelayButtonHide = left < offset.left;
            PealtreesPearlItButton.showButtonNewtToElement(top, left, PearltreesContentHelper.IMAGE_LAYOUT, origin);
        },

        mouseOutStillOverImageInternal : function(event) {
            PealtreesPearlItButton.log("mouseOutStillOverImage event = " + event);
            if (!jUtils.isOverElement(document.PTElement, event, PealtreesPearlItButton.getButtonAssociated(document.PTLayout), document.PTSpecialOffset)) {
                PealtreesPearlItButton.log("mouseOutStillOverImage is now out");
                PealtreesPearlItButton.hideButton(document.PTLayout, document.PTOrigin);
                jUtils.remove(document, 'mousemove', PealtreesPearlItButton.mouseOutStillOverImageInternal);
                jUtils.remove(document, PealtreesPearlItButton.getScrollEventName(), PealtreesPearlItButton.mouseOutStillOverImageInternal);
            }
        },

        detectTextSelection : function() {
            document.addEventListener('selectionchange', function (event) {
                PealtreesPearlItButton.onSelectionChanged(event, false);
            });
            document.addEventListener('mousedown', function (event) {
                PealtreesPearlItButton.onSelectionChanged(event, true);
            });
        },

        removeDetectTextSelection : function() {
            document.removeEventListener('selectionchange', function (event) {
                PealtreesPearlItButton.onSelectionChanged(event, false);
            });
            document.removeEventListener('mousedown', function (event) {
                PealtreesPearlItButton.onSelectionChanged(event, true);
            });
        },

        onSelectionChanged : function(event, isClick) {
        	if (isClick) {
                PealtreesPearlItButton.dontShownOnSelection = "YES";
            }
            if (PealtreesPearlItButton.waitMouseUp !== null) {
                if (!isClick) {
                    PealtreesPearlItButton.dontShownOnSelection = null;
                }
                return;
            }
            PealtreesPearlItButton.waitMouseUp = 'locked';
            var textSelected = jUtils.getSelectionText();
            jUtils.listen(window, 'mouseup',
                function (e) {
            		PealtreesPearlItButton.log("selected : " + textSelected.toString());
                    if (textSelected != jUtils.getSelectionText()) {
                    	PealtreesPearlItButton.log("selection changed");
                    	return;
                    }
                    var currentSelectedText = textSelected.toString();
                    if (PealtreesPearlItButton.dontShownOnSelection !== null) {
                        PealtreesPearlItButton.hideButton(PearltreesContentHelper.TEXT_LAYOUT);
                        return;
                    }
                    if (!PealtreesPearlItButton.isNotePearlabled(currentSelectedText)) { //hide
                        PealtreesPearlItButton.log("not pearlable text");
                        PealtreesPearlItButton.hideButton(PearltreesContentHelper.TEXT_LAYOUT);
                    }
                    else {
                        PealtreesPearlItButton.currentSelectedText = currentSelectedText;
                        PealtreesPearlItButton.currentTargetUrl = document.URL;
                        var eventx = e.clientX || e.pageX;
                        var eventy = e.clientY || e.pageY;
                        var start = jUtils.getStartSelectionCoords();
                        PealtreesPearlItButton.log("start : " + start.x + " / " + (start.y + jUtils.scrollTop()));
                        var end = jUtils.getEndOfSelectionCoords();
                        PealtreesPearlItButton.log("end : " + end.x + " / " + end.y);
                        PealtreesPearlItButton.log("mouse : " + eventx + " / " + (eventy + jUtils.scrollTop()));
                        var top, left;
                        var verticalDiffEnd = Math.abs(eventy - end.y);
                        var horizontalDiffEnd = Math.abs(eventx - end.x);
                        var verticalDiffStart = Math.abs(eventy - start.y);
                        var horizontalDiffStart = Math.abs(eventx - start.x);
                        PealtreesPearlItButton.log("test : " + (verticalDiffEnd + horizontalDiffEnd) + " / " + (verticalDiffStart + horizontalDiffStart));
                        if (verticalDiffEnd + horizontalDiffEnd >= verticalDiffStart + horizontalDiffStart) {
                            PealtreesPearlItButton.log("near start");
                            top = jUtils.scrollTop() + start.y - PealtreesPearlItButton.PEARL_BUTTON_SIZE;// + 5;
                            left = start.x - PealtreesPearlItButton.PEARL_BUTTON_SIZE + 28;// + 8;
                        }
                        else {
                            PealtreesPearlItButton.log("near end");
                            top = jUtils.scrollTop() + end.y + 15;// + 5;
                            left = end.x - PealtreesPearlItButton.PEARL_BUTTON_SIZE + 4;//- 8;
                        }
                        PealtreesPearlItButton.log("show : " + top + " / " + left);
                        PealtreesPearlItButton.showButtonNewtToElement(top, left, PearltreesContentHelper.TEXT_LAYOUT);
                        PealtreesPearlItButton.waitMouseUp = null;
                    }
                }
            );
        },

        hideIfSelectionEmpty: function() {
            var emptySelection = (jUtils.getSelectionText().toString().length === 0);
            if (emptySelection) {
                PealtreesPearlItButton.log("hideIfSelectionEmpty");
                PealtreesPearlItButton.hideButton(PearltreesContentHelper.TEXT_LAYOUT);
            }

        },

        showButtonNewtToElement : function(top, left, layout, origin) {
            PealtreesPearlItButton.log("showButtonNewtToElement top = " + top + ", left = " + left + ", layout = " + layout + ", origin = " + origin + ", scrollTop = " + jUtils.scrollTop());
            var t = top;
            var l = left;
    //		var topPos = jUtils.scrollTop();
    //		if (topPos > t) {
    //			PealtreesPearlItButton.log("showButtonNewtToElement + scroll " + t + "vs" + topPos);
    //			t = topPos + t;
    //		}
            if (t < PealtreesPearlItButton.VERTICAL_MIN_MARGIN) {
                t = PealtreesPearlItButton.VERTICAL_MIN_MARGIN;
            }
            if (l < PealtreesPearlItButton.HORIZONTAL_MIN_MARGIN) {
                l = PealtreesPearlItButton.VERTICAL_MIN_MARGIN;
            }
            t = Math.floor(t);
            l = Math.floor(l);
            var button = PealtreesPearlItButton.getButtonAssociated(layout);
            jUtils.setStyle(button, 'top', t + 'px');
            jUtils.setStyle(button, 'left', l + 'px');
            PealtreesPearlItButton.showButton(layout, origin);
        },

        showButton : function(lay, origin) {
            var button = PealtreesPearlItButton.getButtonAssociated(lay);
            PealtreesPearlItButton.log("showButton " + origin + " lay = " + lay);
            if (button != null) {
                jUtils.setStyle(button, 'display', 'block');
                button.offsetHeight; //reflow
                jUtils.setStyle(button, 'opacity', 1);
            }
        },

        hideButton : function(lay, origin) {
            var button = PealtreesPearlItButton.getButtonAssociated(lay);
            PealtreesPearlItButton.log("hideButton " + lay);
            PealtreesPearlItButton.hideButtonImmediately(button);
        },

        hideButtonImmediately: function(button, isDelayed) {
            if (PealtreesPearlItButton.shouldDelayButtonHide && !isDelayed) {
                PealtreesPearlItButton.hideButtonDelayed(button);
                return;
            }
            PealtreesPearlItButton.log("hidden");
            jUtils.setStyle(button, 'display', 'none');
            jUtils.setStyle(button, 'opacity', 0);
            PealtreesPearlItButton.isFadingCss = false;
            PealtreesPearlItButton.shouldDelayButtonHide = false;
        },

        hideButtonDelayed: function(button) {
            setTimeout(function() {
                if (PealtreesPearlItButton.shouldDelayButtonHide) {
                    PealtreesPearlItButton.hideButtonImmediately(button, true);
                }
            },1000);
        },

        getButtonAssociated : function(lay) {
            PealtreesPearlItButton.log("getButton : " + lay + " - " + PealtreesPearlItButton.noteButton + " | " + PealtreesPearlItButton.pictureButton);
            if (lay === PearltreesContentHelper.TEXT_LAYOUT) {
                if (typeof PealtreesPearlItButton.noteButton === 'undefined' || PealtreesPearlItButton.noteButton == null) {
                    PealtreesPearlItButton.noteButton = document.getElementById(PealtreesPearlItButton.PEARL_BUTTON_NOTE_ID);
                }
                return PealtreesPearlItButton.noteButton;
            }
            if (typeof PealtreesPearlItButton.pictureButton === 'undefined' || PealtreesPearlItButton.pictureButton == null) {
                PealtreesPearlItButton.pictureButton = document.getElementById(PealtreesPearlItButton.PEARL_BUTTON_PICTURE_ID);
            }
            return PealtreesPearlItButton.pictureButton;
        },

        isImagePearlabled : function(target, origin, callback) {
            PealtreesPearlItButton.lastOverTarget = target;
//    		PealtreesPearlItButton.log("testing on " + target.tagName + "(" + jUtils.getAttr(target, "id") + " / " + jUtils.getAttr(target, "class") + ")");
            if (PearltreesContentHelper.isSpecialSiteImage(target, callback, origin, false)) {
                PealtreesPearlItButton.hideButtonImmediately(PealtreesPearlItButton.getButtonAssociated(PearltreesContentHelper.IMAGE_LAYOUT));
                return;
            }
            if (target.tagName !== 'IMG') {
                return;
            }
            if (typeof target.clientWidth !== 'undefined' && typeof target.clientHeight !== 'undefined') {
            	if (target.clientWidth <= PearltreesContentHelper.IMG_MIN_SIZE || target.clientHeight <= PearltreesContentHelper.IMG_MIN_SIZE) {
            		return;
            	}
            }
            var offset = jUtils.getOffset(target);
            if (!offset) {
                PealtreesPearlItButton.log("no offset");
                return;
            }
            var specialSiteOffset = PealtreesPearlItButton.getSpecialOffsetForSite(target);
            PealtreesPearlItButton.log("Special offset : left = " + specialSiteOffset.left + " top = " + specialSiteOffset.top);

            var imageUrl = PearltreesContentHelper.isImagePearlabled(target,
                function(img, resultUrl) {
                    callback(target, resultUrl, PearltreesContentHelper.IMAGE_LAYOUT, document.URL, origin, PealtreesPearlItButton.getOffsetForImageSize(img.width, img.height, specialSiteOffset.left, specialSiteOffset.top));
                },
                function() {},
                false
            );

            if (imageUrl != PealtreesPearlItButton.currentTargetUrl) {
                PealtreesPearlItButton.hideButton(PearltreesContentHelper.IMAGE_LAYOUT);
            }
        },

        getOffsetForImageSize : function(width, height, additionalLeft, additionalTop) {
            var wYield = width / PearltreesContentHelper.IMG_MAX_SIZE;
            var hYield = height / PearltreesContentHelper.IMG_MAX_SIZE;
            var finalYield = Math.min(1, Math.max(wYield, hYield));
            var margin = PealtreesPearlItButton.INSIDE_IMAGE_MIN_MARGIN + finalYield * PealtreesPearlItButton.INSIDE_IMAGE_MAX_MARGIN;
            return {top: margin + additionalTop, left: margin + additionalLeft, width : width, height: height};
        },

        isNotePearlabled : function(text) {
            return text.length > PearltreesContentHelper.TEXT_MIN_SIZE;
        },

        isNeedScrollSite : function () {
            var url = location.href;
            for (var i = 0; i < PTAddonConfig.CS_NEED_SCROLL_LIST.length; i++) {
                if (url.match(PTAddonConfig.CS_NEED_SCROLL_LIST[i])) {
                    PealtreesPearlItButton.log("Need scroll");
                    return true;
                }
            }
            PealtreesPearlItButton.log("Doesn't need scroll");
            return false;
        },

        getSpecialOffsetForSite: function(target) {
            var url = location.href;
            PealtreesPearlItButton.log("getSpecialOffsetForSite: " + url);
            for (var i = 0; i < PTAddonConfig.CS_OFFSET_SITE.length; i++) {
                var matchingPattern =  PTAddonConfig.CS_OFFSET_SITE[i];
                var offsets = matchingPattern.getOffsets(url, target);
                if (offsets != null) {
                    return offsets;
                }
            }
            return {top: 0, left: 0};
        },

        log : function(l) {
            if (console && !PEARLTREES_URL.match(/^(.*?\.|)pearltrees\.com/)) {
                console.log("PearltreesAddon : " + l);
            }
        },

        isFirefoxEnv : function() {
            return PealtreesPearlItButton.pearlerType == "firefox";
        },

        isSafariEnv : function() {
            return PealtreesPearlItButton.pearlerType == "safari";
        },

        isChromeEnv : function() {
            return PealtreesPearlItButton.pearlerType == "chrome";
        },

        getScrollEventName : function() {
            if (PealtreesPearlItButton.isFirefoxEnv()) {
                return "DOMMouseScroll";
            }
            return "mousewheel";
        }
    }

	if (typeof PearltreesContentHelper !== 'undefined') {
		PealtreesPearlItButton.init();
	}
}