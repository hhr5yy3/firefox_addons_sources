async function allowScrollingInModalPopup(){const t=await waitForElement(".clockify-integration-popup");document.addEventListener("wheel",(async e=>{e.stopImmediatePropagation();const{target:n,deltaY:a}=e,r=$(".description-textarea"),o=$("textarea",r),i=$(".tag-list"),l=$(".edit-form__project_list"),c=$(".edit-form");n.isSameNode(r)&&o.scrollBy(0,a),r?.contains(n)&&o.scrollBy(0,a),n.isSameNode(i)&&t.scrollBy(0,a),i?.contains(n)&&t.scrollBy(0,a),n.isSameNode(l)&&t.scrollBy(0,a),l?.contains(n)&&t.scrollBy(0,a),n.isSameNode(c)&&t.scrollBy(0,a)}))}async function allowMovingScrollbarInModalPopup(){document.addEventListener("mousedown",(t=>{t.target.classList.contains("clockify-integration-popup")&&t.stopImmediatePropagation()}))}async function handleDynamicStyles(){const t=await isManuallyDisabled(),e=await containerPaddingLeft(),n=cardWidth();applyStyles(`\n\t\t.Tnsqdc { \n\t\t\theight: ${t?"40px":"80px"}; \n\t\t}\n\n\t\t#xDetDlg {\n\t\t\twidth: ${n};\n\t\t}\n\n\t\t.clockify-widget-container {\n\t\t\ttop: ${t?"17px":"10px"}; \n\t\t\tpadding-left: ${e};\n\t\t}\n\t`,"clockify-custom-dynamic-styles")}function cardWidth(){return pixels(448+40*($$(".pPTZAe > div").length-3||0))}function pixels(t){return`${t}px`}async function containerPaddingLeft(){const t=await waitForElement("span[jsslot].kma42e .zZj8Pb.EaVNbc");return t?pixels(parseInt(window.getComputedStyle(t,null).getPropertyValue("padding-left").slice(0,-2))+3):"0px"}function extractStartAndEnd(t){return makeStartAndEnd(convertTo24HourFormat(replaceMonthNameToIndex(removeDayOfWeek(removeSpecialCharacters(t)))))}function removeSpecialCharacters(t){return t.replaceAll(",","").replaceAll("⋅"," ").replaceAll(" – "," - ").replaceAll(":"," ").replaceAll(/(\d)([ap]m)/g,"$1 $2")}function removeDayOfWeek(t){const e="Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" ");return t.split(" ").filter((t=>!e.includes(t))).join(" ")}function replaceMonthNameToIndex(t){const e="January February March April May June July August September October November December".split(" ");return t.split(" ").map((t=>e.includes(t)?e.indexOf(t):t)).join(" ")}function convertTo24HourFormat(t){if(!t.includes("-"))return t;const e=t.split(" - ")[0].split(" "),n=t.split(" - ")[1].split(" "),a=e.includes("am"),r=e.includes("pm"),o=n.includes("am"),i=n.includes("pm"),l=o&&!i;a||r||e.push(l?"am":"pm");const c=a&&!r,s=e.indexOf(c?"am":"pm")-2,p=n.indexOf(l?"am":"pm")-2,d=n.indexOf(l?"am":"pm")-1,u=n.indexOf(l?"am":"pm")-4,m=parseInt(e[s]),y=parseInt(n[p]),f=parseInt(n[d]),g=parseInt(n[u]);return c&&12===m?e[s]=0:c||12===m||(e[s]=m+12),l?(12===y&&0===f&&(n[p]=23,n[d]=59,n[u]=g-1),12===y&&0!==f&&(n[p]=0)):l||12===y||(n[p]=y+12),`${e.join(" ")} - ${n.join(" ")}`.replaceAll("am","").replaceAll("pm","").replaceAll("  "," ")}function makeStartAndEnd(t){const e=t.split(" ").length-1,n=(new Date).getFullYear(),a=t=>parseInt(t),r=t.split(" - ")[0]?.split(" ")?.map(a),o=t.split(" - ")[1]?.split(" ")?.map(a);let i,l,c,s,p,d,u,m,y,f;switch(e){case 1:[month,day]=t.split(" ").map(a),i=n,d=n,l=month,u=month,c=day,m=day,s=0,y=23,p=0,f=59;break;case 2:[month,day,year]=t.split(" ").map(a),i=year,d=year,l=month,u=month,c=day,m=day,s=0,y=23,p=0,f=59;break;case 7:[l,c,s,p]=r,[y,f]=o,i=n,d=n,u=l,m=c;break;case 8:[l,c,i,s,p]=r,[y,f]=o,d=i,u=l,m=c;break;case 11:[l,c,i,s,p]=r,[u,m,d,y,f]=o;break;default:throw new Error("Unsuccessfully parsing based on whitespace number.")}return{start:new Date(i,l,c,s,p),end:new Date(d,u,m,y,f)}}clockifyButton.render("span[jsslot].kma42e",{observe:!0},(t=>{if(handleDynamicStyles(),$(".clockify-widget-container"))return;const e=text("#xDetDlgWhen .AzuXid.O2VjS.CyPPBf");if(!e)return console.error("Interval can't be extracted.");const n=text('[role="heading"]',t),a=clockifyButton.createButton({description:n}),r=clockifyButton.createInput({description:n}),o=createTag("div","clockify-widget-container");if(o.append(a),o.append(r),[text(".E9bth-nBWOSb"),text(".EY8ABd-OWXEXe-TAWMXe")].includes("Create")){const t=extractStartAndEnd(e),a=t.start,r=t.end,i=clockifyButton.createEvent({description:n,start:a,end:r});o.append(i)}t.append(o)})),allowScrollingInModalPopup(),allowMovingScrollbarInModalPopup(),window.addEventListener("workspaceSettingsChanged",handleDynamicStyles),applyStyles("\n\t#xDetDlg {\n\t\tmax-width: 600px;\n\t}\n\n\t.clockify-widget-container {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(2, 1fr);\n\t\tgrid-template-rows: repeat(2, 1fr);\n\t\tgrid-column-gap: 0px;\n\t\tgrid-row-gap: 0px;\n\t\tjustify-items: flex-start;\n\t\tposition: absolute;\n\t}\n\t#clockify-manual-input-form {\n\t\tmargin-left: -25px;\n\t}\n\t#clockify-manual-input-form input {\n\t\tmargin-left: -25px;\n\t\twidth: 125px;\n\t\tmargin-left: 7px;\n\t\tbox-shadow: none;\n\t\tborder: 1px solid #eaecf0;\n\t\tbackground-color: #eaecf0;\n\t}\n\t.clockify-copy-as-entry-container {\n\t\tgrid-column: span 2;\n\t}\n\t#clockifyButton {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n");