{
  "version": 3,
  "sources": ["../../../../src/js/Steam/holidayprofile.js"],
  "sourcesContent": ["/* globals ANIMATION_TICK_RATE:writable, CAnimation:writable, $J */\r\n\r\nconst animationDefaults = {\r\n    \"height\": 130,\r\n    \"width\": 130,\r\n    \"fps\": 30\r\n};\r\n\r\nconst animations = [\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/ball_blink_1170_9_69.png\",\r\n        \"cols\": 9,\r\n        \"frames\": 69\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/ball_jump_650_5_25.png\",\r\n        \"cols\": 5,\r\n        \"frames\": 25\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/ball_wave_1170_9_78.png\",\r\n        \"cols\": 9,\r\n        \"frames\": 78\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/cupcake_blink_1040_8_60.png\",\r\n        \"cols\": 8,\r\n        \"frames\": 60\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/cupcake_jump_650_5_25.png\",\r\n        \"cols\": 5,\r\n        \"frames\": 25\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/cupcake_wave_1040_8_54.png\",\r\n        \"cols\": 8,\r\n        \"frames\": 54\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/monte_blink_1040_8_62.png\",\r\n        \"cols\": 8,\r\n        \"frames\": 62\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/monte_wave_1040_8_57.png\",\r\n        \"cols\": 8,\r\n        \"frames\": 57\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/runner_blink_1170_9_72.png\",\r\n        \"cols\": 9,\r\n        \"frames\": 72\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/runner_present_1170_9_79.png\",\r\n        \"cols\": 9,\r\n        \"frames\": 79\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/runner_wave_1170_9_68.png\",\r\n        \"cols\": 9,\r\n        \"frames\": 68\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/zippy_blink_1040_8_59.png\",\r\n        \"cols\": 8,\r\n        \"frames\": 59\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/zippy_shiv_910_7_46.png\",\r\n        \"cols\": 7,\r\n        \"frames\": 46\r\n    },\r\n    {\r\n        \"image\": \"https://community.cloudflare.steamstatic.com/public/images/profile/holidayprofile/sprite_sheets/crushed/zippy_wave_910_7_45.png\",\r\n        \"cols\": 7,\r\n        \"frames\": 45\r\n    }\r\n];\r\n\r\nANIMATION_TICK_RATE = 11;\r\n\r\nCAnimation = class {\r\n\r\n    constructor(animation, parent, x, y) {\r\n        this._animation = $J.extend({}, animationDefaults, animation);\r\n        this._x = x;\r\n        this._y = y;\r\n\r\n        this._element = $J(\"<div/>\", {\"class\": \"holidayprofile_animation\"});\r\n        this._element.css(\"height\", `${this._animation.height}px`);\r\n        this._element.css(\"width\", `${this._animation.width}px`);\r\n        this._element.css(\"background\", `url( '${this._animation.image}') no-repeat`);\r\n        this._element.appendTo(parent);\r\n        this._element.offset({\"left\": x, \"top\": y});\r\n        this._element.show();\r\n\r\n        this._frame = 0;\r\n        this._start = 0;\r\n        this._rate = 1000 / this._animation.fps;\r\n\r\n        this._interval = 0;\r\n    }\r\n\r\n    start() {\r\n        this._start = $J.now();\r\n        this._interval = window.setInterval($J.proxy(this.tick, this), ANIMATION_TICK_RATE);\r\n        CAnimation.animationsRunning++;\r\n    }\r\n\r\n    tick() {\r\n        const sElapsed = $J.now() - this._start;\r\n        const iCurFrame = Math.floor(sElapsed / this._rate);\r\n        if (iCurFrame !== this._frame) {\r\n            this._frame = iCurFrame;\r\n            if (this._frame <= this._animation.frames) {\r\n                const nBackgroundX = (this._frame % this._animation.cols) * this._animation.width;\r\n                const nBackgroundY = Math.floor(this._frame / this._animation.cols) * this._animation.height;\r\n                this._element.css(\"background-position\", `-${nBackgroundX}px -${nBackgroundY}px`);\r\n            } else {\r\n                this.destroy();\r\n            }\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        if (this._interval) { window.clearInterval(this._interval); }\r\n        this._element.remove();\r\n        CAnimation.animationsRunning--;\r\n    }\r\n};\r\n\r\nCAnimation.animationsRunning = 0;\r\n\r\nfunction animationForShowcase($Showcase) {\r\n    const nAnimation = Math.floor(Math.random() * animations.length);\r\n    const pos = $Showcase.offset();\r\n    const xpad = 100;\r\n    const x = Math.floor(Math.random() * ($Showcase.width() - (2 * xpad))) + (xpad / 2);\r\n    const Animation = new CAnimation(animations[nAnimation], $Showcase, pos.left + x, pos.top - 120);\r\n    Animation.start();\r\n}\r\n\r\nfunction startAnimation() {\r\n    const $Showcases = $J(\".profile_customization:not(.none_selected)\");\r\n    if (!$Showcases.length) { return; }\r\n\r\n    animationForShowcase($J($Showcases[0]));\r\n\r\n    $Showcases.click(function() {\r\n        animationForShowcase($J(this));\r\n    });\r\n\r\n    window.setInterval(() => {\r\n        if (CAnimation.animationsRunning === 0 && Math.random() < 0.25) {\r\n            const nScrollY = window.scrollY;\r\n            const nWindowHeight = $J(window).height();\r\n            const $VisibleShowcases = $Showcases.filter(function() {\r\n                const $Showcase = $J(this);\r\n                const nShowcaseTop = $Showcase.offset().top;\r\n                return nShowcaseTop >= nScrollY + 100 && nShowcaseTop < (nScrollY + nWindowHeight);\r\n            });\r\n            if ($VisibleShowcases.length) {\r\n                const nShowcase = Math.floor(Math.random() * $VisibleShowcases.length);\r\n                animationForShowcase($J($VisibleShowcases[nShowcase]));\r\n            }\r\n        }\r\n    }, 1500);\r\n}\r\n\r\nstartAnimation();\r\n"],
  "mappings": "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",
  "names": ["animationDefaults", "animations", "animation", "parent", "x", "y", "sElapsed", "iCurFrame", "nBackgroundX", "nBackgroundY", "animationForShowcase", "$Showcase", "nAnimation", "pos", "xpad", "startAnimation", "$Showcases", "nScrollY", "nWindowHeight", "$VisibleShowcases", "nShowcaseTop", "nShowcase"]
}
