const platformName="extension";importScripts("/firebase-app-8.10.0.min.js"),importScripts("/firebase-msg-8.10.0.min.js");const firebaseConfig={apiKey:"AIzaSyBnuytdyhVuSzo0qAhX5QWYu6Z2jTBPWog",authDomain:"solflare-d0638",projectId:"solflare-d0638",storageBucket:"solflare-d0638.appspot.com",messagingSenderId:"191112318129",appId:"1:191112318129:web:a3555b4ee54f13a6efa690"};firebase.initializeApp(firebaseConfig);const messaging=firebase.messaging();self.addEventListener("notificationclick",(async i=>{i.notification.close();const t=i.notification.data;i.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then((i=>{let o=null,e=null;try{if(t&&t.customPayload){const i=t.customPayload.match(/^([A-Za-z]+):(.*)$/);i&&i.length>=3&&(e=JSON.parse(i[2]),o=i[1])}}catch(i){console.log(i)}const n=self.location.origin.includes("extension")?`${self.location.origin}/wallet.html#`:"";let a=`${n}/portfolio`,s=["source=notification"],l=null;if(t&&(l=t.key,l||(l=t.publicKey)),t&&e&&"CustomNotification"===o){const i=l?`/deeplink/${l}`:"";"dappBrowser"===e.redirect_page?(a=`${n}${i}/externallink`,s.push(`url=${encodeURIComponent(e.destination_url)}`)):"portfolioRoute"===e.redirect_page?a=`${n}${i}/portfolio`:"portfolioStakingRoute"===e.redirect_page?a=`${n}${i}/staking`:"tradingSwap"===e.redirect_page&&(a=`${n}${i}/trade`,e.destination_mint&&"So11111111111111111111111111111111111111112"!==e.destination_mint&&(s.push("from=So11111111111111111111111111111111111111112"),s.push(`to=${e.destination_mint}`))),e.campaign_id&&s.push(`campaign_id=${e.campaign_id}`),e.notification_id&&s.push(`notification_id=${e.notification_id}`)}else t&&l?(a=`${n}/deeplink/${l}/activity`,t.dappId&&(a=`${n}/deeplink/${l}/portfolio`,s.push(`msNotificationsCenter=${t.dappId}`))):t&&t.dappId&&(a=`${n}/portfolio`,s.push(`msNotificationsCenter=${t.dappId}`));return s?.length>0&&(a+=`?${s.join("&")}`),self.clients.openWindow(a)})))})),messaging.onBackgroundMessage((i=>{let t=null,o=null;if(i.data){let e="/assets/logo-128.png";i.data.icon&&(e=i.data.icon),["notification","broadcast","cast","event"].includes(i.data.type)&&(t=i.data.title,o={body:i.data.body,icon:e,data:i.data})}t&&o&&self.registration.showNotification(t,o)}));