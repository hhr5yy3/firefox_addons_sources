var pix=function(){"use strict";var Fe=Object.defineProperty;var ue=v=>{throw TypeError(v)};var Le=(v,y,T)=>y in v?Fe(v,y,{enumerable:!0,configurable:!0,writable:!0,value:T}):v[y]=T;var ae=(v,y,T)=>Le(v,typeof y!="symbol"?y+"":y,T),oe=(v,y,T)=>y.has(v)||ue("Cannot "+T);var U=(v,y,T)=>(oe(v,y,"read from private field"),T?T.call(v):y.get(v)),B=(v,y,T)=>y.has(v)?ue("Cannot add the same private member more than once"):y instanceof WeakSet?y.add(v):y.set(v,T),Ae=(v,y,T,j)=>(oe(v,y,"write to private field"),j?j.call(v,T):y.set(v,T),T),X=(v,y,T)=>(oe(v,y,"access private method"),T);var Q,q,J,O,de,le;function v(t){return t}var y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j={exports:{}};(function(t,e){(function(r,s){s(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:y,function(r){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)r.exports=globalThis.browser;else{const s="The message port closed before a response was received.",h=g=>{const w={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(w).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class E extends WeakMap{constructor(o,u=void 0){super(u),this.createItem=o}get(o){return this.has(o)||this.set(o,this.createItem(o)),super.get(o)}}const L=c=>c&&typeof c=="object"&&typeof c.then=="function",C=(c,o)=>(...u)=>{g.runtime.lastError?c.reject(new Error(g.runtime.lastError.message)):o.singleCallbackArg||u.length<=1&&o.singleCallbackArg!==!1?c.resolve(u[0]):c.resolve(u)},b=c=>c==1?"argument":"arguments",R=(c,o)=>function(m,...x){if(x.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${b(o.minArgs)} for ${c}(), got ${x.length}`);if(x.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${b(o.maxArgs)} for ${c}(), got ${x.length}`);return new Promise((I,k)=>{if(o.fallbackToNoCallback)try{m[c](...x,C({resolve:I,reject:k},o))}catch(A){console.warn(`${c} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,A),m[c](...x),o.fallbackToNoCallback=!1,o.noCallback=!0,I()}else o.noCallback?(m[c](...x),I()):m[c](...x,C({resolve:I,reject:k},o))})},K=(c,o,u)=>new Proxy(o,{apply(m,x,I){return u.call(x,c,...I)}});let W=Function.call.bind(Object.prototype.hasOwnProperty);const i=(c,o={},u={})=>{let m=Object.create(null),x={has(k,A){return A in c||A in m},get(k,A,S){if(A in m)return m[A];if(!(A in c))return;let _=c[A];if(typeof _=="function")if(typeof o[A]=="function")_=K(c,c[A],o[A]);else if(W(u,A)){let F=R(A,u[A]);_=K(c,c[A],F)}else _=_.bind(c);else if(typeof _=="object"&&_!==null&&(W(o,A)||W(u,A)))_=i(_,o[A],u[A]);else if(W(u,"*"))_=i(_,o[A],u["*"]);else return Object.defineProperty(m,A,{configurable:!0,enumerable:!0,get(){return c[A]},set(F){c[A]=F}}),_;return m[A]=_,_},set(k,A,S,_){return A in m?m[A]=S:c[A]=S,!0},defineProperty(k,A,S){return Reflect.defineProperty(m,A,S)},deleteProperty(k,A){return Reflect.deleteProperty(m,A)}},I=Object.create(c);return new Proxy(I,x)},n=c=>({addListener(o,u,...m){o.addListener(c.get(u),...m)},hasListener(o,u){return o.hasListener(c.get(u))},removeListener(o,u){o.removeListener(c.get(u))}}),a=new E(c=>typeof c!="function"?c:function(u){const m=i(u,{},{getContent:{minArgs:0,maxArgs:0}});c(m)}),l=new E(c=>typeof c!="function"?c:function(u,m,x){let I=!1,k,A=new Promise(V=>{k=function(P){I=!0,V(P)}}),S;try{S=c(u,m,k)}catch(V){S=Promise.reject(V)}const _=S!==!0&&L(S);if(S!==!0&&!_&&!I)return!1;const F=V=>{V.then(P=>{x(P)},P=>{let ie;P&&(P instanceof Error||typeof P.message=="string")?ie=P.message:ie="An unexpected error occurred",x({__mozWebExtensionPolyfillReject__:!0,message:ie})}).catch(P=>{console.error("Failed to send onMessage rejected reply",P)})};return F(_?S:A),!0}),d=({reject:c,resolve:o},u)=>{g.runtime.lastError?g.runtime.lastError.message===s?o():c(new Error(g.runtime.lastError.message)):u&&u.__mozWebExtensionPolyfillReject__?c(new Error(u.message)):o(u)},f=(c,o,u,...m)=>{if(m.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${b(o.minArgs)} for ${c}(), got ${m.length}`);if(m.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${b(o.maxArgs)} for ${c}(), got ${m.length}`);return new Promise((x,I)=>{const k=d.bind(null,{resolve:x,reject:I});m.push(k),u.sendMessage(...m)})},M={devtools:{network:{onRequestFinished:n(a)}},runtime:{onMessage:n(l),onMessageExternal:n(l),sendMessage:f.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:f.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return w.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},i(g,M,w)};r.exports=h(chrome)}})})(j);var he=j.exports;const $=T(he);var ce=Object.prototype.hasOwnProperty;function ee(t,e){var r,s;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((s=t.length)===e.length)for(;s--&&ee(t[s],e[s]););return s===-1}if(!r||typeof t=="object"){s=0;for(r in t)if(ce.call(t,r)&&++s&&!ce.call(e,r)||!(r in e)||!ee(t[r],e[r]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}function G(t,...e){}const Y={debug:(...t)=>G(console.debug,...t),log:(...t)=>G(console.log,...t),warn:(...t)=>G(console.warn,...t),error:(...t)=>G(console.error,...t)};function fe(t){return Array.isArray(t)?t:[t]}const we=new Error("request for lock canceled");var xe=function(t,e,r,s){function h(g){return g instanceof r?g:new r(function(w){w(g)})}return new(r||(r=Promise))(function(g,w){function E(b){try{C(s.next(b))}catch(R){w(R)}}function L(b){try{C(s.throw(b))}catch(R){w(R)}}function C(b){b.done?g(b.value):h(b.value).then(E,L)}C((s=s.apply(t,e||[])).next())})};class ve{constructor(e,r=we){this._value=e,this._cancelError=r,this._queue=[],this._weightedWaiters=[]}acquire(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((s,h)=>{const g={resolve:s,reject:h,weight:e,priority:r},w=ge(this._queue,E=>r<=E.priority);w===-1&&e<=this._value?this._dispatchItem(g):this._queue.splice(w+1,0,g)})}runExclusive(e){return xe(this,arguments,void 0,function*(r,s=1,h=0){const[g,w]=yield this.acquire(s,h);try{return yield r(g)}finally{w()}})}waitForUnlock(e=1,r=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,r)?Promise.resolve():new Promise(s=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),ye(this._weightedWaiters[e-1],{resolve:s,priority:r})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){const r=this._value;this._value-=e.weight,e.resolve([r,this._newReleaser(e.weight)])}_newReleaser(e){let r=!1;return()=>{r||(r=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){const r=this._weightedWaiters[e-1];r&&(r.forEach(s=>s.resolve()),this._weightedWaiters[e-1]=[])}else{const e=this._queue[0].priority;for(let r=this._value;r>0;r--){const s=this._weightedWaiters[r-1];if(!s)continue;const h=s.findIndex(g=>g.priority<=e);(h===-1?s:s.splice(0,h)).forEach(g=>g.resolve())}}}_couldLockImmediately(e,r){return(this._queue.length===0||this._queue[0].priority<r)&&e<=this._value}}function ye(t,e){const r=ge(t,s=>e.priority<=s.priority);t.splice(r+1,0,e)}function ge(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r]))return r;return-1}var pe=function(t,e,r,s){function h(g){return g instanceof r?g:new r(function(w){w(g)})}return new(r||(r=Promise))(function(g,w){function E(b){try{C(s.next(b))}catch(R){w(R)}}function L(b){try{C(s.throw(b))}catch(R){w(R)}}function C(b){b.done?g(b.value):h(b.value).then(E,L)}C((s=s.apply(t,e||[])).next())})};class be{constructor(e){this._semaphore=new ve(1,e)}acquire(){return pe(this,arguments,void 0,function*(e=0){const[,r]=yield this._semaphore.acquire(1,e);return r})}runExclusive(e,r=0){return this._semaphore.runExclusive(()=>e(),1,r)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const re=Ee();function Ee(){const t={local:Z("local"),session:Z("session"),sync:Z("sync"),managed:Z("managed")},e=i=>{const n=t[i];if(n==null){const a=Object.keys(t).join(", ");throw Error(`Invalid area "${i}". Options: ${a}`)}return n},r=i=>{const n=i.indexOf(":"),a=i.substring(0,n),l=i.substring(n+1);if(l==null)throw Error(`Storage key should be in the form of "area:key", but received "${i}"`);return{driverArea:a,driverKey:l,driver:e(a)}},s=i=>i+"$",h=(i,n)=>i??n??null,g=i=>typeof i=="object"&&!Array.isArray(i)?i:{},w=async(i,n,a)=>{const l=await i.getItem(n);return h(l,(a==null?void 0:a.fallback)??(a==null?void 0:a.defaultValue))},E=async(i,n)=>{const a=s(n),l=await i.getItem(a);return g(l)},L=async(i,n,a)=>{await i.setItem(n,a??null)},C=async(i,n,a)=>{const l=s(n),f={...g(await i.getItem(l))};Object.entries(a).forEach(([M,p])=>{p==null?delete f[M]:f[M]=p}),await i.setItem(l,f)},b=async(i,n,a)=>{if(await i.removeItem(n),a!=null&&a.removeMeta){const l=s(n);await i.removeItem(l)}},R=async(i,n,a)=>{const l=s(n);if(a==null)await i.removeItem(l);else{const d=g(await i.getItem(l));fe(a).forEach(f=>delete d[f]),await i.setItem(l,d)}},K=(i,n,a)=>i.watch(n,a);return{getItem:async(i,n)=>{const{driver:a,driverKey:l}=r(i);return await w(a,l,n)},getItems:async i=>{const n=new Map,a=new Map;return i.forEach(d=>{let f,M;typeof d=="string"?f=d:(f=d.key,M=d.options);const{driverArea:p,driverKey:c}=r(f),o=n.get(p)??[];n.set(p,o.concat(c)),a.set(f,M)}),(await Promise.all(Array.from(n.entries()).map(async([d,f])=>(await t[d].getItems(f)).map(p=>{const c=`${d}:${p.key}`,o=a.get(c),u=h(p.value,(o==null?void 0:o.fallback)??(o==null?void 0:o.defaultValue));return{key:c,value:u}})))).flat()},getMeta:async i=>{const{driver:n,driverKey:a}=r(i);return await E(n,a)},setItem:async(i,n)=>{const{driver:a,driverKey:l}=r(i);await L(a,l,n)},setItems:async i=>{const n=new Map;i.forEach(({key:a,value:l})=>{const{driverArea:d,driverKey:f}=r(a),M=n.get(d)??[];n.set(d,M.concat({key:f,value:l}))}),await Promise.all(Array.from(n.entries()).map(async([a,l])=>{await e(a).setItems(l)}))},setMeta:async(i,n)=>{const{driver:a,driverKey:l}=r(i);await C(a,l,n)},removeItem:async(i,n)=>{const{driver:a,driverKey:l}=r(i);await b(a,l,n)},removeItems:async i=>{const n=new Map;i.forEach(a=>{let l,d;typeof a=="string"?l=a:(l=a.key,d=a.options);const{driverArea:f,driverKey:M}=r(l),p=n.get(f)??[];p.push(M),d!=null&&d.removeMeta&&p.push(s(M)),n.set(f,p)}),await Promise.all(Array.from(n.entries()).map(async([a,l])=>{await e(a).removeItems(l)}))},removeMeta:async(i,n)=>{const{driver:a,driverKey:l}=r(i);await R(a,l,n)},snapshot:async(i,n)=>{var d;const l=await e(i).snapshot();return(d=n==null?void 0:n.excludeKeys)==null||d.forEach(f=>{delete l[f],delete l[s(f)]}),l},restoreSnapshot:async(i,n)=>{await e(i).restoreSnapshot(n)},watch:(i,n)=>{const{driver:a,driverKey:l}=r(i);return K(a,l,n)},unwatch(){Object.values(t).forEach(i=>{i.unwatch()})},defineItem:(i,n)=>{const{driver:a,driverKey:l}=r(i),{version:d=1,migrations:f={}}=n??{};if(d<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const M=async()=>{var _;const m=s(l),[{value:x},{value:I}]=await a.getItems([l,m]);if(x==null)return;const k=(I==null?void 0:I.v)??1;if(k>d)throw Error(`Version downgrade detected (v${k} -> v${d}) for "${i}"`);Y.debug(`Running storage migration for ${i}: v${k} -> v${d}`);const A=Array.from({length:d-k},(F,V)=>k+V+1);let S=x;for(const F of A)S=await((_=f==null?void 0:f[F])==null?void 0:_.call(f,S))??S;await a.setItems([{key:l,value:S},{key:m,value:{...I,v:d}}]),Y.debug(`Storage migration completed for ${i} v${d}`,{migratedValue:S})},p=(n==null?void 0:n.migrations)==null?Promise.resolve():M().catch(m=>{Y.error(`Migration failed for ${i}`,m)}),c=new be,o=()=>(n==null?void 0:n.fallback)??(n==null?void 0:n.defaultValue)??null,u=()=>c.runExclusive(async()=>{const m=await a.getItem(l);if(m!=null||(n==null?void 0:n.init)==null)return m;const x=await n.init();return await a.setItem(l,x),x});return p.then(u),{get defaultValue(){return o()},get fallback(){return o()},getValue:async()=>(await p,n!=null&&n.init?await u():await w(a,l,n)),getMeta:async()=>(await p,await E(a,l)),setValue:async m=>(await p,await L(a,l,m)),setMeta:async m=>(await p,await C(a,l,m)),removeValue:async m=>(await p,await b(a,l,m)),removeMeta:async m=>(await p,await R(a,l,m)),watch:m=>K(a,l,(x,I)=>m(x??o(),I??o())),migrate:M}}}}function Z(t){const e=()=>{if($.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if($.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const s=$.storage[t];if(s==null)throw Error(`"browser.storage.${t}" is undefined`);return s},r=new Set;return{getItem:async s=>(await e().get(s))[s],getItems:async s=>{const h=await e().get(s);return s.map(g=>({key:g,value:h[g]??null}))},setItem:async(s,h)=>{h==null?await e().remove(s):await e().set({[s]:h})},setItems:async s=>{const h=s.reduce((g,{key:w,value:E})=>(g[w]=E,g),{});await e().set(h)},removeItem:async s=>{await e().remove(s)},removeItems:async s=>{await e().remove(s)},snapshot:async()=>await e().get(),restoreSnapshot:async s=>{await e().set(s)},watch(s,h){const g=w=>{const E=w[s];E!=null&&(ee(E.newValue,E.oldValue)||h(E.newValue??null,E.oldValue??null))};return e().onChanged.addListener(g),r.add(g),()=>{e().onChanged.removeListener(g),r.delete(g)}},unwatch(){r.forEach(s=>{e().onChanged.removeListener(s)}),r.clear()}}}let N;function _e(t,e){N={debug:(...r)=>{e(t,"DEBUG",r)},info:(...r)=>{e(t,"INFO",r)},warn:(...r)=>{e(t,"WARN",r)},error:(...r)=>{e(t,"ERROR",r)}}}function Ie(t,e,r){$.runtime.sendMessage(void 0,{event:"pix:log",context:t,level:e,args:r}).catch(console.error)}function Te(t){_e(t,Ie)}async function te(t){await re.setItem("local:activated",t)}async function ke(){await re.setItem("local:activation-time",Me())}async function Se(){await re.removeItem("local:activation-time")}function Me(){return Math.round(Date.now()/1e3/60)}const Ce={matches:["https://app.pix.fr/*","https://app.integration.pix.fr/*","https://app.recette.pix.fr/*","https://*.review.pix.fr/*","https://app.pix.org/*","https://app.integration.pix.org/*","https://app.recette.pix.org/*","https://*.review.pix.org/*"],main(t){Te("pix.content"),Re(t)}};function Re(t){t.addEventListener(window,"pix:certification:start",()=>{N.info("Démarrage de la certification"),te(!0).catch(N.error),ke().catch(N.error)}),t.addEventListener(window,"pix:certification:stop",()=>{N.info("Fin de la certification"),te(!1).catch(N.error),Se().catch(N.error)});const{version:e}=$.runtime.getManifest();t.addEventListener(window,"pix:companion:ping",r=>{t.isInvalid||(N.debug("Ping de Pix App reçu"),window.dispatchEvent(new CustomEvent("pix:companion:pong",{detail:{version:e}})),r.detail!=null&&te(r.detail.shouldBeActivated).catch(N.error))})}const Pe={BASE_URL:"/",BROWSER:"firefox",CHROME:!1,COMMAND:"build",DEV:!1,EDGE:!1,ENTRYPOINT:"pix",FIREFOX:!0,MANIFEST_VERSION:2,MODE:"production",OPERA:!1,PROD:!0,SAFARI:!1,SSR:!1,VITE_CJS_IGNORE_WARNING:"true",VITE_REVISION:"3a23e6465af3ad22426cfa4c7e04907477a45c36"},H=class H extends Event{constructor(e,r){super(H.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=r}};ae(H,"EVENT_NAME",me("wxt:locationchange"));let se=H;function me(t){var r;const e=typeof Pe>"u"?"build":"pix";return`${(r=$==null?void 0:$.runtime)==null?void 0:r.id}:${e}:${t}`}function $e(t){let e,r;return{run(){e==null&&(r=new URL(location.href),e=t.setInterval(()=>{let s=new URL(location.href);s.href!==r.href&&(window.dispatchEvent(new se(s,r)),r=s)},1e3))}}}const D=class D{constructor(e,r){B(this,O);B(this,Q,window.self===window.top);B(this,q);B(this,J,$e(this));this.contentScriptName=e,this.options=r,Ae(this,q,new AbortController),U(this,Q)?(X(this,O,le).call(this,{ignoreFirstEvent:!0}),X(this,O,de).call(this)):X(this,O,le).call(this)}get signal(){return U(this,q).signal}abort(e){return U(this,q).abort(e)}get isInvalid(){return $.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,r){const s=setInterval(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearInterval(s)),s}setTimeout(e,r){const s=setTimeout(()=>{this.isValid&&e()},r);return this.onInvalidated(()=>clearTimeout(s)),s}requestAnimationFrame(e){const r=requestAnimationFrame((...s)=>{this.isValid&&e(...s)});return this.onInvalidated(()=>cancelAnimationFrame(r)),r}requestIdleCallback(e,r){const s=requestIdleCallback((...h)=>{this.signal.aborted||e(...h)},r);return this.onInvalidated(()=>cancelIdleCallback(s)),s}addEventListener(e,r,s,h){var g;r==="wxt:locationchange"&&this.isValid&&U(this,J).run(),(g=e.addEventListener)==null||g.call(e,r.startsWith("wxt:")?me(r):r,s,{...h,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Y.debug(`Content script "${this.contentScriptName}" context invalidated`)}};Q=new WeakMap,q=new WeakMap,J=new WeakMap,O=new WeakSet,de=function(){window.postMessage({type:D.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")},le=function(e){let r=!0;const s=h=>{var g,w;if(((g=h.data)==null?void 0:g.type)===D.SCRIPT_STARTED_MESSAGE_TYPE&&((w=h.data)==null?void 0:w.contentScriptName)===this.contentScriptName){const E=r;if(r=!1,E&&(e!=null&&e.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",s),this.onInvalidated(()=>removeEventListener("message",s))},ae(D,"SCRIPT_STARTED_MESSAGE_TYPE","wxt:content-script-started");let ne=D;function Ve(){}function z(t,...e){}const Ne={debug:(...t)=>z(console.debug,...t),log:(...t)=>z(console.log,...t),warn:(...t)=>z(console.warn,...t),error:(...t)=>z(console.error,...t)};return(async()=>{try{const{main:t,...e}=Ce,r=new ne("pix",e);return await t(r)}catch(t){throw Ne.error('The content script "pix" crashed on startup!',t),t}})()}();
pix;
