{"version":3,"sources":["popup.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"popup.js","sourcesContent":["(function()\n{\n  'use strict';\n\n  class Popup {\n    constructor() {\n      this.Storage = chrome.storage.sync;\n      this.data = {};\n      this.defaults = {\n        columnWidth: 200,\n        enabled: true,\n        standup: false,\n        updatedEvent: 'better-jira:updated',\n      };\n\n      this.setDefaults();\n      this.handleFormSubmissions();\n    }\n\n    setDefaults() {\n      this.Storage.get('columnWidth', (storage) => {\n        console.log('storage', storage);\n        let value = storage.columnWidth;\n        console.log('columnWidth from Storage', value);\n        if(!value) {\n          value = this.defaults.columnWidth;\n          this.Storage.set({columnWidth: value});\n        }\n        this.data.columnWidth = value;\n\n        document.getElementById('columnWidth').value = this.data.columnWidth;\n      });\n\n      this.Storage.get('enabled', (storage) => {\n        let value = storage.enabled;\n        if(value === undefined) {\n          value = this.defaults.enabled;\n          this.Storage.set({enabled: value});\n        }\n\n        this.data.enabled = value;\n        console.log('enabled storage', storage);\n\n        document.getElementById('enabled').checked = !! value;\n      });\n\n      this.Storage.get('standup', (storage) => {\n        let value = storage.standup;\n        if(value === undefined) {\n          value = this.defaults.standup;\n          this.Storage.set({standup: value});\n        }\n\n        this.data.standup = value;\n        console.log('standup storage', storage);\n\n        document.getElementById('standup').checked = !! value;\n      });\n    }\n\n    handleFormSubmissions() {\n      let standup = document.getElementById('standup')\n      standup.addEventListener('click', (event) => {\n        console.log('you clicked it!', standup.checked, event);\n        this.data.standup = standup.checked;\n        console.log('css', this.defaults.standupCss);\n        this.save();\n      });\n\n      document.getElementById('better-jira').addEventListener('submit', (event) => {\n        event.preventDefault();\n        console.log('form submission information', arguments);\n        this.data.columnWidth = document.getElementById('columnWidth').value;\n        this.data.enabled = document.getElementById('enabled').checked;\n        this.save();\n      });\n    }\n\n    save() {\n      this.Storage.set({enabled: this.data.enabled}, () => {\n        this.Storage.set({columnWidth: this.data.columnWidth}, () => {\n          this.Storage.set({standup: this.data.standup}, this.refresh.bind(this));\n        });\n      });\n    }\n\n    refresh() {\n      let code = [\n        `(function()`,\n        `{`,\n          `'use strict';`,\n\n          `let updateEvent = new CustomEvent('${this.defaults.updatedEvent}', {`,\n            `detail: {`,\n              `columnWidth: ${this.data.columnWidth},`,\n              `enabled: ${this.data.enabled},`,\n              `standup: ${this.data.standup},`,\n            `}`,\n          `});`,\n          `document.dispatchEvent(updateEvent);`,\n        `})();`,\n      ];\n\n      chrome.tabs.executeScript({\n        code: code.join('')\n      });\n    }\n  }\n\n  window.addEventListener('load', function initiate() {\n    window.removeEventListener('load', initiate);\n\n    new Popup();\n\n    console.log('You are here!');\n  })\n})();\n"]}