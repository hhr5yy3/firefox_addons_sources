var MutationObserverCtor,__extends=this.__extends||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i};if(void 0===(MutationObserverCtor="undefined"!=typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver))throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");var Movement,NodeMap=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e==e>>>0},e.prototype.nodeId=function(t){var a=t[e.ID_PROP];return a||(a=t[e.ID_PROP]=e.nextId_++),a},e.prototype.set=function(e,t){var a=this.nodeId(e);this.nodes[a]=e,this.values[a]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype.delete=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=void 0},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP="__mutation_summary_node_map_id__",e.nextId_=1,e}();function enteredOrExited(e){return 1===e||5===e}!function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(Movement||(Movement={}));var NodeChange=function(){function e(e,t,a,i,n,o,r,s){void 0===t&&(t=!1),void 0===a&&(a=!1),void 0===i&&(i=!1),void 0===n&&(n=null),void 0===o&&(o=!1),void 0===r&&(r=null),void 0===s&&(s=null),this.node=e,this.childList=t,this.attributes=a,this.characterData=i,this.oldParentNode=n,this.added=o,this.attributeOldValues=r,this.characterDataOldValue=s,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}return e.prototype.getAttributeOldValue=function(e){if(this.attributeOldValues)return this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),ChildListChange=function(){this.added=new NodeMap,this.removed=new NodeMap,this.maybeMoved=new NodeMap,this.oldPrevious=new NodeMap,this.moved=void 0},TreeChanges=function(e){function t(t,a){e.call(this),this.rootNode=t,this.reachableCache=void 0,this.wasReachableCache=void 0,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var i=0;i<a.length;i++){var n=a[i];switch(n.type){case"childList":this.anyParentsChanged=!0;for(var o=0;o<n.removedNodes.length;o++){var r=n.removedNodes[o];this.getChange(r).removedFromParent(n.target)}for(o=0;o<n.addedNodes.length;o++){r=n.addedNodes[o];this.getChange(r).insertedIntoParent()}break;case"attributes":this.anyAttributesChanged=!0,this.getChange(n.target).attributeMutated(n.attributeName,n.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0,this.getChange(n.target).characterDataMutated(n.oldValue)}}}return __extends(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new NodeChange(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new NodeMap;var t=this.reachableCache.get(e);return void 0===t&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new NodeMap;var t=this.wasReachableCache.get(e);return void 0===t&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?2:1:this.getWasReachable(e)?5:0},t}(NodeMap),MutationProjection=function(){function e(e,t,a,i,n){this.rootNode=e,this.mutations=t,this.selectors=a,this.calcReordered=i,this.calcOldPreviousSibling=n,this.treeChanges=new TreeChanges(e,t),this.entered=[],this.exited=[],this.stayedIn=new NodeMap,this.visited=new NodeMap,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],void 0)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var a=this.treeChanges.get(e),i=t;if((a&&a.childList||null==i)&&(i=this.treeChanges.reachabilityChange(e)),0!==i){if(this.matchabilityChange(e),1===i)this.entered.push(e);else if(5===i)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(2===i){var n=2;a&&a.childList&&(a.oldParentNode!==e.parentNode?(n=3,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(n=4)),this.stayedIn.set(e,n)}if(2!==i)for(var o=e.firstChild;o;o=o.nextSibling)this.visitNode(o,i)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=e.parentNode,a=this.treeChanges.get(e);a&&a.oldParentNode&&(t=a.oldParentNode);var i=this.childListChangeMap.get(t);i||(i=new ChildListChange,this.childListChangeMap.set(t,i)),i.oldPrevious.has(e)||i.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,a){this.selectors=t,this.characterDataOnly=a;for(var i=0;i<this.entered.length;i++){var n=this.entered[i];1!==(s=this.matchabilityChange(n))&&2!==s||e.added.push(n)}var o=this.stayedIn.keys();for(i=0;i<o.length;i++){n=o[i];if(1===(s=this.matchabilityChange(n)))e.added.push(n);else if(5===s)e.removed.push(n);else if(2===s&&(e.reparented||e.reordered)){var r=this.stayedIn.get(n);e.reparented&&3===r?e.reparented.push(n):e.reordered&&4===r&&e.reordered.push(n)}}for(i=0;i<this.exited.length;i++){var s;n=this.exited[i];5!==(s=this.matchabilityChange(n))&&2!==s||e.removed.push(n)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var a=this.treeChanges.reachabilityChange(e);if(0===a||1===a)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,a=this.treeChanges.get(e);a&&a.oldParentNode&&(t=a.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)throw Error("getOldPreviousSibling requested on invalid node.");return i.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var a=this.treeChanges.get(e);if(!a||!a.attributes)throw Error("getOldAttribute requested on invalid node.");var i=a.getAttributeOldValue(t);if(void 0===i)throw Error("getOldAttribute requested for unchanged attribute name.");return i},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,a;if(e){t={},a={};for(var i=0;i<e.length;i++){t[c=e[i]]=!0,a[c.toLowerCase()]=c}}var n={},o=this.treeChanges.keys();for(i=0;i<o.length;i++){var r=o[i],s=this.treeChanges.get(r);if(s.attributes&&(2===this.treeChanges.reachabilityChange(r)&&2===this.matchabilityChange(r)))for(var d=r,l=s.getAttributeNamesMutated(),u=0;u<l.length;u++){var c=l[u];if(!t||t[c]||s.isCaseInsensitive&&a[c])s.getAttributeOldValue(c)!==d.getAttribute(c)&&(a&&s.isCaseInsensitive&&(c=a[c]),n[c]=n[c]||[],n[c].push(d))}}return n},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],a=0;a<e.length;a++){var i=e[a];if(2===this.treeChanges.reachabilityChange(i)){var n=this.treeChanges.get(i);n.characterData&&i.textContent!=n.characterDataOldValue&&t.push(i)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new NodeMap);var a=this.matchCache[e.uid],i=a.get(t);return void 0===i&&(i=e.matchabilityChange(t,this.treeChanges.get(t)),a.set(t,i)),i},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return 2;default:return 0}if(!this.selectors)return 2;if(e.nodeType!==Node.ELEMENT_NODE)return 0;for(var a=e,i=this.selectors.map((function(e){return t.computeMatchabilityChange(e,a)})),n=0,o=0;2!==n&&o<i.length;){switch(i[o]){case 2:n=2;break;case 1:n=5===n?2:1;break;case 5:n=1===n?2:5}o++}return n},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new ChildListChange,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new NodeMap;for(var e=0;e<this.mutations.length;e++){var t=this.mutations[e];if("childList"==t.type&&(2===this.treeChanges.reachabilityChange(t.target)||this.calcOldPreviousSibling)){for(var a=this.getChildlistChange(t.target),i=t.previousSibling,n=0;n<t.removedNodes.length;n++){r(o=t.removedNodes[n],i),a.added.has(o)?a.added.delete(o):(a.removed.set(o,!0),a.maybeMoved.delete(o)),i=o}r(t.nextSibling,i);for(n=0;n<t.addedNodes.length;n++){var o=t.addedNodes[n];a.removed.has(o)?(a.removed.delete(o),a.maybeMoved.set(o,!0)):a.added.set(o,!0)}}function r(e,t){!e||a.oldPrevious.has(e)||a.added.has(e)||a.maybeMoved.has(e)||t&&(a.added.has(t)||a.maybeMoved.has(t))||a.oldPrevious.set(e,t)}}}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=e.parentNode,a=this.treeChanges.get(e);a&&a.oldParentNode&&(t=a.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)return!1;if(i.moved)return i.moved.get(e);i.moved=new NodeMap;var n=new NodeMap;function o(e){if(!e)return!1;if(!i.maybeMoved.has(e))return!1;var t=i.moved.get(e);return void 0!==t||(n.has(e)?t=!0:(n.set(e,!0),t=function(e){if(s.has(e))return s.get(e);var t=e.previousSibling;for(;t&&(i.added.has(t)||o(t));)t=t.previousSibling;return s.set(e,t),t}(e)!==function e(t){var a=r.get(t);if(void 0!==a)return a;a=i.oldPrevious.get(t);for(;a&&(i.removed.has(a)||o(a));)a=e(a);void 0===a&&(a=t.previousSibling);return r.set(t,a),a}(e)),n.has(e)?(n.delete(e),i.moved.set(e,t)):t=i.moved.get(e)),t}var r=new NodeMap;var s=new NodeMap;return i.maybeMoved.keys().forEach(o),i.moved.get(e)},e}(),Summary=function(){function e(e,t){var a=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element?[]:void 0,this.reordered=t.all?[]:void 0,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var i=t.attribute?[t.attribute]:t.attributeList,n=e.attributeChangedNodes(i);t.attribute?this.valueChanged=n[t.attribute]||[]:(this.attributeChanged=n,t.attributeList&&t.attributeList.forEach((function(e){a.attributeChanged.hasOwnProperty(e)||(a.attributeChanged[e]=[])})))}if(t.all||t.characterData){var o=e.getCharacterDataChanged();t.characterData?this.valueChanged=o:this.characterDataChanged=o}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}(),validNameInitialChar=/[a-zA-Z_]+/,validNameNonInitialChar=/[a-zA-Z0-9_\-]+/;function escapeQuotes(e){return'"'+e.replace(/"/,'\\"')+'"'}var Qualifier=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),a=0;a<t.length;a++)if(this.attrValue===t[a])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+escapeQuotes(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+escapeQuotes(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},e}(),Selector=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}var t;return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,a){if(!t||!t.attributes)return a;var i=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==i&&i!==e.tagName)return!1;for(var n=[],o=!1,r=0;r<this.qualifiers.length;r++){var s=this.qualifiers[r],d=t.getAttributeOldValue(s.attrName);n.push(d),o=o||void 0!==d}if(!o)return a;for(r=0;r<this.qualifiers.length;r++){s=this.qualifiers[r];if(void 0===(d=n[r])&&(d=e.getAttribute(s.attrName)),!s.matches(d))return!1}return!0},e.prototype.matchabilityChange=function(e,t){var a=this.isMatching(e);return a?this.wasMatching(e,t,a)?2:1:this.wasMatching(e,t,a)?5:0},e.parseSelectors=function(t){var a,i,n=[];function o(){a&&(i&&(a.qualifiers.push(i),i=void 0),n.push(a)),a=new e}function r(){i&&a.qualifiers.push(i),i=new Qualifier}for(var s,d=/\s/,l="Invalid or unsupported selector syntax.",u=1,c=0;c<t.length;){var m=t[c++];switch(u){case 1:if(m.match(validNameInitialChar)){o(),a.tagName=m,u=2;break}if("*"==m){o(),a.tagName="*",u=3;break}if("."==m){o(),r(),a.tagName="*",i.attrName="class",i.contains=!0,u=4;break}if("#"==m){o(),r(),a.tagName="*",i.attrName="id",u=4;break}if("["==m){o(),r(),a.tagName="*",i.attrName="",u=6;break}if(m.match(d))break;throw Error(l);case 2:if(m.match(validNameNonInitialChar)){a.tagName+=m;break}if("."==m){r(),i.attrName="class",i.contains=!0,u=4;break}if("#"==m){r(),i.attrName="id",u=4;break}if("["==m){r(),i.attrName="",u=6;break}if(m.match(d)){u=14;break}if(","==m){u=1;break}throw Error(l);case 3:if("."==m){r(),i.attrName="class",i.contains=!0,u=4;break}if("#"==m){r(),i.attrName="id",u=4;break}if("["==m){r(),i.attrName="",u=6;break}if(m.match(d)){u=14;break}if(","==m){u=1;break}throw Error(l);case 4:if(m.match(validNameInitialChar)){i.attrValue=m,u=5;break}throw Error(l);case 5:if(m.match(validNameNonInitialChar)){i.attrValue+=m;break}if("."==m){r(),i.attrName="class",i.contains=!0,u=4;break}if("#"==m){r(),i.attrName="id",u=4;break}if("["==m){r(),u=6;break}if(m.match(d)){u=14;break}if(","==m){u=1;break}throw Error(l);case 6:if(m.match(validNameInitialChar)){i.attrName=m,u=7;break}if(m.match(d))break;throw Error(l);case 7:if(m.match(validNameNonInitialChar)){i.attrName+=m;break}if(m.match(d)){u=8;break}if("~"==m){i.contains=!0,u=9;break}if("="==m){i.attrValue="",u=11;break}if("]"==m){u=3;break}throw Error(l);case 8:if("~"==m){i.contains=!0,u=9;break}if("="==m){i.attrValue="",u=11;break}if("]"==m){u=3;break}if(m.match(d))break;throw Error(l);case 9:if("="==m){i.attrValue="",u=11;break}throw Error(l);case 10:if("]"==m){u=3;break}if(m.match(d))break;throw Error(l);case 11:if(m.match(d))break;if('"'==m||"'"==m){s=m,u=13;break}i.attrValue+=m,u=12;break;case 12:if(m.match(d)){u=10;break}if("]"==m){u=3;break}if("'"==m||'"'==m)throw Error(l);i.attrValue+=m;break;case 13:if(m==s){u=10;break}i.attrValue+=m;break;case 14:if(m.match(d))break;if(","==m){u=1;break}throw Error(l)}}switch(u){case 1:case 2:case 3:case 5:case 14:o();break;default:throw Error(l)}if(!n.length)throw Error(l);return n},e.nextUid=1,e.matchesSelector="function"==typeof(t=document.createElement("div")).webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof t.mozMatchesSelector?"mozMatchesSelector":"function"==typeof t.msMatchesSelector?"msMatchesSelector":"matchesSelector",e}(),attributeFilterPattern=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function validateAttribute(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(attributeFilterPattern))throw Error("Invalid request option. invalid attribute name: "+e);return e}function validateElementAttributes(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},a={},i=e.split(/\s+/),n=0;n<i.length;n++){if(o=i[n]){var o,r=(o=validateAttribute(o)).toLowerCase();if(t[r])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");a[o]=!0,t[r]=!0}}return Object.keys(a)}function elementFilterAttributes(e){var t={};return e.forEach((function(e){e.qualifiers.forEach((function(e){t[e.attrName]=!0}))})),Object.keys(t)}var MutationSummary=function(){function e(t){var a=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map((function(e){return e.elementFilter?e.elementFilter:[]}))),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some((function(e){return e.all})),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map((function(t){return e.createQueryValidator(a.root,t)}))),this.observer=new MutationObserverCtor((function(e){a.observerCallback(e)})),this.reconnect()}return e.createObserverOptions=function(e){var t,a={childList:!0,subtree:!0};function i(e){a.attributes&&!t||(a.attributes=!0,a.attributeOldValue=!0,e?(t=t||{},e.forEach((function(e){t[e]=!0,t[e.toLowerCase()]=!0}))):t=void 0)}return e.forEach((function(e){if(e.characterData)return a.characterData=!0,void(a.characterDataOldValue=!0);if(e.all)return i(),a.characterData=!0,void(a.characterDataOldValue=!0);if(e.attribute)i([e.attribute.trim()]);else{var t=elementFilterAttributes(e.elementFilter).concat(e.attributeList||[]);t.length&&i(t)}})),t&&(a.attributeFilter=Object.keys(t)),a},e.validateOptions=function(t){for(var a in t)if(!(a in e.optionKeys))throw Error("Invalid option: "+a);if("function"!=typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var i={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},n=0;n<t.queries.length;n++){var o=t.queries[n];if(o.all){if(Object.keys(o).length>1)throw Error("Invalid request option. all has no options.");i.queries.push({all:!0})}else if("attribute"in o){if((s={attribute:validateAttribute(o.attribute)}).elementFilter=Selector.parseSelectors("*["+s.attribute+"]"),Object.keys(o).length>1)throw Error("Invalid request option. attribute has no options.");i.queries.push(s)}else if("element"in o){var r=Object.keys(o).length,s={element:o.element,elementFilter:Selector.parseSelectors(o.element)};if(o.hasOwnProperty("elementAttributes")&&(s.attributeList=validateElementAttributes(o.elementAttributes),r--),r>1)throw Error("Invalid request option. element only allows elementAttributes option.");i.queries.push(s)}else{if(!o.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(o).length>1)throw Error("Invalid request option. characterData has no options.");i.queries.push({characterData:!0})}}return i},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new MutationProjection(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),a=[],i=0;i<this.options.queries.length;i++)a.push(new Summary(t,this.options.queries[i]));return a},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach((function(e){e&&e.recordPreviousState()}))},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach((function(t,a){t&&t.validate(e[a])}))},e.prototype.changesToReport=function(e){return e.some((function(e){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some((function(t){return e[t]&&e[t].length})))return!0;if(e.attributeChanged&&Object.keys(e.attributeChanged).some((function(t){return!!e.attributeChanged[t].length})))return!0;return!1}))},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:void 0},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=NodeMap,e.parseElementFilter=Selector.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}();TECA.defineClass("Content",{_:{activeTimer:null,timerList:[],activeService:""},integrations:{},classReady:function(){TECA._.weareContentHosted=!0},domReady:function(){var e=this,t=function(){TECA._.validService&&TECA._.user.id>0&&e.integrations.hasOwnProperty(e._.activeService)&&"function"==typeof e.integrations[e._.activeService].getTheShDone&&(e.integrations[e._.activeService].getTheShDone(),window.addEventListener("focus",(function(){e.integrations.hasOwnProperty(e._.activeService)&&e.focusedStatusCheck(e.integrations[e._.activeService])})),"opera"==TECA._.platform&&window.addEventListener("visibilitychange",(function(){document.hidden||e.integrations.hasOwnProperty(e._.activeService)&&e.focusedStatusCheck(e.integrations[e._.activeService])})))};t(),"object"==typeof Turbolinks&&jQuery("body").on("turbolinks:load",(function(){t()}))},integrationDataReceived:function(){TECA.Gui.body.init({viewName:"registerTime",viewOptions:{integrationData:TECA._.lastIntegrationData,similarityEnabled:!0,bootstrapSelect:"boolean"!=typeof TECA._.lastIntegrationData.bootstrapSelect||TECA._.lastIntegrationData.bootstrapSelect},showMenu:!1,showTitle:!1})},getReadableName:function(){for(var e in this.integrations)if(this.integrations.hasOwnProperty(e))return this.integrations[e].readable_name;return!1},getCurrentTime:function(e){return e?"paused"==e.timerStatus?parseInt(e.seconds):Math.max(parseInt(e.seconds)+moment().subtract(moment().utcOffset(),"minutes").diff(moment(e.timerStart),"seconds"),0):0},getAllTimersTime:function(e){for(var t=0,a=0,i=0,n=this._.timerList.length;i<n;i++)this._.timerList[i].sourceData.id==e&&(t+=this.getCurrentTime(this._.timerList[i]),a++);return{count:a,totalTime:t}},checkTimers:function(e){var t=!1;if("string"==typeof e||"number"==typeof e){for(var a=0,i=this._.timerList.length;a<i;a++)this._.timerList[a].sourceData.id==e&&(!t||t.updatedDatetime<this._.timerList[a].updatedDatetime&&"paused"==t.timerStatus)&&(t=this._.timerList[a]);return t}},checkActiveModules:function(){var e=this._.activeTimer?this.getCurrentTime(this._.activeTimer):0;jQuery(".te-module.is-running").each((function(){var t=jQuery(this),a=TECA._.modulesStyle[t.data("te-source")]&&2==TECA._.modulesStyle[t.data("te-source")],i=TECA._.account.fromToFeatureEnabled?"iconeye-floppy-o":"iconeye-video-control-pause";jQuery(".te-time",t).html((a?'<i class="iconeye '+i+'"></i><i class="te_icon_timerActive_rec blink_me"></i>':'<span class="te_icon_timerActive_rec blink_me"></span>')+TECA.Gui.formatMins(Math.floor(e/60),"html")),jQuery(".te-entity-time-formatted",jQuery(this)).html(TECA.Gui.formatMins(Math.floor(e/60),"html"))}))},initMoreInfo:function(e,t){var a=jQuery('<div id="te-module-dropdown" data-te-source="'+e+'"></div>'),i=jQuery("body");jQuery("#te-module-dropdown").remove(),isNew=2==TECA._.modulesStyle[e],a.html(TECA.Gui.jhtml("integrationModule"+(isNew?"New":"")+"/timerModule_menu",{serviceItem:t})),i.append(a).unbind("click").on("click",(function(){var e=jQuery(".te-dropdown-menu",a);e.hasClass("te-visible")&&(e.removeClass("te-visible"),a.css({top:0,left:0}))}))},showMoreInfo:function(e){var t=this,a=jQuery(".te-button",e),i=jQuery("#te-module-dropdown"),n=jQuery(".te-dropdown-menu",i),o=e.data("te-integration-id"),r=this.checkTimers(o),s=!!r&&"running"==r.timerStatus,d=TECA._.modulesStyle[e.data("te-source")]&&2==TECA._.modulesStyle[e.data("te-source")]?"iconeye-timeneye-ico":"iconeye-android-time",l=TECA._.account.fromToFeatureEnabled?"iconeye-floppy-o":s?"iconeye-video-control-pause":"iconeye-video-control-play",u=jQuery(".te-base-info",e),c=jQuery(".te-more-info",e),m=jQuery("> i",u),h=a.offset(),p=a.innerHeight(),g={top:h.top+p,left:h.left};i.length>0?(i.css(g),n.length>0&&!n.hasClass("te-visible")&&n.addClass("te-visible"),n.on("mouseenter",(function(){jQuery(e).hasClass("te-dropdown-open")||jQuery(e).addClass("te-dropdown-open"),m.hasClass(d)&&(m.removeClass(d),m.addClass(l)),r&&c.addClass("te-visible")})).on("mouseleave",(function(){jQuery(e).hasClass("te-dropdown-open")&&jQuery(e).removeClass("te-dropdown-open"),m.hasClass(l)&&(m.removeClass(l),m.addClass(d)),c.hasClass("te-visible")&&c.removeClass("te-visible"),n.hasClass("te-visible")&&(n.removeClass("te-visible"),i.css({top:0,left:0}))})),jQuery(".te-dropdown-item",n).unbind("mousedown").unbind("click").on("mousedown",(function(e){e.stopPropagation()})).on("click",(function(a){a.preventDefault(),a.stopPropagation(),n.hasClass("te-visible")&&(n.removeClass("te-visible"),i.css({top:0,left:0}));var o=jQuery(this).data("te-target"),r={source:e.data("te-source"),sourceId:e.data("te-integration-id")};t.openRealDialog({name:o,filters:r})}))):"customerly"==e.data("te-source")?setTimeout((function(){t.initMoreInfo(e.data("te-source"),"task"),t.showMoreInfo(e)}),5e3):(t.initMoreInfo(e.data("te-source"),"task"),t.showMoreInfo(e))},setNativeModuleContent:function(e){var t=this,a=e.data("te-source"),i=e.data("te-integration-id"),n=t.checkTimers(i),o=jQuery(".te-native-current-timer",e).attr("id"),r=jQuery(".te-native-current-timer",e).parents(".te-native-subsection");"string"==typeof o&&("#"==o[0]&&(o=o.slice(1)),TECA.Timer.list.init(o,{display:{showDate:!1,showIntegrationLink:!1,showIntegrationHtml:!1,showActions:!0,actionsSmall:!0,actionsSeparated:!0},filters:{source:a,sourceId:i,timerId:n?n.timerId:-1},mixins:{reloadModule:function(){t.focusedStatusCheck(t.integrations[a])},openDialog:function(e){t.openRealDialog(e)}},dataYes:function(){r.removeClass("hidden")},dataNo:function(){r.addClass("hidden")}}))},setNativeModuleRecapSections:function(e){var t=this,a=e.data("te-source"),i=e.data("te-integration-id"),n=e.data("te-estimates"),o=jQuery(".te-native-section-header",e),r=jQuery(".te-native-timers",e),s=jQuery(".te-native-estimates",e),d=jQuery(".te-native-entries",e),l=this.getAllTimersTime(i),u={source:a,sourceId:i};TECA.Gui.feedback.loading(o),TECA.apiRequest("getEntriesByUser",jQuery.extend({limit:1},u),(function(i){"string"==typeof i?TECA.Gui.message.danger(i):i.code?TECA.Gui.message.danger(i.description):(r.html(TECA.Gui.jhtml("integrationModule/nativeModule_recapSection",{entityCount:l.count+" timer"+("1"==l.count?"":"s"),hasTotal:l.totalTime>0,totalTime:TECA._.user.id>0?TECA.Gui.formatMins(Math.floor(l.totalTime/60),"html"):0})).unbind("click").removeClass("has-total"),l.totalTime>0&&r.on("click",(function(e){e.preventDefault(),t.openRealDialog({name:"timers",filters:u})})).addClass("has-total"),n&&(s.html(TECA.Gui.jhtml("integrationModule/nativeModule_estimateSection",{hasEstimate:i.todo&&i.todo.estimatedTime>0,totalTime:i.todo&&TECA.Gui.formatMins(60*i.todo.estimatedTime,"html")})).unbind("click").on("click",(function(n){n.preventDefault(),t.openRealDialog({name:"estimates",integrationData:t.integrations[a].getIntegrationData(e),integration:a,estimate:i.todo&&i.todo.estimatedTime>0?i.todo.estimatedTime:0,onCloseInternal:function(e){setTimeout((function(){t.focusedStatusCheck(t.integrations[a]),"function"==typeof e.optFunctions.onDialogClose&&e.optFunctions.onDialogClose()}),10)}})})),i.todo&&i.todo.estimatedTime>0&&jQuery(".te-totals-estimate-logs",s).unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),t.openRealDialog({name:"estimateLogs",todoId:i.todo.todoId})}))),d.html(TECA.Gui.jhtml("integrationModule/nativeModule_recapSection",{entityCount:i.totalCount+" entr"+("1"==i.totalCount?"y":"ies"),hasTotal:i.totalMinutes>0,totalTime:TECA._.user.id>0?TECA.Gui.formatMins(Math.floor(i.totalMinutes),"html"):0})).unbind("click").removeClass("has-total"),i.totalMinutes>0&&d.on("click",(function(e){e.preventDefault(),t.openRealDialog({name:"entriesLog",filters:u})})).addClass("has-total"),TECA.Gui.feedback.close(o))}))},setNativeModuleTotalSections:function(e){var t=this,a=e.data("te-source"),i=e.data("te-integration-id"),n=e.data("te-estimates"),o=jQuery(".te-native-section-header",e),r={source:a,sourceId:i};TECA.Gui.feedback.loading(o),TECA.apiRequest("getEntriesByUser",jQuery.extend({limit:-1},r),(function(i){if("string"==typeof i)TECA.Gui.message.danger(i);else if(i.code)TECA.Gui.message.danger(i.description);else{var s=_.find(i.users,{userId:TECA._.user.id.toString()});if(s)jQuery(".te-native-section-user.me .user-tracked-time",e).html(TECA.Gui.formatMins(s.totalTime,"html"));var d=jQuery(".te-native-section-totals .te-totals-tracked-time",e);if(!i.totalMinutes||1!=TECA._.user.isAdmin&&1!=TECA._.user.isOwner||(d.html("Time: <b>"+(i.totalMinutes?TECA.Gui.formatMins(i.totalMinutes,"html"):"0m")+"</b>"),d.unbind("click").on("click",(function(e){e.preventDefault(),t.openRealDialog({name:"entriesLog",filters:{...r}})}))),n){var l=jQuery(".te-native-section-totals .te-totals-estimates",e),u=jQuery(".te-native-section-totals .te-totals-estimate-logs",e);i.todo&&i.todo.estimatedTime>0?(l.removeClass("no-estimate").html("<b>Estimate:</b> "+TECA.Gui.formatMins(60*i.todo.estimatedTime,"html")),u.removeClass("hidden").html('<i class="icon iconeye iconeye-back-in-time"></i> Show logs').unbind("click").on("click",(function(e){e.preventDefault(),t.openRealDialog({name:"estimateLogs",todoId:i.todo.todoId})})),e.addClass("todo-id",i.todo.todoId)):(l.html("<b>Set estimate</b>").addClass("no-estimate"),u.addClass("hidden")),l.unbind("click").on("click",(function(n){n.preventDefault(),t.openRealDialog({name:"estimates",integrationData:t.integrations[a].getIntegrationData(e),integration:a,estimate:i.todo&&i.todo.estimatedTime>0?i.todo.estimatedTime:0,onCloseInternal:function(e){setTimeout((function(){t.focusedStatusCheck(t.integrations[a]),"function"==typeof e.optFunctions.onDialogClose&&e.optFunctions.onDialogClose()}),10)}})}))}if(1==TECA._.user.isAdmin||1==TECA._.user.isOwner){var c=jQuery(".te-native-section-team",e);c.html("");var m,h=_.filter(i.users,e=>e.userId!=TECA._.user.id);_.each(h,e=>{m=c.append(TECA.Gui.jhtml("integrationModuleNew/nativeModule_userCard",{userName:e.userName,userAvatarSrc:e.userAvatar,trackedTime:TECA.Gui.formatMins(e.totalTime,"html"),userId:e.userId})),e.totalTime>0&&m.unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation();let a=$(e.target).data("target-user-id");a||(a=$(e.target).parents(".te-native-section-user").data("target-user-id")),a&&t.openRealDialog({name:"entriesLog",filters:{...r,userId:a}})}))})}TECA.Gui.feedback.close(o)}}))},setTotalsModuleContent:function(e){var t,a=this,i=e.data("te-source"),n=e.data("te-btn-mode"),o={source:i};switch(n){case"task":const a=e.data("te-integration-id");o.sourceId=a,1!=TECA._.user.isAdmin&&1!=TECA._.user.isOwner&&(o.userId=TECA._.user.id),t="getEntriesByUser";break;case"project":const i=e.data("te-integration-project-id");o.integrationProjectId=i,t="getProjectTotalMinutes"}TECA.apiRequest(t,jQuery.extend({limit:1},o),(function(t){if("string"==typeof t)TECA.Gui.message.danger(t);else if(t.code)TECA.Gui.message.danger(t.description);else if(t.totalMinutes||"project"==n||t.todo&&t.todo.estimatedTime>0){e.html(TECA.Gui.jhtml("integrationModuleNew/totalsModule_body"));var r=jQuery(".te-totals-tracked-time",e),s=jQuery(".te-tracked-time",r),d=jQuery(".te-estimate-wrapper",r),l=jQuery(".te-estimate",r);s.html(t.totalMinutes?TECA.Gui.formatMins(t.totalMinutes,"html"):"0m"),"task"==n?(t.todo&&t.todo.estimatedTime>0?(d.removeClass("hidden"),l.html(TECA.Gui.formatMins(60*t.todo.estimatedTime,"html"))):(d.addClass("hidden"),l.html("")),l.unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),a.openRealDialog({name:"estimateLogs",todoId:t.todo.todoId,integration:i})})),s.unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),a.openRealDialog({name:"entriesLog",filters:{...o}})}))):"project"==n&&(t.projectLinked?r.addClass("te-clickable").unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),window.open(t.urlProjectStatus,"_blank")})):r.removeClass("te-clickable").unbind("click"))}else e.html("")}))},setStatusModuleContent:function(e){var t=e.data("te-integration-project-id"),a=e.data("te-source");t&&TECA.apiRequest("getProjectForStatusModule",{source:a,integrationProjectId:t},(function(t){if("string"==typeof t)TECA.Gui.message.danger(t);else if(t.code){var a=e.data("te-source");e.addClass("no-project-linked").html(TECA.Gui.jhtml("integrationModuleNew/statusModule_body",{isProjectLinked:!1,integrationUrl:TECA._.urlAjax+"integration/"+a}))}else{var i=t.totalMinutes/t.budgetMinutes*100;e.removeClass("no-project-linked").html(TECA.Gui.jhtml("integrationModuleNew/statusModule_body",{isProjectLinked:!0,billable:1==t.isBillable,hasBudget:t.budgetMinutes>0,budgetPercentage:i.toFixed(0),budgetProgress:t.totalMinutes/t.budgetMinutes*(14*Math.PI),budgetClass:i>90?"danger":i>70?"warning":""})),e.unbind("click").on("click",(function(e){e.preventDefault(),e.stopPropagation(),window.open(t.urlProjectStatus,"_blank")}))}}))},updateTimerRecap:function(){var e=jQuery(".te-native-timers"),t=e.parents(".te-native-module").data("te-integration-id"),a=this.getAllTimersTime(t);e.each((function(){jQuery(this).html(TECA.Gui.jhtml("integrationModule/nativeModule_recapSection",{entityCount:a.count+" timer"+("1"==a.count?"":"s"),hasTotal:a.totalTime>0,totalTime:TECA._.user.id>0?TECA.Gui.formatMins(Math.floor(a.totalTime/60),"html"):0}))}))},setTimerModuleContent:function(e){var t=e.data("te-integration-id"),a=this.checkTimers(t),i=TECA._.modulesStyle[e.data("te-source")]&&2==TECA._.modulesStyle[e.data("te-source")],n=!!a&&"running"==a.timerStatus,o=n?'<span class="te_icon_timerActive_rec blink_me"></span>':"",r=a?" te-visible":"",s=this.getCurrentTime(a),d=a?n?TECA._.account.fromToFeatureEnabled?"Stop this timer":"Pause this timer":"Start this timer":"Register time";jQuery(e).html(TECA.Gui.jhtml("integrationModule"+(i?"New":"")+"/timerModule_body",{visibleClass:r,validTimer:a,recIcon:o,isRunning:n,fromToFeatureEnabled:TECA._.account.fromToFeatureEnabled,timerMinutes:TECA._.user.id>0?TECA.Gui.formatMins(Math.floor(s/60),"html"):0,primaryContent:d,secondaryContent:"Show more options",isSmall:e.hasClass("te-module-sm")}))},setTimerModuleActions:function(e){let t=this,a=e.data("te-integration-id"),i=this.checkTimers(a),n=!!i&&"running"==i.timerStatus,o=e.data("te-source"),r=jQuery(".te-base-info",e),s=jQuery(".te-more-info",e),d=jQuery("> i",r);isNew=2==TECA._.modulesStyle[e.data("te-source")];const l=isNew?"iconeye-timeneye-ico":"iconeye-android-time",u=i?TECA._.account.fromToFeatureEnabled?"iconeye-floppy-o":n?"iconeye-video-control-pause":"iconeye-video-control-play":"iconeye-android-add";if(s.unbind("click").unbind("mousedown").on("mousedown",(function(e){e.stopPropagation()})),r.unbind("click").unbind("mousedown").on("mousedown",(function(e){e.stopPropagation()})),jQuery(".te-button",e).on("mouseenter",(function(){d.hasClass(l)&&(d.removeClass(l),d.addClass(u)),i&&!isNew&&s.addClass("te-visible")})).on("mouseleave",(function(){d.hasClass(u)&&(d.removeClass(u),d.addClass(l)),s.hasClass("te-visible")&&!isNew&&s.removeClass("te-visible")})),t.integrations.hasOwnProperty(o)&&"function"==typeof t.integrations[o].getIntegrationData)if(i){var c="running"==i.timerStatus?"paused":"running";r.on("click",(function(e){var a=t.getCurrentTime(i);e.preventDefault(),e.stopPropagation(),jQuery("#te-module-dropdown > .te-dropdown-menu").hasClass("te-visible")&&(jQuery("#te-module-dropdown > .te-dropdown-menu").removeClass("te-visible"),jQuery("#te-module-dropdown").css({top:0,left:0}));var n=TECA._.account.fromToFeatureEnabled?"storeTimer":"updateTimer",r={timerId:i.timerId};return TECA._.account.fromToFeatureEnabled||(r=jQuery.extend(r,{status:c,seconds:a})),TECA.apiRequest(n,r,(function(e){"string"==typeof e?TECA.Gui.message.danger(e):e.code?TECA.Gui.message.danger(e.description):("running"==c?TECA.Gui.message.success("Timer started"):TECA.Gui.message.success("Timer "+(TECA._.account.fromToFeatureEnabled?"stopped":"paused")),t.focusedStatusCheck(t.integrations[o]))})),!1})),isNew?jQuery(".te-actions.te-timer-actions .te-dropdown-item",e).unbind("click").on("click",(function(a){a.stopPropagation(),a.preventDefault(),jQuery(this).data("entity-action")&&TECA.Timer[jQuery(this).data("entity-action")]&&Promise.resolve(TECA.Timer[jQuery(this).data("entity-action")](e.data("te-timer-id"),jQuery(e))).then(()=>{t.focusedStatusCheck(t.integrations[o])})})):s.on("click",(function(a){a.preventDefault(),a.stopPropagation(),jQuery("#te-module-dropdown > .te-dropdown-menu").hasClass("te-visible")?jQuery("#te-module-dropdown > .te-dropdown-menu").removeClass("te-visible"):t.showMoreInfo(e)}))}else r.on("click",(function(a){return a.preventDefault(),a.stopPropagation(),t.openDialog(jQuery.extend({integration:o},t.integrations[o].getIntegrationData(e)),"registerTime","function"==typeof t.integrations[o].getOptFunctions?t.integrations[o].getOptFunctions():null),!1}))},setNativeModuleActions:function(e){var t=this,a=e.data("te-source"),i=jQuery(".te-actions.te-native-actions",e);t.integrations.hasOwnProperty(a)&&"function"==typeof t.integrations[a].getIntegrationData&&jQuery(".te-dropdown-item",i).unbind("click").on("click",(function(i){var n={name:jQuery(this).data("te-target"),filters:{userId:TECA._.user.id,source:a,sourceId:e.data("te-integration-id")}};"function"==typeof t.integrations[a].getOptFunctions&&(n=jQuery.extend(n,t.integrations[a].getOptFunctions())),t.openRealDialog(n)}))},checkModuleTimerInfo:function(e,t){var a=e.data("te-timer-id"),i=e.data("te-integration-id"),n=this.checkTimers(i),o=TECA._.modulesStyle[e.data("te-source")]&&2==TECA._.modulesStyle[e.data("te-source")],r=e.hasClass("te-timer-module");n&&(e.data("te-timer-id",n.timerId),r&&(t&&!o||e.hasClass("te-visible")||e.addClass("te-visible"),e.hasClass("te-valid-timer")||e.addClass("te-valid-timer"))),"-1"==a||n||(e.data("te-timer-id","-1"),r&&(t||o||!e.hasClass("te-visible")||e.removeClass("te-visible"),e.hasClass("te-valid-timer")&&e.removeClass("te-valid-timer")))},checkRunningInterval:function(e){var t,a=this,i=e.data("te-integration-id"),n=this.checkTimers(i),o=!!n&&"running"==n.timerStatus;o?(null!=this._.activeTimer&&this._.activeTimer.timerId==n.timerId&&this._.activeTimer.timerStart==n.timerStart||(null!=this._.activeTimer&&this._.activeTimer.timerId==n.timerId||("number"==typeof(t=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(t)),t=setInterval((function(){a.checkActiveModules(),a.updateTimerRecap()}),1e4),localStorage.setItem("activeModules",t)),this._.activeTimer=n),e.hasClass("is-running")||e.addClass("is-running")):o||(null!=this._.activeTimer&&this._.activeTimer.timerId==n.timerId&&(this._.activeTimer=null,"number"==typeof(t=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(t))),e.hasClass("is-running")&&e.removeClass("is-running"))},focusedStatusCheck:function(e){var t=this;TECA.Timer.model.loadIntegrationTimerList(e.name,(function(a){t._.timerList=a,jQuery(".te-module").each((function(){jQuery(this).hasClass("te-timer-module")?e.timerModule.update(jQuery(this)):jQuery(this).hasClass("te-native-module")?e.nativeModule.update(jQuery(this)):jQuery(this).hasClass("te-totals-module")?e.totalsModule.update(jQuery(this)):jQuery(this).hasClass("te-status-module")&&e.statusModule.update(jQuery(this))}))}))},openDialog:function(e,t,a){var i=this,n=jQuery("body"),o="login";_.isNil(a)&&(a={}),i.closeEntryDialog(a);var r=jQuery('<div id="timeneye_widget_dialog" data-te-source="'+TECA.Content._.activeService+'" class="te-fake-dialog"><div class="timeneye-dialog-cont"><div id="timeneye_widget_cont" class="te-feedback-cont"></div></div></div>');n.append(r);jQuery("> .timeneye-dialog-cont",r);r.on("click",(function(e){e.target==this&&i.closeEntryDialog(a)})),TECA._.lastIntegrationData=e,TECA._.user.id>0&&(o=t),TECA.Gui.body.init({viewName:o,viewOptions:{integrationData:e,similarityEnabled:!0,bootstrapSelect:"boolean"!=typeof e.bootstrapSelect||e.bootstrapSelect,optFunctions:a},showMenu:!1,showTitle:!1}),"function"==typeof a.onInit&&a.onInit(),n.css("overflow-y","hidden")},openRealDialog:function(e){jQuery("body").append('<div id="timeneye_widget_dialog" data-te-source="'+TECA.Content._.activeService+'"><div id="timeneye_widget_cont"></div></div>').css("overflow-y","hidden"),void 0===e&&(e={}),e=jQuery.extend({},e,{onClose:function(){jQuery("#timeneye_widget_dialog").remove(),jQuery("body").css("overflow-y","")}}),TECA.Dialog.init(e)},closeEntryDialog:function(e){"function"==typeof e.onDialogClose&&e.onDialogClose(),jQuery("#timeneye_widget_dialog").remove(),jQuery("body").css("overflow-y",""),this.integrations.hasOwnProperty(this._.activeService)&&this.focusedStatusCheck(this.integrations[this._.activeService])}}),TECA.Content.integrations.activecollab={readable_name:"ActiveCollab",name:"activecollab",timerModule:{init:function(e){var t=e.parent().data("id"),a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="te-module te-timer-module te-visible" data-te-source="activecollab" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'" data-te-task-mode="list"></div>');this.update(n),e.append(n)},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t,a=TECA.Content.integrations.activecollab,i=jQuery(".SingleTaskPane-descriptionRow",e),n=e.parents(".details-pane-redesign")?"new-pane":e.parents(".SingleTaskPaneModal").length>0?"pane-modal":"pane-right",o=r?r.timerId:-1;t="inbox"==window.location.pathname.slice(1).split("/")[1]||"search"==window.location.pathname.slice(1).split("/")[1]?window.location.pathname.slice(1).split("/")[3]:window.location.pathname.slice(1).split("/")[2];var r=TECA.Content.checkTimers(t),s=jQuery('<div class="te-module te-native-module" data-te-source="activecollab" data-te-timer-id="'+o+'" data-te-integration-id="'+t+'" data-te-task-mode="'+n+'" data-te-estimates="true"></div>');s.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",s).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"activecollab"},a.getIntegrationData(s)),"registerTime"),!1})),i.after(s),this.update(s)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("activecollab","task"),TECA.Timer.model.loadIntegrationTimerList("activecollab",(function(e){TECA.Content._.timerList=e,jQuery(".task.task_view_mode").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("activecollab",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".task.task_view_mode"}]})}),1e3)},parseTask:function(e){"object"==typeof e&&e.hasClass("task_view_mode")&&!e.hasClass("done")&&0===jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");if("pane-modal"==e.data("te-task-mode")){var i=jQuery(".SingleTaskPaneModal .SingleTaskPane-projects > .TaskProjectsMultihome-projects > .TaskProjectsMultihome-projectList > .TaskProjectsMultihome-project:eq(0)");t.text=jQuery(".SingleTaskPaneModal .SingleTaskPane-titleRow > .SingleTaskTitleRow-taskName > textarea").val(),1==TECA._.serviceSettings.activecollab?(t.projectName=jQuery(".TaskProjectPill-projectName > div",i).text(),t.taskName=jQuery(".TaskProjectColumnInfo-dropdown > span",i).text()):(t.projectName=jQuery(".TaskProjectColumnInfo-dropdown > span",i).text(),t.taskName="",jQuery(".SingleTaskPaneModal .SingleTaskPane-body .TaskTags")&&(jQuery(".SingleTaskPaneModal .SingleTaskPane-body .TaskTags .Token-label").each((function(){t.taskName+=jQuery(this).text().trim()+","})),t.taskName.length>0&&(t.taskName=t.taskName.slice(0,-1)))),t.url=window.location.href}else if("pane-right"==e.data("te-task-mode")){var n=e.parents("#right_pane__contents");jQuery("#details_pane_header",n).length>0?(t.text=jQuery("#details_pane_title_row > .details-pane-title div.header-name",n).text(),"."==t.text.charAt(t.text.length-1)&&(t.text=t.text.substr(0,t.text.length-1)),t.projectName="",t.taskName="",1==TECA._.serviceSettings.activecollab?(jQuery("#details_pane_project_tokenizer .token-wrapper",n).length>0&&(t.projectName=jQuery("#details_pane_project_tokenizer .token-wrapper:first-child > span",n).attr("alt"),0==t.projectName.length&&jQuery(".TaskAncestry .TaskAncestry-ancestorProject",n).text().length>0&&(t.projectName=jQuery(".TaskAncestry .TaskAncestry-ancestorProject",n).text())),jQuery("#details_pane_project_tokenizer .token-wrapper > .token > a.dropdown-menu-link",n).length>0&&(t.taskName=jQuery("#details_pane_project_tokenizer .token-wrapper > .token > a.dropdown-menu-link span.detailsPaneProjectTokenizerView-groupLabel",n).text())):(jQuery("#details_pane_project_tokenizer .token-wrapper > .token > a.dropdown-menu-link",n).length>0&&(t.projectName=jQuery("#details_pane_project_tokenizer .token-wrapper > .token > a.dropdown-menu-link span.detailsPaneProjectTokenizerView-groupLabel",n).text()),jQuery(".taskTagsView",n).length>0&&(jQuery(".taskTagsView .taskTagsView-tokenArea span.token-label",n).each((function(){t.taskName+=jQuery(this).text().trim()+","})),t.taskName.length>0&&(t.taskName=t.taskName.slice(0,-1))))):(t.text=jQuery(".SingleTaskPane-titleRow > .SingleTaskTitleRow-taskName > .autogrowTextarea-shadow",n).text(),"| "==t.text.substr(-2)&&(t.text=t.text.substr(0,t.text.length-2)),1==TECA._.serviceSettings.activecollab?(jQuery(".SingleTaskPane-projects",n).length>0&&(t.projectName=jQuery(".SingleTaskPane-projects > .TaskProjects-projects > .TaskProjects-projectList > .TaskProjects-project > a.TaskProjectPill-projectName > div",n).text()),0==t.projectName.length&&(t.projectName=jQuery(".TaskAncestry .TaskAncestry-ancestorProject",n).text()),t.taskName="",jQuery(".SingleTaskPane-projects .TaskProjectSectionInfo-sectionDropdown",n).length>0?t.taskName=jQuery(".SingleTaskPane-projects > .TaskProjects-projects > .TaskProjects-projectList > .TaskProjects-project > a.TaskProjectSectionInfo-sectionDropdown > .FloatingSelect-label",n).text():t.taskName=t.text.slice(0,-1)):(jQuery(".SingleTaskPane-projects .TaskProjectSectionInfo-sectionDropdown",n).length>0?t.projectName=jQuery(".SingleTaskPane-projects > .TaskProjects-projects > .TaskProjects-projectList > .TaskProjects-project > a.TaskProjectSectionInfo-sectionDropdown > .FloatingSelect-label",n).text():t.projectName=t.text.slice(0,-1),t.taskName=t.text.slice(0,-1))),t.url=window.location.href}else if("new-pane"==e.data("te-task-mode")){var o=jQuery(".SingleTaskPane-body");t.text=jQuery(".SingleTaskPane-titleRow > .SingleTaskTitleInput-taskName > textarea",o).val(),"| "==t.text.substr(-2)&&(t.text=t.text.substr(0,t.text.length-2)),1==TECA._.serviceSettings.activecollab?(t.projectName=jQuery(".TaskProjectPill-projectName > div",o).text(),0==t.projectName.length&&(t.projectName=jQuery(".TaskAncestry .TaskAncestry-ancestorProject",o).text()),t.taskName=jQuery(".TaskProjectSectionInfo-sectionDropdown > span, .TaskProjectColumnInfo-dropdown > span",o).text(),0==t.projectName.length&&jQuery(".TaskAncestry .TaskAncestry-ancestorProject",n).text().length>0&&(t.projectName=jQuery(".TaskAncestry .TaskAncestry-ancestorProject",n).text())):(t.projectName=jQuery(".TaskProjectSectionInfo-sectionDropdown > span, .TaskProjectColumnInfo-dropdown > span",o).text(),t.taskName="",jQuery(".TaskTags",o)&&(jQuery(".TaskTags .Token-label",o).each((function(){t.taskName+=jQuery(this).text().trim()+","})),t.taskName.length>0&&(t.taskName=t.taskName.slice(0,-1)))),t.url=window.location.href}else if("list"==e.data("te-task-mode"))t.taskName=e.parents(".task_list_tasks").find("> .task_list > h2 > span").eq(1).text(),t.projectName=_.trim(jQuery("h1.paper-title").text().split(":")[1]),t.url=window.location.href+"/tasks/"+a,t.text=_.trim(jQuery(e).parent().find("a.task_name").text());else{var r=e.parents(".dropTargetRow"),s=r.index(),d=jQuery("textarea",r),l=window.location.pathname.split("/"),u=d.attr("id").split("_")[1],c="";jQuery(".SectionRow").each((function(){s>=jQuery(this).parents(".dropTargetRow").index()&&(c=jQuery("textarea",this).text().trim().slice(0,-1))})),1==TECA._.serviceSettings.activecollab?(t.projectName=jQuery(".ProjectPageHeader-projectName").text(),t.taskName=c):(t.projectName=c,t.taskName="",jQuery(".Pill",r).each((function(){t.taskName+=jQuery(this).text().trim()+","})),t.taskName.length>0&&(t.taskName=t.taskName.slice(0,-1))),t.text=d.text(),l.length>3&&l.splice(4),l[3]=u,t.url=window.location.origin+l.join("/")}return""==t.taskName.replace(/ /g,"")&&(t.taskName=t.text.slice(0,-1)),""==t.projectName.replace(/ /g,"")&&(t.projectName=t.text.slice(0,-1)),t.id=a,t}},TECA.Content.integrations.asana={readable_name:"Asana",name:"asana",timerModule:{init:function(e){var t=e.hasClass("BoardCardLayout")?"board":"list",a="board"==t?e.data("task-id"):jQuery(".SpreadsheetTaskName > textarea",e).attr("id").split("_")[2],i="board"==t?jQuery(".BoardCardLayout-contentAboveSubtasks",e):jQuery(".SpreadsheetGridTaskNameAndDetailsCellGroup-detailsButtonClickArea",e),n=TECA.Content.checkTimers(a),o=n?n.timerId:-1,r=2==TECA._.modulesStyle.asana,s=jQuery('<div class="te-module-container" data-te-source="asana" data-te-btn-mode="'+t+'"></div>'),d=jQuery(TECA.Gui.jhtml("integrationModule"+(r?"New":"")+"/moduleWrapper_body",{class:"te-timer-module te-module-sm te-module-dark",source:"asana",projectType:null,integrationId:a,timerId:o,btnMode:t,estimates:!0}));if(this.update(d),"board"==t?(r&&(d=s.html(d)),i.append(d)):i.prepend(d),!r){var l=Math.max(jQuery(".te-base-info",d).outerWidth(),18);d.css("min-width",l)}},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e);var t=Math.max(jQuery(".te-base-info",e).outerWidth(),18);e.css("min-width",t)}},nativeModule:{init:function(e){var t,a=TECA.Content.integrations.asana,i=TECA._.user.id>0,n=jQuery(".TaskPaneFields",e),o=2==TECA._.modulesStyle.asana;t="inbox"==window.location.pathname.slice(1).split("/")[1]||"search"==window.location.pathname.slice(1).split("/")[1]||"home"==window.location.pathname.slice(1).split("/")[1]?window.location.pathname.slice(1).split("/")[3]:window.location.pathname.slice(1).split("/")[2];var r=TECA.Content.checkTimers(t),s=r?r.timerId:-1,d=jQuery(TECA.Gui.jhtml("integrationModule"+(o?"New":"")+"/moduleWrapper_body",{class:"te-native-module te-module-dark",source:"asana",projectType:null,integrationId:t,timerId:s,btnMode:"panel",estimates:!0}));(d.html(TECA.Gui.jhtml("integrationModule"+(o?"New":"")+"/nativeModule_body",{logoUrl:o?chrome.extension.getURL(""):chrome.extension.getURL("images/logo_white_horiz_xs.svg"),userAvatarSrc:!!i&&TECA._.user.avatar,userName:!!i&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"task",notUnique:!1,estimates:!0})),o)&&(myBtn=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"asana",projectType:null,integrationId:t,timerId:s,btnMode:"panel",estimates:!0})),a.timerModule.update(myBtn),jQuery(".timer-module-container",d).html(myBtn));jQuery(".te-native-new-entity",d).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"asana"},a.getIntegrationData(d)),"registerTime"),!1})),n.after(d),this.update(d)},update:function(e){var t=2==TECA._.modulesStyle.asana;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t){var a=e.hasClass("BoardCardLayout")?"board":"list",i=jQuery('<div class="te-module te-totals-module te-module-dark" data-te-source="asana" data-te-btn-mode="'+t+'"></div>');switch(t){case"task":const t="board"==a?e.data("task-id"):jQuery(".SpreadsheetTaskName > textarea",e).attr("id").split("_")[2];i.data("te-integration-id",t),jQuery(".te-timer-module",e).before(i);break;case"project":const n=window.location.pathname.split("/")[2];i.data("te-integration-project-id",n),jQuery(".TopbarPageHeaderStructureWithBreadcrumbs-titleRow, .TopbarPageHeaderStructure-titleRow",e).append('<div class="te-module te-logo-module te-module-dark"><i class="iconeye iconeye-timeneye-ico"></i></div>'),jQuery(".TopbarPageHeaderStructureWithBreadcrumbs-titleRow, .TopbarPageHeaderStructure-titleRow",e).append(i)}this.update(i)},update:function(e){TECA.Content.setTotalsModuleContent(e)}},statusModule:{init:function(e){var t=window.location.pathname.split("/")[2],a=jQuery('<div class="te-module te-status-module te-module-dark" data-te-source="asana" data-te-integration-project-id="'+t+'"></div>');jQuery(".TopbarPageHeaderStructureWithBreadcrumbs-titleRow, .TopbarPageHeaderStructure-titleRow",e).append(a),this.update(a)},update:function(e){TECA.Content.setStatusModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("asana","task"),TECA.Timer.model.loadIntegrationTimerList("asana",(function(e){TECA.Content._.timerList=e,jQuery(".SpreadsheetTaskRow, .BoardCardLayout, .TaskPane, .ProjectPageHeader").each((function(){t.parseTask(jQuery(this))}))}))}),1e3),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("asana",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".SpreadsheetTaskRow, .BoardCardLayout, .TaskPane,  .TaskGroupHeader, .BoardColumnHeader, .ProjectPageHeader"}]})},parseTask:function(e){var t=2==TECA._.modulesStyle.asana;"object"!=typeof e||e.hasClass("done")||0!==jQuery(".te-module",e).length||(e.hasClass("ProjectPageHeader")?1!=TECA._.user.isOwner&&1!=TECA._.user.isAdmin||!t||(this.totalsModule.init(e,"project"),this.statusModule.init(e)):e.hasClass("SpreadsheetTaskRow")||e.hasClass("BoardCardLayout")?(this.timerModule.init(e),t&&this.totalsModule.init(e,"task")):this.nativeModule.init(e))},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");if("panel"==e.data("te-btn-mode")){var i=jQuery(".TaskPane"),n=jQuery(".TaskProjects-projects > .TaskProjects-projectContainer > li, .LegacyTaskProjects-projects > .LegacyTaskProjects-projectList > li",i).eq(0);t.text=jQuery(".TaskPane-titleRow > .TitleInput-objectName > div, .TaskPaneTitle > .TitleInput-objectName > div",i).text(),1==TECA._.serviceSettings.asana?(t.projectName=jQuery("> a .TokenizerPillBase-name, > a .DeprecatedTokenizerPillBase-name, > a .TaskProjectTokenPill-name",n).first().text(),0==t.projectName.length&&(t.projectName=""),t.taskName=jQuery(".TaskPotColumnMenuButton-dropdownButton > span, .TaskPotColumnMenuButton-dropdownButton--darkHover > span",n).first().text()):(t.projectName=jQuery(".TaskPotColumnMenuButton-dropdownButton > span, .TaskPotColumnMenuButton-dropdownButton--darkHover > span",n).first().text(),t.taskName="",jQuery(".TaskTags",i)&&(t.taskName+=jQuery(".TaskTags .TokenizerPillBase-name, .TaskTags .DeprecatedTokenizerPillBase-name",i).first().text().trim())),t.url=window.location.href}else if("board"==e.data("te-btn-mode")){var o=e.parents(".BoardCardLayout"),r=window.location.pathname.split("/"),s=e.data("te-integration-id"),d=o.parents(".BoardColumn")[0],l=jQuery(".BoardColumnHeader .BoardColumnHeaderTitle",d).text().trim();1==TECA._.serviceSettings.asana?(t.projectName=jQuery(".ProjectPageHeaderProjectTitle-container",jQuery(".TopbarPageHeaderStructureWithBreadcrumbs-titleRow, .TopbarPageHeaderStructure-titleRow")).text(),t.taskName=l):(t.projectName=l,t.taskName=""),t.text=jQuery(".BoardCard-taskName",o).text(),r.length>3&&r.splice(3),t.url=window.location.origin+r.join("/")+"/"+s+"/f"}else{o=e.parents(".DropTargetRow");var u=jQuery("label > .SpreadsheetTaskName-shadow",o),c=(r=window.location.pathname.split("/"),s=e.data("te-integration-id"),jQuery(".SpreadsheetTaskRow-projectsCell",o)),m=jQuery(".SpreadsheetTaskRow-tagsCell",o);d=o.parents(".TaskGroup")[0],l=jQuery(".TaskGroupHeader-headerContainer .PotColumnName-nameButton",d).text().trim();1==TECA._.serviceSettings.asana?(c.length>0&&jQuery(".DeprecatedTokenizerPillBase-name, .TokenizerPillBase-name, .PillPresentation",c).length>0?t.projectName=jQuery(".DeprecatedTokenizerPillBase-name, .TokenizerPillBase-name, .PillPresentation",c).first().text().trim():t.projectName=jQuery(".ProjectPageHeaderProjectTitle-container",jQuery(".TopbarPageHeaderStructureWithBreadcrumbs-titleRow, .TopbarPageHeaderStructure-titleRow")).text(),t.taskName=l):(t.projectName=l,m.length>0?t.taskName=jQuery(".TokenizerPillBase-name, .DeprecatedTokenizerPillBase-name, .PillPresentation",m).first().text().trim():t.taskName=""),t.text=u.text(),r.length>3&&r.splice(4),r[3]=s,t.url=window.location.origin+r.join("/")}return t.id=a,t}},TECA.Content.integrations.azuredevops={readable_name:"Azure DevOps",name:"azuredevops",todoId:null,timerModule:{init:function(e){myMode=e.hasClass("board-tile")?"card":e.hasClass("boards-card")?"new-card":e.hasClass("ms-List-cell")?"list":e.hasClass("grid-row")?"backlog":e.hasClass("bolt-tree-row")?"new-backlog":e.hasClass("taskboard-card")?"new-taskboard":"taskboard";var t=window.location.pathname.slice(1).split("/"),a=t[0]+"/"+t[1]+"/",i="";switch(myMode){case"card":a+=jQuery(".board-tile-content .id-title-container .id",e).text(),i=".board-tile-content .board-tile-annotations";break;case"new-card":case"new-taskboard":a+=e.data("itemid"),i=".card-content";break;case"list":var n=$('.ms-DetailsHeader-cell[data-item-key="System.Title"]'),o=jQuery(".ms-DetailsHeader .ms-DetailsHeader-cell").index(n);jQuery(".ms-DetailsHeader-cell.te-column").length||n.after(jQuery('<div class="ms-DetailsHeader-cell cell_1773f7e9 te-column" role="columnheader" style="width: 140px;"><div class="ms-DetailsHeader-cellTitle">Timeneye</div></div>')),jQuery(jQuery(".ms-DetailsRow-cell",e)[o]).after(jQuery('<div class="ms-DetailsRow-cell te-column cell_e46c5476" role="gridcell" style="width: 140px; text-align: right"></div>')),a+=jQuery('.ms-DetailsRow-cell[data-automation-key="System.Id"] .work-item-simple-cell',e).text(),i=".ms-DetailsRow-cell.te-column";break;case"backlog":n=$('.grid-header .grid-header-column[aria-label="Title"]');var r=jQuery(".grid-header .grid-header-column").index(jQuery('.grid-header .grid-header-column[aria-label="ID"]'));o=jQuery(".grid-header .grid-header-column").index(n);jQuery(".grid-header .grid-header-column.te-column").length||n.after(jQuery('<div class="grid-header-column te-column" style="width: 120px;"><div class="title">Timeneye</div></div>')),jQuery(jQuery(".grid-cell",e)[o]).after(jQuery('<div class="grid-cell te-column" role="gridcell" style="width: 120px; text-align: right"></div>')),a+=jQuery(jQuery(".grid-cell",e)[r]).text(),i=".grid-cell.te-column";break;case"new-backlog":var s=jQuery("colgroup");n=jQuery('th.bolt-table-header-cell[aria-label="Title"]'),r=jQuery("th").index(jQuery('.bolt-table-header-row .bolt-table-header-cell[aria-label="ID"]')),o=jQuery("th").index(n);jQuery(".bolt-table-header-row .bolt-table-header-cell.te-column").length||(jQuery(jQuery("col",s)[o]).after(jQuery('<col style="width: 120px;">')),n.after(jQuery('<th role="columnheader" class="bolt-table-header-cell te-column"><div class="bolt-table-header-cell-content flex-row"><div class="scroll-hidden"><div class="bolt-table-header-cell-text text-ellipsis body-s"><span>Timeneye</span></div></div></div></th>'))),jQuery(jQuery(".bolt-table-cell",e)[o]).after(jQuery('<td class="backlog-tree-cell bolt-table-cell bolt-list-cell te-column"></td>')),a+=jQuery(jQuery(".bolt-table-cell",e)[r]).text(),i=".backlog-tree-cell.te-column";break;case"taskboard":a+=jQuery(".tbTileContent .id-title-container .id",e).text(),i=".tbTileContent > .field-container";break;default:a=null}if(a){var d=TECA.Content.checkTimers(a),l=d?d.timerId:-1,u=jQuery('<div class="te-wrapper"></div>'),c=jQuery('<div class="te-module te-timer-module te-visible" data-te-source="azuredevops" data-te-integration-id="'+a+'" data-te-todo-mode="'+myMode+'" data-te-timer-id="'+l+'"></div>');this.update(c),"list"==myMode&&u.css("width","140px"),"new-backlog"===myMode&&u.addClass("bolt-table-cell-content").addClass("flex-center").addClass("flex-row"),u.html(c),"backlog"!==myMode&&"list"!==myMode&&"new-card"!==myMode&&"new-backlog"!==myMode&&"new-taskboard"!==myMode?jQuery(i,e).after(u):jQuery(i,e).append(u),jQuery(".board-tile-content, .boards-card",e).on("click",(function(){TECA.Content.integrations.azuredevops.todoId=a})),c.css("min-width",jQuery(".te-button",c).outerWidth())}},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=window.location.pathname.slice(1).split("/"),a=e.hasClass("work-item-form-page")?"new-edit":"edit",i=t[0]+"/"+t[1]+"/";if("edit"===a)i+=jQuery('.work-item-form-headerContent span[aria-label="ID Field"]').text();else{var n=jQuery(".work-item-form-header a",e).attr("href");i+=n.slice(n.lastIndexOf("/")+1)}var o=TECA.Content.integrations.azuredevops,r=TECA.Content.checkTimers(i),s=r?r.timerId:-1,d=jQuery('<div class="te-module te-native-module" data-te-source="azuredevops" data-te-integration-id="'+i+'" data-te-todo-mode="'+a+'" data-te-timer-id="'+s+'" data-te-estimates="true"></div>');d.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",d).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"azuredevops"},o.getIntegrationData(d)),"registerTime",TECA.Content.integrations.azuredevops.getOptFunctions()),!1}));var l=jQuery('<div class="work-item-form-headerContent"></div>');l.html(d),jQuery(".work-item-form-main-header, .work-item-form-header",e).append(l),this.update(d)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("azuredevops","to do"),TECA.Timer.model.loadIntegrationTimerList("azuredevops",(function(e){TECA.Content._.timerList=e,jQuery(".board-tile, .boards-card, .ms-List-cell, .backlog-container .grid-row, .bolt-tree-row, .taskboard .tbTile, .taskboard-card, .workitem-dialog, .new-work-item-view, .work-item-form-page").each((function(){var e=jQuery(this);e.hasClass("unparented-card")||t.parseTodo(e)}))}))}),500),new MutationSummary({callback:function(e){setTimeout((function(){TECA.Timer.model.loadIntegrationTimerList("azuredevops",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){var a=jQuery(e);a.hasClass("unparented-card")||t.parseTodo(a)})),e.attributeChanged["aria-expanded"].forEach((function(e){var a=jQuery(e);a.hasClass("unparented-card")||t.parseTodo(a)})),e.attributeChanged.style.forEach((function(e){var a=jQuery(e);a.hasClass("unparented-card")||t.parseTodo(a)}))}))}),250)},queries:[{element:".board-tile, .boards-card, .ms-List-cell, .grid-row, .bolt-tree-row, .tbTile, .taskboard-card, .workitem-dialog, .new-work-item-view, .work-item-form-page",elementAttributes:"aria-expanded style"}]})},getOptFunctions:function(){return{onInit:function(){jQuery(".workitem-dialog, .ui-widget-overlay, .bolt-dialog-callout").css("display","none")},onDialogClose:function(){0==jQuery(".te-dialog.card-type").length&&(jQuery(".workitem-dialog, .ui-widget-overlay").css("display","block"),jQuery(".bolt-dialog-callout").css("display","flex"))}}},parseTodo:function(e){if("object"==typeof e&&0==jQuery(".te-module",e).length)if(e.hasClass("workitem-dialog")||e.hasClass("new-work-item-view")||e.hasClass("work-item-form-page"))this.nativeModule.init(e);else{if(e.hasClass("grid-row")&&!e.parents(".backlog-container"))return;this.timerModule.init(e)}},getIntegrationData:function(e){var t={},a=null;myMode=e.data("te-todo-mode");var i=(a=e.data("te-integration-id")).split("/"),n=i[0]+"/"+i[1],o=i[2];switch(myMode){case"edit":t.text=e.parents(".work-item-form-main-header").find('input[aria-label="Title Field"]').val();break;case"new-edit":t.text=jQuery(".work-item-title-textfield input",e.parents(".work-item-form-header")).val();break;case"card":t.text=e.parents(".board-tile").find(".id-title-container .clickable-title").text();break;case"new-card":case"new-taskboard":t.text=e.parents(".card-content").find(".title .title-text").text();break;case"list":t.text=e.parents(".ms-DetailsRow").find(".work-item-title .work-item-title-link").text();break;case"backlog":t.text=e.parents(".grid-row").find(".work-item-title-link").text();break;case"new-backlog":t.text=e.parents(".bolt-table-row").find(".bolt-table-inline-link").text();break;case"taskboard":t.text=e.parents(".tbTile").find(".id-title-container .clickable-title").text()}return t.projectName=jQuery(".navigation-container .project-item .font-weight-heavy").text(),t.id=a,o&&(t.url=window.location.origin+"/"+n+"/_workitems/edit/"+o),t}},TECA.Content.integrations.basecamp={readable_name:"Basecamp",name:"basecamp",timerModule:{init:function(e){var t=e.attr("id").replace("todo_",""),a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<span class="te-module te-timer-module te-visible" data-te-source="basecamp" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></span>');this.update(n),jQuery("span.wrapper > span.content > a",e).before(n),n.css("min-width",jQuery(".te-base-info",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA.Content.integrations.basecamp,a=jQuery(".attachments",e),i=window.location.pathname.slice(1).split("/")[4],n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-module te-native-module" data-te-source="basecamp" data-te-integration-id="'+i+'" data-te-timer-id="'+o+'" data-te-estimates="true"></div>');r.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",r).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"basecamp"},t.getIntegrationData(r)),"registerTime"),!1})),a.after(r),this.update(r)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("basecamp","todo"),TECA.Timer.model.loadIntegrationTimerList("basecamp",(function(e){TECA.Content._.timerList=e,jQuery("ul > li.todo").each((function(){t.parseTodos(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("basecamp",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTodos(jQuery(e))}))}))},queries:[{element:"li.todo"}]})}),200)},parseTodos:function(e){if("object"==typeof e&&e.parents("ul.completed").length<=0&&0==jQuery(".te-module",e).length)if("todos"==window.location.pathname.split("/")[4]){var t=e.parents(".todolist");this.nativeModule.init(t)}else this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=window.location.pathname.substring(1).split("/"),i=e.data("te-integration-id");return"string"==typeof a[4]&&"todos"==a[3]?(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents(".panel.sheet.todo").find('> header > p > a[data-replace-sheet="true"]').text(),t.projectName=e.parents(".panel.sheet.todo").find("> header > p.reference_to_project > a").text()):(t.projectName=e.parents(".panel.sheet.todo").find('> header > p > a[data-replace-sheet="true"]').text(),t.taskName=""),t.url=e.parents(".todolist").find("> ul > li .wrapper > .content > a").attr("href"),t.text=e.parents(".todolist").find("> ul > li .wrapper > .content > a").text()):"string"==typeof a[4]&&"todolists"==a[3]?(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.projectName=e.parents(".panel.sheet.project").find("> header > h1 > a").text()):(t.projectName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.taskName=""),t.url=e.siblings("a").attr("href"),t.text=e.siblings("a").text()):"string"==typeof a[3]&&"todolists"==a[3]?(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.projectName=e.parents(".panel.sheet.project").find("> header > h1 > a").text()):(t.projectName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.taskName=""),t.taskName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.projectName=e.parents(".panel.sheet.project").find("> header > h1 > a").text(),t.url=e.siblings("a").attr("href"),t.text=e.siblings("a").text()):"string"==typeof a[2]&&"projects"==a[1]?(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.projectName=e.parents(".panel.sheet.project").find("> header > h1").text()):(t.projectName=e.parents("article.todolist").find("> header > h3 > span.unlinked_title").text(),t.taskName=""),t.url=e.siblings("a").attr("href"),t.text=e.siblings("a").text()):"string"==typeof a[2]&&"people"==a[1]?(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents("article.todolist").find("> header > h3 > a:eq(1)").text(),t.projectName=e.parents("article.todolist").find("> header > h3 > a:eq(0)").text()):(t.projectName=e.parents("article.todolist").find("> header > h3 > a:eq(1)").text(),t.taskName=""),t.url=e.siblings("a").attr("href"),t.text=e.siblings("a").text()):"string"==typeof a[1]&&"todolists"==a[1]&&(1==TECA._.serviceSettings.basecamp?(t.taskName=e.parents("article.todolist").find("> header > h3 > a").clone().children().remove().end().text(),t.projectName=e.parents("article.todolist").find("> header > h3 > a > span.project_name").text().slice(0,-2)):(t.projectName=e.parents("article.todolist").find("> header > h3 > a").clone().children().remove().end().text(),t.taskName=""),t.url=e.siblings("a").attr("href"),t.text=e.siblings("a").text()),t.id=i,t.url="https://basecamp.com"+t.url,t}},TECA.Content.integrations.basecamp3={readable_name:"Basecamp 3",name:"basecamp3",timerModule:{init:function(e){var t=void 0;if(e.data("recording-id"))t=e.data("recording-id");else{if(void 0===e.attr("id"))return;t=e.attr("id").replace("recording_","")}var a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=2==TECA._.modulesStyle.basecamp3,o=jQuery(TECA.Gui.jhtml("integrationModule"+(n?"New":"")+"/moduleWrapper_body",{class:"te-timer-module te-module-sm te-module-dark",source:"basecamp3",projectType:null,integrationId:t,timerId:i,estimates:!0}));this.update(o);const r=jQuery('<div class="te-module-container" data-te-source="basecamp3"></div>');r.append(o),jQuery("div.checkbox > .checkbox__content",e).prepend(r),o.css("min-width",jQuery(".te-button",o).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA._.user.id>0,a=TECA.Content.integrations.basecamp3,i=jQuery(".todo-perma__details",e),n=window.location.pathname.slice(1).split("/")[4],o=TECA.Content.checkTimers(n),r=o?o.timerId:-1,s=2==TECA._.modulesStyle.basecamp3;(myModule=jQuery(TECA.Gui.jhtml("integrationModule"+(s?"New":"")+"/moduleWrapper_body",{class:"te-module te-native-module te-module-dark",source:"basecamp3",projectType:null,integrationId:n,timerId:r,estimates:!0})),myModule.html(TECA.Gui.jhtml("integrationModule"+(s?"New":"")+"/nativeModule_body",{logoUrl:s?chrome.extension.getURL(""):chrome.extension.getURL("images/logo_white_horiz_xs.svg"),userAvatarSrc:!!t&&TECA._.user.avatar,userName:!!t&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"todo",notUnique:!1,estimates:!0})),s)&&(myBtn=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"basecamp3",projectType:null,integrationId:n,timerId:r,estimates:!0})),a.timerModule.update(myBtn),jQuery(".timer-module-container",myModule).html(myBtn));jQuery(".te-native-new-entity",myModule).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"basecamp3"},a.getIntegrationData(myModule)),"registerTime"),!1})),i.after(myModule),this.update(myModule)},update:function(e){var t=2==TECA._.modulesStyle.basecamp3;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t){jQuery("html").data("color-scheme");var a=jQuery('<div class="te-module te-totals-module te-module-dark" data-te-source="basecamp3" data-te-btn-mode="'+t+'"></div>');switch(t){case"task":var i=null;e.data("recording-id")?i=e.data("recording-id"):void 0!==e.attr("id")&&(i=e.attr("id").replace("recording_","")),a.data("te-integration-id",i),jQuery(".te-timer-module",e).before(a);break;case"project":var n=e.hasClass("card--project")?"project-card":"project-detail",o="project-card"==n?e.data("filing-id"):jQuery("#main-content").data("bucket-id");a.data("te-integration-project-id",o);const t=jQuery('<div class="te-module-container" data-te-source="basecamp3" data-te-btn-mode="'+n+'"></div>');t.append('<div class="te-module te-logo-module te-module-dark"><i class="iconeye iconeye-timeneye-ico"></i></div>'),t.append(a),"project-card"==n?jQuery(".card__content section h2",e).after(t):jQuery(".project-header__name--overview .project-header__name-text",e).append(t)}this.update(a)},update:function(e){TECA.Content.setTotalsModuleContent(e)}},statusModule:{init:function(e){var t="project-card"==(e.hasClass("card--project")?"project-card":"project-detail")?e.data("filing-id"):jQuery("#main-content").data("bucket-id"),a=jQuery('<div class="te-module te-status-module te-module-dark" data-te-source="basecamp3" data-te-integration-project-id="'+t+'"></div>');jQuery(".te-module-container",e).append(a),this.update(a)},update:function(e){TECA.Content.setStatusModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("basecamp3","todo"),TECA.Timer.model.loadIntegrationTimerList("basecamp3",(function(e){TECA.Content._.timerList=e,jQuery("ul > li.todo, article.card--project, .panel--project").each((function(){t.parseTodos(jQuery(this),e)}))}))}),200),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("basecamp3",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTodos(jQuery(e),a)}))}))},queries:[{element:"li.todo, article.card--project, .panel--project"}]})},parseTodos:function(e){if("object"==typeof e&&e.parents("ul.completed").length<=0&&e.parents("ul.add").length<=0&&0==jQuery(".te-module",e).length){var t=2==TECA._.modulesStyle.basecamp3;if(mySegments=window.location.pathname.substring(1).split("/"),e.hasClass("card--project")||e.hasClass("panel--project"))1!=TECA._.user.isOwner&&1!=TECA._.user.isAdmin||!t||(this.totalsModule.init(e,"project"),this.statusModule.init(e));else if(3==mySegments.length&&"my"==mySegments[1]&&"assignments"==mySegments[2]||5==mySegments.length&&"todos"!=mySegments[3])this.timerModule.init(e),t&&this.totalsModule.init(e,"task");else if(5==mySegments.length&&"todos"==mySegments[3]){var a=e.parents(".recordable--todo");this.nativeModule.init(a)}}},getIntegrationData:function(e){var t={},a=window.location.pathname.substring(1).split("/"),i=e.data("te-integration-id");if(2==TECA._.modulesStyle.basecamp3)var n=e.parents(".te-module-container");return"string"==typeof a[3]&&"buckets"==a[1]&&"todosets"==a[3]?(1==TECA._.serviceSettings.basecamp3?(t.taskName=e.parents("article.todolist").find("header.todolist__header a.todolist__permalink").text(),t.projectName=e.parents("main").find(".recording-breadcrumbs > .recording-breadcrumb > .recording-breadcrumb__title > .u-position-context > a").text()):(t.taskName="",t.projectName=e.parents("article.todolist").find("header.todolist__header a.todolist__permalink").text()),t.url=n.siblings("span > a").eq(0).attr("href"),t.text=n.siblings("span > a").eq(0).text().replace(/\t|\n|\r/g,"").trim()):"string"==typeof a[3]&&"buckets"==a[1]&&"todolists"==a[3]?(1==TECA._.serviceSettings.basecamp3?(t.taskName=e.parents("article.todolist").find("header.todolist__header a.todolist__permalink").text(),t.projectName=e.parents("main").find(".recording-breadcrumbs > .recording-breadcrumb > .recording-breadcrumb__title > .u-position-context > a").text()):(t.taskName="",t.projectName=e.parents("article.todolist").find("header.todolist__header a.todolist__permalink").text()),t.url=n.siblings("a").eq(0).attr("href"),t.text=n.siblings("a").eq(0).text().replace(/\t|\n|\r/g,"").trim()):"string"==typeof a[3]&&"buckets"==a[1]&&"todos"==a[3]?(1==TECA._.serviceSettings.basecamp3?(t.taskName=e.parents(".recordable--todo").find("> .metadata > a:last-child").text(),t.projectName=e.parents("main").find(".recording-breadcrumbs > .recording-breadcrumb > .recording-breadcrumb__title > .u-position-context > a").text()):(t.taskName="",t.projectName=e.parents(".recordable--todo").find("> .metadata > a:last-child").text()),t.url=window.location.pathname,t.text=e.parents(".recordable--todo").find(".todos > .todo h1").text().trim()):"string"==typeof a[2]&&"my"==a[1]&&"assignments"==a[2]&&(1==TECA._.serviceSettings.basecamp3?(t.taskName=e.parents("article.todolist").find("a").text(),t.projectName=e.parents("article.todolist").prev(".metadata").find("a").text()):(t.taskName="",t.projectName=e.parents("article.todolist").find("> a").text()),t.url=e.parents(".checkbox__content").find("> a").eq(0).attr("href"),t.text=e.parents(".checkbox__content").find("> a").eq(0).text().replace(/\t|\n|\r/g,"").trim()),t.id=i,t.projectId=t.url.split("/")[3],t.url="https://3.basecamp.com"+t.url,t.todoId=i,t}},TECA.Content.integrations.clickup={readable_name:"Clickup",name:"clickup",timerModule:{init:function(e){var t=e.hasClass("cu-task-row__container")?"list":"board",a="list"==t?jQuery(".cu-task-row__main",e):jQuery(".cu-panel-board__header",e),i="list"===t?e.data("task"):e.parents(".cu-panel-board__task").data("task"),n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-module te-timer-module'+(n?" te-visible":"")+'" data-te-source="clickup" data-te-integration-id="'+i+'" data-te-timer-id="'+o+'" data-te-task-mode="'+t+'"></div>');e.on("mouseenter",(function(){r.hasClass("te-visible")||r.addClass("te-visible")})).on("mouseleave",(function(){-1==r.data("te-timer-id")&&r.hasClass("te-visible")&&r.removeClass("te-visible")})),this.update(r),a.after(r),jQuery(".te-base-info",r).outerWidth()>0&&r.css("min-width",jQuery(".te-base-info",r).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),jQuery(".te-base-info",e).outerWidth()>0&&e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA.Content.integrations.clickup,a=jQuery(".cu-task-hero-section",e),i=window.location.pathname.slice(1).split("/")[1],n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-module te-native-module" data-te-source="clickup" data-te-timer-id="'+o+'" data-te-integration-id="'+i+'" data-te-task-mode="pane" data-te-estimates="true"></div>');r.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",r).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"clickup"},t.getIntegrationData(r)),"registerTime"),!1})),a.after(r),this.update(r)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("clickup","task"),TECA.Timer.model.loadIntegrationTimerList("clickup",(function(e){TECA.Content._.timerList=e,jQuery(".cu-task-row__container, .cu-dashboard-board-card__task, .cu-task-view__main").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("clickup",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".cu-task-row__container, .cu-dashboard-board-card__task, .cu-task-view__main"}]})}),1e3)},parseTask:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&(e.hasClass("cu-task-view__main")?this.nativeModule.init(e):this.timerModule.init(e))},getIntegrationData:function(e){var t,a,i,n={},o=e.data("te-integration-id");if("pane"==e.data("te-task-mode")){var r=jQuery(".cu-task-view__container");n.text=jQuery(".cu-task-title__title",r).val(),void 0!==n.text&&""!=n.text.replace(/ /g,"")||(n.text=jQuery(".cu-task-title__overlay",r).text().trim()),i=jQuery(".cu-task-view-breadcrumbs__text",r),n.projectName=3===i.length?i.eq(1).text().trim():2===i.length?i.eq(0).text().trim():"",n.taskName=3===i.length?i.eq(2).text().trim():2===i.length?i.eq(1).text().trim():i.eq(0).text().trim(),n.url=window.location.href}else if("list"==e.data("te-task-mode")){var s=e.parents(".cu-list-group");i=jQuery(".cu-list-group__header-breadcrumbs",s).text().trim().split("/"),t=e.parents(".cu-task-row"),a=window.location.pathname.split("/"),n.projectName=3===i.length?i[1].trim():2===i.length?i[0].trim():"",n.taskName=3===i.length?i[2].trim():2===i.length?i[1].trim():i[0].trim(),n.text=jQuery(".cu-task-row-main__link-text",t).text().trim(),a.length>3&&a.splice(3),a.push("t"),a.push(o),n.url=jQuery(".cu-task-row-main__link",t).attr("href")}else"board"==e.data("te-task-mode")&&(t=e.parents(".cu-panel-board"),a=window.location.pathname.split("/"),i=jQuery(".cu-panel-board__subcategory",t),n.projectName=3===i.length?i.eq(1).text().trim():2===i.length?i.eq(0).text().trim():"",n.taskName=3===i.length?i.eq(2).text().trim():2===i.length?i.eq(1).text().trim():i.eq(0).text().trim(),n.text=jQuery(".cu-panel-board__clickable",t).text().trim(),a.length>3&&a.splice(3),a.push("t"),a.push(o),n.url=window.location.origin+a.join("/"));return n.id=o,n}},TECA.Content.integrations.customerly={readable_name:"Customerly",name:"customerly",timerModule:{init:function(e){var t=window.location.pathname.split("/"),a=_.last(t),i=TECA.Content.checkTimers(a),n=i?i.timerId:-1,o=jQuery('<div class="clickable te-module te-timer-module te-visible" data-te-source="customerly" data-te-integration-id="'+a+'" data-te-timer-id="'+n+'"></div>');this.update(o);var r=jQuery("<li></li>");r.append(o),e.append(r)},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){if("object"==typeof e&&0===jQuery(".te-module",e).length){var t=TECA.Content.integrations.customerly,a=window.location.pathname.split("/"),i=_.last(a),n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-module te-native-module" data-te-source="customerly" data-te-integration-id="'+i+'" data-te-timer-id="'+o+'" data-te-estimates="true"></div>');r.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",r).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"customerly"},t.getIntegrationData(r)),"registerTime"),!1})),jQuery(".user-info-container",e).after(r),this.update(r)}},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("customerly","task"),TECA.Timer.model.loadIntegrationTimerList("customerly",(function(e){TECA.Content._.timerList=e,jQuery(".nav.nav-tabs, .user-main-info").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("customerly",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".nav.nav-tabs, .user-main-info"}]})}),1e4)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&(e.hasClass("user-main-info")?this.nativeModule.init(e):this.timerModule.init(e))},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return t.text="Conversation with "+_.trim(jQuery(".user-data-header .user-name > input").val()),t.id=a,t}},TECA.Content.integrations.github={readable_name:"Github",name:"github",timerModule:{init:function(e){TECA.Content.integrations.github;var t,a,i=void 0,n=jQuery("a",e).attr("href");t=(n=n.split("/"))[1]+"/"+n[2]+"#"+n[4],a=n[1]+"#"+n[4];var o=TECA.Content.checkTimers(t),r=o?o.timerId:-1;i=jQuery('<div class="te-module te-timer-module'+(o?" te-visible":"")+'" data-te-source="github" data-te-integration-id="'+t+'" data-te-btn-mode="issue-list" data-te-alt-issue-id="'+a+'" data-te-issue-url="'+window.location.origin+"/"+n.join("/")+'" data-te-timer-id="'+r+'"></div>'),e.on("mouseenter",(function(){i.hasClass("te-visible")||i.addClass("te-visible")})).on("mouseleave",(function(){-1==i.data("te-timer-id")&&i.hasClass("te-visible")&&i.removeClass("te-visible")})),this.update(i),jQuery(".d-table",e).children().eq(-1).children().eq(-1).prepend(i),i.css("min-width",jQuery(".te-base-info",i).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA.Content.integrations.github,a=window.location.pathname.substring(1).split("/"),i=a[0]+"/"+a[1]+"#"+a[3],n=a[1]+"#"+a[3],o=TECA.Content.checkTimers(i),r=o?o.timerId:-1,s=jQuery('<div class="te-module te-native-module" data-te-source="github" data-te-timer-id="'+r+'" data-issue-id="'+i+'" data-te-btn-mode="issue-view" data-te-integration-id="'+i+'" data-te-alt-issue-id="'+n+'" data-te-issue-url="'+window.location.origin+"/"+a.join("/")+'" data-te-estimates="true"></div>');s.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",s).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"github"},t.getIntegrationData(s)),"registerTime"),!1})),e.after(s),this.update(s)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("github","issue"),TECA.Timer.model.loadIntegrationTimerList("github",(function(e){TECA.Content._.timerList=e,jQuery(".gh-header-meta").each((function(){t.parseIssue(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("github",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseIssue(jQuery(e))}))}))},queries:[{element:".gh-header-meta"}]})}),1500)},parseIssue:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.nativeModule.init(e)},nameFromBranchToHuman:function(e){return e.replace(/-/g," ").replace(/_/g," ")},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=window.location.pathname.substring(1).split("/"),n=i[0],o=i[1];return"issue-view"==e.data("te-btn-mode")&&(t.text=e.data("te-alt-issue-id")+" "+_.trim(e.parents("#partial-discussion-header").find("> .gh-header-show .gh-header-title > .js-issue-title").text())),1==TECA._.serviceSettings.github?(n&&""!=n.replace(/ /g,"")&&(t.projectName=n),o&&""!=o.replace(/ /g,"")&&(t.taskName=o)):o&&""!=o.replace(/ /g,"")&&(t.projectName=o),e.data("te-issue-url")&&""!=e.data("te-issue-url").replace(/ /g,"")&&(t.url=e.data("te-issue-url")),t.id=a,t}},TECA.Content.integrations.gitlabcom={readable_name:"Gitlab",name:"gitlabcom",timerModule:{init:function(e){TECA.Content.integrations.gitlabcom;var t,a,i,n=void 0,o="issue-list",r="";e.hasClass("board-card")?(o="board-view",e.css("position","relative")):o="issue-list","/"==(r="issue-view"==o?window.location.pathname:e.data("url")?new URL(e.data("url")).pathname:"board-view"==o?new URL(jQuery(".board-card-title > a",e).attr("href")).pathname:new URL(jQuery("a.gl-link",e).attr("href")).pathname)[0]&&(r=r.substring(1)),i=(t=(a=r.replace(/\/-\/issues\//,"#")).split("/"))[t.length-1];var s=TECA.Content.checkTimers(a),d=s?s.timerId:-1,l=s?" te-visible":"";"board-view"==o&&(l=" te-visible"),n=jQuery('<div class="te-module te-timer-module'+l+'" data-te-source="gitlabcom" data-te-integration-id="'+a+'" data-te-btn-mode="'+o+'" data-te-alt-issue-id="'+i+'" data-te-issue-url="'+window.location.origin+"/"+r+'" data-te-timer-id="'+d+'"></div>'),"board-view"!==o&&e.on("mouseenter",(function(){n.hasClass("te-visible")||n.addClass("te-visible")})).on("mouseleave",(function(){-1==n.data("te-timer-id")&&n.hasClass("te-visible")&&n.removeClass("te-visible")})),this.update(n),"board-view"==o?jQuery(".board-card-header",e).after(n):jQuery(".issuable-meta > .controls",e).prepend(n),n.css("min-width",jQuery(".te-base-info",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA.Content.integrations.gitlabcom,a=jQuery(".detail-page-description",e),i=window.location.pathname.substring(1),n=i.replace(/\/-\/issues\//,"#"),o=n.split("/"),r=o[o.length-1],s=TECA.Content.checkTimers(n),d=s?s.timerId:-1,l=jQuery('<div class="te-module te-native-module" data-te-source="gitlabcom" data-te-timer-id="'+d+'" data-issue-id="'+n+'" data-te-btn-mode="issue-view" data-te-integration-id="'+n+'" data-te-alt-issue-id="'+r+'" data-te-issue-url="'+window.location.origin+"/"+i+'" data-te-estimates="true"></div>');l.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",l).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"gitlabcom"},t.getIntegrationData(l)),"registerTime"),!1})),a.after(l),this.update(l)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("gitlabcom","issue"),TECA.Timer.model.loadIntegrationTimerList("gitlabcom",(function(e){TECA.Content._.timerList=e,jQuery('.issues-list > .issue, .issues-sortable-list > .issuable-row, .board .board-list > .board-card, body[data-page="projects:issues:show"]').each((function(){t.parseIssue(jQuery(this))}))}))}),1500),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("gitlabcom",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseIssue(jQuery(e))}))}))},queries:[{element:"li.issue, li.issuable-row, li.board-card"}]})},parseIssue:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&(void 0===e.data("page")||"projects:issues:show"!=e.data("page")?this.timerModule.init(e):"projects:issues:show"==e.data("page")&&this.nativeModule.init(e))},nameFromBranchToHuman:function(e){return e.replace(/-/g," ").replace(/_/g," ")},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=a.split("/"),n=i[0],o=i[1],r="";return t.text=e.data("te-alt-issue-id"),"issue-view"==e.data("te-btn-mode")?(t.text+=" "+e.parents("#content-body").find("> .issue-details > .detail-page-description h1.title").text(),jQuery("span.label",jQuery(".issuable-show-labels")).each((function(){r+=jQuery(this).text().trim()+","})),r.length>0&&(r=r.slice(0,-1))):"board-view"==e.data("te-btn-mode")?(t.text+=" "+e.parents("li").find(".board-card-header > .board-card-title > a").text(),e.parents(".board-inner").find(".board-title span.label").each((function(){r+=jQuery(this).text().trim()+","})),e.parents("li").find(".board-card-footer .label").each((function(){r+=jQuery(this).text().trim()+","})),r.length>0&&(r=r.slice(0,-1))):(t.text+=" "+jQuery(".issuable-main-info > .issue-title > a",e.parents(".issue")).text(),e.parents("li").find("span.label").each((function(){r+=jQuery(this).text().trim()+","})),r.length>0&&(r=r.slice(0,-1))),1==TECA._.serviceSettings.gitlabcom?(n&&""!=n.replace(/ /g,"")&&(t.projectName=n),o&&""!=o.replace(/ /g,"")&&(t.taskName=o)):(o&&""!=o.replace(/ /g,"")&&(t.projectName=o),r&&""!=r.replace(/ /g,"")&&(t.taskName=r)),e.data("te-issue-url")&&""!=e.data("te-issue-url").replace(/ /g,"")&&(t.url=e.data("te-issue-url")),t.id=a,t}},TECA.Content.integrations.googledocs={readable_name:"Google Docs",name:"googledocs",timerModule:{init:function(e){var t=window.location.pathname.slice(1).split("/")[2],a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="goog-toolbar-button goog-inline-block te-module te-timer-module te-visible" data-te-source="googledocs" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></div>');this.update(n),jQuery(e).append('<div class="docs-toolbar-small-separator goog-toolbar-separator goog-inline-block"></div>').append(n),n.css("min-width",jQuery(".te-button",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("googledocs","task"),TECA.Timer.model.loadIntegrationTimerList("googledocs",(function(e){TECA.Content._.timerList=e,jQuery("#docs-toolbar").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("googledocs",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:"#docs-toolbar"}]})}),2500)},parseTask:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return t.text=jQuery("#docs-titlebar .docs-title-input-label-inner").text(),t.id=a,"string"==typeof t.text&&""!=t.text.replace(/ /g,"")&&(t.url="https://drive.google.com/drive/search?q="+encodeURI(t.text)),t}},TECA.Content.integrations.googlemail={readable_name:"Google Mail",name:"googlemail",timerModule:{init:function(e){var t=window.location.hash,a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="te-module te-timer-module te-visible" data-te-source="googlemail" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'" data-te-btn-mode=""></div>');this.update(n),jQuery(e).append(n),n.css("min-width",jQuery(".te-button",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("googlemail","task"),setTimeout((function(){TECA.Timer.model.loadIntegrationTimerList("googlemail",(function(e){TECA.Content._.timerList=e;var a=jQuery('#\\:4 div[gh="tm"] div[gh="mtb"] > div.G-tF');a.length>0&&jQuery('#\\:1 div.nH div.nH[role="main"]')&&t.parseTask(a)}))}),100);var e=jQuery("#\\:1 > div.nH"),a=e[0],i=jQuery("div.nH.aNW.apk div.nH.ao8 > table"),n=i[0],o={attributes:!1,childList:!0,subtree:!0},r=function(e){_.forEach(e,(function(e){_.forEach(e.addedNodes,(function(e){var a=jQuery(e);null!=a[0]&&"TD"==a[0].nodeName&&"Bu"==a[0].className&&t.parseTask(jQuery('#\\:1 div[gh="tm"] div[gh="mtb"] > div.bzn.bzo > div.G-tF'))}))}))},s=new MutationObserver((function(e){setTimeout(function(e){_.forEach(e,(function(e){_.forEach(e.addedNodes,(function(e){if(null!=jQuery(e)[0].attributes){var a=jQuery('#\\:1 > div.nH > div.nH[role="main"]:not(.BltHke)');1==a.length&&"nH"==a[0].className&&t.parseTask(jQuery('#\\:4 div[gh="tm"] div[gh="mtb"] > div.G-tF'))}}))}))}(e),500)})),d=new MutationObserver((function(e){setTimeout(r(e),500)}));"undefined"!=a&&e.length>0&&s.observe(a,o),"undefined"!=n&&i.length>0&&d.observe(n,o)}),1e3)},parseTask:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return t.text=jQuery("[data-thread-perm-id]").text(),t.id=a,t}},TECA.Content.integrations.googlesheets={readable_name:"Google Sheets",name:"googlesheets",timerModule:{init:function(e){var t=window.location.pathname.slice(1).split("/")[2],a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="goog-toolbar-button goog-inline-block te-module te-timer-module te-visible" data-te-source="googlesheets" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></div>');this.update(n),jQuery(e).append('<div class="docs-toolbar-small-separator goog-toolbar-separator goog-inline-block"></div>').append(n),n.css("min-width",jQuery(".te-button",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("googlesheets","task"),TECA.Timer.model.loadIntegrationTimerList("googlesheets",(function(e){TECA.Content._.timerList=e,jQuery("#docs-toolbar").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("googlesheets",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:"#docs-toolbar"}]})}),2500)},parseTask:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return t.text=jQuery("#docs-titlebar .docs-title-input-label-inner").text(),t.id=a,"string"==typeof t.text&&""!=t.text.replace(/ /g,"")&&(t.url="https://drive.google.com/drive/search?q="+encodeURI(t.text)),t}},TECA.Content.integrations.jira={readable_name:"Jira",name:"jira",timerModule:{init:function(e){var t,a,i="software-backlog.card-list.card.context-menu.escape-wrapper"===e.data("testid")?"list":"card";if(void 0!==(a="list"===i?(t=e.parent().data("testid").split("."))[t.length-1]:(t=e.attr("id")).slice(5))){var n=TECA.Content.checkTimers(a),o="company-list"==i?jQuery(".ghx-stat-2",e):"company-card"==i?jQuery(".ghx-issue-content > .ghx-end > .ghx-end",e):"team-card"==i?jQuery(".puw1ku-4",e):jQuery(".uxuxxs-2",e),r=n?n.timerId:-1,s=2==TECA._.modulesStyle.jira,d=window.location.pathname.slice(1).split("/")[1],l=jQuery('<div class="te-module-container button-link js-toggle-timer'+("company-list"==i?" ghx-row ghx-stat-1":"")+'" data-te-source="jira" data-te-btn-mode="'+i+'"></div>'),u=jQuery(TECA.Gui.jhtml("integrationModule"+(s?"New":"")+"/moduleWrapper_body",{class:"te-timer-module te-module-sm"+(s?"":" button-link js-toggle-timer"),source:"jira",projectType:d,integrationId:a,timerId:r,btnMode:i,estimates:!0}));this.update(u),s&&(u=l.html(u)),"company-list"===i||"team-list"===i?o.after(u):o.append(u),u.css("min-width",Math.min(jQuery(".te-base-info",u).outerWidth(),22))}},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t,a=TECA.Content.integrations.jira,i=TECA._.user.id>0,n=jQuery('div[data-testid="issue.views.issue-base.context.status-and-approvals-wrapper.status-and-approval"]',e),o=window.location.pathname.slice(1).split("/"),r=_.includes(o,"browse")?"details":_.includes(o,"issues")?"issue-detail":"panel",s=o[1],d=2==TECA._.modulesStyle.jira;t="panel"==r?jQuery("span",jQuery('a[data-testid="issue.views.issue-base.foundation.breadcrumbs.current-issue.item"]',jQuery('[data-testid="issue.views.issue-base.foundation.breadcrumbs.breadcrumb-current-issue-container"]'))).text():"issue-details"==r?o[o.length-1]:o[1];var l=TECA.Content.checkTimers(t),u=l?l.timerId:-1,c=jQuery(TECA.Gui.jhtml("integrationModule"+(d?"New":"")+"/moduleWrapper_body",{class:"te-native-module",source:"jira",projectType:s,integrationId:t,timerId:u,btnMode:r,estimates:!0}));if(c.html(TECA.Gui.jhtml("integrationModule"+(d?"New":"")+"/nativeModule_body",{logoUrl:d?chrome.extension.getURL(""):chrome.extension.getURL("images/logo_white_horiz_xs.svg"),userAvatarSrc:!!i&&TECA._.user.avatar,userName:!!i&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"task",notUnique:!1,estimates:!0})),d){var m=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"jira",integrationId:t,timerId:u,btnMode:r,estimates:!0}));TECA.Content.integrations.jira.timerModule.update(m),jQuery(".timer-module-container",c).html(m)}jQuery(".te-native-new-entity",c).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"jira"},a.getIntegrationData(c)),"registerTime",TECA.Content.integrations.jira.getOptFunctions()),!1})),n.before(c),this.update(c)},update:function(e){var t=2==TECA._.modulesStyle.jira;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t){var a,i=window.location.pathname.split("/"),n=e.hasClass("uxuxxs-1")?"team-list":e.hasClass("hanvr0-1")?"team-card":e.hasClass("js-detailview")?"company-list":"company-card",o=jQuery('<div class="te-module te-totals-module" data-te-source="jira" data-te-btn-mode="'+t+'"></div>');switch(t){case"task":a="company-list"==n||"company-card"==n?e.data("issue-key"):"team-list"==n?jQuery(".zd1ddu-3 > .zd1ddu-2:not(.zd1ddu-4)",e).text():jQuery(".drrg1n-0",e).text(),o.data("te-integration-id",a),jQuery(".te-timer-module",e).before(o),this.update(o);break;case"project":const t=i[i.indexOf("projects")+1];o.data("te-integration-project-id",t),this.update(o);const r=jQuery('<div class="te-module-container" data-te-source="jira"></div>');r.append('<div class="te-module te-logo-module"><i class="iconeye iconeye-timeneye-ico"></i></div>'),r.append(o),jQuery(".css-zaxvqe",e).append(r)}},update:function(e){TECA.Content.setTotalsModuleContent(e)}},statusModule:{init:function(e){var t=window.location.pathname.split("/"),a=t[t.indexOf("projects")+1];if(!a){var i=t[t.indexOf("browse")+1];i&&(a=i.split("-")[0])}if(a){var n=jQuery('<div class="te-module te-status-module" data-te-source="jira" data-te-integration-project-id="'+a+'"></div>');jQuery(".te-module-container",e).append(n),this.update(n)}},update:function(e){TECA.Content.setStatusModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("jira","task"),TECA.Timer.model.loadIntegrationTimerList("jira",(function(e){TECA.Content._.timerList=e,jQuery('.js-issue,div[data-testid="issue.views.issue-details.issue-layout.issue-layout"],div[data-testid="software-backlog.card-list.card.context-menu.escape-wrapper"],div[data-testid="platform-board-kit.ui.card.card"],div[data-testid="clipboard.controllers.boundary.clipboard-boundary"],.css-mvqjze').each((function(){t.parseTask(jQuery(this))}))}))}),1500),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("jira",(function(a){TECA.Content._.timerList=a;var i=e[0],n=e[1];i.added.forEach((function(e){t.parseTask(jQuery(e))})),n.attributeChanged&&n.attributeChanged.href&&n.attributeChanged.href.forEach((function(e){var a=jQuery(e).parents('div[data-testid="clipboard.controllers.boundary.clipboard-boundary"]');a.length&&(jQuery(".te-module",jQuery(a[0])).remove(),t.parseTask(jQuery(a[0])))}))}))},queries:[{element:'.js-issue,div[data-testid="issue.views.issue-details.issue-layout.issue-layout"],div[data-testid="software-backlog.card-list.card.context-menu.escape-wrapper"],div[data-testid="platform-board-kit.ui.card.card"],div[data-testid="clipboard.controllers.boundary.clipboard-boundary"],.css-mvqjze'},{element:'a[data-testid="issue.views.issue-base.foundation.breadcrumbs.current-issue.item"]',elementAttributes:"href"}]})},getOptFunctions:function(){return{onInit:function(){jQuery('section[role="dialog"]').css("display","none")},onDialogClose:function(){0==jQuery(".te-dialog.card-type").length&&jQuery('section[role="dialog"]').css("display","inherit")}}},parseTask:function(e){var t=2==TECA._.modulesStyle.jira;"object"==typeof e&&0===jQuery(".te-module",e).length&&(e.hasClass("js-issue")||"software-backlog.card-list.card.context-menu.escape-wrapper"==e.data("testid")||"platform-board-kit.ui.card.card"==e.data("testid")?(this.timerModule.init(e),t&&this.totalsModule.init(e,"task")):e.hasClass("css-mvqjze")?1!=TECA._.user.isOwner&&1!=TECA._.user.isAdmin||!t||(this.totalsModule.init(e,"project"),this.statusModule.init(e)):this.nativeModule.init(e))},getIntegrationData:function(e){var t={},a=window.location.pathname.split("/"),i=e.data("te-integration-id"),n=e.data("te-btn-mode"),o=e.data("te-project-type"),r="team-list"==n?e.parents(".uxuxxs-1"):"team-card"==n?e.parents(".hanvr0-1"):"company-list"==n||"company-card"==n?e.parents(".js-issue"):e.parents("div[data-testid='issue.views.issue-details.issue-layout.issue-layout']");return"core"===o?t.projectName=jQuery('div[data-testid="business-horizontal-nav.ui.project-header"] li > a > span')[2].innerText:"software"===o&&(t.projectName="details"==n?jQuery('nav[aria-label="Breadcrumbs"] li > a > span')[2].innerText:jQuery('nav[aria-label="Breadcrumbs"] li > a > span')[1].innerText),t.text="company-list"==n||"company-card"==n?jQuery(".ghx-summary",r).text():"team-list"==n?jQuery(".zd1ddu-5 > .zd1ddu-6 > div > .zd1ddu-7",r).text():"team-card"==n?jQuery(".puw1ku-0 > span",r).text():jQuery('h1[data-testid="issue.views.issue-base.foundation.summary.heading"]',r).text(),t.id=i,t.projectId=a[a.indexOf("projects")+1],t.url=window.location.origin+"/browse/"+i,t}},TECA.Content.integrations.monday={readable_name:"Monday",name:"monday",taskId:-1,timerModule:{init:function(e){var t=TECA.Content.integrations.monday,a=e.hasClass("pulse-component")?"list":"kanban",i=e.hasClass("pulse-component")?t.extractId(e.prop("id")):t.extractId(e.data("listitemid")),n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-wrapper"></div>'),s=jQuery('<div class="te-module-container" data-te-source="monday" data-te-btn-mode="'+a+'"></div>'),d=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module te-module-sm",source:"monday",projectType:null,integrationId:i,timerId:o,btnMode:a,estimates:!0}));this.update(d),d=s.html(d),r.html(d),jQuery('[data-testid="kanban-card"] > div:last',e).append(r),e.on("click",(function(){TECA.Content.integrations.monday.taskId=i})),d.css("min-width",jQuery(".te-button",d).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t,a=TECA._.user.id>0,i=TECA.Content.integrations.monday,n=e.hasClass("slide-panel-content")?"panel":"dialog",o=i.taskId,r=TECA.Content.checkTimers(o),s=r?r.timerId:-1,d=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-native-module",source:"monday",projectType:null,integrationId:o,timerId:s,btnMode:n,estimates:!0}));d.html(TECA.Gui.jhtml("integrationModuleNew/nativeModule_body",{logoUrl:chrome.runtime.getURL(""),userAvatarSrc:!!a&&TECA._.user.avatar,userName:!!a&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"task",notUnique:!1,estimates:!0})),t=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"monday",projectType:null,integrationId:o,timerId:s,btnMode:n,estimates:!0})),i.timerModule.update(t),jQuery(".timer-module-container",d).html(t),jQuery(".te-native-new-entity",d).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"monday"},i.getIntegrationData(d)),"registerTime",TECA.Content.integrations.monday.getOptFunctions()),!1})),"panel"===n?jQuery(".pulse_title",e).after(d):jQuery(".pulse-card-component",e).append(d),this.update(d)},update:function(e){var t=2==TECA._.modulesStyle.monday;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t){var a=TECA.Content.integrations.monday,i=jQuery('<div class="te-module te-totals-module" data-te-source="monday" data-te-btn-mode="'+t+'"></div>');const n=e.hasClass("pulse-component")?a.extractId(e.prop("id")):a.extractId(e.data("listitemid"));i.data("te-integration-id",n),jQuery(".te-timer-module",e).before(i),this.update(i)},update:function(e){TECA.Content.setTotalsModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("monday","story"),TECA.Timer.model.loadIntegrationTimerList("monday",(function(e){TECA.Content._.timerList=e,jQuery('[data-sortabletype="LIST_ITEM"], .pulse-component, .pulse-values-and-header-wrapper, .slide-panel-content').each((function(){var e=jQuery(this);t.parseTask(e)}))}))}),1500),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("monday",(function(a){TECA.Content._.timerList=a,e[0].added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:'[data-sortabletype="LIST_ITEM"], .pulse-component, .pulse-values-and-header-wrapper, .slide-panel-content'}]})},getOptFunctions:function(){return{onInit:function(){jQuery(".ms-Dialog-main").css("display","none"),jQuery(".ms-Dialog").css("display","none")},onDialogClose:function(){0==jQuery(".te-dialog.card-type").length&&(jQuery(".ms-Dialog-main").css("display","inherit"),jQuery(".ms-Dialog").css("display","flex"))}}},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&(e.hasClass("pulse-component")||"LIST_ITEM"===e.data("sortabletype")?this.timerModule.init(e):this.nativeModule.init(e))},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=e.data("te-btn-mode");return t.id=a,t.todoId=a,t.projectName=jQuery('[data-testid="object-name"]').text(),t.taskName="",t.text="kanban"===i?e.parents('[data-testid="kanban-card"]').find('[data-testid="card-name"] textarea').text():"panel"===i?jQuery(".pulse_title .title-wrapper h2").text():jQuery(".pulse-page-name-wrapper").text(),t},extractId:function(e){const t=e.match(/\d+/);return t?parseInt(t[0],10):null}},TECA.Content.integrations.microsofttodo={readable_name:"Microsoft to-do",name:"microsofttodo",nativeModule:{init:function(e){if("object"==typeof e&&0===jQuery(".te-module",e).length){var t=TECA.Content.integrations.microsofttodo,a=jQuery(".details-body",e),i=window.location.pathname.split("/")[3],n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="section"></div>'),s=jQuery('<div class="te-module te-native-module" data-te-source="microsofttodo" data-te-timer-id="'+o+'" data-te-integration-id="'+i+'" data-te-estimates="true"></div>');s.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",s).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"microsofttodo"},t.getIntegrationData(s)),"registerTime"),!1})),r.html(s),a.append(r),this.update(s)}},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("microsofttodo","task"),TECA.Timer.model.loadIntegrationTimerList("microsofttodo",(function(e){TECA.Content._.timerList=e,jQuery(".details").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("microsofttodo",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))})),e.attributeChanged["aria-label"].forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".details",elementAttributes:"aria-label"}]})}),200)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.nativeModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=e.parents(".details-body");return t.text=_.trim(jQuery(".detailHeader-title  .editableContent-display",i).text()),t.id=a,t.url="https://to-do.microsoft.com/tasks/id/"+a+"/details",t}},TECA.Content.integrations.microsoftproject={readable_name:"Microsoft Projects",name:"microsoftproject",taskId:-1,timerModule:{init:function(e){var t=e.prop("id"),a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="te-wrapper" style="margin-top: '+(a?"-6px;":"-2px;")+'"></div>'),o=2==TECA._.modulesStyle.planner,r=jQuery('<div class="te-module-container" data-te-source="planner" data-te-mode="new" data-te-btn-mode="card"></div>'),s=jQuery(TECA.Gui.jhtml("integrationModule"+(o?"New":"")+"/moduleWrapper_body",{class:"te-timer-module te-module-sm",source:"planner",projectType:null,integrationId:t,timerId:i,btnMode:"card",estimates:!0}));this.update(s),o&&(s=r.html(s)),n.html(s),jQuery(".task-card .indicatorRow",e).css("flex-wrap","wrap").append(n),jQuery(".task-card",e).on("click",(function(){TECA.Content.integrations.microsoftproject.taskId=t})),s.css("min-width",jQuery(".te-button",s).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t,a=TECA._.user.id>0,i=TECA.Content.integrations.microsoftproject,n=new URLSearchParams(location.hash.split("?")[1]).get("taskId"),o=TECA.Content.checkTimers(n),r=o?o.timerId:-1,s=2==TECA._.modulesStyle.planner,d=jQuery(TECA.Gui.jhtml("integrationModule"+(s?"New":"")+"/moduleWrapper_body",{class:"te-native-module",source:"planner",projectType:null,integrationId:n,timerId:r,mode:"new",btnMode:"edit",estimates:!0}));(d.html(TECA.Gui.jhtml("integrationModule"+(s?"New":"")+"/nativeModule_body",{logoUrl:s?chrome.extension.getURL(""):chrome.extension.getURL("images/logo_white_horiz_xs.svg"),userAvatarSrc:!!a&&TECA._.user.avatar,userName:!!a&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"task",notUnique:!1,estimates:!0})),s)&&(t=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"planner",projectType:null,integrationId:n,timerId:r,btnMode:"edit",estimates:!0})),i.timerModule.update(t),jQuery(".timer-module-container",d).html(t));jQuery(".te-native-new-entity",d).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"planner"},i.getIntegrationData(d)),"registerTime",TECA.Content.integrations.microsoftproject.getOptFunctions()),!1})),jQuery(".taskDetailsMainContentPrimary",e).prepend(d),this.update(d)},update:function(e){var t=2==TECA._.modulesStyle.planner;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t){var a=jQuery('<div class="te-module te-totals-module" data-te-source="planner" data-te-mode="new" data-te-btn-mode="'+t+'"></div>');switch(t){case"task":const t=e.prop("id");a.data("te-integration-id",t),jQuery(".te-timer-module",e).before(a);break;case"project":const i=new URLSearchParams(location.href).get("planId");a.data("te-integration-project-id",i),jQuery(".contextInfoSectionContainer",e).append('<div class="te-module te-logo-module"><i class="iconeye iconeye-timeneye-ico"></i></div>'),jQuery(".contextInfoSectionContainer",e).append(a)}this.update(a)},update:function(e){TECA.Content.setTotalsModuleContent(e)}},statusModule:{init:function(e){var t=new URLSearchParams(location.href).get("planId");myModule=jQuery('<div class="te-module te-status-module" data-te-source="planner" data-te-integration-project-id="'+t+'"></div>'),jQuery(".contextInfoSectionContainer",e).append(myModule),this.update(myModule)},update:function(e){TECA.Content.setStatusModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("planner","task"),TECA.Timer.model.loadIntegrationTimerList("planner",(function(e){TECA.Content._.timerList=e,jQuery(".task-board-card, .taskDetailsContainer").each((function(){t.parseTask(jQuery(this))}))}))}),500),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("planner",(function(a){TECA.Content._.timerList=a,e[0].added.forEach((function(e){t.parseTask(jQuery(e))})),e[1].attributeChanged["aria-label"].forEach((function(e){t.parseTask(jQuery(e).parents(".taskDetailsContainer"))}))}))},queries:[{element:".task-board-card, .taskDetailsContainer"},{element:"[data-landmark]",elementAttributes:"aria-label"}]})},getOptFunctions:function(){return{onInit:function(){jQuery(".ms-Dialog").css("display","none")},onDialogClose:function(){0==jQuery(".te-dialog.card-type").length&&jQuery(".ms-Dialog").css("display","flex")}}},parseTask:function(e){var t=2==TECA._.modulesStyle.planner;"object"==typeof e&&0==jQuery(".te-module",e).length&&(e.hasClass("task-board-card")?(this.timerModule.init(e),t&&this.totalsModule.init(e,"task")):e.hasClass("taskDetailsContainer")&&this.nativeModule.init(e))},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return"card"==e.data("te-btn-mode")?(t.text=e.parents(".topBar").find(".title").text(),t.taskName=jQuery(".column-title > h2",e.parents(".board-column")).text()):(t.text=jQuery(".taskName .ms-TextField input").val(),t.taskName=jQuery(".bucketFieldWithPriority .ms-Label",e.parents(".taskDetailsMainContent")).text()),t.projectName=jQuery("#topTitleText").text(),t.id=a,t.todoId="|"+a,t.projectId=new URLSearchParams(location.hash.split("?")[1]).get("projectId"),t.url=location.origin+location.pathname,t.url.includes("planner.cloud.microsoft")?t.url+="/task/"+a:t.url+="#/taskboard?projectId="+t.projectId+"&taskId="+a,t}},TECA.Content.integrations.pivotaltracker={readable_name:"PivotalTracker",name:"pivotaltracker",timerModule:{init:function(e){var t=e.data("id"),a="https://www.pivotaltracker.com/story/show/"+t,i=TECA.Content.checkTimers(t),n=i?i.timerId:-1,o=jQuery('<div class="te-module te-timer-module'+(i?" te-visible":"")+'" data-te-source="pivotaltracker" data-te-integration-id="'+t+'" data-te-story-url="'+a+'" data-te-btn-mode="preview" data-te-timer-id="'+n+'"></div>');e.on("mouseenter",(function(){o.hasClass("te-visible")||o.addClass("te-visible")})).on("mouseleave",(function(){-1==o.data("te-timer-id")&&o.hasClass("te-visible")&&o.removeClass("te-visible")})),this.update(o),jQuery("> header.preview > span.state",e).append(o),o.css("min-width",jQuery(".te-button",o).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e){var t=TECA.Content.integrations.pivotaltracker,a=jQuery(".model_details",e),i=e.hasClass("maximized")?window.location.pathname.slice(1).split("/")[4]:e.data("id"),n="https://www.pivotaltracker.com/story/show/"+i,o=e.data("cid"),r=TECA.Content.checkTimers(i),s=r?r.timerId:-1,d=e.hasClass("maximized")?" full":"",l=jQuery('<div class="te-module te-native-module'+d+'" data-te-source="pivotaltracker" data-te-integration-id="'+i+'" data-te-story-url="'+n+'" data-te-btn-mode="edit" data-te-timer-id="'+s+'" data-te-estimates="true"></div>');d&&(o+="f"),l.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!0,entityId:o,estimates:!0})),jQuery(".te-native-new-entity",l).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"pivotaltracker"},t.getIntegrationData(l)),"registerTime"),!1})),a.after(l),this.update(l)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("pivotaltracker","story"),TECA.Timer.model.loadIntegrationTimerList("pivotaltracker",(function(e){TECA.Content._.timerList=e,jQuery(".story.item").each((function(){t.parseStory(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("pivotaltracker",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseStory(jQuery(e))}))}))},queries:[{element:".story.item"}]})}),200)},parseStory:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&("StoryPreviewItem"==e.data("aid")?this.timerModule.init(e):this.nativeModule.init(e))},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return"edit"==e.data("te-btn-mode")?(t.text=e.parents(".story.item").find("textarea").text(),t.taskName="",e.parents(".story.item").find("> div > .edit.details > .edit > labels_container >.labels > div > div > div > div").each((function(){t.taskName+=" "+jQuery(this).text().replace(", ","")}))):(t.text=e.parents(".story.item").find("> header.preview > span.name > span.story_name").text(),t.taskName="",e.parents(".story.item").find("> header.preview > span.name > span.labels.post > a.label").each((function(){t.taskName+=" "+jQuery(this).text().replace(", ","")}))),e.data("te-story-url")&&""!=e.data("te-story-url").replace(/ /g,"")&&(t.url=e.data("te-story-url")),t.projectName=jQuery("header.tc_page_header > ul > li > div > h1 > .tc_projects_dropdown_link > .tc_context_name > .raw_context_name").text(),t.id=a,t}},TECA.Content.integrations.podio={readable_name:"Podio",name:"podio",timerModule:{init:function(e){var t=e.data("task-id");if(void 0!==t){var a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="button-link js-toggle-timer te-module te-timer-module te-visible" data-te-source="podio" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></div>');this.update(n),jQuery(".date-with-checkbox",e).prepend(n),n.css("min-width",jQuery(".te-base-info",n).outerWidth())}},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("podio","task"),TECA.Timer.model.loadIntegrationTimerList("podio",(function(e){TECA.Content._.timerList=e,jQuery(".task-wrapper").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("podio",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".task-wrapper"}]})}),500)},parseTask:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=e.parents(".task-wrapper");return jQuery(".task-summary .labels > a",i).length>0&&(t.projectName=jQuery(".task-summary .labels > a",i).eq(0).text()),t.text=jQuery(".task-summary a.task-link",i).text(),t.id=a,t.url="https://podio.com/tasks/"+a,t}},TECA.Content.integrations.planner={readable_name:"Microsoft Planner",name:"planner",taskId:-1,timerModule:{init:function(e,t){var a=e.prop("id"),i=TECA.Content.checkTimers(a),n=i?i.timerId:-1,o=jQuery('<div class="te-wrapper"></div>'),r=2==TECA._.modulesStyle.planner,s=jQuery('<div class="te-module-container" data-te-source="planner" data-te-mode="'+t+'" data-te-btn-mode="card"></div>'),d=jQuery(TECA.Gui.jhtml("integrationModule"+(r?"New":"")+"/moduleWrapper_body",{class:"te-timer-module te-module-sm",source:"planner",projectType:null,integrationId:a,timerId:n,mode:t,btnMode:"card",estimates:!0}));this.update(d),r&&(d=s.html(d)),o.html(d),"old"===t?(jQuery(".taskCard .titleRow, .task-card .indicatorRow",e).after(o),jQuery(".taskCard, .task-card",e).on("click",(function(){TECA.Content.integrations.planner.taskId=a}))):(jQuery(".task-card .indicatorRow",e).css("flex-wrap","wrap").append(o),jQuery(".task-card",e).on("click",(function(){TECA.Content.integrations.planner.taskId=a}))),d.css("min-width",jQuery(".te-button",d).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},nativeModule:{init:function(e,t){var a,i=TECA._.user.id>0,n=TECA.Content.integrations.planner,o=location.pathname.split("/"),r=location.pathname.includes("task/")?o[o.length-1]:n.taskId,s=TECA.Content.checkTimers(r),d=s?s.timerId:-1,l=2==TECA._.modulesStyle.planner,u=jQuery(TECA.Gui.jhtml("integrationModule"+(l?"New":"")+"/moduleWrapper_body",{class:"te-native-module",source:"planner",projectType:null,integrationId:r,timerId:d,mode:t,btnMode:"edit",estimates:!0}));(u.html(TECA.Gui.jhtml("integrationModule"+(l?"New":"")+"/nativeModule_body",{logoUrl:l?chrome.extension.getURL(""):chrome.extension.getURL("images/logo_white_horiz_xs.svg"),userAvatarSrc:!!i&&TECA._.user.avatar,userName:!!i&&TECA._.user.name,canSeeTeamTrackedTime:1==TECA._.user.isAdmin||1==TECA._.user.isOwner,serviceItem:"task",notUnique:!1,estimates:!0})),l)&&(a=jQuery(TECA.Gui.jhtml("integrationModuleNew/moduleWrapper_body",{class:"te-timer-module",source:"planner",projectType:null,integrationId:r,timerId:d,mode:t,btnMode:"edit",estimates:!0})),n.timerModule.update(a),jQuery(".timer-module-container",u).html(a));jQuery(".te-native-new-entity",u).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"planner"},n.getIntegrationData(u)),"registerTime",TECA.Content.integrations.planner.getOptFunctions()),!1})),"old"===t?jQuery(".taskEditor .description",e).after(u):jQuery(".taskDetailsMainContentPrimary",e).prepend(u),this.update(u)},update:function(e){var t=2==TECA._.modulesStyle.planner;TECA.Content.setNativeModuleContent(e),t?(TECA.Content.setNativeModuleTotalSections(e),TECA.Content.setNativeModuleActions(e)):TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},totalsModule:{init:function(e,t,a){var i=jQuery('<div class="te-module te-totals-module" data-te-source="planner" data-te-mode="'+a+'" data-te-btn-mode="'+t+'"></div>');switch(t){case"task":const t=e.prop("id");i.data("te-integration-id",t),jQuery(".te-timer-module",e).before(i);break;case"project":const a=new URLSearchParams(location.href).get("planId");i.data("te-integration-project-id",a),jQuery(".te-wrapper-module, .contextInfoSectionContainer",e).append('<div class="te-module te-logo-module"><i class="iconeye iconeye-timeneye-ico"></i></div>'),jQuery(".te-wrapper-module, .contextInfoSectionContainer",e).append(i)}this.update(i)},update:function(e){TECA.Content.setTotalsModuleContent(e)}},statusModule:{init:function(e,t){var a=new URLSearchParams(location.href).get("planId"),i=jQuery('<div class="te-module te-status-module" data-te-source="planner" data-te-mode="'+t+'" data-te-integration-project-id="'+a+'"></div>');jQuery(".te-wrapper-module, .contextInfoSectionContainer",e).append(i),this.update(i)},update:function(e){TECA.Content.setStatusModuleContent(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("planner","story"),TECA.Timer.model.loadIntegrationTimerList("planner",(function(e){TECA.Content._.timerList=e,jQuery(".topHeader, .taskBoardCard, .ms-Dialog-main, .task-board-card, .taskDetailsContainer").each((function(){var e=jQuery(this),a="old";(e.hasClass("task-board-card")||e.hasClass("taskDetailsContainer"))&&(a="new"),t.parseStory(jQuery(this),a)}))}))}),1500),new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("planner",(function(a){TECA.Content._.timerList=a,e[0].added.forEach((function(e){t.parseStory(jQuery(e),"old")})),e[1].attributeChanged["aria-label"].forEach((function(e){t.parseStory(jQuery(e).parents(".topHeader"),"old")})),e[2].added.forEach((function(e){t.parseStory(jQuery(e),"new")})),e[3].attributeChanged["aria-label"].forEach((function(e){t.parseStory(jQuery(e).parents(".taskDetailsContainer"),"new")}))}))},queries:[{element:".topHeader, .taskBoardCard, .ms-Dialog-main"},{element:".primarySection",elementAttributes:"aria-label"},{element:".task-board-card, .taskDetailsContainer"},{element:"[data-landmark]",elementAttributes:"aria-label"}]})},getOptFunctions:function(){return{onInit:function(){jQuery(".ms-Dialog-main").css("display","none"),jQuery(".ms-Dialog").css("display","none")},onDialogClose:function(){0==jQuery(".te-dialog.card-type").length&&(jQuery(".ms-Dialog-main").css("display","inherit"),jQuery(".ms-Dialog").css("display","flex"))}}},parseStory:function(e,t){var a=2==TECA._.modulesStyle.planner;"object"==typeof e&&0==jQuery(".te-module",e).length&&("old"===t?e.hasClass("ms-Dialog-main")?this.nativeModule.init(e,t):e.hasClass("taskBoardCard")&&(this.timerModule.init(e,t),a&&this.totalsModule.init(e,"task",t)):e.hasClass("task-board-card")?(this.timerModule.init(e,t),a&&this.totalsModule.init(e,"task",t)):e.hasClass("taskDetailsContainer")&&this.nativeModule.init(e,t))},getIntegrationData:function(e){var t,a={},i=e.data("te-integration-id");if(a.projectName=jQuery(".ms-Breadcrumb-listItem .ms-TooltipHost div").last().text(),"old"==e.data("te-mode"))"card"==e.data("te-btn-mode")?(a.text=e.parents(".topBar").find(".title").text(),n=e.parents(".taskCard").find(".labels"),a.tagNames=n.length?n[0].ariaLabel.split(", "):[],a.taskName=jQuery(".columnTitle > h3",e.parents(".taskBoardColumn")).text(),"#/userboard"===location.hash?(t=e.parents(".topBar").find(".planName")).length&&(a.projectName=t.text()):"tasks.teams.microsoft.com"===location.host?(t=jQuery(".planTitleSection .ms-Breadcrumb-listItem .ms-TooltipHost div").last()).length&&(a.projectName=t.text()):(t=jQuery(".primaryTextSectionTitle")).length&&(a.projectName=t.text())):(a.text=jQuery(".ms-Dialog-main .title .ms-TextField input").val(),a.tagNames=_.map(jQuery(".ms-Dialog-main .editableLabelWrapper"),(function(e){return jQuery(e).text()})),a.taskName=jQuery(".dropdowns .taskBucket .ms-Dropdown-title",e.parents(".taskEditor")).text(),"#/userboard"===location.hash||"tasks.teams.microsoft.com"===location.host?(t=jQuery(".ms-Dialog-main .planTitle")).length&&(a.projectName=t.text()):(t=jQuery(".primaryTextSectionTitle")).length&&(a.projectName=t.text()));else if("new"==e.data("te-mode"))if("card"==e.data("te-btn-mode")){a.text=e.parents(".topBar").find(".title").text();var n=e.parents(".task-card").find(".labels"),o=[];n.length&&jQuery(".labelTitle",n[0]).each((function(){o.push(jQuery(this).text())})),a.tagNames=o,a.taskName=jQuery(".column-title > h2",e.parents(".board-column")).text()}else{a.text=jQuery(".taskName .ms-TextField input").val();n=e.parents(".taskDetails").find(".labelPickerInner"),o=[];n.length&&jQuery(".editableLabelText",n[0]).each((function(){o.push(jQuery(this).text())})),a.tagNames=o,a.taskName=jQuery(".bucketFieldWithPriority .ms-Dropdown-container .ms-Dropdown-title",e.parents(".taskDetailsMainContent")).text()}else{if("card"==e.data("te-btn-mode")){a.text=e.parents(".topBar").find(".title").text();n=e.parents(".task-card").find(".labels"),o=[];n.length&&jQuery(".labelTitle",n[0]).each((function(){o.push(jQuery(this).text())})),a.taskName=jQuery(".column-title > h2",e.parents(".board-column")).text()}else{a.text=jQuery(".taskName .ms-TextField input").val();n=e.parents(".taskDetails").find(".labelPickerInner"),o=[];n.length&&jQuery(".editableLabelText",n[0]).each((function(){o.push(jQuery(this).text())})),a.tagNames=o,a.taskName=jQuery(".bucketFieldWithPriority .ms-Label",e.parents(".taskDetailsMainContent")).text()}a.projectName=jQuery("#topTitleText").text()}var r=location.pathname.split("/"),s="old"==e.data("te-mode")?r.indexOf("plan"):r.indexOf("premiumplan"),d=new URLSearchParams(location.hash.split("?")[1]).get("projectId");return a.projectId=s>=0?r[s+1]:d,a.id=i,a.url=location.origin+location.pathname,a.url.includes("planner.cloud.microsoft")&&!a.url.includes("task/")?(a.url+="/task/"+i,a.todoId="|"+i):(a.url+="#/taskboard?projectId="+a.projectId+"&taskId="+i,a.todoId=i+"|"),a}},TECA.Content.integrations.taskade={readable_name:"Taskade",name:"taskade",timerModule:{DEFAULT_LEFT_MARGIN:8,init:function(e){var t=e.data("nodeid"),a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="clickable te-module te-timer-module te-visible" data-te-source="taskade" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></div>');this.update(n),jQuery(".title >.content > div > span",e).after(n)},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),jQuery(".te-base-info",e).on("mouseenter",(function(){e.css("min-width",jQuery(this).outerWidth()+50)})).on("mouseleave",(function(){e.css("min-width","")})),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("taskade","task"),TECA.Timer.model.loadIntegrationTimerList("taskade",(function(e){TECA.Content._.timerList=e,jQuery(".node:not(.node-create, .root, .node-format-h1)").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("taskade",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){(e=jQuery(e)).hasClass("node-create")||e.hasClass("root")||t.parseTask(e)}))}))},queries:[{element:".node"}]})}),200)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=e.parents(".content");return t.text=_.trim(jQuery("div >span >span",i).text()),t.id=a,t}},TECA.Content.integrations.todoist={readable_name:"Todoist",name:"todoist",timerModule:{DEFAULT_LEFT_MARGIN:8,init:function(e){var t=this,a=e.data("item-id"),i=TECA.Content.checkTimers(a),n=i?i.timerId:-1,o=jQuery('<div class="clickable te-module te-timer-module te-visible" data-te-source="todoist" data-te-integration-id="'+a+'" data-te-timer-id="'+n+'"></div>');t.update(o),jQuery(".task_list_item__actions",e).prepend(o),o.css("min-width",jQuery(".te-button",o).outerWidth()),o.css("left",-jQuery(".te-button",o).outerWidth()+t.DEFAULT_LEFT_MARGIN),o.on("mouseenter",(function(){o.css("left",-jQuery(".te-button",o).outerWidth()+t.DEFAULT_LEFT_MARGIN)})).on("mouseleave",(function(){o.css("left",-jQuery(".te-button",o).outerWidth()+t.DEFAULT_LEFT_MARGIN)}))},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("todoist","task"),TECA.Timer.model.loadIntegrationTimerList("todoist",(function(e){TECA.Content._.timerList=e,jQuery(".task_list_item").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("todoist",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:".task_list_item"}]})}),200)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=e.parents(".task_list_item");return t.text=_.trim(jQuery(".task_list_item__body > .task_list_item__content .task_content",i).text()),t.id=a,t.url="https://todoist.com/#task%2F"+a,t}},TECA.Content.integrations.trello={readable_name:"Trello",name:"trello",nativeModule:{init:function(e){var t=TECA.Content.integrations.trello,a=jQuery("div > div > div:nth(1) > div:first > section:nth-child(3)",e),i=jQuery('[data-testid="attachment-list"]'),n=window.location.pathname.substring(3).split("/")[0],o=TECA.Content.checkTimers(n),r=o?o.timerId:-1,s=jQuery('<div class="te-module te-native-module" data-te-source="trello" data-te-timer-id="'+r+'" data-te-integration-id="'+n+'" data-te-estimates="true"></div>');s.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",s).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"trello"},t.getIntegrationData(s)),"registerTime"),!1})),i.length>0?i.after(s):a.before(s),this.update(s)},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),TECA.Timer.model.loadIntegrationTimerList("trello",(function(e){TECA.Content._.timerList=e,jQuery("#layer-manager-card-back").each((function(){t.parseCard(jQuery(this))}))})),new MutationSummary({callback:function(e){setTimeout((function(){TECA.Timer.model.loadIntegrationTimerList("trello",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseCard(jQuery(e))}))}))}),1e3)},queries:[{element:'#layer-manager-card-back,div[data-testid="card-back-name"]'}]})},parseCard:function(e){"object"==typeof e&&0===jQuery(".te-module",e).length&&this.nativeModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id"),i=jQuery("#layer-manager-card-back > div > div > div > div > div"),n=jQuery('[data-testid="attachment-list"]'),o=jQuery("#content > div > div > div.board-main-content > div.board-header.u-clearfix.js-board-header > div > span:first > div:first > h1").text(),r=jQuery("#layer-manager-card-back > div > div > div > div > div >"+(0===n.length?" div:first":" div:nth(1)")+" > section > div:nth(1) > p > button > span > span").text();return t.text=jQuery("#layer-manager-card-back > div > div > div > div > div >"+(0===n.length?" div:first":" div:nth(1)")+" > section > hgroup > textarea").text(),1==TECA._.serviceSettings.trello?(t.projectName=o,t.taskName="",jQuery(".card-detail-item-labels",i).length>0&&jQuery(".card-detail-item-labels .js-card-detail-labels-list > span.card-label",i).each((function(){t.taskName+=" "+jQuery(this).text()}))):2==TECA._.serviceSettings.trello?(t.projectName=o,t.taskName=r):(t.projectName=r,t.taskName="",jQuery((0===n.length?" div:nth(1)":" div:nth(2)")+" > div:first > div:first > section:nth-child(2) > div",i).length>0&&jQuery((0===n.length?" div:nth(1)":" div:nth(2)")+' > div:first > div:first > section:nth-child(2) > div > span[data-testid="card-label"]',i).each((function(){t.taskName+=" "+jQuery(this).text()}))),t.id=a,t.url=window.location.href,t}},TECA.Content.integrations.wunderlist={readable_name:"Wunderlist",name:"wunderlist",timerModule:{init:function(e){var t=e.attr("rel"),a=TECA.Content.checkTimers(t),i=a?a.timerId:-1,n=jQuery('<div class="button-link js-toggle-timer te-module te-timer-module te-visible" data-te-source="wunderlist" data-te-integration-id="'+t+'" data-te-timer-id="'+i+'"></div>');this.update(n),jQuery("> .taskItem-body > .taskItem-titleWrapper",e).before(n),n.css("min-width",jQuery(".te-button",n).outerWidth())},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.setTimerModuleActions(e),TECA.Content.checkModuleTimerInfo(e,!0),TECA.Content.checkRunningInterval(e),e.css("min-width",jQuery(".te-base-info",e).outerWidth())}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Content.initMoreInfo("wunderlist","task"),TECA.Timer.model.loadIntegrationTimerList("wunderlist",(function(e){TECA.Content._.timerList=e,jQuery("li.taskItem").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("wunderlist",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(e))}))}))},queries:[{element:"li.taskItem"}]})}),200),setTimeout((function(){TECA.Gui.addStyle(!0)}),5e3)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.timerModule.init(e)},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return jQuery("#lists .lists-scroll .lists-collection > li.active").length>0&&(t.projectName=jQuery("#lists .lists-scroll .lists-collection > li.active > a > .title").text()),t.text=e.parents(".taskItem-body").find(".taskItem-titleWrapper > .taskItem-titleWrapper-title").text(),t.id=a,t.url="https://www.wunderlist.com/#/tasks/"+a,t}},TECA.Content.integrations.zendesk={readable_name:"Zendesk support",name:"zendesk",timerModule:{init:function(e){if("object"==typeof e&&!e.hasClass("add")&&0===jQuery(".te-module",e).length){e.addClass("timeneye-zendesk-gotcha");TECA.Content.integrations.zendesk;var t=e.attr("id").replace("ember",""),a=jQuery(".tab-content-holder > .tab_text > .subtitle",e),i=Number(a.text().split("#")[1]),n=TECA.Content.checkTimers(i),o=n?n.timerId:-1,r=jQuery('<div class="te-module te-timer-module'+(n?" te-visible":"")+'" data-te-source="zendesk" data-te-timer-id="'+o+'" data-te-integration-id="'+i+'" data-te-ember-id="'+t+'"></div>');this.update(r),a.append(r)}},update:function(e){TECA.Content.setTimerModuleContent(e),TECA.Content.checkModuleTimerInfo(e,!1),TECA.Content.checkRunningInterval(e)}},nativeModule:{init:function(e){if("object"==typeof e&&0===jQuery(".te-module",e).length){var t=TECA.Content.integrations.zendesk,a=jQuery(".sidebar_box_container > .ticket_properties",e),i=e.parents(".ember-view.workspace").attr("id").replace("ember",""),n=t.getCurrentTicketId(),o=TECA.Content.checkTimers(n),r=o?o.timerId:-1,s=jQuery('<div class="property_box"></div>'),d=jQuery('<div class="te-module te-native-module" data-te-source="zendesk" data-te-ember-id="'+i+'" data-te-timer-id="'+r+'" data-te-integration-id="'+n+'" data-te-estimates="true"></div>');d.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!0,entityId:i,estimates:!0})),"none"!=e.parents(".ember-view.workspace").css("display")&&(jQuery(".te-native-new-entity",d).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"zendesk"},t.getIntegrationData(d)),"registerTime"),!1})),s.html(d),a.before(s),this.update(d))}},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t,a,i=this;setTimeout((function(){TECA.Content._.activeTimer=null,"number"==typeof(a=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(a)),TECA.Timer.model.loadIntegrationTimerList("zendesk",(function(e){TECA.Content._.timerList=e,jQuery("li.tab").each((function(){i.timerModule.init(jQuery(this)),jQuery(this).unbind("click").on("click",(function(){i.processTickets()}))})),i.processTickets(e)}));new MutationSummary({callback:function(a){TECA.Timer.model.loadIntegrationTimerList("zendesk",(function(n){TECA.Content._.timerList=n,(a=a[0]).added.forEach((function(a){(e=jQuery(a)).hasClass("tab")?(i.timerModule.init(e),e.unbind("click").on("click",(function(){i.processTickets()})),i.processTickets(n)):"none"!=(t=e.parents(".ember-view.workspace").css("display"))&&"block"!=t||(e.hasClass("timeneye-zendesk-gotcha")&&e.removeClass("timeneye-zendesk-gotcha"),i.nativeModule.init(e))}))}))},queries:[{element:".ticket-sidebar.left, li.tab"}]})}),3e3)},processTickets:function(e){var t,a=this,i=function(e){jQuery(".ticket-sidebar.left").each((function(){t=jQuery(this),jQuery(".te-module",t).parent().remove(),t.hasClass("timeneye-zendesk-gotcha")&&t.removeClass("timeneye-zendesk-gotcha"),a.nativeModule.init(t)}))};null!=typeof e&&Array.isArray(e)?i():TECA.Timer.model.loadIntegrationTimerList("zendesk",(function(e){TECA.Content._.timerList=e,i()}))},getCurrentTicketId:function(){return parseInt(window.location.pathname.substring(1).split("/")[2])},getIntegrationData:function(e){var t={},a=e.parents("section.ticket"),i=this.getCurrentTicketId(),n=TECA._.serviceSettings.zendesk.project.trim(),o=TECA._.serviceSettings.zendesk.task.trim();return t.text="#"+i,t.text+=" "+jQuery('.ember-view.ticket .header input[data-test-id="ticket-pane-subject"]',a).val(),""!=n&&(t.projectName=n),""!=o&&(t.taskName=o),t.url=window.location.href,t.id=i,t}},TECA.Content.integrations.zenkit={readable_name:"Zenkit",name:"zenkit",nativeModule:{init:function(e){if("object"==typeof e&&0===jQuery(".te-module",e).length){var t=TECA.Content.integrations.zenkit,a=t.getCurrentEntryId(),i=TECA.Content.checkTimers(a),n=i?i.timerId:-1,o=jQuery('<div class="te-module te-native-module" data-te-source="zenkit" data-te-timer-id="'+n+'" data-te-integration-id="'+a+'" data-te-estimates="true"></div>');o.html(TECA.Gui.jhtml("integrationModule/nativeModule_body",{logoUrl:chrome.extension.getURL("images/logo_white_horiz_xs.svg"),notUnique:!1,estimates:!0})),jQuery(".te-native-new-entity",o).on("click",(function(){return TECA.Content.openDialog(jQuery.extend({integration:"zenkit"},t.getIntegrationData(o)),"registerTime"),!1})),e.after(o),this.update(o)}},update:function(e){TECA.Content.setNativeModuleContent(e),TECA.Content.setNativeModuleRecapSections(e),TECA.Content.checkRunningInterval(e)}},getTheShDone:function(){var e,t=this;TECA.Content._.activeTimer=null,"number"==typeof(e=localStorage.getItem("activeModules"))&&(localStorage.removeItem("activeModules"),clearInterval(e)),setTimeout((function(){TECA.Timer.model.loadIntegrationTimerList("zenkit",(function(e){TECA.Content._.timerList=e,jQuery("zenkit-ui-dialog .zenkit-ui-dialog__content > .zenkit-entry-detail-popup-inner .zenkit-entry-detail__list").each((function(){t.parseTask(jQuery(this))}))}));new MutationSummary({callback:function(e){TECA.Timer.model.loadIntegrationTimerList("zenkit",(function(a){TECA.Content._.timerList=a,(e=e[0]).added.forEach((function(e){t.parseTask(jQuery(".zenkit-ui-dialog__content > .zenkit-entry-detail-popup-inner .zenkit-entry-detail__list",jQuery(e)))}))}))},queries:[{element:".zenkit-ui-dialog"}]})}),200),setTimeout((function(){TECA.Gui.addStyle(!0)}),5e3)},parseTask:function(e){"object"==typeof e&&0==jQuery(".te-module",e).length&&this.nativeModule.init(e)},getCurrentEntryId:function(){var e=window.location.pathname.substring(1).split("/");return e.splice(2,1),e.join("/")},getIntegrationData:function(e){var t={},a=e.data("te-integration-id");return t.text=e.parents(".zenkit-entry-detail-popup-inner").find(".zenkit-entry-detail__list > .zenkit-entry-primary-element-container zenkit-ui-list-row-title").text(),t.id=a,t.url="https://zenkit.com/"+a,t}};
//# sourceMappingURL=content.js.map