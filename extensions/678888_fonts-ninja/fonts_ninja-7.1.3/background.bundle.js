(()=>{"use strict";const e="toggle_fonts_ninja";var n=function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,a)}c((r=r.apply(e,n||[])).next())}))};chrome.action.onClicked.addListener((n=>{var t,r;(null===(t=n.url)||void 0===t?void 0:t.includes("chrome://"))||chrome.tabs.sendMessage(null!==(r=n.id)&&void 0!==r?r:-1,{message:e},(t=>{t||setTimeout((()=>{var t;chrome.tabs.sendMessage(null!==(t=n.id)&&void 0!==t?t:-1,{message:e})}),300)}))})),chrome.runtime.onInstalled.addListener((({reason:e})=>{e===chrome.runtime.OnInstalledReason.INSTALL&&(chrome.tabs.create({url:"https://fonts.ninja/overview",active:!0}),chrome.runtime.setUninstallURL("https://fontsninja.typeform.com/to/cHr9TWwD"))})),chrome.runtime.onMessage.addListener(((e,n,r)=>{if("change_fonts_ninja_icon"===e.message){const n=e.options.iconIndex;return t(n),!0}})),chrome.webNavigation.onHistoryStateUpdated.addListener((e=>{var n;e&&e.tabId&&e.url&&chrome.tabs.sendMessage(null!==(n=e.tabId)&&void 0!==n?n:-1,{message:"change_url",url:e.url},(e=>{!e&&chrome.runtime.lastError}))}));const t=e=>{const n=chrome.runtime.getURL(`icons/icon-${e}.png`);chrome.action.setIcon({path:n})};chrome.runtime.onMessage.addListener(((e,t,r)=>{if("ping"===e.type)r({type:"pong"});else if("safeFetch"===e.type)return function({url:e,returnBase64:t,options:r,pageUrl:o}){return n(this,void 0,void 0,(function*(){const n=yield fetch(e,r);if(n.ok){if(t){const e=yield n.arrayBuffer();return btoa(new Uint8Array(e).reduce((function(e,n){return e+String.fromCharCode(n)}),""))}return yield n.text()}throw new Error("failed")}))}(e).then((e=>r({type:"safeFetchResults",results:e}))).catch((e=>r({type:"safeFetchResults",error:e}))),!0}))})();
//# sourceMappingURL=background.bundle.js.map