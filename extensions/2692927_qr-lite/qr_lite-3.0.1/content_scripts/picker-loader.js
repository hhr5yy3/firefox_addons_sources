(()=>{"use strict";const t=browser;void 0===window.picker?(window.picker=new class{constructor(){this.identifier=null,this.pickerPort=null}applyCss(e){const n="background: transparent\nborder: 0\nborder-radius: 0\nbox-shadow: none\ncolor-scheme: light dark\ndisplay: block\nfilter: none\nheight: 100vh\nheight: 100svh\nleft: 0\nmargin: 0\nmax-height: none\nmax-width: none\nmin-height: unset\nmin-width: unset\nopacity: 1\noutline: 0\npadding: 0\npointer-events: auto\nposition: fixed\ntop: 0\ntransform: none\nvisibility: hidden\nwidth: 100%\nz-index: 2147483647\n".replaceAll("\n"," !important;\n"),i=`\n:root > [${this.identifier}] {\n    ${n}\n}\n:root > [${this.identifier}-loaded] {\n    visibility: visible !important;\n}\n`;return t.runtime.sendMessage({action:"BG_APPLY_CSS",add:e?"":i,remove:e?i:""})}handleMessage(t){switch(t.action){case"PICKER_CLOSE":this.unload();break;case"PICKER_COPY_TEXT":navigator.clipboard.writeText(t.text).then((()=>{this.pickerPort&&this.pickerPort.postMessage({action:"PICKER_COPY_TEXT_OK"})})).catch((t=>{this.pickerPort&&this.pickerPort.postMessage({action:"PICKER_COPY_TEXT_ERROR"})}))}}async load(){this.identifier=function(){let t="";const e="a".charCodeAt(0),n="z".charCodeAt(0);for(let i=0;i<10;i++)t+=String.fromCharCode(e+Math.floor(Math.random()*(n-e+1)));return t}();const e=this.applyCss(),n=await t.runtime.sendMessage({action:"BG_GET_PICKER_URL"});await e;const i=document.createElement("iframe");i.setAttribute(this.identifier,""),i.setAttribute("allow","clipboard-write"),document.documentElement.append(i),i.addEventListener("load",(()=>{i.setAttribute(`${this.identifier}-loaded`,"");const t=new MessageChannel;this.pickerPort=t.port1,this.pickerPort.onmessage=t=>{this.handleMessage(t.data||{})},this.pickerPort.onmessageerror=()=>{this.unload()},i.contentWindow.postMessage({action:"PICKER_SHOW",scroll:{left:document.documentElement.scrollLeft,top:document.documentElement.scrollTop}},n,[t.port2]),i.contentWindow.focus()})),i.contentWindow.location=n}unload(){var t;(t=`iframe[${this.identifier}]`,document.querySelector(t))?.remove(),this.applyCss(!0)}},window.picker.load()):(window.picker.unload(),window.picker.load())})();