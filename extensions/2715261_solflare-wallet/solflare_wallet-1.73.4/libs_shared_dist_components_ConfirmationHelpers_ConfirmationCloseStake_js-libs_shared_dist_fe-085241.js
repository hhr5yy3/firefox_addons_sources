"use strict";(self.webpackChunk_solflare_extension=self.webpackChunk_solflare_extension||[]).push([["libs_shared_dist_components_ConfirmationHelpers_ConfirmationCloseStake_js-libs_shared_dist_fe-085241"],{"../../libs/shared/dist/components/ConfirmationHelpers/ConfirmationCloseStake.js":(s,e,t)=>{t.d(e,{Z:()=>o});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/@fortawesome/pro-light-svg-icons/index.mjs"),a=t("../../libs/foundation-ui/dist/index.js");const o=({validatorName:s,validatorImage:e,stakeStatus:t})=>(0,i.jsx)(a.ConfirmTransaction,{avatar:(0,i.jsx)(a.IconAvatar,{size:"xl",icon:n.I7k}),transactionFromItem:(0,i.jsx)(a.TXListItem,{title:s,subtitle:t,avatar:(0,i.jsx)(a.ValidatorAvatar,{src:e})})})},"../../libs/shared/dist/components/ConfirmationHelpers/ConfirmationUnstaking.js":(s,e,t)=>{t.d(e,{Z:()=>l});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/@fortawesome/pro-light-svg-icons/index.mjs"),a=t("../../libs/foundation-ui/dist/index.js"),o=t("../../libs/shared/dist/constants/mints.js"),r=t("../../libs/shared/dist/features/currencies/hooks/index.js"),d=t("../../libs/shared/dist/utils/displayPrice.js"),u=t("../../libs/shared/dist/components/TokenAvatar/index.js");const l=({amount:s})=>{const{value:e,suffix:t,prefix:l,price:c}=(0,r.yF)("SOL",s);return(0,i.jsx)(a.ConfirmTransaction,{avatar:(0,i.jsx)(a.IconAvatar,{size:"xl",icon:n.Quw}),transactionFromItem:(0,i.jsx)(a.TXListItem,{title:(0,d.ED)({amount:s,displayType:"solana",suffix:" SOL"}),subtitle:c?(0,d.ED)({amount:e,displayType:"value",suffix:t,prefix:l}):void 0,avatar:(0,i.jsx)(u.y,{src:o.vx.logoURI,verified:!0})})})}},"../../libs/shared/dist/features/staking/shared/InstantUnstakeSpeedupBanner.js":(s,e,t)=>{t.d(e,{v:()=>_});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react/index.js"),a=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),o=t("../../../node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),r=t("../../../node_modules/bignumber.js/bignumber.mjs"),d=t("../../libs/foundation-ui/dist/index.js"),u=t("../../libs/shared/dist/components/ConfirmationHelpers/ConfirmationUnstaking.js"),l=t("../../libs/shared/dist/hooks/useSolanaBalance/index.js"),c=t("../../libs/shared/dist/utils/lamportToSol.js"),m=t("../../libs/shared/dist/features/currencies/hooks/index.js"),f=t("../../libs/shared/dist/features/featureFlags/index.js"),k=t("../../libs/shared/dist/features/globalConfig/hooks/index.js"),h=t("../../libs/shared/dist/features/portfolio/queries/index.js"),b=t("../../libs/shared/dist/features/stakingCore/api/transactions.js"),j=t("../../libs/shared/dist/features/stakingCore/hooks/useInstantUnstakeQuote.js"),g=t("../../libs/shared/dist/features/transactionFlow/context/index.js");const _=({stakeAccount:s,onConfirm:e})=>{const{t}=(0,a.$)(),[_,x]=(0,n.useState)(!1),p=(0,o.NL)(),{transactionInit:v}=(0,g.p)(),{lamports:y}=(0,l.h)(),{computeUnitPrice:w}=(0,h.NT)(),C=new r.Z(2e5).times(w).div(Math.pow(10,6)).plus(5e3).toNumber(),S=(0,m.Af)(),I=(0,k.LN)(),{data:P,isFetching:A,isSuccess:T}=(0,j.J)({stakeAccountPubkey:s.publicKey,network:I.cluster,currency:S.ticker,enabled:!_});return(0,i.jsx)(d.InstantUnstakeBanner,{title:t("staking_instant_unstake_banner_title"),subtitle:t("staking_instant_unstake_banner_subtitle",{fee:new r.Z(P?.fee?.percentage??0).times(100).toString()}),buttonTitle:t("staking_instant_unstake_banner_cta"),isLoading:_||A||!T||y<C,onClick:async()=>{if(!P)return;const n=(0,c.s)(P.outAmount??0),a=(0,c.s)(P.inAmount??0);x(!0),await v({title:t("staking_instant_unstake_title"),commitment:"confirmed",txBuilder:b.l,builderParams:{stakeAccount:s.publicKey,outAmount:P.outAmount,route:P.routeName,network:I.cluster},ffLogFunction:f.Ic,ffParams:{validatorName:s.validator?.name??"",validatorNodePubKey:s.validator?.nodePublicKey??"",validatorVotePubKey:s.validator?.votePublicKey??"",source:"stakeAccountDeactivating",market:P.routeName,amountInSol:a.toString(),amountInUsd:a.times(P.solPrice.usd).toString(),feeTotalPercentage:P.fee.percentage,solflareFeeAmountInSol:(0,c.s)(P.ourFee?.amount??0).toString(),solflareFeeAmountInUsd:(0,c.s)(P.ourFee?.amount??0).times(P.solPrice.usd).toString()},confirmDialog:(0,i.jsx)(u.Z,{amount:n.toString()}),onConfirm:({status:s})=>{"success"===s&&(e?.(),p.invalidateQueries(["staking-accounts"]))},onEnd:()=>{x(!1)}})}})}},"../../libs/shared/dist/features/staking/web/ExplorerDropDownItem.js":(s,e,t)=>{t.d(e,{x:()=>r});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../libs/rise-ui/dist/index.js"),o=t("../../libs/shared/dist/hooks/index.js");const r=({publicKey:s,onClose:e})=>{const{t}=(0,n.$)(),{openExplorer:r}=(0,o.Vf)();return(0,i.jsx)(a.bK,{onClick:()=>{r({type:"account",address:s}),e()},children:t("action_view_in_explorer")})}},"../../libs/shared/dist/features/stakingCore/api/transactions.js":(s,e,t)=>{t.d(e,{B:()=>d,l:()=>u});var i=t("../../libs/shared/dist/api/index.js"),n=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),a=t("../../../node_modules/base64-js/index.js"),o=t("../../../node_modules/console-browserify/index.js");const r="https://wallet-api.solflare.com",d=async(s,e,t)=>{const{body:n}=await(0,i.v_)(`${r}/v2/unstake/quote`,{stakeAccount:s,network:e,currency:t});return n},u=async s=>{try{const{body:e}=await(0,i.v_)(`${r}/v2/unstake/tx`,s);if(e?.error)throw new Error(e.error);if(!e?.txs?.length)throw new Error("Failed to generate transaction");return{transaction:n.VersionedTransaction.deserialize(a.toByteArray(e.txs[0]))}}catch(s){throw o.dir(s),new Error(s?.response?.data?.error||s?.message)}}},"../../libs/shared/dist/features/stakingCore/hooks/useInstantUnstakeQuote.js":(s,e,t)=>{t.d(e,{J:()=>a});var i=t("../../../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),n=t("../../libs/shared/dist/features/stakingCore/api/transactions.js");const a=({stakeAccountPubkey:s,network:e,currency:t,enabled:a=!0})=>(0,i.a)({queryKey:["unstakeTx",s],queryFn:()=>(0,n.B)(s,e,t),enabled:a,refetchInterval:2e4,cacheTime:0,retry:!1})},"../../libs/shared/dist/features/stakingModal/hooks/useUnstakeForm.js":(s,e,t)=>{t.d(e,{K:()=>p});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react/index.js"),a=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),o=t("../../../node_modules/react-router/dist/index.js"),r=t("../../../node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),d=t("../../libs/shared/dist/components/ConfirmationHelpers/ConfirmationUnstaking.js"),u=t("../../libs/shared/dist/constants/routes.js"),l=t("../../libs/shared/dist/hooks/useSolanaBalance/index.js"),c=t("../../libs/shared/dist/utils/extension.js"),m=t("../../libs/shared/dist/utils/lamportToSol.js"),f=t("../../libs/shared/dist/features/currencies/hooks/index.js"),k=t("../../libs/shared/dist/features/featureFlags/index.js"),h=t("../../libs/shared/dist/features/globalConfig/hooks/index.js"),b=t("../../libs/shared/dist/features/staking/api/staking.js"),j=t("../../libs/shared/dist/features/stakingCore/api/transactions.js"),g=t("../../libs/shared/dist/features/stakingCore/hooks/useInstantUnstakeQuote.js"),_=t("../../libs/shared/dist/features/transactionFlow/context/index.js"),x=t("../../libs/shared/dist/features/walletData/hooks/index.js");const p=({stakeAccount:s,close:e})=>{const{t}=(0,a.$)(),p=(0,o.s0)(),{usdPrice:v}=(0,l.h)(),[y,w]=(0,n.useState)(!1),[C,S]=(0,n.useState)(!1),{transactionInit:I}=(0,_.p)(),{publicKey:P}=(0,x.rT)(),A=(0,r.NL)(),T=(0,f.Af)(),L=(0,h.LN)(),{data:F,isFetching:K,isSuccess:U,isError:N}=(0,g.J)({stakeAccountPubkey:s.publicKey,network:L.cluster,currency:T.ticker,enabled:y&&!C});(0,n.useEffect)((()=>{y&&!K&&N&&w(!1)}),[y,N,K]);const E=async()=>{const n=(0,m.s)(s.amount??0);S(!0),await I({title:t("unstaking"),commitment:"confirmed",txBuilder:b.vg,builderParams:{address:P,stakeAccount:s.publicKey,setComputeBudget:!0,network:L.cluster},ffLogFunction:k.Iz,ffParams:{validatorName:s.validator?.name??"",validatorNodePubKey:s.validator?.nodePublicKey??"",validatorVotePubKey:s.validator?.votePublicKey??"",amountInSol:n.toString(),amountInUsd:n.times(v).toString()},confirmDialog:(0,i.jsx)(d.Z,{amount:n.toString()}),onBroadcast:({status:s})=>{"success"===s&&e?.()},onConfirm:({status:s})=>{"success"===s&&A.invalidateQueries(["staking-accounts"])},onEnd:()=>{S(!1)}})};return{instantChecked:y,setInstantChecked:w,unstake:async()=>y?(async()=>{if(!F)return;const n=(0,m.s)(F.outAmount??0),a=(0,m.s)(F.inAmount??0);S(!0),await I({title:t("staking_instant_unstake_title"),commitment:"confirmed",txBuilder:j.l,builderParams:{stakeAccount:s.publicKey,outAmount:F.outAmount,route:F.routeName,network:L.cluster},ffLogFunction:k.Ic,ffParams:{validatorName:s.validator?.name??"",validatorNodePubKey:s.validator?.nodePublicKey??"",validatorVotePubKey:s.validator?.votePublicKey??"",source:"stakeAccountActive",market:F.routeName,amountInSol:a.toString(),amountInUsd:a.times(F.solPrice.usd).toString(),feeTotalPercentage:F.fee.percentage,solflareFeeAmountInSol:(0,m.s)(F.ourFee?.amount??0).toString(),solflareFeeAmountInUsd:(0,m.s)(F.ourFee?.amount??0).times(F.solPrice.usd).toString()},confirmDialog:(0,i.jsx)(d.Z,{amount:n.toString()}),onBroadcast:({status:s})=>{"success"===s&&(e?.(),c.UJ&&p(u.xm))},onConfirm:({status:s})=>{"success"===s&&A.invalidateQueries(["staking-accounts"])},onEnd:()=>{S(!1)}})})():E(),standardUnstake:E,unstakeTx:F,isFetching:K,isSuccess:U,isLoading:C}}},"../../libs/shared/dist/features/stakingModal/shared/UnstakeModal.js":(s,e,t)=>{t.d(e,{K:()=>_});var i=t("../../../node_modules/react/jsx-runtime.js"),n=t("../../../node_modules/react-i18next/dist/es/useTranslation.js"),a=t("../../../node_modules/bignumber.js/bignumber.mjs"),o=t("../../libs/foundation-ui/dist/index.js"),r=t("../../libs/shared/dist/modals/index.js"),d=t("../../libs/shared/dist/utils/displayPrice.js"),u=t("../../libs/shared/dist/utils/lamportToSol.js"),l=t("../../libs/shared/dist/utils/timeRemaining.js"),c=t("../../libs/shared/dist/features/currencies/components/index.js"),m=t("../../libs/shared/dist/features/portfolio/hooks/index.js"),f=t("../../libs/shared/dist/features/stakingCore/index.js"),k=t("../../libs/shared/dist/features/stakingModal/hooks/useUnstakeForm.js"),h=t("../../../node_modules/react/index.js"),b=t("../../../node_modules/@solana/web3.js/lib/index.browser.esm.js"),j=t("../../libs/shared/dist/hooks/useSolanaBalance/index.js"),g=t("../../libs/shared/dist/features/portfolio/queries/index.js");const _=({stakeAccount:s,close:e})=>{const{t}=(0,n.$)(),{data:_}=(0,m.Dm)(),{data:x}=(0,f.ku)(),{instantChecked:p,setInstantChecked:v,unstake:y,unstakeTx:w,isFetching:C,isSuccess:S,isLoading:I}=(0,k.K)({stakeAccount:s,close:e}),{isLoading:P,alertProps:A}=(()=>{const{t:s}=(0,n.$)(),{isLoading:e,lamports:t}=(0,j.h)(),{computeUnitPrice:i}=(0,g.NT)(),o=(0,h.useMemo)((()=>{if(e)return;const n=new a.Z(2e5).times(i).div(Math.pow(10,6)).plus(5e3);return t<n.toNumber()?{variant:"error",title:s("insufficient_ticker",{ticker:"SOL"}),message:s("swap_alert_ensure_minimum",{amountWithSuffix:`${n.div(b.LAMPORTS_PER_SOL)} SOL`})}:void 0}),[i,e,t,s]);return{isLoading:e,alertProps:o}})(),T=(0,u.s)(s.amount??0),L=(0,l.X)(x?.header.epochEndSeconds??0);return x?(0,i.jsx)(r.V,{onClose:e,title:t("staking_unstake_title"),textAlign:"left",footer:(0,i.jsxs)(i.Fragment,{children:[A&&(0,i.jsx)(o.Alert,{...A}),(0,i.jsx)(o.Button,{disabled:p&&(C||!S)||I||P||!!A,onClick:()=>{y()},children:t("action_review")})]}),children:(0,i.jsxs)(o.InstantUnstakeContent,{children:[(0,i.jsx)(o.ValidatorContainer,{title:t("staking_native_validator"),name:s.validator?.name??"",image:s.validator?.image??void 0,amount:(0,d.ED)({amount:T.toString(),displayType:"amount",pricePerCoin:_?.solPrice?.price,suffix:" SOL"}),value:(0,i.jsx)(c.sp,{value:T.multipliedBy(_?.price?.price??0).toNumber()})}),(0,i.jsx)(o.UnstakingContainer,{title:t("staking_instant_unstake_toggle_title"),subtitle:t("staking_instant_unstake_toggle_subtitle"),toggle:(0,i.jsx)(o.Toggle,{checked:p,onCheckedChange:v}),children:(0,i.jsxs)(o.InfoContainerList,{children:[(0,i.jsx)(o.InfoRow,{left:(0,i.jsxs)(o.InfoRowLeft,{children:[t("staking_unstake_time_label"),(0,i.jsx)(o.InfoWithTooltip,{tooltip:t("staking_instant_unstake_time_tooltip")})]}),right:(0,i.jsx)(o.InfoRowRight,{children:p?t("staking_instant_unstake_time_instant"):L})}),p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.InfoRow,{left:(0,i.jsxs)(o.InfoRowLeft,{children:[t("staking_instant_unstake_fee"),(0,i.jsx)(o.InfoWithTooltip,{tooltip:t("staking_instant_unstake_fee_tooltip")})]}),right:(0,i.jsxs)(o.InfoRowRight,{isLoading:C||!S,children:[new a.Z(w?.fee?.percentage??0).times(100).toString(),"%"]})}),(0,i.jsx)(o.InfoRow,{left:(0,i.jsxs)(o.InfoRowLeft,{children:[t("staking_unstake_total_received"),(0,i.jsx)(o.InfoWithTooltip,{tooltip:t("staking_unstake_tike_tooltip")})]}),right:(0,i.jsx)(o.InfoRowRight,{isLoading:C||!S,children:(0,d.ED)({amount:(0,u.s)(w?.outAmount??0),displayType:"solana",suffix:" SOL"})})})]})]})})]})}):null}},"../../libs/shared/dist/features/stakingModal/utils/splitStakeErrors.js":(s,e,t)=>{t.d(e,{M:()=>n});var i=t("../../libs/shared/dist/features/stakingCore/constants.js");const n=(s,e,t,n)=>{if(void 0!==s)return s.isLessThan(e)?{title:n("staking_validation_amount_below_minimum_title"),message:n("staking_validation_split_amount_below_minimum_description",{amount:`${i.T} SOL`})}:s.isGreaterThan(t)?{title:n("action_insufficient_balance"),message:n("staking_validation_insufficient_balance_description")}:void 0}},"../../libs/shared/dist/utils/timeRemaining.js":(s,e,t)=>{t.d(e,{X:()=>a});var i=t("../../../node_modules/dayjs/dayjs.min.js"),n=t.n(i);const a=(s,e=3)=>{const t=n().duration(s>=0?s:0,"seconds"),i=[];return t.years()>0&&i.push(`${t.years()}yr`),t.months()>0&&i.push(`${t.months()}mo`),t.days()>0&&i.push(`${t.days()}d`),t.hours()>0&&i.push(`${t.hours()}h`),t.minutes()>0&&i.push(`${t.minutes()}m`),t.seconds()>0&&i.push(`${t.seconds()}s`),0===i.length&&i.push("0s"),i.slice(0,e).join(" ")}}}]);