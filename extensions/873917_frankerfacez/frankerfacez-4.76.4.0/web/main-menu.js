(()=>{var je=Object.defineProperty;var $=(q,T)=>je(q,"name",{value:T,configurable:!0});(globalThis.ffzWebpackJsonp=globalThis.ffzWebpackJsonp||[]).push([[2086,2682],{49276:(q,T,f)=>{"use strict";f.d(T,{D3:()=>v,Dk:()=>o,Vf:()=>d,ZP:()=>w,aA:()=>r,of:()=>n});var N=f(22527),y=f(24431),_=f(46949);if(/^8(102|363)$/.test(f.j))var E=f(83269);var A=f(5199),b=f.n(A);const v=/^8(102|363)$/.test(f.j)?["component"]:null,r={"smileys-emotion":"Smileys & Emotions","people-body":"People",component:"Components","animals-nature":"Animals & Nature","food-drink":"Food & Drink","travel-places":"Travel & Places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"},n=Object.keys(r),s={1:"1f3fb",2:"1f3fc",3:"1f3fd",4:"1f3fe",5:"1f3ff"};let i=!0,e;try{e=new RegExp("(?<!\\u{E0002})\\u{E0002}","gu")}catch{i=!1,e=null}const o=/^8(102|363)$/.test(f.j)?e:null,a=/\u{200D}/gu,c="\u{E0002}",d={google:"noto",twitter:"twemoji",open:"openmoji",blob:"blob"};function m(z){let R=typeof z=="number"?z:parseInt(z,16);return R<65536?String.fromCharCode(R):(R-=65536,String.fromCharCode(55296+(R>>10),56320+(R&1023)))}$(m,"codepoint_to_emoji");const p=class p extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...R){super(...R),this.inject("..emotes"),this.inject("settings"),i?this.settings.add("chat.emoji.replace-joiner",{default:1,process(I,j){return j===2?1:j},ui:{path:"Chat > Behavior >> Emoji",title:"Emoji Joiner Workaround",description:"This feature is intended to allow the use of combined emoji in supported clients. This is required due to a bug in TMI that strips ZWJ characters from chat messages. [Visit the original issue](https://github.com/FrankerFaceZ/FrankerFaceZ/issues/1147) for more details.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Display Only"},{value:3,title:"Display and Send"}]}}):(this.log.warn('This browser does not support regexp lookbehind. The "Emoji Joiner Workaround" feature will be disabled.'),this.settings.add("chat.emoji.replace-joiner",{process(){return 0}})),this.settings.add("chat.emoji.style",{default:"twitter",process(I,j){return j!=0&&!d[j]?"twitter":j},ui:{path:"Chat > Appearance >> Emoji",title:"Emoji Style",component:"setting-select-box",data:[{value:"twitter",title:"Twitter (Twemoji)"},{value:"google",title:"Google (Noto)"},{value:"blob",title:"Blob"},{value:"open",title:"OpenMoji"},{value:0,title:"Native"}]}}),this.splitter=b()(),this.categories=r,this.emoji={},this.names={},this.chars=new Map}onEnable(){this.on("chat:pre-send-message",R=>{R.context.get("chat.emoji.replace-joiner")<2||(R.message=R.message.replace(a,c))}),this.loadEmojiData()}async loadEmojiData(R=0){let I;try{I=await fetch(`${y.SERVER}/script/emoji/v3.2.json?_${(0,E.getBuster)(60)}`).then(st=>st.ok?st.json():null)}catch(st){return R++,R<10?setTimeout(()=>this.loadEmojiData(R),500*R):(this.log.error("Error loading emoji data.",st),!1)}if(!I)return!1;const j=I.c,F={},H={},Y=new Map;for(const st of I.e){const tt=Object.assign(h(st.slice(4)),{category:j[st[0]],sort:st[1],names:st[2],name:st[3]});Array.isArray(tt.names)||(tt.names=[tt.names]),tt.name||(tt.name=tt.names[0].replace(/_/g," ")),F[tt.code]=tt,Y.set(tt.raw,[tt.code,null]);for(const it of tt.names)H[it]=tt.code;if(st[7]){const it=tt.variants={};for(const ut of st[7]){if(Array.isArray(ut[3])||!ut[3]){const W=Object.assign(h(ut),{category:j[st[0]],sort:st[1],names:ut[5],hidden:!0});Array.isArray(W.names)||(W.names=[W.names]),W.name=W.names[0].replace(/_/g," "),F[W.code]=W,Y.set(W.raw,[W.code,null]);for(const L of W.names)H[L]=W.code;continue}const rt=s[ut[3]];if(!rt){console.warn("Unknown tone:",ut[3],ut,tt);continue}const mt=Object.assign(h(ut),{key:rt});it[rt]=mt,Y.set(mt.raw,[tt.code,mt.key])}}}return this.emoji=F,this.names=H,this.chars=Y,this.log.info(`Loaded data about ${Object.keys(F).length} emoji.`),this.emit(":populated"),!0}getFullImage(R,I){return I||(I=this.parent.context.get("chat.emoji.style")),(0,_.has)(d,I)||(I="twitter"),`${y.SERVER}/static/emoji/images/${d[I]}/${R}`}getFullImageSet(R,I){return I||(I=this.parent.context.get("chat.emoji.style")),(0,_.has)(d,I)||(I="twitter"),`${y.SERVER}/static/emoji/images/${d[I]}/${R} 72w`}};$(p,"Emoji");let w=p;function h(z){let R=z[0];return z[4]===0&&(R=`${R}-fe0f`),{code:R,image:`${z[0]}.png`,raw:R.split("-").map(m).join(""),sheet_x:z[1][0],sheet_y:z[1][1],has:{google:!!(8&z[2]),blob:!!(4&z[2])||!!(8&z[2]),twitter:!!(2&z[2]),open:!!(1&z[2])}}}$(h,"hydrate_emoji")},63479:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>N});const N=f(72153)},90334:(q,T,f)=>{"use strict";f.d(T,{Z:()=>y});var N=f(46949);const y={data(){return{value:void 0,has_value:!1,provider_key:this.item.override_setting??this.item.setting,_unseen:!1}},created(){const _=this.context.provider,E=this.provider_key;_.on("changed",this._providerChange,this),this.has_value=_.has(E),this.has_value?this.value=(0,N.deep_copy)(_.get(E)):this.value=this.default_value,this.item.unseen&&(this._unseen=!0,this.item.unseen=0)},destroyed(){this.context.provider.off("changed",this._providerChange,this),this.value=void 0,this.has_value=!1},computed:{data(){const _=this.item.data;return typeof _=="function"?_(this.value):_},unseen(){return this._unseen||this.item.unseen>0},default_value(){return typeof this.item.default=="function"?this.item.default(this.context):(0,N.deep_copy)(this.item.default)},isValid(){return this.isDefault||this.validate(this.value)},isDefault(){return!this.has_value}},methods:{_providerChange(_,E,A){_===this.provider_key&&(A?(this.has_value=!1,this.value=this.default_value):(this.has_value=!0,this.value=(0,N.deep_copy)(E)))},validate(_){let E=this.item.validator;if(!E&&typeof this.item.process=="string"&&(E=this.context.getValidator(`process_${this.item.process}`)),E){if(typeof E!="function"&&(E=this.context.getValidator(E)),typeof E=="function")return E(_,this.item,this);throw new Error(`Invalid Validator for ${this.provider_key}`)}return!0},set(_){const E=this.context.provider,A=this.provider_key;let b=this.item.process;if(b)if(typeof b!="function"&&(b=this.context.getProcessor(b)),typeof b=="function")_=b(_,this.default_value,this.item,this);else throw new Error(`Invalid processor for ${A}`);E.set(A,_),this.has_value=!0,this.value=(0,N.deep_copy)(_),this.item.onUIChange&&this.item.onUIChange(this.value,this)},clear(){const _=this.context.provider,E=this.provider_key;_.delete(E),this.value=this.default_value,this.has_value=!1,this.item.onUIChange&&this.item.onUIChange(this.value,this)}}}},54643:(q,T,f)=>{"use strict";f.d(T,{Z:()=>y});var N=f(46949);const y={data(){return{value:void 0,has_value:!1,profile:null,_unseen:!1,source:null,source_value:void 0}},created(){const _=this.context.context,E=this.item.setting;_._add_user(),this._update_profile(),this._uses_changed(_.uses(E)),this.item.unseen&&(this._unseen=!0,this.item.unseen=0),_.on(`uses_changed:${E}`,this._uses_changed,this)},destroyed(){const _=this.context.context,E=this.item.setting;this.profile&&this.profile.off("changed",this._setting_changed,this),this.source&&this.source.off("changed",this._source_setting_changed,this),_.off(`uses_changed:${E}`,this._uses_changed,this),this.value=void 0,this.has_value=!1,this.profile=null,this.source_value=void 0,this.source=null,_._remove_user()},watch:{"context.currentProfile"(){this._update_profile()}},computed:{data(){const _=this.item.data;return typeof _=="function"?_(this.profile,this.value):_},unseen(){return this._unseen||this.item.unseen>0},default_value(){return typeof this.item.default=="function"?this.item.default(this.context.context):(0,N.deep_copy)(this.item.default)},isInherited(){return!this.has_value&&this.source&&this.sourceOrder>this.profileOrder},isDefault(){return!this.has_value&&!this.source},isOverridden(){return this.source&&this.sourceOrder<this.profileOrder},isValid(){return this.isDefault||this.validate(this.value)},isReadOnly(){return this.profile&&this.profile.ephemeral},sourceOrder(){return this.source?this.source.order:1/0},profileOrder(){return this.profile?this.profile.order:1/0},sourceTitle(){if(this.source)return this.source.i18n_key?this.t(this.source.i18n_key,this.source.title,this.source):this.source.title},sourceDisplay(){const _={title:this.sourceTitle};if(this.isInherited)return this.t("setting.inherited-from","Inherited From: {title}",_);if(this.isOverridden)return this.t("setting.overridden-by","Overridden By: {title}",_)}},methods:{_update_profile(){this.profile&&this.profile.off("changed",this._setting_changed,this);const _=this.profile=this.context.currentProfile,E=this.item.setting;_.on("changed",this._setting_changed,this),this.has_value=_.has(E),this.value=this.has_value?(0,N.deep_copy)(_.get(E)):this.isInherited?this.source_value:this.default_value},_setting_changed(_,E,A){_===this.item.setting&&(this.has_value=A!==!0,this.value=this.has_value?(0,N.deep_copy)(E):this.isInherited?this.source_value:this.default_value)},_source_setting_changed(_,E,A){_===this.item.setting&&(this.source_value=(0,N.deep_copy)(E),this.isInherited&&(this.value=A?this.default_value:E))},_uses_changed(_){this._uses_cb&&clearTimeout(this._uses_cb),this._uses_cb=setTimeout(()=>{this.source&&this.source.off("changed",this._source_setting_changed,this),_=_?_[0]:null;const E=this.source=_==null?null:this.context.profile_keys[_],A=this.item.setting;E?(E.on("changed",this._source_setting_changed,this),this.source_value=(0,N.deep_copy)(E.get(A))):this.source_value=void 0,this.has_value=this.profile&&this.profile.has(this.item.setting),this.has_value||(this.value=this.isInherited?this.source_value:this.default_value)},0)},validate(_){let E=this.item.validator;if(!E&&typeof this.item.process=="string"&&(E=this.context.getValidator(`process_${this.item.process}`)),E){if(typeof E!="function"&&(E=this.context.getValidator(E)),typeof E=="function")return E(_,this.item,this);throw new Error(`Invalid Validator for ${this.item.setting}`)}return!0},set(_){if(this.isReadOnly)return;let E=this.item.process;if(E)if(typeof E!="function"&&(E=this.context.getProcessor(E)),typeof E=="function")_=E(_,this.default_value,this.item,this);else throw new Error(`Invalid processor for ${this.item.setting}`);this.profile.set(this.item.setting,_),this.item.onUIChange&&this.item.onUIChange(_,this)},clear(){this.isReadOnly||(this.profile.delete(this.item.setting),this.item.onUIChange&&this.item.onUIChange(this.value,this))}}}},33612:(q,T,f)=>{"use strict";f.d(T,{Z:()=>E});var N=f(22527);let y=0,_=0;const A=class A extends(f.j!=4609?N.default:null){constructor(v,r){super(v,r),this._id=`_ffz$${y++}`,this.log.info(`Using: ${this.constructor.name}`)}getReact(){if(this._react)return this._react;let v;try{v=this.getCore?.()?.intl?.react}catch{}if(v?.Component&&v.createElement)return this._react=v;if(v=this.resolve("site.web_munch")?.getModule?.("react"),v?.Component&&v.createElement)return this._react=v}getReactDom(){if(this._reactDom)return this._reactDom;let v=this.resolve("site.web_munch")?.getModule?.("react-dom");if(v?.createPortal)return this._reactDom=v}findReact(){const v=this.getReact();if(v)return Promise.resolve(v);const r=this.resolve("site.web_munch");return r?r.findModule("react"):this.waitFor("site.web_munch:registered").then(()=>this.findReact())}awaitElement(v,r,n=6e4){r||(r=document.documentElement);const s=r.querySelector(v);return s?Promise.resolve(s):new Promise((i,e)=>{const o=`${this._id}$observer`,a=r[o],c=_++,d=n&&setTimeout(()=>{const w=r[o];if(!w)return;const[h,p]=w;for(let z=0;z<p.length;z++){const R=p[z];if(R[0]===c){p.splice(z,1),R[3]("Timed out");break}}p.length||(h.disconnect(),r[o]=null)},n);if(a){a[1].push([c,v,i,e,d]);return}const m=new MutationObserver(()=>{const w=r[o];if(!w){m.disconnect();return}const h=w[1];for(let p=0;p<h.length;p++){const z=h[p],R=r.querySelector(z[1]);R&&(h.splice(p,1),p--,z[4]&&clearTimeout(z[4]),z[2](R))}h.length||(m.disconnect(),r[o]=null)});r[o]=[m,[[c,v,i,e,d]]],m.observe(r,{childList:!0,attributes:!0,characterData:!0,subtree:!0})})}};$(A,"BaseSite");let E=A},10789:(q,T,f)=>{"use strict";f.d(T,{Z:()=>d});var N=f(22527),y=f(44589),_=f(46949),E=f(83342);const A=(0,y.createElement)("span"),b=".video-player__default-player .player-controls__left-control-group",v=".video-player__default-player .player-controls__right-control-group",r=window.AudioContext&&window.DynamicsCompressorNode!=null,n=r&&window.GainNode!=null,s="setting.entry.player.volume-scroll.values",i=[{value:!1,title:"Disabled",i18n_key:`${s}.false`},{value:!0,title:"Enabled",i18n_key:`${s}.true`},{value:2,title:"Enabled with Right-Click",i18n_key:`${s}.2`},{value:3,title:"Enabled with Alt",i18n_key:`${s}.3`},{value:4,title:"Enabled with Alt + Right-Click",i18n_key:`${s}.4`},{value:5,title:"Enabled with Shift",i18n_key:`${s}.5`},{value:6,title:"Enabled with Shift + Right-Click",i18n_key:`${s}.6`},{value:7,title:"Enabled with Ctrl",i18n_key:`${s}.7`},{value:8,title:"Enabled with Ctrl + Right-Click",i18n_key:`${s}.8`}];function e(w){return w.querySelector('button[aria-label*="alt+x"]')??w.querySelector('button[aria-label]:has(path[d="M8 9H6v2h2V9zm1 0h2v2H9V9zm5 0h-2v2h2V9z"]')}$(e,"getNativeClipButton");function o(w){return w===2||w===4||w===6||w===8}$(o,"wantsRMB");function a(w,h,p){return!(o(w)&&h.button!==2&&!p||!h.altKey&&(w===3||w===4)||!h.shiftKey&&(w===5||w===6)||!h.ctrlKey&&(w===7||w===8))}$(a,"matchesEvent");function c(w){const h=w.currentTarget,p=h&&h.querySelector("figure");!p||p.classList.contains("ffz-i-t-reset-clicked")||(p.classList.toggle("ffz-i-t-reset",!1),p.classList.toggle("ffz-i-t-reset-clicked",!0),setTimeout(()=>{p.classList.toggle("ffz-i-t-reset",!0),p.classList.toggle("ffz-i-t-reset-clicked",!1)},500))}$(c,"rotateButton");const m=class m extends(f.j!=4609?N.default:null){constructor(...h){super(...h),this.inject("i18n"),this.inject("settings"),this.inject("site.fine"),this.inject("site.css_tweaks"),this.onShortcut=this.onShortcut.bind(this),this.LEFT_CONTROLS=b,this.RIGHT_CONTROLS=v,this.registerSettings()}registerSettings(){this.settings.add("player.embed-metadata",{default:!0,ui:{path:"Player > General >> Embed and Popout",title:"Show metadata when mousing over the player.",component:"setting-check-box"}}),this.settings.add("player.cast-button.hide",{default:!1,ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Hide the Cast button."},changed:h=>this.css_tweaks.toggleHide("player-cast",h)}),this.settings.add("player.clip-button.hide-native",{default:null,requires:["player.clip-button.custom"],process:(h,p)=>p??h.get("player.clip-button.custom"),ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Hide the native Clip button.",description:"By default, this is enabled when using the setting to add a custom Clip button."},changed:h=>this.css_tweaks.toggle("player-hide-native-clip",h)}),this.settings.add("player.clip-button.custom",{default:!1,ui:{path:"Player > General >> Appearance",component:"setting-check-box",title:"Display a custom Clip button.",description:"Add a custom Clip button to the player that better fits the style of the other buttons."},changed:()=>{for(const h of this.Player.instances)this.addClipButton(h)}}),this.settings.add("player.fade-pause-buffer",{default:!1,ui:{path:"Player > General >> Playback",title:"Fade the player when paused or buffering to make the UI easier to see.",component:"setting-check-box"},changed:h=>this.css_tweaks.toggle("player-fade-paused",h)}),this.settings.add("player.disable-content-warnings",{default:!1,ui:{path:"Player > General >> General",title:"Do not display content warnings.",description:"When this is enabled, FFZ will automatically skip content warnings. This feature is intended for use by adults only.",component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.skipContentWarnings(h)}}),r&&(this.settings.add("player.compressor.enable",{default:!0,ui:{path:'Player > Compressor @{"description": "These settings control optional dynamic range compression for the player, a form of audio processing that reduces the volume of loud sounds and amplifies quiet sounds, thus normalizing or compressing the volume. This uses a [DynamicsCompressorNode](https://developer.mozilla.org/en-US/docs/Web/API/DynamicsCompressorNode) from the Web Audio API behind the scenes if you want to learn more."} >> General',title:"Enable the audio compressor and add an `Audio Compressor` button to the player controls.",sort:-1e3,component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.addCompressorButton(h)}}),this.settings.add("player.compressor.default",{default:!1,ui:{path:"Player > Compressor >> General",title:"Enable the compressor by default.",component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.compressPlayer(h)}}),this.settings.add("player.compressor.force-legacy",{default:!1,ui:{path:"Player > Compressor >> Advanced",title:"Force use of legacy browser API.",description:"This setting forces FrankerFaceZ to attempt to use an older browser API to create the compressor. Please reset your player after changing this setting.",component:"setting-check-box",force_seen:!0}}),this.settings.add("player.compressor.shortcut",{default:null,requires:["player.compressor.enable"],process(h,p){return h.get("player.compressor.enable")?p:null},ui:{path:"Player > Compressor >> General",title:"Shortcut Key",description:"This key sequence can be used to toggle the compressor.",component:"setting-hotkey"},changed:()=>{this.updateShortcut();for(const h of this.Player.instances)this.addCompressorButton(h)}}),n&&(this.settings.add("player.gain.enable",{default:!1,ui:{sort:-1,path:'Player > Compressor >> Gain Control @{"sort": 50, "description": "Gain Control gives you extra control over the output volume when using the Compressor by letting you adjust the volume after the compressor runs, while the built-in volume slider takes affect before the compressor. This uses a simple [GainNode](https://developer.mozilla.org/en-US/docs/Web/API/GainNode) from the Web Audio API, connected in sequence after the DynamicsCompressorNode the Compressor uses."}',title:"Enable gain control when the audio compressor is enabled.",component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.compressPlayer(h)}}),this.settings.add("player.gain.no-volume",{default:!1,requires:["player.gain.enable"],process(h,p){return h.get("player.gain.enable")?p:!1},ui:{path:"Player > Compressor >> Gain Control",title:"Force built-in volume to 100% when the audio compressor is enabled.",description:"With this enabled, the built-in volume will be hidden and the Gain Control will be the only way to change volume.",component:"setting-check-box"},changed:h=>{this.css_tweaks.toggleHide("player-gain-volume",h);for(const p of this.Player.instances)this.updateGainVolume(p)}}),this.settings.add("player.gain.scroll",{default:!1,ui:{path:"Player > Compressor >> Gain Control",title:"Scroll Adjust",description:"Adjust the gain by scrolling with the mouse wheel. This setting takes precedence over adjusting the volume by scrolling. *This setting will not work properly on streams with visible extensions when mouse interaction with extensions is allowed.*",component:"setting-select-box",data:i}}),this.settings.add("player.gain.default",{default:100,requires:["player.gain.min","player.gain.max"],process(h,p){const z=h.get("player.gain.min"),R=h.get("player.gain.max");return p/=100,p<z&&(p=z),p>R&&(p=R),p},ui:{path:"Player > Compressor >> Gain Control",title:"Default Value",component:"setting-text-box",description:"The default value for gain control, when gain control is enabled. 100% means no change in volume.",process:"to_int",bounds:[0,!0]},changed:()=>this.updateGains()}),this.settings.add("player.gain.min",{default:0,process:(h,p)=>p/100,ui:{path:"Player > Compressor >> Gain Control",title:"Minimum",component:"setting-text-box",description:`**Range:** 0 ~ 100

The minimum allowed value for gain control. 0% is effectively muted.`,process:"to_int",bounds:[0,!0,100,!0]},changed:()=>this.updateGains()}),this.settings.add("player.gain.max",{default:200,process:(h,p)=>p/100,ui:{path:"Player > Compressor >> Gain Control",title:"Maximum",component:"setting-text-box",description:`**Range:** 100 ~ 1000

The maximum allowed value for gain control. 100% is no change. 200% is double the volume.`,process:"to_int",bounds:[100,!0,1e3,!0]},changed:()=>this.updateGains()})),this.settings.add("player.compressor.threshold",{default:-50,ui:{path:'Player > Compressor >> Advanced @{"sort": 1000}',title:"Threshold",sort:0,description:`**Range:** -100 ~ 0

The decibel value above which the compression will start taking effect.`,component:"setting-text-box",process:"to_int",bounds:[-100,!0,0,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.knee",{default:40,ui:{path:"Player > Compressor >> Advanced",title:"Knee",sort:5,description:`**Range:** 0 ~ 40

A decibel value representing the range above the threshold where the curve smoothly transitions to the compressed portion.`,component:"setting-text-box",process:"to_int",bounds:[0,!0,40,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.ratio",{default:12,ui:{path:"Player > Compressor >> Advanced",title:"Ratio",sort:10,description:`**Range:** 0 ~ 20

The amount of change, in dB, needed in the input for a 1 dB change in the output.`,component:"setting-text-box",process:"to_int",bounds:[0,!0,20,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.attack",{default:0,ui:{path:"Player > Compressor >> Advanced",title:"Attack",sort:15,description:`**Range:** 0 ~ 1

The amount of time, in seconds, required to reduce the gain by 10 dB.`,component:"setting-text-box",process:"to_float",bounds:[0,!0,1,!0]},changed:()=>this.updateCompressors()}),this.settings.add("player.compressor.release",{default:.25,ui:{path:"Player > Compressor >> Advanced",title:"Release",sort:20,description:`**Range:** 0 ~ 1
The amount of time, in seconds, required to increase the gain by 10 dB.`,component:"setting-text-box",process:"to_float",bounds:[0,!0,1,!0]},changed:()=>this.updateCompressors()})),this.settings.add("player.allow-catchup",{default:!0,ui:{path:'Player > General @{"sort": -1000} >> General',title:"Allow the player to speed up to reduce delay.",description:"Twitch, by default, will apply a minor speed up to live video when you have a large delay to the broadcaster in order to catch back up with the live broadcast. This may result in audio distortion. Disable this to prevent the automatic speed changes.",component:"setting-check-box"},changed:()=>this.updatePlaybackRates()}),this.settings.add("player.mute-click",{default:!1,ui:{path:"Player > General >> Volume",title:"Mute or unmute the player by middle-clicking.",component:"setting-check-box"}}),this.settings.add("player.volume-scroll",{default:!1,ui:{path:"Player > General >> Volume",title:"Adjust volume by scrolling with the mouse wheel.",description:"*This setting will not work properly on streams with visible extensions when mouse interaction with extensions is allowed.*",component:"setting-select-box",data:i}}),this.settings.add("player.button.reset",{default:!0,ui:{path:"Player > General >> General",title:"Add a `Reset Player` button to the player controls.",description:"Double-clicking the Reset Player button attempts to reset the Twitch player's internal state, fixing playback issues without a full page refresh.",component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.addResetButton(h)}}),document.pictureInPictureEnabled&&this.settings.add("player.button.pip",{default:!0,ui:{path:"Player > General >> General",title:"Add a `Picture-in-Picture` button to the player controls.",description:"Clicking the PiP button attempts to toggle Picture-in-Picture mode for the player's video.",component:"setting-check-box"},changed:()=>{for(const h of this.Player.instances)this.addPiPButton(h)}}),this.settings.add("player.volume-scroll-steps",{default:.1,ui:{path:"Player > General >> Volume",title:"Volume scroll amount",description:"How much the volume level is changed per individual scroll input.",component:"setting-select-box",data:[{value:.1,title:"10%"},{value:.05,title:"5%"},{value:.02,title:"2%"},{value:.01,title:"1%"}]}}),this.settings.add("player.captions.font-size",{default:"",ui:{path:"Player > Closed Captioning >> Font",title:"Font Size",description:"How large should captions be. This can be a percentage, such as `10%`, or a pixel value, such as `50px`.",component:"setting-text-box"},changed:()=>this.updateCaptionsCSS()}),this.settings.add("player.captions.font-family",{default:"",ui:{path:"Player > Closed Captioning >> Font",title:"Font Family",description:"Override the font used for displaying Closed Captions.",component:"setting-combo-box",data:()=>(0,E.R7)()},changed:()=>this.updateCaptionsCSS()}),this.settings.add("player.ext-hide",{default:0,ui:{path:"Player > General >> Extensions",title:"Show Overlay Extensions",description:"**Note**: This feature does not prevent extensions from loading. Hidden extensions are merely invisible. Hiding extensions with this feature will not improve your security. To prevent extensions from loading entirely, we recommend using the [Disable Twitch Extensions browser extension](https://twitch-tools.rootonline.de/disable_twitch_extensions.php) by CommanderRoot.",component:"setting-select-box",data:[{value:2,title:"Never"},{value:1,title:"With Controls"},{value:0,title:"Always"}]},changed:h=>this.updateHideExtensions(h)}),this.settings.add("player.ext-interaction",{default:!0,ui:{path:"Player > General >> Extensions",title:"Allow mouse interaction with overlay extensions.",component:"setting-check-box"},changed:h=>this.css_tweaks.toggle("player-ext-mouse",!h)}),this.settings.add("player.no-autoplay",{default:!1,ui:{path:"Player > General >> Playback",title:"Do not automatically start playing videos or streams.",description:"Note: This feature does not apply when navigating directly from channel to channel.",component:"setting-check-box"}}),this.settings.add("player.vod.autoplay",{default:!0,ui:{path:"Player > General >> Playback",title:"Auto-play the next recommended video after a video finishes.",component:"setting-check-box"}}),this.settings.add("player.volume-always-shown",{default:!1,ui:{path:"Player > General >> Volume",title:"Keep the volume slider expanded at all times.",component:"setting-check-box"},changed:h=>this.css_tweaks.toggle("player-volume",h)}),this.settings.add("player.hide-mouse",{default:!0,ui:{path:"Player > General >> General",title:"Hide mouse when controls aren't visible.",component:"setting-check-box"},changed:h=>this.css_tweaks.toggle("player-hide-mouse",h)}),this.settings.add("player.single-click-pause",{default:!1,ui:{path:"Player > General >> Playback",title:"Pause/Unpause the player by clicking.",component:"setting-check-box"}})}async onEnable(){await this.settings.awaitProvider(),await this.settings.provider.awaitReady(),this.css_tweaks.toggleHide("player-cast",this.settings.get("player.cast-button.hide")),this.css_tweaks.toggleHide("player-gain-volume",this.settings.get("player.gain.no-volume")),this.css_tweaks.toggle("player-hide-native-clip",this.settings.get("player.clip-button.hide-native")),this.css_tweaks.toggle("player-volume",this.settings.get("player.volume-always-shown")),this.css_tweaks.toggle("player-ext-mouse",!this.settings.get("player.ext-interaction")),this.css_tweaks.toggle("player-hide-mouse",this.settings.get("player.hide-mouse")),this.css_tweaks.toggle("player-fade-paused",this.settings.get("player.fade-pause-buffer")),this.installVisibilityHook(),this.updateHideExtensions(),this.updateCaptionsCSS(),this.updateShortcut(),this.on(":reset",this.resetAllPlayers,this),this.Player.ready((h,p)=>{this.modifyPlayerClass(h);for(const z of p){const R=z.props?.playerEvents;R&&((0,y.off)(R,"Playing",z.setPlayerActive),(0,y.off)(R,"PlayerSeekCompleted",z.setPlayerActive)),z.ffzMaybeRemoveNativeListeners(),z.maybeAttachDomEventListeners(),z.ffzScheduleState(),R&&((0,y.on)(R,"Playing",z.setPlayerActive),(0,y.on)(R,"PlayerSeekCompleted",z.setPlayerActive)),this.updateGUI(z),this.compressPlayer(z),this.updatePlaybackRate(z)}}),this.Player.on("mount",h=>{this.updateGUI(h),this.compressPlayer(h),this.updatePlaybackRate(h)}),this.Player.on("update",h=>{this.updateGUI(h),this.compressPlayer(h),this.updatePlaybackRate(h)}),this.Player.on("unmount",h=>{h.ffzUninstall()}),this.on("i18n:update",()=>{for(const h of this.Player.instances)this.updateGUI(h)})}updateShortcut(){const h=this.Mousetrap=this.Mousetrap||this.resolve("site.web_munch")?.getModule?.("mousetrap")||window.Mousetrap;if(!h||!h.bind)return;this._shortcut_bound&&(h.unbind(this._shortcut_bound),this._shortcut_bound=null);const p=this.settings.get("player.compressor.shortcut");r&&p&&(0,_.isValidShortcut)(p)&&(h.bind(p,this.onShortcut),this._shortcut_bound=p)}onShortcut(h){for(const p of this.Player.instances)this.compressPlayer(p,h)}modifyPlayerClass(h){const p=this,z=h.prototype.maybeAttachDomEventListeners;h.prototype.ffzInstall=function(){if(this._ffz_installed)return;this._ffz_installed=!0,this._ffzUpdateState||(this._ffzUpdateState=this.ffzUpdateState.bind(this)),this._ffzErrorReset||(this._ffzErrorReset=p.addErrorResetButton.bind(p,this)),this._ffzReady||(this._ffzReady=this.ffzReady.bind(this));const R=this,I=this.setPlayerActive,j=this.setPlayerInactive;this.setPlayerActive=function(){return R.ffzScheduleState(),I.call(R)},this.setPlayerInactive=function(){return R.ffzScheduleState(),j.call(R)},this.ffzOnEnded=()=>{p.settings.get("player.vod.autoplay")||p.parent.awaitElement(".autoplay-vod__content-container button",this.props.containerRef||p.fine.getChildNode(this),1e3).then(H=>H.click())};const F=this.props.playerEvents;F&&((0,y.on)(F,"Buffering",this._ffzUpdateState),(0,y.on)(F,"Playing",this._ffzUpdateState),(0,y.on)(F,"PlayerError",this._ffzUpdateState),(0,y.on)(F,"PlayerError",this._ffzErrorReset),(0,y.on)(F,"Ended",this._ffzUpdateState),(0,y.on)(F,"Ended",this.ffzOnEnded),(0,y.on)(F,"Ready",this._ffzReady),(0,y.on)(F,"Idle",this._ffzUpdateState)),this.ffzStopAutoplay()},h.prototype.ffzUninstall=function(){this._ffz_state_raf&&cancelAnimationFrame(this._ffz_state_raf);const R=this.props.playerEvents;R&&this._ffzUpdateState&&((0,y.off)(R,"Playing",this._ffzUpdateState),(0,y.off)(R,"PlayerError",this._ffzUpdateState),(0,y.off)(R,"PlayerError",this._ffzErrorReset),(0,y.off)(R,"Ended",this._ffzUpdateState),(0,y.off)(R,"Ended",this.ffzOnEnded),(0,y.off)(R,"Ready",this._ffzReady),(0,y.off)(R,"Idle",this._ffzUpdateState)),this.ffzRemoveListeners(),this._ffz_state_raf=null,this._ffzUpdateState=null,this._ffzErrorReset=null,this._ffzReady=null,this.ffzOnEnded=null},h.prototype.ffzReady=function(){const R=this.props.containerRef;R&&requestAnimationFrame(()=>{const I=R.querySelectorAll(".ffz--player-reset figure");for(const j of I)j._ffz_unspin&&clearTimeout(j._ffz_unspin),j.classList.toggle("loading",!1)})},h.prototype.ffzStopAutoplay=function(){p.shouldStopAutoplay(this)&&p.stopPlayer(this.props.mediaPlayerInstance,this.props.playerEvents,this)},h.prototype.ffzScheduleState=function(){this._ffzUpdateState||(this._ffzUpdateState=this.ffzUpdateState.bind(this)),this._ffz_state_raf||(this._ffz_state_raf=requestAnimationFrame(this._ffzUpdateState))},h.prototype.ffzUpdateState=function(){this._ffz_state_raf=null;const R=this.props.containerRef;if(!R)return;const I=R.dataset;I.controls=this.state?.active||!1;let j=this.props.mediaPlayerInstance;if(!j)return;j.core&&(j=j.core);const F=j.state?.state,H=j.mediaSinkManager?.video;F==="Playing"&&H?._ffz_maybe_compress&&(H._ffz_maybe_compress=!1,p.compressPlayer(this)),H&&H._ffz_compressed!=null&&(I.compressed=H._ffz_compressed),I.ended=F==="Ended",I.paused=F==="Idle",I.buffering=F==="Buffering"},h.prototype.ffzAttachListeners=function(){const R=this.props.containerRef;!R||this._ffz_listeners||(this._ffz_listeners=!0,this._ffz_scroll_handler||(this._ffz_scroll_handler=this.ffzScrollHandler.bind(this)),this._ffz_click_handler||(this._ffz_click_handler=this.ffzClickHandler.bind(this)),this._ffz_dblclick_handler||(this._ffz_dblclick_handler=this.ffzDblClickHandler.bind(this)),this._ffz_menu_handler||(this._ffz_menu_handler=this.ffzMenuHandler.bind(this)),(0,y.on)(R,"wheel",this._ffz_scroll_handler),(0,y.on)(R,"dblclick",this._ffz_dblclick_handler),(0,y.on)(R,"mousedown",this._ffz_click_handler),(0,y.on)(R,"contextmenu",this._ffz_menu_handler))},h.prototype.ffzRemoveListeners=function(){const R=this.props.containerRef;!R||!this._ffz_listeners||(this._ffz_scroll_handler&&((0,y.off)(R,"wheel",this._ffz_scroll_handler),this._ffz_scroll_handler=null),this._ffz_click_handler&&((0,y.off)(R,"mousedown",this._ffz_click_handler),this._ffz_click_handler=null),this._ffz_menu_handler&&((0,y.off)(R,"contextmenu",this._ffz_menu_handler),this._ffz_menu_handler=null),this._ffz_dblclick_handler&&((0,y.off)(R,"dblclick",this._ffz_dblclick_handler),this._ffz_dblclick_handler=null),this._ffz_listeners=!1)},h.prototype.ffzDelayPause=function(){this._ffz_pause_timer&&clearTimeout(this._ffz_pause_timer),(this.props?.mediaPlayerInstance).isPaused()||(this._ffz_pause_timer=setTimeout(()=>{const I=this.props?.mediaPlayerInstance;I.isPaused()||I.pause()},500))},h.prototype.ffzDblClickHandler=function(R){R&&this._ffz_pause_timer&&clearTimeout(this._ffz_pause_timer)},h.prototype.ffzClickHandler=function(R){if(!R)return;const I=p.settings.get("player.volume-scroll"),j=p.settings.get("player.gain.scroll"),F=p.settings.get("player.single-click-pause"),H=o(I)||o(j);if(F&&R.button===0){if(!R.target||!R.target.classList.contains("click-handler"))return;this.ffzDelayPause()}if(H&&R.button===2&&(this.ffz_rmb=!0,this.ffz_scrolled=!1),!p.settings.get("player.mute-click")||R.button!==1)return;const Y=this.props?.mediaPlayerInstance;if(!Y?.isMuted)return;const st=!Y.isMuted();return Y.setMuted(st),localStorage.setItem("video-muted",JSON.stringify({default:st})),R.preventDefault(),!1},h.prototype.ffzMenuHandler=function(R){this.ffz_rmb=!1,this.ffz_scrolled&&(R.preventDefault(),R.stopPropagation())},h.prototype.ffzScrollHandler=function(R){const I=p.settings.get("player.volume-scroll"),j=p.settings.get("player.gain.scroll"),F=p.settings.get("player.gain.no-volume"),H=j&&a(j,R,this.ffz_rmb),Y=I&&a(I,R,this.ffz_rmb);if(!H&&!Y)return;const st=R.wheelDelta||-(R.deltaY||R.detail||0),tt=this.props?.mediaPlayerInstance,it=tt?.mediaSinkManager?.video||tt?.core?.mediaSinkManager?.video,ut=it?._ffz_compressed&&it?._ffz_gain!=null,rt=ut&&H;if(!tt?.getVolume)return;o(rt?j:I)&&(this.ffz_scrolled=!0);const mt=p.settings.get("player.volume-scroll-steps");if(rt){let W=it._ffz_gain_value;W==null&&(W=p.settings.get("player.gain.default"));const L=p.settings.get("player.gain.min"),Z=p.settings.get("player.gain.max");st>0?W+=mt:W-=mt,W<L&&(W=L),W>Z&&(W=Z),it._ffz_gain_value=W,F&&W!==0&&(tt.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1}))),p.updateGain(this)}else if(Y&&!(it._ffz_compressed&&F)){const W=it?.volume??tt.getVolume(),L=Math.max(0,Math.min(1,W+(st>0?mt:-mt)));tt.setVolume(L),localStorage.volume=L,L!==0&&(tt.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1})))}return R.preventDefault(),!1},h.prototype.ffzMaybeRemoveNativeListeners=function(){const R=this.props.containerRef;R&&this.listenersAttached&&((0,y.off)(R,"mouseleave",this.setPlayerInactive),(0,y.off)(R,"mouseenter",this.setPlayerActive),(0,y.off)(R,"mousemove",this.onMouseMove),this.listenersAttached=!1)},h.prototype.maybeAttachDomEventListeners=function(){try{this.ffzInstall(),this.ffzAttachListeners()}catch(R){p.log.error("Error attaching event listener.",R)}return z.call(this)}}shouldStopAutoplay(){return!1}installVisibilityHook(){if(!document.pictureInPictureEnabled){this.log.info("Skipping visibility hooks. Picture-in-Picture is not available.");return}const h=this;document.addEventListener("fullscreenchange",()=>{const p=document.fullscreenElement,z=document.pictureInPictureElement;p&&z&&(p===z||p.contains(z))&&document.exitPictureInPicture();for(const R of this.Player.instances)this.addPiPButton(R)});try{Object.defineProperty(document,"hidden",{configurable:!0,get(){return document.pictureInPictureElement!=null||h.settings.get("player.force-visible")?!1:document.visibilityState==="hidden"}})}catch(p){this.log.warn("Unable to install document visibility hook.",p)}}stopPlayer(h,p,z){if(h&&h.pause&&(h.getState?.()||h.core?.getState?.())==="Playing")h.pause();else if(p&&!p._ffz_stopping){p._ffz_stopping=!0;const R=$(()=>{z.props.mediaPlayerInstance?.pause&&(z.props.mediaPlayerInstance.pause(),(0,y.off)(p,"Playing",R),p._ffz_stopping=!1)},"immediatePause");this.log.info("Unable to immediately pause. Listening for playing event."),(0,y.on)(p,"Playing",R)}}updateCaptionsCSS(){const h=[],p=this.settings.get("player.captions.font-size");let z=this.settings.get("player.captions.font-family");if(z&&z.length){const[R,I]=(0,E.jo)(z);z=R,this._font_unloader&&this._font_unloader(),this._font_unloader=I,z.indexOf(" ")!==-1&&z.indexOf(",")===-1&&z.indexOf('"')===-1&&z.indexOf("'")===-1&&(z=`"${z}"`),A.style.fontFamily="",A.style.fontFamily=z,A.style.fontFamily&&h.push(`font-family: ${A.style.fontFamily} !important;`)}A.style.fontSize="",A.style.fontSize=p,A.style.fontSize&&h.push(`font-size: ${A.style.fontSize} !important;`),h.length?this.css_tweaks.set("captions-font",`.player-captions-container__caption-line {
	${h.join(`
	`)}
}`):this.css_tweaks.delete("captions-font")}updateHideExtensions(h){h===void 0&&(h=this.settings.get("player.ext-hide")),this.css_tweaks.toggleHide("player-ext-hover",h===1),this.css_tweaks.toggleHide("player-ext",h===2)}skipContentWarnings(h){if(!this.settings.get("player.disable-content-warnings"))return;const p=this.fine.getHostNode(h),z=p&&p.querySelector('button[data-a-target="content-classification-gate-overlay-start-watching-button"]');z&&z.click()}updateGUI(h){this.skipContentWarnings(h),this.addPiPButton(h),this.addResetButton(h),this.addClipButton(h),this.addCompressorButton(h,!1),this.addGainSlider(h,!1),this.addMetadata(h),this.emit(":update-gui",h)}areControlsDisabled(h){return h._ffz_control_state||this.findControlState(h),h._ffz_control_state?h._ffz_control_state.props.disableControls:!1}findControlState(h){h._ffz_control_state||(h._ffz_control_state=this.fine.searchTree(h,p=>p.props&&(0,_.has)(p.props,"disableControls"),200))}addGainSlider(h,p,z=0){const R=h.props.containerRef||this.fine.getChildNode(h),I=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,j=R&&R.querySelector(b);let F=I!=null&&I._ffz_compressed&&I._ffz_gain;if(this.areControlsDisabled(h)&&(F=null),!j)return I&&!F?void 0:z<5?setTimeout(this.addGainSlider.bind(this,h,p,(z||0)+1),250):void 0;const H=this.settings.get("player.gain.min"),Y=this.settings.get("player.gain.max");(H>=Y||Y<=H)&&(F=null);let st,tt,it,ut,rt,mt=j.querySelector(".ffz--player-gain");if(!F){mt&&mt.remove();return}if(mt){if(p)return;it=mt.querySelector("input"),rt=mt.querySelector(".ffz--gain-value"),tt=mt.querySelector(".ffz-il-tooltip"),st=mt.querySelector(".ffz-il-tooltip .ffz--p-tip"),ut=mt.querySelector(".ffz-il-tooltip .ffz--p-value")}else{const nt=$(()=>{let at=it.value/100;const ft=this.settings.get("player.gain.min"),lt=this.settings.get("player.gain.max");if(at<ft&&(at=ft),at>lt&&(at=lt),at==I._ffz_gain_value)return;const ht=h.props.mediaPlayerInstance,pt=ht.core||ht;!this.areControlsDisabled(h)&&at>0&&this.settings.get("player.gain.no-volume")&&pt?.isMuted?.()&&(pt.setMuted(!1),localStorage.setItem("video-muted",JSON.stringify({default:!1}))),I._ffz_gain_value=at,F.gain.value=at;const _t=lt-ft,Ct=(at-ft)/_t;rt.style.width=`${Ct*100}%`,ut.textContent=`${Math.round(at*100)}%`},"on_change");mt=(0,y.createElement)("div",{class:"ffz--player-gain volume-slider__slider-container tw-relative ffz-il-tooltip__container"},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-full-height"},(0,y.createElement)("label",{class:"tw-hide-accessible"},this.i18n.t("player.gain.label","Gain Control")),(0,y.createElement)("div",{class:"tw-flex tw-full-width tw-relative tw-z-above"},it=(0,y.createElement)("input",{class:"ffz-range ffz-range--overlay",type:"range",min:"0",max:"100",step:"1","data-a-target":"player-gain-slider",value:"100"}),(0,y.createElement)("div",{class:"tw-absolute tw-border-radius-large tw-bottom-0 tw-flex tw-flex-column tw-full-width tw-justify-content-center ffz-range__fill ffz-range__fill--overlay tw-top-0 tw-z-below"},(0,y.createElement)("div",{class:"tw-border-radius-large ffz-range__fill-container"},rt=(0,y.createElement)("div",{class:"tw-border-radius-large ffz-range__fill-value ffz--gain-value","data-test-selector":"ffz-range__fill-value-selector"}))))),tt=(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-center ffz-il-tooltip--up",role:"tooltip"},(0,y.createElement)("div",null,st=(0,y.createElement)("div",{class:"ffz--p-tip"}),ut=(0,y.createElement)("div",{class:"tw-regular ffz--p-value"})))),it.addEventListener("input",nt),j.appendChild(mt)}let W=I._ffz_gain_value;W==null&&(W=this.settings.get("player.gain.default")),it.min=H*100,it.max=Y*100,it.value=W*100;const L=Y-H,Z=(W-H)/L;rt.style.width=`${Z*100}%`,st.textContent=this.i18n.t("player.gain.label","Gain Control"),ut.textContent=`${Math.round(W*100)}%`}addCompressorButton(h,p,z=0){const R=h.props.containerRef||this.fine.getChildNode(h),I=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,j=R&&R.querySelector(b),F=r&&I!=null&&this.settings.get("player.compressor.enable");if(!j)return F&&z<5?setTimeout(this.addCompressorButton.bind(this,h,p,(z||0)+1),250):void 0;let H,Y,st,tt,it=j.querySelector(".ffz--player-comp");if(!F||this.areControlsDisabled(h)){it&&it.remove();return}if(!it)it=(0,y.createElement)("div",{class:"ffz--player-comp tw-inline-flex tw-relative ffz-il-tooltip__container"},tt=(0,y.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-comp-button",onClick:this.compressPlayer.bind(this,h)},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,y.createElement)("div",{class:"tw-button-icon__icon"},H=(0,y.createElement)("figure",{class:"ffz-player-icon"})))),(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-left ffz-il-tooltip--up",role:"tooltip"},(0,y.createElement)("div",null,Y=(0,y.createElement)("div",{class:"ffz--p-tip"}),st=(0,y.createElement)("div",{class:"ffz--p-extra tw-pd-t-05 ffz--tooltip-explain"})))),j.appendChild(it);else{if(p)return;H=it.querySelector("figure"),tt=it.querySelector("button"),Y=it.querySelector(".ffz-il-tooltip .ffz--p-tip"),st=it.querySelector(".ffz-il-tooltip .ffz--p-extra")}const ut=I._ffz_compressed,rt=this.canCompress(h);let mt=rt?ut?this.i18n.t("player.comp_button.off","Disable Audio Compressor"):this.i18n.t("player.comp_button.on","Audio Compressor"):this.i18n.t("player.comp_button.disabled","Audio Compressor cannot be enabled when viewing Clips.");st.textContent=this.i18n.t("player.comp_button.help","See the FFZ Control Center for details. If audio breaks, please reset the player."),rt&&this._shortcut_bound&&(mt=`${mt} (${this._shortcut_bound})`),H.classList.toggle("ffz-i-comp-on",ut),H.classList.toggle("ffz-i-comp-off",!ut),tt.disabled=!rt,tt.setAttribute("aria-label",mt),Y.textContent=mt}replaceVideoElement(h,p){const z=(0,y.createElement)("video"),R=p?._ffz_pregain_volume??p?.volume??h.getVolume(),I=h.isMuted();return z._ffz_gain_value=p._ffz_gain_value,z._ffz_state=p._ffz_state,z._ffz_toggled=p._ffz_toggled,z._ffz_maybe_compress=p._ffz_compressed,z.volume=R,I&&(z.muted=!0),z.playsInline=!0,this.installPlaybackRate(z),p.replaceWith(z),h.attachHTMLVideoElement(z),z}hookPlayerLoad(h){!h||h._ffz_load||(h._ffz_load=h.load,h.load=(...p)=>{try{const z=h.getHTMLVideoElement();z?._ffz_compressor&&h.attachHTMLVideoElement&&(this.log.info("Recreating video element due to player load with compressor installed."),this.replaceVideoElement(h,z))}catch(z){t.log.error("Error while handling player load.",z)}return h._ffz_load(...p)})}compressPlayer(h,p){const z=h.props.mediaPlayerInstance,R=z.core||z,I=R?.mediaSinkManager?.video;if(!I||!r)return;this.hookPlayerLoad(z),h._ffz_setSrc||(h._ffz_setSrc=h.setSrc,h.setSrc=async function(...rt){console.log("setSrc",rt);const mt=h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;return mt&&mt._ffz_compressor&&await this.resetPlayer(h),h._ffz_setSrc(...rt)}),R._ffz_setVolume||(R._ffz_setVolume=R.setVolume,R._ffz_fakeVolume=()=>{}),I._ffz_maybe_compress=!1;const j=I._ffz_compressed||!1;let F=I._ffz_toggled?I._ffz_state:this.settings.get("player.compressor.default");if(p!=null&&(p.preventDefault(),I._ffz_toggled=!0,F=!I._ffz_compressed,I._ffz_state=F),I._ffz_compressor){if(!I._ffz_comp_reset&&!this.canCompress(h)){I._ffz_comp_reset=!0,this.resetPlayer(h);return}}else{if(!F)return;this.createCompressor(h,I)}let H=I._ffz_gain;const Y=n&&this.settings.get("player.gain.enable"),st=H!=null;if((F==j||p==null&&I._ffz_toggled)&&st==Y)return;const tt=I._ffz_context,it=I._ffz_compressor,ut=I._ffz_source;if(!(!tt||!it||!ut)){if(Y&&!H){let rt=I._ffz_gain_value;rt==null&&(rt=this.settings.get("player.gain.default"));try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;H=I._ffz_gain=new GainNode(tt,{gain:rt})}catch{this.log.info("Unable to use new GainNode. Falling back to old method."),H=I._ffz_gain=tt.createGain(),H.gain.value=rt}it.connect(H),j&&(it.disconnect(tt.destination),H.connect(tt.destination))}else!Y&&H&&(it.disconnect(H),j&&(H.disconnect(tt.destination),it.connect(tt.destination)),H=I._ffz_gain=null);F!=j&&(F?(ut.disconnect(tt.destination),ut.connect(it),H?(H.connect(tt.destination),this.settings.get("player.gain.no-volume")&&(I._ffz_pregain_volume=R.getVolume(),R._ffz_setVolume(1),R.setVolume=R._ffz_fakeVolume)):it.connect(tt.destination)):(ut.disconnect(it),H?(H.disconnect(tt.destination),I._ffz_pregain_volume!=null&&(R._ffz_setVolume(I._ffz_pregain_volume),R.setVolume=R._ffz_setVolume,I._ffz_pregain_volume=null)):it.disconnect(tt.destination),ut.connect(tt.destination))),h.props.containerRef&&(h.props.containerRef.dataset.compressed=F),I._ffz_compressed=F,this.addCompressorButton(h),this.addGainSlider(h)}}updateGainVolume(h){const p=h.props.mediaPlayerInstance,z=p.core||p,R=z?.mediaSinkManager?.video;if(!R||!R._ffz_compressed)return;const I=this.settings.get("player.gain.no-volume");I&&R._ffz_pregain_volume==null?(R._ffz_pregain_volume=z.getVolume(),z._ffz_setVolume(1),z.setVolume=z._ffz_fakeVolume):!I&&R._ffz_pregain_volume!=null&&(z._ffz_setVolume(R._ffz_pregain_volume),z.setVolume=z._ffz_setVolume,R._ffz_pregain_volume=null)}canCompress(h){if(!r)return!1;const p=h.props?.mediaPlayerInstance;if(p==null)return!1;const z=p.mediaSinkManager?.video||p.core?.mediaSinkManager?.video;return!(!z||!z.src&&!z.srcObject||z.src&&new URL(z.src).protocol!=="blob:")}createCompressor(h,p,z){if(!this.canCompress(h))return;let R=p._ffz_compressor;if(!R){if(z=z||new AudioContext,z.state==="suspended"){let j;const F=$(()=>{if(clearTimeout(j),z.removeEventListener("statechange",F),z.state==="suspended"){this.log.debug("Aborting due to browser auto-play policy.");return}this.createCompressor(h,p,z)},"evt");this.log.debug("Attempting to resume suspended AudioContext."),j=setTimeout(F,100);try{z.addEventListener("statechange",F),z.resume()}catch{}return}p._ffz_context=z;let I;try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;I=p._ffz_source=new MediaElementAudioSourceNode(z,{mediaElement:p})}catch{this.log.info("Unable to use new MediaElementAudioSourceNode. Falling back to old method."),I=p._ffz_source=z.createMediaElementSource(p)}I.connect(z.destination);try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;R=p._ffz_compressor=new DynamicsCompressorNode(z)}catch{this.log.info("Unable to use new DynamicsCompressorNode. Falling back to old method."),R=p._ffz_compressor=z.createDynamicsCompressor()}if(this.settings.get("player.gain.enable")){let j,F=p._ffz_gain_value;F==null&&(F=this.settings.get("player.gain.default"));try{if(this.settings.get("player.compressor.force-legacy"))throw new Error;j=p._ffz_gain=new GainNode(z,{gain:F})}catch{this.log.info("Unable to use new GainNode. Falling back to old method."),j=p._ffz_gain=z.createGain(),j.gain.value=F}R.connect(j)}p._ffz_compressed=!1}this.updateCompressor(null,R)}updateGains(){for(const h of this.Player.instances)this.updateGain(h)}updateGain(h,p,z,R=!0){if(z||(z=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video),p==null&&(p=z?._ffz_gain),!z||!p)return;let I=z._ffz_gain_value;I==null&&(I=this.settings.get("player.gain.default")),p.gain.value=I,R&&this.addGainSlider(h)}updateCompressors(){for(const h of this.Player.instances)this.updateCompressor(h)}updateCompressor(h,p){p==null&&(p=(h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video)?._ffz_compressor),p&&(p.threshold.value=this.settings.get("player.compressor.threshold"),p.knee.value=this.settings.get("player.compressor.knee"),p.ratio.value=this.settings.get("player.compressor.ratio"),p.attack.value=this.settings.get("player.compressor.attack"),p.release.value=this.settings.get("player.compressor.release"))}updatePlaybackRates(){for(const h of this.Player.instances)this.updatePlaybackRate(h)}updatePlaybackRate(h){const p=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;p.setFFZPlaybackRate||this.installPlaybackRate(p),p.setFFZPlaybackRate(p.playbackRate)}installPlaybackRate(h){if(h.setFFZPlaybackRate)return;let p=h.playbackRate;const z=this,R=$(()=>{z.settings.get("player.allow-catchup")||Object.defineProperty(h,"playbackRate",{configurable:!0,get(){return p},set(I){(I===1||I<1||I>=1.1)&&h.setFFZPlaybackRate(I)}})},"installProperty");h.setFFZPlaybackRate=I=>{delete h.playbackRate,p=I,h.playbackRate=I,R()}}addPiPButton(h,p=0){const z=h.props.containerRef||this.fine.getChildNode(h),R=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video,I=R&&document.fullscreenElement&&document.fullscreenElement.contains(R),j=z&&z.querySelector(v),F=document.pictureInPictureEnabled&&this.settings.get("player.button.pip");if(!j)return F&&p<5?setTimeout(this.addPiPButton.bind(this,h,(p||0)+1),250):void 0;let H,Y,st,tt=j.querySelector(".ffz--player-pip");if(!F){tt&&tt.remove();return}if(tt)H=tt.querySelector("figure"),st=tt.querySelector("button"),Y=tt.querySelector(".ffz-il-tooltip");else{tt=(0,y.createElement)("div",{class:"ffz--player-pip tw-inline-flex tw-relative ffz-il-tooltip__container"},st=(0,y.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-pip-button",onClick:this.pipPlayer.bind(this,h)},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,y.createElement)("div",{class:"tw-button-icon__icon"},H=(0,y.createElement)("figure",{class:"ffz-player-icon"})))),Y=(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const mt=j.querySelector('button[data-a-target="player-theatre-mode-button"]')||j.querySelector('button[aria-label*="Theat"]')||j.querySelector('button[data-a-target="player-fullscreen-button"]');mt?j.insertBefore(tt,mt.parentElement):j.appendChild(tt)}const it=!!document.pictureInPictureElement,ut=!1,rt=I?this.i18n.t("player.pip_button.fs","Cannot use Picture-in-Picture when Fullscreen"):ut?this.i18n.t("player.pip_button.swap","Switch Picture-in-Picture"):it?this.i18n.t("player.pip_button.off","Exit Picture-in-Picture"):this.i18n.t("player.pip_button","Picture-in-Picture");H.classList.toggle("ffz-i-t-pip-inactive",!it||ut),H.classList.toggle("ffz-i-t-pip-active",it&&!ut),st.setAttribute("aria-label",rt),Y.textContent=rt}pipPlayer(h,p){const z=h.props.mediaPlayerInstance?.mediaSinkManager?.video||h.props.mediaPlayerInstance?.core?.mediaSinkManager?.video;!z||!document.pictureInPictureEnabled||(p&&p.preventDefault(),!(document.fullscreenElement&&document.fullscreenElement.contains(z))&&(z._ffz_pip_enter||(z.addEventListener("enterpictureinpicture",z._ffz_pip_enter=()=>{this.addPiPButton(h)}),z.addEventListener("leavepictureinpicture",z._ffz_pip_exit=()=>{this.addPiPButton(h)})),document.pictureInPictureElement?document.exitPictureInPicture():z.requestPictureInPicture()))}addClipButton(h,p=0){const z=h.props.containerRef||this.fine.getChildNode(h),R=z&&z.querySelector(v),I=this.settings.get("player.clip-button.custom");if(!R)return I&&p<5?setTimeout(this.addClipButton.bind(this,h,(p||0)+1),250):void 0;let j,F,H=R.querySelector(".ffz--player-clip");if(!I){H&&H.remove();return}if((!R.ffz_native_clip||!R.contains(R.ffz_native_clip))&&(R.ffz_native_clip=e(R)),H)F=H.querySelector("button"),j=H.querySelector(".ffz-il-tooltip");else{const tt=$(ut=>{const rt=e(R);rt&&rt.click()},"on_click");H=(0,y.createElement)("div",{class:"ffz--player-clip tw-inline-flex tw-relative ffz-il-tooltip__container"},F=(0,y.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-clip-button",onClick:tt},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,y.createElement)("div",{class:"tw-button-icon__icon"},(0,y.createElement)("figure",{class:"ffz-player-icon ffz-i-clip"})))),j=(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const it=R.querySelector(".ffz--player-reset button")||R.querySelector(".ffz--player-pip button")||R.querySelector('button[data-a-target="player-theatre-mode-button"]')||R.querySelector('button[aria-label*="Theat"]')||R.querySelector('button[data-a-target="player-fullscreen-button"]');it?R.insertBefore(H,it.parentElement):R.appendChild(H)}const Y=R.ffz_native_clip,st=Y?Y.disabled||Y.ariaDisabled==="true":!1;F.disabled=st,F.setAttribute("aria-label",j.textContent=st?Y.ariaLabel||this.i18n.t("player.clip-button.disabled","Clips are Disabled"):this.i18n.t("player.clip-button","Clip (Alt+X)"))}clickClip(h,p){console.log("clicked clip",h,p)}addResetButton(h,p=0){const z=h.props.containerRef||this.fine.getChildNode(h),R=z&&z.querySelector(v),I=this.settings.get("player.button.reset");if(!R)return I&&p<5?setTimeout(this.addResetButton.bind(this,h,(p||0)+1),250):void 0;let j,F,H=R.querySelector(".ffz--player-reset");if(!I){H&&H.remove();return}if(H)F=H.querySelector("button"),j=H.querySelector(".ffz-il-tooltip");else{H=(0,y.createElement)("div",{class:"ffz--player-reset tw-inline-flex tw-relative ffz-il-tooltip__container"},F=(0,y.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-reset-button",onClick:c,onDblClick:this.resetPlayer.bind(this,h)},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,y.createElement)("div",{class:"tw-button-icon__icon"},(0,y.createElement)("figure",{class:"ffz-player-icon ffz-i-t-reset"})))),j=(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const Y=R.querySelector(".ffz--player-pip button")||R.querySelector('button[data-a-target="player-theatre-mode-button"]')||R.querySelector('button[aria-label*="Theat"]')||R.querySelector('button[data-a-target="player-fullscreen-button"]');Y?R.insertBefore(H,Y.parentElement):R.appendChild(H)}F.setAttribute("aria-label",j.textContent=this.i18n.t("player.reset_button","Reset Player (Double-Click)"))}addErrorResetButton(h,p=0){const z=h.props.containerRef||this.fine.getChildNode(h),R=z&&z.querySelector(".content-overlay-gate"),I=this.settings.get("player.button.reset");if(!R){if(!I)return;p<2&&this.parent.awaitElement(".autoplay-vod__content-container button",this.props.containerRef||t.fine.getChildNode(this),1e3).then(()=>{this.addErrorResetButton(h,(p||0)+1)}).catch(()=>{this.log.warn("Unable to find container element for Error Reset button.")});return}let j,F,H=R.querySelector(".ffz--player-reset");if(!I){H&&H.remove();return}H?(F=H.querySelector("button"),j=H.querySelector(".ffz-il-tooltip")):(H=(0,y.createElement)("div",{class:"ffz--player-reset tw-absolute tw-bottom-0 tw-right-0 ffz-il-tooltip__container tw-mg-1"},F=(0,y.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-reset-button",onClick:c,onDblClick:this.resetPlayer.bind(this,h)},(0,y.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,y.createElement)("div",{class:"tw-button-icon__icon"},(0,y.createElement)("figure",{class:"ffz-player-icon ffz-i-t-reset"})))),j=(0,y.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"})),R.appendChild(H)),F.setAttribute("aria-label",j.textContent=this.i18n.t("player.reset_button","Double-Click to Reset Player"))}resetAllPlayers(){for(const h of this.Player.instances)this.resetPlayer(h)}async resetPlayer(h,p){const z=h?h.mediaSinkManager||h.core?.mediaSinkManager?h:h?.props?.mediaPlayerInstance:null;if(p){p.preventDefault();const H=p.currentTarget,Y=H&&H.querySelector("figure");if(Y){if(Y.classList.contains("loading"))return;Y.classList.toggle("ffz-i-t-reset",!0),Y.classList.toggle("ffz-i-t-reset-clicked",!1),Y.classList.toggle("loading",!0),Y._ffz_unspin=setTimeout(()=>{Y._ffz_unspin=null,Y.classList.toggle("loading",!1)},1e4)}}const R=z.getDuration?.()??1/0;let I=-1;const j=z.core||z;j._ffz_setVolume&&(j.setVolume=j._ffz_setVolume),isFinite(R)&&!isNaN(R)&&R>0&&(I=z.getPosition());const F=z.mediaSinkManager?.video||z.core?.mediaSinkManager?.video;if(F?._ffz_compressor&&z.attachHTMLVideoElement){const H=this.replaceVideoElement(z,F);H._ffz_maybe_compress=!0}this.PlayerSource.check();for(const H of this.PlayerSource.instances)(!z||z===H.props?.mediaPlayerInstance)&&await H.setSrc({isNewMediaPlayerInstance:!1});I>0&&setTimeout(()=>z.seekTo(I),250)}addMetadata(h){this.metadata&&(h._ffz_md_update||(h._ffz_md_update=(0,_.debounce)(()=>requestAnimationFrame(()=>this._updateMetadata(h)),1e3,2)),h._ffz_md_update())}wantsMetadata(){return!1}_updateMetadata(h){h._ffz_cont&&!document.contains(h._ffz_cont)&&(h._ffz_cont=null);const p=this.wantsMetadata(h);if(!h._ffz_cont){if(!p)return;const z=h.props.containerRef||this.fine.getChildNode(h),R=z&&z.querySelector(v);if(!R)return;h._ffz_cont=(0,y.createElement)("div",{class:"ffz--player-meta-tray"}),R.insertBefore(h._ffz_cont,R.firstElementChild)}if(!p){h._ffz_cont.remove(),h._ffz_cont=null;return}this.updateMetadata(h)}updateMetadata(h,p){const z=h._ffz_cont;if(!z||!document.contains(z))return;p?Array.isArray(p)||(p=[p]):p=this.metadata.keys;const R=this.getData(),I=R?.props?.data?.user,j=h._ffz_meta_timers=h._ffz_meta_timers||{},F=$(Y=>this.updateMetadata(h,Y),"refresh_fn"),H={channel:{id:I?.id,login:R?.props?.channelLogin,display_name:I?.displayName,live:I?.stream?.id!=null,live_since:I?.stream?.createdAt},inst:h,source:R,getViewerCount:()=>0,getUserSelfImmediate:()=>null,getUserSelf:()=>null,getBroadcastID:()=>I?.id?this.getBroadcastID(h,I.id):null};for(const Y of p)this.metadata.renderPlayer(Y,H,z,j,F)}getUptime(h){let R=this.getData()?.props?.data?.user?.stream?.createdAt;return R?(R instanceof Date||(R=new Date(R)),(Date.now()-R.getTime())/1e3):null}getBroadcastID(h,p){if(!this.twitch_data)return Promise.resolve(null);const z=h._ffz_bcast_cache=h._ffz_bcast_cache||{};return p===z.channel_id&&Date.now()-z.saved<6e4?Promise.resolve(z.broadcast_id):new Promise(async(R,I)=>{if(z.updating){z.updating.push([R,I]);return}z.channel_id=p,z.updating=[[R,I]];let j,F;try{j=await this.twitch_data.getBroadcastID(p)}catch(Y){j=null,F=Y}const H=z.updating;if(z.updating=null,z.channel_id!==p){F=new Error("Outdated"),z.channel_id=null,z.broadcast_id=null,z.saved=0;for(const Y of H)Y[1](F);return}z.broadcast_id=j,z.saved=Date.now();for(const Y of H)F?Y[1](F):Y[0](j)})}get playerUI(){return this.fine.searchTree(this.Player.first,p=>p.props&&p.props.uiContext,150)?.props?.uiContext}get current(){for(const h of this.Player.instances)if(h?.props?.mediaPlayerInstance)return h.props.mediaPlayerInstance;return null}};$(m,"PlayerBase");let d=m},89196:(q,T,f)=>{"use strict";f.d(T,{Z:()=>j});var N=f(33612),y=f(22527),_=f(46949),E=f(24431);const A=Symbol("FFZRequires"),b={};function v(W){return b[W]||(b[W]=new RegExp(`\\b(?<!\\.)${W}\\(([0-9e_+]+)\\)`,"g")),b[W]}$(v,"getRequireRegex");const r=["webpackJsonp","webpackChunktwitch_twilight","webpackChunktwitch_sunlight","webpackJsonp_N_E"],n=[[0,"vendor"],[1,"core"]];let s=0;const st=class st extends y.default{constructor(...L){super(...L),this._id=`_ffz$${s++}`,this._rid=0,this._original_loader=null,this._known_rules={},this._require=null,this._chunk_names={},this._mod_cache={},this._checked_module={},this._required_ids=new Set,this._known_ids=new Set,this.Requires=A,this.v4=null,this.hookLoader(),this.hookRequire()}waitForLoader(){if(this._original_loader)return Promise.resolve();const L=this._load_waiters=this._load_waiters||[];return new Promise((Z,nt)=>L.push([Z,nt]))}_resolveLoadWait(L){const Z=this._load_waiters;if(this._load_waiters=null,Z)for(const nt of Z)nt[L?1:0]()}hookLoader(L=0){if(this._original_loader)return this.log.warn("Attempted to call hookLoader twice.");let Z;for(const at of r)if(window[at]){Z=at;break}if(!Z){if(L>240){this.log.error("Unable to find webpack's loader after one minute.");try{const at=[];for(const ft of Object.keys(window))(0,_.has)(window,ft)&&typeof ft=="string"&&/webpack/i.test(ft)&&!/ffz/i.test(ft)&&at.push(ft);at.length?this.log.info("Possible Matches: ",at.join(", ")):this.log.info("No possible matches found.")}catch{}this._resolveLoadWait(!0);return}return setTimeout(this.hookLoader.bind(this,L+1),250)}const nt=window[Z];if(typeof nt=="function"){this.v4=!1,this._original_loader=nt;try{window[Z]=this.webpackJsonpv3.bind(this)}catch{this.log.warn("Unable to wrap webpackJsonp due to write protection."),this._resolveLoadWait(!0);return}}else if(Array.isArray(nt)){this.v4=!0,this._original_store=nt,this._original_loader=nt.push;for(const at of nt)at&&at[1]&&this.processModulesV4(at[1],!0);try{nt.push=this.webpackJsonpv4.bind(this)}catch{this.log.warn("Unable to wrap webpackJsonp (v4) due to write protection."),this._resolveLoadWait(!0);return}}else{this.log.error("webpackJsonp is of an unknown value. Unable to wrap."),this._resolveLoadWait(!0);return}this._resolveLoadWait(),this.log.info(`Found and wrapped webpack's loader after ${(L||0)*250}ms.`)}webpackJsonpv3(L,Z){const nt=L.map(ft=>this._chunk_names[ft]||ft).join(", ");this.log.verbose(`Twitch Chunk Loaded: ${L} (${nt})`),this.log.verbose(`Modules: ${Object.keys(Z)}`);const at=this._original_loader.apply(window,arguments);return this.emit(":loaded",L,nt,Z),at}_resolveRequire(L){if(!this._require&&(this._require=L,this._resolve_require)){for(const Z of this._resolve_require)Z(L);this._resolve_require=null}}processModulesV4(L){const Z=this;for(const[nt,at]of Object.entries(L))this._known_ids.add(nt)}webpackJsonpv4(L){const Z=L[0],nt=L[1],at=Array.isArray(Z)&&Z.map(lt=>this._chunk_names[lt]||lt);this.log.verbose(`Twitch Chunk Loaded: ${Z} (${at.join(", ")})`),this.log.verbose(`Modules: ${Object.keys(nt)}`),nt&&this.processModulesV4(nt,!1);for(const[lt,ht]of Object.entries(this._checked_module))ht==!0&&(this._checked_module[lt]=null);const ft=this._original_loader.apply(this._original_store,arguments);return this.emit(":loaded",Z,at,nt),ft}known(L,Z){if(typeof L=="object"){for(const nt in L)(0,_.has)(L,nt)&&this.known(nt,L[nt]);return}this._known_rules[L]=Z}async findModule(L,Z){return this._require||await this.getRequire(),this.getModule(L,Z)}findDeep(L,Z,nt=!0){if(L&&!Array.isArray(L)&&(L=[L]),!this._require||!this.v4||!this._original_store)return new Error("We do not have webpack");const at=[],ft=this._chunk_names;for(const[lt,ht]of this._original_store){if(L){let pt=!1;for(const _t of lt)if(L.includes(_t)||L.includes(`${_t}`)||ft[_t]&&L.includes(ft[_t])){pt=!0;break}if(!pt)continue}for(const pt of Object.keys(ht))try{const _t=this._require(pt);for(const Ct in _t)if(_t[Ct]&&Z(_t[Ct],_t,Ct)){if(this.log.info(`Found in key "${Ct}" of module "${pt}" (${this.chunkNameForModule(pt)})`),!nt)return _t;at.push(_t);break}}catch(_t){this.log.warn("Exception while deep scanning webpack.",_t)}}return at.length?at:(this.log.info("Unable to find deep scan target."),null)}getModule(L,Z){if(typeof L=="function"&&(Z=L,L=null),L&&this._mod_cache[L])return this._mod_cache[L];const nt=this._require;if(!nt)return null;if(Z||(Z=this._known_rules[L]),!Z)throw new Error(`no known predicate for locating ${L}`);if(nt.c)return this._oldGetModule(L,Z,nt);if(nt.m)return this._newGetModule(L,Z,nt)}_chunksForModule(L){if(!this.v4||!this._original_store)return null;const Z=new Set;for(const[nt,at]of this._original_store)if(at[L])for(const ft of nt)Z.add(ft);return[...Z]}chunkNameForModule(L){const Z=this._chunksForModule(L);if(!Z)return null;for(const nt of Z){const at=this._chunk_names[nt];if(at)return at}return null}chunkNamesForModule(L){const Z=this._chunksForModule(L);return Z?Z.map(nt=>this._chunk_names[nt]||nt):null}_oldGetModule(L,Z,nt){if(!nt||!nt.c)return null;let at;if(this._original_store&&Z.chunks&&this._chunk_names&&Object.keys(this._chunk_names).length){const lt=typeof Z.chunks=="function";!lt&&!Array.isArray(Z.chunks)&&(Z.chunks=[Z.chunks]);const ht=Z.chunks,pt=this._chunk_names;at=[];for(const[_t,Ct]of this._original_store){let jt=!1;for(const It of _t)if(lt?ht(pt[It],It):ht.includes(It)||ht.includes(String(It))||pt[It]&&ht.includes(pt[It])){jt=!0;break}jt&&(at=[...at,...Object.keys(Ct)])}at=new Set(at)}else at=Object.keys(nt.c);let ft=0;for(const lt of at)if((0,_.has)(nt.c,lt)){ft++;const ht=nt.c[lt],pt=ht&&ht.exports;if(pt){const _t=Z(pt);if(_t){this.log.debug(`[Old] Located module "${L}" in module ${lt}${E.DEBUG?` (${this.chunkNameForModule(lt)})`:""} after ${ft} tries`);const Ct=Z.use_result?_t:pt;return L&&(this._mod_cache[L]=Ct),Ct}}}return this.log.debug(`[Old] Unable to locate module "${L}" despite checking ${ft} modules`),null}_newGetModule(L,Z,nt){if(!nt)return null;let at=this._known_ids;if(this._original_store&&Z.chunks&&this._chunk_names&&Object.keys(this._chunk_names).length){const lt=typeof Z.chunks=="function";!lt&&!Array.isArray(Z.chunks)&&(Z.chunks=[Z.chunks]);const ht=Z.chunks,pt=this._chunk_names;at=[];for(const[_t,Ct]of this._original_store){let jt=!1;for(const It of _t)if(lt?ht(pt[It],It):ht.includes(It)||ht.includes(String(It))||pt[It]&&ht.includes(pt[It])){jt=!0;break}jt&&(at=[...at,...Object.keys(Ct)])}at=new Set(at)}let ft=0;for(const lt of at)try{if(ft++,!this._required_ids.has(lt)){let pt=this._checked_module[lt];if(pt==null&&(pt=this._checkModule(lt)),pt)continue}this._required_ids.add(lt),nt.m[lt]||this.log.warn("Tried requiring module that isn't loaded",lt);const ht=nt(lt);if(ht){const pt=Z(ht);if(pt){this.log.debug(`Located module "${L}" in module ${lt}${E.DEBUG?` (${this.chunkNameForModule(lt)})`:""} after ${ft} tries`);const _t=Z.use_result?pt:ht;return L&&(this._mod_cache[L]=_t),_t}}}catch(ht){this.log.warn("Unexpected error trying to find module",ht)}return this.log.debug(`Unable to locate module "${L}" despite checking ${ft} modules`),null}_checkModule(L,Z=null){if(Z){if(Z.has(L))return this._checked_module[L]??!1;Z.add(L)}let nt=this._require?.m?.[L];if(nt){nt.original&&(nt=nt.original);let at=nt[A],ft=!1;if(at==null){const lt=nt.toString(),ht=/^function\([^,)]+,[^,)]+,([^,)]+)/.exec(lt);if(ht){const pt=v(ht[1]);at=nt[A]=new Set,pt.lastIndex=0;let _t;for(;_t=pt.exec(lt);){let Ct=_t[1];if(Ct!=="e"){if(/^\d+e\d+$/.test(Ct)){const jt=Ct.split("e");Ct=`${parseInt(jt[0],10)*10**parseInt(jt[1],10)}`}at.add(Ct),!ft&&!this._require.m[Ct]&&(this.log.verbose(`Unable to load module ${L} due to missing dependency ${Ct}`),ft=!0)}}}else nt[A]=!1}else if(at){for(const lt of at)if(!this._require.m[lt]){ft=!0;break}}if(!ft&&at){Z||(Z=new Set,Z.add(L));for(const lt of at){let ht=this._checked_module[lt];if(ht==null&&!Z.has(lt))try{ht=this._checkModule(lt,Z)}catch{this.log.verbose(`Recursion error checking module ${L} (${lt})`),ht=!0}if(ht){this.log.verbose(`Unable to load module ${L} due to unable to load dependency ${lt}`),ft=!0;break}}}return this._checked_module[L]=ft}return this._checked_module[L]=!0}getRequire(L=0){return this._require?Promise.resolve(this._require):new Promise((Z,nt)=>{let at=this._original_loader;if(!at)return L>500&&nt(new Error("unable to find webpackJsonp")),setTimeout(()=>this.getRequire(L++).then(Z),250);this.v4&&(at=at.bind(this._original_store));const ft=`ffz-loader$${(0,_.generateUUID)()}`;at([[ft],{[ft]:(lt,ht,pt)=>{Z(this._require=pt)}},lt=>lt(ft)])})}async hookRequire(){const L=performance.now(),Z=await this.getRequire(),nt=performance.now()-L;this.log.info(`require() grabbed in ${nt.toFixed(5)}ms.`);const at=Z.e&&Z.e.toString();let ft;if(at&&at.indexOf("Loading chunk")!==-1){const lt=this.v4?/assets\/"\+\(?({1:.*?})/.exec(at):/({0:.*?})/.exec(at);if(lt)try{ft=JSON.parse(lt[1].replace(/(\d+):/g,'"$1":'))}catch{}}else if(Z.u){const lt=Z.u.toString(),ht=/assets\/"\+\(?({\d+:.*?})/.exec(lt),pt=ht?ht[1].replace(/([\de]+):/g,(_t,Ct)=>{if(/^\d+e\d+$/.test(Ct)){const jt=Ct.split("e");Ct=parseInt(jt[0],10)*10**parseInt(jt[1],10)}return`"${Ct}":`}):null;if(pt)try{ft=JSON.parse(pt)}catch(_t){console.log(pt),console.log(_t)}}if(ft){if(this._original_store)for(const[lt,ht]of n){const pt=this._original_store[lt]?.[0];if(Array.isArray(pt))for(const _t of pt)typeof _t!="object"&&!ft[_t]&&(ft[_t]=ht)}this._chunk_names=ft,this.log.debug(`Loaded names for ${Object.keys(ft).length} chunks from require().`)}else this.log.warn("Unable to find chunk names in require().")}};$(st,"WebMunch");let i=st;i.Requires=A;var e=f(17159);const tt=class tt extends y.default{constructor(L,Z){super(L,Z),this._pruneLive=this._pruneLive.bind(this),this._wrappers=new Map,this._observer=null,this._watching=new Set,this._live_watching=null}onDisable(){this._stopWatching()}define(L,Z,nt,at=null,ft=0,lt=5e3,ht=!0){if(this._wrappers.has(L))return this._wrappers.get(L);if(!Z||typeof Z!="string"||!Z.length)throw new Error("cannot find definition and no selector provided");const pt=new c(L,Z,nt,at,ft,lt,ht,this);return this._wrappers.set(L,pt),pt}route(L){this._route=L,this._timer=Date.now(),this._updateLiveWatching(),this.checkAll(),this.cleanAll()}cleanAll(){this._clean_all&&cancelAnimationFrame(this._clean_all),this._clean_all=requestAnimationFrame(()=>{this._clean_all=null;for(const L of this._wrappers.values())L.clean()})}checkAll(){if(this._watching)for(const L of this._watching)L.check()}updateTimeout(){this._timer=Date.now(),this._updateLiveWatching(),this.checkAll()}_isActive(L,Z){return!(L.routes===!1||this._route&&L.routes.length&&!L.routes.includes(this._route)||L.timeout>0&&Z-this._timer>L.timeout)}_updateLiveWatching(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null);const L=this._live_watching=[],Z=Date.now();let nt=Number.POSITIVE_INFINITY;if(this._watching)for(const at of this._watching)this._isActive(at,Z)&&(at.timeout>0&&at.timeout<nt&&(nt=at.timeout),L.push(at));isFinite(nt)&&(this._timeout=setTimeout(this._pruneLive,nt)),L.length?this._observer||this._startWatching():this._stopWatching()}_pruneLive(){this._updateLiveWatching()}_checkWatchers(L){if(this._live_watching)for(const Z of this._live_watching)Z.checkElements(L)}_startWatching(){!this._observer&&this._live_watching&&this._live_watching.length&&(this.log.info("Installing MutationObserver."),this._observer=new MutationObserver(L=>this._checkWatchers(L.map(Z=>Z.target))),this._observer.observe(document.body,{childList:!0,subtree:!0}))}_stopWatching(){this._observer&&(this.log.info("Stopping MutationObserver."),this._observer.disconnect()),this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._live_watching=null,this._observer=null}listen(L,Z=!0){this._watching.has(L)||(Z&&(this._timer=Date.now()),this._watching.add(L),this._updateLiveWatching())}unlisten(L){this._watching.has(L)&&(this._watching.delete(L),this._updateLiveWatching())}};$(tt,"Elemental");let o=tt,a=0;const it=class it extends e.EventEmitter{constructor(L,Z,nt,at,ft,lt,ht,pt){super(),this.id=a++,this.param=`_ffz$elemental$${this.id}`,this.remove_param=`_ffz$elemental_remove$${this.id}`,this._schedule=this._schedule.bind(this),this.name=L,this.selector=Z,this.routes=nt??[],this.opts=at,this.limit=ft,this.timeout=lt,this.check_removal=ht,this.opts&&!this.opts.childList&&!this.opts.attributes&&!this.opts.characterData&&(this.opts.attributes=!0),this.count=0,this.instances=new Set,this.elemental=pt,this.check(),this.schedule()}get atLimit(){return this.limit>0&&this.count>=this.limit}clean(){const L=Array.from(this.instances);for(const Z of L)document.contains(Z)||this.remove(Z)}schedule(){this._stimer||(this._stimer=setTimeout(this._schedule,0))}_schedule(){this._stimer&&clearTimeout(this._stimer),this._stimer=null,this.limit===0||this.count<this.limit?this.elemental.listen(this):this.elemental.unlisten(this)}check(){const L=document.querySelectorAll(this.selector);for(const Z of L)this.add(Z)}checkElements(L){if(this.atLimit)return this.schedule();for(const Z of L){const nt=Z.querySelectorAll(this.selector);for(const at of nt)this.add(at);if(this.atLimit)return}}get first(){for(const L of this.instances)return L;return null}toArray(){return Array.from(this.instances)}each(L){for(const Z of this.instances)L(Z)}add(L){if(!this.instances.has(L)){if(this.instances.add(L),this.count++,this.check_removal&&L.parentNode){const Z=new MutationObserver(()=>{requestAnimationFrame(()=>{document.contains(L)||this.remove(L)})});Z.observe(L.parentNode,{childList:!0}),L[this.remove_param]=Z}if(this.opts){const Z=new MutationObserver(nt=>{document.contains(L)?this.__running.size||this.emit("mutate",L,nt):this.remove(L)});Z.observe(L,this.opts),L[this.param]=Z}this.schedule(),this.emit("mount",L)}}remove(L){const Z=L[this.param];Z&&(Z.disconnect(),L[this.param]=null);const nt=L[this.remove_param];nt&&(nt.disconnect(),L[this.remove_param]=null),this.instances.has(L)&&(this.instances.delete(L),this.count--,this.schedule(),this.emit("unmount",L))}};$(it,"ElementalWrapper");let c=it;var d=f(98247),m=f(45866),w=f(29632),h=f(27040);const ut=class ut extends e.FFZEvent{constructor(L){super(L),this._obj=void 0,this._changed=!1}markChanged(){this._changed=!0}get topic(){return this.event.topic}get message(){return this._obj===void 0&&(this._obj=JSON.parse(this.event.message)??null),this._obj}set message(L){this._obj=L,this._changed=!0}};$(ut,"PubSubEvent");let p=ut;const rt=class rt extends y.default{constructor(L,Z){super(L,Z),this.instance=null}onEnable(L=0){const Z=window.__twitch_pubsub_client;if(!Z){L>10?this.log.warn("Unable to find PubSub."):new Promise(nt=>setTimeout(nt,50)).then(()=>this.onEnable(L+1));return}Z&&(this.instance=Z,this.hookClient(Z)),this.instance||this.log.warn("Unable to find a PubSub instance.")}handleMessage(L){try{if(L.type==="MESSAGE"&&L.data?.topic){const Z=L.data.topic,nt=Z.indexOf("."),at=nt===-1?Z:Z.slice(0,nt),ft=nt===-1?"":Z.slice(nt+1),lt=new p({prefix:at,trail:ft,event:L.data});if(this.emit(":pubsub-message",lt),lt.defaultPrevented)return!0;lt._changed&&(L.data.message=JSON.stringify(lt._obj))}}catch(Z){this.log.error("Error processing PubSub event.",Z)}return!1}hookClient(L){const Z=this,nt=L.onMessage;L.connection.removeAllListeners("message"),L.onMessage=function(lt){if(!Z.handleMessage(lt))return nt.call(this,lt)},L.connection.addListener("message",L.onMessage);const at=L.listen,ft=L.unlisten;L.ffz_original_listen=at,L.ffz_original_unlisten=ft,L.listen=function(lt,ht,...pt){const _t=lt.topic,Ct=_t&&!!L.topicListeners?._events?.[_t],jt=at.call(this,lt,ht,...pt);return _t&&!Ct&&Z.emit(":add-topic",_t),jt},L.unlisten=function(lt,ht,...pt){const _t=!!L.topicListeners?._events?.[lt],Ct=ft.call(this,lt,ht,...pt);return _t&&!L.topicListeners?._events?.[lt]&&Z.emit(":remove-topic",lt),Ct}}simulateMessage(L,Z){if(!this.instance)throw new Error("No PubSub instance available");this.instance.simulateMessage(L,JSON.stringify(Z))}get topics(){const L=this.instance?.topicListeners?._events;return L?Object.keys(L):[]}};$(rt,"Subpump");let z=rt;var R=f(44589);const I=f.p+"main.css",mt=class mt extends N.Z{constructor(...L){super(...L),this.inject(i),this.inject(d.Z),this.inject(o),this.inject("router",m.Z),this.inject(w.default,!1),this.inject(h.default),this.inject(z),this._dom_updates=[]}async populateModules(){const L=await f(41152),Z=await this.loadFromContext(L,this.log);this.log.info(`Loaded descriptions of ${Object.keys(Z).length} modules.`)}async onLoad(){await this.populateModules(),this.web_munch.known(mt.KNOWN_MODULES),this.router.route(mt.ROUTES),this.router.routeName(mt.ROUTE_NAMES),this.router.route("user","/:userName",null,L=>L?.channelView!=="Home"),this.router.route("user-home","/:userName",null,L=>L?.channelView==="Home"),this.router.route(mt.DASH_ROUTES,"dashboard.twitch.tv"),this.router.route(mt.PLAYER_ROUTES,"player.twitch.tv"),this.router.route(mt.CLIP_ROUTES,"clips.twitch.tv")}onEnable(){this.settings=this.resolve("settings"),this.web_munch.findModule("simplebar").then(ht=>{!window.ffzSimplebar&&ht&&(window.ffzSimplebar=ht)}).catch(()=>{});const L=this.fine.searchNode(null,ht=>ht?.pendingProps?.store?.getState),Z=this.store=L?.pendingProps?.store;if(!Z)return new Promise(ht=>setTimeout(ht,50)).then(()=>this.onEnable());this.on(":dom-update",(...ht)=>{this._dom_updates.push(ht),this._dom_frame||(this._dom_frame=requestAnimationFrame(()=>{const pt=this._dom_updates,_t=this.resolve("core");this._dom_updates=[],this._dom_frame=null;for(const[Ct,jt]of pt){const It=this.fine.getChildNode(jt);_t.emit("core:dom-update",Ct,It,jt)}}))});const nt=$(()=>this.settings.updateContext({size:{height:window.innerHeight,width:window.innerWidth}}),"update_size");window.addEventListener("resize",nt),nt();const at=$(()=>{this.settings.updateContext({fullscreen:!!document.fullscreenElement}),this.emit(":fullscreen")},"update_fullscreen");document.addEventListener("fullscreenchange",at),this.settings.updateContext({fullscreen:!!document.fullscreenElement}),Z.subscribe(()=>this.updateContext()),this.updateContext(),this.router.on(":route",(ht,pt)=>{this.log.info("Navigation",ht&&ht.name,pt&&pt[0]),this.fine.route(ht&&ht.name),this.elemental.route(ht&&ht.name),this.settings.updateContext({route:ht,route_data:pt})});const ft=this.router.current;this.fine.route(ft&&ft.name),this.elemental.route(ft&&ft.name),this.settings.updateContext({route:ft,route_data:this.router.match}),document.head.appendChild((0,R.createElement)("link",{href:I,rel:"stylesheet",type:"text/css",crossOrigin:"anonymous"}));const lt=new URL(window.location).searchParams;if(lt&&(lt.has("ffz-settings")&&this.resolve("main_menu").openExclusive(),lt.has("ffz-translate"))){const ht=this.resolve("translation_ui");ht.dialog.exclusive=!0,ht.enable()}}updateContext(){try{const L=this.store.getState(),Z=this.router&&this.router.history;this.settings.updateContext({location:Z&&Z.location,ui:L&&L.ui,session:L&&L.session,chat:L&&L.chat})}catch(L){this.log.error("Error updating context.",L)}}getSession(){const L=this.store&&this.store.getState();return L&&L.session}getUser(){if(this._user)return this._user;const L=this.getSession();return this._user=L&&L.user}getCore(){return this._core||(this._core=this.web_munch.getModule("core")),this._core}};$(mt,"Twilight");let j=mt;const F="_calculateChangedBits";j.KNOWN_MODULES={simplebar:W=>W.globalObserver&&W.initDOMLoadedElements,react:W=>W.Component&&W.createElement,"react-dom":W=>W.createRoot&&W.createPortal,core:W=>{if(W.x2?.experiments&&W.x2.intl)return W.x2;if(W.$6?.experiments)return W.$6;if(W.p?.experiments)return W.p;if(W.o?.experiments)return W.o;if(W.q?.experiments)return W.q},cookie:W=>W&&W.set&&W.get&&W.getJSON&&W.withConverter,"extension-service":W=>W.extensionService,"callout-types":W=>{if(W.o?.ClipLiveNudge&&W.o?.Drop&&W.o?.ShareResub)return W.o},"chat-types":W=>{if((0,_.has)(W.ZW,"Message")&&(0,_.has)(W.ZW,"RoomMods"))return{automod:W.sq,chat:W.ZW,message:W.IF,mod:W.RB};if((0,_.has)(W.b,"Message")&&(0,_.has)(W.b,"RoomMods"))return{automod:W.a,chat:W.b,message:W.c,mod:W.e};if((0,_.has)(W.SJ,"Message")&&(0,_.has)(W.SJ,"RoomMods"))return{automod:W.mT,chat:W.SJ,message:W.Ay,mod:W.Aw}},"gql-printer":W=>{if(W!==window){if(W.print&&W.print.toString().includes(".visit"))return W.print;if(W.S&&W.S.toString().includes(".visit"))return W.S}},"user-report":W=>W.Z?.displayName==="Loadable(ReportUserModal)"&&W.Z,"sub-form":W=>typeof W.T=="function"&&String(W.T).includes("CheckoutModal")&&W.T,mousetrap:W=>W.bindGlobal&&W.unbind&&W.handleKey,"algolia-search":W=>{if(W.a?.prototype?.queryTopResults&&W.a.prototype.queryForType)return W.a;if(W.w9?.prototype?.queryTopResults&&W.w9.prototype.queryForType)return W.w9},calloutstack:W=>{if((0,_.has)(W.at?._currentValue,"callouts")&&typeof W.at._currentValue.pinCallout=="function")return{stack:W.at}},highlightstack:W=>{if((0,_.has)(W.g$?._currentValue,"highlights")&&typeof W.SP?._currentValue=="function")return{stack:W.g$,dispatch:W.SP};if((0,_.has)(W.b,F)&&(0,_.has)(W.c,F))return{stack:W.b,dispatch:W.c};if((0,_.has)(W.fQ,F)&&(0,_.has)(W.vJ,F))return{stack:W.fQ,dispatch:W.vJ};if((0,_.has)(W.fQ?._currentValue,"highlights")&&typeof W.vJ?._currentValue=="function")return{stack:W.fQ,dispatch:W.vJ}}};const H=$(W=>!W||W.includes("vendor")||W.includes("core"),"VEND_CORE");j.KNOWN_MODULES.core.use_result=!0,j.KNOWN_MODULES.core.skip_cache=!0,j.KNOWN_MODULES.simplebar.chunks=H,j.KNOWN_MODULES.react.chunks=H,j.KNOWN_MODULES.cookie.chunks=H,j.KNOWN_MODULES["gql-printer"].use_result=!0,j.KNOWN_MODULES["gql-printer"].chunks=H,j.KNOWN_MODULES.mousetrap.chunks=H;const Y=$(W=>!W||W.includes("chat"),"CHAT_CHUNK");j.KNOWN_MODULES["callout-types"].use_result=!0,j.KNOWN_MODULES["chat-types"].use_result=!0,j.KNOWN_MODULES["chat-types"].chunks=Y,j.KNOWN_MODULES.calloutstack.use_result=!0,j.KNOWN_MODULES.highlightstack.use_result=!0,j.KNOWN_MODULES.highlightstack.chunks=Y,j.KNOWN_MODULES["algolia-search"].use_result=!0,j.KNOWN_MODULES["algolia-search"].chunks="core",j.KNOWN_MODULES["user-report"].use_result=!0,j.KNOWN_MODULES["user-report"].chunks=W=>!W||W.includes("core")||W.includes("common"),j.KNOWN_MODULES["sub-form"].use_result=!0,j.KNOWN_MODULES["sub-form"].chunks="core",j.POPOUT_ROUTES=["embed-chat","popout","dash-popout-chat","mod-popout-chat"],j.CHAT_ROUTES=["collection","popout","dash-chat","video","user-video","user-home","user-clip","user-videos","user-clips","user-events","user-followers","user-following","user","dash","embed-chat","squad","command-center","dash-stream-manager","dash-popout-chat","mod-view","mod-popout-chat"],j.ROUTE_NAMES={dir:"Browse","dir-following":"Following","dir-all":"Browse Live Channels",dash:"Dashboard",popout:"Popout Chat","dash-popout-chat":"Dashboard Popout Chat","user-video":"Channel Video","popout-player":"Popout/Embed Player"},j.SUNLIGHT_ROUTES=["dash-stream-manager","dash-channel-analytics","dash-stream-summary","dash-achievements","dash-roles","dash-activity","dash-channel-points","dash-video-producer","dash-edit-video","dash-collections","dash-edit-collection","dash-clips","dash-settings-moderation","dash-settings-channel","dash-settings-revenue","dash-extensions","dash-streaming-tools"],j.PLAYER_ROUTES={"popout-player":"/"},j.CLIP_ROUTES={"clip-page":"/:slug"},j.DASH_ROUTES={"dash-stream-manager":"/u/:userName/stream-manager","dash-channel-analytics":"/u/:userName/channel-analytics","dash-stream-summary":"/u/:userName/stream-summary","dash-achievements":"/u/:userName/achievements","dash-roles":"/u/:userName/community/roles","dash-activity":"/u/:userName/community/activity","dash-channel-points":"/u/:userName/community/channel-points","dash-video-producer":"/u/:userName/content/video-producer","dash-edit-video":"/u/:userName/content/video-producer/edit/:videoID","dash-collections":"/u/:userName/content/collections","dash-edit-collection":"/u/:userName/content/collections/:collectionID","dash-clips":"/u/:userName/content/clips","dash-settings-moderation":"/u/:userName/settings/moderation","dash-settings-channel":"/u/:userName/settings/channel","dash-settings-revenue":"/u/:userName/settings/revenue","dash-extensions":"/u/:userName/extensions","dash-streaming-tools":"/u/:userName/broadcast","dash-popout-chat":"/popout/u/:userName/stream-manager/chat"},j.ROUTES={"front-page":"/",collection:"/directory/collection/:collectionID",dir:"/directory","dir-gaming":"/directory/gaming","dir-irl":"/directory/irl","dir-music":"/directory/music","dir-creative":"/directory/creative","dir-esports":"/directory/esports","dir-following":"/directory/following/:category?","dir-game-index":"/directory/category/:gameName","dir-game-clips":"/directory/category/:gameName/clips","dir-game-videos":"/directory/category/:gameName/videos/:filter","dir-all":"/directory/all/:filter?",dash:"/:userName/dashboard/:live?",event:"/event/:eventName",popout:"/popout/:userName/chat",video:"/videos/:videoID","user-video":"/:userName/video/:videoID","user-videos":"/:userName/videos/:filter?","user-clips":"/:userName/clips","user-clip":"/:userName/clip/:clipID","user-collections":"/:userName/collections","user-events":"/:userName/events","user-followers":"/:userName/followers","user-following":"/:userName/following",product:"/products/:productName",prime:"/prime",turbo:"/turbo",search:"/search",squad:"/:userName/squad","command-center":"/:userName/commandcenter","embed-chat":"/embed/:userName/chat","mod-view":"/moderator/:userName","mod-popout-chat":"/popout/moderator/:userName/chat"},j.DIALOG_EXCLUSIVE=".moderation-root,.sunlight-root,.twilight-main,.twilight-minimal-root>div,#root>div>.tw-full-height,.clips-root,#root",j.DIALOG_MAXIMIZED='.moderation-view-page > div[data-highlight-selector="main-grid"],.sunlight-page,.twilight-main,.twilight-minimal-root,#root .dashboard-side-nav+.tw-full-height,.clips-root>.tw-full-height .scrollable-area,.teams-page-body__outer-container .scrollable-area',j.DIALOG_SELECTOR=".moderation-root,.sunlight-root,#root,.twilight-minimal-root>.tw-full-height,.clips-root>.tw-full-height .scrollable-area"},24531:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>y});var N=f(22527);const _=class _ extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...A){super(...A),this.should_enable=!0,this.inject("settings"),this.inject("site.fine"),this.settings.add("layout.display-bits-button",{requires:["chat.bits.show"],default:null,process(b,v){return v??b.get("chat.bits.show")},ui:{path:"Appearance > Layout >> Top Navigation",title:"Show the Get Bits button.",description:"By default, this inherits its value from [Chat > Bits and Cheering > Display Bits](~chat.bits_and_cheering)",component:"setting-check-box"},changed:()=>this.BitsButton.forceUpdate()}),this.BitsButton=this.fine.define("bits-button",b=>b.toggleBalloon&&b.toggleShowTutorial)}onEnable(){this.BitsButton.ready(A=>{const b=this,v=A.prototype.render;A.prototype.render=function(){return b.settings.get("layout.display-bits-button")?v.call(this):null},this.BitsButton.forceUpdate()})}};$(_,"BitsButton");let y=_},11746:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>E});var N=f(46949),y=f(22527);const _=/^8(102|363)$/.test(f.j)?["chat-input"]:null,A=class A extends(/^8(102|363)$/.test(f.j)?y.default:null){constructor(...v){super(...v),this.inject("settings"),this.should_enable=!0}onEnable(){this.on("core:dom-update",this.handleDomUpdate,this),this.hookSettings()}awaitSettings(v=0){return window.BetterTTV?.settings?window.BetterTTV.settings:v>100?Promise.reject():(0,N.sleep)(50).then(()=>this.awaitSettings(v+1))}async hookSettings(){const v=await this.awaitSettings(),r=$(()=>this.updateContext(v),"waiter");if(v.on("changed.clickTwitchEmotes",r),v.on("changed.bttvGIFEmotes",r),r(),v.get("ffzEmotes")){if(this.settings.provider.get("bttv-ffz-notice"))return;const n=this.resolve("site.menu_button");n&&(n.addToast({icon:"ffz-i-zreknarf",text_i18n:"compat.bttv.emotes-on",text:`You have "FrankerFaceZ Emotes" turned on in BetterTTV's settings, but you also have FrankerFaceZ installed. Please disable "FrankerFaceZ Emotes" in BetterTTV's settings. It isn't necessary.`}),this.settings.provider.set("bttv-ffz-notice",!0))}}updateContext(v){this.settings.updateContext({bttv:{loaded:!0,emote_menu:v.get("clickTwitchEmotes"),gifs:v.get("bttvGIFEmotes")}})}handleDomUpdate(v){if(window.BetterTTV?.watcher?.emitLoad&&_.includes(v)){this.log.info("Sending chat reload event to BetterTTV.");try{window.BetterTTV.watcher.emitLoad("chat")}catch(r){this.log.error("An error occurred with BetterTTV:",r)}}}};$(A,"BTTVCompat");let E=A},74756:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=f(22527),y=f(14873),_=f(46949),E=f(44589);const A=/^8(102|363)$/.test(f.j)?["user","user-home","user-about","video","user-video","user-clip","user-videos","user-clips","user-collections","user-events","user-followers","user-following"]:null,v=class v extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...n){super(...n),this.should_enable=!0,this.inject("i18n"),this.inject("settings"),this.inject("site.apollo"),this.inject("site.css_tweaks"),this.inject("site.elemental"),this.inject("site.subpump"),this.inject("site.fine"),this.inject("site.router"),this.inject("site.twitch_data"),this.inject("metadata"),this.inject("socket"),this.inject("pubsub"),this.settings.add("channel.auto-click-off-featured",{default:!1,ui:{path:"Channel > Behavior >> General",title:`Automatically un-check "Featured Clips Only" when viewing a channel's clips.`,component:"setting-check-box"}}),this.settings.add("channel.panel-tips",{default:!1,ui:{path:"Channel > Behavior >> Panels",title:"Display rich tool-tips for links in channel panels.",component:"setting-check-box"},changed:s=>{this.updatePanelTips(),this.css_tweaks.toggle("panel-links",s)}}),this.settings.add("channel.auto-skip-trailer",{default:!1,ui:{path:"Channel > Behavior >> General",title:"Automatically skip channel trailers.",component:"setting-check-box"},changed:s=>{s&&this.ChannelTrailer.each(i=>this.maybeSkipTrailer(i))}}),this.settings.add("channel.auto-click-chat",{default:!1,ui:{path:"Channel > Behavior >> General",title:"Automatically open chat when opening an offline channel page.",component:"setting-check-box"}}),this.settings.add("channel.extra-links",{default:!0,ui:{path:"Channel > Appearance >> General",title:"Add extra links to live channel pages, next to the streamer's name.",component:"setting-check-box"},changed:()=>this.updateLinks()}),this.ChannelPanels=this.fine.define("channel-panels",s=>s.layoutMasonry&&s.updatePanelOrder&&s.onExtensionPoppedOut,A),this.ChannelTrailer=this.elemental.define("channel-trailer",".channel-trailer-player__wrapper",A,{attributes:!0},1),this.ChannelRoot=this.elemental.define("channel-root",".channel-root",A,{attributes:!0},1),this.InfoBar=this.elemental.define("channel-info-bar","#live-channel-stream-information",A,{childNodes:!0,subtree:!0},1)}onEnable(){this.updateChannelColor(),this.css_tweaks.toggle("panel-links",this.settings.get("channel.panel-tips")),this.on("i18n:update",this.updateLinks,this),this.ChannelTrailer.on("mount",this.maybeSkipTrailer,this),this.ChannelTrailer.on("update",this.maybeSkipTrailer,this),this.ChannelTrailer.each(n=>this.maybeSkipTrailer(n)),this.ChannelPanels.on("mount",this.updatePanelTips,this),this.ChannelPanels.on("update",this.updatePanelTips,this),this.ChannelPanels.on("unmount",this.removePanelTips,this),this.ChannelPanels.ready((n,s)=>{for(const i of s)this.updatePanelTips(i)}),this.ChannelRoot.on("mount",this.updateRoot,this),this.ChannelRoot.on("mutate",this.updateRoot,this),this.ChannelRoot.on("unmount",this.removeRoot,this),this.ChannelRoot.each(n=>this.updateRoot(n)),this.InfoBar.on("mount",this.updateBar,this),this.InfoBar.on("mutate",this.updateBar,this),this.InfoBar.on("unmount",this.removeBar,this),this.InfoBar.each(n=>this.updateBar(n)),this.router.on(":route",this.checkNavigation,this),this.checkNavigation()}maybeSkipTrailer(n){if(!this.settings.get("channel.auto-skip-trailer"))return;const s=this.fine.searchParent(n,i=>i.props&&i.props.onDismiss);s&&(this.log.info("Automatically skipping channel trailer."),s.props.onDismiss())}updatePanelTips(n){if(!n){for(const i of this.ChannelPanels.instances)i&&this.updatePanelTips(i);return}const s=this.fine.getChildNode(n);if(!s||!this.settings.get("channel.panel-tips"))return this.removePanelTips(n);if(n._ffz_tips&&n._ffz_tip_el!==s&&this.removePanelTips(n),!n._ffz_tips){const i=this.resolve("tooltips");i&&(n._ffz_tips=i._createInstance(s,"tw-link","link",i.getRoot()),n._ffz_tip_el=s)}}removePanelTips(n){n?._ffz_tips&&(n._ffz_tips.destroy(),n._ffz_tips=null,n._ffz_tip_el=null)}checkFeaturedClips(){this.router.current_name!=="user-clips"&&this.router.current_name!=="user-videos"||this._featured_waiting||!this.settings.get("channel.auto-click-off-featured")||(this._featured_waiting=this.parent.awaitElement("input#featured-clips-toggle").then(n=>{n.checked&&n.click(),this._featured_waiting=!1}).catch(()=>{this._featured_waiting=!1}))}checkNavigation(){this.checkFeaturedClips(),!(!this.settings.get("channel.auto-click-chat")||this.router.current_name!=="user-home")&&this.router.old_location!==this.router.location&&this.router.history.replace(this.router.location,{channelView:"Watch"})}updateLinks(){for(const n of this.InfoBar.instances)n._ffz_link_login=null,this.updateBar(n)}updateSubscription(n,s){this._subbed_login===s&&this._subbed_id===n||(this._subbed_id&&(this.pubsub.unsubscribe(this,`twitch/${this._subbed_id}`),this._subbed_id=null),this._subbed_login&&(this.socket.unsubscribe(this,`channel.${this._subbed_login}`),this._subbed_login=null),n&&(this.pubsub.subscribe(this,`twitch/${n}`),this._subbed_id=n),s&&(this.socket.subscribe(this,`channel.${s}`),this._subbed_login=s))}updateBar(n){n._ffz_update||(n._ffz_update=(0,_.debounce)(()=>requestAnimationFrame(()=>this._updateBar(n)),1e3,2)),n._ffz_update()}_updateBar(n){n._ffz_cont&&!document.contains(n._ffz_cont)&&(n._ffz_cont.classList.remove("ffz--meta-tray"),n._ffz_cont=null);const s=this.settings.get("channel.extra-links");n._ffz_links&&(!document.contains(n._ffz_links)||!s)&&(n._ffz_links.remove(),n._ffz_links=null,n._ffz_link_login=null);let i=n.querySelector(".ffz--native-viewers-container");if(!i){let w=0,h=n.querySelector('p[data-a-target="animated-channel-viewers-count"]');for(;h&&h!=n&&w<5;){if(h.querySelector("svg")){h.classList.add("ffz--native-viewers-container"),i=h;break}h=h.parentElement,w++}}if(!n._ffz_cont){let w=n.querySelector('.report-button,button[data-test-selector="video-options-button"],button[data-test-selector="clip-options-button"],button[data-a-target="report-button-more-button"]');!w&&i&&(w=i.parentElement);let h=w&&(w.closest(".tw-flex-wrap.tw-justify-content-end")||w.closest(".tw-justify-content-end"));!h&&w&&(h=w.parentElement?.parentElement,h&&h.parentElement?.childElementCount===2&&w.dataset.aTarget!=="report-button-more-button"&&(h=h.parentElement.firstElementChild)),h&&n.contains(h)?(n._ffz_cont=h,h.classList.add("ffz--meta-tray")):n._ffz_cont=null}if(!n._ffz_links&&s){const w=n.querySelector("a .tw-title"),h=w&&w.closest("a"),p=h&&h.closest("div");p&&n.contains(p)&&(n._ffz_links=(0,E.createElement)("div",{class:"ffz--links tw-mg-l-1"}),p.appendChild(n._ffz_links))}const e=this.fine.getReactInstance(n);let o=e?.child?.memoizedProps;o?.channelLogin||(o=o?.children?.props);const a=o?.watchPartyProps?.isShowingWatchPartyInMain;if(this.settings.updateContext({isWatchParty:a}),!n._ffz_cont||!o?.channelID){this.updateSubscription(null,null);return}if(n._ffz_links&&o.channelLogin!==n._ffz_link_login){const w=n._ffz_link_login=o.channelLogin;if(w){const h=$((p,z)=>{const R=(0,E.createElement)("a",{href:p,class:"tw-c-text-alt-2 tw-interactive tw-pd-x-1 tw-font-size-5"},z);return R.addEventListener("click",I=>{if(I.ctrlKey||I.shiftKey||I.altKey)return;const j=this.router.history;j&&(I.preventDefault(),j.push(p))}),R},"make_link");n._ffz_links.closest(".home-header-sticky")?n._ffz_links.innerHTML="":(0,E.setChildren)(n._ffz_links,[h(`/${w}/schedule`,this.i18n.t("channel.links.schedule","Schedule")),h(`/${w}/videos`,this.i18n.t("channel.links.videos","Videos")),h(`/${w}/clips`,this.i18n.t("channel.links.clips","Clips"))])}else n._ffz_links.innerHTML=""}let c=null;this.fine.searchNode(e,w=>{let h=w?.memoizedState,p=0;for(;h!=null&&c==null&&p<50;)c=h?.memoizedState?.current?.result?.data?.user??h?.memoizedState?.current?.previousData?.user,c?.lastBroadcast?.game||(c=null),c||(h=h?.next),p++;return c!=null});const d=c?.lastBroadcast?.game,m=c?.lastBroadcast?.title;(d?.id!==n._ffz_game_cache||m!==n._ffz_title_cache)&&this.settings.updateContext({category:d?.displayName,categoryID:d?.id,title:m}),this.updateSubscription(o.channelID,o.channelLogin),this.updateMetadata(n),this.emit(":update-bar",n,o,c)}removeBar(n){if(this.updateSubscription(null,null),n._ffz_cont&&n._ffz_cont.classList.remove("ffz--meta-tray"),n._ffz_cont=null,n._ffz_meta_timers){for(const s of Object.values(n._ffz_meta_timers))clearTimeout(s);n._ffz_meta_timers=null}n._ffz_update=null}updateMetadata(n,s){const i=n._ffz_cont;let o=this.fine.getReactInstance(n)?.memoizedProps?.children?.props;if(o&&!o.channelID&&(o=o.children?.props),!i||!document.contains(i)||!o||!o.channelID)return;s?Array.isArray(s)||(s=[s]):s=this.metadata.keys;const a=n._ffz_meta_timers=n._ffz_meta_timers||{},c=$(m=>this.updateMetadata(n,m),"refresh_fn"),d={channel:{id:o.channelID,login:o.channelLogin,display_name:o.displayName,live:o.isLive&&!o.videoID&&!o.clipSlug,video:!!(o.videoID||o.clipSlug),live_since:o.liveSince},props:o,el:n,getViewerCount:()=>{const m=i.querySelector('p[data-a-target="animated-channel-viewers-count"]'),w=m&&this.fine.getReactInstance(m),h=w?.memoizedProps?.children;if(typeof h=="string"&&/^[0-9,.]+$/.test(h))try{const z=parseInt(h.replace(/,/,""),10);if(!isNaN(z)&&isFinite(z)&&z>0)return z}catch{}const p=h?.props;return p&&p.value!=null?p.value:0},getUserSelfImmediate:m=>{const w=this.getUserSelf(n,o.channelID,!0);return w&&w.then?(w.then(m),null):w},getUserSelf:()=>this.getUserSelf(n,o.channelID),getBroadcastID:()=>this.getBroadcastID(n,o.channelID)};for(const m of s)this.metadata.renderLegacy(m,d,i,a,c)}updateRoot(n){const s=this.fine.getReactInstance(n);let i=null,e=s,o=0,a=0;for(;e!=null&&i==null&&o<10;){let c=e?.memoizedState;for(a=0;c!=null&&i==null&&a<50;)i=c?.memoizedState?.current?.result?.data?.userOrError??c?.memoizedState?.current?.previousData?.userOrError,i||(c=c?.next),a++;e=e?.return,o++}i&&i.id?(this.updateChannelColor(i.primaryColorHex),this.settings.updateContext({channel:i.login,channelID:i.id,channelColor:i.primaryColorHex})):this.removeRoot()}removeRoot(){this.updateChannelColor(),this.settings.updateContext({channel:null,channelID:null,channelColor:null})}updateChannelColor(n){let s=n&&y.Color.RGBA.fromHex(n);s||(s=y.Color.RGBA.fromHex("9147FF")),s?(this.css_tweaks.setVariable("channel-color",s.toCSS()),this.css_tweaks.setVariable("channel-color-20",s._a(.2).toCSS()),this.css_tweaks.setVariable("channel-color-30",s._a(.3).toCSS())):(this.css_tweaks.deleteVariable("channel-color"),this.css_tweaks.deleteVariable("channel-color-20"),this.css_tweaks.deleteVariable("channel-color-30"))}getUserSelf(n,s,i){const e=n._ffz_self_cache=n._ffz_self_cache||{};return s===e.channel_id&&Date.now()-e.saved<6e4?i?e.data:Promise.resolve(e.data):new Promise(async(o,a)=>{if(e.updating){e.updating.push([o,a]);return}e.channel_id=s,e.updating=[[o,a]];let c,d;try{c=await this.twitch_data.getUserSelf(s)}catch(w){c=null,d=w}const m=e.updating;if(e.updating=null,e.channel_id!==s){d=new Error("Outdated"),e.channel_id=null,e.data=null,e.saved=0;for(const w of m)w[1](d);return}e.data=c,e.saved=Date.now();for(const w of m)d?w[1](d):w[0](c)})}getBroadcastID(n,s){const i=n._ffz_bcast_cache=n._ffz_bcast_cache||{};return s===i.channel_id&&Date.now()-i.saved<6e4?Promise.resolve(i.broadcast_id):new Promise(async(e,o)=>{if(i.updating){i.updating.push([e,o]);return}i.channel_id=s,i.updating=[[e,o]];let a,c;try{a=await this.twitch_data.getBroadcastID(s)}catch(m){a=null,c=m}const d=i.updating;if(i.updating=null,i.channel_id!==s){c=new Error("Outdated"),i.channel_id=null,i.broadcast_id=null,i.saved=0;for(const m of d)m[1](c);return}i.broadcast_id=a,i.saved=Date.now();for(const m of d)c?m[1](c):m[0](a)})}};$(v,"Channel");let b=v},6172:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>de,formatBitsConfig:()=>xe});var N=f(14873),y=f(46949),_=f(24431),E=f(83342),A=f(6170),b=f(22527),v=f(89196);const r=["touchmove","scroll","wheel","mousewheel","DOMMouseScroll"];let n=0;const he=class he extends b.default{constructor(...l){super(...l),this.inject("settings"),this.inject("i18n"),this.inject("chat"),this.inject("site"),this.inject("site.fine"),this.inject("site.web_munch"),this.ChatScroller=this.fine.define("chat-scroller",u=>u.saveScrollRef&&u.handleScrollEvent&&!u.renderLines&&u.resume,v.Z.CHAT_ROUTES),this.settings.add("chat.scroller.freeze",{default:0,ui:{path:"Chat > Behavior >> Scrolling",title:"Pause Chat Scrolling",description:`Automatically stop chat from scrolling when moving the mouse over it or holding a key.

**Note:** Scrolling up in chat will always prevent automatic scrolling, regardless of this setting.`,component:"setting-select-box",data:[{value:0,title:"Use Twitch Setting"},{value:1,title:"On Hover"},{value:2,title:"When Ctrl is Held"},{value:3,title:"When Meta is Held"},{value:4,title:"When Alt is Held"},{value:5,title:"When Shift is Held"},{value:6,title:"Ctrl or Hover"},{value:7,title:"Meta or Hover"},{value:8,title:"Alt or Hover"},{value:9,title:"Shift or Hover"}]}}),this.settings.add("chat.scroller.freeze-requires-hover",{default:!0,ui:{path:"Chat > Behavior >> Scrolling",title:"Require the mouse to be over chat to freeze with a hotkey.",component:"setting-check-box"}}),this.settings.add("chat.scroller.hover-delay",{default:750,ui:{path:"Chat > Behavior >> Scrolling",title:"Hover Timeout",description:"Chat will only remain frozen due to mouse hovering for this long after the mouse stops moving.",component:"setting-combo-box",data:[{value:250,title:"0.25 Seconds"},{value:500,title:"0.50 Seconds"},{value:750,title:"0.75 Seconds"},{value:1e3,title:"1 Second"},{value:2500,title:"2.5 Seconds"},{value:5e3,title:"5 Seconds"}]}}),this.settings.add("chat.scroller.smooth-scroll",{default:0,ui:{path:"Chat > Behavior >> Scrolling",title:"Smooth Scrolling",description:`**Note:** This may not behave well depending on your browser. Disable this if you encounter issues.

Smoothly slide new chat messages into view. Speed will increase as necessary to keep up with chat.`,component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Slow"},{value:2,title:"Medium"},{value:3,title:"Fast"},{value:4,title:"Very Fast"}]}})}updateUseKeys(){const l=this.use_keys;this.use_keys=!1;for(const u of this.chat.context.get("chat.actions.inline"))if(u&&u.display&&u.display.keys){this.use_keys=!0;break}for(const u of this.chat.context.get("chat.actions.hover"))if(u&&u.display&&u.display.keys){this.use_keys=!0;break}if(this.use_keys!==l)for(const u of this.ChatScroller.instances)u&&u.ffzUpdateKeys&&u.ffzUpdateKeys()}async onEnable(){this.on("i18n:update",()=>this.ChatScroller.forceUpdate()),this.chat.context.on("changed:chat.actions.inline",this.updateUseKeys,this),this.updateUseKeys(),this.pause_hover=this.chat.context.get("chat.scroller.freeze-requires-hover"),this.chat.context.on("changed:chat.scroller.freeze-requires-hover",g=>{this.pause_hover=g;for(const M of this.ChatScroller.instances)M.ffzMaybeUnpause()}),this.pause_delay=this.chat.context.get("chat.scroller.hover-delay"),this.chat.context.on("changed:chat.scroller.hover-delay",g=>{this.pause_delay=g;for(const M of this.ChatScroller.instances)M.ffzMaybeUnpause()}),this.pause=this.chat.context.get("chat.scroller.freeze"),this.chat.context.on("changed:chat.scroller.freeze",g=>{this.pause=g;for(const M of this.ChatScroller.instances)M.ffzMaybeUnpause()}),this.smooth_scroll=this.chat.context.get("chat.scroller.smooth-scroll"),this.chat.context.on("changed:chat.scroller.smooth-scroll",g=>{this.smooth_scroll=g;for(const M of this.ChatScroller.instances)M.ffzSetSmoothScroll(g)});const l=this,u=await this.site.findReact(),C=u?.createElement;if(!C)return l.log.warn("Unable to get React.");this.ChatScroller.ready((g,M)=>{const S=g.prototype.componentDidCatch,x=g.prototype.render;g.prototype.componentDidCatch=function(k,D){const O=this.state.ffz_errors||0;if(O<100&&(this.setState({ffz_errors:O+1,ffz_total_errors:(this.state.ffz_total_errors||0)+1}),l.log.capture(k,{extra:D}),l.log.info("Error within Chat",k,D,O)),S)return S.call(this,k,D)},g.prototype.ffzZeroErrors=function(){this.setState({ffz_errors:0})},g.prototype.render=function(){if(this.state.ffz_errors>0){let k;const D=this.state.ffz_total_errors<10,O=$(()=>{clearTimeout(k),this.ffzZeroErrors()},"handler");return D&&(k=setTimeout(O,250)),C?C("div",{className:"tw-border-l tw-c-background-alt-2 tw-c-text-base tw-full-width tw-full-height tw-align-items-center tw-flex tw-flex-column tw-justify-content-center tw-relative"},[C("div",{className:"tw-mg-b-1"},"There was an error displaying chat."),!D&&C("button",{className:"tw-button",onClick:O},C("span",{className:"tw-button__text"},"Try Again"))]):null}else{const k=x.call(this);try{const D=k?.props?.children?.props?.children;D?.[2]?.type?.displayName==="ChatPausedFooter"&&(D[2]=this.ffzRenderFooter())}catch{}return k}},g.prototype.ffzInstallCleaner=function(){this._ffz_cleaner||(this._ffz_cleaner=this.ffzOnClean.bind(this),this._ffz_clean_timer=setInterval(this._ffz_cleaner,6e4))},g.prototype.ffzOnClean=function(){const k=l.fine.getChildNode(this);if(!k)return this.ffzRemoveCleaner();requestAnimationFrame(()=>l.cleanMessages(k.querySelector(".chat-scrollable-area__message-container")))},g.prototype.ffzRemoveCleaner=function(){this._ffz_clean_timer&&clearInterval(this._ffz_clean_timer),this._ffz_clean_timer=this._ffz_cleaner=null},g.prototype.ffzInstallHandler=function(){if(this._ffz_installed)return;this._ffz_installed=!0;const k=this;k.ffz_oldScrollEvent=k.handleScrollEvent,k.ffz_oldScroll=k.scrollToBottom,k.ffz_acting=!1,k.ffz_outside=!0,k._ffz_accessor=`_ffz_contains_${n++}`,l.on("tooltips:hover",this.ffzTooltipHover,this),l.on("tooltips:leave",this.ffzTooltipLeave,this),k.scrollToBottom=function(){k._ffz_scroll_request||(k._ffz_scroll_request=requestAnimationFrame(k._scrollToBottom))},k._scrollToBottom=function(){k._ffz_scroll_request=null,k.state.isPaused||(k.ffz_smooth_scroll&&!k._ffz_one_fast_scroll?k.ffzSmoothScroll():(k._ffz_one_fast_scroll=!1,k.ffz_oldScroll()))},k.handleScrollEvent=function(Q){if(!k.scrollRef?.scrollContent||!(Q.which>0||Q.type==="mousewheel"||Q.type==="wheel"||Q.type==="touchmove"))return;const P=k.scrollRef.scrollContent,B=P.scrollHeight-P.scrollTop-P.offsetHeight,G=B>10;G!==k.state.ffz_scrolled_up&&k.setState({ffz_scrolled_up:G}),k.state.isPaused&&G&&k.setLoadMoreEnabled(!0),k.state.isPaused&&!G?k.ffzMaybeUnpause():!k.state.isPaused&&G&&k.pause()};const D=k.resume;k.ffzFastResume=function(){k._ffz_one_fast_scroll=!0,k.resume()},k.resume=function(){k.setState({ffz_scrolled_up:!1}),D.call(this)};const O=l.web_munch.getModule("mousetrap")||window.Mousetrap;O!=null&&(O.unbind("alt","keydown"),O.unbind("alt","keyup")),k.ffzHandleKey=k.ffzHandleKey.bind(k),window.addEventListener("keydown",k.ffzHandleKey),window.addEventListener("keyup",k.ffzHandleKey),k.hoverPause=k.ffzMouseMove.bind(k),k.hoverResume=k.ffzMouseLeave.bind(k);const K=l.fine.getChildNode(k);K&&K.addEventListener("mousemove",k.hoverPause);const X=this.scrollRef?.scrollContent;if(X)for(const Q of r)X.removeEventListener(Q,k.ffz_oldScrollEvent),X.addEventListener(Q,k.handleScrollEvent);k.forceUpdate(),l.emit("site:dom-update","chat-scroller",k)},g.prototype.ffzSmoothScroll=function(){this._ffz_smooth_animation&&cancelAnimationFrame(this._ffz_smooth_animation),this.ffz_is_smooth_scrolling=!0;let k=this.ffz_smooth_scroll,D=performance.now();const O=this.scrollRef?.scrollContent;if(!O)return;const K=O.scrollHeight-O.clientHeight,X=K-O.scrollTop;X>O.clientHeight?k=X:X>200&&(k+=k*Math.floor(X/200));const Q=$(()=>{if(this.state.isPaused)return this.ffz_is_smooth_scrolling=!1;const P=performance.now(),B=P-D,G=k*(B/10);if(G>=1){const J=O.scrollTop,ot=J+G,ct=O.scrollHeight-O.clientHeight;D=P,ot<ct?(O.scrollTop=J+G,this._ffz_smooth_animation=requestAnimationFrame(Q)):(O.scrollTop=ct,this.ffz_is_smooth_scrolling=!1)}else this._ffz_smooth_animation=requestAnimationFrame(Q)},"smoothAnimation");Q()},g.prototype.ffzSetSmoothScroll=function(k){this.ffz_smooth_scroll=k,this.ffzMaybeUnpause()},g.prototype.ffzReadKeysFromEvent=function(k){return k.altKey===this.ffz_alt&&k.shiftKey===this.ffz_shift&&k.ctrlKey===this.ffz_ctrl&&k.metaKey===this.ffz_meta?!1:(this.ffz_alt=k.altKey,this.ffz_shift=k.shiftKey,this.ffz_ctrl=k.ctrlKey,this.ffz_meta=k.metaKey,!0)},g.prototype.ffzHandleKey=function(k){if(!this.ffzReadKeysFromEvent(k)||(this.ffzUpdateKeyTags(),l.pause_hover&&this.ffz_outside||this.ffzGetMode()<2))return;const D=this.ffzShouldBePaused();D!==this.state.isPaused&&(D?(this.pause(),this.state.ffz_scrolled_up||this.setLoadMoreEnabled(!1)):this.resume())},g.prototype.ffzInstallHoverTimer=function(){this._ffz_hover_timer||(this._ffz_hover_timer=setInterval(()=>{this.state.isPaused&&this.ffzShouldBePaused()||this.ffzMaybeUnpause()},50))},g.prototype.ffzMouseMove=function(k){this.ffz_last_move=Date.now();const D=this.ffz_outside;this.ffz_outside=!1,this._ffz_outside_timer&&(clearTimeout(this._ffz_outside_timer),this._ffz_outside_timer=null);const O=this.ffzReadKeysFromEvent(k);if(!O&&k.screenX===this.ffz_sx&&k.screenY===this.ffz_sy){D&&this.ffzUpdateKeyTags();return}this.ffz_sx=k.screenX,this.ffz_sy=k.screenY,(O||D)&&this.ffzUpdateKeyTags();const K=this.ffzShouldBePaused();K!==this.state.isPaused&&(K?(this.pause(),this.ffzInstallHoverTimer(),this.state.ffz_scrolled_up||this.setLoadMoreEnabled(!1)):this.resume())},g.prototype.ffzMouseLeave=function(){this.ffz_outside=!0,this._ffz_outside_timer&&clearTimeout(this._ffz_outside_timer),this._ffz_outside_timer=setTimeout(()=>this.ffzMaybeUnpause(),64),this.ffzUpdateKeyTags()},g.prototype.ffzTooltipHover=function(k,D,O){if(k[this._ffz_accessor]==null){const K=this.scrollRef?.scrollContent;k[this._ffz_accessor]=K?K.contains(k):!1}k[this._ffz_accessor]&&this.ffzMouseMove(O)},g.prototype.ffzTooltipLeave=function(k){if(!this.ffz_outside){if(k[this._ffz_accessor]==null){const D=this.scrollRef?.scrollContent;k[this._ffz_accessor]=D?D.contains(k):!1}k[this._ffz_accessor]&&this.ffzMouseLeave()}},g.prototype.ffzUpdateActing=function(){this._ffz_key_frame_acting||(this._ffz_key_frame_acting=requestAnimationFrame(()=>this.ffz_updateActing()))},g.prototype.ffz_updateActing=function(){this._ffz_key_frame_acting=null,this.scrollRef?.root&&(this.scrollRef.root.dataset.acting=this.ffz_acting)},g.prototype.ffzUpdateKeyTags=function(){this._ffz_key_frame||(this._ffz_key_frame=requestAnimationFrame(()=>this.ffz_updateKeyTags()))},g.prototype.ffz_updateKeyTags=function(){if(this._ffz_key_frame=null,!l.use_keys&&this.ffz_use_keys===l.use_keys||!this.scrollRef?.root)return;this.ffz_use_keys=l.use_keys,this.scrollRef.root.classList.toggle("ffz--keys",l.use_keys);const k=this.scrollRef.root.dataset;l.use_keys?(k.alt=!this.ffz_outside&&this.ffz_alt,k.ctrl=!this.ffz_outside&&this.ffz_ctrl,k.shift=!this.ffz_outside&&this.ffz_shift,k.meta=!this.ffz_outside&&this.ffz_meta):(delete k.alt,delete k.ctrl,delete k.shift,delete k.meta)},g.prototype.ffzShouldBePaused=function(k){if(k==null&&(k=Date.now()-(this.ffz_last_move??Date.now())),this.state.ffz_scrolled_up)return!0;const D=this.ffzGetMode();return(!l.pause_hover||!this.ffz_outside)&&(this.ffz_acting||this.ffz_ctrl&&(D===2||D===6)||this.ffz_meta&&(D===3||D===7)||this.ffz_alt&&(D===4||D===8)||this.ffz_shift&&(D===5||D===9)||!this.ffz_outside&&k<l.pause_delay&&(D===1||D>5))},g.prototype.ffzGetMode=function(){let k=l.pause;if(k===0&&!this.props.mouseoverPausingDisabled){const D=this.props.pauseSetting;D==="MOUSEOVER_ALTKEY"?k=8:D==="MOUSEOVER"?k=1:D==="ALTKEY"&&(k=4)}return k},g.prototype.ffzMaybeUnpause=function(){this.state.isPaused&&!this._ffz_unpause_frame&&(this._ffz_unpause_frame=requestAnimationFrame(()=>{this._ffz_unpause_frame=null,this.state.isPaused&&!this.ffzShouldBePaused()&&this.resume()}))},g.prototype.ffzRenderFooter=function(){let k,D="";if(this.state.ffz_scrolled_up)k=l.i18n.t("chat.messages-below","Chat Paused Due to Scroll");else if(this.state.isPaused){const O=this.ffzGetMode(),K=this.ffz_acting?l.i18n.t("chat.acting","Taking Action"):O===2?l.i18n.t("key.ctrl","Ctrl Key"):O===3?l.i18n.t("key.meta","Meta Key"):O===4?l.i18n.t("key.alt","Alt Key"):O===5?l.i18n.t("key.shift","Shift Key"):O===6?l.i18n.t("key.ctrl_mouse","Ctrl or Mouse"):O===7?l.i18n.t("key.meta_mouse","Meta or Mouse"):O===8?l.i18n.t("key.alt_mouse","Alt or Mouse"):O===9?l.i18n.t("key.shift_mouse","Shift or Mouse"):l.i18n.t("key.mouse","Mouse Movement");k=l.i18n.t("chat.paused","Chat Paused Due to {reason}",{reason:K}),D="ffz--freeze-indicator"}else return C("div",{className:`chat-scroll-footer__placeholder tw-flex tw-justify-content-center tw-relative ${D}`},null);return C("div",{className:`chat-scroll-footer__placeholder tw-flex tw-justify-content-center tw-relative ${D}`},C("div",{className:"tw-absolute tw-border-radius-medium tw-bottom-0 tw-c-background-overlay tw-c-text-overlay tw-mg-b-1"},C("button",{className:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium ffz-core-button ffz-core-button--overlay ffz-core-button--text tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative","data-a-target":"chat-list-footer",onClick:this.ffzFastResume},C("div",{className:"tw-align-items-center ffz-core-button-label tw-flex tw-flex-grow-0"},C("div",{className:"tw-flex-grow-0"},k)))))};for(const k of M)this.onMount(k)}),this.ChatScroller.on("mount",this.onMount,this),this.ChatScroller.on("unmount",this.onUnmount,this)}onMount(l){l.ffzSetSmoothScroll(this.smooth_scroll),l.ffzInstallHandler(),l.ffzInstallCleaner()}onUnmount(l){this.off("tooltips:hover",l.ffzTooltipHover,l),this.off("tooltips:leave",l.ffzTooltipLeave,l),l._ffz_hover_timer&&(clearInterval(l._ffz_hover_timer),l._ffz_hover_timer=null),l._ffz_outside_timer&&(clearTimeout(l._ffz_outside_timer),l._ffz_outside_timer=null),l.ffzRemoveCleaner(),window.removeEventListener("keydown",l.ffzHandleKey),window.removeEventListener("keyup",l.ffzHandleKey)}cleanMessages(l){const u=ffz.site.fine.getReactInstance(l);if(!u||!Array.isArray(u.child?.memoizedProps))return;let C=null,g=u.child,M=0;for(;g&&M<10;){if(g.stateNode instanceof HTMLDivElement){C=g.stateNode;break}g=g.child,M++}if(!C||C.parentElement!==l)return;let S=C.previousElementSibling;for(M=0;S;){const x=S;S=S.previousElementSibling,x.remove(),M++}M>0&&this.log.debug(`Removed ${M} dead chat lines from`,l)}};$(he,"Scroller");let s=he;const i="https://static-cdn.jtvnw.net/emoticons/v1/58765/2.0",ue=class ue extends b.default{constructor(...l){super(...l),this.inject("chat"),this.inject("i18n"),this.inject("site"),this.RichContent=null,this.has_tokenizer=!1}async loadTokenizer(){if(!this.has_tokenizer)return this.tokenizer=await Promise.all([f.e(2009),f.e(208)]).then(f.bind(f,30642)),this.has_tokenizer=!0,this.tokenizer}async onEnable(){var g;const l=this,u=await this.site.findReact();if(!u)return;const C=u.createElement;this.RichContent=(g=class extends u.Component{constructor(S){super(S),this.state={loaded:!1,error:!1,has_tokenizer:l.has_tokenizer},l.has_tokenizer||l.loadTokenizer().then(()=>this.setState({...this.state,has_tokenizer:!0}))}async load(S=!1){this.clearRefresh();try{let x=this.props.getData(S);if(x instanceof Promise){const k=(0,y.has)(this.props,"timeout")?this.props.timeout:1e3;k?x=await(0,y.timeout)(x,k):x=await x}if(x||(x={error:{type:"i18n",key:"card.empty",phrase:"No data was returned."}}),x.error&&(x={short:{type:"header",image:{type:"image",url:i},title:{type:"i18n",key:"card.error",phrase:"An error occurred."},subtitle:x.error}}),x.refresh)try{this.clearRefresh();const k=new Date(x.refresh).getTime(),D=k-Date.now();D>0&&(this._refresh_timer=setTimeout(()=>this.load(!0),D+100*Math.floor(Math.random()*100)))}catch{}this.setState(Object.assign({loaded:!0,url:this.props.url},x))}catch(x){x.message!=="timeout"&&l.log.capture(x),this.setState({has_tokenizer:l.has_tokenizer,loaded:!0,url:this.props.url,short:{type:"header",image:{type:"image",url:i},title:{type:"i18n",key:"card.error",phrase:"An error occurred."},subtitle:String(x)}})}}clearRefresh(){this._refresh_timer&&(clearTimeout(this._refresh_timer),this._refresh_timer=null)}checkReload(S){(!S||S&&this.props.url===S)&&this.reload()}reload(S=!1){this.clearRefresh(),this.setState({loaded:!1,error:!1,has_tokenizer:l.has_tokenizer},()=>this.load(S))}componentDidMount(){l.on("chat:update-link-resolver",this.checkReload,this),this.load()}componentWillUnmount(){l.off("chat:update-link-resolver",this.checkReload,this),this.clearRefresh()}renderCard(){return this.props.renderBody?this.props.renderBody(this.state,this,C):[this.renderUnsafe(),this.renderBody()]}renderUnsafe(){if(!this.state.unsafe)return null;const S=Array.from(new Set(this.state.urls.map(x=>x.flags).flat())).join(", ").toLowerCase();return C("div",{class:"ffz--corner-flag ffz--corner-flag__warn ffz-tooltip ffz-tooltip--no-mouse","data-title":l.i18n.t("tooltip.link-unsafe","Caution: This URL is has been flagged as potentially harmful by: {reasons}",{reasons:S})},C("figure",{class:"ffz-i-attention"}))}renderBody(){let S;return(this.props.force_full===!0||this.props.force_full!==!1&&this.props.want_full&&this.state.full)&&(S=this.state.full),this.props.force_mid===!0||this.props.force_mid!==!1&&this.props.want_mid&&this.state.mid?S=this.state.mid:S=this.state.short,l.has_tokenizer&&this.state.v&&this.state.v>l.tokenizer.VERSION&&(S=null),l.has_tokenizer&&this.state.loaded&&S?C("div",{class:"ffz-card-rich tw-full-width tw-overflow-hidden tw-flex tw-flex-column"},l.tokenizer.renderTokens(S,C,{vue:!1,tList:(...x)=>l.i18n.tList(...x),i18n:l.i18n,last_player:0,player_state:this.state.player_state,togglePlayer:x=>{const k=this.state.player_state??{};k[x]=!k[x],this.setState({player_state:k})},link_click_handler:l.chat.handleLinkClick,fragments:this.state.fragments,i18n_prefix:this.state.i18n_prefix,allow_media:l.chat.context.get("tooltip.link-images"),allow_unsafe:l.chat.context.get("tooltip.link-nsfw-images")})):this.renderBasic()}renderBasic(){let S,x;return this.state.error?(S=l.i18n.t("card.error","An error occurred."),x=this.state.error):this.state.loaded&&this.state.has_tokenizer?(S=this.state.title,x=this.state.description):x=l.i18n.t("card.loading","Loading..."),!S&&!x&&(x=l.i18n.t("card.empty","No data was returned.")),x=x?x.split(/\n+/).slice(0,2).map(k=>C("div",{class:"tw-c-text-alt-2 tw-ellipsis tw-mg-x-05",title:k},k)):[],[C("div",{class:"ffz--header-image"}),C("div",{class:"ffz--card-text tw-full-width tw-overflow-hidden tw-flex tw-flex-column tw-justify-content-center"},S&&C("div",{class:"chat-card__title tw-ellipsis tw-mg-x-05"},C("span",{class:"tw-strong",title:S},S)),x)]}render(){let S=C("div",{class:"tw-flex tw-flex-nowrap tw-pd-05"},this.renderCard());const x=this.props.card_tooltip&&this.state.full&&!this.props.force_full;return this.state.url&&(S=C("a",{class:`${x?"ffz-tooltip ":""}${this.state.accent?"ffz-accent-card ":""}${this.state.error?"":"ffz-interactable--hover-enabled "}tw-block tw-border-radius-medium tw-full-width ffz-interactable ffz-interactable--default tw-interactive`,"data-tooltip-type":"link","data-url":this.state.url,"data-is-mail":!1,target:"_blank",rel:"noreferrer noopener",href:this.state.url,onClick:l.chat.handleLinkClick},S)),C("div",{class:`tw-border-radius-medium tw-elevation-1 ffz--chat-card tw-relative${this.state.unsafe?" ffz--unsafe":""}`,style:{"--ffz-color-accent":this.state.accent||null}},C("div",{class:"tw-border-radius-medium tw-c-background-alt tw-flex tw-full-width"},S))}},$(g,"RichContent"),g)}};$(ue,"RichContent");let e=ue;var o=f(83269),a=f(44615);const c={1e3:1,2e3:2,3e3:3},fe=class fe extends b.default{constructor(...l){super(...l),this.inject("settings"),this.inject("i18n"),this.inject("chat"),this.inject("site"),this.inject("site.fine"),this.inject(e),this.inject("experiments"),this.inject("chat.actions"),this.inject("chat.overrides"),this.inject("chat.emotes"),this.line_types={},this.line_types.unknown={renderNotice:(u,C,g,M,S)=>`Unknown message type: ${u.ffz_type}`},this.line_types.notice={renderNotice:(u,C,g,M,S)=>{const x=u.ffz_data;let k=this.line_types.notice.renderContent(u,C,g,M,S);if(!x.icon)return k;if(typeof k=="string"&&(k=S("span",{},k)),typeof x.icon=="function")try{k.ffz_icon=x.icon(x,M,S)}catch(D){this.log.capture(D),this.log.error("Error using custom renderer for notice:",D)}else x.icon instanceof URL?k.ffz_icon=S("img",{className:"ffz-notice-icon tw-mg-r-05",src:x.icon.toString()}):k.ffz_icon=S("span",{className:`${x.icon} tw-mg-r-05`});return k},renderContent:(u,C,g,M,S)=>{const x=u.ffz_data;if(x.renderer)try{return x.renderer(x,M,S)}catch(D){return this.log.capture(D),this.log.error("Error using custom renderer for notice:",D),"Error rendering notice."}const k=x.i18n?this.i18n.t(x.i18n,x.messgae,x):x.message;if(x.markdown)return(0,A.e)()?S("span",{dangerouslySetInnerHTML:{__html:(0,A.e)().renderInline(k)}}):((0,A.Z)().then(()=>M.forceUpdate()),"Loading...");if(x.tokenize){const D=x.ffz_tokens=x.ffz_tokens||this.chat.tokenizeMessage({badges:{},message:k,id:u.id,user:u.user,roomLogin:u.roomLogin,roomID:u.roomID});return this.chat.renderTokens(D,S)}return k}},this.line_types.hype={renderNotice:(u,C,g,M,S)=>{if(this.chat.context.get("chat.hype.message-style")===0)return null;const k=u.user,D=u.ffz_tokens=u.ffz_tokens||this.chat.tokenizeMessage(u,C),O=D.length>0;let K=u.hype_amount;const X=u.hype_exponent??0;X>0&&(K/=Math.pow(10,X));try{K=new Intl.NumberFormat(navigator.languages,{style:"currency",currency:u.hype_currency,compactDisplay:"short",minimumFractionDigits:X,maximumFractionDigits:X}).format(K)}catch{K=`${u.hype_currency} ${K}`}return O?this.i18n.tList("chat.hype-chat","Sent a Hype Chat for {amount}!",{amount:K}):this.i18n.tList("chat.hype-chat.user","{user} sent a Hype Chat for {amount}!",{amount:K,user:S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},k.displayName))})}},this.line_types.cheer={renderNotice:(u,C,g,M,S)=>this.i18n.tList("chat.bits-message","Cheered {count, plural, one {# Bit} other {# Bits}}",{count:u.bits||0})},this.line_types.points={getClass:u=>`ffz--points-line tw-pd-l-1 tw-pd-r-2 ${u.ffz_reward_highlight&&this.chat.context.get("chat.points.allow-highlight")===2?"ffz-custom-color ffz--points-highlight":""}`,renderNotice:(u,C,g,M,S)=>{if(!u.ffz_reward)return null;const x=u.user,k=(0,a.KC)(u.ffz_reward),D=u.ffz_tokens=u.ffz_tokens||this.chat.tokenizeMessage(u,C),O=D.length>0,K=S("span",{className:"ffz--points-reward"},(0,a.yg)(u.ffz_reward,this.i18n)),X=S("span",{className:"ffz--points-cost"},[S("span",{className:k?"ffz-i-bits":"ffz--points-icon"}),this.i18n.formatNumber((0,a.at)(u.ffz_reward))]);return O?this.i18n.tList("chat.points.redeemed","Redeemed {reward} {cost}",{reward:K,cost:X}):this.i18n.tList("chat.points.user-redeemed","{user} redeemed {reward} {cost}",{reward:K,cost:X,user:S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},x.displayName))})}},this.line_types.resub={getClass:()=>"ffz--subscribe-line tw-pd-r-2",renderNotice:(u,C,g,M,S)=>{const x=u.sub_cumulative||u.sub_months,k=this.chat.context.get("chat.subs.show");let D;if(k===1&&x>1&&(D=(u.ffz_tokens=u.ffz_tokens||this.chat.tokenizeMessage(u,C)).length>0),!(k===3||k===1&&D&&x>1||k===2&&x>1))return null;const O=u.user,K=u.sub_plan||{},X=c[K.plan]||1,Q=u.sub_multi,P=(Q?.count??0)>1&&Q.tenure===0,B=this.i18n.tList(`chat.sub.main${P?"-multi":""}`,`{user} subscribed {plan}${P?" for {multi, plural, one {# month} other {# months}} in advance":""}. `,{user:S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},O.displayName)),plan:K.prime?this.i18n.t("chat.sub.twitch-prime","with Prime Gaming"):this.i18n.t("chat.sub.plan","at Tier {tier}",{tier:X}),multi:P?Q.count:1});return u.sub_share_streak&&u.sub_streak>1?B.push(this.i18n.t("chat.sub.cumulative-months","They've subscribed for {cumulative,number} months, currently on a {streak,number} month streak!",{cumulative:u.sub_cumulative,streak:u.sub_streak})):x>1&&B.push(this.i18n.t("chat.sub.months","They've subscribed for {count,number} months!",{count:x})),this.chat.context.get("chat.subs.compact")||(B.ffz_icon=S("span",{className:`ffz-i-${K.prime?"crown":"star"} tw-mg-r-05`})),B}},this.line_types.ritual={getClass:()=>"ffz--ritual-line tw-pd-r-2",renderNotice:(u,C,g,M,S)=>{const x=u.user;if(u.ritual==="new_chatter")return this.i18n.tList("chat.ritual","{user} is new here. Say hello!",{user:S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},x.displayName))})}},this.line_types.sub_gift={getClass:()=>"ffz--subscribe-line",renderNotice:(u,C,g,M,S)=>{const x=u.user,k=u.sub_plan||{},D=u.sub_months||1,O=c[k.plan]||1;let K;const X={months:D,user:u.sub_anon||x.username==="ananonymousgifter"?this.i18n.t("chat.sub.anonymous-gifter","An anonymous gifter"):S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},x.displayName)),plan:k.plan==="custom"?"":this.i18n.t("chat.sub.gift-plan","Tier {tier}",{tier:O}),recipient:S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,"data-user":JSON.stringify(u.sub_recipient)},S("span",{className:"tw-c-text-base tw-strong"},u.sub_recipient.displayName))};return D<=1?K=this.i18n.tList("chat.sub.mystery","{user} gifted a {plan} Sub to {recipient}! ",X):K=this.i18n.tList("chat.sub.gift-months","{user} gifted {months, plural, one {# month} other {# months}} of {plan} Sub to {recipient}!",X),u.sub_total===1?K.push(this.i18n.t("chat.sub.gift-first","It's their first time gifting a Sub in the channel!")):u.sub_total>1&&K.push(this.i18n.t("chat.sub.gift-total","They've gifted {count,number} Subs in the channel!",{count:u.sub_total})),this.chat.context.get("chat.subs.compact")||(K.ffz_icon=S("span",{className:`ffz-i-${k.prime?"crown":"star"} tw-mg-r-05`})),K}},this.line_types.sub_mystery={getClass:()=>"ffz--subscribe-line",renderNotice:(u,C,g,M,S)=>{const x=u.mystery;x&&(x.line=M);const k=this.i18n.tList("chat.sub.gift","{user} is gifting {count, plural, one {# Tier {tier} Sub} other {# Tier {tier} Subs}} to {channel}'s community! ",{user:u.sub_anon||u.user.username==="ananonymousgifter"?this.i18n.t("chat.sub.anonymous-gifter","An anonymous gifter"):S("span",{role:"button",className:"chatter-name",onClick:M.ffz_user_click_handler,onContextMenu:this.actions.handleUserContext},S("span",{className:"tw-c-text-base tw-strong"},u.user.displayName)),count:u.sub_count,tier:c[u.sub_plan]||1,channel:u.roomLogin});u.sub_total===1?k.push(this.i18n.t("chat.sub.gift-first","It's their first time gifting a Sub in the channel!")):u.sub_total>1&&k.push(this.i18n.t("chat.sub.gift-total","They've gifted {count} Subs in the channel!",{count:u.sub_total})),M.ffz_click_expand||(M.ffz_click_expand=()=>{M.setState({ffz_expanded:!M.state.ffz_expanded})});const D=this.chat.context.get("chat.subs.merge-gifts-visibility")?!M.state.ffz_expanded:M.state.ffz_expanded;let O=null;if(D&&x&&x.recipients&&x.recipients.length>0){const Q=[];for(const P of x.recipients)Q.length&&Q.push(", "),Q.push(S("span",{role:"button",className:"ffz--giftee-name",onClick:M.ffz_user_click_handler,"data-user":JSON.stringify(P)},S("span",{className:"tw-c-text-base tw-strong"},P.displayName)));O=S("div",{className:"tw-mg-t-05 tw-border-t tw-pd-t-05 tw-c-text-alt-2"},Q)}const K=[k];x&&K.push(S("span",{className:`tw-pd-l-05 tw-font-size-4 ffz-i-${D?"down":"right"}-dir`}));const X=[S("div",{className:"tw-full-width tw-c-text-alt-2",onClick:M.ffz_click_expand},K),O];return this.chat.context.get("chat.subs.compact")||(X.ffz_icon=S("span",{className:`ffz-i-star${u.sub_anon?"-empty":""} tw-mg-r-05`})),X.ffz_target=K,X}},this.ChatLine=this.fine.define("chat-line",u=>u.renderMessageBody&&u.props&&!u.onExtensionNameClick&&!(0,y.has)(u.props,"hasModPermissions"),v.Z.CHAT_ROUTES),this.ExtensionLine=this.fine.define("extension-line",u=>u.renderMessageBody&&u.onExtensionNameClick,v.Z.CHAT_ROUTES),this.WhisperLine=this.fine.define("whisper-line",u=>u.props&&u.props.message&&(0,y.has)(u.props,"reportOutgoingWhisperRendered"))}async onEnable(){this.on("chat.overrides:changed",M=>this.updateLinesByUser(M,null,!1,!1),this),this.on("chat:update-lines-by-user",this.updateLinesByUser,this),this.on("chat:update-line",this.updateLineById,this),this.on("chat:update-lines",this.updateLines,this),this.on("chat:rerender-lines",this.rerenderLines,this),this.on("chat:update-line-tokens",this.updateLineTokens,this),this.on("chat:update-line-badges",this.updateLineBadges,this),this.on("i18n:update",this.rerenderLines,this),this.on("chat.emotes:update-effects",this.checkEffects,this),this.can_reprocess=!0,this.on("chat:reload-data",()=>this.can_reprocess=!0),this.on("chat:room-add",()=>this.can_reprocess=!0),this.on("load_tracker:complete:chat-data",()=>{!this.chat.context.get("chat.update-when-loaded")||!this.can_reprocess||(this.can_reprocess=!1,this.log.info("Reprocessing chat lines due to data loads."),this.updateLines())});for(const M of _.RERENDER_SETTINGS)this.chat.context.on(`changed:${M}`,this.rerenderLines,this);for(const M of _.UPDATE_TOKEN_SETTINGS)this.chat.context.on(`changed:${M}`,this.updateLineTokens,this);for(const M of _.UPDATE_BADGE_SETTINGS)this.chat.context.on(`changed:${M}`,this.updateLineBadges,this);this.chat.context.on("changed:tooltip.link-images",this.maybeUpdateLines,this),this.chat.context.on("changed:tooltip.link-nsfw-images",this.maybeUpdateLines,this),this.on("chat:get-messages",(M,S,x,k)=>{if(M){for(const D of this.ChatLine.instances){const O=D.props.message;O&&k.push({message:O,_instance:D,update:()=>D.forceUpdate()})}for(const D of this.ExtensionLine.instances){const O=D.props.message;O&&k.push({message:O,_instance:D,update:()=>D.forceUpdate()})}}if(S)for(const D of this.WhisperLine.instances){const O=D.props.message;O&&O._ffz_message&&k.push({message:O._ffz_message,_instance:D,update:()=>D.forceUpdate()})}}),this.on("chat:get-tab-commands",M=>{this.experiments.getTwitchAssignmentByName("chat_replies")!=="control"&&M.commands.push({name:"reply",description:"Reply to a user's last message.",permissionLevel:0,ffz_group:"FrankerFaceZ",commandArgs:[{name:"username",isRequired:!0},{name:"message",isRequired:!1}]})}),this.on("chat:pre-send-message",M=>{if(this.experiments.getTwitchAssignmentByName("chat_replies")==="control")return;const S=M.message,x=this.parent.chat_types||{};let k,D;if(/^\/reply ?/i.test(S))k=S.slice(7).trim();else return;M.preventDefault();const O=k.indexOf(" ");if(O!==-1&&(D=k.slice(O+1),k=k.slice(0,O)),k.startsWith("@")&&(k=k.slice(1)),k&&k.length){k=k.toLowerCase();const K=Array.from(this.ChatLine.instances);let X=K.length;for(;X--;){const Q=K[X],P=Q?.props?.message,B=P?.user;if(B&&(B.login===k||B.displayName?.toLowerCase?.()===k)){D?M.sendMessage(D,{reply:{parentDeleted:P.deleted||!1,parentDisplayName:B.displayName,parentMessageBody:P.message,parentMsgId:P.id,parentUid:B.id,parentUserLogin:B.login}}):requestAnimationFrame(()=>Q.ffzOpenReply());return}}}M.addMessage({type:x.Notice,message:this.i18n.t("chat.reply.bad-user","Invalid user or no known message to reply to.")})});const l=this,u=await this.site.findReact();if(!u)return;const C=u.createElement,g=this.rich_content&&this.rich_content.RichContent;this.WhisperLine.ready(M=>{const S=M.prototype.render;M.prototype.render=function(){if(this._ffz_no_scan=!0,!this.props.message||!this.props.message.content||!this.props.message.from)return S.call(this);try{const x=l.chat.standardizeWhisper(this.props.message),k=x.is_action,D=k?l.chat.context.get("chat.me-style"):0,O=D>=2,K=D===1||D===3,X=x.user,Q=l.overrides.getColor(X.id)||X.color,P=l.parent.colors.process(Q),B=x.ffz_tokens=x.ffz_tokens||l.chat.tokenizeMessage(x,null),G=l.chat.renderTokens(B,C),J=l.overrides.getName(X.id);return C("div",{className:"thread-message__message"},C("div",{className:"tw-pd-x-1 tw-pd-y-05"},[C("span",{className:`thread-message__message--user-name notranslate${J?" ffz--name-override":""}`,style:{color:P}},J||X.displayName),C("span",null,k?" ":": "),C("span",{className:`message${O?" chat-line__message-body--italicized":""}`,style:{color:K&&P}},G)]))}catch(x){return l.log.error(x),l.log.capture(x,{extra:{props:this.props}}),S.call(this)}},setTimeout(()=>this.WhisperLine.forceUpdate())}),this.ChatLine.ready(M=>{const S=M.prototype.render;M.prototype.shouldComponentUpdate=function(x,k){const D=k&&k.alwaysShowMessage||!x.message.deleted,O=this._ffz_show;return this._ffz_show=D,D!==O||k&&this.state&&k.ffz_expanded!==this.state.ffz_expanded||x.deletedMessageDisplay!==this.props.deletedMessageDisplay||x.deletedCount!==this.props.deletedCount||x.message!==this.props.message||x.isCurrentUserModerator!==this.props.isCurrentUserModerator||x.showModerationIcons!==this.props.showModerationIcons||x.showTimestamps!==this.props.showTimestamps||x.pinnedMessage?.message?.id===x.message?.id!=(this.props.pinnedMessage?.message?.id===this.props.message?.id)},M.prototype.ffzOpenReply=function(){if(this.onMessageClick)return this.onMessageClick();if(this.props.reply){this.setOPCardTray(this.props.reply);return}if(this.props.hasReply){const D=this.props.message;if(D?.user){this.setOPCardTray({parentMsgId:D.id,parentUid:D.user.userID,parentUserLogin:D.user.userLogin,parentDeleted:D.deleted,parentDisplayName:D.user.userDisplayName,parentMessageBody:D.messageBody});return}}const x=this.renderMessageAuthor;this.renderMessageAuthor=()=>this.ffzReplyAuthor();const k=this.props.message?.ffz_tokens;k&&(this.setMessageTray(this.props.message,l.chat.renderTokens(k,C)),this.renderMessageAuthor=x)},M.prototype.ffzReplyAuthor=function(){const x=l.chat.standardizeMessage(this.props.message),k=x.user,D=l.overrides.getColor(k.id)||k.color,O=l.parent.colors.process(D);let K=x.roomLogin?x.roomLogin:x.channel?x.channel.slice(1):void 0,X=x.roomId?x.roomId:this.props.channelID;if(!K&&X){const B=l.chat.getRoom(X,null,!0);B&&B.login&&(K=x.roomLogin=B.login)}if(!X&&K){const B=l.chat.getRoom(null,X,!0);B&&B.id&&(X=x.roomId=B.id)}const Q=l.chat.formatUser(k,C),P=l.overrides.getName(k.id);return C("span",{"data-room-id":X,"data-room":K,"data-user-id":k.userID,"data-user":k.userLogin&&k.userLogin.toLowerCase()},[C("span",{className:"chat-line__message--badges"},l.chat.badges.render(x,C)),C("span",{className:`chat-line__username notranslate${P?" ffz--name-override tw-relative ffz-il-tooltip__container":""}`,role:"button",style:{color:O},onClick:this.ffz_user_click_handler,onContextMenu:l.actions.handleUserContext},P?[C("span",{className:"chat-author__display-name"},P),C("div",{className:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},Q)]:Q)])},M.prototype.ffzRenderSharedChatPill=function(){let x=l.chat.context.get("chat.shared-chat.style");if(x==null&&(x=this.props.isCurrentUserModerator?2:0),x===0)return null;const k=this.props.message,D=k.sourceRoomID,O=D&&this.props.sharedChatDataByChannelID?.get(D),K=!O||D===(k.roomId??this.props.channelID);if(!O)return null;const X=l.i18n.t("chat.sent-from-source","Sent from {source}",{source:O.displayName??O.login});return x===1?C("span",{className:`ffz-pill ffz-tooltip tw-mg-r-05 ${K?"ffz-pill--brand":""}`,"data-title":X},`${O.displayName??O.login}`):x===2?C("figure",{className:`ffz-tooltip ffz-tooltip--no-mouse ffz-shared-chat-badge ffz-avatar tw-border-radius-rounded ${K?"ffz-shared-chat-badge--active":""} tw-mg-r-05`,"data-title":l.i18n.t("chat.sent-from-source","Sent from {source}",{source:O.displayName})},C("img",{className:"tw-block tw-border-radius-rounded tw-image",src:O.profileImageURL,alt:O.displayName})):null},M.prototype.ffzNewRender=function(){try{this._ffz_no_scan=!0;const x=l.chat.standardizeMessage(this.props.message),k=l.chat.context.get("chat.filtering.display-deleted");let D=this.props.deletedMessageDisplay;if(k?D=k:!this.props.isCurrentUserModerator&&D==="DETAILED"&&(D="LEGACY"),D==="BRIEF"&&x.deleted){const Et=this.props.deletedCount;return Et==null?null:C("div",{className:"chat-line__status"},l.i18n.t("chat.deleted-messages",`{count,plural,
one {One message was deleted by a moderator.}
other {# messages were deleted by a moderator.}
}`,{count:Et}))}const O=x.sourceRoomID,K=O&&this.props.sharedChatDataByChannelID?.get(O);let X=x.roomLogin?x.roomLogin:x.channel?x.channel.slice(1):void 0,Q=x.roomId?x.roomId:this.props.channelID;if(!X&&Q){const Et=l.chat.getRoom(Q,null,!0);Et&&Et.login&&(X=x.roomLogin=Et.login)}if(!Q&&X){const Et=l.chat.getRoom(null,X,!0);Et&&Et.id&&(Q=x.roomId=Et.id)}const P=l.site.getUser(),B={id:Q,login:X},G=!K||O===Q,J=G?B:{id:O,login:K.login},ot=l.chat.context.get("chat.replies.style"),ct=this.props&&!!(this.props.hasReply||this.props.reply||!this.props.replyRestrictedReason),gt=ct&&x.message&&!x.deleted&&!this.props.disableReplyClick,U=gt&&(ct||P&&P.login!==x.user?.login);P&&(P.moderator=this.props.isCurrentUserModerator,P.staff=this.props.isCurrentUserStaff,P.reply_mode=ot,P.can_reply=U),this.ffz_open_reply||(this.ffz_open_reply=this.ffzOpenReply.bind(this)),this.ffz_user_click_handler||(this.props.onUsernameClick?this.ffz_user_click_handler=Et=>{if(this.isKeyboardEvent(Et)&&Et.keyCode!==_.KEYS.Space&&Et.keyCode!==_.KEYS.Enter)return;const Tt=Et.currentTarget,Yt=Tt&&Tt.dataset;let Zt=x.user;if(Yt&&Yt.user)try{Zt=JSON.parse(Yt.user)}catch{}const ne=l.makeEvent({inst:this,event:Et,message:x,user:Zt,room:B,source:J});l.emit("chat:user-click",ne),!ne.defaultPrevented&&this.props.onUsernameClick(Zt.login,"chat_message",x.id,Tt.getBoundingClientRect().bottom)}:this.ffz_user_click_handler=this.openViewerCard||this.usernameClickHandler);let V,et,dt=null,yt=x.ffz_type&&l.line_types[x.ffz_type];if(!yt&&x.bits>0&&l.chat.context.get("chat.bits.cheer-notice")&&(yt=l.line_types.cheer),!yt&&x.ffz_type&&(yt=l.line_types.unknown),yt){if(yt.render)return yt.render(x,P,B,this,C);yt.renderNotice&&(V=yt.renderNotice(x,P,B,this,C)),yt.getClass&&(et=yt.getClass(x,P,B,this,C))}const xt=x.user,Ut=l.chat.context.get("chat.emotes.animated")===2;xt&&!xt.lowerLogin&&xt.userLogin&&(xt.lowerLogin=xt.userLogin.toLowerCase()),et=et||"";let $t,Gt,Ft=null;if(D==="BRIEF"?($t=!0,Gt=!1):D==="DETAILED"?($t=!0,Gt=x.deleted):($t=this.state?.alwaysShowMessage||!x.deleted,Gt=!1),x.deleted){const Et=l.chat.context.get("chat.filtering.display-mod-action");if(Et===2||Et===1&&D==="DETAILED"){const Tt=x.modActionType;Tt==="timeout"?Ft=l.i18n.t("chat.mod-action.timeout","{duration} Timeout",{duration:(0,o.print_duration)(x.duration||1)}):Tt==="ban"?Ft=l.i18n.t("chat.mod-action.ban","Banned"):(Tt==="delete"||!Tt)&&(Ft=l.i18n.t("chat.mod-action.delete","Deleted")),Ft&&x.modLogin&&(Ft=l.i18n.t("chat.mod-action.by","{action} by {login}",{login:x.modLogin,action:Ft})),Ft&&(Ft=C("span",{className:"tw-pd-l-05","data-test-selector":"chat-deleted-message-attribution"},`(${Ft})`))}}let Bt=null;const Qt=l.chat.context.get("chat.filtering.show-reasons");if(x.highlights?.size&&Qt){Bt=[];for(const Et of x.highlights){const Tt=l.chat._hl_reasons[Et];let Yt,Zt;Tt&&(Zt=Tt.i18n_key?l.i18n.t(Tt.i18n_key,Tt.title):Tt.title,Yt=Tt.i18n_label?l.i18n.t(Tt.i18n_label,Tt.label):Tt.label,Yt===Zt&&(Zt=null)),Yt||(Yt=Et),Bt.push(C("span",{className:`ffz-pill ffz-highlight-tag${Tt?" ffz-tooltip":""}`,"data-title":Zt},Yt))}Bt.length>0?Bt=C("span",{className:`ffz-highlight-tags ${Qt===1?"ffz-highlight-tags__above":"tw-mg-r-05"}`},Bt):Bt=null}const Ht=x.ffz_tokens=x.ffz_tokens||l.chat.tokenizeMessage(x,P),se=Ht.length>0||!V;let Kt;if(se){const Et=ot===2||ot===1&&this.props.repliesAppearancePreference&&this.props.repliesAppearancePreference!=="expanded"?x.ffz_reply=x.ffz_reply||l.chat.tokenizeReply(this.props.reply):null,Tt=l.parent.message_types&&l.parent.message_types.Action===x.messageType,Yt=this.props.isLastEmoteGigantified||(0,a._x)(x.ffz_reward),Zt=Tt?l.chat.context.get("chat.me-style"):0,ne=Zt>=2,ie=Zt===1||Zt===3,ae=l.overrides.getColor(xt.id)||xt.color,zt=l.parent.colors.process(ae),vt=$t&&g&&l.chat.pluckRichContent(Ht,x),Wt=Yt&&l.chat.pluckLastEmote(Ht,x),Vt=l.chat.formatUser(xt,C),Lt=l.overrides.getName(xt.id);let Ot=x.ffz_user_class;Ot instanceof Set?Ot=[...Ot].join(" "):Array.isArray(Ot)&&(Ot=Ot.join(" "));const Rt=K&&l.chat.context.get("chat.shared-chat.username-tooltip"),wt={className:`chat-line__username notranslate${Lt?" ffz--name-override":""}${Lt||Rt?" tw-relative ffz-il-tooltip__container":""} ${Ot??""}`,role:"button",style:{color:zt},onClick:this.ffz_user_click_handler,onContextMenu:l.actions.handleUserContext};x.ffz_user_props&&Object.assign(wt,x.ffz_user_props),x.ffz_user_style&&Object.assign(wt.style,x.ffz_user_style);const kt=C("span",wt,Lt?[C("span",{className:"chat-author__display-name"},Lt),C("div",{className:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},[Vt,Rt?C("div",{className:"tw-font-size-8 tw-mg-t-05"},l.i18n.t("chat.sent-from-source","Sent from {source}",{source:K.displayName??K.login})):null])]:Rt?[Vt,C("span",{className:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},l.i18n.t("chat.sent-from-source","Sent from {source}",{source:K.displayName??K.login}))]:Vt),Dt=this.props.showTimestamps||this.props.isHistorical?C("span",{className:"chat-line__timestamp"},l.chat.formatTime(x.timestamp)):null,At=$t&&ct&&Et?l.chat.renderTokens(Et,C):null,bt=x.ffz_reward_highlight&&l.chat.context.get("chat.points.allow-highlight")===1;Kt=[ot===1&&this.props.reply&&this.props.repliesAppearancePreference&&this.props.repliesAppearancePreference==="expanded"?this.renderReplyLine():null,K?this.ffzRenderSharedChatPill():null,Dt,x.ffz_no_actions?null:l.actions.renderInline(x,this.props.showModerationIcons,P,B,C,this),this.renderInlineHighlight?this.renderInlineHighlight():null,Qt===2?Bt:null,C("span",{className:"chat-line__message--badges"},l.chat.badges.render(x,C)),kt,C("span",{"aria-hidden":!0},Tt?" ":": "),At,$t?C("span",{className:`message ${ne?"chat-line__message-body--italicized":""} ${bt?"chat-line__message-body--highlighted":""}`,style:ie?{color:zt}:null},l.chat.renderTokens(Ht,C,ot!==0&&ct?this.props.reply:null)):C("span",{className:"chat-line__message--deleted"},C("a",{href:"",onClick:this.alwaysShowMessage},l.i18n.t("chat.message-deleted","<message deleted>"))),Ft,vt?C(g,vt):null,Wt?C("div",{className:"chat-line__message--ffz-giant-emote"},l.chat.renderGiantEmote(Wt,C)):null]}let Jt;if(V){const Et=Array.isArray(V.ffz_target);if(Kt)Et?V.ffz_icon&&V.ffz_target.unshift(V.ffz_icon):V.ffz_icon&&(V=[V.ffz_icon,V]),Kt=C("div",{className:"chat-line--inline chat-line__message","data-room-id":J?.id??x.roomId??B.id,"data-room":J?.login??x.roomLogin,"data-user-id":xt?.userID,"data-user":xt?.lowerLogin},Kt);else{const Tt=l.chat.context.get("chat.extra-timestamps"),Yt=Tt&&(this.props.showTimestamps||this.props.isHistorical)?C("span",{className:"chat-line__timestamp"},l.chat.formatTime(x.timestamp)):null,Zt=x.ffz_no_actions?null:l.actions.renderInline(x,this.props.showModerationIcons,P,B,C,this);Et?V.ffz_target.unshift(K?this.ffzRenderSharedChatPill():null,V.ffz_icon??null,Yt,Zt,Qt===2?Bt:null):V=[K?this.ffzRenderSharedChatPill():null,V.ffz_icon??null,Yt,Zt,Qt===2?Bt:null,V]}et=`${et} ffz-notice-line user-notice-line tw-pd-y-05`,Et||(V=C("div",{className:"tw-c-text-alt-2"},V)),Bt&&Qt===1?Jt=[Bt,V,Kt??null]:Kt?Jt=[V,Kt]:Jt=V}else et=`${et} chat-line__message`,Bt&&Qt===1?Jt=[Bt,Kt]:Jt=Kt;const St=xt&&x.id&&!x.ffz_no_actions?l.actions.renderHover(x,this.props.showModerationIcons,P,B,C,this):null;return St&&(et=`${et} tw-relative`,Jt=[C("div",{className:"chat-line__message-highlight tw-absolute tw-border-radius-medium tw-top-0 tw-bottom-0 tw-right-0 tw-left-0","data-test-selector":"chat-message-highlight"}),C("div",{className:"chat-line__message-container tw-relative"},Jt),St]),dt==null&&(dt=x.mentioned&&x.mention_color?l.parent.inverse_colors.process(x.mention_color):null),C("div",{className:`${et}${Gt?" ffz--deleted-message":""}${x.mentioned?" ffz-mentioned":""}${dt?" ffz-custom-color":""}`,style:{backgroundColor:dt},"data-room-id":J?.id??x.roomId??B.id,"data-room":J?.login??x.roomLogin,"data-user-id":xt?.userID,"data-user":xt?.lowerLogin,onMouseOver:Ut?l.chat.emotes.animHover:null,onMouseOut:Ut?l.chat.emotes.animLeave:null},Jt)}catch(x){l.log.error(x),l.log.capture(x,{extra:{props:this.props}});try{return console.log("trying old 1"),S.call(this)}catch(k){return l.log.error("An error in Twitch shit.",k),l.log.capture(k,{extra:{props:this.props}}),"An error occurred rendering this chat line."}}},M.prototype.render=M.prototype.ffzNewRender,setTimeout(()=>this.ChatLine.forceUpdate())}),this.ExtensionLine.ready(M=>{const S=M.prototype.render;M.prototype.render=function(){try{if(this._ffz_no_scan=!0,!this.props.installedExtensions)return null;const x=l.chat.standardizeMessage(this.props.message),k=x&&x.extension;if(!k||!this.props.installedExtensions.some(G=>{const J=G.extension;return J&&(J.clientId||J.clientID)===(k.clientId||k.clientID)&&J.version===k.version}))return null;const D=l.parent.colors.process(k.chatColor);let O=x.roomLogin?x.roomLogin:x.channel?x.channel.slice(1):void 0;if(!O&&this.props.channelID){const G=l.chat.getRoom(this.props.channelID,null,!0);G&&G.login&&(O=x.roomLogin=G.login)}const K=l.site.getUser(),X={id:this.props.channelID,login:O},Q=x.ffz_tokens=x.ffz_tokens||l.chat.tokenizeMessage(x,K),P=g&&l.chat.pluckRichContent(Q,x),B=x.mentioned&&x.mention_color?l.parent.inverse_colors.process(x.mention_color):null;return Q.length?C("div",{className:`chat-line__message${x.mentioned?" ffz-mentioned":""}${B?" ffz-custom-color":""}`,style:{backgroundColor:B},"data-room-id":X.id,"data-room":X.login,"data-extension":k.clientID},[this.props.showTimestamps&&C("span",{className:"chat-line__timestamp"},l.chat.formatTime(x.timestamp)),C("span",{className:"chat-line__message--badges"},l.chat.badges.render(x,C)),C("span",{className:"chat-line__username notranslate",role:"button",style:{color:D},onClick:this.onExtensionNameClick},C("span",{className:"chat-author__display-name"},k.displayName)),C("span",null,": "),C("span",{className:"message"},l.chat.renderTokens(Q,C)),P&&C(g,P)]):null}catch(x){return l.log.info(x),l.log.capture(x,{extra:{props:this.props}}),S.call(this)}},setTimeout(()=>this.ExtensionLine.forceUpdate())})}checkEffects(){for(const l of this.ChatLine.instances){const u=l.props.message,C=u?.ffz_tokens;if(C)for(const g of C)g.type==="emote"&&g.modifier_flags&&this.emotes.ensureEffect(g.modifier_flags)}for(const l of this.WhisperLine.instances){const u=l.props.message?._ffz_message,C=u?.ffz_tokens;if(C)for(const g of C)g.type==="emote"&&g.modifier_flags&&this.emotes.ensureEffect(g.modifier_flags)}}updateLineById(l,u=!0,C=null){C==null&&(C=u);for(const g of this.ChatLine.instances){const M=g.props.message;if(M?.id===l){C&&(M.ffz_badges=M.ffz_badge_cache=null),u&&(M.ffz_tokens=null,M.ffz_reply=null,M.highlights=M.mentioned=M.mention_color=M.color_priority=null),g.forceUpdate();return}}for(const g of this.WhisperLine.instances){const M=g.props.message?._ffz_message;if(M?.id===l){(C||u)&&(M._ffz_message=null),g.forceUpdate();return}}}updateLinesByUser(l,u,C=!0,g=!0){for(const M of this.ChatLine.instances){const S=M.props.message,x=S?.user;x&&(l&&l==x.id||u&&u==x.login)&&(g&&(S.ffz_badges=S.ffz_badge_cache=null),C&&(S.ffz_tokens=null,S.ffz_reply=null,S.highlights=S.mentioned=S.mention_color=S.color_priority=null),M.forceUpdate())}for(const M of this.WhisperLine.instances){const S=M.props.message?._ffz_message,x=S?.user;x&&(l&&l==x.id||u&&u==x.login)&&(S._ffz_message=null,M.forceUpdate())}}maybeUpdateLines(){this.chat.context.get("chat.rich.all-links")&&this.updateLines()}updateLines(){return this._updateLines()}rerenderLines(){return this._updateLines(!1,!1)}updateLineTokens(){return this._updateLines(!0,!1)}updateLineBadges(){return this._updateLines(!1,!0)}_updateLines(l=!0,u=!0){for(const C of this.ChatLine.instances){const g=C.props.message;g&&(u&&(g.ffz_badge_cache=g.ffz_badges=null),l&&(g.ffz_tokens=null,g.ffz_reply=null,g.highlights=g.mentioned=g.mention_color=g.mention_priority=g.clear_priority=null))}for(const C of this.ExtensionLine.instances){const g=C.props.message;g&&(u&&(g.ffz_badge_cache=g.ffz_badges=null),l&&(g.ffz_tokens=null,g.ffz_reply=null,g.highlights=g.mentioned=g.mention_color=g.mention_priority=g.clear_priority=null))}for(const C of this.WhisperLine.instances){const g=C.props.message;g&&g._ffz_message&&(g._ffz_message=null)}this.ChatLine.forceUpdate(),this.ExtensionLine.forceUpdate(),this.WhisperLine.forceUpdate(),this.emit("chat:updated-lines")}};$(fe,"ChatLine");let d=fe;var m=f(44589),w=f(17159);const pe=class pe extends b.default{constructor(...l){super(...l),this.inject("settings"),this.inject("i18n"),this.inject("chat"),this.inject("chat.badges"),this.inject("site.fine"),this.inject("site"),this.inject("site.css_tweaks"),this.settings.add("chat.input.hide-identity",{default:!1,ui:{path:"Chat > Input >> Appearance",title:'Display "Chat Identity" in the chat settings menu rather than the input box.',component:"setting-check-box"}}),this.SettingsMenu=this.fine.define("chat-settings",u=>u.renderUniversalOptions&&u.onBadgesChanged,v.Z.CHAT_ROUTES)}async onEnable(){this.on("i18n:update",()=>this.SettingsMenu.forceUpdate()),this.chat.context.on("changed:chat.scroller.freeze",()=>this.SettingsMenu.forceUpdate()),this.chat.context.on("changed:chat.input.hide-identity",g=>{this.css_tweaks.toggle("hide-chat-identity",g),this.SettingsMenu.forceUpdate()}),this.css_tweaks.toggle("hide-chat-identity",this.chat.context.get("chat.input.hide-identity"));const l=this,u=await this.site.findReact();if(!u)return;const C=u.createElement;this.SettingsMenu.ready(g=>{const M=g.prototype.render,S=g.prototype.renderUniversalOptions;g.prototype.renderUniversalOptions=function(){const x=S.call(this);return this.ffzSettingsClick||(this.ffzSettingsClick=k=>l.click(this,k)),this.ffzPauseClick||(this.ffzPauseClick=()=>this.setState({ffzPauseMenu:!this.state.ffzPauseMenu})),x.props.children.push(C("div",{class:"tw-full-width tw-relative"},C("button",{class:"tw-block tw-border-radius-medium tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive",onClick:this.ffzSettingsClick},C("div",{class:"tw-align-items-center tw-flex tw-pd-05 tw-relative"},C("div",{class:"tw-flex-grow-1"},l.i18n.t("site.menu_button","FrankerFaceZ Control Center")))),l.cant_window&&C("div",{class:"tw-mg-t-05 tw-c-text-alt-2"},C("span",{class:"ffz-i-attention"},l.i18n.t("popup.error","We tried opening a pop-up window and could not. Make sure to allow pop-ups from Twitch."))))),x},g.prototype.ffzRenderIdentity=function(){if(!this.state||!this.props||this.state.moderatorMode||this.state.chatAppearance||this.state.chatPause||this.state.followerMode||this.state.recentRaids||this.state.repliesAppearance||this.state.slowMode||this.props.isShowingChatFilterSettings||this.props.isShowingDeletedMessageDisplaySettings||!this.props.isLoggedIn||!l.chat.context.get("chat.input.hide-identity"))return null;const x=this.props.data?.currentUser,k=this.props.data?.user?.self?.displayBadges;if(!x||!x.login||!Array.isArray(k))return null;const D=x.login&&x.displayName&&x.displayName.trim().toLowerCase()!==x.login,O=l.parent.colors.process(x.chatColor),K={};for(const Q of k)Q?.setID&&Q.version&&(K[Q.setID]=Q.version);this._ffzIdentityClick||(this._ffzIdentityClick=()=>{document.querySelector('button[data-a-target="chat-badge-carousel-badge-icon"]').click(),this.props.onCloseSettings()});const X={user:x,badges:K,ffz_badges:l.badges.getBadges(x.id,x.login,this.props.channelID,this.props.channelLogin),roomID:this.props.channelID,roomLogin:this.props.channelLogin};return this._ffzIdentityMsg=X,C("div",{class:"ffz-identity"},C("div",{class:"tw-mg-y-05 tw-pd-x-05"},C("p",{class:"tw-c-text-alt-2 tw-font-size-6 tw-strong tw-upcase"},l.i18n.t("chat.identity-menu","Chat Identity"))),C("div",{class:"tw-full-width tw-relative"},C("button",{class:"tw-block tw-border-radius-medium tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive",onClick:this._ffzIdentityClick},C("div",{class:"tw-align-items-center tw-flex tw-pd-05 tw-relative"},C("div",{class:"tw-flex-grow-1"},C("span",{class:"ffz--editor-name"},C("span",{class:"ffz--editor-badges","data-room-id":this.props.channelID,"data-room":this.props.channelLogin},l.badges.render(X,C,!0,!0)),C("span",{class:"tw-strong notranslate",style:{color:O}},C("span",{class:"name-display__name"},x.displayName||x.login),D&&C("span",{class:"intl-name"}," (",x.login,") ")))),C("div",{class:"tw-align-items-center tw-flex tw-flex-shrink-0 tw-mg-l-05"},C("figure",{class:"ffz-i-right-open"}))))))},g.prototype.render=function(){const x=M.call(this);try{const k=x?.props?.children?.props?.children?.props?.children?.[1]?.props?.children?.props?.children;if(Array.isArray(k)){const D=this.ffzRenderIdentity();D&&k.unshift(D)}}catch(k){l.log.error("Error rendering chat settings menu.",k)}return x},this.SettingsMenu.forceUpdate()}),this.SettingsMenu.on("update",this.updateSettingsMenu,this),this.SettingsMenu.on("unmount",g=>{g.ffzSettingsClick=null})}updateSettingsMenu(l){const u=this.fine.getChildNode(l);if(!u||!document.contains(u))return;let C;if(l.props?.editAppearance){this.registerBadgePicker();const D=u.querySelector('span[data-a-target="edit-display-name"]');C=D&&D.closest(".tw-mg-t-1")}else C=u.querySelector('.name-display > div:not([data-test-selector="edit-appearance-button"])');if(!C||!u.contains(C))return;const g=l.props?.data?.currentUser,M=l.props?.data?.user?.self?.displayBadges;if(!g||!g.login||!Array.isArray(M))return;const S=g.login&&g.displayName&&g.displayName.trim().toLowerCase()!==g.login,x=this.parent.colors.process(g.chatColor),k={};for(const D of C.children)D?.classList&&(D.classList.contains("ffz--editor-name")?D.remove():D.classList.add("tw-hide"));for(const D of M)D?.setID&&D.version&&(k[D.setID]=D.version);C.appendChild((0,m.createElement)("span",{className:"ffz--editor-name"},[(0,m.createElement)("span",{className:"ffz--editor-badges","data-room-id":l.props.channelID,"data-room-login":l.props.channelLogin},this.badges.render({user:g,badges:k,ffz_badges:this.badges.getBadges(g.id,g.login,l.props.channelID,l.props.channelLogin),roomID:l.props.channelID,roomLogin:l.props.channelLogin},m.createElement,!0,!0)),(0,m.createElement)("span",{class:"tw-strong notranslate",style:{color:x}},(0,m.createElement)("span",{class:"name-display__name"},g.displayName||g.login),S&&(0,m.createElement)("span",{class:"intl-name"}," (",g.login,")"))]))}registerBadgePicker(){this.BadgePicker||(this.BadgePicker=this.fine.define("badge-picker",l=>l.onGlobalBadgeClicked&&l.onGlobalBadgeKeyPress,v.Z.CHAT_ROUTES),this.BadgePicker.on("mount",this.updateBadgePicker,this),this.BadgePicker.on("update",this.updateBadgePicker,this),this.BadgePicker.ready((l,u)=>{for(const C of u)this.updateBadgePicker(C)}))}updateBadgePicker(l){const u=this.fine.getChildNode(l);if(!u){l.props?.data?.loading===!1&&!l._ffz_try_again&&(l._ffz_try_again=requestAnimationFrame(()=>this.updateBadgePicker(l)));return}const C=u.querySelector(".tw-flex-column");if(!C)return;const g=this.badges.getBadges(l.props.userID,l.props.userLogin);let M;for(const D of g){const O=this.badges.badges[D?.id];O&&!O.addon&&(M=O)}const S=C.querySelector(".ffz--badge-selector");if(S){M||S.remove();return}else if(!M)return;const x=(0,m.createElement)("div",{class:"ffz--badge-selector tw-border-b tw-mg-b-1"},(0,m.createElement)("div",{class:"tw-mg-y-05 tw-pd-x-05"},(0,m.createElement)("p",{class:"tw-c-text-alt-2 tw-font-size-6 tw-strong tw-upcase"},this.i18n.t("chat.ffz-badge.title","FrankerFaceZ Badge"))),(0,m.createElement)("div",null,(0,m.createElement)("p",{class:"tw-mg-b-05 tw-pd-x-05"},this.i18n.tList("chat.ffz-badge.about","This badge appears globally for users with FrankerFaceZ. Please visit the {website} to change this badge.",{website:(0,m.createElement)("a",{href:"https://www.frankerfacez.com/subscribe",class:"ffz-link",rel:"noopener noreferrer",target:"_blank"},this.i18n.t("chat.ffz-badge.site-link","FrankerFaceZ website"))}))),(0,m.createElement)("div",{role:"radiogroup",class:"tw-align-items-center tw-flex tw-flex-wrap tw-mg-b-05 tw-mg-t-05 tw-pd-x-05"},(0,m.createElement)("div",{class:"tw-mg-r-1 tw-mg-y-05"},(0,m.createElement)("div",{class:"tw-inline-flex"},(0,m.createElement)("div",{class:"edit-appearance__badge-chooser edit-appearance__badge-chooser--selected tw-border-radius-small"},(0,m.createElement)("img",{alt:M.title,src:M.urls[2],srcset:`${M.urls[2]} 1x, ${M.urls[4]} 2x`,style:{backgroundColor:M.color||"transparent"},role:"radio","aria-checked":"true",class:"tw-full-height tw-full-width"})))))),k=C.querySelector('[data-test-selector="global-badges-test-selector"]')?.nextElementSibling;k?C.insertBefore(x,k):C.appendChild(x)}closeMenu(l){const u=this.fine.searchParent(l,g=>g.setChatInputRef&&g.setAutocompleteInputRef,100),C=u&&this.fine.searchTree(u,g=>g.props&&g.props.isSettingsOpen&&g.onClickSettings);C&&C.onClickSettings()}click(l,u){const C=u.currentTarget,g=C&&C.dataset&&C.dataset.page,M=new w.FFZEvent({item:g,event:u,errored:!1});if(this.emit("main_menu:open",M),M.errored){this.cant_window=!0,this.SettingsMenu.forceUpdate();return}this.closeMenu(l)}};$(pe,"SettingsMenu");let h=pe;var p=f(49276),z=f(90424),R=f.n(z);const I={1e3:"Tier 1",2e3:"Tier 2",3e3:"Tier 3"},j=["the_horns","raised_back_of_hand","ok_hand","+1","clap","fist","pinched_fingers","wave","pinch","victory","love_you_gesture"];function F(Mt,l){l||(l=Mt.closest(".simplebar-scroll-content")??Mt.parentElement);const u=l.offsetHeight,C=Mt.offsetHeight,g=Mt.offsetTop;if(C>=u){l.scrollTop=g;return}const M=g+C/2-u/2;l.scrollTop=M}$(F,"scrollIntoView");function H(Mt){if(!Mt)return Mt;try{return new Date(Mt)}catch{return null}}$(H,"maybe_date");const Y=window?.Intl?.Collator&&new Intl.Collator(void 0,{numeric:!0}),st=[$(function(l,u){return Y?Y.compare(l.id,u.id):l.id<u.id?-1:l.id>u.id?1:0},"id_asc"),$(function(l,u){return Y?Y.compare(u.id,l.id):l.id>u.id?-1:l.id<u.id?1:0},"id_desc"),$(function(l,u){const C=l.name.toLowerCase(),g=u.name.toLowerCase();return C<g?-1:C>g?1:Y?Y.compare(l.id,u.id):l.id<u.id?-1:l.id>u.id?1:0},"name_asc"),$(function(l,u){const C=l.name.toLowerCase(),g=u.name.toLowerCase();return C>g?-1:C<g?1:Y?Y.compare(u.id,l.id):l.id>u.id?-1:l.id<u.id?1:0},"name_desc"),$(function(l,u){if(l.order!=null||u.order!=null){if(l.order&&u.order==null)return-1;if(u.order&&l.order==null)return 1;if(l.order<u.order)return-1;if(l.order>u.order)return 1}return Y?Y.compare(l.id,u.id):l.id<u.id?-1:l.id>u.id?1:0},"native_asc"),$(function(l,u){if(l.order!=null||u.order!=null){if(l.order&&u.order==null)return 1;if(u.order&&l.order==null)return-1;if(l.order<u.order)return 1;if(l.order>u.order)return-1}return Y?Y.compare(l.id,u.id):l.id<u.id?1:l.id>u.id?-1:0},"native_desc")];function tt(Mt,l){const u=Mt.sort_key,C=l.sort_key;if(u<C)return-1;if(C<u)return 1;const g=Mt.title.toLowerCase(),M=l.title.toLowerCase();return g<M?-1:M<g?1:0}$(tt,"sort_sets");const me=class me extends b.default{constructor(...l){super(...l),this.inject("staging"),this.inject("settings"),this.inject("i18n"),this.inject("chat"),this.inject("chat.badges"),this.inject("chat.emotes"),this.inject("chat.emoji"),this.inject("site"),this.inject("site.fine"),this.inject("site.apollo"),this.inject("site.css_tweaks"),this.SUB_STATUS=R(),this.settings.add("chat.emote-menu.shortcut",{default:!1,ui:{path:"Chat > Emote Menu >> General",title:"Use Ctrl+E to open the Emote Menu.",description:"When enabled and you press Ctrl+E with the chat input focused, the emote menu will open.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.modifiers",{default:0,ui:{path:"Chat > Emote Menu >> General",title:"Emote Modifiers",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"In-Line"}]}}),this.settings.add("chat.emote-menu.clear-search",{default:!1,ui:{path:"Chat > Emote Menu >> General",title:"Reset search when closing the Emote Menu.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.enabled",{default:!0,ui:{path:"Chat > Emote Menu >> General",title:"Use the FrankerFaceZ Emote Menu.",description:"The FFZ emote menu replaces the built-in Twitch emote menu and provides enhanced functionality.",component:"setting-check-box"},changed:()=>this.EmoteMenu.forceUpdate()}),this.settings.add("chat.emote-menu.icon",{requires:["chat.emote-menu.enabled","context.bttv.emote_menu"],default:!1,process(u,C){return u.get("chat.emote-menu.enabled")?u.get("context.bttv.emote_menu")||C:!1},ui:{path:"Chat > Emote Menu >> Appearance",title:"Replace the emote menu icon with the FFZ icon for that classic feel.",description:"**Note:** This setting may be forcibly enabled if other emote menus are detected, to ensure you can visually identify the FFZ Emote Menu.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.show-quick-nav",{default:!1,ui:{path:"Chat > Emote Menu >> Appearance",title:"Show a quick navigation bar along the side of the menu.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.tall",{default:!1,ui:{path:"Chat > Emote Menu >> Appearance",title:"Use extra height for the emote menu.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.show-heading",{default:1,ui:{path:"Chat > Emote Menu >> Appearance",title:"Show Headers",component:"setting-select-box",data:[{value:0,title:"Never"},{value:1,title:"Always"},{value:2,title:"When Not Searching"}]}}),this.settings.add("chat.emote-menu.show-search",{default:!0,ui:{path:"Chat > Emote Menu >> Appearance",title:"Show the search box.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.reduced-padding",{default:!1,ui:{path:"Chat > Emote Menu >> Appearance",title:"Use reduced padding.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.default-tab",{default:"channel",ui:{path:"Chat > Emote Menu >> General",title:"Default Tab",component:"setting-select-box",data:[{value:"fav",title:"Favorites"},{value:"channel",title:"Channel"},{value:"effect",title:"Emote Effects"},{value:"all",title:"My Emotes"},{value:"emoji",title:"Emoji"}]}}),this.settings.add("chat.emote-menu.effect-tab",{default:!0,ui:{path:"Chat > Emote Menu >> General",title:"Display Emote Effects in their own tab.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.tooltips",{default:!0,ui:{path:"Chat > Emote Menu >> Appearance",title:"Display emote preview tool-tips in the FFZ Emote Menu.",component:"setting-check-box",description:"You may wish to disable this for performance reasons."}}),this.settings.add("chat.emote-menu.show-emoji",{default:!0,ui:{path:"Chat > Emote Menu >> General",title:"Display emoji in the emote menu.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.combine-tabs",{default:!1,ui:{path:"Chat > Emote Menu >> General",title:"Display all emotes on one tab.",component:"setting-check-box"}}),this.settings.add("chat.emote-menu.stay-loaded",{requires:["chat.emote-menu.combine-tabs"],default:null,process(u,C){return C==null&&(C=u.get("chat.emote-menu.combine-tabs")),C},ui:{path:"Chat > Emote Menu >> General",title:"Stay loaded after opening.",component:"setting-check-box",description:"This causes the emote menu to stay in the DOM even when it's not visible. Enabling this may help the site perform better when opening the menu if it's slow. By default, this setting is enabled when using `Display all emotes on one tab.`"}}),this.settings.add("chat.emote-menu.sort-emotes",{default:4,ui:{path:"Chat > Emote Menu >> Sorting",title:"Sort Emotes By",component:"setting-select-box",data:[{value:4,title:"Native Order, Ascending"},{value:5,title:"Native Order, Descending"},{value:0,title:"Order Added (ID), Ascending"},{value:1,title:"Order Added (ID), Descending"},{value:2,title:"Name, Ascending"},{value:3,title:"Name, Descending"}]}}),this.settings.add("chat.emote-menu.sort-tiers-last",{default:!0,ui:{path:"Chat > Emote Menu >> Sorting",title:"List emotes from higher sub tiers last.",component:"setting-check-box"}}),this.EmoteMenu=this.fine.define("chat-emote-menu",u=>u.getAllEmoteSets&&u.getSortedChannelEmotes&&u.props?.emotePickerSource,v.Z.CHAT_ROUTES),this.MenuWrapper=this.fine.wrap("ffz-emote-menu")}async onEnable(){this.on("i18n:update",()=>this.EmoteMenu.forceUpdate()),this.on("chat.emotes:update-default-sets",this.maybeUpdate,this),this.on("chat.emotes:update-user-sets",this.maybeUpdate,this),this.on("chat.emotes:update-room-sets",this.maybeUpdate,this),this.on("chat.emotes:loaded",this.maybeUpdate,this),this.on("chat.emotes:change-favorite",this.maybeUpdate,this),this.on("chat.emotes:change-hidden",this.maybeUpdate,this),this.on("chat.emoji:populated",this.maybeUpdate,this),this.chat.context.on("changed:chat.emote-menu.enabled",()=>this.EmoteMenu.forceUpdate());const l=$(()=>{for(const M of this.MenuWrapper.instances)M.rebuildData()},"rebuild");this.chat.context.on("changed:chat.emotes.enabled",l),this.chat.context.on("changed:chat.emote-menu.modifiers",l),this.chat.context.on("changed:chat.emote-menu.show-emoji",l),this.chat.context.on("changed:chat.emote-menu.tooltips",l),this.chat.context.on("changed:chat.fix-bad-emotes",l),this.chat.context.on("changed:chat.emote-menu.effect-tab",l),this.chat.context.on("changed:chat.emote-menu.sort-emotes",l),this.chat.context.on("changed:chat.emote-menu.sort-tiers-last",l),this.chat.context.on("changed:chat.emoji.style",this.updateEmojiVariables,this),this.chat.context.getChanges("chat.emote-menu.icon",M=>this.css_tweaks.toggle("emote-menu",M)),this.updateEmojiVariables(),this.css_tweaks.setVariable("emoji-menu--sheet","//cdn.frankerfacez.com/static/emoji/images/sheet-twemoji-36.png"),this.css_tweaks.setVariable("emoji-menu--count",58),this.css_tweaks.setVariable("emoji-menu--size",36);const u=this,C=await this.site.findReact(),g=C&&C.createElement;if(!g)return u.log.warn("Unable to get React.");this.defineClasses(),this.EmoteMenu.ready(M=>{const S=M.prototype.render;M.prototype.render=function(){return this._ffz_no_scan=!1,!this.props||this.props.emotePickerSource==="bits-rewards"||!(0,y.has)(this.props,"channelID")||!u.chat.context.get("chat.emote-menu.enabled")?S.call(this):g(u.MenuErrorWrapper,{visible:this.props.visible},g(u.MenuComponent,{source:this.props.emotePickerSource,visible:this.props.visible,toggleVisibility:this.props.toggleVisibility,channel_data:this.props.channelData,emote_data:this.props.emoteSetsData,user_id:this.props.currentUserID,channel_id:this.props.channelID,loading:this.props.channelData?.loading||this.props.emoteSetsData?.loading,error:this.props.channelData?.error||this.props.emoteSetsData?.error,onClickToken:this.props.onClickToken}))},this.EmoteMenu.forceUpdate()})}updateEmojiVariables(){const l=this.chat.context.get("chat.emoji.style")||"twitter",u=`//cdn.frankerfacez.com/static/emoji/images/sheet-${p.Vf[l]||"twemoji"}-`,C=this.emoji_size=36,g=this.emoji_sheet_count=58,M=this.emoji_sheet_size=g*(C+2),S=this.emoji_sheet_pct=100*M/C;this.emoji_sheet_remain=M-C,this.css_tweaks.set("emoji-menu",`.ffz--emoji-tone-picker__emoji,.emote-picker__emoji .emote-picker__emote-figure {
	background-size: ${S}% ${S}%;
	background-image: url("${u}36.png");
	background-image: ${_.WEBKIT_CSS}image-set(
		url("${u}18.png") 0.5x,
		url("${u}36.png") 1x,
		url("${u}72.png") 2x
	);
}`)}maybeUpdate(){if(this.chat.context.get("chat.emote-menu.enabled"))for(const l of this.MenuWrapper.instances)l.rebuildData()}defineClasses(){var k,D,O,K,X;const l=this,u=this.settings.provider,C=this.site.getReact(),g=C&&C.createElement;this.EmojiTonePicker=(k=class extends C.Component{constructor(P){super(P),this.onClick=()=>this.setState({open:!this.state.open}),this.onMouseEnter=()=>this.state.open||this.setState({emoji:this.pickRandomEmoji()}),this.onClickOutside=()=>this.state.open&&this.setState({open:!1}),this.clickTone=B=>{this.props.pickTone(B.currentTarget.dataset.tone),this.setState({open:!1})},this.element=null,this.saveRef=B=>this.element=B,this.state={open:!1,emoji:this.pickRandomEmoji(),tone:null}}componentDidMount(){this.element&&(this._clicker=new m.ClickOutside(this.element,this.onClickOutside))}componentWillUnmount(){this._clicker&&(this._clicker.destroy(),this._clicker=null)}pickRandomEmoji(){const P=this.props.choices,B=Math.floor(Math.random()*P.length);return P[B]}renderTone(P,B){return P?g("button",{key:P.code,"data-tone":B,class:"tw-interactive tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive tw-pd-y-05 tw-pd-x-2",onClick:this.clickTone},this.renderEmoji(P)):null}renderToneMenu(){if(!this.state.open)return null;const P=this.state.emoji;if(!P||!P.variants)return null;const B=Object.entries(P.variants).map(([G,J])=>this.renderTone(J,G));return g("div",{class:"tw-absolute ffz-balloon ffz-il-tooltip--up ffz-il-tooltip--align-right ffz-balloon tw-block"},g("div",{class:"tw-border-b tw-border-l tw-border-r tw-border-t tw-border-radius-medium tw-c-background-base tw-elevation-1"},this.renderTone(P,null),B))}renderEmoji(P){if(!P)return null;const B=P.sheet_x*(l.emoji_size+2)+1,G=P.sheet_y*(l.emoji_size+2)+1,J=100*B/l.emoji_sheet_remain,ot=100*G/l.emoji_sheet_remain;return g("figure",{class:"ffz--emoji-tone-picker__emoji",style:{backgroundPosition:`${J}% ${ot}%`}})}render(){const P=this.state.emoji,B=this.props.tone,G=B&&P.variants[B];return g("div",{ref:this.saveRef,class:"ffz--emoji-tone-picker tw-relative tw-mg-l-1"},g("button",{class:"tw-interactive tw-button tw-button--dropmenu ffz-button--hollow",onClick:this.onClick,onMouseEnter:this.onMouseEnter},g("span",{class:"tw-button__text"},this.renderEmoji(G||P)),g("span",{class:"tw-button__icon tw-button__icon--right"},g("figure",{class:"ffz-i-down-dir"}))),this.renderToneMenu())}},$(k,"FFZEmojiTonePicker"),k),this.MenuSection=(D=class extends C.Component{constructor(P){super(P),this.ref=null,this.saveRef=J=>{this.ref&&this.props.stopObserving(this.ref),this.ref=J,J&&this.props.startObserving(this.ref,this)};const B=u.get("emote-menu.collapsed"),G=u.get("emote-menu.hidden-sets");this.state={active:!1,activeEmote:-1,hidden:G&&P.data&&G.includes(P.data.hide_key||P.data.key),collapsed:B&&P.data&&B.includes(P.data.key),intersecting:!window.IntersectionObserver},this.keyHeading=this.keyHeading.bind(this),this.clickHeading=this.clickHeading.bind(this),this.clickEmote=this.clickEmote.bind(this),this.mouseEnter=()=>this.state.intersecting||this.setState({intersecting:!0}),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this)}componentDidMount(){this.props.addSection(this),this.ref&&this.props.startObserving(this.ref,this)}componentWillUnmount(){this.props.removeSection(this),this.ref&&this.props.stopObserving(this.ref)}keyInteract(P){}clickEmote(P){if(this.props.visibility_control){const ct=P.currentTarget.dataset;let gt,U=ct.id;if(ct.provider==="twitch")gt="twitch";else if(ct.provider==="ffz"){const V=l.emotes.emote_sets[ct.set],et=V&&V.emotes[U];if(!et)return;gt=V.source||"ffz",U=et.id}else return;l.emotes.toggleHidden(gt,U);return}if(l.emotes.handleClick(P,!0))return;let B="",G="";const J=P.currentTarget.dataset.effects,ot=P.currentTarget.dataset.effectPrefix==="true";J?.length>0&&J!="0"&&l.emotes.target_emote&&(ot?G=` ${l.emotes.target_emote.name}`:B=`${l.emotes.target_emote.name} `),this.props.onClickToken(`${B}${P.currentTarget.dataset.name}${G}`)}keyHeading(P){(P.keyCode===_.KEYS.Enter||P.keyCode===_.KEYS.Space)&&this.clickHeading()}clickHeading(){if(this.props.visibility_control){const ot=u.get("emote-menu.hidden-sets")||[],ct=this.props.data.hide_key||this.props.data.key,gt=ot.indexOf(ct);if(ct==="twitch-current-channel")return;gt===-1?(ot.push(ct),this.setState({hidden:!0})):(ot.splice(gt,1),this.setState({hidden:!1})),u.set("emote-menu.hidden-sets",ot),l.emit("chat.emotes:change-set-hidden",ct);return}if(this.props.filtered)return;const P=u.get("emote-menu.collapsed")||[],B=!this.state.collapsed,G=this.props.data.key,J=P.indexOf(G);if(this.setState({collapsed:B}),B&&J===-1)P.push(G);else if(!B&&J!==-1)P.splice(J,1);else return;u.set("emote-menu.collapsed",P)}onMouseEnter(P){const B=P.currentTarget.dataset.setId;this.setState({unlocked:B})}onMouseLeave(){this.setState({unlocked:null})}render(){const P=this.props.data,B=this.props.filtered,G=this.props.visibility_control;let J=!(P.is_favorites&&!this.props.combineTabs)&&this.props.showHeading;J===2?J=!B:J=!!J,G&&(J=!0);const ot=G?this.state.hidden:!1,ct=G?ot:J&&!B&&this.state.collapsed;if(!P)return null;let gt;P.image?gt=g("img",{class:`ffz--menu-badge${P.image_large?" ffz--menu-badge__large":""}`,src:P.image,srcSet:P.image_set}):gt=g("figure",{class:`ffz--menu-badge ffz-i-${P.icon||"zreknarf"}`});let U;const V=P.renews&&P.renews.getTime(),et=P.ends&&P.ends.getTime();V>0?U={icon:"calendar",message:l.i18n.t("emote-menu.sub-renews","This sub renews {seconds,humantime}.",{seconds:V})}:et&&(P.prime?U={icon:"crown",message:l.i18n.t("emote-menu.sub-prime",`This is your free sub with Prime Gaming.
It ends {seconds,humantime}.`,{seconds:et})}:P.gift?U={icon:"gift",message:l.i18n.t("emote-menu.sub-gift-ends","This gifted sub ends {seconds,humantime}.",{seconds:et})}:U={icon:"calendar-empty",message:l.i18n.t("emote-menu.sub-ends","This sub ends {seconds,humantime}.",{seconds:et})});let dt=P.source_i18n?l.i18n.t(P.source_i18n,P.source):P.source;return dt==null&&(dt="FFZ"),g("section",{ref:this.saveRef,"data-key":P.key,class:B?"filtered":"",onMouseEnter:this.mouseEnter},J?g("heading",{tabindex:"0",class:"tw-pd-1 tw-border-b tw-flex tw-flex-nowrap",onKeyDown:this.keyHeading,onClick:this.clickHeading},gt,g("div",{class:"tw-pd-l-05"},(P.i18n?l.i18n.t(P.i18n,P.title):P.title)||l.i18n.t("emote-menu.unknown","Unknown Source"),!G&&U&&g("span",{class:`tw-mg-x-05 ffz--expiry-info ffz-tooltip ffz-i-${U.icon}`,"data-tooltip-type":"html","data-title":U.message})),g("div",{class:"tw-flex-grow-1"}),g("span",{class:!G&&P.channel_source?"ffz-tooltip":"","data-title":P.channel_source},G?ot?l.i18n.t("emote-menu.visibility.hidden","Hidden"):l.i18n.t("emote-menu.visibility.visible","Visible"):dt),!G&&B?"":g("figure",{class:`tw-pd-l-05 ffz-i-${ct?"left":"down"}-dir`})):null,ct||this.renderBody(J))}renderBody(P){const B=this.props.data,G=this.props.filtered,J=B.locks&&B.locks[this.state.unlocked],ot=B.filtered_emotes&&B.filtered_emotes.map(ct=>{if(G&&ct.locked)return;const gt=ct.locked&&(!J||!J.emotes.has(ct.id)),U=gt&&B.locks&&B.locks[ct.set_id];let V="";return U&&(U.id==="subwoofer"?V=l.i18n.t("emote-menu.emote-subwoofer","Become an FFZ Subwoofer to unlock this emote."):U.id==="cheer"?V=l.i18n.t("emote-menu.emote-cheer","Cheer an additional {bits_remaining, plural, one {# bit} other {# bits}} to unlock this emote.",U):U.id==="follower"?V=l.i18n.t("emote-menu.emote-follower","Follow {user} to unlock this emote in their channel.",U):B.all_locked?V=l.i18n.t("emote-menu.emote-sub","Subscribe for {price} to unlock this emote.",U):V=l.i18n.t("emote-menu.emote-up","Upgrade your sub to {price} to unlock this emote.",U)),this.renderEmote(ct,gt,P,V)});return g("div",{class:"tw-pd-1 tw-border-b tw-c-background-alt tw-align-center"},ot,!this.props.visibility_control&&!G&&this.renderSellout())}renderEmote(P,B,G,J){if(!this.state.intersecting)return g("span",{key:P.id,class:"emote-picker__placeholder",style:{width:`${P.width||28}px`,height:`${P.height||28}px`}});const ot=this.props.visibility_control,ct=this.props.emote_modifiers[P.id],gt=Array.isArray(ct)&&ct.length>0,U=this.props.animated,V=ot&&P.hidden,et=l.chat.context.get("chat.emote-menu.tooltips");let dt,yt;return U&&P.animSrc?(dt=P.animSrc,yt=P.animSrcSet):(dt=P.src,yt=P.srcSet),g("button",{key:P.id,class:`${et?"ffz-tooltip ":""}emote-picker__emote-link${!ot&&B?" locked":""}${V?" emote-hidden":""}`,"data-tooltip-type":"emote","data-provider":P.provider,"data-id":P.id,"data-set":P.set_id,"data-code":P.code,"data-modifiers":ct,"data-effects":P.effects,"data-effect-prefix":P.effect_prefix,"data-variant":P.variant,"data-no-source":G,"data-name":P.name,"aria-label":P.name,"data-locked":P.locked,"data-sellout":J,onClick:(this.props.visibility_control||!P.locked)&&this.clickEmote},g("figure",{class:"emote-picker__emote-figure"},g("img",{class:`emote-picker__emote-image${P.emoji?" ffz-emoji":""}`,src:dt,srcSet:yt,alt:P.name,height:P.height?`${P.height}px`:null,width:P.width?`${P.width}px`:null})),!ot&&gt&&g("div",{class:"emote-button__options"}),!ot&&P.favorite&&g("figure",{class:"ffz--favorite ffz-i-star"}),!ot&&B&&g("figure",{class:`ffz-i-${P.lock_icon||"lock"}`}),V&&g("figure",{class:"ffz-i-eye-off"}))}renderSellout(){const P=this.props.data;if(!P.all_locked||!P.locks)return null;let B=P.locks[this.state.unlocked],G=Object.values(P.locks).filter(ot=>ot.id!=="cheer"),J=G.filter(ot=>ot.is_ffz).length>0;return!B&&P.locks.length===1&&(B=P.locks[0]),G.length?g("div",{class:"tw-mg-1 tw-border-t tw-pd-t-1 tw-mg-b-0"},J?l.i18n.t("emote-menu.ffz-unlock","This feature is available to FFZ Subwoofers."):B?l.i18n.t("emote-menu.sub-unlock","Subscribe for {price} to unlock {count, plural, one {# emote} other {# emotes}}",{price:B.price,count:B.emotes.size}):l.i18n.t("emote-menu.sub-basic","Subscribe to unlock some emotes"),J&&this.props.ffz_sub_data?.has_free_sub?g("div",{class:"tw-pd-y-1"},l.i18n.t("emote-menu.free-sub.about","As thanks for supporting us in the past, you can get one month of FFZ Subwoofer for free.")):null,g("div",{class:"ffz--sub-buttons tw-mg-t-05"},G.map(ot=>ot.hide_button?null:g("a",{key:ot.price,class:"tw-button tw-border-radius-none",href:ot.url,target:"_blank",rel:"noopener noreferrer","data-set-id":ot.set_id,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},g("span",{class:"tw-button__text"},J&&this.props.ffz_sub_data?.has_free_sub?l.i18n.t("emote-menu.free-sub","Use My Free Month"):ot.price))))):null}},$(D,"FFZMenuSection"),D),this.fine.wrap("ffz-menu-section",this.MenuSection),this.EmojiSection=(O=class extends this.MenuSection{renderEmote(P,B,G,J){const ot=P.x*(l.emoji_size+2)+1,ct=P.y*(l.emoji_size+2)+1,gt=100*ot/l.emoji_sheet_remain,U=100*ct/l.emoji_sheet_remain,V=l.chat.context.get("chat.emote-menu.tooltips");return g("button",{key:P.id,class:`${V?"ffz-tooltip ":""}emote-picker__emote-link${B?" locked":""}${P.emoji?" emote-picker__emoji":""}`,"data-tooltip-type":"emote","data-provider":P.provider,"data-id":P.id,"data-set":P.set_id,"data-code":P.code,"data-variant":P.variant,"data-no-source":G,"data-name":P.name,"aria-label":P.name,"data-locked":P.locked,"data-sellout":J,onClick:!P.locked&&this.clickEmote},g("figure",{class:"emote-picker__emote-figure",style:{backgroundPosition:`${gt}% ${U}%`}}),P.favorite&&g("figure",{class:"ffz--favorite ffz-i-star"}),B&&g("figure",{class:`ffz-i-${P.lock_icon||"lock"}`}))}},$(O,"FFZMenuEmojiSection"),O);let M;const S=$(()=>requestAnimationFrame(()=>this.emit("tooltips:cleanup")),"doClear"),x=$(()=>{clearTimeout(M),setTimeout(S,100)},"clearTooltips");this.MenuErrorWrapper=(K=class extends C.Component{constructor(P){super(P),this.state={errored:!1,error:null}}static getDerivedStateFromError(P){return{errored:!0,error:P}}componentDidCatch(P){l.log.capture(P),l.log.error("Error rendering the FFZ Emote Menu."),this.setState({errored:!0,error:P})}render(){if(this.state.errored){if(!this.props.visible)return null;const P=l.chat.context.get("chat.emote-menu.reduced-padding");return g("div",{class:`ffz-balloon ffz-balloon--md ffz-il-tooltip--up ffz-il-tooltip--align-right tw-block tw-absolute ffz--emote-picker${P?" reduced-padding":""}`,"data-a-target":"emote-picker"},g("div",{class:"tw-border tw-elevation-1 tw-border-radius-small tw-c-background-base"},g("div",{class:"emote-picker__tab-content scrollable-area","data-test-selector":"scrollable-area-wrapper","data-simplebar":!0},g("div",{class:"tw-align-center tw-pd-1"},g("div",{class:"tw-mg-b-1"},g("div",{class:"tw-mg-2"},g("img",{src:"//cdn.frankerfacez.com/emoticon/26608/2",srcSet:"//cdn.frankerfacez.com/emoticon/26608/2 1x, //cdn.frankerfacez.com/emoticon/26608/4 2x"})),l.i18n.t("emote-menu.error","There was an error rendering this menu."),g("br",null),l.settings.get("reports.error.enable")?l.i18n.t("emote-menu.error-report","An error report has been automatically submitted."):"",g("div",{class:"tw-mg-t-05 tw-border-t-1 tw-pd-t-05"},l.i18n.t("emote-menu.disable","As a temporary workaround, try disabling the FFZ Emote Menu in the FFZ Control Center.")))))))}return this.props.children}},$(K,"FFZEmoteMenuErrorWrapper"),K),this.MenuComponent=(X=class extends C.Component{constructor(P){super(P),this.nav_ref=null,this.saveNavRef=B=>{this.nav_ref=B},this.ref=null,this.saveScrollRef=B=>{this.ref=B,this.createObserver()},this.sections=[],this.activeSection=-1,this.state={tab:null,active_nav:null,stayLoaded:l.chat.context.get("chat.emote-menu.stay-loaded"),quickNav:l.chat.context.get("chat.emote-menu.show-quick-nav"),animated:l.chat.context.get("chat.emotes.animated"),showHeading:l.chat.context.get("chat.emote-menu.show-heading"),tall:l.chat.context.get("chat.emote-menu.tall"),reducedPadding:l.chat.context.get("chat.emote-menu.reduced-padding"),combineTabs:l.chat.context.get("chat.emote-menu.combine-tabs"),showSearch:l.chat.context.get("chat.emote-menu.show-search"),clearSearch:l.chat.context.get("chat.emote-menu.clear-search"),hasNewEffects:!1,unlockedEffects:l.settings.provider.get("unlocked-effects",[]),tone:l.settings.provider.get("emoji-tone",null)},P.visible&&(this.loadData(),this.state.wants_plan_info&&this.loadFFZPlanData(),this.state.wants_resub_info&&this.loadFFZSubData()),this.rebuildData(),this.observing=new Map,this.addSection=B=>{this.sections.includes(B)||this.sections.push(B)},this.removeSection=B=>{const G=this.sections.indexOf(B);G!==-1&&(this.sections.splice(G),G===this.activeSection?this.activeSection=-1:G<this.activeSection&&this.activeSection--)},this.startObserving=this.startObserving.bind(this),this.stopObserving=this.stopObserving.bind(this),this.handleObserve=this.handleObserve.bind(this),this.pickTone=this.pickTone.bind(this),this.clickTab=this.clickTab.bind(this),this.clickSideNav=this.clickSideNav.bind(this),this.handleFilterChange=this.handleFilterChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.toggleVisibilityControl=this.toggleVisibilityControl.bind(this)}createObserver(){if(this.observer){if(this._observed===this.ref)return;this.observer.disconnect(),this.observer=this._observed=null}if(!(!this.ref||!window.IntersectionObserver)){this._observed=this.ref,this.observer=new IntersectionObserver(this.handleObserve,{root:this.ref,rootMargin:"50px 0px",threshold:.01});for(const P of this.observing.keys())this.observer.observe(P);this.observeSoon()}}observeSoon(){requestAnimationFrame(()=>{this.observer&&this.handleObserve(this.observer.takeRecords())})}destroyObserver(){this.observer&&(this.observer.disconnect(),this.observer=this._observed=null)}scrollNavIntoView(){requestAnimationFrame(()=>{const P=this.nav_ref?.querySelector?.(`button[data-key="${this.state.active_nav}"]`);P&&F(P)})}handleObserve(P){let B=!1,G=this.state.active_nav;for(const J of P){const ot=this.observing.get(J.target),ct=J.isIntersecting;!ot||ot.state.intersecting===ct||(B=!0,ot.setState({intersecting:ct}),ct&&(G=ot.props?.data?.key))}B&&(requestAnimationFrame(x),!this.lock_active&&G!==this.state.active_nav&&this.setState({active_nav:G},()=>this.scrollNavIntoView()))}startObserving(P,B){const G=this.observing.get(P);B!==G&&(G&&this.stopObserving(P),this.observing.set(P,B),this.observer&&this.observer.observe(P),this.observeSoon())}stopObserving(P){this.observing.has(P)&&(this.observing.delete(P),this.observer&&this.observer.unobserve(P))}componentDidMount(){this.ref&&this.createObserver(),l.chat.context.on("changed:chat.emotes.animated",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.stay-loaded",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.show-quick-nav",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.reduced-padding",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.show-heading",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.combine-tabs",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.show-search",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.clear-search",this.updateSettingState,this),l.chat.context.on("changed:chat.emote-menu.tall",this.updateSettingState,this),window.ffz_menu=this}componentWillUnmount(){this.destroyObserver(),l.chat.context.off("changed:chat.emotes.animated",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.stay-loaded",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.show-quick-nav",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.show-heading",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.reduced-padding",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.combine-tabs",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.show-search",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.clear-search",this.updateSettingState,this),l.chat.context.off("changed:chat.emote-menu.tall",this.updateSettingState,this),window.ffz_menu===this&&(window.ffz_menu=null)}updateSettingState(){this.setState({stayLoaded:l.chat.context.get("chat.emote-menu.stay-loaded"),quickNav:l.chat.context.get("chat.emote-menu.show-quick-nav"),animated:l.chat.context.get("chat.emotes.animated"),showHeading:l.chat.context.get("chat.emote-menu.show-heading"),reducedPadding:l.chat.context.get("chat.emote-menu.reduced-padding"),combineTabs:l.chat.context.get("chat.emote-menu.combine-tabs"),showSearch:l.chat.context.get("chat.emote-menu.show-search"),clearSearch:l.chat.context.get("chat.emote-menu.clear-search"),tall:l.chat.context.get("chat.emote-menu.tall")})}seeEffects(){this.state.hasNewEffects&&(l.settings.provider.set("unlocked-effects",this.state.unlockedEffects),this.setState({hasNewEffects:!1}))}pickTone(P){P=P||null,l.settings.provider.set("emoji-tone",P),this.setState(this.filterState(this.state.filter,this.buildEmoji(Object.assign({},this.state,{tone:P}))))}clickSideNav(P){const B=P.currentTarget.dataset.key,G=this.ref?.querySelector?.(`section[data-key="${B}"]`);G&&(this.lock_active=!0,F(G),this.setState({active_nav:B}),setTimeout(()=>this.lock_active=!1,250))}clickTab(P){const B=P.currentTarget.dataset.tab;if(B==="effect"&&this.seeEffects(),this.state.combineTabs){let G;switch(B){case"fav":G=this.state.filtered_fav_sets;break;case"channel":G=this.state.filtered_channel_sets;break;case"effect":G=this.state.filtered_effect_sets;break;case"emoji":G=this.state.filtered_emoji_sets;break;case"all":default:G=this.state.filtered_all_sets;break}const J=G&&G[0],ot=J&&this.ref?.querySelector?.(`section[data-key="${J.key}"]`);ot&&F(ot);return}this.setState({tab:B})}clickSettings(P){const B=new w.FFZEvent({item:"chat.emote_menu",event:P,errored:!1});l.emit("main_menu:open",B)}toggleVisibilityControl(){this.setState(this.filterState(this.state.filter,this.state,!this.state.visibility_control))}handleFilterChange(P){this.setState(this.filterState(P.target.value,this.state))}handleKeyDown(P){if(P.keyCode===_.KEYS.Escape)this.props.toggleVisibility();else return;P.preventDefault()}loadData(P=!1,B,G){if(G=G||this.state,!G)return!1;B=B||this.props;const J=B.emote_data&&B.emote_data.emoteSets,ot=Array.isArray(J)?new Set(J.map(ct=>ct.id)):new Set;return P=P||G.set_data&&!(0,y.set_equals)(G.set_sets,ot),G.set_data&&!P?!1:(this.setState({loading:!0},()=>{l.getData(ot,P).then(ct=>{this.setState(this.filterState(this.state.filter,this.buildState(this.props,Object.assign({},this.state,{set_sets:ot,set_data:ct,loading:!1}))))})}),!0)}loadFFZPlanData(P=!1,B,G){return G=G||this.state,!G||G.ffz_plan_loading||G.ffz_sub_data&&!P?!1:(this.setState({ffz_plan_loading:!0},()=>{l.getFFZSubPrices().then(J=>{this.setState(this.filterState(this.state.filter,this.buildState(this.props,Object.assign({},this.state,{ffz_plan_data:J,ffz_plan_loading:!1}))))})}),!0)}loadFFZSubData(P=!1,B,G){return G=G||this.state,!G||G.ffz_loading||G.ffz_sub_data&&!P?!1:(this.setState({ffz_loading:!0},()=>{l.getFFZSubData().then(J=>{this.setState(this.filterState(this.state.filter,this.buildState(this.props,Object.assign({},this.state,{ffz_sub_data:J,ffz_loading:!1}))))})}),!0)}filterState(P,B,G){const J=Object.assign({},B);return G!=null?J.visibility_control=G:G=J.visibility_control,J.filter=P,J.filtered=P&&P.length>0&&P!==":"||!1,J.filtered_channel_sets=this.filterSets(P,J.channel_sets,G),J.filtered_effect_sets=this.filterSets(P,J.effect_sets,G),J.filtered_all_sets=this.filterSets(P,J.all_sets,G),J.filtered_fav_sets=this.filterSets(P,J.fav_sets,G),J.filtered_emoji_sets=this.filterSets(P,J.emoji_sets,G),J.has_effect_tab=J.filtered_effect_sets.length>0,J}filterSets(P,B,G){const J=[];if(!B||!B.length)return J;const ot=P&&P.length>0&&P!==":",ct=u.get("emote-menu.hidden-sets")||[];for(const gt of B){if(!G&&ct.includes(gt.key))continue;(gt.filtered_emotes=gt.emotes.filter(V=>!G&&V.hidden?!1:!ot||!V.locked&&this.doesEmoteMatch(P,V))).length&&J.push(gt)}return J}doesEmoteMatch(P,B){if(!P||!P.length)return!0;const G=B.search||B.name,J=G.toLowerCase(),ot=P.toLowerCase(),ct=P.startsWith(":"),gt=ot.slice(1);if(Array.isArray(B.extra)){let V=B.extra.length;for(;V--;){if(!ct&&B.extra[V].includes(ot))return!0;if(ct&&B.extra[V].startsWith(gt))return!0}}if(!ct)return J.includes(ot);if(J.startsWith(gt))return!0;const U=G.indexOf(P.charAt(1).toUpperCase());return U!==-1?J.slice(U+1).startsWith(ot.slice(2)):!1}buildEmoji(P){const B=Object.assign({},P),G=B.emoji_sets=[],J=l.emotes.getFavorites("emoji"),ot=B.favorites=(B.favorites||[]).filter(V=>!V.emoji),ct=B.tone=B.tone||null,gt=B.tone_emoji=[],U={};if(l.chat.context.get("chat.emote-menu.show-emoji")){let V=l.chat.context.get("chat.emoji.style")||"twitter";p.Vf[V]||(V="twitter");for(const et of Object.values(l.emoji.emoji)){if(!et||!et.has[V]||p.D3.includes(et.category))continue;if(et.variants){for(const Ft of et.names)if(j.includes(Ft)){gt.push(et);break}}const dt=J.includes(et.code),yt=et.variants&&et.variants[ct],xt=yt&&yt.has[V],Ut=xt?yt:et;let $t=U[et.category];$t||($t=U[et.category]=[],G.push({key:`emoji-${et.category}`,sort_key:p.of.indexOf(et.category),emoji:!0,image:l.emoji.getFullImage(Ut.image),i18n:`emoji.category.${et.category.toSnakeCase()}`,title:p.aA[et.category]||et.category,src:"emoji",source:"Emoji",source_i18n:"emote-menu.emoji",emotes:$t}));const Gt={provider:"emoji",id:et.sort,emoji:!0,code:et.code,name:Ut.raw,variant:xt&&ct,hidden:et.hidden,search:et.names[0],extra:et.names.length>1?et.names.map(Ft=>Ft.toLowerCase()):null,height:18,width:18,x:Ut.sheet_x,y:Ut.sheet_y,favorite:dt,src:l.emoji.getFullImage(Ut.image),srcSet:l.emoji.getFullImageSet(Ut.image)};$t.push(Gt),dt&&ot.push(Gt)}}return B.has_emoji_tab=G.length>0,B.fav_sets=[{key:"favorites",title:"Favorites",i18n:"emote-menu.favorites",icon:"star",source:"",is_favorites:!0,emotes:ot}],ot.sort(this.getSorter()),G.sort(tt),B}getAllSets(){return[...this.state.channel_sets||[],...this.state.effect_sets||[],...this.state.all_sets||[]]}getSorter(){return st[l.chat.context.get("chat.emote-menu.sort-emotes")]||st[0]||(()=>0)}buildState(P,B){const G=Object.assign({},B),J=G.set_data||{},ot=G.emote_modifiers={},ct=G.channel_sets=[],gt=G.all_sets=[],U=G.effect_sets=[],V=G.favorites=[];if(P.loading||P.error||G.loading||G.set_data&&this.loadData(!1,P,G))return G;const et=this.getSorter(),dt=l.chat.context.get("chat.emote-menu.sort-tiers-last"),yt=$((zt,vt)=>{if(zt.misc||vt.misc)return et(zt,vt);if(!zt.locked&&vt.locked)return-1;if(zt.locked&&!vt.locked)return 1;if(dt||zt.locked||vt.locked)if(zt.bits||vt.bits){if(vt.bits){if(!zt.bits)return-1}else return 1;const Wt=zt.bit_value||0,Vt=vt.bit_value||0;if(Y){const Lt=Y.compare(Wt,Vt);if(Lt!=0)return Lt}else{if(Wt<Vt)return-1;if(Wt>Vt)return 1}}else if(Y){const Wt=Y.compare(zt.set_id,vt.set_id);if(Wt!=0)return Wt}else{if(zt.set_id<vt.set_id)return-1;if(zt.set_id>vt.set_id)return 1}return et(zt,vt)},"sort_emotes"),xt=P.channel_data&&P.channel_data.user,Ut=xt&&xt.subscriptionProducts,$t=xt&&P.channel_data?.channel?.localEmoteSets,Gt=xt&&xt.self?.follower!=null,Ft=!Gt&&P.user_id&&xt?.id!=P.user_id,Bt=xt?.cheer?.badgeTierEmotes,Qt=new Set;if(Array.isArray($t))for(const zt of $t)zt?.id&&Qt.add(zt.id);const Ht=P.emote_data&&P.emote_data.emoteSets,se=P.emote_data&&P.emote_data.emoteMap,Kt=l.emotes.getFavorites("twitch"),Jt=l.emotes.getHidden("twitch"),St=new Set,Et=[],Tt={},Yt=new Set;if(Array.isArray(Ht))for(const zt of Ht){if(!zt||!Array.isArray(zt.emotes))continue;const vt=zt.id,Wt=parseInt(vt,10),Vt=zt.owner,Lt=Qt.has(vt),Ot=!Lt&&Wt>5e8,Rt=_.TWITCH_POINTS_SETS.includes(Wt)||Vt?.login==="channel_points",wt=Lt?xt:Rt?null:Vt,kt=J[vt],Dt=Ot&&Vt&&Vt.id==xt?.id;Yt.add(vt);let At=`twitch-set-${vt}`,bt=0,Pt="twitch",Nt=wt&&(wt.displayName||wt.login);if(Nt?(At=`twitch-${wt?.id}`,Lt?l.emotes.setTwitchSetChannel(vt,{id:vt,type:_.EmoteTypes.Follower,owner:{id:wt.id,login:wt.login,displayName:wt.displayName}}):Ot?l.emotes.setTwitchSetChannel(vt,{id:vt,type:_.EmoteTypes.BitsTier,owner:{id:wt.id,login:wt.login,displayName:wt.displayName}}):l.emotes.setTwitchSetChannel(vt,{id:vt,type:_.EmoteTypes.Subscription,owner:{id:wt.id,login:wt.login,displayName:wt.displayName}})):wt?Nt=l.i18n.t("emote-menu.unknown-set","Set #{set_id}",{set_id:vt}):Rt?(Nt=l.i18n.t("emote-menu.points","Unlocked with Points"),At="twitch-points",Pt="channel-points",bt=45):_.TWITCH_GLOBAL_SETS.includes(Wt)?(Nt=l.i18n.t("emote-menu.global","Global Emotes"),At="twitch-global",bt=100,l.emotes.setTwitchSetChannel(vt,{id:vt,type:_.EmoteTypes.Global,owner:null})):_.TWITCH_PRIME_SETS.includes(Wt)?(Nt=l.i18n.t("emote_menu.prime","Prime"),At="twitch-prime",Pt="crown",bt=75,l.emotes.setTwitchSetChannel(vt,{id:vt,type:_.EmoteTypes.Prime,owner:null})):(Nt=l.i18n.t("emote-menu.misc","Miscellaneous"),At="twitch-misc",Pt="inventory",bt=50),Lt)continue;let Xt,qt;Tt[At]?(Xt=Tt[At],qt=Xt.emotes,kt&&Xt.bad&&(Xt.bad=!1,Xt.renews=kt.renews,Xt.ends=kt.ends,Xt.prime=kt.prime,Xt.gift=kt.gift)):(qt=[],Xt=Tt[At]={sort_key:bt,key:At,image:wt?.profileImageURL,image_large:!0,icon:Pt,title:Nt,source:l.i18n.t("emote-menu.twitch","Twitch"),emotes:qt,renews:kt?.renews,ends:kt?.ends,prime:kt?.prime,gift:kt?.gift},kt||(Xt.bad=!0));let le=0;for(const te of zt.emotes){if(!te||!te.id||!te.token)continue;const ze=te.id,ke=_.KNOWN_CODES[te.token]||te.token,we=se&&se[ke];Rt||l.emotes.setTwitchEmoteSet(ze,vt);const Se=[""];if(Array.isArray(te.modifiers)&&te.modifiers.length&&l.chat.context.get("chat.emote-menu.modifiers")===1)for(const ce of te.modifiers)Se.push(`_${ce.code}`);for(const ce of Se){const ee=`${ze}${ce}`,Ie=`${ke}${ce}`,Ee=Kt.includes(ee),Ne=we&&we.id!=ee,Me=_.REPLACEMENTS[ee];let be,Ae,Te,Pe;Me&&l.chat.context.get("chat.fix-bad-emotes")?be=`${_.REPLACEMENT_BASE}${Me}`:(be=(0,y.getTwitchEmoteURL)(ee,1,!1),Ae=(0,y.getTwitchEmoteSrcSet)(ee,!1),Te=(0,y.getTwitchEmoteURL)(ee,1,!0),Pe=(0,y.getTwitchEmoteSrcSet)(ee,!0));const ye={provider:"twitch",id:ee,set_id:vt,name:Ie,src:be,srcSet:Ae,animSrc:Te,animSrcSet:Pe,order:le++,overridden:Ne?we.id:null,misc:!wt,bits:Ot,hidden:Jt.includes(ee),favorite:Ee};qt.push(ye),Dt&&Et.push(ye),Ee&&!St.has(ee)&&V.push(ye),St.add(ee)}}qt.length&&(qt.sort(yt),gt.includes(Xt)||gt.push(Xt))}if(Array.isArray($t)||Array.isArray(Ut)||Array.isArray(Bt)){const zt=l.badges.getTwitchBadge("subscriber","0",xt.id,xt.login),vt=[],Wt=new Set,Vt={},Lt={sort_key:-10,key:"twitch-current-channel",hide_key:`twitch-${xt.id}`,image:zt&&zt.image1x,image_set:zt&&`${zt.image1x} 1x, ${zt.image2x} 2x, ${zt.image4x} 4x`,icon:"twitch",title:l.i18n.t("emote-menu.main-set","Channel Emotes"),source:l.i18n.t("emote-menu.twitch","Twitch"),emotes:vt,locks:Vt,all_locked:!0};if(Array.isArray($t))for(const Rt of $t){if(!Rt||!Array.isArray(Rt.emotes))continue;const wt=Rt.id;let kt;Ft&&(Vt[wt]={set_id:wt,id:"follower",user:xt?.displayName||xt?.login,hide_button:!0,emotes:kt=new Set});let Dt=0;for(const At of Rt.emotes){if(!At||!At.id||!At.token)continue;const bt=At.id,Pt=_.KNOWN_CODES[At.token]||At.token,Nt=St.has(bt),Xt=Kt.includes(bt),qt={provider:"twitch",id:bt,set_id:wt,name:Pt,order:Dt++,src:(0,y.getTwitchEmoteURL)(bt,1,!1),srcSet:(0,y.getTwitchEmoteSrcSet)(bt,!1),animSrc:(0,y.getTwitchEmoteURL)(bt,1,!0),animSrcSet:(0,y.getTwitchEmoteSrcSet)(bt,!0),favorite:Xt,hidden:Jt.includes(bt),locked:Ft,lock_icon:"heart"};vt.push(qt),Xt&&!Nt&&V.push(qt),St.add(bt),kt&&kt.add(bt)}}if(Array.isArray(Ut))for(const Rt of Ut){if(!Rt||!Array.isArray(Rt.emotes))continue;const wt=Rt.emoteSetID,kt=J[wt],Dt=!Yt.has(wt);let At;kt&&(Lt.renews=kt.renews,Lt.ends=kt.ends,Lt.prime=kt.prime,Lt.gift=kt.gift&&kt.gift.isGift),Dt?Vt[wt]={set_id:wt,id:Rt.id,price:Rt.price||I[Rt.tier],url:Rt.url,emotes:At=new Set(Wt)}:Lt.all_locked=!1;let bt=0;for(const Pt of Rt.emotes){if(!Pt||!Pt.id||!Pt.token)continue;const Nt=Pt.id,Xt=_.KNOWN_CODES[Pt.token]||Pt.token,qt=St.has(Nt),le=Kt.includes(Nt),te={provider:"twitch",id:Nt,set_id:wt,name:Xt,order:bt++,locked:Dt&&!qt,src:(0,y.getTwitchEmoteURL)(Nt,1,!1),srcSet:(0,y.getTwitchEmoteSrcSet)(Nt,!1),animSrc:(0,y.getTwitchEmoteURL)(Nt,1,!0),animSrcSet:(0,y.getTwitchEmoteSrcSet)(Nt,!0),favorite:le,hidden:Jt.includes(Nt)};vt.push(te),!Dt&&le&&!qt&&V.push(te),St.add(Nt),At&&(Wt.add(Nt),At.add(Nt))}}const Ot=new Set;if(Array.isArray(Bt)){let Rt;for(const wt of Bt){if(!wt||!wt.id||!wt.bitsBadgeTierSummary)continue;const kt=wt.id,Dt=wt.setID,At=wt.bitsBadgeTierSummary,bt=!St.has(kt)&&!At.self?.isUnlocked;bt&&(Vt[Dt]={set_id:Dt,id:"cheer",price:null,bits:At.threshold,bits_remaining:At.self?.numberOfBitsUntilUnlock??At.threshold,emotes:new Set([wt.id])});const Pt=Kt.includes(kt),Nt={provider:"twitch",id:kt,set_id:Dt,name:wt.token,locked:bt,order:Rt++,src:(0,y.getTwitchEmoteURL)(kt,1,!1),srcSet:(0,y.getTwitchEmoteSrcSet)(kt,!1),animSrc:(0,y.getTwitchEmoteURL)(kt,1,!0),animSrcSet:(0,y.getTwitchEmoteSrcSet)(kt,!0),bits:!0,bit_value:At.threshold,favorite:Pt,hidden:Jt.includes(kt)};vt.push(Nt),!bt&&Pt&&!St.has(kt)&&V.push(Nt),Ot.add(kt),St.add(kt)}}if(Et.length)for(const Rt of Et)Ot.has(Rt.id)||vt.push(Rt);vt.length&&(vt.sort(yt),ct.push(Lt))}let Zt=!1,ne=!1,ie=!1;const ae=[...l.settings.provider.get("unlocked-effects",[])];if(l.chat.context.get("chat.emotes.enabled")>1){const zt=l.site.getUser(),vt=l.chat.context.get("chat.emote-menu.effect-tab"),Wt=l.emotes.getRoomSetsWithSources(zt?.id,zt?.login,P.channel_id,null),Vt=l.emotes.getSubSetsWithSources(),Lt=l.emotes.getGlobalSetsWithSources(zt?.id,zt?.login),Ot=new Set,Rt={};let wt={};for(const[Dt,At,bt]of Wt){if(Ot.has(Dt))continue;Ot.add(Dt);const Pt=this.processFFZSet(Dt,At,V,Rt,wt,!1,void 0,bt,P.channel_id);Pt&&(Pt.emotes.sort(yt),ct.includes(Pt)||ct.push(Pt))}wt={};const kt=Lt.map(Dt=>Dt?.[0]?.id);for(const[Dt,At]of Vt){if(Ot.has(Dt))continue;Ot.add(Dt);const bt=!kt.includes(Dt.id);Zt=!0;const Pt=this.processFFZSet(Dt,At,V,Rt,wt,bt,G);Pt&&(Pt.emotes.sort(yt),vt&&!U.includes(Pt)&&Pt.has_effects?(ie=this.checkNewEffects(Pt.emotes,ae)||ie,U.push(Pt)):gt.includes(Pt)||gt.push(Pt))}wt={};for(const[Dt,At]of Lt){if(Ot.has(Dt))continue;Ot.add(Dt);const bt=this.processFFZSet(Dt,At,V,Rt,wt);bt&&(bt.emotes.sort(yt),vt&&!U.includes(bt)&&bt.has_effects?(ie=this.checkNewEffects(bt.emotes,ae)||ie,U.push(bt)):gt.includes(bt)||gt.push(bt),!ct.includes(bt)&&(0,y.maybe_call)(bt.force_global,this,Dt,P.channel_data&&P.channel_data.user,zt)&&ct.push(bt))}}return G.wants_resub_info=Zt,G.wants_plan_info=ne,this.props.visible&&(G.tab==="effects"&&(ie=!1),ne&&this.loadFFZPlanData(),Zt&&this.loadFFZSubData()),ct.sort(tt),U.sort(tt),gt.sort(tt),G.has_channel_tab=ct.length>0,G.has_effect_tab=U.length>0,G.hasNewEffects=U.length>0&&ie,G.unlockedEffects=ae,this.buildEmoji(G)}checkNewEffects(P,B){let G=!1;for(const J of P)J&&!J.locked&&J.id&&J.provider==="ffz"&&!B.includes(J.id)&&(G=!0,B.push(J.id));return G}processFFZSet(P,B,G,J,ot,ct=!1,gt,U,V=null){if(!P||!P.emotes)return null;let et;if(U){const St=l.parent.shared_room_data?.get(U);et=St?.displayName??St?.login}const dt=P.source||"ffz",yt=l.emotes.getFavorites(dt),xt=l.emotes.getHidden(dt),Ut=J[dt]=J[dt]||new Set,$t=`${P.merge_source||dt}-${P.merge_id||P.id}`,Gt=l.emotes.providers.get(B),Ft=Gt&&Gt.menu_name?Gt.menu_i18n_key?l.i18n.t(Gt.menu_i18n_key,Gt.menu_name,Gt):Gt.menu_name:P.source||"FFZ",Bt=B==="ffz-main"||P.title_is_channel?et?l.i18n.t("emote-menu.source-set","{channel}'s Emotes",{channel:et}):l.i18n.t("emote-menu.main-set","Channel Emotes"):P.title||l.i18n.t("emote-menu.unknown-set","Set #{set_id}",{set_id:P.id});let Qt=Gt&&Gt.sort_key||P.sort;Qt==null&&(Qt=P.title.toLowerCase().includes("global")?100:0),U&&U!==V&&(Qt+=50);let Ht,se,Kt;ot[$t]?(Ht=ot[$t],se=Ht.emotes,$t===`${dt}-${P.id}`&&Object.assign(Ht,{sort_key:Qt,image:P.icon,title:Bt,source:Ft,channel_source:et,force_global:P.force_global})):(se=[],Ht=ot[$t]={sort_key:Qt,key:$t,image:P.icon,icon:"zreknarf",title:Bt,source:Ft,channel_source:et,emotes:se,force_global:P.force_global,all_locked:!0});const Jt=(gt||this.state)?.ffz_sub_data?.sets?.[P.id];Jt&&(Ht.renews=Jt.next_bill_date,Ht.ends=Jt.expires_at),ct?(Ht.locks=Ht.locks||{},Ht.locks[P.id]={set_id:P.id,id:"subwoofer",is_ffz:!0,price:"More Info",url:"https://www.frankerfacez.com/subscribe",emotes:Kt=new Set}):Ht.all_locked=!1;for(const St of Object.values(P.emotes))if(!St.hidden){const Et=yt.includes(St.id),Tt={provider:"ffz",id:St.id,set_id:P.id,src:St.src,srcSet:St.srcSet,animSrc:St.animSrc,animSrcSet:St.animSrcSet,effects:St.modifier?St.modifier_flags:0,effect_prefix:St.modifier?St.modifier_prefix:!1,name:St.name,favorite:Et,locked:ct,hidden:xt.includes(St.id),height:St.height,width:St.width};se.push(Tt),!ct&&Et&&!Ut.has(St.id)&&(G.push(Tt),Ut.add(St.id)),ct&&Kt.add(St.id),St.modifier&&St.modifier_flags&&(Ht.has_effects=!0)}if(se.length)return Ht}rebuildData(){const P=this.buildState(this.props,this.state);this.setState(this.filterState(P.filter,P))}componentDidUpdate(P){if(this.props.visible&&!P.visible&&(this.loadData(),this.state.wants_plan_info&&this.loadFFZPlanData(),this.state.wants_resub_info&&this.loadFFZSubData()),!this.props.visible&&P.visible&&this.state.clearSearch){this.setState(this.filterState("",this.state));return}const B=this.props.channel_data,G=P.channel_data,J=B?.user!==G?.user||B?.channel!==G?.channel,ot=this.props.emote_data,ct=P.emote_data,gt=!(0,y.deep_equals)(ot?.emoteSets,ct?.emoteSets)||!(0,y.deep_equals)(ot?.emoteMap,ct?.emoteMap);(J||gt||this.props.user_id!==P.user_id||this.props.channel_id!==P.channel_id||this.props.loading!==P.loading||this.props.error!==P.error)&&(l.log.debug("Updating emote menu data. cd",J,", ed",gt),this.rebuildData())}renderError(){return g("div",{class:"tw-align-center tw-pd-1"},g("div",{class:"tw-mg-b-1"},g("div",{class:"tw-mg-2"},g("img",{src:"//cdn.frankerfacez.com/emoticon/26608/2",srcSet:"//cdn.frankerfacez.com/emoticon/26608/2 1x, //cdn.frankerfacez.com/emoticon/26608/4 2x"})),l.i18n.t("emote-menu.error","There was an error rendering this menu.")),g("button",{class:"tw-button",onClick:this.forceUpdate},g("span",{class:"tw-button__text"},l.i18n.t("error.try-again","Try Again"))))}renderEmpty(){return g("div",{class:"tw-align-center tw-pd-1"},g("div",{class:"tw-mg-2"},g("img",{src:"//cdn.frankerfacez.com/emoticon/26608/2",srcSet:"//cdn.frankerfacez.com/emoticon/26608/2 1x, //cdn.frankerfacez.com/emoticon/26608/4 2x"})),this.state.filtered?l.i18n.t("emote-menu.empty-search","There are no matching emotes."):this.state.tab==="fav"?l.i18n.t("emote-menu.empty-favs","You don't have any favorite emotes. To favorite an emote, find it and {hotkey}-Click it.",{hotkey:_.IS_OSX?"\u2318":"Ctrl"}):l.i18n.t("emote-menu.empty","There's nothing here."))}renderLoading(){return g("div",{class:"tw-align-center tw-pd-1"},g("h1",{class:"tw-mg-5 ffz-i-zreknarf loading"}),l.i18n.t("emote-menu.loading","Loading..."))}render(){if(!this.props.visible&&(!this.state.stayLoaded||!this.loadedOnce))return null;const P=this.state.loading||this.props.loading,B=this.state.reducedPadding,G=this.state.combineTabs;P||(this.loadedOnce=!0);let J,ot,ct,gt,U;if(G)ot=[this.state.filtered_fav_sets,this.state.filtered_channel_sets,this.state.filtered_effect_sets,this.state.filtered_all_sets,this.state.filtered_emoji_sets].flat();else switch(J=this.state.tab||l.chat.context.get("chat.emote-menu.default-tab"),(J==="effect"&&!this.state.has_effect_tab||J==="channel"&&!this.state.has_channel_tab||J==="emoji"&&!this.state.has_emoji_tab)&&(J="all"),ct=J==="emoji",gt=J==="fav",U=J==="effect",J){case"fav":ot=this.state.filtered_fav_sets;break;case"channel":ot=this.state.filtered_channel_sets;break;case"effect":ot=this.state.filtered_effect_sets;break;case"emoji":ot=this.state.filtered_emoji_sets;break;case"all":default:ot=this.state.filtered_all_sets;break}const V=this.state.visibility_control,et=this.props.source==="whisper";return g("div",{class:`tw-block${this.props.visible?"":" tw-hide"}`,style:{display:this.props.visible?null:"none !important"}},g("div",{class:"tw-absolute ffz-attached ffz-attached--right ffz-attached--up"},g("div",{class:`ffz-balloon ffz-balloon--auto tw-inline-block tw-border-radius-large tw-c-background-base tw-c-text-inherit tw-elevation-2 ffz--emote-picker${this.state.tall?" ffz--emote-picker__tall":""}${B?" reduced-padding":""}`,"data-a-target":"emote-picker",role:"dialog"},g("div",{class:`emote-picker${et?"__whisper":""}`},g("div",{class:"tw-flex"},g("div",{class:`emote-picker__tab-content${et?"-whisper":""} tw-full-width scrollable-area scrollable-area--suppress-scroll-x`,"data-test-selector":"scrollable-area-wrapper","data-simplebar":!0},g("div",{ref:this.saveScrollRef,class:"simplebar-scroll-content"},g("div",{class:"simplebar-content"},P&&this.renderLoading(),!P&&ot&&ot.map((dt,yt)=>dt&&(!V||!dt.emoji&&!dt.is_favorites)&&g(dt.emoji?l.EmojiSection:l.MenuSection,{key:dt.key,idx:yt,data:dt,ffz_sub_data:this.state.ffz_sub_data,emote_modifiers:this.state.emote_modifiers,animated:this.state.animated,combineTabs:this.state.combineTabs,showHeading:this.state.showHeading,filtered:this.state.filtered,visibility_control:V,onClickToken:this.props.onClickToken,addSection:this.addSection,removeSection:this.removeSection,startObserving:this.startObserving,stopObserving:this.stopObserving})),!P&&(!ot||!ot.length)&&this.renderEmpty()))),!P&&this.state.quickNav&&!gt&&g("div",{class:`emote-picker__nav_content${et?"-whisper":""} tw-block tw-border-radius-none tw-c-background-alt-2`},g("div",{class:`emote-picker__nav-content-overflow${et?"-whisper":""} scrollable-area scrollable-area--suppress-scroll-x`,"data-test-selector":"scrollable-area-wrapper","data-simplebar":!0},g("div",{ref:this.saveNavRef,class:"simplebar-scroll-content"},g("div",{class:"simplebar-content"},!P&&ot&&ot.map(dt=>{if(!dt||V&&(dt.is_favorites||dt.emoji))return null;const yt=this.state.active_nav===dt.key;return g("button",{key:dt.key,class:`${yt?"emote-picker-tab-item-wrapper__active ":""}${B?"tw-mg-y-05":"tw-mg-y-1"} tw-c-text-inherit tw-interactable ffz-interactive ffz-interactable--hover-enabled ffz-interactable--default tw-block tw-full-width ffz-tooltip ffz-tooltip--no-mouse`,"data-key":dt.key,"data-title":`${dt.i18n?l.i18n.t(dt.i18n,dt.title):dt.title}
${dt.source_i18n?l.i18n.t(dt.source_i18n,dt.source):dt.source}${dt.channel_source?` (${dt.channel_source})`:""}`,"data-tooltip-side":"left",onClick:this.clickSideNav},g("div",{class:`tw-align-items-center tw-flex tw-justify-content-center ${B?"":"tw-pd-x-05 "}tw-pd-y-05${yt?" emote-picker-tab-item-avatar__active tw-c-text-link":""}`},dt.image?g("figure",{class:"ffz-avatar ffz-avatar--size-20"},g("img",{class:"tw-block tw-border-radius-rounded tw-img tw-image-avatar",src:dt.image,srcSet:dt.image_set})):g("figure",{class:`ffz-emote-picker--nav-icon ffz-i-${dt.icon||"zreknarf"}`})))}),G&&g("div",{class:"tw-mg-y-1 tw-mg-x-05 tw-border-t"}),G&&g("button",{class:"tw-mg-y-1 tw-c-text-inherit tw-interactable ffz-interactive ffz-interactable--hover-enabled ffz-interactable--default tw-block tw-full-width ffz-tooltip ffz-tooltip--no-mouse","data-title":l.i18n.t("emote-menu.settings","Open Settings"),"data-tooltip-side":"left",onClick:this.clickSettings},g("div",{class:`tw-align-items-center tw-flex tw-justify-content-center ${B?"":"tw-pd-x-05 "}tw-pd-y-05`},g("figure",{class:"ffz-emote-picker--nav-icon ffz-i-cog"})))))))),g("div",{class:"emote-picker__controls-container tw-relative"},(ct||this.state.showSearch)&&g("div",{class:"tw-border-t tw-pd-1"},g("div",{class:"tw-flex"},g("input",{type:"text",class:"tw-block tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05",placeholder:ct?l.i18n.t("emote-menu.search-emoji","Search for Emoji"):l.i18n.t("emote-menu.search","Search for Emotes"),value:this.state.filter,autoFocus:!0,autoCapitalize:"off",autoCorrect:"off",onChange:this.handleFilterChange,onKeyDown:this.handleKeyDown}),(G||ct)&&!V&&this.state.has_emoji_tab&&g(l.EmojiTonePicker,{tone:this.state.tone,choices:this.state.tone_emoji,pickTone:this.pickTone}),(G||!ct)&&g("div",{class:"tw-relative ffz-il-tooltip__container tw-mg-l-1"},g("button",{class:`tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon--primary ffz-core-button tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative${this.state.visibility_control?" ffz-core-button--primary":" tw-button-icon"}`,onClick:this.toggleVisibilityControl},g("span",{class:"tw-button-icon__icon tw-mg-x-05"},g("figure",{class:this.state.visibility_control?"ffz-i-eye-off":"ffz-i-eye"}))),g("div",{class:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},this.state.visibility_control?l.i18n.t("emote-menu.toggle-hide.on","Exit Emote Visibility Control"):l.i18n.t("emote-menu.toggle-hide.off","Emote Visibility Control"),g("div",{class:"tw-mg-t-1 ffz--tooltip-explain"},l.i18n.t("emote-menu.toggle-hide.info","Emote Visibility Control allows you to hide emotes from your emote menu, either individually or by set. With Emote Visibility Control enabled, just click an emote to hide or unhide it. Please note that you will still see the emotes in chat if someone uses them, but they won't appear in your emote menu.")))))),G&&this.state.quickNav?null:g("div",{class:"emote-picker__tab-nav-container tw-flex tw-border-t tw-c-background-alt"},!V&&g("div",{class:`emote-picker-tab-item${J==="fav"?" emote-picker-tab-item--active":""} tw-relative`},g("button",{class:`ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive${J==="fav"?" ffz-interactable--selected":""}`,id:"emote-picker__fav","data-tab":"fav","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.favorites","Favorites"),onClick:this.clickTab},g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-star"})))),this.state.has_channel_tab&&g("div",{class:`emote-picker-tab-item${J==="channel"?" emote-picker-tab-item--active":""} tw-relative`},g("button",{class:`ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive${J==="channel"?" ffz-interactable--selected":""}`,id:"emote-picker__channel","data-tab":"channel","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.channel","Channel"),onClick:this.clickTab},g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-camera"})))),this.state.has_effect_tab&&g("div",{class:`emote-picker-tab-item${J==="effect"?" emote-picker-tab-item--active":""} tw-relative`},g("button",{class:`ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive${J==="effect"?" ffz-interactable--selected":""}`,id:"emote-picker__effect","data-tab":"effect","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.effects","Emote Effects"),onClick:this.clickTab},this.state.hasNewEffects&&g("div",{class:"ffz-new-indicator"}),g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-fx"})))),g("div",{class:`emote-picker-tab-item${J==="all"?" emote-picker-tab-item--active":""} tw-relative`},g("button",{class:`ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive${J==="all"?" ffz-interactable--selected":""}`,id:"emote-picker__all","data-tab":"all","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.my-emotes","My Emotes"),onClick:this.clickTab},g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-channels"})))),!V&&this.state.has_emoji_tab&&g("div",{class:`emote-picker-tab-item${J==="emoji"?" emote-picker-tab-item--active":""} tw-relative`},g("button",{class:`ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive${J==="emoji"?" ffz-interactable--selected":""}`,id:"emote-picker__emoji","data-tab":"emoji","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.emoji","Emoji"),onClick:this.clickTab},g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-smile"})))),g("div",{class:"tw-flex-grow-1"}),g("div",{class:"emote-picker-tab-item tw-relative"},g("button",{class:"ffz-tooltip tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive","data-tooltip-type":"html","data-title":l.i18n.t("emote-menu.settings","Open Settings"),onClick:this.clickSettings},g("div",{class:"tw-inline-flex tw-pd-x-1 tw-pd-y-05 tw-font-size-4"},g("figure",{class:"ffz-i-cog"}))))))))))}},$(X,"FFZEmoteMenuComponent"),X),this.fine.wrap("ffz-emote-menu",this.MenuComponent)}async getFFZSubPrices(){let l;try{l=await fetch(`${this.staging.api}/payment/plans`).then(C=>C.ok?C.json():null)}catch(C){this.log.error("Unable to load subscription prices from server.",C),l=null}const u={sets:{}};for(const C of Object.values(l.plans)){if(!Array.isArray(C.temporary_collections))continue;let g;for(const M of Object.values(l.gateway_plans))if(M.plan_id===C.id&&M.months===1){g=M.prices;break}if(g)for(const M of C.temporary_collections)u.sets[M]={plan_id:C.id,prices:g}}return u}async getFFZSubData(){if(!this.resolve("site").getUser())return null;const u=await this.resolve("socket").getBareAPIToken();if(!u)return null;let C;try{C=await fetch(`${this.staging.api}/v2/subscription/status?include=plan`,{headers:{Authorization:`Bearer ${u}`}}).then(M=>M.ok?M.json():null)}catch(M){this.log.error("Unable to load subscription status from server.",M),C=null}if(!C)return{error:!0};const g={has_free_sub:C.user?.bonus_month_eligible??!1,sets:{}};if(C.user?.active_subs)for(const M of Object.values(C.user.active_subs)){const S=C.plans?.[M.id];if(Array.isArray(S?.temporary_collections))for(const x of S.temporary_collections)g.sets[x]={plan_id:M.id,expires_at:M.expires_at?new Date(M.expires_at):null,next_bill_date:M.next_bill_date?new Date(M.next_bill_date):null}}return g}async getData(l,u,C=null,g=[]){if(this._data){if(!u&&(0,y.set_equals)(l,this._data_sets))return this._data;this._data=null,this._data_sets=null}let M;try{M=await this.apollo.client.query({query:R(),variables:{first:75,after:C,criteria:{filter:"ALL"}},fetchPolicy:u?"network-only":"cache-first"})}catch(O){return this.log.warn("Error fetching additional emote menu data.",O),this._data=null}const S={},x=(0,y.get)("data.currentUser.subscriptionBenefits.edges.@each.node",M),k=(0,y.get)("data.currentUser.subscriptionBenefits.pageInfo.hasNextPage",M),D=(0,y.get)("data.currentUser.subscriptionBenefits.edges.@last.cursor",M);if(g=g.concat(x),k)return this.getData(l,u,D,g);if(g&&g.length)for(const O of g){const K=O&&O.product,X=K&&K.emoteSetID;X&&(S[X]={ends:H(O.endsAt),renews:H(O.renewsAt),prime:O.purchasedWithPrime,set_id:X,type:K.type,gift:O.gift?.isGift})}return this._data_sets=l,this._data=S}};$(me,"EmoteMenu");let it=me;it.getData=(0,y.once)(it.getData),it.getFFZSubData=(0,y.once)(it.getFFZSubData),it.getFFZSubPrices=(0,y.once)(it.getFFZSubPrices);const ut=Intl.Collator(),rt=Intl.Collator(void 0,{sensitivity:"accent"}),mt=0,W=1,L=2,Z=3,nt=4;function at(Mt){return Mt?Mt.type==="emote"?Mt.emoteName:Mt.type==="text"?Mt.text:Array.isArray(Mt.children)?Mt.children.map(at).join(""):"":""}$(at,"getNodeText");function ft(Mt,l){let u=0,C=0,g=Mt;for(;C<l.length;){const M=l[C];for(let S=0;S<M;S++)u+=at(g[S]).length;g=Array.isArray(g[M])?g[M]:g[M]?.children,C++}return u}$(ft,"getNodeOffset");const ge=class ge extends b.default{constructor(...l){super(...l),this.inject("chat"),this.inject("chat.actions"),this.inject("chat.emotes"),this.inject("chat.emoji"),this.inject("i18n"),this.inject("settings"),this.inject("site.fine"),this.inject("site"),this.settings.add("chat.hype.display-input",{default:!0,ui:{path:"Chat > Hype Chat >> Input",title:"Allow the Hype Chat button to appear in the chat input element.",component:"setting-check-box"}}),this.settings.add("chat.inline-preview.enabled",{default:!0,ui:{path:"Chat > Input >> Appearance",title:"Display in-line previews of FrankerFaceZ emotes when entering a chat message.",description:"**Note:** This feature is temperamental. It may not display all emotes, and emote effects and overlay emotes are not displayed correctly. Once this setting has been enabled, it cannot be reasonably disabled and will remain active until you refresh the page.",component:"setting-check-box"}}),this.settings.add("chat.mru.enabled",{default:!0,ui:{path:"Chat > Input >> Recent Messages",title:"Allow pressing up and down to recall previously sent chat messages.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.ffz-emotes",{default:!0,ui:{path:"Chat > Input >> Tab Completion",title:"Allow tab-completion of FrankerFaceZ emotes.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.emoji",{default:!0,ui:{path:"Chat > Input >> Tab Completion",title:"Allow tab-completion of emoji.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.emotes-without-colon",{default:!1,ui:{path:"Chat > Input >> Tab Completion",title:"Allow tab-completion of emotes without typing a colon. (:)",description:"This will prevent the tab-completion of usernames without the @ prefix.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.limit-results",{default:!0,ui:{path:"Chat > Input >> Tab Completion",title:"Limit tab-completion results to 25.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.prioritize-favorites",{default:!1,ui:{path:"Chat > Input >> Tab Completion",title:"Prioritize favorite emotes at the top.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.prioritize-prefix-matches",{default:!1,ui:{path:"Chat > Input >> Tab Completion",title:"Prioritize emotes that start with user input.",component:"setting-check-box"}}),this.settings.add("chat.tab-complete.matching",{default:1,ui:{path:"Chat > Input >> Tab Completion",title:"Emote Matching Type",description:"1: `ppa` would match `Kappa`\n\n2: `sip` would match `cohhSip` but not `Gossip`\n\n3: `pasta` would match `pastaThat` but not `HoldThat`",component:"setting-select-box",data:[{value:1,title:"1: Anything (Twitch style)"},{value:2,title:"2: Non-Prefix (Old FFZ style)"},{value:3,title:"3: Exact (Case-Insensitive)"}]}}),this.ChatInput=this.fine.define("chat-input",u=>u&&u.setLocalChatInputRef&&u.setLocalAutocompleteInputRef,v.Z.CHAT_ROUTES),this.EmoteSuggestions=this.fine.define("tab-emote-suggestions",u=>u&&u.getMatches&&u.autocompleteType==="emote",v.Z.CHAT_ROUTES),this.MentionSuggestions=this.fine.define("tab-mention-suggestions",u=>u&&u.getMentions&&u.renderMention,v.Z.CHAT_ROUTES),this.CommandSuggestions=this.fine.define("tab-cmd-suggestions",u=>u&&u.getMatches&&u.doesCommandMatchTerm,v.Z.CHAT_ROUTES),this.EmoteUsageCount={TriHard:196568036,Kappa:192158118,"4Head":155758710,PogChamp:151485090,cmonBruh:146352878,BibleThump:56472964,WutFace:45069031,Kreygasm:41387580,DansGame:38097659,SMOrc:34734484,KappaPride:34262839,VoHiYo:27886434,SwiftRage:24561900,ResidentSleeper:24438298,EleGiggle:19891526,FailFish:19118343,NotLikeThis:18802905,Keepo:18351415,BabyRage:18220906,MingLee:18026207,HeyGuys:14851569,ANELE:14648986,PJSalt:14438861}}async onEnable(){this.chat.context.on("changed:chat.hype.display-input",()=>this.ChatInput.forceUpdate()),this.chat.context.on("changed:chat.actions.room",()=>this.ChatInput.forceUpdate()),this.chat.context.on("changed:chat.actions.room-above",()=>this.ChatInput.forceUpdate()),this.chat.context.on("changed:chat.tab-complete.emotes-without-colon",g=>{for(const M of this.EmoteSuggestions.instances)M.canBeTriggeredByTab=g;for(const M of this.MentionSuggestions.instances)M.canBeTriggeredByTab=!g}),this.use_previews=this.chat.context.get("chat.inline-preview.enabled"),this.chat.context.on("changed:chat.inline-preview.enabled",g=>{if(!this.use_previews&&(this.use_previews=g,g))for(const M of this.ChatInput.instances)this.installPreviewObserver(M),M.ffzInjectEmotes(),M.forceUpdate(),this.emit("site:dom-update","chat-input",M)});const l=await this.site.findReact(),u=l&&l.createElement;if(!u)return this.log.warn("Unable to get React.");const C=this;this.ChatInput.ready((g,M)=>{const S=g.prototype.render;g.prototype.render=function(){const x=S.call(this);try{if(!C.chat.context.get("chat.hype.display-input")){const G=(0,m.findReactFragment)(x,J=>J.key==="paidPinnedMessage");G&&(G.type=()=>null)}const D=C.chat.context.get("chat.actions.room-above"),O=C.chat.context.get("context.chat_state")||{},K=D?(0,m.findReactFragment)(x,G=>G.props&&Array.isArray(G.props.children)):(0,m.findReactFragment)(x,G=>G.props&&G.props.className==="chat-input__buttons-container");if(!K||!K.props||!K.props.children)return x;const X=this.props;if(!X||!X.channelID)return x;const Q=X.sessionUser?{id:X.sessionUser.id,login:X.sessionUser.login,displayName:X.sessionUser.displayName,mod:X.isCurrentUserModerator,staff:X.isStaff}:null,P={id:X.channelID,login:X.channelLogin,displayName:X.channelDisplayName,emoteOnly:X.emoteOnlyMode,slowMode:X.slowMode,slowDuration:X.slowModeDuration,subsMode:X.subsOnlyMode,r9kMode:O.r9k,followersOnly:O.followersOnly,followersDuration:O.followersOnlyRequirement},B=C.actions.renderRoom(C.chat.context.get("context.chat.showModIcons"),Q,P,D,u);D?K.props.children.unshift(B||null):K.props.children.splice(1,0,B||null)}catch(k){C.log.error(k),C.log.capture(k)}return x};for(const x of M)x.forceUpdate(),this.emit("site:dom-update","chat-input",x),this.updateEmoteCompletion(x),this.overrideChatInput(x),x.ffzInjectEmotes(),this.installPreviewObserver(x)}),this.EmoteSuggestions.ready((g,M)=>{for(const S of M)this.overrideEmoteMatcher(S)}),this.MentionSuggestions.ready((g,M)=>{for(const S of M)this.overrideMentionMatcher(S)}),this.CommandSuggestions.ready((g,M)=>{for(const S of M)this.overrideCommandMatcher(S)}),this.ChatInput.on("update",this.updateEmoteCompletion,this),this.ChatInput.on("mount",this.overrideChatInput,this),this.ChatInput.on("mount",this.installPreviewObserver,this),this.ChatInput.on("unmount",this.removePreviewObserver,this),this.EmoteSuggestions.on("mount",this.overrideEmoteMatcher,this),this.MentionSuggestions.on("mount",this.overrideMentionMatcher,this),this.CommandSuggestions.on("mount",this.overrideCommandMatcher,this),this.chat.context.on("changed:chat.emotes.animated",this.uncacheTabCompletion,this),this.chat.context.on("changed:chat.emotes.enabled",this.uncacheTabCompletion,this),this.chat.context.on("changed:chat.tab-complete.matching",this.uncacheTabCompletion,this),this.on("chat.emotes:change-hidden",this.uncacheTabCompletion,this),this.on("chat.emotes:change-set-hidden",this.uncacheTabCompletion,this),this.on("chat.emotes:change-favorite",this.uncacheTabCompletion,this),this.on("chat.emotes:update-default-sets",this.uncacheTabCompletion,this),this.on("chat.emotes:update-user-sets",this.uncacheTabCompletion,this),this.on("chat.emotes:update-room-sets",this.uncacheTabCompletion,this),this.on("site.css_tweaks:update-chat-css",this.resizeInput,this)}uncacheTabCompletion(){for(const l of this.EmoteSuggestions.instances)l.ffz_ffz_cache=null,l.ffz_twitch_cache=null;if(this.use_previews)for(const l of this.ChatInput.instances)l.ffzInjectEmotes(),l.forceUpdate(),this.emit("site:dom-update","chat-input",l)}updateInput(){for(const l of this.ChatInput.instances)l&&(l.forceUpdate(),this.emit("site:dom-update","chat-input",l))}resizeInput(){this._resize_waiter&&cancelAnimationFrame(this._resize_waiter),this._resize_waiter=requestAnimationFrame(()=>this._resizeInput())}_resizeInput(){this._resize_waiter=null;for(const l of this.ChatInput.instances)l.resizeInput()}installPreviewObserver(l){if(l._ffz_preview_observer||!window.MutationObserver||!this.use_previews)return;const u=this.fine.getHostNode(l),C=u&&u.querySelector(".chat-input__textarea");C&&(l._ffz_preview_observer=new MutationObserver(g=>{for(const M of g)for(const S of M.addedNodes)S instanceof Element&&this.checkForPreviews(l,S)}),l._ffz_preview_observer.observe(C,{childList:!0,subtree:!0}))}checkForPreviews(l,u){if(u.querySelector?.('span[data-a-target="chat-input-emote-preview"]'))for(const C of document.querySelectorAll(".tw-tooltip-layer img.chat-line__message--emote"))C&&C.src.startsWith("https://static-cdn.jtvnw.net/emoticons/v2/__FFZ__")&&this.updatePreview(l,C);for(const C of u.querySelectorAll?.("img.chat-line__message--emote"))C&&(C.dataset.ffzId||C.src.startsWith("https://static-cdn.jtvnw.net/emoticons/v2/__FFZ__"))&&this.updatePreview(l,C)}updatePreview(l,u){let C=u.dataset.ffzSet,g=u.dataset.ffzId;if(!g){const K=u.src.indexOf("__FFZ__",49),X=u.src.slice(49,K),Q=X.indexOf("::");if(Q===-1)return;C=X.slice(0,Q),g=X.slice(Q+2),u.dataset.ffzSet=C,u.dataset.ffzId=g}const M=this.emotes.emote_sets[C],S=M?.emotes?.[g];if(!S)return;const x=this.chat.context.get("chat.emotes.animated")>0;u.src=(x?S.animSrc:null)??S.src,u.srcset=(x?S.animSrcSet:null)??S.srcSet;const k=`${S.width}px`,D=`${S.height}px`;u.style.width=k,u.style.height=D;const O=u.closest(".chat-image__container");if(O){O.style.width=k,O.style.height=D;const K=O.closest(".chat-line__message--emote-button");K&&(K.style.width=k,K.style.height=D,K._ffz_click_handler||(K._ffz_click_handler=this.previewClick.bind(this,S.id,M.id,S.name),K.addEventListener("click",K._ffz_click_handler)))}}previewClick(l,u,C,g){const M=this.makeEvent({provider:"ffz",id:l,set:u,name:C,source:g});this.emit("chat.emotes:click",M),M.defaultPrevented&&(g.preventDefault(),g.stopImmediatePropagation())}removePreviewObserver(l){l._ffz_preview_observer&&(l._ffz_preview_observer.disconnect(),l._ffz_preview_observer=null)}updateEmoteCompletion(l,u){u||(u=this.fine.searchTree(l,"tab-emote-suggestions",50)),u&&(u._ffz_user=l.props.sessionUser,u._ffz_channel_id=l.props.channelID,u._ffz_channel_login=l.props.channelLogin)}overrideChatInput(l){if(l._ffz_override)return;const u=this,C=l.onKeyDown,g=l.onMessageSend,M=l.resizeInput,S=l.componentDidUpdate;l.ffzInjectEmotes=function(){const x=this.props.emotes.findIndex(D=>D?.id==="FrankerFaceZWasHere"),k=u.createFakeEmoteSet(l);if(x===-1&&k)this.props.emotes.push(k);else if(x!==-1&&k)this.props.emotes.splice(x,1,k);else if(x!==-1&&!k)this.props.emotes.splice(x,1);else return},l.componentDidUpdate=function(x,...k){try{x.emotes!==this.props.emotes&&Array.isArray(this.props.emotes)&&l.ffzInjectEmotes()}catch(D){u.log.error("Error updating emote autocompletion data.",D)}S&&S.call(this,x,...k)},l.resizeInput=function(x,...k){try{if(x){if(l.chatInputRef instanceof Element){const D=getComputedStyle(l.chatInputRef),O=D&&parseFloat(D.lineHeight||18)||18,K=O*1+20.5,X=Math.ceil((l.chatInputRef.scrollHeight-K)/O),Q=Math.min(1+X,4);l.setState({numInputRows:Q})}}else l.setState({numInputRows:1})}catch(D){return u.log.error("Error in resizeInput",D),M.call(this,x,...k)}},l.messageHistory=[],l.tempInput="",l.messageHistoryPos=-1,l.ffzGetValue=function(){return l.chatInputRef&&typeof l.chatInputRef.value=="string"?l.chatInputRef.value:l.state.value&&typeof l.state.value=="string"?l.state.value:""},l.ffzGetSelection=function(){if(typeof l.chatInputRef?.selectionEnd=="number")return[l.chatInputRef.selectionStart,l.chatInputRef.selectionEnd];if(l.chatInputRef?.state?.slateEditor){const x=l.chatInputRef.state.slateEditor,k=x.selection,D=x.children;if(!k?.anchor?.path||!k?.focus?.path)return[0,0];const O=ft(D,k.anchor.path)+k.anchor.offset,K=ft(D,k.focus.path)+k.focus.offset;return O<K?[O,K]:[K,O]}return[0,0]},l.ffzSetSelection=function(x,k){l.chatInputRef?.setSelectionRange&&l.chatInputRef.setSelectionRange(x,k)},l.onKeyDown=function(x){try{const k=x.charCode||x.keyCode;if(l.onEmotePickerToggle&&u.chat.context.get("chat.emote-menu.shortcut")&&x.key==="e"&&x.ctrlKey&&!x.altKey&&!x.shiftKey){l.onEmotePickerToggle(),x.preventDefault();return}const D=l.ffzGetValue();if(l.autocompleteInputRef&&l.chatInputRef&&u.chat.context.get("chat.mru.enabled")&&!x.shiftKey&&!x.ctrlKey&&!x.altKey){const O=l.ffzGetSelection();if(k===38&&O[0]===0&&O[1]===0){if(!l.messageHistory.length)return;D&&l.messageHistoryPos===-1&&(l.tempInput=D),l.messageHistoryPos<l.messageHistory.length-1&&(l.messageHistoryPos++,l.autocompleteInputRef.setValue(l.messageHistory[l.messageHistoryPos]),l.ffzSetSelection(0));return}else if(k===40&&O[0]>=D.length&&O[1]===O[0]){if(!l.messageHistory.length)return;l.messageHistoryPos>0?(l.messageHistoryPos--,l.autocompleteInputRef.setValue(l.messageHistory[l.messageHistoryPos]),l.ffzSetSelection(l.messageHistory[l.messageHistoryPos].length)):l.messageHistoryPos===0&&(l.autocompleteInputRef.setValue(l.tempInput),l.ffzSetSelection(l.tempInput.length),l.messageHistoryPos=-1);return}}k===_.KEYS.Escape&&!x.shiftKey&&!x.ctrlKey&&!x.altKey&&(l.props.isShowingEmotePicker?l.props.closeEmotePicker():l.props.tray&&(!l.state.value||!l.state.value.length)&&l.props.clearTray())}catch(k){u.log.capture(k),u.log.error(k)}C.call(this,x)},l.onMessageSend=function(x){try{if(u.chat.context.get("chat.mru.enabled")){const k=l.ffzGetValue();k&&k.length&&(!l.messageHistory.length||l.messageHistory[0]!==k)&&(l.messageHistory.unshift(k),l.messageHistory=l.messageHistory.slice(0,20)),l.messageHistoryPos=-1,l.tempInput=""}}catch(k){u.log.capture(k),u.log.error(k)}g.call(this,x)}}overrideMentionMatcher(l){l.canBeTriggeredByTab=!this.chat.context.get("chat.tab-complete.emotes-without-colon")}overrideCommandMatcher(l){if(l._ffz_override)return;l._ffz_override=!0,l.oldCommands=l.getCommands,l.oldMatches=l.getMatches,l.oldReplacement=l.determineReplacement;const u=this;l.getMatches=function(M,S,x){try{return x===0&&u.chat.CommandPrefixes.includes(M[0])?l.getCommands(M):null}catch(k){return u.log.error("Error getting matches from command handler.",k),l.oldCommands(M,S,x)}},l.getCommands=function(M){try{const S=l.props.getCommands(l.props.permissionLevel,{isEditor:l.props.isCurrentUserEditor}),x=u.fine.searchParent(l,Q=>Q?.props?.channelID&&Q?.props?.setTray,50),k=u.makeEvent({input:M,permissionLevel:l.props.permissionLevel,isEditor:l.props.isCurrentUserEditor,commands:S,__input:x,channel:x?{id:x.props.channelID,login:x.props.channelLogin}:null});if(u.emit("chat:get-tab-commands",k),!S||!S.length)return null;const D=M[0],O=M.slice(1),K=S.filter(Q=>D===(Q.prefix??"/")&&l.doesCommandMatchTerm(Q,O)).sort(l.sortCommands),X=[];for(const Q of K){const P=Q.commandArgs?.[0];let B;P?.isRequired&&(B=`[${P.name}]`),X.push({current:M,replacement:l.determineReplacement(Q),description:Q.description,element:l.renderCommandSuggestion(Q,O),group:Q.ffz_group?Array.isArray(Q.ffz_group)?u.i18n.t(...Q.ffz_group):Q.ffz_group:l.determineGroup(Q),selection:B})}return D!=="/"&&!X.length?null:X}catch(S){return console.error(S),l.oldCommands(M)}},l.determineReplacement=function(M){const S=l.oldReplacement(M);return(M.prefix??"/")!=="/"&&S.startsWith("/")?M.prefix+S.slice(1):S};const C=this.site.getReact(),g=C?.createElement;g&&(l.renderCommandSuggestion=function(M,S){const x=Array.isArray(M?.commandArgs)?M.commandArgs.map(k=>g("div",{class:`tw-mg-r-05${k.isRequired?"":" tw-c-text-alt"}`},"[",k.name,"]")):null;return g("div",{class:"tw-pd-05"},g("div",{class:"tw-flex"},g("div",{class:"tw-mg-r-05"},g("span",null,M.prefix??"/"),g("span",{class:"tw-semibold"},M.name)),x),g("p",{class:"tw-c-text-alt-2 tw-font-size-7"},M.description))})}createFakeEmoteSet(l){if(!this.use_previews)return null;if(!l._ffz_channel_login){const k=this.fine.searchParent(l,"chat-input",50);k&&this.updateEmoteCompletion(k,l)}const u=l._ffz_user,C=l._ffz_channel_id,g=l._ffz_channel_login;if(!g)return null;const M=this.emotes.getSets(u?.id,u?.login,C,g);if(!M||!M.length)return null;const S=[],x=new Set;for(const k of M){if(!k||!k.emotes)continue;const D=k.source||"ffz";for(const O of Object.values(k.emotes))!O||!O.id||!O.name||x.has(O.name)||(x.add(O.name),S.push({id:`__FFZ__${k.id}::${O.id}__FFZ__`,modifiers:null,setID:"FrankerFaceZWasHere",token:O.name}))}return{__typename:"EmoteSet",emotes:S,id:"FrankerFaceZWasHere",owner:null}}overrideEmoteMatcher(l){if(l._ffz_override)return;const u=this;l.canBeTriggeredByTab=this.chat.context.get("chat.tab-complete.emotes-without-colon"),l.getMatches=function(M,S){return S?M.length<2?null:l.getMatchedEmotes(M):M.startsWith(":")?M.length<3?null:l.getMatchedEmotes(M):null},l.doesEmoteMatchTerm=function(M,S){const x=M.name||M.token;if(!x)return mt;if(x.startsWith(S))return nt;let k=M.tokenLower;k||(k=x.toLowerCase());const D=S.toLowerCase();if(k.startsWith(D))return Z;const O=x.indexOf(S.charAt(0).toUpperCase());return O!==-1&&k.slice(O+1).startsWith(D.slice(1))?L:k.includes(D)?W:mt},l.getMatchedEmotes=function(M){const S=u.chat.context.get("chat.emotes.enabled"),x=u.chat.context.get("chat.tab-complete.limit-results");let k=S?u.getTwitchEmoteSuggestions(M,this):[];if(S>1&&u.chat.context.get("chat.tab-complete.ffz-emotes")){const D=u.getEmoteSuggestions(M,this);Array.isArray(D)&&D.length&&(k=k.concat(D))}if(u.chat.context.get("chat.tab-complete.emoji")){const D=u.getEmojiSuggestions(M,this);Array.isArray(D)&&D.length&&(k=Array.isArray(k)?k.concat(D):D)}return k=u.sortEmotes(k),x&&k.length>25?k.slice(0,25):k};const C=this.site.getReact(),g=C?.createElement;l.renderFFZEmojiSuggestion=function(M){return g(C.Fragment,null,g("div",{class:"tw-relative tw-flex-shrink-0 tw-pd-05",title:M.token,favorite:M.favorite},g("img",{class:"emote-autocomplete-provider__image ffz-emoji",src:M.src,srcSet:M.srcset}),M.favorite&&g("figure",{class:"ffz--favorite ffz-i-star"})),g("div",{class:"tw-ellipsis",title:M.token},M.token))},l.renderEmoteSuggestion=function(M){return g(C.Fragment,null,g("div",{class:"tw-relative tw-flex-shrink-0 tw-pd-05",title:M.token,favorite:M.favorite},g("img",{class:"emote-autocomplete-provider__image",srcSet:M.srcSet}),M.favorite&&g("figure",{class:"ffz--favorite ffz-i-star"})),g("div",{class:"tw-ellipsis",title:M.token},M.token))}}sortEmotes(l){const u=this.chat.context.get("chat.tab-complete.prioritize-favorites"),C=this.chat.context.get("chat.tab-complete.emotes-without-colon"),g=this.chat.context.get("chat.tab-complete.prioritize-prefix-matches");return l.sort((M,S)=>{const x=M.matched||M.replacement,k=S.matched||S.replacement;if(u&&M.favorite^S.favorite)return 0-M.favorite+S.favorite;if(g){const D=!!M.matched,O=!!S.matched;if(D^O)return C?0-D+O:0-O+D;const K=M.match_type===nt,X=S.match_type===nt;if(K&&X)return ut.compare(x,k);if(K)return-1;if(X)return 1;const Q=M.match_type===Z,P=S.match_type===Z;return Q&&P?rt.compare(x,k):Q?-1:P?1:ut.compare(x,k)}return 0})}buildTwitchCache(l){if(!Array.isArray(l))return{emotes:[],length:0};const u=[],C=new Set,g=this.chat.context.get("chat.emotes.animated")>0,M=this.settings.provider.get("emote-menu.hidden-sets"),S=Array.isArray(M)&&M.length>0,x=this.emotes.getHidden("twitch"),k=this.emotes.getFavorites("twitch");for(const D of l){const O=parseInt(D.id,10),K=D.owner,X=_.TWITCH_POINTS_SETS.includes(O)||K?.login==="channel_points",Q=X?null:K;if(D.id==="FrankerFaceZWasHere")continue;let P=`twitch-set-${D.id}`,B=null;if(Q?.login?(P=`twitch-${Q.id}`,B=Q.displayName||Q.login):X?P="twitch-points":_.TWITCH_GLOBAL_SETS.includes(O)?P="twitch-global":_.TWITCH_PRIME_SETS.includes(O)?P="twitch-prime":P="twitch-misc",!(S&&M.includes(P)))for(const G of D.emotes){if(!G||!G.id||x.includes(G.id))continue;const J=G.id,ot=_.KNOWN_CODES[G.token]||G.token;if(!ot||C.has(ot))continue;C.add(ot);const ct=_.REPLACEMENTS[J];let gt;ct&&this.chat.context.get("chat.fix-bad-emotes")?gt=`${_.REPLACEMENT_BASE}${ct} 1x`:gt=(0,y.getTwitchEmoteSrcSet)(J,g),u.push({id:J,source:P,extra:B,setID:D.id,token:ot,tokenLower:ot.toLowerCase(),srcSet:gt,favorite:k.includes(J)})}}return{emotes:u,length:l.length}}getTwitchEmoteSuggestions(l,u){u.ffz_twitch_cache?.length!==u.props.emotes?.length&&(u.ffz_twitch_cache=this.buildTwitchCache(u.props.emotes));const C=this.chat.context.get("chat.tab-complete.matching"),g=u.ffz_twitch_cache.emotes;if(!g.length)return[];const M=[],S=[],x=[],k=l.startsWith(":")?l.slice(1):l;for(const D of g){const O=u.doesEmoteMatchTerm(D,k);if(O<C)continue;const K={current:l,emote:D,replacement:D.token,element:u.renderEmoteSuggestion(D),favorite:D.favorite,count:this.EmoteUsageCount[D.token]||0,match_type:O};O<C||(K.count>0?M.push(K):O>L?S.push(K):x.push(K))}return M.sort((D,O)=>O.count-D.count),S.sort((D,O)=>ut.compare(D.replacement,O.replacement)),x.sort((D,O)=>ut.compare(D.replacement,O.replacement)),M.concat(S).concat(x)}getEmojiSuggestions(l,u){if(!l.startsWith(":"))return[];let C=l.slice(1).toLowerCase();const g=this.chat.context.get("chat.emoji.style"),M=this.settings.provider.get("emoji-tone",null),S=this.emotes.getFavorites("emoji"),x=[],k=C.endsWith(":");k&&(C=C.slice(0,-1));const D=new Set;for(const O in this.emoji.names)if(k?O===C:O.startsWith(C)){const K=this.emoji.emoji[this.emoji.names[O]],X=K.variants&&K.variants[M],Q=X||K;if(K&&(g===0||Q.has[g])&&!D.has(Q.raw)){D.add(Q.raw);const P=this.emoji.getFullImageSet(Q.image,g),B=`:${O}:`,G=S.includes(K.code);x.push({current:l,emoji:Q,matched:B,srcSet:P,replacement:Q.raw,element:u.renderFFZEmojiSuggestion({token:B,id:`emoji-${K.code}`,src:this.emoji.getFullImage(Q.image,g),srcSet:P,favorite:G}),favorite:G})}}return x}buildFFZCache(l,u,C,g){const M=this.emotes.getSets(l,u,C,g);if(!M||!M.length)return{emotes:[],length:0,user_id:l,user_login:u,channel_id:C,channel_login:g};const S=[],x=this.chat.context.get("chat.emotes.animated")>0,k=this.settings.provider.get("emote-menu.hidden-sets"),D=Array.isArray(k)&&k.length>0,O=new Set;for(const K of M){if(!K||!K.emotes)continue;const X=K.source||"ffz",Q=K.source_line||`${K.source||"FFZ"} ${K.title||"Global"}`,P=`${K.merge_source||X}-${K.merge_id||K.id}`;if(D&&k.includes(P))continue;const B=this.emotes.getHidden(X),G=this.emotes.getFavorites(X);for(const J of Object.values(K.emotes))!J||!J.id||J.hidden||B.includes(J.id)||O.has(J.name)||J.name&&(O.add(J.name),S.push({id:`${X}-${J.id}`,source:X,extra:Q,token:J.name,tokenLower:J.name.toLowerCase(),srcSet:x&&J.animSrcSet||J.srcSet,favorite:G.includes(J.id)}))}return{emotes:S,length:M.length}}getEmoteSuggestions(l,u){if(!u._ffz_channel_login){const K=this.fine.searchParent(u,"chat-input",50);K&&this.updateEmoteCompletion(K,u)}const C=this.chat.context.get("chat.tab-complete.matching"),g=u._ffz_user,M=u._ffz_channel_id,S=u._ffz_channel_login;if(!S)return[];let x=u.ffz_ffz_cache;(!x||x.user_id!==g?.id||x.user_login!==g?.login||x.channel_id!==M||x.channel_login!==S)&&(x=u.ffz_ffz_cache=this.buildFFZCache(g?.id,g?.login,M,S));const k=x.emotes;if(!k.length)return[];const D=l.startsWith(":")?l.slice(1):l,O=[];for(const K of k){const X=u.doesEmoteMatchTerm(K,D);X<C||O.push({current:l,emote:K,replacement:K.token,element:u.renderEmoteSuggestion(K),favorite:K.favorite,count:0,match_type:X})}return O}getInput(){for(const l of this.ChatInput.instances)if(!(!l.autocompleteInputRef||!l.state)&&l.state.value)return l.state.value;return null}pasteMessage(l,u){for(const C of this.ChatInput.instances)if(C?.props?.channelLogin===l){if(!C.autocompleteInputRef||!C.state)return;C.state.value&&(u=`${C.state.value} ${u}`),C.autocompleteInputRef.setValue(u),C.autocompleteInputRef.componentRef?.focus?.()}}};$(ge,"Input");let lt=ge;const _e=class _e extends b.default{constructor(...l){super(...l),this.inject("chat"),this.inject("settings"),this.inject("site.css_tweaks"),this.inject("site.fine"),this.last_login=null,this.settings.add("chat.viewer-cards.highlight-chat",{default:!1,ui:{path:"Chat > Viewer Cards >> Appearance",title:"Highlight messages from users with open viewer cards.",component:"setting-check-box"}}),this.settings.add("chat.viewer-cards.color",{default:"",ui:{path:"Chat > Viewer Cards >> Appearance",title:"Highlight Color",component:"setting-color-box"}}),this.settings.add("chat.viewer-cards.use-color",{requires:["chat.viewer-cards.highlight-chat","chat.viewer-cards.color"],process(u){if(u.get("chat.viewer-cards.highlight-chat"))return u.get("chat.viewer-cards.color")}}),this.ViewerCard=this.fine.define("chat-viewer-card",u=>u.props?.targetLogin&&u.props?.hideViewerCard)}onEnable(){this.chat.context.on("changed:chat.viewer-cards.highlight-chat",this.refreshStyle,this),this.chat.context.on("changed:chat.viewer-cards.color",this.refreshStyle,this),this.on("..:update-colors",this.refreshStyle,this),this.ViewerCard.on("mount",this.updateCard,this),this.ViewerCard.on("update",this.updateCard,this),this.ViewerCard.on("unmount",this.unmountCard,this)}refreshStyle(){this.updateStyle(this.last_login)}updateStyle(l){if(typeof l=="string"&&(l=l.toLowerCase()),this.last_login=l,l&&this.chat.context.get("chat.viewer-cards.highlight-chat")){let u=this.chat.context.get("chat.viewer-cards.color");u&&u.length?u=this.parent.inverse_colors.process(u):this.chat.context.get("theme.is-dark")?u="rgba(0,80,255,0.2)":u="rgba(128,170,255,0.2)",this.css_tweaks.set("viewer-card-highlight",`
body .chat-room .chat-scrollable-area__message-container > div:nth-child(1n+0) > .chat-line__message:not(.chat-line--inline):not(.something-nonexistent)[data-user="${l}"],
body .chat-room .chat-line__message:not(.chat-line--inline):nth-child(1n+0)[data-user="${l}"] {
	background-color: ${u} !important;
}`)}else this.css_tweaks.delete("viewer-card-highlight")}updateCard(l){this.updateStyle(l.props&&l.props.targetLogin)}unmountCard(){this.updateStyle()}};$(_e,"ViewerCards");let ht=_e;const pt=(0,y.make_enum)("Post","Action"),_t=(0,y.make_enum)("Ban","Timeout","Delete"),Ct=(0,y.make_enum)("MessageRejectedPrompt","CheerMessageRejectedPrompt","MessageRejected","MessageAllowed","MessageDenied","CheerMessageDenied","CheerMessageTimeout","MessageModApproved","MessageModDenied"),jt=["Message","Notice","Moderation","ModerationAction","TargetedModerationAction","AutoMod","SubscriberOnlyMode","FollowerOnlyMode","SlowMode","EmoteOnlyMode","R9KMode","Connected","Disconnected","Reconnect","RoomMods","RoomState","BadgesUpdated"],It=(0,y.make_enum)("Message","ExtensionMessage","Moderation","ModerationAction","TargetedModerationAction","AutoMod","SubscriberOnlyMode","FollowerOnlyMode","SlowMode","EmoteOnlyMode","R9KMode","Connected","Disconnected","Reconnect","Subscription","Resubscription","GiftPaidUpgrade","AnonGiftPaidUpgrade","PrimePaidUpgrade","PrimeCommunityGiftReceivedEvent","ExtendSubscription","SubGift","AnonSubGift","Clear","RoomMods","RoomState","Raid","Unraid","Notice","Info","BadgesUpdated","Purchase","BitsCharity","CrateGift","RewardGift","SubMysteryGift","AnonSubMysteryGift","StandardPayForward","CommunityPayForward","FirstCheerMessage","FirstMessageHighlight","BitsBadgeTierMessage","InlinePrivateCallout","ChannelPointsReward","CommunityChallengeContribution","LiveMessageSeparator","RestrictedLowTrustUserMessage","CommunityIntroduction","Shoutout","AnnouncementMessage","CharityDonation","MessageIdUpdate","ViewerMilestone","GigantifiedEmote"),oe=["Reconnect","RoomState","BadgesUpdated","Clear"],Re={pinned_re_sub:"share-resub",community_points_reward:"community-points-rewards",clip_live_nudge_chat_trigger:"clip-live-nudge",cheer_badge_grant:"bits-badge-tier"},re={AppointedModerator:"appointed-moderator",BitsBadgeTier:"bits-badge-tier",BitsPowerUps:"bits-power-ups",ClipLiveNudge:"clip-live-nudge",CommunityMoment:"community-moment",CommunityPointsRewards:"community-points-rewards",CosmicAbyss:"cosmic-abyss",CreatorAnniversaries:"creator-anniversaries",Drop:"drop",EarnedSubBadge:"earned-sub-badge",FavoritedGuestCollab:"favorited-guest-collab",GiftBadgeExpiration:"gift-badge-expiration",GiftBadgeRestored:"gift-badge-restored",GiftBundleUpSell:"gift-bundle-up-sell",HypeTrainRewards:"hype-train-rewards",LapsedBitsUser:"lapsed-bits-user",PartnerPlusUpSellNudge:"partner-plus-up-sell-nudge",ReplyByKeyboard:"reply-by-keyboard",RequestToJoinAccepted:"request-to-join-accepted",STPromo:"st-promo",ShareResub:"share-resub",SubtemberPromoBits:"subtember-promo-bits",ThankSubGifter:"thank-sub-gifter",TurnOffAnimatedEmotes:"turn-off-animated-emotes",WalletDrop:"wallet-drop"},Ce=[],De=["onBadgesUpdatedEvent"],ve=class ve extends b.default{constructor(...l){super(...l),this.should_enable=!0,this.shared_room_data=new Map,this.shared_rooms={},this.colors=new N.ColorAdjuster,this.inverse_colors=new N.ColorAdjuster,this.inject("settings"),this.inject("i18n"),this.inject("experiments"),this.inject("site"),this.inject("site.router"),this.inject("site.fine"),this.inject("site.web_munch"),this.inject("site.css_tweaks"),this.inject("site.subpump"),this.inject("chat"),this.inject(s),this.inject(d),this.inject(h),this.inject(it),this.inject(lt),this.inject(ht),this.ChatLeaderboard=this.fine.define("chat-leaderboard",u=>u.props?.topItems&&(0,y.has)(u.props,"forceMiniView")&&(0,y.has)(u.props,"leaderboardType"),v.Z.CHAT_ROUTES),this.ChatService=this.fine.define("chat-service",u=>u.join&&u.client&&u.props.setChatConnectionAPI,v.Z.CHAT_ROUTES),this.ChatBuffer=this.fine.define("chat-buffer",u=>u.updateHandlers&&u.delayedMessageBuffer&&u.handleMessage,v.Z.CHAT_ROUTES),this.ChatController=this.fine.define("chat-controller",u=>u.parseOutgoingMessage&&u.onRoomStateUpdated&&u.renderNotifications,v.Z.CHAT_ROUTES),this.ChatRenderer=this.fine.define("chat-renderer",u=>u.mapMessagesToChatLines&&u.reportChatRenderSent,v.Z.CHAT_ROUTES),this.ChatContainer=this.fine.define("chat-container",u=>u.closeViewersList&&u.onChatInputFocus,v.Z.CHAT_ROUTES),this.ChatBufferConnector=this.fine.define("chat-buffer-connector",u=>u.clearBufferHandle&&u.syncBufferedMessages,v.Z.CHAT_ROUTES),this.joined_raids=new Set,this.RaidController=this.fine.define("raid-controller",u=>u.handleLeaveRaid&&u.handleJoinRaid,v.Z.CHAT_ROUTES),this.InlineCallout=this.fine.define("inline-callout",u=>u.showCTA&&u.toggleContextMenu&&u.actionClick,v.Z.CHAT_ROUTES),this.PinnedCallout=this.fine.define("pinned-callout",u=>u.getCalloutTitle&&u.buildCalloutProps&&u.pin,v.Z.CHAT_ROUTES),this.CalloutSelector=this.fine.define("callout-selector",u=>u.selectCalloutComponent&&u.props&&(0,y.has)(u.props,"callouts"),v.Z.CHAT_ROUTES),this.PointsButton=this.fine.define("points-button",u=>u.renderIcon&&u.renderFlame&&u.handleIconAnimationComplete,v.Z.CHAT_ROUTES),this.PointsClaimButton=this.fine.define("points-claim-button",u=>u.getClaim&&u.onClick&&u.props&&u.props.claimCommunityPoints,v.Z.CHAT_ROUTES),this.CommunityChestBanner=this.fine.define("community-chest-banner",u=>u.getLastGifterText&&u.getBannerText&&(0,y.has)(u,"finalCount"),v.Z.CHAT_ROUTES),this.PointsInfo=this.fine.define("points-info",u=>u.pointIcon!==void 0&&u.pointName!==void 0,v.Z.CHAT_ROUTES),this.GiftBanner=this.fine.define("gift-banner",u=>u.getBannerText&&u.onGiftMoreClick,v.Z.CHAT_ROUTES),this.settings.add("chat.subs.native",{default:!1,ui:{path:"Chat > Appearance >> Subscriptions",title:"Display subscription notices using Twitch's native UI.",component:"setting-check-box"}}),this.settings.add("chat.filtering.show-reasons",{default:!1,ui:{path:"Chat > Filtering > General >> Appearance",title:"Display Reasons",description:"If this is enabled, the reasons a given message was highlighted will be displayed alongside the message. This is a simple display. Enable the debugging option below in Behavior for more details, but be aware that the debugging option has a slight performance impact compared to this.",component:"setting-select-box",data:[{value:!1,title:"Disabled"},{value:1,title:"Above Message"},{value:2,title:"Inline"}]}}),this.settings.add("chat.disable-handling",{default:null,requires:["context.disable-chat-processing"],process(u,C){return C!=null?!C:!!u.get("context.disable-chat-processing")},ui:{path:"Debugging > Chat >> Processing",title:"Enable processing of chat messages.",component:"setting-check-box",force_seen:!0}}),this.settings.addUI("debug.chat-test",{path:"Debugging > Chat >> Chat",component:"chat-tester",getChat:()=>this,force_seen:!0}),this.settings.add("chat.filtering.blocked-callouts",{default:[],type:"array_merge",always_inherit:!0,process:(u,C)=>{const g=new Set,M=this.callout_types??re;for(const S of C)S?.v&&M[S.v]&&!Ce.includes(S.v)&&g.add(M[S.v]);return g},ui:{path:'Chat > Filtering > Block >> Callout Types @{"description":"This filter allows you to remove callouts of specific types from Twitch chat. Callouts are special messages that can be pinned to the bottom of chat and often have associated actions, like claiming a drop or sharing your resubscription."}',component:"blocked-types",data:()=>Object.keys(this.callout_types).filter(u=>!Ce.includes(u)).sort()}}),this.settings.add("chat.filtering.blocked-types",{default:[],type:"array_merge",always_inherit:!0,process(u,C){const g=new Set;for(const M of C)M?.v&&!jt.includes(M.v)&&g.add(M.v);return g},ui:{path:'Chat > Filtering > Block >> Message Types @{"description":"This filter allows you to remove all messages of a certain type from Twitch chat. It can be used to filter system messages, such as Hosts or Raids. Some types, such as moderation actions, cannot be blocked to prevent chat functionality from breaking."}',component:"blocked-types",data:()=>Object.keys(this.chat_types).filter(u=>!jt.includes(u)&&!/^\d+$/.test(u)).sort()}}),this.settings.add("chat.replies.style",{default:1,ui:{path:"Chat > Appearance >> Replies",title:"Style",description:"Twitch's default style adds a floating button to the right and displays a notice above messages that are replies. FrankerFaceZ uses an In-Line Chat Action (that can be removed in [Chat > Actions > In-Line](~chat.actions.in_line)) and uses an in-line mention to denote replies.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Twitch (Default)"},{value:2,title:"FrankerFaceZ"}]}}),this.settings.add("channel.raids.no-autojoin",{default:!1,ui:{path:"Channel > Behavior >> Raids",title:"Do not automatically join raids.",component:"setting-check-box"}}),this.settings.add("chat.powerup.effects",{default:!0,ui:{path:"Chat > Appearance >> Community",title:'Allow "Message Effects" messages to appear in chat.',component:"setting-check-box",description:"*Note*: Only affects messages sent after you change this setting. You can use your own chat for testing."}}),this.settings.add("channel.raids.blocked-channels",{default:[],type:"array_merge",always_inherit:!0,ui:{path:'Channel > Behavior >> Raids: Blocked Channels @{"description": "You will not automatically join raids to channels listed here."}',component:"basic-terms",words:!1}}),this.settings.add("__filter:channel.raids.blocked-channels",{requires:["channel.raids.blocked-channels"],equals:"requirements",process(u){const C=u.get("channel.raids.blocked-channels");if(!C||!C.length)return null;const g=[];for(const M of C){const S=M.t;let x=M.v;S==="glob"?x=(0,y.glob_to_regex)(x):S!=="raw"&&(x=(0,y.escape_regex)(x)),!(!x||!x.length)&&g.push(x)}return g.length?new RegExp(`^(?:${g.join("|")})$`,"gi"):null}}),this.settings.add("chat.hide-community-highlights",{default:!1,ui:{path:"Chat > Appearance >> Community",title:"Hide all Community Highlights from the top of chat.",component:"setting-check-box",description:"Community Highlights are polls, community gift subs, etc. that float over the top of chat temporarily with no way to close them."}}),this.settings.add("chat.subs.gift-banner",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Display a banner at the top of chat when a mass gift sub happens.",component:"setting-check-box"}}),this.settings.add("chat.banners.last-events",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow the Support Activity Feed to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.charity",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow the charity fundraiser progress to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.hide-appleplus",{default:!1,ui:{path:"Chat > Appearance >> Community",title:"Hide the drop notification for getting AppleTV+ when you buy a subscription.",component:"setting-check-box",description:`**Note:** Normally, I wouldn't add something that directly affects an advertisement like this, but Twitch broke the "Don't show again" checkbox, so it's up to us to fix it.`}}),this.settings.add("chat.banners.hype-train",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow the Hype Train to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.shared-chat",{default:!0,ui:{path:"Chat > Shared Chat >> Behavior",title:"Allow the Shared Chat notice to be displayed in chat when a Shared Chat is enabled.",component:"setting-check-box"}}),this.settings.add("chat.banners.pinned-message",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow Pinned Messages to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.drops",{default:!0,ui:{path:"Chat > Drops >> Appearance",title:"Allow messages about Drops to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.polls",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow Polls to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.banners.prediction",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Allow Predictions to be displayed in chat.",component:"setting-check-box"}}),this.settings.add("chat.callouts.clip",{default:!0,ui:{path:"Chat > Appearance >> Community",title:'Allow the "Chat seems active." clip suggestion to be displayed in chat.',component:"setting-check-box"}}),this.settings.add("chat.community-chest.show",{default:!0,ui:{path:"Chat > Appearance >> Community",title:"Display the Community Gift Chest banner.",component:"setting-check-box"}}),this.settings.add("chat.points.allow-highlight",{default:2,ui:{path:"Chat > Channel Points >> Appearance",title:"Highlight the message in chat when someone redeems Highlight My Message.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Twitch Style"},{value:2,title:"FFZ Style"}]}}),this.settings.add("chat.points.show-callouts",{default:!0,ui:{path:"Chat > Channel Points >> General",title:"Display messages in chat about Channel Points rewards.",component:"setting-check-box"}}),this.settings.add("chat.points.show-button",{default:!0,ui:{path:"Chat > Channel Points >> General",title:"Display Channel Points button beneath chat.",component:"setting-check-box"}}),this.settings.add("chat.points.show-rewards",{default:!0,requires:["layout.portrait-min-chat"],process(u,C){return u.get("layout.portrait-min-chat")?!1:C},ui:{path:"Chat > Channel Points >> Behavior",title:"Allow available rewards to appear next to the Channel Points button.",component:"setting-check-box"}}),this.settings.add("chat.points.auto-rewards",{default:!1,ui:{path:"Chat > Channel Points >> Behavior",title:"Automatically claim bonus rewards.",component:"setting-check-box",force_seen:!0}}),this.settings.add("chat.drops.auto-rewards",{default:!1,ui:{path:"Chat > Drops >> Behavior",title:"Automatically claim drops.",component:"setting-check-box"}}),this.settings.add("chat.pin-resubs",{default:!1,ui:{path:"Chat > Behavior >> General",title:"Automatically pin re-subscription messages in chat.",component:"setting-check-box"}}),this.settings.add("chat.shared-chat.style",{default:null,ui:{path:"Chat > Shared Chat >> Appearance",title:"Pill Style",component:"setting-select-box",description:"This controls the appearance of the pill at the left-side of chat messages when a message is part of a Shared Chat. By default, this is Avatar for moderators and broadcasters and Hidden for everyone else.",data:[{value:null,title:"Automatic"},{value:0,title:"Hidden"},{value:1,title:"Channel Name"},{value:2,title:"Avatar"}]}}),this.settings.add("chat.shared-chat.username-tooltip",{default:!0,ui:{path:"Chat > Shared Chat >> Appearance",component:"setting-check-box",title:"Display the source channel of a chat message when hovering over the poster's username."}}),this.settings.add("chat.width",{default:null,ui:{path:'Chat > Appearance >> General @{"sort": -1}',title:"Width",description:"How wide chat should be, in pixels. This may be affected by your browser's zoom and font size settings.",component:"setting-text-box",process(u){return u=parseInt(u,10),isNaN(u)||!isFinite(u)||u<=0?null:u}}}),this.settings.add("chat.effective-width",{requires:["chat.width","context.ui.rightColumnWidth"],process(u){const C=u.get("chat.width");return C??(u.get("context.ui.rightColumnWidth")||340)}}),this.settings.add("chat.use-width",{requires:["chat.width","context.ui.rightColumnExpanded","context.isWatchParty"],process(u){return!u.get("context.ui.rightColumnExpanded")||u.get("context.isWatchParty")?!1:u.get("chat.width")!=null}}),this.settings.add("chat.bits.show-pinned",{requires:["chat.bits.show"],default:null,process(u,C){return C??u.get("chat.bits.show")},ui:{path:"Chat > Appearance >> Community",title:"Display Leaderboard",description:`The leaderboard shows the top cheerers and sub gifters in a channel.

By default due to a previous implementation, this inherits its value from [Chat > Bits and Cheering > Display Bits](~chat.bits_and_cheering).`,component:"setting-check-box"}}),this.settings.add("chat.bits.show-rewards",{requires:["chat.bits.show"],default:null,process(u,C){return C??u.get("chat.bits.show")},ui:{path:"Chat > Bits and Cheering >> Behavior",title:"Display messages when a cheer shares rewards to people in chat.",description:"By default, this inherits its value from Display Bits. This setting only affects newly arrived messages.",component:"setting-check-box"}}),this.settings.add("chat.bits.cheer-notice",{default:!0,ui:{path:"Chat > Bits and Cheering >> Appearance",title:"Display a notice on chat messages that include cheers.",description:"This feature is intended to prevent possible confusion from chatters using emotes to fake cheers in messages. When enabled, messages that contain real cheers will display a message above them, similar to how resubscription messages or point redemptions with messages function.",component:"setting-check-box"}}),this.settings.add("chat.rituals.show",{default:!0,ui:{path:"Chat > Filtering > General >> Rituals",title:'Display ritual messages such as "User is new here! Say Hello!".',component:"setting-check-box"}}),this.settings.add("chat.extra-timestamps",{default:!0,ui:{path:"Chat > Appearance >> Chat Lines",title:"Display timestamps on notices.",description:"When enabled, timestamps will be displayed on point redemptions, subscriptions, etc.",component:"setting-check-box"}}),this.settings.add("chat.hype.message-style",{default:1,ui:{path:"Chat > Hype Chat >> Appearance",title:"Hype Chat Style",component:"setting-select-box",description:"**Note**: Hype Chats that include messages will always have their messages displayed, regardless of setting. Changes made to this setting may not affect existing chat messages.",data:[{value:0,title:"Do Not Display"},{value:1,title:"Standard Twitch (Large, Colored, Limited FFZ Support)"},{value:2,title:"Minimal (Marked with System Message, No Colors)"}]}}),this.settings.add("chat.subs.show",{default:3,ui:{path:"Chat > Appearance >> Subscriptions",title:"Display Subs in Chat",component:"setting-select-box",description:'**Note**: Messages sent with re-subs will always be displayed. This only controls the special "X subscribed!" message.',data:[{value:0,title:"Do Not Display"},{value:1,title:"Re-Subs with Messages Only"},{value:2,title:"Re-Subs Only"},{value:3,title:"Display All"}]}}),this.settings.add("chat.subs.compact",{default:!1,ui:{path:"Chat > Appearance >> Subscriptions",title:"Display subscription notices in a more compact (classic style) form.",component:"setting-check-box"}}),this.settings.add("chat.subs.merge-gifts",{default:1e3,ui:{path:"Chat > Appearance >> Subscriptions",title:"Merge Mass Sub Gifts",component:"setting-select-box",data:[{value:1e3,title:"Disabled"},{value:50,title:"More than 50"},{value:20,title:"More than 20"},{value:10,title:"More than 10"},{value:5,title:"More than 5"},{value:0,title:"Always"}],description:`Merge mass gift subscriptions into a single message, depending on the quantity.
**Note:** Only affects newly gifted subs.`}}),this.settings.add("chat.subs.merge-gifts-visibility",{default:!1,ui:{path:"Chat > Appearance >> Subscriptions",title:"Expand merged mass sub gift messages by default.",component:"setting-check-box"}}),this.settings.add("chat.lines.alternate",{default:!1,ui:{path:"Chat > Appearance >> Chat Lines",title:"Display lines with alternating background colors.",component:"setting-check-box"}}),this.settings.add("chat.lines.padding",{default:!1,ui:{path:"Chat > Appearance >> Chat Lines",title:"Reduce padding around lines.",component:"setting-check-box"}}),this.settings.add("chat.lines.borders",{default:0,ui:{path:"Chat > Appearance >> Chat Lines",title:"Separators",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Basic Line (1px Solid)"},{value:2,title:"3D Line (2px Groove)"},{value:3,title:"3D Line (2px Groove Inset)"},{value:4,title:"Wide Line (2px Solid)"}]}}),this.settings.add("chat.input.show-mod-view",{default:!0,ui:{path:"Chat > Input >> Appearance",title:'Allow the "Mod View" button to appear in relevant channels.',component:"setting-check-box"}}),this.settings.add("chat.input.show-highlight",{default:!0,ui:{path:"Chat > Input >> Appearance",title:'Allow the "Chat Highlight Settings" button to appear in relevant channels.',component:"setting-check-box"}}),this.settings.add("chat.input.show-shield",{default:!0,ui:{path:"Chat > Input >> Appearance",title:'Allow the "Shield Mode" button to appear in relevant channels.',component:"setting-check-box"}}),this.settings.add("chat.input.show-elevate-your-message",{default:!0,ui:{path:"Chat > Input >> Appearance",title:'Allow the "Elevate Your Message" button to be displayed.',component:"setting-check-box"}})}get currentChat(){for(const l of this.ChatController.instances)if(l&&l.chatService)return l;return null}updateColors(){const l=this.chat.context.get("theme.is-dark"),u=this.chat.context.get("chat.adjustment-mode"),C=this.chat.context.get("chat.adjustment-contrast"),g=this.colors,M=this.inverse_colors;let S=l,x=N.Color.RGBA.fromCSS(this.chat.context.get("theme.color.chat-background")||this.chat.context.get("theme.color.background"));x&&(S=x.toHSLA().l<.5),x=S?"#191919":"#E0E0E0";let k=!S,D=N.Color.RGBA.fromCSS(this.chat.context.get("theme.color.chat-text")||this.chat.context.get("theme.color.text"));D&&(k=D.toHSLA().l<.5),D=k?"#19171c":"#dad8de",g._base=x,g.mode=u,g.contrast=C,M._base=D,M.mode=u,M.contrast=C,this.chat_line.rerenderLines(),this.updateMentionCSS(),this.emit(":update-colors")}updateChatCSS(){this._update_css_waiter||(this._update_css_waiter=requestAnimationFrame(()=>this._updateChatCSS()))}_updateChatCSS(){cancelAnimationFrame(this._update_css_waiter),this._update_css_waiter=null;const l=this.chat.context.get("chat.effective-width"),u=this.chat.context.get("chat.actions.size"),C=this.chat.context.get("chat.actions.hover-size"),g=this.chat.context.get("chat.timestamp-size"),M=this.chat.context.get("chat.font-size"),S=this.chat.context.get("chat.lines.emote-alignment"),x=Math.round(20/12*M),k=Math.round(C*(2/3)),D=C-k;let O=this.chat.context.get("chat.font-family")||"inherit";const[K,X]=(0,E.jo)(O);O=K,this._font_unloader&&this._font_unloader(),this._font_unloader=X,O.indexOf(" ")!==-1&&O.indexOf(",")===-1&&O.indexOf('"')===-1&&O.indexOf("'")===-1&&(O=`"${O}"`),g?this.css_tweaks.set("ts-size",`.chat-line__timestamp{font-size:${g/10}rem}`):this.css_tweaks.delete("ts-size"),this.css_tweaks.setVariable("chat-actions-size",`${u/10}rem`),this.css_tweaks.setVariable("chat-actions-hover-size",`${k/10}rem`),this.css_tweaks.setVariable("chat-actions-hover-padding",`${D/20}rem`),this.css_tweaks.setVariable("chat-font-size",`${M/10}rem`),this.css_tweaks.setVariable("chat-line-height",`${x/10}rem`),this.css_tweaks.setVariable("chat-font-family",O),this.css_tweaks.setVariable("chat-width",`${l/10}rem`),this.css_tweaks.setVariable("negative-chat-width",`${-l/10}rem`),this.css_tweaks.toggle("chat-font",M!==13||O!=="inherit"),this.css_tweaks.toggle("chat-width",this.settings.get("chat.use-width")),this.css_tweaks.toggle("chat-fix--watch-party",this.settings.get("context.isWatchParty")),this.css_tweaks.toggle("emote-alignment-padded",S===1),this.css_tweaks.toggle("emote-alignment-baseline",S===2),this.emit(":update-chat-css"),this.emit("site.player:fix-player"),this.emit("site.layout:resize")}updateLineBorders(){const l=this.chat.context.get("chat.lines.borders");this.css_tweaks.toggle("chat-borders",l>0),this.css_tweaks.toggle("chat-borders-3d",l===2),this.css_tweaks.toggle("chat-borders-3d-inset",l===3),this.css_tweaks.toggle("chat-borders-wide",l===4)}updateMentionCSS(){const l=this.chat.context.get("chat.filtering.highlight-mentions");this.css_tweaks.toggle("chat-mention-token",this.chat.context.get("chat.filtering.highlight-tokens"));const u=this.chat.context.get("chat.filtering.mention-color");u?(this.css_tweaks.toggle("chat-mention-bg",!1),this.css_tweaks.toggle("chat-mention-bg-alt",!1),this.css_tweaks.toggle("chat-mention-bg-custom",!0),this.css_tweaks.setVariable("chat-mention-color",this.inverse_colors.process(u))):(this.css_tweaks.toggle("chat-mention-bg-custom",!1),this.css_tweaks.toggle("chat-mention-bg",l),this.css_tweaks.toggle("chat-mention-bg-alt",l&&this.chat.context.get("chat.lines.alternate")))}updatePointsInfo(l){const u=l?.pointIcon,C=l?.pointName;u?this.css_tweaks.set("points-icon",`.ffz--points-icon:before { display: none }
.ffz--points-icon:after {
	display: inline-block;
	margin: 0 0.5rem -0.6rem;
	background-image: url("${u.url}");
	background-image: ${_.WEBKIT_CSS}image-set(url("${u.url}") 1x, url("${u.url2x}") 2x, url("${u.url4x}") 4x);
}`):this.css_tweaks.delete("points-icon"),this.point_name=C||null}async grabTypes(){if(this.types_loaded)return;const l=await this.web_munch.findModule("chat-types"),u=await this.web_munch.findModule("callout-types");if(this.callout_types=u||re,this.automod_types=l?.automod||Ct,this.chat_types=l?.chat||It,this.message_types=l?.message||pt,this.mod_types=l?.mod||_t,!l)return;u&&this.chat.context.update("chat.filtering.blocked-callouts"),this.types_loaded=!0;const C=[];(0,y.shallow_object_equals)(this.callout_types,re)||C.push("CALLOUT_TYPES"),(0,y.shallow_object_equals)(this.automod_types,Ct)||C.push("AUTOMOD_TYPES"),(0,y.shallow_object_equals)(this.chat_types,It)||C.push("CHAT_TYPES"),(0,y.shallow_object_equals)(this.message_types,pt)||C.push("MESSAGE_TYPES"),(0,y.shallow_object_equals)(this.mod_types,_t)||C.push("MOD_TYPES"),C.length&&this.log.info("Chat Types have changed from static mappings for categories:",C.join(" "))}updateDisableHandling(){this.disable_handling=this.chat.context.get("chat.disable-handling")}onEnable(){this.on("site.web_munch:loaded",this.grabTypes),this.on("site.web_munch:loaded",this.defineClasses),this.grabTypes(),this.defineClasses(),this.chat.context.on("changed:chat.callouts.clip",this.updateCallouts,this),this.chat.context.on("changed:chat.filtering.blocked-callouts",this.updateCallouts,this),this.chat.context.on("changed:chat.points.show-callouts",this.updateCallouts,this),this.chat.context.on("changed:chat.points.show-button",()=>this.PointsButton.forceUpdate()),this.chat.context.on("changed:chat.points.show-rewards",()=>{this.PointsButton.forceUpdate(),this.PointsClaimButton.forceUpdate()}),this.chat.context.on("changed:chat.bits.show",()=>{this.PointsButton.forceUpdate()}),this.chat.context.on("changed:chat.banners.hype-train",this.cleanHighlights,this),this.chat.context.on("changed:chat.subs.gift-banner",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.polls",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.prediction",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.drops",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.pinned-message",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.hide-appleplus",this.cleanHighlights,this),this.chat.context.on("changed:chat.banners.shared-chat",this.cleanHighlights,this),this.chat.context.on("changed:chat.disable-handling",this.updateDisableHandling,this),this.chat.context.on("changed:chat.banners.charity",()=>{this.ChatContainer.forceUpdate()}),this.chat.context.on("changed:chat.subs.gift-banner",()=>this.GiftBanner.forceUpdate(),this),this.chat.context.on("changed:chat.effective-width",this.updateChatCSS,this),this.settings.main_context.on("changed:chat.use-width",this.updateChatCSS,this),this.chat.context.on("changed:chat.actions.size",this.updateChatCSS,this),this.chat.context.on("changed:chat.actions.hover-size",this.updateChatCSS,this),this.chat.context.on("changed:chat.font-size",this.updateChatCSS,this),this.chat.context.on("changed:chat.timestamp-size",this.updateChatCSS,this),this.chat.context.on("changed:chat.font-family",this.updateChatCSS,this),this.chat.context.on("changed:chat.lines.emote-alignment",this.updateChatCSS,this),this.chat.context.on("changed:chat.adjustment-mode",this.updateColors,this),this.chat.context.on("changed:chat.adjustment-contrast",this.updateColors,this),this.chat.context.on("changed:theme.is-dark",this.updateColors,this),this.chat.context.on("changed:theme.color.background",this.updateColors,this),this.chat.context.on("changed:theme.color.chat-background",this.updateColors,this),this.chat.context.on("changed:theme.color.text",this.updateColors,this),this.chat.context.on("changed:theme.color.chat-text",this.updateColors,this),this.chat.context.on("changed:chat.lines.borders",this.updateLineBorders,this),this.chat.context.on("changed:chat.filtering.highlight-mentions",this.updateMentionCSS,this),this.chat.context.on("changed:chat.filtering.highlight-tokens",this.updateMentionCSS,this),this.chat.context.on("changed:chat.filtering.mention-color",this.updateMentionCSS,this),this.chat.context.on("changed:chat.pin-resubs",u=>{u&&(this.updateInlineCallouts(),this.updatePinnedCallouts())},this),this.chat.context.on("changed:chat.community-chest.show",()=>{this.CommunityChestBanner.forceUpdate(),this.updateCallouts()},this),this.chat.context.getChanges("chat.emotes.2x",u=>{this.css_tweaks.toggle("big-emoji",u>1),this.toggleEmoteJail()}),this.chat.context.getChanges("chat.emotes.limit-size",()=>this.toggleEmoteJail()),this.chat.context.getChanges("chat.banners.last-events",u=>this.css_tweaks.toggleHide("last-x-events",!u)),this.chat.context.getChanges("chat.input.show-mod-view",u=>this.css_tweaks.toggleHide("ci-mod-view",!u)),this.chat.context.getChanges("chat.input.show-highlight",u=>this.css_tweaks.toggleHide("ci-highlight-settings",!u)),this.chat.context.getChanges("chat.input.show-shield",u=>this.css_tweaks.toggleHide("ci-shield-mode",!u)),this.chat.context.getChanges("chat.lines.padding",u=>this.css_tweaks.toggle("chat-padding",u)),this.chat.context.getChanges("chat.bits.show",u=>this.css_tweaks.toggle("hide-bits",!u)),this.chat.context.on("changed:chat.bits.show-pinned",()=>this.ChatLeaderboard.forceUpdate()),this.chat.context.getChanges("chat.filtering.deleted-style",u=>{this.css_tweaks.toggle("chat-deleted-strike",u===1||u===2),this.css_tweaks.toggle("chat-deleted-fade",u<2)}),this.chat.context.getChanges("chat.filtering.clickable-mentions",u=>this.css_tweaks.toggle("clickable-mentions",u)),this.chat.context.getChanges("chat.filtering.bold-mentions",u=>this.css_tweaks.toggle("chat-mention-no-bold",!u)),this.chat.context.getChanges("chat.hide-community-highlights",u=>this.css_tweaks.toggleHide("community-highlights",u)),this.chat.context.getChanges("chat.lines.alternate",u=>{this.css_tweaks.toggle("chat-rows",u),this.updateMentionCSS()}),this.chat.context.getChanges("chat.input.show-elevate-your-message",u=>this.css_tweaks.toggleHide("elevate-your-message",!u)),this.updateDisableHandling(),this.updateChatCSS(),this.updateColors(),this.updateLineBorders(),this.on("chat:get-messages-late",(u,C,g,M)=>{if(!u)return;const S=new Set(M.map(x=>x.message?.id));for(const x of this.ChatBuffer.instances){for(const k of x.buffer){const D=k?.id;!D||S.has(D)||!k.ffz_standardized||(S.add(D),M.push({message:k,_instance:null,update:()=>null}))}for(const k of x.delayedMessageBuffer){const D=k?.event,O=D?.id;!O||S.has(O)||!D.ffz_standardized||(S.add(O),M.push({message:D,_instance:null,update:()=>null}))}}}),this.on("chat:get-tab-commands",u=>{u.commands.push({name:"reconnect",description:"Force chat to reconnect.",permissionLevel:0,ffz_group:"FrankerFaceZ"})}),this.on("chat:pre-send-message",u=>{const C=u.message,g=u._inst;/^\/reconnect ?/i.test(C)&&(u.preventDefault(),g.client?.reconnect?(g.addMessage({type:l.chat_types.Notice,message:l.i18n.t("chat.reconnect","FFZ is forcing chat to reconnect...")}),g.client.reconnect()):g.addMessage({type:l.chat_types.Notice,message:l.i18n.t("chat.reconnect.unable","FFZ is unable to force chat to reconnect.")}))}),this.RaidController.on("mount",this.wrapRaidController,this),this.RaidController.on("update",this.noAutoRaids,this),this.RaidController.ready((u,C)=>{for(const g of C)this.wrapRaidController(g)}),this.InlineCallout.on("mount",this.onInlineCallout,this),this.InlineCallout.on("update",this.onInlineCallout,this),this.InlineCallout.ready(()=>this.updateInlineCallouts()),this.PinnedCallout.on("mount",this.onPinnedCallout,this),this.PinnedCallout.on("update",this.onPinnedCallout,this),this.PinnedCallout.ready(()=>this.updatePinnedCallouts());const l=this;this.PointsInfo.on("mount",this.updatePointsInfo,this),this.PointsInfo.on("update",this.updatePointsInfo,this),this.PointsInfo.on("unmount",()=>this.updatePointsInfo(null)),this.PointsInfo.ready(()=>this.updatePointsInfo(this.PointsInfo.first)),this.ChatLeaderboard.ready(u=>{const C=u.prototype.render;u.prototype.render=function(){return l.chat.context.get("chat.bits.show-pinned")?C.call(this):null},this.ChatLeaderboard.forceUpdate()}),this.GiftBanner.ready(u=>{const C=u.prototype.render;u.prototype.render=function(){return l.chat.context.get("chat.subs.gift-banner")?C.call(this):null},this.GiftBanner.forceUpdate()}),this.CommunityChestBanner.ready(u=>{const C=u.prototype.render;u.prototype.render=function(){try{if(!l.chat.context.get("chat.community-chest.show"))return null}catch(g){l.log.capture(g),l.log.error(g)}return C.call(this)},this.CommunityChestBanner.forceUpdate()}),this.PointsButton.ready(u=>{const C=u.prototype.render;u.prototype.render=function(){try{if(!l.chat.context.get("chat.points.show-button"))return null;const g=this.state.animationQueue,M=this.props.bitsEnabled;l.chat.context.get("chat.points.show-rewards")||(this.state.animationQueue=[]),l.chat.context.get("chat.bits.show")||(this.props.bitsEnabled=!1);const S=C.call(this);return this.state.animationQueue=g,this.props.bitsEnabled=M,S}catch(g){l.log.capture(g),l.log.error(g)}return C.call(this)},this.PointsButton.forceUpdate()}),this.PointsClaimButton.ready(u=>{u.prototype.ffzHasOffer=function(){return!this.props.hidden&&!this.state?.error&&this.getClaim()!=null};const C=u.prototype.render;u.prototype.render=function(){try{if(this.ffzHasOffer()&&!this._ffz_timer&&l.chat.context.get("chat.points.auto-rewards")&&(this._ffz_timer=setTimeout(()=>{this._ffz_timer=null,this.onClick&&this.ffzHasOffer()&&this.onClick()},1e3+Math.floor(Math.random()*5e3))),!l.chat.context.get("chat.points.show-rewards"))return null}catch(g){l.log.capture(g),l.log.error(g)}return C.call(this)},this.PointsClaimButton.forceUpdate()}),this.ChatController.on("mount",this.chatMounted,this),this.ChatController.on("unmount",this.chatUnmounted,this),this.ChatController.on("update",this.chatUpdated,this),this.ChatService.ready((u,C)=>{this.wrapChatService(u);for(const g of C){g.client.events.removeAll(),g._ffzInstall();const M=g.joinedChannel,S=g.client?.session?.channelstate?.[`#${M}`]?.roomState;S&&this.updateChatState(S),g.addEventListeners(),g.props.setChatConnectionAPI({sendMessage:g.sendMessage,_ffz_inst:g})}}),this.ChatBuffer.ready((u,C)=>{this.wrapChatBuffer(u);for(const g of C){const M=g.props.messageHandlerAPI;M&&M.removeMessageHandler(g.handleMessage),g._ffzInstall(),M&&M.addMessageHandler(g.handleMessage),g.props.setMessageBufferAPI({addUpdateHandler:g.addUpdateHandler,removeUpdateHandler:g.removeUpdateHandler,getUnreadCount:g.getUnreadCount,getMessages:g.getMessages,getMessagesForHighlight:g.getMessagesForHighlight,getMessagesForAllHighlights:g.getMessagesForAllHighlights,isPaused:g.isPaused,setPaused:g.setPaused,hasNewerLeft:g.hasNewerLeft,loadNewer:g.loadNewer,loadNewest:g.loadNewest,_ffz_inst:g})}}),this.ChatBufferConnector.on("mount",this.connectorMounted,this),this.ChatBufferConnector.on("update",this.connectorUpdated,this),this.ChatBufferConnector.on("unmount",this.connectorUnmounted,this),this.ChatBufferConnector.ready((u,C)=>{for(const g of C)this.connectorMounted(g)}),this.ChatController.ready((u,C)=>{const g=this,M=u.prototype.componentDidCatch,S=u.prototype.render;u.prototype.componentDidCatch=function(x,k){const D=this.state.ffz_errors||0;if(D<100&&(this.setState({ffz_errors:D+1}),g.log.info("Error within Chat",x,k,D)),M)return M.call(this,x,k)},u.prototype.render=function(){if(this.state.ffz_errors>0){const x=g.site.getReact(),k=x&&x.createElement;return k?k("div",{className:"tw-border-l tw-c-background-alt-2 tw-c-text-base tw-full-width tw-full-height tw-align-items-center tw-flex tw-flex-column tw-justify-content-center tw-relative"},"There was an error displaying chat."):null}return S.call(this)};for(const x of C)this.chatMounted(x)}),this.ChatRenderer.on("mount",this.rendererMounted,this),this.ChatRenderer.on("unmount",this.rendererUnmounted,this),this.ChatRenderer.on("update",this.rendererUpdated,this),this.ChatRenderer.ready((u,C)=>{for(const g of C)this.rendererMounted(g)}),this.ChatContainer.on("mount",this.containerMounted,this),this.ChatContainer.on("unmount",this.containerUnmounted,this),this.ChatContainer.on("update",this.containerUpdated,this),this.CalloutSelector.ready((u,C)=>{const g=this,M=u.prototype.render;u.prototype.render=function(){try{if(g.CalloutStackHandler){const S=g.site.getReact(),x=M.call(this),k=x?.props?.children;return Array.isArray(k)&&k.push(S.createElement(g.CalloutStackHandler)),x}}catch{}return M.call(this)};for(const S of C)S.forceUpdate()}),this.ChatContainer.ready((u,C)=>{const g=this,M=u.prototype.render,S=u.prototype.componentDidCatch;u.prototype.ffzRender=function(){if(g.chat.context.get("chat.banners.charity"))return M.call(this);const x=this.props.campaignData;this.props.campaignData=null;let k;try{k=M.call(this)}catch(D){throw this.props.campaignData=x,D}return this.props.campaignData=x,k},u.prototype.render=function(){try{if(g.CommunityStackHandler){const x=g.site.getReact(),k=this.ffzRender(),D=k?.props?.children?.props?.children;return x&&Array.isArray(D)&&D.push(x.createElement(g.CommunityStackHandler)),k}}catch{}return this.ffzRender()},u.prototype.componentDidCatch=function(x,k){const D=this.state.ffz_errors||0;if(D<100&&(this.setState({ffz_errors:D+1}),g.log.info("Error within Chat Container",x,k,D)),S)return S.call(this,x,k)};for(const x of C)this.containerMounted(x)}),this.subpump.on(":pubsub-message",u=>{if(u.prefix!=="community-points-channel-v1"||this.disable_handling)return;if(u.prefix==="pinned-chat-updates-v1"){this.log.debug("Pinned Chat",u);return}const C=this.ChatService.first,g=u.message,M=g?.data?.redemption;if(!g||!C||g.type!=="reward-redeemed"||C.props.channelID!=M?.channel_id||M.user_input)return;const S=M.reward?.id&&(0,y.get)(M.reward.id,C.props.rewardMap);if(S&&!this.chat.context.get("chat.filtering.blocked-types").has("ChannelPointsReward")){const x={id:M.id,type:this.chat_types.Message,ffz_type:"points",ffz_reward:S,ffz_reward_highlight:(0,a.ZH)(S),messageParts:[],user:{id:M.user.id,login:M.user.login,displayName:M.user.display_name},timestamp:new Date(g.data.timestamp||M.redeemed_at).getTime()};C.postMessageToCurrentChannel({},x)}})}shouldHideCallout(l){if(!l)return;l=Re[l]??l.replace(/_/g,"-");const u=this.callout_types??re,C=this.chat.context.get("chat.filtering.blocked-callouts");return!!(C&&C.has(l)||l===u.CommunityPointsRewards&&!this.chat.context.get("chat.points.show-callouts")||l===u.ClipLiveNudge&&!this.chat.context.get("chat.callouts.clip")||l==="prime_gift_bomb"&&!this.chat.context.get("chat.community-chest.show")||l==="megacheer_emote_recipient"&&!t.chat.context.get("chat.bits.show-rewards"))}updateCallouts(){this.updatePinnedCallouts(),this.updateInlineCallouts()}updatePinnedCallouts(){for(const l of this.PinnedCallout.instances)this.onPinnedCallout(l)}onPinnedCallout(l){const u=l.props,C=u?.event,g=C?.type;this.shouldHideCallout(g)&&(l.props.pinned?l.unpin():l.hide()),g==="share-resub"&&!u.pinned&&this.chat.context.get("chat.pin-resubs")&&!l._ffz_pinned&&(this.log.info("Automatically pinning re-sub notice."),l._ffz_pinned=!0,l.pin()),g==="drop"&&this.autoClickDrop(l)}updateInlineCallouts(){for(const l of this.InlineCallout.instances)this.onInlineCallout(l)}onInlineCallout(l){if(l.state.isHidden)return;const u=l.props?.event?.callout?.contextMenuProps,C=u?.event??l.props?.event,g=C?.type;if(this.shouldHideCallout(g)||this.shouldHideCallout(l.props?.event?.trackingType)){l.setState({isHidden:!0});return}if(g==="share-resub"&&this.chat.context.get("chat.pin-resubs")&&!l._ffz_pinned){const M=u?.onPin;M&&(this.log.info("Automatically pinning re-sub notice."),l._ffz_pinned=!0,l.hideOnContextMenuAction?l.hideOnContextMenuAction(M)():M())}g==="drop"&&this.autoClickDrop(l)}autoClickDrop(l){if((l.props?.event?.callout?.contextMenuProps?.event??l.props?.event)?.type!=="drop"||l._ffz_clicking||!this.chat.context.get("chat.drops.auto-rewards"))return;l._ffz_clicking=!0,this.resolve("site").awaitElement('button[data-a-target="chat-private-callout__primary-button"]',this.fine.getHostNode(l),1e4).then(M=>{l._ffz_clicking=!1,!((l.props?.event?.callout?.contextMenuProps?.event??l.props?.event)?.type!=="drop"||!this.chat.context.get("chat.drops.auto-rewards"))&&M.click()}).catch(()=>{l._ffz_clicking=!1})}wrapRaidController(l){if(l._ffz_wrapped)return this.noAutoRaids(l);l._ffz_wrapped=!0;const u=this,C=l.handleJoinRaid;l.handleJoinRaid=function(g,...M){const S=l.props&&l.props.raid&&l.props.raid.id;return g&&g.type&&S&&u.joined_raids.add(S),C.call(this,g,...M)},this.noAutoRaids(l)}noAutoRaids(l){l._ffz_no_raid||(l._ffz_no_raid=setTimeout(()=>{if(l._ffz_no_raid=null,l.props&&l.props.raid&&!l.isRaidCreator&&l.hasJoinedCurrentRaid){const u=l.props.raid.id;if(this.joined_raids.has(u))return;let C=this.settings.get("channel.raids.no-autojoin");if(!C){const g=this.settings.get("__filter:channel.raids.blocked-channels");if(g&&(l.props.raid.targetLogin&&g.test(l.props.raid.targetLogin)||l.props.raid.targetDisplayName&&g.test(l.props.raid.targetDisplayName))&&(C=!0),!C)return}this.log.info("Automatically leaving raid:",u),l.handleLeaveRaid()}}))}toggleEmoteJail(){const l=this.chat.context.get("chat.emotes.2x"),u=this.chat.context.get("chat.emotes.limit-size");this.css_tweaks.toggle("big-emote-jail",u&&!l),this.css_tweaks.toggle("bigger-emote-jail",u&&l)}cleanHighlights(){const l={community_sub_gift:this.chat.context.get("chat.subs.gift-banner"),megacheer:this.chat.context.get("chat.bits.show"),hype_train:this.chat.context.get("chat.banners.hype-train"),prediction:this.chat.context.get("chat.banners.prediction"),poll:this.chat.context.get("chat.banners.polls"),pinned_chat:this.chat.context.get("chat.banners.pinned-message"),"mw-drop-available":this.chat.context.get("chat.banners.drops"),shared_chat:this.chat.context.get("chat.banners.shared-chat")},u=this.community_stack?.highlights;if(Array.isArray(u))for(const C of u){if(!C||!C.event||!C.id)continue;const g=C.event.type;g&&(0,y.has)(l,g)&&!l[g]&&(this.log.info("Removing community highlight: ",g,"#",C.id),this.community_dispatch({type:"remove-highlight",id:C.id})),g==="mw-drop-available"&&C.event.detailsURL==="https://blog.twitch.tv/2024/07/26/sub-and-get-apple-tv/"&&this.chat.context.get("chat.banners.hide-appleplus")&&(this.log.info("Removing community highlight: ",g,"#",C.id),this.community_dispatch({type:"remove-highlight",id:C.id}))}}cleanCallouts(){const l=this.callout_stack;l?.pinnedCallout?.event?.type&&this.shouldHideCallout(l.pinnedCallout.event.type)&&l.unpinCallout(),l?.callouts?.[0]?.event?.type&&this.shouldHideCallout(l.callouts[0].event.type)&&l.clearCalloutType(l.callouts[0].event.type)}defineClasses(){if(this.CommunityStackHandler&&this.CalloutStackHandler)return!0;const l=this,u=this.site.getReact(),C=u?.createElement,g=this.web_munch.getModule("highlightstack"),M=this.web_munch.getModule("calloutstack");return C?(!this.CalloutStackHandler&&M&&(this.CalloutStackHandler=function(){const S=u.useContext(M.stack);return l.callout_stack=S,l.cleanCallouts(),null},this.CalloutSelector.forceUpdate()),!this.CommunityStackHandler&&g&&(this.CommunityStackHandler=function(){const S=u.useContext(g.stack),x=u.useContext(g.dispatch);return l.community_stack=S,l.community_dispatch=x,l.cleanHighlights(),null},this.ChatContainer.forceUpdate()),!0):!1}updateChatState(l){const u=this.chat.context.get("context.chat_state")||{};(0,y.deep_equals)(l,u)||(this.chat.context.updateContext({chat_state:l}),this.input.updateInput())}tryUpdateBadges(){this._badge_timer||(this._badge_timer=setTimeout(()=>this._tryUpdateBadges(),0))}_tryUpdateBadges(){this._badge_timer&&clearTimeout(this._badge_timer),this._badge_timer=null,this.log.info("Trying to update badge data from the chat container.");const l=this.ChatContainer.first;l&&this.containerUpdated(l,l.props)}wrapChatBuffer(l){if(l.prototype._ffz_was_here)return;const u=this,C=l.prototype.clear,g=l.prototype.flushRawMessages,M=l.prototype.componentDidMount;l.prototype._ffzInstall=function(){if(this._ffz_installed)return;this._ffz_installed=!0;const S=this,x=S.handleMessage,k=S.props.setMessageBufferAPI;S.props.setMessageBufferAPI=function(D){return D&&(D._ffz_inst=S),k(D)},S.handleMessage=function(D){if(D)try{const O=u.chat_types||{},K=u.mod_types||{};if(u.chat.context.get("chat.filtering.blocked-types").has(O[D.type])||D.type===O.ChannelPointsReward&&!(0,a.zZ)(D.reward)||D.type===O.RewardGift&&!u.chat.context.get("chat.bits.show-rewards"))return;if(D.type===O.Message){const Q=u.chat.standardizeMessage(D),P=S._ffz_connector??S.ffzGetConnector();let B=Q.roomID=Q.roomID?Q.roomID:P?.props?.channelID,G=Q.roomLogin=Q.roomLogin?Q.roomLogin:Q.channel?Q.channel.slice(1):P?.props?.channelLogin;if(!G&&B){const ot=u.chat.getRoom(B,null,!0);ot&&ot.login&&(G=Q.roomLogin=ot.login)}if(!B&&G){const ot=u.chat.getRoom(null,G,!0);ot&&ot.id&&(B=Q.roomID=ot.id)}const J=u.site.getUser();if(J&&P&&(J.moderator=P.props.isCurrentUserModerator,J.staff=P.props.isStaff),Q.ffz_tokens=Q.ffz_tokens||u.chat.tokenizeMessage(Q,J,!0),Q.ffz_removed)return;if(u.hasListeners("chat:receive-message")){const ot=u.makeEvent({message:Q,inst:S,channel:G,channelID:B});if(u.emit("chat:receive-message",ot),ot.defaultPrevented||Q.ffz_removed)return}}else if(D.type===O.Moderation){if(u.emit("chat:mod-user",D.moderationType,D.userLogin,D.targetMessageID,D),!S.props.isCurrentUserModerator){const Q=D.moderationType,P=D.userLogin;let B;if(Q===K.Ban?B="ban":Q===K.Timeout?B="timeout":Q===K.Delete&&(B="delete"),B&&(D.moderationActionType=B),!S.moderatedUsers.has(P)&&Q!==K.Delete){S.moderateBuffers([S.buffer,S.delayedMessageBuffer.map(G=>G.event)],P,D),S.delayedMessageBuffer.push({event:D,time:Date.now(),shouldDelay:!1});return}}}else D.type===O.Clear&&(u.chat.context.get("chat.filtering.ignore-clear")?D={type:O.Info,message:u.i18n.t("chat.ignore-clear","An attempt by a moderator to clear chat was ignored.")}:u.emit("chat:clear-chat",D))}catch(O){u.log.error("Error processing chat event.",O),u.log.capture(O,{extra:{msg:D}})}return x.call(S,D)},S.setPaused=function(D){S.paused!==D&&(S.paused=D,D||(S.slidingWindowEnd=Math.min(S.buffer.length,u.chat.context.get("chat.scrollback-length")),S.props.isBackground||S.notifySubscribers()))},S.loadNewer=function(){if(!S.hasNewerLeft())return;const D=Math.min(S.buffer.length,S.slidingWindowEnd+40),O=Math.max(0,D-u.chat.context.get("chat.scrollback-length"));S.clear(S.buffer.length-O),S.slidingWindowEnd=D-O,S.props.isBackground||S.notifySubscribers()},S.loadNewest=function(){if(!S.hasNewerLeft())return;const D=u.chat.context.get("chat.scrollback-length");S.clear(D),S.slidingWindowEnd=Math.min(D,S.buffer.length),S.props.isBackground||S.notifySubscribers()},S.getMessages=function(){return S.buffer.slice(0,S.slidingWindowEnd+(S.ffz_extra||0))}},l.prototype.componentDidMount=function(){try{this._ffzInstall()}catch(S){u.log.error("Error installing FFZ features onto chat buffer.",S)}return M.call(this)},l.prototype.clear=function(S){try{S==null&&(S=0);const x=u.chat.context.get("chat.scrollback-length");if(!this.isPaused()&&S>x&&(S=x),S<=0)this.ffz_extra=0,this.buffer=[],this.delayedMessageBuffer=[],this.paused=!1;else{const k=this.buffer,D=u.chat_types||It,O=k.length-S;if(O>0){let K=0,X;for(let Q=0;Q<O;Q++)k[Q]&&!oe.includes(D[k[Q].type])&&(K++,X=Q);this.buffer=k.slice(K%2!==0?Math.max(O-4,X):O),this.ffz_extra=k.length-S}else this.ffz_extra=0,this.buffer=this.buffer.slice(0);this.paused&&this.buffer.length>=900&&this.setPaused(!1)}}catch(x){return u.log.error("Error running clear",x),C.call(this,S)}},l.prototype.ffzGetConnector=function(){if(this._ffz_connector)return this._ffz_connector;const S=Date.now();if(S-(this._ffz_connect_tried||0)>5e3){this._ffz_connect_tried=S;const x=u.ChatBufferConnector.first;if(x?.props?.messageBufferAPI?._ffz_inst===this)return this._ffz_connector=x}},l.prototype.flushRawMessages=function(){try{const S=[],x=u.chat_types||It,k=Date.now(),D=u.chat.context.get("chat.delay"),O=D===-1?this.delayDuration:D,K=k-O,X=this.shouldSeeBlockedAndDeletedMessages||this.props&&this.props.shouldSeeBlockedAndDeletedMessages,Q=this.hasNewerLeft(),P=this.isPaused(),B=u.chat.context.get("chat.scrollback-length"),G=u.chat.context.get("chat.filtering.remove-deleted"),J=u.hasListeners("chat:buffer-message");let ot=0,ct=this.slidingWindowEnd,gt=!1,U;for(const V of this.delayedMessageBuffer)if(V.time<=K||!V.shouldDelay){if(G!==0&&(G>1||!X)&&this.isDeletable(V.event)&&V.event.deleted)continue;if(J){if(U)U._reset();else{U=u.makeEvent({inst:this,channel:void 0,channelID:void 0,message:void 0});const yt=this._ffz_connector??this.ffzGetConnector(),xt=yt&&yt.props.channelID;if(U.channelID=xt,xt){const Ut=u.chat.getRoom(xt,null,!0);Ut&&Ut.login&&(U.channel=Ut.login)}}if(U.message=V.event,u.emit("chat:buffer-message",U),U.defaultPrevented||V.event.ffz_removed)continue}const et=this.buffer[this.buffer.length-1],dt=et?.type;!this.props.isLoadingHistoricalMessages&&!this.props.historicalMessages||dt!==x.Connected||V.event.type===x.Connected||this.buffer.find(yt=>yt.type===x.LiveMessageSeparator)||this.buffer.push({type:x.LiveMessageSeparator,id:"live-message-separator"}),this.buffer.push(V.event),gt=!0,this.paused||(this.buffer.length>B?ot++:ct++)}else S.push(V);this.delayedMessageBuffer=S,gt&&(this.clear(Math.min(900,this.buffer.length-ot)),ot===0&&ct===this.slidingWindowEnd&&Q===this.hasNewerLeft()&&P===this.isPaused()||(this.slidingWindowEnd=ct,this.props.isBackground||this.notifySubscribers())),this.flushHighlightsBuffer&&this.flushHighlightsBuffer()}catch(S){return u.log.error("Error running flush.",S),g.call(this)}}}addNotice(l,u){if(!l)return!1;l.startsWith("#")&&(l=l.slice(1)),l=l.toLowerCase();for(const C of this.ChatService.instances)if(l==="*"||C.props.channelLogin.toLowerCase()===l){if(typeof u=="string")C.addMessage({type:(this.chat_types??It).Notice,message:u});else{const g=C.props,M=g.channelLogin,S=g.channelID;u.markdown&&((0,A.e)()||(0,A.Z)()),C.addMessage({type:(this.chat_types??It).Message,channel:`#${M}`,roomID:S,roomLogin:M,id:`ffz_notice_${(0,y.generateUUID)()}`,ffz_type:"notice",ffz_no_actions:!0,ffz_data:u,message:null,messageParts:[],timestamp:Date.now(),user:{userID:S,userLogin:M}})}return!0}return!1}sendMessage(l,u){const C=this.ChatService.first;if(!C||!l)return null;if(l.startsWith("#")&&(l=l.slice(1)),l.toLowerCase()!==C.props.channelLogin.toLowerCase())return C.client.sendCommand(l,u);C.sendMessage(u)}scheduleMystery(l){l.line&&(l._timer||(l._timer=setTimeout(()=>requestAnimationFrame(()=>{l._timer=null,l.line&&l.line.forceUpdate()}),250)))}wrapChatService(l){const u=this,C=l.prototype.componentDidMount,g=l.prototype.addEventListeners;l.prototype._ffz_was_here=!0,l.prototype._ffzInstall=function(){if(this._ffz_installed)return;this._ffz_installed=!0;const M=this,S=this.sendMessage,x=$((...D)=>M.addMessage(...D),"addMessage"),k=$((D,O)=>M.sendMessage(D,O),"sendMessage");M.sendMessage=function(D,O){if(D=D.replace(/\s+/g," "),D.startsWith("/ffz:")){D=D.slice(5).trim();const X=D.indexOf(" ");let Q;X===-1?(Q=D,D=""):(Q=D.slice(0,X),D=D.slice(X+1).trimStart());const P=u.makeEvent({command:Q,message:D,extra:O,context:u.chat.context,channel:M.props.channelLogin,_inst:M,addMessage:x,sendMessage:k}),B=`chat:ffz-command:${Q}`;return u.listeners(B)?.length>0?u.emit(B,P):M.addMessage({type:u.chat_types.Notice,message:u.i18n.t("chat.ffz-command.invalid","No such command: /ffz:{subcmd}",{subcmd:Q})}),!1}const K=u.makeEvent({message:D,extra:O,context:u.chat.context,channel:M.props.channelLogin,_inst:M,addMessage:x,sendMessage:k});if(u.emit("chat:pre-send-message",K),!K.defaultPrevented)return S.call(this,K.message,K.extra)}},l.prototype.componentDidMount=function(){try{this._ffzInstall()}catch(M){u.log.error("Error installing FFZ features onto chat service.",M)}return C.call(this)},l.prototype.addEventListeners=function(...M){if(!this._ffz_init){const S=this;for(const U of De){const V=this[U];V&&(this[U]=function(et,dt){S._wrapped=et;const yt=V.call(S,et,dt);return S._wrapped=null,yt})}const x=this.onAnnouncementEvent;this.onAnnouncementEvent=function(U){return x.call(this,U)};const k=this.onSubscriptionEvent;this.onSubscriptionEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("Subscription"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return k.call(S,U);if(u.chat.context.get("chat.subs.show")<3)return;U.body="";const V=S.convertMessage({message:U});return V.ffz_type="resub",V.gift_theme=U.giftTheme,V.sharedChat=U.sharedChat,V.sub_goal=S.getGoalData?S.getGoalData(U.goalData):null,V.sub_plan=U.methods,V.sub_multi=U.multiMonthData?.multiMonthDuration?{count:U.multiMonthData.multiMonthDuration,tenure:U.multiMonthData.multiMonthTenure}:null,S.postMessageToCurrentChannel(U,V)}catch(V){return u.log.capture(V,{extra:U}),k.call(S,U)}};const D=this.onRoomStateEvent;this.onRoomStateEvent=function(U){try{const V=U.channel,et=u.chat.context.get("context.channel");V&&(V===et||V===`#${et}`)&&u.updateChatState(U.state)}catch(V){u.log.capture(V,{extra:U})}return D.call(S,U)};const O=this.onPinnedChatEvent;this.onPinnedChatEvent=function(U){try{const V=u.chat.context.get("chat.hype.message-style");if(V!==1){if(U.isSystemMessage&&V===0)return;const et=S.convertMessage(U);return et.ffz_type="hype",et.sharedChat=U.sharedChat,et.hype_amount=U.amount,et.hype_canonical_amount=U.canonical_amount,et.hype_currency=U.currency,et.hype_exponent=U.exponent,et.hype_level=U.level,U.isSystemMessage&&(et.message="",et.messageBody="",et.messageParts=[],U.message.body=""),S.postMessageToCurrentChannel(U,et)}}catch(V){u.log.capture(V,{extra:U})}return O.call(S,U)};const K=this.onResubscriptionEvent;this.onResubscriptionEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("Resubscription"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return K.call(S,U);if(u.chat.context.get("chat.subs.show")<2&&!U.body)return;const V=S.convertMessage({message:U});return V.ffz_type="resub",V.sharedChat=U.sharedChat,V.gift_theme=U.giftTheme,V.sub_goal=S.getGoalData?S.getGoalData(U.goalData):null,V.sub_cumulative=U.cumulativeMonths||0,V.sub_streak=U.streakMonths||0,V.sub_share_streak=U.shouldShareStreakTenure,V.sub_months=U.months,V.sub_plan=U.methods,V.sub_multi=U.multiMonthData?.multiMonthDuration?{count:U.multiMonthData.multiMonthDuration,tenure:U.multiMonthData.multiMonthTenure}:null,S.postMessageToCurrentChannel(U,V)}catch(V){return u.log.capture(V,{extra:U}),K.call(S,U)}};const X=this.ffz_mysteries={},Q=this.onSubscriptionGiftEvent;this.onSubscriptionGiftEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("SubGift"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return Q.call(S,U);const V=`${U.channel}:${U.user.userID}`,et=X[V];if(et)if(et.expires<Date.now())X[V]=null;else{et.recipients.push({id:U.recipientID,login:U.recipientLogin,displayName:U.recipientName}),et.recipients.length>=et.size&&(X[V]=null),et.line&&u.scheduleMystery(et);return}U.body="";const dt=S.convertMessage({message:U});return dt.ffz_type="sub_gift",dt.sharedChat=U.sharedChat,dt.sub_recipient={id:U.recipientID,login:U.recipientLogin,displayName:U.recipientName},dt.gift_theme=U.giftTheme,dt.sub_goal=S.getGoalData?S.getGoalData(U.goalData):null,dt.sub_months=U.giftMonths,dt.sub_plan=U.methods,dt.sub_total=U.senderCount,S.postMessageToCurrentChannel(U,dt)}catch(V){return u.log.capture(V,{extra:U}),Q.call(S,U)}};const P=this.onCommunityIntroductionEvent;this.onCommunityIntroductionEvent=function(U){try{if(u.disable_handling)return P.call(this,U);if(u.chat.context.get("chat.filtering.blocked-types").has("CommunityIntroduction")){const V=S.convertMessage(U);return V.sharedChat=U.sharedChat,S.postMessageToCurrentChannel(U,V)}}catch(V){u.log.capture(V,{extra:U}),u.log.error(V)}return P.call(this,U)};const B=this.onAnonSubscriptionGiftEvent;this.onAnonSubscriptionGiftEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("AnonSubGift"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return B.call(S,U);const V=`${U.channel}:ANON`,et=X[V];if(et)if(et.expires<Date.now())X[V]=null;else{et.recipients.push({id:U.recipientID,login:U.recipientLogin,displayName:U.recipientName}),et.recipients.length>=et.size&&(X[V]=null),et.line&&u.scheduleMystery(et);return}U.body="";const dt=S.convertMessage({message:U});return dt.ffz_type="sub_gift",dt.sharedChat=U.sharedChat,dt.gift_theme=U.giftTheme,dt.sub_goal=S.getGoalData?S.getGoalData(U.goalData):null,dt.sub_anon=!0,dt.sub_recipient={id:U.recipientID,login:U.recipientLogin,displayName:U.recipientName},dt.sub_months=U.giftMonths,dt.sub_plan=U.methods,dt.sub_total=U.senderCount,S.postMessageToCurrentChannel(U,dt)}catch(V){return u.log.capture(V,{extra:U}),B.call(S,U)}};const G=this.onSubscriptionMysteryGiftEvent;this.onSubscriptionMysteryGiftEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("SubMysteryGift"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return G.call(S,U);let V=null;if(U.massGiftCount>u.chat.context.get("chat.subs.merge-gifts")){const dt=`${U.channel}:${U.user.userID}`;V=X[dt]={recipients:[],size:U.massGiftCount,expires:Date.now()+3e4}}U.body="";const et=S.convertMessage({message:U});return et.ffz_type="sub_mystery",et.sharedChat=U.sharedChat,et.gift_theme=U.giftTheme,et.sub_goal=S.getGoalData?S.getGoalData(U.goalData):null,et.mystery=V,et.sub_plan=U.plan,et.sub_count=U.massGiftCount,et.sub_total=U.senderCount,S.postMessageToCurrentChannel(U,et)}catch(V){return u.log.capture(V,{extra:U}),G.call(S,U)}};const J=this.onAnonSubscriptionMysteryGiftEvent;this.onAnonSubscriptionMysteryGiftEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("AnonSubMysteryGift"))return;if(u.disable_handling||u.chat.context.get("chat.subs.native"))return J.call(S,U);let V=null;if(U.massGiftCount>u.chat.context.get("chat.subs.merge-gifts")){const dt=`${U.channel}:ANON`;V=X[dt]={recipients:[],size:U.massGiftCount,expires:Date.now()+3e4}}U.body="";const et=S.convertMessage({message:U});return et.ffz_type="sub_mystery",et.sharedChat=U.sharedChat,et.sub_anon=!0,et.mystery=V,et.sub_plan=U.plan,et.sub_count=U.massGiftCount,et.sub_total=U.senderCount,S.postMessageToCurrentChannel(U,et)}catch(V){return u.log.capture(V,{extra:U}),J.call(S,U)}};const ot=this.onRitualEvent;this.onRitualEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("Ritual"))return;if(u.disable_handling)return ot.call(S,U);const V=S.convertMessage(U);return V.sharedChat=U.sharedChat,V.ffz_type="ritual",V.ritual=U.type,S.postMessageToCurrentChannel(U,V)}catch(V){return u.log.capture(V,{extra:U}),ot.call(S,U)}};const ct=this.onChannelPointsRewardEvent;this.onChannelPointsRewardEvent=function(U){try{if(u.chat.context.get("chat.filtering.blocked-types").has("ChannelPointsReward"))return;if(u.disable_handling)return ct.call(S,U);const V=U.rewardID&&(0,y.get)(U.rewardID,S.props.rewardMap);if(V){const et=S.convertMessage(U);return u.chat.context.get("chat.powerup.effects")&&(0,a.zZ)(V)&&U.animationID?S.postMessageToCurrentChannel(U,{type:u.chat_types.ChannelPointsReward,id:et.id,displayName:et.user.userDisplayName,login:et.user.userLogin,reward:V,message:et,userID:et.user.userID,animationID:U.animationID,sharedChat:U.sharedChat}):(et.ffz_animation_id=U.animationID,et.sharedChat=U.sharedChat,et.ffz_type="points",et.ffz_reward=V,et.ffz_reward_highlight=(0,a.ZH)(V),S.postMessageToCurrentChannel(U,et))}}catch(V){u.log.error(V),u.log.capture(V,{extra:U})}return ct.call(S,U)};const gt=this.addMessage;this.addMessage=function(U){const V=S._wrapped;return V&&!U._ffz_checked?S.postMessageToCurrentChannel(V,U):gt.call(S,U)},this._ffz_init=!0}return g.apply(this,...M)},l.prototype.postMessageToCurrentChannel=function(M,S){const x=S;if(S._ffz_checked=!0,(S.type===u.chat_types.ChannelPointsReward||S.type===u.chat_types.CommunityIntroduction||S.message?.user&S.message?.badgeDynamicData)&&(S=S.message),M.channel){let k=S.channel=M.channel.toLowerCase();if(k.startsWith("#")&&(k=k.slice(1)),k!==this.props.channelLogin.toLowerCase())return;S.roomLogin=k}if(S.ffz_first_msg=S.isFirstMsg||M.message?.isFirstMsg||!1,S.ffz_returning=M.message?.isReturningChatter||!1,M.message){const k=M.message.user,D=M.message.flags;if(k&&(S.emotes=k.emotes),D&&this.getFilterFlagOptions){const O=this.props.isCurrentUserModerator&&u.chat.context.get("chat.automod.run-as-mod");O&&(this.props.isCurrentUserModerator=!1),S.flags=this.getFilterFlagOptions(D),O&&(this.props.isCurrentUserModerator=!0)}(!S.message||typeof S.message=="string")&&(typeof M.action=="string"?S.message=M.action:S.message=M.message.body)}this.addMessage(x)}}addRoom(l,u){if(u||(u=l.props),!u.channelID)return null;const C=l._ffz_room=this.chat.getRoom(u.channelID,u.channelLogin&&u.channelLogin.toLowerCase(),!1,!0);return C.ref(l),C}removeRoom(l){l._ffz_room&&(l._ffz_room.unref(l),l._ffz_room=null)}chatMounted(l,u){l.chatBuffer&&(l.chatBuffer.ffzController=l),u||(u=l.props),this.addRoom(l,u)&&(this.updateRoomBitsConfig(l,u.bitsConfig),this.settings.updateContext({moderator:u.isCurrentUserModerator,chatHidden:u.isHidden}),(u.isEmbedded||u.isPopout)&&this.settings.updateContext({channel:u.channelLogin&&u.channelLogin.toLowerCase(),channelID:u.channelID}),this.chat.context.updateContext({moderator:u.isCurrentUserModerator,channel:u.channelLogin&&u.channelLogin.toLowerCase(),channelID:u.channelID}))}chatUnmounted(l){l.chatBuffer&&l.chatBuffer.ffzController===this&&(l.chatBuffer.ffzController=null),(l.props.isEmbedded||l.props.isPopout)&&this.settings.updateContext({channel:null,channelID:null}),this.settings.updateContext({moderator:!1,chatHidden:!1}),this.chat.context.updateContext({moderator:!1,channel:null,channelID:null}),this.removeRoom(l)}chatUpdated(l,u){if(l.chatBuffer&&(l.chatBuffer.ffzController=l),!l._ffz_room||u.channelID!=l._ffz_room.id){this.removeRoom(l),l._ffz_mounted&&this.chatMounted(l);return}u.bitsConfig!==l.props.bitsConfig&&this.updateRoomBitsConfig(l,l.props.bitsConfig);let C=l.props.channelLogin;C&&(C=C.toLowerCase()),(l.props.isEmbedded||l.props.isPopout)&&this.settings.updateContext({channel:C,channelID:l.props.channelID}),this.settings.updateContext({moderator:l.props.isCurrentUserModerator,chatHidden:l.props.isHidden}),this.chat.context.updateContext({moderator:l.props.isCurrentUserModerator,channel:C,channelID:l.props.channelID})}updateRoomBitsConfig(l,u){const C=l._ffz_room;if(!C)return;let g=null;if(u&&Array.isArray(u.orderedActions)){g=new Set;for(const M of u.orderedActions)M&&M.prefix&&g.add(M.prefix)}!this._ffz_old_bits&&!g||(0,y.set_equals)(this._ffz_old_bits,g)||(this._ffz_old_bits=g,C.updateBitsConfig(xe(u)),this.chat_line.updateLineTokens())}connectorMounted(l){const u=l.props.messageBufferAPI;u&&u._ffz_inst&&u._ffz_inst._ffz_connector!==l&&(u._ffz_inst._ffz_connector=l)}connectorUpdated(l,u){const C=u.messageBufferAPI,g=l.props.messageBufferAPI;C!==g&&(C&&C._ffz_inst&&C._ffz_inst._ffz_connector===l&&(C._ffz_inst._ffz_connector=null),g&&g._ffz_inst&&g._ffz_inst._ffz_connector!==l&&(C._ffz_inst._ffz_connector=l))}connectorUnmounted(l){const u=l.props.messageBufferAPI;u&&u._ffz_inst&&u._ffz_inst._ffz_connector===l&&(u._ffz_inst._ffz_connector=null)}rendererMounted(l,u){u||(u=l.props),this.updateRendererSharedChats(l,u?.sharedChatDataByChannelID)}updateRendererSharedChats(l,u){if(u??(u=l.props.sharedChatDataByChannelID),l._ffz_cached_shared===u)return;this.shared_room_data=l._ffz_cached_shared=u,this.shared_rooms=l._ffz_shared_rooms=l._ffz_shared_rooms||{};const C=new Set(Object.keys(l._ffz_shared_rooms));let g=!1;if(u!=null)for(const[S,x]of u.entries()){C.delete(S);let k=l._ffz_shared_rooms[S];k||(k=this.chat.getRoom(S,x.login),k.ref(l),l._ffz_shared_rooms[S]=k);const D=x.badges?.channelsBySet;let O=0;if(D)for(const K of D.values())for(const X of K.values())O++;k.badgeCount()!==O&&(g=!0,k.updateBadges(D))}for(const S of C){const x=l._ffz_shared_rooms[S];x&&x.unref(l),x.unshareChat(),delete l._ffz_shared_rooms[S]}const M=Object.keys(l._ffz_shared_rooms);for(const S of Object.values(l._ffz_shared_rooms))S.shareChats(M);M.length>0&&this.settings.provider.get("shared-chat-notice")!==1&&(this.settings.provider.set("shared-chat-notice",1),this.addNotice("*",{icon:"ffz-i-zreknarf",message:this.i18n.t("chat.shared-chat.welcome","FrankerFaceZ: This is a Shared Chat, a new feature from Twitch to combine multiple stream chats into one. FrankerFaceZ support is early, so some messages might not look correct. Sorry for any trouble!")})),g&&this.chat_line.updateLineBadges()}rendererUnmounted(l){if(l._ffz_shared_rooms)for(const u of Object.values(l._ffz_shared_rooms))u.unref(l);l._ffz_shared_rooms=null,l._ffz_cached_shared=null,this.shared_room_data=new Map,this.shared_rooms={}}rendererUpdated(l,u){this.updateRendererSharedChats(l,u?.sharedChatDataByChannelID)}get shouldUpdateChannel(){const l=this.router.current_name;return v.Z.POPOUT_ROUTES.includes(l)||v.Z.SUNLIGHT_ROUTES.includes(l)}containerMounted(l,u){if(u||(u=l.props),!!this.addRoom(l,u)&&(this.updateRoomBitsConfig(l,u.bitsConfig),u.globalBadgeData?.badges?this.chat.badges.updateTwitchBadges(u.globalBadgeData.badges):u.data?.badges&&this.chat.badges.updateTwitchBadges(u.data.badges),u.data)){if(this.shouldUpdateChannel){const C=u.data.user?.primaryColorHex;this.resolve("site.channel").updateChannelColor(C),this.settings.updateContext({channel:u.channelLogin,channelID:u.channelID,channelColor:C})}this.updateRoomBadges(l,u.data.user&&u.data.user.broadcastBadges),this.updateRoomRules(l,u.chatRules)}}containerUnmounted(l){this.shouldUpdateChannel&&(this.resolve("site.channel").updateChannelColor(),this.settings.updateContext({channel:null,channelID:null,channelColor:null})),this.removeRoom(l)}containerUpdated(l,u){if(!l._ffz_room||u.channelID!=l._ffz_room.id){this.removeRoom(l),l._ffz_mounted&&this.containerMounted(l,u);return}if(u.bitsConfig!==l.props.bitsConfig&&this.updateRoomBitsConfig(l,u.bitsConfig),u.data&&v.Z.POPOUT_ROUTES.includes(this.router.current_name)){const x=u.data.user?.primaryColorHex;this.resolve("site.channel").updateChannelColor(x),this.settings.updateContext({channel:u.channelLogin,channelID:u.channelID,channelColor:x})}const C=u.data?.user?.broadcastBadges??[],g=l.props.data?.user?.broadcastBadges??[],M=u.globalBadgeData?.badges??[],S=l.props.globalBadgeData?.badges??[];(this.chat.badges.getTwitchBadgeCount()!==M.length||M.length!==S.length)&&this.chat.badges.updateTwitchBadges(M),(l._ffz_room.badgeCount()!==C.length||C.length!==g.length)&&this.updateRoomBadges(l,C),this.updateRoomRules(l,u.chatRules)}hasRoomBadges(l){const u=l._ffz_room;return u?u.hasBadges():!1}updateRoomBadges(l,u){const C=l._ffz_room;C&&(C.updateBadges(u),this.chat_line.updateLineBadges())}updateRoomRules(l,u){const C=l._ffz_room;C&&(C.rules=u)}};$(ve,"ChatHook");let de=ve;function xe(Mt){if(!Mt)return;const l={},u=Mt.indexedActions,C={};if(Array.isArray(Mt.tiers))for(const g of Mt.tiers)C[g.bits]=g.color;for(const g in u)if((0,y.has)(u,g)){const M=u[g],S=l[g]={id:M.id,prefix:M.prefix,tiers:[]};if(Mt?.getImage)for(const x of M.orderedTiers){const k={};for(const D of["light","dark"]){const O=k[D]=k[D]||{},K=O.static=O.static||{},X=O.animated=O.animated||{};for(const Q of[1,2,4])K[Q]=Mt.getImage(M.prefix,D,"static",x.bits,Q,"png"),X[Q]=Mt.getImage(M.prefix,D,"animated",x.bits,Q,"gif")}S.tiers.push({amount:x.bits,color:x.color||C[x.bits]||"inherit",id:x.id,images:k})}else if(M.orderedTiers[0]?.images)for(const x of M.orderedTiers){const k={};for(const D of x.images){const O=k[D.theme]=k[D.theme]||[],K=D.isAnimated?"animated":"static",X=O[K]=O[K]||{};X[D.dpiScale]=D.url}S.tiers.push({amount:x.bits,color:x.color||C[x.bits]||"inherit",id:x.id,images:k})}}return l}$(xe,"formatBitsConfig")},44615:(q,T,f)=>{"use strict";f.d(T,{KC:()=>N,ZH:()=>E,_x:()=>A,at:()=>v,yg:()=>n,zZ:()=>b});function N(s){return s.pricingType==="BITS"}$(N,"doesRewardCostBits");function y(s){return s?.__typename==="CommunityPointsAutomaticReward"}$(y,"isAutomaticReward");function _(s){return s?.__typename==="CommunityPointsCustomReward"}$(_,"isCustomReward");function E(s){return y(s)&&s.type==="SEND_HIGHLIGHTED_MESSAGE"}$(E,"isHighlightedReward");function A(s){return s&&(s.title?.includes?.("FFZ:GE")||s.prompt?.includes?.("FFZ:GE"))}$(A,"isGiantEmoteReward");function b(s){return s?.type==="SEND_ANIMATED_MESSAGE"}$(b,"isMessageEffect");function v(s){const i=N(s);return y(s)?i?s.bitsCost||s.defaultBitsCost:s.cost||s.defaultCost:i?s.bitsCost:s.cost}$(v,"getRewardCost");function r(s){return y(s)?s.backgroundColor||s.defaultBackgroundColor:s.backgroundColor}$(r,"getRewardColor");function n(s,i){if(_(s))return s.title;switch(s.type){case"SEND_ANIMATED_MESSAGE":return i.t("chat.points.animated","Message Effects");case"SEND_HIGHLIGHTED_MESSAGE":return i.t("chat.points.highlighted","Highlight My Message");case"SINGLE_MESSAGE_BYPASS_SUB_MODE":return i.t("chat.points.bypass-sub","Send a Message in Sub-Only Mode");case"CHOSEN_SUB_EMOTE_UNLOCK":return i.t("chat.points.choose-emote","Choose an Emote to Unlock");case"RANDOM_SUB_EMOTE_UNLOCK":return i.t("chat.points.random-emote","Unlock a Random Sub Emote");case"CHOSEN_MODIFIED_SUB_EMOTE_UNLOCK":return i.t("chat.points.modify-emote","Modify a Single Emote");default:return i.t("chat.points.reward","Reward")}}$(n,"getRewardTitle")},6325:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>_});var N=f(22527),y=f(46949);const E=class E extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...b){super(...b),this.should_enable=!0,this.inject("settings"),this.inject("site.chat"),this.inject("chat.emotes")}onEnable(){this.hookEmoteMenu()}async hookEmoteMenu(){const b=await this.findEmoteMenu();if(!b)return this.log.info("Emote Menu for Twitch was not found after 60 seconds.");b.registerEmoteGetter("FrankerFaceZ",()=>{const v=this.chat.ChatContainer.first,r=v&&v.props;if(!r)return;const n=this.emotes.getSets(r.userID,r.currentUserLogin,r.channelID,r.channelLogin),s=this.resolve("chat"),i=(s?.context||this.settings)?.get?.("chat.emotes.animated")>0,e=[];for(const o of n)if(!(!o||!o.emotes)){for(const a in o.emotes)if((0,y.has)(o.emotes,a)){const c=o.emotes[a];if(c.hidden)continue;e.push({text:c.name,url:i&&c.animated?.[1]||c.urls[1],channel:`${o.source||"FrankerFaceZ"} ${o.title}`,badge:o.icon||"//cdn.frankerfacez.com/script/devicon.png"})}}return e})}async findEmoteMenu(b=0){return window.emoteMenu&&emoteMenu.registerEmoteGetter?emoteMenu:b>=6e4?null:(await(0,y.sleep)(100),this.findEmoteMenu(b+100))}};$(E,"CompatEmoteMenu");let _=E},17103:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=f(22527),y=f(44589),_=f(46949),E=f(83342);const A=document.createElement("span"),b={"side-nav":".side-nav,#sideNav","side-nav-viewers":".side-nav-card__live-status","side-rec-channels":".side-nav .recommended-channels,.side-nav .side-nav-section + .side-nav-section:not(.online-friends):not(.bd--shelf)","side-friends":".side-nav .online-friends","side-closed-friends":".side-nav--collapsed .online-friends","side-closed-rec-channels":".side-nav--collapsed .recommended-channels,.side-nav--collapsed .side-nav-section + .side-nav-section:not(.online-friends):not(.bd--shelf)","side-offline-channels":".ffz--side-nav-card-offline","side-rerun-channels":".side-nav .ffz--side-nav-card-rerun","modview-hide-info":".modview-player-widget__hide-stream-info","community-highlights":".community-highlight-stack__card","elevate-your-message":'.chat-input__input-icons button[aria-label="ElevatedMessage"]',"prime-offers":".top-nav__prime","discover-luna":'.top-nav__external-link[data-a-target="try-presto-link"]',subtember:".subtember-gradient","player-gain-volume":'.video-player__container[data-compressed="true"] .volume-slider__slider-container:not(.ffz--player-gain)',"player-ext":".video-player .extension-taskbar,.video-player .extension-container,.video-player .extensions-dock__layout,.video-player .extensions-notifications,.video-player .extensions-video-overlay-size-container,.video-player .extensions-dock__layout","player-ext-hover":'.video-player__container[data-controls="false"] .extension-taskbar,.video-player__container[data-controls="false"] .extension-container,.video-player__container[data-controls="false"] .extensions-dock__layout,.video-player__container[data-controls="false"] .extensions-notifications,.video-player__container[data-controls="false"] .extensions-video-overlay-size-container',"player-cast":".video-player button:has(.tw-chromecast-button__icon)","player-event-bar":".channel-root .live-event-banner-ui__header","player-rerun-bar":'.channel-root__player-container div.tw-c-text-overlay:not([data-a-target="hosting-ui-header"])',"pinned-cheer":'.pinned-cheer,.pinned-cheer-v2,.channel-leaderboard,.channel-leaderboard-marquee,div[data-test-selector="channel-leaderboard-container"]',whispers:'body .whispers-open-threads,.tw-core-button[data-a-target="whisper-box-button"],.whispers__pill',"dir-live-ind":'.live-channel-card[data-ffz-type="live"] .tw-channel-status-text-indicator,article[data-ffz-type="live"] .tw-channel-status-text-indicator,.switcher-hopper__scroll-container .tw-tower a[data-ffz-type="live"] .tw-channel-status-text-indicator',"profile-hover":".preview-card .tw-relative:hover .ffz-channel-avatar","not-live-bar":'div[data-test-selector="non-live-video-banner-layout"]',"channel-live-ind":".channel-header__user .tw-channel-status-text-indicator,.channel-info-content .tw-halo__indicator",celebration:"body .celebration__overlay","last-x-events":".last-x-events_container","pinned-hype-chat":".paid-pinned-chat-message-list","side-stories":".side-nav__title + div[class*=storiesLeftNavSection]","ci-mod-view":'.chat-input__buttons-container a[href*="/moderator"]',"ci-highlight-settings":'.chat-input__buttons-container button[data-highlight-selector="chat-highlights-shortcut"]',"ci-shield-mode":'.chat-input__buttons-container > div:last-child button[class|="ScCoreButton"]:not([data-highlight-selector]):not([data-a-target])'},r=class r extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...s){super(...s),this.should_enable=!0,this.inject("settings"),this.style=new y.ManagedStyle,this.chunks={},this.chunks_loaded=!1,this._state={},this.settings.add("metadata.modview.hide-info",{default:!1,ui:{path:"Channel > Metadata >> Mod View",title:'Hide "Hide Stream Info Stripe" button.',component:"setting-check-box"},changed:i=>this.toggleHide("modview-hide-info",i)}),this.settings.add("metadata.viewers.no-native",{requires:["metadata.viewers"],default:null,process(i,e){return e??i.get("metadata.viewers")},changed:i=>this.toggle("hide-native-viewers",i),ui:{path:"Channel > Metadata >> Player",title:"Hide Twitch's native Viewer Count.",description:"By default, this is enabled whenever FFZ's own Viewer Count display is enabled to avoid redundant information.",component:"setting-check-box"}}),this.settings.add("metadata.uptime.no-native",{requires:["metadata.uptime"],default:null,process(i,e){return e??i.get("metadata.uptime")!==0},changed:i=>this.toggle("hide-native-uptime",i),ui:{path:"Channel > Metadata >> Player",title:"Hide Twitch's native Stream Uptime.",description:"By default, this is enabled whenever FFZ's own Stream Uptime display is enabled to avoid redundant information.",component:"setting-check-box"}}),this.settings.add("layout.use-chat-fix",{requires:["context.force_chat_fix","layout.swap-sidebars","layout.use-portrait","chat.use-width","context.isWatchParty"],process(i){return i.get("context.isWatchParty")?!1:i.get("context.force_chat_fix")||i.get("layout.swap-sidebars")||i.get("layout.use-portrait")||i.get("chat.use-width")},changed:i=>{i?this.toggle("chat-no-animate",!0):!i&&!this._no_anim_timer&&(this._no_anim_timer=requestAnimationFrame(()=>{this._no_anim_timer=null,this.settings.get("layout.use-chat-fix")||this.toggle("chat-no-animate",!1)})),this.toggle("chat-fix",i),this.emit("site.player:fix-player"),this.emit("site.layout:resize")}}),this.settings.add("layout.side-nav.hide-stories",{default:!1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Hide Stories",component:"setting-check-box"}}),this.settings.add("layout.side-nav.show",{default:1,requires:["layout.use-portrait"],process(i,e){return e===2?!i.get("layout.use-portrait"):e},ui:{sort:-1,path:"Appearance > Layout >> Side Navigation",title:"Display Side Navigation",component:"setting-select-box",data:[{value:0,title:"Never"},{value:1,title:"Always"},{value:2,title:"Hide in Portrait"}]},changed:i=>{this.toggle("hide-side-nav",!i),this.emit("site.layout:resize")}}),this.settings.add("layout.side-nav.hide-viewers",{default:!1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Hide Channel View Counts",component:"setting-check-box"},changed:i=>this.toggleHide("side-nav-viewers",i)}),this.settings.add("layout.side-nav.show-avatars",{default:!0,ui:{path:"Appearance > Layout >> Side Navigation",title:"Display Channel Avatars",component:"setting-check-box"},changed:i=>this.toggle("hide-side-nav-avatars",!i)}),this.settings.add("layout.side-nav.show-rec-channels",{default:1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Display Recommended / Popular Channels",component:"setting-select-box",data:[{value:0,title:"Never"},{value:1,title:"Always"},{value:2,title:"When Side Navigation is Open"}]},changed:i=>{this.toggleHide("side-rec-channels",i===0),this.toggleHide("side-closed-rec-channels",i===2)}}),this.settings.add("layout.side-nav.show-friends",{default:1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Display Online Friends",component:"setting-select-box",data:[{value:0,title:"Never"},{value:1,title:"Always"},{value:2,title:"When Side Navigation is Open"}]},changed:i=>{this.toggleHide("side-friends",i===0),this.toggleHide("side-closed-friends",i===2)}}),this.settings.add("layout.side-nav.hide-offline",{default:!1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Hide Offline Channels",component:"setting-check-box"},changed:i=>this.toggleHide("side-offline-channels",i)}),this.settings.add("layout.side-nav.rerun-style",{default:1,ui:{path:"Appearance > Layout >> Side Navigation",title:"Display Reruns",component:"setting-select-box",data:[{value:0,title:"Do Not Display"},{value:1,title:"Normally"},{value:2,title:"Faded (33% Opacity)"}]},changed:i=>{this.toggleHide("side-rerun-channels",i===0),this.toggle("side-rerun-opacity",i===2)}}),this.settings.add("layout.swap-sidebars",{default:!1,requires:["context.isWatchParty"],process(i,e){return i.get("context.isWatchParty")?!1:e},ui:{path:"Appearance > Layout >> Side Navigation",title:"Swap Sidebars",description:"Swap navigation and chat to the opposite sides of the window.",component:"setting-check-box"},changed:i=>{this.toggle("swap-sidebars",i),this.emit("site.layout:resize")}}),this.settings.add("layout.minimal-navigation",{requires:["layout.theatre-navigation","context.isWatchParty"],default:!1,process(i,e){return i.get("context.isWatchParty")?!1:i.get("layout.theatre-navigation")?!0:e},ui:{path:"Appearance > Layout >> Top Navigation",title:"Minimize Navigation",description:"Slide the site navigation bar up out of view when it isn't in use.",component:"setting-check-box"},changed:i=>{this.toggle("minimal-navigation",i),this.emit("site.layout:resize")}}),this.settings.add("layout.theatre-navigation",{requires:["layout.is-theater-mode"],default:!1,process(i,e){return i.get("layout.is-theater-mode")?e:!1},ui:{path:"Appearance > Layout >> Top Navigation",title:"Show the minimized navigation bar when in theatre mode.",component:"setting-check-box"},changed:i=>{this.toggle("theatre-nav",i),this.emit("site.layout:resize")}}),this.settings.add("layout.subtember",{default:!0,ui:{path:"Appearance > Layout >> Channel",title:"Allow the Subtember upsell banner to appear.",component:"setting-check-box"}}),this.settings.add("layout.turbo-cta",{default:!0,ui:{path:"Appearance > Layout >> Top Navigation",title:"Allow the Twitch Turbo button to appear.",component:"setting-check-box"}}),this.settings.add("layout.prime-offers",{default:!0,ui:{path:"Appearance > Layout >> Top Navigation",title:"Show Prime Gaming Loot.",component:"setting-check-box"},changed:i=>this.toggleHide("prime-offers",!i)}),this.settings.add("layout.hide-discover-luna",{default:!1,ui:{path:"Appearance > Layout >> Top Navigation",title:'Hide the "Discover Luna" link.',component:"setting-check-box"},changed:i=>this.toggleHide("discover-luna",i)}),this.settings.add("whispers.show",{default:!0,ui:{path:"Chat > Whispers >> General",title:"Display Whispers",component:"setting-check-box"},changed:i=>{this.toggleHide("whispers",!i),this.emit("site.layout:resize")}}),this.settings.add("chat.hype.show-pinned",{default:!0,ui:{path:"Chat > Hype Chat >> Appearance",title:"Allow Hype Chat messages to appear pinned at the top of chat.",component:"setting-check-box"},changed:i=>this.toggleHide("pinned-hype-chat",!i)}),this.settings.add("chat.bits.show",{default:!0,ui:{order:-1,path:"Chat > Bits and Cheering >> Appearance",title:"Display Bits",description:"Display UI associated with bits. Note: This will not hide cheering in chat messages.",component:"setting-check-box"},changed:i=>this.toggle("hide-bits",!i)}),this.settings.add("channel.show-celebrations",{default:!0,ui:{path:"Channel > Appearance >> General",title:"Allow Celebrations to appear.",description:"Celebrations are animations that cover the entire Twitch page.",component:"setting-check-box"},changed:i=>this.toggleHide("celebration",!i)}),this.settings.add("layout.theme.global-font",{default:"",ui:{path:"Appearance > Theme >> Fonts",title:"Font Family",description:'Override the font used for the entire Twitch website. The old default font was: `"Helvetica Neue",Helvetica,Arial,sans-serif`\n\nAny font available via [Google Fonts](https://fonts.google.com/) can be loaded by prefixing the font name with `google:`.',component:"setting-combo-box",data:()=>(0,E.R7)()},changed:()=>this.updateFont()}),this.settings.add("channel.hide-unfollow",{default:!1,ui:{path:"Channel > Appearance >> General",title:"Hide the Unfollow button.",component:"setting-check-box"},changed:i=>this.toggle("hide-unfollow-button",i)}),this.settings.add("channel.hide-live-indicator",{requires:["context.route.name"],process(i,e){return i.get("context.route.name")==="user"||i.get("context.route.name")==="user-home"?e:!1},default:!1,ui:{path:"Channel > Appearance >> General",title:'Hide the "LIVE" indicator on live channel pages.',component:"setting-check-box"},changed:i=>this.toggleHide("channel-live-ind",i)}),this.settings.add("channel.round-avatars",{default:!0,ui:{path:"Channel > Appearance >> General",title:"Allow avatar images to be rounded.",component:"setting-check-box"},changed:i=>this.toggle("square-avatars",!i)})}onEnable(){this.toggleHide("modview-hide-info",this.settings.get("metadata.modview.hide-info")),this.toggleHide("side-nav-viewers",this.settings.get("layout.side-nav.hide-viewers")),this.toggle("hide-native-uptime",this.settings.get("metadata.uptime.no-native")),this.toggle("hide-native-viewers",this.settings.get("metadata.viewers.no-native")),this.toggle("chat-fix",this.settings.get("layout.use-chat-fix")),this.toggle("swap-sidebars",this.settings.get("layout.swap-sidebars")),this.toggle("minimal-navigation",this.settings.get("layout.minimal-navigation")),this.toggle("theatre-nav",this.settings.get("layout.theatre-navigation")),this.toggle("hide-side-nav-avatars",!this.settings.get("layout.side-nav.show-avatars")),this.toggle("hide-side-nav",!this.settings.get("layout.side-nav.show")),this.toggleHide("side-offline-channels",this.settings.get("layout.side-nav.hide-offline")),this.toggleHide("discover-luna",this.settings.get("layout.hide-discover-luna")),this.toggleHide("prime-offers",!this.settings.get("layout.prime-offers")),this.toggle("hide-unfollow-button",this.settings.get("channel.hide-unfollow")),this.toggleHide("pinned-hype-chat",!this.settings.get("chat.hype.show-pinned")),this.toggle("square-avatars",!this.settings.get("channel.round-avatars")),this.toggleHide("channel-live-ind",this.settings.get("channel.hide-live-indicator"));const s=this.settings.get("layout.side-nav.rerun-style");this.toggleHide("side-rerun-channels",s===0),this.toggle("side-rerun-opacity",s===2);const i=this.settings.get("layout.side-nav.show-rec-channels");this.toggleHide("side-rec-channels",i===0),this.toggleHide("side-closed-rec-channels",i===2);const e=this.settings.get("layout.side-nav.show-friends");this.toggleHide("side-friends",e===0),this.toggleHide("side-closed-friends",e===2),this.toggleHide("whispers",!this.settings.get("whispers.show")),this.toggleHide("celebration",!this.settings.get("channel.show-celebrations")),this.settings.getChanges("layout.subtember",o=>this.toggleHide("subtember",!o)),this.settings.getChanges("layout.side-nav.hide-stories",o=>this.toggleHide("side-stories",o)),this.updateFont(),this.updateTopNav(),this.emit("site.player:fix-player"),this.emit("site.layout:resize")}updateTopNav(){requestAnimationFrame(()=>this.emit("site.layout:update-nav"))}updateFont(){let s=this.settings.get("layout.theme.global-font");if(s&&s.length){const[i,e]=(0,E.jo)(s);if(s=i,this._font_unloader&&this._font_unloader(),this._font_unloader=e,s.indexOf(" ")!==-1&&s.indexOf(",")===-1&&s.indexOf('"')===-1&&s.indexOf("'")===-1&&(s=`"${s}"`),A.style.fontFamily="",A.style.fontFamily=s,A.style.fontFamily){this.setVariable("global-font",s),this.toggle("global-font",!0);return}}this.toggle("global-font",!1),this.deleteVariable("global-font")}toggleHide(s,i){const e=`hide--${s}`;if(!i){this.style.delete(e);return}if(!(0,_.has)(b,s))throw new Error(`cannot find class for "${s}"`);this.style.set(e,`${b[s]} { display: none !important }`)}toggle(s,i){i=!!i,(this._state[s]??!1)!==i&&(this._state[s]=i,this._apply(s))}_apply(s){if(!this._state[s]){this.style&&this.style.delete(s);return}if(!this.style.has(s)){if(!this.chunks_loaded)return this.loadFromContext().then(()=>this._apply(s));if(!(0,_.has)(this.chunks,s)){this.log.warn(`Unknown chunk name "${s}" for toggle()`);return}this.style.set(s,this.chunks[s])}}set(s,i){return this.style.set(s,i)}delete(s){return this.style.delete(s)}setVariable(s,i,e="body"){this.style.set(`var--${s}`,`${e} { --ffz-${s}: ${i}; }`)}deleteVariable(s){this.style.delete(`var--${s}`)}loadFromContext(){if(!this.chunks_loaded)return new Promise(async s=>{const i=(await f.e(2597).then(f.bind(f,96677))).default;for(const e of i.keys()){const o=e.slice(2,e.length-(e.endsWith(".scss")?5:4));this.chunks[o]=i(e).default}this.emit("site.layout:resize"),this.chunks_loaded=!0,s()})}};$(r,"CSSTweaks");let v=r},95778:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>E});var N=f(22527),y=f(46949),_=f(89196);const A=class A extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...v){super(...v),this.should_enable=!0,this.inject("settings"),this.inject("site.fine"),this.inject("site.channel"),this.SunlightBroadcast=this.fine.define("sunlight-bcast",r=>r.getGame&&r.getTitle&&r.props?.data,_.Z.SUNLIGHT_ROUTES),this.SunlightManager=this.fine.define("sunlight-manager",r=>r.props?.channelID&&r.props.channelLogin&&(0,y.has)(r.props,"hostedChannel"),_.Z.SUNLIGHT_ROUTES)}onEnable(){this.SunlightManager.on("mount",this.updateSunlight,this),this.SunlightManager.on("update",this.updateSunlight,this),this.SunlightManager.on("unmount",this.removeSunlight,this),this.SunlightManager.ready((v,r)=>{for(const n of r)this.updateSunlight(n)}),this.SunlightBroadcast.on("mount",this.updateBroadcast,this),this.SunlightBroadcast.on("update",this.updateBroadcast,this),this.SunlightBroadcast.on("unmount",this.removeBroadcast,this),this.SunlightBroadcast.ready((v,r)=>{for(const n of r)this.updateBroadcast(n)})}updateSunlight(v){this.settings.updateContext({channel:(0,y.get)("props.channelLogin",v),channelID:(0,y.get)("props.channelID",v)})}removeSunlight(){this.settings.updateContext({channel:null,channelID:null})}updateBroadcast(v){const r=v.props?.data?.user?.broadcastSettings,n=r?.game;this.settings.updateContext({category:n?.name,categoryID:n?.id,title:r?.title})}removeBroadcast(){this.settings.updateContext({category:null,categoryID:null,title:null})}};$(A,"Dashboard");let E=A},96432:(q,T,f)=>{"use strict";f.r(T),f.d(T,{CARD_CONTEXTS:()=>b,CONTENT_FLAGS:()=>v,default:()=>s});var N=f(22527),y=f(83269),_=f(44589),E=f(46949);const i=class i extends N.default{constructor(...a){super(...a),this.inject("site"),this.inject("site.fine"),this.inject("site.apollo"),this.inject("i18n"),this.inject("settings"),this.GameHeader=this.fine.define("game-header",c=>c.props&&c.props.data&&c.getBannerImage&&c.getDirectoryCountAndTags,["dir-game-index","dir-community","dir-game-videos","dir-game-clips","dir-game-details"]),this.settings.addUI("directory.game.blocked-games",{path:`Directory > Categories @{"description": "Please note that due to limitations in Twitch's website, names here must be formatted exactly as displayed in your client. For best results, you can block or unblock categories directly from directory pages."} >> Blocked`,component:"game-list-editor",default:[],onUIChange:()=>this.parent.updateCards()}),this.settings.addUI("directory.game.hidden-thumbnails",{path:"Directory > Categories >> Hidden Thumbnails",component:"game-list-editor",default:[],onUIChange:()=>this.parent.updateCards()})}onEnable(){this.GameHeader.on("mount",this.updateGameHeader,this),this.GameHeader.on("update",this.updateGameHeader,this),this.GameHeader.on("unmount",()=>{this.settings.updateContext({category:null,categoryID:null})}),this.settings.provider.on("changed",a=>{if(a==="directory.game.blocked-games"||a==="directory.game.hidden-thumbnails"){this.parent.updateCards();for(const c of this.GameHeader.instances)this.updateGameHeader(c)}}),this.GameHeader.ready((a,c)=>{for(const d of c)this.updateGameHeader(d)}),this.on("site.router:route",a=>{a&&a.name==="dir-game-index"&&this.updateGameHeader()})}updateGameHeader(a){if(a===void 0){for(const d of this.GameHeader.instances)this.updateGameHeader(d);return}this.updateButtons(a);const c=a?.props?.data?.game;this.settings.updateContext({category:c?.name,categoryID:c?.id})}updateButtons(a){const c=this.fine.getChildNode(a);if((0,E.get)("data.game",a.props)==null||!c||!c.querySelector)return;const d=c.querySelector(".ffz-directory-buttons");d&&d.remove();const m=c.querySelector(".directory-header-new__info > div > div + div");if(!m)return;let w,h,p,z;const R=(0,E.get)("data.game.name",a.props)||a.props.directoryName,I=$(()=>{const F=this.settings.provider.get("directory.game.blocked-games",[]),H=F.includes(R);w.classList.toggle("active",H),h.textContent=H?this.i18n.t("directory.unblock","Unblock"):this.i18n.t("directory.block","Block")},"update_block"),j=$(()=>{const F=this.settings.provider.get("directory.game.hidden-thumbnails",[]),H=F.includes(R);p.classList.toggle("active",H),z.textContent=H?this.i18n.t("directory.show-thumbnails","Show Thumbnails"):this.i18n.t("directory.hide-thumbnails","Hide Thumbnails")},"update_hidden");w=(0,_.createElement)("button",{class:"tw-mg-r-1 tw-button ffz-directory-toggle-block",onClick:this.generateClickHandler("directory.game.blocked-games",R,I)},h=(0,_.createElement)("span",{class:"tw-button__text"})),I(),p=(0,_.createElement)("button",{class:"tw-button ffz-directory-toggle-thumbnail",onClick:this.generateClickHandler("directory.game.hidden-thumbnails",R,j)},z=(0,_.createElement)("span",{class:"tw-button__text"})),j(),m.appendChild((0,_.createElement)("div",{class:"tw-mg-t-1 ffz-directory-buttons"},w,p))}generateClickHandler(a,c,d){return m=>{m.preventDefault();const w=this.settings.provider.get(a)||[],h=w.indexOf(c);h===-1?w.push(c):w.splice(h,1),this.settings.provider.set(a,w),this.parent.updateCards(),d()}}};$(i,"Game");let A=i;const b=((o={})=>(o[o.SingleGameList=1]="SingleGameList",o[o.SingleChannelList=2]="SingleChannelList",o[o.MixedGameAndChannelList=3]="MixedGameAndChannelList",o))(),v=["DrugsIntoxication","Gambling","MatureGame","ProfanityVulgarity","SexualThemes","ViolentGraphic"];function r(o,a){return o[0].length&&o[1].push((0,E.addWordSeparators)(o[0].join("|"))),o[1].length?new RegExp(o[1].join("|"),a):null}$(r,"formatTerms");const n=["front-page","dir","dir-community","dir-community-index","dir-creative","dir-following","dir-game-index","dir-game-clips","dir-game-videos","dir-all","dir-category","user-videos","user-clips"],e=class e extends N.default{constructor(...a){super(...a),this.should_enable=!0,this.inject("site"),this.inject("site.elemental"),this.inject("site.fine"),this.inject("site.router"),this.inject("site.css_tweaks"),this.inject("site.twitch_data"),this.inject("i18n"),this.inject("settings"),this.inject(A),this.DirectoryCard=this.elemental.define("directory-card",'article[data-a-target^="video-carousel-card-"],article[data-a-target^="followed-vod-"],article[data-a-target^="card-"],div[data-a-target^="video-tower-card-"] article,div[data-a-target^="clips-card-"] article,.shelf-card__impression-wrapper article,.tw-tower div article',n,null,0,0),this.DirectoryExperimentCard=this.elemental.define("directory-experiment-card",".switcher-hopper__scroll-container .tw-tower > div > a",n,null,0,0),this.DirectoryGameCard=this.elemental.define("directory-game-card",".game-card[data-a-id]",n,null,0,0),this.DirectoryShelf=this.fine.define("directory-shelf",c=>c.shouldRenderNode&&c.props&&c.props.shelf,n),this.DirectorySorter=this.fine.define("directory-sorter",c=>c.getSortOptionLink&&c.getSortOptionText&&c.getSortOptionOnClick&&c.getFilterIDs,n),this.settings.add("directory.hidden.style",{default:2,ui:{path:'Directory > Categories >> Hidden Thumbnail Style @{"sort": 100}',title:"Hidden Style",component:"setting-select-box",sort:100,data:[{value:0,title:"Replace Image"},{value:1,title:"Replace Image and Blur Title"},{value:2,title:"Blur Image"},{value:3,title:"Blur Image and Title"}]},changed:c=>{this.css_tweaks.toggle("dir-no-blur",c<2),this.css_tweaks.toggle("dir-blur-title",c===1||c===3)}}),this.settings.add("directory.hide-costream-border",{default:!1,ui:{path:"Directory > Channels >> Appearance",title:"Hide border on streams with guest stars.",component:"setting-check-box",getExtraTerms:()=>["costream","co-stream"]}}),this.settings.add("directory.hidden.reveal",{default:!1,ui:{path:"Directory > Categories >> Hidden Thumbnail Style",title:"Reveal hidden entries on mouse hover.",component:"setting-check-box",sort:101},changed:c=>this.css_tweaks.toggle("dir-reveal",c)}),this.settings.add("directory.uptime",{default:1,ui:{path:"Directory > Channels >> Appearance",title:"Stream Uptime",description:"Display the stream uptime on the channel cards.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Enabled"},{value:2,title:"Enabled (with Seconds)"}]},changed:()=>this.updateCards()}),this.settings.add("directory.show-flags",{default:!1,ui:{path:"Directory > Channels >> Appearance",title:"Display Content Flags on channel cards.",component:"setting-check-box"},changed:()=>this.updateCards()}),this.settings.add("directory.hide-live",{default:!1,ui:{path:"Directory > Channels >> Appearance",title:"Do not show the Live indicator on channels that are live.",component:"setting-check-box"},changed:c=>this.css_tweaks.toggleHide("dir-live-ind",c)}),this.settings.add("directory.hide-promoted",{default:!1,ui:{path:"Directory > Channels >> Appearance",title:"Do not show Promoted streams in the directory.",component:"setting-check-box"},changed:()=>this.updateCards()}),this.settings.add("directory.hide-vodcasts",{default:!1,ui:{path:"Directory > Channels >> Appearance",title:"Do not show reruns in the directory.",component:"setting-check-box"},changed:()=>this.updateCards()}),this.settings.add("directory.hide-recommended",{default:!1,ui:{path:"Directory > Following >> Categories",title:"Do not show `Recommended Live Channels` in the Following Directory.",component:"setting-check-box"},changed:()=>this.DirectoryShelf.forceUpdate()}),this.settings.add("directory.block-users",{default:[],type:"array_merge",always_inherit:!0,ui:{path:"Directory > Channels >> Block by Username",component:"basic-terms",words:!1}}),this.settings.add("__filter:directory.block-users",{requires:["directory.block-users"],equals:"requirements",process(c){const d=c.get("directory.block-users");if(!d||!d.length)return null;const m=[[],[]];for(const w of d){const h=w.t;let p=w.v;h==="glob"?p=(0,E.glob_to_regex)(p):h!=="raw"&&(p=(0,E.escape_regex)(p)),!(!p||!p.length)&&m[w.s?0:1].push(p)}return[m[0].length?new RegExp(`^(?:${m[0].join("|")})$`):null,m[1].length?new RegExp(`^(?:${m[1].join("|")})$`,"i"):null]},changed:()=>this.updateCards()}),this.settings.add("directory.block-titles",{default:[],type:"array_merge",always_inherit:!0,ui:{path:"Directory > Channels >> Block by Title",component:"basic-terms"}}),this.settings.add("__filter:directory.block-titles",{requires:["directory.block-titles"],equals:"requirements",process(c){const d=c.get("directory.block-titles");if(!d||!d.length)return null;const m=[[[],[]],[[],[]]];for(const w of d){const h=w.t;let p=w.v;h==="glob"?p=(0,E.glob_to_regex)(p):h!=="raw"&&(p=(0,E.escape_regex)(p)),!(!p||!p.length)&&m[w.s?0:1][w.w?0:1].push(p)}return[r(m[0],"g"),r(m[1],"gi")]},changed:()=>this.updateCards()}),this.settings.add("directory.blocked-tags",{default:[],type:"basic_array_merge",always_inherit:!0,ui:{path:"Directory > Channels >> Block by Tag",component:"tag-list-editor"},changed:()=>this.updateCards()}),this.settings.add("directory.blur-titles",{default:[],type:"array_merge",always_inherit:!0,ui:{path:"Directory > Channels >> Hide Thumbnails by Title",component:"basic-terms"}}),this.settings.add("__filter:directory.blur-titles",{requires:["directory.blur-titles"],equals:"requirements",process(c){const d=c.get("directory.blur-titles");if(!d||!d.length)return null;const m=[[[],[]],[[],[]]];for(const w of d){const h=w.t;let p=w.v;h==="glob"?p=(0,E.glob_to_regex)(p):h!=="raw"&&(p=(0,E.escape_regex)(p)),!(!p||!p.length)&&m[w.s?0:1][w.w?0:1].push(p)}return[r(m[0],"g"),r(m[1],"gi")]},changed:()=>this.updateCards()}),this.settings.add("directory.blur-tags",{default:[],type:"basic_array_merge",always_inherit:!0,ui:{path:"Directory > Channels >> Hide Thumbnails by Tag",component:"tag-list-editor"},changed:()=>this.updateCards()}),this.settings.add("directory.wait-flags",{default:!0,ui:{path:"Directory > Channels >> Appearance",title:"Hide Thumbnails for all channels until Content Flags have been loaded.",description:"We need to load content flags with a separate query, so they aren't immediately available to determine if a given stream should be hidden, or have its thumbnail blurred. This setting will blur ALL thumbnails until after we've finished loading the necessary content flag information, ensuring you don't see a flash of anything you would rather not.",component:"setting-check-box"},changed:()=>this.updateCards()}),this.settings.add("directory.block-flags",{default:[],type:"array_merge",always_inherit:!0,process(c,d){const m=new Set;for(const w of d){let h=w?.v;h==="ViolentGrpahic"&&(h="ViolentGraphic"),h&&m.add(h)}return m},ui:{path:"Directory > Channels >> Block by Flag",component:"blocked-types",data:()=>[...v].sort()},changed:()=>this.updateCards()}),this.settings.add("directory.blur-flags",{default:[],type:"array_merge",always_inherit:!0,process(c,d){const m=new Set;for(const w of d)w?.v&&m.add(w.v);return m},ui:{path:"Directory > Channels >> Hide Thumbnails by Flag",component:"blocked-types",data:()=>[...v].sort()},changed:()=>this.updateCards()}),this.settings.add("directory.default-sort",{default:!1,ui:{path:"Directory > General >> General",title:"Force Default Sorting",component:"setting-select-box",data:[{value:!1,title:"Disabled"},{value:"RELEVANCE",title:"Recommended For You"},{value:"VIEWER_COUNT",title:"Viewers (High to Low)"},{value:"VIEWER_COUNT_ASC",title:"Viewers (Low to High)"},{value:"RECENT",title:"Recently Started"}]},changed:()=>this.updateSorting()}),this.routeClick=this.routeClick.bind(this)}onEnable(){this.css_tweaks.toggleHide("profile-hover",this.settings.get("directory.show-channel-avatars")===2),this.css_tweaks.toggleHide("dir-live-ind",this.settings.get("directory.hide-live")),this.css_tweaks.toggle("dir-reveal",this.settings.get("directory.hidden.reveal")),this.settings.getChanges("directory.hide-costream-border",d=>this.css_tweaks.toggle("hide-costream-border",d));const a=this.settings.get("directory.hidden.style");this.css_tweaks.toggle("dir-no-blur",a<2),this.css_tweaks.toggle("dir-blur-title",a===1||a===3),this.on("i18n:update",()=>this.updateCards()),this.DirectoryExperimentCard.on("mount",this.updateExpCard,this),this.DirectoryExperimentCard.on("mutate",this.updateExpCard,this),this.DirectoryExperimentCard.on("unmount",this.clearExpCard,this),this.DirectoryExperimentCard.each(d=>this.updateExpCard(d)),this.DirectoryCard.on("mount",this.updateCard,this),this.DirectoryCard.on("mutate",this.updateCard,this),this.DirectoryCard.on("unmount",this.clearCard,this),this.DirectoryCard.each(d=>this.updateCard(d)),this.DirectoryGameCard.on("mount",this.updateGameCard,this),this.DirectoryGameCard.on("mutate",this.updateGameCard,this),this.DirectoryGameCard.each(d=>this.updateGameCard(d)),this.DirectorySorter.on("mount",this.updateSorting,this),this.DirectorySorter.ready(()=>this.updateSorting());const c=this;this.DirectoryShelf.ready(d=>{const m=d.prototype.shouldRenderNode;d.prototype.shouldRenderNode=function(h,...p){try{let z;if(h.__typename==="Game"?z=h.name:h.game&&(z=h.game.name),z&&c.settings.provider.get("directory.game.blocked-games",[]).includes(z))return!1}catch(z){c.log.capture(z),c.log.error(z)}return m.call(this,h,...p)};const w=d.prototype.render;d.prototype.render=function(){try{if(c.settings.get("directory.hide-recommended")&&(0,E.get)("props.shelf.title.key",this)==="live_recs_following")return null}catch(h){c.log.capture(h)}return w.call(this)},this.DirectoryShelf.forceUpdate()})}updateSorting(a){if(!a){for(const m of this.DirectorySorter.instances)this.updateSorting(m);return}const c=this.settings.get("directory.default-sort");if(!c||c===a.state?.activeOption)return;const d=a.getSortOptionLink(c,!1,a.props);d?.props?.linkTo&&(d.props.onClick&&d.props.onClick(),this.router.history.push(d.props.linkTo))}updateGameCard(a){const c=this.fine.getReactInstance(a);if(!c)return;const d=c.return?.memoizedProps;if(!d?.trackingProps?.category)return;const m=d.trackingProps.category,w=d.tagListProps?.tags;let h=!1;if(Array.isArray(w)){const R=this.settings.get("directory.blocked-tags",[]);if(R.length){for(const I of w)if(I?.id&&R.includes(I.id)){h=!0;break}}}const p=h||this.settings.provider.get("directory.game.blocked-games",[]).includes(m);let z=a.closest(".tw-tower > div");z||(z=a),z.querySelectorAll('a[data-a-target="tw-box-art-card-link"]').length<2&&z.classList.toggle("tw-hide",p)}updateCards(){this.DirectoryCard.each(a=>this.updateCard(a)),this.DirectoryExperimentCard.each(a=>this.updateExpCard(a)),this.DirectoryGameCard.each(a=>this.updateGameCard(a)),this.DirectoryShelf.forceUpdate(),this.emit(":update-cards")}clearCard(a,c=!1){this.clearUptime(a),this.clearFlags(a);const d=this._getTopRightContainer(a,c);d&&d.remove(),a._ffz_top_right=null}clearExpCard(a){return this.clearCard(a,!0)}updateCard(a){const c=this.fine.searchParentNode(a,m=>m.memoizedProps?.channelLogin);if(!c)return;const d=c.memoizedProps;return this._updateCard(a,!1,d,d.trackingProps)}updateExpCard(a){const c=this.fine.searchParentNode(a,w=>w.memoizedProps?.item?.channelID);if(!c)return;const d=c.memoizedProps,m=d.item;return this._updateCard(a,!0,m,d.tracking)}_updateCard(a,c,d,m){const w=d.categoryName||d.gameTitle||m?.game||m?.categoryName||m?.category,h=d.tags??d.tagListProps?.freeformTags,p=this.settings.get("directory.wait-flags"),z=this.settings.get("directory.show-flags"),R=this.settings.get("directory.blur-flags",[]),I=this.settings.get("directory.block-flags",[]),j=R.size>0||I.size>0,F=z||j;a._ffz_flags===void 0&&F&&(a._ffz_flags=null,d.slug||d.type==="clips"?a._ffz_flags=[]:d.vodID||d.type==="videos"?a._ffz_flags=[]:this.twitch_data.getStreamFlags(d.channelID,d.channelID?null:d.channelLogin).then(rt=>{a._ffz_flags=rt??[],c?this.updateExpCard(a):this.updateCard(a)}));let H=!1,Y=!1;if(Array.isArray(h)){const rt=this.settings.get("directory.blocked-tags",[]),mt=this.settings.get("directory.blur-tags",[]);if(rt.length||mt.length)for(const W of h){if(W?.name){const L=W.name.toLowerCase();rt.includes(L)&&(H=!0),mt.includes(L)&&(Y=!0)}if((H||!rt.length)&&(Y||!mt.length))break}}let st=Y;if(p&&j&&a._ffz_flags==null&&(st=!0),st||(st=this.settings.provider.get("directory.game.hidden-thumbnails",[]).includes(w)),!st&&R.size&&a._ffz_flags){for(const rt of a._ffz_flags)if(rt?.id&&R.has(rt.id)){st=!0;break}}if(!st){const rt=this.settings.get("__filter:directory.blur-titles");rt&&(rt[0]&&(rt[0].lastIndex=-1),rt[1]&&(rt[1].lastIndex=-1),(rt[0]&&rt[0].test(d.title)||rt[1]&&rt[1].test(d.title))&&(st=!0))}const tt=d.type??d.streamType;a.classList.toggle("ffz-hide-thumbnail",st),a.dataset.ffzType=tt;let it=!1;if(H)it=!0;else if(tt==="rerun"&&this.settings.get("directory.hide-vodcasts"))it=!0;else if(d.context!=null&&d.context!==b.SingleGameList&&this.settings.provider.get("directory.game.blocked-games",[]).includes(w))it=!0;else if((d.isPromotion||d.sourceType==="COMMUNITY_BOOST"||d.sourceType==="PROMOTION"||d.sourceType==="SPONSORED")&&this.settings.get("directory.hide-promoted"))it=!0;else{if(I.size&&a._ffz_flags){for(const rt of a._ffz_flags)if(rt?.id&&I.has(rt.id)){it=!0;break}}if(!it){const rt=this.settings.get("__filter:directory.block-users");rt&&(rt[0]&&(rt[0].lastIndex=-1),rt[1]&&(rt[1].lastIndex=-1),(rt[0]&&rt[0].test(d.channelLogin)||rt[1]&&rt[1].test(d.channelLogin))&&(it=!0))}if(!it){const rt=this.settings.get("__filter:directory.block-titles");rt&&(rt[0]&&(rt[0].lastIndex=-1),rt[1]&&(rt[1].lastIndex=-1),(rt[0]&&rt[0].test(d.title)||rt[1]&&rt[1].test(d.title))&&(it=!0))}}let ut=a.closest(".tw-tower > div");ut||(ut=a),ut.querySelectorAll(".tw-aspect .tw-image:not(.tw-image-avatar)").length<2&&ut.classList.toggle("tw-hide",it),this.updateUptime(a,d,c),this.updateFlags(a,c)}updateFlags(a,c=!1){if(!document.contains(a))return this.clearFlags(a);if(!this.settings.get("directory.show-flags")||!a._ffz_flags?.length)return this.clearFlags(a);const m=this._getTopRightContainer(a,!0,c);if(!m)return this.clearFlags(a);a.ffz_flags_el?a.contains(a.ffz_flags_el)||m.appendChild(a.ffz_flags_el):m.appendChild(a.ffz_flags_el=(0,_.createElement)("div",{class:"tw-mg-y-05 ffz-flags-element tw-relative ffz-il-tooltip__container"},(0,_.createElement)("div",{class:"tw-border-radius-small tw-c-background-overlay tw-c-text-overlay tw-flex tw-pd-x-05"},(0,_.createElement)("figure",{class:"ffz-i-flag"})),a.ffz_flags_tt=(0,_.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--pre ffz-il-tooltip--down ffz-il-tooltip--align-right"}))),a.ffz_flags_tt.textContent=this.i18n.t("metadata.flags.tooltip","Intended for certain audiences. May contain:")+`

`+a._ffz_flags.map(w=>w.localizedName).join(`
`)}clearFlags(a){a.ffz_flags_el&&(a.ffz_flags_el.remove(),a.ffz_flags_tt=null,a.ffz_flags_el=null)}_getTopRightContainer(a,c=!0,d=!1){let m=a._ffz_top_right??a.querySelector(".ffz-top-right");if(m||!c)return m;let w=d?a.querySelector(".tw-aspect .tw-image"):a.querySelector('a[data-a-target="preview-card-image-link"] > div');return w&&d&&(w=w.parentElement?.parentElement),w?(m=(0,_.createElement)("div",{"data-test-selector":"top-right-selector",class:"tw-absolute tw-mg-1 tw-right-0 tw-top-0 ffz-top-right tw-flex tw-flex-column tw-align-items-end"}),a._ffz_top_right=m,w.appendChild(m),m):null}updateUptime(a,c,d=!1){if(!document.contains(a))return this.clearUptime(a);const m=this.settings.get("directory.uptime"),w=this._getTopRightContainer(a,m>0,d);if(!w||m===0||c.viewCount||c.animatedImageProps||c.type==="videos"||c.type==="clips")return this.clearUptime(a);let h=c.createdAt;h||(a.ffz_stream_meta===void 0&&(a.ffz_stream_meta=null,this.twitch_data.getStreamMeta(null,c.channelLogin).then(I=>{a.ffz_stream_meta=I,this.updateUptime(a,c,d)})),h=a.ffz_stream_meta?.createdAt);const p=h&&new Date(h),z=p&&Math.floor((Date.now()-p)/1e3)||0;if(z<1)return this.clearUptime(a);const R=(0,y.duration_to_string)(z,!1,!1,!1,m===1);if(a.ffz_uptime_el||(a.ffz_uptime_el=w.querySelector(".ffz-uptime-element")),a.ffz_uptime_el?a.contains(a.ffz_uptime_el)||w.appendChild(a.ffz_uptime_el):w.appendChild(a.ffz_uptime_el=(0,_.createElement)("div",{class:"ffz-uptime-element tw-relative ffz-il-tooltip__container"},(0,_.createElement)("div",{class:"tw-border-radius-small tw-c-background-overlay tw-c-text-overlay tw-flex tw-pd-x-05"},(0,_.createElement)("div",{class:"tw-flex tw-c-text-live"},(0,_.createElement)("figure",{class:"ffz-i-clock"})),a.ffz_uptime_span=(0,_.createElement)("p",null)),(0,_.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},this.i18n.t("metadata.uptime.tooltip","Stream Uptime"),a.ffz_uptime_tt=(0,_.createElement)("div",{class:"tw-pd-t-05"})))),a.ffz_uptime_span||(a.ffz_uptime_span=a.ffz_uptime_el.querySelector("p")),!a.ffz_uptime_span)return this.clearUptime(a);if(a.ffz_uptime_tt||(a.ffz_uptime_tt=a.ffz_uptime_el.querySelector(".ffz-il-tooltip > div")),!a.ffz_uptime_tt)return this.clearUptime(a);a.ffz_update_timer||(a.ffz_update_timer=setInterval(this.updateUptime.bind(this,a,c,d),1e3)),a.ffz_uptime_span.textContent=R,a.ffz_last_created_at!==h&&(a.ffz_uptime_tt.textContent=this.i18n.t("metadata.uptime.since","(since {since,datetime})",{since:p}),a.ffz_last_created_at=h)}clearUptime(a){a.ffz_update_timer&&(clearInterval(a.ffz_update_timer),a.ffz_update_timer=null),a.ffz_uptime_el&&(a.ffz_uptime_el.remove(),a.ffz_uptime_el=null,a.ffz_uptime_span=null,a.ffz_uptime_tt=null,a.ffz_last_created_at=null)}routeClick(a,c){if(a.preventDefault(),a.stopPropagation(),!c){const d=a.currentTarget;if(d){const m=d.dataset;m&&m.href?c=m.href:d.href&&(c=d.href)}}c&&this.router.history.push(c)}hijackUserClick(a,c,d=null){a.preventDefault(),a.stopPropagation(),d&&d(a,c),this.router.navigate("user",{userName:c})}};$(e,"Directory");let s=e},68318:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=f(24431),y=f(22527),_=f(46949);const E=/^8(102|363)$/.test(f.j)?["user","video","user-video","user-clip","user-videos","user-clips","user-collections","user-events","user-followers","user-following"]:null,A=/^8(102|363)$/.test(f.j)?["popout","embed-chat","dash-chat"]:null,v=class v extends(/^8(102|363)$/.test(f.j)?y.default:null){constructor(...n){super(...n),this.should_enable=!0,this.inject("settings"),this.inject("site.fine"),this.inject("site.css_tweaks"),this.inject("site.elemental"),this.ResizeDetector=this.fine.define("resize-detector",s=>s.maybeDebounceOnScroll&&s.setGrowDivRef&&s.props.onResize),this.SideBar=this.elemental.define("sidebar",".side-bar-contents",null,{childNodes:!0,subtree:!0},1),this.settings.add("clips.layout.big",{default:!1,ui:{path:"Appearance > Layout >> Clips",title:"Allow the player to get larger on `clips.twitch.tv` pages.",description:"This only affects windows at least 1,200 pixels wide and attempts to make the player and chat replay as large as possible.",component:"setting-check-box"}}),this.settings.add("layout.portrait",{default:!1,ui:{path:"Appearance > Layout >> Channel",title:"Enable Portrait Mode",description:"In Portrait Mode, chat will be displayed beneath the player when the window is taller than it is wide.",component:"setting-check-box"}}),this.settings.add("layout.portrait-invert",{default:!1,ui:{path:"Appearance > Layout >> Channel",title:"When in portrait mode, place chat at the top.",component:"setting-check-box"},changed:s=>document.body.classList.toggle("ffz--portrait-invert",s)}),this.settings.add("layout.portrait-threshold",{default:1.25,ui:{path:"Appearance > Layout >> Channel",title:"Portrait Mode Threshold",description:"This is the Width to Height ratio at which point Portrait Mode will begin to activate.",component:"setting-text-box",process(s){return s=parseFloat(s,10),isNaN(s)||!isFinite(s)||s<=0?1.25:s}}}),this.settings.add("layout.portrait-min-chat",{default:!1,requires:["layout.use-portrait"],process(s,i){return s.get("layout.use-portrait")?i:!1},ui:{path:"Appearance > Layout >> Channel",title:"Use compact chat in Portrait Mode.",description:"When enabled, this minimizes the chat header and places the chat input box in line with the chat buttons in order to present a more compact chat able to display more lines with limited vertical space.",component:"setting-check-box"}}),this.settings.add("layout.use-portrait",{requires:["layout.portrait","layout.portrait-threshold","context.route.name","context.size","context.isWatchParty"],process(s){if(s.get("context.isWatchParty"))return!1;const i=s.get("context.size");return!i||!s.get("layout.portrait")||!E.includes(s.get("context.route.name"))?!1:i.width/i.height<=s.get("layout.portrait-threshold")},changed:()=>this.updatePortraitMode()}),this.settings.add("layout.inject-portrait",{requires:["layout.use-portrait","context.ui.rightColumnExpanded"],process(s){return s.get("layout.use-portrait")&&s.get("context.ui.rightColumnExpanded")}}),this.settings.add("layout.use-portrait-swapped",{requires:["layout.inject-portrait","layout.swap-sidebars"],process(s){return s.get("layout.inject-portrait")&&s.get("layout.swap-sidebars")}}),this.settings.add("layout.use-portrait-meta",{requires:["layout.inject-portrait","player.theatre.metadata"],process(s){return s.get("layout.inject-portrait")&&s.get("player.theatre.metadata")}}),this.settings.add("layout.use-portrait-meta-top",{requires:["layout.use-portrait-meta","layout.portrait-invert"],process(s){return s.get("layout.use-portrait-meta")&&!s.get("layout.portrait-invert")}}),this.settings.add("layout.is-theater-mode",{requires:["context.ui.theatreModeEnabled","context.fullscreen"],process(s){return s.get("context.fullscreen")?!1:s.get("context.ui.theatreModeEnabled")}}),this.settings.add("layout.show-portrait-chat",{requires:["layout.use-portrait","layout.portrait-extra-height","layout.portrait-extra-width"],process(){return!0},changed:()=>this.updatePortraitMode()}),this.settings.add("layout.portrait-extra-height",{requires:["context.new_channel","context.squad_bar","layout.is-theater-mode","player.theatre.no-whispers","whispers.show","layout.minimal-navigation"],process(s){let i=0;return s.get("layout.is-theater-mode")?(s.get("layout.minimal-navigation")&&(i+=1),s.get("whispers.show")&&!s.get("player.theatre.no-whispers")&&(i+=4)):(i=s.get("layout.minimal-navigation")?1:5,s.get("whispers.show")&&(i+=4),s.get("context.squad_bar")&&(i+=6),i+=s.get("context.new_channel")?1:5),i}}),this.settings.add("layout.portrait-extra-width",{require:["layout.side-nav.show","layout.is-theater-mode","context.ui.sideNavExpanded"],process(s){return!s.get("layout.side-nav.show")||s.get("layout.is-theater-mode")?0:s.get("context.ui.sideNavExpanded")?24:5}}),this.settings.add("layout.is-minimal",{require:["context.route.name"],process(s){return A.includes(s.get("context.route.name"))}})}onEnable(){document.body.classList.toggle("ffz--portrait-invert",this.settings.get("layout.portrait-invert")),this.on(":update-nav",this.updateNavLinks,this),this.on(":resize",this.handleResize,this),this.settings.getChanges("layout.portrait-min-chat",n=>this.css_tweaks.toggle("portrait-chat",n)),this.settings.getChanges("layout.inject-portrait",n=>this.css_tweaks.toggle("portrait",n)),this.settings.getChanges("layout.use-portrait-swapped",n=>this.css_tweaks.toggle("portrait-swapped",n)),this.settings.getChanges("layout.use-portrait-meta",n=>this.css_tweaks.toggle("portrait-metadata",n)),this.settings.getChanges("layout.use-portrait-meta-top",n=>this.css_tweaks.toggle("portrait-metadata-top",n)),this.settings.getChanges("layout.portrait-extra-width",n=>this.css_tweaks.setVariable("portrait-extra-width",`${n}rem`)),this.settings.getChanges("layout.portrait-extra-height",n=>this.css_tweaks.setVariable("portrait-extra-height",`${n}rem`)),this.on("site.directory:update-cards",()=>{this.SideBar.each(n=>this._updateSidebar(n))}),this.ResizeDetector.ready(()=>{this._needs_resize&&(this._needs_resize=!1,this.handleResize())}),this.SideBar.on("mount",this.updateSidebar,this),this.SideBar.on("mutate",this.updateSidebar,this),this.SideBar.each(n=>this.updateSidebar(n))}handleResize(){this._resize_timer||(this._resize_timer=setTimeout(()=>this._handleResize(),N.IS_FIREFOX?500:100))}_handleResize(){if(clearTimeout(this._resize_timer),this._resize_timer=null,!this.ResizeDetector.instances.size)this._needs_resize=!0;else{for(const n of this.ResizeDetector.instances)n?.onScroll?.();this.emit("site.player:fix-player")}}get is_minimal(){return this.settings.get("layout.is-minimal")}updateSidebar(n){n&&(n._ffz_update||(n._ffz_update=(0,_.debounce)(()=>requestAnimationFrame(()=>this._updateSidebar(n)),1e3,2)),n._ffz_update())}_updateSidebar(n){if(!n)return;const s=n.querySelectorAll(".side-nav-card"),i=this.settings.provider.get("directory.game.blocked-games",[]);for(const e of s){const o=this.fine.getReactInstance(e),a=o?.return?.return?.memoizedProps,c=a?.metadataRight?.props?.stream,d=c?.type==="rerun",m=c?.game?.displayName,w=a?.offline??!1;let h=!1;if(m&&i.includes(m)&&(h=!0),a?.isPromoted&&this.settings.get("directory.hide-promoted"))h=!0;else{if(!h){const p=this.settings.get("__filter:directory.block-users"),z=a?.userLogin;p&&z&&(p[0]&&(p[0].lastIndex=-1),p[1]&&(p[1].lastIndex=-1),(p[0]&&p[0].test(z)||p[1]&&p[1].test(z))&&(h=!0))}if(!h){const p=this.settings.get("__filter:directory.block-titles"),z=c?.broadcaster?.broadcastSettings?.title;p&&z&&(p[0]&&(p[0].lastIndex=-1),p[1]&&(p[1].lastIndex=-1),(p[0]&&p[0].test(z)||p[1]&&p[1].test(z))&&(h=!0))}}e.classList.toggle("ffz--side-nav-card-rerun",d),e.classList.toggle("ffz--side-nav-card-offline",w),e.classList.toggle("tw-hide",h)}}updateNavLinks(){}updatePortraitMode(){}};$(v,"Layout");let b=v},29333:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=f(24431),y=f(22527),_=f(44589),E=f(89196),A=f(6170);const v=class v extends(/^8(102|363)$/.test(f.j)?y.default:null){constructor(...n){super(...n),this.inject("i18n"),this.inject("settings"),this.inject("site"),this.inject("site.fine"),this.inject("site.elemental"),this.pauseToasts=this.pauseToasts.bind(this),this.unpauseToasts=this.unpauseToasts.bind(this),this.should_enable=!0,this._pill_content=null,this._has_update=!1,this._important_update=!1,this._new_settings=0,this._loading=!1,this.toasts=[],this.settings.add("ffz.show-new-settings",{default:!0,ui:{path:"Appearance > Layout >> Top Navigation",title:"Display an indicator on the FFZ Control Center button whenever there are new settings added to FrankerFaceZ.",component:"setting-check-box"},changed:()=>this.update()}),this.ModBar=this.fine.define("mod-view-bar",s=>s.actions&&s.updateRoot&&s.childContext,["mod-view"]),this.SunlightNav=this.elemental.define("sunlight-nav",".sunlight-top-nav > div > div > div > div:last-child > div",E.Z.SUNLIGHT_ROUTES,{attributes:!0},1),this.NavBar=this.fine.define("nav-bar",s=>s.renderOnsiteNotifications&&s.renderTwitchPrimeCrown),this.SquadBar=this.fine.define("squad-nav-bar",s=>s.exitSquadMode&&s.props&&s.props.squadID,["squad"]),this.MultiController=this.fine.define("multi-controller",s=>s.handleAddStream&&s.handleRemoveStream&&s.getInitialStreamLayout,["command-center"])}get loading(){return this._loading}set loading(n){n!==this._loading&&(this._loading=n,this.update())}get new_settings(){return this._new_settings}set new_settings(n){n!==this._new_settings&&(this._new_settings=n,this.update())}get has_new(){return this.settings.get("ffz.show-new-settings")&&this._new_settings>0}get important_update(){return this._important_update}set important_update(n){this._important_update=!1,this.update()}get has_update(){return this._has_update}get has_strings(){return this.i18n.new_strings>0||this.i18n.changed_strings>0}set has_update(n){n&&!this._has_update&&(this._important_update=!0),this._has_update=n,this.update()}get pill(){return this._pill_content}set pill(n){this._pill_content=n,this.update()}formatPill(){const n=this._pill_content;return typeof n=="number"?this.i18n.formatNumber(n):n==null&&this.has_new?this.i18n.formatNumber(this._new_settings):n}formatExtraPill(){if(this.has_update)return null;if(this.settings.disable_profiles)return(0,_.createElement)("figure",{class:"ffz-i-cog"});if(this.has_strings)return this.i18n.formatNumber(this.i18n.new_strings+this.i18n.changed_strings);const n=this.resolve("addons");return N.DEBUG&&n.has_dev?this.i18n.t("site.menu_button.dev","dev"):N.DEBUG&&!n.has_dev?this.i18n.t("site.menu_button.main-dev","m-dev"):!N.DEBUG&&n.has_dev?this.i18n.t("site.menu_button.addon-dev","a-dev"):null}updateToasts(){requestAnimationFrame(()=>this._updateToasts())}_updateToasts(){for(const n of this.NavBar.instances)this.updateButtonToast(n);for(const n of this.SquadBar.instances)this.updateButtonToast(n);for(const n of this.MultiController.instances)this.updateButtonToast(n);for(const n of this.SunlightNav.instances)this.updateButtonToast(null,n,!0);for(const n of this.ModBar.instances)this.updateButtonToast(n)}update(){requestAnimationFrame(()=>this._update())}_update(){for(const n of this.NavBar.instances)this.updateButton(n);for(const n of this.SquadBar.instances)this.updateButton(n);for(const n of this.MultiController.instances)this.updateButton(n);for(const n of this.SunlightNav.instances)this.updateButton(null,n,!0);for(const n of this.ModBar.instances)this.updateButton(n)}onEnable(){this.NavBar.ready(()=>this.update()),this.NavBar.on("mount",this.updateButton,this),this.NavBar.on("update",this.updateButton,this),this.SquadBar.ready(()=>this.update()),this.SquadBar.on("mount",this.updateButton,this),this.SquadBar.on("update",this.updateButton,this),this.MultiController.ready(()=>this.update()),this.MultiController.on("mount",this.updateButton,this),this.MultiController.on("update",this.updateButton,this),this.SunlightNav.on("mount",n=>this.updateButton(null,n,!0)),this.SunlightNav.on("mutate",n=>this.updateButton(null,n,!0)),this.SunlightNav.each(n=>this.updateButton(null,n,!0)),this.ModBar.ready(()=>this.update()),this.ModBar.on("mount",this.updateButton,this),this.ModBar.on("update",this.updateButton,this),this.on(":clicked",()=>this.important_update=!1),this.once(":clicked",this.loadMenu),this.on("i18n:new-strings",this.update),this.on("i18n:changed-strings",this.update),this.on("i18n:update",this.update),this.on("addons:data-loaded",this.update),this.once("settings:quota-exceeded",()=>{this.addError("site.menu_button.quota-exceeded","Your local storage space for this website is full, and settings cannot be saved. Please backup your settings and switch to a higher capacity provider in [Data Management > Storage >> Provider](~data_management.storage.tabs.provider).","ffz-i-attention",!0),this.update()}),this.on("settings:change-provider",()=>{this.addError("site.menu_button.changed","The FrankerFaceZ settings provider has changed. Please refresh this tab to avoid strange behavior."),this.update()})}addError(n,s,i="ffz-i-attention",e=!1){this.addToast({icon:i,text_i18n:n,text:s,markdown:e})}addToast(n){if(n.markdown&&!(0,A.e)())return(0,A.Z)().then(()=>this.addToast(n));this.toasts.push(n),!(this.toasts.length>5)&&this.updateToasts()}pauseToasts(){const n=Math.min(5,this.toasts.length),s=performance.now();this._toasts_paused=!0;for(let i=0;i<n;i++){const e=this.toasts[i];if(!e||!e.started)continue;e._timer&&(clearTimeout(e._timer),e._timer=null);const o=s-e.started,a=e.timeout-o;e.remaining=a,e.percentage=100*a/e.timeout,e.el&&e.el.replaceWith(this.renderToast(e))}}unpauseToasts(){const n=Math.min(5,this.toasts.length),s=performance.now();this._toasts_paused=!1;for(let i=0;i<n;i++){const e=this.toasts[i];if(!(!e||!e.started)){if(e.remaining){const o=e.timeout-e.remaining;e.started=s-o}e.el&&e.el.replaceWith(this.renderToast(e))}}}renderToasts(){const n=Math.min(5,this.toasts.length);if(!n)return null;const s=[];for(let i=0;i<n;i++)s.push(this.renderToast(this.toasts[i]));return s}renderToast(n){n._remove||(n._remove=()=>{n._timer&&(clearTimeout(n._timer),n._timer=null),n.el=null;const e=this.toasts.indexOf(n);e!==-1&&(this.toasts.splice(e,1),this.toasts.length||(this._toasts_paused=!1),this.updateToasts())});let s=null;const i=n.markdown?(0,A.e)():null;if(n.markdown&&!i)return null;if(n.timeout){const e=performance.now();n.started||(n.started=e);const o=e-n.started,a=n.timeout-o;let c;this._toasts_paused?c=n.percentage:n._timer||(n._timer=setTimeout(n._remove,a)),c==null&&(c=n.percentage=100*a/n.timeout),s=(0,_.createElement)("div",{class:"ffz-toast--progress tw-absolute tw-overflow-hidden tw-z-below"},(0,_.createElement)("div",{class:"tw-border-radius-rounded ffz-progress-bar ffz-progress-bar--countdown ffz-progress-bar--default ffz-progress-bar--mask",role:"progressbar","aria-valuenow":c,"aria-valuemin":"0","aria-valuemax":"100"},(0,_.createElement)("div",{class:"tw-block tw-border-bottom-left-radius-rounded tw-border-top-left-radius-rounded ffz-progress-bar__fill","data-a-target":"tw-progress-bar-animation",style:{width:`${c}%`,"animation-duration":`${a/1e3}s`}})))}return n.el=(0,_.createElement)("div",{class:`ffz-toast ffz-balloon ffz-balloon--lg tw-mg-y-1${this._toasts_paused?" ffz-toast--paused":""}`},(0,_.createElement)("div",{class:"tw-pd-1 tw-border-radius-large tw-c-background-base tw-c-text-inherit tw-elevation-4 tw-relative"},(0,_.createElement)("div",{class:"tw-flex tw-align-items-start"},n.icon&&(typeof n.icon=="string"?(0,_.createElement)("figure",{class:`tw-font-size-3 tw-pd-r-1 ${n.icon}`}):n.icon),n.render?n.render.call(this,n):null,n.title||n.text?(0,_.createElement)("div",{class:"tw-flex-grow-1"},n.title?(0,_.createElement)("header",{class:"tw-semibold tw-font-size-3 tw-pd-b-05"},n.title_i18n?this.i18n.tList(n.title_i18n,n.title,n):n.title):null,n.text?(0,_.createElement)("span",{class:`${n.lines?"ffz--line-clamp":""}`,style:{"--ffz-lines":n.lines}},n.markdown?(0,_.createElement)("span",{dangerouslySetInnerHTML:{__html:(0,A.e)().render(n.text_i18n?this.i18n.t(n.text_i18n,n.text,n):n.text)}}):null,n.markdown?null:n.text_i18n?this.i18n.tList(n.text_i18n,n.text,n):n.text):null):null,!n.unclosable&&(0,_.createElement)("button",{class:"tw-button-icon tw-mg-l-05 tw-relative ffz-il-tooltip__container",onClick:n._remove},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-cancel"})))),s)),n.el}updateButtonToast(n,s,i){const e=(n||s)._ffz_toast_el;if(e){e.innerHTML="",(0,_.setChildren)(e,this.renderToasts(),!1,!0);return}this.updateButton(n,s,i)}updateButton(n,s,i){const e=this.fine.getChildNode(n);let o=!1,a=!1;if(s||(s=e&&e.querySelector(".top-nav__menu")),s||(e&&e.classList.contains("squad-stream-top-bar__container")?s=e:s=e&&e.querySelector(".squad-stream-top-bar__container"),s&&(o=!0)),!s&&n.handleAddStream&&(s=this.fine.searchTree(n,z=>z.classList&&z.classList.contains("multiview-stream-page__header")),s&&(o=!0)),!s&&n.getIsAdsEnabled&&(s=e&&e.querySelector(".sunlight-top-nav > .tw-flex > .tw-flex > .tw-justify-content-end > .tw-flex"),s&&(i=!0)),!s&&n.childContext&&(s=e&&e.querySelector(".modview-dock > div:last-child"),s&&(a=!0)),!s)return;if(!o&&!a&&!i){let z=null;try{z=s.querySelector(":scope > .tw-justify-content-end:last-child")}catch{}z?s=z:s=s.lastElementChild}let c,d=s.querySelector(".ffz-top-nav");d&&d.remove();const m=this.resolve("addons"),w=this.renderToasts(),h=this.formatPill(),p=this.formatExtraPill();if(d=(0,_.createElement)("div",{class:`ffz-top-nav ${a?"ffz-mod-view-button tw-relative tw-mg-b-1":`tw-align-self-center tw-flex-grow-0 tw-flex-nowrap tw-flex-shrink-0 tw-relative ${i?"tw-mg-l-05 tw-mg-r-2":"tw-mg-x-05"}`}`},(0,_.createElement)("div",{class:"tw-inline-flex tw-relative ffz-il-tooltip__container"},c=(0,_.createElement)("button",{class:`tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative${this.loading?" loading":""}`,onClick:z=>this.handleClick(z,c),onContextMenu:z=>this.renderContext(z,c)},(0,_.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-zreknarf"})))),this.has_error&&(0,_.createElement)("div",{class:`tw-absolute ffz-balloon ffz-balloon--lg tw-block ${a?"ffz-il-tooltip--up ffz-il-tooltip--align-left":"ffz-il-tooltip--down ffz-il-tooltip--align-right"}`},(0,_.createElement)("div",{class:"tw-border-radius-large tw-c-background-base tw-c-text-inherit tw-elevation-4 tw-pd-1"},(0,_.createElement)("div",{class:"tw-flex tw-align-items-center"},(0,_.createElement)("div",{class:"tw-flex-grow-1"},this.error.i18n?this.i18n.t(this.error.i18n,this.error.text):this.error.text),this.error.permanent?null:(0,_.createElement)("button",{class:"tw-button-icon tw-mg-l-05 tw-relative ffz-il-tooltip__container",onClick:()=>this.error=null},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-cancel"})))))),(0,_.createElement)("div",{class:`ffz-il-tooltip ${a?"ffz-il-tooltip--up ffz-il-tooltip--align-left":"ffz-il-tooltip--down ffz-il-tooltip--align-right"}`},this.i18n.t("site.menu_button","FrankerFaceZ Control Center"),this.has_update&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.t("site.menu_button.update-desc","There is an update available. Please refresh your page.")),this.settings.disable_profiles&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.tList("site.menu_button.no-settings",'Settings are disabled in this tab due to the inclusion of "{param}" in the URL.',{param:(0,_.createElement)("code",{class:"ffz-monospace"},"?ffz-no-settings")})),this._new_settings>0&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.t("site.menu_button.new-desc","There {count,plural,one {is one new setting} other {are # new settings}}.",{count:this._new_settings})),this.has_strings&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.t("site.menu_button.strings","There {added,plural,one {is # new string} other {are # new strings}} and {changed,plural,one {# changed string} other {# changed strings}}.",{added:this.i18n.new_strings,changed:this.i18n.changed_strings})),N.DEBUG&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.t("site.menu_button.main-dev-desc","You are running a developer build of FrankerFaceZ.")),m.has_dev&&(0,_.createElement)("div",{class:"tw-mg-t-1"},this.i18n.t("site.menu_button.addon-dev-desc","You have loaded add-on data from a local development server.")))),(n||s)._ffz_toast_el=(0,_.createElement)("div",{class:`ffz-toast--container tw-absolute tw-block ${a?"ffz-il-tooltip--up ffz-il-tooltip--align-left":"ffz-il-tooltip--down ffz-il-tooltip--align-right"}`,onmouseenter:this.pauseToasts,onmouseleave:this.unpauseToasts},w),this.has_update&&(0,_.createElement)("div",{class:"ffz-menu__extra-pill tw-absolute"},(0,_.createElement)("div",{class:`tw-pill ${this.important_update?"tw-pill--notification":""}`},(0,_.createElement)("figure",{class:"ffz-i-arrows-cw"}))),p&&(0,_.createElement)("div",{class:"ffz-menu__extra-pill tw-absolute"},(0,_.createElement)("div",{class:"tw-pill"},p)),h&&(0,_.createElement)("div",{class:"ffz-menu__pill tw-absolute"},(0,_.createElement)("div",{class:"tw-pill"},h))),a)s.insertBefore(d,s.firstElementChild);else{let z=s.lastElementChild;z&&z.classList.contains("resize-detector")&&(z=z.previousElementSibling),z?s.insertBefore(d,z):s.appendChild(d)}this._ctx_open&&this.renderContext(null,c)}handleClick(n,s){if(n.shiftKey)return N.DEBUG&&n.ctrlKey?requestAnimationFrame(()=>this.i18n.openUI()):this.resolve("main_menu").openPopout();this.emit(":clicked",n,s)}renderButtonIcon(n){const s=this.settings.main_context.hasProfile(n);return(0,_.createElement)("figure",{class:`ffz--profile__icon ${s?"ffz-i-ok":n.toggled?"ffz-i-minus":"ffz-i-cancel"}`})}renderButtonTip(n){return n.toggled?this.settings.main_context.hasProfile(n)?this.i18n.t("setting.profiles.active","This profile is enabled and active."):this.i18n.t("setting.profiles.disabled.rules","This profile is enabled, but inactive due to its rules."):this.i18n.t("setting.profiles.disabled","This profile is disabled.")}renderContext(n,s){if(n){if(n.shiftKey||n.ctrlKey)return;n.preventDefault()}const i=s.parentElement.parentElement,e=i.classList.contains("ffz-mod-view-button");let o=i.querySelector(".ffz--menu-context");if(o)if(o._ffz_destroy)o._ffz_destroy();else return;const a=$(()=>{this._ctx_open=!1,o._ffz_outside&&o._ffz_outside.destroy(),o.remove()},"destroy"),c=[];for(const d of this.settings.__profiles){const m=(0,_.createElement)("button",{class:"tw-flex-shrink-0 tw-mg-r-1 tw-align-items-center tw-align-middle tw-border-radius-medium tw-button-icon tw-button-icon--secondary ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-relative ffz-tooltip ffz-tooltip--no-mouse","data-title":this.renderButtonTip(d),onClick:h=>{d.toggled=!d.toggled,(0,_.setChildren)(m,this.renderButtonIcon(d)),m.dataset.title=this.renderButtonTip(d),m._ffz_tooltip?.rerender&&m._ffz_tooltip.rerender(),this.emit("tooltips:cleanup"),h.preventDefault(),h.stopPropagation()}},this.renderButtonIcon(d)),w=d.desc_i18n_key||d.i18n_key&&`${d.i18n_key}.description`;c.push((0,_.createElement)("div",{class:"tw-relative tw-border-b tw-pd-y-05 tw-pd-x-1 tw-flex"},m,(0,_.createElement)("div",null,(0,_.createElement)("h4",null,d.i18n_key?this.i18n.t(d.i18n_key,d.name,d):d.name,d.ephemeral&&(0,_.createElement)("div",{class:"tw-inline tw-mg-l-05 ffz-il-tooltip__container ffz--profile-row__icon ffz-i-user-secret tw-relative"},(0,_.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},this.i18n.t("setting.profiles.ephemeral","This profile is ephemeral.")))),d.description&&(0,_.createElement)("div",{class:"description"},w?this.i18n.t(w,d.description,d):d.description))))}o=(0,_.createElement)("div",{class:`tw-absolute ffz-attached ${e?"ffz-attached--up ffz-attached--left":"ffz-attached--down ffz-attached--right"}`},(0,_.createElement)("div",{class:"ffz-balloon ffz-balloon--lg tw-block ffz--menu-context"},(0,_.createElement)("div",{class:"tw-border-radius-large tw-c-background-base tw-c-text-inherit tw-elevation-4"},(0,_.createElement)("div",{class:"tw-c-text-base tw-elevation-1 tw-flex tw-flex-shrink-0 tw-pd-x-1 tw-pd-y-05 tw-popover-header"},(0,_.createElement)("div",{class:"tw-flex tw-flex-column tw-justify-content-center tw-mg-l-05 tw-popover-header__icon-slot--left"},(0,_.createElement)("div",{class:"tw-inline-flex tw-relative ffz-il-tooltip__container"},(0,_.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-radius-medium tw-button-icon tw-button-icon--secondary ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden",onDblClick:()=>{this.emit("site.player:reset"),a()}},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-t-reset"}))),(0,_.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},this.i18n.t("player.reset_button.all","Reset All Players (Double-Click)")))),(0,_.createElement)("div",{class:"tw-align-items-center tw-flex tw-flex-column tw-flex-grow-1 tw-justify-content-center"},(0,_.createElement)("h5",{class:"tw-align-center tw-c-text-alt tw-semibold"},this.i18n.t("site.menu_button.profiles","Profiles"))),(0,_.createElement)("div",{class:"tw-flex tw-flex-column tw-justify-content-center tw-mg-l-05 tw-popover-header__icon-slot--right"},(0,_.createElement)("div",{class:"tw-inline-flex tw-relative ffz-il-tooltip__container"},(0,_.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-radius-medium tw-button-icon tw-button-icon--secondary ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden",onClick:d=>{this.openSettings(d,s),a()}},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-cog"}))),(0,_.createElement)("div",{class:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},this.i18n.t("setting.profiles.configure","Configure")))),(0,_.createElement)("div",{class:"tw-flex tw-flex-column tw-justify-content-center tw-mg-l-05 tw-popover-header__icon-slot--right"},(0,_.createElement)("button",{class:"tw-align-items-center tw-align-middle tw-border-radius-medium tw-button-icon tw-button-icon--secondary ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",onClick:a},(0,_.createElement)("span",{class:"tw-button-icon__icon"},(0,_.createElement)("figure",{class:"ffz-i-cancel"}))))),(0,_.createElement)("div",{class:"center-window__long-scrollable-area scrollable-area scrollable-area--suppress-scroll-x","data-simplebar":!0},c)))),o._ffz_destroy=a,o._ffz_outside=new _.ClickOutside(o,a),i.appendChild(o),this._ctx_open=!0}openSettings(n,s){const i=this.resolve("main_menu");i&&(i.requestPage("data_management.profiles"),!i.showing&&this.emit(":clicked",n,s))}loadMenu(n,s,i){const e=this.resolve("main_menu");e&&(i&&e.requestPage(i),!e.showing&&(this.loading=!0,e.enable(n).then(()=>{this.loading=!1}).catch(o=>{this.log.capture(o),this.log.error("Error enabling main menu.",o),this.addError("site.menu_button.error","There was an error loading the FFZ Control Center. Please refresh and try again."),this.loading=!1,this.once(":clicked",this.loadMenu)})))}onDisable(){this.off("i18n:update",this.update),this.off(":clicked",this.loadMenu)}};$(v,"MenuButton");let b=v},94296:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>_});var N=f(22527),y=f(46949);const E=class E extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(...b){super(...b),this.inject("i18n"),this.inject("settings"),this.inject("site.channel"),this.inject("site.css_tweaks"),this.inject("site.fine"),this.inject("site.elemental"),this.inject("site.router"),this.inject("site.twitch_data"),this.inject("metadata"),this.inject("socket"),this.inject("pubsub"),this.should_enable=!0,this._cached_color=null,this._cached_channel=null,this._cached_id=null,this.Root=this.elemental.define("mod-view-root",".moderation-view-page",["mod-view"],{attributes:!0},1),this.ModInfoBar=this.elemental.define("mod-info-bar",".modview-player-widget__stream-info .simplebar-content",["mod-view"],{childNodes:!0,subtree:!0},1,3e4,!1),this.checkRoot=(0,y.debounce)(this.checkRoot,250),this.checkBar=(0,y.debounce)(this.checkBar,250)}onEnable(){this.Root.on("mount",this.updateRoot,this),this.Root.on("mutate",this.updateRoot,this),this.Root.on("unmount",this.removeRoot,this),this.Root.each(b=>this.updateRoot(b)),this.ModInfoBar.on("mount",this.updateBar,this),this.ModInfoBar.on("mutate",this.updateBar,this),this.ModInfoBar.on("unmount",this.removeBar,this),this.ModInfoBar.each(b=>this.updateBar(b)),this.router.on(":route",this.checkNavigation,this),this.checkNavigation()}updateSubscription(b,v){this._subbed_login===v&&this._subbed_id===b||(this._subbed_id&&(this.pubsub.unsubscribe(this,`twitch/${this._subbed_id}`),this._subbed_id=null),this._subbed_login&&(this.socket.unsubscribe(this,`channel.${this._subbed_login}`),this._subbed_login=null),b&&(this.pubsub.subscribe(this,`twitch/${b}`),this._subbed_id=b),v&&(this.socket.subscribe(this,`channel.${v}`),this._subbed_login=v))}checkNavigation(){this.router.current_name==="mod-view"&&(this.channel.updateChannelColor(this._cached_color),this.checkRoot())}checkBar(){this.ModInfoBar.clean()}checkRoot(){this.Root.each(b=>this.updateRoot(b))}updateRoot(b){const v=this.fine.getReactInstance(b);let r=null,n=v,s=0,i;for(;n!=null&&r==null&&s<10;){let e=n.memoizedState;for(i=0;e!=null&&r==null&&i<50;)r=e?.memoizedState?.current?.result?.data?.user??e?.memoizedState?.current?.previousData?.user,e=e?.next,i++;n=n?.child,s++}r?.id?this._cached_id!=r.id&&(this._cached_id=r.id,this._cached_channel=r,this._cached_color=null,this.updateSubscription(r.id,r.login),this.getChannelColor(b,r.id).then(e=>{this._cached_id==r.id&&(this._cached_color=e,this.channel.updateChannelColor(e),this.settings.updateContext({channelColor:e}))}).catch(()=>{this._cached_id==r.id&&(this._cached_color=null,this.channel.updateChannelColor(),this.settings.updateContext({channelColor:null}))}),this.settings.updateContext({channel:r.login,channelID:r.id})):this.removeRoot()}getChannelColor(b,v,r){const n=b._ffz_color_cache=b._ffz_color_cache||{};return v===n.channel_id&&Date.now()-n.saved<6e4?r?n.data:Promise.resolve(n.data):new Promise(async(s,i)=>{if(n.updating){n.updating.push([s,i]);return}n.channel_id=v,n.updating=[[s,i]];let e,o;try{e=await this.twitch_data.getChannelColor(v)}catch(c){e=null,o=c}const a=n.updating;if(n.updating=null,n.channel_id!==v){o=new Error("Outdated"),n.channel_id=null,n.data=null,n.saved=0;for(const c of a)c[1](o);return}n.data=e,n.saved=Date.now();for(const c of a)o?c[1](o):c[0](e)})}removeRoot(){this._cached_id=null,this._cached_channel=null,this._cached_color=null,this.updateSubscription(),this.channel.updateChannelColor(),this.settings.updateContext({channel:null,channelID:null,channelColor:null})}updateBar(b){const v=b.closest(".modview-player-widget__stream-info"),r=v&&this.fine.getReactInstance(v);let n=null,s=r?.return?.memoizedState,i=0;for(;s!=null&&n==null&&i<50;)n=s?.memoizedState?.current?.result?.data?.channel??s?.memoizedState?.current?.previousData?.channel,s=s?.next,i++;const e=n?.lastBroadcast,o=e?.title,a=e?.game;if(this._cached_bar_id!=n?.id&&(this._cached_bar_id=n?.id,this._cached_bar_channel=n),(o!=b._cached_title||a?.id!=b._cached_game)&&(b._cached_title=o,b._cached_game=a?.id,this.settings.updateContext({category:a?.name,categoryID:a?.id,title:o})),v){if(!v._ffz_cont){const c=v._ffz_cont=v.querySelector(".modview-player-widget__viewcount");c&&c.classList.add("ffz--mod-tray")}this.updateMetadata(v)}}removeBar(b){this.settings.updateContext({category:null,categoryID:null,title:null});const v=b.closest(".modview-player-widget__stream-info");if(v){if(v._ffz_cont&&v._ffz_cont.classList.remove("ffz--mod-tray"),v._ffz_cont=null,v._ffz_meta_timers){for(const r of Object.values(v._ffz_meta_timers))clearTimeout(r);v._ffz_meta_timers=null}v._ffz_update=null}}updateMetadata(b,v){const r=b._ffz_cont,n=this._cached_bar_channel;if(!r||!document.contains(r)){this.checkBar();return}if(!n?.id)return;v?Array.isArray(v)||(v=[v]):v=this.metadata.keys;const s=b._ffz_meta_timers=b._ffz_meta_timers||{},i=$(o=>this.updateMetadata(b,o),"refresh_fn"),e={channel:{id:n.id,login:n.login,display_name:n.displayName},el:b,getViewerCount:()=>0,getUserSelfImmediate:()=>null,getUserSelf:()=>null,getBroadcastID:()=>null};for(const o of v)this.metadata.definitions[o].modview&&this.metadata.renderLegacy(o,e,r,s,i)}};$(E,"ModView");let _=E},63155:(q,T,f)=>{"use strict";f.r(T),f.d(T,{PLAYER_ROUTES:()=>y,default:()=>_});var N=f(10789);const y=/^8(102|363)$/.test(f.j)?["front-page","user","video","user-video","user-clip","user-videos","user-clips","user-collections","user-events","user-followers","user-following","dash","squad","command-center","dash-stream-manager","mod-view","user-home"]:null,E=class E extends(/^8(102|363)$/.test(f.j)?N.Z:null){constructor(...b){super(...b),this.should_enable=!0,this.inject("site.router"),this.inject("metadata"),this.DataSource=this.fine.define("data-source",v=>v.consentMetadata&&v.onPlaying&&v.props&&v.props.data,y),this.Player=this.fine.define("highwind-player",v=>v.setPlayerActive&&v.props?.playerEvents&&v.props?.mediaPlayerInstance,y),this.TheatreHost=this.fine.define("theatre-host",v=>v.toggleTheatreMode&&v.props&&v.props.onTheatreModeEnabled,["user","user-home","video","user-video","user-clip"]),this.PlayerSource=this.fine.define("player-source",v=>v.setSrc&&v.setInitialPlaybackSettings,y)}repositionPlayer(){if(!this._mover){const b=document.querySelector(".channel-root__player");this._mover=this.fine.searchNode(b,v=>v.memoizedProps?.triggerPlayerReposition,50)}this._mover&&this._mover.memoizedProps.triggerPlayerReposition()}registerSettings(){super.registerSettings(),this.settings.add("player.home.autoplay",{default:!0,ui:{path:"Player > General >> Playback",title:"Auto-play featured broadcasters on the front page.",component:"setting-check-box"}}),this.settings.add("player.theatre.no-whispers",{default:!1,requires:["whispers.show"],process(b,v){return b.get("whispers.show")?v:!0},ui:{path:"Player > General >> Theatre Mode",title:"Hide whispers when Theatre Mode is enabled.",component:"setting-check-box"},changed:b=>this.css_tweaks.toggle("theatre-no-whispers",b)}),this.settings.add("player.theatre.metadata",{default:!1,requires:["context.route.name","layout.is-theater-mode"],process(b,v){return!b.get("layout.is-theater-mode")||b.get("context.route.name")==="video"?!1:v},ui:{path:"Player > General >> Theatre Mode",title:"Show metadata when mousing over the player.",component:"setting-check-box"},changed:b=>this.css_tweaks.toggle("theatre-metadata",b)}),this.settings.add("player.theatre.auto-enter",{default:!1,ui:{path:"Player > General >> Theatre Mode",title:"Automatically open Theatre Mode when visiting a channel.",component:"setting-check-box"}}),this.settings.add("player.fullscreen.auto-chat",{default:!1,ui:{path:"Player > General >> Fullscreen",title:"Automatically expand chat when entering fullscreen mode.",component:"setting-check-box"}}),this.settings.add("player.hide-event-bar",{default:!1,ui:{path:"Channel > Appearance >> General",title:"Hide the Event Bar",description:"Hide the Event Bar which appears above the player when there is an ongoing event for the current channel.",component:"setting-check-box"},changed:b=>{this.css_tweaks.toggleHide("player-event-bar",b),this.repositionPlayer()}})}async onEnable(){await super.onEnable(),this.css_tweaks.toggle("theatre-no-whispers",this.settings.get("player.theatre.no-whispers")),this.css_tweaks.toggle("theatre-metadata",this.settings.get("player.theatre.metadata")),this.css_tweaks.toggleHide("player-event-bar",this.settings.get("player.hide-event-bar")),this.on(":fix-player",this.repositionPlayer,this),this.on("site:fullscreen",this.maybeOpenChat,this),this.TheatreHost.on("mount",b=>{b._ffz_theater_start=Date.now(),this.tryTheatreMode(b)}),this.TheatreHost.on("update",this.tryTheatreMode,this),this.TheatreHost.ready((b,v)=>{const r=Date.now();for(const n of v)n._ffz_theater_start=r,this.tryTheatreMode(n)}),this.PlayerSource.on("mount",this.checkCarousel,this),this.PlayerSource.on("update",this.checkCarousel,this)}maybeOpenChat(){this.settings.get("player.fullscreen.auto-chat")&&this.parent.awaitElement(".right-column--collapsed .right-column__toggle-visibility button",document.fullscreenElement,1e3).then(b=>b.click())}shouldStopAutoplay(){return this.settings.get("player.no-autoplay")||!this.settings.get("player.home.autoplay")&&this.router.current?.name==="front-page"}checkCarousel(b){}getData(){return this.DataSource.first}tryTheatreMode(b){b._ffz_theater_timer||(b._ffz_theater_timer=setTimeout(()=>{b._ffz_theater_timer=null,!(!this.settings.get("player.theatre.auto-enter")||!b._ffz_mounted)&&this.router.current_name==="user"&&(b.props.channelHomeLive||b.props.channelHomeCarousel||b.props.theatreModeEnabled||Date.now()-(b._ffz_theater_start||0)>2e3||b.props.onTheatreModeEnabled&&b.props.onTheatreModeEnabled())},250))}repositionPlayer(){}updateSquadContext(){this.settings.updateContext({squad_bar:this.hasSquadBar})}get hasSquadBar(){return!1}};$(E,"Player");let _=E},24020:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=f(22527),y=f(44589),_=f(14873);const E=f.p+"color_normalizer.css",A=["product","prime","turbo"],b=[-.62,-.578,-.539,-.469,-.4,-.32,-.21,-.098,0,.08,.151,.212,.271,.31,.351],v=":root{color-scheme: only light}",r=":root{forced-color-adjust: none}",n={dark:{c:{"background-brand":11,"background-accent":8,"background-accent-alt":7,"background-accent-alt-2":6,"background-button":7,"background-button-active":7,"background-button-focus":8,"background-button-hover":8,"background-button-primary-active":7,"background-button-primary-default":9,"background-button-primary-hover":8,"background-chat":1,"background-chat-alt":3,"background-chat-header":2,"background-graph":2,"background-graph-fill":8,"background-input-checkbox-checked":10,"background-input-checked":8,"background-interactable-selected":9,"background-modal":3,"background-progress-countdown-status":9,"background-progress-status":9,"background-range-fill":10,"background-subscriber-stream-tag-active":4,"background-subscriber-stream-tag-default":4,"background-subscriber-stream-tag-hover":3,"background-toggle-checked":2,"background-toggle-handle-checked":10,"background-top-nav":6,"border-brand":9,"border-button":7,"border-button-active":8,"border-button-focus":9,"border-button-hover":8,"border-input-checkbox-checked":10,"border-input-checkbox-focus":10,"border-input-focus":10,"border-interactable-selected":10,"border-range-handle":10,"border-subscriber-stream-tag":5,"border-tab-active":11,"border-tab-focus":11,"border-tab-hover":11,"border-toggle-checked":10,"border-toggle-focus":10,"border-whisper-incoming":10,"fill-brand":9,"text-button-text-active":"o2","text-link":10,"text-link-active":10,"text-link-focus":10,"text-link-hover":10,"text-link-visited":10,"text-overlay-link-active":13,"text-overlay-link-focus":13,"text-overlay-link-hover":13,"text-tab-active":11,"text-toggle-checked-icon":10,"text-tooltip":1,"text-button-text":10},s:{"button-active":[8," 0 0 6px 0",""],"button-focus":[8," 0 0 6px 0",""],input:[5," inset 0 0 0 1px",""],"input-focus":[8," 0 0 10px -2px",""],"interactable-focus":[8," 0 0 6px 0",""],"tab-focus":[11," 0 4px 6px -4px",""]}},light:{c:{"background-accent":8,"background-accent-alt":7,"background-accent-alt-2":6,"background-button":7,"background-button-active":7,"background-button-focus":8,"background-button-hover":8,"background-button-primary-active":7,"background-button-primary-default":9,"background-button-primary-hover":8,"background-chat":1,"background-chat-alt":3,"background-chat-header":2,"background-graph":15,"background-graph-fill":9,"background-input-checkbox-checked":9,"background-input-checked":8,"background-interactable-selected":9,"background-modal":3,"background-progress-countdown-status":8,"background-progress-status":8,"background-range-fill":9,"background-subscriber-stream-tag-active":13,"background-subscriber-stream-tag-default":13,"background-subscriber-stream-tag-hover":14,"background-toggle-checked":15,"background-top-nav":7,"background-toggle-handle-checked":10,"border-brand":9,"border-button":7,"border-button-active":8,"border-button-focus":9,"border-button-hover":8,"border-input-checkbox-checked":9,"border-input-checkbox-focus":9,"border-input-focus":9,"border-interactable-selected":9,"border-range-handle":9,"border-subscriber-stream-tag":10,"border-tab-active":8,"border-tab-focus":8,"border-tab-hover":8,"border-toggle-checked":9,"border-toggle-focus":9,"border-whisper-incoming":10,"fill-brand":9,"text-button-text-active":"o2","text-link":8,"text-link-active":9,"text-link-focus":9,"text-link-hover":9,"text-link-visited":9,"text-overlay-link-active":13,"text-overlay-link-focus":13,"text-overlay-link-hover":13,"text-tab-active":8,"text-toggle-checked-icon":9,"text-tooltip":1,"text-button-text":8,"background-tooltip":1,"text-button-text-focus":"o1","text-button-text-hover":"o1"},s:{"button-active":[8," 0 0 6px 0",""],"button-focus":[8," 0 0 6px 0",""],input:[5," inset 0 0 0 1px",""],"input-focus":[10," 0 0 10px -2px",""],"interactable-focus":[8," 0 0 6px 1px",""],"tab-focus":[8," 0 4px 6px -4px",""]}},accent_dark:{c:{"accent-hover":10,accent:9,"accent-primary-1":1,"accent-primary-2":5,"accent-primary-3":6,"accent-primary-4":7,"accent-primary-5":8},s:{}},accent_light:{c:{"accent-hover":10,accent:9,"accent-primary-1":1,"accent-primary-2":5,"accent-primary-3":6,"accent-primary-4":7,"accent-primary-5":8},s:{}}},i=class i extends N.default{constructor(...o){super(...o),this.inject("settings"),this.inject("site"),this.inject("site.fine"),this.inject("site.css_tweaks"),this.inject("site.router"),this.should_enable=!0,this.settings.add("theme.high-contrast-tweaks",{default:null,requires:["context.is-forced-colors","theme.disable-high-contrast"],process(a,c){return c===null?a.get("theme.disable-high-contrast")?!1:a.get("context.is-forced-colors")??!1:c},ui:{path:"Appearance > Theme >> Tweaks",title:"Enable the use of High Contrast tweaks.",description:"This loads an additional set of styles when Forced Color / OS High Contrast mode is enabled to ensure page elements are displayed more appropriately.",component:"setting-check-box"}}),this.settings.add("theme.disable-high-contrast",{default:!1,ui:{path:"Appearance > Theme >> Tweaks",title:"Disable Forced Color / OS High Contrast",component:"setting-check-box",description:"Enabling this will instruct your browser to not respect your operating system's High Contrast settings when displaying Twitch. You may need to refresh for this to take full effect."},changed:()=>this.updateCSS()}),this.settings.add("theme.disable-auto-dark",{default:!1,ui:{path:'Appearance > Theme >> Tweaks @{"sort": 10}',title:"Disable Auto Dark Theme",component:"setting-check-box",description:"Enabling this will attempt to disable a browser's built-in automatic dark theme conversion for websites, which is unnecessary on Twitch and can cause display issues. This may not apply depending on your web browser and settings."},changed:()=>this.updateCSS()}),this.settings.add("theme.legacy-dark-input",{default:!1,ui:{path:"Appearance > Theme >> Tweaks",title:"Use old input element colors with dark theme.",component:"setting-check-box"},changed:()=>this.updateCSS()}),this.settings.add("theme.font.size",{default:13,process(a,c){if(typeof c!="number")try{c=parseFloat(c)}catch{c=null}return(!c||c<1||isNaN(c)||!isFinite(c)||c>25)&&(c=13),c},ui:{path:'Appearance > Theme >> Fonts @{"sort": 2}',title:"Font Size",description:"**Minimum:** `1`, **Maximum:** `25`, *Old Default:* `12`\n\nHow large should normal text be, in pixels. This may be affected by your browser's zoom and font settings.",component:"setting-text-box",type:"number"},changed:()=>this.updateFont()}),this.settings.add("theme.color.background",{default:"",ui:{path:'Appearance > Theme >> Colors @{"sort": 0, "description": "This is a quick preview of a new system coming soon to FrankerFaceZ. Expect heavy changes here, including separate Basic and Advanced modes, and better color selection."}',title:"Background",description:"Try `#0E0C13` for something close to the old dark theme, or `#0E0E0E` for a nice dark gray. Transparent colors not allowed.",component:"setting-color-box",sort:0,alpha:!1},changed:()=>this.updateCSS()}),this.settings.add("theme.color.text",{default:"",ui:{path:"Appearance > Theme >> Colors",title:"Text",description:"If not set, this will automatically be set to white or black based on the brightness of the background.",component:"setting-color-box",sort:1},changed:()=>this.updateCSS()}),this.settings.add("theme.color.accent",{default:"",ui:{path:"Appearance > Theme >> Colors",title:"Accent",description:"The accent color is used for buttons, links, etc.",component:"setting-color-box",alpha:!1,sort:2},changed:()=>this.updateCSS()}),this.settings.add("theme.color.tooltip.background",{default:"",ui:{path:"Appearance > Theme >> Colors",title:"Tooltip Background",description:"If not set, the tooltip settings will be automatically adjusted based on the brightness of the background.",component:"setting-color-box",alpha:!0,sort:10},changed:()=>this.updateCSS()}),this.settings.add("theme.color.tooltip.text",{default:"",ui:{path:"Appearance > Theme >> Colors",title:"Tooltip Text",component:"setting-color-box",sort:11},changed:()=>this.updateCSS()}),this.settings.add("theme.color.chat-background",{default:"",ui:{path:'Appearance > Theme >> Chat Colors @{"sort":1}',title:"Background",component:"setting-color-box",sort:0,alpha:!1},changed:()=>this.updateCSS()}),this.settings.add("theme.color.chat-text",{default:"",ui:{path:"Appearance > Theme >> Chat Colors",title:"Text",description:"If not set, this will automatically be set to white or black based on the brightness of the background.",component:"setting-color-box",sort:1},changed:()=>this.updateCSS()}),this.settings.add("theme.color.chat-accent",{default:"",ui:{path:"Appearance > Theme >> Chat Colors",title:"Accent",description:"The accent color is used for buttons, links, etc.",component:"setting-color-box",alpha:!1,sort:2},changed:()=>this.updateCSS()}),this.settings.add("theme.can-dark",{requires:["context.route.name"],process(a){return!A.includes(a.get("context.route.name"))}}),this.settings.add("theme.is-dark",{requires:["context.force-dark","theme.can-dark","context.ui.theme","context.ui.theatreModeEnabled","context.route.name","context.location.search"],process(a){const c=a.get("context.force-theme");return c??(a.get("context.route.name")==="embed-chat"?(a.get("context.location.search")||"").includes("dark"):a.get("context.ui.theatreModeEnabled")||a.get("theme.can-dark")&&a.get("context.ui.theme")===1)},changed:()=>this.updateCSS()}),this.settings.add("theme.tooltips-dark",{requires:["theme.is-dark"],process(a){return!a.get("theme.is-dark")}}),this._style=null,this._normalizer=null}updateFont(){let o=this.settings.get("theme.font.size");if(typeof o=="string"&&/^[0-9.]+$/.test(o)?o=parseFloat(o):typeof o!="number"&&(o=null),!o||isNaN(o)||!isFinite(o)||o<1||o===13){this.css_tweaks.delete("font-size");return}o=o/10,this.css_tweaks.set("font-size",`html body {
	--font-size-1: ${54/13*o}rem;
	--font-size-2: ${36/13*o}rem;
	--font-size-3: ${24/13*o}rem;
	--font-size-4: ${18/13*o}rem;
	--font-size-5: ${14/13*o}rem;
	--font-size-6: ${o}rem;
	--font-size-7: ${12/13*o}rem;
	--font-size-8: ${12/13*o}rem;
	--font-size-base: ${o}rem;
}
`)}generateBackgroundTextBlob(o){const a=o.toHSLA(),c=a.l,d=c<.5;return this.generateBackgroundBlob(o)+this.generateTextBlob(_.Color.RGBA.fromCSS(d?"#FFF":"#000"))}generateBackgroundBlob(o){const a=o.toHSLA(),c=a.l,d=c<.5;return[`--color-background-body:${o.toCSS()};`,`--color-background-input-focus:${o.toCSS()};`,`--color-background-base:${a._l(c+(d?.05:-.05)).toCSS()};`,`--color-background-alt:${a._l(c+(d?.1:-.1)).toCSS()};`,"--color-background-float:var(--color-background-alt);",`--color-background-alt-2:${a._l(c+(d?.15:-.15)).toCSS()};`].join("")}generateTextBlob(o){o.a<.4&&(o=o._a(.4));const a=o.a;return[`--color-text-base:${o.toCSS()};`,`--color-text-input:${o.toCSS()};`,`--color-text-label:${o.toCSS()};`,`--color-text-label-optional:${o._a(a-.4).toCSS()};`,`--color-text-alt:${o._a(a-.2).toCSS()};`,`--color-text-alt-2:${o._a(a-.4).toCSS()};`].join("")}generateAccentBlob(o,a){o.a<1&&(o=o._a(1));const c=o.toHSLA(),d=c.l,m=b.map(z=>z===0?o.toCSS():c._l(d+z).toCSS()),w=[],h=[];for(let z=0;z<m.length;z++)w.push(`--ffz-color-accent-${z+1}:${m[z]};`);let p=a?n.dark:n.light;for(const[z,R]of Object.entries(p.c))typeof R=="number"&&w.push(`--color-${z}:${m[R-1]};`);p=a?n.accent_dark:n.accent_light;for(const[z,R]of Object.entries(p.c))typeof R=="number"&&h.push(`--color-${z}:${m[R-1]} !important;`);return[w.join(""),h.join("")]}updateCSS(){if(this.settings.get("theme.disable-high-contrast")?this.css_tweaks.set("nofc",r):this.css_tweaks.delete("nofc"),this.settings.get("theme.disable-auto-dark")?this.css_tweaks.set("nodark",v):this.css_tweaks.delete("nodark"),this.css_tweaks.setVariable("border-color","var(--color-border-base)"),!this.settings.get("theme.can-dark")){this.toggleNormalizer(!1),this.toggleAccentNormal(!0),this.css_tweaks.delete("colors");return}let o=this.settings.get("theme.is-dark");const a=[],c=[],d=_.Color.RGBA.fromCSS(this.settings.get("theme.color.background"));if(d){d.a=1;const it=d.toHSLA();o=it.l<.5;try{const rt=this.resolve("site").store,mt=rt.getState().ui.theme,W=o?1:0;mt!==W&&rt.dispatch({type:"core.ui.THEME_CHANGED",theme:W})}catch(rt){this.log.warning("Unable to automatically set the Twitch Dark Theme state.",rt)}a.push(this.generateBackgroundBlob(it)),o&&(a.push("--color-border-base: var(--color-opac-gl-2);"),a.push("--color-background-interactable-hover: var(--color-opac-gl-1);"),a.push("--color-background-interactable-active: var(--color-opac-gl-2);"),a.push("--color-background-button-text-hover: var(--color-opac-gl-1);"),a.push("--color-background-button-text-active: var(--color-opac-gl-2);"))}let m=_.Color.RGBA.fromCSS(this.settings.get("theme.color.text"));!m&&d&&(m=_.Color.RGBA.fromCSS(o?"#FFF":"#000")),m&&a.push(this.generateTextBlob(m)),o&&this.settings.get("theme.legacy-dark-input")&&a.push(`--color-background-input: var(--color-opac-w-4);
--color-background-input-overlay: var(--color-opac-b-4);
--color-background-input-overlay-focus: var(--color-black);
--color-background-selectable: var(--color-opac-w-3);
--color-background-selectable-hover: var(--color-opac-w-4);
--color-border-input: var(--color-opac-w-4);
--color-border-input-hover: var(--color-opac-w-6);
--color-border-input-overlay: var(--color-opac-w-6);
--color-border-input-overlay-hover: var(--color-opac-w-8);
--color-border-input-checkbox: var(--color-opac-w-10);
--color-border-selectable: var(--color-opac-w-2);
--color-border-selectable-hover: var(--color-opac-w-3);`);const w=_.Color.RGBA.fromCSS(this.settings.get("theme.color.accent"));if(this.toggleAccentNormal(!w),w){const it=this.generateAccentBlob(w,o);a.push(it[0]),c.push(it[1])}let h=_.Color.RGBA.fromCSS(this.settings.get("theme.color.tooltip.background")),p;!h&&d&&(h=_.Color.RGBA.fromCSS(o?"#FFF":"#000")),h?(a.push(`--color-background-tooltip: ${h.toCSS()};`),p=h.toHSLA().l<.5):p=!o;let z=_.Color.RGBA.fromCSS(this.settings.get("theme.color.tooltip.text"));const R=z||h;if(z||(z=_.Color.RGBA.fromCSS(p?"#FFF":"#000")),z){R&&a.push(`--color-text-tooltip: ${z.toCSS()};`);const it=z.toHSLA(),ut=it.a;a.push(`--color-text-tooltip-alt: ${it._a(ut-.2).toCSS()};`),a.push(`--color-text-tooltip-alt-2: ${it._a(ut-.4).toCSS()};`)}const I=[],j=_.Color.RGBA.fromCSS(this.settings.get("theme.color.chat-background"));let F=o;if(j){j.a=1;const it=j.toHSLA();F=it.l<.5,I.push(this.generateBackgroundBlob(it))}let H=_.Color.RGBA.fromCSS(this.settings.get("theme.color.chat-text"));!H&&j&&(H=_.Color.RGBA.fromCSS(F?"#FFF":"#000")),H&&I.push(this.generateTextBlob(H));const Y=_.Color.RGBA.fromCSS(this.settings.get("theme.color.chat-accent")),st=[];if(Y){const it=this.generateAccentBlob(Y,F);I.push(it[0]),st.push(it[1])}I.length?this.css_tweaks.set("chat-colors",`.moderation-view-page-widget .stream-chat,.chat-shell {${I.join(`
`)}}.moderation-view-page-widget .stream-chat .tw-accent-region,.chat-shell .tw-accent-region{${st.join(`
`)}}`):this.css_tweaks.delete("chat-colors"),this.toggleNormalizer(I.length||a.length);const tt=o?"":":not(.settings-menu-button-component--forced-dark-theme)";a.length?this.css_tweaks.set("colors",`body,body .tw-root--theme-light,body .tw-root--theme-dark${tt} {${a.join(`
`)}}.channel-info-content .tw-accent-region,.channel-info-content div[class^="ScAccentRegion"]{${c.join(`
`)}}`):this.css_tweaks.delete("colors")}toggleAccentNormal(o){if(o){const a=[];for(let c=0;c<15;c++)a.push(`--ffz-color-accent-${c+1}:var(--color-twitch-purple-${c+1});`);this.css_tweaks.set("accent-normal",`body {${a.join(`
`)}}`)}else this.css_tweaks.delete("accent-normal")}toggleNormalizer(o){if(this._normalizer){if(!o){this._normalizer.remove();return}}else{if(!o)return;this._normalizer=(0,y.createElement)("link",{rel:"stylesheet",type:"text/css",href:E})}document.head.contains(this._normalizer)||document.head.appendChild(this._normalizer)}onEnable(){let o;try{o=window.matchMedia("(forced-colors: active)")?.matches}catch{}this.settings.updateContext({"is-forced-colors":o??!1}),this.settings.getChanges("theme.high-contrast-tweaks",a=>{this.css_tweaks.toggle("hc-tweaks",a)}),this.updateCSS(),this.updateFont()}};$(i,"ThemeEngine");let s=i},4948:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=f(46949);if(/^8(102|363)$/.test(f.j))var y=f(83269);var _=f(6172),E=f(22527),A=f(24431);const b=/^([^\s]+) subscribed ([^.]+)\. They've subscribed for (\d+) months(?:[^!]+streak)?!/,v={1e3:1,2e3:2,3e3:3};function r(i){try{/^[\d-]+$/.test(i)&&(i=parseInt(i,10))}catch{}return(typeof i!="number"||isNaN(i)||!isFinite(i))&&(i=0),i}$(r,"parseParamInt");const s=class s extends(/^8(102|363)$/.test(f.j)?E.default:null){constructor(...e){super(...e),this.should_enable=!0,this.inject("i18n"),this.inject("settings"),this.inject("site"),this.inject("site.router"),this.inject("site.fine"),this.inject("chat"),this.inject("chat.emotes"),this.inject("chat.overrides"),this.injectAs("site_chat","site.chat"),this.inject("site.chat.chat_line.rich_content"),this.VideoChatController=this.fine.define("video-chat-controller",o=>o.onError&&o.videoData&&o.props?.comments,["user-video","user-clip","video"]),this.VideoChatLine=this.fine.define("video-chat-line",o=>o.onTimestampClickHandler&&o.props?.messageContext,["user-video","user-clip","video"]),this.settings.add("chat.video-chat.timestamps",{default:!0,ui:{path:"Chat > Chat on Videos >> Appearance",title:"Display timestamps alongside chat messages.",component:"setting-check-box"}}),this.settings.add("chat.video-chat.enabled",{default:!0,ui:{path:'Chat > Chat on Videos @{"description": "This feature is currently in beta. As such, you may experience issues when using FFZ features with Chat on Videos."} >> General',title:"Enable FrankerFaceZ features for Chat on Videos.",description:"Display FFZ badges, emotes, and other features in Chat on Videos. Moderation features may be unavailable when this is enabled.",component:"setting-check-box"}}),this.active_room=null}async onEnable(){var d;this.chat.context.on("changed:chat.video-chat.enabled",this.rerenderLines,this),this.chat.context.on("changed:chat.video-chat.timestamps",this.rerenderLines,this),this.on("chat.overrides:changed",m=>this.updateLinesByUser(m,null,!1,!1),this),this.on("chat:update-lines-by-user",this.updateLinesByUser,this),this.on("chat:update-line",this.updateLineById,this),this.on("chat:update-lines",this.updateLines,this),this.on("chat:rerender-lines",this.rerenderLines,this),this.on("chat:update-line-tokens",this.updateLineTokens,this),this.on("chat:update-line-badges",this.updateLineBadges,this),this.on("i18n:update",this.rerenderLines,this),this.on("chat.emotes:update-effects",this.checkEffects,this);for(const m of A.RERENDER_SETTINGS)this.chat.context.on(`changed:${m}`,this.rerenderLines,this);for(const m of A.UPDATE_TOKEN_SETTINGS)this.chat.context.on(`changed:${m}`,this.updateLineTokens,this);for(const m of A.UPDATE_BADGE_SETTINGS)this.chat.context.on(`changed:${m}`,this.updateLineBadges,this);this.on("chat:get-messages",(m,w,h,p)=>{if(h)for(const z of this.VideoChatLine.instances){const R=z.props.messageContext;R.comment?._ffz_message&&p.push({message:R.comment._ffz_message,_instance:z,update:()=>z.forceUpdate()})}}),this.VideoChatController.on("mount",this.chatMounted,this),this.VideoChatController.on("unmount",this.chatUnmounted,this),this.VideoChatController.on("receive-props",this.chatUpdated,this),this.VideoChatController.ready((m,w)=>{for(const h of w)this.chatMounted(h)});const e=this,o=await this.site.findReact();if(!o)return;const a=o.createElement,c=this.rich_content&&this.rich_content.RichContent;this.MenuContainer=(d=class extends o.Component{constructor(w){super(w),this.onBanUser=()=>{this.props.onBanUserClick({bannedUser:this.props.context.comment.commenter,targetChannel:this.props.context.comment.channelId,comment:this.props.context.comment})},this.onDeleteComment=()=>{this.props.onDeleteCommentClick(this.props.context.comment)},this.onOpen=()=>{this.props.onDisableSync(),this.setState({force:!0})},this.onClose=()=>{this.setState({force:!1})},this.state={force:!1}}render(){return null}},$(d,"FFZMenuContainer"),d),this.VideoChatLine.ready(m=>{const w=m.prototype.render;m.prototype.ffzRenderMessage=function(h,p){const z=h.is_action,R=z?e.chat.context.get("chat.me-style"):0,I=R>=2,j=R===1||R===3,F=h.user,H=e.overrides.getColor(F.id)||F.color,Y=e.site_chat.colors.process(H),st=e.site.getUser();st&&(st.moderator=this.props.isCurrentUserModerator,st.staff=st.roles&&st.roles.isStaff);let tt;if(h.system_msg===!0){const at=h.params||{};if(at["msg-id"]==="resub"){const lt=e.chat.context.get("chat.subs.show"),ht=r(at["msg-param-months"]),pt=r(at["msg-param-cumulative-months"]),_t=pt||ht;if(e.log.info("resub-notice setting:",lt,"months:",_t,"cumulative:",pt,"raw:",ht),e.log.info("-> params:",at),lt===3||_t>1&&lt>0){const Ct=r(at["msg-param-should-share-streak"])===1,jt=at["msg-param-sub-plan"],It=jt==="Prime",oe=v[jt]||1;e.log.info("-> share:",Ct,"plan:",jt,"tier:",oe),tt=e.i18n.tList("chat.sub.main","{user} subscribed {plan}. ",{user:a("span",{class:"tw-c-text-base tw-strong"},F.displayName),plan:It?e.i18n.t("chat.sub.twitch-prime","with Prime Gaming"):e.i18n.t("chat.sub.plan","at Tier {tier}",{tier:oe})}),Ct&&ht>1?tt.push(e.i18n.t("chat.sub.cumulative-months","They've subscribed for {cumulative,number} months, currently on a {streak,number} month streak!",{cumulative:pt,streak:ht})):_t>1&&tt.push(e.i18n.t("chat.sub.months","They've subscribed for {count,number} months!",{count:_t}))}}}else h.system_msg&&(tt=h.system_msg);const it=h.ffz_tokens=h.ffz_tokens||e.chat.tokenizeMessage(h,st),ut=c&&e.chat.pluckRichContent(it,h),rt=e.chat.formatUser(F,a),mt=e.overrides.getName(F.id);let W=h.ffz_user_class;W instanceof Set?W=[...W].join(" "):Array.isArray(W)&&(W=W.join(" "));const L={className:`video-chat__message-author notranslate${mt?" ffz--name-override tw-relative ffz-il-tooltip__container":""} ${W??""}`,"data-test-selector":"comment-author-selector",href:`/${F.login}`,rel:"noopener noreferrer",target:"_blank",style:{color:Y}};h.ffz_user_props&&Object.assign(L,h.ffz_user_props),h.ffz_user_style&&Object.assign(L.style,h.ffz_user_style);const Z=a("a",L,mt?[a("span",{className:"chat-author__display-name"},mt),a("div",{className:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},rt)]:rt);let nt=a("div",{class:"tw-flex-grow-1","data-room-id":h.roomID,"data-room":h.roomLogin,"data-user-id":F.id,"data-user":F.login},a("span",{class:"chat-line__message--badges"},e.chat.badges.render(h,a)),Z,a("div",{"data-test-selector":"comment-message-selector",class:"tw-inline video-chat__message"},a("span",null,z?" ":": "),a("span",{class:`message ${I?"chat-line__message-body--italicized":""}`,style:{color:j?Y:null}},e.chat.renderTokens(it,a)),ut&&a(c,ut)));return tt&&(nt=a("div",{class:"tw-flex-grow-1"},a("div",{class:"tw-flex tw-c-text-alt-2"},a("div",null,tt)),nt)),a("div",{class:"tw-align-items-start tw-flex tw-flex-nowrap tw-c-text-base"},nt,p?a(e.MenuContainer,{context:p,isCurrentUserModerator:this.props.isCurrentUserModerator,isExpandedLayout:this.props.isExpandedLayout,onBanUserClick:this.props.onBanUserClick,onDeleteCommentClick:this.props.onDeleteCommentClick,onDisableSync:this.props.onDisableSync,onReplyClick:this.onReplyClickHandler}):null)},m.prototype.ffzRenderExpanded=function(h){return h._reply_handler||(h._reply_handler=()=>this.onReplyClickHandler(h.user.login)),a("div",{class:"tw-align-items-center tw-flex tw-pd-t-05"},a("button",{class:"tw-button tw-button--text","data-test-selector":"parent-reply-button",onClick:h._reply_handler},a("span",{class:"tw-button__text tw-pd-0"},e.i18n.t("video-chat.reply","Reply"))),a("span",{class:"tw-c-text-alt-2 tw-font-size-7 tw-mg-l-05 tw-relative ffz-il-tooltip__container"},"\u2022 ",e.i18n.t("video-chat.time","{time,humantime} ago",{time:h.timestamp}),a("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-center ffz-il-tooltip--up",role:"tooltip"},e.i18n.formatDateTime(h.timestamp,"full"))))},m.prototype.render=function(){try{if(this._ffz_no_scan=!0,this.state?.showReplyForm||!e.chat.context.get("chat.video-chat.enabled"))return w.call(this);const h=this.props.messageContext,p=e.standardizeMessage(h.comment,h.author),z=this.ffzRenderMessage(p,h),R=this.props.hideTimestamp||!e.chat.context.get("chat.video-chat.timestamps"),I=p.mentioned&&p.mention_color?e.site_chat.inverse_colors.process(p.mention_color):null;if(p.ffz_removed)return null;const j=!I&&p.highlight&&e.chat.context.get("chat.points.allow-highlight");return a("div",{"data-test-selector":"message-layout",class:`tw-align-items-start tw-flex tw-flex-nowrap tw-full-width tw-pd-l-05 tw-pd-y-05 vod-message${p.is_sub?" ffz-notice-line ffz--subscribe-line":""}${p.highlight?" ffz-notice-line ffz--points-line":""}${j?" ffz--points-highlight ffz-custom-color":""}${p.mentioned?" ffz-mentioned":""}${I?" ffz-custom-color":""}`,style:{backgroundColor:I}},R||a("div",{"data-test-selector":"message-timestamp",class:"tw-align-right tw-flex tw-flex-shrink-0 vod-message__header"},a("div",{class:"tw-mg-r-05"},a("div",{class:"tw-inline-flex tw-relative ffz-il-tooltip__container"},a("button",{class:"tw-block tw-full-width ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive",onClick:this.onTimestampClickHandler},a("div",{class:"tw-pd-x-05"},a("p",{class:"tw-font-size-7"},(0,y.print_duration)(h.comment.contentOffset)))),a("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-left ffz-il-tooltip--up",role:"tooltip"},e.i18n.t("video-chat.jump","Jump to Video"))))),a("div",{class:"tw-full-width"},z,this.props.isExpandedLayout&&this.ffzRenderExpanded(p),h.replies&&h.replies.length>0&&a("div",{class:"qa-vod-chat-reply tw-mg-l-05 tw-mg-y-05 vod-message__reply"},h.comment.moreReplies&&a("div",{class:"tw-inline-block vod-message__show-more-replies"},a("button",{class:"tw-interactive tw-button tw-button--text",onClick:this.onLoadMoreRepliesClickHandler},a("span",{class:"tw-button__text","data-a-target":"tw-button-text"},e.i18n.t("video-chat.show-more","Show more replies...")))),a("ul",null,h.replies.map(F=>a("li",{key:F.comment&&F.comment.id,class:"tw-mg-l-05"},this.ffzRenderMessage(e.standardizeMessage(F.comment,F.author),F),this.props.isExpandedLayout&&this.ffzRenderExpanded(p)))))))}catch(h){return e.log.error("Problem rendering Chat",h),w.call(this)}},setTimeout(()=>this.VideoChatLine.forceUpdate())})}updateLines(){return this._updateLines()}rerenderLines(){this.VideoChatLine.forceUpdate()}updateLineTokens(){return this._updateLines(!0,!1)}updateLineBadges(){return this._updateLines(!1,!0)}_updateLines(e=!0,o=!0){for(const a of this.VideoChatLine.instances){const c=a.props.messageContext;if(c.comment&&(c.comment._ffz_message=null,Array.isArray(c.replies)))for(const d of c.replies)d.comment&&(d.comment._ffz_message=null)}this.VideoChatLine.forceUpdate()}updateLinesByUser(e,o){for(const a of this.VideoChatLine.instances){const c=a.props.messageContext;if(!c.comment)continue;const d=c.author;d&&(e&&e==d.id||o&&o==d.name)&&(c.comment._ffz_message=null,a.forceUpdate())}}updateLineById(e,o=!0,a=null){a==null&&(a=o);for(const c of this.VideoChatLine.instances){const d=c.props.messageContext;if(d.comment&&d.comment?.id===e){(o||a)&&(d.comment._ffz_message=null),c.forceUpdate();return}}}checkEffects(){for(const e of this.VideoChatLine.instances){const o=e.props.messageContext,a=o?.comment?._ffz_message,c=a?.ffz_tokens;if(c)for(const d of c)d.type==="emote"&&d.modifier_flags&&this.emotes.ensureEffect(d.modifier_flags)}}standardizeMessage(e,o){if(e._ffz_message)return e._ffz_message;const a=this.active_room||this.chat.getRoom(e.channelId,null,!0,!0),c=e.message.userNoticeParams,d=c&&c["msg-id"],m=e._ffz_message={id:e.id,user:{color:e.message.userColor,id:o.id,login:o.name,displayName:o.displayName,isIntl:o.name&&o.displayName&&o.displayName.trim().toLowerCase()!==o.name,type:o.type},roomLogin:a&&a.login,roomID:a&&a.id||e.channelId,ffz_badges:this.chat.badges.getBadges(o.id,o.login,a?.id,a?.login),badges:e.userBadges,messageParts:e.message.tokens,is_action:e.message.isAction,more_replies:e.moreReplies,timestamp:e.createdAt,ffz_context:"video",is_sub:d==="sub"||d==="resub",highlight:d==="highlighted-message",params:c};if(Array.isArray(m.messageParts)&&m.messageParts.length&&d==="resub"){let w=m.messageParts[0].content;if(typeof w=="string"){const h=b.exec(w);h&&(w=w.slice(h[0].length).trimLeft(),w.length&&(m.messageParts[0].ffz_content=w,m.system_msg=!0))}}return this.chat.detokenizeMessage(m),m}addRoom(e,o){o||(o=e.props);const a=(0,N.get)("data.video.owner",o);if(!a||!a.id)return null;const c=e._ffz_room=this.chat.getRoom(a.id,a.login&&a.login.toLowerCase(),!1,!0);return c.ref(e),c}removeRoom(e){e._ffz_room&&(e._ffz_room.unref(e),e._ffz_room=null)}chatMounted(e,o){o||(o=e.props),this.addRoom(e,o)&&(this.active_room=e._ffz_room,this.chat.badges.updateTwitchBadges((0,N.get)("data.badges",o)),this.updateRoomBadges(e,(0,N.get)("data.video.owner.broadcastBadges",o)),this.updateRoomBitsConfig(e,o.bitsConfig))}chatUpdated(e,o){if((0,N.get)("data.video.owner.id",o)!==(0,N.get)("data.video.owner.id",e.props)){this.removeRoom(e),this.chatMounted(e,o);return}const a=(0,N.get)("data.badges",o),c=(0,N.get)("data.badges",e.props),d=(0,N.get)("data.video.owner.broadcastBadges",o),m=(0,N.get)("data.video.owner.broadcastBadges",e.props);a!==c&&this.chat.badges.updateTwitchBadges(a),d!==m&&this.updateRoomBadges(e,d),o.bitsConfig!==e.props.bitsConfig&&this.updateRoomBitsConfig(e,o.bitsConfig);const w=(0,N.get)("data.video.owner",o);this.settings.updateContext({moderator:o.isCurrentUserModerator}),this.chat.context.updateContext({moderator:o.isCurrentUserModerator,channel:w?w.login:null,channelID:w?w.id:null})}chatUnmounted(e){this.active_room===e._ffz_room&&(this.active_room=null),this.removeRoom(e)}updateRoomBadges(e,o){const a=e._ffz_room;a&&a.updateBadges(o)}updateRoomBitsConfig(e,o){const a=e._ffz_room;a&&a.updateBitsConfig((0,_.formatBitsConfig)(o))}};$(s,"VideoChatHook");let n=s},29632:(q,T,f)=>{"use strict";f.r(T),f.d(T,{ApolloEvent:()=>A,GQLError:()=>b,default:()=>v});var N=f(22527),y=f(46949),_=f(5286),E=f(17159);const r=class r extends(f.j!=4609?E.FFZEvent:null){constructor(e){super(e),this._changed=!1}markChanged(){return this._changed=!0,this}};$(r,"ApolloEvent");let A=r;const n=class n extends(f.j==3035?Error:null){constructor(e){super(`${e.message}; Location: ${e.locations}`)}};$(n,"GQLError");let b=n;const s=class s extends(f.j!=4609?N.default:null){constructor(...e){super(...e),this.modifiers={},this.post_modifiers={},this.inject("..fine")}get gqlPrint(){if(this._gql_print)return this._gql_print;const e=this.resolve("site.web_munch");return this._gql_print=e?.getModule?.("gql-printer")}onEnable(){let e=this.client;if(!e){const m=this.fine.react;if(e=(m&&m.stateNode)?.props?.client,m&&!e){let h=0,p=m;for(;!e?.queryManager&&p&&h++<20;)e=p?.memoizedProps?.client,p=p?.child;if(!e){const z=this.fine.searchTree(null,R=>R.props?.client?.queryManager,500);z&&(e=z.props.client)}}this.client=e}if(!e)return new Promise(()=>this.onEnable(),50);if(!this.client.link||!this.client.queryManager||!this.client.queryManager.link){this.log.error("Apollo does not have a Link. We are unable to manipulate queries.");return}this.hooked_query_init=!1;const o=this,a=this.client.queryManager.constructor.prototype,c=a.getCurrentQueryResult;if(a.getCurrentQueryResult=function(m,w=!0){const h=c.call(this,m,w);if(h&&h.partial)try{try{const p=m.getLastResult(),z=m.options;this.dataStore.getCache().read({query:z.query,variables:z.variables,previousResult:p?p.data:void 0,optimistic:w})}catch(p){if(p.toString().includes("Can't find field")&&m.lastResult&&!m.lastResult.loading&&!m.lastError&&Date.now()-(m._ffz_last_retry||0)>=12e4){const z=(0,y.get)("options.query.definitions.0.name",m),R=z&&z.kind==="Name"?z.value:`#${m.queryId}`;o.log.info("Forcing query to refetch due to missing field:",R),m._ffz_last_retry=Date.now(),m.refetch()}}}catch(p){o.log.capture(p)}return h},this.client.queryManager.queryStore){const m=this.client.queryManager.queryStore.initQuery;this.hooked_query_init=!0,this.client.queryManager.queryStore.initQuery=function(w){const h=this.store[w.queryId];return h&&h.queryString!==w.queryString&&(h.queryString=w.queryString),m.call(this,w)}}const d=this.ApolloLink=this.client.link.constructor;this.link=new d((m,w)=>{if(!this.enabled)return w(m);let h=m.variables;Object.keys(h).length||(h=void 0);try{this.hooked_query_init&&this.apolloPreFlight(m)}catch(p){return this.log.capture(p,{tags:{operation:m.operationName},extra:{variables:h}}),this.log.error("Error running Pre-Flight",p,m),w(m)}return w(m).map(p=>{p.extensions&&p.extensions.operationName===m.operationName&&this.log.crumb({level:"info",category:"gql",message:`${m.operationName} [${p.extensions&&p.extensions.durationMilliseconds||"??"}ms]`,data:{variables:h}});try{this.apolloPostFlight(p)}catch(z){this.log.capture(z,{tags:{operation:m.operationName},extra:{variables:h}}),this.log.error("Error running Post-Flight",z,p)}return p})}),this.old_link=this.client.link,this.old_qm_link=this.client.queryManager.link,this.client.link=d.from([this.link,this.old_link]),this.client.queryManager.link=d.from([this.link,this.old_qm_link])}onDisable(){this.client=this.printer=this._gql_print=this.old_link=this.old_qm_dedup=this.old_qm_link=null}apolloPreFlight(e){const o=e.operationName,a=this.modifiers[o],c=`:request.${o}`,d=this.hasListeners(c);if(!a&&!d)return;const m=this.client.queryManager,w=m&&m.queryIdsByName,h=m&&m.queries,p=w&&w[o],z=Array.isArray(p)?p[0]:p,R=h&&h.get(z);if(a)for(const j of a)typeof j=="function"?j(e):j[1]&&this.applyModifier(e,j[1]);let I=!!a;if(d){const j=new A({operation:o,request:e});this.emit(c,j),j._changed&&(I=!0)}if(I){const j=this.client.queryManager.queryStore.store[z],F=this.gqlPrint&&this.gqlPrint(e.query);j&&(F?(j.queryString=F,e.query.loc.source.body=F,e.query.loc.end=F.length,R&&(R.document=e.query,R.observableQuery&&R.observableQuery.options&&(R.observableQuery.options.query=e.query))):(this.log.info("Unable to find GQL Print. Clearing store for query:",o),this.client.queryManager.queryStore.store[z]=null))}}apolloPostFlight(e){if(!e.extensions)return;const o=e.extensions.operationName,a=this.post_modifiers[o];if(a)for(const c of a)c(e);this.emit(`:response.${o}`,e.data)}applyModifier(e,o){e.query=(0,_.default)(e.query,o)}registerModifier(e,o,a=!0){if(typeof o!="function"){if(!a)throw new Error("post modifiers must be functions");o=[o,o]}(a?this.modifiers[e]=this.modifiers[e]||[]:this.post_modifiers[e]=this.post_modifiers[e]||[]).push(o)}unregisterModifier(e,o,a=!0){const c=a?this.modifiers[e]:this.post_modifiers[e];if(c){if(typeof o!="function")throw new Error("graphql modifiers cannot be removed");for(let d=0;d<c.length;d++){const m=c[d];if(typeof m=="function"?m===o:m[0]===o){c.splice(d,1);return}}}}getQuery(e){const o=this.client.queryManager?.queries;if(o)for(const a of o.values()){const c=a?.observableQuery;if(c?.queryName===e)return c}}maybeRefetch(e){const o=this.getQuery(e);!o||!o.lastResult||o.lastResult.stale||o.refetch()}ensureQuery(e,o,a=500,c=12e4){const d=this.getQuery(e);if(d){const m=d.lastResult;let w;m?m.loading?w=!0:typeof o=="function"?w=o(m):w=(0,y.get)(o,m)!==void 0:w=!1,!w&&Date.now()-(d._ffz_last_retry||0)>=c&&(d._ffz_last_retry=Date.now(),d.options.query=Object.assign({},d.options.query),a===0?d.refetch():a>0&&setTimeout(()=>{d.refetch()},a))}return d}getFromQuery(e,o,a=500,c=12e4){const d=this.getQuery(e),m=d&&d.lastResult;if(!d)return;let w;if(!(m&&(typeof o=="function"?w=o(m):w=(0,y.get)(o,m),m.loading)))return w===void 0&&Date.now()-(d._ffz_last_retry||0)>=c&&(d._ffz_last_retry=Date.now(),d.options.query=Object.assign({},d.options.query),a===0?d.refetch():a>0&&setTimeout(()=>d.refetch(),a)),w}};$(s,"Apollo");let v=s},6170:(q,T,f)=>{"use strict";f.d(T,{Z:()=>r,e:()=>n});var N=f(20857);let y,_,E,A;function b(){return y?Promise.resolve(y):new Promise((s,i)=>{if(E)return E.push([s,i]);E=[[s,i]],Promise.all([f.e(2009).then(f.t.bind(f,19404,23)),f.e(2009).then(f.t.bind(f,43496,23))]).then(e=>{y=e[0]?.default,_=e[1]?.default;const o=E;E=null;for(const a of o)a[0](y)}).catch(e=>{const o=E;E=null;for(const a of o)a[1](e)})})}$(b,"loadMD");function v(s){const i=s.renderer.rules.link_open||this.defaultRender;s.renderer.rules.link_open=function(e,o,a,c,d){const m=e[o];if(m&&m.type==="link_open"&&Array.isArray(m.attrs)){let w;for(const h of m.attrs)if(h[0]==="href"){w=h[1];break}if(w.startsWith("~")){let h;if(w==="~"){let p=o+1,z=[];for(;p<e.length;){const I=e[p],j=I?.type;if(j==="text")z.push(I);else if(j==="link_close")break;p++}z=z.map(I=>I.content).join(""),h=(0,N.Q)(z).map(I=>I.key).join(".")}else h=w.slice(1);if(h&&h.length){for(const p of m.attrs)if(p[0]==="class"){p[1]=p[1].replace(/ffz-tooltip/g,"");break}m.attrs.push(["data-settings-link",h]),m.attrs.push(["onclick",'FrankerFaceZ.get().resolve("main_menu").mdNavigate(this);return false'])}}}return i(e,o,a,c,d)}}$(v,"SettingsLinks"),v.defaultRender=function(s,i,e,o,a){return a.renderToken(s,i,e)};async function r(){if(!A){const s=await b();if(!s)return null;const i=A=new s({html:!1,linkify:!0});i.use(v),i.use(_,{attrs:{class:"ffz-tooltip",target:"_blank",rel:"noopener","data-tooltip-type":"link"}})}return A}$(r,"awaitMD");function n(s){if(A)return A;s&&r().then(i=>s(i))}$(n,"getMD")},34923:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>y});var N=f(22527);const _=class _ extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(A,b){super(A,b),this.settings=null,this.site=null,this.fine=null,this.should_enable=!0,this.inject("settings"),this.inject("site.fine"),this.inject("site"),this.LoadableComponent=this.fine.define("loadable-component",v=>v.props?.component&&v.props.loader),this.ErrorBoundaryComponent=this.fine.define("error-boundary-component",v=>v.props?.name&&v.props?.onError&&v.props?.children&&v.onErrorBoundaryTestEmit),this.overrides=new Map}onEnable(){this.settings.getChanges("chat.hype.show-pinned",A=>{this.toggle("PaidPinnedChatMessageList",A)}),this.settings.getChanges("layout.turbo-cta",A=>{this.toggle("TopNav__TurboButton_Available",A)}),this.ErrorBoundaryComponent.ready((A,b)=>{this.log.debug("Found Error Boundary component wrapper.");const v=this,r=A.prototype,n=r.render;r.render=function(){try{const s=this.props.name;if(v.overrides.has(s)&&!v.shouldRender(s))return null}catch(s){console.error(s)}return n.call(this)},this.ErrorBoundaryComponent.updateInstances()}),this.LoadableComponent.ready((A,b)=>{this.log.debug("Found Loadable component wrapper.");const v=this,r=A.prototype,n=r.render;r.render=function(){try{const s=this.props.component;if(v.overrides.has(s)&&this.state){let i=this.state.Component;if(typeof i=="function"&&!i.ffzWrapped){const e=v.site.getReact(),o=e&&e.createElement;if(o){if(!i.ffzWrapper){let a=$(function(d){return v.shouldRender(c.props.component)?o(i,d):null},"FFZWrapper");const c=this;a.ffzWrapped=!0,a.displayName=`FFZWrapper(${this.props.component})`,i.ffzWrapper=a}this.state.Component=i.ffzWrapper}}}}catch(s){console.error(s)}return n.call(this)},this.LoadableComponent.updateInstances()})}toggle(A,b=null){const v=this.overrides.get(A)??!0;b==null?b=!v:b=!!b,b!==v&&(this.overrides.set(A,b),this.update(A))}update(A){for(const b of this.LoadableComponent.instances){const v=b.props?.component;v&&v===A&&b.forceUpdate()}for(const b of this.ErrorBoundaryComponent.instances){const v=b.props?.name;v&&v===A&&b.forceUpdate()}}shouldRender(A){return this.overrides.get(A)??!0}};$(_,"Loadable");let y=_},70052:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>_});var N=f(22527),y=f(44589);const E=class E extends(/^8(102|363)$/.test(f.j)?N.default:null){constructor(b,v){super(b,v),this.i18n=null,this.fine=null,this.settings=null,this.should_enable=!0,this.inject("i18n"),this.inject("settings"),this.inject("site.fine"),this.settings.add("sub-button.prime-notice",{default:!0,ui:{path:"Channel > Metadata >> Subscription",title:"Show Prime Reminder",description:"Display a crown on subscription buttons when your free channel sub with Prime is available.",component:"setting-check-box"},changed:()=>this.SubButton.forceUpdate()}),this.SubButton=this.fine.define("sub-button",r=>r.handleSubMenuAction&&r.openSubModal,["user","user-home","user-video","user-clip","video","user-videos","user-clips","user-collections","user-events","user-followers","user-following"])}onEnable(){this.settings.on(":changed:layout.swap-sidebars",()=>this.SubButton.forceUpdate()),this.SubButton.ready((b,v)=>{for(const r of v)this.updateSubButton(r)}),this.SubButton.on("mount",this.updateSubButton,this),this.SubButton.on("update",this.updateSubButton,this)}updateSubButton(b){const v=this.fine.getChildNode(b),r=v?.querySelector('button[data-a-target="subscribe-button"]');if(!r)return;const n=b.props,s=n.data&&n.data.user,i=s&&s.self,e=this.settings.get("sub-button.prime-notice")&&i&&i.canPrimeSubscribe&&!i.subscriptionBenefit,o=r.querySelector(".ffz--can-prime");if(e&&!o)r.insertBefore((0,y.createElement)("span",{class:"tw-button__icon tw-button__icon--left ffz--can-prime"},(0,y.createElement)("figure",{class:"ffz-i-crown ffz-tooltip","data-title":this.i18n.t("sub-button.prime","Your free channel sub with Prime is available.")})),r.firstElementChild),r.appendChild((0,y.createElement)("span",{class:"ffz--post-prime"}));else if(!e&&o){o.remove();const a=r.querySelector(".ffz--post-prime");a&&a.remove()}}};$(E,"SubButton");let _=E},14873:(q,T,f)=>{var c;"use strict";f.r(T),f.d(T,{Color:()=>s,ColorAdjuster:()=>i,bit2linear:()=>y,hue2rgb:()=>N,linear2bit:()=>_});function N(w,h,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?w+(h-w)*6*p:p<1/2?h:p<2/3?w+(h-w)*(2/3-p)*6:w}$(N,"hue2rgb");function y(w){return w<=.04045?w/12.92:Math.pow((w+.055)/1.055,2.4)}$(y,"bit2linear");function _(w){return w<=.0031308?w*12.92:Math.pow(1.055*w,1/2.4)-.055}$(_,"linear2bit");const e=class e{constructor(h,p,z,R){this.r=h||0,this.g=p||0,this.b=z||0,this.a=R||0}eq(h,p=!1){return h instanceof e?this.r===h.r&&this.g===h.g&&this.b===h.b&&(p||this.a===h.a):h?this.eq(h.toRGBA(),p):!1}_r(h){return new e(h,this.g,this.b,this.a)}_g(h){return new e(this.r,h,this.b,this.a)}_b(h){return new e(this.r,this.g,h,this.a)}_a(h){return new e(this.r,this.g,this.b,h)}static fromName(h){const p=s.getContext();p.clearRect(0,0,1,1),p.fillStyle=h,p.fillRect(0,0,1,1);const z=p.getImageData(0,0,1,1);return z?.data?.length!==4?null:new e(z.data[0],z.data[1],z.data[2],z.data[3]/255)}static fromCSS(h){return h=h&&h.trim(),h?.length?h.charAt(0)==="#"?e.fromHex(h):e.fromName(h):null}static fromHex(h){h.charAt(0)==="#"&&(h=h.slice(1));let p,z=255;return h.length===4?(z=parseInt(h[3],16)*17,h=h.slice(0,3)):h.length===8&&(z=parseInt(h.slice(6),16),h=h.slice(0,6)),h.length===3?p=(parseInt(h[0],16)*17<<16)+(parseInt(h[1],16)*17<<8)+parseInt(h[2],16)*17:p=parseInt(h,16),new e(p>>16,p>>8&255,p&255,z/255)}static fromHSVA(h,p,z,R){let I,j,F;const H=Math.floor(h*6),Y=h*6-H,st=z*(1-p),tt=z*(1-Y*p),it=z*(1-(1-Y)*p);switch(H%6){case 0:I=z,j=it,F=st;break;case 1:I=tt,j=z,F=st;break;case 2:I=st,j=z,F=it;break;case 3:I=st,j=tt,F=z;break;case 4:I=it,j=st,F=z;break;default:I=z,j=st,F=tt}return new e(Math.round(Math.min(Math.max(0,I*255),255)),Math.round(Math.min(Math.max(0,j*255),255)),Math.round(Math.min(Math.max(0,F*255),255)),R===void 0?1:R)}static fromHSLA(h,p,z,R){if(p===0){const F=Math.round(Math.min(Math.max(0,255*z),255));return new e(F,F,F,R===void 0?1:R)}const I=z<.5?z*(1+p):z+p-z*p,j=2*z-I;return new e(Math.round(Math.min(Math.max(0,255*N(j,I,h+1/3)),255)),Math.round(Math.min(Math.max(0,255*N(j,I,h)),255)),Math.round(Math.min(Math.max(0,255*N(j,I,h-1/3)),255)),R===void 0?1:R)}static fromXYZA(h,p,z,R){const I=3.240479*h-1.53715*p-.498535*z,j=-.969256*h+1.875992*p+.041556*z,F=.055648*h-.204043*p+1.057311*z;return new e(Math.max(0,Math.min(255,255*_(I))),Math.max(0,Math.min(255,255*_(j))),Math.max(0,Math.min(255,255*_(F))),R===void 0?1:R)}toCSS(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:this.toHex()}toHex(){return`#${((Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)).toString(16).padStart(6,"0")}`}toRGBA(){return this}toHSVA(){return A.fromRGBA(this.r,this.g,this.b,this.a)}toHSLA(){return b.fromRGBA(this.r,this.g,this.b,this.a)}toXYZA(){return r.fromRGBA(this.r,this.g,this.b,this.a)}toLUVA(){return this.toXYZA().toLUVA()}get_Y(){return(.299*this.r+.587*this.g+.114*this.b)/255}luminance(){const h=y(this.r/255),p=y(this.g/255),z=y(this.b/255);return .2126*h+.7152*p+.0722*z}brighten(h){return h=typeof h=="number"?h:1,h=Math.round(255*(h/100)),new e(Math.max(0,Math.min(255,this.r+h)),Math.max(0,Math.min(255,this.g+h)),Math.max(0,Math.min(255,this.b+h)),this.a)}daltonize(h){let p;if(typeof h=="string")if(s.CVDMatrix.hasOwnProperty(h))p=s.CVDMatrix[h];else throw new Error("Invalid CVD matrix");else p=h;const z=p[0],R=p[1],I=p[2],j=p[3],F=p[4],H=p[5],Y=p[6],st=p[7],tt=p[8],it=17.8824*this.r+43.5161*this.g+4.11935*this.b,ut=3.45565*this.r+27.1554*this.g+3.86714*this.b,rt=.0299566*this.r+.184309*this.g+1.46709*this.b,mt=z*it+R*ut+I*rt,W=j*it+F*ut+H*rt,L=Y*it+st*ut+tt*rt;let Z=.0809444479*mt+-.130504409*W+.116721066*L,nt=-.0102485335*mt+.0540193266*W+-.113614708*L,at=-.000365296938*mt+-.00412161469*W+.693511405*L;Z=this.r-Z,nt=this.g-nt,at=this.b-at;const ft=0*Z+0*nt+0*at,lt=.7*Z+1*nt+0*at,ht=.7*Z+0*nt+1*at;return Z=Math.min(Math.max(0,ft+this.r),255),nt=Math.min(Math.max(0,lt+this.g),255),at=Math.min(Math.max(0,ht+this.b),255),new e(Z,nt,at,this.a)}};$(e,"RGBAColor");let E=e;const o=class o{constructor(h,p,z,R){this.h=h||0,this.s=p||0,this.v=z||0,this.a=R||0}eq(h,p=!1){return h instanceof o?this.h===h.h&&this.s===h.s&&this.v===h.v&&(p||this.a===h.a):h?this.eq(h.toHSVA(),p):!1}_h(h){return new o(h,this.s,this.v,this.a)}_s(h){return new o(this.h,h,this.v,this.a)}_v(h){return new o(this.h,this.s,h,this.a)}_a(h){return new o(this.h,this.s,this.v,h)}static fromRGBA(h,p,z,R){h/=255,p/=255,z/=255;const I=Math.max(h,p,z),j=Math.min(h,p,z),F=Math.min(Math.max(0,I-j),1),H=I===0?0:F/I,Y=I;let st;if(F===0)st=0;else{switch(I){case h:st=(p-z)/F+(p<z?6:0);break;case p:st=(z-h)/F+2;break;default:st=(h-p)/F+4}st/=6}return new o(st,H,Y,R===void 0?1:R)}toCSS(){return this.toRGBA().toCSS()}toHex(){return this.toRGBA().toHex()}toRGBA(){return E.fromHSVA(this.h,this.s,this.v,this.a)}toHSVA(){return this}toHSLA(){return this.toRGBA().toHSLA()}toXYZA(){return this.toRGBA().toXYZA()}toLUVA(){return this.toRGBA().toLUVA()}};$(o,"HSVAColor");let A=o;const a=class a{constructor(h,p,z,R){this.h=h||0,this.s=p||0,this.l=z||0,this.a=R||0}eq(h,p=!1){return h instanceof a?this.h===h.h&&this.s===h.s&&this.l===h.l&&(p||this.a===h.a):h?this.eq(h.toHSLA(),p):!1}_h(h){return new a(h,this.s,this.l,this.a)}_s(h){return new a(this.h,h,this.l,this.a)}_l(h){return new a(this.h,this.s,h,this.a)}_a(h){return new a(this.h,this.s,this.l,h)}static fromRGBA(h,p,z,R){h/=255,p/=255,z/=255;const I=Math.max(h,p,z),j=Math.min(h,p,z),F=Math.min(Math.max(0,(I+j)/2),1),H=Math.min(Math.max(0,I-j),1);let Y,st;if(H===0)Y=st=0;else{switch(st=F>.5?H/(2-I-j):H/(I+j),I){case h:Y=(p-z)/H+(p<z?6:0);break;case p:Y=(z-h)/H+2;break;default:Y=(h-p)/H+4}Y/=6}return new a(Y,st,F,R===void 0?1:R)}toCSS(){const h=this.a;return`hsl${h!==1?"a":""}(${Math.round(this.h*360)},${Math.round(this.s*100)}%,${Math.round(this.l*100)}%${h!==1?`,${this.a}`:""})`}toHex(){return this.toRGBA().toHex()}toRGBA(){return E.fromHSLA(this.h,this.s,this.l,this.a)}toHSLA(){return this}toHSVA(){return this.toRGBA().toHSVA()}toXYZA(){return this.toRGBA().toXYZA()}toLUVA(){return this.toRGBA().toLUVA()}targetLuminance(h){let p=this.s,z=0,R=1;p*=Math.pow(this.l>.5?-this.l:this.l-1,7)+1;let I=(R-z)/2,j=z+I;for(;I>1/65536;I/=2,j=z+I)E.fromHSLA(this.h,p,j,1).luminance()>h?R=j:z=j;return new a(this.h,p,j,this.a)}};$(a,"HSLAColor");let b=a;const v=(c=class{constructor(h,p,z,R){this.x=h||0,this.y=p||0,this.z=z||0,this.a=R||0}eq(h,p=!1){return h instanceof c?this.x===h.x&&this.y===h.y&&this.z===h.z&&(p||this.a===h.a):h?this.eq(h.toXYZA(),p):!1}_x(h){return new c(h,this.y,this.z,this.a)}_y(h){return new c(this.x,h,this.z,this.a)}_z(h){return new c(this.x,this.y,h,this.a)}_a(h){return new c(this.x,this.y,this.z,h)}static fromRGBA(h,p,z,R){const I=y(h/255),j=y(p/255),F=y(z/255);return new c(.412453*I+.35758*j+.180423*F,.212671*I+.71516*j+.072169*F,.019334*I+.119193*j+.950227*F,R===void 0?1:R)}static fromLUVA(h,p,z,R){const I=1/(c.WHITE.x+15*c.WHITE.y+3*c.WHITE.z),j=4*c.WHITE.x*I,F=9*c.WHITE.y*I,H=h>8?Math.pow((h+16)/116,3):h/c.KAPPA,Y=1/3*(52*h/(p+13*h*j)-1),st=-5*H,tt=-1/3,it=H*(39*h/(z+13*h*F)-5),ut=(it-st)/(Y-tt),rt=ut*Y+st;return new c(ut,H,rt,R===void 0?1:R)}toCSS(){return this.toRGBA().toCSS()}toHex(){return this.toRGBA().toHex()}toRGBA(){return E.fromXYZA(this.x,this.y,this.z,this.a)}toHSLA(){return this.toRGBA().toHSLA()}toHSVA(){return this.toRGBA().toHSVA()}toXYZA(){return this}toLUVA(){return n.fromXYZA(this.x,this.y,this.z,this.a)}},$(c,"_XYZAColor2"),c);v.EPSILON=Math.pow(6/29,3),v.KAPPA=Math.pow(29/3,3),v.WHITE=null;let r=v;r.WHITE=new E(255,255,255,1).toXYZA();const d=class d{constructor(h,p,z,R){this.l=h||0,this.u=p||0,this.v=z||0,this.a=R||0}eq(h,p=!1){return h instanceof d?this.l===h.l&&this.u===h.u&&this.v===h.v&&(p||this.a===h.a):h?this.eq(h.toLUVA(),p):!1}_l(h){return new d(h,this.u,this.v,this.a)}_u(h){return new d(this.l,h,this.v,this.a)}_v(h){return new d(this.l,this.u,h,this.a)}_a(h){return new d(this.l,this.u,this.v,h)}static fromXYZA(h,p,z,R){const I=1/(r.WHITE.x+15*r.WHITE.y+3*r.WHITE.z),j=4*r.WHITE.x*I,F=9*r.WHITE.y*I,H=p/r.WHITE.y;let Y=h+15*p+3*z;Y===0&&(Y=1);const st=1/Y,tt=4*h*st,it=9*p*st,ut=H>r.EPSILON?116*Math.pow(H,1/3)-16:r.KAPPA*H,rt=13*ut*(tt-j),mt=13*ut*(it-F);return new d(ut,rt,mt,R===void 0?1:R)}toCSS(){return this.toRGBA().toCSS()}toHex(){return this.toRGBA().toHex()}toRGBA(){return this.toXYZA().toRGBA()}toHSLA(){return this.toRGBA().toHSLA()}toHSVA(){return this.toRGBA().toHSVA()}toXYZA(){return r.fromLUVA(this.l,this.u,this.v,this.a)}toLUVA(){return this}};$(d,"LUVAColor");let n=d;const s={CVDMatrix:{protanope:[0,2.02344,-2.52581,0,1,0,0,0,1],deuteranope:[1,0,0,.494207,0,1.24827,0,0,1],tritanope:[1,0,0,0,1,0,-.395913,.801109,0]},getCanvas(){return s._canvas||(s._canvas=document.createElement("canvas")),s._canvas},getContext:()=>(s._context||(s._context=s.getCanvas().getContext("2d")),s._context),RGBA:E,HSVA:A,HSLA:b,XYZA:r,LUVA:n,fromCSS(w){return E.fromCSS(w)}},m=class m{constructor(h="#232323",p=0,z=4.5){this._dark=!1,this._cache=new Map,this._luv=0,this._luma=0,this._contrast=z,this._base=h,this._mode=p,this.rebuildContrast()}get contrast(){return this._contrast}set contrast(h){this._contrast=h,this.rebuildContrast()}get base(){return this._base}set base(h){this._base=h,this.rebuildContrast()}get dark(){return this._dark}get mode(){return this._mode}set mode(h){this._mode=h,this.rebuildContrast()}rebuildContrast(){this._cache=new Map;const h=E.fromCSS(this._base);if(!h)throw new Error("Invalid base color");const p=h.luminance();(this._dark=p<.5)?(this._luv=new r(0,this._contrast*(h.toXYZA().y+.05)-.05,0,1).toLUVA().l,this._luma=this._contrast*(h.luminance()+.05)-.05):(this._luv=new r(0,(h.toXYZA().y+.05)/this._contrast-.05,0,1).toLUVA().l,this._luma=(h.luminance()+.05)/this._contrast-.05)}process(h,p=!1){if(!h)return null;if(this._mode===-1)return"";if(typeof h!="string"&&(h=h.toCSS()),this._mode===0)return h;if(this._cache.has(h))return this._cache.get(h);let z;try{z=E.fromCSS(h)}catch(I){if(p)throw I;return null}if(!z)return null;if(this._mode===1){const I=z.luminance();(this._dark?I<this._luma:I>this._luma)&&(z=z.toHSLA().targetLuminance(this._luma).toRGBA())}else if(this._mode===2){const I=z.toLUVA();(this._dark?I.l<this._luv:I.l>this._luv)&&(z=I._l(this._luv).toRGBA())}else if(this._mode===3)if(this._dark)for(;z.get_Y()<.5;){const I=z.toHSLA();z=I._l(Math.min(Math.max(0,.1+.9*I.l),1)).toRGBA()}else for(;z.get_Y()>=.5;){const I=z.toHSLA();z=I._l(Math.min(Math.max(0,.9*I.l),1)).toRGBA()}else if(this._mode===4){let I=0;if(this._dark)for(;z.luminance()<.15&&I++<127;)z=z.brighten();else for(;z.luminance()>.3&&I++<127;)z=z.brighten(-1)}const R=z.toCSS();return this._cache.set(h,R),R}};$(m,"ColorAdjuster");let i=m},45866:(q,T,f)=>{"use strict";f.d(T,{Z:()=>A});var N=f(72167),y=f.n(N),_=f(22527),E=f(46949);const b=class b extends(/^8(102|363)$/.test(f.j)?_.default:null){constructor(r,n){super(r,n),this.fine=null,this.inject("..fine"),this.__routes=[],this.routes={},this.route_names={},this.current=null,this.current_name=null,this.current_state=null,this.match=null,this.location=null}onEnable(){const r=this.fine.searchTree(null,s=>s.props&&s.props.history),n=this.history=r&&r.props&&r.props.history;if(!n)return(0,E.sleep)(50).then(()=>this.onEnable());n.listen(s=>{this.enabled&&this._navigateTo(s)}),this._navigateTo(n.location)}navigate(r,n,s,i){this.history.push(this.getURL(r,n,s),i)}_navigateTo(r){this.log.debug("New Location",r);const n=window.location.host,s=r.pathname,i=r.search,e=r.state;s===this.location&&n===this.domain&&i===this.search&&(0,E.deep_equals)(e,this.current_state)||(this.old_location=this.location,this.old_search=this.search,this.old_domain=this.domain,this.old_state=this.current_state,this.location=s,this.search=i,this.domain=n,this.current_state=e,this._pickRoute())}_pickRoute(){const r=this.location,n=this.domain;this.old_route=this.current,this.old_name=this.current_name,this.old_match=this.match;for(const s of this.__routes){if(s.domain&&s.domain!==n)continue;const i=s.regex.exec(r);if(i&&(!s.state_fn||s.state_fn(this.current_state))){this.log.debug("Matching Route",s,i),this.current=s,this.current_name=s.name,this.match=i,this.emit(":route",s,i);return}}this.current=this.current_name=this.match=null,this.emit(":route",null,null)}getURL(r,n,s,...i){const e=this.routes[r];if(!e)throw new Error(`unable to find route "${r}"`);if(typeof n!="object"){const o=[n,s,...i];n={};let a=0;for(const c of e.parts)if(c&&c.name&&(n[c.name]=o[a],a++,a>=o.length))break}return e.url(n,s)}getRoute(r){return this.routes[r]}getRoutes(){return this.routes}getRouteNames(){for(const r of Object.keys(this.getRoutes()))this.getRouteName(r);return this.route_names}getRouteName(r){return this.route_names[r]||(this.route_names[r]=r.replace(/^dash-([a-z])/,(n,s)=>`Dashboard: ${s.toLocaleUpperCase()}`).replace(/(^|-)([a-z])/g,(n,s,i)=>`${s?" ":""}${i.toLocaleUpperCase()}`)),this.route_names[r]}routeName(r,n,s=!0){if(typeof r=="object"){for(const i in r)(0,E.has)(r,i)&&this.routeName(i,r[i],!1);s&&this.emit(":updated-route-names");return}n&&(this.route_names[r]=n,s&&this.emit(":updated-route-names"))}route(r,n,s=null,i=null,e=!0){if(typeof r=="object"){s=n;for(const d in r)(0,E.has)(r,d)&&this.route(d,r[d],s,i,!1);e&&(this.__routes.sort((d,m)=>m.score-d.score),this.location&&this._pickRoute(),this.emit(":updated-routes"));return}const o=(0,N.parse)(n),a=o.reduce((d,m)=>d+(typeof m=="string"?m.split("/").length-1:0),0),c=this.routes[r]={name:r,parts:o,score:a,domain:s,state_fn:i,regex:(0,N.tokensToRegExp)(o),url:(0,N.tokensToFunction)(o)};this.__routes.push(c),e&&(this.__routes.sort((d,m)=>m.score-d.score),this.location&&this._pickRoute(),this.emit(":updated-routes"))}};$(b,"FineRouter");let A=b},98247:(q,T,f)=>{"use strict";f.d(T,{Z:()=>_});var N=f(17159),y=f(22527);const b=class b extends(f.j!=4609?y.default:null){constructor(n,s){super(n,s),this._route=null,this._wrappers=new Map,this._known_classes=new Map,this._observer=null,this._waiting=[],this._live_waiting=null}async onEnable(n=0){this.root_element||(this.root_element=await this.parent.awaitElement(this.selector||"body #root"));let s=this.root_element?._reactRootContainer;if(s?._internalRoot?.current&&(s=s?._internalRoot),s?.current){this.react_root=s,this.react=s?.current?.child;return}if(this.root_element&&!s){let i=b.findAccessor(this.root_element,"__reactContainer");if(i){this.react_root=null,this.react=this.root_element[i];return}}if(n>500)throw new Error("Unable to find React after 25 seconds");return this.root_element=null,new Promise(i=>setTimeout(i,50)).then(()=>this.onEnable(n+1))}onDisable(){this.react_root=this.root_element=this.react=this.accessor=null}static findAccessor(n,s){for(const i in n)if(s?i.startsWith(`${s}$`):i.startsWith("__reactInternalInstance$")||i.startsWith("__reactFiber$"))return i;return null}resolveNode(n){return!n&&this.react?this.react:n instanceof Node?this.getReactInstance(n):n?._reactInternals?n._reactInternals:n?._reactInternalFiber?n._reactInternalFiber:n||null}getReactInstance(n){return this.accessor||(this.accessor=b.findAccessor(n)),this.accessor?n[this.accessor]??n._reactRootContainer?._internalRoot?.current??n._reactRootContainer?.current??null:null}getOwner(n){return n=this.resolveNode(n),n?.return??null}getParentNode(n,s=100,i=!1){return this.searchParent(n,e=>e instanceof Node,s,0,i)}getChildNode(n,s=100,i=!1){return this.searchTree(n,e=>e instanceof Node,s,0,i)}getHostNode(n,s=100){return this.getChildNode(n,s)}getParent(n){return this.getOwner(n)}getFirstChild(n){return this.resolveNode(n)?.child??null}getChildren(n){const s=this.resolveNode(n);if(!s)return[];const i=[];let e=s.child;for(;e;)i.push(e),e=e.sibling;return i}searchParent(n,s,i=15,e=0,o=!0){if(e>i)return null;const a=this.resolveNode(n);if(!a)return null;if(typeof s=="string"){const d=this._wrappers.get(s);if(!d)throw new Error("invalid critera");if(!d.class)return null;s=$(m=>m&&m.constructor===d.class,"criteria")}const c=a.stateNode;if(c&&s(c,a))return c;if(a.return){const d=this.searchParent(a.return,s,i,e+1,o);if(d)return d}if(o&&c?.containerInfo){const d=c.containerInfo?.parentElement,m=d&&this.getReactInstance(d);if(m){const w=this.searchParent(m,s,i,e+1,o);if(w)return w}}return null}searchParentNode(n,s,i=15,e=0,o=!0){if(e>i)return null;const a=this.resolveNode(n);if(!a)return null;if(s(a))return a;if(a.return){const d=this.searchParentNode(a.return,s,i,e+1,o);if(d)return d}const c=a.stateNode;if(o&&c?.containerInfo){const d=c.containerInfo?.parentElement,m=d&&this.getReactInstance(d);if(m){const w=this.searchParentNode(m,s,i,e+1,o);if(w)return w}}return null}searchNode(n,s,i=15,e=0,o=!0){if(e>i)return null;const a=this.resolveNode(n);if(!a)return null;if(s(a))return a;if(a._ffz_no_scan||a.stateNode?._ffz_no_scan)return null;let c=a.child;for(;c;){const m=this.searchNode(c,s,i,e+1,o);if(m)return m;c=c.sibling}const d=a.stateNode;if(o&&d?.props?.root){const m=d.props.root._reactRootContainer;if(m){let w=m._internalRoot?.current||m.current;for(;w;){const h=this.searchNode(w,s,i,e+1,o);if(h)return h;w=w.sibling}}}return null}searchTree(n,s,i=15,e=0,o=!0,a){const c=this.resolveNode(n);if(a&&!(a instanceof Set)&&(a=new Set),!c||e>i)return a||null;if(typeof s=="string"){const w=this._wrappers.get(s);if(!w)throw new Error("invalid critera");if(!w.class)return a||null;s=$(h=>h&&h.constructor===w.class,"criteria")}const d=c.stateNode;if(d&&s(d,c))if(a)a.add(d);else return d;if(c._ffz_no_scan||c.stateNode?._ffz_no_scan)return a||null;let m=c.child;for(;m;){const w=this.searchTree(m,s,i,e+1,o,a);if(w&&!a)return w;m=m.sibling}if(o&&d?.props?.root){const w=d.props.root._reactRootContainer;if(w){let h=w._internalRoot?.current||w.current;for(;h;){const p=this.searchTree(h,s,i,e+1,o,a);if(p&&!a)return p;h=h.sibling}}}return a||null}findAllMatching(n,s,i=15,e=!0,o=!1,a=0,c=!0){const d=new Set;let m=$((w,h)=>!d.has(w)&&s(w,h),"crit");for(;;){const w=o?this.searchParent(n,m,i,a,c):this.searchTree(n,m,i,a,c);if(!w)break;if(e&&!d.size){const h=w.constructor;m=$((p,z)=>!d.has(p)&&p instanceof h&&s(p,z),"crit")}d.add(w)}return d}searchAll(n,s,i=15,e=0,o=null,a=!0){const c=this.resolveNode(n);if(o||(o={seen:new Set,classes:s.map(()=>null),out:s.map(()=>({cls:null,instances:new Set,depth:null})),max_depth:e}),!c||e>i)return o.out;e>o.max_depth&&(o.max_depth=e);const d=c.stateNode;if(d){const w=d.constructor,h=o.classes.indexOf(w);if(h!==-1)o.out[h].instances.add(d);else if(!o.seen.has(w)){let p=s.length;for(;p-- >0;)if(s[p](d,c)){o.classes[p]=o.out[p].cls=w,o.out[p].instances.add(d),o.out[p].depth=e;break}o.seen.add(w)}}if(c._ffz_no_scan||c.stateNode?._ffz_no_scan)return o.out;let m=c.child;for(;m;)this.searchAll(m,s,i,e+1,o,a),m=m.sibling;if(a&&d?.props?.root){const w=d.props.root._reactRootContainer;if(w){let h=w._internalRoot&&w._internalRoot.current||w.current;for(;h;)this.searchAll(h,s,i,e+1,o,a),h=h.sibling}}return o.out}route(n){this._route=n,this._updateLiveWaiting()}_updateLiveWaiting(){const n=this._live_waiting=[],s=this._waiting_crit=[],i=this._route;if(this._waiting)for(const e of this._waiting)e.routes===!1||!e.criteria||(!i||!e.routes?.length||e.routes.includes(i))&&(n.push(e),s.push(e.criteria));this._live_waiting.length?this._waiting_timer||this._startWaiting():this._stopWaiting()}define(n,s,i=null){if(this._wrappers.has(n))return this._wrappers.get(n);if(!s)throw new Error("cannot find definition and no criteria provided");const e=new A(n,s,i,this);this._wrappers.set(n,e);const o=this.react?this.searchAll(this.react,[s],1e3)[0]:null;return o?.cls?(e._set(o.cls,o.instances),this._known_classes.set(o.cls,e)):i!==!1&&(this._waiting.push(e),this._updateLiveWaiting()),e}wrap(n,s){let i;if(this._wrappers.has(n)?i=this._wrappers.get(n):(i=new A(n,null,null,this),this._wrappers.set(n,i)),s){if(i.class||i.criteria)throw new Error("tried setting a class on an already initialized FineWrapper");i._set(s,new Set),this._known_classes.set(s,i)}return i}_checkWaiters(n=null){if(this._live_waiting){Array.isArray(n)||(n=[n]);for(let s of n){if(!this._live_waiting.length||!this._waiting_crit)break;let i=null;if(!s&&this.react?i=this.react:s instanceof Node?i=this.getReactInstance(s):s?._reactInternals?i=s._reactInternals:s?._reactInternalFiber&&(i=s._reactInternalFiber),!i||i._ffz_no_scan||i.stateNode?._ffz_no_scan)continue;const e=this.searchAll(i,this._waiting_crit,1e3);let o=e.length;for(;o-- >0;)if(e[o].cls){const a=e[o],c=this._live_waiting.splice(o,1)[0];this._waiting_crit.splice(o,1);const d=this._waiting.indexOf(c);d!==-1&&this._waiting.splice(d,1),this.log.debug(`Found class for "${c.name}" at depth ${a.depth}`),c._set(a.cls,a.instances)}}this._live_waiting.length||this._stopWaiting()}}_startWaiting(){this.log.info("Installing MutationObserver."),this._waiting_timer=setInterval(()=>this._checkWaiters(),500),this._observer||(this._observer=new MutationObserver(n=>this._checkWaiters(n.map(s=>s.target)))),this._observer.observe(document.body,{childList:!0,subtree:!0})}_stopWaiting(){this.log.info("Stopping MutationObserver."),this._observer&&this._observer.disconnect(),this._waiting_timer&&clearInterval(this._waiting_timer),this._live_waiting=null,this._waiting_crit=null,this._waiting_timer=null}};$(b,"Fine");let _=b;const E={"will-mount":"UNSAFE_componentWillMount",mount:"componentDidMount",render:"render","receive-props":"UNSAFE_componentWillReceiveProps","should-update":"shouldComponentUpdate","will-update":"UNSAFE_componentWillUpdate",update:"componentDidUpdate",unmount:"componentWillUnmount"},v=class v extends(f.j!=4609?N.EventEmitter:null){constructor(n,s,i,e){super(),this.name=n,this.criteria=s,this.fine=e,this.instances=new Set,this.routes=i??[],this._wrapped=new Map,this._class=null}get class(){return this._class}get first(){return this.toArray()[0]}__cleanListeners(){const n=super.__cleanListeners();for(const s of n){const i=E[s];if(i)try{this._unwrap(i)}catch{}}return n}toArray(){return Array.from(this.instances)}check(n=null,s=1e3){if(this._class||!this.criteria)return;const i=this.fine.findAllMatching(n,this.criteria,s);if(i.size){const e=Array.from(i);this._set(e[0].constructor,e)}}ready(n){this._class?n(this._class,this.instances):this.once("set",n)}each(n){for(const s of this.instances)n(s)}updateInstances(n=null,s=1e3){if(!this._class)return;const i=this.fine.findAllMatching(n,e=>e.constructor===this._class,s);for(const e of i)e._ffz_mounted=!0,this.instances.add(e)}_set(n,s){if(this._class)throw new Error("already have a class");this._class=n,n._ffz_wrapper=this;const i=this,e=this.instances,o=n.prototype,a=o.UNSAFE_componentWillMount,c=o.componentWillUnmount,d=o.UNSAFE_componentWillMount=a?function(...w){return this._ffz_mounted=!0,e.add(this),i.emit("will-mount",this,...w),a.apply(this,w)}:function(...w){this._ffz_mounted=!0,e.add(this),i.emit("will-mount",this,...w)},m=o.componentWillUnmount=c?function(...w){return i.emit("unmount",this,...w),e.delete(this),this._ffz_mounted=!1,c.apply(this,w)}:function(...w){i.emit("unmount",this,...w),e.delete(this),this._ffz_mounted=!1};this._wrapped.set("UNSAFE_componentWillMount",[d,a]),this._wrapped.set("componentWillUnmount",[m,c]);for(const w of this.events())this._maybeWrap(w);if(s)for(const w of s)w._ffz_mounted=!0,e.add(w);this.emit("set",n,e)}_add(n){for(const s of n)this.instances.add(s)}_maybeWrap(n){const s=E[n];!this._class||!s||this._wrapped.has(s)||this._wrap(n,s)}_wrap(n,s){if(this._wrapped.has(s)||!this._class)return;const i=this,e=this._class.prototype,o=e[s],a=e[s]=o?function(...c){return this._ffz_mounted||(this._ffz_mounted=!0,i.instances.add(this),i.emit("late-mount",this)),i.emit(n,this,...c),o.apply(this,c)}:s==="shouldComponentUpdate"?function(...c){return this._ffz_mounted||(this._ffz_mounted=!0,i.instances.add(this),i.emit("late-mount",this)),i.emit(n,this,...c),!0}:function(...c){this._ffz_mounted||(this._ffz_mounted=!0,i.instances.add(this),i.emit("late-mount",this)),i.emit(n,this,...c)};this._wrapped.set(s,[a,o])}_unwrap(n){const s=this._wrapped.get(n);if(!s||!this._class)return;const i=this._class.prototype,[e,o]=s;if(i[n]!==e)throw new Error("unable to unwrap -- prototype modified");i[n]=o,this._wrapped.delete(n)}forceUpdate(){for(const n of this.instances)try{n.forceUpdate(),this.fine.emit("site:dom-update",this.name,n)}catch(s){s instanceof Error&&this.fine.log.capture(s,{tags:{fine_wrapper:this.name}}),this.fine.log.error(`An error occurred when calling forceUpdate on an instance of ${this.name}`,s)}}on(n,s,i,e,o=!1){return this._maybeWrap(n),super.on(n,s,i,e,o)}once(n,s,i,e,o=!1){return this._maybeWrap(n),super.once(n,s,i,e,o)}many(n,s,i,e,o,a=!1){return this._maybeWrap(n),super.many(n,s,i,e,o,a)}waitFor(n,s,i,e=!1){return this._maybeWrap(n),super.waitFor(n,s,i,e)}};$(v,"FineWrapper");let A=v},94417:(q,T,f)=>{var r;"use strict";f.r(T),f.d(T,{Dialog:()=>b,default:()=>v,getDialogNextZ:()=>E});var N=f(17159),y=f(89196);let _=9e3;function E(){return _++}$(E,"getDialogNextZ");const A=(r=class extends N.EventEmitter{constructor(s,i={}){super(),this.selectors={exclusive:r.EXCLUSIVE,maximized:r.MAXIMIZED,normal:r.SELECTOR},i.selectors&&(this.selectors=Object.assign(this.selectors,i.selectors)),this._maximized=i.maximized||!1,this._exclusive=i.exclusive||!1,this.prepend=i.prepend||!1,this._element=null,this._visible=!1,typeof s=="function"?this.factory=s:this.element=s}get maximized(){return this._exclusive||this._maximized}set maximized(s){s=!!s,s!==this._maximized&&(this._visible?this.toggleSize():this._maximized=s)}get visible(){return this._visible}set visible(s){s=!!s,s!==this._visible&&this.toggleVisible()}get exclusive(){return this._exclusive}set exclusive(s){if(this._visible)throw new Error("cannot set exclusive flag when dialog already visible");this._exclusive=s}get element(){return this._element}set element(s){if(this._visible)throw new Error("cannot change element when dialog already visible");if(!(s instanceof Node))throw new Error("element must be an instance of Node");this._element=s}show(){this.visible=!0}hide(){this.visible=!1}maximize(){this.maximized=!0}restore(){this.maximized=!1}getContainer(){return document.querySelector(this._exclusive?this.selectors.exclusive:this._maximized?this.selectors.maximized:this.selectors.normal)}toggleVisible(s){if(s&&s.button!==0)return;const i=this.maximized,e=this._visible=!this._visible,o=this.getContainer();if(i&&o&&o.classList.toggle("ffz-has-dialog",e),!e){this._element&&this._element.remove(),this.emit("hide"),this.factory&&(this._element=null);return}if(o){if(this.factory){const a=this.factory();if(a instanceof Promise){a.then(c=>{this._element=c,this.prepend?o.insertBefore(c,o.firstChild):o.appendChild(c),this.emit("show")}).catch(c=>{this.emit("error",c)});return}else this._element=a}this._element&&(this.prepend?o.insertBefore(this._element,o.firstChild):o.appendChild(this._element),this.emit("show"))}}toggleSize(s){if(!this._visible||s&&s.button!==0||!this._element)return;this._maximized=!this._maximized;const i=this.maximized,e=this.getContainer(),o=this._element.parentElement;e!==o&&(i?e&&e.classList.add("ffz-has-dialog"):o&&o.classList.remove("ffz-has-dialog"),this._element.remove(),e&&(this.prepend?e.insertBefore(this._element,e.firstChild):e.appendChild(this._element)),this.emit("resize"))}},$(r,"_Dialog2"),r);A.EXCLUSIVE=y.Z.DIALOG_EXCLUSIVE,A.MAXIMIZED=y.Z.DIALOG_MAXIMIZED,A.SELECTOR=y.Z.DIALOG_SELECTOR;let b=A;const v=b},44589:(q,T,f)=>{"use strict";f.r(T),f.d(T,{ClickOutside:()=>h,ManagedStyle:()=>w,createElement:()=>s,findReactFragment:()=>n,hasSharedParent:()=>e,highlightJson:()=>p,off:()=>r,on:()=>v,openFile:()=>o,readFile:()=>a,sanitize:()=>d,setChildren:()=>i});var N=f(46949),y=f(24431);const _=f.j!=4609?["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","bgcolor","border","buffered","challenge","charset","checked","cite","class","code","codebase","color","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","data","data-*","datetime","default","defer","dir","dirname","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","icon","id","integrity","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","seamless","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","type","usemap","value","width","wrap"]:null,E=f.j!=4609?["controls","autoplay","loop"]:null,A=document.createRange();function b(I){return I.replace(/[-_]\w/g,j=>j[1].toUpperCase())}$(b,"camelCase");function v(I,j,F,H){return I.addEventListener(j,F,H)}$(v,"on");function r(I,j,F,H){return I.removeEventListener(j,F,H)}$(r,"off");function n(I,j,F=25,H=0,Y){if(!Y)Y=new Set;else if(Y.has(I))return null;if(j(I))return I;if(H>=F)return null;if(Y.add(I),I?.props?.children)if(Array.isArray(I.props.children)){for(const st of I.props.children)if(st)if(Array.isArray(st))for(const tt of st){const it=n(tt,j,F,H+1,Y);if(it)return it}else{const tt=n(st,j,F,H+1,Y);if(tt)return tt}}else{const st=n(I.props.children,j,F,H+1,Y);if(st)return st}return null}$(n,"findReactFragment");function s(I,j,...F){const H=document.createElement(I);if(F.length===0?F=null:F.length===1&&(F=F[0]),typeof j=="string")H.className=j;else if(j){for(const Y in j)if((0,N.has)(j,Y)){const st=Y.toLowerCase(),tt=j[Y];if(st==="style")if(typeof tt=="string")H.style.cssText=tt;else if(tt&&typeof tt=="object")for(const[it,ut]of Object.entries(tt))(0,N.has)(H.style,it)||(0,N.has)(Object.getPrototypeOf(H.style),it)?H.style[it]=ut:H.style.setProperty(it,tt[it]);else y.DEBUG&&tt!=null&&console.warn("unsupported style value",tt);else if(st==="dataset")if(tt&&typeof tt=="object")for(const it in tt)(0,N.has)(tt,it)&&(H.dataset[b(it)]=tt[it]);else y.DEBUG&&tt!=null&&console.warn("unsupported dataset value",tt);else Y==="dangerouslySetInnerHTML"?tt&&tt.__html&&(H.innerHTML=tt.__html):st.startsWith("on")?H.addEventListener(st.slice(2),tt):st.startsWith("data-")?H.dataset[b(st.slice(5))]=tt:E.includes(st)?tt&&tt!=="false"&&H.setAttribute(Y,tt):st.startsWith("aria-")||_.includes(st)?H.setAttribute(Y,tt):H[Y]=tt}}return F&&i(H,F),H}$(s,"createElement");function i(I,j,F=!1,H=!1){if(F&&window.FrankerFaceZ.get().log.warn("call to setChildren with no_sanitize set to true -- this is no longer supported"),j instanceof Node)H||(I.innerHTML=""),I.appendChild(j);else if(Array.isArray(j)){H||(I.innerHTML="");for(const Y of j)if(Y instanceof Node)I.appendChild(Y);else if(Array.isArray(Y))i(I,Y,F,!0);else if(Y){const st=typeof Y=="string"?Y:String(Y);I.appendChild(document.createTextNode(st))}}else if(j){const Y=typeof j=="string"?j:String(j);I.appendChild(document.createTextNode(Y))}}$(i,"setChildren");function e(I,j,F){for(;I;){if(I.contains(j))return!0;I=I.parentElement,F&&(I=I instanceof Element?I.closest(F):null)}return!1}$(e,"hasSharedParent");function o(I,j){return new Promise(F=>{const H=document.createElement("input");H.type="file",H.accept=I,H.multiple=j;let Y=!1;H.onchange=()=>{if(!Y){Y=!0;const st=Array.from(H.files??[]);F(j?st:st[0])}},H.click()})}$(o,"openFile");function a(I,j="utf-8"){return new Promise((F,H)=>{const Y=new FileReader;Y.readAsText(I,j),Y.onload=()=>F(Y.result),Y.onerror=st=>H(st)})}$(a,"readFile");const c=document.createElement("span");function d(I){c.textContent=I;const j=c.innerHTML;return c.textContent="",j}$(d,"sanitize");let m=0;const z=class z{constructor(j){this.id=j||m++,this._blocks={},this._style=s("style",{type:"text/css",id:`ffz--managed-style--${this.id}`}),document.head.appendChild(this._style)}destroy(){this._style&&this._style.remove(),this._blocks=null,this._style=null}clear(){this._blocks={},this._style.innerHTML=""}get(j){const F=this._blocks[j];if(F)return F.textContent}has(j){return!!this._blocks[j]}set(j,F,H=!1){const Y=this._blocks[j];if(Y){if(!H&&Y.textContent===F)return;Y.textContent=F}else this._style.appendChild(this._blocks[j]=document.createTextNode(F))}delete(j){const F=this._blocks[j];F&&(this._style.contains(F)&&this._style.removeChild(F),this._blocks[j]=null)}};$(z,"ManagedStyle");let w=z;const R=class R{constructor(j,F){this.el=j,this.cb=F,this._fn=this.handleClick.bind(this),document.documentElement.addEventListener("click",this._fn)}destroy(){this._fn&&document.documentElement.removeEventListener("click",this._fn),this.cb=this.el=this._fn=null}handleClick(j){this.cb&&this.el&&!this.el.contains(j.target)&&this.cb(j)}};$(R,"ClickOutside");let h=R;function p(I,j=!1,F=1,H=30){let Y="",st="";if(j&&(Y="    ".repeat(F-1),st="    ".repeat(F)),F>H)return'<span class="ffz-ct--obj-literal">&lt;nested&gt;</span>';if(I==null)return`<span class="ffz-ct--literal" depth="${F}">null</span>`;if(typeof I=="number"||typeof I=="boolean")return`<span class="ffz-ct--literal" depth="${F}">${I}</span>`;if(typeof I=="string")return`<span class=ffz-ct--string depth="${F}">${d(JSON.stringify(I))}</span>`;if(Array.isArray(I))return`<span class="ffz-ct--obj-open" depth="${F}">[</span>`+(I.length>0?I.map(it=>(j?`
${st}`:"")+p(it,j,F+1,H)).join(`<span class="ffz-ct--obj-sep" depth="${F}">, </span>`)+(j?`
${Y}`:""):"")+`<span class="ffz-ct--obj-close" depth="${F}">]</span>`;const tt=[];for(const[it,ut]of Object.entries(I))tt.length>0&&tt.push(`<span class="ffz-ct--obj-sep" depth="${F}">, </span>`),j&&tt.push(`
${st}`),tt.push(`<span class="ffz-ct--obj-key" depth="${F}">${d(JSON.stringify(it))}</span><span class="ffz-ct--obj-key-sep" depth="${F}">: </span>`),tt.push(p(ut,j,F+1,H));return`<span class="ffz-ct--obj-open" depth="${F}">{</span>${tt.join("")}${tt.length&&j?`
${Y}`:""}<span class="ffz-ct--obj-close" depth="${F}">}</span>`}$(p,"highlightJson")},83342:(q,T,f)=>{"use strict";f.d(T,{R7:()=>c,jo:()=>d});var N=f(44589);const y=f.p+"opendyslexic.css",_=["Roobert","Arial","Arial Black","Verdana","Helvetica","Tahoma","Trebuchet MS","Impact","Didot","American Typewriter","Lucida Console","Monaco","Bradley Hand","Times New Roman","Georgia","Garamond","Courier New","Brush Script MT","Comic Sans MS"],E=document.fonts?.check?_.filter(m=>document.fonts.check(`16px ${m}`)).sort():_.sort(),A=["Roboto","Open Sans","Noto Sans JP","Lato","Montserrat","Roboto Condensed","Source Sans Pro","Oswald","Poppins","Noto Sans","Roboto Mono","Raleway","Ubuntu","Merriweather","Nunito","PT Sans","Roboto Slab","Playfair Display","Lora","Rubik","Mukta","Noto Sans KR","Work Sans","Nunito Sans","Nanum Gothic","Inter","Quicksand","PT Serif","Hind Siliguri","Titilium Web","Fira Sans","Noto Serif","Noto Sans TC","Karla"],b=new Map,v=new Map;function r(m){if(v.has(m))return;const w=encodeURIComponent(m),h=(0,N.createElement)("link",{id:`ffz-font-${w}`,rel:"stylesheet",href:`https://fonts.googleapis.com/css2?family=${w}`});v.set(m,h),document.head.appendChild(h)}$(r,"loadGoogleFont");function n(m){const w=v.get(m);w&&(v.delete(m),w.remove())}$(n,"unloadGoogleFont");const s=["OpenDyslexic","OpenDyslexicAlta","OpenDyslexicMono"];let i=0,e=null;function o(){e||(e=(0,N.createElement)("link",{id:"ffz-font-opendyslexic",rel:"stylesheet",type:"text/css",href:y}),document.head.appendChild(e))}$(o,"loadOpenDyslexic");function a(){e&&(e.remove(),e=null)}$(a,"unloadOpenDyslexic");function c(){const m=[{value:"",i18n_key:"setting.font.default",title:"Default"},{separator:!0,i18n_key:"setting.font.builtin",title:"Built-in Fonts"}];for(const w of E)m.push({value:w,title:w});m.push({separator:!0,i18n_key:"setting.font.dyslexic",title:"Dyslexia Fonts"});for(const w of s)m.push({value:w,title:w});m.push({separator:!0,i18n_key:"setting.font.google",title:"Google Fonts"});for(const w of A)m.push({value:`google:${w}`,title:w});return m}$(c,"getFontsList");function d(m){if(!m)return[m,null];if(s.includes(m)){i++,i===1&&o();let w=!1;return[m,$(()=>{w||(w=!0,i--,i||a())},"unloader")]}if(m.startsWith("google:")){const w=m.slice(7),h=(b.get(w)??0)+1;b.set(w,h),h===1&&r(w);let p=!1;return[w,$(()=>{if(!p){p=!0;const R=(b.get(w)??0)-1;R>0?b.set(w,R):(b.delete(w),n(w))}},"unloader")]}return[m,null]}$(d,"useFont")},5286:(q,T,f)=>{"use strict";f.r(T),f.d(T,{MERGE_METHODS:()=>N,default:()=>_,mergeList:()=>y});const N={Document:(E,A)=>(E.definitions&&A.definitions?E.definitions=y(E.definitions,A.definitions):A.definitions&&(E.definitions=A.definitions),E),Field:(E,A)=>(E.name&&(!A.name||A.name.value!==E.name.value)||(E.selectionSet&&A.selectionSet?E.selectionSet=_(E.selectionSet,A.selectionSet):A.selectionSet&&(E.selectionSet=A.selectionSet)),E),OperationDefinition:(E,A)=>(E.operation!==A.operation||(E.selectionSet&&A.selectionSet?E.selectionSet=_(E.selectionSet,A.selectionSet):A.selectionSet&&(E.selectionSet=A.selectionSet)),E),FragmentDefinition:(E,A)=>(E.typeCondition&&A.typeCondition&&(E.typeCondition.kind!==A.typeCondition.kind||E.typeCondition.name.value!=A.typeCondition.name.value)||(E.selectionSet&&A.selectionSet?E.selectionSet=_(E.selectionSet,A.selectionSet):A.selectionSet&&(E.selectionSet=A.selectionSet)),E),SelectionSet:(E,A)=>(E.selections&&A.selections?E.selections=y(E.selections,A.selections):A.selections&&(E.selections=A.selections),E)};function y(E,A){let b=!1;const v={};for(const r of E)!r||!r.name||r.name.kind!=="Name"||(r.operation&&(b=!0),v[r.name.value]=r);for(const r of A){if(!r||!r.name||r.name.kind!=="Name")continue;const n=r.name.value,s=v[n]?E.indexOf(v[n]):-1;if(s!==-1){if(E[s].operation&&r.operation&&E[s].operation!==r.operation)continue;E[s]=_(E[s],r),E[s].operation&&(b=!0)}else{if(b&&r.operation)continue;E.push(r)}}return E}$(y,"mergeList");function _(E,A){return E.kind!==A.kind?E:N[E.kind]?N[E.kind](E,A):E}$(_,"merge")},83269:(q,T,f)=>{"use strict";f.r(T),f.d(T,{durationForChat:()=>E,durationForURL:()=>A,duration_to_string:()=>y,getBuster:()=>N,print_duration:()=>_});function N(b=5){const v=Math.floor(Date.now()/1e3);return v-v%b}$(N,"getBuster");function y(b,v,r,n,s){const i=b%60;let e=Math.floor(b/60),o=Math.floor(e/60),a="";if(e=e%60,v){const d=Math.floor(o/24);if(o=o%24,r&&d>0)return`${a} days`;a=d>0?`${d} days, `:""}const c=n===!1||a?.length>0||o>0;return`${a}${c?`${a&&o<10?"0":""}${o}:`:""}${c&&e<10?"0":""}${e}${s?"":`:${i<10?"0":""}${i}`}`}$(y,"duration_to_string");function _(b){let v=Math.floor(b/60);const r=Math.floor(v/60);return v%=60,b%=60,`${r>0?`${r}:${v<10?"0":""}`:""}${v}:${b<10?"0":""}${b}`}$(_,"print_duration");function E(b){const v=b%60;let r=Math.floor(b/60),n=Math.floor(r/60);const s=Math.floor(n/24);return r=r%60,n=n%24,`${s>0?`${s}d`:""}${n>0?`${n}h`:""}${r>0?`${r}m`:""}${v>0?`${v}s`:""}`}$(E,"durationForChat");function A(b){const v=b%60;let r=Math.floor(b/60);const n=Math.floor(r/60);return r=r%60,`${n>0?`${n}h`:""}${r>0?`${r}m`:""}${v>0?`${v}s`:""}`}$(A,"durationForURL")},27040:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>_});var N=f(22527),y=f(46949);const E=class E extends(f.j!=4609?N.default:null){constructor(b,v){super(b,v),this.apollo=null,this.site=null,this.site=this.parent,this.inject("site.apollo"),this._waiting_user_ids=new Map,this._waiting_user_logins=new Map,this._waiting_stream_ids=new Map,this._waiting_stream_logins=new Map,this._waiting_flag_ids=new Map,this._waiting_flag_logins=new Map,this.tag_cache=new Map,this._waiting_tags=new Map,this._loadStreams=(0,y.debounce)(this._loadStreams,50)}queryApollo(b,v,r){let n;return!v&&!r&&"query"in b&&b.query?n=b:(n={query:b,variables:v},r&&(n=Object.assign(n,r))),this.apollo.client.query(n)}mutate(b,v,r){let n;return!v&&!r&&"mutation"in b&&b.mutation?n=b:(n={mutation:b,variables:v},r&&(n=Object.assign(n,r))),this.apollo.client.mutate(n)}get languageCode(){const b=this.site.getSession();return b&&b.languageCode||"en"}get locale(){const b=this.site.getSession();return b&&b.locale||"en-US"}async getBadges(){const b=await this.queryApollo(await f.e(3224).then(f.t.bind(f,68905,23)));return(0,y.get)("data.badges",b)}async getMatchingCategories(b,v=15,r=null){const n=await this.queryApollo(await f.e(3224).then(f.t.bind(f,29817,23)),{query:b,first:v,cursor:r}),s=(0,y.get)("data.searchCategories.edges.@each.node",n)??[],i=b.toLowerCase();return Array.isArray(s)&&s.sort((e,o)=>{const a=e&&(e.name?.toLowerCase?.()===i||e?.displayName?.toLowerCase?.()===i),c=e&&(o.name?.toLowerCase?.()===i||o?.displayName?.toLowerCase?.()===i);return a&&!c?-1:!a&&c?1:0}),{cursor:(0,y.get)("data.searchCategories.edges.@last.cursor",n),items:s,finished:!(0,y.get)("data.searchCategories.pageInfo.hasNextPage",n),count:(0,y.get)("data.searchCategories.totalCount",n)||0}}async getCategory(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,95373,23)),{id:b,name:v});return(0,y.get)("data.game",r)}async deleteChatMessage(b,v){b=String(b);const r=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,4223,23)),variables:{input:{channelID:b,messageID:v}}}),n=(0,y.get)("data.deleteChatMessage.responseCode",r);if(n==="TARGET_IS_BROADCASTER")throw new y.TranslatableError("You cannot delete the broadcaster's messages.","chat.delete.forbidden.broadcaster");if(n==="TARGET_IS_MODERATOR")throw new y.TranslatableError("You cannot delete messages from moderator {displayName}.","chat.delete.forbidden.moderator",(0,y.get)("data.deleteChatMessage.message.sender",r));if(n!=="SUCCESS")throw new y.TranslatableError("You don't have permission to delete messages.","chat.delete.forbidden");return!0}async getMatchingUsers(b,v=15,r=null){const n=await this.queryApollo(await f.e(3224).then(f.t.bind(f,4176,23)),{query:b,first:v,cursor:r}),s=(0,y.get)("data.searchUsers.edges.@each.node",n)??[],i=b.toLowerCase();return Array.isArray(s)&&s.sort((e,o)=>{const a=e&&(e.login?.toLowerCase?.()===i||e?.displayName?.toLowerCase?.()===i),c=e&&(o.login?.toLowerCase?.()===i||o?.displayName?.toLowerCase?.()===i);return a&&!c?-1:!a&&c?1:0}),{cursor:(0,y.get)("data.searchUsers.edges.@last.cursor",n),items:s,finished:!(0,y.get)("data.searchUsers.pageInfo.hasNextPage",n),count:(0,y.get)("data.searchUsers.totalCount",n)||0}}async getUser(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,2247,23)),{id:b,login:v});return(0,y.get)("data.user",r)}async getUserGame(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,34489,23)),{id:b,login:v});return(0,y.get)("data.user.broadcastSettings.game",r)}async getUserSelf(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,23333,23)),{id:b,login:v});return(0,y.get)("data.user.self",r)}async getUserFollowed(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,70470,23)),{id:b,login:v});return(0,y.get)("data.user.self.follower",r)}async followUser(b,v=!1){b=String(b),v=!!v;const r=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,33886,23)),variables:{input:{targetID:b,disableNotifications:v}}});console.log("result",r);const n=(0,y.get)("data.followUser.error",r);if(n?.code)throw new Error(n.code);return(0,y.get)("data.followUser.follow",r)}async unfollowUser(b,v=!1){b=String(b),v=!!v;const r=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,65199,23)),variables:{input:{targetID:b}}});return console.log("result",r),(0,y.get)("data.unfollowUser.follow",r)}async getLastBroadcast(b,v){const r=await this.queryApollo(await f.e(3224).then(f.t.bind(f,27991,23)),{id:b,login:v});return(0,y.get)("data.user.lastBroadcast",r)}getUserBasic(b,v){return new Promise((r,n)=>{b?this._waiting_user_ids.has(b)?this._waiting_user_ids.get(b).push([r,n]):this._waiting_user_ids.set(b,[[r,n]]):v?this._waiting_user_logins.has(v)?this._waiting_user_logins.get(v).push([r,n]):this._waiting_user_logins.set(v,[[r,n]]):n("id and login cannot both be null"),this._loading_users||this._loadUsers()})}async _loadUsers(){if(this._loading_users)return;this._loading_users=!0;const b=[...this._waiting_user_ids.keys()].slice(0,50),v=50-b.length,r=v>0?[...this._waiting_user_logins.keys()].slice(0,v):[];let n;try{const e=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,59649,23)),variables:{ids:b.length?b:null,logins:r.length?r:null}});n=(0,y.get)("data.users",e)}catch(e){for(const o of b){const a=this._waiting_user_ids.get(o);this._waiting_user_ids.delete(o);for(const c of a)c[1](e)}for(const o of r){const a=this._waiting_user_logins.get(o);this._waiting_user_logins.delete(o);for(const c of a)c[1](e)}return}const s=new Set(b),i=new Set(r);if(Array.isArray(n))for(const e of n){if(!e||!e.id)continue;s.delete(e.id),i.delete(e.login);let o=this._waiting_user_ids.get(e.id);if(o){this._waiting_user_ids.delete(e.id);for(const a of o)a[0](e)}if(o=this._waiting_user_logins.get(e.login),o){this._waiting_user_logins.delete(e.login);for(const a of o)a[0](e)}}for(const e of s){const o=this._waiting_user_ids.get(e);if(o){this._waiting_user_ids.delete(e);for(const a of o)a[0](null)}}for(const e of i){const o=this._waiting_user_logins.get(e);if(o){this._waiting_user_logins.delete(e);for(const a of o)a[0](null)}}this._loading_users=!1,(this._waiting_user_ids.size||this._waiting_user_logins.size)&&this._loadUsers()}async getBroadcastID(b,v){const r=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,33929,23)),variables:{id:b,login:v}});return(0,y.get)("data.user.stream.archiveVideo.id",r)}async getChannelColor(b,v){const r=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,30252,23)),variables:{id:b,login:v}});return(0,y.get)("data.user.primaryColorHex",r)}async getPoll(b){const v=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,89218,23)),variables:{id:b}});return(0,y.get)("data.poll",v)}async createPoll(b,v,r,n={}){if(typeof v!="string")throw new TypeError("title must be string");if(!Array.isArray(r)||r.some(o=>typeof o!="string"))throw new TypeError("choices must be array of strings");let s=n.bits||0,i=n.duration||60;(typeof s!="number"||s<0)&&(s=0),(typeof i!="number"||i<0)&&(i=60);const e=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,31902,23)),variables:{input:{bitsCost:s,bitsVoting:s>0,choices:r.map(o=>({title:o})),durationSeconds:i,ownedBy:`${b}`,subscriberMultiplier:n.subscriberMultiplier||!1,subscriberOnly:n.subscriberOnly||!1,title:v}}});return(0,y.get)("data.createPoll.poll",e)}async archivePoll(b){const v=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,83852,23)),variables:{id:b}});return(0,y.get)("data.archivePoll.poll",v)}async terminatePoll(b){const v=await this.mutate({mutation:await f.e(3224).then(f.t.bind(f,20685,23)),variables:{id:b}});return(0,y.get)("data.terminatePoll.poll",v)}getStreamMeta(b,v){return new Promise((r,n)=>{b?this._waiting_stream_ids.has(b)?this._waiting_stream_ids.get(b).push([r,n]):this._waiting_stream_ids.set(b,[[r,n]]):v?this._waiting_stream_logins.has(v)?this._waiting_stream_logins.get(v).push([r,n]):this._waiting_stream_logins.set(v,[[r,n]]):n("id and login cannot both be null"),this._loading_streams||this._loadStreams()})}async _loadStreams(){if(this._loading_streams)return;this._loading_streams=!0;const b=[...this._waiting_stream_ids.keys()].slice(0,50),v=50-b.length,r=v>0?[...this._waiting_stream_logins.keys()].slice(0,v):[];let n;try{const e=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,61421,23)),variables:{ids:b.length?b:null,logins:r.length?r:null}});n=(0,y.get)("data.users",e)}catch(e){for(const o of b){const a=this._waiting_stream_ids.get(o);this._waiting_stream_ids.delete(o);for(const c of a)c[1](e)}for(const o of r){const a=this._waiting_stream_logins.get(o);this._waiting_stream_logins.delete(o);for(const c of a)c[1](e)}return}const s=new Set(b),i=new Set(r);if(Array.isArray(n))for(const e of n){if(!e||!e.id)continue;s.delete(e.id),i.delete(e.login);let o=this._waiting_stream_ids.get(e.id);if(o){this._waiting_stream_ids.delete(e.id);for(const a of o)a[0](e.stream)}if(o=this._waiting_stream_logins.get(e.login),o){this._waiting_stream_logins.delete(e.login);for(const a of o)a[0](e.stream)}}for(const e of s){const o=this._waiting_stream_ids.get(e);if(o){this._waiting_stream_ids.delete(e);for(const a of o)a[0](null)}}for(const e of i){const o=this._waiting_stream_logins.get(e);if(o){this._waiting_stream_logins.delete(e);for(const a of o)a[0](null)}}this._loading_streams=!1,(this._waiting_stream_ids.size||this._waiting_stream_logins.size)&&this._loadStreams()}getStreamFlags(b,v){return new Promise((r,n)=>{if(typeof b=="number"&&(b=`${b}`),b){const s=this._waiting_flag_ids.get(b);s?s.push([r,n]):this._waiting_flag_ids.set(b,[[r,n]])}else if(v){const s=this._waiting_flag_logins.get(v);s?s.push([r,n]):this._waiting_flag_logins.set(v,[[r,n]])}else n("id and login cannot both be null");this._loading_flags||this._loadStreamFlags()})}async _loadStreamFlags(){if(this._loading_flags)return;this._loading_flags=!0;const b=[...this._waiting_flag_ids.keys()].slice(0,50),v=50-b.length,r=v>0?[...this._waiting_flag_logins.keys()].slice(0,v):[];let n;try{const e=await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,9808,23)),variables:{ids:b.length?b:null,logins:r.length?r:null}});n=(0,y.get)("data.users",e)}catch(e){for(const o of b){const a=this._waiting_flag_ids.get(o);if(a){this._waiting_flag_ids.delete(o);for(const c of a)c[1](e)}}for(const o of r){const a=this._waiting_flag_logins.get(o);if(a){this._waiting_flag_logins.delete(o);for(const c of a)c[1](e)}}return}const s=new Set(b),i=new Set(r);if(Array.isArray(n))for(const e of n){if(!e||!e.id)continue;s.delete(e.id),i.delete(e.login);let o=this._waiting_flag_ids.get(e.id);if(o){this._waiting_flag_ids.delete(e.id);for(const a of o)a[0](e.stream?.contentClassificationLabels)}if(o=this._waiting_flag_logins.get(e.login),o){this._waiting_flag_logins.delete(e.login);for(const a of o)a[0](e.stream?.contentClassificationLabels)}}for(const e of s){const o=this._waiting_flag_ids.get(e);if(o){this._waiting_flag_ids.delete(e);for(const a of o)a[0](null)}}for(const e of i){const o=this._waiting_flag_logins.get(e);if(o){this._waiting_flag_logins.delete(e);for(const a of o)a[0](null)}}this._loading_flags=!1,(this._waiting_flag_ids.size||this._waiting_flag_logins.size)&&this._loadStreamFlags()}async getMatchingTags(b){const r=(await this.queryApollo({query:await f.e(3224).then(f.t.bind(f,50873,23)),variables:{query:b,first:100}}))?.data?.searchFreeformTags?.edges;if(!Array.isArray(r)||!r.length)return[];const n=[];for(const s of r){const i=s?.node?.tagName;i&&n.push(i)}return n}};$(E,"TwitchData");let _=E},90424:q=>{var T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FFZ_EmoteMenu_SubStatus"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"after"}},type:{kind:"NamedType",name:{kind:"Name",value:"Cursor"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"criteria"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SubscriptionBenefitCriteriaInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionBenefits"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"after"}}},{kind:"Argument",name:{kind:"Name",value:"criteria"},value:{kind:"Variable",name:{kind:"Name",value:"criteria"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pageInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasNextPage"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"gift"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isGift"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"purchasedWithPrime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endsAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"renewsAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"product"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteSetID"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:296}};T.loc.source={body:"query FFZ_EmoteMenu_SubStatus($first:Int$after:Cursor$criteria:SubscriptionBenefitCriteriaInput!){currentUser{id subscriptionBenefits(first:$first after:$after criteria:$criteria){pageInfo{hasNextPage}edges{cursor node{id gift{isGift}purchasedWithPrime endsAt renewsAt product{id emoteSetID}}}}}}",name:"GraphQL request",locationOffset:{line:1,column:1}};var f={};function N(b){return b.filter(function(v){if(v.kind!=="FragmentDefinition")return!0;var r=v.name.value;return f[r]?!1:(f[r]=!0,!0)})}$(N,"unique");function y(b,v){if(b.kind==="FragmentSpread")v.add(b.name.value);else if(b.kind==="VariableDefinition"){var r=b.type;r.kind==="NamedType"&&v.add(r.name.value)}b.selectionSet&&b.selectionSet.selections.forEach(function(n){y(n,v)}),b.variableDefinitions&&b.variableDefinitions.forEach(function(n){y(n,v)}),b.definitions&&b.definitions.forEach(function(n){y(n,v)})}$(y,"collectFragmentReferences");var _={};$(function(){T.definitions.forEach(function(v){if(v.name){var r=new Set;y(v,r),_[v.name.value]=r}})},"extractReferences")();function E(b,v){for(var r=0;r<b.definitions.length;r++){var n=b.definitions[r];if(n.name&&n.name.value==v)return n}}$(E,"findOperation");function A(b,v){var r={kind:b.kind,definitions:[E(b,v)]};b.hasOwnProperty("loc")&&(r.loc=b.loc);var n=_[v]||new Set,s=new Set,i=new Set;for(n.forEach(function(o){i.add(o)});i.size>0;){var e=i;i=new Set,e.forEach(function(o){if(!s.has(o)){s.add(o);var a=_[o]||new Set;a.forEach(function(c){i.add(c)})}})}return s.forEach(function(o){var a=E(b,o);a&&r.definitions.push(a)}),r}$(A,"oneQuery"),q.exports=T,q.exports.FFZ_EmoteMenu_SubStatus=A(T,"FFZ_EmoteMenu_SubStatus")},93953:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",[s("div",{staticClass:"tw-flex tw-align-items-center"},[s("label",{attrs:{for:"edit_reason"}},[r._v(`
			`+r._s(r.t("setting.actions.reason","Default Reason"))+`
		`)]),r._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:r.value.reason,expression:"value.reason",modifiers:{trim:!0}}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_reason"},domProps:{value:r.value.reason},on:{input:[function(i){i.target.composing||r.$set(r.value,"reason",i.target.value.trim())},function(i){return r.$emit("input",r.value)}],blur:function(i){return r.$forceUpdate()}}})])])},"render"),y=[];const E={props:["value","defaults"]};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},34727:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",[i("div",{staticClass:"tw-flex tw-align-items-start"},[i("label",{staticClass:"tw-mg-y-05",attrs:{for:"edit_chat$"+n.id}},[n._v(`
			`+n._s(n.t("setting.actions.chat","Chat Command"))+`
		`)]),n._v(" "),i("div",{staticClass:"tw-full-width"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.command,expression:"value.command"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_chat$"+n.id,placeholder:n.defaults.command},domProps:{value:n.value.command},on:{input:[function(e){e.target.composing||n.$set(n.value,"command",e.target.value)},function(e){return n.$emit("input",n.value)}]}}),n._v(" "),i("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[n._v(`
				`+n._s(n.t("setting.actions.variables","Available Variables: {vars}",{vars:n.vars}))+`
			`)]),n._v(" "),i("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[n._v(`
				`+n._s(n.t("setting.actions.formats","Available Formatters: {fmts}",{fmts:n.fmts}))+`
			`)]),n._v(" "),i("div",{staticClass:"ffz-checkbox"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.paste,expression:"value.paste"}],staticClass:"ffz-checkbox__input",attrs:{id:"chat-paste$"+n.id,type:"checkbox"},domProps:{checked:Array.isArray(n.value.paste)?n._i(n.value.paste,null)>-1:n.value.paste},on:{change:[function(e){var o=n.value.paste,a=e.target,c=!!a.checked;if(Array.isArray(o)){var d=null,m=n._i(o,d);a.checked?m<0&&n.$set(n.value,"paste",o.concat([d])):m>-1&&n.$set(n.value,"paste",o.slice(0,m).concat(o.slice(m+1)))}else n.$set(n.value,"paste",c)},function(e){return n.$emit("input",n.value)}]}}),n._v(" "),i("label",{staticClass:"ffz-checkbox__label",attrs:{for:"chat-paste$"+n.id}},[i("span",{staticClass:"tw-mg-l-1"},[n._v(`
						`+n._s(n.t("setting.actions.set-chat","Paste this message into chat rather than sending it directly."))+`
					`)])])])])]),n._v(" "),i("div",{staticClass:"tw-flex tw-align-items-start"},[i("label",{staticClass:"tw-mg-y-05",attrs:{for:"edit_chat_target$"+n.id}},[n._v(`
			`+n._s(n.t("setting.actions.chat.target","Target Channel"))+`
		`)]),n._v(" "),i("div",{staticClass:"tw-full-width"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.target,expression:"value.target"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_chat_target$"+n.id,placeholder:n.defaults.target||""},domProps:{value:n.value.target},on:{input:[function(e){e.target.composing||n.$set(n.value,"target",e.target.value)},function(e){return n.$emit("input",n.value)}]}}),n._v(" "),i("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[n._v(`
				`+n._s(n.t("setting.actions.chat.target-notice","Please note that when sending a message into another chat, you will not receive feedback that your message was sent."))+`
			`)]),n._v(" "),i("div",{staticClass:"tw-c-text-alt-2"},[n._v(`
				`+n._s(n.t("setting.actions.chat.target-incompatible","Note: This is not compatible with pasting a message into chat, and will not function if that is enabled."))+`
			`)])])])])},"render"),y=[];let _=0;const A={props:["value","defaults","vars","fmts"],data(){return{id:_++}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},56727:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",[s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label",{staticClass:"tw-mg-y-05"},[r._v(`
			`+r._s(r.t("setting.actions.icon","Icon"))+`
		`)]),r._v(" "),s("icon-picker",{staticClass:"tw-full-width",attrs:{value:r.value.icon},on:{input:r.change}})],1),r._v(" "),s("div",{staticClass:"tw-flex tw-align-items-center"},[s("label",{attrs:{for:"edit_text"}},[r._v(`
			`+r._s(r.t("setting.actions.text","Label"))+`
		`)]),r._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:r.value.text,expression:"value.text"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_text"},domProps:{value:r.value.text},on:{input:[function(i){i.target.composing||r.$set(r.value,"text",i.target.value)},function(i){return r.$emit("input",r.value)}]}})])])},"render"),y=[];const E={props:["value"],methods:{change(r){this.value.icon=r,this.$emit("input",this.value)}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},66038:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label",{staticClass:"tw-mg-y-05",attrs:{for:"edit_format"}},[r._v(`
		`+r._s(r.t("setting.actions.format","Format"))+`
	`)]),r._v(" "),s("div",{staticClass:"tw-full-width"},[s("input",{directives:[{name:"model",rawName:"v-model",value:r.value.format,expression:"value.format"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_format",placeholder:r.defaults.format},domProps:{value:r.value.format},on:{input:[function(i){i.target.composing||r.$set(r.value,"format",i.target.value)},function(i){return r.$emit("input",r.value)}]}}),r._v(" "),s("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[r._v(`
			`+r._s(r.t("setting.actions.variables","Available Variables: {vars}",{vars:r.vars}))+`
		`)]),r._v(" "),s("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[r._v(`
			`+r._s(r.t("setting.actions.formats","Available Formatters: {fmts}",{fmts:r.fmts}))+`
		`)])])])},"render"),y=[];const E={props:["value","defaults","vars","fmts"]};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},29668:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label",{staticClass:"tw-mg-y-05"},[r._v(`
		`+r._s(r.t("setting.actions.emote","Emote"))+`
	`)]),r._v(" "),s("emote-picker",{staticClass:"tw-full-width",attrs:{value:r.val},on:{input:r.change}})],1)},"render"),y=[];const E={props:["value"],data(){return{val:this.value}},watch:{value(){this.val=this.value}},methods:{change(r){this.val=r,this.$emit("input",this.val)}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},8684:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label",{staticClass:"tw-mg-y-05"},[r._v(`
		`+r._s(r.t("setting.actions.icon","Icon"))+`
	`)]),r._v(" "),s("icon-picker",{staticClass:"tw-full-width",attrs:{value:r.value.icon},on:{input:r.change}})],1)},"render"),y=[];const E={props:["value"],methods:{change(r){this.value.icon=r,this.$emit("input",this.value)}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},17816:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-center"},[s("label",{attrs:{for:"edit_image"}},[r._v(`
		`+r._s(r.t("setting.actions.url","URL"))+`
	`)]),r._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:r.value.image,expression:"value.image"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_image"},domProps:{value:r.value.image},on:{input:[function(i){i.target.composing||r.$set(r.value,"image",i.target.value)},function(i){return r.$emit("input",r.value)}]}})])},"render"),y=[];const E={props:["value"]};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},12893:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",[s("div",{staticClass:"tw-flex tw-align-items-center"},[s("label",{attrs:{for:"edit_profile"}},[r._v(`
			`+r._s(r.t("setting.actions.profile","Profile"))+`
		`)]),r._v(" "),s("select",{directives:[{name:"model",rawName:"v-model.trim",value:r.value.uuid,expression:"value.uuid",modifiers:{trim:!0}}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_profile"},on:{input:function(i){return r.$emit("input",r.value)},change:function(i){var e=Array.prototype.filter.call(i.target.options,function(o){return o.selected}).map(function(o){var a="_value"in o?o._value:o.value;return a});r.$set(r.value,"uuid",i.target.multiple?e:e[0])}}},r._l(r.profiles,function(i){return s("option",{key:i.value,domProps:{value:i.value}},[r._v(r._s(i.i18n_key?r.t(i.i18n_key,i.name):i.name))])}),0)])])},"render"),y=[];const E={props:["value","defaults"],data(){const r=window.FrankerFaceZ.get(),n=r?.resolve("settings"),s=n?.__profiles;return{profiles:s?s.map(i=>({value:i.uuid,name:i.name,i18n_key:i.i18n_key})):[]}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},74640:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-center"},[s("label",{attrs:{for:"edit_text"}},[r._v(`
		`+r._s(r.t("setting.actions.text","Label"))+`
	`)]),r._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:r.value.text,expression:"value.text"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_text"},domProps:{value:r.value.text},on:{input:[function(i){i.target.composing||r.$set(r.value,"text",i.target.value)},function(i){return r.$emit("input",r.value)}]}})])},"render"),y=[];const E={props:["value"]};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},69454:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",[o("div",{staticClass:"tw-flex tw-align-items-center"},[o("label",{attrs:{for:"edit_duration"}},[i._v(`
			`+i._s(i.t("setting.actions.duration","Duration"))+`
		`)]),i._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:i.value.duration_rich,expression:"value.duration_rich"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_duration",placeholder:i.defaults.duration,type:"text"},domProps:{value:i.value.duration_rich},on:{input:[function(a){a.target.composing||i.$set(i.value,"duration_rich",a.target.value)},function(a){return i.update()}]}})]),i._v(" "),o("div",{staticClass:"tw-flex tw-align-items-center"},[o("label",{attrs:{for:"edit_reason"}},[i._v(`
			`+i._s(i.t("setting.actions.reason","Default Reason"))+`
		`)]),i._v(" "),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:i.value.reason,expression:"value.reason",modifiers:{trim:!0}}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_reason"},domProps:{value:i.value.reason},on:{input:[function(a){a.target.composing||i.$set(i.value,"reason",a.target.value.trim())},function(a){return i.$emit("input",i.value)}],blur:function(a){return i.$forceUpdate()}}})])])},"render"),y=[];const _=/(\d+)(mo|d|h|m|s)?/gi,E={m:60,h:3600,d:86400,mo:86400*28,s:1};function A(i){let e=0,o;for(;o=_.exec(i);){const a=parseInt(o[1],10),c=(o[2]||"s").toLowerCase(),d=E[c]||1;if(isNaN(a))return NaN;e+=a*d}return e}$(A,"durationToSeconds");const v={props:["value","defaults"],created(){this.value.duration_rich==null&&(this.value.duration_rich=this.value.duration)},methods:{update(){this.value.duration=A(this.value.duration_rich),this.$emit("input",this.value)}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},86773:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label",{staticClass:"tw-mg-y-05",attrs:{for:"edit_url"}},[r._v(`
		`+r._s(r.t("setting.actions.url","URL"))+`
	`)]),r._v(" "),s("div",{staticClass:"tw-full-width"},[s("input",{directives:[{name:"model",rawName:"v-model",value:r.value.url,expression:"value.url"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",attrs:{id:"edit_url",placeholder:r.defaults.url},domProps:{value:r.value.url},on:{input:[function(i){i.target.composing||r.$set(r.value,"url",i.target.value)},function(i){return r.$emit("input",r.value)}]}}),r._v(" "),s("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[r._v(`
			`+r._s(r.t("setting.actions.variables","Available Variables: {vars}",{vars:r.vars}))+`
		`)]),r._v(" "),s("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[r._v(`
			`+r._s(r.t("setting.actions.formats","Available Formatters: {fmts}",{fmts:r.fmts}))+`
		`)])])])},"render"),y=[];const E={props:["value","defaults","vars","fmts"]};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},6234:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("span",{class:r.props.data.icon,style:{color:r.props.color}},[r._v(r._s(r.props.data.text))])},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},25816:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("figure",{staticClass:"mod-icon__image"},[n("img",{attrs:{src:r.props.data.src}})])},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},92123:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("figure",{class:""+(r.props.data.icon||"ffz-i-zreknarf"),style:{color:r.props.color}})},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},81725:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("figure",{staticClass:"mod-icon__image"},[n("img",{attrs:{src:r.props.data.image}})])},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},68185:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("span",{style:{color:r.props.color}},[r._v(r._s(r.props.data.text))])},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},29444:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--action tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-pd-r-1 tw-mg-y-05 tw-flex tw-flex-nowrap"},[s._m(0),s._v(" "),e("div",{staticClass:"tw-flex-grow-1"},[s.editing?s.copying?[e("textarea",{directives:[{name:"model",rawName:"v-model",value:s.json,expression:"json"}],ref:"json",staticClass:"tw-full-width tw-full-height tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{readonly:""},domProps:{value:s.json},on:{focus:function(o){return o.target.select()},input:function(o){o.target.composing||(s.json=o.target.value)}}})]:[e("section",[e("h5",[s._v(s._s(s.t("setting.actions.appearance","Appearance")))]),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"tooltip"}},[s._v(`
						`+s._s(s.t("setting.actions.tooltip","Custom Tooltip"))+`
					`)]),s._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.appearance.tooltip,expression:"edit_data.appearance.tooltip"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",domProps:{value:s.edit_data.appearance.tooltip},on:{input:function(o){o.target.composing||s.$set(s.edit_data.appearance,"tooltip",o.target.value)}}})]),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"renderer_type"}},[s._v(`
						`+s._s(s.t("setting.actions.type","Type"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.appearance.type,expression:"edit_data.appearance.type"}],ref:"renderer_type",staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"renderer_type"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.appearance,"type",o.target.multiple?a:a[0])}}},s._l(s.data.renderers,function(o,a){return s.supportsRenderer(a)?e("option",{key:a,domProps:{value:a}},[s._v(`
							`+s._s(o.title_i18n?s.t(o.title_i18n,o.title,o):o.title)+`
						`)]):s._e()}),0)]),s._v(" "),s.renderer&&s.renderer.colored?e("div",{staticClass:"tw-flex tw-align-items-start"},[e("label",{staticClass:"tw-mg-y-05",attrs:{for:"color"}},[s._v(`
						`+s._s(s.t("setting.actions.color","Color"))+`
					`)]),s._v(" "),e("div",{staticClass:"tw-full-width"},[e("color-picker",{attrs:{nullable:!0},model:{value:s.edit_data.appearance.color,callback:function(o){s.$set(s.edit_data.appearance,"color",o)},expression:"edit_data.appearance.color"}}),s._v(" "),e("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-1"},[s._v(`
							`+s._s(s.t("setting.actions.color.warn","This value will be automatically adjusted for visibility based on your chat color settings."))+`
						`)])],1)]):s._e(),s._v(" "),s.renderer?e(s.renderer.editor,{tag:"component",model:{value:s.edit_data.appearance,callback:function(o){s.$set(s.edit_data,"appearance",o)},expression:"edit_data.appearance"}}):s._e(),s._v(" "),s.extra_appearance?e(s.extra_appearance,{tag:"component",model:{value:s.edit_data.appearance,callback:function(o){s.$set(s.edit_data,"appearance",o)},expression:"edit_data.appearance"}}):s._e()],1),s._v(" "),e("section",{staticClass:"tw-mg-t-1 tw-border-t tw-pd-t-1"},[e("h5",[s._v(s._s(s.t("setting.actions.visibility","Visibility")))]),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_mod"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.mod","Moderator"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.mod,expression:"edit_data.display.mod"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_mod"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"mod",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]),s._v(" "),s.mod_icons?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_mod_icons"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.mod-icons","Mod Icons"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.mod_icons,expression:"edit_data.display.mod_icons"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_mod_icons"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"mod_icons",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.visible","Visible"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.hidden","Hidden"))+`
						`)])])]):s._e(),s._v(" "),s.has_following?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_following"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.following","Following User"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.following,expression:"edit_data.display.following"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_following"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"following",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_message?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_deleted"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.deleted","Message Deleted"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.deleted,expression:"edit_data.display.deleted"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_deleted"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"deleted",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_mode?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_emote"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.emote-only","Emote-Only Mode"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.emoteOnly,expression:"edit_data.display.emoteOnly"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_emote"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"emoteOnly",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_mode?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_slow"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.slow","Slow Mode"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.slowMode,expression:"edit_data.display.slowMode"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_slow"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"slowMode",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_mode?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_follows"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.follows","Follower-Only Mode"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.followersOnly,expression:"edit_data.display.followersOnly"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_subs"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"followersOnly",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_mode?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_subs"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.subs","Subs Mode"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.subsMode,expression:"edit_data.display.subsMode"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_subs"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"subsMode",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_mode?e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"vis_r9k"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.r9k","R9k Mode"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.display.r9kMode,expression:"edit_data.display.r9kMode"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"vis_r9k"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data.display,"r9kMode",o.target.multiple?a:a[0])}}},[e("option",{attrs:{selected:""},domProps:{value:void 0}},[s._v(`
							`+s._s(s.t("setting.unset","Unset"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!0}},[s._v(`
							`+s._s(s.t("setting.true","True"))+`
						`)]),s._v(" "),e("option",{domProps:{value:!1}},[s._v(`
							`+s._s(s.t("setting.false","False"))+`
						`)])])]):s._e(),s._v(" "),s.has_modifiers?e("div",{staticClass:"tw-flex tw-align-items-start"},[e("label",{attrs:{for:"vis_modifiers"}},[s._v(`
						`+s._s(s.t("setting.actions.edit-visible.modifier","Modifiers"))+`
					`)]),s._v(" "),e("div",[e("div",{staticClass:"ffz--inline tw-flex"},[e("div",{staticClass:"tw-pd-r-1 ffz-checkbox"},[e("input",{ref:"key_ctrl",staticClass:"ffz-checkbox__input",attrs:{id:"key_ctrl$"+s.id,type:"checkbox"},domProps:{checked:s.edit_data.display.keys&1},on:{change:s.onChangeKeys}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"key_ctrl$"+s.id}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
										`+s._s(s.t("setting.key.ctrl","Ctrl"))+`
									`)])])]),s._v(" "),e("div",{staticClass:"tw-pd-r-1 ffz-checkbox"},[e("input",{ref:"key_shift",staticClass:"ffz-checkbox__input",attrs:{id:"key_shift$"+s.id,type:"checkbox"},domProps:{checked:s.edit_data.display.keys&2},on:{change:s.onChangeKeys}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"key_shift$"+s.id}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
										`+s._s(s.t("setting.key.shift","Shift"))+`
									`)])])]),s._v(" "),e("div",{staticClass:"tw-pd-r-1 ffz-checkbox"},[e("input",{ref:"key_alt",staticClass:"ffz-checkbox__input",attrs:{id:"key_alt$"+s.id,type:"checkbox"},domProps:{checked:s.edit_data.display.keys&4},on:{change:s.onChangeKeys}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"key_alt$"+s.id}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
										`+s._s(s.t("setting.key.alt","Alt"))+`
									`)])])]),s._v(" "),e("div",{staticClass:"tw-pd-r-1 ffz-checkbox"},[e("input",{ref:"key_meta",staticClass:"ffz-checkbox__input",attrs:{id:"key_meta$"+s.id,type:"checkbox"},domProps:{checked:s.edit_data.display.keys&8},on:{change:s.onChangeKeys}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"key_meta$"+s.id}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
										`+s._s(s.t("setting.key.meta","Meta"))+`
									`)])])]),s._v(" "),s.has_hover_modifier?e("div",{staticClass:"tw-pd-r-1 ffz-checkbox"},[e("input",{ref:"key_hover",staticClass:"ffz-checkbox__input",attrs:{id:"key_hover$"+s.id,type:"checkbox"},domProps:{checked:s.edit_data.display.hover},on:{change:s.onChangeKeys}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"key_hover$"+s.id}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
										`+s._s(s.t("setting.key.hover","Hover"))+`
									`)])])]):s._e()])])]):s._e()]),s._v(" "),e("section",{staticClass:"tw-mg-t-1 tw-border-t tw-pd-t-1"},[e("h5",[s._v(s._s(s.t("setting.actions.action","Action")))]),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"action_type"}},[s._v(`
						`+s._s(s.t("setting.actions.type","Type"))+`
					`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.action,expression:"edit_data.action"}],staticClass:"tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-y-05",attrs:{id:"action_type"},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data,"action",o.target.multiple?a:a[0])}}},s._l(s.data.actions,function(o,a){return e("option",{key:a,domProps:{value:a}},[s._v(`
							`+s._s(s.t(o.title_i18n||"chat.actions."+a,o.title,o))+`
						`)])}),0)]),s._v(" "),s.action_def&&s.action_def.editor?e(s.action_def.editor,{tag:"component",attrs:{value:s.edit_data.options,defaults:s.action_def.defaults,vars:s.vars,fmts:s.fmts},on:{input:function(o){return s.onChangeAction(o)}}}):s._e()],1)]:[e("h4",[s._v(s._s(s.title))]),s._v(" "),e("div",{staticClass:"description"},[s._v(`
				`+s._s(s.description)+`
			`)]),s._v(" "),s.canEdit?e("div",{staticClass:"visibility tw-c-text-alt"},[s._v(`
				`+s._s(s.t("setting.actions.visible","visible: {list}",{list:s.visibility}))+`
			`)]):s._e()]],2),s._v(" "),s.canPreview?e("div",{staticClass:"tw-mg-l-1 tw-border-l tw-pd-l-1 tw-pd-y-05 tw-flex tw-flex-shrink-0 tw-align-items-start"},[e("action-preview",{attrs:{act:s.maybeDynamic(s.display),"process-color":s.data.color,renderers:s.data.renderers}})],1):s._e(),s._v(" "),e("div",{staticClass:"tw-mg-l-1 tw-border-l tw-pd-l-1 tw-flex tw-flex-wrap tw-flex-column tw-justify-content-start tw-align-items-start"},[s.copying?[e("button",{staticClass:"tw-button tw-button--text",on:{click:function(o){s.copying=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]:s._e(),s._v(" "),s.editing&&!s.copying?[e("button",{staticClass:"tw-button tw-button--text",on:{click:s.save}},[e("span",{staticClass:"tw-button__text ffz-i-floppy"},[s._v(`
					`+s._s(s.t("setting.save","Save"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text",on:{click:s.cancel}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text",on:{click:s.prepareCopy}},[e("span",{staticClass:"tw-button__text ffz-i-docs"},[s._v(`
					`+s._s(s.t("setting.copy-json","Copy"))+`
				`)])])]:s.deleting&&!s.copying?[e("button",{staticClass:"tw-button tw-button--text",on:{click:function(o){return s.$emit("remove",s.action)}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text",on:{click:function(o){s.deleting=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]:s.copying?s._e():[s.canEdit?e("button",{staticClass:"tw-button tw-button--text",on:{click:s.edit}},[e("span",{staticClass:"tw-button__text ffz-i-cog"},[s._v(`
					`+s._s(s.t("setting.edit","Edit"))+`
				`)])]):s._e(),s._v(" "),e("button",{staticClass:"tw-button tw-button--text",on:{click:function(o){s.deleting=!0}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])])]],2)])},"render"),y=[function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-start handle tw-pd-x-05 tw-pd-t-1 tw-pd-b-05"},[e("span",{staticClass:"ffz-i-ellipsis-vert"})])}],_=f(46949);let E=0;const b={props:["vuectx","action","data","inline","mod_icons","extra_appearance","context","modifiers","hover_modifier"],data(){return{id:E++,copying:!1,deleting:!1,editing:!1,edit_data:null}},computed:{json(){return JSON.stringify(this.display)},display(){return this.editing?this.edit_data:this.action.v},has_message(){return this.context&&this.context.includes("message")},has_following(){return this.context&&this.context.includes("following")},has_mode(){return this.context&&this.context.includes("room-mode")},has_modifiers(){return this.modifiers},has_hover_modifier(){return this.hover_modifier!==!1},fmts(){const s=[];return s.push("word(start)"),s.push("word(start,end)"),s.push("upper"),s.push("lower"),s.push("snakecase"),s.push("slugify"),s.push("slugify(separator)"),s.push("urlencode"),s.join(", ")},vars(){const s=[],i=this.context||[];return i.includes("user")&&(s.push("user.login"),s.push("user.displayName"),s.push("user.id"),s.push("user.type")),i.includes("room")&&(s.push("room.login"),s.push("room.id")),i.includes("message")&&(s.push("message.id"),s.push("message.text")),s.map(e=>`{{${e}}}`).join(", ")},renderer(){return this.canPreview&&this.data.renderers[this.display.appearance.type]},action_def(){return this.display&&this.data.actions[this.display.action]},canEdit(){return this.action.v!=null&&!this.action.v.type},canPreview(){return this.display&&this.display.appearance},title(){if(this.action.t==="inherit")return this.t("setting.inheritance","Inheritance Point");if(this.action.t==="skip")return this.t("setting.inheritance.skip","Not Inheriting");if(!this.display)return this.t("setting.unknown","Unknown Value");const s=this.display.type;if(s==="new-line")return this.t("setting.new-line","New Line");if(s==="space-small")return this.t("setting.space-small","Space (Small)");if(s==="space")return this.t("setting.space","Space");const i=this.data.actions[this.display.action];if(!i)return this.t("setting.actions.unknown","Unknown Action Type: {action}",this.display);if(i.title){const e=this.getData(),o=(0,_.maybe_call)(i.title,this,e,i);let a=(0,_.maybe_call)(i.title_i18n,this,e,i);if(a===void 0&&(a=`chat.actions.${this.display.action}`),o&&a)return this.t(a,o,e);if(o)return o}return this.t("setting.actions.untitled","Action: {action}",this.display)},description(){if(this.action.t==="inherit")return this.t("setting.inheritance.desc","Inherit values from lower priority profiles or the default values at this position.");if(this.action.t==="skip")return this.t("setting.inheritance.skip.desc","This profile does not inherit values from lower priority profiles or the default values, despite having no values of its own.");const s=this.display&&this.display.type;if(s==="new-line")return this.t("setting.new-line.desc","Place all items following this on a new line.");if(s==="space-small")return this.t("setting.space-small.desc","Place a small space between the previous item and the next item.");if(s==="space")return this.t("setting.space.desc","Place as large a space as possible between the previous item and the next item.");const i=this.display&&this.data.actions[this.display.action];if(!i||!i.description)return null;const e=this.getData(),o=(0,_.maybe_call)(i.description,this,e,i);let a=(0,_.maybe_call)(i.description_i18n,this,e,i);return a===void 0&&(a=`chat.actions.${this.display.action}.desc`),o&&a?this.t(a,o,e):o||null},visibility(){if(!this.display||!this.display.appearance)return;const s=this.display.display||{},i=[];if(s.disable)return this.t("setting.actions.visible.never","never");if(s.following===!0?i.push(this.t("setting.actions.visible.following","when following user")):s.following===!1&&i.push(this.t("setting.actions.visible.unfollowing","when not following user")),s.mod===!0?i.push(this.t("setting.actions.visible.mod","when moderator")):s.mod===!1&&i.push(this.t("setting.actions.visible.unmod","when not moderator")),s.mod_icons===!0?i.push(this.t("setting.actions.visible.mod_icons","when mod icons are shown")):s.mod_icons===!1&&i.push(this.t("setting.actions.visible.mod_icons_off","when mod icons are hidden")),s.staff===!0?i.push(this.t("setting.actions.visible.staff","when staff")):s.staff===!1&&i.push(this.t("setting.actions.visible.unstaff","when not staff")),s.deleted===!0?i.push(this.t("setting.actions.visible.deleted","if message deleted")):s.deleted===!1&&i.push(this.t("setting.actions.visible.undeleted","if message not deleted")),this.has_mode&&(s.emoteOnly===!0?i.push(this.t("setting.actions.visible.emote-only","when emote-only mode")):s.emoteOnly===!1&&i.push(this.t("setting.actions.visible.no-emote","when not emote-only mode")),s.slowMode===!0?i.push(this.t("setting.actions.visible.slow","when slow mode")):s.slowMode===!1&&i.push(this.t("setting.actions.visible.no-slow","when not slow mode")),s.subsMode===!0?i.push(this.t("setting.actions.visible.subs","when subs mode")):s.subsMode===!1&&i.push(this.t("setting.actions.visible.no-subs","when not subs mode")),s.r9kMode===!0?i.push(this.t("setting.actions.visible.r9k","when r9k mode")):s.r9kMode===!1&&i.push(this.t("setting.actions.visible.no-r9k","when not r9k mode")),s.followersOnly===!0?i.push(this.t("setting.actions.visible.followers","when followers-only mode")):s.followersOnly===!1&&i.push(this.t("setting.actions.visible.no-followers","when not followers-only mode"))),s.keys){const e=[];s.keys&1&&e.push(this.t("setting.key.ctrl","Ctrl")),s.keys&2&&e.push(this.t("setting.key.shift","Shift")),s.keys&4&&e.push(this.t("setting.key.alt","Alt")),s.keys&8&&e.push(this.t("setting.key.meta","Meta")),e.length&&i.push(this.t("setting.actions.visible.modifier","when {key_list} {keys, plural, one {is} other {are}} held",{key_list:e.join(" + "),keys:e.length}))}return this.has_hover_modifier&&s.hover&&i.push(this.t("setting.actions.visible.hover","when hovering")),i.length?i.join(", "):this.t("setting.actions.visible.always","always")}},methods:{onChangeAction(s){for(const i in s)if((0,_.has)(s,i)){const e=s[i];typeof e=="string"&&!e.length&&delete s[i]}this.edit_data.options=s},onChangeKeys(){if(!this.editing)return;let s=0;this.$refs.key_ctrl.checked&&(s|=1),this.$refs.key_shift.checked&&(s|=2),this.$refs.key_alt.checked&&(s|=4),this.$refs.key_meta.checked&&(s|=8),this.edit_data.display.keys=s,this.has_hover_modifier&&(this.edit_data.display.hover=this.$refs.key_hover.checked)},edit(){this.canEdit&&(this.editing=!0,this.edit_data=(0,_.deep_copy)(this.action.v),this.edit_data.options||(this.edit_data.options={}),this.edit_data.display||(this.edit_data.display={}),this.edit_data.appearance||(this.edit_data.appearance={}))},save(){this.$emit("save",this.edit_data),this.cancel()},prepareCopy(){this.copying=!0,requestAnimationFrame(()=>{this.$refs.json.focus()})},cancel(){this.copying=!1,this.editing=!1,this.edit_data=null},maybeDynamic(s){let i=s.appearance;if(i?.type==="dynamic"){const e=this.action_def,o=this.vuectx.getFFZ(),a=o&&o.resolve("chat.actions"),c=a&&e?.dynamicAppearance&&e.dynamicAppearance.call(a,(0,_.deep_copy)(i),s,null,null,null,null);if(c)return Object.assign({},s,{appearance:c})}return s},supportsRenderer(s){return s!=="dynamic"?!0:this.action_def?.supports_dynamic},getData(){const s=this.display&&this.data.actions[this.display.action];if(s)return Object.assign({},this.display,{options:Object.assign({},s&&s.defaults,this.display.options)})}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},99974:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"mod-icon ffz-mod-icon tw-c-text-alt-2 tw-font-size-4",class:{"ffz-tooltip":r.tooltip,"tw-pd-05":r.pad,colored:r.color&&r.color.length>0},attrs:{"data-action":r.act.action,"data-options":r.act.options?JSON.stringify(r.act.options):null,"data-tip":r.act.appearance.tooltip,"data-tooltip-type":"action"}},[r.renderer&&r.renderer.component?s(r.renderer.component,{tag:"component",attrs:{data:r.act.appearance,color:r.color}}):r._e()],1)},"render"),y=[];const E={props:["act","process-color","tooltip","pad","renderers"],computed:{color(){return this.processColor(this.act.appearance.color)},renderer(){return this.renderers[this.act.appearance.type]}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},28695:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--addons tw-border-t tw-pd-y-1"},[r.reload?s("div",{staticClass:"tw-mg-y-1 tw-c-background-accent tw-c-text-overlay tw-pd-1"},[s("h4",{staticClass:"ffz-i-attention"},[r._v(`
			`+r._s(r.t("addon.refresh-needed","You must refresh your Twitch pages for some changes to take effect."))+`
		`)]),r._v(" "),s("button",{staticClass:"tw-button tw-button--text tw-c-text-overlay tw-mg-t-05",on:{click:function(i){return r.item.refresh()}}},[r._m(0),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
				`+r._s(r.t("addon.refresh","Refresh"))+`
			`)])])]):r._e(),r._v(" "),r.ready?s("div",{staticClass:"tw-mg-b-1 tw-flex tw-align-items-center"},[s("div",{staticClass:"ffz-checkbox tw-relative tw-flex-grow-1"},[s("input",{directives:[{name:"model",rawName:"v-model",value:r.filter_enabled,expression:"filter_enabled"}],staticClass:"ffz-checkbox__input",attrs:{id:"filter_enabled",type:"checkbox"},domProps:{checked:Array.isArray(r.filter_enabled)?r._i(r.filter_enabled,null)>-1:r.filter_enabled},on:{change:function(i){var e=r.filter_enabled,o=i.target,a=!!o.checked;if(Array.isArray(e)){var c=null,d=r._i(e,c);o.checked?d<0&&(r.filter_enabled=e.concat([c])):d>-1&&(r.filter_enabled=e.slice(0,d).concat(e.slice(d+1)))}else r.filter_enabled=a}}}),r._v(" "),s("label",{staticClass:"ffz-checkbox__label",attrs:{for:"filter_enabled"}},[s("span",{staticClass:"tw-mg-l-1"},[r._v(`
					`+r._s(r.t("addon.filter-enabled","Only display enabled add-ons."))+`
				`)])])]),r._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:r.sort_by,expression:"sort_by"}],staticClass:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-x-05",on:{change:function(i){var e=Array.prototype.filter.call(i.target.options,function(o){return o.selected}).map(function(o){var a="_value"in o?o._value:o.value;return a});r.sort_by=i.target.multiple?e:e[0]}}},[s("option",{domProps:{value:0}},[r._v(`
				`+r._s(r.t("addon.sort-name","Sort By: Name"))+`
			`)]),r._v(" "),s("option",{domProps:{value:1}},[r._v(`
				`+r._s(r.t("addon.sort-update","Sort By: Updated"))+`
			`)]),r._v(" "),s("option",{domProps:{value:2}},[r._v(`
				`+r._s(r.t("addon.sort-create","Sort By: Created"))+`
			`)])])]):r._e(),r._v(" "),r.ready?s("div",r._l(r.visible_addons,function(i){return s("addon",{key:i.id,attrs:{id:i.id,addon:i,item:r.item,context:r.context},on:{navigate:r.navigate,"change-item":r.changeItem}})}),1):s("div",{staticClass:"tw-align-center tw-pd-1"},[s("h1",{staticClass:"tw-mg-5 ffz-i-zreknarf loading"})]),r._v(" "),r.ready&&r.visible_addons.length!==r.listed_addons.length?s("div",{staticClass:"tw-align-center tw-pd-1"},[r._v(`
		`+r._s(r.t("addon.displaying","Displaying {visible, number} of {total, plural, one {# add-on} other {# add-ons} }.",{visible:r.visible_addons.length,total:r.listed_addons.length}))+`
		`),r.filter?[r._v(`
			`+r._s(r.t("addon.displaying.filtered","The visible add-ons are being filtered by your search. Clear it to view all available add-ons."))+`
		`)]:r._e()],2):r._e(),r._v(" "),r.visible_unlisted?s("div",{staticClass:"tw-flex tw-align-items-center"},[s("div",{staticClass:"tw-flex-grow-1"}),r._v(" "),s("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:r.closeUnlisted,expression:"closeUnlisted"}],staticClass:"tw-relative"},[s("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",on:{click:r.toggleUnlisted}},[s("span",{staticClass:"tw-button__text ffz-i-help"},[r._v(`
					`+r._s(r.t("addon.unlisted.add","Add Unlisted..."))+`
				`)])]),r._v(" "),r.unlisted_open?s("balloon",{attrs:{color:"background-alt-2",dir:"up-right",size:"md"}},[s("div",{staticClass:"tw-pd-1"},[s("div",{staticClass:"tw-pd-b-1"},[r._v(`
						`+r._s(r.t("addon.unlisted.explain","Unlisted Add-Ons are add-ons that have undergone approval but have opted to avoid being listed in the main listing. This could be due to the add-on being specialized for certain users, or due to the add-on being still under development. If you know an unlisted add-on's ID, enter it here for it to be displayed."))+`
					`)]),r._v(" "),s("div",{staticClass:"tw-flex tw-align-items-center"},[s("input",{ref:"unlisted",staticClass:"tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{placeholder:r.t("addon.unlisted.id","add-on id")},on:{keydown:function(i){return!i.type.indexOf("key")&&r._k(i.keyCode,"enter",13,i.key,"Enter")?null:r.addUnlisted.apply(null,arguments)}}}),r._v(" "),s("button",{staticClass:"tw-mg-l-05 tw-button",on:{click:r.addUnlisted}},[s("span",{staticClass:"tw-button__text ffz-i-plus"},[r._v(`
								`+r._s(r.t("setting.add","Add"))+`
							`)])])])])]):r._e()],1)]):r._e()])},"render"),y=[function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-arrows-cw"})])}];const E={props:["item","context","filter"],data(){return{ready:this.item.isReady(),reload:this.item.isReloadRequired(),unlisted:[],filter_enabled:!1,sort_by:0,unlisted_open:!1}},computed:{visible_unlisted(){return this.visible_addons.length!==this.sorted_addons.length},visible_addons(){return this.sorted_addons.filter(r=>this.shouldShow(r))},listed_addons(){return this.sorted_addons.filter(r=>!r.unlisted)},sorted_addons(){const r=this.item.getAddons();return r.sort((n,s)=>{if(this.sort_by===1){if(n.updated>s.updated)return-1;if(s.updated>n.updated)return 1}else if(this.sort_by===2){if(n.created>s.created)return-1;if(s.created>n.created)return 1}if(n.sort<s.sort)return-1;if(s.sort<n.sort)return 1;const i=(n.name??n.id).toLowerCase(),e=(s.name??s.id).toLowerCase();return i<e?-1:e<i?1:0}),r}},created(){this.item.on(":ready",this.onReady,this),this.item.on(":added",this.onAdded,this),this.item.on(":reload-required",this.onReload,this)},destroyed(){this.item.off(":ready",this.onReady,this),this.item.off(":added",this.onAdded,this),this.item.off(":reload-required",this.onReload,this)},methods:{addUnlisted(){let r=this.$refs.unlisted.value;if(r&&(r=r.trim().toLowerCase()),r&&r.length)for(const n of this.item.getAddons())n.unlisted&&(n.id===r||n.short_name&&n.short_name.toLowerCase()===r||n.name&&n.name.toLowerCase()===r)&&this.unlisted.push(n.id);this.$refs.unlisted.value="",this.closeUnlisted()},closeUnlisted(){this.unlisted_open=!1},toggleUnlisted(){this.unlisted_open=!this.unlisted_open},shouldShow(r){const n=this.item.isAddonEnabled(r.id);return!(r.unlisted&&!n&&!this.unlisted.includes(r.id)||this.filter_enabled&&!n||this.filter&&this.filter.query&&(!r.search_terms||!r.search_terms.includes(this.filter.query)))},onAdded(){this.$forceUpdate()},onReady(){this.ready=!0},onReload(){this.reload=!0},navigate(...r){this.$emit("navigate",...r)},changeItem(...r){this.$emit("change-item",...r)}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},64004:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--addon-info tw-elevation-1 tw-c-background-base tw-border tw-border-radius-large tw-pd-1 tw-mg-b-1 tw-flex tw-flex-nowrap"},[s("div",{staticClass:"tw-flex tw-flex-column tw-align-center tw-flex-shrink-0 tw-mg-r-1"},[s("div",{staticClass:"ffz-card-img--size-6 tw-overflow-hidden tw-mg-b-1"},[s("img",{staticClass:"tw-image",attrs:{src:r.icon}})]),r._v(" "),r.reloading?s("div",{staticClass:"tw-mg-b-05 ffz-pill"},[r._v(`
			`+r._s(r.t("addon.reloading","Reloading"))+`
		`)]):r._e(),r._v(" "),r.external?s("div",{staticClass:"tw-mg-b-05 ffz-pill"},[r._v(`
			`+r._s(r.t("addon.external","External"))+`
		`)]):r.enabled?s("div",{staticClass:"tw-mg-b-05 ffz-pill ffz--pill-enabled"},[r._v(`
			`+r._s(r.t("addon.enabled","Enabled"))+`
		`)]):r._e(),r._v(" "),r.addon.dev?s("div",{staticClass:"tw-mg-b-05 ffz-pill"},[r._v(`
			`+r._s(r.t("addon.dev","Developer"))+`
		`)]):r._e(),r._v(" "),r.addon.unlisted?s("div",{staticClass:"tw-mg-b-05 ffz-pill"},[r._v(`
			`+r._s(r.t("addon.unlisted","Unlisted"))+`
		`)]):r._e()]),r._v(" "),s("div",{staticClass:"tw-flex-grow-1"},[s("div",{staticClass:"tw-border-b tw-mg-b-05"},[s("h4",[r._v(`
				`+r._s(r.addon.name_i18n?r.t(r.addon.name_i18n,r.addon.name):r.addon.name)+`
				`),r.addon.dev||r.addon.unlisted?s("span",{staticClass:"tw-c-text-alt-2 tw-font-size-6"},[r._v(`
					(`+r._s(r.addon.id)+`)
				`)]):r._e()]),r._v(" "),r.addon.author?s("span",{staticClass:"tw-c-text-alt tw-mg-r-1"},[r._v(`
				`+r._s(r.t("addon.author","By: {author}",{author:r.addon.author_i18n?r.t(r.addon.author_i18n,r.addon.author):r.addon.author}))+`
			`)]):r._e(),r._v(" "),r.maintainer?s("span",{staticClass:"tw-c-text-alt tw-mg-r-1"},[r._v(`
				`+r._s(r.t("addon.maintainer","Maintainer: {maintainer}",{maintainer:r.maintainer}))+`
			`)]):r._e(),r._v(" "),r.version?s("span",{staticClass:"tw-c-text-alt tw-mg-r-1"},[r._v(`
				`+r._s(r.t("addon.version","Version {version}",{version:r.version}))+`
			`)]):r._e(),r._v(" "),r.addon.updated&&r.addon.updated!=r.addon.created?s("span",{staticClass:"tw-c-text-alt ffz-tooltip tw-mg-r-1",attrs:{"data-title":r.tDateTime(r.addon.updated)}},[r._v(`
				`+r._s(r.t("addon.updated","Updated: {when,humantime}",{when:r.addon.updated}))+`
			`)]):r._e(),r._v(" "),r.addon.created?s("span",{staticClass:"tw-c-text-alt ffz-tooltip tw-mg-r-1",attrs:{"data-title":r.tDateTime(r.addon.created)}},[r._v(`
				`+r._s(r.t("addon.created","Created: {when,date}",{when:r.addon.created}))+`
			`)]):r._e()]),r._v(" "),s("markdown",{attrs:{source:r.show_description}}),r._v(" "),r.multi_line?s("a",{staticClass:"tw-c-text-alt-2",attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),r.toggle.apply(null,arguments)}}},[r.expanded?[r._v(r._s(r.t("addon.show-less","(Show Less)")))]:[r._v(r._s(r.t("addon.show-more","(Show More)")))]],2):r._e(),r._v(" "),s("div",{staticClass:"tw-mg-t-1 tw-pd-t-1 tw-border-t"},[r.enabled?[r.external?s("button",{staticClass:"tw-button ffz-button--hollow tw-button--disabled ffz-il-tooltip__container tw-mg-r-1",attrs:{disabled:""}},[r._m(0),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
						`+r._s(r.t("addon.disable","Disable"))+`
					`)]),r._v(" "),s("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-left"},[r._v(`
						`+r._s(r.t("addon.external.description","This add-on has been loaded by an external script and cannot be disabled here."))+`
					`)])]):s("button",{staticClass:"tw-button ffz--button-disable tw-mg-r-1",on:{click:function(i){return r.item.disableAddon(r.id)}}},[r._m(1),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
						`+r._s(r.t("addon.disable","Disable"))+`
					`)])]),r._v(" "),r.addon.dev&&r.can_reload?s("button",{staticClass:"tw-button ffz-button--hollow tw-mg-r-1",class:{"tw-button--disabled":r.reloading},attrs:{disabled:r.reloading},on:{click:function(i){return r.reloadAddon()}}},[r._m(2),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
						`+r._s(r.t("addon.reload","Reload"))+`
					`)])]):r._e(),r._v(" "),r.addon.settings?s("button",{staticClass:"tw-button ffz-button--hollow tw-mg-r-1",on:{click:function(i){return r.openSettings()}}},[r._m(3),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
						`+r._s(r.t("addon.settings","Settings"))+`
					`)])]):r._e()]:[s("button",{staticClass:"tw-button ffz--button-enable tw-mg-r-1",on:{click:function(i){return r.item.enableAddon(r.id)}}},[r._m(4),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
						`+r._s(r.t("addon.enable","Enable"))+`
					`)])])],r._v(" "),r.external?r._e():s("button",{staticClass:"tw-button ffz-button--hollow tw-mg-r-1",on:{click:r.openChangelog}},[r._m(5),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
					`+r._s(r.t("addon.changelog","Changelog"))+`
				`)])]),r._v(" "),r.addon.website?s("a",{staticClass:"tw-button ffz-button--hollow tw-mg-r-1 ffz-tooltip ffz-tooltip--no-mouse",attrs:{href:r.addon.website,title:r.addon.website,"data-tooltip-type":"link",target:"_blank",rel:"noopener"}},[r._m(6),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
					`+r._s(r.t("addon.website","Website"))+`
				`)])]):r._e()],2)],1)])},"render"),y=[function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-trash"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-trash"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-arrows-cw"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-cog"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-download"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-doc-text"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-link-ext"})])}];const E={props:["id","addon","item","context"],data(){return{enabled:this.item.isAddonEnabled(this.id),can_reload:this.addon.dev&&this.item.canReloadAddon(this.id),reloading:!1,external:this.item.isAddonExternal(this.id),version:this.item.getVersion(this.id),expanded:!1}},computed:{icon(){return this.addon.icon||"https://cdn.frankerfacez.com/badge/2/4/solid"},description(){return this.addon.description_i18n?this.t(this.addon.description_i18n,this.addon.description):this.addon.description?this.addon.description:this.t("addon.no-desc","*No description.*")},maintainer(){return this.addon.maintainer_i18n?this.t(this.addon.maintainer_i18n,this.addon.maintainer):this.addon.maintainer},lines(){return this.description.split(/\n/)},multi_line(){return this.lines.length>1},first_line(){return this.lines[0]},show_description(){return this.expanded?this.description:this.first_line}},created(){this.item.on("i18n:update",this.updateDescription,this),this.item.on(":added",this.refreshExternal,this),this.item.on(":ready",this.refreshExternal,this),this.item.on(":addon-enabled",this.onEnabled,this),this.item.on(":addon-disabled",this.onDisabled,this)},destroyed(){this.item.off("i18n:update",this.updateDescription,this),this.item.off(":added",this.refreshExternal,this),this.item.off(":ready",this.refreshExternal,this),this.item.off(":addon-enabled",this.onEnabled,this),this.item.off(":addon-disabled",this.onDisabled,this)},methods:{refreshExternal(){this.external=this.item.isAddonExternal(this.id),this.version=this.item.getVersion(this.id)},updateDescription(){this.addon.description_i18n?this.description=this.t(this.addon.description_i18n,this.addon.description):this.description=this.addon.description;const r=this.description.split(/\n/);this.multi_line=r.length>1,this.first_line=r[0]},onEnabled(r){r===this.id&&(this.enabled=!0),this.version=this.item.getVersion(this.id)},onDisabled(r){r===this.id&&(this.enabled=!1)},toggle(){this.expanded=!this.expanded},openSettings(){if(typeof this.addon.settings=="string"){this.$emit("navigate",this.addon.settings);return}const r=[`add_ons.${this.id}`];this.addon.short_name&&r.push(`add_ons.${this.addon.short_name.toSnakeCase()}`),this.addon.name&&r.push(`add_ons.${this.addon.name.toSnakeCase()}`),this.$emit("navigate",...r)},openChangelog(){const r=[`add_ons.changelog.${this.id}`];this.addon.short_name&&r.push(`add_ons.changelog.${this.addon.short_name.toSnakeCase()}`),this.addon.name&&r.push(`add_ons.changelog.${this.addon.name.toSnakeCase()}`),this.$emit("navigate",...r)},reloadAddon(){this.reloading=!0,this.item.reloadAddon(this.id).then(()=>{this.reloading=!1,this.can_reload=this.item.canReloadAddon(this.id)}).catch(r=>{console.error(r),this.reloading=!1})}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},64530:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--example-report tw-relative "},[r.canUpload?s("div",{staticClass:"tw-absolute ffz--report-upload"},[r.uploading?s("div",[s("button",{staticClass:"tw-button tw-button--disabled",attrs:{disabled:""}},[r._m(0),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
					`+r._s(r.t("async-text.uploading","Uploading..."))+`
				`)])])]):r.url?s("div",[s("input",{ref:"url_box",staticClass:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{type:"text",readonly:""},domProps:{value:r.url},on:{focusin:r.selectURL}})]):s("div",[s("button",{staticClass:"tw-button",on:{click:r.upload}},[r._m(1),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
					`+r._s(r.t("async-text.upload","Upload"))+`
				`)])])])]):r._e(),r._v(" "),s("div",{staticClass:"tw-c-background-alt-2 tw-font-size-5 tw-pd-y-05 tw-pd-x-1 tw-border-radius-large"},[r.loading?s("div",{staticClass:"tw-align-center"},[s("h1",{staticClass:"tw-mg-5 ffz-i-zreknarf loading"})]):s("code",[r._v(r._s(r.text))])])])},"render"),y=[function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-upload-cloud"})])},function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-upload-cloud"})])}];const E={props:["item","context"],data(){return{uploading:!1,url:null,loading:!1,text:null}},computed:{canUpload(){return!this.loading&&this.text}},created(){this.refresh();const r=this.context.context;for(const n of this.item.watch)r.on(`changed:${n}`,this.refresh,this)},destroyed(){const r=this.context.context;for(const n of this.item.watch)r.off(`changed:${n}`,this.refresh,this)},methods:{selectURL(){this.$refs&&this.$refs.url_box&&this.$refs.url_box.select()},async upload(){if(this.uploading||this.url||this.text==null)return;this.uploading=!0;const r=await fetch("https://logs.frankerfacez.com",{method:"PUT",body:this.text});r.ok||(this.uploading=!1,this.url="An error occurred."),this.url=await r.text(),this.url.startsWith("http://")&&(this.url=`https://${this.url.slice(7)}`),this.uploading=!1},async refresh(){this.uploading=!1,this.url=null,this.loading=!0,this.text=await this.item.data(),this.loading=!1}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},12145:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--backup-restore tw-pd-t-05"},[e("div",{staticClass:"tw-pd-b-1 tw-mg-b-1 tw-border-b"},[s._v(`
		`+s._s(s.t("setting.backup-restore.about","This tool allows you to backup and restore your FrankerFaceZ settings, including all settings from the Control Center along with other data such as favorited emotes and blocked games."))+`
	`)]),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center tw-justify-content-center tw-mg-b-1"},[e("button",{staticClass:"tw-button tw-mg-x-1",on:{click:s.backup}},[s._m(0),s._v(" "),e("span",{staticClass:"tw-button__text"},[s._v(`
				`+s._s(s.t("setting.backup-restore.save-backup","Save Backup"))+`
			`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-mg-x-1",on:{click:s.restore}},[s._m(1),s._v(" "),e("span",{staticClass:"tw-button__text"},[s._v(`
				`+s._s(s.t("setting.backup-restore.restore-backup","Restore Backup"))+`
			`)])])]),s._v(" "),s.error?e("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[e("h3",{staticClass:"ffz-i-attention"},[s._v(`
			`+s._s(s.t("setting.backup-restore.error","There was an error processing this backup."))+`
		`)]),s._v(" "),s.error_desc?e("div",[s._v(`
			`+s._s(s.error_desc)+`
		`)]):s._e()]):s._e(),s._v(" "),s.message?e("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[s._v(`
		`+s._s(s.message)+`
	`)]):s._e()])},"render"),y=[function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("span",{staticClass:"tw-button__icon tw-button__icon--left"},[e("figure",{staticClass:"ffz-i-download"})])},function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("span",{staticClass:"tw-button__icon tw-button__icon--left"},[e("figure",{staticClass:"ffz-i-upload"})])}],_=f(44589),E=f(11227);const b={props:["item"],data(){return{error_desc:null,error:!1,message:null}},methods:{async backup(){this.error=!1,this.message=null;let s;try{s=await this.item.getFFZ().resolve("settings").generateBackupFile()}catch{this.error_desc=this.t("setting.backup-restore.dump-error","Unable to export settings data to JSON."),this.error=!0;return}try{(0,E.saveAs)(s,s.name)}catch{this.error_desc=this.t("setting.backup-restore.save-error","Unable to save.")}},async restore(){this.error=!1,this.message=null;let s;try{if(s=await(0,_.openFile)("application/json,application/zip"),!s)return}catch{this.error_desc=this.t("setting.backup-restore.read-error","Unable to read file."),this.error=!0;return}if(s.type.toLowerCase().includes("zip"))return this.restoreZip(s);let i;try{i=await(0,_.readFile)(s)}catch{this.error_desc=this.t("setting.backup-restore.read-error","Unable to read file."),this.error=!0;return}let e;try{e=JSON.parse(i)}catch{this.error_desc=this.t("setting.backup-restore.json-error","Unable to parse file as JSON."),this.error=!0;return}if(!e||e.version!==2){this.error_desc=this.t("setting.backup-restore.old-file","This file is invalid or was created in another version of FrankerFaceZ and cannot be loaded."),this.error=!0;return}if(e.type!=="full"){this.error_desc=this.t("setting.backup-restore.non-full","This file is not a full backup and cannot be restored with this tool."),this.error=!0;return}const o=this.item.getFFZ().resolve("settings"),a=o.provider;await a.awaitReady(),a.clear();let c=0;for(const d of Object.keys(e.values)){const m=e.values[d];a.set(d,m),a.emit("changed",d,m,!1),c++}this.message=this.t("setting.backup-restore.restored","{count,number} items have been restored. Please refresh this page.",{count:c})},async restoreZip(s){const i=(await f.e(935).then(f.t.bind(f,29597,23))).default;let e,o,a;try{e=await new i().loadAsync(s),o=await e.file("blobs.json").async("text"),a=await e.file("settings.json").async("text")}catch{this.error_desc=this.t("setting.backup-restore.zip-error","Unable to parse ZIP archive."),this.error=!0}try{o=JSON.parse(o),a=JSON.parse(a)}catch{this.error_desc=this.t("setting.backup-restore.json-error","Unable to parse file as JSON."),this.error=!0;return}if(!a||a.version!==2){this.error_desc=this.t("setting.backup-restore.old-file","This file is invalid or was created in another version of FrankerFaceZ and cannot be loaded."),this.error=!0;return}if(a.type!=="full"){this.error_desc=this.t("setting.backup-restore.non-full","This file is not a full backup and cannot be restored with this tool."),this.error=!0;return}const c=this.item.getFFZ().resolve("settings");await c.awaitProvider();const d=c.provider;if(await d.awaitReady(),Object.keys(o).length&&!d.supportsBlobs){this.error_desc=this.t("setting.backup-restore.blob-error","This backup contains binary data not supported by the current storage provider. Please change your storage provider in Data Management > Storage >> Provider."),this.error=!0;return}const m={};for(const[p,z]of Object.entries(o)){let R;z.type==="file"?(R=await e.file(`blobs/${p}`).async("blob"),R=new File([R],z.name,{lastModified:z.modified,type:z.mime})):z.type==="blob"?R=await e.file(`blobs/${p}`).async("blob"):z.type==="ab"?R=await e.file(`blobs/${p}`).async("arraybuffer"):z.type==="ui8"?R=await e.file(`blobs/${p}`).async("uint8array"):(this.error_desc=this.t("setting.backup-restore.invalid-blob","This file contains a binary blob with an invalid type: {type}",z),this.error=!0),m[z.key]=R}let w=0;await d.clearBlobs();for(const[p,z]of Object.entries(m))await d.setBlob(p,z),w++;d.clear(),await d.flush();let h=0;for(const p of Object.keys(a.values)){const z=a.values[p];d.set(p,z),d.emit("changed",p,z,!1),h++}await d.flush(),this.message=this.t("setting.backup-restore.zip-restored","{count,number} items and {blobs,number} binary blobs have been restored. Please refresh this page.",{count:h,blobs:w})}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},25532:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--badge-highlighting"},[o("badge-term-editor",{attrs:{term:i.default_term,badges:i.data,colored:i.item.colored,priority:i.item.priority,removable:i.item.removable,adding:!0},on:{save:i.new_term}}),i._v(" "),!i.val.length||i.val.length===1&&i.hasInheritance?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.terms.no-terms","no terms are defined in this profile"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.terms,function(a){return o("badge-term-editor",{key:a.id,attrs:{term:a.v,badges:i.data,colored:i.item.colored,priority:i.item.priority,removable:i.item.removable},on:{remove:function(c){return i.remove(a)},save:function(c){return i.save(a,c)}}})}),1)],1)},"render"),y=[],_=f(54643),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{default_term:{v:"",c:"",p:0,remove:!1}}},computed:{hasInheritance(){for(const i of this.val)if(i.t==="inherit")return!0;return!1},terms(){const i=[];if(Array.isArray(this.val))for(const e of this.val)e&&e.v&&((0,E.has)(e.v,"p")||(e.v.p=0)),e&&e.t!=="inherit"&&i.push(e);return(this.item.priority||this.item.colored)&&i.sort((e,o)=>{if(e.v&&o.v){if(this.item.priority){if(e.v.p<o.v.p)return 1;if(e.v.p>o.v.p)return-1}if(this.item.colored){if(!e.v.c&&o.v.c)return 1;if(e.v.c&&!o.v.c)return-1}}return 0}),i},val(){return this.has_value?this.value.map(i=>(i.id=i.id||`${Date.now()}-${Math.random()}-${A++}`,i)):[]}},methods:{new_term(i){if(!i.v)return;const e=Array.from(this.val);e.push({v:i}),this.set((0,E.deep_copy)(e))},remove(i){const e=Array.from(this.val),o=e.indexOf(i);o!==-1&&(e.splice(o,1),e.length?this.set((0,E.deep_copy)(e)):this.clear())},save(i,e){i.v=e,this.set((0,E.deep_copy)(this.val))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},13746:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--term ffz--badge-term"},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[e("div",{staticClass:"tw-mg-r-1"},[s.current&&s.current.image?e("img",{staticClass:"ffz--badge-term-image",style:{backgroundColor:s.current.color||null},attrs:{src:s.current.image}}):e("div",{staticClass:"ffz--badge-term-image"})]),s._v(" "),e("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[!s.editing&&!s.current?e("h4",{staticClass:"ffz-monospace"},[e("pre",[s._v(s._s(s.t("setting.terms.invalid-badge","unknown/unloaded badge")))])]):s._e(),s._v(" "),!s.editing&&s.current?e("h4",[s._v(`
				`+s._s(s.current.name)+`
			`)]):s._e(),s._v(" "),s.editing?e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.v,expression:"edit_data.v"}],staticClass:"tw-block tw-full-width tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data,"v",o.target.multiple?a:a[0])}}},[s.adding?e("option",{attrs:{value:""}},[s._v(`
					`+s._s(s.t("setting.terms.please-select","Please select an option."))+`
				`)]):s._e(),s._v(" "),s._l(s.badges,function(o){return e("optgroup",{key:o.title,attrs:{label:o.title}},s._l(o.badges,function(a){return e("option",{key:a.id,domProps:{value:a.id}},[s._v(`
						`+s._s(a.name)+`
					`)])}),0)})],2):s._e()]),s._v(" "),s.colored?e("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05"},[s.editing?e("color-picker",{attrs:{nullable:!0,"show-input":!1,tooltip:s.t("settings.term.color.tip","Color")},model:{value:s.edit_data.c,callback:function(o){s.$set(s.edit_data,"c",o)},expression:"edit_data.c"}}):s.term.c?e("div",{staticClass:"ffz-color-preview tw-relative ffz-il-tooltip__container"},[e("figure",{style:"background-color: "+s.term.c},[s._v(`
					\xA0
				`)]),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("settings.term.color.tip","Color"))+`
				`)])]):s._e()],1):s._e(),s._v(" "),s.priority?e("div",{staticClass:"tw-flex-shrink-0 tw-relative ffz-il-tooltip__container",class:s.editing?"tw-mg-r-05":"tw-mg-x-05"},[s.editing?e("input",{directives:[{name:"model",rawName:"v-model.number",value:s.edit_data.p,expression:"edit_data.p",modifiers:{number:!0}}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-min-width-unset ffz-input tw-pd-x-1 tw-pd-y-05",staticStyle:{width:"5rem"},attrs:{type:"number",step:"1"},domProps:{value:s.edit_data.p},on:{input:function(o){o.target.composing||s.$set(s.edit_data,"p",s._n(o.target.value))},blur:function(o){return s.$forceUpdate()}}}):e("span",[s._v(s._s(s.term.p))]),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("settings.terms.priority.tip","Priority"))+`
			`)])]):s._e(),s._v(" "),s.removable&&(s.editing||s.display.remove)?e("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05 tw-mg-y-05 tw-flex tw-align-items-center ffz-checkbox tw-relative ffz-il-tooltip__container"},[s.editing?e("input",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.remove,expression:"edit_data.remove"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"remove$"+s.id,type:"checkbox"},domProps:{checked:Array.isArray(s.edit_data.remove)?s._i(s.edit_data.remove,null)>-1:s.edit_data.remove},on:{change:function(o){var a=s.edit_data.remove,c=o.target,d=!!c.checked;if(Array.isArray(a)){var m=null,w=s._i(a,m);c.checked?w<0&&s.$set(s.edit_data,"remove",a.concat([m])):w>-1&&s.$set(s.edit_data,"remove",a.slice(0,w).concat(a.slice(w+1)))}else s.$set(s.edit_data,"remove",d)}}}):s._e(),s._v(" "),s.editing?e("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label",attrs:{for:"remove$"+s.id}},[e("span",{staticClass:"tw-mg-l-05 ffz-i-trash"})]):s.term.remove?e("span",{staticClass:"ffz-i-trash tw-pd-x-1"}):s._e(),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.terms.remove.on","Remove matching messages from chat."))+`
			`)])]):s._e(),s._v(" "),s.adding?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button",class:!s.valid&&"tw-button--disabled",attrs:{disabled:!s.valid},on:{click:s.save}},[e("span",{staticClass:"tw-button__text"},[s._v(`
					`+s._s(s.t("setting.terms.add-term","Add"))+`
				`)])])]):s.editing?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",class:!s.valid&&"tw-button--disabled",attrs:{disabled:!s.valid},on:{click:s.save}},[e("span",{staticClass:"tw-button__text ffz-i-floppy"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.save","Save"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.cancel}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]):s.deleting?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){return s.$emit("remove",s.term)}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]):e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.edit}},[e("span",{staticClass:"tw-button__text ffz-i-cog"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.edit","Edit"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!0}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])])])])])},"render"),y=[],_=f(46949);let E=0;const b={props:{badges:Array,term:Object,colored:{type:Boolean,default:!1},priority:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},data(){const s=`badge-term$${E++}`;return this.adding?{id:s,deleting:!1,editing:!0,edit_data:(0,_.deep_copy)(this.term)}:{id:s,deleting:!1,editing:!1,edit_data:null}},computed:{valid(){return this.display.v&&this.display.v!==""},display(){return this.editing?this.edit_data:this.term},current(){if(!this.badges||!this.display||!this.display.v)return null;const s=this.display.v;for(const i of this.badges)if(!(!i||!i.badges)){for(const e of i.badges)if(e.id===s)return e}return null}},methods:{edit(){this.editing=!0,this.edit_data=Object.assign({remove:!1},(0,_.deep_copy)(this.term))},toggleRemove(){this.editing&&(this.edit_data.remove=!this.edit_data.remove)},cancel(){this.adding?this.edit_data=(0,_.deep_copy)(this.term):(this.editing=!1,this.edit_data=null)},save(){this.priority&&this.edit_data.p&&(typeof this.edit_data.p=="number"?this.edit_data.p=Math.floor(this.edit_data.p):this.edit_data.p=0),this.valid&&this.$emit("save",this.edit_data),this.cancel()}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},88821:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",{staticClass:"ffz--badge-visibility tw-pd-t-05"},[i.source&&i.source!==i.profile?o("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[o("span",{staticClass:"ffz-i-info"}),i._v(`
		`+i._s(i.t("setting.warn-inheritence","These values are being overridden by another profile and may not take effect."))+`
	`)]):i._e(),i._v(" "),o("div",{staticClass:"tw-mg-b-2 tw-align-right"},[o("button",{staticClass:"tw-mg-l-05 tw-button ffz-button--hollow ffz-il-tooltip__container",class:{"tw-button--disabled":!i.has_value},attrs:{disabled:!i.has_value},on:{click:i.clear}},[i._m(0),i._v(" "),o("span",{staticClass:"tw-button__text"},[i._v(`
				`+i._s(i.t("setting.reset-all","Reset All to Default"))+`
			`)])])]),i._v(" "),i._l(i.badges,function(a){return o("section",{key:a.title,staticClass:"ffz--menu-container tw-border-t"},[a.id?o("header",{staticClass:"tw-flex ffz-checkbox tw-align-items-center tw-z-above",class:{default:i.badgeDefault(a.id)}},[o("input",{staticClass:"ffz-checkbox__input",attrs:{id:a.id,type:"checkbox"},domProps:{checked:i.badgeChecked(a.id)},on:{click:function(c){return i.onChange(a.id,c)}}}),i._v(" "),o("label",{staticClass:"ffz-checkbox__label",attrs:{for:a.id}},[o("span",{staticClass:"tw-mg-l-1"},[i._v(`
					`+i._s(a.title)+`
				`)])]),i._v(" "),o("div",{staticClass:"ffz--reset-button"},[i.badgeDefault(a.id)?i._e():o("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){return i.reset(a.id)}}},[o("span",{staticClass:"tw-button__text ffz-i-cancel"}),i._v(" "),o("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
						`+i._s(i.t("setting.reset","Reset to Default"))+`
					`)])])])]):o("header",[i._v(`
			`+i._s(a.title)+`
		`)]),i._v(" "),!a.id||i.badgeChecked(a.id)?o("ul",{staticClass:"tw-flex tw-flex-wrap tw-align-content-start tw-align-items-start"},i._l(a.badges,function(c){return o("li",{key:c.id,staticClass:"ffz--badge-info ffz--pointer-events--none tw-mg-y-05 tw-mg-r-05 tw-flex ffz-checkbox ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-border-radius-large",class:{default:i.badgeDefault(c.id)}},[o("input",{staticClass:"ffz-checkbox__input",attrs:{id:c.id,type:"checkbox"},domProps:{checked:i.badgeChecked(c.id)},on:{click:function(d){return i.onChange(c.id,d)}}}),i._v(" "),o("label",{staticClass:"ffz-checkbox__label tw-flex-grow-1 tw-mg-05 ffz--pointer-events",attrs:{for:c.id}},[o("div",{staticClass:"tw-mg-l-1 tw-flex"},[o("div",{staticClass:"preview-image ffz-badge tw-mg-r-1 tw-flex-shrink-0",style:{backgroundColor:c.color,backgroundImage:c.styleImage}}),i._v(" "),o("div",[o("h5",[i._v(i._s(c.name))]),i._v(" "),c.versions&&(c.always_versions||c.versions.length>1)?o("section",{staticClass:"tw-mg-t-05"},i._l(c.versions,function(d){return o("span",{key:"badge-"+c.id+"-"+d.version,staticClass:"ffz-badge ffz-tooltip",style:{backgroundColor:c.color,backgroundImage:d.styleImage},attrs:{title:d.name,"data-tooltip-type":"html"}})}),0):i._e(),i._v(" "),o("button",{staticClass:"tw-mg-t-05 tw-button ffz-button--hollow ffz-il-tooltip__container",on:{click:function(d){return i.reset(c.id)}}},[o("span",{staticClass:"tw-button__text ffz-i-cancel"}),i._v(" "),o("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
									`+i._s(i.t("setting.reset","Reset to Default"))+`
								`)])])])])])])}),0):o("div",{staticClass:"tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-pd-05"},[i._v(`
			`+i._s(i.t("setting.badges.hidden","{count,plural,one{# badge is} other{# badges are} } hidden in this set",{count:a.badges.length}))+`
		`)])])})],2)},"render"),y=[function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("span",{staticClass:"tw-button__icon tw-button__icon--left"},[o("figure",{staticClass:"ffz-i-cancel"})])}],_=f(54643),E=f(46949);function A(i){return i.sort((e,o)=>{const a=e.name.toLowerCase(),c=o.name.toLowerCase();return a<c?-1:a>c?1:0})}$(A,"sortBadges");const v={mixins:[_.Z],props:["item","context"],data(){return{badges:[]}},created(){this.updateBadges()},methods:{updateBadges(){const i=this.item.getBadges(()=>this.updateBadges());for(const e of i)e.badges=A(e.badges);this.badges=i},badgeChecked(i){return!this.value[i]},badgeDefault(i){return!(0,E.has)(this.value,i)},onChange(i,e){const o=e.target,a={[i]:!o.checked};this.set(Object.assign({},this.value,a))},reset(i){const e=Object.assign({},this.value);delete e[i],Object.keys(e).length?this.set(e):this.clear()}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},22298:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--basic-terms"},[o("term-editor",{attrs:{term:i.default_term,colored:i.item.colored,highlight:i.item.highlight,words:i.item.words,removable:i.item.removable,priority:i.item.priority,adding:!0},on:{save:i.new_term}}),i._v(" "),!i.val.length||i.val.length===1&&i.hasInheritance?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.terms.no-terms","no terms are defined in this profile"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.terms,function(a){return o("term-editor",{key:a.id,attrs:{term:a.v,colored:i.item.colored,highlight:i.item.highlight,words:i.item.words,removable:i.item.removable,priority:i.item.priority},on:{remove:function(c){return i.remove(a)},save:function(c){return i.save(a,c)}}})}),1)],1)},"render"),y=[],_=f(54643),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{default_term:{v:"",t:"text",c:"",s:!1,h:!1,w:!0,p:0,remove:!1}}},computed:{hasInheritance(){for(const i of this.val)if(i.t==="inherit")return!0;return!1},terms(){const i=[];if(Array.isArray(this.val))for(const e of this.val)e&&e.v&&((0,E.has)(e.v,"w")||(e.v.w=e.v.t!=="raw"),(0,E.has)(e.v,"h")||(e.v.h=!0),(0,E.has)(e.v,"p")||(e.v.p=0),e.v.t==="raw"&&(e.v.t="regex")),e&&e.t!=="inherit"&&i.push(e);return i.sort((e,o)=>{if(e.v&&o.v){if(this.item.removable){if(!e.v.remove&&o.v.remove)return 1;if(e.v.remove&&!o.v.remove)return-1}if(this.item.priority){if(e.v.p<o.v.p)return 1;if(e.v.p>o.v.p)return-1}if(this.item.colored){if(!e.v.c&&o.v.c)return 1;if(e.v.c&&!o.v.c)return-1}if(this.item.highlight){if(!e.v.h&&o.v.h)return-1;if(e.v.h&&!o.v.h)return 1}if(this.item.words??!0){if(!e.v.w&&o.v.w)return-1;if(e.v.w&&!o.v.w)return 1}}return 0}),i},val(){return this.has_value?this.value.map(i=>(i.id=i.id||`${Date.now()}-${Math.random()}-${A++}`,i)):[]}},methods:{new_term(i){if(!i.v)return;const e=Array.from(this.val);e.push({v:i}),this.set((0,E.deep_copy)(e))},remove(i){const e=Array.from(this.val),o=e.indexOf(i);o!==-1&&(e.splice(o,1),e.length?this.set((0,E.deep_copy)(e)):this.clear())},save(i,e){i.v=e,this.set((0,E.deep_copy)(this.val))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},92417:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--term ffz--blocked-type"},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[e("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[s.editing?s._e():e("h4",[s._v(`
				`+s._s(s.display.v)+`
			`)]),s._v(" "),s.editing?e("select",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.v,expression:"edit_data.v"}],staticClass:"tw-block tw-full-width tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-x-1 tw-pd-y-05 tw-mg-y-05",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.edit_data,"v",o.target.multiple?a:a[0])}}},[s.adding?e("option",{attrs:{value:""}},[s._v(`
					`+s._s(s.t("setting.terms.please-select","Please select an option."))+`
				`)]):s._e(),s._v(" "),s._l(s.types,function(o){return e("option",{key:o,domProps:{value:o}},[s._v(`
					`+s._s(o)+`
				`)])})],2):s._e()]),s._v(" "),s.adding?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button",class:!s.valid&&"tw-button--disabled",attrs:{disabled:!s.valid},on:{click:s.save}},[e("span",{staticClass:"tw-button__text"},[s._v(`
					`+s._s(s.t("setting.terms.add-term","Add"))+`
				`)])])]):s.deleting?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){return s.$emit("remove",s.term)}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]):e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!0}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])])])])])},"render"),y=[],_=f(46949);let E=0;const b={props:{types:Array,term:Object,colored:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},data(){return this.adding?{editor_id:E++,deleting:!1,editing:!0,edit_data:(0,_.deep_copy)(this.term)}:{editor_id:E++,deleting:!1,editing:!1,edit_data:null}},computed:{valid(){return this.display.v&&this.display.v!==""},display(){return this.editing?this.edit_data:this.term}},methods:{cancel(){this.adding?this.edit_data=(0,_.deep_copy)(this.term):(this.editing=!1,this.edit_data=null)},save(){this.$emit("save",this.edit_data),this.cancel()}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},71386:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--blocked-types"},[o("blocked-type-editor",{attrs:{term:i.default_type,types:i.data,adding:!0},on:{save:i.new_term}}),i._v(" "),!i.val.length||i.val.length===1&&i.hasInheritance?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.terms.no-terms","no terms are defined in this profile"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.terms,function(a){return o("blocked-type-editor",{key:a.id,attrs:{term:a.v,types:i.data},on:{remove:function(c){return i.remove(a)},save:function(c){return i.save(a,c)}}})}),1)],1)},"render"),y=[],_=f(54643),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{default_type:{v:""}}},computed:{hasInheritance(){for(const i of this.val)if(i.t==="inherit")return!0;return!1},terms(){const i=[];if(Array.isArray(this.val))for(const e of this.val)e&&e.t!=="inherit"&&i.push(e);return i},val(){return this.has_value?this.value.map(i=>(i.id=i.id||`${Date.now()}-${Math.random()}-${A++}`,i)):[]}},methods:{new_term(i){if(!i.v)return;const e=Array.from(this.val);e.push({v:i}),this.set((0,E.deep_copy)(e))},remove(i){const e=Array.from(this.val),o=e.indexOf(i);o!==-1&&(e.splice(o,1),e.length?this.set((0,E.deep_copy)(e)):this.clear())},save(i,e){i.v=e,this.set((0,E.deep_copy)(this.val))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},45969:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>o});var N=$(function(){var a=this,c=a.$createElement,d=a._self._c||c;return d("div",{staticClass:"ffz--changelog tw-border-t tw-pd-t-1"},[d("div",{staticClass:"tw-align-center"},[a.addon?d("h3",{staticClass:"tw-mg-b-1 tw-flex tw-align-items-center tw-justify-content-center"},[a.addon.icon?d("figure",{staticClass:"ffz-avatar ffz-avatar--size-30 tw-mg-r-05"},[d("img",{staticClass:"tw-block tw-image tw-image-avatar",attrs:{src:a.addon.icon}})]):a._e(),a._v(`
			`+a._s(a.t("setting.add_ons.specific-changelog","{name} Changelog",{name:a.addon.name}))+`
		`)]):a.addons?d("h3",{staticClass:"tw-mg-b-1"},[a._v(`
			`+a._s(a.t("setting.add_ons.changelog.title","Add-Ons Changelog"))+`
		`)]):d("h3",{staticClass:"tw-mg-b-1"},[a._v(`
			`+a._s(a.t("home.changelog","Changelog"))+`
		`)])]),a._v(" "),a.addons?a._e():d("div",{staticClass:"tw-mg-b-1 tw-flex tw-align-items-center"},[d("div",{staticClass:"tw-flex-grow-1"}),a._v(" "),d("div",{staticClass:"ffz-checkbox tw-relative ffz-il-tooltip__container"},[d("input",{directives:[{name:"model",rawName:"v-model",value:a.nonversioned,expression:"nonversioned"}],ref:"nonversioned",staticClass:"ffz-checkbox__input",attrs:{id:"nonversioned",type:"checkbox"},domProps:{checked:Array.isArray(a.nonversioned)?a._i(a.nonversioned,null)>-1:a.nonversioned},on:{change:function(m){var w=a.nonversioned,h=m.target,p=!!h.checked;if(Array.isArray(w)){var z=null,R=a._i(w,z);h.checked?R<0&&(a.nonversioned=w.concat([z])):R>-1&&(a.nonversioned=w.slice(0,R).concat(w.slice(R+1)))}else a.nonversioned=p}}}),a._v(" "),d("label",{staticClass:"ffz-checkbox__label",attrs:{for:"nonversioned"}},[d("span",{staticClass:"tw-mg-l-1"},[a._v(`
					`+a._s(a.t("home.changelog.show-nonversioned","Include non-versioned commits."))+`
				`)])]),a._v(" "),d("div",{staticClass:"ffz-il-tooltip ffz-balloon--md ffz-il-tooltip--wrap ffz-il-tooltip--down ffz-il-tooltip--align-right"},[a._v(`
				`+a._s(a.t("home.changelog.about-nonversioned","Non-versioned commits are commits to the FrankerFaceZ repository not associated with a release build. They typically represent maintenance or contributions from the community that will be included in a subsequent release."))+`
			`)])])]),a._v(" "),d("ul",a._l(a.display,function(m){return d("li",{key:m.sha,staticClass:"tw-mg-b-2"},[d("div",{staticClass:"tw-flex tw-align-items-center tw-border-b tw-mg-b-05"},[!a.addons&&m.active?d("div",{staticClass:"ffz-pill tw-mg-r-05"},[a._v(`
					`+a._s(a.t("home.changelog.current","Current Version"))+`
				`)]):a._e(),a._v(" "),m.icon?d("figure",{staticClass:"ffz-avatar ffz-avatar--size-20 tw-mg-r-05"},[d("img",{staticClass:"tw-block tw-image tw-image-avatar",attrs:{src:m.icon}})]):a._e(),a._v(" "),m.title&&m.title_nav?d("a",{staticClass:"tw-font-size-5 ffz-link ffz-link--inherit",attrs:{href:"#"},on:{click:function(w){return w.preventDefault(),a.titleNav(m.title_nav)}}},[a._v(`
					`+a._s(m.title)+`
				`)]):m.title?d("div",{staticClass:"tw-font-size-5"},[a._v(`
					`+a._s(m.title)+`
				`)]):a._e(),a._v(" "),m.version?d("div",{staticClass:"tw-font-size-4 tw-mg-l-05"},[d("span",{staticClass:"tw-c-text-alt-2"},[a._v("v")]),a._v(a._s(m.version)+`
				`)]):a._e(),a._v(" "),m.author?d("div",{staticClass:"tw-mg-l-05"},[d("t-list",{staticClass:"tw-inline-flex tw-align-items-center",attrs:{phrase:"home.changelog.by-line",default:"By: {user}"},scopedSlots:a._u([{key:"user",fn:function(){return[m.author.html_url?d("a",{staticClass:"tw-inline-flex tw-align-items-center ffz-link ffz-link--inherit tw-mg-x-05 ffz-tooltip",attrs:{href:m.author.html_url,target:"_blank",rel:"noopener noreferrer","data-tooltip-type":"link"}},[m.author.avatar_url?d("figure",{staticClass:"ffz-avatar ffz-avatar--size-20 tw-mg-r-05"},[d("img",{staticClass:"tw-block tw-border-radius-rounded tw-image tw-image-avatar",attrs:{src:m.author.avatar_url}})]):a._e(),a._v(`
								`+a._s(m.author.login)+`
							`)]):d("strong",{staticClass:"tw-mg-x-05"},[a._v(`
								`+a._s(m.author.login||m.author.name)+`
							`)])]},proxy:!0}],null,!0)})],1):a._e(),a._v(" "),m.hash?d("div",{staticClass:"tw-font-size-8 tw-c-text-alt-2"},[a._v(`
					@`),d("a",{staticClass:"ffz-link ffz-link--inherit ffz-tooltip",attrs:{href:m.link,target:"_blank",rel:"noopener noreferrer","data-tooltip-type":"link"}},[a._v(a._s(m.hash))])]):a._e(),a._v(" "),m.date?d("time",{staticClass:"tw-align-right tw-flex-grow-1 tw-c-text-alt-2",attrs:{datetime:m.date}},[a._v("("+a._s(a.formatDate(m.date))+")")]):a._e()]),a._v(" "),d("markdown",{attrs:{source:m.message}}),a._v(" "),a._l(m.segments,function(w){return d("div",{staticClass:"ffz--changelog-segment"},[d("strong",[a._v(a._s(w.key))]),a._v(" "),d("markdown",{attrs:{source:w.value}})],1)})],2)}),0),a._v(" "),d("div",{staticClass:"tw-align-center tw-pd-1"},[a.error?d("div",[a._v(`
			`+a._s(a.t("home.changelog.error","An error occurred loading changes from GitHub."))+`
		`)]):a.loading?d("h1",{staticClass:"tw-mg-5 ffz-i-zreknarf loading"}):a.more?d("button",{staticClass:"tw-button",on:{click:a.fetchMore}},[d("div",{staticClass:"tw-button__text"},[a._v(`
				`+a._s(a.t("home.changelog.load","Load More"))+`
			`)])]):d("div",[a._v(`
			`+a._s(a.t("home.changelog.no-more","There are no more commits to load."))+`
		`)])])])},"render"),y=[],_=f(46949);const E=/^(.+?)?\s*v?(\d+\.\d+\.\d+(?:\-[a-z0-9-]+)?)$/i,A=/\]\(~([^)]+)\)/g,b=/^\*\s*([^:]+?):\s*(.+)$/i,v=/(^|\s)#(\d+)\b/g;function r(a,c){return a=a.replace(A,(d,m)=>`](~${m})`),a.replace(v,(d,m,w)=>`${m}[#${w}](https://github.com/FrankerFaceZ/${c}/issues/${w})`)}$(r,"linkify");const s={props:["item","context"],data(){return{error:!1,addon:this.item.addon,addons:this.item.addons,nonversioned:!1,loading:!1,more:!0,commits:[]}},computed:{display(){window.thing=this;const a=[],c=this.addons?this.item.getFFZ().resolve("addons"):null,d=this.t("home.changelog.nonversioned","Non-Versioned Commit");for(const m of this.commits){const w=m.commit.message;let h=d,p=null,z=null,R=null,I=null,j={},F=[];if(/\bskiplog\b/i.test(w)&&!this.nonversion)continue;const H=w.split(/\r?\n/),Y=H.shift(),st=Y?E.exec(Y):null,tt=new Date(m.commit.author.date),it=m.sha===window.FrankerFaceZ.version_info.commit,ut=H.length&&st;if(!this.nonversion&&!ut)continue;let rt=null;if(st&&(h=st[1],R=st[2]),ut)for(const L of H){const Z=L.trim();if(!Z.length){!rt&&F.length&&F.push(L);continue}const nt=b.exec(Z);if(!nt)rt?rt.push(Z):F.push(L);else{const at=j[nt[1]]=j[nt[1]]||[];rt=[nt[2]],at.push(rt)}}else H.unshift(Y),F=H;let mt=F.join(`
`).trim();const W=[];for(const[L,Z]of Object.entries(j)){if(!Z?.length)continue;const nt=Z.map(at=>`* ${at.join(" ")}`).join(`
`).trim();W.push({key:L,value:r(nt,this.addons?"add-ons":"frankerfacez")})}if(this.addons&&(I=m.author,h)){const L=h.toLowerCase();if(c?.addons){for(const Z of Object.values(c.addons))if(Z.short_name&&Z.short_name.toLowerCase()===L||Z.name&&Z.name.toLowerCase()===L||Z.id&&Z.id.toLowerCase()===L){z=Z.icon,p=[`add_ons.changelog.${Z.id}`],Z.short_name&&p.push(`add_ons.changelog.${Z.short_name.toSnakeCase()}`),Z.name&&p.push(`add_ons.changelog.${Z.name.toSnakeCase()}`);break}}z||(z="https://cdn.frankerfacez.com/badge/2/4/solid")}this.addon&&(z=null,h=null),a.push({icon:z,title:h,title_nav:p,version:R,author:I,message:mt,segments:W,active:it,hash:m.sha&&m.sha.slice(0,7),link:m.html_url,sha:m.sha,date:tt})}return a}},mounted(){this.commit_ids=new Set,this.fetchMore()},methods:{titleNav(a){Array.isArray(a)&&this.$emit("navigate",...a)},formatDate(a){if(!a)return"";const c=a instanceof Date?a:new Date(a),d=new Date;return c.toDateString()===d.toDateString()?this.tTime(c):this.tDate(c)},async fetchMore(){const a=this.commits[this.commits.length-1],c=a&&(0,_.get)("commit.author.date",a);this.loading=!0;const d=new URL(`https://api.github.com/repos/frankerfacez/${this.addons?"add-ons":"frankerfacez"}/commits`);c&&d.searchParams.append("until",c),this.addon&&d.searchParams.append("path",`src/${this.addon.id}`);try{const m=await fetch(d),w=m.ok?await m.json():null;if(!w||!Array.isArray(w)){this.more=!1;return}let h=!1;for(const p of w)this.commit_ids.has(p.sha)||(this.commit_ids.add(p.sha),this.commits.push(p),h=!0);h||(this.more=!1),this.loading=!1}catch{this.error=!0}}}};var i=f(72934),e=(0,i.Z)(s,N,y,!1,null,null,null);const o=e.exports},76923:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--widget ffz--chat-actions tw-border-t tw-pd-y-1"},[e.source&&e.source!==e.profile?a("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[a("span",{staticClass:"ffz-i-info"}),e._v(`
		`+e._s(e.t("setting.warn-inheritence","These values are being overridden by another profile and may not take effect."))+`
	`)]):e._e(),e._v(" "),(e.item.warn_icons||e.has_icons&&e.item.warn_icons!==!1)&&e.context.mod_icons===!1?a("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[a("span",{staticClass:"ffz-i-info"}),e._v(`
		`+e._s(e.t("setting.actions.warn-hidden","You currently have Mod Icons turned off in your Twitch chat settings, so some actions might be hidden as a result. Use the settings menu in chat to toggle them."))+`
	`)]):e._e(),e._v(" "),a("div",{staticClass:"tw-pd-b-1 tw-border-b tw-mg-b-1"},[a("div",{staticClass:"tw-flex tw-flex-wrap tw-align-items-center ffz--inline"},[e._v(`
			`+e._s(e.t("setting.actions.preview","Preview:"))+`

			`),a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"as_mod",staticClass:"ffz-checkbox__input",attrs:{id:"as_mod",type:"checkbox"},domProps:{checked:e.is_moderator},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"as_mod"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.mod","As Moderator"))+`
					`)])])]),e._v(" "),e.has_msg?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"is_deleted",staticClass:"ffz-checkbox__input",attrs:{id:"is_deleted",type:"checkbox"},domProps:{checked:e.is_deleted},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"is_deleted"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.deleted","Deleted Message"))+`
					`)])])]):e._e(),e._v(" "),e.has_icons?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_mod_icons",staticClass:"ffz-checkbox__input",attrs:{id:"with_mod_icons",type:"checkbox"},domProps:{checked:e.with_mod_icons},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_mod_icons"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.mod_icons","With Mod Icons"))+`
					`)])])]):e._e(),e._v(" "),e.has_mode?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_slow",staticClass:"ffz-checkbox__input",attrs:{id:"with_slow",type:"checkbox"},domProps:{checked:e.with_slow},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_slow"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.slow","Slow Mode"))+`
					`)])])]):e._e(),e._v(" "),e.has_mode?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_emote",staticClass:"ffz-checkbox__input",attrs:{id:"with_emote",type:"checkbox"},domProps:{checked:e.with_emote},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_emote"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.emote-only","Emote-Only"))+`
					`)])])]):e._e(),e._v(" "),e.has_mode?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_subs",staticClass:"ffz-checkbox__input",attrs:{id:"with_subs",type:"checkbox"},domProps:{checked:e.with_subs},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_subs"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.subs","Subs Only"))+`
					`)])])]):e._e(),e._v(" "),e.has_mode?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_followers",staticClass:"ffz-checkbox__input",attrs:{id:"with_followers",type:"checkbox"},domProps:{checked:e.with_followers},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_followers"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.followers","Followers-Only"))+`
					`)])])]):e._e(),e._v(" "),e.has_mode?a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"with_r9k",staticClass:"ffz-checkbox__input",attrs:{id:"with_r9k",type:"checkbox"},domProps:{checked:e.with_r9k},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"with_r9k"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.r9k","R9k Mode"))+`
					`)])])]):e._e(),e._v(" "),a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"show_all",staticClass:"ffz-checkbox__input",attrs:{id:"show_all",type:"checkbox"},domProps:{checked:e.show_all},on:{change:e.onPreview}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"show_all"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("setting.actions.preview.all","Show All"))+`
					`)])])])]),e._v(" "),a("div",{staticClass:"ffz-action-data tw-pd-t-1",attrs:{"data-user":JSON.stringify(e.sample_user),"data-room":JSON.stringify(e.sample_room),"data-message":JSON.stringify(e.sample_message),"data-msg-id":"1234-5678"}},[e.display.length?e._e():a("div",{staticClass:"tw-align-center tw-c-text-alt-2 tw-pd-05 tw-font-size-4"},[e._v(`
				`+e._s(e.t("setting.actions.no-visible","no visible actions"))+`
			`)]),e._v(" "),e._l(e.display,function(c,d){return a("div",{key:d,staticClass:"tw-flex tw-align-items-center tw-justify-content-center"},[e._l(c,function(m){return[m.type==="space"?a("div",{key:m.id,staticClass:"tw-flex-grow-1"}):m.type==="space-small"?a("div",{key:m.id,staticClass:"tw-mg-x-1"}):a("action-preview",{key:m.id,attrs:{act:e.maybeDynamic(m.v),"process-color":e.color,renderers:e.data.renderers,tooltip:"true",pad:"true"}})]})],2)})],2)]),e._v(" "),a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-b-05"},[a("div",{staticClass:"tw-flex-grow-1"},[e._v(`
			`+e._s(e.t("setting.actions.drag","Drag actions to re-order them."))+`
		`)]),e._v(" "),e.maybe_clear?e._e():a("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:e.closeAdd,expression:"closeAdd"}],staticClass:"tw-relative"},[a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",on:{click:e.toggleAdd}},[a("span",{staticClass:"tw-button__text ffz-i-plus"},[e._v(`
					`+e._s(e.t("setting.actions.new","New..."))+`
				`)]),e._v(" "),e._m(0)]),e._v(" "),e.add_open?a("balloon",{attrs:{color:"background-alt-2",dir:"down-right",size:e.add_pasting?"md":"sm"}},[a("simplebar",{attrs:{classes:"ffz-mh-30"}},[e.add_pasting?a("div",{staticClass:"tw-pd-1"},[a("div",{staticClass:"tw-flex tw-align-items-center"},[a("input",{ref:"paste",staticClass:"tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{placeholder:e.t("setting.paste-json.json","[json]")},on:{keydown:function(c){return!c.type.indexOf("key")&&e._k(c.keyCode,"enter",13,c.key,"Enter")?null:e.addFromJSON.apply(null,arguments)}}}),e._v(" "),a("button",{staticClass:"tw-mg-l-05 tw-button",on:{click:e.addFromJSON}},[a("span",{staticClass:"tw-button__text ffz-i-plus"},[e._v(`
									`+e._s(e.t("setting.add","Add"))+`
								`)])])])]):a("div",{staticClass:"tw-pd-y-1"},[a("button",{staticClass:"ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive tw-full-width",on:{click:e.preparePaste}},[a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-y-05 tw-pd-x-1"},[a("div",{staticClass:"tw-flex-grow-1 tw-mg-r-1"},[e._v(`
									`+e._s(e.t("setting.paste-json","Paste JSON"))+`
								`)])])]),e._v(" "),e._l(e.presets,function(c,d){return[c.divider?a("div",{key:d,staticClass:"tw-mg-1 tw-border-b"}):a("button",{key:d,staticClass:"ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive tw-full-width",attrs:{disabled:c.disabled},on:{click:function(m){return e.add(c.value)}}},[a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-y-05 tw-pd-x-1"},[a("div",{staticClass:"tw-flex-grow-1 tw-mg-r-1"},[e._v(`
										`+e._s(c.title_i18n?e.t(c.title_i18n,c.title,c):c.title)+`
									`)]),e._v(" "),c.appearance?a("action-preview",{attrs:{act:e.maybeDynamic(c),"process-color":e.color,renderers:e.data.renderers}}):e._e()],1)])]})],2)])],1):e._e()],1),e._v(" "),!e.maybe_clear&&e.strip_skip_val.length?a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){e.maybe_clear=!0}}},[a("span",{staticClass:"tw-button__text ffz-i-trash"},[e._v(`
				`+e._s(e.t("setting.delete-all","Delete All"))+`
			`)]),e._v(" "),a("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.actions.delete-all","Delete all of this profile's actions."))+`
			`)])]):e._e(),e._v(" "),e.maybe_clear?a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.doClear}},[a("span",{staticClass:"tw-button__text ffz-i-trash"},[e._v(`
				`+e._s(e.t("setting.delete-all","Delete All"))+`
			`)]),e._v(" "),a("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.actions.delete-all","Delete all of this profile's actions."))+`
			`)])]):e._e(),e._v(" "),e.maybe_clear?a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){e.maybe_clear=!1}}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"},[e._v(`
				`+e._s(e.t("setting.cancel","Cancel"))+`
			`)])]):e._e(),e._v(" "),!e.strip_skip_val.length&&e.has_default?a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.populate}},[a("span",{staticClass:"tw-button__text ffz-i-trash"},[e._v(`
				`+e._s(e.t("setting.actions.add-default","Add Defaults"))+`
			`)]),e._v(" "),a("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.actions.add-default-tip","Add all of the default actions to this profile."))+`
			`)])]):e._e()]),e._v(" "),a("div",{ref:"list",staticClass:"ffz--action-list"},[e.val.length?e._e():a("div",{staticClass:"tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-1"},[e._v(`
			`+e._s(e.t("setting.actions.no-actions","no actions are defined in this profile"))+`

			`),a("div",{staticClass:"tw-mg-t-1"},[a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.addSkip}},[a("span",{staticClass:"tw-button__text ffz-i-block"},[e._v(`
						`+e._s(e.t("setting.actions.do-not-inherit","Do Not Inherit"))+`
					`)]),e._v(" "),a("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},[e._v(`
						`+e._s(e.t("setting.actions.do-not-inherit.desc","Do not inherit values from lower priority profiles or the defaults."))+`
					`)])])])]),e._v(" "),e._l(e.val,function(c){return a("section",{key:c.id},[a("action-editor",{attrs:{action:c,data:e.data,inline:e.item.inline,mod_icons:e.has_icons,context:e.item.context,extra_appearance:e.item.extra_appearance_editor,vuectx:e.context,modifiers:e.item.modifiers,hover_modifier:e.item.hover_modifier},on:{remove:function(d){return e.remove(c)},save:function(d){return e.save(c,d)}}})],1)})],2)])},"render"),y=[function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("span",{staticClass:"tw-button__icon tw-button__icon--right"},[a("figure",{staticClass:"ffz-i-down-dir"})])}],_=f(54643),E=f(17750),A=f(46949);let b=0;const r={mixins:[_.Z],props:["item","context"],data(){return{is_moderator:!0,with_mod_icons:!0,with_emote:!1,with_subs:!1,with_slow:!1,with_followers:!1,with_r9k:!1,is_staff:!1,is_deleted:!1,show_all:!1,maybe_clear:!1,add_open:!1,add_pasting:!1}},computed:{hasInheritance(){for(const e of this.val)if(e.t==="inherit")return!0;return!1},hasSkip(){for(const e of this.val)if(e.t==="skip")return!0;return!1},sample_user(){return this.has_user?{displayName:"SirStendec",login:"sirstendec",id:49399878,color:"#008000"}:null},sample_room(){return this.has_room?{displayName:"FrankerFaceZ",login:"frankerfacez",id:46622312}:null},sample_message(){return this.has_msg?{id:"46a473ee-a3c4-4556-a5ca-c0f1eac93ec0",text:"sirstendec: Please do not do that."}:null},has_icons(){return this.item.mod_icons||this.item.inline},has_default(){return this.default_value&&this.default_value.length},has_user(){return this.item.context&&this.item.context.includes("user")},has_room(){return this.item.context&&this.item.context.includes("room")},has_mode(){return this.item.context&&this.item.context.includes("room-mode")},has_msg(){return this.item.context&&this.item.context.includes("message")},presets(){const e=[],o=this.item.context||[];e.push({disabled:this.hasInheritance,title:"Inheritance Point",title_i18n:"setting.inheritance",value:{t:"inherit"}}),this.item.inline||(e.push({title:"New Line",title_i18n:"setting.new-line",value:{v:{type:"new-line"}}}),e.push({title:"Space (Small)",title_i18n:"setting.space-small",value:{v:{type:"space-small"}}}),e.push({title:"Space (Expanding)",title_i18n:"setting.space",value:{v:{type:"space"}}})),e.push({divider:!0});for(const a in this.data.actions){const c=this.data.actions[a];if(c&&c.presets){if(c.required_context){let d=!0;for(const m of c.required_context)if(!o.includes(m)){d=!1;break}if(!d)continue}for(const d of c.presets)typeof c.title!="string"&&!d.title||e.push(Object.assign({action:a,title:c.title,title_i18n:c.title_i18n||`chat.actions.${a}`,value:{v:Object.assign({action:a},d)}},d))}}return e},display(){const e=[];let o=[];if(this.val)for(const a of this.val){if(!a.v)continue;const c=a.v.type;c==="new-line"?(e.push(o),o=[]):c==="space"||c==="small-space"?o.push(a.v):this.displayAction(a.v)&&o.push(a)}return o.length&&e.push(o),e},strip_skip_val(){return this.val.filter(e=>e.t!=="skip")},val(){return this.has_value?this.value.map(e=>(e.id=e.id||`${Date.now()}-${Math.random()}-${b++}`,e)):[]}},mounted(){this._sortable=E.ZP.create(this.$refs.list,{draggable:"section",filter:"button",onUpdate:e=>{if(e.newIndex===e.oldIndex)return;const o=Array.from(this.val);o.splice(e.newIndex,0,...o.splice(e.oldIndex,1)),this.set(o)}})},beforeDestroy(){this._sortable&&this._sortable.destroy(),this._sortable=null},methods:{doClear(){this.maybe_clear=!1,this.clear()},closeAdd(){this.add_open=!1,this.add_pasting=!1},toggleAdd(){this.add_open=!this.add_open,this.add_pasting=!1},preparePaste(){this.add_open=!0,this.add_pasting=!0,requestAnimationFrame(()=>{this.$refs.paste.focus()})},addFromJSON(){let e=this.$refs.paste.value;if(this.closeAdd(),e){try{e=JSON.parse(e)}catch(o){alert(o);return}e.appearance||(e.appearance={}),e.appearance.type||(e.appearance.type="text"),e.appearance.type==="text"&&!e.appearance.text&&(e.appearance.text="C"),e.appearance.type==="icon"&&!e.appearance.icon&&(e.appearance.icon="ffz-i-ok"),e.display||(e.display={}),e.action||(e.action="chat"),this.add({v:e})}},populate(){this.set((0,A.deep_copy)(this.default_value))},addSkip(){const e=Array.from(this.val);e.length>0||(e.push({t:"skip"}),this.set((0,A.deep_copy)(e)))},add(e){const o=Array.from(this.val);let a=o.length;for(;a--;)o[a]?.t==="skip"&&o.splice(a,1);o.push(e),this.set((0,A.deep_copy)(o)),this.add_open=!1},remove(e){const o=Array.from(this.val),a=o.indexOf(e);a!==-1&&(o.splice(a,1),o.length?this.set(o):this.clear())},save(e,o){e.v=o,this.set((0,A.deep_copy)(this.val))},onPreview(){this.show_all=this.$refs.show_all.checked,this.is_moderator=this.$refs.as_mod.checked,this.is_staff=!1,this.with_mod_icons=this.has_icons&&this.$refs.with_mod_icons.checked,this.is_deleted=this.has_msg&&this.$refs.is_deleted.checked,this.with_emote=this.has_mode&&this.$refs.with_emote.checked,this.with_subs=this.has_mode&&this.$refs.with_subs.checked,this.with_slow=this.has_mode&&this.$refs.with_slow.checked,this.with_followers=this.has_mode&&this.$refs.with_followers.checked,this.with_r9k=this.has_mode&&this.$refs.with_r9k.checked},displayAction(e){if(!e.appearance)return!1;const o=e.display;return!o||this.show_all?!0:!(o.disable||o.mod!=null&&o.mod!==this.is_moderator||o.mod_icons!=null&&o.mod_icons!==this.with_mod_icons||o.staff!=null&&o.staff!==this.is_staff||o.deleted!=null&&o.deleted!==this.is_deleted||this.has_mode&&(o.emoteOnly!=null&&o.emoteOnly!==this.with_emote||o.slowMode!=null&&o.slowMode!==this.with_slow||o.subsMode!=null&&o.subsMode!==this.with_subs||o.r9kMode!=null&&o.r9kMode!==this.with_r9k||o.followersOnly!=null&&o.followersOnly!==this.with_followers))},maybeDynamic(e){let o=e.appearance;if(o?.type==="dynamic"){const a=this.data.actions[e.action],c=this.context.getFFZ(),d=c&&c.resolve("chat.actions"),m=d&&a?.dynamicAppearance&&a.dynamicAppearance.call(d,(0,A.deep_copy)(o),e,this.sample_message,this.sample_room,this.sample_user,this.with_mod_icons);if(m)return Object.assign({},e,{appearance:m})}return e},color(e){return e&&this.data.color(e)}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},63152:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--chat-reasons"},[o("div",{staticClass:"tw-flex tw-align-items-center tw-pd-b-05"},[o("div",{staticClass:"tw-flex-grow-1"},[i._v(`
			`+i._s(i.t("setting.reasons.info","Reasons can be selected using action context menus to add extra information to bans and timeouts."))+`
		`)]),i._v(" "),i.empty?i._e():o("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:i.clear}},[o("span",{staticClass:"tw-button__text ffz-i-trash"},[i._v(`
				`+i._s(i.t("setting.delete-all","Delete All"))+`
			`)]),i._v(" "),o("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
				`+i._s(i.t("setting.reasons.delete-all","Delete all of this profile's reasons."))+`
			`)])]),i._v(" "),i.empty?o("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:i.populate}},[o("span",{staticClass:"tw-button__text ffz-i-trash"},[i._v(`
				`+i._s(i.t("setting.reasons.add-default","Add Defaults"))+`
			`)]),i._v(" "),o("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
				`+i._s(i.t("setting.reasons.add-default-tip","Add all of the default reasons to this profile."))+`
			`)])]):i._e()]),i._v(" "),o("reason-editor",{attrs:{reason:i.default_reason,adding:!0},on:{save:i.new_reason}}),i._v(" "),i.empty?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.reasons.no-reasons","no reasons are defined in this profile"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.reasons,function(a){return o("reason-editor",{key:a.id,attrs:{reason:a.v},on:{remove:function(c){return i.remove(a)},save:function(c){return i.save(a,c)}}})}),1)],1)},"render"),y=[],_=f(54643),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{default_reason:{text:""}}},computed:{empty(){return!this.val.length||this.val.length===1&&this.hasInheritance},reasons(){const i=[];if(Array.isArray(this.val))for(const e of this.val)e.t!=="inherit"&&i.push(e);return i},hasInheritance(){for(const i of this.val)if(i.t==="inherit")return!0;return!1},val(){return this.has_value?this.value.map(i=>(i.id=i.id||`${Date.now()}-${Math.random()}-${A++}`,i)):[]}},methods:{populate(){this.set((0,E.deep_copy)(this.default_value))},new_reason(i){if(!i)return;delete i.i18n;const e=Array.from(this.val);e.push({v:i}),this.set((0,E.deep_copy)(e))},remove(i){const e=Array.from(this.val),o=e.indexOf(i);o!==-1&&(e.splice(o,1),e.length?this.set((0,E.deep_copy)(e)):this.clear())},save(i,e){delete e.i18n,i.v=e,this.set((0,E.deep_copy)(this.val))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},66753:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return s.data?e("div",[e("div",{staticClass:"tw-c-text-alt-2 tw-mg-b-05"},[s._v(`
		`+s._s(s.t("setting.example","Example:"))+`
	`)]),s._v(" "),e("chat-rich",{attrs:{data:s.data,url:s.url,"force-short":!0}})],1):s._e()},"render"),y=[],_=f(46949);const E=["https://www.twitch.tv/dansalvato","https://www.twitch.tv/sirstendec","https://www.youtube.com/watch?v=BFSWlDpA6C4"],b={components:{"chat-rich":async()=>(await f.e(2348).then(f.bind(f,18249))).default("./chat-rich.vue").default},props:["context","item"],data(){let s=(0,_.maybe_call)(this.item.extra.url,this,this.item,this.context);s||(s=E[Math.floor(Math.random()*E.length)]);const i={type:"link",force_rich:!0,is_mail:!1,url:s,text:s},e=this.item.extra.getChat();let o=null;if(e.__rich_providers){for(const a of e.__rich_providers)if(a.test.call(e,i,s)){o=a.process.call(e,i);break}}return{data:o,url:s}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},2814:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>c});var N=$(function(){var d=this,m=d.$createElement,w=d._self._c||m;return w("div",{staticClass:"ffz--chat-tester"},[d.context.exclusive?w("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-2"},[w("h3",{staticClass:"ffz-i-attention"},[d._v(`
			`+d._s(d.t("debug.chat-tester.exclusive","Hey! This won't work here!"))+`
		`)]),d._v(" "),w("markdown",{attrs:{source:d.t("debug.chat-tester.exclusive-explain","This feature does not work when the FFZ Control Center is popped out. It needs to be used in a window where you can see chat.")}})],1):d._e(),d._v(" "),w("div",{staticClass:"tw-flex tw-align-items-start"},[w("label",{staticClass:"tw-mg-y-05",attrs:{for:"selector"}},[d._v(`
			`+d._s(d.t("debug.chat-tester.message","Test Message"))+`
		`)]),d._v(" "),w("div",{staticClass:"tw-flex tw-flex-column tw-mg-05 tw-full-width"},[w("select",{ref:"selector",staticClass:"tw-full-width tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05",attrs:{id:"selector"},on:{change:d.onSelectChange}},[w("option",{attrs:{value:"custom"},domProps:{selected:d.is_custom}},[d._v(`
					`+d._s(d.t("setting.combo-box.custom","Custom"))+`
				`)]),d._v(" "),d._l(d.samples,function(h,p){return w("option",{key:p,domProps:{selected:h.data===d.message&&h.topic===d.topic,value:p}},[d._v(`
					`+d._s(h.name)+`
				`)])})],2),d._v(" "),w("input",{ref:"topic",staticClass:"tw-block tw-font-size-6 tw-full-width ffz-textarea ffz-mg-t-1p",on:{blur:d.updateMessage,input:d.onMessageChange}}),d._v(" "),w("textarea",{ref:"message",staticClass:"tw-block tw-font-size-6 tw-full-width ffz-textarea ffz-mg-t-1p tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium",attrs:{rows:"10"},on:{blur:d.updateMessage,input:d.onMessageChange}})])]),d._v(" "),w("div",{staticClass:"tw-mg-t-1 tw-flex tw-align-items-center"},[w("div",{staticClass:"tw-flex-grow-1"}),d._v(" "),w("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[w("input",{ref:"replay_fix",staticClass:"ffz-checkbox__input",attrs:{id:"replay_fix",type:"checkbox"},domProps:{checked:d.replay_fix},on:{change:d.onCheck}}),d._v(" "),w("label",{staticClass:"ffz-checkbox__label",attrs:{for:"replay_fix"}},[w("span",{staticClass:"tw-mg-l-1"},[d._v(`
					`+d._s(d.t("debug.chat-tester.replay-fix","Fix ID and Channel"))+`
				`)])])]),d._v(" "),w("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",on:{click:d.playMessage}},[w("span",{staticClass:"tw-button__text ffz-i-play"},[d._v(`
				`+d._s(d.t("debug.chat-tester.play","Play Message"))+`
			`)])])]),d._v(" "),w("div",{staticClass:"tw-pd-t-1 tw-border-t tw-mg-t-1 tw-flex tw-mg-b-1 tw-align-items-center"},[w("div",{staticClass:"tw-flex-grow-1"}),d._v(" "),w("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[w("input",{ref:"capture_chat",staticClass:"ffz-checkbox__input",attrs:{id:"capture_chat",type:"checkbox"},domProps:{checked:d.capture_chat},on:{change:d.onCheck}}),d._v(" "),w("label",{staticClass:"ffz-checkbox__label",attrs:{for:"capture_chat"}},[w("span",{staticClass:"tw-mg-l-1"},[d._v(`
					`+d._s(d.t("debug.chat-tester.capture-chat","Capture Chat"))+`
				`)])])]),d._v(" "),w("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[w("input",{ref:"ignore_privmsg",staticClass:"ffz-checkbox__input",attrs:{id:"ignore_privmsg",type:"checkbox"},domProps:{checked:d.ignore_privmsg},on:{change:d.onCheck}}),d._v(" "),w("label",{staticClass:"ffz-checkbox__label",attrs:{for:"ignore_privmsg"}},[w("span",{staticClass:"tw-mg-l-1"},[d._v(`
					`+d._s(d.t("debug.chat-tester.ignore-privmsg","Ignore PRIVMSG"))+`
				`)])])]),d._v(" "),w("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[w("input",{ref:"capture_pubsub",staticClass:"ffz-checkbox__input",attrs:{id:"capture_pubsub",type:"checkbox"},domProps:{checked:d.capture_pubsub},on:{change:d.onCheck}}),d._v(" "),w("label",{staticClass:"ffz-checkbox__label",attrs:{for:"capture_pubsub"}},[w("span",{staticClass:"tw-mg-l-1"},[d._v(`
					`+d._s(d.t("debug.chat-tester.capture-pubsub","Capture PubSub"))+`
				`)])])]),d._v(" "),w("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",on:{click:d.clearLog}},[w("span",{staticClass:"tw-button__text ffz-i-trash"},[d._v(`
				`+d._s(d.t("debug.chat-tester.clear-log","Clear Log"))+`
			`)])])]),d._v(" "),d._l(d.log,function(h){return w("div",{key:h._id,staticClass:"tw-elevation-1 tw-border tw-pd-y-05 tw-pd-r-1 tw-mg-y-05 tw-flex tw-flex-nowrap tw-align-items-center",class:{"tw-c-background-base":h.pubsub,"tw-c-background-alt-2":!h.pubsub}},[w("time",{staticClass:"tw-mg-l-05 tw-mg-r-1 tw-flex-shrink-0"},[d._v(`
			`+d._s(d.tTime(h.timestamp,"HH:mm:ss"))+`
		`)]),d._v(" "),h.pubsub?w("div",{staticClass:"tw-flex-grow-1"},[w("div",{staticClass:"tw-mg-b-05 tw-border-b tw-pd-b-05"},[d._v(d._s(h.topic))]),d._v(" "),w("div",{domProps:{innerHTML:d._s(d.highlightJson(h.data))}})]):h.chat?w("div",{staticClass:"tw-flex-grow-1"},[h.tags?w("div",{staticClass:"ffz-ct--tags"},[d._v(`
				@`),d._l(h.tags,function(p,z){return[w("span",{staticClass:"ffz-ct--tag"},[d._v(d._s(z))]),d._v("="),w("span",{staticClass:"ffz-ct--tag-value"},[d._v(d._s(p))]),d._v(";")]})],2):d._e(),d._v(" "),w("div",{staticClass:"ffz-ct--prefix"},[h.prefix?[d._v(":"),h.user?w("span",{staticClass:"ffz-ct--user"},[d._v(d._s(h.user))]):d._e(),w("span",{staticClass:"ffz-ct--prefix"},[d._v(d._s(h.prefix))])]:d._e(),d._v(" "),w("span",{staticClass:"ffz-ct--command"},[d._v(d._s(h.command))]),d._v(" "),h.channel?[d._v("#"),w("span",{staticClass:"ffz-ct--channel"},[d._v(d._s(h.channel))])]:d._e()],2),d._v(" "),h.last_param?w("div",{staticClass:"ffz-ct--params"},[d._l(h.params,function(p){return w("span",{staticClass:"ffz-ct--param"},[d._v(d._s(p))])}),d._v(`
				:`),w("span",{staticClass:"ffz-ct--param"},[d._v(d._s(h.last_param))])],2):d._e()]):w("div",{staticClass:"tw-flex-grow-1"},[d._v(`
			`+d._s(h.data)+`
		`)]),d._v(" "),w("div",{staticClass:"tw-mg-l-1 tw-flex tw-flex-wrap tw-flex-column tw-justify-content-start tw-align-items-start"},[h.chat||h.pubsub?w("button",{staticClass:"tw-button tw-button--text",on:{click:function(p){return d.replayItem(h)}}},[w("span",{staticClass:"tw-button__text ffz-i-arrows-cw"},[d._v(`
					`+d._s(d.t("debug.chat-tester.replay","Replay"))+`
				`)])]):d._e(),d._v(" "),w("button",{staticClass:"tw-button tw-button--text",on:{click:function(p){return d.copyItem(h)}}},[w("span",{staticClass:"tw-button__text ffz-i-docs"},[d._v(`
					`+d._s(d.t("setting.copy-json","Copy"))+`
				`)])])])])})],2)},"render"),y=[],_=f(24431),E=f(44589),A=f(46949),b=f(83269);const v=f.p+"sample-chat-messages.json",r=["PONG","PING","366","353"];let n=[{name:"Ping",data:"PING :tmi.twitch.tv"}],s=!1;const e={props:["item","context"],data(){const d=window.history.state,m=(0,A.deep_copy)(n),w=d?.ffz_ct_message??m[0].data,h=d?.ffz_ct_topic??m[0].topic??"";return{has_client:!1,samples:m,is_custom:!0,message:w,topic:h,replay_fix:d?.ffz_ct_replay??!0,ignore_privmsg:d?.ffz_ct_privmsg??!1,capture_chat:d?.ffz_ct_chat??!1,capture_pubsub:d?.ffz_ct_pubsub??!1,log:[],logi:0}},watch:{message(){this.is_custom||(this.$refs.message.value=this.message)},topic(){this.is_custom||(this.$refs.topic.value=this.topic)},capture_chat(){this.capture_chat?this.listenChat():this.unlistenChat()},capture_pubsub(){this.capture_pubsub?this.listenPubsub():this.unlistenPubsub()}},created(){this.loadSamples(),this.chat=this.item.getChat(),this.client=this.chat.ChatService.first?.client,this.has_client=!!this.client,this.capture_chat&&this.listenChat(),this.capture_pubsub&&this.listenPubsub()},beforeDestroy(){this.unlistenChat(),this.unlistenPubsub(),this.client=null,this.chat=null},mounted(){this.$refs.message.value=this.message,this.$refs.topic.value=this.topic},methods:{highlightJson(d,m){return(0,E.highlightJson)(d,m)},async loadSamples(){if(s)return;const d=await fetch(_.DEBUG?v:`${_.SERVER}/script/sample-chat-messages.json?_=${(0,b.getBuster)()}`).then(m=>m.ok?m.json():null);if(Array.isArray(d)&&d.length>0){s=!0;for(const w of d)w.topic||(w.topic=""),Array.isArray(w.data)?w.data=w.data.join(`

`):typeof w.data!="string"&&(w.data=JSON.stringify(w.data,null,4));n=d,this.samples=(0,A.deep_copy)(d);let m=!0;for(const w of this.samples)if(w.data===this.message&&w.topic===this.topic){m=!1;break}this.is_custom=m}},listenChat(){if(this.listening_chat||!this.has_client&&(this.client=this.chat.ChatService.first?.client,this.has_client=!!this.client,!this.has_client))return;const d=this.client.connection;d.ffzOnSocketMessage||(d.ffzOnSocketMessage=d.onSocketMessage),d.onSocketMessage=m=>{try{this.handleChat(m)}catch{}return d.ffzOnSocketMessage(m)},d.ws&&(d.ws.onmessage=d.onSocketMessage),this.addLog("Started capturing chat."),this.listening_chat=!0},unlistenChat(){if(!this.listening_chat)return;const d=this.client.connection;d.onSocketMessage=d.ffzOnSocketMessage,d.ws&&(d.ws.onmessage=d.onSocketMessage),this.addLog("Stopped capturing chat."),this.listening_chat=!1},handleChat(d){for(const m of d.data.split(/\r?\n/g)){const w=this.parseChat(m);if(w){if(this.ignore_privmsg&&w.command==="PRIVMSG"||r.includes(w.command))continue;this.addLog(w)}}},parseChat(d){const m=this.client.parser.msg(d);m.chat=!0,Object.keys(m.tags).length===0&&(m.tags=null),m.params.length>0&&m.params[0].startsWith("#")&&(m.channel=m.params.shift().slice(1)),m.params.length>0&&(m.last_param=m.params.pop());const w=m.prefix?m.prefix.indexOf("!"):-1;return w===-1?m.user=null:(m.user=m.prefix.substr(0,w),m.prefix=m.prefix.substr(w)),m},listenPubsub(){this.listening_pubsub||(this.chat.on("site.subpump:pubsub-message",this.handlePubsub,this),this.addLog("Started capturing PubSub."),this.listening_pubsub=!0)},unlistenPubsub(){this.listening_pubsub&&(this.chat.off("site.subpump:pubsub-message",this.handlePubsub,this),this.addLog("Stopped capturing PubSub."),this.listening_pubsub=!1)},handlePubsub(d){d.prefix!=="video-playback-by-id"&&this.addLog({pubsub:!0,topic:d.topic,data:(0,A.deep_copy)(d.message)})},saveState(){try{window.history.replaceState({...window.history.state,ffz_ct_replay:this.replay_fix,ffz_ct_message:this.message,ffz_ct_chat:this.capture_chat,ffz_ct_pubsub:this.capture_pubsub,ffz_ct_privmsg:this.ignore_privmsg},document.title)}catch{}},onSelectChange(){const d=this.$refs.selector.value,m=this.samples[d];d!=="custom"&&m?.data?(this.message=m.data,this.topic=m.topic??"",this.is_custom=!1):this.is_custom=!0},updateMessage(){const d=this.$refs.message.value,m=this.$refs.topic.value;let w=!0;for(const h of this.samples)if(h.data===d&&h.topic===m){w=!1;break}this.is_custom=w,this.is_custom&&(this.topic=m,this.message=d)},onMessageChange(){this.updateMessage()},onCheck(){this.replay_fix=this.$refs.replay_fix.checked,this.capture_chat=this.$refs.capture_chat.checked,this.capture_pubsub=this.$refs.capture_pubsub.checked,this.ignore_privmsg=this.$refs.ignore_privmsg.checked,this.saveState()},addLog(d){typeof d!="object"&&(d={data:d}),d.timestamp=Date.now(),d._id=this.logi++,this.log.unshift(d);const m=this.log.length-100;m>0&&this.log.splice(100,m)},clearLog(){this.log=[],this.addLog("Cleared log.")},copyItem(d){let m;d.raw?m=d.raw:d.data?m=d.data:m=d,typeof m!="string"&&(m=JSON.stringify(m)),navigator.clipboard.writeText(m)},playMessage(){if(this.topic.trim().length>0){let w;try{w=JSON.parse(this.message)}catch(h){console.error(h),alert("Unable to parse message.");return}this.replayItem({pubsub:!0,topic:this.topic,data:w});return}const d=[],m=this.message.split(/\r?\n/g);for(const w of m)try{w&&w.length>0&&d.push(this.parseChat(w))}catch(h){console.error(h),alert("Unable to parse message.");return}for(const w of d)this.replayItem(w)},replayItem(d){if(d.pubsub){const m=this.chat.ChatService.first?.props?.channelID,w=this.chat.resolve("site").getUser();this.replay_fix&&(d.topic=d.topic.replace(/<channel>/gi,m),d.topic=d.topic.replace(/<user>/gi,w.id)),this.chat.resolve("site.subpump").simulateMessage(d.topic,d.data)}if(d.chat){const m=[],w=[];if(d.tags){m.push("@"),w.push("gray");for(const[j,F]of Object.entries(d.tags)){let H=F;j==="id"&&this.replay_fix&&(H=(0,A.generateUUID)()),m.push(j),m.push("="),m.push(`${H}`),m.push(";"),w.push("orange"),w.push("gray"),w.push("white"),w.push("gray")}}(d.user||d.prefix)&&(m.length&&(m.push(" "),w.push("")),m.push(":"),w.push("gray"),d.user&&(m.push(d.user),w.push("green")),d.prefix&&(m.push(d.prefix),w.push("gray"))),m.length&&(m.push(" "),w.push("")),m.push(d.command),w.push("orange"),d.channel&&(m.push(" #"),w.push("gray"),m.push(this.replay_fix?this.chat.ChatService.first?.props?.channelLogin??d.channel:d.channel),w.push("green"));for(const j of d.params)m.push(` ${j}`),w.push("skyblue");d.last_param&&(m.push(" :"),w.push("gray"),m.push(d.last_param),w.push("skyblue"));const h=m.join(""),p=this.client.connection,z=p.ffzOnSocketMessage??p.onSocketMessage,R=m.join("%c"),I=w.map(j=>j?.length?`color: ${j};`:"");this.chat.log.debugColor(`Injecting chat message: %c${R}`,I),z.call(p,{data:h})}}}};var o=f(72934),a=(0,o.Z)(e,N,y,!1,null,null,null);const c=a.exports},10001:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"tw-c-text-alt-2"},[n._v(`
	`+n._s(n.t("setting.tooltip-example","For an example, please hover this link:"))+`
	`),i("a",{staticClass:"ffz-tooltip",attrs:{href:n.url,"data-url":n.url,"data-tooltip-type":"link","data-force-tooltip":"true","data-is-mail":"false",rel:"noopener noreferrer",target:"_blank"}},[n._v(`
		`+n._s(n.url)+`
	`)])])},"render"),y=[];const _=["https://www.youtube.com/watch?v=BFSWlDpA6C4"],A={props:["context","item"],data(){return{url:_[Math.floor(Math.random()*_.length)]}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},4654:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--clear-settings tw-pd-t-05"},[i("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-2"},[i("h3",{staticClass:"ffz-i-attention"},[n._v(`
			`+n._s(n.t("setting.clear.warning","Be careful! This is permanent."))+`
		`)]),n._v(" "),i("markdown",{attrs:{source:n.t("setting.clear.warning-explain","Deleting your data with this tool cannot be reversed. Make sure you have a backup!")}})],1),n._v(" "),n.started?n._e():i("div",[i("div",{staticClass:"tw-mg-b-1"},[n._v(`
			`+n._s(n.t("setting.clear.step-1","Please select which types of data you wish to clear:"))+`
		`)]),n._v(" "),i("div",{staticClass:"tw-mg-l-5"},n._l(n.types,function(e,o){return i("div",{key:o,staticClass:"ffz-checkbox tw-relative tw-mg-y-05"},[i("input",{ref:o,refInFor:!0,staticClass:"ffz-checkbox__input",attrs:{id:o,type:"checkbox"}}),n._v(" "),i("label",{staticClass:"ffz-checkbox__label",attrs:{for:o}},[i("span",{staticClass:"tw-mg-l-1"},[n._v(`
						`+n._s(n.t("setting.clear.opt."+o,e.label||o))+`
					`)])])])}),0),n._v(" "),i("div",{staticClass:"tw-mg-t-1 tw-border-t tw-pd-t-1 tw-mg-b-1"},[i("markdown",{attrs:{source:n.t("setting.clear.step-2","Are you really sure? Please enter `{code}` in the text box below to confirm.",{code:n.code})}})],1),n._v(" "),i("div",{staticClass:"tw-mg-l-5"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.entered,expression:"entered"}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-input tw-pd-x-1 tw-pd-y-05",attrs:{type:"text",autocapitalize:"off",autocorrect:"off"},domProps:{value:n.entered},on:{input:function(e){e.target.composing||(n.entered=e.target.value)}}})]),n._v(" "),i("div",{staticClass:"tw-mg-t-1 tw-border-t tw-pd-t-1 tw-mg-b-1"},[i("div",{staticClass:"tw-mg-l-5"},[i("button",{staticClass:"tw-button",class:{"tw-button--disabled":!n.enabled},on:{click:n.clear}},[n._m(0),n._v(" "),i("span",{staticClass:"tw-button__text"},[n._v(`
						`+n._s(n.t("setting.clear.start","Clear My Data"))+`
					`)])])])])]),n._v(" "),n.started&&n.running?i("div",[n._v(`
		`+n._s(n.t("setting.clear.running","Clearing settings. Please wait..."))+`
	`)]):n._e(),n._v(" "),n.started&&!n.running?i("div",[n._v(`
		`+n._s(n.t("setting.clear.done","Your settings have been cleared. Please refresh any applicable Twitch pages to ensure no cached data remains."))+`
	`)]):n._e()])},"render"),y=[function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("span",{staticClass:"tw-button__icon tw-button__icon--left"},[i("figure",{staticClass:"ffz-i-trash"})])}],_=f(46949);const A={props:["item","context"],data(){return{types:this.context.getFFZ().resolve("settings").getClearables(),entered:"",code:(0,_.generateHex)(8),started:!1,running:!1,message:null}},computed:{enabled(){return this.code===this.entered}},methods:{async clear(){if(!this.enabled)return;this.started=!0,this.running=!0;const n=this.context.getFFZ(),s=n.resolve("settings"),i=s.provider;for(const[e,o]of Object.entries(this.types))if(this.$refs[e]?.[0]?.checked)if(o.clear)await o.clear.call(this,i,s);else{let a=(0,_.maybe_call)(o.keys,this,i,s);if(a instanceof Promise&&(a=await a),Array.isArray(a))for(const c of a)i.delete(c)}this.running=!1}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},13748:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--emote-priorities tw-border-t tw-pd-y-1"},[e.source&&e.source!==e.profile?a("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[a("span",{staticClass:"ffz-i-info"}),e._v(`
		`+e._s(e.t("setting.warn-inheritence","These values are being overridden by another profile and may not take effect."))+`
	`)]):e._e(),e._v(" "),a("div",{staticClass:"tw-border-b tw-mg-b-1 tw-pd-b-1"},[a("p",[e._v(e._s(e.t("setting.priorities.about","Here, you can change the priorities of different emote providers. Please note that the provider priority (FFZ, etc.) is still secondary to the source priority (personal emotes > room emotes > global emotes).")))])]),e._v(" "),a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-b-05"},[a("div",{staticClass:"tw-flex-grow-1"},[e._v(`
			`+e._s(e.t("setting.priorities.drag","Drag providers to change their priority."))+`
		`)]),e._v(" "),e.val.length?a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.clear}},[a("span",{staticClass:"tw-button__text ffz-i-trash"},[e._v(`
				`+e._s(e.t("setting.delete","Delete"))+`
			`)]),e._v(" "),a("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.priorities.delete","Delete the priorities in this settings profile."))+`
			`)])]):e._e()]),e._v(" "),a("div",{ref:"list",staticClass:"ffz--action-list"},[e.val.length?e._e():a("div",{staticClass:"tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-1"},[e._v(`
			`+e._s(e.t("setting.priorities.none","no priorities are defined in this profile"))+`

			`),a("div",{staticClass:"tw-mg-t-1"},[a("button",{staticClass:"tw-button tw-button--text",on:{click:e.addPriorities}},[a("span",{staticClass:"tw-button__text ffz-i-add"},[e._v(`
						`+e._s(e.t("setting.priorities.add","Add Priorities"))+`
					`)])])])]),e._v(" "),e._l(e.val,function(c){return a("section",{key:c.id},[a("div",{staticClass:"ffz--action tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-pd-r-1 tw-mg-y-05 tw-flex tw-flex-nowrap tw-align-items-center"},[e._m(0,!0),e._v(" "),c.font_icon?a("figure",{staticClass:"tw-font-size-2 tw-mg-r-1",class:c.font_icon}):c.icon?a("div",{staticClass:"tw-flex-shrink-0 ffz-card-img--size-4 tw-overflow-hidden tw-mg-r-1"},[a("img",{staticClass:"tw-image",attrs:{src:c.icon}})]):e._e(),e._v(" "),a("div",[c.name?a("h4",[e._v(e._s(c.i18n_key?e.t(c.i18n_key,c.name,c):c.name))]):a("h4",[e._v(`
						`+e._s(e.t("emote-source.unknown","Unknown ({id})",c))+`
					`)]),e._v(" "),c.description?a("div",[e._v(`
						`+e._s(c.desc_i18n_key?e.t(c.desc_i18n_key,c.description,c):c.description)+`
					`)]):e._e()])])])})],2)])},"render"),y=[function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-start handle tw-pd-x-05 tw-pd-t-1 tw-pd-b-05"},[a("span",{staticClass:"ffz-i-ellipsis-vert"})])}],_=f(54643),E=f(17750),A=f(46949);let b=0;const r={mixins:[_.Z],props:["item","context"],data(){return{}},computed:{val(){if(!this.has_value)return[];const e=new Set(this.data.keys()),o=this.value.map(a=>{e.delete(a);const c=this.data.get(a);return c||{id:a}});for(const a of e){const c=this.data.get(a);o.push(c)}return o}},mounted(){this._sortable=E.ZP.create(this.$refs.list,{draggable:"section",filter:"button",onUpdate:e=>{if(e.newIndex===e.oldIndex)return;const o=Array.from(this.val);o.splice(e.newIndex,0,...o.splice(e.oldIndex,1)),this.setValue(o)}})},beforeDestroy(){this._sortable&&this._sortable.destroy(),this._sortable=null},methods:{setValue(e){e?.length>0?this.set(e.map(o=>o.id)):this.clear()},addPriorities(){this.set([...this.data.keys()])}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},67706:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",{staticClass:"ffz--experiments tw-pd-t-05"},[o("div",{staticClass:"tw-pd-b-1 tw-mg-b-1 tw-border-b"},[i._v(`
		`+i._s(i.t("setting.experiments.about","This feature allows you to override experiment values. Please note that, for most experiments, you may have to refresh the page for your changes to take effect."))+`
	`)]),i._v(" "),o("div",{staticClass:"tw-mg-b-2 tw-flex tw-align-items-center"},[o("div",{staticClass:"tw-flex-grow-1"},[i._v(`
			`+i._s(i.t("setting.experiments.unique-id","Unique ID: {id}",{id:i.unique_id}))+`
		`)]),i._v(" "),o("select",{ref:"sort_select",staticClass:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-x-05",on:{change:i.onSort}},[o("option",{domProps:{selected:i.sort_by===0}},[i._v(`
				`+i._s(i.t("setting.experiments.sort-name","Sort By: Name"))+`
			`)]),i._v(" "),o("option",{domProps:{selected:i.sort_by===1}},[i._v(`
				`+i._s(i.t("setting.experiments.sort-rarity","Sort By: Rarity"))+`
			`)])])]),i._v(" "),o("div",{staticClass:"tw-mg-b-2 tw-flex tw-align-items-center"},[o("div",{staticClass:"tw-flex-grow-1"}),i._v(" "),o("div",{staticClass:"ffz-checkbox tw-relative"},[o("input",{directives:[{name:"model",rawName:"v-model",value:i.unused,expression:"unused"}],ref:"unused",staticClass:"ffz-checkbox__input",attrs:{id:"unused",type:"checkbox"},domProps:{checked:Array.isArray(i.unused)?i._i(i.unused,null)>-1:i.unused},on:{change:function(a){var c=i.unused,d=a.target,m=!!d.checked;if(Array.isArray(c)){var w=null,h=i._i(c,w);d.checked?h<0&&(i.unused=c.concat([w])):h>-1&&(i.unused=c.slice(0,h).concat(c.slice(h+1)))}else i.unused=m}}}),i._v(" "),o("label",{staticClass:"ffz-checkbox__label",attrs:{for:"unused"}},[o("span",{staticClass:"tw-mg-l-1"},[i._v(`
					`+i._s(i.t("setting.experiments.show-unused","Display unused experiments."))+`
				`)])])])]),i._v(" "),o("h3",{staticClass:"tw-mg-b-1"},[o("span",[i._v(`
			`+i._s(i.t("setting.experiments.ffz","FrankerFaceZ Experiments"))+`
		`)]),i._v(" "),i.filter?o("span",{staticClass:"tw-mg-l-1 tw-font-size-base tw-regular tw-c-text-alt-2"},[i._v(`
			`+i._s(i.t("setting.experiments.visible","(Showing {visible,number} of {total,number})",{visible:i.visible_ffz.length,total:i.sorted_ffz.length}))+`
		`)]):i._e()]),i._v(" "),o("div",{staticClass:"ffz--experiment-list"},[i._l(i.visible_ffz,function(a){var c=a.key,d=a.exp;return o("section",{key:c,attrs:{"data-key":c}},[o("div",{staticClass:"tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-pd-x-1 tw-mg-y-05 tw-flex tw-flex-nowrap"},[o("div",{staticClass:"tw-flex-grow-1"},[o("h4",[i._v(i._s(d.name?d.name:c))]),i._v(" "),d.description?o("div",{staticClass:"description"},[i._v(`
						`+i._s(d.description)+`
					`)]):i._e()]),i._v(" "),o("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-start"},[o("select",{staticClass:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-x-05",attrs:{"data-key":c},on:{change:function(m){return i.onChange(m)}}},i._l(d.groups,function(m,w){return o("option",{key:w,domProps:{selected:m.value===d.value}},[i._v(`
							`+i._s(i.t("setting.experiments.entry","{value,tostring} (weight: {weight,tostring})",m))+`
						`)])}),0),i._v(" "),o("button",{staticClass:"tw-mg-t-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":d.default},attrs:{disabled:d.default},on:{click:function(m){return i.reset(c)}}},[o("span",{staticClass:"tw-button__text ffz-i-cancel"}),i._v(" "),o("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
							`+i._s(i.t("setting.reset","Reset to Default"))+`
						`)])])])])])}),i._v(" "),Object.keys(i.ffz_data).length?i.visible_ffz.length?i._e():o("div",[i._v(`
			`+i._s(i.t("setting.experiments.none-filter","There are no matching experiments."))+`
		`)]):o("div",[i._v(`
			`+i._s(i.t("setting.experiments.none","There are no current experiments."))+`
		`)])],2),i._v(" "),o("h3",{staticClass:"tw-mg-t-5 tw-mg-b-1"},[o("span",[i._v(`
			`+i._s(i.t("setting.experiments.twitch","Twitch Experiments"))+`
		`)]),i._v(" "),i.experiments_locked&&i.filter?o("span",{staticClass:"tw-mg-l-1 tw-font-size-base tw-regular tw-c-text-alt-2"},[i._v(`
			`+i._s(i.t("setting.experiments.visible","(Showing {visible,number} of {total,number})",{visible:i.visible_twitch.length,total:i.sorted_twitch.length}))+`
		`)]):i._e()]),i._v(" "),i.experiments_locked?o("section",[o("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-2"},[o("h3",{staticClass:"ffz-i-attention"},[i._v(`
				`+i._s(i.t("setting.dev-warning","It's dangerous to go at all."))+`
			`)]),i._v(" "),o("markdown",{attrs:{source:i.t("setting.dev-warning.explain","Be careful, this is an advanced feature intended for developer use only. Normal users should steer clear. Adjusting your experiments can have unexpected impacts on your Twitch experience. FrankerFaceZ is not responsible for any issues you encounter as a result of tampering with experiments, and we will not provide support.\n\nIf you're sure about this, please type `{code}` into the box below and hit enter.",{code:i.code})}})],1),i._v(" "),o("div",{staticClass:"tw-flex tw-align-items-center"},[o("input",{ref:"code",staticClass:"tw-block tw-full-width tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05 tw-mg-b-5",attrs:{type:"text",autocapitalize:"off",autocorrect:"off"},on:{keydown:function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"enter",13,a.key,"Enter")?null:i.enterCode.apply(null,arguments)}}})])]):o("section",[o("div",{staticClass:"ffz--experiment-list"},[i._l(i.visible_twitch,function(a){var c=a.key,d=a.exp;return o("section",{key:c,attrs:{"data-key":c}},[o("div",{staticClass:"ffz--experiment-row tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-pd-x-1 tw-mg-y-05 tw-flex",class:{live:d.in_use}},[i.unused?o("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center tw-border-r tw-mg-r-1 tw-pd-r-1"},[d.in_use?o("div",{staticClass:"ffz--profile__icon ffz-i-ok ffz-il-tooltip__container"},[o("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[i._v(`
								`+i._s(i.t("setting.experiments.active","This experiment is active."))+`
							`)])]):o("div",{staticClass:"ffz--profile__icon ffz-i-cancel ffz-il-tooltip__container"},[o("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[i._v(`
								`+i._s(i.t("setting.experiments.inactive","This experiment is not active."))+`
							`)])])]):i._e(),i._v(" "),o("div",{staticClass:"tw-flex-grow-1"},[o("h4",[i._v(i._s(d.name))]),i._v(" "),o("div",{staticClass:"description"},[i._v(`
							`+i._s(d.remainder)+`
						`)])]),i._v(" "),o("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-start"},[o("select",{staticClass:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-x-05",attrs:{"data-key":c},on:{change:function(m){return i.onTwitchChange(m)}}},[d.value===null?o("option",{domProps:{selected:d.default}},[i._v(`
								`+i._s(i.t("setting.experiments.unset","unset"))+`
							`)]):i._e(),i._v(" "),i._l(d.groups,function(m,w){return o("option",{key:w,domProps:{selected:m.value===d.value}},[i._v(`
								`+i._s(i.t("setting.experiments.entry","{value,tostring} (weight: {weight,tostring})",m))+`
							`)])})],2),i._v(" "),o("button",{staticClass:"tw-mg-t-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":d.default},attrs:{disabled:d.default},on:{click:function(m){return i.resetTwitch(c)}}},[o("span",{staticClass:"tw-button__text ffz-i-cancel"}),i._v(" "),o("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
								`+i._s(i.t("setting.reset","Reset to Default"))+`
							`)])])])])])}),i._v(" "),Object.keys(i.twitch_data).length?i.visible_twitch.length?i._e():o("div",[i._v(`
				`+i._s(i.t("setting.experiments.none-filter","There are no matching experiments."))+`
			`)]):o("div",[i._v(`
				`+i._s(i.t("setting.experiments.none","There are no current experiments."))+`
			`)])],2)])])},"render"),y=[],_=f(46949);function E(i,e){return i.key&&i.key.toLowerCase().includes(e)||i.exp&&(i.exp.name&&i.exp.name.toLowerCase().includes(e)||i.exp.description&&i.exp.description.toLowerCase().includes(e))}$(E,"matches");const A=["sv_cheats 1","idspispopd","rosebud","how do you turn this on"],v={props:["item","filter"],data(){return{code:(0,_.pick_random)(A),experiments_locked:this.item.is_locked(),sort_by:1,unused:!1,unique_id:this.item.unique_id(),ffz_data:this.item.ffz_data(),twitch_data:this.item.twitch_data()}},computed:{sorted_ffz(){return this.sorted(this.ffz_data)},visible_ffz(){let i=this.sorted_ffz;return this.filter?.query&&(i=i.filter(e=>E(e,this.filter.query))),this.filter?.flags&&this.filter.flags.has("modified")&&(i=i.filter(e=>this.item.hasOverride(e.key))),i},sorted_twitch(){return this.sorted(this.twitch_data)},visible_twitch(){let i=this.sorted_twitch;return this.filter?.query&&(i=i.filter(e=>E(e,this.filter.query))),this.filter?.flags&&this.filter.flags.has("modified")&&(i=i.filter(e=>this.item.hasTwitchOverride(e.key))),i}},created(){for(const i in this.ffz_data)if((0,_.has)(this.ffz_data,i)){const e=this.ffz_data[i];this.$set(e,"value",this.item.getAssignment(i)),this.$set(e,"default",!this.item.hasOverride(i)),e.total=e.groups.reduce((o,a)=>o+a.weight,0),this.calculateRarity(e)}for(const i in this.twitch_data)if((0,_.has)(this.twitch_data,i)){const e=this.twitch_data[i];this.$set(e,"value",this.item.getTwitchAssignment(i)),this.$set(e,"default",!this.item.hasTwitchOverride(i)),e.in_use=this.item.usingTwitchExperiment(i),e.remainder=`v: ${e.v}, type: ${this.item.getTwitchType(e.t)}`,e.total=e.groups.reduce((o,a)=>o+a.weight,0),this.calculateRarity(e)}this.item.on(":changed",this.valueChanged,this),this.item.on(":twitch-changed",this.twitchValueChanged,this)},beforeDestroy(){this.item.off(":changed",this.valueChanged,this),this.item.off(":twitch-changed",this.twitchValueChanged,this)},methods:{enterCode(){this.$refs.code.value===this.code&&(this.experiments_locked=!1,this.item.unlock())},calculateRarity(i){let e;for(const o of i.groups)if(o.value===i.value){e=o.weight/i.total;break}this.$set(i,"rarity",e)},sorted(i){const e=[];for(const[o,a]of Object.entries(i))!this.unused&&a.in_use===!1||e.push({key:o,exp:a});return e.sort((o,a)=>{const c=o.exp.in_use,d=a.exp.in_use;if(c&&!d)return-1;if(!c&&d)return 1;if(this.sort_by===1){const h=o.exp.rarity,p=a.exp.rarity;if(h<p)return-1;if(h>p)return 1}const m=o.exp.name?.toLowerCase()??o.key?.toLowerCase(),w=a.exp.name?.toLowerCase()??a.key?.toLowerCase();return m<w?-1:m>w?1:0}),e},reset(i){this.item.deleteOverride(i);const e=this.ffz_data[i];e&&(e.default=!this.item.hasOverride(i))},resetTwitch(i){this.item.deleteTwitchOverride(i);const e=this.twitch_data[i];e&&(e.default=!this.item.hasTwitchOverride(i))},onSort(){this.sort_by=this.$refs.sort_select.selectedIndex},onChange(i){const e=i.target,o=e.selectedIndex,a=e.dataset.key,c=this.ffz_data[a],d=c&&c.groups,m=d&&d[o];m&&this.item.setOverride(a,m.value)},onTwitchChange(i){const e=i.target,o=e.selectedIndex,a=e.dataset.key,c=this.twitch_data[a],d=c.in_use?0:1,m=c&&c.groups,w=m&&m[o-d];w&&this.item.setTwitchOverride(a,w.value)},valueChanged(i,e){const o=this.ffz_data[i];o&&(o.value=e,o.default=!this.item.hasOverride(i),this.calculateRarity(o))},twitchValueChanged(i,e){const o=this.twitch_data[i];o&&(o.value=e,o.default=!this.item.hasTwitchOverride(i),this.calculateRarity(o))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},51374:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",{staticClass:"ffz--widget ffz--filter-editor"},[o("div",{ref:"list",staticClass:"ffz--rule-list"},[!i.editing||!i.editing.length?o("section",{staticClass:"tw-mg-x-1 tw-mg-y-2 tw-c-text-alt-2 tw-align-center sortable-ignore"},[i._v(`
			`+i._s(i.t("setting.filters.empty","(no filters)"))+`
		`)]):i._e(),i._v(" "),i._l(i.editing,function(a){return o("filter-rule-editor",{key:a.id,attrs:{value:a,disabled:i.disabled,filters:i.filters,preview:i.preview,context:i.context,"data-id":a.id},on:{input:function(c){return i.updateRule(a.id,c)},delete:function(c){return i.deleteRule(a.id)}}})})],2),i._v(" "),i.adding||i.maxRules===1&&i.canAddRule?o("div",{staticClass:"tw-flex tw-align-items-center tw-mg-y-1"},[i._m(0),i._v(" "),o("button",{staticClass:"tw-button tw-mg-l-1",on:{click:i.addRule}},[o("span",{staticClass:"tw-button__text ffz-i-plus"},[i._v(`
				`+i._s(i.t("setting.filters.add","Add"))+`
			`)])])]):i.canAddRule?o("button",{staticClass:"tw-button ffz-button--hollow tw-mg-y-05 tw-full-width",on:{click:function(a){i.adding=!0}}},[o("span",{staticClass:"tw-button__text ffz-i-plus"},[i._v(`
			`+i._s(i.t("setting.filters.add-new","Add New Rule"))+`
		`)])]):i._e()])},"render"),y=[function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("select",{ref:"add_box",staticClass:"tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-select"},i._l(i.filters,function(a,c){return o("option",{key:c,domProps:{value:c}},[i._v(`
				`+i._s(i.t(a.i18n,a.title))+`
			`)])}),0)}],_=f(17750),E=f(46949),A=f(44589);const v={props:{value:Array,filters:Object,disabled:{type:Boolean,default:!1},maxRules:{type:Number,required:!1,default:0},preview:{type:Boolean,required:!1,default:!0},context:{type:Object,required:!1}},data(){return{adding:!1,resetting:!1,editing:this.copyValue()}},computed:{canAddRule(){return this.disabled?!1:!this.maxRules||this.editing.length<this.maxRules}},watch:{value(){this.resetting=!0,this.editing=this.copyValue()},editing:{handler(){!this.resetting&&!this.disabled&&this.$emit("input",this.editing),this.resetting=!1},deep:!0}},mounted(){this.sortable=_.ZP.create(this.$refs.list,{draggable:"section",filter:"button,.sortable-ignore",swapThreshold:.33,group:{name:"ffz-filter-editor",put:(i,e,o)=>!(!this.canAddRule||o&&o.contains&&o.contains(i.el)||!(0,A.hasSharedParent)(i.el,e.el,".ffz--rule-list"))},setData:(i,e)=>{const o=this.getRule(e.dataset.id);o&&i.setData("JSON",JSON.stringify(o))},onAdd:i=>{if(this.disabled){i.preventDefault();return}if(!this.canAddRule){i.preventDefault();return}let e;try{e=JSON.parse(i.originalEvent.dataTransfer.getData("JSON"))}catch{i.preventDefault();return}this.editing.splice(i.newDraggableIndex,0,e)},onRemove:i=>{if(this.disabled){i.preventDefault();return}let e;try{e=JSON.parse(i.originalEvent.dataTransfer.getData("JSON"))}catch{i.preventDefault();return}this.deleteRule(e.id)},onUpdate:i=>{this.disabled||i.newIndex!==i.oldIndex&&this.editing.splice(i.newIndex,0,...this.editing.splice(i.oldIndex,1))}})},beforeDestroy(){this.sortable&&(this.sortable.destroy(),this.sortable=null)},methods:{getRule(i,e){if(e||(e=this.editing),!Array.isArray(e))return null;for(let o=0;o<e.length;o++){const a=e[o];if(a){if(a.id===i)return a}else continue;const c=this.filters[a.type];if(c&&c.childRules){const d=this.getRule(i,a.data);if(d)return d}}return null},addRule(){if(this.disabled)return;this.adding=!1;const i=this.$refs.add_box.value,e=this.filters[i];if(!i)return;const o={id:(0,E.generateUUID)(),type:i,data:(0,E.maybe_call)(e.default,e)};this.editing.push(o)},updateRule(i,e){if(!this.disabled){for(let o=0;o<this.editing.length;o++)if(this.editing[o].id===i){this.editing[o]=Object.assign(this.editing[o],e);return}}},deleteRule(i){if(!this.disabled){for(let e=0;e<this.editing.length;e++)if(this.editing[e].id===i){this.editing.splice(e,1);return}}},copyValue(){return Array.isArray(this.value)?(0,E.deep_copy)(this.value).map(i=>(i.id||(i.id=(0,E.generateUUID)()),i)):[]}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},49530:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("section",{staticClass:"ffz--filter-rule-editor tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-mg-y-05 tw-pd-r-1 tw-flex tw-flex-nowrap"},[n._m(0),n._v(" "),n.component?i(n.component,{tag:"component",attrs:{type:n.type,filters:n.filters,context:n.context,preview:n.preview},model:{value:n.editing,callback:function(e){n.editing=e},expression:"editing"}}):i("div",{staticClass:"tw-flex tw-flex-grow-1 tw-align-self-center tw-align-items-center"},[n._v(`
		`+n._s(n.t("setting.filters.missing",'This rule of type "{type}" cannot be loaded. It may be from an add-on that is not loaded.',{type:n.editing&&n.editing.type}))+`
	`)]),n._v(" "),n.isShort&&n.preview?i("div",{staticClass:"tw-mg-l-1 tw-pd-x-1 tw-border-l tw-flex tw-align-items-center ffz--profile__icon tw-relative ffz-il-tooltip__container"},[i("figure",{class:[n.passes?"ffz-i-ok":"ffz-i-cancel"]}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},[n.passes?i("span",[n._v(`
				`+n._s(n.t("setting.filters.active","This rule matches."))+`
			`)]):i("span",[n._v(`
				`+n._s(n.t("setting.filters.inactive","This rule does not match."))+`
			`)])])]):n._e(),n._v(" "),i("div",{staticClass:"tw-border-l tw-pd-l-1 tw-flex tw-flex-column tw-flex-wrap tw-justify-content-start tw-align-items-start",class:[n.isShort?"":"tw-mg-l-1"]},[!n.isShort&&n.preview?i("div",{staticClass:"tw-mg-b-1 tw-border-b tw-pd-b-1 tw-full-width tw-flex tw-justify-content-center ffz--profile__icon tw-relative ffz-il-tooltip__container"},[i("figure",{class:[n.passes?"ffz-i-ok":"ffz-i-cancel"]}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},[n.passes?i("span",[n._v(`
					`+n._s(n.t("setting.filters.active","This rule matches."))+`
				`)]):i("span",[n._v(`
					`+n._s(n.t("setting.filters.inactive","This rule does not match."))+`
				`)])])]):n._e(),n._v(" "),n.deleting?[i("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:function(e){n.deleting=!1}}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},[n._v(`
					`+n._s(n.t("setting.cancel","Cancel"))+`
				`)])]),n._v(" "),i("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:function(e){return n.$emit("delete")}}},[i("span",{staticClass:"tw-button__text ffz-i-trash"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},[n._v(`
					`+n._s(n.t("setting.delete","Delete"))+`
				`)])])]:[i("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:function(e){n.deleting=!0}}},[i("span",{staticClass:"tw-button__text ffz-i-trash"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},[n._v(`
					`+n._s(n.t("setting.delete","Delete"))+`
				`)])])]],2)],1)},"render"),y=[function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center handle tw-c-text-alt-2"},[i("h5",{staticClass:"ffz-i-ellipsis-vert"})])}],_=f(46949);const A={props:{value:Object,filters:Object,context:{type:Object,required:!1},preview:{type:Boolean,required:!1,default:!0}},data(){return{editing:(0,_.deep_copy)(this.value),tester:null,deleting:!1}},computed:{passes(){return this.preview&&this.tester&&this.tester(this.context)},type(){return this.filters[this.editing&&this.editing.type]},component(){return this.type&&this.type.editor},isShort(){return!this.component||this.type&&!this.type.tall}},watch:{editing:{handler(){this.tester=this.type.createTest(this.editing.data,this.filters),this.$emit("input",this.editing)},deep:!0}},created(){this.tester=this.type&&this.type.createTest(this.editing&&this.editing.data,this.filters)}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},30003:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"tw-flex tw-align-items-start"},[s("label"),r._v(" "),s("div",{staticClass:"tw-c-text-alt tw-mg-b-05 tw-mg-x-05"},[r.mode==="date"?s("code",[r._v(`
			`+r._s(r.tDate(r.now,r.value))+`
		`)]):r.mode==="time"?s("code",[r._v(`
			`+r._s(r.tTime(r.now,r.value))+`
		`)]):s("code",[r._v(`
			`+r._s(r.tDateTime(r.now,r.value))+`
		`)])])])},"render"),y=[];const E={props:["context","item","value"],data(){return{mode:this.item.extra.mode,now:null}},mounted(){this.now=new Date,this.timer=setInterval(()=>this.now=new Date,1e3)},beforeDestroy(){clearInterval(this.timer),this.timer=null}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},17239:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--game-list"},[o("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[o("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[o("autocomplete",{staticClass:"tw-flex-grow-1",attrs:{"input-id":"category$"+i.id,items:i.fetchCategories,"suggest-on-focus":!0,"escape-to-clear":!1},scopedSlots:i._u([{key:"default",fn:function(a){return[o("div",{staticClass:"tw-pd-x-1 tw-pd-y-05"},[o("div",{staticClass:"tw-card tw-relative"},[o("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row"},[o("div",{staticClass:"ffz-card-img ffz-card-img--size-3 tw-flex-shrink-0 tw-overflow-hidden"},[o("aspect",{attrs:{ratio:1/1.33}},[o("img",{staticClass:"tw-image",attrs:{alt:a.item.displayName,src:a.item.boxArtURL}})])],1),i._v(" "),o("div",{staticClass:"tw-card-body tw-overflow-hidden tw-relative"},[o("p",{staticClass:"tw-pd-x-1"},[i._v(`
									`+i._s(a.item.displayName)+`
								`)])])])])])]}}]),model:{value:i.adding,callback:function(a){i.adding=a},expression:"adding"}})],1),i._v(" "),o("div",{staticClass:"tw-flex-shrink-0"},[o("button",{staticClass:"tw-button",on:{click:i.add}},[o("span",{staticClass:"tw-button__text"},[i._v(`
					`+i._s(i.t("setting.terms.add-term","Add"))+`
				`)])])])]),i._v(" "),!i.value||!i.value.length?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.no-items","no items"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.value,function(a){return o("li",{key:a,staticClass:"ffz--term ffz--game-term tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[o("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[i.can_link?o("a",{staticClass:"ffz-link",attrs:{href:"/directory/game/"+a},on:{click:function(c){return c.preventDefault(),i.handleLink(a)}}},[i._v(`
					`+i._s(a)+`
				`)]):o("span",[i._v(`
					`+i._s(a)+`
				`)])]),i._v(" "),o("div",{staticClass:"tw-flex-shrink-0"},[o("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){return i.remove(a)}}},[o("span",{staticClass:"tw-button__text ffz-i-trash"}),i._v(" "),o("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
						`+i._s(i.t("setting.delete","Delete"))+`
					`)])])])])}),0)])},"render"),y=[],_=f(90334),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{id:A++,adding:"",can_link:!1}},created(){const i=this.context.getFFZ();this.loader=i.resolve("site.twitch_data"),this.router=i.resolve("site.router"),this.can_link=!i.resolve("main_menu").exclusive},methods:{add(){if(!this.adding?.length)return;const i=Array.from(this.value);i.includes(this.adding)||(i.push(this.adding),this.set(i))},remove(i){const e=Array.from(this.value),o=e.indexOf(i);o!==-1&&(e.length===1?this.clear():(e.splice(o,1),this.set(e)))},handleLink(i){this.router.navigate("dir-game-index",{gameName:i})},async fetchCategories(i){if(!this.loader)return[];const e=await this.loader.getMatchingCategories(i);return!e||!e.items?[]:(0,E.deep_copy)(e.items)}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},56845:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--graphql-inspector"},[a("div",{staticClass:"tw-flex tw-align-items-start"},[a("label",{staticClass:"tw-mg-y-05",attrs:{for:"selector"}},[e._v(`
			`+e._s(e.t("debug.graphql.query","Query:"))+`
		`)]),e._v(" "),a("div",{staticClass:"tw-flex tw-flex-column tw-mg-l-05 tw-full-width"},[a("select",{ref:"selector",staticClass:"tw-full-width tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05",attrs:{id:"selector"},on:{change:e.onSelectChange}},e._l(e.queries,function(c,d){return a("option",{key:c.name,domProps:{selected:e.current===c,value:d}},[e._v(`
					`+e._s(c.name)+`
				`)])}),0)])]),e._v(" "),e.current?a("div",{staticClass:"ffz--example-report"},[a("div",{staticClass:"tw-mg-t-1 tw-c-background-alt-2 tw-font-size-5 tw-pd-y-05 tw-pd-x-1 tw-border-radius-large"},[a("code",[e._v(e._s(e.current.source))])])]):e._e(),e._v(" "),e.current&&e.current.variables?a("div",{staticClass:"tw-mg-t-1"},[a("div",{domProps:{innerHTML:e._s(e.highlightJson(e.current.variables))}})]):e._e(),e._v(" "),e.current&&e.current.result?a("div",{staticClass:"ffz--example-report ffz--tall"},[a("div",{staticClass:"tw-mg-t-1 tw-c-background-alt-2 tw-font-size-5 tw-pd-y-05 tw-pd-x-1 tw-border-radius-large"},[a("code",{domProps:{innerHTML:e._s(e.highlightJson(e.current.result,!0))}})])]):e._e()])},"render"),y=[],_=f(44589),E=f(46949);const A=["kind","definitions","loc"],b={props:["item","context"],data(){return{has_client:!1,has_printer:!1,queryMap:{},current:null}},computed:{queries(){const e=Object.values(this.queryMap);return e.sort((o,a)=>o.name.localeCompare(a.name)),e}},created(){this.ffz=this.item.getFFZ(),this.client=this.ffz.resolve("site.apollo")?.client,this.has_client=!!this.client,this.printer=this.ffz.resolve("site.web_munch")?.getModule("gql-printer"),this.has_printer=!!this.printer},beforeDestroy(){this.client=null,this.ffz=null,this.has_client=!1},mounted(){this.updateQueries()},methods:{updateQueries(){if(!this.client)return;const e=this.client.queryManager?.queries;if(!(!e||!e.values)){for(const o of e.values()){if(!o?.document)continue;let a=v(o.document);a||(a=o.observableQuery?.queryName),this.queryMap[a]||this.$set(this.queryMap,a,{id:o.queryId,name:a,source:this.printQuery(o.document),variables:null,result:null}),this.queryMap[a].variables=(0,E.deep_copy)(o.observableQuery?.last?.variables??o.observableQuery?.variables),this.queryMap[a].result=(0,E.deep_copy)(o.observableQuery?.lastResult?.data??o.observableQuery?.last?.result?.data??null)}this.current||(this.current=Object.values(this.queries)[0])}},highlightJson(e,o){return(0,_.highlightJson)(e,o)},printQuery(e){if(this.printer)try{return this.printer(e)}catch(o){this.ffz.log.warn("Unable to print GQL using gql-printer.",o)}return e.loc?.source?.body},onSelectChange(){const e=this.$refs.selector.value,o=this.queries[e];this.current=o}}};function v(e){const o=Object.keys(e).filter(a=>!A.includes(a));if(o.length===1)return o[0]}$(v,"guessNameFromDocument");const r=b;var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},99851:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",{staticClass:"ffz--home tw-flex tw-flex-nowrap"},[o("div",{staticClass:"tw-flex-grow-1"},[o("div",{staticClass:"tw-align-center"},[o("h2",{staticClass:"ffz-i-zreknarf ffz-i-pd-1"},[i._v(`
				FrankerFaceZ
			`)]),i._v(" "),o("span",{staticClass:"tw-c-text-alt"},[i._v(`
				`+i._s(i.t("home.tag-line","The Twitch Enhancement Suite"))+`
			`)])]),i._v(" "),o("section",{staticClass:"tw-pd-t-1 tw-border-t tw-mg-t-1"},[o("markdown",{attrs:{source:i.t("home.about",i.md)}})],1),i._v(" "),i.unseen?o("div",{staticClass:"tw-pd-t-1 tw-border-t tw-mg-t-1"},[o("h3",{staticClass:"tw-pd-b-05"},[i._v(`
				`+i._s(i.t("home.new-settings","New Settings"))+`
			`)]),i._v(" "),o("div",{staticClass:"tw-pd-b-1"},[i._v(`
				`+i._s(i.t("home.new-settings.desc","These are settings that you haven't looked at yet."))+`
			`)]),i._v(" "),i._l(i.unseen,function(a){return o("div",{key:a.key,staticClass:"tw-mg-b-05"},[o("a",{staticClass:"tw-strong",attrs:{href:"#"},on:{click:function(c){return c.preventDefault(),i.item.requestPage(a.key)}}},i._l(a.tokens,function(c,d){return o("span",{key:d},[i._v(`
						`+i._s(c.i18n?i.t(c.i18n,c.title):c.title)+`
					`)])}),0),i._v(" "),i._l(a.entries,function(c){return o("div",{key:c.key,staticClass:"tw-mg-l-2"},[i._v(`
					`+i._s(c.i18n?i.t(c.i18n,c.title):c.title)+`
				`)])})],2)})],2):i._e(),i._v(" "),i.addons?o("div",{staticClass:"tw-pd-t-1 tw-border-t tw-mg-t-1"},[o("h3",{staticClass:"tw-pd-b-05"},[i._v(`
				`+i._s(i.t("home.addon-updates","Updated Add-Ons"))+`
			`)]),i._v(" "),o("div",{staticClass:"tw-pd-b-1"},[o("markdown",{attrs:{source:i.t("home.addon-updates.desc","These add-ons have updated within the past seven days. Check the [changelog](~add_ons.changelog) to see what's changed.")}})],1),i._v(" "),i._l(i.addons,function(a){return o("div",{key:a.key,staticClass:"tw-mg-b-05 tw-flex tw-align-items-center"},[o("div",{staticClass:"ffz-card-img--size-4 tw-overflow-hidden tw-mg-r-1"},[o("img",{staticClass:"tw-image",attrs:{src:a.icon}})]),i._v(" "),o("div",[a.enabled&&a.settings?o("a",{staticClass:"tw-strong ffz-link--inherit",attrs:{href:"#"},on:{click:function(c){return c.preventDefault(),i.item.requestPage(a.settings)}}},[i._v(`
						`+i._s(a.name_i18n?i.t(a.name_i18n,a.name):a.name)+`
					`)]):o("div",{staticClass:"tw-strong"},[i._v(`
						`+i._s(a.name_i18n?i.t(a.name_i18n,a.name):a.name)+`
					`)]),i._v(" "),o("div",{staticClass:"tw-c-text-alt"},[o("span",{staticClass:"tw-mg-r-1"},[i._v(`
							`+i._s(i.t("addon.version","Version {version}",a))+`
						`)]),i._v(" "),o("span",[i._v(`
							`+i._s(i.t("addon.updated","Updated: {when,humantime}",{when:a.updated}))+`
						`)])])])])})],2):i._e(),i._v(" "),i.new_addons?o("div",{staticClass:"tw-pd-t-1 tw-border-t tw-mg-t-1"},[o("h3",{staticClass:"tw-pd-b-05"},[i._v(`
				`+i._s(i.t("home.addon-new","New Add-Ons"))+`
			`)]),i._v(" "),o("div",{staticClass:"tw-pd-b-1"},[o("markdown",{attrs:{source:i.t("home.addon-new.desc","These add-ons were published within the past seven days. Check them out in [Add-Ons](~add_ons).")}})],1),i._v(" "),i._l(i.new_addons,function(a){return o("div",{key:a.key,staticClass:"tw-mg-b-05 tw-flex tw-align-items-center"},[o("div",{staticClass:"ffz-card-img--size-4 tw-overflow-hidden tw-mg-r-1"},[o("img",{staticClass:"tw-image",attrs:{src:a.icon}})]),i._v(" "),o("div",[a.enabled&&a.settings?o("a",{staticClass:"tw-strong ffz-link--inherit",attrs:{href:"#"},on:{click:function(c){return c.preventDefault(),i.item.requestPage(a.settings)}}},[i._v(`
						`+i._s(a.name_i18n?i.t(a.name_i18n,a.name):a.name)+`
					`)]):o("div",{staticClass:"tw-strong"},[i._v(`
						`+i._s(a.name_i18n?i.t(a.name_i18n,a.name):a.name)+`
					`)]),i._v(" "),o("div",{staticClass:"tw-c-text-alt"},[o("span",{staticClass:"tw-mg-r-1"},[i._v(`
							`+i._s(i.t("addon.version","Version {version}",a))+`
						`)]),i._v(" "),o("span",[i._v(`
							`+i._s(i.t("addon.updated","Updated: {when,humantime}",{when:a.updated}))+`
						`)])])])])})],2):i._e()]),i._v(" "),o("div",{staticClass:"tw-mg-l-1 tw-flex-shrink-0 tweet-column"},[o("div",{staticClass:"tw-flex tw-mg-b-1"},[o("a",{staticClass:"tw-flex-grow-1 tw-button ffz-tooltip ffz--ffz-button tw-mg-r-1",attrs:{"data-title":i.t("home.website","FrankerFaceZ Website"),href:"https://www.frankerfacez.com/",target:"_blank",rel:"noopener"}},[i._m(0)]),i._v(" "),o("a",{staticClass:"tw-flex-grow-1 tw-button ffz-tooltip ffz--discord-button tw-mg-r-1",attrs:{"data-title":i.t("home.discord","Discord"),href:"https://discord.gg/UrAkGhT",target:"_blank",rel:"noopener noreferrer"}},[i._m(1)]),i._v(" "),o("a",{staticClass:"tw-flex-grow-1 tw-button ffz-tooltip ffz--github-button",attrs:{"data-title":i.t("home.github","GitHub"),href:"https://github.com/FrankerFaceZ/FrankerFaceZ",target:"_blank",rel:"noopener noreferrer"}},[i._m(2)])]),i._v(" "),o("rich-feed",{attrs:{url:"https://bsky-feed.special.frankerfacez.com/user::frankerfacez.com",context:i.context}})],1)])},"render"),y=[function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("span",{staticClass:"tw-button__icon tw-pd-05"},[o("figure",{staticClass:"ffz-i-zreknarf tw-font-size-3"})])},function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("span",{staticClass:"tw-button__icon tw-pd-05-1"},[o("figure",{staticClass:"ffz-i-discord tw-font-size-3"})])},function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("span",{staticClass:"tw-button__icon tw-pd-05"},[o("figure",{staticClass:"ffz-i-github tw-font-size-3"})])}],_=f(56539),E=f(44589),A=f(24431);const v={props:["item","context"],data(){return{md:_,theme:"",addons:null,new_addons:null,unseen:this.item.getUnseen()}},created(){this.updateAddons(),this.updateTheme(),this.context.context.on("changed:theme.is-dark",this.updateTheme,this);const i=this.context.getFFZ();i.on("main_menu:update-unseen",this.updateUnseen,this),i.on("addons:data-loaded",this.updateAddons,this)},beforeDestroy(){this.context.context.off("changed:theme.is-dark",this.updateTheme,this);const i=this.context.getFFZ();i.off("main_menu:update-unseen",this.updateUnseen,this),i.off("addons:data-loaded",this.updateAddons,this)},methods:{updateUnseen(){this.unseen=this.item.getUnseen()},updateAddons(){const i=this.context.getFFZ(),e=i.resolve("addons"),o=e?.addons,a=[],c=[],d=Date.now()-86400*7*1e3;if(o)for(const[m,w]of Object.entries(o)){const h=e.isAddonEnabled(m),p=w.created&&w.created>=d,z=h&&w.updated&&w.updated>=d;if(!z&&!(p&&!h&&!w.unlisted))continue;const R={key:m,enabled:h,icon:w.icon,name:w.name,name_i18n:w.name_i18n,updated:w.updated,settings:w.settings,version:w.version};p&&c.push(R),z&&a.push(R)}a.sort((m,w)=>w.updated-m.updated),c.sort((m,w)=>w.created-m.created),this.addons=a.length?a:null,this.new_addons=c.length?c:null},updateTheme(){this.theme=this.context.context.get("theme.is-dark")?"dark":"light"}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},26818:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",[i("div",{staticClass:"tw-mg-b-1"},[i("markdown",{attrs:{source:n.t("i18n.interest",n.md)}})],1),n._v(" "),i("button",{staticClass:"tw-button",on:{click:n.open}},[n._m(0),n._v(" "),i("span",{staticClass:"tw-button__text"},[n._v(`
			`+n._s(n.t("i18n.ui.open","Open Translation Tester"))+`
		`)])])])},"render"),y=[function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("span",{staticClass:"tw-button__icon tw-button__icon--left"},[i("figure",{staticClass:"ffz-i-language"})])}],_=f(45974);const A={data(){return{md:_}},methods:{open(){window.FrankerFaceZ.get().resolve("i18n").openUI()}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},63667:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--link-tester"},[a("div",{staticClass:"ffz--widget ffz--select-box"},[a("div",{staticClass:"tw-flex tw-align-items-start"},[a("label",{staticClass:"tw-mg-y-05",attrs:{for:"selector"}},[e._v(`
				`+e._s(e.t("debug.link-provider.url","Test URL"))+`
			`)]),e._v(" "),a("div",{staticClass:"tw-flex tw-flex-column tw-mg-05"},[a("select",{ref:"selector",staticClass:"tw-full-width tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05",attrs:{id:"selector"},on:{change:e.onSelectChange}},[a("option",{attrs:{value:"custom"},domProps:{selected:e.is_custom}},[e._v(`
						`+e._s(e.t("setting.combo-box.custom","Custom"))+`
					`)]),e._v(" "),e._l(e.examples,function(c){return a("optgroup",{key:c.key,attrs:{label:c.key}},e._l(c.items,function(d){return a("option",{key:d.url,domProps:{selected:d.url===e.raw_url,value:d.url}},[e._v(`
							`+e._s(d.title?d.title+" ("+d.url+")":d.url)+`
						`)])}),0)})],2),e._v(" "),a("input",{ref:"text",staticClass:"ffz-mg-t-1p tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",on:{blur:e.updateText,input:e.onTextChange}})]),e._v(" "),a("button",{staticClass:"tw-mg-05 tw-button tw-button--text ffz-il-tooltip__container",class:e.examples_loading&&"tw-button--disabled",attrs:{disabled:e.examples_loading},on:{click:e.updateExamples}},[a("span",{staticClass:"tw-button__text ffz-i-arrows-cw"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("debug.link-provider.refresh","Refresh"))+`
				`)])])])]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-align-items-center"},[a("div",{staticClass:"tw-flex-grow-1"}),e._v(" "),a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"force_media",staticClass:"ffz-checkbox__input",attrs:{id:"force_media",type:"checkbox"},domProps:{checked:e.force_media},on:{change:e.onCheck}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"force_media"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
					`+e._s(e.t("debug.link-provider.allow.media","Allow Media"))+`
				`)])])]),e._v(" "),a("div",{staticClass:"tw-pd-x-1 ffz-checkbox"},[a("input",{ref:"force_unsafe",staticClass:"ffz-checkbox__input",attrs:{id:"force_unsafe",type:"checkbox"},domProps:{checked:e.force_unsafe},on:{change:e.onCheck}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"force_unsafe"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
					`+e._s(e.t("debug.link-provider.allow.unsafe","Allow NSFW"))+`
				`)])])]),e._v(" "),a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",class:e.es_waiting&&"tw-button--disabled",attrs:{disabled:e.es_waiting},on:{click:e.refresh}},[a("span",{staticClass:"tw-button__text ffz-i-arrows-cw"},[e._v(`
				`+e._s(e.t("debug.link-provider.refresh","Refresh"))+`
			`)])])]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("div",{staticClass:"tw-flex tw-flex-column"},[a("label",[e._v(`
				`+e._s(e.t("debug.link-provider.link","Chat Link"))+`
			`)]),e._v(" "),a("div",{staticClass:"tw-pd-t-05 ffz-checkbox"},[a("input",{ref:"force_tooltip",staticClass:"ffz-checkbox__input",attrs:{id:"force_tooltip",type:"checkbox"},domProps:{checked:e.force_tooltip},on:{change:e.onTooltip}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"force_tooltip"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
						`+e._s(e.t("debug.link-provider.force-tooltip","Force Tooltip"))+`
					`)])])])]),e._v(" "),a("div",{staticClass:"tw-full-width tw-overflow-hidden"},[e.url?a("a",{ref:"link",staticClass:"ffz-tooltip",attrs:{href:e.url,"data-url":e.url,"data-tooltip-type":"link","data-force-tooltip":"true","data-force-open":e.force_tooltip?"true":"false","data-force-media":e.force_media?"true":"false","data-force-unsafe":e.force_unsafe?"true":"false","data-is-mail":"false",rel:"noopener noreferrer",target:"_blank"},on:{click:e.handleClick}},[e._v(`
				`+e._s(decodeURI(e.url))+`
			`)]):e._e()])]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("label",[e._v(`
			`+e._s(e.t("debug.link-provider.embed","Rich Embed"))+`
		`)]),e._v(" "),a("div",{staticClass:"tw-full-width tw-overflow-hidden"},[e.rich_data?a("chat-rich",{attrs:{data:e.rich_data,url:e.url,"force-mid":!1,"force-full":!1,"force-media":e.force_media,"force-unsafe":e.force_unsafe,events:e.events}}):e._e()],1)]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("label",[e._v(`
			`+e._s(e.t("debug.link-provider.mid-embed","Mid Embed"))+`
		`)]),e._v(" "),a("div",{staticClass:"tw-full-width tw-overflow-hidden"},[e.rich_data?a("chat-rich",{attrs:{data:e.rich_data,url:e.url,"force-mid":!0,"force-full":!1,"force-media":e.force_media,"force-unsafe":e.force_unsafe,events:e.events}}):e._e()],1)]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("label",[e._v(`
			`+e._s(e.t("debug.link-provider.full-embed","Full Embed"))+`
		`)]),e._v(" "),a("div",{staticClass:"tw-full-width tw-overflow-hidden"},[e.rich_data?a("chat-rich",{attrs:{data:e.rich_data,url:e.url,"force-full":!0,"force-media":e.force_media,"force-unsafe":e.force_unsafe,events:e.events}}):e._e()],1)]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("label",[e._v(`
			`+e._s(e.t("debug.link-provider.raw-length","Raw Length"))+`
		`)]),e._v(" "),a("div",[e._v(`
			`+e._s(e.tNumber(e.length))+`
		`)])]),e._v(" "),a("div",{staticClass:"tw-flex tw-mg-b-1 tw-full-width"},[a("label",[e._v(`
			`+e._s(e.t("debug.link-provider.raw","Raw Data"))+`
		`)]),e._v(" "),a("div",{staticClass:"tw-full-width tw-overflow-hidden ffz--example-report"},[e.url?a("div",{staticClass:"tw-c-background-alt-2 tw-font-size-5 tw-pd-y-05 tw-pd-x-1 tw-border-radius-large"},[e.raw_loading?a("div",{staticClass:"tw-align-center"},[a("h1",{staticClass:"tw-mg-5 ffz-i-zreknarf loading"})]):typeof e.raw_data=="string"?a("code",[e._v(e._s(e.raw_data))]):a("code",{domProps:{innerHTML:e._s(e.highlightJson(e.raw_data,!0))}})]):e._e()])])])},"render"),y=[],_=f(46949),E=f(44589),A=f(24431);const b=["https://www.twitch.tv/sirstendec","https://www.twitch.tv/videos/42968068","https://www.twitch.tv/sirstendec/clip/HedonisticMagnificentSoymilkChocolateRain","https://clips.twitch.tv/HedonisticMagnificentSoymilkChocolateRain","https://discord.gg/UrAkGhT","https://www.youtube.com/watch?v=CAL4WMpBNs0","https://xkcd.com/221/","https://github.com/FrankerFaceZ/FrankerFaceZ","https://twitter.com/frankerfacez","https://twitter.com/FrankerFaceZ/status/1240717057630625792","http://testsafebrowsing.appspot.com/apiv4/ANY_PLATFORM/MALWARE/URL/","https://en.wikipedia.org/wiki/Emoji","https://en.wikipedia.org/wiki/Naginata","https://www.smbc-comics.com/comic/punishment"],r={components:{"chat-rich":async()=>(await f.e(2348).then(f.bind(f,18249))).default("./chat-rich.vue").default},props:["item","context"],data(){const e=window.history.state;let o=e?.ffz_lt_url;o||(o=(0,_.pick_random)(b));const a=this.formatExamples(b.map(c=>({url:c})),o);return{raw_url:o,examples:a[0],examples_loading:!1,is_custom:a[1],rich_data:null,raw_loading:!1,es_waiting:!1,raw_data:null,length:0,force_media:e?.ffz_lt_media??!0,force_unsafe:e?.ffz_lt_unsafe??!1,force_tooltip:e?.ffz_lt_tip??!1,events:{emit:(...c)=>this.item.getChat().emit(...c),on:(...c)=>this.item.getChat().on(...c),off:(...c)=>this.item.getChat().off(...c)}}},computed:{url(){try{return new URL(this.raw_url).toString()}catch{return null}}},watch:{raw_url(){this.is_custom||(this.$refs.text.value=this.raw_url)},url(){if(this.rebuildData(),this.saveState(),this.force_tooltip){const e=this.$refs.link;if(!e||!this.chat)return;const o=this.chat.resolve("tooltips")?.tips;if(!o)return;o._exit(e),setTimeout(()=>o._enter(e),250)}},rich_data(){this.refreshRaw()},force_tooltip(){const e=this.$refs.link;if(!e||!this.chat)return;const o=this.chat.resolve("tooltips")?.tips;o&&(this.force_tooltip?o._enter(e):o._exit(e))}},created(){this.chat=this.item.getChat(),this.settings=this.chat.resolve("settings"),this.refreshES=(0,_.debounce)(this.refresh,1e3,!0),this.rebuildData=(0,_.debounce)(this.rebuildData,250),this.refreshRaw=(0,_.debounce)(this.refreshRaw,250),this.onTextChange=(0,_.debounce)(this.onTextChange,500),this.updateExamples=(0,_.debounce)(this.updateExamples,500),this.updateEventSource=(0,_.debounce)(this.updateEventSource,500),this.chat.on("chat:update-link-resolver",this.checkRefreshRaw,this),this.settings.on(":changed:debug.link-resolver.source",this.changeProvider,this),this.updateExamples(),this.updateEventSource()},mounted(){if(this.rebuildData(),this.$refs.text.value=this.raw_url,this.force_tooltip){const e=this.$refs.link;if(!e||!this.chat)return;const o=this.chat.resolve("tooltips")?.tips;if(!o)return;o._enter(e)}},beforeDestroy(){this.es&&(this.es.close(),this.es=null),this.chat.off("chat:update-link-resolver",this.checkRefreshRaw,this),this.settings.off(":changed:debug.link-resolver.source",this.changeProvider,this),this.chat=null,this.settings=null},methods:{handleClick(e){return this.chat.handleLinkClick(e)},changeProvider(){this.updateEventSource(),this.updateExamples()},updateEventSource(){const e=this.settings.get("debug.link-resolver.source");if(!e.has_sse){this.es&&(this.es.close(),this.es=null),this.es_waiting=!1;return}this.es||(this.es=new EventSource(`${e.value}/sse`),this.es.addEventListener("error",()=>{this.es_waiting=!0}),this.es.addEventListener("message",()=>{this.es_waiting&&(this.es_waiting=!1,this.refreshES())}))},saveState(){try{window.history.replaceState({...window.history.state,ffz_lt_url:this.raw_url,ffz_lt_media:this.force_media,ffz_lt_unsafe:this.force_unsafe,ffz_lt_tip:this.force_tooltip},document.title)}catch{}},formatExamples(e,o){const a=[],c={};o===void 0&&(o=this.raw_url);let d=!0;for(const m of e){const w=m.resolver||"Unknown";let h=c[w];h||(h=c[w]=[],a.push({key:w,items:h})),o===m.url&&(d=!1),h.push(m)}return a.sort((m,w)=>m.key.localeCompare(w.key)),[a,d]},async updateExamples(){if(this.examples_loading)return;this.examples_loading=!0;let e=this.settings.get("debug.link-resolver.source").value;e==="special:socket"&&(e=A.LINK_DATA_HOSTS.test.value);let o;try{o=(await(0,_.timeout)(fetch(`${e}/examples`),15e3).then(d=>d.ok?d.json():null)).examples}catch(d){console.error(d)}o||(o=[]);const a=o.map(d=>d.url);for(const d of b)a.includes(d)||o.push({url:d,resolver:" Stock"});const c=this.formatExamples(o);this.examples=c[0],this.is_custom=c[1],this.examples_loading=!1},checkRefreshRaw(e){(!e||e&&e===this.url)&&this.refreshRaw()},async refreshRaw(){if(this.raw_data=void 0,this.length=0,!this.rich_data){this.raw_loading=!1;return}this.raw_loading=!0;try{const e=await this.chat.get_link_info(this.url);this.raw_data=e,this.length=JSON.stringify(e).length}catch(e){this.raw_data=`Error

${e.toString()}`}this.raw_loading=!1},rebuildData(){if(!this.url)return this.rich_data=null;const e={type:"link",force_rich:!0,is_mail:!1,url:this.url,text:this.url};this.rich_data=this.chat.rich_providers.link.process.call(this.chat,e)},refresh(){this.chat.clearLinkCache(this.url)},onSelectChange(){const e=this.$refs.selector.value;e&&e!=="custom"?(this.raw_url=e,this.is_custom=!1):this.is_custom=!0},updateText(){const e=this.$refs.text.value;let o=!0;for(const a of this.examples){for(const c of a.items)if(c===e){o=!1;break}if(!o)break}this.is_custom=o,this.is_custom&&(this.raw_url=this.$refs.text.value)},onTextChange(){this.updateText()},onCheck(){this.force_media=this.$refs.force_media.checked,this.force_unsafe=this.$refs.force_unsafe.checked,this.saveState()},onTooltip(){this.force_tooltip=this.$refs.force_tooltip.checked,this.saveState()},highlightJson(e,o){return(0,E.highlightJson)(e,o)}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},8053:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz-dialog ffz-main-menu tw-elevation-3 tw-c-background-alt tw-c-text-base tw-border tw-flex tw-flex-nowrap tw-flex-column",class:{maximized:e.maximized||e.exclusive,exclusive:e.exclusive,faded:e.faded},style:{zIndex:e.z},on:{focusin:e.onFocus,click:e.onFocus}},[a("header",{ref:"header",staticClass:"tw-c-background-base tw-full-width tw-align-items-center tw-flex tw-flex-nowrap",on:{dblclick:function(c){return e.maybeResize(c)}}},[a("h3",{staticClass:"ffz-i-zreknarf ffz-i-pd-1"},[e._v(`
			FrankerFaceZ
		`)]),e._v(" "),a("div",{staticClass:"tw-flex-grow-1 tw-pd-x-2"},[a("div",{staticClass:"tw-search-input"},[a("label",{staticClass:"tw-hide-accessible",attrs:{for:"ffz-main-menu.search"}},[e._v(e._s(e.t("main-menu.search","Search Settings")))]),e._v(" "),a("div",{staticClass:"tw-relative"},[e._m(0),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-l-3 tw-pd-r-1 tw-pd-y-05",attrs:{id:"ffz-main-menu.search",placeholder:e.t("main-menu.search","Search Settings"),type:"search",autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false"},domProps:{value:e.query},on:{input:function(c){c.target.composing||(e.query=c.target.value)}}})])])]),e._v(" "),!e.maximized&&!e.exclusive?a("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:function(c){e.faded=!e.faded}}},[a("span",{staticClass:"tw-button-icon__icon"},[a("figure",{class:e.faded?"ffz-i-eye-off":"ffz-i-eye"})])]):e._e(),e._v(" "),e.exclusive?e._e():a("button",{staticClass:"tw-button-icon tw-mg-x-05 tw-relative ffz-il-tooltip__container",on:{click:e.popout}},[e._m(1),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},[e._v(`
				`+e._s(e.t("main-menu.popout","Open Settings in a New Window"))+`
			`)])]),e._v(" "),e.exclusive?e._e():a("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:e.resize}},[a("span",{staticClass:"tw-button-icon__icon"},[a("figure",{class:{"ffz-i-window-maximize":!e.maximized,"ffz-i-window-restore":e.maximized}})])]),e._v(" "),e.exclusive?e._e():a("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:e.close}},[e._m(2)])]),e._v(" "),a("section",{staticClass:"tw-border-t tw-full-height tw-full-width tw-flex tw-flex-nowrap tw-overflow-hidden"},[a("nav",{staticClass:"ffz-vertical-nav tw-c-background-alt-2 tw-border-r tw-full-height tw-flex tw-flex-column tw-flex-shrink-0 tw-flex-nowrap"},[a("header",{staticClass:"tw-border-b tw-pd-1"},[a("profile-selector",{attrs:{context:e.context},on:{navigate:e.navigate}})],1),e._v(" "),a("div",{staticClass:"tw-full-width tw-full-height tw-overflow-hidden tw-flex tw-flex-nowrap tw-relative"},[a("simplebar",{attrs:{classes:"ffz-vertical-nav__items tw-full-width tw-flex-grow-1"}},[e.has_unseen?a("header",{staticClass:"tw-border-b tw-pd-1"},[a("button",{staticClass:"tw-button ffz-button--hollow tw-full-width",on:{click:e.allRead}},[a("span",{staticClass:"tw-button__text"},[e._v(`
								`+e._s(e.t("main-menu.mark-all-seen","Mark All Seen"))+`
							`)])])]):e._e(),e._v(" "),a("menu-tree",{attrs:{"current-item":e.currentItem,modal:e.nav,filter:e.filter,context:e.context},on:{"change-item":e.changeItem,"mark-seen":e.markSeen,"mark-expanded":e.markExpanded,navigate:e.navigate}})],1)],1),e._v(" "),a("footer",{staticClass:"tw-c-text-alt tw-border-t tw-pd-1"},[a("div",[e._v(`
					`+e._s(e.t("main-menu.version","Version {version}",{version:e.version.toString()}))+`
				`)]),e._v(" "),a("div",{staticClass:"tw-c-text-alt-2"},[e.version.commit?a("a",{staticClass:"ffz-link ffz-link--inherit",attrs:{href:"https://www.github.com/FrankerFaceZ/FrankerFaceZ/commit/"+e.version.commit,target:"_blank",rel:"noopener noreferrer"}},[e._v(`
						`+e._s(e.version.commit.slice(0,7))+`
					`)]):a("span",[e._v(`
						`+e._s(e.version.hash)+`
					`)])])])]),e._v(" "),a("simplebar",{attrs:{classes:"tw-flex-grow-1"}},[e.currentItem?a("menu-page",{ref:"page",attrs:{context:e.context,item:e.currentItem,filter:e.filter,"nav-keys":e.navKeys},on:{"change-item":e.changeItem,"mark-seen":e.markSeen,navigate:e.navigate}}):e._e()],1)],1)])},"render"),y=[function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"tw-absolute tw-align-items-center tw-c-text-alt-2 tw-flex tw-full-height ffz-input__icon tw-justify-content-center tw-left-0 tw-top-0 tw-z-default"},[a("figure",{staticClass:"ffz-i-search"})])},function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("span",{staticClass:"tw-button-icon__icon"},[a("figure",{staticClass:"ffz-i-link-ext"})])},function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("span",{staticClass:"tw-button-icon__icon"},[a("figure",{staticClass:"ffz-i-window-close"})])}],_=f(10388),E=f.n(_),A=f(94417);const b=["modified"],r={data(){const e=this.$vnode.data;return e.z=(0,A.getDialogNextZ)(),e},computed:{filter(){let e=this.query.toLowerCase(),o=new Set;return e=e.replace(/(?<=^|\s)@(\S+)(?:\s+|$)/g,(a,c,d)=>b.includes(c)?(o.add(c),""):a),e=e.trim(),e.length||(e=null),o.size||(o=null),!e&&!o?null:{flags:o,query:e}}},watch:{maximized(){this.updateDrag()}},created(){this.context.context._add_user()},destroyed(){this.context.context._remove_user()},mounted(){this.updateDrag(),this._on_resize=this.handleResize.bind(this),window.addEventListener("resize",this._on_resize)},beforeDestroy(){this.destroyDrag(),this._on_resize&&(window.removeEventListener("resize",this._on_resize),this._on_resize=null)},methods:{allRead(){this.markAllSeen(this.nav),this.has_unseen=!1},maybeResize(e){e.target===this.$refs.header&&this.resize(e)},changeProfile(){const e=this.$refs.profiles.value,o=this.context.profiles[e];o&&(this.context.currentProfile=o)},changeItem(e){if(this.$refs.page&&this.$refs.page.onBeforeChange&&this.$refs.page.onBeforeChange(this.currentItem,e)===!1)return;if(this.markSeen(e),e.redirect)return this.navigate(Array.isArray(e.redirect)?e.redirect:e.redirect.split(/\./g));this.currentItem=e,this.restoredItem=!0;let o;this.exclusive&&(o=new URL(location.href),o.searchParams.set("ffz-settings",e.full_key),o=o.toString());try{window.history.replaceState({...window.history.state,ffzcc:e.full_key},document.title,o)}catch{}let a=e;for(;a=a.parent;)a.expanded=!0},updateDrag(){this.maximized?this.destroyDrag():this.createDrag()},destroyDrag(){this.displace&&(this.displace.destroy(),this.displace=null)},createDrag(){this.$nextTick(()=>{this.maximized||(this.displace=E()(this.$el,{handle:this.$el.querySelector("header"),highlightInputs:!0,constrain:!0,onMouseDown:()=>this.onFocus(),onTouchStart:()=>this.onFocus(),ignoreFn(e){return e.target.closest("button")!=null}}))})},onFocus(){this.exclusive||(this.z=(0,A.getDialogNextZ)())},handleResize(){this.displace&&this.displace.reinit()},navigate(...e){let o;for(const c of e)if(o=this.navKeys[c],o)break;const a=[];for(;o&&o.page;)o.tab&&o.parent?.tabs&&a.push([o.parent,o.parent.tabs.indexOf(o)]),o=o.parent;if(o&&!(this.$refs.page&&this.$refs.page.onBeforeChange&&this.$refs.page.onBeforeChange(this.currentItem,o)===!1)){if(this.changeItem(o),a.length){const c=$(()=>{const d=a.pop();d?.[0]?._component&&d[0]._component.select(d[1]),a.length&&this.$nextTick(c)},"bits");this.$nextTick(c)}this.$nextTick(()=>{const c=this.$el.querySelector(`.ffz--menu-tree li[data-key="${o.full_key}"]`);c&&c.scrollIntoView()})}}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},83615:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--home tw-border-t tw-pd-y-1"},[r.loading?s("div",{staticClass:"tw-align-center tw-pd-1"},[s("h1",{staticClass:"tw-mg-5 ffz-i-zreknarf loading"})]):s("markdown",{attrs:{source:r.t("home."+r.key,r.md)}})],1)},"render"),y=[];const E={props:["item","context"],data(){return{key:this.item.key,loading:!0,md:null}},mounted(){this.load()},methods:{async load(){this.md=(await f(94821)(`./${this.key}.md`)).default,this.loading=!1}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},68697:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return r.item.contents?s("div",{class:r.classes},[r.item.no_header?r._e():s("header",{staticClass:"tw-font-size-5"},[r._v(`
		`+r._s(r.t(r.item.i18n_key,r.item.title))+`
	`)]),r._v(" "),r.item.description?s("section",{staticClass:"tw-pd-b-1 tw-c-text-alt"},[s("markdown",{attrs:{source:r.t(r.item.desc_i18n_key,r.item.description)}})],1):r._e(),r._v(" "),r._l(r.visibleContents,function(i){return s("div",{key:i.full_key,class:{"ffz-unmatched-item":r.showing&&!r.shouldShow(i)}},[s(i.component,{tag:"component",attrs:{context:r.context,item:i,filter:r.filter},on:{navigate:r.navigate}})],1)})],2):r._e()},"render"),y=[];const E={props:["item","context","filter"],computed:{showing(){return this.shouldShow(this.item)},visibleContents(){return!this.item||!this.item.contents?[]:this.context.matches_only?this.item.contents.filter(r=>this.shouldShow(r)):this.item.contents},classes(){return["ffz--menu-container",this.item.full_box?"tw-border":"tw-border-t"]}},methods:{navigate(...r){this.$emit("navigate",...r)},shouldShow(r,n=!1){if(!this.filter||r.no_filter)return!0;if(this.filter.flags&&this.filter.flags.has("modified")){if(!n){for(const s of["tabs","contents","items"])if(r[s]){for(const i of r[s])if(this.shouldShow(i))return!0}}if(!r.setting||!this.context.currentProfile.has(r.setting))return!1}return!(this.filter.query&&(!r.search_terms||!r.search_terms.includes(this.filter.query)))}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},77253:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--menu-page"},[s("header",{staticClass:"tw-mg-b-1"},[r._l(r.breadcrumbs,function(i){return s("span",{key:i.full_key},[i!==r.item?s("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),r.$emit("change-item",i,!1)}}},[r._v(r._s(r.t(i.i18n_key,i.title)))]):r._e(),r._v(" "),i===r.item?s("strong",[r._v(r._s(r.t(i.i18n_key,i.title)))]):r._e(),r._v(" "),i!==r.item?[r._v("\xBB ")]:r._e()],2)}),r._v(" "),r.item.header_links?s("span",{staticClass:"ffz--menu-page__header-links"},[s("span",{staticClass:"tw-mg-x-05"},[r._v("\u2022")]),r._v(" "),r._l(r.item.header_links,function(i){return[i.href&&i.href.startsWith("~")?s("a",{staticClass:"tw-mg-r-05",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),r.$emit("navigate",i.href.slice(1))}}},[r._v(r._s(r.t(i.i18n_key,i.title)))]):i.href?s("react-link",{staticClass:"tw-mg-r-05",attrs:{href:i.href,state:i.state}},[r._v(r._s(r.t(i.i18n_key,i.title)))]):i.navigate?s("a",{staticClass:"tw-mg-r-05",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),r.navigate.apply(void 0,i.navigate)}}},[r._v(r._s(r.t(i.i18n_key,i.title)))]):i.target?s("a",{staticClass:"tw-mg-r-05",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),r.$emit("change-item",i.target,!1)}}},[r._v(r._s(r.t(i.i18n_key,i.title)))]):r._e()]})],2):r._e()],2),r._v(" "),r.context.currentProfile.ephemeral&&r.item.profile_warning!==!1?s("section",{staticClass:"tw-border-t tw-pd-t-1 tw-pd-b-2"},[s("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[s("h3",{staticClass:"ffz-i-attention"},[r._v(`
				`+r._s(r.t("setting.profiles.ephemeral","This profile is ephemeral."))+`
			`)]),r._v(" "),s("span",[r._v(`
				`+r._s(r.t("setting.profiles.ephemeral.description","The currently selected profile is ephemeral, which is a fancy way of saying that it was automatically generated, that it only exists temporarily, and that any changes you make won't be saved."))+`
			`)]),r._v(" "),s("span",[r._v(r._s(r.t("setting.profiles.ephemeral.description-2","Please select a different profile from the selector at the upper left of this menu to edit your settings.")))])])]):r._e(),r._v(" "),(!r.context.currentProfile.live||!r.context.currentProfile.toggled)&&r.item.profile_warning!==!1?s("section",{staticClass:"tw-border-t tw-pd-t-1 tw-pd-b-2"},[s("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[s("h3",{staticClass:"ffz-i-attention"},[r._v(`
				`+r._s(r.t("setting.profiles.inactive","This profile is not active."))+`
			`)]),r._v(" "),r.context.currentProfile.toggled?s("span",[r._v(`
				`+r._s(r.t("setting.profiles.inactive.description","This profile's rules don't match the current context and it therefore isn't currently active, so you won't see changes you make here reflected on Twitch."))+`
			`)]):s("span",[r._v(`
				`+r._s(r.t("setting.profiles.disabled.description","This profile has been disabled, so you won't see changes you make here reflected on Twitch."))+`
			`)])])]):r._e(),r._v(" "),r.context.currentProfile.url&&!r.context.currentProfile.pause_updates&&r.item.profile_warning!==!1?s("section",{staticClass:"tw-border-t tw-pd-t-1 tw-pd-b-2"},[s("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[s("h3",{staticClass:"ffz-i-attention"},[r._v(`
				`+r._s(r.t("setting.profiles.updates","This profile will update automatically."))+`
			`)]),r._v(" "),s("span",[r._v(`
				`+r._s(r.t("setting.profile.updates-about","This profile is set to automatically update. When it does, any changed settings within it will be reset. Profile Rules will be reset as well."))+`
			`)])])]):r._e(),r._v(" "),r.context.has_update?s("section",{staticClass:"tw-border-t tw-pd-t-1 tw-pd-b-2"},[s("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[s("h3",{staticClass:"ffz-i-arrows-cw"},[r._v(`
				`+r._s(r.t("setting.update","There is an update available."))+`
			`)]),r._v(`

			`+r._s(r.t("setting.update.description","Please refresh your page to receive the latest version of FrankerFaceZ."))+`
		`)])]):r._e(),r._v(" "),r.item.description?s("section",{staticClass:"tw-border-t tw-pd-y-1"},[s("markdown",{attrs:{source:r.t(r.item.desc_i18n_key||r.item.i18n_key+".description",r.item.description)}})],1):r._e(),r._v(" "),!r.item.contents||!r.item.contents.length||r.item.always_list_pages?[s("ul",{staticClass:"tw-border-t tw-pd-y-1"},r._l(r.visibleItems,function(i){return s("li",{key:i.full_key,staticClass:"tw-pd-x-1",class:{"ffz-unmatched-item":!r.shouldShow(i)}},[s("a",{attrs:{href:"#"},on:{click:function(e){return r.$emit("change-item",i,!1)}}},[r._v(`
					`+r._s(r.t(i.i18n_key,i.title))+`
					`),r.filter?s("span",{staticClass:"ffz-pill ffz-pill--overlay"},[r._v(r._s(r.countMatches(i)))]):i.unseen?s("span",{staticClass:"ffz-pill ffz-pill--overlay"},[r._v(r._s(i.unseen))]):r._e()])])}),0)]:r._e(),r._v(" "),r._l(r.visibleContents,function(i){return s("div",{key:i.full_key,class:{"ffz-unmatched-item":!r.shouldShow(i)}},[s(i.component,{ref:"children",refInFor:!0,tag:"component",attrs:{context:r.context,item:i,"nav-keys":r.navKeys,filter:r.filter},on:{"change-item":r.changeItem,"mark-seen":r.markSeen,navigate:r.navigate}})],1)})],2)},"render"),y=[];const E={props:["item","context","filter","navKeys"],computed:{breadcrumbs(){const r=[];let n=this.item;for(;n;)r.unshift(n),n=n.parent;return r},visibleItems(){return!this.item||!this.item.items?[]:this.context.matches_only?this.item.items.filter(r=>this.shouldShow(r)):this.item.items},visibleContents(){return!this.item||!this.item.contents?[]:this.context.matches_only?this.item.contents.filter(r=>this.shouldShow(r)):this.item.contents}},methods:{shouldShow(r,n=!1){if(!this.filter||r.no_filter)return!0;if(this.filter.flags&&this.filter.flags.has("modified")){if(!n){for(const s of["tabs","contents","items"])if(r[s]){for(const i of r[s])if(this.shouldShow(i))return!0}}if(!r.setting||!this.context.currentProfile.has(r.setting))return!1}return!(this.filter.query&&(!r.search_terms||!r.search_terms.includes(this.filter.query)))},countMatches(r,n){if(!this.filter||!r||n&&n.has(r))return 0;n||(n=new Set),n.add(r);let s=0;for(const i of["tabs","contents","items"])if(r[i])for(const e of r[i])s+=this.countMatches(e,n);return r.setting&&this.shouldShow(r,!0)&&s++,s},markSeen(r){this.$emit("mark-seen",r)},changeItem(r){this.$emit("change-item",r)},navigate(...r){this.$emit("navigate",...r)},onBeforeChange(r,n){if(this.$refs.children){for(const s of this.$refs.children)if(s&&s.onBeforeChange){const i=s.onBeforeChange(r,n);if(i!==void 0)return i}}}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},75652:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return i.modal?o("ul",{staticClass:"ffz--menu-tree",attrs:{role:[i.root?"group":"tree"],tabindex:i.tabIndex},on:{keyup:[function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"up",38,a.key,["Up","ArrowUp"])?null:i.prevItem.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"down",40,a.key,["Down","ArrowDown"])?null:i.nextItem.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"left",37,a.key,["Left","ArrowLeft"])||"button"in a&&a.button!==0?null:i.prevLevel.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"right",39,a.key,["Right","ArrowRight"])||"button"in a&&a.button!==2?null:i.nextLevel.apply(null,arguments)},function(a){return!a.type.indexOf("key")&&i._k(a.keyCode,"*",void 0,a.key,void 0)?null:i.expandAll.apply(null,arguments)}]}},i._l(i.displayed,function(a){return o("li",{key:a.full_key,class:[i.currentItem===a||a.hide_children&&i.containsCurrent(a)?"active":""],attrs:{"data-key":a.full_key,role:"presentation"}},[o("div",{staticClass:"tw-flex__item tw-flex tw-flex-nowrap tw-align-items-center tw-pd-y-05 tw-pd-r-05",attrs:{"aria-expanded":a.expanded,"aria-selected":i.currentItem===a,role:"treeitem"},on:{click:function(c){return i.clickItem(a)}}},[o("span",{staticClass:"arrow",class:[a.items&&!a.hide_children?"":"ffz--invisible",a.expanded?"ffz-i-down-dir":"ffz-i-right-dir"],attrs:{role:"presentation"}}),i._v(" "),o("span",{staticClass:"tw-flex-grow-1"},[i._v(`
				`+i._s(i.t(a.i18n_key,a.title))+`
			`)]),i._v(" "),i.filter?o("span",{staticClass:"ffz-pill ffz-pill--overlay"},[i._v(`
				`+i._s(i.countMatches(a))+`
			`)]):a.pill?o("span",{staticClass:"ffz-pill ffz-pill--overlay"},[i._v(`
				`+i._s(a.pill_i18n_key?i.t(a.pill_i18n_key,a.pill):a.pill)+`
			`)]):a.unseen?o("span",{staticClass:"ffz-pill ffz-pill--overlay"},[i._v(`
				`+i._s(a.unseen)+`
			`)]):i._e()]),i._v(" "),a.items&&a.expanded&&!a.hide_children?o("menu-tree",{attrs:{root:a,"current-item":i.currentItem,modal:a.items,context:i.context,filter:i.filter},on:{"change-item":function(c){return i.$emit("change-item",c)},"mark-seen":function(c){return i.$emit("mark-seen",c)},"mark-expanded":function(c){return i.$emit("mark-expanded",c)}}}):i._e()],1)}),0):i._e()},"render"),y=[];function _(i){return i.expanded&&i.items?_(i.items[i.items.length-1]):i}$(_,"findLastVisible");function E(i,e){const o=i.parent?i.parent.items:e,a=o.indexOf(i);return o[a+1]?o[a+1]:i.parent?E(i.parent,e):null}$(E,"findNextVisible");function A(i,e){if(i.expanded||(i.expanded=!0,e&&e.$emit("mark-expanded",i)),i.items)for(const o of i.items)A(o,e)}$(A,"recursiveExpand");const v={props:["root","modal","currentItem","filter","context"],computed:{tabIndex(){return this.root?void 0:0},displayed(){return this.modal.filter(i=>this.shouldShow(i))}},methods:{shouldShow(i,e=!1){if(!this.filter||this.containsCurrent(i))return!0;if(this.filter.flags&&this.filter.flags.has("modified")){if(!e){for(const o of["tabs","contents","items"])if(i[o]){for(const a of i[o])if(this.shouldShow(a))return!0}}if(!i.setting||!this.context.currentProfile.has(i.setting))return!1}return!(this.filter.query&&(!i.search_terms||!i.search_terms.includes(this.filter.query)))},countMatches(i,e){if(!this.filter||!i||e&&e.has(i))return 0;e||(e=new Set),e.add(i);let o=0;for(const a of["tabs","contents","items"])if(i[a])for(const c of i[a])o+=this.countMatches(c,e);return i.setting&&this.shouldShow(i,!0)&&o++,o},containsCurrent(i){let e=this.currentItem;for(;e;){if(i===e)return!0;e=e.parent}return!1},clickItem(i){i.expanded?this.currentItem===i&&(i.expanded=!1):i.expanded=!0,this.$emit("mark-expanded",i),this.$emit("change-item",i)},expandAll(){for(const i of this.modal)A(i,this)},prevItem(){if(this.root)return;const i=this.currentItem,e=i.parent?i.parent.items:this.modal,o=e.indexOf(i);o>0?this.$emit("change-item",_(e[o-1])):i.parent&&this.$emit("change-item",i.parent)},nextItem(){if(this.root)return;const i=this.currentItem;let e;i.expanded&&i.items?e=i.items[0]:e=E(i,this.modal),e&&this.$emit("change-item",e)},prevLevel(){if(this.root)return;const i=this.currentItem;i.expanded&&i.items?(i.expanded=!1,this.$emit("mark-expanded",i)):i.parent&&this.$emit("change-item",i.parent)},nextLevel(){if(this.root)return;const i=this.currentItem;i.expanded&&i.items?this.$emit("change-item",i.items[0]):(i.expanded=!0,this.$emit("mark-expanded",i)),event.ctrlKey&&A(this.currentItem,this)}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},66306:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",[i("pre",[n._v(n._s(JSON.stringify(n.events,null,"	")))])])},"render"),y=[],_=f(46949);const A={props:["item","context"],data(){return{events:(0,_.deep_copy)(this.item.getEvents())}},computed:{initial_time(){const n=this.events[0];return n?n.ts:0}},created(){this.onEvent=this.onEvent.bind(this),this.item.setListener(this.onEvent)},destroyed(){this.onEvent=null,this.item.setListener(null)},methods:{onEvent(n){this.events.push((0,_.deep_copy)(n))}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},5762:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--profile-editor"},[s.isEphemeral?e("section",{staticClass:"tw-border-t tw-pd-t-1 tw-pd-b-2"},[e("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[e("h3",{staticClass:"ffz-i-attention"},[s._v(`
				`+s._s(s.t("setting.profiles.ephemeral","This profile is ephemeral."))+`
			`)]),s._v(" "),e("span",[s._v(`
				`+s._s(s.t("setting.profiles.ephemeral.description","The currently selected profile is ephemeral, which is a fancy way of saying that it was automatically generated, that it only exists temporarily, and that any changes you make won't be saved."))+`
			`)]),s._v(" "),e("span",[s._v(s._s(s.t("setting.profiles.ephemeral.description-2","Please select a different profile from the selector at the upper left of this menu to edit your settings.")))])])]):s._e(),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center tw-border-t tw-pd-1"},[e("div",{staticClass:"tw-flex-grow-1"}),s._v(" "),e("button",{staticClass:"tw-button tw-button--text",class:{"tw-button--disabled":s.isEphemeral},attrs:{disabled:s.isEphemeral},on:{click:s.save}},[e("span",{staticClass:"tw-button__text ffz-i-floppy"},[s._v(`
				`+s._s(s.t("setting.save","Save"))+`
			`)])]),s._v(" "),e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",class:{"tw-button--disabled":s.item.profile&&s.context.profiles.length<2},attrs:{disabled:s.item.profile&&s.context.profiles.length<2},on:{click:s.del}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
				`+s._s(s.t("setting.delete","Delete"))+`
			`)])]),s._v(" "),e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",class:{"tw-button--disabled":!s.canExport},attrs:{disabled:!s.canExport},on:{click:s.doExport}},[e("span",{staticClass:"tw-button__text ffz-i-download"},[s._v(`
				`+s._s(s.t("setting.export","Export"))+`
			`)])])]),s._v(" "),s.export_error?e("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[e("section",{staticClass:"tw-flex-grow-1"},[e("h4",{staticClass:"ffz-i-attention"},[s._v(`
				`+s._s(s.t("setting.backup-restore.error","There was an error processing this backup."))+`
			`)]),s._v(" "),s.export_error_message?e("div",[s._v(`
				`+s._s(s.export_error_message)+`
			`)]):s._e()]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:s.resetExport}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.close","Close"))+`
			`)])])]):s._e(),s._v(" "),s.export_message?e("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[e("section",{staticClass:"tw-flex-grow-1"},[s._v(`
			`+s._s(s.export_message)+`
		`)]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:s.resetExport}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.close","Close"))+`
			`)])])]):s._e(),s._v(" "),e("div",{staticClass:"ffz--menu-container tw-border-t"},[e("header",[s._v(`
			`+s._s(s.t("setting.data_management.profiles.edit.general","General"))+`
		`)]),s._v(" "),e("div",{staticClass:"ffz--widget tw-flex tw-flex-nowrap"},[e("label",{attrs:{for:"ffz:editor:name"}},[s._v(`
				`+s._s(s.t("setting.data_management.profiles.edit.name","Name"))+`
			`)]),s._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.name,expression:"name"}],ref:"name",staticClass:"tw-full-width tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"ffz:editor:name",disabled:s.isEphemeral},domProps:{value:s.name},on:{input:function(o){o.target.composing||(s.name=o.target.value)}}})]),s._v(" "),e("div",{staticClass:"ffz--widget tw-flex tw-flex-nowrap"},[e("label",{attrs:{for:"ffz:editor:description"}},[s._v(`
				`+s._s(s.t("setting.data_management.profiles.edit.desc","Description"))+`
			`)]),s._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:s.desc,expression:"desc"}],ref:"desc",staticClass:"tw-full-width tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"ffz:editor:description",disabled:s.isEphemeral},domProps:{value:s.desc},on:{input:function(o){o.target.composing||(s.desc=o.target.value)}}})]),s._v(" "),e("div",{staticClass:"ffz--widget"},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"ffz:editor:hotkey"}},[s._v(`
					`+s._s(s.t("setting.data_management.profiles.edit.hotkey","Hotkey"))+`
				`)]),s._v(" "),e("key-picker",{ref:"hotkey",attrs:{id:"ffz:editor:hotkey",disabled:s.isEphemeral},model:{value:s.hotkey,callback:function(o){s.hotkey=o},expression:"hotkey"}})],1),s._v(" "),e("section",{staticClass:"tw-mg-t-05 tw-c-text-alt-2"},[e("markdown",{attrs:{source:s.t("setting.data_management.profiles.hotkey.desc",`Setting a hotkey allows you to toggle a profile on or off at any time by using the hotkey.

**Note:** A profile that is toggled on may still be inactive due to its rules.`)}})],1)])]),s._v(" "),s.url?e("div",{staticClass:"ffz--menu-container tw-border-t"},[e("header",[e("figure",{staticClass:"tw-inline tw-mg-r-05 ffz-i-download-cloud"}),s._v(`
			`+s._s(s.t("setting.data_management.profiles.edit.updates","Automatic Updates"))+`
		`)]),s._v(" "),e("section",{staticClass:"tw-pd-b-1 tw-c-text-alt-2"},[s._v(`
			`+s._s(s.t("setting.data_management.profiles.edit.updates.description","This profile has an associated URL for automatic updates. When updates are enabled and the profile updates, all settings associated with the profile will be reset. The profile's rules will be reset as well. The Name, Description, and Hotkey will not reset."))+`
		`)]),s._v(" "),e("div",{staticClass:"ffz--widget tw-flex tw-flex-nowrap"},[e("label",{attrs:{for:"ffz:editor:url"}},[s._v(`
				`+s._s(s.t("setting.data_management.profiles.edit.url","Update URL"))+`
			`)]),s._v(" "),e("input",{staticClass:"tw-full-width tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"ffz:editor:url",readonly:""},domProps:{value:s.url}})]),s._v(" "),e("div",{staticClass:"ffz--widget ffz--checkbox"},[e("div",{staticClass:"tw-flex tw-align-items-center ffz-checkbox"},[e("input",{ref:"update",staticClass:"ffz-checkbox__input",attrs:{id:"ffz:editor:update",disabled:s.isEphemeral,type:"checkbox"},domProps:{checked:!s.pause},on:{change:s.onPauseChange}}),s._v(" "),e("label",{staticClass:"ffz-checkbox__label",attrs:{for:"ffz:editor:update"}},[e("span",{staticClass:"tw-mg-l-1"},[s._v(`
						`+s._s(s.t("setting.data_management.profiles.edit.update","Automatically update this profile."))+`
					`)])])])])]):s._e(),s._v(" "),e("div",{staticClass:"ffz--menu-container tw-border-t"},[e("header",[s._v(`
			`+s._s(s.t("setting.data_management.profiles.edit.rules","Rules"))+`
		`)]),s._v(" "),e("section",{staticClass:"tw-pd-b-1 tw-c-text-alt-2"},[s._v(`
			`+s._s(s.t("setting.data_management.profiles.edit.rules.description","Rules allows you to define a series of conditions under which this profile will be active. When there are multiple rules, they must all match for the profile to activate. Please use an `Or` rule to create a profile that activates by matching one of several rules."))+`
		`)]),s._v(" "),e("filter-editor",{attrs:{filters:s.filters,disabled:s.isEphemeral,context:s.test_context,preview:!0},model:{value:s.rules,callback:function(o){s.rules=o},expression:"rules"}})],1)])},"render"),y=[],_=f(46949),E=f(11227);const b={props:["item","context"],data(){const s=this.context.getFFZ().resolve("settings");return{filters:(0,_.deep_copy)(s.filters),old_name:null,old_desc:null,old_rules:null,old_hotkey:null,old_pause:null,name:null,desc:null,hotkey:null,url:null,pause:null,unsaved:!1,rules:null,test_context:null,export_error:!1,export_error_message:null,export_message:null}},computed:{isEphemeral(){return this.item.profile?.ephemeral??!1},canExport(){return this.item.profile!=null}},watch:{name(){this.name!==this.old_name&&(this.unsaved=!0)},desc(){this.desc!==this.old_desc&&(this.unsaved=!0)},hotkey(){this.hotkey!==this.old_hotkey&&(this.unsaved=!0)},pause(){this.pause!==this.old_pause&&(this.unsaved=!0)},rules:{handler(){(0,_.deep_equals)(this.rules,this.old_rules)||(this.unsaved=!0)},deep:!0}},created(){this.context.context.on("context_changed",this.updateContext,this),this.updateContext(),this.revert()},beforeDestroy(){this.context.context.off("context_changed",this.updateContext,this)},methods:{onPauseChange(){this.pause=!this.$refs.update.checked},resetExport(){this.export_error=!1,this.export_error_message=null,this.export_message=null},doExport(){this.resetExport();let s;try{const i=this.item.profile.getBackup();s=new Blob([JSON.stringify(i)],{type:"application/json;charset=utf-8"})}catch{this.export_error=!0,this.export_error_message=this.t("setting.backup-restore.dump-error","Unable to export settings data to JSON.");return}try{(0,E.saveAs)(s,`ffz-profile - ${this.name}.json`)}catch{this.export_error=!0,this.export_error_message=this.t("setting.backup-restore.save-error","Unable to save.")}},revert(){const s=this.item.profile;this.old_name=this.name=s?s.i18n_key?this.t(s.i18n_key,s.title,s):s.title:"Unnamed Profile",this.old_desc=this.desc=s?s.desc_i18n_key?this.t(s.desc_i18n_key,s.description,s):s.description:"",this.old_hotkey=this.hotkey=s?s.hotkey:null,this.old_rules=this.rules=s?(0,_.deep_copy)(s.context):[],this.old_url=this.url=s?s.url:null,this.old_pause=this.pause=s?s.pause_updates:null,this.unsaved=!s},del(){if(this.item.profile||this.unsaved){if(!confirm(this.t("setting.profiles.warn-delete","Are you sure you wish to delete this profile? It cannot be undone.")))return;this.item.profile&&this.context.deleteProfile(this.item.profile)}this.unsaved=!1,this.$emit("navigate","data_management.profiles")},save(){if(!this.item.profile)this.item.profile=this.context.createProfile({name:this.name,description:this.desc,context:this.rules,hotkey:this.hotkey,pause_updates:this.pause});else if(this.unsaved){const s={name:this.name,description:this.desc,context:this.rules,hotkey:this.hotkey,pause_updates:this.pause};this.name!==this.old_name&&(s.i18n_key=void 0),this.desc!==this.old_desc&&(s.desc_i18n_key=void 0),this.item.profile.update(s)}this.unsaved=!1,this.$emit("navigate","data_management.profiles")},updateContext(){this.test_context=this.context.context.context},onBeforeChange(){if(this.unsaved)return confirm(this.t("setting.warn-unsaved","You have unsaved changes. Are you sure you want to leave the editor?"))}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},10087:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--widget ffz--profile-manager tw-border-t tw-pd-y-1"},[e.context.exclusive?a("section",{staticClass:"tw-pd-b-2"},[a("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1"},[a("h3",{staticClass:"ffz-i-info"},[e._v(`
				`+e._s(e.t("setting.context-difference","Your Profiles might not match."))+`
			`)]),e._v(`

			`+e._s(e.t("setting.context-difference.description","Since the Control Center is open in a new window, profiles may match differently here than on other Twitch windows."))+`

			`),e.context.can_proxy?a("div",{staticClass:"tw-flex tw-align-items-center tw-mg-t-1"},[a("div",{staticClass:"ffz-checkbox tw-relative ffz-il-tooltip__container"},[a("input",{ref:"proxied",staticClass:"ffz-checkbox__input",attrs:{id:"proxied",type:"checkbox"},domProps:{checked:e.context.proxied},on:{change:e.onProxyCheck}}),e._v(" "),a("label",{staticClass:"ffz-checkbox__label",attrs:{for:"proxied"}},[a("span",{staticClass:"tw-mg-l-1"},[e._v(`
							`+e._s(e.t("setting.context-difference.use","Use Original Windows's Context"))+`
						`)])]),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-balloon--md ffz-il-tooltip--wrap ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
						`+e._s(e.t("setting.context-difference.tip","Checking this will use the context from the original window, causing profiles and thier rules to match like they would in the window that opened this Control Center."))+`
					`)])])]):e._e()])]):e._e(),e._v(" "),a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-b-05"},[a("div",{staticClass:"tw-flex-grow-1"},[e._v(`
			`+e._s(e.t("setting.profiles.drag","Drag profiles to change their priority."))+`
		`)]),e._v(" "),a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",class:{"tw-button--disabled":e.importing},attrs:{disabled:e.importing},on:{click:function(c){return e.edit()}}},[a("span",{staticClass:"tw-button__text ffz-i-plus"},[e._v(`
				`+e._s(e.t("setting.profiles.new","New Profile"))+`
			`)])]),e._v(" "),a("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:e.closeMenu,expression:"closeMenu"}],staticClass:"tw-relative"},[a("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text",class:{"tw-button--disabled":e.importing},attrs:{disabled:e.importing},on:{click:e.toggleMenu}},[a("span",{staticClass:"tw-button__text ffz-i-upload"},[e._v(`
					`+e._s(e.t("setting.import","Import\u2026"))+`
				`)]),e._v(" "),e._m(0)]),e._v(" "),e.menu_open?a("balloon",{attrs:{color:"background-alt-2",dir:"down-right",size:e.menu_pasting?"md":"sm"}},[a("simplebar",{staticClass:"ffz-mh-30"},[e.menu_pasting?a("div",{staticClass:"tw-pd-1"},[a("div",{staticClass:"tw-flex tw-align-items-center"},[a("input",{ref:"paste",staticClass:"tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{placeholder:e.t("setting.paste-url.url","[url]")},on:{keydown:function(c){return!c.type.indexOf("key")&&e._k(c.keyCode,"enter",13,c.key,"Enter")?null:e.doImportURL.apply(null,arguments)}}}),e._v(" "),a("button",{staticClass:"tw-mg-l-05 tw-button",on:{click:e.doImportURL}},[a("span",{staticClass:"tw-button__text ffz-i-plus"},[e._v(`
									`+e._s(e.t("setting.import.do","Import"))+`
								`)])])])]):a("div",{staticClass:"tw-pd-y-1"},[a("button",{staticClass:"ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive tw-full-width",on:{click:e.preparePaste}},[a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-y-05 tw-pd-x-1"},[a("div",{staticClass:"tw-flex-grow-1 tw-mg-r-1 ffz-i-download-cloud"},[e._v(`
									`+e._s(e.t("setting.import.url","From URL"))+`
								`)])])]),e._v(" "),a("button",{staticClass:"ffz-interactable ffz-interactable--hover-enabled ffz-interactable--default tw-interactive tw-full-width",on:{click:e.doImport}},[a("div",{staticClass:"tw-flex tw-align-items-center tw-pd-y-05 tw-pd-x-1"},[a("div",{staticClass:"tw-flex-grow-1 tw-mg-r-1 ffz-i-upload"},[e._v(`
									`+e._s(e.t("setting.import.file","From File"))+`
								`)])])])])])],1):e._e()],1)]),e._v(" "),e.import_error?a("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[a("section",{staticClass:"tw-flex-grow-1"},[a("h4",{staticClass:"ffz-i-attention"},[e._v(`
				`+e._s(e.t("setting.backup-restore.error","There was an error processing this backup."))+`
			`)]),e._v(" "),e.import_error_message?a("div",[e._v(`
				`+e._s(e.import_error_message)+`
			`)]):e._e()]),e._v(" "),a("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:e.resetImport}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.close","Close"))+`
			`)])])]):e._e(),e._v(" "),e.import_message?a("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[a("section",{staticClass:"tw-flex-grow-1"},[e._v(`
			`+e._s(e.import_message)+`
		`)]),e._v(" "),e.import_closable?a("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:e.resetImport}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.close","Close"))+`
			`)])]):e._e()]):e._e(),e._v(" "),e.import_profiles?a("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[a("section",{staticClass:"tw-flex-grow-1"},[a("h4",{staticClass:"ffz-i-upload"},[e._v(`
				`+e._s(e.t("setting.backup-restore.pick-profile","Please select a profile to import."))+`
			`)]),e._v(" "),e._l(e.import_profiles,function(c,d){return a("button",{key:d,staticClass:"tw-block tw-full-width tw-mg-y-05 tw-mg-r-1 tw-pd-05 tw-button ffz-button--hollow tw-c-text-overlay tw-relative ffz-il-tooltip__container",on:{click:function(m){return e.importProfile(c)}}},[a("span",{staticClass:"tw-button__text tw-c-text-overlay"},[e._v(`
					`+e._s(c.i18n_key?e.t(c.i18n_key,c.name):c.name)+`
				`)]),e._v(" "),c.description?a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
					`+e._s(c.desc_i18n_key?e.t(c.desc_i18n_key,c.description):c.description)+`
				`)]):e._e()])})],2),e._v(" "),a("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:e.resetImport}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.close","Close"))+`
			`)])])]):e._e(),e._v(" "),e.import_profile?a("div",{staticClass:"tw-c-background-accent-alt-2 tw-c-text-overlay tw-pd-1 tw-mg-b-1 tw-flex tw-align-items-start"},[a("section",{staticClass:"tw-flex-grow-1"},[a("h4",{staticClass:"ffz-i-help"},[e._v(`
				`+e._s(e.t("setting.backup-restore.confirm-updates","The profile you are importing has an automatic update URL. Do you want the profile to keep itself up to date?"))+`
			`)]),e._v(" "),a("button",{staticClass:"tw-block tw-full-width tw-mg-y-05 tw-mg-r-1 tw-pd-05 tw-button ffz-button--hollow tw-c-text-overlay",on:{click:function(c){return e.confirmImport(!0)}}},[a("span",{staticClass:"tw-button__text tw-c-text-overlay ffz-i-ok"},[e._v(`
					`+e._s(e.t("setting.backup-restore.enable-auto","Yes, allow automatic updates."))+`
				`)])]),e._v(" "),a("button",{staticClass:"tw-block tw-full-width tw-mg-y-05 tw-mg-r-1 tw-pd-05 tw-button ffz-button--hollow tw-c-text-overlay",on:{click:function(c){return e.confirmImport(!1)}}},[a("span",{staticClass:"tw-button__text tw-c-text-overlay ffz-i-cancel"},[e._v(`
					`+e._s(e.t("setting.backup-restore.disable-auto","No, prevent automatic updates."))+`
				`)])])]),e._v(" "),a("button",{staticClass:"tw-button tw-button--text tw-relative ffz-il-tooltip__container",on:{click:e.resetImport}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.close","Close"))+`
			`)])])]):e._e(),e._v(" "),a("div",{ref:"list",staticClass:"ffz--profile-list"},e._l(e.context.profiles,function(c){return a("section",{key:c.id,attrs:{"data-profile":c.id}},[a("div",{staticClass:"ffz--profile tw-elevation-1 tw-c-background-base tw-border tw-pd-y-05 tw-pd-r-1 tw-mg-y-05 tw-flex tw-flex-nowrap",class:{live:c.live},attrs:{tabindex:"0"}},[e._m(1,!0),e._v(" "),c.ephemeral?a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center tw-mg-r-1 tw-relative ffz-il-tooltip__container tw-font-size-4"},[a("span",{staticClass:"ffz-i-user-secret"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
						`+e._s(e.t("setting.profiles.ephemeral","This profile is ephemeral."))+`
					`)])]):e._e(),e._v(" "),c.url?a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center tw-mg-r-1 tw-relative ffz-il-tooltip__container tw-font-size-4"},[a("span",{class:"ffz-i-download-cloud"+(c.pause_updates?" ffz-unmatched-item":"")}),e._v(" "),c.pause_updates?e._e():a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[a("div",{staticClass:"tw-mg-b-05"},[e._v(`
							`+e._s(e.t("setting.profile.updates","This profile will update automatically from the following URL:"))+`
						`)]),e._v(`
						`+e._s(c.url)+`
					`)])]):e._e(),e._v(" "),a("div",{staticClass:"tw-flex-grow-1"},[a("h4",[e._v(e._s(c.i18n_key?e.t(c.i18n_key,c.title,c):c.title))]),e._v(" "),c.description?a("div",{staticClass:"description"},[e._v(`
						`+e._s(c.desc_i18n_key?e.t(c.desc_i18n_key,c.description,c):c.description)+`
					`)]):e._e()]),e._v(" "),a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center"},[a("button",{staticClass:"tw-button tw-button--text",on:{click:function(d){return e.edit(c)}}},[a("span",{staticClass:"tw-button__text ffz-i-cog"},[e._v(`
							`+e._s(e.t("setting.configure","Configure"))+`
						`)])])]),e._v(" "),a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center tw-border-l tw-mg-l-1 tw-pd-l-1"},[a("button",{staticClass:"tw-button tw-button--text",on:{click:function(d){return e.toggle(c)}}},[a("div",{staticClass:"ffz--profile__icon tw-relative ffz-il-tooltip__container",class:{"ffz-i-ok":c.live,"ffz-i-cancel":!c.toggled,"ffz-i-minus":c.toggled&&!c.live}},[a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[c.live?a("span",[e._v(`
									`+e._s(e.t("setting.profiles.active","This profile is enabled and active."))+`
								`)]):e._e(),e._v(" "),c.toggled?e._e():a("span",[e._v(`
									`+e._s(e.t("setting.profiles.disabled","This profile is disabled."))+`
								`)]),e._v(" "),c.toggled&&!c.live?a("span",[e._v(`
									`+e._s(e.t("setting.profiles.disabled.rules","This profile is enabled, but inactive due to its rules."))+`
								`)]):e._e()])])])])])])}),0)])},"render"),y=[function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("span",{staticClass:"tw-button__icon tw-button__icon--right"},[a("figure",{staticClass:"ffz-i-down-dir"})])},function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"tw-flex tw-flex-shrink-0 tw-align-items-center handle tw-pd-x-05 tw-pd-t-1 tw-pd-b-05"},[a("span",{staticClass:"ffz-i-ellipsis-vert"})])}],_=f(17750),E=f(44589),A=f(46949),b=f(81011);const r={props:["item","context"],data(){return{menu_open:!1,menu_pasting:!1,importing:!1,import_error:!1,import_closable:!0,import_error_message:null,import_message:null,import_profiles:null,import_profile:null}},mounted(){this._sortable=_.ZP.create(this.$refs.list,{draggable:"section",filter:"button",onUpdate:e=>{const o=e.item.dataset.profile,a=this.context.profile_keys[o];a&&a.move(e.newIndex)}})},beforeDestroy(){this._sortable&&this._sortable.destroy(),this._sortable=null},methods:{closeMenu(){this.menu_open=!1,this.menu_pasting=!1},toggleMenu(){this.menu_open=!this.menu_open,this.menu_pasting=!1},preparePaste(){this.menu_open=!0,this.menu_pasting=!0,requestAnimationFrame(()=>{this.$refs.paste.focus()})},onProxyCheck(){const e=this.$refs.proxied.checked;this.context.setProxied(e)},edit(e){const o={full_key:"data_management.profiles.edit_profile",key:"edit_profile",profile_warning:!1,title:"Edit Profile",i18n_key:"setting.data_management.profiles.edit_profile",parent:this.item.parent,contents:[{page:!0,profile:e,component:"profile-editor"}]};o.contents[0].parent=o,this.$emit("change-item",o)},toggle(e){e.toggle()},resetImport(){this.importing=!1,this.import_url=null,this.import_error=!1,this.import_closable=!0,this.import_error_message=null,this.import_message=null,this.import_profiles=null,this.import_profile=null,this.import_profile_data=null,this.import_data=null},async doImportURL(){const e=this.$refs.paste.value;this.closeMenu(),this.resetImport(),this.import_url=e,this.importing=!0,this.import_closable=!1,this.import_message=this.t("setting.backup-restore.http-loading","Loading...");let o;try{const a=await fetch(e);if(!a.ok)throw new Error;o=await a.json()}catch{this.import_message=null,this.import_error=!0,this.import_error_message=this.t("setting.backup-restore.http-error","Unable to read JSON from the provided URL.");return}this.import_message=null,this.importData(o)},async doImport(){this.closeMenu(),this.resetImport(),this.importing=!0;let e,o;try{if(e=await(0,E.openFile)("application/json,application/zip"),!e){this.resetImport();return}if(e.type.toLowerCase().includes("zip")){const c=(await f.e(935).then(f.t.bind(f,29597,23))).default;o=await(await new c().loadAsync(e)).file("settings.json").async("text")}else o=await(0,E.readFile)(e)}catch{this.import_error=!0,this.import_error_message=this.t("setting.backup-restore.read-error","Unable to read file.");return}let a;try{a=JSON.parse(o)}catch{this.import_error=!0,this.import_error_message=this.t("setting.backup-restore.json-error","Unable to parse file as JSON.");return}this.importData(a)},importData(e){if(e&&e.type==="full"){let o=e.values&&e.values.profiles;if(o===void 0&&(o=[b.Z.Moderation,b.Z.Default]),Array.isArray(o)){this.import_data=e,this.import_profiles=(0,A.deep_copy)(o);return}else this.import_message=Object.keys(e.values)}else if(e&&e.type==="profile"&&e.profile&&e.values){this.importProfile(e.profile,e.values);return}this.import_error=!0,this.import_error_message=this.t("setting.backup-restore.non-supported","This file is not recognized as a supported backup format.")},importProfile(e,o){this.import_url&&!e.url&&(e.url=this.import_url),this.import_profile=e,this.import_profile_data=o,!e.url&&this.confirmImport(!1)},confirmImport(e=!1){const o=this.import_profile,a=this.import_profile_data,c=o.id;delete o.id,e||delete o.url;const d=this.context.createProfile(o);d.update({i18n_key:void 0,desc_i18n_key:void 0,description:`${d.description?d.description+`
`:""}${this.t("setting.backup-restore.imported-at","Imported at {now,datetime}.",{now:new Date})}`});let m=0;if(a)for(const[w,h]of Object.entries(a))d.set(w,h),m++;else{const w=this.import_data&&this.import_data.values,h=`p:${c}:`;if(w)for(const[p,z]of Object.entries(w))p.startsWith(h)&&(d.set(p.substr(h.length),z),m++)}this.resetImport(),this.import_message=this.t("setting.backup-restore.imported",'The profile "{name}" has been successfully imported with {count, plural, one {# setting} other {# settings}}.',{name:d.i18n_key?this.t(d.i18n_key,d.title):d.title,count:m})}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},58071:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--profile-selector"},[i("div",{ref:"button",staticClass:"tw-flex tw-align-items-center tw-border-radius-medium tw-font-size-6 tw-full-width ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05",class:{active:n.opened},attrs:{tabindex:"0"},on:{keyup:[function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.stopPropagation(),e.preventDefault(),n.focusShow.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&e.button!==0?null:(e.stopPropagation(),e.preventDefault(),n.focusShow.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.stopPropagation(),e.preventDefault(),n.focusShow.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&e.button!==2?null:(e.stopPropagation(),e.preventDefault(),n.focusShow.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"enter",13,e.key,"Enter")?null:n.focusShow.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:n.focusShow.apply(null,arguments)}],click:n.togglePopup}},[n._v(`
		`+n._s(n.context.currentProfile.i18n_key?n.t(n.context.currentProfile.i18n_key,n.context.currentProfile.title,n.context.currentProfile):n.context.currentProfile.title)+`
	`)]),n._v(" "),n.opened?i("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:n.hide,expression:"hide"}],staticClass:"ffz-balloon tw-block ffz-balloon--lg ffz-balloon--down ffz-balloon--left tw-z-above"},[i("div",{staticClass:"ffz--profile-list tw-elevation-2 tw-c-background-alt",on:{keyup:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"escape",void 0,e.key,void 0)?null:n.focusHide.apply(null,arguments)},focusin:n.focus,focusout:n.blur}},[i("div",{ref:"scroller",staticClass:"scrollable-area tw-border-b",attrs:{"data-simplebar":""}},[i("div",{staticClass:"simplebar-scroll-content"},[i("div",{ref:"popup",staticClass:"simplebar-content"},n._l(n.context.profiles,function(e){return i("div",{key:e.id,staticClass:"ffz--profile-row tw-relative tw-border-b tw-pd-y-05 tw-pd-r-3 tw-pd-l-1",class:{live:e.live,current:e===n.context.currentProfile},attrs:{tabindex:"0"},on:{keydown:[function(o){if(!o.type.indexOf("key")&&n._k(o.keyCode,"up",38,o.key,["Up","ArrowUp"]))return null;o.stopPropagation(),o.preventDefault()},function(o){if(!o.type.indexOf("key")&&n._k(o.keyCode,"down",40,o.key,["Down","ArrowDown"]))return null;o.stopPropagation(),o.preventDefault()},function(o){if(!o.type.indexOf("key")&&n._k(o.keyCode,"page-up",void 0,o.key,void 0))return null;o.stopPropagation(),o.preventDefault()},function(o){if(!o.type.indexOf("key")&&n._k(o.keyCode,"page-down",void 0,o.key,void 0))return null;o.stopPropagation(),o.preventDefault()}],keyup:[function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"up",38,o.key,["Up","ArrowUp"])?null:(o.stopPropagation(),n.prevItem.apply(null,arguments))},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"down",40,o.key,["Down","ArrowDown"])?null:(o.stopPropagation(),n.nextItem.apply(null,arguments))},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"home",void 0,o.key,void 0)?null:n.firstItem.apply(null,arguments)},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"end",void 0,o.key,void 0)?null:n.lastItem.apply(null,arguments)},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"page-up",void 0,o.key,void 0)?null:(o.stopPropagation(),n.prevPage.apply(null,arguments))},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"page-down",void 0,o.key,void 0)?null:(o.stopPropagation(),n.nextPage.apply(null,arguments))},function(o){return!o.type.indexOf("key")&&n._k(o.keyCode,"enter",13,o.key,"Enter")?null:n.changeProfile(e)}],click:function(o){return n.changeProfile(e)}}},[i("div",{staticClass:"ffz--profile-row__icon-tray tw-flex"},[e.ephemeral?i("div",{staticClass:"ffz-il-tooltip__container ffz--profile-row__icon ffz-i-user-secret tw-relative"},[i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
										`+n._s(n.t("setting.profiles.ephemeral","This profile is ephemeral."))+`
									`)])]):n._e(),n._v(" "),e.url?i("div",{class:"ffz-il-tooltip__container ffz--profile-row__icon ffz-i-download-cloud tw-relative"+(e.pause_updates?" ffz-unmatched-item":"")},[e.pause_updates?n._e():i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
										`+n._s(n.t("setting.profiles.updates","This profile will update automatically."))+`
									`)])]):n._e(),n._v(" "),e.toggled?n._e():i("div",{staticClass:"ffz-il-tooltip__container ffz--profile-row__icon ffz-i-cancel tw-relative"},[i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
										`+n._s(n.t("setting.profiles.disabled","This profile is disabled."))+`
									`)])]),n._v(" "),e.live?i("div",{staticClass:"ffz-il-tooltip__container ffz--profile-row__icon ffz-i-ok tw-relative"},[i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
										`+n._s(n.t("setting.profiles.active","This profile is enabled and active."))+`
									`)])]):n._e()]),n._v(" "),i("h4",[n._v(n._s(e.i18n_key?n.t(e.i18n_key,e.title,e):e.title))]),n._v(" "),e.description?i("div",{staticClass:"description"},[n._v(`
								`+n._s(e.desc_i18n_key?n.t(e.desc_i18n_key,e.description,e):e.description)+`
							`)]):n._e()])}),0)])]),n._v(" "),i("div",{staticClass:"tw-pd-y-05 tw-pd-x-05 tw-align-right"},[i("button",{staticClass:"tw-button tw-button--text",on:{click:n.openConfigure}},[i("span",{staticClass:"tw-button__text ffz-i-cog"},[n._v(`
						`+n._s(n.t("setting.profiles.configure","Configure"))+`
					`)])])])])]):n._e()])},"render"),y=[];const _=Array.prototype.indexOf,A={props:["context"],data(){return{opened:!1}},watch:{opened(){this.opened&&this.$nextTick(()=>this.updateScroller())}},methods:{updateScroller(){const n=this.$refs.scroller;!n||!window.ffzSimplebar||n.SimpleBar||new ffzSimplebar(n,ffzSimplebar.getElOptions(n))},openConfigure(){this.hide(),this.$emit("navigate","data_management.profiles")},focus(){this._focused=!0},blur(){this._focused=!1,this._blur_timer||(this._blur_timer=setTimeout(()=>{this._blur_timer=null,!this._focused&&document.hasFocus()&&this.hide()},10))},hide(){this.opened=!1},show(){this.opened||(this.opened=!0)},togglePopup(){this.opened?this.hide():this.show()},focusHide(){this.hide(),this.$refs.button.focus()},focusShow(){this.show(),this.$nextTick(()=>this.$refs.popup.querySelector(".current").focus())},prevItem(n){const s=n.target.previousSibling;s&&(this.scroll(s),s.focus())},nextItem(n){const s=n.target.nextSibling;s&&(this.scroll(s),s.focus())},firstItem(){const n=this.$refs.popup.firstElementChild;n&&(this.scroll(n),n.focus())},prevPage(n){this.select(_.call(this.$refs.popup.children,n.target)-5)},nextPage(n){this.select(_.call(this.$refs.popup.children,n.target)+5)},select(n){const s=this.$refs.popup.children,i=s[n<=0?0:Math.min(n,s.length-1)];i&&(this.scroll(i),i.focus())},lastItem(){const n=this.$refs.popup.lastElementChild;n&&(this.scroll(n),n.focus())},scroll(n){const s=this.$refs.popup.parentElement,i=n.offsetTop,e=n.offsetHeight+i,o=s.scrollTop,a=s.offsetHeight+parseInt(s.style.marginBottom||0,10)+o;i<o?s.scrollBy(0,i-o):e>a&&s.scrollBy(0,e-a)},changeProfile(n){this.context.currentProfile=n;try{window.history.replaceState({...window.history.state,ffzccp:n.id},document.title)}catch(s){console.error(s)}this.focusHide()}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},4184:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>v});var N=$(function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("div",{staticClass:"ffz--provider tw-pd-t-05"},[r.not_www?s("div",{staticClass:"ffz--notice tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[s("h3",{staticClass:"ffz-i-attention"},[r._v(`
			`+r._s(r.t("setting.provider.warn-domain.title","You're far from home!"))+`
		`)]),r._v(" "),s("div",[s("markdown",{attrs:{source:r.t("setting.provider.warn-domain.desc","You are currently changing settings for a sub-domain of Twitch. Any changes here will only affect this sub-domain. You probably want to change this from Twitch's main website, and not here.")}})],1)]):r._e(),r._v(" "),s("div",{staticClass:"ffz--notice tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[s("h3",{staticClass:"ffz-i-attention"},[r._v(`
			`+r._s(r.t("setting.provider.warn.title","Be careful!"))+`
		`)]),r._v(" "),s("div",[s("markdown",{attrs:{source:r.t("setting.provider.warn.desc","Please close any other Twitch tabs before using this tool. It is **recommended to [create a backup](~data_management.backup_and_restore)** before changing your provider, in case anything happens.")}})],1)]),r._v(" "),s("section",{staticClass:"tw-pd-b-1 tw-mg-b-1 tw-border-b"},[s("markdown",{attrs:{source:r.t("setting.provider.about","Here, you can change the storage provider used by FrankerFaceZ when browsing Twitch. You can try this if you're having a problem with your settings not remaining persistent. Please note that you will need to reload any and all Twitch tabs after changing this.")}})],1),r._v(" "),s("div",{staticClass:"ffz-options"},r._l(r.providers,function(i){return s("div",{key:i.key,staticClass:"tw-pd-b-1 ffz-radio ffz-radio-top"},[s("input",{directives:[{name:"model",rawName:"v-model",value:r.selected,expression:"selected"}],staticClass:"ffz-radio__input",attrs:{id:"ffz--provider-opt-"+i.key,name:"ffz--provider-opt",type:"radio"},domProps:{value:i.key,checked:r._q(r.selected,i.key)},on:{change:function(e){r.selected=i.key}}}),r._v(" "),s("label",{staticClass:"tw-block ffz-radio__label",attrs:{for:"ffz--provider-opt-"+i.key}},[s("div",{staticClass:"tw-mg-l-1"},[s("div",[s("span",{staticClass:"tw-strong"},[r._v(`
							`+r._s(r.t(i.i18n_key,i.title))+`
						`)]),r._v(" "),i.key===r.current?s("span",{staticClass:"tw-mg-l-1 tw-c-text-alt"},[r._v(`
							`+r._s(r.t("setting.provider.selected","(Current)"))+`
						`)]):r._e(),r._v(" "),i.has_data?s("span",{staticClass:"tw-mg-l-1 tw-c-text-alt"},[r._v(`
							`+r._s(r.t("setting.provider.has-data","(Has Data)"))+`
						`)]):r._e(),r._v(" "),i.has_blobs?s("span",{staticClass:"tw-mg-l-1 tw-c-text-alt"},[r._v(`
							`+r._s(r.t("setting.provider.has-blobs","(Supports Binary Data)"))+`
						`)]):r._e()]),r._v(" "),i.description?s("section",{staticClass:"tw-c-text-alt-2"},[s("markdown",{attrs:{source:r.t(i.desc_i18n_key,i.description)}})],1):r._e()])])])}),0),r._v(" "),s("div",{staticClass:"tw-border-t tw-pd-t-1"},[r.canTransfer?s("div",{staticClass:"tw-flex tw-align-items-center ffz-checkbox"},[s("input",{ref:"transfer",staticClass:"ffz-checkbox__input",attrs:{id:"transfer",checked:"",type:"checkbox"}}),r._v(" "),s("label",{staticClass:"ffz-checkbox__label",attrs:{for:"transfer"}},[s("div",{staticClass:"tw-mg-l-1"},[r._v(`
					`+r._s(r.t("setting.provider.transfer","Transfer my settings when switching provider."))+`
				`)])])]):r._e(),r._v(" "),r.canTransfer?s("section",{staticClass:"tw-c-text-alt-2 tw-pd-b-05",staticStyle:{"padding-left":"2.5rem"}},[s("markdown",{attrs:{source:r.t("setting.provider.transfer.desc","**Note:** It is recommended to leave this enabled unless you know what you're doing.")}})],1):s("div",{staticClass:"tw-flex tw-align-items-center",staticStyle:{"padding-left":"2.5rem"}},[r._v(`
			`+r._s(r.t("setting.provider.no-transfer","Automatically transfering settings from your current provider to the selected provider is not allowed. Please use Backup and Restore."))+`
		`)]),r._v(" "),s("div",{staticClass:"tw-mg-t-1 tw-flex tw-align-items-center ffz-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:r.backup,expression:"backup"}],ref:"backup",staticClass:"ffz-checkbox__input",attrs:{id:"backup",type:"checkbox"},domProps:{checked:Array.isArray(r.backup)?r._i(r.backup,null)>-1:r.backup},on:{change:function(i){var e=r.backup,o=i.target,a=!!o.checked;if(Array.isArray(e)){var c=null,d=r._i(e,c);o.checked?d<0&&(r.backup=e.concat([c])):d>-1&&(r.backup=e.slice(0,d).concat(e.slice(d+1)))}else r.backup=a}}}),r._v(" "),s("label",{staticClass:"ffz-checkbox__label",attrs:{for:"backup"}},[s("div",{staticClass:"tw-mg-l-1"},[r._v(`
					`+r._s(r.t("setting.provider.backup","Yes, I made a backup."))+`
				`)])])])]),r._v(" "),s("div",{staticClass:"tw-mg-t-1 tw-border-t tw-pd-t-1"},[s("button",{staticClass:"tw-button tw-mg-l-3",class:{"tw-button--disabled":!r.enabled},on:{click:r.change}},[r._m(0),r._v(" "),s("span",{staticClass:"tw-button__text"},[r._v(`
				`+r._s(r.t("setting.provider.start","Change Providers"))+`
			`)])])])])},"render"),y=[function(){var r=this,n=r.$createElement,s=r._self._c||n;return s("span",{staticClass:"tw-button__icon tw-button__icon--left"},[s("figure",{staticClass:"ffz-i-floppy"})])}];const E={props:["item","context"],data(){const r=this.context.getFFZ(),n=r.resolve("settings"),s=[],i={};for(const[o,a]of Object.entries(n.getProviders())){const c={key:o,priority:a.priority||0,has_data:null,has_blobs:a.supportsBlobs,has_trans:a.allowTransfer,i18n_key:`setting.provider.${o}.title`,title:a.title||o,desc_i18n_key:a.description?`setting.provider.${o}.desc`:null,description:a.description};i[o]=a.allowTransfer,a.supported()&&Promise.resolve(a.hasContent()).then(d=>{c.has_data=d}),s.push(c)}s.sort((o,a)=>a.priority-o.priority);const e=n.getActiveProvider();return{backup:!1,not_www:window.location.host!=="www.twitch.tv",providers:s,transfers:i,current:e,selected:e}},computed:{enabled(){return this.selected!==this.current&&this.backup},canTransfer(){return this.transfers[this.selected]&&this.transfers[this.current]}},methods:{change(){if(!this.enabled)return;this.context.getFFZ().resolve("settings").changeProvider(this.selected,this.$refs.transfer.checked)}}};var A=f(72934),b=(0,A.Z)(E,N,y,!1,null,null,null);const v=b.exports},92561:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--reason"},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[e("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[s.editing?e("input",{directives:[{name:"model",rawName:"v-model",value:s.edit_data.text,expression:"edit_data.text"}],staticClass:"tw-block tw-full-width tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05",attrs:{placeholder:s.adding?s.t("setting.reasons.add-placeholder","Add a new reason"):s.edit_data.text,type:"text",autocapitalize:"off",autocorrect:"off"},domProps:{value:s.edit_data.text},on:{input:function(o){o.target.composing||s.$set(s.edit_data,"text",o.target.value)}}}):e("h4",{staticClass:"ffz-monospace"},[s._v(`
				`+s._s(s.title)+`
			`)])]),s._v(" "),s.adding?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button",on:{click:s.save}},[e("span",{staticClass:"tw-button__text"},[s._v(`
					`+s._s(s.t("setting.add","Add"))+`
				`)])])]):s.editing?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.save}},[e("span",{staticClass:"tw-button__text ffz-i-floppy"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.save","Save"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.cancel}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]):s.deleting?e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){return s.$emit("remove",s.reason)}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.cancel","Cancel"))+`
				`)])])]):e("div",{staticClass:"tw-flex-shrink-0"},[e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.edit}},[e("span",{staticClass:"tw-button__text ffz-i-cog"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.edit","Edit"))+`
				`)])]),s._v(" "),e("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.deleting=!0}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
					`+s._s(s.t("setting.delete","Delete"))+`
				`)])])])])])},"render"),y=[],_=f(46949);let E=0;const b={props:{reason:Object,adding:{type:Boolean,default:!1}},data(){return this.adding?{editor_id:E++,deleting:!1,editing:!0,edit_data:(0,_.deep_copy)(this.reason)}:{editor_id:E++,deleting:!1,editing:!1,edit_data:null}},computed:{display(){return this.editing?this.edit_data:this.reason},title(){return typeof this.display.i18n=="string"?this.t(this.display.i18n,this.display.text):this.display.text}},methods:{edit(){this.editing=!0,this.edit_data=(0,_.deep_copy)(this.reason)},toggleRemove(){this.editing&&(this.edit_data.remove=!this.edit_data.remove)},cancel(){this.adding?this.edit_data=(0,_.deep_copy)(this.reason):(this.editing=!1,this.edit_data=null)},save(){this.$emit("save",this.edit_data),this.cancel()}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},27542:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return n.feed?i("div",n._l(n.feed,function(e,o){return i("chat-rich",{key:o,staticClass:"tw-mg-b-1",attrs:{data:e}})}),1):n._e()},"render"),y=[],_=f(46949);const A={components:{"chat-rich":async()=>(await f.e(2348).then(f.bind(f,18249))).default("./chat-rich.vue").default},props:["context","url"],data(){return{loading:!1,error:null,feed:null}},created(){this.loadFromURL()},methods:{async loadFromURL(){if(this.loading)return;this.loading=!0,this.error=null,this.feed=null;const n=this.context.getFFZ().resolve("chat"),s=this.url;if(!s){this.loading=!1,this.error=null,this.feed=[];return}let i;try{i=await n.get_link_info(s,!1,!1)}catch(e){this.loading=!1,this.error=e;return}if(!i?.v){this.error="Invalid response.",this.loading=!1;return}i.feed||(i={feed:[i]}),this.feed=i.feed.map(e=>(e.allow_media=!0,e.allow_unsafe=!1,{getData:()=>e})),this.loading=!1}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},68286:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--checkbox",class:{inherits:n.isInherited,default:n.isDefault}},[i("div",{staticClass:"tw-flex tw-align-items-center ffz-checkbox"},[i("input",{ref:"control",staticClass:"ffz-checkbox__input",attrs:{id:n.item.full_key,disabled:n.isReadOnly,type:"checkbox"},domProps:{checked:n.value},on:{change:n.onChange}}),n._v(" "),i("label",{staticClass:"ffz-checkbox__label",attrs:{for:n.item.full_key}},[i("span",{staticClass:"tw-mg-l-1"},[n._v(`
				`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
				`),n.unseen?i("span",{staticClass:"ffz-pill ffz-pill--success"},[n._v(n._s(n.t("setting.new","New")))]):n._e()])]),n._v(" "),n.item.buttons?i(n.item.buttons,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}}):n._e(),n._v(" "),n.source&&n.source!==n.profile?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text",on:{click:function(e){n.context.currentProfile=n.source}}},[i("span",{staticClass:"tw-button__text ffz-i-right-dir"},[n._v(`
				`+n._s(n.sourceDisplay)+`
			`)])]):n._e(),n._v(" "),i("div",{staticClass:"ffz--reset-button"},[n.has_value?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":n.isReadOnly},attrs:{disabled:n.isReadOnly},on:{click:n.clear}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
					`+n._s(n.t("setting.reset","Reset to Default"))+`
				`)])]):n._e()])],1),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2",staticStyle:{"padding-left":"2.5rem"}},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra?i("section",{staticStyle:{"padding-left":"2.5rem"}},[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item}})],1):n._e()])},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"],watch:{value(){this.$refs.control&&(this.$refs.control.indeterminate=this.value==null)}},mounted(){this.$refs.control&&(this.$refs.control.indeterminate=this.value==null)},methods:{onChange(){this.set(this.$refs.control.checked)}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},58197:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--widget ffz--color-box",class:{inherits:s.isInherited,default:s.isDefault}},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:s.item.full_key}},[s._v(`
			`+s._s(s.item.i18n_key?s.t(s.item.i18n_key,s.item.title):s.item.title)+`
			`),s.unseen?e("span",{staticClass:"ffz-pill ffz-pill--success"},[s._v(s._s(s.t("setting.new","New")))]):s._e()]),s._v(" "),e("color-picker",{ref:"control",staticClass:"tw-mg-05",attrs:{id:s.item.full_key,disabled:s.isReadOnly,alpha:s.alpha,"open-up":s.openUp,nullable:!0,value:s.color},on:{input:s.onInput}}),s._v(" "),s.item.buttons?e(s.item.buttons,{tag:"component",attrs:{context:s.context,item:s.item,value:s.value}}):s._e(),s._v(" "),s.source&&s.source!==s.profile?e("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text",on:{click:function(o){s.context.currentProfile=s.source}}},[e("span",{staticClass:"tw-button__text ffz-i-right-dir"},[s._v(`
				`+s._s(s.sourceDisplay)+`
			`)])]):s._e(),s._v(" "),s.has_value?e("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":s.isReadOnly},attrs:{disabled:s.isReadOnly},on:{click:s.clear}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.reset","Reset to Default"))+`
			`)])]):s._e()],1),s._v(" "),s.item.description?e("section",{staticClass:"tw-c-text-alt-2"},[e("markdown",{attrs:{source:s.t(s.item.desc_i18n_key||s.item.i18n_key+".description",s.item.description)}})],1):s._e(),s._v(" "),s.item.extra?e("section",[e(s.item.extra.component,{tag:"component",attrs:{context:s.context,item:s.item}})],1):s._e()])},"render"),y=[],_=f(46949),E=f(54643);const b={mixins:[E.Z],props:["item","context"],computed:{color(){return this.value?this.value:""},openUp(){return this.item.openUp!=null?this.item.openUp:!1},alpha(){return this.item.alpha!=null?this.item.alpha:!0}},created(){this.onInput=(0,_.debounce)(this.onInput,100)},methods:{onInput(s){this.set(s||"")}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},71762:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--select-box",class:{inherits:n.isInherited,default:n.isDefault}},[i("div",{staticClass:"tw-flex tw-align-items-start"},[i("label",{staticClass:"tw-mg-y-05",attrs:{for:n.item.full_key}},[n._v(`
			`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
			`),n.unseen?i("span",{staticClass:"ffz-pill ffz-pill--success"},[n._v(n._s(n.t("setting.new","New")))]):n._e()]),n._v(" "),i("div",{staticClass:"tw-flex tw-flex-column tw-mg-05"},[i("select",{ref:"control",staticClass:"tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05",attrs:{id:n.item.full_key,disabled:n.isReadOnly},on:{change:n.onChange}},[n._l(n.nested_data,function(e){return[e.entries?i("optgroup",{key:e.key,attrs:{disabled:e.disabled,label:e.i18n_key?n.t(e.i18n_key,e.title,e):e.title}},n._l(e.entries,function(o){return i("option",{key:o.value,domProps:{selected:o.value===n.value,value:o.v}},[n._v(`
							`+n._s(o.i18n_key?n.t(o.i18n_key,o.title,o):o.title)+`
						`)])}),0):i("option",{key:e.value,domProps:{selected:e.value===n.value,value:e.v}},[n._v(`
						`+n._s(e.i18n_key?n.t(e.i18n_key,e.title,e):e.title)+`
					`)])]}),n._v(" "),i("option",{domProps:{selected:n.isCustom}},[n._v(`
					`+n._s(n.t("setting.combo-box.custom","Custom"))+`
				`)])],2),n._v(" "),i("input",{ref:"text",staticClass:"ffz-mg-t-1p tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{disabled:n.isReadOnly||!n.isCustom},domProps:{value:n.value},on:{change:n.onTextChange}})]),n._v(" "),n.item.buttons?i(n.item.buttons,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}}):n._e(),n._v(" "),n.source&&n.source!==n.profile?i("button",{staticClass:"tw-mg-l-05 tw-mg-y-05 tw-button tw-button--text",on:{click:function(e){n.context.currentProfile=n.source}}},[i("span",{staticClass:"tw-button__text ffz-i-right-dir"},[n._v(`
				`+n._s(n.sourceDisplay)+`
			`)])]):n._e(),n._v(" "),n.has_value?i("button",{staticClass:"tw-mg-l-05 tw-mg-y-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":n.isReadOnly},attrs:{disabled:n.isReadOnly},on:{click:n.clear}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
				`+n._s(n.t("setting.reset","Reset to Default"))+`
			`)])]):n._e()],1),n._v(" "),n.item.extra&&n.item.extra.component&&n.item.extra.before?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}})],1):n._e(),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2"},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra&&n.item.extra.component&&!n.item.extra.before?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}})],1):n._e()])},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"],data(){return{isCustom:!1}},computed:{nested_data(){const n=[];let s=null,i=0;for(const e of this.data)e.separator?(s={key:e.key??i,entries:[],i18n_key:e.i18n_key,title:e.title,disabled:e.disabled},n.push(s)):s!=null?s.entries.push(Object.assign({v:i},e)):n.push(Object.assign({v:i},e)),i++;return n}},watch:{value(n){for(const s of this.data)if(s.value===n)return;this.isCustom=!0},has_value(){this.has_value||(this.isCustom=!1)}},methods:{onChange(){const n=this.$refs.control.value,s=this.data[n];s?(this.set(s.value),this.isCustom=!1):this.isCustom=!0},onTextChange(){const n=this.$refs.text.value;n!=null&&this.set(n)}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},69717:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("div",{staticClass:"ffz--widget ffz--filter-editor tw-border-t tw-pd-y-1"},[s.source&&s.source!==s.profile?e("div",{staticClass:"tw-c-background-accent tw-c-text-overlay tw-pd-1 tw-mg-b-1"},[e("span",{staticClass:"ffz-i-info"}),s._v(`
		`+s._s(s.t("setting.warn-inheritence","These values are being overridden by another profile and may not take effect."))+`
	`)]):s._e(),s._v(" "),e("div",{staticClass:"tw-flex tw-align-items-center tw-pd-b-05"},[e("div",{staticClass:"tw-flex-grow-1"},[s._v(`
			`+s._s(s.t("setting.filter.drag","Drag entries to re-order them."))+`
		`)]),s._v(" "),!s.maybe_clear&&s.rules.length?e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.maybe_clear=!0}}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
				`+s._s(s.t("setting.delete-all","Delete All"))+`
			`)]),s._v(" "),e("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.filter.delete-all","Delete all of this profile's entries."))+`
			`)])]):s._e(),s._v(" "),s.maybe_clear?e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.doClear}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
				`+s._s(s.t("setting.delete-all","Delete All"))+`
			`)]),s._v(" "),e("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.filter.delete-all","Delete all of this profile's entries."))+`
			`)])]):s._e(),s._v(" "),s.maybe_clear?e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(o){s.maybe_clear=!1}}},[e("span",{staticClass:"tw-button__text ffz-i-cancel"},[s._v(`
				`+s._s(s.t("setting.cancel","Cancel"))+`
			`)])]):s._e(),s._v(" "),!s.rules.length&&s.has_default?e("button",{staticClass:"tw-mg-l-1 tw-button tw-button--text ffz-il-tooltip__container",on:{click:s.populate}},[e("span",{staticClass:"tw-button__text ffz-i-trash"},[s._v(`
				`+s._s(s.t("setting.filter.add-default","Add Defaults"))+`
			`)]),s._v(" "),e("span",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[s._v(`
				`+s._s(s.t("setting.filter.add-default-tip","Add all of the default values to this profile."))+`
			`)])]):s._e()]),s._v(" "),e("filter-editor",{attrs:{value:s.rules,filters:s.filters,context:s.test_context,preview:s.preview},on:{input:s.onInput}})],1)},"render"),y=[],_=f(46949),E=f(54643);const b={mixins:[E.Z],props:["item","context"],data(){return{filters:this.item.data(),maybe_clear:!1,test_context:this.item.test_context?this.item.test_context():{}}},computed:{has_default(){return this.default_value&&this.default_value.length},preview(){return this.item.preview||!1},rules(){return!this.has_value||!Array.isArray(this.value)?[]:this.value.filter(s=>s?.v).map(s=>s.v)}},methods:{doClear(){this.maybe_clear=!1,this.clear()},populate(){this.set((0,_.deep_copy)(this.default_value))},onInput(s){const i=(0,_.deep_copy)(s).map(e=>({v:e}));i.length==0&&i.push({t:"skip"}),this.set(i)}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},51461:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--hotkey-input",class:{inherits:n.isInherited,default:n.isDefault}},[i("div",{staticClass:"tw-flex tw-align-items-center"},[i("label",{attrs:{for:n.item.full_key}},[n._v(`
			`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
			`),n.unseen?i("span",{staticClass:"ffz-pill ffz-pill--success"},[n._v(n._s(n.t("setting.new","New")))]):n._e()]),n._v(" "),i("key-picker",{ref:"control",staticClass:"tw-mg-05",attrs:{id:n.item.full_key,disabled:n.isReadOnly,value:n.value},on:{input:n.onInput}}),n._v(" "),n.item.buttons?i(n.item.buttons,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}}):n._e(),n._v(" "),n.source&&n.source!==n.profile?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text",on:{click:function(e){n.context.currentProfile=n.source}}},[i("span",{staticClass:"tw-button__text ffz-i-right-dir"},[n._v(`
				`+n._s(n.sourceDisplay)+`
			`)])]):n._e(),n._v(" "),n.has_value?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":n.isReadOnly},attrs:{disabled:n.isReadOnly},on:{click:n.clear}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
				`+n._s(n.t("setting.reset","Reset to Default"))+`
			`)])]):n._e()],1),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2"},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item}})],1):n._e()])},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"],methods:{onInput(n){this.set(n)}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},72945:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz-input"},[i("header",[n._v(`
		`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
		`),n.unseen?i("span",{staticClass:"ffz-pill"},[n._v(n._s(n.t("setting.new","New")))]):n._e()]),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2"},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item}})],1):n._e(),n._v(" "),n._l(n.data,function(e,o){return i("div",{key:o,staticClass:"tw-mg-l-1"},[i("input",{staticClass:"ffz-radio__input",attrs:{id:n.item.full_key+o,name:n.item.full_key,type:"radio"},domProps:{value:e.value}}),n._v(" "),i("label",{staticClass:"tw-pd-y-05 ffz-radio__label",attrs:{for:n.item.full_key+o}},[n._v(`
			`+n._s(n.t(e.i18n_key,e.title,e))+`
		`)])])})],2)},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"]};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},92302:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--select-box",class:{inherits:n.isInherited,default:n.isDefault}},[i("div",{staticClass:"tw-flex tw-align-items-center"},[i("label",{staticClass:"tw-mg-y-05",attrs:{for:n.item.full_key}},[n._v(`
			`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
			`),n.unseen?i("span",{staticClass:"ffz-pill ffz-pill--success"},[n._v(n._s(n.t("setting.new","New")))]):n._e()]),n._v(" "),i("select",{ref:"control",staticClass:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-05",attrs:{id:n.item.full_key,disabled:n.isReadOnly,multiple:n.item.multiple||!1,size:n.item.size||0},on:{change:n.onChange}},[n._l(n.nested_data,function(e){return[e.entries?i("optgroup",{key:e.key,attrs:{disabled:e.disabled,label:e.i18n_key?n.t(e.i18n_key,e.title,e):e.title}},n._l(e.entries,function(o){return i("option",{key:o.value,domProps:{selected:n.item.multiple?Array.isArray(n.value)&&n.value.includes(o.value):o.value===n.value,value:o.v}},[n._v(`
						`+n._s(o.i18n_key?n.t(o.i18n_key,o.title,o):o.title)+`
					`)])}),0):i("option",{key:e.value,domProps:{selected:n.item.multiple?Array.isArray(n.value)&&n.value.includes(e.value):e.value===n.value,value:e.v}},[n._v(`
					`+n._s(e.i18n_key?n.t(e.i18n_key,e.title,e):e.title)+`
				`)])]})],2),n._v(" "),n.item.buttons?i(n.item.buttons,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}}):n._e(),n._v(" "),n.source&&n.source!==n.profile?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text",on:{click:function(e){n.context.currentProfile=n.source}}},[i("span",{staticClass:"tw-button__text ffz-i-right-dir"},[n._v(`
				`+n._s(n.sourceDisplay)+`
			`)])]):n._e(),n._v(" "),n.has_value?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":n.isReadOnly},attrs:{disabled:n.isReadOnly},on:{click:n.clear}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
				`+n._s(n.t("setting.reset","Reset to Default"))+`
			`)])]):n._e()],1),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2"},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item}})],1):n._e()])},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"],computed:{nested_data(){const n=[];let s=null,i=0;for(const e of this.data)e.separator?(s={key:e.key??i,entries:[],i18n_key:e.i18n_key,title:e.title,disabled:e.disabled},n.push(s)):s!=null?s.entries.push(Object.assign({v:i},e)):n.push(Object.assign({v:i},e)),i++;return n}},methods:{onChange(){if(this.item.multiple){const i=this.$refs.control.selectedOptions,e=[];for(let o=0;o<i.length;o++){const a=this.data[i[o].index];a&&e.push(a.value)}this.set(e);return}const n=this.$refs.control.value,s=this.data[n];s&&this.set(s.value)}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},80704:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>b});var N=$(function(v,r){var n=r._c;return n("div",{style:{marginTop:r.props.item.top}})},"render"),y=[],_=f(72934),E={},A=(0,_.Z)(E,N,y,!0,null,null,null);const b=A.exports},54335:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--widget ffz--text-box",class:{inherits:n.isInherited,default:n.isDefault}},[i("div",{staticClass:"tw-flex tw-align-items-center"},[i("label",{attrs:{for:n.item.full_key}},[n._v(`
			`+n._s(n.item.i18n_key?n.t(n.item.i18n_key,n.item.title):n.item.title)+`
			`),n.unseen?i("span",{staticClass:"ffz-pill ffz-pill--success"},[n._v(n._s(n.t("setting.new","New")))]):n._e()]),n._v(" "),i("input",{ref:"control",staticClass:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-05 ffz-input",class:{"ffz-input--error":!n.isValid},attrs:{id:n.item.full_key,type:n.type,placeholder:n.placeholder,disabled:n.isReadOnly},domProps:{value:n.value},on:{change:n.onChange}}),n._v(" "),n.item.buttons?i(n.item.buttons,{tag:"component",attrs:{context:n.context,item:n.item,value:n.value}}):n._e(),n._v(" "),n.source&&n.source!==n.profile?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text",on:{click:function(e){n.context.currentProfile=n.source}}},[i("span",{staticClass:"tw-button__text ffz-i-right-dir"},[n._v(`
				`+n._s(n.sourceDisplay)+`
			`)])]):n._e(),n._v(" "),n.has_value?i("button",{staticClass:"tw-mg-l-05 tw-button tw-button--text ffz-il-tooltip__container",class:{"tw-button--disabled":n.isReadOnly},attrs:{disabled:n.isReadOnly},on:{click:n.clear}},[i("span",{staticClass:"tw-button__text ffz-i-cancel"}),n._v(" "),i("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[n._v(`
				`+n._s(n.t("setting.reset","Reset to Default"))+`
			`)])]):n._e()],1),n._v(" "),n.item.description?i("section",{staticClass:"tw-c-text-alt-2"},[i("markdown",{attrs:{source:n.t(n.item.desc_i18n_key||n.item.i18n_key+".description",n.item.description)}})],1):n._e(),n._v(" "),n.item.extra?i("section",[i(n.item.extra.component,{tag:"component",attrs:{context:n.context,item:n.item}})],1):n._e()])},"render"),y=[],_=f(54643);const A={mixins:[_.Z],props:["item","context"],computed:{type(){return this.item.type||"text"},placeholder(){return this.item.placeholder||this.default_value}},methods:{onChange(){const n=this.$refs.control.value;n!=null&&this.set(n)}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},98042:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("div",{staticClass:"ffz--setting-text",class:n.classes},[n.loading?i("div",{staticClass:"tw-align-center tw-pd-05"},[i("h3",{staticClass:"tw-mg-1 ffz-i-zreknarf loading"})]):i("markdown",{attrs:{source:n.content}})],1)},"render"),y=[],_=f(46949);const A={props:["item","context"],data(){let n=(0,_.maybe_call)(this.item.classes,this,this.item,this.context);n instanceof Promise?(n.then(i=>{this.classes=i}).catch(i=>{console.error("Error loading async classes:",i),this.classes=""}),n=""):n||(n="");const s=(0,_.maybe_call)(this.item.content,this,this.item,this.context);return s instanceof Promise?(s.then(i=>{this.content=i,this.loading=!1}).catch(i=>{console.error("Error loading async content:",i),this.loading=!1,this.content=this.t("setting.error","An error occurred.")}),{loading:!0,content:null,classes:n}):{loading:!1,content:s,classes:n}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},16528:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",[e.page?e._e():a("div",{staticClass:"tw-flex tw-flex-wrap"},e._l(e.info_blocks,function(c){return a("div",{key:c.key,staticClass:"tw-flex tw-flex-column tw-justify-content-center tw-pd-x-1 tw-pd-y-05 tw-c-background-base tw-border-radius-large tw-mg-r-1 tw-mg-b-1"},[a("p",{staticClass:"tw-c-text-base tw-font-size-4"},[e._v(`
				`+e._s(e.get(c.key,c.format))+`
			`)]),e._v(" "),a("p",{staticClass:"tw-c-text-alt-2 tw-font-size-6"},[e._v(`
				`+e._s(c.i18n_key?e.t(c.i18n_key,c.title):c.title)+`
			`)])])}),0),e._v(" "),e.page?e._e():a("div",{staticClass:"tw-border-t tw-pd-t-1 tw-flex tw-flex-wrap"},e._l(e.stat_blocks,function(c){return a("div",{key:c.key,staticClass:"tw-flex tw-flex-column tw-justify-content-center tw-pd-x-1 tw-pd-y-05 tw-c-background-base tw-border-radius-large tw-mg-r-1 tw-mg-b-1",class:c.click?"ffz--cursor":"",on:{click:function(d){return e.onClick(c,d)}}},[a("p",{staticClass:"tw-c-text-base tw-font-size-4"},[e._v(`
				`+e._s(e.get(c.key,c.format))+`
			`)]),e._v(" "),a("p",{staticClass:"tw-c-text-alt-2 tw-font-size-6"},[e._v(`
				`+e._s(c.i18n_key?e.t(c.i18n_key,c.title):c.title)+`
			`)])])}),0),e._v(" "),e.page?a("button",{staticClass:"tw-mg-b-1 tw-button tw-button--text",on:{click:function(c){e.page=null}}},[a("span",{staticClass:"tw-button__text"},[e._v(`
			`+e._s(e.t("settings.back","Back"))+`
		`)])]):e._e(),e._v(" "),e.page=="versions"?a("div",[a("table",[a("thead",{staticClass:"tw-border-b tw-pd-b-05 tw-mg-b-05 tw-strong"},[a("th",{staticClass:"tw-pd-r-1"},[e._v(e._s(e.t("socket.info.version","Version")))]),e._v(" "),a("th",[e._v(e._s(e.t("socket.info.count","Count")))])]),e._v(" "),a("tbody",e._l(e.version_list,function(c){return a("tr",{key:c[0]},[a("td",{staticClass:"tw-pd-r-1"},[e._v(e._s(c[0]))]),e._v(" "),a("td",[e._v(e._s(e.tNumber(c[1])))])])}),0)])]):e._e(),e._v(" "),e.page=="commands"?a("div",[a("table",[a("thead",{staticClass:"tw-border-b tw-pd-b-05 tw-mg-b-05 tw-strong"},[a("th",{staticClass:"tw-pd-r-1"},[e._v(e._s(e.t("socket.info.command","Command")))]),e._v(" "),a("th",[e._v(e._s(e.t("socket.info.count","Count")))])]),e._v(" "),a("tbody",e._l(e.command_list,function(c){return a("tr",{key:c[0]},[a("td",{staticClass:"tw-pd-r-1"},[e._v(e._s(c[0]))]),e._v(" "),a("td",[e._v(e._s(e.tNumber(c[1])))])])}),0)])]):e._e()])},"render"),y=[],_=f(46949);const E=[{key:"state",title:"State"},{key:"server",title:"Server"},{key:"stats.authenticated",title:"Authenticated"},{key:"topics",title:"Topics"},{key:"ping",title:"Ping",format(e){return e==null?null:`${Math.round(e)} ms`}},{key:"time_offset",title:"Time Offset",format(e){return e==null?null:`${Math.round(e)} ms`}},{key:"local_time",title:"Local Time",format(e){return e==null?null:e.toISOString()}},{key:"server_time",title:"Server Time",format(e){return e==null?null:e.toISOString()}}];function A(e){return e==null?null:this.tNumber(e)}$(A,"formatNumber");const b=[{key:"stats.connected_clients",title:"Connected Clients",format:A},{key:"stats.live_clients",title:"Live Clients",format:A},{key:"stats.total_commands",title:"Commands",click(){this.page="commands"},format:A},{key:"stats.total_messages",title:"Messages",format:A},{key:"stats.versions",title:"Client Versions",click(){this.page="versions"},format(e){return e==null?null:Object.keys(e).length}}],r={props:["item","context"],data(){return{connected:!1,connecting:!1,server:null,ping:null,local_time:new Date,time_offset:null,stats:null,topics:null,page:null}},computed:{info_blocks(){const e=[];for(const o of E){const a=Object.assign({},o);a.i18n_key||(a.i18n_key=`socket.info.${a.key}`),e.push(a)}return e},stat_blocks(){const e=[];for(const o of b){const a=Object.assign({},o);a.i18n_key||(a.i18n_key=`socket.info.${a.key}`),e.push(a)}return e},version_list(){if(!this.stats?.versions)return[];const e=Object.entries(this.stats.versions);return e.sort((o,a)=>a[1]-o[1]),e},command_list(){if(!this.stats?.commands)return[];const e=Object.entries(this.stats.commands);return e.sort((o,a)=>a[1]-o[1]),e},state(){return this.connected?this.t("socket.info.connected","connected"):this.connecting?this.t("socket.info.connecting","connecting"):this.t("socket.info.disconnected","disconnected")},server_time(){return this.time_offset==null||this.local_time==null?null:new Date(this.local_time.getTime()-this.time_offset)}},created(){this.time_interval=setInterval(this.updateTime.bind(this),1e3),this.info_interval=setInterval(this.updateInfo.bind(this),5e3),this.updateInfo(),this.update();const e=this.item.getSocket();e.on(":pong",this.update,this),e.on(":sub-change",this.update,this),e.on(":connected",this.update,this),e.on(":closed",this.update,this),e.on(":disconnected",this.update,this)},destroyed(){clearInterval(this.time_interval),clearInterval(this.info_interval),this.time_interval=null,this.info_interval=null;const e=this.item.getSocket();e.off(":pong",this.update,this),e.off(":sub-change",this.update,this),e.off(":connected",this.update,this),e.off(":closed",this.update,this),e.off(":disconnected",this.update,this)},methods:{onClick(e,o){e.click&&e.click.call(this,o)},get(e,o){let a=(0,_.get)(e,this);return o&&(a=o.call(this,a)),a??"---"},updateTime(){this.item.getSocket().ping(!0),this.local_time=new Date},async updateInfo(){if(this.updating_info)return;this.updating_info=!0;const e=this.item.getSocket();this.stats=e.connected?await e.call("get_server_status"):null,this.updating_info=!1},update(){const e=this.item.getSocket();this.connected=e.connected,this.connecting=e.connecting,this.server=e._host,this.ping=this.connected?e._last_ping:null,this.time_offset=this.connected?e._time_drift:null,this.topics=e.topics?.length??0}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},85910:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--tag-list"},[o("div",{staticClass:"tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[o("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[o("autocomplete",{staticClass:"tw-flex-grow-1",attrs:{"input-id":"tag$"+i.id,items:i.fetchTags,"suggest-on-focus":!0,"escape-to-clear":!1},scopedSlots:i._u([{key:"default",fn:function(a){}}]),model:{value:i.adding,callback:function(a){i.adding=a},expression:"adding"}})],1),i._v(" "),o("div",{staticClass:"tw-flex-shrink-0"},[o("button",{staticClass:"tw-button",on:{click:i.add}},[o("span",{staticClass:"tw-button__text"},[i._v(`
					`+i._s(i.t("setting.terms.add-term","Add"))+`
				`)])])])]),i._v(" "),!i.value||!i.value.length?o("div",{staticClass:"tw-mg-t-05 tw-c-text-alt-2 tw-font-size-4 tw-align-center tw-c-text-alt-2 tw-pd-05"},[i._v(`
		`+i._s(i.t("setting.no-items","no items"))+`
	`)]):o("ul",{staticClass:"ffz--term-list tw-mg-t-05"},i._l(i.value,function(a){return o("li",{key:a,staticClass:"ffz--term ffz--game-term tw-align-items-center tw-flex tw-flex-nowrap tw-flex-row tw-full-width"},[o("div",{staticClass:"tw-flex-grow-1 tw-mg-r-05"},[i.can_link?o("a",{staticClass:"ffz-link",attrs:{href:"/directory/all/tags/"+a},on:{click:function(c){return c.preventDefault(),i.handleLink(a)}}},[i._v(`
					`+i._s(a)+`
				`)]):o("span",[i._v(`
					`+i._s(a)+`
				`)])]),i._v(" "),o("div",{staticClass:"tw-flex-shrink-0"},[o("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){return i.remove(a)}}},[o("span",{staticClass:"tw-button__text ffz-i-trash"}),i._v(" "),o("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[i._v(`
						`+i._s(i.t("setting.delete","Delete"))+`
					`)])])])])}),0)])},"render"),y=[],_=f(54643),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){return{id:A++,adding:"",can_link:!1}},created(){const i=this.context.getFFZ();this.loader=i.resolve("site.twitch_data"),this.router=i.resolve("site.router"),this.can_link=!1;//! ffz.resolve('main_menu').exclusive;
},methods:{add(){if(!this.adding?.length)return;const i=this.adding.toLowerCase(),e=Array.from(this.value);e.includes(i)||(e.push(i),this.set(e))},remove(i){const e=Array.from(this.value),o=e.indexOf(i);o!==-1&&(e.length===1?this.clear():(e.splice(o,1),this.set(e)))},handleLink(i){},async fetchTags(i){if(!this.loader)return[];const e=await this.loader.getMatchingTags(i);return Array.isArray(e)?e.map(o=>({name:o})):[]}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},11879:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ffz--term"},[a("div",{staticClass:"tw-align-items-center tw-flex tw-flex-wrap tw-flex-row tw-full-width"},[e.is_valid?e._e():a("div",{staticClass:"tw-relative ffz-il-tooltip__container tw-mg-r-05"},[a("figure",{staticClass:"tw-c-text-error ffz-i-attention"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
				`+e._s(e.t("setting.terms.warn-invalid","This highlight term is invalid."))+`
			`)])]),e._v(" "),e.is_safe?e._e():a("div",{staticClass:"tw-relative ffz-il-tooltip__container tw-mg-r-05"},[a("figure",{staticClass:"tw-c-text-hint ffz-i-attention"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
				`+e._s(e.t("setting.terms.warn-complex","This highlight term is potentially too complex. It may cause client lag."))+`
			`)])]),e._v(" "),a("div",{staticClass:"tw-flex-grow-1"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.v,expression:"edit_data.v"}],staticClass:"tw-block tw-full-width tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-x-1 tw-pd-y-05",attrs:{placeholder:e.adding?e.t("setting.terms.add-placeholder","Add a new term"):e.edit_data.v,type:"text",autocapitalize:"off",autocorrect:"off"},domProps:{value:e.edit_data.v},on:{input:function(c){c.target.composing||e.$set(e.edit_data,"v",c.target.value)}}}):a("h4",{staticClass:"ffz-monospace"},[a("pre",[e._v(e._s(e.term.v))])])]),e._v(" "),a("div",{staticClass:"tw-flex-shrink-0 tw-mg-x-05"},[e.editing?a("select",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.t,expression:"edit_data.t"}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 ffz-min-width-unset",on:{change:function(c){var d=Array.prototype.filter.call(c.target.options,function(m){return m.selected}).map(function(m){var w="_value"in m?m._value:m.value;return w});e.$set(e.edit_data,"t",c.target.multiple?d:d[0])}}},[a("option",{attrs:{value:"text"}},[e._v(`
					`+e._s(e.t("setting.terms.type.text","Text"))+`
				`)]),e._v(" "),a("option",{attrs:{value:"glob"}},[e._v(`
					`+e._s(e.t("setting.terms.type.glob","Glob"))+`
				`)]),e._v(" "),a("option",{attrs:{value:"raw"}},[e._v(`
					`+e._s(e.t("setting.terms.type.regex","Regex"))+`
				`)])]):a("span",[e._v(e._s(e.term_type))])]),e._v(" "),e.colored?a("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05"},[e.editing?a("color-picker",{attrs:{nullable:!0,"show-input":!1,tooltip:e.t("settings.term.color.tip","Color")},model:{value:e.edit_data.c,callback:function(c){e.$set(e.edit_data,"c",c)},expression:"edit_data.c"}}):e.term.c?a("div",{staticClass:"ffz-color-preview tw-relative ffz-il-tooltip__container"},[a("figure",{style:"background-color: "+e.term.c},[e._v(`
					\xA0
				`)]),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("settings.term.color.tip","Color"))+`
				`)])]):e._e()],1):e._e(),e._v(" "),e.priority?a("div",{staticClass:"tw-flex-shrink-0 tw-relative ffz-il-tooltip__container",class:e.editing?"tw-mg-r-05":"tw-mg-x-05"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.edit_data.p,expression:"edit_data.p",modifiers:{number:!0}}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-min-width-unset ffz-input tw-pd-x-1 tw-pd-y-05",staticStyle:{width:"5rem"},attrs:{type:"number",step:"1"},domProps:{value:e.edit_data.p},on:{input:function(c){c.target.composing||e.$set(e.edit_data,"p",e._n(c.target.value))},blur:function(c){return e.$forceUpdate()}}}):a("span",[e._v(e._s(e.term.p))]),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("settings.terms.priority.tip","Priority"))+`
			`)])]):e._e(),e._v(" "),e.editing||e.display.s?a("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05 tw-mg-y-05 tw-flex tw-align-items-center ffz-checkbox tw-relative ffz-il-tooltip__container"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.s,expression:"edit_data.s"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"sensitive$"+e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.edit_data.s)?e._i(e.edit_data.s,null)>-1:e.edit_data.s},on:{change:function(c){var d=e.edit_data.s,m=c.target,w=!!m.checked;if(Array.isArray(d)){var h=null,p=e._i(d,h);m.checked?p<0&&e.$set(e.edit_data,"s",d.concat([h])):p>-1&&e.$set(e.edit_data,"s",d.slice(0,p).concat(d.slice(p+1)))}else e.$set(e.edit_data,"s",w)}}}):e._e(),e._v(" "),e.editing?a("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label",attrs:{for:"sensitive$"+e.id}},[a("span",{staticClass:"tw-mg-l-05"},[e._v(`
					`+e._s(e.t("settings.terms.sensitive","Aa"))+`
				`)])]):e.display.s?a("div",{staticClass:"tw-relative ffz-il-tooltip__container"},[a("span",{staticClass:"tw-mg-l-05"},[e._v(`
					`+e._s(e.t("settings.terms.sensitive","Aa"))+`
				`)])]):e._e(),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("settings.terms.sensitive.tip","Case Sensitive"))+`
			`)])]):e._e(),e._v(" "),e.words&&(e.editing||e.display.w)?a("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05 tw-mg-y-05 tw-flex tw-align-items-center ffz-checkbox tw-relative ffz-il-tooltip__container"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.w,expression:"edit_data.w"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"word$"+e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.edit_data.w)?e._i(e.edit_data.w,null)>-1:e.edit_data.w},on:{change:function(c){var d=e.edit_data.w,m=c.target,w=!!m.checked;if(Array.isArray(d)){var h=null,p=e._i(d,h);m.checked?p<0&&e.$set(e.edit_data,"w",d.concat([h])):p>-1&&e.$set(e.edit_data,"w",d.slice(0,p).concat(d.slice(p+1)))}else e.$set(e.edit_data,"w",w)}}}):e._e(),e._v(" "),e.editing?a("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label",attrs:{for:"word$"+e.id}},[a("span",{staticClass:"tw-mg-l-05 ffz--whole-word"},[e._v(`
					`+e._s(e.t("settings.terms.word","Abc"))+`
				`)])]):e.display.w?a("div",{staticClass:"tw-relative ffz-il-tooltip__container"},[a("span",{staticClass:"tw-mg-l-05 ffz--whole-word"},[e._v(`
					`+e._s(e.t("settings.terms.word","Abc"))+`
				`)])]):e._e(),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("settings.terms.word.tip","Match Whole Words"))+`
			`)])]):e._e(),e._v(" "),e.highlight&&(e.editing||e.display.h)?a("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05 tw-mg-y-05 tw-flex tw-align-items-center ffz-checkbox tw-relative ffz-il-tooltip__container"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.h,expression:"edit_data.h"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"highlight$"+e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.edit_data.h)?e._i(e.edit_data.h,null)>-1:e.edit_data.h},on:{change:function(c){var d=e.edit_data.h,m=c.target,w=!!m.checked;if(Array.isArray(d)){var h=null,p=e._i(d,h);m.checked?p<0&&e.$set(e.edit_data,"h",d.concat([h])):p>-1&&e.$set(e.edit_data,"h",d.slice(0,p).concat(d.slice(p+1)))}else e.$set(e.edit_data,"h",w)}}}):e._e(),e._v(" "),e.editing?a("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label",attrs:{for:"highlight$"+e.id}},[a("span",{staticClass:"tw-mg-l-05 ffz--highlight"},[e._v(`
					`+e._s(e.t("settings.terms.highlight","Hlt"))+`
				`)])]):e.display.h?a("div",{staticClass:"tw-relative ffz-il-tooltip__container"},[a("span",{staticClass:"tw-mg-l-05 ffz--highlight"},[e._v(`
					`+e._s(e.t("settings.terms.highlight","Hlt"))+`
				`)])]):e._e(),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[a("markdown",{attrs:{source:e.t("settings.terms.highlight.tip",`Highlight Matches

This requires the 'Highlight matched words in chat.' setting to work.`)}})],1)]):e._e(),e._v(" "),e.removable&&(e.editing||e.display.remove)?a("div",{staticClass:"tw-flex-shrink-0 tw-mg-r-05 tw-mg-y-05 tw-flex tw-align-items-center ffz-checkbox tw-relative ffz-il-tooltip__container"},[e.editing?a("input",{directives:[{name:"model",rawName:"v-model",value:e.edit_data.remove,expression:"edit_data.remove"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"remove$"+e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.edit_data.remove)?e._i(e.edit_data.remove,null)>-1:e.edit_data.remove},on:{change:function(c){var d=e.edit_data.remove,m=c.target,w=!!m.checked;if(Array.isArray(d)){var h=null,p=e._i(d,h);m.checked?p<0&&e.$set(e.edit_data,"remove",d.concat([h])):p>-1&&e.$set(e.edit_data,"remove",d.slice(0,p).concat(d.slice(p+1)))}else e.$set(e.edit_data,"remove",w)}}}):e._e(),e._v(" "),e.editing?a("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label",attrs:{for:"remove$"+e.id}},[a("span",{staticClass:"tw-mg-l-05 ffz-i-trash"})]):e.term.remove?a("span",{staticClass:"ffz-i-trash tw-pd-x-1"}):e._e(),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
				`+e._s(e.t("setting.terms.remove.on","Remove matching messages from chat."))+`
			`)])]):e._e(),e._v(" "),e.adding?a("div",{staticClass:"tw-flex-shrink-0"},[a("button",{staticClass:"tw-button",on:{click:e.save}},[a("span",{staticClass:"tw-button__text"},[e._v(`
					`+e._s(e.t("setting.terms.add-term","Add"))+`
				`)])])]):e.editing?a("div",{staticClass:"tw-flex-shrink-0"},[a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.save}},[a("span",{staticClass:"tw-button__text ffz-i-floppy"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.save","Save"))+`
				`)])]),e._v(" "),a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.cancel}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.cancel","Cancel"))+`
				`)])])]):e.deleting?a("div",{staticClass:"tw-flex-shrink-0"},[a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){return e.$emit("remove",e.term)}}},[a("span",{staticClass:"tw-button__text ffz-i-trash"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.delete","Delete"))+`
				`)])]),e._v(" "),a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){e.deleting=!1}}},[a("span",{staticClass:"tw-button__text ffz-i-cancel"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.cancel","Cancel"))+`
				`)])])]):a("div",{staticClass:"tw-flex-shrink-0"},[a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:e.edit}},[a("span",{staticClass:"tw-button__text ffz-i-cog"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.edit","Edit"))+`
				`)])]),e._v(" "),a("button",{staticClass:"tw-button tw-button--text ffz-il-tooltip__container",on:{click:function(c){e.deleting=!0}}},[a("span",{staticClass:"tw-button__text ffz-i-trash"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
					`+e._s(e.t("setting.delete","Delete"))+`
				`)])])])])])},"render"),y=[],_=f(28820),E=f.n(_),A=f(46949);let b=0;const r={props:{term:Object,highlight:{type:Boolean,default:!1},priority:{type:Boolean,default:!1},words:{type:Boolean,default:!0},colored:{type:Boolean,default:!1},removable:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},data(){const e=`term$${b++}`;return this.adding?{id:e,deleting:!1,editing:!0,edit_data:(0,A.deep_copy)(this.term)}:{id:e,deleting:!1,editing:!1,edit_data:null}},computed:{display(){return this.editing?this.edit_data:this.term},is_valid(){const e=this.display,o=e.t;let a=e.v;o==="text"?a=(0,A.escape_regex)(a):o==="glob"&&(a=(0,A.glob_to_regex)(a));try{return new RegExp(a),!0}catch{return!1}},is_safe(){const e=this.display,o=e.t;let a=e.v;return o==="text"?a=(0,A.escape_regex)(a):o==="glob"&&(a=(0,A.glob_to_regex)(a)),E()(a)},term_type(){const e=this.term&&this.term.t;return e==="text"?this.t("setting.terms.type.text","Text"):e==="raw"?this.t("setting.terms.type.raw","Regex"):e==="glob"?this.t("setting.terms.type.glob","Glob"):e==="regex"?this.t("setting.terms.type.regex-word","Regex (Word)"):this.t("setting.unknown","Unknown Value")}},methods:{edit(){this.editing=!0,this.edit_data=Object.assign({remove:!1},(0,A.deep_copy)(this.term))},toggleRemove(){this.editing&&(this.edit_data.remove=!this.edit_data.remove)},cancel(){this.adding?this.edit_data=(0,A.deep_copy)(this.term):(this.editing=!1,this.edit_data=null)},save(){this.priority&&this.edit_data.p&&(typeof this.edit_data.p=="number"?this.edit_data.p=Math.floor(this.edit_data.p):this.edit_data.p=0),this.$emit("save",this.edit_data),this.cancel()}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},4416:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>s});var N=$(function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("section",{staticClass:"ffz--widget ffz--service-tos"},[o("h4",[i._v(i._s(i.key))]),i._v(" "),o("markdown",{staticClass:"tw-mg-b-05",attrs:{source:i.linkText}}),i._v(" "),i.hasAccepted?o("div",[i._v(`
		`+i._s(i.t("tooltip.has-accepted","You have accepted the Terms of Service."))+`
	`)]):[o("button",{staticClass:"tw-button tw-mg-b-05",on:{click:i.accept}},[o("span",{staticClass:"tw-button__text"},[i._v(`
				`+i._s(i.acceptText)+`
			`)])]),i._v(" "),i.declined?o("div",[i._v(`
			`+i._s(i.t("tooltip.has-declined-tos","We won't ask you to accept the terms again, but you can still change your mind on this page."))+`
		`)]):o("button",{staticClass:"tw-button tw-button--text tw-block",on:{click:i.reject}},[o("span",{staticClass:"tw-button__text"},[i._v(`
				`+i._s(i.t("tooltip.decline-tos","I do not accept."))+`
			`)])])]],2)},"render"),y=[],_=f(90334),E=f(46949);let A=0;const v={mixins:[_.Z],props:["item","context"],data(){const i=this.item.getChat();return{id:A++,declined:i?i.hasDeclinedTerms(this.item.item):!1,key:this.item.item}},computed:{acceptText(){return this.data.i18n_accept?this.t(this.data.i18n_accept,this.data.accept):this.data.accept?this.data.accept:this.t("tooltip.accept-tos","Yes, I accept the Terms of Service.")},linkText(){return this.data.i18n_links?this.t(this.data.i18n_links,this.data.links):this.data.links},hasAccepted(){return Array.isArray(this.value)&&this.value.includes(this.key)}},methods:{accept(){const i=Array.isArray(this.value)?[...this.value]:[];i.push(this.key),this.set(i)},reject(){if(this.declined)return;const i=this.item.getChat();i&&(this.declined=!0,i.declineTerms(this.key))}}};var r=f(72934),n=(0,r.Z)(v,N,y,!1,null,null,null);const s=n.exports},47178:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("section",{staticClass:"tw-flex-grow-1 tw-align-self-start tw-flex tw-align-items-center"},[i("div",{staticClass:"tw-flex tw-align-items-center ffz-checkbox tw-mg-y-05"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.data,expression:"value.data"}],staticClass:"ffz-checkbox__input",attrs:{id:"enabled$"+n.value.id,type:"checkbox"},domProps:{checked:Array.isArray(n.value.data)?n._i(n.value.data,null)>-1:n.value.data},on:{change:function(e){var o=n.value.data,a=e.target,c=!!a.checked;if(Array.isArray(o)){var d=null,m=n._i(o,d);a.checked?m<0&&n.$set(n.value,"data",o.concat([d])):m>-1&&n.$set(n.value,"data",o.slice(0,m).concat(o.slice(m+1)))}else n.$set(n.value,"data",c)}}}),n._v(" "),i("label",{staticClass:"ffz-checkbox__label",attrs:{for:"enabled$"+n.value.id}},[i("span",{staticClass:"tw-mg-l-1"},[n._v(`
				`+n._s(n.t(n.type.i18n,n.type.title))+`
			`)])])])])},"render"),y=[];let _=0;const A={props:["value","type","filters","context"],data(){return{id:_++}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},94344:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"category$"+s.id}},[s._v(`
			`+s._s(s.t(s.type.i18n,s.type.title))+`
		`)]),s._v(" "),e("div",{staticClass:"ffz--search-avatar tw-mg-x-05 ffz-card-img--size-2"},[e("aspect",{attrs:{ratio:1/1.33}},[s.current?e("img",{staticClass:"ffz-avatar__img tw-image",attrs:{alt:s.current.displayName||s.current.name,src:s.current.boxArtURL}}):s._e()])],1),s._v(" "),e("autocomplete",{staticClass:"tw-flex-grow-1",attrs:{"input-id":"category$"+s.id,items:s.fetchCategories,value:s.search,"suggest-on-focus":!0,"escape-to-clear":!1},on:{selected:s.onSelected},scopedSlots:s._u([{key:"default",fn:function(o){return[e("autocomplete-game",{attrs:{game:o.item}})]}}])})],1)])},"render"),y=[],_=f(46949);let E=0;const b={props:["value","type","filters","context"],data(){return{id:E++,current:null,loaded_id:null}},computed:{search(){return this.current&&this.current.displayName||this.value.data.name}},watch:{value:{handler(){this.cacheCategory()},deep:!0}},created(){const s=FrankerFaceZ.get();this.loader=s.resolve("site.twitch_data"),this.cacheCategory=(0,_.debounce)(this.cacheCategory,50)},beforeDestroy(){this.cacheCategory=null},mounted(){this.cacheCategory()},methods:{async cacheCategory(){if(!this.loader||this.loaded_id===this.value.data.id||(this.current=null,this.loaded_id=this.value.data.id,!this.loaded_id))return;const s=await this.loader.getCategory(this.loaded_id);s?this.current=(0,_.deep_copy)(s):this.current=null},async fetchCategories(s){if(!this.loader)return[];const i=await this.loader.getMatchingCategories(s);return!i||!i.items?[]:(0,_.deep_copy)(i.items)},onSelected(s){this.current=s,this.value.data.name=s?.name||null,this.value.data.id=s?.id||null,this.value.data.boxArtURL=s?.boxArtURL||null}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},69370:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"channel$"+s.id}},[s._v(`
			`+s._s(s.t(s.type.i18n,s.type.title))+`
		`)]),s._v(" "),e("div",{staticClass:"ffz--search-avatar tw-mg-x-05"},[e("figure",{staticClass:"ffz-avatar ffz-avatar--size-30"},[e("div",{staticClass:"tw-border-radius-rounded tw-overflow-hidden"},[s.current?e("img",{staticClass:"ffz-avatar__img tw-image",attrs:{alt:s.current.displayName,src:s.current.profileImageURL}}):s._e()])])]),s._v(" "),e("autocomplete",{staticClass:"tw-flex-grow-1",attrs:{"input-id":"channel$"+s.id,items:s.fetchUsers,value:s.search,"suggest-on-focus":!0,"escape-to-clear":!1},on:{selected:s.onSelected},scopedSlots:s._u([{key:"default",fn:function(o){return[e("autocomplete-user",{attrs:{user:o.item}})]}}])})],1)])},"render"),y=[],_=f(46949);let E=0;const b={props:["value","type","filters","context"],data(){return{id:E++,current:null,loaded_id:null}},computed:{search(){return this.current&&this.current.displayName||this.value.data.login}},watch:{value:{handler(){this.cacheUser()},deep:!0}},created(){const s=FrankerFaceZ.get();this.loader=s.resolve("site.twitch_data"),this.cacheUser=(0,_.debounce)(this.cacheUser,50)},beforeDestroy(){this.cacheUser=null},mounted(){this.cacheUser()},methods:{async cacheUser(){if(!this.loader||this.loaded_id===this.value.data.id||(this.current=null,this.loaded_id=this.value.data.id,!this.loaded_id))return;const s=await this.loader.getUser(this.loaded_id);s?this.current=(0,_.deep_copy)(s):this.current=null},async fetchUsers(s){if(!this.loader)return[];const i=await this.loader.getMatchingUsers(s);return!i||!i.items?[]:(0,_.deep_copy)(i.items)},onSelected(s){this.current=s,this.value.data.login=s&&s.login||null,this.value.data.id=s&&s.id||null}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},17907:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[e("div",[e("header",{staticClass:"tw-mg-y-05"},[s._v(`
			`+s._s(s.t(s.type.i18n,s.type.title))+`
		`)]),s._v(" "),e("filter-editor",{staticClass:"tw-flex-grow-1",attrs:{filters:s.filters,context:s.context,"max-rules":s.type.maxRules},model:{value:s.value.data[0],callback:function(o){s.$set(s.value.data,0,o)},expression:"value.data[0]"}})],1),s._v(" "),e("div",{staticClass:"tw-border-t tw-mg-t-05 tw-pd-t-05"},[e("header",{staticClass:"tw-flex tw-align-items-center"},[e("div",{staticClass:"ffz--profile__icon tw-pd-r-05 tw-pd-y-05 tw-relative ffz-il-tooltip__container"},[e("figure",{class:[s.passes?"ffz-i-ok":"ffz-i-cancel"]}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[s.passes?e("span",[s._v(`
						`+s._s(s.t("setting.filters.if.pass","This branch is active because the condition is true."))+`
					`)]):e("span",[s._v(`
						`+s._s(s.t("setting.filters.if.no_pass","This branch is not active because the condition is false."))+`
					`)])])]),s._v(" "),e("div",{staticClass:"tw-mg-y-05"},[s._v(`
				`+s._s(s.t("setting.filter.if.then","Then"))+`
			`)])]),s._v(" "),e("filter-editor",{staticClass:"tw-flex-grow-1",attrs:{filters:s.filters,context:s.context,"max-rules":s.type.maxRules},model:{value:s.value.data[1],callback:function(o){s.$set(s.value.data,1,o)},expression:"value.data[1]"}})],1),s._v(" "),e("div",{staticClass:"tw-border-t tw-mg-t-05 tw-pd-t-05"},[e("header",{staticClass:"tw-flex tw-align-items-center"},[e("div",{staticClass:"ffz--profile__icon tw-pd-r-05 tw-pd-y-05 tw-relative ffz-il-tooltip__container"},[e("figure",{class:[s.passes?"ffz-i-cancel":"ffz-i-ok"]}),s._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[s.passes?e("span",[s._v(`
						`+s._s(s.t("setting.filters.if.no_fail","This branch is not active because the condition is true."))+`
					`)]):e("span",[s._v(`
						`+s._s(s.t("setting.filters.if.fail","This branch is active because the condition is false."))+`
					`)])])]),s._v(" "),e("div",{staticClass:"tw-mg-y-05"},[s._v(`
				`+s._s(s.t("setting.filter.if.else","Else"))+`
			`)])]),s._v(" "),e("filter-editor",{staticClass:"tw-flex-grow-1",attrs:{filters:s.filters,context:s.context,"max-rules":s.type.maxRules},model:{value:s.value.data[2],callback:function(o){s.$set(s.value.data,2,o)},expression:"value.data[2]"}})],1)])},"render"),y=[],_=f(37087);let E=0;const b={props:["value","type","filters","context"],data(){return{id:E++}},computed:{tester(){return(0,_.createTester)(this.value.data[0],this.filters)},passes(){return this.tester&&this.tester(this.context)}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},57049:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"label$"+s.id}},[s._v(`
			`+s._s(s.t(s.type.i18n,s.type.title))+`
		`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.selected,expression:"selected"}],staticClass:"tw-flex-grow-1 tw-mg-l-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-select",attrs:{id:"label$"+s.id},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.selected=o.target.multiple?a:a[0]}}},[s._l(s.monitors,function(o,a){return[e("option",{domProps:{value:o}},[s._v(`
					`+s._s(a+1)+". "+s._s(o.label)+" ("+s._s(o.width)+"\xD7"+s._s(o.height)+`)
				`)])]})],2)]),s._v(" "),e("div",{staticClass:"tw-c-text-alt-2"},[s._v(`
		`+s._s(s.t("setting.filter.monitor.about","This setting requires that this site has the Window Management permission. Please be sure that it is allowed."))+`
	`)])])},"render"),y=[],_=f(46949);let E=0;const b={props:["value","type","filters","context"],data(){return{id:E++,has_monitors:!0,monitors:[],ready:!1,selected:null}},created(){this.detectMonitors()},watch:{selected(){if(!this.ready||!this.selected)return;const s=this.value.data=this.value.data||{};s.label=this.selected.label,s.index=this.monitors.indexOf(this.selected),s.top=this.selected.top,s.left=this.selected.left,s.width=this.selected.width,s.height=this.selected.height}},methods:{async detectMonitors(){let s;try{s=await window.getScreenDetails()}catch(i){console.error("Unable to get screen details",i),this.has_monitors=!1,this.monitors=[];return}this.monitors=[];for(const i of s.screens)this.monitors.push({top:i.top,left:i.left,label:i.label,width:i.width,height:i.height});this.value.data&&(this.selected=(0,_.matchScreen)(this.monitors,this.value.data)),this.ready=!0,this.selected||(this.selected=this.monitors[0])}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},9786:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[i("header",[n._v(`
		`+n._s(n.t(n.type.i18n,n.type.title))+`
	`)]),n._v(" "),i("filter-editor",{attrs:{filters:n.filters,context:n.context,"max-rules":n.type.maxRules},model:{value:n.value.data,callback:function(e){n.$set(n.value,"data",e)},expression:"value.data"}})],1)},"render"),y=[];let _=0;const A={props:["value","type","filters","context"],data(){return{id:_++}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},38961:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>n});var N=$(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("section",{staticClass:"tw-flex-grow-1 tw-align-self-start"},[e("div",{staticClass:"tw-flex tw-align-items-center"},[e("label",{attrs:{for:"page$"+s.id}},[s._v(`
			`+s._s(s.t(s.type.i18n,s.type.title))+`
		`)]),s._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:s.value.data.route,expression:"value.data.route"}],staticClass:"tw-flex-grow-1 tw-mg-l-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-select",attrs:{id:"page$"+s.id},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,function(c){return c.selected}).map(function(c){var d="_value"in c?c._value:c.value;return d});s.$set(s.value.data,"route",o.target.multiple?a:a[0])}}},s._m(0),0)]),s._v(" "),e("div",{staticClass:"tw-border-t tw-mg-t-05"},[e("div",{staticClass:"tw-pd-y-05"},[e("t-list",{attrs:{phrase:"setting.filter.page.url",default:"URL: {url}"},scopedSlots:s._u([{key:"url",fn:function(){return[e("span",{staticClass:"tw-c-text-alt"},[s._v(s._s(s.url))])]},proxy:!0}])})],1),s._v(" "),s._l(s.parts,function(o){return e("div",{key:o.key,staticClass:"tw-flex tw-align-items-center tw-mg-t-05"},[e("label",{attrs:{for:"page$"+s.id+"$part-"+o.key}},[s._v(`
				`+s._s(s.t(o.i18n,o.title))+`
			`)]),s._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.value.data.values[o.key],expression:"value.data.values[part.key]"}],staticClass:"tw-mg-l-1 tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"page$"+s.id+"$part-"+o.key},domProps:{value:s.value.data.values[o.key]},on:{input:function(a){a.target.composing||s.$set(s.value.data.values,o.key,a.target.value)}}})])})],2)])},"render"),y=[function(){var s=this,i=s.$createElement,e=s._self._c||i;return s._l(s.routes,function(o,a){return e("option",{key:a,domProps:{value:a}},[s._v(`
				`+s._s(s.getName(a))+`
			`)])})}],_=f(46949);let E=0;const b={props:["value","type","filters","context"],data(){return{id:E++,routes:{},route_names:{}}},computed:{route(){return this.routes[this.value.data.route]},url(){if(!this.route)return null;const s={};for(const i of this.parts){const e=this.value.data.values[i.key];s[i.key]=e||`<${i.key}${i.optional?"*":""}>`}try{return decodeURI(new URL(this.route.url(s),this.route.domain?`https://${this.route.domain}`:location))}catch{return"(unable to render url)"}},parts(){const s=[];if(!this.route||!this.route.parts)return s;for(const i of this.route.parts)if(typeof i=="object"){const e=i.name.replace(/([a-z])([A-Z])/g,(o,a,c)=>`${a} ${c}`);s.push({key:i.name,i18n:`settings.filter.page.route.${this.route.name}.${i.name}`,title:e[0].toLocaleUpperCase()+e.substr(1),optional:i.optional})}return s}},watch:{value:{handler(){},deep:!0}},created(){const s=FrankerFaceZ.get(),i=this.router=s&&s.resolve("site.router");this.routes=(0,_.deep_copy)(i.getRoutes()),this.route_names=(0,_.deep_copy)(i.getRouteNames())},methods:{getName(s){const i=`settings.filter.page.route.${s}`,e=this.route_names[s]=this.route_names[s]||s.replace(/(^|-)([a-z])/g,(o,a,c)=>`${a?" ":""}${c.toLocaleUpperCase()}`);return this.t(i,e)}}};var v=f(72934),r=(0,v.Z)(b,N,y,!1,null,null,null);const n=r.exports},64e3:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>r});var N=$(function(){var n=this,s=n.$createElement,i=n._self._c||s;return i("section",{staticClass:"tw-flex-grow-1 tw-align-self-start tw-flex tw-align-items-center"},[i("div",{staticClass:"tw-flex tw-align-items-center"},[i("div",{staticClass:"tw-mg-r-1"},[n._v(`
			`+n._s(n.t(n.type.i18n,n.type.title))+`
		`)]),n._v(" "),i("label",{staticClass:"tw-mg-l-1",attrs:{for:"start-time$"+n.id}},[n._v(`
			`+n._s(n.t("settings.filter.time.start","Start:"))+`
		`)]),n._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.data[0],expression:"value.data[0]"}],staticClass:"ffz-min-width-unset tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-mg-x-1 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"start-time$"+n.id,type:"time"},domProps:{value:n.value.data[0]},on:{input:function(e){e.target.composing||n.$set(n.value.data,0,e.target.value)}}}),n._v(" "),i("label",{staticClass:"tw-mg-l-1",attrs:{for:"end-time$"+n.id}},[n._v(`
			`+n._s(n.t("settings.filter.time.end","End:"))+`
		`)]),n._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:n.value.data[1],expression:"value.data[1]"}],staticClass:"ffz-min-width-unset tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-x-1 ffz-input",attrs:{id:"end-time$"+n.id,type:"time"},domProps:{value:n.value.data[1]},on:{input:function(e){e.target.composing||n.$set(n.value.data,1,e.target.value)}}})])])},"render"),y=[];let _=0;const A={props:["value","type","filters","context"],data(){return{id:_++}}};var b=f(72934),v=(0,b.Z)(A,N,y,!1,null,null,null);const r=v.exports},43922:(q,T,f)=>{"use strict";f.r(T),f.d(T,{default:()=>i});var N=$(function(){var e=this,o=e.$createElement,a=e._self._c||o;return a("section",{staticClass:"tw-flex-grow-1 tw-align-self-start tw-flex tw-align-items-center"},[a("div",{staticClass:"tw-flex tw-flex-grow-1 tw-align-items-center"},[a("div",{staticClass:"tw-mg-r-1"},[e._v(`
			`+e._s(e.t(e.type.i18n,e.type.title))+`
		`)]),e._v(" "),e.is_valid?e.is_safe?e._e():a("div",{staticClass:"tw-relative ffz-il-tooltip__container tw-mg-r-05"},[a("figure",{staticClass:"tw-c-text-error ffz-i-attention"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
				`+e._s(e.t("settings.filter.title.warn-complex","This pattern is potentially too complex. It will be disabled to avoid client lag or freezing."))+`
			`)])]):a("div",{staticClass:"tw-relative ffz-il-tooltip__container tw-mg-r-05"},[a("figure",{staticClass:"tw-c-text-error ffz-i-attention"}),e._v(" "),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-left"},[e._v(`
				`+e._s(e.t("settings.filter.title.warn-invalid","This pattern is invalid."))+`
			`)])]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.value.data.title,expression:"value.data.title"}],staticClass:"tw-flex-grow-1 tw-border-radius-medium tw-font-size-6 tw-mg-x-1 tw-pd-x-1 tw-pd-y-05 ffz-input",attrs:{id:"title$"+e.id,type:"text",autocapitalize:"off",autocorrect:"off"},domProps:{value:e.value.data.title},on:{input:function(c){c.target.composing||e.$set(e.value.data,"title",c.target.value)}}}),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.value.data.mode,expression:"value.data.mode"}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 ffz-min-width-unset",attrs:{id:"mode$"+e.id},on:{change:function(c){var d=Array.prototype.filter.call(c.target.options,function(m){return m.selected}).map(function(m){var w="_value"in m?m._value:m.value;return w});e.$set(e.value.data,"mode",c.target.multiple?d:d[0])}}},[a("option",{attrs:{value:"text"}},[e._v(`
				`+e._s(e.t("setting.terms.type.text","Text"))+`
			`)]),e._v(" "),a("option",{attrs:{value:"glob"}},[e._v(`
				`+e._s(e.t("setting.terms.type.glob","Glob"))+`
			`)]),e._v(" "),a("option",{attrs:{value:"raw"}},[e._v(`
				`+e._s(e.t("setting.terms.type.regex","Regex"))+`
			`)])]),e._v(" "),a("div",{staticClass:"tw-flex tw-align-items-center ffz-checkbox tw-mg-l-1 tw-mg-y-05"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value.data.sensitive,expression:"value.data.sensitive"}],staticClass:"ffz-min-width-unset ffz-checkbox__input",attrs:{id:"sensitive$"+e.id,type:"checkbox"},domProps:{checked:Array.isArray(e.value.data.sensitive)?e._i(e.value.data.sensitive,null)>-1:e.value.data.sensitive},on:{change:function(c){var d=e.value.data.sensitive,m=c.target,w=!!m.checked;if(Array.isArray(d)){var h=null,p=e._i(d,h);m.checked?p<0&&e.$set(e.value.data,"sensitive",d.concat([h])):p>-1&&e.$set(e.value.data,"sensitive",d.slice(0,p).concat(d.slice(p+1)))}else e.$set(e.value.data,"sensitive",w)}}}),e._v(" "),a("label",{staticClass:"ffz-min-width-unset ffz-checkbox__label tw-relative ffz-il-tooltip__container",attrs:{for:"sensitive$"+e.id}},[a("span",{staticClass:"tw-mg-l-05"},[e._v(`
					Aa
					`),a("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[e._v(`
						`+e._s(e.t("settings.filter.title.sensitive","Case Sensitive"))+`
					`)])])])])])])},"render"),y=[],_=f(28820),E=f.n(_),A=f(46949);let b=0;const r={props:["value","type","filters","context"],data(){return{id:b++}},computed:{regex(){const e=this.value.data.mode;let o=this.value.data.title;return e==="text"?o=(0,A.escape_regex)(o):e==="glob"&&(o=(0,A.glob_to_regex)(o)),o},is_valid(){try{return new RegExp(this.regex,`g${this.value.data.sensitive?"":"i"}`),!0}catch{return!1}},is_safe(){return E()(this.regex)}}};var n=f(72934),s=(0,n.Z)(r,N,y,!1,null,null,null);const i=s.exports},72153:(q,T,f)=>{var N={"./action-editor.vue":29444,"./action-preview.vue":99974,"./addon-list.vue":28695,"./addon.vue":64004,"./async-text.vue":64530,"./backup-restore.vue":12145,"./badge-highlighting.vue":25532,"./badge-term-editor.vue":13746,"./badge-visibility.vue":88821,"./basic-terms.vue":22298,"./blocked-type-editor.vue":92417,"./blocked-types.vue":71386,"./changelog.vue":45969,"./chat-actions.vue":76923,"./chat-reasons.vue":63152,"./chat-rich-example.vue":66753,"./chat-tester.vue":2814,"./chat-tooltip-example.vue":10001,"./clear-settings.vue":4654,"./emote-priorities.vue":13748,"./experiments.vue":67706,"./filter-editor.vue":51374,"./filter-rule-editor.vue":49530,"./format-preview.vue":30003,"./game-list-editor.vue":17239,"./graphql-inspect.vue":56845,"./home-page.vue":99851,"./i18n-open.vue":26818,"./link-tester.vue":63667,"./main-menu.vue":8053,"./md-page.vue":83615,"./menu-container.vue":68697,"./menu-page.vue":77253,"./menu-tree.vue":75652,"./performance.vue":66306,"./profile-editor.vue":5762,"./profile-manager.vue":10087,"./profile-selector.vue":58071,"./provider.vue":4184,"./reason-editor.vue":92561,"./rich-feed.vue":27542,"./setting-check-box.vue":68286,"./setting-color-box.vue":58197,"./setting-combo-box.vue":71762,"./setting-filter-editor.vue":69717,"./setting-hotkey.vue":51461,"./setting-radio-buttons.vue":72945,"./setting-select-box.vue":92302,"./setting-spacer.vue":80704,"./setting-text-box.vue":54335,"./setting-text.vue":98042,"./socket-info.vue":16528,"./tag-list-editor.vue":85910,"./term-editor.vue":11879,"./tooltip-tos.vue":4416};function y(E){var A=_(E);return f(A)}$(y,"webpackContext");function _(E){if(!f.o(N,E)){var A=new Error("Cannot find module '"+E+"'");throw A.code="MODULE_NOT_FOUND",A}return N[E]}$(_,"webpackContextResolve"),y.keys=$(function(){return Object.keys(N)},"webpackContextKeys"),y.resolve=_,q.exports=y,y.id=72153},94821:(q,T,f)=>{var N={"./faq.md":[15450,7629],"./feedback.md":[31454,4164],"./home.md":[56539],"./i18n.md":[45974],"./legal.md":[82134,204],"./term-syntax.md":[98658,8163]};function y(_){if(!f.o(N,_))return Promise.resolve().then(()=>{var b=new Error("Cannot find module '"+_+"'");throw b.code="MODULE_NOT_FOUND",b});var E=N[_],A=E[0];return Promise.all(E.slice(1).map(f.e)).then(()=>f.t(A,17))}$(y,"webpackAsyncContext"),y.keys=()=>Object.keys(N),y.id=94821,q.exports=y},41152:(q,T,f)=>{var N={"./bits_button.js":24531,"./bttv_compat.js":11746,"./channel.jsx":74756,"./chat/index.js":6172,"./compat_emote_menu.js":6325,"./css_tweaks/index.js":17103,"./dashboard.js":95778,"./directory/index.jsx":96432,"./layout.js":68318,"./loadable.tsx":34923,"./menu_button.jsx":29333,"./mod-view.jsx":94296,"./player.jsx":63155,"./sub_button.tsx":70052,"./theme/index.js":24020,"./video_chat/index.jsx":4948};function y(E){var A=_(E);return f(A)}$(y,"webpackContext");function _(E){if(!f.o(N,E)){var A=new Error("Cannot find module '"+E+"'");throw A.code="MODULE_NOT_FOUND",A}return N[E]}$(_,"webpackContextResolve"),y.keys=$(function(){return Object.keys(N)},"webpackContextKeys"),y.resolve=_,q.exports=y,y.id=41152},56539:q=>{"use strict";q.exports=`Thank you for using FrankerFaceZ.

Version 4.0 of the extension has been under active development since the release of Twitch's React-powered website in late 2017.`},45974:q=>{"use strict";q.exports=`Interested in helping out with the localization efforts? Please [join our Discord](https://discord.gg/UrAkGhT) and join the chat in the localization channel.

This tool allows translators to test their strings in real-time in the app. That way you can be sure everything looks right before submitting your translations.`}}]);})();

//# sourceMappingURL=main-menu.js.map