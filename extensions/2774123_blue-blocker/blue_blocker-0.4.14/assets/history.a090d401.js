import"./chunk-1ebdbb1b.js";import{U as T,c as m,R as x}from"./chunk-4da8f9f7.js";import{a as w,e as k,d as P,H as S,l as v,f as D,g as I}from"./chunk-70aa1672.js";import{C as H,h as f}from"./chunk-e6f612bb.js";import{B as L}from"./chunk-b39a70df.js";/* empty css              */const o=new L(w.storage.local),p=x();o.getCriticalPoint(p).then(H).then(E=>new Promise((i,r)=>{const t=E.transaction([f],"readonly");t.onabort=t.onerror=r;const c=t.objectStore(f).index("time").getAll();c.onerror=r,c.onsuccess=()=>{const e=c.result;i(e)}}).then(i=>{const r=document.getElementById("block-history");r.innerText="";let t=0;const s={};if(i.reverse().forEach(e=>{var g;s.hasOwnProperty(e.reason)||(s[e.reason]=0);const n=document.createElement("div"),l=T(e.user.name,e.user.screen_name);n.appendChild(l);const u=document.createElement("p"),d=(g=e==null?void 0:e.external_reason)!=null?g:k[e.reason];u.innerText="reason: "+d,n.appendChild(u);const y=document.createElement("p");let a;switch(e.state){case S:a="blocked",t++,s[e.reason]++;break;case P:a="unblocked",t++,s[e.reason]++;break;case D:a="user no longer exists";break;default:a="unreadable state"}y.innerText="current state: "+a,n.appendChild(y);const C=document.createElement("p"),b=new Date(e.time),B=b.toLocaleDateString("en",{year:"numeric",month:"short",day:"numeric"}).replace(`, ${new Date().getFullYear()}`,"")+", "+b.toLocaleTimeString().toLowerCase();C.innerText=a+" on "+B,n.appendChild(C),r.appendChild(n)}),document.getElementsByName("blocked-users-count").forEach(e=>e.innerText=m(t)),o.getCriticalPoint(p).then(()=>o.storage.get({BlockCounter:0})).then(e=>e.BlockCounter).then(e=>{if(t===e)return;const n=document.getElementById("block-counter-current-value");n.innerText=m(e);const l=document.getElementById("reset-counter");l.firstElementChild.addEventListener("click",()=>{const d=x();o.getCriticalPoint(d).then(()=>o.storage.set({BlockCounter:t})).then(()=>{console.log(v,"reset block counter to",t),l.style.display=""}).finally(()=>o.releaseCriticalPoint(d))}),l.style.display="block"}).finally(()=>o.releaseCriticalPoint(p)),i.length===0){r.textContent="your block history is empty";return}const h=document.getElementById("detailed-counts"),c={[I]:"external extension",...k};h.innerText="("+Object.entries(s).map(e=>c[parseInt(e[0])]+": "+m(e[1])).join(", ")+")"}));
