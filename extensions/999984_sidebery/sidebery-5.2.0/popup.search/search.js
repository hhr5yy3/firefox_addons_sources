import{Info,Search,Settings,Styles,Windows,connectTo,registerActions,sendToSidebar,setInstanceType2 as setInstanceType,setWinId2 as setWinId,setupGlobalMessageListener,sidebar}from"../chunk-4KZVVU6Z.js";import"../chunk-FF3JOXTG.js";var el=document.getElementById("textInput");el?.focus();el?.addEventListener("blur",()=>{Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchExit")});var ctxMenuKeyPressed;el?.addEventListener("keydown",e=>{e.code==="KeyA"&&e.ctrlKey&&e.shiftKey?(e.preventDefault(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchSelectAll")):e.key==="ArrowDown"?(e.preventDefault(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchNext")):e.key==="ArrowUp"?(e.preventDefault(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchPrev")):e.key==="Enter"&&!e.altKey?(e.preventDefault(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchEnter")):e.key==="ContextMenu"?(e.preventDefault(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchMenu"),clearTimeout(ctxMenuKeyPressed),ctxMenuKeyPressed=setTimeout(()=>ctxMenuKeyPressed=void 0,500)):Search.shortcuts.bookmarks&&Search.shortcuts.bookmarks.key===e.key&&Search.shortcuts.bookmarks.ctrl===e.ctrlKey&&Search.shortcuts.bookmarks.alt===e.altKey&&Search.shortcuts.bookmarks.meta===e.metaKey?(e.preventDefault(),e.stopPropagation(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchBookmarks")):Search.shortcuts.history&&Search.shortcuts.history.key===e.key&&Search.shortcuts.history.ctrl===e.ctrlKey&&Search.shortcuts.history.alt===e.altKey&&Search.shortcuts.history.meta===e.metaKey&&(e.preventDefault(),e.stopPropagation(),Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchHistory"))});el?.addEventListener("contextmenu",e=>{ctxMenuKeyPressed!==void 0&&e.preventDefault()});el?.addEventListener("input",e=>{Windows.id!==void 0&&sendToSidebar(Windows.id,"onOutsideSearchInput",el.value)});function closePopup(){window.close()}(async()=>{Info.setInstanceType(4),setInstanceType(4),setupGlobalMessageListener(),registerActions({closePopup});let[win]=await Promise.all([browser.windows.getCurrent({populate:!1}),Settings.loadSettings()]);win.id!==void 0&&(setWinId(win.id),Windows.id=win.id,connectTo(2,Windows.id),sidebar(win.id,"getSearchQuery").then(query=>{query&&(el.value=query)})),Styles.initColorScheme()})();
