(()=>{var e={5218:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncQueue=void 0;const n=o(r(1600));class s{constructor(){this._queue=[],this._cv=new n.default,this._consumer=this._createConsumer()}push(e){this._queue.push(e),this._cv.notify()}async pop(){return(await this._consumer.next()).value}async*_createConsumer(){for(;;)await this._cv.wait((()=>this._queue.length>0)),yield this._queue.shift()}}t.AsyncQueue=s,t.default=s},9246:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSignal=void 0;const n=o(r(7638));class s{constructor(){this._slots=new Set}slot(){const e=new n.default((e=>{this._slots.delete(e)}));return this._slots.add(e),e}emit(){const e=Array.from(this._slots);this._slots.clear();for(const t of e)t.cancel()}}t.CancellationSignal=s,t.default=s},7638:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationSlot=void 0;const n=o(r(8643)),s=r(7395);class i{constructor(e){this._disconnect=e??n.default,this.assign(n.default)}get cancelled(){return void 0!==this._reason}assign(e){void 0===this._reason?this._handler=e:e(this._reason)}cancel(){if(void 0!==this._reason)return;const e=this._disconnect,t=this._handler;this._handler=n.default,this._disconnect=n.default,e(this),this._reason=new s.CancelledOperation,t(this._reason)}}t.CancellationSlot=i,t.default=i},1600:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionVariable=void 0;const r="notify";class o{constructor(){this._notifier=new EventTarget}notify(){this._notifier.dispatchEvent(new Event(r))}async wait(e){if(void 0===e||!e())return new Promise((t=>{const o=()=>{(void 0===e||e())&&(this._notifier.removeEventListener(r,o),t())};this._notifier.addEventListener(r,o)}))}}t.ConditionVariable=o,t.default=o},1880:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DeadlineTimer=void 0;const n=o(r(8108)),s=r(7395),i=o(r(4144));class a{constructor(){this._reset()}_reset(){this._deferred=void 0,this._expireTime=i.default.never()}_checkTimer(){if(void 0===this._deferred)return;const e=this._deferred,t=this._expireTime;this._reset(),t===i.default.never()?e.reject(new s.CancelledOperation):e.resolve()}_arm(e){if(this._expireTime=e,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._expireTime===i.default.never())return void this._checkTimer();const t=Math.max(e-i.default.now(),0);this._timeoutId=setTimeout((()=>{this._checkTimer()}),t)}cancel(){this.expiresAt(i.default.never())}expiresAt(e){if(void 0===e)return this._expireTime;this._arm(e)}expiresFromNow(e){this.expiresAt(i.default.now()+e)}async wait(){return this._expireTime===i.default.never()?Promise.reject(new s.CancelledOperation):(this._deferred??(this._deferred=new n.default),this._deferred.promise)}}t.DeadlineTimer=a,t.default=a},446:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5077:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TypedIO=void 0;const n=o(r(7638));class s{constructor(e,t){this._io=e,this._type=t,this._cancelSlots=new Set}cancel(){for(const e of this._cancelSlots)e.cancel()}async read(e){const t=function(e){return e??(e={}),{cancel:e.cancel??new n.default}}(e),r=this._io.read(this._type,{...t});this._cancelSlots.add(t.cancel);const o=()=>{this._cancelSlots.delete(t.cancel)};return r.then(o,o),r}write(e){this._io.write(this._type,e)}}t.TypedIO=s,t.default=s},6235:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IOClient=void 0,n(r(7857),t);const i=s(r(1714)),a=s(r(6342)),c=s(r(3841)),u=r(9600);class d{constructor(){this._io=new c.default(u.Source.Browser)}async connect(){return this._port=i.default.connect(),this._io=new a.default(u.Source.Browser,this._port),this}reconnect(){this._port?.swap(i.default.connect())}reset(){this.cancel(),this.reconnect()}write(e,t){this._io.writeWithRetry(e,t,(e=>{e("reconnecting"),this.reconnect()}))}async read(e,t){return this._io.read(e,t)}cancel(){this._io.cancel()}}t.IOClient=d,t.default=d},5879:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IOServer=void 0,n(r(7857),t);const i=s(r(9161)),a=s(r(6342)),c=r(9600);class u{accept(e){return new a.default(c.Source.Browser,new i.default(e))}}t.IOServer=u,t.default=u},9161:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimePort=void 0;class r{constructor(e){this._handler=void 0,this._resetPort(e)}postMessage(e){this._port.postMessage(e)}onMessage(e){this._handler=e,this._port.onMessage.addListener(this._handler)}_resetPort(e){void 0!==this._handler?(this._port.onMessage.removeListener(this._handler),this._port=e,this._port.onMessage.addListener(this._handler)):this._port=e}swap(e){const t=this._port,r=e._port;this._resetPort(r),e._resetPort(t)}}t.RuntimePort=r,t.default=r},1714:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(9161));t.default={connect:function(){const e=chrome.runtime.connect();return new n.default(e)}}},8746:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7857),t),n(r(6235),t),n(r(5879),t)},1831:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.cancelFromNow=void 0;const n=o(r(9246));t.cancelFromNow=function(e){const t=new n.default,r=t.slot();return e<=0?(r.cancel(),r):(setTimeout((()=>{t.emit()}),e),r)}},8606:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transferForever=t.transferExactly=void 0,t.transferExactly=function(e){if(e<0)throw new Error("`n` must be 0 or greater");return t=>e<=t?0:e-t},t.transferForever=function(){return()=>1}},6342:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasicIOContext=void 0;const n=o(r(7860)),s=o(r(3471)),i=o(r(8763)),a=o(r(7139)),c=o(r(16));class u{constructor(e,t){this._source=e,this._port=t,this._proactor=new c.default,t.onMessage((e=>{this._dispatch(e)}))}_dispatch(e){if(!s.default.isValid(e))return;const{type:t,message:r}=s.default.deserialize(e);this._proactor.dispatch(t,r)}write(e,t){(0,i.default)(this._source,e,t,this._port)}writeWithRetry(e,t,r){(0,a.default)(this._source,e,t,this._port,r)}async read(e,t){return(0,n.default)(this._source,e,(async()=>this._proactor.read(e,t)))}cancel(){this._proactor.cancel()}}t.BasicIOContext=u,t.default=u},8108:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;class r{constructor(){this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}get promise(){return this._promise}get resolve(){return this._resolve}get reject(){return this._reject}}t.Deferred=r,t.default=r},3841:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._InvalidIOContext=void 0;const n=o(r(7860)),s=o(r(8763)),i=o(r(7139)),a=r(7395);class c{constructor(e){this._source=e}write(e,t){(0,s.default)(this._source,e,t,{postMessage(){throw new a.NoConnectionError}})}writeWithRetry(e,t,r){(0,i.default)(this._source,e,t,{postMessage(){throw new a.NoConnectionError}},r)}async read(e,t){return(0,n.default)(this._source,e,(async()=>Promise.reject(new a.NoConnectionError)))}cancel(){}}t._InvalidIOContext=c,t.default=c},16:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._MessageProactor=void 0;const n=r(9804),s=o(r(8108));class i{constructor(){this._pendings=new Map,this._messages=new Map}_messagesByType(e){return(0,n.emplace)(this._messages,e,{insert:()=>[]})}_pendingByType(e){return(0,n.emplace)(this._pendings,e,{insert:()=>new Set})}dispatch(e,t){const r=this._messagesByType(e);r.push(t);const o=this._pendingByType(e);if(0===o.size)return;const[n]=o;o.delete(n),n.deferred.resolve(r.shift())}async _createDeferred(e,t){const{cancel:r}=t,o=new s.default,n={deferred:o,cancelSlot:r};e.add(n);const i=()=>{e.delete(n)};r.assign((e=>{o.reject(e)}));const{promise:a}=o;return a.then(i,i),a}async read(e,t){if(t.cancel.cancelled){let e;return t.cancel.assign((t=>{e=t})),Promise.reject(e)}const r=this._messagesByType(e),o=this._pendingByType(e);return r.length&&!o.size?Promise.resolve(r.shift()):this._createDeferred(o,t)}cancel(){for(const e of this._pendings.values()){for(const t of e)t.cancelSlot.cancel();e.clear()}}}t._MessageProactor=i,t.default=i},9600:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EnabledTracker=t.DisabledTracker=t.Source=void 0;const o=r(7395);function n(e,t,r,o){const n=(new Date).getTime(),s=function(e,t){switch(e){case"action":return`${t}`;case"cancel":return`~${t}`;case"complete":return`<${t}`;case"error":return`!${t}`;case"start":return`>${t}`}}(t,r);return`@dealfinder-io|${e}|${n}|${s}|${o}`}var s;(s=t.Source||(t.Source={})).Browser="browser",s.Local="local",s.Window="window",t.DisabledTracker=class{action(e){}complete(e){}error(e){}start(e){}},t.EnabledTracker=class{constructor(e,t,r){this._source=e,this._n=t,this._handler=r}action(e){this._handler(n(this._source,"action",this._n,e))}complete(e){this._handler(n(this._source,"complete",this._n,e?e():""))}error(e){e instanceof o.CancelledOperation?this._handler(n(this._source,"cancel",this._n,"")):this._handler(n(this._source,"error",this._n,e.message))}start(e){this._handler(n(this._source,"start",this._n,e?e():""))}}},7444:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperationTrackerFactory=void 0;const o=r(9600);class n{constructor(){this._n=0,this._disabledTracker=new o.DisabledTracker}create(e){return void 0===this._handler?this._disabledTracker:new o.EnabledTracker(e,this._n++,this._handler)}set handler(e){this._handler=e}get handler(){return this._handler}}t.OperationTrackerFactory=n;const s=new n;t.default=s},7860:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.readOp=void 0;const n=r(7613),s=o(r(7444));async function i(e,t,r){const o=s.default.create(e);return o.start((()=>`read;type=${t}`)),r().then((e=>(o.complete((()=>`read;message=${JSON.stringify(e)}`)),e)),(e=>{const t=(0,n.toIOError)(e);throw o.error(t),t}))}t.readOp=i,t.default=i},8763:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7613),s=o(r(7444)),i=o(r(3471));t.default=function(e,t,r,o){const a=s.default.create(e);a.start((()=>`write;type=${t};message=${JSON.stringify(r)}`));const c=i.default.serialize(t,r);try{o.postMessage(c)}catch(e){const t=(0,n.toIOError)(e);throw a.error(t),t}a.complete()}},7139:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7613),s=o(r(7444)),i=o(r(3471));t.default=function(e,t,r,o,a){const c=s.default.create(e);c.start((()=>`writeWithRetry;type=${t};message=${JSON.stringify(r)}`));const u=i.default.serialize(t,r);try{return o.postMessage(u),void c.complete()}catch(e){}try{a((e=>{c.action(e)})),o.postMessage(u)}catch(e){const t=(0,n.toIOError)(e);throw c.error(t),t}c.complete()}},7613:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toIOError=void 0;const o=r(7395);t.toIOError=function(e){if(e instanceof o.IOError)return e;let t;return t=e instanceof Error?e.message:e?.toString()??"unknown",new o.IOError(t)}},236:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof browser&&"function"==typeof browser.runtime.sendMessage&&(globalThis.EventTarget=window.EventTarget)},3471:(e,t)=>{"use strict";var r;function o(e){return e instanceof Date?`${r.Date}${e.toISOString()}`:e instanceof URL?`${r.Url}${e.href}`:Array.isArray(e)?e.map(o):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,o(t)]))):e}function n(e){return"string"==typeof e?e.startsWith(r.Date)?new Date(e.slice(r.Date.length)):e.startsWith(r.Url)?new URL(e.slice(r.Url.length)):e:Array.isArray(e)?e.map(n):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,n(t)]))):e}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Date="!date;",e.Url="!url;"}(r||(r={})),t.default={serialize:function(e,t){return{type:e,message:o(t)}},deserialize:function(e){return{type:e.type,message:n(e.message)}},isValid:function(e){return e??(e={}),!0===Object.prototype.hasOwnProperty.call(e,"type")&&!0===Object.prototype.hasOwnProperty.call(e,"message")}}},7395:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rethrowIfNotCancelled=t.NoConnectionError=t.CancelledOperation=t.IOError=void 0;class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}}t.IOError=r;class o extends r{constructor(){super("cancelled operation"),Object.setPrototypeOf(this,o.prototype)}}t.CancelledOperation=o;class n extends r{constructor(){super("no connection"),Object.setPrototypeOf(this,n.prototype)}}t.NoConnectionError=n,t.rethrowIfNotCancelled=function(e){if(!(e instanceof o))throw e}},7857:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(236),n(r(5218),t),n(r(1831),t),n(r(9246),t),n(r(7638),t),n(r(8606),t),n(r(1600),t),n(r(1880),t),n(r(7395),t),n(r(446),t),n(r(1405),t),n(r(2062),t),n(r(4144),t),n(r(5077),t),n(r(6350),t)},1405:(e,t)=>{"use strict";async function r(e,t){return e.read(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.read=void 0,t.read=r,t.default=r},2062:(e,t)=>{"use strict";async function*r(e,t,r){let o=0;for(;0!=t(o);)yield await e.read(r),++o}Object.defineProperty(t,"__esModule",{value:!0}),t.readMany=void 0,t.readMany=r,t.default=r},4144:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Time=void 0;class r{static now(){return this.milliseconds((new Date).getTime())}static never(){return-1}static seconds(e){return this.milliseconds(1e3*e)}static milliseconds(e){return e}}t.Time=r,t.default=r},6155:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IOClient=void 0,n(r(7857),t);const i=s(r(5442)),a=s(r(6342)),c=s(r(3841)),u=r(9600);class d{constructor(){this._io=new c.default(u.Source.Window)}async connect(e,t){const r=await i.default.connect(e,t);return this._io=new a.default(u.Source.Window,r),this}write(e,t){this._io.write(e,t)}async read(e,t){return this._io.read(e,t)}cancel(){this._io.cancel()}}t.IOClient=d,t.default=d},2679:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.IOServer=void 0,n(r(7857),t);const i=s(r(5442)),a=s(r(6342)),c=r(9600);class u{constructor(e){this._acceptOp=i.default.accept(e)}async accept(){const e=await this._acceptOp.next();return new a.default(c.Source.Window,e.value)}}t.IOServer=u,t.default=u},1974:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessagePort=void 0;class r{constructor(e){this._port=e}postMessage(e){this._port.postMessage(e)}onMessage(e){this._port.onmessage=t=>{e(t.data)}}}t.MessagePort=r,t.default=r},5442:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(5218)),s=o(r(1600)),i=o(r(4144)),a=o(r(1974)),c="dealfinder-io:syn",u="dealfinder-io:syn-ack",d=i.default.milliseconds(250);t.default={accept:async function*(e){const t=new n.default;for(e.addEventListener("message",(e=>{if(e.data!==c)return;const r=e.ports[0];r.postMessage(u),t.push(new a.default(r))}));;)yield await t.pop()},connect:async function(e,t){const r=new s.default,o=new MessageChannel;let n;o.port1.onmessage=e=>{e.data===u&&(n=new a.default(o.port1),r.notify())};const i=()=>{void 0===n&&(e.postMessage(c,t,[o.port2]),setTimeout(i,d))};return i(),await r.wait((()=>void 0!==n)),n}}},8874:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7857),t),n(r(6155),t),n(r(2679),t)},6350:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.write=void 0,t.write=function(e,t){e.write(t??{})}},7618:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bind=t.MessageType=void 0;const o=r(7857);var n;(n=t.MessageType||(t.MessageType={})).ActivateCashBackOfferRequest="activate_cash_back_offer_request",n.ActivateCashBackOfferResponse="activate_cash_back_offer_response",n.AppConnected="app_connected",n.AppIFrameCreated="app_iframe_created",n.AttributionUpdate="attribution_update",n.AuthenticateUserRequest="authenticate_user_request",n.AuthenticateUserResponse="authenticate_user_response",n.CashBackOfferStatusRequest="cash_back_offer_status_request",n.CashBackOfferStatusResponse="cash_back_offer_status_response",n.CheckAndApplyCodesRequest="check_and_apply_codes_request",n.CheckAndApplyCodesResponse="check_and_apply_codes_response",n.CheckCodeUpdate="check_code_update",n.DetectPlatformRequest="detect_platform_request",n.DetectPlatformResponse="detect_platform_response",n.DoCloseAuthenticationWindow="do_close_authentication_window",n.DoEnableDataCollection="do_enable_data_collection",n.DoFocusAuthenticationWindow="do_focus_authentication_window",n.DoOpenTab="do_open_tab",n.DoSendAnalyticEvent="do_send_analytic_event",n.DoSetBadge="do_set_badge",n.DoStartContentScript="do_start_content_script",n.DoStopApplyingCodes="do_stop_applying_codes",n.DoTrackEvent="do_track_event",n.DoTrackInternalEvent="do_track_internal_event",n.DoUninstallSelf="do_uninstall_self",n.DoUpdateDOM="do_update_dom",n.DoVisitAffiliate="do_visit_affiliate",n.ExperienceContextUpdate="experience_context_update",n.LivenessProbeRequest="liveness_probe_request",n.LivenessProbeResponse="live_probe_response",n.PartialExperienceContextUpdate="partial_experience_context_update",n.RegisterAndActivateCashBackOfferRequest="register_and_activate_cash_back_offer_request",n.StorageRequest="storage_request",n.StorageResponse="storage_response",n.UserClickedExtensionIcon="user_clicked_extension_icon",n.UserDataRequest="user_data_request",n.UserDataResponse="user_data_response",t.bind=function(e,t){return new o.TypedIO(e,t)}},9737:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7618),t),n(r(586),t)},4458:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5638:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8861:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9858:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6285:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8201:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5407:(e,t)=>{"use strict";var r;function o(e){return e._status===r.Fail}Object.defineProperty(t,"__esModule",{value:!0}),t.throwOnFail=t.isFail=t.fail=t.success=t.BasicStatus=void 0,function(e){e.Fail="fail",e.Success="success"}(r=t.BasicStatus||(t.BasicStatus={})),t.success=function(e){return{...e??{},_status:r.Success}},t.fail=function(e){return{_status:r.Fail,reason:e}},t.isFail=o,t.throwOnFail=function(e){if(o(e))throw new Error(JSON.stringify(e.reason))}},1265:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4629:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CashBackOfferActivation=void 0,(r=t.CashBackOfferActivation||(t.CashBackOfferActivation={})).Activated="activated",r.Unactivated="unactivated"},50:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9516:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4182:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2608:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.URLPageType=t.Operation=void 0,(t.Operation||(t.Operation={})).ApplyCodes="apply_codes",(r=t.URLPageType||(t.URLPageType={})).Category="category",r.CodeChecking="code_checking",r.Unknown="unknown"},4215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4371:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0,(r=t.Platform||(t.Platform={})).BigCommerce="bigcommerce",r.Magento="magento",r.SalesForce_Demandware="salesforce demandware",r.Sellfy="sellfy",r.Shopify="shopify",r.Volusion="volusion",r.WooCommerce="woocommerce"},213:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2210:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9565:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},926:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6238:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1031:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5147:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9356:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},143:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},4493:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5366:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppNodeIdentifiers=t.ShadowRoot=void 0,t.ShadowRoot="@shadow-root",t.AppNodeIdentifiers={id:"app",path:t.ShadowRoot,parent:t.ShadowRoot,tag:"iframe"}},3891:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8168:(e,t)=>{"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.installId=t.NavigationType=t.NavigationQualifier=void 0,(o=t.NavigationQualifier||(t.NavigationQualifier={})).ClientRedirect="client_redirect",o.Extension="extension",o.ForwardBack="forward_back",o.FromAddressBar="from_address_bar",o.ServerRedirect="server_redirect",(r=t.NavigationType||(t.NavigationType={})).AutoBookmark="auto_bookmark",r.AutoSubframe="auto_subframe",r.FormSubmit="form_submit",r.Generated="generated",r.Keyword="keyword",r.KeywordGenerated="keyword_generated",r.Link="link",r.ManualSubframe="manual_subframe",r.Reload="reload",r.StartPage="start_page",r.Typed="typed",r.Unknown="unknown",t.installId=e=>"installDetails"in e?e.installDetails.id:e.installUuid},9154:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1724:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3462:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3234:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},5388:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2520:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8156:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isAuthenticatedUser=t.makeAuthenticatedUser=t.isUnauthenticatedUser=t.makeUnauthenticatedUser=t.Authentication=void 0,function(e){e.Authenticated="authenticated",e.Unauthenticated="unauthenticated"}(r=t.Authentication||(t.Authentication={})),t.makeUnauthenticatedUser=function(){return{authentication:r.Unauthenticated}},t.isUnauthenticatedUser=function(e){return e.authentication==r.Unauthenticated},t.makeAuthenticatedUser=function(e){return{...e,authentication:r.Authenticated}},t.isAuthenticatedUser=function(e){return e.authentication==r.Authenticated}},586:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4458),t),n(r(9348),t),n(r(5638),t),n(r(8861),t),n(r(9858),t),n(r(6285),t),n(r(8201),t),n(r(5407),t),n(r(1265),t),n(r(4629),t),n(r(50),t),n(r(9516),t),n(r(4182),t),n(r(2608),t),n(r(4493),t),n(r(4215),t),n(r(4371),t),n(r(213),t),n(r(2210),t),n(r(9565),t),n(r(926),t),n(r(5198),t),n(r(6238),t),n(r(1031),t),n(r(5147),t),n(r(9356),t),n(r(143),t),n(r(5366),t),n(r(3891),t),n(r(8168),t),n(r(9154),t),n(r(1724),t),n(r(545),t),n(r(3462),t),n(r(3234),t),n(r(5388),t),n(r(2520),t),n(r(2258),t),n(r(8156),t)},3874:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingEntryError=void 0;class r extends Error{constructor(){super("insert handler required when entry is missing"),Object.setPrototypeOf(this,r.prototype)}}t.MissingEntryError=r,t.default=r},5501:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.emplace=void 0;const n=o(r(3874));function s(e,t,r){if(e.has(t))return function(e,t,r){const o=e.get(t);if(!r)return o;const n=r(o,t,e);return e.set(t,n),n}(e,t,r.update);if(!r.insert)throw new n.default;return function(e,t,r){const o=r(t,e);return e.set(t,o),o}(e,t,r.insert)}t.emplace=s,t.default=s},9804:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(r(3874),t),n(r(5501),t);var i=r(5501);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s(i).default}})},8643:e=>{e.exports=function(){}},7231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppLoader=void 0;const o=r(7857),n=r(8874),s=r(82),i=r(6038),a={[s.AppIdentifier.App]:{interval:o.Time.seconds(2),timeout:o.Time.seconds(30)},[s.AppIdentifier.DataCollectionConsent]:{interval:o.Time.seconds(2),timeout:o.Time.seconds(30)}};class c{constructor(e){this._server=new n.IOServer(e),this._ui=new i.UIAppLoader(e.document)}load(e){return this._ui.load({...e,...a[e.app]}),{accept:async()=>this._server.accept(),dispose:()=>this._ui.dispose(),ui:this._ui}}}t.AppLoader=c,t.default=c},5495:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(r(7231),t),n(r(82),t);var i=r(7231);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s(i).default}})},82:function(e,t,r){"use strict";var o,n=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.AppIdentifier=void 0,s(r(303),t),(o=t.AppIdentifier||(t.AppIdentifier={}))[o.App=0]="App",o[o.DataCollectionConsent=1]="DataCollectionConsent"},5508:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UIAppLoader=void 0;const n=r(9737),s=o(r(2280)),i=o(r(3645)),a=o(r(5368)),c=o(r(4323)),u=r(6239),d=r(82),l={[d.AppIdentifier.App]:{height:"0px",visibility:"hidden",width:"0px"},[d.AppIdentifier.DataCollectionConsent]:{border:"0",height:"905px",position:"fixed",right:"25px",top:"25px",visibility:"visible",width:"450px",zIndex:"2147483647"}};function f(e){return e.app===d.AppIdentifier.DataCollectionConsent?new URL(s.default.runtime.getURL("./html/consent.html")).href:e.src.href}class _{constructor(e){this._document=e,this._shadowRoot=(0,c.default)(e),this._controller=new i.default(e,this._shadowRoot),this._iframe=(0,a.default)(this._controller),this._appState=void 0,this._disposed=!1}get dom(){return this._controller}dispose(){this._disposed&&(this._shadowRoot.host.remove(),this._disposed=!0)}load(e){this._appState={src:f(e)},this._controller.handle({command:"update",id:n.AppNodeIdentifiers.id,tag:n.AppNodeIdentifiers.tag,attribute:{src:this._appState.src},style:l[e.app]}),this._reconciler?.stop(),this._reconciler=(0,u.startReconcileOp)({interval:e.interval,timeout:e.timeout,onTimeout:e.onTimeout,reconcile:()=>this._reconcile()})}getState(){return{iframe:{connected:this._iframe.isConnected,contained:this._shadowRoot.contains(this._iframe),src:this._iframe.src},shadowRoot:{connected:this._shadowRoot.isConnected,host:{connected:this._shadowRoot.host.isConnected,contained:this._document.contains(this._shadowRoot.host)}}}}_reconcile(){const e=this.getState();let t=!0;return void 0!==this._appState&&this._iframe.src!==this._appState.src&&(this._iframe.src=this._appState.src,t=!1),e.iframe.connected&&e.iframe.contained||(this._shadowRoot.appendChild(this._iframe),t=!1),e.shadowRoot.connected&&e.shadowRoot.host.connected&&e.shadowRoot.host.contained||(this._document.body.insertAdjacentElement("afterend",this._shadowRoot.host),t=!1),{state:e,reconciled:t}}}t.UIAppLoader=_,t.default=_},3645:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasicDOMController=void 0;const n=r(9737),s=o(r(8643)),i="data-rmn-node-id";function a(e,t){!function(e,t){for(const[r,o]of Object.entries(t))void 0===o?e.removeAttribute(r):e.setAttribute(r,o)}(e,t.attribute??{}),function(e,t){for(const[r,o]of Object.entries(t))e.style[r]=o??null}(e,t.style??{}),"innerHTML"in t&&void 0!==t.innerHTML&&function(e,t){e.innerHTML=t}(e,t.innerHTML)}function c(e,t){try{return e.evaluate(t,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch{return null}}function u(e,t){switch(t){case"div":case"iframe":return e.createElement(t);default:throw s.default,new Error(`unknown tag: ${t}`)}}class d{constructor(e,t){this.handle=e=>{switch(e.command){case"create":return void this._create(e);case"reference":return void this._reference(e);case"remove":return void this._remove(e);case"update":return void this._update(e)}},this._createInDocument=e=>{const t=c(this._document,e.parent);if(!t)return;const r=u(this._document,e.tag);r.setAttribute(i,e.id),a(r,e),t.append(r)},this._createInShadowRoot=e=>{let t=this._closedElements.get(e.id);t||(t=u(this._document,e.tag),t.setAttribute(i,e.id),a(t,e),this._closedElements.set(e.id,t),this._shadowRoot.append(t))},this._closedElements=new Map,this._document=e,this._shadowRoot=t}get(e){return this._closedElements.get(e)??this._getInDocument(e)}get document(){return this._document}get shadowRoot(){return this._shadowRoot}_create(e){const t=this.get(e.id);t?a(t,e):e.parent===n.ShadowRoot?this._createInShadowRoot(e):this._createInDocument(e)}_getInDocument(e){return this._document.querySelector(`[${i}="${e}"]`)}_reference(e){const t=c(this._document,e.path);t&&t.setAttribute(i,e.id)}_remove(e){const t=this.get(e.id);t&&(t.remove(),this._closedElements.delete(e.id))}_update(e){const t=this.get(e.id);t&&a(t,e)}}t.BasicDOMController=d,t.default=d},5368:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAppIFrame=void 0;const o=r(9737);function n(e){const{id:t,parent:r}=o.AppNodeIdentifiers;e.handle({command:"create",id:t,parent:r,tag:"iframe",attribute:{allow:"clipboard-write",loading:"eager"},style:{}});const n=e.get(t);if(null===n)throw new Error("failed to create iframe");return n}t.createAppIFrame=n,t.default=n},4323:(e,t)=>{"use strict";function r(e){const t=e.createElement("div"),r=e.location.hostname.endsWith("retailmenot.com")?"open":"closed";return t.style.setProperty("all","initial","important"),e.body.insertAdjacentElement("afterend",t),t.attachShadow({mode:r})}Object.defineProperty(t,"__esModule",{value:!0}),t.createShadowRoot=void 0,t.createShadowRoot=r,t.default=r},6239:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startReconcileOp=void 0;const n=o(r(8643));t.startReconcileOp=function(e){const t={running:!0};return async function(e,t){let r=Date.now()+t.timeout,o=!1;for(;e.running;){const{state:e,reconciled:n}=t.reconcile(),s=Date.now();n?r=s+t.timeout:!o&&s>r&&(t.onTimeout(e),o=!0),await new Promise((e=>setTimeout(e,t.interval)))}}(t,e).catch(n.default),{stop:()=>{t.running=!1}}}},6038:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5508),t),n(r(303),t)},303:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6419:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextOperator=void 0;const o=r(7857),n=r(9737);class s{constructor(e){this._app=void 0,this._attribution=e.attribution,this._operations=[],this._extensionDetails=e.extensionDetails,this._history=e.history,this._installedCompetitors=e.installedCompetitors,this._pageType=n.URLPageType.Unknown,this._tabId=e.tabId}attach(e){this._app=e,this._flush()}update(e){void 0!==e?("attribution"in e?this._attribution=e.attribution:"pageType"in e&&(this._pageType=e.pageType,this._operations=e.operations),this._flush()):this._flush()}_flush(){void 0!==this._app&&(0,o.write)((0,n.bind)(this._app,n.MessageType.ExperienceContextUpdate),{attribution:this._attribution,extensionDetails:this._extensionDetails,history:this._history,installedCompetitors:this._installedCompetitors,operations:{supported:this._operations},pageType:this._pageType,tabId:this._tabId,url:new URL(document.location.href),viewport:{height:window.innerHeight,width:window.innerWidth}})}}t.ContextOperator=s,t.default=s},5702:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=o(r(4007));function i(e){const t=new s.default,r=e.destination.io,o=e.source.io;for(const s of e.destination.receive){const i=t.on(new n.TypedIO(o,s),(0,n.transferForever)(),(async e=>(r.write(s,e),Promise.resolve())));e.awaiter(i)}return t}function a(e){return{io:e.io,receive:[...e.receive]}}t.default=class{constructor(e){const t=a(e.peer1),r=a(e.peer2);this._router1=i({awaiter:e.awaiter,destination:t,source:r}),this._router2=i({awaiter:e.awaiter,destination:r,source:t})}cancel(){this._router1.cancel(),this._router2.cancel()}}},7263:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=o(r(8394));(0,o(r(4267)).default)(window.location.href).catch(n.rethrowIfNotCancelled).catch(s.default.error)},4267:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=r(8746),i=r(9737),a=o(r(4055)),c=r(9931),u=o(r(1868));t.default=async function(e){if(void 0===e)return void console.log("Undefined url, can do nothing");if(function(e){return e.includes("google.com")}(e))return void(0,u.default)();const t=await(new s.IOClient).connect();var r;chrome.runtime.onMessage.addListener((r=t,(e,t,o)=>{if(t.id===chrome.runtime.id)return"reconnect"===e.type?(async function(e){(0,n.write)((0,i.bind)(e,i.MessageType.LivenessProbeRequest)),await(0,n.read)((0,i.bind)(e,i.MessageType.LivenessProbeResponse),{cancel:(0,n.cancelFromNow)(n.Time.milliseconds(100))})}(r).then(o,o),!0):void 0}));const o=(0,c.createTracker)({io:t,name:"merchantMain"});return o.run((async()=>(0,a.default)(t,o))).finally((()=>console.log("content script exiting")))}},4055:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=r(9737),i=o(r(8643)),a=r(5495),c=o(r(6419)),u=o(r(1477)),d=o(r(8394)),l=o(r(4007)),f=r(3487),_=r(4713),p=o(r(8049)),h=o(r(2223)),m=n.Time.seconds(10);t.default=async function(e,t){(async function(e){await(0,n.read)((0,s.bind)(e,s.MessageType.DetectPlatformRequest));try{const t=new _.PlatformIdentifier(document),r=await t.searchForPlatform();(0,n.write)((0,s.bind)(e,s.MessageType.DetectPlatformResponse),(0,s.success)({platform:r}))}catch(t){(0,n.write)((0,s.bind)(e,s.MessageType.DetectPlatformResponse),(0,s.fail)(t))}})(e).catch(i.default);const r=await t.run("waitForStart",(async()=>async function(e){const t=await(0,n.read)((0,s.bind)(e,s.MessageType.DoStartContentScript));return(0,s.isFail)(t)?"exit":(function(e,t){if(!t.hostname.endsWith(".retailmenot.com"))throw new Error(`app contains unexpected URL: ${t.href}`)}(0,t.appURL),t)}(e)));if("exit"===r)return;const o=t.run("findInstalledCompetitors",(async()=>(0,f.findInstalledCompetitors)(r.competitorDetectionConfig))),v=await t.run("createAppLoader",(()=>function(e){const t=new a.AppLoader(window);return(0,n.write)((0,s.bind)(e,s.MessageType.AppIFrameCreated)),t}(e)));return r.canCollectData||await t.run("promptForDataCollection",(async()=>async function(e,t,r){const o=t.load({app:a.AppIdentifier.DataCollectionConsent,onTimeout:e=>{r.error("promptForDataCollection",{message:`could not reconcile DOM:\n${JSON.stringify(e)})`})}}),c=await o.accept(),l=(0,u.default)({app:c,serviceWorker:e,awaiter:e=>{e.catch((e=>d.default.error(e)))}});(0,n.read)((0,s.bind)(c,s.MessageType.DoUninstallSelf)).then((()=>{o.dispose(),(0,n.write)((0,s.bind)(e,s.MessageType.DoUninstallSelf))})).catch(i.default),await(0,n.read)((0,s.bind)(c,s.MessageType.DoEnableDataCollection)),(0,n.write)((0,s.bind)(e,s.MessageType.DoEnableDataCollection)),l.cancel(),c.cancel()}(e,v,t))),async function(e,t,r,o,s){const f=t.load({app:a.AppIdentifier.App,src:r.appURL,onTimeout:e=>{s.error({message:`could not reconcile DOM:\n${JSON.stringify(e)})`})}}),_=new c.default({...r.context,installedCompetitors:o});!function(e){window.addEventListener("resize",(()=>e.update()))}(_),(0,h.default)(new l.default,{contextOperator:_,serviceWorker:e});const v=function(e,t,r,o){const s=new n.DeadlineTimer;return e.run("connectDeadline",(async()=>(s.expiresFromNow(r),s.wait().then(o,i.default)))).catch(i.default),{stop:()=>{s.cancel()}}}(s,0,m,(()=>{throw e=f.ui.getState(),new Error(`connect deadline exceeded.  DOM contains:\n${JSON.stringify(e)}`);var e}));let y=()=>v.stop();for(;;){const t=await f.accept();y(),_.attach(t);const r=new l.default;(0,p.default)(r,{app:t,dom:f.ui.dom});const o=(0,u.default)({app:t,awaiter:e=>{e.catch((e=>d.default.error(e)))},serviceWorker:e});y=()=>{o.cancel(),r.cancel()}}}(e,v,r,await o,t.createTracker("loadApp"))}},6605:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.findInstalledCompetitors=void 0;const n=o(r(8643));t.findInstalledCompetitors=async e=>{if(e.enabled)return await i(e)};const s=async(e,t,r)=>{let o;try{o=await fetch(`${e}://${t}/${r}`,{method:"GET"})}catch(e){n.default}return o?.ok??!1},i=async e=>{const t=[];for(const r of e.competitors)await s(e.schema,r.id,r.resource)&&t.push(r);return t}},3487:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6605),t)},6530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookieChecker=void 0,t.CookieChecker=class{constructor(e){this.cookies=new Map;for(const t of e.cookie.split(";")){const e=/^\s*([^]*?)="?([^]*?)"?\s*$/.exec(t);if(e){let t=e[2];try{t=decodeURIComponent(e[2])}catch{}this.cookies.set(e[1],t)}}}check(e){for(const t of e)if(this.cookies.has(t))return!0;return!1}}},5056:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetaChecker=void 0,t.MetaChecker=class{constructor(e){this.meta=new Map,Array.from(e.querySelectorAll("meta")).reduce(((e,t)=>{const r=t.getAttribute("name")??t.getAttribute("property");if(null!=r){const o=t.getAttribute("content");if(null!=o){const t=e.get(r.toLowerCase())||[];t.push(o),e.set(r.toLowerCase(),t)}}return e}),this.meta)}check(e){for(const t of e)if(this.meta.has(t))return!0;return!1}}},3037:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptChecker=void 0,t.ScriptChecker=class{constructor(e){const t=Array.from(e.scripts);this.scriptSrc=t.filter((({src:e})=>e&&!e.startsWith("data:text/javascript;"))).map((({src:e})=>e))}compare(e,t){for(const r of e)try{if(RegExp(r).test(t))return!0}catch(e){console.log(e)}return!1}check(e){for(const t of e)if(this.compare(this.scriptSrc,t))return!0;return!1}}},7927:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectorChecker=void 0,t.SelectorChecker=class{constructor(e){this.doc=e}check(e){for(const t of e)if(this.doc.querySelectorAll(t).length>0)return!0;return!1}}},4713:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformIdentifier=void 0;const o=r(9737),n=r(6530),s=r(5056),i=r(3037),a=r(7927),c=[{platform:o.Platform.BigCommerce,selectors:["img[data-src*='.bigcommerce.com'], img[src*='.bigcommerce.com'], link[href*='.bigcommerce.com']"],scriptSrc:"(?:\\.|plugins/)?bigcommerce(?:\\.com)?/(?:assets)?"},{platform:o.Platform.Magento,cookies:["X-Magento-Vary"],selectors:["script[data-requiremodule*='mage/'], script[data-requiremodule*='Magento_'], html[data-image-optimizing-origin]","script[type='text/x-magento-init']"],scriptSrc:["js/mage"]},{platform:o.Platform.SalesForce_Demandware,cookies:["dw_dnt","dwsid"],headers:{Server:"Demandware eCommerce Server"},scriptSrc:"/demandware\\.static/"},{platform:o.Platform.Sellfy,scriptSrc:"sellfy\\.com/js/"},{platform:o.Platform.Shopify,cookies:["_shopify_s","_shopify_y"],headers:{"x-shopify-stage":""},meta:["shopify-features","shopify-digital-wallet"],scriptSrc:["sdks\\.shopifycdn\\.com","cdn\\.shopify\\.com"]},{platform:o.Platform.Volusion,html:['<link [^>]*href="[^"]*/vspfiles/\\;version:1',"<body [^>]*data-vn-page-name\\;version:2"],scriptSrc:"/volusion\\.js(?:\\?([\\d.]*))?\\;version:\\1"},{platform:o.Platform.WooCommerce,selectors:[".woocommerce, .woocommerce-no-js, link[rel*='woocommerce']"],scriptSrc:["woocommerce","/woocommerce(?:\\.min)?\\.js(?:\\?ver=([0-9.]+))?\\;version:\\1"]}];t.PlatformIdentifier=class{constructor(e){this.cookieChecker=new n.CookieChecker(e),this.metaChecker=new s.MetaChecker(e),this.scriptChecker=new i.ScriptChecker(e),this.selectorChecker=new a.SelectorChecker(e)}async searchForPlatform(){const e=(await Promise.all(c.map((async e=>Promise.resolve(this.checkPlatform(e)))))).find((e=>void 0!==e));return console.log(`PLATFORM ID = ${e??"undefined"}`),e}checkPlatform(e){if(null!=e.selectors&&this.selectorChecker.check(e.selectors)||null!=e.meta&&this.metaChecker.check(e.meta)||null!=e.cookies&&this.cookieChecker.check(e.cookies)||null!=e.scriptSrc&&this.scriptChecker.check(e.scriptSrc))return e.platform}}},1868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){console.log("GOOGLE SERP GOES HERE")}},9931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTracker=void 0;const o=r(7857),n=r(9737);class s{constructor(e,t){this._io=e,this._name=t}error(e){const t=void 0===e.stack?e.message:`${e.message}\n${e.stack}`;(0,o.write)(this._io,{name:this._name,stage:"error",error:t})}completed(){(0,o.write)(this._io,{name:this._name,stage:"completed"})}start(){(0,o.write)(this._io,{name:this._name,stage:"start"})}}class i{constructor(e){this._io=e.io,this._name=e.name}createTracker(e){return new i({io:this._io,name:`${this._name}:${e}`})}error(e,t){let r,o;void 0===t?(r=this._name,o=e):(r=`${this._name}:${e}`,o=t),new s(this._io,r).error(o)}async run(e,t){let r,o;return"string"==typeof e?(r=`${this._name}:${e}`,o=t):(r=this._name,o=e),async function(e,t,r){const o=new s(e,t);try{o.start();const e=await Promise.resolve(r());return o.completed(),e}catch(e){throw o.error(function(e){if(e instanceof Error)return e;try{return{message:String(e)}}catch{return{message:"unknown"}}}(e)),e}}(this._io,r,o)}}t.createTracker=function(e){return new i({io:(0,n.bind)(e.io,n.MessageType.DoTrackInternalEvent),name:e.name})}},8049:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=r(9737),i=o(r(8394));t.default=function(e,t){e.on((0,s.bind)(t.app,s.MessageType.DoUpdateDOM),(0,n.transferForever)(),t.dom.handle).catch((e=>i.default.error(e)))}},1477:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(9737),s=o(r(5702)),i=[n.MessageType.ActivateCashBackOfferResponse,n.MessageType.AuthenticateUserResponse,n.MessageType.CashBackOfferStatusResponse,n.MessageType.CheckAndApplyCodesResponse,n.MessageType.CheckCodeUpdate,n.MessageType.StorageResponse,n.MessageType.UserClickedExtensionIcon,n.MessageType.UserDataResponse],a=[n.MessageType.ActivateCashBackOfferRequest,n.MessageType.AppConnected,n.MessageType.AppIFrameCreated,n.MessageType.AttributionUpdate,n.MessageType.AuthenticateUserRequest,n.MessageType.CashBackOfferStatusRequest,n.MessageType.CheckAndApplyCodesRequest,n.MessageType.DoCloseAuthenticationWindow,n.MessageType.DoFocusAuthenticationWindow,n.MessageType.DoOpenTab,n.MessageType.DoSendAnalyticEvent,n.MessageType.DoSetBadge,n.MessageType.DoStopApplyingCodes,n.MessageType.DoTrackEvent,n.MessageType.DoVisitAffiliate,n.MessageType.RegisterAndActivateCashBackOfferRequest,n.MessageType.StorageRequest,n.MessageType.UserDataRequest];t.default=function(e){return new s.default({awaiter:e.awaiter,peer1:{io:e.app,receive:i},peer2:{io:e.serviceWorker,receive:a}})}},2223:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(7857),s=r(9737),i=o(r(8394));t.default=function(e,t){e.on((0,s.bind)(t.serviceWorker,s.MessageType.PartialExperienceContextUpdate),(0,n.transferForever)(),(async e=>(t.contextOperator.update(e),Promise.resolve()))).catch((e=>i.default.error(e)))}},8394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(7857);t.default={error:function(e){e instanceof o.CancelledOperation||console.error(e)}}},4007:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(7857);t.default=class{constructor(){this._canceller=new o.CancellationSignal}async on(e,t,r){return(async()=>{for await(const n of(0,o.readMany)(e,t,{cancel:this._canceller.slot()}))await r(n)})()}cancel(){this._canceller.emit()}}},4:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={action:{onClicked:(...e)=>chrome.action.onClicked.addListener(...e)},badge:{setBackgroundColor:(...e)=>chrome.action.setBadgeBackgroundColor(...e),setText:(...e)=>chrome.action.setBadgeText(...e)},cookies:{get:(...e)=>chrome.cookies.get(...e),onChanged:(...e)=>chrome.cookies.onChanged.addListener(...e),remove:(...e)=>chrome.cookies.remove(...e),set:(...e)=>chrome.cookies.set(...e)},declarativeNetRequest:{updateSessionRules:async(...e)=>chrome.declarativeNetRequest.updateSessionRules(...e)},management:{uninstallSelf:(...e)=>chrome.management.uninstallSelf(...e)},runtime:{getManifest:(...e)=>chrome.runtime.getManifest(...e),getURL:(...e)=>chrome.runtime.getURL(...e),lastError:()=>chrome.runtime.lastError?.message,onConnect:(...e)=>chrome.runtime.onConnect.addListener(...e),onInstalled:(...e)=>chrome.runtime.onInstalled.addListener(...e),setUninstallURL:(...e)=>chrome.runtime.setUninstallURL(...e)},storage:{get local(){return chrome.storage.local},get sync(){return chrome.storage.sync},get session(){return chrome.storage.session}},tabs:{get:(...e)=>chrome.tabs.get(...e),create:(...e)=>chrome.tabs.create(...e),update:(...e)=>chrome.tabs.update(...e),remove:(...e)=>chrome.tabs.remove(...e),onActivated:(...e)=>chrome.tabs.onActivated.addListener(...e),onRemoved:(...e)=>chrome.tabs.onRemoved.addListener(...e),onUpdated:(...e)=>chrome.tabs.onUpdated.addListener(...e),sendMessage:(...e)=>chrome.tabs.sendMessage(...e)},webNavigation:{getFrame:async(...e)=>chrome.webNavigation.getFrame(...e),onCommitted:(...e)=>chrome.webNavigation.onCommitted.addListener(...e)},webRequest:{onBeforeRedirect:(...e)=>chrome.webRequest.onBeforeRedirect.addListener(...e),onResponseStarted:(...e)=>chrome.webRequest.onResponseStarted.addListener(...e)},windows:{create:(...e)=>chrome.windows.create(...e),get:(...e)=>chrome.windows.get(...e),remove:(...e)=>chrome.windows.remove(...e),update:(...e)=>chrome.windows.update(...e),onFocusChanged:(...e)=>chrome.windows.onFocusChanged.addListener(...e),activeTab:async e=>e==chrome.windows.WINDOW_ID_NONE?Promise.resolve(void 0):chrome.tabs.query({active:!0,windowId:e}).then((e=>e.length>0?e[0].id:void 0))}}},2280:function(e,t,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(r(4),t);var i=r(4);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s(i).default}})}},t={};!function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,r),s.exports}(7263)})();