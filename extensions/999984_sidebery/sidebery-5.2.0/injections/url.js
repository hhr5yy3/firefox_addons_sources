var ADDON_HOST=browser.runtime.getURL(""),SIDEBAR_URL=browser.runtime.getURL("/sidebar/sidebar.html"),GROUP_URL=browser.runtime.getURL("/sidebery/group.html"),GROUP_URL_LEN=GROUP_URL.length,URL_URL=browser.runtime.getURL("/sidebery/url.html"),URL_URL_LEN=URL_URL.length,SETUP_URL=browser.runtime.getURL("/page.setup/setup.html"),SEARCH_URL=browser.runtime.getURL("/popup.search/search.html");var NOID=-1;var UNDERSCORE_RE=/_/g;function toCSSVarName(key){return`--${key.replace(UNDERSCORE_RE,"-")}`}function getInstanceName(instance){return instance===2?"sidebar":instance===0?"bg":instance===3?"setup":instance===1?"group":instance===6?"proxy":instance===5?"url":instance===4?"search":instance===7?"preview":"unknown"}var _type="unknown",_winId="",_tabId="";function setInstanceType(type){_type=getInstanceName(type)}function setWinId(id){id!==NOID&&(_winId=`:${id}`)}function setTabId(id){id!==NOID&&(_tabId=`:${id}`)}function warn(msg,...args){console.warn(`[${_type}${_winId}${_tabId}] ${msg}`,...args)}function err(msg,err2){msg=`[${_type}${_winId}${_tabId}] ${msg}
`,err2!==void 0?console.error(msg,err2):console.error(msg)}function waitDOM(){return new Promise(res=>{document.readyState!=="loading"?res():document.addEventListener("DOMContentLoaded",()=>res())})}function waitInitData(){return new Promise((ok,err2)=>{if(window.sideberyInitData)return ok();window.onSideberyInitDataReady=ok,setTimeout(()=>err2("UrlPage: No initial data (sideberyInitData)"),2e3)})}function applyThemeSrcVars(parsed,rootEl){if(rootEl||(rootEl=document.getElementById("root")??void 0),!!rootEl)for(let prop of Object.keys(parsed.vars)){let value=parsed.vars[prop];value?rootEl.style.setProperty(toCSSVarName("s_"+prop),value):rootEl.style.removeProperty(toCSSVarName("s_"+prop))}}(async()=>{setInstanceType(5),await Promise.all([waitDOM(),waitInitData()]);let initData=window.sideberyInitData;initData.winId!==void 0&&setWinId(initData.winId),initData.tabId!==void 0&&setTabId(initData.tabId),initData.theme?document.body.setAttribute("data-theme",initData.theme):warn("Cannot init sidebery theme"),initData.frameColorScheme?document.body.setAttribute("data-frame-color-scheme",initData.frameColorScheme):warn("Cannot set frame color scheme"),initData.toolbarColorScheme?document.body.setAttribute("data-toolbar-color-scheme",initData.toolbarColorScheme):warn("Cannot set toolbar color scheme"),initData.parsedTheme?applyThemeSrcVars(initData.parsedTheme):warn("Cannot apply firefox theme colors");let titleEl=document.getElementById("title"),titleNoteEl=document.getElementById("title_note"),targetTitleLabelEl=document.getElementById("target_title_label"),targetTitleEl=document.getElementById("target_title"),targetLinkLabelEl=document.getElementById("target_url_label"),targetLinkEl=document.getElementById("target_url"),copyBtnEl=document.getElementById("copy_btn");if(!titleEl)return err("Cannot get element: titleEl");if(!titleNoteEl)return err("Cannot get element: titleNoteEl");if(!targetTitleLabelEl)return err("Cannot get element: targetTitleLabelEl");if(!targetTitleEl)return err("Cannot get element: targetTitleEl");if(!targetLinkLabelEl)return err("Cannot get element: targetLinkLabelEl");if(!targetLinkEl)return err("Cannot get element: targetLinkEl");if(!copyBtnEl)return err("Cannot get element: copyBtnEl");let titleLabel=browser.i18n.getMessage("unavailable_url");titleLabel&&(titleEl.innerText=titleLabel);let targetTitleLabelLable=browser.i18n.getMessage("page_title");targetTitleLabelLable&&(targetTitleLabelEl.innerText=targetTitleLabelLable);let linkLabelLable=browser.i18n.getMessage("original_url");linkLabelLable&&(targetLinkLabelEl.innerText=linkLabelLable);let copyBtnLabel=browser.i18n.getMessage("copy_url");copyBtnLabel&&(copyBtnEl.innerText=copyBtnLabel);let apiLimitNoteLabel=browser.i18n.getMessage("api_limit_info");apiLimitNoteLabel&&(titleNoteEl.innerText=apiLimitNoteLabel);let hash=window.location.hash.slice(1),url;if(hash)try{let jsonData=decodeURIComponent(hash),data=JSON.parse(jsonData);url=decodeURI(data[0]),document.title=data[1],targetTitleEl.innerText=data[1]}catch{url=decodeURI(hash),document.title=hash,targetTitleLabelEl.remove(),targetTitleEl.remove()}if(!url)return err("Cannot get url value");targetLinkEl.innerText=url,copyBtnEl.addEventListener("click",()=>{url&&navigator.clipboard.writeText(encodeURI(url))})})();
