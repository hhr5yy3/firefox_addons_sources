(()=>{"use strict";var e={9394:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoResultDisplay=t.createDropdownItem=t.createAutocompleteHtml=void 0,t.createAutocompleteHtml=function(e){return`<div class="autocomplete-container">\n            <div class="autocomplete-box">\n              <div class="autocomplete-left-container">\n                <img class="autocomplete-left-logo" src="${browser.runtime.getURL("images/logo-loupe.svg")}">\n                <input type="text" style="width: 100%" id="autocomplete-input" placeholder="${e}">\n              </div>\n              <img src="${browser.runtime.getURL("images/little-arrow-down.svg")}" id="poplab-autocomplete-arrow" class="rotatable">\n            </div>\n            <div class="autocomplete-items"></div>\n          </div>`},t.createDropdownItem=function(e){return`<div class="autocomplete-item ${!1===e.selectionnable?"not-selectionnable":""}" id="${e.id}">\n            ${e.text}\n          </div>`},t.createNoResultDisplay=function(){return`<div class="autocomplete-item">${browser.i18n.getMessage("aucun_resultat")}</div>`}},9616:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(s,n){function r(e){try{c(o.next(e))}catch(e){n(e)}}function l(e){try{c(o.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Autocomplete=t.SelectionChangedEvent=void 0;const s=i(9394),n=i(4911);class r extends CustomEvent{constructor(e){super("selection-changed",{detail:{selection:e},bubbles:!0,composed:!0})}}t.SelectionChangedEvent=r;class l extends HTMLElement{constructor(){super(),this.input=document.createElement("input"),this.dropdownContainer=document.createElement("div"),this.options=[],this.handleClickOutside=e=>{this.contains(e.target)||this.closeOptions()},this.onInput=e=>o(this,void 0,void 0,(function*(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout((()=>o(this,void 0,void 0,(function*(){const t=e.target.value.toLowerCase();""!==t?this.options=yield this.fetchFilteredOptions(t):yield this.handleDefaultOption(),this.displayOptions()}))),500)})),this.displayOptions=()=>{this.dropdownContainer.innerHTML="",this.dropdownContainer.classList.remove("display-none"),0===this.options.length?this.dropdownContainer.appendChild((0,n.fromHTML)((0,s.createNoResultDisplay)())):(this.options.forEach((e=>{void 0!==this.renderItemFunction?this.dropdownContainer.appendChild((0,n.fromHTML)(this.renderItemFunction(e))):this.dropdownContainer.appendChild((0,n.fromHTML)((0,s.createDropdownItem)(e)))})),this.listenToOptions()),this.querySelector("#poplab-autocomplete-arrow").classList.add("rotate-up"),this.resizeDropdown()},this.listenToOptions=()=>{this.dropdownContainer.querySelectorAll(".autocomplete-item").forEach((e=>{e.addEventListener("click",(()=>{!1!==this.options.find((t=>t.id===e.id)).selectionnable&&(this._selectedOption=this.options.find((t=>t.id===e.id)),this.closeOptions(),this.dispatchEvent(new r(this._selectedOption)))}))}))},this.closeOptions=()=>{var e;(null===(e=this._selectedOption)||void 0===e?void 0:e.text)?this.input.value=this._selectedOption.text:this.input.value="",this.dropdownContainer.innerHTML="",this.querySelector(".autocomplete-items").classList.add("display-none"),this.querySelector("#poplab-autocomplete-arrow").classList.remove("rotate-up")},this.handleDefaultOption=()=>o(this,void 0,void 0,(function*(){this.input.select(),this.options=yield this.fetchDefaultOptions()})),this.resizeDropdown=()=>{const e=this.dropdownContainer.getBoundingClientRect().top,t=window.innerHeight-e;this.dropdownContainer.style.maxHeight=`${Math.floor(t-38)}px`},this.setSelectedOption=e=>{this._selectedOption=e,this._selectedOption&&(this.input.value=this._selectedOption.text)},this.setRenderItemFunction=e=>{this.renderItemFunction=e},this.setFetchFilteredOptions=e=>{this.fetchFilteredOptions=e},this.setFetchDefaultOptions=e=>{this.fetchDefaultOptions=e};const e=this.querySelector(".autocomplete-container");e&&this.removeChild(e),this.handleClickOutside.bind(this),document.addEventListener("click",this.handleClickOutside)}connectedCallback(){const e=this.getAttribute("placeholder");this.innerHTML=(0,s.createAutocompleteHtml)(null!=e?e:""),this.querySelector(".autocomplete-box").onclick=e=>o(this,void 0,void 0,(function*(){yield this.handleDefaultOption(),this.displayOptions()})),this.input=this.querySelector("#autocomplete-input"),this.input.addEventListener("input",this.onInput.bind(this)),this.dropdownContainer=this.querySelector(".autocomplete-items"),this.dropdownContainer.classList.add("display-none")}disconnectedCallback(){document.removeEventListener("click",this.handleClickOutside)}}t.Autocomplete=l,customElements.define("autocomplete-component",l)},4911:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromHTML=t.clearHighlight=t.smoothScrollToTargetedHtmlElement=t.hasSameFileTypeMoreThanOnce=t.getCountPerFileType=void 0;const o=i(2688);function s(e){return Object.entries(e.reduce(((e,t)=>{const i=t.type_fichier;return e[i]=(e[i]||0)+1,e}),{})).map((([e,t])=>({typeFichier:e,count:t})))}t.getCountPerFileType=s,t.hasSameFileTypeMoreThanOnce=function(e){const t=s(e);return t.filter((e=>e.count>1)).length>0||2===t.filter((e=>e.typeFichier===o.TypeFichier.IMAGE||e.typeFichier===o.TypeFichier.VIDEO)).length};t.smoothScrollToTargetedHtmlElement=function(e,t=0){const i=document.querySelector(`#${e}`);if(i){const e=function(e){let t=e.parentElement;for(;t;){const e=window.getComputedStyle(t);if("auto"===e.overflowY||"scroll"===e.overflowY)return t;t=t.parentElement}return null}(i);if(e){let o=i.getBoundingClientRect().top+e.scrollTop-t;o>e.scrollHeight-e.getBoundingClientRect().height&&(o=e.scrollHeight-e.getBoundingClientRect().height),l(Math.floor(o),e).then((()=>r(i)))}else{let e=i.getBoundingClientRect().top+window.scrollY-t;const o=function(){const e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)-window.innerHeight-40}();e>o&&(e=o),l(Math.floor(e)).then((()=>r(i)))}}};let n=null;function r(e){n&&n.classList.remove("poplab-highlighted"),n=e;let t=document.getElementById("poplab-highlight-stylesheet");t||(t=document.createElement("style"),t.id="poplab-highlight-stylesheet",t.textContent="\n        .poplab-highlighted {\n            border: solid 8px rgb(75, 198, 185);\n        }",document.head.appendChild(t)),setTimeout((()=>{e.classList.add("poplab-highlighted")}),100)}function l(e,t){return t?t.scrollTo({top:e,behavior:"smooth"}):window.scrollTo({top:e,behavior:"smooth"}),new Promise((i=>{const o=()=>{t?Math.floor(t.scrollTop)!==e&&Math.ceil(t.scrollTop)!==e||(t.removeEventListener("scroll",o),i()):Math.floor(window.scrollY)!==e&&Math.ceil(window.scrollY)!==e||(window.removeEventListener("scroll",o),i())};t?(t.removeEventListener("scroll",o),Math.floor(t.scrollTop)===e||Math.ceil(t.scrollTop)===e?i():t.addEventListener("scroll",o)):(window.removeEventListener("scroll",o),Math.floor(window.scrollY)===e||Math.ceil(window.scrollY)===e?i():window.addEventListener("scroll",o))}))}t.clearHighlight=function(){var e;const t=document.getElementById("poplab-highlight-stylesheet");t&&(null===(e=t.parentNode)||void 0===e||e.removeChild(t))},t.fromHTML=function(e){if(!e)return null;const t=document.createElement("template");t.innerHTML=e;const i=t.content.children;return 1===i.length?i[0]:i}},2688:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentCaptureData=t.ElementCaptureData=t.CaptureData=t.FichierMediaObject=t.ExerciseurMediaObject=t.UrlMediaObject=t.AudioMediaObject=t.VideoMediaObject=t.ImageMediaObject=t.MediaObject=t.TypeFichier=t.CaptureType=void 0;const o=i(4393);var s,n;!function(e){e.BASIQUE="BASIQUE",e.UPLOAD="UPLOAD"}(s||(t.CaptureType=s={})),function(e){e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.FICHIER="FICHIER",e.LIEN="LIEN",e.EXERCISEUR="EXERCISEUR"}(n||(t.TypeFichier=n={}));class r{constructor(e,t,i,o,s,n,r){this.id=e,this.url=t,this.type_fichier=i,this.copyright=o,this.file=s,this.editeur=n,this.subTypeFichier=r}}t.MediaObject=r,t.ImageMediaObject=class extends r{constructor(e,t,i,o,s){super(e,t,n.IMAGE,i,o,s)}},t.VideoMediaObject=class extends r{constructor(e,t,i,o,s){super(e,t,n.VIDEO,i,o,s)}},t.AudioMediaObject=class extends r{constructor(e,t,i,o,s){super(e,t,n.AUDIO,i,o,s)}},t.UrlMediaObject=class extends r{constructor(e,t,i,o){super(e,t,n.LIEN,i),this.displayPreview=!1,this.bigPreview=!1,this.label=o}},t.ExerciseurMediaObject=class extends r{constructor(e,t,i){super(e,t,n.EXERCISEUR),this.typeExerciseur=i}},t.FichierMediaObject=class extends r{constructor(e,t,i,o,s){super(e,t,n.FICHIER,void 0,i,void 0,o),this.label=s}};class l{constructor(e,t,i){this.titre=e,this.description=t,this.auteurInitial=i}}t.CaptureData=l;class c extends l{constructor(e){var t,i,s,n,r,l,c;super(null==e?void 0:e.titre,null==e?void 0:e.description,null==e?void 0:e.auteurInitial),this.type=o.ElementType.ELEMENT,this.images=[],this.videos=[],this.audios=[],this.urls=[],this.exerciseurs=[],this.fichiers=[],this.credit=null==e?void 0:e.credit,this.images=null!==(t=null==e?void 0:e.images)&&void 0!==t?t:[],this.videos=null!==(i=null==e?void 0:e.videos)&&void 0!==i?i:[],this.audios=null!==(s=null==e?void 0:e.audios)&&void 0!==s?s:[],this.urls=null!==(n=null==e?void 0:e.urls)&&void 0!==n?n:[],this.exerciseurs=null!==(r=null==e?void 0:e.exerciseurs)&&void 0!==r?r:[],this.fichiers=null!==(l=null==e?void 0:e.fichiers)&&void 0!==l?l:[],this.type=null!==(c=null==e?void 0:e.type)&&void 0!==c?c:o.ElementType.ELEMENT,this.options=null==e?void 0:e.options,this.meta=null==e?void 0:e.meta}setTitre(e){return this.titre=e,this}setDescription(e){return this.description=e,this}setCredit(e){return this.credit=e,this}setImages(e){return this.images=e,this}setVideos(e){return this.videos=e,this}setAudios(e){return this.audios=e,this}setUrls(e){return this.urls=e,this}setExerciseurs(e){return this.exerciseurs=e,this}setType(e){return this.type=e,this}getMedias(){return this.images.concat(this.videos.concat(this.audios.concat(this.fichiers)))}getAllEmbeds(){return this.getMedias().concat(this.urls).concat(this.exerciseurs)}}t.ElementCaptureData=c,t.DocumentCaptureData=class extends l{constructor(e){super(null==e?void 0:e.titre,null==e?void 0:e.description,null==e?void 0:e.auteurInitial),this.elements=[],null==e||e.elements.forEach((e=>this.elements.push(new c(e)))),this.meta=null==e?void 0:e.meta}setTitre(e){return this.titre=e,this}setDescription(e){return this.description=e,this}setElements(e){return this.elements=e,this}}},4393:(e,t)=>{var i,o,s,n;Object.defineProperty(t,"__esModule",{value:!0}),t.Editeur=t.ElementType=t.ExerciseurType=t.PoplabElementCreationRequest=void 0,t.PoplabElementCreationRequest=class{constructor(e,t){var o,n,r;this.titre=null!==(o=e.titre)&&void 0!==o?o:"",this.description=null!==(n=e.description)&&void 0!==n?n:"",this.type=e.type,this.options={isnew:!0,separator:!1},this.type!==s.SECTION||this.titre||(this.options.separator=!0),this.credits=null!==(r=e.credit)&&void 0!==r?r:"",this.webAuteurInitial=e.auteurInitial,this.imageEmbed=e.images[0]?{url:e.images[0].url,type:i.IMAGE}:void 0,this.videoEmbed=e.videos[0]?{url:e.videos[0].url,type:i.VIDEO}:void 0,this.audioEmbed=e.audios[0]?{url:e.audios[0].url,type:i.AUDIO}:void 0,this.lienEmbed=e.urls[0]?{url:e.urls[0].url,label:e.urls[0].label,displayPreview:e.urls[0].displayPreview,bigPreview:e.urls[0].bigPreview,type:i.LIEN}:void 0,this.exerciseur=e.exerciseurs[0]?{url:e.exerciseurs[0].url,exerciseurType:e.exerciseurs[0].typeExerciseur,type:i.EXERCISEUR}:void 0,t&&(this.document=t),this.meta=e.meta}},function(e){e.LIEN="LIEN",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.FICHIER="FICHIER",e.EXERCISEUR="EXERCISEUR"}(i||(i={})),function(e){e.QUIZLET="QUIZLET",e.LEARNINGAPPS="LEARNINGAPPS",e.GENIALLY="GENIALLY",e.BOOKWIDGETS="BOOKWIDGETS",e.EDUPOOL="EDUPOOL",e.BELIN="BELIN"}(o||(t.ExerciseurType=o={})),function(e){e.ELEMENT="element",e.SECTION="section"}(s||(t.ElementType=s={})),function(e){e.BELIN="https://www.belin-education.com/"}(n||(t.Editeur=n={}))}},t={};!function i(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,i),n.exports}(9616)})();