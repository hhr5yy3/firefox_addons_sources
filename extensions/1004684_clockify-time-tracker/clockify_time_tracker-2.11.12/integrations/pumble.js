function moveElementUp(e,t){const n=e.getBoundingClientRect().top;e.style.top=n-t+"px"}function isElementInViewport(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function isMessageSystemMessage(e){return!!text(".join-left-message",e)}function getDescriptionFromMessage(e){handleEmojis(e);const t=$(".message-item__text > div",e)?.parentElement;return $(".message-item__text div > *",e)?t?.innerText?.trim():$(".message-call-attachment",e)?`Call: ${$(".call-participants__img-others-wrapper",e).getAttribute("aria-label")}`:void 0}function handleEmojis(e){if($(".clockify-extension",e))return;const t=$(".message-item__text div > *",e)?.parentElement;t&&Array.from($$("div > img",t)||[]).forEach((e=>{const t=e.getAttribute("data-image");if(!(t&&t.length<10))return;const n=e.getAttribute("data-image").replace(".png",""),i=String.fromCodePoint(parseInt(n,16)),s=createTag("span","clockify-extension",i);s.style.display="inline-block",s.style.height="0",s.style.width="0",s.style.overflow="hidden",e.after(s)}))}function initializeBodyObserver(){const e=new MutationObserver(applyManualInputStyles),t=document.body;e.observe(t,{attributes:!0})}function applyManualInputStyles(){const e=document.body.getAttribute("style").split("; ").find((e=>e.startsWith("--background"))).split(": ")[1];applyStyles("#ffffff"===e?".clockify-button-inactive { color: #444444 !important };":".clockify-button-inactive { color: #f5f4f3 !important; }","clockify-theme-dependent-styles")}clockifyButton.render(".message-options:not(.clockify)",{observe:!0},(e=>{const t=e.closest(".message-item");if(isMessageSystemMessage(t))return;const n=$("button:last-child",e),i=()=>getDescriptionFromMessage(t);if(!i)return;const s=clockifyButton.createButton({description:i,small:!0});s.classList.add("message-options__button"),n.before(s)})),clockifyButton.render(".context-menu:not(.clockify)",{observe:!0},(async e=>{const t=Array.from($$(".message-item")).find((({classList:e})=>e.contains("message-item--optionsOpen")));if(isMessageSystemMessage(t))return;if(!t)return;const n=createTag("div","context-menu-separator"),i=clockifyButton.createButton({description:()=>getDescriptionFromMessage(t)});i.style.display="block",i.classList.add("context-menu-item","context-menu-item--selectable"),e.append(n),e.append(i),await timeout({milliseconds:1e3}),isElementInViewport(e)||moveElementUp(e,35)})),initializeBodyObserver();