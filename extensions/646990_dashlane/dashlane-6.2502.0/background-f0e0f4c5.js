"use strict";(self.webpackChunk_dashlane_amphora=self.webpackChunk_dashlane_amphora||[]).push([[280],{55328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchABTestingVersionDetails=void 0;const o=r(95623),n=r(50884);t.fetchABTestingVersionDetails=(e,t)=>{const r=e.storeService,a={capacity:"",language:r.getPlatform().info.lang,platform:"real_website"};return t?.abTestForcedVersion&&(a.forceVersion3=t.abTestForcedVersion),e.wsService.premium.getABTestingVersionDetails(a).then((e=>{r.dispatch((0,n.saveABTestingInfo)(e))})).catch((e=>{o.default.error("Carbon init - Error while calling getABTestingVersionDetails: ",e)}))}},35673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(92082),n=r(72525),a=r(62627);t.config={commands:{participateToUserABTest:{handler:n.participateToUserABTest}},queries:{getUserABTestVariant:{selector:a.userABTestVariantSelector}},liveQueries:{liveUserABTestVariant:{operator:o.userABTestVariant$}}}},50884:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveABTestingInfo=t.SAVE_ABTESTING_INFO=void 0,t.SAVE_ABTESTING_INFO="SAVE_ABTESTING_INFO";t.saveABTestingInfo=e=>({type:t.SAVE_ABTESTING_INFO,data:Object.assign({},e)})},34007:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyABTesting=void 0;const o=r(50884);function n(){return{details:[],version:"control2016_all",success:null}}t.default=(e={details:[],version:"control2016_all",success:null},t)=>t.type===o.SAVE_ABTESTING_INFO?Object.assign({},e,{...t.data}):e,t.getEmptyABTesting=n},80755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(35673);t.bootstrap=e=>{e.register(o.config)}},8481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshUserABTest=void 0;const o=r(45127),n=r(41075),a=r(70252),i=r(30913),s=r(46298),c=r(43416),d=r(9272),l=r(25899);t.refreshUserABTest=async function(e,t,r){try{const o=(0,i.abTestsNamesSelector)(e.getState());if(0===o.length)return;const a=await(0,n.getAndEvaluateForUser)(e,r,{abtests:o});if((0,s.isApiError)(a))throw new Error(`Failed to refresh user AB tests: ${a}`);const u=(0,d.mapGetUserABServerResponse)(o,a.abtests);e.dispatch((0,c.refreshedUserABTests)(u)),(0,l.persistUserTests)(t,e)}catch(e){const t=new Error(`[ABTests] - refreshUserABTest: ${e}`);(0,a.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING})}}},21587:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(80755);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},92082:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariant$=void 0;const o=r(18948),n=r(3343),a=r(62627);t.userABTestVariant$=e=>(0,o.pipe)((0,n.map)((t=>(0,a.userABTestVariantSelector)(t,e))),(0,n.distinctUntilChanged)())},9272:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapGetUserABServerResponse=t.NOT_PARTICIPATING=void 0,t.NOT_PARTICIPATING="not-participating",t.mapGetUserABServerResponse=function(e,r){return e.reduce(((e,o)=>{const n=r.find((e=>o===e.name));return e[o]=n?{variant:n.variant,version:n.abtestVersion}:{variant:t.NOT_PARTICIPATING},e}),{})}},72525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.participateToUserABTest=void 0;const o=r(62627),n=r(9272),a=r(25899);t.participateToUserABTest=async function(e,t){const r=(0,o.userABTestSelector)(e.storeService.getState(),t);r&&n.NOT_PARTICIPATING!==r.variant&&(0,a.persistUserTests)(e.localStorageService.getInstance(),e.storeService)}},25899:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserTests=void 0;const o=r(25576),n=r(62627);t.persistUserTests=async function(e,t){if(t.getAccountInfo().persistData===o.PersistData.PERSIST_DATA_NO)return Promise.resolve();e&&await e.storeUserABTests((0,n.userABTestsSelector)(t.getState()))}},52346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(18216),n=r(55328),a=r(9486);t.setupSubscriptions=function(e,t){e.appInitialized.on((async e=>{if(e.initMode===o.InitMode.FirstInit){await(0,n.fetchABTestingVersionDetails)(t,{abTestForcedVersion:e.abTestForcedVersion});const r=t.storeService.getABTesting();(0,a.triggerABTestingChanged)(r)}}))}},39811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(95667),n=r(88544),a=r(71594);t.config={commands:{editContactInfo:{handler:o.editContactInfoHandler},refreshContactInfo:{handler:o.refreshContactInfoHandler}},queries:{getContactInfo:{selector:n.contactInfoSelector}},liveQueries:{liveContactInfo:{operator:a.contactInfo$}}}},1463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(39811);t.bootstrap=e=>{e.register(o.config)}},66650:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editContactInfoHandler=void 0;const o=r(45127),n=r(46298),a=r(16593),i={contact_email_required:o.EditContactInfoErrorCode.EMPTY_EMAIL,contact_phone_required:o.EditContactInfoErrorCode.UNKNOWN_ERROR,invalid_contact_email:o.EditContactInfoErrorCode.INVALID_EMAIL};t.editContactInfoHandler=async function(e,t){const{storeService:r,sessionService:s}=e,{user:c}=s.getInstance(),d=r.getState(),l=(0,a.userLoginSelector)(d);if(!r.isAuthenticated())return{success:!1,error:{code:o.EditContactInfoErrorCode.UNKNOWN_ERROR}};try{const e=await(0,n.updateContactInfo)(r,l,t);return(0,n.isApiError)(e)?{success:!1,error:{code:i[e.code]??o.EditContactInfoErrorCode.UNKNOWN_ERROR}}:(await c.refreshContactInfo(),{success:!0})}catch(e){return{success:!1,error:{code:o.EditContactInfoErrorCode.UNKNOWN_ERROR}}}}},95667:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.refreshContactInfoHandler=void 0,n(r(66650),t);var a=r(35870);Object.defineProperty(t,"refreshContactInfoHandler",{enumerable:!0,get:function(){return a.refreshContactInfoHandler}})},35870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshContactInfoHandler=void 0;const o=r(45127);t.refreshContactInfoHandler=async function(e){try{const{sessionService:t}=e,{user:r}=t.getInstance();return await r.refreshContactInfo(),{success:!0}}catch(e){return{success:!1,error:{code:o.RefreshContactInfoErrorCode.UNKNOWN_ERROR}}}}},64369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(1463);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},71594:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfo$=void 0;const o=r(18948),n=r(3343),a=r(88544);t.contactInfo$=()=>(0,o.pipe)((0,n.map)(a.contactInfoSelector),(0,n.distinctUntilChanged)())},88544:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactInfoSelector=void 0;t.contactInfoSelector=e=>e.userSession.accountContactInfo},71703:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAccountCreationController=t.encryptSettings=t.checkLogin=t.validateLoginForAccountCreation=void 0;const o=r(45127),n=r(70252),a=r(32074),i=r(39362),s=r(36513),c=r(43461),d=r(95551),l=r(7624),u=r(61259),p=r(95623),S=r(65675),m=r(16038),g=r(46298),y=/^[a-zA-Z0-9_.+@'\-{}]{5,128}.[A-Za-z]{2,24}$/;function A(e){return y.test(e)}async function f(e,t){p.default.log("AccountCreationController.checkLogin");const r="SSO_BLOCKED";if(!A(t))return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX};const n=await(0,g.requestAccountCreation)(e,{login:t});if((0,g.isApiError)(n)){if(n.code===r)return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_SSO_NON_PROVISIONED};throw new Error(`[AccountCreationController] - checkLogin: ${n.message} (${n.code})`)}if(n.ssoServiceProviderUrl)return e.dispatch((0,l.storeSSOSettings)({serviceProviderUrl:n.ssoServiceProviderUrl,isNitroProvider:n.ssoIsNitroProvider})),n.ssoIsNitroProvider?{accountCreationCode:o.AccountCreationCode.USER_NITRO_SSO_PROVISIONED,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted}:((0,u.triggerServiceProviderUrlRedirect)(e.getState(),t),{accountCreationCode:o.AccountCreationCode.USER_SSO_PROVISIONED,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted});switch(n.exists){case g.AccountExistsStatus.AccountExists:return{accountCreationCode:o.AccountCreationCode.USER_EXISTS,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted};case g.AccountExistsStatus.AccountDoesntExistInvalid:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_INVALID_MX,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted};case g.AccountExistsStatus.AccountDoesntExistUnlikely:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST_UNLIKELY_MX,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted};case g.AccountExistsStatus.AccountDoesntExist:default:return{accountCreationCode:o.AccountCreationCode.USER_DOESNT_EXIST,isProposedExpired:n.isProposedExpired,isUserProposed:n.isProposed,isUserAccepted:n.isAccepted}}}function E(e,t,r){return Promise.resolve().then((()=>{const o=e.getStore(),n=a.encryptSettings(e,t,r);o.dispatch((0,c.saveAccountSettings)(n));const i=(0,s.makeCryptoService)(),l={cryptoConfig:(0,S.parsePayload)(n.personalSettings.CryptoUserPayload).cryptoConfig,forceSalt:(0,m.base64ToBuffer)(n.personalSettings.CryptoFixedSalt)},u={promise:(0,d.generateRsaKeys)(t,i,l)};e.dispatch((0,c.saveAccountKeys)(u));return{encryptSettingsRequest:r,valid:!0}})).catch((e=>{const t=new Error(`[AccountCreation] - encryptSettings: ${e}`);throw p.default.error(t),(0,n.sendExceptionLog)({error:t}),t}))}t.validateLoginForAccountCreation=A,t.checkLogin=f,t.encryptSettings=E,t.makeAccountCreationController=function(e){return{checkLogin:t=>f(e.storeService,t),createAccount:t=>(e.storeService.dispatch((0,c.accountCreationStarted)({isSSO:!1})),e.sessionService.close(!1).then((()=>{e.masterPasswordEncryptorService.setInstance({raw:t.password},"");const{storeService:r,masterPasswordEncryptorService:o}=e;return E(r,o,t)}))),confirmAccountCreation:t=>function(e,t){return Promise.resolve().then((()=>{const r=e.storeService.getStore().getState().userSession.accountCreation.settings.personalSettings,o=e.storeService.getAccountCreation(),n=o.settings.promise;if(null===n)throw new Error("createAccount should be call before confirmAccountCreation");const a=o.accountKey.promise;if(null===a)throw new Error("createAccount should be call before confirmAccountCreation");return i.createAccount(e,t,n,r,a)})).catch((e=>{const t=new Error(`[AccountCreation] - confirmAccountCreation: ${e}`);throw p.default.error(t),(0,n.sendExceptionLog)({error:t}),t}))}(e,t)}}},32074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSettings=void 0;const o=r(63713),n=r(75270),a=r(56668),i=r(91301),s=r(16038),c=r(55623),d=r(12706),l=r(95648),u=r(78320),p=r(53);t.encryptSettings=function(e,t,r){const S=(0,u.generateItemUuid)(),m=(0,p.getUnixTimestamp)(),g=(0,c.getRandomValues)(16),y=e.getState(),A=(0,d.isSSOAccountCreationSelector)(y)?i.CRYPTO_NODERIVATION_HMAC64:a.ARGON2_DEFAULT_PAYLOAD,f={...(0,l.makeBasePersonalSettings)(),AnonymousUserId:r.anonymousUserId,UsagelogToken:S,Format:r.format,Language:r.language,SecurityEmail:r.login,RealLogin:r.login,accountCreationDatetime:m,SyncBackup:!0,CryptoFixedSalt:(0,s.bufferToBase64)(g),CryptoUserPayload:A},E=(0,n.getTransactionXml)(f),h={time:(0,p.getUnixTimestamp)(),backupDate:0,type:"SETTINGS",action:"BACKUP_EDIT",identifier:"SETTINGS_userId",content:E},v={forceSalt:g};return{personalSettings:f,promise:o.encryptSingleTransaction(t,h,v)}}},751:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOAccount=t.prepareRemoteDataEncryptionServices=void 0;const o=r(35088),n=r(45127),a=r(71703),i=r(39362),s=r(56915),c=r(56668),d=r(16038),l=r(64910),u=r(33769),p=r(69530),S=r(46298),m=r(70252),g=r(61259),y=r(16356),A=r(43461);t.prepareRemoteDataEncryptionServices=async(e,t)=>{const r=(0,o.v4)(),{remoteDataEncryptorService:n,masterPasswordEncryptorService:a}=e,i=await(0,p.generate64BytesKey)(),s=(0,d.base64BufferToText)(i),S=await(0,p.generate64BytesKey)(),m=(0,d.bufferToBase64)(S),g=(0,d.base64ToBuffer)(t),A=(0,u.getEncryptionKeyBuffer)(g,S,{skipDerivation:!0}),f=(0,d.arrayBufferToText)(A),E=(0,l.getNoDerivationCryptoConfig)();a.setInstance({raw:f},"",E);const h=(0,c.utf16ToDeflatedUtf8)(s,{skipUtf8Encoding:!0,skipDeflate:!0}),v=await a.getInstance().encrypt(h);return n.setInstance({raw:s},"",E),e.storeService.dispatch((0,y.updateRemoteKey)(s)),{remoteKey:{uuid:r,key:v,type:"sso"},serverKeyBase64:m}},t.createSSOAccount=async function(e,r){const{sessionService:o,storeService:c,remoteDataEncryptorService:d}=e,{consents:l,deviceName:u,login:p,ssoServiceProviderKey:m,ssoToken:g,anonymousUserId:E}=r,{appVersion:h,country:v,lang:T,platformName:_}=(0,s.platformInfoSelector)(c.getState());await o.close(!1),c.dispatch((0,A.accountCreationStarted)({isSSO:!0}));const{remoteKey:I,serverKeyBase64:C}=await(0,t.prepareRemoteDataEncryptionServices)(e,m),P={anonymousUserId:E,deviceName:u,format:v,language:T,login:p,password:m,subscribe:l.find((({consentType:e})=>"emailsOffersAndTips"===e)).status||!1};await(0,a.encryptSettings)(c,d,P);const D=c.getAccountCreation(),{content:O,time:b}=await D.settings.promise,w=await D.accountKey.promise,N=(0,S.makeSafeCountry)(c.getLocation().country||v);if("server_carbon_unknown"===_)throw new Error("Unexpected uninitialized platform info");const R={login:p,contactEmail:p,appVersion:h,sdkVersion:"1.0.0.0",platform:_,settings:{content:O,time:b},consents:l,deviceName:u,country:N,osCountry:N,language:(0,S.makeSafeLanguage)(T),osLanguage:(0,S.makeSafeLanguage)(T),remoteKeys:[I],ssoServerKey:C,ssoToken:g,sharingKeys:{publicKey:w.keys.publicKey,privateKey:w.encryptedPrivateKey},temporaryDevice:!0},M=await(0,S.createUserWithSSO)(c,R);if((0,S.isApiError)(M))return f(M);const L={createAccountResult:{encryptSettingsRequest:P,valid:!0},options:{flowIndicator:"memberAccount"},isStandAlone:!1,consents:l};return await(0,i.firstSync)(e,L,M,{useRemoteKey:!0}),e.storeService.dispatch((0,y.updateAnalyticsIds)(M.userAnalyticsId,M.deviceAnalyticsId)),{success:!0,code:n.LoginViaSsoCode.SUCCESS}};const f=e=>{const{code:t,message:r}=e;switch(E(t),t){case S.DomainNotValidForTeam:case S.InvalidUser:case S.InvalidSsoToken:case S.NotProposedNeitherAccepted:case S.NoFreeSlot:return(0,g.makeReturnErrorObject)(n.LoginViaSsoCode.SSO_VERIFICATION_FAILED,r);default:return(0,g.makeReturnErrorObject)(n.LoginViaSsoCode.UNKNOWN_ERROR,r)}},E=e=>{const t=new Error(`[createSSOAccount] - createUserWithSSO: ${e}`);(0,m.sendExceptionLog)({error:t})}},39362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.firstSync=t.createAccount=void 0;const o=r(45127),n=r(48062),a=r(37898),i=r(25963),s=r(25576),c=r(88610),d=r(16356),l=r(78320),u=r(1347),p=r(27517),S=r(19399),m=r(58582),g=r(60946),y=r(41007),A=r(92221),f=r(46298),E=r(92215),h=r(51064);async function v(e,t,r,d={useRemoteKey:!1}){const p=t.createAccountResult,{login:f}=p.encryptSettingsRequest,v=(0,l.generateItemUuid)(),T=(0,u.getEmptyPersonalDataState)();T.emails.push({Email:f,EmailName:"Email 1",Id:v,kwType:"KWEmail",LastBackupTime:0,LocaleFormat:o.Country.UNIVERSAL,SpaceId:"",Type:"PERSO"}),T.changesToUpload.push((0,h.createUploadChange)({action:"EDIT",itemId:v,kwType:"KWEmail"}));const{monitor:_}=(0,y.makeEventLoggerSyncMonitor)(),I=(0,g.setupProbe)(_,(0,A.makeSyncLoggerMonitor)()),C={accessKey:r.deviceAccessKey,secretKey:r.deviceSecretKey},P=(0,E.convertDeviceKeysToUki)(C),D=d.useRemoteKey?e.remoteDataEncryptorService:e.masterPasswordEncryptorService,O=Date.now(),b=a.SyncType.FULL_SYNC,w={storeService:e.storeService,dataEncryptorService:D,login:f,uki:P,lastSyncTimestamp:O,personalData:T,syncType:b,needsKeys:!1,ws:e.wsService,announce:I};let N=null;try{I(m.announcements.syncStarted(n.Trigger.AccountCreation,b),m.announcements.chronologicalSyncStarted(T)),N=await(0,i.sync)(w),I(m.announcements.chronologicalSyncFinished(N.summary),m.announcements.syncFinished())}catch(e){throw I(m.announcements.chronologicalSyncFailed(e),m.announcements.syncFailed(e)),e}if(t.isStandAlone){const t=(0,c.makeLoginController)(e);await t.loadAccountCreationInfos(f,p.encryptSettingsRequest.password,(0,S.secureDeviceName)(p.encryptSettingsRequest.deviceName),C,N.lastSyncTimestamp,s.PersistData.PERSIST_DATA_YES),await t.openSession(f,{password:p.encryptSettingsRequest.password})}}t.createAccount=async function(e,t,r,o,n){const a=e.storeService.getPlatform().info;if(!t.createAccountResult.valid)throw new Error("Account creation: Will not perform API request for invalidated settings promise");const[i,s]=await Promise.all([r,n]),c=await async function(e,t,r,o,n,a){const{storeService:i}=e,{createAccountResult:s}=r,c=e.storeService.getABTesting().version;let l=r.consents;Array.isArray(l)||(l=[{consentType:"emailsOffersAndTips",status:s.encryptSettingsRequest.subscribe}]);const u=s.encryptSettingsRequest.login;if("server_carbon_unknown"===t.platformName)throw new Error("Unexpected uninitialized platform info");const m={abTestingVersion:c,askM2dToken:!0,country:(0,f.makeSafeCountry)(e.storeService.getLocation().country||t.country),deviceName:(0,f.makeSafeDeviceName)((0,S.secureDeviceName)(s.encryptSettingsRequest.deviceName)),language:(0,f.makeSafeLanguage)(t.lang),login:u,osCountry:(0,f.makeSafeCountry)(t.country),osLanguage:(0,f.makeSafeLanguage)(t.lang),platform:t.platformName,settings:{content:n.content,time:n.time},appVersion:t.appVersion,contactEmail:u,consents:l,sharingKeys:{publicKey:a.keys.publicKey,privateKey:a.encryptedPrivateKey},temporaryDevice:!r.isStandAlone},g=await(0,f.createUser)(i,m);if((0,f.isApiError)(g))throw new Error(`[AccountCreation] - createAccountOnServer : ${g.message} (${g.code})`);return e.storeService.dispatch((0,d.updateIsFirstSessionAfterAccountCreation)()),e.storeService.dispatch((0,d.updateKeyPair)({publicKey:a.keys.publicKey,privateKey:a.keys.privateKey})),e.storeService.dispatch((0,p.loadStoredPersonalSettings)(o)),e.storeService.dispatch((0,d.updateAnalyticsIds)(g.userAnalyticsId,g.deviceAnalyticsId)),g}(e,a,t,o,i,s);await v(e,t,c);const l=(0,E.convertDeviceKeysToUki)({accessKey:c.deviceAccessKey,secretKey:c.deviceSecretKey});return{m2dToken:c.token,abtestingversion:c.abTestingVersion,uki:l,origin:c.origin,openSession:t.isStandAlone}},t.firstSync=v},65725:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingConfig=void 0;const o=r(48331);t.AntiPhishingConfig={commands:{},queries:{},liveQueries:{livePhishingURLList:{operator:o.antiPhishingURLList$}}}},26404:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAntiPhishingURLList=t.UPDATE_ANTI_PHISHING_URL_LIST=void 0,t.UPDATE_ANTI_PHISHING_URL_LIST="UPDATE_ANTI_PHISHING_URL_LIST";t.updateAntiPhishingURLList=e=>({type:t.UPDATE_ANTI_PHISHING_URL_LIST,phishingURLList:e})},56666:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(65725);t.bootstrap=e=>{e.register(o.AntiPhishingConfig)}},77820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REMOTE_PHISHING_FILE=void 0,t.REMOTE_PHISHING_FILE="phishing_urls_test.json"},25560:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(56666);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},48331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLList$=void 0;const o=r(18948),n=r(3343),a=r(68769);t.antiPhishingURLList$=()=>(0,o.pipe)((0,n.map)(a.antiPhishingURLListSelector),(0,n.distinctUntilChanged)())},69018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AntiPhishingReducer=t.getEmptyAntiPhishingState=void 0;const o=r(64658),n=r(26404);t.getEmptyAntiPhishingState=()=>new Set([]);t.AntiPhishingReducer=(e=(0,t.getEmptyAntiPhishingState)(),r)=>r.type===n.UPDATE_ANTI_PHISHING_URL_LIST?(0,o.areSetsEqual)(r.phishingURLList,e)?e:r.phishingURLList:e},68769:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.antiPhishingURLListSelector=void 0;t.antiPhishingURLListSelector=e=>e.device.antiPhishing},46564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(85318);t.setupSubscriptions=function(e,t){e.remoteFileChanged.on((e=>(0,o.triggerUpdatePhishingURLFile)(t,e)))}},85318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerUpdatePhishingURLFile=void 0;const o=r(70252),n=r(96405),a=r(26404),i=r(77820);const s=e=>{const t=(0,n.fileContentStrSelector)(e,i.REMOTE_PHISHING_FILE),r=t?JSON.parse(t):[];if(1!==(a=r).fileFormat||!Array.isArray(a.domains)){const e=new Error("[Anti-Phishing]: File format is invalid");return(0,o.sendExceptionLog)(e),null}var a;return{domains:new Set(r.domains),fileFormat:r.fileFormat}};t.triggerUpdatePhishingURLFile=function(e,t){const{storeService:r}=e,o=r.getState();if(t===i.REMOTE_PHISHING_FILE){const e=s(o);e&&r.dispatch((0,a.updateAntiPhishingURLList)(e.domains))}}},7036:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.connectLazySlot=void 0;const o=r(4939),n=["API","Live"];t.connectLazySlot=(e,t,r=!1)=>{const a=new Map;return e.lazy((i=>{r&&(0,o.logInfo)({message:`${e.slotName} subscribed on param ${i}`,tag:n});const s=t(i),c=((e,t,r,a)=>e?e=>((0,o.logInfo)({message:`Emitting on ${t.slotName} with param ${r}`,tag:n,details:{event:e}}),a(e)):a)(r,e,i,(t=>e(i,t).catch((()=>{})))),d=s.subscribe(c);a.set(i,d)}),(t=>{const i=a.get(t);i?(r&&(0,o.logInfo)({message:`${e.slotName} unsubscribed on param ${t}`,tag:n}),i.unsubscribe(),a.delete(t)):r&&(0,o.logWarn)({message:`Cannot unsubscribe from ${e.slotName} on param ${t}: subscription not found.`,tag:n})}))}},2246:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncAppSetting=t.setDataDEBUGONLY=t.decipherApplicationSettings=t.loadAppSettings=t.getCommonAppSettings=t.getCommonAppSetting=t.storeCommonAppSetting=t.getUsersWithPublicSettings=t.deleteUsersPublicSettings=t.getUserPublicSetting=t.storeUserPublicSetting=t.initApplicationSettings=void 0;const o=r(95623),n=r(72365),a=r(56668),i=r(1860),s=r(80722),c=r(2356),d=r(30913),l=r(18216);let u=null,p=null,S=null;function m(){if(!S)throw new Error("ApplicationSettings not initialized");const e=(0,d.commonApplicationSettingsSelector)(S.getState());return e||{}}t.initApplicationSettings=function(e,t,r,o){return u=e,p=o&&o.dataEncryptorService||(0,i.makeKeyDataEncryptorService)(),S=t,(0,n.setObfuscatingKey)(p),r===l.InitMode.FirstInit?(o?.settings&&t.dispatch((0,c.storeApplicationSettings)(o.settings)),A()):Promise.resolve()},t.storeUserPublicSetting=function(e,t,r){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.storeUserPublicSetting)(e,{[t]:r})),y()},t.getUserPublicSetting=function(e,t){if(!S)throw new Error("ApplicationSettings not initialized");const r=(0,d.userPublicSettingsSelector)(S.getState(),e);return r&&r.hasOwnProperty(t)?r[t]:null},t.deleteUsersPublicSettings=async function(e){if(!S)throw new Error("ApplicationSettings not initialized");return S.dispatch((0,c.deleteUserPublicSettings)(e)),y()},t.getUsersWithPublicSettings=function(){if(!S)throw new Error("ApplicationSettings not initialized");return Object.keys((0,d.publicUsersSettingsSelector)(S.getState()))},t.storeCommonAppSetting=function(e,t){return m()[e]=t,y()},t.getCommonAppSetting=function(e){const t=m();return t.hasOwnProperty(e)?(t[e],t[e]):null},t.getCommonAppSettings=m;const g="ApplicationSettings.cdata";function y(){if(!S||!u||!p)throw new Error("ApplicationSettings not initialized");const e=u.getLocalStorage(),t={publicUsersSettings:(0,d.publicUsersSettingsSelector)(S.getState()),commonApplicationSettings:(0,d.commonApplicationSettingsSelector)(S.getState())||{}},r=JSON.stringify(t),o=(0,a.utf16ToDeflatedUtf8)(r);return p.getInstance().encrypt(o).then((t=>e.writeItem(g,t))).then((()=>{}))}function A(){if(!u||!p)throw new Error("ApplicationSettings not initialized");const e=u.getLocalStorage();return e.itemExists(g).then((t=>t?e.readItem(g).then((e=>{if(null==e)throw new Error("storing empty or null value is not authorized");if("string"!=typeof e)throw new Error("value of ApplicationSettings.cdata is expected to be a string");return f(p,e).then((e=>JSON.parse(e))).then((e=>{E(e)}))})):E({publicUsersSettings:{},commonApplicationSettings:{}}))).catch((e=>{o.default.error(e,"loadAppSettings"),E({publicUsersSettings:{},commonApplicationSettings:{}})}))}function f(e,t){return e.getInstance().decrypt(t).then((e=>(0,a.deflatedUtf8ToUtf16)(e))).catch((()=>{const e=(0,n.makeDataEncryptorService)((0,s.makeStoreService)());return(0,n.setObfuscatingKey)(e),e.getInstance().decrypt(t).then((e=>(0,a.deflatedUtf8ToUtf16)(e)))}))}function E(e){if(!S)throw new Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))}t.loadAppSettings=A,t.decipherApplicationSettings=f,t.setDataDEBUGONLY=function(e){if(!S)throw new Error("ApplicationSettings not initialized");S.dispatch((0,c.storeApplicationSettings)(e))},t.getSyncAppSetting=function(e){const t=function(){if(!S)throw new Error("ApplicationSettings not initialized");return S.getState().device.application.settings.sync}();return t.hasOwnProperty(e)?t[e]:null}},30096:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdInitialized=t.APP_SESSION_ID_INITIALIZED=void 0,t.APP_SESSION_ID_INITIALIZED="APP_SESSION_ID_INITIALIZED";t.appSessionIdInitialized=e=>({type:t.APP_SESSION_ID_INITIALIZED,appSessionId:e})},10319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applicationReducer=t.getEmptyApplicationSessionState=void 0;const o=r(82422),n=r(59600),a=r(30096);t.getEmptyApplicationSessionState=()=>({appSessionId:void 0});t.applicationReducer=(0,o.combineReducers)({appSession:(e=(0,t.getEmptyApplicationSessionState)(),r)=>r.type===a.APP_SESSION_ID_INITIALIZED?{...e,appSessionId:r.appSessionId}:e,settings:n.default})},28486:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.appSessionIdSelector=void 0;t.appSessionIdSelector=e=>e.device.application.appSession.appSessionId},2356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUserPublicSettings=t.storeUserPublicSetting=t.storeApplicationSettings=t.DELETE_USER_PUBLIC_SETTINGS=t.STORE_USER_PUBLIC_SETTING=t.STORE_APPLICATION_SETTINGS=void 0,t.STORE_APPLICATION_SETTINGS="STORE_APPLICATION_SETTINGS",t.STORE_USER_PUBLIC_SETTING="STORE_USER_PUBLIC_SETTING",t.DELETE_USER_PUBLIC_SETTINGS="DELETE_USER_PUBLIC_SETTINGS";t.storeApplicationSettings=e=>({type:t.STORE_APPLICATION_SETTINGS,settings:e});t.storeUserPublicSetting=(e,r)=>({type:t.STORE_USER_PUBLIC_SETTING,login:e,userSettings:r});t.deleteUserPublicSettings=e=>({type:t.DELETE_USER_PUBLIC_SETTINGS,logins:e})},59600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyApplicationSettings=void 0;const o=r(2356);t.getEmptyApplicationSettings=()=>({sync:{syncWithLocalClients:!1},userABTestNames:[],migratedToSAEX:void 0,desktopLogin:void 0,publicUsersSettings:void 0,commonApplicationSettings:void 0}),t.default=(e=(0,t.getEmptyApplicationSettings)(),r)=>{switch(r.type){case o.STORE_APPLICATION_SETTINGS:return{...e,...r.settings||{}};case o.STORE_USER_PUBLIC_SETTING:{const t=r.login,o=e.publicUsersSettings??{},n={...o,[t]:{...o[t]??{},...r.userSettings}};return{...e,publicUsersSettings:n}}case o.DELETE_USER_PUBLIC_SETTINGS:{const t=r.logins,o=Object.keys(e.publicUsersSettings??{}),n=t.filter((e=>o.includes(e.trim())));return 0===n.length||n.forEach((t=>{const r=t.trim();delete e.publicUsersSettings[r]})),{...e}}default:return e}}},30913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commonApplicationSettingsSelector=t.publicUsersSettingsSelector=t.userPublicSettingsSelector=t.abTestsNamesSelector=void 0;const r={};t.abTestsNamesSelector=e=>e.device.application.settings.userABTestNames;t.userPublicSettingsSelector=(e,t)=>e.device.application.settings.publicUsersSettings?.[t];t.publicUsersSettingsSelector=e=>e.device.application.settings.publicUsersSettings??r;t.commonApplicationSettingsSelector=e=>e.device.application.settings.commonApplicationSettings},87855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ensureDeviceId=t.initAuthenticatedCarbonApplication=void 0;const o=r(35088),n=r(2246),a=r(17338),i=r(33007),s=r(70252),c=r(57366),d=r(86056),l=r(75125),u=r(69530),p=r(16038),S=r(18216);async function m(e,t,r,{platformInfo:a,settings:i}){try{console.log("[background/carbon] Initializing Carbon application settings"),(0,l.initializeAppSessionId)(e),(0,d.setPlatformInfo)(a),await(0,n.initApplicationSettings)(t,e,r,{settings:i}),await function(){if(!(0,n.getCommonAppSetting)("anonymousComputerId"))return(0,n.storeCommonAppSetting)("anonymousComputerId",(0,o.v4)())}(),await function(){if(!(0,n.getCommonAppSetting)("installationId"))return(0,n.storeCommonAppSetting)("installationId",(0,o.v4)());return Promise.resolve()}(),await async function(){if(!(0,n.getCommonAppSetting)("eventLoggerQueueKey")){const e=await(0,u.generate64BytesKey)(),t=(0,p.base64BufferToText)(e);return(0,n.storeCommonAppSetting)("eventLoggerQueueKey",t)}}()}catch(e){throw console.error("[background/carbon] Failed initializing Carbon application",e),e}}t.default=m;t.initAuthenticatedCarbonApplication=async(e,t,r)=>{r===S.InitMode.FirstInit&&await g(e,t);const{storageService:o,storeService:n}=(0,a.getCoreServices)(t);return await m(n,o,r,e),t},t.ensureDeviceId=async function(){let e=(0,n.getCommonAppSetting)("deviceId");return e||(await(0,n.storeCommonAppSetting)("deviceId",(0,o.v4)().replace(/-/g,"")),e=(0,n.getCommonAppSetting)("deviceId")),e};const g=async(e,t)=>{try{console.log("[background/carbon] Initializing SDK authentication");const r=(0,a.getCoreServices)(t),{storeService:o}=r;e.anonymousPartnerId&&o.dispatch((0,i.loadAnonymousPartnerId)(e.anonymousPartnerId)),await(0,c.initAuthentication)(r,e.keys)}catch(e){console.error("[background/carbon] Failed initializing SDK authentication",e);const t=new Error(`[Application] - setSdkAuthentication: ${e}`);(0,s.sendExceptionLog)({error:t})}}},86056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setPlatformInfo=t.getPlatformInfo=void 0;const o=r(9149);let n=Object.assign({},o.defaultPlatformInfo);t.getPlatformInfo=function(){return n},t.setPlatformInfo=function(e){n=Object.assign({},o.defaultPlatformInfo,e)}},75125:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApplicationSessionId=t.initializeAppSessionId=void 0;const o=r(96997),n=r(28486),a=r(30096);function i(e){return(0,n.appSessionIdSelector)(e.getState())}t.initializeAppSessionId=function(e){i(e)||function(e,t){e.dispatch((0,a.appSessionIdInitialized)(t))}(e,(0,o.default)())},t.getApplicationSessionId=i},2646:(e,t)=>{let r;Object.defineProperty(t,"__esModule",{value:!0}),t.getPublicPath=t.setPublicPath=void 0;t.setPublicPath=e=>{if("string"!=typeof e)throw new Error("[Assets] - setPublicPath: provided public path is not a string.");r=e};t.getPublicPath=()=>{if(!r)throw new Error("[Assets] - getPublicPath: trying to access public path before it was set.");return r}},3158:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(91178),n=r(53325),a=r(81404),i=r(36592),s=r(54622),c=r(21107),d=r(56915),l=r(3914),u=r(55636),p=r(63229),S=r(94881);t.config={commands:{registerDevice:{handler:u.registerDeviceHandler},requestEmailToken:{handler:c.requestEmailToken},requestPaymentUpdateAuthenticationToken:{handler:c.requestPaymentUpdateAuthenticationToken},setReactivationStatus:{handler:l.setReactivationStatusHandler},disableAutologin:{handler:p.disableAutologin},openSessionWithMasterPassword:{handler:S.openSessionWithMasterPasswordHandler},...o.config.commands,...n.config.commands,...a.config.commands,...i.config.commands},queries:{getHasOtp2Type:{selector:d.hasOtp2TypeSelector},getUserOtpType:{selector:d.otpTypeSelector},getLocalAccounts:{selector:d.localAccountsListSelector},getReactivationStatus:{selector:d.reactivationStatusSelector},...o.config.queries,...n.config.queries,...a.config.queries,...i.config.queries},liveQueries:{liveReactivationStatus:{operator:s.reactivationStatus$},...o.config.liveQueries,...n.config.liveQueries,...a.config.liveQueries,...i.config.liveQueries}}},63229:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableAutologin=void 0;const o=r(98226),n=r(56915),a=r(61740);t.disableAutologin=async function({storeService:e,localStorageService:t}){const r=(0,n.rememberMeTypeSelector)(e.getState());return["autologin","sso"].includes(r)?(await t.getInstance().cleanAuthenticationKey(),await(0,a.persistLocalAccountRememberMeType)(e,"disabled"),e.dispatch((0,o.setRememberMeTypeAction)("disabled")),Promise.resolve()):Promise.resolve()}},75226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalAccounts=void 0;const o=r(2246),n=r(56915),a=r(63739),i=r(61740),s=r(95623),c=r(70252);t.getLocalAccounts=async function(e,t){const r=(0,o.getUsersWithPublicSettings)(),d={},l=["localSettings","personalData","personalSettings"];return Promise.all(r.map((async r=>{const o=(0,n.getUserDeviceWasRegisteredWithDeviceKeysSelector)(e.getState(),r),i=[...l,...o?["authentication"]:[]],s=(await Promise.all(i.map((e=>(0,a.isDataStored)(t,r,e))))).every((e=>e));d[r]=s}))).then((()=>r.filter((e=>d[e])))).then((e=>{const t=e.map((e=>({login:e,lastLoginTime:(0,o.getUserPublicSetting)(e,"lastSuccessfulLoginTime")||0}))).sort(((e,t)=>{const r=e.lastLoginTime,o=t.lastLoginTime;return r>o?-1:r<o?1:0}))[0];return e.map((e=>({login:e,hasLoginOtp:(0,o.getUserPublicSetting)(e,"otp2")||!1,isLastSuccessfulLogin:t&&t.login===e,rememberMeType:(0,i.getLocalAccountRememberMeType)(e)??void 0,shouldAskMasterPassword:(0,i.shouldAskMasterPassword)(e)}))).sort(((e,t)=>{const r=e.login.toLowerCase(),o=t.login.toLowerCase();return r.localeCompare(o)}))})).catch((e=>{const t=`get-local-accounts: ${e}`,r=new Error(t);return(0,s.logError)({message:t,details:{error:r}}),(0,c.sendExceptionLog)({error:r}),[]}))}},37864:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenForKwUser=void 0;const o=r(46298);t.getTokenForKwUser=async(e,t)=>{const{storeService:r}=e,n=await(0,o.getTokens)(r);if((0,o.isApiError)(n))throw new Error(`Error: ${n.code}`);const{tokens:a}=n,i=a.find((e=>e.login===t));if(!i)throw new Error("Email token not found for "+t);return i.token}},21107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=t.requestEmailToken=void 0;var o=r(95626);Object.defineProperty(t,"requestEmailToken",{enumerable:!0,get:function(){return o.requestEmailToken}});var n=r(17717);Object.defineProperty(t,"requestPaymentUpdateAuthenticationToken",{enumerable:!0,get:function(){return n.requestPaymentUpdateAuthenticationToken}})},57366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAuthentication=void 0;const o=r(95623),n=r(33007),a=r(69763),i=r(46298);t.initAuthentication=async(e,t)=>{s(e,t),c(e,t),await(0,a.loadLocalUsersAuthenticationDataFromStorage)(e),await d(e)};const s=(e,t)=>{const{storeService:r}=e;r.dispatch((0,n.saveAppKeys)({accessKey:t.appAccess,secretKey:t.appSecret}))},c=(e,t)=>{const{storeService:r}=e;r.dispatch((0,n.saveStyxKeys)({accessKey:t.styxAccess,secretKey:t.styxSecret}))},d=async e=>{const{storeService:t}=e;try{const e=await(0,i.getRemoteTime)(t);if((0,i.isApiError)(e))throw e;t.dispatch((0,n.saveDashlaneServerDeltaTimestamp)(e.timestamp))}catch(e){(0,o.logDebug)({tag:["Auth"],message:"Error while calling getRemoteTime",details:{error:e}})}}},14498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadRememberMeTypeToStore=void 0;const o=r(98226),n=r(61740),a=r(16593);t.loadRememberMeTypeToStore=function(e){const{storeService:t}=e,r=(0,a.userLoginSelector)(t.getState()),i=(0,n.getLocalAccountRememberMeType)(r);i&&t.dispatch((0,o.setRememberMeTypeAction)(i))}},94881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithMasterPasswordHandler=void 0;const o=r(88610);t.openSessionWithMasterPasswordHandler=function(e,t){return(0,o.makeLoginController)(e).openSessionWithMasterPassword(t.login,t.password,{rememberMasterPassword:t.rememberPassword,requiredPermissions:t.requiredPermissions,serverKey:t.serverKey,loginType:t.loginType})}},55636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerDeviceHandler=void 0;const o=r(70414),n=r(1965);t.registerDeviceHandler=async function({storeService:e,storageService:t,moduleClients:r,sessionService:a},i){await a.close(!1),await(0,n.wipeOutLocalAccounts)(t,r["carbon-legacy"],[i.login]),await(0,o.registerDevice)(e,i)}},17717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPaymentUpdateAuthenticationToken=void 0;const o=r(90622),n=r(46298),a=r(16593),i=r(27885),s=r(32924),c=r(1577);t.requestPaymentUpdateAuthenticationToken=async function(e){try{const{storeService:t}=e,r=t.getState(),d=(0,a.userLoginSelector)(r);if(!(0,a.isAuthenticatedSelector)(r))return{success:!1};const l=await(0,s.getAuthenticationTokenForCardUpdate)(t,d);if((0,n.isApiError)(l))return{success:!1};const u=(0,i.getCurrentTeamId)(r.userSession.spaceData),p=(0,i.isTeamAdminInCurrentSpace)(r.userSession.spaceData),S=(0,i.isBillingAdminInCurrentSpace)(r.userSession.spaceData),m={login:d,uki:(0,o.ukiSelector)(r),teamId:u};let g,y={};if(u&&(p||S)){const e={name:"teamPlans",version:1};if(g=await(0,c.NewCardToken)(m,e),200!==g.code)return{success:!1};y={customerId:g.content.customerId,tokenId:g.content.tokenId}}let A={};const f={name:"premium",version:3},E=await(0,c.NewCardToken)(m,f);return 200!==E.code?{success:!1}:(A={customerId:E.content.customerId,tokenId:E.content.tokenId},{success:!0,accessKey:l.accessKey,creationDateUnix:l.creationDateUnix,expirationDateUnix:l.expirationDateUnix,secretKey:l.secretKey,livemode:l.livemode,b2bPaymentTokens:y,b2cPaymentTokens:A})}catch(e){return{success:!1}}}},95626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestEmailToken=void 0;const o=r(45127),n=r(46298),a=r(16593);t.requestEmailToken=async function(e){try{const{storeService:t}=e,r=t.getState(),o=(0,a.userLoginSelector)(r);if(!o)throw new Error("[emailToken] - askServerToSendToken: no current authenticated user");await(0,n.requestEmailTokenVerification)(t,{login:o})}catch(e){return{success:!1,error:{code:o.EmailTokenApiError,message:e.message}}}return{success:!0}}},3914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setReactivationStatusHandler=void 0;const o=r(9344);t.setReactivationStatusHandler=function({storeService:e},{reactivationStatus:t}){return e.dispatch((0,o.reactivationStatusUpdated)(t)),Promise.resolve()}},6231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistUserAuthenticationData=t.loadUserAuthenticationData=void 0;const o=r(56915),n=r(98226),a=r(39408);t.loadUserAuthenticationData=async(e,t)=>{let r;try{const t=e.getInstance();if(!await t.hasAuthenticationData())return Promise.resolve({type:"success"});r=await t.getAuthenticationData()}catch(e){return Promise.resolve({type:"failed",message:a.FailedToReadParseOrValidateAuthenticationData,error:e})}try{t.dispatch((0,n.rehydrateUserAuthenticationData)(r))}catch(e){return Promise.resolve({type:"failed",message:a.FailedToRehydrateAuthenticationData,error:e})}return Promise.resolve({type:"success"})};t.persistUserAuthenticationData=async(e,t)=>{const r=(0,o.userAuthenticationDataSelector)(t.getState()),n=e.getInstance();await n.storeAuthenticationData(r)}},69763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadLocalUsersAuthenticationDataFromStorage=t.persistLocalUsersAuthenticationData=void 0;const o=r(72365),n=r(50058),a=r(70252),i=r(95623),s=r(92263),c=r(56915),d=r(16038),l=r(1860),u=r(56668),p=r(93513),S="authentication.localusers";t.persistLocalUsersAuthenticationData=async(e,t)=>{try{const r=e.getLocalStorage(),n=(0,l.makeKeyDataEncryptorService)();(0,o.setObfuscatingKey)(n);const a=(0,c.localUsersAuthenticationDataSelector)(t.getState()),i=JSON.stringify(a),s=(0,d.utf8ChunkEncode)(i),m=p.encode(s),g=(0,u.utf16ToDeflatedUtf8)(m,{skipUtf8Encoding:!0}),y=await n.getInstance().encrypt(g);await r.writeItem(S,y)}catch(e){const t="Auth",r=s.CarbonError.fromAnyError(e).addContextInfo(t,"persistLocalUsersAuthenticationData");(0,i.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,a.sendExceptionLog)({error:r})}};t.loadLocalUsersAuthenticationDataFromStorage=async e=>{try{const{storageService:t,storeService:r}=e,a=t.getLocalStorage(),i=(0,o.makeDataEncryptorService)(r);(0,o.setObfuscatingKey)(i);const s=await a.readItem(S);if(!s)return;if("string"!=typeof s)throw new Error("value of authentication.localusers is expected to be a string");const c=await i.getInstance().decrypt(s),l=(0,u.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0}),m=p.decode(l);let g=m;try{g=(0,d.utf8ChunkDecode)(m)}catch(e){}const y=JSON.parse(g);r.dispatch((0,n.loadLocalUsersAuthenticationData)(y))}catch(e){const t="Auth",r=s.CarbonError.fromAnyError(e).addContextInfo(t,"loadLocalUsersAuthenticationDataFromStorage");(0,i.logError)({tag:[t],message:`${r}`,details:{error:e}}),(0,a.sendExceptionLog)({error:r})}}},39408:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLoadAuthenticationSuccess=t.FailedToRehydrateAuthenticationData=t.FailedToReadParseOrValidateAuthenticationData=void 0,t.FailedToReadParseOrValidateAuthenticationData="Failed to read, parse or validate persisted data",t.FailedToRehydrateAuthenticationData="Failed to rehydrate";t.isLoadAuthenticationSuccess=e=>"object"==typeof e&&"success"===e.type},43739:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deviceRegistered=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.DEVICE_REGISTERED=void 0,t.DEVICE_REGISTERED="DEVICE_REGISTERED";t.makeLegacyDeviceRegistrationKey=e=>({type:"uki",uki:e});t.makeDeviceRegistrationKeys=(e,t)=>({type:"deviceKeys",deviceAccessKey:e,deviceSecretKey:t});t.deviceRegistered=(e,r,o)=>({type:t.DEVICE_REGISTERED,registrationType:e,persistData:r,login:o})},98226:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setRememberMeTypeAction=t.rehydrateUserAuthenticationData=t.SET_REMEMBER_ME_TYPE=t.REHYDRATE_USER_AUTHENTICATION_DATA=void 0,t.REHYDRATE_USER_AUTHENTICATION_DATA="REHYDRATE_USER_AUTHENTICATION_DATA",t.SET_REMEMBER_ME_TYPE="SET_REMEMBER_ME_TYPE";t.rehydrateUserAuthenticationData=e=>({type:t.REHYDRATE_USER_AUTHENTICATION_DATA,data:e});t.setRememberMeTypeAction=e=>({type:t.SET_REMEMBER_ME_TYPE,rememberMeType:e})},99932:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyCurrentUserAuthentication=t.currentUserAuthenticationReducer=void 0;const o=r(48313),n=r(98226),a=r(43739);t.currentUserAuthenticationReducer=(e=(0,t.getEmptyCurrentUserAuthentication)(),r)=>{switch(r.type){case o.CLOSE_SESSION:return(0,t.getEmptyCurrentUserAuthentication)();case a.DEVICE_REGISTERED:if("deviceKeys"===r.registrationType.type){const{deviceAccessKey:t,deviceSecretKey:o}=r.registrationType;return{...e,deviceKeys:{accessKey:t,secretKey:o}}}return e;case n.REHYDRATE_USER_AUTHENTICATION_DATA:return{...e,...r.data};case n.SET_REMEMBER_ME_TYPE:return{...e,rememberMeType:r.rememberMeType};default:return e}};t.getEmptyCurrentUserAuthentication=()=>({deviceKeys:null,rememberMeType:null})},52653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.updateLocalUserInfo=t.makeDeviceRegistrationKeys=t.makeLegacyDeviceRegistrationKey=t.deviceRegistered=void 0;var o=r(43739);Object.defineProperty(t,"deviceRegistered",{enumerable:!0,get:function(){return o.deviceRegistered}}),Object.defineProperty(t,"makeLegacyDeviceRegistrationKey",{enumerable:!0,get:function(){return o.makeLegacyDeviceRegistrationKey}}),Object.defineProperty(t,"makeDeviceRegistrationKeys",{enumerable:!0,get:function(){return o.makeDeviceRegistrationKeys}});var n=r(50058);Object.defineProperty(t,"updateLocalUserInfo",{enumerable:!0,get:function(){return n.updateLocalUserInfo}});var a=r(57334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return a.authenticationReducer}})},9344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusUpdated=t.localAccountsListUpdated=void 0;const o=r(52968);t.localAccountsListUpdated=e=>({type:o.LOCAL_ACCOUNTS_LIST_UPDATED,localAccounts:e});t.reactivationStatusUpdated=e=>({type:o.REACTIVATION_STATUS_UPDATED,reactivationStatus:e})},83803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.localAccountsAuthenticationReducer=t.getEmptyLocalAccountsAuthenticationState=void 0;const o=r(52968);t.getEmptyLocalAccountsAuthenticationState=()=>({accountsList:[],accountsListInitialized:!1,reactivationStatus:o.ReactivationStatus.CLASSIC});t.localAccountsAuthenticationReducer=(e=(0,t.getEmptyLocalAccountsAuthenticationState)(),r)=>{switch(r.type){case o.LOCAL_ACCOUNTS_LIST_UPDATED:return{...e,accountsList:r.localAccounts,accountsListInitialized:!0};case o.REACTIVATION_STATUS_UPDATED:return{...e,reactivationStatus:r.reactivationStatus};default:return e}}},52968:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.REACTIVATION_STATUS_UPDATED=t.LOCAL_ACCOUNTS_LIST_UPDATED=t.ReactivationStatus=void 0,function(e){e.DISABLED="DISABLED",e.CLASSIC="CLASSIC",e.WEBAUTHN="WEBAUTHN"}(t.ReactivationStatus||(t.ReactivationStatus={})),t.LOCAL_ACCOUNTS_LIST_UPDATED="LOCAL_ACCOUNTS_LIST_UPDATED",t.REACTIVATION_STATUS_UPDATED="REACTIVATION_STATUS_UPDATED"},50058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalUserAuthenticationAction=t.updateLocalUserInfo=t.loadLocalUsersAuthenticationData=t.UPDATE_LOCAL_USER_INFO=t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE=void 0;const o=r(43739);t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE="LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE",t.UPDATE_LOCAL_USER_INFO="UPDATE_LOCAL_USER_INFO";t.loadLocalUsersAuthenticationData=e=>({type:t.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE,data:e});t.updateLocalUserInfo=(e,r)=>({type:t.UPDATE_LOCAL_USER_INFO,login:e,data:r});t.isLocalUserAuthenticationAction=e=>e.type===o.DEVICE_REGISTERED},76156:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalUsersAuthentication=t.localUsersAuthenticationReducer=void 0;const o=r(62433),n=r(50058),a=r(43739),i=r(17825);t.localUsersAuthenticationReducer=(e=(0,t.getEmptyLocalUsersAuthentication)(),r)=>{if((0,n.isLocalUserAuthenticationAction)(r)){const t=s(e[r.login],r);return t?{...e,[r.login]:t}:(0,o.omit)([r.login],e)}switch(r.type){case n.LOAD_LOCAL_USERS_AUTH_DATA_FROM_STORAGE:return{...e,...r.data};case n.UPDATE_LOCAL_USER_INFO:const t=c();return{...e,[r.login]:{...t,...e[r.login],...r.data}};default:return e}};t.getEmptyLocalUsersAuthentication=()=>({});const s=(e,t)=>{const r=e||c();if(t.type!==a.DEVICE_REGISTERED)return e;{const{registrationType:e}=t;switch(e.type){case"deviceKeys":{const{deviceAccessKey:t}=e;return{...r,deviceAccessKey:t,deviceRegisteredWithLegacyKey:!1}}case"uki":return{...r,deviceRegisteredWithLegacyKey:!0};default:(0,i.assertUnreachable)(e)}}},c=()=>({deviceAccessKey:null,deviceRegisteredWithLegacyKey:!1,ssoActivatedUser:!1})},57334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authenticationReducer=t.getEmptyAuthenticationState=void 0;const o=r(82422),n=r(99932),a=r(83803),i=r(76156),s=r(82677),c=r(96171),d=r(88272);t.getEmptyAuthenticationState=()=>({currentUser:(0,n.getEmptyCurrentUserAuthentication)(),localAccounts:(0,a.getEmptyLocalAccountsAuthenticationState)(),localUsers:(0,i.getEmptyLocalUsersAuthentication)(),u2f:(0,s.getEmptyU2FAuthenticationState)(),webAuthnAuthentication:(0,d.getEmptyWebAuthnAuthentication)(),twoFactorAuthentication:(0,c.getEmptyTwoFactorAuthenticationState)()}),t.authenticationReducer=(0,o.combineReducers)({currentUser:n.currentUserAuthenticationReducer,localAccounts:a.localAccountsAuthenticationReducer,localUsers:i.localUsersAuthenticationReducer,u2f:s.u2fAuthenticationReducer,webAuthnAuthentication:d.webAuthnAuthenticationReducer,twoFactorAuthentication:c.TwoFactorAuthenticationReducer})},72355:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fDevicesUpdated=t.U2F_DEVICES_UPDATED=void 0,t.U2F_DEVICES_UPDATED="U2F_DEVICES_UPDATED";t.u2fDevicesUpdated=e=>({type:t.U2F_DEVICES_UPDATED,devices:e})},82677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.u2fAuthenticationReducer=t.getEmptyU2FAuthenticationState=void 0;const o=r(72355);t.getEmptyU2FAuthenticationState=()=>({u2fDevices:[]});t.u2fAuthenticationReducer=(e=(0,t.getEmptyU2FAuthenticationState)(),r)=>r.type===o.U2F_DEVICES_UPDATED?{...e,u2fDevices:r.devices}:e},8246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAvailableAuthenticatorsListUpdated=t.webAuthnAuthenticatorsListUpdated=t.webAuthnAuthenticatorRemoved=t.webAuthnAuthenticatorAdded=t.webAuthnUserIdUpdated=t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED=t.WEBAUTHN_AUTHENTICATOR_REMOVED=t.WEBAUTHN_AUTHENTICATOR_ADDED=t.WEBAUTHN_USERID_UPDATED=void 0,t.WEBAUTHN_USERID_UPDATED="WEBAUTHN_USERID_UPDATED",t.WEBAUTHN_AUTHENTICATOR_ADDED="WEBAUTHN_AUTHENTICATOR_ADDED",t.WEBAUTHN_AUTHENTICATOR_REMOVED="WEBAUTHN_AUTHENTICATOR_REMOVED",t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AUTHENTICATORS_LIST_UPDATED",t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED="WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED";t.webAuthnUserIdUpdated=e=>({type:t.WEBAUTHN_USERID_UPDATED,webAuthnUserId:e});t.webAuthnAuthenticatorAdded=e=>({type:t.WEBAUTHN_AUTHENTICATOR_ADDED,authenticator:e});t.webAuthnAuthenticatorRemoved=e=>({type:t.WEBAUTHN_AUTHENTICATOR_REMOVED,credentialId:e});t.webAuthnAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED,authenticatorsList:e});t.webAuthnAvailableAuthenticatorsListUpdated=e=>({type:t.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED,availableAuthenticatorsList:e})},88272:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationReducer=t.getEmptyWebAuthnAuthentication=void 0;const o=r(8246);t.getEmptyWebAuthnAuthentication=()=>({webAuthnUserId:null,authenticators:[]});t.webAuthnAuthenticationReducer=(e=(0,t.getEmptyWebAuthnAuthentication)(),r)=>{switch(r.type){case o.WEBAUTHN_USERID_UPDATED:return{...e,webAuthnUserId:r.webAuthnUserId};case o.WEBAUTHN_AUTHENTICATOR_ADDED:return{...e,authenticators:[...e.authenticators,r.authenticator]};case o.WEBAUTHN_AUTHENTICATOR_REMOVED:{const t=e.authenticators.filter((e=>e.credentialId!==r.credentialId));return{...e,authenticators:t}}case o.WEBAUTHN_AUTHENTICATORS_LIST_UPDATED:return{...e,authenticators:r.authenticatorsList};case o.WEBAUTHN_AVAILABLE_AUTHENTICATORS_LIST_UPDATED:{const t=r.availableAuthenticatorsList.map((e=>e.credentialId)),o=e.authenticators.map((e=>t.includes(e.credentialId)?{...e,canOpenSession:!0}:{...e,canOpenSession:!1}));return{...e,authenticators:o}}default:return e}}},36592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(43037),n=r(5689),a=r(24797),i=r(87463);t.config={commands:{refreshTwoFactorAuthenticationInfo:{handler:a.refreshTwoFactorAuthenticationInfoHandler},...i.config.commands},queries:{getTwoFactorAuthenticationInfo:{selector:n.twoFactorAuthenticationInfoSelector},...i.config.queries},liveQueries:{liveTwoFactorAuthenticationInfo:{operator:o.twoFactorAuthenticationInfo$},...i.config.liveQueries}}},81404:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(54120),n=r(18099),a=r(95475);t.config={commands:{startTwoFactorAuthenticationDisableFlow:{handler:o.startTwoFactorAuthenticationDisableFlow},continueTwoFactorAuthenticationDisableFlow:{handler:o.continueTwoFactorAuthenticationDisableFlow},backTwoFactorAuthenticationDisableFlow:{handler:o.backTwoFactorAuthenticationDisableFlow},stopTwoFactorAuthenticationDisableFlow:{handler:o.stopTwoFactorAuthenticationDisableFlow}},queries:{getTwoFactorAuthenticationDisableStage:{selector:n.getTwoFactorAuthenticationDisableStageData}},liveQueries:{liveTwoFactorAuthenticationDisableStage:{operator:a.twoFactorAuthenticationDisableFlow$}}}},44787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;const o=r(4478);t.updateTwoFactorAuthenticationStage=e=>({type:o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:e});t.stopTwoFactorAuthenticationStage=()=>({type:o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE,data:{stage:void 0}})},4478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW=t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE",t.STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW="STOP_TWO_FACTOR_AUTHENTICATION_DISABLE_FLOW"},51554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var o=r(44787);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.stopTwoFactorAuthenticationStage}});var n=r(98259);Object.defineProperty(t,"twoFactorAuthenticationDisableFlow",{enumerable:!0,get:function(){return n.twoFactorAuthenticationDisableFlow}})},98259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow=t.getEmptyTwoFactorAuthenticationDisable=void 0;const o=r(4478);t.getEmptyTwoFactorAuthenticationDisable=()=>({stage:void 0});t.twoFactorAuthenticationDisableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationDisable)(),r)=>r.type===o.UPDATE_TWO_FACTOR_AUTHENTICATION_DISABLE_STAGE?{...e,...r.data}:e},18099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationDisableFlowData=t.getTwoFactorAuthenticationDisableStageData=void 0;const o=r(46474);t.getTwoFactorAuthenticationDisableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationDisableFlow,r=o.TwoFactorAuthenticationDisableFlowConfig?.[t]?.viewMapper;return{stage:t,viewData:r?r(e):void 0}};t.getTwoFactorAuthenticationDisableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationDisableFlow;return t}},46474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationDisableFlowStages=t.TwoFactorAuthenticationDisableFlowConfig=void 0;const o=r(45127),n=r(73714),a=r(24216),i=r(18747),s=r(46796);t.TwoFactorAuthenticationDisableFlowConfig={start:{storeMapper:n.startTwoFactorAuthenticationDisableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:n.endTwoFactorAuthenticationDisableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:n.endTwoFactorAuthenticationDisableStoreMapper},[o.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE]:{currentHandler:a.disableTwoFactorAuthenticationCodeHandler,viewMapper:i.disableTwoFactorAuthenticationCodeViewMapper},[o.TwoFactorAuthenticationDisableStages.BACKUP_CODE]:{currentHandler:a.disableTwoFactorAuthenticationCodeHandler,viewMapper:i.disableTwoFactorAuthenticationBackupCodeViewMapper},[o.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED]:{currentHandler:a.disableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationDisableFlowStages=[{stage:o.TwoFactorAuthenticationDisableStages.CONFIRMATION},{stage:o.TwoFactorAuthenticationDisableStages.AUTHENTICATION_CODE},{stage:o.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES},{stage:o.TwoFactorAuthenticationDisableStages.SUCCESS}]},54120:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationDisableFlow=t.continueTwoFactorAuthenticationDisableFlow=t.stopTwoFactorAuthenticationDisableFlow=t.startTwoFactorAuthenticationDisableFlow=void 0;const o=r(46474),n=r(51554),a=e=>{const{stage:t}=e.getState().userSession.twoFactorAuthenticationDisableFlow;return{currentIndex:o.TwoFactorAuthenticationDisableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationDisableFlow=({storeService:e})=>{const{storeMapper:t}=o.TwoFactorAuthenticationDisableFlowConfig.start,r=t?t(e):void 0,a=(0,n.updateTwoFactorAuthenticationStage)({...r,stage:o.TwoFactorAuthenticationDisableFlowStages[0].stage});return e.dispatch(a),Promise.resolve({success:!0})};t.stopTwoFactorAuthenticationDisableFlow=e=>{const{storeService:t}=e;t.dispatch((0,n.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:a}=o.TwoFactorAuthenticationDisableFlowConfig.stop,i=a?a(t):void 0;return r?r(e,i):Promise.resolve({success:!0})};const i=(e,t,r,o)=>{const{storeService:n}=e;return t(e,r?r(n):void 0,o)},s=({storeService:e},t)=>{const{currentIndex:r}=a(e);if(r!==o.TwoFactorAuthenticationDisableFlowStages.length-1){const a=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationDisableFlowStages[r+1].stage});e.dispatch(a)}return Promise.resolve({success:!0})},c=({storeService:e},t)=>{const{currentIndex:r}=a(e);if(0!==r){const a=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationDisableFlowStages[r-1].stage});e.dispatch(a)}return Promise.resolve({success:!0})},d=e=>{const{currentStage:t}=a(e);let r,n=s,i=c;if(o.TwoFactorAuthenticationDisableFlowConfig[t]){const e=o.TwoFactorAuthenticationDisableFlowConfig[t];i=e.backHandler||i,n=e.currentHandler||n,r=e.storeMapper}return{currentHandler:n,backHandler:i,storeMapper:r}};t.continueTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:o,storeMapper:n}=d(r);return i(e,o,n,t)};t.backTwoFactorAuthenticationDisableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:o,storeMapper:n}=d(r);return i(e,o,n,t)}},95475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationDisableFlow$=void 0;const o=r(18948),n=r(3343),a=r(18099);t.twoFactorAuthenticationDisableFlow$=()=>(0,o.pipe)((0,n.map)(a.getTwoFactorAuthenticationDisableStageData),(0,n.distinctUntilChanged)())},24216:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationLogoutRequiredHandler=t.disableTwoFactorAuthenticationCodeHandler=void 0;const o=r(45127),n=r(51554),a=r(46796),i=r(5689),s=r(71291),c=r(18099),d=r(16593),l=r(1965),u={[o.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:a.disableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[o.TwoFactorAuthenticationType.LOGIN]:{handler:a.disableTwoFactorAuthenticationTOTP2Handler,showLoading:!0}};t.disableTwoFactorAuthenticationCodeHandler=async(e,t,r)=>{const d=r.target;if(d){const{storeService:r}=e,o=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:d,stageData:void 0});return r.dispatch(o),{success:!0}}return await(async(e,t,r)=>{const{storeService:d}=e,l=e=>{const t=(0,n.updateTwoFactorAuthenticationStage)({...e});d.dispatch(t)};try{const p=(0,c.getTwoFactorAuthenticationDisableFlowData)(d.getState()),S=(0,i.twoFactorAuthenticationInfoSelector)(d.getState());if(S.status===o.TwoFactorAuthenticationInfoRequestStatus.READY){const{type:i}=S,{authenticationCode:c}=r,m=await(0,s.performTotpVerificationService)(e,c);if(m.success){const{authTicket:r}=m;if(u[i]){const{handler:s,showLoading:c}=u[i];c&&l({...t,stage:o.TwoFactorAuthenticationDisableStages.FINALIZING_CHANGES});const S=await s(e,r);if(S.success)if(S.logoutRequired){const e={...p,logoutRequired:S.logoutRequired};l({...t,stage:o.TwoFactorAuthenticationDisableStages.LOGOUT_REQUIRED,flowData:e})}else await(0,a.refreshTwoFactorAuthenticationInfoHandler)(e),l({...t,stage:o.TwoFactorAuthenticationDisableStages.SUCCESS}),d.dispatch((0,n.stopTwoFactorAuthenticationStage)());else l({...t,stage:o.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{...S}})}else l({...t,stage:o.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:o.AuthenticationCode.UNEXPECTED_OTP_TYPE}}})}else l({...t,stageData:m})}else l({...t,stage:o.TwoFactorAuthenticationDisableStages.GENERIC_ERROR,stageData:{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}})}catch(e){l({...t,stageData:{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}})}return{success:!0}})(e,t,r)};t.disableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:o,moduleClients:a}=e,i=(0,d.userLoginSelector)(t.getState());return t.dispatch((0,n.stopTwoFactorAuthenticationStage)()),i&&await(0,l.wipeOutLocalAccounts)(r,a["carbon-legacy"],[i]),await o.close(),{success:!0}}},73714:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationDisableStoreMapper=t.startTwoFactorAuthenticationDisableStoreMapper=void 0;const o=r(56915);t.startTwoFactorAuthenticationDisableStoreMapper=e=>{const t=e.getState();return{stage:void 0,stageData:void 0,flowData:{otpType:(0,o.otpTypeSelector)(t)}}};t.endTwoFactorAuthenticationDisableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},18747:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationBackupCodeViewMapper=t.disableTwoFactorAuthenticationCodeViewMapper=void 0;const o=r(45127);t.disableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return{success:!1,error:e}}};t.disableTwoFactorAuthenticationBackupCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationDisableFlow;if(t&&!t.success){const{error:e}=t;return e.code===o.AuthenticationCode.OTP_NOT_VALID?{success:!1,error:{code:o.AuthenticationCode.BACKUP_CODE_NOT_VALID}}:{success:!1,error:e}}}},53325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(17303),n=r(69631),a=r(66574);t.config={commands:{startTwoFactorAuthenticationEnableFlow:{handler:o.startTwoFactorAuthenticationEnableFlow},continueTwoFactorAuthenticationEnableFlow:{handler:o.continueTwoFactorAuthenticationEnableFlow},backTwoFactorAuthenticationEnableFlow:{handler:o.backTwoFactorAuthenticationEnableFlow},stopTwoFactorAuthenticationEnableFlow:{handler:o.stopTwoFactorAuthenticationEnableFlow}},queries:{getTwoFactorAuthenticationEnableStage:{selector:n.getTwoFactorAuthenticationEnableStageData}},liveQueries:{liveTwoFactorAuthenticationEnableStage:{operator:a.twoFactorAuthenticationEnableFlow$}}}},44527:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesHandler=void 0;const o=r(45127),n=r(15441),a=r(69631);t.enableTwoFactorAuthenticationBackupCodesHandler=async(e,t)=>{const{storeService:r}=e,i=(0,a.getTwoFactorAuthenticationEnableFlowData)(r.getState());return(0,n.updateStore)(e,{...t,stage:i.logoutRequired?o.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED:o.TwoFactorAuthenticationEnableStages.SUCCESS}),{success:!0}}},72387:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupPhoneHandler=void 0;const o=r(45127),n=r(46298),a=r(15441),i=r(69631),s=r(71291);t.enableTwoFactorAuthenticationBackupPhoneHandler=async(e,t,r)=>{const{storeService:c}=e;let d=(0,i.getTwoFactorAuthenticationEnableFlowData)(c.getState());const l=await(0,s.requestTOTPActivationService)(e,{...r,country:(0,n.makeSafeCountry)(r.countryCode)});if(l.success){const{seed:n,uri:i,recoveryKeys:s,serverKey:c}=l,{authenticationType:u}=d;u===o.TwoFactorAuthenticationType.LOGIN&&(d[o.TwoFactorAuthenticationType.LOGIN].serverKey=c),d={...d,seed:n,uri:i,recoveryKeys:s},(0,a.updateStore)(e,{...t,stageData:{...l},flowData:{...d,savedValues:{...d?.savedValues,savedCountryCode:r.countryCode,savedPhoneNumber:r.phoneNumber}},stage:o.TwoFactorAuthenticationEnableStages.QR_CODE})}else(0,a.updateStore)(e,{...t,stageData:{...l}});return Promise.resolve({success:!0})}},14732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationCodeHandler=void 0;const o=r(45127),n=r(15441),a=r(69631),i=r(86370),s=r(52284),c=r(46796),d=r(71291),l={[o.TwoFactorAuthenticationType.DEVICE_REGISTRATION]:{handler:i.enableTwoFactorAuthenticationTOTP1Handler,showLoading:!1},[o.TwoFactorAuthenticationType.LOGIN]:{handler:s.enableTwoFactorAuthenticationTOTP2Handler,showLoading:!0,errorStage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}};t.enableTwoFactorAuthenticationCodeHandler=async(e,t,{authenticationCode:r})=>{const{storeService:i}=e;try{const s=(0,a.getTwoFactorAuthenticationEnableFlowData)(i.getState()),{authenticationType:u}=s,p=await(0,d.performTotpVerificationService)(e,r,!0);if(!p.success)return(0,n.updateStore)(e,{...t,stageData:p}),{success:!1};if(l[u]){const{authTicket:r}=p,a=s[u],{handler:i,showLoading:d,errorStage:S}=l[u];d&&(0,n.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES});const m=await i(e,r,a);if(m.success){m.logoutRequired||await(0,c.refreshTwoFactorAuthenticationInfoHandler)(e);const r={...s,logoutRequired:m.logoutRequired};(0,n.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.BACKUP_CODES,flowData:r})}else(0,n.updateStore)(e,{...t,stage:S?o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR:o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE,stageData:{...m}})}else(0,n.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR,stageData:{success:!1}});return{success:!0}}catch(r){return(0,n.updateStore)(e,{...t,stageData:{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}}),{success:!1}}}},68513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationLogoutRequiredHandler=void 0;const o=r(16593),n=r(1965),a=r(19546);t.enableTwoFactorAuthenticationLogoutRequiredHandler=async e=>{const{storeService:t,storageService:r,sessionService:i,moduleClients:s}=e,c=(0,o.userLoginSelector)(t.getState());return t.dispatch((0,a.stopTwoFactorAuthenticationStage)()),c&&await(0,n.wipeOutLocalAccounts)(r,s["carbon-legacy"],[c]),await i.close(),{success:!0}}},33778:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTypeHandler=void 0;const o=r(45127),n=r(57903),a=r(19546),i=r(69631),s=r(15441),c=r(16194),d=r(16593),l=r(46298),u=r(61984),p=r(48062),S=r(45127);t.enableTwoFactorAuthenticationTypeHandler=async(e,t,{authenticationType:r})=>{const{storeService:m}=e,g=(0,i.getTwoFactorAuthenticationEnableFlowData)(m.getState());if(r===S.TwoFactorAuthenticationType.LOGIN)try{const i=(0,a.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationEnableStages.LOADING});m.dispatch(i);const{eventLoggerService:y}=e,A=m.getState(),f=(0,d.userLoginSelector)(A);if(!f)return(0,s.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});if(!await(0,n.waitUntilSyncComplete)(m))return(0,s.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR}),Promise.resolve({success:!1});m.dispatch((0,c.changeMPStart)());const E=await(0,l.getDataForMasterPasswordChange)(m,f,{});if((0,l.isApiError)(E))(0,u.logChangeMasterPasswordError)(y,p.ChangeMasterPasswordError.DownloadError),m.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR});else{const{data:{transactions:e,sharingKeys:n},timestamp:i}=E,s=(0,a.updateTwoFactorAuthenticationStage)({...t,flowData:{...g,authenticationType:r,[S.TwoFactorAuthenticationType.LOGIN]:{transactions:e,sharingKeys:n,timestamp:i,serverKey:""},savedValues:{...g?.savedValues,savedAuthenticationType:r}},stage:o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});m.dispatch(s)}}catch(r){m.dispatch((0,c.changeMPDone)()),(0,s.updateStore)(e,{...t,stage:o.TwoFactorAuthenticationEnableStages.GENERIC_ERROR})}else{const e=(0,a.updateTwoFactorAuthenticationStage)({...t,flowData:{...g,authenticationType:r,savedValues:{...g?.savedValues,savedAuthenticationType:r}},stage:o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE});m.dispatch(e)}return Promise.resolve({success:!0})}},46667:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(14732),t),n(r(72387),t),n(r(33778),t),n(r(44527),t),n(r(68513),t)},48277:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE=void 0,t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE="UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE";t.updateTwoFactorAuthenticationStage=e=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:e});t.stopTwoFactorAuthenticationStage=()=>({type:t.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE,data:{stage:void 0}})},19546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationStage=t.updateTwoFactorAuthenticationStage=void 0;var o=r(48277);Object.defineProperty(t,"updateTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.updateTwoFactorAuthenticationStage}}),Object.defineProperty(t,"stopTwoFactorAuthenticationStage",{enumerable:!0,get:function(){return o.stopTwoFactorAuthenticationStage}});var n=r(15896);Object.defineProperty(t,"twoFactorAuthenticationEnableFlow",{enumerable:!0,get:function(){return n.twoFactorAuthenticationEnableFlow}})},15896:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow=t.getEmptyTwoFactorAuthenticationEnable=void 0;const o=r(48277);t.getEmptyTwoFactorAuthenticationEnable=()=>({stage:void 0});t.twoFactorAuthenticationEnableFlow=(e=(0,t.getEmptyTwoFactorAuthenticationEnable)(),r)=>r.type===o.UPDATE_TWO_FACTOR_AUTHENTICATION_ENABLE_STAGE?{...e,...r.data}:e},69631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationEnableFlowData=t.getTwoFactorAuthenticationEnableStageData=void 0;const o=r(13610);t.getTwoFactorAuthenticationEnableStageData=e=>{const{stage:t}=e.userSession.twoFactorAuthenticationEnableFlow,r=o.TwoFactorAuthenticationEnableFlowConfig?.[t]?.viewMapper,n=e.userSession.twoFactorAuthenticationEnableFlow?.flowData?.savedValues;return{stage:t,viewData:r?r(e):void 0,savedValues:n}};t.getTwoFactorAuthenticationEnableFlowData=e=>{const{flowData:t}=e.userSession.twoFactorAuthenticationEnableFlow;return t}},13610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationEnableFlowStages=t.TwoFactorAuthenticationEnableFlowConfig=void 0;const o=r(45127),n=r(62669),a=r(58206),i=r(46667),s=r(46796);t.TwoFactorAuthenticationEnableFlowConfig={start:{storeMapper:n.startTwoFactorAuthenticationEnableStoreMapper},stop:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:n.endTwoFactorAuthenticationEnableStoreMapper},end:{currentHandler:s.endTwoFactorAuthenticationHandler,storeMapper:n.endTwoFactorAuthenticationEnableStoreMapper},[o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE]:{currentHandler:i.enableTwoFactorAuthenticationTypeHandler,viewMapper:a.enableTwoFactorAuthenticationTypeViewMapper},[o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE]:{currentHandler:i.enableTwoFactorAuthenticationBackupPhoneHandler,viewMapper:a.enableTwoFactorAuthenticationBackupPhoneViewMapper},[o.TwoFactorAuthenticationEnableStages.QR_CODE]:{viewMapper:a.enableTwoFactorAuthenticationQRCodeViewMapper},[o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE]:{currentHandler:i.enableTwoFactorAuthenticationCodeHandler,viewMapper:a.enableTwoFactorAuthenticationCodeViewMapper},[o.TwoFactorAuthenticationEnableStages.BACKUP_CODES]:{currentHandler:i.enableTwoFactorAuthenticationBackupCodesHandler,viewMapper:a.enableTwoFactorAuthenticationBackupCodesViewMapper},[o.TwoFactorAuthenticationEnableStages.LOGOUT_REQUIRED]:{currentHandler:i.enableTwoFactorAuthenticationLogoutRequiredHandler}},t.TwoFactorAuthenticationEnableFlowStages=[{stage:o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_TYPE},{stage:o.TwoFactorAuthenticationEnableStages.BACKUP_PHONE},{stage:o.TwoFactorAuthenticationEnableStages.QR_CODE},{stage:o.TwoFactorAuthenticationEnableStages.AUTHENTICATION_CODE},{stage:o.TwoFactorAuthenticationEnableStages.FINALIZING_CHANGES},{stage:o.TwoFactorAuthenticationEnableStages.BACKUP_CODES},{stage:o.TwoFactorAuthenticationEnableStages.SUCCESS}]},17303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backTwoFactorAuthenticationEnableFlow=t.continueTwoFactorAuthenticationEnableFlow=t.stopTwoFactorAuthenticationEnableFlow=t.startTwoFactorAuthenticationEnableFlow=void 0;const o=r(13610),n=r(19546),a=e=>e.userSession.twoFactorAuthenticationEnableFlow,i=e=>{const{stage:t}=a(e.getState());return{currentIndex:o.TwoFactorAuthenticationEnableFlowStages.findIndex((e=>e.stage===t)),currentStage:t}};t.startTwoFactorAuthenticationEnableFlow=({storeService:e})=>{const{storeMapper:t}=o.TwoFactorAuthenticationEnableFlowConfig.start,r=t?t(e):void 0,a=(0,n.updateTwoFactorAuthenticationStage)({...r,stage:o.TwoFactorAuthenticationEnableFlowStages[0].stage});return e.dispatch(a),Promise.resolve({success:!0})};t.stopTwoFactorAuthenticationEnableFlow=e=>{const{storeService:t}=e;t.dispatch((0,n.stopTwoFactorAuthenticationStage)());const{currentHandler:r,storeMapper:a}=o.TwoFactorAuthenticationEnableFlowConfig.stop,i=a?a(t):void 0;return r?r(e,i):Promise.resolve({success:!0})};const s=(e,t,r,o)=>{const{storeService:n}=e;return t(e,r?r(n):void 0,o)},c=({storeService:e},t)=>{const{currentIndex:r}=i(e);if(r!==o.TwoFactorAuthenticationEnableFlowStages.length-1){const a=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationEnableFlowStages[r+1].stage});e.dispatch(a)}return Promise.resolve({success:!0})},d=({storeService:e},t)=>{const{currentIndex:r}=i(e);if(0!==r){const a=(0,n.updateTwoFactorAuthenticationStage)({...t,stage:o.TwoFactorAuthenticationEnableFlowStages[r-1].stage});e.dispatch(a)}return Promise.resolve({success:!0})},l=e=>{const{currentStage:t}=i(e);let r,n=c,a=d;if(o.TwoFactorAuthenticationEnableFlowConfig[t]){const e=o.TwoFactorAuthenticationEnableFlowConfig[t];a=e.backHandler||a,n=e.currentHandler||n,r=e.storeMapper}return{currentHandler:n,backHandler:a,storeMapper:r}};t.continueTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{currentHandler:o,storeMapper:n}=l(r);return s(e,o,n,t)};t.backTwoFactorAuthenticationEnableFlow=(e,t)=>{const{storeService:r}=e,{backHandler:o,storeMapper:i}=l(r);return(e=>{const t=a(e.getState()),r=(0,n.updateTwoFactorAuthenticationStage)({...t,stageData:void 0});e.dispatch(r)})(r),s(e,o,i,t)}},15441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateStore=void 0;const o=r(19546);t.updateStore=({storeService:e},t)=>{const r=(0,o.updateTwoFactorAuthenticationStage)({...t});e.dispatch(r)}},66574:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationEnableFlow$=void 0;const o=r(18948),n=r(3343),a=r(69631);t.twoFactorAuthenticationEnableFlow$=()=>(0,o.pipe)((0,n.map)(a.getTwoFactorAuthenticationEnableStageData),(0,n.distinctUntilChanged)())},62669:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationEnableStoreMapper=t.startTwoFactorAuthenticationEnableStoreMapper=void 0;t.startTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0});t.endTwoFactorAuthenticationEnableStoreMapper=()=>({stage:void 0,stageData:void 0,flowData:void 0})},58206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationBackupCodesViewMapper=t.enableTwoFactorAuthenticationCodeViewMapper=t.enableTwoFactorAuthenticationQRCodeViewMapper=t.enableTwoFactorAuthenticationBackupPhoneViewMapper=t.enableTwoFactorAuthenticationTypeViewMapper=void 0;const o=r(46298);t.enableTwoFactorAuthenticationTypeViewMapper=()=>({currentStep:1,totalSteps:5});t.enableTwoFactorAuthenticationBackupPhoneViewMapper=e=>{const t=(0,o.makeSafeCountry)(e.device.platform.location.country),{stageData:r}=e.userSession.twoFactorAuthenticationEnableFlow;return{currentStep:2,totalSteps:5,countryCode:t,...r}};t.enableTwoFactorAuthenticationQRCodeViewMapper=e=>{const{uri:t,seed:r}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:3,totalSteps:5,uri:t,seed:r}};t.enableTwoFactorAuthenticationCodeViewMapper=e=>{const{stageData:t}=e.userSession.twoFactorAuthenticationEnableFlow;if(t){const{error:t}=e.userSession.twoFactorAuthenticationEnableFlow.stageData;return{currentStep:4,totalSteps:5,error:t}}return{currentStep:4,totalSteps:5}};t.enableTwoFactorAuthenticationBackupCodesViewMapper=e=>{const{recoveryKeys:t}=e.userSession.twoFactorAuthenticationEnableFlow.flowData;return{currentStep:5,totalSteps:5,recoveryKeys:t}}},6836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthStatusError=t.TwoFactorAuthStatusRequested=t.TwoFactorAuthStatusUpdated=t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR=t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED=t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED=void 0,t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED="TWO_FACTOR_AUTHENTICATION_INFO_UPDATED",t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED="TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED",t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR="TWO_FACTOR_AUTHENTICATION_INFO_ERROR";t.TwoFactorAuthStatusUpdated=e=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED,info:e});t.TwoFactorAuthStatusRequested=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED});t.TwoFactorAuthStatusError=()=>({type:t.TWO_FACTOR_AUTHENTICATION_INFO_ERROR})},96171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TwoFactorAuthenticationReducer=t.getEmptyTwoFactorAuthenticationState=void 0;const o=r(45127),n=r(6836),a=r(16478);t.getEmptyTwoFactorAuthenticationState=()=>({status:o.TwoFactorAuthenticationInfoRequestStatus.UNKNOWN});t.TwoFactorAuthenticationReducer=(e=(0,t.getEmptyTwoFactorAuthenticationState)(),r)=>{const i=r?.info?.type;switch(r.type){case n.TWO_FACTOR_AUTHENTICATION_INFO_REQUESTED:return{status:o.TwoFactorAuthenticationInfoRequestStatus.PENDING};case n.TWO_FACTOR_AUTHENTICATION_INFO_ERROR:return{status:o.TwoFactorAuthenticationInfoRequestStatus.ERROR};case n.TWO_FACTOR_AUTHENTICATION_INFO_UPDATED:return{...r.info,isTwoFactorAuthenticationEnabled:a.TwoFactorAuthenticationEnabled.includes(i),status:o.TwoFactorAuthenticationInfoRequestStatus.READY};default:return e}}},87463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(40970),n=r(70245),a=r(60262),i=r(24217);t.config={commands:{removeU2FAuthenticator:{handler:o.removeU2FAuthenticatorHandler},refreshU2FDevicesList:{handler:n.refreshU2FDevicesListHandler}},queries:{getU2FDevicesList:{selector:i.listU2FDevicesSelector}},liveQueries:{liveU2FDevicesList:{operator:a.listU2FDevices$}}}},70245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshU2FDevicesListHandler=void 0;const o=r(45127),n=r(46298),a=r(16593),i=r(72355);t.refreshU2FDevicesListHandler=async e=>{try{const{storeService:t}=e,r=t.isAuthenticated,s=(0,a.userLoginSelector)(t.getState());if(!s||!r)return{success:!1,error:{code:o.RefreshU2FErrorCode.UNKNOWN_ERROR}};const c=await(0,n.getU2FDevices)(t,s);return(0,n.isApiError)(c)?{success:!1,error:{code:o.RefreshU2FErrorCode.UNKNOWN_ERROR}}:(t.dispatch((0,i.u2fDevicesUpdated)(c.u2fDevices)),{success:!0})}catch(e){return{success:!1,error:{code:o.RefreshU2FErrorCode.UNKNOWN_ERROR}}}}},40970:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticatorHandler=void 0;const o=r(45127),n=r(14656),a=r(92263),i=r(46298),s=r(70252),c=r(16593),d=r(28287),l=r(70245);t.removeU2FAuthenticatorHandler=async(e,t)=>{try{const{storeService:r}=e,n=r.getState(),a=r.isAuthenticated,s=(0,c.userLoginSelector)(n);if(!s||!a)return{success:!1,error:{code:o.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}};const{authenticationCode:u,keyHandle:p}=t,S=await(0,i.performTotpVerification)(r,{login:s,otp:u});if((0,i.isApiError)(S))return(0,d.handlePerformValidationError)(S,!0);const{authTicket:m}=S,g=await(0,i.removeU2FAuthenticator)(r,s,{authTicket:m,keyHandle:p});return(0,i.isApiError)(g)?{success:!1,error:{code:o.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}:(await(0,l.refreshU2FDevicesListHandler)(e),{success:!0})}catch(e){const t=a.CarbonError.fromAnyError(e).addContextInfo("U2F","removeU2FAuthenticatorHandler");return(0,s.sendExceptionLog)({error:t}),{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===n.HttpErrorCode.NETWORK_ERROR?o.AuthenticationCode.NETWORK_ERROR:o.RemoveU2FAuthenticatorError.UNKNOWN_ERROR}}}}},60262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevices$=void 0;const o=r(18948),n=r(3343),a=r(24217);t.listU2FDevices$=()=>(0,o.pipe)((0,n.map)(a.listU2FDevicesSelector),(0,n.distinctUntilChanged)())},24217:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listU2FDevicesSelector=void 0;t.listU2FDevicesSelector=e=>e.authentication.u2f.u2fDevices},16478:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=t.TwoFactorAuthenticationEnabled=void 0;const o=r(45127);t.TwoFactorAuthenticationEnabled=[o.TwoFactorAuthenticationType.DEVICE_REGISTRATION,o.TwoFactorAuthenticationType.LOGIN,o.TwoFactorAuthenticationType.SSO],t.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL=36e5},9819:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP1Handler=void 0;const o=r(45127),n=r(46298);t.disableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>{const{storeService:r}=e,{login:a}=r.getAccountInfo(),i=await(0,n.deactivateTotpVerification)(r,a,{authTicket:t});return(0,n.isApiError)(i)?{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}:{success:!0}}},99445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableTwoFactorAuthenticationTOTP2Handler=void 0;const o=r(45127),n=r(61740),a=r(46298),i=r(33740),s=r(57903),c=r(16194),d=r(16593),l=r(16356),u=r(47820);t.disableTwoFactorAuthenticationTOTP2Handler=async(e,t)=>{const{moduleClients:r,storeService:p,masterPasswordEncryptorService:S,sessionService:m,storageService:g}=e,y=p.getState(),A=(0,d.userLoginSelector)(y);try{if(!A)throw new Error("2FA Disable Flow - Login not available");if((0,d.isRemoteKeyActivatedSelector)(y))throw console.error("Disable 2FA unavailable: RK account"),new Error("2FA Disable Flow - Unavailable due to RemoteKey Account");if(!await(0,s.waitUntilSyncComplete)(p))return{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_SYNC_ERROR}};p.dispatch((0,c.changeMPStart)()),await r.session.commands.prepareLocalDataFlush();const f=await(0,a.getDataForMasterPasswordChange)(p,A,{});if((0,a.isApiError)(f))throw new Error("2FA Disable Flow - Unable to getDataForMasterPasswordChange");const E=(0,d.serverKeySelector)(y);if(!(0,i.isOtpStatusValid)(f.otpStatus,E))throw new Error("2FA Disable Flow - OTP status is invalid");const{timestamp:h}=f,{transactions:v,sharingKeys:T}=f.data,_=await(0,i.deCipherAllTransactions)(m,S,v,!1),I=p.getUserSession().masterPassword,C=e.localStorageService.getInstance(),P=await C.doesLocalKeyExist();let D=null;P&&(D=await C.getLocalKey());const{publicKey:O}=T,b=await(0,i.decipherPrivateKey)(p,S,T);await(0,n.cleanRememberMeStorageData)(p,g,r.session);const w="",N=(0,i.returnProperCryptoConfig)(p);S.setInstance({raw:I},w,N),p.dispatch((0,l.updateServerKey)(w)),await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,d.userLoginSelector)(p.getState()),sessionKey:{type:"mp",masterPassword:(0,d.masterPasswordSelector)(p.getState()),secondaryKey:w}});const R={type:"email_token"};p.dispatch((0,l.updateRemoteKey)(null));const M=await(0,i.cipherTransactionWithNewMP)(p,m,S,_,null,!1),L=await(0,i.cipherPrivateKey)(S,b),U={timestamp:h,transactions:(0,i.formatTransaction)(M),updateVerification:R,sharingKeys:{publicKey:O,privateKey:L},authTicket:t},k=await(0,a.uploadDataForMasterPasswordChange)(p,A,U);if((0,a.isApiError)(k))throw(0,i.revertOnError)(e,S,{currentPassword:I,serverKey:E}),new Error("2FA Disable Flow - Unable to uploadDataForMasterPasswordChange");D&&await m.getInstance().user.persistLocalKey(D),await r.session.commands.flushLocalData(),await(0,u.storeSessionCredentialForRecovery)(p,e.localStorageService)}catch(e){return p.dispatch((0,c.changeMPDone)()),{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}}let f=!0;try{const e=await(0,a.confirmMasterPasswordChangeDone)(p,A,{});if((0,a.isApiError)(e))throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone");f=!1}catch(e){throw new Error("2FA Disable Flow - Failed to confirmMasterPasswordChangeDone")}return p.dispatch((0,c.changeMPDone)()),{success:!0,logoutRequired:f}}},86370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP1Handler=void 0;const o=r(35823);t.enableTwoFactorAuthenticationTOTP1Handler=async(e,t)=>await(0,o.completeTotpActivationHandler)(e,t)},52284:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableTwoFactorAuthenticationTOTP2Handler=void 0;const o=r(45127),n=r(61740),a=r(46298),i=r(33740),s=r(16593),c=r(47820),d=r(16194),l=r(16356);t.enableTwoFactorAuthenticationTOTP2Handler=async(e,t,r)=>{const{timestamp:u,transactions:p,sharingKeys:S,serverKey:m}=r;if(!m)throw new Error("[2FA - Enable] - Empty server key");const{moduleClients:g,storeService:y,masterPasswordEncryptorService:A,sessionService:f,storageService:E}=e,h=y.getState();if((0,s.isRemoteKeyActivatedSelector)(h))return console.error("Enable 2FA unavailable: RK account"),{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}};await g.session.commands.prepareLocalDataFlush();const v=(0,s.userLoginSelector)(h);if(!v)return{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}};const T=e.localStorageService.getInstance();let _=null;await T.doesLocalKeyExist()&&(_=await T.getLocalKey());try{const r=await(0,i.deCipherAllTransactions)(f,A,p,!1),{publicKey:o}=S,d=await(0,i.decipherPrivateKey)(y,A,S);await(0,n.cleanRememberMeStorageData)(y,E,g.session);const h={type:"totp_login",serverKey:m},T=(0,i.returnProperCryptoConfig)(y),I=y.getUserSession().masterPassword;A.setInstance({raw:I},m,T);const C=await(0,i.cipherTransactionWithNewMP)(y,f,A,r,null,!1),P=await(0,i.cipherPrivateKey)(A,d),D={timestamp:u,transactions:(0,i.formatTransaction)(C),updateVerification:h,sharingKeys:{publicKey:o,privateKey:P},authTicket:t},O=await(0,a.uploadDataForMasterPasswordChange)(y,v,D);if((0,a.isApiError)(O))throw new Error("2FA Enable Flow - Unable to uploadDataForMasterPasswordChange");y.dispatch((0,l.updateServerKey)(m)),await g.session.commands.updateUserSessionKey({email:(0,s.userLoginSelector)(y.getState()),sessionKey:{type:"mp",masterPassword:(0,s.masterPasswordSelector)(y.getState()),secondaryKey:m}}),_&&await f.getInstance().user.persistLocalKey(_),await g.session.commands.flushLocalData(),await(0,c.storeSessionCredentialForRecovery)(y,e.localStorageService),await g.pinCode.commands.deactivate()}catch(t){return(e=>{const{storeService:t,masterPasswordEncryptorService:r,remoteDataEncryptorService:o}=e,n=t.getState(),a=(0,s.isRemoteKeyActivatedSelector)(n)?o:r,c=t.getUserSession().masterPassword;(0,i.revertOnError)(e,a,{currentPassword:c,serverKey:""})})(e),y.dispatch((0,d.changeMPDone)()),{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}}}let I=!0;try{const e=await(0,a.confirmMasterPasswordChangeDone)(y,v,{});if((0,a.isApiError)(e))throw new Error("2FA Enable Flow - Failed to confirmMasterPasswordChangeDone");I=!1}catch(e){}return y.dispatch((0,d.changeMPDone)()),{success:!0,logoutRequired:I}}},35823:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivationHandler=void 0;const o=r(45127),n=r(46298),a=r(16593),i=r(34569);t.completeTotpActivationHandler=async(e,t)=>{const{storeService:r}=e,s=r.getState(),c=(0,a.userLoginSelector)(s);if(!c)return{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}};const d=await(0,i.completeTotpActivation)(r,c,{authTicket:t});return(0,n.isApiError)(d)?{success:!1,error:{code:d.code}}:{success:!0}}},49109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=void 0;const o=r(48062),n=r(16194);t.endTwoFactorAuthenticationHandler=async({sessionService:e,storeService:t})=>(t.dispatch((0,n.changeMPDone)()),await e.getInstance().user.attemptSync(o.Trigger.SettingsChange),{success:!0})},46796:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endTwoFactorAuthenticationHandler=t.disableTwoFactorAuthenticationTOTP1Handler=t.disableTwoFactorAuthenticationTOTP2Handler=t.refreshTwoFactorAuthenticationInfoHandler=void 0;var o=r(24797);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoHandler",{enumerable:!0,get:function(){return o.refreshTwoFactorAuthenticationInfoHandler}});var n=r(99445);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP2Handler",{enumerable:!0,get:function(){return n.disableTwoFactorAuthenticationTOTP2Handler}});var a=r(9819);Object.defineProperty(t,"disableTwoFactorAuthenticationTOTP1Handler",{enumerable:!0,get:function(){return a.disableTwoFactorAuthenticationTOTP1Handler}});var i=r(49109);Object.defineProperty(t,"endTwoFactorAuthenticationHandler",{enumerable:!0,get:function(){return i.endTwoFactorAuthenticationHandler}})},24797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoHandler=void 0;const o=r(16593),n=r(6836),a=r(71291);t.refreshTwoFactorAuthenticationInfoHandler=async e=>{const{storeService:t,wsService:r}=e;try{const e=t.isAuthenticated,i=(0,o.userLoginSelector)(t.getState());if(t.dispatch((0,n.TwoFactorAuthStatusRequested)()),!i||!e)return t.dispatch((0,n.TwoFactorAuthStatusError)()),{success:!1};return!1===(await(0,a.refreshTwoFactorAuthenticationInfoService)(t,r)).success?(t.dispatch((0,n.TwoFactorAuthStatusError)()),{success:!1}):{success:!0}}catch(e){return t.dispatch((0,n.TwoFactorAuthStatusError)()),{success:!1}}}},43037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfo$=void 0;const o=r(18948),n=r(3343),a=r(5689);t.twoFactorAuthenticationInfo$=()=>(0,o.pipe)((0,n.map)(a.twoFactorAuthenticationInfoSelector),(0,n.distinctUntilChanged)())},5689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.twoFactorAuthenticationInfoSelector=void 0;t.twoFactorAuthenticationInfoSelector=e=>e.authentication.twoFactorAuthentication},71291:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=t.refreshTwoFactorAuthenticationInfoService=t.performTotpVerificationService=void 0;var o=r(14762);Object.defineProperty(t,"performTotpVerificationService",{enumerable:!0,get:function(){return o.performTotpVerificationService}});var n=r(71938);Object.defineProperty(t,"refreshTwoFactorAuthenticationInfoService",{enumerable:!0,get:function(){return n.refreshTwoFactorAuthenticationInfoService}});var a=r(56733);Object.defineProperty(t,"requestTOTPActivationService",{enumerable:!0,get:function(){return a.requestTOTPActivationService}})},14762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerificationService=void 0;const o=r(45127),n=r(46298),a=r(92263),i=r(14656),s=r(28287),c=r(16593);t.performTotpVerificationService=async(e,t,r=!1)=>{const{storeService:d}=e,l=d.getState(),u=(0,c.userLoginSelector)(l);if(!u)return{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}};try{const e=await(0,n.performTotpVerification)(d,{login:u,otp:t,activationFlow:r});if((0,n.isApiError)(e))return(0,s.handlePerformValidationError)(e,!0);const{authTicket:o}=e;return{success:!0,authTicket:o}}catch(e){return{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?o.AuthenticationCode.NETWORK_ERROR:o.AuthenticationCode.UNKNOWN_ERROR}}}}},71938:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshTwoFactorAuthenticationInfoService=void 0;const o=r(46298),n=r(16593),a=r(16478),i=r(56915),s=r(6836),c=r(45127),d=r(70252),l=r(92263),u={email_token:c.TwoFactorAuthenticationType.EMAIL_TOKEN,totp_login:c.TwoFactorAuthenticationType.LOGIN,totp_device_registration:c.TwoFactorAuthenticationType.DEVICE_REGISTRATION,sso:c.TwoFactorAuthenticationType.SSO};t.refreshTwoFactorAuthenticationInfoService=async(e,t)=>{try{const r=(0,n.userLoginSelector)(e.getState()),d=await(0,o.getTwoFactorAuthenticationStatus)(e,r);if((0,o.isApiError)(d))return e.dispatch((0,s.TwoFactorAuthStatusError)()),{success:!1};const l=u[d.type],p=a.TwoFactorAuthenticationEnabled.includes(l);let S=!1;const m=await t.premium.status({login:(0,n.userLoginSelector)(e.getState()),uki:(0,i.ukiSelector)(e.getState()),spaces:!0}),{spaces:g}=m;g&&(S=g.some((e=>{const{info:{twoFAEnforced:t}}=e;return c.ENFORCE_TWO_FACTOR_AUTHENTICATION_ENABLED_VALUES.includes(t)})));const y=!p&&S,A={...d,isTwoFactorAuthenticationEnabled:p,isTwoFactorAuthenticationEnforced:S,shouldEnforceTwoFactorAuthentication:y,type:l};return e.dispatch((0,s.TwoFactorAuthStatusUpdated)(A)),{success:!0,info:A}}catch(t){e.dispatch((0,s.TwoFactorAuthStatusError)());const r=l.CarbonError.fromAnyError(t).addContextInfo("Refresh 2FA info","refresh-two-factor-authentication-service.ts");return(0,d.sendExceptionLog)({error:r}),{success:!1}}}},56733:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivationService=void 0;const o=r(45127),n=r(46298),a=r(92263),i=r(14656),s=r(16593);t.requestTOTPActivationService=async(e,{phoneNumber:t,country:r})=>{try{const{storeService:a}=e,i=a.getState(),c=(0,s.userLoginSelector)(i);if(!c)return{success:!1,error:{code:o.AuthenticationCode.UNKNOWN_ERROR}};const d=await(0,n.requestTOTPActivation)(a,c,{phoneNumber:t,country:r});return(0,n.isApiError)(d)?{success:!1,error:{code:d.code}}:{success:!0,...d}}catch(e){return{success:!1,error:{code:(0,a.isCarbonError)(e)&&e.errorCode===i.HttpErrorCode.NETWORK_ERROR?o.AuthenticationCode.NETWORK_ERROR:o.AuthenticationCode.UNKNOWN_ERROR}}}}},91178:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(41762),n=r(52198),a=r(29010),i=r(3433),s=r(22770),c=r(49904),d=r(56915),l=r(52056),u=r(89805),p=r(92694),S=r(33088),m=r(22170),g=r(82862);t.config={commands:{enableWebAuthnAuthentication:{handler:p.enableWebAuthnAuthentication},initEnableWebAuthnAuthentication:{handler:u.initEnableWebAuthnAuthentication},initRegisterWebAuthnAuthenticator:{handler:o.initRegisterWebAuthnAuthenticator},registerWebAuthnAuthenticator:{handler:n.registerWebAuthnAuthenticator},refreshWebAuthnAuthenticators:{handler:i.refreshWebAuthnAuthenticators},refreshAvailableWebAuthnAuthenticators:{handler:a.refreshAvailableWebAuthnAuthenticators},initOpenSessionWithWebAuthnAuthenticator:{handler:s.initOpenSessionWithWebAuthnAuthenticator},openSessionWithWebAuthnAuthenticator:{handler:c.openSessionWithWebAuthnAuthenticator},disableWebAuthnAuthentication:{handler:S.disableWebAuthnAuthentication},removeWebAuthnAuthenticator:{handler:g.removeWebAuthnAuthenticator},initUserVerificationWithWebAuthn:{handler:m.initUserVerificationWithWebAuthn}},queries:{getWebAuthnAuthenticators:{selector:d.authenticatorsSelector},getWebAuthnAuthenticationOptedIn:{selector:d.webAuthnAuthenticationOptedInSelector}},liveQueries:{liveWebAuthnAuthenticators:{operator:l.webAuthnAuthenticators$},liveWebAuthnAuthenticationOptedIn:{operator:l.webAuthnAuthenticationOptedIn$}}}},79842:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PUBKEY_ALGORITHM_RSA_PKCS1256=t.PUBKEY_ALGORITHM_ECDSA256=void 0,t.PUBKEY_ALGORITHM_ECDSA256=-7,t.PUBKEY_ALGORITHM_RSA_PKCS1256=-257},26942:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildAssertionPublicKeyOptions=t.buildAttestationPublicKeyOptions=void 0;const o=r(79842);t.buildAttestationPublicKeyOptions=function(e,t,r,n,a,i){return{rp:{id:e,name:"Dashlane"},user:{id:t,name:r,displayName:r},challenge:n,timeout:a,pubKeyCredParams:[{alg:o.PUBKEY_ALGORITHM_ECDSA256,type:"public-key"},{alg:o.PUBKEY_ALGORITHM_RSA_PKCS1256,type:"public-key"}],excludeCredentials:i,authenticatorSelection:{userVerification:"discouraged"}}},t.buildAssertionPublicKeyOptions=function(e,t,r,o){return{rpId:e,challenge:t,timeout:r,allowCredentials:o,userVerification:"discouraged"}}},52056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.webAuthnAuthenticationOptedIn$=t.webAuthnAuthenticators$=void 0;const o=r(18948),n=r(3343),a=r(56915);t.webAuthnAuthenticators$=()=>(0,o.pipe)((0,n.map)(a.authenticatorsSelector),(0,n.distinctUntilChanged)());t.webAuthnAuthenticationOptedIn$=()=>(0,o.pipe)((0,n.map)(a.webAuthnAuthenticationOptedInSelector),(0,n.distinctUntilChanged)())},33088:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableWebAuthnAuthentication=void 0;const o=r(45127),n=r(16593),a=r(86903);t.disableWebAuthnAuthentication=async function(e){const{webAuthnAuthenticationService:t,storeService:r}=e,i=(0,n.userLoginSelector)(r.getState());if(!i)return{success:!1,error:{code:o.DisableWebAuthnAuthenticationError.MISSING_LOGIN}};try{return await t.deactivate(i)?((0,a.sendUserSettingsLog)(e),{success:!0}):{success:!1,error:{code:o.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}catch(e){return{success:!1,error:{code:o.DisableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_DEACTIVATE_FAILED}}}}},92694:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enableWebAuthnAuthentication=void 0;const o=r(45127),n=r(56915),a=r(16593),i=r(86903),s={UNKNOWN_ERROR:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.UNKNOWN_ERROR}},WEBAUTHN_SERVICE_INIT_FAILED:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.WEBAUTHN_SERVICE_INIT_FAILED}},USER_HAS_OTP:{success:!1,error:{code:o.EnableWebAuthnAuthenticationError.USER_HAS_OTP}}};t.enableWebAuthnAuthentication=async function(e,t){const{webAuthnAuthenticationService:r,storeService:c}=e,{authenticationType:d,credential:l,isRoaming:u}=t,p=(0,a.userLoginSelector)(c.getState());if((0,n.hasOtp2TypeSelector)(c.getState()))return s.USER_HAS_OTP;try{switch(d){case o.WebAuthnCallTypes.CREATE:{const t=await async function(e,t,r,o){const n=t.response,a={authenticationType:"webauthn.create",name:e,isRoaming:r,credential:{id:t.id,type:t.type,rawId:t.rawId,response:n}};return await o.initialize(a)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}(p,l,u,r);return t.success&&(0,i.sendUserSettingsLog)(e),t}case o.WebAuthnCallTypes.GET:{const t=await async function(e,t){const r=e.response,o={authenticationType:"webauthn.get",credential:{id:e.id,type:e.type,rawId:e.rawId,response:r}};return await t.initialize(o)?{success:!0}:s.WEBAUTHN_SERVICE_INIT_FAILED}(l,r);return t.success&&(0,i.sendUserSettingsLog)(e),t}default:return s.UNKNOWN_ERROR}}catch(e){return s.UNKNOWN_ERROR}}},89805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initEnableWebAuthnAuthentication=void 0;const o=r(35088),n=r(45127),a=r(46298),i=r(16593),s=r(56915),c=r(8246),d=r(3433),l=r(26942);t.initEnableWebAuthnAuthentication=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=r.getState(),S=(0,i.userLoginSelector)(r.getState());let m=(0,s.webAuthnUserIdSelector)(p);m||(m=(0,o.v4)(),r.dispatch((0,c.webAuthnUserIdUpdated)(m)));let g=(0,s.authenticatorsAsCredentialSelector)(p);g&&0!==g.length||(await(0,d.refreshWebAuthnAuthenticators)(e),g=(0,s.authenticatorsAsCredentialSelector)(r.getState()));const y=g?.length>0?n.WebAuthnCallTypes.GET:n.WebAuthnCallTypes.CREATE;try{const e=await(0,a.requestWebauthnRegistration)(r,S);if((0,a.isApiError)(e))return{success:!1,error:{code:n.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:o}=e;let i;return i=y===n.WebAuthnCallTypes.CREATE?(0,l.buildAttestationPublicKeyOptions)(u,m,S,t,o,g):(0,l.buildAssertionPublicKeyOptions)(u,t,o,g),{success:!0,response:{publicKeyOptions:i,webAuthnType:y}}}catch(e){return{success:!1,error:{code:n.InitEnableWebAuthnAuthenticationError.UNKNOWN_ERROR}}}}},22770:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initOpenSessionWithWebAuthnAuthenticator=void 0;const o=r(48062),n=r(45127),a=r(68299),i=r(38945),s=r(658);t.initOpenSessionWithWebAuthnAuthenticator=async function(e,t){const{relyingPartyId:r,login:c}=t,{webAuthnAuthenticationService:d}=e;try{if(!await d.shouldTrigger(c))return{success:!1,error:{code:n.InitOpenSessionWithWebAuthnAuthenticatorError.CANNOT_TRIGGER_WEBAUTHN_AUTHENTICATION}};(0,s.sendAskBiometricAuthenticationEventLog)(e,o.VerificationMode.None);const t=await(0,a.startWebAuthnAuthentication)(e,c,r);if(!1===t.success){let e=n.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR;if(t.error.code===i.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS)e=n.InitOpenSessionWithWebAuthnAuthenticatorError.UNAVAILABLE_AUTHENTICATORS;return{success:!1,error:{code:e}}}return{success:!0,response:{publicKeyOptions:t.response.publicKeyOptions,authenticatorsInfo:t.response.authenticatorsInfo.map((({credentialId:e,isRoaming:t})=>({credentialId:e,isRoaming:t})))}}}catch(e){return{success:!1,error:{code:n.InitOpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},41762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initRegisterWebAuthnAuthenticator=void 0;const o=r(35088),n=r(45127),a=r(46298),i=r(8246),s=r(16593),c=r(56915),d=r(26942),l=r(3433);t.initRegisterWebAuthnAuthenticator=async function(e,t){const{storeService:r}=e,{relyingPartyId:u}=t,p=(0,s.userLoginSelector)(r.getState());let S=(0,c.webAuthnUserIdSelector)(r.getState());S||(S=(0,o.v4)(),r.dispatch((0,i.webAuthnUserIdUpdated)(S)));let m=(0,c.authenticatorsAsCredentialSelector)(r.getState());m&&0!==m.length||(await(0,l.refreshWebAuthnAuthenticators)(e),m=(0,c.authenticatorsAsCredentialSelector)(r.getState()));try{const e=await(0,a.requestWebauthnRegistration)(r,p);if((0,a.isApiError)(e))return{success:!1,error:{code:n.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}};const{challenge:t,expirationDateUnix:o}=e;return{success:!0,response:{publicKeyOptions:(0,d.buildAttestationPublicKeyOptions)(u,S,p,t,o,m)}}}catch(e){return{success:!1,error:{code:n.InitRegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},22170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initUserVerificationWithWebAuthn=void 0;const o=r(45127),n=r(68299),a=r(38945),i=r(16593),s={[a.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE]:o.InitUserVerificationWithWebAuthnError.CANNOT_FETCH_WEBAUTHN_CHALLENGE,[a.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS]:o.InitUserVerificationWithWebAuthnError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS};t.initUserVerificationWithWebAuthn=async function(e,t){try{const{storeService:r}=e,a=r.getState();if(!(0,i.isAuthenticatedSelector)(a))return{success:!1,error:{code:o.InitUserVerificationWithWebAuthnError.LOGGED_OUT}};const c=(0,i.userLoginSelector)(a),d=await(0,n.startWebAuthnAuthentication)(e,c,t.relyingPartyId);if(!1===d.success){return{success:!1,error:{code:s[d.error.code]??o.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR}}}return{success:!0,response:{publicKeyOptions:d.response.publicKeyOptions}}}catch(e){return{success:!1,error:{code:o.InitUserVerificationWithWebAuthnError.UNKNOWN_ERROR}}}}},49904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.openSessionWithWebAuthnAuthenticator=void 0;const o=r(45127),n=r(88610),a=r(658);t.openSessionWithWebAuthnAuthenticator=async function(e,t){const{credential:r,login:i,isRoamingAuthenticator:s}=t,{storeService:c,webAuthnAuthenticationService:d}=e;try{const t={authenticationType:"webauthn.get",credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};await d.process(i,t);const l=c.getUserSession().masterPassword;if(!l)return(0,a.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:o.OpenSessionWithWebAuthnAuthenticatorError.MP_MISSING_IN_SESSION_ERROR}};const u=(0,n.makeLoginController)(e);return await u.openSessionWithMasterPassword(i,l,{triggeredByRememberMeType:"webauthn",isWebAuthnAuthenticatorRoaming:s,loginType:"Biometric"}),{success:!0}}catch(t){return(0,a.sendBiometricLoginErrorLog)(e),{success:!1,error:{code:o.OpenSessionWithWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},29010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshAvailableWebAuthnAuthenticators=void 0;const o=r(45127),n=r(56915),a=r(46298),i=r(8246);t.refreshAvailableWebAuthnAuthenticators=async function(e,t){const{storeService:r}=e,{login:s}=t;if(!(0,n.sessionKeysSelector)(r.getState()))return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.MISSING_SESSION_KEYS_IN_STORE}};try{const e=await(0,a.getAvailableWebAuthnAuthenticators)(r,s);if((0,a.isApiError)(e))return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const t=e.authenticators.map((e=>({...e,canOpenSession:!0})));return r.dispatch((0,i.webAuthnAvailableAuthenticatorsListUpdated)(t)),{success:!0,response:{authenticators:t}}}catch(e){return{success:!1,error:{code:o.RefreshAvailableWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},3433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshWebAuthnAuthenticators=void 0;const o=r(45127),n=r(46298),a=r(16593),i=r(8246);t.refreshWebAuthnAuthenticators=async function(e){const{storeService:t}=e,r=(0,a.userLoginSelector)(t.getState());try{const e=await(0,n.getWebAuthnAuthenticators)(t,r);if((0,n.isApiError)(e))return{success:!1,error:{code:o.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}};const a=e.authenticators.map((e=>({...e,canOpenSession:!1})));return t.dispatch((0,i.webAuthnAuthenticatorsListUpdated)(a)),{success:!0,response:{authenticators:a}}}catch(e){return{success:!1,error:{code:o.RefreshWebAuthnAuthenticatorsError.UNKNOWN_ERROR}}}}},52198:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerWebAuthnAuthenticator=void 0;const o=r(45127),n=r(16593),a=r(46298),i=r(56915),s=r(8246);t.registerWebAuthnAuthenticator=async function(e,t){const{credential:r,isRoaming:c}=t,{storeService:d,webAuthnAuthenticationService:l}=e,u=d.getState(),p=(0,n.userLoginSelector)(u);if((0,i.hasOtp2TypeSelector)(u))return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.USER_HAS_OTP}};try{const e={authenticationType:"webauthn.create",name:p,isRoaming:c,credential:{id:r.id,type:r.type,rawId:r.rawId,response:r.response}};if((0,i.authenticatorsSelector)(u).length){const t=await(0,a.completeWebAuthnAuthenticatorRegistration)(d,p,{authenticator:e});if((0,a.isApiError)(t))return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}else await l.initialize(e);return d.dispatch((0,s.webAuthnAuthenticatorAdded)({name:e.name,isRoaming:e.isRoaming,credentialId:e.credential.id,canOpenSession:!0})),{success:!0}}catch(e){return{success:!1,error:{code:o.RegisterWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},82862:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeWebAuthnAuthenticator=void 0;const o=r(45127),n=r(16593),a=r(46298),i=r(56915),s=r(33088),c=r(8246);async function d(e,t,r){const n=await(0,a.deactivateWebAuthnAuthenticator)(e,t,{credentialId:r});return(0,a.isApiError)(n)?{success:!1,error:{code:o.RemoveWebAuthnAuthenticatorError.CANNOT_REMOVE_WEBAUTHN_AUTHENTICATOR}}:{success:!0}}t.removeWebAuthnAuthenticator=async function(e,t){const{credentialId:r}=t,{storeService:a}=e,l=a.getState(),u=(0,n.userLoginSelector)(l),p=(0,i.webAuthnAuthenticationOptedInSelector)(l),S=(0,i.authenticatorsSelector)(l);try{let t=null;return p&&1===S.length?(await(0,s.disableWebAuthnAuthentication)(e),t=await d(a,u,r)):t=await d(a,u,r),t.success&&a.dispatch((0,c.webAuthnAuthenticatorRemoved)(r)),t}catch(e){return{success:!1,error:{code:o.RemoveWebAuthnAuthenticatorError.UNKNOWN_ERROR}}}}},68299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startWebAuthnAuthentication=void 0;const o=r(26942),n=r(29010),a=r(38945),i=r(46298);t.startWebAuthnAuthentication=async function(e,t,r){const{storeService:s}=e,c=await(0,n.refreshAvailableWebAuthnAuthenticators)(e,{login:t});if(!c.success)return{success:!1,error:{code:a.StartWebAuthnAuthenticationError.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS}};const d=c.response.authenticators.map((e=>({id:e.credentialId,type:"public-key"}))),l=await(0,i.requestWebauthnOpenSession)(s,t);if((0,i.isApiError)(l))return{success:!1,error:{code:a.StartWebAuthnAuthenticationError.CANNOT_FETCH_WEBAUTHN_CHALLENGE}};const{challenge:u,expirationDateUnix:p}=l;return{success:!0,response:{publicKeyOptions:(0,o.buildAssertionPublicKeyOptions)(r,u,p,d),authenticatorsInfo:c.response.authenticators}}}},38945:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StartWebAuthnAuthenticationError=void 0,function(e){e.CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS="CANNOT_REFRESH_WEBAUTHN_AUTHENTICATORS",e.CANNOT_FETCH_WEBAUTHN_CHALLENGE="CANNOT_FETCH_WEBAUTHN_CHALLENGE"}(t.StartWebAuthnAuthenticationError||(t.StartWebAuthnAuthenticationError={}))},44740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(3158);t.bootstrap=e=>{e.register(o.config)}},90622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.getLocalAccounts=t.appKeysSelector=t.sessionKeysSelector=t.ukiSelector=t.deviceKeysSelector=t.authenticationReducer=void 0;var o=r(57334);Object.defineProperty(t,"authenticationReducer",{enumerable:!0,get:function(){return o.authenticationReducer}});var n=r(56915);Object.defineProperty(t,"deviceKeysSelector",{enumerable:!0,get:function(){return n.deviceKeysSelector}}),Object.defineProperty(t,"ukiSelector",{enumerable:!0,get:function(){return n.ukiSelector}}),Object.defineProperty(t,"sessionKeysSelector",{enumerable:!0,get:function(){return n.sessionKeysSelector}}),Object.defineProperty(t,"appKeysSelector",{enumerable:!0,get:function(){return n.appKeysSelector}});var a=r(75226);Object.defineProperty(t,"getLocalAccounts",{enumerable:!0,get:function(){return a.getLocalAccounts}});var i=r(44740);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},54622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatus$=void 0;const o=r(18948),n=r(3343),a=r(56915);t.reactivationStatus$=()=>(0,o.pipe)((0,n.map)(a.reactivationStatusSelector),(0,n.distinctUntilChanged)())},56915:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reactivationStatusSelector=t.rememberMeFor14DaysOptedInSelector=t.webAuthnAuthenticationOptedInSelector=t.rememberMeTypeSelector=t.authenticatorsAsCredentialSelector=t.authenticatorsSelector=t.webAuthnUserIdSelector=t.platformInfoSelector=t.hasOtp2TypeSelector=t.otpTypeSelector=t.userAuthenticationDataSelector=t.localUsersAuthenticationDataSelector=t.localAccountsInitializedSelector=t.localAccountsListSelector=t.getUserDeviceWasRegisteredWithDeviceKeysSelector=t.sessionKeysSelector=t.getDeviceAccessKeysFromSession=t.getDeviceAccessKeySelector=t.getDeviceKeysFromSession=t.deviceKeysSelector=t.getUkiFromSession=t.ukiSelector=t.dashlaneServerDeltaTimestampSelector=t.appKeysSelector=void 0;const o=r(92215),n=r(2246),a=r(86797),i=r(18948),s=r(66638);t.appKeysSelector=e=>e.userSession.sdkAuthentication.appKeys;t.dashlaneServerDeltaTimestampSelector=e=>e.userSession.sdkAuthentication.dashlaneServerDeltaTimestamp;t.ukiSelector=e=>{const t=e.userSession.localSettings.uki;return t||(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys&&(0,o.convertDeviceKeysToUki)(e.authentication.currentUser.deviceKeys)||null)};t.getUkiFromSession=({queries:{currentSessionInfo:e}})=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)((e=>(0,o.convertDeviceKeysToUki)(e.deviceKeys)))));t.deviceKeysSelector=e=>{if(e.authentication.currentUser&&e.authentication.currentUser.deviceKeys)return e.authentication.currentUser.deviceKeys;const t=e.userSession.localSettings.uki;return(0,o.convertUkiToDeviceKeys)(t)};t.getDeviceKeysFromSession=({queries:{currentSessionInfo:e}})=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)((e=>e.deviceKeys))));t.getDeviceAccessKeySelector=(e,t)=>((e,t)=>{const r=e.authentication.localUsers[t];return r&&r.deviceAccessKey?r.deviceAccessKey:(0,n.getCommonAppSetting)("deviceId")||null})(e,t);t.getDeviceAccessKeysFromSession=({queries:{localSessions:e}},t)=>(0,i.firstValueFrom)(e().pipe((0,i.map)(s.getSuccessOrThrow),(0,i.map)((e=>e[t]?.deviceAccessKey))));t.sessionKeysSelector=({userSession:{session:e}})=>Boolean(e.sessionKeys&&e.sessionKeys.accessKey&&e.sessionKeys.secretKey)?{...e.sessionKeys}:null;t.getUserDeviceWasRegisteredWithDeviceKeysSelector=(e,t)=>{const r=e.authentication.localUsers[t];return!!r&&!r.deviceRegisteredWithLegacyKey};t.localAccountsListSelector=e=>e.authentication.localAccounts.accountsList;t.localAccountsInitializedSelector=e=>e.authentication.localAccounts.accountsListInitialized;t.localUsersAuthenticationDataSelector=e=>e.authentication.localUsers;t.userAuthenticationDataSelector=e=>e.authentication.currentUser;t.otpTypeSelector=e=>e.userSession?.account?e.userSession.account.otpType:null;t.hasOtp2TypeSelector=e=>(0,t.otpTypeSelector)(e)===a.OtpType.OTP_LOGIN;t.platformInfoSelector=e=>e.device.platform.info;t.webAuthnUserIdSelector=e=>e.authentication.webAuthnAuthentication.webAuthnUserId;t.authenticatorsSelector=e=>e.authentication.webAuthnAuthentication.authenticators;t.authenticatorsAsCredentialSelector=e=>(0,t.authenticatorsSelector)(e).map((e=>({id:e.credentialId,type:"public-key"})));t.rememberMeTypeSelector=e=>e.authentication.currentUser.rememberMeType;t.webAuthnAuthenticationOptedInSelector=e=>"webauthn"===(0,t.rememberMeTypeSelector)(e);t.rememberMeFor14DaysOptedInSelector=e=>"autologin"===(0,t.rememberMeTypeSelector)(e);t.reactivationStatusSelector=e=>e.authentication.localAccounts.reactivationStatus},33045:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(14498);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on((()=>{(0,o.loadRememberMeTypeToStore)(t)}))}},76839:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(90351);t.config={commands:{},queries:{getSingleAddressForAutofill:{selector:o.autofillViewedAddressSelector},getMultipleAddressesForAutofill:{selector:o.autofillViewedQueriedAddressesSelector},getSingleBankAccountForAutofill:{selector:o.autofillViewedBankAccountSelector},getMultipleBankAccountsForAutofill:{selector:o.autofillViewedQueriedBankAccountsSelector},getSingleCompanyForAutofill:{selector:o.autofillViewedCompanySelector},getMultipleCompaniesForAutofill:{selector:o.autofillViewedQueriedCompaniesSelector},getMultipleCredentialsForAutofill:{selector:o.autofillViewedQueriedCredentialsByDomainSelector},getSingleDriverLicenseForAutofill:{selector:o.autofillViewedDriverLicenseSelector},getMultipleDriverLicensesForAutofill:{selector:o.autofillViewedQueriedDriverLicensesSelector},getSingleEmailForAutofill:{selector:o.autofillViewedEmailSelector},getMultipleEmailsForAutofill:{selector:o.autofillViewedQueriedEmailsSelector},getSingleFiscalIdForAutofill:{selector:o.autofillViewedFiscalIdSelector},getMultipleFiscalIdsForAutofill:{selector:o.autofillViewedQueriedFiscalIdsSelector},getSingleGeneratedPasswordForAutofill:{selector:o.autofillViewedGeneratedPasswordSelector},getMultipleGeneratedPasswordsForAutofill:{selector:o.autofillViewedQueriedGeneratedPasswordsSelector},getSingleIdCardForAutofill:{selector:o.autofillViewedIdCardSelector},getMultipleIdCardsForAutofill:{selector:o.autofillViewedQueriedIdCardsSelector},getSingleIdentityForAutofill:{selector:o.autofillViewedIdentitySelector},getMultipleIdentitiesForAutofill:{selector:o.autofillViewedQueriedIdentitiesSelector},getSingleNoteForAutofill:{selector:o.autofillViewedNoteSelector},getMultipleNotesForAutofill:{selector:o.autofillViewedQueriedNotesSelector},getSinglePasskeyForAutofill:{selector:o.autofillViewedPasskeySelector},getSinglePassportForAutofill:{selector:o.autofillViewedPassportSelector},getMultiplePassportsForAutofill:{selector:o.autofillViewedQueriedPassportsSelector},getSinglePaymentCardForAutofill:{selector:o.autofillViewedPaymentCardSelector},getMultiplePaymentCardsForAutofill:{selector:o.autofillViewedQueriedPaymentCardsSelector},getSinglePersonalWebsiteForAutofill:{selector:o.autofillViewedPersonalWebsiteSelector},getMultiplePersonalWebsitesForAutofill:{selector:o.autofillViewedQueriedPersonalWebsitesSelector},getSinglePhoneForAutofill:{selector:o.autofillViewedPhoneSelector},getMultiplePhonesForAutofill:{selector:o.autofillViewedQueriedPhonesSelector},getSingleSocialSecurityIdForAutofill:{selector:o.autofillViewedSocialSecurityIdSelector},getMultipleSocialSecurityIdsForAutofill:{selector:o.autofillViewedQueriedSocialSecurityIdsSelector},getAutofillSettingOnUrlForAutofill:{selector:o.getAutofillSettingOnUrlForAutofillSelector}},liveQueries:{}}},72227:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(76839);t.bootstrap=e=>{e.register(o.config)}},27923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainMatchTypeForHermes=t.getAgeFromIdentity=t.defaultToZero=t.defaultToUS=t.defaultToEmptyString=void 0;const o=r(62433),n=r(45127),a=r(48062),i=r(72099),s=r(88083);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToUS=(0,o.defaultTo)(n.Country.US),t.defaultToZero=(0,o.defaultTo)(0);t.getAgeFromIdentity=e=>{const t=new Date(0).getUTCFullYear(),r=(0,i.epochToDate)((0,i.vaultDateToViewDate)(e.BirthDate)),o=new Date(Date.now()-r.getTime());return Math.abs(o.getUTCFullYear()-t)};t.getDomainMatchTypeForHermes=(e,t)=>{switch((0,s.getCredentialByDomainMatchType)(e,t)){case s.DomainMatchType.DashlaneDefinedLinkedWebsite:return a.MatchType.AssociatedWebsite;case s.DomainMatchType.UserDefinedLinkedWebsite:return a.MatchType.UserAssociatedWebsite;case s.DomainMatchType.None:case s.DomainMatchType.MainWebsite:default:return a.MatchType.Regular}}},74219:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(72227);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},90351:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAutofillSettingOnUrlForAutofillSelector=t.autofillViewedQueriedSocialSecurityIdsSelector=t.autofillViewedSocialSecurityIdSelector=t.autofillViewedQueriedPersonalWebsitesSelector=t.autofillViewedPersonalWebsiteSelector=t.autofillViewedQueriedPhonesSelector=t.autofillViewedPhoneSelector=t.autofillViewedQueriedPaymentCardsSelector=t.autofillViewedPaymentCardSelector=t.autofillViewedQueriedPassportsSelector=t.autofillViewedPassportSelector=t.autofillViewedPasskeySelector=t.autofillViewedQueriedNotesSelector=t.autofillViewedNoteSelector=t.autofillViewedQueriedIdentitiesSelector=t.autofillViewedIdentitySelector=t.autofillViewedQueriedIdCardsSelector=t.autofillViewedIdCardSelector=t.autofillViewedQueriedGeneratedPasswordsSelector=t.autofillViewedGeneratedPasswordSelector=t.autofillViewedQueriedFiscalIdsSelector=t.autofillViewedFiscalIdSelector=t.autofillViewedQueriedEmailsSelector=t.autofillViewedEmailSelector=t.autofillViewedQueriedDriverLicensesSelector=t.autofillViewedDriverLicenseSelector=t.autofillViewedQueriedCredentialsByDomainSelector=t.autofillViewedQueriedCompaniesSelector=t.autofillViewedCompanySelector=t.autofillViewedQueriedBankAccountsSelector=t.autofillViewedBankAccountSelector=t.autofillViewedQueriedAddressesSelector=t.autofillViewedAddressSelector=void 0;const o=r(62433),n=r(45127),a=r(15318),i=r(99281),s=r(16018),c=r(80624),d=r(19325),l=r(41841),u=r(9774),p=r(26147),S=r(41092),m=r(92598),g=r(23437),y=r(81438),A=r(28074),f=r(65401),E=r(58235),h=r(81473),v=r(82439),T=r(27147),_=r(16593),I=r(63566),C=r(55346),P=r(18665);t.autofillViewedAddressSelector=(e,t)=>{const r=(0,i.addressSelector)(e,t);return(0,C.addressAutofillView)(r)},t.autofillViewedQueriedAddressesSelector=(0,o.compose)((0,I.viewListResults)(C.addressListView),i.queryAddressesSelector);t.autofillViewedBankAccountSelector=(e,t)=>{const r=(0,s.bankAccountSelector)(e,t);return(0,C.bankAccountAutofillView)(r)},t.autofillViewedQueriedBankAccountsSelector=(0,o.compose)((0,I.viewListResults)(C.bankAccountListView),s.queryBankAccountsSelector);t.autofillViewedCompanySelector=(e,t)=>{const r=(0,c.companySelector)(e,t);return(0,C.companyAutofillView)(r)},t.autofillViewedQueriedCompaniesSelector=(0,o.compose)((0,I.viewListResults)(C.companyListView),c.queryCompaniesSelector);t.autofillViewedQueriedCredentialsByDomainSelector=(e,t)=>{const{domain:r,...o}=t,n=(r?(0,d.getQueryByDomainSelector)(r):l.querySelector)(e,o),a={...n,items:n.items.map((e=>({credential:e,domain:r,sharingStatus:{isShared:!1}})))};return(0,I.viewListResults)(C.credentialListView)(a)};t.autofillViewedDriverLicenseSelector=(e,t)=>{const r=(0,u.driverLicenseWithIdentitySelector)(e,t);return(0,C.driverLicenseAutofillView)(r)},t.autofillViewedQueriedDriverLicensesSelector=(0,o.compose)((0,I.viewListResults)(C.driverLicenseListView),u.queryDriverLicensesSelector);t.autofillViewedEmailSelector=(e,t)=>{const r=(0,p.emailSelector)(e,t);return(0,C.emailAutofillView)(r)},t.autofillViewedQueriedEmailsSelector=(0,o.compose)((0,I.viewListResults)(C.emailListView),p.queryEmailsSelector);t.autofillViewedFiscalIdSelector=(e,t)=>{const r=(0,S.fiscalIdSelector)(e,t);return(0,C.fiscalIdAutofillView)(r)},t.autofillViewedQueriedFiscalIdsSelector=(0,o.compose)((0,I.viewListResults)(C.fiscalIdListView),S.queryFiscalIdsSelector);t.autofillViewedGeneratedPasswordSelector=(e,t)=>{const r=(0,m.generatedPasswordSelector)(e,t);return(0,C.generatedPasswordAutofillView)(r)},t.autofillViewedQueriedGeneratedPasswordsSelector=(0,o.compose)((0,I.viewListResults)(C.generatedPasswordListView),m.queryGeneratedPasswordsSelector);t.autofillViewedIdCardSelector=(e,t)=>{const r=(0,g.idCardWithIdentitySelector)(e,t);return(0,C.idCardAutofillView)(r)},t.autofillViewedQueriedIdCardsSelector=(0,o.compose)((0,I.viewListResults)(C.idCardListView),g.queryIdCardsSelector);t.autofillViewedIdentitySelector=(e,t)=>{const r=(0,A.identitySelector)(e,t);return(0,C.identityAutofillView)(r)},t.autofillViewedQueriedIdentitiesSelector=(0,o.compose)((0,I.viewListResults)(C.identityListView),A.queryIdentitiesSelector);t.autofillViewedNoteSelector=(e,t)=>{const r=(0,y.noteSelector)(e,t);return(0,C.noteAutofillView)(r)},t.autofillViewedQueriedNotesSelector=(0,o.compose)((0,I.viewListResults)(C.noteListView),y.queryNotesSelector);t.autofillViewedPasskeySelector=(e,t)=>{const r=(0,P.passkeySelector)(e,t);return(0,C.passkeyAutofillView)(r)};t.autofillViewedPassportSelector=(e,t)=>{const r=(0,f.passportWithIdentitySelector)(e,t);return(0,C.passportAutofillView)(r)},t.autofillViewedQueriedPassportsSelector=(0,o.compose)((0,I.viewListResults)(C.passportListView),f.queryPassportsWithIdentitySelector);t.autofillViewedPaymentCardSelector=(e,t)=>{const r=(0,E.paymentCardSelector)(e,t);return(0,C.paymentCardAutofillView)(r)},t.autofillViewedQueriedPaymentCardsSelector=(0,o.compose)((0,I.viewListResults)(C.paymentCardListView),E.queryPaymentCardsSelector);t.autofillViewedPhoneSelector=(e,t)=>{const r=(0,v.phoneSelector)(e,t);return(0,C.phoneAutofillView)(r)},t.autofillViewedQueriedPhonesSelector=(0,o.compose)((0,I.viewListResults)(C.phoneListView),v.queryPhonesSelector);t.autofillViewedPersonalWebsiteSelector=(e,t)=>{const r=(0,h.personalWebsiteSelector)(e,t);return(0,C.personalWebsiteAutofillView)(r)},t.autofillViewedQueriedPersonalWebsitesSelector=(0,o.compose)((0,I.viewListResults)(C.personalWebsiteListView),h.queryPersonalWebsitesSelector);t.autofillViewedSocialSecurityIdSelector=(e,t)=>{const r=(0,T.socialSecurityIdWithIdentitySelector)(e,t);return(0,C.socialSecurityIdAutofillView)(r)},t.autofillViewedQueriedSocialSecurityIdsSelector=(0,o.compose)((0,I.viewListResults)(C.socialSecurityIdListView),T.querySocialSecurityIdsSelector);t.getAutofillSettingOnUrlForAutofillSelector=(e,t)=>{const r=new a.ParsedURL(t).getRootDomain(),o=(0,_.personalSettingsSelector)(e),i=o.DisabledUrlsList.includes(t);return o.DisabledDomainsList.includes(r)||i?n.AutofillOptions.ANALYSIS_ENABLED_ONLY_ON_LOGINS_AND_PASSWORDS:n.AutofillOptions.ANALYSIS_ENABLED_ON_ALL_FORMS}},55346:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyAutofillView=t.socialSecurityIdListView=t.socialSecurityIdAutofillView=t.phoneListView=t.phoneAutofillView=t.personalWebsiteListView=t.personalWebsiteAutofillView=t.paymentCardListView=t.paymentCardAutofillView=t.passportListView=t.passportAutofillView=t.noteListView=t.noteAutofillView=t.idCardListView=t.idCardAutofillView=t.identityListView=t.identityAutofillView=t.generatedPasswordListView=t.generatedPasswordAutofillView=t.fiscalIdListView=t.fiscalIdAutofillView=t.emailListView=t.emailAutofillView=t.driverLicenseListView=t.driverLicenseAutofillView=t.credentialListView=t.credentialAutofillView=t.companyListView=t.companyAutofillView=t.bankAccountListView=t.bankAccountAutofillView=t.addressListView=t.addressAutofillView=void 0;const o=r(83586),n=r(45127),a=r(62433),i=r(92882),s=r(42316),c=r(90073),d=r(72099),l=r(6205),u=r(38495),p=r(27923),S=r(15020),m=e=>({id:e.Id,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.addressAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Address,addressFull:(0,p.defaultToEmptyString)(e.AddressFull),addressName:(0,p.defaultToEmptyString)(e.AddressName),building:(0,p.defaultToEmptyString)(e.Building),city:(0,p.defaultToEmptyString)(e.City),country:(0,p.defaultToEmptyString)(e.Country),digitCode:(0,p.defaultToEmptyString)(e.DigitCode),door:(0,p.defaultToEmptyString)(e.Door),floor:(0,p.defaultToEmptyString)(e.Floor),stairs:(0,p.defaultToEmptyString)(e.Stairs),state:(0,u.findStateName)((0,p.defaultToEmptyString)(e.State)),stateCode:(0,u.findStateCode)((0,p.defaultToEmptyString)(e.LocaleFormat),(0,p.defaultToEmptyString)(e.State)),stateLevel2:(0,u.findStateLevel2Name)((0,p.defaultToEmptyString)(e.StateLevel2)),streetName:(0,p.defaultToEmptyString)(e.StreetName),streetNumber:(0,p.defaultToEmptyString)(e.StreetNumber),streetTitle:(0,p.defaultToEmptyString)(e.StreetTitle),zipCode:(0,p.defaultToEmptyString)(e.ZipCode)});t.addressListView=e=>e.map(t.addressAutofillView);t.bankAccountAutofillView=e=>{const t=(0,i.getBankInfoFromBankAccountData)(e);return{...m(e),vaultType:o.VaultSourceType.BankAccount,name:(0,p.defaultToEmptyString)(e.BankAccountName),owner:(0,p.defaultToEmptyString)(e.BankAccountOwner),IBAN:(0,p.defaultToEmptyString)(e.BankAccountIBAN),BIC:(0,p.defaultToEmptyString)(e.BankAccountBIC),bank:t.bank,country:(0,p.defaultToUS)(e.LocaleFormat),bankCode:t.bankCode}};t.bankAccountListView=e=>e.map(t.bankAccountAutofillView);t.companyAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Company,name:(0,p.defaultToEmptyString)(e.Name),jobTitle:(0,p.defaultToEmptyString)(e.JobTitle)});t.companyListView=e=>e.map(t.companyAutofillView);t.credentialAutofillView=(e,t,r)=>({...m(t),vaultType:o.VaultSourceType.Credential,autoProtected:(0,a.defaultTo)(!1,t.AutoProtected),autoLogin:(0,a.defaultTo)(!1,t.AutoLogin),email:(0,p.defaultToEmptyString)(t.Email),hasOtp:Boolean(t.OtpSecret)||Boolean(t.OtpUrl),matchType:(0,p.getDomainMatchTypeForHermes)(e,t),login:(0,p.defaultToEmptyString)(t.Login),otpSecret:(0,p.defaultToEmptyString)(t.OtpSecret),otpUrl:(0,p.defaultToEmptyString)(t.OtpUrl),password:(0,p.defaultToEmptyString)(t.Password),subdomainOnly:t.SubdomainOnly||!1,sharingStatus:r,title:(0,p.defaultToEmptyString)(t.Title||(0,c.getDomainForCredential)(t)),secondaryLogin:t.SecondaryLogin,url:(0,p.defaultToEmptyString)(t.Url),userAddedLinkedWebsites:(0,l.getUserAddedLinkedWebsiteDomains)(t)});t.credentialListView=e=>e.map((({domain:e,credential:r,sharingStatus:o})=>(0,t.credentialAutofillView)(e,r,o)));t.driverLicenseAutofillView=e=>{const t=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.ExpireDate)),r=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.DeliveryDate));return{...m(e),vaultType:o.VaultSourceType.DriverLicense,country:(0,d.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,p.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,d.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId,state:e.State}};t.driverLicenseListView=e=>e.map(t.driverLicenseAutofillView);t.emailAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Email,email:(0,p.defaultToEmptyString)(e.Email),name:(0,p.defaultToEmptyString)(e.EmailName),type:e.Type||"NO_TYPE"});t.emailListView=e=>e.map(t.emailAutofillView);t.fiscalIdAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.FiscalId,country:(0,d.vaultCountryToViewCountry)(e.LocaleFormat),idNumber:(0,p.defaultToEmptyString)(e.FiscalNumber),teledeclarantNumber:(0,p.defaultToEmptyString)(e.TeledeclarantNumber),creationDate:(0,p.defaultToZero)(e.CreationDatetime)});t.fiscalIdListView=e=>e.map(t.fiscalIdAutofillView);t.generatedPasswordAutofillView=e=>({vaultType:o.VaultSourceType.GeneratedPassword,domain:(0,p.defaultToEmptyString)(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id});t.generatedPasswordListView=e=>e.map(t.generatedPasswordAutofillView);t.identityAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Identity,age:(0,p.getAgeFromIdentity)(e),birthDate:(0,p.defaultToEmptyString)(e.BirthDate),birthPlace:(0,p.defaultToEmptyString)(e.BirthPlace),firstName:(0,p.defaultToEmptyString)(e.FirstName),lastName2:(0,p.defaultToEmptyString)(e.LastName2),lastName:(0,p.defaultToEmptyString)(e.LastName),middleName:(0,p.defaultToEmptyString)(e.MiddleName),middleNameInitial:(0,p.defaultToEmptyString)(e.MiddleName),pseudo:(0,p.defaultToEmptyString)(e.Pseudo),title:e.Title});t.identityListView=e=>e.map(t.identityAutofillView);t.idCardAutofillView=e=>{const t=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.ExpireDate)),r=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.DeliveryDate));return{...m(e),vaultType:o.VaultSourceType.IdCard,country:(0,d.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime),expirationDay:t.getDate(),expirationMonth:t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,idNumber:(0,p.defaultToEmptyString)(e.Number),issueDay:r.getDate(),issueMonth:r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,d.identityToName)(e.identity)||e.Fullname||"",spaceId:e.SpaceId}};t.idCardListView=e=>e.map(t.idCardAutofillView);t.noteAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Note});t.noteListView=e=>e.map(t.noteAutofillView);t.passportAutofillView=e=>{const t=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.ExpireDate)),r=(0,d.epochToDate)((0,d.vaultDateToViewDate)(e.DeliveryDate));return{...m(e),vaultType:o.VaultSourceType.Passport,idNumber:(0,p.defaultToEmptyString)(e.Number),country:(0,d.vaultCountryToViewCountry)(e.LocaleFormat),expirationDay:t.getDate(),expirationMonth:t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,expirationYear:t.getFullYear(),expirationDateFull:`${t.getFullYear()}-${t.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${t.getDate()}`,issueDay:r.getDate(),issueMonth:r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET,issueYear:r.getFullYear(),issueDateFull:`${r.getFullYear()}-${r.getMonth()+d.ZERO_INDEX_BASED_MONTH_OFFSET}-${r.getDate()}`,name:(0,d.identityToName)(e.identity)||e.Fullname||"",deliveryPlace:(0,p.defaultToEmptyString)(e.DeliveryPlace),creationDate:(0,p.defaultToZero)(e.CreationDatetime)}};t.passportListView=e=>e.map(t.passportAutofillView);t.paymentCardAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.PaymentCard,bank:(0,p.defaultToEmptyString)(e.Bank),cardNumber:(0,p.defaultToEmptyString)(e.CardNumber),cardNumberLastDigits:(0,s.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||s.defaultColor,expireMonth:(0,p.defaultToEmptyString)(e.ExpireMonth),expireYear:(0,p.defaultToEmptyString)(e.ExpireYear),name:(0,p.defaultToEmptyString)(e.Name),ownerName:(0,p.defaultToEmptyString)(e.OwnerName),securityCode:(0,p.defaultToEmptyString)(e.SecurityCode),type:e.Type});t.paymentCardListView=e=>e.map(t.paymentCardAutofillView);t.personalWebsiteAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.PersonalWebsite,name:(0,p.defaultToEmptyString)(e.Name),website:(0,p.defaultToEmptyString)(e.Website)});t.personalWebsiteListView=e=>e.map(t.personalWebsiteAutofillView);const g={[n.PhoneType.PHONE_TYPE_ANY]:S.PhoneType.Any,[n.PhoneType.PHONE_TYPE_FAX]:S.PhoneType.Fax,[n.PhoneType.PHONE_TYPE_LANDLINE]:S.PhoneType.Landline,[n.PhoneType.PHONE_TYPE_MOBILE]:S.PhoneType.Mobile,[n.PhoneType.PHONE_TYPE_WORK_FAX]:S.PhoneType.WorkFax,[n.PhoneType.PHONE_TYPE_WORK_LANDLINE]:S.PhoneType.WorkLandline,[n.PhoneType.PHONE_TYPE_WORK_MOBILE]:S.PhoneType.WorkMobile};t.phoneAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.Phone,name:(0,p.defaultToEmptyString)(e.PhoneName),numberInternational:(0,p.defaultToEmptyString)(e.NumberNational),number:(0,p.defaultToEmptyString)(e.Number),type:g[e.Type]});t.phoneListView=e=>e.map(t.phoneAutofillView);t.socialSecurityIdAutofillView=e=>({...m(e),vaultType:o.VaultSourceType.SocialSecurityId,name:(0,d.identityToName)(e.identity)||e.SocialSecurityFullname||"",idNumber:(0,p.defaultToEmptyString)(e.SocialSecurityNumber),country:(0,d.vaultCountryToViewCountry)(e.LocaleFormat),creationDate:(0,p.defaultToZero)(e.CreationDatetime)});t.socialSecurityIdListView=e=>e.map(t.socialSecurityIdAutofillView);t.passkeyAutofillView=e=>({...m(e),credentialId:e.CredentialId,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle,vaultType:o.VaultSourceType.Passkey,counter:e.Counter,keyAlgorithm:e.KeyAlgorithm})},7006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(19083),n=r(50059);t.config={commands:{changeMasterPassword:{handler:o.changeMasterPassword}},queries:{},liveQueries:{liveChangeMasterPasswordStatus:{subject:n.getChangeMasterPasswordStatus$}}}},50059:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeMasterPasswordStatus$=t.emitChangeMasterPasswordStatus=void 0;const o=new(r(18948).Subject);t.emitChangeMasterPasswordStatus=e=>o.next(e);t.getChangeMasterPasswordStatus$=()=>o},35186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(7006);t.bootstrap=e=>{e.register(o.config)}},19083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMasterPassword=void 0;const o=r(45127),n=r(50059),a=r(33740),i=r(13141),s=r(37515),c=r(78238),d=r(41383),l=r(46298),u=r(88610),p=r(47820),S=r(16593),m=r(16194),g=r(61740),y=r(48062),A=r(61984),f=r(18948),E=r(66638),h=r(92263),v=r(70252),T=r(61394),_=r(27517);t.changeMasterPassword=async(e,t)=>{const{applicationModulesAccess:r,storeService:I,masterPasswordEncryptorService:C,remoteDataEncryptorService:P,sessionService:D,localStorageService:O,storageService:b,eventLoggerService:w,moduleClients:N}=e,{queries:{isMasterPasswordLeaked:R,isMasterPasswordWeak:M},commands:{temporaryResetMasterPasswordLeaked:L}}=N.masterPasswordSecurity,{flow:U}=t,k=await(0,a.preValidationForChangeMP)(e,t);if(!1===k.success)return k;const F=I.getState(),B=(0,S.isRemoteKeyActivatedSelector)(F)?P:C;(0,n.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.DOWNLOAD,value:10});const G=(0,S.userLoginSelector)(F);if(!G)return(0,a.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,U);try{await N.session.commands.prepareLocalDataFlush(),I.dispatch((0,m.changeMPStart)())}catch(e){const t=h.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","prepareLocalDataFlushError").addAdditionalInfo({comment:"Failed to prepare local data on graphene"});throw(0,v.sendExceptionLog)({error:t}),e}const K=await(0,l.getDataForMasterPasswordChange)(I,G,{});if((0,l.isApiError)(K))return(0,A.logChangeMasterPasswordError)(w,y.ChangeMasterPasswordError.DownloadError),I.dispatch((0,m.changeMPDone)()),(0,a.makeUnexpectedErrorObject)(K.message,U);const{serverKey:V}=I.getUserSession();if(!(0,a.isOtpStatusValid)(K.otpStatus,V))return(0,A.logChangeMasterPasswordError)(w,y.ChangeMasterPasswordError.LoginError),I.dispatch((0,m.changeMPDone)()),(0,a.makeReturnErrorObject)(o.ChangeMasterPasswordCode.OTP_PROBLEM,U);const{timestamp:j}=K,{transactions:H,sharingKeys:W}=K.data;try{const l=await(0,a.deCipherAllTransactions)(D,B,H),S=O.getInstance(),C=await S.doesLocalKeyExist();let P=null;C&&(P=await S.getLocalKey());const{publicKey:k}=W,F=await(0,a.decipherPrivateKey)(I,B,W);let K;switch(await(0,g.cleanRememberMeStorageData)(I,b,N.session),t.flow){case o.ChangeMPFlowPath.MP_TO_SSO:K=await(0,s.handleMigrationMPtoSso)(e,t,l,F,k,j);break;case o.ChangeMPFlowPath.SSO_TO_MP:K=await(0,c.handleMigrationSSOtoMP)(e,t,l,F,k,j);break;case o.ChangeMPFlowPath.TO_EMAIL_TOKEN:K=await(0,i.handleMigrationToEmailToken)(e,t,l,F,k,j);break;case o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case o.ChangeMPFlowPath.USER_CHANGING_MP:default:K=await(0,d.handleUserChangingMP)(e,t,l,F,k,j)}if(!K.success)return(0,A.logChangeMasterPasswordError)(w,y.ChangeMasterPasswordError.UnknownError),I.dispatch((0,m.changeMPDone)()),K;await N.session.commands.flushLocalData();const V=Boolean(I.getPersonalSettings().AccountRecoveryKey);try{await r.createClients().pinCode.commands.deactivate()}catch(e){const t=h.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","deactivatePinCode").addAdditionalInfo({comment:"Failed to deactivate pin code after successful mp change"});await(0,v.sendExceptionLog)({error:t})}try{V&&(await(0,T.deactivateAccountRecoveryKey)(I,G,{reason:"VAULT_KEY_CHANGE"}),(0,A.logUserDeleteAccountRecoveryKey)(w),e.storeService.dispatch((0,_.editPersonalSettings)({AccountRecoveryKey:void 0,AccountRecoveryKeyId:void 0})))}catch(e){const t=h.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","deactivateRecoveryKey").addAdditionalInfo({comment:"Failed to deactivate recovery key after successful mp change"});await(0,v.sendExceptionLog)({error:t})}let x,z;P&&await D.getInstance().user.persistLocalKey(P),await(0,p.storeSessionCredentialForRecovery)(I,O),(0,n.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.DONE,value:100}),await(0,a.resetMigrationState)(e,U),U===o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY||U===o.ChangeMPFlowPath.MP_TO_SSO||U===o.ChangeMPFlowPath.SSO_TO_MP?await(0,u.sessionDidOpen)(e):V&&await e.sessionService.getInstance().user.attemptSync(y.Trigger.ChangeMasterPassword);try{x=await(0,f.firstValueFrom)(R())}catch(e){const t=h.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordLeakedError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordLeaked"});throw(0,v.sendExceptionLog)({error:t}),e}try{z=await(0,f.firstValueFrom)(M())}catch(e){const t=h.CarbonError.fromAnyError(e).addContextInfo("CHANGE_MASTER_PASSWORD","isMasterPasswordWeakError").addAdditionalInfo({comment:"Failed to retrieve value from isMasterPasswordWeak"});throw(0,v.sendExceptionLog)({error:t}),e}const q=!!(0,E.isSuccess)(x)&&x.data,Y=!!(0,E.isSuccess)(z)&&z.data;(0,A.logChangeMasterPasswordComplete)(w,q,Y),I.dispatch((0,m.changeMPDone)()),L(void 0);const{commands:{temporarySendMasterPasswordChangedEvent:$}}=r.createClients().changeMasterPassword;return $(void 0),{success:!0,response:{reason:o.ChangeMasterPasswordCode.SUCCESS}}}catch(r){if((0,A.logChangeMasterPasswordError)(w,y.ChangeMasterPasswordError.UnknownError),t.flow!==o.ChangeMPFlowPath.MP_TO_SSO&&t.flow!==o.ChangeMPFlowPath.SSO_TO_MP){const r=(0,a.extractCurrentPassword)(F,t);(0,a.revertOnError)(e,B,{currentPassword:r,serverKey:V})}else(0,a.logoutUserOnError)(e);return(0,a.makeUnexpectedErrorObject)(r.message,U)}}},13141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationToEmailToken=void 0;const o=r(48062),n=r(45127),a=r(16593),i=r(50059),s=r(33740),c=r(46298),d=r(16356),l=r(61984);t.handleMigrationToEmailToken=async(e,t,r,u,p,S)=>{const{storeService:m,sessionService:g,masterPasswordEncryptorService:y,eventLoggerService:A}=e,{newPassword:f,flow:E,currentPassword:h}=t,{serverKey:v}=m.getUserSession(),T=m.getState(),_=(0,a.userLoginSelector)(T);if(!_)return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,E);const I=(0,s.returnProperCryptoConfig)(m);y.setInstance({raw:f},"",I),m.dispatch((0,d.updateMasterPassword)(f)),m.dispatch((0,d.updateServerKey)(""));m.dispatch((0,d.updateRemoteKey)(null));const{authTicket:C}=(0,a.authTicketInfoSelector)(T),P=await(0,s.cipherTransactionWithNewMP)(m,g,y,r,E),D=await(0,s.cipherPrivateKey)(y,u),O={timestamp:S,transactions:(0,s.formatTransaction)(P),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:D},authTicket:C};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const b=await(0,c.uploadDataForMasterPasswordChange)(m,_,O);if((0,c.isApiError)(b))return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,y,{currentPassword:h,serverKey:v}),(0,s.makeUnexpectedErrorObject)(b.message,E);const w=await(0,c.confirmMasterPasswordChangeDone)(m,_,{});return(0,c.isApiError)(w)?((0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,y,{currentPassword:h,serverKey:v}),(0,s.makeUnexpectedErrorObject)(w.message,E)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,a.userLoginSelector)(m.getState()),sessionKey:{type:"mp",masterPassword:f,secondaryKey:""}}),{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}})}},37515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationMPtoSso=void 0;const o=r(48062),n=r(45127),a=r(751),i=r(16593),s=r(50059),c=r(33740),d=r(46298),l=r(61984);t.handleMigrationMPtoSso=async(e,t,r,u,p,S)=>{const{storeService:m,sessionService:g,remoteDataEncryptorService:y,eventLoggerService:A}=e,{newPassword:f,flow:E}=t,h=m.getState(),v=(0,i.userLoginSelector)(h);if(!v)return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.LoginError),(0,c.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,E);const{remoteKey:T,serverKeyBase64:_}=await(0,a.prepareRemoteDataEncryptionServices)(e,f),I=[T],C={type:"sso",ssoServerKey:_},{authTicket:P}=(0,i.authTicketInfoSelector)(h),D=await(0,c.cipherTransactionWithNewMP)(m,g,y,r,E),O=await(0,c.cipherPrivateKey)(y,u),b={timestamp:S,transactions:(0,c.formatTransaction)(D),remoteKeys:I,updateVerification:C,sharingKeys:{publicKey:p,privateKey:O},authTicket:P};(0,s.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const w=await(0,d.uploadDataForMasterPasswordChange)(m,v,b);if((0,d.isApiError)(w))return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.UploadError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(w.message,E);const N=await(0,d.confirmMasterPasswordChangeDone)(m,v,{});return(0,d.isApiError)(N)?((0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.ConfirmationError),(0,c.logoutUserOnError)(e),(0,c.makeUnexpectedErrorObject)(N.message,E)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,i.userLoginSelector)(m.getState()),sessionKey:{type:"sso",ssoKey:""}}),{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}})}},78238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleMigrationSSOtoMP=void 0;const o=r(48062),n=r(45127),a=r(16593),i=r(50059),s=r(33740),c=r(46298),d=r(16356),l=r(61984);t.handleMigrationSSOtoMP=async(e,t,r,u,p,S)=>{const{storeService:m,sessionService:g,masterPasswordEncryptorService:y,eventLoggerService:A}=e,{newPassword:f,flow:E}=t,h=m.getState(),v=(0,a.userLoginSelector)(h);if(!v)return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,E);const T=(0,s.returnProperCryptoConfig)(m);y.setInstance({raw:f},"",T),m.dispatch((0,d.updateMasterPassword)(f)),m.dispatch((0,d.updateServerKey)(""));m.dispatch((0,d.updateRemoteKey)(null));const{authTicket:_}=(0,a.authTicketInfoSelector)(h),I=await(0,s.cipherTransactionWithNewMP)(m,g,y,r,E),C=await(0,s.cipherPrivateKey)(y,u),P={timestamp:S,transactions:(0,s.formatTransaction)(I),updateVerification:{type:"email_token"},sharingKeys:{publicKey:p,privateKey:C},authTicket:_};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const D=await(0,c.uploadDataForMasterPasswordChange)(m,v,P);if((0,c.isApiError)(D))return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.UploadError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(D.message,E);const O=await(0,c.confirmMasterPasswordChangeDone)(m,v,{});return(0,c.isApiError)(O)?((0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.ConfirmationError),(0,s.logoutUserOnError)(e),(0,s.makeUnexpectedErrorObject)(O.message,E)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,a.userLoginSelector)(m.getState()),sessionKey:{type:"mp",masterPassword:f,secondaryKey:""}}),{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}})}},41383:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleUserChangingMP=void 0;const o=r(48062),n=r(45127),a=r(16593),i=r(50059),s=r(33740),c=r(46298),d=r(16356),l=r(61984);t.handleUserChangingMP=async(e,t,r,u,p,S)=>{const{storeService:m,sessionService:g,masterPasswordEncryptorService:y,eventLoggerService:A}=e,f=m.getState(),{newPassword:E,flow:h}=t,v=(0,s.extractCurrentPassword)(f,t),{serverKey:T}=m.getUserSession(),_=(0,a.userLoginSelector)(f);if(!_)return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.LoginError),(0,s.makeReturnErrorObject)(n.ChangeMasterPasswordCode.UNEXPECTED_STATE,h);y.setInstance({raw:E},T),m.dispatch((0,d.updateMasterPassword)(E));const I=await(0,s.cipherTransactionWithNewMP)(m,g,y,r),C=await(0,s.cipherPrivateKey)(y,u),P={timestamp:S,transactions:(0,s.formatTransaction)(I),sharingKeys:{publicKey:p,privateKey:C},uploadReason:h===n.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?"complete_account_recovery":void 0};(0,i.emitChangeMasterPasswordStatus)({type:n.ChangeMasterPasswordStepNeeded.UPLOADING,value:95});const D=await(0,c.uploadDataForMasterPasswordChange)(m,_,P);if((0,c.isApiError)(D))return(0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.UploadError),(0,s.revertOnError)(e,y,{currentPassword:v,serverKey:T}),(0,s.makeUnexpectedErrorObject)(D.message,h);const O=await(0,c.confirmMasterPasswordChangeDone)(m,_,{});return(0,c.isApiError)(O)?((0,l.logChangeMasterPasswordError)(A,o.ChangeMasterPasswordError.ConfirmationError),(0,s.revertOnError)(e,y,{currentPassword:v,serverKey:T}),(0,s.makeUnexpectedErrorObject)(O.message,h)):(await e.applicationModulesAccess.createClients().session.commands.updateUserSessionKey({email:(0,a.userLoginSelector)(m.getState()),sessionKey:{type:"mp",masterPassword:E,secondaryKey:T}}),{success:!0,response:{reason:n.ChangeMasterPasswordCode.SUCCESS}})}},15209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(35186);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},61984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logUserDeleteAccountRecoveryKey=t.logChangeMasterPasswordError=t.logChangeMasterPasswordComplete=t.logChangeMasterPasswordCancel=t.logChangeMasterPasswordStart=void 0;const o=r(48062),n=(e,t,r,n,a)=>{e.logEvent(new o.UserChangeMasterPasswordEvent({flowStep:t,errorName:r||void 0,isLeaked:n,isWeak:a}))};t.logChangeMasterPasswordStart=e=>n(e,o.FlowStep.Start);t.logChangeMasterPasswordCancel=e=>n(e,o.FlowStep.Cancel);t.logChangeMasterPasswordComplete=(e,t,r)=>n(e,o.FlowStep.Complete,void 0,t,r);t.logChangeMasterPasswordError=(e,t)=>n(e,o.FlowStep.Error,t);t.logUserDeleteAccountRecoveryKey=e=>{e.logEvent(new o.UserDeleteAccountRecoveryKeyEvent({deleteKeyReason:o.DeleteKeyReason.VaultKeyChanged}))}},62844:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPinProgressSelector=void 0;t.changeMPinProgressSelector=e=>e.userSession.changeMPData.changeMPinProgress},23486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherPrivateKey=void 0;const o=r(56668);t.cipherPrivateKey=async(e,t)=>{const r=(0,o.utf16ToDeflatedUtf8)(t,{skipDeflate:!0});return await e.getInstance().encrypt(r)}},17696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cipherTransactionWithNewMP=void 0;const o=r(45127),n=r(33740),a=r(27627),i=r(16859),s=r(75270),c=r(91301),d=r(55623),l=r(27517);t.cipherTransactionWithNewMP=async(e,t,r,u,p,S=!0)=>{const{announce:m}=t.getInstance().user.getSyncArgs(),g=await Promise.all(u.map((async t=>{if(p&&"SETTINGS"===t.type&&t.content){const r={...t,content:await(0,n.getBaseModelFromXml)(m,t.content)};switch(p){case o.ChangeMPFlowPath.MP_TO_SSO:const a={...r.content,CryptoUserPayload:c.CRYPTO_NODERIVATION_HMAC64};return{...r,content:(0,s.getTransactionXml)(a)};case o.ChangeMPFlowPath.SSO_TO_MP:const i={forceSalt:(0,d.getRandomValues)(16),cryptoConfig:(0,n.returnProperCryptoConfig)(e)},u=(0,n.returnProperSettingContent)(e,r,i);return e.dispatch((0,l.editPersonalSettings)(u)),{...t,content:(0,s.getTransactionXml)(u)};case o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:case o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:case o.ChangeMPFlowPath.USER_CHANGING_MP:case o.ChangeMPFlowPath.TO_EMAIL_TOKEN:}}return t}))),y=g.length,A=S?(0,n.initializeProgress)(o.ChangeMasterPasswordStepNeeded.ENCRYPTING,100,y):null,f=async(e,t)=>{A&&A(),t(await(0,i.encryptSingleTransaction)(r,e))};return await new Promise((e=>{(0,a.asyncMapLimit)(g,f,e,100)}))}},68328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deCipherAllTransactions=void 0;const o=r(45127),n=r(83638),a=r(33740),i=r(27627),s=r(16859),c=r(82761),d=r(70252),l=r(92263);t.deCipherAllTransactions=async(e,t,r,u=!0)=>{const{announce:p}=e.getInstance().user.getSyncArgs(),S=t.getInstance(),m=r.length,g=u?(0,a.initializeProgress)(o.ChangeMasterPasswordStepNeeded.DECRYPTING,100,m):null,y=async(e,t)=>{if(g&&g(),e.content)try{const r=await(0,s.decryptTransactionContent)(S,p,e);t({...e,content:r})}catch(r){if(e.type===n.TransactionType.SETTINGS){const t=l.CarbonError.fromAnyError(r).addContextInfo("CHANGE_MP","decipherAllTransactions").addAdditionalInfo({comment:r.message??`Transaction of type ${e.type} couldn't be decrypted`});throw(0,d.sendExceptionLog)({error:t}),r}t(null)}else t(e)},A=await new Promise((e=>{(0,i.asyncMapLimit)(r,y,e,100)}));return(0,c.sanitizeTransactions)(A)}},74931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherPrivateKey=void 0;const o=r(56668),n=r(16356);t.decipherPrivateKey=async(e,t,r)=>{const a=await t.getInstance().decrypt(r.privateKey),i=(0,o.deflatedUtf8ToUtf16)(a,{skipInflate:!0}),s={privateKey:i,publicKey:r.publicKey};return e.dispatch((0,n.updateKeyPair)(s)),i}},60950:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatTransaction=void 0;t.formatTransaction=e=>e.map((({action:e,content:t,identifier:r,time:o,type:n})=>({action:e,content:t,identifier:r,time:o,type:n})))},10078:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseModelFromXml=void 0;const o=r(80469),n=r(16859),a=r(51104);t.getBaseModelFromXml=async(e,t)=>{const r=await(0,n.parseTransactionContentXml)(e,t);return a.fixPersonalSettingTypes.fromTransaction((0,o.fixKwType)(r))}},33740:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(23486),t),n(r(17696),t),n(r(74931),t),n(r(68328),t),n(r(60950),t),n(r(10078),t),n(r(39463),t),n(r(90673),t),n(r(17433),t),n(r(99849),t),n(r(14224),t),n(r(61484),t),n(r(16494),t),n(r(55612),t),n(r(78028),t),n(r(55429),t)},39463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initializeProgress=void 0;const o=r(45127),n=r(50059);t.initializeProgress=(e,t,r)=>{const a=e===o.ChangeMasterPasswordStepNeeded.DECRYPTING?10:50;let i=0;return()=>{i++,i%t!=0&&i!==r||(0,n.emitChangeMasterPasswordStatus)({type:e,value:a+Math.round(40*i/r)})}}},90673:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isOtpStatusValid=void 0;t.isOtpStatusValid=(e,t)=>{switch(e){case"login":return t&&t.length>0;case"disabled":case"newDevice":return!t||0===t.length;default:return!1}}},17433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logoutUserOnError=void 0;const o=r(16194),n=r(1965),a=r(16593);t.logoutUserOnError=({storeService:e,storageService:t,sessionService:r,moduleClients:i})=>{const s=(0,a.userLoginSelector)(e.getState());e.dispatch((0,o.changeMPDone)()),s&&(0,n.wipeOutLocalAccounts)(t,i["carbon-legacy"],[s]),r.close()}},99849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeReturnErrorObject=void 0;const o=r(45127),n=r(50059),a=r(70252);t.makeReturnErrorObject=(e,t)=>{(0,n.emitChangeMasterPasswordStatus)({type:o.ChangeMasterPasswordStepNeeded.ERROR,value:100});const r=new Error(`[ChangeMP] ${t}: ${e}`);return(0,a.sendExceptionLog)({error:r}),{success:!1,error:{code:e}}}},14224:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUnexpectedErrorObject=void 0;const o=r(45127),n=r(70252);t.makeUnexpectedErrorObject=(e,t)=>{const r=new Error(`[ChangeMP] - Unexpected - ${t}: ${e}`);return(0,n.sendExceptionLog)({error:r}),{success:!1,error:{code:o.ChangeMasterPasswordCode.UNKNOWN_ERROR,message:e}}}},61484:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.preValidationForChangeMP=t.extractCurrentPassword=void 0;const o=r(45127),n=r(61380),a=r(57903),i=r(64948),s=r(16593),c=r(29303),d=r(88205),l=r(33740),u=r(28287),p=r(71012);t.extractCurrentPassword=(e,t)=>t.flow===o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY?(0,c.recoveryDataSelector)(e).currentPassword:t.currentPassword;t.preValidationForChangeMP=async(e,t)=>{const{applicationModulesAccess:r,masterPasswordEncryptorService:c,storeService:S}=e,{newPassword:m,flow:g}=t;if(!await(0,a.waitUntilSyncComplete)(S))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.SYNC_PROGRESS,g);const y=S.getState(),A=await(0,d.makeFeatureFlipsSelectors)(r).featureFlipsSelector();if(!S.getAccountInfo().isAuthenticated)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INNACTIVE_SESSION,g);if(A[n.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP])return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.FEATURE_BLOCKED,g);const f=await(0,i.evaluatePasswordStrengthOutOfFive)(m);if(!m||!f||f<p.minAcceptablePasswordStrength)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.MP_STRENGTH_ERROR,g);const E=(0,s.isRemoteKeyActivatedSelector)(y),h=9e5,{authTicket:v,date:T}=(0,s.authTicketInfoSelector)(y);if(!(0,s.userLoginSelector)(y))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);switch(t.flow){case o.ChangeMPFlowPath.MP_TO_SSO:if(!v||!T||Date.now()-T>h)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INVALID_TOKEN,g);if(E)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);break;case o.ChangeMPFlowPath.SSO_TO_MP:if(!v||!T||Date.now()-T>h)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.INVALID_TOKEN,g);if(!E)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g);break;case o.ChangeMPFlowPath.ADMIN_ASSISTED_RECOVERY:break;case o.ChangeMPFlowPath.TO_EMAIL_TOKEN:case o.ChangeMPFlowPath.USER_CHANGING_MP:case o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY:{const{currentPassword:e}=t;if(g!==o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY&&e===m)return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.MP_ERROR,g);if(!await(0,u.validateMasterPassword)(S,c,e))return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.WRONG_PASSWORD,g)}break;default:return(0,l.makeReturnErrorObject)(o.ChangeMasterPasswordCode.UNEXPECTED_STATE,g)}return{success:!0}}},16494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMigrationState=void 0;const o=r(45127),n=r(95363),a=r(7624);t.resetMigrationState=async(e,t)=>{if(t===o.ChangeMPFlowPath.USER_CHANGING_MP||t===o.ChangeMPFlowPath.TO_EMAIL_TOKEN||t===o.ChangeMPFlowPath.ACCOUNT_RECOVERY_KEY)return;const{storeService:r}=e;r.dispatch((0,n.resetRecoverySessionData)()),r.dispatch((0,a.resetSSOSettings)()),t===o.ChangeMPFlowPath.MP_TO_SSO&&r.dispatch((0,a.storeSSOSettings)({ssoUser:!0}))}},55612:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperCryptoConfig=void 0;const o=r(56668),n=r(65675),a=r(92310);t.returnProperCryptoConfig=e=>{let t=o.ARGON2_DEFAULT_PAYLOAD;const r=(0,a.currentSpaceInfoSelector)(e.getState());r?.cryptoForcedPayload&&(t=r.cryptoForcedPayload);try{return(0,n.parsePayload)(t).cryptoConfig}catch(e){return(0,n.makeFlexibleMarkerCryptoConfig)("argon2d")}}},78028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.returnProperSettingContent=void 0;const o=r(56668),n=r(16038),a=r(95648),i=r(92310);t.returnProperSettingContent=(e,t,r)=>{let s=o.ARGON2_DEFAULT_PAYLOAD;const c=(0,i.currentSpaceInfoSelector)(e.getState());return c?.cryptoForcedPayload&&(s=c.cryptoForcedPayload),{...(0,a.makeBasePersonalSettings)(),...t.content,CryptoUserPayload:s,CryptoFixedSalt:(0,n.bufferToBase64)(r.forceSalt)}}},55429:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.revertOnError=void 0;const o=r(16194),n=r(16356);t.revertOnError=async(e,t,r)=>{const{currentPassword:a,serverKey:i}=r,{storeService:s}=e;t.setInstance({raw:a},i),s.dispatch((0,n.updateMasterPassword)(a)),s.dispatch((0,n.updateServerKey)(i)),s.dispatch((0,o.changeMPDone)())}},61380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP=void 0,t.CHANGEMP_WEB_BLOCKED_FEATURE_FLIP="disableChangeMpOnWeb"},20849:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToDebugEvents=void 0;const o=r(95623),n=e=>(t,r)=>{const{message:o,details:n={}}=r;t[e]({date:(new Date).toJSON(),message:o,optionalParams:Object.keys(n).reduce(((e,t)=>[...e,n[t]]),[])})},a=e=>{switch(e){case o.LogLevel.Error:return n("error");case o.LogLevel.Warn:return n("warning");case o.LogLevel.Info:return n("info");case o.LogLevel.Debug:case o.LogLevel.Verbose:default:return n("log")}};t.subscribeToDebugEvents=function(e){(0,o.redirectConsoleLogs)((t=>{const{level:r=o.LogLevel.Debug}=t;a(r)(e,t)}))}},39947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonE2EConnector=void 0;const o=r(30504);t.carbonE2EConnector={registerFreeTrial:(0,o.slot)(),getTeamTokens:(0,o.slot)(),confirmFreeTrial:(0,o.slot)(),getPremiumStatus:(0,o.slot)(),proposeMembers:(0,o.slot)(),acceptTeamInvite:(0,o.slot)(),getTokenForTestUser:(0,o.slot)(),getServiceProviderToken:(0,o.slot)(),createOrUpdateDarkWebBreach:(0,o.slot)(),addPrivateBreach:(0,o.slot)(),createPublicBreach:(0,o.slot)(),forceBreachRefresh:(0,o.slot)(),getUserCryptoPayload:(0,o.slot)()}},58427:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=void 0;const o=r(3674),n=r(17338),a=r(37864),i=r(71602),s=r(32006),c=r(79734);t.subscribeToE2EEvents=function(e,t){const r=(0,n.getCoreServices)(t),d=(0,o.makeTeamAdminController)(r.storeService,r.wsService);e.registerFreeTrial.on(d.registerFreeTrial),e.getTeamTokens.on(d.getTeamTokens),e.confirmFreeTrial.on(d.confirmFreeTrial),e.getPremiumStatus.on(d.getPremiumStatus),e.proposeMembers.on(d.proposeMembers),e.acceptTeamInvite.on(d.acceptTeamInvite),e.getTokenForTestUser.on((e=>(0,a.getTokenForKwUser)(r,e))),e.getServiceProviderToken.on((e=>(0,i.getServiceProviderToken)(r,e))),e.createOrUpdateDarkWebBreach.on((e=>(0,c.createOrUpdateDarkWebBreachHelper)(r,e))),e.addPrivateBreach.on((e=>(0,c.addPrivateBreachHelper)(r,e))),e.createPublicBreach.on((e=>(0,c.createPublicBreachHelper)(r,e))),e.forceBreachRefresh.on((()=>{(0,s.forceBreachRefreshHandler)(r)})),e.getUserCryptoPayload.on((()=>r.storeService.getPersonalSettings().CryptoUserPayload))}},30855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToE2EEvents=t.carbonE2EConnector=void 0;var o=r(39947);Object.defineProperty(t,"carbonE2EConnector",{enumerable:!0,get:function(){return o.carbonE2EConnector}});var n=r(58427);Object.defineProperty(t,"subscribeToE2EEvents",{enumerable:!0,get:function(){return n.subscribeToE2EEvents}})},19697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},39421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},44242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToMaverickEvents=void 0;const o=r(19065),n=r(17338),a=r(38865),i=r(39421);t.subscribeToMaverickEvents=function(e,t){(0,i.setEventBus)(e);const r=(0,n.getCoreServices)(t),s=(0,o.makeDataManagementController)(r);e.savePersonalDataItem.on((e=>{s.savePersonalDataItem(e)})),e.filledDataItem.on((e=>s.updateMetadataItemFilledOnPage(e.id,e.url,e.dataType))),e.updateWebOnboardingMode.on((e=>(0,a.updateWebOnboardingMode)(r.storeService,r.sessionService,e)))}},21726:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setEventBus=void 0;let r=null;t.setEventBus=e=>{r=e},t.default=function(){return r}},4798:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToExtensionEvents=void 0;const o=r(2246),n=r(90622),a=r(70252),i=r(38865),s=r(25576),c=r(17338),d=r(5464),l=r(88610),u=r(21726);t.subscribeToExtensionEvents=function(e,t){(0,u.setEventBus)(e);const r=(0,c.getCoreServices)(t),{storeService:p,storageService:S}=r,m=(0,l.makeLoginController)(r),g=(0,d.makeSessionController)(r);e.getAccountInfo.on((()=>g.getAndTriggerRefreshAccountInfo())),e.getLocalAccountsList.on((()=>(0,n.getLocalAccounts)(p,S).then((e=>({localAccounts:e}))))),e.getAnonymousLogsMetadata.on((()=>({anonymouscomputerid:(0,o.getCommonAppSetting)("anonymousComputerId")}))),e.askWebsiteInfo.on((({fullUrl:e})=>g.askWebsiteInfo(e))),e.checkIfMasterPasswordIsValid.on((e=>g.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.closeSession.on((()=>g.closeSession())),e.lockSession.on((()=>g.lockSession())),e.openSession.on((({login:e,password:t})=>m.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:o,deviceName:n})=>{m.openSessionWithToken(e,t,r,o?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,n)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:o})=>{m.openSessionWithDashlaneAuthenticator(e,t,r?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,o)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{m.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{m.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{m.openSessionWithOTP(e.login,e.password,e.otp)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:o,deviceName:n})=>{m.openSessionWithOTPForNewDevice(e,t,r,o?s.PersistData.PERSIST_DATA_YES:s.PersistData.PERSIST_DATA_NO,n)})),e.sessionForceSync.on((e=>{g.sessionForceSync(e.trigger)})),e.updateWebOnboardingMode.on((e=>{i.updateWebOnboardingMode(r.storeService,r.sessionService,e)})),e.exceptionLog.on((e=>(0,a.sendTypedExceptionLog)("extensionException",e)))}},75391:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeToLeelooEvents=void 0;const o=r(71703),n=r(70252),a=r(25576),i=r(90622),s=r(17338),c=r(5464),d=r(38865),l=r(88610),u=r(15444),p=r(3674),S=r(58415),m=r(97124),g=r(33332),y=r(89675),A=r(19065),f=r(19697);t.subscribeToLeelooEvents=function(e,t){(0,f.setEventBus)(e);const r=(0,s.getCoreServices)(t),{storeService:E,localStorageService:h,wsService:v,sessionService:T,storageService:_}=r,I=(0,o.makeAccountCreationController)(r),C=(0,c.makeSessionController)(r),P=(0,l.makeLoginController)(r),D=(0,A.makeDataManagementController)(r),O=(0,u.makeRecoveryController)(E,v),b=(0,y.makeSettingsController)(E,v),w=(0,p.makeTeamAdminController)(E,v),N=(0,m.makeSharingService)(E,v),R=(0,S.makeDirectorySyncController)({storeService:E,localStorageService:h,wsService:v,sessionService:T,sharingService:N}),M=(0,g.makeStaticDataController)();e.getUki.on((()=>C.getUki())),e.savePaymentCard.on((e=>{D.savePaymentCardFromClient(e)})),e.savePersonalDataItem.on((e=>D.savePersonalDataItem(e))),e.getAccountInfo.on((()=>C.getAndTriggerRefreshAccountInfo())),e.getLocalAccountsList.on((()=>(0,i.getLocalAccounts)(E,_).then((e=>({localAccounts:e}))))),e.cancelPremiumSubscription.on((()=>C.cancelPremiumSubscription())),e.getInvoices.on((()=>C.getInvoices().then((e=>({invoices:e}))))),e.closeSession.on((()=>C.closeSession())),e.lockSession.on((()=>C.lockSession())),e.resumeSession.on((()=>C.resumeSession())),e.getPersonalSettings.on((()=>C.getPersonalSettings().then((e=>e)))),e.openSession.on((({login:e,password:t})=>P.openSession(e,{password:t}))),e.openSessionWithToken.on((({login:e,password:t,token:r,persistData:o,deviceName:n})=>{P.openSessionWithToken(e,t,r,o?a.PersistData.PERSIST_DATA_YES:a.PersistData.PERSIST_DATA_NO,n)})),e.openSessionWithDashlaneAuthenticator.on((({login:e,password:t,persistData:r,deviceName:o})=>{P.openSessionWithDashlaneAuthenticator(e,t,r?a.PersistData.PERSIST_DATA_YES:a.PersistData.PERSIST_DATA_NO,o)})),e.cancelDashlaneAuthenticatorRegistration.on((()=>{P.cancelDashlaneAuthenticatorRegistration()})),e.openSessionResendToken.on((e=>{P.openSessionResendToken(e.login)})),e.openSessionWithOTP.on((e=>{P.openSessionWithOTP(e.login,e.password,e.otp,void 0,e.withBackupCode)})),e.openSessionWithOTPForNewDevice.on((({login:e,password:t,otp:r,persistData:o,deviceName:n,withBackupCode:i})=>{P.openSessionWithOTPForNewDevice(e,t,r,o?a.PersistData.PERSIST_DATA_YES:a.PersistData.PERSIST_DATA_NO,n,i)})),e.sessionForceSync.on((e=>C.sessionForceSync(e.trigger))),e.exceptionLog.on((e=>(0,n.sendTypedExceptionLog)("leelooException",e))),e.teamUpdated.on((e=>w.teamUpdateHandler(e).then((e=>({errors:e}))))),e.createUserGroup.on((e=>w.createUserGroupAction(T,e))),e.deleteUserGroup.on((e=>w.deleteUserGroupAction(e))),e.renameUserGroup.on((e=>w.renameUserGroupAction(e))),e.inviteUserGroupMembers.on((e=>w.inviteUserGroupMembersAction(e))),e.revokeUserGroupMembers.on((e=>w.revokeUserGroupMembersAction(e))),e.updateUserGroupMembers.on((e=>w.updateUserGroupMembersAction(e))),e.createAccountStep1.on((e=>I.createAccount(e))),e.createAccountStep2.on((e=>I.confirmAccountCreation(e))),e.checkLogin.on((e=>I.checkLogin(e))),e.getMasterPasswordResetDemandList.on((e=>O.getMasterPasswordResetDemandList(e))),e.acceptMasterPasswordResetDemand.on((e=>O.acceptMasterPasswordResetDemand(e))),e.checkIfMasterPasswordIsValid.on((e=>C.validateMasterPassword(e.masterPassword).then((e=>({isMasterPasswordValid:e}))))),e.declineMasterPasswordResetDemand.on((e=>O.declineMasterPasswordResetDemand(e))),e.getMembers.on((e=>w.getMembers(e))),e.addTeamAdmin.on((e=>w.addTeamAdmin(e))),e.removeTeamAdmin.on((e=>w.removeTeamAdmin(e))),e.setTeamSettings.on((e=>b.setTeamSettings(e))),e.updateWebOnboardingMode.on((e=>d.updateWebOnboardingMode(E,T,e))),e.checkDirectorySyncKeyResponse.on((e=>{const{teamId:t,publicKey:r,requestId:o,response:n}=e;"validated"===n?R.keyValidatedByTacAdmin(t,r):"rejected"===n&&R.keyRejectedByTacAdmin(t,o)})),e.queryStaticDataCollections.on((e=>M.query(e)))}},49267:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(75653),n=r(57193);t.config={commands:{changeUserCrypto:{handler:n.changeUserCrypto}},queries:{getCanUserChangeCrypto:{selector:o.canUserSelectCryptoSelector},getUserDerivationMethod:{selector:o.userDerivationMethodSelector}},liveQueries:{liveUserDerivationMethod:{operator:o.userDerivationMethodSelector$}}}},21344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(49267);t.bootstrap=e=>{e.register(o.config)}},21583:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(21344);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},75653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userDerivationMethodSelector$=t.userDerivationMethodSelector=t.canUserSelectCryptoSelector=t.teamCryptoForcedPayloadSelector=void 0;const o=r(18948),n=r(3343),a=r(45127),i=r(7944),s=r(65675),c=r(16593);t.teamCryptoForcedPayloadSelector=e=>{const t=(0,i.activeSpacesSelector)(e)[0];return t?.details.info.cryptoForcedPayload??""};t.canUserSelectCryptoSelector=e=>!(0,t.teamCryptoForcedPayloadSelector)(e);t.userDerivationMethodSelector=e=>{switch((0,c.userDefaultCryptoSelector)(e)){case s.ARGON2_DEFAULT_PAYLOAD:return a.SupportedDerivationMethods.ARGON2D;case s.PBKDF2_DEFAULT_PAYLOAD:return a.SupportedDerivationMethods.PBKDF2;case s.KWC3_DEFAULT_PAYLOAD:return a.SupportedDerivationMethods.KWC3;default:return null}};t.userDerivationMethodSelector$=()=>(0,o.pipe)((0,n.map)(t.userDerivationMethodSelector),(0,n.distinctUntilChanged)())},57193:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeUserCrypto=void 0;const o=r(48062),n=r(55696),a=r(48238);t.changeUserCrypto=async function(e,{newDerivationMethod:t}){const{storeService:r}=e,i=r.getPersonalSettings().CryptoUserPayload,s=(0,a.getNewCryptoPayload)(t);if(!s)throw new Error(`[changeUserCrypto] - client sent wrong derivation value (${t})`);return await(0,n.migrateUserCrypto)(e,i,s,o.CryptoMigrationType.SettingsChange)}},77965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllTransactions=void 0;const o=r(16859),n=r(83638);t.decryptAllTransactions=async function(e,t,r){const{announce:a}=r.getInstance().user.getSyncArgs(),i=e.map((async e=>({...e,content:await(0,o.decryptTransactionContent)(t.getInstance(),a,e).catch((t=>{if(e.type!==n.TransactionType.SETTINGS)return"";throw t}))})));return(await Promise.all(i)).filter((e=>!!e.content))}},9027:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptAllUserData=void 0;const o=r(33740),n=r(77965);t.decryptAllUserData=async function(e,t,r,{transactions:a,sharingKeys:i}){try{const s=await(0,n.decryptAllTransactions)(a,r,e);return{clearTransactions:s,clearPrivateKey:await(0,o.decipherPrivateKey)(t,r,i)}}catch(e){throw new Error(`decipherAllUserData failed with error: ${e}`)}}},73909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDataToMigrate=void 0;const o=r(48062),n=r(46298),a=r(16593);t.getDataToMigrate=async function(e,t){try{const t=e.getState(),r=(0,a.userLoginSelector)(t),o=await(0,n.getDataForMasterPasswordChange)(e,r,{});if((0,n.isApiError)(o))throw new Error(`getDataDoMigrate failed with error: ${o}`);return{transactions:o.data.transactions,sharingKeys:o.data.sharingKeys,timestamp:o.timestamp}}catch(e){throw t(o.CryptoMigrationStatus.ErrorDownload),new Error(`getDataDoMigrate failed with error: ${e}`)}}},48238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewCryptoPayload=void 0;const o=r(45127),n=r(65675);t.getNewCryptoPayload=function(e){switch(e){case o.SupportedDerivationMethods.ARGON2D:return n.ARGON2_DEFAULT_PAYLOAD;case o.SupportedDerivationMethods.PBKDF2:return n.PBKDF2_DEFAULT_PAYLOAD;case o.SupportedDerivationMethods.KWC3:return n.KWC3_DEFAULT_PAYLOAD;default:return}}},18767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reEncryptAllUserData=void 0;const o=r(48062),n=r(33740),a=r(16859);t.reEncryptAllUserData=async function(e,{clearTransactions:t,clearPrivateKey:r},i){try{const o=t.map((t=>(0,a.encryptSingleTransaction)(e,t))),i=await Promise.all(o);return{encryptedTransactions:i,encryptedPrivateKey:await(0,n.cipherPrivateKey)(e,r)}}catch(e){throw i(o.CryptoMigrationStatus.ErrorReencryption),new Error(`reEncryptAllUserData failed with error: ${e}`)}}},46076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetMasterPasswordEncryptorService=void 0;const o=r(65675),n=r(16593);t.resetMasterPasswordEncryptorService=function(e,t){const{storeService:r,masterPasswordEncryptorService:a}=e,i=r.getState(),s=(0,n.masterPasswordSelector)(i),c=(0,n.serverKeySelector)(i),d=t===o.KWC3_DEFAULT_PAYLOAD?(0,o.getLegacyCryptoConfig)(t):(0,o.parsePayload)(t).cryptoConfig;a.setInstance({raw:s},c,d)}},36116:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAndPersistLocalData=void 0;const o=r(48062),n=r(16038),a=r(55623),i=r(27517);t.updateAndPersistLocalData=async function(e,t,r,s,c){try{e.dispatch((0,i.editPersonalSettings)({CryptoUserPayload:s,CryptoFixedSalt:(0,n.bufferToBase64)((0,a.getRandomValues)(16))})),await t.getInstance().user.persistPersonalSettings();const o=await r.getInstance().getLocalKey();await t.getInstance().user.persistLocalKey(o)}catch(e){throw c(o.CryptoMigrationStatus.ErrorUpdateLocalData),new Error(`updateAndPersistLocalData failed with error: ${e}`)}}},34726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataOnServer=void 0;const o=r(48062),n=r(33740),a=r(46298),i=r(69214),s=r(16593);t.uploadDataOnServer=async function(e,t,r){try{const r=e.getState(),o=(0,s.userLoginSelector)(r),c={...t,transactions:(0,n.formatTransaction)(t.transactions)},d=await(0,i.uploadDataForCryptoChange)(e,o,c);if((0,a.isApiError)(d))throw new Error(`uploadDataForCryptoChange failed with error: ${d}`)}catch(e){throw r(o.CryptoMigrationStatus.ErrorUpload),new Error(`uploadDataForCryptoChange failed with error: ${e}`)}}},55696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.migrateUserCrypto=void 0;const o=r(48062),n=r(45127),a=r(65675),i=r(70252),s=r(57903),c=r(9027),d=r(73909),l=r(18767),u=r(46076),p=r(36116),S=r(34726),m={[a.KWC3_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Kwc3,[a.ARGON2_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Argon2d,[a.PBKDF2_DEFAULT_PAYLOAD]:o.CryptoAlgorithm.Pbkdf2};t.migrateUserCrypto=async function(e,t,r,a){try{const{sessionService:i,storeService:g,masterPasswordEncryptorService:y,localStorageService:A,eventLoggerService:f}=e;if(!await(0,s.waitUntilSyncComplete)(g))return{success:!1,error:{code:n.CryptoMigrationApiErrorType.ChangeUserCryptoFailed}};const E=e=>f.logEvent(new o.UserMigrateCryptoEvent({newCrypto:m[r],previousCrypto:m[t],type:a,status:e})),{transactions:h,sharingKeys:v,timestamp:T}=await(0,d.getDataToMigrate)(g,E),{clearTransactions:_,clearPrivateKey:I}=await(0,c.decryptAllUserData)(i,g,y,{transactions:h,sharingKeys:v});(0,u.resetMasterPasswordEncryptorService)(e,r);const{encryptedTransactions:C,encryptedPrivateKey:P}=await(0,l.reEncryptAllUserData)(y,{clearTransactions:_,clearPrivateKey:I},E);return await(0,S.uploadDataOnServer)(g,{timestamp:T,transactions:C,sharingKeys:{publicKey:v.publicKey,privateKey:P}},E),await(0,p.updateAndPersistLocalData)(g,i,A,r,E),await i.getInstance().user.attemptSync(o.Trigger.SettingsChange),E(o.CryptoMigrationStatus.Success),{success:!0}}catch(r){return(0,u.resetMasterPasswordEncryptorService)(e,t),(0,i.sendExceptionLog)({funcName:"migrateUserCrypto",fileName:"/carbon/src/CryptoMigration/services/migrate-user-crypto.ts",message:`Migration from KWC3 to Argon2 failed with error: ${r}`}),{success:!1,error:{code:n.CryptoMigrationApiErrorType.ChangeUserCryptoFailed,message:r.message}}}}},63549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(55696),n=r(48062),a=r(75653),i=r(65675),s=r(16593);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on((()=>{const{storeService:e}=t,r=e.getState(),c=(0,a.teamCryptoForcedPayloadSelector)(r),d=(0,s.userDefaultCryptoSelector)(r);c||d!==i.KWC3_DEFAULT_PAYLOAD?c&&c!==d&&(0,o.migrateUserCrypto)(t,d,c,n.CryptoMigrationType.TeamEnforced):(0,o.migrateUserCrypto)(t,i.KWC3_DEFAULT_PAYLOAD,i.ARGON2_DEFAULT_PAYLOAD,n.CryptoMigrationType.MigrateLegacy)}))}},44812:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(52921),n=r(31858);t.config={commands:{getDarkWebInsightsReportResults:{handler:o.getDarkWebInsightsReportResults},getDarkWebInsightsSummary:{handler:n.getDarkWebInsightsSummary}},queries:{},liveQueries:{}}},1945:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(44812);t.bootstrap=e=>{e.register(o.config)}},76592:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(1945);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},52921:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsReportResults=void 0;const o=r(45127),n=r(16593),a=r(46298),i=r(82512);t.getDarkWebInsightsReportResults=async function(e,t){const{storeService:r}=e,s=r.getState(),c=(0,n.userLoginSelector)(s),d=await(0,i.getDarkWebInsightReport)(r,c,t);return(0,a.isApiError)(d)?{success:!1,error:{code:o.DarkWebInsightsApiErrorType.GetDarkWebInsightsFailed,message:`get Dark Web Insights Report failed: ${d.message}`}}:{success:!0,data:d}}},31858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummary=void 0;const o=r(45127),n=r(16593),a=r(46298),i=r(19667);t.getDarkWebInsightsSummary=async function(e){const{storeService:t}=e,r=t.getState(),s=(0,n.userLoginSelector)(r),c=await(0,i.getDarkWebInsightsSummaryRequest)(t,s);return(0,a.isApiError)(c)?{success:!1,error:{code:o.DarkWebInsightsApiErrorType.GetDarkWebInsightsSummaryFailed,message:`get Dark Web Insights Summary failed: ${c.message}`}}:{success:!0,data:c}}},52578:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCredentialSmartCategorized=t.isSpaceQuarantined=void 0;const o=r(15318),n=r(6205);t.isSpaceQuarantined=function(e){return!!e&&(!("accepted"===e.details.status.toLowerCase()||!e.details.info)&&(Boolean(e.details.info.forcedDomainsEnabled)&&Boolean(e.details.info.removeForcedContentEnabled)))},t.isCredentialSmartCategorized=function(e,t){if(!e)return!1;let r="";if(e.Url){const t=new o.ParsedURL(e.Url).getRootDomain();r=t?t.toLowerCase():""}const a=e.Email?e.Email.toLowerCase():"",i=e.Login?e.Login.toLowerCase():"",s=e.SecondaryLogin?e.SecondaryLogin.toLowerCase():"",c=(0,n.getUserAddedLinkedWebsiteDomains)(e).map((e=>e.toLowerCase()));return t.filter((e=>{const t=e.toLowerCase();return r.includes(t)||a.includes(t)||i.includes(t)||s.includes(t)||c.some((e=>e.includes(t)))})).length>0}},76235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(4914),n=r(43837),a=r(2946),i=r(13648),s=r(15141),c=r(2282),d=r(81911),l=r(8453),u=r(68728),p=r(17025),S=r(57718),m=r(75912),g=r(80818),y=r(3474),A=r(80529),f=r(60309),E=r(45665),h=r(25856),v=r(11230),T=r(16458);t.config={commands:{...T.vaultConfig.commands,...o.config.commands,...n.config.commands,...a.config.commands,...i.config.commands,...m.config.commands,...s.config.commands,...y.config.commands,...c.config.commands,...v.importApiConfig.commands,...g.config.commands,...d.config.commands,...l.config.commands,...u.config.commands,...p.config.commands,...A.config.commands,...f.config.commands,...S.config.commands,...h.config.commands},queries:{...T.vaultConfig.queries,...o.config.queries,...a.config.queries,...m.config.queries,...y.config.queries,...v.importApiConfig.queries,...g.config.queries,...d.config.queries,...u.config.queries,...p.config.queries,...A.config.queries,...f.config.queries,...E.config.queries},liveQueries:{...o.config.liveQueries,...a.config.liveQueries,...y.config.liveQueries,...v.importApiConfig.liveQueries,...g.config.liveQueries,...d.config.liveQueries,...u.config.liveQueries,...p.config.liveQueries,...A.config.liveQueries,...f.config.liveQueries}}},14369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNewBankAccount=void 0;const o=r(92882),n=r(53),a=r(78320);t.getNewBankAccount=e=>{const t=(0,n.getUnixTimestamp)();return{kwType:"KWBankStatement",Id:(0,a.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,o.defaultToUS)(e.country),SpaceId:(0,o.defaultToEmptyString)(e.spaceId),CreationDatetime:t,UserModificationDatetime:t,BankAccountName:(0,o.defaultToEmptyString)(e.name),BankAccountOwner:(0,o.defaultToEmptyString)(e.owner),BankAccountIBAN:(0,o.defaultToEmptyString)(e.IBAN),BankAccountBIC:(0,o.defaultToEmptyString)(e.BIC),BankAccountBank:(0,o.defaultToEmptyString)(e.bank)}}},8639:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(14369),t)},92882:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankInfoFromBankAccountData=t.defaultToUS=t.defaultToEmptyString=void 0;const o=r(62433),n=r(45127),a=r(85406);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToUS=(0,o.defaultTo)(n.Country.US);t.getBankInfoFromBankAccountData=e=>{const r=(0,t.defaultToUS)(e.LocaleFormat),{banks:o}=(0,a.getBanks)({country:r}),n=((e,r)=>{if(r){const[o,n]=(0,t.defaultToEmptyString)(e).split("-"),a=r.find((({code:e})=>[o,n].includes(e)))?.code;return a||"NO_TYPE"}return""})(e.BankAccountBank,o),i=n?.length>0?`${r}-${n}`:"",s=(0,t.defaultToEmptyString)(o?.find((({code:e})=>e===n))?.localizedString);return{country:r,bankCode:n,bankLocalizedName:s,bank:i}}},48931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBankAccountSpecificProps=t.makeNewBankAccount=t.makeUpdatedBankAccount=void 0;const o=r(62433),n=r(53),a=r(78163);function i(e){const t=(0,o.defaultTo)("");return{BankAccountName:t(e.name),BankAccountOwner:t(e.owner),BankAccountIBAN:t(e.IBAN),BankAccountBIC:t(e.BIC),BankAccountBank:t(e.bank)}}t.makeUpdatedBankAccount=async function(e,t,r){const o=(0,a.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()});return{...r,...o,...i(t.content)}},t.makeNewBankAccount=async function(e,t){return{...(0,a.makeNewPersonalDataItemBase)(e,t),...i(t.content)}},t.makeBankAccountSpecificProps=i},60931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBankAccountMappers=void 0;const o=r(83539);t.getBankAccountMappers=()=>({spaceId:e=>e.SpaceId,accountName:e=>e.BankAccountName,bankName:e=>e.BankAccountBank,lastUse:o.lastUseMapper,id:e=>e.Id})},53704:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bankAccountMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("BankAccountName"),(0,n.stringProp)("BankAccountOwner"),(0,n.stringProp)("BankAccountBank")],t.bankAccountMatch=(0,o.match)(t.searchGetters)},16018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryBankAccountsSelector=t.bankAccountSelector=t.bankAccountsSelector=void 0;const o=r(53704),n=r(24589),a=r(49551),i=r(32034),s=r(60931),c=r(57989),d=r(40602);t.bankAccountsSelector=(0,i.createSelector)((e=>e.userSession.personalData.bankAccounts),c.quarantinedSpacesSelector,d.filterOutQuarantinedItems);t.bankAccountSelector=(e,r)=>{const o=(0,t.bankAccountsSelector)(e);return(0,a.findDataModelObject)(r,o)};t.queryBankAccountsSelector=(0,n.getQuerySelector)(t.bankAccountsSelector,(()=>o.bankAccountMatch),(e=>(0,s.getBankAccountMappers)()))},4914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(21342),n=r(52283),a=r(44444);t.config={commands:{updateBreachStatus:{handler:a.updateBreachStatusHandler}},queries:{getBreach:{selector:o.viewedBreachSelector},getBreaches:{selector:o.viewedQueriedBreachesSelector},getBreachesPage:{selector:o.breachesPageSelector},getBreachesPaginationToken:{selector:o.breachesPaginationTokenSelector},getBreachesUpdateStatus:{selector:o.breachesUpdaterStatusSelector}},liveQueries:{liveBreach:{operator:n.getBreach$},liveBreaches:{operator:n.breaches$},liveBreachesBatch:{operator:n.breachesBatch$},liveBreachesUpdaterStatus:{operator:n.breachesUpdaterStatus$}}}},95303:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=void 0;const o=r(45127),n=r(70252),a=r(90622),i=r(16593),s=r(88205),c=r(36017),d=r(75130),l=r(44331),u=r(38785),p=r(45291),S=r(87838),m=r(21342);class g{constructor(e,t,r,o,n){this.storeService=e,this.applicationModulesAccess=t,this.credentialVault=r,this.breachVault=o,this.gateway=n,this.refreshInProgress=!1}async refresh(e){try{if(this.refreshInProgress)return{vaultSyncNeeded:!1};this.refreshInProgress=!0,this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(o.BreachesUpdaterStatus.SYNCING));const t=Boolean(e&&e.forceRefresh);if(!await this.isFeatureFlipped()||!this.isSessionOpened()||!this.isRefreshNeeded(t))return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(o.BreachesUpdaterStatus.SKIPPED)),this.refreshInProgress=!1,{vaultSyncNeeded:!1};const{breachVault:r,credentialVault:n}=this,a=await this.fetchLatestPublicBreaches(),i=await this.fetchLatestPrivateBreaches();this.resetTimer();const s=n.getAllCredentials(),d=r.getAllBreaches(),l=[...a.breaches,...i.breaches],u=(0,c.getChangesFromIncomingBreaches)(s,d,l);await r.applyChangesFromSync(u,a.revision,i.refreshDate);const S=this.isVaultSyncNeeded(u);return this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(S?o.BreachesUpdaterStatus.UPDATED:o.BreachesUpdaterStatus.UNCHANGED)),{vaultSyncNeeded:S}}catch(e){this.storeService.dispatch((0,p.updateBreachesUpdaterStatus)(o.BreachesUpdaterStatus.ERROR));const t=new Error(`[Breaches] - refresh: ${e}`);return(0,n.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING}),{vaultSyncNeeded:!1}}finally{this.refreshInProgress=!1}}async isFeatureFlipped(){const{applicationModulesAccess:e}=this,t=await(0,s.makeFeatureFlipsSelectors)(e).featureFlipsSelector();return Boolean(t)&&t[g.BREACHES_REFRESH_FEATURE_FLIP]}isSessionOpened(){const{storeService:e}=this,t=e.getState(),r=(0,i.userLoginSelector)(t),o=(0,a.ukiSelector)(t);return Boolean(o&&r)}isRefreshNeeded(e){const t=this.storeService.getState(),r=(0,m.lastBreachRefreshTimestampSelector)(t);return e||Date.now()-r>=g.BREACHES_REFRESH_INTERVAL_MS}resetTimer(){this.storeService.dispatch((0,S.updateBreachRefreshTimestamp)(Date.now()))}isVaultSyncNeeded(e){return e.updates.length+e.deletions.length>0}async fetchLatestPublicBreaches(){const e=this.breachVault.getLatestPublicBreachesRevision();return this.gateway.getLatestPublicBreaches(e)}async fetchLatestPrivateBreaches(){const e=this.breachVault.getPrivateBreachesRefreshDate();let t,r=[];try{const o=await this.gateway.getLatestPrivateBreaches(e);o&&(r=o.breaches,t=o.refreshDate)}catch(e){const t=new Error(`[Breaches] - refresh: fetchPrivateBreaches error: ${e}`);(0,n.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING})}return{breaches:r,refreshDate:t}}}g.BREACHES_REFRESH_INTERVAL_MS=864e5,g.BREACHES_REFRESH_FEATURE_FLIP="breachesFetchWeb";let y=null;t.getInstance=(e,t,r)=>(null===y&&(y=new g(t,e,new l.CredentialVault(t),new d.BreachVault(t),new u.BreachesWS(r,t))),y);t.clearInstance=()=>{y=null}},36017:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getChangesFromIncomingBreaches=void 0;const o=r(45127),n=r(90073),a=r(67083),i=r(86715),s=r(25656),c=r(83480),d=e=>({updates:[e],deletions:[]}),l=(e,t)=>({updates:[...e.updates,...t.updates],deletions:[...e.deletions,...t.deletions]}),u=e=>Boolean(e.Password),p=e=>Array.from(new Set(e)),S=(e,t)=>{const{content:r}=e,{leakedPasswords:n}=e;let a=n;if((0,c.hasBreachLeakedDataOfType)(r,o.BreachLeakedDataType.Password)){const{eventDate:e}=r,o=t.filter((e=>t=>1e3*(t.ModificationDatetime||t.CreationDatetime||0)<Date.parse(e))(e)).filter(u).map((e=>e.Password));a=[...n,...o]}return p(a||[])},m=function(e,t,r){const{content:o}=r,{id:n,lastModificationRevision:l}=o,u=(0,c.findByBreachId)(n,t);if(u){if(l<=u.ContentRevision)return{updates:[],deletions:[]};if((0,c.isBreachDeleted)(o))return{updates:[],deletions:[u.Id]}}const m=((e,t)=>(t.content.domains??[]).reduce(((t,r)=>[...t,...e.get(r)??[]]),[]))(e,r),g=S(r,m);return((e,t,r)=>{const o=!(0,i.isDataLeaksBreachContent)(e),n=r.length>0,a=(0,c.hasBreachLeakedPrivateInfo)(e),s=t.length>0;return o&&!n&&(!a||!s)})(o,m,g)?{updates:[],deletions:[]}:d(u?((e,t,r)=>{const o=p(e.LeakedPasswords||[]),n=p([...e.LeakedPasswords,...r]),i=o.length!==n.length?a.BreachStatus.PENDING:e.Status;return{...e,Content:t,ContentRevision:t.lastModificationRevision,LeakedPasswords:n,Status:i}})(u,o,g):(0,s.makeBreachFromContent)(o,g))};t.getChangesFromIncomingBreaches=function(e,t,r){const o=new Map;return e.forEach((e=>{const t=(0,n.getDomainForCredential)(e)||"",r=o.get(t)??[];o.set(t,[...r,e])})),r.reduce(((e,r)=>l(e,m(o,t,r))),{updates:[],deletions:[]})}},25656:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeBreachFromContent=void 0;const o=r(45127),n=r(78320),a=r(67083);t.makeBreachFromContent=(e,t)=>({kwType:o.DataModelType.KWSecurityBreach,LastBackupTime:0,Id:(0,n.generateItemUuid)(),BreachId:e.id,Content:e,ContentRevision:e.lastModificationRevision,Status:a.BreachStatus.PENDING,LeakedPasswords:t})},44444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachStatus=t.updateBreachStatusHandler=void 0;const o=r(48062),n=r(48313),a=r(23136),i=r(70252),s=r(95623),c=r(21342);function d(e,t){if(!e.isAuthenticated())throw new Error("No session available to update Breach");const r=e.getState(),o=(0,c.breachSelector)(r,t.id);if(!o)throw new Error("Breach does not exist, cant update");const a={...o,Status:t.status};e.dispatch((0,n.savePersonalDataItem)(a,a.kwType))}t.updateBreachStatusHandler=async function(e,t){const{storeService:r,sessionService:n}=e;try{d(r,t);return(0,a.getDebounceSync)(r,n)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return s.Debugger.error(e),(0,i.sendExceptionLog)({error:e}),{success:!1}}},t.updateBreachStatus=d},38785:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachesWS=void 0;const o=r(62433),n=r(14656),a=r(45127),i=r(35587),s=r(36513),c=r(56984),d=r(72365),l=r(16038),u=r(32607),p=r(70252),S=r(16593),m=r(90622),g=r(48162),y=r(86715),A=r(83480),f=r(48162),E=r(56668);t.BreachesWS=class{constructor(e,t){this.wsService=e,this.storeService=t}async getLatestPublicBreaches(e){const t=this.storeService.getState(),r=(0,S.userLoginSelector)(t),o=(0,m.ukiSelector)(t);if(null===r||null===o)throw new Error("[Breaches] - getLatestPublicBreaches: no current authenticated user");const n=await this.wsService.breaches.get({login:r,uki:o,revision:e});if(!(0,u.isWSResponseSuccess)(n)){const e=`[Breaches] getLatestPublicBreaches: ${n.message}(statusCode: ${n.code})`;throw new Error(e)}const{content:a}=n,{latest:i,filesToDownload:s,revision:c}=a,d=[...i,...await this.downloadFileBreaches(s)].filter(y.isSupportedBreachContent);return{revision:c,breaches:(0,A.deduplicateBreachContents)(d).map((e=>(0,f.makeIncomingBreach)(e,[])))}}async getLatestPrivateBreaches(e){const t=this.storeService.getState(),r=(0,S.premiumStatusSelector)(t);if(!(0,g.hasDarkWebMonitoringFeature)(r))return null;const o=(0,S.userLoginSelector)(t),n=(0,m.ukiSelector)(t);if(null===o||null===n)throw new Error("[Breaches] - getLatestPrivateBreaches: no current authenticated user");const a=await this.wsService.dataleaks.leaks({login:o,uki:n,wantsDetails:!0,includeDisabled:!1,lastUpdateDate:e});if(!(0,u.isWSResponseSuccess)(a)){if((0,f.isBreachesWSResponseNotModified)(a))return{breaches:[],refreshDate:e};const t=a.error&&a.error.code?`, code: ${a.error.code}`:"",r=`[Breaches] - getLatestPrivateBreaches: ${a.message} (statusCode: ${a.code}${t})`;throw new Error(r)}const{content:i}=a,{details:s,leaks:c,lastUpdateDate:d}=i,l=await this.extractLeakedPasswords(s),p=c.filter(y.isSupportedBreachContent);return{breaches:(0,A.deduplicateBreachContents)(p).map((e=>(0,f.makeIncomingBreach)(e,l[e.id]||[]))),refreshDate:d}}async downloadFileBreaches(e){return(0,o.flatten)(await(0,i.asyncMap)(e,this.downloadFileBreach))}async downloadFileBreach(e){try{const{data:t}=await(0,n.get)(e);return t.breaches}catch(e){const t=new Error(`[Breaches] - downloadFileBreach: ${e}`);return(0,p.sendExceptionLog)({error:t,code:a.ExceptionCriticality.ERROR}),[]}}async extractLeakedPasswords(e){try{if(!e||!e.cipheredKey||!e.cipheredInfo)return{};const t=this.storeService.getState(),r=(0,S.sharingKeysSelector)(t);if(!r||!r.publicKey||!r.privateKey)return{};const{privateKey:o}=r,n=(0,s.makeAsymmetricEncryption)({hashAlgorithm:c.HashAlgorithm.SHA_1}),a=await n.decrypt(o,e.cipheredKey),i=(0,d.makeDataEncryptorService)(this.storeService),u=(0,l.base64ToBuffer)(a),p=(0,l.arrayBufferToText)(u);i.setInstance({raw:p},"");const m=await i.getInstance().decrypt(e.cipheredInfo),g=(0,E.deflatedUtf8ToUtf16)(m,{skipInflate:!0}),y=JSON.parse(g);return(0,f.getLeakedPasswordFromIncomingDataLeakDetails)(y)}catch(e){const t=new Error(`[Breaches] - extractLeakedPasswords: ${e}`);return(0,p.sendExceptionLog)({error:t}),{}}}}},12756:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIncomingDataLeakPasswordInfo=t.isIncomingDataLeakBreachDetails=void 0;const o=r(62433);t.isIncomingDataLeakBreachDetails=e=>(0,o.is)(Object,e)&&"string"==typeof e.breachId&&""!==e.breachId&&Array.isArray(e.data);t.isIncomingDataLeakPasswordInfo=e=>(0,o.is)(Object,e)&&"password"===e.type&&"plaintext"===e.hashMethod&&"string"==typeof e.value&&""!==e.value},48162:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasDarkWebMonitoringFeature=t.isBreachesWSResponseNotModified=t.getLeakedPasswordFromIncomingDataLeakDetails=t.makeIncomingBreach=void 0;const o=r(12756);t.makeIncomingBreach=(e,t)=>({content:e,leakedPasswords:t});t.getLeakedPasswordFromIncomingDataLeakDetails=e=>{if(!Array.isArray(e))return{};const t=e=>(0,o.isIncomingDataLeakPasswordInfo)(e)?e.value:null;return e.reduce(((e,r)=>{if(!(0,o.isIncomingDataLeakBreachDetails)(r))return e;const{breachId:n,data:a}=r,i=a.map(t).filter(Boolean);return i.length?{...e,[n]:i}:e}),{})};t.isBreachesWSResponseNotModified=e=>304===e.code,t.hasDarkWebMonitoringFeature=function(e){if(!e)return!1;const{capabilities:t}=e;return Boolean(t?.dataLeak?.enabled)}},75130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachVault=void 0;const o=r(45291),n=r(12362),a=r(86691),i=r(21342);t.BreachVault=class{constructor(e){this.storeService=e}async applyChangesFromSync(e,t,r){const i=(0,o.breachesUpdated)(e,t,r);let s=null;const{updates:c,deletions:d}=e,l=c.length+d.length,u=(0,n.getInstance)(),p=(0,a.getInstance)();try{l&&(s=p.lockTopic("iconsUpdates"),await u.add("iconsUpdates",{type:"breachUpdates",breachesIds:c.map((e=>e.Id))})),this.storeService.dispatch(i),l&&p.releaseTopic("iconsUpdates",s)}catch(e){throw s&&p.releaseTopic("iconsUpdates",s),e}}getAllBreaches(){const e=this.storeService.getState();return(0,i.breachesSelector)(e)}getLatestPublicBreachesRevision(){const e=this.storeService.getState();return(0,i.publicBreachesRevisionSelector)(e)}getPrivateBreachesRefreshDate(){const e=this.storeService.getState();return(0,i.privateBreachesLastUpdateTimestamp)(e)}}},44331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialVault=void 0;const o=r(51319);t.CredentialVault=class{constructor(e){this.storeService=e}getAllCredentials(){const e=this.storeService.getState();return(0,o.credentialsSelector)(e)}}},9335:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailItemView=void 0;const o=r(62433),n=r(88749),a=r(86715),i=r(90451),s=(0,o.defaultTo)([]);function c({name:e,domains:t}){if(e)return e;if(t.length>0){const[e]=t;return e}return""}function d(e,t){if(t&&0!==t.length)return(0,i.getIcon)(e)(t[0])}function l(e,t){const r=t.Content,o=(0,a.isDataLeaksBreach)(t)?t.Content.impactedEmails:[];return{domains:s(r.domains),breachType:(0,n.breachTypeMapper)(t),domainIcon:d(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:o,name:c(r),status:t.Status}}t.detailItemView=function(e,t){const r=t.Content,o=(0,a.isDataLeaksBreach)(t)?t.Content.impactedEmails:[],i=new Set;return{breachType:(0,n.breachTypeMapper)(t),domains:s(r.domains),domainIcon:d(e,t.Content.domains),eventDate:r.eventDate,id:t.Id,impactedEmails:o,kwType:t.kwType,leakedData:s(r.leakedData),leakedPasswords:s(t.LeakedPasswords),name:c(r),status:t.Status,compromisedCredentialIds:[...i]}},t.itemView=l,t.listView=function(e,t){return t.map((t=>l(e,t)))}},83480:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasBreachLeakedPrivateInfo=t.hasBreachLeakedDataOfType=t.isBreachDeleted=t.findByBreachId=t.deduplicateBreachContents=void 0;const o=r(62433),n=r(45127),a=r(67083),i=r(86715),s=(0,o.takeLast)(1);t.deduplicateBreachContents=(0,o.pipe)((0,o.groupBy)((0,o.prop)("id")),(0,o.mapObjIndexed)((0,o.sortBy)((0,o.prop)("lastModificationRevision"))),(0,o.mapObjIndexed)((e=>s(e))),o.values,o.flatten);t.findByBreachId=(e,t)=>t.find((t=>t.BreachId===e));t.isBreachDeleted=e=>e.status===a.BreachEnvStatus.Deleted;t.hasBreachLeakedDataOfType=(e,t)=>(e.leakedData||[]).findIndex((e=>t===e))>=0;t.hasBreachLeakedPrivateInfo=e=>(0,i.isDataLeaksBreachContent)(e)||((e,t)=>(e.leakedData||[]).findIndex((e=>t.some((t=>t===e))))>=0)(e,[n.BreachLeakedDataType.Email,n.BreachLeakedDataType.Username,n.BreachLeakedDataType.CreditCard,n.BreachLeakedDataType.Phone,n.BreachLeakedDataType.Address,n.BreachLeakedDataType.SSN,n.BreachLeakedDataType.IP,n.BreachLeakedDataType.Location,n.BreachLeakedDataType.PersonalInfo,n.BreachLeakedDataType.SocialNetwork])},86715:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicBreach=t.isDataLeaksBreach=t.isDataLeaksBreachContent=t.isBreach=t.isSupportedBreach=t.isSupportedBreachContent=void 0;const o=r(62433),n=e=>(0,o.is)(Object,e);function a(e){return function(e){return n(e)&&"number"==typeof e.breachModelVersion}(e)&&1===e.breachModelVersion&&Array.isArray(e.domains)&&"string"==typeof e.eventDate&&"string"==typeof e.id}function i(e){return s(e)&&a(e.Content)}function s(e){return Boolean(e)&&"KWSecurityBreach"===e.kwType}function c(e){return function(e){return"impactedEmails"in e&&Array.isArray(e.impactedEmails)}(e)&&e.impactedEmails.length>0}t.isSupportedBreachContent=a,t.isSupportedBreach=i,t.isBreach=s,t.isDataLeaksBreachContent=c;t.isDataLeaksBreach=e=>i(e)&&c(e.Content);t.isPublicBreach=e=>i(e)&&!c(e.Content)},52283:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachesUpdaterStatus$=t.getBreach$=t.breaches$=t.breachesBatch$=void 0;const o=r(18948),n=r(3343),a=r(35893),i=r(33627),s=r(55220),c=r(21342);t.breachesBatch$=e=>{const t=(0,a.parseToken)(e),r=(0,c.getViewedBreachesBatchSelector)(t);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(i.sameBatch))},t.breaches$=(0,s.getLivePersonalInfo)(c.getLiveBreachesSelector),t.getBreach$=function(e){const t=(0,c.getViewedBreachSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())};t.breachesUpdaterStatus$=()=>(0,o.pipe)((0,n.map)(c.breachesUpdaterStatusSelector),(0,n.distinctUntilChanged)())},88749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachMappers=t.breachTypeMapper=void 0;const o=r(86715);function n(e){return(0,o.isDataLeaksBreach)(e)?"private":"public"}t.breachTypeMapper=n;t.getBreachMappers=()=>({breachType:e=>n(e),eventDate:e=>function({eventDate:e}){return Date.parse(e)}(e.Content),id:e=>e.Id,status:e=>e.Status})},69623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBreachesBatch=t.viewBreachesBatch=t.getBreachesFirstToken=t.getBreacheSortToken=t.getBreachesFilterToken=void 0;const o=r(62433),n=r(20553),a=r(9335);t.getBreachesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getBreacheSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getBreachesFirstToken=(e,t,r,o)=>(0,n.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewBreachesBatch=(e,t)=>(0,a.listView)(e,t),t.getBreachesBatch=(0,o.curry)(((e,t,r)=>(0,n.getBatch)(r,e,t)))},37600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachMatch=t.searchGetters=void 0;const o=r(64455);t.searchGetters=[],t.breachMatch=(0,o.match)(t.searchGetters)},21342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lastBreachRefreshTimestampSelector=t.breachesUpdaterStatusSelector=t.getViewedBreachSelector=t.getViewedBreachesBatchSelector=t.getLiveBreachesSelector=t.fieldMappersSelector=t.breachesQuerySelector=t.breachesPaginationTokenSelector=t.breachesPageSelector=t.viewedQueriedBreachesSelector=t.breachMappersSelector=t.viewedBreachSelector=t.breachSelector=t.privateBreachesLastUpdateTimestamp=t.publicBreachesRevisionSelector=t.breachesSelector=void 0;const o=r(18948),n=r(32034),a=r(86715),i=r(49551),s=r(63566),c=r(24589),d=r(35893),l=r(20553),u=r(97006),p=r(9335),S=r(88749),m=r(37600),g=r(69623),y=r(91892),A=(0,n.createSelector)((e=>e.userSession.personalData.securityBreaches),(e=>e.filter(a.isSupportedBreach)));t.breachesSelector=(0,n.createSelector)(A,(e=>[...e.reduce(((e,t)=>{const r=e.get(t.BreachId);return(!r||r.LastBackupTime<t.LastBackupTime)&&e.set(t.BreachId,t),e}),new Map).values()]));t.publicBreachesRevisionSelector=e=>e.userSession.personalData.securityBreachesMetadata.latestPublicBreachesRevision;function f(e,r){const o=(0,t.breachesSelector)(e);return(0,i.findDataModelObject)(r,o)}t.privateBreachesLastUpdateTimestamp=e=>e.userSession.personalData.securityBreachesMetadata.latestDataLeaksBreachesUpdate,t.breachSelector=f,t.viewedBreachSelector=function(e,t){const r=(0,y.iconsSelector)(e),o=f(e,t);return(0,p.detailItemView)(r,o)};t.breachMappersSelector=e=>(0,S.getBreachMappers)();const E=()=>m.breachMatch,h=(0,c.getQuerySelector)(t.breachesSelector,E,t.breachMappersSelector),v=(0,n.createSelector)(y.iconsSelector,(e=>t=>(0,g.viewBreachesBatch)(e,t)));t.viewedQueriedBreachesSelector=(e,t)=>{const r=h(e,t),o=v(e);return(0,s.viewListResults)(o)(r)},t.breachesPageSelector=function(e,r){const o=(0,d.parseToken)(r),{sortToken:n,filterToken:a}=o,i={sortToken:n,filterToken:a},s=(0,S.getBreachMappers)(),c=(0,t.breachesQuerySelector)(e,i),u=v(e),p=(0,l.generateNextToken)(s,o,c),m=(0,l.generatePrevToken)(s,o,c),g=(0,l.getBatch)(s,o,c),y=(0,d.stringifyToken)(p),A=(0,d.stringifyToken)(m);return{batch:u(g),nextToken:y,prevToken:A}};t.breachesPaginationTokenSelector=(e,r)=>{const o=(0,g.getBreacheSortToken)(r),n=(0,g.getBreachesFilterToken)(r),a=(0,S.getBreachMappers)(),i={sortToken:o,filterToken:n},s=(0,t.breachesQuerySelector)(e,i),c=(0,g.getBreachesFirstToken)(a,i,r,s);return(0,d.stringifyToken)(c)};const T=(0,d.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity),_=(0,d.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity);t.breachesQuerySelector=(0,n.createSelector)(S.getBreachMappers,E,T,_,t.breachesSelector,d.queryData),t.fieldMappersSelector=(0,n.createSelector)(t.breachesSelector,S.getBreachMappers),t.getLiveBreachesSelector=(0,u.makeLiveSelectorGetter)(t.breachesSelector,v,E,t.breachMappersSelector);t.getViewedBreachesBatchSelector=e=>{const{sortToken:r,filterToken:o}=e,a={sortToken:r,filterToken:o},i=(0,g.getBreachesBatch)(e),s=(0,n.createSelector)((e=>(0,t.breachesQuerySelector)(e,a)),t.fieldMappersSelector,i),c=(0,d.optimizeBatchSelector)(s);return(0,n.createSelector)(y.iconsSelector,c,g.viewBreachesBatch)},t.getViewedBreachSelector=function(e){const r=(0,n.createSelector)(t.breachesSelector,(t=>(0,i.findDataModelObject)(e,t)));return(0,n.createSelector)(y.iconsSelector,r,p.detailItemView)};t.breachesUpdaterStatusSelector=e=>e.userSession.personalData.breachesUpdaterStatus;t.lastBreachRefreshTimestampSelector=e=>e.userSession.breachRefreshMetaData.lastBreachRefreshTimestamp},79405:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(95303);t.setupSubscriptions=function(e,t){const{applicationModulesAccess:r,storeService:n,wsService:a}=t;e.syncSuccess.on((()=>{(0,o.getInstance)(r,n,a).refresh({forceRefresh:!1})}))}},67083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BreachCriticality=t.BreachEnvStatus=t.BreachStatus=void 0,function(e){e.PENDING="PENDING",e.VIEWED="VIEWED",e.ACKNOWLEDGED="ACKNOWLEDGED"}(t.BreachStatus||(t.BreachStatus={})),function(e){e.Legacy="legacy",e.Live="live",e.Staging="staging",e.Deleted="deleted"}(t.BreachEnvStatus||(t.BreachEnvStatus={})),function(e){e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error"}(t.BreachCriticality||(t.BreachCriticality={}))},40220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentData=t.getChangeSet=t.getChangedProperties=t.getChangedPropertiesForRemoval=void 0;const o=r(62433),n=r(78320),a=r(53),i={KWAuthentifiant:{Email:"",Login:"",Note:"",Password:"",SecondaryLogin:"",Title:"",Url:"",UserSelectedUrl:"",LinkedServices:{associated_domains:[]}},KWSecureNote:{Content:"",Title:""},KWSecret:{Content:"",Title:""}};function s(e){const t=i[e.kwType];return Object.keys(t).filter((r=>"LinkedServices"===r?e[r]?.associated_domains&&e[r].associated_domains.length>0:e[r]&&e[r]!==t[r]))}t.getChangedPropertiesForRemoval=s;const c=(e,t)=>e.length===t.length&&e.sort().join("")===t.sort().join("");function d(e,t){const r=i[e.kwType];return Object.keys(r).filter((r=>{if("LinkedServices"===r){const o=(e[r]?.associated_domains??[]).map((e=>e.domain)),n=(t[r]?.associated_domains??[]).map((e=>e.domain));return!c(o,n)}return e[r]&&""!==e[r]&&e[r]!==t[r]}))}function l(e){return Object.keys(i[e.kwType]).reduce(((t,r)=>(t[r]="LinkedServices"===r?e[r]?.associated_domains?e[r]:{associated_domains:[]}:e[r]||"",t)),{})}t.getChangedProperties=d,t.getChangeSet=function(e){const{change:t,deviceName:r,oldItem:i,userLogin:c,platformInfo:u}=e;if((0,o.isNil)(i))return null;const p="removal"===t.type?s(i):d(i,t.updatedItem);return 0===p.length?null:{kwType:"KWChangeSet",ChangedProperties:p,CurrentData:l(i),Id:(0,n.generateItemUuid)(),Platform:u.platformName,DeviceName:r||"",ModificationDate:(0,a.getUnixTimestamp)(),Removed:(0,o.defaultTo)(!1,"removal"===t.type),User:c}},t.getCurrentData=l},85225:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeRemovalChange=t.makeUpdateChange=void 0;t.makeUpdateChange=e=>({type:"update",updatedItem:e});t.makeRemovalChange=e=>({type:"removal",itemId:e.Id,itemKwType:e.kwType})},73566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedItemChangeHistory=t.isChangeHistoryCandidate=t.getEmptyChangeHistory=void 0;const o=r(62433),n=r(45127),a=r(78320),i=r(40220),s=r(83638),c=r(49551);function d(e){const[t,r,o]="removal"===e.type?[e.itemId,e.itemKwType,""]:[e.updatedItem.Id,e.updatedItem.kwType,e.updatedItem.Title||""];return{kwType:"KWDataChangeHistory",ChangeSets:[],Id:(0,a.generateItemUuid)(),ObjectId:t,ObjectTitle:o,ObjectType:(0,s.getTransactionTypeFromDataModelType)(r),LastBackupTime:0}}t.getEmptyChangeHistory=d;const l=(e,t)=>(0,o.equals)(t.CurrentData,e.CurrentData);t.isChangeHistoryCandidate=function(e){return(0,n.isCredential)(e)||(0,n.isNote)(e)||(0,n.isSecret)(e)},t.getUpdatedItemChangeHistory=function(e){const{deviceName:t,personalData:r,change:a,userLogin:s,platformInfo:u}=e,[p,S,m]="removal"===a.type?[a.itemId,a.itemKwType,""]:[a.updatedItem.Id,a.updatedItem.kwType,a.updatedItem.Title],g=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[S],y=(0,c.findDataModelObject)(p,r[g]),A=(0,i.getChangeSet)({deviceName:t,change:a,oldItem:y,userLogin:s,platformInfo:u});if(!A)return null;const f=r.changeHistories.find((e=>e?.ObjectId?.toUpperCase()===(p||"").toUpperCase())),E=f||d(a),h=(0,o.last)(E.ChangeSets);return h&&l(h,A)?null:{...E,ObjectTitle:m,ChangeSets:E.ChangeSets.concat(A)}}},35385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsHistoriesSelector=void 0;const o=r(32034),n=r(40602),a=r(57989),i=r(83638),s=e=>e.ObjectType===i.TransactionType.AUTHENTIFIANT,c=(0,o.createSelector)((e=>e.userSession.personalData.changeHistories),(e=>e.filter(s)));t.credentialsHistoriesSelector=(0,o.createSelector)([c,a.quarantinedSpacesSelector],n.filterOutQuarantinedItems)},43837:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(42682);t.config={commands:{addCollection:{handler:o.addCollectionHandler},deleteCollection:{handler:o.deleteCollectionHandler},removeItemsFromCollections:{handler:o.removeItemsFromCollectionsHandler},updateCollection:{handler:o.updateCollectionHandler}},queries:{},liveQueries:{}}},55740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addCollectionHandler=t.getNewCollection=void 0;const o=r(45127),n=r(48062),a=r(23136),i=r(48313),s=r(53),c=r(78320),d=r(70252),l=r(13675);function u(e){const t=(0,s.getUnixTimestamp)();return{kwType:"KWCollection",Id:(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:o.Country.UNIVERSAL,SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Name:e.name,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))}}t.getNewCollection=u,t.addCollectionHandler=async function(e,t){try{const r=await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to addCollection");const o=u((0,l.sanitizeInputPersonalData)(r));if(!o.SpaceId){const t=await(0,a.getDefaultSpaceId)(e);o.SpaceId=t}return e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData(),o.Id}(e,t);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},n.Trigger.Save),{success:!0,id:r}}catch(e){return(0,d.sendExceptionLog)({error:e}),{success:!1}}}},9833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCollectionHandler=void 0;const o=r(45127),n=r(48062),a=r(23136),i=r(70252),s=r(45291);t.deleteCollectionHandler=async function(e,t){try{await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to deleteCollection");const n=(0,s.removePersonalItem)(o.DataModelType.KWCollection,r,null);e.dispatch(n),t.getInstance().user.persistPersonalData()}(e,t.id);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},n.Trigger.Save),{success:!0}}catch(e){return(0,i.sendExceptionLog)({error:e}),{success:!1}}}},42682:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(55740),t),n(r(9833),t),n(r(73240),t),n(r(6366),t)},73240:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeItemsFromCollectionsHandler=void 0;const o=r(53626),n=r(6366);t.removeItemsFromCollectionsHandler=async function(e,t){const r=e.storeService.getState(),a=(0,o.collectionsSelector)(r),i=[];let s,c;if(a.forEach((e=>{s=e.VaultItems.length,e.VaultItems=e.VaultItems.filter((e=>!t.ids.includes(e.Id))),c=e.VaultItems.length,s!==c&&i.push(e)})),!i.length)return;const d=i.map((t=>(0,n.updateCollectionHandler)(e,{id:t.Id,name:t.Name,spaceId:t.SpaceId,vaultItems:t.VaultItems.map((e=>({id:e.Id,type:e.Type})))})));return{success:!(await Promise.all(d)).some((e=>!e.success))}}},6366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCollectionHandler=void 0;const o=r(48062),n=r(23136),a=r(48313),i=r(53),s=r(70252),c=r(13675),d=r(53626),l=e=>({LastUse:(0,i.getUnixTimestamp)(),Name:e.name,SpaceId:e.spaceId,VaultItems:e.vaultItems.map((e=>({Id:e.id,Type:e.type})))});async function u(e,t,r){if(!e.isAuthenticated())throw new Error("No session available to updateCollection");const o=function(e,t){const r=(0,d.collectionSelector)(e,t.id);if(!r)throw new Error("[updateCollection]: unable to find collection to update.");return{...r,...l(t)}}(e.getState(),(0,c.sanitizeInputPersonalData)(r));return e.dispatch((0,a.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData()}t.updateCollectionHandler=async function(e,t){try{await u(e.storeService,e.sessionService,t);return(0,n.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0}}catch(e){return(0,s.sendExceptionLog)({error:e}),{success:!1}}}},10770:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(42682),t),n(r(53626),t),n(r(182),t)},53626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collectionSelector=t.collectionsSelector=void 0;const o=r(49551);t.collectionsSelector=e=>e.userSession.personalData.collections;t.collectionSelector=(e,r)=>{const n=(0,t.collectionsSelector)(e);return(0,o.findDataModelObject)(r,n)}},182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCollectionNamesContainingVaultItemId=void 0;t.getCollectionNamesContainingVaultItemId=(e,t,r=[])=>t.flatMap((t=>t.VaultItems.some((t=>t.Id===e))?t.Name:[])).concat(r.flatMap((t=>t.vaultItems.some((t=>t.id===e))?t.name:[])))},2946:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(71806),n=r(10043),a=r(35410),i=r(80920),s=r(60581),c=r(66663),d=r(28831),l=r(73567),u=r(9763),p=r(70853);t.config={commands:{addCredential:{handler:u.createCredential},updateCredential:{handler:p.updateCredentialHandler}},queries:{getCredential:{selector:s.viewedCredentialSelector},getCredentials:{selector:c.viewedQueriedCredentialsSelector},getCredentialsByDomain:{selector:d.viewedQueriedCredentialsByDomainSelector},getCredentialsCount:{selector:o.credentialsCountSelector},getCredentialsPage:{selector:n.credentialsPageSelector},getCredentialsPaginationToken:{selector:a.credentialsPaginationTokenSelector},getShouldShowRequireMasterPassword:{selector:i.shouldShowRequireMasterPasswordSelector}},liveQueries:{liveCredential:{operator:l.getCredential$},liveCredentials:{operator:l.credentials$},liveCredentialsByDomain:{operator:l.credentialsByDomain$},liveCredentialsBatch:{operator:l.credentialsBatch$},liveCredentialsCount:{operator:l.credentialsCount$}}}},39373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleLimitedSharedCredentialsPassword=t.removeCredentialsWithQuarantinedSpaces=t.fixCredentialsWithMissingTitles=t.fixCredentialWithMissingTitle=void 0;const o=r(52578),n=r(89489),a=r(90073),i=r(37275);function s(e){return e.Title?e:Object.assign({},e,{Title:(0,a.getDomainForCredential)(e)})}t.fixCredentialWithMissingTitle=s,t.fixCredentialsWithMissingTitles=function(e){return e.map(s)},t.removeCredentialsWithQuarantinedSpaces=function(e,t){if(!e.spaces||0===e.spaces.length)return t;const r=[];return e.spaces.filter(o.isSpaceQuarantined).forEach((e=>{const n=e.details.info&&e.details.info.teamDomains?e.details.info.teamDomains:[];t.filter((e=>(0,o.isCredentialSmartCategorized)(e,n))).forEach((t=>{""!==t.SpaceId&&t.SpaceId===e.details.teamId&&r.push(t)}))})),t.filter((e=>!r.includes(e)))},t.handleLimitedSharedCredentialsPassword=function(e,t,r){const o=(0,i.getSharingDataWithCollections)(t),a=(0,n.getLimitedSharedItemIds)(t,o.collections,o.itemGroups,r);return e.map((e=>a[e.Id]?Object.assign({},e,{Password:"************",limitedPermissions:!0}):e))}},36439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countCredentials=void 0;const o=r(35893);t.countCredentials=(e,t,r,n)=>(0,o.filterData)(e,t,r,n).length},90073:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainForCredential=void 0;const o=r(15318);t.getDomainForCredential=e=>new o.ParsedURL(e.Url).getRootDomain()},70853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredentialHandler=void 0;const o=r(95623),n=r(70252),a=r(88779);t.updateCredentialHandler=async function(e,t){const{storeService:r,sessionService:i,eventLoggerService:s,applicationModulesAccess:c}=e;try{return await(0,a.updateCredential)({storeService:r,sessionService:i,eventLoggerService:s,applicationModulesAccess:c},t),{success:!0}}catch(e){return(0,o.logError)(e),(0,n.sendExceptionLog)({error:e}),{success:!1}}}},23529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsDisplayTitles=void 0;const o=r(90073);t.getCredentialsDisplayTitles=function(e){const t=e.reduce(((e,t)=>{const{Id:r,Title:n}=t,a=n||(0,o.getDomainForCredential)(t);return e.concat([[r,a]])}),[]);return new Map(t)}},88542:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewCredential=t.afterCredentialSaved=t.notifySharersCredentialUpdated=t.makeCredentialSpecificProps=t.makeNewCredential=t.makeUpdatedCredential=t.beforeCredentialChange=t.sharedFields=t.SaveFrom=void 0;const o=r(62433),n=r(50415),a=r(45127),i=r(15318),s=r(47975),c=r(87496),d=r(61923),l=r(48313),u=r(53);t.SaveFrom=(0,n.Enum)("MANUAL","SAVE_PASSWORD","DATACAPTURE","IMPORT");const p=r(70252),S=r(78163),m=r(43145),g=r(65968),y=r(83687),A=r(92307),f=r(90451),E=r(45127);t.sharedFields=["Email","Login","Note","OtpSecret","OtpUrl","Password","SecondaryLogin","Title","Url","UseFixedUrl","UserSelectedUrl","LinkedServices"];const h=(e,t)=>({...e,content:{...e.content,category:t}}),v=(0,o.defaultTo)("");function T(e,t){const{url:r}=e.content,o=void 0===r,n=t?.UserSelectedUrl??"",i=t?.UseFixedUrl??!1,s=t?.TrustedUrlGroup??[],d=e.origin===a.SaveOrigin.MANUAL,l=!o&&t?.Url!==r,u=(0,c.cleanUrlForPersonalData)(o?t?.Url:r,{keepQueryString:d}),p=d&&l?{UserSelectedUrl:u,UseFixedUrl:!0}:{UserSelectedUrl:n,UseFixedUrl:i};return{Url:u,TrustedUrlGroup:(0,c.getUpdatedTrustedUrlList)(s,u),...p}}async function _(e,t,r=(0,u.getUnixTimestamp)()){const{content:n}=e,a={associated_domains:n.linkedWebsites?.addedByUser?.map((e=>({source:E.LinkedWebsiteSource.Manual,domain:e})))??t?.LinkedServices?.associated_domains??[]},i=function(e,t){return({itemField:r,existingItemField:n,defaultValue:a})=>(0,o.isNil)(e[r])?t&&!(0,o.isNil)(t[n])?t[n]:a:e[r]}(n,t),{email:c,login:l,secondaryLogin:p}=(0,d.normalizeUsernames)(i({itemField:"email",existingItemField:"Email",defaultValue:""}),i({itemField:"login",existingItemField:"Login",defaultValue:""}),i({itemField:"secondaryLogin",existingItemField:"SecondaryLogin",defaultValue:""})),S=i({itemField:"password",existingItemField:"Password",defaultValue:""}),m=!t||t.Password!==S?{ModificationDatetime:r}:{};return{AutoLogin:i({itemField:"autoLogin",existingItemField:"AutoLogin",defaultValue:!0}),AutoProtected:i({itemField:"protectWithMasterPassword",existingItemField:"AutoProtected",defaultValue:!1}),Category:i({itemField:"category",existingItemField:"Category",defaultValue:""}),Checked:i({itemField:"checked",existingItemField:"Checked",defaultValue:!1}),Email:c,Login:l,Note:i({itemField:"note",existingItemField:"Note",defaultValue:""}),Password:S,SecondaryLogin:p,Status:"ACCOUNT_NOT_VERIFIED",Strength:S?await(0,s.evaluatePasswordStrength)(S):0,SubdomainOnly:i({itemField:"onlyForThisSubdomain",existingItemField:"SubdomainOnly",defaultValue:!1}),Title:i({itemField:"title",existingItemField:"Title",defaultValue:""}),...T(e,t),OtpSecret:i({itemField:"otpSecret",existingItemField:"OtpSecret",defaultValue:void 0}),OtpUrl:i({itemField:"otpUrl",existingItemField:"OtpUrl",defaultValue:void 0}),LinkedServices:a,...m}}t.beforeCredentialChange=function(e,t){const r=t.credentialCategories,o=e.content.category;if(!o)return e;if(r.find((e=>e.Id===o)))return e;const n=r.find((e=>e.CategoryName===o));return h(e,n?n.Id:"")},t.makeUpdatedCredential=async function(e,t,r){const o=(0,u.getUnixTimestamp)(),n=await _(t,r,o);return{...r,...(0,S.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:o}),...n}},t.makeNewCredential=async function(e,t){const r=(0,u.getUnixTimestamp)(),o=await _(t,null,r);return function(e){const{Title:t,Url:r}=e;return{...e,Title:t||v(new i.ParsedURL(r).getRootDomain())}}({...(0,S.makeNewPersonalDataItemBase)(e,t,r),...o})},t.makeCredentialSpecificProps=_,t.notifySharersCredentialUpdated=async function(e,r,n,a){if(!!(0,o.equals)((0,o.pick)(t.sharedFields,r),(0,o.pick)(t.sharedFields,n)))return!0;try{return await(0,S.notifySharersOnUpdate)(e,n,a),!0}catch(e){const t=new Error(`[Sharing] - Failed to update shared item: ${e}`);return(0,p.sendExceptionLog)({error:t}),!1}},t.afterCredentialSaved=function(e,t){(0,m.associateGeneratedPasswordsToCredential)(e.getPersonalData().generatedPasswords,t).forEach((t=>{e.dispatch((0,l.saveGeneratedPassword)(t))}))},t.viewCredential=function(e,t,r,o,n,a){if(!e)return;const i=(0,y.getSharingStatusDetail)(o,t,r),s=(0,f.getIcon)(n),c=(0,A.getSmartCategorizedSpace)(a);return(0,g.detailView)(i,s,c,e)}},73567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsByDomain$=t.credentials$=t.credentialsCount$=t.getCredential$=t.credentialsBatch$=void 0;const o=r(18948),n=r(3343),a=r(71806),i=r(61645),s=r(86685),c=r(78767),d=r(65950),l=r(35893),u=r(33627),p=r(55220);t.credentialsBatch$=e=>{const t=(0,l.parseToken)(e),r=(0,c.getViewedCredentialsBatchSelector)(t);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(u.sameBatch))};t.getCredential$=e=>{const t=(0,s.getViewedCredentialSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())};t.credentialsCount$=e=>{const t=(0,l.parseToken)(e);return(0,o.pipe)((0,n.map)((e=>(0,a.credentialsCountSelector)(e,t))),(0,n.distinctUntilChanged)())},t.credentials$=(0,p.getLivePersonalInfo)(i.getLiveCredentialsSelector);t.credentialsByDomain$=e=>{const{domain:t,...r}=(0,l.parseToken)(e),a=(0,d.getLiveCredentialsByDomainSelector)(t)(r);return(0,o.pipe)((0,n.map)(a),(0,n.distinctUntilChanged)(((e,t)=>e.matchingCount===t.matchingCount&&(0,u.sameBatch)(e.items,t.items))))}},94687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialMappers=void 0;const o=r(62433),n=r(83539),a=(0,o.curry)(((e,t)=>e.get(t.Id)||"")),i=e=>!!e.Attachments&&e.Attachments.length>0,s=(0,o.curry)(((e,t)=>!!e[t.Id]));t.getCredentialMappers=(e,t)=>({hasAttachments:i,id:e=>e.Id,isLimited:s(e),lastUse:n.lastUseMapper,login:e=>e.Login,numberUse:e=>e.NumberUse,spaceId:e=>e.SpaceId,title:a(t),email:e=>e.Email})},25501:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsBatch=t.viewCredentialsBatch=t.getCredentialsFirstToken=t.getCredentialsSortToken=t.getCredentialsFilterToken=void 0;const o=r(62433),n=r(20553),a=r(29179),i=r(90451);t.getCredentialsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getCredentialsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getCredentialsFirstToken=(e,t,r,o)=>(0,n.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewCredentialsBatch=(e,t)=>{const r=(0,i.getIcon)(t);return(0,a.listView)(r,e)},t.getCredentialsBatch=(0,o.curry)(((e,t,r)=>(0,n.getBatch)(r,e,t)))},31400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialMatcher=void 0;const o=r(64455),n=r(82234),a=r(6205);t.credentialMatcher=(0,o.match)([(0,n.stringProp)("Email"),(0,n.stringProp)("Login"),(0,n.stringProp)("Title"),(0,n.stringProp)("Note"),(0,n.stringProp)("SecondaryLogin"),e=>(0,a.getDashlaneDefinedLinkedWebsites)(e.Url).join(" "),e=>(0,a.getUserAddedLinkedWebsitesRootDomains)(e).join(" ")])},74380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countAllCredentialsSelector=void 0;t.countAllCredentialsSelector=e=>e.userSession.personalData.credentials.length},19736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSelector=void 0;const o=r(51319),n=r(49551);t.credentialSelector=(e,t)=>{const r=(0,o.credentialsSelector)(e);return(0,n.findDataModelObject)(t,r)}},88083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsByDomainSelector=t.getCredentialByDomainMatchType=t.DomainMatchType=void 0;const o=r(32034),n=r(15318),a=r(51319),i=r(6205);var s;!function(e){e.MainWebsite="MainWebsite",e.DashlaneDefinedLinkedWebsite="DashlaneDefinedLinkedWebsite",e.UserDefinedLinkedWebsite="UserDefinedLinkedWebsite",e.None="None"}(s=t.DomainMatchType||(t.DomainMatchType={}));t.getCredentialByDomainMatchType=(e,t)=>{if(!e)return s.None;return e===new n.ParsedURL(t.Url).getRootDomain()?s.MainWebsite:(0,i.getDashlaneDefinedLinkedWebsites)(t.Url).includes(e)?s.DashlaneDefinedLinkedWebsite:(0,i.getUserAddedLinkedWebsitesRootDomains)(t).includes(e)?s.UserDefinedLinkedWebsite:s.None};t.getCredentialsByDomainSelector=e=>(0,o.createSelector)(a.credentialsSelector,(r=>((e,r)=>e.filter((e=>{const o=(0,t.getCredentialByDomainMatchType)(r,e);return[s.MainWebsite,s.DashlaneDefinedLinkedWebsite,s.UserDefinedLinkedWebsite].includes(o)})))(r,e)))},71806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsCountSelector=void 0;const o=r(32034),n=r(49960),a=r(51319),i=r(31400),s=r(36439),c=r(7439);t.credentialsCountSelector=(0,o.createSelector)([n.fieldMappersSelector,c.filterTokenSelector,a.credentialsSelector],((e,t,r)=>(0,s.countCredentials)(e,i.credentialMatcher,t,r)))},60463:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialDisplayTitlesSelector=void 0;const o=r(32034),n=r(51319),a=r(23529);t.credentialDisplayTitlesSelector=(0,o.createSelector)(n.credentialsSelector,a.getCredentialsDisplayTitles)},10043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPageSelector=void 0;const o=r(20553),n=r(35893),a=r(49960),i=r(9365),s=r(51443);t.credentialsPageSelector=(e,t)=>{const r=(0,n.parseToken)(t),{sortToken:c,filterToken:d}=r,l={sortToken:c,filterToken:d},u=(0,a.fieldMappersSelector)(e),p=(0,i.credentialsQuerySelector)(e,l),S=(0,s.listViewSelector)(e),m=(0,o.generateNextToken)(u,r,p),g=(0,o.generatePrevToken)(u,r,p),y=(0,o.getBatch)(u,r,p),A=(0,n.stringifyToken)(m),f=(0,n.stringifyToken)(g);return{batch:S(y),nextToken:A,prevToken:f}}},35410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsPaginationTokenSelector=void 0;const o=r(25501),n=r(49960),a=r(9365),i=r(35893);t.credentialsPaginationTokenSelector=(e,t)=>{const r=(0,o.getCredentialsSortToken)(t),s=(0,o.getCredentialsFilterToken)(t),c=(0,n.fieldMappersSelector)(e),d={sortToken:r,filterToken:s},l=(0,a.credentialsQuerySelector)(e,d),u=(0,o.getCredentialsFirstToken)(c,d,t,l);return(0,i.stringifyToken)(u)}},9365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsQuerySelector=void 0;const o=r(32034),n=r(49960),a=r(7439),i=r(92897),s=r(51319),c=r(31400),d=r(35893);t.credentialsQuerySelector=(0,o.createSelector)([n.fieldMappersSelector,i.sortTokenSelector,a.filterTokenSelector,s.credentialsSelector],((e,t,r,o)=>(0,d.queryData)(e,c.credentialMatcher,t,r,o)))},51319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsSelector=void 0;const o=r(32034),n=r(83659),a=r(92888),i=r(57989),s=r(40602),c=(0,o.createSelector)([e=>(0,a.hasCredentialsDedupViewSelector)(e)?(0,a.dedupedCredentialsSelector)(e):(0,n.unsafeAllCredentialsSelector)(e)],(e=>e));t.credentialsSelector=(0,o.createSelector)(c,i.quarantinedSpacesSelector,s.filterOutQuarantinedItems)},92888:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasCredentialsDedupViewSelector=t.dedupedCredentialsSelector=void 0;const o=r(32034),n=r(53682),a=r(66982),i=r(83659),s={Alias:a.genericMerge,Attachments:a.concatMerge,AutoLogin:a.strictEqual,AutoProtected:a.boolEqual,Category:a.genericMerge,Checked:a.strictEqual,ConnectionOptions:a.genericMerge,CreationDatetime:a.minMerge,Email:a.strictEqual,LastUse:a.maxMerge,LinkedServices:a.strictEqual,Login:a.strictEqual,ModificationDatetime:a.maxMerge,Note:a.genericMerge,NumberUse:a.sumMerge,OtpSecret:a.strictEqual,OtpUrl:a.strictEqual,Password:a.strictEqual,Port:a.genericMerge,SID:a.genericMerge,SecondaryLogin:a.strictEqual,Server:a.genericMerge,SharedObject:a.strictEqual,SpaceId:a.strictEqual,Status:a.strictEqual,Strength:a.strictEqual,SubdomainOnly:a.boolEqual,Title:a.strictEqual,TrustedUrlGroup:a.concatMerge,Url:a.strictEqual,UseFixedUrl:a.strictEqual,UserModificationDatetime:a.maxMerge,UserSelectedUrl:a.strictEqual,kwType:a.strictEqual,limitedPermissions:a.strictEqual};t.dedupedCredentialsSelector=(0,o.createSelector)(i.unsafeAllCredentialsSelector,(0,n.dedupItems)(["Password","Title","Url"],s));t.hasCredentialsDedupViewSelector=e=>e.userSession.credentialsDedupViewState.credentialsDedupView},49960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldMappersSelector=void 0;const o=r(32034),n=r(94687),a=r(60463),i=r(91210);t.fieldMappersSelector=(0,o.createSelector)(i.limitedSharingItemsSelector,a.credentialDisplayTitlesSelector,n.getCredentialMappers)},7439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterTokenSelector=void 0;const o=r(62433),n=r(35893);t.filterTokenSelector=(0,n.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity)},65950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsByDomainSelector=void 0;const o=r(97006),n=r(51443),a=r(49960),i=r(31400),s=r(88083);t.getLiveCredentialsByDomainSelector=e=>(0,o.makeLiveSelectorGetter)((0,s.getCredentialsByDomainSelector)(e),n.listViewSelector,(()=>i.credentialMatcher),a.fieldMappersSelector)},61645:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLiveCredentialsSelector=void 0;const o=r(97006),n=r(51319),a=r(51443),i=r(49960),s=r(31400);t.getLiveCredentialsSelector=(0,o.makeLiveSelectorGetter)(n.credentialsSelector,a.listViewSelector,(()=>s.credentialMatcher),i.fieldMappersSelector)},80920:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowRequireMasterPasswordSelector=void 0;const o=r(38981);t.shouldShowRequireMasterPasswordSelector=e=>!(0,o.isSSOUserSelector)(e)},86685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialSelector=void 0;const o=r(32034),n=r(52102),a=r(91210),i=r(51319),s=r(91892),c=r(16593),d=r(49551),l=r(7944),u=r(88542);t.getViewedCredentialSelector=e=>{const t=(0,o.createSelector)(i.credentialsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,o.createSelector)(t,n.sharingDataSelector,c.userIdSelector,a.limitedSharingItemsSelector,s.iconsSelector,l.spacesSelector,u.viewCredential)}},78767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedCredentialsBatchSelector=void 0;const o=r(32034),n=r(9365),a=r(49960),i=r(91892),s=r(25501),c=r(35893);t.getViewedCredentialsBatchSelector=e=>{const{sortToken:t,filterToken:r}=e,d={sortToken:t,filterToken:r},l=(0,s.getCredentialsBatch)(e),u=(0,o.createSelector)((e=>(0,n.credentialsQuerySelector)(e,d)),a.fieldMappersSelector,l),p=(0,c.optimizeBatchSelector)(u);return(0,o.createSelector)(p,i.iconsSelector,s.viewCredentialsBatch)}},51443:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listViewSelector=void 0;const o=r(32034),n=r(25501),a=r(91892);t.listViewSelector=(0,o.createSelector)(a.iconsSelector,(e=>t=>(0,n.viewCredentialsBatch)(t,e)))},19325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryByDomainSelector=void 0;const o=r(24589),n=r(49960),a=r(31400),i=r(88083);t.getQueryByDomainSelector=e=>(0,o.getQuerySelector)((0,i.getCredentialsByDomainSelector)(e),(()=>a.credentialMatcher),n.fieldMappersSelector)},41841:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.querySelector=void 0;const o=r(24589),n=r(51319),a=r(49960),i=r(31400);t.querySelector=(0,o.getQuerySelector)(n.credentialsSelector,(()=>i.credentialMatcher),a.fieldMappersSelector)},92897:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortTokenSelector=void 0;const o=r(62433),n=r(35893);t.sortTokenSelector=(0,n.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity)},83659:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unsafeAllCredentialsSelector=void 0;t.unsafeAllCredentialsSelector=e=>e.userSession.personalData.credentials},60581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedCredentialSelector=void 0;const o=r(88542),n=r(91210),a=r(52102),i=r(19736),s=r(16593),c=r(91892),d=r(7944);t.viewedCredentialSelector=(e,t)=>{const r=(0,i.credentialSelector)(e,t);if(!r)return;const l=(0,a.sharingDataSelector)(e),u=(0,s.userIdSelector)(e),p=(0,n.limitedSharingItemsSelector)(e),S=(0,c.iconsSelector)(e),m=(0,d.spacesSelector)(e);return(0,o.viewCredential)(r,l,u,p,S,m)}},28831:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsByDomainSelector=void 0;const o=r(19325),n=r(51443),a=r(63566);t.viewedQueriedCredentialsByDomainSelector=(e,t)=>{const{domain:r,...i}=t,s=(0,o.getQueryByDomainSelector)(r)(e,i),c=(0,n.listViewSelector)(e);return(0,a.viewListResults)(c)(s)}},66663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedCredentialsSelector=void 0;const o=r(63566),n=r(41841),a=r(51443);t.viewedQueriedCredentialsSelector=(e,t)=>{const r=(0,n.querySelector)(e,t),i=(0,a.listViewSelector)(e);return(0,o.viewListResults)(i)(r)}},9763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createCredential=t.createBaseCredentialModel=void 0;const o=r(62433),n=r(15318),a=r(45127),i=r(61923),s=r(13675),c=r(47975),d=r(78320),l=r(53),u=r(90771),p=r(23439),S=r(78163),m=r(23136);t.createBaseCredentialModel=(e=a.Country.NO_TYPE)=>{const t=(0,l.getUnixTimestamp)();return{kwType:"KWAuthentifiant",Id:(0,d.generateItemUuid)(),CreationDatetime:t,LastBackupTime:0,LastUse:t,LocaleFormat:e}},t.createCredential=async function({storeService:e,sessionService:r,eventLoggerService:d,applicationModulesAccess:l},g,y){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const A=await(0,m.getDefaultSpaceId)(e),f=(0,p.getUrlFields)(g.url,!0),{email:E,login:h,secondaryLogin:v}=(0,i.normalizeUsernames)(g.email,g.login,g.secondaryLogin),T=e.getPlatformInfo(),_=(0,o.defaultTo)("",g.password),I=(0,o.defaultTo)(A,g.spaceId),C=_?await(0,c.evaluatePasswordStrength)(_):0,P=y||(()=>({})),D=new n.ParsedURL(g.url).getRootDomain(),O=(0,s.sanitizeInputPersonalData)({...(0,t.createBaseCredentialModel)(a.Country[T.country]),AutoProtected:g.protectWithMasterPassword,Title:D,Email:E,Login:h,SubdomainOnly:g.onlyForThisSubdomain,SecondaryLogin:v,Password:_,Strength:C,Status:"ACCOUNT_NOT_VERIFIED",SpaceId:I,AutoLogin:g.autoLogin??!0,...f,...P(g)});return(0,u.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:r,eventLoggerService:d,applicationModulesAccess:l},O),l&&(0,S.shouldSendCreateOrModifiedCredentialActivityLog)(e,O)&&await(0,S.computeAndSendCreatedCredentialActivityLog)(l,{domainUrl:O.Url}),{credentialId:O.Id}}},23439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUrlFields=t.getCategoryIdByName=void 0;const o=r(87496);t.getCategoryIdByName=(e,t)=>{const r=e.credentialCategories;if(!t)return"";if(r.find((e=>e.Id===t)))return t;const o=r.find((e=>e.CategoryName===t));return o?.Id};t.getUrlFields=(e,t,r)=>{const n=r?.Url!==e,a=(0,o.cleanUrlForPersonalData)(e,{keepQueryString:t}),i=t&&n?{UserSelectedUrl:a,UseFixedUrl:!0}:{UserSelectedUrl:r?.UserSelectedUrl??"",UseFixedUrl:r?.UseFixedUrl??!1};return{Url:a,TrustedUrlGroup:(0,o.getUpdatedTrustedUrlList)(r?.TrustedUrlGroup??[],a),...i}}},90771:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCredentialAsPersonalDataItem=void 0;const o=r(48062),n=r(15020),a=r(48313),i=r(12362),s=r(86691),c=r(56915),d=r(73566),l=r(85225),u=r(23136),p=r(88542),S=r(79980);t.saveCredentialAsPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:m},g,y){y&&(0,p.notifySharersCredentialUpdated)(e,y,g,m);const A=e.getPersonalData(),f=(0,d.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:A,change:(0,l.makeUpdateChange)(g),userLogin:e.getUserLogin(),platformInfo:(0,c.platformInfoSelector)(e.getState())});let E=null;const h=(0,i.getInstance)(),v=(0,s.getInstance)();try{E=v.lockTopic("iconsUpdates"),e.dispatch((0,a.savePersonalDataItem)(g,g.kwType,f)),await t.getInstance().user.persistPersonalData(),(0,p.afterCredentialSaved)(e,g);const i={type:"credentialUpdates",credentialIds:[g.Id]};await h.add("iconsUpdates",i),y?(0,S.logEditVaultItem)(e,r,g,y):(0,S.logAddVaultItem)(e,r,g);const{commands:s}=m.createClients().vaultItemsCrud;await s.emitTemporaryVaultItemEvent({ids:[g.Id],eventType:y?n.EventType.Updated:n.EventType.Created});(0,u.getDebounceSync)(e,t)({immediateCall:!0},o.Trigger.Save)}finally{E&&v.releaseTopic("iconsUpdates",E)}}},88779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateCredential=void 0;const o=r(19736),n=r(53),a=r(90771),i=r(23439),s=r(78163);t.updateCredential=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},d,l){if(!e.isAuthenticated())throw new Error("No session available to updateCredential");const u=e.getState(),p=(0,o.credentialSelector)(u,d.id);if(!p)throw new Error("Credential does not exist, cant update");const S=d.update.url?(0,i.getUrlFields)(d.update.url,d.update.isUrlSelectedByUser,p):{},m=l||(()=>({})),g={...p,...S,Password:void 0!==d.update.password?d.update.password:p.Password,Email:d.update.email??p.Email,Login:d.update.login??p.Login,Checked:void 0!==d.update.isExcludedFromHealth?d.update.isExcludedFromHealth:p.Checked,LinkedServices:d.update.linkedServices??p.LinkedServices,ModificationDatetime:(0,n.getUnixTimestamp)(),...m(d)};(0,a.saveCredentialAsPersonalDataItem)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:c},g,p),c&&(0,s.shouldSendCreateOrModifiedCredentialActivityLog)(e,g)&&await(0,s.computeAndSendModifiedCredentialActivityLog)(c,{domainUrl:g.Url})}},38786:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAmazonWebsite=void 0;const o=r(15318);t.isAmazonWebsite=e=>"amazon"===new o.ParsedURL(e).getRootDomainName()},87496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedTrustedUrlList=t.cleanUrlForPersonalData=t.getBestUrl=t.getFirstTrustedUrl=t.getBaseTrustedUrls=void 0;const o=r(51121),n=r(62433),a=r(15318),i=r(38786),s=r(53),c=e=>new a.ParsedURL(e).getUrlWithFallbackHttpsProtocol(),d=(0,n.compose)((e=>{const{protocol:t,hostname:r,port:n}=(0,o.parse)(e);return t&&/^https?:/.test(t)?(0,o.format)({protocol:t,hostname:r,port:n}):null}),c,n.trim),l=e=>!(0,n.isNil)(e);t.getBaseTrustedUrls=(0,n.compose)((e=>e.filter(l)),(0,n.map)(d),(0,n.map)((0,n.defaultTo)("")),(0,n.map)((0,n.prop)("TrustedUrl")),(0,n.defaultTo)([]));t.getFirstTrustedUrl=e=>(0,n.defaultTo)("")((0,n.head)((0,t.getBaseTrustedUrls)(e.TrustedUrlGroup)));function u(e,t){if(!e)return"";if((0,i.isAmazonWebsite)(e))return e;let r=e;return{keepQueryString:!1,...t}.keepQueryString||(r=function(e){const t=e.indexOf("?");return t>-1?e.slice(0,t):e}(r)),c(r)}t.getBestUrl=e=>{const r=(o=e).UseFixedUrl&&o.UserSelectedUrl?o.UserSelectedUrl:null;var o;return r&&r.length?r:e.Url&&e.Url.length?e.Url:(0,t.getFirstTrustedUrl)(e)},t.cleanUrlForPersonalData=u,t.getUpdatedTrustedUrlList=function(e,t){const r=u(t),o=new a.ParsedURL(r).getRootDomain(),n=(e||[]).filter((e=>new a.ParsedURL(e.TrustedUrl).getRootDomain()===o));if(n.some((e=>e.TrustedUrl===r)))return n;const i=n.length>=20?n.length-20+1:0;return n.slice(i).concat({TrustedUrl:r,TrustedUrlExpire:(0,s.getUnixTimestamp)().toString()})}},61923:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeUsernames=void 0;const o=r(62433),n=r(28445);t.normalizeUsernames=function(e,t,r){const a=(0,o.defaultTo)("");let i=e,s=t;return(0,n.looksLikeEmail)(t)?(i=t,(0,n.looksLikeEmail)(e)?(i=e,s=""):s=e):(0,n.looksLikeEmail)(e)||((0,o.isEmpty)(e)||(s=e),(0,n.looksLikeEmail)(t)?i=t:((0,o.isEmpty)(t)||(s=t),i="")),{email:a(i),login:a(s),secondaryLogin:a(r)}}},65968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const o=r(62433),n=r(82043),a=r(90073),i=r(6205),s=(0,o.defaultTo)(""),c=(0,o.defaultTo)(!1);t.detailView=(0,o.curry)(((e,t,r,o)=>{const d=e(o.Id),l=t(o.Url),u=s(o.Password),p=r(o),S={addedByDashlane:(0,i.getDashlaneDefinedLinkedWebsites)(o.Url),addedByUser:(0,i.getUserAddedLinkedWebsiteDomains)(o)};return{...(0,n.dataModelDetailView)(o),autoLogin:o.AutoLogin||!1,autoProtected:c(o.AutoProtected),domainIcon:l,email:s(o.Email),forceCategorizedSpace:p,linkedWebsites:S,login:s(o.Login),note:s(o.Note),hasOtp:Boolean(o.OtpSecret)||Boolean(o.OtpUrl),otpSecret:s(o.OtpSecret),otpUrl:s(o.OtpUrl),password:u,secondaryLogin:o.SecondaryLogin,sharingStatus:d,strength:o.Strength||0,subdomainOnly:o.SubdomainOnly||!1,title:s(o.Title||(0,a.getDomainForCredential)(o)),url:s(o.Url||o.UserSelectedUrl)}}))},29179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=r(62433),n=r(82043),a=r(90073),i=(0,o.defaultTo)("");t.itemView=(0,o.curry)(((e,t)=>({...(0,n.dataModelItemView)(t),autoProtected:(0,o.defaultTo)(!1,t.AutoProtected),domainIcon:e(t.Url),email:i(t.Email),login:i(t.Login),password:i(t.Password),title:i(t.Title||(0,a.getDomainForCredential)(t)),url:i(t.Url||t.UserSelectedUrl)})));t.listView=(e,r)=>{const o=(0,t.itemView)(e);return r.map(o)}},19065:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataManagementController=void 0;const o=r(48062),n=r(35834),a=r(50886),i=r(23136),s=r(84511),c={immediateCall:!0};t.makeDataManagementController=e=>{const t=(0,i.getDebounceSync)(e.storeService,e.sessionService);return{savePaymentCardFromClient:r=>function(e,t,r){(0,n.savePaymentCard)(e,r),t(c,o.Trigger.Save)}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService},t,r),savePersonalDataItem:r=>async function(e,t,r){const{storeService:i,sessionService:d,eventLoggerService:l,applicationModulesAccess:u}=e;if("KWPaymentMean_creditCard"===r.kwType)return(0,n.savePaymentCard)({storeService:i,sessionService:d,eventLoggerService:l},r.content),t(c,o.Trigger.Save),Promise.resolve({success:!0,itemId:""});{const n=await(0,a.addPersonalDataItem)({storeService:i,sessionService:d,eventLoggerService:l,applicationModulesAccess:u},r),p=i.getState(),S=(0,s.isSharedSelector)(p,r.content.id);return"KWAuthentifiant"===r.kwType&&r.shouldSkipSync||(S?await e.sessionService.getInstance().user.attemptSync(o.Trigger.SettingsChange):t(c,o.Trigger.Save)),n}}({storeService:e.storeService,sessionService:e.sessionService,eventLoggerService:e.eventLoggerService,applicationModulesAccess:e.applicationModulesAccess},t,r),updateMetadataItemFilledOnPage:(r,n,i)=>function(e,t,r,n,i){(0,a.updatePersonalDataUsageMetadata)(e,r,n,i),t({},o.Trigger.SaveMeta)}(e.storeService,t,r,n,i)}}},53682:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dedupItems=t.merge=void 0;t.merge=(e,t,r)=>{const o={};return Object.keys(r).every((n=>{const a=r[n](e[n],t[n]);return a.success&&(o[n]=a.result),a.success}))?{success:!0,result:{...e,...t,...o}}:{success:!1}};t.dedupItems=(e,r)=>o=>{const n=[],a={};for(const i of o){const o=e.reduce(((e,t)=>`${e}${i[t]}`),"");if(o in a){const e=a[o];let s=!1;for(const o of e){const e=n[o],a=(0,t.merge)(i,e,r);if(a.success){n[o]=a.result,s=!0;break}}s||(n.push(i),e.push(n.length-1))}else n.push(i),a[o]=[n.length-1]}return n}},66982:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.concatMerge=t.minMerge=t.maxMerge=t.sumMerge=t.genericMerge=t.boolEqual=t.strictEqual=void 0;t.strictEqual=(e,t)=>e===t?{success:!0,result:e}:{success:!1};t.boolEqual=(e,t)=>Boolean(e)===Boolean(t)?{success:!0,result:e}:{success:!1};t.genericMerge=(e,t)=>e===t?{success:!0,result:e}:e&&t?{success:!1}:{success:!0,result:e||t};const r=e=>(t,r)=>({success:!0,result:void 0===t&&void 0===r?void 0:e(t??0,r??0)});t.sumMerge=r(((e,t)=>e+t)),t.maxMerge=r(Math.max),t.minMerge=r(Math.min);t.concatMerge=(e,t)=>({success:!0,result:void 0===e&&void 0===t?void 0:[...e??[],...t??[]]})},45157:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoveChangeHistory=void 0;const o=r(73566),n=r(56915),a=r(16593),i=r(72678),s=r(85225);t.getRemoveChangeHistory=function(e,t){const r=e.getState(),c=(0,i.personalDataSelector)(r),d=(0,n.platformInfoSelector)(r),l=(0,a.userLoginSelector)(r),{localSettings:u}=e.getState().userSession,p=u.deviceName,S=(0,s.makeRemovalChange)(t);return(0,o.getUpdatedItemChangeHistory)({change:S,deviceName:p,personalData:c,userLogin:l,platformInfo:d})}},76496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deletePersonalDataItem=t.findPersonalDataItemToDelete=void 0;const o=r(18948),n=r(45127),a=r(66638),i=r(95623),s=r(45291),c=r(45157),d=r(49551),l=r(70252),u=r(79980),p=r(48062),S=r(92310),m=r(78163),g=["addresses","bankAccounts","companies","credentialCategories","credentials","driverLicenses","emails","fiscalIds","idCards","identities","notes","passkeys","passports","paymentCards","paypalAccounts","personalWebsites","phones","secrets","secureFileInfo","socialSecurityIds"];function y(e,t,r){let o=null;const a=e.getPersonalData(),i=r?n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]??null:null;if(r&&!i)return null;const s=i?[i]:g;for(const e of s)if(o=(0,d.findDataModelObject)(t,a[e]),o)break;return o}function A(e,t){const r=new Error(`[DataManagement] - deletePersonalDataItem: ${e}`);return(0,l.sendExceptionLog)({error:r}),i.Debugger.error(r),{success:!1,reason:t,message:e}}t.findPersonalDataItemToDelete=y,t.deletePersonalDataItem=async function({storeService:e,eventLoggerService:t,applicationModulesAccess:r,sharingItemsApi:i},d,l){let g=null;try{if(!e.isAuthenticated())return A("No session available to delete personal item",n.RemovePersonalDataItemFailureReason.NOT_AUTHORIZED);const f=y(e,d);if(!f)return A(`Unable to find personal item to delete: ${d}`,n.RemovePersonalDataItemFailureReason.NOT_FOUND);const E=(0,n.isCredential)(f);if(E||(0,n.isNote)(f)||(0,n.isSecret)(f)){if(!l?.ignoreSharing){const e=await async function(e,t){const r=await(0,o.firstValueFrom)(e.queries.getSharingStatusForItem({itemId:t}));if((0,a.isFailure)(r))return A("Unable to retrieve item's sharing status.",n.RemovePersonalDataItemFailureReason.INTERNAL_ERROR);const{isSharedViaUserGroup:i,isShared:s}=(0,a.getSuccess)(r);if(!s)return!1;if(i)return A("Unshare the item before deleting it",n.RemovePersonalDataItemFailureReason.FORBIDDEN_GROUP_ITEM);const c=await(0,o.firstValueFrom)(e.queries.getIsLastAdminForItem({itemId:t}));if((0,a.isFailure)(c))return A("Unable to determine if user is the last admin for shared item",n.RemovePersonalDataItemFailureReason.INTERNAL_ERROR);const{isLastAdmin:d}=(0,a.getSuccess)(c);return!d||A("Unshare the item before deleting it",n.RemovePersonalDataItemFailureReason.FORBIDDEN_LAST_ADMIN)}(i,f.Id);if("boolean"!=typeof e){return e}if(!0===e){const e=await function(e,t){return e.commands.refuseSharedItem({vaultItemId:t}).then((e=>{if((0,a.isFailure)(e))throw new Error("Unexpected sharingItemsApi.commands.refuseSharedItem functional error, throwing...")})).catch((e=>A(e.message,n.RemovePersonalDataItemFailureReason.LEAVE_SHARING_FAILED)))}(i,f.Id);if(e)return e}}g=(0,c.getRemoveChangeHistory)(e,f)}(0,u.logDeleteVaultItem)(e,t,f,p.UpdateCredentialOrigin.Manual,null);const h=(0,s.removePersonalItem)(f.kwType,f.Id,g);if(e.dispatch(h),E&&void 0!==r){const t=(0,S.currentTeamIdSelector)(e.getState());f.SpaceId===t&&await(0,m.computeAndSendDeletedCredentialActivityLog)(r,{domainUrl:f.Url})}return{success:!0}}catch(e){return A(e.message,n.RemovePersonalDataItemFailureReason.INTERNAL_ERROR)}}},25856:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(64983);t.config={commands:{duplicateVaultItem:{handler:o.duplicateVaultItemHandler}},queries:{},liveQueries:{}}},64983:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateVaultItemHandler=void 0;const o=r(57779);t.duplicateVaultItemHandler=async({storeService:e},{vaultItemId:t})=>({newVaultItemId:await(0,o.duplicateSharedElements)(e,t)})},57779:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.duplicateSharedElements=void 0;const o=r(45127),n=r(48313),a=r(78320),i=r(49551),s=r(12362),c=r(86691);t.duplicateSharedElements=async function(e,t){let r=null;const d=(0,s.getInstance)(),l=(0,c.getInstance)(),{notes:u,credentials:p,changeHistories:S,secrets:m}=e.getPersonalData(),g=[...u,...p,...m],y=(0,i.findDataModelObject)(t,g);if(!y)return null;const A=(0,a.generateItemUuid)(),f={...y,Id:A},E=S.find((e=>e.ObjectId.toUpperCase()===t.toUpperCase()));if((0,o.isCredential)(y)){r=l.lockTopic("iconsUpdates");const e={credentialIds:[A],type:"credentialUpdates"};await d.add("iconsUpdates",e)}const h=(0,n.savePersonalDataItem)(f,f.kwType,E);return e.dispatch(h),r&&l.releaseTopic("iconsUpdates",r),A}},75912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(57012),n=r(40086);t.config={commands:{getPersonalDataExport:{handler:o.getPersonalDataExport}},queries:{getIsForcedDomainsEnabled:{selector:n.isForcedDomainsEnabledSelector}},liveQueries:{}}},40086:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isForcedDomainsEnabledSelector=void 0;const o=r(16593);t.isForcedDomainsEnabledSelector=e=>{const t=(0,o.activeSpacesSelector)(e)[0];return t?.info?.forcedDomainsEnabled??!1}},24108:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCredentialsExport=void 0;const o=r(45127),n=r(33553),a=r(28780);t.getCredentialsExport=function(e){const t=e.credentials,r=e.collections,i=(0,a.getCollectionsByItemId)(r,o.DataModelType.KWAuthentifiant),s=[{headerKey:"username",dataKey:"Email"},{headerKey:"username2",dataKey:"Login"},{headerKey:"username3",dataKey:"SecondaryLogin"},{headerKey:"title",dataKey:"Title"},{headerKey:"password",dataKey:"Password"},{headerKey:"note",dataKey:"Note"},{headerKey:"url",dataKey:"Url"},{headerKey:"category",dataKey:"Category"},{headerKey:"otpUrl",dataKey:"OtpUrl"}];return(0,a.formatDataToCSV)([(0,a.formatHeader)(s),(c=t,c.map((e=>{const t=[e.Email,e.Login,e.SecondaryLogin].filter((e=>void 0!==e&&""!==e)),[r="",o="",c=""]=t,d=e.OtpUrl??(e.OtpSecret?`otpauth://totp/?secret=${e.OtpSecret.toLowerCase()}&algorithm=SHA1&digits=6&period=30&lock=false`:"");return s.map((t=>{const s=e[t.dataKey]??"";if("Category"===t.dataKey)return(0,n.handleSpecialCharacter)((0,a.getItemCollections)(i,e.Id));if("Email"===t.dataKey)return(0,n.handleSpecialCharacter)(r);if("Login"===t.dataKey)return(0,n.handleSpecialCharacter)(o);if("SecondaryLogin"===t.dataKey)return(0,n.handleSpecialCharacter)(c);if("Note"===t.dataKey&&""!==s)return(0,n.handleSpecialCharacter)(s);if("Password"===t.dataKey){const e=`${s}`;return(0,n.handleSpecialCharacter)(e)}if("OtpUrl"===t.dataKey)return(0,n.handleSpecialCharacter)(d);{const e=`${s}`;return(0,n.handleSpecialCharacter)(e)}})).join(",")}))).join("\r\n")]);var c}},88096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCSVExport=void 0;const o=r(24108),n=r(31107),a=r(40549),i=r(8177),s=r(29375),c=[{filename:"credentials",generator:o.getCredentialsExport},{filename:"personalInfo",generator:s.getPersonalInfoExport},{filename:"securenotes",generator:n.getSecureNotesExport},{filename:"payments",generator:a.getPaymentsExport},{filename:"ids",generator:i.getIdsExport}],d=e=>new Promise(((t,r)=>{const o=new FileReader;o.readAsDataURL(e),o.onloadend=()=>{const e=o.result;e?t(e.toString()):r(new Error("Error creating CSV export."))}}));t.getCSVExport=async function(e){const t=await Promise.all([r.e(198),r.e(932),r.e(87),r.e(606),r.e(721),r.e(546)]).then(r.bind(r,28988));t.configure({useWebWorkers:!1});const o=new t.ZipWriter(new t.BlobWriter("application/zip")),n=[];for(const{filename:r,generator:a}of c){const i=a(e);n.push(o.add(`${r}.csv`,new t.BlobReader(new Blob([i],{type:"text/csv"}))))}await Promise.all(n);const a=await o.close();return await d(a)}},54130:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDashlaneSecureExport=void 0;const o=r(62433),n=r(56668),a=r(61797);t.getDashlaneSecureExport=async function(e,t){const r=(0,o.join)(";",(0,o.pluck)("Id",t));t.forEach((e=>{delete e.Attachments}));const i=(0,a.getDashlaneXml)(t),s=(0,n.utf16ToDeflatedUtf8)(i),c=await e.encrypt(s);return(0,o.join)("\n",["-------------------- Dashlane Secured Export ----------------------","--------------------        Id BEGIN         ----------------------",r,"--------------------         Id END          ----------------------","--------------------       Data BEGIN        ----------------------",c,"--------------------        Data END         ----------------------","--------------------       Files BEGIN       ----------------------","--------------------        Files END        ----------------------\n"])}},8177:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdsExport=void 0;const o=r(72099),n=r(33553),a=r(28780);t.getIdsExport=function(e){const t=new Map;e.identities.forEach((e=>{t.set(e.Id,e)}));const r=e.idCards,i=e.passports,s=e.driverLicenses,c=e.socialSecurityIds,d=e.fiscalIds,l=[{headerKey:"type",dataKey:"type"},{headerKey:"number",dataKey:"Number"},{headerKey:"name",dataKey:"Fullname"},{headerKey:"issue_date",dataKey:"DeliveryDate"},{headerKey:"expiration_date",dataKey:"ExpireDate"},{headerKey:"place_of_issue",dataKey:"DeliveryPlace"},{headerKey:"state",dataKey:"State"}];return(0,a.formatDataToCSV)([(0,a.formatHeader)(l),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return l.map((t=>{const a=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"card";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??a;return(0,n.handleSpecialCharacter)(e)}return(0,n.handleSpecialCharacter)(a)})).join(",")})))(e).join("\r\n"))(r),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return l.map((t=>{const a=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"passport";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??a;return(0,n.handleSpecialCharacter)(e)}return(0,n.handleSpecialCharacter)(a)})).join(",")})))(e).join("\r\n"))(i),(e=>(e=>e.map((e=>{const r=t.get(e.LinkedIdentity);return l.map((t=>{const a=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"license";if("Fullname"===t.dataKey&&r){const e=(0,o.identityToName)(r)??a;return(0,n.handleSpecialCharacter)(e)}return(0,n.handleSpecialCharacter)(a)})).join(",")})))(e).join("\r\n"))(s),(e=>(e=>e.map((e=>{const r=t.get(e.Id);return l.map((t=>{const a=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return"social_security";if("Number"===t.dataKey){const t=e.SocialSecurityNumber;return(0,n.handleSpecialCharacter)(t)}if("Fullname"===t.dataKey){const t=r?(0,o.identityToName)(r):e.SocialSecurityFullname;return(0,n.handleSpecialCharacter)(t)}return(0,n.handleSpecialCharacter)(a)})).join(",")})))(e).join("\r\n"))(c),(e=>(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,n.handleSpecialCharacter)("tax_number");if("Number"===t.dataKey){const t=e.FiscalNumber;return(0,n.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))))(e).join("\r\n"))(d)])}},40549:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentsExport=void 0;const o=r(33553),n=r(28780);t.getPaymentsExport=function(e){const t=e.bankAccounts,r=e.paymentCards,a=[{headerKey:"type",dataKey:"Type"},{headerKey:"account_name",dataKey:"BankAccountName"},{headerKey:"account_holder",dataKey:"BankAccountOwner"},{headerKey:"cc_number",dataKey:"CardNumber"},{headerKey:"code",dataKey:"SecurityCode"},{headerKey:"expiration_month",dataKey:"ExpireMonth"},{headerKey:"expiration_year",dataKey:"ExpireYear"},{headerKey:"routing_number",dataKey:"BankAccountBIC"},{headerKey:"account_number",dataKey:"BankAccountIBAN"},{headerKey:"country",dataKey:"LocaleFormat"},{headerKey:"issuing_bank",dataKey:"BankAccountBank"},{headerKey:"note",dataKey:"CCNote"},{headerKey:"name",dataKey:"Name"}];return(0,n.formatDataToCSV)([(0,n.formatHeader)(a),(s=t,(e=>e.map((e=>a.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,o.handleSpecialCharacter)("bank");{const e=`${r}`;return(0,o.handleSpecialCharacter)(e)}})).join(","))))(s).join("\r\n")),(i=r,(e=>e.map((e=>a.map((t=>{const r=`${e[t.dataKey]??""}`;if("Type"===t.dataKey)return(0,o.handleSpecialCharacter)("payment_card");if("BankAccountName"===t.dataKey){const t=e.OwnerName;return(0,o.handleSpecialCharacter)(t)}return(0,o.handleSpecialCharacter)(r)})).join(","))))(i).join("\r\n"))]);var i,s}},57012:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalDataExport=t.getFilteredPersonalData=t.filterNonExportableData=void 0;const o=r(18948),n=r(66638),a=r(45127),i=r(54130),s=r(72365),c=r(65675),d=r(49901),l=r(57989),u=r(40602),p=r(99281),S=r(16018),m=r(10770),g=r(80624),y=r(51319),A=r(23437),f=r(9774),E=r(26147),h=r(41092),v=r(28074),T=r(81904),_=r(75705),I=r(18665),C=r(65401),P=r(58235),D=r(81473),O=r(82439),b=r(27147),w=r(40086),N=r(88096),R="";t.filterNonExportableData=async(e,t,r)=>{const i=e.map((e=>e.Id)),s=await(0,o.firstValueFrom)(r.queries.getPermissionForItems({itemIds:i}));if((0,n.isFailure)(s))throw new Error("Could not retrieve item permission for export");const c=(0,n.getSuccess)(s);return e.filter((e=>{let r=!1;const o=c[e.Id],n=!o||o.capabilities.canView;return t&&(0,a.isDataModelObject)(e)&&(r=e.SpaceId!==d.PERSONAL_SPACE_ID),!r&&n}))};const M=(e,t)=>{const r=(0,l.quarantinedSpacesSelector)(e);return(0,u.filterOutQuarantinedItems)(t,r)};t.getFilteredPersonalData=async(e,r)=>{const o=(0,w.isForcedDomainsEnabledSelector)(e),n=M(e,(0,y.credentialsSelector)(e)),a=await(0,t.filterNonExportableData)(n,o,r),i=M(e,(0,T.secretsSelector)(e)),s=await(0,t.filterNonExportableData)(i,o,r),c=M(e,(0,_.notesSelector)(e)),d=await(0,t.filterNonExportableData)(c,o,r);return{addresses:M(e,(0,p.addressesSelector)(e)),bankAccounts:M(e,(0,S.bankAccountsSelector)(e)),collections:M(e,(0,m.collectionsSelector)(e)),companies:M(e,(0,g.companiesSelector)(e)),credentials:a,driverLicenses:M(e,(0,f.driverLicensesSelector)(e)),emails:M(e,(0,E.emailsSelector)(e)),fiscalIds:M(e,(0,h.fiscalIdsSelector)(e)),idCards:M(e,(0,A.idCardsSelector)(e)),identities:M(e,(0,v.identitiesSelector)(e)),notes:d,passkeys:M(e,(0,I.passkeysSelector)(e)),passports:M(e,(0,C.passportsSelector)(e)),paymentCards:M(e,(0,P.paymentCardsSelector)(e)),personalWebsites:M(e,(0,D.personalWebsitesSelector)(e)),phones:M(e,(0,O.phonesSelector)(e)),secrets:s,socialSecurityIds:M(e,(0,b.socialSecurityIdsSelector)(e))}},t.getPersonalDataExport=async function(e,r){const{storeService:o}=e,n=o.getState(),{exportType:d,password:l}=r,u=e.applicationModulesAccess.createClients().sharingItems,p=await(0,t.getFilteredPersonalData)(n,u);switch(d){case"csv":return{success:!0,response:{filename:"dashlane-credential-export.zip",content:await(0,N.getCSVExport)(p)}};case"secure-dashlane":{if(!l)return{success:!1,error:{code:a.GetPersonalDataExportErrorMessage.UNDEFINED_PASSWORD_ERROR}};const e=(0,s.makeDataEncryptorService)(o),t=(0,c.makeFlexibleMarkerCryptoConfig)("argon2d");e.setInstance({raw:l},R,t);const r=Object.values(p).flat().map((e=>({...e})));return{success:!0,response:{filename:"Dashlane Export.dash",content:await(0,i.getDashlaneSecureExport)(e.getInstance(),r)}}}default:return{success:!1,error:{code:a.GetPersonalDataExportErrorMessage.UNSUPPORTED_DATATYPE_ERROR}}}}},29375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalInfoExport=void 0;const o=r(22630),n=r(45127),a=r(33553),i=r(28780),s=e=>{const{LocaleFormat:t,Number:r}=e;if(!!t&&t!==n.Country.UNIVERSAL&&t!==n.Country.NO_TYPE&&(0,o.isSupportedCountry)(t)){const t=n.Country[e.LocaleFormat];return`+${(0,o.getCountryCallingCode)(t)}${r}`}return r};t.getPersonalInfoExport=function(e){const t=e.identities,r=e.emails,o=e.phones,n=e.addresses,c=e.companies,d=e.personalWebsites,l=[{headerKey:"type",dataKey:"type"},{headerKey:"title",dataKey:"Title"},{headerKey:"first_name",dataKey:"FirstName"},{headerKey:"middle_name",dataKey:"MiddleName"},{headerKey:"last_name",dataKey:"LastName"},{headerKey:"login",dataKey:"Pseudo"},{headerKey:"date_of_birth",dataKey:"BirthDate"},{headerKey:"place_of_birth",dataKey:"BirthPlace"},{headerKey:"email",dataKey:"Email"},{headerKey:"email_type",dataKey:"Type"},{headerKey:"item_name",dataKey:"Name"},{headerKey:"phone_number",dataKey:"Number"},{headerKey:"address",dataKey:"AddressFull"},{headerKey:"country",dataKey:"Country"},{headerKey:"state",dataKey:"State"},{headerKey:"city",dataKey:"City"},{headerKey:"zip",dataKey:"ZipCode"},{headerKey:"address_recipient",dataKey:"Receiver"},{headerKey:"address_building",dataKey:"Building"},{headerKey:"address_apartment",dataKey:"Door"},{headerKey:"address_floor",dataKey:"Floor"},{headerKey:"address_door_code",dataKey:"DigitCode"},{headerKey:"job_title",dataKey:"JobTitle"},{headerKey:"url",dataKey:"Website"}];return(0,i.formatDataToCSV)([(0,i.formatHeader)(l),(y=t,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("name");{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(y).join("\r\n")),(g=r,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("email");if("Type"===t.dataKey)return"PERSO"===r?(0,a.handleSpecialCharacter)("personal"):(0,a.handleSpecialCharacter)("business");if("Name"===t.dataKey){const t=e.EmailName??"";return(0,a.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(g).join("\r\n")),(m=o,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("number");if("Type"===t.dataKey)return(0,a.handleSpecialCharacter)("");if("Name"===t.dataKey){const t=e.PhoneName??"";return(0,a.handleSpecialCharacter)(t)}if("Number"===t.dataKey){const t=s(e);return(0,a.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(m).join("\r\n")),(S=n,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("address");if("Name"===t.dataKey){const t=e.AddressName??"";return(0,a.handleSpecialCharacter)(t)}{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(S).join("\r\n")),(p=c,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("company");{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(p).join("\r\n")),(u=d,(e=>e.map((e=>l.map((t=>{const r=`${e[t.dataKey]??""}`;if("type"===t.dataKey)return(0,a.handleSpecialCharacter)("website");{const e=`${r}`;return(0,a.handleSpecialCharacter)(e)}})).join(","))))(u).join("\r\n"))]);var u,p,S,m,g,y}},31107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecureNotesExport=void 0;const o=r(45127),n=r(33553),a=r(28780);t.getSecureNotesExport=function(e){const t=e.notes,r=e.collections,i=(0,a.getCollectionsByItemId)(r,o.DataModelType.KWSecureNote),s=[{headerKey:"title",dataKey:"Title"},{headerKey:"note",dataKey:"Content"},{headerKey:"category",dataKey:"Category"}];return(0,a.formatDataToCSV)([(0,a.formatHeader)(s),(e=>e.map((e=>s.map((t=>{const r=e[t.dataKey]??"";if("Content"===t.dataKey&&""!==r)return(0,n.handleSpecialCharacter)(r);if("Category"===t.dataKey)return(0,n.handleSpecialCharacter)((0,a.getItemCollections)(i,e.Id));{const e=`${r}`;return(0,n.handleSpecialCharacter)(e)}})).join(","))).join("\r\n"))(t)])}},33553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSpecialCharacter=void 0,t.handleSpecialCharacter=function(e){if(void 0===e)return"";if(e.match(/[,"\n\r]/g)){return['"',...e.split("").map((e=>'"'===e?'""':e)),'"'].join("")}return e}},28780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemCollections=t.getCollectionsByItemId=t.formatDataToCSV=t.formatHeader=void 0;t.formatHeader=e=>e.map((e=>e.headerKey)).join(","),t.formatDataToCSV=function(e){return e.filter((e=>e.length>0)).join("\r\n")};t.getCollectionsByItemId=(e,t)=>e.reduce(((e,r)=>(r.VaultItems.reduce(((e,r)=>r.Type!==t?e:[...e,r.Id]),[]).forEach((t=>{e[t]?e[t].push(r.Name):e[t]=[r.Name]})),e)),{});t.getItemCollections=(e,t)=>{const r=e[t];return r?r.join(", "):""}},3474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(92598),n=r(47205),a=r(11507);t.config={commands:{saveGeneratedPassword:{handler:n.saveGeneratedPasswordHandler}},queries:{getGeneratedPassword:{selector:o.viewedGeneratedPasswordSelector},getGeneratedPasswordsCount:{selector:o.countAllGeneratedPasswordsSelector},getGeneratedPasswords:{selector:o.viewedQueriedGeneratedPasswordsSelector},getGeneratedPasswordsPage:{selector:o.generatedPasswordsPageSelector},getGeneratedPasswordsPaginationToken:{selector:o.generatedPasswordsPaginationTokenSelector}},liveQueries:{liveGeneratedPasswordsCount:{operator:a.generatedPasswordCount$},liveGeneratedPasswords:{operator:a.generatedPasswords$}}}},43145:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAssociatedCredential=t.associateGeneratedPasswordsToCredential=void 0;const o=r(90073);t.associateGeneratedPasswordsToCredential=function(e,t){return e.filter((e=>!e.AuthId&&e.Domain===(0,o.getDomainForCredential)(t)&&e.Password===t.Password)).map((e=>({...e,AuthId:t.Id})))},t.findAssociatedCredential=function(e,t){if(e?.AuthId)return(t||[]).find((t=>t.Id===e.AuthId))}},94170:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneratedPassword=void 0;const o=r(45127),n=r(78320),a=r(53);t.createGeneratedPassword=({Id:e=(0,n.generateItemUuid)(),LastBackupTime:t=0,AuthId:r,Domain:i,GeneratedDate:s=(0,a.getUnixTimestamp)(),Password:c,SpaceId:d,Platform:l})=>({kwType:o.DataModelType.KWGeneratedPassword,AuthId:r,Domain:i,GeneratedDate:s,Id:e,SpaceId:d,Password:c,LastBackupTime:t,Platform:l})},47205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveGeneratedPasswordHandler=void 0;const o=r(44908);t.saveGeneratedPasswordHandler=async function(e,t){const{storeService:r,sessionService:n}=e;return(0,o.saveGeneratedPassword)(r,n,t.password,t.url)}},44908:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePassword=t.saveGeneratedPassword=t.generatePassword=t.fixIncoherentSettings=t.getDefaultPasswordGenerationSettings=t.passwordGeneratorDefaultSettings=t.associateGeneratedPasswordsToCredential=void 0;const o=r(28255),n=r(62433),a=r(85465),i=r(45127),s=r(95623),c=r(78320),d=r(53),l=r(48313),u=r(70252),p=r(94170),S=r(56915);var m=r(43145);function g(e){const r=(0,n.reject)((e=>(0,n.isNil)(e)||(0,n.isEmpty)(e)))({length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars});return y((0,n.merge)(t.passwordGeneratorDefaultSettings,r))}function y(e){return e.digits||e.letters||e.symbols||(e.digits=!0,e.letters=!0,e.symbols=!0),(void 0===e.length||e.length<1)&&(e.length=t.passwordGeneratorDefaultSettings.length),e}function A(e,t){const r=(0,n.isNil)(t)?g(e):y(t);if(!r.digits&&!r.letters&&r.symbols){const o=new Error("Should not generate password from symbols only"),n={length:e.GeneratorDefaultSize,digits:e.GeneratorDefaultDigits,letters:e.GeneratorDefaultLetters,symbols:e.GeneratorDefaultSymbols,avoidAmbiguous:e.GeneratorDefaultAvoidAmbiguousChars},a=`customSettings = ${JSON.stringify(t)}\npersonalSettingsGeneratorDefaults = ${JSON.stringify(n)}`;s.default.error(o),(0,u.sendExceptionLog)({error:o,code:i.ExceptionCriticality.WARNING,precisions:a}),r.digits=!0,r.letters=!0,r.symbols=!0}return(0,a.generate)(r)}function f(e,t,r,o){const n=(0,p.createGeneratedPassword)({Domain:o??"",GeneratedDate:(0,d.getUnixTimestamp)(),Id:(0,c.generateItemUuid)(),Password:r,LastBackupTime:0,Platform:(0,S.platformInfoSelector)(e.getState()).platformName});e.dispatch(l.saveGeneratedPassword(n)),t.getInstance().user.persistPersonalData()}Object.defineProperty(t,"associateGeneratedPasswordsToCredential",{enumerable:!0,get:function(){return m.associateGeneratedPasswordsToCredential}}),t.passwordGeneratorDefaultSettings={length:16,digits:!0,letters:!0,symbols:!0,avoidAmbiguous:!0},t.getDefaultPasswordGenerationSettings=g,t.fixIncoherentSettings=y,t.generatePassword=A,t.saveGeneratedPassword=f,t.generateAndSavePassword=function(e,t,r){if(!e.isAuthenticated())return s.default.log("No session available to generateAndSavePassword"),null;const n=A(e.getPersonalSettings());return o((()=>{f(e,t,n,r)})),n}},11507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswords$=t.generatedPasswordCount$=void 0;const o=r(92598),n=r(55220),a=r(18948),i=r(3343);t.generatedPasswordCount$=()=>(0,a.pipe)((0,i.map)(o.countAllGeneratedPasswordsSelector),(0,i.distinctUntilChanged)()),t.generatedPasswords$=(0,n.getLivePersonalInfo)(o.getLiveGeneratedPasswordsSelector)},91329:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGeneratedPasswordMappers=void 0;t.getGeneratedPasswordMappers=()=>({id:e=>e.Id,domain:e=>e.Domain,generatedDate:e=>e.GeneratedDate})},45853:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewGeneratedPasswordsBatch=t.getGeneratedPasswordsFirstToken=t.getGeneratedPasswordsSortToken=t.getGeneratedPasswordsFilterToken=void 0;const o=r(20553),n=r(36407);t.getGeneratedPasswordsFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getGeneratedPasswordsSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getGeneratedPasswordsFirstToken=(e,t,r,n)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,n);t.viewGeneratedPasswordsBatch=e=>(0,n.listView)(e)},9546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("Domain")],t.generatedPasswordMatch=(0,n.match)(t.searchGetters)},92598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generatedPasswordsQuerySelector=t.generatedPasswordsPaginationTokenSelector=t.generatedPasswordsPageSelector=t.getLiveGeneratedPasswordsSelector=t.viewedQueriedGeneratedPasswordsSelector=t.queryGeneratedPasswordsSelector=t.getGeneratedPasswordMappersSelector=t.generatedPasswordMappersSelector=t.viewedGeneratedPasswordSelector=t.generatedPasswordSelector=t.generatedPasswordsSelector=t.countAllGeneratedPasswordsSelector=void 0;const o=r(62433),n=r(63566),a=r(36407),i=r(24589),s=r(9546),c=r(91329),d=r(45853),l=r(32034),u=r(35893),p=r(18948),S=r(20553),m=r(57989),g=r(97006),y=r(40602),A=r(49551);t.countAllGeneratedPasswordsSelector=e=>e.userSession.personalData.generatedPasswords.length,t.generatedPasswordsSelector=(0,l.createSelector)([e=>e.userSession.personalData.generatedPasswords,m.quarantinedSpacesSelector],y.filterOutQuarantinedItems);t.generatedPasswordSelector=(e,r)=>{const o=(0,t.generatedPasswordsSelector)(e);return(0,A.findDataModelObject)(r,o)};t.viewedGeneratedPasswordSelector=(e,r)=>{const o=(0,t.generatedPasswordSelector)(e,r);return(0,a.itemView)(o)};t.generatedPasswordMappersSelector=e=>(0,c.getGeneratedPasswordMappers)();const f=()=>s.generatedPasswordMatch,E=(0,c.getGeneratedPasswordMappers)();t.getGeneratedPasswordMappersSelector=()=>E,t.queryGeneratedPasswordsSelector=(0,i.getQuerySelector)(t.generatedPasswordsSelector,f,t.generatedPasswordMappersSelector),t.viewedQueriedGeneratedPasswordsSelector=(0,o.compose)((0,n.viewListResults)(a.listView),t.queryGeneratedPasswordsSelector),t.getLiveGeneratedPasswordsSelector=(0,g.makeLiveSelectorGetter)(t.generatedPasswordsSelector,(()=>a.listView),f,t.getGeneratedPasswordMappersSelector);t.generatedPasswordsPageSelector=(e,r)=>{const o=(0,u.parseToken)(r),{sortToken:n,filterToken:a}=o,i={sortToken:n,filterToken:a},s=(0,c.getGeneratedPasswordMappers)(),l=(0,t.generatedPasswordsQuerySelector)(e,i),p=(0,S.generateNextToken)(s,o,l),m=(0,S.generatePrevToken)(s,o,l),g=(0,S.getBatch)(s,o,l),y=(0,u.stringifyToken)(p),A=(0,u.stringifyToken)(m);return{batch:(0,d.viewGeneratedPasswordsBatch)(g),nextToken:y,prevToken:A}};t.generatedPasswordsPaginationTokenSelector=(e,r)=>{const o=(0,d.getGeneratedPasswordsSortToken)(r),n=(0,d.getGeneratedPasswordsFilterToken)(r),a=(0,c.getGeneratedPasswordMappers)(),i={sortToken:o,filterToken:n},s=(0,t.generatedPasswordsQuerySelector)(e,i),l=(0,d.getGeneratedPasswordsFirstToken)(a,i,r,s);return(0,u.stringifyToken)(l)};const h=(0,u.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),p.identity),v=(0,u.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),p.identity);t.generatedPasswordsQuerySelector=(0,l.createSelector)(c.getGeneratedPasswordMappers,f,h,v,t.generatedPasswordsSelector,u.queryData)},36407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=(0,r(62433).defaultTo)("");t.itemView=e=>({domain:o(e.Domain),generatedDate:e.GeneratedDate,password:e.Password,id:e.Id,platform:e.Platform});t.listView=e=>e.map(t.itemView)},64185:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmptyIconUrls=t.computeIconUrls=void 0;t.computeIconUrls=(e,t)=>t.reduce(((t,r)=>{const o=e.find((e=>e&&e.type===r));return t[r]=o?o.url:null,t}),{});t.makeEmptyIconUrls=e=>(0,t.computeIconUrls)([],e)},56814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFormattedDomainsFromUrls=t.decryptIconsDomains=void 0;const o=r(62433),n=r(15318),a=r(46445);t.decryptIconsDomains=(e,t)=>{const r=Array.from(e.keys()),o=new Map,n=t.reduce(((e,t)=>(e[(0,a.computeHashMD5)(t)]=t,e)),{});return r.forEach((t=>{const r=n[t];o.set(r,e.get(t))})),o};t.getFormattedDomainsFromUrls=e=>(0,o.uniq)(e.map((e=>new n.ParsedURL(e).getRootDomain()))).filter((e=>"string"==typeof e&&e.length))},44999:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const o=r(35949),n=r(23381);let a=null;t.setInstance=(e,t,r)=>(a=a||new o.IconsUpdater(t,e,new n.IconsWS(r)),a);t.getInstance=()=>a;t.clearInstance=()=>{a&&a.teardown(),a=null}},35949:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsUpdater=void 0;const o=r(18948),n=r(3343),a=r(35088),i=r(21342),s=r(19736),c=r(51319),d=r(95623),l=r(91892),u=r(16593),p=r(16661),S=r(17825),m=r(19979),g=r(70252),y=r(541),A=r(28096),f=r(21726),E=r(41717);var h;!function(e){e.BreachesOperation="breachesOperation",e.CredentialsOperation="credentialsOperation",e.RefreshOperation="refreshOperation"}(h||(h={}));t.IconsUpdater=class{constructor(e,t,r){this.localStorageService=e,this.storeService=t,this.gateway=r,this._operation$=new o.Subject,this.subs=new Set,this.handleRefreshIcons=async()=>{const e=(0,a.v4)(),t=new Promise((t=>{const r=this._operationResults$.subscribe((o=>{o.id===e&&(t(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerRefreshOperation(e),await t},this.handleCredentialUpdates=async e=>{const t=(0,a.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((o=>{o.id===t&&(e(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerCredentialsOperation(t,e),await r},this.handleBreachesUpdates=async e=>{const t=(0,a.v4)(),r=new Promise((e=>{const r=this._operationResults$.subscribe((o=>{o.id===t&&(e(o.success),r.unsubscribe(),this.subs.delete(r))}));this.subs.add(r)}));return this.triggerBreachesOperation(t,e),await r},this.triggerCredentialsOperation=(e,t,r=E.defaultIconTypes)=>{this._operation$.next({credentialIds:t,id:e,type:h.CredentialsOperation,iconTypes:r})},this.triggerBreachesOperation=(e,t,r=E.defaultIconTypes)=>{this._operation$.next({breachesIds:t,id:e,type:h.BreachesOperation,iconTypes:r})},this.triggerRefreshOperation=(e,t=E.defaultIconTypes)=>{this._operation$.next({id:e,type:h.RefreshOperation,iconTypes:t})},this.handleOperation=async(e,t)=>{const{type:r,id:o}=t,n={id:o,type:r},a=this.localStorageService.getInstance(),i=this.storeService.getState();try{return await e(t),await a.storeIcons((0,l.iconsCacheSelector)(i)),{...n,success:!0}}catch(e){const r=`[Icons Updater] - handle operation: operation ${t.type} failed with ${e}`;d.default.error(r);const o=new Error(r);return(0,g.sendExceptionLog)({error:o}),console.error(o),{...n,success:!1}}},this.onOperation=async e=>{switch(e.type){case h.CredentialsOperation:return this.handleOperation(((e,t)=>async({credentialIds:r,iconTypes:o})=>{const n=e.getState(),a=r.map((e=>(0,s.credentialSelector)(n,e))).filter((e=>!!e)),i=await(0,m.fetchIconsForCredentials)(n,t,a,o);(0,f.default)()&&i.length>0&&(e.dispatch((0,p.iconsUpdated)(i)),(0,A.reportDataUpdate)(e))})(this.storeService,this.gateway),e);case h.BreachesOperation:return this.handleOperation(((e,t)=>async({breachesIds:r,iconTypes:o})=>{const n=e.getState(),a=r.map((e=>(0,i.breachSelector)(n,e))).filter((e=>!!e)),s=await(0,m.fetchIconsForBreaches)(n,t,a,o);s.length>0&&e.dispatch((0,p.iconsUpdated)(s))})(this.storeService,this.gateway),e);case h.RefreshOperation:return this.handleOperation(((e,t)=>async({iconTypes:r})=>{const o=e.getState();if(!(0,u.richIconsSettingSelector)(o))return void e.dispatch((0,p.clearIconsCache)());const n=(0,l.iconsCacheSelector)(o);if((0,y.isIconsCacheValid)(n))return;const a=(0,c.credentialsSelector)(o),s=(0,i.breachesSelector)(o),d=await(0,m.fetchIconsForAllItems)(t,a,s,r);e.dispatch((0,p.iconsRefreshed)(d)),(0,f.default)()&&(0,A.reportDataUpdate)(e)})(this.storeService,this.gateway),e);default:return(0,S.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{const e=this._operation$.pipe((0,n.concatMap)(this.onOperation),(0,n.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}teardown(){this.subs.forEach((e=>e.unsubscribe()))}}},541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isIconsCacheValid=void 0;const o=r(53),n=86400*(7+Math.random());t.isIconsCacheValid=e=>!(!e||!e.lastUpdateTimeSeconds)&&(0,o.getUnixTimestamp)()-e.lastUpdateTimeSeconds<n},41717:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIconTypes=void 0,t.defaultIconTypes=["46x30@2x","160x106@2x","118x98@2x"]},19979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchIconsForAllItems=t.fetchIconsForCredentials=t.getCredentialsWithWebsiteIcon=t.fetchIconsForBreaches=t.getIconsUrlsForBreaches=t.getIconsUrlsForCredentials=void 0;const o=r(62433),n=r(15318),a=r(56814),i=r(91892),s=r(64185),c=r(16593);t.getIconsUrlsForCredentials=e=>e.map((e=>e.Url));t.getIconsUrlsForBreaches=e=>e.reduce(((e,t)=>{const r=t.Content.domains;return r&&0!==r.length?[...e,r[0]]:e}),[]);t.fetchIconsForBreaches=async(e,r,n,s)=>{if(!(0,c.richIconsSettingSelector)(e))return Promise.resolve([]);const d=(0,t.getIconsUrlsForBreaches)(n),l=(0,a.getFormattedDomainsFromUrls)(d),u=(0,a.decryptIconsDomains)((0,i.iconsSelector)(e),l),p=Array.from(u.keys()),S=(0,o.difference)(l,p);return r.getIcons(S,s)};t.getCredentialsWithWebsiteIcon=(e,t,r)=>{const a={backgroundColor:null,mainColor:null,urls:(0,s.makeEmptyIconUrls)(r)};return e.map((e=>{const r=t.get(new n.ParsedURL(e.Url).getRootDomain()),i=(0,o.defaultTo)(a,r);return{...e,domainIcon:i}}))};t.fetchIconsForCredentials=async(e,r,n,s)=>{if(!(0,c.richIconsSettingSelector)(e))return[];const d=(0,t.getIconsUrlsForCredentials)(n),l=(0,a.getFormattedDomainsFromUrls)(d),u=(0,a.decryptIconsDomains)((0,i.iconsSelector)(e),l),p=Array.from(u.keys()),S=(0,o.difference)(l,p);return r.getIcons(S,s)};t.fetchIconsForAllItems=async(e,r,o,n)=>{const i=[...(0,t.getIconsUrlsForBreaches)(o),...(0,t.getIconsUrlsForCredentials)(r)],s=(0,a.getFormattedDomainsFromUrls)(i);return e.getIcons(s,n)}},49352:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsUpdatesHook=void 0;const o=r(17825),n=r(44999);t.iconsUpdatesHook=async e=>{const t=(0,n.getInstance)();if(!t)return!1;switch(e.type){case"breachUpdates":return t.handleBreachesUpdates(e.breachesIds);case"credentialUpdates":return t.handleCredentialUpdates(e.credentialIds);case"refresh":return t.handleRefreshIcons();default:return(0,o.assertUnreachable)(e)}}},44816:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatFetchedIcons=t.makeIconDataWithDomain=t.getDomainsIconsToBeFetched=t.getDomainIconsToBeFetched=void 0;const o=r(62433),n=r(64185),a=(0,o.defaultTo)(null);t.getDomainIconsToBeFetched=(e,t)=>t.reduce(((t,r)=>[...t,{domain:e,type:r}]),[]);t.getDomainsIconsToBeFetched=(e,r)=>e.reduce(((e,o)=>[...e,...(0,t.getDomainIconsToBeFetched)(o,r)]),[]);t.makeIconDataWithDomain=(e,t)=>{const r=(0,o.head)(e)||{};return{urls:(0,n.computeIconUrls)(e,t),backgroundColor:a(r.backgroundColor),mainColor:a(r.mainColor),domain:a(r.domain)}};t.formatFetchedIcons=(e,r,o)=>{const n=r.length;return[...Array(o)].reduce(((o,a,i)=>{const s=i*n,c=s+n,d=e.slice(s,c);return[...o,(0,t.makeIconDataWithDomain)(d,r)]}),[])}},23381:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IconsWS=void 0;const o=r(44816),n=r(32607);t.IconsWS=class{constructor(e){this.wsService=e}async getIcons(e,t){if(!e||!e.length)return[];const r=(0,o.getDomainsIconsToBeFetched)(e,t),a=await this.wsService.iconCrawler.getIcons(r);if(!(0,n.isWSResponseSuccess)(a)){const e=`[Icons] getIcons: ${a.message}(statusCode: ${a.code})`;throw new Error(e)}const{content:i}=a;return(0,o.formatFetchedIcons)(i,t,e.length)}}},90451:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIcon=void 0;const o=r(15318),n=r(46445);t.getIcon=e=>t=>{const r=new o.ParsedURL(t).getRootDomain();if(!r)return;const a=(0,n.computeHashMD5)(r);return e.get(a)}},91892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsSelector=t.iconsCacheSelector=void 0;t.iconsCacheSelector=e=>e.userSession.iconsCache;t.iconsSelector=e=>(0,t.iconsCacheSelector)(e).domains},8566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(12362),n=r(86691),a=async()=>{const e=(0,o.getInstance)(),t=(0,n.getInstance)(),r=t.lockTopic("iconsUpdates");await e.add("iconsUpdates",{type:"refresh"}),t.releaseTopic("iconsUpdates",r)};t.setupSubscriptions=function(e,t){e.syncSuccess.on((async()=>{await a()})),e.syncFailure.on((async()=>{await a()}))}},13648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(8302);t.config={commands:{addDriverLicense:{handler:o.addDriverLicenseHandler},editDriverLicense:{handler:o.editDriverLicenseHandler}},queries:void 0,liveQueries:void 0}},60445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDriverLicenseHandler=void 0;const o=r(45127),n=r(72099),a=r(58452),i=({expirationDate:e,idNumber:t,issueDate:r,name:a,state:i})=>({DateOfBirth:"",DeliveryDate:(0,n.viewDateToVaultDate)(r),ExpireDate:(0,n.viewDateToVaultDate)(e),Fullname:a??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWDriverLicence,State:i??"",Sex:""});t.addDriverLicenseHandler=(e,t)=>(0,a.addIdHandler)(e,t,i)},63589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editDriverLicenseHandler=t.handleDriverLicenseFields=void 0;const o=r(9774),n=r(72099),a=r(22388);t.handleDriverLicenseFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,n.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,n.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,State:e.state??t.State,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editDriverLicenseHandler=(e,r)=>(0,a.updateIdHandler)(e,r,t.handleDriverLicenseFields,o.driverLicenseSelector)},8302:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(60445),t),n(r(63589),t)},91019:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDriverLicenseMappers=void 0;const o=r(83539),n=r(72099);t.getDriverLicenseMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,n.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},50317:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.driverLicenseMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234),a=r(72099);t.searchGetters=[(0,n.stringProp)("Number"),e=>(0,a.identityToName)(e.identity)||e.Fullname],t.driverLicenseMatch=(0,o.match)(t.searchGetters)},9774:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryDriverLicensesSelector=t.driverLicenseWithIdentitySelector=t.driverLicenseSelector=t.driverLicensesSelector=void 0;const o=r(32034),n=r(50317),a=r(24589),i=r(49551),s=r(91019),c=r(28074),d=r(40602),l=r(57989);t.driverLicensesSelector=(0,o.createSelector)((e=>e.userSession.personalData.driverLicenses),l.quarantinedSpacesSelector,d.filterOutQuarantinedItems);t.driverLicenseSelector=(e,r)=>{const o=(0,t.driverLicensesSelector)(e);return(0,i.findDataModelObject)(r,o)};const u=(0,o.createSelector)([t.driverLicensesSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.driverLicenseWithIdentitySelector=(0,o.createSelector)([t.driverLicenseSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.queryDriverLicensesSelector=(0,a.getQuerySelector)(u,(()=>n.driverLicenseMatch),(e=>(0,s.getDriverLicenseMappers)()))},15141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(32813);t.config={commands:{addFiscalId:{handler:o.addFiscalIdHandler},editFiscalId:{handler:o.editFiscalIdHandler}},queries:void 0,liveQueries:void 0}},46033:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addFiscalIdHandler=void 0;const o=r(45127),n=r(58452),a=({idNumber:e,teledeclarantNumber:t})=>({FiscalNumber:e??"",kwType:o.DataModelType.KWFiscalStatement,TeledeclarantNumber:t??""});t.addFiscalIdHandler=(e,t)=>(0,n.addIdHandler)(e,t,a)},9175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editFiscalIdHandler=t.handleFiscalIdFields=void 0;const o=r(41092),n=r(22388);t.handleFiscalIdFields=(e,t)=>({FiscalNumber:e.idNumber??t.FiscalNumber,TeledeclarantNumber:e.teledeclarantNumber??t.TeledeclarantNumber,Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editFiscalIdHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleFiscalIdFields,o.fiscalIdSelector)},32813:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(46033),t),n(r(9175),t)},42143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFiscalIdMappers=void 0;const o=r(83539);t.getFiscalIdMappers=()=>({spaceId:e=>e.SpaceId,idNumber:e=>e.FiscalNumber,teledeclarantNumber:e=>e.TeledeclarantNumber,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},91341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fiscalIdMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("FiscalNumber"),(0,n.stringProp)("TeledeclarantNumber")],t.fiscalIdMatch=(0,o.match)(t.searchGetters)},41092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryFiscalIdsSelector=t.fiscalIdSelector=t.fiscalIdsSelector=void 0;const o=r(32034),n=r(91341),a=r(24589),i=r(49551),s=r(42143),c=r(40602),d=r(57989);t.fiscalIdsSelector=(0,o.createSelector)((e=>e.userSession.personalData.fiscalIds),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems);t.fiscalIdSelector=(e,r)=>{const o=(0,t.fiscalIdsSelector)(e);return(0,i.findDataModelObject)(r,o)};t.queryFiscalIdsSelector=(0,a.getQuerySelector)(t.fiscalIdsSelector,(()=>n.fiscalIdMatch),(e=>(0,s.getFiscalIdMappers)()))},2282:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(17607);t.config={commands:{addIdCard:{handler:o.addIdCardHandler},editIdCard:{handler:o.editIdCardHandler}},queries:void 0,liveQueries:void 0}},38052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdCardHandler=void 0;const o=r(45127),n=r(72099),a=r(58452),i=({expirationDate:e,idNumber:t,issueDate:r,name:a})=>({DateOfBirth:"",DeliveryDate:(0,n.viewDateToVaultDate)(r),ExpireDate:(0,n.viewDateToVaultDate)(e),Fullname:a??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWIDCard,Sex:""});t.addIdCardHandler=(e,t)=>(0,a.addIdHandler)(e,t,i)},84260:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editIdCardHandler=t.handleIdCardFields=void 0;const o=r(23437),n=r(72099),a=r(22388);t.handleIdCardFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,n.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,n.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editIdCardHandler=(e,r)=>(0,a.updateIdHandler)(e,r,t.handleIdCardFields,o.idCardSelector)},17607:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(38052),t),n(r(84260),t)},75455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdCardMappers=void 0;const o=r(83539),n=r(72099);t.getIdCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,n.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},27062:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idCardMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234),a=r(72099);t.searchGetters=[(0,n.stringProp)("Number"),e=>(0,a.identityToName)(e.identity)||e.Fullname],t.idCardMatch=(0,o.match)(t.searchGetters)},23437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdCardsSelector=t.idCardWithIdentitySelector=t.idCardSelector=t.idCardsSelector=void 0;const o=r(32034),n=r(27062),a=r(24589),i=r(49551),s=r(75455),c=r(28074),d=r(40602),l=r(57989);t.idCardsSelector=(0,o.createSelector)((e=>e.userSession.personalData.idCards),l.quarantinedSpacesSelector,d.filterOutQuarantinedItems);t.idCardSelector=(e,r)=>{const o=(0,t.idCardsSelector)(e);return(0,i.findDataModelObject)(r,o)};const u=(0,o.createSelector)([t.idCardsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.idCardWithIdentitySelector=(0,o.createSelector)([t.idCardSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.queryIdCardsSelector=(0,a.getQuerySelector)(u,(()=>n.idCardMatch),(e=>(0,s.getIdCardMappers)()))},8453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(62535);t.config={commands:{addPassport:{handler:o.addPassportHandler},editPassport:{handler:o.editPassportHandler}},queries:void 0,liveQueries:void 0}},57237:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPassportHandler=void 0;const o=r(45127),n=r(72099),a=r(58452),i=({expirationDate:e,idNumber:t,issueDate:r,name:a,deliveryPlace:i})=>({DateOfBirth:"",DeliveryDate:(0,n.viewDateToVaultDate)(r),ExpireDate:(0,n.viewDateToVaultDate)(e),Fullname:a??"",LinkedIdentity:"",Number:t??"",kwType:o.DataModelType.KWPassport,DeliveryPlace:i??"",Sex:""});t.addPassportHandler=(e,t)=>(0,a.addIdHandler)(e,t,i)},29461:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editPassportHandler=t.handlePassportFields=void 0;const o=r(65401),n=r(72099),a=r(22388);t.handlePassportFields=(e,t)=>({DeliveryDate:void 0===e.issueDate?t.DeliveryDate:(0,n.viewDateToVaultDate)(e.issueDate),ExpireDate:void 0===e.expirationDate?t.ExpireDate:(0,n.viewDateToVaultDate)(e.expirationDate),Fullname:e.name??t.Fullname,Number:e.idNumber??t.Number,DeliveryPlace:e.deliveryPlace??t.DeliveryPlace,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editPassportHandler=(e,r)=>(0,a.updateIdHandler)(e,r,t.handlePassportFields,o.passportSelector)},62535:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(57237),t),n(r(29461),t)},94023:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPassportMappers=void 0;const o=r(83539),n=r(72099);t.getPassportMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,n.identityToName)(e.identity)||e.Fullname,idNumber:e=>e.Number,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},39515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passportMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234),a=r(72099);t.searchGetters=[(0,n.stringProp)("Number"),e=>(0,a.identityToName)(e.identity)||e.Fullname],t.passportMatch=(0,o.match)(t.searchGetters)},65401:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPassportsWithIdentitySelector=t.passportMappersSelector=t.passportWithIdentitySelector=t.passportSelector=t.passportsSelector=void 0;const o=r(32034),n=r(39515),a=r(24589),i=r(49551),s=r(94023),c=r(28074),d=r(40602),l=r(57989);t.passportsSelector=(0,o.createSelector)((e=>e.userSession.personalData.passports),l.quarantinedSpacesSelector,d.filterOutQuarantinedItems);t.passportSelector=(e,r)=>{const o=(0,t.passportsSelector)(e);return(0,i.findDataModelObject)(r,o)};const u=(0,o.createSelector)([t.passportsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.passportWithIdentitySelector=(0,o.createSelector)([t.passportSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.passportMappersSelector=e=>(0,s.getPassportMappers)();t.queryPassportsWithIdentitySelector=(0,a.getQuerySelector)(u,(()=>n.passportMatch),t.passportMappersSelector)},57718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(27753);t.config={commands:{addSocialSecurityId:{handler:o.addSocialSecurityIdHandler},editSocialSecurityId:{handler:o.editSocialSecurityIdHandler}},queries:void 0,liveQueries:void 0}},6702:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSocialSecurityIdHandler=void 0;const o=r(45127),n=r(58452),a=e=>({DateOfBirth:"",LinkedIdentity:"",SocialSecurityFullname:e.name??"",SocialSecurityNumber:e.idNumber??"",kwType:o.DataModelType.KWSocialSecurityStatement,Sex:""});t.addSocialSecurityIdHandler=(e,t)=>(0,n.addIdHandler)(e,t,a)},96163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.editSocialSecurityIdHandler=t.handleSocialSecurityIdFields=void 0;const o=r(27147),n=r(22388);t.handleSocialSecurityIdFields=(e,t)=>({SocialSecurityFullname:e.name??t.SocialSecurityFullname,SocialSecurityNumber:e.idNumber??t.SocialSecurityNumber,LinkedIdentity:void 0===e.name?t.LinkedIdentity:"",Attachments:void 0===e.attachments?t.Attachments:e.attachments});t.editSocialSecurityIdHandler=(e,r)=>(0,n.updateIdHandler)(e,r,t.handleSocialSecurityIdFields,o.socialSecurityIdSelector)},27753:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6702),t),n(r(96163),t)},50147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSocialSecurityIdMappers=void 0;const o=r(83539),n=r(72099);t.getSocialSecurityIdMappers=()=>({spaceId:e=>e.SpaceId,name:e=>(0,n.identityToName)(e.identity)||e.SocialSecurityFullname,idNumber:e=>e.SocialSecurityNumber,lastUse:o.lastUseMapper,id:e=>e.Id,creationDate:e=>e.CreationDatetime})},29989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.socialSecurityIdMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234),a=r(72099);t.searchGetters=[(0,n.stringProp)("SocialSecurityNumber"),e=>(0,a.identityToName)(e.identity)||e.SocialSecurityFullname],t.socialSecurityIdMatch=(0,o.match)(t.searchGetters)},27147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.querySocialSecurityIdsSelector=t.socialSecurityIdWithIdentitySelector=t.socialSecurityIdSelector=t.socialSecurityIdsSelector=void 0;const o=r(32034),n=r(29989),a=r(24589),i=r(49551),s=r(50147),c=r(28074),d=r(57989),l=r(40602);t.socialSecurityIdsSelector=(0,o.createSelector)((e=>e.userSession.personalData.socialSecurityIds),d.quarantinedSpacesSelector,l.filterOutQuarantinedItems);t.socialSecurityIdSelector=(e,r)=>{const o=(0,t.socialSecurityIdsSelector)(e);return(0,i.findDataModelObject)(r,o)};const u=(0,o.createSelector)([t.socialSecurityIdsSelector,c.identitiesByIdSelector],((e,t)=>e.map((e=>({...e,identity:t[e.LinkedIdentity]})))));t.socialSecurityIdWithIdentitySelector=(0,o.createSelector)([t.socialSecurityIdSelector,e=>(0,c.identitiesByIdSelector)(e)],((e,t)=>({...e,identity:t[e.LinkedIdentity]})));t.querySocialSecurityIdsSelector=(0,a.getQuerySelector)(u,(()=>n.socialSecurityIdMatch),(e=>(0,s.getSocialSecurityIdMappers)()))},58452:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addIdHandler=void 0;const o=r(48062),n=r(45127),a=r(23136),i=r(48313),s=r(53),c=r(78320),d=r(95623),l=r(70252),u=r(13675),p=r(72099),S=r(79980);t.addIdHandler=async({sessionService:e,storeService:t,eventLoggerService:r},m,g)=>{if(""===m.idNumber)return Promise.resolve({success:!1,error:{code:n.AddIdResultErrorCode.MISSING_ID_NUMBER}});const y=({country:e,spaceId:t})=>{const r=(0,s.getUnixTimestamp)();return{CreationDatetime:r,Id:(0,c.generateItemUuid)(),LastBackupTime:0,LocaleFormat:(0,p.viewCountryToVaultCountry)(e),SpaceId:t,UserModificationDatetime:r}};try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:n.IdErrorCode.NOT_AUTHENTICATED}});const s=(0,u.sanitizeInputPersonalData)(m),c={...y(A=s),...g(A)};if(!c.SpaceId){const e=await(0,a.getDefaultSpaceId)(t);c.SpaceId=e}t.dispatch((0,i.savePersonalDataItem)(c,c.kwType)),e.getInstance().user.persistPersonalData();return(0,a.getDebounceSync)(t,e)({immediateCall:!0},o.Trigger.Save),(0,S.logAddVaultItem)(t,r,c),Promise.resolve({success:!0,id:c.Id})}catch(e){const t=new Error(`[IDs] - addIdHandler: ${e}`);return(0,l.sendExceptionLog)({error:t}),(0,d.logError)(t),Promise.resolve({success:!1,error:{code:n.IdErrorCode.INTERNAL_ERROR}})}var A}},22388:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateIdHandler=void 0;const o=r(48062),n=r(45127),a=r(23136),i=r(48313),s=r(53),c=r(95623),d=r(70252),l=r(13675),u=r(72099),p=r(79980);t.updateIdHandler=({sessionService:e,storeService:t,eventLoggerService:r},S,m,g)=>{if(""===S.idNumber)return Promise.resolve({success:!1,error:{code:n.UpdateIdResultErrorCode.MISSING_ID_NUMBER}});const y=({country:e,spaceId:t},r)=>({SpaceId:t??r.SpaceId,LocaleFormat:void 0===e?r.LocaleFormat:(0,u.viewCountryToVaultCountry)(e)}),A=(e,t)=>({...y(e,t),...m(e,t)});try{if(!t.isAuthenticated())return Promise.resolve({success:!1,error:{code:n.IdErrorCode.NOT_AUTHENTICATED}});const c=t.getState(),d=(0,l.sanitizeInputPersonalData)(S),u=g(c,S.id);if(!u)return Promise.resolve({success:!1,error:{code:n.IdErrorCode.NOT_FOUND}});const m={...u,...A(d,u),UserModificationDatetime:(0,s.getUnixTimestamp)()},y=m.kwType;t.dispatch((0,i.savePersonalDataItem)(m,y)),e.getInstance().user.persistPersonalData();(0,a.getDebounceSync)(t,e)({immediateCall:!0},o.Trigger.Save);const f=g(c,S.id);return(0,p.logEditVaultItem)(t,r,m,f),Promise.resolve({success:!0})}catch(e){const t=new Error(`[IDs] - updateIdHandler: ${e}`);return(0,d.sendExceptionLog)({error:t}),(0,c.logError)(t),Promise.resolve({success:!1,error:{code:n.IdErrorCode.INTERNAL_ERROR}})}}},72099:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityToName=t.viewCountryToVaultCountry=t.vaultCountryToViewCountry=t.vaultDateToViewDate=t.viewDateToVaultDate=t.epochToDate=t.ZERO_INDEX_BASED_MONTH_OFFSET=void 0;const o=r(45127);t.ZERO_INDEX_BASED_MONTH_OFFSET=1;t.epochToDate=e=>new Date(1e3*e);t.viewDateToVaultDate=e=>null===e?"":(e=>{const r=(0,t.epochToDate)(e);return`${r.getUTCFullYear()}-${r.getUTCMonth()+1}-${r.getUTCDate()}`})(e);t.vaultDateToViewDate=e=>{if(!e)return null;const t=(e=>{if(!e)return 0;const[t,r,o]=e.split(/[-/]/).map((e=>Number.parseInt(e,10))),n=new Date;n.setUTCHours(0,0,0,0);const a=n.setUTCFullYear(t,r-1,o);return Math.floor(a/1e3)})(e);return Number.isNaN(t)?null:t};t.vaultCountryToViewCountry=e=>{const t=o.Country[e];return void 0===t||t===o.Country.NO_TYPE?o.Country.UNIVERSAL:t},t.viewCountryToVaultCountry=t.vaultCountryToViewCountry;t.identityToName=e=>e?[e.FirstName,e.MiddleName,e.LastName,e.LastName2].filter(Boolean).join(" "):""},11230:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importApiConfig=void 0;const o=r(56242),n=r(29613),a=r(28927),i=r(76295),s=r(94746);t.importApiConfig={commands:{importPersonalData:{handler:a.importPersonalDataHandler},previewPersonalData:{handler:i.previewPersonalDataHandler},dismissPersonalDataImportNotifications:{handler:s.dismissDataImportHandler}},queries:{getImportPersonalDataStatus:{selector:n.importPersonalDataStateSelector}},liveQueries:{liveImportPersonalDataStatus:{operator:o.importPersonalDataState$}}}},94746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dismissDataImportHandler=t.dismissDataImport=void 0;const o=r(45127),n=r(43691);t.dismissDataImport=async e=>{await e.waitReady(),e.onNewState({status:o.ImportPersonalDataStateType.Idle})};t.dismissDataImportHandler=e=>(0,t.dismissDataImport)((0,n.makeImportService)(e))},28927:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataHandler=t.importPersonalData=void 0;const o=r(45127),n=r(95623),a=r(70252),i=r(43691);t.importPersonalData=async(e,t)=>{try{e.onNewState({status:o.ImportPersonalDataStateType.Processing,name:t.name});const r=t.content;return(async()=>{try{const n=await e.importPersonalDataItems(r);e.onNewState({status:o.ImportPersonalDataStateType.Success,name:t.name,totalCount:n.totalCount,successCount:n.successCount,duplicateCount:n.duplicateCount})}catch(r){const i=new Error(`[import] - importError: ${r}`);(0,a.sendExceptionLog)({error:i}),(0,n.logError)(i),e.onNewState({status:o.ImportPersonalDataStateType.Error,name:t.name})}})(),{success:!0}}catch(r){const i=new Error(`[import] - formatError: ${r}`);return(0,a.sendExceptionLog)({error:i}),(0,n.logError)(i),e.onNewState({status:o.ImportPersonalDataStateType.Error,name:t.name}),{success:!1,error:o.ImportPersonalDataErrorType.Unknown}}};t.importPersonalDataHandler=(e,r)=>(0,t.importPersonalData)((0,i.makeImportService)(e),r)},76295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.previewPersonalDataHandler=t.previewPersonalData=void 0;const o=r(45127),n=r(43691);t.previewPersonalData=async(e,t)=>{if(!e.canDoImport())return{success:!1,error:o.PreviewPersonalDataErrorType.Unavailable};try{return await e.previewPersonalDataArchive(t)}catch(e){return{success:!1,error:o.PreviewPersonalDataErrorType.InvalidFormat}}};t.previewPersonalDataHandler=(e,r)=>{const o=(0,n.makeImportService)(e);return(0,t.previewPersonalData)(o,r)}},56242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataState$=void 0;const o=r(18948),n=r(3343),a=r(29613);t.importPersonalDataState$=()=>(0,o.pipe)((0,n.map)(a.importPersonalDataStateSelector,(0,n.distinctUntilChanged)()))},29613:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isImportPersonalDataAvailableSelector=t.importPersonalDataStateSelector=void 0;const o=r(45127),n=r(62844);t.importPersonalDataStateSelector=e=>e.userSession.importPersonalData.state??{status:o.ImportPersonalDataStateType.Idle};t.isImportPersonalDataAvailableSelector=e=>!(0,n.changeMPinProgressSelector)(e)&&(0,t.importPersonalDataStateSelector)(e).status!==o.ImportPersonalDataStateType.Processing},90537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueVaultItemIdentifier=void 0;const o=r(62433),n={Attachments:!1},a={...n,Title:!0,Email:!0,Login:!0,SecondaryLogin:!0,Password:!0,Strength:!1,Note:!0,Checked:!1,Status:!1,SharedObject:!1,ModificationDatetime:!1,Category:!1,Url:!0,UserSelectedUrl:!1,UseFixedUrl:!1,TrustedUrlGroup:!1,NumberUse:!1,AutoLogin:!1,AutoProtected:!1,SubdomainOnly:!1,Type:!1,Server:!1,Port:!1,Alias:!1,SID:!1,ConnectionOptions:!1,domainIcon:!1,limitedPermissions:!1,OtpSecret:!0,OtpUrl:!0,LinkedServices:!1},i={...n,Title:!0,Content:!0,Secured:!1},s={...n,Title:!0,Category:!1,Type:!1,limitedPermissions:!1,Content:!0,Secured:!1,CreationDate:!1,UpdateDate:!1},c={...n,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0},d={...n,Email:!0,Type:!1,EmailName:!0},l={...n,Type:!1,Number:!0,NumberNational:!0,NumberInternational:!0,PhoneName:!0,PersonalNote:!0},u={...n,Title:!0,FirstName:!0,MiddleName:!0,LastName:!0,LastName2:!0,Pseudo:!1,BirthDate:!0,BirthPlace:!0},p={...n,Counter:!1,CredentialId:!0,ItemName:!0,KeyAlgorithm:!0,Note:!0,PrivateKey:!0,CloudCipheringKey:!0,RpId:!0,RpName:!0,UserDisplayName:!0,UserHandle:!0},S={...n,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,Number:!0,ExpireDate:!0,DeliveryDate:!0,DeliveryPlace:!0},m={...n,PersonalNote:!0,Name:!0,Website:!0},g={...n,Number:!0,LinkedIdentity:!1,Fullname:!0,Sex:!0,DateOfBirth:!0,DeliveryDate:!0,ExpireDate:!0,State:!0},y={...n,PersonalNote:!0,Name:!0,JobTitle:!0},A={...n,PersonalNote:!0,State:!0,AddressName:!0,Receiver:!0,AddressFull:!0,City:!0,ZipCode:!0,Country:!0,StreetNumber:!0,StreetTitle:!0,StreetName:!0,StateNumber:!0,StateLevel2:!0,Building:!0,Stairs:!0,Floor:!0,Door:!0,DigitCode:!0,LinkedPhone:!1},f={...n,Name:!0,CardNumber:!0,CardNumberLastDigits:!0,OwnerName:!0,SecurityCode:!0,ExpireMonth:!0,ExpireYear:!0,StartMonth:!0,StartYear:!0,IssueNumber:!0,Color:!1,Bank:!0,CCNote:!0,Type:!1},E={...n,BankAccountName:!0,BankAccountOwner:!0,BankAccountIBAN:!0,BankAccountBIC:!0,BankAccountBank:!0},h=e=>Object.keys(e).filter((t=>!!e[t])),v={KWAddress:h(A),KWAuthentifiant:h(a),KWBankStatement:h(E),KWCollection:h({Attachments:!1,Name:!0,VaultItems:!0}),KWCompany:h(y),KWDataChangeHistory:[],KWDriverLicence:h(g),KWEmail:h(d),KWFiscalStatement:[],KWGeneratedPassword:[],KWIDCard:h(c),KWIdentity:h(u),KWMerchand:[],KWMiscData:[],KWPasskey:h(p),KWPassport:h(S),KWPaymentMean_creditCard:h(f),KWPaymentMean_paypal:[],KWPersonalWebsite:h(m),KWPhone:h(l),KWPurchaseAccount:[],KWPurchaseCategory:[],KWPurchasePaidBasket:[],KWPurchaseTrueArticle:[],KWSecureFileInfo:[],KWSecret:h(i),KWSecureNote:h(s),KWSecurityBreach:[],KWSettingsManagerApp:[],KWSocialSecurityStatement:[],KWWebSite:[]};t.getUniqueVaultItemIdentifier=e=>((e,t)=>{const r={};return e.forEach((e=>{r[e]=t[e]??""})),(0,o.isEmpty)(r)?"":JSON.stringify(r)})(v[e.kwType],e)},47437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportableItemsFromUserFile=t.getExistingVaultItemUniqueIdentifiers=t.getAllExistingCollections=void 0;const o=r(45127),n=r(26634),a=r(13675),i=r(49901),s=r(72883),c=r(90537),d=r(88655),l=[o.DataModelType.KWAddress,o.DataModelType.KWAuthentifiant,o.DataModelType.KWCompany,o.DataModelType.KWDriverLicence,o.DataModelType.KWEmail,o.DataModelType.KWIDCard,o.DataModelType.KWIdentity,o.DataModelType.KWPassport,o.DataModelType.KWPaymentMean_creditCard,o.DataModelType.KWPersonalWebsite,o.DataModelType.KWPhone,o.DataModelType.KWSecureNote,o.DataModelType.KWSocialSecurityStatement,o.DataModelType.KWWebSite],u=(e,t)=>e+"_"+t,p=(e,t)=>{for(let r=1;;r++){const o=e+" - "+r;let n=!1;if(t.forEach((e=>{e.isShared||e.item?.Name!==o||(n=!0)})),!n)return o}},S="shared";t.getAllExistingCollections=(e,t)=>{const r=new Map;return e.forEach((e=>{r.set(u(e.name,S),{item:null,isShared:!0})})),t.forEach((e=>{r.set(u(e.Name,e.SpaceId),{item:e,isShared:!1})})),r};t.getExistingVaultItemUniqueIdentifiers=e=>{const t=new Set,r=Object.entries(e).filter((([e])=>(0,s.isDataKeyVaultItem)(e))).reduce(((e,[t,r])=>({...e,[t]:r})),{});for(const e of Object.values(r))e.forEach((e=>{if((0,o.isDataModelObject)(e)){const r=(0,c.getUniqueVaultItemIdentifier)(e);r&&t.add(r)}}));return t};const m=(e,t,r)=>{r.length&&t?e.SpaceId=r[0].teamId:e.SpaceId&&(e.SpaceId=r[0]?.teamId??i.PERSONAL_SPACE_ID)},g=async e=>((0,o.isCredential)(e)?e=await(0,d.prepareCredentialForImport)(e):(0,o.isNote)(e)&&(e=(0,d.prepareSecureNoteForImport)(e)),e);t.getImportableItemsFromUserFile=async(e,t,r,i)=>{const{storeService:s}=e,{spaces:y}=s.getSpaceData(),A=s.getState(),f=!(0,n.isPersonalSpaceEnabledSelector)(A),E=[];let h=0,v=0;for(const e of t){if(l.includes(e.kwType))h++;else if("KWSecureNoteCategory"===e.kwType||"KWAuthCategory"===e.kwType)continue;const t=await g((0,a.sanitizeInputPersonalData)((0,d.convertImportable)(e)));if(m(t,f,y),(0,o.isCollection)(t)){const e=E.find((e=>(0,o.isCollection)(e)&&e.SpaceId===t.SpaceId&&e.Name===t.Name));if(e){e.VaultItems=[...e.VaultItems,...t.VaultItems];continue}const r=i.get(u(t.Name,t.SpaceId))||i.get(u(t.Name,S));if(r&&!r.isShared){const e={...t,Id:r.item.Id,VaultItems:[...t.VaultItems,...r.item.VaultItems]};E.push(e);continue}if(r?.isShared){t.Name=p(t.Name,i),E.push(t);continue}}(0,o.isCollection)(t)||!r.has((0,c.getUniqueVaultItemIdentifier)(t))?E.push(t):v++}return{itemsToImport:E,importableItemCount:h,duplicateItemCount:v}}},20485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.importPersonalDataItems=void 0;const o=r(45127),n=r(48062),a=r(92310),i=r(78163),s=r(23136),c=r(88655),d=r(47437);t.importPersonalDataItems=async(e,t)=>{const{storeService:r,sessionService:l,localStorageService:u,applicationModulesAccess:p}=e,S=r.getState(),m=(0,s.getDebounceSync)(r,l);let g=0,y=0;const A=(0,d.getExistingVaultItemUniqueIdentifiers)(S.userSession.personalData),{itemsToImport:f,importableItemCount:E,duplicateItemCount:h}=await(0,d.getImportableItemsFromUserFile)(e,t,A,(0,d.getAllExistingCollections)(S.userSession.sharingData.collections??[],S.userSession.personalData.collections)),v=(0,c.groupByType)(f);for(const[e,t]of v.entries()){if((0,c.savePersonalDataItemsForImport)({storeService:r,sessionService:l,localStorageService:u,applicationModulesAccess:p},e,t),e!==o.DataModelType.KWCollection&&(g+=t.length),e===o.DataModelType.KWAuthentifiant){const e=(0,a.currentTeamIdSelector)(S);y=t.filter((t=>t.SpaceId===e)).length,y>=1&&await(0,i.computeAndSendCSVImportActivityLog)(p,{domainUrl:null,importCount:y})}e===o.DataModelType.KWCollection&&t.forEach((e=>{const t=e;t?.SpaceId&&(0,i.computeAndSendCollectionImportActivityLog)(p,{collectionName:t?.Name,itemCount:t?.VaultItems.length}).catch((()=>{}))}))}return m({immediateCall:!0},n.Trigger.Save),{successCount:g,totalCount:E,duplicateCount:h}}},88655:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.savePersonalDataItemsForImport=t.groupByType=t.prepareSecureNoteForImport=t.prepareCredentialForImport=t.convertImportable=void 0;const o=r(45127),n=r(15020),a=r(48313),i=r(56915),s=r(73566),c=r(85225),d=r(53),l=r(47975),u=r(78320),p=r(28207),S=r(70252);t.convertImportable=e=>({...e,Id:e.Id?e.Id:(0,u.generateItemUuid)(),SpaceId:e.SpaceId??"",LocaleFormat:e.LocaleFormat??o.Country.UNIVERSAL});t.prepareCredentialForImport=async e=>({...e,Strength:e.Password?await(0,l.evaluatePasswordStrength)(e.Password):0});t.prepareSecureNoteForImport=e=>{const t=(0,d.getUnixTimestamp)();return{...e,CreationDatetime:t,LocaleFormat:o.Country.US,UserModificationDatetime:t,LastBackupTime:0,Title:e.Title??`Untitled - ${t.toLocaleString()}`,Content:e.Content??"",Secured:e.Secured??!1,Type:o.NoteTypes.includes(e.Type)?e.Type:"GRAY",Attachments:e.Attachments??[]}};t.groupByType=e=>{const t=new Map;for(const r of e){const e=t.get(r.kwType);e?e.push(r):t.set(r.kwType,[r])}return t};t.savePersonalDataItemsForImport=({storeService:e,sessionService:t,applicationModulesAccess:r},d,l)=>{if(!l.length)return;const u=e.getPersonalData(),m=l.reduce(((t,r)=>{let n=null;return(0,s.isChangeHistoryCandidate)(r)&&(n=(0,s.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName??"",personalData:u,change:(0,c.makeUpdateChange)(r),userLogin:e.getUserLogin(),platformInfo:(0,i.platformInfoSelector)(e.getState())})),{changeHistories:[...t.changeHistories,...n?[n]:[]],credentialIds:[...t.credentialIds,...(0,o.isCredential)(r)?[r.Id]:[]]}}),{changeHistories:[],credentialIds:[]});e.dispatch((0,a.savePersonalDataItems)(l,d,m.changeHistories)),t.getInstance().user.persistPersonalData(),(async(e,t)=>{if(t.length)try{const{commands:r}=e.createClients().vaultItemsCrud;await r.emitTemporaryVaultItemEvent({ids:[...t],eventType:n.EventType.Created}),p.carbonEventHooks.iconsUpdates({type:"credentialUpdates",credentialIds:t})}catch(e){const t=new Error(`Failed to handle health & credential health updates with ${e}`);return void(0,S.sendExceptionLog)({error:t})}})(r,m.credentialIds)}},43691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeImportService=void 0;const o=r(45127),n=r(56915),a=r(17825),i=r(3343),s=r(56242),c=r(29613),d=r(61655),l=r(20485),u=r(99474),p=r(32814);t.makeImportService=e=>{const{storeService:t}=e;return{previewPersonalDataArchive:e=>(async(e,t)=>{const r=(0,n.platformInfoSelector)(e.getState());switch(t.format){case o.ImportFormats.Csv:{const e=(0,u.getImportablePersonalData)(t.content,o.Country[r.country]);return 0===e.items.length?{success:!1,error:o.PreviewPersonalDataErrorType.InvalidFormat}:{success:!0,data:{items:e.items,headers:e.headers}}}case o.ImportFormats.Dash:{const r=(0,p.parseDashData)(t.content.data);return await(0,p.checkPassword)(e,r,t.password)?{success:!0,data:{items:(await(0,p.getSaveEventsFromDash)(e,r,t.password)).map((e=>({baseDataModel:e,rawData:{}}))),headers:[]}}:{success:!1,error:o.PreviewPersonalDataErrorType.BadPassword}}}(0,a.assertUnreachable)(t)})(t,e),canDoImport:()=>(0,c.isImportPersonalDataAvailableSelector)(t.getState()),importPersonalDataItems:t=>(0,l.importPersonalDataItems)(e,t),onNewState:e=>t.dispatch((0,d.notifyNewImportPersonalDataStateAction)(e)),waitReady:async()=>{await(0,s.importPersonalDataState$)()(t.getState$()).pipe((0,i.first)((e=>e.status!==o.ImportPersonalDataStateType.Processing))).toPromise()}}}},89586:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFieldLevelProcessor=void 0;const o=r(45127),n=r(85803),a=(e,t)=>"title"===e?null:t,i=(e,t)=>{switch(e){case"reprompt":if("0"===t)return null;break;case"name":if("--"===t)return null;break;case"type":return null}return t};t.getFieldLevelProcessor=e=>{switch(e){case o.ImportSource.Safari:return a;case o.ImportSource.Bitwarden:return i;case o.ImportSource.Lastpass:return n.fieldProcessorForLastPass;default:return null}}},62754:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemTypeProcessor=void 0;const o=r(45127),n=r(85803);t.getItemTypeProcessor=e=>e===o.ImportSource.Lastpass?n.itemTypeProcessorForLastPass:null},92522:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCustomKeeperCredentialData=t.getKeeperImportHeaders=void 0;t.getKeeperImportHeaders=e=>{const t=["Folder","Title","Login","Password","Website Address","Notes","Shared Folder"],r=Math.max(0,e-t.length);return r&&t.push(...[...Array(r).keys()].map(((e,t)=>`Custom ${t+1}`))),t};t.parseCustomKeeperCredentialData=(e,t)=>{Object.keys(e).forEach((r=>{const o=e[r];"TFC:Keeper"===o?delete e[r]:"string"==typeof o&&o.startsWith("otpauth://")&&(t.OtpUrl=o,delete e[r])}))}},85803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fieldProcessorForLastPass=t.itemTypeProcessorForLastPass=t.processAndPushLastPassNote=t.parseLastPassSecureNote=t.LPNoteTypeField=t.LastPassNoteType=t.LAST_PASS_SECURE_NOTE_URL=void 0;const o=r(66986),n=r(45127),a=r(97437),i=r(38959);var s,c;t.LAST_PASS_SECURE_NOTE_URL="http://sn",function(e){e.BankAccountType="Bank Account",e.PaymentCardType="Credit Card"}(t.LastPassNoteType||(t.LastPassNoteType={})),t.LPNoteTypeField={NoteType:"NoteType"},function(e){e.BankName="Bank Name",e.AccountType="Account Type",e.RoutingNumber="Routing Number",e.AccountNumber="Account Number",e.SWIFTCode="SWIFT Code",e.IBANNumber="IBAN Number",e.Pin="Pin",e.BranchAddress="Branch Address",e.BranchPhone="BranchPhone",e.Notes="Notes"}(s||(s={})),function(e){e.NameOnCard="Name on Card",e.Type="Type",e.Number="Number",e.SecurityCode="Security Code",e.StartDate="Start Date",e.ExpirationDate="Expiration Date",e.Notes="Notes",e.Language="Language"}(c||(c={}));t.parseLastPassSecureNote=e=>{const r={};try{switch(e.split("\n").forEach((e=>{const[t,o]=e.split(":");r[t]=o})),r.NoteType){case"Bank Account":return{type:"Bank Account",data:{BankAccountName:r["Bank Name"],BankAccountOwner:"",BankAccountIBAN:r["IBAN Number"]?r["IBAN Number"]:r["Account Number"],BankAccountBIC:r["SWIFT Code"]?r["SWIFT Code"]:r["Routing Number"],BankAccountBank:"",kwType:n.DataModelType.KWBankStatement}};case"Credit Card":{const e=r["Expiration Date"];let a,i;if(e){const[t,r]=e.split(",");a=`${(0,o.getMonth)(new Date(`${t} 1`))+1}`,a=a.length<=2?a:"",i=4!==r.length||isNaN(r)?"":r}const s={CardNumber:r.Number,OwnerName:r["Name on Card"],SecurityCode:r["Security Code"],ExpireMonth:a,ExpireYear:i,CCNote:r.Notes,kwType:n.DataModelType.KWPaymentMean_creditCard};delete r[t.LPNoteTypeField.NoteType],delete r["Expiration Date"],delete r.Language,r["Payment Type"]=r.Type,delete r[t.LPNoteTypeField.NoteType];const c=Object.keys(s),d=Object.values(s);return Object.keys(r).forEach((e=>{(c.includes(e)||d.includes(r[e]))&&delete r[e]})),{type:"Credit Card",data:{...r,...s}}}default:return null}}catch{return null}};t.processAndPushLastPassNote=(e,r,o,n,s)=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){delete e.url;const c=(0,t.parseLastPassSecureNote)(e.extra),d="Bank Account"===c?.type?a.BANK_ACCOUNT_HEADERS:"Credit Card"===c?.type?a.PAYMENT_CARD_HEADERS:a.SECURE_NOTES_HEADERS;switch(Object.keys(c?.data??{}).forEach((e=>{const t=Object.keys(d).find((t=>d[t].has(e.toLocaleLowerCase())));!s.has(e)&&e&&s.set(e,{original:e,matched:t??""})})),c?.type){case"Bank Account":{const t={baseDataModel:(0,i.buildBankAccountObj)(c.data,r,s),rawData:e};return void n.bankAccounts.push(t)}case"Credit Card":{const t={baseDataModel:(0,i.buildPaymentCardObj)(c.data,r,s,o),rawData:e};return void n.paymentCards.push(t)}default:{const t={baseDataModel:(0,i.buildNoteObj)(e,r,s),rawData:e};return void n.notes.push(t)}}}};t.itemTypeProcessorForLastPass=e=>{if(e.url?.includes(t.LAST_PASS_SECURE_NOTE_URL)){const r=e.extra.split("\n");let o="";for(let e=0;e<r.length;e++){const[n,a]=r[e]?r[e].split(":"):[];n===t.LPNoteTypeField.NoteType&&(o=a)}switch(o){case"Bank Account":return n.SupportedVaultTypes.BANK_ACCOUNT;case"Credit Card":return n.SupportedVaultTypes.PAYMENT_CARD;default:return n.SupportedVaultTypes.NOTE}}return null};t.fieldProcessorForLastPass=(e,t)=>{switch(e){case"fav":if(!t||t.includes("0"))return null;break;case"grouping":if(!t||t.includes("(none)"))return null}return t}},99474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImportablePersonalData=t.parseCSV=void 0;const o=r(45127),n=r(15318),a=r(92522),i=r(85803),s=r(38959),c=r(10770);function d(e,t,r){t===o.ImportSource["1Password"]&&(e.Category=e.Category.replaceAll(";",",")),e.Category.split(",").forEach((t=>{let o=r.collections.find((e=>e.baseDataModel.Name===t));o||(o={baseDataModel:(0,c.getNewCollection)({name:t,vaultItems:[],spaceId:""}),rawData:{}},r.collections.push(o)),o.baseDataModel.VaultItems.push({Id:e.Id,Type:e.kwType})}))}function l(e,t,r,o){const n={baseDataModel:(0,s.buildNoteObj)(e,t,r),rawData:e};n.baseDataModel.Category&&d(n.baseDataModel,t,o),o.notes.push(n)}function u(e,t,r,o){const n={baseDataModel:(0,s.buildBankAccountObj)(t,e,o),rawData:t};r.bankAccounts.push(n)}function p(e,t,r,o,n){const a={baseDataModel:(0,s.buildPaymentCardObj)(t,e,n,r),rawData:t};o.paymentCards.push(a)}const S="otpauth://totp/?secret=",m=/^otpauth:\/\/.*/;function g(e,t,r,o,a){const i={baseDataModel:(0,s.buildCredentialObj)(e,t,r,o),rawData:e};i.baseDataModel.Category&&d(i.baseDataModel,t,a),i.baseDataModel.OtpUrl&&!m.test(i.baseDataModel.OtpUrl)&&(i.baseDataModel.OtpUrl=S+i.baseDataModel.OtpUrl);const c=new n.ParsedURL(i.baseDataModel.Url);i.baseDataModel.Url&&c.isUrlValid()&&(i.baseDataModel.Url=c.getPIIStrippedURL()),a.credentials.push(i)}const y=(e,t,r,n)=>{const a={credentials:[],notes:[],bankAccounts:[],paymentCards:[],collections:[]},c=new Map;for(let d=0;d<e.length;d++){const S=e[d].reduce(((e,r,o)=>(e[t[o]]=r,e)),{}),m=(0,s.determineBestItemType)(S,r),y=(0,s.getHeadersAndIndexMap)(t,m),A=new Map;if(y.forEach((e=>{(!c.has(e.original)||!c.get(e.original)?.matched&&e.matched)&&c.set(e.original,e),e.matched&&A.set(e.original,e)})),[o.SupportedVaultTypes.BANK_ACCOUNT,o.SupportedVaultTypes.NOTE,o.SupportedVaultTypes.PAYMENT_CARD].includes(m)&&r===o.ImportSource.Lastpass)(0,i.processAndPushLastPassNote)(S,r,n,a,A);else switch(m){case o.SupportedVaultTypes.CREDENTIAL:g(S,r,A,n,a);break;case o.SupportedVaultTypes.PAYMENT_CARD:p(r,S,n,a,A);break;case o.SupportedVaultTypes.BANK_ACCOUNT:u(r,S,a,A);break;case o.SupportedVaultTypes.NOTE:default:l(S,r,A,a)}}return{...a,headers:[...c.values()]}},A=(e,t)=>{const r=/(?=["'])(?:"[^"\\]*(?:\\[\s\S][^"\\]*)*"|'[^'\\]*(?:\\[\s\S][^'\\]*)*')|,,|,\n/gi;let o;for(;o=r.exec(e.trim());){const e=",,"===o[0]?o.index:o.index-1;o.input[e]&&","!==o.input[e]&&t.push([]),",\n"!==o[0]&&t[t.length-1].push(o[0].replace(new RegExp(/","/gi),",").replace(new RegExp(/^"|"$/gi),"").replace(new RegExp(/^,,$/gi),""))}},f=(e,t)=>{const r=/(,|\r?\n|\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^,\r\n]*))/gi;let o;for(;o=r.exec(e.trim());)o[1].length&&","!==o[1]&&t.push([]),t[t.length-1].push(void 0!==o[2]?o[2].replace(new RegExp('^"|"$|"(?=,")|(?<=",)"|""',"gi"),'"'):o[3])};function E(e,t,r){const n={credentials:[],notes:[],paymentCards:[],bankAccounts:[],headers:[],collections:[]};if(!e)return n;const{csvHead:i,csvRows:c}=function(e,t){const r=[[]];if(e.startsWith('"')?A(e,r):f(e,r),t===o.ImportSource.Keeper){const e=r.reduce(((e,t)=>Math.max(e,t.length)),0);r.unshift((0,a.getKeeperImportHeaders)(e))}const[n,...i]=r;return{csvHead:n,csvRows:i}}(e,t),d=i.map((e=>e.toLowerCase()));return c.length&&(0,s.areHeadersValid)(d)?y(c,d,t,r):n}t.parseCSV=E;t.getImportablePersonalData=(e,t)=>{const r=E(e.data,e.importSource,t),{headers:o,...n}=r;return{headers:o,items:Object.values(n).flat()}}},32814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveEventsFromDash=t.getXmlData=t.checkPassword=t.parseDashData=void 0;const o=r(45127),n=r(80469),a=r(53628),i=r(56668),s=r(72365),c=r(61797),d=r(95623),l=r(70252),u=r(78320),p=e=>new RegExp(`-+\\s+${e} BEGIN\\s+-+\n(.+)\n-+\\s+${e} END`);t.parseDashData=e=>{const[t,r]=["Id","Data"].map(p).map((t=>t.exec(e))).map((e=>e?.[1]));return{ids:t?.split(";")??[],encryptedData:r??""}};t.checkPassword=async(e,t,r)=>{const o=(0,s.makeDataEncryptorService)(e);o.setInstance({raw:r},"");try{return(0,i.deflatedUtf8ToUtf16)(await o.getInstance().decrypt(t.encryptedData)),!0}catch(e){const r=`[import] - checkPassword: ${e}, ${t.encryptedData}`,o=new Error(r);(0,l.sendExceptionLog)({error:o}),(0,d.logError)(o)}return!1};t.getXmlData=async(e,t,r)=>{const o=(0,s.makeDataEncryptorService)(e);o.setInstance({raw:r},"");const n=await o.getInstance().decrypt(t.encryptedData),a=(0,i.deflatedUtf8ToUtf16)(n),d=await(0,c.parseDashlaneXml)(a);return Array.isArray(d)?d:[d]};t.getSaveEventsFromDash=async(e,r,i)=>{const s={},c=(await(0,t.getXmlData)(e,r,i)).map((e=>(0,a.fixPersonalDataItemFromExternalSource)((0,n.fixKwType)(e)))).map((e=>{const t=(0,u.generateItemUuid)();return s[e.Id]=t,{...e,Id:t}}));return c.forEach((e=>{(0,o.isCollection)(e)&&e.VaultItems.forEach((e=>{e.Id=s[e.Id]??e.Id}))})),c}},97437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_MAPPINGS=t.TYPE_HEADERS=t.HEADER_MAPPINGS=t.BANK_ACCOUNT_HEADERS=t.PAYMENT_CARD_HEADERS=t.CREDENTIAL_HEADERS=t.SECURE_NOTES_HEADERS=void 0;const o=r(45127);t.SECURE_NOTES_HEADERS={Title:new Set(["title","name"]),Content:new Set(["note","notes","comments","extra","content"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.CREDENTIAL_HEADERS={Title:new Set(["title","name","account","site name"]),Login:new Set(["username","login","login_username","login name","user name"]),Url:new Set(["url","website","domain","login_url","login url","login_uri","web site","website address"]),Email:new Set(["email"]),Password:new Set(["password","login_password"]),OtpUrl:new Set(["first one-time password","login_otp","login_totp","otp","otpauth","otpurl","otpsecret","totp"]),Note:new Set(["note","notes","comments","extra"]),Category:new Set(["category","grouping","tags","folders","folder","tag","collection","collections"])},t.PAYMENT_CARD_HEADERS={CardNumber:new Set(["number","cardnumber","cc_number"]),CCNote:new Set(["notes","ccnote","note"]),OwnerName:new Set(["name on card","ownername","account_name"]),SecurityCode:new Set(["security code","securitycode","code"]),ExpireMonth:new Set(["exp_month","expiremonth","expiration_month"]),ExpireYear:new Set(["exp_year","expireyear","expiration_year"]),Name:new Set(["name"])},t.BANK_ACCOUNT_HEADERS={BankAccountName:new Set(["bank name","bankaccountname","account_name"]),BankAccountIBAN:new Set(["iban number","account number","account_number","bankaccountiban"]),BankAccountBIC:new Set(["swift code","routing number","routing_number","bankaccountbic"]),BankAccountOwner:new Set(["account_holder"]),BankAccountBank:new Set(["issuing_bank"]),LocaleFormat:new Set(["country"])},t.HEADER_MAPPINGS={[o.SupportedVaultTypes.CREDENTIAL]:t.CREDENTIAL_HEADERS,[o.SupportedVaultTypes.NOTE]:t.SECURE_NOTES_HEADERS,[o.SupportedVaultTypes.PAYMENT_CARD]:t.PAYMENT_CARD_HEADERS,[o.SupportedVaultTypes.BANK_ACCOUNT]:t.BANK_ACCOUNT_HEADERS,[o.SupportedVaultTypes.COLLECTION]:{}},t.TYPE_HEADERS=new Set(["type","item type"]),t.TYPE_MAPPINGS={[o.SupportedVaultTypes.NOTE]:["securenote","note","secure note"],[o.SupportedVaultTypes.CREDENTIAL]:["password","login","credential"],[o.SupportedVaultTypes.BANK_ACCOUNT]:["bankaccount","bank"],[o.SupportedVaultTypes.PAYMENT_CARD]:["paymentcard","payment_card","creditcard","debitcard"],[o.SupportedVaultTypes.COLLECTION]:[]}},38959:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areHeadersValid=t.determineBestItemType=t.getHeadersAndIndexMap=t.buildCredentialObj=t.buildBankAccountObj=t.buildPaymentCardObj=t.buildNoteObj=t.reduceVaultObj=t.constructBankAccount=t.constructPaymentCard=t.constructSecureNote=t.constructCredentialContent=t.formatCredentialData=t.buildNoteContent=void 0;const o=r(45127),n=r(15318),a=r(9763),i=r(23439),s=r(35834),c=r(8639),d=r(97437),l=r(62754),u=r(89586),p=r(92522),S=r(78320),m=r(13675),g=r(53),y=(e,t)=>{for(const r in e)t.includes(r)||delete e[r]};t.buildNoteContent=(e,t,r,n,a)=>{let i="";if((0,o.isCredential)(e))i=e.Note??"";else if((0,o.isNote)(e))e.Note&&(e.Content=e.Note,delete e.Note),i=e.Content;else{if(!(0,o.isPaymentCard)(e))return;i=e.CCNote}const s=!!i;let c=!1;const d={...e,...r};for(const e in d)if(!n.includes(e)&&!t.get(e)?.matched&&d[e]){if(a?a(e.toLocaleLowerCase(),d[e]):d[e]){i+=`${s&&!c?"\n\n\n":"\n"}${e}: ${d[e]}`,c=!0}}i=i.trim(),(0,o.isCredential)(e)?e.Note=i:(0,o.isNote)(e)?e.Content=i:(0,o.isPaymentCard)(e)&&(e.CCNote=i)};t.formatCredentialData=e=>{let t=e.Url?.trim()??"";const r=e.Url?.split(",")??[""];if(r.length>1&&new n.ParsedURL(r[0]).isUrlValid()&&r.slice(1).some((e=>new n.ParsedURL(e).isUrlValid()))){const[r,...a]=e.Url?.split(",")??[];t=r.trim(),e.LinkedServices={associated_domains:[]},a.forEach((t=>{const r=new n.ParsedURL(t.trim());r.isUrlValid()&&e.LinkedServices?.associated_domains.push({domain:r.getPIIStrippedURL(),source:o.LinkedWebsiteSource.Manual})}))}const a=new n.ParsedURL(t);e.Url=a.isUrlValid()?t:"";const i=new n.ParsedURL(e.Title?.trim());(!e.Title||i.isUrlValid({requireEtld:!0})&&i.getRootDomain()===a.getRootDomain())&&(e.Title=a.getRootDomain()??"")};t.constructCredentialContent=(e,t,r)=>({Title:"",Email:"",Login:"",Password:"",Note:"",...e,...(0,a.createBaseCredentialModel)(t),...(0,i.getUrlFields)(e.Url??"",!0),SpaceId:r??"",SubdomainOnly:!1,SecondaryLogin:"",Category:"",AutoLogin:!0,AutoProtected:!1,Strength:0});t.constructSecureNote=(e,t)=>(e=>{const t=(0,m.sanitizeInputPersonalData)(e),r=(0,g.getUnixTimestamp)();return{kwType:"KWSecureNote",CreationDatetime:r,Id:(0,S.generateItemUuid)(),LocaleFormat:o.Country.US,SpaceId:t.spaceId||"",UserModificationDatetime:r,LastBackupTime:0,Title:t.title||"Untitled note",Content:t.content||"",Secured:t.secured||!1,Type:t.type||"GRAY",Attachments:t.attachments||[]}})({content:e.Content||"",title:e.Title||"",secured:!1,type:o.NoteTypes[0],spaceId:t||""});t.constructPaymentCard=(e,t)=>(0,s.getNewPaymentCard)({ownerName:e.OwnerName??"",cardName:e.Name??"",cardNumber:e.CardNumber??"",securityCode:e.SecurityCode??"",expireMonth:e.ExpireMonth??"",expireYear:e.ExpireYear??"",...e,spaceId:t});t.constructBankAccount=(e,t,r)=>(0,c.getNewBankAccount)({name:e.BankAccountName??"",owner:e.BankAccountOwner??"",IBAN:e.BankAccountIBAN??"",BIC:e.BankAccountBIC??"",bank:e.BankAccountBank??"",country:t,...e,spaceId:r??""});t.reduceVaultObj=(e,t,r,o,n)=>Object.entries(e).reduce(((e,[t,n])=>{const a=o.get(t)?.matched;return o.has(t)&&a&&(e[a]=r?r(t,"string"==typeof n?n:""):n),e}),t({},n));t.buildNoteObj=(e,r,o)=>{const n=Object.keys({Title:"",Content:"",Category:"",Secured:"",Type:"",LocaleFormat:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDate:"",UpdateDate:"",limitedPermissions:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),a=(0,u.getFieldLevelProcessor)(r),i=(0,t.reduceVaultObj)(e,t.constructSecureNote,a,o);return(0,t.buildNoteContent)(i,o,e,n,a),y(i,n),i};t.buildPaymentCardObj=(e,r,o,n)=>{const a=Object.keys({Name:"",CardNumber:"",CardNumberLastDigits:"",OwnerName:"",SecurityCode:"",ExpireMonth:"",ExpireYear:"",StartMonth:"",StartYear:"",IssueNumber:"",Color:"",Bank:"",CCNote:"",Type:"",LocaleFormat:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),i=(0,u.getFieldLevelProcessor)(r),s=(0,t.reduceVaultObj)(e,t.constructPaymentCard,i,o,n);return(0,t.buildNoteContent)(s,o,e,a,i),y(s,a),s};t.buildBankAccountObj=(e,r,o)=>{const n=Object.keys({BankAccountName:"",BankAccountOwner:"",BankAccountIBAN:"",BankAccountBIC:"",BankAccountBank:"",LocaleFormat:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",UserModificationDatetime:"",LastUse:"",Attachments:""}),a=(0,u.getFieldLevelProcessor)(r),i=(0,t.reduceVaultObj)(e,t.constructBankAccount,a,o);return y(i,n),i};t.buildCredentialObj=(e,r,n,a)=>{const i=Object.keys({Title:"",Email:"",Login:"",SecondaryLogin:"",Password:"",Strength:"",Category:"",Url:"",UseFixedUrl:"",TrustedUrlGroup:"",LocaleFormat:"",SpaceId:"",kwType:"",Id:"",LastBackupTime:"",CreationDatetime:"",LastUse:"",Note:"",SubdomainOnly:"",AutoLogin:"",AutoProtected:"",OtpSecret:"",UserSelectedUrl:"",Checked:"",Status:"",SharedObject:"",ModificationDatetime:"",NumberUse:"",Type:"",Server:"",Port:"",Alias:"",SID:"",ConnectionOptions:"",domainIcon:"",limitedPermissions:"",LinkedServices:"",UserModificationDatetime:"",Attachments:"",OtpUrl:""}),s=(0,u.getFieldLevelProcessor)(r),c=(0,t.reduceVaultObj)(e,t.constructCredentialContent,s,n,a);if(r===o.ImportSource.Keeper)(0,p.parseCustomKeeperCredentialData)(e,c);return(0,t.buildNoteContent)(c,n,e,i,s),y(c,i),(0,t.formatCredentialData)(c),c};t.getHeadersAndIndexMap=(e,t)=>{const r=((e,t)=>{const r=Object.keys(t),o={};return e.forEach(((e,n)=>{const a=r.find((r=>t[r].has(e)));o[a??e]={supported:!!a,index:n}})),o})(e,d.HEADER_MAPPINGS[t]),o=Object.entries(r).reduce(((e,[t,r])=>({...e,[r.index]:r.supported?t:""})),{});return e.map(((e,t)=>({original:e,matched:o[t]??""})))};t.determineBestItemType=(e,t)=>{let r=null;const n=(0,l.getItemTypeProcessor)(t);if(n){r=n(e)}if(!r){for(const t in e)if(d.TYPE_HEADERS.has(t)&&(r=Object.keys(d.TYPE_MAPPINGS).find((r=>d.TYPE_MAPPINGS[r]?.includes(e[t].toLocaleLowerCase()))),r))break;if(!r){const t=Object.keys(e).map((e=>e.toLocaleLowerCase())),o={};Object.entries(d.HEADER_MAPPINGS).forEach((([r,n])=>{Object.values(n).forEach((n=>{o[r]=(o[r]||0)+[...n].filter((r=>t.includes(r)&&e[r])).length}))}));r=Object.keys(o).reduce(((e,t)=>o[e]>o[t]?e:t))}}return r||o.SupportedVaultTypes.NOTE};t.areHeadersValid=e=>{if(!e.length)return!1;const t=Object.values(d.HEADER_MAPPINGS);return Object.values(t).reduce(((e,t)=>[...e,...Object.values(t).map((e=>Array.from(e)))]),[]).flat().some((t=>e.includes(t)))}},61655:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifyNewImportPersonalDataStateAction=t.NOTIFY_NEW_PERSONAL_DATA_STATE=void 0,t.NOTIFY_NEW_PERSONAL_DATA_STATE="NOTIFY_NEW_PERSONAL_DATA_STATE";t.notifyNewImportPersonalDataStateAction=e=>({type:t.NOTIFY_NEW_PERSONAL_DATA_STATE,newState:e})},36784:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImportDataStateReducer=void 0;const o=r(45127),n=r(61655);t.ImportDataStateReducer=(e,t)=>t.type===n.NOTIFY_NEW_PERSONAL_DATA_STATE?{state:t.newState}:e??{state:{status:o.ImportPersonalDataStateType.Idle}}},6205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserAddedLinkedWebsitesRootDomains=t.getUserAddedLinkedWebsiteDomains=t.getDashlaneDefinedLinkedWebsites=t.populateDashlaneDefinedLinkedWebsitesIndex=t.reduceLinkedDomainsLists=t.fromObjectToArray=void 0;const o=r(93843),n=r(48501),a=r(21543),i=r(15318);function s(e){const t=[];return Object.keys(e).forEach((r=>{t.push([r].concat(e[r]))})),t}t.fromObjectToArray=s;const c=(e,t)=>{const r=[],o=[];e.forEach((e=>{return n=t,e.some((e=>n.includes(e)))?r.push(e):o.push(e);var n}));const n=r.concat([t]).flat();return o.concat([n])};function d(e){const t={};return e.forEach((e=>{e.forEach((r=>{t[r]=e}))})),t}t.reduceLinkedDomainsLists=(e,t,r)=>e.concat(t,r).reduce(c,[]),t.populateDashlaneDefinedLinkedWebsitesIndex=d;const l=d((0,t.reduceLinkedDomainsLists)(o,s(a),s(n)).map((e=>[...new Set(e)])));t.getDashlaneDefinedLinkedWebsites=function(e){const t=new i.ParsedURL(e).getRootDomain();return t?l[t]||[t]:[]};t.getUserAddedLinkedWebsiteDomains=e=>(e.LinkedServices?.associated_domains??[]).map((e=>e.domain)).filter(Boolean)??[];t.getUserAddedLinkedWebsitesRootDomains=e=>(0,t.getUserAddedLinkedWebsiteDomains)(e).map((e=>new i.ParsedURL(e).getRootDomain()))},81911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(18665),n=r(85569),a=r(37215);t.config={commands:{addPasskey:{handler:a.addPasskeyHandler},updatePasskey:{handler:a.updatePasskeyHandler}},queries:{getPasskey:{selector:o.viewedPasskeySelector},getPasskeys:{selector:o.viewedQueriedPasskeysSelector},getPasskeysForDomain:{selector:o.viewedQueriedPasskeysForDomainSelector}},liveQueries:{livePasskey:{operator:n.getPasskey$},livePasskeys:{operator:n.passkeys$}}}},70863:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPasskeyHandler=t.getNewPasskey=void 0;const o=r(48062),n=r(45127),a=r(23136),i=r(48313),s=r(53),c=r(78320),d=r(70252),l=r(13675);function u(e){const t=(0,s.getUnixTimestamp)(),r={kwType:"KWPasskey",Id:e.id??(0,c.generateItemUuid)(),LastBackupTime:0,LastUse:t,LocaleFormat:n.Country.UNIVERSAL,SpaceId:e.spaceId,CreationDatetime:t,UserModificationDatetime:t,Counter:0,CredentialId:e.credentialId,ItemName:e.itemName,Note:e.note,RpId:e.rpId,RpName:e.rpName,UserDisplayName:e.userDisplayName,UserHandle:e.userHandle};return e.keyAlgorithm===n.WebAuthnKeyAlgorithm.CloudPasskey?{...r,KeyAlgorithm:e.keyAlgorithm,CloudCipheringKey:e.cloudCipheringKey}:{...r,KeyAlgorithm:e.keyAlgorithm,PrivateKey:e.privateKey}}t.getNewPasskey=u,t.addPasskeyHandler=async function(e,t){try{const r=await async function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to savePasskey");const o=u((0,l.sanitizeInputPersonalData)(r));if(!o.SpaceId){const t=await(0,a.getDefaultSpaceId)(e);o.SpaceId=t}return e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData(),o.Id}(e,t);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),{success:!0,id:r}}catch(e){return(0,d.sendExceptionLog)({error:e}),{success:!1}}}},37215:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(70863),t),n(r(89979),t)},89979:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePasskeyHandler=t.getUpdatedPasskey=t.getPasskeyModifiedProperties=void 0;const o=r(48062),n=r(18665),a=r(23136),i=r(48313),s=r(53),c=r(70252),d=r(13675);function l(e,r){const o=(0,n.passkeySelector)(e,r.id);if(!o)throw new Error("[updatePasskey]: unable to find passkey to update.");return{...o,...(0,t.getPasskeyModifiedProperties)(r,o)}}t.getPasskeyModifiedProperties=(e,t)=>{const r=(0,s.getUnixTimestamp)();return{Counter:e.counter??t.Counter,Note:e.note??t.Note,SpaceId:e.spaceId??t.SpaceId,ItemName:e.itemName??t.ItemName,LastUse:r}},t.getUpdatedPasskey=l,t.updatePasskeyHandler=function(e,t){try{const r=function({storeService:e,sessionService:t},r){if(!e.isAuthenticated())throw new Error("No session available to updatePasskey");const o=l(e.getState(),(0,d.sanitizeInputPersonalData)(r));return e.dispatch((0,i.savePersonalDataItem)(o,o.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}(e,t);if(!r.success)return Promise.resolve(r);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,c.sendExceptionLog)({error:e}),Promise.resolve({success:!1})}}},85569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskey$=t.passkeys$=void 0;const o=r(18948),n=r(3343),a=r(55220),i=r(18665);t.passkeys$=(0,a.getLivePersonalInfo)(i.getLivePasskeysSelector);t.getPasskey$=e=>{const t=(0,i.getViewedPasskeySelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())}},62900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasskeyMappers=void 0;const o=r(83539);t.getPasskeyMappers=()=>({id:e=>e.Id,itemName:e=>e.ItemName,lastUse:o.lastUseMapper,rpId:e=>e.RpId,spaceId:e=>e.SpaceId,userDisplayName:e=>e.UserDisplayName})},96664:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passkeyMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("RpId"),(0,n.stringProp)("RpName"),(0,n.stringProp)("CredentialId")],t.passkeyMatch=(0,o.match)(t.searchGetters)},18665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedPasskeysForDomainSelector=t.queryPasskeysByDomainSelector=t.getPasskeysByFullDomainSelector=t.getViewedPasskeySelector=t.viewedPasskeySelector=t.getLivePasskeysSelector=t.viewedQueriedPasskeysSelector=t.queryPasskeysSelector=t.passkeyMappersSelector=t.passkeySelector=t.passkeysSelector=void 0;const o=r(62433),n=r(15318),a=r(96664),i=r(40200),s=r(24589),c=r(63566),d=r(97006),l=r(49551),u=r(32034),p=r(62900),S=e=>e.userSession.personalData.passkeys;t.passkeysSelector=S;t.passkeySelector=(e,t)=>{const r=S(e);return(0,l.findDataModelObject)(t,r)};t.passkeyMappersSelector=e=>(0,p.getPasskeyMappers)();const m=()=>a.passkeyMatch;t.queryPasskeysSelector=(0,s.getQuerySelector)(t.passkeysSelector,m,t.passkeyMappersSelector),t.viewedQueriedPasskeysSelector=(0,o.compose)((0,c.viewListResults)(i.listView),t.queryPasskeysSelector),t.getLivePasskeysSelector=(0,d.makeLiveSelectorGetter)(t.passkeysSelector,(()=>i.listView),m,t.passkeyMappersSelector);t.viewedPasskeySelector=(e,r)=>{const o=(0,t.passkeySelector)(e,r);return(0,i.detailView)(o)};t.getViewedPasskeySelector=e=>{const r=(0,u.createSelector)(t.passkeysSelector,(t=>(0,l.findDataModelObject)(e,t)));return(0,u.createSelector)(r,i.detailView)};t.getPasskeysByFullDomainSelector=e=>(0,u.createSelector)(t.passkeysSelector,(t=>((e,t)=>e.filter((e=>{const r=new n.ParsedURL(e.RpId).getHostname(),o=new n.ParsedURL(t).getHostname();return o===r||o.endsWith(`.${r}`)})))(t,e)));t.queryPasskeysByDomainSelector=e=>(0,s.getQuerySelector)((0,t.getPasskeysByFullDomainSelector)(e),m,t.passkeyMappersSelector);t.viewedQueriedPasskeysForDomainSelector=(e,r)=>{const o=(0,t.queryPasskeysByDomainSelector)(r.domain)(e,r);return(0,c.viewListResults)(i.listView)(o)}},40200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.detailView=void 0;const o=r(45127),n=r(82043),a=e=>{const t={credentialId:e.CredentialId,counter:e.Counter,itemName:e.ItemName,note:e.Note,spaceId:e.SpaceId,rpId:e.RpId,rpName:e.RpName,userDisplayName:e.UserDisplayName,userHandle:e.UserHandle};return(0,o.isCloudPasskey)(e)?{...t,keyAlgorithm:e.KeyAlgorithm,cloudCipheringKey:e.CloudCipheringKey}:{...t,keyAlgorithm:e.KeyAlgorithm,privateKey:e.PrivateKey}};t.detailView=e=>({...(0,n.dataModelDetailView)(e),...a(e)});t.itemView=e=>({...(0,n.dataModelItemView)(e),...a(e)});t.listView=e=>e.map(t.itemView)},68728:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(83449),n=r(47205),a=r(58695);t.config={commands:{saveGeneratedPassword:{handler:n.saveGeneratedPasswordHandler}},queries:{getPasswordHistoryPage:{selector:o.passwordHistoryPageSelector},getPasswordHistoryPaginationToken:{selector:o.passwordHistoryPaginationTokenSelector},getHasPasswordHistory:{selectorFactory:e=>{const t=e.applicationModulesAccess.createClients().sharingItems;return Promise.resolve((0,o.makeHasPasswordHistorySelector)(t))}}},liveQueries:{livePasswordHistoryBatch:{operator:a.passwordHistoryBatch$}}}},58695:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryBatch$=void 0;const o=r(18948),n=r(3343),a=r(83449),i=r(35893),s=r(33627);t.passwordHistoryBatch$=e=>{const t=(0,i.parseToken)(e),r=(0,a.getViewedPasswordHistoryBatchSelector)(t);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(s.sameBatch))}},87644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryMappers=void 0;t.getPasswordHistoryMappers=()=>({primaryInfo:e=>e.primaryInfo,timestamp:e=>e.timestamp,type:e=>e.type,id:e=>e.id,credentialId:e=>"credentialId"in e&&e.credentialId||""})},25294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPasswordHistoryBatch=t.viewPasswordHistoryBatch=t.getPasswordHistoryFirstToken=t.getPasswordHistorySortToken=t.getPasswordHistoryFilterToken=void 0;const o=r(20553),n=r(2104),a=r(62433),i=r(90451);t.getPasswordHistoryFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getPasswordHistorySortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getPasswordHistoryFirstToken=(e,t,r,n)=>(0,o.generateFirstToken)(e,t,r.initialBatchSize||30,n);t.viewPasswordHistoryBatch=(e,t)=>{const r=(0,i.getIcon)(t);return(0,n.listView)(r,e)},t.getPasswordHistoryBatch=(0,a.curry)(((e,t,r)=>(0,o.getBatch)(r,e,t)))},36859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordHistoryItemMatch=t.searchGettersForGeneratedPassword=t.searchGettersForCredential=void 0;const o=r(45127),n=r(82234),a=r(64455),i=r(6205);t.searchGettersForCredential=[(0,n.stringProp)("primaryInfo"),(0,n.stringProp)("domain"),(0,n.stringProp)("email"),(0,n.stringProp)("login"),(0,n.stringProp)("secondaryLogin"),e=>(0,i.getDashlaneDefinedLinkedWebsites)(e.domain).join(" ")],t.searchGettersForGeneratedPassword=[(0,n.stringProp)("primaryInfo")];t.passwordHistoryItemMatch=(e,r)=>r.type===o.PasswordHistoryItemType.Credential?(0,a.match)(t.searchGettersForCredential)(e,r):(0,a.match)(t.searchGettersForGeneratedPassword)(e,r)},83449:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPasswordHistoryBatchSelector=t.passwordHistoryQuerySelector=t.passwordHistoryPaginationTokenSelector=t.passwordHistoryPageSelector=t.passwordHistoryListViewSelector=t.getPasswordHistoryMappersSelector=t.passwordHistoryMappersSelector=t.makeHasPasswordHistorySelector=t.passwordHistorySelector=void 0;const o=r(32034),n=r(18948),a=r(45127),i=r(15318),s=r(66638),c=r(92598),d=r(35385),l=r(51319),u=r(36859),p=r(25294),S=r(87644),m=r(35893),g=r(20553),y=r(91210),A=r(91892),f=r(70252),E=e=>"ChangedProperties"in e&&e.ChangedProperties.some((e=>"password"===e.toLowerCase())),h=(0,o.createSelector)(l.credentialsSelector,(e=>e.reduce(((e,t)=>e.set(t.Id,t)),new Map)));t.passwordHistorySelector=(0,o.createSelector)(c.generatedPasswordsSelector,d.credentialsHistoriesSelector,h,y.limitedSharingItemsSelector,((e,t,r,o)=>{const n=e.filter((e=>!e.AuthId)).map((e=>({type:a.PasswordHistoryItemType.Generated,primaryInfo:e.Domain??"",secondaryInfo:"",domain:e.Domain,password:e.Password,timestamp:e.GeneratedDate,id:e.Id,isProtected:!1}))),s=t.reduce(((e,t)=>{if(o[t.ObjectId]||!t.hasOwnProperty("ChangeSets"))return e;const n=r.get(t.ObjectId);if(!n)return e;const s=n?.Title,c=n?.Url,d=n?.Email,l=n?.Login,u=n?.AutoProtected||!1,p=t.ChangeSets.reduce(((e,t)=>{if(!E(t)||(!(r=t.CurrentData)||void 0===r.Email&&void 0===r.Login||void 0===r.Url||void 0===r.Password))return e;var r;const o=new i.ParsedURL(c).getRootDomain(),p={type:a.PasswordHistoryItemType.Credential,primaryInfo:(s||o)??"",secondaryInfo:(d||l)??"",domain:c||t.CurrentData.Url,password:t.CurrentData.Password,timestamp:t.ModificationDate,id:t.Id,credentialId:n?.Id,isProtected:u,spaceId:n.SpaceId,email:n?.Email??"",login:n?.Login??"",secondaryLogin:n?.SecondaryLogin??""};return e.concat(p)}),[]);return e.concat(p)}),[]);return n.concat(s)}));t.makeHasPasswordHistorySelector=e=>async(t,r)=>{const o=await(0,n.firstValueFrom)(e.queries.getPermissionForItems({itemIds:[r]}));if((0,s.isFailure)(o))return(0,f.sendExceptionLog)(new Error("Could not retrieve item permission for hasPasswordHistorySelector")),!1;const a=(0,s.getSuccess)(o);return(0,d.credentialsHistoriesSelector)(t).some((e=>{return e.ObjectId===r&&(t=e.ObjectId,!a[t]||a[t].capabilities.canView)&&e.ChangeSets.some(E);var t}))};t.passwordHistoryMappersSelector=e=>(0,S.getPasswordHistoryMappers)();const v=(0,S.getPasswordHistoryMappers)();t.getPasswordHistoryMappersSelector=()=>v;t.passwordHistoryListViewSelector=(0,o.createSelector)(A.iconsSelector,t.passwordHistorySelector,(e=>t=>(0,p.viewPasswordHistoryBatch)(t,e)));t.passwordHistoryPageSelector=(e,r)=>{const o=(0,m.parseToken)(r),{sortToken:n,filterToken:a}=o,i=(0,S.getPasswordHistoryMappers)(),s=(0,t.passwordHistoryQuerySelector)(e,{sortToken:n,filterToken:a}),c=(0,t.passwordHistoryListViewSelector)(e),d=(0,g.generateNextToken)(i,o,s),l=(0,g.generatePrevToken)(i,o,s),u=(0,g.getBatch)(i,o,s),p=(0,m.stringifyToken)(d),y=(0,m.stringifyToken)(l);return{batch:c(u),nextToken:p,prevToken:y}};t.passwordHistoryPaginationTokenSelector=(e,r)=>{const o=(0,p.getPasswordHistorySortToken)(r),n=(0,p.getPasswordHistoryFilterToken)(r),a=(0,S.getPasswordHistoryMappers)(),i={sortToken:o,filterToken:n},s=(0,t.passwordHistoryQuerySelector)(e,i),c=(0,p.getPasswordHistoryFirstToken)(a,i,r,s);return(0,m.stringifyToken)(c)};const T=(0,o.createSelector)(t.passwordHistorySelector,S.getPasswordHistoryMappers),_=(0,m.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),n.identity),I=(0,m.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),n.identity);t.passwordHistoryQuerySelector=(0,o.createSelector)(S.getPasswordHistoryMappers,(()=>u.passwordHistoryItemMatch),_,I,t.passwordHistorySelector,m.queryData);t.getViewedPasswordHistoryBatchSelector=e=>{const{sortToken:r,filterToken:n}=e,a=(0,p.getPasswordHistoryBatch)(e),i=(0,o.createSelector)((e=>(0,t.passwordHistoryQuerySelector)(e,{filterToken:n,sortToken:r})),T,a),s=(0,m.optimizeBatchSelector)(i);return(0,o.createSelector)(s,A.iconsSelector,p.viewPasswordHistoryBatch)}},2104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=void 0;const o=r(45127);t.listView=(e,t)=>t.map((t=>t.type===o.PasswordHistoryItemType.Credential?{type:o.PasswordHistoryItemType.Credential,id:t.id,primaryInfo:t.primaryInfo,secondaryInfo:t.secondaryInfo,password:t.password,timestamp:t.timestamp,credentialId:t.credentialId,icons:e(t.domain),isProtected:t.isProtected,spaceId:t.spaceId,domain:t.domain}:{type:o.PasswordHistoryItemType.Generated,id:t.id,primaryInfo:t.primaryInfo,password:t.password,timestamp:t.timestamp}))},17025:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(58235),n=r(7408),a=r(48121);t.config={commands:{addPaymentCard:{handler:a.addPaymentCardHandler},updatePaymentCard:{handler:a.updatePaymentCardHandler}},queries:{getPaymentCard:{selector:o.viewedPaymentCardSelector},getPaymentCards:{selector:o.viewedQueriedPaymentCardsSelector}},liveQueries:{livePaymentCard:{operator:n.getPaymentCard$},livePaymentCards:{operator:n.paymentCards$}}}},19738:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPaymentCardHandler=t.getNewPaymentCard=void 0;const o=r(48062),n=r(45127),a=r(23136),i=r(42316),s=r(48313),c=r(53),d=r(78320),l=r(70252),u=r(13675),p=r(79980);function S(e){e=(0,u.sanitizeInputPersonalData)(e);const t=(0,c.getUnixTimestamp)(),r=(0,i.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");if(!r&&!e.securityCode)throw new i.RequestError("[addPaymentCard]: refusing to add a payment card without card number or security code.",n.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return{kwType:"KWPaymentMean_creditCard",Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,i.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,i.defaultToFallbackColor)(e.color),ExpireMonth:(0,i.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,i.defaultToEmptyString)(e.expireYear),Id:(0,d.generateItemUuid)(),IssueNumber:"",Name:(0,i.defaultToEmptyString)(e.name),OwnerName:(0,i.defaultToEmptyString)(e.ownerName),CCNote:(0,i.defaultToEmptyString)(e.personalNote),LocaleFormat:n.Country.US,SecurityCode:(0,i.defaultToEmptyString)(e.securityCode),SpaceId:(0,i.defaultToEmptyString)(e.spaceId),StartYear:"",StartMonth:"",Type:(0,i.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}t.getNewPaymentCard=S;t.addPaymentCardHandler=async(e,t)=>{try{await(async({storeService:e,sessionService:t,eventLoggerService:r},o)=>{if(!e.isAuthenticated())throw new Error("No session available to addPaymentCard");const n=S(o);if(!n.SpaceId){const t=await(0,a.getDefaultSpaceId)(e);n.SpaceId=t}(0,p.logAddVaultItem)(e,r,n),e.dispatch((0,s.savePersonalDataItem)(n,n.kwType)),t.getInstance().user.persistPersonalData()})(e,t);return(0,a.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,l.sendExceptionLog)({error:e}),e instanceof i.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},48121:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(19738),t),n(r(65468),t)},65468:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePaymentCardHandler=t.getUpdatedPaymentCard=void 0;const o=r(48062),n=r(45127),a=r(58235),i=r(23136),s=r(42316),c=r(48313),d=r(53),l=r(70252),u=r(13675),p=r(79980);function S(e,t){if(!e)throw new s.RequestError("[updatePaymentCard]: unable to find payment card to update.",n.PaymentCardSaveResultErrorCode.NOT_FOUND);t=(0,u.sanitizeInputPersonalData)(t);const r=(0,s.defaultToEmptyString)(t.cardNumber??e.CardNumber).replace(/ /g,""),o=(0,d.getUnixTimestamp)(),a={CardNumber:r,CardNumberLastDigits:(0,s.getLastDigitsFromCardNumber)(r),Color:t.color??e.Color,ExpireMonth:t.expireMonth??e.ExpireMonth,ExpireYear:t.expireYear??e.ExpireYear,Name:t.name??e.Name,OwnerName:t.ownerName??e.OwnerName,SecurityCode:t.securityCode??e.SecurityCode,SpaceId:t.spaceId??e.SpaceId,Type:(0,s.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:o,CCNote:t.personalNote??e.CCNote},i={...e,...a};if(!r&&!i.SecurityCode)throw new s.RequestError("[updatePaymentCard]: refusing to add a payment card without card number or security code.",n.PaymentCardSaveResultErrorCode.EMPTY_CARD_NUMBER_AND_SECURITY_CODE);return i}t.getUpdatedPaymentCard=S,t.updatePaymentCardHandler=function(e,t){try{!function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())throw new Error("No session available to updatePaymentCard");const n=(0,a.paymentCardSelector)(e.getState(),o.id),i=S(n,o);(0,p.logEditVaultItem)(e,r,i,n),e.dispatch((0,c.savePersonalDataItem)(i,i.kwType)),t.getInstance().user.persistPersonalData()}(e,t);return(0,i.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.Save),Promise.resolve({success:!0})}catch(e){return(0,l.sendExceptionLog)({error:e}),e instanceof s.RequestError&&void 0!==e.code?Promise.resolve({success:!1,error:{code:e.code}}):Promise.resolve({success:!1})}}},42316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RequestError=t.getPaymentTypeFromCardNumber=t.getLastDigitsFromCardNumber=t.defaultColor=t.defaultToFallbackColor=t.defaultToEmptyString=void 0;const o=r(62433),n=r(45127);t.defaultToEmptyString=(0,o.defaultTo)(""),t.defaultToFallbackColor=(0,o.defaultTo)(n.PaymentCardColor.BLUE_1),t.defaultColor="BLUE_1",t.getLastDigitsFromCardNumber=function(e){const r=(0,t.defaultToEmptyString)(e).trim();return r.length>=4?r.slice(-4):""},t.getPaymentTypeFromCardNumber=function(e){if(!e)return n.PaymentCardType.PAYMENT_TYPE_VISA;const t=(e,t)=>t.some((t=>e.startsWith(t)));return e.startsWith("4")?n.PaymentCardType.PAYMENT_TYPE_VISA:t(e,["34","37"])?n.PaymentCardType.PAYMENT_TYPE_AMEX:t(e,["50","51","52","53","54","55"])?n.PaymentCardType.PAYMENT_TYPE_MASTERCARD:t(e,["6011","65"])?n.PaymentCardType.PAYMENT_TYPE_DISCOVER:t(e,["300","301","302","303","304","305","36","38"])?n.PaymentCardType.PAYMENT_TYPE_DINERSCLUB:t(e,["2123","2131","1800","3"])?n.PaymentCardType.PAYMENT_TYPE_JCB:n.PaymentCardType.PAYMENT_TYPE_MASTERCARD};class a extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=a},35834:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedPaymentCard=t.getNewPaymentCard=t.savePaymentCard=void 0;const o=r(62433),n=r(45127),a=r(95623),i=r(45291),s=r(78320),c=r(53),d=r(49551),l=r(42316),u=r(79980);function p(e){a.default.log("[Data] Creating new Payment Card");const t=(0,c.getUnixTimestamp)(),r=(0,l.defaultToEmptyString)(e.cardNumber).replace(/ /g,"");return{kwType:"KWPaymentMean_creditCard",Bank:"US-NO_TYPE",CardNumber:r,CardNumberLastDigits:(0,l.getLastDigitsFromCardNumber)(r),CreationDatetime:t,Color:(0,o.defaultTo)(n.PaymentCardColor.BLUE_1,e.color),ExpireMonth:(0,l.defaultToEmptyString)(e.expireMonth),ExpireYear:(0,l.defaultToEmptyString)(e.expireYear),Id:(0,s.generateItemUuid)(),IssueNumber:"",Name:(0,o.defaultTo)("Card",e.cardName),OwnerName:(0,l.defaultToEmptyString)(e.ownerName),CCNote:(0,l.defaultToEmptyString)(e.personalNote),LocaleFormat:n.Country.US,SecurityCode:(0,l.defaultToEmptyString)(e.securityCode),SpaceId:e.spaceId||"",StartYear:"",StartMonth:"",Type:(0,l.getPaymentTypeFromCardNumber)(r),UserModificationDatetime:t,LastBackupTime:0}}function S(e,t){const r=(0,d.findDataModelObject)(t.id,e);if(!r)return void a.default.log("Client asks to update an unknown Payment Card");a.default.log(`[Data] Updating existing Payment Card ${t.id}`);const n=(0,c.getUnixTimestamp)(),i=(0,l.defaultToEmptyString)(t.cardNumber).replace(/ /g,""),s={CardNumber:i,CardNumberLastDigits:(0,l.getLastDigitsFromCardNumber)(i),Color:t.color?t.color:r.Color,ExpireMonth:(0,l.defaultToEmptyString)(t.expireMonth),ExpireYear:(0,l.defaultToEmptyString)(t.expireYear),Name:(0,o.defaultTo)("Card",t.cardName),OwnerName:(0,l.defaultToEmptyString)(t.ownerName),SecurityCode:(0,l.defaultToEmptyString)(t.securityCode),SpaceId:(0,l.defaultToEmptyString)(t.spaceId),Type:(0,l.getPaymentTypeFromCardNumber)(t.cardNumber),UserModificationDatetime:n,CCNote:(0,l.defaultToEmptyString)(t.personalNote)};return{...r,...s}}t.savePaymentCard=function({storeService:e,sessionService:t,eventLoggerService:r},o){if(!e.isAuthenticated())return void a.default.log("No session available to savePaymentCard");const n=e.getPersonalData(),s=o.id?S(n.paymentCards,o):p(o);if(o.id){const t=(0,d.findDataModelObject)(s.Id,n.paymentCards);(0,u.logEditVaultItem)(e,r,s,t)}else(0,u.logAddVaultItem)(e,r,s);e.dispatch((0,i.savePaymentCard)(s)),t.getInstance().user.persistPersonalData()},t.getNewPaymentCard=p,t.getUpdatedPaymentCard=S},7408:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCard$=t.paymentCards$=void 0;const o=r(18948),n=r(3343),a=r(55220),i=r(58235);t.paymentCards$=(0,a.getLivePersonalInfo)(i.getLivePaymentCardsSelector);t.getPaymentCard$=e=>{const t=(0,i.getViewedPaymentCardSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())}},91663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentCardMappers=void 0;const o=r(83539);t.getPaymentCardMappers=()=>({spaceId:e=>e.SpaceId,name:e=>e.Name,lastUse:o.lastUseMapper,id:e=>e.Id})},38701:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paymentCardMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("Name"),(0,o.stringProp)("OwnerName")],t.paymentCardMatch=(0,n.match)(t.searchGetters)},58235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getViewedPaymentCardSelector=t.viewedPaymentCardSelector=t.getLivePaymentCardsSelector=t.viewedQueriedPaymentCardsSelector=t.queryPaymentCardsSelector=t.paymentCardMappersSelector=t.paymentCardSelector=t.paymentCardsSelector=void 0;const o=r(62433),n=r(38701),a=r(8818),i=r(24589),s=r(63566),c=r(97006),d=r(49551),l=r(32034),u=r(91663),p=r(40602),S=r(57989);t.paymentCardsSelector=(0,l.createSelector)((e=>e.userSession.personalData.paymentCards),S.quarantinedSpacesSelector,p.filterOutQuarantinedItems);t.paymentCardSelector=(e,r)=>{const o=(0,t.paymentCardsSelector)(e);return(0,d.findDataModelObject)(r,o)};t.paymentCardMappersSelector=e=>(0,u.getPaymentCardMappers)();const m=()=>n.paymentCardMatch;t.queryPaymentCardsSelector=(0,i.getQuerySelector)(t.paymentCardsSelector,m,t.paymentCardMappersSelector),t.viewedQueriedPaymentCardsSelector=(0,o.compose)((0,s.viewListResults)(a.listView),t.queryPaymentCardsSelector),t.getLivePaymentCardsSelector=(0,c.makeLiveSelectorGetter)(t.paymentCardsSelector,(()=>a.listView),m,t.paymentCardMappersSelector);t.viewedPaymentCardSelector=(e,r)=>{const o=(0,t.paymentCardSelector)(e,r);return(0,a.maybeDetailView)(o)};t.getViewedPaymentCardSelector=e=>{const r=(0,l.createSelector)(t.paymentCardsSelector,(t=>(0,d.findDataModelObject)(e,t)));return(0,l.createSelector)(r,a.maybeDetailView)}},8818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=t.maybeDetailView=t.detailView=void 0;const o=r(62433),n=r(82043),a=r(42316),i=(0,o.defaultTo)("");t.detailView=e=>({...(0,n.dataModelDetailView)(e),bank:i(e.Bank),cardNumber:i(e.CardNumber),cardNumberLastDigits:(0,a.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||a.defaultColor,expireMonth:i(e.ExpireMonth),expireYear:i(e.ExpireYear),issueNumber:i(e.IssueNumber),name:i(e.Name),ownerName:i(e.OwnerName),personalNote:i(e.CCNote),securityCode:i(e.SecurityCode),startMonth:i(e.StartMonth),startYear:i(e.StartYear),type:e.Type}),t.maybeDetailView=(0,n.maybeDataModelDetailView)(t.detailView);t.itemView=e=>({...(0,n.dataModelItemView)(e),cardNumber:i(e.CardNumber),cardNumberLastDigits:(0,a.getLastDigitsFromCardNumber)(e.CardNumber),color:e.Color||a.defaultColor,expireMonth:i(e.ExpireMonth),expireYear:i(e.ExpireYear),name:i(e.Name),ownerName:i(e.OwnerName),personalNote:i(e.CCNote),type:e.Type});t.listView=e=>e.map(t.itemView)},79980:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logDeleteVaultItem=t.logAddVaultItem=t.logEditVaultItem=void 0;const o=r(48062),n=r(45127),a=r(15318),i=r(49901),s=r(53966),c=r(10770),d=r(53626),l=(e,t,r,l,u,p,S)=>{const m=e.getState(),g=(0,d.collectionsSelector)(m),y=l.SpaceId===i.PERSONAL_SPACE_ID?o.Space.Personal:o.Space.Professional,A=void 0!==p?p.map((e=>(0,s.getHermesFieldFromProperty)(l,e))).filter((e=>e)):void 0,f=s.dataModelTypeToItemType[l.kwType],E=(0,c.getCollectionNamesContainingVaultItemId)(l.Id,g).length;if(t.logEvent(new o.UserUpdateVaultItemEvent({action:r,itemId:l.Id,itemType:f,fieldsEdited:A,space:y,collectionCount:E,multiSelectId:S??void 0,updateCredentialOrigin:u})),l.kwType===n.DataModelType.KWAuthentifiant){const e=l,n=new a.ParsedURL(e.Url).getRootDomain(),i="string"==typeof n?n:"";(0,o.hashDomain)(i).then((e=>{t.logEvent(new o.AnonymousUpdateCredentialEvent({action:r,domain:{id:e,type:o.DomainType.Web},fieldList:A,space:y}))}))}};t.logEditVaultItem=(e,t,r,n,a)=>{const i=(0,s.getUpdatedProperties)(r,n);l(e,t,o.Action.Edit,r,a,i)};t.logAddVaultItem=(e,t,r,n)=>l(e,t,o.Action.Add,r,n);t.logDeleteVaultItem=(e,t,r,n,a)=>l(e,t,o.Action.Delete,r,n,void 0,a)},53966:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdatedProperties=t.getHermesFieldFromProperty=t.dataModelTypeToItemType=void 0;const o=r(48062),n=r(45127);t.dataModelTypeToItemType={[n.DataModelType.KWAuthentifiant]:o.ItemType.Credential,[n.DataModelType.KWSecureNote]:o.ItemType.SecureNote,[n.DataModelType.KWIdentity]:o.ItemType.Identity,[n.DataModelType.KWEmail]:o.ItemType.Email,[n.DataModelType.KWPhone]:o.ItemType.Phone,[n.DataModelType.KWAddress]:o.ItemType.Address,[n.DataModelType.KWCompany]:o.ItemType.Company,[n.DataModelType.KWPersonalWebsite]:o.ItemType.Website,[n.DataModelType.KWPaymentMean_creditCard]:o.ItemType.CreditCard,[n.DataModelType.KWBankStatement]:o.ItemType.BankStatement,[n.DataModelType.KWIDCard]:o.ItemType.IdCard,[n.DataModelType.KWSocialSecurityStatement]:o.ItemType.SocialSecurity,[n.DataModelType.KWDriverLicence]:o.ItemType.DriverLicence,[n.DataModelType.KWPassport]:o.ItemType.Passport,[n.DataModelType.KWFiscalStatement]:o.ItemType.FiscalStatement,[n.DataModelType.KWSecret]:o.ItemType.Secret};const a={Title:o.Field.Title,FirstName:o.Field.FirstName,MiddleName:o.Field.MiddleName,LastName:o.Field.LastName,BirthDate:o.Field.BirthDate,BirthPlace:o.Field.BirthPlace,Pseudo:o.Field.Pseudo,SpaceId:o.Field.Space},i={Email:o.Field.Email,Type:o.Field.Type,EmailName:o.Field.EmailName,SpaceId:o.Field.Space},s={Number:o.Field.Number,PhoneName:o.Field.PhoneName,Type:o.Field.Type,SpaceId:o.Field.Space},c={StreetNumber:o.Field.StreetNumber,StreetName:o.Field.StreetName,StreetTitle:o.Field.StreetTitle,City:o.Field.City,State:o.Field.State,StateLevel2:o.Field.StateLevel2,StateNumber:o.Field.StateNumber,ZipCode:o.Field.ZipCode,Country:o.Field.Country,AddressName:o.Field.AddressName,Receiver:o.Field.Receiver,Building:o.Field.Building,Floor:o.Field.Floor,Door:o.Field.Door,LinkedPhone:o.Field.LinkedPhone,PersonalNote:o.Field.Note,SpaceId:o.Field.Space},d={Name:o.Field.Name,JobTitle:o.Field.JobTitle,SpaceId:o.Field.Space},l={Website:o.Field.Website,Name:o.Field.Name,SpaceId:o.Field.Space},u={Name:o.Field.Name,OwnerName:o.Field.OwnerName,CardNumber:o.Field.CardNumber,SecurityCode:o.Field.SecurityCode,ExpireMonth:o.Field.ExpireDate,ExpireYear:o.Field.ExpireDate,Color:o.Field.Color,SpaceId:o.Field.Space},p={BankAccountName:o.Field.Name,BankAccountOwner:o.Field.Owner,BankAccountBIC:o.Field.Bic,BankAccountIBAN:o.Field.Iban,BankAccountBank:o.Field.Bank,SpaceId:o.Field.Space},S={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,ExpireDate:o.Field.ExpireDate,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},m={SocialSecurityFullname:o.Field.SocialSecurityFullname,SocialSecurityNumber:o.Field.SocialSecurityNumber,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},g={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,ExpireDate:o.Field.ExpireDate,State:o.Field.State,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},y={Fullname:o.Field.Fullname,Number:o.Field.Number,DeliveryDate:o.Field.DeliveryDate,DeliveryPlace:o.Field.DeliveryPlace,ExpireDate:o.Field.ExpireDate,LinkedIdentity:o.Field.LinkedIdentity,Sex:o.Field.Sex,DateOfBirth:o.Field.DateOfBirth,SpaceId:o.Field.Space},A={FiscalNumber:o.Field.FiscalNumber,TeledeclarantNumber:o.Field.TeledeclarantNumber,SpaceId:o.Field.Space};t.getHermesFieldFromProperty=(e,t)=>{switch(e.kwType){case n.DataModelType.KWAuthentifiant:return((e,t)=>{switch(t){case"Email":return o.Field.Email;case"Login":return o.Field.Login;case"SecondaryLogin":return o.Field.SecondaryLogin;case"Password":return o.Field.Password;case"AutoLogin":return e.AutoLogin?o.Field.AutoLoginOn:o.Field.AutoLoginOff;case"AutoProtected":return e.AutoProtected?o.Field.MpProtectedOn:o.Field.MpProtectedOff;case"Url":return o.Field.Website;case"Category":return o.Field.Category;case"Note":return o.Field.Note;case"SubdomainOnly":return e.SubdomainOnly?o.Field.SubdomainOnlyOn:o.Field.SubdomainOnlyOff;case"Title":return o.Field.Title;case"SpaceId":return o.Field.Space}})(e,t);case n.DataModelType.KWSecureNote:return((e,t)=>{switch(t){case"Title":return o.Field.Title;case"Content":return o.Field.Content;case"Category":return o.Field.Category;case"SpaceId":return o.Field.Space;case"Secured":return e.Secured?o.Field.MpProtectedOn:o.Field.MpProtectedOff}})(e,t);case n.DataModelType.KWIdentity:return a[t];case n.DataModelType.KWEmail:return i[t];case n.DataModelType.KWPhone:return s[t];case n.DataModelType.KWAddress:return c[t];case n.DataModelType.KWCompany:return d[t];case n.DataModelType.KWPersonalWebsite:return l[t];case n.DataModelType.KWPaymentMean_creditCard:return u[t];case n.DataModelType.KWBankStatement:return p[t];case n.DataModelType.KWIDCard:return S[t];case n.DataModelType.KWSocialSecurityStatement:return m[t];case n.DataModelType.KWDriverLicence:return g[t];case n.DataModelType.KWPassport:return y[t];case n.DataModelType.KWFiscalStatement:return A[t]}};t.getUpdatedProperties=(e,t)=>Object.getOwnPropertyNames(e).filter((r=>{const o=void 0!==e[r],n=e[r]!==t[r];return o&&n}))},83539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lastUseMapper=void 0;t.lastUseMapper=e=>e.LastUse||-1},50886:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePersonalDataUsageMetadata=t.addPersonalDataItem=t.makePersonalDataItem=void 0;const o=r(45127),n=r(87496),a=r(73566),i=r(85225),s=r(23136),c=r(70252),d=r(53),l=r(95623),u=r(48313),p=r(9951),S=r(49766),m=r(29565),g=r(91494),y=r(39732),A=r(49723),f=r(72079),E=r(88542),h=r(48931),v=r(12362),T=r(86691),_=r(13675),I=r(56915),C=r(79980),P=r(49551),D=r(78163),O=r(96850),b={[o.DataModelType.KWAddress]:{create:A.makeNewAddress,update:A.makeUpdatedAddress},[o.DataModelType.KWAuthentifiant]:{beforeChange:E.beforeCredentialChange,create:E.makeNewCredential,update:E.makeUpdatedCredential,notifySharersOnUpdate:E.notifySharersCredentialUpdated,afterSave:E.afterCredentialSaved},[o.DataModelType.KWBankStatement]:{create:h.makeNewBankAccount,update:h.makeUpdatedBankAccount},[o.DataModelType.KWCompany]:{create:p.makeNewCompany,update:p.makeUpdatedCompany},[o.DataModelType.KWEmail]:{create:S.makeNewEmail,update:S.makeUpdatedEmail},[o.DataModelType.KWIdentity]:{create:g.makeNewIdentity,update:g.makeUpdatedIdentity},[o.DataModelType.KWPersonalWebsite]:{create:m.makeNewPersonalWebsite,update:m.makeUpdatedPersonalWebsite},[o.DataModelType.KWPhone]:{create:y.makeNewPhone,update:y.makeUpdatedPhone},[o.DataModelType.KWSecureNote]:{create:f.makeNewNote,update:f.makeUpdatedNote,notifySharersOnUpdate:f.notifySharersNoteUpdated},[o.DataModelType.KWSecret]:{create:O.makeNewSecret,update:O.makeUpdatedSecret,notifySharersOnUpdate:O.notifySharersSecretUpdated}};async function w(e,t,r,n){t.content||(l.default.error(`[Data] PersonalInfoItem: ${t.kwType}, has no content`),c.sendExceptionLog({message:`[makePersonalDataItem] No content found for PersonalDataItem of kwType: ${t.kwType}`,code:o.ExceptionCriticality.WARNING}),t={...t,content:{}});let a=null;if(t.content.id){const e=(0,s.getCurrentItems)(t.kwType,r);a=(0,P.findDataModelObject)(t.content.id,e)}const i=b[t.kwType];if(!i)return l.default.error(`[Data] Could not make PersonalDataItem of kwType: ${t.kwType}`),null;t=function(e){return{...e,content:(0,_.sanitizeInputPersonalData)(e.content)}}(t);const d=(0,I.platformInfoSelector)(e.getState());let u;if(i.beforeChange&&(t=i.beforeChange(t,r)),a){if(u=await i.update(d,t,a),i.notifySharersOnUpdate){if(!await i.notifySharersOnUpdate(e,a,u,n))return null}}else u=await i.create(d,t);return u}t.makePersonalDataItem=w,t.addPersonalDataItem=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:n},c){if(!e.isAuthenticated())return l.default.log("No session available to addPersonalDataItem"),{success:!1,itemId:""};const d=e.getPersonalData(),p=await w(e,c,d,n);if(!p)return{success:!1,itemId:""};if(!p.SpaceId){const t=await(0,s.getDefaultSpaceId)(e);p.SpaceId=t}const S=Boolean(c?.content.id);let m=null;const g=(0,v.getInstance)(),y=(0,T.getInstance)();if(S){const t=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[p.kwType],n=(0,P.findDataModelObject)(p.Id,d[t]);(0,C.logEditVaultItem)(e,r,p,n)}else(0,C.logAddVaultItem)(e,r,p);const A=(0,I.platformInfoSelector)(e.getState()),f=(0,a.isChangeHistoryCandidate)(p)&&S?(0,a.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:d,change:(0,i.makeUpdateChange)(p),userLogin:e.getUserLogin(),platformInfo:A}):null;if(e.dispatch((0,u.savePersonalDataItem)(p,p.kwType,f)),(0,o.isCredential)(p)){m=y.lockTopic("iconsUpdates");const t={credentialIds:[p.Id],type:"credentialUpdates"};await g.add("iconsUpdates",t),"************"===p?.Password&&(0,l.logWarn)({message:"Saving credentials using a placeholder",tag:"Credentials"}),(0,D.shouldSendCreateOrModifiedCredentialActivityLog)(e,p,c.origin)&&(c.content.id?.length?await(0,D.computeAndSendModifiedCredentialActivityLog)(n,{domainUrl:c.content.url}):await(0,D.computeAndSendCreatedCredentialActivityLog)(n,{domainUrl:c.content.url}))}return b[c.kwType]?.afterSave&&b[c.kwType].afterSave(e,p),m&&y.releaseTopic("iconsUpdates",m),t.getInstance().user.persistPersonalData(),{success:!0,itemId:p.Id}},t.updatePersonalDataUsageMetadata=function(e,t,r,a){const i=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[a],s=(0,n.cleanUrlForPersonalData)(r),p=e.getPersonalData()[i],S=Array.isArray(p)?(0,P.findDataModelObject)(t,p):null;if(!S)return void c.sendExceptionLog({message:`[PersonalData] - updatePersonalDataUsageMetadata: No ${i} found for provided ID to update usage metadata`,code:o.ExceptionCriticality.WARNING});l.default.log(`[Data] Updating ${i} ${t} usage metadata`);const m={...S,LastUse:(0,d.getUnixTimestamp)()};if((0,o.isCredential)(m)){const{NumberUse:e,TrustedUrlGroup:t}=m;m.NumberUse=("number"==typeof e?e:0)+1,m.TrustedUrlGroup=(0,n.getUpdatedTrustedUrlList)(t,s)}e.dispatch((0,u.savePersonalDataItem)(m,a))}},13675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeInputPersonalData=void 0;const o=r(62433),n=e=>"string"==typeof e?e.replace(new RegExp("([^\t\n\r -퟿-�𐀀-􏿿])","gu"),""):e;t.sanitizeInputPersonalData=e=>(0,o.mapObjIndexed)(n,e)},72678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalDataSelector=t.personalDataItemsOfTypeSelector=void 0;const o=r(45127);t.personalDataItemsOfTypeSelector=(e,t)=>e.userSession&&e.userSession.personalData&&t.reduce(((t,r)=>t.concat(e.userSession.personalData[o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]])),[]);t.personalDataSelector=e=>e.userSession&&e.userSession.personalData},49551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterDataModelObjects=t.findDataModelObject=void 0;const o=r(62433),n=r(84977);t.findDataModelObject=(e,t)=>{const r=(e||"").toUpperCase();return(t||[]).find((e=>!!e?.Id&&r===e.Id?.toUpperCase()))};t.filterDataModelObjects=(e,t,r)=>{const a=(0,o.unnest)((0,o.values)((0,o.omit)(r,(0,o.pick)(n.PERSONAL_DATA_COLLECTIONS_KEYS,e)))),i=(0,o.map)(o.toUpper,t),s=(0,o.propSatisfies)((e=>(0,o.contains)((e||"").toUpperCase(),i)),"Id");return(0,o.filter)(s,a)}},49723:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAddressSpecificProps=t.makeNewAddress=t.makeUpdatedAddress=void 0;const o=r(62433),n=r(45127),a=r(78163),i=r(10360),s=r(53),c=r(95623);function d(e,t,r){const a=(0,o.defaultTo)(""),s=r.content,c=(0,i.getLocaleFormat)(e,t,r);return{AddressFull:a(s.addressFull),AddressName:s.addressName||a(s.addressFull),Building:a(s.building),City:a(s.city),Country:n.Country[c].toLocaleLowerCase(),DigitCode:a(s.digitCode),Door:a(s.door),Floor:a(s.floor),LinkedPhone:a(s.linkedPhone),PersonalNote:a(s.personalNote),Receiver:a(s.receiver),Stairs:a(s.stairs),State:(0,i.getValidState)(c,s.state),StateLevel2:a(s.stateLevel2),StateNumber:a(s.stateNumber),StreetName:a(s.streetName),StreetNumber:a(s.streetNumber),StreetTitle:a(s.streetTitle),ZipCode:a(s.zipCode)}}t.makeUpdatedAddress=async function(e,t,r){return c.default.log(`[Data] Updating existing Address with id: ${r.Id}`),{...r,...(0,a.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,s.getUnixTimestamp)()}),...d(e,r,t)}},t.makeNewAddress=async function(e,t){return c.default.log("[Data] Adding new Address"),{...(0,a.makeNewPersonalDataItemBase)(e,t),...d(e,null,t)}},t.makeAddressSpecificProps=d},83295:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAddressMappers=void 0;const o=r(83539);t.getAddressMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},3179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addressMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("AddressFull"),(0,o.stringProp)("AddressName"),(0,o.stringProp)("City"),(0,o.stringProp)("Receiver"),(0,o.stringProp)("StreetNumber"),(0,o.stringProp)("ZipCode")],t.addressMatch=(0,n.match)(t.searchGetters)},99281:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryAddressesSelector=t.addressSelector=t.addressesSelector=void 0;const o=r(3179),n=r(83295),a=r(24589),i=r(49551),s=r(32034),c=r(40602),d=r(57989);t.addressesSelector=(0,s.createSelector)((e=>e.userSession.personalData.addresses),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems);t.addressSelector=(e,r)=>{const o=(0,t.addressesSelector)(e);return(0,i.findDataModelObject)(r,o)};t.queryAddressesSelector=(0,a.getQuerySelector)(t.addressesSelector,(()=>o.addressMatch),(e=>(0,n.getAddressMappers)()))},9951:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCompanySpecificProps=t.makeNewCompany=t.makeUpdatedCompany=void 0;const o=r(62433),n=r(78163),a=r(53),i=r(95623);function s(e){const t=(0,o.defaultTo)("");return{JobTitle:t(e.content.jobTitle),Name:t(e.content.name),PersonalNote:t(e.content.personalNote)}}t.makeUpdatedCompany=async function(e,t,r){return i.default.log(`[Data] Updating existing Company with id: ${r.Id}`),{...r,...(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,a.getUnixTimestamp)()}),...s(t)}},t.makeNewCompany=async function(e,t){return{...(0,n.makeNewPersonalDataItemBase)(e,t),...s(t)}},t.makeCompanySpecificProps=s},6628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCompanyMappers=void 0;const o=r(83539);t.getCompanyMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},76475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.companyMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("JobTitle"),(0,n.stringProp)("Name")],t.companyMatch=(0,o.match)(t.searchGetters)},80624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryCompaniesSelector=t.companySelector=t.companiesSelector=void 0;const o=r(76475),n=r(6628),a=r(24589),i=r(49551),s=r(32034),c=r(40602),d=r(57989);t.companiesSelector=(0,s.createSelector)((e=>e.userSession.personalData.companies),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems);t.companySelector=(e,r)=>{const o=(0,t.companiesSelector)(e);return(0,i.findDataModelObject)(r,o)};t.queryCompaniesSelector=(0,a.getQuerySelector)(t.companiesSelector,(()=>o.companyMatch),(e=>(0,n.getCompanyMappers)()))},49766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEmailSpecificProps=t.makeNewEmail=t.makeUpdatedEmail=void 0;const o=r(62433),n=r(78163),a=r(53),i=r(95623);function s(e){const t=(0,o.defaultTo)("");return{Email:t(e.content.email),EmailName:t(e.content.emailName),Type:e.content.type||"PERSO"}}t.makeUpdatedEmail=async function(e,t,r){return i.default.log(`[Data] Updating existing Email with id: ${r.Id}`),{...r,...(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,a.getUnixTimestamp)()}),...s(t)}},t.makeNewEmail=async function(e,t){return i.default.log("[Data] Adding new Email"),{...(0,n.makeNewPersonalDataItemBase)(e,t),...s(t)}},t.makeEmailSpecificProps=s},16384:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailMappers=void 0;const o=r(83539);t.getEmailMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},61808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emailMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("Email"),(0,n.stringProp)("EmailName")],t.emailMatch=(0,o.match)(t.searchGetters)},26147:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryEmailsSelector=t.emailSelector=t.emailsSelector=t.countAllEmailsSelector=void 0;const o=r(61808),n=r(16384),a=r(24589),i=r(49551),s=r(32034),c=r(57989),d=r(40602);t.countAllEmailsSelector=e=>e.userSession.personalData.emails.length,t.emailsSelector=(0,s.createSelector)((e=>e.userSession.personalData.emails),c.quarantinedSpacesSelector,d.filterOutQuarantinedItems);t.emailSelector=(e,r)=>{const o=(0,t.emailsSelector)(e);return(0,i.findDataModelObject)(r,o)};t.queryEmailsSelector=(0,a.getQuerySelector)(t.emailsSelector,(()=>o.emailMatch),(e=>(0,n.getEmailMappers)()))},91494:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeIdentitySpecificProps=t.makeNewIdentity=t.makeUpdatedIdentity=void 0;const o=r(62433),n=r(78163),a=r(95623),i=r(53);function s(e){const t=(0,o.defaultTo)("");return{FirstName:t(e.content.firstName),MiddleName:t(e.content.middleName),LastName:t(e.content.lastName),LastName2:t(e.content.lastName2),Pseudo:t(e.content.pseudo),BirthDate:t(e.content.birthDate),BirthPlace:t(e.content.birthPlace),Title:t(e.content.title)}}t.makeUpdatedIdentity=async function(e,t,r){return a.Debugger.log(`[Data] Updating existing Identity with id: ${r.Id}`),{...r,...(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,i.getUnixTimestamp)()}),...s(t)}},t.makeNewIdentity=async function(e,t){return a.Debugger.log("[Data] Adding new Identity"),{...(0,n.makeNewPersonalDataItemBase)(e,t),...s(t)}},t.makeIdentitySpecificProps=s},15044:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIdentityMappers=void 0;const o=r(83539);t.getIdentityMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},86052:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.identityMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("BirthDate"),(0,n.stringProp)("BirthPlace"),(0,n.stringProp)("FirstName"),(0,n.stringProp)("LastName"),(0,n.stringProp)("LastName2"),(0,n.stringProp)("MiddleName"),(0,n.stringProp)("Pseudo")],t.identityMatch=(0,o.match)(t.searchGetters)},28074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryIdentitiesSelector=t.identityMappersSelector=t.identitySelector=t.identitiesByIdSelector=t.identitiesSelector=void 0;const o=r(86052),n=r(24589),a=r(49551),i=r(32034),s=r(15044),c=r(40602),d=r(57989);t.identitiesSelector=(0,i.createSelector)((e=>e.userSession.personalData.identities),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems),t.identitiesByIdSelector=(0,i.createSelector)(t.identitiesSelector,(e=>e.reduce(((e,t)=>(e[t.Id]=t,e)),{})));t.identitySelector=(e,r)=>{const o=(0,t.identitiesSelector)(e);return(0,a.findDataModelObject)(r,o)};t.identityMappersSelector=e=>(0,s.getIdentityMappers)();t.queryIdentitiesSelector=(0,n.getQuerySelector)(t.identitiesSelector,(()=>o.identityMatch),t.identityMappersSelector)},29565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makePersonalWebsiteSpecificProps=t.makeNewPersonalWebsite=t.makeUpdatedPersonalWebsite=void 0;const o=r(62433),n=r(78163),a=r(53),i=r(95623);function s(e){const t=(0,o.defaultTo)("");return{Website:t(e.content.website),Name:t(e.content.name)}}t.makeUpdatedPersonalWebsite=async function(e,t,r){return i.default.log(`[Data] Updating existing PersonalWebsite with id: ${r.Id}`),{...r,...(0,n.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,a.getUnixTimestamp)()}),...s(t)}},t.makeNewPersonalWebsite=async function(e,t){return i.default.log("[Data] Adding new PersonalWebsite"),{...(0,n.makeNewPersonalDataItemBase)(e,t),...s(t)}},t.makePersonalWebsiteSpecificProps=s},93315:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonalWebsiteMappers=void 0;const o=r(83539);t.getPersonalWebsiteMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},86963:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.personalWebsiteMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("Name"),(0,n.stringProp)("Website")],t.personalWebsiteMatch=(0,o.match)(t.searchGetters)},81473:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPersonalWebsitesSelector=t.personalWebsiteMappersSelector=t.personalWebsiteSelector=t.personalWebsitesSelector=void 0;const o=r(32034),n=r(86963),a=r(24589),i=r(49551),s=r(93315),c=r(40602),d=r(57989);t.personalWebsitesSelector=(0,o.createSelector)((e=>e.userSession.personalData.personalWebsites),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems);t.personalWebsiteSelector=(e,r)=>{const o=(0,t.personalWebsitesSelector)(e);return(0,i.findDataModelObject)(r,o)};t.personalWebsiteMappersSelector=e=>(0,s.getPersonalWebsiteMappers)();t.queryPersonalWebsitesSelector=(0,a.getQuerySelector)(t.personalWebsitesSelector,(()=>n.personalWebsiteMatch),t.personalWebsiteMappersSelector)},39732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePhoneNumbers=t.makePhoneSpecificProps=t.makeNewPhone=t.makeUpdatedPhone=void 0;const o=r(62433),n=r(22630),a=r(45127),i=r(78163),s=r(10360),c=r(53),d=r(28445),l=r(95623);function u(e,t){const r=(0,o.defaultTo)(""),{Number:n,NumberInternational:i,NumberNational:s}=p(e,t);return{Number:n,NumberInternational:i,NumberNational:s,PersonalNote:r(t.content.personalNote),PhoneName:t.content.phoneName||s,Type:a.PhoneType[t.content.type]||a.PhoneType.PHONE_TYPE_ANY}}function p(e,t){const{localeFormat:r,number:o}=t.content;if(!o)return{Number:"",NumberInternational:"",NumberNational:""};const i=(0,s.isProposedLocaleLocalized)(r)&&a.Country[r]||a.Country[e.country]||a.Country.US;if(!(i?(0,n.isValidNumber)(o,i):(0,n.isValidNumber)(o)))return{Number:(0,d.removeNonDigitCharacters)(o),NumberInternational:o,NumberNational:o};const c=(0,n.parsePhoneNumber)(o,i),l=c.formatNational(),u=c.formatInternational();return{Number:(0,d.removeNonDigitCharacters)(o),NumberInternational:u,NumberNational:l}}t.makeUpdatedPhone=async function(e,t,r){return l.default.log(`[Data] Updating existing Phone with id: ${r.Id}`),{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,c.getUnixTimestamp)()}),...u(e,t)}},t.makeNewPhone=async function(e,t){return l.default.log("[Data] Adding new Phone"),{...(0,i.makeNewPersonalDataItemBase)(e,t),...u(e,t)}},t.makePhoneSpecificProps=u,t.parsePhoneNumbers=p},90076:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneMappers=void 0;const o=r(83539);t.getPhoneMappers=()=>({spaceId:e=>e.SpaceId,lastUse:o.lastUseMapper,id:e=>e.Id})},41648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.phoneMatch=t.searchGetters=void 0;const o=r(64455),n=r(82234);t.searchGetters=[(0,n.stringProp)("Number"),(0,n.stringProp)("PhoneName")],t.phoneMatch=(0,o.match)(t.searchGetters)},82439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryPhonesSelector=t.phoneSelector=t.phonesSelector=void 0;const o=r(41648),n=r(90076),a=r(24589),i=r(49551),s=r(32034),c=r(40602),d=r(57989);t.phonesSelector=(0,s.createSelector)((e=>e.userSession.personalData.phones),d.quarantinedSpacesSelector,c.filterOutQuarantinedItems);t.phoneSelector=(e,r)=>{const o=(0,t.phonesSelector)(e);return(0,i.findDataModelObject)(r,o)};t.queryPhonesSelector=(0,a.getQuerySelector)(t.phonesSelector,(()=>o.phoneMatch),(e=>(0,n.getPhoneMappers)()))},55220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLivePersonalInfo=void 0;const o=r(18948),n=r(3343),a=r(35893),i=r(33627);t.getLivePersonalInfo=e=>t=>{const r=(0,a.parseToken)(t),s=e(r);return(0,o.pipe)((0,n.map)(s),(0,n.distinctUntilChanged)(((e,t)=>(0,i.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount)))}},64455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.match=void 0;const o=r(97601);t.match=e=>(t,r)=>"string"==typeof t&&0!==t.length&&e.some((e=>{const n=e(r)||"";return(0,o.normalizeString)(n).includes(t)}))},82234:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stringProp=void 0;const o=r(62433);t.stringProp=e=>(0,o.prop)(e)},63566:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewListResults=void 0;t.viewListResults=e=>({items:t,matchingCount:r})=>({items:e(t),matchingCount:r})},96850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersSecretUpdated=t.makeSecretSpecificProps=t.makeNewSecret=t.makeUpdatedSecret=t.sharedFields=void 0;const o=r(62433),n=r(53),a=r(70252),i=r(78163);function s(e){return{Title:e.title||"Untitled secret",Content:e.content||"",Secured:e.secured||!1}}t.sharedFields=["Title","Content"],t.makeUpdatedSecret=async function(e,t,r){return{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()}),...s(t.content)}},t.makeNewSecret=async function(e,t){return{...(0,i.makeNewPersonalDataItemBase)(e,t),...s(t.content)}},t.makeSecretSpecificProps=s,t.notifySharersSecretUpdated=async function(e,r,n,s){if(!!(0,o.equals)((0,o.pick)(t.sharedFields,r),(0,o.pick)(t.sharedFields,n)))return!0;try{return await(0,i.notifySharersOnUpdate)(e,n,s),!0}catch(e){const t=new Error(`[Sharing] - notifySharersSecretUpdated: ${e}`);(0,a.sendExceptionLog)({error:t})}return!1}},64202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secretSelector=void 0;const o=r(49551),n=r(81904);t.secretSelector=(e,t)=>{const r=(0,n.secretsSelector)(e);return(0,o.findDataModelObject)(t,r)}},81904:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secretsSelector=void 0;const o=r(32034),n=r(40602),a=r(57989);t.secretsSelector=(0,o.createSelector)((e=>e.userSession.personalData.secrets),a.quarantinedSpacesSelector,n.filterOutQuarantinedItems)},80529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(24465),n=r(89642),a=r(81043),i=r(27416),s=r(32818),c=r(40409);t.config={commands:{addSecureFile:{handler:o.addSecureFileHandler},validateSecureFile:{handler:s.validateSecureFileHandler},commitSecureFile:{handler:a.commitSecureFileHandler},clearSecureFileState:{handler:c.clearSecureFileStateHandler}},queries:{getFileUploadProgress:{selector:n.secureFileUploadSelector}},liveQueries:{liveFileUploadProgress:{operator:i.getFileUploadProgress$}}}},24465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSecureFileHandler=t.createSecureFile=void 0;const o=r(45127),n=r(35088),a=r(90622),i=r(16593),s=r(69530),c=r(46445),d=r(65675),l=r(16038),u=r(55623),p=r(27993),S=r(20810),m=r(99994),g={success:!1,error:{code:o.SecureFileResultErrorCode.SERVER_ERROR}},y=Math.pow(1024,2)/2,A=1e3,f=e=>{switch(e){case o.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED:return o.SecureFileResultErrorCode.MAX_CONTENT_LENGTH_EXCEEDED;case o.SecureFileResultErrorCode.QUOTA_EXCEEDED:case o.SecureFileResultErrorCode.SOFT_QUOTA_EXCEEDED:case o.SecureFileResultErrorCode.HARD_QUOTA_EXCEEDED:return o.SecureFileResultErrorCode.QUOTA_EXCEEDED;default:return o.SecureFileResultErrorCode.SERVER_ERROR}},E=e=>"getAdditionalInfo"in e?{success:!1,error:{code:f(e.getAdditionalInfo().webServiceSubMessage)}}:g,h=(e,t,r,o,a,i)=>{const s=`{${(0,n.v4)()}}`,c=Math.floor(Date.now()/1e3);return{kwType:"KWSecureFileInfo",Id:s,LastBackupTime:0,CryptoKey:(0,l.bufferToBase64)(t),DownloadKey:"",Filename:o,LocalSize:e.byteLength,RemoteSize:r.byteLength,Type:a,CreationDatetime:c,UserModificationDatetime:c,Owner:i}};async function v(e,t,r,o){try{const{cryptoConfig:n}=(0,d.parsePayload)("$1$noderivation$aes256$cbchmac$16$"),a=(0,u.getRandomValues)(32),i=await(0,c.hashAndSplitKey)(a),S=(0,p.generateIV)(),m=await(0,s.encryptAES256)({key:i.aes,iv:S,clearData:e}),g={salt:null,iv:S,hash:await(0,s.signHashHmacSHA256)({key:i.hmac,data:(0,l.concatBuffers)(S,m)}),cipheredContent:m,cryptoConfig:n},y=(0,d.convertDashlaneSecureDataFlexibleToTransportableData)(g);return{success:!0,secureFileDataBuffer:y,secureFileInfo:h(e,a,y,t,r,o)}}catch(e){return{success:!1}}}t.createSecureFile=v,t.addSecureFileHandler=async function({wsService:e,storeService:t},r){const n=(0,i.userIdSelector)(t.getState());if(!(0,m.validateSecureFile)(r.fileName,r.fileType))return{success:!1,error:{code:o.SecureFileResultErrorCode.INVALID_FILE_TYPE}};let s;t.dispatch((0,S.secureFileStartUploadAction)(r.serializedContent.length)),t.dispatch((0,S.secureFileStartCipheringAction)());try{const e=JSON.parse(r.serializedContent);s=new Uint8Array(e).buffer}catch(e){return{success:!1,error:{code:o.SecureFileResultErrorCode.INTERNAL_ERROR}}}const{secureFileDataBuffer:c,secureFileInfo:d}=await v(s,r.fileName,r.fileType,n),l=setInterval((()=>{t.dispatch((0,S.secureFileUploadChunkAction)(y))}),A);let u=null;try{u=await e.secureFile.getUploadLink({contentLength:d.RemoteSize,secureFileInfoId:d.Id,login:n,uki:(0,a.ukiSelector)(t.getState())})}catch(e){return clearInterval(l),t.dispatch((0,S.secureFileUploadErrorAction)()),E(e)}return 200===u.code?(d.DownloadKey=u.content.key,await async function(e,t){try{const r=t.content.url,o=new FormData;for(const e of Object.keys(t.content.fields))o.append(e,t.content.fields[e]);return o.append("key",`${t.content.key}`),o.append("acl",`${t.content.acl}`),o.append("file",new Blob([e])),204===(await fetch(r,{method:"POST",body:o})).status}catch(e){return!1}}(c,u)?(clearInterval(l),t.dispatch((0,S.secureFileUploadDoneAction)()),t.dispatch((0,S.secureFileUploadClearAction)()),{success:!0,secureFileInfo:d}):(clearInterval(l),g)):(clearInterval(l),t.dispatch((0,S.secureFileUploadErrorAction)()),g)}},40409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearSecureFileStateHandler=void 0;const o=r(20810);t.clearSecureFileStateHandler=async function({storeService:e},t){return e.dispatch((0,o.secureFileClearAction)(t)),Promise.resolve()}},81043:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commitSecureFileHandler=void 0;const o=r(90622),n=r(16593),a=r(48313);t.commitSecureFileHandler=async function({wsService:e,sessionService:t,storeService:r},{secureFileInfo:i}){if(200!==(await e.secureFile.commit({key:i.DownloadKey,secureFileInfoId:i.Id,login:(0,n.userIdSelector)(r.getState()),uki:(0,o.ukiSelector)(r.getState())})).code)return{success:!1};try{return r.dispatch((0,a.savePersonalDataItem)(i,i.kwType)),t.getInstance().user.persistPersonalData(),{success:!0}}catch(e){return{success:!1}}}},32818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFileHandler=void 0;const o=r(45127),n=r(99994);t.validateSecureFileHandler=async function(e,t){return(0,n.validateSecureFile)(t.fileName,t.fileType)?{success:!0}:{success:!1,error:{code:o.SecureFileResultErrorCode.INVALID_FILE_TYPE}}}},27416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFileUploadProgress$=void 0;const o=r(18948),n=r(3343),a=r(89642);t.getFileUploadProgress$=()=>(0,o.pipe)((0,n.map)(a.secureFileUploadSelector),(0,n.distinctUntilChanged)())},89642:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFileUploadSelector=void 0;t.secureFileUploadSelector=e=>e.userSession.secureFileStorageState.upload},99994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateSecureFile=void 0;const o=r(98337);t.validateSecureFile=(e,t)=>{const r=e.split(".").pop().toLowerCase();return((e,t)=>"rar"===e&&!t)(r,t)||(e=>(0,o.getSecureDocumentsAllowedMimeTypes)().includes(e))(t)&&(e=>(0,o.getSecureDocumentsAllowedExtensions)().includes(`.${e}`))(r)}},80818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(81438),n=r(77749);t.config={commands:{},queries:{getNote:{selector:o.viewedNoteSelector},getNotes:{selector:o.viewedQueriedNotesSelector},getNotesPage:{selector:o.notesPageSelector},getNotesPaginationToken:{selector:o.notesPaginationTokenSelector}},liveQueries:{liveNote:{operator:n.getNote$},liveNotes:{operator:n.notes$}}}},71141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatedAt=t.createdAt=t.RequestError=void 0;const o=r(62433);class n extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name="RequestError",this.code=t}}t.RequestError=n;t.createdAt=e=>(0,o.isNil)(e.CreationDatetime)?(0,o.isNil)(e.CreationDate)?0:e.CreationDate:e.CreationDatetime;t.updatedAt=e=>(0,o.isNil)(e.UserModificationDatetime)?(0,o.isNil)(e.UpdateDate)?0:e.UpdateDate:e.UserModificationDatetime},72079:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notifySharersNoteUpdated=t.makeNoteSpecificProps=t.makeNewNote=t.makeUpdatedNote=t.sharedFields=void 0;const o=r(62433),n=r(53),a=r(70252),i=r(78163);function s(e,t){const r=t?t.CreationDate:(0,n.getUnixTimestamp)(),a=t?e.content!==t.Content?(0,n.getUnixTimestamp)():t.UpdateDate:r;return{Title:((0,o.isNil)(e.title)?t?.Title:e.title)||"Untitled note",Content:(0,o.isNil)(e.content)?(0,o.isNil)(t?.Content)?"":t?.Content:e.content,Category:(0,o.isNil)(e.category)?(0,o.isNil)(t?.Category)?"noCategory":t?.Category:e.category,Secured:(0,o.isNil)(e.secured)?!(0,o.isNil)(t?.Secured)&&t?.Secured:e.secured,Type:e.type||t?.Type||"GRAY",CreationDate:r,UpdateDate:a}}t.sharedFields=["Title","Content"],t.makeUpdatedNote=async function(e,t,r){return{...r,...(0,i.makeUpdatedPersonalDataItemBase)({platformInfo:e,existingItem:r,updatedItem:t,itemUpdateDate:(0,n.getUnixTimestamp)()}),...s(t.content,r)}},t.makeNewNote=async function(e,t){return{...(0,i.makeNewPersonalDataItemBase)(e,t),...s(t.content)}},t.makeNoteSpecificProps=s,t.notifySharersNoteUpdated=async function(e,r,n,s){if(!!(0,o.equals)((0,o.pick)(t.sharedFields,r),(0,o.pick)(t.sharedFields,n)))return!0;try{return await(0,i.notifySharersOnUpdate)(e,n,s),!0}catch(e){const t=new Error(`[Sharing] - notifySharersNoteUpdated: ${e}`);return(0,a.sendExceptionLog)({error:t}),!1}}},77749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notes$=t.notesCount$=t.getNote$=t.notesBatch$=void 0;const o=r(18948),n=r(3343),a=r(81438),i=r(35893),s=r(55220),c=r(33627);t.notesBatch$=e=>{const t=(0,i.parseToken)(e),r=(0,a.getViewedNotesBatchSelector)(t);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(c.sameBatch))};t.getNote$=e=>{const t=(0,a.getViewedNoteSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())};t.notesCount$=e=>{const t=(0,i.parseToken)(e);return(0,o.pipe)((0,n.map)((e=>(0,a.notesCountSelector)(e,t))),(0,n.distinctUntilChanged)())},t.notes$=(0,s.getLivePersonalInfo)(a.getLiveNotesSelector)},3113:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNoteMappers=void 0;const o=r(62433),n=r(71141),a=r(83539),i=e=>!!e.Attachments&&e.Attachments.length>0,s=(0,o.curry)(((e,t)=>!!e[t.Id]));t.getNoteMappers=e=>({createdAt:n.createdAt,hasAttachments:i,id:e=>e.Id,isLimited:s(e),lastUse:a.lastUseMapper,spaceId:e=>e.SpaceId,title:e=>e.Title,updatedAt:n.updatedAt})},93534:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNotesBatch=t.viewNotesBatch=t.getNotesFirstToken=t.getNotesSortToken=t.getNotesFilterToken=void 0;const o=r(62433),n=r(20553),a=r(80010);t.getNotesFilterToken=({filterCriteria:e})=>({filterCriteria:e||[]});t.getNotesSortToken=({sortCriteria:e})=>({uniqField:"id",sortCriteria:e||[]});t.getNotesFirstToken=(e,t,r,o)=>(0,n.generateFirstToken)(e,t,r.initialBatchSize||30,o);t.viewNotesBatch=e=>(0,a.listView)(e),t.getNotesBatch=(0,o.curry)(((e,t,r)=>(0,n.getBatch)(r,e,t)))},55498:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noteMatch=t.searchGetters=t.limitedSearchGetters=void 0;const o=r(64455),n=r(82234);t.limitedSearchGetters=[(0,n.stringProp)("Title")],t.searchGetters=[...t.limitedSearchGetters,(0,n.stringProp)("Content")];t.noteMatch=(e,r)=>{const n=r.Secured?t.limitedSearchGetters:t.searchGetters;return(0,o.match)(n)(e,r)}},81438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesCountSelector=t.viewedQueriedNotesSelector=t.queryNotesSelector=t.getViewedNoteSelector=t.getLiveNotesSelector=t.getViewedNotesBatchSelector=t.notesQuerySelector=t.fieldMappersSelector=t.notesPaginationTokenSelector=t.notesPageSelector=t.viewedNoteSelector=t.noteSelector=void 0;const o=r(62433),n=r(32034),a=r(93534),i=r(3113),s=r(23875),c=r(20553),d=r(35893),l=r(91210),u=r(49551),p=r(55498),S=r(24589),m=r(63566),g=r(97006),y=r(75705);t.noteSelector=(e,t)=>{const r=(0,y.notesSelector)(e);return(0,u.findDataModelObject)(t,r)};t.viewedNoteSelector=(e,r)=>{const o=(0,t.noteSelector)(e,r);if(o)return(0,s.viewNote)(o)};t.notesPageSelector=(e,r)=>{const o=(0,d.parseToken)(r),{sortToken:n,filterToken:i}=o,s={sortToken:n,filterToken:i},l=(0,t.fieldMappersSelector)(e),u=(0,t.notesQuerySelector)(e,s),p=(0,c.generateNextToken)(l,o,u),S=(0,c.generatePrevToken)(l,o,u),m=(0,c.getBatch)(l,o,u),g=(0,d.stringifyToken)(p),y=(0,d.stringifyToken)(S);return{batch:(0,a.viewNotesBatch)(m),nextToken:g,prevToken:y}};t.notesPaginationTokenSelector=(e,r)=>{const o=(0,a.getNotesSortToken)(r),n=(0,a.getNotesFilterToken)(r),i=(0,t.fieldMappersSelector)(e),s={sortToken:o,filterToken:n},c=(0,t.notesQuerySelector)(e,s),l=(0,a.getNotesFirstToken)(i,s,r,c);return(0,d.stringifyToken)(l)},t.fieldMappersSelector=(0,n.createSelector)(l.limitedSharingItemsSelector,i.getNoteMappers);const A=(0,d.createOptimizedSortTokenSelector)(((e,{sortToken:t})=>t),o.identity),f=(0,d.createOptimizedFilterTokenSelector)(((e,{filterToken:t})=>t),o.identity),E=()=>p.noteMatch;t.notesQuerySelector=(0,n.createSelector)(t.fieldMappersSelector,E,A,f,y.notesSelector,d.queryData);t.getViewedNotesBatchSelector=e=>{const{sortToken:r,filterToken:o}=e,i={sortToken:r,filterToken:o},s=(0,a.getNotesBatch)(e),c=(0,n.createSelector)((e=>(0,t.notesQuerySelector)(e,i)),t.fieldMappersSelector,s),l=(0,d.optimizeBatchSelector)(c);return(0,n.createSelector)(l,a.viewNotesBatch)},t.getLiveNotesSelector=(0,g.makeLiveSelectorGetter)(y.notesSelector,(()=>a.viewNotesBatch),E,t.fieldMappersSelector);t.getViewedNoteSelector=e=>{const t=(0,n.createSelector)(y.notesSelector,(t=>(0,u.findDataModelObject)(e,t)));return(0,n.createSelector)(t,s.viewNote)},t.queryNotesSelector=(0,S.getQuerySelector)(y.notesSelector,E,t.fieldMappersSelector);t.viewedQueriedNotesSelector=(e,r)=>{const o=(0,t.queryNotesSelector)(e,r);return(0,m.viewListResults)(a.viewNotesBatch)(o)},t.notesCountSelector=(0,n.createSelector)(t.fieldMappersSelector,E,f,y.notesSelector,((e,t,r,o)=>(0,d.filterData)(e,t,r,o).length))},75705:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notesSelector=void 0;const o=r(32034),n=r(40602),a=r(57989);t.notesSelector=(0,o.createSelector)((e=>e.userSession.personalData.notes),a.quarantinedSpacesSelector,n.filterOutQuarantinedItems)},23875:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewNote=void 0;const o=r(83881);t.viewNote=function(e){if(e)return(0,o.detailView)(e)}},83881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.detailView=void 0;const o=r(62433),n=r(82043),a=r(71141),i=(0,o.defaultTo)("");t.detailView=(0,o.curry)((e=>({...(0,n.dataModelDetailView)(e),color:e.Type,content:i(e.Content),createdAt:(0,a.createdAt)(e),secured:(0,o.defaultTo)(!1,e.Secured),title:i(e.Title),updatedAt:(0,a.updatedAt)(e)})))},80010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;const o=r(62433),n=r(82043),a=r(71141),i=(0,o.defaultTo)("");t.itemView=(0,o.curry)((e=>{const t=e.Secured?"*******":(e=>{if(e.length>30)return e.slice(0,27)+"…"})(i(e.Content));return{...(0,n.dataModelItemView)(e),abbrContent:t,color:e.Type,createdAt:(0,a.createdAt)(e),secured:e.Secured||!1,title:i(e.Title),updatedAt:(0,a.updatedAt)(e)}}));t.listView=e=>{const r=(0,t.itemView)();return e.map(r)}},60309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(43767),n=r(16593),a=r(64717),i=r(17250);t.config={commands:{updateProtectPasswordsSetting:{handler:i.updateProtectPasswordsSettingHandler},toggleDashlane:{handler:i.toggleDashlaneHandler},updateAutofillSettings:{handler:i.updateAutofillSettingsHandler},updateRichIconsSetting:{handler:i.updateRichIconsSettingHandler}},queries:{getAnonymousUserId:{selector:o.anonymousUserIdSelector},getIsUrlBanished:{selector:o.getIsUrlBanishedSelector},arePasswordsProtected:{selector:n.protectPasswordsSettingSelector},areRichIconsEnabled:{selector:n.richIconsSettingSelector}},liveQueries:{liveArePasswordsProtected:{operator:a.protectPasswordsSetting$},liveAreRichIconsEnabled:{operator:a.richIconsSetting$}}}},17250:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAutofillSettingsHandler=t.toggleDashlaneHandler=t.updateRichIconsSettingHandler=t.updateProtectPasswordsSettingHandler=void 0;const o=r(45127),n=r(48062),a=r(70252),i=r(23136),s=r(29954),c=r(86903),d=r(68857);t.updateProtectPasswordsSettingHandler=(e,t)=>{try{const r={ProtectPasswords:t};return(0,s.updatePersonalSettings)(e.storeService,e.sessionService,r),(0,c.sendUserSettingsLog)(e),Promise.resolve()}catch(e){const t=new Error(`updateProtectPasswordsSettingHandler: ${e}`);(0,a.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING})}};t.updateRichIconsSettingHandler=({sessionService:e,storeService:t},r)=>{const c=(0,i.getDebounceSync)(t,e);try{const o={RichIcons:r};return(0,s.updatePersonalSettings)(t,e,o),c({immediateCall:!0},n.Trigger.SettingsChange),Promise.resolve()}catch(e){const t=new Error(`updateRichIconsSettingHandler: ${e}`);(0,a.sendExceptionLog)({error:t,code:o.ExceptionCriticality.WARNING})}};t.toggleDashlaneHandler=({sessionService:e,storeService:t},r)=>{const o=(0,i.getDebounceSync)(t,e),a=t.getPersonalSettings(),c=(0,d.toggleDashlaneOnSiteToPersonalSettingsPartial)(a,r);(0,s.updatePersonalSettings)(t,e,c),o({immediateCall:!0},n.Trigger.SettingsChange)};t.updateAutofillSettingsHandler=({sessionService:e,storeService:t},r)=>{const o=(0,i.getDebounceSync)(t,e);(0,s.updatePersonalSettings)(t,e,{AutofillSettings:r.AutofillSettings}),o({immediateCall:!0},n.Trigger.SettingsChange)}},64717:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.richIconsSetting$=t.protectPasswordsSetting$=void 0;const o=r(18948),n=r(3343),a=r(16593);t.protectPasswordsSetting$=()=>(0,o.pipe)((0,n.map)(a.protectPasswordsSettingSelector),(0,n.distinctUntilChanged)());t.richIconsSetting$=()=>(0,o.pipe)((0,n.map)(a.richIconsSettingSelector),(0,n.distinctUntilChanged)())},68857:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleDashlaneOnSiteToPersonalSettingsPartial=void 0;const o=r(62433),n=r(15318);t.toggleDashlaneOnSiteToPersonalSettingsPartial=function(e,t){const r=new n.ParsedURL(t.url).getRootDomain();let a=e.AutofillSettings;return a={...a,disabledDomains:t.autofill?(0,o.without)([r],e.AutofillSettings.disabledDomains):(0,o.uniq)(e.AutofillSettings.disabledDomains.concat(r))},{AutofillSettings:a}}},29954:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pickUpdatedPersonalSettings=t.isSaveCredentialDisabledOnDomain=t.signalSaveCredentialDisabled=t.updatePersonalSettings=void 0;const o=r(15318),n=r(95623),a=r(62433),i=r(27517);t.updatePersonalSettings=function(e,r,o){if(!e.isAuthenticated())return void n.default.log("No session available to updatePersonalSettings");const a=(0,t.pickUpdatedPersonalSettings)(e.getPersonalSettings(),o);e.dispatch((0,i.editPersonalSettings)(a)),r.getInstance().user.persistPersonalSettings()},t.signalSaveCredentialDisabled=function(e,t,r){if(!e.isAuthenticated())return void n.default.log("No session available, in theory this should not be called");const o=Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[];o.indexOf(r.fullDomain)>0||(e.dispatch((0,i.editPersonalSettings)({BanishedUrlsList:[...o,r.fullDomain]})),t.getInstance().user.persistPersonalSettings())},t.isSaveCredentialDisabledOnDomain=function(e,t){return e.isAuthenticated()?(Array.isArray(e.getPersonalSettings().BanishedUrlsList)?e.getPersonalSettings().BanishedUrlsList:[]).map((e=>new o.ParsedURL(e))).some((e=>e.getHostname()===t.fullDomain)):(n.default.log("No session available, save credential is enabled by default"),!1)};t.pickUpdatedPersonalSettings=(e,t)=>{const r=(0,a.pick)(Object.keys(t))(e),o=(0,a.unapply)(a.identity);return(0,a.mergeAll)((0,a.difference)(o(t),o(r)))}},43767:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getIsUrlBanishedSelector=t.banishedUrlsListSelector=t.anonymousUserIdSelector=void 0;const o=r(15318),n=r(16593);t.anonymousUserIdSelector=e=>e.userSession.personalSettings.AnonymousUserId;t.banishedUrlsListSelector=e=>(0,n.personalSettingsSelector)(e).BanishedUrlsList??[];t.getIsUrlBanishedSelector=(e,r)=>{const n=new o.ParsedURL(r).getHostname();return(0,t.banishedUrlsListSelector)(e).map((e=>new o.ParsedURL(e).getHostname())).some((e=>e===n))}},68979:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TeamDomainsMatchResult=void 0,function(e){e[e.SomeFieldsMatch=0]="SomeFieldsMatch",e[e.NoFieldMatch=1]="NoFieldMatch"}(t.TeamDomainsMatchResult||(t.TeamDomainsMatchResult={}))},11700:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isItemToForceCategorize=t.isItemForceCategorizable=t.pickBestTeamSpace=t.pickBestTeamSpaceForForcedCategorization=t.pickBestTeamSpaceForForcedCategorizationForSharedItem=t.ForceCategorizableKWTypes=t.isTeamSpaceAfterGracePeriod=t.isTeamSpaceQuarantined=t.someFieldsMatchTeamDomains=void 0;const o=r(62433),n=r(45127),a=r(68979),i=r(87496),s=r(43145),c=r(6205);t.someFieldsMatchTeamDomains=(e,t)=>(t||[]).some((t=>{if("string"!=typeof t)return!1;const r=t.toLowerCase();return(e||[]).some((e=>"string"==typeof e&&e.toLowerCase().includes(r)))}));const d=e=>[e.Login,e.SecondaryLogin,e.Email,(0,i.getBestUrl)(e),...(0,c.getUserAddedLinkedWebsiteDomains)(e)],l=(e,t)=>{const r=[e.Domain],o=(0,s.findAssociatedCredential)(e,t);return[...r,...o?d(o):[]]},u={[n.DataModelType.KWAuthentifiant]:d,[n.DataModelType.KWGeneratedPassword]:l,[n.DataModelType.KWEmail]:e=>[e.Email]};function p(e){const t=u[e.kwType];return t?t(e):[]}t.isTeamSpaceQuarantined=e=>"revoked"===e.status;t.isTeamSpaceAfterGracePeriod=e=>(0,t.isTeamSpaceQuarantined)(e)&&Boolean(e.shouldDelete),t.ForceCategorizableKWTypes=[n.DataModelType.KWAuthentifiant,n.DataModelType.KWEmail,n.DataModelType.KWGeneratedPassword];t.pickBestTeamSpaceForForcedCategorizationForSharedItem=(e,r)=>{const o=(e=>[e.login,e.secondaryLogin,e.email,e.url,...e.linkedDomains??[]])(r),n=r.spaceId;return(0,t.pickBestTeamSpace)(e,o,n)};t.pickBestTeamSpaceForForcedCategorization=(e,r,o)=>{const a=r.SpaceId,i=(0,n.isGeneratedPassword)(r)?l(r,o):p(r);return(0,t.pickBestTeamSpace)(e,i,a)};t.pickBestTeamSpace=(e,r,n)=>{const i=e.reduce(((e,o)=>{const n=(0,t.someFieldsMatchTeamDomains)(r,o.info.teamDomains);return{...e,[o.teamId]:n}}),{}),s=e.filter((e=>i[e.teamId]||(0,t.isTeamSpaceQuarantined)(e)&&e.teamId===n)),[c,d]=(0,o.partition)(t.isTeamSpaceQuarantined,s),[l,u]=(0,o.partition)(t.isTeamSpaceAfterGracePeriod,c),[p,S]=(0,o.partition)((e=>t=>e===t.teamId)(n),d),m=[...l,...u,...p,...S];if(0===m.length)return null;const g=m[0],y=g.teamId===n&&!(0,t.isTeamSpaceQuarantined)(g),A=e.find((e=>e.teamId===n));return"accepted"===A?.status||y?null:{teamSpace:g,domainsMatchResult:i[g.teamId]?a.TeamDomainsMatchResult.SomeFieldsMatch:a.TeamDomainsMatchResult.NoFieldMatch}},t.isItemForceCategorizable=function(e){return e.kwType in u};t.isItemToForceCategorize=(e,r)=>{if(!r?.info)return!1;const{forcedDomainsEnabled:o,teamDomains:n}=r.info;if(!o)return!1;const a=p(e);return(0,t.someFieldsMatchTeamDomains)(a,n)}},57989:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.quarantinedSpacesSelector=t.forceCategorizableItemsSelector=t.spacesWithForcedCategorizationEnabledSelector=void 0;const o=r(32034),n=r(7944),a=r(11700),i=r(95458),s=r(72678);t.spacesWithForcedCategorizationEnabledSelector=e=>(e.userSession?.spaceData?.spaces||[]).filter((e=>e?.details?.info&&Array.isArray(e.details.info.teamDomains)&&e.details.info.teamDomains.length>0&&Boolean(e.details.info.forcedDomainsEnabled)));t.forceCategorizableItemsSelector=e=>(0,s.personalDataItemsOfTypeSelector)(e,a.ForceCategorizableKWTypes),t.quarantinedSpacesSelector=(0,o.createSelector)([n.spacesSelector],(e=>e.filter(i.isQuarantined)))},92307:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSmartCategorizedSpace=void 0;const o=r(52578);t.getSmartCategorizedSpace=e=>t=>{const r=(e=>e.filter((e=>"accepted"===e.details?.status&&e.details?.info?.forcedDomainsEnabled)))(e),n=r?.[0]?.details?.info?.teamDomains??[];return(0,o.isCredentialSmartCategorized)(t,n)?r[0]:null}},76226:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTeamSpaceContentControlRules=void 0;const o=r(45127),n=r(70252),a=r(45291),i=r(24525),s=r(45962),c=r(90622),d=r(57989);async function l(e,t,r){const{updates:o,deletions:n,changeHistories:i}=r,s=o.length>0,c=function({deletions:e}){return Object.keys(e).reduce(((t,r)=>t+e[r].length),0)}(r)>0;(s||c)&&(t.dispatch((0,a.teamSpaceContentControlApplied)(o,n,i)),await e.getInstance().user.persistPersonalData())}t.applyTeamSpaceContentControlRules=async function(e,t,r,a,u){try{const n=r.getState(),p=(0,d.spacesWithForcedCategorizationEnabledSelector)(n);if(0===p.length)return;const S=(0,s.controlTeamSpacesContent)({spaces:p,...(0,i.teamSpaceContentControlStateSelector)(n)}),m=S.deletions.KWAuthentifiant||[],g=S.updates.filter(o.isCredential).map((e=>e.Id)),y=S.hiddenItemIds,A=[...m,...g,...y];await l(t,r,S);if(function(e,t,r){const o=e.getUserLogin(),n=(0,c.ukiSelector)(e.getState());r.forEach((e=>{t.teamPlans.spaceDeleted({login:o,uki:n,teamId:Number(e.teamId)})}))}(r,a,p.filter((e=>e.details.shouldDelete))),function(e,t){const{deletions:r,hiddenItemIds:o,updates:n}=t,a={deletedItemIds:Object.keys(r).reduce(((e,t)=>[...e,...r[t]]),[]),hiddenItemIds:o,updatedItemIds:n.map((e=>e.Id))};e.teamSpaceContentControlDone(a)}(e,S),A.length>0){const{commands:{recalculatePasswordHealth:e}}=u.createClients().passwordHealth;e()}}catch(e){const t=new Error(`[Spaces] - runTeamSpaceContentControlJob: ${e}`);(0,n.sendExceptionLog)({error:t})}}},45962:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.controlTeamSpacesContent=void 0;const o=r(45127),n=r(17825),a=r(49901),i=r(68979),s=r(11700),c=r(73566),d=r(85225);function l(e,t){return{...e,SpaceId:t}}function u(e,t,r,s){const{domainsMatchResult:u}=t;switch(u){case i.TeamDomainsMatchResult.SomeFieldsMatch:return function(e,t,r){const{deletions:n,changeHistories:a}=t,{deviceName:i,login:s,personalData:l,platformInfo:u}=e,{kwType:p}=r,S=(0,o.isCredential)(r)?(0,c.getUpdatedItemChangeHistory)({change:(0,d.makeRemovalChange)(r),deviceName:i,personalData:l,userLogin:s,platformInfo:u}):null;return{...t,deletions:{...n,[p]:n[p].concat(r.Id)},changeHistories:S?a.concat(S):a}}(e,s,r);case i.TeamDomainsMatchResult.NoFieldMatch:return function(e,t,r){const{updates:n,changeHistories:i}=t,{deviceName:s,login:u,personalData:p,platformInfo:S}=e,m=l(r,a.PERSONAL_SPACE_ID),g=(0,o.isCredential)(m)?(0,c.getUpdatedItemChangeHistory)({change:(0,d.makeUpdateChange)(m),deviceName:s,personalData:p,userLogin:u,platformInfo:S}):null;return{...t,updates:n.concat(m),changeHistories:g?i.concat(g):i}}(e,s,r);default:return(0,n.assertUnreachable)(u)}}const p=e=>e.info.removeForcedContentEnabled&&e.shouldDelete;function S(e,t,r){const n=e.spaces.map((e=>e.details)),a=(0,s.pickBestTeamSpaceForForcedCategorization)(n,r,e.credentials);if(!a)return t;const{teamSpace:S}=a,{status:m}=S;switch(m){case"accepted":return function(e,t,r,n){const{updates:a,changeHistories:i}=t,{teamId:s}=r,{deviceName:u,login:p,personalData:S,platformInfo:m}=e,g=l(n,s),y=(0,o.isCredential)(g)?(0,c.getUpdatedItemChangeHistory)({change:(0,d.makeUpdateChange)(g),deviceName:u,personalData:S,userLogin:p,platformInfo:m}):null;return{...t,updates:a.concat(g),changeHistories:y?i.concat(y):i}}(e,t,S,r);case"revoked":return function(e,t,r,o){const{teamSpace:n,domainsMatchResult:a}=t,{hiddenItemIds:s}=o;return{...p(n)?u(e,t,r,o):o,hiddenItemIds:a===i.TeamDomainsMatchResult.SomeFieldsMatch?[...s,r.Id]:s}}(e,a,r,t);default:return t}}t.controlTeamSpacesContent=function(e){const t={deletions:{KWAuthentifiant:[],KWEmail:[],KWGeneratedPassword:[]},updates:[],changeHistories:[],hiddenItemIds:[]};return 0===e.spaces.length?t:e.items.reduce(((t,r)=>S(e,t,r)),t)}},24525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamSpaceContentControlStateSelector=void 0;const o=r(56915),n=r(16593),a=r(73299),i=r(72678),s=r(92598),c=r(26147),d=r(74380),l=r(83659),u=r(57989),p=e=>({KWAuthentifiant:(0,d.countAllCredentialsSelector)(e),KWEmail:(0,c.countAllEmailsSelector)(e),KWGeneratedPassword:(0,s.countAllGeneratedPasswordsSelector)(e)});t.teamSpaceContentControlStateSelector=e=>({credentials:(0,l.unsafeAllCredentialsSelector)(e),itemCountByType:p(e),items:(0,u.forceCategorizableItemsSelector)(e),personalData:(0,i.personalDataSelector)(e),platformInfo:(0,o.platformInfoSelector)(e),login:(0,n.userLoginSelector)(e),deviceName:(0,a.deviceNameSelector)(e)})},67631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(76226);t.setupSubscriptions=function(e,t){const{sessionService:r,storeService:n,wsService:a,applicationModulesAccess:i}=t;e._sessionOpened.on((()=>{(0,o.applyTeamSpaceContentControlRules)(e,r,n,a,i)}))}},45665:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(7944);t.config={commands:{},queries:{getSpace:{selector:o.viewedSpaceSelector},getSpaces:{selector:o.viewedSpacesSelector}},liveQueries:{}}},77163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.associateTeamSpaceId=void 0;const o=r(11700),n=e=>e.filter((e=>e.info.forcedDomainsEnabled&&e.info.teamDomains.length&&!(0,o.isTeamSpaceQuarantined)(e)));t.associateTeamSpaceId=function(e,t,r){if(!(0,o.isItemForceCategorizable)(e)||!t||0===t.length)return e;const a=n(t);if(!a.length)return e;const i=(0,o.pickBestTeamSpaceForForcedCategorization)(a,e,r);return i?{...e,SpaceId:i.teamSpace.teamId}:e}},49901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_SPACE_ID=void 0,t.PERSONAL_SPACE_ID=""},69105:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultPersonalSpace=t.isSpaceItem=void 0;const o=r(45127),n=r(49901);t.isSpaceItem=e=>"SpaceId"in e&&"string"==typeof e.SpaceId;t.getDefaultPersonalSpace=()=>({associatedEmail:null,billingAdmins:[],color:"",companyName:null,info:{name:"",forcedDomainsEnabled:!1,teamDomains:[]},invitationDate:null,isBillingAdmin:!1,isSSOUser:!1,isTeamAdmin:!1,joinDate:null,letter:"",membersNumber:null,planType:null,revokeDate:null,status:o.SpaceStatus.Accepted,teamAdmins:[],teamId:n.PERSONAL_SPACE_ID,teamName:null,tier:o.SpaceTiers.Free,shouldDelete:!1})},95458:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isQuarantined=t.isPremiumStatusSpaceQuarantined=void 0;t.isPremiumStatusSpaceQuarantined=e=>!!e?.status&&"accepted"!==e.status.toLowerCase()&&!!e.info&&Array.isArray(e.info.teamDomains)&&e.info.teamDomains.length>0&&Boolean(e.info.removeForcedContentEnabled);t.isQuarantined=e=>e&&(0,t.isPremiumStatusSpaceQuarantined)(e.details)},7944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedSpaceSelector=t.viewedSpacesSelector=t.activeSpacesDetailsSelector=t.activeSpacesSelector=t.spacesSelector=void 0;const o=r(69105),n=r(664),a=[];t.spacesSelector=e=>e.userSession?.spaceData?.spaces??a;t.activeSpacesSelector=e=>((0,t.spacesSelector)(e)||[]).filter((e=>e.details&&"accepted"===e.details.status));t.activeSpacesDetailsSelector=e=>(0,t.activeSpacesSelector)(e).map((e=>e.details));t.viewedSpacesSelector=e=>{const r=e.userSession.localSettings.nodePremiumStatus.b2bStatus;return!!r&&"in_team"===r.statusCode&&!r.currentTeam?.teamInfo.personalSpaceEnabled&&(0,t.activeSpacesDetailsSelector)(e).length?(0,n.listView)([...(0,t.activeSpacesDetailsSelector)(e)]):(0,n.listView)([...(0,t.activeSpacesDetailsSelector)(e),(0,o.getDefaultPersonalSpace)()])};t.viewedSpaceSelector=(e,r)=>(0,t.viewedSpacesSelector)(e).find((e=>e.spaceId===r))},664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.itemView=void 0;t.itemView=({color:e,letter:t,info:r,teamId:o,isSSOUser:n})=>({spaceId:o,displayName:r.name??"",color:e,letter:t,settings:{enableForcedCategorization:r.forcedDomainsEnabled,spaceForcedDomains:r.teamDomains},isSSOUser:n});t.listView=e=>e.map(t.itemView)},16458:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultConfig=void 0;const o=r(33934);t.vaultConfig={commands:{deleteVaultModuleItem:{handler:o.deleteVaultModuleItemHandler},deleteVaultModuleItemsBulk:{handler:o.deleteVaultModuleItemsBulkHandler},disableVaultItemProtection:{handler:o.disableVaultProtectionHandler}},queries:{},liveQueries:{}}},33934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableVaultProtectionHandler=t.deleteVaultModuleItemsBulkHandler=t.deleteVaultModuleItemHandler=void 0;const o=r(45127),n=r(48062),a=r(73566),i=r(19736),s=r(76496),c=r(45157),d=r(79980),l=r(17250),u=r(95623),p=r(70252),S=r(18344),m=r(16593),g=r(45291);function y(e){return function(e){const t=new Error(`[DataManagement] - Vault API: ${e}`);(0,p.sendExceptionLog)({error:t}),u.default.error(t)}(e),{success:!1,error:{reason:e}}}const A=(e,t)=>{let r=null;return(0,a.isChangeHistoryCandidate)(t)&&(r=(0,c.getRemoveChangeHistory)(e,t)),r};t.deleteVaultModuleItemHandler=async({storeService:e,eventLoggerService:t},{id:r,kwType:a})=>{const i=(0,s.findPersonalDataItemToDelete)(e,r,a);if(!i)return y(o.deleteVaultModuleItemFailureReason.NOT_FOUND);const c=A(e,i);return(0,d.logDeleteVaultItem)(e,t,i,n.UpdateCredentialOrigin.Manual,null),e.dispatch((0,g.deleteVaultModuleItem)({kwType:i.kwType,id:r,changeHistory:c})),{success:!0}};t.deleteVaultModuleItemsBulkHandler=async({storeService:e,eventLoggerService:t},{kwType:r,items:a})=>{const i={kwType:r,items:[]},c=[],l=[];for(const{id:t}of a){let n=null;const a=(0,s.findPersonalDataItemToDelete)(e,t,r);if(!a){n={id:t,reason:o.deleteVaultModuleItemFailureReason.NOT_FOUND},reportError(n),c.push(n);continue}const d=A(e,a);i.items.push({id:t,changeHistory:d}),l.push(a)}for(const r of l)(0,d.logDeleteVaultItem)(e,t,r,n.UpdateCredentialOrigin.Manual,null);return i.items.length&&e.dispatch((0,g.deleteVaultModuleItemsBulk)(i)),a.length!==i.items.length||c.length?{success:!1,error:{errors:c}}:{success:!0}};t.disableVaultProtectionHandler=async(e,t)=>{const r=e.storeService.getState();if((0,i.credentialSelector)(r,t)){if((0,m.protectPasswordsSettingSelector)(r))return void(0,l.updateProtectPasswordsSettingHandler)(e,!1);(0,S.disableCredentialProtection)(e,t)}}},70660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(76235);t.bootstrap=e=>{e.register(o.config)}},78163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computeAndSendCollectionImportActivityLog=t.computeAndSendCSVImportActivityLog=t.computeAndSendDeletedCredentialActivityLog=t.computeAndSendModifiedCredentialActivityLog=t.computeAndSendCreatedCredentialActivityLog=t.shouldSendCreateOrModifiedCredentialActivityLog=t.notifySharersOnUpdate=t.makeNewPersonalDataItemBase=t.makeUpdatedPersonalDataItemBase=void 0;const o=r(18948),n=r(35088),a=r(45127),i=r(66638),s=r(97374),c=r(15318),d=r(88744),l=r(10294),u=r(98892),p=r(58107),S=r(36513),m=r(56915),g=r(53),y=r(78320),A=r(10360),f=r(92310),E=r(11700),h=r(16593),v=r(67312);function T(e){const t="MANUAL"===e.updatedItem.origin?{UserModificationDatetime:e.itemUpdateDate}:{};return{LocaleFormat:(0,A.getLocaleFormat)(e.platformInfo,e.existingItem,e.updatedItem),SpaceId:void 0!==e.updatedItem.content.spaceId?e.updatedItem.content.spaceId:e.existingItem?.SpaceId??"",Attachments:e.updatedItem.content.attachments,...t}}function _(e){return async(t,r)=>{const o={domain_url:new c.ParsedURL(r.domainUrl).getRootDomain()??""},a={import_count:r.importCount??0};let i;i=e===s.ActivityLogType.UserImportedCredentials?a:e===s.ActivityLogType.UserImportedCollection?{collection_name:r.collectionName,credential_count:r.itemCount}:o;const d={category:s.ActivityLogCategory.VaultPasswords,log_type:e,properties:i,is_sensitive:e!==s.ActivityLogType.UserImportedCredentials||void 0,date_time:(new Date).getTime(),schema_version:"1.0.0",uuid:(0,n.v4)().toUpperCase()};await t.createClients().activityLogs.commands.storeActivityLogs({activityLogs:[d]})}}t.makeUpdatedPersonalDataItemBase=T,t.makeNewPersonalDataItemBase=function(e,t,r=(0,g.getUnixTimestamp)()){return{kwType:t.kwType,Id:(0,y.generateItemUuid)(),CreationDatetime:r,LastBackupTime:0,LastUse:r,...T({platformInfo:e,updatedItem:t,itemUpdateDate:r})}},t.notifySharersOnUpdate=async function(e,t,r){const{userFeatureFlip:n}=r.createClients().featureFlips.queries,a=await(0,o.firstValueFrom)(n({featureFlip:d.SharingSyncFeatureFlips.SharingSyncGrapheneMigrationDev}));if((0,i.isSuccess)(a)&&(0,i.getSuccess)(a)){const o=await(0,v.convertItemToDashlaneXml)(e,t);return void(o.success&&r.createClients().sharingItems.commands.updateSharedItemContent({itemContent:o.xml,itemId:t.Id}))}const s=(0,l.makeItemService)(),c=(0,u.makeItemWS)(),g=e.getSharingData(),y=e.getUserLogin(),A=(0,m.ukiSelector)(e.getState()),f=(g.items||[]).find((e=>e.itemId===t.Id));if(!f)return;const E=(g.itemGroups||[]).find((e=>(e.items||[]).map((e=>e.itemId)).includes(t.Id)));if(!E)throw new Error("ItemGroup containing item not found in sharingData");const{timestamp:h}=f,{privateKey:T}=e.getUserSession().keyPair,_=await(0,p.getItemGroupKey)(E,g.userGroups,T,y,g.collections);if(!_)throw new Error("Could not decipher itemGroupKey for itemGroup");const I=E.items.find((e=>e.itemId===t.Id));if(!I)throw new Error("Could not find itemKey for item in itemGroup");const C=await(0,S.makeSymmetricEncryption)().decryptAES256(_,I.itemKey),P=await s.makeUpdateItemEvent(h,C,{item:t}),D=await c.updateItem(y,A,P);if(!D.items?.length)throw new Error("Shared item update failed");return D},t.shouldSendCreateOrModifiedCredentialActivityLog=function(e,t,r){const o=(0,f.currentTeamIdSelector)(e.getState()),n=(0,h.activeSpacesSelector)(e.getState())[0],i=(0,E.isItemToForceCategorize)(t,n);return r!==a.SaveOrigin.IMPORT&&(t.SpaceId===o||i)},t.computeAndSendCreatedCredentialActivityLog=_(s.ActivityLogType.UserCreatedCredential),t.computeAndSendModifiedCredentialActivityLog=_(s.ActivityLogType.UserModifiedCredential),t.computeAndSendDeletedCredentialActivityLog=_(s.ActivityLogType.UserDeletedCredential),t.computeAndSendCSVImportActivityLog=_(s.ActivityLogType.UserImportedCredentials),t.computeAndSendCollectionImportActivityLog=_(s.ActivityLogType.UserImportedCollection)},99293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;const o=r(38390);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return o.setupSubscriptions}});var n=r(70660);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return n.bootstrap}})},97006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLiveSelectorGetter=void 0;const o=r(32034),n=r(63566),a=r(24589);t.makeLiveSelectorGetter=(e,t,r,i)=>s=>(0,o.createSelector)(e,i,r,t,((e,t,r,o)=>(0,n.viewListResults)(o)((0,a.applyQuery)(r,t,s,e))))},40602:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutQuarantinedItems=t.itemIsNotQuarantined=void 0;t.itemIsNotQuarantined=(e,t)=>{const r=((e,t)=>{const r=t.find((t=>t.details&&t.teamId===e.SpaceId));return r?r.details:null})(t,e);return!r||!((e,t)=>e.SpaceId===t.teamId)(t,r)};t.filterOutQuarantinedItems=(e,r)=>{if(0===r.length)return e;return e.filter((e=>(0,t.itemIsNotQuarantined)(r,e)))}},24589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyQuery=t.getQuerySelector=void 0;const o=r(35893),n=r(32541);t.getQuerySelector=(e,r,o)=>(n,a)=>{const i=e(n),s=o(n),c=r(n);return(0,t.applyQuery)(c,s,a,i)};t.applyQuery=(e,t,r,a)=>{const{sortToken:i,filterToken:s,limit:c}=r,d=(r=>(0,o.filterData)(t,e,s,r))(a),l=(e=>(0,n.sortData)(t,i,e))(d);return{items:c?l.slice(0,c):l,matchingCount:l.length}}},10360:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getValidState=t.isProposedLocaleLocalized=t.getLocaleFormat=void 0;const o=r(45127),n=r(38495),a=r(95623);function i(e){return!!o.Country[e]&&[o.Country.NO_TYPE,o.Country.UNIVERSAL].every((t=>t!==e))}t.getLocaleFormat=function(e,t,r){if(!(0,o.isObjectLocalized)(r))return o.Country.UNIVERSAL;const n=o.Country[r.content.localeFormat],a=i(n),s=t&&t.LocaleFormat?t.LocaleFormat:o.Country[e.country]||o.Country.US;return n&&a?n:s},t.isProposedLocaleLocalized=i,t.getValidState=function(e,t){return(0,n.isStateValid)(e,t)?t:(a.default.log(`[Data] Given value (${t}) is not a valid state value for country code ${e}`),"")}},38390:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(67631),n=r(79405),a=r(8566);t.setupSubscriptions=function(e,t){(0,o.setupSubscriptions)(e,t),(0,n.setupSubscriptions)(e,t),(0,a.setupSubscriptions)(e,t)}},72883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDataKeyVaultItem=t.PERSONAL_DATA_META_DATA=void 0,t.PERSONAL_DATA_META_DATA=["changeHistories","changesToUpload","generatedPasswords","securityBreaches","securityBreachesMetadata","breachesUpdaterStatus","breachRefreshMetaData","versionedBreaches","secureFileInfo","noteCategories","paypalAccounts","credentialCategories"],t.isDataKeyVaultItem=function(e){return!t.PERSONAL_DATA_META_DATA.includes(e)}},23136:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultSpaceId=t.getCurrentItems=t.getDebounceSync=t.WAIT_MS_BEFORE_SYNC=t.nextTick=void 0,t.nextTick=r(28255);const o=r(45127),n=r(63311),a=r(95623),i=r(28096),s=r(26634),c=r(49901),d=r(7944);t.WAIT_MS_BEFORE_SYNC=6e4;t.getDebounceSync=(e,r)=>(0,n.debounce)((o=>{a.Debugger.log("DebounceSync called => informClientsAndSyncPersonalDataChange()"),function(e,r,o){(0,i.reportDataUpdate)(e),(0,t.nextTick)((()=>{r.getInstance().user.attemptSync(o)}))}(e,r,o)}),t.WAIT_MS_BEFORE_SYNC);t.getCurrentItems=(e,t)=>{const r=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[e];return t?.[r]||[]};t.getDefaultSpaceId=e=>{const t=e.getState(),r=(0,d.activeSpacesSelector)(t)[0];return(0,s.isPersonalSpaceEnabledSelector)(t)?c.PERSONAL_SPACE_ID:r.teamId}},82043:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.maybeDataModelDetailView=t.dataModelDetailView=t.dataModelItemView=void 0;const r=e=>({id:e.Id});t.dataModelItemView=e=>({...r(e),hasAttachments:Array.isArray(e.Attachments)&&e.Attachments.length>0,kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});const o=e=>({id:e.Id});t.dataModelDetailView=e=>({...o(e),attachments:e.Attachments||[],kwType:e.kwType,lastUse:e.LastUse,localeFormat:e.LocaleFormat,spaceId:e.SpaceId});t.maybeDataModelDetailView=e=>t=>t?e(t):void 0},8581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(5600),n=r(56915),a=r(61078);t.config={commands:{cleanRemotelyRemovedProfiles:{handler:a.cleanRemotelyRemovedProfilesHandler}},queries:{getAnonymousComputerId:{selector:o.anonymousComputerIdSelector},getPlatformInfo:{selector:n.platformInfoSelector}},liveQueries:{}}},9486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerABTestingChanged=void 0;const o=r(19697);t.triggerABTestingChanged=function(e){(0,o.default)().abTestingChanged({version:e.version})}},91122:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchStateUpdated=void 0;const o=r(5307);t.killswitchStateUpdated=e=>({type:o.KILLSWITCH_STATE_UPDATED,killswitchState:e})},73651:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.killswitchReducer=t.getEmptyKillswitchState=t.DEFAULT_EMPTY_KILLSWITCH_STATE=void 0;const o=r(62760),n=r(5307);function a(){return t.DEFAULT_EMPTY_KILLSWITCH_STATE}t.DEFAULT_EMPTY_KILLSWITCH_STATE=Object.freeze({disableAutofill:!1,disableLoginFlowMigration:!1,brazeContentCardsDisabled:!1,disableAutoSSOLogin:!1}),t.getEmptyKillswitchState=a;t.killswitchReducer=(e=a(),t)=>t.type===n.KILLSWITCH_STATE_UPDATED?(0,o.shallowEqual)(e,t.killswitchState)?e:{...e,...t.killswitchState}:e},5307:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KILLSWITCH_STATE_UPDATED=void 0,t.KILLSWITCH_STATE_UPDATED="KILLSWITCH_STATE_UPDATED"},53439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedDeviceKeys=void 0,t.blacklistedDeviceKeys=["remoteFile"]},3163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(8581);t.bootstrap=e=>{e.register(o.config)}},78806:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemotelyRemovedProfilesHandler=void 0;const o=r(1965);t.cleanRemotelyRemovedProfilesHandler=async function({storageService:e,storeService:t,moduleClients:{"carbon-legacy":r}}){try{await(0,o.deviceRemoteDeletion)(t,e,r)}catch(e){throw new Error("Failed to perform device remote deletion")}}},61078:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(78806),t)},55861:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(3163);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},19399:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureDeviceName=void 0,t.secureDeviceName=function(e){return e?e.replace(/https?:\/\//g," "):e}},5600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousComputerIdSelector=void 0;const o=r(2246);t.anonymousComputerIdSelector=()=>(0,o.getCommonAppSetting)("anonymousComputerId")},12787:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBusConnectors=void 0;const o=r(30504);t.EventBusConnectors={syncFailure:(0,o.slot)(),syncSuccess:(0,o.slot)(),teamSpaceContentControlDone:(0,o.slot)(),sessionClosed:(0,o.slot)(),familyMemberLeft:(0,o.slot)(),remoteFileChanged:(0,o.slot)(),appInitialized:(0,o.slot)(),coreServicesReady:(0,o.slot)(),_sessionOpened:(0,o.slot)(),carbonSessionOpened:(0,o.slot)()}},73297:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventBusService=void 0;const a=r(30504),i=r(12787);t.makeEventBusService=()=>(0,a.createEventBus)({events:i.EventBusConnectors}),n(r(6775),t)},6775:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},28207:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonEventHooks=void 0;const o=r(49352);t.carbonEventHooks={iconsUpdates:o.iconsUpdatesHook}},15660:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCarbonEventStore=void 0,t.defaultCarbonEventStore={iconsUpdates:[]}},86691:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;const o=r(42898),n=r(28207);let a=null;t.setInstance=e=>{a=new o.EventStoreConsumer(e,n.carbonEventHooks)};t.getInstance=()=>{if(!a)throw new Error("Cannot get EventStoreConsumer instance");return a};t.clearInstance=()=>{a&&a.teardown(),a=null}},12362:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearInstance=t.getInstance=t.setInstance=void 0;let r=null;t.setInstance=e=>{r=e};t.getInstance=()=>{if(!r)throw new Error("Cannot get EventStore instance");return r};t.clearInstance=()=>{r&&r.teardown(),r=null}},46414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(8821),n=r(74321),a=r(99319);t.config={commands:{joinFamily:{handler:o.joinFamilyRequest},leaveFamily:{handler:a.leaveFamilyRequest},removeFamilyMember:{handler:o.removeFamilyMemberRequest},resetFamilyJoinToken:{handler:o.resetFamilyJoinTokenRequest},getFamilyDetails:{handler:n.getFamilyDetailsRequest}},queries:{},liveQueries:{}}},59047:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(46414);t.bootstrap=e=>{e.register(o.config)}},49409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(59047);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},74321:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFamilyDetailsRequest=void 0;const o=r(45127),n=r(66374),a=r(95623),i=r(46298),s=r(16593),c=r(4933);t.getFamilyDetailsRequest=async function(e){const{storeService:t}=e,r=(0,s.userLoginSelector)(t.getState());try{const e=await(0,i.getFamilyDetails)(t,r);if((0,i.isApiError)(e))return{success:!1,error:{code:(0,i.getCode)(e.code,[c.UserMustBeFamilyAdmin])}};const{name:a,id:s,joinToken:d,statusCode:l,members:u,maxMembers:p}=e;return{success:!0,response:{name:a,id:s,joinToken:d,statusCode:l,members:{admin:(0,n.getAdmin)(u),regular:(0,n.getMembersByRole)(u,o.FamilyMemberRoles.REGULAR),removed:(0,n.getMembersByRole)(u,o.FamilyMemberRoles.REMOVED)},spots:(0,n.getSpots)(u,p)}}}catch(e){return a.Debugger.error(`[Family] getFamilyDetailsRequest - Failed: ${e}`),{success:!1,error:{code:i.UnknownError}}}}},66374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpots=t.getMembersCount=t.getMembersByRole=t.getAdmin=void 0;const o=r(45127);function n(e,t){return e.filter((e=>e.role===t))}function a(e){return n(e,o.FamilyMemberRoles.ADMIN).length+n(e,o.FamilyMemberRoles.REGULAR).length}t.getAdmin=function(e){return e.find((e=>e.role===o.FamilyMemberRoles.ADMIN))},t.getMembersByRole=n,t.getMembersCount=a,t.getSpots=function(e,t){return t-a(e)}},3698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRenewalInformation=void 0;const o=r(45127),n=r(46298);t.getRenewalInformation=e=>{if(!e||e.state===n.FamilyStopRenewalStates.STOPPED)return{showRenewalMessage:!1};const t=(r=e.platform)===n.FamilyStopRenewalPlatforms.IOS_APP_STORE?o.FamilyRenewalPlatform.IOS_APP_STORE:r===n.FamilyStopRenewalPlatforms.MAC_STORE?o.FamilyRenewalPlatform.MAC_STORE:r===n.FamilyStopRenewalPlatforms.PLAY_STORE?o.FamilyRenewalPlatform.PLAY_STORE:null;var r;return t?{showRenewalMessage:!0,platform:t}:{showRenewalMessage:!1}}},68385:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserStatus=void 0;const o=r(45127);t.getUserStatus=(e,t)=>{switch(e){case o.PremiumStatusCode.NEW_USER:return o.JoinFamilyUserStatus.NEW_USER;case o.PremiumStatusCode.NO_PREMIUM:return t?o.JoinFamilyUserStatus.EXISTING_FREE_USER:o.JoinFamilyUserStatus.NEW_USER;case o.PremiumStatusCode.OLD_ACCOUNT:return o.JoinFamilyUserStatus.EXISTING_FREE_USER;case o.PremiumStatusCode.PREMIUM:case o.PremiumStatusCode.PREMIUM_CANCELLED:return o.JoinFamilyUserStatus.EXISTING_PREMIUM_USER;default:throw new Error("Family getUserStatus: impossible to identify user status")}}},8821:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(50794),t),n(r(98995),t),n(r(49828),t)},50794:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.joinFamilyRequest=void 0;const o=r(95623),n=r(46298),a=r(68385),i=r(3698),s=r(4933);t.joinFamilyRequest=async function(e,t){const{storeService:r}=e,{login:c,joinToken:d}=t;try{const e=await(0,n.joinFamily)(r,{login:c,joinToken:d});if((0,n.isApiError)(e))return{success:!1,error:{code:(0,n.getCode)(e.code,s.joinFamilyErrors)}};const{name:t,userExists:o,statusCode:l,stopRenewalResult:u}=e,p=(0,i.getRenewalInformation)(u);return{success:!0,response:{name:t,userExists:o,userStatus:(0,a.getUserStatus)(l,o),renewalInformation:p}}}catch(e){return o.Debugger.error(`[Family] joinFamilyRequest - Failed: ${e}`),{success:!1,error:{code:n.UnknownError}}}}},99319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.leaveFamilyRequest=void 0;const o=r(95623),n=r(46298),a=r(16593),i=r(4933);t.leaveFamilyRequest=async function(e){const{storeService:t,eventBusService:r}=e,s=(0,a.userLoginSelector)(t.getState());try{const e=await(0,n.leaveFamily)(t,s);return(0,n.isApiError)(e)?{success:!1,error:{code:(0,n.getCode)(e.code,i.leaveFamilyErrors)}}:(r.familyMemberLeft(),{success:!0,response:{}})}catch(e){return o.Debugger.error(`[Family] leaveFamilyRequest - Failed: ${e}`),{success:!1,error:{code:n.UnknownError}}}}},98995:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeFamilyMemberRequest=void 0;const o=r(95623),n=r(46298),a=r(16593),i=r(4933);t.removeFamilyMemberRequest=async function(e,t){const{storeService:r}=e,s=(0,a.userLoginSelector)(r.getState());try{const e=await(0,n.removeFamilyMember)(r,s,{userId:t.userId});return(0,n.isApiError)(e)?{success:!1,error:{code:(0,n.getCode)(e.code,i.removeFamilyMemberErrors)}}:{success:!0,response:{}}}catch(e){return o.Debugger.error(`[Family] removeFamilyMemberRequest - Failed: ${e}`),{success:!1,error:{code:n.UnknownError}}}}},49828:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetFamilyJoinTokenRequest=void 0;const o=r(95623),n=r(46298),a=r(16593),i=r(4933);t.resetFamilyJoinTokenRequest=async function(e){const{storeService:t}=e,r=(0,a.userLoginSelector)(t.getState());try{const e=await(0,n.resetFamilyJoinToken)(t,r);if((0,n.isApiError)(e))return{success:!1,error:{code:(0,n.getCode)(e.code,[i.UserMustBeFamilyAdmin])}};const{joinToken:o}=e;return{success:!0,response:{joinToken:o}}}catch(e){return o.Debugger.error(`[Family] resetFamilyJoinTokenRequest - Failed: ${e}`),{success:!1,error:{code:n.UnknownError}}}}},57362:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(88205);t.config={commands:{},queries:{getHasFeature:{selectorFactory:async e=>(await(0,o.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).getHasFeatureSelector},getFeatures:{selectorFactory:async e=>(await(0,o.makeFeatureFlipsSelectors)(e.applicationModulesAccess)).featureFlipsSelector}},liveQueries:{}}},72175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(57362);t.bootstrap=e=>{e.register(o.config)}},50329:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(72175);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},88205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeFeatureFlipsSelectors=t.makeGetHasFeatureSelector=t.makeFeatureFlipsSelector=void 0;const o=r(18948),n=r(66638);t.makeFeatureFlipsSelector=e=>async()=>{const{queries:t}=e.createClients().featureFlips,r=await(0,o.firstValueFrom)(t.userFeatureFlips());return(0,n.isSuccess)(r)?r.data:{}};t.makeGetHasFeatureSelector=e=>async(t,r)=>{const{queries:a}=e.createClients().featureFlips,i=await(0,o.firstValueFrom)(a.userFeatureFlips());if((0,n.isSuccess)(i))return i.data[r]};t.makeFeatureFlipsSelectors=e=>({featureFlipsSelector:(0,t.makeFeatureFlipsSelector)(e),getHasFeatureSelector:(0,t.makeGetHasFeatureSelector)(e)})},88485:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(78671);t.config={commands:{setGlobalExtensionSettings:{handler:o.setGlobalExtensionSettings},getGlobalExtensionSettings:{handler:o.getGlobalExtensionSettings}},queries:{},liveQueries:{}}},17644:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettingsState=t.SET_GLOBAL_EXTENSION_SETTINGS=void 0,t.SET_GLOBAL_EXTENSION_SETTINGS="SET_GLOBAL_EXTENSION_SETTINGS";t.setGlobalExtensionSettingsState=e=>({type:t.SET_GLOBAL_EXTENSION_SETTINGS,extensionSettings:e})},45316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;var o=r(22018);Object.defineProperty(t,"globalExtensionSettingsReducer",{enumerable:!0,get:function(){return o.globalExtensionSettingsReducer}})},22018:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.globalExtensionSettingsReducer=void 0;const o=r(17644);t.globalExtensionSettingsReducer=(e={},t)=>t.type===o.SET_GLOBAL_EXTENSION_SETTINGS?Object.assign({},e,{extensionSettings:t.extensionSettings}):e},84838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(88485),n=r(78671),a=r(70252),i=r(17644);t.bootstrap=(e,t)=>{e.register(o.config);const{storeService:r,storageService:s,applicationModulesAccess:c}=t;(0,n.getGlobalExtensionSettings)({storeService:r,storageService:s}).then((e=>{r.dispatch((0,i.setGlobalExtensionSettingsState)(e)),(0,n.setExceptionLogsConsent)(c,e.interactionDataConsent??!0),(0,a.setAllowedToSendExceptionLog)(e.interactionDataConsent??!0)}))}},78671:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setGlobalExtensionSettings=t.getGlobalExtensionSettings=t.setExceptionLogsConsent=void 0;const o=r(66102),n=r(17644),a=r(70252),i="consents",s={interactionDataConsent:"interactionData",personalDataConsent:"personalData"},c={interactionDataConsent:null,personalDataConsent:null};function d(e,t){const r=e.createClients(),{enableExceptionLog:o}=r.exceptionLogging.commands;o({flag:t})}t.setExceptionLogsConsent=d;t.getGlobalExtensionSettings=async e=>{const t=e.storageService.getLocalStorage();try{return((e=null)=>{const t=JSON.parse(e);return!t||"object"!=typeof t||Array.isArray(t)?c:Object.values(s).every((e=>Object.prototype.hasOwnProperty.call(t,e)))?{interactionDataConsent:t[s.interactionDataConsent],personalDataConsent:t[s.personalDataConsent]}:c})(await t.readItem(i))}catch{return console.warn("failed parsing user consent values; proceeding as if they haven't been set."),{interactionDataConsent:null,personalDataConsent:null}}};t.setGlobalExtensionSettings=async(e,t)=>{const r=e.storageService.getLocalStorage();try{await r.writeItem(i,JSON.stringify({[s.interactionDataConsent]:t.interactionDataConsent,[s.personalDataConsent]:t.personalDataConsent})),e.storeService.dispatch((0,n.setGlobalExtensionSettingsState)(t)),(0,a.setAllowedToSendExceptionLog)(!1!==t.interactionDataConsent),d(e.applicationModulesAccess,!1!==t.interactionDataConsent),(0,o.logToggleAnalyticsEvent)(e)}catch{return{success:!1}}return{success:!0}}},44389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(84838);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},64090:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(47975);t.config={commands:{evaluatePassword:{handler:o.evaluatePassword}},queries:{},liveQueries:{}}},10925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.load=void 0;const o=r(55539);t.load=async e=>{const{data:t}=await(0,o.httpGetUsingFetch)(`${e}assets/frequency_lists.json`);return t}},47975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePassword=t.evaluatePasswordStrength=t.loadFrequencyLists=void 0;const o=r(85465),n=r(2646),a=r(10925);let i=()=>{};const s=new Promise((e=>{i=e}));t.loadFrequencyLists=async()=>{const e=(0,n.getPublicPath)(),t=await(0,a.load)(e);(0,o.setFrequencyLists)(t),i()};const c=async e=>(await s,(0,o.evaluate)(e));t.evaluatePasswordStrength=async e=>(await c(e)).score;t.evaluatePassword=async(e,t)=>{const{score:r,feedback:o}=await c(t.password);return{score:r,feedback:o}}},64948:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluatePasswordStrengthOutOfFive=void 0;const o=r(47975);t.evaluatePasswordStrengthOutOfFive=async e=>{if(e)return await(0,o.evaluatePasswordStrength)(e)/25}},61566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(64090);t.bootstrap=e=>{e.register(o.config)}},16359:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(61566);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},17825:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assertUnreachable=void 0,t.assertUnreachable=function(e,t="Didn't expect to reach this code."){throw new Error(t)}},32663:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.asyncFilter=void 0,t.asyncFilter=async function(e,t){const r=await Promise.all(e.map(t));return e.filter(((e,t)=>r[t]))}},27627:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMapLimit=void 0;const o=r(4939);t.asyncMapLimit=(e,t,r,n=e.length)=>{const a=e.length;let i=0;const s=[];let c=0;const d=o=>n=>{if(s[o]=n,i++,a===i)return r(s);c<a-1&&(c++,t(e[c],d(c)))},l=Math.max(Math.min(a,n),1);c=l-1;for(let r=0;r<l;r++)t(e[r],d(r)).catch((e=>(0,o.logWarn)({message:e.message})))}},63311:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0,t.debounce=function(e,t){let r;return function(o,...n){var a=this;clearTimeout(r),o.immediateCall?(r=null,e.apply(a,n)):r=setTimeout((function(){r=null,e.apply(a,n)}),t)}}},5851:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherDatabaseRules=void 0;const o=r(56668),n=r(83570);t.decipherDatabaseRules=(e,t)=>(async(e,t)=>{const r=await(0,o.decipherDashlaneSecureData)(t,e,"",(0,n.makeGetDerivateKeyWithCacheAndQueue)());return(0,o.deflatedUtf8ToUtf16)(r)})(e,t)},82761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeTransactions=void 0;t.sanitizeTransactions=e=>e.filter(Boolean)},64658:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSetsEqual=void 0,t.areSetsEqual=function(e,t){return e===t||e.size===t.size&&Array.from(e).every((e=>t.has(e)))}},93564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowLocalStorage=void 0,t.getWindowLocalStorage=function(){return self.localStorage||null}},96186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inMemoryInterSessionUnsyncedSliceReducer=void 0;var o=r(75486);Object.defineProperty(t,"inMemoryInterSessionUnsyncedSliceReducer",{enumerable:!0,get:function(){return o.inMemoryInterSessionUnsyncedSliceReducer}})},16373:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetAllLoginNotification=t.addNewLoginNotification=t.RESET_ALL_LOGIN_NOTIFICATIONS=t.ADD_NEW_LOGIN_NOTIFICATION=void 0,t.ADD_NEW_LOGIN_NOTIFICATION="ADD_NEW_LOGIN_NOTIFICATION",t.RESET_ALL_LOGIN_NOTIFICATIONS="RESET_ALL_LOGIN_NOTIFICATIONS";t.addNewLoginNotification=e=>({type:t.ADD_NEW_LOGIN_NOTIFICATION,notification:e});t.resetAllLoginNotification=()=>({type:t.RESET_ALL_LOGIN_NOTIFICATIONS})},71907:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(16373);t.default=(e=[],t)=>{switch(t.type){case o.ADD_NEW_LOGIN_NOTIFICATION:return[...e,t.notification];case o.RESET_ALL_LOGIN_NOTIFICATIONS:return[];default:return e}}},75486:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inMemoryInterSessionUnsyncedSliceReducer=void 0;const o=r(82422),n=r(71907);t.inMemoryInterSessionUnsyncedSliceReducer=(0,o.combineReducers)({loginNotification:n.default})},96637:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TsEventBusCommandQueryBus=void 0;var o=r(42278);Object.defineProperty(t,"TsEventBusCommandQueryBus",{enumerable:!0,get:function(){return o.TsEventBusCommandQueryBus}})},42278:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TsEventBusCommandQueryBus=void 0;const o=r(30504),n=r(30137),a=r(7036);class i extends n.CommandQueryBus{constructor(e,t,r){super(e),this.bus=r,r||(this.bus=(0,o.createEventBus)({events:t}))}registerCommand(e,t){this.bus[e].on(t)}registerQuery(e,t){this.bus[e].on(t)}registerLiveQuery(e,t){(0,a.connectLazySlot)(this.bus[e],t)}}t.TsEventBusCommandQueryBus=i},76901:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageEventStore=void 0;const o=r(33968),n=r(15660);class a extends o.EventStore{constructor(e){super(),this.localStorageService=e}async store(e){await this.localStorageService.getInstance().storeEventStore(e)}async retrieve(){const e=await this.localStorageService.getInstance().getEventStore();return null===e?n.defaultCarbonEventStore:{iconsUpdates:e.iconsUpdates||n.defaultCarbonEventStore.iconsUpdates}}}t.LocalStorageEventStore=a},42898:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventStoreConsumer=void 0;const o=r(35088);t.EventStoreConsumer=class{constructor(e,t){this.eventStore=e,this.hooks=t,this.liveConsumptionSubs={},this.lockIds={},this.startTopic=e=>{this.startLiveConsumption(e),this.consumeTopic(e)},this.lockTopic=e=>{this.stopLiveConsumption(e);const t=(0,o.v4)();return this.lockIds[e]=(this.lockIds[e]||new Set).add(t),t},this.releaseTopic=(e,t)=>{const r=this.lockIds[e];r&&r.delete(t),r&&0!==r.size||this.startTopic(e)},this.teardown=()=>{Object.keys(this.liveConsumptionSubs).forEach(this.stopLiveConsumption)},this.consumeTopic=async e=>{const t=await this.eventStore.getItems(e);for(const r of t)this.handleItem(e,r)},this.startLiveConsumption=e=>{this.liveConsumptionSubs[e]||(this.liveConsumptionSubs[e]=this.eventStore.newItems$(e).subscribe((t=>this.handleItem(e,t))))},this.stopLiveConsumption=e=>{this.liveConsumptionSubs[e]&&(this.liveConsumptionSubs[e].unsubscribe(),delete this.liveConsumptionSubs[e])},this.handleItem=async(e,t)=>{const r=this.hooks[e];r||await this.eventStore.remove(e,t.id);await r(t.event)&&await this.eventStore.remove(e,t.id)}}}},36606:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebugConnector=void 0;const o=r(30504);t.DebugConnector={log:(0,o.slot)(),info:(0,o.slot)(),warning:(0,o.slot)(),error:(0,o.slot)()}},44261:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},92231:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(44261),t),n(r(36606),t)},31335:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(78759),n=r(91296);t.config={commands:{},queries:{getIsBrazeContentDisabled:{selector:o.disableBrazeContentCardsSelector},getIsLoginFlowMigrationDisabled:{selector:o.disableLoginFlowMigrationSelector},getIsAutoSSOLoginDisabled:{selector:o.disableAutoSSOLoginSelector},getKillSwitch:{selector:o.killSwitchSelector}},liveQueries:{liveIsBrazeContentDisabled:{operator:n.disableBrazeContentCardsOperator$},liveIsLoginFlowMigrationDisabled:{operator:n.disableLoginFlowMigrationOperator$},liveIsAutoSSOLoginDisabled:{operator:n.disableAutoSSOLoginOperator$},liveKillSwitch:{operator:n.getKillSwitchOperator$}}}},19469:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(31335);t.bootstrap=e=>{e.register(o.config)}},36641:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerKillswitchCron=void 0;const o=r(19328),n=r(55030);let a=null;const i=60,s=60*i*1e3,c="killswitch-alarm";t.triggerKillswitchCron=function(e){(0,o.alarmsIsSupported)()?async function(e){await(0,o.alarmsGet)(c)||((0,n.updateKillswitchState)(e),(0,o.alarmsCreate)(c,{periodInMinutes:i})),o.alarmsOnAlarm.addListener((t=>{t.name===c&&(0,n.updateKillswitchState)(e)}))}(e):function(e){a||((0,n.updateKillswitchState)(e),a=setInterval((()=>{try{(0,n.updateKillswitchState)(e)}catch{}}),s))}(e)}},61:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(19469);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},55030:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateKillswitchState=void 0;const o=r(10295),n=r(4102),a=r(66677),i=r(46298),s=r(91122),c=o.z.object({disableAutofill:o.z.boolean().default(!1),brazeContentCardsDisabled:o.z.boolean().default(!1),disableLoginFlowMigration:o.z.boolean().default(!1),disableAutoSSOLogin:o.z.boolean().default(!1)});t.updateKillswitchState=async e=>{const t=Object.values(n.KillSwitches),r=await(0,a.getKillSwitches)(e,t);if((0,i.isApiError)(r))throw new Error(`[Killswitch] - updateKillswitchState : ${r.message} (${r.code})`);const o=c.safeParse(r);if(!o.success)throw new Error("[Killswitch] - updateKillswitchState: unexpected server response shape");e.dispatch((0,s.killswitchStateUpdated)({disableAutofill:o.data.disableAutofill||!1,brazeContentCardsDisabled:o.data.brazeContentCardsDisabled||!1,disableLoginFlowMigration:o.data.disableLoginFlowMigration||!1,disableAutoSSOLogin:o.data.disableAutoSSOLogin||!1}))}},91296:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitchOperator$=t.disableAutoSSOLoginOperator$=t.disableLoginFlowMigrationOperator$=t.disableBrazeContentCardsOperator$=void 0;const o=r(18948),n=r(3343),a=r(78759);t.disableBrazeContentCardsOperator$=()=>(0,o.pipe)((0,n.map)(a.disableBrazeContentCardsSelector),(0,n.distinctUntilChanged)());t.disableLoginFlowMigrationOperator$=()=>(0,o.pipe)((0,n.map)(a.disableLoginFlowMigrationSelector),(0,n.distinctUntilChanged)());t.disableAutoSSOLoginOperator$=()=>(0,o.pipe)((0,n.map)(a.disableAutoSSOLoginSelector),(0,n.distinctUntilChanged)());t.getKillSwitchOperator$=e=>{const t=(0,a.getKillSwitchSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())}},78759:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitchSelector=t.killSwitchSelector=t.disableAutoSSOLoginSelector=t.disableLoginFlowMigrationSelector=t.disableBrazeContentCardsSelector=void 0;const o=r(73651),n=e=>e.device.killswitch||o.DEFAULT_EMPTY_KILLSWITCH_STATE;t.disableBrazeContentCardsSelector=e=>n(e).brazeContentCardsDisabled||!1;t.disableLoginFlowMigrationSelector=e=>n(e).disableLoginFlowMigration||!1;t.disableAutoSSOLoginSelector=e=>n(e).disableAutoSSOLogin;t.killSwitchSelector=(e,t)=>n(e)[t];t.getKillSwitchSelector=e=>r=>(0,t.killSwitchSelector)(r,e)},23299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(36641);t.setupSubscriptions=function(e,t){e.appInitialized.on((()=>{const{storeService:e}=t;(0,o.triggerKillswitchCron)(e)}))}},89855:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBackupCryptError=t.BackupCryptError=t.BackupCryptErrorMessages=t.BackupCryptErrorCode=void 0;const o=r(92263);var n;!function(e){e[e.TRANSACTION_CLEAR_CONTENT_EMPTY=0]="TRANSACTION_CLEAR_CONTENT_EMPTY",e[e.EMPTY_CLEAR_FULL_BACKUP_FILE_XML=1]="EMPTY_CLEAR_FULL_BACKUP_FILE_XML",e[e.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY=2]="CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY",e[e.EMPTY_FULL_BACKUP_FILE=3]="EMPTY_FULL_BACKUP_FILE",e[e.NULL_FULL_BACKUP_FILE_MAP=4]="NULL_FULL_BACKUP_FILE_MAP",e[e.EMPTY_FULL_BACKUP_FILE_MAP=5]="EMPTY_FULL_BACKUP_FILE_MAP",e[e.EMPTY_CLEAR_FULL_BACKUP_FILE=6]="EMPTY_CLEAR_FULL_BACKUP_FILE",e[e.CLEAR_FULL_BACKUP_FILE_NOT_XML=7]="CLEAR_FULL_BACKUP_FILE_NOT_XML",e[e.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE=8]="FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE",e[e.FULL_BACKUP_FILE_ITEM_WITHOUT_ID=9]="FULL_BACKUP_FILE_ITEM_WITHOUT_ID",e[e.TRANSACTION_CONTENT_NOT_XML=10]="TRANSACTION_CONTENT_NOT_XML"}(n=t.BackupCryptErrorCode||(t.BackupCryptErrorCode={})),t.BackupCryptErrorMessages={[n.TRANSACTION_CLEAR_CONTENT_EMPTY]:"Empty transaction content",[n.EMPTY_CLEAR_FULL_BACKUP_FILE_XML]:"Empty full backup file XML",[n.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY]:"Full backup file XML not resolved as an array",[n.EMPTY_FULL_BACKUP_FILE]:"Empty full backup file",[n.NULL_FULL_BACKUP_FILE_MAP]:"Null full backup file map",[n.EMPTY_FULL_BACKUP_FILE_MAP]:"Empty full backup file map",[n.EMPTY_CLEAR_FULL_BACKUP_FILE]:"Deciphered full backup file content is empty",[n.CLEAR_FULL_BACKUP_FILE_NOT_XML]:"WRONG_PASSWORD",[n.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE]:"Full backup file item without kwType",[n.FULL_BACKUP_FILE_ITEM_WITHOUT_ID]:"Full backup file item without Id",[n.TRANSACTION_CONTENT_NOT_XML]:"WRONG_PASSWORD"},t.BackupCryptError={codes:n,name:"BackupCryptError",messages:t.BackupCryptErrorMessages};t.isBackupCryptError=e=>(0,o.isCarbonError)(e,t.BackupCryptError)},46e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptFullBackupFile=void 0;const o=r(80469),n=r(89855),a=r(83638),i=r(56668),s=r(92263),c=r(61797),d=r(70252),l=r(58582),u=async(e,t)=>{try{const e=await(0,c.parseDashlaneXml)(t);if(!e)throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE_XML);if(!Array.isArray(e))throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.CLEAR_FULL_BACKUP_FILE_XML_NOT_AN_ARRAY);return e}catch(t){throw e(l.announcements.decipherFullBackupParseFailed(t)),t}},p=(e,t,r)=>{if(null==t)return e(l.announcements.decipherFullBackupSkipped()),!1;if(""===t)throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.EMPTY_FULL_BACKUP_FILE);if(null===r)throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.NULL_FULL_BACKUP_FILE_MAP);if(t&&0===r.size)throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.EMPTY_FULL_BACKUP_FILE_MAP);return!0},S=async(e,t,r)=>{try{const t=await e.decrypt(r),o=(0,i.deflatedUtf8ToUtf16)(t);if(!o){const e=new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE);throw d.sendExceptionLog({error:e}),e}if("string"==typeof o&&!o.trim().startsWith("<"))throw new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.CLEAR_FULL_BACKUP_FILE_NOT_XML);return o}catch(n){const a=(0,o.attemptReadCryptoPayload)(e,r);throw t(l.announcements.decipherFullBackupDecipherFailed(n,a)),n}},m=(e,t,r)=>{const{Id:o,kwType:i}=t,c=r.get(o);if(void 0===c)return e(l.announcements.decipherFullBackupItemSkipped(new Error("Transaction not in full backup list skipped"),{itemType:i,itemId:o})),null;const d=t instanceof Object?Object.keys(t):[];if(!i){const t=new s.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.FULL_BACKUP_FILE_ITEM_WITHOUT_KWTYPE);throw e(l.announcements.decipherFullBackupItemReadFailed(t.addAdditionalInfo({itemId:o,itemKeys:d}),o)),t}return o?(e(l.announcements.decipherFullBackupItemRead(i,o,c)),{type:(0,a.getTransactionTypeFromDataModelType)(i),backupDate:c,action:"BACKUP_EDIT",identifier:o,content:t}):(e(l.announcements.decipherFullBackupItemSkipped(new Error("Transaction without id skipped"),{itemType:i})),null)},g=(e,t,r)=>{const o=t.length,n=[],a=new Set;for(let i=0;i<o;++i){const o=t[i];o.Id&&a.add(o.Id);const s=m(e,o,r);s&&n.push(s)}return((e,t,r)=>{for(const o in t.keys())r.has(o)||e(l.announcements.decipherFullBackupItemSkipped(new Error("Missing full backup item content"),{itemId:o}))})(e,r,a),n};t.decryptFullBackupFile=async function(e,t,r,a){try{if(!p(t,r,a))return[];t(l.announcements.decipherFullBackupStarted());const n=await S(e,t,r),i=await u(t,n),s=(0,o.fixKwType)(i),c=g(t,s,a);return t(l.announcements.decipherFullBackupFinished(c.length)),c}catch(e){if(t(l.announcements.decipherFullBackupFailed(e)),(0,s.isCarbonError)(e,n.BackupCryptError,n.BackupCryptErrorCode.EMPTY_CLEAR_FULL_BACKUP_FILE))return[];throw e}}},63713:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSingleTransaction=t.decrypt=void 0;const o=r(62433),n=r(46e3),a=r(16859);Object.defineProperty(t,"encryptSingleTransaction",{enumerable:!0,get:function(){return a.encryptSingleTransaction}});const i=r(59700),s=r(58582),c=e=>(0,o.partition)((e=>"SETTINGS"===e.type),e),d=e=>(0,o.partition)((e=>!!e.content),e),l=e=>e.map((e=>({...e,content:null})));t.decrypt=async function(e,t,r,o,u){if(null===u)throw new Error("null transactions");const p=Number(r&&o.size);t(s.announcements.decipherStarted(p));const S=await(0,n.decryptFullBackupFile)(e,t,r,o);t(s.announcements.decipherTransactionsStarted());const[m,g]=c(u),y=await(0,a.decryptSingleTransactions)(e,t,m),[A,f]=d(g),E=(0,i.makeOpenSessionProgressService)();E.init(A.length);const h=await(0,a.decryptSingleTransactions)(e,t,A,E),v=l(f);t(s.announcements.decipherTransactionsFinished());const T=[...S,...y,...v,...h];return t(s.announcements.decipherFinished(T)),T}},59700:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeOpenSessionProgressService=void 0;const o=r(19697);t.makeOpenSessionProgressService=()=>{let e,t,r,n;const a=(a=!1)=>{const i=(0,o.default)();if(!i)return;const s=t/e*100;(a||Date.now()-n>=500&&s!==r)&&(r=s,n=Date.now(),i.openSessionProgressChanged({statusDescription:"percentage of work done before session opening",statusProgress:r}))};return{init(o){e=o,t=0,r=0,n=Date.now(),a(!0)},incrementJobsDone(){if(void 0===e)throw new Error("openSessionProgressService must be initialized before begin used");t++,a()},decrementJobsTodo(){e--}}}},16859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.encryptSingleTransaction=t.decryptSingleTransactions=t.decryptSingleTransaction=t.parseTransactionContentXml=t.decryptTransactionContent=void 0;const o=r(80469),n=r(89855),a=r(92263),i=r(61797),s=r(70252),c=r(56668),d=r(58582);t.decryptTransactionContent=async(e,t,{content:r})=>{try{const t=await e.decrypt(r);return(0,c.deflatedUtf8ToUtf16)(t)}catch(n){const a=(0,o.attemptReadCryptoPayload)(e,r);throw t(d.announcements.decipherTransactionDecipherFailed(n,a)),n}};t.parseTransactionContentXml=async(e,t)=>{try{return(e=>{if(!e){const e=new a.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.TRANSACTION_CLEAR_CONTENT_EMPTY);throw s.sendExceptionLog({error:e}),e}})(t),(e=>{if("string"==typeof e&&!e.trim().startsWith("<"))throw new a.CarbonError(n.BackupCryptError,n.BackupCryptErrorCode.TRANSACTION_CONTENT_NOT_XML)})(t),await(0,i.parseDashlaneXml)(t)}catch(t){throw e(d.announcements.decipherTransactionParseFailed(t)),t}};const l=(e,t)=>Object.assign({},e,{content:t});async function u(e,r,a){try{r(d.announcements.decipherTransactionStarted(a));const n=await(0,t.decryptTransactionContent)(e,r,a),i=await(0,t.parseTransactionContentXml)(r,n),s=(0,o.fixKwType)(i),c=l(a,s);return r(d.announcements.decipherTransactionFinished(a)),c}catch(e){const{type:t}=a;if((0,n.isBackupCryptError)(e)){const{action:r,backupDate:o,identifier:n}=a;e.addAdditionalInfo({itemId:n,transactionType:t,action:r,backupDate:o})}if(r(d.announcements.decipherTransactionFailed(e,a)),"SETTINGS"===t)throw e;return null}}t.decryptSingleTransaction=u,t.decryptSingleTransactions=async function(e,t,r,o){const n=r.map((async r=>{const n=await u(e,t,r);return o&&o.incrementJobsDone(),n}));return(await Promise.all(n)).filter(Boolean)},t.encryptSingleTransaction=async function(e,t,r={}){const o=(0,c.utf16ToDeflatedUtf8)(t.content),n=await e.getInstance().encrypt(o,r);return{...t,content:n}}},80469:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fixKwType=t.attemptReadCryptoPayload=void 0;const o=r(54218);t.attemptReadCryptoPayload=(e,t)=>{try{return e.readCryptoPayload(t)}catch(e){}return""},t.fixKwType=function e(t){return Array.isArray(t)?t.map((t=>e(t))):(0,o.default)(t)?Object.keys(t).reduce(((r,o)=>{const n=t[o];return"__type__"===o?r.kwType=n:r[o]=e(n),r}),{}):t}},91453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatStep=void 0;const o=r(2695),n=r(17825);t.formatStep=e=>{switch(e){case o.SyncLoggerStep.Main:return"[Sync]";case o.SyncLoggerStep.Chronological:return"[Sync|Chrono]";case o.SyncLoggerStep.Latest:return"[Sync|Latest]";case o.SyncLoggerStep.Decipher:return"[Sync|Decipher]";case o.SyncLoggerStep.DecipherFullBackup:return"[Sync|Decipher|FullBackup]";case o.SyncLoggerStep.DecipherTransactions:return"[Sync|Decipher|Transactions]";case o.SyncLoggerStep.Duplicate:return"[Sync|Duplicate]";case o.SyncLoggerStep.Cipher:return"[Sync|Cipher]";case o.SyncLoggerStep.Upload:return"[Sync|Upload]";case o.SyncLoggerStep.Save:return"[Sync|Save]";case o.SyncLoggerStep.TreatProblem:return"[Sync|TreatProblem]";case o.SyncLoggerStep.TreatProblemSummary:return"[Sync|TreatProblem|Summary]";case o.SyncLoggerStep.Sharing:return"[Sync|Sharing]";case o.SyncLoggerStep.TeamAdminData:return"[Sync|TeamAdminData]";default:(0,n.assertUnreachable)(e)}}},92221:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(33626),t)},71369:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logSyncVerbose=t.logSyncDebug=t.logSyncInfo=t.logSyncWarn=t.logSyncError=void 0;const o=r(95623),n=(0,o.withTag)("Sync");t.logSyncError=n(o.logError),t.logSyncWarn=n(o.logWarn),t.logSyncInfo=n(o.logInfo),t.logSyncDebug=n(o.logDebug),t.logSyncVerbose=n(o.logVerbose)},33626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSyncLoggerMonitor=void 0;const o=r(58582),n=r(2695),a=r(90635),i=r(91453),s=r(71369);t.makeSyncLoggerMonitor=()=>{let e=null;const t=e=>"object"==typeof e&&e.message||`${e}`,r=(e,t)=>`${(0,i.formatStep)(e)} ${t}`;return(i,{timestamp:c})=>{switch(i.type){case"SyncStarted":{const{syncType:t}=i;e=c,(0,s.logSyncInfo)({message:r(n.SyncLoggerStep.Main,"Start"),details:{step:n.SyncLoggerStep.Main,Type:(0,a.syncTypeForSyncLogger)(t)}})}break;case"ChronologicalSyncStarted":{const{updatesCount:t,deletesCount:o}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Chronological,"Start"),details:{step:n.SyncLoggerStep.Chronological,Timestamp:e,Update:t,Delete:o}})}break;case"LatestRequested":{const{lock:t,needsKeys:o}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Latest,"Request"),details:{step:n.SyncLoggerStep.Latest,Timestamp:e,Lock:t,SharingKeys:o}})}break;case"LatestSucceeded":{const{updatesCount:t,deletesCount:o,fullBackupSize:a}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Latest,"Success"),details:{step:n.SyncLoggerStep.Latest,Timestamp:e,Update:t,Delete:o,FullBackup:a}})}break;case"LatestFailed":{const{error:e}=i;(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.Latest,"Error"),details:{step:n.SyncLoggerStep.Latest,Cause:t(e)}})}break;case"DecipherStarted":{const{fullBackupFileSize:e}=i;(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Decipher,"Start"),details:{step:n.SyncLoggerStep.Decipher,Count:e}})}break;case"DecipherFullBackupSkipped":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.DecipherFullBackup,"Skip"),details:{step:n.SyncLoggerStep.DecipherFullBackup}});break;case"DecipherFullBackupStarted":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.DecipherFullBackup,"Start"),details:{step:n.SyncLoggerStep.DecipherFullBackup}});break;case"DecipherFullBackupItemRead":{const{itemType:e,itemId:t,backupDate:o}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.DecipherFullBackup,"Transaction"),details:{step:n.SyncLoggerStep.DecipherFullBackup,Type:e,Id:t,Date:o}})}break;case"DecipherFullBackupItemSkipped":{const{error:e,itemType:o,itemId:a}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.DecipherFullBackup,"TransactionSkipped"),details:{step:n.SyncLoggerStep.DecipherFullBackup,Type:o,Id:a,Cause:t(e)}})}break;case"DecipherFullBackupFinished":{const{itemsCount:e}=i;(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.DecipherFullBackup,"Done"),details:{step:n.SyncLoggerStep.DecipherFullBackup,Count:e}})}break;case"DecipherFullBackupFailed":{const{error:e}=i;(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.DecipherFullBackup,"Error"),details:{step:n.SyncLoggerStep.DecipherFullBackup,Cause:t(e)}})}break;case"DecipherTransactionsStarted":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.DecipherTransactions,"Start"),details:{step:n.SyncLoggerStep.DecipherTransactions}});break;case"DecipherTransactionFinished":{const{action:e,transactionType:t,identifier:o,backupDate:a}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.DecipherTransactions,"Transaction"),details:{step:n.SyncLoggerStep.DecipherTransactions,Action:e,Type:t,Id:o,Date:a}})}break;case"DecipherTransactionFailed":{const{error:e,transactionType:o,identifier:a,backupDate:c}=i;(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.DecipherTransactions,"Error"),details:{step:n.SyncLoggerStep.DecipherTransactions,Cause:t(e),Type:o,Id:a,Date:c}})}break;case"DecipherTransactionsFinished":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.DecipherTransactions,"Done"),details:{step:n.SyncLoggerStep.DecipherTransactions}});break;case"DecipherFinished":{const{updatesCount:e,deletesCount:t}=i;(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Decipher,"Done"),details:{step:n.SyncLoggerStep.Decipher,Transactions:e+t}})}break;case"TransactionDuplicated":{const{transactionType:e,identifier:t,backupDate:o}=i;(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.Duplicate,"Transaction"),details:{step:n.SyncLoggerStep.Duplicate,Type:e,Id:t,Date:o}})}break;case"CipherStarted":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Cipher,"Start"),details:{step:n.SyncLoggerStep.Cipher}});break;case"TransactionCiphered":{const{transactionType:e,itemId:t,backupDate:o}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Cipher,"Transaction"),details:{step:n.SyncLoggerStep.Cipher,Type:e,Id:t,Date:o}})}break;case"CipherFinished":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Cipher,"Done"),details:{step:n.SyncLoggerStep.Cipher}});break;case"UploadRequested":{const{updatedCount:e,deletedCount:t}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Upload,"Request"),details:{step:n.SyncLoggerStep.Upload,Update:e,Delete:t}})}break;case"UploadSucceeded":{const{timestamp:e}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Upload,"Success"),details:{step:n.SyncLoggerStep.Upload,Timestamp:e}})}break;case"UploadFailed":{const{error:e}=i;(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.Upload,"Error"),details:{step:n.SyncLoggerStep.Upload,Cause:t(e)}})}break;case"SaveStarted":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Save,"Start"),details:{step:n.SyncLoggerStep.Save}});break;case"SaveFinished":(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.Save,"Done"),details:{step:n.SyncLoggerStep.Save}});break;case"ChronologicalSyncFinished":{const{summarySize:e}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Chronological,"Done"),details:{step:n.SyncLoggerStep.Chronological,Summary:e}})}break;case"TreatProblemStarted":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TreatProblem,"Start"),details:{step:n.SyncLoggerStep.TreatProblem}});break;case"TreatProblemSummaryStarted":{const{localItemsCount:e,remoteItemsCount:t}=i;(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TreatProblemSummary,"Start"),details:{step:n.SyncLoggerStep.TreatProblemSummary,Local:e,Remote:t}})}break;case"TreatProblemSummaryCompared":{const{result:e,cause:t,transactionType:a,identifier:c,localDate:d,remoteDate:l}=i,u=void 0!==l?{RemoteDate:l}:{},p=t?{Cause:o.TreatProblemSummaryComparedCause[t]}:{},S=d?{LocalDate:d}:{};(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TreatProblemSummary,"Comparison"),details:{step:n.SyncLoggerStep.TreatProblemSummary,Result:o.TreatProblemSummaryComparedResult[e],...p,Type:a,Id:c,...S,...u}})}break;case"TreatProblemSummaryFinished":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TreatProblemSummary,"Done"),details:{step:n.SyncLoggerStep.TreatProblemSummary}});break;case"TreatProblemDiffComputed":{const{transactionsToDownloadCount:e,transactionsToUploadCount:t}=i;0===e&&0===t?(0,s.logSyncVerbose)({message:r(n.SyncLoggerStep.TreatProblem,"Diff UpToDate"),details:{step:n.SyncLoggerStep.TreatProblem}}):(0,s.logSyncWarn)({message:r(n.SyncLoggerStep.TreatProblem,"Diff"),details:{step:n.SyncLoggerStep.TreatProblem,Download:e,Upload:t}})}break;case"TreatProblemFinished":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TreatProblem,"Done"),details:{step:n.SyncLoggerStep.TreatProblem}});break;case"TeamAdminDataSyncStarted":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TeamAdminData,"Start"),details:{step:n.SyncLoggerStep.TeamAdminData}});break;case"TeamAdminDataSyncFinished":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.TeamAdminData,"Done"),details:{step:n.SyncLoggerStep.TeamAdminData}});break;case"SharingSyncStarted":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Sharing,"Start"),details:{step:n.SyncLoggerStep.Sharing}});break;case"SharingSyncFinished":(0,s.logSyncDebug)({message:r(n.SyncLoggerStep.Sharing,"Done"),details:{step:n.SyncLoggerStep.Sharing}});break;case"SyncFinished":(0,s.logSyncInfo)({message:r(n.SyncLoggerStep.Main,"Done"),details:{step:n.SyncLoggerStep.Main}});break;case"SyncFailed":{const{error:e}=i;(0,s.logSyncError)({message:r(n.SyncLoggerStep.Main,"Failed"),details:{step:n.SyncLoggerStep.Main,Cause:t(e)}})}}}}},2695:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyncLoggerStep=void 0,function(e){e[e.Main=0]="Main",e[e.Chronological=1]="Chronological",e[e.Latest=2]="Latest",e[e.Decipher=3]="Decipher",e[e.DecipherFullBackup=4]="DecipherFullBackup",e[e.DecipherTransactions=5]="DecipherTransactions",e[e.Duplicate=6]="Duplicate",e[e.Cipher=7]="Cipher",e[e.Upload=8]="Upload",e[e.Save=9]="Save",e[e.TreatProblem=10]="TreatProblem",e[e.TreatProblemSummary=11]="TreatProblemSummary",e[e.Sharing=12]="Sharing",e[e.TeamAdminData=13]="TeamAdminData"}(t.SyncLoggerStep||(t.SyncLoggerStep={}))},90635:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.syncTypeForSyncLogger=void 0;const o=r(37898),n=r(17825);t.syncTypeForSyncLogger=e=>{switch(e){case o.SyncType.LIGHT_SYNC:return"Light";case o.SyncType.FULL_SYNC:return"Full";case o.SyncType.FIRST_SYNC:return"Initial";default:(0,n.assertUnreachable)(e)}}},98083:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.treatProblemSummaryFinished=t.treatProblemSummaryCompared=t.treatProblemSummaryStarted=t.transactionDuplicated=t.decipherTransactionFinished=t.decipherTransactionFailed=t.decipherTransactionParseFailed=t.decipherTransactionDecipherFailed=t.decipherTransactionStarted=t.decipherFullBackupFinished=t.decipherFullBackupFailed=t.decipherFullBackupItemReadFailed=t.decipherFullBackupItemSkipped=t.decipherFullBackupItemRead=t.decipherFullBackupDecipherFailed=t.decipherFullBackupParseFailed=t.decipherFullBackupStarted=t.decipherFullBackupSkipped=t.cipherFinished=t.transactionCiphered=t.cipherStarted=t.uploadFailed=t.uploadSucceeded=t.uploadRequested=t.syncTypeChanged=t.syncFailed=t.syncFinished=t.decipherTransactionsFinished=t.decipherTransactionsStarted=t.decipherFinished=t.decipherStarted=t.latestFailed=t.latestSucceeded=t.latestRequested=t.teamAdminDataSyncFinished=t.teamAdminDataSyncFailed=t.teamAdminDataSyncStarted=t.sharingSyncFinished=t.sharingSyncFailed=t.sharingSyncInvalidSyncData=t.sharingSyncStarted=t.treatSharingKeysFailed=t.treatProblemFinished=t.treatProblemDiffComputed=t.treatProblemFailed=t.treatProblemStarted=t.chronologicalSyncFinished=t.chronologicalSyncFailed=t.chronologicalSyncStarted=t.syncStarted=void 0,t.saveFinished=t.saveStarted=void 0;const o=r(31982),n=r(90826),a=r(1347),i=r(63002);t.syncStarted=(e,t)=>({type:"SyncStarted",trigger:e,syncType:t});t.chronologicalSyncStarted=e=>({type:"ChronologicalSyncStarted",updatesCount:(0,i.countEditionUploadChanges)(e?.changesToUpload||[]),deletesCount:(0,i.countDeletionUploadChanges)(e?.changesToUpload||[])});t.chronologicalSyncFailed=e=>({type:"ChronologicalSyncFailed",error:e});t.chronologicalSyncFinished=(e,t)=>({type:"ChronologicalSyncFinished",summarySize:(0,o.countSyncSummaryTransactions)(e),fullBackupFileSize:t});t.treatProblemStarted=()=>({type:"TreatProblemStarted"});t.treatProblemFailed=e=>({type:"TreatProblemFailed",error:e});t.treatProblemDiffComputed=(e,t)=>({type:"TreatProblemDiffComputed",transactionsToDownloadCount:e,transactionsToUploadCount:t});t.treatProblemFinished=()=>({type:"TreatProblemFinished"});t.treatSharingKeysFailed=e=>({type:"TreatSharingKeysFailed",error:e});t.sharingSyncStarted=()=>({type:"SharingSyncStarted"});t.sharingSyncInvalidSyncData=(e,t)=>({type:"SharingSyncInvalidSyncData",itemGroupId:e,errorName:t});t.sharingSyncFailed=e=>({type:"SharingSyncFailed",error:e});t.sharingSyncFinished=()=>({type:"SharingSyncFinished"});t.teamAdminDataSyncStarted=()=>({type:"TeamAdminDataSyncStarted"});t.teamAdminDataSyncFailed=e=>({type:"TeamAdminDataSyncFailed",error:e});t.teamAdminDataSyncFinished=()=>({type:"TeamAdminDataSyncFinished"});t.latestRequested=(e,t)=>({type:"LatestRequested",lock:"nolock"!==e,needsKeys:t});t.latestSucceeded=e=>({type:"LatestSucceeded",updatesCount:(0,n.countEditionTransactions)(e.transactionList),deletesCount:(0,n.countRemoveTransactions)(e.transactionList),fullBackupSize:(e.fullBackupFileList||[]).length});t.latestFailed=e=>({type:"LatestFailed",error:e});t.decipherStarted=e=>({type:"DecipherStarted",fullBackupFileSize:e});t.decipherFinished=e=>({type:"DecipherFinished",updatesCount:(0,n.countEditionTransactions)(e),deletesCount:(0,n.countRemoveTransactions)(e)});t.decipherTransactionsStarted=()=>({type:"DecipherTransactionsStarted"});t.decipherTransactionsFinished=()=>({type:"DecipherTransactionsFinished"});t.syncFinished=()=>({type:"SyncFinished"});t.syncFailed=e=>({type:"SyncFailed",error:e});t.syncTypeChanged=e=>({type:"SyncTypeChanged",syncType:e});t.uploadRequested=(e,t)=>({type:"UploadRequested",updatedCount:e,deletedCount:t});t.uploadSucceeded=(e,t,r)=>({type:"UploadSucceeded",updatedCount:e,deletedCount:t,timestamp:r});t.uploadFailed=e=>({type:"UploadFailed",error:e});t.cipherStarted=()=>({type:"CipherStarted"});t.transactionCiphered=(e,t,r)=>({type:"TransactionCiphered",transactionType:e,itemId:t,backupDate:r});t.cipherFinished=()=>({type:"CipherFinished"});t.decipherFullBackupSkipped=()=>({type:"DecipherFullBackupSkipped"});t.decipherFullBackupStarted=()=>({type:"DecipherFullBackupStarted"});t.decipherFullBackupParseFailed=e=>({type:"DecipherFullBackupParseFailed",error:e});t.decipherFullBackupDecipherFailed=(e,t)=>({type:"DecipherFullBackupDecipherFailed",error:e,cryptoPayload:t});t.decipherFullBackupItemRead=(e,t,r)=>({type:"DecipherFullBackupItemRead",itemType:e,itemId:t,backupDate:r});t.decipherFullBackupItemSkipped=(e,t)=>({type:"DecipherFullBackupItemSkipped",itemType:t?.itemType,itemId:t?.itemId,error:e});t.decipherFullBackupItemReadFailed=(e,t)=>({type:"DecipherFullBackupItemReadFailed",error:e,itemId:t});t.decipherFullBackupFailed=e=>({type:"DecipherFullBackupFailed",error:e});t.decipherFullBackupFinished=e=>({type:"DecipherFullBackupFinished",itemsCount:e});t.decipherTransactionStarted=({action:e,backupDate:t,identifier:r,time:o,type:n})=>({type:"DecipherTransactionStarted",time:o,action:e,backupDate:t,identifier:r,transactionType:n});t.decipherTransactionDecipherFailed=(e,t)=>({type:"DecipherTransactionDecipherFailed",error:e,cryptoPayload:t});t.decipherTransactionParseFailed=e=>({type:"DecipherTransactionParseFailed",error:e});t.decipherTransactionFailed=(e,{backupDate:t,identifier:r,type:o})=>({type:"DecipherTransactionFailed",error:e,transactionType:o,identifier:r,backupDate:t});t.decipherTransactionFinished=({action:e,backupDate:t,identifier:r,type:o})=>({type:"DecipherTransactionFinished",action:e,transactionType:o,identifier:r,backupDate:t});t.transactionDuplicated=(e,t,r)=>({type:"TransactionDuplicated",transactionType:e,identifier:t,backupDate:r});t.treatProblemSummaryStarted=(e,t)=>({type:"TreatProblemSummaryStarted",localItemsCount:(0,a.countPersonalDataItems)(e),remoteItemsCount:(0,o.countSyncSummaryTransactions)(t)});t.treatProblemSummaryCompared=(e,t,r,o)=>({type:"TreatProblemSummaryCompared",result:e,transactionType:t,identifier:r,...o?.cause?{cause:o.cause}:{},...o?.localDate?{localDate:o.localDate}:{},...o?.remoteDate?{remoteDate:o.remoteDate}:{}});t.treatProblemSummaryFinished=()=>({type:"TreatProblemSummaryFinished"});t.saveStarted=()=>({type:"SaveStarted"});t.saveFinished=()=>({type:"SaveFinished"})},58582:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.announcements=void 0;const a=r(98083);t.announcements=a,n(r(76921),t)},76921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TreatProblemSummaryComparedCause=t.TreatProblemSummaryComparedResult=void 0,function(e){e[e.UpToDate=0]="UpToDate",e[e.Upload=1]="Upload",e[e.Download=2]="Download"}(t.TreatProblemSummaryComparedResult||(t.TreatProblemSummaryComparedResult={})),function(e){e[e.OutOfDate=0]="OutOfDate",e[e.Missing=1]="Missing"}(t.TreatProblemSummaryComparedCause||(t.TreatProblemSummaryComparedCause={}))},32523:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateLocalDuplicates=void 0;const o=r(62433),n=r(70705),a=r(49551),i=r(78320),s=r(30144),c=r(75270),d=r(53628),l=r(15318),u=(e,t)=>{const r=n.mergingRules[t.type];if(!r||0===r.length)return!1;if(!t.content)return!1;const o=(0,d.fixPersonalDataItemFromExternalSource)(t.content,t.identifier);for(const{property:n,canonize:a}of r){let r=e[n],i=o[n];"Domain"===n&&"AUTHENTIFIANT"===t.type&&r&&i&&(r=new l.ParsedURL(e.Url).getRootDomain(),i=new l.ParsedURL(o.Url).getRootDomain());if((a?(0,s.canonizeText)(r):r)!==(a?(0,s.canonizeText)(i):i))return!0}return!1};t.generateLocalDuplicates=function(e,t,r){return(0,a.filterDataModelObjects)(t,e,["changeHistories"]).reduce(((e,t)=>{const n=(e=>{const t=(0,c.findTransaction)(e.Id,r);return!t||(0,c.isRemovalTransaction)(t)?null:u(e,t)?{duplicate:{...(0,o.clone)(e),Id:(0,i.generateItemUuid)()},duplicatedFromId:e.Id}:null})(t);return n?(e.push(n),e):e}),[])}},70705:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergingRules=void 0,t.mergingRules={ADDRESS:[{property:"AddressFull",canonize:!1},{property:"City",canonize:!1},{property:"ZipCode",canonize:!0}],AUTHENTIFIANT:[{property:"Domain",canonize:!1},{property:"Email",canonize:!1},{property:"Login",canonize:!1},{property:"Note",canonize:!1},{property:"OtpSecret",canonize:!1},{property:"OtpUrl",canonize:!1},{property:"Password",canonize:!1},{property:"SubdomainOnly",canonize:!1},{property:"Title",canonize:!1},{property:"TrustedUrl",canonize:!1},{property:"UseFixedUrl",canonize:!1}],BANKSTATEMENT:[{property:"BankAccountIBAN",canonize:!0}],COMPANY:[{property:"Name",canonize:!1},{property:"JobTitle",canonize:!1}],DATA_CHANGE_HISTORY:[{property:"ObjectId",canonize:!0}],DRIVERLICENCE:[{property:"Number",canonize:!0}],EMAIL:[{property:"Email",canonize:!0}],FISCALSTATEMENT:[{property:"FiscalNumber",canonize:!0},{property:"TeledeclarantNumber",canonize:!0}],GENERATED_PASSWORD:[{property:"Domain",canonize:!1},{property:"GeneratedDate",canonize:!1},{property:"Password",canonize:!1}],IDCARD:[{property:"Number",canonize:!0}],IDENTITY:[{property:"FirstName",canonize:!1},{property:"LastName",canonize:!1}],PASSPORT:[{property:"Number",canonize:!0}],PAYMENTMEAN_PAYPAL:[{property:"Login",canonize:!1},{property:"Password",canonize:!1}],PAYMENTMEANS_CREDITCARD:[{property:"Bank",canonize:!0},{property:"CardNumber",canonize:!0},{property:"CardNumberLastDigits",canonize:!0},{property:"ExpireMonth",canonize:!0},{property:"ExpireYear",canonize:!0},{property:"OwnerName",canonize:!0}],PERSONALWEBSITE:[{property:"Website",canonize:!1}],PHONE:[{property:"Number",canonize:!0}],PURCHASE_CATEGORY:[{property:"CategoryName",canonize:!1}],PURCHASEBASKET:[{property:"Id",canonize:!1}],PURCHASEPAIDBASKET:[{property:"AutoTitle",canonize:!1},{property:"Comment",canonize:!1},{property:"DeliveryAddressDescription",canonize:!1},{property:"DeliveryAddressName",canonize:!1},{property:"MerchantDomain",canonize:!0},{property:"PaymentMeanDescription",canonize:!1},{property:"PaymentMeanName",canonize:!1},{property:"PurchaseDate",canonize:!0},{property:"TotalAmount",canonize:!0},{property:"UserTitle",canonize:!1}],SECURENOTE:[{property:"Title",canonize:!1},{property:"Content",canonize:!1}],SOCIALSECURITYSTATEMENT:[{property:"SocialSecurityNumber",canonize:!0}]}},96457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeChangeHistories=void 0;const o=r(62433);t.mergeChangeHistories=function(e,t){const r=(0,o.eqBy)((0,o.prop)("Id")),n=(0,o.ascend)((0,o.prop)("ModificationDate")),a=(0,o.unionWith)(r,e.ChangeSets,t.ChangeSets);return{...e,ChangeSets:(0,o.sort)(n,a)}}},1947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeLocalAndRemote=t.getMergeableTransactions=t.supportedTransactionTypesForMerge=t.unMergeableTransaction=void 0;const o=r(62433),n=r(96457),a=r(75270);t.unMergeableTransaction=["DEFAULT_AUTHENTIFIANT","DEFAULT_CONFIDENTIAL","DEFAULT_IDENTITY","DEFAULT_PAYMENTMEANS","DEFAULT_MISC","DEFAULT_REWARDCARD","POINTS","SETTINGS","SECURITYALERTS"],t.supportedTransactionTypesForMerge=["DATA_CHANGE_HISTORY"],t.getMergeableTransactions=function(e,r){const n=(0,o.map)((0,o.prop)("itemId"),r);return e.filter((e=>!t.unMergeableTransaction.includes(e.type))).filter((e=>"BACKUP_REMOVE"!==e.action)).filter((e=>n.includes(e.identifier))).filter((e=>t.supportedTransactionTypesForMerge.includes(e.type)))},t.mergeLocalAndRemote=function(e,t){const r=[],o=e.changeHistories.map((e=>{const o=(0,a.findTransaction)(e.Id,t),i=n.mergeChangeHistories(e,o.content);return r.push({...o,content:i}),i}));return{personalData:{...e,changeHistories:o},remoteTransactions:r}}},37744:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(62433),n=r(45127),a=r(95623),i=r(1347),s=r(70252),c=r(1947),d=r(63002),l=r(75270),u=r(83638),p=r(32523),S=r(58582),m=r(51064);t.default=function(e,t,r,g){const{changesToUpload:y,editConflicts:A,transactionsToDownload:f}=function(e,t,r){if(0===t.length)return{changesToUpload:e,transactionsToDownload:t,editConflicts:[]};const n=(0,o.intersection)((0,o.pluck)("identifier",t),(0,o.pluck)("itemId",e));if(0===e.filter((e=>n.includes(e.itemId))).length)return{changesToUpload:e,transactionsToDownload:t,editConflicts:[]};const a=(0,o.reject)((e=>(0,d.isRemovalUploadChange)(e)&&n.includes(e.itemId)),e),i=(0,o.reject)((e=>((0,l.isRemovalTransaction)(e)||r.has(e.identifier))&&n.includes(e.identifier)),t);return{changesToUpload:a,transactionsToDownload:i,editConflicts:(0,o.intersection)((0,o.pluck)("identifier",i),(0,o.pluck)("itemId",a))}}(t.changesToUpload,g,r);if(0===A.length)return{personalData:{...t,changesToUpload:y},remoteTransactions:[...f]};const E=`[Sync] conflict on local/remote changes, ${A.length} conflicts`;a.default.log(E),(0,s.sendExceptionLog)({error:new Error(E),code:n.ExceptionCriticality.WARNING});const{duplicateObjects:h,uploadChangesWithDuplicates:v,usableRemoteTransactions:T}=function(e,t,r,o,n){if(0===n.length)return{uploadChangesWithDuplicates:r,usableRemoteTransactions:o,duplicateObjects:[]};const a=(0,p.generateLocalDuplicates)(n,t,o),i=a.map((e=>e.duplicate)),s=i.map((e=>({action:"BACKUP_EDIT",backupDate:0,identifier:e.Id,objectType:"transaction",time:Date.now(),type:(0,u.getTransactionTypeFromDataModelType)(e.kwType),content:e})));s.forEach((({backupDate:t,identifier:r,type:o})=>{e(S.announcements.transactionDuplicated(o,r,t))}));const c=a.map((e=>e.duplicatedFromId));return{uploadChangesWithDuplicates:r.filter((e=>!c.includes(e.itemId))).concat(i.map(m.createUploadChangeForItem)),duplicateObjects:i,usableRemoteTransactions:o.filter((e=>!n.includes(e.identifier)||c.includes(e.identifier))).concat(s)}}(e,t,y,f,A),_=(0,i.saveObjects)(t,h),I=c.getMergeableTransactions(T,v);if(0===I.length)return{personalData:{..._,changesToUpload:v},remoteTransactions:[...T]};const C=c.mergeLocalAndRemote(_,I);return{personalData:{...C.personalData,changesToUpload:v},remoteTransactions:[...T,...C.remoteTransactions]}}},67805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSyncEventErrorName=t.getSyncEventExtent=t.createInitialSyncEvent=void 0;const o=r(48062),n=r(45127),a=r(37898),i=r(17825),s=r(92263),c=r(14656),d=r(20750);t.createInitialSyncEvent=(e,r,o)=>({extent:(0,t.getSyncEventExtent)(e),trigger:r,timestamp:o,duration:{sync:0,chronological:0,treat_problem:0,sharing:0}});t.getSyncEventExtent=e=>{switch(e){case a.SyncType.LIGHT_SYNC:return o.Extent.Light;case a.SyncType.FULL_SYNC:return o.Extent.Full;case a.SyncType.FIRST_SYNC:return o.Extent.Initial;default:(0,i.assertUnreachable)(e)}},t.getSyncEventErrorName=function(e){let t=o.ErrorName.Other;return(0,s.isCarbonError)(e)&&(e.errorType===c.HttpError?t=(({errorCode:e})=>e===c.HttpErrorCode.CLIENT_ERROR||e===c.HttpErrorCode.SERVER_ERROR||e===c.HttpErrorCode.STATUS_CODE)(e)?o.ErrorName.HttpStatus:o.ErrorName.HttpIo:e.errorType===d.WSError&&(t=o.ErrorName.ResponseContent)),e instanceof Error&&e?.message&&void 0!==n.AuthenticationCode[e.message]&&(t=o.ErrorName.Authentication),t}},41007:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(37729),t)},37729:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventLoggerSyncMonitor=void 0;const o=r(75439);t.makeEventLoggerSyncMonitor=()=>{let e=(0,o.getEmptyState)();return{monitor:(t,r)=>{e=(0,o.reduceState)(e,t,r)}}}},75439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduceState=t.getEmptyState=void 0;const o=r(67805),n=r(48062),a=(e,t)=>({...e,syncEvent:{...e.syncEvent,...t}}),i=(e,t)=>e>0&&t>0?n.TreatProblem.UploadAndDownload:t>0?n.TreatProblem.Upload:e>0?n.TreatProblem.Download:n.TreatProblem.NotNeeded,s=e=>Date.now()-e;t.getEmptyState=()=>({syncStartTimestamp:null,chronologicalStartTimestamp:null,treatProblemStartTimestamp:null,sharingSyncStartTimestamp:null,syncEvent:null});t.reduceState=(e,t,r)=>{switch(t.type){case"SyncStarted":return((e,{trigger:t,syncType:r},{timestamp:n})=>({...e,syncStartTimestamp:n,syncEvent:(0,o.createInitialSyncEvent)(r,t,Math.floor(n/1e3))}))(e,t,r);case"ChronologicalSyncStarted":return((e,{timestamp:t})=>({...e,chronologicalStartTimestamp:t}))(e,r);case"ChronologicalSyncFinished":return((e,{fullBackupFileSize:t})=>a(e,{duration:{...e.syncEvent.duration,chronological:s(e.chronologicalStartTimestamp)},fullBackupSize:t||0}))(e,t);case"ChronologicalSyncFailed":return(e=>a(e,{duration:{...e.syncEvent.duration,chronological:s(e.chronologicalStartTimestamp)},error:{step:n.ErrorStep.Chronological,name:n.ErrorName.Other}}))(e);case"TreatProblemStarted":return((e,{timestamp:t})=>({...e,treatProblemStartTimestamp:t}))(e,r);case"TreatProblemDiffComputed":return((e,{transactionsToDownloadCount:t,transactionsToUploadCount:r})=>a(e,{treatProblem:i(t,r)}))(e,t);case"TreatProblemFinished":return(e=>a(e,{duration:{...e.syncEvent.duration,treat_problem:s(e.treatProblemStartTimestamp)}}))(e);case"TreatProblemFailed":return(e=>a(e,{duration:{...e.syncEvent.duration,treat_problem:s(e.treatProblemStartTimestamp)},error:{step:n.ErrorStep.TreatProblem,name:n.ErrorName.Other}}))(e);case"TreatSharingKeysFailed":return(e=>a(e,{error:{step:n.ErrorStep.TreatProblem,name:n.ErrorName.Other}}))(e);case"SharingSyncStarted":return((e,{timestamp:t})=>({...e,sharingSyncStartTimestamp:t}))(e,r);case"SharingSyncFinished":return(e=>a(e,{duration:{...e.syncEvent.duration,sharing:s(e.sharingSyncStartTimestamp)}}))(e);case"SharingSyncFailed":return(e=>a(e,{duration:{...e.syncEvent.duration,sharing:s(e.sharingSyncStartTimestamp)},error:{step:n.ErrorStep.Sharing,name:n.ErrorName.Other}}))(e);case"DecipherFinished":return((e,{updatesCount:t,deletesCount:r})=>{const o=e.syncEvent.incomingUpdateCount||0,n=e.syncEvent.incomingDeleteCount||0;return a(e,{incomingUpdateCount:o+t,incomingDeleteCount:n+r})})(e,t);case"UploadSucceeded":return((e,{updatedCount:t,deletedCount:r})=>{const o=e.syncEvent.outgoingUpdateCount||0,n=e.syncEvent.outgoingDeleteCount||0;return a(e,{outgoingUpdateCount:o+t,outgoingDeleteCount:n+r})})(e,t);case"SyncFinished":return(e=>a(e,{duration:{...e.syncEvent.duration,sync:s(e.syncStartTimestamp)}}))(e);case"SyncFailed":return((e,{error:t})=>a(e,{duration:{...e.syncEvent.duration,sync:s(e.syncStartTimestamp)},error:{...e.syncEvent.error,name:(0,o.getSyncEventErrorName)(t)}}))(e,t);case"SyncTypeChanged":return((e,{syncType:t})=>a(e,{extent:(0,o.getSyncEventExtent)(t)}))(e,t)}return e}},75270:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findTransaction=t.isRemovalTransaction=t.isEditionTransaction=t.createNewTransaction=t.getTransactionXml=t.supportedForUploadKwTypeToTransactionTypeMap=t.supportedDataTypesForUpload=void 0;const o=r(62433),n=r(45127),a=r(83638),i=r(95623),s=r(70252),c=r(53),d=r(56668),l=r(61797),u=r(58582);function p(e){return t.supportedForUploadKwTypeToTransactionTypeMap[e.kwType]?(0,l.getDashlaneXml)(e):(i.default.error(`Unsupported kwType "${e.kwType}" for transformation to XML`),"")}t.supportedDataTypesForUpload=["KWAddress","KWAuthentifiant","KWBankStatement","KWCollection","KWCompany","KWDataChangeHistory","KWDriverLicence","KWEmail","KWFiscalStatement","KWGeneratedPassword","KWIdentity","KWIDCard","KWPasskey","KWPassport","KWPaymentMean_creditCard","KWPersonalWebsite","KWPhone","KWSecret","KWSecureFileInfo","KWSecureNote","KWSecurityBreach","KWSettingsManagerApp","KWSocialSecurityStatement"],t.supportedForUploadKwTypeToTransactionTypeMap=(0,o.pick)(t.supportedDataTypesForUpload,a.DATAMODEL_TYPE_TO_TRANSACTION_TYPE),t.getTransactionXml=p,t.createNewTransaction=async function(e,r,o){try{const{itemId:n,kwType:a,content:i}=o,s=t.supportedForUploadKwTypeToTransactionTypeMap[a];if("REMOVE"===o.action){const e={type:s,action:"BACKUP_REMOVE",identifier:n,objectType:"transaction",time:(0,c.getUnixTimestamp)(),backupDate:0,content:""};return Promise.resolve(e)}const l=(0,d.utf16ToDeflatedUtf8)(p(i)),S=await e.encrypt(l),m=0,g={type:s,action:"BACKUP_EDIT",identifier:n,objectType:"transaction",time:(0,c.getUnixTimestamp)(),backupDate:m,content:S};return r(u.announcements.transactionCiphered(s,n,m)),g}catch(e){const t=new Error(`[Sync] - upload: failed to create transaction. ${e}`);return(0,s.sendExceptionLog)({error:t,code:n.ExceptionCriticality.ERROR}),null}};const S=(0,o.propEq)("identifier");t.isEditionTransaction=(0,o.propEq)("action","BACKUP_EDIT"),t.isRemovalTransaction=(0,o.propEq)("action","BACKUP_REMOVE"),t.findTransaction=(0,o.curry)(((e,t)=>(0,o.find)(S(e),t)))},83638:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionType=t.getTransactionTypeFromDataModelType=t.getDataModelTypeFromTransactionType=t.DATAMODEL_TYPE_TO_TRANSACTION_TYPE=void 0;const o=r(45127);Object.defineProperty(t,"DATAMODEL_TYPE_TO_TRANSACTION_TYPE",{enumerable:!0,get:function(){return o.DATAMODEL_TYPE_TO_TRANSACTION_TYPE}}),Object.defineProperty(t,"getDataModelTypeFromTransactionType",{enumerable:!0,get:function(){return o.getDataModelTypeFromTransactionType}}),Object.defineProperty(t,"getTransactionTypeFromDataModelType",{enumerable:!0,get:function(){return o.getTransactionTypeFromDataModelType}}),Object.defineProperty(t,"TransactionType",{enumerable:!0,get:function(){return o.TransactionType}})},90826:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countRemoveTransactions=t.countEditionTransactions=void 0;const r=(e,t)=>e.reduce(((e,r)=>r.identifier&&r.action===t?e+1:e),0);t.countEditionTransactions=e=>r(e,"BACKUP_EDIT");t.countRemoveTransactions=e=>r(e,"BACKUP_REMOVE")},58217:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMissingIdentifiers=void 0;const o=r(45127),n=r(62433),a=r(58582),i=r(51064);t.getMissingIdentifiers=function(e,t,r){e(a.announcements.treatProblemSummaryStarted(t,r));const s=o.transactionTypes.reduce(((s,c)=>{return d=s,l=function(e,t,r,s){const c=o.TRANSACTION_TYPE_TO_DATAMODEL_TYPE[t];if(!c||!o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[c])return{missingLocally:[],missingRemotely:[]};const d=o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[c];if(!r[d])return{missingLocally:[],missingRemotely:[]};const l=s.transactions[t]||{},u=new Set(r.changesToUpload.filter((({kwType:e})=>e===c)).map((({itemId:e})=>e))),p=r[d].filter((({Id:e})=>!u.has(e))),S=Object.keys(l).filter((e=>!u.has(e))),m=(0,n.difference)(S,(0,n.pluck)("Id",p));m.forEach((r=>{e(a.announcements.treatProblemSummaryCompared(a.TreatProblemSummaryComparedResult.Download,t,r,{cause:a.TreatProblemSummaryComparedCause.Missing,remoteDate:l[r]}))}));const g=a.announcements.treatProblemSummaryCompared;return p.reduce(((r,{Id:o,LastBackupTime:n})=>{const s=l[o],d=1e3*n;if(!s||s/1e3<n){const n=s?{remoteDate:s}:{};e(g(a.TreatProblemSummaryComparedResult.Upload,t,o,{cause:s?a.TreatProblemSummaryComparedCause.OutOfDate:a.TreatProblemSummaryComparedCause.Missing,localDate:d,...n}));const l=(0,i.createUploadChange)({action:"EDIT",kwType:c,itemId:o});return{missingLocally:r.missingLocally,missingRemotely:[...r.missingRemotely,l]}}return s/1e3>n?(e(g(a.TreatProblemSummaryComparedResult.Download,t,o,{cause:a.TreatProblemSummaryComparedCause.OutOfDate,localDate:d,remoteDate:s})),{missingLocally:[...r.missingLocally,o],missingRemotely:r.missingRemotely}):(e(g(a.TreatProblemSummaryComparedResult.UpToDate,t,o,{localDate:d})),r)}),{missingLocally:m,missingRemotely:[]})}(e,c,t,r),{missingLocally:[...d.missingLocally,...l.missingLocally],missingRemotely:[...d.missingRemotely,...l.missingRemotely]};var d,l}),{missingLocally:[],missingRemotely:[]});return e(a.announcements.treatProblemSummaryFinished()),s}},63002:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUploadChangesWithoutSettings=t.isSettingUploadChange=t.countDeletionUploadChanges=t.countEditionUploadChanges=t.findUploadChange=t.isRemovalUploadChange=t.isEditionUploadChange=void 0;const o=r(62433),n=(0,o.propEq)("itemId");t.isEditionUploadChange=(0,o.propEq)("action","EDIT"),t.isRemovalUploadChange=(0,o.propEq)("action","REMOVE"),t.findUploadChange=(0,o.curry)(((e,t)=>(0,o.find)(n(e),t)));t.countEditionUploadChanges=e=>e.filter((e=>(0,t.isEditionUploadChange)(e))).length;t.countDeletionUploadChanges=e=>e.filter((e=>(0,t.isRemovalUploadChange)(e))).length,t.isSettingUploadChange=(0,o.propEq)("kwType","KWSettingsManagerApp");t.getUploadChangesWithoutSettings=e=>(0,o.reject)(t.isSettingUploadChange,e)},39048:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UploadChangeStatus=void 0,function(e){e.ReadyForNextSync="ReadyForNextSync",e.ScheduledForSync="ScheduledForSync"}(t.UploadChangeStatus||(t.UploadChangeStatus={}))},62210:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.markChangeAsReadyForNextSync=t.markChangeAsScheduled=t.filterOutUploadedChanges=void 0;const o=r(39048);t.filterOutUploadedChanges=(e,t)=>e.filter((({itemId:e,status:r})=>!t.includes(e)||r!==o.UploadChangeStatus.ScheduledForSync));const n=e=>t=>({...t,status:e});t.markChangeAsScheduled=n(o.UploadChangeStatus.ScheduledForSync),t.markChangeAsReadyForNextSync=n(o.UploadChangeStatus.ReadyForNextSync)},51064:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUploadChangeForDeletion=t.createUploadChangeForItem=t.createUploadChange=void 0;const o=r(39048);t.createUploadChange=({itemId:e,kwType:t,action:r="EDIT",status:n=o.UploadChangeStatus.ReadyForNextSync})=>({itemId:e,kwType:t,action:r,status:n});t.createUploadChangeForItem=e=>(0,t.createUploadChange)((e=>({itemId:e.Id,kwType:e.kwType}))(e));t.createUploadChangeForDeletion=e=>r=>(0,t.createUploadChange)({itemId:r,kwType:e,action:"REMOVE"})},26632:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isUploadNeeded=t.upload=t.gatherContentsToUpload=void 0;const o=r(62433),n=r(45127),a=r(63002),i=r(75270),s=r(90826),c=r(58582),d=Object.keys(i.supportedForUploadKwTypeToTransactionTypeMap),l=(0,o.flip)(o.contains)(d),u=(0,o.compose)(o.uniq,(0,o.filter)((0,o.propSatisfies)(l,"kwType")),(0,o.filter)((0,o.propSatisfies)(Boolean,"itemId")),(0,o.defaultTo)([]));function p(e,t){return u(e.changesToUpload).map((r=>{const{action:i,kwType:s,itemId:c}=r,d=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[s];if((0,a.isRemovalUploadChange)(r))return{action:i,kwType:s,itemId:c,content:null};if("KWSettingsManagerApp"===r.kwType&&"SETTINGS_userId"===c)return{action:i,kwType:s,itemId:c,content:t};const l=(0,o.find)((0,o.propEq)("Id",c),e[d]);return l?{action:i,kwType:s,itemId:c,content:l}:null})).filter(o.identity)}t.gatherContentsToUpload=p;const S=async(e,t,r)=>{t(c.announcements.cipherStarted());const o=r.map((r=>(0,i.createNewTransaction)(e,t,r))),n=await Promise.all(o);return t(c.announcements.cipherFinished()),n.filter(Boolean)};t.upload=async function(e){const{announce:t,cryptoCenterService:r,personalData:o,personalSettings:n}=e,a=p(o,n),i=await S(r,t,a);if(0===i.length)return{uploadedTransactionsId:[]};try{const r=(0,s.countEditionTransactions)(i),o=(0,s.countRemoveTransactions)(i);t(c.announcements.uploadRequested(r,o));const n=await e.ws.backup.upload({login:e.login,uki:e.uki,lock:e.lock,transactions:i,privateKey:e.privateKey,publicKey:e.publicKey}),a=i.reduce(((e,t)=>(t.identifier&&e.push(t.identifier),e)),[]);return t(c.announcements.uploadSucceeded(r,o,n.timestamp)),{uploadedTransactionsId:a,lastSyncTimestamp:Number(n.timestamp),summary:n.summary}}catch(e){throw t(c.announcements.uploadFailed(e)),e}},t.isUploadNeeded=function(e){const t=(0,o.propOr)([],"changesToUpload",e);return 0!==t.length&&u(t).length>0}},31982:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countSyncSummaryTransactions=void 0,t.countSyncSummaryTransactions=function(e){return e?Object.keys(e.transactions).reduce(((t,r)=>t+(Object.keys(e.transactions[r])||[]).length),0):0}},25963:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLastSuccessfulSyncTimestamp=t.sync=t.MAX_SYNC_TIMESTAMP=t.MIN_SYNC_TIMESTAMP=void 0;const o=r(62433),n=r(37898),a=r(36081),i=r(26632),s=r(37744),c=r(95623),d=r(62844),l=r(58582),u=r(35668),p=r(63002),S=r(45291),m=r(70252),g=r(92263),y=(e,t)=>{const r=new Set,o=e&&e.items||[];for(const e of o)e&&"object"==typeof e&&e.id&&r.add(e.id);for(const e of t.items)e&&"object"==typeof e&&e.itemId&&r.add(e.itemId);return r};function A(e,t){const r=Number(t);return""===t||(0,o.isNil)(t)||isNaN(r)?e:r}t.MIN_SYNC_TIMESTAMP=999999999999,t.MAX_SYNC_TIMESTAMP=2070753783e3,t.sync=async function(e){const{announce:r,storeService:f}=e;let E;try{const h=f.getState();!function(e){switch(e.syncType){case n.SyncType.FIRST_SYNC:{if(0!==e.lastSyncTimestamp)throw new Error("Sync Error: lastSyncTimestamp should be 0 on First Sync");const t=(0,p.getUploadChangesWithoutSettings)(e.personalData?.changesToUpload??[]);if(t?.length)throw new Error("Sync Error: should not have changes to upload on First Sync");break}case n.SyncType.LIGHT_SYNC:case n.SyncType.FULL_SYNC:if(null===e.lastSyncTimestamp||e.lastSyncTimestamp<t.MIN_SYNC_TIMESTAMP||e.lastSyncTimestamp>t.MAX_SYNC_TIMESTAMP){const t=new Error("Sync Error: non valid lastSyncTimestamp"),r=g.CarbonError.fromAnyError(t).addContextInfo("SYNC","verifySyncArgs").addAdditionalInfo({libError:`lastSyncTimestamp: ${e.lastSyncTimestamp}`});throw(0,m.sendExceptionLog)({error:r}),t}break;default:{const t=new Error("Sync Error: unexpected syncType"),r=g.CarbonError.fromAnyError(t).addContextInfo("SYNC","verifySyncArgs").addAdditionalInfo({libError:`syncType: ${e.syncType}`});throw(0,m.sendExceptionLog)({error:r}),t}}}(e);const v=e.personalData||f.getPersonalData(),{isUploadEnabled:T}=f.getSyncStatus();c.Debugger.log(`[Sync] User allowed to Upload: ${T}`),T&&(0,i.isUploadNeeded)(v)&&(c.Debugger.log("[Sync] Found local data to upload"),e.syncType=n.SyncType.FULL_SYNC,r(l.announcements.syncTypeChanged(e.syncType))),f.dispatch((0,S.scheduleChangesForSync)()),E=await(0,a.latest)(e);const _=()=>({...(0,o.dissoc)("lock",E),syncType:e.syncType,isUploadEnabled:E.isUploadEnabled,lastSyncTimestamp:A(e.lastSyncTimestamp,E.lastSyncTimestamp),uploadedTransactions:[],summary:E.summary});if((0,d.changeMPinProgressSelector)(h))return await(0,u.unlock)(e,E.lock),_();if(e.syncType!==n.SyncType.FULL_SYNC||!E.isUploadEnabled)return E.isUploadEnabled&&await(0,u.unlock)(e,E.lock),_();const I=y(E.sharing2,f.getSharingData()),{personalData:C,remoteTransactions:P}=(0,s.default)(r,v,I,E.clearTransactions),D=(0,o.isNil)(e.pushKeysToServer)?null:{publicKey:e.pushKeysToServer.public,privateKey:e.pushKeysToServer.private},O={login:e.login,uki:e.uki,lock:E.lock,ws:e.ws,cryptoCenterService:e.dataEncryptorService.getInstance(),personalData:C,personalSettings:f.getPersonalSettings(),...D,announce:r},b=await(0,i.upload)(O);return 0===b.uploadedTransactionsId.length&&(0,u.unlock)(e,E.lock),f.dispatch((0,S.clearUploadedChanges)(b.uploadedTransactionsId)),{...(0,o.dissoc)("lock",E),clearTransactions:P,syncType:e.syncType,isUploadEnabled:E.isUploadEnabled,uploadedTransactions:b.uploadedTransactionsId,lastSyncTimestamp:A(e.lastSyncTimestamp,b.lastSyncTimestamp),summary:b.summary||E.summary}}catch(t){throw E&&await(0,u.unlock)(e,E.lock),t&&t.message,t}finally{f.dispatch((0,S.unscheduleRemainingChanges)())}},t.getLastSuccessfulSyncTimestamp=A},36081:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildFullBackupFileMap=t.buildLatestArgs=t.latest=void 0;const o=r(35088),n=r(62433),a=r(45127),i=r(63713),s=r(95623),c=r(37898),d=r(58582),l=r(35668),u=r(92263),p=r(70252);function S(e){const{lastSyncTimestamp:t,login:r,needsKeys:n,storeService:a,syncType:i,transactionIds:s,uki:d}=e,l=s&&s.length,S={lock:i===c.SyncType.FULL_SYNC||l?(0,o.v4)():"nolock",login:r,needsKeys:n,sharing2:!0,teamAdminGroups:!0,timestamp:t,version:a.getPlatform().info.appVersion,uki:d};switch(s&&(S.transactions=s),i){case c.SyncType.FIRST_SYNC:if(0!==S.timestamp)throw new Error("timestamp should be null for FIRST_SYNC");break;case c.SyncType.LIGHT_SYNC:case c.SyncType.FULL_SYNC:if(isNaN(S.timestamp))S.timestamp=0;else if(null===S.timestamp||S.timestamp<999999999999||S.timestamp>2070753783e3){const e=new Error("non valid lastSyncTimestamp"),t=u.CarbonError.fromAnyError(e).addContextInfo("SYNC","buildLatestArgs").addAdditionalInfo({libError:`lastSyncTimestamp: ${S.timestamp}`});throw(0,p.sendExceptionLog)({error:t}),e}break;default:{const e=new Error("unexpected syncType"),t=u.CarbonError.fromAnyError(e).addContextInfo("SYNC","buildLatestArgs").addAdditionalInfo({libError:`syncType: ${i}`});throw(0,p.sendExceptionLog)({error:t}),e}}return S}function m(e){const t=new Map;return e&&e.forEach((e=>{t.set(e.identifier,e.backupDate)})),t}t.latest=async function(e){const t=S(e),{announce:r}=e;let o;try{const{lock:n,needsKeys:i}=t;if(r(d.announcements.latestRequested(n,i)),o=await e.ws.backup.latest(t),"message"===o.objectType)throw"Incorrect authentification"===o.content?new Error(a.AuthenticationCode[a.AuthenticationCode.INVALID_UKI]):"Temporarily disabled"===o.content?new Error("Sync service unavailable"):new Error(a.AuthenticationCode[a.AuthenticationCode.UNKNOWN_SYNC_ERROR]);if(void 0!==o.objectType)throw new Error("unexpected objectType");if(!o.transactionList)throw s.default.log("Backup sync failed"),new Error("Backup sync failed");if(!function(e){if(e.find((e=>!e.backupDate||e.backupDate<999999999999||e.backupDate>2070753783e3)))return!1;return!0}(o.transactionList))throw new Error("wrongly formatted backupDate")}catch(e){throw r(d.announcements.latestFailed(e)),e}r(d.announcements.latestSucceeded(o));const c=m(o.fullBackupFileList);try{const a=await i.decrypt(e.dataEncryptorService.getInstance(),r,o.fullBackupFile,c,o.transactionList);return{clearTransactions:a,sharing2:o.sharing2,lastSyncTimestamp:o.timestamp,lock:t.lock,keys:o.keys,isUploadEnabled:(0,n.defaultTo)(!1,o.uploadEnabled),summary:o.summary,fullBackupFileSize:c.size}}catch(r){throw(0,l.unlock)(e,t.lock),r}},t.buildLatestArgs=S,t.buildFullBackupFileMap=m},37898:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyncType=void 0,function(e){e[e.FIRST_SYNC=0]="FIRST_SYNC",e[e.LIGHT_SYNC=1]="LIGHT_SYNC",e[e.FULL_SYNC=2]="FULL_SYNC"}(t.SyncType||(t.SyncType={}))},35668:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlock=void 0;const o=r(95623);t.unlock=async function(e,t){if(!function(e){return e&&"nolock"!==e}(t))return;const{login:r,ws:n,uki:a}=e;try{await n.backup.unlock({login:r,uki:a,lock:t})}catch(e){(0,o.logWarn)({tag:"Sync",message:`Unlock failed: ${e}`})}}},59890:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.binaryFindLastIndex=t.binaryFindIndex=t.binaryContains=void 0;const o=r(62433);t.binaryContains=(0,o.curry)((function e(t,r){const o=t.length;if(0===o)return!1;const n=Math.floor(o/2),a=t[n];if(a===r)return!0;if(a<r){return e(t.slice(n+1,o),r)}return e(t.slice(0,n),r)})),t.binaryFindIndex=function e(t,r,o){const n=t.length;if(0===n)return-1;const a=o?Math.min(o,n-1):Math.floor(n/2);if(r(t[a])){const o=e(t.slice(0,a),r);return-1===o?a:o}{const o=e(t.slice(a+1,n),r);return-1===o?-1:a+o+1}},t.binaryFindLastIndex=function e(t,r,o){const n=t.length;if(0===n)return-1;const a=o?Math.min(o,n-1):Math.floor(n/2);if(r(t[a])){const o=e(t.slice(a+1,n),r);return-1===o?a:a+o+1}return e(t.slice(0,a),r)}},72365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDataEncryptorService=t.setObfuscatingKey=void 0;const o=r(56668);t.setObfuscatingKey=function(e){return e.setInstance({raw:[214,238,100,106,146,140,114].concat([110,232,72,104,108,100,204]).map((e=>e/2)).map((e=>String.fromCharCode(e))).join("")},""),e},t.makeDataEncryptorService=function(e){let t=null;return{setInstance:(r,n,a)=>{t=(0,o.makeCryptoCenterService)(r,n,e,a)},getInstance:()=>{if(!t)throw new Error("makeDataEncryptorService: you must call setInstance(password,serverKey) before getting the instance");return t},close:()=>{t=null},hasBeenSet:()=>Boolean(t)}}},56584:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDashlaneSecureDataKWC3ToTransportableData=void 0;const o=r(16038);t.convertDashlaneSecureDataKWC3ToTransportableData=e=>{const t=e.salt,r=(0,o.utf8ToBase64Buffer)(e.version),n=e.encryptedData;return(0,o.concatBuffers)(t,r,n)}},16038:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBufferToHex=t.deflateBuffer=t.removeQtCompressionHeader=t.addQtCompressHeader=t.isBase64Encoded=t.getSubDataByteArray=t.concatBuffers=t.ab2str=t.str2ab=t.base64ToBigInteger=t.pemToSpki=t.spkitoPem=t.pkcs8toPem=t.CrlfToLF=t.pemTopkcs8=t.base64BufferToText=t.utf8ToBase64=t.base64ToUtf8=t.utf8ToBase64Buffer=t.base64BufferToUtf8=t.arrayBufferToText=t.uint8ArrayToText=t.utf8ChunkDecode=t.utf8ChunkEncode=t.base64ToBuffer=t.bufferToBase64=t.applyXorOnBuffers=void 0;const o=r(93513),n=r(63969),a=r(63290),i=r(97224),s=r(10001),c=r(93347),d=r(30543),l=16383,u=Math.pow(10,6),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=new Uint8Array(256);for(let e=0;e<p.length;e++)S[p.charCodeAt(e)]=e;function m(e){const t=e.length,r=[];for(let o=0;o<t;o+=3)r.push(p[e[o]>>2]),r.push(p[(3&e[o])<<4|e[o+1]>>4]),r.push(p[(15&e[o+1])<<2|e[o+2]>>6]),r.push(p[63&e[o+2]]);return r.join("")}function g(e,t=u){const r=new Uint8Array(e),o=r.length,n=t%3,a=0===n?t:t+(3-n),i=Math.ceil(o/a);let s="",c=-1;for(;c++<i;){const e=c*a,t=c===i-1?o:(c+1)*a,n=m(r.slice(e,t));s=s.concat(n)}return o%3==2?s.substring(0,s.length-1)+"=":o%3==1?s.substring(0,s.length-2)+"==":s}function y(e){let t=.75*e.length;const r=e.length;let o,n,a,i,s,c=0;e.endsWith("=")&&(t--,"="===e[e.length-2]&&t--);const d=new ArrayBuffer(t),l=new Uint8Array(d);for(o=0;o<r;o+=4)n=S[e.charCodeAt(o)],a=S[e.charCodeAt(o+1)],i=S[e.charCodeAt(o+2)],s=S[e.charCodeAt(o+3)],l[c++]=n<<2|a>>4,l[c++]=(15&a)<<4|i>>2,l[c++]=(3&i)<<6|63&s;return d}function A(e,t=u){const r=e.length;if(0===r)return"";let o="",n=0,a=Math.min(n+t,r);for(;a<=r;){const i=e.charCodeAt(a-1);if(i>=55296&&i<=56319){if(a++,a>r)throw new Error("Invalid string provided to utf8ChunkEncode");continue}const s=e.slice(n,a),c=d.encode(s);if(o=o.concat(c),a===r)break;n=a,a=Math.min(n+t,r)}return o}function f(e){return e>>6==2}function E(e,t=u){const r=e.length;if(0===r)return"";let o="",n=0,a=Math.min(n+t,r);for(;a<=r;){const s=e.charCodeAt(a-1);if((f(i=s)||function(e){return e>>5==6||e>>4==14||e>>3==30}(i))&&a<r){if(f(e.charCodeAt(a))){a++;continue}}const c=e.slice(n,a),l=d.decode(c);if(o=o.concat(l),a===r)break;n=a,a=Math.min(n+t,r)}var i;return o}function h(e){const t=new Uint16Array(e),r=t.length;let o="",n=l;for(let e=0;e<r;e+=n)e+n>r&&(n=r-e),o+=String.fromCharCode.apply(null,t.subarray(e,e+n));return o}function v(e){return h(new Uint8Array(e))}t.applyXorOnBuffers=function(e,t){if(e.byteLength!==t.byteLength)throw new Error("xorBuffer: buffers are not same length");const r=new Uint8Array(e),o=new Uint8Array(t),n=e.byteLength,a=new Uint8Array(n);for(let e=0;e<n;e++)a[e]=r[e]^o[e];return a.buffer},t.bufferToBase64=g,t.base64ToBuffer=y,t.utf8ChunkEncode=A,t.utf8ChunkDecode=E,t.uint8ArrayToText=h,t.arrayBufferToText=v,t.base64BufferToUtf8=function(e){const t=g(e);return E(o.decode(t))},t.utf8ToBase64Buffer=function(e){const t=A(e);return y(o.encode(t))},t.base64ToUtf8=function(e){return E(o.decode(e))},t.utf8ToBase64=function(e){const t=A(e);return o.encode(t)},t.base64BufferToText=function(e){const t=g(e);return o.decode(t)},t.pemTopkcs8=function(e){const t=n.privateKeyFromPem(e),r=n.privateKeyToAsn1(t),o=n.wrapRsaPrivateKey(r);return T(s.toDer(o).getBytes())};function T(e){const t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;++t)r[t]=e.charCodeAt(t);return t}function _(...e){const t=e.reduce(((e,t)=>e+t.byteLength),0),r=new Uint8Array(t);return e.reduce(((e,t)=>(r.set(new Uint8Array(t),e),e+t.byteLength)),0),r.buffer}t.CrlfToLF=e=>e.replace(/(?:\\[r]|[\r\n]+)+/g,"\n"),t.pkcs8toPem=function(e){const r=new a.ByteBuffer(e),o=s.fromDer(r),i=n.privateKeyFromAsn1(o),c=n.privateKeyToPem(i);return(0,t.CrlfToLF)(c)},t.spkitoPem=function(e){const r=new a.ByteBuffer(e),o=s.fromDer(r),i=n.publicKeyFromAsn1(o),c=n.publicKeyToRSAPublicKeyPem(i);return(0,t.CrlfToLF)(c)},t.pemToSpki=function(e){const t=n.publicKeyFromPem(e),r=n.publicKeyToAsn1(t);return T(s.toDer(r).getBytes())},t.base64ToBigInteger=function(e){const t=(e+"===".slice((e.length+3)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=a.decode64(t);return new i.BigInteger(a.bytesToHex(r),16)},t.str2ab=T,t.ab2str=v,t.concatBuffers=_,t.getSubDataByteArray=function(e,t,r){return e.slice(t,r)},t.isBase64Encoded=function(e){return e&&/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/.test(e)},t.addQtCompressHeader=function(e){var t;return _((t=e.byteLength,new Uint8Array([(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]).buffer),e)},t.removeQtCompressionHeader=function(e){return e.slice(4)},t.deflateBuffer=function(e){return c.deflate(new Uint8Array(e),{level:7}).buffer},t.convertBufferToHex=function(e){return Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")}},55623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomValues=void 0;const o=r(81106);t.getRandomValues=function(e){return(0,o.getWebCrypto)().getRandomValues(new Uint8Array(e))}},3678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.jwkToSpki=t.evpBytesToKey=void 0;const o=r(63969),n=r(10001),a=r(46445),i=r(16038);t.evpBytesToKey=async function(e){const{derivedKey:t,salt:r,keyLength:o,ivLength:n}=e,s=(0,i.concatBuffers)(t,r.slice(0,8)),c=await(0,a.computeHashSha1)(s),d=await(0,a.computeHashSha1)((0,i.concatBuffers)(c,s)),l=await(0,a.computeHashSha1)((0,i.concatBuffers)(d,s)),u=(0,i.concatBuffers)(c,d,l);return Promise.resolve(u.slice(o,o+n))};t.jwkToSpki=e=>{const{modulus:t,exponent:r}=e,a=o.setRsaPublicKey((0,i.base64ToBigInteger)(t),(0,i.base64ToBigInteger)(r)),s=o.publicKeyToAsn1(a),c=n.toDer(s).getBytes();return(0,i.str2ab)(c)}},64910:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNoDerivationCryptoConfig=void 0;const o=r(65675),n=r(91301);t.getNoDerivationCryptoConfig=function(){return(0,o.parsePayload)(n.CRYPTO_NODERIVATION_HMAC64).cryptoConfig}},81106:(e,t)=>{function r(){return self.crypto||null}Object.defineProperty(t,"__esModule",{value:!0}),t.getWebCryptoSubtle=t.getWebCrypto=void 0,t.getWebCrypto=r,t.getWebCryptoSubtle=function(){const e=r();return e?e.subtle?e.subtle:e.webkitSubtle?e.webkitSubtle:null:null}},33769:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateLocalkeyAndSetupEncryptorService=t.getEncryptionKeyBuffer=void 0;const o=r(64910),n=r(16038),a=r(69530),i=r(16356),s=r(25576);t.getEncryptionKeyBuffer=function(e,t,r){if(r.skipDerivation){if(e.byteLength<64)throw new Error(`createEncryptionKey: password should be at least 64 bytes long but is: ${e.byteLength}`);return(0,n.applyXorOnBuffers)(e,t)}return(0,n.concatBuffers)(t,e)},t.generateLocalkeyAndSetupEncryptorService=async function(e,t,r,c){const d=await(0,a.generate64BytesKey)(),l=(0,n.base64BufferToText)(d),u=(0,o.getNoDerivationCryptoConfig)();e.setInstance({raw:l},"",u),t.dispatch((0,i.updateLocalKey)(l)),c===s.PersistData.PERSIST_DATA_YES&&await r.getInstance().user.persistLocalKey(l)}},83570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetDerivateKeyWithCacheAndQueue=void 0;const o=r(65675),n=r(16038),a=r(86723),i=r(46445);t.makeGetDerivateKeyWithCacheAndQueue=function(){const e=new Map,t=new Map;function r(t){return e.get(t)}function s(r,o){const n=t.get(r);n&&n.forEach((({resolve:e})=>e(o))),t.set(r,[]),e.set(r,o)}function c(r,o,n,i){return new Promise(((c,d)=>{const l=t.get(r)||[];l.push({resolve:c,reject:d}),t.set(r,l);const u=e.get(r);if(u)s(r,u);else if(1===l.length){({pbkdf2:a.deriveKeyWithPBKDF2,argon2d:a.deriveKeyWithArgon2d})[i.method](o,n,i).then((e=>{s(r,e)})).catch((o=>{!function(r,o){const n=t.get(r);n&&n.forEach((({reject:e})=>e(o))),t.set(r,[]),e.delete(r)}(r,o)}))}}))}return(e,t,a)=>function(e,t,r,a,s){return function(e,t,r){if((0,o.isNoDerivation)(r))return Promise.resolve((0,n.arrayBufferToText)(e));const a=(0,o.isPbkdf2Derivation)(r)?r.iterations:r.t_cost;return new Promise(((o,s)=>{(0,i.computeHashSha256)((0,n.str2ab)(`${(0,n.arrayBufferToText)(e)}_${(0,n.arrayBufferToText)(t)}_${r.method}_${a}`)).then((e=>(0,n.arrayBufferToText)(e))).then(o,s)}))}(r,a,s).then((o=>{const n=e(o);return n||t(o,r,a,s)}))}(r,c,e,t,a)}},56984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verify=t.sign=t.decrypt=t.encrypt=t.generateRsaOaepKeyPair=t.DefaultAsymmetricOptions=t.HashAlgorithm=t.RSASA_PKCS1=t.RSA_OAEP=void 0;const o=r(16038);t.RSA_OAEP="RSA-OAEP",t.RSASA_PKCS1="RSASSA-PKCS1-v1_5";const n=new Uint8Array([1,0,1]);var a;!function(e){e.SHA_1="SHA-1",e.SHA_256="SHA-256"}(a=t.HashAlgorithm||(t.HashAlgorithm={})),t.DefaultAsymmetricOptions={hashAlgorithm:a.SHA_256};const i=e=>({name:t.RSASA_PKCS1,hash:{name:e}}),s=e=>({name:t.RSA_OAEP,hash:{name:e}});t.generateRsaOaepKeyPair=async(e=a.SHA_256)=>{const r=await self.crypto.subtle.generateKey({name:t.RSA_OAEP,modulusLength:2048,publicExponent:n,hash:{name:e}},!0,["encrypt","decrypt"]),{publicKey:i,privateKey:s}=await async function({privateKey:e,publicKey:t}){return{privateKey:await self.crypto.subtle.exportKey("pkcs8",e),publicKey:await self.crypto.subtle.exportKey("spki",t)}}({...r});return function({publicKey:e,privateKey:t}){return{publicKey:(0,o.spkitoPem)(e),privateKey:(0,o.pkcs8toPem)(t)}}({publicKey:i,privateKey:s})},t.encrypt=async function({publicKey:e,data:r,options:o=t.DefaultAsymmetricOptions}){const n=await self.crypto.subtle.importKey("spki",e,s(o.hashAlgorithm),!1,["encrypt"]);return await self.crypto.subtle.encrypt(s(o.hashAlgorithm),n,r)},t.decrypt=async function({privateKey:e,data:r,options:o=t.DefaultAsymmetricOptions}){const n=await self.crypto.subtle.importKey("pkcs8",e,s(o.hashAlgorithm),!1,["decrypt"]);return await self.crypto.subtle.decrypt(s(o.hashAlgorithm),n,r)},t.sign=async function({privateKey:e,data:r,options:o=t.DefaultAsymmetricOptions}){const n=await self.crypto.subtle.importKey("pkcs8",e,i(o.hashAlgorithm),!1,["sign"]);return await self.crypto.subtle.sign(i(o.hashAlgorithm),n,r)},t.verify=async function({publicKey:e,signature:r,data:o,options:n=t.DefaultAsymmetricOptions}){const a=await self.crypto.subtle.importKey("spki",e,i(n.hashAlgorithm),!1,["verify"]);return await self.crypto.subtle.verify(i(n.hashAlgorithm),a,r,o)}},73626:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithArgon2d=void 0;const o=r(12206),n=r(95623),a=r(70252),i=r(35558);t.deriveKeyWithArgon2d=async(e,t,r)=>{try{if(null===e||null===t||null===r)throw new Error("deriveKeyWithArgon2d parameters are null");if(!o.env.isBrowserEnvironment()&&!o.env.isWorkerEnvironment())throw new Error("Environment is not supported");return(async(e,t,r)=>{const o={argon2d:i.ArgonType.Argon2d,argon2i:i.ArgonType.Argon2i},{hash:n}=await(0,i.hash)({pass:new Uint8Array(e),salt:new Uint8Array(t),time:r.t_cost,mem:r.m_cost,hashLen:32,parallelism:r.parallelism,type:o[r.method]});return n})(e,t,r)}catch(e){const t=new Error(`[Derivation] - deriveKeyWithArgon2d: ${e}`);throw n.Debugger.error(t),(0,a.sendExceptionLog)({error:t}),e}}},86723:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithArgon2d=t.deriveKeyWithPBKDF2=void 0;var o=r(33713);Object.defineProperty(t,"deriveKeyWithPBKDF2",{enumerable:!0,get:function(){return o.deriveKeyWithPBKDF2}});var n=r(73626);Object.defineProperty(t,"deriveKeyWithArgon2d",{enumerable:!0,get:function(){return n.deriveKeyWithArgon2d}})},33713:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deriveKeyWithPBKDF2=void 0;const o=r(81106),n=r(975),a=r(95623),i=r(4673),s=r(70252),c={sha1:"SHA-1",sha256:"SHA-256"};t.deriveKeyWithPBKDF2=async(e,t,r)=>{if(null===e||null===t||null===r)throw new Error("deriveKeyWithPBKDF2 parameters are null");const d=(0,i.getPlugins)().pbkdf2Plugin;if(d)return new Promise((o=>{o(d.deriveKey(new Uint8Array(e),new Uint8Array(t),r.iterations,r.hashMethod?c[r.hashMethod]:"SHA-256",32).buffer)}));const l=(0,o.getWebCryptoSubtle)();try{const o=await l.importKey("raw",e,"PBKDF2",!1,["deriveKey"]);return await l.deriveKey({name:"PBKDF2",salt:t,iterations:r.iterations,hash:{name:r.hashMethod?c[r.hashMethod]:"SHA-256"}},o,{name:n.AES_CBC,length:256},!0,["encrypt","decrypt"]).then((e=>l.exportKey("raw",e)))}catch(e){const t=new Error(`[Derivation] - deriveKeyWithPBKDF2: ${e}`);throw a.Debugger.error(t),(0,s.sendExceptionLog)({error:t}),e}}},46445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hashAndSplitKey=t.computeHashMD5=t.computeHashSha512=t.computeHashSha256=t.computeHashSha1=void 0;const o=r(30960),n=r(16038);async function a({hashAlgorithm:e,data:t}){return await self.crypto.subtle.digest({name:e},t)}async function i(e){return await a({hashAlgorithm:"SHA-512",data:e})}t.computeHashSha1=async function(e){return await a({hashAlgorithm:"SHA-1",data:e})},t.computeHashSha256=async function(e){return await a({hashAlgorithm:"SHA-256",data:e})},t.computeHashSha512=i;t.computeHashMD5=e=>{const t=o.create();return t.update(e),t.digest().toHex()},t.hashAndSplitKey=async function(e){const t=await i(e),r=t.byteLength,o=(0,n.getSubDataByteArray)(new Uint8Array(t),0,r/2),a=(0,n.getSubDataByteArray)(new Uint8Array(t),r/2,r);return{aes:o.buffer,hmac:a.buffer}}},69530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verifyHashHmacSHA256=t.signHashHmacSHA256=t.decryptAES256=t.encryptAES256=t.importKeyAES256=t.generate64BytesKey=t.generateAESKey=void 0;const o=r(16038),n="AES-CBC",a=256,i={name:"HMAC",hash:{name:"SHA-256"}};async function s(){const e=await self.crypto.subtle.generateKey({name:n,length:a},!0,["encrypt","decrypt"]);return await self.crypto.subtle.exportKey("raw",e)}async function c(e){return await self.crypto.subtle.importKey("raw",e,n,!1,["encrypt","decrypt"])}async function d(e){return await self.crypto.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!0,["sign","verify"])}t.generateAESKey=s,t.generate64BytesKey=async function(){const e=await s(),t=await s();return(0,o.concatBuffers)(e,t)},t.importKeyAES256=c,t.encryptAES256=async function({key:e,iv:t,clearData:r}){const o=await c(e);return await self.crypto.subtle.encrypt({name:n,iv:t},o,r)},t.decryptAES256=async function({key:e,iv:t,encryptedData:r}){const o=await c(e);return await self.crypto.subtle.decrypt({name:n,iv:t},o,r)},t.signHashHmacSHA256=async function({key:e,data:t}){const r=await d(e);return await self.crypto.subtle.sign(i,r,t)},t.verifyHashHmacSHA256=async function({key:e,signature:t,data:r}){const o=await d(e);return await self.crypto.subtle.verify(i,o,t,r)}},975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AES_KEY_SIZE=t.AES_CBC=void 0,t.AES_CBC="AES-CBC",t.AES_KEY_SIZE=32},36513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAsymmetricEncryption=t.makeSymmetricEncryption=t.makeCryptoService=void 0;const o=r(93347),n=r(56668),a=r(45127),i=r(61797),s=r(69530),c=r(27993),d=r(56984),l=r(16038),u=r(3678),p=r(46445),S=r(63985);t.makeCryptoService=()=>({symmetricEncryption:(0,t.makeSymmetricEncryption)(),asymmetricEncryption:(0,t.makeAsymmetricEncryption)()});async function m(e,t){const r=(0,l.base64ToBuffer)(t),o=(0,l.base64ToBuffer)(e),n=await(0,p.hashAndSplitKey)(o),a=(0,c.parseDashlaneKw5SecureData)(new Uint8Array(r)),i=(0,l.concatBuffers)(a.iv,a.secured),d=await(0,s.signHashHmacSHA256)({key:n.hmac,data:i});if((0,l.bufferToBase64)(d)!==(0,l.bufferToBase64)(a.hash))throw new Error("Sharing - Data has been tampered with");return(0,s.decryptAES256)({key:n.aes,iv:a.iv,encryptedData:a.secured})}t.makeSymmetricEncryption=()=>({generateNewAESKey:()=>(0,s.generateAESKey)().then(l.bufferToBase64),encryptAES256:async(e,t)=>{const r=(0,l.base64ToBuffer)(t),o=(0,l.base64ToBuffer)(e),n=await(0,p.hashAndSplitKey)(o),a=(0,c.generateIV)();return(0,s.encryptAES256)({key:n.aes,iv:a,clearData:r}).then((async e=>{const t=(0,l.concatBuffers)(a,e),o=await(0,s.signHashHmacSHA256)({key:n.hmac,data:t}),i=(0,c.makeKWC5DashlaneSecureData)(r,e,a,o),d=(0,c.convertKw5ToTransportableData)(i);return(0,l.bufferToBase64)(d)}))},encryptSharingItem:async(e,r)=>{const n=(0,t.makeSymmetricEncryption)(),a=(0,i.getDashlaneXml)(r),s=(0,l.utf8ToBase64)(a),c=(0,l.base64ToBuffer)(s),d=o.deflate(new Uint8Array(c)).buffer,u=(0,l.addQtCompressHeader)(d),p=(0,l.bufferToBase64)(u);return n.encryptAES256(e,p)},decryptAES256:async(e,t)=>{const r=await m(e,t);let o="";try{o=(0,l.base64BufferToUtf8)(r)}catch{o=(0,l.bufferToBase64)(r)}return o},decryptSharingItem:async(e,t)=>{const r=await m(e,t);try{const e=new Uint8Array(r),t=(0,l.uint8ArrayToText)(e);return JSON.parse(t)}catch{const e=(0,n.deflatedUtf8ToUtf16)(r),{__type__:t,...o}=await(0,i.parseDashlaneXml)(e),s={...o,kwType:o.kwType||t};return(0,a.isCredential)(s)?(0,S.fixCredentialTypesFromTransaction)(s):(0,a.isNote)(s)?(0,S.fixNoteTypesFromTransaction)(s):s}},signHmacSHA256:(e,t)=>{const r=(0,l.base64ToBuffer)(t),o=(0,l.base64ToBuffer)(e);return(0,s.signHashHmacSHA256)({key:o,data:r}).then((e=>(0,l.bufferToBase64)(e)))},verifyHmacSHA256:(e,t,r)=>{const o=(0,l.base64ToBuffer)(r),n=(0,l.base64ToBuffer)(e),a=(0,l.base64ToBuffer)(t);return(0,s.verifyHashHmacSHA256)({key:n,signature:a,data:o})}});t.makeAsymmetricEncryption=(e=d.DefaultAsymmetricOptions)=>({generateRsaKeyPair:()=>(0,d.generateRsaOaepKeyPair)(e.hashAlgorithm),encrypt:(t,r)=>{const o=(0,l.base64ToBuffer)(r),n=(0,l.pemToSpki)(t);return(0,d.encrypt)({publicKey:n,data:o,options:e}).then(l.bufferToBase64)},decrypt:(t,r)=>{const o=(0,l.base64ToBuffer)(r),n=(0,l.pemTopkcs8)(t);return(0,d.decrypt)({privateKey:n,data:o,options:e}).then(l.bufferToBase64)},sign:(t,r)=>{const o=(0,l.pemTopkcs8)(t),n=(0,l.base64ToBuffer)(r);return(0,d.sign)({privateKey:o,data:n,options:e}).then(l.bufferToBase64)},verify:(t,r,o)=>{const n=(0,l.pemToSpki)(t),a=(0,l.base64ToBuffer)(o),i=(0,l.base64ToBuffer)(r);return(0,d.verify)({publicKey:n,signature:i,data:a,options:e})},verifyJwk:(t,r,o)=>{const n=(0,u.jwkToSpki)(t),a=(0,l.base64ToBuffer)(r),i=(0,l.base64ToBuffer)(o);return(0,d.verify)({publicKey:n,signature:a,data:i,options:e})}})},1860:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeKeyBasedCrypto=t.makeKeyDataEncryptorService=t.DATA_TAMPERED_ERROR=void 0;const o=r(95623),n=r(70252),a=r(16038),i=r(46445),s=r(27993),c=r(69530);t.DATA_TAMPERED_ERROR="KeyBasedCrypto - Data has been tampered with",t.makeKeyDataEncryptorService=function(){let e=null;return{setInstance:r=>{e=(0,t.makeKeyBasedCrypto)(r)},getInstance:()=>{if(!e)throw new Error("makeKeyDataEncryptorService: you must call setInstance(password,serverKey) before getting the instance");return e},close:()=>{e=null},hasBeenSet:()=>Boolean(e)}};t.makeKeyBasedCrypto=e=>{const r=function(e){return e.raw&&(0,a.isBase64Encoded)(e.raw)?(0,a.base64ToBuffer)(e.raw):e.raw?(0,a.str2ab)(e.raw):e.buffer}(e);return{isKey:()=>{throw new Error("makeKeyBasedCrypto:isKey not implemented")},encrypt:e=>Promise.resolve().then((()=>(0,i.hashAndSplitKey)(r).then((t=>{const r=(0,s.generateIV)();return(0,c.encryptAES256)({key:t.aes,iv:r,clearData:e}).then((o=>{const n=(0,a.concatBuffers)(r,o);return(0,c.signHashHmacSHA256)({key:t.hmac,data:n}).then((t=>{const n=(0,s.makeKWC5DashlaneSecureData)(e,o,r,t),i=(0,s.convertKw5ToTransportableData)(n);return(0,a.bufferToBase64)(i)}))}))})))).catch((e=>(function(e,t){const r=new Error(`${e}: ${t}`);throw(0,n.sendExceptionLog)({error:r}),o.Debugger.log(r),r}("[makeKeyBasedCrypto] - Error while encrypting data.",e),null))),decrypt:e=>Promise.resolve().then((()=>{const o=(0,a.base64ToBuffer)(e);return(0,i.hashAndSplitKey)(r).then((e=>{const r=(0,s.parseDashlaneKw5SecureData)(new Uint8Array(o)),n=(0,a.concatBuffers)(r.iv,r.secured);return(0,c.signHashHmacSHA256)({key:e.hmac,data:n}).then((o=>{if((0,a.bufferToBase64)(o)!==(0,a.bufferToBase64)(r.hash))throw new Error(t.DATA_TAMPERED_ERROR);return(0,c.decryptAES256)({key:e.aes,iv:r.iv,encryptedData:r.secured})}))}))})),prepareCrypto:()=>Promise.resolve(),readCryptoPayload:e=>{const t=(0,a.base64ToBuffer)(e);return(0,s.parseDashlaneKw5SecureData)(new Uint8Array(t)).version}}}},91301:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CRYPTO_NODERIVATION_HMAC64=void 0,t.CRYPTO_NODERIVATION_HMAC64="$1$noderivation$aes256$cbchmac64$16$"},56668:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.prepareCrypto=t.deflatedUtf8ToUtf16=t.utf16ToDeflatedUtf8=t.inflateUtf16=t.deflateUtf16=t.cipherDashlaneSecureData=t.decipherDashlaneSecureData=t.makeCryptoCenterService=t.PBKDF2_DEFAULT_PAYLOAD=t.ARGON2_DEFAULT_PAYLOAD=void 0;const o=r(93347),n=r(62802),a=r(16038),i=r(3678),s=r(65675);Object.defineProperty(t,"ARGON2_DEFAULT_PAYLOAD",{enumerable:!0,get:function(){return s.ARGON2_DEFAULT_PAYLOAD}}),Object.defineProperty(t,"PBKDF2_DEFAULT_PAYLOAD",{enumerable:!0,get:function(){return s.PBKDF2_DEFAULT_PAYLOAD}});const c=r(69530),d=r(46445),l=r(55623),u=r(56584),p=r(83570),S=r(95623),m=r(16356),g=r(27517);function y(e,t,r){const o=t+r;return(0,s.isCryptoConfigKWC3)(e.derivation)?(0,a.str2ab)(o):(0,a.utf8ToBase64Buffer)(o)}t.makeCryptoCenterService=function(e,r,o,n){const i=(0,p.makeGetDerivateKeyWithCacheAndQueue)(),c=e.raw,d=(0,a.str2ab)(r+c);return{isKey:(e,t)=>e+t===r+c,decrypt:(e,o={})=>(0,t.decipherDashlaneSecureData)(e,c,r,i,o),encrypt:(e,a={})=>{const{cryptoConfig:s}=a,d=s||n,l={...a,cryptoConfig:d};return(0,t.cipherDashlaneSecureData)(c,r,e,o,i,l)},prepareCrypto:()=>T(o,d,i,n),readCryptoPayload:e=>(0,s.readCryptoPayload)(e)}};t.decipherDashlaneSecureData=async(e,t,r,o,n={})=>{const{forceKeyKWC5:i,forceSalt:d}=n,l=(0,a.base64ToBuffer)(e),u=(0,s.parseCipheredData)(new Uint8Array(l)),p=u.cryptoConfig;let S,m;if(((0,s.isDashlaneSecureDataFlexible)(u)||(0,s.isDashlaneSecureDataKWC3)(u))&&(S=d||u.salt),(0,s.isDashlaneSecureDataKWC5)(u)&&i)m=i;else if((0,s.isNoDerivation)(p.derivation))m=(0,a.str2ab)(t);else{const e=y(p,r,t);m=await o(e,S,p.derivation)}const g=await async function(e,t,r){return"evpByteToKey"===e.cryptoConfig.ciphering.options.ivGeneration.method?A(e.cryptoConfig,t,r):(0,s.isDashlaneSecureDataFlexible)(e)||(0,s.isDashlaneSecureDataKWC5)(e)?e.iv:void 0}(u,S,m),{signatureKey:h,cipheringKey:v}=await f(u.cryptoConfig,m);return await E(u,h,g),await(0,c.decryptAES256)({key:v,iv:g,encryptedData:u.cipheredContent})};const A=async(e,t,r)=>{const o={derivedKey:r,salt:t,keyLength:32,ivLength:e.ciphering.options.ivLength};return(0,i.evpBytesToKey)(o)},f=async(e,t)=>{if("skip"===e.signature.method)return{signatureKey:new ArrayBuffer(0),cipheringKey:t};const r="hmac64"===e.signature.method?t:await(0,d.computeHashSha512)(t);if(64!==r.byteLength)throw new Error(`[cryptoCenter][prepareKeys] - cryptoKey's length must be 64B but is ${r.byteLength}B`);return{cipheringKey:(0,a.getSubDataByteArray)(new Uint8Array(r),0,r.byteLength/2).buffer,signatureKey:(0,a.getSubDataByteArray)(new Uint8Array(r),r.byteLength/2,r.byteLength).buffer}},E=(e,t,r)=>{if("skip"===e.cryptoConfig.signature.method)return Promise.resolve();const o=(0,a.concatBuffers)(r,e.cipheredContent),n=e;return(0,c.signHashHmacSHA256)({key:t,data:o}).then((e=>{if((0,a.bufferToBase64)(e)!==(0,a.bufferToBase64)(n.hash))throw new Error("[decipherFlexibleMarker] Data are corrupted: HMAC signature cannot be verified")}))};t.cipherDashlaneSecureData=async(e,t,r,o,n,i={})=>{const{cryptoConfig:d,forceSalt:u,forceIv:p}=i,S=d||(0,s.getCryptoConfig)(o);let m,g;if((0,s.isNoDerivation)(S.derivation))m=(0,a.str2ab)(e);else{g=u||_(o,S.derivation);const r=y(S,t,e);m=await n(r,g,S.derivation)}const E=p||await async function(e,t,r){const o=e.ciphering.options.ivGeneration.method;if("evpByteToKey"===o)return A(e,t,r);return(0,l.getRandomValues)(e.ciphering.options.ivLength)}(S,g,m),{signatureKey:T,cipheringKey:I}=await f(S,m),C=await(0,c.encryptAES256)({key:I,iv:E,clearData:r}),P=await h(C,S,T,E);return v(g,E,P,C,S)};t.deflateUtf16=e=>o.deflate(e,{level:7});t.inflateUtf16=e=>{const t=new Uint8Array(e);return o.inflate(t,{to:"string"})};t.utf16ToDeflatedUtf8=(e,t={})=>{const{skipDeflate:r,skipUtf8Encoding:o}=t,n=o?e:(0,a.utf8ChunkEncode)(e),i=(0,a.str2ab)(n);return r?i:(0,a.addQtCompressHeader)((0,a.deflateBuffer)(i))};t.deflatedUtf8ToUtf16=(e,t={})=>{const{skipUtf8Decoding:r,skipInflate:i,unescapeXml:s}=t,c=new Uint8Array(e),d=i?c:(e=>{const t=(0,a.removeQtCompressionHeader)(e),r=Math.pow(2,14)-1,i=new o.Inflate({chunkSize:r});if(i.push(t,n.Z_FINISH),i.err)throw new Error(`[Crypto] - postTreatData: unable to uncompress data - ${i.msg} (code ${i.err})`);return i.result})(c);let l=(0,a.uint8ArrayToText)(d);if(s&&(l=decodeURI(l)),!r)try{l=(0,a.utf8ChunkDecode)(l)}catch(e){S.Debugger.log("Cannot utf8.decode "+e)}return l};const h=(e,t,r,o)=>{if("skip"===t.signature.method)return Promise.resolve().then((()=>new ArrayBuffer(0)));const n=(0,a.concatBuffers)(o,e);return(0,c.signHashHmacSHA256)({key:r,data:n})},v=(e,t,r,o,n)=>{if((0,s.isCryptoConfigKWC3)(n.derivation)){const t=(0,u.convertDashlaneSecureDataKWC3ToTransportableData)({encryptedData:o,salt:e,version:"KWC3"});return(0,a.bufferToBase64)(t)}const i={salt:e,iv:t,hash:r,cipheredContent:o,cryptoConfig:n},c=(0,s.convertDashlaneSecureDataFlexibleToTransportableData)(i);return(0,a.bufferToBase64)(c)};async function T(e,t,r,o){const n=o??(0,s.getCryptoConfig)(e),a=n.derivation;if("noderivation"===a.method)return;const i=_(e,n.derivation);await r(t,i,a)}function _(e,t){return(0,s.isCryptoConfigKWC3)(t)?function(e){if(e.getUserSession().cryptoKwc3FixedSalt)return(0,a.base64ToBuffer)(e.getUserSession().cryptoKwc3FixedSalt);const t=(0,l.getRandomValues)(32),r=(0,a.bufferToBase64)(t);return e.dispatch((0,m.updateCryptoKwc3FixedSalt)(r)),t}(e):function(e){if(e.getPersonalSettings().CryptoFixedSalt)return(0,a.base64ToBuffer)(e.getPersonalSettings().CryptoFixedSalt);const t=(0,l.getRandomValues)(16),r={CryptoFixedSalt:(0,a.bufferToBase64)(t)};return e.dispatch((0,g.editPersonalSettings)(r)),t}(e)}t.prepareCrypto=T},27993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeKWC5DashlaneSecureData=t.generateIV=t.parseDashlaneKw5SecureData=t.convertKw5ToTransportableData=void 0;const o=r(55623),n=r(16038);t.convertKw5ToTransportableData=e=>{let t=new ArrayBuffer(32);if("KWC5"!==e.version)throw new Error("Version must be KWC5");if(null===e.hash)throw new Error("hmacSha2 from DashlaneSecureData is null");if(null===e.iv)throw new Error("iv from DashlaneSecureData is null");e.iv&&(t=(0,n.concatBuffers)(e.iv,(0,o.getRandomValues)(16)));const r=(0,n.utf8ToBase64Buffer)(e.version);return(0,n.concatBuffers)(t,r,e.hash,e.secured)};t.parseDashlaneKw5SecureData=e=>{if(e.byteLength<36)throw new Error(`Data length should be at least 36 long but was ${e.byteLength}`);let t=0;const r=(0,n.getSubDataByteArray)(e,t,16).buffer;t+=32;const o=(0,n.getSubDataByteArray)(e,t,t+4),a=(0,n.uint8ArrayToText)(o);if("KWC5"!==a)throw new Error("Version must be KWC5");t+=4;const i=(0,n.getSubDataByteArray)(e,t,t+32).buffer;t+=32;return{iv:r,version:a,hash:i,secured:(0,n.getSubDataByteArray)(e,t,e.byteLength).buffer}};t.generateIV=()=>(0,o.getRandomValues)(16);t.makeKWC5DashlaneSecureData=(e,t,r,o)=>({version:"KWC5",clearData:e,secured:t,iv:r,hash:o})},65675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PBKDF2_DEFAULT_PAYLOAD=t.ARGON2_DEFAULT_PAYLOAD=t.KWC3_DEFAULT_PAYLOAD=t.getUserCryptoPayload=t.getCryptoUserPayload=t.getCryptoConfig=t.makeFlexibleMarkerCryptoConfig=t.makeFlexibleMarkerPbkdf2Config=t.makeFlexibleMarkerArgon2dConfig=t.makeKWC3CryptoConfig=t.convertDashlaneSecureDataFlexibleToTransportableData=t.makeFlexibleMarkerPayloadBuffer=t.makeFlexibleMarkerPayloadString=t.makeFlexibleCryptoConfig=t.readCryptoPayload=t.parseCipheredData=t.getFlexibleSecureData=t.getLegacySecureData=t.getLegacyMarker=t.getLegacyCryptoConfig=t.parsePayload=t.getSignatureConfig=t.getCipheringConfiguration=t.getDerivationConfiguration=t.getPbkdf2DerivationConfig=t.getArgon2DerivationConfig=t.extractNextPayloadComponent=t.isDashlaneSecureDataFlexible=t.isDashlaneSecureDataKWC5=t.isDashlaneSecureDataKWC3=t.DashlaneCipherVersion=t.isSupportedAESMode=t.isSupportedDerivationMethod=t.isCryptoConfigKWC3=t.isNoDerivation=t.isArgon2Derivation=t.isPbkdf2Derivation=void 0;const o=r(62433),n=r(50415),a=r(16038);function i(e){return"pbkdf2"===e.method}function s(e){return"noderivation"===e.method||"skip"===e.method}function c(e){return Boolean(["argon2d","pbkdf2","noderivation","skip"].find((t=>t===e)))}function d(e){return Boolean(["cbchmac","cbchmac64","cbc","gcm"].find((t=>t===e)))}t.isPbkdf2Derivation=i,t.isArgon2Derivation=function(e){return"argon2d"===e.method},t.isNoDerivation=s,t.isCryptoConfigKWC3=function(e){return i(e)&&10204===e.iterations&&"sha1"===e.hashMethod},t.isSupportedDerivationMethod=c,t.isSupportedAESMode=d,t.DashlaneCipherVersion=(0,n.Enum)("KWC3","KWC5");t.isDashlaneSecureDataKWC3=e=>e.marker===t.DashlaneCipherVersion.KWC3;t.isDashlaneSecureDataKWC5=e=>e.marker===t.DashlaneCipherVersion.KWC5;t.isDashlaneSecureDataFlexible=e=>void 0!==e.iv;t.extractNextPayloadComponent=e=>{if(null===e)return"";let t=e;t.startsWith("$")&&(t=t.substring(1,e.length));return t.substring(0,t.indexOf("$"))};t.getArgon2DerivationConfig=e=>{let r=0;const o={};if(o.saltLength=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.saltLength.toString().length+1,o.t_cost=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.t_cost.toString().length+1,o.m_cost=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.m_cost.toString().length+1,o.parallelism=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.parallelism.toString().length+1,isNaN(o.saltLength)||0===o.saltLength||isNaN(o.t_cost)||0===o.t_cost||isNaN(o.m_cost)||0===o.m_cost||isNaN(o.parallelism)||0===o.parallelism)throw new Error("Wrong parameters in payload");return o};t.getPbkdf2DerivationConfig=e=>{let r=0;const o={};if(o.saltLength=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.saltLength.toString().length+1,o.iterations=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.iterations.toString().length+1,o.hashMethod=String((0,t.extractNextPayloadComponent)(e.substring(r,e.length))),r+=o.hashMethod.length+1,isNaN(o.saltLength)||isNaN(o.iterations))throw new Error("Wrong parameters in payload");return o};t.getDerivationConfiguration=e=>{let r=0,o={};const n=String((0,t.extractNextPayloadComponent)(e.substring(r,e.length)));if(!c(n))throw new Error("Derivation method not supported");if(o.method=n,"noderivation"===n||"skip"===n)return o;if(r+=o.method.length+1,"argon2d"===o.method){const n=(0,t.getArgon2DerivationConfig)(e.substring(r,e.length));o={...o,...n}}if("pbkdf2"===o.method){const n=(0,t.getPbkdf2DerivationConfig)(e.substring(r,e.length));o={...o,...n}}return o};t.getCipheringConfiguration=e=>{const r={options:{}};let o=0;if(r.method=String((0,t.extractNextPayloadComponent)(e.substring(o,e.length))),o+=r.method.length+1,"aes256"!==r.method)throw new Error(`[getCipheringConfiguration]: Wrong ciphering method expected "aes256" but get ${r.method}`);{const n=String((0,t.extractNextPayloadComponent)(e.substring(o,e.length)));if(!d(n))throw new Error("[getCipheringConfiguration]: unsupported AES mode");if(r.options.mode=n,o+=r.options.mode.length+1,r.options.ivLength=Number((0,t.extractNextPayloadComponent)(e.substring(o,e.length))),isNaN(r.options.ivLength)||0===r.options.ivLength)throw new Error("[getCipheringConfiguration]: Wrong parameters in payload")}return r};t.getSignatureConfig=e=>{const t={method:"skip"};return"cbchmac"===e&&(t.method="hmac"),"cbchmac64"===e&&(t.method="hmac64"),t};t.parsePayload=e=>{if(null===e)throw new Error("parsePayload: No payload to parse");if(e.startsWith("$")){let r=0;const n=Number((0,t.extractNextPayloadComponent)(e.substring(r,e.length)));if(1!==n)throw new Error(`parsePayload: version should be 1 but is ${n}`);r+=n.toString().length+1;const a=(0,t.getDerivationConfiguration)(e.substring(r,e.length)),i=(0,o.reduce)(((e,t)=>e+(`${t}`.length+1)));r=i(r,(0,o.values)(a));const s=(0,t.getCipheringConfiguration)(e.substring(r,e.length));r+=String(s.method).length+1,r=i(r,(0,o.values)(s.options));const c={method:"data"};return{cryptoConfig:{derivation:a,signature:(0,t.getSignatureConfig)(s.options.mode),ciphering:{method:s.method,options:{...s.options,ivGeneration:c}}},payloadLength:r+1}}throw new Error("parsePayload: Unable to parse payload")};t.getLegacyCryptoConfig=e=>{if("KWC3"===e)return{derivation:{method:"pbkdf2",saltLength:32,iterations:10204,hashMethod:"sha1"},signature:{method:"skip"},ciphering:{method:"aes256",options:{mode:"cbc",ivLength:16,ivGeneration:{method:"evpByteToKey"}}}};if("KWC5"===e)return{derivation:{method:"skip"},signature:{method:"hmac"},ciphering:{method:"aes256",options:{mode:"cbchmac",ivLength:16,ivGeneration:{method:"data"}}}};throw new Error("Wrong marker")};t.getLegacyMarker=e=>{const r=(0,a.getSubDataByteArray)(e,32,36),o=(0,a.uint8ArrayToText)(r);return o===t.DashlaneCipherVersion.KWC3||o===t.DashlaneCipherVersion.KWC5?o:null};t.getLegacySecureData=(e,r)=>{if(e===t.DashlaneCipherVersion.KWC3){return{marker:e,salt:(0,a.getSubDataByteArray)(r,0,32).buffer,cipheredContent:(0,a.getSubDataByteArray)(r,36,r.byteLength).buffer,cryptoConfig:(0,t.getLegacyCryptoConfig)(e)}}if(e===t.DashlaneCipherVersion.KWC5){const o=16,n=32;return{marker:e,iv:(0,a.getSubDataByteArray)(r,0,o).buffer,hash:(0,a.getSubDataByteArray)(r,36,36+n).buffer,cipheredContent:(0,a.getSubDataByteArray)(r,36+n,r.byteLength).buffer,cryptoConfig:(0,t.getLegacyCryptoConfig)(e)}}throw new Error("Wrong marker")};t.getFlexibleSecureData=e=>{const r=(0,a.uint8ArrayToText)(e),{cryptoConfig:o,payloadLength:n}=(0,t.parsePayload)(r);let i=n;const c=s(o.derivation)?0:o.derivation.saltLength,d=o.ciphering.options.ivLength,l=(0,a.getSubDataByteArray)(e,i,i+c).buffer;i+=c;const u=(0,a.getSubDataByteArray)(e,i,i+d).buffer;i+=d;const p=(0,a.getSubDataByteArray)(e,i,i+32).buffer;i+=32;return{salt:l,iv:u,hash:p,cipheredContent:(0,a.getSubDataByteArray)(e,i,e.length).buffer,cryptoConfig:o}};t.parseCipheredData=e=>{const r=(0,t.getLegacyMarker)(e);if(r)return(0,t.getLegacySecureData)(r,e);if("$"===(0,a.uint8ArrayToText)((0,a.getSubDataByteArray)(e,0,1)))return(0,t.getFlexibleSecureData)(e);throw new Error("Unable to parse ciphered data")};t.readCryptoPayload=e=>{const r=(0,a.base64ToBuffer)(e),o=new Uint8Array(r),n=(0,t.getLegacyMarker)(o);if(n)return n;const i=(0,a.uint8ArrayToText)(o),{payloadLength:s}=(0,t.parsePayload)(i);return i.substr(0,s)};t.makeFlexibleCryptoConfig=e=>e.cryptoConfig;t.makeFlexibleMarkerPayloadString=e=>{let t="$1";const r=(0,o.reduce)(((e,t)=>"string"==typeof t||"number"==typeof t?e+`$${String(t)}`:e));t=r(t,(0,o.values)(e.derivation)),t=r(t,[e.ciphering.method]);return t=r(t,(0,o.values)((0,o.omit)(["ivGeneration"],e.ciphering.options))),t+="$",t};t.makeFlexibleMarkerPayloadBuffer=e=>{const r=(0,t.makeFlexibleMarkerPayloadString)(e);return(0,a.str2ab)(r)};function l(){return{derivation:{method:"pbkdf2",saltLength:32,iterations:10204,hashMethod:"sha1"},signature:{method:"skip"},ciphering:{method:"aes256",options:{mode:"cbc",ivLength:16,ivGeneration:{method:"evpByteToKey"}}}}}function u(){return{method:"argon2d",saltLength:16,t_cost:3,m_cost:32768,parallelism:2}}function p(){return{method:"pbkdf2",saltLength:16,iterations:2e5,hashMethod:"sha256"}}function S(e){return{derivation:"argon2d"===e?{method:"argon2d",saltLength:16,t_cost:3,m_cost:32768,parallelism:2}:{method:"pbkdf2",saltLength:16,iterations:2e5,hashMethod:"sha256"},signature:{method:"hmac"},ciphering:{method:"aes256",options:{mode:"cbchmac",ivLength:16,ivGeneration:{method:"data"}}}}}function m(e){return e.getPersonalSettings().CryptoUserPayload||t.ARGON2_DEFAULT_PAYLOAD}t.convertDashlaneSecureDataFlexibleToTransportableData=e=>{const{cipheredContent:r,cryptoConfig:o,hash:n,iv:i,salt:c}=e,d=(0,t.makeFlexibleMarkerPayloadBuffer)(o);return s(o.derivation)?(0,a.concatBuffers)(d,i,n,r):(0,a.concatBuffers)(d,c,i,n,r)},t.makeKWC3CryptoConfig=l,t.makeFlexibleMarkerArgon2dConfig=u,t.makeFlexibleMarkerPbkdf2Config=p,t.makeFlexibleMarkerCryptoConfig=S,t.getCryptoConfig=function(e){const r=m(e);return(0,o.isNil)(r)?S("argon2d"):"KWC3"===r?{derivation:{method:"pbkdf2",saltLength:32,iterations:10204,hashMethod:"sha1"},signature:{method:"skip"},ciphering:{method:"aes256",options:{mode:"cbc",ivLength:16,ivGeneration:{method:"evpByteToKey"}}}}:(0,t.parsePayload)(r).cryptoConfig},t.getCryptoUserPayload=m;t.getUserCryptoPayload=e=>{if("pbkdf2_kwc3"===e)return{CryptoUserPayload:t.KWC3_DEFAULT_PAYLOAD};const r="argon2"===e?"argon2d":"pbkdf2";return{CryptoUserPayload:(0,o.compose)(a.base64BufferToUtf8,t.makeFlexibleMarkerPayloadBuffer,S)(r)}},t.KWC3_DEFAULT_PAYLOAD="KWC3",t.ARGON2_DEFAULT_PAYLOAD="$1$argon2d$16$3$32768$2$aes256$cbchmac$16$",t.PBKDF2_DEFAULT_PAYLOAD="$1$pbkdf2$16$200000$sha256$aes256$cbchmac$16$"},15215:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeCanonicalRequest=void 0;const o=r(62433);t.makeCanonicalRequest=e=>{const t=e=>e.toLowerCase(),r=n(e.headers),a=e.headersToSign?o.pick(o.map(t,o.values(e.headersToSign)),o.mapObjIndexed(t,r)):r,l=i(e.uri),u=s(e.query),p=c(a),S=d(a);return{canonicalRequest:[e.method,l,u,p,S,e.hashedPayload].join("\n"),signedHeaders:S}};const n=e=>o.pipe(o.toPairs,o.map((([e,t])=>[e.toLowerCase(),t])),l)(e),a=e=>e.replace(/[^A-Za-z0-9_.~\-]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase())),i=e=>(e=>e.split("/").map((e=>a(e))).join("/"))(e),s=e=>o.pipe((e=>o.toPairs(e)),o.sortBy((e=>e[0])),o.map((([e,t])=>((e,t)=>{const r=a(e),n=Array.isArray(t)?t:[t];return o.pipe(o.map((e=>a(e))),o.map((e=>[r,e])),o.sortBy(o.reduce(o.concat,"")))(n)})(e,t))),o.unnest,o.map((([e,t])=>`${e}=${t}`)),o.join("&"))(e),c=e=>o.pipe((e=>o.toPairs(e)),o.sortBy((e=>e[0].toLowerCase())),o.map((([e,t])=>((e,t)=>e.toLowerCase()+":"+t.trim().replace(/\s+/g," ")+"\n")(e,t))),o.join(""))(e),d=e=>o.pipe(o.keys,o.map((e=>e.toLowerCase())),o.sortBy(o.identity),o.join(";"))(e),l=e=>{const t={};for(let r=0;r<e.length;++r)t[e[r][0]]=e[r][1];return t}},51907:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApiCredentials=void 0;const o=r(56915),n=r(17825),a=r(45956);t.getApiCredentials=function(e,t){if(t.authenticationType===a.ApiAuthType.None)return{type:t.authenticationType};const r={appKeys:(0,o.appKeysSelector)(e)};switch(t.authenticationType){case a.ApiAuthType.App:return{type:a.ApiAuthType.App,...r};case a.ApiAuthType.UserDevice:return{type:a.ApiAuthType.UserDevice,...r,login:t.login,deviceKeys:(0,o.deviceKeysSelector)(e)};case a.ApiAuthType.Session:return{type:a.ApiAuthType.Session,...r,login:t.login,sessionKeys:(0,o.sessionKeysSelector)(e),deviceId:(0,o.getDeviceAccessKeySelector)(e,t.login)};case a.ApiAuthType.TeamDevice:return{type:a.ApiAuthType.TeamDevice,...r,teamUuid:t.teamUuid,deviceKeys:(0,o.deviceKeysSelector)(e)};default:(0,n.assertUnreachable)(t.authenticationType)}}},90338:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.prepareApiEndpoint=void 0;const o=r(45956),n=r(55730);t.prepareApiEndpoint=function(e){const{authenticationType:t,endpoint:r,group:a,method:i,version:s,accept:c,responseType:d}=e,l=`/${o.ApiVersion[s]}/${a}/${r}`;return(0,n.getMakeApiRequest)(l,t,i,d??"json",c)}},27054:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSafeDeviceName=t.makeSafeLanguage=t.makeSafeCountry=void 0;const r="ZZ";t.makeSafeCountry=function(e){return!e||e.length<2||e.length>5?r:e};const o="und";t.makeSafeLanguage=function(e){return!e||e.length<2||e.length>5?o:e};const n="Device";t.makeSafeDeviceName=function(e){return e||n}},2978:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCode=void 0;const o=r(45956);t.getCode=(e,t)=>{const r=t.indexOf(e);return r<0?o.UnknownError:t[r]}},84101:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(27054),t),n(r(85188),t),n(r(2978),t)},85188:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExtraDeviceTokenValid=t.isEmailTokenValid=void 0,t.isEmailTokenValid=function(e){return/^\d{6}$/.test(e)},t.isExtraDeviceTokenValid=function(e){return/^[A-Za-z0-9+/]{64}$/.test(e)}},46298:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownError=t.isApiErrorOfType=t.isApiError=void 0;var a=r(45956);Object.defineProperty(t,"isApiError",{enumerable:!0,get:function(){return a.isApiError}}),Object.defineProperty(t,"isApiErrorOfType",{enumerable:!0,get:function(){return a.isApiErrorOfType}}),Object.defineProperty(t,"UnknownError",{enumerable:!0,get:function(){return a.UnknownError}}),n(r(91503),t),n(r(84101),t)},55730:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApiClientAgentHeader=t.validateStatus=t.makeApiResponse=t.getMethodParams=t.getAuthParams=t.getMakeApiRequest=void 0;const o=r(53),n=r(17825),a=r(86056),i=r(14656),s=r(56915),c=r(45956),d=r(78577),l=r(51907),u=r(48749),p=r(45800);function S(e,{login:t,teamUuid:r}){switch(e){case c.ApiAuthType.App:case c.ApiAuthType.None:return{authenticationType:e};case c.ApiAuthType.UserDevice:case c.ApiAuthType.Session:return{authenticationType:e,login:t};case c.ApiAuthType.TeamDevice:return{authenticationType:e,teamUuid:r};default:(0,n.assertUnreachable)(e)}}function m(e,t){switch(e){case c.ApiRequestMethod.GET:return{method:e};case c.ApiRequestMethod.POST:return{method:e,payload:t};default:(0,n.assertUnreachable)(e)}}function g(e){const t=function({errors:e}){if(Array.isArray(e)&&e.length>0)return e[0];return null}(e);return t||function(e){return{code:"success",data:e.data?null:e,...e.data}}(e)}t.getMakeApiRequest=function(e,r,A,f,E){return async(h,v)=>{const T={login:"",teamUuid:"",payload:{},...v||{}},_=m(A,T.payload),I=S(r,{login:T.login,teamUuid:T.teamUuid}),C=(0,l.getApiCredentials)(h.getState(),I),P={Accept:E??"application/json","Content-Type":"application/json; charset=UTF-8","dashlane-client-agent":y((0,a.getPlatformInfo)())},D={...P,Host:new URL(u.config.DASHLANE_API_HOST_WITH_SCHEME).hostname},O=await async function(e,t,r,a,i){if(r.type===c.ApiAuthType.None)return{};const l=(0,s.dashlaneServerDeltaTimestampSelector)(e.getState())||0,u=Math.round((0,o.getUnixTimestamp)()-l),p=function(e){switch(e.method){case c.ApiRequestMethod.GET:return"";case c.ApiRequestMethod.POST:return JSON.stringify(e.payload);default:(0,n.assertUnreachable)(e)}}(i),{method:S}=i,m={pathname:t,method:S,rawBody:p,headers:a},g=await(0,d.signRequest)({request:m,timestamp:u,credentials:r});return{Authorization:g}}(h,e,C,D,_),b={...P,...O,...(0,p.getCloudflareHeaders)()},w=`${u.config.DASHLANE_API_HOST_WITH_SCHEME}${e}`,{data:N}=await function(e,r,o,a){const s={headers:o,validateStatus:t.validateStatus,responseType:a};switch(e.method){case c.ApiRequestMethod.GET:return(0,i.get)(r,s);case c.ApiRequestMethod.POST:return(0,i.post)(r,e.payload,s);default:(0,n.assertUnreachable)(e)}}(_,w,b,f);return g(N)}},t.getAuthParams=S,t.getMethodParams=m,t.makeApiResponse=g;function y(e){return JSON.stringify({platform:e.platformName||"unknown",version:e.appVersion||"unknown",osversion:e.osVersion||"unknown",language:e.lang||"unknown"})}t.validateStatus=e=>e>=100&&e<=500,t.getApiClientAgentHeader=y},41075:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAndEvaluateForUser=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.abtesting,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetAndEvaluateForUser"},i=(0,n.prepareApiEndpoint)(a);t.getAndEvaluateForUser=async function(e,t,r){return i(e,{login:t,payload:r})}},61394:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateAccountRecoveryKey=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.accountRecovery,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"Deactivate"},i=(0,n.prepareApiEndpoint)(a);t.deactivateAccountRecoveryKey=function(e,t,r){return i(e,{login:t,payload:r})}},14651:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountInfo=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.account,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"AccountInfo"},i=(0,o.prepareApiEndpoint)(a);t.accountInfo=async function(e,t){return i(e,{login:t,payload:{}})}},45468:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUserWithSSO=void 0;const o=r(90338),n=r(45956),a={authenticationType:n.ApiAuthType.App,endpoint:"CreateUserWithSSO",group:n.ApiEndpointGroups.account,method:n.ApiRequestMethod.POST,version:n.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(a);t.createUserWithSSO=async function(e,t){return i(e,{payload:t})}},55710:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUser=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.account,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"CreateUser"},i=(0,o.prepareApiEndpoint)(a);t.createUser=async function(e,t){return i(e,{payload:t})}},25011:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPremiumStatus=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.premium,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetPremiumStatus"},i=(0,o.prepareApiEndpoint)(a);t.getPremiumStatus=function(e,t){return i(e,{login:t,payload:{}})}},31375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSubscriptionInformation=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.premium,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetSubscriptionInfo"},i=(0,o.prepareApiEndpoint)(a);t.getSubscriptionInformation=function(e,t){return i(e,{login:t,payload:{}})}},97421:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestAccountCreation=t.AccountExistsStatus=void 0;const o=r(90338),n=r(45956);!function(e){e.AccountExists="yes",e.AccountDoesntExist="no",e.AccountDoesntExistInvalid="no_invalid",e.AccountDoesntExistUnlikely="no_unlikely"}(t.AccountExistsStatus||(t.AccountExistsStatus={}));const a={group:n.ApiEndpointGroups.account,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"RequestAccountCreation"},i=(0,o.prepareApiEndpoint)(a);t.requestAccountCreation=function(e,t){return i(e,{payload:t})}},63339:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateContactInfo=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.account,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"UpdateContactInfo"},i=(0,o.prepareApiEndpoint)(a);t.updateContactInfo=async function(e,t,r){return i(e,{login:t,payload:r})}},34957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExistingSecureRemembermeSession=t.MismatchedSessionSecurity=t.SessionNotFound=t.AuthenticatorNotAvailableOnDevice=t.AuthenticationTypeNotSupported=t.AuthenticatorNotRegistered=t.AssertionRejected=t.AttestationRejected=t.ChallengeVerificationFailed=t.ChallengeExpired=t.ChallengeNotFound=t.InvalidAuthentication=t.TwofaEmailTokenNotEnabled=t.UserHasNoActiveAuthenticator=t.FailedToContactAuthenticatorDevice=t.VerificationMethodDisabled=t.VerificationFailed=t.TeamGenericError=t.SSOBlocked=t.UserNotFound=t.U2fBadRequest=t.InvalidOTPBlocked=t.InvalidOTPAlreadyUsed=t.DeviceNotFound=t.DeviceDeactivated=void 0,t.DeviceDeactivated="device_deactivated",t.DeviceNotFound="device_not_found",t.InvalidOTPAlreadyUsed="invalid_otp_already_used",t.InvalidOTPBlocked="invalid_otp_blocked",t.U2fBadRequest="u2f_bad_request",t.UserNotFound="user_not_found",t.SSOBlocked="SSO_BLOCKED",t.TeamGenericError="TEAM_GENERIC_ERROR",t.VerificationFailed="verification_failed",t.VerificationMethodDisabled="verification_method_disabled",t.FailedToContactAuthenticatorDevice="FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE",t.UserHasNoActiveAuthenticator="USER_HAS_NO_ACTIVE_AUTHENTICATOR",t.TwofaEmailTokenNotEnabled="TWOFA_EMAIL_TOKEN_NOT_ENABLED",t.InvalidAuthentication="invalid_authentication",t.ChallengeNotFound="CHALLENGE_NOT_FOUND",t.ChallengeExpired="CHALLENGE_EXPIRED",t.ChallengeVerificationFailed="CHALLENGE_VERIFICATION_FAILED",t.AttestationRejected="ATTESTATION_REJECTED",t.AssertionRejected="ASSERTION_REJECTED",t.AuthenticatorNotRegistered="AUTHENTICATOR_NOT_REGISTERED",t.AuthenticationTypeNotSupported="AUTHENTICATION_TYPE_NOT_SUPPORTED",t.AuthenticatorNotAvailableOnDevice="AUTHENTICATOR_NOT_AVAILABLE_ON_DEVICE",t.SessionNotFound="SESSION_NOT_FOUND",t.MismatchedSessionSecurity="MISMATCHED_SESSION_SECURITY",t.ExistingSecureRemembermeSession="EXISTING_SECURE_REMEMBERME_SESSION"},8124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeDeviceRegistrationWithAuthTicket=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"CompleteDeviceRegistrationWithAuthTicket"},i=(0,n.prepareApiEndpoint)(a);t.completeDeviceRegistrationWithAuthTicket=async function(e,t){return i(e,{payload:t})}},67747:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeExtraDeviceRegistrationWithToken=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"CompleteExtraDeviceRegistrationWithToken"},i=(0,n.prepareApiEndpoint)(a);t.completeExtraDeviceRegistrationWithToken=async function(e,t){return i(e,{payload:t})}},62712:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeLoginWithAuthTicket=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"CompleteLoginWithAuthTicket",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.completeLoginWithAuthTicket=async function(e,t){return i(e,{payload:t})}},13271:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeRememberMeOpenSession=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.Session,endpoint:"CompleteRememberMeOpenSession"},i=(0,n.prepareApiEndpoint)(a);t.completeRememberMeOpenSession=async function(e,t,r){return i(e,{login:t,payload:r})}},51837:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeRememberMeRegistration=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CompleteRememberMeRegistration"},i=(0,n.prepareApiEndpoint)(a);t.completeRememberMeRegistration=async function(e,t,r){return i(e,{login:t,payload:r})}},34569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeTotpActivation=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"CompleteTOTPActivation",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.completeTotpActivation=async function(e,t,r){return i(e,{login:t,payload:r})}},61054:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeWebAuthnAuthenticatorRegistration=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"CompleteWebAuthnAuthenticatorRegistration"},i=(0,n.prepareApiEndpoint)(a);t.completeWebAuthnAuthenticatorRegistration=async function(e,t,r){return i(e,{login:t,payload:r})}},8111:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateRememberMe=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateRememberMe"},i=(0,n.prepareApiEndpoint)(a);t.deactivateRememberMe=async function(e,t,r){return i(e,{login:t,payload:r})}},39446:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTotpVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateTOTP",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.deactivateTotpVerification=async function(e,t,r){return i(e,{login:t,payload:r})}},36602:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateWebAuthnAuthenticator=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateWebAuthnAuthenticator"},i=(0,n.prepareApiEndpoint)(a);t.deactivateWebAuthnAuthenticator=async function(e,t,r){return i(e,{login:t,payload:r})}},15152:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationMethodsForDevice=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetAuthenticationMethodsForDevice"},i=(0,n.prepareApiEndpoint)(a);t.getAuthenticationMethodsForDevice=async function(e,t){return i(e,{payload:t})}},13328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationMethodsForLogin=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetAuthenticationMethodsForLogin"},i=(0,n.prepareApiEndpoint)(a);t.getAuthenticationMethodsForLogin=async function(e,t){return i(e,{payload:t})}},32924:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthenticationTokenForCardUpdate=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"CreateTokenExtAuth"},i=(0,o.prepareApiEndpoint)(a);t.getAuthenticationTokenForCardUpdate=function(e,t){return i(e,{login:t,payload:{}})}},60132:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAvailableWebAuthnAuthenticators=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.Session,endpoint:"GetAvailableWebAuthnAuthenticators"},i=(0,n.prepareApiEndpoint)(a);t.getAvailableWebAuthnAuthenticators=async function(e,t){return i(e,{login:t,payload:{}})}},12407:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMasterPasswordCipheringKey=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.Session,endpoint:"GetMasterPasswordCipheringKey"},i=(0,o.prepareApiEndpoint)(a);t.getMasterPasswordCipheringKey=async function(e,t){return i(e,{login:t,payload:{}})}},56736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTokens=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.GET,authenticationType:n.ApiAuthType.App,endpoint:"GetTokens"},i=(0,o.prepareApiEndpoint)(a);t.getTokens=async function(e){return i(e)}},80585:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTwoFactorAuthenticationStatus=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"Get2FAStatus"},i=(0,o.prepareApiEndpoint)(a);t.getTwoFactorAuthenticationStatus=function(e,t){return i(e,{login:t,payload:{}})}},6862:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getU2FDevices=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetU2FDevices",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.getU2FDevices=async function(e,t){return i(e,{login:t,payload:{}})}},48974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUnauthorizedProfiles=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"GetUnauthorizedProfiles"},i=(0,n.prepareApiEndpoint)(a);t.getUnauthorizedProfiles=async function(e,t){return i(e,{payload:t})}},97343:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserSSOInfo=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.TeamDevice,endpoint:"GetUserSSOInfo"},i=(0,n.prepareApiEndpoint)(a);t.getUserSSOInfo=async function(e,t){const{login:r,teamUuid:o,userServiceProviderKey:n}=t;return i(e,{login:r,teamUuid:o,payload:{login:r,userServiceProviderKey:n}})}},99850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getWebAuthnAuthenticators=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetWebAuthnAuthenticators"},i=(0,n.prepareApiEndpoint)(a);t.getWebAuthnAuthenticators=async function(e,t){return i(e,{login:t,payload:{}})}},43339:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initRememberMasterPassword=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"InitRememberMasterPassword"},i=(0,o.prepareApiEndpoint)(a);t.initRememberMasterPassword=async function(e,t,r){return i(e,{login:t,payload:r})}},71336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performDashlaneAuthenticatorVerification=t.verificationTimeoutError=void 0;const o=r(59821),n=r(45956),a=r(90338);t.verificationTimeoutError={code:o.VerificationTimeout,message:"The authentication request has timed out",type:o.BusinessError};const i={authenticationType:n.ApiAuthType.App,endpoint:"PerformDashlaneAuthenticatorVerification",group:n.ApiEndpointGroups.authentication,method:n.ApiRequestMethod.POST,version:n.ApiVersion.v1},s=(0,a.prepareApiEndpoint)(i);t.performDashlaneAuthenticatorVerification=async function(e,t){return s(e,{payload:t})}},87992:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performDuoPushVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"PerformDuoPushVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.performDuoPushVerification=async function(e,t){return i(e,{payload:t})}},4685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performEmailTokenVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"PerformEmailTokenVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.performEmailTokenVerification=async function(e,t){return i(e,{payload:t})}},78876:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performSsoVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"PerformSsoVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.performSsoVerification=async function(e,t){return i(e,{payload:t})}},96425:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performTotpVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"PerformTotpVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.performTotpVerification=async function(e,t){return i(e,{payload:t})}},99289:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.performU2FVerification=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.App,endpoint:"PerformU2FVerification",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.performU2FVerification=async function(e,t){return i(e,{payload:t})}},10954:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestEmailTokenVerification=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"RequestEmailTokenVerification"},i=(0,n.prepareApiEndpoint)(a);t.requestEmailTokenVerification=async function(e,t){return i(e,{payload:t})}},1371:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestExtraDeviceRegistration=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"RequestExtraDeviceRegistration"},i=(0,n.prepareApiEndpoint)(a);t.requestExtraDeviceRegistration=async function(e,t){return i(e,{login:t,payload:{tokenType:"shortLived"}})}},51296:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestTOTPActivation=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"RequestTOTPActivation",group:o.ApiEndpointGroups.authentication,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.requestTOTPActivation=async function(e,t,r){return i(e,{login:t,payload:r})}},48253:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeU2FAuthenticator=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.authentication,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"DeactivateU2FDevice"},i=(0,o.prepareApiEndpoint)(a);t.removeU2FAuthenticator=async function(e,t,r){return i(e,{login:t,payload:r})}},48730:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestWebauthnOpenSession=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.Session,endpoint:"RequestWebauthnOpenSession"},i=(0,n.prepareApiEndpoint)(a);t.requestWebauthnOpenSession=async function(e,t){return i(e,{login:t,payload:{}})}},24925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestWebauthnRegistration=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.authentication,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"RequestWebauthnRegistration"},i=(0,n.prepareApiEndpoint)(a);t.requestWebauthnRegistration=async function(e,t){return i(e,{login:t,payload:{}})}},31197:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addPrivateBreach=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.dataleakQA,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"AddTestLeak"},i=(0,n.prepareApiEndpoint)(a);t.addPrivateBreach=async function(e,t){return i(e,{payload:{...t}})}},77074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createOrUpdateDarkWebBreach=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.dataleakQA,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"SetTestDataBreach"},i=(0,n.prepareApiEndpoint)(a);t.createOrUpdateDarkWebBreach=async function(e,t){return i(e,{payload:{...t}})}},72579:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPublicBreach=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.breachesQA,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.App,endpoint:"CreateTestBreach"},i=(0,n.prepareApiEndpoint)(a);t.createPublicBreach=async function(e,t){return i(e,{payload:t})}},82512:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightReport=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetDarkWebInsightsReportDetails"},i=(0,n.prepareApiEndpoint)(a);t.getDarkWebInsightReport=async function(e,t,r){return i(e,{login:t,payload:r})}},19667:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkWebInsightsSummaryRequest=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetDarkWebInsightsSummary"},i=(0,n.prepareApiEndpoint)(a);t.getDarkWebInsightsSummaryRequest=async function(e,t){return i(e,{login:t,payload:{}})}},91063:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateDevices=t.CLIENT_STILL_OVERFLOWING=t.PAIRING_GROUPS_NOT_FOUND=t.CLIENT_DEVICES_NOT_FOUND=void 0;const o=r(45956),n=r(90338);t.CLIENT_DEVICES_NOT_FOUND="CLIENT_DEVICES_NOT_FOUND",t.PAIRING_GROUPS_NOT_FOUND="PAIRING_GROUPS_NOT_FOUND",t.CLIENT_STILL_OVERFLOWING="CLIENT_STILL_OVERFLOWING";const a={group:o.ApiEndpointGroups.devices,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"DeactivateDevices"},i=(0,n.prepareApiEndpoint)(a);t.deactivateDevices=async function(e,t,r){return i(e,{login:t,payload:r})}},18625:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listDevices=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.devices,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ListDevices"},i=(0,n.prepareApiEndpoint)(a);t.listDevices=async function(e,t){return i(e,{login:t,payload:{}})}},59821:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidTeamDeviceLogin=t.BasicConfigNotFound=t.DeactivatedTeamDevice=t.DeviceKeyNotFound=t.DeviceAccountMappingAlreadyExists=t.B2bSsoUserNotFound=t.NoFreeSlot=t.NotProposedNeitherAccepted=t.InvalidSsoToken=t.InvalidUser=t.DomainNotValidForTeam=t.TotpActiveOrNotSeeded=t.ConfigurationNotFound=t.TeamDeviceEncryptedConfigNotFound=t.InvalidTOTPStatus=t.VerificationMethodInvalid=t.InvalidAuthTicket=t.WrongPublicKey=t.VerificationTimeout=t.VerificationRequiresRequest=t.VerificationFailedTooManyTimes=t.UpdateOfVerificationMethodNotSupported=t.UnexpectedError=t.UnchangedPrivateKey=t.TwofaSettingSameAsCurrent=t.TwofaServerKeyProvidedIncorrectly=t.TwofaServerKeyNotProvided=t.TeamDoesNotExist=t.TemporaryDisabled=t.NoMpEncryptionKey=t.NotAdmin=t.NoSharingKeys=t.NothingToUpdate=t.NoExternalToken=t.MissingSettingsTransaction=t.InvalidSessionAccessKey=t.InvalidKey=t.InsufficientTier=t.ExternalTokenSignatureNotAvailableForPartner=t.Current2faSettingCannotBeChangedAtUpload=t.ConflictingUpload=t.AccountBlockedContactSupport=t.ServerError=t.RateLimitError=t.InvalidRequestError=t.InjectedError=t.BusinessError=void 0,t.BusinessError="business_error",t.InjectedError="injected_error",t.InvalidRequestError="invalid_request_error",t.RateLimitError="rate_limit_error",t.ServerError="server_error",t.AccountBlockedContactSupport="account_blocked_contact_support",t.ConflictingUpload="conflicting_upload",t.Current2faSettingCannotBeChangedAtUpload="current_2fa_setting_cannot_be_changed_at_upload",t.ExternalTokenSignatureNotAvailableForPartner="external_token_signature_not_available_for_partner",t.InsufficientTier="INSUFFICIENT_TIER",t.InvalidKey="invalid_key",t.InvalidSessionAccessKey="invalid_session_access_key",t.MissingSettingsTransaction="MISSING_SETTINGS_TRANSACTION",t.NoExternalToken="no_external_token",t.NothingToUpdate="NOTHING_TO_UPDATE",t.NoSharingKeys="NO_SHARING_KEYS",t.NotAdmin="NOT_ADMIN",t.NoMpEncryptionKey="no_mp_encryption_key",t.TemporaryDisabled="temporary_disabled",t.TeamDoesNotExist="TEAM_DOES_NOT_EXIST",t.TwofaServerKeyNotProvided="2fa_server_key_not_provided",t.TwofaServerKeyProvidedIncorrectly="2fa_server_key_provided_incorrectly",t.TwofaSettingSameAsCurrent="2fa_setting_same_as_current",t.UnchangedPrivateKey="UNCHANGED_PRIVATE_KEY",t.UnexpectedError="unexpected_error",t.UpdateOfVerificationMethodNotSupported="UPDATE_OF_VERIFICATION_METHOD_NOT_SUPPORTED",t.VerificationFailedTooManyTimes="verification_failed_too_many_times",t.VerificationRequiresRequest="verification_requires_request",t.VerificationTimeout="verification_timeout",t.WrongPublicKey="WRONG_PUBLIC_KEY",t.InvalidAuthTicket="invalid_auth_ticket",t.VerificationMethodInvalid="verification_method_invalid",t.InvalidTOTPStatus="invalid_totp_status",t.TeamDeviceEncryptedConfigNotFound="TEAM_DEVICE_CONFIGURATION_NOT_FOUND",t.ConfigurationNotFound="TEAM_DEVICE_CONFIGURATION_NOT_FOUND",t.TotpActiveOrNotSeeded="totp_active_or_not_seeded",t.DomainNotValidForTeam="DOMAIN_NOT_VALID_FOR_TEAM",t.InvalidUser="invalid_user",t.InvalidSsoToken="invalid_sso_token",t.NotProposedNeitherAccepted="not_proposed_neither_accepted",t.NoFreeSlot="no_free_slot",t.B2bSsoUserNotFound="B2B_SSO_USER_NOT_FOUND",t.DeviceAccountMappingAlreadyExists="DEVICE_ACCOUNT_MAPPING_ALREADY_EXISTS",t.DeviceKeyNotFound="DEVICE_KEY_NOT_FOUND",t.DeactivatedTeamDevice="DEACTIVATED_TEAM_DEVICE",t.BasicConfigNotFound="BASIC_CONFIGURATION_NOT_FOUND",t.InvalidTeamDeviceLogin="INVALID_TEAM_DEVICE_LOGIN"},4933:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeFamilyMemberErrors=t.leaveFamilyErrors=t.joinFamilyErrors=t.UserMustCancelPremiumPlusRenewalToDowngradeToFamily=t.UserNotMemberOfFamily=t.CannotRemoveFamilyAdmin=t.UserMustBeFamilyAdmin=t.FamilyHasBeenDiscontinued=t.UserSubscriptionIsUpForRenewal=t.JoinFamilyTokenNotFound=t.AlreadyJoinedThisFamily=t.CannotJoinMultipleFamilies=t.FamilyFull=t.BadLogin=void 0,t.BadLogin="BAD_LOGIN",t.FamilyFull="FAMILY_FULL",t.CannotJoinMultipleFamilies="CANNOT_JOIN_MULTIPLE_FAMILIES",t.AlreadyJoinedThisFamily="ALREADY_JOINED_THIS_FAMILY",t.JoinFamilyTokenNotFound="JOIN_FAMILY_TOKEN_NOT_FOUND",t.UserSubscriptionIsUpForRenewal="USER_SUBSCRIPTION_IS_UP_FOR_RENEWAL",t.FamilyHasBeenDiscontinued="FAMILY_HAS_BEEN_DISCONTINUED",t.UserMustBeFamilyAdmin="USER_MUST_BE_FAMILY_ADMIN",t.CannotRemoveFamilyAdmin="CANNOT_REMOVE_FAMILY_ADMIN",t.UserNotMemberOfFamily="USER_NOT_MEMBER_OF_FAMILY",t.UserMustCancelPremiumPlusRenewalToDowngradeToFamily="USER_MUST_CANCEL_PREMIUM_PLUS_RENEWAL_TO_DOWNGRADE_TO_FAMILY",t.joinFamilyErrors=[t.BadLogin,t.FamilyFull,t.CannotJoinMultipleFamilies,t.AlreadyJoinedThisFamily,t.JoinFamilyTokenNotFound,t.UserSubscriptionIsUpForRenewal,t.FamilyHasBeenDiscontinued,t.UserMustCancelPremiumPlusRenewalToDowngradeToFamily],t.leaveFamilyErrors=[t.CannotRemoveFamilyAdmin,t.UserNotMemberOfFamily],t.removeFamilyMemberErrors=[t.UserMustBeFamilyAdmin,t.CannotRemoveFamilyAdmin,t.UserNotMemberOfFamily]},53e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFamilyDetails=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.familyplan,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetFamilyDetails"},i=(0,o.prepareApiEndpoint)(a);t.getFamilyDetails=async function(e,t){return i(e,{login:t,payload:{}})}},11560:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.joinFamily=t.FamilyStopRenewalPlatforms=t.FamilyStopRenewalStates=void 0;const o=r(90338),n=r(45956);t.FamilyStopRenewalStates=Object.freeze({STOPPED:"stopped",NOT_STOPPED:"not_stopped"}),t.FamilyStopRenewalPlatforms=Object.freeze({IOS_APP_STORE:"ios",MAC_STORE:"mac",PLAY_STORE:"playstore",PAYPAL:"paypal",STRIPE:"stripe",PROCESSOUT:"processout"});const a={group:n.ApiEndpointGroups.familyplan,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"JoinFamily"},i=(0,o.prepareApiEndpoint)(a);t.joinFamily=async function(e,t){return i(e,{payload:t})}},86661:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.leaveFamily=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.familyplan,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"LeaveFamily"},i=(0,o.prepareApiEndpoint)(a);t.leaveFamily=async function(e,t){return i(e,{login:t,payload:{}})}},15244:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeFamilyMember=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.familyplan,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"RemoveFamilyMember"},i=(0,o.prepareApiEndpoint)(a);t.removeFamilyMember=async function(e,t,r){return i(e,{login:t,payload:r})}},29591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetFamilyJoinToken=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.familyplan,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ResetJoinToken"},i=(0,o.prepareApiEndpoint)(a);t.resetFamilyJoinToken=async function(e,t){return i(e,{login:t,payload:{}})}},47521:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFeatureFlip=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.features,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetAndEvaluateForUser"},i=(0,o.prepareApiEndpoint)(a);t.getFeatureFlip=function(e,t,r){return i(e,{login:t,payload:{features:[r]}})}},64272:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGetFilesMetaSuccess=t.getFilesMeta=t.endpoint=void 0;const o=r(90338),n=r(45956);t.endpoint="GetFileMetaV2";const a={group:n.ApiEndpointGroups.file,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:t.endpoint},i=(0,o.prepareApiEndpoint)(a);t.getFilesMeta=(e,t,r)=>i(e,{login:t,payload:r});t.isGetFilesMetaSuccess=e=>"success"===e.code},91503:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(59821),t),n(r(97421),t),n(r(55710),t),n(r(63339),t),n(r(45468),t),n(r(91063),t),n(r(18625),t),n(r(11560),t),n(r(53e3),t),n(r(15244),t),n(r(29591),t),n(r(86661),t),n(r(34957),t),n(r(8124),t),n(r(67747),t),n(r(62712),t),n(r(13271),t),n(r(51837),t),n(r(61054),t),n(r(39446),t),n(r(8111),t),n(r(36602),t),n(r(13328),t),n(r(15152),t),n(r(60132),t),n(r(12407),t),n(r(56736),t),n(r(80585),t),n(r(6862),t),n(r(99850),t),n(r(48974),t),n(r(43339),t),n(r(87992),t),n(r(4685),t),n(r(78876),t),n(r(96425),t),n(r(99289),t),n(r(71336),t),n(r(1371),t),n(r(10954),t),n(r(48253),t),n(r(51296),t),n(r(24925),t),n(r(48730),t),n(r(3278),t),n(r(71633),t),n(r(19336),t),n(r(13445),t),n(r(49481),t),n(r(36420),t),n(r(32042),t),n(r(42216),t),n(r(54268),t),n(r(56026),t),n(r(81926),t),n(r(28974),t),n(r(46583),t),n(r(43775),t),n(r(9161),t),n(r(34252),t),n(r(92006),t),n(r(80474),t),n(r(10554),t),n(r(41780),t),n(r(25094),t),n(r(3330),t),n(r(80359),t),n(r(74895),t)},66677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKillSwitches=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.killswitch,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"GetKillSwitches"},i=(0,o.prepareApiEndpoint)(a);t.getKillSwitches=async function(e,t){return i(e,{payload:{requestedKillswitches:t}})}},3330:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPairing=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.pairing,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"RequestPairing"},i=(0,o.prepareApiEndpoint)(a);t.requestPairing=async function(e,t){return i(e,{login:t,payload:{}})}},36273:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listInvoices=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.payments,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ListInvoices"},i=(0,o.prepareApiEndpoint)(a);t.listInvoices=async function(e,t){return i(e,{login:t,payload:{}})}},80359:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getHashes=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.pwleak,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"GetHashes"},i=(0,o.prepareApiEndpoint)(a);t.getHashes=async function(e,t){return i(e,{payload:t})}},3278:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.confirmMasterPasswordChangeDone=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"ConfirmMasterPasswordChangeDone",group:o.ApiEndpointGroups.sync,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.confirmMasterPasswordChangeDone=async function(e,t,r){return i(e,{login:t,payload:r})}},71633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDataForMasterPasswordChange=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetDataForMasterPasswordChange",group:o.ApiEndpointGroups.sync,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.getDataForMasterPasswordChange=async function(e,t,r){return i(e,{login:t,payload:r})}},19336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLatestContent=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.sync,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"GetLatestContent"},i=(0,n.prepareApiEndpoint)(a);t.getLatestContent=async function(e,t,r){return i(e,{login:t,payload:r})}},69214:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataForCryptoChange=void 0;const o=r(90338),n=r(45956),a={authenticationType:n.ApiAuthType.UserDevice,endpoint:"UploadDataForCryptoUpdate",group:n.ApiEndpointGroups.sync,method:n.ApiRequestMethod.POST,version:n.ApiVersion.v1},i=(0,o.prepareApiEndpoint)(a);t.uploadDataForCryptoChange=async function(e,t,r){return await i(e,{login:t,payload:r})}},13445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uploadDataForMasterPasswordChange=void 0;const o=r(45956),n=r(90338),a={authenticationType:o.ApiAuthType.UserDevice,endpoint:"UploadDataForMasterPasswordChange",group:o.ApiEndpointGroups.sync,method:o.ApiRequestMethod.POST,version:o.ApiVersion.v1},i=(0,n.prepareApiEndpoint)(a);t.uploadDataForMasterPasswordChange=async function(e,t,r){return i(e,{login:t,payload:r})}},49481:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lastADSyncDate=t.lastADSyncDateErrors=void 0;const o=r(90338),n=r(45956);t.lastADSyncDateErrors=["NOT_ADMIN","INSUFFICIENT_TIER"];const a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"LastADSyncDate"},i=(0,o.prepareApiEndpoint)(a);t.lastADSyncDate=function(e,t){return i(e,{login:t,payload:{}})}},21712:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computePlanPricingRequest=void 0;const o=r(45956),n=r(90338),a={group:o.ApiEndpointGroups.teams,version:o.ApiVersion.v1,method:o.ApiRequestMethod.POST,authenticationType:o.ApiAuthType.UserDevice,endpoint:"ComputePlanPricing"},i=(0,n.prepareApiEndpoint)(a);t.computePlanPricingRequest=async function(e,t,r){const o={seats:r};return await i(e,{login:t,payload:o})}},81926:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevicesErrors=t.getTeamDeviceErrors=t.createTeamDeviceAccountErrors=t.deactivateTeamDeviceErrors=t.registerTeamDeviceErrors=void 0;const o=r(59821),n=r(45956);t.registerTeamDeviceErrors=[o.NotAdmin,n.UnknownError],t.deactivateTeamDeviceErrors=[o.NotAdmin,n.UnknownError,o.DeviceKeyNotFound,o.DeactivatedTeamDevice],t.createTeamDeviceAccountErrors=[o.NotAdmin,o.DeviceAccountMappingAlreadyExists,o.InvalidTeamDeviceLogin],t.getTeamDeviceErrors=[o.NotAdmin,n.UnknownError],t.listTeamDevicesErrors=[o.NotAdmin,n.UnknownError]},28974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTeamDeviceAccount=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"CreateTeamDeviceAccount"},i=(0,o.prepareApiEndpoint)(a);t.createTeamDeviceAccount=(e,t,r)=>i(e,{login:t,payload:r})},43775:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDevice=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"DeactivateTeamDevice"},i=(0,o.prepareApiEndpoint)(a);t.deactivateTeamDevice=function(e,t,r){return i(e,{login:t,payload:r})}},9161:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDevice=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetTeamDevice"},i=(0,o.prepareApiEndpoint)(a);t.getTeamDevice=async function(e,t,r){return await i(e,{login:t,payload:r})}},34252:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevices=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ListTeamDevices"},i=(0,o.prepareApiEndpoint)(a);t.listTeamDevices=async(e,t)=>await i(e,{login:t,payload:{}})},46583:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDevice=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"RegisterTeamDevice"},i=(0,o.prepareApiEndpoint)(a);t.registerTeamDevice=function(e,t,r){return i(e,{login:t,payload:r})}},36420:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeDomainRegistrationErrors=t.completeDomainRegistration=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"CompleteDomainsRegistration"},i=(0,o.prepareApiEndpoint)(a);t.completeDomainRegistration=async function(e,t){return i(e,{login:t,payload:{}})},t.completeDomainRegistrationErrors=["NOT_ADMIN"]},32042:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateDomain=t.deactivateDomainErrors=void 0;const o=r(90338),n=r(45956);t.deactivateDomainErrors=["NOT_ADMIN","DOMAIN_NOT_FOUND","DOMAIN_NOT_VALID_FOR_TEAM","DOMAIN_CANNOT_BE_DEACTIVATED","DOMAIN_DELETION_FAILED"];const a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"DeactivateDomain"},i=(0,o.prepareApiEndpoint)(a);t.deactivateDomain=async function(e,t,r){return i(e,{login:t,payload:r})}},42216:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listDomains=t.listDomainErrors=void 0;const o=r(90338),n=r(45956);t.listDomainErrors=["NOT_ADMIN"];const a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ListDomains"},i=(0,o.prepareApiEndpoint)(a);t.listDomains=async function(e,t){return i(e,{login:t,payload:{}})}},54268:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestDomainRegistration=t.requestDomainRegistrationErrors=void 0;const o=r(90338),n=r(45956);t.requestDomainRegistrationErrors=["TEAM_DOES_NOT_EXIST","DOMAIN_ALREADY_EXISTS","NOT_ADMIN","INVALID_PUBLIC_DOMAIN","DOMAIN_NOT_VALID_FOR_TEAM","DOMAIN_CANNOT_CONTAIN_UPPERCASE_LETTERS"];const a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"RequestDomainRegistration"},i=(0,o.prepareApiEndpoint)(a);t.requestDomainRegistration=function(e,t,r){return i(e,{login:t,payload:r})}},93934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeInviteLinkTeamKey=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ChangeTeamKey"},i=(0,o.prepareApiEndpoint)(a);t.changeInviteLinkTeamKey=(e,t)=>i(e,{login:t,payload:{}})},5928:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkErrors=void 0;const o=r(45127);t.getInviteLinkErrors=[o.InviteLinkResponseErrorCode.NotAdmin,o.InviteLinkResponseErrorCode.InviteLinkNotFound,o.InviteLinkResponseErrorCode.TeamKeyNotFound,o.InviteLinkResponseErrorCode.UserInviteLinkNotFound]},32811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInviteLink=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"CreateTeamSignUpPage"},i=(0,o.prepareApiEndpoint)(a);t.createInviteLink=(e,t,r)=>i(e,{login:t,payload:r})},44609:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkForAdmin=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetTeamSignUpPageForAdmin"},i=(0,o.prepareApiEndpoint)(a);t.getInviteLinkForAdmin=(e,t)=>i(e,{login:t,payload:{}})},6563:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLink=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"GetTeamSignUpPage"},i=(0,o.prepareApiEndpoint)(a);t.getInviteLink=(e,t)=>i(e,{payload:t})},41780:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5928),t),n(r(93934),t),n(r(32811),t),n(r(6563),t),n(r(44609),t),n(r(92020),t),n(r(25731),t)},25731:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestInviteLinkToken=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.App,endpoint:"RequestTeamInviteToken"},i=(0,o.prepareApiEndpoint)(a);t.requestInviteLinkToken=(e,t)=>i(e,{payload:t})},92020:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleInviteLink=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"ToggleTeamSignUpPage"},i=(0,o.prepareApiEndpoint)(a);t.toggleInviteLink=(e,t,r)=>i(e,{login:t,payload:r})},74528:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRecoveryCodesAsTeamCaptain=t.GetRecoveryCodesAsTeamCaptainInternalErrorCode=t.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode=void 0;const o=r(90338),n=r(45956);t.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode="not_billing_admin",t.GetRecoveryCodesAsTeamCaptainInternalErrorCode="internal_error";const a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetRecoveryCodesAsTeamCaptain"},i=(0,o.prepareApiEndpoint)(a);t.getRecoveryCodesAsTeamCaptain=function(e,t,r){return i(e,{login:t,payload:r})}},95375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamMembers=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetTeamMembers"},i=(0,o.prepareApiEndpoint)(a);t.getTeamMembers=function(e,t,r){return i(e,{login:t,payload:r})}},92006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfigErrors=t.getTeamDeviceEncryptedConfigErrors=void 0;const o=r(59821),n=r(45956);t.getTeamDeviceEncryptedConfigErrors=[o.TeamDeviceEncryptedConfigNotFound,o.NotAdmin],t.updateTeamDeviceEncryptedConfigErrors=[o.NotAdmin,n.UnknownError,o.DeviceAccountMappingAlreadyExists,o.DeviceKeyNotFound]},80474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDeviceEncryptedConfig=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetTeamDeviceEncryptedConfiguration"},i=(0,o.prepareApiEndpoint)(a);t.getTeamDeviceEncryptedConfig=(e,t,r)=>i(e,{login:t,payload:r})},10554:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfig=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"UpdateTeamDeviceEncryptedConfiguration"},i=(0,o.prepareApiEndpoint)(a);t.updateTeamDeviceEncryptedConfig=(e,t,r)=>i(e,{login:t,payload:r})},56026:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamStatus=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.teams,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"TeamStatus"},i=(0,o.prepareApiEndpoint)(a);t.teamStatus=function(e,t){return i(e,{login:t,payload:{}})}},25094:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRemoteTime=void 0;const o=r(90338),n=r(45956),a={group:n.ApiEndpointGroups.time,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.None,endpoint:"GetRemoteTime"},i=(0,o.prepareApiEndpoint)(a);t.getRemoteTime=async function(e){return i(e,{payload:{}})}},74895:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateCredential=t.GetVpnCredentialBusinessErrors=void 0;const o=r(90338),n=r(45956);t.GetVpnCredentialBusinessErrors={USER_DOESNT_HAVE_VPN_CAPABILITY:"USER_DOESNT_HAVE_VPN_CAPABILITY",USER_ALREADY_HAS_AN_ACCOUNT:"USER_ALREADY_HAS_AN_ACCOUNT",USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER:"USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER",USER_ALREADY_HAVE_ACTIVE_VPN_SUBSCRIPTION:"USER_ALREADY_HAVE_ACTIVE_VPN_SUBSCRIPTION"};const a={group:n.ApiEndpointGroups.vpn,version:n.ApiVersion.v1,method:n.ApiRequestMethod.POST,authenticationType:n.ApiAuthType.UserDevice,endpoint:"GetCredentials"},i=(0,o.prepareApiEndpoint)(a);t.generateCredential=async(e,t,r)=>await i(e,{login:t,payload:r})},78577:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signRequest=t.allowedUnsignedHeaders=t.allowedUnsignedProxyHeaders=t.allowedUnsignedClientHeaders=t.signatureAlgorithm=void 0;const o=r(62433),n=r(46445),a=r(16038),i=r(69530),s=r(53),c=r(45956),d=r(15215),l=r(17825);t.signatureAlgorithm="DL1-HMAC-SHA256",t.allowedUnsignedClientHeaders=["origin","content-length","content-encoding","authorization","user-agent","accept-encoding"],t.allowedUnsignedProxyHeaders=["x-forwarded-for","x-forwarded-proto","x-forwarded-port","x-amzn-trace-id"],t.allowedUnsignedHeaders=[...t.allowedUnsignedClientHeaders,...t.allowedUnsignedProxyHeaders];function u(e){const{appKeys:t}=e,r=["AppAccessKey="+t.accessKey];switch(e.type){case c.ApiAuthType.App:return r;case c.ApiAuthType.UserDevice:{const{login:t,deviceKeys:o}=e;return[`Login=${t}`,...r,`DeviceAccessKey=${o.accessKey}`]}case c.ApiAuthType.Session:{const{deviceId:t,login:o,sessionKeys:n}=e;return[`Login=${o}`,...r,`SessionAccessKey=${n.accessKey}`,`DeviceAccessKey=${t}`]}case c.ApiAuthType.TeamDevice:{const{teamUuid:t,deviceKeys:o}=e;return[`TeamUuid=${t}`,...r,`DeviceAccessKey=${o.accessKey}`]}default:(0,l.assertUnreachable)(e)}}t.signRequest=async e=>{const{request:r,credentials:p,headersToSign:S,timestamp:m=(0,s.getUnixTimestamp)()}=e,{method:g,pathname:y,headers:A,query:f={},rawBody:E}=r,h=e=>Promise.resolve(e),v=(0,o.compose)(a.str2ab,a.utf8ChunkEncode),T=(0,o.composeP)((0,o.compose)(h,a.convertBufferToHex),n.computeHashSha256,(0,o.compose)(h,v)),_=await T(E),{canonicalRequest:I,signedHeaders:C}=(0,d.makeCanonicalRequest)({method:g,uri:y,headers:A,query:f,hashedPayload:_,headersToSign:S}),P=await T(I),D=[t.signatureAlgorithm,m,P].join("\n"),O=function(e){const{appKeys:t}=e;switch(e.type){case c.ApiAuthType.App:return t.secretKey;case c.ApiAuthType.UserDevice:{const{deviceKeys:r}=e;return`${t.secretKey}\n${r.secretKey}`}case c.ApiAuthType.Session:{const{sessionKeys:r}=e;return`${t.secretKey}\n${r.secretKey}`}case c.ApiAuthType.TeamDevice:{const{deviceKeys:r}=e;return`${t.secretKey}\n${r.secretKey}`}default:(0,l.assertUnreachable)(e)}}(p),b=v(D),w=await(0,i.signHashHmacSHA256)({key:(0,a.str2ab)(O),data:b}),N=(0,a.convertBufferToHex)(w);return t.signatureAlgorithm+" "+[...u(p),`Timestamp=${m}`,`SignedHeaders=${C}`,`Signature=${N}`].join(",")}},45956:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isApiErrorOfType=t.isApiError=t.UnknownError=t.ApiEndpointGroups=t.ApiVersion=t.ApiRequestMethod=t.ApiAuthType=void 0,t.ApiAuthType={App:"App",UserDevice:"UserDevice",None:"None",Session:"Session",TeamDevice:"TeamDevice"},t.ApiRequestMethod={GET:"GET",POST:"POST"},function(e){e[e.v1=0]="v1"}(t.ApiVersion||(t.ApiVersion={})),function(e){e.abtesting="abtesting",e.account="account",e.accountRecovery="accountrecovery",e.authentication="authentication",e.breachesQA="breaches-qa",e.dataleak="dataleak",e.dataleakQA="dataleak-qa",e.darkwebinsights="darkwebinsights",e.devices="devices",e.familyplan="familyplan",e.features="features",e.file="file",e.killswitch="killswitch",e.pairing="pairing",e.premium="premium",e.pwleak="pwleak",e.sync="sync",e.teams="teams",e.time="time",e.payments="payments",e.vpn="vpn"}(t.ApiEndpointGroups||(t.ApiEndpointGroups={})),t.UnknownError="UNKNOWN_ERROR",t.isApiError=function(e){return"object"==typeof e&&"success"!==e.code},t.isApiErrorOfType=function(e,t){return"object"==typeof t&&t.type===e}},90190:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownError=t.UnknownErrorMessages=t.UnknownErrorCode=void 0,function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR"}(r=t.UnknownErrorCode||(t.UnknownErrorCode={})),t.UnknownErrorMessages={[r.UNKNOWN_ERROR]:"Unknown error"},t.UnknownError={codes:r,name:"UnknownError",messages:t.UnknownErrorMessages}},92263:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.isCarbonError=t.CarbonError=void 0;const a=r(90190);class i extends Error{constructor(e,t){super(e.messages[t]),this.errorType=e,this.errorCode=t,this.additionalInfo={},Object.setPrototypeOf(this,i.prototype),this.name="CarbonError",Error.captureStackTrace&&Error.captureStackTrace(this,i)}errorTypeName(){return this.errorType.name}stringErrorCode(){const{errorType:{codes:e,name:t},errorCode:r}=this;return`${t}#${e[r]}`}addAdditionalInfo(e){return this.additionalInfo={...this.additionalInfo,...e},this}getAdditionalInfo(){return this.additionalInfo}addContextInfo(e,t){const{errorCode:r,errorType:o}=this;return this.message=`[${e}] - ${t}: ${o.messages[r]}`,this}toString(){return`CarbonError: ${this.message} (code ${this.stringErrorCode()})`}static fromAnyError(e,t,r){if(s(e))return e;const o=new i(t||a.UnknownError,void 0===r?a.UnknownErrorCode.UNKNOWN_ERROR:r);return s(o,a.UnknownError,a.UnknownErrorCode.UNKNOWN_ERROR)&&(o.message=e.message||`${e}`),e.stack&&(o.stack=e.stack),o}}function s(e,t,r){return e instanceof Error&&"CarbonError"===e.name&&(void 0===t||t===e.errorType)&&(void 0===r||r===e.errorCode)}t.CarbonError=i,t.isCarbonError=s,n(r(35706),t)},35706:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},45800:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCloudflareHeaders=t.setCloudflareHeaders=t.resetCloudflareHeaders=void 0;let r={};t.resetCloudflareHeaders=function(){r={}};t.setCloudflareHeaders=(e,t)=>{if(Object.isFrozen(r))throw new Error("Trying to set Cloudflare headers after initialization");e&&t&&(r={"CF-Access-Client-Id":e,"CF-Access-Client-Secret":t},Object.freeze(r))};t.getCloudflareHeaders=()=>Object.isFrozen(r)?r:{}},39266:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHttpError=t.HttpError=t.HttpErrorMessages=t.HttpErrorCode=void 0;const o=r(92263);var n;!function(e){e[e.CLIENT_ERROR=0]="CLIENT_ERROR",e[e.SERVER_ERROR=1]="SERVER_ERROR",e[e.STATUS_CODE=2]="STATUS_CODE",e[e.CONNECTION_ABORTED=3]="CONNECTION_ABORTED",e[e.CONNECTION_TIMED_OUT=4]="CONNECTION_TIMED_OUT",e[e.NETWORK_ERROR=5]="NETWORK_ERROR",e[e.NO_RESPONSE=6]="NO_RESPONSE",e[e.SETUP_FAILED=7]="SETUP_FAILED"}(n=t.HttpErrorCode||(t.HttpErrorCode={})),t.HttpErrorMessages={[n.CLIENT_ERROR]:"Http response with client error status",[n.SERVER_ERROR]:"Http response with server error status",[n.STATUS_CODE]:"Http response with non-succesful status",[n.CONNECTION_ABORTED]:"Connection aborted",[n.CONNECTION_TIMED_OUT]:"Connection timed out",[n.NETWORK_ERROR]:"Network error",[n.NO_RESPONSE]:"No response to Http request",[n.SETUP_FAILED]:"Failed to setup Http request"},t.HttpError={codes:n,name:"HttpError",messages:t.HttpErrorMessages};t.isHttpError=(e,r)=>(0,o.isCarbonError)(e,t.HttpError,r)},62628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.get=void 0;const o=r(55539);t.get=function(e,t={}){return(0,o.httpGetUsingFetch)(e,t)}},55539:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.httpGetUsingFetch=void 0;const o=r(87248);t.httpGetUsingFetch=async function(e,t={}){const r=(0,o.setTimeoutAbort)();try{const n={credentials:"omit",signal:r},a=t.headers?{...n,headers:t.headers}:n,i=await fetch(e,a);if((t.validateStatus&&!t.validateStatus(i.status))??!i.ok){const t=new o.FetchError(`HTTP ${i.status} - ${e}`);throw t.response=i,t}const s=await(0,o.getResponseBody)(i,t.responseType);return{headers:i.headers,data:s,status:i.status,statusText:i.statusText}}catch(e){console.error("[background/carbon] Failed to send GET HTTP request",e);throw(0,o.getCarbonHttpError)(e,r)}}},87248:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCarbonHttpError=t.FetchError=t.setTimeoutAbort=t.getResponseBody=t.HttpStatusCode=void 0;const o=r(17825),n=r(92263),a=r(39266);!function(e){e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT"}(t.HttpStatusCode||(t.HttpStatusCode={})),t.getResponseBody=async function(e,t="json"){switch(t){case"json":return e.json();case"text":return e.text();case"arraybuffer":return e.arrayBuffer();default:(0,o.assertUnreachable)(t)}},t.setTimeoutAbort=function(e=6e4){const t=new AbortController;return setTimeout((()=>t.abort()),e),t.signal};class i extends Error{constructor(e){super(e),this.response=void 0}}t.FetchError=i;t.getCarbonHttpError=(e,t)=>{let r=null;if(function(e){return e instanceof i}(e)&&e.response){const{response:t}=e,{status:o}=t;r=o>=400&&o<500?new n.CarbonError(a.HttpError,a.HttpErrorCode.CLIENT_ERROR):o>=500?new n.CarbonError(a.HttpError,a.HttpErrorCode.SERVER_ERROR):new n.CarbonError(a.HttpError,a.HttpErrorCode.STATUS_CODE),r.addAdditionalInfo({response:t})}else r="AbortError"===e.name&&t.aborted?new n.CarbonError(a.HttpError,a.HttpErrorCode.CONNECTION_TIMED_OUT):"AbortError"===e.name?new n.CarbonError(a.HttpError,a.HttpErrorCode.CONNECTION_ABORTED):self?.navigator?.onLine?new n.CarbonError(a.HttpError,a.HttpErrorCode.SETUP_FAILED):new n.CarbonError(a.HttpError,a.HttpErrorCode.NETWORK_ERROR);return r.addAdditionalInfo({libError:e.message}),r}},14656:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.post=t.get=void 0;var a=r(62628);Object.defineProperty(t,"get",{enumerable:!0,get:function(){return a.get}});var i=r(68109);Object.defineProperty(t,"post",{enumerable:!0,get:function(){return i.post}}),n(r(39266),t)},68109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.post=void 0;const o=r(80057);t.post=function(e,t,r={}){return(0,o.httpPostUsingFetch)(e,t,r)}},80057:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.httpPostUsingFetch=void 0;const o=r(87248);t.httpPostUsingFetch=async function(e,t,r={}){const n=(0,o.setTimeoutAbort)();try{const a=r.headers||{},i=function(e,t="application/json"){const r=t.trim().toLowerCase();if(r.startsWith("application/json"))return JSON.stringify(e);if(r.startsWith("application/x-www-form-urlencoded"))return new URLSearchParams(function(e){if("string"==typeof e)return e;return Object.keys(e).reduce(((t,r)=>{const o=e[r];return void 0===o||(t[r]="string"==typeof o?o:JSON.stringify(o)),t}),{})}(e));if(r.startsWith("multipart/form-data")){const t=new FormData;for(const[r,o]of Object.entries(e))t.append(r,o);return t}if((r.startsWith("text/plain")||r.startsWith("application/x-jsonlines"))&&"string"==typeof e)return e;throw new Error("Unsupported Content-Type for HTTP POST")}(t,a["Content-Type"]),s={method:"POST",headers:a,body:i,credentials:"omit",signal:n},c=await fetch(e,s);if((r.validateStatus&&!r.validateStatus(c.status))??!c.ok){const t=new o.FetchError(`HTTP ${c.status} - ${e}`);throw t.response=c,t}const d=await(0,o.getResponseBody)(c,r.responseType);return{headers:c.headers,data:d,status:c.status,statusText:c.statusText}}catch(e){console.error("[background/carbon] Failed to send POST HTTP request",e);throw(0,o.getCarbonHttpError)(e,n)}}},89021:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBatch=void 0;const o=r(78912),n=r(59890);t.getBatch=function(e,t,r){const a="zero"===t.startCursor.type?0:(0,n.binaryFindIndex)(r,(r=>(0,o.isAfterTokenStart)(e,t,!1,r)));if(-1===a)return[];const i=r.slice(a),s="infinite"===t.endCursor.type?i.length:(0,n.binaryFindIndex)(i,(r=>(0,o.isAfterTokenEnd)(e,t,!1,r)),t.initialBatchSize),c=-1===s?i.length:s;return i.slice(0,c)}},20553:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBatch=t.generatePrevToken=t.generateNextToken=t.generateFirstToken=void 0;var o=r(93669);Object.defineProperty(t,"generateFirstToken",{enumerable:!0,get:function(){return o.generateFirstToken}}),Object.defineProperty(t,"generateNextToken",{enumerable:!0,get:function(){return o.generateNextToken}}),Object.defineProperty(t,"generatePrevToken",{enumerable:!0,get:function(){return o.generatePrevToken}});var n=r(89021);Object.defineProperty(t,"getBatch",{enumerable:!0,get:function(){return n.getBatch}})},78912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBeforeTokenStart=t.isAfterTokenEnd=t.isBeforeTokenEnd=t.isAfterTokenStart=void 0;const o=r(62433),n=r(35893);function a(e,t){return e>t}function i(e,t){return e<t}function s(e,t){return(0,o.compose)(n.normalizeStringMapper,e[t])}const c=(0,o.curry)((function(e,t,{0:r,1:o}){const{direction:c,field:d}=r,l=s(e,d);return(e=>"ascend"===e?a:i)(c)(l(t),(0,n.normalizeStringMapper)(o))})),d=(0,o.curry)((function(e,t,{0:r,1:o}){const{direction:n,field:c}=r,d=s(e,c);return(e=>"ascend"===e?i:a)(n)(d(t),o)})),l=(0,o.curry)((function(e,t,{0:r,1:o}){const{field:n}=r;return s(e,n)(t)===o}));function u(e){return void 0!==e&&[!0,!1].includes(e)}function p(e){return{direction:"ascend",field:e}}const S=(e,t)=>(r,n,a,i)=>{const{sortCriteria:s,uniqField:S}=n.sortToken,m="start"===t?n.startCursor:n.endCursor;if("zero"===m.type)return"after"===e;if("infinite"===m.type)return"before"===e;const g=l(r,i),y=((e,t)=>r=>r.reduce(((r,o)=>u(r)?r:function(e,t,r){return!!e(r)||!!t(r)&&void 0}(e,t,o)),void 0))("before"===e?d(r,i):c(r,i),g),A=y((0,o.zip)(s,m.sortValues));if(u(A))return A;const f=y([{0:p(S),1:m.uniqValue}]);return u(f)?f:!a};t.isAfterTokenStart=S("after","start"),t.isBeforeTokenEnd=S("before","end"),t.isAfterTokenEnd=S("after","end"),t.isBeforeTokenStart=S("before","start")},33627:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sameBatch=void 0;const o=r(62433);t.sameBatch=function(e,t){return e.length===t.length&&e.every(((e,r)=>(0,o.equals)(t[r],e)))}},93669:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateFirstToken=t.generatePrevToken=t.generateNextToken=t.zeroCursor=t.infiniteCursor=void 0;const o=r(62433),n=r(35893),a=r(59890),i=r(78912);function s(e,t,r){return r.sortCriteria.map((r=>{const{field:a}=r;return(0,o.compose)(n.normalizeStringMapper,e[a])(t)}))}function c(e,r,o,n,a){const i=n+o-1;if(i>=a.length-1)return t.infiniteCursor;const c=a[i];return{type:"positional",sortValues:s(e,c,r),uniqValue:String(e[r.uniqField](c))}}function d(e,r,o){const{initialBatchSize:n,startCursor:c,sortToken:d}=r;if("zero"===c.type)throw new Error("Cannot generate cursor before zero start cursor.");const l=(0,a.binaryFindLastIndex)(o,(t=>(0,i.isBeforeTokenStart)(e,r,!0,t)));if(-1===l)return t.zeroCursor;const u=function(e,r,o,n,a){const i=n-o+1;if(i<0)return t.zeroCursor;const c=a[i];return{type:"positional",sortValues:s(e,c,r),uniqValue:String(e[r.uniqField](c))}}(e,d,n,l,o);return u}t.infiniteCursor={type:"infinite"},t.zeroCursor={type:"zero"},t.generateNextToken=function(e,r,o){if("infinite"===r.endCursor.type)return;const n=function(e,r,o){const{initialBatchSize:n,endCursor:s,sortToken:d}=r;if("infinite"===s.type)throw new Error("Cannot generate cursor after infinite end cursor.");const l=(0,a.binaryFindIndex)(o,(t=>(0,i.isAfterTokenEnd)(e,r,!1,t)));return-1===l?t.infiniteCursor:c(e,d,n,l,o)}(e,r,o);return{...r,startCursor:r.endCursor,endCursor:n}},t.generatePrevToken=function(e,t,r){if("zero"===t.startCursor.type)return;const o=d(e,t,r);return{...t,startCursor:o,endCursor:t.startCursor}},t.generateFirstToken=function(e,r,o,n){const{sortToken:a,filterToken:i}=r,s=c(e,a,o,0,n);return{sortToken:a,filterToken:i,initialBatchSize:o,startCursor:t.zeroCursor,endCursor:s}}},4673:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPlugins=t.setPlugins=void 0;let r={};t.setPlugins=function(e){r=e},t.getPlugins=function(){return r}},60946:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(74211),t),n(r(20378),t)},20378:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupProbe=void 0;const o=r(62433),n=r(95623),a=(e,t)=>r=>(0,o.forEach)(((e,t)=>r=>{try{e(r,t)}catch(e){(0,n.logWarn)({message:`Monitor raised an error on announcement ${r.type}`,tag:"Probe",details:{error:e}})}})(r,t),e);t.setupProbe=(...e)=>(...t)=>{const r={timestamp:Date.now()};(0,o.forEach)(a(t,r),e)}},74211:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},59865:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterData=void 0;const o=r(62433),n=r(2974),a=r(17825);t.filterData=function(e,t,r,i){return r.filterCriteria.reduce(((r,i)=>{const s=function(e,t,r){const{value:i}=r,s=(0,n.normalizeStringMapper)(i),c=t=>(0,o.compose)(n.normalizeStringMapper,e[t]);switch(r.type){case"equals":return e=>c(r.field)(e)===s;case"differs":return e=>c(r.field)(e)!==s;case"matches":return e=>t(s,e);case"in":return e=>{const t=c(r.field)(e);return s.indexOf(t)>-1};case"contains":return e=>{const t=c(r.field)(e);if(!Array.isArray(t))throw new Error("[Query] - filter: expected an array");return t.includes(s)};default:(0,a.assertUnreachable)(r)}}(e,t,i);return r.filter(s)}),i)}},35893:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeStringMapper=t.queryData=t.sortData=t.filterData=t.stringifyToken=t.parseToken=t.optimizeBatchSelector=t.createOptimizedSortTokenSelector=t.createOptimizedFilterTokenSelector=void 0;var o=r(23736);Object.defineProperty(t,"createOptimizedFilterTokenSelector",{enumerable:!0,get:function(){return o.createOptimizedFilterTokenSelector}}),Object.defineProperty(t,"createOptimizedSortTokenSelector",{enumerable:!0,get:function(){return o.createOptimizedSortTokenSelector}}),Object.defineProperty(t,"optimizeBatchSelector",{enumerable:!0,get:function(){return o.optimizeBatchSelector}});var n=r(54410);Object.defineProperty(t,"parseToken",{enumerable:!0,get:function(){return n.parseToken}}),Object.defineProperty(t,"stringifyToken",{enumerable:!0,get:function(){return n.stringifyToken}});var a=r(59865);Object.defineProperty(t,"filterData",{enumerable:!0,get:function(){return a.filterData}});var i=r(32541);Object.defineProperty(t,"sortData",{enumerable:!0,get:function(){return i.sortData}});var s=r(7994);Object.defineProperty(t,"queryData",{enumerable:!0,get:function(){return s.queryData}});var c=r(2974);Object.defineProperty(t,"normalizeStringMapper",{enumerable:!0,get:function(){return c.normalizeStringMapper}})},2974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeStringMapper=void 0;const o=r(62433),n=r(97601),a=(0,o.compose)(n.normalizeString,o.toLower);t.normalizeStringMapper=e=>"string"==typeof e?a(e):Array.isArray(e)?e.map(t.normalizeStringMapper):e},7994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queryData=void 0;const o=r(59865),n=r(32541);t.queryData=function(e,t,r,a,i){const s=(0,o.filterData)(e,t,a,i);return(0,n.sortData)(e,r,s)}},23736:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.optimizeBatchSelector=t.createOptimizedFilterTokenSelector=t.createOptimizedSortTokenSelector=void 0;const o=r(62433),n=r(32034);t.createOptimizedSortTokenSelector=(0,n.createSelectorCreator)(n.defaultMemoize,((e,t)=>e.uniqField===t.uniqField&&e.sortCriteria.length===t.sortCriteria.length&&e.sortCriteria.every(((e,r)=>Object.keys(e).every((o=>e[o]===t.sortCriteria[r][o]))))));t.createOptimizedFilterTokenSelector=(0,n.createSelectorCreator)(n.defaultMemoize,((e,t)=>e.filterCriteria.length===t.filterCriteria.length&&e.filterCriteria.every(((e,r)=>Object.keys(e).every((o=>e[o]===t.filterCriteria[r][o]))))));const a=(0,n.createSelectorCreator)(n.defaultMemoize,((e,t)=>e.length===t.length&&e.every(((e,r)=>t[r]===e))));t.optimizeBatchSelector=e=>a(e,o.identity)},32541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortData=void 0;const o=r(2974),n=r(62433);function a(e,t){const{direction:r}=t,a=function(e,t){const{field:r}=t;return(0,n.compose)(o.normalizeStringMapper,e[r])}(e,t);return function(e){return"ascend"===e?n.ascend:n.descend}(r)(a)}t.sortData=function(e,t,r){const o=(0,n.compose)(String,e[t.uniqField]),i=[...t.sortCriteria.map((t=>a(e,t))),(0,n.ascend)(o)];return(0,n.sortWith)(i)(r)}},54410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stringifyToken=t.parseToken=void 0;const o=r(16038),n=r(93513);t.parseToken=function(e){const t=n.decode(e),r=(0,o.utf8ChunkDecode)(t);return JSON.parse(r)},t.stringifyToken=function(e){if(void 0===e)return"";const t=JSON.stringify(e),r=(0,o.utf8ChunkEncode)(t);return n.encode(r)}},74752:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeAutoLoginService=t.loadMPFromStorageToStore=t.shouldTrigger=t.createMasterPasswordCipheringKey=t.AUTOLOGIN_EXPIRATION_DATE=void 0;const o=r(12206),n=r(69530),a=r(16038),i=r(16356),s=r(53),c=r(70252),d=r(95623),l=r(56915),u=r(46298),p=r(16593),S=r(61740),m=r(98226),g=r(93564);t.AUTOLOGIN_EXPIRATION_DATE=1209600;t.createMasterPasswordCipheringKey=()=>(0,n.generateAESKey)();const y=()=>{try{const e=(()=>{const e=(0,g.getWindowLocalStorage)();return o.env.isBrowserEnvironment()&&e?parseInt(e["QA.EXTENSION-1474.expirationTimeSeconds"],10):void 0})();if(Number.isSafeInteger(e)&&e<t.AUTOLOGIN_EXPIRATION_DATE)return e}catch(e){(0,d.logError)(e)}return t.AUTOLOGIN_EXPIRATION_DATE};t.shouldTrigger=async(e,t,r,o,n)=>{try{if(t.setInstance(n),e.isAuthenticated())return!1;if(!await(0,S.hasSessionKeysInStorage)(t))return!1;await(0,S.loadSessionKeysToStore)(e,r,t,o);const a=(0,l.sessionKeysSelector)(e.getState());return(0,S.areSessionKeysValid)(a)?t.getInstance().doesMasterPasswordExist():((0,S.cleanRememberMeStorageData)(e,r,o),!1)}catch(e){if(e.message!==S.RememberMeErrorCode.EMPTY_SESSION_KEYS){const t=new Error(`[Autologin] - shouldTrigger: ${e}`);(0,c.sendExceptionLog)({error:t}),(0,d.logError)(e)}return!1}};t.loadMPFromStorageToStore=async(e,t,r,o,n,a)=>{const s=await(0,u.getMasterPasswordCipheringKey)(t,a);if((0,u.isApiError)(s))throw"invalid_request_error"===s.type&&"unknown_session_key"===s.code&&(0,S.cleanRememberMeStorageData)(t,e,n),new Error(s.message);r.setInstance({raw:s.rememberMasterPasswordCipheringKey},"");const c=await o.getInstance().getMasterPassword();t.dispatch((0,i.updateMasterPassword)(c))};t.makeAutoLoginService=e=>({initialize:()=>(async e=>{try{const{storeService:r,localStorageService:o,sessionClient:n}=e;if(!r.isAuthenticated())throw new Error(S.RememberMeErrorCode.USER_NOT_AUTHENTICATED);const c=r.getState(),d=await(0,l.getDeviceKeysFromSession)(n),g=(0,l.sessionKeysSelector)(c),A=(0,p.userLoginSelector)(c);if(!d)throw new Error(S.RememberMeErrorCode.EMPTY_DEVICE_KEYS);if((0,S.areSessionKeysValid)(g))return;const f=await(0,t.createMasterPasswordCipheringKey)(),E=(0,a.bufferToBase64)(f),h=await(0,u.initRememberMasterPassword)(r,A,{rememberMasterPasswordCipheringKey:E});if((0,u.isApiError)(h))throw new Error(h.code);const v=(0,s.getUnixTimestamp)()+y(),T={accessKey:h.sessionAccessKey,secretKey:h.sessionSecretKey,expirationTimeSeconds:v};r.dispatch((0,i.loadSessionKeys)(T)),await o.getInstance().storeAuthenticationKeys(T),e.autoLoginEncryptorService.setInstance({raw:null,buffer:f},"");const _=(0,p.masterPasswordSelector)(c);await o.getInstance().storeMasterPassword(_),await(0,S.persistLocalAccountRememberMeType)(r,"autologin"),r.dispatch((0,m.setRememberMeTypeAction)("autologin"))}catch(e){const t=new Error(`[Autologin] - initialize: ${e}`);(0,c.sendExceptionLog)({error:t}),(0,d.logError)(t)}})(e),process:r=>(async(e,r)=>{try{const{sessionClient:o,storageService:n,storeService:a,autoLoginEncryptorService:i,localStorageService:s}=e;if(!await(0,t.shouldTrigger)(a,s,n,o,r))return;await(0,t.loadMPFromStorageToStore)(n,a,i,s,o,r)}catch(e){const t=new Error(`[Autologin] - processAutoLogin: ${e}`);(0,c.sendExceptionLog)({error:t}),(0,d.logError)(t)}})(e,r),shouldTrigger:r=>(0,t.shouldTrigger)(e.storeService,e.localStorageService,e.storageService,e.sessionClient,r)})},93990:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWebAuthnAuthenticationService=t.shouldTrigger=void 0;const o=r(16038),n=r(95623),a=r(69530),i=r(56915),s=r(46298),c=r(16593),d=r(16356),l=r(70252),u=r(64910),p=r(61740),S=r(98226);t.shouldTrigger=async(e,t,r,o,a)=>{try{if(r.setInstance(a),(0,c.isAuthenticatedSelector)(e.getState()))return!1;if(!await(0,p.hasSessionKeysInStorage)(r))return!1;await(0,p.loadSessionKeysToStore)(e,t,r,o);const n=(0,i.sessionKeysSelector)(e.getState());return!!(0,p.areSessionKeysValid)(n)&&r.getInstance().doesMasterPasswordExist()}catch(e){if(e.message!==p.RememberMeErrorCode.EMPTY_SESSION_KEYS){const t=new Error(`[WebAuthnAuthentication] - shouldTrigger: ${e}`);(0,l.sendExceptionLog)({error:t}),(0,n.logError)(t)}return!1}};t.makeWebAuthnAuthenticationService=e=>({initialize:t=>(async(e,t)=>{try{const{storeService:r,localStorageService:n,webAuthnAuthenticationEncryptorService:i}=e,l=r.getState(),m=(0,c.userLoginSelector)(l),g=await(0,a.generate64BytesKey)(),y=(0,o.bufferToBase64)(g),A=atob(y),f=await(0,s.completeRememberMeRegistration)(r,m,{masterPasswordEncryptionKey:y,authenticator:t});if((0,s.isApiError)(f))throw new Error(f.code);const E={accessKey:f.sessionAccessKey,secretKey:f.sessionSecretKey,expirationTimeSeconds:f.sessionExpirationDateUnix};r.dispatch((0,d.loadSessionKeys)(E)),await n.getInstance().storeAuthenticationKeys(E);const h="",v=(0,u.getNoDerivationCryptoConfig)();i.setInstance({raw:A},h,v);const T=(0,c.masterPasswordSelector)(l);return await n.getInstance().storeWebAuthnMasterPassword(T),await(0,p.persistLocalAccountRememberMeType)(r,"webauthn"),r.dispatch((0,S.setRememberMeTypeAction)("webauthn")),!0}catch(e){const t=new Error(`[WebAuthnAuthentication] - initialize: ${e}`);return(0,l.sendExceptionLog)({error:t}),(0,n.logError)(t),!1}})(e,t),process:(t,r)=>(async(e,t,r)=>{try{const{storeService:o,webAuthnAuthenticationEncryptorService:n,localStorageService:a}=e,i=await(0,s.completeRememberMeOpenSession)(o,t,{authenticator:r});if((0,s.isApiError)(i))throw new Error(i.message);const c="",l=(0,u.getNoDerivationCryptoConfig)(),p=i.masterPasswordEncryptionKey,S=atob(p);n.setInstance({raw:S},c,l);const m=await a.getInstance().getWebAuthnMasterPassword();o.dispatch((0,d.updateMasterPassword)(m))}catch(e){const t=new Error(`[WebAuthnAuthentication] - processWebAuthnAuthentication: ${e}`);(0,l.sendExceptionLog)({error:t}),(0,n.logError)(t)}})(e,t,r),shouldTrigger:r=>(0,t.shouldTrigger)(e.storeService,e.storageService,e.localStorageService,e.sessionClient,r),deactivate:t=>(async(e,t)=>{const{storeService:r,localStorageService:o,sessionClient:n}=e,a=await(0,i.getDeviceAccessKeysFromSession)(n,t);if(!a)return!1;const c=await(0,s.deactivateRememberMe)(r,t,{deviceAccessKey:a});return!(0,s.isApiError)(c)&&(await o.getInstance().cleanAuthenticationKey(),await(0,p.persistLocalAccountRememberMeType)(r,"disabled"),r.dispatch((0,S.setRememberMeTypeAction)("disabled")),!0)})(e,t)})},61740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSessionKeysValid=t.loadSessionKeysToStore=t.hasSessionKeysInStorage=t.shouldAskMasterPassword=t.cleanRememberMeStorageData=t.getLocalAccountRememberMeType=t.persistLocalAccountRememberMeType=t.RememberMeErrorCode=void 0;const o=r(2246),n=r(63739),a=r(25576),i=r(1860),s=r(16356),c=r(53),d=r(16593),l=r(46298),u=r(56915),p=r(92263),S=r(70252),m=r(95623);var g;!function(e){e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.EMPTY_DEVICE_KEYS="EMPTY_DEVICE_KEYS",e.EMPTY_SESSION_KEYS="EMPTY_SESSION_KEYS"}(g=t.RememberMeErrorCode||(t.RememberMeErrorCode={}));t.persistLocalAccountRememberMeType=async(e,t)=>{const{login:r,persistData:n}=e.getAccountInfo();n===a.PersistData.PERSIST_DATA_YES&&await(0,o.storeUserPublicSetting)(r,"rememberMeType",t)};t.getLocalAccountRememberMeType=e=>(0,o.getUserPublicSetting)(e,"rememberMeType");t.cleanRememberMeStorageData=async(e,r,o)=>{const a=(0,d.userLoginSelector)(e.getState()),i=[(0,n.removeData)(r,a,"authenticationKeys"),(0,n.removeData)(r,a,"registry"),(0,t.persistLocalAccountRememberMeType)(e,"disabled")];if("disabled"!==(0,u.rememberMeTypeSelector)(e.getState())){const t=new Promise((t=>{(async(e,t,r)=>{const o=await(0,u.getDeviceAccessKeysFromSession)(t,r);o&&await(0,l.deactivateRememberMe)(e,r,{deviceAccessKey:o})})(e,o,a).then(t).catch((e=>{const r=p.CarbonError.fromAnyError(e).addContextInfo("RememberMe","cleanRememberMeStorageData");(0,m.logError)({message:"Error when deactivating remember me server side"}),(0,S.sendExceptionLog)({error:r}),t()}))}));i.push(t)}await Promise.allSettled(i)};t.shouldAskMasterPassword=e=>{const r=(0,t.getLocalAccountRememberMeType)(e);if(!["autologin","webauthn"].includes(r))return!1;const n=(0,o.getUserPublicSetting)(e,"lastMasterPasswordOpenSessionTimestamp")||void 0;if(!n)return;return Date.now()-n>12096e5};t.hasSessionKeysInStorage=async e=>await e.getInstance().doesAuthenticationKeysExist();t.loadSessionKeysToStore=async(e,r,o,n)=>{try{if(!(0,t.hasSessionKeysInStorage)(o))throw new Error(g.EMPTY_SESSION_KEYS);const r=await o.getInstance().getAuthenticationKeys();e.dispatch((0,s.loadSessionKeys)(r))}catch(o){throw o.message.indexOf(i.DATA_TAMPERED_ERROR)>-1&&(0,t.cleanRememberMeStorageData)(e,r,n),o}};t.areSessionKeysValid=e=>e?.expirationTimeSeconds>(0,c.getUnixTimestamp)()},31937:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.restoreLastAuthenticatedUser=void 0;const o=r(95623),n=r(88610),a=r(70252),i=r(9344),s=r(52968),c=r(35924),d=r(78759);t.restoreLastAuthenticatedUser=async function(e,t){try{const{applicationModulesAccess:r,storeService:o}=e,a=t.find((e=>e.isLastSuccessfulLogin));if(!a||a.hasLoginOtp)return;const l=o.getState();if(l.userSession.ssoSettings.ssoUser)return;const u=a.login,p=l.authentication.localUsers;if(void 0!==p[u]&&p[u].ssoActivatedUser){return void((0,d.disableAutoSSOLoginSelector)(l)||(e.storeService.dispatch((0,c.updateLoginStepInfoLogin)(u)),"sso"===a.rememberMeType&&r.createClients().authenticationFlow.commands.initiateAutologinWithSSO({login:u??""})))}if("webauthn"===a.rememberMeType)return void function({storeService:e}){try{document.featurePolicy.features().includes("publickey-credentials-get")&&e.dispatch((0,i.reactivationStatusUpdated)(s.ReactivationStatus.WEBAUTHN))}catch(t){e.dispatch((0,i.reactivationStatusUpdated)(s.ReactivationStatus.CLASSIC))}}(e);const S="autologin"===a.rememberMeType&&await e.autoLoginService.shouldTrigger(u),m=(0,n.makeLoginController)(e);if(!S)return void m.openSession(u);await e.autoLoginService.process(u);const g=e.storeService.getUserSession().masterPassword;if(!g)return;await m.openSessionWithMasterPassword(u,g,{triggeredByRememberMeType:"autologin",loginType:"Autologin"})}catch(e){const t=`[index] - restoreLastAuthenticatedUser: ${e}`,r=new Error(t);(0,o.logError)({message:t,details:{error:r}}),(0,a.sendExceptionLog)({error:r})}}},98416:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeLocalStorageService=void 0;const o=r(63739);t.makeLocalStorageService=e=>{let t=null;return{setInstance:r=>{t=(0,o.makeUserLocalDataService)(e,r)},getInstance:()=>{if(!t)throw new Error("makeLocalStorageService: You must call setInstance(login: string) before getting the instance");return t}}}},63739:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserLocalDataService=t.deleteAllLocalUserData=t.isDataStored=t.removeData=t.getStorageDebugKey=t.getStorageKey=t.STORAGE_VERSION=t.StoredUserDataTypeEnum=void 0;const o=r(45127),n=r(95623),a=r(41265),i=r(16038),s=r(16593),c=r(19695),d=r(56668),l=r(54677),u=r(75417),p=r(93513);t.StoredUserDataTypeEnum=["abTests","authentication","authenticationKeys","eventStore","health","healthWasComputed","icons","localDataBackupLastLoginSuccessful","localDataBackupTmp","localKey","localSettings","notificationsStatus","personalData","personalSettings","recoveryData","recoveryLocalKey","recoverySessionCredential","registry","remoteFileContent","remoteFileMeta","sharingData","sharingSync","teamAdminData","userActivity","vaultReport","analyticsIds"],t.STORAGE_VERSION="v1";t.getStorageKey=(e,r,o=t.STORAGE_VERSION)=>`${e}.${r}.${o}`;t.getStorageDebugKey=(e,r,o=t.STORAGE_VERSION)=>(0,t.getStorageKey)(e,r,o)+".clear";const S=(e,t)=>`${e}.${t}`,m=async(e,t,r)=>{const o=await e.getLocalStorage().readItem(r);if("string"!=typeof o||0===o.length)throw new Error(`value ${t} undefined`);return o},g=async(e,r,a,s)=>{const c=r.getLocalStorage(),l=(0,t.getStorageKey)(a,s);if(await c.itemExists(l))return(async(e,t,r,o)=>{const n=await m(t,r,o),a=await e.getInstance().decrypt(n),i=(0,d.inflateUtf16)(a);return JSON.parse(i)})(e,r,s,l);const u=S(a,s);if(await c.itemExists(u))return(async(e,t,r,a)=>{const s=await m(t,r,a),c=await e.getInstance().decrypt(s),l=(0,d.deflatedUtf8ToUtf16)(c,{skipUtf8Decoding:!0});if(0===l.length)throw new Error(o.AuthenticationCode[o.AuthenticationCode.WRONG_PASSWORD]);const u=p.decode(l);try{const e=(0,i.utf8ChunkDecode)(u);return JSON.parse(e)}catch(e){return n.default.log(e),u}})(e,r,s,u);const g=new Error("value "+s+" undefined");throw n.default.error(g),g},y=async(e,r,o,i,s)=>{try{const n=e.getLocalStorage(),c=(0,t.getStorageKey)(r,i);if(await n.writeItem(c,o),(0,a.isInternalTestUser)(r)&&s){const o=(0,t.getStorageDebugKey)(r,i);await e.getLocalStorage().writeItem(o,s)}}catch(e){const t=new Error(`[storeData] failed for dataType: ${i} with error: ${e}`);throw n.default.error(t),t}},A=async(e,t,r,o,n)=>{const a=JSON.stringify(o),i=(0,d.deflateUtf16)(a),s=await e.getInstance().encrypt(i);await y(t,r,s,n,o)};t.removeData=async(e,r,o)=>{const n=(0,t.getStorageKey)(r,o),i=S(r,o),s=(0,t.getStorageDebugKey)(r,o),c=((e,t)=>S(e,t)+".clear")(r,o),d=e.getLocalStorage(),l=[d.removeItem(n),d.removeItem(i),...(0,a.isInternalTestUser)(r)?[d.removeItem(s),d.removeItem(c)]:[]];await Promise.all(l)};t.isDataStored=async(e,r,o)=>{const n=e.getLocalStorage(),a=(0,t.getStorageKey)(r,o);if(await n.itemExists(a))return!0;const i=S(r,o);return await n.itemExists(i)},t.deleteAllLocalUserData=async function(e,r,n){const a=n.trim();await Promise.all([...t.StoredUserDataTypeEnum,...o.FileNamesList].map((async r=>{await(0,t.removeData)(e,a,r)}))),await async function(e,t){await e.commands.mitigationDeleteGrapheneUserData({login:t})}(r,n)};t.makeUserLocalDataService=(e,r)=>{const a=()=>{const{storeService:t,masterPasswordEncryptorService:r,localDataEncryptorService:o}=e;return(0,s.isLocalKeyActivatedSelector)(t.getState())?o:r};return{storePersonalData:t=>A(a(),e.storageService,r,t,"personalData"),getPersonalData:()=>(n.default.log("Load Personal Data"),g(a(),e.storageService,r,"personalData")),doesPersonalDataExist:()=>(n.default.log("Check Personal Data existence"),(0,t.isDataStored)(e.storageService,r,"personalData")),storeLocalSettings:t=>A(a(),e.storageService,r,t,"localSettings"),getLocalSettings:()=>(n.default.log("Load Local Settings"),g(a(),e.storageService,r,"localSettings")),storePersonalSettings:t=>A(a(),e.storageService,r,t,"personalSettings"),getPersonalSettings:()=>(n.default.log("Load Personal Settings"),g(a(),e.storageService,r,"personalSettings")),storeNotificationsStatus:t=>A(a(),e.storageService,r,t,"notificationsStatus"),doesNotificationStatusExist:()=>(n.default.log("Check Notification Status existence"),(0,t.isDataStored)(e.storageService,r,"notificationsStatus")),getNotificationStatus:()=>(n.default.log("Load Notifications Status"),g(a(),e.storageService,r,"notificationsStatus")),storeSharingData:t=>A(a(),e.storageService,r,t,"sharingData"),getSharingData:()=>(n.default.log("Load Sharing Data"),g(a(),e.storageService,r,"sharingData")),storeSharingSync:t=>A(a(),e.storageService,r,t,"sharingSync"),getSharingSync:()=>(n.default.log("Load Sharing Sync"),g(a(),e.storageService,r,"sharingSync")),doesSharingSyncExist:()=>(0,t.isDataStored)(e.storageService,r,"sharingSync"),storeTeamAdminData:t=>A(a(),e.storageService,r,t,"teamAdminData"),getTeamAdminData:()=>(n.default.log("Load Team Admin Data"),g(a(),e.storageService,r,"teamAdminData")),storeAuthenticationKeys:t=>A(e.authorizationKeysEncryptorService,e.storageService,r,t,"authenticationKeys"),getAuthenticationKeys:()=>(n.default.log("Load Authentication Keys"),g(e.authorizationKeysEncryptorService,e.storageService,r,"authenticationKeys").then((e=>e))),doesAuthenticationKeysExist:()=>(n.default.log("Check Authentication Keys existence"),(0,t.isDataStored)(e.storageService,r,"authenticationKeys")),cleanAuthenticationKey:()=>(0,t.removeData)(e.storageService,r,"authenticationKeys"),storeAuthenticationData:t=>A(a(),e.storageService,r,t,"authentication"),getAuthenticationData:()=>g(a(),e.storageService,r,"authentication"),hasAuthenticationData:()=>(0,t.isDataStored)(e.storageService,r,"authentication"),doesMasterPasswordExist:()=>(n.default.log("Check Master Password Keys existence"),(0,t.isDataStored)(e.storageService,r,"registry")),clearMasterPassword:async()=>{const o=e.storageService;await(0,t.removeData)(o,r,"registry")},getMasterPassword:()=>(n.default.log("Load Master Password via Auto login"),g(e.autoLoginEncryptorService,e.storageService,r,"registry")),storeMasterPassword:t=>(n.default.log("Store Master Password via Auto login"),A(e.autoLoginEncryptorService,e.storageService,r,t,"registry")),getWebAuthnMasterPassword:()=>(n.default.log("Load Master Password via WebAuthn login"),g(e.webAuthnAuthenticationEncryptorService,e.storageService,r,"registry")),storeWebAuthnMasterPassword:t=>(n.default.log("Store Master Password via WebAuthn login"),A(e.webAuthnAuthenticationEncryptorService,e.storageService,r,t,"registry")),getLocalKey:()=>g(e.masterPasswordEncryptorService,e.storageService,r,"localKey"),doesLocalKeyExist:()=>(0,t.isDataStored)(e.storageService,r,"localKey"),storeLocalKey:t=>A(e.masterPasswordEncryptorService,e.storageService,r,t,"localKey"),doesLocalDataExist:()=>Promise.all(["localSettings","personalData","personalSettings"].map((o=>(0,t.isDataStored)(e.storageService,r,o)))).then((e=>e.every((e=>e)))),storeUserABTests:t=>A(a(),e.storageService,r,t,"abTests"),getUserABTests:()=>(n.default.log("Load User AB Tests"),g(a(),e.storageService,r,"abTests")),storeIcons:async t=>{const o=(0,c.iconsToStorage)(t);return A(a(),e.storageService,r,o,"icons")},getIcons:async()=>{if(!await(0,t.isDataStored)(e.storageService,r,"icons"))return null;const o=await g(a(),e.storageService,r,"icons");return(0,c.iconsFromStorage)(o)},doesUserActivityExist:()=>(0,t.isDataStored)(e.storageService,r,"userActivity"),storeUserActivity:()=>A(a(),e.storageService,r,{},"userActivity"),getUserActivity:()=>g(a(),e.storageService,r,"userActivity"),doesVaultReportExist:()=>(0,t.isDataStored)(e.storageService,r,"vaultReport"),storeVaultReport:t=>A(a(),e.storageService,r,t,"vaultReport"),getVaultReport:()=>g(a(),e.storageService,r,"vaultReport"),storeEventStore:t=>A(a(),e.storageService,r,t,"eventStore"),getEventStore:async()=>await(0,t.isDataStored)(e.storageService,r,"eventStore")?g(a(),e.storageService,r,"eventStore"):null,storeRecoveryLocalKey:async t=>{const o=e.storageService;return y(o,r,t,"recoveryLocalKey")},getRecoveryLocalKey:async()=>{const o=(0,t.getStorageKey)(r,"recoveryLocalKey");return await m(e.storageService,"recoveryLocalKey",o)},storeRecoverySessionCredential:t=>A(a(),e.storageService,r,t,"recoverySessionCredential"),getRecoverySessionCredential:async()=>g(a(),e.storageService,r,"recoverySessionCredential"),doesRecoverySessionCredentialExist:async()=>(0,t.isDataStored)(e.storageService,r,"recoverySessionCredential"),cleanRecoverySetupData:async()=>{const o=e.storageService;return await(0,t.removeData)(o,r,"recoverySessionCredential"),await(0,t.removeData)(o,r,"recoveryLocalKey")},doesRecoveryLocalKeyExist:async()=>(0,t.isDataStored)(e.storageService,r,"recoveryLocalKey"),cleanRecoveryData:async()=>{const o=e.storageService;return await(0,t.removeData)(o,r,"recoveryData")},storeRecoveryData:async t=>{const o=e.storageService;return await y(o,r,t,"recoveryData")},getRecoveryData:async()=>{const o=(0,t.getStorageKey)(r,"recoveryData");return await m(e.storageService,"recoveryData",o)},doesRecoveryDataExist:()=>(0,t.isDataStored)(e.storageService,r,"recoveryData"),storeAnalyticsIds:t=>A(a(),e.storageService,r,t,"analyticsIds"),getAnalyticsIds:()=>((0,n.log)({message:"Load Analytics IDs"}),g(a(),e.storageService,r,"analyticsIds")),doesAnalyticsIdsExist:()=>((0,n.log)({message:"Check Analytics IDs existence"}),(0,t.isDataStored)(e.storageService,r,"analyticsIds")),storeRemoteFileContent:(t,o)=>A(a(),e.storageService,r,o,t),storeRemoteFileMeta:t=>A(a(),e.storageService,r,t,"remoteFileMeta"),getRemoteFileMeta:async()=>{const{storageService:o}=e,n=await g(a(),o,r,"remoteFileMeta");return(0,l.isFileRevisionMapper)(n)?n:(await(0,t.removeData)(o,r,"remoteFileMeta"),(0,u.defaultRemoteFileState)().fileMetaData)},getRemoteFileContent:t=>g(a(),e.storageService,r,t),cleanAllRemoteFiles:async()=>{const n=e.storageService;await(0,t.removeData)(n,r,"remoteFileMeta");for(const e of o.FileNamesList)await(0,t.removeData)(n,r,e)},cleanSingleFileStorage:async o=>{const n=e.storageService;await(0,t.removeData)(n,r,o);const i=await g(a(),e.storageService,r,"remoteFileMeta");return delete i?.files[o],A(a(),e.storageService,r,i,"remoteFileMeta")},isRemoteFileMetaDataExist:()=>(0,t.isDataStored)(e.storageService,r,"remoteFileMeta"),isRemoteFileContentExist:o=>(0,t.isDataStored)(e.storageService,r,o)}}},18539:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeStorageService=t.CarbonLocalStorage=void 0;const o=r(95623);t.CarbonLocalStorage=class{constructor(e){this._storage=e}itemExists(e){return this._storage.itemExists(e)}readItem(e){return this._storage.readItem(e)}async writeItem(e,t){const r=await this.backupItem(e);try{await this._storage.writeItem(e,t),r&&await r.clean()}catch(e){o.Debugger.error("CarbonLocalStorage:writeItem error:",e),r?(o.Debugger.error("CarbonLocalStorage couldn't save data, reverting to backup version"),await r.restoreAndClean()):o.Debugger.error("CarbonLocalStorage couldn't save data and no backup version to restore")}}removeItem(e){return this._storage.removeItem(e)}async getSuitableBackupKey(e){const t=t=>e+"."+t;let r=1;for(;await this._storage.itemExists(t(r));)r++;return t(r)}async backupItem(e){if(!await this._storage.itemExists(e))return null;const t=await this.getSuitableBackupKey(e),r=await this._storage.readItem(e);await this._storage.writeItem(t,r);const o=this._storage;async function n(){return await o.removeItem(t)}return{clean:n,restoreAndClean:async function(){const r=await o.readItem(t);return await o.writeItem(e,r),await n()}}}};t.makeStorageService=()=>{let e=null;return{setInstance:t=>{e=t},getLocalStorage:()=>{if(!e)throw new Error("makeStorageService: You must call setInstance(instance: AsyncStorage) before getting the instance");return e}}}},97601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeString=void 0;t.normalizeString=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()},45570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStyxApiCredentials=void 0;const o=r(45956),n=r(39261);t.getStyxApiCredentials=function(e,t){if(t.authenticationType!==o.ApiAuthType.App)return{type:o.ApiAuthType.None};const r={appKeys:(0,n.styxKeysSelector)(e)};return{type:o.ApiAuthType.App,...r}}},76330:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getApiClientAgentHeader=t.getMakeStyxApiRequest=t.getEventsPayload=void 0;const o=r(56915),n=r(55730),a=r(45956),i=r(53),s=r(48749),c=r(14656),d=r(17825),l=r(45570),u=r(41265),p=r(78577),S=r(45127);function m(e){return JSON.stringify({platform:e.platformName,version:e.appVersion})}t.getEventsPayload=function(e){return e.map((e=>JSON.stringify(e))).join("\n")},t.getMakeStyxApiRequest=function(e,t,r){return async(g,y)=>{const A={login:"",teamUuid:"",payload:"",...y||{}},f=(0,n.getMethodParams)(r,A.payload),E=(0,n.getAuthParams)(t,{login:A.login,teamUuid:A.teamUuid}),h="POST"===f.method?f.payload:"",v=(0,o.dashlaneServerDeltaTimestampSelector)(g.getState())||0,T=Math.round((0,i.getUnixTimestamp)()-v),_=(0,l.getStyxApiCredentials)(g.getState(),E),I=(0,o.platformInfoSelector)(g.getState()),C={"Content-Type":"application/x-jsonlines","X-TIMESTAMP":T.toString()},P={"dashlane-client-agent":m(I)},D=function(e){const t=e.getAccountInfo().login,r=t&&(0,u.isInternalTestUser)(t),o=e.getPlatformInfo(),{buildType:n}=o,a=n===S.ApplicationBuildType.DEV||n===S.ApplicationBuildType.QA;return r||a}(g);D&&(C["X-DL-TEST"]="true");const O=Object.keys(P),b=await async function(e,t,r,n,s,c){if(r.type===a.ApiAuthType.None)return{};const d=(0,o.dashlaneServerDeltaTimestampSelector)(e.getState())||0,l=Math.round((0,i.getUnixTimestamp)()-d),u={pathname:t,method:"POST",rawBody:c,headers:n};return{Authorization:await(0,p.signRequest)({request:u,timestamp:l,credentials:r,headersToSign:s})}}(g,e,_,{...P,...C},O,h),w={...P,...b,...C},N=`${s.config.DASHLANE_STYX_HOST_WITH_SCHEME}${e}`,{data:R}=await function(e,t,r){const o={headers:r,validateStatus:n.validateStatus};switch(e.method){case a.ApiRequestMethod.GET:return(0,c.get)(t,o);case a.ApiRequestMethod.POST:return(0,c.post)(t,e.payload,o);default:(0,d.assertUnreachable)(e)}}(f,N,w);return R}},t.getApiClientAgentHeader=m},72636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SendTokenStatus=t.makeWSAuthentication=void 0;const o=r(66646),n=7,a="authentication";t.makeWSAuthentication=()=>({registerUki:e=>function(e){return(0,o._makeRequest)(a,n,"registeruki",e,{responseType:"text"}).then((e=>{if(function(e){if("string"!=typeof e){const t=JSON.stringify(e);throw new Error(`unsupported_response - ${t}`)}}(e),"ERROR"===e)throw new Error("Error: Failed to register the UKI");return e}))}(e),validity:e=>function(e){return(0,o._makeRequest)(a,n,"validity",e,{responseType:"text"})}(e)}),function(e){e[e.ERROR=0]="ERROR",e[e.SUCCESS=1]="SUCCESS",e[e.OTP_NEEDED=2]="OTP_NEEDED",e[e.UNKNOWN_USER=3]="UNKNOWN_USER"}(t.SendTokenStatus||(t.SendTokenStatus={}))},32239:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSBackup=void 0;const o=r(66646),n="backup";t.makeWSBackup=()=>({latest:e=>a(e),upload:e=>i(e),unlock:e=>s(e),erase:e=>c(e)});const a=e=>(0,o._makeRequest)(n,12,"latest",Object.assign({},e,{sharingTimestamp:0})),i=e=>(0,o._makeRequest)(n,12,"upload",e),s=e=>(0,o._makeRequest)(n,12,"unlock",e),c=e=>(0,o._makeRequest)(n,12,"erase",e)},33633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSBreaches=void 0;const o=r(66646);t.makeWSBreaches=()=>({get:e=>(0,o._makeRequest)("breaches",1,"get",e)})},5692:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSContactInfo=void 0;const o=r(66646),n=1,a="contactinfos";t.makeWSContactInfo=()=>({getContactInfo:e=>function(e){return(0,o._makeRequest)(a,n,"get",{login:e.login,uki:e.uki})}(e)})},69376:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSCountry=void 0;const o=r(66646),n=1,a="country";t.makeWSCountry=()=>({getCurrentCountry:(e={})=>function(e){return(0,o._makeRequest)(a,n,"get",e).then((e=>e.content))}(e)})},32868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSDataLeaks=void 0;const o=r(28445),n=r(92263),a=r(20750),i=r(48749),s=r(45800),c="dataleak",d=1;function l(e){return p(c,d,"status",e)}function u(e){return p(c,d,"leaks",e)}async function p(e,t,r,c){const d=`${i.config.DASHLANE_WS_HOST_WITH_SCHEME}/${t}/${e}/${r}`,l={headers:{...(0,s.getCloudflareHeaders)()}},{data:u}=await(0,o.postDataToUrl)(d,c,l);return function(e,t){if(429===t.code||t.error&&-32600===t.error.code){throw new n.CarbonError(a.WSError,a.WSErrorCode.THROTTLED).addAdditionalInfo({webService:e})}return t}(d,u)}t.makeWSDataLeaks=()=>({status:l,leaks:u})},35595:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSDevices=void 0;const o=r(66646),n="devices";t.makeWSDevices=()=>({list:e=>a(e),deactivate:e=>i(e),changeName:e=>s(e)});const a=e=>(0,o._makeRequest)(n,1,"list",{login:e.login,uki:e.uki}).then((e=>e.content)),i=e=>(0,o._makeRequest)(n,1,"deactivate",{login:e.login,uki:e.uki,deviceId:e.deviceId}),s=e=>(0,o._makeRequest)(n,1,"changename",{login:e.login,uki:e.uki,deviceId:e.deviceId,updatedName:e.updatedDeviceName})},20750:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WSError=t.WSErrorMessages=t.WSErrorCode=void 0,function(e){e[e.THROTTLED=0]="THROTTLED",e[e.REQUEST_FAILED=1]="REQUEST_FAILED"}(r=t.WSErrorCode||(t.WSErrorCode={})),t.WSErrorMessages={[r.THROTTLED]:"THROTTLED",[r.REQUEST_FAILED]:"WebService responded with error code in payload"},t.WSError={codes:r,name:"WSError",messages:t.WSErrorMessages}},56776:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSIconCrawler=void 0;const o=r(66646);t.makeWSIconCrawler=()=>({getIcons:n});const n=async e=>(0,o._makeRequest)("iconcrawler",2,"getIcons",{domainsInfo:e})},1577:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NewCardToken=void 0;const o=r(66646);t.NewCardToken=function(e,t){return(0,o._makeRequest)(t.name,t.version,"getNewCardToken",{login:e.login,uki:e.uki,teamId:e.teamId??null})}},87327:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSPremium=void 0;const o=r(66646),n="premium",a=3;t.makeWSPremium=()=>({status:e=>function(e){return(0,o._makeRequest)(n,a,"status",{login:e.login,uki:e.uki,billingInformation:e.billingInformation,spaces:e.spaces,autoRenewal:e.autoRenewal,familyInformation:e.familyInformation,previousPlan:e.previousPlan,needsAutoRenewalFailed:e.needsAutoRenewalFailed,teamInformation:!1,capabilities:!0}).then((e=>{if(!e.success)throw new Error("failed fetching premium status");return e.hasOwnProperty("billingInformation")&&(e.billingInformation=function(e){if(!e)return;return{cardExpirationYear:Number(e.card_exp_year),cardExpirationMonth:Number(e.card_exp_month),cardLast4Digits:Number(e.card_last4),cardType:e.card_type}}(e.billingInformation)),e}))}(e),setAutoRenewal:e=>function(e){return(0,o._makeRequest)(n,a,"setAutoRenewal",{login:e.login,uki:e.uki,enabled:e.enabled})}(e),updateCardToken:e=>function(e){return(0,o._makeRequest)(n,a,"updateCardToken",{login:e.login,uki:e.uki,tokenId:e.tokenId,stripeAccount:e.stripeAccount})}(e),getABTestingVersionDetails:e=>function(e){return(0,o._makeRequest)(n,a,"getABTestingVersionDetails",e)}(e),getSubscriptionCode:e=>function({login:e,uki:t}){return(0,o._makeRequest)(n,a,"getSubscriptionCode",{login:e,uki:t})}(e)})},55898:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSQA=void 0;const o=r(66646),n=1,a="qa";t.makeWSQA=()=>({tokens:e=>function(e){return(0,o._makeRequest)(a,n,"tokens",e)}(e)})},56692:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSRecovery=void 0;const o=r(66646),n=1,a="recovery";t.makeWSRecovery=()=>({getSetupRequisites:e=>async function(e){return(0,o._makeRequest)(a,n,"getSetupRequisites",e)}(e),setRecoveryClientKeys:e=>async function(e){return(0,o._makeRequest)(a,n,"setRecoveryClientKeys",e)}(e),request:e=>async function(e){return(0,o._makeRequest)(a,n,"request",e)}(e),getPendingRequests:e=>async function(e){const{content:t}=await(0,o._makeRequest)(a,n,"getPendingRequests",e);return t}(e),acceptRequest:e=>async function(e){return(0,o._makeRequest)(a,n,"accept",e)}(e),refuseRequest:e=>async function(e){return(0,o._makeRequest)(a,n,"refuse",e)}(e),cancelRequest:e=>async function(e){return(0,o._makeRequest)(a,n,"cancel",e)}(e)})},90732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSSecureFile=void 0;const o=r(66646),n=1,a="securefile";function i(e){return(0,o._makeRequest)(a,n,"delete",e)}function s(e){return(0,o._makeRequest)(a,n,"getUploadLink",e)}function c(e){return(0,o._makeRequest)(a,n,"commit",e)}t.makeWSSecureFile=()=>({getUploadLink:s,commit:c,delete:i})},66696:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTeamSettings=t.getTeamSettings=t.makeWSSettings=void 0;const o=r(66646),n=1,a="teamPlans";function i(e){return(0,o._makeRequest)(a,n,"status",e)}function s(e){return(0,o._makeRequest)(a,n,"editSettings",e)}t.makeWSSettings=()=>({getTeamSettings:e=>i(e),setTeamSettings:e=>s(e)}),t.getTeamSettings=i,t.setTeamSettings=s},64528:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSharingWS=t.get=void 0;const o=r(66646),n=2,a="sharing";function i(e,t,r){const i={login:e,uki:t,action:JSON.stringify(r)};return(0,o._makeRequest)(a,n,"get",i).then((({content:e})=>e))}t.get=i;t.makeSharingWS=()=>({get:(e,t,r)=>i(e,t,r)})},98892:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemWS=void 0;const o=r(66646),n=2,a="sharing",i="performItemGroupAction";t.makeItemWS=()=>({updateItem:(e,t,r)=>function(e,t,r){const s={login:e,uki:t,action:JSON.stringify(r)};return(0,o._makeRequest)(a,n,i,s).then((e=>{const t=e.content,r=t.itemErrors;if(r&&r.length>0)throw new Error(r[0].message);return t}))}(e,t,r)})},63698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemGroupWS=void 0;const o=r(66646),n=2,a="sharing",i="performItemGroupAction";function s(e,t,r){const s={login:e,uki:t,action:JSON.stringify(r)};return(0,o._makeRequest)(a,n,i,s).then((e=>{const t=e.content,r=t.itemGroupErrors;if(r&&r.length>0)throw new Error(r[0].message);const{itemGroups:o,items:n}=t;return{itemGroups:o,items:n}}))}t.makeItemGroupWS=()=>({createSpecialItemGroup:(e,t,r)=>s(e,t,r).then((({itemGroups:e})=>e&&e[0])),createItemGroup:s,deleteGroup:(e,t,r)=>s(e,t,r),addItems:(e,t,r)=>s(e,t,r),updateItem:(e,t,r)=>s(e,t,r),removeItems:(e,t,r)=>s(e,t,r),acceptItemGroup:s,refuseItemGroup:s,inviteItemGroupMembers:s,revokeItemGroupMembers:s,updateItemGroupMembers:s})},52931:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserGroupWS=void 0;const o=r(66646),n=1,a="userGroup",i="performUserGroupAction";function s(e,t,r){const s={login:e,uki:t,action:JSON.stringify(r)};return(0,o._makeRequest)(a,n,i,s).then((e=>{const{itemGroups:t,items:r,userGroupErrors:o,userGroups:n}=e.content;if(o&&o.length>0)throw new Error(o[0].message);return{itemGroups:t,items:r,userGroups:n}}))}t.makeUserGroupWS=()=>({create:(e,t,r)=>s(e,t,r),delete:(e,t,r)=>s(e,t,r),rename:(e,t,r)=>s(e,t,r),invite:(e,t,r)=>s(e,t,r),revoke:(e,t,r)=>s(e,t,r),update:(e,t,r)=>s(e,t,r),accept:(e,t,r)=>s(e,t,r),refuse:(e,t,r)=>s(e,t,r)})},12832:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CheckChangePasswordStatus=t.makeWSStrongAuth=void 0;const o=r(66646),n=r(95623),a=3,i="strongauth";var s;t.makeWSStrongAuth=()=>({checkChangeMasterPassword:e=>function({login:e,otp:t,deviceId:r}){return(0,o._makeRequest)(i,a,"getServerKey",{login:e,otp:t,deviceID:r,isMxAware:!0}).then((e=>{if(n.default.log("checkChangeMasterPassword: "+(e?JSON.stringify(e):"response null")),!e||!e.message)throw new Error("Unknown response from server");if(void 0===s[e.message])throw new Error(`unknown_message - ${JSON.stringify(e)}`);return{status:s[e.message],content:e.content}}))}(e)}),function(e){e[e.Unauthorized=0]="Unauthorized",e[e.OK=1]="OK"}(s=t.CheckChangePasswordStatus||(t.CheckChangePasswordStatus={}))},42883:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSTeamPlans=void 0;const o=r(66646),n=1,a="teamPlans";t.makeWSTeamPlans=()=>({findUserGroups:e=>function(e){return(0,o._makeRequest)(a,n,"findUserGroups",e)}(e),proposeMembers:e=>function(e){return(0,o._makeRequest)(a,n,"proposeMembers",e)}(e),acceptTeam:e=>function(e){return(0,o._makeRequest)(a,n,"acceptTeam",e)}(e),addTeamAdmin:e=>function(e){return(0,o._makeRequest)(a,n,"addTeamCaptain",e)}(e),removeTeamAdmin:e=>function(e){return(0,o._makeRequest)(a,n,"removeTeamCaptain",e)}(e),registerFreeTrial:e=>function(e){return(0,o._makeRequest)(a,n,"registerFreeTrial",e)}(e),confirmFreeTrial:e=>function(e){return(0,o._makeRequest)(a,n,"confirmFreeTrial",e)}(e),getDirectorySyncRequest:e=>function(e){return(0,o._makeRequest)(a,n,"getDirectorySyncRequest",e)}(e),updateDirectorySyncRequestStatus:e=>function(e){return(0,o._makeRequest)(a,n,"updateDirectorySyncRequestStatus",e)}(e),spaceDeleted:e=>function(e){return(0,o._makeRequest)(a,n,"spaceDeleted",e)}(e)})},85870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.makeWSUserActivity=void 0;const o=r(66646),n="useractivity",a=2;async function i(e){return await(0,o._makeRequest)(n,a,"create",e)}t.makeWSUserActivity=()=>({create:i}),t.create=i},50141:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSUserAlias=void 0;const o=r(66646),n=1,a="userAlias";t.makeWSUserAlias=()=>({findUsersByAliases:e=>function(e){return(0,o._makeRequest)(a,n,"findUsers",{login:e.login,uki:e.uki,aliases:e.aliases}).then((e=>e.content))}(e)})},32607:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWSResponseSuccess=void 0,t.isWSResponseSuccess=function(e){return 200===e.code}},89016:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeWSService=void 0;const o=r(72636),n=r(5692),a=r(69376),i=r(32868),s=r(35595),c=r(87327),d=r(56692),l=r(12832),u=r(42883),p=r(50141),S=r(66696),m=r(63698),g=r(55898),y=r(64528),A=r(32239),f=r(33633),E=r(52931),h=r(85870),v=r(56776),T=r(90732);t.makeWSService=()=>({authentication:(0,o.makeWSAuthentication)(),backup:(0,A.makeWSBackup)(),breaches:(0,f.makeWSBreaches)(),contactInfo:(0,n.makeWSContactInfo)(),country:(0,a.makeWSCountry)(),dataleaks:(0,i.makeWSDataLeaks)(),devices:(0,s.makeWSDevices)(),iconCrawler:(0,v.makeWSIconCrawler)(),itemGroup:(0,m.makeItemGroupWS)(),premium:(0,c.makeWSPremium)(),recovery:(0,d.makeWSRecovery)(),settings:(0,S.makeWSSettings)(),strongAuth:(0,l.makeWSStrongAuth)(),teamPlans:(0,u.makeWSTeamPlans)(),userAlias:(0,p.makeWSUserAlias)(),sharing:(0,y.makeSharingWS)(),userGroup:(0,E.makeUserGroupWS)(),qa:(0,g.makeWSQA)(),userActivity:(0,h.makeWSUserActivity)(),secureFile:(0,T.makeWSSecureFile)()})},66646:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._makeRequest=t.WsError=void 0;const o=r(28445),n=r(92263),a=r(45800),i=r(20750),s=r(48749);!function(e){e[e.THROTTLED=-999]="THROTTLED"}(t.WsError||(t.WsError={})),t._makeRequest=function(e,t,r,c,d){const l=`${s.config.DASHLANE_WS_HOST_WITH_SCHEME}/${t}/${e}/${r}`,u={...d,headers:{...(0,a.getCloudflareHeaders)()}};return(0,o.postDataToUrl)(l,c,u).then((e=>{const t="string"==typeof e?e:e.data;return function(e,t){if("string"==typeof t)return t;if(429===t.code||t.error&&-32600===t.error.code){throw new n.CarbonError(i.WSError,i.WSErrorCode.THROTTLED).addAdditionalInfo({webService:e})}const r="code"in t&&200!==t.code||"success"in t&&!t.success||"error"in t&&t.error;if(r){throw new n.CarbonError(i.WSError,i.WSErrorCode.REQUEST_FAILED).addAdditionalInfo({webService:e,message:t.message,webServiceSubMessage:t.content?.message||t.content?.error||t.content,code:t.code})}return t}(l,t)}))}},81885:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.KWXMLError=t.KWXMLErrorMessages=t.KWXMLErrorCode=void 0,function(e){e[e.PARSING_FAILED=0]="PARSING_FAILED"}(r=t.KWXMLErrorCode||(t.KWXMLErrorCode={})),t.KWXMLErrorMessages={[r.PARSING_FAILED]:"Failed to parse Dashlane XML"},t.KWXMLError={codes:r,name:"KWXMLError",messages:t.KWXMLErrorMessages}},61797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findAllKWXMLElementsOfType=t.removeNamespace=t.getDashlaneXml=t.parseDashlaneXml=void 0;const o=r(62433),n=r(44015),a=r(92263),i=r(81885),s=r(54218),c=r(51104),d=r(63985);function l(e){const t={KWAuthentifiant:d.fixCredentialTypesFromStore,KWSecureNote:d.fixNoteTypesFromStore,KWSecurityBreach:d.fixBreachTypesFromStore,KWSettingsManagerApp:c.fixPersonalSettingTypes.fromStore};let r=(0,o.compose)((0,o.reject)(o.isNil),(0,o.omit)((0,o.defaultTo)([],{KWAuthentifiant:["domainIcon"],KWSettingsManagerApp:["kwType","LastBackupTime","Id"]}[e.kwType])))(function(e,t){function r(t){return(0,s.default)(t)?Object.keys(t).reduce(((n,a)=>{const i=e[a]||a,c=t[a];return Array.isArray(c)?n[i]=c.map((0,o.unary)(r)):(0,s.default)(c)?n[i]=r(c):n[i]=c,n}),{}):t}return r(t)}({kwType:"__type__"},e));return t[e.kwType]&&(r=t[e.kwType](r)),r}function u(e){if(e.includes(":")){const t=e.indexOf(":");return e.substring(t+1,e.length)}return e}t.parseDashlaneXml=async function(e){try{return await new Promise(((t,r)=>{(0,n.parseXml)(((e,o)=>e?r(e):t(o)),e,{fixType:!1})}))}catch(e){throw new a.CarbonError(i.KWXMLError,i.KWXMLErrorCode.PARSING_FAILED).addAdditionalInfo({libError:`${e}`})}},t.getDashlaneXml=function(e){const t=Array.isArray(e)?(0,o.map)(l,e):l(e);return(0,n.toXml)(t,{pretty:!1,allowEmpty:!0})},t.removeNamespace=u,t.findAllKWXMLElementsOfType=function e(t,r,o=[]){if(u(t.__type__)===r&&o.push(t),t.__children__&&t.__children__.length>0)for(let a=0;a<t.__children__.length;a++){const i=t.__children__[a];(0,n.isKWXMLElement)(i)&&e(i,r,o)}return o}},46430:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(73106),n=r(81080),a=r(30523),i=r(15876),s=r(63093),c=r(36172);t.config={commands:{abortDeviceLimitFlow:{handler:c.abortDeviceLimitFlow},loginViaSSO:{handler:o.loginViaSSO},unlinkPreviousDevice:{handler:a.unlinkPreviousDevice},unlinkMultipleDevices:{handler:i.unlinkMultipleDevices}},queries:{getLoginDeviceLimitFlow:{selector:n.viewedLoginDeviceLimitFlowSelector}},liveQueries:{liveLoginDeviceLimitFlow:{operator:s.loginDeviceLimitFlowView$}}}},20938:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkMultipleDevicesErrorReached=t.multipleDevicesLimitStillReached=t.oneDeviceLimitStillReached=t.sessionOpenedAfterDeviceLimitRemoval=t.refreshDeviceLimitStatusFailed=t.deviceLimitRemoved=t.deviceLimitStatusUpdated=t.unlinkingSucceeded=t.unlinkingFailed=t.unlinkingMultipleDevicesRequested=t.unlinkPreviousDeviceRequested=t.multipleDevicesLimitReached=t.oneDeviceLimitReached=t.UNLINK_MULTIPLE_DEVICES_ERROR=t.UNLINKING_SUCCEEDED=t.UNLINKING_FAILED=t.UNLINK_MULTIPLE_DEVICES_REQUESTED=t.UNLINK_PREVIOUS_DEVICE_REQUESTED=t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL=t.REFRESH_DEVICE_LIMIT_STATUS_FAILED=t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED=t.MULTIPLE_DEVICES_LIMIT_REACHED=t.ONE_DEVICE_LIMIT_STILL_REACHED=t.ONE_DEVICE_LIMIT_REACHED=t.DEVICE_LIMIT_STATUS_UPDATED=t.DEVICE_LIMIT_REMOVED=void 0,t.DEVICE_LIMIT_REMOVED="DEVICE_LIMIT_REMOVED",t.DEVICE_LIMIT_STATUS_UPDATED="DEVICE_LIMIT_STATUS_UPDATED",t.ONE_DEVICE_LIMIT_REACHED="ONE_DEVICE_LIMIT_REACHED",t.ONE_DEVICE_LIMIT_STILL_REACHED="ONE_DEVICE_LIMIT_STILL_REACHED",t.MULTIPLE_DEVICES_LIMIT_REACHED="MULTIPLE_DEVICES_LIMIT_REACHED",t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED="MULTIPLE_DEVICES_LIMIT_STILL_REACHED",t.REFRESH_DEVICE_LIMIT_STATUS_FAILED="REFRESH_DEVICE_LIMIT_STATUS_FAILED",t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL="SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL",t.UNLINK_PREVIOUS_DEVICE_REQUESTED="UNLINK_PREVIOUS_DEVICE_REQUESTED",t.UNLINK_MULTIPLE_DEVICES_REQUESTED="UNLINK_MULTIPLE_DEVICES_REQUESTED",t.UNLINKING_FAILED="UNLINKING_FAILED",t.UNLINKING_SUCCEEDED="UNLINKING_SUCCEEDED",t.UNLINK_MULTIPLE_DEVICES_ERROR="UNLINK_MULTIPLE_DEVICES_ERROR";t.oneDeviceLimitReached=e=>({type:t.ONE_DEVICE_LIMIT_REACHED,deviceLimitStatus:e.deviceLimitStatus,login:e.login,subscriptionCode:e.subscriptionCode});t.multipleDevicesLimitReached=e=>({type:t.MULTIPLE_DEVICES_LIMIT_REACHED,deviceLimitStatus:e.deviceLimitStatus,login:e.login,subscriptionCode:e.subscriptionCode});t.unlinkPreviousDeviceRequested=()=>({type:t.UNLINK_PREVIOUS_DEVICE_REQUESTED});t.unlinkingMultipleDevicesRequested=()=>({type:t.UNLINK_MULTIPLE_DEVICES_REQUESTED});t.unlinkingFailed=()=>({type:t.UNLINKING_FAILED});t.unlinkingSucceeded=()=>({type:t.UNLINKING_SUCCEEDED});t.deviceLimitStatusUpdated=()=>({type:t.DEVICE_LIMIT_STATUS_UPDATED});t.deviceLimitRemoved=()=>({type:t.DEVICE_LIMIT_REMOVED});t.refreshDeviceLimitStatusFailed=()=>({type:t.REFRESH_DEVICE_LIMIT_STATUS_FAILED});t.sessionOpenedAfterDeviceLimitRemoval=()=>({type:t.SESSION_OPENED_AFTER_DEVICE_LIMIT_REMOVAL});t.oneDeviceLimitStillReached=e=>({type:t.ONE_DEVICE_LIMIT_STILL_REACHED,updatedDeviceLimitStatus:e.updatedDeviceLimitStatus});t.multipleDevicesLimitStillReached=e=>({type:t.MULTIPLE_DEVICES_LIMIT_STILL_REACHED,updatedDeviceLimitStatus:e.updatedDeviceLimitStatus});t.unlinkMultipleDevicesErrorReached=e=>({type:t.UNLINK_MULTIPLE_DEVICES_ERROR,retryPayload:e.retryPayload})},15868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLoginDeviceLimitFlowState=void 0;const o=r(20938),n=r(10984),a=r(17825),i=r(45127),s=(e,t)=>t.type===o.ONE_DEVICE_LIMIT_REACHED?(0,n.atOneDeviceLimitReachedStage)({login:t.login,subscriptionCode:t.subscriptionCode,deviceLimitStatus:t.deviceLimitStatus}):t.type===o.MULTIPLE_DEVICES_LIMIT_REACHED?(0,n.atMultipleDevicesLimitReachedStage)({login:t.login,subscriptionCode:t.subscriptionCode,deviceLimitStatus:t.deviceLimitStatus}):e,c=(e,t)=>{switch(t.type){case o.UNLINK_PREVIOUS_DEVICE_REQUESTED:return(0,n.atUnlinkingAndOpeningSessionStage)(e);case o.DEVICE_LIMIT_STATUS_UPDATED:return(0,n.atRefreshingDeviceLimitStatusStage)(e)}return e},d=(e,t)=>{switch(t.type){case o.UNLINK_MULTIPLE_DEVICES_REQUESTED:return(0,n.atUnlinkingAndOpeningSessionStage)(e);case o.DEVICE_LIMIT_STATUS_UPDATED:return(0,n.atRefreshingDeviceLimitStatusStage)(e)}return e},l=(e,t)=>{switch(t.type){case o.UNLINK_MULTIPLE_DEVICES_ERROR:return(0,n.atUnlinkMultipleDevicesErrorStage)({...e,retryPayload:t.retryPayload});case o.UNLINK_MULTIPLE_DEVICES_REQUESTED:return(0,n.atUnlinkingAndOpeningSessionStage)(e);case o.UNLINKING_SUCCEEDED:return(0,n.atDeviceLimitDoneStage)(e)}return e},u=e=>{const{deviceLimitStatus:t}=e;switch(t._tag){case"limitedToOneDevice":return(0,n.atOneDeviceLimitReachedStage)({...e,deviceLimitStatus:t});case"limitedToMultipleDevices":return(0,n.atMultipleDevicesLimitReachedStage)({...e,deviceLimitStatus:t});default:(0,a.assertUnreachable)(t)}},p=(e,t)=>{switch(t.type){case o.ONE_DEVICE_LIMIT_STILL_REACHED:return(0,n.atOneDeviceLimitReachedStage)({...e,deviceLimitStatus:t.updatedDeviceLimitStatus});case o.MULTIPLE_DEVICES_LIMIT_STILL_REACHED:return(0,n.atMultipleDevicesLimitReachedStage)({...e,deviceLimitStatus:t.updatedDeviceLimitStatus});case o.REFRESH_DEVICE_LIMIT_STATUS_FAILED:return u(e);case o.DEVICE_LIMIT_REMOVED:return(0,n.atOpeningSessionAfterDeviceLimitRemovalStage)(e)}return e},S=(e,t)=>{switch(t.type){case o.UNLINKING_SUCCEEDED:return(0,n.atDeviceLimitDoneStage)(e);case o.UNLINKING_FAILED:return u(e);case o.UNLINK_MULTIPLE_DEVICES_ERROR:return(0,n.atUnlinkMultipleDevicesErrorStage)({...e,retryPayload:t.retryPayload})}return e};function m(){return{flow:null}}t.default=(e={flow:null},t)=>{if(null===e.flow)return{flow:s(null,t)};switch(e.flow.name){case i.LoginDeviceLimitFlowStage.OneDeviceLimitReached:return{flow:c(e.flow,t)};case i.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError:return{flow:l(e.flow,t)};case i.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached:return{flow:d(e.flow,t)};case i.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus:return{flow:p(e.flow,t)};case i.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession:return{flow:S(e.flow,t)};case i.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval:case i.LoginDeviceLimitFlowStage.DeviceLimitDone:return e;default:return(0,a.assertUnreachable)(e.flow)}},t.getEmptyLoginDeviceLimitFlowState=m},36172:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.abortDeviceLimitFlow=void 0;const o=r(45127),n=r(20698),a=r(70252);t.abortDeviceLimitFlow=async function(e){const{sessionService:t}=e;try{return await t.getInstance().user.closeSession(),{success:!0}}catch(e){const t=(0,n.augmentDeviceLimitError)(e,"abortDeviceLimitFlow");return(0,a.sendExceptionLog)({error:t}),{success:!1,error:{code:o.AbortDeviceLimitFlowError.UnexpectedError}}}}},31859:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPairingGroupDevices=t.findMyPairingGroup=t.isDevicePartOfPairingGroup=t.isDesktopPlatform=void 0;const o=r(45127);t.isDesktopPlatform=e=>e===o.Platform.DesktopLegacyWindows||e===o.Platform.DesktopLegacyMacOS||e===o.Platform.DesktopUWP;t.isDevicePartOfPairingGroup=(e,t)=>t.devices.includes(e.deviceId);t.findMyPairingGroup=(e,t)=>e.find((e=>e.pairingGroupUUID===t));t.getPairingGroupDevices=(e,t)=>t.filter((({deviceId:t})=>e.devices.includes(t)))},32573:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDeviceInfoService=void 0;const o=r(62433),n=r(46298),a=r(45127),i={[a.Platform.Android]:"server_android",[a.Platform.CarbonTests]:"server_carbon_tests",[a.Platform.CarbonUnknown]:"server_carbon_unknown",[a.Platform.DesktopLegacyMacOS]:"server_macosx",[a.Platform.DesktopLegacyWindows]:"server_win",[a.Platform.DesktopUWP]:"desktop_win",[a.Platform.IPad]:"server_ipad",[a.Platform.IPhone]:"server_iphone",[a.Platform.IPod]:"server_ipod",[a.Platform.StandaloneExtension]:"server_standalone",[a.Platform.TeamAdminConsole]:"server_tac",[a.Platform.WebApp]:"server_leeloo",[a.Platform.WebAppDev]:"server_leeloo_dev"},s=(0,o.invertObj)(i),c=e=>{return{deviceId:e.deviceId,deviceName:e.deviceName,devicePlatform:(t=e.devicePlatform,s[t]),lastActivityDate:e.lastActivityDateUnix,isBucketOwner:e.isBucketOwner,temporary:e.temporary};var t},d=e=>({pairingGroupUUID:e.pairingGroupUUID,devices:e.devices,isBucketOwner:e.isBucketOwner});t.makeDeviceInfoService=e=>({getDevicesInfo:t=>(async(e,t)=>{const r=await n.listDevices(e,t);if(n.isApiError(r))throw new Error(`Failed to get devices: ${r.message}`);return{devices:r.devices.map(c),pairingGroups:r.pairingGroups.map(d)}})(e,t)})},89961:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toPlatformView=void 0;const o=r(45127),n={[o.Platform.Android]:o.PlatformView.Android,[o.Platform.CarbonTests]:o.PlatformView.Other,[o.Platform.CarbonUnknown]:o.PlatformView.Other,[o.Platform.DesktopLegacyMacOS]:o.PlatformView.DesktopMacOS,[o.Platform.DesktopLegacyWindows]:o.PlatformView.DesktopWindows,[o.Platform.DesktopUWP]:o.PlatformView.DesktopWindows,[o.Platform.IPad]:o.PlatformView.IPad,[o.Platform.IPhone]:o.PlatformView.IPhone,[o.Platform.IPod]:o.PlatformView.IPod,[o.Platform.StandaloneExtension]:o.PlatformView.StandaloneExtension,[o.Platform.TeamAdminConsole]:o.PlatformView.TeamAdminConsole,[o.Platform.WebApp]:o.PlatformView.WebApp,[o.Platform.WebAppDev]:o.PlatformView.WebApp};t.toPlatformView=e=>n[e]},49154:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceLimitCapabilityEventBus=void 0;t.DeviceLimitCapabilityEventBus=class{constructor(e,t){this.services=e,this.connector=t}register(e){const t=[];return Object.keys(e).forEach((r=>{const{handler:o}=e[r],n=this.connector[r].on((()=>o(this.services)));t.push(n)})),()=>{t.forEach((e=>e()))}}}},27331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceLimitFlowEventsManager=t.DeviceLimitFlowEventsManager=void 0;const o=r(35088),n=r(63093),a=r(3343);class i{constructor(e){this.registrations=[];e.getState$().pipe((0,n.loginDeviceLimitFlow$)(),(0,a.pairwise)()).subscribe(this.onTransition.bind(this))}addEventListener(e,t){const r=(0,o.v4)();return this.registrations.push({id:r,event:e,listener:t}),r}removeTransitionEventListener(e){this.registrations=this.registrations.filter((t=>t.id!==e))}onTransition([e,t]){this.registrations.forEach((({event:r,listener:o})=>{("exit"===r.type&&r.from===e?.name||"entry"===r.type&&r.to===t?.name)&&o(r)}))}}let s;t.DeviceLimitFlowEventsManager=i;t.getDeviceLimitFlowEventsManager=e=>(s||(s=new i(e)),s)},10984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.atUnlinkMultipleDevicesErrorStage=t.atDeviceLimitDoneStage=t.atRefreshingDeviceLimitStatusStage=t.atOpeningSessionAfterDeviceLimitRemovalStage=t.atUnlinkingAndOpeningSessionStage=t.atMultipleDevicesLimitReachedStage=t.atOneDeviceLimitReachedStage=void 0;const o=r(45127);t.atOneDeviceLimitReachedStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.OneDeviceLimitReached});t.atMultipleDevicesLimitReachedStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached});t.atUnlinkingAndOpeningSessionStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession});t.atOpeningSessionAfterDeviceLimitRemovalStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval});t.atRefreshingDeviceLimitStatusStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus});t.atDeviceLimitDoneStage=e=>({...e,name:o.LoginDeviceLimitFlowStage.DeviceLimitDone});t.atUnlinkMultipleDevicesErrorStage=e=>({...e,deviceLimitStatus:e.deviceLimitStatus,name:o.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError})},63093:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginDeviceLimitFlowView$=t.loginDeviceLimitFlow$=void 0;const o=r(18948),n=r(3343),a=r(81080);t.loginDeviceLimitFlow$=()=>(0,o.pipe)((0,n.map)(a.loginDeviceLimitFlowSelector),(0,n.distinctUntilChanged)(((e,t)=>e?.name===t?.name)));t.loginDeviceLimitFlowView$=()=>(0,o.pipe)((0,n.map)(a.viewedLoginDeviceLimitFlowSelector),(0,n.distinctUntilChanged)(((e,t)=>e?.name===t?.name)))},81080:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedLoginDeviceLimitFlowSelector=t.loginDeviceLimitFlowSelector=void 0;const o=r(46802);t.loginDeviceLimitFlowSelector=e=>e.userSession.loginDeviceLimitFlow.flow;t.viewedLoginDeviceLimitFlowSelector=e=>{const r=(0,t.loginDeviceLimitFlowSelector)(e);return r?(0,o.toLoginDeviceLimitFlowView)(r):null}},46802:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toLoginDeviceLimitFlowView=t.toMultipleDevicesLimitErrorStageView=t.toMultipleDevicesLimitReachedStageView=void 0;const o=r(45127),n=r(35520),a=r(88068),i=r(17825);t.toMultipleDevicesLimitReachedStageView=e=>({name:o.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached,login:e.login,devicesToDeactivate:e.deviceLimitStatus.devices.map(a.toDeviceToDeactivateInfoView),subscriptionCode:e.subscriptionCode});t.toMultipleDevicesLimitErrorStageView=e=>({name:o.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError,login:e.login,retryPayload:e.retryPayload,subscriptionCode:e.subscriptionCode});t.toLoginDeviceLimitFlowView=e=>{switch(e.name){case o.LoginDeviceLimitFlowStage.OneDeviceLimitReached:return s=e,{name:o.LoginDeviceLimitFlowStage.OneDeviceLimitReached,login:s.login,previousDevice:(0,n.toPreviousDeviceInfo)(s.deviceLimitStatus.bucketOwner),subscriptionCode:s.subscriptionCode};case o.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached:return(0,t.toMultipleDevicesLimitReachedStageView)(e);case o.LoginDeviceLimitFlowStage.UnlinkingAndOpeningSession:case o.LoginDeviceLimitFlowStage.DeviceLimitDone:case o.LoginDeviceLimitFlowStage.RefreshingDeviceLimitStatus:case o.LoginDeviceLimitFlowStage.OpeningSessionAfterDeviceLimitRemoval:return r=e.name,a=e.login,{name:r,login:a};case o.LoginDeviceLimitFlowStage.UnlinkingMultipleDevicesError:return(0,t.toMultipleDevicesLimitErrorStageView)(e);default:return(0,i.assertUnreachable)(e)}var r,a,s}},85822:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.startDeviceLimitFlow=t.getDeviceLimitStatus=t.attemptGetDeviceLimitStatus=void 0;const o=r(16593),n=r(15718),a=r(82652),i=r(22589),s=r(32573),c=r(36077),d=r(20938),l=r(90622),u=r(38981),p=r(92263),S=r(14656),m=r(56915);t.attemptGetDeviceLimitStatus=async e=>{try{return await Promise.race([(0,t.getDeviceLimitStatus)(e),new Promise((e=>setTimeout((()=>e((0,c.noDeviceLimit)())),3e3)))])}catch(e){return(e=>{if(!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.NETWORK_ERROR)&&!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.CONNECTION_ABORTED)&&!(0,p.isCarbonError)(e,S.HttpError,S.HttpErrorCode.CONNECTION_TIMED_OUT))throw e;return(0,c.noDeviceLimit)()})(e)}};t.getDeviceLimitStatus=async e=>{const{storeService:t,moduleClients:r}=e,d=t.getState();if((0,u.isSSOUserSelector)(d))return(0,c.noDeviceLimit)();const p=(0,n.pairingIdSelector)(d),S=(0,o.premiumStatusSelector)(d),g=(0,o.userLoginSelector)(d),y=(0,s.makeDeviceInfoService)(t),A=await y.getDevicesInfo(g),f=await(0,m.getDeviceAccessKeysFromSession)(r.session,g),E=(0,l.deviceKeysSelector)(t.getState()),h=(0,a.isOneDeviceLimitApplicable)(p,A,f,S);if("limitedToOneDevice"===h._tag)return(0,c.limitedToOneDevice)(h.bucketOwner);const v=(0,i.isMultipleDevicesLimitApplicable)(A,S,E);return"limitedToMultipleDevices"===v._tag?(0,c.limitedToMultipleDevices)(v.devices):(0,c.noDeviceLimit)()};t.startDeviceLimitFlow=async(e,t)=>{const{sessionService:r,storeService:n}=e,a=n.getState(),i=(0,o.userLoginSelector)(a),s=r.getInstance().user,c=await s.fetchSubscriptionCode();if("limitedToOneDevice"===t._tag){const e=(0,d.oneDeviceLimitReached)({deviceLimitStatus:t,subscriptionCode:c,login:i});n.dispatch(e)}else if("limitedToMultipleDevices"===t._tag){const e=(0,d.multipleDevicesLimitReached)({deviceLimitStatus:t,subscriptionCode:c,login:i});n.dispatch(e)}}},36077:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noDeviceLimit=t.limitedToMultipleDevices=t.limitedToOneDevice=void 0;t.limitedToOneDevice=e=>({_tag:"limitedToOneDevice",bucketOwner:e});t.limitedToMultipleDevices=e=>({_tag:"limitedToMultipleDevices",devices:e});t.noDeviceLimit=()=>({_tag:"noDeviceLimit"})},75903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshDeviceLimitStatus=void 0;const o=r(70252),n=r(88610),a=r(20698),i=r(20938),s=r(85822);t.refreshDeviceLimitStatus=async e=>{const{sessionService:t,storeService:r}=e;try{const c=t.getInstance().user;await c.refreshSessionData();const d=await(0,s.getDeviceLimitStatus)(e);if("noDeviceLimit"===d._tag)r.dispatch((0,i.deviceLimitRemoved)()),await(async e=>{const{sessionService:t,storeService:r}=e;try{await(0,n.sessionDidOpen)(e),r.dispatch((0,i.sessionOpenedAfterDeviceLimitRemoval)())}catch(r){(0,a.notifyDeviceLimitError)(e,r);const n=(0,a.augmentDeviceLimitError)(r,"openSessionAfterDeviceLimitRemoval");(0,o.sendExceptionLog)({error:n}),t.close()}})(e);else if("limitedToOneDevice"===d._tag){const e=(0,i.oneDeviceLimitStillReached)({updatedDeviceLimitStatus:d});r.dispatch(e)}else if("limitedToMultipleDevices"===d._tag){const e=(0,i.multipleDevicesLimitStillReached)({updatedDeviceLimitStatus:d});r.dispatch(e)}}catch(e){r.dispatch((0,i.refreshDeviceLimitStatusFailed)());const t=(0,a.augmentDeviceLimitError)(e,"refreshDeviceLimitStatus");(0,o.sendExceptionLog)({error:t})}}},20698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.augmentDeviceLimitError=t.notifyDeviceLimitError=void 0;const o=r(45127),n=r(16373),a=e=>"object"==typeof e&&e instanceof Error,i=e=>a(e)?e.message:"No valid error reported";t.notifyDeviceLimitError=async function(e,t){const{storeService:r}=e,a=(0,n.addNewLoginNotification)({type:o.LoginNotificationType.UNKNOWN_ERROR,message:i(t)});r.dispatch(a)},t.augmentDeviceLimitError=function(e,t){const r=`[DeviceLimit] - ${t}: ${i(e)}`,o=new Error(r);return a(e)&&(o.stack=e.stack),o}},22589:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMultipleDevicesLimitApplicable=void 0;const o=r(87314),n=(e,t)=>t.lastActivityDate-e.lastActivityDate;t.isMultipleDevicesLimitApplicable=(e,t,r)=>{if((t?.capabilities?.devicesLimit?.info?.limit||0)<=1)return(0,o.notLimitedToMultipleDevices)();const{nonPairedDevices:a,pairingGroups:i}=(({pairingGroups:e,devices:t})=>{const r=t.filter((t=>!e.find((e=>e.devices.includes(t.deviceId)))&&t),[]);return{pairingGroups:e,nonPairedDevices:r}})(e);if(t.capabilities.devicesLimit.info.limit<a.length+i.length){const t=(({pairingGroups:e,devices:t,nonPairedDevices:r,deviceKeys:o})=>{const a=[...t].sort(n),i=[];for(const r of e){let e;e=r.devices.includes(o?.accessKey)?{...t.find((e=>e.deviceId===o?.accessKey)),isCurrentDevice:!0}:a.find((e=>r.devices.includes(e.deviceId))),i.push({...e,deviceId:r.pairingGroupUUID,isPairingGroup:!0})}const s=r.map((e=>e.deviceId===o?.accessKey?{...e,isCurrentDevice:!0}:e));return[...i,...s].sort(n)})({devices:e.devices,nonPairedDevices:a,pairingGroups:i,deviceKeys:r});return(0,o.limitedToMultipleDevices)(t)}return(0,o.notLimitedToMultipleDevices)()}},87314:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.limitedToMultipleDevices=t.notLimitedToMultipleDevices=void 0;t.notLimitedToMultipleDevices=()=>({_tag:"notLimitedToMultipleDevices"});t.limitedToMultipleDevices=e=>({_tag:"limitedToMultipleDevices",devices:e})},88068:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toDeviceToDeactivateInfoView=void 0;const o=r(45127),n=r(89961);t.toDeviceToDeactivateInfoView=e=>({...e,platform:e.devicePlatform?(0,n.toPlatformView)(e.devicePlatform):o.PlatformView.Other})},82652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMonoBucketOwner=t.isOneDeviceLimitApplicable=void 0;const o=r(62433),n=r(31859),a=r(44179);function i(e){const{devices:t,pairingGroups:r}=e;let a=null,i=t.find((e=>e.isBucketOwner))??null;if(!i&&(a=r.find((e=>e.isBucketOwner))??null,a)){const e=(0,n.getPairingGroupDevices)(a,t),r=(e,t)=>e.lastActivityDate-t.lastActivityDate;e.sort(r);const s=e=>Boolean(e.devicePlatform&&(0,n.isDesktopPlatform)(e.devicePlatform)),c=(0,o.partition)(s,e);i=(0,o.unnest)(c)[0]||null}return{bucketOwner:i,bucketOwnerPairingGroup:a}}t.isOneDeviceLimitApplicable=function(e,t,r,o){const{bucketOwner:s,bucketOwnerPairingGroup:c}=i(t),{pairingGroups:d}=t;if(!Boolean(1===o?.capabilities?.devicesLimit?.info?.limit))return(0,a.notLimitedToOneDevice)();const l=!(!c||!e)&&c.pairingGroupUUID===e,u=(0,n.findMyPairingGroup)(d,e??""),p=!(!s||!u)&&(0,n.isDevicePartOfPairingGroup)(s,u);return!s||s.deviceId===r||l||p?(0,a.notLimitedToOneDevice)():(0,a.limitedToOneDevice)(s)},t.getMonoBucketOwner=i},44179:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notLimitedToOneDevice=t.limitedToOneDevice=void 0;t.limitedToOneDevice=e=>({_tag:"limitedToOneDevice",bucketOwner:e});t.notLimitedToOneDevice=()=>({_tag:"notLimitedToOneDevice"})},35520:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toPreviousDeviceInfo=void 0;const o=r(45127),n=r(89961);t.toPreviousDeviceInfo=({deviceName:e,devicePlatform:t,lastActivityDate:r})=>({name:e??"",platform:t?(0,n.toPlatformView)(t):o.PlatformView.Other,lastActive:r})},57634:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupDeviceLimitEventBus=void 0;const o=r(75903),n=r(20938),a=r(45127),i={deviceLimitCapabilityUpdated:{handler:e=>{const t=(0,n.deviceLimitStatusUpdated)();e.storeService.dispatch(t),(0,o.refreshDeviceLimitStatus)(e)}}},s={type:"entry",to:a.LoginDeviceLimitFlowStage.OneDeviceLimitReached},c={type:"exit",from:a.LoginDeviceLimitFlowStage.OneDeviceLimitReached},d={type:"entry",to:a.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached},l={type:"exit",from:a.LoginDeviceLimitFlowStage.MultipleDevicesLimitReached};t.setupDeviceLimitEventBus=(e,t)=>{let r;const o=()=>r=e.register(i),n=()=>r();t.addEventListener(s,o),t.addEventListener(c,n),t.addEventListener(d,o),t.addEventListener(l,n)}},15876:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkMultipleDevices=void 0;const o=r(45127),n=r(16593),a=r(46298),i=r(22589),s=r(88610),c=r(16373),d=r(32573),l=r(20938),u=r(20698),p=r(70252),S=r(90622);t.unlinkMultipleDevices=async(e,t)=>{const{storeService:r,sessionService:m}=e,g=r.getState(),y=(0,n.userLoginSelector)(g);r.dispatch((0,l.unlinkingMultipleDevicesRequested)());const A=await(async(e,t,r)=>{const{storeService:o}=e,n=e=>{const t=(0,l.unlinkMultipleDevicesErrorReached)({retryPayload:r});return o.dispatch(t),{success:!1,error:{code:e.code}}};try{const e=await(0,a.deactivateDevices)(o,t,r);if((0,a.isApiError)(e)&&e.code!==a.CLIENT_DEVICES_NOT_FOUND&&e.code!==a.PAIRING_GROUPS_NOT_FOUND)return n(e)}catch(e){return n(e)}})(e,y,t);if(A)return A;const f=await(async(e,t)=>{const{storeService:r}=e,a=r.getState(),s=(0,n.premiumStatusSelector)(a),u=(0,d.makeDeviceInfoService)(r),p=await u.getDevicesInfo(t),m=(0,S.deviceKeysSelector)(r.getState()),g=(0,i.isMultipleDevicesLimitApplicable)(p,s,m);if("limitedToMultipleDevices"===g._tag){r.dispatch((0,l.deviceLimitStatusUpdated)());const e=(0,c.addNewLoginNotification)({type:o.LoginNotificationType.UNKNOWN_ERROR,message:`${o.USER_STILL_OVERFLOWING}`});r.dispatch(e);const t=(0,l.multipleDevicesLimitStillReached)({updatedDeviceLimitStatus:{_tag:"limitedToMultipleDevices",devices:g.devices}});return r.dispatch(t),{success:!1,error:{code:o.USER_STILL_OVERFLOWING}}}return!1})(e,y);if(f)return f;try{return await(0,s.sessionDidOpen)(e),r.dispatch((0,l.unlinkingSucceeded)()),{success:!0}}catch(t){return m.close(!1),(0,u.notifyDeviceLimitError)(e,t),r.dispatch((0,l.unlinkingFailed)()),(0,p.sendExceptionLog)({error:(0,u.augmentDeviceLimitError)(t,"unlinkMultipleDevices")}),{success:!1,error:{code:o.UNEXPECTED_ERROR}}}}},30523:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlinkPreviousDevice=void 0;const o=r(88610),n=r(20938),a=r(20698),i=r(70252),s=r(45127);t.unlinkPreviousDevice=async function(e){const{storeService:t}=e;try{return t.dispatch((0,n.unlinkPreviousDeviceRequested)()),await(0,o.sessionDidOpen)(e),t.dispatch((0,n.unlinkingSucceeded)()),{success:!0}}catch(r){t.dispatch((0,n.unlinkingFailed)()),(0,a.notifyDeviceLimitError)(e,r);const o=(0,a.augmentDeviceLimitError)(r,"unlinkPreviousDevice");return(0,i.sendExceptionLog)({error:o}),{success:!1,error:{code:s.UnlinkPreviousDeviceError.UnexpectedError}}}}},88610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DifferentLoginAuthorized=t.sessionDidOpen=t.openSessionWithMasterPassword=t.updateSessionUponLoginAction=t.makeLoginController=void 0;const o=r(48062),n=r(45127),a=r(28096),i=r(70414),s=r(28287),c=r(89160),d=r(28096),l=r(16356),u=r(86797),p=r(59489),S=r(2246),m=r(25576),g=r(5464),y=r(76089),A=r(28445),f=r(64910),E=r(33769),h=r(19399),v=r(56915),T=r(62844),_=r(52653),I=r(75226),C=r(71938),P=r(63739),D=r(658),O=r(15606),b=r(16593),w=r(38981),N=r(29303),R=r(27885),M=r(61740),L=r(7624),U=r(69763),k=r(15718),F=r(85822),B=r(61259),G=r(35924),K=r(46298),V=r(98226),j=r(25421),H=r(18948),W=r(66638),x=r(63229),z=r(71703);async function q(e,t,r,o){const{storeService:a,sessionService:i,moduleClients:{session:s}}=e,c=await(0,H.firstValueFrom)(s.queries.selectedOpenedSession());if(!(0,W.isSuccess)(c))throw new Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_ERROR]);if(c.data)throw new Error(n.AuthenticationCode[n.AuthenticationCode.SESSION_ALREADY_OPENED]);if(""===t)throw new Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_LOGIN]);if(!(0,A.isValidLogin)(t))throw new Error(n.AuthenticationCode[n.AuthenticationCode.INVALID_LOGIN]);if(a.dispatch((0,G.updateLoginStepInfoLogin)(t)),""===r)throw new Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_MASTER_PASSWORD]);let d=de.FORBIDDEN;if(o&&void 0!==o.authorizeDifferentLogin&&(d=o.authorizeDifferentLogin),a.getUserLogin()&&a.getUserLogin()!==t&&(a.isAuthenticated()&&await i.close(),d===de.FORBIDDEN))throw new Error(n.AuthenticationCode[n.AuthenticationCode.DIFFERENT_LOGIN_PROVIDED_WITH_TOKEN_OR_OTP]);a.hasSessionId()&&a.getUserLogin()===t&&r&&a.dispatch((0,l.updateMasterPassword)(r));const u=o&&o.serverKey;if(u&&a.dispatch((0,l.updateServerKey)(u)),a.getUserLogin()!==t||void 0===r){const e=(0,w.ssoSettingsSelector)(a.getState());await i.close(!1),i.setInstance(t,r),e.ssoToken&&a.dispatch((0,L.storeSSOSettings)(e))}}async function Y(e,t,r,o,a,s,c){try{const{storeService:l,sessionService:u}=e,p=(0,A.normalizeEmail)(t);await q(e,p,r),await se(o);if(await u.getInstance().user.accountExistsLocally())throw new Error("Unexpected local account presence during OTP1 step");if(await i.registerDeviceWithToken(l,a,(0,m.makeOTP)(o),c??!1,t,s)!==n.AuthenticationCode.ASK_MASTER_PASSWORD)throw new Error("unexpected status from device registration");return r?$(e,p,r,{isDataPersisted:a}):(d.triggerAskMasterPassword(p),n.LoginResultEnum.MasterPasswordMissing)}catch(t){throw ne(t)&&(0,D.sendOTPForNewDeviceErrorLog)(e,c),d.triggerOpenSessionFailed(t),t}}async function $(e,t,r,o,a){const s=o?.loginType??"MasterPassword";try{const{storeService:d,sessionService:u,masterPasswordEncryptorService:S,localDataEncryptorService:g,remoteDataEncryptorService:y,localStorageService:h,storageService:T,moduleClients:{"carbon-legacy":_}}=e;if(["PasswordlessAccountCreation","PasswordlessARK","DeviceToDevice"].includes(s))d.dispatch((0,p.storeAccountAuthenticationType)("invisibleMasterPassword"));else{const e=d.getState(),r=(0,v.getDeviceAccessKeySelector)(e,t);let o;try{const e=await(0,K.getAuthenticationMethodsForLogin)(d,{login:t,deviceAccessKey:r,methods:m.localSupportedAuthenticationMethod});if((0,K.isApiError)(e))return await c.handleGetAuthenticationMethodsForLoginError(T,_,e,t);o=e.accountType}catch(e){o="masterPassword"}d.dispatch((0,p.storeAccountAuthenticationType)(o))}let I=o&&o.isDataPersisted;a?.(`isDataPersisted? ${I}`),void 0===I&&(I=d.getAccountInfo().persistData);const C=o&&o.serverKey;a?.(`serverKey null, undefined, or empty? ${!C}`);const P=Boolean(o&&o.rememberMasterPassword);a?.(`rememberMasterPassword? ${P}`);const O=Boolean(o?.shouldRememberMeForSSO);t=(0,A.normalizeEmail)(t),a?.("updateSessionUponLoginAction START"),await q(e,t,r,{authorizeDifferentLogin:de.AUTHORIZED,serverKey:C}),a?.("updateSessionUponLoginAction SUCCESS");const w=await u.getInstance().user.accountExistsLocally();if(a?.(`accountExistLocally? ${w}`),w){const t=h.getInstance(),r=await t.doesLocalKeyExist();if(a?.(`doesLocalKeyExist? ${r}`),r)try{const e=await t.getLocalKey();e.length<64&&(a?.("localKeyMigrationRequired? true"),d.dispatch((0,l.updateIsLocalKeyMigrationRequired)(!0)));const r="";a?.("set localDataEncryptorService START");const o=(0,f.getNoDerivationCryptoConfig)();g.setInstance({raw:e},r,o),a?.("set localDataEncryptorService SUCCESS"),a?.("updateLocalKey START"),d.dispatch((0,l.updateLocalKey)(e)),a?.("updateLocalKey SUCCESS")}catch(t){throw(0,D.sendMasterPasswordLoginErrorLog)(e,!1),new Error(n.AuthenticationCode[n.AuthenticationCode.WRONG_PASSWORD])}a?.("loadLocalData START"),await c.loadLocalData(u,d,S),a?.("loadLocalData SUCCESS")}else{const e=d.getState(),t=(0,b.isRemoteKeyActivatedSelector)(e)&&y?y:S;a?.("validateMasterPassword START"),await i.validateMasterPassword(d,t),a?.("validateMasterPassword SUCCESS")}if(a?.("rememberMasterPasswordUpdated START"),o?.rememberMasterPassword&&d.dispatch((0,l.rememberMasterPasswordUpdated)(P)),a?.("rememberMasterPasswordUpdated SUCCESS"),O)d.dispatch((0,l.shouldRememberMeForSSOUpdated)(O));else{const t=await(0,H.firstValueFrom)(e.moduleClients.authenticationFlow.queries.getSsoUserSettings());(0,W.isSuccess)(t)&&(t.data.rememberMeForSSOPreference||await(0,x.disableAutologin)(e))}return c.cacheIsSso(d.getAccountInfo().login,"SSO"===s),d.dispatch((0,L.storeSSOSettings)({ssoUser:"SSO"===s})),w?(a?.("initLocalSession START"),(0,D.sendLoginSuccessEventLog)({services:e,isInitial:!1,loginType:s}),await async function(e,t){const{sessionService:r,storeService:o,localDataEncryptorService:a}=e,i=r.getInstance().user,s=o.getState();(0,b.isLocalKeyMigrationRequiredSelector)(s)&&(await(0,E.generateLocalkeyAndSetupEncryptorService)(a,o,r,m.PersistData.PERSIST_DATA_YES),await i.persistAllData());await i.refreshSessionData(),t?.requiredPermissions&&await Q(o,r,t.requiredPermissions);const c=await(0,F.attemptGetDeviceLimitStatus)(e);if("noDeviceLimit"!==c._tag)return await(0,F.startDeviceLimitFlow)(e,c),n.LoginResultEnum.DeviceLimitFlow;return re(e,t)}(e,o)):(a?.("initInitialSession START"),"SSO"===s&&(0,D.sendLoginSuccessEventLog)({services:e,isInitial:!0,loginType:o?.loginType}),await te(e,I,o))}catch(t){throw t.message&&t.message===n.AuthenticationCode[n.AuthenticationCode.WRONG_PASSWORD]&&(0,D.sendMasterPasswordLoginErrorLog)(e,!0),d.triggerOpenSessionFailed(t),t}}t.makeLoginController=e=>({openSession:(t,r)=>async function(e,t,r){const{storeService:a,sessionService:i,wsService:s,storageService:c,moduleClients:l}=e;t=(0,A.normalizeEmail)(t);try{const p=r&&r.password;await q(e,t,p,{authorizeDifferentLogin:de.AUTHORIZED});let S=await i.getInstance().user.accountExistsLocally();const g=await ie(a,c,l["carbon-legacy"],s,S);if("invisibleMasterPassword"===(0,j.accountAuthenticationTypeSelector)(a.getState()))return d.triggerOpenSessionMasterPasswordLess(),n.LoginResultEnum.MasterPasswordLess;switch(g){case n.AuthenticationCode.SSO_LOGIN_BYPASS:return(0,D.sendAskSSOAuthenticationEventLog)(e,o.VerificationMode.None),d.triggerOpenSessionSsoRedirectionToIdpRequired((0,B.triggerServiceProviderUrlRedirect)(a.getState(),t),(0,w.ssoProviderInfoSelector)(a.getState()).isNitroProvider),n.LoginResultEnum.SSOLogin;case n.AuthenticationCode.ASK_MASTER_PASSWORD:if(!S)throw new Error("checkLogin should never return ASK_MASTER_PASSWORD for remote accounts");return p?$(e,t,p):((0,D.sendAskAuthenticationEventLog)(e,o.VerificationMode.None),a.dispatch((0,G.updateLoginStepInfoStep)(n.LoginStep.Password)),d.triggerAskMasterPassword(t),n.LoginResultEnum.MasterPasswordMissing);case n.AuthenticationCode.ASK_OTP:return(0,D.sendAskAuthenticationEventLog)(e,o.VerificationMode.Otp2),a.dispatch((0,G.updateLoginStepInfoStep)(n.LoginStep.OTP2)),d.triggerOpenSessionOTPSent({hasU2F:!1}),n.LoginResultEnum.OTPMissing;case n.AuthenticationCode.ASK_OTP_FOR_NEW_DEVICE:const{otpType:r}=a.getAccountInfo();return(0,D.sendAskAuthenticationEventLog)(e,r===u.OtpType.OTP_NEW_DEVICE?o.VerificationMode.Otp1:o.VerificationMode.Otp2),a.dispatch((0,G.updateLoginStepInfoStep)(n.LoginStep.OTP1)),d.triggerOpenSessionOTPForNewDeviceRequired(),n.LoginResultEnum.OTPMissing;case n.AuthenticationCode.ASK_TOKEN:if(S=await i.getInstance().user.accountExistsLocally(),S)throw new Error("Unexpected local account presence during email token step");return await(0,K.requestEmailTokenVerification)(a,{login:t}),(0,D.sendAskAuthenticationEventLog)(e,o.VerificationMode.EmailToken),a.dispatch((0,G.updateLoginStepInfoStep)(n.LoginStep.OTPToken)),d.triggerOpenSessionTokenSent({isResendAction:!1,login:t}),n.LoginResultEnum.TokenMissing;case n.AuthenticationCode.USE_LOCAL_UKI:if((0,v.ukiSelector)(a.getState()))return te(e,m.PersistData.PERSIST_DATA_YES);throw new Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_UKI]);case n.AuthenticationCode.ASK_DASHLANE_AUTHENTICATOR:if(S=await i.getInstance().user.accountExistsLocally(),S)throw new Error("Unexpected local account presence during dashlane authenticator step");return(0,D.sendAskAuthenticationEventLog)(e,o.VerificationMode.AuthenticatorApp),a.dispatch((0,G.updateLoginStepInfoStep)(n.LoginStep.DashlaneAuthenticator)),d.triggerOpenSessionDashlaneAuthenticator(),n.LoginResultEnum.DashlaneAuthenticatorApprovalMissing;default:throw new Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_ERROR])}}catch(e){if(d.getAuthenticationCodeFromError(e)===n.AuthenticationCode.USER_DOESNT_EXIST&&(0,z.validateLoginForAccountCreation)(t)){let e;try{e=await(0,K.requestAccountCreation)(a,{login:t})}catch{}if(void 0!==e&&!(0,K.isApiError)(e)&&e.ssoServiceProviderUrl){const e=new Error(n.AuthenticationCode[n.AuthenticationCode.USER_DOESNT_EXIST_SSO]);return void d.triggerOpenSessionFailed(e)}}throw d.triggerOpenSessionFailed(e),e}}(e,t,r),openSessionWithToken:(t,r,o,a,s)=>async function(e,t,r,o,a,s){try{const{storeService:c,sessionService:l}=e;t=(0,A.normalizeEmail)(t),await q(e,t,r),await function(e){if(!e)throw new Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_TOKEN]);if(!ce.test(e))throw new Error(n.AuthenticationCode[n.AuthenticationCode.TOKEN_NOT_VALID])}(o);if(await l.getInstance().user.accountExistsLocally())throw new Error(n.AuthenticationCode[n.AuthenticationCode.TOKEN_PROVIDED_FOR_LOCAL_SESSION]);if(await i.registerDeviceWithToken(c,a,(0,m.makeEmailToken)(o),!1,t,s)!==n.AuthenticationCode.ASK_MASTER_PASSWORD)throw new Error("unexpected status from verifyOtpOrToken");return r?$(e,t,r,{isDataPersisted:a,loginType:"MasterPassword"}):(d.triggerAskMasterPassword(t),n.LoginResultEnum.MasterPasswordMissing)}catch(t){throw ne(t)&&(0,D.sendEmailTokenErrorLog)(e),d.triggerOpenSessionFailed(t),t}}(e,t,r,o,a,s),openSessionWithDashlaneAuthenticator:(t,r,o,a)=>async function(e,t,r,o,a){try{const{storeService:s,sessionService:c}=e;t=(0,A.normalizeEmail)(t),await q(e,t,r);if(await c.getInstance().user.accountExistsLocally())throw new Error(n.AuthenticationCode[n.AuthenticationCode.DASHLANE_AUTHENTICATOR_ASKED_FOR_LOCAL_SESSION]);const l=await i.registerDeviceWithDashlaneAuthenticator(s,o,a);if(l===n.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED)return(0,D.sendDashlaneAuthenticatorErrorLog)(e),n.LoginResultEnum.DashlaneAuthenticatorApprovalCancelled;if(l!==n.AuthenticationCode.ASK_MASTER_PASSWORD)throw new Error("unexpected status from verifyDashlaneAuthenticatorPush");return r?$(e,t,r,{isDataPersisted:o,loginType:"MasterPassword"}):(d.triggerAskMasterPassword(t),n.LoginResultEnum.MasterPasswordMissing)}catch(t){ae(t)&&(0,D.sendDashlaneAuthenticatorErrorLog)(e),d.triggerOpenSessionFailed(t)}}(e,t,r,o,a),cancelDashlaneAuthenticatorRegistration:()=>(i.cancelRegistrationWithDashlaneAuthenticator(),Promise.resolve()),openSessionWithOTP:(t,r,o,a,i)=>async function(e,t,r,o,a,i){const{storageService:p,storeService:S,sessionService:g,moduleClients:{"carbon-legacy":y}}=e;try{t=(0,A.normalizeEmail)(t),await q(e,t,r),await se(o);if(!await g.getInstance().user.accountExistsLocally())return Y(e,t,r,o,a,void 0,i);if(S.dispatch((0,l.updateisUsingBackupCode)(i)),S.getAccountInfo().otpType!==u.OtpType.OTP_LOGIN)throw new Error(n.AuthenticationCode[n.AuthenticationCode.OTP_PROVIDED_FOR_LOCAL_NON_OTP_SESSION]);const f=await(0,s.convertTokenToAuthTicket)(S,(0,m.makeOTP)(o));if(!1===f.success){const{error:{code:e,message:t}}=f;if(e===n.AuthenticationCode.BUSINESS_ERROR)throw new Error(t);throw new Error(n.AuthenticationCode[e])}const E=f.authTicket;if(await c.completeLogin(S,p,y,E,i??!1)!==n.AuthenticationCode.ASK_MASTER_PASSWORD)throw new Error("unexpected status from verifyOtpOrToken");return r?$(e,t,r,{isDataPersisted:a}):(d.triggerAskMasterPassword(t),n.LoginResultEnum.MasterPasswordMissing)}catch(t){if(oe(t)){const e=await(0,I.getLocalAccounts)(S,p);d.sendLocalAccounts(e)}throw ne(t)&&(0,D.sendOTPErrorLog)(e,i),d.triggerOpenSessionFailed(t),t}}(e,t,r,o,a,i),openSessionWithOTPForNewDevice:(t,r,o,n,a,i)=>Y(e,t,r,o,n,a,i),openSessionWithMasterPassword:(t,r,o)=>$(e,t,r,o),openSessionResendToken:t=>async function(e,t){await i.askServerToSendToken(e,t),d.triggerOpenSessionTokenSent({isResendAction:!0,login:t})}(e.storeService,t),loadAccountCreationInfos:(t,r,o,n,a,i)=>async function(e,t,r,o,n,a,i){const s=(0,h.secureDeviceName)(o);await q(e,t,r),e.storeService.dispatch((0,_.deviceRegistered)((0,_.makeDeviceRegistrationKeys)(n.accessKey,n.secretKey),i,t)),e.storeService.dispatch((0,y.registerDeviceName)(s)),e.storeService.dispatch((0,y.registerLastSync)(a))}(e,t,r,o,n,a,i)}),t.updateSessionUponLoginAction=q,t.openSessionWithMasterPassword=$;const Q=async(e,t,r)=>{const o=(0,R.hasTACAccessInCurrentSpace)(e);if(n.possibleAdminPermissions.includes(r)&&!o)throw e.isAuthenticated()&&await t.close(),new Error(n.AuthenticationCode[n.AuthenticationCode.USER_UNAUTHORIZED])},X=async(e,t)=>{const r=e.getState(),o=(0,k.pairingIdSelector)(r);d.triggerSessionOpened(e,t,o)},J=(e,t)=>{const{login:r,persistData:o,sessionStartTime:n}=e.getAccountInfo();o===m.PersistData.PERSIST_DATA_YES&&((0,S.storeUserPublicSetting)(r,"lastSuccessfulLoginTime",n),void 0!==t?.triggeredByRememberMeType&&"disabled"!==t?.triggeredByRememberMeType||(0,S.storeUserPublicSetting)(r,"lastMasterPasswordOpenSessionTimestamp",n))},Z=async e=>{await e.accountExistsLocally()?await e.attemptSync(o.Trigger.Login):await e.sync(o.Trigger.InitialLogin)},ee=async e=>{const{sessionService:t,storeService:r}=e,o=t.getInstance().user,a=r.getState(),i=(0,N.recoveryInProgressSelector)(a);if(void 0!==(0,w.ssoMigrationInfoSelector)(a).migration||i)return!0;const s=!await o.accountExistsLocally(),c=(0,T.changeMPinProgressSelector)(a);if(s||c){try{await Z(o)}catch(e){throw new Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_SYNC_ERROR])}return!0}return!1};async function te(e,t,r){const{localDataEncryptorService:o,sessionService:a,storageService:i,storeService:s,moduleClients:d}=e,{login:l,otpType:u}=s.getAccountInfo();await(0,P.deleteAllLocalUserData)(i,d["carbon-legacy"],l),await(0,E.generateLocalkeyAndSetupEncryptorService)(o,s,a,t),t===m.PersistData.PERSIST_DATA_YES&&(c.cacheOtpStatus(s.getAccountInfo().login,u),await(0,U.persistLocalUsersAuthenticationData)(i,s));const p=a.getInstance().user;await p.refreshSessionData(),r?.requiredPermissions&&await Q(s,a,r.requiredPermissions);const S=await(0,F.getDeviceLimitStatus)(e);return"noDeviceLimit"!==S._tag?(await(0,F.startDeviceLimitFlow)(e,S),n.LoginResultEnum.DeviceLimitFlow):re(e,r)}async function re(e,t){try{const{autoLoginService:r,eventBusService:o,sessionService:i,storeService:s,storageService:c,wsService:d}=e,u=i.getInstance().user,S=s.getState(),m=(0,b.userLoginSelector)(S);s.dispatch((0,p.confirmUserAuthentication)()),J(s,t);const y=await ee(e);if(await(0,g.getAndTriggerRefreshAccountInfo)(s,i,d),X(s,c),!1===y)try{await Z(u)}catch(e){throw new Error(n.AuthenticationCode[n.AuthenticationCode.UNKNOWN_SYNC_ERROR])}const A=await(0,I.getLocalAccounts)(s,c);(0,a.sendLocalAccounts)(A);const f="webauthn"!==(0,M.getLocalAccountRememberMeType)(m);s.getUserSession().rememberMasterPassword&&f&&r.initialize(),s.getUserSession().shouldRememberMeForSSO&&f&&(await(0,M.persistLocalAccountRememberMeType)(s,"sso"),s.dispatch((0,V.setRememberMeTypeAction)("sso"))),o.carbonSessionOpened({login:m}),"autologin"!==t?.triggeredByRememberMeType&&s.dispatch((0,l.updateLastMasterPasswordCheck)());const E=(0,b.nodePremiumStatusSelector)(S);return E&&"in_team"===E.b2bStatus?.statusCode&&u.startPeriodic2FAInfoRefresh(),await(0,C.refreshTwoFactorAuthenticationInfoService)(s,d),s.dispatch((0,l.updateSessionDidOpen)(!0)),n.LoginResultEnum.LoggedIn}catch(t){const{storeService:r}=e;throw r.dispatch((0,p.userAuthenticationFailed)()),r.dispatch((0,l.updateSessionDidOpen)(!1)),t}}t.sessionDidOpen=re;const oe=e=>e&&"object"==typeof e&&e.message===n.AuthenticationCode[n.AuthenticationCode.DEVICE_NOT_REGISTERED],ne=e=>e?.message&&O.TokenOrOTPErrorCode.includes(e.message),ae=e=>e?.message&&O.DashlaneAuthenticatorErrorCode.includes(e.message),ie=async(e,t,r,o,n)=>{if(n)try{return await c.checkLogin(e,t,r)}catch(e){if(!oe(e))throw e}const a=(0,v.ukiSelector)(e.getState());return a?i.checkLoginWithUki(e,o,a):i.requestDeviceRegistration(e)};function se(e){if(!e||0===e.length)throw new Error(n.AuthenticationCode[n.AuthenticationCode.EMPTY_OTP])}const ce=/^[0-9]{6}$/;var de;!function(e){e[e.AUTHORIZED=0]="AUTHORIZED",e[e.FORBIDDEN=1]="FORBIDDEN"}(de=t.DifferentLoginAuthorized||(t.DifferentLoginAuthorized={}))},73106:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginViaSSO=void 0;const o=r(58713),n=r(45127),a=r(751),i=r(50058),s=r(16373),c=r(28445),d=r(88610),l=r(19399),u=r(64910),p=r(33769),S=r(16038),m=r(56668),g=r(46298),y=r(16356),A=r(70414),f=r(25576),E=r(16593),h=r(38981),v=r(17387),T=r(62712),_=r(61259),I=r(19083),C=r(28287),P=r(86797),D=r(7624),O=r(658),b=r(90235),w=r(70252),N=r(95623),R=r(56915);t.loginViaSSO=async function(e,t){const{sessionService:r,storeService:i}=e,{ssoServiceProviderKey:d,exist:u,ssoToken:p,consents:S,currentAuths:m=n.SsoMigrationServerMethod.SSO,expectedAuths:g=n.SsoMigrationServerMethod.SSO,inStore:y,anonymousUserId:A}=t;try{const f=(0,c.normalizeEmail)(t.login),E=e.storeService.getUserLogin();if(E&&f!==E){const e=new Error("SSO Login flow with previous login attempt data is prohibited!");throw e._type=n.LoginViaSsoCode.SSO_LOGIN_CORRUPT,e}const h=(0,l.secureDeviceName)(t.deviceName),v={...t,login:f,deviceName:h};if(!(d&&f||y))return i.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.SSO_SETUP_ERROR})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.EMPTY_LOGIN);if(!u){const t={ssoServiceProviderKey:d,login:f,deviceName:h,ssoToken:p,consents:S,anonymousUserId:A};return await(0,a.createSSOAccount)(e,t)}if(!(0,_.isSupportedTransitionFlow)(m,g))return i.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.SSO_SETUP_ERROR})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.UNSUPPORTED_TRANSITION);if(m===n.SsoMigrationServerMethod.MP&&g===n.SsoMigrationServerMethod.SSO)return await M(e,v);if(m===n.SsoMigrationServerMethod.SSO&&g===n.SsoMigrationServerMethod.MP){const e={ssoUser:!0,migration:o.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP};i.dispatch((0,D.storeSSOSettings)(e)),v.requiredPermissions=null}r.setInstance(f,void 0);return await r.getInstance().user.accountExistsLocally()?await L(e,v):await U(e,v)}catch(t){return function({services:e,error:t}){return(0,w.sendExceptionLog)({error:t}),N.default.log(t.message,t),(0,O.sendSsoLoginErrorLog)(e),e.storeService.dispatch((0,s.addNewLoginNotification)({type:t._type===n.LoginViaSsoCode.SSO_LOGIN_CORRUPT?n.LoginNotificationType.SSO_LOGIN_CORRUPT:n.LoginNotificationType.UNKNOWN_ERROR,message:t.message})),(0,_.makeReturnErrorObject)("_type"in t&&t._type||n.LoginViaSsoCode.UNKNOWN_ERROR,t.message)}({services:e,error:t})}};const M=async(e,t)=>{const{storeService:r}=e;let{ssoServiceProviderKey:a,ssoToken:i}=t;const{login:c}=t,{isAuthenticated:l,otpType:u}=r.getAccountInfo();if(t.inStore){const e=(0,h.ssoSettingsSelector)(r.getState());if(a=e.ssoServiceProviderKey,i=e.ssoToken,!a||!i)return r.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.SSO_SETUP_ERROR})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.SSO_VERIFICATION_FAILED)}if(!l){const t={ssoUser:!0,serviceProviderUrl:"",ssoServiceProviderKey:a,ssoToken:i,migration:o.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO};r.dispatch((0,D.storeSSOSettings)(t));return(0,d.makeLoginController)(e).openSession(c),r.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.RELOGIN_NEEDED})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.INNACTIVE_SESSION)}if(u===P.OtpType.NO_OTP){const{success:e}=await(0,C.convertTokenToAuthTicket)(r,(0,v.makeSsoToken)(i));if(!e)return r.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.SSO_SETUP_ERROR})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.SSO_VERIFICATION_FAILED)}const p={newPassword:a,flow:n.ChangeMPFlowPath.MP_TO_SSO},S=await(0,I.changeMasterPassword)(e,p);return!1===S.success?(r.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.UNKNOWN_ERROR,message:S.error.code})),S):(r.dispatch((0,D.resetSSOSettings)()),await(0,b.markNotificationAsUnseen)(e,n.NotificationName.MpToSsoMigrationDoneDialog),(0,_.successResponse)())},L=async(e,{login:t,ssoServiceProviderKey:r,ssoToken:o,requiredPermissions:a,shouldRememberMeForSSO:i})=>{const{storeService:c}=e,l=await(0,R.getDeviceAccessKeySelector)(c.getState(),t);if(!l)throw new Error(n.AuthenticationCode[n.AuthenticationCode.DEVICE_NOT_REGISTERED]);const A=await(0,C.convertTokenToAuthTicket)(c,(0,v.makeSsoToken)(o));if(!1===A.success){const{error:{message:e}}=A;return c.dispatch((0,s.addNewLoginNotification)({type:n.LoginNotificationType.SSO_SETUP_ERROR})),(0,_.makeReturnErrorObject)(n.LoginViaSsoCode.SSO_VERIFICATION_FAILED,e)}const E=A.authTicket,h=await(0,T.completeLoginWithAuthTicket)(c,{login:t,deviceAccessKey:l,authTicket:E});if((0,g.isApiError)(h))return(0,_.formatAPIError)(h);const{masterPasswordEncryptorService:I,remoteDataEncryptorService:P}=e,{ssoServerKey:D,remoteKeys:O}=h,b=(0,S.base64ToBuffer)(D),w=O.filter((e=>"sso"===e.type))[0];let N;try{const e=(0,S.base64ToBuffer)(r),t=(0,p.getEncryptionKeyBuffer)(e,b,{skipDerivation:!0});N=(0,S.arrayBufferToText)(t);const o=(0,u.getNoDerivationCryptoConfig)();I.setInstance({raw:N},"",o);const n=await I.getInstance().decrypt(w.key),a=(0,m.deflatedUtf8ToUtf16)(n,{skipUtf8Decoding:!0,skipInflate:!0});P.setInstance({raw:a},"",o),c.dispatch((0,y.updateRemoteKey)(a))}catch(e){return{success:!1,error:{code:n.LoginViaSsoCode.WRONG_PASSWORD}}}const M=f.PersistData.PERSIST_DATA_YES;return await(0,d.openSessionWithMasterPassword)(e,t,N,{isDataPersisted:M,serverKey:"",requiredPermissions:a,loginType:"SSO",shouldRememberMeForSSO:i}),(0,_.successResponse)()},U=async(e,t)=>{const{storeService:r,masterPasswordEncryptorService:o,remoteDataEncryptorService:n}=e,{deviceName:a,ssoToken:s,login:c,ssoServiceProviderKey:l,requiredPermissions:u,shouldRememberMeForSSO:p}=t;r.dispatch((0,i.updateLocalUserInfo)(c,{ssoActivatedUser:!0}));const S=f.PersistData.PERSIST_DATA_YES,m={masterPasswordEncryptorService:o,remoteDataEncryptorService:n,ssoServiceProviderKey:l};await(0,A.registerDeviceWithToken)(r,S,(0,v.makeSsoToken)(s),!1,c,a,m);const g=e.storeService.getState(),y=(0,E.masterPasswordSelector)(g);return await(0,d.openSessionWithMasterPassword)(e,c,y,{isDataPersisted:S,serverKey:"",requiredPermissions:u,loginType:"SSO",shouldRememberMeForSSO:p}),(0,_.successResponse)()}},61259:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerServiceProviderUrlRedirect=t.successResponse=t.makeReturnErrorObject=t.formatAPIError=t.isSupportedTransitionFlow=void 0;const o=r(45127),n=r(46298),a=r(81228),i=r(38981);t.isSupportedTransitionFlow=(e,t)=>e===o.SsoMigrationServerMethod.SSO?t===o.SsoMigrationServerMethod.SSO||t===o.SsoMigrationServerMethod.MP:e===o.SsoMigrationServerMethod.MP&&t===o.SsoMigrationServerMethod.SSO;t.formatAPIError=e=>{switch(e.code){case n.B2bSsoUserNotFound:case n.InvalidSsoToken:case n.DeviceNotFound:case n.InvalidAuthTicket:return(0,t.makeReturnErrorObject)(o.LoginViaSsoCode.SSO_VERIFICATION_FAILED,e.message);default:return(0,t.makeReturnErrorObject)(o.LoginViaSsoCode.UNKNOWN_ERROR,e.message)}};t.makeReturnErrorObject=(e,t)=>({success:!1,error:{code:e,message:t}});t.successResponse=(e=o.LoginViaSsoCode.SUCCESS)=>({success:!0,code:e}),t.triggerServiceProviderUrlRedirect=function(e,t){const r=`${(0,i.serviceProviderUrlSelector)(e)}?username=${t}`;return(0,a.emitServiceProviderUrl)(r),r}},30322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(46430),n=r(57634),a=r(49154),i=r(27331);t.bootstrap=(e,t,r)=>{if(e.register(o.config),r.connectors.deviceLimit){const e=new a.DeviceLimitCapabilityEventBus(t,r.connectors.deviceLimit),o=(0,i.getDeviceLimitFlowEventsManager)(t.storeService);(0,n.setupDeviceLimitEventBus)(e,o)}}},658:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendMasterPasswordLoginErrorLog=t.sendSsoLoginErrorLog=t.sendBiometricLoginErrorLog=t.sendDashlaneAuthenticatorErrorLog=t.sendOTPErrorLog=t.sendOTPForNewDeviceErrorLog=t.sendEmailTokenErrorLog=t.sendLoginSuccessEventLog=t.sendAskSSOAuthenticationEventLog=t.sendAskBiometricAuthenticationEventLog=t.sendAskAuthenticationEventLog=void 0;const o=r(48062),n=r(17825),a=r(66102),i=r(86797),s=(e,t,r)=>{switch(e){case i.OtpType.NO_OTP:return t?r?o.VerificationMode.AuthenticatorApp:o.VerificationMode.EmailToken:o.VerificationMode.None;case i.OtpType.OTP_NEW_DEVICE:return o.VerificationMode.Otp1;case i.OtpType.OTP_LOGIN:return o.VerificationMode.Otp2;default:return o.VerificationMode.None}},c=async(e,t,r)=>{await(0,a.logEvent)(t,{event:new o.UserAskAuthenticationEvent({mode:e,reason:o.Reason.Login,verificationMode:r})})};t.sendAskAuthenticationEventLog=c.bind(null,o.Mode.MasterPassword),t.sendAskBiometricAuthenticationEventLog=c.bind(null,o.Mode.Biometric),t.sendAskSSOAuthenticationEventLog=c.bind(null,o.Mode.Sso);t.sendLoginSuccessEventLog=async({services:e,isInitial:t,loginType:r})=>{switch(r){case"SSO":await(async(e,t)=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.Sso,status:o.Status.Success,isFirstLogin:t,isBackupCode:!1,verificationMode:o.VerificationMode.None})})})(e,t);break;case"Biometric":await(async e=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.Biometric,status:o.Status.Success,isFirstLogin:!1,isBackupCode:!1,verificationMode:o.VerificationMode.None})})})(e);break;case"MasterPassword":await(async(e,t)=>{const{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:n,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.Success,isFirstLogin:t,isBackupCode:n,verificationMode:c})})})(e,t);break;case"DeviceToDevice":await(async(e,t)=>{const{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:n,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.DeviceTransfer,status:o.Status.Success,isFirstLogin:t,isBackupCode:n,verificationMode:c})})})(e,t);break;case"Autologin":case"MasterPasswordARK":case"PasswordlessARK":case"PasswordlessAccountCreation":return;default:(0,n.assertUnreachable)(r)}};t.sendEmailTokenErrorLog=async e=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:!1,verificationMode:o.VerificationMode.EmailToken})})};t.sendOTPForNewDeviceErrorLog=async(e,t)=>{const{otpType:r}=e.storeService.getAccountInfo();await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:t,verificationMode:r===i.OtpType.OTP_LOGIN?o.VerificationMode.Otp2:o.VerificationMode.Otp1})})};t.sendOTPErrorLog=async(e,t)=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.ErrorWrongOtp,isFirstLogin:!1,isBackupCode:t,verificationMode:o.VerificationMode.Otp2})})};t.sendDashlaneAuthenticatorErrorLog=async e=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.ErrorWrongOtp,isFirstLogin:!0,isBackupCode:!1,verificationMode:o.VerificationMode.AuthenticatorApp})})};t.sendBiometricLoginErrorLog=async e=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.Biometric,status:o.Status.ErrorUnknown,isFirstLogin:!1,isBackupCode:!1,verificationMode:o.VerificationMode.None})})};t.sendSsoLoginErrorLog=async e=>{await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.Sso,status:o.Status.ErrorInvalidSso,isBackupCode:!1,verificationMode:o.VerificationMode.None})})};t.sendMasterPasswordLoginErrorLog=async(e,t)=>{const{otpType:r}=e.storeService.getAccountInfo(),{isUsingBackupCode:n,isUsingDashlaneAuthenticator:i}=e.storeService.getUserSession(),c=s(r,t,i);await(0,a.logEvent)(e,{event:new o.UserLoginEvent({mode:o.Mode.MasterPassword,status:o.Status.ErrorWrongPassword,isFirstLogin:t,isBackupCode:n,verificationMode:c})})}},69718:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addLoginNotification=void 0;const o=r(16373);t.addLoginNotification=async function(e,t){const{storeService:r}=e;r.dispatch((0,o.addNewLoginNotification)(t))}},40588:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(30322);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},24579:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(28096),n=r(1965),a=r(90622),i=r(9344),s=r(31937),c=r(18216),d=r(56915);t.setupSubscriptions=function(e,t){const{storageService:r,storeService:l,moduleClients:{"carbon-legacy":u}}=t;e.appInitialized.on((async e=>{const p=(0,d.localAccountsInitializedSelector)(l.getState());if(e.initMode===c.InitMode.FirstInit){await(0,n.deviceRemoteDeletion)(l,r,u);const e=await(0,a.getLocalAccounts)(l,r);await(0,s.restoreLastAuthenticatedUser)(t,e),(0,o.sendLocalAccounts)(e),t.storeService.dispatch((0,i.localAccountsListUpdated)(e))}else if(!p){const e=await(0,a.getLocalAccounts)(l,r);(0,o.sendLocalAccounts)(e),t.storeService.dispatch((0,i.localAccountsListUpdated)(e))}}))}},15606:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DashlaneAuthenticatorErrorCode=t.TokenOrOTPErrorCode=void 0;const o=r(45127);t.TokenOrOTPErrorCode=[o.AuthenticationCode.TOKEN_EXPIRED,o.AuthenticationCode.TOKEN_NOT_VALID,o.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS,o.AuthenticationCode.EMPTY_TOKEN,o.AuthenticationCode.OTP_ALREADY_USED,o.AuthenticationCode.OTP_NOT_VALID,o.AuthenticationCode.OTP_TOO_MANY_ATTEMPTS,o.AuthenticationCode.EMPTY_OTP,o.AuthenticationCode.BACKUP_CODE_NOT_VALID],t.DashlaneAuthenticatorErrorCode=[o.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED,o.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED,o.AuthenticationCode.FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE]},13465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(90822),n=r(96205),a=r(85316),i=r(69718);t.config={commands:{addLoginNotification:{handler:i.addLoginNotification},clearAllStoredLoginNotification:{handler:n.clearAllStoredLoginNotification}},queries:{getLoginNotifications:{selector:o.loginNotificationListSelector}},liveQueries:{liveLoginNotifications:{operator:a.loginNotificationList$}}}},97046:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(13465);t.bootstrap=e=>{e.register(o.config)}},39952:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(97046);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},85316:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginNotificationList$=void 0;const o=r(18948),n=r(3343),a=r(90822);t.loginNotificationList$=()=>(0,o.pipe)((0,n.map)(a.loginNotificationListSelector),(0,n.distinctUntilChanged)())},90822:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginNotificationListSelector=void 0;t.loginNotificationListSelector=e=>e.inMemoryInterSessionUnsynced.loginNotification},96205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearAllStoredLoginNotification=void 0;const o=r(16373);t.clearAllStoredLoginNotification=async e=>(e.storeService.dispatch((0,o.resetAllLoginNotification)()),{success:!0})},90014:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(16088),n=r(85493),a=r(93069),i=r(6737);t.config={commands:{updateLoginStepInfo:{handler:a.updateLoginStepInfoHandler},resetLoginStepInfo:{handler:i.resetLoginStepInfoHandler}},queries:{getLoginStepInfo:{selector:o.loginStepInfoSelector}},liveQueries:{liveLoginStepInfo:{operator:n.liveLoginStepInfo$}}}},35924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetLoginStepInfo=t.updateLoginStepInfoStep=t.updateLoginStepInfoLogin=t.RESET_LOGIN_STEP_INFO=t.UPDATE_LOGIN_STEP_INFO_STEP=t.UPDATE_LOGIN_STEP_INFO_LOGIN=void 0,t.UPDATE_LOGIN_STEP_INFO_LOGIN="UPDATE_LOGIN_STEP_INFO_LOGIN",t.UPDATE_LOGIN_STEP_INFO_STEP="UPDATE_LOGIN_STEP_INFO_STEP",t.RESET_LOGIN_STEP_INFO="RESET_LOGIN_STEP_INFO";t.updateLoginStepInfoLogin=e=>({type:t.UPDATE_LOGIN_STEP_INFO_LOGIN,login:e});t.updateLoginStepInfoStep=e=>({type:t.UPDATE_LOGIN_STEP_INFO_STEP,step:e});t.resetLoginStepInfo=()=>({type:t.RESET_LOGIN_STEP_INFO})},16088:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loginStepInfoSelector=void 0;t.loginStepInfoSelector=e=>{const t=e.userSession.localSettings.loginStepInfo;return t?.step?t:null}},24413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(90014);t.bootstrap=e=>{e.register(o.config)}},6737:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetLoginStepInfoHandler=void 0;const o=r(35924);t.resetLoginStepInfoHandler=e=>(e.storeService.dispatch((0,o.resetLoginStepInfo)()),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},93069:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateLoginStepInfoHandler=void 0;const o=r(35924);t.updateLoginStepInfoHandler=(e,t)=>(void 0!==t.login&&e.storeService.dispatch((0,o.updateLoginStepInfoLogin)(t.login)),void 0!==t.step&&e.storeService.dispatch((0,o.updateLoginStepInfoStep)(t.step)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},37824:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(24413);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},85493:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.liveLoginStepInfo$=void 0;const o=r(18948),n=r(3343),a=r(16088);t.liveLoginStepInfo$=()=>(0,o.pipe)((0,n.map)(a.loginStepInfoSelector),(0,n.distinctUntilChanged)())},82413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;const o=r(4939),n=r(4407),a=([e,...t])=>{let r="",o=[];"string"==typeof e?r=e:o=[e],o=[...o,...t];const n=(e=>e.reduce(((e,t)=>{const r=Object.keys(e).length;return{...e,[r]:t}}),{}))(o);return{message:r,details:n}};const i=function(){const e=e=>(...t)=>{const r={...a(t),level:e};(0,o.log)(r)};return{log:e(n.LogLevel.Debug),info:e(n.LogLevel.Info),warn:e(n.LogLevel.Warn),error:e(n.LogLevel.Error)}}();t.Debugger=i,t.default=i},4939:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.redirectConsoleLogs=t.logVerbose=t.logDebug=t.logInfo=t.logWarn=t.logError=t.log=void 0;const o=r(62433),n=r(48749),a=r(43051),i=r(4407),s=r(82569),c=r(17825),d=r(32588);let l=null;const u=e=>t=>{const{level:r=i.LogLevel.Error}=t,o=(e=>{switch(e){case i.LogLevel.Error:return console.error;case i.LogLevel.Warn:return console.warn;case i.LogLevel.Info:return console.info;case i.LogLevel.Verbose:return console.log;case i.LogLevel.Debug:return console.debug;default:return(0,c.assertUnreachable)(e)}})(r),n=e(t);o.call(this,n)},p=(0,s.formatLogEntry)(s.formatLogEntryDetail),S=(e,t)=>r=>o=>t(o[e])&&r(o),m=S("tag",((e=[])=>{const t=n.config.LOG_TAGS||[],r="string"==typeof t?[t]:[...t],o="string"==typeof e?[e]:[...e];return!r.length||r.some((e=>o.includes(e)))})),g=S("level",(e=>e>=n.config.LOG_LEVEL)),y=(0,o.pipe)((e=>t=>(l||u(e))(t)),g,m)(p);y({message:"~~~ Logs activated ~~~",level:i.LogLevel.Info,tag:[d.LOGS_LOG_TAG,d.DEBUGGER_LOG_TAG]}),t.log=y,t.logError=(0,a.withErrorLevel)(y),t.logWarn=(0,a.withWarnLevel)(y),t.logInfo=(0,a.withInfoLevel)(y),t.logDebug=(0,a.withDebugLevel)(y),t.logVerbose=(0,a.withVerboseLevel)(y);t.redirectConsoleLogs=e=>(l=e,()=>{l=null})},43051:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.withVerboseLevel=t.withDebugLevel=t.withInfoLevel=t.withWarnLevel=t.withErrorLevel=t.withTag=t.withLevel=void 0;const o=r(4407),n=(e,t)=>r=>o=>r({[e]:t,...o});t.withLevel=e=>n("level",e);t.withTag=e=>n("tag",e),t.withErrorLevel=(0,t.withLevel)(o.LogLevel.Error),t.withWarnLevel=(0,t.withLevel)(o.LogLevel.Warn),t.withInfoLevel=(0,t.withLevel)(o.LogLevel.Info),t.withDebugLevel=(0,t.withLevel)(o.LogLevel.Debug),t.withVerboseLevel=(0,t.withLevel)(o.LogLevel.Verbose)},82569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatLogEntryDetail=t.formatLogEntry=void 0;const o=r(92263),n=r(4407),a=":",i=" ",s="|";function c(e){const{stack:t}=e;let r=`${e}`;if(t&&"string"==typeof t){t.substr(0,t.indexOf("\n"))===r&&(r="")}return`${r}${r?`\n${t}`:t}`}const d={[n.LogLevel.Error]:"(e)",[n.LogLevel.Warn]:"(w)",[n.LogLevel.Info]:"(i)",[n.LogLevel.Debug]:"(d)",[n.LogLevel.Verbose]:"(v)"};t.formatLogEntry=e=>t=>{const{details:r={},level:o=n.LogLevel.Debug,message:c,tag:l=[]}=t,u=function(e){const t=Array.isArray(e)?e:[e];return t.length?` [${t.join(s)}]`:""}(l),p=d[o],S=Boolean(c),m=S?` ${c}`:"",g=function(e,t,r){return Object.keys(t).reduce(((o,n)=>!Number.isInteger(parseInt(n,10))&&r?`${o}${i}${n}${a}${e(t[n])}`:`${o}${i}${e(t[n])}`),"")}(e,r,S);return`${p}${u}${m}${g}`};t.formatLogEntryDetail=e=>(0,o.isCarbonError)(e)?function(e){const t=JSON.stringify(e.getAdditionalInfo()),r=t?`\n${t}`:"";return`${c(e)}${r}`}(e):e instanceof Error?c(e):"object"==typeof e?JSON.stringify(e):String(e)},95623:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.withWarnLevel=t.withVerboseLevel=t.withTag=t.withLevel=t.withInfoLevel=t.withErrorLevel=t.withDebugLevel=t.Silent=t.LogLevel=t.redirectConsoleLogs=t.logWarn=t.logVerbose=t.logInfo=t.logError=t.logDebug=t.log=void 0;const a=r(82413);t.default=a.Debugger;var i=r(4939);Object.defineProperty(t,"log",{enumerable:!0,get:function(){return i.log}}),Object.defineProperty(t,"logDebug",{enumerable:!0,get:function(){return i.logDebug}}),Object.defineProperty(t,"logError",{enumerable:!0,get:function(){return i.logError}}),Object.defineProperty(t,"logInfo",{enumerable:!0,get:function(){return i.logInfo}}),Object.defineProperty(t,"logVerbose",{enumerable:!0,get:function(){return i.logVerbose}}),Object.defineProperty(t,"logWarn",{enumerable:!0,get:function(){return i.logWarn}}),Object.defineProperty(t,"redirectConsoleLogs",{enumerable:!0,get:function(){return i.redirectConsoleLogs}}),n(r(82413),t);var s=r(4407);Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return s.LogLevel}}),Object.defineProperty(t,"Silent",{enumerable:!0,get:function(){return s.Silent}});var c=r(43051);Object.defineProperty(t,"withDebugLevel",{enumerable:!0,get:function(){return c.withDebugLevel}}),Object.defineProperty(t,"withErrorLevel",{enumerable:!0,get:function(){return c.withErrorLevel}}),Object.defineProperty(t,"withInfoLevel",{enumerable:!0,get:function(){return c.withInfoLevel}}),Object.defineProperty(t,"withLevel",{enumerable:!0,get:function(){return c.withLevel}}),Object.defineProperty(t,"withTag",{enumerable:!0,get:function(){return c.withTag}}),Object.defineProperty(t,"withVerboseLevel",{enumerable:!0,get:function(){return c.withVerboseLevel}}),Object.defineProperty(t,"withWarnLevel",{enumerable:!0,get:function(){return c.withWarnLevel}})},4407:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Silent=t.LogLevel=void 0,function(e){e[e.Verbose=0]="Verbose",e[e.Debug=10]="Debug",e[e.Info=20]="Info",e[e.Warn=30]="Warn",e[e.Error=40]="Error"}(t.LogLevel||(t.LogLevel={})),t.Silent=100},59398:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(66102);t.config={commands:{logEvent:{handler:o.logEvent},logPageView:{handler:o.logPageView}},queries:{},liveQueries:{}}},38912:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateEventLoggerVirtualStoreState=t.UPDATE_EVENT_LOGGER_STATE=t.createEventLoggerVirtualStore=t.CREATE_EVENT_LOGGER_VIRTUAL_STORE=void 0,t.CREATE_EVENT_LOGGER_VIRTUAL_STORE="CREATE_EVENT_LOGGER_VIRTUAL_STORE";t.createEventLoggerVirtualStore=({storeName:e,initialState:r})=>({type:t.CREATE_EVENT_LOGGER_VIRTUAL_STORE,storeName:e,initialState:r}),t.UPDATE_EVENT_LOGGER_STATE="UPDATE_EVENT_LOGGER_STATE";t.updateEventLoggerVirtualStoreState=({storeName:e,updater:r})=>({type:t.UPDATE_EVENT_LOGGER_STATE,storeName:e,updater:r})},52895:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(59398);t.bootstrap=(e,t)=>{e.register(o.config),t.eventLoggerService.initRepository()}},87911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decryptEvents=t.encryptEvents=void 0;const o=r(72365),n=r(91301),a=r(65675),i=r(56668);t.encryptEvents=async function(e,t,r){const s=JSON.stringify(t),c=(0,i.deflateUtf16)(s);return await async function({storeService:e,encryptionKey:t,data:r}){const i=(0,o.makeDataEncryptorService)(e),{cryptoConfig:s}=(0,a.parsePayload)(n.CRYPTO_NODERIVATION_HMAC64);i.setInstance({raw:t},"",s);const c=await i.getInstance().encrypt(r);return i.close(),c}({storeService:e,encryptionKey:r,data:c})},t.decryptEvents=async function(e,t,r){const n=await async function({storeService:e,encryptedData:t,encryptionKey:r}){const n=(0,o.makeDataEncryptorService)(e);n.setInstance({raw:r},"");const a=await n.getInstance().decrypt(t);return n.close(),a}({storeService:e,encryptedData:t,encryptionKey:r}),a=(0,i.inflateUtf16)(n);return JSON.parse(a)}},26415:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.chunkArray=t.getOsContext=t.getOsVersion=t.getOsType=t.getBrowserContext=t.getAppContext=t.applicationBuildTypeToHermesBuildType=t.platformStringToAppPlatform=t.createLogger=void 0;const o=r(48062),n=r(45127),a=r(12206),i=r(48749),s=r(17825);t.createLogger=e=>{const{eventLoggerService:t}=e,r=t.getRepository("createLogger");return{logger:r.createLogger(),logRepository:r}};t.platformStringToAppPlatform=e=>{switch(e){case"server_standalone":case"server_carbon_unknown":case"server_carbon_tests":return o.Platform.Saex;case"server_leeloo_dev":case"server_leeloo":case"server_tac":return o.Platform.Web;default:(0,s.assertUnreachable)(e,`Hermes Web SDK: Unsupported platform "${e}" detected. This platform is not supported by the Hermes Web SDK or Styx API.`)}};t.applicationBuildTypeToHermesBuildType=e=>{switch(e){case n.ApplicationBuildType.DEV:return o.BuildType.Dev;case n.ApplicationBuildType.QA:return o.BuildType.Qa;case n.ApplicationBuildType.NIGHTLY:return o.BuildType.Nightly;default:return o.BuildType.Production}};t.getAppContext=e=>{const r=e.getPlatformInfo(),{buildType:o}=r;return{platform:(0,t.platformStringToAppPlatform)(r.platformName),version:(n=r.appVersion,a=i.config.MANIFEST_VERSION,a?n+"-mv"+a:n),build_type:(0,t.applicationBuildTypeToHermesBuildType)(o)};var n,a};t.getBrowserContext=()=>({name:a.browser.getBrowserName(),version:a.browser.getBrowserVersion(),user_agent:a.navigator.getNavigator().userAgent});t.getOsType=e=>{let t=o.OsType.Other;const r=e.os.toLowerCase().replace(/[ -/]+/g,"_");return Object.values(o.OsType).map((e=>e.toString())).includes(r)&&(t=r),t};t.getOsVersion=e=>{const t="Mac OS"===e.os?e.osVersion.replace("OS_X_","").replace(/_/g,"."):e.osVersion,r=/([0-9]{1,3}(?:\.[0-9]{0,4}){0,2})/.exec(t);return r&&r.length>=2?r[1]:"0"};t.getOsContext=e=>{const r=e.getPlatformInfo();return{type:(0,t.getOsType)(r),version:(0,t.getOsVersion)(r),locale:r.lang}},t.chunkArray=function e(t,r){return t.length<=r?[t]:[t.slice(0,r),...e(t.slice(r),r)]}},74412:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeEventLoggerService=t.bootstrap=void 0;const o=r(48062),n=r(48749),a=r(26415),i=r(2246),s=r(87564),c=r(10460),d=r(78671),l=r(99921);var u=r(52895);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return u.bootstrap}});t.makeEventLoggerService=e=>{let t=null;const r=r=>{if(!t)throw new Error(`makeEventLoggerService: You must call initRepository() before getting the repository instance, eventName: ${r}`);const o=e.storeService.getUserSession();return(o.analyticsIds?.userAnalyticsId||o.analyticsIds?.deviceAnalyticsId)&&t.setTrackingInfo(o.analyticsIds.userAnalyticsId,o.analyticsIds.deviceAnalyticsId),t};return{initRepository:()=>{const r=e.storeService,s=(0,a.getAppContext)(r),c=(0,a.getOsContext)(r),d=(0,a.getBrowserContext)(),u=(0,i.getCommonAppSetting)("installationId"),p=new l.EventLoggerStoreFactory(r);t=new o.LogRepository(s,c,d,u,void 0,!1,p);const S=r.getUserSession();(S.analyticsIds?.userAnalyticsId||S.analyticsIds?.deviceAnalyticsId)&&t.setTrackingInfo(S.analyticsIds.userAnalyticsId,S.analyticsIds.deviceAnalyticsId),3===n.config.MANIFEST_VERSION&&t.setServiceWorkerStartTime((new Date).toISOString())},getRepository:r,logEvent:async o=>{const{interactionDataConsent:n}=await(0,d.getGlobalExtensionSettings)(e);if(!(!1!==n))return;return r(o.name).createLogger().logEvent(o),(0,c.storeEventsInQueue)(e,t)},logSync:async o=>{const{interactionDataConsent:n}=await(0,d.getGlobalExtensionSettings)(e);if(!(!1!==n))return;return r(o.name).createLogger().logEvent(o),(0,c.storeEventsInQueue)(e,t)},flushEventQueue:()=>(0,s.sendEventQueueToStyx)(e)}}},4296:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.immediatelySendEvents=t.queueEvents=t.queueLogRepositoryEvents=void 0;const o=r(45127),n=r(87564),a=r(10460);async function i(e,t){const r=t.logStorage.containsPriorityEvent();try{if(await(0,a.storeEventsInQueue)(e,t),r){return await(0,n.sendEventQueueToStyx)(e)}return{success:!0,result:o.StyxApiResult.NoBatchesSent}}catch(e){return{success:!1,result:o.StyxApiResult.NoBatchesSent}}}async function s(e,t){try{return await(0,n.immediatelySendEventsToStyx)(e,t)}catch(e){return{success:!1,result:o.StyxApiResult.NoBatchesSent}}}t.queueLogRepositoryEvents=async function(e,t){const{buildType:r}=e.storeService.getPlatformInfo();return r===o.ApplicationBuildType.QA?s(e,t):i(e,t)},t.queueEvents=i,t.immediatelySendEvents=s},19764:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.eventLoggerReducer=void 0;const o=r(38912);t.eventLoggerReducer=(e={},t)=>{switch(t.type){case o.CREATE_EVENT_LOGGER_VIRTUAL_STORE:return{[t.storeName]:t.initialState};case o.UPDATE_EVENT_LOGGER_STATE:return{[t.storeName]:t.updater(e[t.storeName])};default:return e}}},39261:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.styxKeysSelector=void 0;t.styxKeysSelector=e=>e.userSession.sdkAuthentication.styxKeys},87564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.immediatelySendEventsToStyx=t.sendEventQueueToStyx=void 0;const o=r(45127),n=r(2246),a=r(45956),i=r(76330),s=r(87911),c=r(26415),d=r(10460),l=450;let u=!1;async function p(e,t,r){let o=[];if(!t||0===t.length)return o;const n=(0,i.getMakeStyxApiRequest)(r,a.ApiAuthType.App,a.ApiRequestMethod.POST),s=(0,c.chunkArray)(t,l);try{for(const t of s){if(!(await n(e,{payload:(0,i.getEventsPayload)(t)})).success)break;o=o.concat(t.map((({id:e})=>e)))}}catch{return o}return o}t.sendEventQueueToStyx=async function(e){if(!0===u)return{success:!0,result:o.StyxApiResult.NoBatchesSent};u=!0;const{storageService:t,storeService:r}=e,a=t.getLocalStorage(),i=(0,n.getCommonAppSetting)("eventLoggerQueueKey");if(!await a.itemExists(d.EVENT_QUEUE_STORAGE_KEY))return u=!1,{success:!0,result:o.StyxApiResult.NoBatchesSent};const c=await a.readItem(d.EVENT_QUEUE_STORAGE_KEY);if(!c)return u=!1,{success:!0,result:o.StyxApiResult.NoBatchesSent};if("string"!=typeof c)throw new Error("value of EventLogger.eventQueue is expected to be a string");const l=await(0,s.decryptEvents)(r,c,i),S=l.filter((e=>"anonymous"===e.category)),m=l.filter((e=>"user"===e.category)),g=await p(r,S,"/v1/event/anonymous"),y=await p(r,m,"/v1/event/user"),A=await a.readItem(d.EVENT_QUEUE_STORAGE_KEY);if("string"!=typeof A)throw new Error("value of EventLogger.eventQueue is expected to be a string");const f=(await(0,s.decryptEvents)(r,A,i)).filter((({id:e})=>!(g.includes(e)||y.includes(e)))),E=await(0,s.encryptEvents)(r,f,i);await a.writeItem(d.EVENT_QUEUE_STORAGE_KEY,E);const h=g.length>0||y.length>0,v=0===E.length;let T=o.StyxApiResult.NoBatchesSent;return v?T=o.StyxApiResult.AllBatchesSent:h&&(T=o.StyxApiResult.SomeBatchesSent),u=!1,{success:!0,result:T}},t.immediatelySendEventsToStyx=async function(e,t){const{storeService:r}=e,n=t.logStorage.copy();t.logStorage.removeEvents(n.map((e=>e.id)));const a=n.filter((e=>"anonymous"===e.category)),i=n.filter((e=>"user"===e.category)),s=await p(r,a,"/v1/event/anonymous"),c=await p(r,i,"/v1/event/user"),d=s.length>0||c.length>0,l=s.length+c.length===n.length;let u=o.StyxApiResult.NoBatchesSent;return l?u=o.StyxApiResult.AllBatchesSent:d&&(u=o.StyxApiResult.SomeBatchesSent),{success:!0,result:u}}},66102:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logToggleAnalyticsEvent=t.logPageView=t.logEvent=void 0;const o=r(48062),n=r(45127),a=r(78671),i=r(26415),s=r(4296),c=r(10460);t.logEvent=async function(e,t){const{interactionDataConsent:r}=await(0,a.getGlobalExtensionSettings)(e);if(!(!1!==r))return{result:n.StyxApiResult.NoBatchesSent,success:!1};const{logger:o,logRepository:c}=(0,i.createLogger)(e);return o.logEvent(t.event),(0,s.queueLogRepositoryEvents)(e,c)},t.logPageView=async function(e,t){const{interactionDataConsent:r}=await(0,a.getGlobalExtensionSettings)(e);if(!(!1!==r))return{result:n.StyxApiResult.NoBatchesSent,success:!1};const{logger:o,logRepository:c}=(0,i.createLogger)(e);return o.logView(t.pageView,t.browseComponent),(0,s.queueLogRepositoryEvents)(e,c)},t.logToggleAnalyticsEvent=async function(e){const{interactionDataConsent:t}=await(0,a.getGlobalExtensionSettings)(e),{logger:r,logRepository:n}=(0,i.createLogger)(e),d=!1!==t;if(d||(0,c.clearEventQueue)(e,n),r.logEvent(new o.UserToggleAnalyticsEvent({isAnalyticsEnabled:d})),!t)try{return(0,s.immediatelySendEvents)(e,n)}catch{return(0,s.queueLogRepositoryEvents)(e,n)}return(0,s.queueLogRepositoryEvents)(e,n)}},10460:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearEventQueue=t.storeEventsInQueue=t.EVENT_QUEUE_STORAGE_KEY=void 0;const o=r(2246),n=r(87911);t.EVENT_QUEUE_STORAGE_KEY="EventLogger.eventQueue",t.storeEventsInQueue=async function(e,r){const{storageService:a,storeService:i}=e,s=a.getLocalStorage(),c=(0,o.getCommonAppSetting)("eventLoggerQueueKey"),d=r.logStorage.copy();let l=[];const u=[];if(await s.itemExists(t.EVENT_QUEUE_STORAGE_KEY)){const e=await s.readItem(t.EVENT_QUEUE_STORAGE_KEY);if("string"!=typeof e)throw new Error("value of EventLogger.eventQueue is expected to be a string");e&&(l=await(0,n.decryptEvents)(i,e,c))}l=l.concat(d),l.map((e=>u.filter((t=>t.id===e.id)).length>0?null:u.push(e)));const p=await(0,n.encryptEvents)(i,u,c);await s.writeItem(t.EVENT_QUEUE_STORAGE_KEY,p);const S=d.map((e=>e.id));r.logStorage.removeEvents(S)},t.clearEventQueue=async function(e,r){const{storageService:a,storeService:i}=e,s=a.getLocalStorage(),c=(0,o.getCommonAppSetting)("eventLoggerQueueKey"),d=await(0,n.encryptEvents)(i,[],c);await s.writeItem(t.EVENT_QUEUE_STORAGE_KEY,d);const l=r.logStorage.copy().map((e=>e.id));r.logStorage.removeEvents(l)}},99921:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerStoreFactory=void 0;const o=r(38912);t.EventLoggerStoreFactory=class{constructor(e){this.storeService=e}createStore(e,t){const{storeService:r}=this;return r.dispatch((0,o.createEventLoggerVirtualStore)({storeName:e,initialState:t.initialState})),this.makeStore(e)}getStore(e){if(!this.hasStore(e))throw new Error(`Store ${e} was not found`);return this.makeStore(e)}hasStore(e){const{storeService:t}=this;return e in t.getState().device.eventLogger}makeStore(e){const{storeService:t}=this;return{getState:()=>t.getState().device.eventLogger[e],updateState:r=>t.dispatch((0,o.updateEventLoggerVirtualStoreState)({storeName:e,updater:r}))}}}},33341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(14414);t.config={commands:{logException:{handler:o.logException}},liveQueries:{},queries:{}}},55101:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(33341);t.bootstrap=e=>{e.register(o.config)}},70252:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendTypedExceptionLog=t.sendExceptionLog=t.setAllowedToSendExceptionLog=t.bootstrap=void 0;const o=r(74450),n=r(12126),a=r(95623);var i=r(55101);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}});let s=!0;t.setAllowedToSendExceptionLog=e=>s=e,t.sendExceptionLog=async function(e){if(s)try{const t=(0,n.default)("carbonException",e);console.log("[background/carbon] Sending exception",t),await(0,o.default)(t)}catch(e){console.log("[background/carbon] Failed sending exception",e)}else console.log("[background/carbon] Not allowed to send exception logs")},t.sendTypedExceptionLog=async function(e,t){if(s)try{await(0,o.default)((0,n.default)(e,t))}catch(e){a.Debugger.error(`[Exception] - sendTypedExceptionLog: ${e.message||e}`)}}},12126:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.anonymousSessionId=void 0;const o=r(35088),n=r(45127),a=r(86056),i=r(92263),s=r(48749);function c(e){const r=function(e){const t={...e,codeName:s.config.CODE_NAME,manifestVersion:s.config.MANIFEST_VERSION};return JSON.stringify(t)}(e.additionalInfo);return{action:"logOnline",code:e.code===n.ExceptionCriticality.WARNING?n.ExceptionCriticality.WARNING:n.ExceptionCriticality.ERROR,message:e.message||"",exceptiontype:e.type,functionName:e.funcName,file:e.fileName,legacy:Boolean(e.legacy),line:e.line,stack:e.precisions,sessionId:t.anonymousSessionId,additionalInfo:r,errorCount:1,featureFlips:[],initialUseCaseModule:e.initialUseCaseModule??"carbon",initialUseCaseName:e.initialUseCaseName,useCaseStacktrace:e.useCaseStacktrace??[]}}function d(e,t){const r=t;if(r.error){const t=r.error.precisions&&"string"==typeof r.error.precisions?`${r.error.message}\n${r.error.precisions}`:r.error.message,o=(0,i.isCarbonError)(r.error)?r.error.getAdditionalInfo():{};return c({type:e,message:t,code:r.code||r.error.errorLevel,precisions:r.error.stack,additionalInfo:o,initialUseCaseModule:"carbon",initialUseCaseName:""})}return c(Object.assign({type:e},t))}t.anonymousSessionId=(0,o.v4)(),t.default=function(e,t){return{...(r=(0,a.getPlatformInfo)(),{type:r.platformName,version:r.appVersion,osVersion:r.osVersion,browser:r.browser,browserVersion:r.browserVersion,os:r.os}),...d(e,t)};var r}},74450:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEPTION_LOG_ENDPOINT=void 0;const o=r(28445);t.EXCEPTION_LOG_ENDPOINT="https://kck3hlb9.dashlane.com/1/softwarelog/create";const n=10;t.default=function(e){return function(e,t,r){const o=e.message||e.functionName||e.file||"UNKNOWN_EXCEPTION";if(a[o]=a[o]||0,a[o]++,a[o]>t)return Promise.resolve();return r()}(e,n,(()=>(0,o.postDataToUrl)(t.EXCEPTION_LOG_ENDPOINT,e).then((()=>{})).catch((e=>{console.error("[background/carbon] Failed to send exception log",e)}))))};const a={}},14414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logException=void 0;const o=r(70252);t.logException=async function(e,t){return await(0,o.sendTypedExceptionLog)(t.exceptionType,t.log),{success:!0}}},32588:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EXCEPTION_LOG_TAG=t.DEBUGGER_LOG_TAG=t.LOGS_LOG_TAG=void 0,t.LOGS_LOG_TAG="Logs",t.DEBUGGER_LOG_TAG="Debugger",t.EXCEPTION_LOG_TAG="Exception"},88393:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(24375),n=r(55111),a=r(90235),i=r(26972),s=r(56857);t.config={commands:{markNotificationAsInteracted:{handler:o.markNotificationAsInteracted},markNotificationAsSeen:{handler:n.markNotificationAsSeen},markNotificationAsUnseen:{handler:a.markNotificationAsUnseen}},queries:{getNotificationStatus:{selector:s.notificationsStatusSelector}},liveQueries:{liveNotificationStatus:{operator:i.notificationsStatus$}}}},42122:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(88393);t.bootstrap=e=>{e.register(o.config)}},70530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(42122);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},24375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsInteracted=void 0;const o=r(34287),n=r(56857);t.markNotificationAsInteracted=async(e,t)=>{const{storeService:r,localStorageService:a}=e;r.dispatch((0,o.markAsInteracted)(t));const i=(0,n.notificationsStatusSelector)(r.getState());a.getInstance().storeNotificationsStatus(i)}},55111:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsSeen=void 0;const o=r(34287),n=r(56857);t.markNotificationAsSeen=async(e,t)=>{const{storeService:r,localStorageService:a}=e;r.dispatch((0,o.markAsSeen)(t));const i=(0,n.notificationsStatusSelector)(r.getState());a.getInstance().storeNotificationsStatus(i)}},90235:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.markNotificationAsUnseen=void 0;const o=r(34287),n=r(56857);t.markNotificationAsUnseen=async(e,t)=>{const{storeService:r,localStorageService:a}=e;r.dispatch((0,o.markAsUnseen)(t));const i=(0,n.notificationsStatusSelector)(r.getState());a.getInstance().storeNotificationsStatus(i)}},62952:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(57470),n=r(45709),a=r(91880);t.config={commands:{generatePassword:{handler:o.generatePasswordHandler},generateAndSavePassword:{handler:o.generateAndSavePasswordHandler},savePasswordGenerationSettings:{handler:n.savePasswordGenerationSettingsHandler}},queries:{getPasswordGenerationSettings:{selector:a.passwordGenerationSettingsSelector}},liveQueries:{}}},64811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(62952);t.bootstrap=e=>{e.register(o.config)}},57470:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSavePasswordHandler=t.generatePasswordHandler=void 0;const o=r(47975),n=r(95623),a=r(70252),i=r(5464);t.generatePasswordHandler=async function(e,t){try{const r=(0,i.makeSessionController)(e).generatePassword(t.settings);return{success:!0,password:r,strength:await(0,o.evaluatePasswordStrength)(r)}}catch(e){return(0,n.logError)(e),(0,a.sendExceptionLog)({error:e}),{success:!1}}},t.generateAndSavePasswordHandler=async function(e,t){try{const r=(0,i.makeSessionController)(e).generateAndSavePassword(t.url);return{success:!0,password:r,strength:await(0,o.evaluatePasswordStrength)(r)}}catch(e){return(0,n.logError)(e),(0,a.sendExceptionLog)({error:e}),{success:!1}}}},45709:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.savePasswordGenerationSettingsHandler=void 0;const o=r(48062),n=r(95623),a=r(70252),i=r(44908),s=r(29954),c=r(23136);t.savePasswordGenerationSettingsHandler=async function(e,t){try{const n=(0,i.fixIncoherentSettings)(t),a={GeneratorDefaultSize:(r=n).length,GeneratorDefaultAvoidAmbiguousChars:r.avoidAmbiguous,GeneratorDefaultDigits:r.digits,GeneratorDefaultLetters:r.letters,GeneratorDefaultSymbols:r.symbols};(0,s.updatePersonalSettings)(e.storeService,e.sessionService,a),(0,c.getDebounceSync)(e.storeService,e.sessionService)({immediateCall:!0},o.Trigger.SettingsChange)}catch(e){(0,n.logError)(e),(0,a.sendExceptionLog)({error:e})}var r}},91880:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.passwordGenerationSettingsSelector=void 0;const o=r(16593),n=r(44908);t.passwordGenerationSettingsSelector=function(e){const t=(0,o.personalSettingsSelector)(e);return(0,n.getDefaultPasswordGenerationSettings)(t)}},76860:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkPasswordLeaked=void 0,t.checkPasswordLeaked=async function(e,t){const{password:r}=t,{applicationModulesAccess:o}=e,{commands:{temporaryCheckMasterPassword:n}}=o.createClients().masterPasswordSecurity;await n({password:r})}},14064:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkPasswordWeak=void 0,t.checkPasswordWeak=async function(e,t){const{password:r}=t,{applicationModulesAccess:o}=e,{commands:{temporaryCheckMasterPasswordWeak:n}}=o.createClients().masterPasswordSecurity;await n({password:r})}},84264:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldTriggerMasterPasswordWeakCheck=t.shouldTriggerMasterPasswordLeakCheck=void 0;const o=r(16593);t.shouldTriggerMasterPasswordLeakCheck=function(e){return(0,o.isAuthenticatedSelector)(e)},t.shouldTriggerMasterPasswordWeakCheck=async function(e){return!!(0,o.isAuthenticatedSelector)(e)}},43057:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(20478);t.setupSubscriptions=function(e,t){e._sessionOpened.on((()=>{(0,o.triggerMasterPasswordLeakCheck)(t)}))}},20478:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerMasterPasswordLeakCheck=void 0;const o=r(76860),n=r(16593),a=r(38981),i=r(84264),s=r(14064);t.triggerMasterPasswordLeakCheck=async function(e){const t=e.storeService.getState();if((0,a.isSSOUserSelector)(t))return;const r=(0,n.masterPasswordSelector)(t);await(0,o.checkPasswordLeaked)(e,{password:r}),await(0,i.shouldTriggerMasterPasswordWeakCheck)(t)&&await(0,s.checkPasswordWeak)(e,{password:r})}},34161:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(30467),n=r(18693),a=r(97475);t.config={commands:{cancelAutoRenew:{handler:n.cancelAutoRenew},fetchInvoiceList:{handler:a.fetchInvoiceList}},queries:{getInvoicesCount:{selector:o.allInvoicesLengthSelector},getInvoiceList:{selector:o.viewedQueriedInvoicesSelector},getInvoiceListYears:{selector:o.invoiceListYearsSelector}},liveQueries:{}}},78025:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(34161);t.bootstrap=e=>{e.register(o.config)}},18693:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cancelAutoRenew=void 0;const o=r(70252);t.cancelAutoRenew=async function(e){const{sessionService:t,storeService:r}=e;if(!r.isAuthenticated())return{success:!1};try{return await t.getInstance().payment.cancelPremiumSubscription(),{success:!0}}catch(e){const t=`[SessionController] - cancelPremiumSubscription: ${e}`,r=new Error(t);return(0,o.sendExceptionLog)({error:r}),{success:!1,error:{code:t}}}}},97475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchInvoiceList=void 0;const o=r(46298),n=r(36273),a=r(95944);t.fetchInvoiceList=async function(e){const{storeService:t}=e,r=t.getUserLogin();if(!t.isAuthenticated())return{success:!1};try{const e=await(0,n.listInvoices)(t,r);return(0,o.isApiError)(e)?{success:!1}:(t.dispatch((0,a.receivedInvoiceList)(e.invoices)),{success:!0})}catch(e){return{success:!1}}}},7753:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(78025);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},98584:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInvoiceMappers=void 0;const o=r(66986);t.getInvoiceMappers=()=>({amountPaid:e=>e.amountPaid,invoiceId:e=>e.invoiceId,planName:e=>(e=>"advanced"===e.planFeature?"ADVANCED":"essentials"===e.planFeature?"ESSENTIALS":["family_created","family_renewed"].includes(e.eventType)?"FAMILY":"sync"===e.planFeature?"PREMIUM":"OTHER")(e),startDate:e=>e.startDate,startYear:e=>(e=>(0,o.fromUnixTime)(e.startDate).getFullYear().toString())(e)})},73938:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(28903),n=r(81846),a=r(84547),i=r(64331);t.config={commands:{unlockProtectedItems:{handler:o.unlockProtectedItems},disableCredentialProtection:{handler:a.disableCredentialProtectionHandler}},queries:{vaultLockDate:{selector:n.vaultLockDateSelector}},liveQueries:{liveVaultLockDate:{operator:i.vaultLockDate$}}}},28903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unlockProtectedItems=void 0;const o=r(45127),n=r(28287);t.unlockProtectedItems=async function(e,t){const{storeService:r,masterPasswordEncryptorService:a}=e;return await(0,n.validateMasterPassword)(r,a,t)?{status:o.UnlockProtectedItemsStatus.SUCCESS}:{status:o.UnlockProtectedItemsStatus.ERROR,error:{code:o.unlockProtectedItemsWrongPasswordError}}}},64710:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(73938);t.bootstrap=e=>{e.register(o.config)}},84547:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableCredentialProtectionHandler=void 0;const o=r(45127),n=r(18344);t.disableCredentialProtectionHandler=async function(e,{credentialId:t}){const{storeService:r,sessionService:a,eventLoggerService:i,applicationModulesAccess:s}=e;try{return await(0,n.disableCredentialProtection)({storeService:r,sessionService:a,eventLoggerService:i,applicationModulesAccess:s},t),{status:o.DisableCredentialProtectionStatus.SUCCESS}}catch(e){return{status:o.DisableCredentialProtectionStatus.ERROR}}}},18344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.disableCredentialProtection=void 0;const o=r(19736),n=r(88779),a=({update:{autoprotected:e}})=>({AutoProtected:e});t.disableCredentialProtection=async function({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:i},s){const c=e.getState();if(!(0,o.credentialSelector)(c,s))throw new Error("Credential does not exist, cant update");(0,n.updateCredential)({storeService:e,sessionService:t,eventLoggerService:r,applicationModulesAccess:i},{id:s,update:{autoprotected:!1}},a)}},88530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(64710);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},64331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultLockDate$=void 0;const o=r(18948),n=r(81846),a=r(3343);t.vaultLockDate$=()=>(0,o.pipe)((0,a.map)(n.vaultLockDateSelector))},81846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultLockDateSelector=t.gracePeriodSelector=void 0;const o=r(38981),n=r(16593);t.gracePeriodSelector=e=>/^kw_test_auto_fmpc_.*/.test((0,n.userLoginSelector)(e))?5e3:3e5;t.vaultLockDateSelector=e=>(0,o.isSSOUserSelector)(e)?null:(0,n.lastMasterPasswordCheckSelector)(e)+(0,t.gracePeriodSelector)(e)},20054:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(85423),n=r(97810),a=r(43591),i=r(16593),s=r(18191);t.config={commands:{activateAccountRecovery:{handler:n.activateAccountRecovery},setupMasterPasswordForRecovery:{handler:a.setupMasterPasswordForRecovery},deactivateAccountRecovery:{handler:n.deactivateAccountRecovery},registerDeviceForRecovery:{handler:a.registerDeviceForRecovery},startAccountRecovery:{handler:a.startAccountRecovery},sendRecoveryRequest:{handler:a.sendRecoveryRequest},cancelRecoveryRequest:{handler:a.cancelRecoveryRequest},checkRecoveryRequestStatus:{handler:a.checkRecoveryRequestStatus},recoverUserData:{handler:a.recoverUserData},checkDoesLocalRecoveryKeyExist:{handler:a.checkDoesLocalRecoveryKeyExist},isRecoveryRequestPending:{handler:n.isRecoveryRequestPending}},queries:{getRecoveryOptInSetting:{selector:i.accountRecoveryOptInSelector},getAccountRecoveryRequestCount:{selector:o.accountRecoveryRequestsCountSelector}},liveQueries:{liveAccountRecoveryRequestCount:{operator:s.accountRecoveryRequestsCount$}}}},15444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeRecoveryController=void 0;const o=r(36513),n=r(95623),a=r(70252),i=r(34376),s=r(43927);function c(e,t,r){return(0,a.sendExceptionLog)({error:t}),n.Debugger.log(e,t),{error:{message:t.message,action:r}}}t.makeRecoveryController=(e,t)=>({getMasterPasswordResetDemandList:r=>function(e,t,r,o){const n=o.teamId;return t.recovery.getPendingRequests({login:r.login,uki:r.uki,teamId:n}).then((t=>{const o=e.getTeamAdminData(),a=Object.assign({},o),i=t.filter((e=>e.login!==r.login));return a.teams[n]&&(a.teams[n].notifications={accountRecoveryRequests:i},(0,s.updateTeamAdminData)(e,a)),{demands:i}})).catch((e=>({demands:[],error:c("Master Password Reset: Error while getPendingRequests",e,o).error})))}(e,t,(0,i.getCurrentUserInfo)(e),r),acceptMasterPasswordResetDemand:r=>function(e,t,r){const n=(0,o.makeAsymmetricEncryption)();return n.decrypt(t.privateKey,r.recoveryKey).then((e=>n.encrypt(r.userPublicKey,e))).then((o=>e.recovery.acceptRequest({login:t.login,uki:t.uki,sourceLogin:r.login,payload:o}))).then((()=>({}))).catch((e=>c("Master Password Reset: Error while acceptRequest",e,r)))}(t,(0,i.getCurrentUserInfo)(e),r),declineMasterPasswordResetDemand:r=>function(e,t,r){return e.recovery.refuseRequest({login:t.login,uki:t.uki,sourceLogin:r.login}).then((()=>({}))).catch((e=>c("Master Password Reset: Error while refuseRequest",e,r)))}(t,(0,i.getCurrentUserInfo)(e),r)})},63395:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(20054);t.bootstrap=e=>{e.register(o.config)}},76569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(63395);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},18191:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountRecoveryRequestsCount$=void 0;const o=r(18948),n=r(3343),a=r(85423);t.accountRecoveryRequestsCount$=function(){return(0,o.pipe)((0,n.map)((e=>(0,a.accountRecoveryRequestsCountSelector)(e))),(0,n.distinctUntilChanged)())}},85423:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountRecoveryRequestsCountSelector=t.selectTeamAdminData=t.recoveryHashFromPremiumStatusSelector=t.recoveryHashFromPersonalSettingsSelector=t.shouldShowFeatureActivationModalSelector=void 0;const o=r(26634),n=r(38981),a=r(16593),i=r(27885),s=r(32034);t.shouldShowFeatureActivationModalSelector=(0,s.createSelector)([n.isSSOUserSelector,o.isRecoveryEnabledSelector,e=>"boolean"==typeof e.userSession.personalSettings.RecoveryOptIn,e=>e.userSession.session.isFirstSessionAfterAccountCreation],((e,t,r,o)=>!e&&t&&!r&&!o));t.recoveryHashFromPersonalSettingsSelector=e=>(0,a.personalSettingsSelector)(e).RecoveryHash||"";t.recoveryHashFromPremiumStatusSelector=e=>(0,a.premiumStatusSelector)(e).recoveryHash||"";t.selectTeamAdminData=e=>e.userSession.teamAdminData??{teams:{}};t.accountRecoveryRequestsCountSelector=e=>{const r=(0,i.getCurrentTeamId)(e.userSession.spaceData);if(!r)return 0;const{teams:o}=(0,t.selectTeamAdminData)(e);return Number(o[r]?.notifications?.accountRecoveryRequests?.length??0)}},43591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.recoverUserData=t.checkDoesLocalRecoveryKeyExist=t.cancelRecoveryRequest=t.checkRecoveryRequestStatus=t.sendRecoveryRequest=t.setupMasterPasswordForRecovery=t.registerDeviceForRecovery=t.startAccountRecovery=void 0;const o=r(45127),n=r(70252),a=r(70414),i=r(25576),s=r(87855),c=r(36513),d=r(46298),l=r(29303),u=r(16593),p=r(16356),S=r(28096),m=r(95363),g=r(88610),y=r(47820);function A(e){return"u2f"===e.type?{type:"u2f",challenges:e.challenges??[]}:e}t.startAccountRecovery=async function(e,t){const{storeService:r}=e,{login:n}=t,a=await(0,d.getAuthenticationMethodsForDevice)(r,{login:n,methods:i.remoteSupportedAuthenticationMethod});if((0,d.isApiError)(a))return{success:!1,error:{code:o.RecoveryApiErrorType.StartAccountRecoveryFailed,message:`Start account recovery failed: ${a.message}`}};const s=a.verifications.map(A);return r.dispatch((0,m.saveRecoverySessionData)({verificationMethod:s})),{success:!0,verification:s}},t.registerDeviceForRecovery=async function(e,t){try{const{token:r,login:n}=t,{storeService:c,wsService:u}=e,p=c.getState(),S=c.getPlatformInfo().platformName,g=!0,y=await(0,d.getAuthenticationMethodsForDevice)(c,{login:n,methods:i.remoteSupportedAuthenticationMethod});if((0,d.isApiError)(y))return{success:!1,error:{code:o.RecoveryApiErrorType.RegisterDeviceFailed,message:"Recovery Device request registration failed"}};const A=(0,l.recoveryIsOtpSelector)(p),f=await(0,s.ensureDeviceId)(),E=(0,a.generateUki)(f),h={uki:E,login:n,platform:S,temporary:i.PersistData.PERSIST_DATA_NO,recovery:g},v=A?{otp:r}:{token:r};if("SUCCESS"!==await u.authentication.registerUki({...h,...v}))return{success:!1,error:{code:o.RecoveryApiErrorType.RegisterDeviceFailed,message:"Recovery Device registration failed"}};c.dispatch((0,m.saveRecoverySessionData)({recoveryUki:E}))}catch(e){return(0,n.sendExceptionLog)({error:e}),{success:!1,error:{code:o.RecoveryApiErrorType.RegisterDeviceFailed,message:e.message}}}return{success:!0}},t.setupMasterPasswordForRecovery=async function(e,t){let r="[Account Recovery PI] - Setup Master Password For Recovery ";const a=e=>{r+=`- ${e} \n`};try{const{storeService:i,localStorageService:s}=e,{masterPassword:d}=t,u=i.getState();a("recoveryUki select START");const S=(0,l.recoveryUkiSelector)(u);if(!S){const e={code:o.RecoveryApiErrorType.SetupMasterPasswordForRecoveryFailed,message:"recoveryUki does not exist"};return a(`setupMasterPasswordForRecovery failed with error: ${e.code} ${e.message}`),(0,n.sendExceptionLog)({message:r,funcName:"setupMasterPasswordForRecovery"}),{success:!1,error:e}}a("recoveryUki select SUCCESS"),a("dispatch updateMasterPassword START"),i.dispatch((0,p.updateMasterPassword)(d)),a("dispatch updateMasterPassword SUCCESS"),a("makeCyptoService START");const g=(0,c.makeCryptoService)();a("makeCyptoService SUCCESS"),a("generateRsaKeyPair START");const{publicKey:A,privateKey:f}=await g.asymmetricEncryption.generateRsaKeyPair();a("generateRsaKeyPair SUCCESS"),a("dispatch saveRecoverySessionData START"),i.dispatch((0,m.saveRecoverySessionData)({publicKey:A})),a("dispatch saveRecoverySessionData SUCCESS"),a("encryptUkiAndPrivateKey START");const E=await(0,y.encryptUkiAndPrivateKey)(S,f,d,i);return a("encryptUkiAndPrivateKey SUCCESS"),a("storeRecoveryData START"),await s.getInstance().storeRecoveryData(E),a("storeRecoveryData SUCCESS"),{success:!0}}catch(e){return a(`setupMasterPasswordForRecovery failed with error: ${e}`),(0,n.sendExceptionLog)({message:r,funcName:"setupMasterPasswordForRecovery",precisions:e.stack}),{success:!1,error:{code:o.RecoveryApiErrorType.SetupMasterPasswordForRecoveryFailed,message:e.message}}}},t.sendRecoveryRequest=async function(e){try{const{storeService:t,wsService:r}=e;return await(0,y.sendRecoveryRequestToAdmin)(t,r),{success:!0}}catch(e){return(0,n.sendExceptionLog)({error:e}),{success:!1,error:{code:o.RecoveryApiErrorType.RecoveryRequestFailed,message:e.message}}}},t.checkRecoveryRequestStatus=async function(e,t){try{const{storeService:r,localStorageService:n,wsService:a}=e,{masterPassword:i}=t,s=r.getState(),c=(0,u.userLoginSelector)(s);if(!c)return{success:!1,error:{code:o.RecoveryApiErrorType.CheckRecoveryStatusFailed,message:"Missing login"}};r.dispatch((0,p.updateMasterPassword)(i));const d=await(0,y.retrieveRecoveryUkiFromStorage)(r,n,i),{content:{status:l,payload:S,recoveryServerKey:g}}=await a.recovery.request({login:c,uki:d});return S&&g&&r.dispatch((0,m.saveRecoverySessionData)({userServerProtectedSymmetricalKey:S,recoveryServerKeyBase64:g})),{success:!0,response:{status:l}}}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.CheckRecoveryStatusFailed,message:e.message}}}},t.cancelRecoveryRequest=async function(e){try{const{storeService:t,localStorageService:r,wsService:o}=e,n=t.getState(),a=(0,u.userLoginSelector)(n),i=(0,u.masterPasswordSelector)(n),s=await(0,y.retrieveRecoveryUkiFromStorage)(t,r,i);return await o.recovery.cancelRequest({login:a,uki:s}),await r.getInstance().cleanRecoveryData(),{success:!0}}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.CancelRecoveryRequestFailed,message:e.message}}}},t.checkDoesLocalRecoveryKeyExist=async function(e){try{const{localStorageService:t}=e,r=t.getInstance();return{success:!0,doesExist:await r.doesRecoveryLocalKeyExist()}}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.CheckLocalRecoveryKeyFailed,message:e.message}}}},t.recoverUserData=async function(e,t){const{localStorageService:r,storeService:a,sessionService:s}=e,d=a.getState(),p=r.getInstance(),A=await(0,y.validateInitialData)(d,p);let f="[Account Recovery PI] - Recover User Data ";const E=e=>{f+=`- ${e} \n`};if(!A.success)return A;const{masterPassword:h}=t;try{E("Extract PrKey START");const t=await(0,y.extractPrivateKeyFromRecoveryData)(e,h,E);E("Extract PrKey SUCCESS");const{userServerProtectedSymmetricalKey:r}=(0,l.recoveryDataSelector)(d),s=await(0,c.makeAsymmetricEncryption)();E("Decrypt user protected key START");const S=await s.decrypt(t,r);E("Decrypt user protected key SUCCESS"),E("Decrypt server protected key START");const A=await(0,y.extractRecoveryKey)(a,S,E);E("Decrypt server protected key SUCCESS"),E("Extract local Key START");const v=await(0,y.extractLocalKey)(e,A,E);E("Extract local Key SUCCESS"),await(0,y.prepareLocalDataEncryptorService)(e,v),E("Get recovery credentials START");const T=await p.getRecoverySessionCredential();E("Get recovery credentials SUCCESS");const{masterPassword:_}=JSON.parse(atob(T)),I=(0,u.userLoginSelector)(d),C=i.PersistData.PERSIST_DATA_YES;a.dispatch((0,m.saveRecoverySessionData)({recoveryInProgress:!0})),E("Open session START");const P=await(0,g.openSessionWithMasterPassword)(e,I,_,{isDataPersisted:C,serverKey:(0,u.serverKeySelector)(d)},E);if(E("Open session SUCCESS"),P!==o.LoginResultEnum.LoggedIn)return E("Open session SUCCESS but user not logged in"),(0,n.sendExceptionLog)({message:f,funcName:"recoverUserData"}),(0,y.recoveryFlowError)(o.RecoveryApiErrorType.RecoverUserDataFailed,`Unable to login with ${P}`);a.dispatch((0,m.saveRecoverySessionData)({recoveryInProgress:!1,currentPassword:_}))}catch(e){return E(`Recovery failed with error: ${e}`),(0,n.sendExceptionLog)({message:f,funcName:"recoverUserData",precisions:e.stack}),a.dispatch((0,m.resetRecoverySessionData)()),await s.close(!1),(0,S.triggerOpenSessionFailed)(new Error(S.AuthenticationCode[S.AuthenticationCode.WRONG_PASSWORD])),(0,y.recoveryFlowError)(o.RecoveryApiErrorType.RecoverUserDataFailed,"Unable to decipher data")}return{success:!0}}},47820:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storeSessionCredentialForRecovery=t.prepareLocalDataEncryptorService=t.extractLocalKey=t.extractRecoveryKey=t.extractPrivateKeyFromRecoveryData=t.validateInitialData=t.recoveryFlowError=t.retrieveRecoveryUkiFromStorage=t.triggerCleanOrSetupAccountRecovery=t.isARFeatureActivatedForUser=t.isARAvailableForUser=t.sendRecoveryRequestToAdmin=t.encryptUkiAndPrivateKey=t.resetAdminProtectedSymmetricalKeys=t.sendAdminProtectedSymmetricalKeys=t.getAdminProtectedSymmetricalKeys=t.encryptRecoveryData=t.getRecoveryKey=t.getSetupRequisitesData=void 0;const o=r(45127),n=r(90622),a=r(56668),i=r(72365),s=r(16038),c=r(69530),d=r(64910),l=r(36513),u=r(65675),p=r(70252),S=r(16593),m=r(38981),g=r(95363),y=r(16356),A=r(29303),f=r(25576),E=r(26634),h=r(97810),v=r(85423);function T(e){const t=e.getState(),r=(0,S.activeSpacesSelector)(t)[0],o=r?.teamId;if(!o)throw new Error("[getSetupRequisitesData] - user should be part of a team to activate Account Recovery");const a=Number(o),i=(0,S.userLoginSelector)(t),s=(0,n.ukiSelector)(t);if(!i||!s)throw new Error("[getSetupRequisitesData] - missing login or uki");return{teamId:a,login:i,uki:s}}async function _({storeService:e,encryptionKey:t,data:r}){const o=(0,i.makeDataEncryptorService)(e),n=(0,u.getCryptoConfig)(e);o.setInstance({raw:t},"",n);const a=await o.getInstance().encrypt(r);return o.close(),a}async function I({storeService:e,encryptedData:t,encryptionKey:r}){const o=(0,i.makeDataEncryptorService)(e),{cryptoConfig:n}=(0,u.parsePayload)(u.ARGON2_DEFAULT_PAYLOAD);o.setInstance({raw:r},"",n);const a=await o.getInstance().decrypt(t,{logging:!0});return o.close(),a}function C(e){const t=(0,m.isSSOUserSelector)(e),r=(0,E.isRecoveryEnabledSelector)(e);return!t&&r}function P(e){const t=C(e),r=(0,S.accountRecoveryOptInSelector)(e);return t&&r}t.getSetupRequisitesData=async function(e,t){try{const{teamId:r,login:o,uki:n}=T(e),{content:a}=await t.recovery.getSetupRequisites({login:o,uki:n,teamId:r});return a}catch(e){throw new Error(`[getSetupRequisitesData] - getSetupRequisites failed with error ${e}`)}},t.getRecoveryKey=async function(e){const t=e.getState();let r,o=(0,S.recoveryKeySelector)(t);return o?r=(0,s.base64ToBuffer)(o):(r=await(0,c.generateAESKey)(),o=(0,s.bufferToBase64)(r)),{recoveryKeyBufferClear:r,recoveryKeyBase64Clear:o,recoveryKeyRawClear:atob(o)}},t.encryptRecoveryData=_,t.getAdminProtectedSymmetricalKeys=async function(e,t){const r=(0,l.makeAsymmetricEncryption)(),o=[];for(const n of e){const{login:e,publicKey:a}=n,i=await r.encrypt(a,t);o.push({login:e,key:i})}return o},t.sendAdminProtectedSymmetricalKeys=async function(e,t,r){try{const o=JSON.stringify(r),{teamId:n,login:a,uki:i}=T(e);return void await t.recovery.setRecoveryClientKeys({login:a,uki:i,recoveryClientKeys:o,teamId:n})}catch(e){throw new Error(`[sendAdminProtectedSymmetricalKeys] - setRecoveryClientKeys failed with error ${e}`)}},t.resetAdminProtectedSymmetricalKeys=async function(e,t){try{const{teamId:r,login:o,uki:n}=T(e),a=JSON.stringify([]);return void await t.recovery.setRecoveryClientKeys({login:o,uki:n,recoveryClientKeys:a,teamId:r})}catch(e){throw new Error(`[resetAdminProtectedSymmetricalKeys] - setRecoveryClientKeys failed with error ${e}`)}},t.encryptUkiAndPrivateKey=async function(e,t,r,o){const n=JSON.stringify({recoveryUki:e,privateKey:t}),i=(0,a.deflateUtf16)(n);return await _({storeService:o,encryptionKey:r,data:i})},t.sendRecoveryRequestToAdmin=async function(e,t){try{const r=e.getState(),o=(0,S.userLoginSelector)(r),{recoveryUki:n,publicKey:a}=(0,A.recoveryDataSelector)(r);if(!o||!n||!a)throw new Error("Missing recoveryUki or publicKey");return void await t.recovery.request({login:o,uki:n,publicKey:a})}catch(e){throw new Error(`[sendAccountRecoveryRequest] - failed with error ${e}`)}},t.isARAvailableForUser=C,t.isARFeatureActivatedForUser=P,t.triggerCleanOrSetupAccountRecovery=async function(e){const{storeService:t,localStorageService:r,wsService:o}=e,n=t.getState();if((0,A.recoveryInProgressSelector)(n))return;await r.getInstance().cleanRecoveryData();if(await async function(e,t){const r=e.getState();if(!P(r))return Promise.resolve(!1);const{persistData:o}=e.getAccountInfo();if(o===f.PersistData.PERSIST_DATA_NO)return Promise.resolve(!1);const n=!!(0,S.recoveryKeySelector)(r),a=!!await t.getInstance().doesRecoveryLocalKeyExist();if(n&&a)return(0,v.recoveryHashFromPersonalSettingsSelector)(r)!==(0,v.recoveryHashFromPremiumStatusSelector)(r);return!0}(t,r))return void await(0,h.setupAccountRecoveryForDevice)(t,r,o);await async function(e,t){const r=P(e.getState()),o=t.getInstance(),n=!!await o.doesRecoveryLocalKeyExist(),a=!!await o.doesRecoverySessionCredentialExist();return!r&&(n||a)}(t,r)&&await r.getInstance().cleanRecoverySetupData()},t.retrieveRecoveryUkiFromStorage=async function(e,t,r){try{const o=await t.getInstance().getRecoveryData(),n=await I({storeService:e,encryptedData:o,encryptionKey:r}),i=(0,a.inflateUtf16)(n),{recoveryUki:s}=JSON.parse(i);return s}catch(e){const t=`retrieveRecoveryUkiFromStorage failed with error ${e.message}`;throw new Error(t)}};t.recoveryFlowError=(e,t)=>{const r=new Error(`[AccountRecovery]: ${e} ${t}`);return(0,p.sendExceptionLog)({error:r}),{success:!1,error:{code:e,message:t}}},t.validateInitialData=async function(e,r){if(!await r.doesRecoveryLocalKeyExist()||!await r.doesRecoveryDataExist()||!await r.doesRecoverySessionCredentialExist())return(0,t.recoveryFlowError)(o.RecoveryApiErrorType.RecoverUserDataFailed,"Missing local data");const{userServerProtectedSymmetricalKey:n,recoveryServerKeyBase64:a}=(0,A.recoveryDataSelector)(e);return n&&a?{success:!0}:(0,t.recoveryFlowError)(o.RecoveryApiErrorType.RecoveryRequestFailed,"missing payload")},t.extractPrivateKeyFromRecoveryData=async function(e,t,r){const{localStorageService:o,storeService:n}=e,i=o.getInstance();r("extractPrivateKeyFromRecoveryData - getRecoveryData");const c=await i.getRecoveryData(),d=n.getPlatformInfo();r(`[extra] platform: ${d.platformName}`),r(`[extra] browser: ${d.browser} @ ${d.browserVersion}`);const l=(0,s.base64ToBuffer)(c),p=(0,u.parseCipheredData)(new Uint8Array(l));r(`[extra] cryptoConfig derivation: ${JSON.stringify(p.cryptoConfig)}`),r("extractPrivateKeyFromRecoveryData - decryptRecoveryData");const S=await I({storeService:n,encryptedData:c,encryptionKey:t});r("extractPrivateKeyFromRecoveryData - inflateUtf16 data");const m=(0,a.inflateUtf16)(S);r("extractPrivateKeyFromRecoveryData - parse JSON data");const{recoveryUki:y,privateKey:A}=JSON.parse(m);return n.dispatch((0,g.saveRecoverySessionData)({recoveryUki:y})),A},t.extractRecoveryKey=async function(e,t,r){const o=e.getState(),{recoveryServerKeyBase64:n}=(0,A.recoveryDataSelector)(o);if(!n)throw new Error("Missing payload");const a=atob(n),i=e.getPlatformInfo();r(`[extra] platform: ${i.platformName}`),r(`[extra] browser: ${i.browser} @ ${i.browserVersion}`);const c=(0,s.base64ToBuffer)(t),d=(0,u.parseCipheredData)(new Uint8Array(c));r(`[extra] cryptoConfig derivation: ${JSON.stringify(d.cryptoConfig)}`),r("extractRecoveryKey - decryptRecoveryData");const l=await I({storeService:e,encryptedData:t,encryptionKey:a});return r("extractRecoveryKey - arrayBufferToText"),(0,s.arrayBufferToText)(l)},t.extractLocalKey=async function(e,t,r){const{storeService:o,localStorageService:n}=e,i=n.getInstance();r("extractLocalKey - getRecoveryLocalKey");const c=await i.getRecoveryLocalKey(),d=e.storeService.getPlatformInfo();r(`[extra] platform: ${d.platformName}`),r(`[extra] browser: ${d.browser} @ ${d.browserVersion}`);const l=(0,s.base64ToBuffer)(c),p=(0,u.parseCipheredData)(new Uint8Array(l));r(`[extra] cryptoConfig derivation: ${JSON.stringify(p.cryptoConfig)}`),r("extractLocalKey - decryptRecoveryData");const S=await I({storeService:o,encryptedData:c,encryptionKey:t});return r("extractLocalKey - inflateUtf16 localKey"),(0,a.inflateUtf16)(S)},t.prepareLocalDataEncryptorService=async function(e,t){const{localDataEncryptorService:r,storeService:o}=e,n=e.storeService.getUserSession().serverKey,a=(0,d.getNoDerivationCryptoConfig)();r.setInstance({raw:t},n,a),await r.getInstance().prepareCrypto(),o.dispatch((0,y.updateLocalKey)(t))},t.storeSessionCredentialForRecovery=async function(e,t){const r=e.getState(),o=(0,S.masterPasswordSelector)(r);if(P(r)&&o){const e={masterPassword:o,recoveryKey:null},r=btoa(JSON.stringify(e));await t.getInstance().storeRecoverySessionCredential(r)}}},97810:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isRecoveryRequestPending=t.deactivateAccountRecovery=t.setupAccountRecoveryForDevice=t.activateAccountRecovery=void 0;const o=r(45127),n=r(56668),a=r(47820),i=r(5464),s=r(16593),c=r(27517);async function d(e,t,r){const{hash:o,recipients:i,recoveryServerKey:s}=await(0,a.getSetupRequisitesData)(e,r),{recoveryKeyBufferClear:d,recoveryKeyBase64Clear:l,recoveryKeyRawClear:u}=await(0,a.getRecoveryKey)(e),p=t.getInstance(),S=await p.getLocalKey(),m=(0,n.deflateUtf16)(S),g=await(0,a.encryptRecoveryData)({storeService:e,encryptionKey:u,data:m});t.getInstance().storeRecoveryLocalKey(g);const y=atob(s),A=await(0,a.encryptRecoveryData)({storeService:e,encryptionKey:y,data:d}),f=await(0,a.getAdminProtectedSymmetricalKeys)(i,A);await(0,a.sendAdminProtectedSymmetricalKeys)(e,r,f);const E={RecoveryHash:o,RecoveryKey:l};e.dispatch((0,c.editPersonalSettings)(E)),await(0,a.storeSessionCredentialForRecovery)(e,t)}t.activateAccountRecovery=async function(e){const{sessionService:t,storeService:r,localStorageService:n,wsService:l}=e,u=r.getState();if(!(0,a.isARAvailableForUser)(u))return{success:!1,error:{code:o.RecoveryApiErrorType.AccountRecoveryNotAvailableError}};(0,s.accountRecoveryOptInSelector)(u)||r.dispatch((0,c.editPersonalSettings)({RecoveryOptIn:!0}));try{await d(r,n,l),await t.getInstance().user.persistPersonalSettings(),await(0,i.sessionForceSync)(t)}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.RecoverySetupFailed,message:e.message}}}return{success:!0}},t.setupAccountRecoveryForDevice=d,t.deactivateAccountRecovery=async function(e){const{sessionService:t,storeService:r,localStorageService:n,wsService:i}=e,s=r.getState();if(!(0,a.isARAvailableForUser)(s))return{success:!1,error:{code:o.RecoveryApiErrorType.AccountRecoveryNotAvailableError}};const d={RecoveryKey:"",RecoveryHash:"",RecoveryOptIn:!1};try{r.dispatch((0,c.editPersonalSettings)(d)),await t.getInstance().user.persistPersonalSettings(),await n.getInstance().cleanRecoverySetupData(),await(0,a.resetAdminProtectedSymmetricalKeys)(r,i)}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.RecoveryDeactivationFailed,message:e.message}}}return{success:!0}},t.isRecoveryRequestPending=async function(e){try{return{success:!0,response:await e.localStorageService.getInstance().doesRecoveryDataExist()}}catch(e){return{success:!1,error:{code:o.RecoveryApiErrorType.IsRecoveryRequestPendingFailed,message:e}}}}},63678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(47820);t.setupSubscriptions=function(e,t){e.carbonSessionOpened.on((()=>(0,o.triggerCleanOrSetupAccountRecovery)(t))),e.syncSuccess.on((()=>(0,o.triggerCleanOrSetupAccountRecovery)(t)))}},47390:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(66961),n=r(89122),a=r(96405);t.config={commands:{decipherRemoteFile:{handler:o.decipherRemoteFileHandler}},queries:{getFileContent:{selector:a.fileContentStrSelector}},liveQueries:{liveFileMeta:{operator:n.fileMetaUpdate$}}}},64438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(47390);t.bootstrap=e=>{e.register(o.config)}},1110:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_SETTINGS=t.REMOTE_FILE_KEY_PROD=t.REMOTE_FILE_KEY_DEV=void 0,t.REMOTE_FILE_KEY_DEV="-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAzOFwZBlj8livLhzIN8xm\ny/c+gn9FpUNOEIPoiN7kcAlj+oIlWqW5TgRZLqvyA0WxhTcG7icTpC+UwBXvENdV\n3nTzmuB8W6ZnRTjrtAlSxqp0Yfr2eQEGZFTlfBFUneqq4RZ6e/B3nIRHG1sEkVhd\noBbenPWou+WHqaqnah0AZVfxx4bJq1wor1LpH7gxELthvsThBelQz4Lmns4hCjzq\nRCDjQ1PG9HpDwwRHyi9xJYWoLR6C3rHZ1mmldg7TS41cCWkKsPDiIrIzEN+94dGG\nqSAx4kti0ltRcjLcBuJhQ3FHaAU7ksSubEg+l0W8PWAKjNbhUpFXduqXjxZ9nhuS\n2sxETZoadgU6YDEyqk3W7c+dhpTioMZEsJXpBVdC2jbblPHBRXBTmdOdb7xlBrGQ\nzoyPpS0PcI9oa8o9na9J8DSqnEbLwXdOlv4TUoxrswD6nmnR31/W+C4PSC8yEUEx\nESiG6IfAakFICxVESBp1VZA7NUbT6JkrhQaz//AVuGAyMoDuXorRGQPit+9DgF2l\neSr0zLzO2MVfMXXKBnueZmjNLvYy2Q2e8QX1jsuvwFhDBt1QmfisdiGSPC7jp0rO\nXdu5eCQuHVYeApipVKry58So783jimUa+mpA0/NUyiYaON7zndtZlQv/y+dqvseT\na2iA73nMVy4y9F95mwdG8ykCAwEAAQ==\n-----END PUBLIC KEY-----",t.REMOTE_FILE_KEY_PROD="-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAvlEdqD2jCU30/OembiWY\nJKxrjiZuRgweXtV2e7yF1T5XyHkqDZ31a9W0rLWrVRbjr1qDdwU94L1iW/8RrUPK\n2ue+2XH/8e8EH44Y9HYBeIUTciBKU6dqyqflaxY/wm3VO5af303ba564BVzv/31S\nJiHa7QkeVqjY/Za1rv1ZOIwsYBC/SPIK+ofU7qSi6eY8PNe8bje0CFPcwfWRRkNB\nZLQwUwIED1w7playTR8boX5iju+TagAjKSphkj6u+fIkYPdFQgFjSTGu8OwTAerC\nxqAWDSVy7fMxLdrDNrdwMTuQvlUIWiK+1CRHm1r6AXGywqCmrndw6q1LvFcwOgI1\n2brPOx1BdDabUwau26lICDgPqA67Sk7GLTCv3hA2bHvJhK7E0c260u96hRwjDk/L\n8tspQAYGzosyIMTmN29fEtBMlPwClZPqSVa7I7b3Csx4lhRkXI76WxAOmxf5dNQI\n2O6dlrxumdfpM8O6ye3iq51D7ZNNegelee/BIrZEcJZzymvkrDDZHJs6oFQ7bERd\np+nJlr4xoiFd9BPCus6z994/8j7lNTvLanNwsdUYRP/tQJZqlhZ7vY+KpyXn+RGw\nMYFeWXuH3cG05NwryH6676tcOrkboxbxMCMBUMvZK1CWS57noH/iztYivKNyItxf\ni8uoqgc+vDOPPsdujlsgOkcCAwEAAQ==\n-----END PUBLIC KEY-----",t.FILE_SETTINGS={"phishing_urls_test.json":{isLoadedWhileLoggedOut:!0}}},66961:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherRemoteFileHandler=void 0;const o=r(10174),n=r(16593);t.decipherRemoteFileHandler=async({storeService:e},t)=>({decipheredFile:await(0,o.decipherRemoteFileUpdate)(t.cipheredFileContent,t.fileMetaData,(0,n.sharingKeysSelector)(e.getState()).privateKey)})},97890:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downloadRemoteFileHandler=t.fetchFile=void 0;const o=r(45127),n=r(46298),a=r(64272),i=r(10174),s=r(85845),c=r(87993),d=r(19601),l=r(16593),u=r(55539),p=r(23201),S=r(48062),m=r(76905);async function g(e){try{return(await(0,u.httpGetUsingFetch)(e,{responseType:"arraybuffer"})).data}catch(e){throw new d.RemoteFileError(S.RemoteFileUpdateError.DownloadError,e.message)}}async function y(e,t){const r=await(0,a.getFilesMeta)(e,(0,l.userLoginSelector)(e.getState()),t);if((0,n.isApiError)(r))throw new d.RemoteFileError(S.RemoteFileUpdateError.ServerError,r.message);if((0,a.isGetFilesMetaSuccess)(r)){const{fileInfos:e}=r;if(!function(e){for(const t of o.FileNamesList)if(!(t in e))return!1;return!0}(e))throw new Error("Missing keys in the GetFileMeta response");return e}}function A(e,t,r){const{storeService:o,eventBusService:n}=e;o.dispatch((0,s.updateFileContentAction)({[r.name]:r})),o.dispatch((0,s.updateFileMetaAction)({[r.name]:t})),n.remoteFileChanged(r.name)}async function f(e,[t,r]){const{storeService:n,eventLoggerService:a}=e;if(!function(e){switch(e.status){case o.UPDATE_AVAILABLE_HTTP_STATUS:return!0;case o.NO_CURRENT_UPDATE_HTTP_STATUS:case o.FILE_NOT_FOUND_HTTP_STATUS:case o.SERVER_ERROR_HTTP_STATUS:default:return!1}}(r))return{fileName:t,isUpdated:!1,fileMetaData:r};try{const o=await async function(e,t,r){const o=await g(t.url);if(!t.key)return new m.DownloadedFile(e,o);const n=await(0,i.decipherRemoteFileUpdate)(o,t,(0,l.sharingKeysSelector)(r.getState()).privateKey);return new m.DownloadedFile(e,n)}(t,r,n);A(e,r.revision,o)}catch(e){return(0,d.assertRemoteFileError)(a,e),{fileName:t,isUpdated:!1,fileMetaData:r}}return{fileName:t,isUpdated:!0,fileMetaData:r}}t.fetchFile=g;t.downloadRemoteFileHandler=async(e,t)=>{const{storeService:r}=e,o=await async function(e,t){const r=await(0,c.retrieveFileMetaDataFromCipheredLocalStorage)(e);return Object.entries(t).reduce(((e,[t,o])=>(null!==r&&t in r.files?e.files[t]=o.revision??r.files[t]:e.files[t]=0,e)),{files:{}})}(e,t);try{const t=await y(r,o);if(t&&0!==Object.keys(t).length){const i=await(n=t,a=e,Promise.all(Object.entries(n).map((e=>f(a,e))))),l=await async function(e,t){const{eventLoggerService:r}=e;return await Promise.all(t.filter((({isUpdated:e})=>e)).map((async({fileName:t})=>{try{return await(0,c.writeFileInLocalStorage)(e,t),(0,p.logReceiveRemoteFileSuccess)(r),[t,!0]}catch(e){return(0,d.assertRemoteFileError)(r,e),[t,!1]}})))}(e,i),u=l.filter((([e,t])=>!t)).map((([e,t])=>e));r.dispatch((0,s.deleteFileMetaAction)(u)),await function(e,t,r){const o=e.localStorageService.getInstance();return Promise.all(t.filter((({isUpdated:e})=>!e)).map((async({fileName:t})=>{if(!o.isRemoteFileContentExist(t))return;const n=await(0,c.readFileFromLocalStorage)(e,t);null!==n&&A(e,r[t],n)})))}(e,i,o.files),await(0,c.persistFileMetaInCipheredLocalStorage)(e)}}catch(t){(0,d.assertRemoteFileError)(e.eventLoggerService,t)}var n,a}},16179:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadFilesAtInit=t.loadFileContentAtInit=void 0;const o=r(1110),n=r(87993),a=r(19601),i=r(85845);async function s(e,t){const r=await(0,n.readFileFromLocalStorage)(e,t);return null!==r&&(e.storeService.dispatch((0,i.updateFileContentAction)({[t]:r})),!0)}t.loadFileContentAtInit=s,t.loadFilesAtInit=function(e){Object.keys(o.FILE_SETTINGS).forEach((async t=>{if(o.FILE_SETTINGS[t].isLoadedWhileLoggedOut)try{await s(e,t)&&e.eventBusService.remoteFileChanged(t)}catch(t){(0,a.assertRemoteFileError)(e.eventLoggerService,t)}}))}},76905:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadedFile=void 0;const o=r(16038);class n{constructor(e,t){this._buf=t,this.name=e}static fromBase64Str(e,t){return new n(e,(0,o.base64ToBuffer)(t))}toBlob(){return new Blob([this._buf])}toString(){return(0,o.ab2str)(this._buf)}toBase64String(){return(0,o.bufferToBase64)(this._buf)}}t.DownloadedFile=n},10174:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decipherRemoteFileUpdate=t.decipherFileIntoBlob=t.verifyRemoteFileSignature=t.decipherDecryptionKey=t.computePublicKeyForSignature=void 0;const o=r(56668),n=r(83570),a=r(16038),i=r(56984),s=r(36513),c=r(1110),d=r(19601),l=r(48062),u=r(93513),p="https://static.dashlane.com/runtime-resources/ci/";async function S(e,t){const r=(0,s.makeAsymmetricEncryption)({hashAlgorithm:i.HashAlgorithm.SHA_1});try{return u.decode(await r.decrypt(t,e))}catch(e){throw new d.RemoteFileError(l.RemoteFileUpdateError.DecipherError,"Invalid encryption on deciphering key")}}async function m(e,{signature:r,url:o},n){const a=(0,t.computePublicKeyForSignature)(o);return await e.verify(a,r,n)}async function g(e,t){try{return(0,a.str2ab)((0,o.deflatedUtf8ToUtf16)(await(0,o.decipherDashlaneSecureData)(e,t,"",(0,n.makeGetDerivateKeyWithCacheAndQueue)()),{skipInflate:!0}))}catch(e){throw new d.RemoteFileError(l.RemoteFileUpdateError.DecipherError,"Invalid encryption on file")}}t.computePublicKeyForSignature=e=>{if((e=>e.startsWith(p+"prod/"))(e))return c.REMOTE_FILE_KEY_PROD;if((e=>e.startsWith(p+"dev/"))(e))return c.REMOTE_FILE_KEY_DEV;throw new d.RemoteFileError(l.RemoteFileUpdateError.DecipherError,"The file URL is not matching production or dev environnement")},t.decipherDecryptionKey=S,t.verifyRemoteFileSignature=m,t.decipherFileIntoBlob=g,t.decipherRemoteFileUpdate=async function(e,t,r){const o=(0,a.bufferToBase64)(e),n=await S(t.key,r),c=(0,s.makeAsymmetricEncryption)({hashAlgorithm:i.HashAlgorithm.SHA_256});if(!await m(c,t,o))throw new d.RemoteFileError(l.RemoteFileUpdateError.DecipherError,"Invalid signature detected on file");return await g(o,n)}},54677:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isFileRevisionMapper=void 0,t.isFileRevisionMapper=function(e){return"object"==typeof e&&!!e&&!Array.isArray(e)&&"files"in e&&"object"==typeof e.files&&!!e.files&&!Array.isArray(e.files)&&Object.entries(e.files).every((([e,t])=>"string"==typeof e&&"number"==typeof t))}},91313:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(64438);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},89122:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fileMetaUpdate$=void 0;const o=r(18948),n=r(3343),a=r(96405);t.fileMetaUpdate$=()=>(0,o.pipe)((0,n.map)(a.fileMetaUpdateSelector),(0,n.distinctUntilChanged)())},23201:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logReceiveRemoteFileError=t.logReceiveRemoteFileSuccess=void 0;const o=r(48062),n=(e,t,r=undefined)=>{e.logEvent(new o.UserReceiveRemoteFileUpdateEvent({flowStep:t,remoteFileUpdateError:r,packageSource:o.PackageSource.Carbon}))};t.logReceiveRemoteFileSuccess=e=>n(e,o.FlowStep.Complete);t.logReceiveRemoteFileError=(e,t)=>n(e,o.FlowStep.Error,t)},87993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.writeFileInLocalStorage=t.readFileFromLocalStorage=t.retrieveFileContentFromNonCipheredLocalStorage=t.retrieveFileContentFromCipheredLocalStorage=t.retrieveFileMetaDataFromCipheredLocalStorage=t.persistSingleFileInNonCipheredLocalStorage=t.persistSingleFileContentInCipheredLocalStorage=t.persistFileMetaInCipheredLocalStorage=void 0;const o=r(25576),n=r(96405),a=r(1110),i=r(19601),s=r(48062),c=r(76905),d=e=>{if(!e)throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,"LocalStorageService is not initalized")};async function l({localStorageService:e,storeService:t},r){const{persistData:a,isAuthenticated:c}=t.getAccountInfo(),l=e.getInstance();if(!c||a===o.PersistData.PERSIST_DATA_NO)return;d(l);const u=await(0,n.fileSelector)(t.getState(),r);try{await l.storeRemoteFileContent(r,u.toBase64String())}catch(e){throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,`Cannot persist ${r} content in local storage`)}}async function u({storeService:e,storageService:t},r){const{persistData:a,isAuthenticated:c}=e.getAccountInfo();if(!c||a===o.PersistData.PERSIST_DATA_NO)return;const l=t.getLocalStorage();d(l);const u=await(0,n.fileSelector)(e.getState(),r);try{await l.writeItem(r,u.toBase64String())}catch(e){throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,`Cannot persist ${r} content in local storage`)}}async function p(e,t){const r=e.getInstance();d(r);return await r.isRemoteFileContentExist(t)?c.DownloadedFile.fromBase64Str(t,await r.getRemoteFileContent(t)):Promise.resolve(null)}async function S(e,t){const r=e.getLocalStorage();d(r);return await r.itemExists(t)?c.DownloadedFile.fromBase64Str(t,await r.readItem(t)):Promise.resolve(null)}t.persistFileMetaInCipheredLocalStorage=async function({localStorageService:e,storeService:t}){e.getInstance();const{persistData:r,isAuthenticated:a}=t.getAccountInfo();if(!a||r===o.PersistData.PERSIST_DATA_NO)return;d(e);const c=e.getInstance();try{await c.storeRemoteFileMeta((0,n.fileMetaUpdateSelector)(t.getState()))}catch{throw new i.RemoteFileError(s.RemoteFileUpdateError.LocalStorageError,"Cannot persist file metadata in local storage")}},t.persistSingleFileContentInCipheredLocalStorage=l,t.persistSingleFileInNonCipheredLocalStorage=u,t.retrieveFileMetaDataFromCipheredLocalStorage=async function({localStorageService:e}){const t=e.getInstance();return d(t),await t.isRemoteFileMetaDataExist()?await t.getRemoteFileMeta():Promise.resolve(null)},t.retrieveFileContentFromCipheredLocalStorage=p,t.retrieveFileContentFromNonCipheredLocalStorage=S,t.readFileFromLocalStorage=function(e,t){return a.FILE_SETTINGS[t].isLoadedWhileLoggedOut?S(e.storageService,t):p(e.localStorageService,t)},t.writeFileInLocalStorage=function(e,t){return a.FILE_SETTINGS[t].isLoadedWhileLoggedOut?u(e,t):l(e,t)}},19601:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assertRemoteFileError=t.RemoteFileError=void 0;const o=r(23201),n=r(70252);class a extends Error{constructor(e,t){super(t),this.name=e,this.name=e}}t.RemoteFileError=a,a.errorInstance="REMOTE_FILE_ERROR",t.assertRemoteFileError=function(e,t){!function(e){return e instanceof a}(t)?(0,n.sendExceptionLog)({error:t}):(0,o.logReceiveRemoteFileError)(e,t.name)}},96405:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fileContentStrSelector=t.fileSelector=t.fileMetaUpdateSelector=void 0;const r=e=>e.device.remoteFile;t.fileMetaUpdateSelector=e=>r(e).fileMetaData;t.fileSelector=(e,t)=>r(e).fileContentState[t];t.fileContentStrSelector=(e,r)=>(0,t.fileSelector)(e,r).toString()},98202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(36428),n=r(18216),a=r(16593);t.setupSubscriptions=function(e,t){e._sessionOpened.on((()=>(0,o.triggerDownloadRemoteFileUpdate)(t,!0))),e.sessionClosed.on((()=>(0,o.triggerDownloadRemoteFileUpdate)(t,!1))),e.coreServicesReady.on((e=>{e.initMode===n.InitMode.Resume&&((0,a.isAuthenticatedSelector)(t.storeService.getState())?(0,o.triggerDownloadRemoteFileUpdate)(t,!0):(0,o.triggerLoadFileAtInit)(t))})),e.appInitialized.on((()=>{(0,o.triggerLoadFileAtInit)(t)}))}},36428:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.triggerDownloadRemoteFileUpdate=t.triggerLoadFileAtInit=void 0;const o=r(19328),n=r(97890),a=r(1110),i=r(16179),s=30,c=60*s*1e3,d="carbon-rfu-alarm";function l(e){return(0,n.downloadRemoteFileHandler)(e,a.FILE_SETTINGS)}t.triggerLoadFileAtInit=function(e){return(0,i.loadFilesAtInit)(e)};let u=!1;let p=null;t.triggerDownloadRemoteFileUpdate=function(e,t){if(p&&function(e){clearInterval(e)}(p),t){if((0,o.alarmsIsSupported)())return void async function(e){const t=await(0,o.alarmsGet)(d);u||(o.alarmsOnAlarm.addListener((t=>{t.name===d&&l(e)})),u=!0),t||(0,o.alarmsCreate)(d,{delayInMinutes:1,periodInMinutes:s})}(e);p=function(e){return l(e),setInterval((()=>{l(e)}),c)}(e)}}},25661:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(17338),n=r(21587),a=r(64369),i=r(90622),s=r(74219),c=r(15209),d=r(21583),l=r(99293),u=r(55861),p=r(74412),S=r(70252),m=r(49409),g=r(50329),y=r(44389),A=r(16359),f=r(40588),E=r(37824),h=r(61),v=r(39952),T=r(70530),_=r(64811),I=r(88530),C=r(76569),P=r(76592),D=r(17387),O=r(33719),b=r(49183),w=r(14581),N=r(51168),R=r(7753),M=r(53156),L=r(16667),U=r(91313),k=r(25560),F=[y.bootstrap,n.bootstrap,i.bootstrap,s.bootstrap,c.bootstrap,d.bootstrap,l.bootstrap,u.bootstrap,p.bootstrap,S.bootstrap,a.bootstrap,m.bootstrap,g.bootstrap,A.bootstrap,h.bootstrap,f.bootstrap,v.bootstrap,T.bootstrap,I.bootstrap,C.bootstrap,P.bootstrap,D.bootstrap,O.bootstrap,b.bootstrap,w.bootstrap,N.bootstrap,_.bootstrap,L.vpnApiBootstrap,R.bootstrap,M.bootstrap,E.bootstrap,U.bootstrap,k.bootstrap];t.bootstrap=(e,t,r)=>{console.log("[background/carbon] Running bootstrap hooks...");const n=(0,o.getCoreServices)(e);for(let e=0;e<F.length;++e)try{(0,F[e])(t,n,r)}catch(t){throw console.error(`[background/carbon] Failed running bootstrap hook ${e+1}/${F.length}`,t),t}console.log("[background/carbon] Done running bootstrap hooks")}},74318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCurrentLocation=t.initCarbon=t.setPlatform=void 0;const o=r(62433),n=r(45127),a=r(30504),i=r(4798),s=r(75391),c=r(44242),d=r(20849),l=r(30855),u=r(87855),p=r(86056),S=r(17338),m=r(12995),g=r(70252),y=r(4673),A=r(47975),f=r(73011),E=r(96637),h=r(25661),v=r(2646),T=r(18539),_=r(18216),I=r(28486),C=r(48749),P=r(59301);t.setPlatform=(e,t,r)=>{if(r===_.InitMode.FirstInit){e.getInstance(S.CarbonServicesTypeEnum.StoreService).getStore().dispatch((0,m.savePlatformInfo)(t))}(0,p.setPlatformInfo)(t)},t.initCarbon=async function(e){try{console.log("[background/carbon] initializing...");const r=Object.values(C.DashlaneAPISchemesNames);if((0,C.setConfig)((0,o.omit)(r,e?.config??{})),(0,v.setPublicPath)(e.publicPath),!e.storageLayer)throw new Error("Missing Storage layer prevents Carbon initialization");const p=(0,S.carbonServices)({storageLayer:new T.CarbonLocalStorage(e.storageLayer),sessionStorage:e.sessionStorage,createClients:e.createClients}),{storeService:m,applicationModulesAccess:g}=(0,S.getCoreServices)(p);await m.completeRehydration();const D=function(e){const t=e.getState(),r=(0,I.appSessionIdSelector)(t)?_.InitMode.Resume:_.InitMode.FirstInit;return console.log(`[background/carbon] Init mode inferred: ${r}`),r}(m);(0,t.setPlatform)(p,e.platformInfo,D),await(0,P.initWebServicesConfig)(e,g,e.platformInfo);const O=(0,f.setupEventBus)(p);console.log("[background/carbon] Publishing lifecycle event coreServicesReady");try{await O.coreServicesReady({initMode:D})}catch(e){throw console.error("[background/carbon] Failed publishing lifecycle event coreServicesReady",e),e}console.log("[background/carbon] Done publishing lifecycle event coreServicesReady"),(0,A.loadFrequencyLists)(),e.plugins&&(0,y.setPlugins)(e.plugins),await(0,u.initAuthenticatedCarbonApplication)(e,p,D);const{debug:b,e2e:w}=e.connectors;let{leeloo:N,maverick:R,extension:M,api:L}=e.connectors;console.log("[background/carbon] Activating connectors"),N=N||(0,a.createEventBus)({events:n.CarbonLeelooConnector}),R=R||(0,a.createEventBus)({events:n.CarbonMaverickConnector}),M=M||(0,a.createEventBus)({events:n.ExtensionCarbonConnector}),L=L||(0,a.createEventBus)({events:n.CarbonApiConnector}),b&&(0,d.subscribeToDebugEvents)(b),w&&(0,l.subscribeToE2EEvents)(w,p),(0,i.subscribeToExtensionEvents)(M,p),(0,s.subscribeToLeelooEvents)(N,p),(0,c.subscribeToMaverickEvents)(R,p);const U=new E.TsEventBusCommandQueryBus(p,n.CarbonApiConnector,L);return console.log("[background/carbon] Connectors active"),(0,h.bootstrap)(p,U,e?.infrastructure),console.log("[background/carbon] Publishing lifecycle event appInitialized"),O.appInitialized({initMode:D,abTestForcedVersion:e.abTestForcedVersion}).catch((e=>{console.error("[background/carbon] Failed publishing lifecycle event appInitialized",e)})),p}catch(e){throw console.error("[background/carbon] Initialization failed",e),e}},t.fetchCurrentLocation=function(e,t){return e.country.getCurrentCountry().then((e=>{t.dispatch((0,m.saveCurrentLocation)(e))})).catch((e=>{const t=new Error(`[Sdk/Default] - fetchCurrentLocation: ${e}`);(0,g.sendExceptionLog)({error:t,code:n.ExceptionCriticality.WARNING})}))}},59301:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initWebServicesConfig=void 0;const o=r(18948),n=r(66638),a=r(45127),i=r(45800),s=r(48749),c="https://api--(.*).api-experimental.dashlane.com";function d(e){const t=new RegExp(c,"g"),r=e.matchAll(t).next();if(!r.done)return`https://ws1--${r.value[1]}.api-experimental.dashlane.com`}t.initWebServicesConfig=async function(e,t,r){try{if(![a.ApplicationBuildType.DEV,a.ApplicationBuildType.NIGHTLY].includes(r.buildType))return;const c=await(0,o.firstValueFrom)(t.createClients().webServices.queries.settingsForStaging().pipe((0,o.timeoutWith)(1e3,(0,o.of)((0,n.failure)(void 0)))),{defaultValue:(0,n.failure)(void 0)}),l=(0,n.isSuccess)(c)&&(0,n.getSuccess)(c).api;if(l?.override)return(0,i.setCloudflareHeaders)(l.cloudflareAccessKeyOverride,l.cloudflareSecretKeyOverride),void(0,s.setConfig)({DASHLANE_API_HOST_WITH_SCHEME:l.baseUrlOverride,DASHLANE_WS_HOST_WITH_SCHEME:d(l.baseUrlOverride)});e.keys.cloudflareAccess&&e.keys.cloudflareSecret&&(0,i.setCloudflareHeaders)(e.keys.cloudflareAccess,e.keys.cloudflareSecret),e.config.DASHLANE_API_HOST_WITH_SCHEME&&(0,s.setConfig)({DASHLANE_API_HOST_WITH_SCHEME:e.config.DASHLANE_API_HOST_WITH_SCHEME,DASHLANE_WS_HOST_WITH_SCHEME:e.config.DASHLANE_WS_HOST_WITH_SCHEME??d(e.config.DASHLANE_API_HOST_WITH_SCHEME??"")})}catch(e){console.error("[background/carbon] Failed to set webservices config overrides",e)}}},73011:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupEventBus=void 0;const o=r(17338),n=r(52346),a=r(99293),i=r(24579),s=r(10672),c=r(17387),d=r(33719),l=r(51168),u=r(43057),p=r(63678),S=r(23299),m=r(33045),g=r(63549),y=r(3149),A=r(98202),f=r(46564),E=r(83060);function h(e,t){return{moduleName:e,subscriptionFn:t}}const v=[h("ABTests",n.setupSubscriptions),h("Recovery",p.setupSubscriptions),h("Authentication",m.setupSubscriptions),h("CryptoMigration",g.setupSubscriptions),h("DataManagement",a.setupSubscriptions),h("Killswitch",S.setupSubscriptions),h("Login",i.setupSubscriptions),h("PasswordLeak",u.setupSubscriptions),h("Sdk",s.setupSubscriptions),h("Session",c.setupSubscriptions),h("TeamAdmin",l.setupSubscriptions),h("Sharing",d.setupSubscriptions),h("UserSettingsLog",y.setupUserSettingsLogSubscriptions),h("RemoteFileUpdates",A.setupSubscriptions),h("AntiPhishing",f.setupSubscriptions),h("Sync",E.setupSubscriptions)];t.setupEventBus=function(e){const t=(0,o.getCoreServices)(e),r=t.eventBusService;return console.log("[background/carbon] Setting up eventBus subscriptions"),v.forEach((e=>{try{e.subscriptionFn(r,t)}catch(t){throw console.error("[background/carbon] Error while setting up eventBus subscriptions",e.moduleName,t),t}})),console.log("[background/carbon] Done setting up eventBus subscriptions"),r}},10672:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(74318),n=r(18216),a=r(28096);t.setupSubscriptions=function(e,t){e.appInitialized.on((async e=>{const{wsService:r,storeService:i}=t;e.initMode===n.InitMode.FirstInit&&(await(0,o.fetchCurrentLocation)(r,i),(0,a.sendLocationInfo)(i.getPlatform().location))}))}},18216:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InitMode=void 0,function(e){e.FirstInit="FirstInit",e.Resume="Resume"}(t.InitMode||(t.InitMode={}))},63340:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeApplicationModulesAccess=void 0,t.makeApplicationModulesAccess=function(e){return{createClients:()=>e()}}},82568:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeApplicationModulesAccess=void 0;var o=r(63340);Object.defineProperty(t,"makeApplicationModulesAccess",{enumerable:!0,get:function(){return o.makeApplicationModulesAccess}})},17338:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCoreServices=t.carbonServices=t.CarbonServicesTypeEnum=void 0;const o=r(80722),n=r(72365),a=r(98416),i=r(18539),s=r(77627),c=r(89016),d=r(1860),l=r(74752),u=r(93990),p=r(73297),S=r(74412),m=r(82568);var g;!function(e){e.StoreService="StoreService",e.StorageService="StorageService",e.SessionService="SessionService",e.MasterPasswordEncryptorService="MasterPasswordEncryptorService",e.LocalDataEncryptorService="LocalDataEncryptorService",e.RemoteDataEncryptorService="RemoteDataEncryptorService",e.AuthorizationKeysEncryptorService="AuthorizationKeysEncryptorService",e.LocalStorageService="LocalStorageService",e.WSService="WSService",e.AutoLoginService="AutoLoginService",e.WebAuthnAuthenticationService="WebAuthnAuthenticationService",e.EventBusService="EventBusService",e.EventLoggerService="EventLoggerService",e.TeamDeviceEncryptedConfigEncryptorService="TeamDeviceEncryptedConfigEncryptorService",e.ApplicationModulesAccess="ApplicationModulesAccess"}(g=t.CarbonServicesTypeEnum||(t.CarbonServicesTypeEnum={}));t.carbonServices=e=>{const t=(0,o.makeStoreService)({sessionStorage:e.sessionStorage,store:void 0}),r=(0,p.makeEventBusService)(),y=e.masterPasswordEncryptorService?e.masterPasswordEncryptorService():(0,n.makeDataEncryptorService)(t),A=e.localDataEncryptorService?e.localDataEncryptorService():(0,n.makeDataEncryptorService)(t),f=e.remoteDataEncryptorService?e.remoteDataEncryptorService():(0,n.makeDataEncryptorService)(t),E=e.teamDeviceEncryptedConfigEncryptorService?e.teamDeviceEncryptedConfigEncryptorService():(0,n.makeDataEncryptorService)(t),h=(0,d.makeKeyDataEncryptorService)(),v=(0,n.makeDataEncryptorService)(t),T=Object.assign({},(0,c.makeWSService)(),e.wsService?e.wsService(t):{}),_=(0,i.makeStorageService)();_.setInstance(e.storageLayer);const I=e.authorizationKeysEncryptorService?e.authorizationKeysEncryptorService():(0,d.makeKeyDataEncryptorService)();(0,n.setObfuscatingKey)(I);const C=(0,a.makeLocalStorageService)({masterPasswordEncryptorService:y,localDataEncryptorService:A,authorizationKeysEncryptorService:I,autoLoginEncryptorService:h,webAuthnAuthenticationEncryptorService:v,storageService:_,storeService:t}),P=(0,S.makeEventLoggerService)({storeService:t,storageService:_}),D=(0,m.makeApplicationModulesAccess)(e.createClients),O=D.createClients(),b=O.session,w=(0,s.makeSessionService)({applicationModulesAccess:D,masterPasswordEncryptorService:y,localDataEncryptorService:A,remoteDataEncryptorService:f,storeService:t,localStorageService:C,storageService:_,wsService:T,eventBusService:r,eventLoggerService:P,teamDeviceEncryptedConfigEncryptorService:E,sessionClient:b,deviceManagementClient:O.deviceManagement,pinCodeClient:O.pinCode}),N=(0,l.makeAutoLoginService)({storageService:_,autoLoginEncryptorService:h,localStorageService:C,wsService:T,authorizationKeysEncryptorService:I,storeService:t,sessionClient:b}),R=(0,u.makeWebAuthnAuthenticationService)({webAuthnAuthenticationEncryptorService:v,storeService:t,storageService:_,localStorageService:C,authorizationKeysEncryptorService:I,sessionClient:b});return{services:[{type:g.WSService,instance:T},{type:g.StoreService,instance:t},{type:g.StorageService,instance:_},{type:g.LocalStorageService,instance:C},{type:g.SessionService,instance:w},{type:g.AuthorizationKeysEncryptorService,instance:I},{type:g.AutoLoginService,instance:N},{type:g.WebAuthnAuthenticationService,instance:R},{type:g.EventBusService,instance:r},{type:g.MasterPasswordEncryptorService,instance:y},{type:g.RemoteDataEncryptorService,instance:f},{type:g.LocalDataEncryptorService,instance:A},{type:g.EventLoggerService,instance:P},{type:g.TeamDeviceEncryptedConfigEncryptorService,instance:E},{type:g.ApplicationModulesAccess,instance:D}],getInstance:function(e){const t=this.services.find((t=>t.type===e));if(void 0===t)throw new Error("Service "+e+" not defined");return t.instance}}};t.getCoreServices=e=>{const t=e.getInstance(g.StoreService),r=e.getInstance(g.RemoteDataEncryptorService),o=e.getInstance(g.MasterPasswordEncryptorService),n=e.getInstance(g.LocalDataEncryptorService),a=e.getInstance(g.AuthorizationKeysEncryptorService),i=e.getInstance(g.LocalStorageService),s=e.getInstance(g.StorageService),c=e.getInstance(g.SessionService),d=e.getInstance(g.WSService),l=e.getInstance(g.AutoLoginService),u=e.getInstance(g.WebAuthnAuthenticationService),p=e.getInstance(g.EventBusService),S=e.getInstance(g.EventLoggerService),m=e.getInstance(g.TeamDeviceEncryptedConfigEncryptorService),y=e.getInstance(g.ApplicationModulesAccess),A=y.createClients();return{storeService:t,remoteDataEncryptorService:r,masterPasswordEncryptorService:o,localDataEncryptorService:n,authorizationKeysEncryptorService:a,localStorageService:i,storageService:s,sessionService:c,wsService:d,autoLoginService:l,webAuthnAuthenticationService:u,eventBusService:p,eventLoggerService:S,teamDeviceEncryptedConfigEncryptorService:m,applicationModulesAccess:y,moduleClients:A}}},34066:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(16593),n=r(38981),a=r(25421),i=r(6e3),s=r(81228),c=r(28287),d=r(10447),l=r(38328),u=r(17095),p=r(18203),S=r(94275),m=r(18380);t.config={commands:{validateToken:{handler:c.validateToken},validateMasterPassword:{handler:c.validateMasterPasswordHandler},resetProtectedItemAutofillTimer:{handler:c.resetProtectedItemAutofillTimerHandler},forceSync:{handler:d.forceSyncHandler},updatePremiumChurningDismissDate:{handler:l.updatePremiumChurningDismissDateHandler},setCredentialSearchOrder:{handler:u.setCredentialSearchOrderHandler},refreshSubscriptionInformation:{handler:p.refreshSubscriptionInformationHandler},updateAccountRecoveryKeyPersonalSettings:{handler:S.updateAccountRecoveryKeyPersonalSettingsHandler}},queries:{getActiveSpaces:{selector:o.activeSpacesSelector},getMasterPasswordAndServerKey:{selector:o.masterPasswordAndServerKeySelector},getSyncInfo:{selector:o.syncSelector},getIsSyncInProgress:{selector:o.syncIsInProgressSelector},getPremiumStatus:{selector:o.premiumStatusSelector},getNodePremiumStatus:{selector:o.nodePremiumStatusSelector},getSubscriptionInformation:{selector:o.subscriptionInformationSelector},getIsSSOUser:{selector:n.isSSOUserSelector},getSSOMigrationInfo:{selector:n.ssoMigrationInfoSelector},getSSOProviderInfo:{selector:n.ssoProviderInfoSelector},getUserLogin:{selector:o.userLoginSelector},getPublicUserId:{selector:o.publicUserIdSelector},getAnalyticsInstallationId:{selector:o.analyticsInstallationIdSelector},getUserLoginStatus:{selector:i.loginStatusSelector},getLoginStatus:{selector:i.loginStatusSelector},getWebOnboardingMode:{selector:o.webOnboardingModeSelector},getIsPaymentFailureChurningDismissed:{selector:o.isPaymentFailureChurningDismissedSelector},getCredentialSearchOrder:{selector:o.getCredentialSearchOrderSelector},getDidOpen:{selector:o.didOpenSelector},getPlatformName:{selector:o.platformNameSelector},getAccountAuthenticationType:{selector:a.accountAuthenticationTypeSelector},getSessionInfo:{selector:o.sessionInfoSelector},getUserCryptoSettings:{selector:o.userCryptoSettingsSelector}},liveQueries:{liveSyncInfo:{operator:s.syncInfo$},liveIsSyncInProgress:{operator:s.syncInProgress$},liveLoginStatus:{operator:i.getLoginStatus$},livePremiumStatus:{operator:s.premiumStatus$},liveSubscriptionInformation:{operator:s.subscriptionInformation$},liveServiceProviderUrl:{subject:s.getServiceProviderUrl$},liveWebOnboardingMode:{operator:s.webOnboardingMode$},liveDidOpen:{operator:s.didOpen$},liveIsSSOUser:{operator:m.isSSOUser$},liveSSOMigrationInfo:{operator:m.ssoMigrationInfo$},liveSessionInfo:{operator:s.sessionInfo$}}}},18380:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ssoMigrationInfo$=t.isSSOUser$=void 0;const o=r(38981),n=r(18948);t.isSSOUser$=()=>(0,n.pipe)((0,n.map)(o.isSSOUserSelector));t.ssoMigrationInfo$=()=>(0,n.pipe)((0,n.map)(o.ssoMigrationInfoSelector))},75199:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshCredentialsDedupView=void 0;const o=r(45127),n=r(81200),a=r(47521),i=r(46298),s=r(67331),c=r(70252);t.refreshCredentialsDedupView=async function(e,t){try{const r="web_extension_credentialsDedupView",d=await(0,a.getFeatureFlip)(e,t,r);return(0,i.isApiError)(d)?((0,c.sendExceptionLog)({error:new Error("Failed to get credentialsDedupView value"),code:o.ExceptionCriticality.WARNING}),e.dispatch((0,s.credentialsDedupViewUpdated)((0,n.getDefaultCredentialsDedupView)()))):e.dispatch((0,s.credentialsDedupViewUpdated)({credentialsDedupView:d.enabledFeatures[0]===r}))}catch(t){return(0,c.sendExceptionLog)({error:new Error(`Failed to refreshCredentialsDedupView: ${t.message}`),code:o.ExceptionCriticality.WARNING}),e.dispatch((0,s.credentialsDedupViewUpdated)((0,n.getDefaultCredentialsDedupView)()))}}},89160:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUsersSSOInfo=t.loadLocalData=t.completeLogin=t.handleGetAuthenticationMethodsForLoginError=t.cacheIsSso=t.cacheOtpStatus=t.handleDeletedProfiles=t.getLocalProfiles=t.checkLogin=void 0;const o=r(45127),n=r(58713),a=r(2246),i=r(25576),s=r(59489),c=r(86797),d=r(7624),l=r(16356),u=r(56915),p=r(90622),S=r(46298),m=r(17825),g=r(14656),y=r(92263),A=r(1965),f=r(16593);async function E(e,t){return function(e){return e.reduce(((e,t)=>(t.login&&t.deviceAccessKey?e.profiles.push(t):e.ghostProfiles.push(t),e)),{profiles:[],ghostProfiles:[]})}((await(0,p.getLocalAccounts)(e,t)).map((e=>e.login)).map((t=>({login:t,deviceAccessKey:(0,u.getDeviceAccessKeySelector)(e.getState(),t)}))))}async function h(e,t,r){const{profilesToDelete:o}=r;if((o||[]).length>0)return;const n=o.map((e=>e.login));await(0,A.wipeOutLocalAccounts)(e,t,n)}function v(e,t){(0,a.storeUserPublicSetting)(e,"otp2",t===c.OtpType.OTP_LOGIN)}function T(e,t){(0,a.storeUserPublicSetting)(e,"ssoInfos",t)}async function _(e,t,r,n){if(!(0,S.isApiErrorOfType)(S.BusinessError,r))throw new Error(`Failed to getAuthenticationMethodsForLogin (${r.code})`);const a=r.code;switch(a){case S.DeviceDeactivated:throw await(0,A.wipeOutLocalAccounts)(e,t,[n]),new Error(o.AuthenticationCode[o.AuthenticationCode.DEVICE_NOT_REGISTERED]);case S.UserNotFound:case"SSO_BLOCKED":case"invalid_authentication":throw new Error(o.AuthenticationCode[o.AuthenticationCode.TEAM_GENERIC_ERROR]);default:(0,m.assertUnreachable)(a)}}t.checkLogin=async function(e,r,n){const l=e.getState(),p=(0,f.userLoginSelector)(l);let m,A,I;try{const{profiles:t}=await E(e,r),o=(0,u.getDeviceAccessKeySelector)(l,p);if(!o)throw new Error("Unexpectedly missing deviceAccessKey during login");const a=await(0,S.getAuthenticationMethodsForLogin)(e,{login:p,deviceAccessKey:o,methods:i.localSupportedAuthenticationMethod,...t.length?{profiles:t}:{}});if((0,S.isApiError)(a))return _(r,n,a,p);h(r,n,a),m=a.verifications,A=a.accountType,e.dispatch((0,s.storeAccountAuthenticationType)(A))}catch(e){if(!(0,y.isCarbonError)(e,g.HttpError))throw e;m=function(e){const t=function(e){const t=(0,a.getUserPublicSetting)(e,"otp2");return t?c.OtpType.OTP_LOGIN:null}(e),r=function(e){const t=(0,a.getUserPublicSetting)(e,"ssoInfos");return t}(e),o=new Array;t===c.OtpType.OTP_LOGIN&&o.push({type:"totp"});r&&o.push({type:"sso",ssoInfo:{serviceProviderUrl:""}});return o}(p)}const C=m.find((e=>"sso"===e.type));return I=C?.ssoInfo.serviceProviderUrl&&"mp_user_to_sso_member"!==C?.ssoInfo.migration?o.AuthenticationCode.SSO_LOGIN_BYPASS:function(e,t=[]){const r=t.find((e=>"sso"===e.type));T(e,!!r);const n=function(e){const t=e.some((e=>"totp"===e.type));if(t)return c.OtpType.OTP_LOGIN;const r=e.filter((e=>"sso"!==e.type));if(r.length>0)throw new Error("Unsupported 2FA method requested");return null}(t);if(v(e,n),n===c.OtpType.OTP_LOGIN)return o.AuthenticationCode.ASK_OTP;if(r&&"mp_user_to_sso_member"!==r.ssoInfo.migration)return o.AuthenticationCode.SSO_LOGIN_BYPASS;return o.AuthenticationCode.ASK_MASTER_PASSWORD}(p,m),T(p,!!C),function(e,r,n,a){switch(e){case o.AuthenticationCode.SSO_LOGIN_BYPASS:if(!n?.serviceProviderUrl)throw new Error("[LocalAuthentication] - Unable to use SSO verification. Missing SSO information.");r.dispatch((0,d.storeSSOSettings)({ssoUser:!0,...(0,t.getUsersSSOInfo)(n)}));break;case o.AuthenticationCode.ASK_OTP:r.dispatch((0,s.enableOtp)(c.OtpType.OTP_LOGIN))}e!==o.AuthenticationCode.SSO_LOGIN_BYPASS&&r.dispatch((0,d.storeSSOSettings)({ssoUser:!1,...(0,t.getUsersSSOInfo)(n)}));r.dispatch((0,s.storeAccountAuthenticationType)(a))}(I,e,C?C.ssoInfo:void 0,A),I},t.getLocalProfiles=E,t.handleDeletedProfiles=h,t.cacheOtpStatus=v,t.cacheIsSso=T,t.handleGetAuthenticationMethodsForLoginError=_,t.completeLogin=async function(e,t,r,n,a){const i=e.getUserLogin(),s={login:i,deviceAccessKey:(0,u.getDeviceAccessKeySelector)(e.getState(),i),authTicket:n},c=await(0,S.completeLoginWithAuthTicket)(e,s);if((0,S.isApiError)(c))return async function(e,t,r,n){if(!(0,S.isApiErrorOfType)(S.BusinessError,r))throw new Error(`Failed to complete login (${r.code})`);const a=r.code;switch(a){case"DEVICE_NOT_FOUND":case"DEACTIVATED_DEVICE":throw await(0,A.wipeOutLocalAccounts)(e,t,[n]),new Error(o.AuthenticationCode[o.AuthenticationCode.DEVICE_NOT_REGISTERED]);case S.InvalidAuthTicket:throw new Error(o.AuthenticationCode[o.AuthenticationCode.TOKEN_NOT_VALID]);default:(0,m.assertUnreachable)(a)}}(t,r,c,i);const{serverKey:d}=c;if(!d)throw new Error(o.AuthenticationCode[o.AuthenticationCode.SERVER_KEY_MISSING]);return e.dispatch((0,l.updateisUsingDashlaneAuthenticator)(a)),e.dispatch((0,l.updateServerKey)(d)),o.AuthenticationCode.ASK_MASTER_PASSWORD},t.loadLocalData=async function(e,t,r){return r.getInstance().prepareCrypto(),await e.getInstance().user.loadSessionData(),t.dispatch((0,s.localDataLoaded)()),o.AuthenticationCode.LOGGEDIN};t.getUsersSSOInfo=e=>{if(!e)return{serviceProviderUrl:""};const t=(e=>{if(e.migration)switch(e.migration){case"mp_user_to_sso_member":return n.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO;case"sso_member_to_admin":case"sso_member_to_mp_user":return n.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP}})(e);return{serviceProviderUrl:e.serviceProviderUrl?e.serviceProviderUrl:"",...void 0!==t?{migration:t}:{},isNitroProvider:e.isNitroProvider}}},6e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLoginStatus$=t.loginStatusSelector=void 0;const o=r(32034),n=r(62433),a=r(18948),i=r(3343),s=r(27754),c=r(38981),d=(0,o.createSelector)(s.sessionIdSelector,(e=>e.userSession.account.isAuthenticated),((e,t)=>e&&t));t.loginStatusSelector=(0,o.createSelector)(d,(e=>e.userSession.account),c.ssoMigrationInfoSelector,((e,t,r)=>{if(!e)return{login:null,loggedIn:!1,needsSSOMigration:!1};const{isAuthenticated:o,login:n}=t;return{loggedIn:o,login:n,needsSSOMigration:void 0!==r}}));t.getLoginStatus$=()=>(0,a.pipe)((0,i.map)(t.loginStatusSelector),(0,i.distinctUntilChanged)(n.equals))},38865:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWebOnboardingMode=void 0;const o=r(76089),n=r(28096);t.updateWebOnboardingMode=function(e,t,r){if(!e.isAuthenticated())throw new Error("No session set");e.dispatch(o.webOnboardingModeUpdated(r));const a=e.getLocalSettings().webOnboardingMode;n.sendWebOnboardingModeUpdate(a),t.getInstance().user.persistLocalSettings()}},36960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDashlaneApiPairingService=void 0;const o=r(46298),n=r(95623);t.makeDashlaneApiPairingService=e=>({requestPairing:t=>(async(e,t)=>{try{const r=await o.requestPairing(e,t);if(o.isApiError(r))throw r;return r.pairingId?{pairingId:r.pairingId}:void 0}catch(e){return void(0,n.logError)({message:`Pairing request failed: ${e}`})}})(e,t)})},15718:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pairingIdSelector=t.isPairingEnabledSelector=void 0;t.isPairingEnabledSelector=e=>Boolean(e.userSession.session.pairingId);t.pairingIdSelector=e=>e.userSession.session.pairingId},10824:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestPairing=void 0;const o=r(15718),n=r(2246),a=r(16356),i=r(36960);t.requestPairing=async(e,t)=>{const r=e.getState();if((0,o.pairingIdSelector)(r))return;if(!(0,n.getSyncAppSetting)("syncWithLocalClients"))return;const s=(0,i.makeDashlaneApiPairingService)(e),c=await s.requestPairing(t),d=c?.pairingId;d&&e.dispatch((0,a.pairingSucceeded)(d))}},35507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.transformNodePremiumStatus=t.getFreshPremiumStatus=t.refreshSubscriptionInformation=t.refreshPremiumStatus=void 0;const o=r(62433),n=r(45127),a=r(95623),i=r(70252),s=r(48313),c=r(66833),d=r(25576),l=r(25011),u=r(31375),p=r(76089),S=r(46298);async function m(e,t){const r=e.getLocalSettings().subscriptionInformation;try{const r=await(0,u.getSubscriptionInformation)(e,t);if((0,S.isApiError)(r))throw new Error(`${r.message} (code: ${r.code})`);return e.dispatch((0,p.localSettingsSubscriptionInformationStatusUpdated)(r)),r}catch(e){const t=new Error(`[PremiumController] - refreshUserSubscriptionStatus: ${e}`);if(a.default.error(t),(0,i.sendExceptionLog)({error:t}),r)return r;throw e}}t.refreshPremiumStatus=async function(e,t,r,o){const n=e.getLocalSettings().premiumStatus,d=e.getLocalSettings().nodePremiumStatus,u=!d?.currentTimestampUnix||Date.now()-d.currentTimestampUnix>1e4;if(d&&!u)return n;try{const[n,a]=await Promise.all([A(t,r,o),(0,l.getPremiumStatus)(e,r).then((e=>{if((0,S.isApiError)(e))throw new Error(`${e.message} (code: ${e.code})`);return e})),m(e,r)]),i=n?.spaces||[],d=_(a),u={...n,planName:n?.planName?.toLowerCase()??null};return e.dispatch((0,s.premiumStatusUpdated)(u)),e.dispatch((0,p.localSettingsNodePremiumStatusUpdated)(d)),(0,c.refreshSpaceData)(e,i),n}catch(e){const t=new Error(`[PremiumController] - refreshPremiumStatus: ${e}`);if(a.default.error(t),(0,i.sendExceptionLog)({error:t}),n)return n;throw e}},t.refreshSubscriptionInformation=m;const g=e=>{if(!e.capabilities||!e.capabilities.length)return;return e.capabilities.reduce(((e,t)=>{const{capability:r,...o}=t;return e[r]=o,e}),{})},y=e=>e.familyMembership?e.familyMembership[0]:void 0;function A(e,t,r){return e.premium.status({login:t,uki:r,billingInformation:!0,spaces:!0,autoRenewal:!0,familyInformation:!0,previousPlan:!0,needsAutoRenewalFailed:!0}).then((e=>{const t=(0,o.pick)(["statusCode","billingInformation","planName","planType","planFeature","endDate","spaces","autoRenewal","previousPlan","autoRenewalFailed","autoRenewInfo","recoveryHash"],e);return t.capabilities=g(e),e.hasOwnProperty("familyMembership")&&(t.familyMembership=y(e)),t}))}t.getFreshPremiumStatus=A;const f=e=>{if(e.capabilities?.length)return e.capabilities.reduce(((e,t)=>{const{capability:r,...o}=t;return e[r]=o,e}),{})},E=e=>{switch(e.b2cStatus.statusCode){case d.B2CStatusCode.Subscribed:return e.b2cStatus.planName.includes("grace")?n.PremiumStatusCode.GRACE_PERIOD:e.b2cStatus.isTrial?n.PremiumStatusCode.NEW_USER:e.b2cStatus.autoRenewal?n.PremiumStatusCode.PREMIUM_CANCELLED:n.PremiumStatusCode.PREMIUM;case d.B2CStatusCode.Legacy:return n.PremiumStatusCode.OLD_ACCOUNT;case d.B2CStatusCode.Free:default:return n.PremiumStatusCode.NO_PREMIUM}};function h(e){return e.map((e=>({login:e})))}function v(e){const t=[];return e.currentTeam&&t.push({associatedEmail:e.currentTeam.associatedEmail,billingAdmins:h(e.currentTeam.teamMembership.billingAdmins),color:e.currentTeam.teamInfo.color,companyName:e.currentTeam.teamInfo.name,info:{...e.currentTeam.teamInfo},invitationDate:e.currentTeam.invitationDateUnix,isBillingAdmin:e.currentTeam.teamMembership.isBillingAdmin,isSSOUser:e.currentTeam.teamMembership.isSSOUser,isTeamAdmin:e.currentTeam.teamMembership.isTeamAdmin,isGroupManager:e.currentTeam.teamMembership.isGroupManager,joinDate:e.currentTeam.joinDateUnix,letter:e.currentTeam.teamInfo.letter,membersNumber:e.currentTeam.teamInfo.membersNumber,planType:e.currentTeam.teamInfo.planType,revokeDate:null,shouldDelete:!1,status:n.SpaceStatus.Accepted,teamAdmins:h(e.currentTeam.teamMembership.teamAdmins),teamId:e.currentTeam.teamId.toString(),teamName:e.currentTeam.teamName,tier:e.currentTeam.planFeature}),e.pastTeams&&e.pastTeams.forEach((e=>{t.push({associatedEmail:e.associatedEmail,billingAdmins:h(e.teamMembership.billingAdmins),color:e.teamInfo.color,companyName:e.teamName,info:{...e.teamInfo},invitationDate:e.invitationDateUnix,isBillingAdmin:e.teamMembership.isBillingAdmin,isSSOUser:e.teamMembership.isSSOUser,isTeamAdmin:e.teamMembership.isTeamAdmin,isGroupManager:e.teamMembership.isGroupManager,joinDate:e.joinDateUnix,letter:e.teamInfo.letter,membersNumber:e.teamInfo.membersNumber,planType:e.teamInfo.planType,revokeDate:e.revokeDateUnix,shouldDelete:e.shouldDelete,status:e.status,teamAdmins:h(e.teamMembership.teamAdmins),teamId:e.teamId.toString(),teamName:e.teamName,tier:e.planFeature})})),t}function T(e){return{...e,teamMembership:{...e.teamMembership,billingAdmins:h(e.teamMembership.billingAdmins),teamAdmins:h(e.teamMembership.teamAdmins)}}}function _(e){const t=e.b2bStatus?.currentTeam?{currentTeam:(r=e.b2bStatus.currentTeam,{...r,teamMembership:{...r.teamMembership,billingAdmins:r.teamMembership.billingAdmins.map((e=>({login:e}))),teamAdmins:r.teamMembership.teamAdmins.map((e=>({login:e})))}})}:{};var r;const o=e.b2bStatus?.pastTeams?{pastTeams:e.b2bStatus.pastTeams.map(T)}:{};return{...e.b2cStatus,planName:e.b2cStatus?.planName?.toLowerCase()??null,currentTimestampUnix:Date.now(),isTrial:e.b2cStatus.isTrial,statusCode:E(e),spaces:e.b2bStatus?v(e.b2bStatus):[],b2bStatus:{statusCode:e.b2bStatus?.statusCode,hasPaid:e.b2bStatus?.hasPaid,...t,...o},capabilities:f(e)}}t.transformNodePremiumStatus=_},70414:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUsersSSOInfo=t.validateMasterPassword=t.registerDevice=t.registerDeviceWithToken=t.registerDeviceWithDashlaneAuthenticator=t.cancelRegistrationWithDashlaneAuthenticator=t.generateUki=t.askServerToSendToken=t.checkLoginWithUki=t.requestDeviceRegistration=t.SendTokenStatus=void 0;const o=r(35088),n=r(62433),a=r(45127),i=r(58713),s=r(25576),c=r(95623),d=r(76089),l=r(86797),u=r(59489),p=r(25963),S=r(63713),m=r(48313),g=r(16038),y=r(64910),A=r(33769),f=r(56668),E=r(16356),h=r(12206),v=r(7624),T=r(43739);var _=r(72636);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return _.SendTokenStatus}});const I=r(17825),C=r(19399),P=r(28287),D=r(16593),O=r(46298),b=r(70252),w=r(92263);let N,R;t.requestDeviceRegistration=async function(e){const r=e.getAccountInfo().login,o=await(0,O.getAuthenticationMethodsForDevice)(e,{login:r,methods:s.remoteSupportedAuthenticationMethod});if((0,O.isApiError)(o))return function(e){if(!(0,O.isApiErrorOfType)(O.BusinessError,e))throw new Error(`Failed to getAuthenticationMethodsForDevice (${e.code})`);const t=e.code;switch(t){case O.UserNotFound:throw new Error(a.AuthenticationCode[a.AuthenticationCode.USER_DOESNT_EXIST]);case O.SSOBlocked:throw new Error(a.AuthenticationCode[a.AuthenticationCode.SSO_BLOCKED]);case O.TeamGenericError:case"expired_version":throw new Error(a.AuthenticationCode[a.AuthenticationCode.TEAM_GENERIC_ERROR]);case"DEACTIVATED_USER":throw new Error("Unsupported DEACTIVATED_USER");default:(0,I.assertUnreachable)(t)}}(o);const{verifications:n,accountType:i}=o;if(!n)throw new Error("[requestDeviceRegistration] - No verification in API response.");let c;const d=n.find((e=>"sso"===e.type));return c=d?.ssoInfo.serviceProviderUrl&&"mp_user_to_sso_member"!==d?.ssoInfo.migration?a.AuthenticationCode.SSO_LOGIN_BYPASS:function(e=[]){if(e.some((({type:e})=>"email_token"===e)))return a.AuthenticationCode.ASK_TOKEN;if(e.some((({type:e})=>"totp"===e)))return a.AuthenticationCode.ASK_OTP_FOR_NEW_DEVICE;if(e.some((({type:e})=>"dashlane_authenticator"===e)))return a.AuthenticationCode.ASK_DASHLANE_AUTHENTICATOR;throw new Error("[requestDeviceRegistration - getVerificationType] - Verification not supported!")}(n),function(e,r,o,n){if(e===a.AuthenticationCode.SSO_LOGIN_BYPASS){if(!o?.serviceProviderUrl)throw new Error("[requestDeviceRegistration - processVerification] - Unable to use SSO verification. Missing SSO information.");r.dispatch((0,v.storeSSOSettings)({ssoUser:!0,...(0,t.getUsersSSOInfo)(o)}))}e!==a.AuthenticationCode.SSO_LOGIN_BYPASS&&r.dispatch((0,v.storeSSOSettings)({ssoUser:!1,...(0,t.getUsersSSOInfo)(o)}));r.dispatch((0,u.storeAccountAuthenticationType)(n))}(c,e,d?d.ssoInfo:void 0,i),c},t.checkLoginWithUki=async function(e,t,r){const o=e.getAccountInfo().login;if(!await async function(e,t,r){const o=await e.authentication.validity({login:t,uki:r});return"UKI VALID"===o}(t,o,r))throw new Error(a.AuthenticationCode[a.AuthenticationCode.INVALID_UKI]);return e.dispatch((0,u.confirmUserAuthentication)()),Promise.resolve(a.AuthenticationCode.USE_LOCAL_UKI)},t.askServerToSendToken=async function(e,t){const r=await(0,O.requestEmailTokenVerification)(e,{login:t});if((0,O.isApiError)(r))throw c.default.log(`Server failed to send a token with response: ${r.message}`),new Error(a.AuthenticationCode[a.AuthenticationCode.SEND_TOKEN_FAILED])};const M=(e,t)=>{t?e.dispatch((0,u.enableOtp)(l.OtpType.OTP_LOGIN)):e.dispatch((0,u.enableOtp)(l.OtpType.OTP_NEW_DEVICE))};t.generateUki=function(e){return`${e}-${(0,o.v4)()}`};const L=async(e,t,r,o,n,a)=>{const i=a||h.device.getDefaultDeviceName(),c=e.getPlatformInfo(),d=(0,C.secureDeviceName)(i);if("server_carbon_unknown"===c.platformName)throw new Error("Unexpected uninitialized platform info");const l={deviceName:d,appVersion:c.appVersion,platform:c.platformName,osCountry:(0,O.makeSafeCountry)(e.getLocation().country||c.country),osLanguage:(0,O.makeSafeLanguage)(c.lang),temporary:r!==s.PersistData.PERSIST_DATA_YES};switch(t.type){case"extraDeviceToken":return{...await(0,O.completeExtraDeviceRegistrationWithToken)(e,{device:l,login:n,verification:{token:(0,s.extractExtraDeviceToken)(t)}}),ssoServerKey:null};case"emailToken":case"otp":case"sso":return(0,O.completeDeviceRegistrationWithAuthTicket)(e,{device:l,login:n,authTicket:o});default:(0,I.assertUnreachable)(t)}},U=(e,t,r,o)=>{const n=o||h.device.getDefaultDeviceName(),a=e.getPlatformInfo(),i=e.getAccountInfo().login,c=(0,C.secureDeviceName)(n);if("server_carbon_unknown"===a.platformName)throw new Error("Unexpected unitiliazed platform info");const d={deviceName:c,appVersion:a.appVersion,platform:a.platformName,osCountry:(0,O.makeSafeCountry)(e.getLocation().country||a.country),osLanguage:(0,O.makeSafeLanguage)(a.lang),temporary:t!==s.PersistData.PERSIST_DATA_YES};return(0,O.completeDeviceRegistrationWithAuthTicket)(e,{device:d,login:i,authTicket:r})},k=async(e,t)=>{const r=await(0,P.dashlaneAuthenticatorGetAuthTicket)(e,t);if(!1===r.success){const{error:{code:e,message:t}}=r;if(e===a.AuthenticationCode.BUSINESS_ERROR)throw new Error(t);throw new Error(a.AuthenticationCode[e])}return N?.(s.CancelDashlaneAuthenticatorRegistration.COMPLETED),r.authTicket};t.cancelRegistrationWithDashlaneAuthenticator=function(){R?.(s.CancelDashlaneAuthenticatorRegistration.CANCELLED)},t.registerDeviceWithDashlaneAuthenticator=async function(e,t,r,o){const n=new Promise(((e,t)=>{N=e,R=t}));let i;try{i=(await Promise.all([k(e,o),n]))[0]}catch(e){if(e===s.CancelDashlaneAuthenticatorRegistration.CANCELLED)return a.AuthenticationCode.DASHLANE_AUTHENTICATOR_LOGIN_CANCELLED;throw e}finally{R=void 0,N=void 0}if(i){const n=await U(e,t,i,o);(0,O.isApiError)(n)&&function(e){if(!(0,O.isApiErrorOfType)(O.BusinessError,e))throw new Error(`Failed to complete device registration (${e.code})`);const t=e.code;if(t===O.InvalidAuthTicket)throw new Error(a.AuthenticationCode[a.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED]);(0,I.assertUnreachable)(t)}(n),e.dispatch((0,E.updateisUsingDashlaneAuthenticator)(!0)),e.dispatch((0,E.updateisUsingBackupCode)(!1));const{deviceAccessKey:s,deviceSecretKey:c,settings:d,serverKey:l,deviceAnalyticsId:u,userAnalyticsId:p,publicUserId:S}=n;return B(e,{login:r,deviceAccessKey:s,deviceSecretKey:c,settings:d,serverKey:l,deviceAnalyticsId:u,userAnalyticsId:p,publicUserId:S,isDataPersisted:t}),a.AuthenticationCode.ASK_MASTER_PASSWORD}throw new Error("Authentication Ticket is missing")};const F=async(e,t)=>{const r=await(0,P.convertTokenToAuthTicket)(e,t);if(!1===r.success){const{error:{code:e,message:t}}=r;if(e===a.AuthenticationCode.BUSINESS_ERROR)throw new Error(t);throw new Error(a.AuthenticationCode[e])}return r.authTicket};async function B(e,t){const{deviceAccessKey:r,deviceSecretKey:o,settings:n,serverKey:a,deviceAnalyticsId:i,userAnalyticsId:s,publicUserId:c,isDataPersisted:l,deviceName:u,login:p}=t;if(e.dispatch((0,T.deviceRegistered)((0,T.makeDeviceRegistrationKeys)(r,o),l,p)),a&&e.dispatch((0,E.updateServerKey)(a)),e.dispatch((0,E.updateSettingsForMPValidation)(n)),i&&e.dispatch((0,E.updateDeviceAnalyticsId)(i)),s&&e.dispatch((0,E.updateUserAnalyticsId)(s)),c&&e.dispatch((0,E.updatePublicUserId)(c)),u){const t=(0,C.secureDeviceName)(u);e.dispatch(d.registerDeviceName(t))}e.dispatch((0,T.deviceRegistered)((0,T.makeDeviceRegistrationKeys)(r,o),l,p))}t.registerDeviceWithToken=async function(e,t,r,o,i,s,c){const d=await F(e,r),l=await L(e,r,t,d,i,s);if((0,O.isApiError)(l))return function(e,t){if(!(0,O.isApiErrorOfType)(O.BusinessError,e))throw new Error(`Failed to complete device registration (${e.code})`);const r=e.code;switch(r){case O.UserNotFound:throw new Error(a.AuthenticationCode[a.AuthenticationCode.INVALID_LOGIN]);case O.VerificationFailed:case O.InvalidAuthTicket:if("otp"===t.type)throw new Error(a.AuthenticationCode[a.AuthenticationCode.OTP_NOT_VALID]);throw new Error(a.AuthenticationCode[a.AuthenticationCode.TOKEN_NOT_VALID]);case O.VerificationMethodDisabled:throw new Error(a.AuthenticationCode[a.AuthenticationCode.REGISTER_DEVICE_FAILED]);case"TEMPORARY_DEVICE_FORBIDDEN":throw new Error(a.AuthenticationCode[a.AuthenticationCode.TEAM_GENERIC_ERROR]);default:(0,I.assertUnreachable)(r)}}(l,r);const{deviceAccessKey:u,deviceSecretKey:p,settings:S,serverKey:m,ssoServerKey:h,remoteKeys:v,deviceAnalyticsId:T,userAnalyticsId:_,publicUserId:C}=l;if(h){const{masterPasswordEncryptorService:t,remoteDataEncryptorService:r,ssoServiceProviderKey:o}=c;if(!v||(0,n.isEmpty)(v))throw new Error("registerDevice failed with error: ssoServerKey or remoteKeys is missing");const a=(0,g.base64ToBuffer)(h),i=v.filter((e=>"sso"===e.type))[0];try{const n=(0,g.base64ToBuffer)(o),s=(0,A.getEncryptionKeyBuffer)(n,a,{skipDerivation:!0}),c=(0,g.arrayBufferToText)(s),d="",l=(0,y.getNoDerivationCryptoConfig)();e.dispatch((0,E.updateMasterPassword)(c)),t.setInstance({raw:c},d,l);const u=await t.getInstance().decrypt(i.key),p=(0,f.deflatedUtf8ToUtf16)(u,{skipUtf8Decoding:!0,skipInflate:!0});r.setInstance({raw:p},d,l),e.dispatch((0,E.updateRemoteKey)(p))}catch(e){throw new Error(`registerDevice failed deciphering remoteKey with error: ${e}`)}}return e.dispatch((0,E.updateisUsingDashlaneAuthenticator)(!1)),e.dispatch((0,E.updateisUsingBackupCode)(o)),"otp"===r?.type&&M(e,m),B(e,{deviceAccessKey:u,deviceSecretKey:p,settings:S,serverKey:m,deviceAnalyticsId:T,userAnalyticsId:_,publicUserId:C,isDataPersisted:t,login:i}),a.AuthenticationCode.ASK_MASTER_PASSWORD},t.registerDevice=B,t.validateMasterPassword=async function(e,t){try{const r=e.getState(),o=(0,D.masterPasswordValidationDataSelector)(r),n=e=>{},[i]=await S.decrypt(t.getInstance(),n,null,new Map,[o]);return e.dispatch((0,m.applyTransactions)([i])),e.dispatch(d.registerLastSync(p.MIN_SYNC_TIMESTAMP)),a.AuthenticationCode.LOGGEDIN}catch(e){const t=w.CarbonError.fromAnyError(e).addContextInfo("REMOTE LOGIN","validateMasterPassword");throw(0,b.sendExceptionLog)({error:t}),new Error(a.AuthenticationCode[a.AuthenticationCode.WRONG_PASSWORD])}};t.getUsersSSOInfo=e=>{if(!e)return{serviceProviderUrl:""};const t=(e=>{if(e.migration)switch(e.migration){case"mp_user_to_sso_member":return i.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO;case"sso_member_to_admin":case"sso_member_to_mp_user":return i.AuthenticationFlowContracts.SSOMigrationType.SSO_TO_MP}})(e);return{serviceProviderUrl:e.serviceProviderUrl?e.serviceProviderUrl:"",...void 0!==t?{migration:t}:{},isNitroProvider:e.isNitroProvider}}},28096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendFeatures=t.sendWebOnboardingModeUpdate=t.sendTeamAdminDataUpdate=t.updatePaymentCardTokenResult=t.reportDataUpdate=t.sendLocationInfo=t.sendLocalAccounts=t.triggerSessionSyncStatus=t.triggerExtensionReload=t.triggerSessionOpened=t.triggerOpenSessionFailed=t.getAuthenticationCodeFromError=t.triggerSsoSolutionChanged=t.triggerServerSidePairingStatusChanged=t.triggerLoginStatusChanged=t.triggerOpenSessionMasterPasswordLess=t.triggerOpenSessionSsoRedirectionToIdpRequired=t.triggerOpenSessionExtraDeviceTokenRequired=t.triggerOpenSessionDashlaneAuthenticator=t.triggerOpenSessionTokenSent=t.triggerAskMasterPassword=t.triggerOpenSessionOTPForNewDeviceRequired=t.triggerOpenSessionOTPSent=t.SessionResumingCode=t.AuthenticationCode=void 0;const o=r(45127);Object.defineProperty(t,"AuthenticationCode",{enumerable:!0,get:function(){return o.AuthenticationCode}});const n=r(21726),a=r(19697),i=r(70252),s=r(95623),c=r(92263),d=r(14656),l=r(90622),u=r(25576);Object.defineProperty(t,"SessionResumingCode",{enumerable:!0,get:function(){return u.SessionResumingCode}});const p=r(38981),S=r(27885),m=r(16593);function g(e){s.default.log(`Session status updated for ${e.login}`);const t=(0,n.default)();t&&t.carbonLoginStatusChanged(e);const r=(0,a.default)();r&&r.carbonLoginStatusChanged(e)}function y(e){if(a.default){const t=(0,a.default)();t&&t.serverSidePairingStatusChanged(e)}}function A(e){let t=e&&e.message&&void 0!==o.AuthenticationCode[e.message]?o.AuthenticationCode[e.message]:o.AuthenticationCode.UNKNOWN_ERROR;return t===o.AuthenticationCode.UNKNOWN_ERROR&&((0,c.isCarbonError)(e,d.HttpError,d.HttpErrorCode.NETWORK_ERROR)&&(t=o.AuthenticationCode.NETWORK_ERROR),e?.message?.includes("TOKEN_NOT_VALID")&&(t=o.AuthenticationCode.TOKEN_NOT_VALID)),t}function f(e){switch(e){case o.AuthenticationCode.INVALID_LOGIN:case o.AuthenticationCode.EMPTY_LOGIN:case o.AuthenticationCode.EMPTY_MASTER_PASSWORD:case o.AuthenticationCode.EMPTY_TOKEN:case o.AuthenticationCode.EMPTY_OTP:case o.AuthenticationCode.NETWORK_ERROR:case o.AuthenticationCode.USER_DOESNT_EXIST:case o.AuthenticationCode.OTP_NOT_VALID:case o.AuthenticationCode.TOKEN_NOT_VALID:case o.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS:case o.AuthenticationCode.WRONG_PASSWORD:return o.ExceptionCriticality.WARNING;default:return o.ExceptionCriticality.ERROR}}function E(e){return Promise.resolve({localAccounts:e}).then((e=>{s.default.log("send localAccountsListUpdated to leeloo");const t=(0,n.default)();t&&t.localAccountsListUpdated(e);const r=(0,a.default)();r&&r.localAccountsListUpdated(e)}))}function h(e){const t=e.getSpaceData(),r=(0,S.getNodePremiumStatusSpaceData)(e),{spaces:o}=r,n=o.reduce(((e,t)=>{const{isTeamAdmin:r,isBillingAdmin:o,isGroupManager:n}=t.details;return{isTeamAdmin:r||e.isTeamAdmin,isBillingAdmin:o||e.isBillingAdmin,isGroupManager:Boolean(n)||e.isGroupManager}}),{isTeamAdmin:!1,isBillingAdmin:!1,isGroupManager:!1}),i=(0,a.default)();i&&i.spaceDataUpdated({...t,rights:n})}function v(e){const t=(0,n.default)();t&&t.webOnboardingModeUpdated(e);const r=(0,a.default)();r&&r.webOnboardingModeUpdated(e)}t.triggerOpenSessionOTPSent=function(e){s.default.log("Ask for OTP");const t=(0,n.default)();t&&t.openSessionOTPSent(e);const r=(0,a.default)();r&&r.openSessionOTPSent(e)},t.triggerOpenSessionOTPForNewDeviceRequired=function(){const e=(0,n.default)();e&&e.openSessionOTPForNewDeviceRequired();const t=(0,a.default)();t&&t.openSessionOTPForNewDeviceRequired()},t.triggerAskMasterPassword=function(e){s.default.log("Ask for master password");const t=(0,n.default)();t&&t.openSessionAskMasterPassword({login:e});const r=(0,a.default)();r&&r.openSessionAskMasterPassword({login:e})},t.triggerOpenSessionTokenSent=function(e){s.default.log("Ask for new device e-mail token");const t=(0,n.default)();t&&t.openSessionTokenSent(e);const r=(0,a.default)();r&&r.openSessionTokenSent(e)},t.triggerOpenSessionDashlaneAuthenticator=function(){(0,s.logDebug)({message:"Ask for new device dashlane authenticator push notification"});const e=(0,n.default)();e&&e.openSessionDashlaneAuthenticator();const t=(0,a.default)();t&&t.openSessionDashlaneAuthenticator()},t.triggerOpenSessionExtraDeviceTokenRequired=function(){const e=(0,n.default)();e&&e.openSessionExtraDeviceTokenRequired();const t=(0,a.default)();t&&t.openSessionExtraDeviceTokenRequired()},t.triggerOpenSessionSsoRedirectionToIdpRequired=function(e,t){const r=(0,n.default)();r&&r.openSessionSsoRedirectionToIdpRequired({serviceProviderRedirectUrl:e,isNitroProvider:t});const o=(0,a.default)();o&&o.openSessionSsoRedirectionToIdpRequired({serviceProviderRedirectUrl:e,isNitroProvider:t})},t.triggerOpenSessionMasterPasswordLess=function(){const e=(0,n.default)();e&&e.openSessionMasterPasswordLess();const t=(0,a.default)();t&&t.openSessionMasterPasswordLess()},t.triggerLoginStatusChanged=g,t.triggerServerSidePairingStatusChanged=y,t.triggerSsoSolutionChanged=function(e){const t=(0,a.default)();t&&t.ssoSolutionChanged(e)},t.getAuthenticationCodeFromError=A,t.triggerOpenSessionFailed=function(e){s.default.log("Failed to open Session"),s.default.log(`error: ${e}`);const t=A(e),r=t===o.AuthenticationCode.UNKNOWN_ERROR?e&&e.message&&"string"==typeof e.message?e.message:"89645128":"",c=new Error(`[SessionCommunication] - triggerOpenSessionFailed: ${e}`);c.stack=e.stack,s.default.error(c),(0,i.sendExceptionLog)({error:c,code:f(t)});const d={errorCode:o.AuthenticationCode[t],additionalErrorInfo:r,displayErrorCode:!0},l=(0,n.default)();l&&l.openSessionFailed(d);const u=(0,a.default)();u&&u.openSessionFailed(d)},t.triggerSessionOpened=function(e,t,r){const n=void 0!==(0,p.ssoMigrationInfoSelector)(e.getState()).migration;if(g({loggedIn:!0,login:e.getAccountInfo().login,needsSSOMigration:n}),h(e),v(e.getLocalSettings().webOnboardingMode),(0,l.getLocalAccounts)(e,t).then((e=>{E(e)})),void 0!==r){y({serverSidePairingStatus:r?o.ServerSidePairingStatus.PAIRED:o.ServerSidePairingStatus.UNPAIRED})}},t.triggerExtensionReload=function(e){const t=(0,m.didOpenSelector)(e.getState()),r=(0,n.default)();r&&r.reloadExtension(t)},t.triggerSessionSyncStatus=function(e){const t=(0,n.default)();t&&t.sessionSyncStatus(e);const r=(0,a.default)();r&&r.sessionSyncStatus(e)},t.sendLocalAccounts=E,t.sendLocationInfo=function(e){const t=(0,a.default)();t&&t.currentLocationUpdated(e)},t.reportDataUpdate=h,t.updatePaymentCardTokenResult=function(e){const t=(0,a.default)();t&&t.updatePaymentCardTokenResult(e)},t.sendTeamAdminDataUpdate=function(e){const t=(0,a.default)();t&&t.teamAdminDataUpdated(e)},t.sendWebOnboardingModeUpdate=v,t.sendFeatures=function(e){const t=(0,n.default)();t&&t.accountFeaturesChanged(e);const r=(0,a.default)();r&&r.accountFeaturesChanged(e)}},5464:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refeshAccountInfo=t.AutofillProtectionStatus=t.askWebsiteInfo=t.saveGeneratedPassword=t.generatePassword=t.getPasswordGenerationSettings=t.generateAndSavePassword=t.resumeSession=t.sessionForceSync=t.getAndTriggerRefreshAccountInfo=t.makeSessionController=void 0;const o=r(48062),n=r(50415),a=r(95623),i=r(28096),s=r(95648),c=r(70252),d=r(44908),l=r(35507),u=r(29954),p=r(9486),S=r(19399),m=r(56915),g=r(16593),y=r(28287),A=r(34376),f=r(27885);t.makeSessionController=e=>({askWebsiteInfo:t=>O(e.storeService,t),cancelPremiumSubscription:()=>async function(e,t,r){if(!e.isAuthenticated())return{success:!1};try{return await t.getInstance().payment.cancelPremiumSubscription(),v(e,t,r).catch((e=>{})),{success:!0}}catch(e){const t=e.message,r=new Error(`[SessionController] - cancelPremiumSubscription: ${e}`);return a.default.log(r),c.sendExceptionLog({error:r}),{success:!1,reason:t}}}(e.storeService,e.sessionService,e.wsService),changeDeviceName:(t,r)=>function(e,t,r,o){if(e.isAuthenticated()){const e=(0,S.secureDeviceName)(o);return t.getInstance().device.changeDeviceName(r,e).catch((e=>{const t=new Error(`[SessionController] - changeDeviceName: ${e}`);a.default.log(t),c.sendExceptionLog({error:t})}))}return Promise.resolve(null)}(e.storeService,e.sessionService,t,r),closeSession:()=>{return t=e.sessionService,a.default.log("SessionController/closeSession called"),t.close();var t},lockSession:()=>e.sessionService.lock(),deactivateDevice:t=>function(e,t,r){if(e.isAuthenticated())return t.getInstance().device.deactivateDevice(r).catch((e=>{const t=new Error(`[SessionController] - deactivateDevice: ${e}`);a.default.log(t),c.sendExceptionLog({error:t})}));return Promise.resolve(null)}(e.storeService,e.sessionService,t),generateAndSavePassword:t=>I(e.storeService,e.sessionService,t),generatePassword:t=>P(e.storeService,t),getAccountInfo:()=>function(e){const t=e.getState(),r=(0,g.premiumStatusSelector)(t);return Promise.resolve({premiumStatus:r})}(e.storeService),getAndTriggerRefreshAccountInfo:()=>h(e.storeService,e.sessionService,e.wsService),getPasswordGenerationSettings:()=>C(e.storeService),getCurrentUserInfo:()=>(0,A.getCurrentUserInfo)(e.storeService),getDevicesList:()=>function(e,t){if(e.isAuthenticated())return t.getInstance().device.fetchDevicesList().catch((e=>(a.default.log("Error while fetching Devices list",e),[])));return Promise.resolve([])}(e.storeService,e.sessionService),getInvoices:()=>function(e,t){if(e.isAuthenticated())return t.getInstance().payment.fetchInvoices().catch((e=>{const t=new Error(`[SessionController] - getInvoices: ${e}`);return a.default.log(t),c.sendExceptionLog({error:t}),null}));return Promise.resolve(null)}(e.storeService,e.sessionService),getPersonalSettings:()=>{return t=e.storeService,Promise.resolve(t.getPersonalSettings());var t},getUki:()=>{return t=e.storeService,{uki:(0,m.ukiSelector)(t.getState())};var t},isSaveCredentialDisabled:t=>(0,u.isSaveCredentialDisabledOnDomain)(e.storeService,t),signalSaveCredentialDisabled:t=>(0,u.signalSaveCredentialDisabled)(e.storeService,e.sessionService,t),resumeSession:()=>_(e.storeService,e.storageService,e.sessionService,e.wsService),saveGeneratedPassword:(t,r)=>D(e.storeService,e.sessionService,t,r),sessionForceSync:(t=o.Trigger.Manual)=>T(e.sessionService,t),updateCardToken:(t,r)=>async function(e,t,r,o,n){try{if(!e.isAuthenticated())return;const{payment:a}=t.getInstance(),s=await a.updatePaymentCard(o,n);i.updatePaymentCardTokenResult(s),v(e,t,r).catch((e=>{}))}catch(e){const t=e.message,r=new Error(`[SessionController] - updateCardToken: ${e}`);a.default.log(r),c.sendExceptionLog({error:r}),i.updatePaymentCardTokenResult({success:!1,reason:t})}}(e.storeService,e.sessionService,e.wsService,t,r),validateMasterPassword:t=>(0,y.validateMasterPassword)(e.storeService,e.masterPasswordEncryptorService,t)});const E={premiumStatus:{statusCode:null}};async function h(e,t,r){if(!e.isAuthenticated())return E;try{const o=await v(e,t,r);return o.accountInfo}catch(t){a.default.error("Error during getRefreshedAccountInfo",t);const r=(0,g.premiumStatusSelector)(e.getState()),o=r?{premiumStatus:r}:{};return{...E,...o}}}async function v(e,t,r){const{user:o}=t.getInstance(),n=(0,l.refreshPremiumStatus)(e,r,e.getUserLogin(),(0,m.ukiSelector)(e.getState())).then((()=>({premiumStatus:e.getLocalSettings().premiumStatus,nodePremiumStatusSpaceData:(0,f.getNodePremiumStatusSpaceData)(e)})));try{await o.fetchAccountInfo()}catch(e){(0,a.logError)(e),c.sendExceptionLog({error:e})}const i=await n,{premiumStatus:s,nodePremiumStatusSpaceData:d}=i;if(!s)throw new Error("premium info should exist");return{accountInfo:{premiumStatus:s},nodePremiumStatusSpaceData:d}}async function T(e,t=o.Trigger.Manual){await e.getInstance().user.attemptSync(t)}function _(e,t,r,o){return(0,p.triggerABTestingChanged)(e.getABTesting()),i.sendLocationInfo(e.getPlatform().location),e.isAuthenticated()?h(e,r,o).then((()=>(i.triggerSessionOpened(e,t),!0))):Promise.resolve(null)}function I(e,t,r){return d.generateAndSavePassword(e,t,r)}function C(e){return d.getDefaultPasswordGenerationSettings(e.getPersonalSettings())}function P(e,t){return d.generatePassword(e.getPersonalSettings(),t)}function D(e,t,r,o){return d.saveGeneratedPassword(e,t,r,o)}function O(e,t){return(0,s.getWebsiteInfo)(e,t)}t.getAndTriggerRefreshAccountInfo=h,t.sessionForceSync=T,t.resumeSession=_,t.generateAndSavePassword=I,t.getPasswordGenerationSettings=C,t.generatePassword=P,t.saveGeneratedPassword=D,t.askWebsiteInfo=O,t.AutofillProtectionStatus=(0,n.Enum)("UNPROTECTED","LOCKED","UNLOCKED"),t.refeshAccountInfo=function(e,t,r){v(e,t,r).catch((e=>{}))}},66833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFreshSpaceData=t.updateCurrentSpaceWith=t.updateSpaceData=t.refreshSpaceData=void 0;const o=r(36738),n=r(28096);function a(e,t){const r={spaces:t};e.dispatch((0,o.spaceDataUpdated)(r)),(0,n.reportDataUpdate)(e)}function i(e){return(e||[]).map((e=>({teamId:e.teamId,details:e})))}t.refreshSpaceData=function(e,t){const r=i(t);return a(e,r),Promise.resolve(r)},t.updateSpaceData=a,t.updateCurrentSpaceWith=function(e,t){const r=e.getSpaceData().spaces.map((e=>"accepted"===e.details.status?t(e):e));a(e,r)},t.getFreshSpaceData=i},16661:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearIconsCache=t.IconsCacheLoaded=t.iconsRefreshed=t.iconsUpdated=t.ICONS_CACHE_EMPTY=t.ICONS_CACHE_LOADED=t.ICONS_REFRESHED=t.ICONS_UPDATED=void 0,t.ICONS_UPDATED="ICONS_UPDATED",t.ICONS_REFRESHED="ICONS_REFRESHED",t.ICONS_CACHE_LOADED="ICONS_CACHE_LOADED",t.ICONS_CACHE_EMPTY="ICONS_CACHE_EMPTY";t.iconsUpdated=e=>({type:t.ICONS_UPDATED,data:e});t.iconsRefreshed=e=>({type:t.ICONS_REFRESHED,data:e});t.IconsCacheLoaded=e=>({type:t.ICONS_CACHE_LOADED,data:e});t.clearIconsCache=()=>({type:t.ICONS_CACHE_EMPTY})},19695:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iconsFromStorage=t.iconsToStorage=void 0;t.iconsToStorage=e=>({...e,domains:Array.from(e.domains.entries())});t.iconsFromStorage=e=>({...e,domains:new Map(e.domains)})},58174:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyIconByDomains=void 0;const o=r(16661),n=r(53),a=r(46445);function i(e,t){const r=t.filter((e=>!!e.domain));if(!r.length)return e;const o=new Map;let n=!1;for(const t of r){const{domain:r,...i}=t,s=(0,a.computeHashMD5)(r);e.get(s)||(n=!0,o.set(s,i))}return n?new Map([...e,...o]):e}function s(){return{domains:new Map,lastUpdateTimeSeconds:0}}t.getEmptyIconByDomains=s,t.default=(e=s(),t)=>{switch(t.type){case o.ICONS_UPDATED:{const r=i(e.domains,t.data);return e.domains!==r?{...e,domains:r}:e}case o.ICONS_REFRESHED:return{...e,domains:i(e.domains,t.data),lastUpdateTimeSeconds:(0,n.getUnixTimestamp)()};case o.ICONS_CACHE_LOADED:return t.data;case o.ICONS_CACHE_EMPTY:return s();default:return e}}},43416:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadedStoredUserABTests=t.refreshedUserABTests=t.SENT_AB_TEST_USAGE_LOG=t.STORED_USER_AB_TEST_LOADED=t.USER_AB_TESTS_UPDATED=void 0,t.USER_AB_TESTS_UPDATED="USER_AB_TEST_UPDATED",t.STORED_USER_AB_TEST_LOADED="STORED_USER_AB_TEST_LOADED",t.SENT_AB_TEST_USAGE_LOG="SENT_AB_TEST_USAGE_LOG";t.refreshedUserABTests=e=>({type:t.USER_AB_TESTS_UPDATED,lastUpdateTimestamp:Date.now(),tests:e});t.loadedStoredUserABTests=e=>({type:t.STORED_USER_AB_TEST_LOADED,userABTests:e})},1678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyTests=void 0;const o=r(43416);function n(){return{lastUpdateTimestamp:null,tests:{}}}t.getEmptyTests=n,t.default=(e={lastUpdateTimestamp:null,tests:{}},t)=>{switch(t.type){case o.USER_AB_TESTS_UPDATED:return{...e,tests:t.tests,lastUpdateTimestamp:t.lastUpdateTimestamp};case o.STORED_USER_AB_TEST_LOADED:return{...e,...t.userABTests};default:return e}}},62627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userABTestVariantSelector=t.userABTestSelector=t.userABTestsSelector=void 0;t.userABTestsSelector=e=>e.userSession.abTests;t.userABTestSelector=(e,r)=>(0,t.userABTestsSelector)(e).tests[r];t.userABTestVariantSelector=(e,r)=>{const o=(0,t.userABTestSelector)(e,r);return o?o.variant:void 0}},18862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountContactInfoRefreshed=t.saveAccountContactInfo=t.ACCOUNT_CONTACT_INFO_REFRESHED=t.SAVE_ACCOUNT_CONTACT_INFO=void 0,t.SAVE_ACCOUNT_CONTACT_INFO="SAVE_ACCOUNT_CONTACT_INFO",t.ACCOUNT_CONTACT_INFO_REFRESHED="ACCOUNT_CONTACT_INFO_REFRESHED";t.saveAccountContactInfo=e=>({type:t.SAVE_ACCOUNT_CONTACT_INFO,accountContactInfo:e});t.accountContactInfoRefreshed=e=>({type:t.ACCOUNT_CONTACT_INFO_REFRESHED,accountContactInfo:e})},39727:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(18862);t.default=(e={},t)=>{switch(t.type){case o.SAVE_ACCOUNT_CONTACT_INFO:case o.ACCOUNT_CONTACT_INFO_REFRESHED:return{...e,...t.accountContactInfo};default:return e}}},43461:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountCreationStarted=t.saveAccountKeys=t.saveAccountSettings=t.ACCOUNT_CREATION_STARTED=t.SAVE_ACCOUNT_KEYS=t.SAVE_ACCOUNT_SETTINGS=void 0,t.SAVE_ACCOUNT_SETTINGS="SAVE_ACCOUNT_SETTINGS",t.SAVE_ACCOUNT_KEYS="SAVE_ACCOUNT_KEYS",t.ACCOUNT_CREATION_STARTED="ACCOUNT_CREATION_STARTED",t.saveAccountSettings=function(e){return{type:t.SAVE_ACCOUNT_SETTINGS,settings:e}},t.saveAccountKeys=function(e){return{type:t.SAVE_ACCOUNT_KEYS,accountKey:e}},t.accountCreationStarted=function(e){return{type:t.ACCOUNT_CREATION_STARTED,isSSO:e.isSSO}}},12659:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAccountCreation=void 0;const o=r(43461),n=r(95648);function a(){return{settings:{personalSettings:(0,n.getEmptyPersonalSettings)(),promise:null},accountKey:{promise:null},isSSO:!1}}t.default=(e=a(),t)=>{switch(t.type){case o.SAVE_ACCOUNT_SETTINGS:return{...e,settings:{...t.settings,personalSettings:(0,n.getUpdatedPersonalSettings)(e.settings.personalSettings,t.settings.personalSettings)}};case o.SAVE_ACCOUNT_KEYS:return{...e,accountKey:t.accountKey};case o.ACCOUNT_CREATION_STARTED:return{...a(),isSSO:t.isSSO};default:return e}},t.getEmptyAccountCreation=a},12706:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSSOAccountCreationSelector=void 0;t.isSSOAccountCreationSelector=e=>e.userSession.accountCreation.isSSO},59489:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storeAccountAuthenticationType=t.setPasswordLeaked=t.saveSubscriptionCode=t.localDataLoaded=t.userAuthenticationFailed=t.confirmUserAuthentication=t.enableOtp=t.SET_ACCOUNT_TYPE=t.USER_AUTHENTICATION_FAILED=t.SET_PASSWORD_LEAKED=t.SAVE_SUBSCRIPTION_CODE=t.LOCAL_DATA_LOADED=t.CONFIRM_USER_AUTHENTICATION=t.ENABLE_OTP=void 0;const o=r(25576);t.ENABLE_OTP="ENABLE_OTP",t.CONFIRM_USER_AUTHENTICATION="CONFIRM_USER_AUTHENTICATION",t.LOCAL_DATA_LOADED="LOCAL_DATA_LOADED",t.SAVE_SUBSCRIPTION_CODE="SAVE_SUBSCRIPTION_CODE",t.SET_PASSWORD_LEAKED="SET_PASSWORD_LEAKED",t.USER_AUTHENTICATION_FAILED="USER_AUTHENTICATION_FAILED",t.SET_ACCOUNT_TYPE="SET_ACCOUNT_TYPE";t.enableOtp=e=>({type:t.ENABLE_OTP,otpType:e});t.confirmUserAuthentication=()=>({type:t.CONFIRM_USER_AUTHENTICATION,sessionStartTime:Date.now()});t.userAuthenticationFailed=()=>({type:t.USER_AUTHENTICATION_FAILED});t.localDataLoaded=()=>({type:t.LOCAL_DATA_LOADED,persistData:o.PersistData.PERSIST_DATA_YES});t.saveSubscriptionCode=e=>({type:t.SAVE_SUBSCRIPTION_CODE,code:e});t.setPasswordLeaked=e=>({type:t.SET_PASSWORD_LEAKED,isPasswordLeaked:e});t.storeAccountAuthenticationType=e=>({type:t.SET_ACCOUNT_TYPE,accountAuthenticationType:e})},86797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAccount=t.OtpType=void 0;const o=r(48313),n=r(43739),a=r(59489);var i;function s(){return{login:null,isAuthenticated:!1,sessionStartTime:null,persistData:null,otpType:i.NO_OTP,isPasswordLeaked:!1,accountAuthenticationType:"masterPassword"}}!function(e){e[e.NO_OTP=0]="NO_OTP",e[e.OTP_NEW_DEVICE=1]="OTP_NEW_DEVICE",e[e.OTP_LOGIN=2]="OTP_LOGIN"}(i=t.OtpType||(t.OtpType={})),t.getEmptyAccount=s,t.default=(e=s(),t)=>{switch(t.type){case o.OPEN_SESSION:return{...e,login:t.login};case n.DEVICE_REGISTERED:case a.LOCAL_DATA_LOADED:return{...e,persistData:t.persistData};case a.CONFIRM_USER_AUTHENTICATION:return{...e,isAuthenticated:!0,sessionStartTime:t.sessionStartTime};case a.USER_AUTHENTICATION_FAILED:return{...e,isAuthenticated:!1,sessionStartTime:null};case a.ENABLE_OTP:return{...e,otpType:t.otpType};case a.SAVE_SUBSCRIPTION_CODE:return{...e,subscriptionCode:t.code};case a.SET_PASSWORD_LEAKED:return{...e,isPasswordLeaked:t.isPasswordLeaked};case a.SET_ACCOUNT_TYPE:return{...e,accountAuthenticationType:t.accountAuthenticationType};default:return e}}},25421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.accountAuthenticationTypeSelector=void 0;t.accountAuthenticationTypeSelector=e=>e.userSession.account.accountAuthenticationType},48313:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyTransactions=t.premiumStatusUpdated=t.localSettingsUpdated=t.closeSession=t.openSession=t.saveGeneratedPassword=t.savePersonalDataItems=t.savePersonalDataItem=t.SAVE_PERSONAL_ITEMS=t.SAVE_PERSONAL_ITEM=t.SAVE_GENERATED_PASSWORD=t.PREMIUM_STATUS_UPDATED=t.LOCAL_SETTINGS_UPDATED=t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION=t.ADD_PERSONAL_ITEM_FROM_TRANSACTION=t.CHANGES_FROM_TRANSACTIONS=t.CLOSE_SESSION=t.OPEN_SESSION=void 0;const o=r(45127),n=r(27517);t.OPEN_SESSION="OPEN_SESSION",t.CLOSE_SESSION="CLOSE_SESSION",t.CHANGES_FROM_TRANSACTIONS="CHANGES_FROM_TRANSACTIONS",t.ADD_PERSONAL_ITEM_FROM_TRANSACTION="ADD_PERSONAL_ITEM_FROM_TRANSACTION",t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION="REMOVE_PERSONAL_ITEM_FROM_TRANSACTION",t.LOCAL_SETTINGS_UPDATED="LOAD_STORED_LOCAL_SETTINGS",t.PREMIUM_STATUS_UPDATED="PREMIUM_STATUS_UPDATED",t.SAVE_GENERATED_PASSWORD="SAVE_GENERATED_PASSWORD",t.SAVE_PERSONAL_ITEM="SAVE_PERSONAL_ITEM",t.SAVE_PERSONAL_ITEMS="SAVE_PERSONAL_ITEMS",t.savePersonalDataItem=function(e,r,n){return{type:t.SAVE_PERSONAL_ITEM,dataType:o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],dataModelObject:e,changeHistory:n}},t.savePersonalDataItems=function(e,r,n){return{type:t.SAVE_PERSONAL_ITEMS,dataType:o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],dataModelObjects:e,changeHistory:n}},t.saveGeneratedPassword=function(e){return{type:t.SAVE_GENERATED_PASSWORD,generatedPassword:e}};t.openSession=e=>({type:t.OPEN_SESSION,login:e});t.closeSession=()=>({type:t.CLOSE_SESSION});t.localSettingsUpdated=e=>({type:t.LOCAL_SETTINGS_UPDATED,data:Object.assign({},e)});t.premiumStatusUpdated=e=>({type:t.PREMIUM_STATUS_UPDATED,premiumStatus:e});t.applyTransactions=e=>{const r=e.map((e=>{let r;return r="SETTINGS"===e.type?n.PersonalSettingsActionType.EditFromTransaction:"BACKUP_REMOVE"===e.action?t.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION:t.ADD_PERSONAL_ITEM_FROM_TRANSACTION,"BACKUP_EDIT"===e.action&&e.content&&(e.content.LastBackupTime=Math.floor(e.backupDate/1e3)),{type:r,itemId:e.identifier,content:e.content}}));return{type:t.CHANGES_FROM_TRANSACTIONS,actions:r}}},42282:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetAuthTicketInfo=t.updateAuthTicketInfo=void 0;const o=r(4190);t.updateAuthTicketInfo=e=>({type:o.ADD_AUTH_TICKET_DATA,data:e});t.resetAuthTicketInfo=()=>({type:o.RESET_AUTH_TICKET_DATA})},78663:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyAuthTicketInfo=void 0;const o=r(4190);t.getEmptyAuthTicketInfo=()=>({login:null,date:0,authTicket:null}),t.default=(e=(0,t.getEmptyAuthTicketInfo)(),r)=>{switch(r.type){case o.ADD_AUTH_TICKET_DATA:return{...e,...r.data};case o.RESET_AUTH_TICKET_DATA:return{...e,...(0,t.getEmptyAuthTicketInfo)()};default:return e}}},4190:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RESET_AUTH_TICKET_DATA=t.ADD_AUTH_TICKET_DATA=void 0,t.ADD_AUTH_TICKET_DATA="ADD_AUTH_TICKET_DATA",t.RESET_AUTH_TICKET_DATA="RESET_AUTH_TICKET_DATA"},28417:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blacklistedUserSessionKeys=void 0,t.blacklistedUserSessionKeys=["iconsCache","personalData","teamAdminData","sharingSync","sharingData"]},87838:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachRefreshTimestamp=t.UPDATE_BREACHES_REFRESH_TIMESTAMP=void 0,t.UPDATE_BREACHES_REFRESH_TIMESTAMP="UPDATE_BREACHES_REFRESH_TIMESTAMP";t.updateBreachRefreshTimestamp=e=>({type:t.UPDATE_BREACHES_REFRESH_TIMESTAMP,lastBreachRefreshTimestamp:e})},99800:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.breachRefreshMetaDataReducer=t.getEmptyBreachRefreshMetadata=void 0;const o=r(87838);t.getEmptyBreachRefreshMetadata=()=>({lastBreachRefreshTimestamp:0});t.breachRefreshMetaDataReducer=(e=(0,t.getEmptyBreachRefreshMetadata)(),r)=>r.type===o.UPDATE_BREACHES_REFRESH_TIMESTAMP?{lastBreachRefreshTimestamp:r.lastBreachRefreshTimestamp}:e},16194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeMPDone=t.changeMPStart=t.SET_CHANGE_MP_DONE=t.SET_CHANGE_MP_START=void 0,t.SET_CHANGE_MP_START="SET_CHANGE_MP_START",t.SET_CHANGE_MP_DONE="SET_CHANGE_MP_DONE";t.changeMPStart=()=>({type:t.SET_CHANGE_MP_START});t.changeMPDone=()=>({type:t.SET_CHANGE_MP_DONE})},66403:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyChangeMPData=void 0;const o=r(16194);function n(){return{changeMPinProgress:!1}}t.getEmptyChangeMPData=n,t.default=(e={changeMPinProgress:!1},t)=>{switch(t.type){case o.SET_CHANGE_MP_START:return{...e,changeMPinProgress:!0};case o.SET_CHANGE_MP_DONE:return{...e,changeMPinProgress:!1};default:return e}}},66417:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPUpdatedAction=t.CREDENTIAL_OTP_UPDATED=void 0,t.CREDENTIAL_OTP_UPDATED="CREDENTIAL_OTP_UPDATED";t.credentialOTPUpdatedAction=(e,r)=>({type:t.CREDENTIAL_OTP_UPDATED,credentialId:e,otp:r})},11406:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPUpdatedAction=t.credentialOTPs=void 0;var o=r(27547);Object.defineProperty(t,"credentialOTPs",{enumerable:!0,get:function(){return o.credentialOTPs}});var n=r(66417);Object.defineProperty(t,"credentialOTPUpdatedAction",{enumerable:!0,get:function(){return n.credentialOTPUpdatedAction}})},27547:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialOTPs=void 0,t.credentialOTPs=function(e={},t){return"CREDENTIAL_OTP_UPDATED"===t.type?{...e,[t.credentialId]:t.otp}:e}},67331:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsDedupViewUpdated=void 0;const o=r(28142);t.credentialsDedupViewUpdated=e=>({type:o.CREDENTIAL_DEDUP_VIEW_UPDATED,credentialsDedupView:e})},81200:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialsDedupViewReducer=t.getDefaultCredentialsDedupView=void 0;const o=r(28142);function n(){return{credentialsDedupView:!1}}t.getDefaultCredentialsDedupView=n,t.credentialsDedupViewReducer=function(e={credentialsDedupView:!1},t){return t.type===o.CREDENTIAL_DEDUP_VIEW_UPDATED?{...e,...t.credentialsDedupView}:e}},28142:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CREDENTIAL_DEDUP_VIEW_UPDATED=void 0,t.CREDENTIAL_DEDUP_VIEW_UPDATED="CREDENTIAL_DEDUP_VIEW_UPDATED"},19478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.teamDirectorySyncNotInProgress=t.teamDirectorySyncInProgress=t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS=t.TEAM_DIRECTORY_SYNC_IN_PROGRESS=void 0,t.TEAM_DIRECTORY_SYNC_IN_PROGRESS="TEAM_DIRECTORY_SYNC_IN_PROGRESS",t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS="TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS";t.teamDirectorySyncInProgress=e=>({type:t.TEAM_DIRECTORY_SYNC_IN_PROGRESS,teamId:e});t.teamDirectorySyncNotInProgress=e=>({type:t.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS,teamId:e})},48005:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTeamDirectorySyncInProgress=t.getEmptyState=void 0;const o=r(19478);function n(){return{syncsInProgress:{}}}t.getEmptyState=n,t.isTeamDirectorySyncInProgress=function(e,t){return e.syncsInProgress[t]},t.default=(e={syncsInProgress:{}},t)=>{switch(t.type){case o.TEAM_DIRECTORY_SYNC_IN_PROGRESS:const{teamId:r}=t;return{...e,syncsInProgress:{...e.syncsInProgress,[r]:!0}};case o.TEAM_DIRECTORY_SYNC_NOT_IN_PROGRESS:const{teamId:n}=t;return{...e,syncsInProgress:{...e.syncsInProgress,[n]:!1}};default:return e}}},85845:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFileMetaAction=t.updateFileContentAction=t.updateFileMetaAction=t.FileActionsType=void 0,function(e){e.UpdateFileMeta="UPDATE_FILE_META",e.UpdateFileContent="UPDATE_FILE_CONTENT",e.DeleteFileMeta="DELETE_FILE_META"}(r=t.FileActionsType||(t.FileActionsType={}));t.updateFileMetaAction=e=>({type:r.UpdateFileMeta,filesMeta:e});t.updateFileContentAction=e=>({type:r.UpdateFileContent,filesContent:e});t.deleteFileMetaAction=e=>({type:r.DeleteFileMeta,fileNames:e})},75417:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.remoteFileReducer=t.defaultRemoteFileState=void 0;const o=r(85845);function n(e,t){const r={...e};for(const e of t)e in r&&delete r[e];return r}t.defaultRemoteFileState=()=>({fileMetaData:{files:{}},fileContentState:{}});t.remoteFileReducer=(e=(0,t.defaultRemoteFileState)(),r)=>{switch(r?.type){case o.FileActionsType.UpdateFileMeta:return((e,t)=>({...e,fileMetaData:{files:{...e.fileMetaData.files,...t.filesMeta}}}))(e,r);case o.FileActionsType.UpdateFileContent:return((e,t)=>({...e,fileContentState:{...e.fileContentState,...t.filesContent}}))(e,r);case o.FileActionsType.DeleteFileMeta:return((e,t)=>({...e,fileMetaData:{files:n(e.fileMetaData.files,t.fileNames)}}))(e,r)}return e}},6093:(e,t)=>{function r(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e.toLowerCase()||"yes"===e.toLowerCase():Boolean(e)}function o(e,t){return"boolean"===t?e?"true":"false":"yes-no"===t?e?"YES":"NO":null}function n(e){return"object"==typeof e?e:JSON.parse(e)}function a(e){return JSON.stringify(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.fixProperties=t.fixPropertiesTypes=t.ObjectToJson=t.jsonToObject=t.booleanToString=t.stringToBoolean=void 0,t.stringToBoolean=r,t.booleanToString=o,t.jsonToObject=n,t.ObjectToJson=a,t.fixPropertiesTypes=function(e,t,o,a,i){const s={};return e.filter((e=>!!i[e])).forEach((e=>{s[e]=r(i[e])})),t.filter((e=>!!i[e])).forEach((e=>{s[e]=Number(i[e])})),o.filter((e=>!!i[e])).forEach((e=>{s[e]=n(i[e])})),a.filter((e=>i.hasOwnProperty(e))).forEach((e=>{const t=i[e];s[e]=null===t?"":String(t)})),Object.assign({},i,s)},t.fixProperties={fromStore:function(e,t,r,n){const i={};return Object.keys(e).filter((e=>!!n[e])).forEach((t=>{i[t]=o(n[t],e[t])})),Object.keys(t).filter((e=>!!n[e])).forEach((e=>{i[e]=n[e]&&n[e].toString()})),Object.keys(r).filter((e=>!!n[e])).forEach((e=>{i[e]=a(n[e])})),Object.assign({},n,i)},fromTransaction:function(e,t,o,a){const i={};return Object.keys(e).filter((e=>!!a[e])).forEach((e=>{i[e]=r(a[e])})),Object.keys(t).filter((e=>!!a[e])).forEach((e=>{i[e]=Number(a[e])})),Object.keys(o).filter((e=>!!a[e])).forEach((e=>{i[e]=n(a[e])})),Object.assign({},a,i)}}},76089:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.credentialSearchOrderUpdated=t.premiumChurningDismissDateUpdated=t.webOnboardingModeUpdated=t.localSettingsSubscriptionInformationStatusUpdated=t.localSettingsNodePremiumStatusUpdated=t.localSettingsPremiumStatusUpdated=t.registerDeviceName=t.registerLastSync=t.loadStoredLocalSettings=t.CREDENTIAL_SEARCH_ORDER_UPDATED=t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED=t.WEB_ONBOARDING_MODE_RESET=t.WEB_ONBOARDING_MODE_UPDATED=t.SUBSCRIPTION_INFORMATION_UPDATED=t.NODE_PREMIUM_STATUS_UPDATED=t.PREMIUM_STATUS_UPDATED=t.REGISTER_DEVICE_NAME=t.REGISTER_LAST_SYNC=t.LOAD_STORED_LOCAL_SETTINGS=void 0,t.LOAD_STORED_LOCAL_SETTINGS="LOCAL_SETTINGS/LOAD_STORED_LOCAL_SETTINGS",t.REGISTER_LAST_SYNC="LOCAL_SETTINGS/REGISTER_LAST_SYNC",t.REGISTER_DEVICE_NAME="LOCAL_SETTINGS/REGISTER_DEVICE_NAME",t.PREMIUM_STATUS_UPDATED="LOCAL_SETTINGS/PREMIUM_STATUS_UPDATED",t.NODE_PREMIUM_STATUS_UPDATED="LOCAL_SETTINGS/NODE_PREMIUM_STATUS_UPDATED",t.SUBSCRIPTION_INFORMATION_UPDATED="LOCAL_SETTINGS/SUBSCRIPTION_INFORMATION_UPDATED",t.WEB_ONBOARDING_MODE_UPDATED="LOCAL_SETTINGS/WEB_ONBOARDING_MODE_UPDATED",t.WEB_ONBOARDING_MODE_RESET="LOCAL_SETTINGS/WEB_ONBOARDING_MODE_RESET",t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED="PREMIUM_CHURNING_DISMISS_DATE_UPDATED",t.CREDENTIAL_SEARCH_ORDER_UPDATED="CREDENTIAL_SEARCH_ORDER_UPDATED";t.loadStoredLocalSettings=e=>({type:t.LOAD_STORED_LOCAL_SETTINGS,data:Object.assign({},e)});t.registerLastSync=e=>({type:t.REGISTER_LAST_SYNC,lastSync:e});t.registerDeviceName=e=>({type:t.REGISTER_DEVICE_NAME,deviceName:e});t.localSettingsPremiumStatusUpdated=e=>({type:t.PREMIUM_STATUS_UPDATED,premiumStatus:e});t.localSettingsNodePremiumStatusUpdated=e=>({type:t.NODE_PREMIUM_STATUS_UPDATED,nodePremiumStatus:e});t.localSettingsSubscriptionInformationStatusUpdated=e=>({type:t.SUBSCRIPTION_INFORMATION_UPDATED,subscriptionInformation:e});t.webOnboardingModeUpdated=e=>({type:t.WEB_ONBOARDING_MODE_UPDATED,webOnboardingMode:e});t.premiumChurningDismissDateUpdated=e=>({type:t.PREMIUM_CHURNING_DISMISS_DATE_UPDATED,premiumChurningDismissDate:e});t.credentialSearchOrderUpdated=e=>({type:t.CREDENTIAL_SEARCH_ORDER_UPDATED,credentialSearchOrder:e})},73472:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyLocalSettings=t.getEmptyOnboardingMode=t.getEmptyLoginStepInfo=void 0;const o=r(62433),n=r(45127),a=r(35924),i=r(76089),s=r(65210),c=r(43739);function d(){return{step:null,login:"",validated:!1}}t.getEmptyLoginStepInfo=d;const l=(e,t)=>[n.LoginStep.Password,n.LoginStep.OTPToken].includes(t)?t:e.step,u=(e,t)=>t===n.LoginStep.OTPToken?Boolean(e.login):![n.LoginStep.OTP1,n.LoginStep.OTP2].includes(t)&&e.validated,p=(e,t)=>Object.entries(t).every((([t,r])=>e?.[t]===r));t.default=(e=S(),t)=>{switch(t.type){case i.LOAD_STORED_LOCAL_SETTINGS:{const r=S();return{...r,...e,...t.data,webOnboardingMode:{...r.webOnboardingMode,...e.webOnboardingMode,...t.data.webOnboardingMode,completedSteps:{...r.webOnboardingMode.completedSteps,...e.webOnboardingMode.completedSteps,...t.data.webOnboardingMode.completedSteps}}}}case c.DEVICE_REGISTERED:return"uki"===t.registrationType.type?{...e,uki:t.registrationType.uki}:e;case i.REGISTER_LAST_SYNC:return Object.assign({},e,{lastSync:t.lastSync});case i.REGISTER_DEVICE_NAME:return Object.assign({},e,{deviceName:t.deviceName});case i.PREMIUM_STATUS_UPDATED:return Object.assign({},e,{premiumStatus:t.premiumStatus});case i.NODE_PREMIUM_STATUS_UPDATED:return Object.assign({},e,{nodePremiumStatus:t.nodePremiumStatus});case i.SUBSCRIPTION_INFORMATION_UPDATED:return Object.assign({},e,{subscriptionInformation:t.subscriptionInformation});case i.WEB_ONBOARDING_MODE_UPDATED:{const r=(0,o.mergeDeepRight)(S(),e);return(0,o.mergeDeepRight)(r,{webOnboardingMode:t.webOnboardingMode})}case i.PREMIUM_CHURNING_DISMISS_DATE_UPDATED:return Object.assign({},e,{premiumChurningDismissDate:t.premiumChurningDismissDate});case i.CREDENTIAL_SEARCH_ORDER_UPDATED:return Object.assign({},e,{credentialSearchOrder:t.credentialSearchOrder});case s.USER_MESSAGE_ADDED:return Object.assign({},e,{userMessages:[...e.userMessages,t.userMessage]});case s.USER_MESSAGES_DISMISSED:return Object.assign({},e,{userMessages:e.userMessages.some((e=>p(e,t.predicate)))?e.userMessages.map((e=>p(e,t.predicate)?{...e,dismissedAt:Date.now()}:e)):[...e.userMessages,{...t.predicate,dismissedAt:Date.now()}]});case a.UPDATE_LOGIN_STEP_INFO_LOGIN:return Object.assign({},e,{loginStepInfo:{...e.loginStepInfo,login:t.login}});case a.UPDATE_LOGIN_STEP_INFO_STEP:return Object.assign({},e,{loginStepInfo:{...e.loginStepInfo,step:l(e.loginStepInfo,t.step),validated:u(e.loginStepInfo,t.step)}});case a.RESET_LOGIN_STEP_INFO:return Object.assign({},e,{loginStepInfo:{step:null,login:"",validated:!1}});default:return e}};function S(){return{uki:null,lastSync:0,premiumStatus:null,nodePremiumStatus:null,subscriptionInformation:null,deviceName:null,webOnboardingMode:(0,t.getEmptyOnboardingMode)(),premiumChurningDismissDate:null,credentialSearchOrder:null,userMessages:[],loginStepInfo:{step:null,login:"",validated:!1}}}t.getEmptyOnboardingMode=()=>({flowCredentialInApp:!1,flowLoginCredentialOnWeb:!1,flowLoginCredentialOnWebSite:null,flowSaveCredentialOnWeb:!1,flowImportPasswords:!1,flowAddMobileOnWeb:!1,flowTryAutofillOnWeb:!1,leelooStep:null,popoverStep:null,completedSteps:{saveCredentialInApp:!1,loginCredentialOnWeb:!1,saveCredentialOnWeb:!1,importPasswordsShown:!1,onboardingHubShown:!1,addMobileOnWeb:!1,tryAutofillOnWeb:!1}}),t.getEmptyLocalSettings=S},73299:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deviceNameSelector=void 0;t.deviceNameSelector=e=>e.userSession.localSettings.deviceName},34287:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadNotificationsStatus=t.markAsInteracted=t.markAsUnseen=t.markAsSeen=t.LOAD_NOTIFICATIONS_STATE=t.MARK_AS_INTERACTED=t.MARK_AS_UNSEEN=t.MARK_AS_SEEN=void 0,t.MARK_AS_SEEN="MarkAsSeen",t.MARK_AS_UNSEEN="MarkAsUnseen",t.MARK_AS_INTERACTED="MarkAsInteracted",t.LOAD_NOTIFICATIONS_STATE="LoadNotificationsState";t.markAsSeen=e=>({type:t.MARK_AS_SEEN,notification:e});t.markAsUnseen=e=>({type:t.MARK_AS_UNSEEN,notification:e});t.markAsInteracted=e=>({type:t.MARK_AS_INTERACTED,notification:e});t.loadNotificationsStatus=e=>({type:t.LOAD_NOTIFICATIONS_STATE,state:e})},98496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyNotificationsState=void 0;const o=r(45127),n=r(34287),a={paymentFailureChurned:o.NotificationStatus.Unseen,paymentFailureChurning:o.NotificationStatus.Unseen,switchToMlAnalysisEngine:o.NotificationStatus.Unseen,dWMb2bAutoEnrollTooltip:o.NotificationStatus.Unseen,tacGetTheExtensionBanner:o.NotificationStatus.Unseen,tacEnableAccountRecoveryBanner:o.NotificationStatus.Unseen,tacOnlyOneAdminBanner:o.NotificationStatus.Unseen,tacDarkWebInsightsNewBadge:o.NotificationStatus.Unseen,passwordHistoryBanner:o.NotificationStatus.Unseen,sharingCenterDisabledBanner:o.NotificationStatus.Unseen,accountRecoveryAvailableAdminTooltip:o.NotificationStatus.Unseen,activateInviteLink:o.NotificationStatus.Unseen,mpToSsoMigrationDoneDialog:o.NotificationStatus.Seen};function i(){return a}t.getEmptyNotificationsState=i,t.default=(e=i(),t)=>{switch(t.type){case n.MARK_AS_INTERACTED:return{...e,[t.notification]:o.NotificationStatus.Interacted};case n.MARK_AS_SEEN:return{...e,[t.notification]:o.NotificationStatus.Seen};case n.MARK_AS_UNSEEN:return{...e,[t.notification]:o.NotificationStatus.Unseen};case n.LOAD_NOTIFICATIONS_STATE:return{...e,...t.state};default:return e}}},26972:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsStatus$=void 0;const o=r(18948),n=r(3343),a=r(56857);t.notificationsStatus$=function(){const e=a.notificationsStatusSelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())}},56857:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.notificationsStatusSelector=void 0;t.notificationsStatusSelector=e=>e.userSession.notificationsStatus},95944:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.receivedInvoiceList=t.RECEIVED_INVOICE_LIST=void 0,t.RECEIVED_INVOICE_LIST="RECEIVED_USER_LIST";t.receivedInvoiceList=e=>({type:t.RECEIVED_INVOICE_LIST,invoicesList:e})},70325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyPaymentsState=void 0;const o=r(95944);function n(){return{invoicesList:[]}}t.getEmptyPaymentsState=n,t.default=(e={invoicesList:[]},t)=>t.type===o.RECEIVED_INVOICE_LIST?{...e,invoicesList:t.invoicesList}:e},30467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedQueriedInvoicesSelector=t.searchGetters=t.invoiceMappersSelector=t.invoiceListYearsSelector=t.allInvoicesLengthSelector=t.allInvoicesSelector=void 0;const o=r(66986),n=r(24589),a=r(64455),i=r(82234),s=r(98584);t.allInvoicesSelector=e=>e.userSession.paymentsState.invoicesList;t.allInvoicesLengthSelector=e=>e.userSession.paymentsState.invoicesList.length;t.invoiceListYearsSelector=e=>{const t=e.userSession.paymentsState.invoicesList;if(t.length){const e=t.map((e=>(0,o.fromUnixTime)(e.startDate).getFullYear().toString()));return[...new Set(e)]}return[]};t.invoiceMappersSelector=e=>(0,s.getInvoiceMappers)(),t.searchGetters=[(0,i.stringProp)("amountPaid"),(0,i.stringProp)("planName"),(0,i.stringProp)("startDate"),(0,i.stringProp)("invoiceId"),(0,i.stringProp)("startYear")];const c=(0,a.match)(t.searchGetters),d=(0,n.getQuerySelector)(t.allInvoicesSelector,(()=>c),t.invoiceMappersSelector);t.viewedQueriedInvoicesSelector=(e,t)=>d(e,t)},45291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBreachesUpdaterStatus=t.teamSpaceContentControlApplied=t.storeChangesToUpload=t.breachesUpdated=t.updateLastBackupTime=t.removePersonalItem=t.deleteVaultModuleItemsBulk=t.deleteVaultModuleItem=t.saveGeneratedPassword=t.savePaymentCard=t.unscheduleRemainingChanges=t.clearUploadedChanges=t.scheduleChangesForSync=t.loadStoredPersonalData=t.DELETE_VAULT_MODULE_ITEMS_BULK=t.DELETE_VAULT_MODULE_ITEM=t.UNSCHEDULE_REMAINING_CHANGES=t.CLEAR_UPLOADED_CHANGES=t.SCHEDULE_CHANGES_FOR_SYNC=t.UPDATE_BREACHES_UPDATER_STATUS=t.TEAMSPACE_CONTENT_CONTROLLED=t.STORE_CHANGES_TO_UPLOAD=t.BREACHES_UPDATED=t.UPDATE_LAST_BACKUP_TIME=t.SAVE_PAYMENT_CARD=t.SAVE_PERSONAL_ITEMS=t.SAVE_PERSONAL_ITEM=t.SAVE_GENERATED_PASSWORD=t.LOAD_STORED_PERSONAL_DATA=void 0,t.LOAD_STORED_PERSONAL_DATA="PERSONAL_DATA/LOAD_STORED_PERSONAL_DATA",t.SAVE_GENERATED_PASSWORD="PERSONAL_DATA/SAVE_GENERATED_PASSWORD",t.SAVE_PERSONAL_ITEM="PERSONAL_DATA/SAVE_PERSONAL_ITEM",t.SAVE_PERSONAL_ITEMS="PERSONAL_DATA/SAVE_PERSONAL_ITEMS",t.SAVE_PAYMENT_CARD="SAVE_PAYMENT_CARD",t.UPDATE_LAST_BACKUP_TIME="UPDATE_LAST_BACKUP_TIME",t.BREACHES_UPDATED="BREACHES_UPDATED",t.STORE_CHANGES_TO_UPLOAD="STORE_CHANGES_TO_UPLOAD",t.TEAMSPACE_CONTENT_CONTROLLED="TEAMSPACE_CONTENT_CONTROLLED",t.UPDATE_BREACHES_UPDATER_STATUS="UPDATE_BREACHES_UPDATER_STATUS",t.SCHEDULE_CHANGES_FOR_SYNC="SCHEDULE_CHANGES_FOR_SYNC",t.CLEAR_UPLOADED_CHANGES="CLEAR_UPLOADED_CHANGES",t.UNSCHEDULE_REMAINING_CHANGES="UNSCHEDULE_REMAINING_CHANGES",t.DELETE_VAULT_MODULE_ITEM="DELETE_VAULT_MODULE_ITEM",t.DELETE_VAULT_MODULE_ITEMS_BULK="DELETE_VAULT_MODULE_ITEMS_BULK";t.loadStoredPersonalData=e=>({type:t.LOAD_STORED_PERSONAL_DATA,data:Object.assign({},e)});t.scheduleChangesForSync=()=>({type:t.SCHEDULE_CHANGES_FOR_SYNC});t.clearUploadedChanges=e=>({type:t.CLEAR_UPLOADED_CHANGES,uploadedItemIds:e});function r(e){return{type:t.DELETE_VAULT_MODULE_ITEM,payload:e}}t.unscheduleRemainingChanges=()=>({type:t.UNSCHEDULE_REMAINING_CHANGES}),t.savePaymentCard=function(e){return{type:t.SAVE_PAYMENT_CARD,paymentCard:e}},t.saveGeneratedPassword=function(e){return{type:t.SAVE_GENERATED_PASSWORD,generatedPassword:e}},t.deleteVaultModuleItem=r,t.deleteVaultModuleItemsBulk=function(e){return{type:t.DELETE_VAULT_MODULE_ITEMS_BULK,payload:e}},t.removePersonalItem=function(e,t,o){return r({kwType:e,id:t,changeHistory:o})},t.updateLastBackupTime=function(e,r){return{type:t.UPDATE_LAST_BACKUP_TIME,transactions:e,backupTimeSec:r}},t.breachesUpdated=function(e,r,o){return{type:t.BREACHES_UPDATED,changes:e,revision:r,dataLeaksRefreshDate:o}},t.storeChangesToUpload=function(e){return{type:t.STORE_CHANGES_TO_UPLOAD,changesToUpload:e}},t.teamSpaceContentControlApplied=function(e,r,o){return{type:t.TEAMSPACE_CONTENT_CONTROLLED,updates:e,deletions:r,changeHistories:o}};t.updateBreachesUpdaterStatus=e=>({type:t.UPDATE_BREACHES_UPDATER_STATUS,breachesUpdaterStatus:e})},84977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PERSONAL_DATA_COLLECTIONS_KEYS=void 0;const o=r(45127);t.PERSONAL_DATA_COLLECTIONS_KEYS=Object.keys(o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY).map((e=>o.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[e]))},1347:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.countPersonalDataItems=t.getEmptyBreachesMetadata=t.getLegacyEmptyBreaches=t.saveChangesToUpload=t.breachesUpdated=t.updateCredential=t.updateCredentials=t.updateLastBackupTime=t.saveObjects=t.saveGeneratedPassword=t.savePersonalDataItems=t.savePersonalDataItem=t.savePaymentCard=t.deleteVaultModulePersonalDataItemsBulk=t.deleteVaultModulePersonalDataItem=t.teamSpaceContentControlApplied=t.savePersonalSettings=t.removePersonalItemFromTransaction=t.addPersonalItemFromTransaction=t.getEmptyPersonalDataState=t.reducer=void 0;const o=r(62433),n=r(45127),a=r(84977),i=r(53628),s=r(45291),c=r(77163),d=r(27517),l=r(51064),u=r(62210);function p(){return{addresses:[],bankAccounts:[],changesToUpload:[],changeHistories:[],collections:[],companies:[],credentialCategories:[],credentials:[],driverLicenses:[],emails:[],fiscalIds:[],generatedPasswords:[],idCards:[],identities:[],notes:[],passkeys:[],passports:[],paymentCards:[],paypalAccounts:[],personalWebsites:[],phones:[],secrets:[],securityBreaches:[],securityBreachesMetadata:(0,t.getEmptyBreachesMetadata)(),socialSecurityIds:[],breachesUpdaterStatus:n.BreachesUpdaterStatus.UNKNOWN,secureFileInfo:[]}}t.reducer=(e=p(),t,r)=>{switch(t.type){case s.LOAD_STORED_PERSONAL_DATA:return{...e,...(0,i.fixPersistedPersonalData)(t.data)};case s.DELETE_VAULT_MODULE_ITEM:return E(e,t.payload);case s.DELETE_VAULT_MODULE_ITEMS_BULK:return h(e,t.payload);case s.SAVE_PAYMENT_CARD:return v(e,t);case s.SAVE_PERSONAL_ITEM:return T(e,t,r);case s.SAVE_PERSONAL_ITEMS:return _(e,t,r);case s.SAVE_GENERATED_PASSWORD:return I(e,t,r);case s.CLEAR_UPLOADED_CHANGES:return g(e,t);case s.SCHEDULE_CHANGES_FOR_SYNC:return m(e,t);case s.UNSCHEDULE_REMAINING_CHANGES:return y(e,t);case d.PersonalSettingsActionType.Edit:return A(e);case s.UPDATE_LAST_BACKUP_TIME:return C(e,t);case s.BREACHES_UPDATED:return D(e,t);case s.STORE_CHANGES_TO_UPLOAD:return O(e,t);case s.TEAMSPACE_CONTENT_CONTROLLED:return f(e,t);case s.UPDATE_BREACHES_UPDATER_STATUS:return{...e,breachesUpdaterStatus:t.breachesUpdaterStatus};default:return e}},t.getEmptyPersonalDataState=p;const S=(e,t)=>!e||!t||!n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY.hasOwnProperty(t.kwType);t.addPersonalItemFromTransaction=function(e,t){if(S(t.itemId,t.content))return e;const r=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[t.content.kwType],o=(0,i.fixPersonalDataItemFromExternalSource)(t.content,t.itemId);return{...e,[r]:b(e[r],o)}},t.removePersonalItemFromTransaction=function(e,t){return t.itemId?t.content?M(e,[t.itemId],t.content.kwType):M(e,[t.itemId]):e};const m=(e,t)=>({...e,changesToUpload:e.changesToUpload.map(u.markChangeAsScheduled)}),g=(e,t)=>({...e,changesToUpload:(0,u.filterOutUploadedChanges)(e.changesToUpload,t.uploadedItemIds)}),y=(e,t)=>({...e,changesToUpload:e.changesToUpload.map(u.markChangeAsReadyForNextSync)});function A(e){if(e.changesToUpload.find((e=>"KWSettingsManagerApp"===e.kwType)))return e;const t=(0,l.createUploadChange)({itemId:"SETTINGS_userId",kwType:"KWSettingsManagerApp",action:"EDIT"});return{...e,changesToUpload:[...e.changesToUpload,t]}}function f(e,t){const{updates:r,deletions:o,changeHistories:a}=t,i=r.reduce(((e,t)=>{const{kwType:r}=t,o=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r];return o?{...e,[o]:b(e[o]||[],t)}:e}),e),s=r.map(l.createUploadChangeForItem),c=Object.keys(o).reduce(((e,t)=>M(e,o[t],t)),i),d=Object.keys(o).reduce(((e,t)=>e.concat(o[t].map((0,l.createUploadChangeForDeletion)(t)))),[]),u=w(e.changeHistories,a),p=[...s,...d,...a.map(l.createUploadChangeForItem)];return{...c,changesToUpload:N(e.changesToUpload,p),changeHistories:u}}function E(e,t){const{changeHistory:r,kwType:o,id:n}=t,a=M(e,[n],o),i=(0,l.createUploadChangeForDeletion)(o)(n),s=r?[(0,l.createUploadChangeForItem)(r)]:[],c=s.length?[i,...s]:i,d=r?b(e.changeHistories,r):e.changeHistories,u=N(a.changesToUpload,c);return{...a,changesToUpload:u,changeHistories:d}}function h(e,t){const{kwType:r,items:o}=t,n=M(e,o.map((({id:e})=>e)),r),a=(0,l.createUploadChangeForDeletion)(r),i=o.reduce(((e,{id:t,changeHistory:r})=>{const o=a(t);if(e.changesToUpload.push(o),r){const t=(0,l.createUploadChangeForItem)(r);e.changesToUpload.push(t),e.changeHistories=b(e.changeHistories,r)}return e}),{changesToUpload:[],changeHistories:e.changeHistories}),s=N(n.changesToUpload,i.changesToUpload);return{...n,changesToUpload:s,changeHistories:i.changeHistories}}function v(e,{paymentCard:t}){return{...e,changesToUpload:N(e.changesToUpload,(0,l.createUploadChangeForItem)(t)),paymentCards:b(e.paymentCards,t)}}function T(e,{dataType:t,dataModelObject:r,changeHistory:o},n){const a=(0,c.associateTeamSpaceId)(r,n.spaces,e.credentials),i=o?{changeHistories:b(e.changeHistories,o)}:{},s=o?[(0,l.createUploadChangeForItem)(o)]:[],d=[(0,l.createUploadChangeForItem)(r),...s];return{...e,changesToUpload:N(e.changesToUpload,d),[t]:b(e[t],a),...i}}function _(e,{dataType:t,dataModelObjects:r,changeHistory:o},n){const a=r.map((t=>(0,c.associateTeamSpaceId)(t,n.spaces,e.credentials))),i=[...r.map(l.createUploadChangeForItem),...o.map(l.createUploadChangeForItem)];return{...e,changesToUpload:N(e.changesToUpload,i),[t]:w(e[t],a),changeHistories:w(e.changeHistories,o)}}function I(e,{generatedPassword:t},r){const o=(0,c.associateTeamSpaceId)(t,r.spaces,e.credentials);return{...e,changesToUpload:N(e.changesToUpload,(0,l.createUploadChangeForItem)(t)),generatedPasswords:b(e.generatedPasswords,o)}}function C(e,{transactions:t,backupTimeSec:r}){return Object.keys(e).reduce(((o,n)=>(Array.isArray(e[n])&&(o[n]=function(e,t,r){const o=e.filter((e=>t.includes(e.Id))).map((e=>Object.assign(e,{LastBackupTime:r})));return e.filter((e=>!t.includes(e.Id))).concat(o)}(e[n],t,r)),o)),e)}function P(e,t){const{credentials:r}=e,o=b(r,t);return{...e,credentials:o}}function D(e,t){const{changes:{updates:r,deletions:o}}=t,a=n.DataModelType.KWSecurityBreach,i=M(e,o,a),s=r.map(l.createUploadChangeForItem),c=o.map((0,l.createUploadChangeForDeletion)(a)),d=N(i.changesToUpload,[...s,...c]),u=w(i.securityBreaches,r),p=void 0!==t.dataLeaksRefreshDate?t.dataLeaksRefreshDate:i.securityBreachesMetadata.latestDataLeaksBreachesUpdate;return{...i,securityBreaches:u,securityBreachesMetadata:{latestPublicBreachesRevision:t.revision,latestDataLeaksBreachesUpdate:p},changesToUpload:d}}function O(e,{changesToUpload:t}){return{...e,changesToUpload:N(e.changesToUpload,t)}}function b(e,t){const r=function(e,t){return e.filter((e=>e.Id!==t))}(e,t.Id);return r.concat(t)}function w(e,t){return[...R(e,t.map((e=>e.Id))),...t]}function N(e,t){const r=(t=Array.isArray(t)?t:[t]).concat(e||[]);return(0,o.uniqBy)((0,o.prop)("itemId"),r)}function R(e,t){return e.filter((e=>!t.includes(e.Id)))}function M(e,t,r){if(r&&n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]){const o=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r],a=e[o],i=R(e[o],t);return a.length===i.length?e:{...e,[o]:i}}const o=a.PERSONAL_DATA_COLLECTIONS_KEYS.reduce(((r,o)=>{if(!(o in e))return r;const n=R(e[o],t);return{...r,[o]:n}}),{});return 0===Object.keys(o).length?e:{...e,...o}}t.savePersonalSettings=A,t.teamSpaceContentControlApplied=f,t.deleteVaultModulePersonalDataItem=E,t.deleteVaultModulePersonalDataItemsBulk=h,t.savePaymentCard=v,t.savePersonalDataItem=T,t.savePersonalDataItems=_,t.saveGeneratedPassword=I,t.saveObjects=function(e,t){return(0,o.reduce)(((e,t)=>{const r=n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[t.kwType];return r&&(e[r]=e[r].concat(t)),e}),{...e},t)},t.updateLastBackupTime=C,t.updateCredentials=function(e,t){return t.reduce(((e,t)=>P(e,t)),e)},t.updateCredential=P,t.breachesUpdated=D,t.saveChangesToUpload=O;t.getLegacyEmptyBreaches=()=>({revision:0,breaches:[]});t.getEmptyBreachesMetadata=()=>({latestPublicBreachesRevision:0,latestDataLeaksBreachesUpdate:0});t.countPersonalDataItems=e=>Object.keys(n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY).reduce(((t,r)=>t+e[n.DATAMODELOBJECT_TYPE_TO_CARBON_STORE_KEY[r]].length),0)},30641:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(62433),n=r(45127),a=r(49901);t.default=function(e){const t=(0,o.isNil)(e.LocaleFormat)?n.Country.UNIVERSAL:e.LocaleFormat,r=(0,o.isNil)(e.SpaceId)?a.PERSONAL_SPACE_ID:e.SpaceId;return{...e,LocaleFormat:t,SpaceId:r}}},63985:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fixPasskeyTypesFromTransaction=t.fixBreachTypesFromStore=t.fixBreachTypesFromTransaction=t.fixCommonPropertiesTypes=t.fixGeneratedPasswordsTypes=t.fixCredentialTypesFromStore=t.fixNoteTypesFromStore=t.fixAttachmentProperties=t.fixNoteTypesFromTransaction=t.fixAllStringObject=t.fixLinkedServicesTypes=t.fixDomainIconTypes=t.fixTrustedUrlTypes=t.fixCredentialTypesFromTransaction=void 0;const o=r(6093),n=["CreationDatetime","LastBackupTime","UserModificationDatetime"],a=["Id","SpaceId"];function i(e){return(0,o.fixPropertiesTypes)([],[],[],["TrustedUrl","TrustedUrlExpire"],e)}function s(e){const{urls:t,...r}=(0,o.fixPropertiesTypes)([],[],[],["backgroundColor","mainColor"],e);return{...r,urls:"object"==typeof t&&null!==t?l(t):{}}}function c(e){const t=Array.isArray(e.associated_domains)?e.associated_domains.map(d):[];return{...e,associated_domains:t}}function d(e){return(0,o.fixPropertiesTypes)([],[],[],["domain","source"],e)}function l(e){const t=Object.keys(e);return(0,o.fixPropertiesTypes)([],[],[],t,e)}function u(e){return(0,o.fixPropertiesTypes)([],["version","localSize","remoteSize","creationDatetime","userModificationDatetime"],[],["id","type","filename","downloadKey","cryptoKey","owner"],e)}t.fixCredentialTypesFromTransaction=function(e){const t=["LastUse","ModificationDatetime","NumberUse","Strength"].concat(n),r=["Alias","Category","ConnectionOptions","Email","Login","Note","OtpSecret","OtpUrl","Password","Port","SID","SecondaryLogin","Server","Title","Url","UserSelectedUrl"].concat(a),{TrustedUrlGroup:d,Attachments:l,LinkedServices:p,domainIcon:S,...m}=(0,o.fixPropertiesTypes)(["AutoLogin","AutoProtected","Checked","SharedObject","SubdomainOnly","UseFixedUrl","limitedPermissions"],t,["Attachments","LinkedServices"],r,e),g=Array.isArray(l)?{Attachments:l.map(u)}:{},y="object"==typeof S&&null!==S?{domainIcon:s(S)}:{};return{...m,...g,...p?{LinkedServices:c(p)}:{},...y,TrustedUrlGroup:d&&d.length>0?d.map(i):[]}},t.fixTrustedUrlTypes=i,t.fixDomainIconTypes=s,t.fixLinkedServicesTypes=c,t.fixAllStringObject=l,t.fixNoteTypesFromTransaction=function(e){const t=["CreationDate","UpdateDate"].concat(n),r=["Title","Content","Category"].concat(a),{Attachments:i,Type:s,...c}=(0,o.fixPropertiesTypes)(["Secured"],t,["Attachments"],r,e);return{...c,...Array.isArray(i)?{Attachments:i.map(u)}:{},Type:s||"GRAY"}},t.fixAttachmentProperties=u,t.fixNoteTypesFromStore=function(e){const t={};return["Attachments"].filter((t=>!!e[t])).forEach((r=>{t[r]=JSON.stringify(e[r])})),Object.assign({},e,t)},t.fixCredentialTypesFromStore=function(e){const t={};return["Attachments","LinkedServices"].filter((t=>!!e[t])).forEach((r=>{t[r]=JSON.stringify(e[r])})),Object.assign({},e,t)},t.fixGeneratedPasswordsTypes=function(e){const t=["GeneratedDate"].concat(n);return(0,o.fixPropertiesTypes)([],t,[],[],e)},t.fixCommonPropertiesTypes=function(e){return(0,o.fixPropertiesTypes)([],n,[],[],e)},t.fixBreachTypesFromTransaction=function(e){const t=[...n,"ContentRevision"],r=[...a,"BreachId","Status"],i=(0,o.fixPropertiesTypes)([],t,["Content","LeakedPasswords"],r,e);return Array.isArray(i.LeakedPasswords)||(i.LeakedPasswords=[]),i},t.fixBreachTypesFromStore=function(e){const t={};return["Content","LeakedPasswords"].filter((t=>!!e[t])).forEach((r=>{t[r]=JSON.stringify(e[r])})),Array.isArray(e.LeakedPasswords)||(t.LeakedPasswords=JSON.stringify([])),{...e,...t}},t.fixPasskeyTypesFromTransaction=function(e){const t=[...n,"Counter","KeyAlgorithm"],r=[...a,"CredentialId","RpId","RpName","UserDisplayName","UserHandle"];return(0,o.fixPropertiesTypes)([],t,["PrivateKey"],r,e)}},53628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fixPersistedPersonalData=t.fixPersonalDataItemFromExternalSource=void 0;const o=r(62433),n=r(45127),a=r(63985),i=r(30641),s=r(86715),c=[{key:"credentials",isData:n.isCredential,fixData:e=>(0,a.fixCredentialTypesFromTransaction)(e),addDefaultValues:e=>(0,i.default)(e)},{key:"notes",isData:n.isNote,fixData:e=>(0,a.fixNoteTypesFromTransaction)(e),addDefaultValues:e=>(0,i.default)(e)},{key:"generatedPasswords",isData:n.isGeneratedPassword,fixData:e=>(0,a.fixGeneratedPasswordsTypes)(e),addDefaultValues:e=>e},{key:"securityBreaches",isData:s.isBreach,fixData:e=>(0,a.fixBreachTypesFromTransaction)(e),addDefaultValues:e=>e},{key:"passkeys",isData:n.isPasskey,fixData:e=>(0,a.fixPasskeyTypesFromTransaction)(e),addDefaultValues:e=>e}];t.fixPersonalDataItemFromExternalSource=function(e,t){const r=function(e,t){return t?{...e,Id:t}:e}(e,t),o=c.find((e=>e.isData(r)));return o?l(o,r):(0,a.fixCommonPropertiesTypes)(r)};const d=["breaches","versionedBreaches"];function l(e,t){return e.addDefaultValues(e.fixData(t))}t.fixPersistedPersonalData=function(e){const t={};c.forEach((r=>{const o=e[r.key];if(!o)return;const n=o.map((e=>l(r,e)));t[r.key]=n}));const r=(t.credentials??[]).filter((e=>!!e.Id));return{...(0,o.omit)(d,e),...t,credentials:r}}},27517:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.editPersonalSettings=t.loadStoredPersonalSettings=t.PersonalSettingsActionType=t.TOGGLE_DASHLANE_ON_SITE=t.TOGGLE_DASHLANE_ON_PAGE=void 0,t.TOGGLE_DASHLANE_ON_PAGE="TOGGLE_DASHLANE_ON_PAGE",t.TOGGLE_DASHLANE_ON_SITE="TOGGLE_DASHLANE_ON_SITE",function(e){e.Edit="EDIT_PERSONAL_SETTINGS",e.EditFromTransaction="EDIT_PERSONAL_SETTINGS_FROM_TRANSACTION",e.LoadFromStorage="LOAD_PERSONAL_SETTINGS_FROM_STORAGE"}(r=t.PersonalSettingsActionType||(t.PersonalSettingsActionType={}));t.loadStoredPersonalSettings=e=>({type:r.LoadFromStorage,data:Object.assign({},e)});t.editPersonalSettings=e=>({type:r.Edit,content:Object.assign({},e)})},51104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fixPersonalSettingTypes=void 0;const o=r(62433),n=r(6093),a={GeneratorDefaultAvoidAmbiguousChars:"boolean",GeneratorDefaultDigits:"boolean",GeneratorDefaultLetters:"boolean",GeneratorDefaultMixedCase:"boolean",GeneratorDefaultPronounceable:"boolean",GeneratorDefaultSymbols:"boolean",RecoveryOptIn:"boolean",ProtectPasswords:"boolean",ProtectPayments:"boolean",ProtectIDs:"boolean",RichIcons:"boolean",SecuredDataShowScreenshots:"yes-no",SecuredDataShowPassword:"yes-no",SecuredDataShowIDs:"yes-no",SecuredDataShowCreditcard:"yes-no",SecuredDataAutofillCreditcard:"yes-no",SyncBackup:"yes-no",SyncBackupPurchase:"yes-no",SyncBackupPersonaldata:"yes-no",SyncBackupPasswords:"yes-no",SyncBackupCreditCardsNumber:"yes-no",SyncBackupCreditCardsCCV:"yes-no"},i={GeneratorDefaultSize:"number",accountCreationDatetime:"number"},s={SpaceAnonIds:"json",AutofillSettings:"json"},c=(0,o.curry)(n.fixProperties.fromTransaction)(a,i,s),d=(0,o.curry)(n.fixProperties.fromStore)(a,i,s);t.fixPersonalSettingTypes={fromTransaction:c,fromStore:d}},95648:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getWebsiteInfo=t.getUpdatedPersonalSettings=t.getEmptyPersonalSettings=t.makeBasePersonalSettings=void 0;const o=r(62433),n=r(15318),a=r(27517),i=r(51104),s=r(16593);function c(){return{AccountRecoveryKey:null,AccountRecoveryKeyId:null,DisabledDomainsList:[],DisabledUrlsList:[],DisabledDomainsAutologinList:[],DisabledUrlsAutologinList:[],SyncBackupCreditCardsCCV:null,SyncBackupCreditCardsNumber:null,SyncBackupPasswords:null,SyncBackupPersonaldata:null,SyncBackupPurchase:null,SecuredDataAutofillCreditcard:!0,SecuredDataShowCreditcard:!0,SecuredDataShowIDs:!0,SecuredDataShowPassword:!1,SecuredDataShowScreenshots:!0,ProtectPasswords:!1,ProtectPayments:!0,RichIcons:!0,ProtectIDs:!1,CryptoUserPayload:null,...(0,t.makeBasePersonalSettings)()}}t.makeBasePersonalSettings=()=>({RealLogin:null,SecurityEmail:null,accountCreationDatetime:null,Format:null,Language:null,AnonymousUserId:null,UsagelogToken:null,SyncBackup:null,AutofillSettings:{isAutofillDisabled:!1,isAutologinDisabled:!1,disabledSourceTypes:[],disabledDomains:[],isFollowUpNotificationEnabled:!0},SecuredDataAutofillCreditcard:!0,SecuredDataShowCreditcard:!0,SecuredDataShowIDs:!0,SecuredDataShowPassword:!1,SecuredDataShowScreenshots:!0,ProtectPasswords:!1,ProtectPayments:!0,ProtectIDs:!1,RichIcons:!0,kwType:"KWSettingsManagerApp",Id:"SETTINGS_userId",LastBackupTime:null}),t.getEmptyPersonalSettings=c,t.default=(e=c(),t)=>{switch(t.type){case a.PersonalSettingsActionType.LoadFromStorage:return(0,o.mergeDeepRight)(e,i.fixPersonalSettingTypes.fromTransaction(t.data));case a.PersonalSettingsActionType.EditFromTransaction:return(0,o.mergeDeepRight)(e,i.fixPersonalSettingTypes.fromTransaction(t.content));case a.PersonalSettingsActionType.Edit:return(0,o.mergeDeepRight)(e,t.content);default:return e}},t.getUpdatedPersonalSettings=function(e,t){const r=c(),o=Object.keys(r);for(const e of o)t[e]||void 0===t[e]||(t[e]=r[e]);return{...e,...t}},t.getWebsiteInfo=function(e,t){const r=new n.ParsedURL(t).getRootDomain(),a=e.getPersonalSettings(),i=(0,s.spaceDisabledDomainsListSelector)(e.getState());return{disabledAutofillOnDomain:(0,o.contains)(r,a.DisabledDomainsList),disabledAutofillOnPage:(0,o.contains)(t,a.DisabledUrlsList),disabledAutologinOnDomain:(0,o.contains)(r,[...a.DisabledDomainsAutologinList,...i]),disabledAutologinOnPage:(0,o.contains)(t,a.DisabledUrlsAutologinList),disabledFromSpaces:!1}}},12995:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveCurrentLocation=t.savePlatformInfo=t.LOAD_ANONYMOUS_APPLICATION_ID=t.SAVE_CURRENT_LOCATION=t.SAVE_PLATFORM_INFO=void 0,t.SAVE_PLATFORM_INFO="SAVE_PLATFORM_INFO",t.SAVE_CURRENT_LOCATION="SAVE_CURRENT_LOCATION",t.LOAD_ANONYMOUS_APPLICATION_ID="LOAD_ANONYMOUS_APPLICATION_ID";t.savePlatformInfo=e=>({type:t.SAVE_PLATFORM_INFO,info:e});t.saveCurrentLocation=e=>({type:t.SAVE_CURRENT_LOCATION,location:e})},9149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyPlatform=t.defaultPlatformInfo=void 0;const o=r(45127),n=r(12995);t.default=(e=i(),r)=>{switch(r.type){case n.SAVE_PLATFORM_INFO:return{...e,info:(a=r.info,s=t.defaultPlatformInfo,{platformName:a.platformName||s.platformName,appVersion:a.appVersion||s.appVersion,browser:a.browser||s.browser,browserVersion:a.browserVersion||s.browserVersion,country:a.country||s.country,os:a.os||s.os,osCountry:a.osCountry||s.osCountry,osVersion:a.osVersion||s.osVersion,lang:a.lang||s.lang,manifestVersion:a.manifestVersion||s.manifestVersion,buildType:a.buildType??o.ApplicationBuildType.PRODUCTION})};case n.SAVE_CURRENT_LOCATION:return{...e,location:r.location};default:return e}var a,s};const a={country:null,isEu:!0};function i(){return{info:t.defaultPlatformInfo,location:a}}t.defaultPlatformInfo={platformName:"server_carbon_unknown",appVersion:"unknown_version",browser:"browser_carbon_unknown",browserVersion:"unknown_browser_version",country:"country_carbon_unknown",os:"os_carbon_unknown",osCountry:"os_country_carbon_unknown",osVersion:"unknown_os_version",lang:"lang_carbon_unknown",buildType:o.ApplicationBuildType.PRODUCTION},t.getEmptyPlatform=i},95363:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetRecoverySessionData=t.saveRecoverySessionData=t.RESET_RECOVERY_SESSION_DATA=t.SAVE_RECOVERY_SESSION_DATA=void 0,t.SAVE_RECOVERY_SESSION_DATA="SAVE_RECOVERY_SESSION_DATA",t.RESET_RECOVERY_SESSION_DATA="RESET_RECOVERY_SESSION_DATA";t.saveRecoverySessionData=e=>({type:t.SAVE_RECOVERY_SESSION_DATA,data:e});t.resetRecoverySessionData=()=>({type:t.RESET_RECOVERY_SESSION_DATA})},13250:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyRecoveryState=void 0;const o=r(95363);t.getEmptyRecoveryState=()=>({recoveryUki:null,publicKey:null,userServerProtectedSymmetricalKey:null,recoveryServerKeyBase64:null,recoveryInProgress:!1,currentPassword:null,verificationMethod:null}),t.default=(e=(0,t.getEmptyRecoveryState)(),r)=>{switch(r.type){case o.SAVE_RECOVERY_SESSION_DATA:return{...e,...r.data};case o.RESET_RECOVERY_SESSION_DATA:return(0,t.getEmptyRecoveryState)();default:return e}}},4572:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userSessionReducer=t.userSessionRootReducer=void 0;const o=r(82422),n=r(62433),a=r(1678),i=r(70325),s=r(86797),c=r(12659),d=r(78663),l=r(11406),u=r(66403),p=r(48005),S=r(73472),m=r(76089),g=r(1347),y=r(95648),A=r(44899),f=r(4511),E=r(79619),h=r(58174),v=r(36738),T=r(4551),_=r(84827),I=r(63703),C=r(69795),P=r(97632),D=r(13250),O=r(39727),b=r(15868),w=r(19546),N=r(51554),R=r(48313),M=r(45291),L=r(98496),U=r(29737),k=r(38271),F=r(24827),B=r(36784),G=r(13042),K=r(81200),V=r(99800),j=r(27517);t.userSessionRootReducer=(e,t)=>{switch(t.type){case R.CLOSE_SESSION:return;case R.CHANGES_FROM_TRANSACTIONS:return H(e,t);case R.LOCAL_SETTINGS_UPDATED:const r=t.data;return Object.assign({},e,{localSettings:(0,S.default)(e.localSettings,(0,m.loadStoredLocalSettings)(r)),spaceData:(0,E.default)(e.spaceData,(0,v.spacesUpdated)(r.premiumStatus.spaces))});case R.PREMIUM_STATUS_UPDATED:const o=t.premiumStatus;return Object.assign({},e,{localSettings:(0,S.default)(e.localSettings,(0,m.localSettingsPremiumStatusUpdated)(o)),spaceData:(0,E.default)(e.spaceData,(0,v.spacesUpdated)(o.spaces))});default:return e}};const H=(e,t)=>t.actions.reduce(((e,t)=>{switch(t.type){case j.PersonalSettingsActionType.EditFromTransaction:return{...e,personalSettings:(0,y.default)(e.personalSettings,t)};case R.REMOVE_PERSONAL_ITEM_FROM_TRANSACTION:return{...e,personalData:(0,g.removePersonalItemFromTransaction)(e.personalData,t)};case R.ADD_PERSONAL_ITEM_FROM_TRANSACTION:return{...e,personalData:(0,g.addPersonalItemFromTransaction)(e.personalData,t)}}return e}),e),W=(e,t)=>{switch(t.type){case R.SAVE_GENERATED_PASSWORD:return Object.assign({},e,{personalData:(0,g.reducer)(e.personalData,{...t,type:M.SAVE_GENERATED_PASSWORD},{spaces:e.localSettings.premiumStatus?.spaces??[]})});case R.SAVE_PERSONAL_ITEM:return Object.assign({},e,{personalData:(0,g.reducer)(e.personalData,{...t,type:M.SAVE_PERSONAL_ITEM},{spaces:e.localSettings.premiumStatus?.spaces??[]})});case R.SAVE_PERSONAL_ITEMS:return Object.assign({},e,{personalData:(0,g.reducer)(e.personalData,{...t,type:M.SAVE_PERSONAL_ITEMS},{spaces:e.localSettings.premiumStatus?.spaces??[]})});default:return e}};t.userSessionReducer=(e,r)=>{const m=(0,o.combineReducers)({abTests:a.default,account:s.default,accountContactInfo:O.default,accountCreation:c.default,authTicketInfo:d.default,credentialOTPs:l.credentialOTPs,changeMPData:u.default,directorySync:p.default,iconsCache:h.default,localSettings:S.default,loginDeviceLimitFlow:b.default,notificationsStatus:L.default,paymentsState:i.default,personalData:g.reducer,personalSettings:y.default,sdkAuthentication:U.default,recoveryData:D.default,session:k.default,sharingData:A.default,sharingSync:_.default,spaceData:E.default,ssoSettings:I.default,sync:T.default,teamAdminData:f.default,twoFactorAuthenticationEnableFlow:w.twoFactorAuthenticationEnableFlow,twoFactorAuthenticationDisableFlow:N.twoFactorAuthenticationDisableFlow,userActivity:C.default,vaultReport:P.default,vpnData:F.VPNReducers,importPersonalData:B.ImportDataStateReducer,secureFileStorageState:G.SecureFileStorageReducer,credentialsDedupViewState:K.credentialsDedupViewReducer,breachRefreshMetaData:V.breachRefreshMetaDataReducer}),v=(0,n.partialRight)(m,[r]),R=(0,n.partialRight)(W,[r]);return(0,n.pipe)(t.userSessionRootReducer,R,v)(e,r)}},33007:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadAnonymousPartnerId=t.loadSdkAuthentication=t.saveStyxKeys=t.saveAppKeys=t.saveDashlaneServerDeltaTimestamp=t.LOAD_ANONYMOUS_PARTNER_ID=t.LOAD_CLIENT_AUTHENTICATION_DATA=t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP=t.SAVE_STYX_KEYS=t.SAVE_APP_KEYS=void 0;const o=r(53);t.SAVE_APP_KEYS="SAVE_APP_KEYS",t.SAVE_STYX_KEYS="SAVE_STYX_KEYS",t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP="SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP",t.LOAD_CLIENT_AUTHENTICATION_DATA="LOAD_CLIENT_AUTHENTICATION_DATA",t.LOAD_ANONYMOUS_PARTNER_ID="LOAD_ANONYMOUS_PARTNER_ID";t.saveDashlaneServerDeltaTimestamp=e=>({type:t.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP,dashlaneServerDeltaTimestamp:Math.round((0,o.getUnixTimestamp)()-e)});t.saveAppKeys=e=>({type:t.SAVE_APP_KEYS,appKeys:e});t.saveStyxKeys=e=>({type:t.SAVE_STYX_KEYS,styxKeys:e});t.loadSdkAuthentication=e=>({type:t.LOAD_CLIENT_AUTHENTICATION_DATA,data:e});t.loadAnonymousPartnerId=e=>({type:t.LOAD_ANONYMOUS_PARTNER_ID,anonymousPartnerId:e})},29737:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySdkAuthentication=void 0;const o=r(33007);function n(){return{anonymousPartnerId:null,appKeys:null,dashlaneServerDeltaTimestamp:null,styxKeys:null}}t.getEmptySdkAuthentication=n,t.default=(e={anonymousPartnerId:null,appKeys:null,dashlaneServerDeltaTimestamp:null,styxKeys:null},t)=>{switch(t.type){case o.SAVE_APP_KEYS:return{...e,appKeys:t.appKeys};case o.SAVE_STYX_KEYS:return{...e,styxKeys:t.styxKeys};case o.SAVE_DASHLANE_SERVER_DELTA_TIMESTAMP:return{...e,dashlaneServerDeltaTimestamp:t.dashlaneServerDeltaTimestamp};case o.LOAD_CLIENT_AUTHENTICATION_DATA:return{...e,...t.data};case o.LOAD_ANONYMOUS_PARTNER_ID:return{...e,...t};default:return e}}},76556:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.secureFileStartCipheringAction=t.secureFileUploadErrorAction=t.secureFileUploadChunkAction=t.secureFileUploadClearAction=t.secureFileUploadDoneAction=t.secureFileStartUploadAction=t.secureFileClearAction=t.SECURE_FILE_START_CIPHERING=t.SECURE_FILE_UPLOAD_CHUNK=t.SECURE_FILE_UPLOAD_ERROR=t.SECURE_FILE_UPLOAD_CLEAR=t.SECURE_FILE_UPLOAD_DONE=t.SECURE_FILE_START_UPLOAD=t.SECURE_FILE_CLEAR=void 0,t.SECURE_FILE_CLEAR="SECURE_FILE_CLEAR",t.SECURE_FILE_START_UPLOAD="SECURE_FILE_START_UPLOAD",t.SECURE_FILE_UPLOAD_DONE="SECURE_FILE_UPLOAD_DONE",t.SECURE_FILE_UPLOAD_CLEAR="SECURE_FILE_UPLOAD_CLEAR",t.SECURE_FILE_UPLOAD_ERROR="SECURE_FILE_UPLOAD_ERROR",t.SECURE_FILE_UPLOAD_CHUNK="SECURE_FILE_UPLOAD_CHUNK",t.SECURE_FILE_START_CIPHERING="SECURE_FILE_START_CIPHERING";t.secureFileClearAction=e=>({type:t.SECURE_FILE_CLEAR,downloadKey:e});t.secureFileStartUploadAction=e=>({type:t.SECURE_FILE_START_UPLOAD,contentLength:e});t.secureFileUploadDoneAction=()=>({type:t.SECURE_FILE_UPLOAD_DONE});t.secureFileUploadClearAction=()=>({type:t.SECURE_FILE_UPLOAD_CLEAR});t.secureFileUploadChunkAction=e=>({type:t.SECURE_FILE_UPLOAD_CHUNK,bytesSent:e});t.secureFileUploadErrorAction=()=>({type:t.SECURE_FILE_UPLOAD_ERROR});t.secureFileStartCipheringAction=()=>({type:t.SECURE_FILE_START_CIPHERING})},20810:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(10691),t),n(r(76556),t)},13042:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySecureFileStorageState=t.SecureFileStorageReducer=void 0;const o=r(45127),n=r(20810),a=r(76556),i={upload:{status:o.FileUploadStatus.None,bytesSent:0,contentLength:0}};t.SecureFileStorageReducer=(e=i,t)=>{switch(t.type){case n.SECURE_FILE_CLEAR:return{...e,upload:i.upload};case a.SECURE_FILE_START_UPLOAD:return{...e,upload:{...e.upload,status:o.FileUploadStatus.Initial,contentLength:t.contentLength,bytesSent:0}};case a.SECURE_FILE_UPLOAD_CHUNK:{const r=e.upload;if(0===r.contentLength)return e;const n=r.bytesSent+t.bytesSent;return{...e,upload:{...e.upload,status:o.FileUploadStatus.Uploading,bytesSent:n<r.contentLength?n:r.bytesSent}}}case a.SECURE_FILE_START_CIPHERING:return{...e,upload:{...e.upload,status:o.FileUploadStatus.Ciphering}};case a.SECURE_FILE_UPLOAD_ERROR:return{...e,upload:{...e.upload,status:o.FileUploadStatus.Error}};case a.SECURE_FILE_UPLOAD_DONE:return 0===e.upload.contentLength?e:{...e,upload:{bytesSent:0,contentLength:0,status:o.FileUploadStatus.Done}};case n.SECURE_FILE_UPLOAD_CLEAR:return{...e,upload:{bytesSent:0,contentLength:0,status:o.FileUploadStatus.None}};default:return e}};t.getEmptySecureFileStorageState=()=>i},10691:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},16356:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateIsFirstSessionAfterAccountCreation=t.updateisUsingBackupCode=t.updateisUsingDashlaneAuthenticator=t.updateSessionDidOpen=t.pairingSucceeded=t.updatePublicUserId=t.updateDeviceAnalyticsId=t.updateUserAnalyticsId=t.updateAnalyticsIds=t.loadAnalyticsIds=t.updateRemoteKey=t.updateIsLocalKeyMigrationRequired=t.updateLocalKey=t.updateSettingsForMPValidation=t.updateCryptoKwc3FixedSalt=t.updateLastMasterPasswordCheck=t.updateMasterPassword=t.updateServerKey=t.loadSessionKeys=t.updateKeyPair=t.shouldRememberMeForSSOUpdated=t.rememberMasterPasswordUpdated=t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION=t.UPDATE_IS_USING_BACKUP_CODE=t.UPDATE_IS_USING_AUTHENTICATOR=t.UPDATE_SESSION_DID_OPEN=t.PAIRING_SUCCEEDED=t.LOAD_ANALYTICS_IDS=t.UPDATE_PUBLIC_USER_ID=t.UPDATE_DEVICE_ANALYTICS_ID=t.UPDATE_USER_ANALYTICS_ID=t.UPDATE_ANALYTICS_IDS=t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED=t.UPDATE_REMOTE_KEY=t.UPDATE_LOCAL_KEY=t.UPDATE_SETTINGS_FOR_MP_VALIDATION=t.USE_NEW_AUTH_API=t.LOAD_SESSION_KEYS=t.UPDATE_CRYPTO_KWC3_FIXED_SALT=t.UPDATE_LAST_MASTER_PASSWORD_CHECK=t.UPDATE_SERVER_KEY=t.UPDATE_MASTER_PASSWORD=t.UPDATE_KEY_PAIR=t.REMEMBER_ME_FOR_SSO_UPDATED=t.REMEMBER_MASTER_PASSWORD_UPDATED=void 0,t.REMEMBER_MASTER_PASSWORD_UPDATED="REMEMBER_MASTER_PASSWORD_UPDATED",t.REMEMBER_ME_FOR_SSO_UPDATED="REMEMBER_ME_FOR_SSO_UPDATED",t.UPDATE_KEY_PAIR="UPDATE_KEY_PAIR",t.UPDATE_MASTER_PASSWORD="UPDATE_MASTER_PASSWORD",t.UPDATE_SERVER_KEY="UPDATE_SERVER_KEY",t.UPDATE_LAST_MASTER_PASSWORD_CHECK="UPDATE_LAST_MASTER_PASSWORD_CHECK",t.UPDATE_CRYPTO_KWC3_FIXED_SALT="UPDATE_CRYPTO_KWC3_FIXED_SALT",t.LOAD_SESSION_KEYS="LOAD_SESSION_KEYS",t.USE_NEW_AUTH_API="USE_NEW_AUTH_API",t.UPDATE_SETTINGS_FOR_MP_VALIDATION="UPDATE_SETTINGS_FOR_MP_VALIDATION",t.UPDATE_LOCAL_KEY="UPDATE_LOCAL_KEY",t.UPDATE_REMOTE_KEY="UPDATE_REMOTE_KEY",t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED="UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED",t.UPDATE_ANALYTICS_IDS="UPDATE_ANALYTICS_IDS",t.UPDATE_USER_ANALYTICS_ID="UPDATE_USER_ANALYTICS_ID",t.UPDATE_DEVICE_ANALYTICS_ID="UPDATE_DEVICE_ANALYTICS_ID",t.UPDATE_PUBLIC_USER_ID="UPDATE_PUBLIC_USER_ID",t.LOAD_ANALYTICS_IDS="LOAD_ANALYTICS_IDS",t.PAIRING_SUCCEEDED="PAIRING_SUCCEEDED",t.UPDATE_SESSION_DID_OPEN="UPDATE_SESSION_DID_OPEN",t.UPDATE_IS_USING_AUTHENTICATOR="UPDATE_IS_USING_AUTHENTICATOR",t.UPDATE_IS_USING_BACKUP_CODE="UPDATE_IS_USING_BACKUP_CODE",t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION="UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION";t.rememberMasterPasswordUpdated=e=>({type:t.REMEMBER_MASTER_PASSWORD_UPDATED,rememberMasterPassword:e});t.shouldRememberMeForSSOUpdated=e=>({type:t.REMEMBER_ME_FOR_SSO_UPDATED,shouldRememberMeForSSO:e});t.updateKeyPair=e=>({type:t.UPDATE_KEY_PAIR,keyPair:e});t.loadSessionKeys=e=>({type:t.LOAD_SESSION_KEYS,sessionKeys:e});t.updateServerKey=e=>({type:t.UPDATE_SERVER_KEY,serverKey:e||""});t.updateMasterPassword=e=>({type:t.UPDATE_MASTER_PASSWORD,masterPassword:e});t.updateLastMasterPasswordCheck=()=>({type:t.UPDATE_LAST_MASTER_PASSWORD_CHECK});t.updateCryptoKwc3FixedSalt=e=>({type:t.UPDATE_CRYPTO_KWC3_FIXED_SALT,cryptoKwc3FixedSalt:e});t.updateSettingsForMPValidation=e=>({type:t.UPDATE_SETTINGS_FOR_MP_VALIDATION,settings:e});t.updateLocalKey=e=>({type:t.UPDATE_LOCAL_KEY,localKey:e});t.updateIsLocalKeyMigrationRequired=e=>({type:t.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED,isLocalKeyMigrationRequired:e});t.updateRemoteKey=e=>({type:t.UPDATE_REMOTE_KEY,remoteKey:e});t.loadAnalyticsIds=e=>({type:t.LOAD_ANALYTICS_IDS,userAnalyticsId:e.userAnalyticsId,deviceAnalyticsId:e.deviceAnalyticsId});t.updateAnalyticsIds=(e,r)=>({type:t.UPDATE_ANALYTICS_IDS,userAnalyticsId:e,deviceAnalyticsId:r});t.updateUserAnalyticsId=e=>({type:t.UPDATE_USER_ANALYTICS_ID,userAnalyticsId:e});t.updateDeviceAnalyticsId=e=>({type:t.UPDATE_DEVICE_ANALYTICS_ID,deviceAnalyticsId:e});t.updatePublicUserId=e=>({type:t.UPDATE_PUBLIC_USER_ID,publicUserId:e});t.pairingSucceeded=e=>({type:t.PAIRING_SUCCEEDED,pairingId:e});t.updateSessionDidOpen=e=>({type:t.UPDATE_SESSION_DID_OPEN,didOpen:e});t.updateisUsingDashlaneAuthenticator=e=>({type:t.UPDATE_IS_USING_AUTHENTICATOR,withAuthenticator:e});t.updateisUsingBackupCode=e=>({type:t.UPDATE_IS_USING_BACKUP_CODE,withBackupCode:e});t.updateIsFirstSessionAfterAccountCreation=()=>({type:t.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION})},38271:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(96997),n=r(48313),a=r(16356),i=r(59489);t.default=(e={sessionId:null,rememberMasterPassword:null,shouldRememberMeForSSO:null,masterPassword:null,remoteKey:null,localKey:null,lastMasterPasswordCheck:0,serverKey:"",keyPair:null,cryptoKwc3FixedSalt:null,sessionKeys:null,settingsForMPValidation:null,isLocalKeyMigrationRequired:!1,analyticsIds:{userAnalyticsId:"",deviceAnalyticsId:""},publicUserId:"",pairingId:null,didOpen:!1,isUsingDashlaneAuthenticator:!1,isUsingBackupCode:!1,isFirstSessionAfterAccountCreation:!1},t)=>{switch(t.type){case n.OPEN_SESSION:return{...e,sessionId:(0,o.default)()};case a.UPDATE_KEY_PAIR:return{...e,keyPair:t.keyPair};case a.REMEMBER_MASTER_PASSWORD_UPDATED:return{...e,rememberMasterPassword:t.rememberMasterPassword};case a.REMEMBER_ME_FOR_SSO_UPDATED:return{...e,shouldRememberMeForSSO:t.shouldRememberMeForSSO};case a.UPDATE_MASTER_PASSWORD:return{...e,masterPassword:t.masterPassword??null};case a.LOAD_SESSION_KEYS:return{...e,sessionKeys:t.sessionKeys};case a.UPDATE_SERVER_KEY:return{...e,serverKey:t.serverKey};case a.UPDATE_LAST_MASTER_PASSWORD_CHECK:return{...e,lastMasterPasswordCheck:Date.now()};case a.UPDATE_CRYPTO_KWC3_FIXED_SALT:return{...e,cryptoKwc3FixedSalt:t.cryptoKwc3FixedSalt};case i.CONFIRM_USER_AUTHENTICATION:return{...e,settingsForMPValidation:null};case a.UPDATE_SETTINGS_FOR_MP_VALIDATION:return{...e,settingsForMPValidation:t.settings};case a.UPDATE_LOCAL_KEY:return e.localKey!==t.localKey?{...e,localKey:t.localKey}:e;case a.UPDATE_REMOTE_KEY:return e.remoteKey!==t.remoteKey?{...e,remoteKey:t.remoteKey}:e;case a.UPDATE_IS_LOCAL_KEY_MIGRATION_REQUIRED:return{...e,isLocalKeyMigrationRequired:t.isLocalKeyMigrationRequired};case a.LOAD_ANALYTICS_IDS:case a.UPDATE_ANALYTICS_IDS:return{...e,analyticsIds:{userAnalyticsId:t.userAnalyticsId,deviceAnalyticsId:t.deviceAnalyticsId}};case a.UPDATE_USER_ANALYTICS_ID:return{...e,analyticsIds:{...e.analyticsIds,userAnalyticsId:t.userAnalyticsId}};case a.UPDATE_DEVICE_ANALYTICS_ID:return{...e,analyticsIds:{...e.analyticsIds,deviceAnalyticsId:t.deviceAnalyticsId}};case a.UPDATE_PUBLIC_USER_ID:return{...e,publicUserId:t.publicUserId};case a.PAIRING_SUCCEEDED:return{...e,pairingId:t.pairingId};case a.UPDATE_SESSION_DID_OPEN:return{...e,didOpen:t.didOpen};case a.UPDATE_IS_USING_AUTHENTICATOR:return{...e,isUsingDashlaneAuthenticator:t.withAuthenticator};case a.UPDATE_IS_USING_BACKUP_CODE:return{...e,isUsingBackupCode:t.withBackupCode};case a.UPDATE_IS_FIRST_SESSION_AFTER_ACCOUNT_CREATION:return{...e,isFirstSessionAfterAccountCreation:!0};default:return e}}},34433:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userGroupsUpdated=t.sharingDataUpdated=t.USER_GROUPS_UPDATED=t.SHARING_DATA_ITEMS_UPDATED=void 0,t.SHARING_DATA_ITEMS_UPDATED="SHARING_DATA_ITEMS_UPDATED",t.USER_GROUPS_UPDATED="USER_GROUPS_UPDATED";t.sharingDataUpdated=e=>({type:t.SHARING_DATA_ITEMS_UPDATED,sharingData:e});t.userGroupsUpdated=e=>({type:t.USER_GROUPS_UPDATED,userGroups:e})},44899:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyState=void 0;const o=r(34433);function n(){return{items:[],itemGroups:[],userGroups:[]}}t.default=(e={items:[],itemGroups:[],userGroups:[]},t)=>{switch(t.type){case o.SHARING_DATA_ITEMS_UPDATED:const{sharingData:r}=t;return{...r};case o.USER_GROUPS_UPDATED:const{userGroups:n}=t;return{...e,userGroups:n};default:return e}},t.getEmptyState=n},84827:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySharingSyncState=t.setAllPendingAction=t.SET_ALL_PENDING=t.updateAllPendingAction=t.UPDATE_ALL_PENDING=void 0,t.UPDATE_ALL_PENDING="UPDATE_ALL_PENDING";t.updateAllPendingAction=(e,r)=>({type:t.UPDATE_ALL_PENDING,pendingItemGroups:e,pendingUserGroups:r}),t.SET_ALL_PENDING="SET_ALL_PENDING";function r(){return{pendingItemGroups:[],pendingUserGroups:[]}}function o(e,t,r){const o=t.map((e=>e[r])),n=e.map((e=>e[r])),a=e.filter((e=>o.includes(e[r])));return[...t.filter((e=>!(e=>n.includes(e[r]))(e))),...a.map((e=>{const o=t.find((t=>t[r]===e[r]));return o||e}))]}t.setAllPendingAction=(e,r)=>({type:t.SET_ALL_PENDING,pendingItemGroups:e,pendingUserGroups:r}),t.default=(e={pendingItemGroups:[],pendingUserGroups:[]},r)=>{switch(r.type){case t.UPDATE_ALL_PENDING:{const{pendingUserGroups:t,pendingItemGroups:n}=r,a=o(e.pendingItemGroups,n,"itemGroupId");return{pendingUserGroups:o(e.pendingUserGroups,t,"groupId"),pendingItemGroups:a}}case t.SET_ALL_PENDING:{const{pendingUserGroups:e,pendingItemGroups:t}=r;return{pendingItemGroups:t,pendingUserGroups:e}}default:return e}},t.getEmptySharingSyncState=r},36738:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.spaceDataUpdated=t.spacesUpdated=t.SPACE_DATA_UPDATED=t.SPACES_UPDATED=void 0,t.SPACES_UPDATED="SPACES_UPDATED",t.SPACE_DATA_UPDATED="SPACE_DATA_UPDATED";t.spacesUpdated=e=>({type:t.SPACES_UPDATED,spaces:e});t.spaceDataUpdated=e=>({type:t.SPACE_DATA_UPDATED,spaceData:e})},79619:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySpaceDataState=void 0;const o=r(36738);function n(){return{spaces:[]}}t.default=(e={spaces:[]},t)=>{switch(t.type){case o.SPACES_UPDATED:const r=t;return{...e,spaces:(r.spaces||[]).map((e=>({teamId:e.teamId,details:e})))};case o.SPACE_DATA_UPDATED:return{...t.spaceData};default:return e}},t.getEmptySpaceDataState=n},7624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetSSOSettings=t.storeSSOSettings=void 0;const o=r(63703);t.storeSSOSettings=e=>({type:o.SET_SSO_SETTINGS,data:e});t.resetSSOSettings=()=>({type:o.SET_SSO_SETTINGS,data:(0,o.getEmptySSOSettings)()})},63703:(e,t)=>{function r(){return{ssoUser:!1,serviceProviderUrl:"",ssoServiceProviderKey:"",migration:void 0,ssoToken:""}}Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySSOSettings=t.SET_SSO_SETTINGS=void 0,t.SET_SSO_SETTINGS="SET_SSO_SETTINGS",t.default=(e=r(),o)=>o.type===t.SET_SSO_SETTINGS?Object.assign({},e,{...o.data}):e,t.getEmptySSOSettings=r},82262:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.syncFailure=t.syncSuccess=t.syncStarted=t.SYNC_FAILURE=t.SYNC_SUCCESS=t.SYNC_STARTED=void 0,t.SYNC_STARTED="SYNC_STARTED",t.SYNC_SUCCESS="SYNC_SUCCESS",t.SYNC_FAILURE="SYNC_FAILURE";t.syncStarted=()=>({type:t.SYNC_STARTED,isInProgress:!0,startTime:Date.now()});t.syncSuccess=e=>({type:t.SYNC_SUCCESS,isInProgress:!1,isUploadEnabled:e});t.syncFailure=()=>({type:t.SYNC_FAILURE,isInProgress:!1})},4551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySyncState=void 0;const o=r(45127),n=r(82262);function a(){return{isUploadEnabled:!1,syncIntervalTimeMs:3e5,status:o.SyncStatuses.READY}}t.getEmptySyncState=a,t.default=(e=a(),t)=>{switch(t.type){case n.SYNC_STARTED:return{...e,startTime:t.startTime,status:o.SyncStatuses.IN_PROGRESS};case n.SYNC_FAILURE:return{...e,status:o.SyncStatuses.FAILURE};case n.SYNC_SUCCESS:return{...e,status:o.SyncStatuses.SUCCESS,isUploadEnabled:t.isUploadEnabled};default:return e}}},1370:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.specialItemGroupUpdated=t.userGroupAdminItemCreated=t.teamAdminDataUpdated=t.userGroupsDeleted=t.userGroupsCreated=t.userGroupsUpdated=t.SPECIAL_ITEM_GROUP_UPDATED=t.GROUP_ADMIN_ITEM_CREATED=t.TEAM_ADMIN_DATA_UPDATED=t.TEAM_ADMIN_USER_GROUPS_DELETED=t.TEAM_ADMIN_USER_GROUPS_CREATED=t.TEAM_ADMIN_USER_GROUPS_UPDATED=void 0,t.TEAM_ADMIN_USER_GROUPS_UPDATED="TEAM_ADMIN_USER_GROUPS_UPDATED",t.TEAM_ADMIN_USER_GROUPS_CREATED="TEAM_ADMIN_USER_GROUPS_CREATED",t.TEAM_ADMIN_USER_GROUPS_DELETED="TEAM_ADMIN_USER_GROUPS_DELETED",t.TEAM_ADMIN_DATA_UPDATED="TEAM_ADMIN_DATA_UPDATED",t.GROUP_ADMIN_ITEM_CREATED="GROUP_ADMIN_ITEM_CREATED",t.SPECIAL_ITEM_GROUP_UPDATED="SPECIAL_ITEM_GROUP_UPDATED";t.userGroupsUpdated=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_UPDATED,teamId:e,userGroups:r});t.userGroupsCreated=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_CREATED,teamId:e,userGroups:r});t.userGroupsDeleted=(e,r)=>({type:t.TEAM_ADMIN_USER_GROUPS_DELETED,teamId:e,userGroups:r});t.teamAdminDataUpdated=e=>({type:t.TEAM_ADMIN_DATA_UPDATED,teamAdminData:e});t.userGroupAdminItemCreated=(e,r)=>({type:t.GROUP_ADMIN_ITEM_CREATED,teamId:e,userGroupAdminItem:r});t.specialItemGroupUpdated=(e,r)=>({type:t.SPECIAL_ITEM_GROUP_UPDATED,teamId:e,specialItemGroup:r})},4511:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyState=void 0;const o=r(1370);function n(e,t){const r={};return Object.keys(e).forEach((t=>{r[t]=e[t]})),Object.keys(t).forEach((e=>{r[e]=Object.assign({},r[e],t[e])})),r}function a(){return{teams:{}}}t.default=(e={teams:{}},t)=>{switch(t.type){case o.TEAM_ADMIN_DATA_UPDATED:const{teamAdminData:i}=t;return{teams:n(e.teams,i.teams)};case o.TEAM_ADMIN_USER_GROUPS_UPDATED:const s=t;return{teams:n(e.teams,{[s.teamId]:{teamId:s.teamId,userGroups:s.userGroups}})};case o.TEAM_ADMIN_USER_GROUPS_CREATED:const c=t,d=e.teams[c.teamId]?e.teams[c.teamId].userGroups:[];return{teams:n(e.teams,{[c.teamId]:{teamId:c.teamId,userGroups:d.concat(c.userGroups)}})};case o.TEAM_ADMIN_USER_GROUPS_DELETED:const l=t,u=l.userGroups.map((e=>e.groupId)),p=e.teams[l.teamId]?e.teams[l.teamId].userGroups:[];return{teams:n(e.teams,{[l.teamId]:{teamId:l.teamId,userGroups:p.filter((e=>!u.includes(e.groupId)))}})};case o.GROUP_ADMIN_ITEM_CREATED:const S=t,m=(r=e.teams,a=S.teamId,r[a]&&r[a].userGroupAdminItems||[]);return{teams:n(e.teams,{[S.teamId]:{teamId:S.teamId,userGroupAdminItems:m.concat([S.userGroupAdminItem])}})};case o.SPECIAL_ITEM_GROUP_UPDATED:const g=t;return{teams:n(e.teams,{[g.teamId]:{teamId:g.teamId,specialItemGroup:t.specialItemGroup}})};default:return e}var r,a},t.getEmptyState=a},40051:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userActivityLastSentAtUpdated=void 0;const o=r(39958);t.userActivityLastSentAtUpdated=e=>({type:o.LAST_SENT_AT_UPDATED,lastSentAt:e})},69795:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyUserActivityState=void 0;const o=r(39958);function n(){return{lastSentAt:void 0}}t.default=(e=n(),t)=>t.type===o.LAST_SENT_AT_UPDATED?{...e,lastSentAt:t.lastSentAt}:e,t.getEmptyUserActivityState=n},39958:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LAST_SENT_AT_UPDATED=void 0,t.LAST_SENT_AT_UPDATED="LAST_SENT_AT_UPDATED"},72881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vaultReportLastSentAtUpdated=void 0;const o=r(94846);t.vaultReportLastSentAtUpdated=e=>({type:o.LAST_SENT_AT_UPDATED,lastSentAt:e})},97632:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyVaultReportState=void 0;const o=r(94846);function n(){return{lastSentAt:void 0}}t.default=(e=n(),t)=>t.type===o.LAST_SENT_AT_UPDATED?{...e,lastSentAt:t.lastSentAt}:e,t.getEmptyVaultReportState=n},94846:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LAST_SENT_AT_UPDATED=void 0,t.LAST_SENT_AT_UPDATED="LAST_SENT_AT_UPDATED"},39610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(34066);t.bootstrap=e=>{e.register(o.config)}},10447:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forceSyncHandler=void 0;const o=r(48062);t.forceSyncHandler=async function({sessionService:e}){await e.getInstance().user.attemptSync(o.Trigger.Manual)}},18203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.refreshSubscriptionInformationHandler=void 0;const o=r(35507);t.refreshSubscriptionInformationHandler=async e=>(0,o.refreshSubscriptionInformation)(e.storeService,e.storeService.getAccountInfo().login)},17095:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCredentialSearchOrderHandler=void 0;const o=r(76089);t.setCredentialSearchOrderHandler=(e,t)=>(e.storeService.dispatch((0,o.credentialSearchOrderUpdated)(t.order)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},94275:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateAccountRecoveryKeyPersonalSettingsHandler=void 0;const o=r(27517);t.updateAccountRecoveryKeyPersonalSettingsHandler=(e,t)=>(e.storeService.dispatch((0,o.editPersonalSettings)(t)),Promise.resolve())},17387:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0,n(r(25576),t);var a=r(87881);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return a.setupSubscriptions}});var i=r(39610);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return i.bootstrap}})},81228:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sessionInfo$=t.getServiceProviderUrl$=t.emitServiceProviderUrl=t.webOnboardingMode$=t.subscriptionInformation$=t.premiumStatus$=t.syncInProgress$=t.syncInfo$=t.didOpen$=void 0;const o=r(18948),n=r(3343),a=r(16593);t.didOpen$=()=>(0,o.pipe)((0,n.map)(a.didOpenSelector),(0,n.distinctUntilChanged)());t.syncInfo$=()=>(0,o.pipe)((0,n.map)(a.syncSelector),(0,n.distinctUntilChanged)());t.syncInProgress$=()=>(0,o.pipe)((0,n.map)(a.syncIsInProgressSelector),(0,n.distinctUntilChanged)());t.premiumStatus$=()=>(0,o.pipe)((0,n.map)(a.premiumStatusSelector),(0,n.distinctUntilChanged)());t.subscriptionInformation$=()=>(0,o.pipe)((0,n.map)(a.subscriptionInformationSelector),(0,n.distinctUntilChanged)());t.webOnboardingMode$=()=>(0,o.pipe)((0,n.map)(a.webOnboardingModeSelector),(0,n.distinctUntilChanged)());const i=new o.Subject;t.emitServiceProviderUrl=e=>i.next(e);t.getServiceProviderUrl$=()=>i;t.sessionInfo$=()=>(0,o.pipe)((0,n.map)(a.sessionInfoSelector),(0,n.distinctUntilChanged)())},38328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updatePremiumChurningDismissDateHandler=t.SendTokenStatus=void 0;var o=r(72636);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return o.SendTokenStatus}});const n=r(76089);t.updatePremiumChurningDismissDateHandler=e=>{const t=new Date;return e.storeService.dispatch((0,n.premiumChurningDismissDateUpdated)(t.getTime())),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve()}},28287:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetProtectedItemAutofillTimerHandler=t.validateMasterPasswordHandler=t.validateMasterPassword=t.validateToken=t.convertTokenToAuthTicket=t.dashlaneAuthenticatorGetAuthTicket=t.handlePerformValidationError=t.SendTokenStatus=void 0;const o=r(45127),n=r(46298);var a=r(72636);Object.defineProperty(t,"SendTokenStatus",{enumerable:!0,get:function(){return a.SendTokenStatus}});const i=r(17825),s=r(42282),c=r(16356),d=r(87248),l=(e,t)=>({success:!1,error:{code:e,message:t}});function u(e,t,r){if(!(0,n.isApiErrorOfType)(n.BusinessError,e))return l(o.AuthenticationCode.REGISTER_DEVICE_FAILED);const a=e.code;switch(a){case n.VerificationFailed:return l(t?o.AuthenticationCode.OTP_NOT_VALID:r?o.AuthenticationCode.DASHLANE_AUTHENTICATOR_PUSH_NOTIFICATION_DENIED:o.AuthenticationCode.TOKEN_NOT_VALID);case n.InvalidOTPBlocked:return l(o.AuthenticationCode.OTP_TOO_MANY_ATTEMPTS);case n.InvalidOTPAlreadyUsed:return l(o.AuthenticationCode.OTP_ALREADY_USED);case n.AccountBlockedContactSupport:return l(o.AuthenticationCode.TOKEN_ACCOUNT_LOCKED);case n.VerificationTimeout:return l(o.AuthenticationCode.TOKEN_EXPIRED);case n.VerificationRequiresRequest:return l(o.AuthenticationCode.TOKEN_TOO_MANY_ATTEMPTS);case n.VerificationMethodDisabled:return l(o.AuthenticationCode.REGISTER_DEVICE_FAILED);case n.InvalidSsoToken:case n.B2bSsoUserNotFound:return l(o.AuthenticationCode.SSO_VERIFICATION_FAILED);case n.UserHasNoActiveAuthenticator:return l(o.AuthenticationCode.NO_ACTIVE_AUTHENTICATOR);case n.FailedToContactAuthenticatorDevice:return l(o.AuthenticationCode.FAILED_TO_CONTACT_AUTHENTICATOR_DEVICE);default:return l(o.AuthenticationCode.BUSINESS_ERROR,`Unexpected business_error: ${a}`)}}t.handlePerformValidationError=u;t.dashlaneAuthenticatorGetAuthTicket=async(e,t)=>{const{login:r}=e.getAccountInfo();e.dispatch((0,s.resetAuthTicketInfo)());try{const o=await(0,n.performDashlaneAuthenticatorVerification)(e,{login:r,deviceName:t});if((0,n.isApiError)(o))return u(o,!1,!0);const a=o.authTicket;return e.dispatch((0,s.updateAuthTicketInfo)({login:r,authTicket:a,date:Date.now()})),{success:!0,authTicket:a}}catch(e){if(e.getAdditionalInfo()?.response?.status===d.HttpStatusCode.GATEWAY_TIMEOUT)return u(n.verificationTimeoutError,!1,!0);throw e}};t.convertTokenToAuthTicket=async(e,t)=>{const{login:r}=e.getAccountInfo();let a,c;switch(e.dispatch((0,s.resetAuthTicketInfo)()),t.type){case"emailToken":if(!(0,n.isEmailTokenValid)(t.value))return l(o.AuthenticationCode.TOKEN_NOT_VALID);if(c=await(0,n.performEmailTokenVerification)(e,{login:r,token:t.value}),(0,n.isApiError)(c))return u(c);a=c.authTicket;break;case"extraDeviceToken":return(0,n.isExtraDeviceTokenValid)(t.value)?{success:!0,authTicket:void 0}:l(o.AuthenticationCode.TOKEN_NOT_VALID);case"sso":if(!t.value)return l(o.AuthenticationCode.TOKEN_NOT_VALID);if(c=await(0,n.performSsoVerification)(e,{login:r,ssoToken:t.value}),(0,n.isApiError)(c))return u(c);a=c.authTicket;break;case"otp":if(!t.value)return l(o.AuthenticationCode.TOKEN_NOT_VALID);if(c=await(0,n.performTotpVerification)(e,{login:r,otp:t.value}),(0,n.isApiError)(c))return u(c,!0);a=c.authTicket;break;default:(0,i.assertUnreachable)(t)}return e.dispatch((0,s.updateAuthTicketInfo)({login:r,authTicket:a,date:Date.now()})),{success:!0,authTicket:a}};t.validateToken=async(e,r)=>{const{storeService:o}=e;return(0,t.convertTokenToAuthTicket)(o,r)};t.validateMasterPassword=async(e,t,r)=>{const o=t.getInstance().isKey(e.getUserSession().serverKey,r);return o&&e.dispatch((0,c.updateLastMasterPasswordCheck)()),o};t.validateMasterPasswordHandler=async(e,r)=>{const{storeService:o,masterPasswordEncryptorService:n}=e;return await(0,t.validateMasterPassword)(o,n,r)};t.resetProtectedItemAutofillTimerHandler=e=>(e.storeService.dispatch((0,c.updateLastMasterPasswordCheck)()),Promise.resolve())},29303:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.recoveryIsOtpSelector=t.recoveryInProgressSelector=t.recoveryDataSelector=t.recoveryUkiSelector=void 0;t.recoveryUkiSelector=e=>e.userSession.recoveryData.recoveryUki;t.recoveryDataSelector=e=>e.userSession.recoveryData;t.recoveryInProgressSelector=e=>e.userSession.recoveryData.recoveryInProgress;t.recoveryIsOtpSelector=e=>{const t=e.userSession.recoveryData.verificationMethod[0]?.type??"";return["totp","duo_push","u2f"].includes(t)}},16593:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userCryptoSettingsSelector=t.sessionInfoSelector=t.sessionEncryptorKeysSelector=t.getCredentialSearchOrderSelector=t.analyticsInstallationIdSelector=t.isPaymentFailureChurningDismissedSelector=t.lastMasterPasswordCheckSelector=t.didOpenSelector=t.publicUserIdSelector=t.analyticsIdsSelector=t.applicationBuildTypeSelector=t.platformNameSelector=t.appVersionSelector=t.isAuthenticatedSelector=t.richIconsSettingSelector=t.protectPasswordsSettingSelector=t.personalSettingsSelector=t.authTicketInfoSelector=t.sharingKeysSelector=t.sharingSyncSelector=t.recoveryKeySelector=t.accountRecoveryOptInSelector=t.userCryptoFixedSalt=t.userDefaultCryptoSelector=t.anonymousUserIdSelector=t.isLocalKeyMigrationRequiredSelector=t.remoteKeySelector=t.isRemoteKeyActivatedSelector=t.serverKeySelector=t.spaceDisabledDomainsListSelector=t.localKeySelector=t.isLocalKeyActivatedSelector=t.webOnboardingModeSelector=t.masterPasswordValidationDataSelector=t.spacesSelector=t.userLoginSelector=t.masterPasswordSelector=t.masterPasswordAndServerKeySelector=t.userIdSelector=t.activeSpacesSelector=t.subscriptionInformationSelector=t.nodePremiumStatusSelector=t.premiumStatusSelector=t.syncIsInProgressSelector=t.syncSelector=void 0;const o=r(32034),n=r(45127),a=r(56915),i=r(2246),s=r(41265);t.syncSelector=e=>e.userSession.sync;t.syncIsInProgressSelector=e=>e.userSession.sync.status===n.SyncStatuses.IN_PROGRESS;t.premiumStatusSelector=e=>e.userSession.localSettings.premiumStatus;t.nodePremiumStatusSelector=e=>e.userSession.localSettings.nodePremiumStatus;t.subscriptionInformationSelector=e=>e.userSession.localSettings.subscriptionInformation;t.activeSpacesSelector=e=>{const r=(0,t.premiumStatusSelector)(e);return(r&&r.spaces||[]).filter((e=>"accepted"===e.status))};t.userIdSelector=e=>e.userSession.account.login;t.masterPasswordAndServerKeySelector=e=>{const{userSession:t}=e,{masterPassword:r,serverKey:o}=t.session;return{password:r,serverKey:o}};t.masterPasswordSelector=e=>e.userSession.session.masterPassword;t.userLoginSelector=e=>e.userSession.account.login;t.spacesSelector=e=>e.userSession.spaceData.spaces;t.masterPasswordValidationDataSelector=e=>e.userSession.session.settingsForMPValidation;t.webOnboardingModeSelector=e=>e.userSession.localSettings.webOnboardingMode;t.isLocalKeyActivatedSelector=e=>Boolean(e.userSession.session.localKey);t.localKeySelector=e=>e.userSession.session.localKey;t.spaceDisabledDomainsListSelector=(0,o.createSelector)(t.spacesSelector,(e=>e.reduce(((e,t)=>{let r=[];return t&&t.details&&t.details.info&&t.details.info.autologinDomainDisabledArray&&(r=t.details.info.autologinDomainDisabledArray),[...e,...r]}),[])));t.serverKeySelector=e=>e.userSession.session.serverKey;t.isRemoteKeyActivatedSelector=e=>Boolean(e.userSession.session.remoteKey);t.remoteKeySelector=e=>e.userSession.session.remoteKey;t.isLocalKeyMigrationRequiredSelector=e=>e.userSession.session.isLocalKeyMigrationRequired;t.anonymousUserIdSelector=e=>e.userSession.personalSettings.AnonymousUserId;t.userDefaultCryptoSelector=e=>e.userSession.personalSettings.CryptoUserPayload;t.userCryptoFixedSalt=e=>e.userSession.personalSettings.CryptoFixedSalt;t.accountRecoveryOptInSelector=e=>e.userSession.personalSettings.RecoveryOptIn||!1;t.recoveryKeySelector=e=>e.userSession.personalSettings.RecoveryKey;t.sharingSyncSelector=e=>e.userSession.sharingSync;t.sharingKeysSelector=e=>e.userSession.session.keyPair;t.authTicketInfoSelector=e=>e.userSession.authTicketInfo;t.personalSettingsSelector=e=>e.userSession.personalSettings;t.protectPasswordsSettingSelector=e=>{const{ProtectPasswords:t}=e.userSession.personalSettings;return t};t.richIconsSettingSelector=e=>{const t=e.userSession.spaceData.spaces.find((e=>"accepted"===e.details.status));if(t){const e=t.details?.info?.richIconsEnabled;if(!e)return!1}const{RichIcons:r}=e.userSession.personalSettings;return r};t.isAuthenticatedSelector=e=>e.userSession.account.isAuthenticated;t.appVersionSelector=e=>(0,a.platformInfoSelector)(e).appVersion;t.platformNameSelector=e=>(0,a.platformInfoSelector)(e).platformName;t.applicationBuildTypeSelector=e=>(0,a.platformInfoSelector)(e).buildType;t.analyticsIdsSelector=e=>e.userSession.session.analyticsIds;t.publicUserIdSelector=e=>e.userSession.session.publicUserId;t.didOpenSelector=e=>e.userSession.session.didOpen;t.lastMasterPasswordCheckSelector=e=>e.userSession.session.lastMasterPasswordCheck;t.isPaymentFailureChurningDismissedSelector=e=>{return t=e.userSession.localSettings.premiumChurningDismissDate,Date.now()-t>864e5;var t};t.analyticsInstallationIdSelector=(0,o.createSelector)(t.userLoginSelector,t.isAuthenticatedSelector,t.applicationBuildTypeSelector,((e,t,r)=>{const o=e&&(0,s.isInternalTestUser)(e)&&t;return r===n.ApplicationBuildType.DEV||r===n.ApplicationBuildType.QA||o?(0,i.getCommonAppSetting)("installationId"):null}));t.getCredentialSearchOrderSelector=e=>e.userSession.localSettings.credentialSearchOrder??n.CredentialSearchOrder.NAME;t.sessionEncryptorKeysSelector=e=>({masterPassword:(0,t.masterPasswordSelector)(e),serverKey:(0,t.serverKeySelector)(e),localKey:(0,t.localKeySelector)(e),remoteKey:(0,t.remoteKeySelector)(e)});t.sessionInfoSelector=e=>({password:(0,t.masterPasswordSelector)(e),serverKey:(0,t.serverKeySelector)(e),localKey:(0,t.localKeySelector)(e),cryptoUserPayload:(0,t.userDefaultCryptoSelector)(e),cryptoFixedSalt:(0,t.userCryptoFixedSalt)(e),devicesKeys:(0,a.deviceKeysSelector)(e)});t.userCryptoSettingsSelector=e=>({cryptoUserPayload:e.userSession.personalSettings.CryptoUserPayload,cryptoFixedSalt:e.userSession.personalSettings.CryptoFixedSalt})},27754:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sessionStartTimeSelector=t.sessionIdSelector=void 0;t.sessionIdSelector=e=>e.userSession.session.sessionId;t.sessionStartTimeSelector=e=>e.userSession.account.sessionStartTime},38981:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSSOUserSelector=t.ssoProviderInfoSelector=t.ssoMigrationInfoSelector=t.serviceProviderUrlSelector=t.ssoSettingsSelector=void 0;const o=r(58713),n=r(32034);t.ssoSettingsSelector=e=>e.userSession.ssoSettings;t.serviceProviderUrlSelector=e=>(0,t.ssoSettingsSelector)(e).serviceProviderUrl,t.ssoMigrationInfoSelector=(0,n.createSelector)(t.ssoSettingsSelector,(({migration:e,serviceProviderUrl:t,ssoToken:r})=>({migration:r?o.AuthenticationFlowContracts.SSOMigrationType.MP_TO_SSO_WITH_INFO:e,serviceProviderUrl:t}))),t.ssoProviderInfoSelector=(0,n.createSelector)(t.ssoSettingsSelector,(({serviceProviderUrl:e,isNitroProvider:t})=>({serviceProviderUrl:e,isNitroProvider:t})));t.isSSOUserSelector=e=>e.userSession.ssoSettings.ssoUser},87881:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(28096),n=r(35507),a=r(16593),i=r(56915),s=r(75004),c=r(54642),d=r(65210),l=r(45127),u=r(35924),p=r(18216);t.setupSubscriptions=function(e,t){const{storeService:r,wsService:S,sessionService:m}=t;e.coreServicesReady.on((async e=>{if(e.initMode===p.InitMode.Resume&&(t.sessionService.tryRestoreInstance(),m.isSessionStarted())){console.log("[background/carbon] Loading non non-resumable data from storage");const{user:e}=t.sessionService.getInstance();await e.loadNonResumableSessionData(),console.log("[background/carbon] Done loading non non-resumable data from storage")}})),e.carbonSessionOpened.on((()=>{r.dispatch((0,u.resetLoginStepInfo)());const e=r.getState(),t=(0,a.premiumStatusSelector)(e);1!==(0,c.getUserMessagesByTypeSelector)(e,l.UserMessageTypes.TRIAL_EXPIRED).length||(0,s.isTrialExpired)({premiumStatus:t})||(r.dispatch((0,d.userMessagesDismissed)((0,s.createTrialExpiredUserMessage)())),m.getInstance().user.persistLocalSettings())})),e.sessionClosed.on((e=>{(0,o.triggerLoginStatusChanged)({loggedIn:!1,login:e.login})})),e.familyMemberLeft.on((async()=>{const e=(0,a.userLoginSelector)(r.getState()),t=(0,i.ukiSelector)(r.getState());await(0,n.refreshPremiumStatus)(r,S,e,t)}))}},25576:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.B2CStatusCode=t.CancelDashlaneAuthenticatorRegistration=t.PersistData=t.SessionResumingCode=t.extractExtraDeviceToken=t.makeExtraDeviceToken=t.extractOTP=t.makeSsoToken=t.makeOTP=t.extractEmailToken=t.makeEmailToken=t.remoteSupportedAuthenticationMethod=t.localSupportedAuthenticationMethod=void 0,t.localSupportedAuthenticationMethod=["totp","duo_push"],t.remoteSupportedAuthenticationMethod=["email_token","totp","duo_push","dashlane_authenticator","u2f"];t.makeEmailToken=e=>({type:"emailToken",value:e});t.extractEmailToken=e=>e.value;t.makeOTP=e=>({type:"otp",value:e});t.makeSsoToken=e=>({type:"sso",value:e});t.extractOTP=e=>e.value;t.makeExtraDeviceToken=e=>({type:"extraDeviceToken",value:e});t.extractExtraDeviceToken=e=>e.value,function(e){e.INVALID_LOGIN_IN_STORE="invalid_login_in_store"}(t.SessionResumingCode||(t.SessionResumingCode={})),function(e){e[e.PERSIST_DATA_YES=0]="PERSIST_DATA_YES",e[e.PERSIST_DATA_NO=1]="PERSIST_DATA_NO"}(t.PersistData||(t.PersistData={})),function(e){e.CANCELLED="cancelled",e.COMPLETED="completed"}(t.CancelDashlaneAuthenticatorRegistration||(t.CancelDashlaneAuthenticatorRegistration={})),function(e){e.Free="free",e.Subscribed="subscribed",e.Legacy="legacy"}(t.B2CStatusCode||(t.B2CStatusCode={}))},34376:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentUserInfo=void 0;const o=r(56915);t.getCurrentUserInfo=function(e){const t=e.getUserSession().keyPair;return{login:e.getUserLogin(),uki:(0,o.ukiSelector)(e.getState()),privateKey:t&&t.privateKey}}},80687:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.authorizationMiddleware=void 0;t.authorizationMiddleware=e=>async t=>{const r=await t,{config:{allowedPlatforms:o},services:{storeService:n}}=r,{platformName:a}=n.getPlatformInfo();if(o&&!o.includes(a))throw new Error("You are not allowed to connect to this slot");return await e(t)}},18324:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.debugMiddleware=t.perfDebugMiddleware=void 0;r(4939),new Map;t.perfDebugMiddleware=e=>async t=>e(t);t.debugMiddleware=e=>async t=>{const r=await t;try{console.log(`[background/carbon] Processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`);const o=await e(t);return console.log(`[background/carbon] Done processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`),o}catch(e){throw console.error(`[background/carbon] Error while processing CarbonApi request (type:${r.messageType}, name:${r.messageName}, id:${r.requestId})`,e),e}}},77686:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.perfDebugMiddleware=t.debugMiddleware=t.authorizationMiddleware=void 0;var o=r(80687);Object.defineProperty(t,"authorizationMiddleware",{enumerable:!0,get:function(){return o.authorizationMiddleware}});var n=r(18324);Object.defineProperty(t,"debugMiddleware",{enumerable:!0,get:function(){return n.debugMiddleware}}),Object.defineProperty(t,"perfDebugMiddleware",{enumerable:!0,get:function(){return n.perfDebugMiddleware}})},57307:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommandQueryBus=void 0;const o=r(18948),n=r(3343),a=r(35088),i=r(17338),s=r(25566),c=r(77686);class d{constructor(e){this.services=(0,i.getCoreServices)(e)}register(e){const{commands:t,queries:r,liveQueries:o}=e;Object.keys(t).forEach((e=>{this._registerCommand(e,t[e])})),Object.keys(r).forEach((e=>{this._registerQuery(e,r[e])})),Object.keys(o).forEach((e=>{this._registerLiveQuery(e,o[e])}))}_registerCommand(e,t){const r=r=>Promise.resolve({messageType:"command",messageName:e,requestId:(0,a.v4)(),services:this.services,arg:r,config:t,logTags:[d.API_LOG_TAG,d.COMMAND_LOG_TAG]}),o=[c.debugMiddleware,c.authorizationMiddleware,c.perfDebugMiddleware,()=>e=>e.then((async e=>{const{arg:t,config:r,services:o}=e,{handler:n}=r,a=await n(o,t);return{...e,result:a}}))];this.registerCommand(e,(e=>(0,s.buildMiddlewarePipeline)(...o)(r(e)).then((e=>e.result))))}_registerQuery(e,t){const r=r=>Promise.resolve({messageType:"query",messageName:e,requestId:(0,a.v4)(),services:this.services,arg:r,config:t,logTags:[d.API_LOG_TAG,d.QUERY_LOG_TAG]}),o=[c.debugMiddleware,c.authorizationMiddleware,c.perfDebugMiddleware,()=>e=>e.then((async e=>{const{arg:r,services:o}=e,{selector:n,staticDataHandler:a,selectorFactory:i}=t;if(n){const{storeService:t}=o,a=await n(t.getState(),r);return{...e,result:a}}if(i){const{storeService:t}=o,n=await i(this.services),a=await Promise.resolve(n(t.getState(),r));return{...e,result:a}}{const t=a(r);return{...e,result:t}}}))];this.registerQuery(e,(e=>(0,s.buildMiddlewarePipeline)(...o)(r(e)).then((e=>e.result))))}_registerLiveQuery(e,t){this.registerLiveQuery(e,(r=>{const{operator:a,subject:i,operatorFactory:s}=t;if(a){const{storeService:t}=this.services;return t.getState$().pipe(a(r),(0,n.skip)(1),(0,n.catchError)((t=>{throw console.error(`[background/carbon] Error while processing CarbonApi liveQuery (name:${e})`,t),t})))}if(s){const{storeService:t}=this.services,a=t.getState$();return(0,o.from)(s(t.getState(),this.services)).pipe((0,o.switchMap)((e=>a.pipe(e(r),(0,n.skip)(1)))),(0,n.catchError)((t=>{throw console.error(`[background/carbon] Error while processing CarbonApi liveQuery (name:${e})`,t),t})))}return i(r)}))}}t.CommandQueryBus=d,d.API_LOG_TAG="API",d.COMMAND_LOG_TAG="Command",d.QUERY_LOG_TAG="Query"},88626:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(91069),t),n(r(57307),t)},91069:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},33968:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventStore=void 0;const o=r(18948),n=r(35088),a=r(3343),i=r(17825),s=r(47746);t.EventStore=class{constructor(){this._operation$=new o.Subject,this.subs=new Set,this.add=async(e,t)=>{const r=(0,n.v4)(),o=new Promise(((e,t)=>{const o=this._operationResults$.subscribe((n=>{n.id===r&&(!0===n.success?e(r):t(n.error),o.unsubscribe(),this.subs.delete(o))}));this.subs.add(o)}));return this.triggerAdd(e,r,t),o},this.remove=async(e,t)=>{const r=new Promise(((e,r)=>{const o=this._operationResults$.subscribe((n=>{n.id===t&&(!0===n.success?e():r(n.error),o.unsubscribe(),this.subs.delete(o))}));this.subs.add(o)}));return this.triggerRemove(e,t),r},this.removeAll=async e=>{const t=(0,n.v4)(),r=new Promise(((e,r)=>{const o=this._operationResults$.subscribe((n=>{n.id===t&&(!0===n.success?e():r(n.error),o.unsubscribe(),this.subs.delete(o))}));this.subs.add(o)}));return this.triggerRemoveAll(e,t),r},this.onAdd=async e=>{const{id:t,event:r,topic:o,type:n}=e,a={id:t,topic:o,type:n};try{const e=await this.retrieve(),n={id:t,event:r},i={...e,[o]:[...e[o]||[],n]};return await this.store(i),{...a,success:!0,event:r}}catch(e){return{...a,success:!1,error:e}}},this.onRemove=async e=>{const{id:t,topic:r,type:o}=e,n={id:t,topic:r,type:o};try{const e=await this.retrieve(),o={...e,[r]:(e[r]||[]).filter((e=>e.id!==t))};return await this.store(o),{...n,success:!0}}catch(e){return{...n,success:!1,error:e}}},this.onRemoveAll=async e=>{const{id:t,topic:r,type:o}=e,n={id:t,topic:r,type:o};try{const e={...await this.retrieve(),[r]:[]};return await this.store(e),{...n,success:!0}}catch(e){return{...n,success:!1,error:e}}},this.onOperation=async e=>{switch(e.type){case s.OperationType.Add:return this.onAdd(e);case s.OperationType.Remove:return this.onRemove(e);case s.OperationType.RemoveAll:return this.onRemoveAll(e);default:return(0,i.assertUnreachable)(e)}},this.setupOperationsHandling=()=>{const e=this._operation$.pipe((0,a.concatMap)(this.onOperation),(0,a.share)()),t=e.subscribe();this.subs.add(t),this._operationResults$=e},this.setupOperationsHandling()}newItems$(e){return this._operationResults$.pipe((0,a.filter)((e=>e.type===s.OperationType.Add&&e.success)),(0,a.filter)((t=>t.topic===e)))}async getItems(e){return(await this.retrieve())[e]}teardown(){this.subs.forEach((e=>e.unsubscribe()))}async triggerAdd(e,t,r){const o={event:r,id:t,topic:e,type:s.OperationType.Add};this._operation$.next(o)}async triggerRemove(e,t){const r={id:t,topic:e,type:s.OperationType.Remove};this._operation$.next(r)}async triggerRemoveAll(e,t){const r={id:t,topic:e,type:s.OperationType.RemoveAll};this._operation$.next(r)}}},47746:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OperationType=void 0,function(e){e.Add="add",e.Remove="remove",e.RemoveAll="removeAll"}(t.OperationType||(t.OperationType={}))},30137:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(88626),t)},25566:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildMiddlewarePipeline=void 0;var o=r(3201);Object.defineProperty(t,"buildMiddlewarePipeline",{enumerable:!0,get:function(){return o.buildMiddlewarePipeline}})},3201:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildMiddlewarePipeline=void 0;t.buildMiddlewarePipeline=(...e)=>t=>e.reduceRight(((e,t)=>t(e)),(e=>e))(t)},36768:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(84511),n=r(80993),a=r(90021),i=r(78987),s=r(23944),c=r(22652),d=r(67312),l=r(43712),u=r(96123);t.config={commands:{convertItemToDashlaneXml:{handler:d.convertItemToDashlaneXmlHandler},convertDashlaneXmlToItem:{handler:l.convertDashlaneXmlToItem},saveSharedItemsToVault:{handler:u.saveSharedItemsToVault}},queries:{getAllSharedItemIds:{selector:n.sortedSharedItemIdsSelector},getMyAcceptedUserGroups:{selector:o.myAcceptedUserGroupsSelector},getSharingCapacity:{selector:a.sharingCapacitySelector},...s.config.queries,...c.config.queries},liveQueries:{liveAllSharedItemIds:{operator:i.allSharedItemIds$},liveMyAcceptedUserGroups:{operator:i.myAcceptedUserGroups$},liveSharingCapacity:{operator:i.sharingCapacity$},...s.config.liveQueries,...c.config.liveQueries}}},36884:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemGroupService=t.UPDATE_ITEM_GROUP_MEMBERS=t.SHARING_VERSION=t.REVOKE_ITEM_GROUP_MEMBERS=t.REFUSE_ITEM_GROUP=t.INVITE_ITEM_GROUP_MEMBERS=t.DELETE_ITEM_GROUP=t.CREATE_SPECIAL_ITEM_GROUP=t.CREATE_ITEM_GROUP=t.ACCEPT_ITEM_GROUP=void 0;const o=r(78320),n=r(36467),a=r(82366),i=r(36513),s=r(58107),c=r(93513);function d(e,t,r){const o=r&&r.users&&r.users.find((e=>e.userId===t.login)),n=o&&o.groupKey;return e.asymmetricEncryption.decrypt(t.privateKey,n)}function l(e,t,r,o){return e.itemGroup.deleteGroup(t,r,o).then((({itemGroups:e})=>e)).catch((n=>{if("Conflict"===n.message)return function(e,t,r,o){const n={type:"getSharing",sharingVersion:4,userGroupIds:o};return e.sharing.get(t,r,n).then((({itemGroupErrors:e,itemGroups:t})=>{if(e&&e.length)throw new Error(e[0].message);return t}))}(e,t,r,[o.groupId]).then((n=>{const[{revision:a,teamId:i}]=n;return i?e.itemGroup.deleteGroup(t,r,{...o,revision:a}).then((({itemGroups:e})=>e)):n}));throw n}))}function u(e,r,o,n,a,i){const s=a||void 0;return{...i?{userGroupId:i}:{},...n&&n.length?{itemsForEmailing:n}:{},acceptSignature:e,groupId:r,revision:o,sharingVersion:t.SHARING_VERSION,type:t.ACCEPT_ITEM_GROUP,auditLogDetails:s}}function p(e,r,o,n,a){const i=a?{userGroupId:a}:{},s=n||void 0;return{...o&&o.length?{itemsForEmailing:o}:{},...i,groupId:e,revision:r,sharingVersion:t.SHARING_VERSION,type:t.REFUSE_ITEM_GROUP,auditLogDetails:s}}function S(e,r,o,n,a,i){const s=i||void 0;return{...o&&o.length?{groups:o}:{},...a&&a.length?{itemsForEmailing:a}:{},groupId:e,items:n,sharingVersion:t.SHARING_VERSION,type:t.CREATE_ITEM_GROUP,users:r,auditLogDetails:s}}function m(e,r,o,n,a,i){const s=i||void 0;return{...n&&n.length?{groups:n}:{},...o&&o.length?{users:o}:{},...a&&a.length?{itemsForEmailing:a}:{},revision:r,groupId:e,sharingVersion:t.SHARING_VERSION,type:t.INVITE_ITEM_GROUP_MEMBERS,auditLogDetails:s}}function g(e,r,o,n,a,i="manual"){const s=a||void 0;return{...n&&n.length?{groups:n}:{},...o&&o.length?{users:o}:{},groupId:e,revision:r,sharingVersion:t.SHARING_VERSION,type:t.REVOKE_ITEM_GROUP_MEMBERS,auditLogDetails:s,origin:i}}function y(e,r,o,n){return{...n&&n.length?{groups:n}:{},...o&&o.length?{users:o}:{},groupId:e,revision:r,sharingVersion:t.SHARING_VERSION,type:t.UPDATE_ITEM_GROUP_MEMBERS}}async function A(e,t,r){const o=r?await async function(e,t,r){const o=await(0,i.makeCryptoService)(),n=c.encode(e),s=await o.symmetricEncryption.signHmacSHA256(t,n);await(0,a.validateProposeSignature)("[ItemGroupService] - makeUserUpdatePublicKey",o,t,s,n);return{groupKey:await o.asymmetricEncryption.encrypt(r,t),proposeSignature:s}}(e,r.rawItemGroupKey,r.userPublicKey):{};return{...o,permission:t,userId:e}}function f(e,t){return{permission:t,groupId:e}}async function E(e,t,r,o,n){const s=await(0,i.makeCryptoService)(),d=t&&t.login&&t.publicKey,l=d?t.login:e,u=d?{}:{proposeSignatureUsingAlias:!0},p=d?{groupKey:await s.asymmetricEncryption.encrypt(t.publicKey,n)}:{},S=c.encode(l),m=await s.symmetricEncryption.signHmacSHA256(n,S);await(0,a.validateProposeSignature)("[ItemGroupService] - makeUserUpload",s,n,m,S);return{...t.privateKey?{acceptSignature:await v(r,n,t.privateKey)}:{},...u,...p,alias:e,permission:o,proposeSignature:m,userId:l}}async function h(e,t,r,o,n,d){const{groupId:l}=e,u=await(0,i.makeCryptoService)();if(!(e.users||[]).find((e=>e.userId===n)))throw new Error("[ItemGroupService] - makeUserGroupInvite: Trying to share an item to a userGroup that I'm not part of.");const p=await(0,s.getUserGroupPrivateKey)(e,o,n),S=await u.asymmetricEncryption.encrypt(e.publicKey,r),m=c.encode(l),g=await u.symmetricEncryption.signHmacSHA256(r,m);await(0,a.validateProposeSignature)("[ItemGroupService] - makeUserGroupInvite",u,r,g,m);return{groupId:l,permission:t,groupKey:S,proposeSignature:g,acceptSignature:await v(d,r,p)}}async function v(e,t,r){const o=await(0,i.makeCryptoService)(),n=c.encode(`${e}-accepted-${t}`);return await o.asymmetricEncryption.sign(r,n)}t.ACCEPT_ITEM_GROUP="acceptItemGroup",t.CREATE_ITEM_GROUP="createItemGroup",t.CREATE_SPECIAL_ITEM_GROUP="createUserGroupsItemGroup",t.DELETE_ITEM_GROUP="deleteItemGroup",t.INVITE_ITEM_GROUP_MEMBERS="inviteItemGroupMembers",t.REFUSE_ITEM_GROUP="refuseItemGroup",t.REVOKE_ITEM_GROUP_MEMBERS="revokeItemGroupMembers",t.SHARING_VERSION=4,t.UPDATE_ITEM_GROUP_MEMBERS="updateItemGroupMembers",t.makeItemGroupService=function(e,r){return{makeCreateSpecialItemGroupEvent:(e,i,s)=>async function(e,r,i,s){const c=(0,o.generateItemUuid)(),[l,u]=await Promise.all([e.symmetricEncryption.generateNewAESKey(),d(e,r,i)]),p=await e.symmetricEncryption.decryptAES256(u,i.privateKey),[S,m,g]=await Promise.all([e.asymmetricEncryption.encrypt(i.publicKey,l),(0,a.generateProposeSignature)(e,l,i.groupId),(0,a.generateAcceptSignature)(e,p,c,l)]),y={type:t.CREATE_SPECIAL_ITEM_GROUP,sharingVersion:t.SHARING_VERSION,groupId:c,teamId:i.teamId,alias:r.login,groups:[{groupId:i.groupId,permission:"admin",groupKey:S,proposeSignature:m,acceptSignature:g}]};return s.length&&(y.items=await(0,n.createItemsForUserGroups)(e,l,s)),y}(r,e,i,s),makeCreateItemGroupEvent:S,makeInviteItemGroupMembers:m,makeUpdateItemGroupMembers:y,makeUserUpdate:A,makeUserGroupUpdate:f,makeUserUpload:E,makeUserGroupInvite:h,createSpecialItemGroup:({login:t,uki:r},o)=>e.itemGroup.createSpecialItemGroup(t,r,o),makeDeleteItemGroupEvent:(e,r)=>async function(e,r){return{type:t.DELETE_ITEM_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r}}(e,r),deleteItemGroup:({login:t,uki:r},o)=>l(e,t,r,o),makeAcceptItemGroupEvent:u,makeRefuseItemGroupEvent:p,makeRevokeItemGroupMembers:g}}},10294:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeItemService=t.SHARING_VERSION=t.UPDATE_ITEM=t.ADD_ITEMS=t.REMOVE_ITEMS=void 0;const o=r(36513);async function n(e,t,r){return{itemId:e,itemKey:t,content:r}}function a(e){const t=function(e){switch(e.kwType){case"KWAuthentifiant":return"password";case"KWSecureNote":return"note";default:return"secret"}}(e);return{type:t,name:e.Title||`Untitled ${t}`}}async function i(e,r,o){return{type:t.ADD_ITEMS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,items:o}}async function s(e,r,n){if(!n)throw new Error("Missing payload. See method documentation.");const{item:a,itemId:i,itemContent:s}=n;if(!(a||i&&s))throw new Error("insufficient arguments: item or (itemId and content) must be provided.");if(a&&(i||s))throw new Error("item and (itemId | content) cannot both be provided");const c=(0,o.makeSymmetricEncryption)(),d=s??await c.encryptSharingItem(r,a);return{type:t.UPDATE_ITEM,sharingVersion:t.SHARING_VERSION,itemId:i??a?.Id,content:d,timestamp:e}}t.REMOVE_ITEMS="removeItems",t.ADD_ITEMS="addItems",t.UPDATE_ITEM="updateItem",t.SHARING_VERSION=4;const c=(e,t,r,o)=>e.itemGroup.updateItem(t,r,o);function d(e,t,r,o){return e.itemGroup.addItems(t,r,o)}const l=(e,r,o)=>Promise.resolve({type:t.REMOVE_ITEMS,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r,items:[...o]}),u=(e,t,r,o)=>e.itemGroup.removeItems(t,r,o);t.makeItemService=function(){return{makeItemUpload:n,makeAddItemsEvent:i,makeItemForEmailing:a,addItems:d,makeUpdateItemEvent:s,updateItem:c,makeRemoveItemsEvent:l,removeItems:u}}},58107:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingUsersFromItemGroups=t.doesItemGroupExistInSpace=t.findUserGroupItemGroups=t.findUserGroup=t.findMyAcceptedUserGroups=t.getRecipientsCount=t.getUserRecipients=t.getGroupRecipients=t.doesUserReceiveItemGroupViaGroup=t.isUserLastAdmin=t.getDecipheredItemKey=t.isItemWithoutItemGroup=t.isItemGroupAccepted=t.getItemGroupPendingUserMember=t.decryptItemKey=t.getSharingUserPermission=t.getUserGroupPermission=t.getMyItemGroups=t.findItem=t.isCollectionUserGroupProposeSignatureValid=t.isUserGroupUserProposeSignatureValid=t.areCollectionUsersProposeSignaturesValid=t.areUserGroupUsersProposeSignaturesValid=t.getDecryptedUserGroupKey=t.isUserGroupPersonalSignatureValid=t.isGroupSignatureValid=t.decryptUserGroupPrivateKey=t.getCollectionPrivateKeyForUser=t.getCollectionPrivateKeyForUserGroup=t.getUserGroupPrivateKey=t.decryptGroupKey=t.getDecryptedItemGroupKeyFromCollectionMemberViaUserGroup=t.getDecryptedPrivateCollectionKeyFromUserGroup=t.getDecryptedItemGroupKeyFromCollectionMemberAsUser=t.getDecryptedItemGroupKeyFromUserGroupMember=t.getDecryptedItemGroupKeyFromUser=t.getItemGroupKey=t.findMyItemGroupCollectionMemberAsUser=t.findMyItemGroupCollectionMemberViaUserGroup=t.findMyItemGroupUserGroupMember=t.findMyItemGroupUser=t.getItemGroupActiveUserGroupMembers=t.isLastActiveUserInItemGroupAndAdmin=t.userMemberIsAdmin=void 0;const o=r(82366),n=r(36513),a=r(49551),i=r(19736),s=r(81438),c=r(71646),d=r(70252),l=r(16593),u=r(95458),p=r(64202),S=r(93513),m=e=>["accepted","pending"].includes(e.status);function g(e,t){const{users:r}=e;return(r||[]).find((e=>e.userId===t))}function y(e,t,r){const o=(t||[]).filter((e=>(e.users||[]).map((e=>e.userId)).includes(r))).map((e=>e.groupId));return(e.groups||[]).filter((e=>"accepted"===e.status)).find((e=>o.includes(e.groupId)))}function A(e,t,r,o){if(!o)return null;try{const n=e=>(e.userGroups||[]).flatMap((e=>t.find((t=>t.groupId===e.uuid))?.users)).filter((e=>void 0!==e)).find((e=>"accepted"===e.status&&e.userId===r)),a=o.filter(n);if(0===a.length)return null;const i=a.map((e=>e.uuid)),s=(e.collections||[]).filter((e=>"accepted"===e.status)).find((e=>i.includes(e.uuid)));if(!s)return null;const c=o.find((e=>e.uuid===s.uuid));if(!c)return null;const d=c.userGroups.map((e=>e.uuid)),l=t.find((e=>d.includes(e.groupId)));return l?{userGroup:l,member:s}:null}catch(e){const t=new Error(`[SharingSync] - find collection member failed: ${e}`);return(0,d.sendExceptionLog)({error:t}),null}}function f(e,t,r){if(!r)return null;try{const o=e=>(e.users||[]).map((e=>e.login)).includes(t),n=r.filter(o).map((e=>e.uuid));return(e.collections||[]).filter((e=>"accepted"===e.status)).find((e=>n.includes(e.uuid)))}catch(e){const t=new Error(`[SharingSync] - find collection member failed: ${e}`);return(0,d.sendExceptionLog)({error:t}),null}}async function E(e,t){try{return await I(e.groupKey,t)}catch{return null}}async function h(e,t,r,o){const n=(t||[]).find((t=>t.groupId===e.groupId));if(!n)return null;try{const t=await C(n,r,o);return await I(e.groupKey,t)}catch{return null}}async function v(e,t,r,o){if(!o)return null;try{const n=o.find((t=>t.uuid===e.uuid));if(!n)return null;const a=await D(n,t,r);return await I(e.itemGroupKey,a)}catch(e){const t=new Error(`[SharingSync] - decrypt collection member item group key failed: ${e}`);return(0,d.sendExceptionLog)({error:t}),null}}async function T(e,t,r,o){const n=await C(t,r,o);return await P(e,n,t.groupId)}async function _(e,t,r,o,n){if(!n)return null;try{const a=n.find((t=>t.uuid===e.uuid));if(!a)return null;const i=await T(a,t,r,o);return await I(e.itemGroupKey,i)}catch(e){const t=new Error(`[SharingSync] - decrypt collection member item group key failed: ${e}`);return(0,d.sendExceptionLog)({error:t}),null}}async function I(e,t){return(0,n.makeCryptoService)().asymmetricEncryption.decrypt(t,e)}async function C(e,t,r){const o=e.users.find((e=>e.userId===r)).groupKey,n=await I(o,t);return O(e.privateKey,n)}async function P(e,t,r){const o=e.userGroups.find((e=>e.uuid===r)).collectionKey,n=await I(o,t);return O(e.privateKey,n)}async function D(e,t,r){const o=e.users.find((e=>e.login===r)).collectionKey,n=await I(o,t);return O(e.privateKey,n)}async function O(e,t){return(0,n.makeCryptoService)().symmetricEncryption.decryptAES256(t,e)}async function b(e,t,r,a){const i=S.encode(`${e}-accepted-${r}`);return(0,o.isAcceptSignatureValid)((0,n.makeCryptoService)(),t,a,i)}async function w(e,t){let r="";"userId"in e?r=e.userId:"login"in e&&(r=e.login);try{return await(0,n.makeCryptoService)().symmetricEncryption.verifyHmacSHA256(t,e.proposeSignature,S.encode(r))}catch{return!1}}async function N(e,t){try{return await(0,n.makeCryptoService)().symmetricEncryption.verifyHmacSHA256(t,e.proposeSignature,S.encode(e.uuid))}catch{return!1}}async function R(e,t){return(0,n.makeCryptoService)().symmetricEncryption.decryptAES256(t,e)}function M(e,t){const{itemGroups:r}=e,o=r.find((e=>(e.items||[]).some((e=>e.itemId===t))));return o?(o.groups||[]).filter((e=>!["revoked","refused"].includes(e.status))):[]}function L(e,t){const{itemGroups:r}=e,o=r.find((e=>(e.items||[]).some((e=>e.itemId===t))));return o?(o.users||[]).filter((e=>!["revoked","refused"].includes(e.status))):[]}function U(e,t,r){const o=t.items?.some((o=>{const n=(0,i.credentialSelector)(e,o.itemId)??(0,s.noteSelector)(e,o.itemId)??(0,p.secretSelector)(e,o.itemId);return void 0===n?(function(e,t,r,o){try{const n=["[doesItemGroupExistInSpace] Undefined item found",`ItemGroup has ${e.items.length} items`];if(e.items.length>1){const a=e.items.filter((e=>e.itemId!==t.itemId)),c=a.reduce(((e,t)=>{const n=(0,i.credentialSelector)(r,t.itemId)??(0,s.noteSelector)(r,t.itemId);return n&&n.SpaceId===o?e+1:e}),0),d=a.length-c;n.push(`${c} other items in itemGroup are in the active space`),n.push(`${d} other items in itemGroup are not in the active space`)}(0,l.activeSpacesSelector)(r).some((e=>e&&e.teamId===o&&(0,u.isPremiumStatusSpaceQuarantined)(e)))&&n.push("Active space is quarantined"),null===t.itemKey&&n.push("Item Key is null"),void 0===t.itemKey&&n.push("Item Key is undefined"),""===t.itemKey&&n.push("Item Key is an empty string"),null===t.itemId&&n.push("Item ID is null"),void 0===t.itemId&&n.push("Item ID is undefined"),""===t.itemId&&n.push("Item ID is an empty string"),(0,d.sendExceptionLog)({error:new Error(n.join("\n"))})}catch(e){(0,d.sendExceptionLog)({error:e})}}(t,o,e,r),!0):n.SpaceId!==r}));return!o}t.userMemberIsAdmin=e=>"accepted"===e.status&&"admin"===e.permission,t.isLastActiveUserInItemGroupAndAdmin=function(e,r){const o=e.collections;if(o&&o.length>0)return!1;const{users:n,groups:a}=e,i=!a||0===a.filter(m).length,s=n&&1===n.filter(m).length&&n[0].userId===r&&(0,t.userMemberIsAdmin)(n[0]);return i&&s},t.getItemGroupActiveUserGroupMembers=function(e){return(e.groups||[]).filter(m)},t.findMyItemGroupUser=g,t.findMyItemGroupUserGroupMember=y,t.findMyItemGroupCollectionMemberViaUserGroup=A,t.findMyItemGroupCollectionMemberAsUser=f,t.getItemGroupKey=async function(e,t,r,o,n){const a=g(e,o),i=y(e,t,o),s=f(e,o,n),c=A(e,t,o,n);if(!(a||i||s||c))return null;if(a)return await E(a,r);if(i)return await h(i,t,r,o);if(s){return await v(s,r,o,n)}if(c){return await _(c.member,c.userGroup,r,o,n)}return null},t.getDecryptedItemGroupKeyFromUser=E,t.getDecryptedItemGroupKeyFromUserGroupMember=h,t.getDecryptedItemGroupKeyFromCollectionMemberAsUser=v,t.getDecryptedPrivateCollectionKeyFromUserGroup=T,t.getDecryptedItemGroupKeyFromCollectionMemberViaUserGroup=_,t.decryptGroupKey=I,t.getUserGroupPrivateKey=C,t.getCollectionPrivateKeyForUserGroup=P,t.getCollectionPrivateKeyForUser=D,t.decryptUserGroupPrivateKey=O,t.isGroupSignatureValid=b,t.isUserGroupPersonalSignatureValid=async function(e,t,r,o){try{return await b(e,t,r,o)}catch{return!1}},t.getDecryptedUserGroupKey=async function(e,t){try{return await I(e,t)}catch{return null}},t.areUserGroupUsersProposeSignaturesValid=async function(e,t){const r=(e||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>w(e,t)));return(await Promise.all(r)).every(Boolean)},t.areCollectionUsersProposeSignaturesValid=async function(e,t){const{userGroups:r,users:o}=e,n=(o||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>w(e,t))),a=(r||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>N(e,t))),i=await Promise.all(n),s=await Promise.all(a);return i.every(Boolean)&&s.every(Boolean)},t.isUserGroupUserProposeSignatureValid=w,t.isCollectionUserGroupProposeSignatureValid=N,t.findItem=function(e,t){const{credentials:r,notes:o,secrets:n}=e.getPersonalData(),i=[...r,...o,...n];return(0,a.findDataModelObject)(t,i)},t.getMyItemGroups=function(e,t){const r=e.userGroups.filter((e=>e.users.some((e=>e.userId===t&&"accepted"===e.status)))),o=new Set(r.map((e=>e.groupId)));return e.itemGroups.filter((e=>{const r=e.users&&e.users.some((e=>e.userId===t)),n=e.groups&&e.groups.some((e=>o.has(e.groupId)));return r||n}))},t.getUserGroupPermission=function(e,t){return(e?.groups||[]).find((e=>e?.groupId===t))?.permission},t.getSharingUserPermission=function(e,t){return(e.users||[]).find((e=>e.userId===t))?.permission},t.decryptItemKey=R,t.getItemGroupPendingUserMember=function(e,t){return(e.users||[]).find((e=>e.userId===t&&"pending"===e.status))},t.isItemGroupAccepted=function(e,t,r,o){if(function(e,t,r,o){if(!o)return!1;try{const n=(e.collections||[]).filter((e=>"accepted"===e.status&&e.acceptSignature)).map((e=>e.uuid)),a=o.filter((e=>n.includes(e.uuid)));if(a.flatMap((e=>e.users)).some((e=>e.acceptSignature&&e.login===r)))return!0;return a.flatMap((e=>e.userGroups)).map((e=>t.find((t=>t.groupId===e.uuid)))).filter((e=>void 0!==e)).some((e=>(e.users||[]).some((e=>e.userId===r&&"accepted"===e.status&&Boolean(e.acceptSignature)))))}catch(e){const t=new Error(`[SharingSync] - item group accepted check failed: ${e}`);return(0,d.sendExceptionLog)({error:t}),!1}}(e,t,r,o))return!0;if(function(e,t){return(e.users||[]).some((e=>e.userId===t&&"accepted"===e.status&&Boolean(e.acceptSignature)))}(e,r))return!0;return function(e,t,r){const o=(e.groups||[]).filter((e=>"accepted"===e.status&&e.acceptSignature)),n=o.map((e=>e.groupId)),a=t.filter((e=>n.includes(e.groupId)));return a.some((e=>(e.users||[]).some((e=>e.userId===r&&"accepted"===e.status&&Boolean(e.acceptSignature)))))}(e,t,r)},t.isItemWithoutItemGroup=function(e,t){return!(0,c.findItemItemGroup)(e,t)},t.getDecipheredItemKey=async function(e,t,r){const o=await I(e,r);try{return await R(t,o)}catch(e){return}},t.isUserLastAdmin=function(e,t){const r=function(e){return(e.users||[]).filter((({permission:e,rsaStatus:t,status:r})=>"admin"===e&&"sharingKeys"===t&&"accepted"===r))}(e),o=function(e){return(e.groups||[]).filter((({permission:e,status:t})=>"admin"===e&&"accepted"===t))}(e),n=r.some((e=>e.userId===t)),a=r.filter((({userId:e})=>t!==e)),i=o.length+a.length>0;return n&&!i},t.doesUserReceiveItemGroupViaGroup=function(e,t,r){const o=t.filter((({users:e})=>(e||[]).some((e=>e.userId===r&&"accepted"===e.status)))).map((({groupId:e})=>e));return(e.groups||[]).some((({groupId:e,status:t})=>o.includes(e)&&"accepted"===t))},t.getGroupRecipients=M,t.getUserRecipients=L,t.getRecipientsCount=function(e,t){return L(e,t).length+M(e,t).length},t.findMyAcceptedUserGroups=function(e,t){return e.filter((e=>"users"===e.type&&(e.users||[]).some((e=>e.userId===t&&"accepted"===e.status))))},t.findUserGroup=function(e,t){return e.find((e=>e.groupId===t))},t.findUserGroupItemGroups=function(e,t){return t.filter((t=>(t.groups||[]).some((t=>t.groupId===e&&"accepted"===t.status))))},t.doesItemGroupExistInSpace=U;t.getSharingUsersFromItemGroups=(e,t,r,o)=>{const n=r.reduce(((r,n)=>{if(null!==o&&!U(e,n,o))return r;return(0,c.getItemGroupActiveUsers)(n).forEach((e=>{if(e.userId!==t)if(r.has(e.userId)){const t=r.get(e.userId);r.set(e.userId,{...e,itemCount:t.itemCount+n.items.length})}else r.set(e.userId,{...e,itemCount:n.items.length})})),r}),new Map);return Array.from(n.values())}},78096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.revokeRemoteControlledSharedItems=void 0;const o=r(18948),n=r(66638),a=r(88744),i=r(70252),s=r(11700),c=r(57989),d=r(68979),l=({deletedItemIds:e,updatedItemIds:t})=>e.length>0||t.length>0,u=async(e,t)=>{const r=await(0,o.firstValueFrom)(t.queries.getInvites());if((0,n.isFailure)(r))throw new Error(`Failiure in findMyPendingInvitesToRefuse: ${(0,n.getFailure)(r)}`);const i=(0,c.spacesWithForcedCategorizationEnabledSelector)(e.getState());return(0,n.getSuccess)(r).pendingSharedItems.reduce(((e,t)=>{if(t.itemType!==a.ShareableItemType.Credential)return e;const r=i.map((e=>e.details)),o=(0,s.pickBestTeamSpaceForForcedCategorizationForSharedItem)(r,t);return Boolean(o)&&o.domainsMatchResult===d.TeamDomainsMatchResult.SomeFieldsMatch&&e.push(t.sharedItemId),e}),(0,n.safeCast)([]))};t.revokeRemoteControlledSharedItems=async function(e,t,r,o){try{const{hiddenItemIds:n}=o,{commands:{remoteControlSharedItems:a}}=t,i=await u(e,r);await a({vaultItemIds:n,pendingInvitesIds:i,shouldRunSync:l(o)})}catch(e){const t=new Error(`[SharingRemoteControl] - revokeRemoteControlledSharedItems: ${e}`);(0,i.sendExceptionLog)({error:t})}}},84163:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleUserItemGroup=t.resendPublicKeyInvite=t.updateSharingData=t.getPendingItemGroup=t.createOrUpdateItemEffect=t.deleteItemEffect=void 0;const o=r(62433),n=r(18948),a=r(45127),i=r(66638),s=r(15020),c=r(36513),d=r(48313),l=r(95623),u=r(76496),p=r(45291),S=r(28096),m=r(34433),g=r(36884),y=r(63698),A=r(89016),f=r(70252),E=r(88542),h=r(96850),v=r(72079),T=r(57779),_=r(76496),I=r(50141),C=r(58107),P=r(49551),D=r(39373),O=r(56915),b=r(12362),w=r(86691),N=r(73566),R=r(56915),M=r(85225),L=r(82366);function U(e,t,r){const n=(0,o.pick)(e,r);return(0,o.mergeRight)(t,n)}t.deleteItemEffect=async function(e,t){try{const r=(0,u.findPersonalDataItemToDelete)(e,t);if(!r)return!0;const o=(0,p.removePersonalItem)(r.kwType,r.Id,null);return e.dispatch(o),!0}catch(e){return l.default.log(`[SharingSync]: deleteItemEffect: ${e}`),!1}},t.createOrUpdateItemEffect=async function(e,t,r){let o=null;const n=(0,b.getInstance)(),i=(0,w.getInstance)();try{const s=await(0,c.makeCryptoService)().symmetricEncryption.decryptSharingItem(r,t.content),{Id:l}=s,u=e.getPersonalData(),p=(0,R.platformInfoSelector)(e.getState());if((0,a.isCredential)(s)){o=i.lockTopic("iconsUpdates");const t=l?(0,P.findDataModelObject)(l,u.credentials||[]):null,r=t?U(E.sharedFields,t,s):s,c={credentialIds:[r.Id],type:"credentialUpdates"};await n.add("iconsUpdates",c);const S=(0,N.getUpdatedItemChangeHistory)({deviceName:e.getLocalSettings().deviceName,personalData:u,change:(0,M.makeUpdateChange)(r),userLogin:e.getUserLogin(),platformInfo:p}),m=(0,d.savePersonalDataItem)(r,a.DataModelType.KWAuthentifiant,S);e.dispatch(m),i.releaseTopic("iconsUpdates",o)}else if((0,a.isNote)(s)){const t=l?(0,P.findDataModelObject)(l,u.notes||[]):null,r=t?U(v.sharedFields,t,s):s,o=(0,d.savePersonalDataItem)(r,a.DataModelType.KWSecureNote);e.dispatch(o)}else if((0,a.isSecret)(s)){const t=l?(0,P.findDataModelObject)(l,u.secrets||[]):null,r=t?U(h.sharedFields,t,s):s,o=(0,d.savePersonalDataItem)(r,a.DataModelType.KWSecret);e.dispatch(o)}return!0}catch(e){return l.default.log(`[SharingSync] - createOrUpdateItemEffect: ${e}`),o&&i.releaseTopic("iconsUpdates",o),!1}},t.getPendingItemGroup=async function(e,t,r,o,n,i){let s;if(e.content){const r=(0,c.makeCryptoService)().symmetricEncryption;s=await r.decryptSharingItem(t,e.content)}else s=i[e.itemId];const d=(0,a.isCredential)(s),l=(0,a.isNote)(s),u=(0,a.isSecret)(s);if(!d&&!l&&!u)throw new Error("item is neither credential, secret nor note");let p=s;return d&&(p=(0,D.fixCredentialWithMissingTitle)(s)),{itemGroupId:r,items:[p],permission:n,referrer:o}},t.updateSharingData=function(e,t){const r=(0,m.sharingDataUpdated)(t);e.dispatch(r),(0,S.reportDataUpdate)(e)},t.resendPublicKeyInvite=async function(e,t,r){const o="[SharingEffectsService] - resendPublicKeyInvite";try{const n=e.getUserLogin(),a=(0,O.ukiSelector)(e.getState()),{groupId:i,revision:s}=r,{privateKey:d}=e.getUserSession().keyPair,l=(0,c.makeCryptoService)(),u=(0,A.makeWSService)(),{findUsersByAliases:p}=(0,I.makeWSUserAlias)(),{makeUserUpdate:S,makeUpdateItemGroupMembers:m}=(0,g.makeItemGroupService)(u,l),{updateItemGroupMembers:E}=(0,y.makeItemGroupWS)(),h=JSON.stringify([t.userId]),v=(await p({login:n,uki:a,aliases:h}))[t.userId];if(!v){const e=`${o}: couldn't find the user by alias, aborting.`;return void(0,f.sendExceptionLog)({message:e})}const T=(r.users||[]).find((e=>e.userId===n));if(!T){const e=`${o}: couldn't find myself in "itemGroup.users", aborting.`;return void(0,f.sendExceptionLog)({message:e})}const _=await l.asymmetricEncryption.decrypt(d,T.groupKey),{publicKey:C}=v,{permission:P,userId:D}=t,b=await S(D,P,{rawItemGroupKey:_,userPublicKey:C}),w=m(i,s,[b],null),N=await E(n,a,w);if(N&&N.itemGroups&&1===N.itemGroups.length){const{userGroups:t}=e.getSharingData();await(0,L.validateItemGroupResponse)("[SharingSyncJobsService] - resendPublicKeyInvite",l,N,C,d,_,n,[b],t,!0)}}catch(e){const t=new Error(`${o}: ${e}`);(0,f.sendExceptionLog)({error:t})}},t.deleteSingleUserItemGroup=async function({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:o,sharingItemsApi:d},l){const{login:u}=e.getAccountInfo(),p=(0,O.ukiSelector)(e.getState()),{keyPair:{privateKey:S}}=e.getUserSession(),{groupId:m,revision:y}=l,A="[SharingEffectsService] - deleteSingleUserItemGroup",E=(0,c.makeCryptoService)(),{deleteItemGroup:h,makeDeleteItemGroupEvent:v}=(0,g.makeItemGroupService)(t,E);if(!(0,C.isLastActiveUserInItemGroupAndAdmin)(l,u)){throw new Error(`${A}: ${"I'm not alone in the group, aborting."}`)}if(!l.items||0===l.items.length)return!0;const I=(l.items||[]).map((({itemId:e})=>e)),P={};for(const t of I){const r=await(0,T.duplicateSharedElements)(e,t);P[t]=r}try{const t={login:u,uki:p,privateKey:S},o=await v(m,y);await h(t,o),Object.keys(P).filter((e=>P[e])).forEach((t=>{(0,_.deletePersonalDataItem)({storeService:e,eventLoggerService:r,sharingItemsApi:d},t,{ignoreSharing:!0})}))}catch(t){const o=new Error(`${A}: ${t}`);return(0,f.sendExceptionLog)({error:o}),Object.keys(P).map((e=>P[e])).filter(Boolean).forEach((t=>(0,_.deletePersonalDataItem)({storeService:e,eventLoggerService:r,sharingItemsApi:d},t))),!1}try{if(o){const{commands:e,queries:t}=o.createClients().vaultOrganization,r=await(0,n.firstValueFrom)(t.queryCollections({}));if((0,i.isSuccess)(r)&&r.data.collections?.length>0){const t=Object.keys(P).filter((e=>P[e])),o=Object.keys(P).map((e=>P[e])).filter(Boolean),n=r.data.collections.filter((e=>e.vaultItems.some((e=>t.includes(e.id))))),i={vaultItems:t.map((e=>({id:e,type:a.DataModelType.KWAuthentifiant})))},c={vaultItems:o.map((e=>({id:e,type:a.DataModelType.KWAuthentifiant})))};for(const t of n)await e.updateCollection({id:t.id,collection:i,operationType:s.OperationType.SUBSTRACT_VAULT_ITEMS}),await e.updateCollection({id:t.id,collection:c,operationType:s.OperationType.APPEND_VAULT_ITEMS})}}return!0}catch(t){const o=new Error(`${A}: failure cleaning up collections ${t}`);return(0,f.sendExceptionLog)({error:o}),Object.keys(P).map((e=>P[e])).filter(Boolean).forEach((t=>(0,_.deletePersonalDataItem)({storeService:e,eventLoggerService:r,sharingItemsApi:d},t))),!1}}},78118:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptySharing2Summary=t.getEmptySharingData=t.getEmptyGetSharingParams=t.getEmptyOperations=t.initSharingSyncFromStorage=t.putSharingSyncBackInStorage=t.updateSharingDataFromSync=t.updateSharedCollectionsInModule=t.applyOperationsToSharingData=t.runOperationsEffects=t.setMissingItemKeys=t.revokeUsersFromInvalidItemGroups=t.shouldRunAutoRevoke=t.asyncFilterItemGroups=t.filterOutInvalidOperations=t.getSharing=t.setGetSharingParams=t.tagConfirmableOperations=t.setOperations=t.sanitizeData=t.OperationType=t.syncSharing=void 0;const o=r(62433),n=r(18948),a=r(45127),i=r(66638),s=r(48062),c=r(84827),d=r(47683),l=r(58107),u=r(71646),p=r(84163),S=r(95623),m=r(70252),g=r(17825),y=r(56915),A=r(32663),f=r(3735),E=r(88205),h=!1;function v(e,t){return h?(...r)=>(console.time(e),t(...r).then((t=>(S.default.warn(`Step "${e}" returned:`,t),console.timeEnd(e),t)))):t}var T;async function _(e){const{sharingData:{collections:t,items:r,itemGroups:o,userGroups:n},sharing2Summary:{collections:a,items:i,itemGroups:s,userGroups:c}}=e;return{...e,sharingData:{collections:I(t,"sharingData.collections"),items:I(r,"sharingData.items"),itemGroups:I(o,"sharingData.itemGroups"),userGroups:I(n,"sharingData.userGroups")},sharing2Summary:{collections:I(a,"sharing2Summary.collections"),items:I(i,"sharing2Summary.items"),itemGroups:I(s,"sharing2Summary.itemGroups"),userGroups:I(c,"sharing2Summary.userGroups")}}}function I(e,t,r){const o=function(e,t){return r=>{if(e(r))return!0;const o=`[SharingSync] - sanitizeList: found invalid element "${r}" in "${t}", filtering it out.`;return(0,m.sendExceptionLog)({message:o}),!1}}(r||Boolean,t);return(e||[]).filter(o)}async function C(e){const{sharingData:t,personalDataItemIds:r}=e,o=P(t.items,e.sharing2Summary.items,"itemId","timestamp").map((e=>e.type===T.Create&&r.includes(e.id)?{...e,skipPersonalDataItemCreation:!0}:e)),n=P(t.itemGroups,e.sharing2Summary.itemGroups,"groupId","revision"),a=P(t.userGroups,e.sharing2Summary.userGroups,"groupId","revision"),i=P(t.collections,e.sharing2Summary.collections,"uuid","revision");return{...e,operations:{items:o,itemGroups:n,userGroups:a,collections:i}}}function P(e,t,r,o){const{elementsToCreate:n}=function(e,t,r){const o=e.map((e=>e[r])),n=t.map((e=>e.id)),a=n.filter((e=>!o.includes(e)));return{elementsToCreate:a}}(e,t,r),{elementsToUpdate:a,elementsToDelete:i}=function(e,t,r,o){const n=t.map((e=>e.id)),a={elementsToUpdate:[],elementsToDelete:[]};return e.reduce(((e,a)=>{const i=n.indexOf(a[r]);if(i<0)return{...e,elementsToDelete:[...e.elementsToDelete,a[r]]};return t[i][o]>a[o]?{...e,elementsToUpdate:[...e.elementsToUpdate,a[r]]}:e}),a)}(e,t,r,o);return[].concat(n.map((e=>({id:e,type:T.Create})))).concat(a.map((e=>({id:e,type:T.Update})))).concat(i.map((e=>({id:e,type:T.Delete}))))}async function D(e,t){const{operations:{items:r},loadedElements:{collections:n,itemGroups:a,userGroups:i},sharingData:{collections:s,itemGroups:c,userGroups:d}}=e,u=(0,o.uniqBy)((e=>e.groupId),a.concat(c)),p=(0,o.uniqBy)((e=>e.groupId),i.concat(d)),S=(0,o.uniqBy)((e=>e.uuid),n.concat(s)),m=r.map((e=>function(e,t,r,o,n){if(e.type!==T.Create)return e;const a=(r||[]).find((t=>(t.items||[]).map((e=>e.itemId)).includes(e.id)));if(!a)return e;const i=(0,l.isItemGroupAccepted)(a,o,t,n),s=i?e:{...e,userConfirmationRequired:!0};return s}(e,t,u,p,S)));return{...e,operations:{...e.operations,items:m}}}async function O(e){const t=t=>e.operations[t].filter((e=>[T.Create,T.Update].includes(e.type))).map((e=>e.id));return{...e,getSharingParams:{collectionIds:t("collections"),itemIds:t("items"),itemGroupIds:t("itemGroups"),userGroupIds:t("userGroups")}}}async function b(e,t,r,o){const n=Object.assign({},e.getSharingParams,{type:"getSharing",sharingVersion:4});if(!(n.collectionIds.length||n.itemIds.length||n.itemGroupIds.length||n.userGroupIds.length))return e;const{collections:a,itemErrors:i,items:s,itemGroupErrors:c,itemGroups:d,userGroupErrors:l,userGroups:u}=await t.sharing.get(r,o,n);if(i&&i.length)throw new Error(`[SharingSync] - getSharing itemErrors: ${i[0].message}`);if(c&&c.length)throw new Error(`[SharingSync] - getSharing itemGroupErrors: ${c[0].message}`);if(l&&l.length)throw new Error(`[SharingSync] - getSharing userGroupErrors: ${l[0].message}`);return{...e,loadedElements:{collections:I(a,"getSharing loaded collections"),items:I(s,"getSharing loaded items"),itemGroups:I(d,"getSharing loaded itemGroups"),userGroups:I(u,"getSharing loaded userGroups")}}}async function w(e,t,r,o,n){const{sharingData:{collections:a,userGroups:i},loadedElements:{collections:s,itemGroups:c,userGroups:l},operations:{collections:u,itemGroups:p,userGroups:S}}=e,m=await(0,A.asyncFilter)(l,(e=>(0,d.isUserGroupValid)(e,t,r,o))),g=m.map((e=>e.groupId)),y=S.filter((e=>e.type===T.Delete||g.includes(e.id))),f=m.concat(i),E=await(0,A.asyncFilter)(s,(e=>(0,d.isCollectionValid)(e,t,r,o,f))),h=E.map((e=>e.uuid)),v=u.filter((e=>e.type===T.Delete||h.includes(e.id))),_=E.concat(a),{validItemGroups:I,itemKeys:C,invalidItemGroups:P}=await N(c,(e=>(0,d.validateItemGroup)(e,f,t,r,o,function(e,t){const r=(e.collections||[]).map((e=>e.uuid));return t.filter((e=>r.includes(e.uuid)))}(e,_)))),D=I.map((e=>e.groupId)),O=p.filter((e=>e.type===T.Delete||D.includes(e.id)));return P&&P.length>0&&P.forEach((e=>{n?.(e.itemGroupId,e.error)})),{...e,itemKeys:C,operations:{...e.operations,collections:v,userGroups:y,itemGroups:O},invalidItemGroups:P}}async function N(e,t){const r=await Promise.all(e.map(t));return{validItemGroups:e.filter(((e,t)=>r[t].isValid)),itemKeys:r.filter((e=>e.isValid)).reduce(((e,t)=>({...e,...t.itemKeys})),{}),invalidItemGroups:r.flatMap(((t,r)=>!1===t.isValid?[{itemGroupId:e[r].groupId,error:t.error}]:[]))}}async function R(e,t){const r=(await(0,E.makeFeatureFlipsSelectors)(e).featureFlipsSelector()).sharing_web_invalidSignatureAutoRevoke_prod,o=t===s.Trigger.InitialLogin||t===s.Trigger.Login;return r&&o}async function M(e,t,r,o,n,a,i,c){if(!await R(t,c))return o;const{sharingData:{userGroups:l},loadedElements:{itemGroups:u,userGroups:p},invalidItemGroups:S}=o,m=S.filter((e=>e.error===s.ErrorName.ItemGroupInvalidUserProposeSignature));if(0===m.length)return o;const g=(await(0,A.asyncFilter)(p,(e=>(0,d.isUserGroupValid)(e,n,a,i)))).concat(l),y=m.map((e=>u.find((({groupId:t})=>t===e.itemGroupId)))).filter((e=>void 0!==e&&(0,f.isUserItemGroupAdmin)(e,l,i)));if(0===y.length)return o;const E=y.flatMap((e=>e.users.filter((e=>"pending"===e.status&&e.userId!==i)).map((t=>({itemGroup:e,user:t}))))),h=(await Promise.all(E.map((async e=>{const t=await(0,d.getDecryptedItemGroupKey)(e.itemGroup,function(e,t){const r=(e.groups||[]).map((e=>e.groupId));return t.filter((e=>r.includes(e.groupId)))}(e.itemGroup,g),n,i);return await(0,d.isItemGroupUserProposeSignatureValid)(e.user,t)?void 0:e})))).filter((e=>void 0!==e)),v=await Promise.all(h.map((async({user:o,itemGroup:n})=>(await(0,f.revokeItemGroupMember)(t,e,r,n,{type:"user",alias:o.alias}),{user:o,itemGroup:n}))));return{...o,autoRevokedUsers:v}}async function L(e,t,r){const{loadedElements:o,sharingData:{collections:n,itemGroups:a,userGroups:i},itemKeys:s}=e,c=o.items.filter((e=>(0,l.isItemWithoutItemGroup)(e.itemId,o.itemGroups))).reduce(((e,t)=>{const r=(0,u.findItemItemGroup)(t.itemId,a);return r?{...e,[t.itemId]:{itemGroup:r}}:e}),{}),d=Object.keys(c),p=d.map((e=>{const{itemGroup:o}=c[e];return(0,l.getItemGroupKey)(o,i,t,r,n).catch((()=>null))})),S=await Promise.all(p),m=d.reduce(((e,t,r)=>({...e,[t]:{...c[t],itemGroupKey:S[r]}})),{}),g=d.map((e=>{const{itemGroupKey:t,itemGroup:r}=m[e];if(!r)return Promise.resolve(null);const o=(r.items||[]).find((t=>t.itemId===e));return o?(0,l.decryptItemKey)(o.itemKey,t).catch((()=>null)):Promise.resolve(null)})),y=await Promise.all(g),A=d.reduce(((e,t,r)=>y[r]?{...e,[t]:y[r]}:e),{});return{...e,itemKeys:{...s,...A}}}async function U(e,{storeService:t,wsService:r,eventLoggerService:n,applicationModulesAccess:i}){const s=await async function(e,t,r){const{itemKeys:o,loadedElements:n,operations:{items:i}}=t,s=i.map((t=>async function(e,t,r,o){switch(r.type){case T.Delete:return await(0,p.deleteItemEffect)(e,r.id)?r:null;case T.Create:case T.Update:{if(r.skipPersonalDataItemCreation)return r;if(r.userConfirmationRequired)return null;const n=t.items.find((e=>e.itemId===r.id));if(!n)return null;const a=o[n.itemId];if(!a)return null;return await(0,p.createOrUpdateItemEffect)(e,n,a)?r:null}}return(0,g.assertUnreachable)(r.type)}(e,n,t,o))),c=(await Promise.all(s)).filter((e=>!!e));try{if(r&&c.length>0){const{commands:e}=r.createClients().passwordHealth;e.recalculatePasswordHealth()}}catch(e){const t=new Error(`Password Health update - sharing: ${e}`);(0,m.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return c}(t,e,i),c=await async function({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:n},i){const{operations:{itemGroups:s},loadedElements:{itemGroups:c,userGroups:d,collections:u},sharingData:{userGroups:S,collections:y}}=i,A=(0,o.uniqBy)((e=>e.groupId),d.concat(S)),f=(0,o.uniqBy)((e=>e.uuid),u.concat(y)),E=s.map((o=>async function({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:o},n,a,i,s){const{type:c,id:d}=i,{login:u}=e.getAccountInfo();switch(c){case T.Delete:return i;case T.Create:case T.Update:{const c=n.find((e=>e.groupId===d));if(!c)return null;if((c.users||[]).filter((e=>"publicKey"===e.rsaStatus)).forEach((t=>(0,p.resendPublicKeyInvite)(e,t,c))),(0,l.isLastActiveUserInItemGroupAndAdmin)(c,u)){return await(0,p.deleteSingleUserItemGroup)({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:o,sharingItemsApi:o.createClients().sharingItems},c)?{...i,type:T.Delete}:null}if(!(0,l.isItemGroupAccepted)(c,a,u,s)){const t=(c.items||[]).map((async({itemId:t})=>{try{return await(0,p.deleteItemEffect)(e,t)}catch(e){return null}}));return await Promise.all(t),{...i,deleteSharingDataItems:!0}}return i}}return(0,g.assertUnreachable)(c)}({storeService:e,wsService:t,eventLoggerService:r,applicationModulesAccess:n},c,A,o,f))),h=(await Promise.all(E)).filter((e=>!!e));try{if(n&&h.length>0){const{commands:e}=n.createClients().passwordHealth;e.recalculatePasswordHealth()}}catch(e){const t=new Error(`Password Health update - sharing: ${e}`);(0,m.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return h}({storeService:t,wsService:r,eventLoggerService:n,applicationModulesAccess:i},e);return{...e,operations:{...e.operations,items:s,itemGroups:c}}}async function k(e){const{sharingData:{items:t,itemGroups:r,userGroups:o,collections:n},loadedElements:{items:a,itemGroups:i,userGroups:s,collections:c},operations:{items:d,itemGroups:l,userGroups:u,collections:p}}=e,S=F(a,t,d),m=F(i,r,l),g=F(s,o,u),y=F(c,n,p),A=l.filter((({deleteSharingDataItems:e})=>e)).reduce(((e,{id:t})=>{const r=i.find((e=>e.groupId===t));if(!r)return e;const o=(r.items||[]).map((({itemId:e})=>e));return[...e,...o]}),[]),f=S.filter((e=>!A.includes(e.itemId)));return{...e,sharingData:{items:f,itemGroups:m,userGroups:g,collections:y}}}function F(e,t,r){return r.reduce(((t,r)=>function(e,t,r){switch(r.type){case T.Delete:return function(e,{id:t}){return e.filter((e=>B(e)!==t))}(t,r);case T.Create:return function(e,t,{id:r}){const o=e.find((e=>B(e)===r));return o?t.concat(o):t}(e,t,r);case T.Update:return function(e,t,{id:r}){const o=e.find((e=>B(e)===r));if(!o)return t;return t.map((e=>B(e)===r?o:e))}(e,t,r)}return(0,g.assertUnreachable)(r.type)}(e,t,r)),t)}function B(e){if("itemId"in e)return e.itemId;if(function(e){return"groupId"in e}(e))return e.groupId;if(function(e){return"uuid"in e}(e))return e.uuid}async function G(e,t,r){try{if(r){const{sharingData:{collections:o,userGroups:n}}=e;if(o){const e=o.filter((e=>{const r=(e?.users??[]).some((e=>e.login===t&&"accepted"===e.status)),o=e.userGroups.map((e=>e.uuid)),a=n.filter((e=>o.includes(e.groupId))).find((e=>(e?.users??[]).find((e=>e.userId===t)))),i=(a?.users??[]).some((e=>e.userId===t&&"accepted"===e.status));return r||i})),{commands:a}=r.createClients().sharingCollections;a.updateSharedCollections({collections:e});const{commands:i}=r.createClients().sharingRemoteControl;i.moveCollectionItemsToBusinessSpace()}}}catch(e){const t=new Error(`[SharingSync] - update shared collections failed: ${e}`);(0,m.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return e}async function K(e,t){const{sharingData:r}=e;return(0,p.updateSharingData)(t,r),e}async function V(e,t,r){const{sharingSync:o}=t.getState().userSession;return r.getInstance().storeSharingSync(o),e}async function j(e,t,r){const o=r.getInstance(),n=await o.doesSharingSyncExist();let a=null;const i=()=>{a={pendingUserGroups:[],pendingItemGroups:[]},o.storeSharingSync(a)};n||i();try{a=await o.getSharingSync()}catch(e){i()}const{pendingItemGroups:s,pendingUserGroups:d}=a,l=(0,c.setAllPendingAction)(s,d);return t.dispatch(l),e}function H(){return{collections:[],items:[],itemGroups:[],userGroups:[]}}function W(){return{collections:[],items:[],itemGroups:[],userGroups:[]}}t.syncSharing=async function({storeService:e,wsService:t,localStorageService:r,eventLoggerService:s,applicationModulesAccess:d},u,g,A){try{const S=(0,y.ukiSelector)(e.getState()),f=e.getUserLogin(),{privateKey:E,publicKey:h}=e.getUserSession().keyPair,{credentials:T,notes:P,secrets:N}=e.getPersonalData(),R=e.getSharingData(),{queries:F}=d.createClients().sharingCollections,B=await(0,n.firstValueFrom)(F.getSharedCollections({}));R.collections=(0,i.isSuccess)(B)&&Array.isArray(B.data)?B.data:[];const H=I(T,"PersonalData.credentials",a.isCredential),W=I(P,"PersonalData.notes",a.isNote),x=I(N,"PersonalData.secrets",a.isSecret),z=[...H,...W,...x],q=z.map((e=>e.Id)),Y=z.reduce(((e,t)=>(e[t.Id]=t,e)),{}),$={itemKeys:{},loadedElements:{collections:[],items:[],itemGroups:[],userGroups:[]},sharing2Summary:u,sharingData:R,operations:{collections:[],items:[],itemGroups:[],userGroups:[]},personalDataItemIds:q,pendingUserGroups:[],pendingItemGroups:[],invalidItemGroups:[],autoRevokedUsers:[]},Q=await Promise.resolve($).then(v("sanitizeData",_)).then(v("setOperations",C)).then(v("setGetSharingParams",O)).then(v("getSharing",(e=>b(e,t,f,S)))).then(v("filterOutInvalidOperations",(e=>w(e,E,h,f,g)))).then(v("revokeUsersFromInvalidItemGroups",(r=>M(e,d,t,r,E,h,f,A)))).then(v("setMissingItemKeys",(e=>L(e,E,f)))).then(v("tagConfirmableItemOperation",(e=>D(e,f)))).then(v("setPendingItemGroupsList",(e=>async function(e,t,r,n){const{loadedElements:{itemGroups:a,items:i},sharingData:{itemGroups:s,items:c},itemKeys:d}=e,u=(0,o.uniqBy)((e=>e.groupId),a.concat(s)),S=(0,o.uniqBy)((e=>e.itemId),i.concat(c)),m=u.reduce(((e,o)=>{const a=(0,l.getItemGroupPendingUserMember)(o,t);if(!a)return e;const i=async function(e,t,r,o,n,a){const{permission:i,referrer:s,groupKey:c}=t,d=(e.items||[]).map((async t=>{try{const{itemId:d}=t,u=n[d]||await(0,l.getDecipheredItemKey)(c,t.itemKey,r);if(!u)return null;const S=o.find((e=>e.itemId===d));if(!S)return null;return await(0,p.getPendingItemGroup)(S,u,e.groupId,s,i,a)}catch(e){return null}}));return(await Promise.all(d)).filter(Boolean)}(o,a,r,S,d,n);return[i,...e]}),[]),g=(0,o.flatten)(await Promise.all(m));return{...e,pendingItemGroups:g}}(e,f,E,Y)))).then(v("runOperationsEffects",(r=>U(r,{storeService:e,wsService:t,eventLoggerService:s,applicationModulesAccess:d})))).then(v("applyOperationsToSharingData",k)).then(v("setPendingUserGroupsList",(t=>async function(e,t,r){const{sharingData:{userGroups:o}}=e,n=t.getSpaceData().spaces.find((e=>"accepted"===e.details.status));if(!n)return{...e,pendingUserGroups:[]};const a=String(n.teamId),i=o.reduce(((e,t)=>{if(!(String(t.teamId)===a))return e;const o=(t.users||[]).find((e=>e.userId===r&&"pending"===e.status));if(!o)return e;const{groupId:n,name:i}=t,{referrer:s,permission:c}=o;return[{groupId:n,name:i,referrer:s,permission:c},...e]}),[]);return{...e,pendingUserGroups:i}}(t,e,f)))).then(v("setPendingCollectionsList",(e=>async function(e,t){try{if(t){const{sharingData:{collections:r}}=e,{commands:o}=t.createClients().sharingInvites;o.updatePendingCollections(r)}}catch(e){const t=new Error(`Set pending collections - sharing sync: ${e}`);(0,m.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}return e}(e,d)))).then(v("initSharingSyncFromStorage",(t=>j(t,e,r)))).then(v("updateStoreSharingSync",(t=>async function(e,t){const{pendingItemGroups:r,pendingUserGroups:o}=e,n=(0,c.updateAllPendingAction)(r,o);return t.dispatch(n),e}(t,e)))).then(v("putSharingSyncBackInStorage",(t=>V(t,e,r)))).then(v("updateSharingDataFromSync",(t=>K(t,e)))).then(v("updateSharedCollectionsInModule",(e=>G(e,f,d))));return Q.sharingData}catch(t){const r=new Error(`[SharingSync] - syncSharing failed: ${t}`);return h&&S.default.error(r),(0,m.sendExceptionLog)({error:r}),e.getSharingData()}},function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Delete=2]="Delete"}(T=t.OperationType||(t.OperationType={})),t.sanitizeData=_,t.setOperations=C,t.tagConfirmableOperations=D,t.setGetSharingParams=O,t.getSharing=b,t.filterOutInvalidOperations=w,t.asyncFilterItemGroups=N,t.shouldRunAutoRevoke=R,t.revokeUsersFromInvalidItemGroups=M,t.setMissingItemKeys=L,t.runOperationsEffects=U,t.applyOperationsToSharingData=k,t.updateSharedCollectionsInModule=G,t.updateSharingDataFromSync=K,t.putSharingSyncBackInStorage=V,t.initSharingSyncFromStorage=j,t.getEmptyOperations=H,t.getEmptyGetSharingParams=function(){return{collectionIds:[],itemIds:[],itemGroupIds:[],userGroupIds:[]}},t.getEmptySharingData=W,t.getEmptySharing2Summary=function(){return{collections:[],items:[],itemGroups:[],userGroups:[]}}},3735:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.revokeItemGroupMember=t.isUserItemGroupAdmin=void 0;const o=r(36884),n=r(36513),a=r(82366),i=r(56915),s=r(72678);t.isUserItemGroupAdmin=function(e,t,r,o){const n=(e.users||[]).some((({userId:e,permission:t})=>e===r&&"admin"===t)),a=(o||[]).some((e=>e.users.some((({login:e,permission:t})=>e===r&&"admin"===t)))),i=(t||[]).filter((e=>(e.users||[]).map((({userId:e})=>e)).includes(r))).map((({groupId:e})=>e)),s=(e.groups||[]).filter((({groupId:e})=>i.includes(e))).some((({permission:e})=>"admin"===e));return n||s||a},t.revokeItemGroupMember=async function(e,t,r,c,d,l="manual"){const u=await(0,n.makeCryptoService)(),{groupId:p,revision:S}=c,m=t.getState(),g=(0,i.ukiSelector)(m),y=t.getUserLogin(),{makeRevokeItemGroupMembers:A}=(0,o.makeItemGroupService)(r,u),f="user"===d.type?[d.alias]:[],E="userGroup"===d.type?[d.groupId]:[],{credentials:h,notes:v,secrets:T}=(0,s.personalDataSelector)(m),_=[...h,...v,...T],I=(c.items||[]).map((({itemId:e})=>e)),C=_.filter((e=>I.includes(e.Id))),P=A(p,S,f,E,await(0,a.createAuditLogDetails)(e,m,C[0]),l);await r.itemGroup.revokeItemGroupMembers(y,g,P)}},47683:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCollectionValid=t.isUserGroupValid=t.areItemGroupItemKeysValid=t.isItemGroupCollectionProposeSignatureValid=t.isItemGroupGroupMemberProposeSignatureValid=t.areItemGroupCollectionMembersProposeSignaturesValid=t.areItemGroupGroupMembersProposeSignaturesValid=t.isItemGroupUserProposeSignatureValid=t.areItemGroupUsersProposeSignaturesValid=t.isItemGroupCollectionMemberValid=t.isItemGroupUserGroupMemberValid=t.isItemGroupUserValid=t.getDecryptedItemGroupKey=t.validateItemGroup=void 0;const o=r(48062),n=r(36513),a=r(95623),i=r(58107),s=r(93513),c=!1;async function d(e,t,r,o){try{const{status:a,acceptSignature:s,groupKey:c}=t;if("accepted"!==a)return!0;const d=await(0,n.makeCryptoService)().asymmetricEncryption.decrypt(r,c);return await(0,i.isGroupSignatureValid)(e,s,d,o)}catch(e){return c&&a.default.log(`isGroupSignatureValid error: ${e}`),!1}}async function l(e,t,r,o,s){try{const{status:a,acceptSignature:c,groupKey:d,groupId:l}=t;if("accepted"!==a)return!0;const u=(r||[]).find((e=>e.groupId===l));if(!u)return!1;const{publicKey:p}=u,S=await(0,i.getUserGroupPrivateKey)(u,o,s);if(!S)return!1;const m=await(0,n.makeCryptoService)().asymmetricEncryption.decrypt(S,d);return await(0,i.isGroupSignatureValid)(e,c,m,p)}catch(e){return c&&a.default.log(`isItemGroupUserGroupMemberValid error: ${e}`),!1}}async function u(e,t,r,o,n){try{const a=(r||[]).find((e=>e.uuid===t.member.uuid));if(!a)return!1;let s=null;const{status:c,acceptSignature:d}=t.member,{publicKey:l}=a;if("accepted"!==c)return!0;if(t.userGroup){if(!a.userGroups.find((e=>e.uuid===t.userGroup.groupId)))return null;s=await(0,i.getDecryptedPrivateCollectionKeyFromUserGroup)(a,t.userGroup,o,n)}else s=await(0,i.getCollectionPrivateKeyForUser)(a,o,n);if(!s)return!1;const u=await(0,i.decryptGroupKey)(t.member.itemGroupKey,s);if(!u)return!1;return await(0,i.isGroupSignatureValid)(e,d,u,l)}catch(e){return c&&a.default.log(`isItemGroupCollectionMemberValid error: ${e}`),!1}}async function p(e,t){const r=(e||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>S(e,t)));return(await Promise.all(r)).every(Boolean)}async function S(e,t){try{return await(0,n.makeCryptoService)().symmetricEncryption.verifyHmacSHA256(t,e.proposeSignature,s.encode(e.userId))}catch(e){return c&&a.default.warn(`[SharingValidationService] - isItemGroupUserProposeSignatureValid: ${e}`),!1}}async function m(e,t){const r=(e||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>y(e,t)));return(await Promise.all(r)).every(Boolean)}async function g(e,t){const r=(e||[]).filter((({status:e})=>["pending","accepted"].includes(e))).map((e=>A(e,t)));return(await Promise.all(r)).every(Boolean)}async function y(e,t){try{return await(0,n.makeCryptoService)().symmetricEncryption.verifyHmacSHA256(t,e.proposeSignature,s.encode(e.groupId))}catch{return!1}}async function A(e,t){try{return await(0,n.makeCryptoService)().symmetricEncryption.verifyHmacSHA256(t,e.proposeSignature,s.encode(e.uuid))}catch{return!1}}async function f(e,t){const r=(e||[]).map((e=>async function(e,t){try{const{itemKey:r}=e;return await(0,i.decryptItemKey)(r,t)}catch{return!1}}(e,t))),o=await Promise.all(r);return!!o.every(Boolean)&&o.reduce(((t,r,o)=>({...t,[e[o].itemId]:r})),{})}t.validateItemGroup=async function(e,t,r,n,s,S){const y=e.groupId,A=e,E=(0,i.findMyItemGroupUser)(e,s),h=(0,i.findMyItemGroupUserGroupMember)(e,t,s),v=(0,i.findMyItemGroupCollectionMemberViaUserGroup)(A,t,s,S),T=(0,i.findMyItemGroupCollectionMemberAsUser)(A,s,S);if(!(E||h||T||v))return{isValid:!1,error:o.ErrorName.ItemGroupNoAccess};const _=await(0,i.getItemGroupKey)(e,t,r,s,S);if(c&&a.default.log("ITEM_GROUP_KEY",!!_),!_)return{isValid:!1,error:o.ErrorName.ItemGroupInvalidKey};const I=!E||await d(y,E,r,n);if(c&&a.default.log("ITEM_GROUP_USER_VALID",I),!I)return{isValid:!1,error:o.ErrorName.ItemGroupInvalidUserAcceptSignature};const C=!h||await l(y,h,t,r,s),P=!v||await u(y,v,S,r,s),D=!T||await u(y,{member:T},S,r,s);if(c&&(a.default.log("ITEM_GROUP_USER_GROUP_VALID",C),a.default.log("ITEM_GROUP_COLLECTION_VALID",P),a.default.log("ITEM_GROUP_COLLECTION_UER_VALID",D)),!C||!P||!D)return{isValid:!1,error:o.ErrorName.ItemGroupInvalidGroupAcceptSignature};const O=await p(e.users,_);if(c&&a.default.log("USERS_PROPOSE_SIGNATURES_VALID",O),!O)return{isValid:!1,error:o.ErrorName.ItemGroupInvalidUserProposeSignature};const b=await m(e.groups,_),w=await g(A.collections,_);if(c&&(a.default.log("GROUP_MEMBERS_PROPOSE_SIGNATURES_VALID",b),a.default.log("COLLECTION_MEMBERS_PROPOSE_SIGNATURES_VALID",w)),!b||!w)return{isValid:!1,error:o.ErrorName.ItemGroupInvalidGroupProposeSignature};const N=await f(e.items||[],_);return c&&a.default.log("ITEM_GROUP_ITEM_KEYS",!!N),N?{isValid:!0,itemKeys:N}:{isValid:!1,error:o.ErrorName.ItemGroupInvalidKey}},t.getDecryptedItemGroupKey=async function(e,t,r,o){const n=(0,i.findMyItemGroupUser)(e,o),a=(0,i.findMyItemGroupUserGroupMember)(e,t,o);if(!n&&!a)return null;const s=n?await(0,i.getDecryptedItemGroupKeyFromUser)(n,r):await(0,i.getDecryptedItemGroupKeyFromUserGroupMember)(a,t,r,o);return s||null},t.isItemGroupUserValid=d,t.isItemGroupUserGroupMemberValid=l,t.isItemGroupCollectionMemberValid=u,t.areItemGroupUsersProposeSignaturesValid=p,t.isItemGroupUserProposeSignatureValid=S,t.areItemGroupGroupMembersProposeSignaturesValid=m,t.areItemGroupCollectionMembersProposeSignaturesValid=g,t.isItemGroupGroupMemberProposeSignatureValid=y,t.isItemGroupCollectionProposeSignatureValid=A,t.areItemGroupItemKeysValid=f,t.isUserGroupValid=async function(e,t,r,o){const{groupId:n}=e,a=(e.users||[]).find((e=>e.userId===o));if(!a)return null;const s=await(0,i.getDecryptedUserGroupKey)(a.groupKey,t);return!!s&&(!(a.acceptSignature&&!await(0,i.isGroupSignatureValid)(n,a.acceptSignature,s,r))&&!!await(0,i.areUserGroupUsersProposeSignaturesValid)(e.users,s))},t.isCollectionValid=async function(e,t,r,o,n){const{uuid:a}=e,s=(e.users||[]).find((e=>e.login===o));let c=s?.collectionKey,d=s?.acceptSignature,l=t,u=r;if(!s){const r=e.userGroups.map((e=>e.uuid)),a=n.filter((e=>r.includes(e.groupId))).find((e=>e.users.find((e=>e.userId===o)))),s=e.userGroups.find((e=>e.uuid===a.groupId));if(!s)return!1;const p=await(0,i.getUserGroupPrivateKey)(a,t,o);c=s.collectionKey,d=s.acceptSignature,l=p,u=a.publicKey}const p=await(0,i.getDecryptedUserGroupKey)(c,l);return!!p&&(!(d&&!await(0,i.isGroupSignatureValid)(a,d,p,u))&&!!await(0,i.areCollectionUsersProposeSignaturesValid)(e,p))}},70206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserGroupService=t.checkUsersPublicKey=t.ConvertUserGroupMemberToUserUpdate=t.ConvertUserGroupMemberToUserUpdateWithInvite=t.ConvertUserGroupMemberToUserUpload=t.createUserUploadEvent=t.makeUserGroupAdminItem=t.makeGroupKeyItem=t.decryptGroupKey=t.UPDATE_USER_GROUP_USERS=t.REVOKE_USER_GROUP_USERS=t.INVITE_USER_GROUP_USERS=t.REFUSE_USER_GROUP=t.ACCEPT_USER_GROUP=t.RENAME_USER_GROUP=t.DELETE_USER_GROUP=t.CREATE_TEAM_ADMINS_USER_GROUP=t.CREATE_USER_GROUP=t.SHARING_VERSION=void 0;const o=r(93513),n=r(78320),a=r(16038),i=r(44197),s=r(43927),c=r(82366),d=r(70252);function l(e,t,r,n){return e.asymmetricEncryption.sign(t,o.encode(r+"-accepted-"+n))}function u(e,t,r){if(!(0,a.isBase64Encoded)(r))throw new Error("INVALID_GROUP_KEY");return e.asymmetricEncryption.decrypt(t.privateKey,r)}async function p(e,t,r,n,a){const s=(0,i.getAdminDataFromTeamAdminData)(r,n),c=(0,i.getSpecialItemGroupFromAdminData)(s).revision,d=JSON.stringify(a),[l,u]=await Promise.all([e.symmetricEncryption.generateNewAESKey(),(0,i.getSpecialItemGroupKey)(e,t,s)]),[p,S]=await Promise.all([e.symmetricEncryption.encryptAES256(l,o.encode(d)),e.symmetricEncryption.encryptAES256(u,o.encode(l))]);return{itemId:a.itemId,itemKey:S,content:p,itemGroupRevision:c}}async function S(e,r,a,i){return async function(e,r,a,i,s){const[c,d]=await Promise.all([r.asymmetricEncryption.generateRsaKeyPair(),r.symmetricEncryption.generateNewAESKey()]),l=(0,n.generateItemUuid)(),u=await r.symmetricEncryption.encryptAES256(d,o.encode(c.privateKey)),p={groupId:l,name:i.name,publicKey:c.publicKey,privateKey:u,sharingVersion:t.SHARING_VERSION,teamId:i.teamId,type:e,users:await Promise.all(s.map((e=>g(r,e,a,d,l))))};return p}("createTeamAdminsUserGroup",e,r,a,i)}async function m(e){return{itemId:(0,n.generateItemUuid)(),groupId:(0,n.generateItemUuid)(),groupKey:await e.symmetricEncryption.generateNewAESKey()}}async function g(e,t,r,o,n){const a=await A(e,t,o);return t.Login===r.login&&(a.acceptSignature=await l(e,r.privateKey,n,o)),a}function y(e,r,o,n,a){return async function(e,r,o,n,a,i){const s=a.map((async t=>{try{return{success:!0,user:await g(e,t,r,i,o)}}catch(e){const t=new Error(`[UserGroupService] - makeBaseInviteMembersEvent: ${e}`);return(0,d.sendExceptionLog)({error:t}),{success:!1}}})),c=(await Promise.all(s)).filter((e=>e.success)).map((e=>e.user));return{groupId:o,revision:n,sharingVersion:t.SHARING_VERSION,type:t.INVITE_USER_GROUP_USERS,users:c}}(e,n,r.groupId,o,a,r.groupKey)}async function A(e,t,r){const n=await E(t);if(!t.Login){const a=await(0,c.generateProposeSignature)(e,r,t.Alias);return await(0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpload (no login)",e,r,a,o.encode(t.Alias)),{...n,userId:t.Alias,alias:t.Alias,proposeSignatureUsingAlias:!0,proposeSignature:a}}const[a,i]=await Promise.all([e.asymmetricEncryption.encrypt(t.PublicKey,r),(0,c.generateProposeSignature)(e,r,t.Login)]);return await(0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpload",e,r,i,o.encode(t.Login)),{...n,alias:t.Alias,groupKey:a,proposeSignatureUsingAlias:!1,proposeSignature:i}}async function f(e,t,r){const n=await E(t),[a,i]=await Promise.all([e.asymmetricEncryption.encrypt(t.PublicKey,r),(0,c.generateProposeSignature)(e,r,t.Login)]);return await(0,c.validateProposeSignature)("[ItemGroupService] - ConvertUserGroupMemberToUserUpdateWithInvite",e,r,i,o.encode(t.Login)),{...n,groupKey:a,proposeSignature:i}}async function E(e){return{permission:e.Permission,userId:e.Login}}t.SHARING_VERSION=4,t.CREATE_USER_GROUP="createUserGroup",t.CREATE_TEAM_ADMINS_USER_GROUP="createTeamAdminsUserGroup",t.DELETE_USER_GROUP="deleteUserGroup",t.RENAME_USER_GROUP="renameUserGroup",t.ACCEPT_USER_GROUP="acceptUserGroup",t.REFUSE_USER_GROUP="refuseUserGroup",t.INVITE_USER_GROUP_USERS="inviteUserGroupUsers",t.REVOKE_USER_GROUP_USERS="revokeUserGroupUsers",t.UPDATE_USER_GROUP_USERS="updateUserGroupUsers",t.decryptGroupKey=u,t.makeGroupKeyItem=p,t.makeUserGroupAdminItem=m,t.createUserUploadEvent=g,t.ConvertUserGroupMemberToUserUpload=A,t.ConvertUserGroupMemberToUserUpdateWithInvite=f,t.ConvertUserGroupMemberToUserUpdate=E;function h(e,t,r,o){return e(t,r,{type:"getSharing",sharingVersion:4,userGroupIds:o}).then((({userGroupErrors:e,userGroups:t})=>{if(e&&e.length)throw new Error(e[0].message);return t}))}function v({teamId:e}){if(!e)throw new Error("USER_GROUP_DELETED")}t.checkUsersPublicKey=e=>{const t=Object.keys(e).filter((t=>!e[t].publicKey));return t.length>0?Promise.reject(new Error(JSON.stringify({message:"Users missing public Key: "+t,code:"MISSING_PUBLIC_KEY"}))):Promise.resolve(e)};const T=e=>{const t="ITEM_GROUP_UPDATE_CONFLICT";return"getAdditionalInfo"in e&&e.getAdditionalInfo().webServiceSubMessage===t||e.message.includes(t)},_=e=>{const t="Conflict";return!(!("getAdditionalInfo"in e)||!e.getAdditionalInfo().message.startsWith(t))||e.message.startsWith(t)};function I(e,t,r,o,n){return e(r,o,n).catch((a=>{if(T(a))return h(t,r,o,[n.groupId]).then((([t])=>{v(t);const{revision:a}=t;return e(r,o,{...n,revision:a})}));throw a}))}t.makeUserGroupService=function(e,r){return{makeUserGroupAdminItem:()=>m(r),makeCreateUserGroupEvent:(e,n,a,i)=>async function(e,r,n,a,i){const s=await e.asymmetricEncryption.generateRsaKeyPair(),{teamId:c,externalId:d,name:l}=a;return{groupId:i.groupId,name:l,publicKey:s.publicKey,privateKey:await e.symmetricEncryption.encryptAES256(i.groupKey,o.encode(s.privateKey)),sharingVersion:t.SHARING_VERSION,teamId:c,type:"createUserGroup",users:[],groupKeyItem:await p(e,r,n,c.toString(),i),externalId:d}}(r,e,n,a,i),makeCreateSpecialUserGroupEvent:(e,t,o)=>S(r,e,t,o),createUserGroup:({login:t,uki:r},o,n)=>function(e,t,r,o,n){return e.userGroup.create(t,r,n).catch((a=>{if(T(a))return(0,s.loadSpecialItemGroup)(e,t,r,o).then((o=>e.userGroup.create(t,r,{...n,groupKeyItem:{...n.groupKeyItem,itemGroupRevision:o.revision}})));throw a}))}(e,t,r,o,n),makeDeleteUserGroupEvent:(e,r,o,n)=>async function(e,r,o,n){const a={type:t.DELETE_USER_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r};return o&&n&&(a.groupKeyItem={itemId:o,itemGroupRevision:n}),a}(e,r,o,n),deleteUserGroup:({login:t,uki:r},o,n)=>function(e,t,r,o,n){return e.userGroup.delete(t,r,n).catch((a=>{if(T(a))return(0,s.loadSpecialItemGroup)(e,t,r,o).then((o=>e.userGroup.delete(t,r,{...n,groupKeyItem:{...n.groupKeyItem,itemGroupRevision:o.revision}})));if(_(a))return h(e.sharing.get,t,r,[n.groupId]).then((o=>{const[{revision:a,teamId:i}]=o;return i?e.userGroup.delete(t,r,{...n,revision:a}):{userGroups:o}}));throw a}))}(e,t,r,o,n),makeRenameUserGroupEvent:(e,r,o)=>async function(e,r,o){return{type:t.RENAME_USER_GROUP,sharingVersion:t.SHARING_VERSION,groupId:e,revision:r,name:o}}(e,r,o),renameUserGroup:({login:t,uki:r},o)=>function(e,t,r,o){const n=e.userGroup.rename;return n(t,r,o).catch((a=>{if(_(a))return h(e.sharing.get,t,r,[o.groupId]).then((e=>{v(e[0]);const[{name:a,revision:i}]=e;return a===o.name?{userGroups:e}:n(t,r,{...o,revision:i})}));throw a}))}(e,t,r,o),makeAcceptUserGroupEvent:(e,o)=>async function(e,r,o){const n=o.users.find((e=>e.userId===r.login)).groupKey,a=await u(e,r,n),i=await l(e,r.privateKey,o.groupId,a);return{type:t.ACCEPT_USER_GROUP,sharingVersion:4,revision:o.revision,groupId:o.groupId,acceptSignature:i}}(r,e,o),acceptUserGroup:({login:t,uki:r},o)=>I(e.userGroup.accept,e.sharing.get,t,r,o),makeRefuseUserGroupEvent:(e,r)=>async function(e,r){return{type:t.REFUSE_USER_GROUP,sharingVersion:4,revision:r,groupId:e}}(e,r),refuseUserGroup:({login:t,uki:r},o)=>I(e.userGroup.refuse,e.sharing.get,t,r,o),makeInviteMembersEventAsAdmin:(e,t,o,n)=>y(r,e,t,o,n),inviteUserGroupMembers:({login:t,uki:r},o)=>function(e,t,r,o){return e.userGroup.invite(t,r,o).catch((n=>{if(_(n))return h(e.sharing.get,t,r,[o.groupId]).then((n=>{v(n[0]);const[{revision:a,users:i}]=n,s=o.users.filter((e=>!i.find((t=>t.userId===e.userId&&"accepted"===t.status))));return s.length?e.userGroup.invite(t,r,{...o,revision:a,users:s}):{userGroups:n}}));throw n}))}(e,t,r,o),makeRevokeMembersEvent:(e,r,o)=>async function(e,r,o){return{type:t.REVOKE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,users:o}}(e,r,o),revokeUserGroupMembers:({login:t,uki:r},o)=>function(e,t,r,o){return e.userGroup.revoke(t,r,o).catch((n=>{if(_(n))return h(e.sharing.get,t,r,[o.groupId]).then((n=>{v(n[0]);const[{revision:a,users:i}]=n,s=o.users.filter((e=>i.find((t=>t.userId===e&&"accepted"===t.status))));return s.length?e.userGroup.revoke(t,r,{...o,revision:a,users:s}):{userGroups:n}}));throw n}))}(e,t,r,o),makeUpdateMembersEvent:(e,r,o)=>async function(e,r,o){return{type:t.UPDATE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:r,groupId:e,users:await Promise.all(o.map((e=>E(e))))}}(e,r,o),makeUpdateMembersWithInviteEvent:(e,o,n,a)=>async function(e,r,o,n,a){return{type:t.UPDATE_USER_GROUP_USERS,sharingVersion:t.SHARING_VERSION,revision:n,groupId:r,users:await Promise.all(a.map((t=>f(e,t,o))))}}(r,e,o,n,a),updateUserGroupMembers:({login:t,uki:r},o)=>I(e.userGroup.update,e.sharing.get,t,r,o),findExistingUsersByAliases:r=>e.userAlias.findUsersByAliases(r).then(t.checkUsersPublicKey),findUsersByAliases:t=>e.userAlias.findUsersByAliases(t),isCurrentUserProposeSignatureValid:(e,t)=>async function(e,t,r){const o=r.users.find((e=>e.userId===t.login)),n=await u(e,t,o.groupKey);return(0,c.isProposeSignatureValid)(e,o.proposeSignature,o.userId,n)}(r,e,t)}}},37275:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingDataWithCollections=t.getSharedItemGroupsById=t.toCollectionModel=t.toVaultItemModel=t.filterUndefinedVaultItems=void 0;t.filterUndefinedVaultItems=e=>void 0!==e.id;t.toVaultItemModel=e=>({id:e.items?.[0].itemId});t.toCollectionModel=e=>r=>({id:r.uuid,name:r.name,vaultItems:e.filter((e=>e.collections?.find((e=>e.uuid===r.uuid)))).map(t.toVaultItemModel).filter(t.filterUndefinedVaultItems)});t.getSharedItemGroupsById=e=>e&&e.length>0?e.reduce(((e,t)=>({...e,[t.groupId]:t})),{}):{};t.getSharingDataWithCollections=e=>({collections:e.collections??[],itemGroups:e.itemGroups})},97124:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSharingService=void 0;const o=r(36513),n=r(70206),a=r(36884),i=r(10294);t.makeSharingService=function(e,t){const r=(0,o.makeCryptoService)();return{ws:t,store:e,crypto:r,userGroup:(0,n.makeUserGroupService)(t,r),itemGroup:(0,a.makeItemGroupService)(t,r),item:(0,i.makeItemService)()}}},81197:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isShared=void 0;const o=r(62433),n=r(59890);t.isShared=(0,o.curry)(((e,t)=>(0,n.binaryContains)(e,t.Id)))},71646:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getItemGroupActiveUsers=t.findItemItemGroup=t.findMyAcceptedItemGroups=t.findMyAcceptedItemGroupCollectionMembers=t.findMyAcceptedItemGroupUserGroupMembers=void 0;const o=r(58107);function n(e,t,r){const o=(t||[]).filter((e=>(e.users||[]).map((e=>e.userId)).includes(r))).map((e=>e.groupId));return(e.groups||[]).filter((e=>o.includes(e.groupId)&&"accepted"===e.status))}function a(e,t,r,n){const a=(0,o.findMyItemGroupCollectionMemberAsUser)(e,n,t),i=(0,o.findMyItemGroupCollectionMemberViaUserGroup)(e,r,n,t)?.member;return(e.collections||[]).filter((e=>{const t=a?.uuid===e.uuid,r=i?.uuid===e.uuid;return"accepted"===e.status&&(t||r)}))}t.findMyAcceptedItemGroupUserGroupMembers=n,t.findMyAcceptedItemGroupCollectionMembers=a,t.findMyAcceptedItemGroups=function(e,t,r,o){return e.filter((e=>{const i=e,s="items"===e.type,c=(e.users||[]).some((e=>e.userId===o&&"accepted"===e.status)),d=n(i,t,o).length>0,l=a(i,r,t,o).length>0;return s&&(c||d||l)}))},t.findItemItemGroup=function(e,t){return t.find((t=>(t.items||[]).map((e=>e.itemId)).includes(e)))},t.getItemGroupActiveUsers=function(e){return(e.users||[]).filter(i)};const i=e=>["accepted","pending"].includes(e.status)},89489:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLimitedSharedItemIds=void 0;const o=r(37275);t.getLimitedSharedItemIds=(e,t,r,n)=>{const a=e.userGroups.filter((e=>e.users.some((e=>e.userId===n&&"accepted"===e.status)))),i=new Set(a.map((e=>e.groupId))),s=t??[],c=(0,o.getSharedItemGroupsById)(r),d=s.filter((e=>(e.users??[]).some((e=>e.login===n&&"accepted"===e.status))||(e.userGroups??[]).some((e=>i.has(e.uuid)&&"accepted"===e.status)))),l=new Set(d.map((e=>e.uuid)));return e.itemGroups.filter((e=>{const t=e.users?.some((e=>e.userId===n&&"admin"===e.permission&&"accepted"===e.status)),r=e.groups?.some((e=>i.has(e.groupId)&&"admin"===e.permission&&"accepted"===e.status)),o=c[e.groupId]?.collections?.some((e=>l.has(e.uuid)&&"admin"===e.permission&&"accepted"===e.status));return!(t||r||o)})).map((e=>(e.items||[]).map((e=>e.itemId)))).reduce(((e,t)=>e.concat(t)),[]).reduce(((e,t)=>({...e,[t]:!0})),{})}},78987:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingCapacity$=t.myAcceptedUserGroups$=t.allSharedItemIds$=void 0;const o=r(18948),n=r(3343),a=r(84511),i=r(80993),s=r(90021);t.allSharedItemIds$=()=>{const e=i.sortedSharedItemIdsSelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())};t.myAcceptedUserGroups$=()=>{const e=a.myAcceptedUserGroupsSelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())};t.sharingCapacity$=()=>{const e=s.sharingCapacitySelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())}},84511:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.myAcceptedUserGroupsSelector=t.itemItemGroupSelector=t.isSharedSelector=void 0;const o=r(32034),n=r(58107),a=r(6e3),i=r(52102),s=r(71646);t.isSharedSelector=(e,t)=>{const{items:r}=(0,i.sharingDataSelector)(e);return r.some((e=>e.itemId===t))};t.itemItemGroupSelector=(e,t)=>{const{itemGroups:r}=(0,i.sharingDataSelector)(e);return(0,s.findItemItemGroup)(t,r)},t.myAcceptedUserGroupsSelector=(0,o.createSelector)(a.loginStatusSelector,i.sharingDataSelector,(({login:e},{userGroups:t})=>(0,n.findMyAcceptedUserGroups)(t,e)))},89698:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.acceptedItemGroupsSelector=void 0;const o=r(32034),n=r(16593),a=r(71646),i=r(52102);t.acceptedItemGroupsSelector=(0,o.createSelector)(i.sharingDataSelector,n.userIdSelector,(({itemGroups:e,userGroups:t,collections:r},o)=>(0,a.findMyAcceptedItemGroups)(e,t,r,o)))},91210:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.limitedSharingItemsSelector=void 0;const o=r(32034),n=r(89489),a=r(16593),i=r(52102),s=r(31607);t.limitedSharingItemsSelector=(0,o.createSelector)(i.sharingDataSelector,s.sharedCollectionsSelector,s.sharedCollectionItemsSelector,a.userIdSelector,n.getLimitedSharedItemIds)},31607:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharedCollectionItemsSelector=t.sharedCollectionsSelector=void 0;t.sharedCollectionsSelector=e=>e.userSession.sharingData.collections;t.sharedCollectionItemsSelector=e=>e.userSession.sharingData.itemGroups},67231:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharedCredentialsCountSelector=void 0;const o=r(32034),n=r(80993),a=r(51319),i=r(81197);t.sharedCredentialsCountSelector=(0,o.createSelector)(n.sortedSharedItemIdsSelector,a.credentialsSelector,((e,t)=>{const r=(0,i.isShared)(e);return t.filter(r).length}))},30150:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharedItemsCountSelector=void 0;const o=r(32034),n=r(67231),a=r(41384);t.sharedItemsCountSelector=(0,o.createSelector)(n.sharedCredentialsCountSelector,a.sharedNotesCountSelector,((e,t)=>e+t))},41384:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharedNotesCountSelector=void 0;const o=r(32034),n=r(80993),a=r(75705),i=r(81197);t.sharedNotesCountSelector=(0,o.createSelector)(n.sortedSharedItemIdsSelector,a.notesSelector,((e,t)=>{const r=(0,i.isShared)(e);return t.filter(r).length}))},90021:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingCapacitySelector=void 0;const o=r(32034),n=r(16593),a=r(46617),i=r(30150);t.sharingCapacitySelector=(0,o.createSelector)(i.sharedItemsCountSelector,n.premiumStatusSelector,a.getSharingCapacity)},52102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingDataSelector=void 0;t.sharingDataSelector=e=>e.userSession.sharingData},80993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sortedSharedItemIdsSelector=void 0;const o=r(32034),n=r(52102);t.sortedSharedItemIdsSelector=(0,o.createSelector)(n.sharingDataSelector,(({items:e})=>e.map((e=>e.itemId)).sort()))},46617:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingCapacity=void 0;t.getSharingCapacity=(e,t)=>{const r=t?.capabilities?.sharingLimit?.info?.limit??1/0;return r===1/0?{type:"unlimited"}:{type:"limited",remains:Math.max(0,r-e)}}},35037:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapToTeamAdminSharingData=void 0;const o=r(66638);t.mapToTeamAdminSharingData=e=>{const t=e.itemGroups.find((e=>"userGroupKeys"===e.type)),r=e.userGroups.find((e=>"teamAdmins"===e.type)),n=t?.items?.reduce(((t,{itemId:r})=>(t[r]=e.items.find((e=>e.itemId===r)),t)),(0,o.safeCast)({}));return{specialItemGroup:t,specialUserGroup:r,specialItems:n}}},82366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAuditLogDetails=t.validateItemGroupResponse=t.validateProposeSignature=t.isProposeSignatureValid=t.generateProposeSignature=t.isAcceptSignatureValid=t.generateAcceptSignature=void 0;const o=r(93513),n=r(45127),a=r(15318),i=r(70252),s=r(35587),c=r(32663),d=r(47683),l=r(58107),u=r(16593),p=r(88205);function S(e,t,r){return new Promise(((n,a)=>{e.symmetricEncryption.signHmacSHA256(t,o.encode(r)).then(n,a)}))}function m(e,t,r,o){return S(e,o,r).then((e=>t===e))}function g(e){return"validProposeSignature"in e}function y(e){const t=g(e)?e.validProposeSignature:"not-found",r=g(e)&&void 0!==e.matchProposeSignature?e.matchProposeSignature:"not-found";return`  Status:${e.status} Permission:${e.permission} ValidProposeSignature:${t} MatchesProposeSignature:${r}`}async function A(e,t,r,o){return await(0,s.asyncMap)(e,(async e=>{const n=t.find((t=>t.userId===e.userId));return{...e,validProposeSignature:await m(r,e.proposeSignature,e.userId,o),matchProposeSignature:n&&e?n.proposeSignature===e.proposeSignature:void 0}}))}t.generateAcceptSignature=function(e,t,r,n){return new Promise(((a,i)=>{e.asymmetricEncryption.sign(t,o.encode(r+"-accepted-"+n)).then(a,i)}))},t.isAcceptSignatureValid=function(e,t,r,o){return new Promise(((n,a)=>{e.asymmetricEncryption.verify(r,t,o).then(n,a)}))},t.generateProposeSignature=S,t.isProposeSignatureValid=m,t.validateProposeSignature=async function(e,t,r,o,n){if(!await t.symmetricEncryption.verifyHmacSHA256(r,o,n)){const t=new Error(`${e}: INVALID_PROPOSE_CREATION Failed to validate newly created propose signature`);throw(0,i.sendExceptionLog)({error:t}),t}},t.validateItemGroupResponse=async function(e,t,r,o,n,a,u,p,S,g=!1,f){try{const E=await(0,c.asyncFilter)(p,(async e=>!await m(t,e.proposeSignature,e.userId,a))),h=await(0,c.asyncFilter)(r.itemGroups,(async e=>!(await(0,d.validateItemGroup)(e,S,n,o,u,f)).isValid));if(g?E.length>0:h.length>0||E.length>0){const r=function(e,t,r){return[`${e}: INVALID_PROPOSE_IN_RESPONSE Invalid item group on share`,t.map((e=>`Invalid Uploaded User UsingAlias:${"alias"in e?!!e.proposeSignatureUsingAlias:"updating"} Permission:${e.permission}`)).join("\n"),r.map((e=>[`Invalid ItemGroup ID:${e.groupId} Revision:${e.revision} TeamID:${e.teamId} MatchItemGroupKey:${e.matchItemGroupKey}`,"Invalid ItemGroup Users:",e.users.map(y).join("\n")].join("\n"))).join("\n")].join("\n")}(e,E,await(0,s.asyncMap)(h,(async e=>({...e,users:await A(e.users,p,t,a),matchItemGroupKey:a===await(0,l.getItemGroupKey)(e,S,n,u,f)}))));await(0,i.sendExceptionLog)({error:new Error(r)})}}catch(e){e.message=`[validateItemGroupResponse]: ERROR_VALIDATING_PROPOSE_IN_RESPONSE Error validating item group response ${e.message}`,await(0,i.sendExceptionLog)({error:e})}},t.createAuditLogDetails=async function(e,t,r){const o=(0,u.activeSpacesSelector)(t)[0],i=(await(0,p.makeFeatureFlipsSelectors)(e).featureFlipsSelector()).audit_logs_sharing,s=(!!r?.SpaceId&&o?.info?.collectSensitiveDataAuditLogsEnabled)??!1;if(!i||!s)return;const c=(0,n.isCredential)(r)&&r?.Url?new a.ParsedURL(r?.Url).getHostname():"",d=c||"",l=(0,n.isCredential)(r)?d:void 0,S=function(e){switch(e.kwType){case"KWAuthentifiant":return"AUTHENTIFIANT";case"KWSecureNote":return"SECURENOTE";default:return"SECRET"}}(r);return{captureLog:s,domain:l,type:S}}},83687:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingStatusDetail=t.getNotShared=void 0;const o=r(62433),n=r(58107),a=r(71646);t.getNotShared=()=>({isShared:!1});const i=(e,t)=>e[t]?"limited":"admin";t.getSharingStatusDetail=(0,o.curry)(((e,r,o,s)=>{const{itemGroups:c,userGroups:d}=r,l=(0,a.findItemItemGroup)(s,c);if(!l)return(0,t.getNotShared)();const u=(0,n.getRecipientsCount)(r,s);return{groupSharing:(0,n.doesUserReceiveItemGroupViaGroup)(l,d,o),isShared:!0,lastAdmin:(0,n.isUserLastAdmin)(l,o),permission:i(e,s),recipientsCount:u}}))},63623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emptySessionResponse=t.getFreshUserGroups=t.updateUserGroupMembers=t.getSharedData=t.computeUserGroupMember=t.extractAliasesFromMembers=t.revokeUserGroupMembers=t.inviteUserGroupMembers=t.renameUserGroup=t.deleteUserGroup=t.deleteItemGroup=t.createSpecialItemGroup=t.createSpecialUserGroup=t.createUserGroup=t.buildSharingData=t.mergeSharingData=t.getCleanSharingData=t.getOutdatedSharingParams=void 0;const o=r(62433),n=r(45127),a=r(70252),i=r(95623),s=r(44197),c=r(27885);function d(e,{groupId:t,revision:r}){if(!e.privateKey)throw new Error("PRIVATE_KEY_MISSING");if(!t)throw new Error("GROUP_ID_MISSING");if(!r)throw new Error("GROUP_REVISION_MISSING")}function l(e,t){return{itemIds:e.items.filter((({id:e,timestamp:r})=>!t.items.find((t=>t.itemId===e&&t.timestamp>=r)))).map((e=>e.id)),itemGroupIds:e.itemGroups.filter((({id:e,revision:r})=>!t.itemGroups.find((t=>t.groupId===e&&t.revision===r)))).map((e=>e.id)),userGroupIds:e.userGroups.filter((({id:e,revision:r})=>!t.userGroups.find((t=>t.groupId===e&&t.revision===r)))).map((e=>e.id))}}function u(e,t){const{items:r,itemGroups:o,userGroups:n}=e;return{items:t.items.filter((e=>r.find((t=>t.id===e.itemId)))),itemGroups:t.itemGroups.filter((e=>o.find((t=>t.id===e.groupId)))),userGroups:t.userGroups.filter((e=>n.find((t=>t.id===e.groupId))))}}function p(e,t){const r=(e,t,r)=>{const o=t.filter((t=>!e.find((e=>r(e)===r(t)))));return e.map((e=>t.find((t=>r(t)===r(e)))||e)).concat(o)};return{items:r(e.items,t.items,o.prop("itemId")),itemGroups:r(e.itemGroups,t.itemGroups,o.prop("groupId")),userGroups:r(e.userGroups,t.userGroups,o.prop("groupId"))}}t.getOutdatedSharingParams=l,t.getCleanSharingData=u,t.mergeSharingData=p,t.buildSharingData=async function(e,t,r,n,a){const i=u(n,a),s=l(n,i),c=o.unnest(o.values(s));return o.compose(o.equals(0),o.length)(c)?i:p(i,await A(e,t,r,s))};const S=(e,t,r)=>{const o=(0,c.getNodePremiumStatusSpaceData)(r),n=o.spaces.find((t=>Number(t.teamId)===e));if(!n)throw new Error("TEAM_NOT_FOUND");if(!(0,c.hasSpecialUserGroupAccessInSpace)(n.teamId,o))throw new Error("USER_DOES_NOT_HAVE_SPECIAL_USER_GROUP_ACCESS_FOR_TEAM");if(!t.privateKey)throw new Error("PRIVATE_KEY_MISSING")};function m(e,t,r){return(0,a.sendExceptionLog)({error:t}),i.Debugger.log(e,t),Promise.resolve({userGroups:[],error:{message:t.message,action:r}})}function g(e){return JSON.stringify(e.map((e=>e.Alias)))}function y(e,t){return e.map((e=>{if(!t[e.Alias])throw new Error(`User details not found for alias: ${e.Alias}`);return{Alias:e.Alias,Login:t[e.Alias].login,PublicKey:t[e.Alias].publicKey,Permission:e.Permission}}))}async function A(e,t,r,o){if(!(o.itemIds||o.itemGroupIds||o.userGroupIds))throw new Error("MISSING_PARAMETERS");const n={...o,type:"getSharing",sharingVersion:4},{itemErrors:a,items:i,itemGroupErrors:s,itemGroups:c,userGroupErrors:d,userGroups:l}=await e.sharing.get(t,r,n);if(a&&a.length)throw new Error(a[0].message);if(s&&s.length)throw new Error(s[0].message);if(d&&d.length)throw new Error(d[0].message);return{items:i,itemGroups:c,userGroups:l}}t.createUserGroup=function(e,t,r,o){return Promise.resolve().then((()=>(S(o.teamId,t,e.store),e.userGroup.makeUserGroupAdminItem().then((n=>Promise.all([e.userGroup.makeCreateUserGroupEvent(t,r,o,n),Promise.resolve(n)])))))).then((([n,a])=>e.userGroup.createUserGroup(t,r.teams[o.teamId],n).then((({userGroups:e,itemGroups:t})=>({userGroups:e,userGroupAdminItem:a,itemGroups:t}))))).catch((e=>m("Error while creating userGroup ",e,o)))},t.createSpecialUserGroup=function(e,t,r,o){const a={teamId:o,name:"_team_admin_user_group"};return Promise.resolve().then((()=>{S(o,t,e.store);const a=r.spaces.find((e=>Number(e.teamId)===o)).details.teamAdmins.map((e=>({Alias:e.login,Login:e.login,Permission:"admin",Status:e.login===t.login?n.SpaceStatus.Accepted:n.SpaceStatus.Pending}))),i=g(a);return e.userGroup.findExistingUsersByAliases({login:t.login,uki:t.uki,aliases:i}).then((e=>({findUserServiceResponse:e,members:a})))})).then((({findUserServiceResponse:r,members:o})=>{const n=y(o,r);return e.userGroup.makeCreateSpecialUserGroupEvent(t,a,n)})).then((r=>e.userGroup.createUserGroup(t,{teamId:String(o)},r))).then((({userGroups:e})=>e&&e.length&&e[0]))},t.createSpecialItemGroup=function(e,t,r,o){return Promise.resolve().then((()=>(S(r.teamId,t,e.store),e.itemGroup.makeCreateSpecialItemGroupEvent(t,r,o)))).then((r=>e.itemGroup.createSpecialItemGroup(t,r)))},t.deleteItemGroup=function(e,t,{groupId:r,revision:o}){return Promise.resolve().then((()=>(d(t,{groupId:r,revision:o}),e.itemGroup.makeDeleteItemGroupEvent(r,o).then((r=>e.itemGroup.deleteItemGroup(t,r)))))).catch((e=>(m("Error while deleting itemGroup ",e,{groupId:r,revision:o}),[])))},t.deleteUserGroup=function(e,t,r,o){const n=(0,s.findTeamForGroup)(r,o.groupId);return Promise.resolve().then((()=>{d(t,o);const{groupId:r,revision:a}=o,i=(n&&n.userGroupAdminItems||[]).find((e=>e.groupId===o.groupId)),s=n.specialItemGroup&&n.specialItemGroup.revision;return e.userGroup.makeDeleteUserGroupEvent(r,a,i.itemId,s)})).then((r=>e.userGroup.deleteUserGroup(t,n,r))).catch((e=>m("Error while deleting userGroup ",e,o)))},t.renameUserGroup=function(e,t,r){return Promise.resolve().then((()=>{d(t,r);const{groupId:o,revision:n,name:a}=r;return e.userGroup.makeRenameUserGroupEvent(o,n,a).then((r=>e.userGroup.renameUserGroup(t,r)))})).catch((e=>m("Error while renaming userGroup ",e,r)))},t.inviteUserGroupMembers=function(e,t,r,o,n){return Promise.resolve().then((()=>{if(d(t,o),0===o.users.length)throw new Error("USERS_NOT_SUPPLIED");const{login:a,uki:i}=t,c=JSON.stringify(o.users.map((e=>e.alias)));return e.userGroup.findUsersByAliases({login:a,uki:i,aliases:c}).then((a=>{const i=o.users.map((e=>{const t={Alias:e.alias,Permission:e.permission},r=a[e.alias];if(!r)return t;const{login:o,publicKey:n}=r;return o&&n?{...t,Login:o,PublicKey:n}:t})),{revision:c}=o,d=(0,s.getUserGroupAdminItem)(r,n.teamId.toString(),n.groupId);if(!d)throw new Error("USER_GROUP_ADMIN_ITEM_NOT_AVAILABLE");return e.userGroup.makeInviteMembersEventAsAdmin(d,c,t,i)})).then((r=>e.userGroup.inviteUserGroupMembers(t,r)))})).catch((e=>m("Error while inviteUserGroupMembers",new Error(`[SharingController] - inviteUserGroupMembers: ${e}`),o))).then((e=>Object.assign({refusedMembers:{}},e)))},t.revokeUserGroupMembers=async function(e,t,r){try{if(d(t,r),0===r.users.length)throw new Error("USERS_NOT_SUPPLIED");const{groupId:o,revision:n,users:a}=r,i=await e.userGroup.makeRevokeMembersEvent(o,n,a),{userGroups:s}=await e.userGroup.revokeUserGroupMembers(t,i);return{userGroups:s}}catch(e){return m("Error while revokeUserGroupMembers",e,r)}},t.extractAliasesFromMembers=g,t.computeUserGroupMember=y,t.getSharedData=A,t.updateUserGroupMembers=async function(e,t,r){if(d(t,r),0===r.users.length)throw new Error("USERS_NOT_SUPPLIED");const{login:o,uki:n}=t,{groupId:a,revision:i,users:s}=r,c=JSON.stringify(s.map((e=>e.alias))),l=await e.userGroup.findExistingUsersByAliases({login:o,uki:n,aliases:c}),u=s.map((e=>({Alias:e.alias,Login:l[e.alias].login,PublicKey:l[e.alias].publicKey,Permission:e.permission}))),p=await e.userGroup.makeUpdateMembersEvent(a,i,u),{userGroups:S}=await e.userGroup.updateUserGroupMembers(t,p);return{userGroups:S}},t.getFreshUserGroups=function(e,t,r){const{login:o,uki:n}=t;return A(e,o,n,{itemIds:[],itemGroupIds:[],userGroupIds:r.map((e=>e.groupId))}).then((e=>e.userGroups))},t.emptySessionResponse=function(e){return Promise.reject({error:{message:"SESSION_EMPTY",action:e}})}},22652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(48584),n=r(28183);t.config={commands:{},queries:{getSharingUsers:{selector:o.viewedSharingUsersSelector},getSharingUserPermissionLevel:{selector:o.sharingUserPermissionLevelSelector}},liveQueries:{liveSharingUsers:{operator:n.sharingUsers$},liveSharingUserPermissionLevel:{operator:n.sharingUserPermissionLevel$}}}},28183:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingUserPermissionLevel$=t.sharingUsers$=void 0;const o=r(18948),n=r(3343),a=r(48584),i=r(35893),s=r(33627);t.sharingUsers$=e=>{const t=(0,i.parseToken)(e),r=(0,a.createLiveSharingUsersSelector)(t.spaceId)(t.dataQuery);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(((e,t)=>(0,s.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount)))};t.sharingUserPermissionLevel$=e=>{const t=(0,a.getSharingUserPermissionLevelSelector)((0,i.parseToken)(e));return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())}},7261:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingUserMappers=void 0;t.getSharingUserMappers=()=>({id:e=>e.userId,itemCount:e=>e.itemCount})},70963:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sharingUserMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("userId")],t.sharingUserMatch=(0,n.match)(t.searchGetters)},48584:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSharingUserPermissionLevelSelector=t.sharingUserPermissionLevelSelector=t.createLiveSharingUsersSelector=t.viewedSharingUsersSelector=t.sharingUserMappersSelector=void 0;const o=r(62433),n=r(32034),a=r(63566),i=r(24589),s=r(97006),c=r(16593),d=r(7261),l=r(63925),u=r(70963),p=r(58107),S=r(89698),m=r(84511),g=e=>(0,n.createSelector)(S.acceptedItemGroupsSelector,c.userIdSelector,(e=>e),((t,r,o)=>(0,p.getSharingUsersFromItemGroups)(o,r,t,e)));t.sharingUserMappersSelector=()=>(0,d.getSharingUserMappers)();const y=()=>u.sharingUserMatch;t.viewedSharingUsersSelector=(e,r)=>{const n=(e=>{const r=g(e);return(0,i.getQuerySelector)(r,y,t.sharingUserMappersSelector)})(r.spaceId);return(0,o.compose)((0,a.viewListResults)(l.listView),n)(e,r.dataQuery)};t.createLiveSharingUsersSelector=e=>{const r=g(e);return(0,s.makeLiveSelectorGetter)(r,(()=>l.listView),y,t.sharingUserMappersSelector)};t.sharingUserPermissionLevelSelector=(e,{itemId:t,userId:r})=>{const o=(0,m.itemItemGroupSelector)(e,t);if(o)return(0,p.getSharingUserPermission)(o,r)};t.getSharingUserPermissionLevelSelector=({itemId:e,userId:r})=>o=>(0,t.sharingUserPermissionLevelSelector)(o,{itemId:e,userId:r})},63925:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const o=(0,r(62433).defaultTo)("");t.detailView=e=>({id:o(e.userId),itemCount:e.itemCount});t.listView=e=>e.map(t.detailView)},23944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(96247),n=r(79570),a=r(1190);t.config={commands:{},queries:{getUserGroups:{selector:o.viewedUserGroupsSelector},getUserGroup:{selector:o.viewedUserGroupSelector},getUserGroupMembers:{selector:a.viewedUserGroupMembersSelector}},liveQueries:{liveUserGroups:{operator:n.userGroups$}}}},779:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserDownloadMappers=void 0;t.getUserDownloadMappers=()=>({id:e=>e.userId})},79850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userDownloadMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("userId")],t.userDownloadMatch=(0,n.match)(t.searchGetters)},1190:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.viewedUserGroupMembersSelector=t.userDownloadMappersSelector=t.getUserGroupSelector=t.activeUserGroupsSelector=void 0;const o=r(32034),n=r(62433),a=r(24589),i=r(779),s=r(79850),c=r(63566),d=r(99729),l=r(52102),u=r(16593),p=r(58107);t.activeUserGroupsSelector=(0,o.createSelector)(l.sharingDataSelector,u.userIdSelector,((e,t)=>{const{userGroups:r}=e;return(0,p.findMyAcceptedUserGroups)(r,t)}));t.getUserGroupSelector=e=>(0,o.createSelector)(t.activeUserGroupsSelector,(t=>(0,p.findUserGroup)(t,e)));t.userDownloadMappersSelector=()=>(0,i.getUserDownloadMappers)();const S=()=>s.userDownloadMatch,m=e=>{const r=(e=>{const r=(0,t.getUserGroupSelector)(e);return(0,o.createSelector)(r,(e=>e?.users||[]))})(e);return(0,a.getQuerySelector)(r,S,t.userDownloadMappersSelector)};t.viewedUserGroupMembersSelector=(e,t)=>{const r=m(t.groupId);return(0,n.compose)((0,c.viewListResults)(d.listView),r)(e,t.dataQuery)}},99729:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const o=(0,r(62433).defaultTo)("");t.detailView=e=>({id:o(e.userId),permission:e.permission});t.listView=e=>e.map(t.detailView)},79570:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userGroups$=void 0;const o=r(18948),n=r(3343),a=r(35893),i=r(96247),s=r(33627);t.userGroups$=e=>{const t=(0,a.parseToken)(e),r=(0,i.createLiveUserGroupsSelector)(t.spaceId)(t.dataQuery);return(0,o.pipe)((0,n.map)(r),(0,n.distinctUntilChanged)(((e,t)=>(0,s.sameBatch)(e.items,t.items)&&e.matchingCount===t.matchingCount)))}},95414:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupMappers=void 0;t.getUserGroupMappers=()=>({name:e=>e.name,id:e=>e.groupId,itemCount:e=>e.itemCount})},10547:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userGroupMatch=t.searchGetters=void 0;const o=r(82234),n=r(64455);t.searchGetters=[(0,o.stringProp)("name")],t.userGroupMatch=(0,n.match)(t.searchGetters)},96247:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupPermissionLevelSelector=t.userGroupPermissionLevelSelector=t.viewedUserGroupSelector=t.createLiveUserGroupsSelector=t.viewedUserGroupsSelector=t.userGroupMappersSelector=t.createActiveUserGroupsSelector=void 0;const o=r(62433),n=r(32034),a=r(63566),i=r(24589),s=r(97006),c=r(16593),d=r(10547),l=r(95414),u=r(54719),p=r(52102),S=r(58107),m=r(84511);t.createActiveUserGroupsSelector=e=>(0,n.createSelector)(p.sharingDataSelector,c.userIdSelector,(e=>e),((t,r,o)=>{const{userGroups:n,itemGroups:a}=t;return(0,S.findMyAcceptedUserGroups)(n,r).map((t=>{const r=(0,S.findUserGroupItemGroups)(t.groupId,a).reduce(((t,r)=>null===e||(0,S.doesItemGroupExistInSpace)(o,r,e)?t+r.items.length:t),0);return{...t,itemCount:r}}))}));t.userGroupMappersSelector=()=>(0,l.getUserGroupMappers)();const g=()=>d.userGroupMatch;t.viewedUserGroupsSelector=(e,r)=>{const n=(e=>{const r=(0,t.createActiveUserGroupsSelector)(e);return(0,i.getQuerySelector)(r,g,t.userGroupMappersSelector)})(r.spaceId);return(0,o.compose)((0,a.viewListResults)(u.listView),n)(e,r.dataQuery)};t.createLiveUserGroupsSelector=e=>{const r=(0,t.createActiveUserGroupsSelector)(e);return(0,s.makeLiveSelectorGetter)(r,(()=>u.listView),g,t.userGroupMappersSelector)};t.viewedUserGroupSelector=(e,r)=>{const{itemGroups:o}=(0,p.sharingDataSelector)(e),n=(0,t.createActiveUserGroupsSelector)(null)(e),a=(0,S.findUserGroup)(n,r),i=(0,S.findUserGroupItemGroups)(a.groupId,o).length;if(a)return(0,u.detailView)({...a,itemCount:i})};t.userGroupPermissionLevelSelector=(e,{itemId:t,groupId:r})=>{const o=(0,m.itemItemGroupSelector)(e,t);return(0,S.getUserGroupPermission)(o,r)};t.getUserGroupPermissionLevelSelector=({itemId:e,groupId:r})=>o=>(0,t.userGroupPermissionLevelSelector)(o,{itemId:e,groupId:r})},54719:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listView=t.detailView=void 0;const o=r(62433),n=r(99729),a=(0,o.defaultTo)("");t.detailView=e=>({name:a(e.name),id:a(e.groupId),users:(0,n.listView)(e.users||[]),itemCount:e.itemCount});t.listView=e=>e.map(t.detailView)},86833:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(36768);t.bootstrap=e=>{e.register(o.config)}},43712:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDashlaneXmlToItem=t.ConvertDashlaneXmlToErrorCode=void 0;const o=r(45127),n=r(61797),a=r(63985);var i;!function(e){e.INVALID_XML="INVALID_XML",e.NOT_AUTHENTICATED="NOT_AUTHENTICATED"}(i=t.ConvertDashlaneXmlToErrorCode||(t.ConvertDashlaneXmlToErrorCode={})),t.convertDashlaneXmlToItem=async function(e,t){const{storeService:r}=e;if(!r.isAuthenticated())return{success:!1,error:{code:i.NOT_AUTHENTICATED}};const{xml:s}=t;if(!s||""===s)return{success:!1,error:{code:i.INVALID_XML}};const{__type__:c,...d}=await(0,n.parseDashlaneXml)(s);let l={...d,kwType:d.kwType||c};return(0,o.isCredential)(l)?l=(0,a.fixCredentialTypesFromTransaction)(l):(0,o.isNote)(l)&&(l=(0,a.fixNoteTypesFromTransaction)(l)),{success:!0,item:l}}},67312:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertItemToDashlaneXml=t.convertItemToDashlaneXmlHandler=t.ConvertItemToDashlaneXmlErrorCode=void 0;const o=r(61797);var n;async function a(e,t){if(!e.isAuthenticated())return{success:!1,error:{code:n.NOT_AUTHENTICATED}};const r=(0,o.getDashlaneXml)(t);return r&&""!==r?{success:!0,xml:r}:{success:!1,error:{code:n.INVALID_XML}}}!function(e){e.INVALID_XML="INVALID_XML",e.NOT_AUTHENTICATED="NOT_AUTHENTICATED"}(n=t.ConvertItemToDashlaneXmlErrorCode||(t.ConvertItemToDashlaneXmlErrorCode={})),t.convertItemToDashlaneXmlHandler=async function(e,t){const{storeService:r}=e,{item:o}=t;return a(r,o)},t.convertItemToDashlaneXml=a},96123:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.saveSharedItemsToVault=void 0;const o=r(62433),n=r(45127),a=r(56915),i=r(12362),s=r(86691),c=r(49551),d=r(88542),l=r(96850),u=r(72079),p=r(73566),S=r(85225),m=r(48313);function g(e,t,r){const n=(0,o.pick)(e,r);return(0,o.mergeRight)(t,n)}t.saveSharedItemsToVault=async(e,t)=>{const{items:r}=t,{storeService:o}=e,y=o.getPersonalData(),A=(0,a.platformInfoSelector)(o.getState()),f=(0,i.getInstance)(),E=(0,s.getInstance)(),h=[],v=[],T=[],_=[],I=[];for(const e of r)if((0,n.isCredential)(e)){const t=e.Id?(0,c.findDataModelObject)(e.Id,y.credentials||[]):null,r=t?g(d.sharedFields,t,e):e,n=(0,p.getUpdatedItemChangeHistory)({deviceName:o.getLocalSettings().deviceName,personalData:y,change:(0,S.makeUpdateChange)(r),userLogin:o.getUserLogin(),platformInfo:A});h.push(e.Id),v.push(r),n&&T.push(n)}else if((0,n.isNote)(e)){const t=e.Id?(0,c.findDataModelObject)(e.Id,y.notes||[]):null,r=t?g(u.sharedFields,t,e):e;_.push(r)}else if((0,n.isSecret)(e)){const t=e.Id?(0,c.findDataModelObject)(e.Id,y.secrets||[]):null,r=t?g(l.sharedFields,t,e):e;I.push(r)}if(v.length){const e=E.lockTopic("iconsUpdates"),t={credentialIds:h,type:"credentialUpdates"};await f.add("iconsUpdates",t);const r=(0,m.savePersonalDataItems)(v,n.DataModelType.KWAuthentifiant,T);o.dispatch(r),E.releaseTopic("iconsUpdates",e)}if(_.length){const e=(0,m.savePersonalDataItems)(_,n.DataModelType.KWSecureNote,[]);o.dispatch(e)}if(I.length){const e=(0,m.savePersonalDataItems)(I,n.DataModelType.KWSecret,[]);o.dispatch(e)}}},33719:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;const o=r(53858);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return o.setupSubscriptions}});var n=r(86833);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return n.bootstrap}})},53858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(78096);t.setupSubscriptions=function(e,t){const{storeService:r,applicationModulesAccess:n}=t,{sharingInvites:a,sharingRemoteControl:i}=n.createClients();e.teamSpaceContentControlDone.on((e=>{(0,o.revokeRemoteControlledSharedItems)(r,i,a,e)}))}},83400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(85406),n=r(98337);t.config={commands:{},queries:{getBanks:{staticDataHandler:o.getBanks},getAllBanks:{staticDataHandler:o.getAllBanks},getSecureDocumentsExtensionsList:{staticDataHandler:n.getSecureDocumentsAllowedExtensions}},liveQueries:{}}},82912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.banks=void 0;const o=r(45127);t.banks={[o.Country.AR]:[{localizedString:"Banco Credicoop",code:"BANCOCREDICOOP"},{localizedString:"Banco de la Nación Argentina",code:"BANCODELANACIONARGEN"},{localizedString:"Banco Hipotecario",code:"BANCOHIPOTECARIO"},{localizedString:"Banco Itaú Argentina",code:"BANCOITAUARGENTINA"},{localizedString:"Banco Macro",code:"BANCOMACRO"},{localizedString:"Banco Patagonia",code:"BANCOPATAGONIA"},{localizedString:"Banco Santander Río",code:"BANCOSANTANDERRIO"},{localizedString:"Bank of the City of Buenos Aires",code:"BANKOFTHECITYOFBUENO"},{localizedString:"Bank of the Province of Buenos Aires",code:"BANKOFTHEPROVINCEOFB"},{localizedString:"BBVA Banco Francés",code:"BBVABANCOFRANCES"},{localizedString:"Central Bank of Argentina",code:"CENTRALBANKOFARGENTI"},{localizedString:"Citibank Argentina",code:"CITIBANKARGENTINA"},{localizedString:"Grupo Financiero Galicia",code:"GRUPOFINANCIEROGALIC"},{localizedString:"HSBC Bank Argentina",code:"HSBCBANKARGENTINA"},{localizedString:"Municipal Bank of Rosario",code:"MUNICIPALBANKOFROSAR"},{localizedString:"New Bank of Santa Fe",code:"NEWBANKOFSANTAFE"},{localizedString:"Other",code:"NO_TYPE"}],[o.Country.AT]:[{localizedString:"Adria Bank",code:"ADRIABANK"},{localizedString:"Allianz Investmentbank",code:"ALLIANZINVESTMENTBAN"},{localizedString:"Alpenbank",code:"ALPENBANK"},{localizedString:"American Express Bank Ltd",code:"AMERICANEXPRESSBANKL"},{localizedString:"Anglo Irish Bank",code:"ANGLOIRISHBANK"},{localizedString:"Austria Wirtschaftsservice Gesellschaft",code:"AUSTRIAWIRTSCHAFTSSE"},{localizedString:"Banco do Brasil",code:"BANCODOBRASIL"},{localizedString:"Bank Austria Creditanstalt",code:"BANKAUSTRIACREDITANS"},{localizedString:"Bank für Ärzte und Freie Berufe",code:"BANKFURARZTEUNDFREIE"},{localizedString:"Bank für Tirol und Vorarlberg",code:"BANKFURTIROLUNDVORAR"},{localizedString:"Bank Gutmann",code:"BANKGUTMANN"},{localizedString:"Bankhaus Carl Spängler & Co",code:"BANKHAUSCARLSPANGLER"},{localizedString:"Bankhaus Krentschker & Co",code:"BANKHAUSKRENTSCHKERC"},{localizedString:"Bankhaus Schelhammer & Schattera",code:"BANKHAUSSCHELHAMMERS"},{localizedString:"Bank Sal.Oppenheim jr. & Cie",code:"BANKSALOPPENHEIMJRCI"},{localizedString:"Bank Vontobel Österreich",code:"BANKVONTOBELOSTERREI"},{localizedString:"Bank Winter & Co",code:"BANKWINTERCO"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Raiffeisen Bank",code:"RAIFFEISENBANK"}],[o.Country.AU]:[{localizedString:"AMP Bank Limited",code:"AMPBANKLIMITED"},{localizedString:"Australia and New Zealand Banking Group",code:"AUSTRALIAANDNEWZEALA"},{localizedString:"Auswide Bank",code:"AUSWIDEBANK"},{localizedString:"Bank Australia",code:"BANKAUSTRALIA"},{localizedString:"Bank of Melbourne",code:"BANKOFMELBOURNE"},{localizedString:"Bank of Queensland Limited",code:"BANKOFQUEENSLANDLIMI"},{localizedString:"Bank of Sydney",code:"BANKOFSYDNEY"},{localizedString:"Bank of Western Australia",code:"BANKOFWESTERNAUSTRAL"},{localizedString:"Bank SA",code:"BANKSA"},{localizedString:"BankVic",code:"BANKVIC"},{localizedString:"Bendigo and Adelaide Bank Limited",code:"BENDIGOANDADELAIDEBA"},{localizedString:"Beyond Bank Australia",code:"BEYONDBANKAUSTRALIA"},{localizedString:"Commonwealth Bank of Australia",code:"COMMONWEALTHBANKOFAU"},{localizedString:"Corporation (Australia) Limited",code:"CORPORATIONAUSTRALIA"},{localizedString:"Defence Bank",code:"DEFENCEBANK"},{localizedString:"Delphi Bank",code:"DELPHIBANK"},{localizedString:"G&C Mutual Bank",code:"GCMUTUALBANK"},{localizedString:"Heritage Bank",code:"HERITAGEBANK"},{localizedString:"Hume Bank",code:"HUMEBANK"},{localizedString:"IMB Bank",code:"IMBBANK"},{localizedString:"Macquarie Bank Limited",code:"MACQUARIEBANKLIMITED"},{localizedString:"Members Equity Bank Pty Limited",code:"MEMBERSEQUITYBANKPTY"},{localizedString:"MyState Bank",code:"MYSTATEBANK"},{localizedString:"National Australia Bank Limited",code:"NATIONALAUSTRALIABAN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"P&N Bank",code:"PNBANK"},{localizedString:"Police Bank",code:"POLICEBANK"},{localizedString:"Queensland Teachers Mutual Bank (QTMB)",code:"QUEENSLANDTEACHERSMU"},{localizedString:"Rural Bank Limited",code:"RURALBANKLIMITED"},{localizedString:"St. George Bank Limited,",code:"STGEORGEBANKLIMITED"},{localizedString:"Suncorp-Metway Limited",code:"SUNCORPMETWAYLIMITED"},{localizedString:"Teachers Mutual Bank Limited",code:"TEACHERSMUTUALBANKLI"},{localizedString:"UBank, a division of National Australia Bank",code:"UBANKADIVISIONOFNATI"},{localizedString:"Victoria Teachers Mutual Bank",code:"VICTORIATEACHERSMUTU"},{localizedString:"Westpac Banking Corporation",code:"WESTPACBANKINGCORPOR"}],[o.Country.BE]:[{localizedString:"Argenta",code:"ARGENTA"},{localizedString:"Attijariwafa Bank Europe Belgium",code:"ATTIJARIWAFABANKEURO"},{localizedString:"AXA Bank",code:"AXABANK"},{localizedString:"Banca Monte Paschi Belgio",code:"BANCAMONTEPASCHIBELG"},{localizedString:"BBVA Bélgica",code:"BBVABELGICA"},{localizedString:"Belfius Banque",code:"BELFIUSBANQUE"},{localizedString:"Beobank",code:"BEOBANK"},{localizedString:"BKCP Banque",code:"BKCPBANQUE"},{localizedString:"BNP Paribas Fortis",code:"BNPPARIBASFORTIS"},{localizedString:"bpost bank",code:"BPOSTBANK"},{localizedString:"Crelan",code:"CRELAN"},{localizedString:"Europabank",code:"EUROPABANK"},{localizedString:"Hello Bank!",code:"HELLOBANK"},{localizedString:"ING Belgium",code:"INGBELGIUM"},{localizedString:"KBC Bank",code:"KBCBANK"},{localizedString:"Keytrade Bank",code:"KEYTRADEBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Rabobank.be",code:"RABOBANKBE"},{localizedString:"Record Bank",code:"RECORDBANK"},{localizedString:"Santander Consumer Finance",code:"SANTANDERCONSUMERFIN"},{localizedString:"Triodos Bank Banque Triodos",code:"TRIODOSBANKBANQUETRI"},{localizedString:"VDK Spaarbank NV",code:"VDKSPAARBANKNV"}],[o.Country.BR]:[{localizedString:"Banco Bradesco Financiamentos",code:"BANCOBRADESCOFINANCI"},{localizedString:"Banco do Brasil",code:"BANCODOBRASIL"},{localizedString:"Banco do Estado do Rio Grande do Sul S/A",code:"BANCODOESTADODORIOGR"},{localizedString:"Banco Itaú",code:"BANCOITAU"},{localizedString:"Banco J Safra S/A",code:"BANCOJSAFRASA"},{localizedString:"Banco PanAmericano S/A",code:"BANCOPANAMERICANOSA"},{localizedString:"Banco Santander",code:"BANCOSANTANDER"},{localizedString:"Caixa Econômica Federal",code:"CAIXAECONOMICAFEDERA"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"HSBC",code:"HSBC"},{localizedString:"Other",code:"NO_TYPE"}],[o.Country.CA]:[{localizedString:"B2B Bank",code:"B2BBANK"},{localizedString:"Bank of Montreal",code:"BANKOFMONTREAL"},{localizedString:"Bank of Nova Scotia",code:"BANKOFNOVASCOTIA"},{localizedString:"Bridgewater Bank",code:"BRIDGEWATERBANK"},{localizedString:"Canadian Imperial Bank of Commerce",code:"CANADIANIMPERIALBANK"},{localizedString:"Canadian Tire Bank",code:"CANADIANTIREBANK"},{localizedString:"Canadian Western Bank",code:"CANADIANWESTERNBANK"},{localizedString:"CFF Bank",code:"CFFBANK"},{localizedString:"Citizens Bank of Canada",code:"CITIZENSBANKOFCANADA"},{localizedString:"Continental Bank of Canada",code:"CONTINENTALBANKOFCAN"},{localizedString:"CS Alterna Bank",code:"CSALTERNABANK"},{localizedString:"DirectCash Bank",code:"DIRECTCASHBANK"},{localizedString:"Equitable Bank",code:"EQUITABLEBANK"},{localizedString:"First Nations Bank of Canada",code:"FIRSTNATIONSBANKOFCA"},{localizedString:"General Bank of Canada",code:"GENERALBANKOFCANADA"},{localizedString:"Hollis Canadian Bank",code:"HOLLISCANADIANBANK"},{localizedString:"HomEquity Bank",code:"HOMEQUITYBANK"},{localizedString:"Laurentian Bank of Canada",code:"LAURENTIANBANKOFCANA"},{localizedString:"Manulife Bank of Canada",code:"MANULIFEBANKOFCANADA"},{localizedString:"National Bank of Canada",code:"NATIONALBANKOFCANADA"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Pacific & Western Bank of Canada",code:"PACIFICWESTERNBANKOF"},{localizedString:"President's Choice Bank",code:"PRESIDENTSCHOICEBANK"},{localizedString:"RedBrick Bank",code:"REDBRICKBANK"},{localizedString:"Rogers Bank",code:"ROGERSBANK"},{localizedString:"Royal Bank of Canada",code:"ROYALBANKOFCANADA"},{localizedString:"Tangerine Bank",code:"TANGERINEBANK"},{localizedString:"Toronto-Dominion Bank",code:"TORONTODOMINIONBANK"},{localizedString:"Wealth One Bank of Canada",code:"WEALTHONEBANKOFCANAD"},{localizedString:"Zag Bank",code:"ZAGBANK"}],[o.Country.CH]:[{localizedString:"AIG Private Bank",code:"AIGPRIVATEBANK"},{localizedString:"Amtsersparniskasse Thun",code:"AMTSERSPARNISKASSETH"},{localizedString:"Anker Bank",code:"ANKERBANK"},{localizedString:"Arab Bank Switzerland",code:"ARABBANKSWITZERLAND"},{localizedString:"Banca dello Stato del Cantone Ticino",code:"BANCADELLOSTATODELCA"},{localizedString:"Bank Ehinger",code:"BANKEHINGER"},{localizedString:"Bank for International Settlements (BIS)",code:"BANKFORINTERNATIONAL"},{localizedString:"Bank Leu",code:"BANKLEU"},{localizedString:"Bankredit - Banca di Credito e Commercio",code:"BANKREDITBANCADICRED"},{localizedString:"Bank von Ernst",code:"BANKVONERNST"},{localizedString:"Banque Cantonale Vaudoise (BCV)",code:"BANQUECANTONALEVAUDO"},{localizedString:"Banque Diamantaire Anversoise",code:"BANQUEDIAMANTAIREANV"},{localizedString:"Banque Edouard Constant",code:"BANQUEEDOUARDCONSTAN"},{localizedString:"Banque Nationale Suisse - Banca Nazionale Svizzera",code:"BANQUENATIONALESUISS"},{localizedString:"Banque Piguet & Cie S.A.",code:"BANQUEPIGUETCIESA"},{localizedString:"Banque SCS Alliance",code:"BANQUESCSALLIANCE"},{localizedString:"BEKBnet/BCBE",code:"BEKBNETBCBE"},{localizedString:"BHE - Bank für Handel & Effekten",code:"BHEBANKFURHANDELEFFE"},{localizedString:"BNP - Banque Nationale de Paris",code:"BNPBANQUENATIONALEDE"},{localizedString:"BSI - Banca della Svizzera Italiana",code:"BSIBANCADELLASVIZZER"},{localizedString:"Clariden Bank",code:"CLARIDENBANK"},{localizedString:"Crédit Lyonnais Suisse",code:"CREDITLYONNAISSUISSE"},{localizedString:"Credit Suisse",code:"CREDITSUISSE"},{localizedString:"Discount Bank Group (DBTC/DBSA)",code:"DISCOUNTBANKGROUPDBT"},{localizedString:"Habib Bank AG Zürich",code:"HABIBBANKAGZURICH"},{localizedString:"Hottinger & Cie",code:"HOTTINGERCIE"},{localizedString:"Maerki, Baumann & Co. AG, Privatbank",code:"MAERKIBAUMANNCOAGPRI"},{localizedString:"Migrosbank",code:"MIGROSBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Pictet & Cie",code:"PICTETCIE"},{localizedString:"Raiffeisen Internet",code:"RAIFFEISENINTERNET"},{localizedString:"Royal Bank of Canada",code:"ROYALBANKOFCANADA"},{localizedString:"SBC Warburg Dillon Read (WDR)",code:"SBCWARBURGDILLONREAD"},{localizedString:"Schwyzer Kantonalbank",code:"SCHWYZERKANTONALBANK"},{localizedString:"Skandia Bank",code:"SKANDIABANK"},{localizedString:"Solothurner Bank SoBa",code:"SOLOTHURNERBANKSOBA"},{localizedString:"Sparkassa Berneck",code:"SPARKASSABERNECK"},{localizedString:"St. Gallische Kantonalbank",code:"STGALLISCHEKANTONALB"},{localizedString:"Swiss Bank Corporation",code:"SWISSBANKCORPORATION"},{localizedString:"Thurgauer Kantonalbank",code:"THURGAUERKANTONALBAN"},{localizedString:"Union Bank of Switzerland",code:"UNIONBANKOFSWITZERLA"},{localizedString:"Wegelin & Co. Privatbankiers",code:"WEGELINCOPRIVATBANKI"},{localizedString:"Zuger Kantonalbank",code:"ZUGERKANTONALBANK"},{localizedString:"Zürcher Kantonalbank",code:"ZURCHERKANTONALBANK"}],[o.Country.CL]:[{localizedString:"Banco BICE",code:"BANCOBICE"},{localizedString:"Banco Bilbao Vizcaya Argentaria (BBVA)",code:"BANCOBILBAOVIZCAYAAR"},{localizedString:"Banco Consorcio",code:"BANCOCONSORCIO"},{localizedString:"Banco de Chile",code:"BANCODECHILE"},{localizedString:"Banco de Crédito e Inversiones",code:"BANCODECREDITOEINVER"},{localizedString:"Banco del Desarrollo",code:"BANCODELDESARROLLO"},{localizedString:"Banco del Estado de Chile",code:"BANCODELESTADODECHIL"},{localizedString:"Banco Edwards-Citi",code:"BANCOEDWARDSCITI"},{localizedString:"Banco Falabella",code:"BANCOFALABELLA"},{localizedString:"Banco Internacional",code:"BANCOINTERNACIONAL"},{localizedString:"Banco Itaú-Chile",code:"BANCOITAUCHILE"},{localizedString:"Banco Paris",code:"BANCOPARIS"},{localizedString:"Banco Penta",code:"BANCOPENTA"},{localizedString:"Banco Ripley",code:"BANCORIPLEY"},{localizedString:"Banco Santander Chile",code:"BANCOSANTANDERCHILE"},{localizedString:"Banco Security",code:"BANCOSECURITY"},{localizedString:"Central Bank of Chile",code:"CENTRALBANKOFCHILE"},{localizedString:"Corpbanca",code:"CORPBANCA"},{localizedString:"Deutsche Bank Chile",code:"DEUTSCHEBANKCHILE"},{localizedString:"HSBC Bank Chile",code:"HSBCBANKCHILE"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Rabobank",code:"RABOBANK"},{localizedString:"Scotiabank Sud Americano",code:"SCOTIABANKSUDAMERICA"}],[o.Country.CO]:[{localizedString:"AVVillas",code:"AVVILLAS"},{localizedString:"Banagrario",code:"BANAGRARIO"},{localizedString:"Bancamía",code:"BANCAMIA"},{localizedString:"Banco de Bogotá",code:"BANCODEBOGOTA"},{localizedString:"Banco de la República",code:"BANCODELAREPUBLICA"},{localizedString:"Banco de Occidente",code:"BANCODEOCCIDENTE"},{localizedString:"Bancolombia",code:"BANCOLOMBIA"},{localizedString:"Banco Popular",code:"BANCOPOPULAR"},{localizedString:"Banco Santander",code:"BANCOSANTANDER"},{localizedString:"BBVA Colombia",code:"BBVACOLOMBIA"},{localizedString:"Caja Social",code:"CAJASOCIAL"},{localizedString:"Citibank Colombia",code:"CITIBANKCOLOMBIA"},{localizedString:"Colmena",code:"COLMENA"},{localizedString:"Colpatria",code:"COLPATRIA"},{localizedString:"Davivienda",code:"DAVIVIENDA"},{localizedString:"GBN Sudameris",code:"GBNSUDAMERIS"},{localizedString:"Helm",code:"HELM"},{localizedString:"HSBC Colombia",code:"HSBCCOLOMBIA"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Procredit",code:"PROCREDIT"},{localizedString:"RBS Colombia",code:"RBSCOLOMBIA"}],[o.Country.DE]:[{localizedString:"BayernLB",code:"BAYERNLB"},{localizedString:"Commerzbank",code:"COMMERZBANK"},{localizedString:"Deutsche Bank",code:"DEUTSCHEBANK"},{localizedString:"DZ Bank",code:"DZBANK"},{localizedString:"Eurohypo AG",code:"EUROHYPOAG"},{localizedString:"HSH Nordbank",code:"HSHNORDBANK"},{localizedString:"HVB Group (HypoVereinsbank)",code:"HVBGROUPHYPOVEREINSB"},{localizedString:"Hypo Real Estate Group (HRE Group)",code:"HYPOREALESTATEGROUPH"},{localizedString:"Kfw Bankgruppe",code:"KFWBANKGRUPPE"},{localizedString:"Landesbank Baden-Württemberg",code:"LANDESBANKBADENWURTT"},{localizedString:"Landesbank Berlin (LBB)",code:"LANDESBANKBERLINLBB"},{localizedString:"Landesbank Hessen-Thüringen (Helaba)",code:"LANDESBANKHESSENTHUR"},{localizedString:"Nord/LB (Norddeutsche Landesbank)",code:"NORDLBNORDDEUTSCHELA"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"N26",code:"NUMBERTWENTYSIX"},{localizedString:"Postbank AG",code:"POSTBANKAG"},{localizedString:"Sparkasse",code:"SPARKASSE"},{localizedString:"WGZ Bank (Westdeutsche Genossenschafts-Zentralbank)",code:"WGZBANKWESTDEUTSCHEG"}],[o.Country.DK]:[{localizedString:"Alm Brand Bank",code:"ALMBRANDBANK"},{localizedString:"Arbejdernes Landsbank",code:"ARBEJERNESLANDSBANK"},{localizedString:"Danske Bank",code:"DANSKEBANK"},{localizedString:"FIH Erhversbank",code:"FIHERHVERSBANK"},{localizedString:"Jyske Bank",code:"JYSKEBANK"},{localizedString:"Nordea",code:"NORDEA"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Nykredit Bank",code:"NYKREDITBANK"},{localizedString:"Spar Nord Bank",code:"SPARNORDBANK"},{localizedString:"Syd Bank",code:"SYDBANK"},{localizedString:"Vestjysk Bank",code:"VESTJYSKBANK"}],[o.Country.EC]:[{localizedString:"Banco Amazonas",code:"BANCOAMAZONAS"},{localizedString:"Banco Bolivariano",code:"BANCOBOLIVARIANO"},{localizedString:"Banco Capital",code:"BANCOCAPITAL"},{localizedString:"Banco Cofiec",code:"BANCOCOFIEC"},{localizedString:"Banco Comercial de Manabí",code:"BANCOCOMERCIALDEMANA"},{localizedString:"Banco Coopnacional",code:"BANCOCOOPNACIONAL"},{localizedString:"Banco de Guayaquil",code:"BANCODEGUAYAQUIL"},{localizedString:"Banco del Austro",code:"BANCODELAUSTRO"},{localizedString:"Banco Delbank",code:"BANCODELBANK"},{localizedString:"Banco del Litoral",code:"BANCODELLITORAL"},{localizedString:"Banco de Loja",code:"BANCODELOJA"},{localizedString:"Banco del Pacífico",code:"BANCODELPACIFICO"},{localizedString:"Banco de Machala",code:"BANCODEMACHALA"},{localizedString:"Banco D-Miro",code:"BANCODMIRO"},{localizedString:"Banco Finca",code:"BANCOFINCA"},{localizedString:"Banco General Rumiñahui",code:"BANCOGENERALRUMINAHU"},{localizedString:"Banco Internacional",code:"BANCOINTERNACIONAL"},{localizedString:"Banco Pichincha",code:"BANCOPICHINCHA"},{localizedString:"Banco Promérica",code:"BANCOPROMERICA"},{localizedString:"Banco Solidario",code:"BANCOSOLIDARIO"},{localizedString:"Banco Sudamericano",code:"BANCOSUDAMERICANO"},{localizedString:"Citibank Ecuador",code:"CITIBANKECUADOR"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"ProCredit Bank",code:"PROCREDITBANK"},{localizedString:"Produbanco",code:"PRODUBANCO"}],[o.Country.ES]:[{localizedString:"Banca March",code:"BANCAMARCH"},{localizedString:"Banco Esfinge",code:"BANCOESFINGE"},{localizedString:"Banco Espíritu Santo",code:"BANCOESPIRITUSANTO"},{localizedString:"Banco Fimestic",code:"BANCOFIMESTIC"},{localizedString:"Banco Inversión",code:"BANCOINVERSION"},{localizedString:"Banco Popular Español",code:"BANCOPOPULARESPANOL"},{localizedString:"Banco Sabadell",code:"BANCOSABADELL"},{localizedString:"Banco Santander",code:"BANCOSANTANDER"},{localizedString:"Bankia",code:"BANKIA"},{localizedString:"Bankinter",code:"BANKINTER"},{localizedString:"Bankpyme",code:"BANKPYME"},{localizedString:"Barclays Bank",code:"BARCLAYSBANK"},{localizedString:"BBVA",code:"BBVA"},{localizedString:"BCH Broker",code:"BCHBROKER"},{localizedString:"CaixaBank",code:"CAIXABANK"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"Deutsche Bank",code:"DEUTSCHEBANK"},{localizedString:"E-Cortal",code:"ECORTAL"},{localizedString:"Fiare Banca Ètica página web de Fiare",code:"FIAREBANCAETICAPAGIN"},{localizedString:"Fibanc",code:"FIBANC"},{localizedString:"Fibane",code:"FIBANE"},{localizedString:"Ibercaja",code:"IBERCAJA"},{localizedString:"ING Direct",code:"INGDIRECT"},{localizedString:"InterCaja Social .ES",code:"INTERCAJASOCIALES"},{localizedString:"Merrill Lynch",code:"MERRILLLYNCH"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Openbank",code:"OPENBANK"},{localizedString:"Salomon Smith Barney",code:"SALOMONSMITHBARNEY"},{localizedString:"Schroders",code:"SCHRODERS"},{localizedString:"Triodos Bank",code:"TRIODOSBANK"},{localizedString:"UNO-e",code:"UNOE"}],[o.Country.FI]:[{localizedString:"Aktia Savings Bank",code:"AKTIASAVINGSBANK"},{localizedString:"Bank of Åland",code:"BANKOFALAND"},{localizedString:"eQ Bank",code:"EQBANK"},{localizedString:"Evli Bank",code:"EVLIBANK"},{localizedString:"Helsinki OP Bank",code:"HELSINKIOPBANK"},{localizedString:"Kaupthing Bank",code:"KAUPTHINGBANK"},{localizedString:"Nordea Bank Finland",code:"NORDEABANKFINLAND"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"OP-Kotipankki",code:"OPKOTIPANKKI"},{localizedString:"Pohjola Bank",code:"POHJOLABANK"},{localizedString:"Sampo Bank",code:"SAMPOBANK"},{localizedString:"S-Bank",code:"SBANK"},{localizedString:"SEB Gyllenberg Private Bank",code:"SEBGYLLENBERGPRIVATE"},{localizedString:"Suomen AsuntoHypoPankki",code:"SUOMENASUNTOHYPOPANK"},{localizedString:"Tapiola Bank",code:"TAPIOLABANK"}],[o.Country.FR]:[{localizedString:"Axa Banque",code:"AXA"},{localizedString:"Banque Populaire",code:"BANQPOPUL"},{localizedString:"La Banque Postale",code:"BANQPOSTA"},{localizedString:"Banque Casino",code:"BANQUECASINO"},{localizedString:"Banque de France",code:"BANQUEDEFRANCE"},{localizedString:"Barclays",code:"BARCLAYS"},{localizedString:"BforBank",code:"BFORBANK"},{localizedString:"BNP Paribas",code:"BNP"},{localizedString:"Boursorama Banque",code:"BOURSORAMA"},{localizedString:"BRED",code:"BRED"},{localizedString:"Caisse d'Épargne",code:"CAISSEEPAR"},{localizedString:"Carrefour-Banque",code:"CARREFOURBANQUE"},{localizedString:"CIC",code:"CIC"},{localizedString:"Crédit Mutuel de Bretagne",code:"CMB"},{localizedString:"Crédit Mutuel Nord Europe",code:"CMNE"},{localizedString:"Crédit Agricole",code:"CREDAGRIC"},{localizedString:"Crédit Coopératif",code:"CREDCOOPE"},{localizedString:"Crédit Foncier",code:"CREDFONCI"},{localizedString:"Crédit Mutuel",code:"CREDMUTUEL"},{localizedString:"Crédit du Nord",code:"CREDNORD"},{localizedString:"Fortuneo Banque",code:"FORTUNEOBANQUE"},{localizedString:"Groupama Banque",code:"GROUPAMA"},{localizedString:"HSBC",code:"HSBC"},{localizedString:"ING Direct",code:"INGDIRECT"},{localizedString:"LCL",code:"LCL"},{localizedString:"Autre",code:"NO_TYPE"},{localizedString:"Société Générale",code:"SOGE"}],[o.Country.GB]:[{localizedString:"Barclays Bank",code:"BARCLAYS"},{localizedString:"Coutts",code:"COUTTS"},{localizedString:"HBOS",code:"HBOS"},{localizedString:"HSBC",code:"HSBC"},{localizedString:"Lloyds Banking Group",code:"LLOYDS"},{localizedString:"NatWest",code:"NATWEST"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Royal Bank of Scotland (RBS)",code:"RBS"},{localizedString:"Santander",code:"SANTANDER"},{localizedString:"Standard Chartered",code:"STANDCHAR"},{localizedString:"Virgin Money",code:"VIRGINMONEY"},{localizedString:"Yorkshire Bank",code:"YORKSHIRE"},{localizedString:"Yorkshire Building Society",code:"YORKSHIREBS"}],[o.Country.GT]:[{localizedString:"Agromercantil",code:"AGROMERCANTIL"},{localizedString:"Azteca Bank",code:"AZTECABANK"},{localizedString:"BAC Bank",code:"BACBANK"},{localizedString:"Bank of Antigua",code:"BANKOFANTIGUA"},{localizedString:"Bantrab Bank",code:"BANTRABBANK"},{localizedString:"Citi Bank",code:"CITIBANK"},{localizedString:"Credito Hipotecario Bank",code:"CREDITOHIPOTECARIOBA"},{localizedString:"De Credito Bank",code:"DECREDITOBANK"},{localizedString:"Ficohsa Bank",code:"FICOHSABANK"},{localizedString:"G&T Continental Bank",code:"GTCONTINENTALBANK"},{localizedString:"Industrial bank",code:"INDUSTRIALBANK"},{localizedString:"Inmobiliario Bank",code:"INMOBILIARIOBANK"},{localizedString:"Internacional Bank",code:"INTERNACIONALBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Reformador Bank",code:"REFORMADORBANK"},{localizedString:"Vivibanco Bank",code:"VIVIBANCOBANK"}],[o.Country.HK]:[{localizedString:"Bank of China",code:"BANKOFCHINA"},{localizedString:"Bank of East Asia, The",code:"BANKOFEASTASIATHE"},{localizedString:"China CITIC Bank International",code:"CHINACITICBANKINTERN"},{localizedString:"China Construction Bank",code:"CHINACONSTRUCTIONBAN"},{localizedString:"Chiyu Banking Corporation",code:"CHIYUBANKINGCORPORAT"},{localizedString:"Chong Hing Bank",code:"CHONGHINGBANK"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"Dah Sing Bank",code:"DAHSINGBANK"},{localizedString:"DBS Bank",code:"DBSBANK"},{localizedString:"Fubon Bank",code:"FUBONBANK"},{localizedString:"Hang Seng Bank",code:"HANGSENGBANK"},{localizedString:"Hongkong and Shanghai Banking Corporation, The",code:"HONGKONGANDSHANGHAIB"},{localizedString:"Industrial and Commercial Bank of China",code:"INDUSTRIALANDCOMMERC"},{localizedString:"Nanyang Commercial Bank",code:"NANYANGCOMMERCIALBAN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"OCBC Wing Hang Bank",code:"OCBCWINGHANGBANK"},{localizedString:"Public Bank",code:"PUBLICBANK"},{localizedString:"Shanghai Commercial Bank",code:"SHANGHAICOMMERCIALBA"},{localizedString:"Standard Chartered Bank",code:"STANDARDCHARTEREDBAN"},{localizedString:"Tai Sang Bank",code:"TAISANGBANK"},{localizedString:"Tai Yau Bank",code:"TAIYAUBANK"},{localizedString:"Wing Lung Bank",code:"WINGLUNGBANK"}],[o.Country.IE]:[{localizedString:"ACC Bank",code:"ACCBANK"},{localizedString:"Allied Irish Banks",code:"ALLIEDIRISHBANKS"},{localizedString:"Anglo Irish Bank",code:"ANGLOIRISHBANK"},{localizedString:"Bank of Ireland",code:"BANKOFIRELAND"},{localizedString:"Barclays Bank Ireland",code:"BARCLAYSBANKIRELAND"},{localizedString:"Bear Stearns Bank",code:"BEARSTEARNSBANK"},{localizedString:"Capmark Bank Europe",code:"CAPMARKBANKEUROPE"},{localizedString:"Citibank Europe",code:"CITIBANKEUROPE"},{localizedString:"Fortis Prime Fund Solutions Bank",code:"FORTISPRIMEFUNDSOLUT"},{localizedString:"Goldman Sachs Bank",code:"GOLDMANSACHSBANK"},{localizedString:"Goldman Sachs Private Bank",code:"GOLDMANSACHSPRIVATEB"},{localizedString:"Helaba Dublin Landesbank Hessen-Thüringen International",code:"HELABADUBLINLANDESBA"},{localizedString:"Hewlett-Packard International Bank",code:"HEWLETTPACKARDINTERN"},{localizedString:"Hypo Public Finance Bank",code:"HYPOPUBLICFINANCEBAN"},{localizedString:"Intesa Sanpaolo Bank Ireland",code:"INTESASANPAOLOBANKIR"},{localizedString:"Irish Life & Permanent",code:"IRISHLIFEPERMANENT"},{localizedString:"JP Morgan Bank",code:"JPMORGANBANK"},{localizedString:"KBC Bank Ireland",code:"KBCBANKIRELAND"},{localizedString:"LGT Bank",code:"LGTBANK"},{localizedString:"Merrill Lynch International Bank",code:"MERRILLLYNCHINTERNAT"},{localizedString:"Naspa Dublin",code:"NASPADUBLIN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Pfizer International Bank Europe",code:"PFIZERINTERNATIONALB"},{localizedString:"PFPC Bank",code:"PFPCBANK"}],[o.Country.IN]:[{localizedString:"ABN AMRO India",code:"ABNAMROINDIA"},{localizedString:"Abu Dhabi Commercial Bank India",code:"ABUDHABICOMMERCIALBA"},{localizedString:"Allahabad Bank",code:"ALLAHABADBANK"},{localizedString:"Andhra Bank",code:"ANDHRABANK"},{localizedString:"Axis Bank Limited",code:"AXISBANKLIMITED"},{localizedString:"Canara Bank",code:"CANARABANK"},{localizedString:"Central Bank of India",code:"CENTRALBANKOFINDIA"},{localizedString:"Centurion Bank of Punjab",code:"CENTURIONBANKOFPUNJA"},{localizedString:"Citibank India",code:"CITIBANKINDIA"},{localizedString:"Corporation Bank",code:"CORPORATIONBANK"},{localizedString:"DCB (Development Credit Bank Ltd)",code:"DCBDEVELOPMENTCREDIT"},{localizedString:"Dena Bank",code:"DENABANK"},{localizedString:"Deutsche Bank",code:"DEUTSCHEBANK"},{localizedString:"Guardian Souharda Sahakari Bank Niyamita",code:"GUARDIANSOUHARDASAHA"},{localizedString:"HDFC Bank",code:"HDFCBANK"},{localizedString:"IDBI Bank",code:"IDBIBANK"},{localizedString:"Indian Bank",code:"INDIANBANK"},{localizedString:"Indian Overseas Bank",code:"INDIANOVERSEASBANK"},{localizedString:"IndusInd Bank Ltd",code:"INDUSINDBANKLTD"},{localizedString:"ING Vysya Bank",code:"INGVYSYABANK"},{localizedString:"Maharshtra Bank",code:"MAHARSHTRABANK"},{localizedString:"Mandvi Bank",code:"MANDVIBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Oriental Bank of Commerce",code:"ORIENTALBANKOFCOMMER"},{localizedString:"Saraswat Bank",code:"SARASWATBANK"},{localizedString:"South Indian Bank",code:"SOUTHINDIANBANK"},{localizedString:"Standard Chartered Bank",code:"STANDARDCHARTEREDBAN"},{localizedString:"State Bank of Hyderabad",code:"STATEBANKOFHYDERABAD"},{localizedString:"State Bank of Saurashtra",code:"STATEBANKOFSAURASHTR"},{localizedString:"Syndicate Bank",code:"SYNDICATEBANK"},{localizedString:"The Federal Bank Ltd",code:"THEFEDERALBANKLTD"},{localizedString:"UCO Bank",code:"UCOBANK"},{localizedString:"Union Bank of India",code:"UNIONBANKOFINDIA"}],[o.Country.IT]:[{localizedString:"Banca Carige",code:"BANCACARIGE"},{localizedString:"Banca Pop. Milano",code:"BANCAPOPMILANO"},{localizedString:"Banco Popolare",code:"BANCOPOPOLARE"},{localizedString:"B Monte Paschi Siena",code:"BMONTEPASCHISIENA"},{localizedString:"Credito Emiliano",code:"CREDITOEMILIANO"},{localizedString:"Intesa Sanpaolo",code:"INTESASANPAOLO"},{localizedString:"Mediobanca",code:"MEDIOBANCA"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Ubi Banca",code:"UBIBANCA"},{localizedString:"Unicredit - Capitalia",code:"UNICREDITCAPITALIA"}],[o.Country.JP]:[{localizedString:"Chiba Kōgyō Bank",code:"CHIBAKOGYOBANK"},{localizedString:"Mitsubishi UFJ Financial Group",code:"MITSUBISHIUFJFINANCI"},{localizedString:"Mitsubishi UFJ Trust and Banking Corporation",code:"MITSUBISHIUFJTRUSTAN"},{localizedString:"Mizuho Bank",code:"MIZUHOBANK"},{localizedString:"Mizuho Corporate Bank",code:"MIZUHOCORPORATEBANK"},{localizedString:"Mizuho Financial Group",code:"MIZUHOFINANCIALGROUP"},{localizedString:"Mizuho Trust & Banking Co.",code:"MIZUHOTRUSTBANKINGCO"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Sumitomo Mitsui Banking Corporation",code:"SUMITOMOMITSUIBANKIN"},{localizedString:"Sumitomo Mitsui Financial Group",code:"SUMITOMOMITSUIFINANC"},{localizedString:"The Bank of Tokyo-Mitsubishi UFJ",code:"THEBANKOFTOKYOMITSUB"},{localizedString:"The Master Trust Bank of Japan",code:"THEMASTERTRUSTBANKOF"},{localizedString:"The Senshū Bank",code:"THESENSHUBANK"},{localizedString:"Trust & Custody Services Bank",code:"TRUSTCUSTODYSERVICES"}],[o.Country.LU]:[{localizedString:"Banque et Caisse d'Epargne de l'Etat, Luxembourg (BCEE)",code:"BANQUEETCAISSEDEPARG"},{localizedString:"Banque Générale du Luxembourg",code:"BANQUEGENERALEDULUXE"},{localizedString:"Banque IPPA et Associes Luxembourg",code:"BANQUEIPPAETASSOCIES"},{localizedString:"Banque UCL",code:"BANQUEUCL"},{localizedString:"Die Sparkasse Bremen",code:"DIESPARKASSEBREMEN"},{localizedString:"KBL",code:"KBL"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Robeco Bank",code:"ROBECOBANK"},{localizedString:"SGZ-Bank International",code:"SGZBANKINTERNATIONAL"},{localizedString:"WestLB International",code:"WESTLBINTERNATIONAL"}],[o.Country.MX]:[{localizedString:"Banamex",code:"BANAMEX"},{localizedString:"Banca Afirme",code:"BANCAAFIRME"},{localizedString:"Banco Azteca",code:"BANCOAZTECA"},{localizedString:"Banco del Bajio",code:"BANCODELBAJIO"},{localizedString:"Banco J.P. Morgan",code:"BANCOJPMORGAN"},{localizedString:"Bank of America Mexico",code:"BANKOFAMERICAMEXICO"},{localizedString:"Banorte",code:"BANORTE"},{localizedString:"BanRegio",code:"BANREGIO"},{localizedString:"BBVA Bancomer",code:"BBVABANCOMER"},{localizedString:"Deutsche Bank Mexico",code:"DEUTSCHEBANKMEXICO"},{localizedString:"HSBC Mexico",code:"HSBCMEXICO"},{localizedString:"Inbursa",code:"INBURSA"},{localizedString:"ING Bank Mexico",code:"INGBANKMEXICO"},{localizedString:"Interacciones",code:"INTERACCIONES"},{localizedString:"Invex Controladora",code:"INVEXCONTROLADORA"},{localizedString:"Ixe Banco",code:"IXEBANCO"},{localizedString:"Mifel",code:"MIFEL"},{localizedString:"Monex",code:"MONEX"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Santander Mexico",code:"SANTANDERMEXICO"},{localizedString:"Scotiabank Inverlat",code:"SCOTIABANKINVERLAT"}],[o.Country.NL]:[{localizedString:"ABN Amro",code:"ABNAMRO"},{localizedString:"Amsterdam Trade Bank",code:"AMSTERDAMTRADEBANK"},{localizedString:"ASN Bank",code:"ASNBANK"},{localizedString:"Bank Mendes Gans",code:"BANKMENDESGANS"},{localizedString:"Bank Nederlandse Gemeenten",code:"BANKNEDERLANDSEGEMEE"},{localizedString:"BinckBank",code:"BINCKBANK"},{localizedString:"Bunq",code:"BUNQ"},{localizedString:"Credit Europe Bank",code:"CREDITEUROPEBANK"},{localizedString:"Demir Halk Bank",code:"DEMIRHALKBANK"},{localizedString:"Friesland Bank",code:"FRIESLANDBANK"},{localizedString:"GE Artesia Bank",code:"GEARTESIABANK"},{localizedString:"ING Group",code:"INGGROUP"},{localizedString:"Kempen & Co",code:"KEMPENCO"},{localizedString:"Nederlandse Waterschapsbank",code:"NEDERLANDSEWATERSCHA"},{localizedString:"Netherlands Development Finance Company",code:"NETHERLANDSDEVELOPME"},{localizedString:"NIBC Bank",code:"NIBCBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Rabobank",code:"RABOBANK"},{localizedString:"SNS Bank",code:"SNSBANK"},{localizedString:"Triodos Bank",code:"TRIODOSBANK"},{localizedString:"Van Lanschot",code:"VANLANSCHOT"}],[o.Country.NO]:[{localizedString:"Bolig- og Næringsbanken",code:"BOLIGOGNAERINGSBANKE"},{localizedString:"Cresco",code:"CRESCO"},{localizedString:"DnB NOR Bank",code:"DNBNORBANK"},{localizedString:"Fokus Bank",code:"FOKUSBANK"},{localizedString:"Landkreditt Bank",code:"LANDKREDITTBANK"},{localizedString:"Netfonds Bank",code:"NETFONDSBANK"},{localizedString:"Nordea Bank Norge",code:"NORDEABANKNORGE"},{localizedString:"Nordlandsbanken",code:"NORDLANDSBANKEN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Pareto Bank",code:"PARETOBANK"},{localizedString:"Santander Consumer Bank",code:"SANTANDERCONSUMERBAN"},{localizedString:"SEB Privatbanken",code:"SEBPRIVATBANKEN"},{localizedString:"Storebrand Bank",code:"STOREBRANDBANK"},{localizedString:"Verdibanken",code:"VERDIBANKEN"},{localizedString:"Voss Veksel- og Landmandsbank",code:"VOSSVEKSELOGLANDMAND"},{localizedString:"yA Bank",code:"YABANK"}],[o.Country.NZ]:[{localizedString:"ANZ Bank of New Zealand Limited",code:"ANZBANKOFNEWZEALANDL"},{localizedString:"ASB Bank Limited",code:"ASBBANKLIMITED"},{localizedString:"Australia and New Zealand Banking Group",code:"AUSTRALIAANDNEWZEALA"},{localizedString:"Bank of Baroda (New Zealand) Limited",code:"BANKOFBARODANEWZEALA"},{localizedString:"Bank of China (New Zealand) Limited",code:"BANKOFCHINANEWZEALAN"},{localizedString:"Bank of India (New Zealand) Limited",code:"BANKOFINDIANEWZEALAN"},{localizedString:"Bank of New Zealand",code:"BANKOFNEWZEALAND"},{localizedString:"China Construction Bank",code:"CHINACONSTRUCTIONBAN"},{localizedString:"Citibank N.A.",code:"CITIBANKNA"},{localizedString:"Commonwealth Bank of Australia",code:"COMMONWEALTHBANKOFAU"},{localizedString:"Deutsche Bank AG",code:"DEUTSCHEBANKAG"},{localizedString:"Heartland Bank Limited",code:"HEARTLANDBANKLIMITED"},{localizedString:"ICBC",code:"ICBC"},{localizedString:"JPMorgan Chase Bank N.A.",code:"JPMORGANCHASEBANKNA"},{localizedString:"Kiwibank Limited",code:"KIWIBANKLIMITED"},{localizedString:"Kookmin Bank",code:"KOOKMINBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Rabobank Nederland",code:"RABOBANKNEDERLAND"},{localizedString:"Rabobank New Zealand Limited",code:"RABOBANKNEWZEALANDLI"},{localizedString:"Southland Building Society",code:"SOUTHLANDBUILDINGSOC"},{localizedString:"The Bank of Tokyo-Mitsubishi UFJ",code:"THEBANKOFTOKYOMITSUB"},{localizedString:"The Co-operative Bank Limited",code:"THECOOPERATIVEBANKLI"},{localizedString:"The Hongkong and Shanghai Banking Corp",code:"THEHONGKONGANDSHANGH"},{localizedString:"TSB Bank Limited",code:"TSBBANKLIMITED"},{localizedString:"Westpac Banking Corporation",code:"WESTPACBANKINGCORPOR"},{localizedString:"Westpac New Zealand Limited",code:"WESTPACNEWZEALANDLIM"}],[o.Country.PE]:[{localizedString:"Agrobanco",code:"AGROBANCO"},{localizedString:"Banco Azteca",code:"BANCOAZTECA"},{localizedString:"Banco Central de Reserva del Perú",code:"BANCOCENTRALDERESERV"},{localizedString:"Banco de Comercio",code:"BANCODECOMERCIO"},{localizedString:"Banco del Trabajo",code:"BANCODELTRABAJO"},{localizedString:"Banco de Materiales",code:"BANCODEMATERIALES"},{localizedString:"Banco Falabella",code:"BANCOFALABELLA"},{localizedString:"Banco Financiero",code:"BANCOFINANCIERO"},{localizedString:"Banco Interamericano de Finanzas",code:"BANCOINTERAMERICANOD"},{localizedString:"Banco Ripley",code:"BANCORIPLEY"},{localizedString:"BBVA",code:"BBVA"},{localizedString:"BCP",code:"BCP"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"Deutsche Bank",code:"DEUTSCHEBANK"},{localizedString:"HSBC",code:"HSBC"},{localizedString:"Interbank",code:"INTERBANK"},{localizedString:"Mibanco",code:"MIBANCO"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Santander",code:"SANTANDER"},{localizedString:"Scotiabank",code:"SCOTIABANK"},{localizedString:"Standard Chartered",code:"STANDARDCHARTERED"}],[o.Country.PH]:[{localizedString:"Al-Amanah Islamic Investment Bank of the Philippines",code:"ALAMANAHISLAMICINVES"},{localizedString:"Asia United Bank",code:"ASIAUNITEDBANK"},{localizedString:"Australia and New Zealand Banking Group",code:"AUSTRALIAANDNEWZEALA"},{localizedString:"Bangkok Bank",code:"BANGKOKBANK"},{localizedString:"Bank of America, N.A.",code:"BANKOFAMERICANA"},{localizedString:"Bank of China",code:"BANKOFCHINA"},{localizedString:"Bank of Commerce",code:"BANKOFCOMMERCE"},{localizedString:"Bank of the Philippine Islands",code:"BANKOFTHEPHILIPPINEI"},{localizedString:"BDO Private Bank",code:"BDOPRIVATEBANK"},{localizedString:"BDO Unibank",code:"BDOUNIBANK"},{localizedString:"Chinabank",code:"CHINABANK"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"CTBC Bank",code:"CTBCBANK"},{localizedString:"Deutsche Bank",code:"DEUTSCHEBANK"},{localizedString:"Development Bank of the Philippines",code:"DEVELOPMENTBANKOFTHE"},{localizedString:"EastWest Bank",code:"EASTWESTBANK"},{localizedString:"ING Group",code:"INGGROUP"},{localizedString:"JPMorgan Chase",code:"JPMORGANCHASE"},{localizedString:"Land Bank of the Philippines",code:"LANDBANKOFTHEPHILIPP"},{localizedString:"Maybank Philippines, Inc.",code:"MAYBANKPHILIPPINESIN"},{localizedString:"Mega International Commercial Bank",code:"MEGAINTERNATIONALCOM"},{localizedString:"Metropolitan Bank and Trust Company",code:"METROPOLITANBANKANDT"},{localizedString:"Mizuho Bank, Ltd.",code:"MIZUHOBANKLTD"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Philippine Bank of Communications",code:"PHILIPPINEBANKOFCOMM"},{localizedString:"Philippine National Bank",code:"PHILIPPINENATIONALBA"},{localizedString:"Philippine Veterans Bank",code:"PHILIPPINEVETERANSBA"},{localizedString:"Philtrust Bank",code:"PHILTRUSTBANK"},{localizedString:"Rizal Commercial Banking Corporation",code:"RIZALCOMMERCIALBANKI"},{localizedString:"Robinsons Bank",code:"ROBINSONSBANK"},{localizedString:"Security Bank",code:"SECURITYBANK"},{localizedString:"Standard Chartered Bank",code:"STANDARDCHARTEREDBAN"},{localizedString:"The Bank of Tokyo-Mitsubishi UFJ, Ltd.",code:"THEBANKOFTOKYOMITSUB"},{localizedString:"The Hongkong and Shanghai Banking Corporation",code:"THEHONGKONGANDSHANGH"},{localizedString:"Union Bank of the Philippines",code:"UNIONBANKOFTHEPHILIP"},{localizedString:"United Coconut Planters Bank",code:"UNITEDCOCONUTPLANTER"}],[o.Country.PT]:[{localizedString:"Atlantico - Banco Português do Atlântico",code:"ATLANTICOBANCOPORTUG"},{localizedString:"Banco 7",code:"BANCO7"},{localizedString:"Banco BPI",code:"BANCOBPI"},{localizedString:"Banco Comercial Português",code:"BANCOCOMERCIALPORTUG"},{localizedString:"Banco de Portugal",code:"BANCODEPORTUGAL"},{localizedString:"Banco Espirito Santo",code:"BANCOESPIRITOSANTO"},{localizedString:"Banco Internacional de Crédito, S.A.",code:"BANCOINTERNACIONALDE"},{localizedString:"Banco Mello",code:"BANCOMELLO"},{localizedString:"Banif - Banco Internacional do Funchal",code:"BANIFBANCOINTERNACIO"},{localizedString:"Barclays Netbanking Portugal",code:"BARCLAYSNETBANKINGPO"},{localizedString:"Caixa Geral de Depósitos",code:"CAIXAGERALDEDEPOSITO"},{localizedString:"Cisf - Banco de Investimento, S.A.",code:"CISFBANCODEINVESTIME"},{localizedString:"Other",code:"NO_TYPE"}],[o.Country.SE]:[{localizedString:"ABN AMRO Bank Sweden",code:"ABNAMROBANKSWEDEN"},{localizedString:"First Baltic Savings",code:"FIRSTBALTICSAVINGS"},{localizedString:"FöreningsSparbanken (Swedbank)",code:"FORENINGSSPARBANKENS"},{localizedString:"JP Bank",code:"JPBANK"},{localizedString:"Nordbanken",code:"NORDBANKEN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Östgöta Enskilda Bank",code:"OSTGOTAENSKILDABANK"},{localizedString:"Skandia Banken",code:"SKANDIABANKEN"},{localizedString:"Skandinaviska Enskilda Banken",code:"SKANDINAVISKAENSKILD"},{localizedString:"Sparbanken Sverige - Swedbank",code:"SPARBANKENSVERIGESWE"},{localizedString:"Stadshypotek",code:"STADSHYPOTEK"},{localizedString:"Svenska Handelsbanken-SHB",code:"SVENSKAHANDELSBANKEN"},{localizedString:"Sveriges Riksbank",code:"SVERIGESRIKSBANK"},{localizedString:"Trygg Hansa",code:"TRYGGHANSA"},{localizedString:"Westra Wermlands Sparbank",code:"WESTRAWERMLANDSSPARB"}],[o.Country.SG]:[{localizedString:"Bank of America",code:"BANKOFAMERICA"},{localizedString:"Barclays bank",code:"BARCLAYSBANK"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"Developmental Bank of Singapore",code:"DEVELOPMENTALBANKOFS"},{localizedString:"HSBC",code:"HSBC"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"OCBC Bank",code:"OCBCBANK"},{localizedString:"Post Office Savings Bank",code:"POSTOFFICESAVINGSBAN"},{localizedString:"Standard Chartered Bank",code:"STANDARDCHARTEREDBAN"},{localizedString:"State Bank of India",code:"STATEBANKOFINDIA"},{localizedString:"United Overseas Bank",code:"UNITEDOVERSEASBANK"}],[o.Country.US]:[{localizedString:"Ally Bank",code:"ALLY"},{localizedString:"American Express",code:"AMERICANEXPRESS"},{localizedString:"Associated Bank",code:"ASSOCIATED"},{localizedString:"Bank of the West",code:"BANKWEST"},{localizedString:"Barclays Bank",code:"BARCLAYS"},{localizedString:"BMO Harris Bank",code:"BMO"},{localizedString:"Bank of America",code:"BOA"},{localizedString:"Branch Banking and Trust Company",code:"BRANCH"},{localizedString:"Capital One",code:"CAPITALONE"},{localizedString:"Charles Schwab Bank",code:"CHARSCHWA"},{localizedString:"Chase Bank USA",code:"CHASE"},{localizedString:"Citibank",code:"CITIBANK"},{localizedString:"Citizens Bank of Pennsylvania",code:"CITIZENS"},{localizedString:"City National Bank",code:"CITYNATIONAL"},{localizedString:"Compass Bank",code:"COMPASS"},{localizedString:"CU Hawaii",code:"CUHAWAII"},{localizedString:"Discover Bank",code:"DISCOVER"},{localizedString:"E-Trade Bank",code:"ETRADE"},{localizedString:"Fifth Third Bank",code:"FIFTHTHIRD"},{localizedString:"First-Citizens Bank and Trust Company",code:"FIRSTCITIZENS"},{localizedString:"Fortune Bank",code:"FORTUNEBANK"},{localizedString:"Harris National Association",code:"HARRIS"},{localizedString:"HSBC Bank USA",code:"HSBC"},{localizedString:"Hudson City Savings Bank",code:"HUDSONCITY"},{localizedString:"The Huntington National Bank",code:"HUNTINGTON"},{localizedString:"ING Bank, fsb",code:"INGBANK"},{localizedString:"JPMorgan Chase Bank",code:"JPMORGAN"},{localizedString:"Keybank",code:"KEYBANK"},{localizedString:"Manufacturers and Traders Trust Company",code:"MANUFACTUR"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"New York Community Bank",code:"NYCOMMUNITY"},{localizedString:"The Bank of New York Mellon",code:"NYMELLON"},{localizedString:"PNC Bank",code:"PNC"},{localizedString:"Banco Popular de Puerto Rico",code:"PUERTORICO"},{localizedString:"RBC Bank",code:"RBC"},{localizedString:"RBS Citizens",code:"RBS"},{localizedString:"Regions Bank",code:"REGIONS"},{localizedString:"Sovereign Bank",code:"SOVEREIGN"},{localizedString:"State Street Bank and Trust Co.",code:"STATESTREET"},{localizedString:"SunTrust Bank",code:"SUNTRUST"},{localizedString:"Silicon Valley Bank",code:"SVB"},{localizedString:"Synovus Bank",code:"SYNOVUS"},{localizedString:"TD Bank",code:"TDBANK"},{localizedString:"UBS Bank",code:"UBS"},{localizedString:"Union Bank",code:"UNION"},{localizedString:"USAA Federal Savings Bank",code:"USAAFEDERAL"},{localizedString:"U.S. Bank",code:"USBANK"},{localizedString:"Wells Fargo",code:"WELLSFARGO"}],[o.Country.VE]:[{localizedString:"100% Banco",code:"100BANCO"},{localizedString:"Bancaribe",code:"BANCARIBE"},{localizedString:"Banco Bicentenario",code:"BANCOBICENTENARIO"},{localizedString:"Banco de Venezuela",code:"BANCODEVENEZUELA"},{localizedString:"Banco Industrial de Venezuela",code:"BANCOINDUSTRIALDEVEN"},{localizedString:"Banco Mercantil",code:"BANCOMERCANTIL"},{localizedString:"Banco Nacional de Crédito",code:"BANCONACIONALDECREDI"},{localizedString:"Banco Occidental de Descuento",code:"BANCOOCCIDENTALDEDES"},{localizedString:"Banco Venezolano de Crédito",code:"BANCOVENEZOLANODECRE"},{localizedString:"Bandes",code:"BANDES"},{localizedString:"Banesco",code:"BANESCO"},{localizedString:"BBVA Provincial",code:"BBVAPROVINCIAL"},{localizedString:"Central Bank of Venezuela",code:"CENTRALBANKOFVENEZUE"},{localizedString:"Fondo Común",code:"FONDOCOMUN"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Sofitasa",code:"SOFITASA"},{localizedString:"Women's Development Bank",code:"WOMENSDEVELOPMENTBAN"}],[o.Country.ZA]:[{localizedString:"Absa",code:"ABSA"},{localizedString:"Capitec Banking Group",code:"CAPITECBANKINGGROUP"},{localizedString:"FNB",code:"FNB"},{localizedString:"Investec Bank",code:"INVESTECBANK"},{localizedString:"Nedbank",code:"NEDBANK"},{localizedString:"Other",code:"NO_TYPE"},{localizedString:"Standard Bank",code:"STANDARDBANK"}]}},85406:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAllBanks=t.getBanks=void 0;const o=r(82912);t.getBanks=function(e){return{banks:o.banks[e.country]}},t.getAllBanks=function(){return o.banks}},80814:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GeographicStatesLevel1=t.GeographicStatesLevel0=void 0;const o=r(45127);t.GeographicStatesLevel0={[o.Country.FR]:{"FR-0-42":{code:"42",name:"Alsace"},"FR-0-72":{code:"72",name:"Aquitaine"},"FR-0-83":{code:"83",name:"Auvergne"},"FR-0-25":{code:"25",name:"Basse-Normandie"},"FR-0-26":{code:"26",name:"Bourgogne"},"FR-0-53":{code:"53",name:"Bretagne"},"FR-0-24":{code:"24",name:"Centre"},"FR-0-21":{code:"21",name:"Champagne-Ardenne"},"FR-0-94":{code:"94",name:"Corse"},"FR-0-43":{code:"43",name:"Franche-Comte"},"FR-0-01":{code:"01",name:"Guadeloupe"},"FR-0-03":{code:"03",name:"Guyane"},"FR-0-23":{code:"23",name:"Haute-Normandie"},"FR-0-11":{code:"11",name:"Ile-de-France"},"FR-0-04":{code:"04",name:"La Reunion"},"FR-0-91":{code:"91",name:"Languedoc-Roussillon"},"FR-0-74":{code:"74",name:"Limousin"},"FR-0-41":{code:"41",name:"Lorraine"},"FR-0-02":{code:"02",name:"Martinique"},"FR-0-73":{code:"73",name:"Midi-Pyrenees"},"FR-0-31":{code:"31",name:"Nord-Pas-de-Calais"},"FR-0-52":{code:"52",name:"Pays de la Loire"},"FR-0-22":{code:"22",name:"Picardie"},"FR-0-54":{code:"54",name:"Poitou-Charentes"},"FR-0-93":{code:"93",name:"Provence-Alpes-Cote d'Azur"},"FR-0-82":{code:"82",name:"Rhone-Alpes"}},[o.Country.GB]:{"GB-0-67":{code:"67",name:"Aberdeenshire"},"GB-0-68":{code:"68",name:"Angus"},"GB-0-69":{code:"69",name:"Antrim"},"GB-0-70":{code:"70",name:"Ards"},"GB-0-71":{code:"71",name:"Argyll"},"GB-0-72":{code:"72",name:"Armagh"},"GB-0-01":{code:"01",name:"Avon"},"GB-0-73":{code:"73",name:"Ayrshire"},"GB-0-74":{code:"74",name:"Ballymena"},"GB-0-75":{code:"75",name:"Ballymoney"},"GB-0-76":{code:"76",name:"Banbridge"},"GB-0-77":{code:"77",name:"Banffshire"},"GB-0-78":{code:"78",name:"Bath & NthEstSomerset"},"GB-0-02":{code:"02",name:"Bedfordshire"},"GB-0-79":{code:"79",name:"Belfast"},"GB-0-03":{code:"03",name:"Berkshire"},"GB-0-80":{code:"80",name:"Berwickshire"},"GB-0-81":{code:"81",name:"Blackburn"},"GB-0-82":{code:"82",name:"Blackpool"},"GB-0-04":{code:"04",name:"Borders"},"GB-0-83":{code:"83",name:"Bournemouth"},"GB-0-84":{code:"84",name:"Bracknell Forest"},"GB-0-85":{code:"85",name:"Brighton & Hove"},"GB-0-86":{code:"86",name:"Bristol"},"GB-0-05":{code:"05",name:"Buckinghamshire"},"GB-0-87":{code:"87",name:"Caithness"},"GB-0-06":{code:"06",name:"Cambridgeshire"},"GB-0-88":{code:"88",name:"Carrickfergus"},"GB-0-89":{code:"89",name:"Castlereagh"},"GB-0-07":{code:"07",name:"Central"},"GB-0-08":{code:"08",name:"Cheshire"},"GB-0-91":{code:"91",name:"Clackmannanshire"},"GB-0-12":{code:"12",name:"Cleveland"},"GB-0-09":{code:"09",name:"Clwyd"},"GB-0-92":{code:"92",name:"Coleraine"},"GB-0-93":{code:"93",name:"Cookstown"},"GB-0-10":{code:"10",name:"Cornwall"},"GB-0-94":{code:"94",name:"Craigavon"},"GB-0-11":{code:"11",name:"Cumbria"},"GB-0-95":{code:"95",name:"Darlington"},"GB-0-13":{code:"13",name:"Derbyshire"},"GB-0-16":{code:"16",name:"Devon"},"GB-0-14":{code:"14",name:"Dorset"},"GB-0-96":{code:"96",name:"Down"},"GB-0-97":{code:"97",name:"Dumfries a. Galloway"},"GB-0-98":{code:"98",name:"Dumfriesshire"},"GB-0-99":{code:"99",name:"Dunbartonshire"},"GB-0-100":{code:"100",name:"Dungannon"},"GB-0-15":{code:"15",name:"Durham"},"GB-0-17":{code:"17",name:"Dyfed"},"GB-0-101":{code:"101",name:"East Lothian"},"GB-0-102":{code:"102",name:"East Riding"},"GB-0-103":{code:"103",name:"East Sussex"},"GB-0-18":{code:"18",name:"Essex"},"GB-0-104":{code:"104",name:"Fermanagh"},"GB-0-19":{code:"19",name:"Fife"},"GB-0-20":{code:"20",name:"Gloucestershire"},"GB-0-22":{code:"22",name:"Grampian"},"GB-0-36":{code:"36",name:"Greater London"},"GB-0-21":{code:"21",name:"Greater Manchester"},"GB-0-23":{code:"23",name:"Gwent"},"GB-0-24":{code:"24",name:"Gwynedd"},"GB-0-105":{code:"105",name:"Halton"},"GB-0-25":{code:"25",name:"Hampshire"},"GB-0-106":{code:"106",name:"Hartlepool"},"GB-0-29":{code:"29",name:"Hereford and Worcs."},"GB-0-107":{code:"107",name:"Herefordshire"},"GB-0-27":{code:"27",name:"Hertfordshire"},"GB-0-108":{code:"108",name:"Highland"},"GB-0-28":{code:"28",name:"Humberside"},"GB-0-109":{code:"109",name:"Inverness-Shire"},"GB-0-110":{code:"110",name:"Isle Of Arran"},"GB-0-111":{code:"111",name:"Isle Of Barra"},"GB-0-112":{code:"112",name:"Isle Of Benbecula"},"GB-0-113":{code:"113",name:"Isle Of Bute"},"GB-0-114":{code:"114",name:"Isle Of Canna"},"GB-0-115":{code:"115",name:"Isle Of Coll"},"GB-0-116":{code:"116",name:"Isle Of Colonsay"},"GB-0-117":{code:"117",name:"Isle Of Cumbrae"},"GB-0-118":{code:"118",name:"Isle Of Eigg"},"GB-0-119":{code:"119",name:"Isle Of Gigha"},"GB-0-120":{code:"120",name:"Isle Of Harris"},"GB-0-121":{code:"121",name:"Isle Of Iona"},"GB-0-122":{code:"122",name:"Isle Of Islay"},"GB-0-123":{code:"123",name:"Isle Of Jura"},"GB-0-124":{code:"124",name:"Isle Of Lewis"},"GB-0-126":{code:"126",name:"Isle Of Mull"},"GB-0-127":{code:"127",name:"Isle Of North Uist"},"GB-0-128":{code:"128",name:"Isle Of Rum"},"GB-0-129":{code:"129",name:"Isle Of Scalpay"},"GB-0-131":{code:"131",name:"Isle Of Skye"},"GB-0-132":{code:"132",name:"Isle Of South Uist"},"GB-0-133":{code:"133",name:"Isle Of Tiree"},"GB-0-31":{code:"31",name:"Isle of Wight"},"GB-0-130":{code:"130",name:"Isles Of Scilly"},"GB-0-32":{code:"32",name:"Kent"},"GB-0-134":{code:"134",name:"Kincardineshire"},"GB-0-135":{code:"135",name:"Kingston-Upon-Hull"},"GB-0-136":{code:"136",name:"Kirkcudbrightshire"},"GB-0-137":{code:"137",name:"Lanarkshire"},"GB-0-33":{code:"33",name:"Lancashire"},"GB-0-138":{code:"138",name:"Larne"},"GB-0-139":{code:"139",name:"Leicester City"},"GB-0-34":{code:"34",name:"Leicestershire"},"GB-0-140":{code:"140",name:"Limavady"},"GB-0-35":{code:"35",name:"Lincolnshire"},"GB-0-141":{code:"141",name:"Lisburn"},"GB-0-142":{code:"142",name:"London"},"GB-0-143":{code:"143",name:"Londonderry"},"GB-0-37":{code:"37",name:"Lothian"},"GB-0-144":{code:"144",name:"Luton"},"GB-0-145":{code:"145",name:"Magherafelt"},"GB-0-39":{code:"39",name:"Merseyside"},"GB-0-38":{code:"38",name:"Mid Glamorgan"},"GB-0-146":{code:"146",name:"Middlesbrough"},"GB-0-65":{code:"65",name:"Middlesex"},"GB-0-147":{code:"147",name:"Midlothian"},"GB-0-148":{code:"148",name:"Milton Keynes"},"GB-0-149":{code:"149",name:"Morayshire"},"GB-0-150":{code:"150",name:"Moyle"},"GB-0-151":{code:"151",name:"Nairn"},"GB-0-152":{code:"152",name:"Newbury"},"GB-0-153":{code:"153",name:"Newry and Mourne"},"GB-0-154":{code:"154",name:"Newtownabbey"},"GB-0-41":{code:"41",name:"Norfolk"},"GB-0-155":{code:"155",name:"North Down"},"GB-0-156":{code:"156",name:"North Humberside"},"GB-0-157":{code:"157",name:"North Lincolnshire"},"GB-0-158":{code:"158",name:"North Somerset"},"GB-0-62":{code:"62",name:"North Yorkshire"},"GB-0-40":{code:"40",name:"Northamptonshire"},"GB-0-43":{code:"43",name:"Northumberland"},"GB-0-159":{code:"159",name:"Nottingham City"},"GB-0-42":{code:"42",name:"Nottinghamshire"},"GB-0-160":{code:"160",name:"NthEast Lincolnshire"},"GB-0-161":{code:"161",name:"Omagh"},"GB-0-162":{code:"162",name:"Orkney"},"GB-0-44":{code:"44",name:"Oxfordshire"},"GB-0-163":{code:"163",name:"Peeblesshire"},"GB-0-164":{code:"164",name:"Perthshire"},"GB-0-165":{code:"165",name:"Peterborough"},"GB-0-166":{code:"166",name:"Plymouth"},"GB-0-167":{code:"167",name:"Poole"},"GB-0-168":{code:"168",name:"Portsmouth"},"GB-0-45":{code:"45",name:"Powys"},"GB-0-169":{code:"169",name:"Reading"},"GB-0-170":{code:"170",name:"Redcar and Cleveland"},"GB-0-171":{code:"171",name:"Renfrewshire"},"GB-0-172":{code:"172",name:"Rochester Up. Medway"},"GB-0-173":{code:"173",name:"Ross-Shire"},"GB-0-175":{code:"175",name:"Roxburghshire"},"GB-0-176":{code:"176",name:"Rutland"},"GB-0-26":{code:"26",name:"Scotland"},"GB-0-177":{code:"177",name:"Shetland"},"GB-0-48":{code:"48",name:"Shropshire"},"GB-0-178":{code:"178",name:"Slough"},"GB-0-50":{code:"50",name:"Somerset"},"GB-0-47":{code:"47",name:"South Glamorgan"},"GB-0-179":{code:"179",name:"South Humberside"},"GB-0-63":{code:"63",name:"South Yorkshire"},"GB-0-180":{code:"180",name:"Southampton"},"GB-0-181":{code:"181",name:"Southend"},"GB-0-51":{code:"51",name:"Staffordshire"},"GB-0-182":{code:"182",name:"Sth. Gloucestershire"},"GB-0-183":{code:"183",name:"Stirlingshire"},"GB-0-184":{code:"184",name:"Stockton-on-Tees"},"GB-0-185":{code:"185",name:"Strabane"},"GB-0-46":{code:"46",name:"Strathclyde"},"GB-0-49":{code:"49",name:"Suffolk"},"GB-0-53":{code:"53",name:"Surrey"},"GB-0-52":{code:"52",name:"Sussex"},"GB-0-186":{code:"186",name:"Sutherland"},"GB-0-54":{code:"54",name:"Tayside"},"GB-0-187":{code:"187",name:"Thamesdown"},"GB-0-188":{code:"188",name:"Thurrock"},"GB-0-189":{code:"189",name:"Torbay"},"GB-0-55":{code:"55",name:"Tyne and Wear"},"GB-0-190":{code:"190",name:"Tyrone"},"GB-0-191":{code:"191",name:"Warrington"},"GB-0-56":{code:"56",name:"Warwickshire"},"GB-0-57":{code:"57",name:"West Glamorgan"},"GB-0-192":{code:"192",name:"West Lothian"},"GB-0-59":{code:"59",name:"West Midlands"},"GB-0-193":{code:"193",name:"West Sussex"},"GB-0-64":{code:"64",name:"West Yorkshire"},"GB-0-194":{code:"194",name:"Western Isles"},"GB-0-195":{code:"195",name:"Wigtownshire"},"GB-0-58":{code:"58",name:"Wiltshire"},"GB-0-196":{code:"196",name:"Windsor & Maidenhead"},"GB-0-197":{code:"197",name:"Wokingham"},"GB-0-60":{code:"60",name:"Worcestershire"},"GB-0-198":{code:"198",name:"Wrekin"},"GB-0-199":{code:"199",name:"York"},"GB-0-61":{code:"61",name:"Yorkshire"},"GB-0-1001":{code:"1001",name:"Blaenau Gwent"},"GB-0-1002":{code:"1002",name:"Bridgend"},"GB-0-1003":{code:"1003",name:"Caerphilly"},"GB-0-1004":{code:"1004",name:"Cardiff"},"GB-0-1005":{code:"1005",name:"Carmarthenshire"},"GB-0-1006":{code:"1006",name:"Ceredigion"},"GB-0-1007":{code:"1007",name:"Channel Islands"},"GB-0-1008":{code:"1008",name:"Conwy"},"GB-0-1009":{code:"1009",name:"Denbighshire"},"GB-0-1010":{code:"1010",name:"East Ayrshire"},"GB-0-1011":{code:"1011",name:"East Dunbartonshire"},"GB-0-1012":{code:"1012",name:"East Renfrewshire"},"GB-0-1013":{code:"1013",name:"Edinburgh City"},"GB-0-1014":{code:"1014",name:"Falkirk"},"GB-0-1015":{code:"1015",name:"Flintshire"},"GB-0-1016":{code:"1016",name:"Glasgow"},"GB-0-1017":{code:"1017",name:"Inverclyde"},"GB-0-1018":{code:"1018",name:"Isle of Anglesey"},"GB-0-1019":{code:"1019",name:"Isle of Man"},"GB-0-1020":{code:"1020",name:"Merthyr Tydfil"},"GB-0-1021":{code:"1021",name:"Monmouthshire"},"GB-0-1022":{code:"1022",name:"Moray"},"GB-0-1023":{code:"1023",name:"Neath Port Talbot"},"GB-0-1024":{code:"1024",name:"Newport"},"GB-0-1025":{code:"1025",name:"North Ayrshire"},"GB-0-1026":{code:"1026",name:"North Lanarkshire"},"GB-0-1027":{code:"1027",name:"Pembrokeshire"},"GB-0-1028":{code:"1028",name:"Rhondda Cynon Taff"},"GB-0-1029":{code:"1029",name:"South Ayrshire"},"GB-0-1030":{code:"1030",name:"South Lanarkshire"},"GB-0-1031":{code:"1031",name:"Stirling"},"GB-0-1032":{code:"1032",name:"Swansea"},"GB-0-1033":{code:"1033",name:"The Vale of Glamorgan"},"GB-0-1034":{code:"1034",name:"Torfaen"},"GB-0-1035":{code:"1035",name:"West Dunbartonshire"},"GB-0-1036":{code:"1036",name:"Wrexham"}},[o.Country.US]:{"US-0-AL":{code:"AL",name:"Alabama"},"US-0-AK":{code:"AK",name:"Alaska"},"US-0-AS":{code:"AS",name:"American Samoa"},"US-0-AZ":{code:"AZ",name:"Arizona"},"US-0-AR":{code:"AR",name:"Arkansas"},"US-0-AA":{code:"AA",name:"Armed Forces America"},"US-0-AE":{code:"AE",name:"Armed Forces Europe"},"US-0-AP":{code:"AP",name:"Armed Forces Pacific"},"US-0-CA":{code:"CA",name:"California"},"US-0-CEI":{code:"CEI",name:"Canton & Enderbury Islands"},"US-0-CO":{code:"CO",name:"Colorado"},"US-0-CT":{code:"CT",name:"Connecticut"},"US-0-DC":{code:"DC",name:"District of Columbia"},"US-0-DE":{code:"DE",name:"Delaware"},"US-0-FL":{code:"FL",name:"Florida"},"US-0-GA":{code:"GA",name:"Georgia"},"US-0-GU":{code:"GU",name:"Guam"},"US-0-HI":{code:"HI",name:"Hawaii"},"US-0-IA":{code:"IA",name:"Iowa"},"US-0-ID":{code:"ID",name:"Idaho"},"US-0-IL":{code:"IL",name:"Illinois"},"US-0-IN":{code:"IN",name:"Indiana"},"US-0-KS":{code:"KS",name:"Kansas"},"US-0-KY":{code:"KY",name:"Kentucky"},"US-0-LA":{code:"LA",name:"Louisiana"},"US-0-MA":{code:"MA",name:"Massachusetts"},"US-0-MD":{code:"MD",name:"Maryland"},"US-0-ME":{code:"ME",name:"Maine"},"US-0-MP":{code:"MP",name:"Mariana Islands"},"US-0-MI":{code:"MI",name:"Michigan"},"US-0-MN":{code:"MN",name:"Minnesota"},"US-0-MS":{code:"MS",name:"Mississippi"},"US-0-MO":{code:"MO",name:"Missouri"},"US-0-MT":{code:"MT",name:"Montana"},"US-0-NE":{code:"NE",name:"Nebraska"},"US-0-NV":{code:"NV",name:"Nevada"},"US-0-NH":{code:"NH",name:"New Hampshire"},"US-0-NJ":{code:"NJ",name:"New Jersey"},"US-0-NM":{code:"NM",name:"New Mexico"},"US-0-NY":{code:"NY",name:"New York"},"US-0-NC":{code:"NC",name:"North Carolina"},"US-0-ND":{code:"ND",name:"North Dakota"},"US-0-NMI":{code:"NMI",name:"North Mariana Islands"},"US-0-OH":{code:"OH",name:"Ohio"},"US-0-OK":{code:"OK",name:"Oklahoma"},"US-0-OR":{code:"OR",name:"Oregon"},"US-0-PW":{code:"PW",name:"Palau"},"US-0-PA":{code:"PA",name:"Pennsylvania"},"US-0-PR":{code:"PR",name:"Puerto Rico"},"US-0-RI":{code:"RI",name:"Rhode Island"},"US-0-SC":{code:"SC",name:"South Carolina"},"US-0-SD":{code:"SD",name:"South Dakota"},"US-0-TN":{code:"TN",name:"Tennessee"},"US-0-TX":{code:"TX",name:"Texas"},"US-0-UT":{code:"UT",name:"Utah"},"US-0-VT":{code:"VT",name:"Vermont"},"US-0-VI":{code:"VI",name:"Virgin Islands, US"},"US-0-VA":{code:"VA",name:"Virginia"},"US-0-WA":{code:"WA",name:"Washington"},"US-0-WV":{code:"WV",name:"West Virginia"},"US-0-WI":{code:"WI",name:"Wisconsin"},"US-0-WY":{code:"WY",name:"Wyoming"}},[o.Country.CA]:{"CA-0-AB":{code:"AB",name:"Alberta"},"CA-0-BC":{code:"BC",name:"British Columbia"},"CA-0-MB":{code:"MB",name:"Manitoba"},"CA-0-NB":{code:"NB",name:"New Brunswick"},"CA-0-NL":{code:"NL",name:"Newfoundland and Labrador"},"CA-0-NS":{code:"NS",name:"Nova Scotia"},"CA-0-NT":{code:"NT",name:"Northwest Territories"},"CA-0-NU":{code:"NU",name:"Nunavut"},"CA-0-ON":{code:"ON",name:"Ontario"},"CA-0-PE":{code:"PE",name:"Prince Edward Island"},"CA-0-QC":{code:"QC",name:"Québec"},"CA-0-SK":{code:"SK",name:"Saskatchewan"},"CA-0-YT":{code:"YT",name:"Yukon"}},[o.Country.AU]:{"AU-0-SA":{code:"SA",name:"South Australia"},"AU-0-WA":{code:"WA",name:"Western Australia"},"AU-0-NSW":{code:"NSW",name:"New South Wales"},"AU-0-QLD":{code:"QLD",name:"Queensland"},"AU-0-TAS":{code:"TAS",name:"Tasmania"},"AU-0-VIC":{code:"VIC",name:"Victoria"},"AU-0-ACT":{code:"ACT",name:"Australian Capital Territory"},"AU-0-JBT":{code:"JBT",name:"Jervis Bay Territory"},"AU-0-NT":{code:"NT",name:"Northern Territory"}},[o.Country.IE]:{"IE-0-05":{code:"05",name:"Carlow"},"IE-0-04":{code:"04",name:"Clare"},"IE-0-03":{code:"03",name:"Cork"},"IE-0-07":{code:"07",name:"Donegal"},"IE-0-06":{code:"06",name:"Dublin"},"IE-0-10":{code:"10",name:"Galway"},"IE-0-13":{code:"13",name:"Cavan"},"IE-0-14":{code:"14",name:"Kerry"},"IE-0-11":{code:"11",name:"Kildare"},"IE-0-12":{code:"12",name:"Kilkenny"},"IE-0-19":{code:"19",name:"Laois"},"IE-0-18":{code:"18",name:"Leitrim"},"IE-0-17":{code:"17",name:"Limerick"},"IE-0-16":{code:"16",name:"Longford"},"IE-0-20":{code:"20",name:"Louth"},"IE-0-23":{code:"23",name:"Mayo"},"IE-0-22":{code:"22",name:"Meath"},"IE-0-21":{code:"21",name:"Monaghan"},"IE-0-24":{code:"24",name:"Offaly"},"IE-0-25":{code:"25",name:"Roscommon"},"IE-0-26":{code:"26",name:"Sligo"},"IE-0-27":{code:"27",name:"Tipperary"},"IE-0-29":{code:"29",name:"Waterford"},"IE-0-31":{code:"31",name:"Westmeath"},"IE-0-32":{code:"32",name:"Wexford"},"IE-0-30":{code:"30",name:"Wicklow"}},[o.Country.ES]:{"ES-0-AN":{code:"AN",name:"Andalucia"},"ES-0-AR":{code:"AR",name:"Aragón"},"ES-0-AS":{code:"AS",name:"Asturias, Principado de"},"ES-0-CN":{code:"CN",name:"Canarias"},"ES-0-CB":{code:"CB",name:"Cantabria"},"ES-0-CM":{code:"CM",name:"Castilla-La Mancha"},"ES-0-CL":{code:"CL",name:"Castilla y León"},"ES-0-CT":{code:"CT",name:"Cataluña"},"ES-0-EX":{code:"EX",name:"Extremadura"},"ES-0-GA":{code:"GA",name:"Galicia"},"ES-0-IB":{code:"IB",name:"Illes Balears"},"ES-0-RI":{code:"RI",name:"La Rioja"},"ES-0-MD":{code:"MD",name:"Madrid, Comunidad de"},"ES-0-MC":{code:"MC",name:"Murcia, Región de"},"ES-0-NC":{code:"NC",name:"Navarra, Comunidad Foral de"},"ES-0-PV":{code:"PV",name:"País Vasco"},"ES-0-VC":{code:"VC",name:"Valenciana, Comunitat"},"ES-0-CE":{code:"CE",name:"Ceuta"},"ES-0-ML":{code:"ML",name:"Melilla"}},[o.Country.MX]:{"MX-0-DIF":{code:"DIF",name:"Distrito Federal"},"MX-0-AGU":{code:"AGU",name:"Aguascalientes"},"MX-0-BCN":{code:"BCN",name:"Baja California"},"MX-0-BCS":{code:"BCS",name:"Baja California Sur"},"MX-0-CAM":{code:"CAM",name:"Campeche"},"MX-0-COA":{code:"COA",name:"Coahuila"},"MX-0-COL":{code:"COL",name:"Colima"},"MX-0-CHP":{code:"CHP",name:"Chiapas"},"MX-0-CHH":{code:"CHH",name:"Chihuahua"},"MX-0-DUR":{code:"DUR",name:"Durango"},"MX-0-GUA":{code:"GUA",name:"Guanajuato"},"MX-0-GRO":{code:"GRO",name:"Guerrero"},"MX-0-HID":{code:"HID",name:"Hidalgo"},"MX-0-JAL":{code:"JAL",name:"Jalisco"},"MX-0-MEX":{code:"MEX",name:"México"},"MX-0-MIC":{code:"MIC",name:"Michoacán"},"MX-0-MOR":{code:"MOR",name:"Morelos"},"MX-0-NAY":{code:"NAY",name:"Nayarit"},"MX-0-NLE":{code:"NLE",name:"Nuevo León"},"MX-0-OAX":{code:"OAX",name:"Oaxaca"},"MX-0-PUE":{code:"PUE",name:"Puebla"},"MX-0-QUE":{code:"QUE",name:"Querétaro"},"MX-0-ROO":{code:"ROO",name:"Quintana Roo"},"MX-0-SLP":{code:"SLP",name:"San Luis Potosí"},"MX-0-SIN":{code:"SIN",name:"Sinaloa"},"MX-0-SON":{code:"SON",name:"Sonora"},"MX-0-TAB":{code:"TAB",name:"Tabasco"},"MX-0-TAM":{code:"TAM",name:"Tamaulipas"},"MX-0-TLA":{code:"TLA",name:"Tlaxcala"},"MX-0-VER":{code:"VER",name:"Veracruz"},"MX-0-YUC":{code:"YUC",name:"Yucatán"},"MX-0-ZAC":{code:"ZAC",name:"Zacatecas"}},[o.Country.CO]:{"CO-0-DC":{code:"DC",name:"Distrito Capital de Bogotá"},"CO-0-AMA":{code:"AMA",name:"Amazonas"},"CO-0-ANT":{code:"ANT",name:"Antioquia"},"CO-0-ARA":{code:"ARA",name:"Arauca"},"CO-0-ATL":{code:"ATL",name:"Atlántico"},"CO-0-BOL":{code:"BOL",name:"Bolívar"},"CO-0-BOY":{code:"BOY",name:"Boyacá"},"CO-0-CAL":{code:"CAL",name:"Caldas"},"CO-0-CAQ":{code:"CAQ",name:"Caquetá"},"CO-0-CAS":{code:"CAS",name:"Casanare"},"CO-0-CAU":{code:"CAU",name:"Cauca"},"CO-0-CES":{code:"CES",name:"Cesar"},"CO-0-COR":{code:"COR",name:"Córdoba"},"CO-0-CUN":{code:"CUN",name:"Cundinamarca"},"CO-0-CHO":{code:"CHO",name:"Chocó"},"CO-0-GUA":{code:"GUA",name:"Guainía"},"CO-0-GUV":{code:"GUV",name:"Guaviare"},"CO-0-HUI":{code:"HUI",name:"Huila"},"CO-0-LAG":{code:"LAG",name:"La Guajira"},"CO-0-MAG":{code:"MAG",name:"Magdalena"},"CO-0-MET":{code:"MET",name:"Meta"},"CO-0-NAR":{code:"NAR",name:"Nariño"},"CO-0-NSA":{code:"NSA",name:"Norte de Santander"},"CO-0-PUT":{code:"PUT",name:"Putumayo"},"CO-0-QUI":{code:"QUI",name:"Quindío"},"CO-0-RIS":{code:"RIS",name:"Risaralda"},"CO-0-SAP":{code:"SAP",name:"San Andrés, Providencia y Santa Catalina"},"CO-0-SAN":{code:"SAN",name:"Santander"},"CO-0-SUC":{code:"SUC",name:"Sucre"},"CO-0-TOL":{code:"TOL",name:"Tolima"},"CO-0-VAC":{code:"VAC",name:"Valle del Cauca"},"CO-0-VAU":{code:"VAU",name:"Vaupés"},"CO-0-VID":{code:"VID",name:"Vichada"}},[o.Country.PE]:{"PE-0-CAL":{code:"CAL",name:"El Callao"},"PE-0-LMA":{code:"LMA",name:"Municipalidad Metropolitana de Lima"},"PE-0-AMA":{code:"AMA",name:"Amazonas"},"PE-0-ANC":{code:"ANC",name:"Ancash"},"PE-0-APU":{code:"APU",name:"Apurímac"},"PE-0-ARE":{code:"ARE",name:"Arequipa"},"PE-0-AYA":{code:"AYA",name:"Ayacucho"},"PE-0-CAJ":{code:"CAJ",name:"Cajamarca"},"PE-0-CUS":{code:"CUS",name:"Cusco"},"PE-0-HUV":{code:"HUV",name:"Huancavelica"},"PE-0-HUC":{code:"HUC",name:"Huánuco"},"PE-0-ICA":{code:"ICA",name:"Ica"},"PE-0-JUN":{code:"JUN",name:"Junín"},"PE-0-LAL":{code:"LAL",name:"La Libertad"},"PE-0-LAM":{code:"LAM",name:"Lambayeque"},"PE-0-LIM":{code:"LIM",name:"Lima"},"PE-0-LOR":{code:"LOR",name:"Loreto"},"PE-0-MDD":{code:"MDD",name:"Madre de Dios"},"PE-0-MOQ":{code:"MOQ",name:"Moquegua"},"PE-0-PAS":{code:"PAS",name:"Pasco"},"PE-0-PIU":{code:"PIU",name:"Piura"},"PE-0-PUN":{code:"PUN",name:"Puno"},"PE-0-SAM":{code:"SAM",name:"San Martín"},"PE-0-TAC":{code:"TAC",name:"Tacna"},"PE-0-TUM":{code:"TUM",name:"Tumbes"},"PE-0-UCA":{code:"UCA",name:"Ucayali"}},[o.Country.CL]:{"CL-0-AI":{code:"AI",name:"Aisén del General Carlos Ibañez del Campo"},"CL-0-AN":{code:"AN",name:"Antofagasta"},"CL-0-AR":{code:"AR",name:"Araucanía"},"CL-0-AP":{code:"AP",name:"Arica y Parinacota"},"CL-0-AT":{code:"AT",name:"Atacama"},"CL-0-BI":{code:"BI",name:"Biobío"},"CL-0-CO":{code:"CO",name:"Coquimbo"},"CL-0-LI":{code:"LI",name:"Libertador General Bernardo O'Higgins"},"CL-0-LL":{code:"LL",name:"Los Lagos"},"CL-0-LR":{code:"LR",name:"Los Ríos"},"CL-0-MA":{code:"MA",name:"Magallanes y la Antártica Chilena"},"CL-0-ML":{code:"ML",name:"Maule"},"CL-0-RM":{code:"RM",name:"Metropolitana de Santiago"},"CL-0-TA":{code:"TA",name:"Tarapacá"},"CL-0-VS":{code:"VS",name:"Valparaíso"}},[o.Country.DE]:{"DE-0-BW":{code:"BW",name:"Baden-Württemberg"},"DE-0-BY":{code:"BY",name:"Bayern"},"DE-0-BE":{code:"BE",name:"Berlin"},"DE-0-BB":{code:"BB",name:"Brandenburg"},"DE-0-HB":{code:"HB",name:"Bremen"},"DE-0-HH":{code:"HH",name:"Hamburg"},"DE-0-HE":{code:"HE",name:"Hessen"},"DE-0-MV":{code:"MV",name:"Mecklenburg-Vorpommern"},"DE-0-NI":{code:"NI",name:"Niedersachsen"},"DE-0-NW":{code:"NW",name:"Nordrhein-Westfalen"},"DE-0-RP":{code:"RP",name:"Rheinland-Pfalz"},"DE-0-SL":{code:"SL",name:"Saarland"},"DE-0-SN":{code:"SN",name:"Sachsen"},"DE-0-ST":{code:"ST",name:"Sachsen-Anhalt"},"DE-0-SH":{code:"SH",name:"Schleswig-Holstein"},"DE-0-TH":{code:"TH",name:"Thüringen"}},[o.Country.IT]:{"IT-0-65":{code:"65",name:"Abruzzo"},"IT-0-77":{code:"77",name:"Basilicata"},"IT-0-78":{code:"78",name:"Calabria"},"IT-0-72":{code:"72",name:"Campania"},"IT-0-45":{code:"45",name:"Emilia-Romagna"},"IT-0-36":{code:"36",name:"Friuli-Venezia Giulia"},"IT-0-62":{code:"62",name:"Lazio"},"IT-0-42":{code:"42",name:"Liguria"},"IT-0-25":{code:"25",name:"Lombardia"},"IT-0-57":{code:"57",name:"Marche"},"IT-0-67":{code:"67",name:"Molise"},"IT-0-21":{code:"21",name:"Piemonte"},"IT-0-75":{code:"75",name:"Puglia"},"IT-0-88":{code:"88",name:"Sardegna"},"IT-0-82":{code:"82",name:"Sicilia"},"IT-0-52":{code:"52",name:"Toscana"},"IT-0-32":{code:"32",name:"Trentino Alto Adige"},"IT-0-55":{code:"55",name:"Umbria"},"IT-0-23":{code:"23",name:"Valle d'Aosta"},"IT-0-34":{code:"34",name:"Veneto"}},[o.Country.CH]:{"CH-0-AG":{code:"AG",name:"Aargau"},"CH-0-AR":{code:"AR",name:"Appenzell Ausserrhoden"},"CH-0-AI":{code:"AI",name:"Appenzell Innerrhoden"},"CH-0-BL":{code:"BL",name:"Basel-Landschaft"},"CH-0-BS":{code:"BS",name:"Basel-Stadt"},"CH-0-BE":{code:"BE",name:"Berne"},"CH-0-FR":{code:"FR",name:"Fribourg"},"CH-0-GE":{code:"GE",name:"Genève"},"CH-0-GL":{code:"GL",name:"Glarus"},"CH-0-GR":{code:"GR",name:"Graubünden"},"CH-0-JU":{code:"JU",name:"Jura"},"CH-0-LU":{code:"LU",name:"Luzern"},"CH-0-NE":{code:"NE",name:"Neuchâtel"},"CH-0-NW":{code:"NW",name:"Nidwalden"},"CH-0-OW":{code:"OW",name:"Obwalden"},"CH-0-SG":{code:"SG",name:"Sankt Gallen"},"CH-0-SH":{code:"SH",name:"Schaffhausen"},"CH-0-SZ":{code:"SZ",name:"Schwyz"},"CH-0-SO":{code:"SO",name:"Solothurn"},"CH-0-TG":{code:"TG",name:"Thurgau"},"CH-0-TI":{code:"TI",name:"Ticino"},"CH-0-UR":{code:"UR",name:"Uri"},"CH-0-VS":{code:"VS",name:"Valais"},"CH-0-VD":{code:"VD",name:"Vaud"},"CH-0-ZG":{code:"ZG",name:"Zug"},"CH-0-ZH":{code:"ZH",name:"Zürich"}},[o.Country.BE]:{"BE-0-BRU":{code:"BRU",name:"Bruxelles-Capitale, Région de"},"BE-0-VLG":{code:"VLG",name:"Vlaamse Gewest"},"BE-0-WAL":{code:"WAL",name:"Région wallonne"}},[o.Country.SE]:{"SE-0-K":{code:"K",name:"Blekinge län"},"SE-0-W":{code:"W",name:"Dalarnas län"},"SE-0-I":{code:"I",name:"Gotlands län"},"SE-0-X":{code:"X",name:"Gävleborgs län"},"SE-0-N":{code:"N",name:"Hallands län"},"SE-0-Z":{code:"Z",name:"Jämtlands län"},"SE-0-F":{code:"F",name:"Jönköpings län"},"SE-0-H":{code:"H",name:"Kalmar län"},"SE-0-G":{code:"G",name:"Kronobergs län"},"SE-0-BD":{code:"BD",name:"Norrbottens län"},"SE-0-M":{code:"M",name:"Skåne län"},"SE-0-AB":{code:"AB",name:"Stockholms län"},"SE-0-D":{code:"D",name:"Södermanlands län"},"SE-0-C":{code:"C",name:"Uppsala län"},"SE-0-S":{code:"S",name:"Värmlands län"},"SE-0-AC":{code:"AC",name:"Västerbottens län"},"SE-0-Y":{code:"Y",name:"Västernorrlands län"},"SE-0-U":{code:"U",name:"Västmanlands län"},"SE-0-O":{code:"O",name:"Västra Götalands län"},"SE-0-T":{code:"T",name:"Örebro län"},"SE-0-E":{code:"E",name:"Östergötlands län"}},[o.Country.NO]:{"NO-0-2":{code:"2",name:"Akershus"},"NO-0-9":{code:"9",name:"Aust-Agder"},"NO-0-6":{code:"6",name:"Buskerud"},"NO-0-20":{code:"20",name:"Finnmark"},"NO-0-4":{code:"4",name:"Hedmark"},"NO-0-12":{code:"12",name:"Hordaland"},"NO-0-15":{code:"15",name:"Møre og Romsdal"},"NO-0-18":{code:"18",name:"Nordland"},"NO-0-17":{code:"17",name:"Nord-Trøndelag"},"NO-0-5":{code:"5",name:"Oppland"},"NO-0-3":{code:"3",name:"Oslo"},"NO-0-11":{code:"11",name:"Rogaland"},"NO-0-14":{code:"14",name:"Sogn og Fjordane"},"NO-0-16":{code:"16",name:"Sør-Trøndelag"},"NO-0-8":{code:"8",name:"Telemark"},"NO-0-19":{code:"19",name:"Troms"},"NO-0-10":{code:"10",name:"Vest-Agder"},"NO-0-7":{code:"7",name:"Vestfold"},"NO-0-1":{code:"1",name:"Østfold"},"NO-0-22":{code:"22",name:"Jan Mayen"},"NO-0-21":{code:"21",name:"Svalbard"}},[o.Country.NL]:{"NL-0-DR":{code:"DR",name:"Drenthe"},"NL-0-FL":{code:"FL",name:"Flevoland"},"NL-0-FR":{code:"FR",name:"Fryslân"},"NL-0-GE":{code:"GE",name:"Gelderland"},"NL-0-GR":{code:"GR",name:"Groningen"},"NL-0-LI":{code:"LI",name:"Limburg"},"NL-0-NB":{code:"NB",name:"Noord-Brabant"},"NL-0-NH":{code:"NH",name:"Noord-Holland"},"NL-0-OV":{code:"OV",name:"Overijssel"},"NL-0-UT":{code:"UT",name:"Utrecht"},"NL-0-ZE":{code:"ZE",name:"Zeeland"},"NL-0-ZH":{code:"ZH",name:"Zuid-Holland"}},[o.Country.PT]:{"PT-0-1":{code:"1",name:"Aveiro"},"PT-0-2":{code:"2",name:"Beja"},"PT-0-3":{code:"3",name:"Braga"},"PT-0-4":{code:"4",name:"Bragança"},"PT-0-5":{code:"5",name:"Castelo Branco"},"PT-0-6":{code:"6",name:"Coimbra"},"PT-0-7":{code:"7",name:"Évora"},"PT-0-8":{code:"8",name:"Faro"},"PT-0-9":{code:"9",name:"Guarda"},"PT-0-10":{code:"10",name:"Leiria"},"PT-0-11":{code:"11",name:"Lisboa"},"PT-0-12":{code:"12",name:"Portalegre"},"PT-0-13":{code:"13",name:"Porto"},"PT-0-14":{code:"14",name:"Santarém"},"PT-0-15":{code:"15",name:"Setúbal"},"PT-0-16":{code:"16",name:"Viana do Castelo"},"PT-0-17":{code:"17",name:"Vila Real"},"PT-0-18":{code:"18",name:"Viseu"},"PT-0-20":{code:"20",name:"Região Autónoma dos Açores"},"PT-0-30":{code:"30",name:"Região Autónoma da Madeira"}}},t.GeographicStatesLevel1={[o.Country.AR]:{"AR-1-C":{code:"C",name:"Ciudad Autónoma de Buenos Aires"},"AR-1-B":{code:"B",name:"Buenos Aires"},"AR-1-K":{code:"K",name:"Catamarca"},"AR-1-H":{code:"H",name:"Chaco"},"AR-1-U":{code:"U",name:"Chubut"},"AR-1-X":{code:"X",name:"Córdoba"},"AR-1-W":{code:"W",name:"Corrientes"},"AR-1-E":{code:"E",name:"Entre Ríos"},"AR-1-P":{code:"P",name:"Formosa"},"AR-1-Y":{code:"Y",name:"Jujuy"},"AR-1-L":{code:"L",name:"La Pampa"},"AR-1-F":{code:"F",name:"La Rioja"},"AR-1-M":{code:"M",name:"Mendoza"},"AR-1-N":{code:"N",name:"Misiones"},"AR-1-Q":{code:"Q",name:"Neuquén"},"AR-1-R":{code:"R",name:"Río Negro"},"AR-1-A":{code:"A",name:"Salta"},"AR-1-J":{code:"J",name:"San Juan"},"AR-1-D":{code:"D",name:"San Luis"},"AR-1-Z":{code:"Z",name:"Santa Cruz"},"AR-1-S":{code:"S",name:"Santa Fe"},"AR-1-G":{code:"G",name:"Santiago del Estero"},"AR-1-V":{code:"V",name:"Tierra del Fuego"},"AR-1-T":{code:"T",name:"Tucumán"}},[o.Country.FR]:{"FR-1-01":{code:"01",name:"Ain"},"FR-1-02":{code:"02",name:"Aisne"},"FR-1-03":{code:"03",name:"Allier"},"FR-1-04":{code:"04",name:"Alpes (Hte-Provence)"},"FR-1-05":{code:"05",name:"Hautes Alpes"},"FR-1-06":{code:"06",name:"Alpes-Maritimes"},"FR-1-07":{code:"07",name:"Ardeche"},"FR-1-08":{code:"08",name:"Ardennes"},"FR-1-09":{code:"09",name:"Ariege"},"FR-1-10":{code:"10",name:"Aube"},"FR-1-11":{code:"11",name:"Aude"},"FR-1-12":{code:"12",name:"Aveyron"},"FR-1-67":{code:"67",name:"Bas-Rhin"},"FR-1-13":{code:"13",name:"Bouches-du-Rhone"},"FR-1-14":{code:"14",name:"Calvados"},"FR-1-15":{code:"15",name:"Cantal"},"FR-1-16":{code:"16",name:"Charente"},"FR-1-17":{code:"17",name:"Charente-Maritime"},"FR-1-18":{code:"18",name:"Cher"},"FR-1-19":{code:"19",name:"Correze"},"FR-1-97":{code:"97",name:"Corse-du-Nord"},"FR-1-20":{code:"20",name:"Corse-du-Sud"},"FR-1-21":{code:"21",name:"Cote-d'Or"},"FR-1-22":{code:"22",name:"Cotes-d'Armor"},"FR-1-23":{code:"23",name:"Creuse"},"FR-1-96":{code:"96",name:"D.O.M. T.O.M"},"FR-1-24":{code:"24",name:"Dordogne"},"FR-1-25":{code:"25",name:"Doubs"},"FR-1-26":{code:"26",name:"Drome"},"FR-1-91":{code:"91",name:"Essonne"},"FR-1-27":{code:"27",name:"Eure"},"FR-1-28":{code:"28",name:"Eure-et-Loir"},"FR-1-29":{code:"29",name:"Finistère"},"FR-1-30":{code:"30",name:"Gard"},"FR-1-31":{code:"31",name:"Haute Garonne"},"FR-1-32":{code:"32",name:"Gers"},"FR-1-33":{code:"33",name:"Gironde"},"FR-1-99":{code:"99",name:"Guyane"},"FR-1-100":{code:"100",name:"Haute-Corse"},"FR-1-68":{code:"68",name:"Haut-Rhin"},"FR-1-92":{code:"92",name:"Hauts-de-Seine"},"FR-1-34":{code:"34",name:"Herault"},"FR-1-35":{code:"35",name:"Ille-et-Vilaine"},"FR-1-36":{code:"36",name:"Indre"},"FR-1-37":{code:"37",name:"Indre-et-Loire"},"FR-1-38":{code:"38",name:"Isere"},"FR-1-39":{code:"39",name:"Jura"},"FR-1-40":{code:"40",name:"Landes"},"FR-1-41":{code:"41",name:"Loir-et-Cher"},"FR-1-42":{code:"42",name:"Loire"},"FR-1-43":{code:"43",name:"Haute Loire"},"FR-1-44":{code:"44",name:"Loire-Atlantique"},"FR-1-45":{code:"45",name:"Loiret"},"FR-1-46":{code:"46",name:"Lot"},"FR-1-47":{code:"47",name:"Lot-et-Garonne"},"FR-1-48":{code:"48",name:"Lozere"},"FR-1-49":{code:"49",name:"Maine-et-Loire"},"FR-1-50":{code:"50",name:"Manche"},"FR-1-51":{code:"51",name:"Marne"},"FR-1-52":{code:"52",name:"Haute Marne"},"FR-1-53":{code:"53",name:"Mayenne"},"FR-1-54":{code:"54",name:"Meurthe-et-Moselle"},"FR-1-55":{code:"55",name:"Meuse"},"FR-1-56":{code:"56",name:"Morbihan"},"FR-1-57":{code:"57",name:"Moselle"},"FR-1-58":{code:"58",name:"Nievre"},"FR-1-59":{code:"59",name:"Nord"},"FR-1-60":{code:"60",name:"Oise"},"FR-1-61":{code:"61",name:"Orne"},"FR-1-75":{code:"75",name:"Paris"},"FR-1-62":{code:"62",name:"Pas-de-Calais"},"FR-1-63":{code:"63",name:"Puy-de-Dôme"},"FR-1-65":{code:"65",name:"Hautes Pyrenees"},"FR-1-64":{code:"64",name:"Pyrenees-Atlantiques"},"FR-1-66":{code:"66",name:"Pyrenees-Orientales"},"FR-1-69":{code:"69",name:"Rhone"},"FR-1-103":{code:"103",name:"Réunion"},"FR-1-70":{code:"70",name:"Haute Saone"},"FR-1-71":{code:"71",name:"Saone-et-Loire"},"FR-1-72":{code:"72",name:"Sarthe"},"FR-1-73":{code:"73",name:"Savoie"},"FR-1-74":{code:"74",name:"Haute Savoie"},"FR-1-76":{code:"76",name:"Seine-Maritime"},"FR-1-93":{code:"93",name:"Seine-Saint-Denis"},"FR-1-77":{code:"77",name:"Seine-et-Marne"},"FR-1-79":{code:"79",name:"Deux Sevres"},"FR-1-80":{code:"80",name:"Somme"},"FR-1-81":{code:"81",name:"Tarn"},"FR-1-82":{code:"82",name:"Tarn-et-Garonne"},"FR-1-90":{code:"90",name:"Territoire-de-Belfort"},"FR-1-95":{code:"95",name:"Val-d'Oise"},"FR-1-94":{code:"94",name:"Val-de-Marne"},"FR-1-83":{code:"83",name:"Var"},"FR-1-84":{code:"84",name:"Vaucluse"},"FR-1-85":{code:"85",name:"Vendee"},"FR-1-86":{code:"86",name:"Vienne"},"FR-1-87":{code:"87",name:"Haute Vienne"},"FR-1-88":{code:"88",name:"Vosges"},"FR-1-89":{code:"89",name:"Yonne"},"FR-1-78":{code:"78",name:"Yvelines"}},[o.Country.ES]:{"ES-1-C":{code:"C",name:"A Coruña"},"ES-1-VI":{code:"VI",name:"Álava"},"ES-1-AB":{code:"AB",name:"Albacete"},"ES-1-A":{code:"A",name:"Alicante"},"ES-1-AL":{code:"AL",name:"Almería"},"ES-1-O":{code:"O",name:"Asturias"},"ES-1-AV":{code:"AV",name:"Ávila"},"ES-1-BA":{code:"BA",name:"Badajoz"},"ES-1-PM":{code:"PM",name:"Illes Balears"},"ES-1-B":{code:"B",name:"Barcelona"},"ES-1-BU":{code:"BU",name:"Burgos"},"ES-1-CC":{code:"CC",name:"Cáceres"},"ES-1-CA":{code:"CA",name:"Cádiz"},"ES-1-S":{code:"S",name:"Cantabria"},"ES-1-CS":{code:"CS",name:"Castellón"},"ES-1-CR":{code:"CR",name:"Ciudad Real"},"ES-1-CO":{code:"CO",name:"Córdoba"},"ES-1-CU":{code:"CU",name:"Cuenca"},"ES-1-GI":{code:"GI",name:"Girona"},"ES-1-GR":{code:"GR",name:"Granada"},"ES-1-GU":{code:"GU",name:"Guadalajara"},"ES-1-SS":{code:"SS",name:"Gipuzkoa"},"ES-1-H":{code:"H",name:"Huelva"},"ES-1-HU":{code:"HU",name:"Huesca"},"ES-1-J":{code:"J",name:"Jaén"},"ES-1-LO":{code:"LO",name:"La Rioja"},"ES-1-GC":{code:"GC",name:"Las Palmas"},"ES-1-LE":{code:"LE",name:"León"},"ES-1-L":{code:"L",name:"Lleida"},"ES-1-LU":{code:"LU",name:"Lugo"},"ES-1-M":{code:"M",name:"Madrid"},"ES-1-MA":{code:"MA",name:"Málaga"},"ES-1-MU":{code:"MU",name:"Murcia"},"ES-1-NA":{code:"NA",name:"Navarra"},"ES-1-OR":{code:"OR",name:"Ourense"},"ES-1-P":{code:"P",name:"Palencia"},"ES-1-PO":{code:"PO",name:"Pontevedra"},"ES-1-SA":{code:"SA",name:"Salamanca"},"ES-1-TF":{code:"TF",name:"Santa Cruz de Tenerife"},"ES-1-SG":{code:"SG",name:"Segovia"},"ES-1-SE":{code:"SE",name:"Sevilla"},"ES-1-SO":{code:"SO",name:"Soria"},"ES-1-T":{code:"T",name:"Tarragona"},"ES-1-TE":{code:"TE",name:"Teruel"},"ES-1-TO":{code:"TO",name:"Toledo"},"ES-1-V":{code:"V",name:"Valencia"},"ES-1-VA":{code:"VA",name:"Valladolid"},"ES-1-BI":{code:"BI",name:"Bizkaia"},"ES-1-ZA":{code:"ZA",name:"Zamora"},"ES-1-Z":{code:"Z",name:"Zaragoza"}},[o.Country.IT]:{"IT-1-AG":{code:"AG",name:"Agrigento"},"IT-1-AL":{code:"AL",name:"Alessandria"},"IT-1-AN":{code:"AN",name:"Ancona"},"IT-1-AO":{code:"AO",name:"Aosta"},"IT-1-AR":{code:"AR",name:"Arezzo"},"IT-1-AP":{code:"AP",name:"Ascoli Piceno"},"IT-1-AT":{code:"AT",name:"Asti"},"IT-1-AV":{code:"AV",name:"Avellino"},"IT-1-BA":{code:"BA",name:"Bari"},"IT-1-BT":{code:"BT",name:"Barletta-Andria-Trani"},"IT-1-BL":{code:"BL",name:"Belluno"},"IT-1-BN":{code:"BN",name:"Benevento"},"IT-1-BG":{code:"BG",name:"Bergamo"},"IT-1-BI":{code:"BI",name:"Biella"},"IT-1-BO":{code:"BO",name:"Bologna"},"IT-1-BZ":{code:"BZ",name:"Bolzano"},"IT-1-BS":{code:"BS",name:"Brescia"},"IT-1-BR":{code:"BR",name:"Brindisi"},"IT-1-CA":{code:"CA",name:"Cagliari"},"IT-1-CL":{code:"CL",name:"Caltanissetta"},"IT-1-CB":{code:"CB",name:"Campobasso"},"IT-1-CI":{code:"CI",name:"Carbonia-Iglesias"},"IT-1-CE":{code:"CE",name:"Caserta"},"IT-1-CT":{code:"CT",name:"Catania"},"IT-1-CZ":{code:"CZ",name:"Catanzaro"},"IT-1-CH":{code:"CH",name:"Chieti"},"IT-1-CO":{code:"CO",name:"Como"},"IT-1-CS":{code:"CS",name:"Cosenza"},"IT-1-CR":{code:"CR",name:"Cremona"},"IT-1-KR":{code:"KR",name:"Crotone"},"IT-1-CN":{code:"CN",name:"Cuneo"},"IT-1-EN":{code:"EN",name:"Enna"},"IT-1-FM":{code:"FM",name:"Fermo"},"IT-1-FE":{code:"FE",name:"Ferrara"},"IT-1-FI":{code:"FI",name:"Firenze"},"IT-1-FG":{code:"FG",name:"Foggia"},"IT-1-FC":{code:"FC",name:"Forlì-Cesena"},"IT-1-FR":{code:"FR",name:"Frosinone"},"IT-1-GE":{code:"GE",name:"Genova"},"IT-1-GO":{code:"GO",name:"Gorizia"},"IT-1-GR":{code:"GR",name:"Grosseto"},"IT-1-IM":{code:"IM",name:"Imperia"},"IT-1-IS":{code:"IS",name:"Isernia"},"IT-1-SP":{code:"SP",name:"La Spezia"},"IT-1-AQ":{code:"AQ",name:"L'Aquila"},"IT-1-LT":{code:"LT",name:"Latina"},"IT-1-LE":{code:"LE",name:"Lecce"},"IT-1-LC":{code:"LC",name:"Lecco"},"IT-1-LI":{code:"LI",name:"Livorno"},"IT-1-LO":{code:"LO",name:"Lodi"},"IT-1-LU":{code:"LU",name:"Lucca"},"IT-1-MC":{code:"MC",name:"Macerata"},"IT-1-MN":{code:"MN",name:"Mantova"},"IT-1-MS":{code:"MS",name:"Massa-Carrara"},"IT-1-MT":{code:"MT",name:"Matera"},"IT-1-VS":{code:"VS",name:"Medio Campidano"},"IT-1-ME":{code:"ME",name:"Messina"},"IT-1-MI":{code:"MI",name:"Milano"},"IT-1-MO":{code:"MO",name:"Modena"},"IT-1-MB":{code:"MB",name:"Monza e Brianza"},"IT-1-NA":{code:"NA",name:"Napoli"},"IT-1-NO":{code:"NO",name:"Novara"},"IT-1-NU":{code:"NU",name:"Nuoro"},"IT-1-OG":{code:"OG",name:"Ogliastra"},"IT-1-OT":{code:"OT",name:"Olbia-Tempio"},"IT-1-OR":{code:"OR",name:"Oristano"},"IT-1-PD":{code:"PD",name:"Padova"},"IT-1-PA":{code:"PA",name:"Palermo"},"IT-1-PR":{code:"PR",name:"Parma"},"IT-1-PV":{code:"PV",name:"Pavia"},"IT-1-PG":{code:"PG",name:"Perugia"},"IT-1-PU":{code:"PU",name:"Pesaro e Urbino"},"IT-1-PE":{code:"PE",name:"Pescara"},"IT-1-PC":{code:"PC",name:"Piacenza"},"IT-1-PI":{code:"PI",name:"Pisa"},"IT-1-PT":{code:"PT",name:"Pistoia"},"IT-1-PN":{code:"PN",name:"Pordenone"},"IT-1-PZ":{code:"PZ",name:"Potenza"},"IT-1-PO":{code:"PO",name:"Prato"},"IT-1-RG":{code:"RG",name:"Ragusa"},"IT-1-RA":{code:"RA",name:"Ravenna"},"IT-1-RC":{code:"RC",name:"Reggio Calabria"},"IT-1-RE":{code:"RE",name:"Reggio Emilia"},"IT-1-RI":{code:"RI",name:"Rieti"},"IT-1-RN":{code:"RN",name:"Rimini"},"IT-1-RM":{code:"RM",name:"Roma"},"IT-1-RO":{code:"RO",name:"Rovigo"},"IT-1-SA":{code:"SA",name:"Salerno"},"IT-1-SS":{code:"SS",name:"Sassari"},"IT-1-SV":{code:"SV",name:"Savona"},"IT-1-SI":{code:"SI",name:"Siena"},"IT-1-SR":{code:"SR",name:"Siracusa"},"IT-1-SO":{code:"SO",name:"Sondrio"},"IT-1-TA":{code:"TA",name:"Taranto"},"IT-1-TE":{code:"TE",name:"Teramo"},"IT-1-TR":{code:"TR",name:"Terni"},"IT-1-TO":{code:"TO",name:"Torino"},"IT-1-TP":{code:"TP",name:"Trapani"},"IT-1-TN":{code:"TN",name:"Trento"},"IT-1-TV":{code:"TV",name:"Treviso"},"IT-1-TS":{code:"TS",name:"Trieste"},"IT-1-UD":{code:"UD",name:"Udine"},"IT-1-VA":{code:"VA",name:"Varese"},"IT-1-VE":{code:"VE",name:"Venezia"},"IT-1-VB":{code:"VB",name:"Verbano-Cusio-Ossola"},"IT-1-VC":{code:"VC",name:"Vercelli"},"IT-1-VR":{code:"VR",name:"Verona"},"IT-1-VV":{code:"VV",name:"Vibo Valentia"},"IT-1-VI":{code:"VI",name:"Vicenza"},"IT-1-VT":{code:"VT",name:"Viterbo"}},[o.Country.BE]:{"BE-1-VAN":{code:"VAN",name:"Antwerpen"},"BE-1-WBR":{code:"WBR",name:"Brabant wallon"},"BE-1-WHT":{code:"WHT",name:"Hainaut"},"BE-1-WLG":{code:"WLG",name:"Liège"},"BE-1-VLI":{code:"VLI",name:"Limburg"},"BE-1-WLX":{code:"WLX",name:"Luxembourg"},"BE-1-WNA":{code:"WNA",name:"Namur"},"BE-1-VOV":{code:"VOV",name:"Oost-Vlaanderen"},"BE-1-VBR":{code:"VBR",name:"Vlaams-Brabant"},"BE-1-VWV":{code:"VWV",name:"West-Vlaanderen"}}}},89690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processQuery=void 0;const o=r(45127),n=r(38495);t.processQuery=function(e){return{type:o.StaticDataQueryType.GEOGRAPHIC_STATES,collection:(0,n.getStatesForLocaleFormats)(e.level,e.localeFormats)}}},38495:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findStateCode=t.findStateLevel2Name=t.findStateName=t.getStatesForLocaleFormats=t.isStateValid=void 0;const o=r(45127),n=r(80814);t.isStateValid=function(e,t){return t in function(e){return{...n.GeographicStatesLevel0[e]||{},...n.GeographicStatesLevel1[e]||{}}}(e)},t.getStatesForLocaleFormats=function(e,t){const r=e===o.GeographicStateLevel.LEVEL_0?n.GeographicStatesLevel0:n.GeographicStatesLevel1;return t?t.filter((e=>!!r[e])).reduce(((e,t)=>Object.assign({},e,{[t]:r[t]})),{}):r};const a=(e,t)=>{let r="";if(!e)return r;const o=Object.keys(t);for(let n=0;n<o.length&&!r;n++)r=t[o[n]]?.[e]?.name??"";return r||e};t.findStateName=e=>a(e,n.GeographicStatesLevel0);t.findStateLevel2Name=e=>a(e,n.GeographicStatesLevel1);t.findStateCode=(e,t)=>n.GeographicStatesLevel0[e]?.[t]?.code??""},74504:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.allowedExtensions=void 0,t.allowedExtensions=[".docx",".doc",".xlsx",".xls",".ppt",".pptx",".pdf",".txt",".zip",".key",".png",".jpg",".jpeg",".gif",".tiff",".bmp",".heif",".heic",".odt",".avi",".ogg",".m4a",".mov",".mp3",".mp4",".mpg",".wav",".ods",".rar",".7z",".mkv",".raw",".db",".aac",".3gp",".webm",".flac",".csv",".wmv",".tar",".odp",".odg",".gzip"]},98337:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSecureDocumentsAllowedMimeTypes=t.getSecureDocumentsAllowedExtensions=void 0;const o=r(74504),n=r(56196);t.getSecureDocumentsAllowedExtensions=function(){return o.allowedExtensions},t.getSecureDocumentsAllowedMimeTypes=function(){return n.allowedMimeTypes}},56196:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.allowedMimeTypes=void 0,t.allowedMimeTypes=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/pdf","text/plain","application/zip","application/x-zip-compressed","multipart/x-zip","application/pkcs8","application/x-iwork-keynote-sffkey","image/png","image/jpeg","image/gif","image/tiff","image/bmp","image/heic","image/heif","image/heic-sequence","image/heif-sequence","application/vnd.oasis.opendocument.text","video/avi","video/msvideo","video/x-msvideo","audio/ogg","video/ogg","video/quicktime","audio/mpeg","audio/mp4","video/mp4","video/mpeg","audio/wav","audio/x-wav","video/x-ms-wmv","application/vnd.oasis.opendocument.spreadsheet","application/x-rar-compressed","application/x-rar","application/vnd.rar","application/x-7z-compressed","video/x-matroska","video/raw","application/x-sqlite3","application/x-ole-storage","audio/aac","audio/x-aac","video/3gpp","audio/webm","video/webm","audio/flac","application/gzip","application/tar","application/x-tar","application/tar+gzip","application/x-compressed-tar","application/x-gzip","application/octet-stream","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.graphics"]},33332:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeStaticDataController=void 0;const o=r(45127),n=r(89690);t.makeStaticDataController=()=>({query:i});class a extends Error{constructor(e){super(`Unexpected StaticDataQuery type (${e})`)}}function i(e){try{return{results:(t=e.queries,t.map((e=>{if(e.type===o.StaticDataQueryType.GEOGRAPHIC_STATES)return(0,n.processQuery)(e);throw new a(e.type)}))),error:null}}catch(e){return{results:[],error:e}}var t}},64765:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(83400);t.bootstrap=e=>{e.register(o.config)}},49183:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(64765);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},92215:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDeviceKeysToUki=t.convertUkiToDeviceKeys=void 0;t.convertUkiToDeviceKeys=e=>{if(e){const t=e.split("-");if(t.length>0){const[r]=t;return{accessKey:r,secretKey:e}}}return null};t.convertDeviceKeysToUki=e=>`${e.accessKey}-${e.secretKey}`},27885:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasSpecialUserGroupAccessInSpace=t.hasTACAccessInCurrentSpace=t.getNodePremiumStatusSpaceData=t.makeSpaceData=t.isGroupManagerInCurrentSpace=t.isTeamAdminInCurrentSpace=t.isBillingAdminInCurrentSpace=t.getCurrentTeamId=t.getCurrentSpaceId=t.getCurrentSpace=void 0;const o=r(66833);t.getCurrentSpace=e=>e.spaces.find((e=>"accepted"===e.details.status));t.getCurrentSpaceId=e=>{const r=(0,t.getCurrentSpace)(e);return r?Number(r.teamId):void 0},t.getCurrentTeamId=t.getCurrentSpaceId;t.isBillingAdminInCurrentSpace=e=>{const r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isBillingAdmin};t.isTeamAdminInCurrentSpace=e=>{const r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isTeamAdmin};function n(e){return{spaces:e}}t.isGroupManagerInCurrentSpace=e=>{const r=(0,t.getCurrentSpace)(e);return!!r&&r.details.isGroupManager},t.makeSpaceData=n;t.getNodePremiumStatusSpaceData=e=>{const t=e.getLocalSettings().nodePremiumStatus?.spaces;return n((0,o.getFreshSpaceData)(t??[]))};t.hasTACAccessInCurrentSpace=e=>{const r=(0,t.getNodePremiumStatusSpaceData)(e),o=(0,t.getCurrentSpace)(r);return!!o&&(o.details.isTeamAdmin||o.details.isBillingAdmin||o.details.isGroupManager)};t.hasSpecialUserGroupAccessInSpace=(e,t)=>{const r=t.spaces.find((t=>t.teamId===e&&"accepted"===t.details.status));return r?.details.isTeamAdmin||r?.details.isGroupManager}},80722:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeStoreService=void 0;const o=r(90599),n=r(18948),a=r(84762);t.makeStoreService=e=>{const t=e?.sessionStorage,r=e?.store||(0,a.createStore)(t),i=((e,t)=>{if(t){let t=()=>{};const r=new Promise((e=>{t=()=>{console.log("[background/carbon] StoreSession init: rehydration from session storage done"),e()}}));console.log("[background/carbon] StoreSession init: session storage enabled");const n=(0,o.persistStore)(e,null,t);return{completeRehydration:()=>r,flush:()=>n.flush()}}return console.log("[background/carbon] StoreSession init: no session storage"),{completeRehydration:()=>Promise.resolve(),flush:()=>Promise.resolve()}})(r,t),s=()=>r.getState(),c=new n.BehaviorSubject(s());return r.subscribe((()=>c.next(s()))),{...i,dispatch:e=>r.dispatch(e),getABTesting:()=>s().device.abtesting,getAccountInfo:()=>s().userSession.account,getAccountCreation:()=>s().userSession.accountCreation,getLocation:()=>s().device.platform.location,getSdkAuthentication:()=>s().userSession.sdkAuthentication,getLocalSettings:()=>s().userSession.localSettings,getPersonalData:()=>s().userSession.personalData,getPersonalSettings:()=>s().userSession.personalSettings,getNotificationStatus:()=>s().userSession.notificationsStatus,getPlatform:()=>s().device.platform,getPlatformInfo:()=>s().device.platform.info,getSharingData:()=>s().userSession.sharingData,getSpaceData:()=>s().userSession.spaceData,getState$:()=>c,getState:()=>s(),getStore:()=>r,getSyncStatus:()=>s().userSession.sync,getTeamAdminData:()=>s().userSession.teamAdminData,getUserLogin:()=>s().userSession.account.login,getUserSession:()=>s().userSession.session,isAuthenticated:()=>Boolean(s().userSession.session.sessionId&&s().userSession.account.isAuthenticated),hasSessionId:()=>Boolean(s().userSession.session.sessionId)}}},68525:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalPersistenceReducer=void 0;const o=r(90599),n=r(33642),a=e=>(t,r)=>({...t,...Object.keys(e).reduce(((o,n)=>(o[n]=t[n],e[n].forEach((e=>{o[n][e]=r[n][e]})),o)),{})}),i=e=>Object.keys(e).map((t=>(0,n.createBlacklistFilter)(t,e[t])));t.getGlobalPersistenceReducer=(e,t,r)=>{if(r){const n={key:"root",stateReconciler:a(t),storage:r,version:1,serialize:!1,deserialize:!1,transforms:i(t)};return(0,o.persistReducer)(n,e)}return e}},84762:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createStore=t.globalReducer=void 0;const o=r(82422),n=r(96186),a=r(9149),i=r(34007),s=r(10319),c=r(52653),d=r(4572),l=r(28417),u=r(53439),p=r(75417),S=r(45316),m=r(69018),g=r(68525),y=r(19764),A=r(73651),f=(0,o.combineReducers)({platform:a.default,abtesting:i.default,application:s.applicationReducer,remoteFile:p.remoteFileReducer,globalExtensionSettings:S.globalExtensionSettingsReducer,antiPhishing:m.AntiPhishingReducer,eventLogger:y.eventLoggerReducer,killswitch:A.killswitchReducer});t.globalReducer=(e,t)=>{const r=e?e.device:void 0,o=e?e.authentication:void 0,a=e?e.userSession:void 0,i=e?e.inMemoryInterSessionUnsynced:void 0;return{device:f(r,t),authentication:(0,c.authenticationReducer)(o,t),userSession:(0,d.userSessionReducer)(a,t),inMemoryInterSessionUnsynced:(0,n.inMemoryInterSessionUnsyncedSliceReducer)(i,t)}},t.createStore=function(e,r){const n=(0,g.getGlobalPersistenceReducer)(t.globalReducer,{device:u.blacklistedDeviceKeys,userSession:l.blacklistedUserSessionKeys},e);return(0,o.createStore)(n,r)}},20031:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(26634),n=r(1334),a=r(26847);t.config={commands:{getTeamInfo:{handler:n.getTeamInfo},computePlanPricing:{handler:a.computePlanPricing}},queries:{getIsRecoveryEnabled:{selector:o.isRecoveryEnabledSelector}},liveQueries:{}}},26847:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.computePlanPricing=void 0;const o=r(45127),n=r(46298),a=r(21712),i=r(16593);t.computePlanPricing=async function(e,t){const{storeService:r}=e,s=(0,i.userLoginSelector)(r.getState());if(!s)throw new Error(o.AuthenticationCode[o.AuthenticationCode.USER_UNAUTHORIZED]);const c=await(0,a.computePlanPricingRequest)(r,s,t.seats);if((0,n.isApiError)(c))return{success:!1,error:{code:o.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed: ${c.message}`}};const{additionalSeats:d,renewal:l}=c;return"string"==typeof d?{success:!1,error:{code:o.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed for additional seat: ${d}`}}:"string"==typeof l?{success:!1,error:{code:o.ComputePlanPricingErrorType.ComputePlanPricingFailed,message:`Compute Plan Pricing failed for renewal: ${l}`}}:{success:!0,data:{additionalSeats:d,renewal:l}}}},1334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamInfo=void 0;const o=r(45127),n=r(46298),a=r(16593);t.getTeamInfo=async function(e){const{storeService:t}=e,r=(0,a.userLoginSelector)(t.getState()),o=await(0,n.teamStatus)(t,r);if((0,n.isApiError)(o))return i(o);const{billing:s,seats:c,info:d,planTier:l,capabilities:u}=o;return{success:!0,data:{billing:s,teamInfo:d,planTier:l,capabilities:u,seats:c}}};const i=e=>e.code===n.NotAdmin?s(o.AuthenticationCode.UNAUTHORIZED,e.message):s(o.AuthenticationCode.UNKNOWN_ERROR,e.message),s=(e,t)=>({success:!1,reason:e,message:t})},89675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTeamSettings=t.makeSettingsController=void 0;const o=r(62433),n=r(34376),a=r(66833);t.makeSettingsController=(e,t)=>({setTeamSettings:r=>c(e,t,(0,n.getCurrentUserInfo)(e),r)});const i=e=>e.replace(/([A-Z])/g,((e,t)=>`_${t.toLowerCase()}`)),s=(e,t)=>null!==t?{type:`set_${i(e)}`,value:t}:{type:`unset_${i(e)}`};function c(e,t,{login:r,uki:n},{teamId:i,settings:c}){const d=(0,o.zipWith)(s,(0,o.keys)(c),(0,o.values)(c));return t.settings.setTeamSettings({login:r,uki:n,teamId:i,operations:d}).then((()=>((0,a.updateCurrentSpaceWith)(e,(e=>Object.assign({},e,{details:Object.assign({},e.details,{info:Object.assign({},e.details.info,c)})}))),{}))).catch((e=>({error:e})))}t.setTeamSettings=c},89763:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(20031);t.bootstrap=e=>{e.register(o.config)}},14581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(89763);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},26634:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPersonalSpaceEnabledSelector=t.isRecoveryEnabledSelector=void 0;const o=r(16593);t.isRecoveryEnabledSelector=e=>{const t=(0,o.activeSpacesSelector)(e)[0];return t?.info?.recoveryEnabled??!1};t.isPersonalSpaceEnabledSelector=e=>{const t=(0,o.activeSpacesSelector)(e)[0];return t?.info?.personalSpaceEnabled??!0}},68541:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(92310),n=r(32159),a=r(31632),i=r(81529),s=r(76934),c=r(38396),d=r(6053),l=r(15028),u=r(69310),p=r(8995),S=r(76713),m=r(5829),g=r(76404),y=r(88063),A=r(94453),f=r(44974),E=r(27218),h=r(70363),v=r(68538),T=r(33150),_=r(94228),I=r(60419),C=r(57520),P=r(71990),D=r(34738),O=r(76154),b=r(70178),w=r(64690),N=r(88436),R=r(16382),M=r(4658),L=r(54419),U=r(11673),k=r(38045),F=r(62218);t.config={commands:{completeTeamDomainRegistration:{handler:a.completeTeamDomainRegistration},deactivateTeamDomain:{handler:i.deactivateTeamDomain},getTeamDomains:{handler:c.getTeamDomains},getTeamDevice:{handler:d.getTeamDevice},listTeamDevices:{handler:l.listTeamDevices},deactivateTeamDevice:{handler:u.deactivateTeamDevice},registerTeamDomain:{handler:s.registerTeamDomain},registerTeamDevice:{handler:p.registerTeamDevice},registerTeamDeviceAccount:{handler:E.registerTeamDeviceAccount},getEncryptionServiceConfig:{handler:g.getEncryptionServiceConfig},generateAndSaveEncryptionServiceConfig:{handler:y.generateAndSaveEncryptionServiceConfig},clearSelfHostedESSettings:{handler:A.clearSelfHostedESSettings},getTeamDeviceEncryptedConfig:{handler:f.getTeamDeviceEncryptedConfig},updateTeamDeviceEncryptedConfig:{handler:h.updateTeamDeviceEncryptedConfig},updateTeamSettings:{handler:b.updateTeamSettings},parseMetadataFields:{handler:v.parseMetadataFieldsHandler},persistAdminProvisioningKey:{handler:T.persistAdminProvisioningKey},removeAdminProvisioningKey:{handler:I.removeAdminProvisioningKey},persistMassDeploymentTeamKey:{handler:P.persistMassDeploymentTeamKey},createSSOConnectorConfig:{handler:S.createSSOConnectorConfig},generateSSOConnectorKey:{handler:m.generateSSOConnectorKey},getRecoveryCodesAsTeamCaptain:{handler:O.getRecoveryCodesAsTeamCaptain},getInviteLink:{handler:w.getInviteLink},requestInviteLinkToken:{handler:F.requestInviteLinkToken},getInviteLinkForAdmin:{handler:N.getInviteLinkForAdmin},changeInviteLinkTeamKey:{handler:R.changeInviteLinkTeamKey},createInviteLink:{handler:M.createInviteLink},toggleInviteLink:{handler:L.toggleInviteLink},getLastADSyncDate:{handler:U.getLastADSyncDate},getSpecialUserGroupInviteValuesForMemberInTeam:{handler:k.getSpecialUserGroupInviteValuesForMemberInTeam},getSpecialUserGroupRevision:{handler:k.getSpecialUserGroupRevision}},queries:{getAdministrableUserGroup:{selector:o.administrableUserGroupSelector},getAdministrableUserGroups:{selector:o.administrableUserGroupsSelector},isGroupNameAvailable:{selector:o.isGroupNameAvailableSelector},getAdminProvisioningKey:{selector:_.adminProvisioningKeySelector},getMassDeploymentTeamKey:{selector:D.massDeploymentTeamKeySelector}},liveQueries:{liveAdministrableUserGroup:{operator:n.administrableUserGroup$},liveAdministrableUserGroups:{operator:n.administrableUserGroups$},liveAdminProvisioningKey:{operator:n.adminProvisioningKey$},liveMassDeploymentTeamKey:{operator:C.massDeploymentTeamKey$}}}},58415:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeDirectorySyncController=void 0;const o=r(7344),n=r(34376);t.makeDirectorySyncController=e=>{const{storeService:t,wsService:r,sessionService:a,sharingService:i}=e;return{directorySyncForAllTeams:()=>o.directorySyncForAllTeams(t,r,a),keyValidatedByTacAdmin:(e,s)=>function(e,t,r,a,i,s){const c=t.getTeamAdminData().teams[i],d=(0,n.getCurrentUserInfo)(t),l=()=>o.saveDirectorySyncKey(e,t,a,d,c,i,s),u=()=>o.directorySyncForTeam(t,r,a,i);return l().then(u).catch((()=>{}))}(i,t,r,a,e,s),keyRejectedByTacAdmin:(e,n)=>o.keyRejectedByTacAdmin(t,r,e,n)}}},44293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTeamDeviceAccount=void 0;const o=r(46298),n=r(16593);t.createTeamDeviceAccount=async(e,t)=>{const{storeService:r}=e,a=r.getState(),i=(0,n.userLoginSelector)(a);if(!i)throw new Error("\n            [createTeamDeviceAccount] - Session not opened!\n        ");const s=await(0,o.createTeamDeviceAccount)(r,i,t);return(0,o.isApiError)(s)?{success:!1,error:{code:(0,o.getCode)(s.code,o.createTeamDeviceAccountErrors)}}:{success:!0,data:{login:s.login}}}},69310:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDevice=void 0;const o=r(46298),n=r(16593);t.deactivateTeamDevice=async function(e,{teamDeviceAccessKey:t}){const{storeService:r}=e,a=r.getState(),i=(0,n.userLoginSelector)(a);if(!i)throw new Error("\n            [registerTeamDeviceRequest] - Session not opened!\n        ");const s=await(0,o.deactivateTeamDevice)(r,i,{teamDeviceAccessKey:t});return(0,o.isApiError)(s)?{success:!1,error:{code:(0,o.getCode)(s.code,o.deactivateTeamDeviceErrors)}}:{success:!0,data:{}}}},6053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDevice=void 0;const o=r(46298),n=r(16593);t.getTeamDevice=async function(e,t){const{storeService:r}=e,{teamDeviceAccessKey:a}=t,i=r.getState(),s=(0,n.userLoginSelector)(i);if(!s)throw new Error("[getTeamDevice] - Session not opened!");const c=await(0,o.getTeamDevice)(r,s,{teamDeviceAccessKey:a});return(0,o.isApiError)(c)?{success:!1,error:{code:(0,o.getCode)(c.code,o.getTeamDeviceErrors)}}:{success:!0,data:{teamDevice:c.teamDevice}}}},15028:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listTeamDevices=void 0;const o=r(46298),n=r(16593);t.listTeamDevices=async function(e){const{storeService:t}=e,r=t.getState(),a=(0,n.userLoginSelector)(r);if(!a)throw new Error("[listTeamDevices] - Session not opened!");const i=await(0,o.listTeamDevices)(t,a);return(0,o.isApiError)(i)?{success:!1,error:{code:(0,o.getCode)(i.code,o.listTeamDevicesErrors)}}:{success:!0,data:{teamDevices:i.teamDevices}}}},8995:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDevice=void 0;const o=r(46298),n=r(16593);t.registerTeamDevice=async function(e,t){const{storeService:r}=e,{deviceName:a,platform:i}=t,s=r.getState(),c=(0,n.userLoginSelector)(s);if(!c)throw new Error("\n            [registerTeamDeviceRequest] - Session not opened!\n        ");const d=await(0,o.registerTeamDevice)(r,c,{platform:i,deviceName:a});return(0,o.isApiError)(d)?{success:!1,error:{code:(0,o.getCode)(d.code,o.registerTeamDeviceErrors)}}:{success:!0,data:{teamUuid:d.teamUuid,deviceAccessKey:d.deviceAccessKey,deviceSecretKey:d.deviceSecretKey}}}},11673:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLastADSyncDate=void 0;const o=r(46298),n=r(16593),a=r(43154);t.getLastADSyncDate=async function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),i={success:!1,error:{code:o.NotAdmin}};if(!r)return i;try{(0,a.requireAdmin)(t)}catch{return i}const s=await(0,o.lastADSyncDate)(t,r);return(0,o.isApiError)(s)?{success:!1,error:{code:(0,o.getCode)(s.code,o.lastADSyncDateErrors)}}:{success:!0,data:{...s}}}},7344:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isDirectorySyncActivated=t.keyRejectedByTacAdmin=t.isSignatureValid=t.buildVerifiedSyncResponseData=t.keyToXMLB64=t.chainOperations=t.batchOperations=t.directorySyncForTeam=t.directorySyncForAllTeams=t.saveDirectorySyncKey=void 0;const o=r(1370),n=r(19478),a=r(48005),i=r(3674),s=r(36513),c=r(95623),d=r(70252),l=r(44197),u=r(78320),p=r(19697),S=r(43927),m=r(56915),g=r(48062),y=r(93513);t.saveDirectorySyncKey=async function(e,t,r,n,a,i,s){return c().catch((function(t){if("Bad Request (ITEM_GROUP_UPDATE_CONFLICT)"===t.message)return function(){const{login:t,uki:r}=n;return(0,S.loadSpecialItemGroup)(e.ws,t,r,a).then(d).then(c).then((()=>{}))}();throw t}));function c(){return async function(){const t=await async function(){const{specialItemGroup:t}=a,{crypto:r}=e,o=await r.symmetricEncryption.generateNewAESKey(),i=await(0,l.getSpecialItemGroupKey)(r,n,a),c={publicKey:s},d=y.encode(JSON.stringify(c)),p=await r.symmetricEncryption.encryptAES256(o,d),S=await r.symmetricEncryption.encryptAES256(i,y.encode(o)),m=(0,u.generateItemUuid)(),g=await e.item.makeItemUpload(m,S,p);return await e.item.makeAddItemsEvent(t.groupId,t.revision,[g])}();return e.item.addItems(e.ws,n.login,n.uki,t)}().then((()=>{r.getInstance().user.attemptSync(g.Trigger.SettingsChange)}))}function d(e){const r=(0,o.specialItemGroupUpdated)(i,e);return t.dispatch(r),Promise.resolve()}},t.directorySyncForAllTeams=function(e,t,r){const o=e.getTeamAdminData();return Object.keys(o.teams).map((o=>h(e,t,r,o)))};class A extends Error{constructor(e=""){super(e),this.name="NoRequestError"}}class f extends Error{constructor(e=""){super(e),this.name="NewPublicKeyError"}}class E extends Error{constructor(e="",t){super(e),this.name="InvalidSignatureError",this.syncResponse=t}}function h(e,t,r,o){const s=(0,i.makeTeamAdminController)(e,t);return function(){const t=e.getState().userSession.directorySync;return(0,a.isTeamDirectorySyncInProgress)(t,o)}()?(c.default.log(`[Directory Sync] Skipping: sync already in progress for team ${o}`),Promise.resolve()):(e.dispatch((0,n.teamDirectorySyncInProgress)(o)),async function(){const r=e.getUserLogin(),n=(0,m.ukiSelector)(e.getState()),a={teamId:Number(o),login:r,uki:n};return await t.teamPlans.getDirectorySyncRequest(a)}().then((async function(e){if(!e.content)throw new A;return e})).then((async function(t){const{publicKey:r,id:n}=t.content,a=e.getTeamAdminData().teams[o].directorySyncKey,i=a&&a.publicKey,s=_(r);if(s!==i){const e={teamId:o,publicKey:s,requestId:n};(0,p.default)().checkDirectorySyncKeyRequest(e);const r=`[Directory Sync] in sync request ${t.content.id} for team ${o}: new public key detected for syncRequest.`;throw c.default.log(r),new f}return t})).then((async function(e){if(!await C(e,o)){const t=`[Directory Sync] in sync request ${e.content.id} for team ${o}: invalid signature.`;c.default.log(t);throw new E(t,e)}return e})).then((async function(t){const n=e.getTeamAdminData().teams[o].userGroups||[],a=t.content.userGroups||[],i=function(e,t){const r=t.map((e=>e.groupId));return e.filter((e=>!!e.externalId)).filter((e=>!r.includes(e.externalId)))}(n,a),c=function(e,t){const r=e.filter((e=>!!e.externalId)).map((e=>e.externalId));return t.filter((e=>!r.includes(e.groupId)))}(n,a),l=function(e,t){const r=e.filter((e=>!!e.externalId)).map((e=>e.externalId));return t.filter((e=>r.includes(e.groupId)))}(n,a),u=i.map((e=>function(e){const t=function(e){const{groupId:t,revision:r}=e;return{groupId:t,revision:r}}(e);return()=>s.deleteUserGroupAction(t)}(e))),p=c.map((e=>function(e){const t=function(e){const t=e.groupName,r=e.groupId;return{teamId:Number(o),externalId:r,name:t}}(e);return()=>s.createUserGroupAction(r,t).then((t=>function(e,t){const r=e.userGroups;if(r.length>0){return g(e.userGroups[0],t)}return Promise.resolve()}(t,e)))}(e))),S=l.map((e=>function(e,t){const r=t.find((t=>t.externalId===e.groupId));if(!r)return[];const o=[];if(e.groupName!==r.name){const t=()=>function(e,t){const r=function(e,t){return{groupId:e.groupId,name:t.groupName,revision:e.revision}}(e,t);return s.renameUserGroupAction(r)}(r,e);o.push(t)}if(function(e,t){const r=e.users.map((e=>e.alias));return t.memberLogins.some((e=>!r.includes(e)))}(r,e)){const t=()=>g(r,e);o.push(t)}if(function(e,t){const r=e.users.map((e=>e.alias));return r.some((e=>!t.memberLogins.includes(e)))}(r,e)){const t=()=>function(e,t){const r=e.users.map((e=>e.alias)),o=r.filter((e=>!t.memberLogins.includes(e))),n={groupId:e.groupId,revision:e.revision,users:o};return s.revokeUserGroupMembersAction(n)}(r,e);o.push(t)}return o}(e,n))).reduce(((e,t)=>e.concat(t)),[]),m=[...u,...p],y=S,A=await T(m),f=await v(y);return[...A,...f].filter((e=>e.error)).map((e=>e.error)).forEach((e=>{const r=`[Directory Sync] in sync request ${t.content.id} for team ${o}: an operation on groups failed: ${e}`,n=new Error(r);(0,d.sendExceptionLog)({error:n})})),t})).then((async function(e){return l(),u(e).then((()=>{}))})).catch((async function(e){switch(l(),e.name){case"NoRequestError":case"NewPublicKeyError":break;case"InvalidSignatureError":{const t=e,{syncResponse:r}=t;u(r,"invalid_signature").then((()=>{}));break}default:{const t=new Error(`[Directory Sync] unexpected error for team ${o}: ${e}`);(0,d.sendExceptionLog)({error:t})}}})));function l(){e.dispatch((0,n.teamDirectorySyncNotInProgress)(o))}function u(r,n){const{content:{id:a}}=r,i=e.getUserLogin(),s=(0,m.ukiSelector)(e.getState()),c={teamId:Number(o),login:i,uki:s,requestId:a},d=Object.assign({},c,n?{syncError:n}:{});return t.teamPlans.updateDirectorySyncRequestStatus(d)}function S(e){return{alias:e,permission:"limited"}}function g(e,t){const r=e.users.map((e=>e.alias)),n=t.memberLogins.filter((e=>!r.includes(e))),a={groupId:e.groupId,revision:e.revision,users:n.map(S),teamId:Number(o)};return s.inviteUserGroupMembersAction(a,!0)}}function v(e){const t=e.map((e=>e().then((e=>({success:!0,result:e}))).catch((e=>({success:!1,error:e})))));return Promise.all(t)}async function T(e,t=[]){const[r,...o]=e;if(!r)return t;let n;try{n={success:!0,result:await r()}}catch(e){n={success:!1,error:e}}return T(o,[...t,n])}function _({modulus:e,exponent:t}){const r=`<RSAKeyValue><Modulus>${e}</Modulus><Exponent>${t}</Exponent></RSAKeyValue>`;return y.encode(r)}function I(e,t,r){return e+t.sort((function(e,t){if(e.groupId<t.groupId)return-1;if(e.groupId>t.groupId)return 1;return 0})).map(r?function(e){const t=e.memberLogins.sort(o);return e.groupId+e.groupName+t.join("")}:function(e){const t=e.memberLogins.sort();return e.groupId+e.groupName+t.join("")}).join("");function o(e,t){const r=n(e),o=n(t);return r<o?-1:r>o?1:function(e,t){if(e.length<t.length)return-1;if(e.length>t.length)return 1;const r=e.split("-").length-1,o=t.split("-").length-1;if(r<o)return-1;if(r>o)return 1;return 0}(e,t)}function n(e){let t=e.replace(/[-']/g,"");return t=t.replace(/\./g,"$"),t=t.replace(/@/g,"%"),t=t.replace(/_/g,"'"),t}}async function C(e,t){const{content:{signature:r,userGroups:o,publicKey:n}}=e,a=async e=>{const a=I(t,o,e),i=y.encode(a),c=(0,s.makeAsymmetricEncryption)();return await c.verifyJwk(n,r,i)},i=await a(!1);return i||a(!0)}t.directorySyncForTeam=h,t.batchOperations=v,t.chainOperations=T,t.keyToXMLB64=_,t.buildVerifiedSyncResponseData=I,t.isSignatureValid=C,t.keyRejectedByTacAdmin=function(e,t,r,o){const n=e.getUserLogin(),a=(0,m.ukiSelector)(e.getState()),i={teamId:Number(r),login:n,uki:a,requestId:o,syncError:"key_rejected"};return t.teamPlans.updateDirectorySyncRequestStatus(i).then((()=>{}))},t.isDirectorySyncActivated=function(e){const t=e.spaces.find((e=>e.details&&e.details.info&&"accepted"===e.details.status));if(!t)return!1;const r=t.details.info.activeDirectorySyncType;return["full","provision-only"].includes(r)}},31632:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeTeamDomainRegistration=void 0;const o=r(46298),n=r(16593);t.completeTeamDomainRegistration=async function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),a=await(0,o.completeDomainRegistration)(t,r);return(0,o.isApiError)(a)?{success:!1,error:{code:(0,o.getCode)(a.code,o.completeDomainRegistrationErrors)}}:{success:!0,domains:a.domain.map((e=>({name:e.domain,status:e.status})))}}},81529:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deactivateTeamDomain=void 0;const o=r(46298),n=r(16593);t.deactivateTeamDomain=async function(e,t){const{storeService:r}=e,a=(0,n.userLoginSelector)(r.getState()),i=await(0,o.deactivateDomain)(r,a,t);return(0,o.isApiError)(i)?{success:!1,error:{code:(0,o.getCode)(i.code,o.deactivateDomainErrors)}}:{success:!0}}},38396:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDomains=void 0;const o=r(46298),n=r(16593);t.getTeamDomains=async function(e){const{storeService:t}=e,r=(0,n.userLoginSelector)(t.getState()),a=await(0,o.listDomains)(t,r);return(0,o.isApiError)(a)?{success:!1,error:{code:(0,o.getCode)(a.code,o.listDomainErrors)}}:{success:!0,domains:a.domains.map((e=>({id:e.id,name:e.domain,status:e.status,dnsToken:e.dnsToken,lastVerificationAttemptDateUnix:e.lastVerificationAttemptDateUnix})))}}},76934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDomain=void 0;const o=r(46298),n=r(16593);t.registerTeamDomain=async function(e,t){const{storeService:r}=e,a=(0,n.userLoginSelector)(r.getState()),i=await(0,o.requestDomainRegistration)(r,a,t);return(0,o.isApiError)(i)?{success:!1,error:{code:(0,o.getCode)(i.code,o.requestDomainRegistrationErrors)}}:{success:!0,data:{computedToken:i.computedToken,challengeDomain:i.challengeDomain}}}},12927:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearEncryptionServiceConfig=void 0;const o=r(94150);t.clearEncryptionServiceConfig=async e=>(await(0,o.removeTeamAdminItem)(e,"encryptionServiceData"),!0)},33657:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAzureEncryptionServiceConfig=t.createAwsLinuxEncryptionServiceConfig=void 0;t.createAwsLinuxEncryptionServiceConfig=({configEncryptionKey:e,deviceSecretKey:t,deviceAccessKey:r,teamUuid:o})=>`DASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY=${r}\nDASHLANE_SSO_TEAM_DEVICE_SECRET_KEY=${t}\nDASHLANE_SSO_TEAM_UUID=${o}\nDASHLANE_CONFIG_ENCRYPTION_KEY=${e}\n`;t.createAzureEncryptionServiceConfig=({configEncryptionKey:e,deviceSecretKey:t,deviceAccessKey:r,teamUuid:o,encryptionServiceEndpoint:n})=>{const{host:a}=new URL(n);return`{\n      "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",\n      "contentVersion": "1.0.0.0",\n      "parameters": {\n        "siteName": {\n          "value": "${a.split(".").slice(0,-2).join(".")}"\n        },\n        "servicePlanSku": {\n          "value": "B1"\n        },\n        "servicePlanCapacity": {\n          "value": 1\n        },\n        "location": {\n          "value": "[resourceGroup().location]"\n        },\n        "DASHLANE_CONFIG_ENCRYPTION_KEY": {\n          "value": "${e}"\n        },\n        "DASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY": {\n          "value": "${r}"\n        },\n        "DASHLANE_SSO_TEAM_DEVICE_SECRET_KEY": {\n          "value": "${t}"\n        },\n        "DASHLANE_SSO_TEAM_UUID": {\n          "value": "${o}"\n        }\n      }\n    }\n    `}},88063:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateAndSaveEncryptionServiceConfig=void 0;const o=r(16038),n=r(69530),a=r(46298),i=r(43154),s=r(33657),c=r(76404),d=r(5760),l=r(27218),u=r(35088),p=r(70363),S=r(66986),m=r(70178),g=r(28096),y=async(e,t,r,a={},i)=>{const{deviceSecretKey:c,deviceAccessKey:y,teamUuid:A}=await(0,l.reregisterTeamDevice)(e,i),{devicePrivateKey:f,devicePublicKey:E}=await(0,l.generateDeviceKeyPair)(e),h=await(0,l.registerTeamDeviceAccount)(e,{deviceAccessKey:y,devicePublicKey:E,devicePrivateKey:f});if(!1===h.success)return{success:!1,error:h.error};await(0,m.updateTeamSettings)(e,{ssoSolution:"self-hosted-saml",provisioningSolution:"self-hosted-scim"}),(0,g.triggerSsoSolutionChanged)("self-hosted-saml");const{encryptionKeyUuid:v,key:T}=await(async()=>{const e=await(0,n.generate64BytesKey)(),t=(0,o.bufferToBase64)(e);return{encryptionKeyUuid:(0,u.v4)().toLowerCase(),key:t}})(),_={config:("Microsoft Azure"===t?s.createAzureEncryptionServiceConfig:s.createAwsLinuxEncryptionServiceConfig)({deviceSecretKey:c,deviceAccessKey:y,teamUuid:A,configEncryptionKey:`${v}|${T}`,encryptionServiceEndpoint:r}),configEncryptionKey:T,teamUuid:A,deviceAccessKey:y,deviceSecretKey:c,encryptionKeyUuid:v,deploymentLocation:t,devicePublicKey:E,devicePrivateKey:f,lastGeneratedTimeStamp:(0,S.getUnixTime)(Date.now())},I=await(0,p.updateTeamDeviceEncryptedConfig)(e,{teamDeviceUrl:r,...a},_);if(!1===I.success)return{success:!1,error:I.error};const C=await(0,d.persistEncryptionServiceConfig)(e,_);return!1===C.success?{success:!1,error:C.error}:{success:!0,data:{basicConfig:{..._},encryptionServiceReloadingStatus:I.data.encryptionServiceReloadingStatus}}},A=["AWS","Microsoft Azure"];t.generateAndSaveEncryptionServiceConfig=async function(e,{deploymentLocation:t,encryptionServiceEndpoint:r,updateTeamDeviceConfigParams:o={}}){const{storeService:n}=e;if((0,i.requireAdmin)(n),!A.includes(t))return{success:!1,error:{code:a.InvalidRequestError}};const s=await(0,c.getEncryptionServiceConfig)(e);let d;return d=s.success?await y(e,t,r,o,s.data):await y(e,t,r,o),d}},76404:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEncryptionServiceConfig=void 0;const o=r(46298),n=r(92310),a=r(43154);t.getEncryptionServiceConfig=({storeService:e})=>{(0,a.requireAdmin)(e);try{const t=(0,n.currentTeamIdSelector)(e.getState()),r=(0,n.adminDataForTeamSelector)(e.getState(),t);return r?.encryptionServiceData?.basicConfigs?.[0]?Promise.resolve({success:!0,data:r.encryptionServiceData.basicConfigs[0]}):Promise.resolve({success:!1,error:{code:o.BasicConfigNotFound}})}catch{return Promise.resolve({success:!1,error:{code:o.UnknownError}})}}},5760:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistEncryptionServiceConfig=t.saveOrUpdateEncryptionServiceConfig=void 0;const o=r(18948),n=r(88744),a=r(66638),i=r(46298),s=r(34376),c=r(97124),d=r(53050),l=r(44197),u=r(92310),p=r(43154),S=r(48062),m=/[\dA-F]{8}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{4}-[\dA-F]{12}/i;t.saveOrUpdateEncryptionServiceConfig=async(e,t)=>{if((({teamUuid:e,encryptionKeyUuid:t,deviceAccessKey:r,deviceSecretKey:o})=>{const n={teamUuid:Boolean(e&&!e.match(m)),encryptionKeyUuid:Boolean(t&&!t.match(m)),deviceAccessKey:Boolean(r&&16!==r.length),deviceSecretKey:Boolean(o&&64!==o.length)},a=Object.entries(n).reduce(((e,[t,r])=>r?{[t]:!0,...e}:e),{});return Object.keys(a).length>0?a:null})(t))return null;const{storeService:r,wsService:i}=e,p=(0,c.makeSharingService)(r,i),g=(0,s.getCurrentUserInfo)(r),y=(0,u.currentTeamIdSelector)(r.getState()),A=(0,u.adminDataForTeamSelector)(r.getState(),y);if(!A)throw new Error("Cannot find adminData");const f=A?.encryptionServiceData?.basicConfigs?.[0];return f?await(async(e,t,r,i,s,c)=>{const{storeService:d,sessionService:u,applicationModulesAccess:p}=e,{crypto:m,item:g,ws:y}=t,{specialItemGroup:A}=i;if(!A)throw new Error("Cannot find specialItemGroup in adminData");const{specialItemGroup:{items:f},encryptionServiceData:E}=i,{itemId:h}=E;let v;const{userFeatureFlip:T}=p.createClients().featureFlips.queries,_=await(0,o.firstValueFrom)(T({featureFlip:n.SharingSyncFeatureFlips.SharingSyncGrapheneMigrationDev}));if((0,a.isSuccess)(_)&&(0,a.getSuccess)(_)){const{getTeamAdminSharingData:e}=p.createClients().sharingSync.queries,t=await(0,o.firstValueFrom)(e());if((0,a.isSuccess)(t)){const{specialItems:e}=(0,a.getSuccess)(t);if(e&&e[h]){const{timestamp:t}=e[h];v=t}}}else{const e=d.getSharingData(),{timestamp:t}=(e.items??[]).find((({itemId:e})=>e===h));v=t}if(!v)throw new Error("trying to update config before it was created.");const I={...c,...s},C={basicConfigs:[I]},P=await(0,l.getSpecialItemGroupKey)(m,r,i),{itemKey:D}=f.find((({itemId:e})=>e===h)),O=await m.symmetricEncryption.decryptAES256(P,D),b=await m.symmetricEncryption.encryptAES256(O,btoa(JSON.stringify(C))),w=await g.makeUpdateItemEvent(v,D,{itemId:h,itemContent:b});if(!(await g.updateItem(y,r.login,r.uki,w)).items.length)throw new Error("unable to update encryption service special item");return await u.getInstance().user.attemptSync(S.Trigger.SettingsChange),I})(e,p,g,A,t,f):await(async(e,t,r)=>{const o={basicConfigs:[r]};return(await(0,d.createOrUpdateSpecialItem)(e,t,o)).basicConfigs[0]})(e,p,t)};t.persistEncryptionServiceConfig=async(e,r)=>{(0,p.requireAdmin)(e.storeService);const o=await(0,t.saveOrUpdateEncryptionServiceConfig)(e,r);return o?{success:!0,data:o}:{success:!1,error:{code:i.UnknownError}}}},27218:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.registerTeamDeviceAccount=t.reregisterTeamDevice=t.generateDeviceKeyPair=void 0;const o=r(45127),n=r(81926),a=r(46298),i=r(97124),s=r(82366),c=r(34376),d=r(44197),l=r(92310),u=r(8995),p=r(69310),S=r(44293),m=r(43927),g=r(92028);t.generateDeviceKeyPair=async e=>{const{storeService:t,wsService:r}=e,{crypto:o}=(0,i.makeSharingService)(t,r),n=await o.asymmetricEncryption.generateRsaKeyPair();return{devicePrivateKey:n.privateKey.replace(g.PRIVATE_KEY_HEADER,"").replace(g.PRIVATE_KEY_FOOTER,"").replace(/[\r\n ]/gm,""),devicePublicKey:n.publicKey.replace(g.PUBLIC_KEY_HEADER,"").replace(g.PUBLIC_KEY_FOOTER,"").replace(/[\r\n ]/gm,"")}};t.reregisterTeamDevice=async(e,t,r=o.TeamDevicePlatform.ENCRYPTION_SERVICE)=>{t?.deviceAccessKey&&await(0,p.deactivateTeamDevice)(e,{teamDeviceAccessKey:t.deviceAccessKey});const n=await(0,u.registerTeamDevice)(e,{platform:r,deviceName:g.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME});if(n.success)return n.data;throw new Error(a.DeviceNotFound)};t.registerTeamDeviceAccount=async(e,r)=>{let o,u;r.shouldGenerateDeviceKeyPair?({devicePublicKey:o,devicePrivateKey:u}=await(0,t.generateDeviceKeyPair)(e)):(o=r.devicePublicKey,u=r.devicePrivateKey);const{storeService:p,wsService:y}=e,{crypto:A}=(0,i.makeSharingService)(p,y),f=(0,c.getCurrentUserInfo)(p),E=(0,l.currentTeamIdSelector)(p.getState()),h=(0,l.adminDataForTeamSelector)(p.getState(),E),{revision:v}=await(0,m.loadSpecialUserGroup)(y,f.login,f.uki,h),T=await(0,d.getSpecialUserGroupKey)(A,f,h),_=`${g.PUBLIC_KEY_HEADER}\n${o}\n${g.PUBLIC_KEY_FOOTER}`,I=await A.asymmetricEncryption.encrypt(_,T),C=`special-admin-${E}-${Math.floor(4294967296*Math.random()).toString(16)}@teamdevice.dashlane.com`;const P=await(0,s.generateProposeSignature)(A,T,C),D=await(0,S.createTeamDeviceAccount)(e,{teamDeviceAccessKey:r.deviceAccessKey,publicKey:o,proposeSignature:P,userGroupRevision:v,groupKey:I,teamDeviceLogin:C});return!1===D.success?{success:!1,error:{code:(0,a.getCode)(D.error.code,n.createTeamDeviceAccountErrors)}}:{success:!0,data:{login:D.data.login,devicePrivateKey:u,devicePublicKey:o}}}},93921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapTeamDeviceEncryptedConfig=t.generateTeamDeviceEncryptedConfig=void 0;const r={scimSignatureKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_SIGNATURE_KEY"},scimAuthToken:{defaultValue:"",configMapping:"DASHLANE_SCIM_AUTHENTICATION_TOKEN"},scimEnabled:{defaultValue:!1,configMapping:"DASHLANE_SCIM_ENABLED"},teamDevicePublicKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_TEAMDEVICE_PUBLIC_KEY"},teamDevicePrivateKey:{defaultValue:"",configMapping:"DASHLANE_SCIM_TEAMDEVICE_PRIVATE_KEY"},connectorEndpoint:{defaultValue:"",configMapping:"DASHLANE_SSO_CONNECTOR_ENDPOINT"},connectorKey:{defaultValue:"",configMapping:"DASHLANE_SSO_CONNECTOR_KEY"},samlIdpCertificate:{defaultValue:"",configMapping:"DASHLANE_SSO_SAML_IDP_CERTIFICATE"},samlIdpEntryPoint:{defaultValue:"",configMapping:"DASHLANE_SSO_SAML_IDP_ENTRYPOINT"}};t.generateTeamDeviceEncryptedConfig=e=>Object.entries(r).map((([t,r])=>{return`${r.configMapping}=${o=r.defaultValue,n=e[t],"boolean"==typeof n||"boolean"==typeof o?n??o?"true":"false":`${n??o}`}`;var o,n})).join("\n");t.mapTeamDeviceEncryptedConfig=e=>{const t=e.split("\n").reduce(((e,t)=>{const r=t.indexOf("="),[o,n]=[t.slice(0,r),t.slice(r+1)];return{...e,[o]:n}}),{}),o=Object.entries(r).reduce(((e,[r,{configMapping:o,defaultValue:n}])=>{return{...e,[r]:(a=n,i=t[o],i?i.length>0&&"boolean"==typeof a?"true"===i:"boolean"==typeof a?a:i??a:a)};var a,i}),{});if((e=>Object.keys(r).every((t=>t in e)))(o))return o;throw new Error("incomplete data when creating object from config string")}},44974:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTeamDeviceEncryptedConfig=t.getParsedTeamDeviceEncryptedConfig=void 0;const o=r(45127),n=r(56668),a=r(46298),i=r(64910),s=r(16593),c=r(43154),d=r(76404),l=r(93921);t.getParsedTeamDeviceEncryptedConfig=async(e,{configEncryptionKey:t,encryptedConfig:r})=>{if(!r||!t)throw new Error("missing config or encryption key");const{teamDeviceEncryptedConfigEncryptorService:o}=e,a=(0,i.getNoDerivationCryptoConfig)();o.setInstance({raw:atob(t)},"",a);const s=await o.getInstance().decrypt(r),c=(0,n.deflatedUtf8ToUtf16)(s,{skipInflate:!0});return(0,l.mapTeamDeviceEncryptedConfig)(c)},t.getTeamDeviceEncryptedConfig=async function(e,{deviceAccessKey:r,draft:n}){const{storeService:i}=e;(0,c.requireAdmin)(i);const l=(0,s.userLoginSelector)(i.getState());if(!l)throw new Error(o.AuthenticationCode[o.AuthenticationCode.USER_UNAUTHORIZED]);const u=await(0,d.getEncryptionServiceConfig)(e);if(!1===u.success)return{success:!1,error:{code:u.error.code===a.BasicConfigNotFound?a.TeamDeviceEncryptedConfigNotFound:a.UnknownError}};const{data:{deviceAccessKey:p,configEncryptionKey:S}}=u,m={configurationVersion:0,deviceAccessKey:r||p,draft:n};try{const o=await(0,a.getTeamDeviceEncryptedConfig)(i,l,m);if((0,a.isApiError)(o))return{success:!1,error:{code:(0,a.getCode)(o.code,a.getTeamDeviceEncryptedConfigErrors)}};const n=await(0,t.getParsedTeamDeviceEncryptedConfig)(e,{encryptedConfig:o.encryptedConfiguration,configEncryptionKey:S});return{success:!0,data:{config:o.encryptedConfiguration,configurationVersion:o.configurationVersion,deviceAccessKey:r,encryptionKeyUuid:o.encryptionKeyUuid,configProperties:n}}}catch(e){return{success:!1,error:{code:a.TeamDeviceEncryptedConfigNotFound}}}}},70363:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamDeviceEncryptedConfig=void 0;const o=r(46298),n=r(56668),a=r(64910),i=r(97124),s=r(34376),c=r(16593),d=r(89675),l=r(92310),u=r(76404),p=r(68538),S=r(5829),m=r(39482),g=r(31708),y=r(94150),A=r(43154),f=r(44974),E=r(93921),h=r(34054),v=r(1334);t.updateTeamDeviceEncryptedConfig=async(e,t={},r)=>{const{storeService:T,teamDeviceEncryptedConfigEncryptorService:_,wsService:I}=e;(0,A.requireAdmin)(T);const C=(0,c.userLoginSelector)(T.getState());if(!C)throw new Error("missing login");const P={ssoEnabled:!1,ssoIdpMetaData:"",ssoEndpoint:""},D=await(0,v.getTeamInfo)(e);D.success&&(P.ssoEnabled=D.data.teamInfo.ssoEnabled,P.ssoIdpMetaData=D.data.teamInfo.ssoIdpMetadata,P.ssoEndpoint=D.data.teamInfo.ssoServiceProviderUrl);const O=parseInt((0,l.currentTeamIdSelector)(T.getState()),10);let b=null,w=null;if(P.ssoIdpMetaData&&({samlIdpCertificate:b,samlIdpEntryPoint:w}=await(0,p.parseMetadataFields)(P.ssoIdpMetaData)),"string"==typeof t.ssoIdpMetadata){const{ssoIdpMetadata:e}=t;if(e)try{({samlIdpCertificate:b,samlIdpEntryPoint:w}=await(0,p.parseMetadataFields)(e))}catch(e){return{success:!1,error:{code:o.UnknownError}}}if((await(0,d.setTeamSettings)(T,I,(0,s.getCurrentUserInfo)(T),{teamId:O,settings:{ssoIdpMetadata:e||null,ssoIdpEntrypoint:w}})).error)return{success:!1,error:{code:o.UnknownError}}}const N=await(0,u.getEncryptionServiceConfig)(e),R=r||(N.success&&N.data.deviceAccessKey&&N.data.configEncryptionKey&&N.data.encryptionKeyUuid&&N.data.devicePrivateKey&&N.data.devicePublicKey?N.data:null);if(!R)return{success:!1,error:{code:o.DeviceKeyNotFound}};const{deviceAccessKey:M,encryptionKeyUuid:L,configEncryptionKey:U,devicePrivateKey:k,devicePublicKey:F}=R,B=L.toLowerCase(),G=await(0,f.getTeamDeviceEncryptedConfig)(e,{draft:!1,deviceAccessKey:M});let K={},V=0;if(!1===G.success&&G.error.code!==o.TeamDeviceEncryptedConfigNotFound)return{success:!1,error:{code:o.UnknownError}};if(!0===G.success){const{data:t}=G;K=await(0,f.getParsedTeamDeviceEncryptedConfig)(e,{encryptedConfig:t.config,configEncryptionKey:U}),V=t.configurationVersion}const j=(0,i.makeSharingService)(T,I),H=(0,l.currentTeamIdSelector)(T.getState()),W=(0,l.adminDataForTeamSelector)(T.getState(),H);let x=W?.ssoConnectorKey?.ssoConnectorKey;if(!x||t.ssoConnectorKey)try{x&&t.ssoConnectorKey&&await(0,y.removeTeamAdminItem)(e,"ssoConnectorKey");const r=t.ssoConnectorKey??await(0,S.generateSSOConnectorKey)();x=await(0,m.persistSSOConnectorKey)(e,j,r)}catch(e){return{success:!1,error:{code:o.UnknownError}}}let z=W?.scimSignatureKey?.scimSignatureKey;if(!z){const t=await(0,h.generateSCIMSignatureKey)();z=await(0,g.persistSCIMSignatureKey)(e,j,t)}const q={scimAuthToken:t?.scimAuthToken??K?.scimAuthToken??"",scimEnabled:t?.scimEnabled??K?.scimEnabled??!1,connectorEndpoint:t?.connectorEndpoint??K?.connectorEndpoint??P.ssoEndpoint??"",samlIdpEntryPoint:w??K?.samlIdpEntryPoint??"",samlIdpCertificate:b??K?.samlIdpCertificate??""},Y=Boolean(t.ssoEnabled||K.connectorKey||P.ssoEnabled),$={...q,teamDevicePrivateKey:k,teamDevicePublicKey:F,connectorKey:Y?x:"",scimSignatureKey:q.scimEnabled?z:""},Q=(0,E.generateTeamDeviceEncryptedConfig)($),X=(0,n.utf16ToDeflatedUtf8)(Q,{skipUtf8Encoding:!0,skipDeflate:!0}),J=(0,a.getNoDerivationCryptoConfig)();_.setInstance({raw:atob(U)},"",J);const Z=_.getInstance(),ee=await Z.encrypt(X),te={configurationVersion:V,deviceAccessKey:M,ssoServiceEnabled:Y,scimServiceEnabled:$.scimEnabled,encryptionKeyUuid:B,draft:!1,encryptedConfiguration:ee,teamDeviceUrl:t.teamDeviceUrl},re=await(0,o.updateTeamDeviceEncryptedConfig)(T,C,te);return(0,o.isApiError)(re)?{success:!1,error:{code:(0,o.getCode)(re.code,o.updateTeamDeviceEncryptedConfigErrors)}}:{success:!0,data:{configurationVersion:re.configurationVersion,encryptionServiceReloadingStatus:re.encryptionServiceReloadingStatus}}}},94228:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adminProvisioningKeySelector=void 0;const o=r(92310);t.adminProvisioningKeySelector=e=>{const t=(0,o.currentTeamIdSelector)(e),r=(0,o.adminDataForTeamSelector)(e,t);return{adminProvisioningKey:r.adminProvisioningKey?.adminProvisioningKey??null}}},33150:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistAdminProvisioningKey=void 0;const o=r(46298),n=r(97124),a=r(53050);t.persistAdminProvisioningKey=async(e,t)=>{const{adminProvisioningKey:r}=t,i=(0,n.makeSharingService)(e.storeService,e.wsService);try{return await(0,a.createOrUpdateSpecialItem)(e,i,{adminProvisioningKey:r})?{success:!0}:{success:!1,error:"failed to persist adminProvisioningKey"}}catch(e){return{success:!1,error:`${e?.message??o.UnknownError}`}}}},60419:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeAdminProvisioningKey=void 0;const o=r(94150);t.removeAdminProvisioningKey=async e=>(await(0,o.removeTeamAdminItem)(e,"adminProvisioningKey"),{success:!0})},94453:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearSelfHostedESSettings=void 0;const o=r(45127),n=r(46298),a=r(34376),i=r(89675),s=r(43154),c=r(69310),d=r(92310),l=r(12927),u=r(76404);t.clearSelfHostedESSettings=async e=>{const{storeService:t,wsService:r}=e;try{(0,s.requireAdmin)(t)}catch(e){if(e.message===o.AuthenticationCode[o.AuthenticationCode.USER_UNAUTHORIZED])return{success:!1,error:{code:n.NotAdmin}}}const p=await(0,u.getEncryptionServiceConfig)(e),S=[];if(p.success){if(p.data.config&&await(0,l.clearEncryptionServiceConfig)(e),p.data.deviceAccessKey){if(!(await(0,c.deactivateTeamDevice)(e,{teamDeviceAccessKey:p.data.deviceAccessKey})).success)return{success:!1,error:{code:n.DeactivatedTeamDevice}}}}else S.push(n.BasicConfigNotFound);const m=parseInt((0,d.currentTeamIdSelector)(t.getState()),10);return(await(0,i.setTeamSettings)(t,r,(0,a.getCurrentUserInfo)(t),{teamId:m,settings:{ssoServiceProviderUrl:null,ssoIdpMetadata:null,ssoIdpEntrypoint:null}})).error?{success:!1,error:{code:n.UnknownError}}:{success:!0,...S?{warnings:S}:{}}}},92028:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PUBLIC_KEY_FOOTER=t.PUBLIC_KEY_HEADER=t.PRIVATE_KEY_FOOTER=t.PRIVATE_KEY_HEADER=t.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME=void 0,t.ENCRYPTION_SERVICE_HUMAN_DEVICE_NAME="Encryption Service",t.PRIVATE_KEY_HEADER="-----BEGIN RSA PRIVATE KEY-----",t.PRIVATE_KEY_FOOTER="-----END RSA PRIVATE KEY-----",t.PUBLIC_KEY_HEADER="-----BEGIN RSA PUBLIC KEY-----",t.PUBLIC_KEY_FOOTER="-----END RSA PUBLIC KEY-----"},43154:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requireAdmin=void 0;const o=r(45127),n=r(27885);t.requireAdmin=e=>{if(!(0,n.hasTACAccessInCurrentSpace)(e))throw new Error(o.AuthenticationCode[o.AuthenticationCode.USER_UNAUTHORIZED])}},34054:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateSCIMSignatureKey=void 0;const o=r(16038),n=r(55623);t.generateSCIMSignatureKey=async()=>{const e=await(0,n.getRandomValues)(32);return(0,o.bufferToBase64)(e)}},31708:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistSCIMSignatureKey=void 0;const o=r(53050);t.persistSCIMSignatureKey=async(e,t,r)=>(await(0,o.createOrUpdateSpecialItem)(e,t,{scimSignatureKey:r})).scimSignatureKey},39482:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistSSOConnectorKey=void 0;const o=r(53050);t.persistSSOConnectorKey=async(e,t,r)=>(await(0,o.createOrUpdateSpecialItem)(e,t,{ssoConnectorKey:r})).ssoConnectorKey},16382:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.changeInviteLinkTeamKey=void 0;const o=r(45127),n=r(46298),a=r(43154),i=r(16593);t.changeInviteLinkTeamKey=async function(e){const{storeService:t}=e;try{const e=(0,i.userLoginSelector)(t.getState()),r={success:!1,error:{code:o.InviteLinkResponseErrorCode.NotAdmin}};try{(0,a.requireAdmin)(t)}catch{return r}if(!e)return r;const s=await(0,n.changeInviteLinkTeamKey)(t,e);return(0,n.isApiError)(s)?{success:!1,error:{code:(0,n.getCode)(s.code,n.getInviteLinkErrors)}}:{success:!0,data:s}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}},4658:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInviteLink=void 0;const o=r(45127),n=r(46298),a=r(43154),i=r(16593);t.createInviteLink=async function(e,t){const{storeService:r}=e;try{const e=(0,i.userLoginSelector)(r.getState()),s={success:!1,error:{code:o.InviteLinkResponseErrorCode.NotAdmin}};try{(0,a.requireAdmin)(r)}catch{return s}if(!e)return s;const c=await(0,n.createInviteLink)(r,e,t);return(0,n.isApiError)(c)?{success:!1,error:{code:(0,n.getCode)(c.code,n.getInviteLinkErrors)}}:{success:!0,data:c}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}},88436:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLinkForAdmin=void 0;const o=r(45127),n=r(46298),a=r(43154),i=r(16593);t.getInviteLinkForAdmin=async function(e){const{storeService:t}=e;try{const e=(0,i.userLoginSelector)(t.getState()),r={success:!1,error:{code:o.InviteLinkResponseErrorCode.NotAdmin}};try{(0,a.requireAdmin)(t)}catch{return r}if(!e)return r;const s=await(0,n.getInviteLinkForAdmin)(t,e);return(0,n.isApiError)(s)?{success:!1,error:{code:(0,n.getCode)(s.code,n.getInviteLinkErrors)}}:{success:!0,data:s}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}},64690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getInviteLink=void 0;const o=r(45127),n=r(46298);t.getInviteLink=async function(e,t){const{storeService:r}=e;try{const e=await(0,n.getInviteLink)(r,t);return(0,n.isApiError)(e)?{success:!1,error:{code:(0,n.getCode)(e.code,n.getInviteLinkErrors)}}:{success:!0,data:e}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}},62218:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestInviteLinkToken=void 0;const o=r(45127),n=r(46298);t.requestInviteLinkToken=async function(e,t){const{storeService:r}=e;try{const e=await(0,n.requestInviteLinkToken)(r,t);return(0,n.isApiError)(e)?{success:!1,error:{code:(0,n.getCode)(e.code,n.getInviteLinkErrors)}}:{success:!0,data:e}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.UserInviteLinkNotFound}}}}},54419:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleInviteLink=void 0;const o=r(45127),n=r(46298),a=r(43154),i=r(16593);t.toggleInviteLink=async function(e,t){const{storeService:r}=e;try{const e=(0,i.userLoginSelector)(r.getState()),s={success:!1,error:{code:o.InviteLinkResponseErrorCode.NotAdmin}};try{(0,a.requireAdmin)(r)}catch{return s}if(!e)return s;const c=await(0,n.toggleInviteLink)(r,e,t);return(0,n.isApiError)(c)?{success:!1,error:{code:(0,n.getCode)(c.code,n.getInviteLinkErrors)}}:{success:!0,data:c}}catch(e){return{success:!1,error:{code:o.InviteLinkResponseErrorCode.InviteLinkNotFound}}}}},55546:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isMassDeploymentTeamKey=void 0;t.isMassDeploymentTeamKey=e=>"massDeploymentTeamAccessKey"in e&&"massDeploymentTeamSecretKey"in e},57520:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(55546),t),n(r(71990),t),n(r(34738),t),n(r(94180),t)},94180:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.massDeploymentTeamKey$=void 0;const o=r(18948),n=r(3343),a=r(34738);t.massDeploymentTeamKey$=()=>(0,o.pipe)((0,n.map)(a.massDeploymentTeamKeySelector),(0,n.distinctUntilChanged)())},71990:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.persistMassDeploymentTeamKey=void 0;const o=r(46298),n=r(97124),a=r(53050);t.persistMassDeploymentTeamKey=async(e,t)=>{const{massDeploymentTeamAccessKey:r,massDeploymentTeamSecretKey:i}=t,s=(0,n.makeSharingService)(e.storeService,e.wsService);try{return await(0,a.createOrUpdateSpecialItem)(e,s,{massDeploymentTeamAccessKey:r,massDeploymentTeamSecretKey:i})?{success:!0}:{success:!1,error:"failed to persist massDeploymentTeamKey credentials"}}catch(e){return{success:!1,error:`${e?.message??o.UnknownError}`}}}},34738:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.massDeploymentTeamKeySelector=void 0;const o=r(92310);t.massDeploymentTeamKeySelector=e=>{const t=(0,o.currentTeamIdSelector)(e),r=(0,o.adminDataForTeamSelector)(e,t);return{massDeploymentTeamAccessKey:r.massDeploymentTeamKey?.massDeploymentTeamAccessKey??null,massDeploymentTeamSecretKey:r.massDeploymentTeamKey?.massDeploymentTeamSecretKey??null}}},23904:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConfigString=void 0;t.createConfigString=(e,t,r,o,n,a,i)=>`\nDASHLANE_SSO_CONNECTOR_ENDPOINT=${t}\nDASHLANE_SSO_SAML_IDP_CERTIFICATE=${a}\nDASHLANE_SSO_SAML_IDP_ENTRYPOINT=${i}\nDASHLANE_SSO_CONNECTOR_KEY=${e}\nDASHLANE_SSO_TEAM_DEVICE_ACCESS_KEY=${o}\nDASHLANE_SSO_TEAM_DEVICE_SECRET_KEY=${r}\nDASHLANE_SSO_TEAM_UUID=${n}\n`},76713:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSSOConnectorConfig=void 0;const o=r(45127),n=r(8995),a=r(23904),i=r(68538),s=r(89675),c=r(34376),d=r(92310);t.createSSOConnectorConfig=async function(e,t){const{connectorUrl:r,connectorKey:l,idpMetadata:u}=t;if(!r||!u)throw new Error(`[createConfig] : Missing request information -\n                Received connectorUrl : ${!!r} or\n                Received idpMetadata: ${!!u}\n            `);const p=await(0,n.registerTeamDevice)(e,{platform:o.TeamDevicePlatform.SSO_CONNECTOR,deviceName:"SSO Connector"});if(!1===p.success)return{success:!1,error:{code:p.error.code}};const S=p.data.deviceSecretKey,m=p.data.deviceAccessKey,g=p.data.teamUuid;try{const{samlIdpCertificate:t,samlIdpEntryPoint:o}=await(0,i.parseMetadataFields)(u),{storeService:n,wsService:p}=e,y=(0,d.currentTeamIdSelector)(n.getState()),A=parseInt(y,10);if(isNaN(A))throw new Error("[createSSOConnectorConfig] : Unable to retrieve teamId from [parseInt(currentTeamIdString, 10)]");await(0,s.setTeamSettings)(n,p,(0,c.getCurrentUserInfo)(n),{teamId:A,settings:{ssoIdpEntrypoint:o}});return{success:!0,config:(0,a.createConfigString)(l||"",r.toLowerCase(),S,m,g,t,o)}}catch(e){return{success:!1,error:{code:e.message}}}}},5829:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateSSOConnectorKey=void 0;const o=r(16038),n=r(69530),a=r(35088);t.generateSSOConnectorKey=async function(){const e=await(0,n.generate64BytesKey)(),t=(0,o.bufferToBase64)(e);return`${(0,a.v4)()}|${t}`}},68538:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseMetadataFieldsHandler=t.parseMetadataFields=t.SamlTags=void 0;const o=r(45127),n=r(44015),a=r(61797);var i;!function(e){e.IDP_SSO_DESCRIPTOR="IDPSSODescriptor",e.KEY_DESCRIPTOR="KeyDescriptor",e.SINGLE_SIGN_ON_SERVICE="SingleSignOnService",e.CERTIFICATE="X509Certificate"}(i=t.SamlTags||(t.SamlTags={}));const s=64,c=4096;function d(e){const t=(0,a.findAllKWXMLElementsOfType)(e,i.IDP_SSO_DESCRIPTOR,[]);if(1!==t.length)throw new Error(o.IDPMetadataParseErrors.INVALID_IDP_SSO_DESCRIPTOR);return t[0]}t.parseMetadataFields=async e=>{const t=e.trim().replace(/[\r\n\t]/gm,""),r=await(l=t,new Promise(((e,t)=>{(0,n.parseXml)(((r,a)=>{r?t(new Error(o.IDPXmlParseErrors.XML_PARSE_FAILED)):(0,n.isKWXMLElement)(a)?e(a):t(new Error(o.IDPXmlParseErrors.XML_PARSE_FAILED))}),l)})));var l;return{samlIdpCertificate:function(e){const t=(0,a.findAllKWXMLElementsOfType)(d(e),i.KEY_DESCRIPTOR,[]).filter((e=>!e.__attributes__?.use||"signing"===e.__attributes__?.use));if(!t.length)throw new Error(o.IDPMetadataParseErrors.KEY_DESCRIPTOR_NOT_FOUND);const r=[];if(t.forEach((e=>(0,a.findAllKWXMLElementsOfType)(e,i.CERTIFICATE,r))),!r.length)throw new Error(o.IDPMetadataParseErrors.MISSING_CERTIFICATE);if(r.length>1)throw new Error(o.IDPMetadataParseErrors.MULTIPLE_CERTIFICATES);const n=r[0].__value__;if(!n?.length)throw new Error(o.IDPMetadataParseErrors.MISSING_CERTIFICATE);if(n.length<s)throw new Error(o.IDPMetadataParseErrors.CERTIFICATE_TOO_SHORT);if(n.length>c)throw new Error(o.IDPMetadataParseErrors.CERTIFICATE_TOO_LONG);try{atob(n)}catch{throw new Error(o.IDPMetadataParseErrors.CERTIFICATE_DECODE_FAILED)}return n}(r),samlIdpEntryPoint:function(e){const t=d(e).__children__.filter((e=>{if((0,n.isKWXMLElement)(e))return(0,a.removeNamespace)(e.__type__)===i.SINGLE_SIGN_ON_SERVICE})).find((e=>{if((0,n.isKWXMLElement)(e)){const t=e.__attributes__.Binding;if("string"==typeof t)return t.includes("HTTP-POST")}}));if(!t)throw new Error(o.IDPMetadataParseErrors.IDP_ENTRYPOINT_NOT_FOUND);if((0,n.isKWXMLElement)(t)){const e=t.__attributes__.Location;if("string"==typeof e)return e;throw new Error(o.IDPMetadataParseErrors.INVALID_ENTRYPOINT)}throw new Error(o.IDPMetadataParseErrors.INVALID_ENTRYPOINT)}(r)}};t.parseMetadataFieldsHandler=async(e,{ssoIdpMetadata:r})=>{try{const{samlIdpCertificate:e,samlIdpEntryPoint:o}=await(0,t.parseMetadataFields)(r);return{success:!0,data:{samlIdpCertificate:e,samlIdpEntryPoint:o}}}catch(e){const t=Object.values(o.IDPXmlParseErrors),r=Object.values(o.IDPMetadataParseErrors);return{success:!1,error:t.concat(r).includes(e.message)?e.message:o.IDPXmlParseErrors.XML_PARSE_FAILED}}}},70178:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTeamSettings=void 0;const o=r(34376),n=r(27885),a=r(89675);t.updateTeamSettings=async(e,t)=>{const r=(0,n.getCurrentSpaceId)(e.storeService.getSpaceData()),i=await(0,a.setTeamSettings)(e.storeService,e.wsService,(0,o.getCurrentUserInfo)(e.storeService),{teamId:r,settings:t});return i.error?{success:!1,error:i.error.message}:{success:!0}}},38045:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpecialUserGroupRevision=t.getSpecialUserGroupInviteValuesForMemberInTeam=t.removeTeamAdmin=t.addTeamAdmin=t.proposeMembers=t.getMembers=void 0;r(62433);const o=r(34376),n=r(36513),a=r(44197),i=r(43927),s=r(97124),c=r(95375),d=r(46298),l=e=>{const t="accepted"===e.status&&Object.keys(e).includes("nbrPasswords");return{...e,isBillingAdmin:t&&e.isBillingAdmin,isTeamCaptain:t&&e.isTeamCaptain,isGroupManager:t&&e.isGroupManager,hasPublicKey:t&&e.hasPublicKey,accountRecoveryKeyStatus:t?e.accountRecoveryKeyStatus:"disabled",compromisedPasswords:(t&&e.compromisedPasswords)??0,securityIndex:t&&e.securityIndex,nbrPasswords:t&&e.nbrPasswords,..."pending"===e.status&&e.lastUpdateDateUnix?{}:{lastUpdateDateUnix:e.lastUpdateDateUnix}}};t.getMembers=async function(e,t,{teamId:r}){const o=await(0,c.getTeamMembers)(e,t,{teamId:r,orderBy:"login",limit:0});if((0,d.isApiError)(o)){return{success:!1,error:new Error(o.message)}}return{success:!0,members:o.members.map(l)}},t.proposeMembers=async function(e,{login:t,uki:r},{proposedMemberLogins:o,teamId:n,origin:a,notificationOptions:i={skipAccountCreationRequiredAlerts:!1}}){const{content:s}=await e.teamPlans.proposeMembers({login:t,uki:r,teamId:n,proposedMemberLogins:o,force:!0,origin:a,notificationOptions:i});return s},t.addTeamAdmin=async function(e,{teamId:t,memberLogin:r}){const{ws:s,store:c}=e,d=(0,o.getCurrentUserInfo)(c),l=c.getTeamAdminData(),u=(0,a.getAdminDataFromTeamAdminData)(l,String(t)),{revision:p}=await(0,i.loadSpecialUserGroup)(s,d.login,d.uki,u),{groupKey:S,proposeSignature:m}=await(0,a.makeInviteToSpecialUserGroup)(e,(0,n.makeCryptoService)(),d,l,{teamId:t,memberLogin:r});return await e.ws.teamPlans.addTeamAdmin({login:d.login,uki:d.uki,teamId:t,memberLogin:r,memberAlias:r,groupKey:S,proposeSignature:m,userGroupRevision:p}),{}},t.removeTeamAdmin=async function(e,{teamId:t,memberLogin:r}){const{ws:n,store:s}=e,c=(0,o.getCurrentUserInfo)(s),d=s.getTeamAdminData(),l=(0,a.getAdminDataFromTeamAdminData)(d,String(t)),{revision:u}=await(0,i.loadSpecialUserGroup)(n,c.login,c.uki,l);return await n.teamPlans.removeTeamAdmin({login:c.login,uki:c.uki,teamId:t,memberLogin:r,userGroupRevision:u}),{}},t.getSpecialUserGroupInviteValuesForMemberInTeam=async function(e,{teamId:t,memberLogin:r}){const{wsService:i,storeService:c}=e,d=(0,s.makeSharingService)(c,i),l=(0,o.getCurrentUserInfo)(c),u=c.getTeamAdminData(),{groupKey:p,proposeSignature:S}=await(0,a.makeInviteToSpecialUserGroup)(d,(0,n.makeCryptoService)(),l,u,{teamId:t,memberLogin:r});return{groupKey:p,proposeSignature:S}},t.getSpecialUserGroupRevision=async function(e,{teamId:t}){const{wsService:r,storeService:n}=e,s=(0,o.getCurrentUserInfo)(n),c=n.getTeamAdminData(),d=(0,a.getAdminDataFromTeamAdminData)(c,String(t)),{revision:l}=await(0,i.loadSpecialUserGroup)(r,s.login,s.uki,d);return{specialUserGroupRevision:l}}},19408:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupKey=t.syncUserGroupManagementForAllTeams=void 0;const o=r(19364),n=r(43927),a=r(85784),i=r(81567),s=r(17137);t.syncUserGroupManagementForAllTeams=function(e,t,r,c,d,l,u){const p=(0,n.syncAdministrableTeamList)(d,u);return Promise.all(Object.keys(p.teams).map((d=>{const u=p.teams[d];return function(e,t,r,c,d,l){return Promise.resolve(d).then((e=>(0,n.syncAdminData)(t,r,e,l))).then((t=>(0,o.setupUserGroupManagement)(e,r,c,t))).then((t=>t.status===a.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA?t:(0,i.filterOutInvalidUserGroupUsers)(e.crypto,t.adminData).then((t=>(0,s.sendUserGroupInvitesToNewUsers)(e,r,t))).then((e=>({status:a.SyncUserGroupManagementStatus.COMPLETE,adminData:e})))))}(e,t,r,c,u,l)}))).then((e=>{const t={};e.map((e=>e.adminData)).forEach((e=>{t[e.teamId]=e}));return{status:e.some((e=>e.status===a.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA))?a.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA:a.SyncUserGroupManagementStatus.COMPLETE,teamAdminData:{teams:t}}}))},t.getUserGroupKey=function(e,t){if(!e)return null;const r=e.find((e=>e.groupId===t));return r?r.groupKey:null}},36467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUserGroupAdminItemsFromMigration=t.createItemsForUserGroups=void 0;const o=r(78320),n=r(93513);async function a(e,t,r){const o=r.users.find((e=>e.userId===t.login));if(!o)throw new Error("Couldnt find self in user group");return await e.asymmetricEncryption.decrypt(t.privateKey,o.groupKey)}t.createItemsForUserGroups=async function(e,t,r){return await Promise.all(r.map((r=>async function(e,t,r){const o=await e.symmetricEncryption.generateNewAESKey(),[a,i]=await Promise.all([e.symmetricEncryption.encryptAES256(o,n.encode(JSON.stringify(r))),e.symmetricEncryption.encryptAES256(t,n.encode(o))]);return{itemId:r.itemId,itemKey:i,content:a}}(e,t,r))))},t.getUserGroupAdminItemsFromMigration=async function(e,t,r){return await Promise.all((r.userGroups||[]).map((r=>async function(e,t,r){return{itemId:(0,o.generateItemUuid)(),groupId:r.groupId,groupKey:await a(e,t,r)}}(e,t,r))))}},17137:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendUserGroupInvitesToNewUsers=void 0;const o=r(70252),n=r(95623),a=r(19408);function i(e){return e.users.filter((e=>"publicKey"===e.rsaStatus))}t.sendUserGroupInvitesToNewUsers=function(e,t,r){return Promise.resolve().then((()=>function(e){if(!e.userGroups)return[];return e.userGroups.reduce(((e,t)=>e.concat(i(t))),[])}(r))).then((s=>s.length?function(e,t,r){const{login:o,uki:n}=t,a=JSON.stringify(r.map((e=>e.alias)));return e.userGroup.findUsersByAliases({login:o,uki:n,aliases:a})}(e,t,s).then((s=>{const c=r.userGroups.map((c=>{const d=i(c);if(!d.length)return Promise.resolve(c);const l=function(e,t){return t.map((t=>({Alias:t.alias,Login:e[t.alias].login,PublicKey:e[t.alias].publicKey,Permission:t.permission})))}(s,d),u=(0,a.getUserGroupKey)(r.userGroupAdminItems,c.groupId);return e.userGroup.makeUpdateMembersWithInviteEvent(c.groupId,u,c.revision,l).then((r=>e.userGroup.updateUserGroupMembers(t,r))).then((e=>e[0])).catch((e=>{const t=`[sendUserGroupInvitesToNewUsers] - Cannot send update event for one user group - groupId: ${c.groupId} - error: ${e}`,r=new Error(t);return n.default.error(r),(0,o.sendExceptionLog)({error:r}),c}))}));return Promise.all(c).then((e=>({...r,userGroups:e})))})):r))}},19364:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSpecialGroups=t.setupUserGroupManagement=void 0;const o=r(95623),n=r(63623),a=r(44197),i=r(36467),s=r(85784);function c(e,t,r,a){return o.Debugger.log("setting up group sharing for team: "+a.teamId),Promise.resolve(a).then((o=>o.specialUserGroup?o:(0,n.createSpecialUserGroup)(e,t,r,Number(o.teamId)).then((e=>Object.assign({},o,{specialUserGroup:e}))))).then((r=>r.specialItemGroup?r:(0,i.getUserGroupAdminItemsFromMigration)(e.crypto,t,a).then((o=>(0,n.createSpecialItemGroup)(e,t,r.specialUserGroup,o).then((e=>Object.assign({},r,{specialItemGroup:e,userGroupAdminItems:o})))))))}t.setupUserGroupManagement=function(e,t,r,o){const n=o.specialUserGroup,i=o.specialItemGroup;if(!n)return i?Promise.reject(new Error("UserGroupManagementSetupService - no special user group, but a special item group is present")):c(e,t,r,o).then((e=>({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:e})));const d=(0,a.getUserInUserGroup)(t.login,n);return d?"pending"===d.status?i?Promise.reject(new Error("UserGroupManagementSetupService - special user group is not accepted, but a special item group is present")):Promise.resolve().then((()=>e.userGroup.isCurrentUserProposeSignatureValid(t,n))).then((e=>{if(!e)throw new Error("UserGroupManagementSetupService - INVALID_PROPOSE_SIGNATURE")})).then((()=>e.userGroup.makeAcceptUserGroupEvent(t,n))).then((r=>e.userGroup.acceptUserGroup(t,r))).then((({userGroups:e})=>{if(1!==e.length)throw new Error(`UserGroupManagementSetupService - Invalid response from UserGroupService.acceptUserGroup - ${e}`);return e[0]})).then((e=>Object.assign({},o,{specialUserGroup:e}))).then((e=>({status:s.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA,adminData:e}))):"accepted"===d.status?i?Promise.resolve({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:o}):c(e,t,r,o).then((e=>({status:s.SyncUserGroupManagementStatus.COMPLETE,adminData:e}))):Promise.reject(new Error("UserGroupManagementSetupService - current user status in special user group is neither accepted or pending")):Promise.reject(new Error("UserGroupManagementSetupService - Current user us missing from special user group"))},t.createSpecialGroups=c},43927:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadSpecialUserGroup=t.loadSpecialItemGroup=t.syncAdminDataFromSharingData=t.createUserGroupAdminItemInState=t.deleteAdministrableUserGroups=t.updateAdministrableUserGroupList=t.updateTeamAdminData=t.filterTeamAdminData=t.syncAdminData=t.syncAdministrableTeamList=t.getUserGroupDescriptionsForTeam=void 0;const o=r(63623),n=r(1370),a=r(28096),i=r(44197),s=r(57520),c=r(36513),d=r(27885);function l(e,t,r,o){return e.teamPlans.findUserGroups({login:t,uki:r,teamId:o}).then((e=>e.content.userGroups))}function u(e){const t={};return Object.keys(e.teams).forEach((r=>{const o=e.teams[r];t[r]=o?{teamId:r,userGroups:o.userGroups||[],notifications:o.notifications||{accountRecoveryRequests:[]}}:{teamId:r}})),{teams:t}}t.getUserGroupDescriptionsForTeam=l,t.syncAdministrableTeamList=function(e,t){const r={},o=(0,d.getNodePremiumStatusSpaceData)(t),n=o.spaces.filter((e=>(0,d.hasSpecialUserGroupAccessInSpace)(e.teamId,o))).map((e=>e.teamId));return Object.keys(e.teams).filter((e=>Boolean(e))).filter((e=>n.includes(e))).forEach((t=>{r[t]=e.teams[t]})),n.forEach((e=>{r[e]||(r[e]={teamId:e})})),{teams:r}},t.syncAdminData=async function(e,t,r,n){const a=await S(t,r,n);return a.specialUserGroup&&!(0,i.hasUserAcceptedUserGroup)(t.login,a.specialUserGroup)?a:async function(e,t,r,n){const a=await l(e,t,r,Number(n.teamId)),i={items:[],itemGroups:[],userGroups:a.map((e=>({id:e.groupId,revision:e.revision})))},s={items:[],itemGroups:[],userGroups:(n.userGroups||[]).filter((e=>Boolean(e)))},c=await(0,o.buildSharingData)(e,t,r,i,s);return{...n,userGroups:c.userGroups}}(e,t.login,t.uki,a)},t.filterTeamAdminData=u,t.updateTeamAdminData=function(e,t){e.dispatch((0,n.teamAdminDataUpdated)(t)),(0,a.sendTeamAdminDataUpdate)(u(t))},t.updateAdministrableUserGroupList=function(e,t,r){e.dispatch((0,n.userGroupsUpdated)(t,r)),(0,a.sendTeamAdminDataUpdate)(u(e.getTeamAdminData()))},t.deleteAdministrableUserGroups=function(e,t,r){e.dispatch((0,n.userGroupsDeleted)(t,r)),(0,a.sendTeamAdminDataUpdate)(u(e.getTeamAdminData()))},t.createUserGroupAdminItemInState=function(e,t,r){e.dispatch((0,n.userGroupAdminItemCreated)(t,r))};const p=e=>e.reduce(((e,t)=>((0,i.isUserGroupAdminItem)(t)?e.userGroupAdminItems.push(t):(0,i.isDirectorySyncKey)(t)?e.directorySyncKey=t:(0,i.isEsBasicConfigsData)(t)?e.encryptionServiceData=t:(0,i.isSSOConnectorKey)(t)?e.ssoConnectorKey=t:(0,i.isSCIMSignatureKey)(t)?e.scimSignatureKey=t:(0,i.isAdminProvisioningKey)(t)?e.adminProvisioningKey=t:(0,s.isMassDeploymentTeamKey)(t)&&(e.massDeploymentTeamKey=t),e)),{userGroupAdminItems:[],directorySyncKey:null,encryptionServiceData:null,ssoConnectorKey:null,scimSignatureKey:null,adminProvisioningKey:null,massDeploymentTeamKey:null});async function S(e,t,r){const o=function(e,t){const{specialItemGroup:r,specialUserGroup:o}=t;return{...e,specialItemGroup:r,specialUserGroup:o}}(t,r);return async function(e,t,r){const o=(0,c.makeCryptoService)(),{specialItemGroup:n,specialItems:a}=r,s=await Promise.all(n?.items?.map((({itemId:r,itemKey:n})=>{const s=a[r];if(!s)throw new Error("Unexpected error: missing itemKey");return(0,i.decryptAdminItem)(o,e,t,s,n)}))??[]),{userGroupAdminItems:d,directorySyncKey:l,encryptionServiceData:u,ssoConnectorKey:S,scimSignatureKey:m,adminProvisioningKey:g,massDeploymentTeamKey:y}=p(s);return{...t,userGroupAdminItems:d,directorySyncKey:l,encryptionServiceData:u,ssoConnectorKey:S,scimSignatureKey:m,adminProvisioningKey:g,massDeploymentTeamKey:y}}(e,o,r)}t.syncAdminDataFromSharingData=S,t.loadSpecialItemGroup=async function(e,t,r,n){if(!n.specialItemGroup||!n.specialItemGroup.groupId)throw new Error("specialItemGroup is missing from adminData");const{itemGroups:a}=await(0,o.getSharedData)(e,t,r,{itemIds:[],itemGroupIds:[n.specialItemGroup.groupId],userGroupIds:[]});if(a&&1===a.length)return a[0];throw new Error("could not fetch specialItemGroup")},t.loadSpecialUserGroup=async function(e,t,r,n){const{userGroups:a}=await(0,o.getSharedData)(e,t,r,{itemIds:[],itemGroupIds:[],userGroupIds:n.specialUserGroup?.groupId?[n.specialUserGroup.groupId]:[]});if(a&&1===a.length)return a[0];throw new Error("Could not fetch specialUserGroup")}},85784:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SyncUserGroupManagementStatus=void 0,function(e){e[e.NEEDS_FRESH_SHARING_DATA=0]="NEEDS_FRESH_SHARING_DATA",e[e.COMPLETE=1]="COMPLETE"}(t.SyncUserGroupManagementStatus||(t.SyncUserGroupManagementStatus={}))},81567:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filterOutInvalidUserGroupUsers=void 0;const o=r(82366),n=r(19408);t.filterOutInvalidUserGroupUsers=function(e,t){if(!t.userGroups)return Promise.resolve(t);const r=t.userGroups.map((r=>{const a=(0,n.getUserGroupKey)(t.userGroupAdminItems,r.groupId);return function(e,t,r){const n=r.map((r=>{if("refused"===r.status||"revoked"===r.status)return Promise.resolve(!0);if(!r.proposeSignature)return Promise.resolve(!1);if(null===t)return Promise.resolve(!1);const n=r.proposeSignatureUsingAlias?r.alias:r.userId;return(0,o.isProposeSignatureValid)(e,r.proposeSignature,n,t)}));return Promise.all(n).then((e=>r.filter(((t,r)=>e[r]))))}(e,a,r.users).then((e=>({...r,users:e})))}));return Promise.all(r).then((e=>({...t,userGroups:e})))}},44197:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findTeamForGroup=t.syncUserGroupManagement=t.isAdminProvisioningKey=t.isSCIMSignatureKey=t.isSSOConnectorKey=t.isEsBasicConfigsData=t.isDirectorySyncKey=t.isUserGroupAdminItem=t.decryptAdminItem=t.getUserGroup=t.getUserGroupAdminItem=t.getSpecialItemGroupKey=t.getSpecialItemGroupFromAdminData=t.getAdminDataFromTeamAdminData=t.makeInviteToSpecialUserGroup=t.getPublicKeyForUser=t.encryptGroupKeyForUser=t.getSpecialUserGroupPrivateKey=t.getSpecialUserGroupKey=t.hasUserAcceptedUserGroup=t.getUserInUserGroup=t.getSpecialUserGroup=void 0;const o=r(63623),n=r(34376),a=r(82366),i=r(70206),s=r(19408),c=r(43927),d=r(97124);function l(e){return e.specialUserGroup}function u(e,t,r){const o=l(r);if(!o)throw new Error("specialUserGroup is not available in adminData");const n=o.users.find((e=>e.userId===t.login));if(!n)throw new Error("couldnt find self in specialUserGroup users");return(0,i.decryptGroupKey)(e,t,n.groupKey)}async function p(e,t,r){const o=await u(e,t,r),n=l(r);return await e.symmetricEncryption.decryptAES256(o,n.privateKey)}function S(e,t,r){return e.asymmetricEncryption.encrypt(t,r)}function m(e,t,r){return e.userGroup.findExistingUsersByAliases({login:t.login,uki:t.uki,aliases:(0,o.extractAliasesFromMembers)([{Alias:r}])}).then((e=>e[r].publicKey))}function g(e,t){return e.teams[t]}function y(e){return e.specialItemGroup}async function A(e,t,r){const o=y(r);if(!o)throw new Error("specialItemGroup is not available in adminData");const n=await p(e,t,r),a=l(r).groupId,i=o.groups.find((e=>e.groupId===a));if(!i)throw new Error("couldnt find specialUserGroup in specialItemGroup groups");return e.asymmetricEncryption.decrypt(n,i.groupKey)}t.getSpecialUserGroup=l,t.getUserInUserGroup=function(e,t){return t.users.find((t=>t.userId===e))},t.hasUserAcceptedUserGroup=function(e,t){return t.users.some((t=>t.userId===e&&"accepted"===t.status))},t.getSpecialUserGroupKey=u,t.getSpecialUserGroupPrivateKey=p,t.encryptGroupKeyForUser=S,t.getPublicKeyForUser=m,t.makeInviteToSpecialUserGroup=function(e,t,r,o,{teamId:n,memberLogin:i,publicKey:s}){const c=g(o,String(n)),d=s?Promise.resolve(s):m(e,r,i);return Promise.all([u(t,r,c),d]).then((([e,r])=>Promise.all([S(t,r,e),(0,a.generateProposeSignature)(t,e,i)]))).then((([e,t])=>({groupKey:e,proposeSignature:t,userGroupRevision:l(c).revision})))},t.getAdminDataFromTeamAdminData=g,t.getSpecialItemGroupFromAdminData=y,t.getSpecialItemGroupKey=A,t.getUserGroupAdminItem=function(e,t,r){return(g(e,t).userGroupAdminItems||[]).find((e=>e.groupId===r))},t.getUserGroup=function(e,t){return Object.keys(e.teams).map((t=>e.teams[t]&&e.teams[t].userGroups)).reduce(((e,t)=>t.concat(e)),[]).find((e=>e.groupId===t))},t.decryptAdminItem=async function(e,t,r,o,n){const a=await A(e,t,r),i=await e.symmetricEncryption.decryptAES256(a,n),s=await e.symmetricEncryption.decryptAES256(i,o.content);return{...JSON.parse(s),itemId:o.itemId}},t.isUserGroupAdminItem=function(e){return"groupId"in e},t.isDirectorySyncKey=function(e){return"publicKey"in e};t.isEsBasicConfigsData=e=>"basicConfigs"in e;t.isSSOConnectorKey=e=>"ssoConnectorKey"in e;t.isSCIMSignatureKey=e=>"scimSignatureKey"in e;t.isAdminProvisioningKey=e=>"adminProvisioningKey"in e,t.syncUserGroupManagement=function(e,t,r){const o=e.getSpaceData(),a=e.getTeamAdminData(),i=(0,n.getCurrentUserInfo)(e),l=(0,d.makeSharingService)(e,t);return i.privateKey?(0,s.syncUserGroupManagementForAllTeams)(l,t,(0,n.getCurrentUserInfo)(e),o,a,r,e).then((t=>((0,c.updateTeamAdminData)(e,t.teamAdminData),t.status))):Promise.reject(new Error("PRIVATE_KEY_MISSING"))},t.findTeamForGroup=function(e,t){const r=Object.keys(e.teams).find((r=>e.teams[r].userGroups.some((e=>e.groupId===t))));return r&&e&&e.teams&&e.teams[r]}},32159:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adminProvisioningKey$=t.administrableUserGroup$=t.administrableUserGroups$=void 0;const o=r(18948),n=r(3343),a=r(92310),i=r(94228);t.administrableUserGroups$=function(){const e=a.administrableUserGroupsSelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())},t.administrableUserGroup$=function(e){const t=(0,a.getAdministrableUserGroupSelector)(e);return(0,o.pipe)((0,n.map)(t),(0,n.distinctUntilChanged)())};t.adminProvisioningKey$=()=>(0,o.pipe)((0,n.map)(i.adminProvisioningKeySelector),(0,n.distinctUntilChanged)())},76154:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRecoveryCodesAsTeamCaptain=void 0;const o=r(45127),n=r(46298),a=r(74528),i=r(16593),s=e=>{switch(e.code){case a.GetRecoveryCodesAsTeamCaptainNotAdminErrorCode:return o.GetRecoveryCodesAsTeamCaptainErrorCode.NotAdmin;case a.GetRecoveryCodesAsTeamCaptainInternalErrorCode:return o.GetRecoveryCodesAsTeamCaptainErrorCode.InternalError;default:return o.GetRecoveryCodesAsTeamCaptainErrorCode.UnknownError}};t.getRecoveryCodesAsTeamCaptain=async function(e,t){const{storeService:r}=e,o=(0,i.userLoginSelector)(r.getState()),c=await(0,a.getRecoveryCodesAsTeamCaptain)(r,o,t);return(0,n.isApiError)(c)?{success:!1,error:{code:s(c)}}:{success:!0,data:{recoveryCodes:c.recoveryCodes}}}},92310:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAdministrableUserGroupSelector=t.isGroupNameAvailableSelector=t.administrableUserGroupSelector=t.administrableUserGroupsSelector=t.currentSpaceInfoSelector=t.currentTeamIdSelector=t.adminDataForTeamSelector=void 0;const o=r(32034);t.adminDataForTeamSelector=(e,t)=>{const r=(e=>e.userSession.teamAdminData)(e);return r.teams?r.teams[t]:void 0};t.currentTeamIdSelector=e=>{const t=e.userSession.spaceData.spaces.find((e=>"accepted"===e.details.status));if(t)return t.teamId};t.currentSpaceInfoSelector=e=>{const t=e.userSession.spaceData.spaces.find((e=>"accepted"===e.details.status));if(t)return t.info};t.administrableUserGroupsSelector=e=>{const r=(0,t.currentTeamIdSelector)(e);if(!r)return[];const o=(0,t.adminDataForTeamSelector)(e,r);return o&&o.userGroups||[]};t.administrableUserGroupSelector=(e,r)=>(0,t.administrableUserGroupsSelector)(e).find((e=>e.groupId===r));t.isGroupNameAvailableSelector=(e,r)=>!(0,t.administrableUserGroupsSelector)(e).some((e=>e.name===r));t.getAdministrableUserGroupSelector=e=>(0,o.createSelector)(t.administrableUserGroupsSelector,(t=>t.find((t=>t.groupId===e))))},3674:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeTeamAdminController=void 0;const o=r(97124),n=r(34376),a=r(38045),i=r(43927),s=r(63623),c=r(44197),d=r(66833),l=r(1370);function u(e,t,r){return a.proposeMembers(t,(0,n.getCurrentUserInfo)(e),r)}function p(e,t){return(0,c.getUserGroup)(e.getTeamAdminData(),t)}t.makeTeamAdminController=(e,t)=>({getMembers:t=>function(e,t){return a.getMembers(e,(0,n.getCurrentUserInfo)(e).login,t)}(e,t),proposeMembers:r=>u(e,t,r),addTeamAdmin:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const n=(0,o.makeSharingService)(e,t);return a.addTeamAdmin(n,r).catch((e=>({error:e})))}(e,t,r),removeTeamAdmin:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const n=(0,o.makeSharingService)(e,t);return a.removeTeamAdmin(n,r).catch((e=>({error:e})))}(e,t,r),createUserGroupAction:(r,a)=>function(e,t,r,a){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(a);const c=(0,o.makeSharingService)(e,r),d=(0,n.getCurrentUserInfo)(e),u=e.getTeamAdminData();return(0,s.createUserGroup)(c,d,u,a).then((r=>{if(Array.isArray(r.itemGroups)&&r.itemGroups.length>0){const t=r.itemGroups[0],o=String(t.teamId),n=(0,l.specialItemGroupUpdated)(o,t);e.dispatch(n)}const o=a.teamId,n=e.getTeamAdminData().teams[o]&&e.getTeamAdminData().teams[o].userGroups||[];return(0,i.updateAdministrableUserGroupList)(e,o.toString(),n.concat(r.userGroups)),r.userGroupAdminItem&&((0,i.createUserGroupAdminItemInState)(e,o.toString(),r.userGroupAdminItem),t.getInstance().user.persistTeamAdminData().then((()=>r))),r})).then((e=>({userGroups:e.userGroups,error:e.error})))}(e,r,t,a),deleteUserGroupAction:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const a=(0,o.makeSharingService)(e,t),c=(0,n.getCurrentUserInfo)(e),d=p(e,r.groupId);return(0,s.deleteUserGroup)(a,c,e.getTeamAdminData(),r).then((({userGroups:t,itemGroups:r})=>{const o=r[0],n=String(o.teamId),a=(0,l.specialItemGroupUpdated)(n,o);return e.dispatch(a),(0,i.deleteAdministrableUserGroups)(e,String(d.teamId),t),{userGroups:t}}))}(e,t,r),renameUserGroupAction:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const a=(0,o.makeSharingService)(e,t),c=(0,n.getCurrentUserInfo)(e);return(0,s.renameUserGroup)(a,c,r).then((({userGroups:t})=>{if(t&&1===t.length){const o=String(t[0].teamId),n=(e.getTeamAdminData().teams[o]&&e.getTeamAdminData().teams[o].userGroups||[]).map((e=>e.groupId===r.groupId&&t[0]||e));(0,i.updateAdministrableUserGroupList)(e,o,n)}return{userGroups:t}}))}(e,t,r),inviteUserGroupMembersAction:(r,a)=>function(e,t,r,a){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const c=(0,o.makeSharingService)(e,t),d=(0,n.getCurrentUserInfo)(e),l=e.getTeamAdminData(),S=p(e,r.groupId),m={};r.users.forEach((e=>m[e.alias]=e));const g={proposedMemberLogins:Object.keys(m),teamId:r.teamId,origin:"teamInviteUserGroupUsers",notificationOptions:{skipAccountCreationRequiredAlerts:!0,skipReproposals:a}};return u(e,t,g).then((t=>{const o=Object.keys(t.proposedMembers).map((e=>m[e]));t.accountCreationRequiredMembers.forEach((e=>o.push(m[e])));const n={};if(Object.keys(t.refusedMembers).forEach((e=>{const r=t.refusedMembers[e];"already_member"!==r?n[e]=r:o.push(m[e])})),0===o.length){return{userGroups:[S],refusedMembers:n}}const a={...r,users:o};return(0,s.inviteUserGroupMembers)(c,d,l,a,S).then((t=>{if(t.error)return t;const o=String(t.userGroups[0].teamId),a=(e.getTeamAdminData().teams[o]&&e.getTeamAdminData().teams[o].userGroups||[]).map((e=>e.groupId===r.groupId&&t.userGroups&&t.userGroups[0]||e));return(0,i.updateAdministrableUserGroupList)(e,String(S.teamId),a),{...t,refusedMembers:n}}))})).catch((e=>{if(400===e?.additionalInfo?.code)return Promise.resolve({refusedMembers:{},userGroups:[],error:{message:e.additionalInfo?.webServiceSubMessage||"unknown error"}});throw e}))}(e,t,r,a),revokeUserGroupMembersAction:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const a=(0,o.makeSharingService)(e,t),c=(0,n.getCurrentUserInfo)(e);return(0,s.revokeUserGroupMembers)(a,c,r).then((t=>{if(t&&t.userGroups&&1===t.userGroups.length){const o=t.userGroups[0],n=(e.getTeamAdminData().teams[o.teamId]&&e.getTeamAdminData().teams[o.teamId].userGroups||[]).map((e=>e.groupId===r.groupId&&t.userGroups&&t.userGroups[0]||e));(0,i.updateAdministrableUserGroupList)(e,String(o.teamId),n)}return t}))}(e,t,r),updateUserGroupMembersAction:r=>function(e,t,r){if(!e.isAuthenticated())return(0,s.emptySessionResponse)(r);const a=(0,o.makeSharingService)(e,t),i=(0,n.getCurrentUserInfo)(e);return(0,s.updateUserGroupMembers)(a,i,r)}(e,t,r),teamUpdateHandler:t=>function(e,t){return Promise.resolve().then((()=>{if(!e.isAuthenticated())return[new Error("no session set")];const r=()=>{const r=e.getSpaceData().spaces.map((e=>{if(e.details.teamId!==t.teamId.toString())return e;const r=function(e,t){const{teamAdmins:r}=e.details;switch(t.action){case"adminPromoted":return r.concat(t.users.map((e=>({login:e}))));case"adminDemoted":return r.filter((e=>!t.users.includes(e.login)));default:return r}}(e,t);return Object.assign({},e,{details:Object.assign({},e.details,{teamAdmins:r})})}));(0,d.updateSpaceData)(e,r)};if(["adminPromoted","adminDemoted"].includes(t.action)&&r(),"memberRevoked"===t.action){const r=e.getTeamAdminData().teams[t.teamId],o=(r.userGroups||[]).map((e=>Object.assign({},e,{users:e.users.filter((e=>!t.users.includes(e.alias)))})));(0,i.updateAdministrableUserGroupList)(e,r.teamId,o)}return null}))}(e,t),confirmFreeTrial:e=>function(e,t){return e.teamPlans.confirmFreeTrial({token:t})}(t,e),getPremiumStatus:e=>function(e,t){return e.premium.status(t)}(t,e),getTeamTokens:()=>function(e,t){const r=e.getUserLogin();return t.qa.tokens({login:r})}(e,t),registerFreeTrial:e=>function(e,t){return e.teamPlans.registerFreeTrial(t)}(t,e),acceptTeamInvite:e=>function(e,t){const{token:r}=t;return e.teamPlans.acceptTeam({token:r})}(t,e)})},64688:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(68541);t.bootstrap=e=>{e.register(o.config)}},53050:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createOrUpdateSpecialItem=void 0;const o=r(48062),n=r(78320),a=r(34376),i=r(43154),s=r(44197),c=r(92310);t.createOrUpdateSpecialItem=async(e,t,r)=>{const{storeService:d,sessionService:l}=e;(0,i.requireAdmin)(d);const u=(0,c.currentTeamIdSelector)(d.getState()),p=(0,c.adminDataForTeamSelector)(d.getState(),u),S=(0,a.getCurrentUserInfo)(d),{crypto:m,item:g,ws:y}=t,{specialItemGroup:A}=p;if(!A)throw new Error("Cannot find specialItemGroup in adminData");const f=await(0,s.getSpecialItemGroupKey)(m,S,p),E=(0,n.generateItemUuid)(),h=await m.symmetricEncryption.generateNewAESKey(),v=await m.symmetricEncryption.encryptAES256(f,btoa(h)),T=await m.symmetricEncryption.encryptAES256(h,btoa(JSON.stringify(r))),_=await g.makeItemUpload(E,v,T),I=await g.makeAddItemsEvent(A.groupId,A.revision,[_]),C=await g.addItems(y,S.login,S.uki,I),P=C?.items?.find((({itemId:e})=>e===E));if(!P)throw new Error("unable to persist item");return await l.getInstance().user.attemptSync(o.Trigger.SettingsChange),r}},51168:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=t.setupSubscriptions=void 0;var o=r(77208);Object.defineProperty(t,"setupSubscriptions",{enumerable:!0,get:function(){return o.setupSubscriptions}});var n=r(64688);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return n.bootstrap}})},94150:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTeamAdminItem=void 0;const o=r(97124),n=r(34376),a=r(92310),i=r(48062);t.removeTeamAdminItem=async({storeService:e,sessionService:t,wsService:r},s)=>{const c=(0,o.makeSharingService)(e,r),d=(0,n.getCurrentUserInfo)(e),l=(0,a.currentTeamIdSelector)(e.getState()),u=(0,a.adminDataForTeamSelector)(e.getState(),l),{specialItemGroup:p}=u,{item:S,ws:m}=c;if(!p)throw new Error("Cannot find specialItemGroup in adminData");const{revision:g,groupId:y}=p,A=u[s];if(!A)return{success:!0};const{itemId:f}=A,E=await S.makeRemoveItemsEvent(y,g,[f]);return await S.removeItems(m,d.login,d.uki,E),await t.getInstance().user.attemptSync(i.Trigger.SettingsChange),{success:!0}}},77208:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(97124),n=r(7344),a=r(58415);t.setupSubscriptions=function(e,t){const{sessionService:r,storeService:i,localStorageService:s,wsService:c}=t,d=(0,o.makeSharingService)(i,c),l=(0,a.makeDirectorySyncController)({sessionService:r,sharingService:d,storeService:i,localStorageService:s,wsService:c});e.syncSuccess.on((()=>{const e=i.getSpaceData();(0,n.isDirectorySyncActivated)(e)&&l.directorySyncForAllTeams()}))}},77627:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeSessionService=void 0;const o=r(95551),n=r(34186),a=r(27754),i=r(6623),s=r(97321);t.makeSessionService=e=>{let t=null,r=null,c=null;return{isSessionStarted:()=>{const{storeService:t}=e,r=t.getState();return!!(0,a.sessionStartTimeSelector)(r)},setInstance:(a,i)=>{t=(0,o.makeUserSessionService)(e,a,i),r=(0,s.makeUserDeviceService)(e),c=(0,n.makeUserPaymentService)(e.storeService,e.wsService)},close:(e=!0)=>((e=!0)=>t?t.closeSession(e):Promise.resolve())(e).then((()=>{t=null,r=null,c=null})),lock:()=>(t?t.lockSession():Promise.resolve()).then((()=>{t=null,r=null,c=null})),tryRestoreInstance:()=>{const{storeService:d}=e,l=d.getState();(0,a.sessionIdSelector)(l)?(t=(0,o.makeResumedUserSessionService)(e),r=(0,s.makeUserDeviceService)(e),c=(0,n.makeUserPaymentService)(e.storeService,e.wsService)):(0,i.setupEncryptorServices)(e)},getInstance:()=>{if(!t)throw new Error("makeSessionService: You must call setInstance(login: string, password: string) before getting the instance");return{user:t,device:r,payment:c}}}}},97321:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserDeviceService=void 0;const o=r(66638),n=r(18948);t.makeUserDeviceService=({deviceManagementClient:e})=>({fetchDevicesList:()=>a(e),deactivateDevice:t=>i(e,t),changeDeviceName:(t,r)=>s(e,t,r)});const a=async e=>{const t=await(0,n.firstValueFrom)(e.queries.listAuthorisedDevice());return(0,o.isSuccess)(t)?t.data:t.error},i=async(e,t)=>{await e.commands.revokeAuthorisedDevice({deviceId:t})},s=async(e,t,r)=>{await e.commands.renameAuthorisedDevice({deviceId:t,updatedName:r})}},34186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeUserPaymentService=void 0;const o=r(90622),n=r(36273),a=r(46298);t.makeUserPaymentService=(e,t)=>({fetchInvoices:()=>i(e),updatePaymentCard:(r,o)=>s(e,t,r,o),cancelPremiumSubscription:()=>c(e,t)});const i=async e=>{const t=e.getAccountInfo().login,r=await(0,n.listInvoices)(e,t);return(0,a.isApiError)(r)?[]:r.invoices},s=(e,t,r,n)=>{const a=e.getAccountInfo().login,i=(0,o.ukiSelector)(e.getState());return t.premium.updateCardToken({login:a,uki:i,tokenId:r,stripeAccount:n}).then((e=>({success:e.success&&!e.error,reason:e.error?e.error.message:null})))},c=(e,t)=>{const r=e.getAccountInfo().login,n=(0,o.ukiSelector)(e.getState());return t.premium.setAutoRenewal({login:r,uki:n,enabled:!1}).then((()=>{}))}},95551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateRsaKeys=t.treatKeysResult=t.isSyncInProgress=t.storeSync=t.hasTreatProblems=t.makeResumedUserSessionService=t.makeUserSessionService=t.ON_USER_SESSION_CLOSED=void 0;const o=r(18948),n=r(48062),a=r(45127),i=r(88744),s=r(66638),c=r(56668),d=r(28096),l=r(48313),u=r(35924),p=r(95623),S=r(45291),m=r(27517),g=r(34433),y=r(37898),A=r(25963),f=r(82262),E=r(76089),h=r(78118),v=r(85784),T=r(36513),_=r(25576),I=r(70252),C=r(16356),P=r(28445),D=r(1370),O=r(44197),b=r(33007),w=r(58217),N=r(59489),R=r(58582),M=r(41007),L=r(60946),U=r(75226),k=r(56915),F=r(5689),B=r(6231),G=r(39408),K=r(43416),V=r(62627),j=r(16593),H=r(34287),W=r(8481),x=r(76901),z=r(12362),q=r(86691),Y=r(40051),$=r(72881),Q=r(95303),X=r(44999),J=r(16661),Z=r(14651),ee=r(46298),te=r(61740),re=r(10824),oe=r(35507),ne=r(64910),ae=r(16478),ie=r(71291),se=r(6623),ce=r(84827),de=r(57903),le=r(92263),ue=r(75199),pe=r(1347),Se=r(18862),me=r(35037);t.ON_USER_SESSION_CLOSED="OnUserSessionClosed";const ge=(e,t,r=!1)=>{e.localStorageService.setInstance(t),r&&e.storeService.dispatch((0,l.openSession)(t));const o=(0,ne.getNoDerivationCryptoConfig)();e.teamDeviceEncryptedConfigEncryptorService.setInstance({raw:e.storeService.getUserSession().masterPassword},e.storeService.getUserSession().serverKey,o),(0,se.setupEncryptorServices)(e),e.localStorageService.setInstance(t);const n=e.cryptoService||(0,T.makeCryptoService)(),a=new x.LocalStorageEventStore(e.localStorageService);(0,z.setInstance)(a),(0,q.setInstance)(a),(0,X.setInstance)(e.storeService,e.localStorageService,e.wsService);let i=null;const s=()=>{clearInterval(i)};return(()=>{let t=e.storeService.getUserSession();e.storeService.getStore().subscribe((()=>{const r=e.storeService.getUserSession();r!==t&&(t.masterPassword===r.masterPassword&&t.serverKey===r.serverKey||""===r.masterPassword||(p.Debugger.log("Master Password || Server Key updated"),r.masterPassword||r.serverKey?e.masterPasswordEncryptorService.setInstance({raw:r.masterPassword},r.serverKey):e.masterPasswordEncryptorService.close(),t=r))}))})(),{loadSessionData:()=>De(e.localStorageService,e.storeService),loadNonResumableSessionData:()=>Oe(e.localStorageService,e.storeService),accountExistsLocally:()=>async function(e){const t=await(0,U.getLocalAccounts)(e.storeService,e.storageService),r=e.storeService.getUserLogin(),o=e.localStorageService.getInstance(),n=t.some((({login:e})=>r===e));if(n){const e=await o.doesPersonalDataExist();return Boolean(r&&n&&e)}const a=await o.doesLocalDataExist();return Boolean(r&&a)}(e),refreshSessionData:()=>async function(e,t){const{localStorageService:r,storeService:o,wsService:n}=e,a=(0,re.requestPairing)(o,t),i=(0,W.refreshUserABTest)(o,r.getInstance(),t),s=(0,k.ukiSelector)(o.getState()),c=(0,oe.refreshPremiumStatus)(o,n,t,s),d=(0,ue.refreshCredentialsDedupView)(o,t);await Promise.all([c,a,i,d])}(e,t),getSyncArgs:()=>Ie(e.storeService,e.masterPasswordEncryptorService,e.wsService),sync:t=>Re(e,n,s,t),attemptSync:t=>Ee(e,n,s,t),requestNewSync:t=>_e(e,n,s,t),startPeriodic2FAInfoRefresh:()=>(()=>{if(null!==i)return;const{storeService:t,wsService:r}=e;i=setInterval((()=>{(0,ie.refreshTwoFactorAuthenticationInfoService)(t,r)}),ae.ENFORCE_2FA_POLICY_REFRESH_TIMER_INTERVAL)})(),stopPeriodic2FAInfoRefresh:()=>s(),refreshContactInfo:()=>Ge(e.storeService,e.wsService),fetchSubscriptionCode:()=>function(e,t){const r=e.getAccountInfo().login,o=(0,k.ukiSelector)(e.getState());return t.premium.getSubscriptionCode({login:r,uki:o}).then((t=>{const r=t&&t.content&&t.content.subscriptionCode;return e.dispatch((0,N.saveSubscriptionCode)(r)),r}))}(e.storeService,e.wsService),persistLocalSettings:()=>Le(e.localStorageService,e.storeService),persistPersonalData:()=>Ue(e.localStorageService,e.storeService),persistPersonalSettings:()=>ke(e.localStorageService,e.storeService),persistAllData:()=>Be(e.localStorageService,e.storeService),persistTeamAdminData:()=>Fe(e.localStorageService,e.storeService),persistLocalKey:t=>e.localStorageService.getInstance().storeLocalKey(t),closeSession:(t=!0)=>Ae(e,s,t),lockSession:()=>fe(e),fetchAccountInfo:()=>function(e,t){const r=e.getUserSession(),o=r.analyticsIds,n=r.publicUserId;if(o.userAnalyticsId&&o.deviceAnalyticsId&&n)return Promise.resolve({userAnalyticsId:o.userAnalyticsId,deviceAnalyticsId:o.deviceAnalyticsId,publicUserId:n});return(0,Z.accountInfo)(e,t).then((t=>{if((0,ee.isApiError)(t)||"success"!==t.code)throw new Error("Unable to fetch updated account info");return e.dispatch((0,C.updateAnalyticsIds)(t.userAnalyticsId,t.deviceAnalyticsId)),e.dispatch((0,C.updatePublicUserId)(t.publicUserId)),{userAnalyticsId:t.userAnalyticsId,deviceAnalyticsId:t.deviceAnalyticsId,publicUserId:t.publicUserId}}))}(e.storeService,e.storeService.getUserLogin())}};t.makeUserSessionService=(e,t,r)=>{if(!t)throw new Error(a.AuthenticationCode[a.AuthenticationCode.EMPTY_LOGIN]);const o=t.toLowerCase();if(!(0,P.isValidLogin)(o))throw new Error(a.AuthenticationCode[a.AuthenticationCode.INVALID_LOGIN]);if(!r&&""===r)throw new Error(a.AuthenticationCode[a.AuthenticationCode.EMPTY_MASTER_PASSWORD]);return e.storeService.dispatch((0,C.updateMasterPassword)(r)),e.storeService.dispatch((0,C.updateServerKey)("")),ge(e,o,!0)};t.makeResumedUserSessionService=e=>{const t=((0,j.userLoginSelector)(e.storeService.getState())??"").toLowerCase();if(!(0,P.isValidLogin)(t))throw new Error(d.SessionResumingCode[d.SessionResumingCode.INVALID_LOGIN_IN_STORE]);return ge(e,t)};const ye=async(e,t)=>{const{storageService:r,storeService:o,eventBusService:n,sessionClient:a,pinCodeClient:i}=e;if(o.isAuthenticated()){if(t){await(0,te.cleanRememberMeStorageData)(o,r,a);try{await i.commands.deactivate()}catch(e){const t=le.CarbonError.fromAnyError(e).addContextInfo("LOGOUT","deactivatePinCode").addAdditionalInfo({comment:"Failed to deactivate pin code on manual logout"});await(0,I.sendExceptionLog)({error:t})}}n.sessionClosed({login:null})}(0,Q.clearInstance)(),(0,q.clearInstance)(),(0,z.clearInstance)(),(0,X.clearInstance)();const{anonymousPartnerId:s,dashlaneServerDeltaTimestamp:c,appKeys:d,styxKeys:p}=o.getSdkAuthentication();o.dispatch((0,u.resetLoginStepInfo)()),o.dispatch((0,C.updateSessionDidOpen)(!1)),o.dispatch((0,l.closeSession)()),o.dispatch((0,b.loadSdkAuthentication)({anonymousPartnerId:s,dashlaneServerDeltaTimestamp:c,appKeys:d,styxKeys:p}))},Ae=async(e,t,r=!0)=>{const{storeService:o}=e;o.isAuthenticated()&&(await(0,de.waitUntilSyncComplete)(e.storeService),t()),await ye(e,!0),r&&d.triggerExtensionReload(o)},fe=async e=>{const{storeService:t}=e;if(!t.isAuthenticated()){const e=le.CarbonError.fromAnyError(new Error("No user session to lock")).addContextInfo("LOCK USER SESSION","UserSessionService");throw(0,I.sendExceptionLog)({error:e}),e}await ye(e,!1),d.triggerExtensionReload(t)},Ee=async(e,t,r,o)=>{try{return await Re(e,t,r,o)}catch(e){const t=new Error(`Sync failed: ${e}`);(0,I.sendExceptionLog)({error:t,code:a.ExceptionCriticality.WARNING})}};let he=!1,ve=()=>{},Te=Promise.resolve();const _e=async(e,t,r,o)=>{if(!he)return he=!0,await Te,he=!1,Ee(e,t,r,o)};const Ie=(e,t,r,o,a)=>{const i=e.getLocalSettings(),s=e.getAccountInfo().login,c=a===n.Trigger.InitialLogin?0:i.lastSync,d=a===n.Trigger.InitialLogin?y.SyncType.FIRST_SYNC:y.SyncType.LIGHT_SYNC;return{dataEncryptorService:t,storeService:e,login:s,uki:(0,k.ukiSelector)(e.getState()),lastSyncTimestamp:c,syncType:d,personalData:e.getPersonalData(),needsKeys:!e.getUserSession().keyPair,ws:r,announce:o||(e=>{})}},Ce=(e,t,r)=>{const o=Ie(e,t,r);return Object.assign(o,{lastSyncTimestamp:A.MAX_SYNC_TIMESTAMP})},Pe=e=>t=>(0,I.sendExceptionLog)({message:`[Crypto] unable to ${e}. ErrorMessage: ${t}`}),De=async(e,t)=>{const r=e.getInstance().getPersonalData().then((e=>(p.Debugger.log("Personal data has been deciphered successfully"),e))).catch((e=>((0,I.sendExceptionLog)({message:`[Crypto] unable to loadPersonalData. ErrorMessage: ${e}`}),(0,pe.getEmptyPersonalDataState)()))),o=e.getInstance().getLocalSettings().then((e=>(p.Debugger.log("Local settings have been deciphered successfully"),e))).catch((e=>({error:!0,logError:()=>Pe("loadLocalSettings")(e)}))),n=e.getInstance().getPersonalSettings().then((e=>(p.Debugger.log("Personal settings have been deciphered successfully"),e))).catch((e=>({error:!0,logError:()=>Pe("loadPersonalSettings")(e)}))),i=e.getInstance().doesNotificationStatusExist().then((r=>{r&&e.getInstance().getNotificationStatus().then((e=>(p.Debugger.log("Notifications status have been deciphered successfully"),t.dispatch((0,H.loadNotificationsStatus)(e)),e))).catch((e=>({error:!0,logError:()=>Pe("loadNotificationsStatus")(e)})))})),s=e.getInstance().getUserABTests().then((e=>(p.Debugger.log("User AB tests have been deciphered successfully"),e))).catch((e=>({error:!0,logError:()=>Pe("loadUserABTests")(e)}))),c=e.getInstance().getAnalyticsIds().then((e=>((0,p.logInfo)({message:"User Analytics IDs have been deciphered successfully"}),e))).catch((e=>({error:!0,logError:()=>Pe("loadAnalticsIds")(e)}))),u=(0,B.loadUserAuthenticationData)(e,t),y=[r,o,n];if(await e.getInstance().hasAuthenticationData()){const e=u.then((e=>(0,G.isLoadAuthenticationSuccess)(e)||e.message===G.FailedToRehydrateAuthenticationData?{error:!1}:{error:!0,logError:()=>Pe("loadAuthenticationData")(e.error)}));y.push(e)}const A=await Promise.all(y),f=A.every((e=>!!e&&e.error)),E=A.some((e=>!!e&&e.error));if(f)throw new Error(a.AuthenticationCode[a.AuthenticationCode.WRONG_PASSWORD]);if(E)throw A.forEach((e=>!!e&&e.logError instanceof Function&&e.logError())),new Error(a.AuthenticationCode[a.AuthenticationCode.DATA_TAMPERED_ERROR]);try{t.dispatch((0,S.loadStoredPersonalData)(await r));const e=await o;if(e){const r=(0,l.localSettingsUpdated)(e);t.dispatch(r),d.sendWebOnboardingModeUpdate(e.webOnboardingMode)}t.dispatch((0,m.loadStoredPersonalSettings)(await n)),t.dispatch((0,K.loadedStoredUserABTests)(await s)),t.dispatch((0,C.loadAnalyticsIds)(await c)),await u.then((e=>{if(!(0,G.isLoadAuthenticationSuccess)(e))throw e.error}))}catch(e){const t=`An error occurred when trying to write personalData, localSettings or personalSettings in Redux store ${e} `;throw p.Debugger.error(t),new Error(t)}const h=e.getInstance().getSharingData().then((e=>{p.Debugger.log(`sharingData loaded for ${t.getAccountInfo().login}`),t.dispatch((0,g.sharingDataUpdated)(e))})).catch(Pe("loadSharingDataPromise")),v=e.getInstance().getSharingSync().then((e=>{p.Debugger.log(`sharingSync loaded for ${t.getAccountInfo().login}`),t.dispatch((0,ce.setAllPendingAction)(e.pendingItemGroups,e.pendingUserGroups))})).catch(Pe("loadSharingSyncPromise")),T=e.getInstance().getTeamAdminData().then((e=>{p.Debugger.log(`teamAdminData loaded for ${t.getAccountInfo().login}`),t.dispatch((0,D.teamAdminDataUpdated)(e))})).catch(Pe("loadTeamAdminDataPromise")),_=e.getInstance().getIcons().then((e=>{if(null!==e){const r=(0,J.IconsCacheLoaded)(e);t.dispatch(r)}})).catch(Pe("loadIconsDataPromise")),P=e.getInstance().doesUserActivityExist().then((async r=>{if(r){const{lastSentAt:r}=await e.getInstance().getUserActivity();t.dispatch((0,Y.userActivityLastSentAtUpdated)(r))}})).catch(Pe("loadUserActivity")),O=e.getInstance().doesVaultReportExist().then((async r=>{if(r){const{lastSentAt:r}=await e.getInstance().getVaultReport();t.dispatch((0,$.vaultReportLastSentAtUpdated)(r))}})).catch(Pe("loadVaultReport"));return Promise.resolve().then((()=>{Promise.all([h,v,T,i,_,P,O])}))},Oe=async(e,t)=>{const r=e=>t=>{const r=`[Session] unable to ${e}. ErrorMessage: ${t}`;return p.Debugger.error(r),(0,I.sendExceptionLog)({message:r})},o=async(e,r)=>{await r;const o=(0,j.userLoginSelector)(t.getState());p.Debugger.log(`${e} loaded for ${o}`)},n=e.getInstance().getPersonalData().then((e=>{t.dispatch((0,S.loadStoredPersonalData)(e))})).catch(r("loadPersonalData")),a=e.getInstance().getSharingData().then((e=>{t.dispatch((0,g.sharingDataUpdated)(e))})).catch(r("loadSharingDataPromise")),i=e.getInstance().getSharingSync().then((e=>{t.dispatch((0,ce.setAllPendingAction)(e.pendingItemGroups,e.pendingUserGroups))})).catch(r("loadSharingSyncPromise")),s=e.getInstance().getTeamAdminData().then((e=>{t.dispatch((0,D.teamAdminDataUpdated)(e))})).catch(r("loadTeamAdminDataPromise")),c=e.getInstance().getIcons().then((e=>{if(null!==e){const r=(0,J.IconsCacheLoaded)(e);t.dispatch(r)}})).catch(r("loadIconsDataPromise"));try{await Promise.all([o("personalData",n),o("sharingData",a),o("sharingData",i),o("teamAdminData",s),o("iconsCacheData",c)])}catch(e){const t="Failed to load non resumable user session data",r=new Error(t);(0,p.logError)({message:t,tag:["resume"],details:{error:JSON.stringify(e)}}),(0,I.sendExceptionLog)({error:r})}};t.hasTreatProblems=(e,t,r)=>{if(!e.summary)return{transactionsToDownload:[],transactionsToUpload:[]};const o=t.getPersonalData(),{missingLocally:n,missingRemotely:a}=(0,w.getMissingIdentifiers)(r,o,e.summary);return{transactionsToUpload:[...a],transactionsToDownload:[...n]}};const be=async e=>{const t=(0,z.getInstance)(),r=(0,q.getInstance)();let o=null;try{const{storeService:s,applicationModulesAccess:c}=e,u=await(0,A.sync)(e),p=u.clearTransactions||[];if(0!==p.length){o=r.lockTopic("iconsUpdates");const e=p.filter((e=>"AUTHENTIFIANT"===e.type)).map((e=>e.identifier)),u=(e=>e.filter((e=>"SECURITYBREACH"===e.type)).map((e=>e.identifier)))(p),S=0===(i=e).length?null:{type:"credentialUpdates",credentialIds:i};null!==S&&await t.add("iconsUpdates",S);const m=0===(n=u).length?null:{type:"breachUpdates",breachesIds:n};null!==m&&await t.add("iconsUpdates",m);const g=(0,l.applyTransactions)(p);s.dispatch(g),d.reportDataUpdate(s);try{if(c&&(e.length>0||u.length>0)){const{commands:e}=c.createClients().passwordHealth;e.recalculatePasswordHealth()}}catch(e){const t=`Password Health update - sync: ${e}`,r=new Error(t);(0,I.sendExceptionLog)({error:r,code:a.ExceptionCriticality.WARNING})}}return u.uploadedTransactions.length>0&&s.dispatch((0,S.updateLastBackupTime)(u.uploadedTransactions,Math.floor(u.lastSyncTimestamp/1e3))),e.lastSyncTimestamp<A.MAX_SYNC_TIMESTAMP&&s.dispatch((0,E.registerLastSync)(u.lastSyncTimestamp)),u}catch(e){throw e}finally{o&&r.releaseTopic("iconsUpdates",o)}var n,i};t.storeSync=async(e,r)=>{const o=await(async e=>{const{announce:t,personalData:r}=e;try{t(R.announcements.chronologicalSyncStarted(r));const o=await be(e);return t(R.announcements.chronologicalSyncFinished(o.summary,o.fullBackupFileSize)),o}catch(e){throw t(R.announcements.chronologicalSyncFailed(e)),e}})(r);return(async(e,r,o)=>{const{announce:n}=r;n(R.announcements.treatProblemStarted());const{transactionsToDownload:a,transactionsToUpload:i}=(0,t.hasTreatProblems)(o,e,n),s=a.length,c=i.length;if(n(R.announcements.treatProblemDiffComputed(s,c)),s<=0&&c<=0)return n(R.announcements.treatProblemFinished()),o;try{c>0&&e.dispatch((0,S.storeChangesToUpload)(i));const t=await be({...Ie(e,r.dataEncryptorService,r.ws,n),transactionIds:a}),s={...t,clearTransactions:[...t.clearTransactions,...o.clearTransactions]};return n(R.announcements.treatProblemFinished()),s}catch(e){throw n(R.announcements.treatProblemFailed(e)),e}})(e,r,o)};const we=async(e,t,r,o)=>{try{r(R.announcements.teamAdminDataSyncStarted());const n=await(0,O.syncUserGroupManagement)(e,t,o);return r(R.announcements.teamAdminDataSyncFinished()),n}catch(e){throw r(R.announcements.teamAdminDataSyncFailed(e)),e}},Ne=async({storeService:e,dataEncryptorService:r,localStorageService:n,wsService:a,eventLoggerService:c,applicationModulesAccess:d},l,u,p)=>{if(!u.sharing2||!(0,k.ukiSelector)(e.getState()))return u;const S=async t=>{const{userFeatureFlip:r}=d.createClients().featureFlips.queries,u=await(0,o.firstValueFrom)(r({featureFlip:i.SharingSyncFeatureFlips.SharingSyncGrapheneMigrationDev}));if(!(!!(0,s.isSuccess)(u)&&(0,s.getSuccess)(u))){const r=await(async({storeService:e,wsService:t,localStorageService:r,eventLoggerService:o,applicationModulesAccess:n},a,i,s)=>{try{a(R.announcements.sharingSyncStarted());const c=(e,t)=>a(R.announcements.sharingSyncInvalidSyncData(e,t)),d=await(0,h.syncSharing)({storeService:e,wsService:t,localStorageService:r,eventLoggerService:o,applicationModulesAccess:n},i,c,s);return a(R.announcements.sharingSyncFinished()),d}catch(e){throw a(R.announcements.sharingSyncFailed(e)),e}})({storeService:e,wsService:a,localStorageService:n,eventLoggerService:c,applicationModulesAccess:d},l,t,p);return await we(e,a,l,r?(0,me.mapToTeamAdminSharingData)(r):{})}{const{getTeamAdminSharingData:r}=d.createClients().sharingSync.queries,{runSharingSync:n}=d.createClients().sharingSync.commands,{collections:i,itemGroups:c,items:u,userGroups:p}=t;await n({summary:{collections:i??[],itemGroups:c,items:u,userGroups:p}});const S=await(0,o.firstValueFrom)(r());if((0,s.isSuccess)(S)){const t=(0,s.getSuccess)(S);return await we(e,a,l,t)}}};if(await S(u.sharing2)===v.SyncUserGroupManagementStatus.NEEDS_FRESH_SHARING_DATA){const o=Ce(e,r,a),{sharing2:n}=await(0,t.storeSync)(e,{...o,applicationModulesAccess:d,announce:l});await S(n)}return u};t.isSyncInProgress=e=>{const t=e.getState(),r=(0,j.syncIsInProgressSelector)(t),{startTime:o}=(0,j.syncSelector)(t);if(!r)return!1;return Date.now()-(o||0)<6e5?(p.Debugger.log("[Sync] Already in progress, skipping trigger…"),!0):(e.dispatch((0,f.syncFailure)()),(0,I.sendExceptionLog)({message:'[Sync] "inProgress" for more than 10 minutes'}),!1)};const Re=async(e,r,o,n)=>{const{applicationModulesAccess:i,eventBusService:s,localStorageService:c,masterPasswordEncryptorService:l,remoteDataEncryptorService:u,storeService:S,wsService:m,eventLoggerService:g}=e,y=S.getState();if(!S.isAuthenticated())throw new Error("Impossible to Sync - user not authenticated");if((0,t.isSyncInProgress)(S))return;Te=new Promise((e=>ve=e));const A=(0,F.twoFactorAuthenticationInfoSelector)(y);if(A.status===a.TwoFactorAuthenticationInfoRequestStatus.READY){const{shouldEnforceTwoFactorAuthentication:e}=A;if(e)return}const E=(0,j.isRemoteKeyActivatedSelector)(y)?u:l,h=(0,L.setupProbe)((0,M.makeEventLoggerSyncMonitor)().monitor),v={...Ie(S,E,m,h,n),applicationModulesAccess:i},{syncType:T}=v;try{h(R.announcements.syncStarted(n,T)),d.triggerSessionSyncStatus({status:"syncing"}),S.dispatch((0,f.syncStarted)());const e=await(0,t.storeSync)(S,v);return await(0,t.treatKeysResult)(E,S,r,m,h,e),await Ne({storeService:S,dataEncryptorService:E,localStorageService:c,wsService:m,eventLoggerService:g,applicationModulesAccess:i},h,e,n),await E.getInstance().prepareCrypto(),h(R.announcements.saveStarted()),await Be(c,S),h(R.announcements.saveFinished()),s.syncSuccess({}),S.dispatch((0,f.syncSuccess)(e.isUploadEnabled)),d.triggerSessionSyncStatus({status:"success"}),h(R.announcements.syncFinished()),ve(),e.clearTransactions}catch(t){if(S.dispatch((0,f.syncFailure)()),d.triggerSessionSyncStatus({status:"error"}),h(R.announcements.syncFailed(t)),s.syncFailure({}),ve(),t.message===a.AuthenticationCode[a.AuthenticationCode.INVALID_UKI]){const t="[Sync] Device UKI is invalid, closing the session",r=new Error(t);return(0,p.logError)({message:t,details:{error:r}}),(0,I.sendExceptionLog)({error:r}),void Ae(e,o)}throw t}};t.treatKeysResult=async(e,r,o,n,a,i)=>{try{const a=async t=>{if(p.Debugger.log("[Sync] Extract Keys from Sync…"),!t)return null;p.Debugger.log("[Sync] Decipher  private key BEGIN");const r=await e.getInstance().decrypt(t),o=(0,c.deflatedUtf8ToUtf16)(r,{skipInflate:!0});return p.Debugger.log("[Sync] Decipher  private key SUCCESS"),o};if(i.keys&&i.keys.privateKey)try{const e=await a(i.keys.privateKey);r.dispatch((0,C.updateKeyPair)({privateKey:e,publicKey:i.keys.publicKey}))}catch(e){}if(!r.getUserSession().keyPair){const a=await(0,t.generateRsaKeys)(e,o),i=Ce(r,e,n);i.needsKeys=!0,i.syncType=y.SyncType.FULL_SYNC,i.pushKeysToServer={private:a.encryptedPrivateKey,public:a.keys.publicKey},p.Debugger.log("SYNC RSA Keys - BEGIN"),await be(i),p.Debugger.log("SYNC RSA Keys - END"),r.dispatch((0,C.updateKeyPair)({privateKey:a.keys.privateKey,publicKey:a.keys.publicKey}))}}catch(e){throw a(R.announcements.treatSharingKeysFailed(e)),e}};t.generateRsaKeys=async(e,t,r={})=>{try{const o=await t.asymmetricEncryption.generateRsaKeyPair();p.Debugger.log("Generating RSA Keys");const n=(0,c.utf16ToDeflatedUtf8)(o.privateKey,{skipDeflate:!0}),a=await e.getInstance().encrypt(n,r);p.Debugger.log("Encrypt RSA Keys");return{keys:{publicKey:o.publicKey,privateKey:o.privateKey},encryptedPrivateKey:a}}catch(e){throw p.Debugger.log("Error while Generating RSA KEY: "+e),e}};const Me=e=>e.persistData===_.PersistData.PERSIST_DATA_NO,Le=(e,t)=>{const r=t.getLocalSettings(),o=t.getAccountInfo();return Me(o)||!o.isAuthenticated?Promise.resolve():e.getInstance().storeLocalSettings(r)},Ue=async(e,t)=>{const r=t.getPersonalData(),o=t.getAccountInfo();return Me(o)||!o.isAuthenticated?Promise.resolve():e.getInstance().storePersonalData(r)},ke=async(e,t)=>{const r=t.getPersonalSettings(),o=t.getAccountInfo();return Me(o)||!o.isAuthenticated?Promise.resolve():e.getInstance().storePersonalSettings(r)},Fe=(e,t)=>{const r=t.getTeamAdminData(),o=t.getAccountInfo();return Me(o)||!o.isAuthenticated?Promise.resolve():e.getInstance().storeTeamAdminData(r).then((()=>{}))},Be=async(e,t)=>{const r=(0,V.userABTestsSelector)(t.getState()),o=t.getLocalSettings(),n=t.getPersonalSettings(),i=t.getSharingData(),s=(0,j.sharingSyncSelector)(t.getState()),c=t.getAccountInfo(),d=t.getNotificationStatus(),l=t.getTeamAdminData(),u=t.getState(),p=(0,k.sessionKeysSelector)(u),S=(0,j.analyticsIdsSelector)(u);if(Me(c)||!c.isAuthenticated)return Promise.resolve();isNaN(o.lastSync)&&(0,I.sendExceptionLog)({message:"Persisting localSettings with a NaN lastSyncTimestamp",code:a.ExceptionCriticality.WARNING});const m=l?.teams??{},g=Object.keys(m).reduce(((e,t)=>{const r=l.teams[t],o=r.specialItemGroup?(r.specialItemGroup.items||[]).map((e=>e.itemId)):[];return e.concat(o)}),[]),y={...i,items:i.items.map((e=>!e.content||g.includes(e.itemId)?e:{...e,content:""}))};await Promise.all([Ue(e,t),Le(e,t),e.getInstance().storePersonalSettings(n),e.getInstance().storeSharingData(y),e.getInstance().storeSharingSync(s),e.getInstance().storeNotificationsStatus(d),p?e.getInstance().storeAuthenticationKeys(p):Promise.resolve(),e.getInstance().storeTeamAdminData(l),(0,B.persistUserAuthenticationData)(e,t),e.getInstance().storeUserABTests(r),e.getInstance().storeAnalyticsIds(S)])},Ge=async(e,t)=>{try{const r=e.getAccountInfo().login,o=(0,k.ukiSelector)(e.getState()),{result:n,...a}=await t.contactInfo.getContactInfo({login:r,uki:o});e.dispatch((0,Se.accountContactInfoRefreshed)(a))}catch(e){const t="Failed to refreshContactInfo",r=le.CarbonError.fromAnyError(e).addContextInfo("session","refreshContactInfo").addAdditionalInfo({message:t,originalError:e});(0,p.logError)({message:t,details:{error:JSON.stringify(e)}}),(0,I.sendExceptionLog)({error:r})}}},6623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupEncryptorServices=void 0;const o=r(16593),n=r(38981),a=(0,r(64910).getNoDerivationCryptoConfig)(),i="";t.setupEncryptorServices=function(e){const{storeService:t}=e,r=t.getState(),s=(0,o.sessionEncryptorKeysSelector)(r);!function(e,t,r){const{masterPassword:o,serverKey:n}=t;if(!o)return;const[s,c,d]=r?[o,i,a]:[o,n,void 0];e.masterPasswordEncryptorService.setInstance({raw:s},c,d)}(e,s,(0,n.isSSOUserSelector)(r)),function(e,t){const{masterPassword:r,remoteKey:o,serverKey:n}=t;if(!o&&!r)return;const[s,c,d]=o?[o,i,a]:[r,n,void 0];e.remoteDataEncryptorService.setInstance({raw:s},c,d)}(e,s),function(e,t){const{localKey:r,masterPassword:o,serverKey:n}=t;if(!r&&!o)return;const[s,c,d]=r?[r,i,a]:[o,n,void 0];e.localDataEncryptorService.setInstance({raw:s},c,d)}(e,s)}},83060:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupSubscriptions=void 0;const o=r(48062),n=r(18216),a=r(82262),i=r(95551);t.setupSubscriptions=function(e,t){e.appInitialized.on((async e=>{const{sessionService:r,storeService:s}=t;(0,i.isSyncInProgress)(s)&&(s.dispatch((0,a.syncFailure)()),e.initMode===n.InitMode.Resume&&await r.getInstance().user.attemptSync(o.Trigger.Wake))}))}},57903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.waitUntilSyncComplete=void 0;const o=r(95551);t.waitUntilSyncComplete=async e=>{if(!1===(0,o.isSyncInProgress)(e))return!0;return new Promise((t=>{const r=Date.now(),n=setInterval((()=>!1===(0,o.isSyncInProgress)(e)?(clearInterval(n),t(!0)):Date.now()-r>6e4?t(!1):void 0),1e3)}))}},1965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wipeOutLocalAccounts=t.deviceRemoteDeletion=void 0;const o=r(2246),n=r(63739),a=r(46298),i=r(70252),s=r(89160);async function c(e,t,r){const a=r.map((r=>(0,n.deleteAllLocalUserData)(e,t,r))).concat((0,o.deleteUsersPublicSettings)(r));await Promise.all(a)}t.deviceRemoteDeletion=async function(e,t,r){try{const o=await async function(e,t){const{profiles:r,ghostProfiles:o}=await(0,s.getLocalProfiles)(e,t),n=o.map((e=>e.login)).filter(Boolean);if(r.length>0){const t=await(0,a.getUnauthorizedProfiles)(e,{profiles:r});return(0,a.isApiError)(t)?n:[...n,...t.unauthorizedProfiles.map((e=>e.login))]}return n}(e,t);await c(t,r,o)}catch(e){const t=new Error(`[UserManagement]: deviceRemoteDeletion - ${e}`);(0,i.sendExceptionLog)({error:t})}},t.wipeOutLocalAccounts=c},41265:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isInternalTestUser=void 0,t.isInternalTestUser=function(e){const t=e.trim();return t.startsWith("{9a9b9c9d-")||t.startsWith("kw_test_")&&(t.endsWith("@mailinator.com")||t.endsWith("@yopmail.com")||t.endsWith(".kwtest.io"))}},72807:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const o=r(54642),n=r(6637),a=r(82258),i=r(12121);t.config={commands:{dismissUserMessages:{handler:a.dismissUserMessagesHandler},addUserMessage:{handler:i.addUserMessageHandler}},queries:{getVisibleUserMessages:{selector:o.getVisibleUserMessagesSelector},getUserMessages:{selector:o.getUserMessagesSelector}},liveQueries:{liveVisibleUserMessages:{operator:n.liveVisibleUserMessages$},liveUserMessages:{operator:n.liveUserMessages$}}}},65210:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userMessagesDismissed=t.userMessageAdded=t.USER_MESSAGES_DISMISSED=t.USER_MESSAGE_ADDED=void 0,t.USER_MESSAGE_ADDED="USER_MESSAGE_ADDED",t.USER_MESSAGES_DISMISSED="USER_MESSAGES_DISMISSED";t.userMessageAdded=e=>({type:t.USER_MESSAGE_ADDED,userMessage:e});t.userMessagesDismissed=e=>({type:t.USER_MESSAGES_DISMISSED,predicate:e})},54642:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVisibleUserMessagesSelector=t.getUserMessagesByTypeSelector=t.getUserMessagesSelector=void 0;const o=r(32034);t.getUserMessagesSelector=e=>e.userSession.localSettings.userMessages;t.getUserMessagesByTypeSelector=(e,t)=>e.userSession.localSettings.userMessages.filter((e=>e.type===t));t.getVisibleUserMessagesSelector=(0,o.createSelector)(t.getUserMessagesSelector,(e=>e.filter((({dismissedAt:e})=>!e))))},86649:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;const o=r(72807);t.bootstrap=e=>{e.register(o.config)}},12121:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addUserMessageHandler=void 0;const o=r(65210);t.addUserMessageHandler=(e,t)=>(e.storeService.dispatch((0,o.userMessageAdded)({type:t.type})),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},82258:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dismissUserMessagesHandler=void 0;const o=r(65210);t.dismissUserMessagesHandler=(e,t)=>(e.storeService.dispatch((0,o.userMessagesDismissed)(t)),e.sessionService.getInstance().user.persistLocalSettings(),Promise.resolve())},75004:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTrialExpiredUserMessage=t.isTrialExpired=void 0;const o=r(45127);t.isTrialExpired=function({premiumStatus:e,currentDate:t=Date.now()}){switch(e?.statusCode){case o.PremiumStatusCode.PREMIUM:case o.PremiumStatusCode.OLD_ACCOUNT:case o.PremiumStatusCode.NEW_USER:case o.PremiumStatusCode.GRACE_PERIOD:return!1;case o.PremiumStatusCode.PREMIUM_CANCELLED:{const r=1e3*(e.endDate??0);return!!r&&r-t<0}case o.PremiumStatusCode.NO_PREMIUM:default:return!0}},t.createTrialExpiredUserMessage=function(){return{type:o.UserMessageTypes.TRIAL_EXPIRED}}},53156:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bootstrap=void 0;var o=r(86649);Object.defineProperty(t,"bootstrap",{enumerable:!0,get:function(){return o.bootstrap}})},6637:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.liveUserMessages$=t.liveVisibleUserMessages$=void 0;const o=r(18948),n=r(3343),a=r(54642);t.liveVisibleUserMessages$=()=>(0,o.pipe)((0,n.map)(a.getVisibleUserMessagesSelector),(0,n.distinctUntilChanged)());t.liveUserMessages$=()=>(0,o.pipe)((0,n.map)(a.getUserMessagesSelector),(0,n.distinctUntilChanged)())},21614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createUserSettingsLogContent=void 0;const o=r(56915),n=r(16593);t.createUserSettingsLogContent=e=>{const t=(0,o.webAuthnAuthenticationOptedInSelector)(e),r=(0,o.rememberMeFor14DaysOptedInSelector)(e);return{hasAuthenticationWithWebauthn:t,hasCredentialsProtectWithMasterPassword:(0,n.personalSettingsSelector)(e).SecuredDataShowPassword,hasAuthenticationWithRememberMe:r}}},86903:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendUserSettingsLog=void 0;const o=r(48062),n=r(66102),a=r(21614);t.sendUserSettingsLog=async e=>{const t=(0,a.createUserSettingsLogContent)(e.storeService.getState());await(0,n.logEvent)(e,{event:new o.UserUserSettingsEvent({hasAuthenticationWithWebauthn:t.hasAuthenticationWithWebauthn,hasCredentialsProtectWithMasterPassword:t.hasCredentialsProtectWithMasterPassword,hasAuthenticationWithRememberMe:t.hasAuthenticationWithRememberMe})})}},3149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setupUserSettingsLogSubscriptions=void 0;const o=r(86903);t.setupUserSettingsLogSubscriptions=function(e,t){e._sessionOpened.on((()=>{(0,o.sendUserSettingsLog)(t)}))}},35587:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMap=void 0;t.asyncMap=(e,t)=>Promise.all(e.map((e=>t(e))))},30144:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canonizeText=void 0,t.canonizeText=function(e){if(!e)return"";let t=e.trim();return t.normalize&&(t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),t=t.toLowerCase().replace(/[\+_\\\/\?\.\-_{}\[\]\(\)\*&!@#\$~`%\^=\|:,;"'<>]/g," "),t.replace(/\s+/g," ")}},78320:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateItemUuid=void 0;const o=r(35088);t.generateItemUuid=function(){return`{${(0,o.v4)().toUpperCase()}}`}},96997:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return Math.ceil(2e9*Math.random())}},53:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getUnixTimestamp=void 0,t.getUnixTimestamp=function(){return Math.round(Date.now()/1e3)}},28445:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkOrigin=t.removeNonDigitCharacters=t.looksLikeUuid=t.normalizeEmail=t.looksLikeEmail=t.isValidLogin=t.postDataToUrl=t.getClientAgentHeader=void 0;const o=r(66319),n=r(62433),a=r(14656),i=r(86056),s=e=>o.stringify(n.map((e=>Array.isArray(e)?JSON.stringify(e):e),e));function c(e){return`version:${e.appVersion},platform:${e.platformName}}`}t.getClientAgentHeader=c,t.postDataToUrl=async function(e,t,r){const o={headers:{"Client-Agent":c((0,i.getPlatformInfo)()),"Content-Type":"application/x-www-form-urlencoded",...r?.headers??{}},transformRequest:[s],responseType:r?.responseType??"json"};return(0,a.post)(e,t,o)};t.isValidLogin=e=>l(e)||S(e);const d=/^[^\s@]+@([^\s@])+\.([^\s@])+$/i;function l(e){return d.test(e)}t.looksLikeEmail=l;const u=/[<>]/g;t.normalizeEmail=function(e){return e?e.trim().toLowerCase().replace(u,""):""};const p="^{?[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}}?$";function S(e){return new RegExp(p).test(e)}t.looksLikeUuid=S,t.removeNonDigitCharacters=function(e){return"string"==typeof e?e.replace(/\D/g,""):""};t.checkOrigin=e=>{const t=(r=e)?r?.location?.origin:void 0;var r,o;return!t||!t.endsWith((o="LmRhc2hsYW5lLmNvbQ==",atob(o)))}},54218:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=Function.prototype.toString,o=r.call(Object),n=e=>"object"==typeof e&&null!==e,a=Object.prototype,i=a.hasOwnProperty,s=a.toString,c="undefined"!=typeof Symbol?Symbol.toStringTag:void 0;t.default=function(e){if(!n(e)||"[object Object]"!==function(e){if(null===e)return void 0===e?"[object Undefined]":"[object Null]";if(!c||!(c in Object(e)))return s.call(e);const t=i.call(e,c),r=e[c];let o=!1;try{e[c]=void 0,o=!0}catch(e){}const n=s.call(e);return o&&(t?e[c]=r:delete e[c]),n}(e))return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;const a=i.call(t,"constructor")&&t.constructor;return"function"==typeof a&&a instanceof a&&r.call(a)===o}},22376:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnApiConfig=void 0;const o=r(53041),n=r(97657),a=r(25838),i=r(83419),s=r(8522);t.vpnApiConfig={commands:{activateVpnAccount:{handler:o.activateVpnAccountHandler},clearVpnAccountErrors:{handler:n.clearVpnAccountErrorsHandler},completeVpnAccountActivation:{handler:a.completeVpnAccountActivationHandler}},queries:{getVpnAccount:{selector:s.vpnAccountStatusSelector},getVpnCapabilitySetting:{selector:s.vpnCapabilitySettingSelector}},liveQueries:{liveVpnAccount:{operator:i.vpnAccountStatus$}}}},94922:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.openDashlaneVpnAPI=void 0;const o=r(46298),n=r(29301);t.openDashlaneVpnAPI=e=>({generateCredential:async(t,r)=>{const a=await(0,o.generateCredential)(e,t,{email:r});return(0,o.isApiError)(a)?{success:!1,error:a.code===o.GetVpnCredentialBusinessErrors.USER_ALREADY_HAS_AN_ACCOUNT_FOR_PROVIDER?n.VpnErrorType.AccountAlreadyExistError:n.VpnErrorType.ServerError}:{success:!0,password:a.password}}})},29301:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VpnErrorType=void 0,function(e){e.AccountAlreadyExistError="AccountAlreadyExist",e.ServerError="ServerError"}(t.VpnErrorType||(t.VpnErrorType={}))},2749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeVpnLogger=void 0;const o=r(48062),n=r(66102),a=r(29301),i={[a.VpnErrorType.AccountAlreadyExistError]:o.ActivateVpnError.EmailAlreadyInUse,[a.VpnErrorType.ServerError]:o.ActivateVpnError.ServerError};t.makeVpnLogger=e=>({logComplete:async()=>{await(0,n.logEvent)(e,{event:new o.UserActivateVpnEvent({flowStep:o.FlowStep.Complete})})},logError:async t=>{await(0,n.logEvent)(e,{event:new o.UserActivateVpnEvent({flowStep:o.FlowStep.Error,errorName:i[t]})})},logStart:async()=>{await(0,n.logEvent)(e,{event:new o.UserActivateVpnEvent({flowStep:o.FlowStep.Start})})}})},42238:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnAccountNotFoundAction=t.vpnAccountActivationCompleteAction=t.vpnAccountGenerationErrorAction=t.vpnAccountGenerationDoneAction=t.vpnAccountActivatingAction=t.VPN_ACCOUNT_NOT_FOUND=t.VPN_ACCOUNT_GENERATION_ERROR=t.VPN_ACCOUNT_ACTIVATION_COMPLETE=t.VPN_ACCOUNT_GENERATION_DONE=t.VPN_ACCOUNT_ACTIVATING=void 0,t.VPN_ACCOUNT_ACTIVATING="VPN_ACCOUNT_ACTIVATING",t.VPN_ACCOUNT_GENERATION_DONE="VPN_ACCOUNT_GENERATION_DONE",t.VPN_ACCOUNT_ACTIVATION_COMPLETE="VPN_ACCOUNT_ACTIVATION_COMPLETE",t.VPN_ACCOUNT_GENERATION_ERROR="VPN_ACCOUNT_GENERATION_ERROR",t.VPN_ACCOUNT_NOT_FOUND="VPN_ACCOUNT_NOT_FOUND";t.vpnAccountActivatingAction=()=>({type:t.VPN_ACCOUNT_ACTIVATING});t.vpnAccountGenerationDoneAction=()=>({type:t.VPN_ACCOUNT_GENERATION_DONE});t.vpnAccountGenerationErrorAction=e=>({type:t.VPN_ACCOUNT_GENERATION_ERROR,error:e});t.vpnAccountActivationCompleteAction=()=>({type:t.VPN_ACCOUNT_ACTIVATION_COMPLETE});t.vpnAccountNotFoundAction=()=>({type:t.VPN_ACCOUNT_NOT_FOUND})},16667:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnApiBootstrap=void 0;const o=r(22376);t.vpnApiBootstrap=e=>{e.register(o.vpnApiConfig)}},90731:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VPN_CREDENTIAL_NAME=t.VPN_CREDENTIAL_URL=t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN=t.VPN_HOTSPOTSHIELD_DOMAIN=void 0,t.VPN_HOTSPOTSHIELD_DOMAIN="hotspotshield.com",t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN="dashlane",t.VPN_CREDENTIAL_URL=`https://${t.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN}.${t.VPN_HOTSPOTSHIELD_DOMAIN}`,t.VPN_CREDENTIAL_NAME="VPN Hotspot Shield"},53041:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.activateVpnAccountHandler=void 0;const o=r(2749),n=r(94922),a=r(17842);t.activateVpnAccountHandler=async(e,t)=>{const r=(0,a.CreateVpnService)({generator:(0,n.openDashlaneVpnAPI)(e.storeService),logger:(0,o.makeVpnLogger)(e)},e),{user:i}=e.sessionService.getInstance();await r.generateCredential(i,t.email)}},97657:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearVpnAccountErrorsHandler=void 0;const o=r(42238);t.clearVpnAccountErrorsHandler=e=>(e.storeService.dispatch((0,o.vpnAccountNotFoundAction)()),Promise.resolve())},25838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completeVpnAccountActivationHandler=void 0;const o=r(42238);t.completeVpnAccountActivationHandler=e=>(e.storeService.dispatch((0,o.vpnAccountActivationCompleteAction)()),Promise.resolve())},7995:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnCredentialMatcher=void 0;const o=r(15318),n=r(90731);t.vpnCredentialMatcher=e=>{const t=new o.ParsedURL(e.Url);return e.Password&&e.Email&&t&&t.getRootDomain()===n.VPN_HOTSPOTSHIELD_DOMAIN&&t.getSubdomain()===n.VPN_DASHLANE_HOTSPOTSHIELD_SUBDOMAIN}},83419:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnAccountStatus$=void 0;const o=r(18948),n=r(3343),a=r(8522);t.vpnAccountStatus$=function(){const e=a.vpnAccountStatusSelector;return(0,o.pipe)((0,n.map)(e),(0,n.distinctUntilChanged)())}},24827:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VPNReducers=void 0;const o=r(45127),n=r(42238);t.VPNReducers=(e,t)=>{switch(t.type){case n.VPN_ACCOUNT_ACTIVATING:return{accountStatus:{status:o.VpnAccountStatusType.Activating}};case n.VPN_ACCOUNT_GENERATION_DONE:return{accountStatus:{status:o.VpnAccountStatusType.Ready}};case n.VPN_ACCOUNT_GENERATION_ERROR:return{accountStatus:{status:o.VpnAccountStatusType.Error,error:t.error}};case n.VPN_ACCOUNT_ACTIVATION_COMPLETE:return{accountStatus:{status:o.VpnAccountStatusType.Activated}};case n.VPN_ACCOUNT_NOT_FOUND:return{accountStatus:{status:o.VpnAccountStatusType.NotFound}};default:return e??{accountStatus:{status:o.VpnAccountStatusType.NotFound}}}}},8522:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.vpnCapabilitySettingSelector=t.getVpnCapabilitySetting=t.vpnAccountStatusSelector=t.vpnCredentialSelector=void 0;const o=r(45127),n=r(51319),a=r(32034),i=r(16593),s=r(7995),c=(e,t)=>(t.CreationDatetime??0)-(e.CreationDatetime??0);t.vpnCredentialSelector=e=>(0,n.credentialsSelector)(e).filter((e=>(0,s.vpnCredentialMatcher)(e))).sort(c)[0]??null;var d;t.vpnAccountStatusSelector=(0,a.createSelector)((e=>{const{vpnData:t}=e.userSession;return t||{accountStatus:{status:o.VpnAccountStatusType.NotFound}}}),t.vpnCredentialSelector,((e,t)=>{switch(e.accountStatus.status){case o.VpnAccountStatusType.Error:return{status:o.VpnAccountStatusType.Error,error:e.accountStatus.error};case o.VpnAccountStatusType.Activating:return{status:o.VpnAccountStatusType.Activating};case o.VpnAccountStatusType.Activated:case o.VpnAccountStatusType.NotFound:return t?{status:o.VpnAccountStatusType.Activated,email:t.Email,password:t.Password,credentialId:t.Id}:{status:o.VpnAccountStatusType.NotFound};case o.VpnAccountStatusType.Ready:return t?{status:o.VpnAccountStatusType.Ready,email:t.Email,password:t.Password,credentialId:t.Id}:{status:o.VpnAccountStatusType.NotFound}}})),function(e){e.IN_TEAM="in_team",e.NOT_PREMIUM="not_premium",e.NO_PAYMENT="no_payment"}(d||(d={}));const l={in_team:o.VpnDisabledReason.InTeam,not_premium:o.VpnDisabledReason.NotPremium,no_payment:o.VpnDisabledReason.NoPayment};t.getVpnCapabilitySetting=e=>{const t=e?.capabilities?.secureWiFi;if(t.enabled)return{hasVpnEnabled:!0};return{hasVpnEnabled:!1,vpnDisabledReason:l[t.info.reason]||o.VpnDisabledReason.Other}},t.vpnCapabilitySettingSelector=(0,a.createSelector)(i.premiumStatusSelector,t.getVpnCapabilitySetting)},17842:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateVpnService=void 0;const o=r(88544),n=r(45127),a=r(9763),i=r(88779),s=r(92263),c=r(95623),d=r(70252),l=r(16593),u=r(42238),p=r(90731),S=r(29301),m=r(8522),g=({update:{title:e}})=>({Title:e}),y=({title:e})=>({Title:e});t.CreateVpnService=(e,t)=>{const r=async r=>{t.storeService.dispatch((0,u.vpnAccountGenerationErrorAction)(r===S.VpnErrorType.AccountAlreadyExistError?n.VpnAccountActivationErrorType.AccountAlreadyExistError:n.VpnAccountActivationErrorType.ServerError)),await e.logger.logError(r??S.VpnErrorType.ServerError)};return{generateCredential:async(n,S)=>{await e.logger.logStart(),t.storeService.dispatch((0,u.vpnAccountActivatingAction)());try{await Promise.race([n.refreshContactInfo(),new Promise((e=>self.setTimeout(e,1e3)))]);const s=(0,o.contactInfoSelector)(t.storeService.getState()),c=(0,l.userLoginSelector)(t.storeService.getState()),d=S??s.email??c,A=await e.generator.generateCredential(c,d);switch(A.success){case!0:await(async(e,r,o)=>{const n=(0,m.vpnCredentialSelector)(t.storeService.getState()),s={email:e,password:r,url:p.VPN_CREDENTIAL_URL,login:o,title:p.VPN_CREDENTIAL_NAME};if(n){const e={id:n.Id,update:{...s}};await(0,i.updateCredential)({storeService:t.storeService,sessionService:t.sessionService,eventLoggerService:t.eventLoggerService,applicationModulesAccess:t.applicationModulesAccess},e,g)}else await(0,a.createCredential)({storeService:t.storeService,sessionService:t.sessionService,eventLoggerService:t.eventLoggerService,applicationModulesAccess:t.applicationModulesAccess},s,y)})(d,A.password,c),t.storeService.dispatch((0,u.vpnAccountGenerationDoneAction)()),await e.logger.logComplete();break;case!1:r(A.error)}}catch(e){r();const t="VPN",o=s.CarbonError.fromAnyError(e).addContextInfo(t,"saveCredential");(0,c.logError)({tag:[t],message:`${o}`,details:{error:e}}),(0,d.sendExceptionLog)({error:o})}}}}},71012:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.minAcceptablePasswordStrength=void 0,t.minAcceptablePasswordStrength=2},61657:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonEventEmitter=void 0;const n=r(58965);let a=class extends n.ContextlessBaseEventEmitter{};a=o([(0,n.Injectable)()],a),t.CarbonEventEmitter=a},18955:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_TO_IGNORE=void 0;const o=r(45127),n=r(66638),a=r(45619),i=r(46937);t.LEGACY_LEELOO_SLOTS_TO_IGNORE=(0,n.safeCast)(i.LEGACY_LEELOO_SLOTS_ALL.filter((e=>!a.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE.includes(e)&&!(0,n.safeCast)(o.LEGACY_CARBON_LEELOO_USED_COMMANDS).includes(e))))},45619:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.relayLeelooLegacyEvents=t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE=void 0,t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE=["carbonLoginStatusChanged","openSessionTokenSent","openSessionAskMasterPassword","openSessionDashlaneAuthenticator","openSessionOTPSent","openSessionOTPForNewDeviceRequired","openSessionFailed","openSessionSsoRedirectionToIdpRequired","openSessionMasterPasswordLess","ssoSolutionChanged"],t.relayLeelooLegacyEvents=function(e,r){const o=t.LEGACY_LEELOO_EVENTS_TO_SUBSCRIBE.map((t=>e[t].on((async e=>{await r.sendEvent("carbonLegacy",{eventData:e,eventName:t})}))));return()=>{o.forEach((e=>{e()}))}}},46937:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_ALL=t.CarbonLegacyInfrastructure=void 0;const n=r(18948),a=r(45127),i=r(58965);let s=class{constructor(){this.carbon$=new n.ReplaySubject(1),this.carbonState$=this.carbon$.pipe((0,n.switchMap)((e=>e.coreServices.storeService.getState$())))}ready(e){this.carbon$.next(e)}initFailed(e){this.carbon$.error(e)}getCarbon(){return(0,n.firstValueFrom)(this.carbon$)}};s=o([(0,i.Injectable)()],s),t.CarbonLegacyInfrastructure=s,t.LEGACY_LEELOO_SLOTS_ALL=Object.keys(a.CarbonLeelooConnector)},87026:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyBootstrap=void 0;const a=r(58965),i=r(4102),s=r(18948),c=r(61657),d=r(45619),l=r(46937),u=r(96160);let p=class{constructor(e,t,r,o){this.infra=t,this.lifeCycle=r,this.eventEmitter=o;const{setActiveUser:n}=e.getClient(i.requestContextApi).commands;this.setActiveUser=n}onFrameworkInit(){this.lifeCycle.addExternalComponentReadyCondition((async()=>await this.infra.getCarbon())),this.lifeCycle.addAppReadyHook((async()=>{const e=this.infra.carbonState$.pipe((0,s.map)((e=>({account:(0,u.getCarbonLegacyStateSelector)(e,"userSession.account")}))),(0,s.map)((e=>{var t;if((t=e)&&"object"==typeof t&&"account"in t&&t.account&&"object"==typeof t.account&&"login"in t.account&&t.account.login&&"string"==typeof t.account.login&&"isAuthenticated"in t.account&&t.account.isAuthenticated)return e.account.login})),(0,s.distinctUntilChanged)(),(0,s.switchMap)((async e=>{await this.setActiveUser({userName:e})}))).subscribe(),t=await this.infra.getCarbon(),r=(0,d.relayLeelooLegacyEvents)(t.leelooEvents,this.eventEmitter);return()=>{e.unsubscribe(),r()}}))}};p=o([(0,a.FrameworkInit)(),n("design:paramtypes",[a.CqrsClient,l.CarbonLegacyInfrastructure,a.AppLifeCycle,c.CarbonEventEmitter])],p),t.CarbonLegacyBootstrap=p},49112:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyModule=void 0;const n=r(45127),a=r(58965),i=r(92910),s=r(76559),c=r(61657),d=r(46937),l=r(87026),u=r(85642),p=r(50582),S=r(84739),m=r(17459),g=r(13950),y=r(21815),A=r(99971);let f=class{};f=o([(0,a.Module)({api:n.carbonLegacyApi,handlers:{commands:{carbon:i.CarbonCommandHandler,carbonLegacyLeeloo:s.CarbonLegacyLeelooCommandHandler,mitigationDeleteGrapheneUserData:S.DeleteGrapheneUserDataCommandHandler,...(0,g.createHandlersConfigForConnectorCommands)(n.carbonCommandsSlots,g.CarbonApiCommandsHandler)},events:{...(0,a.useEventsOfModule)(y.sessionApi,{sessionOpened:A.SessionOpenedEventHandler})},queries:{carbonState:u.CarbonGetStateQueryHandler,carbonStateList:p.CarbonStateListQueryHandler,...(0,m.createHandlersConfigForCarbonApiQueries)(n.carbonQueriesSlots,n.carbonLiveQueriesSlots)}},configurations:{infrastructure:{token:d.CarbonLegacyInfrastructure}},onFrameworkInit:l.CarbonLegacyBootstrap,providers:[c.CarbonEventEmitter],requiredFeatureFlips:["audit_logs_vault","autofill_web_linkedWebsites","autofill_web_linkedWebsites_dev","breachesFetchWeb","masterPasswordLeakCheckLog","ptu_web_MPprotect_phase3","SAEXAccountRecoveryv3","sharing_web_invalidSignatureAutoRevoke_prod"]})],f),t.CarbonLegacyModule=f},96160:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCarbonLegacyStateSelector=void 0;t.getCarbonLegacyStateSelector=(e,t)=>t?t.split(".").reduce(((e,t)=>{return o=t,"object"==typeof(r=e)&&r&&o in r?e[t]:e;var r,o}),e):e},13950:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHandlersConfigForConnectorCommands=t.CarbonApiCommandsHandler=void 0;const a=r(45127),i=r(66638),s=r(58965),c=r(46937);let d=class{constructor(e){this.infrastructure=e}async execute(e,{name:t}){const{apiEvents:r}=await this.infrastructure.getCarbon(),{body:o}=e,n=await r[t](o);return(0,i.success)(n)}};d=o([(0,s.Injectable)(),n("design:paramtypes",[c.CarbonLegacyInfrastructure])],d),t.CarbonApiCommandsHandler=d,Object.values(a.commandsFromCarbonAPI).forEach((e=>(0,s.CommandHandler)(e)(d))),t.createHandlersConfigForConnectorCommands=function(e,t){return Object.keys(e).reduce(((e,r)=>({...e,[r]:t})),{})}},17459:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHandlersConfigForCarbonApiQueries=t.CarbonApiQueriesHandler=void 0;const a=r(18948),i=r(30504),s=r(66638),c=r(58965),d=r(45127),l=r(46937);let u=class{constructor(e){this.infrastructure=e}execute(e,{name:t}){const{carbonQueryName:r,carbonLiveQueryName:o}=this.getMaybeCarbonQueryNames(t);return(0,a.from)(this.infrastructure.getCarbon()).pipe((0,a.concatMap)((({apiEvents:t})=>(0,a.concat)((0,a.iif)((()=>!!r&&r in t),(0,a.from)(t[r](e.body)),a.EMPTY),(0,a.iif)((()=>!!o&&o in t),new a.Observable((r=>{const n=t[o].on(void 0===e.body?i.DEFAULT_PARAM:e.body,(e=>r.next(e)));return()=>{n()}})),a.EMPTY)))),(0,a.distinctUntilChanged)(),(0,a.map)(s.success))}getMaybeCarbonQueryNames(e){let t,r;return e.startsWith("live")?(r=e,t=`get${e.substring("live".length)}`):t=e,{carbonQueryName:t,carbonLiveQueryName:r}}};u=o([(0,c.Injectable)(),n("design:paramtypes",[l.CarbonLegacyInfrastructure])],u),t.CarbonApiQueriesHandler=u,Object.values(d.queriesFromCarbonAPI).forEach((e=>(0,c.QueryHandler)(e)(u))),t.createHandlersConfigForCarbonApiQueries=function(e,t){return[...Object.keys(e),...Object.keys(t)].reduce(((e,t)=>({...e,[t]:u})),{})}},92910:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonCommandHandler=void 0;const a=r(45127),i=r(58965),s=r(46937),c=r(61657),d=r(20211);let l=class{constructor(e,t,r){this.infra=e,this.eventsEmitter=t,this.context=r}async execute({body:{args:e,name:t,fireEvent:r}}){const o=(await this.infra.getCarbon()).apiEvents[t],n=await o(...e),a=(0,d.carbonResultToModuleResult)(n);return r&&await this.eventsEmitter.sendEvent("carbonCommandResult",{result:n},this.context),a}};l=o([(0,i.CommandHandler)(a.CarbonCommand),n("design:paramtypes",[s.CarbonLegacyInfrastructure,c.CarbonEventEmitter,i.RequestContext])],l),t.CarbonCommandHandler=l},76559:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonLegacyLeelooCommandHandler=void 0;const a=r(45127),i=r(58965),s=r(46937),c=r(61657),d=r(20211);let l=class{constructor(e,t){this.infra=e,this.eventsEmitter=t}async execute({body:{arg:e,name:t,fireEvent:r}}){const o=(await this.infra.getCarbon()).leelooEventsCommands[t],n=await o(...e),a=(0,d.carbonResultToModuleResult)(n);return r?(await this.eventsEmitter.sendEvent("carbonCommandResult",{result:n}),a):a}};l=o([(0,i.CommandHandler)(a.CarbonLegacyLeelooCommand),n("design:paramtypes",[s.CarbonLegacyInfrastructure,c.CarbonEventEmitter])],l),t.CarbonLegacyLeelooCommandHandler=l},85642:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonGetStateQueryHandler=void 0;const a=r(62760),i=r(18948),s=r(45127),c=r(58965),d=r(66638),l=r(46937),u=r(96160);let p=class{constructor(e){this.infrastructure=e}execute({body:{path:e}}){const{carbonState$:t}=this.infrastructure;return t.pipe((0,i.map)((t=>(0,u.getCarbonLegacyStateSelector)(t,e))),(0,i.distinctUntilChanged)(((e,t)=>(0,d.isObject)(e)&&(0,d.isObject)(t)?(0,a.shallowEqual)(e,t):Object.is(e,t))),(0,i.map)(d.success))}};p=o([(0,c.QueryHandler)(s.CarbonStateQuery),n("design:paramtypes",[l.CarbonLegacyInfrastructure])],p),t.CarbonGetStateQueryHandler=p},50582:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CarbonStateListQueryHandler=void 0;const a=r(18948),i=r(62760),s=r(45127),c=r(58965),d=r(66638),l=r(46937),u=r(96160);let p=class{constructor(e){this.infrastructure=e}execute({body:{paths:e}}){const{carbonState$:t}=this.infrastructure;return t.pipe((0,a.map)((t=>e.map((e=>(0,u.getCarbonLegacyStateSelector)(t,e))))),(0,a.distinctUntilChanged)(i.shallowEqual),(0,a.map)(d.success))}};p=o([(0,c.QueryHandler)(s.CarbonStateListQuery),n("design:paramtypes",[l.CarbonLegacyInfrastructure])],p),t.CarbonStateListQueryHandler=p},84739:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteGrapheneUserDataCommandHandler=void 0;const a=r(45127),i=r(58965),s=r(66638),c=r(61657);let d=class{constructor(e,t){this.infra=e,this.emitter=t}async execute({body:{login:e}}){await this.emitter.sendEvent("CarbonLegacyDeviceRemotelyDeleted",{user:e});const t=await this.infra.getAllKeys(),r=`.${e}`,o=t.filter((e=>e.endsWith(r))).map((async e=>await this.infra.remove(e)));return await Promise.allSettled(o),(0,s.success)(null)}};d=o([(0,i.CommandHandler)(a.MitigationDeleteGrapheneUserDataCommand),n("design:paramtypes",[i.KeyValueStorageInfrastructure,c.CarbonEventEmitter])],d),t.DeleteGrapheneUserDataCommandHandler=d},20211:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.carbonResultToModuleResult=void 0;const o=r(66638),n=e=>{if("error"in e)return e.error;const{success:t,...r}=e;return r};t.carbonResultToModuleResult=e=>(e=>!(!e||"object"!=typeof e)&&"success"in e&&!1===e.success)(e)?(0,o.failure)({tag:"",error:n(e)}):(0,o.success)({id:"",carbonResult:e})},99971:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionOpenedEventHandler=void 0;const a=r(58965),i=r(21815),s=r(46937);let c=class{constructor(e){this.infra=e}async handle({body:{login:e}}){(await this.infra.getCarbon()).coreServices.eventBusService._sessionOpened({login:e})}};c=o([(0,a.EventHandler)(i.SessionOpenedEvent),n("design:paramtypes",[s.CarbonLegacyInfrastructure])],c),t.SessionOpenedEventHandler=c},71439:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_LEELOO_SLOTS_TO_IGNORE=t.CarbonLegacyInfrastructure=t.CarbonLegacyModule=void 0;var o=r(49112);Object.defineProperty(t,"CarbonLegacyModule",{enumerable:!0,get:function(){return o.CarbonLegacyModule}});var n=r(46937);Object.defineProperty(t,"CarbonLegacyInfrastructure",{enumerable:!0,get:function(){return n.CarbonLegacyInfrastructure}});var a=r(18955);Object.defineProperty(t,"LEGACY_LEELOO_SLOTS_TO_IGNORE",{enumerable:!0,get:function(){return a.LEGACY_LEELOO_SLOTS_TO_IGNORE}})},48749:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setConfig=t.config=t.DashlaneAPISchemesNames=void 0;const o=r(4407);var n;!function(e){e.DASHLANE_API_HOST_WITH_SCHEME="DASHLANE_API_HOST_WITH_SCHEME",e.DASHLANE_WS_HOST_WITH_SCHEME="DASHLANE_WS_HOST_WITH_SCHEME"}(n=t.DashlaneAPISchemesNames||(t.DashlaneAPISchemesNames={}));const a={LOG_LEVEL:o.Silent,LOG_TAGS:[],DASHLANE_API_HOST_WITH_SCHEME:"https://api.dashlane.com",DASHLANE_WS_HOST_WITH_SCHEME:"https://ws1.dashlane.com",DASHLANE_STYX_HOST_WITH_SCHEME:"https://styx.data.dashlane.com",CODE_NAME:null,MANIFEST_VERSION:null};t.config=a;const i=e=>(Object.values(n).forEach((t=>{t in e&&!e[t]&&(e[t]=a[t])})),e);t.setConfig=e=>{t.config={...t.config,...i(e)}}},92912:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createAccount=t.getCreateAccountRequest=t.defaultCreateAccountRequestParams=t.AUTOMATION_MP_GRACE_PERIOD=t.DEFAULT_E2E_ACCOUNT_PASSWORD=void 0;const o=r(78320),n=r(78955),a=r(56292);function i(e,r,o){return{login:e,anonymousUserId:o,password:r,...t.defaultCreateAccountRequestParams}}t.DEFAULT_E2E_ACCOUNT_PASSWORD="Azerty12",t.AUTOMATION_MP_GRACE_PERIOD=5e3,t.defaultCreateAccountRequestParams={format:"US",language:"en",subscribe:!1,deviceName:"INTEGRATION_TEST"},t.getCreateAccountRequest=i,t.createAccount=async function(e,r,s){const c=r??{},d={...i((0,n.getLogin)(),t.DEFAULT_E2E_ACCOUNT_PASSWORD,(0,o.generateItemUuid)()),...c},l={createAccountResult:await e.createAccountStep1(d),options:{flowIndicator:"webAccount"},isStandAlone:!0,...s??{}},u=await e.createAccountStep2(l);return await(0,a.sync)(e),u}},78955:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLogin=t.defaultTestAccountOptions=void 0;const o=r(35088),n=r(55995);t.defaultTestAccountOptions={abTests:{},automationAccount:!1,featureFlips:[],throttling:n.TestAccountThrottlingBehaviour.Unthrottled,type:n.TestAccountType.FreePremiumTrial},t.getLogin=function(e=t.defaultTestAccountOptions){const{abTests:r=t.defaultTestAccountOptions.abTests,featureFlips:a=t.defaultTestAccountOptions.featureFlips,throttling:i=t.defaultTestAccountOptions.throttling,type:s=t.defaultTestAccountOptions.type,automationAccount:c=t.defaultTestAccountOptions.automationAccount}=e,d=(0,o.v4)(),l=d.substr(0,d.indexOf("-")),u=function(e){switch(e){case n.TestAccountThrottlingBehaviour.Unthrottled:return"ut_";case n.TestAccountThrottlingBehaviour.Normal:default:return""}}(i),p=function(e){switch(e){case n.TestAccountType.Free:return"freefree_";case n.TestAccountType.PremiumPaid:return"premiumpaid_";case n.TestAccountType.Family:return"family_";case n.TestAccountType.FreePremiumTrial:default:return""}}(s),S=!1===(m=r)?"noabtest_":Object.keys(m).reduce(((e,t)=>{const r=`${t}_${m[t]}_`;return e.concat(r)}),"");var m;const g=function(e){return e.reduce(((e,t)=>{const r=`${t}_`;return e.concat(r)}),"")}(a);return("kw_test_"+function(e){return e?"auto_":""}(c)+u+p+"carbon_e2e_"+S+g+l+"@mailinator.com").toLocaleLowerCase()}},55995:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TestAccountThrottlingBehaviour=t.TestAccountType=void 0,function(e){e[e.Free=0]="Free",e[e.FreePremiumTrial=1]="FreePremiumTrial",e[e.Legacy=2]="Legacy",e[e.PremiumPaid=3]="PremiumPaid",e[e.PremiumPlus=4]="PremiumPlus",e[e.Family=5]="Family"}(t.TestAccountType||(t.TestAccountType={})),function(e){e[e.Normal=0]="Normal",e[e.Unthrottled=1]="Unthrottled"}(t.TestAccountThrottlingBehaviour||(t.TestAccountThrottlingBehaviour={}))},70420:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(92912),t),n(r(78955),t),n(r(55995),t)},76506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e=2e3){return new Promise((t=>setTimeout(t,e)))}},71602:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceProviderToken=void 0;const o=r(43739),n=r(46298),a=r(97343),i=r(25576);t.getServiceProviderToken=async(e,t)=>{const{storeService:r}=e;!function(e,t){e.dispatch((0,o.deviceRegistered)((0,o.makeDeviceRegistrationKeys)(t.deviceAccessKey,t.deviceSecretKey),i.PersistData.PERSIST_DATA_YES,t.login))}(r,t);const{login:s,teamUuid:c,deviceAccessKey:d,deviceSecretKey:l}=t,u=`${c}%${t.userServiceProviderKey}`,p=await(0,a.getUserSSOInfo)(r,{login:s,teamUuid:c,teamDeviceAccessKey:d,teamDeviceSecretKey:l,userServiceProviderKey:u});if((0,n.isApiError)(p))throw new Error(`Error: ${p.code}`);return p}},32006:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forceBreachRefreshHandler=void 0;const o=r(95303);t.forceBreachRefreshHandler=async({applicationModulesAccess:e,storeService:t,wsService:r})=>{const n=(0,o.getInstance)(e,t,r);await n.refresh({forceRefresh:!0})}},79734:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPublicBreachHelper=t.addPrivateBreachHelper=t.createOrUpdateDarkWebBreachHelper=t.saveBankAccount=t.updateCredential=t.getNotes=t.getCredentials=t.saveCredential=void 0;const o=r(35088),n=r(45127),a=r(46298),i=r(77074),s=r(31197),c=r(72579),d=r(76506),l=r(70420);async function u(e,t,r={}){const o=function({title:e,email:t,password:r,url:o,...a}){return{kwType:"KWAuthentifiant",origin:n.SaveOrigin.MANUAL,content:{category:"",email:t,login:t,onlyForThisSubdomain:!1,password:r,protectWithMasterPassword:!1,secondaryLogin:"",url:o??"",title:e,autoLogin:!1,note:"",spaceId:"",linkedWebsites:{addedByDashlane:[],addedByUser:[]},...a}}}({...{title:"title",email:"email@domain.com",password:l.DEFAULT_E2E_ACCOUNT_PASSWORD},...r}),a=t??o;await e.savePersonalDataItem(a),await(0,d.default)(100)}t.saveCredential=u,t.getCredentials=async function(e){return e.getCredentials({filterToken:{filterCriteria:[]},sortToken:{sortCriteria:[],uniqField:"id"}})},t.getNotes=async function(e){return e.getNotes({filterToken:{filterCriteria:[]},sortToken:{sortCriteria:[],uniqField:"id"}})},t.updateCredential=function(e,{id:t,title:r,email:o,url:n,password:a},i){return u(e,void 0,{id:t,title:r,email:o,password:a,url:n,...i})},t.saveBankAccount=async function(e,t,r={}){const o={kwType:"KWBankStatement",origin:n.SaveOrigin.MANUAL,content:{name:"name",owner:"owner",IBAN:"",BIC:"",bank:"",...r,...t}},a=t??o;await e.savePersonalDataItem(a),await(0,d.default)(100)};t.createOrUpdateDarkWebBreachHelper=async({storeService:e},t)=>{t.databreach.uuid||(t.databreach.uuid=(0,o.v4)());const r=await(0,i.createOrUpdateDarkWebBreach)(e,t);if((0,a.isApiError)(r))throw new Error(`Error when creating / updating test data breach: ${r.message}`);return t.databreach.uuid};t.addPrivateBreachHelper=async({storeService:e},t)=>await(0,s.addPrivateBreach)(e,t);t.createPublicBreachHelper=async({storeService:e},t)=>{const r=await(0,c.createPublicBreach)(e,t);if((0,a.isApiError)(r))throw new Error(`Error when creating test breach: ${r.code}, ${r.message}`);return r}},56292:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sync=t.waitForSync=void 0;const o=r(76506),n=3e4;function a(e,t={timeout:n}){let r,o;const a=setTimeout((()=>{o(new Error("Sync timed out"))}),t.timeout),i=new Promise(((e,t)=>{r=e,o=t})),s=e.sessionSyncStatus.on((({status:e})=>{"syncing"!==e&&(clearTimeout(a),s(),"success"===e?r():"error"===e&&o(new Error("Sync failed")))}));return i}t.waitForSync=a,t.sync=async function(e){await e.sessionForceSync({}),await a(e),await(0,o.default)()}},25601:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.DashlaneAPISchemesNames=t.HttpErrorCode=t.init=t.CarbonStorage=t.decipherDatabaseRules=t.interfaces=void 0,t.interfaces=r(92231);var a=r(5851);Object.defineProperty(t,"decipherDatabaseRules",{enumerable:!0,get:function(){return a.decipherDatabaseRules}}),n(r(4673),t);var i=r(18539);Object.defineProperty(t,"CarbonStorage",{enumerable:!0,get:function(){return i.CarbonLocalStorage}});var s=r(9265);Object.defineProperty(t,"init",{enumerable:!0,get:function(){return s.init}});var c=r(14656);Object.defineProperty(t,"HttpErrorCode",{enumerable:!0,get:function(){return c.HttpErrorCode}});var d=r(48749);Object.defineProperty(t,"DashlaneAPISchemesNames",{enumerable:!0,get:function(){return d.DashlaneAPISchemesNames}}),n(r(71439),t)},9265:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const o=r(17338),n=r(74318);t.init=async function(e){const t=await(0,n.initCarbon)(e);return(0,o.getCoreServices)(t)}}}]);