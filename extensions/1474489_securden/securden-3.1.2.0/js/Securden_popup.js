window.browser=window.msBrowser||window.browser||window.chrome;var Securden_Popup={tab:{id:"",url:""},accountId:null,accountTitle:null,accountName:null,accountViewPermission:!1,accountRemotePermission:!1,serverUrl:null,authToken:null,successFunc:null,showPasswordTimeout:null,pageStart:1,pageLimit:200,loadMore:!0,productVersion:null,userName:null,domain_id:null,fileName:null,fileColumnName:null,validateTicketIdForCopy:!1,validateTicketIdForView:!1,validateTicketIdForAutologon:!1,validateTicketIdForAutologonOpenNewTab:!1,validateTicketIdForRemoteConnection:!1,validateTicketIdForFileDownload:!1,fromAccountDetailsPage:!1,fromDomainComputersListPage:!1,fromAddAccountPage:!1,assetRadioButtonShown:!1,RDPTemplates:["WindowsDomain","WindowsLocal","WindowsLocalRemote","WindowsDomainRemote","WindowsMemberRemote","WindowsRDPOnly","WindowsWorkgroupRemote","WindowsWorkgroup","WindowsMember","AzureAdTemplate","AzureAdRemoteTemplate"],SSHTemplates:["Linux","Mac","LinuxNonRemoteTemplate","MacNonRemoteTemplate","SSHDevices"],SQLTemplates:["SQLServerRemote","SQLServer","OracleTemplate","OracleRemote"],windowsDomainTemplates:["WindowsDomain","WindowsDomainRemote","AzureAdTemplate","AzureAdRemoteTemplate"],OracleTemplates:["OracleTemplate","OracleRemote"],computerDns:null,submitButtonClicked:!1,twofactorSubmitButtonClicked:!1,isPersonalAccount:!1,addAccountButtonClicked:!1,policyId:null,accountTypeId:null,isEditAccount:!1,changePasswordButtonClicked:!1,fileTemplates:["FileStore","SSHKeys"],isFolderNeeded:!1,isFilterBy:!1,isFilterByType:!1,filterByValue:"",stateCheck:"",validateToken:!1,tokenSubmitted:!1,tokenMessage:"",accountColorCodeList:{"#ffe9e7":"colorRed","#fffccf":"colorYellow","#eaf2ff":"colorDBlue","#e0fff8":"colorLBlue","#eaffd2":"colorGreen","#f3e7ff":"colorPurple"},accountMenuAdded:!1,deviceTypes:void 0,sshConnection:!1,otherLoginWindowId:null,checkRequestTimeout:!1,formFieldsFormCount:0,formFieldsFormCountInitial:0,oldAccountTypeId:null,additionalFieldValuePresent:!1,ALL_ACCOUNTS_ID:"All Accounts",topFolderId:"All Accounts",showPersonalDomainAccContextMenu:!1,org_name:"",totp:!1,enforceReasonOnPasswordRetrieve:null,ticketingSystem:null,ticketIdLabel:null,accountIdForTicket:null,statusCode:null,workText:null,isMspEdition:!1,currentOrgId:null,currentOrgName:null,isEditableFields:!1,recordStored:null,recordDeleted:!1,webAccount:"Web Account",addAccountAvailable:!1,init:function(){window.addEventListener("load",(function(){browser.tabs.query({active:!0,currentWindow:!0},(function(e){SecurdenExtensionUtils.initializeTexts(),Securden_Popup.getServerUrl(),Securden_Popup.tab.id=e[0].id,Securden_Popup.tab.url=e[0].url,browser.runtime.onMessage.addListener(Securden_Popup.processRequest),SecurdenExtensionUtils.sendMessage(null,"checkRecordInStorage",{}),$("#login_button").click((function(e){Securden_Popup.submitButtonClicked||Securden_Popup.loginSubmit(),Securden_Popup.submitButtonClicked=!1})),$("#login_form").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.loginSubmit(),Securden_Popup.submitButtonClicked=!0)})),$("#twofactor_form").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.twofactorSubmit(),Securden_Popup.twofactorSubmitButtonClicked=!0)})),$("#twofactor_button").click((function(e){Securden_Popup.twofactorSubmitButtonClicked||Securden_Popup.twofactorSubmit(),Securden_Popup.twofactorSubmitButtonClicked=!1})),$("#twofactor_configure_button").click((function(e){Securden_Popup.twofactorConfigureSubmit()})),$("#logout_button").click((function(e){Securden_Popup.logout()})),$("#logout_button_inside_user_details").click((function(e){Securden_Popup.closeUserDetails(),Securden_Popup.logout()})),$("#generate_password_div").click((function(e){Securden_Popup.showGeneratePasswordPage()})),$("#generate_password_inside_user_details").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.closeUserDetails(),Securden_Popup.showGeneratePasswordPage()})),$("#form_field_save_inside_user_details").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.formFieldsForSave=null,Securden_Popup.closeUserDetails(),SecurdenExtensionUtils.resetRadioButton("form_field_scope_global_icon_id","form_field_scope_global_icon_id_hidden_id","form_field_scope_text_owned_icon_id","form_field_scope_owned_icon_id_hidden_id"),Securden_Popup.showSaveFormFieldsForm()})),$("#proceed_to_map_input_page").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.formFieldsForSave=null,Securden_Popup.closeUserDetails(),SecurdenExtensionUtils.resetRadioButton("form_field_scope_global_icon_id","form_field_scope_global_icon_id_hidden_id","form_field_scope_text_owned_icon_id","form_field_scope_owned_icon_id_hidden_id"),Securden_Popup.showSaveFormFieldsForm()})),$("#delete_recording").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.deleteRecordings(),$("#recorded_url_fields_id").addClass("hide")})),$("#record_form_field_inside_user_details").click((function(e){Securden_Popup.recordStored?Securden_Popup.deleteRecordings():(Securden_Popup.recordDeleted&&(SecurdenExtensionUtils.sendMessage(null,"reloadContentScript",{tabId:Securden_Popup.tab.id}),Securden_Popup.recordDeleted=!1),Securden_Popup.record())})),$("#user_details_div").click((function(e){Securden_Popup.userDetails()}));var t=!0;$("#top_folders_div").click((function(e){t?(Securden_Popup.getTopFolders(),t=!1):(Securden_Popup.closeTopFoldersDiv,t=!0)})),$("#save_server_url").click((function(e){Securden_Popup.saveServerUrl()})),$("#serverUrl").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.saveServerUrl())})),$("#go_back_button").click((function(e){Securden_Popup.goBackToServerUrl()})),$("#back_to_server_url_id").click((function(e){Securden_Popup.goBackToServerUrl()})),$("#other_login_form_back_to_server_url_id").click((function(e){Securden_Popup.goBackToServerUrl()})),$("#search_parent").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.searchAccounts())})),$("#clear_search_text_button_div").click((function(e){Securden_Popup.clearSearch()})),$("#validateTicketIdSubmit").click((function(e){Securden_Popup.validateTicketIdAndReason(!0,!1)})),$("#ticket_id_div").keydown((function(e){if(13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),!Securden_Popup.validateTicketIdForCopy)){Securden_Popup.validateTicketIdAndReason(!0,!1)}})),$("#validateReasonSubmit").click((function(e){Securden_Popup.validateTicketIdAndReason(!1,!0)})),$("#id_reason").keydown((function(e){if(13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),!Securden_Popup.validateTicketIdForCopy)){Securden_Popup.validateTicketIdAndReason(!1,!0)}})),$("#validateTicketIdReasonSubmit").click((function(e){Securden_Popup.validateTicketIdAndReason(!0,!0)})),$("#id_ticket_id_with_reason").keydown((function(e){if(13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),!Securden_Popup.validateTicketIdForCopy)){Securden_Popup.validateTicketIdAndReason(!0,!0)}})),$("#id_reason_with_ticket_id").keydown((function(e){if(13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),!Securden_Popup.validateTicketIdForCopy)){Securden_Popup.validateTicketIdAndReason(!0,!0)}})),$("#validateTicketIdCancel").click((function(e){Securden_Popup.closeTicketIdDiv()})),$("#validateReasonCancel").click((function(e){Securden_Popup.closeTicketIdDiv()})),$("#validateTicketIdReasonCancel").click((function(e){Securden_Popup.closeTicketIdDiv()})),$("#resend_otp_id").click((function(e){Securden_Popup.resendOtp()})),$("#otp_logout_btn_id").click((function(e){Securden_Popup.logout()})),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("OTP_ERROR_MESSAGE",Securden_Popup.productVersion)&&$("#otp_message_logout_btn_id").click((function(e){Securden_Popup.logout()})),$("#add_account_button").click((function(e){Securden_Popup.addAccountButtonClick()})),$("#add_account_save_button").click((function(e){Securden_Popup.addAccountButtonClicked||(Securden_Popup.isEditAccount?Securden_Popup.validateFormAndEditAccount():Securden_Popup.checkAccountValues()),Securden_Popup.addAccountButtonClicked=!1})),$("#add_account_form").keydown((function(e){if(13==e.keyCode){var t=e.target;SecurdenExtensionUtils.checkIfIDPresentInsideElement(t,"id_notes")||(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.isEditAccount?Securden_Popup.validateFormAndEditAccount():Securden_Popup.checkAccountValues(),Securden_Popup.addAccountButtonClicked=!0)}})),$("#add_account_cancel_button").click((function(e){$("#id_title").val(""),Securden_Popup.removeBackButton()})),$("#account_classification_work_id").click((function(e){if($("#account_classification_work_id").hasClass("schedule-uncheck")){Securden_Popup.selectAccountCategory(!0)}})),$("#account_classification_personal_id").click((function(e){if($("#account_classification_personal_id").hasClass("schedule-uncheck")){Securden_Popup.selectAccountCategory(!1)}})),$("#form_field_scope_global_id").click((async function(e){Securden_Popup.formFieldIsGlobalConfig=!0,SecurdenExtensionUtils.toggleRadioButton("form_field_scope_global_icon_id","form_field_scope_global_icon_id_hidden_id","form_field_scope_text_owned_icon_id","form_field_scope_owned_icon_id_hidden_id"),SecurdenExtensionUtils.resetRadioButton("form_field_scope_account_classification_work_icon_id","form_field_scope_account_classification_work_icon_id_hidden_id","form_field_scope_account_classification_personal_icon_id","form_field_scope_account_classification_personal_icon_id_hidden_id");var t=await Securden_Popup.sendRequest({action:"get_if_work_personal_available",onFailureFunc:"errorMsgFunction"}).then((e=>e)),n=Securden_Popup.work_text;null!=n&&(n=n.charAt(0).toUpperCase()+n.slice(1),$("#form_field_classification_text_work_id").text(n));var o=[],i=[];t.add_work_available&&t.add_personal_available?(o.push("form_field_account_classification_wrap_id"),i.push("form_fields_body_wrap")):t.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,o.push("form_fields_body_wrap"),i.push("form_field_account_classification_wrap_id")):t.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,o.push("form_fields_body_wrap"),i.push("form_field_account_classification_wrap_id")),SecurdenExtensionUtils.showHide(o,i)})),$("#form_field_scope_owned_id").click((async function(e){Securden_Popup.formFieldIsGlobalConfig=!1,SecurdenExtensionUtils.toggleRadioButton("form_field_scope_text_owned_icon_id","form_field_scope_owned_icon_id_hidden_id","form_field_scope_global_icon_id","form_field_scope_global_icon_id_hidden_id"),SecurdenExtensionUtils.resetRadioButton("form_field_scope_account_classification_work_icon_id","form_field_scope_account_classification_work_icon_id_hidden_id","form_field_scope_account_classification_personal_icon_id","form_field_scope_account_classification_personal_icon_id_hidden_id");var t=await Securden_Popup.sendRequest({action:"get_if_work_personal_available",onFailureFunc:"errorMsgFunction"}).then((e=>e)),n=Securden_Popup.work_text;null!=n&&(n=n.charAt(0).toUpperCase()+n.slice(1),$("#form_field_classification_text_work_id").text(n));var o=[],i=[];t.add_work_available&&t.add_personal_available?(o.push("form_field_account_classification_wrap_id"),i.push("form_fields_body_wrap")):t.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,o.push("form_fields_body_wrap"),i.push("form_field_account_classification_wrap_id")):t.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,o.push("form_fields_body_wrap"),i.push("form_field_account_classification_wrap_id")),SecurdenExtensionUtils.showHide(o,i)})),$("#form_field_account_classification_work_id").click((function(e){SecurdenExtensionUtils.toggleRadioButton("form_field_scope_account_classification_work_icon_id","form_field_scope_account_classification_work_icon_id_hidden_id","form_field_scope_account_classification_personal_icon_id","form_field_scope_account_classification_personal_icon_id_hidden_id"),Securden_Popup.formFieldIsPersonalAccount=!1,Securden_Popup.recordStored?Securden_Popup.setRecordedInputData():Securden_Popup.setFormFieldsForSave(),SecurdenExtensionUtils.showHide(["form_field_account_classification_wrap_id","form_fields_body_wrap"],[])})),$("#form_field_account_classification_personal_id").click((function(e){SecurdenExtensionUtils.toggleRadioButton("form_field_scope_account_classification_personal_icon_id","form_field_scope_account_classification_personal_icon_id_hidden_id","form_field_scope_account_classification_work_icon_id","form_field_scope_account_classification_work_icon_id_hidden_id"),Securden_Popup.formFieldIsPersonalAccount=!0,Securden_Popup.recordStored?Securden_Popup.setRecordedInputData():Securden_Popup.setFormFieldsForSave(),SecurdenExtensionUtils.showHide(["form_field_account_classification_wrap_id","form_fields_body_wrap"],[])})),$("#confirmAction").click((function(e){Securden_Popup.confirmAction()})),$("#confirmCancel").click((function(e){Securden_Popup.confirmCancel()})),$("#change_account_password_save_button").click((function(e){Securden_Popup.changePasswordButtonClicked||Securden_Popup.changeAccountPasswordCheck(),Securden_Popup.changePasswordButtonClicked=!1})),$("#change_account_password_form").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.changeAccountPasswordCheck(),Securden_Popup.changePasswordButtonClicked=!0)})),$("#change_account_password_cancel_button").click((function(e){Securden_Popup.removeBackShowAccountDetailsButton()})),$("#remote_checkbox_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("remote_checkbox_icon_id","change_password_is_remote")})),$("#remote_checkbox_text").click((function(e){SecurdenExtensionUtils.toggleCheckbox("remote_checkbox_icon_id","change_password_is_remote")})),$("#change_account_password_error_try_again").click((function(e){Securden_Popup.showChangePasswordPage(e,Securden_Popup.accountId)})),$("#clear_filter_button_div").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.clearFilter()})),$("#account_menu_button").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e)})),$("#close_user_details_btn").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.closeUserDetails()})),$("#close_top_folders_container_btn").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.closeTopFoldersDiv()})),$("#add_accounts_div").click((function(e){var t=e.target;SecurdenExtensionUtils.checkIfIDPresentInsideElement(t,"folders_wrappers_div")||SecurdenExtensionUtils.checkIfIDPresentInsideElement(t,"add_account_folders_wrap")||SecurdenExtensionUtils.showHide([],["add_account_folders_wrap"])})),$("#show_password_id_generate_password_pwd").click((function(e){Securden_Popup.showPasswordInputElement(e,"id_generate_password_pwd")})),$("#hide_password_id_generate_password_pwd").click((function(e){Securden_Popup.hidePasswordInputElement(e,"id_generate_password_pwd")})),$("#copy_password_id_generate_password_pwd").click((function(e){Securden_Popup.copyPasswordElement(e,"id_generate_password_pwd")})),$("#generate_password_generate_button").click((function(e){Securden_Popup.generatePasswordWithRules()})),$("#generate_password_cancel_button").click((function(e){Securden_Popup.removeBackButton()})),$("#show_advanced_password_generator_options").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.showAdvancedPassGeneratorOptions()})),$("#trust_browser_validity_checkbox_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("trust_browser_validity_checkbox_icon_id","trust_browser_hidden_id")})),$("#trust_browser_span_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("trust_browser_validity_checkbox_icon_id","trust_browser_hidden_id")})),$("#form_field_save_button").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.saveFormFields()})),$("#form_field_cancel_button").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.removeBackFormFieldSave()})),$("#launch_personal_domain_remote_connection_wrap").click((async function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=Securden_Popup.personalDomainAccContextMenuOptions,n=e.target;if(!SecurdenExtensionUtils.isParamValid(t)){var o={os:SecurdenExtensionUtils.getOs()},i=await Securden_Popup.sendRequest({action:"get_available_connections_for_user",data:o,onFailureFunc:"errorMsgFunction"}).then((e=>e));SecurdenExtensionUtils.isParamValid(i)&&(t=i.remote_actions,SecurdenExtensionUtils.personalDomainAccContextMenuOptions=t)}Securden_Popup.showDomainAccountContextMenu(t,n)})),$("#generate_password_numeral_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_numeral_icon_id","generate_password_numeral_icon_id_hidden_id");var t="generate_password_numeral_icon_id_hidden_id",n="false",o="numerals",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_numeral_text_1").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_numeral_icon_id","generate_password_numeral_icon_id_hidden_id");var t="generate_password_numeral_icon_id_hidden_id",n="false",o="numerals",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_numeral_text_2").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_numeral_icon_id","generate_password_numeral_icon_id_hidden_id");var t="generate_password_numeral_icon_id_hidden_id",n="false",o="numerals",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_uppercase_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_uppercase_icon_id","generate_password_uppercase_icon_id_hidden_id");var t="generate_password_uppercase_icon_id_hidden_id",n="false",o="uppercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_uppercase_text_1").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_uppercase_icon_id","generate_password_uppercase_icon_id_hidden_id");var t="generate_password_uppercase_icon_id_hidden_id",n="false",o="uppercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_uppercase_text_2").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_uppercase_icon_id","generate_password_uppercase_icon_id_hidden_id");var t="generate_password_uppercase_icon_id_hidden_id",n="false",o="uppercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_lowercase_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_lowercase_icon_id","generate_password_lowercase_icon_id_hidden_id");var t="generate_password_lowercase_icon_id_hidden_id",n="false",o="lowercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_lowercase_text_1").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_lowercase_icon_id","generate_password_lowercase_icon_id_hidden_id");var t="generate_password_lowercase_icon_id_hidden_id",n="false",o="lowercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_lowercase_text_2").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_lowercase_icon_id","generate_password_lowercase_icon_id_hidden_id");var t="generate_password_lowercase_icon_id_hidden_id",n="false",o="lowercase",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_special_characters_icon_id").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_special_characters_icon_id","generate_password_special_characters_icon_id_hidden_id");var t="generate_password_special_characters_icon_id_hidden_id",n="false",o="specialchars",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_special_characters_text_1").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_special_characters_icon_id","generate_password_special_characters_icon_id_hidden_id");var t="generate_password_special_characters_icon_id_hidden_id",n="false",o="specialchars",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),$("#generate_password_special_characters_text_2").click((function(e){SecurdenExtensionUtils.toggleCheckbox("generate_password_special_characters_icon_id","generate_password_special_characters_icon_id_hidden_id");var t="generate_password_special_characters_icon_id_hidden_id",n="false",o="specialchars",i=0;SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i),n="true",i=1,SecurdenExtensionUtils.resetValueAfterValidation(t,n,o,i)})),document.getElementById("accounts_list_id").addEventListener("scroll",(function(e){var t=e.target;if(t.scrollHeight-t.scrollTop<=t.clientHeight+40){var n=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("INFINITE_SCROLL",Securden_Popup.productVersion),o=document.getElementById("small-loading");if(n&&(null==o||null==o)&&Securden_Popup.loadMore){var i=document.createElement("div");i.id="small-loading";var r=document.createElement("img");r.src="images/circle-loading.gif",i.appendChild(r),document.getElementById("accounts_list_id").appendChild(i),Securden_Popup.pageStart+=1;var s=$("#search_accounts").val();Securden_Popup.getAccounts(s)}}})),$("body").click((function(e){var t=e.target;SecurdenExtensionUtils.checkIfIDPresentInsideElement(t,"top_folders_container_div")||(SecurdenExtensionUtils.showHide([],["top_folders_container_div"]),$("#top_folders_wrap_div").removeClass("top_folders_list_div_open")),SecurdenExtensionUtils.checkIfIDPresentInsideElement(t,"domain_account_context_menu")||SecurdenExtensionUtils.showHide([],["domain_account_context_menu"])})),$(document).delegate("[cyb-element-type='cyb-input']","focusin",(function(e){$(this).parent().addClass("cyb-label-focus")})),$(document).delegate("[cyb-element-type='cyb-input']","focusout",(function(e){$(this).parent().removeClass("cyb-label-focus"),e.target.value&&""!=e.target.value.trim()&&$(this).parent().addClass("cyb-label-focus")})),document.addEventListener("scroll",(function(e){var t=e.target;t.getAttribute("divtype")&&"dropDownDiv"==t.getAttribute("divtype")||($("[divtype='folderCri']").siblings('[divtype="dropDownDiv"]').hide(),$("[divtype='folderCri_inverse']").siblings('[divtype="dropDownDiv"]').hide(),$("[divtype='folderCri_inverse']").attr("divtype","folderCri")),$(".policy-div-position").hide()}),!0)}))}),!1)},saveServerUrl:function(e){if(null!=e&&null!=e||(e=$("#server_url").val()),Securden_Popup.org_name="",-1!=e.indexOf("/")&&(Securden_Popup.org_name=e.substring(e.indexOf("/")+1)),-1==e.indexOf("/")&&SecurdenExtensionUtils.sendMessage(null,"clear_org_name",{}),""==e){var t=browser.i18n.getMessage("valid_url_error");return SecurdenExtensionUtils.showStatusMsg("error_msg",t,3e3),void("edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("server_url"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("server_url")))}-1!=e.indexOf("/")&&(e=e.substring(0,e.indexOf("/"))),-1==e.indexOf("https")&&(e="https://"+e),Securden_Popup.serverUrl=e,SecurdenExtensionUtils.sendMessage(null,"set_server_url",{serverUrl:Securden_Popup.serverUrl}),SecurdenExtensionUtils.sendMessage(null,"set_org_name",{org_name:Securden_Popup.org_name}),SecurdenExtensionUtils.serverUrl=Securden_Popup.serverUrl;var n=SecurdenExtensionUtils.getOs(),o="windows-os";"linux"==n?o="linux-os":"mac"==n&&(o="mac-os"),$("body").addClass(o),Securden_Popup.checkRequestTimeout=!0,window.setTimeout((function(){Securden_Popup.checkRequestTimeout&&Securden_Popup.showBackFunc()}),1e4),Securden_Popup.checkIfSessionAvailable()},checkIfSessionAvailable:function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e={};""!=Securden_Popup.org_name&&(e.org_name=Securden_Popup.org_name),Securden_Popup.sendRequest({action:"is_browser_extension_api_available",data:e,onSuccessFunc:"serverUrlPingSuccess",onFailureFunc:"showBackFunc"})},serverUrlPingSuccess:function(e,t,n){if(Securden_Popup.checkRequestTimeout=!1,SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.sendMessage(null,"set_server_url",{serverUrl:Securden_Popup.serverUrl}),SecurdenExtensionUtils.serverUrl=Securden_Popup.serverUrl,$("body").removeClass("msp-container"),e.is_msp_edition&&e.availableOrgs&&e.availableOrgs.length>1&&(Securden_Popup.isMspEdition=e.is_msp_edition,e.service_org_obj&&e.service_org_obj.id&&(Securden_Popup.currentOrgId=e.service_org_obj.id),e.service_org_obj&&e.service_org_obj.display_name&&(Securden_Popup.currentOrgName=e.service_org_obj.display_name),Securden_Popup.mspSwitchBar(Securden_Popup.currentOrgName),$("body").addClass("msp-container")),e.product_version){if(Securden_Popup.productVersion=e.product_version,SecurdenExtensionUtils.productVersion=e.product_version,e.csrf_token&&(SecurdenExtensionUtils.securdenCsrfToken=e.csrf_token),e.userfeatures&&localStorage.setItem("enabledFeatures",JSON.stringify(e.userfeatures)),e.logo_base64){var o=e.logo_base64;o="data:image/jpeg;base64,"+o,$("#product_logo").attr("src",o)}else $("#product_logo").attr("src","images/logo.png");SecurdenExtensionUtils.sendMessage(null,"set_product_version",{productVersion:e.product_version}),Securden_Popup.isExtensionAvailable(e)&&($("body").addClass("login-body"),$("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),SecurdenExtensionUtils.sendMessage(null,"set_disabled_icon",{}),e.twofactorselect&&Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/twofactorselect"),e.show_two_factor_configure_page?Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/twofactor"):e.show_two_factor_page?Securden_Popup.getTwoFactorPage(e,t,n):e.show_only_other_login_form&&e.is_show_other_login?Securden_Popup.getShowOtherLoginFormSuccess(e,t,n):e.show_login_page?Securden_Popup.getDomainsListSuccess(e,t,n):($("body").removeClass("login-body"),$("body").removeClass("login-body-with-other-logins-and-domain"),$("body").addClass("accounts-body"),SecurdenExtensionUtils.getFeatures(),e.is_show_context_menu?Securden_Popup.showPersonalDomainAccContextMenu=!0:Securden_Popup.showPersonalDomainAccContextMenu=!1,e.default_selected_folder_name&&($("#top_folders_text_div").text(e.default_selected_folder_name),Securden_Popup.topFolderId=e.default_selected_folder_id),"firefox"==SecurdenExtensionUtils.getBrowserName()&&SecurdenExtensionUtils.isParamValid(e.all_folders)&&Securden_Popup.createSelect2ForTopFolders(e.all_folders),SecurdenExtensionUtils.sendMessage(null,"get_search_text",{},(function(){}))))}else Securden_Popup.showFeatureNotAvailable(browser.i18n.getMessage("extension_not_supported_error"))},showFeatureNotAvailable:function(e){$("#accounts_list_id").empty(),$("#go_back_div").removeClass("feature_not_available_user_back_div_class"),$("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),$("body").addClass("login-body"),$("#feature_not_available_content").text(e),SecurdenExtensionUtils.showHide(["feature_not_available_div","go_back_div"],["loading","login_form","go_back_div_details"])},getTwoFactorPage:function(e,t,n){SecurdenExtensionUtils.showHide(["twofactor_form","logout_button","2fa_logo_radius"],["loading","2fa_logo_radius_2"]),SecurdenExtensionUtils.showHide([],["twofactor_input_div","twofactor_login_logout_div_id","email_or_mobile_not_available_msg_div","twofactor_logout_div_id","two_factor_mail_otp_resend_id","resend_otp"]),e.two_factor_display_string&&(document.getElementById("twofactor_form_display_string").innerText=e.two_factor_display_string);var o=document.getElementById("id_twofactor");o&&(o.placeholder="2FA code");var i=!1;if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("OTP_ERROR_MESSAGE",Securden_Popup.productVersion))if(e.twofactor_value_not_available){var r=e.twofactor_value_not_available_msg;$("#email_or_mobile_not_available_msg_div").text(r),SecurdenExtensionUtils.showHide(["email_or_mobile_not_available_msg_div","twofactor_logout_div_id"],[])}else i=!0;else i=!0;if(i){SecurdenExtensionUtils.showHide(["twofactor_input_div","twofactor_login_logout_div_id"],[]),e.two_factor_type&&1==e.two_factor_type&&SecurdenExtensionUtils.showHide(["two_factor_mail_otp_resend_id","resend_otp"],[]);var s=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TRUST_BROWSER_IN_VERSION",Securden_Popup.productVersion);if(e.trust_browser_validity&&"0"!=e.trust_browser_validity&&s){$("#trust_browser_input_id").val(e.trust_browser_validity);var a="",c=e.trust_browser_validity;if("-1"==c)a=browser.i18n.getMessage("trust_browser_forever_text");else{var d="trust_browser_for_days_text_plural";"1"==c&&(d="trust_browser_for_days_text_singular"),a=browser.i18n.getMessage(d,c)}$("#trust_browser_span_id").text(a),SecurdenExtensionUtils.showHide(["trust_browser_check_box_id"],[])}$("#id_twofactor").val(""),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor"))}},getTokenPage:function(e,t,n){var o=document.getElementById("id_twofactor");o&&(o.placeholder=e.token_message,SecurdenExtensionUtils.showHide(["twofactor_form","2fa_logo_radius_2","twofactor_input_div","twofactor_login_logout_div_id"],["2fa_logo_radius"])),e.two_factor_display_string&&(document.getElementById("twofactor_form_display_string").innerText=e.two_factor_display_string),$("#id_twofactor").val(""),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor"))},getShowOtherLoginFormSuccess:function(e,t,n){var o=[],i=0,r="",s="height50";if(e.is_show_other_login){i=(o=e.login_types_list).length,$("#other_login_form_others_login_button_group").empty();for(var a=document.getElementById("other_login_form_others_login_button_group"),c=0;c<i;c++){var d=o[c],u=document.createElement("div"),l=d.displayName;u.title=l,u.className="others-login-button",u.innerText=l,u.setAttribute("link",d.link),u.onclick=function(e){Securden_Popup.openOtherLoginPage(e)},a.appendChild(u)}1==i?r="other-login-4":2==i?(r="other-login-5",s="height100"):3==i&&(r="other-login-6",s="height150"),$(".container").removeClass("other-login-1"),$(".container").removeClass("other-login-2"),$(".container").removeClass("other-login-3"),$(".container").removeClass("other-login-4"),$(".container").removeClass("other-login-5"),$(".container").removeClass("other-login-6"),$(".container").addClass(r),$("#other_login_form_other_login_buttons_wrap").removeClass("height50"),$("#other_login_form_other_login_buttons_wrap").removeClass("height100"),$("#other_login_form_other_login_buttons_wrap").removeClass("height150"),$("#other_login_form_other_login_buttons_wrap").addClass(s),SecurdenExtensionUtils.showHide(["other_login_form","other_login_form_other_login_buttons_wrap"],["loading"])}else SecurdenExtensionUtils.showHide([],["other_login_form_other_login_buttons_wrap"]),Securden_Popup.showBackFunc()},getDomainsListSuccess:function(e,t,n){if(null!=Securden_Popup.userName?$("#id_username").val(Securden_Popup.userName):$("#id_username").val(""),$("#id_password").val(""),e.domain_objects){var o=e.default_domain_id,i=(e.is_saas_build,e.domain_objects),r=i.length;if($("#extension_login_select_input").empty(),1==r&&i[0].hasOwnProperty(1)){var s=document.getElementById("extension_login_select_input"),a=document.createElement("input");a.type="hidden",a.name="domain_id",a.id="domain_id",a.value=o,s.appendChild(a),SecurdenExtensionUtils.showHide(["login_form"],["loading","login_select_id"])}else{var c=document.createElement("select");c.className="cyb-login-select",c.name="domain_id",c.id="domain_id";for(var d=1,u=0;u<r;u++){var l=i[u];for(var _ in l){d=_;break}var p="";l.hasOwnProperty("1")||(p=document.createElement("optgroup"));var m="";l.hasOwnProperty("2")?m=browser.i18n.getMessage("Active_Directory"):l.hasOwnProperty("3")?m=browser.i18n.getMessage("Radius"):l.hasOwnProperty("4")?m=browser.i18n.getMessage("AD_Azure"):l.hasOwnProperty("5")&&(m=browser.i18n.getMessage("LDAP")),p.label=m;var f=l[d];if(null!=f&&null!=f){for(var S=f.length,g="",v=0;v<S;v++){g=document.createElement("option");var w=f[v].domain_id;g.textContent=f[v].domain_name,g.value=g.id=w,(null!=Securden_Popup.domain_id&&Securden_Popup.domain_id==w||o==w)&&(g.selected=!0),""!=p&&""!=g?p.appendChild(g):""!=g&&c.appendChild(g)}""!=p&&c.appendChild(p)}d+=1}(s=document.getElementById("extension_login_select_input")).appendChild(c),SecurdenExtensionUtils.showHide(["login_select_id","login_form"],["loading"])}var h=[],P=0,b="",E="login-body";if(e.is_show_other_login){P=(h=e.login_types_list).length,SecurdenExtensionUtils.showHide(["other_login_buttons_wrap"],[]),$("#others-login-button-group").empty();var x=document.getElementById("others-login-button-group");for(u=0;u<P;u++){var y=h[u],A=document.createElement("div"),F=y.displayName;A.title=F,A.className="others-login-button",A.innerText=F,A.setAttribute("link",y.link),A.onclick=function(e){Securden_Popup.openOtherLoginPage(e)},x.appendChild(A)}}else SecurdenExtensionUtils.showHide([],["other_login_buttons_wrap"]);1==P?b="other-login-1":2==P?(b="other-login-2",E="login-body-with-other-logins-and-domain"):3==P&&(b="other-login-3",E="login-body-with-other-logins-and-domain"),$(".container").removeClass("other-login-1"),$(".container").removeClass("other-login-2"),$(".container").removeClass("other-login-3"),$(".container").addClass(b),$("body").removeClass("login-body"),$("body").addClass(E);var U="id_username";null!=Securden_Popup.userName&&""!=Securden_Popup.userName.trim()&&(U="id_password"),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById(U),2e3):SecurdenExtensionUtils.focusElement(document.getElementById(U))}else Securden_Popup.showBackFunc()},openOtherLoginPage:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target.getAttribute("link"),n=Securden_Popup.serverUrl+t;SecurdenExtensionUtils.createNewWindow(n,1100,550,300,100,Securden_Popup.onWindowCreated)},onWindowCreated:function(e){var t=0,n=e.id;Securden_Popup.otherLoginWindowId=n,browser.windows.onRemoved.addListener(Securden_Popup.onWindowClose);var o=window.setInterval((async function(){var e=await Securden_Popup.sendRequest({action:"check_login_in_request",onFailureFunc:"errorMsgFunction"}).then((e=>e)),i=!1,r=!1;e?(e.logged_in?i=!0:t>=1e3&&(r=!0),t+=1):r=!0,i?(window.clearInterval(o),SecurdenExtensionUtils.closeWindow(n)):r&&window.clearInterval(o)}),200)},onWindowClose:function(e){Securden_Popup.otherLoginWindowId==e&&(Securden_Popup.checkIfSessionAvailable(),Securden_Popup.otherLoginWindowId=null,browser.windows.onRemoved.removeListener())},showBackFunc:function(e,t,n){Securden_Popup.checkRequestTimeout=!1,"show"==document.getElementById("loading").className&&($("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),$("body").addClass("login-body"),$("#accounts_list_id").empty(),$("#go_back_div").removeClass("feature_not_available_user_back_div_class"),SecurdenExtensionUtils.showHide(["go_back_div","go_back_div_details"],["loading","login_form","search_parent","top_menu_wrap","twofactor_form"]),Securden_Popup.serverUrl=null,SecurdenExtensionUtils.sendMessage(null,"set_disabled_icon",{})),window.clearTimeout(Securden_Popup.hideResendOtpTimer),Securden_Popup.submitButtonClicked=!1,Securden_Popup.twofactorSubmitButtonClicked=!1},goBackToServerUrl:function(){$("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),$("body").removeClass("login-body-with-other-logins-and-domain"),$(".container").removeClass("other-login-1"),$(".container").removeClass("other-login-2"),$(".container").removeClass("other-login-3"),$(".container").removeClass("other-login-4"),$(".container").removeClass("other-login-5"),$(".container").removeClass("other-login-6"),$("body").addClass("login-body"),SecurdenExtensionUtils.showHide(["serverUrl"],["error_msg","go_back_div","login_form","feature_not_available_div","other_login_form"]),Securden_Popup.sendLogoutRequest(void 0,void 0),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("server_url"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("server_url")),Securden_Popup.init()},setServerUrl:function(e,t){var n;n=""!=t?e+"/"+t:e,Securden_Popup.serverUrl=n,$("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),$("body").addClass("login-body"),null==(e=Securden_Popup.serverUrl)||null==e?(SecurdenExtensionUtils.showHide(["serverUrl"],["loading"]),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("server_url"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("server_url"))):("/"==e[e.length-1]&&(e=e.substring(0,e.length-1)),-1!=e.indexOf("https://")&&(e=e.substring(8,e.length)),-1!=e.indexOf("http://")&&(e=e.substring(7,e.length)),$("#server_url").val(e),Securden_Popup.saveServerUrl(e))},logout:function(){Securden_Popup.pageStart=1,SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.showHide(["id_username","extension_login_select_input","back_to_server_url_anchor_id"],[]),$("#id_password").attr("placeholder","password"),Securden_Popup.sendLogoutRequest("logoutResponse","checkIfSessionAvailable"),Securden_Popup.submitButtonClicked=!1,Securden_Popup.twofactorSubmitButtonClicked=!1},sendLogoutRequest:function(e,t){Securden_Popup.sendRequest({action:"logout_session",onSuccessFunc:e,onFailureFunc:t})},logoutResponse:function(e,t,n){if($("body").removeClass("accounts-body"),$("body").removeClass("account-details-body"),$("body").addClass("login-body"),$("#accounts_right_pane").empty(),SecurdenExtensionUtils.sendMessage(null,"set_disabled_icon",{}),e.is_valid)Securden_Popup.checkIfSessionAvailable();else{SecurdenExtensionUtils.showHide(["go_back_div","go_back_div_details"],["loading"]);SecurdenExtensionUtils.showStatusMsg("error_msg","Server not available",3e3)}},loginSubmit:function(){var e=$("#id_username").val(),t=$("#id_password").val(),n=$("#domain_id").val();if(""==e){var o=browser.i18n.getMessage("valid_username_error");return SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3),void("edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_username"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_username")))}if(""==t){o=browser.i18n.getMessage("valid_password_error");return SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3),void("edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_password"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_password")))}var i={};i.username=e,i.password=t,i.domain_id=n,SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("RADIUS_TOKEN",Securden_Popup.productVersion)&&Securden_Popup.stateCheck&&(i.state=Securden_Popup.stateCheck),Securden_Popup.stateCheck="",SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion)&&(i.os=SecurdenExtensionUtils.getOs()),$("#search_accounts").val(""),SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.sendMessage(null,"set_user_name_domain",i),Securden_Popup.sendRequest({action:"login_submit",data:i,type:"POST",onSuccessFunc:"loggedInFunc",onFailureFunc:"showBackFunc"})},twofactorSubmit:function(){window.clearTimeout(Securden_Popup.hideResendOtpTimer);var e=$("#id_twofactor").val();if(""==e){var t=browser.i18n.getMessage("valid_2fa_code_error");return SecurdenExtensionUtils.showStatusMsg("error_msg",t,3e3),void("edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_twofactor")))}var n={};n.code=e,Securden_Popup.validateToken&&(n.state=Securden_Popup.stateCheck,Securden_Popup.validateToken=!1);var o=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TRUST_BROWSER_IN_VERSION",Securden_Popup.productVersion),i=$("#trust_browser_hidden_id").val();o&&"true"==i&&(n.trust_browser_validity=$("#trust_browser_input_id").val()),Securden_Popup.sendRequest({action:"two_factor_submit",data:n,type:"POST",onSuccessFunc:"twofactorSubmitFunc",onFailureFunc:"showBackFunc"})},twofactorConfigureSubmit:function(){Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/twofactor")},errorInRequestFunc:function(e,t,n){SecurdenExtensionUtils.showHide([],["login_form","loading","go_back_div_details"]);var o=browser.i18n.getMessage("error_in_processing_request");SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3),window.setTimeout((function(){SecurdenExtensionUtils.showHide([],["error_msg"])}),3e3)},twofactorSubmitFunc:function(e,t,n){Securden_Popup.stateCheck=e.state,Securden_Popup.validateToken=e.validate_token,e.is_valid?($("body").removeClass("login-body"),$("body").removeClass("login-body-with-other-logins-and-domain"),$("body").addClass("accounts-body"),SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.sendMessage(null,"save_search_text",{searchText:""}),Securden_Popup.getAccounts()):e.state&&e.validate_token?Securden_Popup.getTokenPage(e,t,n):(Securden_Popup.getTwoFactorPage(e,t,n),SecurdenExtensionUtils.showStatusMsg("error_msg",e.message,3e3))},loggedInFunc:function(e,t,n){if(Securden_Popup.submitButtonClicked=!1,Securden_Popup.twofactorSubmitButtonClicked=!1,e.is_valid)if(e.product_version)if(Securden_Popup.productVersion=e.product_version,SecurdenExtensionUtils.productVersion=e.product_version,e.csrf_token&&(SecurdenExtensionUtils.securdenCsrfToken=e.csrf_token),e.userfeatures&&localStorage.setItem("enabledFeatures",JSON.stringify(e.userfeatures)),SecurdenExtensionUtils.sendMessage(null,"set_product_version",{productVersion:e.product_version}),e.twofactorselect&&Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/twofactorselect"),e.is_two_factor_not_configured)Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/twofactor");else if(e.is_two_factor_needed)Securden_Popup.getTwoFactorPage(e,t,n);else{$("body").removeClass("login-body"),$("body").removeClass("login-body-with-other-logins-and-domain"),$("body").addClass("accounts-body"),$("#id_username").val(""),$("#id_password").val(""),SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.sendMessage(null,"save_search_text",{searchText:""}),SecurdenExtensionUtils.getFeatures(),e.is_show_context_menu?(Securden_Popup.showPersonalDomainAccContextMenu=!0,Securden_Popup.personalDomainAccContextMenuOptions=e.remote_actions):Securden_Popup.showPersonalDomainAccContextMenu=!1,e.default_selected_folder_name&&($("#top_folders_text_div").text(e.default_selected_folder_name),Securden_Popup.topFolderId=e.default_selected_folder_id);var o={};SecurdenExtensionUtils.isParamValid(Securden_Popup.topFolderId)&&(o.folder_id=Securden_Popup.topFolderId),Securden_Popup.isMspEdition=!1,e.is_msp_edition&&e.availableOrgs&&e.availableOrgs.length>1&&(Securden_Popup.isMspEdition=e.is_msp_edition,e.service_org_obj&&e.service_org_obj.id&&(Securden_Popup.currentOrgId=e.service_org_obj.id),e.service_org_obj&&e.service_org_obj.display_name&&(Securden_Popup.currentOrgName=e.service_org_obj.display_name),Securden_Popup.mspSwitchBar(Securden_Popup.currentOrgName),$("body").addClass("msp-container")),Securden_Popup.getAccounts("",o)}else Securden_Popup.showFeatureNotAvailable(browser.i18n.getMessage("extension_not_supported_error"));else{null!=Securden_Popup.userName&&""!=Securden_Popup.userName.trim()?$("#id_username").val(Securden_Popup.userName):$("#id_username").val(""),Securden_Popup.validateToken=e.validate_token,Securden_Popup.validateToken&&e.first_factor_login?(Securden_Popup.validateToken=!1,SecurdenExtensionUtils.showHide(["first_factor_logo_radius"],["id_username","extension_login_select_input","back_to_server_url_anchor_id"]),Securden_Popup.stateCheck=e.state,Securden_Popup.validateToken=e.validate_token,$("#id_password").attr("placeholder",e.token_message)):(SecurdenExtensionUtils.showHide(["id_username","extension_login_select_input","back_to_server_url_anchor_id"],[]),$("#id_password").attr("placeholder","password"),SecurdenExtensionUtils.showStatusMsg("error_msg",e.message,3e3)),$("#id_password").val(""),Securden_Popup.validateToken?(SecurdenExtensionUtils.showHide(["login_form","first_factor_logo_radius"],["loading"]),Securden_Popup.validateToken=!1):SecurdenExtensionUtils.showHide(["login_form"],["loading"]);var i="id_username";null!=Securden_Popup.userName&&""!=Securden_Popup.userName.trim()&&(i="id_password"),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById(i),2e3):SecurdenExtensionUtils.focusElement(document.getElementById(i))}},isExtensionAvailable:function(e){return!!e.is_browser_extension_api_allowed||(Securden_Popup.showFeatureNotAvailable(e.message),!1)},clearSearch:function(){SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.pageStart=1,$("#search_accounts").val("");var e=Securden_Popup.filterByValue,t=Securden_Popup.filterByValueCategory,n={};Securden_Popup.isFilterByType&&""!=e.trim()?(n.account_type=e,n.account_category=t):Securden_Popup.isFilterBy&&""!=e.trim()&&(n.account_address=e),SecurdenExtensionUtils.sendMessage(null,"save_search_text",{searchText:""}),Securden_Popup.getAccounts("",n)},searchAccounts:function(){var e=$("#search_accounts").val();e&&($("#top_folders_text_div").text(Securden_Popup.ALL_ACCOUNTS_ID),Securden_Popup.topFolderId=Securden_Popup.ALL_ACCOUNTS_ID,"firefox"==SecurdenExtensionUtils.getBrowserName()&&($("#top-folders-select2-div").val(Securden_Popup.ALL_ACCOUNTS_ID),$("#top-folders-select2-div").select2().trigger("change")));var t=["loading"];null!=e&&null!=e&""!=e&&t.push("clear_search_text_button_div"),SecurdenExtensionUtils.showHide(t,[]),Securden_Popup.pageStart=1;var n=Securden_Popup.filterByValue,o=Securden_Popup.filterByValueCategory,i={};Securden_Popup.isFilterByType&&""!=n.trim()?(i.account_type=n,i.account_category=o):Securden_Popup.isFilterBy&&""!=n.trim()&&(i.account_address=n);var r=Securden_Popup.topFolderId;SecurdenExtensionUtils.isParamValid(r)&&(i.folder_id=r),SecurdenExtensionUtils.sendMessage(null,"save_search_text",{searchText:e}),Securden_Popup.isMspEdition?Securden_Popup.changeOrg(Securden_Popup.currentOrgId):Securden_Popup.getAccounts(e,i)},getAccounts:function(e,t){var n={};null!=e&&null!=e&""!=e&&(n.search_text=e),n.page=Securden_Popup.pageStart;var o=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("INFINITE_SCROLL",Securden_Popup.productVersion);if(n.page_limit=o?Securden_Popup.pageLimit:2e3,null!=t&&null!=t)for(var i in t)n[i]=t[i];Securden_Popup.sendRequest({action:"get_accounts",data:n,onSuccessFunc:"getAccountsSuccess",onFailureFunc:"errorMsgFunction"})},getServerUrl:function(){SecurdenExtensionUtils.sendMessage(null,"get_server_url_to_set",{},(function(){})),SecurdenExtensionUtils.sendMessage(null,"get_username_for_login",{},(function(){}))},getAccountsSuccess:function(e,t,n){Securden_Popup.loadAccounts(e)},loadAccounts:function(e){Securden_Popup.fromAccountDetailsPage=!1;var t=[];if(null==Securden_Popup.productVersion||null==Securden_Popup.productVersion)return Securden_Popup.showFeatureNotAvailable(browser.i18n.getMessage("extension_not_supported_error")),!1;if(null!=e.accounts&&null!=e.accounts){SecurdenExtensionUtils.sendMessage(null,"set_enabled_icon",{});var n=e.accounts;Securden_Popup.workText=e.category_text,SecurdenExtensionUtils.initializeTexts(Securden_Popup.workText);var o=n.length;if(0==o&&1==Securden_Popup.pageStart){var i=["accounts_empty","search_parent","top_menu_wrap"];i=i.concat(Securden_Popup.getTopBandIconsToShow()),SecurdenExtensionUtils.showHide(i,["loading"]),$("#search_accounts").focus(),Securden_Popup.loadMore=!1}else{Securden_Popup.loadMore=null!=e.load_more&&null!=e.load_more&&e.load_more,1==Securden_Popup.pageStart?$("#accounts_list_id").empty():document.getElementById("accounts_list_id").removeChild(document.getElementById("small-loading"));null!=e.edit_manage_account_enabled&&null!=e.edit_manage_account_enabled&&e.edit_manage_account_enabled;var r=!0;null!=e.delete_disabled_flag&&null!=e.delete_disabled_flag&&(r=e.delete_disabled_flag),e.device_types&&(Securden_Popup.deviceTypes=e.device_types.device_types);for(var s=e.is_show_folder,a=0;a<o;a++){var c=n[a].id,d=n[a].acc_title,u=n[a].acc_name,l=n[a].acc_address,_=n[a].acc_type,p=n[a].acc_notes,m=n[a].acc_notes_type,f=$("<li>",{account_id:c,account_name:u,account_url:l,account_title:d,account_type:_,account_view_permission:n[a].permissions.view,account_remote_permission:n[a].permissions.list}),S=n[a].color_code,g="";null!=S&&null!=S&&(g=Securden_Popup.accountColorCodeList[S]);var v=!1;1==n[a].acc_category&&(v=!1),3==n[a].acc_category&&(v=!0);var w="";null!=n[a].secret_key_acc_id&&(w="four-icon-class");var h=$("<div>",{class:"account-list-body "+g+" "+w}),P=$("<div>",{class:"account-details"}),b=$("<div>",{class:"account-list-name"}),E=n[a].is_favorite,x="icon-favorite-line",y=browser.i18n.getMessage("mark_as_favorite");E&&(x="icon-favorite-fill",y=browser.i18n.getMessage("remove_as_favorite"));var A=$("<div>",{class:"account-list-icon "+x,id:c+"_favorite_icon",name:"favorite-account",title:y,align:"absmiddle",account_id:c,is_favorite:E});A.click(Securden_Popup.favoriteAccount),b.append(A),b.append($("<a>",{href:"#",class:"account-title",title:d}).text(d)),P.append(b);var F=!1;null!=e.show_accountname_in_list&&null!=e.show_accountname_in_list&&(F=e.show_accountname_in_list);var U=!1;if(n[a].acc_temp_name&&"PasswordOnlyTemplate"==n[a].acc_temp_name&&(U=!0),F){var k=$("<div>",{class:"account-list-name"}),I=$("<div>",{class:"account-list-icon icon-users",id:c+"_account_name_icon",name:"account-name",title:browser.i18n.getMessage("account_name"),align:"absmiddle",account_id:c});k.append(I),U&&(u=browser.i18n.getMessage("not_available")),k.append($("<span>",{class:"marginLeft18"}).text(u)),P.append(k)}P.click(Securden_Popup.showAccountDetails),h.append(P);var C=$("<div>",{class:"account-list-address"}),T=browser.runtime.getURL("images/account-address.png"),N=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FILTER_ACCOUNT_BY_ADDRESS",Securden_Popup.productVersion);SecurdenExtensionUtils.favIconAllowed(l)&&(T=SecurdenExtensionUtils.getFavIcon(l));var M="";N&&null!=l&&""!=l&&(M=browser.i18n.getMessage("filter_accounts_based_on_url"));var R=$("<img>",{class:"account-list-icon fav-icon",id:c+"_fav_icon",name:"fav_icon",title:M,account_id:c,account_url:l,src:T});N&&null!=l&&""!=l&&R.click(Securden_Popup.getAccountsInAddress),C.append(R);var V=$("<span>",{class:"marginLeft18",title:l});null!=l&&""!=l?V.text(l):V.text("URL not specified"),C.append(V),P.append(C);var B=$("<div>",{class:"account-list-type"}),O="icon-enterprise";v&&(O="icon-users");var D="work";v&&(D="personal");var L=browser.i18n.getMessage("filter_accounts_based_on")+" '"+_+"'",H=$("<div>",{class:"account-list-icon "+O,id:c+"_fav_icon",title:L,name:"account_address_icon",account_type:_,account_category:D});null!=_&&null!=_||(_=browser.i18n.getMessage("__none__")),H.click(Securden_Popup.getAccountsInAccountType);var q=$("<span>",{class:"marginLeft18",title:_}).text(_);if(B.append(H),B.append(q),P.append(B),null!=p&&null!=p){var W=$("<div>",{class:"account-list-notes"}),G=$("<div>",{class:"account-list-icon icon-audit",id:c+"_fav_icon",title:browser.i18n.getMessage("notes"),name:"account_address_icon"}),j=p.split("\n"),K=j[0],Y="";if(j.length<=4)p.length>=200&&(p=p.substring(0,200),p+=" ..."),Y=p.replace(/\n/g,"<br/>");else{Y=K;for(var z=1;z<4;z++)Y=Y+"<br/>"+j[z];Y+="<br/> ..."}var J=$("<span>",{class:"marginLeft18 notes-icon"});J.append(Y);var Q="cyb-tooltip";K.length>=45&&(Q+=" rightMinus100");var Z=$("<div>",{class:Q});Z.append(Y),J.append(Z),W.append(G),W.append(J);var X=!1;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("NOTES_CHECK_IN_VERSION",Securden_Popup.productVersion)?null!=m&&null!=m&&3!=m&&(X=!0):X=!0,X&&P.append(W)}if(s){var ee=$("<div>",{class:"account-list-type"}),te="icon-folder",ne=browser.i18n.getMessage("__none__");n[a].folder_name?ne=n[a].folder_name:v&&(ne=browser.i18n.getMessage("personal_accounts"));te=$("<div>",{class:"account-list-icon "+te,id:c+"_folder_icon",name:"folder_name_icon"});var oe=$("<span>",{class:"marginLeft18",title:ne}).text(ne);ee.append(te),ee.append(oe),P.append(ee)}var ie=$("<div>",{class:"account-actions"}),re="icon-copy-account-name",se=browser.i18n.getMessage("copy_account_name");U&&(re+=" cyb-disable",se=browser.i18n.getMessage("not_available"));var ae=$("<div>",{class:re,name:"copy-account-name",align:"absmiddle",account_id:c,account_name:u,account_url:l});U||ae.click(Securden_Popup.copyAccountName);var ce=$("<div>",{class:"cyb-tooltip"}).text(se);ae.append(ce);var de=[];4!=n[a].acc_category&&5!=n[a].acc_category&&de.push(ae);var ue=n[a].permissions.view,le="grey-icon",_e=browser.i18n.getMessage("view_or_a_higher_permission_is_required");ue&&(le="",_e=browser.i18n.getMessage("copy_password"));var pe=$("<div>",{class:"icon-copy-password "+le,name:"copy",align:"absmiddle",account_id:c,account_name:u,account_url:l});ue&&pe.click(Securden_Popup.copyPassword);var me=$("<div>",{class:"cyb-tooltip"}).text(_e);pe.append(me),4!=n[a].acc_category&&5!=n[a].acc_category&&de.push(pe);var fe=n[a].permissions.manage,Se=(n[a].permissions.owned,!1),ge=!1,ve=!1,we=!1,he=null;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("AUTOFILL_URLS",Securden_Popup.productVersion)&&(he=n[a].autofill_url_acc_id);var Pe=!1;null!=he&&null!=he&&(Pe=!0);var be=0;SecurdenExtensionUtils.isParamValid(n[a].launcher_count)&&(be=n[a].launcher_count);if(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/.test(l)){if(0!=l.indexOf("http")&&0!=l.indexOf("https")){l="https://"+l}we=!0}else Pe&&(we=!0);var Ee="icon-auto-logon",xe=browser.i18n.getMessage("open_url");Pe&&(xe=browser.i18n.getMessage("launch_web_application"));var ye=!1,Ae=e.remote_templates&&e.remote_templates.rdp_templates?e.remote_templates.rdp_templates:Securden_Popup.RDPTemplates,Fe=e.remote_templates&&e.remote_templates.ssh_templates?e.remote_templates.ssh_templates:Securden_Popup.SSHTemplates,Ue=Securden_Popup.windowsDomainTemplates,ke=!0,Ie=SecurdenExtensionUtils.getOs();(Ae.indexOf(n[a].acc_temp_name)>-1||Fe.indexOf(n[a].acc_temp_name)>-1)&&n[a].is_system_template?Ae.indexOf(n[a].acc_temp_name)>-1?(Se=!0,Ee="icon-remote-desktop",xe=browser.i18n.getMessage("launch_rdp"),ye=!0,Pe&&(xe=browser.i18n.getMessage("launch_remote_connection")),Ue.indexOf(n[a].acc_temp_name)>-1&&(xe=browser.i18n.getMessage("launch_remote_connection"))):(ge=!0,Ee="icon-ssh",xe=browser.i18n.getMessage("launch_remote_ssh"),Pe&&(xe=browser.i18n.getMessage("launch_remote_connection")),ye=!0):null!=n[a].template_category&&null!=n[a].template_category&&2==n[a].template_category&&(SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")?(ge=!0,Ee="icon-ssh",xe=browser.i18n.getMessage("launch_remote_ssh"),Pe&&(xe=browser.i18n.getMessage("launch_remote_connection")),ye=!0):Pe?(ge=!0,Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_remote_connection"),ye=!0):(ge=!1,we=!1,Ee="icon-ssh grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0));var Ce=e.remote_templates&&e.remote_templates.sql_templates?e.remote_templates.sql_templates:Securden_Popup.SQLTemplates,$e=e.remote_templates&&e.remote_templates.oracle_templates?e.remote_templates.oracle_templates:Securden_Popup.OracleTemplates;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SSH_SQL_DOMAIN_ACCOUNT",Securden_Popup.productVersion)&&Ce.indexOf(n[a].acc_temp_name)>-1&&n[a].is_system_template&&(ve=!0,Ee="icon-database",xe=browser.i18n.getMessage("launch_sql_connection"),Pe&&(xe=browser.i18n.getMessage("launch_remote_connection")),ye=!0,-1==Ie.indexOf("windows")&&(Pe?(ve=!0,Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_remote_connection"),ye=!0):(ke=!1,xe=browser.i18n.getMessage("sql_connection_windows_only_error"),ye=!0)));var Te=n[a].permissions.list&&SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("RDP_SSH",Securden_Popup.productVersion);null!=l&&""!=l?((Se||ge||ve)&&(ve?$e.indexOf(n[a].acc_temp_name)>-1?(SecurdenExtensionUtils.featureAllowed("remote_oracle")||Pe||(ve=!1,we=!1,Ee+=" grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0),!SecurdenExtensionUtils.featureAllowed("remote_oracle")&&Pe&&(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application"))):(SecurdenExtensionUtils.featureAllowed("remote_mssql")||Pe||(ve=!1,we=!1,Ee+=" grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0),!SecurdenExtensionUtils.featureAllowed("remote_mssql")&&Pe&&(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application"))):ge?(SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||Pe||(ge=!1,we=!1,Ee+=" grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0),SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||!Pe||(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application"))):-1==Ue.indexOf(n[a].acc_temp_name)?(SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||Pe||(Se=!1,we=!1,Ee+=" grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0),SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||!Pe||(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application"))):(SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||SecurdenExtensionUtils.featureAllowed("remote_mssql")||Pe||(Se=!1,we=!1,Ee+=" grey-icon",xe=browser.i18n.getMessage("remote_connection_disabled_by_administrator"),ye=!0),SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||SecurdenExtensionUtils.featureAllowed("remote_mssql")||!Pe||(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application")))),be>0&&SecurdenExtensionUtils.featureAllowed("trigger_application_launcher")&&(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_remote_connection"),ye=!0,we=!0),Te||(Se=!1,ge=!1,ve=!1,xe=browser.i18n.getMessage("open_connection_or_higher_permission_required"),ye=!0),we||(Se||ge||ve)&&Te||(Ee+=" grey-icon",ye||(xe=_&&Securden_Popup.deviceTypes&&Securden_Popup.deviceTypes.indexOf(_)>-1?browser.i18n.getMessage("not_supported"):browser.i18n.getMessage("invalid_url")))):we&&Pe?(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_web_application"),ye=!0):be>0?SecurdenExtensionUtils.featureAllowed("trigger_application_launcher")&&(Ee="icon-auto-logon",xe=browser.i18n.getMessage("launch_remote_connection"),ye=!0,we=!0):(Ee+=" grey-icon",xe=browser.i18n.getMessage("invalid_url"));var Ne=$("<div>",{class:Ee,name:"login",align:"absmiddle",account_id:c,account_name:u,account_url:l,sshConnection:ge});Te&&((Se||ge||ve)&&ke?Ne.click(Securden_Popup.remoteConnection):we&&(Pe||be>0?Ne.click(Securden_Popup.remoteConnection):Ne.click(Securden_Popup.autoLogon)));var Me=$("<div>",{class:"cyb-tooltip"}).text(xe);if(Ne.append(Me),4!=n[a].acc_category&&5!=n[a].acc_category&&de.push(Ne),null!=n[a].secret_key_acc_id){0;var Re=browser.i18n.getMessage("copy_totp");(pe=$("<div>",{class:"totp-icon-wrap ",name:"copy",align:"absmiddle",account_id:c,account_url:"get_totp_start_value_server"})).click(Securden_Popup.copyTotp);var Ve=$("<div>",{class:"cyb-tooltip"}).text(Re);pe.append(Ve),4!=n[a].acc_category&&5!=n[a].acc_category&&de.push(pe)}0;var Be=browser.i18n.getMessage("restore_account"),Oe=$("<div>",{class:"icon-change-key ",name:"restore",align:"absmiddle",account_id:c});Oe.click(Securden_Popup.restoreAccount);var De=$("<div>",{class:"cyb-tooltip"}).text(Be);Oe.append(De);var Le=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("PERMANENT_DELETE_AND_RESTORE_ACCOUNT",Securden_Popup.productVersion);4!=n[a].acc_category&&5!=n[a].acc_category||!Le||de.push(Oe);0;var He=browser.i18n.getMessage("delete_account_permanently"),qe=$("<div>",{class:"icon-delete ",name:"delete",align:"absmiddle",account_id:c});qe.click(Securden_Popup.permanentDelete);var We=$("<div>",{class:"cyb-tooltip"}).text(He);qe.append(We);var Ge=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("PERMANENT_DELETE_AND_RESTORE_ACCOUNT",Securden_Popup.productVersion);if(4!=n[a].acc_category&&5!=n[a].acc_category||!Ge||de.push(qe),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("DELETE_ACCOUNT",Securden_Popup.productVersion))$("<div>",{class:"icon-delete",name:"delete",title:browser.i18n.getMessage("delete_account"),align:"absmiddle",account_id:c,account_name:u,account_url:l}).click(Securden_Popup.deleteAccount),!r&&(SecurdenExtensionUtils.featureAllowed("delete_account")&&fe||SecurdenExtensionUtils.featureAllowed("delete_owned_account"));ie.append(de),h.append(ie),f.append(h),$("#accounts_list_id").append(f)}if(t.push("accounts_list_parent"),(t=t.concat(Securden_Popup.getTopBandIconsToShow())).push("search_parent"),t.push("top_menu_wrap"),Securden_Popup.isFilterBy&&t.push("filter_accounts_title_id","clear_filter_button_div"),SecurdenExtensionUtils.showHide(t,["loading"]),""!=$("#search_accounts").val().trim()&&SecurdenExtensionUtils.showHide(["clear_search_text_button_div"],[]),$("#search_accounts").focus(),Securden_Popup.isFilterBy){var je=browser.i18n.getMessage("accounts_belonging_to");Securden_Popup.isFilterByType&&(je=je+" "+browser.i18n.getMessage("type")),je=je+": "+Securden_Popup.filterByValue,$("#filter_accounts_title_id").find("#filter_accounts_text_id").text(je);SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion)}Securden_Popup.submitButtonClicked=!1,Securden_Popup.twofactorSubmitButtonClicked=!1,window.setTimeout((function(){Securden_Popup.favIconError()}),2e3)}Securden_Popup.showHideAddAccountsButton(e)}else Securden_Popup.checkIfSessionAvailable()},showAccountDetails:function(e,t){var n=$(this).parent().parent().attr("account_view_permission"),o=$(this).parent().parent().attr("account_remote_permission");null!=n&&null!=n&&(Securden_Popup.accountViewPermission=n),null!=o&&null!=o&&(Securden_Popup.accountRemotePermission=o),SecurdenExtensionUtils.stopEventPropagation(e);var i=$(this).parent().parent().attr("account_id");null!=t&&null!=t&&(i=t);var r={};r.account_id=i;var s=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("VERSION_CHECK_FOR_TOTP_TOKEN",Securden_Popup.productVersion),a=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("VERSION_CHECK_FOR_FILE_DOWNLOAD",Securden_Popup.productVersion);if(s){var c=chrome.runtime.getManifest().version;c.match(/^[2-9].[0-9]*.[0-9]*$/)&&(c+=".0"),r.version=c}else a&&(r.version="2.6.2.0");SecurdenExtensionUtils.showHide(["loading"],[]);var d="get_account_details";SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion)&&(d="get_new_account_details"),Securden_Popup.sendRequest({action:d,data:r,onSuccessFunc:"showAccountDetailsSuccess",onFailureFunc:"checkIfSessionAvailable"})},showAccountDetailsSuccess:function(e,t,n){Securden_Popup.fromAccountDetailsPage=!0,Securden_Popup.changedAccountTitleOnce=!1,$("body").removeClass("accounts-body"),$("body").addClass("account-details-body");var o=e.account_info,i=e.account_details_result,r=o.id,s=(o.account_name,o.account_title),a=!1;o.access_control_check_required&&(a=o.access_control_check_required);o.account_locked&&o.account_locked;o.password_checkout&&o.password_checkout;o.show_password&&o.show_password;o.show_waiting_for_approval&&o.show_waiting_for_approval;o.show_request_page&&o.show_request_page;Securden_Popup.accountRemotePermission;null!=o.permissions&&null!=o.permissions&&null!=o.permissions.list&&null!=o.permissions.list&&o.permissions.list;Securden_Popup.accountViewPermission;null!=o.permissions&&null!=o.permissions&&null!=o.permissions.view&&null!=o.permissions.view&&o.permissions.view;null!=o.permissions&&null!=o.permissions&&null!=o.permissions.change&&null!=o.permissions.change&&o.permissions.change;null!=o.permissions&&null!=o.permissions&&null!=o.permissions.manage&&null!=o.permissions.manage&&o.permissions.manage;null!=o.template_name&&null!=o.template_name&&o.template_name;o.is_system_type&&o.is_system_type;var c=!0;null!=o.file_type&&null!=o.file_type&&(c=o.file_type);var d=!1;null!=o.edit_account_allowed&&null!=o.edit_account_allowed&&(d=o.edit_account_allowed);var u=!1;null!=o.delete_account_allowed&&null!=o.delete_account_allowed&&(u=o.delete_account_allowed);var l=!1;null!=o.enforce_reason_on_delete_account&&null!=o.enforce_reason_on_delete_account&&(l=o.enforce_reason_on_delete_account);null!=o.is_personal_account&&o.is_personal_account;o.permissions.owned;var _=null,p=null,m=!1;if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("EDIT_ACCOUNT",Securden_Popup.productVersion)&&d){var f=Securden_Popup.fileTemplates,S=o.template_name;if(c?m=!1:S?-1==f.indexOf(S)&&(m=!0):m=!0,m){(_=document.createElement("div")).setAttribute("name","edit"),_.setAttribute("title",browser.i18n.getMessage("edit_account")),_.setAttribute("class","account-modify account-edit");var g=document.createElement("i");g.setAttribute("class","icon-edit");var v=document.createElement("span");v.innerText=browser.i18n.getMessage("edit"),_.onclick=function(e){Securden_Popup.editAccount(e,r)},_.appendChild(g),_.appendChild(v)}}if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("DELETE_ACCOUNT",Securden_Popup.productVersion)&&u){(p=document.createElement("div")).setAttribute("name","delete"),p.setAttribute("title",browser.i18n.getMessage("delete_account")),p.setAttribute("class","account-modify account-delete");var w=document.createElement("i");w.setAttribute("class","icon-delete");var h=document.createElement("span");h.innerText=browser.i18n.getMessage("delete"),p.onclick=function(e){Securden_Popup.deleteAccount(e,r,l)},p.appendChild(w),p.appendChild(h)}var P=document.createElement("div"),b=i.length,E=1,x=o.top_level_fields_count?o.top_level_fields_count:void 0;if(x)for(;E<x;E++)Securden_Popup.constructDetailsPage(o,i,E,P);var y=o.is_collapse_account_attributes?o.is_collapse_account_attributes:void 0,A="show";y&&(A="hide");var F=document.createElement("div");F.id="accountDetailsShowMoreDetailsId",F.className="more-attributes-link",F.innerText=browser.i18n.getMessage("show_more_details");var U=document.createElement("i");U.className="icon-down",F.appendChild(U);var k=document.createElement("div");for(k.id="accountDetailsSecondaryFieldsId",k.className=A;E<b;E++)Securden_Popup.constructDetailsPage(o,i,E,k);var I=document.createElement("div");I.className="acc-details-wrapper",I.appendChild(P),y&&I.appendChild(F),I.appendChild(k),SecurdenExtensionUtils.rightSidePane("accounts_right_pane",s,[p,_],[I],void 0,"new-account-details-header"),SecurdenExtensionUtils.showHide(["accounts_right_pane","accounts_details_parent"],["accounts_list_parent","loading","search_parent","top_menu_wrap"]),$("#accountDetailsShowMoreDetailsId").click((function(e){SecurdenExtensionUtils.showHide(["accountDetailsSecondaryFieldsId"],["accountDetailsShowMoreDetailsId"])}))},constructDetailsPage:function(e,t,n,o){var i=e.id,r=(e.account_name,e.account_title),s=!1;e.access_control_check_required&&(s=e.access_control_check_required);var a=!1;e.account_locked&&(a=e.account_locked);var c=!1;e.password_checkout&&(c=e.password_checkout);var d=!1,u=!1;s||(d=!0),e.show_password&&(d=e.show_password,u=!0);var l=!1;e.show_waiting_for_approval&&(l=e.show_waiting_for_approval);var _=!1;e.show_request_page&&(_=e.show_request_page);var p="true"==Securden_Popup.accountRemotePermission;null!=e.permissions&&null!=e.permissions&&null!=e.permissions.list&&null!=e.permissions.list&&(p=e.permissions.list);var m="true"==Securden_Popup.accountViewPermission;null!=e.permissions&&null!=e.permissions&&null!=e.permissions.view&&null!=e.permissions.view&&(m=e.permissions.view);var f=!1;null!=e.permissions&&null!=e.permissions&&null!=e.permissions.change&&null!=e.permissions.change&&(f=e.permissions.change);null!=e.permissions&&null!=e.permissions&&null!=e.permissions.manage&&null!=e.permissions.manage&&e.permissions.manage;null!=e.template_name&&null!=e.template_name&&e.template_name;e.is_system_type&&e.is_system_type;var S=!0;null!=e.file_type&&null!=e.file_type&&(S=e.file_type);null!=e.edit_account_allowed&&null!=e.edit_account_allowed&&e.edit_account_allowed;null!=e.delete_account_allowed&&null!=e.delete_account_allowed&&e.delete_account_allowed;null!=e.is_personal_account&&null!=e.is_personal_account&&e.is_personal_account;var g=t[n],v=document.createElement("div");v.className="acc-details-list";var w=document.createElement("div");w.className="acc-details-header";var h=g.attr_display_name,P=g.attr_display_value,b=null;(null!=g.attr_display_title&&null!=g.attr_display_title&&(b=g.attr_display_title),Securden_Popup.changedAccountTitleOnce)||(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("OTP_ERROR_MESSAGE",Securden_Popup.productVersion)||("Account Name".indexOf(h)>-1||"File".indexOf(h)>-1||"Domain Name\\Account Name".indexOf(h)>-1||"Private Key".indexOf(h)>-1||"SSH Key".indexOf(h)>-1||"File Name".indexOf(h)>-1)&&r==P&&(Securden_Popup.changedAccountTitleOnce=!0,h=browser.i18n.getMessage("account_title")));w.innerText=h;var E=document.createElement("div");E.className="acc-details-result";var x=!1,y=!1,A=!1,F="password_";if(1!=g.is_password&&1!=g.is_additional_password||(x=!0,1==g.is_additional_password?(F="additional_"+F,g.is_empty||(y=!0)):(A=!0,p&&g.password_present&&(y=!0))),s&&y&&(a?(y=!1,P="["+browser.i18n.getMessage("in_exclusive_use_msg")+"]"):l&&(y=!1,P=browser.i18n.getMessage("waiting_for_approval"))),y&&A&&d&&p&&!m&&(y=!1,P=browser.i18n.getMessage("viewing_restricted")),y){if(A&&(E.id="password-div-id"),s&&A){if(_)(C=Securden_Popup.createLinkDiv(i,browser.i18n.getMessage("request"),h,P,"[Request Access]")).onclick=function(e){Securden_Popup.showRequestPage(e)},E.appendChild(C);else if(c){(T=Securden_Popup.createLinkDiv(i,browser.i18n.getMessage("get_access"),h,P,"[Get Access]")).onclick=function(e){Securden_Popup.passwordCheckout(e)},E.appendChild(T)}}else d=!0;if(d){var U=F,k="",I={passwordId:U+=A?i:k=g.field_id,accountId:i,fieldId:k,displayName:h,displayValue:P,isAccountPassword:A,showSurrenderAccess:u,maindiv:E,modifyPermission:f,isFileType:S,accountDetailsJson:g};Securden_Popup.createPasswordElement(I)}}else if(1!=g.is_additional_file&&1!=g.is_file_field||g.is_empty){x&&A&&(SecurdenExtensionUtils.isParamValid(b)&&"string"==typeof b||!SecurdenExtensionUtils.isParamValid(P)||(b=P),E.id="password-div-id"),g.is_file_field&&(E.id="file-div-id",Securden_Popup.fileColumnName=h,Securden_Popup.fileName=P);O={isPasswordElement:x,showPasswordElement:y,accountId:i,displayName:h,displayValue:P,isAccountPassword:A,showSurrenderAccess:u,maindiv:E,displayTitle:b,accountInfo:e,modifyPermission:f,isFileType:S,accountDetailsJson:g};if(Securden_Popup.showTextElement(O),x&&A&&s)if(_){var C,$="["+browser.i18n.getMessage("request_access")+"]";(C=Securden_Popup.createLinkDiv(i,browser.i18n.getMessage("request"),h,P,$)).className=C.className+" widthcalc90",C.onclick=function(e){Securden_Popup.showRequestPage(e)},E.appendChild(C)}else if(c){var T;$="["+browser.i18n.getMessage("get_access")+"]";(T=Securden_Popup.createLinkDiv(i,browser.i18n.getMessage("get_access"),h,P,$)).className=T.className+" widthcalc90",T.onclick=function(e){Securden_Popup.passwordCheckout(e)},E.appendChild(T)}}else{var N=null,M=!1,R=!1;E.id="file-div-id";var V=!1;null!=g.file_download_url&&null!=g.file_download_url?(g.is_file_field&&(Securden_Popup.fileColumnName=h,Securden_Popup.fileName=P),N=g.file_download_url,V=!0):g.ticketing_system_enabled&&(M=!0,V=!0),g.ENFORCE_REASON_ON_PASSWORD_RETRIEVE&&(R=!0);var B=browser.i18n.getMessage("ticket_id");if(g.ticket_id_label&&(B=g.ticket_id_label),V)Securden_Popup.showFileField(i,h,P,N,E,M,B,R);else{g.is_file_field&&(Securden_Popup.fileColumnName=h,Securden_Popup.fileName=P);var O={isPasswordElement:x,showPasswordElement:y,accountId:i,displayName:h,displayValue:P,isAccountPassword:A,showSurrenderAccess:u,maindiv:E,displayTitle:b,accountDetailsJson:g};Securden_Popup.showTextElement(O)}}v.appendChild(w),v.appendChild(E),"Account Owner".indexOf(h)>-1?-1=="Not provided".indexOf(P)&&o.appendChild(v):o.appendChild(v)},showFileField:function(e,t,n,o,i,r,s,a){var c=Securden_Popup.createLinkDiv(e,"Download "+t,t,n,n);if(r||a){var d=browser.i18n.getMessage("reason");c.onclick=r&&a?function(t){Securden_Popup.accountId=e,Securden_Popup.validateTicketIdForFileDownload=!0,document.getElementById("id_reason_with_ticket_id").placeholder=d,document.getElementById("id_ticket_id_with_reason").placeholder=s,$("#ticket_id_reason_dialog_help_text").html(browser.i18n.getMessage("ticket_id_reason_dialog_help_text_file")),SecurdenExtensionUtils.showHide(["ticket_id_reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id_with_reason"))}:r?function(t){Securden_Popup.accountId=e,Securden_Popup.validateTicketIdForFileDownload=!0,document.getElementById("id_ticket_id").placeholder=s,$("#ticket_id_dialog_help_text").html(browser.i18n.getMessage("ticket_id_dialog_help_text_file")),SecurdenExtensionUtils.showHide(["ticket_id_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id"))}:function(t){Securden_Popup.accountId=e,Securden_Popup.validateTicketIdForFileDownload=!0,document.getElementById("id_reason").placeholder=d,$("#reason_dialog_help_text").html(browser.i18n.getMessage("reason_dialog_help_text_file")),SecurdenExtensionUtils.showHide(["reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_reason"))}}else c.setAttribute("file_download_url",o),c.onclick=function(e){Securden_Popup.downloadFile(e)};i.appendChild(c)},createLinkDiv:function(e,t,n,o,i,r){var s=document.createElement("span");s.setAttribute("name",n),s.setAttribute("title",t),s.setAttribute("class","details-url"),s.setAttribute("account_id",e),s.setAttribute("attribute_value",o),s.setAttribute("attribute_name",n);var a="details-url cursor-pointer link-color";return r&&(a+=" link-class"),s.className=a,s.innerText=i,s},showTextElement:function(e){var t=e.isPasswordElement,n=e.showPasswordElement,o=e.accountId,i=e.displayName,r=e.displayValue,s=e.isAccountPassword,a=e.showSurrenderAccess,c=e.maindiv,d=e.displayTitle,u=e.accountInfo,l=e.modifyPermission,_=e.isFileType,p=e.accountDetailsJson,m=e.is_empty,f=null;SecurdenExtensionUtils.isParamValid(p)&&(m=p.is_empty,f=p.is_url);var S=!0;t&&(S=!1);var g=document.createElement("div");g.className="details-value-wrap";var v=document.createElement("span");v.className="details-url",(t&&!n||m)&&(v.className="reduce-opacity"),v.innerText=r;var w=document.createElement("div");w.className="details-action-wrap";var h=document.createElement("div");h.setAttribute("name",i),h.setAttribute("class","icon-copy-line copy-account-url"),h.setAttribute("account_id",o),h.setAttribute("attribute_value",r),h.setAttribute("attribute_name",i),h.onclick=function(e){Securden_Popup.copyAccountAttribute(e)};var P=document.createElement("div");P.className="cyb-details-tooltip",P.innerText=browser.i18n.getMessage("copy")+" "+i,h.appendChild(P);var b=document.createElement("div");b.setAttribute("id","generate_password"),b.setAttribute("name","generate"),b.setAttribute("class","icon-generate"),b.setAttribute("account_id",o),b.setAttribute("attribute_value",r),b.setAttribute("attribute_name",i),b.setAttribute("field_id",o),b.onclick=function(e){Securden_Popup.showChangePasswordPage(e,o)};var E=document.createElement("div");E.className="cyb-details-tooltip",E.innerText=browser.i18n.getMessage("change")+" "+i,b.appendChild(E);var x=browser.i18n.getMessage("surrender_access"),y="["+browser.i18n.getMessage("surrender_access")+"]",A=Securden_Popup.createLinkDiv(o,x,i,r,y,a);if(A.onclick=function(e){Securden_Popup.checkinPassword(e)},g.appendChild(v),null!=d&&null!=d&&"string"==typeof d){var F=document.createElement("div"),U=d.split("\n"),k=U[0],I="";if(U.length<=4)d.length>=200&&(d=d.substring(0,200),d+=" ..."),I=d;else{I=k;for(var C=1;C<4;C++)I=I+"\n"+U[C];I+=" ..."}var $="cyb-tooltip";k.length>=45&&($+=" rightMinus100"),F.className=$,F.innerText=I,g.appendChild(F)}t&&s&&a&&g.appendChild(A),!m&&S&&w.appendChild(h),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("CHANGE_ACCOUNT_PASSWORD",Securden_Popup.productVersion)&&t&&l&&!_&&s&&(p.password_present||w.appendChild(b));var T=null;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("AUTOFILL_URLS",Securden_Popup.productVersion)&&(T=u.autofill_url_acc_id);var N=!1;null!=T&&null!=T&&(N=!0);var M=0;if(SecurdenExtensionUtils.isParamValid(u.launcher_count)&&(M=u.launcher_count),1==f&&(!m||N||M>0)){var R=u.account_name,V=u.account_title,B="None";null!=u.template_name&&null!=u.template_name&&(B=u.template_name);var O=null;null!=u.template_category&&null!=u.template_category&&(O=u.template_category);var D=!1;u.is_system_type&&(D=u.is_system_type);var L=!1,H=!1,q=!1,W=!1;if(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/.test(r)){if(0!=r.indexOf("http")&&0!=r.indexOf("https")){r="https://"+r}W=!0}else(N||M>0)&&(W=!0);var G="icon-auto-logon",j=browser.i18n.getMessage("open_url");N?j=browser.i18n.getMessage("launch_web_application"):M>0&&(j=browser.i18n.getMessage("launch_remote_connection"));var K=Securden_Popup.RDPTemplates,Y=Securden_Popup.SSHTemplates,z=Securden_Popup.windowsDomainTemplates,J=!0,Q=SecurdenExtensionUtils.getOs();(K.indexOf(B)>-1||Y.indexOf(B)>-1)&&D?K.indexOf(B)>-1?(L=!0,G="icon-remote-desktop",j=browser.i18n.getMessage("launch_rdp"),(N||M>0||z.indexOf(B)>-1)&&(j=browser.i18n.getMessage("launch_remote_connection"))):(H=!0,G="icon-ssh",j=browser.i18n.getMessage("launch_remote_ssh"),(N||M>0)&&(j=browser.i18n.getMessage("launch_remote_connection"))):null!=O&&null!=O&&2==O&&(G="icon-ssh",SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")?(H=!0,j=browser.i18n.getMessage("launch_remote_ssh"),(N||M>0)&&(j=browser.i18n.getMessage("launch_remote_connection"))):N||M>0?(H=!0,G="icon-auto-logon",j=browser.i18n.getMessage("launch_remote_connection"),loginActionTitleChanged=!0):(H=!1,W=!1,G="icon-ssh grey-icon",j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")));var Z=Securden_Popup.SQLTemplates,X=Securden_Popup.OracleTemplates;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SSH_SQL_DOMAIN_ACCOUNT",Securden_Popup.productVersion)&&Z.indexOf(B)>-1&&D&&(q=!0,G="icon-database",j=browser.i18n.getMessage("launch_sql_connection"),(N||M>0)&&(j=browser.i18n.getMessage("launch_remote_connection")),-1==Q.indexOf("windows")&&(N||M>0?(q=!0,G="icon-auto-logon",j=browser.i18n.getMessage("launch_remote_connection"),loginActionTitleChanged=!0):(J=!1,j=browser.i18n.getMessage("sql_connection_windows_only_error"),loginActionTitleChanged=!0)));var ee=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("RDP_SSH",Securden_Popup.productVersion);(L||H||q)&&(q?X.indexOf(B)>-1?(SecurdenExtensionUtils.featureAllowed("remote_oracle")||N||(q=!1,j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")),!SecurdenExtensionUtils.featureAllowed("remote_oracle")&&N&&(G="icon-auto-logon",j=browser.i18n.getMessage("launch_web_application"))):(SecurdenExtensionUtils.featureAllowed("remote_mssql")||N||(q=!1,j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")),!SecurdenExtensionUtils.featureAllowed("remote_mssql")&&N&&(G="icon-auto-logon",j=browser.i18n.getMessage("launch_web_application"))):H?(SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||N||(H=!1,j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")),SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||!N||(G="icon-auto-logon",j=browser.i18n.getMessage("launch_web_application"))):-1==z.indexOf(B)?(SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||N||(L=!1,j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")),SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||!N||(G="icon-auto-logon",j=browser.i18n.getMessage("launch_web_application"))):(SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||SecurdenExtensionUtils.featureAllowed("remote_mssql")||N||(L=!1,W=!1,G+=" grey-icon",j=browser.i18n.getMessage("remote_connection_disabled_by_administrator")),SecurdenExtensionUtils.featureAllowed("remote_native_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_rdp")||SecurdenExtensionUtils.featureAllowed("remote_web_ssh")||SecurdenExtensionUtils.featureAllowed("remote_putty")||SecurdenExtensionUtils.featureAllowed("remote_secure_crt")||SecurdenExtensionUtils.featureAllowed("remote_mssql")||!N||(G="icon-auto-logon",j=browser.i18n.getMessage("launch_web_application")))),M>0&&SecurdenExtensionUtils.featureAllowed("trigger_application_launcher")&&(G="icon-auto-logon",j=browser.i18n.getMessage("launch_remote_connection"),W=!0);var te=document.createElement("div");te.setAttribute("name",i+"_open_url"),te.setAttribute("class",G+" cyb-account-open-url"),te.setAttribute("account_id",o),te.setAttribute("account_url",r),te.setAttribute("account_name",R),te.setAttribute("account_title",V),te.setAttribute("account_remote_permission",!0),te.setAttribute("sshConnection",H);var ne="true"==Securden_Popup.accountRemotePermission;null!=u.permissions&&null!=u.permissions&&null!=u.permissions.list&&null!=u.permissions.list&&(ne=u.permissions.list),ne?ee?(L||H||q)&&J||W&&(N||M>0)?te.onclick=function(e){Securden_Popup.remoteConnection(e)}:W&&(te.onclick=function(e){Securden_Popup.autoLogon(e)}):te.onclick=function(e){Securden_Popup.autoLogon(e)}:(L=!1,H=!1,q=!1,j=browser.i18n.getMessage("open_connection_or_higher_permission_required"));var oe=document.createElement("div");oe.className="cyb-details-tooltip",oe.innerText=j,te.appendChild(oe),W||(L||H||q)&&(ne&&ee)||te.setAttribute("class",G+" cyb-account-open-url grey-icon"),w.appendChild(te)}c.appendChild(g),c.appendChild(w)},createPasswordElement:function(e){var t=e.passwordId,n=e.accountId,o=e.fieldId,i=e.displayName,r=e.displayValue,s=e.isAccountPassword,a=e.showSurrenderAccess,c=e.maindiv,d=e.modifyPermission,u=e.isFileType,l=e.accountDetailsJson,_=null,p=null,m=null;SecurdenExtensionUtils.isParamValid(l)&&(_=l.copy_or_view_url,p=l.request_type,m=l.response_value_key);var f=document.createElement("div");f.className="details-password-value-wrap";var S=document.createElement("span"),g="details-password";a&&(g+=" password-with-surrender"),S.className=g,S.innerText="********",S.id="pin_"+t;var v=document.createElement("div");v.className="details-password-action-wrap";var w=document.createElement("div");w.setAttribute("id","copy_img_"+t),w.setAttribute("name","copy"),w.setAttribute("class","icon-copy-line details-copy-icon"),w.setAttribute("account_id",n),w.setAttribute("attribute_value",r),w.setAttribute("attribute_name",i),w.setAttribute("copy_or_view_url",_),w.setAttribute("request_type",p),w.setAttribute("response_value_key",m),w.setAttribute("field_id",o),w.onclick=1==s?function(e){Securden_Popup.copyPassword(e,n)}:function(e){Securden_Popup.copyAccountAttribute(e)};var h=document.createElement("div");h.className="cyb-details-tooltip",h.innerText=browser.i18n.getMessage("copy")+" "+i,w.appendChild(h);var P=document.createElement("div");P.setAttribute("id","show_"+t),P.setAttribute("name","show"),P.setAttribute("class","icon-eye show"),P.setAttribute("account_id",n),P.setAttribute("attribute_value",r),P.setAttribute("attribute_name",i),P.setAttribute("copy_or_view_url",_),P.setAttribute("request_type",p),P.setAttribute("response_value_key",m),P.setAttribute("field_id",o),P.onclick=1==s?function(e){Securden_Popup.showPassword(e,n)}:function(e){Securden_Popup.showAdditionalPassword(e)};var b=document.createElement("div");b.className="cyb-details-tooltip",b.innerText=browser.i18n.getMessage("show")+" "+i,P.appendChild(b);var E=document.createElement("div");E.setAttribute("id","hide_"+t),E.setAttribute("name","hide"),E.setAttribute("class","icon-eye-slash hide"),E.setAttribute("account_id",n),E.setAttribute("attribute_value",r),E.setAttribute("attribute_name",i),E.setAttribute("field_id",o),E.onclick=1==s?function(e){Securden_Popup.hidePassword(e,n)}:function(e){Securden_Popup.hideAdditionalPassword(e)};var x=document.createElement("div");x.className="cyb-details-tooltip",x.innerText=browser.i18n.getMessage("hide")+" "+i,E.appendChild(x);var y=document.createElement("div");y.setAttribute("id","generate_password"),y.setAttribute("name","generate"),y.setAttribute("class","icon-generate"),y.setAttribute("account_id",n),y.setAttribute("attribute_value",r),y.setAttribute("attribute_name",i),y.setAttribute("field_id",o),y.onclick=function(e){Securden_Popup.showChangePasswordPage(e,n)};var A=document.createElement("div");A.className="cyb-details-tooltip",A.innerText=browser.i18n.getMessage("change")+" "+i,y.appendChild(A);var F=browser.i18n.getMessage("surrender_access"),U="["+browser.i18n.getMessage("surrender_access")+"]",k=Securden_Popup.createLinkDiv(n,F,i,r,U,a);k.onclick=function(e){Securden_Popup.checkinPassword(e)},f.appendChild(S),s&&a&&f.appendChild(k),v.appendChild(w),v.appendChild(P),v.appendChild(E),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("CHANGE_ACCOUNT_PASSWORD",Securden_Popup.productVersion)&&d&&!u&&s&&v.appendChild(y),c.appendChild(f),c.appendChild(v)},checkinPassword:function(e){SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.showHide(["loading"],[]);var t=e.target.getAttribute("account_id"),n={account_id:t};document.getElementById("password-div-id").innerText=browser.i18n.getMessage("surrendering_the_access"),Securden_Popup.accountId=t,Securden_Popup.sendRequest({action:"checkin_password",data:n,type:"POST",onSuccessFunc:"checkinPasswordSuccess",onFailureFunc:"errorMsgFunction"})},checkinPasswordSuccess:function(e,t,n){var o=Securden_Popup.accountId;Securden_Popup.showAccountDetails(null,o)},passwordCheckout:function(e){SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.showHide(["loading"],[]);var t=e.target.getAttribute("account_id"),n={account_id:t},o=document.getElementById("password-div-id");o.innerHTML="",o.innerText=browser.i18n.getMessage("getting_the_access"),Securden_Popup.accountId=t;var i="checkout_password";SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion)&&(i="new_checkout_password"),Securden_Popup.sendRequest({action:i,data:n,type:"POST",onSuccessFunc:"checkoutPasswordSucess",onFailureFunc:"checkoutPasswordError"})},checkoutPasswordSucess:function(e,t,n){var o=Securden_Popup.accountId;Securden_Popup.showAccountDetails(null,o)},checkoutPasswordError:function(e){Securden_Popup.errorMsgFunction(e);var t=Securden_Popup.accountId,n=document.getElementById("password-div-id"),o="Request",i=browser.i18n.getMessage("get_access"),r=o,s="["+browser.i18n.getMessage("get_access")+"]",a=Securden_Popup.createLinkDiv(t,i,o,r,s);a.onclick=function(e){Securden_Popup.passwordCheckout(e)},n.innerHTML="",n.appendChild(a)},showRequestPage:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t={account_id:e.target.getAttribute("account_id")};Securden_Popup.sendRequest({action:"set_account_id_in_session",data:t,type:"POST",onSuccessFunc:"showRequestPageSuccess",onFailureFunc:"errorMsgFunction"})},showRequestPageSuccess:function(e,t,n){Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/request-account-password")},removeBackButton:function(){Securden_Popup.resetValidateTicketsVariable(),Securden_Popup.resetPageShowVariables(),Securden_Popup.asset_type=null,Securden_Popup.accountId=null,$("#computers_list_id").empty(),$("#accounts_right_pane").removeClass("mobile-right-pane right"),$("#accounts_right_pane").empty(),$("body").removeClass("account-details-body"),$("body").addClass("accounts-body"),window.clearTimeout(Securden_Popup.showPasswordTimeout),window.clearTimeout(Securden_Popup.showPasswordElementTimeout);var e=["accounts_list_parent","search_parent","top_menu_wrap"];e=e.concat(Securden_Popup.getTopBandIconsToShow()),SecurdenExtensionUtils.showHide(e,["accounts_right_pane","accounts_details_parent","domain_account_context_menu","add_accounts_div","account_menu_button","password_generator_page","personal_domain_acc_parent","form_fields_save_form","computers_list_parent"]),""!=$("#search_accounts").val().trim()&&SecurdenExtensionUtils.showHide(["clear_search_text_button_div"],[]);var t=Securden_Popup.filterByValue;if(Securden_Popup.isFilterBy&&""!=t.trim()){SecurdenExtensionUtils.showHide(["filter_accounts_title_id","clear_filter_button_div"],[]);SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion)}Securden_Popup.showHideAddAccountsButton()},removeBackShowAccountDetailsButton:function(){SecurdenExtensionUtils.showHide(["accounts_right_pane","accounts_details_parent"],["accounts_list_parent","loading","search_parent","top_menu_wrap","change_password_wrap"]),Securden_Popup.accountMenuAdded&&SecurdenExtensionUtils.showHide(["account_menu_button"],[])},widthRevertForFormFieldSave:function(){$("body").removeClass("width640"),$(".container").removeClass("max-width640")},removeBackFormFieldSave:function(){Securden_Popup.widthRevertForFormFieldSave(),Securden_Popup.removeBackButton()},copyAccountName:function(e,t){if(SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t||(t=$(this).attr("account_name")),null!=t&&null!=t)SecurdenExtensionUtils.copyToClipboard(t,browser.i18n.getMessage("account_name_copied"));else{var n=browser.i18n.getMessage("account_name_copy_error");SecurdenExtensionUtils.showStatusMsg("error_msg",n,3e3)}},autoLogon:function(e){SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.stopEventPropagation(e);var t=$(this).parent().parent().parent().attr("account_id"),n=$(this).parent().parent().parent().attr("account_name"),o=$(this).parent().parent().parent().attr("account_url"),i=$(this).parent().parent().parent().attr("account_remote_permission"),r=e.target;null!=i&&null!=i||(i=r.getAttribute("account_remote_permission")),null!=t&&null!=t||(t=r.getAttribute("account_id")),null!=n&&null!=n||(n=r.getAttribute("account_name")),null!=o&&null!=o||(o=r.getAttribute("account_url")),Securden_Popup.accountRemotePermission=i,Securden_Popup.launchUrlAndFill(t,n,o)},launchUrlWithValues:function(){var e=Securden_Popup.accountId,t=Securden_Popup.accountName,n=Securden_Popup.computerDns;null!=n&&null!=n||(n=Securden_Popup.accountUrl),Securden_Popup.launchUrlAndFill(e,t,n)},launchUrlAndFill:function(e,t,n){var o=Securden_Popup.accountRemotePermission;Securden_Popup.accountId=e;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion);"true"===o||1==o?browser.tabs.query({active:!0,currentWindow:!0},(function(o){Securden_Popup.tab.id=o[0].id,Securden_Popup.tab.url=o[0].url,Securden_Popup.accountId=e,Securden_Popup.accountName=t,Securden_Popup.accountUrl=n;var i=o[0].url,r=SecurdenExtensionUtils.getDomain(i),s=SecurdenExtensionUtils.getDomain(n);Securden_Popup.accountId=e,Securden_Popup.accountDomain=s,Securden_Popup.accountUrl=n;var a={account_id:e};SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("AUTOFILL_AUDIT_REASON",Securden_Popup.productVersion)&&(a.is_from_autologon=!0);var c=!0;s==r&&(c=!1),Securden_Popup.setAccountIdAndProceed(c)})):Securden_Popup.openNewTab(n)},setAccountIdAndProceed:function(e){var t=Securden_Popup.accountId,n=Securden_Popup.accountDomain,o=Securden_Popup.accountUrl;SecurdenExtensionUtils.sendMessage(null,"setIsLaunchedFromPlugin",{}),browser.tabs.query({active:!0,currentWindow:!0},(function(i){var r=i[0].id;SecurdenExtensionUtils.sendMessage(null,"set_account_id_and_url",{account_id:t,urlDomain:n,currentTabId:r,openNewTab:e},(function(){if(e){if(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/.test(o)&&0!=o.indexOf("http")&&0!=o.indexOf("https")){o="https://"+o}Securden_Popup.openNewTab(o)}else window.close()}))})),Securden_Popup.resetValidateTicketsVariable()},autoLogonSuccess:function(e,t,n){Securden_Popup.showPageAfterLoading();var o=Securden_Popup.accountUrl,i=Securden_Popup.accountName;if(null!=e&&null!=e){var r={username:i,password:e.password,url:o,is_submit:null==data.is_auto_submit_enabled||data.is_auto_submit_enabled};browser.tabs.query({active:!0,currentWindow:!0},(function(e){r.tabId=e[0].id,SecurdenExtensionUtils.sendMessage(null,"autoLoginFromExtension",r,(function(e){window.close()}))}))}Securden_Popup.resetValidateTicketsVariable()},openNewTab:function(e){browser.tabs.create({url:e}),window.close()},remoteConnection:async function(e){if(!Securden_Popup.assetRadioButtonShown||$("#domain_acc_new_server_id").prop("checked")||$("#domain_acc_asset_server_id").prop("checked")){SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.resetValidateTicketsVariable(),SecurdenExtensionUtils.stopEventPropagation(e);var t=$(this).parent().parent().parent().attr("account_id"),n=$(this).parent().parent().parent().attr("account_remote_permission"),o=$(this).parent().parent().parent().attr("account_name"),i=$(this).parent().parent().parent().attr("account_title"),r=$(this).parent().parent().parent().attr("account_url"),s=$(this).parent().parent().attr("computer_dns"),a=$(this).parent().parent().attr("domain_computers_list_page");if(null!=a&&null!=a||(a=$("#domain-computers-select2-div").find(":selected").data("domain-computers-list-page")),null!=a&&null!=a&&(Securden_Popup.fromDomainComputersListPage=!0),null!=t&&null!=t||(t=$(this).parent().parent().attr("account_id")),null!=n&&null!=n||(n=$(this).parent().parent().attr("account_remote_permission")),null!=o&&null!=o||(o=$(this).parent().parent().attr("account_name")),null!=i&&null!=i||(i=$(this).parent().parent().attr("account_title")),null!=r&&null!=r||(r=$(this).parent().parent().attr("account_url")),null!=t&&null!=t||(t=$("#domain-computers-select2-div").find(":selected").data("accountid")),null!=n&&null!=n||(n=$("#domain-computers-select2-div").find(":selected").data("account-remote-permission")),null!=o&&null!=o||(o=$("#domain-computers-select2-div").find(":selected").data("accountname")),null!=i&&null!=i||(i=$("#domain-computers-select2-div").find(":selected").data("accounttitle")),null!=e&&null!=e){var c=e.target;null!=t&&null!=t||(t=c.getAttribute("account_id")),null!=n&&null!=n||(n=c.getAttribute("account_remote_permission")),null!=o&&null!=o||(o=c.getAttribute("account_name")),null!=i&&null!=i||(i=c.getAttribute("account_title")),null!=r&&null!=r||(r=c.getAttribute("account_url")),null!=s&&null!=s||(s=c.getAttribute("computer_dns"))}null!=t&&null!=t||(t=Securden_Popup.accountId),null!=n&&null!=n||(n=Securden_Popup.accountRemotePermission),null!=o&&null!=o||(o=Securden_Popup.accountName),null!=i&&null!=i||(i=Securden_Popup.accountTitle),null!=r&&null!=r||(r=Securden_Popup.accountUrl);var d=null;null!=s&&null!=s||(s=$("#domain-computers-select2-div").find(":selected").data("computerdns")),null!=(d=$("#domain-computers-select2-div").find(":selected").data("identityvalue"))&&null!=d||(d=$("#domain-computers-select2-div").find(":selected").attr("identity_value")),null!=d&&null!=d||(d=Securden_Popup.identityValue),null!=document.getElementById("domain_acc_new_server_id")&&$("#domain_acc_new_server_id").prop("checked")&&(s=$("#domain_acc_new_server_text").val());var u=$(this).attr("asset_type");null!=u&&null!=u||(u=Securden_Popup.asset_type);var l=$(this).parent().parent().parent().attr("sshConnection");if(null!=l&&null!=l||(l=$(this).parent().parent().attr("sshConnection")),null!=e&&null!=e){c=e.target;null!=l&&null!=l||(l=c.getAttribute("sshConnection"))}null!=l&&null!=l||(l=$(this).attr("sshConnection")),Securden_Popup.accountId=t,Securden_Popup.accountRemotePermission=n,Securden_Popup.accountName=o,Securden_Popup.accountTitle=i,Securden_Popup.accountUrl=r,Securden_Popup.validateTicketIdForRemoteConnection=!0,Securden_Popup.asset_type=u,Securden_Popup.sshConnection=l;var _=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion);if("true"===n||1==n){var p={account_id:t},m={account_id:t};null!=s&&null!=s&&(p.computer=s,m.computer=s,Securden_Popup.computerDns=s),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SELECT2_IN_DOMAIN_LIST",Securden_Popup.productVersion)&&null!=d&&null!=d&&(p.identity_value=d,Securden_Popup.identityValue=d),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SSH_SQL_DOMAIN_ACCOUNT",Securden_Popup.productVersion)&&(null==u||null==u?m.os=SecurdenExtensionUtils.getOs():(m.asset_type=u,p.asset_type=u));var f=null,S=null,g=!1,v=!1;if(_)v=!0,S="showTicketIdDiv",f="new_trigger_remote_connection";else SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("DOMAIN_ACCOUNT_RDP_ISSUE_BUILD",Securden_Popup.productVersion)?(v=!0,null==u||null==u?m.os=SecurdenExtensionUtils.getOs():(m.asset_type=u,p.asset_type=u),S="remoteConnectionSuccess",f="new_trigger_remote_connection"):(g=!0,S="remoteConnectionSuccess",f="trigger_remote_connection");if(v){var w=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("DOMAIN_ACCOUNT_PUTTY_BUILD",Securden_Popup.productVersion),h=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("WEB_BASED_RDP",Securden_Popup.productVersion),P=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion),b="is_domain_account";h?(b="get_remote_connection_options",f="trigger_remote_connection_3",P&&(f="trigger_remote_connection_4")):w&&(b="is_domain_account_2",f="trigger_remote_connection_3",P&&(f="trigger_remote_connection_4"));var E=await Securden_Popup.sendRequest({action:b,data:m,onFailureFunc:"errorMsgFunction"}).then((e=>e));if(!E)return;if(E.single_context_menu&&!E.domain_account_context_menu[0].is_disabled){var x=E.domain_account_context_menu;Securden_Popup.callSingleContextMenuAction(x,c)}else if(E.domain_account_context_menu){x=E.domain_account_context_menu;Securden_Popup.showDomainAccountContextMenu(x,c)}else E.display_domain_computers?Securden_Popup.remoteConnectionSuccess(E):E.launch_url?Securden_Popup.launchUrlWithValues():g=!0}g&&Securden_Popup.sendRequest({action:f,data:p,onSuccessFunc:S,onFailureFunc:"errorMsgFunction"})}}else{var y=browser.i18n.getMessage("select_an_option");SecurdenExtensionUtils.showStatusMsg("error_msg",y,3e3)}},personalDomainAccRemoteConnection:async function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e=$(this).attr("asset_type");Securden_Popup.asset_type=e;var t={asset_type:e},n=await Securden_Popup.sendRequest({action:"get_user_remote_connection_details",data:t,onFailureFunc:"errorMsgFunction"}).then((e=>e));SecurdenExtensionUtils.isParamValid(n)?Securden_Popup.showPersonalDomainAccLaunchPage(n):SecurdenExtensionUtils.showPageAfterLoading()},callSingleContextMenuAction:function(e){Securden_Popup.asset_type=e[0].asset_type,Securden_Popup.remoteConnection()},showDomainAccountContextMenu:function(e,t){$("#domain_account_context_menu").empty();for(var n=$("<div>",{class:""}),o=0;o<e.length;o++){var i=e[o].display_name;null!=i&&null!=i||(i=e[o].displayName);var r=i,s="win-domain-dropdown cursor-pointer";(e[o].is_disabled||SecurdenExtensionUtils.isParamValid(e[o].is_enabled)&&!e[o].is_enabled)&&(null!=(r=e[o].disable_text)&&null!=r||(r=e[o].disableMsg),s="win-domain-dropdown-disabled cyb-disable");var a=$("<div>",{class:s,title:r,asset_type:e[o].asset_type}).text(i);e[o].is_enabled?a.click(Securden_Popup.personalDomainAccRemoteConnection):SecurdenExtensionUtils.isParamValid(e[o].is_disabled)&&e[o].is_disabled||a.click(Securden_Popup.remoteConnection),n.append(a)}$("#domain_account_context_menu").append(n),Securden_Popup.showPageAfterLoading();var c=document.getElementById("domain_account_context_menu"),d=Securden_Popup.isMspEdition;SecurdenExtensionUtils.positioningDiv(t,c,!1,d),SecurdenExtensionUtils.showHide(["domain_account_context_menu"],[])},remoteConnectionSuccess:function(e,t,n){var o=Securden_Popup.accountId,i=Securden_Popup.accountName,r=e;if(null!=r&&null!=r){var s=!1;if(r.launch_url&&(s=!0),r.open_url_in_same_window&&!s)r.account_id=o,r.display_domain_computers?(r.remote_view_permission=Securden_Popup.accountRemotePermission,r.account_name=i,r.account_title=Securden_Popup.accountTitle,Securden_Popup.showDomainComputersList(r)):Securden_Popup.openUrlInConnectionPage(r);else if(s)Securden_Popup.launchUrlWithValues();else{var a=r.url;a=a+"&referrer="+encodeURIComponent(Securden_Popup.serverUrl),Securden_Popup.asset_type=null,Securden_Popup.openNewTab(a)}}Securden_Popup.resetValidateTicketsVariable()},setAuthKeySuccess:function(e,t,n){Securden_Popup.openNewTab(Securden_Popup.serverUrl+"/open-rdp-connection")},errorMsgFunction:function(e){Securden_Popup.showPageAfterLoading(),Securden_Popup.showErrorMsg(e),Securden_Popup.clearFlags()},errorMsgFormFieldsFunction:function(e){Securden_Popup.formFieldsForSave=null,Securden_Popup.errorMsgFunction(),Securden_Popup.widthRevertForFormFieldSave()},showErrorMsg:function(e,t,n){SecurdenExtensionUtils.isParamValid(n)||(n=3e3),!SecurdenExtensionUtils.isParamValid(t)&&SecurdenExtensionUtils.isParamValid(e)&&(t=e.responseJSON&&null!=e.responseJSON.message?e.responseJSON.message:null,SecurdenExtensionUtils.isParamValid(t)||(t=null!=e.message?e.message:void 0)),t=null!=t?t:browser.i18n.getMessage("error_in_processing_request"),SecurdenExtensionUtils.showStatusMsg("error_msg",t,n)},successStatusFunc:function(e){var t=e.responseJSON&&null!=e.responseJSON.message?e.responseJSON.message:null;null!=t&&null!=t||(t=null!=e.message?e.message:browser.i18n.getMessage("operation_successful")),SecurdenExtensionUtils.showStatusMsg("success_msg",t,3e3),Securden_Popup.clearFlags()},showDomainComputersList:function(e){Securden_Popup.assetRadioButtonShown=!1;var t=e.domain_computers_list,n=Securden_Popup.asset_type;if(null!=t&&null!=t){var o=t.length,i=e.account_id,r=e.account_name,s=e.account_title,a=e.remote_view_permission;$("body").removeClass("accounts-body"),$("body").addClass("account-details-body");var c=$("<div>",{class:"account-details-header rdp-header"}),d=browser.i18n.getMessage("launch_remote_connection");11==n&&(d=browser.i18n.getMessage("launch_web_application"));var u=$("<h4>",{class:"acc-header-title"}).text(d);c.append(u);var l=$("<span>",{}),_=$("<img>",{class:"back-button",name:"back",title:browser.i18n.getMessage("back"),src:browser.runtime.getURL("images/back.png")});_.click(Securden_Popup.removeBackButton),l.append(_),c.append(l),$("#computers_list_id").empty(),$("#computers_list_id").append(c);var p=$("<div>",{class:"launch-rdp-content"}),m=browser.i18n.getMessage("select_computer_to_launch_connection");11==n&&(m=browser.i18n.getMessage("autofill_url_dialog_help_text"));var f=$("<p>",{class:""}).text(m);p.append(f);var S=s+"("+r+")",g=$("<span>",{class:"domain-account-name"}).text(S);p.append(g),$("#computers_list_id").append(p);var v=$("<div>",{class:"domain-computers-details-wrapper"});if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SELECT2_IN_DOMAIN_LIST",Securden_Popup.productVersion)){var w="show";if(e.add_new_server){Securden_Popup.assetRadioButtonShown=!0;var h=browser.i18n.getMessage("note")+": ";h+=browser.i18n.getMessage("asset_associate_with_domain_account");var P=$("<div>",{class:"domain_acc_new_server_note"}).text(h),b=$("<div>",{class:"domain_acc_new_server_select",id:"domain_acc_asset_server_div_id",value:"asset_server_elem",radio_btn_id:"domain_acc_asset_server_id"});b.click(Securden_Popup.assetRadioBtnDivClick);var E=$("<input type='radio' name='domain_acc_server_type' id='domain_acc_asset_server_id' value='asset_server_elem' /><p>"+browser.i18n.getMessage("choose_an_asset")+"</p>");b.append(E);var x=$("<div>",{class:"domain_acc_new_server_select",id:"domain_acc_new_server_div_id",value:"new_server_elem",radio_btn_id:"domain_acc_new_server_id"});x.click(Securden_Popup.assetRadioBtnDivClick);var y=$("<input type='radio' name='domain_acc_server_type' id='domain_acc_new_server_id' value='new_server_elem' /><p>"+browser.i18n.getMessage("enter_manually")+"</p>");x.append(y);var A=$("<div>",{class:"domain_acc_new_server"});A.append(b),A.append(x),v.append(P),v.append(A),w="hide"}for(var F=$("<div>",{id:"asset_server_elem",class:w}),U=$("<select>",{id:"domain-computers-select2-div"}),k=0;k<o;k++){var I=t[k].text,C=t[k].title,T=t[k].id_val,N=$("<option>",{value:C,account_id:i,computer_dns:C,identity_value:T}).text(I);U.append(N)}F.append(U),v.append(F);var M=$("<div>",{id:"new_server_elem",class:"hide"}),R=browser.i18n.getMessage("enter_asset"),V=$("<input type='text' name='domain_acc_new_server' id='domain_acc_new_server_text' placeholder='"+R+"' />");M.append(V),v.append(M);var B=$("<div>",{class:"cyb-login-btn dialog-btn"}),O=$("<input>",{type:"button",value:browser.i18n.getMessage("connect"),class:"btn btn-primary connect-btn"});O.click(Securden_Popup.remoteConnection),B.append(O),v.append(B),$("#computers_list_id").append(v),$("#domain-computers-select2-div").select2({tags:!1,templateSelection:function(e,t){return $(e.element).attr("data-accountid",i),$(e.element).attr("data-identityvalue",e.element.identity_value),$(e.element).attr("data-computerdns",e.element.value),$(e.element).attr("data-accountname",r),$(e.element).attr("data-accounttitle",s),$(e.element).attr("data-account-remote-permission",a),$(e.element).attr("data-domain-computers-list-page",!0),e.text}}),$("#new_server_elem").keydown((function(e){13==e.keyCode&&(SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.remoteConnection())}))}else{Securden_Popup.assetRadioButtonShown=!1;for(k=0;k<o;k++){C=t[k].text,document.createElement("div");var D=$("<div>",{account_id:i,account_name:r,account_title:s,account_remote_permission:a,computer_dns:C,domain_computers_list_page:!0,class:"launch-rdp-list"}),L=$("<div>",{class:"launch-rdp-list-content"}).text(C),H=$("<div>",{class:"launch-rdp-list-icon"}),q=$("<div>",{class:"cursor-pointer ",name:"launch-rdp-connection",title:browser.i18n.getMessage("launch"),align:"absmiddle",account_id:i});q.click(Securden_Popup.remoteConnection),H.append(q),D.append(L),D.append(H),v.append(D)}$("#computers_list_id").append(v)}SecurdenExtensionUtils.showHide(["computers_list_parent"],["loading"])}},showPersonalDomainAccLaunchPage:function(e){Securden_Popup.assetRadioButtonShown=!1;var t=e.enforce_reason_on_user_remote_connection,n=e.assets_to_display,o=e.personal_domain_accounts_for_user_remote_connection,i=(e.is_user_details_present_in_session,e.session_username,e.session_username,!0);"logged_in_user"!=e.selected_account_id&&e.selected_account_id,e.is_user_details_present_in_session&&(i=!1,credential_username=e.session_username);var r=Securden_Popup.asset_type;if(null!=n&&null!=n){var s=n.length,a=o.length,c=Securden_Popup.removeBackButton;SecurdenExtensionUtils.rightSidePane("personal_domain_acc_parent",browser.i18n.getMessage("launch_remote_connection"),[],[],c);var d=$("<div>",{id:"personal_domain_acc_asset_list_id",class:"launch-rdp-wrapper"});$("#personal_domain_acc_parent").append(d);var u=$("<div>",{class:"domain-computers-details-wrapper"}),l=$("<div>",{class:"launch-rdp-content"}),_=browser.i18n.getMessage("personal_domain_acc_launch_help");11==r&&(_=browser.i18n.getMessage("autofill_url_dialog_help_text"));var p=$("<p>",{class:""}).text(_);l.append(p),d.append(l);for(var m=$("<div>",{id:"personal_domain_acc_elem",class:"show"}),f=$("<select>",{id:"personal-domain-acc-select2-div"}),S=0;S<a;S++){var g=o[S].text,v=o[S].id,w=$("<option>",{value:g,identity_value:v}).text(g);f.append(w)}if(m.append(f),u.append(m),i){var h=$("<div>",{class:"cyb-input-list"}),P=$("<div>",{class:"cyb-form-field password-no-policy user-remote-connection-credential-field"});h.append(P);var b=browser.i18n.getMessage("password")+"*",E=$("<div>",{id:"credential_password_label",class:"cyb-usergroup-label"}).text(b);P.append(E);var x=$("<input>",{id:"credential_password",name:"password",type:"password"});P.append(x),u.append(h)}var y="<b>"+browser.i18n.getMessage("note")+": </b>";y+=browser.i18n.getMessage("asset_select_for_personal_domain_account");var A=$("<div>",{class:"domain_acc_new_server_note"}).html(y);u.append(A);var F=$("<div>",{id:"personal_domain_asset_server_elem",class:"show"}),U=$("<select>",{id:"personal-domain-assets-select2-div"});for(S=0;S<s;S++){var k=n[S].text;v=n[S].id_val,w=$("<option>",{value:k,asset_type:r,computer_dns:k,computer_address:n[S].title,identity_value:v}).text(k);U.append(w)}if(F.append(U),u.append(F),d.append(u),$("#credential_password_label").attr("cyb-element-type","cyb-input-label"),$("#credential_password").attr("cyb-element-type","cyb-input"),$("#personal-domain-acc-select2-div").select2({tags:!1,templateSelection:function(e,t){return $(e.element).attr("data-identityvalue",e.element.identity_value),$(e.element).attr("data-personal-domain-acc-name",e.element.value),$(e.element).attr("data-personal-domain-computers-list-page",!0),e.text}}),$("#personal-domain-assets-select2-div").select2({tags:!1,templateSelection:function(e,t){return $(e.element).attr("data-identityvalue",e.element.identity_value),$(e.element).attr("data-computer_dns",e.element.computer_dns),$(e.element).attr("data-computer-address",e.element.computer_address),$(e.element).attr("data-asset-type",e.element.asset_type),e.text}}),t&&11!=r){var I=document.createElement("div");I.className="cyb-input-list";var C=document.createElement("div");C.className="cyb-form-field cyb-label-focus",C.style.width="100%",C.style.margin="0 0 0 0";(E=document.createElement("div")).className="cyb-usergroup-label",E.innerText=browser.i18n.getMessage("enter_reason")+"*",(x=document.createElement("input")).setAttribute("id","reason_for_launch"),C.appendChild(E),I.appendChild(C),C.appendChild(x),u.append(I)}var T=$("<div>",{class:"cyb-login-btn dialog-btn"}),N=$("<input>",{type:"button",value:browser.i18n.getMessage("connect"),class:"btn btn-primary connect-btn"});N.click(Securden_Popup.userRemoteConnection),T.append(N),u.append(T),SecurdenExtensionUtils.showHide(["personal_domain_acc_parent"],["loading"])}},userRemoteConnection:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=$("#reason_for_launch").val();if(jQuery("#reason_for_launch").parent().find("[divType='errorMsg']").remove(),""!=t){var n=$("#personal-domain-assets-select2-div").find(":selected").data("identityvalue");SecurdenExtensionUtils.isParamValid(n)||(n=$("#personal-domain-assets-select2-div").find(":selected").attr("identity_value"));var o=$("#personal-domain-assets-select2-div").find(":selected").data("computer-address");SecurdenExtensionUtils.isParamValid(o)||(o=$("#personal-domain-assets-select2-div").find(":selected").attr("computer_address"));var i=$("#personal-domain-assets-select2-div").find(":selected").data("asset-type");SecurdenExtensionUtils.isParamValid(i)||(i=$("#personal-domain-assets-select2-div").find(":selected").attr("asset_type"));var r=$("#personal-domain-acc-select2-div").find(":selected").data("identityvalue");SecurdenExtensionUtils.isParamValid(r)||(r=$("#personal-domain-acc-select2-div").find(":selected").attr("identity_value"));var s={computer:o,asset_id:n,asset_type:i};t&&(s.reason=t),"logged_in_user"!=r&&(s.account_id=r,Securden_Popup.accountId=r);var a=$("#credential_password").val();if(SecurdenExtensionUtils.isParamValid(a)){if(""==(a=a.trim())){var c=browser.i18n.getMessage("mandatory_field_cannot_be_empty");return void SecurdenExtensionUtils.showStatusMsg("error_msg",c,3e3)}s.credential_password=a}if(SecurdenExtensionUtils.isParamValid(n)){var d="trigger_user_remote_connection",u="connectComputerAction",l=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("WEB_APP_ASSET_FOR_PERSONAL_DOMAIN",Securden_Popup.productVersion);11==i&&l&&(d="web_application_launch_in_remote",u="openConnectionSuccess"),SecurdenExtensionUtils.showHide[""],Securden_Popup.sendRequest({action:d,data:s,onSuccessFunc:u,onSuccessFuncArg:s,onFailureFunc:"errorMsgFunction"})}else{c=browser.i18n.getMessage("select_computer_asset");SecurdenExtensionUtils.showStatusMsg("error_msg",c,3e3)}}else jQuery("#reason_for_launch").after("<span divType='errorMsg' class='cyb-custom-error'>Enter a valid reason</span>")},connectComputerAction:function(e,t){if(e)if(!e.open_url_in_same_window&&e.is_guacamole)Securden_Popup.openNewTab(e.url);else if(e.open_url_in_same_window)Securden_Popup.openUrlInConnectionPage(e);else{var n=e.url_list;Securden_Popup.checkRemoteServerAvailable(n,0,t)}},openConnectionSuccess:function(e,t){var n=t.computer;if(0==!n.indexOf("http")&&0!=n.indexOf("https")){n="https://"+n}Securden_Popup.openNewTab(n)},checkRemoteServerAvailable:function(e,t,n){if(e.length>1&&t<e.length){var o=e[t].app_server_id;n.app_server_id=o;var i=e[t].check_url+"is_accessible";SecurdenExtensionUtils.ajaxCall({url:i,async:!0,type:"GET",hideFailureMsg:!0,crossDomain:!0,dataType:"json",timeout:3e3,onSuccessFunc:"checkRemoteServerAvailableSuccess",onSuccessFuncArg:n,onFailureFunc:"checkRemoteServerAvailableFailure",onFailureFuncArg:{urlList:e,index:t,triggerRemoteArgs:n}})}else{o=e[0].app_server_id;n.app_server_id=o,Securden_Popup.checkRemoteServerAvailableSuccess({is_accessible:!0},n)}},launchWebBasedRemoteConnection:function(e){var t=e.url;t=t+"&referrer="+encodeURIComponent(Securden_Popup.serverUrl),Securden_Popup.asset_type=null,Securden_Popup.openNewTab(t)},checkRemoteServerAvailableSuccess:function(e,t){e.is_accessible&&Securden_Popup.sendRequest({action:"get_web_based_remote_connection_launch_url",data:t,async:!1,onSuccessFunc:"launchWebBasedRemoteConnection",onFailureFunc:"errorMsgFunction"})},checkRemoteServerAvailableFailure:function(e,t){let n=t.index+1;Securden_Popup.checkRemoteServerAvailable(t.urlList,n,t.triggerRemoteArgs)},openUrlInConnectionPage:function(e){var t=Securden_Popup.accountId;Securden_Popup.asset_type=null;var n={auth_key:e.auth_key};SecurdenExtensionUtils.isParamValid(t)&&(n.account_id=t),Securden_Popup.sendRequest({action:"set_auth_key_in_session",data:n,type:"POST",onSuccessFunc:"setAuthKeySuccess",onFailureFunc:"errorMsgFunction"})},assetRadioBtnClick:function(e){var t=$(this).val();null!=t&&null!=t&&""!=t.trim()&&($("#asset_server_elem").addClass("hide"),$("#new_server_elem").addClass("hide"),$("#"+t).removeClass("hide").addClass("show"))},assetRadioBtnDivClick:function(e){var t=$(this).attr("value"),n=$(this).attr("radio_btn_id");$("#domain_acc_asset_server_id").prop("checked",!1),$("#domain_acc_new_server_id").prop("checked",!1),$("#"+n).prop("checked",!0),$("#asset_server_elem").addClass("hide"),$("#new_server_elem").addClass("hide"),$("#"+t).removeClass("hide").addClass("show")},copyTotp:function(e,t){null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id"));var n={account_id:t};Securden_Popup.sendRequest({action:"get_totp_start_value_server",data:n,onSuccessFunc:"getAccountAttributeFromServerSuccess",onSuccessFuncArg:{is_copy:!0,response_value_key:"current_token",password_field_id:"additional_password_totp_token"},onFailureFunc:"showErrorMsg"})},restoreAccount:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id"));var n=[t],o={};o.account_ids=JSON.stringify(n),Securden_Popup.dataForActionAfterConfirm=o,Securden_Popup.methodForActionAfterConfirm=Securden_Popup.restoreAccountAction,Securden_Popup.getIfConfirmAction(browser.i18n.getMessage("restore_deleted_account"))},restoreAccountAction:function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e=Securden_Popup.dataForActionAfterConfirm;Securden_Popup.sendRequest({action:"recover_accounts",data:e,type:"POST",onSuccessFunc:"restoreAccountSuccess",onFailureFunc:"errorMsgFunction"})},restoreAccountSuccess:function(e){Securden_Popup.successStatusFunc(e);var t=Securden_Popup.topFolderId,n={};SecurdenExtensionUtils.isParamValid(t)&&(n.folder_id=t),Securden_Popup.getAccounts("",n)},permanentDelete:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id"));var n=[t],o={};o.account_ids=JSON.stringify(n),o.delete_permanently=!0,Securden_Popup.dataForActionAfterConfirm=o,Securden_Popup.methodForActionAfterConfirm=Securden_Popup.deleteAccountAction,Securden_Popup.getIfConfirmAction(browser.i18n.getMessage("account_deleted_permanently"))},copyPassword:async function(e,t){SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id"));var n={account_id:t},o=!1;-1!=navigator.userAgent.toLowerCase().indexOf("firefox")&&(o=!0);var i=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion),r=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion),s="get_account_password_auto_submit_status";i?s="get_new_account_password_and_status_2":r&&(s="get_new_account_password_and_status");var a=await Securden_Popup.sendRequest({action:s,data:n,onSuccessFunc:"copyPasswordSuccess",onFailureFunc:"getAccountPasswordError"}).then((e=>e));Securden_Popup.showPageAfterLoading(),a&&Securden_Popup.copyPasswordSuccess(a,t)},copyPasswordSuccess:function(e,t){var n=e;if(n.param&&(n.param.TICKETING_SYSTEM||n.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE)){if(Securden_Popup.accountId=t,Securden_Popup.validateTicketIdForCopy=!0,n.param.TICKETING_SYSTEM&&n.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE){var o=browser.i18n.getMessage("ticket_id");n.param.ticket_id_label&&(o=n.param.ticket_id_label);var i=browser.i18n.getMessage("reason");document.getElementById("id_reason_with_ticket_id").placeholder=i,document.getElementById("id_ticket_id_with_reason").placeholder=o,$("#ticket_id_reason_dialog_help_text").html(browser.i18n.getMessage("ticket_id_reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id_with_reason"))}else if(n.param.TICKETING_SYSTEM){o=browser.i18n.getMessage("ticket_id");n.param.ticket_id_label&&(o=n.param.ticket_id_label),document.getElementById("id_ticket_id").placeholder=o,$("#ticket_id_dialog_help_text").html(browser.i18n.getMessage("ticket_id_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id"))}else{i=browser.i18n.getMessage("reason");document.getElementById("id_reason").placeholder=i,$("#reason_dialog_help_text").html(browser.i18n.getMessage("reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_reason"))}Securden_Popup.enforceReasonOnPasswordRetrieve=n.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE,Securden_Popup.ticketingSystem=n.param.TICKETING_SYSTEM,Securden_Popup.ticketIdLabel=n.param.ticket_id_label,Securden_Popup.accountIdForTicket=n.param.account_id,Securden_Popup.statusCode=n.status_code}else{var r=SecurdenExtensionUtils.basicChecksBeforePasswordAccess(n);if(r.is_valid){var s=n.password,a=browser.i18n.getMessage("password_copied_successfully"),c=window.getSelection();if(window.clipboardData)window.clipboardData.setData("Text",s);else{var d=document.createElement("div");d.innerText=s,d.id="password_box_id",document.body.appendChild(d);var u=document.createRange();u.selectNode(d),c.removeAllRanges(),c.addRange(u);try{document.execCommand("Copy"),SecurdenExtensionUtils.showStatusMsg("success_msg",a,3e3)}catch(e){}$(d).remove()}c.removeAllRanges()}else{var l=r.error_msg,_=r.error_msg_timeout;SecurdenExtensionUtils.showStatusMsg("error_msg",l,_)}}Securden_Popup.fromAccountDetailsPage||Securden_Popup.showHideAddAccountsButton()},getAccountPasswordError:function(e){Securden_Popup.errorMsgFunction(e);var t={param:{ENFORCE_REASON_ON_PASSWORD_RETRIEVE:Securden_Popup.enforceReasonOnPasswordRetrieve,TICKETING_SYSTEM:Securden_Popup.ticketingSystem,account_id:Securden_Popup.accountIdForTicket,ticket_id_label:Securden_Popup.ticketIdLabel},status_code:Securden_Popup.statusCode};Securden_Popup.copyPasswordSuccess(t,Securden_Popup.accountIdForTicket)},showPassword:function(e,t){SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.accountId=t,Securden_Popup.resetValidateTicketsVariable(),Securden_Popup.validateTicketIdForView=!0,Securden_Popup.getAccountPassword(t)},getAccountPassword:function(e){var t={account_id:e},n="get_account_password_auto_submit_status",o="showPasswordSuccess",i=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion),r=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion);i?(n="get_new_account_password_and_status_2",o="showTicketIdDiv"):r&&(n="get_new_account_password_and_status",o="showTicketIdDiv"),Securden_Popup.sendRequest({action:n,data:t,onSuccessFunc:o,onFailureFunc:"getAccountPasswordError"})},showTicketIdDiv:function(e,t,n){e||Securden_Popup.errorMsgFunction(e);var o=e;if(o.param&&o.param.TICKETING_SYSTEM||o.conf_values&&o.conf_values.TICKETING_SYSTEM||o.param&&o.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE||o.conf_values&&o.conf_values.ENFORCE_REASON_ON_PASSWORD_RETRIEVE){if(Securden_Popup.showPageAfterLoading(),o.param.TICKETING_SYSTEM&&o.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE){var i=browser.i18n.getMessage("ticket_id");o.param.ticket_id_label&&(i=o.param.ticket_id_label);var r=browser.i18n.getMessage("reason");document.getElementById("id_reason_with_ticket_id").placeholder=r,document.getElementById("id_ticket_id_with_reason").placeholder=i,$("#ticket_id_reason_dialog_help_text").html(browser.i18n.getMessage("ticket_id_reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id_with_reason"))}else if(o.param.TICKETING_SYSTEM){i=browser.i18n.getMessage("ticket_id");o.param.ticket_id_label&&(i=o.param.ticket_id_label),document.getElementById("id_ticket_id").placeholder=i,$("#ticket_id_dialog_help_text").html(browser.i18n.getMessage("ticket_id_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id"))}else{r=browser.i18n.getMessage("reason");document.getElementById("id_reason").placeholder=r,$("#reason_dialog_help_text").html(browser.i18n.getMessage("reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_reason"))}Securden_Popup.enforceReasonOnPasswordRetrieve=o.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE,Securden_Popup.ticketingSystem=o.param.TICKETING_SYSTEM,Securden_Popup.ticketIdLabel=o.param.ticket_id_label,Securden_Popup.accountIdForTicket=o.param.account_id,Securden_Popup.statusCode=o.status_code}else if(Securden_Popup.validateTicketIdForAutologon||Securden_Popup.validateTicketIdForAutologonOpenNewTab){var s=Securden_Popup.tab.url,a=SecurdenExtensionUtils.getDomain(s);SecurdenExtensionUtils.getDomain(Securden_Popup.accountUrl)==a?Securden_Popup.autoLogonSuccess(e):Securden_Popup.setAccountIdAndProceed(!0)}else Securden_Popup.validateTicketIdForView?Securden_Popup.showPasswordSuccess(e):Securden_Popup.validateTicketIdForRemoteConnection?(SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.remoteConnectionSuccess(e)):Securden_Popup.validateTicketIdForChangeRemotePassword&&Securden_Popup.changeAccountPassword()},showPasswordSuccess:function(e,t,n){Securden_Popup.showPageAfterLoading();var o="password_"+Securden_Popup.accountId,i=e;if(null!=i&&null!=i){var r=i.password,s=i.password_visibility_time||7e3,a=document.getElementById("pin_"+o),c=document.getElementById("show_"+o),d=document.getElementById("hide_"+o);a.innerText=r,c.className="icon-eye hide",d.className="icon-eye-slash show",Securden_Popup.showPasswordTimeout=window.setTimeout((function(){a&&(a.innerText="********"),c&&(c.className="icon-eye show"),d&&(d.className="icon-eye-slash hide")}),s),Securden_Popup.resetValidateTicketsVariable()}},hidePassword:function(e,t){var n="password_"+t;document.getElementById("pin_"+n).innerText="********",document.getElementById("show_"+n).className="icon-eye show",document.getElementById("hide_"+n).className="icon-eye-slash hide"},showAdditionalPassword:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target,n="additional_password_"+t.getAttribute("field_id"),o=t.getAttribute("attribute_value"),i=t.getAttribute("copy_or_view_url");if(SecurdenExtensionUtils.isParamValid(i)){Securden_Popup.getAccountAttributeFromServer(t,!1)}else Securden_Popup.showAdditionalPasswordAttribute(o,n)},showAdditionalPasswordAttribute:function(e,t){if(null!=e&&null!=e&&""!=e){var n=document.getElementById("pin_"+t),o=document.getElementById("show_"+t),i=document.getElementById("hide_"+t);n.innerText=e,o.className="icon-eye hide",i.className="icon-eye-slash show",Securden_Popup.showPasswordTimeout=window.setTimeout((function(){n&&(n.innerText="********"),o&&(o.className="icon-eye show"),i&&(i.className="icon-eye-slash hide")}),5e3)}else document.getElementById("pin_"+t).innerText="--"+browser.i18n.getMessage("not_available")+"--",document.getElementById("copy_img_"+t).className="hide",document.getElementById("show_"+t).className="icon-eye hide",document.getElementById("hide_"+t).className="icon-eye-slash hide"},hideAdditionalPassword:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t="additional_password_"+e.target.getAttribute("field_id");document.getElementById("pin_"+t).innerText="********",document.getElementById("show_"+t).className="icon-eye show",document.getElementById("hide_"+t).className="icon-eye-slash hide"},copyAccountAttribute:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target,n=t.getAttribute("attribute_value"),o=t.getAttribute("attribute_name"),i=t.getAttribute("copy_or_view_url");if(SecurdenExtensionUtils.isParamValid(i)){Securden_Popup.getAccountAttributeFromServer(t,!0)}else if(SecurdenExtensionUtils.isParamValid(n)){var r=o+" "+browser.i18n.getMessage("copied_successfully");SecurdenExtensionUtils.copyToClipboard(n,r)}else{r=browser.i18n.getMessage("error_in_copying")+" "+o;SecurdenExtensionUtils.showStatusMsg("error_msg",r,3e3)}},getAccountAttributeFromServer:function(e,t){var n=e.getAttribute("copy_or_view_url"),o=e.getAttribute("request_type"),i={account_id:e.getAttribute("account_id")},r={is_copy:t,response_value_key:e.getAttribute("response_value_key"),password_field_id:"additional_password_"+e.getAttribute("field_id")};Securden_Popup.sendRequest({action:n,type:o,data:i,onSuccessFunc:"getAccountAttributeFromServerSuccess",onSuccessFuncArg:r,onFailureFunc:"showErrorMsg"})},getAccountAttributeFromServerSuccess:function(e,t){var n=t.response_value_key,o=t.is_copy,i=t.password_field_id,r=null;if(SecurdenExtensionUtils.isParamValid(n)?SecurdenExtensionUtils.isParamValid(e[n])&&(r=e[n]):r=e.value,SecurdenExtensionUtils.isParamValid(r))if(o){var s=browser.i18n.getMessage("copy_totp_success");SecurdenExtensionUtils.copyToClipboard(r,s)}else Securden_Popup.showAdditionalPasswordAttribute(r,i);else{s=null;s=o?browser.i18n.getMessage("error_in_copying")+" "+attributeName:browser.i18n.getMessage("error_in_viewing")+" "+attributeName,SecurdenExtensionUtils.showStatusMsg("error_msg",s,3e3)}},downloadFileSuccess:function(e){var t=null;if(Securden_Popup.validateTicketIdForFileDownload&&(null!=(t=e.result)&&null!=t||(t=e.conf_values)),null!=t&&null!=t||(t=e),null!=t){var n=t.file_download_url;-1==n.indexOf("http")&&-1==n.indexOf("https")&&(n=Securden_Popup.serverUrl+n),Securden_Popup.openNewTab(n)}},downloadFile:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target.getAttribute("file_download_url");-1==t.indexOf("http")&&-1==t.indexOf("https")&&(t=Securden_Popup.serverUrl+t),Securden_Popup.openNewTab(t)},processRequest:function(e,t,n){var o=e.action,i=e.data;switch(o){case"setServerUrlDetails":var r=i.serverUrl;if(i.org_name)var s=i.org_name;else s="";Securden_Popup.setServerUrl(r,s);break;case"setUserNameInLoginPage":Securden_Popup.userName=i;break;case"setSearchTextAndGetAccounts":var a=i;$("#search_accounts").val(a),Securden_Popup.searchAccounts();break;case"setWindowUrlForAddAccount":var c=i;Securden_Popup.setWindowUrlForAddAccount(c);break;case"setFormFieldsForSave":var d=i;Securden_Popup.setFormFieldsForSave(d);break;case"sendRecordedInputs":d=i;Securden_Popup.setRecordedInputData(d);break;case"recordStored":Securden_Popup.recordStored=i.recordedUrl;break;case"timer_opened_success":window.close()}n({data:!0})},validateTicketIdAndReason:async function(e,t){var n="",o="";if(e&&t?(n=$("#id_ticket_id_with_reason").val(),o=$("#id_reason_with_ticket_id").val()):e?n=$("#id_ticket_id").val():t&&(o=$("#id_reason").val()),e&&""==n.trim()){var i=browser.i18n.getMessage("mandatory_field_cannot_be_empty");SecurdenExtensionUtils.showStatusMsg("error_msg",i,3e3)}else if(t&&""==o.trim()){i=browser.i18n.getMessage("mandatory_field_cannot_be_empty");SecurdenExtensionUtils.showStatusMsg("error_msg",i,3e3)}else{SecurdenExtensionUtils.showHide(["loading"],[]);var r={},s=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion);e&&(r.ticket_id=n),s&&t&&(r.reason=o);var a=Securden_Popup.accountId;a&&(r.account_id=a),$("#id_ticket_id").val(""),$("#id_ticket_id_with_reason").val(""),$("#id_reason_with_ticket_id").val(""),$("#id_reason").val("");var c=void 0,d=!0,u=(s=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TICKETING_SYSTEM",Securden_Popup.productVersion));if(Securden_Popup.validateTicketIdForCopy){d=!1;var l="get_account_password_auto_submit_status";s?l="get_new_account_password_and_status_2":u&&(l="get_new_account_password_and_status");var _=await Securden_Popup.sendRequest({action:l,data:r,onFailureFunc:"getAccountPasswordError"}).then((e=>e));if(Securden_Popup.showPageAfterLoading(),!_)return;var p=_;if(p.param&&(p.param.TICKETING_SYSTEM||p.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE))if(Securden_Popup.accountId=a,Securden_Popup.resetValidateTicketsVariable(),Securden_Popup.validateTicketIdForCopy=!0,p.param.TICKETING_SYSTEM&&p.param.ENFORCE_REASON_ON_PASSWORD_RETRIEVE){var m=browser.i18n.getMessage("ticket_id");p.param.ticket_id_label&&(m=p.param.ticket_id_label);var f=browser.i18n.getMessage("reason");document.getElementById("id_reason_with_ticket_id").placeholder=f,document.getElementById("id_ticket_id_with_reason").placeholder=m,$("#ticket_id_reason_dialog_help_text").html(browser.i18n.getMessage("ticket_id_reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id_with_reason"))}else if(p.param.TICKETING_SYSTEM){m=browser.i18n.getMessage("ticket_id");p.param.ticket_id_label&&(m=p.param.ticket_id_label),document.getElementById("id_ticket_id").placeholder=m,$("#ticket_id_dialog_help_text").html(browser.i18n.getMessage("ticket_id_dialog_help_text")),SecurdenExtensionUtils.showHide(["ticket_id_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id"))}else{f=browser.i18n.getMessage("reason");document.getElementById("id_reason").placeholder=f,$("#reason_dialog_help_text").html(browser.i18n.getMessage("reason_dialog_help_text")),SecurdenExtensionUtils.showHide(["reason_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_reason"))}else{var S=SecurdenExtensionUtils.basicChecksBeforePasswordAccess(p);if(S.is_valid){var g=p.password,v=browser.i18n.getMessage("password_copied_successfully"),w=window.getSelection();if(window.clipboardData)window.clipboardData.setData("Text",g);else{var h=document.createElement("div");h.innerText=g,h.id="password_box_id",document.body.appendChild(h);var P=document.createRange();P.selectNode(h),w.removeAllRanges(),w.addRange(P);try{document.execCommand("Copy"),SecurdenExtensionUtils.showStatusMsg("success_msg",v,3e3)}catch(e){}$(h).remove()}w.removeAllRanges()}else{var b=S.error_msg,E=S.error_msg_timeout;r={success:!1,message:b,error_msg_timeout:E};SecurdenExtensionUtils.showStatusMsg("error_msg",b,E)}Securden_Popup.resetValidateTicketsVariable()}}else if(Securden_Popup.validateTicketIdForView||Securden_Popup.validateTicketIdForAutologon)l=Securden_Popup.validateTicketIdForView&&s?"get_new_account_password_and_status_2":u?"get_new_account_password_and_status":"get_account_password_auto_submit_status",c="showPasswordSuccess",Securden_Popup.validateTicketIdForAutologon&&(c="autoLogonSuccess");else if(Securden_Popup.validateTicketIdForAutologonOpenNewTab){if(Securden_Popup.ticketID=n,!u)return void Securden_Popup.setAccountIdAndProceed(!0);l="validate_ticket_id",c="setAccountIdAndProceed"}else if(Securden_Popup.validateTicketIdForRemoteConnection){if(SecurdenExtensionUtils.showHide(["loading"],[]),u){if(l="new_trigger_remote_connection",SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("DOMAIN_ACCOUNT_PUTTY_BUILD",Securden_Popup.productVersion))l="trigger_remote_connection_3",(s=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("REASON_FOR_PASSWORD_RETRIEVAL",Securden_Popup.productVersion))&&(l="trigger_remote_connection_4")}else l="trigger_remote_connection";if(Securden_Popup.computerDns&&(r.computer=Securden_Popup.computerDns),Securden_Popup.identityValue&&(r.identity_value=Securden_Popup.identityValue),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("SSH_SQL_DOMAIN_ACCOUNT",Securden_Popup.productVersion)){var x=Securden_Popup.asset_type;null!=x&&null!=x&&(r.asset_type=x,Securden_Popup.asset_type=null)}c="remoteConnectionSuccess"}else if(Securden_Popup.validateTicketIdForFileDownload){if(Securden_Popup.ticketID=n,!u)return;l="validate_ticket_id_and_download_file",SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("VERSION_CHECK_FOR_FILE_DOWNLOAD",Securden_Popup.productVersion)&&(r.version="2.6.2.0"),SecurdenExtensionUtils.showHide(["loading"],[]),c="downloadFileSuccess"}else Securden_Popup.validateTicketIdForChangeRemotePassword&&(Securden_Popup.ticketID=n,Securden_Popup.changeAccountPassword(),d=!1);d&&Securden_Popup.sendRequest({action:l,data:r,onSuccessFunc:c,onFailureFunc:"invalidTicket"})}},invalidTicket:function(e){Securden_Popup.errorMsgFunction(e);var t={param:{ENFORCE_REASON_ON_PASSWORD_RETRIEVE:Securden_Popup.enforceReasonOnPasswordRetrieve,TICKETING_SYSTEM:Securden_Popup.ticketingSystem,account_id:Securden_Popup.accountIdForTicket,ticket_id_label:Securden_Popup.ticketIdLabel},status_code:Securden_Popup.statusCode};Securden_Popup.showTicketIdDiv(t),SecurdenExtensionUtils.showHide(["ticket_id_div"],[]),SecurdenExtensionUtils.focusElement(document.getElementById("id_ticket_id"))},resetValidateTicketsVariable:function(){Securden_Popup.validateTicketIdForView=!1,Securden_Popup.validateTicketIdForCopy=!1,Securden_Popup.validateTicketIdForAutologon=!1,Securden_Popup.validateTicketIdForAutologonOpenNewTab=!1,Securden_Popup.validateTicketIdForRemoteConnection=!1,Securden_Popup.validateTicketIdForFileDownload=!1,Securden_Popup.validateTicketIdForChangeRemotePassword=!1,Securden_Popup.computerDns=null,Securden_Popup.identityValue=null,Securden_Popup.enforceReasonOnPasswordRetrieve=null,Securden_Popup.ticketingSystem=null,Securden_Popup.accountIdForTicket=null,Securden_Popup.ticketIdLabel=null,Securden_Popup.statusCode=null},closeTicketIdDiv:function(){SecurdenExtensionUtils.showHide([],["ticket_id_div","reason_div","ticket_id_reason_div"]),Securden_Popup.resetValidateTicketsVariable()},showPageAfterLoading:function(){if(Securden_Popup.fromDomainComputersListPage)e=(e=["computers_list_parent"]).concat(Securden_Popup.getTopBandIconsToShow()),SecurdenExtensionUtils.showHide(e,["loading"]);else if(Securden_Popup.fromAccountDetailsPage)SecurdenExtensionUtils.showHide(["accounts_right_pane","accounts_details_parent"],["accounts_list_parent","loading","search_parent","top_menu_wrap"]),Securden_Popup.accountMenuAdded&&SecurdenExtensionUtils.showHide(["account_menu_button"],[]);else if(Securden_Popup.fromAddAccountPage)Securden_Popup.showAddAccountsDivAndFocus();else{var e=["accounts_list_parent","search_parent","top_menu_wrap"];Securden_Popup.addAccountAvailable&&e.push("add_account_button"),e=e.concat(Securden_Popup.getTopBandIconsToShow()),""!=$("#search_accounts").val().trim()&&e.push("clear_search_text_button_div"),SecurdenExtensionUtils.showHide(e,["loading"])}},getTopBandIconsToShow:function(){var e=[],t=!1,n=!1,o=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion);if("firefox"==SecurdenExtensionUtils.getBrowserName()&&(o=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS_IN_FIREFOX",Securden_Popup.productVersion)),Securden_Popup.recordStored){e.push("recorded_url_fields_id");var i=Securden_Popup.recordStored;$("#recorded_url_text").text(browser.i18n.getMessage("fields_captured")),$("#recorded_url_value").text(i),$("#recorded_url_value").attr("title",i),$("#proceed_to_map_input_page").text(browser.i18n.getMessage("proceed")),$("#delete_recording").text(browser.i18n.getMessage("cancel"))}(o&&(e.push("top_folders_wrap_div"),n=!0),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("USER_DETAILS",Securden_Popup.productVersion)?e.push("user_details_div"):e.push("logout_button"),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("PASSWORD_GENERATOR",Securden_Popup.productVersion)&&(e.push("generate_password_div"),t=!0),t?$("#top_menu_wrap").removeClass("single-top-icon"):$("#top_menu_wrap").addClass("single-top-icon"),n?(Securden_Popup.recordStored?$("#accounts_list_id").addClass("max-height360"):$("#accounts_list_id").addClass("max-height400"),$("#filter_accounts_title_id").addClass("filter-search-label"),$("#clear_filter_button_div").removeClass("clear-filter-button-wrapper-old"),$("#clear_filter_button_div").addClass("clear-filter-button-wrapper")):($("#accounts_list_parent").removeClass("top40"),$("#filter_accounts_title_id").removeClass("filter-search-label"),$("#clear_filter_button_div").removeClass("clear-filter-button-wrapper"),$("#clear_filter_button_div").addClass("clear-filter-button-wrapper-old")),Securden_Popup.isMspEdition)?e.push("msp_select2_switch"):SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("USER_DETAILS",Securden_Popup.productVersion)&&$("#user_details_div").appendTo("#top_right_menu_wrap");return Securden_Popup.showPersonalDomainAccContextMenu?(e.push("launch_personal_domain_remote_connection_wrap"),$("#search_parent").removeClass("width100_100"),$("#search_parent").addClass("width100_140")):$("#search_parent").removeClass("width100_140"),e},resendOtp:function(){Securden_Popup.sendRequest({action:"resend_otp",onSuccessFunc:"showOtpMessage",onFailureFunc:"showBackFunc"}),Securden_Popup.hideResendOtp()},showOtpMessage:function(){SecurdenExtensionUtils.showHide(["resend_otp_message","two_factor_mail_otp_resend_id"],[]),window.setTimeout((function(){SecurdenExtensionUtils.showHide([],["resend_otp_message","two_factor_mail_otp_resend_id"])}),5e3)},hideResendOtp:function(){SecurdenExtensionUtils.showHide([],["resend_otp"]),Securden_Popup.hideResendOtpTimer=window.setTimeout((function(){SecurdenExtensionUtils.showHide(["resend_otp","two_factor_mail_otp_resend_id"],[])}),6e4)},showHideAddAccountsButton:function(e){var t=!1;SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("ADD_ACCOUNT",Securden_Popup.productVersion)&&(e&&e.add_account_available||Securden_Popup.addAccountAvailable)&&(Securden_Popup.addAccountAvailable=!0,t=!0),t?SecurdenExtensionUtils.showHide(["add_account_button"],[]):SecurdenExtensionUtils.showHide([],["add_account_button"])},addAccountButtonClick:function(e,t){SecurdenExtensionUtils.showHide(["loading"],[]),null!=e&&null!=e||$("#id_title").val(""),Securden_Popup.isEditAccount=!1;var n={is_exclude_file_type:!0},o=!1;e&&(o=!0),n.is_personal_account=o,Securden_Popup.isPersonalAccount=o,null==t&&null==t?Securden_Popup.accountTypeId=null:"null"==t?(n.account_type_id="",Securden_Popup.accountTypeId=""):(n.account_type_id=t,Securden_Popup.accountTypeId=t),Securden_Popup.sendRequest({action:"is_add_account_available",data:n,onSuccessFunc:"getIsAddAccountAvailableSuccess",onFailureFunc:"getIsAddAccountAvailableFailure"})},getIsAddAccountAvailableSuccess:function(e){if(e){$("#add_accounts_top").empty();var t=Securden_Popup.workText;null!=t&&(t=t.charAt(0).toUpperCase()+t.slice(1),$("#classification_text_work_id").text(t)),SecurdenExtensionUtils.sendMessage(null,"save_work_text",t),Securden_Popup.policyId=e.policies[0].id,Securden_Popup.isFolderNeeded=e.folder_addition_mandatory,Securden_Popup.isFolderPresent=e.is_folder_present,Securden_Popup.oldAccountTypeId=e.original_account_type_id;var n=e.additional_field_details;SecurdenExtensionUtils.isParamValid(n)&&(Securden_Popup.additionalFieldValuePresent=n.is_additional_field_value_is_present),e.form_url_params&&(SecurdenExtensionFormUtils.formUrlParams.add_account_form=e.form_url_params);var o="account_classification_personal_id",i="account_classification_personal_icon_id",r="account_classification_work_id",s="account_classification_work_icon_id";e.is_personal_account&&(Securden_Popup.isPersonalAccount=e.is_personal_account),Securden_Popup.isPersonalAccount&&(o="account_classification_work_id",i="account_classification_work_icon_id",r="account_classification_personal_id",s="account_classification_personal_icon_id"),$("#"+o).removeClass("schedule-check").addClass("schedule-uncheck"),$("#"+i).removeClass("icon-ok"),$("#"+r).removeClass("schedule-uncheck").addClass("schedule-check"),$("#"+s).addClass("icon-ok"),e.add_work_available&&e.add_personal_available?SecurdenExtensionUtils.showHide(["account_classification_wrap_id"],[]):SecurdenExtensionUtils.showHide([],["account_classification_wrap_id"]),e.account_title&&""!=e.account_title.trim()&&($("#id_title").val(e.account_title),b&&""!=b.trim()&&$("#account_title_wrapper_id").addClass("cyb-label-focus"));var a=browser.i18n.getMessage("add_account");e.is_edit_account&&(a=browser.i18n.getMessage("edit_account")),SecurdenExtensionUtils.rightSidePane("add_accounts_top",a);var c=e.account_types,d=c.length,u=document.createElement("select");u.className="cyb-login-select",u.name="account_type",u.id="account_type";for(var l=0;l<d;l++){var _="";_=document.createElement("option");var p=c[l].id;_.textContent=c[l].type_name,_.value=_.id=p,e.account_type_id?c[l].id==e.account_type_id&&(_.selected=!0):null==Securden_Popup.accountTypeId?c[l].is_default&&(_.selected=!0):""==Securden_Popup.accountTypeId?null==c[l].id&&(_.selected=!0):c[l].id==Securden_Popup.accountTypeId&&(_.selected=!0),u.appendChild(_)}$("#extension_add_account_select_input").empty(),$("#add_account_details_wrapper_div_id").empty(),document.getElementById("extension_add_account_select_input").appendChild(u);var m=e.folders,f=(e.selected_folder,e.account_type_columns),S=f.length;for(l=0;l<S;l++){var g=f[l],v=g.attr_display_name,w=g.extra_attr,h=1==g.extra_attr.field_display_type,P=3!=g.extra_attr.field_display_type,b=g.value;if("folder_names"==g.attr_name){var E=Securden_Popup.createInputWrapperField(v,h,m,w);document.getElementById("add_account_details_wrapper_div_id").appendChild(E),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FOLDER_TREE_IN_ADD_ACCOUNT",Securden_Popup.productVersion)&&"firefox"!=SecurdenExtensionUtils.getBrowserName()||$("#folders-select2-div").select2({tags:!0,templateSelection:function(e,t){return $(e.element).attr("data-id",e.element.id),e.text}})}else if("tags"==g.attr_name){SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TAGS_SELECT_IN_ADD_ACCOUNT",Securden_Popup.productVersion)&&"firefox"!=SecurdenExtensionUtils.getBrowserName()||$("#tags-select2-div").select2({tags:!0,templateSelection:function(e,t){return $(e.element).attr("data-id",e.element.id),e.text}})}else if("date_field"==g.extra_attr.type){E=Securden_Popup.createInputWrapperField(v,h,b,w);document.getElementById("add_account_details_wrapper_div_id").appendChild(E);var x="dd/mm/yyyy";e.date_time_format&&(x=e.date_time_format);const t=document.querySelector('input[name="'+g.extra_attr.name+'"]');$(t).attr("readonly","readonly");new Datepicker(t,{format:x,minDate:new Date,autohide:!0,language:"en"})}else if(P){E=Securden_Popup.createInputWrapperField(v,h,b,w);if(document.getElementById("add_account_details_wrapper_div_id").appendChild(E),"expiry_date"==g.attr_name){x="dd/mm/yyyy";e.date_time_format&&(x=e.date_time_format),window.setTimeout((function(){const e=document.querySelector('input[name="expiry_date"]');new Datepicker(e,{format:x,autohide:!0,language:"en"})}),300)}}}$("#account_type").change((function(e){Securden_Popup.changeAccountType(e)})),e.is_edit_account||SecurdenExtensionUtils.sendMessage(null,"get_window_url",{}),Securden_Popup.showAddAccountsDivAndFocus()}},setWindowUrlForAddAccount:function(e){e&&$("#id_address")&&($("#id_address").val(e),$("#id_address").parent().addClass("cyb-label-focus"))},createFolderDiv:function(){$("#add_account_folders_wrap").empty();var e=document.getElementById("add_account_folders_wrap"),t=document.createElement("div");t.className="input-group";var n=document.createElement("input");n.type="text",n.placeholder=browser.i18n.getMessage("search_node"),n.id="search_folders_text_box",t.appendChild(n),e.appendChild(t);var o=document.createElement("div");o.id="add_account_folders",e.appendChild(o),SecurdenExtensionUtils.positioningDiv(document.getElementById("folders_wrappers_div"),document.getElementById("add_account_folders_wrap")),SecurdenExtensionUtils.showHide(["add_account_folders_wrap"],[]);Securden_Popup.createFolderTree("add_account_folders","search_folders_text_box",!1),Securden_Popup.folderTreeAddSearch("search_folders_text_box","add_account_folders"),Securden_Popup.folderTreeAddSelect("add_account_folders","folderTreeNodeSelectForAddAccount"),document.addEventListener("scroll",(function(e){var t=e.target;t.getAttribute("id")&&"folders-select2-div"!=t.getAttribute("id")&&"folders_wrappers_div"!=t.getAttribute("id")&&"add_account_folders_wrap"!=t.getAttribute("id")&&SecurdenExtensionUtils.showHide([],["add_account_folders_wrap"])}),!0)},createFolderTree:function(e,t,n){var o=Securden_Popup.getTreeUrl(t,n);$("#"+e).jstree({core:{data:{url:o,data:function(e){return{folder_id:e.id}}}},search:{case_insensitive:!0,show_only_matches:!0},types:{default:{icon:"icon-folder"}},plugins:["search","sort","types","wholerow"]})},createFolderTreeFromData:function(e,t,n){SecurdenExtensionUtils.isParamValid(n)||(n=["search","sort","types","wholerow"]),$("#"+e).jstree({core:{data:t},search:{case_insensitive:!0,show_only_matches:!0},types:{default:{icon:"icon-folder"}},plugins:n,sort:function(e,t){var n=this.get_text(e),o=this.get_text(t);return n&&o?n.toLowerCase()>o.toLowerCase()?1:-1:n>o?1:-1}}),$.jstree.defaults.sort=function(e,t){var n=this.get_text(e),o=this.get_text(t);return n&&o?n.toLowerCase()>o.toLowerCase()?1:-1:n>o?1:-1}},folderTreeAddSearch:function(e,t){$("#"+e).keyup((function(n){SecurdenExtensionUtils.stopEventPropagation(n);var o=$("#"+e).val();$("#"+t).jstree(!0).show_all(),$("#"+t).jstree("search",o)})),$("#"+t).on("search.jstree",(function(e,n,o){0===n.nodes.length&&$("#"+t).jstree(!0).hide_all()}))},folderTreeAddSelect:function(e,t){$("#"+e).on("select_node.jstree",(function(e,n){var o=n.node.id,i=n.node.a_attr.title;if(!SecurdenExtensionUtils.isParamValid(i))i=n.node.text;SecurdenExtensionUtils.isParamValid(t)&&($("#top_folders_wrap_div").removeClass("top_folders_list_div_open"),window.Securden_Popup[t](o,i))}))},setTreeNodeSelection:function(e,t){$("[div-type='selected-node']").find(".jstree-wholerow").removeClass("jstree-wholerow-clicked"),$("[div-type='selected-node']").find(".jstree-clicked").removeClass("jstree-clicked"),t&&(e=Securden_Popup.topFolderId);var n=document.getElementById(e);n.className=n.className+" jstree-wholerow-clicked",n.setAttribute("div-type","selected-node");var o=document.getElementById(e+"_anchor");o.className=o.className+" jstree-clicked",Securden_Popup.focusTreeNodeElement(e)},focusTreeNodeElement:function(e,t){if(null!=e&&$("#"+e).find(".jstree-wholerow").length>0)if(t)$("#"+e).find(".jstree-wholerow")[0].scrollIntoView(!1);else{var n=$(".folder-tree-view").offset().top+200,o=$("#"+e).find(".jstree-wholerow").offset().top,i=0;o<0?(i=$(".folder-tree-view").scrollTop()+o-n)<0&&(i=0):o>n&&(i=o-n),$(".folder-tree-view").scrollTop(i)}},folderTreeNodeSelectForAddAccount:function(e,t){Securden_Popup.folderId=e,$("#folders-select2-div").empty();var n=document.getElementById("folders-select2-div"),o="";(o=document.createElement("option")).textContent=t,o.value=o.id=e,o.selected=!0,n.appendChild(o);var i=document.createElement("i");i.className="icon-down",n.appendChild(i),SecurdenExtensionUtils.showHide([],["add_account_folders_wrap"])},topFolderTreeNodeSelect:function(e,t){SecurdenExtensionUtils.stopEventPropagation(event),Securden_Popup.topFolderId=e,SecurdenExtensionUtils.isParamValid(t)&&$("#top_folders_text_div").text(t),Securden_Popup.searchAccounts(),Securden_Popup.closeTopFoldersDiv()},getTreeUrl:function(e,t){var n=Securden_Popup.serverUrl+"/browser_extension_api/get_child_folders",o=Securden_Popup.topFolderId;if(t){if(n=n+"?is_managed_owned=false&is_add_account=false&selected_folder_id="+o+"&should_check_collapse_flag=true",SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion)&&(n+="&include_none_node=false"),SecurdenExtensionUtils.isParamValid(e)){var i=$("#"+e).val();""!=i.trim()&&(n=n+"&search_string="+i)}}else n+="?is_managed_owned=true&is_add_account=true&selected_folder_id=#&should_check_collapse_flag=true";return n},createInputWrapperField:function(e,t,n,o){var i=document.createElement("div");i.className="cyb-input-list";var r=document.createElement("div"),s="cyb-form-field";if(o.default_value)var a=o.default_value;"password"==o.type&&(s+=" password-no-policy"),"textarea"==o.type||a?s+=" cyb-input-filled cyb-textarea-field":s+=" ",("string"==typeof n&&""!=n.trim()||"object"==typeof n&&null!=n&&null!=n)&&(s+=" cyb-label-focus"),r.className=s,i.appendChild(r);var c=document.createElement("div"),d="cyb-usergroup-label";("textarea"==o.type||a)&&(d+=" cyb-textarea-label"),c.className=d,c.setAttribute("cyb-element-type","cyb-input-label"),"folder"==o.type&&Securden_Popup.isFolderNeeded&&(t=!0),t&&(e+="*"),c.innerText=e,r.appendChild(c);var u=document.createElement("input");if("textarea"==o.type)u=document.createElement("textarea");else if("folder"==o.type){if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FOLDER_TREE_IN_ADD_ACCOUNT",Securden_Popup.productVersion)&&"firefox"!=SecurdenExtensionUtils.getBrowserName()){m=(p=n).length;(u=document.createElement("div")).id="folders_wrappers_div";S="show";3==o.field_display_type&&(S="hide",i.className=i.className+" hide"),u.className=S;var l="";(f=document.createElement("div")).className="custom-select",f.name=o.name,f.id="folders-select2-div";for(g=!1,v=0;v<m;v++)"selected"in p[v]&&p[v].selected&&(l=p[v].text,Securden_Popup.folderId=p[v].id,g=!0);g||(Securden_Popup.folderId=null,l=browser.i18n.getMessage("__none__")),f.innerText=l;var _=document.createElement("i");_.className="icon-down",f.appendChild(_),u.appendChild(f)}else{var p,m=(p=n).length;(u=document.createElement("div")).id="folders_wrappers_div";var f,S="show";3==o.field_display_type&&(S="hide",i.className=i.className+" hide"),u.className=S,(f=document.createElement("select")).name=o.name,f.id="folders-select2-div";for(var g=!1,v=0;v<m;v++){var w="";w=document.createElement("option");var h=p[v].id;w.textContent=p[v].text,w.value=w.id=h,"selected"in p[v]&&p[v].selected&&(Securden_Popup.folderId=h,g=!0,w.selected=!0),f.appendChild(w)}g||(Securden_Popup.folderId=null),u.appendChild(f)}}if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FOLDER_TREE_IN_ADD_ACCOUNT",Securden_Popup.productVersion)&&"firefox"!=SecurdenExtensionUtils.getBrowserName()&&$("#folders_wrappers_div").click((function(){Securden_Popup.createFolderDiv()})),"folder"!=o.type){for(var P in o)u.setAttribute(P,o[P]);u.setAttribute("cyb-element-type","cyb-input"),t&&u.setAttribute("cyb-mandatory",!0),u.value=n}a&&$(u).val(a),r.appendChild(u);var b=document.createElement("div");if(b.className="password-action-wrapper top10","password"==o.type){var E=document.createElement("div");E.id="show_password_"+o.id,E.name="show",E.title=browser.i18n.getMessage("show_password"),E.className="icon-eye show zIndex100",E.onclick=function(e){Securden_Popup.showPasswordInputElement(e,o.id)},b.appendChild(E);var x=document.createElement("div");x.id="hide_password_"+o.id,x.name="hide",x.title=browser.i18n.getMessage("hide_password"),x.className="icon-eye-slash hide zIndex100",x.onclick=function(e){Securden_Popup.hidePasswordInputElement(e,o.id)},b.appendChild(x);var y=document.createElement("div");y.id="generate_password",y.name="generate",y.title=browser.i18n.getMessage("generate_password"),y.className="icon-eye zIndex100 icon-generate",y.onclick=function(e){Securden_Popup.generatePassword(e,o.id)},b.appendChild(y),r.appendChild(b)}return o.type&&"hidden"!=o.type?i:u},getIsAddAccountAvailableFailure:function(e){Securden_Popup.errorMsgFunction(e);var t=["accounts_list_parent","search_parent","top_menu_wrap","add_account_button"];t=t.concat(Securden_Popup.getTopBandIconsToShow()),SecurdenExtensionUtils.showHide(t,["loading"])},addAccount:function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e=SecurdenExtensionFormUtils.getFormData("add_account_form"),t=!1;Securden_Popup.isPersonalAccount&&(t=Securden_Popup.isPersonalAccount),null!=e.account_type&&"null"!=e.account_type||(e.account_type=""),e.personal_account=t;var n=Securden_Popup.folderId;if(SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FOLDER_TREE_IN_ADD_ACCOUNT",Securden_Popup.productVersion)&&"firefox"!=SecurdenExtensionUtils.getBrowserName()||(n=$("#folders-select2-div").find(":selected").data("id")),!t&&Securden_Popup.isFolderNeeded&&(null==n||null==n||0==n||"0"==n)){var o=browser.i18n.getMessage("select_folder_add_account");return Securden_Popup.isEditAccount&&(o=browser.i18n.getMessage("select_folder_edit_account")),Securden_Popup.isFolderPresent||(o=SecurdenExtensionUtils.featureAllowed("add_folder")?Securden_Popup.isEditAccount?browser.i18n.getMessage("select_folder_edit_account_no_folder"):browser.i18n.getMessage("select_folder_add_account_no_folder"):Securden_Popup.isEditAccount?browser.i18n.getMessage("select_folder_edit_account_no_folder_permission"):browser.i18n.getMessage("select_folder_add_account_no_folder_permission")),SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3),void Securden_Popup.showAddAccountsDivAndFocus()}null!=n&&null!=n||(n=0),e.folder_id=n;var i="add_account_from_addon";Securden_Popup.isEditAccount&&(i="edit_account_from_addon"),Securden_Popup.sendRequest({action:i,data:e,type:"POST",onSuccessFunc:"addAccountSuccess",onFailureFunc:"addAccountFailure"})},validateFormAndEditAccount:function(){var e=SecurdenExtensionFormUtils.validateForm("add_account_form"),t=$("#id_title").val();if(e){var n=$("#account_type").val();t.match(/.*/)&&(n!=Securden_Popup.oldAccountTypeId&&Securden_Popup.additionalFieldValuePresent?(Securden_Popup.methodForActionAfterConfirm=Securden_Popup.addAccount,Securden_Popup.getIfConfirmAction(browser.i18n.getMessage("information_lost_on_converting_account_type")+" "+browser.i18n.getMessage("do_you_want_to_proceed")+"?")):Securden_Popup.addAccount())}},addAccountSuccess:function(e){$("#top_folders_text_div").text(Securden_Popup.ALL_ACCOUNTS_ID),Securden_Popup.topFolderId=Securden_Popup.ALL_ACCOUNTS_ID,"firefox"==SecurdenExtensionUtils.getBrowserName()&&($("#top-folders-select2-div").val(Securden_Popup.ALL_ACCOUNTS_ID),$("#top-folders-select2-div").select2().trigger("change")),$("#id_title").val(""),Securden_Popup.resetPageShowVariables(),window.clearTimeout(Securden_Popup.showPasswordElementTimeout),Securden_Popup.successStatusFunc(e);var t=$("#search_accounts").val();Securden_Popup.getAccounts(t)},addAccountFailure:function(e){window.clearTimeout(Securden_Popup.showPasswordElementTimeout),Securden_Popup.showErrorMsg(e),Securden_Popup.showAddAccountsDivAndFocus()},getBaseCheckParams:function(e,t){var n={},o=$("#account_type").val();return t?n.account_title=encodeURIComponent(e):n.account_name=encodeURIComponent(e),n.account_title_check=t,n.account_address=encodeURIComponent($("#id_address").val()),null!=o&&"null"!=o||(o=""),n.account_type_id=o,Securden_Popup.isEdit&&(n.account_id=Securden_Popup.account_id),n},checkAccountValues:async function(){Securden_Popup.fromAddAccountPage=!0;var e=$("#id_title").val();if(SecurdenExtensionFormUtils.validateForm("add_account_form")){SecurdenExtensionUtils.showHide(["loading"],[]);$("#account_type").val();if(e.match(/.*/)){var t=Securden_Popup.getBaseCheckParams(e,!0),n=await Securden_Popup.sendRequest({action:"check_username_available",data:t,type:"POST"}).then((e=>e));null!=n&&null!=n&&n.available?Securden_Popup.addAccount():Securden_Popup.errorMsgFunction(n)}}},selectAccountCategory:function(e){SecurdenExtensionUtils.showHide(["loading"],[]);var t=!0;e&&(t=!1),Securden_Popup.addAccountButtonClick(t)},showAddAccountsDivAndFocus:function(){SecurdenExtensionUtils.showHide(["add_accounts_div"],["loading","add_account_button"]),"edge"==SecurdenExtensionUtils.getBrowserName()?SecurdenExtensionUtils.focusElement(document.getElementById("id_title"),2e3):SecurdenExtensionUtils.focusElement(document.getElementById("id_title"))},showPasswordInputElement:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e);var n=document.getElementById(t);if(null!=n&&null!=n){n.type="text";var o=document.getElementById("show_password_"+t),i=document.getElementById("hide_password_"+t);o.className="icon-eye hide zIndex100",i.className="icon-eye-slash show zIndex100"}Securden_Popup.showPasswordElementTimeout=window.setTimeout((function(){Securden_Popup.hidePasswordInputElement(e,t)}),7e3)},hidePasswordInputElement:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e),window.clearTimeout(Securden_Popup.showPasswordElementTimeout);var n=document.getElementById(t);null!=n&&null!=n&&(n.type="password",document.getElementById("show_password_"+t).className="icon-eye show zIndex100",document.getElementById("hide_password_"+t).className="icon-eye-slash hide zIndex100")},copyPasswordElement:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e);var n=$("#"+t).val();if(null!=n&&null!=n&&""!=n.trim()){var o=browser.i18n.getMessage("password_copied_successfully");SecurdenExtensionUtils.copyToClipboard(n,o)}else{o=browser.i18n.getMessage("password_is_empty");SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3)}},generatePasswordWithRules:function(){if(SecurdenExtensionFormUtils.validateForm("password_generator_form")){for(var e=$("#min_length").val(),t=$("#denied_chars").val(),n="yes"==$("#generate_password_start_alphabet").val(),o=[{id:"numerals",icon_id:"generate_password_numeral_icon_id_hidden_id"},{id:"uppercase",icon_id:"generate_password_uppercase_icon_id_hidden_id"},{id:"lowercase",icon_id:"generate_password_lowercase_icon_id_hidden_id"},{id:"specialchars",icon_id:"generate_password_special_characters_icon_id_hidden_id"}],i=[],r=0;r<o.length;r++){var s={};s.id=o[r].id;var a=parseInt($("#"+o[r].id).val()),c="true"==$("#"+o[r].icon_id).val();c||(a=0),s.min_length=a,s.is_enabled=c,i.push(s)}var d={policy_name:"Addon generate password policy",min_length:e,denied_chars:t,required_complexity:4,complexity_elements:JSON.stringify(i),starts_with_alphabet:n};Securden_Popup.passwordElementId="id_generate_password_pwd",Securden_Popup.sendRequest({action:"get_generated_password_with_rules",data:d,onSuccessFunc:"generatePasswordSuccess",onFailureFunc:"showErrorMsg"})}},generatePassword:function(e,t){var n={is_personal_account:Securden_Popup.isPersonalAccount,policy_id:""};Securden_Popup.policyId&&(n.policy_id=Securden_Popup.policyId),Securden_Popup.isPersonalAccount&&(n.is_personal_account=Securden_Popup.isPersonalAccount),Securden_Popup.passwordElementId=t,Securden_Popup.sendRequest({action:"get_generated_password",data:n,onSuccessFunc:"generatePasswordSuccess",onFailureFunc:"showErrorMsg"})},generatePasswordSuccess:function(e){e&&e.password&&Securden_Popup.passwordElementId&&(document.getElementById(Securden_Popup.passwordElementId).value=e.password,$("#"+Securden_Popup.passwordElementId).parent().addClass("cyb-label-focus"))},editAccount:function(e,t,n){SecurdenExtensionUtils.stopEventPropagation(e),Securden_Popup.isEditAccount=!0,null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id")),null!=t&&null!=t&&(Securden_Popup.accountId=t),SecurdenExtensionUtils.showHide(["loading"],[]);var o={};o.account_id=t,null==n&&null==n?Securden_Popup.accountTypeId=null:"null"==n?(o.account_type_id="",Securden_Popup.accountTypeId=""):(o.account_type_id=n,Securden_Popup.accountTypeId=n),Securden_Popup.sendRequest({action:"get_edit_account_details",data:o,onSuccessFunc:"getIsAddAccountAvailableSuccess",onFailureFunc:"getIsAddAccountAvailableFailure"})},deleteAccount:function(e,t,n){SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t||(t=$(this).parent().parent().parent().attr("account_id"));var o=[t],i={};i.account_ids=JSON.stringify(o),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("PERMANENT_DELETE_AND_RESTORE_ACCOUNT",Securden_Popup.productVersion)&&(i.delete_permanently=!1),Securden_Popup.dataForActionAfterConfirm=i,Securden_Popup.methodForActionAfterConfirm=Securden_Popup.deleteAccountAction,Securden_Popup.getIfConfirmAction(browser.i18n.getMessage("account_deleted_for_one_day"),n)},deleteAccountAction:function(e){SecurdenExtensionUtils.showHide(["loading"],[]);var t=Securden_Popup.dataForActionAfterConfirm;SecurdenExtensionUtils.isParamValid(e)&&(t.reason=e),successFunc="deleteAccountSuccess",t.delete_permanently&&(successFunc="permanentDeleteAccountSuccess"),Securden_Popup.sendRequest({action:"delete_accounts",data:t,type:"POST",onSuccessFunc:successFunc,onFailureFunc:"errorMsgFunction"})},deleteAccountSuccess:function(e){Securden_Popup.successStatusFunc(e);var t=$("#search_accounts").val();Securden_Popup.getAccounts(t)},permanentDeleteAccountSuccess:function(e){Securden_Popup.successStatusFunc(e);var t=Securden_Popup.topFolderId,n={};SecurdenExtensionUtils.isParamValid(t)&&(n.folder_id=t),Securden_Popup.getAccounts("",n)},changeAccountType:function(e){var t=$("#account_type").val();Securden_Popup.isEditAccount?Securden_Popup.editAccount(e,Securden_Popup.accountId,t):Securden_Popup.addAccountButtonClick(Securden_Popup.isPersonalAccount,t)},clearFlags:function(){Securden_Popup.policyId=null,Securden_Popup.isPersonalAccount=!1},resetPageShowVariables:function(){Securden_Popup.fromDomainComputersListPage=!1,Securden_Popup.fromAccountDetailsPage=!1,Securden_Popup.assetRadioButtonShown=!1,Securden_Popup.fromAddAccountPage=!1},sendRequest:function(e){return e.onSuccessFuncFile="Securden_Popup",e.onFailureFuncFile="Securden_Popup",SecurdenExtensionUtils.sendRequest(e)},getIfConfirmAction:function(e,t){null!=e&&null!=e||(e=browser.i18n.getMessage("do_you_want_to_proceed")+"?"),document.getElementById("confirm_div_text").innerText=e;var n=["confirm_div"],o=[];Securden_Popup.confirmOnDelete=!1,SecurdenExtensionUtils.isParamValid(t)&&t?(n.push("enforce_reason_text_box"),Securden_Popup.confirmOnDelete=!0):o.push("enforce_reason_text_box"),SecurdenExtensionUtils.showHide(n,o)},confirmAction:function(){var e="";if(Securden_Popup.confirmOnDelete&&""==(e=$("#enforce_reason_text_id").val()).trim()){var t=browser.i18n.getMessage("mandatory_field_cannot_be_empty");SecurdenExtensionUtils.showStatusMsg("error_msg",t,3e3)}else{SecurdenExtensionUtils.showHide([],["confirm_div"]);var n=Securden_Popup.methodForActionAfterConfirm;Securden_Popup.confirmOnDelete?(n(e),$("#enforce_reason_text_id").val("")):n(),Securden_Popup.clearConfirmData()}},confirmCancel:function(){SecurdenExtensionUtils.showHide([],["confirm_div"]),Securden_Popup.clearConfirmData()},clearConfirmData:function(){Securden_Popup.dataForActionAfterConfirm=null,Securden_Popup.methodForActionAfterConfirm=null},showChangePasswordPage:function(e,t){if(SecurdenExtensionUtils.stopEventPropagation(e),null!=t&&null!=t){var n={account_id:t};Securden_Popup.accountId=t,SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.sendRequest({action:"get_change_account_password_details",data:n,onSuccessFunc:"showChangePasswordPageSuccess",onFailureFunc:"errorMsgFunction"})}else{var o=browser.i18n.getMessage("invalid_account");SecurdenExtensionUtils.showStatusMsg("error_msg",o,3e3)}},showChangePasswordPageSuccess:function(e){var t=["change_password_wrap"],n=["loading"];$("#change_account_password_top").empty();var o=Securden_Popup.removeBackShowAccountDetailsButton;SecurdenExtensionUtils.rightSidePane("change_account_password_top",browser.i18n.getMessage("change_password"),[],[],o),$("#change_account_password_fields_wrapper_div_id").empty(),Securden_Popup.isPersonalAccount=e.is_personal_account,e&&e.full_policy_details&&(Securden_Popup.policyId=e.full_policy_details.policy_id);for(var i=e.change_password_columns,r=i.length,s=0;s<r;s++){var a=i[s],c=a.attr_display_name,d=a.extra_attr,u=!(!a.extra_attr||1!=a.extra_attr.field_display_type),l=a.value,_=Securden_Popup.createInputWrapperField(c,u,l,d);document.getElementById("change_account_password_fields_wrapper_div_id").appendChild(_)}if(e.is_remote_reset_supported&&SecurdenExtensionUtils.featureAllowed("remote_password_reset")){if(Securden_Popup.is_remote_reset_supported=!0,t.push("remote_checkbox_wrap_div_id"),SecurdenExtensionUtils.isParamValid(e.default_remotepasswordchange)){var p=e.default_remotepasswordchange;$("#change_password_is_remote").val(!1),$("#remote_checkbox_icon_id").removeClass("icon-check").addClass("icon-uncheck"),p&&SecurdenExtensionUtils.toggleCheckbox("remote_checkbox_icon_id","change_password_is_remote")}}else Securden_Popup.is_remote_reset_supported=!1,n.push("remote_checkbox_wrap_div_id");$("#complexity_details_heading").text(browser.i18n.getMessage("complexity_details_heading"));var m=e.full_policy_details.policy_details,f=m.length;$("#policy_details_id").empty();var S=document.getElementById("policy_details_id"),g=document.createElement("ol");for(s=0;s<f;s++){var v=m[s],w=v.statement,h=document.createElement("li");h.className="policy-info-subheader",h.innerText=w;var P=null;if(v.is_complexity){(P=document.createElement("ul")).className="complexity-details";for(var b=e.full_policy_details.complexity_details,E=b.length,x=0;x<E;x++){var y=document.createElement("li");y.innerText=b[x],P.appendChild(y)}}g.appendChild(h),null!=P&&g.appendChild(P)}S.appendChild(g),SecurdenExtensionUtils.showHide(t,n)},changeAccountPasswordCheck:async function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e=["change_password_wrap"],t=["loading"];if(Securden_Popup.is_remote_reset_supported?e.push("remote_checkbox_wrap_div_id"):t.push("remote_checkbox_wrap_div_id"),SecurdenExtensionFormUtils.validateForm("change_account_password_form")){var n=$("#new_password").val(),o={account_id:Securden_Popup.accountId},i="true"==$("#change_password_is_remote").val();o.is_remote=i,o.new_password=encodeURIComponent(n);var r=await Securden_Popup.sendRequest({action:"get_enforce_policy_flag_with_ticketing_system",data:o}).then((e=>e));if(r){if("string"==typeof r)return SecurdenExtensionUtils.showHide(e,t),void SecurdenExtensionUtils.showStatusMsg("error_msg",r,3e3);if(r.same_old_password&&r.is_enforced){SecurdenExtensionUtils.showHide(e,t);var s=browser.i18n.getMessage("old_and_new_passwords_cannot_be_same");SecurdenExtensionUtils.showStatusMsg("error_msg",s,3e3)}else{if(r.is_enforced||i){var a=SecurdenExtensionValidationMethods.checkPasswordValidity(n,Securden_Popup.accountId);if("string"==typeof a)return SecurdenExtensionUtils.showHide(e,t),void SecurdenExtensionUtils.showStatusMsg("error_msg",a,3e3);if(!a){SecurdenExtensionUtils.showHide(e,t);s=browser.i18n.getMessage("enter_password_with_complexity_req");return void SecurdenExtensionUtils.showStatusMsg("error_msg",s,3e3)}}r.param&&r.param.TICKETING_SYSTEM&&i?(Securden_Popup.resetValidateTicketsVariable(),Securden_Popup.validateTicketIdForChangeRemotePassword=!0,SecurdenExtensionUtils.showHide(e,t),Securden_Popup.showTicketIdDiv(r)):Securden_Popup.changeAccountPassword()}}else SecurdenExtensionUtils.showHide(e,t)}else SecurdenExtensionUtils.showHide(e,t)},changeAccountPassword:function(){SecurdenExtensionUtils.showHide(["loading"],[]);var e=$("#change_password_reason").val(),t=$("#new_password").val(),n="true"==$("#change_password_is_remote").val(),o={account_id:Securden_Popup.accountId,new_password:t,is_remote:n,reason:e},i=Securden_Popup.ticketID;null!=i&&null!=i&&(o.ticket_id=i),Securden_Popup.sendRequest({action:"change_password",data:o,type:"POST",onSuccessFunc:"changeAccountPasswordSuccess",onFailureFunc:"errorMsgFunction"})},changeAccountPasswordSuccess:function(e){if(e.is_valid)Securden_Popup.showAccountDetails(void 0,Securden_Popup.accountId),Securden_Popup.successStatusFunc(e);else{var t=["change_password_error"],n=["loading"];$("#change_password_error_msg").text(e.error.trace),e.error_details_obj?(t.push("mssql_change_password_error_msg"),n.push("change_password_error_msg_div"),$("#mssql_change_password_error_msg").text(e.error_details_obj.error_text),$("#mssql_error_driver_link").text(browser.i18n.getMessage("sql_driver")),document.getElementById("mssql_error_driver_link").href=e.error_details_obj.driver_link):(t.push("change_password_error_msg_div"),n.push("mssql_change_password_error_msg")),e.error.hide_more_trace?(t.push("change_password_hide_error_trace_div"),e.error.currentMachine?(t.push("hide_error_trace_current_machine"),n.push("hide_error_trace_not_current_machine")):(n.push("hide_error_trace_current_machine"),t.push("hide_error_trace_not_current_machine"),e.error.errorManageShare?t.push("current_machine_manage_share_error"):n.push("current_machine_manage_share_error"))):(n.push("change_password_hide_error_trace_div"),n.push("hide_error_trace_current_machine"),n.push("hide_error_trace_not_current_machine"),n.push("current_machine_manage_share_error")),SecurdenExtensionUtils.showHide(t,n)}Securden_Popup.clearFlags()},favoriteAccount:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t={account_id:$(this).attr("account_id"),is_favorite:"true"!==$(this).attr("is_favorite")};Securden_Popup.sendRequest({action:"favorite_action",data:t,type:"POST",onSuccessFunc:"favoriteAccountSuccess",onSuccessFuncArg:t,onFailureFunc:"favoriteAccountError",onFailureFuncArg:t})},favoriteAccountSuccess:function(e,t){var n=t.account_id,o=t.is_favorite,i=n+"_favorite_icon",r=browser.i18n.getMessage("mark_as_favorite"),s="icon-favorite-line",a="icon-favorite-fill",c="false";o&&(r=browser.i18n.getMessage("remove_as_favorite"),s="icon-favorite-fill",a="icon-favorite-line",c="true"),$("#"+i).removeClass(a).addClass(s),$("#"+i).attr("is_favorite",c),$("#"+i).attr("title",r)},favoriteAccountError:function(e,t){Securden_Popup.errorMsgFunction(e)},getAccountsInAddress:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=$(this).attr("account_url");Securden_Popup.isFilterBy=!0,Securden_Popup.isFilterByType=!1,Securden_Popup.filterByValue=t,Securden_Popup.searchAccounts()},getAccountsInAccountType:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=$(this).attr("account_type"),n=$(this).attr("account_category");Securden_Popup.isFilterBy=!0,Securden_Popup.isFilterByType=!0,Securden_Popup.filterByValue=t,Securden_Popup.filterByValueCategory=n,Securden_Popup.searchAccounts()},clearFilter:function(){Securden_Popup.isFilterBy=!1,Securden_Popup.isFilterByType=!1,Securden_Popup.filterByValue="",Securden_Popup.filterByValueCategory="",SecurdenExtensionUtils.showHide(["loading"],[]);SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("TOP_FOLDERS",Securden_Popup.productVersion);Securden_Popup.searchAccounts()},favIconError:function(){$(".fav-icon").each((function(){var e=$(this),t=new Image;t.src=$(e).attr("src");var n=browser.runtime.getURL("images/globe.png");0!=t.naturalWidth&&"uninitialized"!=t.readyState||$(e).unbind("error").attr("src",n)}))},getTopFolders:function(){Securden_Popup.sendRequest({action:"get_top_level_folders",onSuccessFunc:"getTopFoldersSuccess",onFailureFunc:"errorMsgFunction"})},getTopFoldersSuccess:function(e){if(e){$("#top_level_folders_wrap").empty(),SecurdenExtensionUtils.showHide(["top_level_folders_wrap"],[]);var t=e;SecurdenExtensionUtils.isParamValid(e.basic_folders)&&(t=e.basic_folders,e.all_folders);var n=document.getElementById("top_level_folders_wrap"),o=document.createElement("div");o.className="input-group";var i,r=document.createElement("input");r.type="text",r.placeholder=browser.i18n.getMessage("search_node"),r.id="search_top_folders_text_box",o.appendChild(r),n.appendChild(o),(i=document.createElement("div")).id="top_level_primary_folders_div",n.appendChild(i),plugins=["search","types","wholerow"],Securden_Popup.createFolderTreeFromData("top_level_primary_folders_div",t,plugins),Securden_Popup.folderTreeAddSearch("search_top_folders_text_box","top_level_primary_folders_div"),Securden_Popup.folderTreeAddSelect("top_level_primary_folders_div","topFolderTreeNodeSelect"),(i=document.createElement("div")).id="top_level_user_folders_div",n.appendChild(i),Securden_Popup.createFolderTree("top_level_user_folders_div","search_top_folders_text_box",!0),Securden_Popup.folderTreeAddSearch("search_top_folders_text_box","top_level_user_folders_div"),Securden_Popup.folderTreeAddSelect("top_level_user_folders_div","topFolderTreeNodeSelect"),$("#top_folders_wrap_div").addClass("top_folders_list_div_open"),SecurdenExtensionUtils.showHide(["top_folders_container_div"],[]);window.setTimeout((function(){Securden_Popup.setTreeNodeSelection(null,true),document.getElementById("search_top_folders_text_box").focus()}),1e3)}},closeTopFoldersDiv:function(){SecurdenExtensionUtils.showHide([],["top_folders_container_div"]),$("#background_disable").removeClass("background-disable")},createSelect2ForTopFolders:function(e){var t=e.length;SecurdenExtensionUtils.showHide(["top_folders_div_select_wrap"],["top_folders_div"]);var n=document.getElementById("top_folders_div_select");inputField=document.createElement("div"),inputField.id="folders_wrappers_div";inputField.className="show";var o=document.createElement("select");o.name="top-folders-select2-div",o.id="top-folders-select2-div";for(var i=0;i<t;i++){var r="";r=document.createElement("option");var s=e[i].id;r.textContent=e[i].text,r.value=r.id=s,Securden_Popup.topFolderId==s&&(r.selected=!0),o.appendChild(r)}inputField.appendChild(o),n.appendChild(inputField),$("#top-folders-select2-div").select2({tags:!0,templateSelection:function(e,t){return $(e.element).attr("data-id",e.element.id),e.text}}),$select=$("#top-folders-select2-div").select2({}),$select.data("select2").$dropdown.addClass("top-folders-select2-div"),$("#top-folders-select2-div").on("select2:select",(function(e){var t=e.params.data;window.Securden_Popup.topFolderTreeNodeSelect(t.element.id)}))},userDetails:function(){Securden_Popup.sendRequest({action:"get_user_details",onSuccessFunc:"getUserDetailsSuccess",onFailureFunc:"errorMsgFunction"})},getUserDetailsSuccess:function(e){if(e){var t=[];e.username&&($("#user_details_username_value").text(e.username),t.push("user_details_username_value_wrap")),e.loginname&&($("#user_details_loginname_value").text(e.loginname),t.push("user_details_loginname_value_wrap")),null!=e.domain&&($("#user_details_domain_value").text(e.domain),t.push("user_details_domain_wrap")),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("PASSWORD_GENERATOR",Securden_Popup.productVersion)&&t.push("generate_password_inside_user_details"),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("FORM_FIELD_SAVE",Securden_Popup.productVersion)&&Securden_Popup.addAccountAvailable&&t.push("form_field_save_inside_user_details"),SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("RECORD_AND_PLAYBACK_FORM_FIELDS",Securden_Popup.productVersion)&&Securden_Popup.addAccountAvailable&&t.push("record_form_field_inside_user_details"),$("#user_details_email_value").text(e.email),$("#user_details_role_value").text(e.rolename),SecurdenExtensionUtils.showHide(t,[]),$("#user_details_values_div").removeClass("slide-hide").addClass("slide-show"),$("#background_disable").addClass("background-disable")}},closeUserDetails:function(){SecurdenExtensionUtils.showHide([],["user_details_domain_wrap"]),$("#user_details_values_div").removeClass("slide-show").addClass("slide-hide"),$("#background_disable").removeClass("background-disable")},record:function(){SecurdenExtensionUtils.sendMessage(null,"formFieldRecord",{},(function(){})),window.setTimeout((function(){Securden_Popup.closeUserDetails(),Securden_Popup.showErrorMsg(void 0,browser.i18n.getMessage("refresh_the_page"),5e3)}),500)},deleteRecordings:function(){SecurdenExtensionUtils.sendMessage(null,"deleteRecordInStorage",{},(function(){})),Securden_Popup.recordStored=!1,Securden_Popup.recordDeleted=!0},showGeneratePasswordPage:function(){SecurdenExtensionUtils.showHide(["loading"],[]),Securden_Popup.sendRequest({action:"get_generate_password_defaults",onSuccessFunc:"showGeneratePasswordPageSuccess",onFailureFunc:"showGeneratePasswordPageError"})},showGeneratePasswordPageSuccess:function(e){if(SecurdenExtensionUtils.rightSidePane("password_generator_page_top",browser.i18n.getMessage("password_generator_title")),Securden_Popup.passwordElementId="id_generate_password_pwd",Securden_Popup.generatePasswordSuccess(e),e&&e.generate_password_defaults||e&&e.additional_info&&e.additional_info.generate_password_defaults){var t=e.generate_password_defaults;null!=t&&null!=t||(t=e.additional_info.generate_password_defaults),t.form_url_params&&(SecurdenExtensionFormUtils.formUrlParams.password_generator_form=t.form_url_params);var n=t.min_length,o=t.denied_chars,i=t.starts_with_alphabet,r=(t.required_complexity,t.complexity_elements);$("#min_length").val(n),$("#min_length").parent().find("[divType='errorMsg']").remove(),$("#denied_chars").val(o),null!=o&&null!=o&&""!=o.trim()&&$("#denied_chars_wrapper_id").parent().addClass("cyb-label-focus"),$("#generate_password_start_alphabet").val(i);for(var s=0;s<r.length;s++)$("#"+r[s].id).parent().find("[divType='errorMsg']").remove(),$("#"+r[s].id).val(r[s].min_length),$("#"+r[s].hiddenIconId).val(r[s].is_enabled),$("#"+r[s].iconId).removeClass("icon-uncheck"),$("#"+r[s].iconId).removeClass("icon-check"),$("#"+r[s].iconId).addClass(r[s].iconClass)}SecurdenExtensionUtils.showHide(["password_generator_page","show_advanced_password_generator_options"],["loading","password_generator_form"])},showGeneratePasswordPageError:function(e){Securden_Popup.showErrorMsg(e),Securden_Popup.showGeneratePasswordPageSuccess(e)},showAdvancedPassGeneratorOptions:function(){SecurdenExtensionUtils.showHide(["password_generator_form"],["show_advanced_password_generator_options"])},showSaveFormFieldsForm:function(){SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.resetRadioButton("form_field_scope_account_classification_work_icon_id","form_field_scope_account_classification_work_icon_id_hidden_id","form_field_scope_account_classification_personal_icon_id","form_field_scope_account_classification_personal_icon_id_hidden_id"),Securden_Popup.formFieldsForSave=null,Securden_Popup.recordStored?SecurdenExtensionUtils.sendMessage(null,"get_recorded_inputs",{}):SecurdenExtensionUtils.sendMessage(null,"get_window_form_fields",{}),Securden_Popup.showFormFieldsFormErrorTimeout=window.setTimeout((function(){Securden_Popup.showErrorMsg(void 0,browser.i18n.getMessage("refresh_the_page"),5e3),Securden_Popup.getAccounts()}),5e3)},selectFormFieldAccountCategory:function(e){var t="form_field_account_classification_personal_id",n="form_field_account_classification_work_id";e&&(t="form_field_account_classification_work_id",n="form_field_account_classification_personal_id"),$("#"+t).removeClass("schedule-check").addClass("schedule-uncheck"),$("#"+n).removeClass("schedule-uncheck").addClass("schedule-check"),Securden_Popup.formFieldIsPersonalAccount=e,Securden_Popup.recordStored?Securden_Popup.setRecordedInputData():Securden_Popup.setFormFieldsForSave()},changeAccountTypeForFormFieldsChange:function(e,t){SecurdenExtensionUtils.stopEventPropagation(e);var n=t.options[t.selectedIndex].id;Securden_Popup.formFieldSelectedAccTypeId=n,Securden_Popup.recordStored?Securden_Popup.setRecordedInputData(null,n):Securden_Popup.setFormFieldsForSave(null,n)},setFormFieldsForSave:async function(e,t){if(window.clearTimeout(Securden_Popup.showFormFieldsFormErrorTimeout),SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.isParamValid(Securden_Popup.formFieldsForSave))if(SecurdenExtensionUtils.isParamValid(e)){for(let t in Securden_Popup.formFieldsForSave)if(SecurdenExtensionUtils.isParamValid(e[t])){var n=Securden_Popup.formFieldsForSave[t].validFormFields,o=e[t].validFormFields;n=n.concat(o),Securden_Popup.formFieldsForSave[t].validFormFields=n}var i=$.extend(e,Securden_Popup.formFieldsForSave);Securden_Popup.formFieldsForSave=i,e=i}else e=Securden_Popup.formFieldsForSave;else Securden_Popup.formFieldsForSave=e;SecurdenExtensionUtils.rightSidePane("form_fields_save_form_page_top",browser.i18n.getMessage("save_form_fields"),[],[],Securden_Popup.removeBackFormFieldSave);var r=Securden_Popup.formFieldIsPersonalAccount;null!=r&&null!=r||(r=!1);var s=await Securden_Popup.sendRequest({action:"get_form_save_account_types?is_personal_account="+r+"&is_exclude_file_type=true"}).then((e=>e));if(SecurdenExtensionUtils.isParamValid(s)&&SecurdenExtensionUtils.isParamValid(s.account_types)){if(0==s.form_field_mapping_for_work){Securden_Popup.formFieldIsGlobalConfig=!1;var a=[];s.add_work_available&&s.add_personal_available?(a.push("form_field_account_classification_wrap_id"),(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id"))&&(a.push("form_fields_body_wrap"),SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")?Securden_Popup.formFieldIsPersonalAccount=!1:SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id")&&(Securden_Popup.formFieldIsPersonalAccount=!0))):s.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,a.push("form_fields_body_wrap")):s.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,a.push("form_fields_body_wrap")),SecurdenExtensionUtils.showHide(a,["form_field_scope_wrap_id"])}else{a=["form_field_scope_wrap_id"];(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_global_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_owned_icon_id_hidden_id"))&&(s.add_work_available&&s.add_personal_available?(a.push("form_field_account_classification_wrap_id"),(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id"))&&(a.push("form_fields_body_wrap"),SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")?Securden_Popup.formFieldIsPersonalAccount=!1:SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id")&&(Securden_Popup.formFieldIsPersonalAccount=!0))):s.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,a.push("form_fields_body_wrap")):s.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,a.push("form_fields_body_wrap"))),SecurdenExtensionUtils.showHide(a,[])}var c=s.account_types,d=c.length,u=document.createElement("select");u.className="cyb-login-select",u.name="form_field_account_type",u.id="form_field_account_type";for(var l=0;l<d;l++){var _="";_=document.createElement("option");var p=c[l].id;_.textContent=c[l].type_name,_.value=_.id=p,s.account_type_id?c[l].id==s.account_type_id&&(_.selected=!0):null==t?(c[l].type_name==Securden_Popup.webAccount||c[l].is_default)&&(t=c[l].id,_.selected=!0):""==t?null==c[l].id&&(t=null,_.selected=!0):c[l].id==t&&(t=c[l].id,_.selected=!0),u.appendChild(_)}Securden_Popup.formFieldSelectedAccTypeId=t,u.onchange=function(e){Securden_Popup.changeAccountTypeForFormFieldsChange(e,this)},$("#form_field_account_type_select_input").empty(),document.getElementById("form_field_account_type_select_input").appendChild(u);var m=await Securden_Popup.sendRequest({action:"get_form_field_account_type_fields?account_type_id="+t+"&is_personal_account="+r}).then((e=>e));if(SecurdenExtensionUtils.isParamValid(m)&&SecurdenExtensionUtils.isParamValid(m.text_field_columns)){var f=m.text_field_columns,S=m.password_field_columns,g=document.createElement("div"),v=(l=0,""),w=null,h=!0;for(let t in e){var P=e[t].validFormFields,b=P.length;if(0!=b){h=!1,Securden_Popup.isEditableFields=!1,v=e[t].currentUrlDomain,(K=document.createElement("div")).id="form_field_form_wrap_div_"+l,K.className="split-form-wrap",(Y=document.createElement("div")).id="form_field_delete_div_"+l,Y.setAttribute("form_id_number",l),Y.className="form-delete-icon",(z=document.createElement("i")).className="icon-delete",z.setAttribute("form_id_number",l),(J=document.createElement("div")).className="form-delete-label",J.innerText=browser.i18n.getMessage("delete"),J.setAttribute("form_id_number",l),Y.appendChild(z),Y.appendChild(J),Y.onclick=function(e){Securden_Popup.removeFormFieldForm(e)},K.appendChild(Y),(Q=document.createElement("div")).className="split-form-title";var E=l+1+". "+browser.i18n.getMessage("input_form")+"("+e[t].formIdentifierText+": "+t+")";Q.innerText=E,K.appendChild(Q),(Z=document.createElement("form")).id="form_fields_save_form_name_"+l,Z.className="split-form-left",(X=document.createElement("input")).type="hidden",X.id=X.name="form-identifier-id-"+l,X.setAttribute("value",e[t].formIdentifierVal),Z.appendChild(X),(ee=document.createElement("input")).type="hidden",ee.id=ee.name="form-identifier-val-"+l,ee.setAttribute("value",t),Z.appendChild(ee);for(var x=0,y=0,A=0,F=0;F<b;F++){var U=P[F];w=ie=U.type;var k=browser.i18n.getMessage("text_input_field");"password"==ie?(k=browser.i18n.getMessage("password_input_field"),A=y+=1):A=x+=1,(re=document.createElement("div")).className="sec-split-form-input-wrap",re.id="split_form_input_wrap_"+ie+"_"+l+"_"+A,re.setAttribute("type_of_input",ie),(se=document.createElement("div")).className="sec-ext-map-input-list-wrap",se.id="ext_map_input_list_wrap_"+ie+"_"+l+"_"+A,se.setAttribute("type_of_input",ie),re.appendChild(se),(ae=document.createElement("div")).className="cyb-form-field field-box cyb-input-filled",(ce=document.createElement("div")).className="split-form-label-title",ce.innerText=k,(de=document.createElement("div")).className="split-form-value";var I="",C="",T=null;"placeholder"in U&&(T="placeholder",I=U.placeholder,C=""),"aria_label"in U&&(T="aria_label",I=U.aria_label,C=""),SecurdenExtensionUtils.isParamValid(I)&&""!=I.trim()||(T="name",I=U.name,C="Name: ",SecurdenExtensionUtils.isParamValid(I)||(T="id",I=U.id,C="ID: ")),C+=I,de.innerText=C,ae.appendChild(ce),ae.appendChild(de),(le=document.createElement("div")).className="cyb-input-list",(_e=document.createElement("div")).className="cyb-form-field cyb-label-focus height10",(pe=document.createElement("div")).className="cyb-usergroup-label",pe.innerText=browser.i18n.getMessage("value_mapping"),_e.appendChild(pe),(me=document.createElement("div")).className="cyb-select",(fe=document.createElement("div")).className="cyb-input",fe.id="form_field_select_div_"+l;var N=f,M="text_";"password"==ie&&(N=S,M="password_"),(ge=document.createElement("select")).className="cyb-login-select";var R=M+"form_field_val_"+l+"_"+A;ge.name=R,ge.id=R,ge.setAttribute("field-identifier",F);for(var V=N.length,B="accountmanagement.models.Accounts",O=0;O<V;O++){var D="";D=document.createElement("option");var L=N[O].attr_name;SecurdenExtensionUtils.isParamValid(N[O].id)&&(L=N[O].id),D.textContent=N[O].attr_display_name,D.value=D.id=L,D.setAttribute("prefix",M),D.setAttribute("model_name",N[O].table_name),D.setAttribute("index",l),D.setAttribute("field_count",A),0==O&&(D.selected=!0,B=N[O].table_name),ge.appendChild(D)}ge.onchange=function(e){Securden_Popup.changeFieldValueForFormFieldValue(this)},fe.appendChild(ge),me.appendChild(fe),(ve=document.createElement("input")).type="hidden",ve.id=ve.name=M+"form_field_val_type_model_"+l+"_"+A,ve.setAttribute("value",B),(we=document.createElement("input")).type="hidden",we.id=we.name=M+"form_field_identifier_val_"+l+"_"+A,we.setAttribute("value",I),(he=document.createElement("input")).type="hidden",he.id=he.name=M+"form_field_identifier_"+l+"_"+A,he.setAttribute("value",T),me.appendChild(ve),me.appendChild(we),me.appendChild(he),_e.appendChild(me),le.appendChild(ae),le.appendChild(_e),se.appendChild(le),(Pe=document.createElement("div")).className="additional-field-icons",(be=document.createElement("i")).className="icon-minus",be.setAttribute("form_id_number",l),be.setAttribute("field_id_number",A),be.setAttribute("type_of_input",ie),be.onclick=function(e){Securden_Popup.deleteFormSingleField(e)},Pe.appendChild(be),se.appendChild(Pe),Z.appendChild(re)}if((te=document.createElement("input")).type="hidden",te.id=te.name="text_form_field_length_"+l,te.setAttribute("value",x),Z.appendChild(te),(ne=document.createElement("input")).type="hidden",ne.id=ne.name="password_form_field_length_"+l,ne.setAttribute("value",y),Z.appendChild(ne),SecurdenExtensionUtils.isParamValid(w))(oe=document.createElement("input")).type="hidden",oe.id=oe.name="last_field_type",oe.setAttribute("value",w),Z.appendChild(oe);if(!e[t].validSubmitPresent){var H=document.createElement("div");H.id="show_submit_field_mapping_"+l,H.className="more-attributes-link show hand",H.setAttribute("form_id_number",l);var q=document.createElement("span");q.innerText=browser.i18n.getMessage("map_submit_button"),q.setAttribute("form_id_number",l);var W=document.createElement("i");W.className="icon-down",W.setAttribute("form_id_number",l),H.appendChild(q),H.appendChild(W),Securden_Popup.submitButtonActionsIndex=0,H.onclick=function(e){Securden_Popup.showSubmitButtonClickFunction(e)},Z.appendChild(H)}K.appendChild(Z),K.setAttribute("total_fields_count",F),g.appendChild(K),l+=1}}0!=l&&(Securden_Popup.formFieldsFormCount=l,Securden_Popup.formFieldsFormCountInitial=l);var G=SecurdenExtensionUtils.checkIfFeatureEnabledInVersion("RECORD_AND_PLAYBACK_FORM_FIELDS",Securden_Popup.productVersion),j=0;if(h&&G){for(let t in e){var K,Y,z,J,Q;Securden_Popup.isEditableFields=!0,v=e[t].currentUrlDomain,(K=document.createElement("div")).id="form_field_form_wrap_div_"+j,K.className="split-form-wrap",(Y=document.createElement("div")).id="form_field_delete_div_"+j,Y.setAttribute("form_id_number",j),Y.className="form-delete-icon",(z=document.createElement("a")).className="icon-delete",z.setAttribute("form_id_number",j),(J=document.createElement("div")).className="form-delete-label",J.innerText=browser.i18n.getMessage("delete"),J.setAttribute("form_id_number",j),Y.appendChild(z),Y.appendChild(J),Y.onclick=function(e){Securden_Popup.removeFormFieldForm(e)},K.appendChild(Y),(Q=document.createElement("div")).className="split-form-title";var Z,X,ee,te,ne,oe;E=j+1+". "+browser.i18n.getMessage("input_form")+"(URL: "+v+")";Q.innerText=E,K.appendChild(Q),(Z=document.createElement("form")).id="form_fields_save_form_name_"+j,Z.className="split-form-left",(X=document.createElement("input")).type="hidden",X.id=X.name="form-identifier-id-"+j,X.setAttribute("value",3),Z.appendChild(X),(ee=document.createElement("input")).type="hidden",ee.id=ee.name="form-identifier-val-"+j,ee.setAttribute("value",v),Z.appendChild(ee);for(x=0,y=0,A=0,F=0;F<2;F++){var ie="text";1==F&&(ie="password"),w=ie;var re,se,ae,ce,de;k=browser.i18n.getMessage("text_input_field");1==F?(k=browser.i18n.getMessage("password_input_field"),A=y+=1):A=x+=1,(re=document.createElement("div")).className="sec-split-form-input-wrap",re.id="split_form_input_wrap_"+ie+"_"+j+"_"+A,re.setAttribute("type_of_input",ie),(se=document.createElement("div")).className="sec-ext-map-input-list-wrap",se.id="ext_map_input_list_wrap_"+ie+"_"+j+"_"+A,se.setAttribute("type_of_input",ie),re.appendChild(se),(ae=document.createElement("div")).className="cyb-form-field field-box cyb-input-filled",(ce=document.createElement("div")).className="split-form-label-title",ce.innerText=k,(de=document.createElement("div")).className="split-form-value",de.style.display="none",de.id=ie+"_"+j+"_"+A;I="",C="",T="";ae.appendChild(de);var ue=document.createElement("div");ue.className="cyb-usergroup-label",ue.setAttribute("cyb-element-type","cyb-input-label"),ue.innerText="Enter here";var le,_e,pe,me,fe,Se=document.createElement("input");Se.setAttribute("type","text"),Se.setAttribute("id",ie+"_value_1"),Se.setAttribute("cyb-max-length","250"),Se.setAttribute("cyb-element-type","cyb-input"),Se.setAttribute("cyb-mandatory",!0),Se.setAttribute("cyb-split-fields",!0),ae.appendChild(ue),ae.appendChild(Se),(le=document.createElement("div")).className="cyb-input-list",(_e=document.createElement("div")).className="cyb-form-field cyb-label-focus height10",(pe=document.createElement("div")).className="cyb-usergroup-label",pe.innerText=browser.i18n.getMessage("value_mapping"),_e.appendChild(pe),(me=document.createElement("div")).className="cyb-select",(fe=document.createElement("div")).className="cyb-input",fe.id="form_field_select_div_"+j;var ge;N=f,M="text_";1==F&&(N=S,M="password_"),(ge=document.createElement("select")).className="cyb-login-select";var ve,we,he,Pe,be;R=M+"form_field_val_"+j+"_"+A;ge.name=R,ge.id=R,ge.setAttribute("field-identifier",F);for(V=N.length,B="accountmanagement.models.Accounts",O=0;O<V;O++){D="";D=document.createElement("option");L=N[O].attr_name;SecurdenExtensionUtils.isParamValid(N[O].id)&&(L=N[O].id),D.textContent=N[O].attr_display_name,D.value=D.id=L,D.setAttribute("prefix",M),D.setAttribute("model_name",N[O].table_name),D.setAttribute("index",j),D.setAttribute("field_count",A),0==O&&(D.selected=!0,B=N[O].table_name),ge.appendChild(D)}ge.onchange=function(e){Securden_Popup.changeFieldValueForFormFieldValue(this)},fe.appendChild(ge),me.appendChild(fe),(ve=document.createElement("input")).type="hidden",ve.id=ve.name=M+"form_field_val_type_model_"+j+"_"+A,ve.setAttribute("value",B),(we=document.createElement("input")).type="hidden",we.id=we.name=M+"form_field_identifier_val_"+j+"_"+A,we.setAttribute("value",I),(he=document.createElement("input")).type="hidden",he.id=he.name=M+"form_field_identifier_"+j+"_"+A,he.setAttribute("value",T),me.appendChild(ve),me.appendChild(we),me.appendChild(he),_e.appendChild(me),le.appendChild(ce),le.appendChild(ae),le.appendChild(_e),se.appendChild(le),(Pe=document.createElement("div")).className="additional-field-icons",(be=document.createElement("i")).className="icon-minus",be.setAttribute("form_id_number",j),be.setAttribute("field_id_number",A),be.setAttribute("type_of_input",ie),be.onclick=function(e){Securden_Popup.deleteFormSingleField(e)};var Ee=document.createElement("i");Ee.className="icon-add",Ee.setAttribute("form_id_number",j),Ee.setAttribute("field_id_number",A),Ee.setAttribute("type_of_input",ie),Ee.onclick=function(e){Securden_Popup.addFormSingleField(e)},Pe.appendChild(be),Pe.appendChild(Ee),se.appendChild(Pe),Z.appendChild(re)}if((te=document.createElement("input")).type="hidden",te.id=te.name="text_form_field_length_"+j,te.setAttribute("value",x),Z.appendChild(te),(ne=document.createElement("input")).type="hidden",ne.id=ne.name="password_form_field_length_"+j,ne.setAttribute("value",y),Z.appendChild(ne),SecurdenExtensionUtils.isParamValid(w))(oe=document.createElement("input")).type="hidden",oe.id=oe.name="last_field_type",oe.setAttribute("value",w),Z.appendChild(oe);K.appendChild(Z),K.setAttribute("total_fields_count",F),g.appendChild(K),j+=1}Securden_Popup.formFieldsFormCount=j,Securden_Popup.formFieldsFormCountInitial=j}if(0!=l||0!=j)Securden_Popup.formFieldsInputURL=v,$("#form_fields_save_forms_div").empty(),document.getElementById("form_fields_save_forms_div").appendChild(g),$("body").addClass("width640"),$(".container").addClass("max-width640"),SecurdenExtensionUtils.showHide(["form_fields_save_form"],["loading"])}else Securden_Popup.errorMsgFormFieldsFunction()}else Securden_Popup.errorMsgFormFieldsFunction()},showSubmitButtonClickFunction:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target.getAttribute("form_id_number"),n="show_submit_field_mapping_"+t,o="add_new_submit_button_action_"+t;SecurdenExtensionUtils.showHide([],[n]);var i=document.getElementById(o);SecurdenExtensionUtils.isParamValid(i)&&i.remove();var r=Securden_Popup.submitButtonActionsIndex,s=document.getElementById("form_fields_save_form_name_"+t),a=document.createElement("div");a.className="sec-split-form-input-wrap",a.id="submit_button_action_"+r;var c=document.createElement("div");c.className="cyb-form-field split-form-label",c.style.height="38px";var d=document.createElement("div");d.className="split-form-label-title",d.innerText=browser.i18n.getMessage("action")+" "+(r+1);var u=document.createElement("div");u.className="split-form-value",u.innerText=browser.i18n.getMessage("action"),c.appendChild(d),c.appendChild(u);var l=document.createElement("div");l.className="cyb-input-list",l.appendChild(c),a.appendChild(l);var _=document.createElement("div");_.className="cyb-form-field cyb-label-focus height10";var p=document.createElement("div");p.className="cyb-usergroup-label",p.innerText=browser.i18n.getMessage("selected_action"),_.appendChild(p);var m=document.createElement("div");m.className="cyb-select";var f=document.createElement("div");f.className="cyb-input";var S=document.createElement("select");S.className="cyb-login-select";for(var g=[{id:"tab",attr_display_name:browser.i18n.getMessage("tab")},{id:"enter",attr_display_name:browser.i18n.getMessage("click")}],v=g.length,w=0;w<v;w++){var h="";(h=document.createElement("option")).textContent=g[w].attr_display_name,h.value=h.id=g[w].id,h.setAttribute("submit_button_action_index",r),h.setAttribute("form_id_number",t),0==w&&(h.selected=!0),S.appendChild(h)}S.onchange=function(e){Securden_Popup.changeFieldValueForSubmitButtonAction(this)},f.appendChild(S),m.appendChild(f);var P=document.createElement("input");if(P.type="hidden",P.id=P.name="submit_button_action_"+t+"_"+r,P.setAttribute("value","tab"),m.appendChild(P),0==r){var b=document.createElement("input");b.type="hidden",b.id=b.name="submit_button_action_length",b.setAttribute("value",1),m.appendChild(b)}else $("#submit_button_action_length").val(r+1);l.appendChild(_),_.appendChild(m),a.appendChild(l);var E=document.createElement("div");E.className="additional-field-icons";var x=document.createElement("i");if(x.className="icon-minus",x.setAttribute("form_id_number",t),x.onclick=function(e){Securden_Popup.deleteFormSubmitAction(e)},E.appendChild(x),a.appendChild(E),s.appendChild(a),r<5){(i=document.createElement("div")).id="add_new_submit_button_action_"+t,i.className="more-attributes-link float-right show hand",i.setAttribute("form_id_number",t);var y=document.createElement("span");y.innerText=browser.i18n.getMessage("add_additional_action"),y.setAttribute("form_id_number",t);var A=document.createElement("i");A.className="icon-add",A.setAttribute("form_id_number",t),i.appendChild(y),i.appendChild(A),i.onclick=function(e){Securden_Popup.submitButtonActionsIndex=r+1,Securden_Popup.showSubmitButtonClickFunction(e)},s.appendChild(i)}},deleteFormSubmitAction:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target.getAttribute("form_id_number"),n=document.getElementById("form_fields_save_form_name_"+t),o="add_new_submit_button_action_"+t,i=document.getElementById(o);SecurdenExtensionUtils.isParamValid(i)&&i.remove();var r=Securden_Popup.submitButtonActionsIndex,s=document.getElementById("submit_button_action_"+r);if(SecurdenExtensionUtils.isParamValid(s)&&s.remove(),0==r){var a="show_submit_field_mapping_"+t;Securden_Popup.submitButtonActionsIndex=0,$("#submit_button_action_length").val(0),SecurdenExtensionUtils.showHide([a],[])}else Securden_Popup.submitButtonActionsIndex=Securden_Popup.submitButtonActionsIndex-1,$("#submit_button_action_length").val(Securden_Popup.submitButtonActionsIndex+1);if(r>0&&r<=5){(i=document.createElement("div")).id="add_new_submit_button_action_"+t,i.className="more-attributes-link float-right show hand",i.setAttribute("form_id_number",t);var c=document.createElement("span");c.innerText=browser.i18n.getMessage("add_additional_action"),c.setAttribute("form_id_number",t);var d=document.createElement("i");d.className="icon-add",d.setAttribute("form_id_number",t),i.appendChild(c),i.appendChild(d),i.onclick=function(e){Securden_Popup.submitButtonActionsIndex=r+1,Securden_Popup.showSubmitButtonClickFunction(e)},n.appendChild(i)}},changeFieldValueForFormFieldValue:function(e){var t=e.options[e.selectedIndex],n=e.getAttribute("field-identifier");SecurdenExtensionUtils.isParamValid(n)&&$("#form_field_account_type_additional_field_val_"+n).val(t.id);var o=t.getAttribute("prefix");if(SecurdenExtensionUtils.isParamValid(o)){var i=t.getAttribute("model_name"),r=o+"form_field_val_type_model_"+t.getAttribute("index")+"_"+t.getAttribute("field_count"),s=document.getElementById(r);SecurdenExtensionUtils.isParamValid(s)&&$("#"+r).val(i)}},changeFieldValueForSubmitButtonAction:function(e){var t=e.options[e.selectedIndex],n=t.getAttribute("id"),o="submit_button_action_"+t.getAttribute("form_id_number")+"_"+t.getAttribute("submit_button_action_index"),i=document.getElementById(o);SecurdenExtensionUtils.isParamValid(i)&&$("#"+o).val(n)},removeFormFieldForm:function(e,t){(SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.isParamValid(t))||(t=e.target.getAttribute("form_id_number"));if(SecurdenExtensionUtils.isParamValid(t)||(t=$(this).parent().attr("form_id_number")),SecurdenExtensionUtils.isParamValid(t))if(1==Securden_Popup.formFieldsFormCount)Securden_Popup.removeBackFormFieldSave();else{var n="form_field_form_wrap_div_"+t,o=document.getElementById(n);SecurdenExtensionUtils.isParamValid(o)&&o.remove(),Securden_Popup.formFieldsFormCount=Securden_Popup.formFieldsFormCount-1}},addFormSingleField:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target,n=t.getAttribute("form_id_number"),o=t.getAttribute("field_id_number"),i=t.getAttribute("type_of_input"),r=document.getElementById("form_field_form_wrap_div_"+n),s=r.getAttribute("total_fields_count");r.setAttribute("total_fields_count",parseInt(s)+1);var a="ext_map_input_list_wrap_"+i+"_"+n+"_"+o,c=document.getElementById(a),d=c.getAttribute("type_of_input"),u=c.querySelector(".icon-add"),l=c.cloneNode(!0);l.querySelector("input").id=i+"_value_"+(parseInt(o)+1);var _=l.querySelector(".split-form-value");_&&(_.id=i+"_"+n+"_"+(parseInt(o)+1),_.textContent=""),o=parseInt(o)+1;var p=l.querySelector(".icon-add");p.setAttribute("field_id_number",o),p.onclick=function(e){Securden_Popup.addFormSingleField(e)};var m=l.querySelector(".icon-minus");m.setAttribute("field_id_number",o),m.onclick=function(e){Securden_Popup.deleteFormSingleField(e)};var f="ext_map_input_list_wrap_"+i+"_"+n+"_"+o;l.id=f;var S=0;"text"==d?(S=$("#text_form_field_length_"+n).val(),SecurdenExtensionUtils.isParamValid(S)&&$("#text_form_field_length_"+n).val(parseInt(S)+1)):"password"==d&&(S=$("#password_form_field_length_"+n).val(),SecurdenExtensionUtils.isParamValid(S)&&$("#password_form_field_length_"+n).val(parseInt(S)+1));var g=l.querySelector(".cyb-select"),v=g.querySelector(".cyb-login-select");v.id=v.name=i+"_form_field_val_"+n+"_"+o,v.onchange=function(e){Securden_Popup.changeFieldValueForFormFieldValue(this)};var w=i+"_form_field_val_type_model_"+n+"_"+(o-1),h=i+"_form_field_identifier_val_"+n+"_"+(o-1),P=i+"_form_field_identifier_"+n+"_"+(o-1),b=g.querySelector('input[name="'+w+'"]'),E=g.querySelector('input[name="'+h+'"]'),x=g.querySelector('input[name="'+P+'"]');b.id=b.name=i+"_form_field_val_type_model_"+n+"_"+o,E.id=E.name=i+"_form_field_identifier_val_"+n+"_"+o,x.id=x.name=i+"_form_field_identifier_"+n+"_"+o,$("#"+a).after(l),u.style.display="none"},deleteFormSingleField:function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=e.target,n=t.getAttribute("form_id_number"),o=t.getAttribute("field_id_number"),i=t.getAttribute("type_of_input"),r=document.getElementById("form_field_form_wrap_div_"+n),s=r.getAttribute("total_fields_count");if(s<=1)Securden_Popup.removeFormFieldForm(e,n);else{var a="split_form_input_wrap_"+i+"_"+n+"_"+o,c="ext_map_input_list_wrap_"+i+"_"+n+"_"+o,d=document.getElementById(a);SecurdenExtensionUtils.isParamValid(d)||(d=document.getElementById(c));d.getAttribute("type_of_input");if(SecurdenExtensionUtils.isParamValid(d)&&d.remove(),Securden_Popup.isEditableFields){a="ext_map_input_list_wrap_"+i+"_"+n+"_"+(o-1),d=document.getElementById(a);if(SecurdenExtensionUtils.isParamValid(d))d.querySelector(".icon-add").style.display="block"}s-=1,r.setAttribute("total_fields_count",s);var u="ext_map_input_list_wrap_"+i+"_"+n+"_"+(parseInt(o)-1);d=document.getElementById(u);SecurdenExtensionUtils.isParamValid(d)&&(typeOfInputNewLastDiv=d.getAttribute("type_of_input"),$("#last_field_type").val(typeOfInputNewLastDiv))}},saveFormFields:function(){Securden_Popup.formFieldSelectedAccTypeId;for(var e=Securden_Popup.formFieldsFormCountInitial,t=null,n=0;n<e;n++){var o="form_fields_save_form_name_"+n,i=SecurdenExtensionFormUtils.validateForm(o);if(!i&&Securden_Popup.isEditableFields)return;if(i&&Securden_Popup.isEditableFields){textCount=$("#text_form_field_length_"+n).val(),passCount=$("#password_form_field_length_"+n).val(),formNumber=n;for(var r=1;r<=textCount;r++){var s=(d="text")+"_value_"+r,a=$("#"+s).val();a&&Securden_Popup.setValueInHiddenForm(a,d,formNumber,r)}for(var c=1;c<=passCount;c++){var d;s=(d="password")+"_value_"+c;(a=$("#"+s).val())&&Securden_Popup.setValueInHiddenForm(a,d,formNumber,c)}}var u=SecurdenExtensionFormUtils.getFormData(o);(SecurdenExtensionUtils.isParamValid(u)?Object.keys(u).length:0)>0&&(t=SecurdenExtensionUtils.isParamValid(t)?JSON.parse(t).concat(JSON.parse(u)):u)}SecurdenExtensionUtils.showHide(["loading"],[]),t.total_forms_count=e;var l=!1;Securden_Popup.formFieldIsGlobalConfig&&(l=!0);var _=!1;Securden_Popup.formFieldIsPersonalAccount&&(_=Securden_Popup.formFieldIsPersonalAccount),SecurdenExtensionUtils.isParamValid(Securden_Popup.formFieldSelectedAccTypeId)&&(t.account_type_id=Securden_Popup.formFieldSelectedAccTypeId),SecurdenExtensionUtils.isParamValid(Securden_Popup.formFieldsInputURL)&&(t.url_domain=Securden_Popup.formFieldsInputURL),t.is_personal_account=_,t.is_global_config=l;var p="add_form_fields_mapping_from_addon";Securden_Popup.recordStored&&(p="record_form_fields_mapping_from_addon"),Securden_Popup.sendRequest({action:p,data:t,type:"POST",onSuccessFunc:"saveFormFieldsSuccess",onFailureFunc:"errorMsgFormFieldsFunction"})},setValueInHiddenForm:function(e,t,n,o){var[i,r]=e.split(/[:=]/).map((e=>e.replace(/['"]/g,""))),s=t+"_form_field_identifier_"+n+"_"+o,a=t+"_form_field_identifier_val_"+n+"_"+o,c=document.getElementById(a),d=document.getElementById(s);c.value=r.trim(),d.value=i.trim()},setRecordedInputData:async function(e,t){if(window.clearTimeout(Securden_Popup.showFormFieldsFormErrorTimeout),SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.isParamValid(Securden_Popup.formFieldsForSave))if(SecurdenExtensionUtils.isParamValid(e)){for(let t in Securden_Popup.formFieldsForSave)if(SecurdenExtensionUtils.isParamValid(e[t])){var n=Securden_Popup.formFieldsForSave[t].validFormFields,o=e[t].validFormFields;n=n.concat(o),Securden_Popup.formFieldsForSave[t].validFormFields=n}var i=$.extend(e,Securden_Popup.formFieldsForSave);Securden_Popup.formFieldsForSave=i,e=i}else e=Securden_Popup.formFieldsForSave;else Securden_Popup.formFieldsForSave=e;SecurdenExtensionUtils.rightSidePane("form_fields_save_form_page_top",browser.i18n.getMessage("save_form_fields"),[],[],Securden_Popup.removeBackFormFieldSave);var r=Securden_Popup.formFieldIsPersonalAccount;null!=r&&null!=r||(r=!1);var s=await Securden_Popup.sendRequest({action:"get_form_save_account_types?is_personal_account="+r+"&is_exclude_file_type=true"}).then((e=>e));if(SecurdenExtensionUtils.isParamValid(s)&&SecurdenExtensionUtils.isParamValid(s.account_types)){if(0==s.form_field_mapping_for_work){Securden_Popup.formFieldIsGlobalConfig=!1;var a=[];s.add_work_available&&s.add_personal_available?(a.push("form_field_account_classification_wrap_id"),(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id"))&&(a.push("form_fields_body_wrap"),SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")?Securden_Popup.formFieldIsPersonalAccount=!1:SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id")&&(Securden_Popup.formFieldIsPersonalAccount=!0))):s.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,a.push("form_fields_body_wrap")):s.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,a.push("form_fields_body_wrap")),SecurdenExtensionUtils.showHide(a,["form_field_scope_wrap_id"])}else{a=["form_field_scope_wrap_id"];(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_global_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_owned_icon_id_hidden_id"))&&(s.add_work_available&&s.add_personal_available?(a.push("form_field_account_classification_wrap_id"),(SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")||SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id"))&&(a.push("form_fields_body_wrap"),SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_work_icon_id_hidden_id")?Securden_Popup.formFieldIsPersonalAccount=!1:SecurdenExtensionUtils.isRadioButtonClicked("form_field_scope_account_classification_personal_icon_id_hidden_id")&&(Securden_Popup.formFieldIsPersonalAccount=!0))):s.add_work_available?(Securden_Popup.formFieldIsPersonalAccount=!1,a.push("form_fields_body_wrap")):s.add_personal_available&&(Securden_Popup.formFieldIsPersonalAccount=!0,a.push("form_fields_body_wrap"))),SecurdenExtensionUtils.showHide(a,[])}var c=s.account_types,d=c.length,u=document.createElement("select");u.className="cyb-login-select",u.name="form_field_account_type",u.id="form_field_account_type";for(var l=0;l<d;l++){var _="";_=document.createElement("option");var p=c[l].id;_.textContent=c[l].type_name,_.value=_.id=p,s.account_type_id?c[l].id==s.account_type_id&&(_.selected=!0):null==t?("Web Account"==c[l].type_name||c[l].is_default)&&(t=c[l].id,_.selected=!0):""==t?null==c[l].id&&(t=null,_.selected=!0):c[l].id==t&&(t=c[l].id,_.selected=!0),u.appendChild(_)}Securden_Popup.formFieldSelectedAccTypeId=t,u.onchange=function(e){Securden_Popup.changeAccountTypeForFormFieldsChange(e,this)},$("#form_field_account_type_select_input").empty(),document.getElementById("form_field_account_type_select_input").appendChild(u);var m=await Securden_Popup.sendRequest({action:"get_form_field_account_type_fields?account_type_id="+t+"&is_personal_account="+r}).then((e=>e));if(SecurdenExtensionUtils.isParamValid(m)&&SecurdenExtensionUtils.isParamValid(m.text_field_columns)){var f=m.text_field_columns,S=m.password_field_columns,g=document.createElement("div"),v=(l=0,""),w=null;for(let t in e)if("currentUrlDomain"in e[t]){v=e[t].currentUrlDomain;break}var h=document.createElement("div");h.id="form_field_form_wrap_div_"+l,h.className="split-form-wrap";var P=document.createElement("div");P.className="split-form-title";var b=l+1+". "+browser.i18n.getMessage("input_form")+"(URL: "+v+")";P.innerText=b,h.appendChild(P);var E=document.createElement("form");E.id="form_fields_save_form_name_"+l,E.className="split-form-left";var x=0,y=0,A=0,F=0,U=0,k=0,I=0,C=0;for(let t in e){C+=1;var T=e[t],N=(T.step,T.type),M=T.tagName;w=N;var R=browser.i18n.getMessage("text_input_field");"password"==N?(R=browser.i18n.getMessage("password_input_field"),I=y+=1):"SELECT"==M?(R=browser.i18n.getMessage("select_input_field"),I=A+=1):"INPUT"==M&&"checkbox"==T.type?(null==N&&(N="checkbox"),R=browser.i18n.getMessage("checkbox_input_field"),I=U+=1):"INPUT"==M&&"radio"==T.type?(null==N&&(N="radio"),R=browser.i18n.getMessage("radio_input_field"),I=k+=1):T.button?(null==N&&(N="button"),R=browser.i18n.getMessage("button_input_field"),I=F+=1):"INPUT"!=M&&"TEXTAREA"!=M||(null==N&&(N="text"),I=x+=1);var V=document.createElement("div");V.className="sec-split-form-input-wrap",V.id="split_form_input_wrap_"+N+"_"+l+"_"+I,V.setAttribute("type_of_input",N);var B=document.createElement("div");B.className="sec-ext-map-input-list-wrap",B.id="ext_map_input_list_wrap_"+N+"_"+l+"_"+I,B.setAttribute("type_of_input",N),V.appendChild(B);var O=document.createElement("div");O.className="cyb-form-field field-box cyb-input-filled";var D=document.createElement("div");D.className="split-form-label-title",D.innerText=R;var L=document.createElement("div");L.className="split-form-value";var H="",q="",W=null;"INPUT"==T.tagName&&"checkbox"==T.type?(W="checkbox",H=T.id,q="checkbox: "):"INPUT"==T.tagName&&"radio"==T.type?(W="radio",H=T.id,SecurdenExtensionUtils.isParamValid(H)&&""!=H.trim()||(H=T.value),q="radio: "):T.button?(W="button",H=T.targetId,SecurdenExtensionUtils.isParamValid(H)&&""!=H.trim()||(H=T.buttonValue),SecurdenExtensionUtils.isParamValid(H)&&""!=H.trim()||(H=T.type),"A"==T.tagName&&(H=T.tagName),q="button: "):"SELECT"==T.tagName?(W="SELECT",H=T.targetId,q="SELECT: "):"INPUT"!=T.tagName&&"TEXTAREA"!=T.tagName||(W=T.fieldIdentifier,H=T.fieldIdentifierValue,q=T.fieldIdentifier+": "),q+=H,L.innerText=q,O.appendChild(D),O.appendChild(L);var G=document.createElement("div");G.className="cyb-input-list";var j=document.createElement("div");j.className="cyb-form-field cyb-label-focus height10";var K=document.createElement("div");K.className="cyb-usergroup-label",K.innerText=browser.i18n.getMessage("value_mapping"),j.appendChild(K);var Y=document.createElement("div");Y.className="cyb-select";var z=document.createElement("div");z.className="cyb-input",z.id="form_field_select_div_"+l;var J="",Q=f.slice();if("SELECT"==M){var Z={attr_display_name:T.selectedText,attr_name:"additional_value",table_name:"api.models.FormFieldsAdditional",table_column_name:"additional_value"};Q.unshift(Z),J=Q}else J=f;var X="text_";"password"==N?(J=S,X="password_"):"radio"==T.type?X="radio_":"SELECT"==T.tagName?X="select_":"checkbox"==T.type?X="checkbox_":T.button&&(X="button_");var ee=document.createElement("select");ee.className="cyb-login-select";var te=X+"form_field_val_"+l+"_"+I;ee.name=te,ee.id=te,ee.setAttribute("field-identifier","j");for(var ne=J.length,oe="accountmanagement.models.Accounts",ie=0;ie<ne;ie++){var re="";re=document.createElement("option");var se=J[ie].attr_name;SecurdenExtensionUtils.isParamValid(J[ie].id)&&(se=J[ie].id),re.textContent=J[ie].attr_display_name,re.value=re.id=se,re.setAttribute("prefix",X),re.setAttribute("model_name",J[ie].table_name),re.setAttribute("index",l),re.setAttribute("field_count",I),0==ie&&(re.selected=!0,oe=J[ie].table_name),ee.appendChild(re)}ee.onchange=function(e){Securden_Popup.changeFieldValueForFormFieldValue(this)},z.appendChild(ee),Y.appendChild(z);var ae=document.createElement("input");ae.type="hidden",ae.id=ae.name=X+"form_field_step_"+l+"_"+I,ae.setAttribute("value",T.step);var ce=document.createElement("input");ce.type="hidden",ce.id=ce.name=X+"form_field_val_type_model_"+l+"_"+I,ce.setAttribute("value",oe);var de=document.createElement("input");if(de.type="hidden",de.id=de.name=X+"form_field_identifier_val_"+l+"_"+I,de.setAttribute("value",H),"select_"==X||"checkbox_"==X||"radio_"==X||"button_"==X&&T.value){var ue=document.createElement("input");ue.type="hidden",ue.id=ue.name=X+"form_field_option_val_"+l+"_"+I,T.value||(T.value=T.targetId),ue.setAttribute("value",T.value)}var le=document.createElement("input");le.type="hidden",le.id=le.name=X+"form_field_identifier_"+l+"_"+I,le.setAttribute("value",W),Y.appendChild(ce),Y.appendChild(de),Y.appendChild(le),j.appendChild(Y),G.appendChild(O),T.button||"checkbox"==T.type||"radio"==T.type||G.appendChild(j),("select_"==X||"checkbox_"==X||"radio_"==X||"button_"==X&&T.value)&&G.appendChild(ue),G.appendChild(ae),G.appendChild(de),G.appendChild(le),B.appendChild(G);var _e=document.createElement("div");_e.className="additional-field-icons";var pe=document.createElement("i");pe.className="icon-minus",pe.setAttribute("form_id_number",l),pe.setAttribute("field_id_number",I),pe.setAttribute("type_of_input",N),pe.onclick=function(e){Securden_Popup.deleteFormSingleField(e)},_e.appendChild(pe),B.appendChild(_e),E.appendChild(V)}var me=document.createElement("input");me.type="hidden",me.id=me.name="text_form_field_length_"+l,me.setAttribute("value",x),E.appendChild(me);var fe=document.createElement("input");fe.type="hidden",fe.id=fe.name="password_form_field_length_"+l,fe.setAttribute("value",y),E.appendChild(fe);var Se=document.createElement("input");Se.type="hidden",Se.id=Se.name="select_form_field_length_"+l,Se.setAttribute("value",A),E.appendChild(Se);var ge=document.createElement("input");ge.type="hidden",ge.id=ge.name="button_form_field_length_"+l,ge.setAttribute("value",F),E.appendChild(ge);var ve=document.createElement("input");ve.type="hidden",ve.id=ve.name="checkbox_form_field_length_"+l,ve.setAttribute("value",U),E.appendChild(ve);var we=document.createElement("input");if(we.type="hidden",we.id=we.name="radio_form_field_length_"+l,we.setAttribute("value",k),E.appendChild(we),SecurdenExtensionUtils.isParamValid(w)){var he=document.createElement("input");he.type="hidden",he.id=he.name="last_field_type",he.setAttribute("value",w),E.appendChild(he)}h.appendChild(E),h.setAttribute("total_fields_count",C),g.appendChild(h),0!=(l+=1)&&(Securden_Popup.formFieldsFormCount=l,Securden_Popup.formFieldsFormCountInitial=l),Securden_Popup.formFieldsInputURL=v,$("#form_fields_save_forms_div").empty(),document.getElementById("form_fields_save_forms_div").appendChild(g),$("body").addClass("width640"),$(".container").addClass("max-width640"),SecurdenExtensionUtils.showHide(["form_fields_save_form"],["loading"])}else Securden_Popup.errorMsgFormFieldsFunction()}else Securden_Popup.errorMsgFormFieldsFunction()},saveFormFieldsSuccess:function(e){Securden_Popup.formFieldsForSave=null,Securden_Popup.widthRevertForFormFieldSave(),Securden_Popup.addAccountSuccess(e),Securden_Popup.isEditableFields=!1,Securden_Popup.deleteRecordings()},changeOrg:function(e){data={org_id:e},Securden_Popup.sendRequest({action:"switch_org",data:data,type:"POST",onSuccessFunc:"reloadPage"})},reloadPage:function(e){SecurdenExtensionUtils.showHide(["loading"],[]),SecurdenExtensionUtils.isParamValid(e.current_org_id)&&(Securden_Popup.currentOrgId=e.current_org_id);var t=$("#search_accounts").val(),n=Securden_Popup.filterByValue,o=Securden_Popup.filterByValueCategory,i={};Securden_Popup.isFilterByType&&""!=n.trim()?(i.account_type=n,i.account_category=o):Securden_Popup.isFilterBy&&""!=n.trim()&&(i.account_address=n);var r=Securden_Popup.topFolderId;SecurdenExtensionUtils.isParamValid(r)&&(i.folder_id=r),Securden_Popup.getAccounts(t,i)},mspSwitchBar:function(e){var t=null,n=$("<div>",{id:"asset_server_elem",class:"show"}),o=$("<select>",{id:"msp-select2-div"}),i=e,r=$("<option>",{}).text(i);o.append(r),n.append(o),$("#extension_msp_org_select_input").empty(),$("#extension_msp_org_select_input").append(n),$("#user_details_div").appendTo("#msp_select2_switch"),document.getElementById("edition-top-label_id").textContent=browser.i18n.getMessage("view_organization"),$("#msp-select2-div").select2({tags:!1,theme:"classic",ajax:{url:Securden_Popup.serverUrl+"/browser_extension_api/get_all_org",data:function(e){return{search_string:e.term,page:1,page_limit:200}},processResults:function(e){return{results:e.data}}},templateSelection:function(e,n){return $(e.element).attr("data-id",e.element.id),(t=e.id)&&e.domain_type&&(Securden_Popup.changeOrg(t),t=null),e.text}})}};Securden_Popup.init();