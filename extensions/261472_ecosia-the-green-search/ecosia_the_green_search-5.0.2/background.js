(function(){"use strict";const n=window.chrome||browser,d="firefox",{runtime:l}=n,E="https://www.ecosia.org",{version:a}=l.getManifest(),R={addon:d,addonversion:a},s=(e,c)=>{const r=new URL(E),o=new URLSearchParams({...c,...R});return r.pathname=e,r.search=o.toString(),r.toString()},u=e=>s("search",{q:e}),L=()=>!!n.runtime.lastError,{browserAction:U,contextMenus:i,tabs:g,i18n:w,runtime:t}=n,h=()=>{n.tabs.create({url:s("",{ref:"icon-search"})})},S=(e,c,r)=>{if(e&&e.reason&&e.reason==="version")r({version:a});else{const o=`invalid request: ${JSON.stringify(e)}`;r({error:new Error(o)})}return!0};if(t.setUninstallURL){const e=s("uninstall",{feedback:"true"});t.setUninstallURL(e)}U.onClicked.addListener(h),t.onMessageExternal.addListener(S),i.create({id:`${t.id}/context`,title:w.getMessage("context_menu_search"),contexts:["selection"]},()=>{t.lastError&&L(),i.onClicked.addListener(e=>{g.create({url:u(e.selectionText)})})})})();
