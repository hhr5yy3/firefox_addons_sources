/*! For license information please see build.js.LICENSE.txt */
(()=>{var e={97748:e=>{e.exports=function(){var e,t=function(e,t,n){for(var i=n,r=0,o=e.length;r<o;r++)i=t(i,e[r],r,e);return i},n=function(e,n){return t(e,(function(e,t,i,r){return n(t,i,r)?e.concat(t):e}),[])},i=function(e,n){return t(e,(function(e,t,i,r){return e.concat(n(t,i,r))}),[])},r=function(e,n){return t(e,(function(e,t,i,r){return!0===e||t===n}),!1)},o=!{toString:null}.propertyIsEnumerable("toString"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=function(e){return e<10?"0"+e:e},c={map:i,reduce:t,filter:n,includes:r,keys:function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);if(!o)return n;for(var i=0,r=a.length;i<r;i++)Object.prototype.hasOwnProperty.call(e,a[i])&&n.push(a[i]);return n},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isoDate:function(){var e=new Date;return e.getUTCFullYear()+"-"+s(e.getUTCMonth()+1)+"-"+s(e.getUTCDate())+"T"+s(e.getUTCHours())+":"+s(e.getUTCMinutes())+":"+s(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}},u={intRange:function(e,t){return void 0===e&&(e=1),void 0===t&&(t=1/0),function(n){return"number"==typeof n&&parseInt(""+n,10)===n&&n>=e&&n<=t}},stringWithLength:function(e){return"string"==typeof e&&!!e.length}},l={},d=c.filter,h=c.reduce,f=c.keys,p=c.isArray,_=c.includes,E=u.intRange,y=u.stringWithLength;function v(){return v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},v.apply(this,arguments)}l.schema={apiKey:{defaultValue:function(){return null},message:"is required",validate:y},appVersion:{defaultValue:function(){return null},message:"should be a string",validate:function(e){return null===e||y(e)}},appType:{defaultValue:function(){return null},message:"should be a string",validate:function(e){return null===e||y(e)}},autoNotify:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return!0===e||!1===e}},beforeSend:{defaultValue:function(){return[]},message:"should be a function or array of functions",validate:function(e){return"function"==typeof e||p(e)&&d(e,(function(e){return"function"==typeof e})).length===e.length}},endpoints:{defaultValue:function(){return{notify:"https://notify.bugsnag.com",sessions:"https://sessions.bugsnag.com"}},message:"should be an object containing endpoint URLs { notify, sessions }. sessions is optional if autoCaptureSessions=false",validate:function(e,t){return e&&"object"==typeof e&&y(e.notify)&&(!1===t.autoCaptureSessions||y(e.sessions))&&0===d(f(e),(function(e){return!_(["notify","sessions"],e)})).length}},autoCaptureSessions:{defaultValue:function(e,t){return void 0===t.endpoints||!!t.endpoints&&!!t.endpoints.sessions},message:"should be true|false",validate:function(e){return!0===e||!1===e}},notifyReleaseStages:{defaultValue:function(){return null},message:"should be an array of strings",validate:function(e){return null===e||p(e)&&d(e,(function(e){return"string"==typeof e})).length===e.length}},releaseStage:{defaultValue:function(){return"production"},message:"should be a string",validate:function(e){return"string"==typeof e&&e.length}},maxBreadcrumbs:{defaultValue:function(){return 20},message:"should be a number ≤40",validate:function(e){return E(0,40)(e)}},autoBreadcrumbs:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return"boolean"==typeof e}},user:{defaultValue:function(){return null},message:"(object) user should be an object",validate:function(e){return"object"==typeof e}},metaData:{defaultValue:function(){return null},message:"should be an object",validate:function(e){return"object"==typeof e}},logger:{defaultValue:function(){},message:"should be null or an object with methods { debug, info, warn, error }",validate:function(e){return!e||e&&h(["debug","info","warn","error"],(function(t,n){return t&&"function"==typeof e[n]}),!0)}},filters:{defaultValue:function(){return["password"]},message:"should be an array of strings|regexes",validate:function(e){return p(e)&&e.length===d(e,(function(e){return"string"==typeof e||e&&"function"==typeof e.test})).length}}},l.mergeDefaults=function(e,t){if(!e||!t)throw new Error("opts and schema objects are required");return h(f(t),(function(n,i){return n[i]=void 0!==e[i]?e[i]:t[i].defaultValue(e[i],e),n}),{})},l.validate=function(e,t){if(!e||!t)throw new Error("opts and schema objects are required");var n=h(f(t),(function(n,i){return t[i].validate(e[i],e)?n:n.concat({key:i,message:t[i].message,value:e[i]})}),[]);return{valid:!n.length,errors:n}};var g=l.schema,S=c.map,T={releaseStage:{defaultValue:function(){return/^localhost(:\d+)?$/.test(window.location.host)?"development":"production"},message:"should be set",validate:u.stringWithLength},logger:v({},g.logger,{defaultValue:function(){return"undefined"!=typeof console&&"function"==typeof console.debug?O():void 0}})},O=function(){var e={},t=console.log;return S(["debug","info","warn","error"],(function(n){var i=console[n];e[n]="function"==typeof i?i.bind(console,"[bugsnag]"):t.bind(console,"[bugsnag]")})),e},m=c.isoDate,A=function(){function e(e,t,n,i){void 0===e&&(e="[anonymous]"),void 0===t&&(t={}),void 0===n&&(n="manual"),void 0===i&&(i=m()),this.type=n,this.name=e,this.metaData=t,this.timestamp=i}return e.prototype.toJSON=function(){return{type:this.type,name:this.name,timestamp:this.timestamp,metaData:this.metaData}},e}(),R=function(e,t,n){var i=e.length,r=0,o=function(){if(r>=i)return n(null,!1);t(e[r],(function(e,t){return e?n(e,!1):!0===t?n(null,!0):(r++,void o())}))};o()},P=function(e){return e.app&&"string"==typeof e.app.releaseStage?e.app.releaseStage:e.config.releaseStage};function I(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}}var N=I,b=function(e,t){return function(n,i){if("function"!=typeof n)return i(null,!1);try{if(2!==n.length){var r=n(e);return r&&"function"==typeof r.then?r.then((function(t){return setTimeout((function(){return i(null,C(e,t))}),0)}),(function(e){setTimeout((function(){return t(e),i(null,!1)}))})):i(null,C(e,r))}n(e,(function(n,r){if(n)return t(n),i(null,!1);i(null,C(e,r))}))}catch(e){t(e),i(null,!1)}}},C=function(e,t){return e.isIgnored()||!1===t},L={};!function(t,n){"use strict";"function"==typeof e&&e.amd?e("stackframe",[],n):"object"==typeof L?L=n():t.StackFrame=n()}(this,(function(){"use strict";function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],o=["fileName","functionName","source"],a=["args"],s=i.concat(r,o,a);function c(e){if(e instanceof Object)for(var n=0;n<s.length;n++)e.hasOwnProperty(s[n])&&void 0!==e[s[n]]&&this["set"+t(s[n])](e[s[n]])}c.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof c)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new c(e)}},toString:function(){return(this.getFunctionName()||"{anonymous}")+"("+(this.getArgs()||[]).join(",")+")"+(this.getFileName()?"@"+this.getFileName():"")+(e(this.getLineNumber())?":"+this.getLineNumber():"")+(e(this.getColumnNumber())?":"+this.getColumnNumber():"")}};for(var u=0;u<i.length;u++)c.prototype["get"+t(i[u])]=n(i[u]),c.prototype["set"+t(i[u])]=function(e){return function(t){this[e]=Boolean(t)}}(i[u]);for(var l=0;l<r.length;l++)c.prototype["get"+t(r[l])]=n(r[l]),c.prototype["set"+t(r[l])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(r[l]);for(var d=0;d<o.length;d++)c.prototype["get"+t(o[d])]=n(o[d]),c.prototype["set"+t(o[d])]=function(e){return function(t){this[e]=String(t)}}(o[d]);return c}));var M={};!function(t,n){"use strict";"function"==typeof e&&e.amd?e("error-stack-parser",["stackframe"],n):"object"==typeof M?M=n(L):t.ErrorStackParser=n(t.StackFrame)}(this,(function(e){"use strict";var t=/(^|@)\S+\:\d+/,n=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(n)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),i=n.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(n=i?n.replace(i[0],""):n).split(/\s+/).slice(1),o=this.extractLocation(i?i[1]:r.pop()),a=r.join(" ")||void 0,s=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new e({functionName:a,fileName:s,lineNumber:o[1],columnNumber:o[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(i)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,i=t.match(n),r=i&&i[1]?i[1]:void 0,o=this.extractLocation(t.replace(n,""));return new e({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,i=t.message.split("\n"),r=[],o=2,a=i.length;o<a;o+=2){var s=n.exec(i[o]);s&&r.push(new e({fileName:s[2],lineNumber:s[1],source:i[o]}))}return r},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,i=t.stacktrace.split("\n"),r=[],o=0,a=i.length;o<a;o+=2){var s=n.exec(i[o]);s&&r.push(new e({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:i[o]}))}return r},parseOpera11:function(n){return n.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var n,i=t.split("@"),r=this.extractLocation(i.pop()),o=i.shift()||"",a=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:a,args:s,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:t})}),this)}}}));var w=M,D=function(e){return!(!e||!e.stack&&!e.stacktrace&&!e["opera#sourceloc"]||"string"!=typeof(e.stack||e.stacktrace||e["opera#sourceloc"])||e.stack===e.name+": "+e.message)},j="browserjs",U={};function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},x.apply(this,arguments)}!function(t,n){"use strict";"function"==typeof e&&e.amd?e("stack-generator",["stackframe"],n):"object"==typeof U?U=n(L):t.StackGenerator=n(t.StackFrame)}(this,(function(e){return{backtrace:function(t){var n=[],i=10;"object"==typeof t&&"number"==typeof t.maxStackSize&&(i=t.maxStackSize);for(var r=arguments.callee;r&&n.length<i&&r.arguments;){for(var o=new Array(r.arguments.length),a=0;a<o.length;++a)o[a]=r.arguments[a];/function(?:\s+([\w$]+))+\s*\(/.test(r.toString())?n.push(new e({functionName:RegExp.$1||void 0,args:o})):n.push(new e({args:o}));try{r=r.caller}catch(e){break}}return n}}}));var G=c.reduce,k=c.filter,B=function(){function e(e,t,n,i,r){void 0===n&&(n=[]),void 0===i&&(i=Y()),this.__isBugsnagReport=!0,this._ignored=!1,this._handledState=i,this.app=void 0,this.apiKey=void 0,this.breadcrumbs=[],this.context=void 0,this.device=void 0,this.errorClass=H(e,"[no error class]"),this.errorMessage=H(t,"[no error message]"),this.groupingHash=void 0,this.metaData={},this.request=void 0,this.severity=this._handledState.severity,this.stacktrace=G(n,(function(e,t){var n=V(t);try{return"{}"===JSON.stringify(n)?e:e.concat(n)}catch(t){return e}}),[]),this.user=void 0,this.session=void 0,this.originalError=r}var t=e.prototype;return t.ignore=function(){this._ignored=!0},t.isIgnored=function(){return this._ignored},t.updateMetaData=function(e){var t,n;return e?null===(arguments.length<=1?void 0:arguments[1])?this.removeMetaData(e):null===(arguments.length<=2?void 0:arguments[2])?this.removeMetaData(e,arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):("object"==typeof(arguments.length<=1?void 0:arguments[1])&&(n=arguments.length<=1?void 0:arguments[1]),"string"==typeof(arguments.length<=1?void 0:arguments[1])&&((t={})[arguments.length<=1?void 0:arguments[1]]=arguments.length<=2?void 0:arguments[2],n=t),n?(this.metaData[e]||(this.metaData[e]={}),this.metaData[e]=x({},this.metaData[e],n),this):this):this},t.removeMetaData=function(e,t){return"string"!=typeof e?this:t?this.metaData[e]?(delete this.metaData[e][t],this):this:(delete this.metaData[e],this)},t.toJSON=function(){return{payloadVersion:"4",exceptions:[{errorClass:this.errorClass,message:this.errorMessage,stacktrace:this.stacktrace,type:j}],severity:this.severity,unhandled:this._handledState.unhandled,severityReason:this._handledState.severityReason,app:this.app,device:this.device,breadcrumbs:this.breadcrumbs,context:this.context,user:this.user,metaData:this.metaData,groupingHash:this.groupingHash,request:this.request,session:this.session}},e}(),V=function(e){var t={file:e.fileName,method:F(e.functionName),lineNumber:e.lineNumber,columnNumber:e.columnNumber,code:void 0,inProject:void 0};return t.lineNumber>-1&&!t.file&&!t.method&&(t.file="global code"),t},F=function(e){return/^global code$/i.test(e)?"global code":e},Y=function(){return{unhandled:!1,severity:"warning",severityReason:{type:"handledException"}}},H=function(e,t){return"string"==typeof e&&e?e:t};B.getStacktrace=function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),D(e))return w.parse(e).slice(t);try{throw e}catch(t){if(D(t))return w.parse(e).slice(1+n);try{return k(U.backtrace(),(function(e){return-1===(e.functionName||"").indexOf("StackGenerator$$")})).slice(1+n)}catch(e){return[]}}},B.ensureReport=function(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),e.__isBugsnagReport)return e;try{var i=B.getStacktrace(e,t,1+n);return new B(e.name,e.message,i,void 0,e)}catch(t){return new B(e.name,e.message,[],void 0,e)}};var W=B,K=function(e,t){var n="000000000"+e;return n.substr(n.length-t)},q="object"==typeof window?window:self,X=0;for(var $ in q)Object.hasOwnProperty.call(q,$)&&X++;var J=navigator.mimeTypes?navigator.mimeTypes.length:0,z=K((J+navigator.userAgent.length).toString(36)+X.toString(36),4),Z=function(){return z},Q=0,ee=4,te=36,ne=Math.pow(te,ee);function ie(){return K((Math.random()*ne<<0).toString(te),ee)}function re(){return Q=Q<ne?Q:0,++Q-1}function oe(){return"c"+(new Date).getTime().toString(te)+K(re().toString(te),ee)+Z()+(ie()+ie())}oe.fingerprint=Z;var ae=oe,se=c.isoDate,ce=function(){function e(){this.id=ae(),this.startedAt=se(),this._handled=0,this._unhandled=0}var t=e.prototype;return t.toJSON=function(){return{id:this.id,startedAt:this.startedAt,events:{handled:this._handled,unhandled:this._unhandled}}},t.trackError=function(e){this[e._handledState.unhandled?"_unhandled":"_handled"]+=1},e}();function ue(){return ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ue.apply(this,arguments)}var le=c.map,de=c.includes,he=c.isArray,fe="Usage error.",pe="Bugsnag usage error.",_e=function(){function e(t){if(!(t&&t.name&&t.version&&t.url))throw new Error("`notifier` argument is required");this.notifier=t,this._configured=!1,this._opts={},this.config={},this._delivery={sendSession:function(){},sendReport:function(){}},this._logger={debug:function(){},info:function(){},warn:function(){},error:function(){}},this._plugins={},this._session=null,this.breadcrumbs=[],this.app={},this.context=void 0,this.device=void 0,this.metaData=void 0,this.request=void 0,this.user={},this.BugsnagClient=e,this.BugsnagReport=W,this.BugsnagBreadcrumb=A,this.BugsnagSession=ce;var n=this,i=this.notify;this.notify=function(){return i.apply(n,arguments)}}var t=e.prototype;return t.setOptions=function(e){this._opts=ue({},this._opts,e)},t.configure=function(e){void 0===e&&(e=l.schema);var t=l.mergeDefaults(this._opts,e),n=l.validate(t,e);if(1==!n.valid)throw new Error(ve(n.errors));return"function"==typeof t.beforeSend&&(t.beforeSend=[t.beforeSend]),t.appVersion&&(this.app.version=t.appVersion),t.appType&&(this.app.type=t.appType),t.metaData&&(this.metaData=t.metaData),t.user&&(this.user=t.user),t.logger&&this.logger(t.logger),this.config=ue({},this.config,t),this._configured=!0,this},t.use=function(e){if(!this._configured)throw new Error("client not configured");e.configSchema&&this.configure(e.configSchema);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=e.init.apply(e,[this].concat(n));return e.name&&(this._plugins["~"+e.name+"~"]=r),this},t.getPlugin=function(e){return this._plugins["~"+e+"~"]},t.delivery=function(e){return this._delivery=e(this),this},t.logger=function(e,t){return this._logger=e,this},t.sessionDelegate=function(e){return this._sessionDelegate=e,this},t.startSession=function(){return this._sessionDelegate?this._sessionDelegate.startSession(this):(this._logger.warn("No session implementation is installed"),this)},t.leaveBreadcrumb=function(e,t,n,i){if(!this._configured)throw new Error("client not configured");if(n="string"==typeof n?n:void 0,i="string"==typeof i?i:void 0,t="object"==typeof t&&null!==t?t:void 0,"string"==typeof(e=e||void 0)||t){var r=new A(e,t,n,i);return this.breadcrumbs.push(r),this.breadcrumbs.length>this.config.maxBreadcrumbs&&(this.breadcrumbs=this.breadcrumbs.slice(this.breadcrumbs.length-this.config.maxBreadcrumbs)),this}},t.notify=function(e,t,n){var i=this;if(void 0===t&&(t={}),void 0===n&&(n=function(){}),!this._configured)throw new Error("client not configured");var r=P(this),o=Ee(e,t,this._logger),a=o.err,s=o.errorFramesToSkip,c=o._opts;c&&(t=c),"object"==typeof t&&null!==t||(t={});var u=W.ensureReport(a,s,2);if(u.app=ue({},{releaseStage:r},u.app,this.app),u.context=u.context||t.context||this.context||void 0,u.device=ue({},u.device,this.device,t.device),u.request=ue({},u.request,this.request,t.request),u.user=ue({},u.user,this.user,t.user),u.metaData=ue({},u.metaData,this.metaData,t.metaData),u.breadcrumbs=this.breadcrumbs.slice(0),this._session&&(this._session.trackError(u),u.session=this._session),void 0!==t.severity&&(u.severity=t.severity,u._handledState.severityReason={type:"userSpecifiedSeverity"}),he(this.config.notifyReleaseStages)&&!de(this.config.notifyReleaseStages,r))return this._logger.warn("Report not sent due to releaseStage/notifyReleaseStages configuration"),n(null,u);var l=u.severity,d=[].concat(t.beforeSend).concat(this.config.beforeSend),h=function(e){i._logger.error("Error occurred in beforeSend callback, continuing anyway…"),i._logger.error(e)};R(d,b(u,h),(function(e,t){if(e&&h(e),t)return i._logger.debug("Report not sent due to beforeSend callback"),n(null,u);i.config.autoBreadcrumbs&&i.leaveBreadcrumb(u.errorClass,{errorClass:u.errorClass,errorMessage:u.errorMessage,severity:u.severity},"error"),l!==u.severity&&(u._handledState.severityReason={type:"userCallbackSetSeverity"}),i._delivery.sendReport({apiKey:u.apiKey||i.config.apiKey,notifier:i.notifier,events:[u]},(function(e){return n(e,u)}))}))},e}(),Ee=function(e,t,n){var i,r,o=3,a=function(e){var t=ge(e);return n.warn(fe+" "+t),new Error(pe+" "+t)},s=0;switch(typeof e){case"string":"string"==typeof t?(i=a("string/string"),r={metaData:{notifier:{notifyArgs:[e,t]}}}):(i=new Error(String(e)),s=o);break;case"number":case"boolean":i=new Error(String(e));break;case"function":i=a("function");break;case"object":null!==e&&(N(e)||e.__isBugsnagReport)?i=e:null!==e&&ye(e)?((i=new Error(e.message||e.errorMessage)).name=e.name||e.errorClass,s=o):i=a(null===e?"null":"unsupported object");break;default:i=a("nothing")}return{err:i,errorFramesToSkip:s,_opts:r}},ye=function(e){return!("string"!=typeof e.name&&"string"!=typeof e.errorClass||"string"!=typeof e.message&&"string"!=typeof e.errorMessage)},ve=function(e){return"Bugsnag configuration error\n"+le(e,(function(e){return'"'+e.key+'" '+e.message+" \n    got "+Se(e.value)})).join("\n\n")},ge=function(e){return"notify() expected error/opts parameters, got "+e},Se=function(e){return"object"==typeof e?JSON.stringify(e):String(e)},Te=_e,Oe=function(e,t,n,i){var r=i&&i.filterKeys?i.filterKeys:[],o=i&&i.filterPaths?i.filterPaths:[];return JSON.stringify(De(e,r,o),t,n)},me=20,Ae=25e3,Re=8,Pe="...";function Ie(e){return e instanceof Error||/^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(e))}function Ne(e){return"[Throws: "+(e?e.message:"?")+"]"}function be(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return!0;return!1}function Ce(e,t){for(var n=0,i=e.length;n<i;n++)if(0===t.indexOf(e[n]))return!0;return!1}function Le(e,t){for(var n=0,i=e.length;n<i;n++){if("string"==typeof e[n]&&e[n]===t)return!0;if(e[n]&&"function"==typeof e[n].test&&e[n].test(t))return!0}return!1}function Me(e){return"[object Array]"===Object.prototype.toString.call(e)}function we(e,t){try{return e[t]}catch(e){return Ne(e)}}function De(e,t,n){var i=[],r=0;function o(e,a){function s(){return a.length>Re&&r>Ae}if(r++,a.length>me)return Pe;if(s())return Pe;if(null===e||"object"!=typeof e)return e;if(be(i,e))return"[Circular]";if(i.push(e),"function"==typeof e.toJSON)try{r--;var c=o(e.toJSON(),a);return i.pop(),c}catch(e){return Ne(e)}if(Ie(e)){r--;var u=o({name:e.name,message:e.message},a);return i.pop(),u}if(Me(e)){for(var l=[],d=0,h=e.length;d<h;d++){if(s()){l.push(Pe);break}l.push(o(e[d],a.concat("[]")))}return i.pop(),l}var f={};try{for(var p in e)if(Object.prototype.hasOwnProperty.call(e,p))if(Ce(n,a.join("."))&&Le(t,p))f[p]="[Filtered]";else{if(s()){f[p]=Pe;break}f[p]=o(we(e,p),a.concat(p))}}catch(e){}return i.pop(),f}return o(e,[])}var je={},Ue=["events.[].app","events.[].metaData","events.[].user","events.[].breadcrumbs","events.[].request","events.[].device"],xe=["device","app","user"];je.report=function(e,t){var n=Oe(e,null,null,{filterPaths:Ue,filterKeys:t});if(n.length>1e6&&(delete e.events[0].metaData,e.events[0].metaData={notifier:"WARNING!\nSerialized payload was "+n.length/1e6+"MB (limit = 1MB)\nmetaData was removed"},(n=Oe(e,null,null,{filterPaths:Ue,filterKeys:t})).length>1e6))throw new Error("payload exceeded 1MB limit");return n},je.session=function(e,t){var n=Oe(e,null,null,{filterPaths:xe,filterKeys:t});if(n.length>1e6)throw new Error("payload exceeded 1MB limit");return n};var Ge={},ke=c.isoDate;Ge=function(e,t){return void 0===t&&(t=window),{sendReport:function(n,i){void 0===i&&(i=function(){});var r=Be(e.config,"notify","4",t),o=new t.XDomainRequest;o.onload=function(){i(null)},o.open("POST",r),setTimeout((function(){try{o.send(je.report(n,e.config.filters))}catch(t){e._logger.error(t),i(t)}}),0)},sendSession:function(n,i){void 0===i&&(i=function(){});var r=Be(e.config,"sessions","1",t),o=new t.XDomainRequest;o.onload=function(){i(null)},o.open("POST",r),setTimeout((function(){try{o.send(je.session(n,e.config.filters))}catch(t){e._logger.error(t),i(t)}}),0)}}};var Be=function(e,t,n,i){return Ve(e.endpoints[t],i.location.protocol)+"?apiKey="+encodeURIComponent(e.apiKey)+"&payloadVersion="+n+"&sentAt="+encodeURIComponent(ke())},Ve=Ge._matchPageProtocol=function(e,t){return"http:"===t?e.replace(/^https:/,"http:"):e},Fe=c.isoDate,Ye=function(e,t){return void 0===t&&(t=window),{sendReport:function(n,i){void 0===i&&(i=function(){});try{var r=e.config.endpoints.notify,o=new t.XMLHttpRequest;o.onreadystatechange=function(){o.readyState===t.XMLHttpRequest.DONE&&i(null)},o.open("POST",r),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Bugsnag-Api-Key",n.apiKey||e.config.apiKey),o.setRequestHeader("Bugsnag-Payload-Version","4"),o.setRequestHeader("Bugsnag-Sent-At",Fe()),o.send(je.report(n,e.config.filters))}catch(t){e._logger.error(t)}},sendSession:function(n,i){void 0===i&&(i=function(){});try{var r=e.config.endpoints.sessions,o=new t.XMLHttpRequest;o.onreadystatechange=function(){o.readyState===t.XMLHttpRequest.DONE&&i(null)},o.open("POST",r),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Bugsnag-Api-Key",e.config.apiKey),o.setRequestHeader("Bugsnag-Payload-Version","1"),o.setRequestHeader("Bugsnag-Sent-At",Fe()),o.send(je.session(n,e.config.filters))}catch(t){e._logger.error(t)}}}},He={init:function(e,t){void 0===t&&(t=window),e.config.beforeSend.unshift((function(e){e.context||(e.context=t.location.pathname)}))}};function We(){return We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},We.apply(this,arguments)}var Ke=c.isoDate,qe={init:function(e,t){void 0===t&&(t=navigator);var n={locale:t.browserLanguage||t.systemLanguage||t.userLanguage||t.language,userAgent:t.userAgent};e.device=We({},n,e.device),e.config.beforeSend.unshift((function(e){e.device=We({},e.device,{time:Ke()})}))}};function Xe(){return Xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xe.apply(this,arguments)}var $e={init:function(e,t){void 0===t&&(t=window),e.config.beforeSend.unshift((function(e){e.request&&e.request.url||(e.request=Xe({},e.request,{url:t.location.href}))}))}};function Je(){return Je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Je.apply(this,arguments)}var ze=c.isArray,Ze=c.includes,Qe={init:function(e){return e.sessionDelegate(et)}},et={startSession:function(e){var t=e;t._session=new e.BugsnagSession;var n=P(t);return ze(t.config.notifyReleaseStages)&&!Ze(t.config.notifyReleaseStages,n)?(t._logger.warn("Session not sent due to releaseStage/notifyReleaseStages configuration"),t):t.config.endpoints.sessions?(t._delivery.sendSession({notifier:t.notifier,device:t.device,app:Je({},{releaseStage:n},t.app),sessions:[{id:t._session.id,startedAt:t._session.startedAt,user:t.user}]}),t):(t._logger.warn("Session not sent due to missing endpoints.sessions configuration"),t)}};function tt(){return tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tt.apply(this,arguments)}var nt={init:function(e){e.config.collectUserIp||e.config.beforeSend.push((function(e){e.user&&void 0===e.user.id&&delete e.user.id,e.user=tt({id:"[NOT COLLECTED]"},e.user),e.request=tt({clientIp:"[NOT COLLECTED]"},e.request)}))},configSchema:{collectUserIp:{defaultValue:function(){return!0},message:"should be true|false",validate:function(e){return!0===e||!1===e}}}},it={},rt=c.map,ot=c.reduce,at=c.filter;it.init=function(e){var t=/^dev(elopment)?$/.test(e.config.releaseStage),n=!1===e.config.consoleBreadcrumbsEnabled,i=(!1===e.config.autoBreadcrumbs||t)&&!0!==e.config.consoleBreadcrumbsEnabled;n||i||rt(st,(function(t){var n=console[t];console[t]=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];e.leaveBreadcrumb("Console output",ot(r,(function(e,t,n){var i="[Unknown value]";try{i=String(t)}catch(e){}if("[object Object]"===i)try{i=JSON.stringify(t)}catch(e){}return e["["+n+"]"]=i,e}),{severity:0===t.indexOf("group")?"log":t}),"log"),n.apply(console,r)},console[t]._restore=function(){console[t]=n}}))},it.configSchema={consoleBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}};var st=at(["log","debug","info","warn","error"],(function(e){return"undefined"!=typeof console&&"function"==typeof console[e]})),ct=c.map,ut=c.reduce,lt=c.filter,dt=200,ht=5e5,ft={init:function(e,t,n){if(void 0===t&&(t=document),void 0===n&&(n=window),e.config.trackInlineScripts){var i=n.location.href,r="",o=!1,a=function(){return t.documentElement.outerHTML};r=a();var s=t.onreadystatechange;t.onreadystatechange=function(){"interactive"===t.readyState&&(r=a(),o=!0);try{s.apply(this,arguments)}catch(e){}};var c=null,u=function(e){c=e},l=function(){var e=t.currentScript||c;if(!e&&!o){var n=t.scripts||t.getElementsByTagName("script");e=n[n.length-1]}return e},d=function(e){o&&r||(r=a());var t=["\x3c!-- DOC START --\x3e"].concat(r.split("\n")),n=e-1,i=Math.max(n-3,0),s=Math.min(n+3,t.length);return ut(t.slice(i,s),(function(e,t,n){return e[i+1+n]=t.length<=dt?t:t.substr(0,dt),e}),{})};e.config.beforeSend.unshift((function(e){e.stacktrace=lt(e.stacktrace,(function(e){return!/__trace__$/.test(e.method)}));var t=e.stacktrace[0];if(!t||!t.file||t.file.replace(/#.*$/,"")===i.replace(/#.*$/,"")){var n=l();if(n){var r=n.innerHTML;e.updateMetaData("script","content",r.length<=ht?r:r.substr(0,ht))}t&&t.lineNumber&&(t.code=d(t.lineNumber))}}));var h=ct(["setTimeout","setInterval","setImmediate","requestAnimationFrame"],(function(e){return pt(n,e,(function(e){return f(e,(function(e){return{get:function(){return e[0]},replace:function(t){e[0]=t}}}))}))}))[0];ct(["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],(function(e){n[e]&&n[e].prototype&&n[e].prototype.hasOwnProperty&&n[e].prototype.hasOwnProperty("addEventListener")&&(pt(n[e].prototype,"addEventListener",(function(e){return f(e,_t)})),pt(n[e].prototype,"removeEventListener",(function(e){return f(e,_t,!0)})))}))}function f(e,t,n){return void 0===n&&(n=!1),function(){var i=Array.prototype.slice.call(arguments);try{var r=t(i),o=r.get();if(n&&e.apply(this,i),"function"!=typeof o)return e.apply(this,i);if(o.__trace__)r.replace(o.__trace__);else{var a=l();o.__trace__=function(){u(a),h((function(){u(null)}),0);var e=o.apply(this,arguments);return u(null),e},o.__trace__.__trace__=o.__trace__,r.replace(o.__trace__)}}catch(e){}if(e.apply)return e.apply(this,i);switch(i.length){case 1:return e(i[0]);case 2:return e(i[0],i[1]);default:return e()}}}},configSchema:{trackInlineScripts:{validate:function(e){return!0===e||!1===e},defaultValue:function(){return!0},message:"should be true|false"}}};function pt(e,t,n){var i=e[t];if(!i)return i;var r=n(i);return e[t]=r,i}function _t(e){var t=!!e[1]&&"function"==typeof e[1].handleEvent;return{get:function(){return t?e[1].handleEvent:e[1]},replace:function(n){t?e[1].handleEvent=n:e[1]=n}}}var Et={init:function(e,t){if(void 0===t&&(t=window),"addEventListener"in t){var n=!1===e.config.interactionBreadcrumbsEnabled,i=!1===e.config.autoBreadcrumbs&&!0!==e.config.interactionBreadcrumbsEnabled;n||i||t.addEventListener("click",(function(n){var i,r;try{i=yt(n.target),r=vt(n.target,t)}catch(t){i="[hidden]",r="[hidden]",e._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/yy3rn63z")}e.leaveBreadcrumb("UI click",{targetText:i,targetSelector:r},"user")}),!0)}},configSchema:{interactionBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}}},yt=function(e){var t=e.textContent||e.innerText||"";return t||"submit"!==e.type&&"button"!==e.type||(t=e.value),gt(t=t.replace(/^\s+|\s+$/g,""),140)};function vt(e,t){var n=[e.tagName];if(e.id&&n.push("#"+e.id),e.className&&e.className.length&&n.push("."+e.className.split(" ").join(".")),!t.document.querySelectorAll||!Array.prototype.indexOf)return n.join("");try{if(1===t.document.querySelectorAll(n.join("")).length)return n.join("")}catch(e){return n.join("")}if(e.parentNode.childNodes.length>1){var i=Array.prototype.indexOf.call(e.parentNode.childNodes,e)+1;n.push(":nth-child("+i+")")}return 1===t.document.querySelectorAll(n.join("")).length?n.join(""):e.parentNode?vt(e.parentNode,t)+" > "+n.join(""):n.join("")}function gt(e,t){var n="(...)";return e&&e.length<=t?e:e.slice(0,t-n.length)+n}var St,Tt,Ot,mt={init:function(e,t){if(void 0===t&&(t=window),"addEventListener"in t){var n=!1===e.config.navigationBreadcrumbsEnabled,i=!1===e.config.autoBreadcrumbs&&!0!==e.config.navigationBreadcrumbsEnabled;if(!n&&!i){var r=function(t){return function(){return e.leaveBreadcrumb(t,{},"navigation")}};t.addEventListener("pagehide",r("Page hidden"),!0),t.addEventListener("pageshow",r("Page shown"),!0),t.addEventListener("load",r("Page loaded"),!0),t.document.addEventListener("DOMContentLoaded",r("DOMContentLoaded"),!0),t.addEventListener("load",(function(){return t.addEventListener("popstate",r("Navigated back"),!0)})),t.addEventListener("hashchange",(function(n){var i=n.oldURL?{from:At(n.oldURL,t),to:At(n.newURL,t),state:It(t)}:{to:At(t.location.href,t)};e.leaveBreadcrumb("Hash changed",i,"navigation")}),!0),t.history.replaceState&&Pt(e,t.history,"replaceState",t),t.history.pushState&&Pt(e,t.history,"pushState",t),e.leaveBreadcrumb("Bugsnag loaded",{},"navigation")}}},configSchema:{navigationBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}}},At=function(e,t){var n=t.document.createElement("A");return n.href=e,""+n.pathname+n.search+n.hash},Rt=function(e,t,n,i){var r=At(e.location.href,e);return{title:n,state:t,prevState:It(e),to:i||r,from:r}},Pt=function(e,t,n,i){var r=t[n];t[n]=function(o,a,s){e.leaveBreadcrumb("History "+n,Rt(i,o,a,s),"navigation"),"function"==typeof e.refresh&&e.refresh(),e.config.autoCaptureSessions&&e.startSession(),r.apply(t,[o,a].concat(void 0!==s?s:[]))}},It=function(e){try{return e.history.state}catch(e){}},Nt={},bt="request",Ct="BS~~S",Lt="BS~~U",Mt="BS~~M",wt=c.includes,Dt=function(){return[St.config.endpoints.notify,St.config.endpoints.sessions]};Nt.name="networkBreadcrumbs",Nt.init=function(e,t,n){void 0===t&&(t=Dt),void 0===n&&(n=window);var i=!1===e.config.networkBreadcrumbsEnabled,r=!1===e.config.autoBreadcrumbs&&!0!==e.config.networkBreadcrumbsEnabled;i||r||(St=e,Tt=n,Ot=t,jt(),Gt())},Nt.configSchema={networkBreadcrumbsEnabled:{defaultValue:function(){},validate:function(e){return!0===e||!1===e||void 0===e},message:"should be true|false"}};var jt=function(){if("addEventListener"in Tt.XMLHttpRequest.prototype){var e=Tt.XMLHttpRequest.prototype.open;Tt.XMLHttpRequest.prototype.open=function(t,n){this[Lt]=n,this[Mt]=t,this[Ct]&&(this.removeEventListener("load",Ut),this.removeEventListener("error",xt)),this.addEventListener("load",Ut),this.addEventListener("error",xt),this[Ct]=!0,e.apply(this,arguments)}}};function Ut(){if(!wt(Ot(),this[Lt])){var e={status:this.status,request:this[Mt]+" "+this[Lt]};this.status>=400?St.leaveBreadcrumb("XMLHttpRequest failed",e,bt):St.leaveBreadcrumb("XMLHttpRequest succeeded",e,bt)}}function xt(){wt(Ot,this[Lt])||St.leaveBreadcrumb("XMLHttpRequest error",{request:this[Mt]+" "+this[Lt]},bt)}var Gt=function(){if("fetch"in Tt&&!Tt.fetch.polyfill){var e=Tt.fetch;Tt.fetch=function(){var t,n=arguments,i=arguments[0],r=arguments[1],o=null;return i&&"object"==typeof i?(o=i.url,r&&"method"in r?t=r.method:i&&"method"in i&&(t=i.method)):(o=i,r&&"method"in r&&(t=r.method)),void 0===t&&(t="GET"),new Promise((function(i,r){e.apply(void 0,n).then((function(e){kt(e,t,o),i(e)})).catch((function(e){Bt(t,o),r(e)}))}))}}},kt=function(e,t,n){var i={status:e.status,request:t+" "+n};e.status>=400?St.leaveBreadcrumb("fetch() failed",i,bt):St.leaveBreadcrumb("fetch() succeeded",i,bt)},Bt=function(e,t){St.leaveBreadcrumb("fetch() error",{request:e+" "+t},bt)},Vt=u.intRange,Ft={init:function(e){var t=0;e.config.beforeSend.push((function(n){if(t>=e.config.maxEvents)return n.ignore();t++})),e.refresh=function(){t=0}},configSchema:{maxEvents:{defaultValue:function(){return 10},message:"should be a positive integer ≤100",validate:function(e){return Vt(1,100)(e)}}}},Yt={};function Ht(){return Ht=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ht.apply(this,arguments)}var Wt=c.map,Kt=(Yt={init:function(e){e.config.beforeSend.push((function(e){e.stacktrace=Wt(e.stacktrace,(function(e){return Ht({},e,{file:Kt(e.file)})}))}))}})._strip=function(e){return"string"==typeof e?e.replace(/\?.*$/,"").replace(/#.*$/,""):e},qt={init:function(e,t){function n(t,n,r,o,a){if(0===r&&/Script error\.?/.test(t))e._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/yy3rn63z");else{var s,c={severity:"error",unhandled:!0,severityReason:{type:"unhandledException"}};if(a)a.name&&a.message?s=new e.BugsnagReport(a.name,a.message,Xt(e.BugsnagReport.getStacktrace(a),n,r,o),c,a):(s=new e.BugsnagReport("window.onerror",String(a),Xt(e.BugsnagReport.getStacktrace(a,1),n,r,o),c,a)).updateMetaData("window onerror",{error:a});else if("object"!=typeof t||null===t||n&&"string"==typeof n||r||o||a)(s=new e.BugsnagReport("window.onerror",String(t),Xt(e.BugsnagReport.getStacktrace(a,1),n,r,o),c,t)).updateMetaData("window onerror",{event:t});else{var u=t.type?"Event: "+t.type:"window.onerror",l=t.message||t.detail||"";(s=new e.BugsnagReport(u,l,e.BugsnagReport.getStacktrace(new Error,1).slice(1),c,t)).updateMetaData("window onerror",{event:t,extraParameters:n})}e.notify(s)}"function"==typeof i&&i.apply(this,arguments)}void 0===t&&(t=window);var i=t.onerror;t.onerror=n}},Xt=function(e,t,n,i){var r=e[0];return r?(r.fileName||"string"!=typeof t||r.setFileName(t),!r.lineNumber&&$t(n)&&r.setLineNumber(n),r.columnNumber||($t(i)?r.setColumnNumber(i):window.event&&$t(window.event.errorCharacter)&&r.setColumnNumber(window.event.errorCharacter)),e):e},$t=function(e){return"number"==typeof e&&"NaN"!==String.call(e)},Jt={},zt=c.reduce;Jt.init=function(e,t){void 0===t&&(t=window);var n=function(t){var n=t.reason,i=!1;try{t.detail&&t.detail.reason&&(n=t.detail.reason,i=!0)}catch(e){}var r,o={severity:"error",unhandled:!0,severityReason:{type:"unhandledPromiseRejection"}};if(n&&D(n))r=new e.BugsnagReport(n.name,n.message,w.parse(n),o,n),i&&(r.stacktrace=zt(r.stacktrace,Qt(n),[]));else{var a='Rejection reason was not an Error. See "Promise" tab for more detail.';(r=new e.BugsnagReport(n&&n.name?n.name:"UnhandledRejection",n&&n.message?n.message:a,[],o,n)).updateMetaData("promise","rejection reason",Zt(n))}e.notify(r)};"addEventListener"in t?t.addEventListener("unhandledrejection",n):t.onunhandledrejection=function(e,t){n({detail:{reason:e,promise:t}})}};var Zt=function(e){return null==e?"undefined (or null)":N(e)?((t={})[Object.prototype.toString.call(e)]={name:e.name,message:e.message,code:e.code,stack:e.stack},t):e;var t},Qt=function(e){return function(t,n){return n.file===e.toString()?t:(n.method&&(n.method=n.method.replace(/^\s+/,"")),t.concat(n))}},en={};function tn(){return tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tn.apply(this,arguments)}var nn="Bugsnag JavaScript",rn="6.5.2",on="https://github.com/bugsnag/bugsnag-js",an=tn({},l.schema,T);return(en=function(e){"string"==typeof e&&(e={apiKey:e});var t="";e.endpoints&&e.endpoints.notify&&!e.endpoints.sessions&&(t+="notify endpoint is set but sessions endpoint is not. No sessions will be sent.");var n=new Te({name:nn,version:rn,url:on});return n.setOptions(e),n.delivery(window.XDomainRequest?Ge:Ye),n.configure(an),t&&n._logger.warn(t),n.use(qe),n.use(He),n.use($e),n.use(Ft),n.use(Qe),n.use(nt),n.use(Yt),!1!==n.config.autoNotify&&(n.use(qt),n.use(Jt)),n.use(mt),n.use(Et),n.use(Nt),n.use(it),n.use(ft),n._logger.debug("Loaded!"),n.config.autoCaptureSessions?n.startSession():n}).Bugsnag={Client:Te,Report:W,Session:ce,Breadcrumb:A},en.default=en,en}()},64061:(e,t,n)=>{e.exports=n(97748)},11578:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECommerceStream=void 0;const i=n(6044),r=n(60514),o=n(11272),a=n(11468),s=n(73975),c=n(93367),u=n(44468),l=n(7438),d=n(47090),h=n(42327),f=n(93794),p=n(83893),_=n(33492),E=n(33351),y=n(5920),v=n(83763),g=n(74182),S=n(2381),T=n(17473),O=n(20564),m=n(62554),A=n(14343),R=n(8417),P=n(67159);t.ECommerceStream=class{constructor(e){this.STORAGE_DEFAULT_KEY="E_COMMERCE_STREAM_CONFIG",this.populateConfig(e),this.initManagers(),this.initFeatures(),this.finalizeStreamInitiation()}populateConfig(e){const t={lib:this.version(),extension:e.version.extension};this.config={...e,version:t,storageKey:e.storageKey??this.STORAGE_DEFAULT_KEY}}subscribe(e,t){this.observer.subscribe(e,t)}tracking(e){this.config.track.tracking=e}safeCheckTracking(e){null!=this.config.safePriceCheck&&(this.config.safePriceCheck.tracking=e)}setDataSharing(e){this.config.dataSharing=e}async syncUp(){await this.syncUpManager.syncUp()}async getCoupons(e){return await this.couponManager.getCoupons(e)}async getPriceTrend(e){return await(this.priceTrendClient?.get(e))}initManagers(){this.logger=new a.Logger(this.config),this.alarmManager=new _.AlarmManager,this.authManager=new E.AuthManager(new y.AuthClient(this.config),new g.AuthStorage),this.configStorage=new v.ConfigStorage(this.config.storageKey),this.configManager=new l.ConfigManager(this.config,this.configStorage,this.logger),this.observer=new o.Observer,this.trackClient=new s.TrackClient(this.config),this.outMessageManager=new i.OutBgMessageManager(this.config),this.runtimeStorage=new d.RuntimeStorage(this.logger),this.inMessageManager=new r.InBgMessageManager(this.observer,this.outMessageManager,this.config,this.logger,this.runtimeStorage)}initFeatures(){this.syncUpManager=new c.SyncUpManager(this.logger,new u.SyncUpClient(this.config),this.config,this.configManager,this.alarmManager),this.priceTrendClient=new p.PriceTrendClient(this.config,this.authManager),this.safePriceCheckerManager=new S.SafePriceCheckerManager(this.config,this.logger,this.observer,new T.SafePriceCheckerClient(this.config)),this.couponManager=new m.CouponManager(this.config,new R.CouponClient(this.config,this.authManager),this.observer,new A.CouponStorage,this.alarmManager,this.logger)}version(){return"1.7.3"}initSubscriptions(){this.subscribe(h.InternalMessageBgType.TRACK,this.onTrack.bind(this)),this.subscribe(O.InternalSafePriceCheckerMessages.TRACK,this.onSafeCheck.bind(this)),this.subscribe(P.InternalCouponMessages.TRACK,this.onCouponFetch.bind(this))}onSafeCheck(e){this.safePriceCheckerManager.checkPrice(e.payload)}onCouponFetch({url:e}){this.couponManager.fetchCoupons(e)}async handleMigrations(){new f.Migration_3_0_0(this.configStorage,this.syncUpManager,this.logger)}onTrack(e){this.trackClient.track(e.payload)}async finalizeStreamInitiation(){this.initSubscriptions(),await this.handleMigrations(),await this.handleAuthentication(),await this.syncUpManager.setup(),await this.configManager.setup()}async handleAuthentication(){null!=this.config.auth&&await this.authManager.setup()}}},33492:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlarmManager=void 0;t.AlarmManager=class{async clear(e){return await chrome.alarms.clear(e)}create(e,t){chrome.alarms.create(e,t)}addListener(e,t){chrome.alarms.onAlarm.addListener((({name:n})=>{n===e&&t()}))}}},5920:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthClient=void 0;const i=n(1106),r=n(47729);t.AuthClient=class{constructor(e){this.config=e}async fetch(e,t={},n){const i=await fetch(e,t);return n?i:await i.json()}async fetchSecurityToken(){const{api:e,token:t}=this.config.auth??{};if(!e||!t)throw new Error("Authentication details were not provided");const n=`${e}/auth/access`;return await this.fetch(n,{method:"POST",headers:(0,i.pipe)((0,r.authorizationHeader)(t))({})},!0)}}},47978:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AvailableFeatureName=void 0,function(e){e.PRICE_TREND="priceTrend",e.COUPON="coupon"}(t.AvailableFeatureName||(t.AvailableFeatureName={}))},33351:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthManager=t.AuthError=t.DATE_SHIFT_MS=t.NETWORK_DELAY_S=t.TOKEN_EXPIRATION_THRESHOLD_MS=void 0;const i=n(1106),r=n(47729);t.TOKEN_EXPIRATION_THRESHOLD_MS=1e3,t.NETWORK_DELAY_S=60;t.DATE_SHIFT_MS=t.TOKEN_EXPIRATION_THRESHOLD_MS*t.NETWORK_DELAY_S;class o extends Error{constructor(e){super(e),this.name=o.name}}t.AuthError=o;t.AuthManager=class{constructor(e,t){this.authClient=e,this.storage=t}async setup(){await this.initAuthData()}async fetch(e,t,n,o={},a){const s=await this.getToken();await this.validateAvailability(e,t);const c={...o,headers:(0,i.pipe)((0,r.authorizationHeader)(s))(o?.headers)};return await this.authClient.fetch(n,c,a)}async validateAvailability(e,t){if("*"===t)return;if(!await this.storage.checkAvailableFeature(e,t))throw new o(`Feature: "${e}" is not available for domain: "${t}"`)}async getToken(){await this.reFetchIfNeeded();const e=await this.storage.getSecurityToken();return e?.value}async reFetchIfNeeded(){const e=await this.storage.getSecurityToken();(e?.expirationTime??0)+t.DATE_SHIFT_MS<Date.now()&&await this.initAuthData()}async initAuthData(){const e=await this.fetchSecurityToken();await this.storage.storeAuthData(e)}async fetchSecurityToken(){try{const e=await this.authClient.fetchSecurityToken();return await this.parsedToken(e)}catch(e){if(403===e.status)throw await this.storage.removeTokenEntities(),new o("Token is corrupted. Please contact your administrator to provide another");throw new o(`Could not get a security token, ${e}`)}}async parsedToken(e){const t=await e.json();return this.populateTokenExpiration(e.headers,t)}populateTokenExpiration(e,n){const i=e.get("Date");if(!i)return n;const r=new Date(i).getTime(),o=Math.abs(Date.now()-r);return o<=t.DATE_SHIFT_MS?n:{...n,expirationTime:n.expirationTime+o}}}},67159:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouponMessages=t.InternalCouponMessages=void 0,function(e){e.TRACK="COUPON_TRACK"}(t.InternalCouponMessages||(t.InternalCouponMessages={})),function(e){e.COUPON="ECOMMERCE_COUPON"}(t.CouponMessages||(t.CouponMessages={}))},8417:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouponClient=t.CouponClientError=void 0;const i=n(47978);class r extends Error{constructor(e){super(e),this.name=r.name}}t.CouponClientError=r;t.CouponClient=class{constructor(e,t){this.config=e,this.authManager=t}async fetchCoupons(e){const t=this.endpoint(`?domain=${e}`),n=await this.authManager.fetch(i.AvailableFeatureName.COUPON,e,t,{},!0);return 204===n.status?[]:await n.json()}async fetchDomains(){const e=this.endpoint("/domains");return await this.authManager.fetch(i.AvailableFeatureName.COUPON,"*",e)}endpoint(e){if(!this.config.coupon?.api)throw new r("ECommerceStream: Coupon feature is not initialized. Please provide the api url");return`${this.config.coupon?.api}/coupons${e}`}}},62554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouponManager=void 0;const i=n(67159);t.CouponManager=class{constructor(e,t,n,i,r,o){this.config=e,this.client=t,this.observer=n,this.storage=i,this.alarmManager=r,this.logger=o,this.ALARM_NAME="E_COMMERCE_COUPON_CONFIG_ALARM",this.setup()}async fetchCoupons(e=""){const t=this.getDomain(e);if(await this.isCouponsAvailable(t))try{const e=await this.client.fetchCoupons(t);if(!e.length)return;await this.storage.saveCoupons(e,t);const n={domain:t,coupons:e};this.observer.emit(i.CouponMessages.COUPON,n)}catch(e){this.logger.log(`CouponManager: could not fetch coupons for the domain: "${t}"`,e)}}async getCoupons(e=""){const t=this.getDomain(e);return await this.storage.getCoupons(t)}async fetchDomains(){try{const e=await this.client.fetchDomains();await this.storage.storeDomains(e)}catch(e){this.logger.log("CouponManager: could not fetch coupon domains",e)}}async isCouponsAvailable(e){return(await this.storage.getDomains()).some((({domain:t})=>new RegExp(t,"i").test(e)))}setup(){this.config.coupon&&(this.fetchDomains(),this.alarmManager.addListener(this.ALARM_NAME,this.fetchDomains.bind(this)),this.setupAlarm())}setupAlarm(){const e=this.config.coupon?.syncUpDomainM??36e5;this.alarmManager.create(this.ALARM_NAME,{delayInMinutes:e,periodInMinutes:e})}getDomain(e){try{const{host:t}=new URL(e);return t}catch{return e}}}},89737:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.acceptHeader=void 0;const i=n(55158);t.acceptHeader=({compression:e})=>(t={})=>({...t,Accept:e?i.ContentTypeHeader.OCTET_STREAM:i.ContentTypeHeader.JSON})},47729:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authorizationHeader=void 0;t.authorizationHeader=e=>(t={})=>({...t,Authorization:`Bearer ${e}`})},13653:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.basicAuthorizationHeader=void 0;t.basicAuthorizationHeader=e=>(t={})=>({...t,Authorization:`Basic ${e}`})},55158:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.contentTypeHeader=t.ContentTypeHeader=void 0,function(e){e.JSON="application/json;charset=utf-8",e.OCTET_STREAM="application/octet-stream"}(n=t.ContentTypeHeader||(t.ContentTypeHeader={}));t.contentTypeHeader=({compression:e})=>(t={})=>({...t,"Content-Type":e?n.OCTET_STREAM:n.JSON})},83893:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriceTrendClient=t.PriceTrendClientError=void 0;const i=n(47978);class r extends Error{constructor(e){super(e),this.name=r.name}}t.PriceTrendClientError=r;t.PriceTrendClient=class{constructor(e,t){this.config=e,this.authManager=t}async get(e){const t=this.endpoint(e);return await this.authManager.fetch(i.AvailableFeatureName.PRICE_TREND,e.domain,t)}endpoint(e){if(!this.config.priceTrend?.api)throw new r("ECommerceStream: Price trend is not initialized. Please provide the api url");return`${this.config.priceTrend.api}/price/trend?${this.query(e)}`}query({productId:e,domain:t,days:n}){const i=new URLSearchParams;return i.set("productId",e),i.set("domain",t),i.set("days",`${n}`),i.toString()}}},20564:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalSafePriceCheckerMessages=t.SafePriceCheckerMessages=void 0,function(e){e.SAFE_CHECK="ECOMMERCE_SAFE_CHECK"}(t.SafePriceCheckerMessages||(t.SafePriceCheckerMessages={})),function(e){e.TRACK="SAFE_PRICE_TRACK"}(t.InternalSafePriceCheckerMessages||(t.InternalSafePriceCheckerMessages={}))},17473:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SafePriceCheckerClient=t.SafePriceCheckerClientError=void 0;const i=n(26961),r=n(1106),o=n(55158);class a extends Error{constructor(e){super(e),this.name=a.name}}t.SafePriceCheckerClientError=a;t.SafePriceCheckerClient=class{constructor(e){this.config=e}async checkPrice(e){const t=this.endpoint("/ecommerce/verify"),n=await fetch(t,this.requestInit(e));return await n.json()}initBody(e){const t=JSON.stringify(e);return this.config.compression?i.compressToUTF16(t):t}requestInit(e){const t=this.initBody(e);return{method:"POST",cache:"no-cache",headers:(0,r.pipe)((0,o.contentTypeHeader)(this.config))({}),body:t}}endpoint(e){if(!this.config.safePriceCheck?.api)throw new a("ECommerceStream: Safe price checker is not initialized. Please provide the api url");return`${this.config.safePriceCheck?.api}${e}`}}},2381:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SafePriceCheckerManager=void 0;const i=n(20564);t.SafePriceCheckerManager=class{constructor(e,t,n,i){this.config=e,this.logger=t,this.observer=n,this.client=i}async checkPrice({data:e}){if(!this.config.safePriceCheck?.tracking)return;const t={clientDef:this.config.client,productsInCart:e};try{const e=await this.client.checkPrice(t);this.observer.emit(i.SafePriceCheckerMessages.SAFE_CHECK,e)}catch(e){this.logger.log("SafePriceCheckerManager: Error while checking price",e)}}}},44468:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncUpClient=void 0;const i=n(1106),r=n(26961),o=n(89737),a=n(13653);t.SyncUpClient=class{constructor(e){this.config=e}async getConfig(){const e=this.endpoint(),t=await fetch(e,{headers:(0,i.pipe)((0,o.acceptHeader)(this.config),(0,a.basicAuthorizationHeader)(this.config.syncUp.token))({})});return await this.parsedResponse(t)}async parsedResponse(e){if(this.config.compression){const t=await e.text();return JSON.parse(r.decompressFromUTF16(t))}return await e.json()}endpoint(){return`${this.config.syncUp.api}/ecommerce/template/config?${this.query()}`}query(){const e=new URLSearchParams;return e.set("libVersion",this.config.version.lib),e.set("partnerId",`${this.config.client.partnerId}`),e.toString()}}},93367:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SyncUpManager=void 0;const i=n(1106);t.SyncUpManager=class{constructor(e,t,n,r,o){this.logger=e,this.client=t,this.config=n,this.configManager=r,this.alarmManager=o,this.ALARM_NAME="E_COMMERCE_STREAM_SYNC_UP_ALARM";this.syncUp=(0,i.debounce)((async()=>{try{const e=await this.client.getConfig();if(!e)return this.logger.log("SyncUpManager: Config is empty");await this.configManager.upsertConfig(e)}catch(e){this.logger.log("SyncUpManager: Could not sync up configuration",e)}}))}setup(){this.setupAlarm(),this.config.syncUp.immediate&&this.syncUp(),this.alarmManager.addListener(this.ALARM_NAME,this.syncUp.bind(this))}setupAlarm(){this.alarmManager.create(this.ALARM_NAME,{delayInMinutes:this.config.syncUp.delayInMinutes,periodInMinutes:this.config.syncUp.delayInMinutes})}}},73975:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackClient=void 0;const i=n(26961),r=n(55158),o=n(1106);t.TrackClient=class{constructor(e){this.config=e}async track({templateVersion:e,...t}){if(!this.config.track.tracking)return;const n={version:{...this.config.version,template:e},clientDef:this.config.client,dataSharingEnabled:this.config.dataSharing??!1,...t},i=this.endpoint("/ecommerce/data");await fetch(i,this.requestInit(n))}initBody(e){const t=JSON.stringify(e);return this.config.compression?i.compressToUTF16(t):t}requestInit(e){const t=this.initBody(e);return{method:"POST",cache:"no-cache",headers:(0,o.pipe)((0,r.contentTypeHeader)(this.config))({}),body:t}}endpoint(e){return`${this.config.track.api}${e}`}}},7438:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigManager=void 0;t.ConfigManager=class{constructor(e,t,n){this.config=e,this.storage=t,this.logger=n}async setup(){const e=this.getActiveWatchers();await this.upsertConfig(e)}async upsertConfig(e){if(!await this.storage.has())return this.logger.log("ConfigManager: save initial config"),void await this.storage.save(e);await this.storage.save(e),this.replaceWatchers(e),this.logger.log("ConfigManager: config is updated")}getActiveWatchers(){return this.config.watchers}replaceWatchers(e){this.config.watchers=e}}},60514:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InBgMessageManager=void 0;const i=n(46444),r=n(42327),o=n(67159);t.InBgMessageManager=class{constructor(e,t,n,i,r){this.observer=e,this.out=t,this.config=n,this.logger=i,this.runtimeStorage=r,chrome.runtime.onMessage.addListener(this.bindListeners.bind(this))}onInit(e,t){const n=t.tab?.id;this.runtimeStorage.has(n)&&!t.frameId&&this.runtimeStorage.remove(n),this.prepareWatchers(e,t),this.prepareCoupons(e)}onTrack(e,t){this.logger.log(JSON.stringify(e,null,2));const n={tabId:t.tab?.id,payload:e.payload};e.customEvent||this.observer.emit(r.InternalMessageBgType.TRACK,n),this.observer.emit(e.payload.event,n)}onRuntimeStorageSave({payload:e},t){const n=t.tab?.id,{data:i,name:r}=e;this.runtimeStorage.append(n,r,i)}bindListeners(e,t){const n={[i.MessageContentType.ECOMMERCE_INIT]:this.onInit.bind(this),[i.MessageContentType.ECOMMERCE_TRACK]:this.onTrack.bind(this),[i.MessageContentType.ECOMMERCE_RUNTIME_STORAGE_SAVE]:this.onRuntimeStorageSave.bind(this)};n[e.type]?n[e.type](e,t):this.logger.log("Ignored message",e)}prepareCoupons({payload:e}){const{isIframe:t,...n}=e;t||this.observer.emit(o.InternalCouponMessages.TRACK,n)}prepareWatchers({payload:e,id:t},n){const{url:i}=e,r=n.tab?.id,o=this.config.watchers?.find?.(this.urlRegexPredicate(i));if(null==o)return;o.config.filter(this.urlRegexPredicate(i)).forEach((e=>{this.out.sendRequestMessage(r,e.config);const a=this.runtimeStorage.has(r)?this.runtimeStorage.get(r):{};this.out.sendInitMessage(r,e,a,o.version),n.frameId&&this.out.sendIframeLoadedMessage(r,t,i)}))}urlRegexPredicate(e){return({regex:t})=>new RegExp(t,"i").test(e)}}},6044:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutBgMessageManager=void 0;const i=n(42327);t.OutBgMessageManager=class{constructor(e){this.config=e}sendInitMessage(e,t,n,r){const o={type:i.MessageBgType.INIT,payload:{config:t.config,templateVersion:r,logging:this.config.logging,varScope:n}};this.sendMessage(e,o)}sendRequestMessage(e,t){const n={type:i.MessageBgType.REQUEST_HANDLE,payload:{config:t}};this.sendMessage(e,n)}sendIframeLoadedMessage(e,t,n){const r={type:i.MessageBgType.IFRAME_LOADED,payload:{url:n,id:t}};this.sendMessage(e,r)}sendMessage(e,t){chrome.tabs.sendMessage(e,t)}}},42327:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalMessageBgType=t.MessageBgType=void 0,function(e){e.INIT="INIT",e.REQUEST_HANDLE="REQUEST_HANDLE",e.IFRAME_LOADED="IFRAME_LOADED"}(t.MessageBgType||(t.MessageBgType={})),function(e){e.TRACK="ECOMMERCE_INTERNAL_TRACK"}(t.InternalMessageBgType||(t.InternalMessageBgType={}))},74182:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthStorage=void 0;t.AuthStorage=class{constructor(){this.storage=chrome.storage.local,this.STORAGE_KEYS={E_COMMERCE_SECURITY_TOKEN:"E_COMMERCE_SECURITY_TOKEN",E_COMMERCE_AVAILABLE_FEATURES:"E_COMMERCE_AVAILABLE_FEATURES"}}async getSecurityToken(){const e=await this.rawSecurityToken();return e?JSON.parse(e):null}async storeAuthData({features:e,...t}){await this.storeSecurityToken(t),await this.storeAvailableFeatures(e)}async checkAvailableFeature(e,t){const n=await this.rawAvailableFeatures();if(!n)return!1;const i=JSON.parse(n).find((({name:t})=>e===t));return null!=i&&i.details.some((e=>new RegExp(e,"i").test(t)))}async removeTokenEntities(){await this.storage.remove([this.STORAGE_KEYS.E_COMMERCE_SECURITY_TOKEN,this.STORAGE_KEYS.E_COMMERCE_AVAILABLE_FEATURES])}async storeAvailableFeatures(e){const t=JSON.stringify(e);await this.storage.set({[this.STORAGE_KEYS.E_COMMERCE_AVAILABLE_FEATURES]:t})}async storeSecurityToken(e){const t=JSON.stringify(e);await this.storage.set({[this.STORAGE_KEYS.E_COMMERCE_SECURITY_TOKEN]:t})}async rawSecurityToken(){const e=this.STORAGE_KEYS.E_COMMERCE_SECURITY_TOKEN;return await this.raw(e)}async rawAvailableFeatures(){const e=this.STORAGE_KEYS.E_COMMERCE_AVAILABLE_FEATURES;return await this.raw(e)}async raw(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e])}))}))}}},83763:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigStorage=void 0;t.ConfigStorage=class{constructor(e){this.key=e}async has(){return Boolean(await this.raw())}async save(e){return await chrome.storage.local.set({[this.key]:JSON.stringify(e)})}async get(){const e=await this.raw();return JSON.parse(e??"")}async raw(){return new Promise((e=>{chrome.storage.local.get(this.key,(t=>{e(t[this.key])}))}))}}},14343:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CouponStorage=void 0;t.CouponStorage=class{constructor(){this.storage=chrome.storage.local,this.keys={Domains:"E_COMMERCE_COUPON_DOMAINS",Coupon:"E_COMMERCE_COUPONS"}}async storeDomains(e){await this.storage.set({[this.keys.Domains]:JSON.stringify(e)})}async getDomains(){const e=await this.raw(this.keys.Domains);return e?JSON.parse(e):[]}async saveCoupons(e,t){const n=await this.raw(this.keys.Coupon),i={...n?JSON.parse(n):{},[t]:e};await this.storage.set({[this.keys.Coupon]:JSON.stringify(i)})}async getCoupons(e){const t=await this.raw(this.keys.Coupon);if(!t)return[];const n=JSON.parse(t)[e];return n||[]}async raw(e){return new Promise((t=>{chrome.storage.local.get(e,(n=>{t(n[e])}))}))}}},47090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeStorage=void 0;t.RuntimeStorage=class{constructor(e){this.logger=e,this.tabs={},chrome.tabs.onRemoved.addListener(this.onTabRemoved.bind(this))}has(e){const t=this.key(e);return Boolean(this.tabs[t])}create(e){this.logger.log(`Runtime storage: create ${e}`);const t=this.key(e);this.tabs[t]={}}remove(e){const t=this.key(e);delete this.tabs[t]}append(e,t,n){this.has(e)||this.create(e);const i=this.key(e);this.tabs[i][t]=n}get(e){const t=this.key(e);return this.tabs[t]}key(e){return`_${e}`}onTabRemoved(e){this.logger.log(`onTabRemoved: ${e}`),this.remove(e)}}},93794:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Migration_3_0_0=void 0;t.Migration_3_0_0=class{constructor(e,t,n){this.configStorage=e,this.syncUpManager=t,this.logger=n,this.key="E_COMMERCE_MIGRATION_3_0_0",this.storage=chrome.storage.local,this.handle()}async handle(){await this.migrationHandled()||(this.logger.log("Migration_3_0_0: started"),await this.configStorage.has()&&await this.syncUpManager.syncUp(),await this.confirmMigration())}async migrationHandled(){return new Promise((e=>{chrome.storage.local.get(this.key,(t=>{e(Boolean(t[this.key]))}))}))}async confirmMigration(){await this.storage.set({[this.key]:!0}),this.logger.log("Migration_3_0_0: finished")}}},11468:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;t.Logger=class{constructor(e){this.config=e}log(e,t){this.config.logging}}},1106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.DEFAULT_DEBOUNCE_TIME=t.pipe=t.uuid=t.isIframe=void 0,t.isIframe=function(){try{return window.self!==window.top}catch{return!0}},t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))};t.pipe=(...e)=>t=>e.reduce(((e,t)=>t(e)),t),t.DEFAULT_DEBOUNCE_TIME=150;t.debounce=(e,n=t.DEFAULT_DEBOUNCE_TIME)=>{let i=0;return(...t)=>{clearTimeout(i),i=setTimeout((()=>e(...t)),n)}}},11272:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observer=void 0;t.Observer=class{constructor(){this.listeners={}}emit(e,t){if(!this.listeners[e])return;this.listeners[e].forEach((e=>e(t)))}subscribe(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}}},46444:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageContentType=void 0,function(e){e.ECOMMERCE_INIT="ECOMMERCE_INIT",e.ECOMMERCE_TRACK="ECOMMERCE_TRACK",e.ECOMMERCE_RUNTIME_STORAGE_SAVE="ECOMMERCE_RUNTIME_STORAGE_SAVE"}(t.MessageContentType||(t.MessageContentType={}))},6583:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerModule=void 0;const i=n(18313),r=n(83379),o=n(35177),a=n(43118),s=n(10879);class c extends i.MarioModule{name(){return"AdBlockerModule"}static use(e,t){return e.registerModule(c,t)}register(e){this.mario().container().bind(r.AdBlockerTypes.AD_BLOCKER_OPTION_DATA_COLLECTION).toConstantValue(e.dataCollection),this.mario().registerService(r.AdBlockerTypes.AD_BLOCKER_SERVICE,o.AdBlockerService);const t=this.mario().getService(r.AdBlockerTypes.AD_BLOCKER_SERVICE);e.dataCollection?t.enableDataCollection():t.disableDataCollection(),e.subscribeOnProxyEvents&&(this.mario().internalDispatcher().on(a.ProxyActivated),this.mario().internalDispatcher().on(s.ProxyDeactivated))}}t.AdBlockerModule=c},35177:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerService=void 0;const s=n(86700),c=n(18313),u=n(11149),l=n(6008),d=n.g;let h=class{constructor(e,t){this.logger=e,this.tabService=t}updateConfig(){this.logger.log("AdBlocker: update config"),d.window.UpdatePanelOSConfig()}activateAdBlocker(){this.logger.log("AdBlocker: activate"),d.window.ActivatePanelOS()}deactivateAdBloker(){this.logger.log("AdBlocker: deactivate"),d.window.DeactivatePanelOS()}getAdBlockerStatus(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{d.window.GetAdBlockerStatus((t=>e(t)),(e=>t(e)))}))}))}isFacebookAdBlockerEnabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).FACEBOOK===l.AdStatus.ENABLED}))}isDisplayAdBlockerEnabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).DISPLAY===l.AdStatus.ENABLED}))}isTwitterAdBlockerEnabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).TWITTER===l.AdStatus.ENABLED}))}isFacebookAdBlockerDisabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).FACEBOOK===l.AdStatus.DISABLED}))}isDisplayAdBlockerDisabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).DISPLAY===l.AdStatus.DISABLED}))}isTwitterAdBlockerDisabled(){return a(this,void 0,void 0,(function*(){return(yield this.getAdBlockerStatus()).TWITTER===l.AdStatus.DISABLED}))}enableAdBlocker(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{d.window.EnableAdBlocker((e=>t(e)),(e=>n(e)),e)}))}))}disableAdBlocker(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{d.window.DisableAdBlocker((e=>t(e)),(e=>n(e)),e)}))}))}enableFacebookAdBlocker(){return a(this,void 0,void 0,(function*(){return this.enableAdBlocker([u.AdType.FACEBOOK])}))}enableDisplayAdBlocker(){return a(this,void 0,void 0,(function*(){return this.enableAdBlocker([u.AdType.DISPLAY,u.AdType.REDDIT])}))}enableTwitterAdBlocker(){return a(this,void 0,void 0,(function*(){return this.enableAdBlocker([u.AdType.TWITTER])}))}disableFacebookAdBlocker(){return a(this,void 0,void 0,(function*(){return this.disableAdBlocker([u.AdType.FACEBOOK])}))}disableDisplayAdBlocker(){return a(this,void 0,void 0,(function*(){return this.disableAdBlocker([u.AdType.DISPLAY,u.AdType.REDDIT])}))}disableTwitterAdBlocker(){return a(this,void 0,void 0,(function*(){return this.disableAdBlocker([u.AdType.TWITTER])}))}getAdBlockerCounters(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{d.window.GetAdBlockerCounters((e=>t(e)),(e=>n(e)),e)}))}))}getAdBlockerCountersForActiveTab(){return a(this,void 0,void 0,(function*(){const e=yield this.tabService.query({active:!0,currentWindow:!0});if(0===e.length)return{currentPageTotal:0,currentSessionTotal:0};const t=e[0];return this.getAdBlockerCounters(t.id)}))}enableDataCollection(){return this.logger.log("AdBlocker: enable data collection"),new Promise(((e,t)=>{d.window.EnableDataCollection((()=>e()),(e=>t(e)))}))}disableDataCollection(){return this.logger.log("AdBlocker: disable data collection"),new Promise(((e,t)=>{d.window.DisableDataCollection((()=>e()),(e=>t(e)))}))}isDataCollectionEnabled(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{d.window.GetDataCollectionStatus((t=>e(t)),(e=>t(e)))}))}))}getExcludeList(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{d.window.GetExcludeList((e=>t(e)),(e=>n(e)),e)}))}))}hasItemInExcludeList(e,t){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{d.window.HasItemInExcludeList((e=>n(e)),(e=>i(e)),e,t)}))}))}addIntoExcludeList(e,t){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{d.window.AddIntoExcludeList((()=>n()),(e=>i(e)),e,t)}))}))}removeFromExcludeList(e,t){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{d.window.RemoveFromExcludeList((()=>n()),(e=>i(e)),e,t)}))}))}addCurrentDomainIntoExcludeList(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{d.window.AddCurrentDomainIntoExcludeList((t=>e(t)),(e=>t(e)))}))}))}addCurrentPageIntoExcludeList(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{d.window.AddCurrentPageIntoExcludeList((t=>e(t)),(e=>t(e)))}))}))}};h=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,s.inject(c.MARIO_TYPES.TAB_SERVICE)),r("design:paramtypes",[Object,Object])],h),t.AdBlockerService=h},83379:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerTypes=void 0;const n={AD_BLOCKER_OPTION_DATA_COLLECTION:Symbol.for("AD_BLOCKER_OPTION_DATA_COLLECTION"),AD_BLOCKER_SERVICE:Symbol.for("AD_BLOCKER_SERVICE")};t.AdBlockerTypes=n},6008:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdStatus=void 0,function(e){e.ENABLED="enabled",e.DISABLED="disabled"}(t.AdStatus||(t.AdStatus={}))},11149:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdType=void 0,function(e){e.DISPLAY="DISPLAY",e.FACEBOOK="FACEBOOK",e.TWITTER="TWITTER",e.REDDIT="REDDIT"}(t.AdType||(t.AdType={}))},43118:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyActivated=void 0;const a=n(81732),s=n(86700),c=n(83379),u=n(35177);let l=class{constructor(e){this.service=e}on(){return a.ProxyEvents.PROXY_AFTER_CONNECT}handle(e){this.service.updateConfig()}};l=i([s.injectable(),o(0,s.inject(c.AdBlockerTypes.AD_BLOCKER_SERVICE)),r("design:paramtypes",[u.AdBlockerService])],l),t.ProxyActivated=l},10879:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyDeactivated=void 0;const a=n(81732),s=n(86700),c=n(83379),u=n(35177);let l=class{constructor(e){this.service=e}on(){return a.ProxyEvents.DIRECT_AFTER_CONNECT}handle(e){this.service.updateConfig()}};l=i([s.injectable(),o(0,s.inject(c.AdBlockerTypes.AD_BLOCKER_SERVICE)),r("design:paramtypes",[u.AdBlockerService])],l),t.ProxyDeactivated=l},25266:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BugsnagModule=void 0;const r=n(18313),o=n(529),a=n(6601);class s extends r.MarioModule{name(){return"BugsnagModule"}static use(e,t){return e.registerModule(s,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().logger().log(`BugsnagModule: Version ${e.appVersion}`),this.mario().logger().log(`BugsnagModule: ReleaseStage ${e.releaseStage}`),this.mario().registerService(a.BugsnagTypes.BUGSNAG_SERVICE,o.BugsnagService),this.mario().getService(a.BugsnagTypes.BUGSNAG_SERVICE).init(e)}))}}t.BugsnagModule=s},529:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BugsnagService=void 0;const a=n(64061),s=n(86700),c=n(18313);let u=class{constructor(e){this.logger=e,this.history="",this.enabled=!0}init(e={}){this.options=e,void 0!==e.enabled&&(this.enabled=e.enabled),this.client=a.default({apiKey:e.apiKey,appVersion:e.appVersion,beforeSend:e=>{e.stacktrace=e.stacktrace.map((e=>(e.file=e.file.replace(/(chrome-extension:|moz-extension:|edge-extension:)/g,"chrome_extension:"),e))),e.updateMetaData("background",{history:this.history}),this.enabled||e.ignore()},releaseStage:e.releaseStage}),this.logger.onLog(this.onLog.bind(this)),this.logger.onEvent(this.onEvent.bind(this)),this.logger.onWarn(this.onWarn.bind(this)),this.logger.onError(this.onError.bind(this)),this.logStatus()}enable(){this.enabled=!0,this.logStatus()}disable(){this.enabled=!1,this.logStatus()}notify(e){this.client.notify(e)}leaveBreadcrumb(e,t,n,i){this.client.leaveBreadcrumb(e,t,n,i)}updateUser(e){this.client.user=e}getClient(){return this.client}logStatus(){this.logger.log("BugsnagModule: "+(this.enabled?"Enabled":"Disabled"))}onLog(e,t,n){(!this.options.filterLog||this.options.filterLog(e,t))&&(this.addToHistory(n),this.leaveBreadcrumb(e,t))}onEvent(e,t,n){if(!this.options.filterEvents||this.options.filterEvents(t)){this.addToHistory(n);const i={param:JSON.stringify(t.data)};this.leaveBreadcrumb(e,i)}}onWarn(e,t,n){this.addToHistory(n),this.notify(e)}onError(e){this.notify(e)}addToHistory(e){this.history=`${e.trim()}\n${this.history}`;const t=48e4;this.history.length>t&&(this.history=this.history.substr(0,t))}};u=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object])],u),t.BugsnagService=u},6601:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BugsnagTypes=void 0;const n={BUGSNAG_CLIENT:Symbol.for("BUGSNAG_CLIENT"),BUGSNAG_SERVICE:Symbol.for("BUGSNAG_SERVICE")};t.BugsnagTypes=n},96233:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.CHROME_BROWSER="CHROME_BROWSER",e.FIREFOX_BROWSER="FIREFOX_BROWSER",e.EDGE_BROWSER="EDGE_BROWSER",e.SAFARI_BROWSER="SAFARI_BROWSER",e.OPERA_BROWSER="OPERA_BROWSER",e.CHROMIUM_BROWSER="CHROMIUM_BROWSER"}(t.BrowserEnum||(t.BrowserEnum={}))},89717:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.CoreException=n},50867:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(89717);class r extends i.CoreException{}t.CoreServiceIsNotRegisteredException=r},73266:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=(n(96233),n(98573));let c=class{constructor(e){this.browserEnum=e,this.isOnInstalledFired=!1,this.listeners=[],chrome.runtime.onInstalled.addListener((e=>{this.isOnInstalledFired=!0,this.installedDetails=e,this.handleOnInstall()}))}onInstall(e){this.listeners.push({callback:e}),this.isOnInstalledFired&&this.handleOnInstall()}setUninstallURL(e,t){chrome.runtime.setUninstallURL(e,t)}manifest(){return chrome.runtime.getManifest()}browser(){return this.browserEnum}handleOnInstall(){for(const e of this.listeners)e.callback(this.installedDetails);this.listeners=[]}};c=i([a.injectable(),o(0,a.inject(s.MARIO_TYPES.BROWSER)),r("design:paramtypes",[String])],c),t.Extension=c},99959:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(63442);t.MarioEvent=class{constructor(e,t,n){this.event=e,this.data=t,this.id=n||i.Guid.create().toString()}}},33528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MarioModule=class{constructor(e){this._core=e}mario(){return this._core}}},98573:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={ALARM_SERVICE:Symbol.for("ALARM_SERVICE"),BROWSER:Symbol.for("BROWSER"),BROWSER_ACTION:Symbol.for("BROWSER_ACTION"),CACHE_SERVICE:Symbol.for("CACHE_SERVICE"),CONTAINER:Symbol.for("CONTAINER"),INTERNAL_DISPATCHER:Symbol.for("INTERNAL_DISPATCHER"),LOCAL_STORAGE_SERVICE:Symbol.for("LOCAL_STORAGE_SERVICE"),LOGGER_SERVICE:Symbol.for("LOGGER_SERVICE"),STORAGE_SERVICE:Symbol.for("STORAGE_SERVICE"),TAB_SERVICE:Symbol.for("TAB_SERVICE"),NAVIGATION_SERVICE:Symbol.for("NAVIGATION_SERVICE"),WEB_REQUEST_SERVICE:Symbol.for("WEB_REQUEST_SERVICE"),PROXY_SERVICE:Symbol.for("PROXY_SERVICE"),EXTENSION_SERVICE:Symbol.for("EXTENSION_SERVICE"),EXTERNAL_DISPATCHER:Symbol.for("EXTERNAL_DISPATCHER"),OMNIBOX_SERVICE:Symbol.for("OMNIBOX_SERVICE"),WINDOW_POST:Symbol.for("WINDOW_POST"),MANAGEMENT:Symbol.for("MANAGEMENT"),PORT_DISPATCHER:Symbol.for("PORT_DISPATCHER")};t.MARIO_TYPES=n},17199:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),n(28660);const r=n(86700),o=n(43473),a=n(48643),s=n(2325),c=n(50867),u=n(73266),l=n(98573),d=n(4731),h=n(23961);t.Mario=class{constructor(e,t={}){this.isInitialized=!1,this._container=t.container?t.container:new r.Container,this._container.bind(l.MARIO_TYPES.BROWSER).toConstantValue(e),this._container.bind(l.MARIO_TYPES.CONTAINER).toConstantValue(this._container);const i=t.logger?t.logger:a.LoggerService,c=t.internalDispatcher?t.internalDispatcher:o.InternalDispatcher,f=t.externalDispatcher?t.externalDispatcher:d.ExternalDispatcher,p=t.tab?t.tab:s.TabService;this.registerService(l.MARIO_TYPES.LOGGER_SERVICE,i),this.logger().log(`Core: this build is for "${e.toString()}"`),this.registerService(l.MARIO_TYPES.EXTENSION_SERVICE,u.Extension),this.extension(),this.registerService(l.MARIO_TYPES.INTERNAL_DISPATCHER,c),this.registerService(l.MARIO_TYPES.EXTERNAL_DISPATCHER,f),this.registerService(l.MARIO_TYPES.PORT_DISPATCHER,h.PortDispatcher),this.registerService(l.MARIO_TYPES.TAB_SERVICE,p),this.getService(l.MARIO_TYPES.PORT_DISPATCHER);n.g.window.mario=this,this.coreInitialized()}registerModule(e,t){return i(this,void 0,void 0,(function*(){const n=new e(this);this.logger().log(`Core: registering a module "${n.name()}"`);try{yield n.register(t),this.logger().log(`Core: the module "${n.name()}" is registered`)}catch(e){this.logger().error(e)}}))}registerService(e,t){this.isCoreInitialized()&&this.logger().log(`Core: registered a service "${e.toString()}"`),this.hasService(e)||this._container.bind(e).to(t).inSingletonScope()}getService(e){if(!this.hasService(e)){const t=`Can't get service: service '${e.toString()}' is not registered`;throw this.isCoreInitialized()&&this.logger().warn(t),new c.CoreServiceIsNotRegisteredException(t)}return this._container.get(e)}hasService(e){return this._container.isBound(e)}internalDispatcher(){return this.getService(l.MARIO_TYPES.INTERNAL_DISPATCHER)}externalDispatcher(){return this.getService(l.MARIO_TYPES.EXTERNAL_DISPATCHER)}portDispatcher(){return this.getService(l.MARIO_TYPES.PORT_DISPATCHER)}logger(){return this.getService(l.MARIO_TYPES.LOGGER_SERVICE)}container(){return this._container}tabService(){return this.getService(l.MARIO_TYPES.TAB_SERVICE)}extension(){return this.getService(l.MARIO_TYPES.EXTENSION_SERVICE)}coreInitialized(){this.isInitialized=!0}isCoreInitialized(){return this.isInitialized}}},14874:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ALARM_ELAPSED="ALARM_ELAPSED"}(t.AlarmEvents||(t.AlarmEvents={}))},65215:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(18313),l=n(14874);let d=class{constructor(e,t){this.logger=e,this.internalDispatcher=t,chrome.alarms.onAlarm.addListener((e=>{const t=new u.MarioEvent(l.AlarmEvents.ALARM_ELAPSED,e);this.internalDispatcher.emit(t).then()}))}create(e,t){try{this.logger.log(`AlarmService: create an alarm "${t}"`),chrome.alarms.create(t,e)}catch(e){throw this.logger.warn(`AlarmService: could not create an alarm with name "${t}"`),e}}get(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.alarms.get(e,(e=>t(e)))}catch(t){this.logger.warn(`AlarmService: could get an alarm with name "${e}"`),n(t)}}))}))}getAll(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{try{chrome.alarms.getAll((t=>e(t)))}catch(e){this.logger.warn("AlarmService: could get all alarms"),t(e)}}))}))}clear(e){return a(this,void 0,void 0,(function*(){return this.logger.log(`AlarmService: clear an alarm "${e}"`),new Promise(((t,n)=>{try{chrome.alarms.clear(e,(e=>t(e)))}catch(t){this.logger.warn(`AlarmService: could clear an alarm with name "${e}"`),n(t)}}))}))}clearAll(){return a(this,void 0,void 0,(function*(){return this.logger.log(`AlarmService: clear all alarms "${name}"`),new Promise(((e,t)=>{try{chrome.alarms.clearAll((t=>e(t)))}catch(e){this.logger.warn("AlarmService: could clear all alarms"),t(e)}}))}))}};d=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.AlarmService=d},51370:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BROWSER_ACTION_CLICKED="BROWSER_ACTION_CLICKED"}(t.BrowserActionEvents||(t.BrowserActionEvents={}))},99399:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(18313),l=n(51370);let d=class{constructor(e,t){this.logger=e,this.internalDispatcher=t,chrome.browserAction.onClicked.addListener((e=>{const t=new u.MarioEvent(l.BrowserActionEvents.BROWSER_ACTION_CLICKED,e);this.internalDispatcher.emit(t).then()}))}setTitle(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.setTitle(e,(()=>t()))}catch(e){n(e)}}))}))}getTitle(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.getTitle(e,(()=>t()))}catch(e){n(e)}}))}))}setIcon(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.setIcon(e,(()=>t()))}catch(e){n(e)}}))}))}setPopup(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.setPopup(e,(()=>t()))}catch(e){n(e)}}))}))}getPopup(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.getPopup(e,(()=>t()))}catch(e){n(e)}}))}))}setBadgeText(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.setBadgeText(e,(()=>t()))}catch(e){n(e)}}))}))}getBadgeText(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.getBadgeText(e,(()=>t()))}catch(e){n(e)}}))}))}setBadgeBackgroundColor(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.setBadgeBackgroundColor(e,(()=>t()))}catch(e){n(e)}}))}))}getBadgeBackgroundColor(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.getBadgeBackgroundColor(e,(e=>t(e)))}catch(e){n(e)}}))}))}enable(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.enable(e,(()=>t()))}catch(e){n(e)}}))}))}disable(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.browserAction.disable(e,(()=>t()))}catch(e){n(e)}}))}))}};d=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.BrowserActionService=d},80187:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BEFORE_CLEAR_CACHE="BEFORE_CLEAR_CACHE",e.AFTER_CLEAR_CACHE="AFTER_CLEAR_CACHE"}(t.CacheEvents||(t.CacheEvents={}))},22344:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(99959),u=n(98573),l=n(80187);let d=class{constructor(e,t){this.logger=e,this.dispatcher=t}clear(){return a(this,void 0,void 0,(function*(){yield this.dispatcher.emit(new c.MarioEvent(l.CacheEvents.BEFORE_CLEAR_CACHE)),yield this.cacheRemoveAll(),yield this.dispatcher.emit(new c.MarioEvent(l.CacheEvents.AFTER_CLEAR_CACHE))}))}cacheRemoveAll(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{try{chrome.browsingData.removeCache({},(()=>{e()}))}catch(e){this.logger.error(e),t()}}))}))}};d.EVENT_BEFORE_CLEAR_CACHE="beforeClearCache",d.EVENT_AFTER_CLEAR_CACHE="afterClearCache",d=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.LOGGER_SERVICE)),o(1,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.CacheService=d},27932:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContentDispatcherService=class{constructor(){this.listeners={},this.listenersIndex={},this.counter=0,chrome.runtime.onMessage.addListener((e=>{if(!this.isEventMessage(e))return;if(!this.hasEventListeners(e.event))return;const t=[],n=this.listeners[e.event];for(const i of Object.keys(n)){const r=(0,n[i])(e);t.push(r)}return Promise.all(t).then(),!1}))}emit(e,t){chrome.runtime.sendMessage(e,t)}on(e,t){const n=++this.counter;return this.hasEventListeners(e)||(this.listeners[e]={}),this.listeners[e][n]=t,this.listenersIndex[n]=e,n}hasEventListeners(e){return void 0!==this.listeners[e]}removeListener(e){if(this.hasListener(e)){const t=this.listenersIndex[e];delete this.listeners[t][e],delete this.listenersIndex[e]}}hasListener(e){return this.listenersIndex.hasOwnProperty(e)}getListener(e){if(!this.hasListener(e))throw new Error("boom");const t=this.listenersIndex[e];return this.listeners[t][e]}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}}},81256:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.ExternalDispatcherException=n},39205:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(81256);class r extends i.ExternalDispatcherException{}t.ExternalDispatcherListenerIsNotFoundException=r},4731:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=n(98573),c=n(99681),u=n(39205);let l=class{constructor(e,t,n){this.container=e,this.loggerService=t,this.tabService=n,this.listeners={},this.listenersIndex={},this.counter=0,this.beforeEmitListeners=[],chrome.runtime.onMessage.addListener(((e,t,n)=>{if(this.internalEmit(c.ExternalDispatcherEvents.ON_ANY_MESSAGE,e,t,n),this.isEventMessage(e)){const i=e.event;this.loggerService.event("ExternalDispatcher: got",e),this.internalEmit(i,e,t,n)}return!0}))}emit(e,t){this.loggerService.event("ExternalDispatcher: emit",t);try{this.beforeEmitListeners.forEach((n=>n(e,t)))}catch(e){this.loggerService.error(e)}this.tabService.sendMessage(e,t)}on(e){const t=this.bind(e);return this.loggerService.log(`ExternalDispatcher: register an event listener "${t.on()}"`),this.addEventListener(t.on(),t)}onBeforeEmit(e){this.beforeEmitListeners.push(e)}removeListener(e){if(!this.hasListeners(e))throw new u.ExternalDispatcherListenerIsNotFoundException(`Listener with id "${e}" is not found`);this.loggerService.log(`ExternalDispatcher: remove an event listener "${e}"`);const t=this.listenersIndex[e];delete this.listeners[t][e],delete this.listenersIndex[e]}getListener(e){if(!this.hasListeners(e))throw new u.ExternalDispatcherListenerIsNotFoundException(`Listener with id "${e}" is not found`);const t=this.listenersIndex[e];return this.listeners[t][e]}hasListeners(e){return void 0!==this.listenersIndex[e]}getEventListeners(e){return this.hasEventListeners(e)?this.listeners[e]:[]}hasEventListeners(e){return void 0!==this.listeners[e]}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}internalEmit(e,t,n,i){if(!this.hasEventListeners(e))return;const r=[],o=this.listeners[e];for(const e of Object.keys(o)){const a=o[e],s=a.handle.apply(a,[t,n,i]);r.push(s)}Promise.all(r).then()}addEventListener(e,t){void 0===this.listeners[e]&&(this.listeners[e]={});const n=++this.counter;return this.listeners[e][n]=t,this.listenersIndex[n]=e,n}bind(e){return this.container.bind(e).toSelf().inSingletonScope(),this.container.get(e)}};l=i([a.injectable(),o(0,a.inject(s.MARIO_TYPES.CONTAINER)),o(1,a.inject(s.MARIO_TYPES.LOGGER_SERVICE)),o(2,a.inject(s.MARIO_TYPES.TAB_SERVICE)),r("design:paramtypes",[Object,Object,Object])],l),t.ExternalDispatcher=l},99681:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ON_ANY_MESSAGE="ON_ANY_MESSAGE"}(t.ExternalDispatcherEvents||(t.ExternalDispatcherEvents={}))},25721:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.InternalDispatcherException=n},52290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(25721);class r extends i.InternalDispatcherException{}t.InternalDispatcherListenerIsNotRegisteredException=r},43473:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(52290);let l=class{constructor(e,t){this.container=e,this.loggerService=t,this.counter=0,this.listeners={},this.listenersIndex={},this.onBeforeEmitListeners=[]}emit(e){return a(this,void 0,void 0,(function*(){this.loggerService.event("InternalDispatcher",e);try{this.onBeforeEmitListeners.forEach((t=>t(e)))}catch(e){this.loggerService.error(e)}const t=this.getEventListeners(e.event),n=[];for(const i in t){const r=t[i],o=r.handle.apply(r,[e]);n.push(o)}yield Promise.all(n)}))}on(e){this.container.bind(e).toSelf().inSingletonScope();const t=this.container.get(e),n=t.on();this.loggerService.log(`InternalDispatcher: register a listener on event "${n}"`),void 0===this.listeners[n]&&(this.listeners[n]=[]);const i=++this.counter;return this.listenersIndex[i]=n,this.listeners[n][i]=t,i}onBeforeEmit(e){this.onBeforeEmitListeners.push(e)}hasEventListeners(e){return this.listeners.hasOwnProperty(e)&&this.listeners[e].length>0}getEventListeners(e){if(this.hasEventListeners(e)){return this.listeners[e].filter((e=>!!e.handle))}return[]}getListener(e){if(!this.hasListener(e))throw new u.InternalDispatcherListenerIsNotRegisteredException(`a listener with id "${e}" is not registered`);const t=this.listenersIndex[e];return this.listeners[t][e]}removeListener(e){if(!this.hasListener(e))throw new u.InternalDispatcherListenerIsNotRegisteredException(`a listener with id "${e}" is not registered`);const t=this.listenersIndex[e];delete this.listenersIndex[e],delete this.listeners[t][e]}hasListener(e){return this.listenersIndex.hasOwnProperty(e)}};l=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.CONTAINER)),o(1,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object,Object])],l),t.InternalDispatcher=l},48643:function(e,t,n){"use strict";var i,r=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});const o=n(86700),a=n(64530);let s=i=class{constructor(){this.onLogListeners=[],this.onEventListeners=[],this.onErrorListeners=[],this.onWarnListeners=[],this.onFilterLogListeners=[],this.enabled=!0}log(e,t){const n=this.time();n[0]+=`%c[INFO] %c${e}`,n.push(this.color(i.LIGHT_BLUE_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR));let r="";void 0!==t&&(r=a(t,null,2));const o=this.prepareOutput(n[0],r);!this.filterInfo(o)&&(this.enabled,this.enabled),this.handleOnLogListeners(e,t,o)}event(e,t){const n=this.time();n[0]+=`%c[EVENT ${t.event}] %c${e}`,n.push(this.color(i.LIGHT_GREEN_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR)),this.enabled;const r=a(t.data,null,2);this.enabled,this.handleOnEventListeners(e,t,this.prepareOutput(n[0],r))}warn(e,t){const n=this.time();n[0]+=`%c[WARN] %c${e}`,n.push(this.color(i.RED_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR)),this.enabled;let r="";this.enabled&&void 0!==t&&(r=a(t,null,2)),this.handleOnWarnListeners(e,t,this.prepareOutput(n[0],r))}error(e){const t=this.time();t[0]+=`%c[ERROR] %c${e.message}`,t.push(this.color(i.RED_COLOR)+this.fontWeight(600)),t.push(this.color(i.BLACK_COLOR)),this.enabled&&e.stack,this.handleOnErrorListeners(e)}onLog(e){this.onLogListeners.push(e)}onEvent(e){this.onEventListeners.push(e)}onWarn(e){this.onWarnListeners.push(e)}onError(e){this.onErrorListeners.push(e)}onFilterLog(e){this.onFilterLogListeners.push(e)}disable(){this.enabled=!1}enable(){this.enabled=!0}handleOnLogListeners(e,t,n){for(const i of this.onLogListeners)i(e,t,n)}handleOnWarnListeners(e,t,n){for(const i of this.onWarnListeners)i(e,t,n)}handleOnEventListeners(e,t,n){for(const i of this.onEventListeners)i(e,t,n)}handleOnErrorListeners(e,t){for(const n of this.onErrorListeners)n(e,t)}filterInfo(e){for(const t of this.onFilterLogListeners){if(t(e))return!0}return!1}time(){const e=new Date;let t="%c[";return t+=`tz:${e.getTimezoneOffset()} `,t+=`${this.pad(e.getDate().toString(),2)}/`,t+=`${this.pad(e.getMonth().toString(),2)}/`,t+=`${e.getFullYear()} `,t+=`${this.pad(e.getHours().toString(),2)}:`,t+=`${this.pad(e.getMinutes().toString(),2)}:`,t+=`${this.pad(e.getSeconds().toString(),2)} `,t+=`${this.pad(e.getMilliseconds().toString(),4)}`,t+="]%c ",[t,this.fontWeight(600),this.color(i.BLACK_COLOR)]}color(e){return`color: ${e};`}fontWeight(e){return`font-weight: ${e};`}pad(e,t,n){const i=n||"0";return e.length>=t?e:new Array(t-e.length+1).join(i)+e}prepareOutput(e,t){return`${e.replace(/%c/g,"")}\n${t}`}};s.BLACK_COLOR="#000",s.RED_COLOR="#f40f3f",s.LIGHT_GREEN_COLOR="#1e9f3e",s.LIGHT_BLUE_COLOR="#4285f4",s=i=r([o.injectable()],s),t.LoggerService=s},25349:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.INSTALL="MANAGEMENT_ON_INSTALL",e.UNINSTALL="MANAGEMENT_ON_UNINSTALL",e.ENABLED="MANAGEMENT_ON_ENABLED",e.DISABLED="MANAGEMENT_ON_DISABLED"}(t.ManagementEvents||(t.ManagementEvents={}))},57873:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=n(98573),c=n(96233),u=n(86254),l=n(81504);let d=class{constructor(e,t){this.browser=e,this.container=t;const n={};n[c.BrowserEnum.CHROME_BROWSER]=u.ManagementChromeService,n[c.BrowserEnum.FIREFOX_BROWSER]=l.ManagementFirefoxService;const i=n.hasOwnProperty(this.browser)?e:c.BrowserEnum.CHROME_BROWSER,r="temp_name",o=n[i];this.container.bind(r).to(o).inSingletonScope(),this.service=this.container.get(r),this.container.unbind(r)}get(e){return this.service.get(e)}getAll(){return this.service.getAll()}setEnabled(e,t){return this.service.setEnabled(e,t)}};d=i([a.injectable(),o(0,a.inject(s.MARIO_TYPES.BROWSER)),o(1,a.inject(s.MARIO_TYPES.CONTAINER)),r("design:paramtypes",[String,Object])],d),t.ManagementService=d},86254:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=n(98573),c=n(25349),u=n(18313);let l=class{constructor(e){this.internalDispatcher=e,chrome.management.onInstalled.addListener((e=>{const t=new u.MarioEvent(c.ManagementEvents.INSTALL,e);this.internalDispatcher.emit(t).then()})),chrome.management.onUninstalled.addListener((e=>{const t=new u.MarioEvent(c.ManagementEvents.UNINSTALL,e);this.internalDispatcher.emit(t).then()})),chrome.management.onEnabled.addListener((e=>{const t=new u.MarioEvent(c.ManagementEvents.ENABLED,e);this.internalDispatcher.emit(t).then()})),chrome.management.onDisabled.addListener((e=>{const t=new u.MarioEvent(c.ManagementEvents.DISABLED,e);this.internalDispatcher.emit(t).then()}))}get(e){return new Promise(((t,n)=>{try{chrome.management.get(e,(e=>t(e)))}catch(e){n(e)}}))}getAll(){return new Promise(((e,t)=>{try{chrome.management.getAll((t=>e(t)))}catch(e){t(e)}}))}setEnabled(e,t){return new Promise(((n,i)=>{try{chrome.management.setEnabled(e,t,(()=>n()))}catch(e){i(e)}}))}};l=i([a.injectable(),o(0,a.inject(s.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],l),t.ManagementChromeService=l},81504:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(18313),l=n(25349);let d=class{constructor(e){this.internalDispatcher=e,browser.management.onInstalled.addListener((e=>{const t=new u.MarioEvent(l.ManagementEvents.INSTALL,e);this.internalDispatcher.emit(t).then()})),browser.management.onUninstalled.addListener((e=>{const t=new u.MarioEvent(l.ManagementEvents.UNINSTALL,e);this.internalDispatcher.emit(t).then()})),browser.management.onDisabled.addListener((e=>{const t=new u.MarioEvent(l.ManagementEvents.DISABLED,e);this.internalDispatcher.emit(t).then()})),browser.management.onEnabled.addListener((e=>{const t=new u.MarioEvent(l.ManagementEvents.ENABLED,e);this.internalDispatcher.emit(t).then()}))}get(e){return a(this,void 0,void 0,(function*(){return yield browser.management.get(e)}))}getAll(){return a(this,void 0,void 0,(function*(){return yield browser.management.getAll()}))}setEnabled(e,t){return a(this,void 0,void 0,(function*(){return browser.management.setEnabled(e,t)}))}};d=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.ManagementFirefoxService=d},37302:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(18313),u=n(98573),l=n(30818);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnBeforeNavigate=!1,this.isListenOnCommitted=!1,this.isListenOnDOMContentLoaded=!1,this.isListenOnCompleted=!1,this.isListenOnErrorOccurred=!1,this.isListenOnCreatedNavigationTarget=!1,this.isListenOnReferenceFragmentUpdated=!1,this.isListenOnTabReplaced=!1,this.isListenOnHistoryStateUpdated=!1}listenOnBeforeNavigate(){this.isListenOnBeforeNavigate||(this.isListenOnBeforeNavigate=!0,chrome.webNavigation.onBeforeNavigate.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_BEFORE_NAVIGATE,{details:e});this.dispatcherService.emit(t).then()})))}listenOnCommitted(){this.isListenOnCommitted||(this.isListenOnCommitted=!0,chrome.webNavigation.onCommitted.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_COMMITTED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnDOMContentLoaded(){this.isListenOnDOMContentLoaded||(this.isListenOnDOMContentLoaded=!0,chrome.webNavigation.onDOMContentLoaded.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_DOM_CONTENT_LOADED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnCompleted(){this.isListenOnCompleted||(this.isListenOnCompleted=!0,chrome.webNavigation.onCompleted.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_COMPLETED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnErrorOccurred(){this.isListenOnErrorOccurred||(this.isListenOnErrorOccurred=!0,chrome.webNavigation.onErrorOccurred.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_ERROR_OCCURRED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnCreatedNavigationTarget(){this.isListenOnCreatedNavigationTarget||(this.isListenOnCreatedNavigationTarget=!0,chrome.webNavigation.onCreatedNavigationTarget.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_CREATED_NAVIGATION_TARGET,{details:e});this.dispatcherService.emit(t).then()})))}listenOnReferenceFragmentUpdated(){this.isListenOnReferenceFragmentUpdated||(this.isListenOnReferenceFragmentUpdated=!0,chrome.webNavigation.onReferenceFragmentUpdated.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnTabReplaced(){this.isListenOnTabReplaced||(this.isListenOnTabReplaced=!0,chrome.webNavigation.onTabReplaced.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_TAB_REPLACED,{details:e});this.dispatcherService.emit(t).then()})))}listenOnHistoryStateUpdated(){this.isListenOnHistoryStateUpdated||(this.isListenOnHistoryStateUpdated=!0,chrome.webNavigation.onHistoryStateUpdated.addListener((e=>{const t=new c.MarioEvent(l.NavigationServiceEvents.NAVIGATION_ON_HISTORY_STATE_UPDATED,{details:e});this.dispatcherService.emit(t).then()})))}getFrame(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.webNavigation.getFrame(e,(e=>t(e)))}catch(e){n(e)}}))}))}getAllFrames(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.webNavigation.getAllFrames(e,(e=>t(e)))}catch(e){n(e)}}))}))}};d=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.NavigationService=d},30818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NAVIGATION_ON_BEFORE_NAVIGATE="NAVIGATION_ON_BEFORE_NAVIGATE",e.NAVIGATION_ON_COMMITTED="NAVIGATION_ON_COMMITTED",e.NAVIGATION_ON_DOM_CONTENT_LOADED="NAVIGATION_ON_DOM_CONTENT_LOADED",e.NAVIGATION_ON_COMPLETED="NAVIGATION_ON_COMPLETED",e.NAVIGATION_ON_ERROR_OCCURRED="NAVIGATION_ON_ERROR_OCCURRED",e.NAVIGATION_ON_CREATED_NAVIGATION_TARGET="NAVIGATION_ON_CREATED_NAVIGATION_TARGET",e.NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED="NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED",e.NAVIGATION_ON_TAB_REPLACED="NAVIGATION_ON_TAB_REMOVED",e.NAVIGATION_ON_HISTORY_STATE_UPDATED="NAVIGATION_ON_HISTORY_STATE_UPDATED"}(t.NavigationServiceEvents||(t.NavigationServiceEvents={}))},23961:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=n(18313),c=n(98573),u=n(95632);let l=class{constructor(e,t,n){this.container=e,this.logger=t,this.dispatcher=n,this.ports={},this.listeners={},this.onBeforeEmitListeners=[],chrome.runtime.onConnect.addListener((e=>{this.ports[e.name]=e,this.logger.log(`Port "${e.name}" is created`),e.onMessage.addListener((t=>{if(t.port=e.name,this.internalEmit(u.PortDispatcherEvents.ON_ANY_MESSAGE,t),this.isEventMessage(t)){const e=t.event;this.internalEmit(e,t)}})),e.onDisconnect.addListener((()=>{this.logger.log(`Port "${e.name}" is disconnected`),delete this.ports[e.name];const t=new s.MarioEvent(u.PortDispatcherEvents.PORT_DISCONNECTED,{name:e.name});this.dispatcher.emit(t).then()}));const t=new s.MarioEvent(u.PortDispatcherEvents.PORT_CONNECTED,{name:e.name});this.dispatcher.emit(t).then()}))}on(e){this.container.bind(e).toSelf().inSingletonScope();const t=this.container.get(e),n=t.on();void 0===this.listeners[n]&&(this.listeners[n]=[]),this.listeners[n].push(t),this.logger.log(`PortDispatcher: register a listener on event "${n}"`)}onBeforeEmit(e){this.onBeforeEmitListeners.push(e)}emit(e,t,n){let i=[];if(t){const e=t;if(this.hasNotPort(e))throw Error(`PortDispatcher: a named port "${e}" is not found`);const n=this.getPort(e);i.push(n)}else i=Object.keys(this.ports).map((e=>this.ports[e]));!n&&this.onBeforeEmitListeners.forEach((t=>{try{t(e)}catch(e){this.logger.error(e)}})),i.forEach((t=>t.postMessage(e)))}hasPort(e){return!!this.ports[e]}hasNotPort(e){return!this.hasPort(e)}disconnectPort(e){this.hasNotPort(e)&&this.logger.log(`Port "${e}" cannot be disconnected because it's not registered`);this.ports[e].disconnect()}hasEventListeners(e){return this.listeners[e]&&this.listeners[e].length>0}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}getPort(e){return this.ports[e]}internalEmit(e,t){this.hasEventListeners(e)&&this.listeners[e].forEach((e=>{try{e.handle(t).then()}catch(e){this.logger.error(e)}}))}};l=i([a.injectable(),o(0,a.inject(c.MARIO_TYPES.CONTAINER)),o(1,a.inject(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,a.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object,Object])],l),t.PortDispatcher=l},95632:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PORT_CONNECTED="PORT_CONNECTED",e.PORT_DISCONNECTED="PORT_DISCONNECTED",e.ON_ANY_MESSAGE="ON_ANY_MESSAGE"}(t.PortDispatcherEvents||(t.PortDispatcherEvents={}))},81732:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PROXY_ERROR="PROXY_ERROR",e.PROXY_BEFORE_CONNECT="PROXY_BEFORE_CONNECT",e.PROXY_AFTER_CONNECT="PROXY_AFTER_CONNECT",e.DIRECT_BEFORE_CONNECT="DIRECT_BEFORE_CONNECT",e.DIRECT_AFTER_CONNECT="DIRECT_AFTER_CONNECT"}(t.ProxyEvents||(t.ProxyEvents={}))},34199:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(96233),u=n(98573),l=n(31200),d=n(58488),h=n(18313),f=n(81732);let p=class{constructor(e,t,n,i){this.browser=e,this.container=t,this.logger=n,this.internalDispatcher=i;const r={};r[c.BrowserEnum.CHROME_BROWSER]=l.ProxyServiceChrome,r[c.BrowserEnum.FIREFOX_BROWSER]=d.ProxyServiceFirefox;const o=r.hasOwnProperty(this.browser)?e:c.BrowserEnum.CHROME_BROWSER,a="INTERNAL_PROXY_SERVICE";this.container.bind(a).to(r[o]).inSingletonScope(),this.proxyService=this.container.get(a),this.container.unbind(a)}hasCurrent(){return this.proxyService.hasCurrent()}current(){return this.proxyService.current()}connect(e,t,n=!0){return a(this,void 0,void 0,(function*(){if(n){const n=new h.MarioEvent(f.ProxyEvents.PROXY_BEFORE_CONNECT,{proxyServer:e,bypassList:t});yield this.internalDispatcher.emit(n)}if(this.logger.log("ProxyService: connect to a proxy",{proxyServer:e,bypassList:t}),yield this.proxyService.connect(e,t,n),n){const n=new h.MarioEvent(f.ProxyEvents.PROXY_AFTER_CONNECT,{proxyServer:e,bypassList:t});yield this.internalDispatcher.emit(n)}}))}direct(e=!0){return a(this,void 0,void 0,(function*(){if(e){const e=new h.MarioEvent(f.ProxyEvents.DIRECT_BEFORE_CONNECT);yield this.internalDispatcher.emit(e)}if(this.logger.log("ProxyService: use direct mode"),yield this.proxyService.direct(),e){const e=new h.MarioEvent(f.ProxyEvents.DIRECT_AFTER_CONNECT);yield this.internalDispatcher.emit(e)}}))}onAuthRequired(e,t={urls:["<all_urls>"]},n=["blocking"],i=!1){return this.proxyService.onAuthRequired(e,t,n,i)}removeAuthRequiredListener(){return this.proxyService.removeAuthRequiredListener()}};p=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.BROWSER)),o(1,s.inject(u.MARIO_TYPES.CONTAINER)),o(2,s.inject(u.MARIO_TYPES.LOGGER_SERVICE)),o(3,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[String,Object,Object,Object])],p),t.ProxyService=p},31200:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(86700),s=n(98573),c=n(18313),u=n(81732);let l=class{constructor(e){this.internalDispatcher=e,chrome.proxy.onProxyError.addListener((e=>{this.internalDispatcher.emit(new c.MarioEvent(u.ProxyEvents.PROXY_ERROR,e)).then()}))}current(){return this._current}hasCurrent(){return Boolean(this._current)}connect(e,t){const n={mode:"fixed_servers",rules:{bypassList:t,singleProxy:e}};return new Promise(((t,i)=>{try{chrome.proxy.settings.set({value:n,scope:"regular"},(()=>{this._current=e,t()}))}catch(e){i(e)}}))}direct(){return new Promise(((e,t)=>{const n={mode:"direct"};try{chrome.proxy.settings.set({value:n,scope:"regular"},(()=>{this._current=null,e()}))}catch(e){t(e)}}))}onAuthRequired(e,t={urls:["<all_urls>"]},n=["blocking"],i=!1){this.onAuthRequiredListener=t=>{if(t.isProxy)return i&&this.hasCurrent()&&t.challenger&&(this._current.host!==t.challenger.host||this._current.port!==t.challenger.port)?{cancel:!0}:{authCredentials:e()}},chrome.webRequest.onAuthRequired.addListener(this.onAuthRequiredListener,t,n)}removeAuthRequiredListener(){this.onAuthRequiredListener&&chrome.webRequest.onAuthRequired.removeListener(this.onAuthRequiredListener)}};l=i([a.injectable(),o(0,a.inject(s.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],l),t.ProxyServiceChrome=l},58488:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(18313),l=n(81732);let d=class{constructor(e){this.internalDispatcher=e,this._current=null,this.userProxy=!1,browser.proxy.onError.addListener((e=>{this.internalDispatcher.emit(new u.MarioEvent(l.ProxyEvents.PROXY_ERROR,e)).then()}))}current(){return this._current}hasCurrent(){return Boolean(this._current)}connect(e,t){return a(this,void 0,void 0,(function*(){if(this.userProxy=!0,this._current=e,!this.listener)return this.listener=e=>{if(!this.userProxy)return{type:"direct"};const n=new URL(e.url);return-1!==t.indexOf(n.hostname)?{type:"direct"}:{type:this._current.scheme,host:this._current.host,port:this._current.port}},new Promise(((e,t)=>{try{browser.proxy.onRequest.addListener(this.listener,{urls:["<all_urls>"]}),e()}catch(e){t(e)}}))}))}direct(){return a(this,void 0,void 0,(function*(){this.userProxy=!1,this._current=null}))}onAuthRequired(e,t={urls:["<all_urls>"]},n=["blocking"],i=!1){this.onAuthRequiredListener=t=>{if(t.isProxy)return i&&this.hasCurrent()&&t.proxyInfo&&(this._current.host!==t.proxyInfo.host||this._current.port!==t.proxyInfo.port)?{cancel:!0}:{authCredentials:e()}},browser.webRequest.onAuthRequired.addListener(this.onAuthRequiredListener,t,n)}removeAuthRequiredListener(){this.onAuthRequiredListener&&browser.webRequest.onAuthRequired.removeListener(this.onAuthRequiredListener)}};d=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.ProxyServiceFirefox=d},9297:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(86700);let a=class{get(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.storage.local.get(e,(n=>{const i=void 0!==n[e]?n[e]:null;t(i)}))}))}))}set(e,t){return r(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{const r={};r[e]=t,chrome.storage.local.set(r,(()=>n()))}))}))}has(e){return r(this,void 0,void 0,(function*(){return null!==(yield this.get(e))}))}remove(e){return r(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.storage.local.remove(e,(()=>t()))}catch(e){n(e)}}))}))}clean(){chrome.storage.local.clear()}};a=i([o.injectable()],a),t.StorageService=a},2325:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(18313),u=n(98573),l=n(54674);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnCreated=!1,this.isListenOnUpdated=!1,this.isListenOnMoved=!1,this.isListenOnActivated=!1,this.isListenOnHighlighted=!1,this.isListenOnDetached=!1,this.isListenOnAttached=!1,this.isListenOnRemoved=!1,this.isListenOnReplaced=!1,this.isListenOnZoomChange=!1}listenOnCreated(){this.isListenOnCreated||(this.isListenOnCreated=!0,chrome.tabs.onCreated.addListener((e=>{const t=new c.MarioEvent(l.TabServiceEvents.ON_TAB_CREATED,{tab:e});this.dispatcherService.emit(t).then()})))}listenOnUpdated(){this.isListenOnUpdated||(this.isListenOnUpdated=!0,chrome.tabs.onUpdated.addListener(((e,t,n)=>{const i=new c.MarioEvent(l.TabServiceEvents.ON_TAB_UPDATED,{tabId:e,changeInfo:t,tab:n});this.dispatcherService.emit(i).then()})))}listenOnMoved(){this.isListenOnMoved||(this.isListenOnMoved=!0,chrome.tabs.onMoved.addListener(((e,t)=>{const n=new c.MarioEvent(l.TabServiceEvents.ON_TAB_MOVED,{tabId:e,moveInfo:t});this.dispatcherService.emit(n).then()})))}listenOnActivated(){this.isListenOnActivated||(this.isListenOnActivated=!0,chrome.tabs.onActivated.addListener((e=>{const t=new c.MarioEvent(l.TabServiceEvents.ON_TAB_ACTIVATED,{activeInfo:e});this.dispatcherService.emit(t).then()})))}listenOnHighlighted(){this.isListenOnHighlighted||(this.isListenOnHighlighted=!0,chrome.tabs.onHighlighted.addListener((e=>{const t=new c.MarioEvent(l.TabServiceEvents.ON_TAB_HIGHLIGHTED,{highlightInfo:e});this.dispatcherService.emit(t).then()})))}listenOnDetached(){this.isListenOnDetached||(this.isListenOnDetached=!0,chrome.tabs.onDetached.addListener(((e,t)=>{const n=new c.MarioEvent(l.TabServiceEvents.ON_TAB_DETACHED,{tabId:e,detachInfo:t});this.dispatcherService.emit(n).then()})))}listenOnAttached(){this.isListenOnAttached||(this.isListenOnAttached=!0,chrome.tabs.onAttached.addListener(((e,t)=>{const n=new c.MarioEvent(l.TabServiceEvents.ON_TAB_ATTACHED,{tabId:e,attachInfo:t});this.dispatcherService.emit(n).then()})))}listenOnRemoved(){this.isListenOnRemoved||(this.isListenOnRemoved=!0,chrome.tabs.onRemoved.addListener(((e,t)=>{const n=new c.MarioEvent(l.TabServiceEvents.ON_TAB_REMOVED,{tabId:e,removeInfo:t});this.dispatcherService.emit(n).then()})))}listenOnReplaced(){this.isListenOnReplaced||(this.isListenOnReplaced=!0,chrome.tabs.onReplaced.addListener(((e,t)=>{const n=new c.MarioEvent(l.TabServiceEvents.ON_TAB_REPLACED,{addedTabId:e,removedTabId:t});this.dispatcherService.emit(n).then()})))}listenOnZoomChange(){this.isListenOnZoomChange||(this.isListenOnZoomChange=!0,chrome.tabs.onZoomChange.addListener((e=>{const t=new c.MarioEvent(l.TabServiceEvents.ON_TAB_ZOOM_CHANGE,{zoomChangeInfo:e});this.dispatcherService.emit(t).then()})))}sendMessage(e,t){chrome.tabs.sendMessage(e,t,(e=>{chrome.runtime.lastError}))}query(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.tabs.query(e,(e=>{t(e)}))}catch(e){n()}}))}))}reload(e,t={}){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{try{chrome.tabs.reload(e,t,(()=>{n()}))}catch(e){i()}}))}))}create(e){chrome.tabs.create(e)}get(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.tabs.get(e,(e=>t(e)))}catch(e){n(e)}}))}))}getCurrent(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{try{chrome.tabs.getCurrent((t=>e(t)))}catch(e){t(e)}}))}))}duplicate(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.tabs.duplicate(e,(e=>t(e)))}catch(e){n(e)}}))}))}highlight(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.tabs.highlight(e,(()=>t()))}catch(e){n(e)}}))}))}update(e,t){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{try{chrome.tabs.update(t,e,(e=>n(e)))}catch(e){i(e)}}))}))}move(e,t){return a(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{try{chrome.tabs.move(e,t,(e=>n(e)))}catch(e){i(e)}}))}))}remove(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{chrome.tabs.remove(e,(e=>t(e)))}catch(e){n(e)}}))}))}};d=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.TabService=d},54674:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ON_TAB_CREATED="ON_TAB_CREATED",e.ON_TAB_UPDATED="ON_TAB_UPDATED",e.ON_TAB_MOVED="ON_TAB_MOVED",e.ON_TAB_ACTIVATED="ON_TAB_ACTIVATED",e.ON_TAB_HIGHLIGHTED="ON_TAB_HIGHLIGHTED",e.ON_TAB_DETACHED="ON_TAB_DETACHED",e.ON_TAB_ATTACHED="ON_TAB_ATTACHED",e.ON_TAB_REMOVED="ON_TAB_REMOVED",e.ON_TAB_REPLACED="ON_TAB_REPLACED",e.ON_TAB_ZOOM_CHANGE="ON_TAB_ZOOM_CHANGE"}(t.TabServiceEvents||(t.TabServiceEvents={}))},34861:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(18313),u=n(98573),l=n(76560);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnBeforeRequest=!1,this.isListenOnBeforeSendHeaders=!1,this.isListenOnSendHeaders=!1,this.isListenOnHeadersReceived=!1,this.isListenOnAuthRequired=!1,this.isListenOnResponseStarted=!1,this.isListenOnBeforeRedirect=!1,this.isListenOnCompleted=!1,this.isListenOnErrorOccurred=!1,this.isListenOnActionIgnored=!1}listenOnBeforeRequest(e,t){this.isListenOnBeforeRequest||(this.isListenOnBeforeRequest=!0,chrome.webRequest.onBeforeRequest.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REQUEST,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnBeforeSendHeaders(e,t){this.isListenOnBeforeSendHeaders||(this.isListenOnBeforeSendHeaders=!0,chrome.webRequest.onBeforeSendHeaders.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_SEND_HEADERS,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnSendHeaders(e,t){this.isListenOnSendHeaders||(this.isListenOnSendHeaders=!0,chrome.webRequest.onSendHeaders.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_SEND_HEADERS,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnHeadersReceived(e,t){this.isListenOnHeadersReceived||(this.isListenOnHeadersReceived=!0,chrome.webRequest.onHeadersReceived.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_HEADERS_RECEIVED,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnAuthRequired(e,t){this.isListenOnAuthRequired||(this.isListenOnAuthRequired=!0,chrome.webRequest.onAuthRequired.addListener(((e,t)=>{const n=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_AUTH_REQUIRED,{details:e,callback:t});this.dispatcherService.emit(n).then()}),e,t))}listenOnResponseStarted(e,t){this.isListenOnResponseStarted||(this.isListenOnResponseStarted=!0,chrome.webRequest.onResponseStarted.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_RESPONSE_STARTED,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnBeforeRedirect(e,t){this.isListenOnBeforeRedirect||(this.isListenOnBeforeRedirect=!0,chrome.webRequest.onBeforeRedirect.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REDIRECT,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnCompleted(e,t){this.isListenOnCompleted||(this.isListenOnCompleted=!0,chrome.webRequest.onCompleted.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_COMPLETED,{details:e});this.dispatcherService.emit(t).then()}),e,t))}listenOnErrorOccurred(e){this.isListenOnErrorOccurred||(this.isListenOnErrorOccurred=!0,chrome.webRequest.onErrorOccurred.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_ERROR_OCCURRED,{details:e});this.dispatcherService.emit(t).then()}),e))}listenOnActionIgnored(e,t){this.isListenOnActionIgnored||(this.isListenOnActionIgnored=!0,chrome.webRequest.onActionIgnored.addListener((e=>{const t=new c.MarioEvent(l.WebRequestServiceEvents.WEB_REQUEST_ON_ACTION_IGNORED,{details:e});this.dispatcherService.emit(t).then()}),e,t))}handlerBehaviorChanged(){return a(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{try{chrome.webRequest.handlerBehaviorChanged((()=>e()))}catch(e){t(e)}}))}))}};d=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.WebRequestService=d},76560:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.WEB_REQUEST_ON_BEFORE_REQUEST="WEB_REQUEST_ON_BEFORE_REQUEST",e.WEB_REQUEST_ON_BEFORE_SEND_HEADERS="WEB_REQUEST_ON_BEFORE_SEND_HEADERS",e.WEB_REQUEST_ON_SEND_HEADERS="WEB_REQUEST_ON_SEND_HEADERS",e.WEB_REQUEST_ON_HEADERS_RECEIVED="WEB_REQUEST_ON_HEADERS_RECEIVED",e.WEB_REQUEST_ON_AUTH_REQUIRED="WEB_REQUEST_ON_AUTH_REQUIRED",e.WEB_REQUEST_ON_RESPONSE_STARTED="WEB_REQUEST_ON_RESPONSE_STARTED",e.WEB_REQUEST_ON_BEFORE_REDIRECT="WEB_REQUEST_ON_BEFORE_REDIRECT",e.WEB_REQUEST_ON_COMPLETED="WEB_REQUEST_ON_COMPLETED",e.WEB_REQUEST_ON_ERROR_OCCURRED="WEB_REQUEST_ON_ERROR_OCCURRED",e.WEB_REQUEST_ON_ACTION_IGNORED="WEB_REQUEST_ON_ACTION_IGNORED"}(t.WebRequestServiceEvents||(t.WebRequestServiceEvents={}))},40918:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(98573),u=n(99959),l=n(19576);let d=class{constructor(e){this.externalDispatcher=e}emitResponse(e,t,n){return a(this,void 0,void 0,(function*(){const i={requestId:t,response:n},r=new u.MarioEvent(l.PostBgEvents.RESPONSE,i,t);yield this.externalDispatcher.emit(e,r)}))}emitEvent(e,t,n){return a(this,void 0,void 0,(function*(){const i={event:t,payload:n},r=new u.MarioEvent(l.PostBgEvents.EVENT,i);yield this.externalDispatcher.emit(e,r)}))}};d=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.EXTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.PostBgDispatcher=d},19576:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.RESPONSE="WINDOW_POST_MESSAGE_RESPONSE",e.EVENT="WINDOW_POST_MESSAGE_EVENT"}(t.PostBgEvents||(t.PostBgEvents={}))},18313:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17199);t.Mario=i.Mario;var r=n(33528);t.MarioModule=r.MarioModule;var o=n(99959);t.MarioEvent=o.MarioEvent;var a=n(98573);t.MARIO_TYPES=a.MARIO_TYPES;var s=n(4731);t.ExternalDispatcher=s.ExternalDispatcher;var c=n(22344);t.CacheService=c.CacheService;var u=n(27932);t.ContentDispatcherService=u.ContentDispatcherService;var l=n(43473);t.InternalDispatcher=l.InternalDispatcher;var d=n(48643);t.LoggerService=d.LoggerService;var h=n(2325);t.TabService=h.TabService;var f=n(37302);t.NavigationService=f.NavigationService;var p=n(34861);t.WebRequestService=p.WebRequestService;var _=n(9297);t.StorageService=_.StorageService},98646:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CounterModule=void 0;const r=n(18313),o=n(26012),a=n(81413);class s extends r.MarioModule{name(){return"CounterModule"}static use(e,t){return e.registerModule(s,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(o.CounterModuleTypes.COUNTER_STORAGE_SERVICE).toConstantValue(e.storageService),this.mario().registerService(o.CounterModuleTypes.COUNTER_SERVICE,a.CounterService)}))}}t.CounterModule=s},26012:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CounterModuleTypes=void 0;const n={COUNTER_SERVICE:Symbol.for("COUNTER_SERVICE"),COUNTER_STORAGE_SERVICE:Symbol.for("COUNTER_STORAGE_SERVICE")};t.CounterModuleTypes=n},81413:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CounterService=void 0;const s=n(86700),c=n(26012);let u=class{constructor(e){this.storageService=e,this.key="COUNTER"}count(e){return a(this,void 0,void 0,(function*(){if(yield this.hasNot(e))return 0;return(yield this.get(e)).value}))}increase(e){return a(this,void 0,void 0,(function*(){const t=this.mapKeyWord(e),n=this.makeCounter(1);if(yield this.has(e)){const e=JSON.parse(yield this.storageService.get(t));n.value=e.value+1}return yield this.storageService.set(t,JSON.stringify(n)),n.value}))}get(e){return a(this,void 0,void 0,(function*(){if(yield this.hasNot(e))throw new Error(`Counter with name "${e}" is not found`);const t=this.mapKeyWord(e);return JSON.parse(yield this.storageService.get(t))}))}set(e,t){return a(this,void 0,void 0,(function*(){const n=this.mapKeyWord(e),i=this.makeCounter(t);yield this.storageService.set(n,JSON.stringify(i))}))}has(e){return a(this,void 0,void 0,(function*(){const t=this.mapKeyWord(e);return this.storageService.has(t)}))}hasNot(e){return a(this,void 0,void 0,(function*(){return!(yield this.has(e))}))}reset(e){return a(this,void 0,void 0,(function*(){const t=this.mapKeyWord(e),n=this.makeCounter(0);return yield this.storageService.set(t,JSON.stringify(n)),0}))}mapKeyWord(e){return`${this.key}_${e}`}makeCounter(e){return{modified:Date.now(),value:e}}};u=i([s.injectable(),o(0,s.inject(c.CounterModuleTypes.COUNTER_STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.CounterService=u},8390:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CountryRestrictionModule=void 0;const r=n(18313),o=n(8622),a=n(97036);class s extends r.MarioModule{name(){return"CountryRestrictionModule"}register(e){return i(this,void 0,void 0,(function*(){const t=e;this.mario().container().bind(o.CountryRestrictionModuleTypes.RESTRICTION_API_URL).toConstantValue(t.apiUrl),this.mario().registerService(o.CountryRestrictionModuleTypes.RESTRICTION_SERVICE,a.CountryRestrictionService)}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(s,t)}))}}t.CountryRestrictionModule=s},8622:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CountryRestrictionModuleTypes=void 0;const n={RESTRICTION_SERVICE:Symbol.for("RESTRICTION_SERVICE"),RESTRICTION_API_URL:Symbol.for("RESTRICTION_API_URL")};t.CountryRestrictionModuleTypes=n},97036:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CountryRestrictionService=void 0;const s=n(86700),c=n(18313),u=n(37050),l=n(82730),d=n(8622);let h=class{constructor(e,t,n){this.apiUrl=e,this.httpClient=t,this.logger=n,this.restricted=!1}checkCountryRestriction(){return a(this,void 0,void 0,(function*(){const e=this.buildEndpoint("/website/country/validate"),t=new Headers;t.append("content-Type","application/json");const n={headers:t},i={skipInterceptor:!0,forceRequest:!0};try{yield this.httpClient.get(e,n,i).then((e=>{this.restricted="CLOSED"===(null==e?void 0:e.access),this.countryName=null==e?void 0:e.country}))}catch(e){this.logger.error(e)}}))}isRestricted(){return this.restricted}getRestrictedCountryName(){return this.countryName}buildEndpoint(e){return this.apiUrl+e}};h=i([s.injectable(),o(0,s.inject(d.CountryRestrictionModuleTypes.RESTRICTION_API_URL)),o(1,s.inject(u.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(2,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[String,l.HttpClient,Object])],h),t.CountryRestrictionService=h},62406:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlagModule=void 0;const r=n(18313),o=n(23682),a=n(20466);class s extends r.MarioModule{name(){return"FlagModule"}static use(e,t){return e.registerModule(s,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(o.FlagModuleTypes.FLAG_STORAGE_SERVICE).toConstantValue(e.storageService),this.mario().registerService(o.FlagModuleTypes.FLAG_SERVICE,a.FlagService)}))}}t.FlagModule=s},23682:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagModuleTypes=void 0;const n={FLAG_SERVICE:Symbol.for("FLAG_SERVICE"),FLAG_STORAGE_SERVICE:Symbol.for("FLAG_STORAGE_SERVICE")};t.FlagModuleTypes=n},20466:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlagService=void 0;const s=n(86700),c=n(23682);let u=class{constructor(e){this.storageService=e,this.key="FLAG"}get(e){return a(this,void 0,void 0,(function*(){const t=this.mapFlag(e);return JSON.parse(yield this.storageService.get(t))}))}has(e){return a(this,void 0,void 0,(function*(){const t=this.mapFlag(e);return this.storageService.has(t)}))}activate(e){return a(this,void 0,void 0,(function*(){const t=this.mapFlag(e),n=this.makeFlag(!0);yield this.storageService.set(t,JSON.stringify(n))}))}deactivate(e){return a(this,void 0,void 0,(function*(){const t=this.mapFlag(e),n=this.makeFlag(!1);yield this.storageService.set(t,JSON.stringify(n))}))}isActivated(e){return a(this,void 0,void 0,(function*(){return!!(yield this.has(e))&&(yield this.get(e)).active}))}isDeactivated(e){return a(this,void 0,void 0,(function*(){return!(yield this.has(e))||!1===(yield this.get(e)).active}))}remove(e){return a(this,void 0,void 0,(function*(){const t=this.mapFlag(e);return this.storageService.remove([t])}))}mapFlag(e){return`${this.key}_${e}`}makeFlag(e){return{active:e,modified:Date.now()}}};u=i([s.injectable(),o(0,s.inject(c.FlagModuleTypes.FLAG_STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.FlagService=u},76600:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsEvents=void 0,function(e){e.TRACK_PAGE="GOOGLE_ANALYTICS_TRACK_PAGE",e.TRACK_EVENT="GOOGLE_ANALYTICS_TRACK_EVENT"}(t.GoogleAnalyticsEvents||(t.GoogleAnalyticsEvents={}))},89935:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsModule=void 0;const r=n(18313),o=n(28059),a=n(60175),s=n(79590),c=n(51458),u=n(89860);class l extends r.MarioModule{name(){return"GoogleAnalyticsModule"}static use(e,t){return e.registerModule(l,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().logger().log(`GoogleAnalyticsModule: trackerId: ${e.trackerId}`),this.mario().logger().log(`GoogleAnalyticsModule: hostName: ${e.hostName}`),this.mario().logger().log(`GoogleAnalyticsModule: clientId: ${e.clientId}`),this.mario().logger().log(`GoogleAnalyticsModule: enabled: ${e.enabled}`),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_APP_VERSION).toConstantValue(e.appVersion),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_APP_NAME).toConstantValue(e.appName),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_CLIENT_ID).toConstantValue(e.clientId),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_HOST_NAME).toConstantValue(e.hostName),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_TRACKER_ID).toConstantValue(e.trackerId),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_ENABLED).toConstantValue(e.enabled),this.mario().container().bind(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_HOLD_LAST_EVENTS).toConstantValue(e.holdLastEvents||0),this.mario().registerService(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE,o.GoogleAnalyticsService),this.mario().registerService(a.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_STORAGE,u.GoogleAnalyticsStorage),this.mario().externalDispatcher().on(c.GoogleAnalyticsTrackPage),this.mario().externalDispatcher().on(s.GoogleAnalyticsTrackEvent)}))}}t.GoogleAnalyticsModule=l},28059:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsService=void 0;const a=n(86700),s=n(89860),c=n(60175);let u=class{constructor(e,t,n,i,r,o,a,s){this.appVersion=e,this.appName=t,this.hostName=n,this.trackerId=i,this.clientId=r,this.enabled=o,this.hold=a,this.storage=s}enable(){this.enabled=!0,this.storage.get().then((e=>{e.forEach((e=>{this.trackEvent(e.category,e.action,e.label,e.value)})),this.storage.clean().then()}))}disable(){this.enabled=!1}isEnabled(){return this.enabled}trackEvent(e,t,n=null,i=null){if(!this.enabled){if(this.hold){const r={category:e,action:t,label:n,value:i};this.storage.add(r).then()}return}const r=this.prepareRequestParams();r.append("t","event"),r.append("ec",e),r.append("ea",t),n&&r.append("el",n),i&&r.append("ev",i),this.send(r)}trackPageView(e,t){if(!this.enabled)return;const n=this.prepareRequestParams();n.append("t","pageview"),n.append("dh",this.hostName),n.append("dp",e),n.append("dt",t),this.send(n)}setHoldLastEvents(e){this.hold=e}getHoldLastEvents(){return this.hold}prepareRequestParams(){const e=new URLSearchParams;return e.append("v","1"),e.append("tid",this.trackerId),e.append("cid",this.clientId),e.append("an",this.appName),e.append("av",this.appVersion),e}send(e){const t=new XMLHttpRequest;t.open("POST","https://www.google-analytics.com/collect",!0),t.send(e.toString())}};u=i([a.injectable(),o(0,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_APP_VERSION)),o(1,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_APP_NAME)),o(2,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_HOST_NAME)),o(3,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_TRACKER_ID)),o(4,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_CLIENT_ID)),o(5,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_ENABLED)),o(6,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_HOLD_LAST_EVENTS)),o(7,a.inject(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_STORAGE)),r("design:paramtypes",[String,String,String,String,String,Boolean,Number,s.GoogleAnalyticsStorage])],u),t.GoogleAnalyticsService=u},89860:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsStorage=void 0;const s=n(86700),c=n(18313),u=n(60175);let l=class{constructor(e,t){this.storage=e,this.hold=t,this.key="GOOGLE_ANALYTICS_EVENTS"}add(e){return a(this,void 0,void 0,(function*(){let t=yield this.get();t=t.splice(-this.hold),t.push(e),yield this.store(t)}))}get(){return a(this,void 0,void 0,(function*(){let e=[];if(yield this.storage.has(this.key)){const t=yield this.storage.get(this.key);e=JSON.parse(t)}return e}))}has(){return a(this,void 0,void 0,(function*(){return this.storage.has(this.key)}))}store(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);yield this.storage.set(this.key,t)}))}clean(){return a(this,void 0,void 0,(function*(){yield this.storage.set(this.key,"[]")}))}};l=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.STORAGE_SERVICE)),o(1,s.inject(u.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_HOLD_LAST_EVENTS)),r("design:paramtypes",[Object,Number])],l),t.GoogleAnalyticsStorage=l},60175:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsTypes=void 0;const n={GOOGLE_ANALYTICS_APP_NAME:Symbol.for("GOOGLE_ANALYTICS_APP_NAME"),GOOGLE_ANALYTICS_APP_VERSION:Symbol.for("GOOGLE_ANALYTICS_APP_VERSION"),GOOGLE_ANALYTICS_CLIENT_ID:Symbol.for("GOOGLE_ANALYTICS_CLIENT_ID"),GOOGLE_ANALYTICS_ENABLED:Symbol.for("GOOGLE_ANALYTICS_ENABLED"),GOOGLE_ANALYTICS_HOLD_LAST_EVENTS:Symbol.for("GOOGLE_ANALYTICS_HOLD_LAST_EVENTS"),GOOGLE_ANALYTICS_HOST_NAME:Symbol.for("GOOGLE_ANALYTICS_HOST_NAME"),GOOGLE_ANALYTICS_SERVICE:Symbol.for("GOOGLE_ANALYTICS_SERVICE"),GOOGLE_ANALYTICS_STORAGE:Symbol.for("GOOGLE_ANALYTICS_STORAGE"),GOOGLE_ANALYTICS_TRACKER_ID:Symbol.for("GOOGLE_ANALYTICS_TRACKER_ID")};t.GoogleAnalyticsTypes=n},79590:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsTrackEvent=void 0;const s=n(86700),c=n(76600),u=n(60175),l=n(28059);let d=class{constructor(e){this.googleAnalyticsService=e}on(){return c.GoogleAnalyticsEvents.TRACK_EVENT}handle(e,t,n){return a(this,void 0,void 0,(function*(){const t=e.data;this.googleAnalyticsService.trackEvent(t.category,t.action,t.label,t.value)}))}};d=i([s.injectable(),o(0,s.inject(u.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)),r("design:paramtypes",[l.GoogleAnalyticsService])],d),t.GoogleAnalyticsTrackEvent=d},51458:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalyticsTrackPage=void 0;const s=n(86700),c=n(76600),u=n(60175),l=n(28059);let d=class{constructor(e){this.googleAnalyticsService=e}on(){return c.GoogleAnalyticsEvents.TRACK_PAGE}handle(e,t,n){return a(this,void 0,void 0,(function*(){const t=e.data;this.googleAnalyticsService.trackPageView(t.pageUrl,t.pageTitle)}))}};d=i([s.injectable(),o(0,s.inject(u.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)),r("design:paramtypes",[l.GoogleAnalyticsService])],d),t.GoogleAnalyticsTrackPage=d},16084:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HelloAndGoodbyeModule=void 0;const r=n(18313),o=n(60175);class a extends r.MarioModule{name(){return"HelloAndGoodbyeModule"}static use(e,t){return e.registerModule(a,t)}register(e){return i(this,void 0,void 0,(function*(){const t=this.mario().extension().manifest().version;this.mario().extension().onInstall((n=>{const i=this.getGoogleAnalyticsService();"install"===n.reason?(e.trackInstall&&i.trackEvent("extension","install",t),chrome.tabs.create({url:e.installUrl})):"update"===n.reason&&e.trackUpdate&&i.trackEvent("extension","update",t)})),this.mario().extension().setUninstallURL(e.uninstallUrl)}))}getGoogleAnalyticsService(){return this.mario().getService(o.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)}}t.HelloAndGoodbyeModule=a},55312:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HideMyGeoLocationModule=void 0;const i=n(18313),r=n(40918),o=n(60292),a=n(22934),s=n(95950),c=n(9059),u=n(67080);class l extends i.MarioModule{name(){return"HideMyGeoLocation"}register(e){this.mario().registerService(i.MARIO_TYPES.WINDOW_POST,r.PostBgDispatcher),this.mario().registerService(s.HideMyLocationTypes.HIDE_MY_LOCATION_SERVICE,a.HideMyGeoLocationService),this.mario().registerService(c.IpInfoTypes.IP_INFO_SERVICE,u.IpInfoService),this.mario().externalDispatcher().on(o.GetMyLocation)}}t.HideMyGeoLocationModule=l},22934:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.HideMyGeoLocationService=void 0;const r=n(86700);let o=class{constructor(){this.status=!1}enable(){this.status=!0}disable(){this.status=!1}isEnabled(){return this.status}isDisabled(){return!this.status}};o=i([r.injectable()],o),t.HideMyGeoLocationService=o},74525:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HideMyLocationEvents=void 0,function(e){e.GET_LOCATION="HIDE_MY_LOCATION__GET_LOCATION"}(t.HideMyLocationEvents||(t.HideMyLocationEvents={}))},95950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HideMyLocationTypes=void 0;const n={HIDE_MY_LOCATION_SERVICE:Symbol.for("HIDE_MY_LOCATION_SERVICE")};t.HideMyLocationTypes=n},60292:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GetMyLocation=void 0;const s=n(86700),c=n(18313),u=n(74525),l=n(95950),d=n(22934),h=n(9059);let f=class{constructor(e,t,n){this.postDispatcher=e,this.service=t,this.ipInfoService=n}on(){return u.HideMyLocationEvents.GET_LOCATION}handle(e,t,n){return a(this,void 0,void 0,(function*(){if(this.service.isEnabled())try{const n=yield this.ipInfoService.get();if(n.loc&&2===n.loc.length){const i={enabled:!0,latitude:n.loc[1],longitude:n.loc[0],status:"SUCCESS"};yield this.postDispatcher.emitResponse(t.tab.id,e.id,i)}else yield this.sendErrorResponse(t.tab.id,e.id)}catch(n){yield this.sendErrorResponse(t.tab.id,e.id)}else yield this.sendErrorResponse(t.tab.id,e.id)}))}sendErrorResponse(e,t){return a(this,void 0,void 0,(function*(){yield this.postDispatcher.emitResponse(e,t,{enabled:!1})}))}};f=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.WINDOW_POST)),o(1,s.inject(l.HideMyLocationTypes.HIDE_MY_LOCATION_SERVICE)),o(2,s.inject(h.IpInfoTypes.IP_INFO_SERVICE)),r("design:paramtypes",[Object,d.HideMyGeoLocationService,Object])],f),t.GetMyLocation=f},41785:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClientModule=void 0;const i=n(18313),r=n(37050),o=n(82730);class a extends i.MarioModule{name(){return"HttpClientModule"}register(e){this.mario().registerService(r.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT,o.HttpClient)}}t.HttpClientModule=a},37050:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HTTP_CLIENT_MODULE_TYPES=void 0;const n={HTTP_CLIENT:Symbol.for("HTTP_CLIENT")};t.HTTP_CLIENT_MODULE_TYPES=n},82730:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpClient=void 0;const o=n(86700);let a=class{constructor(){this.queue=[],this.lock=!1}intercept(e){this.interceptor=e}onFail(e){this.failHandler=e}post(e,t,n={},i={}){return r(this,void 0,void 0,(function*(){return this.request(e,"POST",t,n,i)}))}get(e,t={},n={}){return r(this,void 0,void 0,(function*(){return this.request(e,"GET",null,t,n)}))}delete(e,t={},n={}){return r(this,void 0,void 0,(function*(){return this.request(e,"DELETE",null,t,n)}))}request(e,t,n,i={},o={}){return r(this,void 0,void 0,(function*(){return new Promise(((r,a)=>{if(o.forceRequest)this._request(e,t,n,i,o).then((e=>r(e))).catch((e=>a(e)));else{const s={reject:a,request:{url:e,method:t,payload:n,options:i,extra:o},resolve:r};this.queue.push(s)}this.lock||(this.lock=!0,this.handleQueue().then())}))}))}_request(e,t,n,i={},o={}){return r(this,void 0,void 0,(function*(){const r=["headers","mode","cache","credentials","redirect","referrerPolicy"].reduce(((e,t)=>(i[t]&&(e[t]=i[t]),e)),{method:t,url:e});"string"==typeof n||n instanceof FormData?r.body=n:n instanceof Object&&(r.body=JSON.stringify(n)),!o.skipInterceptor&&this.interceptor&&(yield new Promise(((e,t)=>this.interceptor(r,e,t))));const a=yield fetch(r.url,r);if(!a.ok){if(!o.skipFailHandler&&this.failHandler)try{return yield new Promise(((e,t)=>this.failHandler(a,e,t))),this._request(e,t,n,i,o)}catch(e){throw a}throw a}return o.rawResponse?a:a.headers.has("Content-Type")?a.headers.get("Content-Type").startsWith("application/json")?a.json():a.text():void 0}))}handleQueue(){return r(this,void 0,void 0,(function*(){const e=this.queue.shift();if(!e)return void(this.lock=!1);const{url:t,method:n,payload:i,options:r,extra:o}=e.request;try{const a=yield this._request(t,n,i,r,o);e.resolve(a)}catch(t){e.reject(t)}this.handleQueue().then()}))}};a=i([o.injectable()],a),t.HttpClient=a},14962:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityModule=void 0;const r=n(18313),o=n(9930),a=n(96795);class s extends r.MarioModule{name(){return"IdentityModule"}static use(e,t){return e.registerModule(s,t)}register(e){return i(this,void 0,void 0,(function*(){const t=e.storageProvider||r.StorageService;this.mario().registerService(a.IdentityTypes.IDENTITY_STORAGE,t);const n=yield this.getIdentityId();this.mario().container().bind(a.IdentityTypes.IDENTITY_ID).toConstantValue(n),this.mario().registerService(a.IdentityTypes.IDENTITY_SERVICE,o.IdentityService)}))}getIdentityId(){return i(this,void 0,void 0,(function*(){const e="IDENTITY_ID";if(!(yield this.getStorageService().has(e))){const t=this.generateIdentityId();return yield this.getStorageService().set(e,t),t}return yield this.getStorageService().get(e)}))}getStorageService(){return this.mario().getService(a.IdentityTypes.IDENTITY_STORAGE)}generateIdentityId(){return`${Math.floor(2147483647*Math.random())}.${Math.floor(Date.now()/1e3)}`}}t.IdentityModule=s},9930:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityService=void 0;const a=n(86700),s=n(96795);let c=class{constructor(e){this.identityId=e}getIdentityId(){return this.identityId}};c=i([a.injectable(),o(0,a.inject(s.IdentityTypes.IDENTITY_ID)),r("design:paramtypes",[String])],c),t.IdentityService=c},96795:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityTypes=void 0;const n={IDENTITY_ID:Symbol.for("IDENTITY_ID"),IDENTITY_SERVICE:Symbol.for("IDENTITY_SERVICE"),IDENTITY_STORAGE:Symbol.for("IDENTITY_STORAGE")};t.IdentityTypes=n},9059:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpInfoTypes=void 0;const n={IP_INFO_SERVICE:Symbol.for("IP_INFO_SERVICE")};t.IpInfoTypes=n},94570:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpInfoServiceException=void 0;class n extends Error{}t.IpInfoServiceException=n},67080:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IpInfoService=void 0;const s=n(86700),c=n(63815),u=n(94570),l=n(18313);let d=class{constructor(e){this.logger=e,this.api="https://geo.geosurf.io/"}get(e=null){return a(this,void 0,void 0,(function*(){try{const t=this.api+(e?e.getIP():""),n=yield fetch(t),i=yield n.json(),r={city:i.hasOwnProperty("city")?i.city:"",country:i.hasOwnProperty("country")?i.country:"",ip:new c.IP(i.ip),isp:i.hasOwnProperty("isp")?i.isp:""};return i.hasOwnProperty("loc")&&(r.loc=i.loc),i.hasOwnProperty("postal")&&(r.postal=i.postal),i.hasOwnProperty("asn")&&(r.asn=i.asn),i.hasOwnProperty("organization")&&(r.organization=i.organization),i.hasOwnProperty("state")&&(r.state=i.state),r}catch(e){throw this.logger.error(e),new u.IpInfoServiceException(e.message)}}))}};d=i([s.injectable(),o(0,s.inject(l.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object])],d),t.IpInfoService=d},63815:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IP=void 0;const i=n(94570);t.IP=class{constructor(e){if(this.ip=e,!/^(?!0)(?!.*\.$)((1?\d?\d|25[0-5]|2[0-4]\d)(\.|$)){4}$/.test(this.ip))throw new i.IpInfoServiceException(`Invalid IP address: "${this.ip}"`)}getIP(){return this.ip}}},72233:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(86215),u=n(33726),l=n(18313),d=n(92823);let h=class{constructor(e,t,n,i,r,o,a){this.appVersion=e,this.appName=t,this.api=n,this.enabled=i,this.hold=r,this.logger=o,this.storage=a;const s={api:this.api,appName:this.appName,clientVersion:this.appVersion};this.client=new u.UrbanAnalytics(s)}enable(){this.enabled=!0;(()=>a(this,void 0,void 0,(function*(){const e=yield this.storage.get();for(const t of e)try{yield this.track(t)}catch(e){this.logger.error(e)}yield this.storage.clean()})))().then()}isEnabled(){return this.enabled}disable(){this.enabled=!1}track(e){return a(this,void 0,void 0,(function*(){if(this.enabled){const t=this.client.buildPayload(e);this.logger.log("UrbanAnalyticsClient: track event",t),yield this.client.track(e)}else this.hold&&(yield this.storage.add(e)),this.logger.log("UrbanAnalyticsClient: ignore event",e)}))}};h=i([s.injectable(),o(0,s.inject(c.UrbanAnalyticsTypes.APP_VERSION)),o(1,s.inject(c.UrbanAnalyticsTypes.APP_NAME)),o(2,s.inject(c.UrbanAnalyticsTypes.API)),o(3,s.inject(c.UrbanAnalyticsTypes.ENABLED)),o(4,s.inject(c.UrbanAnalyticsTypes.HOLD_LAST_EVENTS)),o(5,s.inject(l.MARIO_TYPES.LOGGER_SERVICE)),o(6,s.inject(c.UrbanAnalyticsTypes.STORAGE)),r("design:paramtypes",[String,String,String,Boolean,Boolean,Object,d.UrbanAnalyticsStorage])],h),t.UrbanAnalyticsClient=h},16426:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(18313),o=n(86215),a=n(72233),s=n(92823);class c extends r.MarioModule{name(){return"UrbanAnalyticsModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(o.UrbanAnalyticsTypes.API).toConstantValue(e.api),this.mario().container().bind(o.UrbanAnalyticsTypes.APP_NAME).toConstantValue(e.appName),this.mario().container().bind(o.UrbanAnalyticsTypes.APP_VERSION).toConstantValue(e.appVersion),this.mario().container().bind(o.UrbanAnalyticsTypes.ENABLED).toConstantValue(!!e.enabled),this.mario().container().bind(o.UrbanAnalyticsTypes.HOLD_LAST_EVENTS).toConstantValue(e.holdLastEvents),this.mario().registerService(o.UrbanAnalyticsTypes.STORAGE,s.UrbanAnalyticsStorage),this.mario().registerService(o.UrbanAnalyticsTypes.CLIENT,a.UrbanAnalyticsClient)}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(c,t)}))}}t.UrbanAnalyticsModule=c},92823:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(18313),u=n(86215);let l=class{constructor(e,t){this.storage=e,this.hold=t,this.key="URBAN_ANALYTICS_EVENTS"}add(e){return a(this,void 0,void 0,(function*(){let t=yield this.get();t=t.splice(-this.hold),t.push(e),yield this.store(t)}))}get(){return a(this,void 0,void 0,(function*(){let e=[];if(yield this.storage.has(this.key)){const t=yield this.storage.get(this.key);e=JSON.parse(t)}return e}))}has(){return a(this,void 0,void 0,(function*(){return this.storage.has(this.key)}))}store(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);yield this.storage.set(this.key,t)}))}clean(){return a(this,void 0,void 0,(function*(){yield this.storage.set(this.key,"[]")}))}};l=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.STORAGE_SERVICE)),o(1,s.inject(u.UrbanAnalyticsTypes.HOLD_LAST_EVENTS)),r("design:paramtypes",[Object,Number])],l),t.UrbanAnalyticsStorage=l},86215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanAnalyticsTypes={API:Symbol.for("URBAN_ANALYTICS_API"),APP_NAME:Symbol.for("URBAN_ANALYTICS_APP_NAME"),APP_VERSION:Symbol.for("URBAN_ANALYTICS_APP_VERSION"),CLIENT:Symbol.for("URBAN_ANALYTICS_CLIENT"),ENABLED:Symbol.for("URBAN_ANALYTICS_ENABLED"),HOLD_LAST_EVENTS:Symbol.for("URBAN_ANALYTICS_HOLD_LAST_EVENTS"),STORAGE:Symbol.for("URBAN_ANALYTICS_STORAGE")}},63642:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PanalyticsIdentityTypes=void 0;const n={PANALYTICS_HOST:Symbol.for("PANALYTICS_HOST"),PANALYTICS_LOGGING:Symbol.for("PANALYTICS_LOGGING"),PANALYTICS_SERVICE:Symbol.for("PANALYTICS_SERVICE"),PANALYTICS_STORAGE_KEY:Symbol.for("PANALYTICS_STORAGE_KEY")};t.PanalyticsIdentityTypes=n},55738:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PanalyticsModule=void 0;const r=n(18313),o=n(35678),a=n(63642);class s extends r.MarioModule{name(){return"PanalyticsModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(a.PanalyticsIdentityTypes.PANALYTICS_HOST).toConstantValue(e.host),this.mario().container().bind(a.PanalyticsIdentityTypes.PANALYTICS_LOGGING).toConstantValue(e.logging),this.mario().container().bind(a.PanalyticsIdentityTypes.PANALYTICS_STORAGE_KEY).toConstantValue(e.storageKey),this.mario().registerService(a.PanalyticsIdentityTypes.PANALYTICS_SERVICE,o.PanalyticsService),yield this.mario().getService(a.PanalyticsIdentityTypes.PANALYTICS_SERVICE).resolveId()}))}}t.PanalyticsModule=s},35678:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PanalyticsService=void 0;const s=n(86700),c=n(63642),u=n(73190);let l=class{constructor(e,t,n){this.host=e,this.logging=t,this.storageKey=n;const i={host:this.host,logging:this.logging};this.storageKey&&(i.storageKey=this.storageKey),this.utility=new u.default(i)}resolveId(){return a(this,void 0,void 0,(function*(){this.identityId=yield this.utility.getKeyAsync()}))}getId(){return this.identityId}};l=i([s.injectable(),o(0,s.inject(c.PanalyticsIdentityTypes.PANALYTICS_HOST)),o(1,s.inject(c.PanalyticsIdentityTypes.PANALYTICS_LOGGING)),o(2,s.inject(c.PanalyticsIdentityTypes.PANALYTICS_STORAGE_KEY)),r("design:paramtypes",[String,Boolean,String])],l),t.PanalyticsService=l},44366:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyEnum=void 0,function(e){e.AGREE="AGREE",e.REJECT="REJECT"}(t.PolicyEnum||(t.PolicyEnum={}))},50554:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyModule=void 0;const r=n(18313),o=n(49798),a=n(46149);class s extends r.MarioModule{name(){return"PolicyModule"}static use(e,t){return e.registerModule(s,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(o.PolicyModuleTypes.POLICY_STORAGE_SERVICE).toConstantValue(e.storageService),this.mario().registerService(o.PolicyModuleTypes.POLICY_SERVICE,a.PolicyService)}))}}t.PolicyModule=s},49798:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyModuleTypes=void 0;const n={POLICY_SERVICE:Symbol.for("POLICY_SERVICE"),POLICY_STORAGE_SERVICE:Symbol.for("POLICY_STORAGE_SERVICE")};t.PolicyModuleTypes=n},46149:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyService=void 0;const s=n(86700),c=n(44366),u=n(49798),l=n(18313),d=n(86878);let h=class{constructor(e,t){this.storageService=e,this.internalDispatcher=t,this.key="POLICY"}agree(){return a(this,void 0,void 0,(function*(){yield this.storageService.set(this.key,c.PolicyEnum.AGREE),this.internalDispatcher.emit(new l.MarioEvent(d.PolicyServiceEvents.POLICY_AGREED))}))}reject(){return a(this,void 0,void 0,(function*(){yield this.storageService.set(this.key,c.PolicyEnum.REJECT),this.internalDispatcher.emit(new l.MarioEvent(d.PolicyServiceEvents.POLICY_REJECTED))}))}isAgreed(){return a(this,void 0,void 0,(function*(){return this.is(c.PolicyEnum.AGREE)}))}isRejected(){return a(this,void 0,void 0,(function*(){return this.is(c.PolicyEnum.REJECT)}))}hasAnswer(){return a(this,void 0,void 0,(function*(){return yield this.storageService.has(this.key)}))}is(e){return a(this,void 0,void 0,(function*(){if(yield this.storageService.has(this.key)){return(yield this.storageService.get(this.key))===e}return!1}))}};h=i([s.injectable(),o(0,s.inject(u.PolicyModuleTypes.POLICY_STORAGE_SERVICE)),o(1,s.inject(l.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],h),t.PolicyService=h},86878:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyServiceEvents=void 0,function(e){e.POLICY_AGREED="POLICY_AGREED",e.POLICY_REJECTED="POLICY_REJECTED"}(t.PolicyServiceEvents||(t.PolicyServiceEvents={}))},438:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18313),r=n(38581),o=n(50826),a=n(67626);class s extends i.MarioModule{name(){return"PromotionApiModule"}register(e){if("string"!=typeof e.api)throw new a.PromotionApiModuleException('PromotionApiModule: an option "api" has to be string');this.mario().container().bind(r.PromotionApiModuleTypes._API).toConstantValue(e.api),this.mario().registerService(r.PromotionApiModuleTypes.PROMOTION_API_SERVICE,o.PromotionService)}static use(e,t){return e.registerModule(s,t)}}t.PromotionApiModule=s},67626:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{}t.PromotionApiModuleException=n},38581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={PROMOTION_API_SERVICE:Symbol.for("PROMOTION_API_SERVICE"),_API:Symbol.for("PROMOTION_API")};t.PromotionApiModuleTypes=n},50826:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=n(86700),c=n(38581),u=n(67626);var l;!function(e){e.TEXT="TEXT",e.LINK="LINK"}(l=t.PromotionElementType||(t.PromotionElementType={}));let d=class{constructor(e){this.api=e}fetch(e,t){return a(this,void 0,void 0,(function*(){const n=new URLSearchParams;e&&n.append("browser",e),t&&n.append("section",t);const i=`${this.api}?${n.toString()}`;try{const n=yield fetch(i),r=yield n.json();return e&&t&&r[e]&&r[e]&&r[e][t]?r[e][t]:r}catch(e){throw new u.PromotionApiModuleException(`PromotionApiModule: fetch error "${e.message}"`)}}))}parse(e){const t=[];let n=e.text;for(;;){const i=n.indexOf("#");if(-1===i){const e=this.makeElementText(n);t.push(e);break}const r=n.substr(0,i);if(""!==r){const e=this.makeElementText(r);t.push(e)}n=n.substr(i+1);const o=n.indexOf(" "),a=-1===o?n:n.substr(0,o);if(!e.links[a])throw new u.PromotionApiModuleException(`PromotionApiModule: a configuration for label "${a}" is not found`);const s=e.links[a];if(t.push(this.makeElementLink(s)),-1===o)break;n=n.substr(a.length)}return t}makeElementText(e){return{text:e,type:l.TEXT}}makeElementLink(e){return{link:e,type:l.LINK}}};d=i([s.injectable(),o(0,s.inject(c.PromotionApiModuleTypes._API)),r("design:paramtypes",[String])],d),t.PromotionService=d},83105:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationEvents=void 0,function(e){e.PROXY_LOCATION_BEFORE_ACTIVATED="LOCATION_PROXY_BEFORE_ACTIVATED",e.PROXY_LOCATION_AFTER_ACTIVATED="LOCATION_PROXY_AFTER_ACTIVATED",e.PROXY_LOCATION_BEFORE_DEACTIVATED="LOCATION_PROXY_BEFORE_DEACTIVATED",e.PROXY_LOCATION_AFTER_DEACTIVATED="LOCATION_PROXY_AFTER_DEACTIVATED"}(t.ProxyLocationEvents||(t.ProxyLocationEvents={}))},23359:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationException=void 0;class n extends Error{}t.ProxyLocationException=n},73344:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationModule=void 0;const r=n(18313),o=n(15035),a=n(93810),s=n(33770),c=n(34199);class u extends r.MarioModule{name(){return"ProxyLocationModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(r.MARIO_TYPES.PROXY_SERVICE,c.ProxyService),this.mario().registerService(o.ProxyLocationTypes.LOCATION_PROXY_SERVICE,a.ProxyLocationService),this.mario().registerService(o.ProxyLocationTypes.LOCATION_HELPER_SERVICE,s.LocationHelper)}))}}t.ProxyLocationModule=u},15035:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationTypes=void 0;const n={LOCATION_HELPER_SERVICE:Symbol.for("LOCATION_HELPER_SERVICE"),LOCATION_PROXY_SERVICE:Symbol.for("LOCATION_PROXY_SERVICE")};t.ProxyLocationTypes=n},53553:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationServiceException=void 0;class n extends Error{}t.ProxyLocationServiceException=n},80237:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocation=void 0;const i=n(10674),r=n(91397),o=n(21819),a=n(32556),s=n(23359);class c{constructor(e,t,n,i="GENERIC",r=[],o={}){this._name=e,this._code=t,this._type=n,this._provider=i,this._proxyConfigList=r,this._extraData=o,this._children={},this._parent=null,this._head=null,this._tail=null,this._prev=null,this._next=null,this._length=0}[Symbol.iterator](){return new a.ProxyLocationIterator(this.head())}static create(e,t,n,o="GENERIC",a=[],s={}){return new c(new r.LocationName(e),new i.LocationCode(t),n,o,a,s)}encode(){return JSON.stringify(this)}static decode(e){const t=JSON.parse(e),n=Object.keys(t)[0];return c.prepareDecode(t[n])}static prepareDecode(e){const t=[];for(const n of e.location.configs)t.push(o.ProxyLocationConfig.create(n.host,n.port.from,n.port.to,n.scheme,n.redundancy,n.weight));const n=c.create(e.location.name,e.location.code,e.location.type,e.location.provider,t,e.location.extraData);for(const t in e.nodes)e.nodes.hasOwnProperty(t)&&n.append(this.prepareDecode(e.nodes[t]));return n}name(){return this._name}code(){return this._code}extraData(){return this._extraData}type(){return this._type}provider(){return this._provider}isType(e){return this._type===e}isProvider(e){return this._provider===e}parent(){return this._parent}hasLocation(e){return void 0!==this._children[e.value()]}getLocation(e){if(!this.hasLocation(e))throw new s.ProxyLocationException("ProxyLocation: could get location");return this._children[e.value()]}isRootNode(){return null===this._parent}append(e){if(this._head){const t=this._tail;t._next=e,e._prev=t,this._tail=e}else this._head=e,this._tail=e;this._children[e.code().value()]=e,e._parent=this,this._length+=1}configList(){return this._proxyConfigList}isEmpty(){return 0===this.length()}isNotEmpty(){return!this.isEmpty()}prev(){return this._prev}next(){return this._next}head(){return this._head}tail(){return this._tail}length(){return this._length}toJSON(){const e={};return this.prepareJSON(e,this),e}sort(){if(this.isNotEmpty())for(const e of this)e.sort();for(let e=0;e<this.length();e++)for(let e=0;e<this.length()-1;e++){const t=this.pos(e),n=t.next();t.name().value().toLocaleLowerCase()>n.name().value().toLocaleLowerCase()&&this.swap(e,e+1)}}pos(e){if(this.length()-1<e)throw new s.ProxyLocationException("Incorrect position");let t=0;for(const n of this){if(t===e)return n;t++}}remove(e){this.validatePosition(e);const t=this.pos(e);if(this._length+=-1,t._prev&&t._next){const e=t._prev,n=t._next;e._next=n,n._prev=e}else if(t._prev&&null===t._next){const e=t._prev;this._tail===t&&(this._tail=e),e._next=null}else if(null===t._prev&&t._next){const e=t._next;this._head===t&&(this._head=e),e._prev=null}else this._head=null,this._tail=null;return t._prev=null,t._next=null,t._parent=null,t}replace(e,t){this.validatePosition(e);const n=this.remove(e);return this.insert(e,t),n}insert(e,t){if(0===this.length()&&0===e)this.append(t);else if(this.length()===e)this.append(t);else{if(this.length()-1<e)throw new s.ProxyLocationException("Incorrect position");if(0===e){const n=this.pos(e);n._prev=t,t._next=n,this._head=t,this._length+=1}else{const n=this.pos(e);if(n._prev&&n._next){const e=n._prev;e._next=t,n._prev=t,t._next=n,t._prev=e}else if(n._prev&&null===n._next){const e=n._prev;t._next=n,t._prev=e,e._next=t,n._prev=t}this._length+=1}}t._parent=this}swap(e,t){if(this.length()-1<e||this.length()-1<t)throw new s.ProxyLocationException("Incorrect position");if(e===t)return;const n=e<t?e:t,i=e>t?e:t,r=this.pos(n),o=this.pos(i);this.remove(n),this.remove(i-1),this.insert(n,o),this.insert(i,r)}prepareJSON(e,t){const n=t.code().value();e[n]={location:{name:t.name().value(),code:t.code().value(),type:t.type(),provider:t.provider(),configs:[],extraData:t.extraData()},nodes:{}};const i=t.configList();for(const t of i)e[n].location.configs.push({host:t.host().value(),scheme:t.scheme().value(),port:{from:t.portRange().from(),to:t.portRange().to()},redundancy:t.redundancy().value(),weight:t.weight().value()});for(const i of t)this.prepareJSON(e[n].nodes,i)}validatePosition(e){if(this.length()<e||0>e)throw new s.ProxyLocationException("Incorrect position")}}t.ProxyLocation=c},21819:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationConfig=void 0;const i=n(75717),r=n(63269),o=n(15706),a=n(91329),s=n(10067);class c{constructor(e,t,n,i,r){this._host=e,this._portRange=t,this._scheme=n,this._redundancy=i,this._weight=r}static create(e,t,n,u,l,d){return new c(new i.ProxyHost(e),new r.ProxyPortRange(t,n),new a.ProxyScheme(u),new o.ProxyRedundancy(l),new s.ProxyWeight(d))}host(){return this._host}portRange(){return this._portRange}scheme(){return this._scheme}redundancy(){return this._redundancy}weight(){return this._weight}}t.ProxyLocationConfig=c},32556:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationIterator=void 0;t.ProxyLocationIterator=class{constructor(e){this.location=e}next(){const e=this.location;return this.location=this.location?this.location.next():null,{done:!Boolean(e),value:e}}}},33770:function(e,t,n){"use strict";var i,r=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationHelper=void 0;const o=n(86700);let a=i=class{getCountryName(e,t){return void 0===i.locations[e]?t:i.locations[e].countryName}getStateName(e,t,n){return void 0===i.locations[e]||void 0===i.locations[e].states||void 0===i.locations[e].states[t]?n:i.locations[e].states[t]}};a.locations={AF:{countryName:"Afghanistan"},AL:{countryName:"Albania"},DZ:{countryName:"Algeria"},AO:{countryName:"Angola"},AI:{countryName:"Anguilla"},AG:{countryName:"Antigua and Barbuda"},AR:{countryName:"Argentina"},AM:{countryName:"Armenia"},AW:{countryName:"Aruba"},AU:{countryName:"Australia"},AT:{countryName:"Austria"},AZ:{countryName:"Azerbaijan"},BS:{countryName:"Bahamas"},BH:{countryName:"Bahrain"},BD:{countryName:"Bangladesh"},BB:{countryName:"Barbados"},BY:{countryName:"Belarus"},BE:{countryName:"Belgium"},BZ:{countryName:"Belize"},BJ:{countryName:"Benin"},BO:{countryName:"Bolivia"},BA:{countryName:"Bosnia and Herzegovina"},BW:{countryName:"Botswana"},BR:{countryName:"Brazil"},BN:{countryName:"Brunei Darussalam"},BG:{countryName:"Bulgaria"},KH:{countryName:"Cambodia"},CM:{countryName:"Cameroon"},CA:{countryName:"Canada",states:{AB:"Alberta",BC:"British Columbia",MB:"Manitoba",NB:"New Brunswick",NL:"Newfoundland and Labrador",NS:"Nova Scotia",NT:"Northwest Territories",NU:"Nunavut",ON:"Ontario",PE:"Prince Edward Island",QC:"Québec",SK:"Saskatchewan",YT:"Yukon"}},CV:{countryName:"Cape Verde"},KY:{countryName:"Cayman Islands"},CL:{countryName:"Chile"},CN:{countryName:"China"},CO:{countryName:"Colombia"},KM:{countryName:"Comoros"},CG:{countryName:"Congo"},CR:{countryName:"Costa Rica"},HR:{countryName:"Croatia"},CY:{countryName:"Cyprus"},CZ:{countryName:"Czech Republic"},DK:{countryName:"Denmark"},DO:{countryName:"Dominican Republic"},EC:{countryName:"Ecuador"},EG:{countryName:"Egypt"},SV:{countryName:"El Salvador"},EE:{countryName:"Estonia"},ET:{countryName:"Ethiopia"},FI:{countryName:"Finland"},FR:{countryName:"France"},GE:{countryName:"Georgia"},GH:{countryName:"Ghana"},GR:{countryName:"Greece"},GP:{countryName:"Guadeloupe"},GT:{countryName:"Guatemala"},GY:{countryName:"Guyana"},HT:{countryName:"Haiti"},HN:{countryName:"Honduras"},HK:{countryName:"Hong Kong"},HU:{countryName:"Hungary"},IS:{countryName:"Iceland"},IN:{countryName:"India"},ID:{countryName:"Indonesia"},IR:{countryName:"Iran"},IQ:{countryName:"Iraq"},IE:{countryName:"Ireland"},IL:{countryName:"Israel"},IT:{countryName:"Italy"},CI:{countryName:"Ivory Coast"},JM:{countryName:"Jamaica"},JP:{countryName:"Japan"},JO:{countryName:"Jordan"},KZ:{countryName:"Kazakhstan"},KE:{countryName:"Kenya"},KR:{countryName:"Korea"},XK:{countryName:"Kosovo"},KW:{countryName:"Kuwait"},KG:{countryName:"Kyrgyzstan"},LA:{countryName:"Lao People's Democratic Republic"},LV:{countryName:"Latvia"},LB:{countryName:"Lebanon"},LY:{countryName:"Libyan Arab Jamahiriya"},LT:{countryName:"Lithuania"},LU:{countryName:"Luxembourg"},MO:{countryName:"Macau"},MK:{countryName:"Macedonia"},MG:{countryName:"Madagascar"},MY:{countryName:"Malaysia"},MV:{countryName:"Maldives"},ML:{countryName:"Mali"},MT:{countryName:"Malta"},MQ:{countryName:"Martinique"},MU:{countryName:"Mauritius"},MX:{countryName:"Mexico"},MD:{countryName:"Moldova"},MN:{countryName:"Mongolia"},ME:{countryName:"Montenegro"},MA:{countryName:"Morocco"},MZ:{countryName:"Mozambique"},MM:{countryName:"Myanmar"},NA:{countryName:"Namibia"},NP:{countryName:"Nepal"},NL:{countryName:"Netherlands"},NC:{countryName:"New Caledonia"},NZ:{countryName:"New Zealand"},NI:{countryName:"Nicaragua"},NG:{countryName:"Nigeria"},NO:{countryName:"Norway"},OM:{countryName:"Oman"},PK:{countryName:"Pakistan"},PS:{countryName:"Palestine"},PA:{countryName:"Panama"},PY:{countryName:"Paraguay"},PE:{countryName:"Peru"},PH:{countryName:"Philippines"},PL:{countryName:"Poland"},PT:{countryName:"Portugal"},PR:{countryName:"Puerto Rico"},QA:{countryName:"Qatar"},RE:{countryName:"Reunion"},RO:{countryName:"Romania"},LC:{countryName:"Saint Lucia"},VC:{countryName:"Saint Vincent and the Grenadines"},SA:{countryName:"Saudi Arabia"},SN:{countryName:"Senegal"},RS:{countryName:"Serbia"},SC:{countryName:"Seychelles"},SG:{countryName:"Singapore"},SK:{countryName:"Slovakia"},SI:{countryName:"Slovenia"},ZA:{countryName:"South Africa"},ES:{countryName:"Spain"},LK:{countryName:"Sri Lanka"},SD:{countryName:"Sudan"},SR:{countryName:"Suriname"},SE:{countryName:"Sweden"},CH:{countryName:"Switzerland"},SY:{countryName:"Syrian Arab Republic"},TW:{countryName:"Taiwan"},TZ:{countryName:"Tanzania"},TH:{countryName:"Thailand"},TT:{countryName:"Trinidad and Tobago"},TN:{countryName:"Tunisia"},TR:{countryName:"Turkey"},UG:{countryName:"Uganda"},UA:{countryName:"Ukraine"},AE:{countryName:"United Arab Emirates"},UY:{countryName:"Uruguay"},UZ:{countryName:"Uzbekistan"},VE:{countryName:"Venezuela"},VN:{countryName:"Vietnam"},YE:{countryName:"Yemen"},ZM:{countryName:"Zambia"},ZW:{countryName:"Zimbabwe"},DE:{countryName:"Germany",states:{BW:"Baden-Württemberg",BY:"Bayern",BE:"Berlin",BB:"Brandenburg",HB:"Bremen",HH:"Hamburg",HE:"Hessen",MV:"Mecklenburg-Vorpommern",NI:"Niedersachsen",NW:"Nordrhein-Westfalen",RP:"Rheinland-Pfalz",SL:"Saarland",SN:"Sachsen",ST:"Sachsen-Anhalt",SH:"Schleswig-Holstein",TH:"Thüringen"}},US:{countryName:"United States (USA)",states:{AZ:"Arizona",AL:"Alabama",AK:"Alaska",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",DC:"District Of Columbia",FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"}},US_FAST:{countryName:"United States (USA) FAST"},GB:{countryName:"United Kingdom (UK)",states:{}},RU:{countryName:"Russia",states:{}}},a=i=r([o.injectable()],a),t.LocationHelper=a},93810:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyLocationService=void 0;const s=n(86700),c=n(83105),u=n(18313),l=n(53553);let d=class{constructor(e,t){this.proxyService=e,this.internalDispatcher=t}setStrategy(e){this.strategy=e}onAuthRequired(e){this.proxyService.onAuthRequired(e)}activate(e,t=[]){return a(this,void 0,void 0,(function*(){this.checkStrategyOrThrowException(),yield this.emitBeforeActivateEvent(e,t);const n=yield this.strategy.selectProxy(e);this.activatedLocation=e,yield this.proxyService.connect(n,t),yield this.emitAfterActivateEvent(e,t)}))}selectProxy(e){return this.checkStrategyOrThrowException(),this.strategy.selectProxy(e)}deactivate(){return a(this,void 0,void 0,(function*(){if(!this.hasActivated())throw new l.ProxyLocationServiceException("ProxyLocationService: no active location");const e=this.activatedLocation;yield this.emitBeforeDeactivateEvent(e),this.activatedLocation=null,yield this.proxyService.direct(),yield this.emitAfterDeactivateEvent(e)}))}hasActivated(){return!!this.activatedLocation}canBeActivated(e){return this.checkStrategyOrThrowException(),this.strategy.canBeActivated(e)}getActivated(){if(!this.hasActivated())throw new l.ProxyLocationServiceException("ProxyLocationService: no active location");return this.activatedLocation}checkStrategyOrThrowException(){if(!this.strategy)throw new l.ProxyLocationServiceException("ProxyLocationService: strategy is not set")}emitBeforeActivateEvent(e,t){return a(this,void 0,void 0,(function*(){const n={location:e,bypassList:t},i=new u.MarioEvent(c.ProxyLocationEvents.PROXY_LOCATION_BEFORE_ACTIVATED,n);yield this.internalDispatcher.emit(i)}))}emitAfterActivateEvent(e,t){return a(this,void 0,void 0,(function*(){const n={location:e,bypassList:t},i=new u.MarioEvent(c.ProxyLocationEvents.PROXY_LOCATION_AFTER_ACTIVATED,n);yield this.internalDispatcher.emit(i)}))}emitBeforeDeactivateEvent(e){return a(this,void 0,void 0,(function*(){const t=new u.MarioEvent(c.ProxyLocationEvents.PROXY_LOCATION_BEFORE_DEACTIVATED,e);yield this.internalDispatcher.emit(t)}))}emitAfterDeactivateEvent(e){return a(this,void 0,void 0,(function*(){const t=new u.MarioEvent(c.ProxyLocationEvents.PROXY_LOCATION_AFTER_DEACTIVATED,e);yield this.internalDispatcher.emit(t)}))}};d=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.PROXY_SERVICE)),o(1,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.ProxyLocationService=d},15530:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RedundancyWeightStrategy=void 0;const r=n(21819);t.RedundancyWeightStrategy=class{canBeActivated(e){const t={};this.groupByRedundancy(e,t);return Object.values(t).length>0}selectProxy(e){return i(this,void 0,void 0,(function*(){const t={};this.groupByRedundancy(e,t);const n=Object.values(t);n.sort(((e,t)=>e.redundancy-t.redundancy)),n.reverse();for(const e of n){const t=[];this.groupByWeight(e.configList,t);const n=this.calculateTotalWeight(t);if(0===n)continue;const i=this.randomNumber(1,n);return this.findProxy(i,t)}throw new Error(`RedundancyWeightStrategy: location "${e.name().value()}" can not be activated`)}))}groupByRedundancy(e,t){e.configList().forEach((e=>{const n=`_${e.redundancy().value()}`;t[n]||(t[n]={redundancy:e.redundancy().value(),configList:[]}),t[n].configList.push(r.ProxyLocationConfig.create(e.host().value(),e.portRange().from(),e.portRange().to(),e.scheme().value(),e.redundancy().value(),e.weight().value()))}));for(const n of e)this.groupByRedundancy(n,t)}groupByWeight(e,t){e.forEach((e=>{const n=e.portRange().to()-e.portRange().from()+1,i=t.length?t[t.length-1].to+1:1,r={from:i,to:i+e.weight().value()*n,proxyConfig:e};t.push(r)}))}calculateTotalWeight(e){return e.length?e[e.length-1].to:0}findProxy(e,t){const n=t.find((t=>t.from<=e&&t.to>=e)).proxyConfig,i=n.portRange();return{port:this.randomNumber(i.from(),i.to()),scheme:n.scheme().value(),host:n.host().value()}}randomNumber(e,t){return parseInt(Math.floor(Math.random()*(t-e+1)+e).toString(),10)}}},10674:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationCode=void 0;const i=n(98033);t.LocationCode=class{constructor(e){if(this.code=e,this.code=e.trim(),0===this.code.length)throw new i.LocationCodeEmptyException("code has to be not empty")}value(){return this.code}}},98033:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationCodeEmptyException=void 0;const i=n(23359);class r extends i.ProxyLocationException{}t.LocationCodeEmptyException=r},75717:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyHost=void 0;t.ProxyHost=class{constructor(e){this.host=e}value(){return this.host}}},91397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationName=void 0;const i=n(1225);t.LocationName=class{constructor(e){if(this.name=e,this.name=e.trim(),0===this.name.length)throw new i.LocationNameEmptyException("Name has to be not empty")}value(){return this.name}}},1225:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationNameEmptyException=void 0;const i=n(23359);class r extends i.ProxyLocationException{}t.LocationNameEmptyException=r},63269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyPortRange=void 0;const i=n(70843);t.ProxyPortRange=class{constructor(e,t){if(this._from=e,this._to=t,this.validate(this._from,"from"),this.validate(this._to,"to"),this._from>this._to){const n=`Proxy port range: incorrect range "from": ${e} "to": ${t}`;throw new i.ProxyPortRangeException(n)}}from(){return this._from}to(){return this._to}validate(e,t){const n=`Proxy port range: param "${t}" has to be a positive integer value`;if(e<0||!1===Number.isInteger(e))throw new i.ProxyPortRangeException(n)}}},70843:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyPortRangeException=void 0;class n extends Error{}t.ProxyPortRangeException=n},15706:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyRedundancy=void 0;t.ProxyRedundancy=class{constructor(e){this.redundancy=e}value(){return this.redundancy}}},91329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyScheme=void 0;t.ProxyScheme=class{constructor(e){this._scheme=e}value(){return this._scheme}}},10067:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyWeight=void 0;const i=n(46649),r=n(29074);t.ProxyWeight=class{constructor(e){if(this.weight=e,"number"!=typeof e)throw new r.ProxyWeightNotNumberException("weight must be a number");if(e<0)throw new i.ProxyWeightNegativeNumbException("weight must be positive number")}value(){return this.weight}}},46649:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyWeightNegativeNumbException=void 0;const i=n(23359);class r extends i.ProxyLocationException{}t.ProxyWeightNegativeNumbException=r},29074:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyWeightNotNumberException=void 0;const i=n(23359);class r extends i.ProxyLocationException{}t.ProxyWeightNotNumberException=r},10369:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlarmNames=void 0;t.AlarmNames={UPDATE_RULES_LIST:"UPDATE_RULES_LIST"}},54073:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SensitiveDataFilterModule=void 0;const r=n(18313),o=n(65215),a=n(61197),s=n(40795),c=n(98670),u=n(10369);class l extends r.MarioModule{name(){return"SensitiveDataFilterModule"}static use(e,t){return e.registerModule(l,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(a.SensitiveDataFilterTypes.SDF_PARAM_ENABLED).toConstantValue(!!e.enabled),this.mario().container().bind(a.SensitiveDataFilterTypes.SDF_PARAM_HOST).toConstantValue(e.host),this.mario().container().bind(a.SensitiveDataFilterTypes.SDF_PARAM_LOGGING).toConstantValue(!!e.logging),this.mario().container().bind(a.SensitiveDataFilterTypes.SDF_PARAM_RULES_UPDATE_INTERVAL).toConstantValue(e.rulesUpdateInterval),this.mario().registerService(a.SensitiveDataFilterTypes.SDF_SERVICE,s.SensitiveDataFilterService),yield this.mario().registerService(r.MARIO_TYPES.ALARM_SERVICE,o.AlarmService),yield this.mario().getService(a.SensitiveDataFilterTypes.SDF_SERVICE).init(),this.mario().internalDispatcher().on(c.UpdateRulesListEvent);const t={delayInMinutes:e.rulesUpdateInterval||1440,periodInMinutes:e.rulesUpdateInterval||1440};yield this.mario().getService(r.MARIO_TYPES.ALARM_SERVICE).create(t,u.AlarmNames.UPDATE_RULES_LIST)}))}}t.SensitiveDataFilterModule=l},61197:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SensitiveDataFilterTypes=void 0,t.SensitiveDataFilterTypes={SDF_PARAM_ENABLED:Symbol.for("SDF_PARAM_ENABLED"),SDF_PARAM_HOST:Symbol.for("SDF_PARAM_HOST"),SDF_PARAM_LOGGING:Symbol.for("SDF_PARAM_LOGGING"),SDF_PARAM_RULES_UPDATE_INTERVAL:Symbol.for("SDF_PARAM_RULES_UPDATE_INTERVAL"),SDF_SERVICE:Symbol.for("SDF_SERVICE")}},17824:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SensitiveDataFilterException=void 0;class n extends Error{}t.SensitiveDataFilterException=n},98670:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateRulesListEvent=void 0;const s=n(86700),c=n(14874),u=n(10369),l=n(61197),d=n(40795);let h=class{constructor(e){this.sensitiveDataFilterService=e}on(){return c.AlarmEvents.ALARM_ELAPSED}handle(e){return a(this,void 0,void 0,(function*(){e.data.name===u.AlarmNames.UPDATE_RULES_LIST&&this.sensitiveDataFilterService.updateRules()}))}};h=i([s.injectable(),o(0,s.inject(l.SensitiveDataFilterTypes.SDF_SERVICE)),r("design:paramtypes",[d.SensitiveDataFilterService])],h),t.UpdateRulesListEvent=h},40795:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SensitiveDataFilterService=void 0;const s=n(86700),c=n(18313),u=n(60707),l=n(61197),d=n(17824);let h=class{constructor(e,t,n,i){if(this.enabled=e,this.host=t,this.logging=n,this.logger=i,this.initialized=!1,"string"!=typeof this.host)throw new d.SensitiveDataFilterException("Server host is undefined");this.logging=!!this.logging,this.logger.log("SensitiveDataFilter: "+(this.enabled?"enabled":"disabled"))}init(){return a(this,void 0,void 0,(function*(){if(this.enabled)try{this.instance=new u.default({host:this.host,logging:this.logging}),yield this.instance.init(),this.initialized=!0}catch(e){this.logger.error(e)}}))}enable(){return a(this,void 0,void 0,(function*(){this.enabled=!0,this.initialized||(yield this.init())}))}disable(){return a(this,void 0,void 0,(function*(){this.enabled=!1}))}updateRules(){return a(this,void 0,void 0,(function*(){if(this.initialized)return this.instance.updateRules()}))}transformUrl(e){return this.enabled&&this.initialized?this.instance.transformUrl(e):e}transformTitle(e,t){return this.enabled&&this.initialized?this.instance.transformTitle(e,t):t}};h=i([s.injectable(),o(0,s.inject(l.SensitiveDataFilterTypes.SDF_PARAM_ENABLED)),o(1,s.inject(l.SensitiveDataFilterTypes.SDF_PARAM_HOST)),o(2,s.inject(l.SensitiveDataFilterTypes.SDF_PARAM_LOGGING)),o(3,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Boolean,String,Boolean,Object])],h),t.SensitiveDataFilterService=h},88376:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxySignature=void 0;t.ProxySignature=class{static buildKey(e){return`${e.scheme}://${e.host}:${e.port}`}}},32673:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaticProxiesApiModule=void 0;const i=n(18313),r=n(55154),o=n(71560);class a extends i.MarioModule{static use(e,t){return e.registerModule(a,t)}name(){return"StaticProxiesApiModule"}register(e){this.mario().container().bind(r.StaticProxiesApiTypes.STATIC_PROXIES_API_URL).toConstantValue(e.apiUrl),this.mario().container().bind(r.StaticProxiesApiTypes.STATIC_PROXIES_CLIENT_APP).toConstantValue(e.clientApp),this.mario().registerService(r.StaticProxiesApiTypes.STATIC_PROXIES_SERVICE,o.StaticProxiesService)}}t.StaticProxiesApiModule=a},55154:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaticProxiesApiTypes=void 0;const n={STATIC_PROXIES_API_URL:Symbol.for("STATIC_PROXIES_API_URL"),STATIC_PROXIES_CLIENT_APP:Symbol.for("STATIC_PROXIES_CLIENT_APP"),STATIC_PROXIES_SERVICE:Symbol.for("STATIC_PROXIES_SERVICE")};t.StaticProxiesApiTypes=n},71560:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StaticProxiesService=void 0;const s=n(86700),c=n(55154),u=n(80237),l=n(82730),d=n(37050),h=n(68385),f=n(21819),p=n(33770),_=n(15035),E=n(18313),y=n(88376),v=n(10674);let g=class{constructor(e,t,n,i,r){this.apiUrl=e,this.clientApp=t,this.httpClient=n,this.helper=i,this.logger=r}getAutoServer(e=!0){var t,n,i,r,o,s;return a(this,void 0,void 0,(function*(){const a=yield this.request("/entrypoints/autoserver");if(!a.server)throw new h.StaticProxiesServiceException('Root element "server" is missed');const c=[],l={},d=null===(t=null==a?void 0:a.server)||void 0===t?void 0:t.signature;if(null===(i=null===(n=a.server)||void 0===n?void 0:n.address)||void 0===i?void 0:i.primary)try{const e=a.server.address.primary,t=this.mapToProxyLocationConfig(a.server,e,c.length);c.push(t);const n=this.mapToProxyLocationToProxyServer(t),i=y.ProxySignature.buildKey(n);l[i]=d}catch(e){this.logger.error(e)}return e&&(null===(s=null===(o=null===(r=null==a?void 0:a.server)||void 0===r?void 0:r.address)||void 0===o?void 0:o.secondary)||void 0===s?void 0:s.length)&&a.server.address.secondary.forEach((e=>{try{const t=this.mapToProxyLocationConfig(a.server,e,c.length);c.push(t);const n=this.mapToProxyLocationToProxyServer(t),i=y.ProxySignature.buildKey(n);l[i]=d}catch(e){this.logger.error(e)}})),u.ProxyLocation.create("AUTO_SERVER",a.server.country.code.iso2,"RANDOM","AUTO_SERVER",c,{signatureCollection:l})}))}getCountries(e=!0){return a(this,void 0,void 0,(function*(){const t=yield this.request("/entrypoints/countries");if(!t.countries)throw new h.StaticProxiesServiceException('Root element "countries" is missed');const n=u.ProxyLocation.create("ROOT","ROOT","ROOT");return t.countries.elements.forEach((t=>{var i,r;const o=[],a={};(null===(r=null===(i=t.servers)||void 0===i?void 0:i.elements)||void 0===r?void 0:r.length)&&t.servers.elements.forEach((n=>{var i,r,s;const c=n.signature;try{if(null===(i=n.address)||void 0===i?void 0:i.primary){const e=n.address.primary,t=this.mapToProxyLocationConfig(n,e,n.premium?1:0);o.push(t);const i=this.mapToProxyLocationToProxyServer(t),r=y.ProxySignature.buildKey(i);a[r]=c}}catch(e){this.logger.warn(`Could not get primary proxy for "${t.title}"`),this.logger.error(e)}e&&(null===(s=null===(r=n.address)||void 0===r?void 0:r.secondary)||void 0===s?void 0:s.length)&&n.address.secondary.forEach((e=>{try{const t=this.mapToProxyLocationConfig(n,e,n.premium?1:0);o.push(t);const i=this.mapToProxyLocationToProxyServer(t),r=y.ProxySignature.buildKey(i);a[r]=c}catch(t){this.logger.warn(`Could not get secondary proxy for "${e.host}"`),this.logger.error(t)}}))}));try{const e=this.helper.getCountryName(t.code.iso2,t.title),i=u.ProxyLocation.create(e,t.code.iso2,t.accessType,"GENERIC",o,{signatureCollection:a});n.append(i)}catch(e){this.logger.error(e)}})),n}))}getStreamingServices(e=!0){var t;return a(this,void 0,void 0,(function*(){const n=yield this.request("/entrypoints/streamingservers");if(!n.servers)throw new h.StaticProxiesServiceException('Root element "servers" is missed');const i=u.ProxyLocation.create("ROOT","ROOT","ROOT");return(null===(t=n.servers.elements)||void 0===t?void 0:t.length)&&n.servers.elements.forEach((t=>{var n,r,o;const a=[],s={},c=t.signature;try{if(null===(n=t.address)||void 0===n?void 0:n.primary){const e=t.address.primary,n=this.mapToProxyLocationConfig(t,e,a.length);a.push(n);const i=this.mapToProxyLocationToProxyServer(n),r=y.ProxySignature.buildKey(i);s[r]=c}}catch(e){this.logger.warn(`Could not get primary proxy for "${t.country.title}"`),this.logger.error(e)}e&&(null===(o=null===(r=t.address)||void 0===r?void 0:r.secondary)||void 0===o?void 0:o.length)&&t.address.secondary.forEach((e=>{try{const n=this.mapToProxyLocationConfig(t,e,a.length);a.push(n);const i=this.mapToProxyLocationToProxyServer(n),r=y.ProxySignature.buildKey(i);s[r]=c}catch(t){this.logger.warn(`Could not get secondary proxy for "${e.host}"`),this.logger.error(t)}}));try{const e="NETFLIX",n=["STREAMING_SERVICE",e,t.country.code.iso2].join("_");let r;if(i.hasLocation(new v.LocationCode(n))){const t=Array.from(i).findIndex((e=>e.code().value()===n)),o=u.ProxyLocation.decode(JSON.stringify(i.pos(t)));i.remove(t),r=u.ProxyLocation.create(o.name().value(),o.code().value(),o.type(),o.provider(),o.configList().concat(a),{signatureCollection:Object.assign(o.extraData().signatureCollection,s),streamingServiceType:e})}else{const i=this.helper.getCountryName(t.country.code.iso2,t.name);r=u.ProxyLocation.create(i,n,t.accessType,"STREAMING_SERVICE",a,{signatureCollection:s,streamingServiceType:e})}i.append(r)}catch(e){this.logger.error(e)}})),i}))}request(e){const t=`${this.apiUrl}${e}`,n=new Headers;n.append("X-Client-App",this.clientApp),n.append("Accept","application/json"),n.append("pragma","no-cache"),n.append("cache-control","no-cache");const i={headers:n};return this.httpClient.get(t,i)}mapToProxyLocationConfig(e,t,n){return f.ProxyLocationConfig.create(t.host,t.port,t.port,"http",n,e.weight)}mapToProxyLocationToProxyServer(e){return{host:e.host().value(),port:e.portRange().from(),scheme:e.scheme().value()}}};g=i([s.injectable(),o(0,s.inject(c.StaticProxiesApiTypes.STATIC_PROXIES_API_URL)),o(1,s.inject(c.StaticProxiesApiTypes.STATIC_PROXIES_CLIENT_APP)),o(2,s.inject(d.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(3,s.inject(_.ProxyLocationTypes.LOCATION_HELPER_SERVICE)),o(4,s.inject(E.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[String,String,l.HttpClient,p.LocationHelper,Object])],g),t.StaticProxiesService=g},68385:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StaticProxiesServiceException=void 0;class n extends Error{}t.StaticProxiesServiceException=n},66969:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlsSafeCheckEvents=void 0,function(e){e.SAFE_STATUS_UPDATED="URLS_SAFE_CHECK__STATUS_UPDATED",e.GET_ACTIVE_TAB_STATE="URLS_SAFE_CHECK__GET_ACTIVE_TAB_STATE",e.MUTE_NOTIFICATION="URLS_SAFE_CHECK__MUTE_NOTIFICATION",e.ENABLE_LIB="URLS_ENABLE_LIB",e.DISABLE_LIB="URLS_DISABLE_LIB"}(t.UrlsSafeCheckEvents||(t.UrlsSafeCheckEvents={}))},25174:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrlsSafeCheckModule=void 0;const r=n(18313),o=n(13990),a=n(70691),s=n(11444),c=n(18922),u=n(2325),l=n(37302),d=n(54073),h=n(42543),f=n(63654),p=n(17886),_=n(59464),E=n(98266),y=n(92010),v=n(1543),g=n(41251),S=n(84628),T=n(26854),O=n(5),m=n(60210),A=n(48047),R=n(68799),P=n(56906),I=n(76928);class N extends r.MarioModule{name(){return"UrlsSafeCheckModule"}static use(e,t){return e.registerModule(N,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(h.UrlsSafeCheckTypes.USC_ENDPOINT_DOMAIN).toConstantValue(e.apiUrl),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_PANALYTICS_ID).toConstantValue(e.panalyticsId),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_PINSTANCE_ID).toConstantValue(e.pinstanceId),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_PARTNER_ID).toConstantValue(e.partnerId),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_DISTRIBUTOR_ID).toConstantValue(e.distributorId),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_ENABLED).toConstantValue(!!e.enabled),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_MODE).toConstantValue(e.mode),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_TRACK_LOADING_STATE).toConstantValue(e.trackLoadingState),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_COMPRESS_REQUEST).toConstantValue(!!e.compressRequest),this.mario().container().bind(h.UrlsSafeCheckTypes.USC_LOGGING).toConstantValue(!!e.logging),this.mario().registerService(h.UrlsSafeCheckTypes.USC_LOGGER,I.UscLogger),this.mario().registerService(r.MARIO_TYPES.TAB_SERVICE,u.TabService),this.mario().registerService(r.MARIO_TYPES.NAVIGATION_SERVICE,l.NavigationService),this.mario().registerService(r.MARIO_TYPES.STORAGE_SERVICE,r.StorageService),this.mario().registerService(h.UrlsSafeCheckTypes.USC_STATE_SERVICE,f.StateService),this.mario().registerService(h.UrlsSafeCheckTypes.USC_STATE_DATA_SERVICE,E.StateDataService),this.mario().registerService(h.UrlsSafeCheckTypes.USC_CHECK_SERVICE,p.CheckSafeService),this.mario().registerService(h.UrlsSafeCheckTypes.USC_REQUEST_SERVICE,_.RequestService);const t={logging:!!e.logging};yield this.mario().registerModule(m.TabStateModule,t);const n={distributorId:e.distributorId,enabled:!!e.enabled,logging:!!e.logging,panalyticsId:e.panalyticsId,partnerId:e.partnerId,pinstanceId:e.pinstanceId};yield this.mario().registerModule(y.FgNavModule,n);const i={distributorId:e.distributorId,enabled:!!e.enabled,logging:!!e.logging,panalyticsId:e.panalyticsId,partnerId:e.partnerId,pinstanceId:e.pinstanceId};yield this.mario().registerModule(v.BgNavModule,i);const N={enabled:!!e.sensitiveDataCheckEnabled,host:e.sensitiveDataApiUrl,logging:!1};yield this.mario().registerModule(d.SensitiveDataFilterModule,N),this.mario().registerService(h.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE,P.LibStateService),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnActivated(),this.mario().externalDispatcher().on(s.GetActiveTabStateEventListener),this.mario().externalDispatcher().on(c.MuteNotificationEventListener),this.mario().internalDispatcher().on(o.TabActivated),this.mario().internalDispatcher().on(a.TabRemoved),this.mario().internalDispatcher().on(g.FgNavStarted),this.mario().internalDispatcher().on(S.FgNavCommited),this.mario().internalDispatcher().on(T.BgNavStarted),this.mario().internalDispatcher().on(O.BgNavCommited),this.mario().internalDispatcher().on(A.EnableLib),this.mario().internalDispatcher().on(R.DisableLib)}))}}t.UrlsSafeCheckModule=N},42543:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODE=t.STATUS=t.UrlsSafeCheckTypes=void 0,t.UrlsSafeCheckTypes={USC_STATE_SERVICE:Symbol.for("USC_STATE_SERVICE"),USC_CHECK_SERVICE:Symbol.for("USC_CHECK_SERVICE"),USC_REQUEST_SERVICE:Symbol.for("USC_REQUEST_SERVICE"),USC_STATE_DATA_SERVICE:Symbol.for("USC_STATE_DATA_SERVICE"),USC_LIB_STATE_SERVICE:Symbol.for("USC_LIB_STATE_SERVICE"),USC_ENABLED:Symbol.for("USC_ENABLED"),USC_MODE:Symbol.for("USC_MODE"),USC_ENDPOINT_DOMAIN:Symbol.for("USC_ENDPOINT_DOMAIN"),USC_PANALYTICS_ID:Symbol.for("USC_PANALYTICS_ID"),USC_PINSTANCE_ID:Symbol.for("USC_PINSTANCE_ID"),USC_PARTNER_ID:Symbol.for("USC_PARTNER_ID"),USC_DISTRIBUTOR_ID:Symbol.for("USC_DISTRIBUTOR_ID"),USC_TRACK_LOADING_STATE:Symbol.for("USC_TRACK_LOADING_STATE"),USC_COMPRESS_REQUEST:Symbol.for("USC_COMPRESS_REQUEST"),USC_LOGGING:Symbol.for("USC_LOGGING"),USC_LOGGER:Symbol.for("USC_LOGGER")},function(e){e.NONE="NONE",e.SAFE="SAFE",e.UNSAFE="UNSAFE",e.UNKNOWN="UNKNOWN"}(t.STATUS||(t.STATUS={})),function(e){e.NO_NAVIGATION="NO_NAVIGATION",e.FOREGROUND_NAVIGATION="FOREGROUND_NAVIGATION",e.FULL_NAVIGATION="FULL_NAVIGATION"}(t.MODE||(t.MODE={}))},84365:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankPage=void 0,t.blankPage={CHROME_BROWSER:"chrome://newtab/",FIREFOX_BROWSER:"about:blank",EDGE_BROWSER:"edge://newtab/"}},93621:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteListProtocols=void 0,t.whiteListProtocols=["chrome:","chrome-search:","chrome-devtools","about:","edge:"]},68442:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSafeException=void 0;class n extends Error{}t.CheckSafeException=n},80032:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function r(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),i=0,r=t.length;i<r;i++){var a=t.charCodeAt(i);n[2*i]=a>>>8,n[2*i+1]=a%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=new Array(t.length/2),i=0,r=n.length;i<r;i++)n[i]=256*t[2*i]+t[2*i+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var i,r,o,a={},s={},c="",u="",l="",d=2,h=3,f=2,p=[],_=0,E=0;for(o=0;o<e.length;o+=1)if(c=e.charAt(o),Object.prototype.hasOwnProperty.call(a,c)||(a[c]=h++,s[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(a,u))l=u;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<f;i++)_<<=1,E==t-1?(E=0,p.push(n(_)),_=0):E++;for(r=l.charCodeAt(0),i=0;i<8;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}else{for(r=1,i=0;i<f;i++)_=_<<1|r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r=0;for(r=l.charCodeAt(0),i=0;i<16;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++),a[u]=h++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<f;i++)_<<=1,E==t-1?(E=0,p.push(n(_)),_=0):E++;for(r=l.charCodeAt(0),i=0;i<8;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}else{for(r=1,i=0;i<f;i++)_=_<<1|r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r=0;for(r=l.charCodeAt(0),i=0;i<16;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++)}for(r=2,i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;for(;;){if(_<<=1,E==t-1){p.push(n(_));break}E++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,i){var r,o,a,s,c,u,l,d=[],h=4,f=4,p=3,_="",E=[],y={val:i(0),position:n,index:1};for(r=0;r<3;r+=1)d[r]=r;for(a=0,c=Math.pow(2,2),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 2:return""}for(d[3]=l,o=l,E.push(l);;){if(y.index>t)return"";for(a=0,c=Math.pow(2,p),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[f++]=e(a),l=f-1,h--;break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[f++]=e(a),l=f-1,h--;break;case 2:return E.join("")}if(0==h&&(h=Math.pow(2,p),p++),d[l])_=d[l];else{if(l!==f)return null;_=o+o.charAt(0)}E.push(_),d[f++]=o+_.charAt(0),o=_,0==--h&&(h=Math.pow(2,p),p++)}}};return o}();t.default=n},20929:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.generateUIID=t.isSameDomain=t.getDomain=t.getBrowserBlankPageUrl=t.isBlankPage=t.isWhiteListUrl=t.notConcurrent=t.valueToPromise=void 0;const r=n(93621),o=n(84365);function a(){return o.blankPage.FIREFOX_BROWSER||"about:blank"}function s(e){try{const{host:t}=new URL(e);return t}catch(t){return e}}t.valueToPromise=function(e){return new Promise((t=>{t(e)}))},t.notConcurrent=function(e){let t=!1;return()=>(t||(t=(()=>i(this,void 0,void 0,(function*(){try{return yield e()}finally{t=!1}})))()),t)},t.isWhiteListUrl=function(e){if(""===e)return!0;const{protocol:t}=new URL(e);return r.whiteListProtocols.includes(t)},t.isBlankPage=function(e){return e===a()},t.getBrowserBlankPageUrl=a,t.getDomain=s,t.isSameDomain=function(e,t){if(e&&t)return s(e)===s(t)},t.generateUIID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},11444:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GetActiveTabStateEventListener=void 0;const s=n(86700),c=n(63654),u=n(66969),l=n(42543);let d=class{constructor(e){this.stateService=e}on(){return u.UrlsSafeCheckEvents.GET_ACTIVE_TAB_STATE}handle(e,t,n){return a(this,void 0,void 0,(function*(){const e=yield this.stateService.getActiveTabState();n(e)}))}};d=i([s.injectable(),o(0,s.inject(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[c.StateService])],d),t.GetActiveTabStateEventListener=d},18922:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MuteNotificationEventListener=void 0;const s=n(86700),c=n(63654),u=n(66969),l=n(42543);let d=class{constructor(e){this.stateService=e}on(){return u.UrlsSafeCheckEvents.MUTE_NOTIFICATION}handle(e,t,n){return a(this,void 0,void 0,(function*(){if(t.tab){const{persist:n}=e.data;this.stateService.muteTabNofitication(t.tab.id,n)}n(void 0)}))}};d=i([s.injectable(),o(0,s.inject(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[c.StateService])],d),t.MuteNotificationEventListener=d},5:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BgNavCommited=void 0;const s=n(86700),c=n(42543),u=n(63654),l=n(13727);let d=class{constructor(e){this.stateService=e}on(){return l.BgNavEvents.NAVIGATION_COMMITED}handle(e){return a(this,void 0,void 0,(function*(){yield this.stateService.onBgNavCommited(e.data)}))}};d=i([s.injectable(),o(0,s.inject(c.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.BgNavCommited=d},26854:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BgNavStarted=void 0;const s=n(86700),c=n(42543),u=n(63654),l=n(13727);let d=class{constructor(e){this.stateService=e}on(){return l.BgNavEvents.NAVIGATION_STARTED}handle(e){return a(this,void 0,void 0,(function*(){yield this.stateService.onBgNavStarted(e.data)}))}};d=i([s.injectable(),o(0,s.inject(c.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.BgNavStarted=d},68799:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DisableLib=void 0;const s=n(86700),c=n(66969),u=n(24198),l=n(90392),d=n(63654),h=n(42543);let f=class{constructor(e,t){this.bgStateService=e,this.usfStateService=t}on(){return c.UrlsSafeCheckEvents.DISABLE_LIB}handle(e){return a(this,void 0,void 0,(function*(){this.bgStateService.disable(),yield this.usfStateService.disable()}))}};f=i([s.injectable(),o(0,s.inject(u.BgNavTypes.STATE_SERVICE)),o(1,s.inject(h.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[l.StateService,d.StateService])],f),t.DisableLib=f},48047:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EnableLib=void 0;const s=n(86700),c=n(66969),u=n(24198),l=n(90392),d=n(63654),h=n(42543);let f=class{constructor(e,t,n){this.bgStateService=e,this.uscStateService=t,this.mode=n}on(){return c.UrlsSafeCheckEvents.ENABLE_LIB}handle(e){return a(this,void 0,void 0,(function*(){yield this.uscStateService.enable(),this.mode===h.MODE.FULL_NAVIGATION&&this.bgStateService.enable()}))}};f=i([s.injectable(),o(0,s.inject(u.BgNavTypes.STATE_SERVICE)),o(1,s.inject(h.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(2,s.inject(h.UrlsSafeCheckTypes.USC_MODE)),r("design:paramtypes",[l.StateService,d.StateService,String])],f),t.EnableLib=f},84628:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FgNavCommited=void 0;const s=n(86700),c=n(42543),u=n(63654),l=n(95535);let d=class{constructor(e){this.stateService=e}on(){return l.FgNavEvents.NAVIGATION_COMMITED}handle(e){return a(this,void 0,void 0,(function*(){yield this.stateService.onFgNavCommited(e.data)}))}};d=i([s.injectable(),o(0,s.inject(c.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.FgNavCommited=d},41251:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FgNavStarted=void 0;const s=n(86700),c=n(42543),u=n(63654),l=n(95535);let d=class{constructor(e){this.stateService=e}on(){return l.FgNavEvents.NAVIGATION_STARTED}handle(e){return a(this,void 0,void 0,(function*(){yield this.stateService.onFgNavStarted(e.data)}))}};d=i([s.injectable(),o(0,s.inject(c.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.FgNavStarted=d},13990:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabActivated=void 0;const s=n(86700),c=n(54674),u=n(42543),l=n(63654);let d=class{constructor(e){this.stateService=e}on(){return c.TabServiceEvents.ON_TAB_ACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){const e=yield this.stateService.getActiveTabState();e&&(yield this.stateService.updateTabSafetyStatus(e))}))}};d=i([s.injectable(),o(0,s.inject(u.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[l.StateService])],d),t.TabActivated=d},70691:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabRemoved=void 0;const s=n(86700),c=n(54674),u=n(42543),l=n(63654);let d=class{constructor(e){this.stateService=e}on(){return c.TabServiceEvents.ON_TAB_REMOVED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.tabId;this.stateService.removeTabState(t)}))}};d=i([s.injectable(),o(0,s.inject(u.UrlsSafeCheckTypes.USC_STATE_SERVICE)),r("design:paramtypes",[l.StateService])],d),t.TabRemoved=d},71178:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabState=void 0;const i=n(42543),r=n(20929);t.TabState=class{constructor(){this.url="",this.lastUrl="",this.checked=!1,this.notificationMuted=!1,this.status=i.STATUS.NONE,this._loading=!1,this._checking=!1,this.fgNavData={},this.bgNavData=[]}setId(e){this.id=e}setUrl(e){this.url=e,this.domain=r.getDomain(e)}setLastUrl(e){this.lastUrl=e}setNotificationMute(e){this.notificationMuted=e}setLoadingState(e){this._loading=e}setCheckingState(e){this._checking=e}setCheckedState(e){this.checked=e}setStatus(e){this.status=e}setFgNavData(e){this.fgNavData=e}clearFgNavData(){this.fgNavData={}}hasFgNavData(){return!!Object.keys(this.fgNavData).length}getFgNavData(){return this.fgNavData}prependBgNavData(e){this.bgNavData.unshift(...e)}addBgNavData(e){this.bgNavData.push(e)}clearBgNavData(){this.bgNavData=[]}}},13727:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BgNavEvents=void 0,function(e){e.CONTENT_URL_REWRITED="BG_NAV__CONTENT_URL_REWRITED",e.NAVIGATION_STARTED="BGNAV__NAVIGATION_STARTED",e.NAVIGATION_COMMITED="BGNAV__NAVIGATION_COMMITED"}(t.BgNavEvents||(t.BgNavEvents={}))},1543:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BgNavModule=void 0;const r=n(18313),o=n(34861),a=n(2325),s=n(24198),c=n(74610),u=n(57849),l=n(54354),d=n(39379),h=n(69594),f=n(3158),p=n(79520),_=n(90392),E=n(40804),y=n(46218);class v extends r.MarioModule{name(){return"BgNavModule"}static use(e,t){return e.registerModule(v,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(s.BgNavTypes.PARAM_PANALYTICS_ID).toConstantValue(e.panalyticsId),this.mario().container().bind(s.BgNavTypes.PARAM_PINSTANCE_ID).toConstantValue(e.pinstanceId),this.mario().container().bind(s.BgNavTypes.PARAM_PARTNER_ID).toConstantValue(e.partnerId),this.mario().container().bind(s.BgNavTypes.PARAM_DISTRIBUTOR_ID).toConstantValue(e.distributorId),this.mario().container().bind(s.BgNavTypes.PARAM_ENABLED).toConstantValue(e.enabled),this.mario().container().bind(s.BgNavTypes.PARAM_LOGGING).toConstantValue(e.logging),this.mario().registerService(s.BgNavTypes.LOGGER,y.BgLogger),this.mario().registerService(r.MARIO_TYPES.WEB_REQUEST_SERVICE,o.WebRequestService),this.mario().registerService(r.MARIO_TYPES.TAB_SERVICE,a.TabService),this.mario().registerService(s.BgNavTypes.STATE_SERVICE,_.StateService),this.mario().registerService(s.BgNavTypes.DATA_SERVICE,E.DataService);const t={urls:["<all_urls>"]};this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnBeforeRequest(t),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnBeforeSendHeaders(t,["requestHeaders"]),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnSendHeaders(t,["requestHeaders"]),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnBeforeRedirect(t,["responseHeaders"]),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnResponseStarted(t,["responseHeaders"]),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnCompleted(t,["responseHeaders"]),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnErrorOccurred(t),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnCreated(),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnUpdated(),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnRemoved(),this.mario().internalDispatcher().on(c.OnBeforeRequest),this.mario().internalDispatcher().on(u.OnBeforeSendHeaders),this.mario().internalDispatcher().on(l.OnSendHeaders),this.mario().internalDispatcher().on(d.OnBeforeRedirect),this.mario().internalDispatcher().on(h.OnResponseStarted),this.mario().internalDispatcher().on(f.OnCompleted),this.mario().internalDispatcher().on(p.OnErrorOccurred)}))}}t.BgNavModule=v},24198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BgNavTypes=void 0,t.BgNavTypes={PARAM_ENABLED:Symbol.for("PARAM_ENABLED"),PARAM_PANALYTICS_ID:Symbol.for("PARAM_PANALYTICS_ID"),PARAM_PINSTANCE_ID:Symbol.for("PARAM_PINSTANCE_ID"),PARAM_PARTNER_ID:Symbol.for("PARAM_PARTNER_ID"),PARAM_DISTRIBUTOR_ID:Symbol.for("PARAM_DISTRIBUTOR_ID"),PARAM_LOGGING:Symbol.for("PARAM_LOGGING"),LOGGER:Symbol.for("BG_NAV_LOGGER"),STATE_SERVICE:Symbol.for("STATE_SERVICE"),DATA_SERVICE:Symbol.for("DATA_SERVICE")}},4890:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankPage=void 0,t.blankPage={CHROME_BROWSER:"chrome://newtab/",FIREFOX_BROWSER:"about:blank",EDGE_BROWSER:"edge://newtab/"}},77353:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteListProtocols=void 0,t.whiteListProtocols=["chrome:","chrome-search:","chrome-devtools","about:","edge:"]},46804:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.delay=t.getDomain=t.generateUIID=t.isSameOrigin=t.isSameDomain=t.getBrowserBlankPageUrl=t.isBlankPage=t.isWhiteListUrl=t.valueToPromise=void 0;const r=n(77353),o=n(4890);function a(){return o.blankPage.FIREFOX_BROWSER||"about:blank"}t.valueToPromise=function(e){return new Promise((t=>{t(e)}))},t.isWhiteListUrl=function(e){if(""===e)return!0;const{protocol:t}=new URL(e);return r.whiteListProtocols.includes(t)},t.isBlankPage=function(e){return e===a()},t.getBrowserBlankPageUrl=a,t.isSameDomain=function(e,t){if(e&&t)return new URL(e).host===new URL(t).host},t.isSameOrigin=function(e,t){return new URL(e).origin===new URL(t).origin},t.generateUIID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.getDomain=function(e){try{const{host:t}=new URL(e);return t}catch(t){return e}},t.delay=function(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}},39379:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnBeforeRedirect=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198);let d=class{constructor(e){this.bgStateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REDIRECT}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,{responseHeaders:n}=t,i=+t.requestId,r=this.bgStateService.getWebEvent(i);r&&(r.setFromResponse(t),n&&r.setResponseHeaders(n),this.bgStateService.finalize(r))}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.OnBeforeRedirect=d},74610:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnBeforeRequest=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198),d=n(46804);let h=class{constructor(e){this.bgStateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REQUEST}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,{tabId:n,url:i}=t,r=+t.requestId;d.isWhiteListUrl(i)||-1===n||this.bgStateService.addWebEvent(n,r)}))}};h=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],h),t.OnBeforeRequest=h},57849:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnBeforeSendHeaders=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198);let d=class{constructor(e){this.stateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_SEND_HEADERS}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,{requestHeaders:n}=t,i=+t.requestId,r=this.stateService.getWebEvent(i);r&&r.setRequestHeaders(n)}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.OnBeforeSendHeaders=d},3158:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnCompleted=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198);let d=class{constructor(e){this.bgStateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_COMPLETED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,n=+t.requestId,i=this.bgStateService.getWebEvent(n);i&&(i.setFromResponse(t),this.bgStateService.finalize(i))}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.OnCompleted=d},79520:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnErrorOccurred=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198);let d=class{constructor(e){this.bgStateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_ERROR_OCCURRED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,n=+t.requestId,i=this.bgStateService.getWebEvent(n);i&&(i.setFromResponse(t),this.bgStateService.finalize(i))}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.OnErrorOccurred=d},69594:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnResponseStarted=void 0;const s=n(86700),c=n(76560),u=n(90392),l=n(24198);let d=class{constructor(e){this.stateService=e}on(){return c.WebRequestServiceEvents.WEB_REQUEST_ON_RESPONSE_STARTED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.details,{responseHeaders:n}=t,i=+t.requestId,r=this.stateService.getWebEvent(i);r&&n&&r.setResponseHeaders(n)}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.STATE_SERVICE)),r("design:paramtypes",[u.StateService])],d),t.OnResponseStarted=d},54354:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OnSendHeaders=void 0;const a=n(86700),s=n(76560);let c=class{constructor(){}on(){return s.WebRequestServiceEvents.WEB_REQUEST_ON_SEND_HEADERS}handle(e){return o(this,void 0,void 0,(function*(){}))}};c=i([a.injectable(),r("design:paramtypes",[])],c),t.OnSendHeaders=c},88348:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEvent=void 0;const i=n(11462);class r{constructor(){this.requestHeaders=[],this.responseHeaders=[]}setFromResponse(e){e.method&&(this.requestMethod=e.method),e.url&&(this.url=e.url),e.tabId&&(this.tabId=e.tabId),e.ip&&(this.serverIp=e.ip),e.type&&(this.eventSubType=e.type,this.eventType=this.calcEventType()),void 0!==e.fromCache&&(this.responseIsFromCache=e.fromCache),e.redirectUrl&&(this.responseRedirectUrl=e.redirectUrl),e.statusCode&&(this.responseStatusCode=e.statusCode),e.statusLine&&(this.responseStatusLine=e.statusLine),void 0!==e.frameId&&(this.frameId=e.frameId),void 0!==e.parentFrameId&&(this.parentFrameId=e.parentFrameId),e.error&&(this.responseError=e.error)}setRequestHeaders(e){for(let t=0;t<e.length;t++){const n=e[t];this.requestHeaders.push({name:n.name,value:n.value})}}setResponseHeaders(e){for(let t=0;t<e.length;t++){const n=e[t];this.responseHeaders.push({name:n.name,value:n.value})}}setDocumentData(e){this.pageWindowName=e.windowName,this.pageDocumentTitle=e.title,this.pageDocumentReferrer=e.referrer}setPanalyticsData(e){this.panalyticsId=e.panalyticsId,this.pinstanceId=e.pinstanceId,this.partnerId=e.partnerId,this.distributorId=e.distributorId}setDomData(e){this.pageDomData=e}setSystemData(e){this.requestOs=e.name,this.requestOsVersion=e.version}setBowserData(e){this.requestBrowser=e.name,this.requestBrowserVersion=e.version}setNavigationSequence(e){this.navigationSequence=e}setSourceTabId(e){this.sourceTabId=e}setNavigationMethod(e){this.navigationMethod=e}setData(e){Object.assign(this,e)}getData(){return this}clone(){const e=new r;return Object.entries(this).forEach((([t,n])=>{this.hasOwnProperty(t)&&(e[t]=this[t])})),e}calcEventType(){return-1!==["main_frame","sub_frame"].indexOf(this.eventSubType)?i.EventType.MAIN:i.EventType.RESOURCE}}t.WebEvent=r},11462:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventType=t.NavigationMethod=void 0,function(e){e.REQUEST="request",e.URL_REWRITE="url_rewrite"}(t.NavigationMethod||(t.NavigationMethod={})),function(e){e.MAIN="main",e.RESOURCE="resource"}(t.EventType||(t.EventType={}))},40804:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataService=void 0;const s=n(86700),c=n(46804),u=n(10129),l=n(24198);let d=class{constructor(e,t,n,i){this.panalyticsId=e,this.pinstanceId=t,this.partnerId=n,this.distributorId=i}getPanalyticsData(){return a(this,void 0,void 0,(function*(){const e={panalyticsId:this.panalyticsId,pinstanceId:this.pinstanceId,partnerId:this.partnerId,distributorId:this.distributorId};return c.valueToPromise(e)}))}getSystemData(){return a(this,void 0,void 0,(function*(){return u.getOSVersion()}))}getBrowserData(){return a(this,void 0,void 0,(function*(){return u.getBrowserVersion()}))}getDocumentData(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.tabs.executeScript(e,{code:"[document.title, document.referrer, window.name]"},(e=>{if(!chrome.runtime.lastError&&e&&e[0]){const[n,i,r]=e[0];t({title:n,referrer:i,windowName:r})}else n("error retrieving document data")}))}))}))}getDomData(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.tabs.executeScript(e,{code:"[document.documentElement.innerHTML]"},(e=>{if(!chrome.runtime.lastError&&e&&e[0]){const[n]=e[0];t(n)}else n("error retrieving DOM data")}))}))}))}};d=i([s.injectable(),o(0,s.inject(l.BgNavTypes.PARAM_PANALYTICS_ID)),o(1,s.inject(l.BgNavTypes.PARAM_PINSTANCE_ID)),o(2,s.inject(l.BgNavTypes.PARAM_PARTNER_ID)),o(3,s.inject(l.BgNavTypes.PARAM_DISTRIBUTOR_ID)),r("design:paramtypes",[String,Number,Number,Number])],d),t.DataService=d},10129:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserVersion=t.getOSVersion=void 0,t.getOSVersion=function(){const e=navigator.appVersion,t=navigator.userAgent;let n="";const i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(let e in i){let r=i[e];if(r.r.test(t)){n=r.s;break}}let r;switch(/Windows/.test(n)&&(r=/Windows (.*)/.exec(n)[1],n="Windows"),n){case"Mac OS X":const n=/Mac OS X ([\.\_\d]+)/.exec(t);r=n?n[1]:"unknown";break;case"Android":r=/Android ([\.\_\d]+)/.exec(t)[1];break;case"iOS":r=/OS (\d+)_(\d+)_?(\d+)?/.exec(e),r=r[1]+"."+r[2]+"."+(0|r[3])}return{name:n,version:r}},t.getBrowserVersion=function(){let e,t="",n="0",i=navigator.userAgent+" ";if("5.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))&&-1!=i.indexOf("like Gecko")){e=i.substring(i.indexOf("like Gecko")+10).substring(i.substring(i.indexOf("like Gecko")+10).indexOf(") ")+2).replace("LG Browser","LGBrowser").replace("360SE","360SE/");for(let t=0;t<1;t++)e=e.replace(e.substring(e.indexOf("("),e.indexOf(")")+1),"");e=e.split(" ");for(let t=0;t<e.length;t++)-1==e[t].indexOf("/")&&(e[t]="Chrome"),-1!=e[t].indexOf("/")&&(e[t]=e[t].substring(0,e[t].indexOf("/")));if(e.length<4)t=e[0];else for(let n=0;n<e.length;n++)-1==e[n].indexOf("Chrome")&&-1==e[n].indexOf("Safari")&&-1==e[n].indexOf("Mobile")&&-1==e[n].indexOf("Version")&&(t=e[n]);n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))}else"5.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))&&-1!=i.indexOf("Gecko/")?(t=i.substring(i.substring(i.indexOf("Gecko/")+6).indexOf(" ")+i.indexOf("Gecko/")+6).substring(0,i.substring(i.substring(i.indexOf("Gecko/")+6).indexOf(" ")+i.indexOf("Gecko/")+6).indexOf("/")),n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):"5.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))&&-1!=i.indexOf("Clecko/")?(t=i.substring(i.substring(i.indexOf("Clecko/")+7).indexOf(" ")+i.indexOf("Clecko/")+7).substring(0,i.substring(i.substring(i.indexOf("Clecko/")+7).indexOf(" ")+i.indexOf("Clecko/")+7).indexOf("/")),n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):"5.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))?(t=i.substring(i.indexOf("(")+1,i.indexOf(";")),n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):"4.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))&&i.indexOf(")")+1==i.length-1?t=i.substring(i.indexOf("(")+1,i.indexOf(")")).split("; ")[i.substring(i.indexOf("(")+1,i.indexOf(")")).split("; ").length-1]:"4.0"==i.substring(i.indexOf("Mozilla/")+8,i.indexOf(" "))&&i.indexOf(")")+1!=i.length-1?(-1!=i.substring(i.indexOf(") ")+2).indexOf("/")&&(t=i.substring(i.indexOf(") ")+2,i.indexOf(") ")+2+i.substring(i.indexOf(") ")+2).indexOf("/"))),-1==i.substring(i.indexOf(") ")+2).indexOf("/")&&(t=i.substring(i.indexOf(") ")+2,i.indexOf(") ")+2+i.substring(i.indexOf(") ")+2).indexOf(" "))),n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):"Opera/"==i.substring(0,6)?(t="Opera",n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):"Mozilla"!=i.substring(0,i.indexOf("/"))&&"Opera"!=i.substring(0,i.indexOf("/"))?(t=i.substring(0,i.indexOf("/")),n=i.substring(i.indexOf(t)+t.length+1,i.indexOf(t)+t.length+1+i.substring(i.indexOf(t)+t.length+1).indexOf(" "))):t=i;return{name:t,version:n}}},46218:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BgLogger=void 0;const a=n(86700),s=n(24198);let c=class{constructor(e){this.logging=e}log(e,t){this.logging}};c=i([a.injectable(),o(0,a.inject(s.BgNavTypes.PARAM_LOGGING)),r("design:paramtypes",[Boolean])],c),t.BgLogger=c},90392:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StateService=void 0;const s=n(86700),c=n(18313),u=n(88348),l=n(24198),d=n(40804),h=n(63442),f=n(46804),p=n(13727),_=n(11462),E=n(77e3),y=n(32879),v=n(46218);let g=class{constructor(e,t,n,i,r){this.internalDispatcher=e,this._enabled=t,this.bgDataService=n,this.tabStateService=i,this.logger=r,this.webEvents=[],this.enabled=this._enabled}enable(){this.enabled=!0}disable(){this.enabled=!1}isEnabled(){return this.enabled}getWebEvent(e){return this.webEvents.find((t=>t.requestId===e))}addWebEvent(e,t){const n=new u.WebEvent,i=h.Guid.create().toString();return this.logger.log(`addWebEvent: tabId=${e}, requestId=${t}, eventId=${i}`),n.setData({eventId:i,requestId:t,tabId:e}),this.webEvents.push(n),this.emitNavBgStartedEvent(n),n}finalize(e){return a(this,void 0,void 0,(function*(){this.logger.log(`finalize: ${e.url}`);const t=e.clone();this.removeWebEvent(e.requestId);const n=t.tabId;yield f.delay(100);const i=this.tabStateService.getTabState(n);if(!i||i.isBrowserServiceUrl)return void this.logger.log("bgStateService: ignored finalize event");const r=yield this.bgDataService.getSystemData(),o=yield this.bgDataService.getBrowserData(),a=yield this.bgDataService.getPanalyticsData();if(t.setData({timeStamp:Date.now().toString()}),t.setSystemData(r),t.setBowserData(o),t.setPanalyticsData(a),n>=0){try{const e=yield this.bgDataService.getDocumentData(n);t.setDocumentData(e)}catch(e){}if("main_frame"===t.eventSubType){t.setData({eventId:i.sessionId});try{const e=yield this.bgDataService.getDomData(n);t.setDomData(e)}catch(e){}}"main_frame"===t.eventSubType&&i.navigationMethod!==_.NavigationMethod.URL_REWRITE||t.setData({mainFrameRequestEventId:i.sessionId})}i.sourceTabId&&t.setSourceTabId(i.sourceTabId),t.setNavigationMethod(i.navigationMethod||_.NavigationMethod.REQUEST),t.setNavigationSequence(i.navigationSequence),this.enabled&&(yield this.emitNavBgCommitedEvent(t))}))}removeWebEvent(e){const t=this.webEvents.findIndex((t=>t.requestId===e));-1!==t&&this.webEvents.splice(t,1)}emitNavBgStartedEvent(e){return a(this,void 0,void 0,(function*(){this.internalDispatcher.emit(new c.MarioEvent(p.BgNavEvents.NAVIGATION_STARTED,e))}))}emitNavBgCommitedEvent(e){return a(this,void 0,void 0,(function*(){yield this.internalDispatcher.emit(new c.MarioEvent(p.BgNavEvents.NAVIGATION_COMMITED,e))}))}};g=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(1,s.inject(l.BgNavTypes.PARAM_ENABLED)),o(2,s.inject(l.BgNavTypes.DATA_SERVICE)),o(3,s.inject(E.TabStateTypes.TAB_STATE_SERVICE)),o(4,s.inject(l.BgNavTypes.LOGGER)),r("design:paramtypes",[Object,Boolean,d.DataService,y.TabStateService,v.BgLogger])],g),t.StateService=g},95535:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FgNavEvents=void 0,function(e){e.CONTENT_URL_REWRITED="FGNAV__CONTENT_URL_REWRITED",e.NAVIGATION_STARTED="FGNAV__NAVIGATION_STARTED",e.NAVIGATION_COMMITED="FGNAV__NAVIGATION_COMMITED"}(t.FgNavEvents||(t.FgNavEvents={}))},92010:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FgNavModule=void 0;const r=n(18313),o=n(2325),a=n(37302),s=n(91909),c=n(3181),u=n(91134),l=n(14788),d=n(30403),h=n(49954),f=n(13486),p=n(21242);class _ extends r.MarioModule{name(){return"FgNavModule"}static use(e,t){return e.registerModule(_,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(s.FgNavTypes.FGNAV_PANALYTICS_ID).toConstantValue(e.panalyticsId),this.mario().container().bind(s.FgNavTypes.FGNAV_INSTANCE_ID).toConstantValue(e.pinstanceId),this.mario().container().bind(s.FgNavTypes.FGNAV_PARTNER_ID).toConstantValue(e.partnerId),this.mario().container().bind(s.FgNavTypes.FGNAV_DISTRIBUTOR_ID).toConstantValue(e.distributorId),this.mario().container().bind(s.FgNavTypes.FGNAV_ENABLED).toConstantValue(!!e.enabled),this.mario().container().bind(s.FgNavTypes.FGNAV_LOGGING).toConstantValue(!!e.logging),this.mario().registerService(s.FgNavTypes.FGNAV_LOGGER,p.FgLogger),this.mario().registerService(r.MARIO_TYPES.TAB_SERVICE,o.TabService),this.mario().registerService(r.MARIO_TYPES.NAVIGATION_SERVICE,a.NavigationService),this.mario().registerService(s.FgNavTypes.FGNAV_STATE_SERVICE,c.StateService),this.mario().registerService(s.FgNavTypes.FGNAV_DATA_SERVICE,u.DataService),this.mario().registerService(s.FgNavTypes.FGNAV_TAB_EVENTS_PROCESS_SERVICE,l.TabEventsProcessService),this.mario().registerService(s.FgNavTypes.FGNAV_QUEUE_SERVICE,d.QueueService),this.mario().internalDispatcher().on(h.TabStateLoading),this.mario().internalDispatcher().on(f.TabStateCompleted)}))}}t.FgNavModule=_},91909:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FgNavTypes=void 0,t.FgNavTypes={FGNAV_STATE_SERVICE:Symbol.for("FGNAV_STATE_SERVICE"),FGNAV_DATA_SERVICE:Symbol.for("FGNAV_DATA_SERVICE"),FGNAV_TAB_EVENTS_PROCESS_SERVICE:Symbol.for("FGNAV_TAB_EVENTS_PROCESS_SERVICE"),FGNAV_QUEUE_SERVICE:Symbol.for("FGNAV_QUEUE_SERVICE"),FGNAV_ENABLED:Symbol.for("FGNAV_ENABLED"),FGNAV_PANALYTICS_ID:Symbol.for("FGNAV_PANALYTICS_ID"),FGNAV_INSTANCE_ID:Symbol.for("FGNAV_INSTANCE_ID"),FGNAV_PARTNER_ID:Symbol.for("FGNAV_PARTNER_ID"),FGNAV_DISTRIBUTOR_ID:Symbol.for("FGNAV_DISTRIBUTOR_ID"),FGNAV_LOGGING:Symbol.for("FGNAV_LOGGING"),FGNAV_LOGGER:Symbol.for("FGNAV_LOGGER")}},87014:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankPage=void 0,t.blankPage={CHROME_BROWSER:"chrome://newtab/",FIREFOX_BROWSER:"about:blank",EDGE_BROWSER:"edge://newtab/"}},44642:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteListProtocols=void 0,t.whiteListProtocols=["chrome:","chrome-search:","chrome-devtools","about:","edge:"]},65064:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.delay=t.generateUIID=t.isSameOrigin=t.isSameDomain=t.getDomain=t.getBrowserBlankPageUrl=t.isBlankPage=t.isWhiteListUrl=t.notConcurrent=t.valueToPromise=void 0;const r=n(44642),o=n(87014);function a(){return o.blankPage.FIREFOX_BROWSER||"about:blank"}function s(e){try{const{host:t}=new URL(e);return t}catch(t){return e}}t.valueToPromise=function(e){return new Promise((t=>{t(e)}))},t.notConcurrent=function(e){let t=!1;return()=>(t||(t=(()=>i(this,void 0,void 0,(function*(){try{return yield e()}finally{t=!1}})))()),t)},t.isWhiteListUrl=function(e){if(""===e)return!0;const{protocol:t}=new URL(e);return r.whiteListProtocols.includes(t)},t.isBlankPage=function(e){return e===a()},t.getBrowserBlankPageUrl=a,t.getDomain=s,t.isSameDomain=function(e,t){if(e&&t)return s(e)===s(t)},t.isSameOrigin=function(e,t){return new URL(e).origin===new URL(t).origin},t.generateUIID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.delay=function(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}},13486:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateCompleted=void 0;const s=n(86700),c=n(14788),u=n(91909),l=n(34316),d=n(52955);let h=class{constructor(e){this.tabEventsProcessService=e}on(){return d.TabStateEvents.TAB_STATE_COMPLETED}handle(e){return a(this,void 0,void 0,(function*(){const{tabId:t,url:n}=e.data;this.tabEventsProcessService.process({type:l.TAB_EVENT_TYPE.COMPLETE,tabId:t,url:n,tabState:e.data})}))}};h=i([s.injectable(),o(0,s.inject(u.FgNavTypes.FGNAV_TAB_EVENTS_PROCESS_SERVICE)),r("design:paramtypes",[c.TabEventsProcessService])],h),t.TabStateCompleted=h},49954:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateLoading=void 0;const s=n(86700),c=n(14788),u=n(91909),l=n(34316),d=n(52955);let h=class{constructor(e){this.tabEventsProcessService=e}on(){return d.TabStateEvents.TAB_STATE_LOADING}handle(e){return a(this,void 0,void 0,(function*(){const{tabId:t,url:n}=e.data;this.tabEventsProcessService.process({type:l.TAB_EVENT_TYPE.LOADING,tabId:t,url:n,tabState:e.data})}))}};h=i([s.injectable(),o(0,s.inject(u.FgNavTypes.FGNAV_TAB_EVENTS_PROCESS_SERVICE)),r("design:paramtypes",[c.TabEventsProcessService])],h),t.TabStateLoading=h},36265:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebEvent=void 0;const i=n(65064);t.WebEvent=class{constructor(){this.url="",this.hasData=!1,this.navigationData={},this.documentData={},this.systemData={},this.panalyticsData={}}setTabId(e){this.tabId=e}setUrl(e){this.url=e,this.domain=i.getDomain(e)}setNavigationData(e){Object.assign(this.navigationData,e)}getNavigationData(){return this.navigationData}setDocumentData(e){Object.assign(this.documentData,e)}getDocumentData(){return this.documentData}setPanalyticsData(e){Object.assign(this.panalyticsData,e)}getPanalyticsData(){return this.panalyticsData}setSystemData(e){Object.assign(this.systemData,e)}getSystemData(){return this.systemData}}},32304:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationMethod=void 0,function(e){e.REQUEST="request",e.URL_REWRITE="url_rewrite"}(t.NavigationMethod||(t.NavigationMethod={}))},91134:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataService=void 0;const s=n(86700),c=n(65064),u=n(18313),l=n(9648),d=n(91909);let h=class{constructor(e,t,n,i,r){this.externalDispatcher=e,this.panalyticsId=t,this.pinstanceId=n,this.partnerId=i,this.distributorId=r}getPanalyticsData(){return a(this,void 0,void 0,(function*(){const e={panalyticsId:this.panalyticsId,pinstanceId:this.pinstanceId,partnerId:this.partnerId,distributorId:this.distributorId};return c.valueToPromise(e)}))}getSystemData(){return a(this,void 0,void 0,(function*(){return c.valueToPromise(l.getOSVersion())}))}getTabDocumentData(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{chrome.tabs.executeScript(e,{code:"[document.title, document.referrer, window.name]"},(e=>{if(!chrome.runtime.lastError&&e&&e[0]){const[n,i,r]=e[0];t({title:n,referrer:i,windowName:r})}else n()}))}))}))}};h=i([s.injectable(),o(0,s.inject(u.MARIO_TYPES.EXTERNAL_DISPATCHER)),o(1,s.inject(d.FgNavTypes.FGNAV_PANALYTICS_ID)),o(2,s.inject(d.FgNavTypes.FGNAV_INSTANCE_ID)),o(3,s.inject(d.FgNavTypes.FGNAV_PARTNER_ID)),o(4,s.inject(d.FgNavTypes.FGNAV_DISTRIBUTOR_ID)),r("design:paramtypes",[Object,String,Number,Number,Number])],h),t.DataService=h},9648:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOSVersion=void 0,t.getOSVersion=function(){const e=navigator.appVersion,t=navigator.userAgent;let n="";const i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(let e in i){let r=i[e];if(r.r.test(t)){n=r.s;break}}let r;switch(/Windows/.test(n)&&(r=/Windows (.*)/.exec(n)[1],n="Windows"),n){case"Mac OS X":const n=/Mac OS X ([\.\_\d]+)/.exec(t);r=n?n[1]:"unknown";break;case"Android":r=/Android ([\.\_\d]+)/.exec(t)[1];break;case"iOS":r=/OS (\d+)_(\d+)_?(\d+)?/.exec(e),r=r[1]+"."+r[2]+"."+(0|r[3])}return{name:n,version:r}}},21242:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.FgLogger=void 0;const a=n(86700),s=n(91909);let c=class{constructor(e){this.logging=e}log(e,t){this.logging}};c=i([a.injectable(),o(0,a.inject(s.FgNavTypes.FGNAV_LOGGING)),r("design:paramtypes",[Boolean])],c),t.FgLogger=c},30403:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.QueueService=void 0;const s=n(86700),c=n(91909),u=n(65064),l=n(21242);let d=class{constructor(e){this.logger=e,this.queue=[]}add(e,t,n){const i={id:u.generateUIID(),groupId:e,handler:n,params:t};this.queue.push(i)}process(e){return a(this,void 0,void 0,(function*(){if(this.queue.find((t=>t.groupId===e&&t.processing)))return;const t=this.queue.find((t=>t.groupId===e));if(!t)return;t.processing=!0;try{yield t.handler(t.params)}catch(e){this.logger.log(e)}const n=this.queue.findIndex((e=>e.id===t.id));this.queue.splice(n,1),setTimeout((()=>{this.process(e)}))}))}};d=i([s.injectable(),o(0,s.inject(c.FgNavTypes.FGNAV_LOGGER)),r("design:paramtypes",[l.FgLogger])],d),t.QueueService=d},3181:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StateService=void 0;const s=n(86700),c=n(36265),u=n(91909),l=n(21242);let d=class{constructor(e,t){this.enabled=e,this.logger=t,this.webEvents=[]}enable(){return a(this,void 0,void 0,(function*(){this.enabled=!0}))}disable(){return a(this,void 0,void 0,(function*(){this.enabled=!1}))}isEnabled(){return this.enabled}getWebEvent(e,t){return this.webEvents.find((n=>n.tabId===e&&n.url===t))}addWebEvent(e,t){this.getWebEvent(e,t)&&this.logger.log(`FgNavStateService: tab ${e} already exist, reusing`);const n=new c.WebEvent;return n.setTabId(e),n.setUrl(t),this.webEvents.push(n),n}removeWebEvent(e,t){const n=this.webEvents.findIndex((n=>n.tabId===e&&n.url===t));this.webEvents.splice(n,1)}};d=i([s.injectable(),o(0,s.inject(u.FgNavTypes.FGNAV_ENABLED)),o(1,s.inject(u.FgNavTypes.FGNAV_LOGGER)),r("design:paramtypes",[Boolean,l.FgLogger])],d),t.StateService=d},14788:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabEventsProcessService=void 0;const s=n(86700),c=n(3181),u=n(91134),l=n(30403),d=n(91909),h=n(34316),f=n(18313),p=n(95535),_=n(77e3),E=n(32879),y=n(32304),v=n(55296),g=n(65064);let S=class{constructor(e,t,n,i,r,o){this.internalDispatcher=e,this.queueService=t,this.fgStateService=n,this.fgDataService=i,this.tabStateService=r,this.logger=o}process(e){const t=e.tabId;switch(e.type){case h.TAB_EVENT_TYPE.LOADING:this.queueService.add(t,e,(()=>a(this,void 0,void 0,(function*(){yield this.processTabLoadingEvent(e)}))));break;case h.TAB_EVENT_TYPE.COMPLETE:this.queueService.add(t,e,(()=>a(this,void 0,void 0,(function*(){yield this.processTabCompleteEvent(e)}))))}this.queueService.process(e.tabId)}processTabLoadingEvent(e){return a(this,void 0,void 0,(function*(){const{tabId:t,url:n}=e,i=this.fgStateService.addWebEvent(t,n);i.setUrl(n),this.emitNavStartedEvent(i)}))}processTabCompleteEvent(e){return a(this,void 0,void 0,(function*(){const{tabId:t,url:n,tabState:i}=e;let r=this.fgStateService.getWebEvent(t,n);if(i.navigationMethod!==y.NavigationMethod.URL_REWRITE||i.isBrowserServiceUrl||(yield this.processTabLoadingEvent(e),r=this.fgStateService.getWebEvent(t,n)),!i||i.isBrowserServiceUrl||!r)return void this.logger.log("So we can`t handle this complete event");r.setNavigationData({frameId:0,parentFrameId:-1,method:i.navigationMethod,sequence:i.navigationSequence}),r.setSystemData(yield this.fgDataService.getSystemData()),r.setPanalyticsData(yield this.fgDataService.getPanalyticsData());try{i.navigationMethod===y.NavigationMethod.URL_REWRITE&&(yield g.delay(1100));const e=yield this.fgDataService.getTabDocumentData(t);r.setDocumentData(e),r.hasData=!0}catch(e){}r.setNavigationData({sourceTabId:i.sourceTabId});const o=this.copyEvent(r);this.fgStateService.removeWebEvent(t,n),this.emitNavCommitedEvent(o)}))}copyEvent(e){return JSON.parse(JSON.stringify(e))}emitNavStartedEvent(e){return a(this,void 0,void 0,(function*(){yield this.internalDispatcher.emit(new f.MarioEvent(p.FgNavEvents.NAVIGATION_STARTED,e))}))}emitNavCommitedEvent(e){return a(this,void 0,void 0,(function*(){yield this.internalDispatcher.emit(new f.MarioEvent(p.FgNavEvents.NAVIGATION_COMMITED,e))}))}};S=i([s.injectable(),o(0,s.inject(f.MARIO_TYPES.INTERNAL_DISPATCHER)),o(1,s.inject(d.FgNavTypes.FGNAV_QUEUE_SERVICE)),o(2,s.inject(d.FgNavTypes.FGNAV_STATE_SERVICE)),o(3,s.inject(d.FgNavTypes.FGNAV_DATA_SERVICE)),o(4,s.inject(_.TabStateTypes.TAB_STATE_SERVICE)),o(5,s.inject(_.TabStateTypes.LOGGER)),r("design:paramtypes",[Object,l.QueueService,c.StateService,u.DataService,E.TabStateService,v.TabStateLogger])],S),t.TabEventsProcessService=S},34316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TAB_EVENT_TYPE=void 0,function(e){e.ACTIVATE="ACTIVATE",e.LOADING="LOADING",e.COMPLETE="COMPLETE"}(t.TAB_EVENT_TYPE||(t.TAB_EVENT_TYPE={}))},52955:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateEvents=void 0,function(e){e.GET_NAVIGATION_METHOD_RESPONSE="GET_NAVIGATION_METHOD_RESPONSE",e.TAB_STATE_LOADING="TAB_STATE__LOADING",e.TAB_STATE_COMPLETED="TAB_STATE__COMPLETED",e.TAB_STATE__GET_NAVIGATION_METHOD="TAB_STATE__GET_NAVIGATION_METHOD"}(t.TabStateEvents||(t.TabStateEvents={}))},60210:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateModule=void 0;const r=n(18313),o=n(34861),a=n(2325),s=n(77e3),c=n(98480),u=n(67537),l=n(63982),d=n(32879),h=n(25827),f=n(55296);class p extends r.MarioModule{name(){return"TabStateModule"}static use(e,t){return e.registerModule(p,t)}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(s.TabStateTypes.PARAM_LOGGING).toConstantValue(e.logging),this.mario().registerService(s.TabStateTypes.LOGGER,f.TabStateLogger),this.mario().registerService(r.MARIO_TYPES.WEB_REQUEST_SERVICE,o.WebRequestService),this.mario().registerService(r.MARIO_TYPES.TAB_SERVICE,a.TabService),this.mario().registerService(s.TabStateTypes.TAB_STATE_SERVICE,d.TabStateService),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnCreated(),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnUpdated(),this.mario().getService(r.MARIO_TYPES.TAB_SERVICE).listenOnRemoved();const t={urls:["<all_urls>"]};this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnBeforeRequest(t),this.mario().getService(r.MARIO_TYPES.WEB_REQUEST_SERVICE).listenOnBeforeRedirect(t,["responseHeaders"]),this.mario().internalDispatcher().on(c.TabCreated),this.mario().internalDispatcher().on(l.TabUpdated),this.mario().internalDispatcher().on(u.TabRemoved),this.mario().externalDispatcher().on(h.GetNavigationMethodResponseListener)}))}}t.TabStateModule=p},77e3:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateTypes=void 0,t.TabStateTypes={LOGGER:Symbol.for("TAB_STATE_LOGGER"),PARAM_LOGGING:Symbol.for("TAB_STATE_PARAM_LOGGING"),TAB_STATE_SERVICE:Symbol.for("TAB_STATE_SERVICE")}},56884:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blankPage=void 0,t.blankPage={CHROME_BROWSER:"chrome://newtab/",FIREFOX_BROWSER:"about:blank",EDGE_BROWSER:"edge://newtab/"}},55881:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.whiteListProtocols=void 0,t.whiteListProtocols=["chrome:","chrome-search:","chrome-devtools","about:","edge:"]},77365:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationMethod=void 0,function(e){e.REQUEST="request",e.URL_REWRITE="url_rewrite"}(t.NavigationMethod||(t.NavigationMethod={}))},23387:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.delay=t.generateUIID=t.isSameOrigin=t.isSameDomain=t.getDomain=t.getBrowserBlankPageUrl=t.isBlankPage=t.isWhiteListUrl=t.notConcurrent=t.valueToPromise=void 0;const r=n(55881),o=n(56884);function a(){return o.blankPage.FIREFOX_BROWSER||"about:blank"}function s(e){try{const{host:t}=new URL(e);return t}catch(t){return e}}t.valueToPromise=function(e){return new Promise((t=>{t(e)}))},t.notConcurrent=function(e){let t=!1;return()=>(t||(t=(()=>i(this,void 0,void 0,(function*(){try{return yield e()}finally{t=!1}})))()),t)},t.isWhiteListUrl=function(e){if(""===e)return!0;const{protocol:t}=new URL(e);return r.whiteListProtocols.includes(t)},t.isBlankPage=function(e){return e===a()},t.getBrowserBlankPageUrl=a,t.getDomain=s,t.isSameDomain=function(e,t){if(e&&t)return s(e)===s(t)},t.isSameOrigin=function(e,t){return new URL(e).origin===new URL(t).origin},t.generateUIID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.delay=function(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}},25827:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GetNavigationMethodResponseListener=void 0;const s=n(86700),c=n(77e3),u=n(32879),l=n(52955);let d=class{constructor(e){this.stateService=e}on(){return l.TabStateEvents.GET_NAVIGATION_METHOD_RESPONSE}handle(e,t,n){return a(this,void 0,void 0,(function*(){t.tab&&this.stateService.onGetNavigationMethodResponse(t.tab,e.data)}))}};d=i([s.injectable(),o(0,s.inject(c.TabStateTypes.TAB_STATE_SERVICE)),r("design:paramtypes",[u.TabStateService])],d),t.GetNavigationMethodResponseListener=d},98480:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabCreated=void 0;const s=n(86700),c=n(54674),u=n(32879),l=n(77e3);let d=class{constructor(e){this.stateService=e}on(){return c.TabServiceEvents.ON_TAB_CREATED}handle(e){return a(this,void 0,void 0,(function*(){this.stateService.onTabCreated(e.data)}))}};d=i([s.injectable(),o(0,s.inject(l.TabStateTypes.TAB_STATE_SERVICE)),r("design:paramtypes",[u.TabStateService])],d),t.TabCreated=d},67537:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabRemoved=void 0;const s=n(86700),c=n(32879),u=n(77e3),l=n(54674);let d=class{constructor(e){this.stateService=e}on(){return l.TabServiceEvents.ON_TAB_REMOVED}handle(e){return a(this,void 0,void 0,(function*(){this.stateService.onTabRemoved(e.data)}))}};d=i([s.injectable(),o(0,s.inject(u.TabStateTypes.TAB_STATE_SERVICE)),r("design:paramtypes",[c.TabStateService])],d),t.TabRemoved=d},63982:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabUpdated=void 0;const s=n(86700),c=n(18313),u=n(77e3),l=n(54674),d=n(32879);let h=class{constructor(e,t){this.stateService=e,this.dispatcher=t}on(){return l.TabServiceEvents.ON_TAB_UPDATED}handle(e){return a(this,void 0,void 0,(function*(){this.stateService.onTabUpdated(e.data)}))}};h=i([s.injectable(),o(0,s.inject(u.TabStateTypes.TAB_STATE_SERVICE)),o(1,s.inject(c.MARIO_TYPES.EXTERNAL_DISPATCHER)),r("design:paramtypes",[d.TabStateService,Object])],h),t.TabUpdated=h},15816:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Tab=void 0;const r=n(63442),o=n(77365);t.Tab=class{constructor(){this.navigationSequence=0,this.urlRewriteWaitDelay=500}setTabId(e){this.tabId=e}setUrl(e){this.prevUrl=this.url,this.url=e}setSourceTabId(e){this.sourceTabId=e}setLastUpdated(e){this.lastUpdated=e}setLastStatus(e){this.lastStatus=e}setNavigationMethod(e){this.navigationMethod=e,this.ifNeedResolveNavigationMethod()}incNavigationSequence(){this.navigationSequence++}getNavigationSequence(){return this.navigationSequence}getNavigationMethod(){return this.navigationMethod}getSourceTabId(){return this.sourceTabId}getData(){return this}resetSession(){this.sessionId=r.Guid.create().toString(),this.navigationMethod=null}resetNavigationMethod(){this.navigationMethod=null}initNavigationMethod(){return i(this,void 0,void 0,(function*(){return this.ifNeedResolveNavigationMethod(),this.navigationMethod?Promise.resolve():new Promise((e=>{this.resolver=e,this.timerId=setTimeout((()=>{this.navigationMethod=o.NavigationMethod.REQUEST,e()}),this.urlRewriteWaitDelay)}))}))}toJSON(){return this.toDTO()}toDTO(){return{tabId:this.tabId,url:this.url,prevUrl:this.prevUrl,navigationMethod:this.navigationMethod,navigationSequence:this.navigationSequence,isBrowserServiceUrl:this.isBrowserServiceUrl,sourceTabId:this.sourceTabId,sessionId:this.sessionId,lastUpdated:this.lastUpdated,lastStatus:this.lastStatus}}ifNeedResolveNavigationMethod(){this.resolver&&(clearTimeout(this.timerId),this.timerId=null,this.resolver(),this.resolver=null)}}},55296:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateLogger=void 0;const a=n(86700),s=n(77e3);let c=class{constructor(e){this.logging=e}log(e,t){this.logging}};c=i([a.injectable(),o(0,a.inject(s.TabStateTypes.PARAM_LOGGING)),r("design:paramtypes",[Boolean])],c),t.TabStateLogger=c},32879:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TabStateService=void 0;const s=n(86700),c=n(18313),u=n(15816),l=n(77365),d=n(23387),h=n(52955),f=n(55296),p=n(77e3),_=n(10129);let E=class{constructor(e,t,n){this.internalDispatcher=e,this.externalDispatcher=t,this.logger=n,this.tabs=[],this.sameUrlUpdateThreshold=500,this.resetOpenerTabIdForNewNavigation=!1}onTabCreated(e){const{tab:t}=e,{id:n,openerTabId:i,url:r,pendingUrl:o}=t,a=this.addTabState(n),s=d.isBlankPage(o)?void 0:i;a.setUrl(r),a.setSourceTabId(s),this.logger.log(`TabStateService: tab create event, tabId: ${n}, url: "${r}", openedTabId: ${s}`)}onTabUpdated(e){const{tab:t,changeInfo:n}=e;if(!n.status)return;if("loading"===n.status&&!n.hasOwnProperty("url"))return;n.hasOwnProperty("url")&&this.emitGetNavMethodEvent(t.id);const{id:i,url:r}=t,{status:o}=n;this.logger.log(`TabStateService: tab update event (${n.status}), tabId: ${i}, url: ${r}`);const a=this.getTabStateOrCreate(i,r);this.isStateChanged(a,r,o)&&(a.setUrl(r),a.isBrowserServiceUrl=d.isWhiteListUrl(r)||d.isBlankPage(r),"loading"===o&&(a.resetSession(),this.logger.log(`TabStateService: url change/reload detected, tabId: ${i}, url: ${r}`),a.isBrowserServiceUrl||(a.incNavigationSequence(),this.logger.log(`TabStateService: tab navigation sequence incremented, tabId: ${a.tabId}, value: ${a.navigationSequence}`)),this.emitLoadingEvent(a)),a.setLastStatus(o),a.setLastUpdated(Date.now()),"complete"===o&&(this.emitCompleteEvent(a),this.resetOpenerTabIdForNewNavigation&&a.setSourceTabId(void 0)))}onGetNavigationMethodResponse(e,t){const{id:n,url:i}=e,r=this.getTabState(n);this.logger.log(`TabStateService: get nav method response, tabId: ${n}, url: ${i}`,t);const o=t.urlRewrite?l.NavigationMethod.URL_REWRITE:l.NavigationMethod.REQUEST;r.setNavigationMethod(o)}onTabRemoved(e){const{tabId:t}=e;this.removeTabState(t),this.logger.log(`TabStateService: tab remove event, tabId: ${t}`)}getTabState(e){return this.tabs.find((t=>t.tabId===e))}getTabStateOrCreate(e,t){let n=this.getTabState(e);return n||(this.logger.log(`TabStateService: adding tab, tabId: ${e}, url: ${t}`),n=this.addTabState(e)),n}addTabState(e){this.logger.log(`TabStateService: addTabState, tabId: ${e}`);const t=new u.Tab;return t.setTabId(e),t.resetSession(),this.tabs.push(t),t}removeTabState(e){const t=this.tabs.findIndex((t=>t.tabId===e));-1!==t&&this.tabs.splice(t,1)}isStateChanged(e,t,n){return e.url!==t||Date.now()-e.lastUpdated>this.sameUrlUpdateThreshold||e.lastStatus!==n}emitGetNavMethodEvent(e){return a(this,void 0,void 0,(function*(){this.logger.log("TabStateService: emit get nav method");const t=new c.MarioEvent(h.TabStateEvents.TAB_STATE__GET_NAVIGATION_METHOD);this.externalDispatcher.emit(e,t)}))}emitLoadingEvent(e){const t=e.toDTO();this.logger.log("TabStateService: emitting tabState event: loading",t),this.logger.log("***************************loading******************************",t),this.internalDispatcher.emit(new c.MarioEvent(h.TabStateEvents.TAB_STATE_LOADING,t))}emitCompleteEvent(e){return a(this,void 0,void 0,(function*(){if(e.isBrowserServiceUrl)return;yield e.initNavigationMethod(),e.getNavigationMethod()===l.NavigationMethod.URL_REWRITE&&"Firefox"===(yield this.getBrowserData()).name.trim()&&(e.incNavigationSequence(),yield this.emitLoadingEvent(e));const t=e.toDTO();e.resetNavigationMethod(),this.logger.log("TabStateService: emitting tabState event: completed",t),this.internalDispatcher.emit(new c.MarioEvent(h.TabStateEvents.TAB_STATE_COMPLETED,t))}))}getBrowserData(){return a(this,void 0,void 0,(function*(){return _.getBrowserVersion()}))}};E=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(1,s.inject(c.MARIO_TYPES.EXTERNAL_DISPATCHER)),o(2,s.inject(p.TabStateTypes.LOGGER)),r("design:paramtypes",[Object,Object,f.TabStateLogger])],E),t.TabStateService=E},17886:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSafeService=void 0;const s=n(86700),c=n(42543),u=n(59464),l=n(40795),d=n(61197),h=n(68442),f=n(80032),p=n(20929),_=n(11462),E=n(52300),y=n(76928),v=n(18313);let g=class{constructor(e,t,n,i,r,o){this.requestService=e,this.apiUrl=t,this.logger=n,this.sensitiveDataService=i,this.compressRequest=r,this.container=o}checkTabUrlSafety(e,t){return a(this,void 0,void 0,(function*(){const n=e.fgNavData.hasData&&t!==c.MODE.NO_NAVIGATION,i=n?"/api/rest/v2/secure/urls/checkSafety":"/api/rest/v2/secure/urls/checkSafety/basic",r=n?this.serializeGenericRequest(e,t):this.serializeBasicRequest(e),o={method:u.RequestMethods.POST,contentType:u.ContentTypes.JSON};if(!this.isValidData(r,n))throw new h.CheckSafeException("Incorrect safe check request: "+JSON.stringify(r));this.logger.log("Check safe state request",r);let a,s=r;this.compressRequest&&(s=this.processRequestCompress(r),o.contentType=u.ContentTypes.OCTET_STREAM);try{a=(yield this.requestService.fetchRequest(this.apiUrl+i,s,o)).safe?c.STATUS.SAFE:c.STATUS.UNSAFE}catch(e){throw new h.CheckSafeException("Error checking url safety")}return a}))}serializeBasicRequest(e){return{url:{value:this.sensitiveDataService.transformUrl(e.url),encoded:!1}}}serializeGenericRequest(e,t){const n=e.fgNavData,i=n.navigationData,r=n.documentData,o=n.panalyticsData,a=n.systemData,s=t===c.MODE.FULL_NAVIGATION?this.serializeBgNavData(e.bgNavData):[],u={url:{value:this.sensitiveDataService.transformUrl(e.url),encoded:!1},timestamp:Date.now().toString(),pageAttributes:{title:this.sensitiveDataService.transformTitle(n.domain,r.title),name:this.sensitiveDataService.transformTitle(n.domain,r.windowName)},contextAttributes:{referrer:this.sensitiveDataService.transformUrl(r.referrer)},method:i.method,tab:{id:e.id,initiatorId:i.sourceTabId},frame:{id:i.frameId,parentId:i.parentFrameId},os:{name:a.name,version:a.version},mainFrame:{navigationSequence:i.sequence||1},type:"INTERNAL_BROWSER_EXTENSION",partition:"fg",nested:s};return u[E.decode("cGFuZWxpc3REZWY=")]={[E.decode("cGFuZWxpc3RJZA==")]:o.panalyticsId,[E.decode("cGFuZWxJZA==")]:o.pinstanceId,partnerId:o.partnerId,distributorId:o.distributorId},u}serializeBgNavData(e){return e.map((e=>{const t=p.getDomain(e.url),n={url:{value:this.sensitiveDataService.transformUrl(e.url),encoded:!1},timestamp:e.timeStamp,pageAttributes:{title:this.sensitiveDataService.transformTitle(t,e.pageDocumentTitle),name:this.sensitiveDataService.transformTitle(t,e.pageWindowName)},contextAttributes:{referrer:this.sensitiveDataService.transformUrl(e.pageDocumentReferrer)},method:e.navigationMethod,tab:{id:e.tabId,initiatorId:e.sourceTabId},frame:{id:e.frameId,parentId:e.parentFrameId},os:{name:e.requestOs,version:e.requestOsVersion},server:{api:e.serverIp},mainFrame:{navigationSequence:e.navigationSequence||1},browser:{name:e.requestBrowser,version:e.requestBrowserVersion},request:{headers:e.requestHeaders,method:e.requestMethod,userAgent:e.requestUserAgent,acceptLanguage:e.requestAcceptLanguage},response:{headers:e.responseHeaders,isFromCache:e.responseIsFromCache,error:e.responseError,redirectUrl:e.responseRedirectUrl},eventDef:{id:e.eventId,type:e.eventType,subType:e.eventSubType},partition:"bg",type:"INTERNAL_BROWSER_EXTENSION"};return e.eventSubType,e.navigationMethod===_.NavigationMethod.REQUEST&&(n.response.statusCode=e.responseStatusCode,n.response.statusLine=e.responseStatusLine),n[E.decode("cGFuZWxpc3REZWY=")]={[E.decode("cGFuZWxpc3RJZA==")]:e.panalyticsId,[E.decode("cGFuZWxJZA==")]:e.pinstanceId,partnerId:e.partnerId,distributorId:e.distributorId},n}))}isValidData(e,t){return!!e.url.value&&(!t||e.method&&e.tab.id&&e.type)}processRequestCompress(e){return f.default.compressToUTF16(JSON.stringify(e))}};g=i([s.injectable(),o(0,s.inject(c.UrlsSafeCheckTypes.USC_REQUEST_SERVICE)),o(1,s.inject(c.UrlsSafeCheckTypes.USC_ENDPOINT_DOMAIN)),o(2,s.inject(c.UrlsSafeCheckTypes.USC_LOGGER)),o(3,s.inject(d.SensitiveDataFilterTypes.SDF_SERVICE)),o(4,s.inject(c.UrlsSafeCheckTypes.USC_COMPRESS_REQUEST)),o(5,s.inject(v.MARIO_TYPES.CONTAINER)),r("design:paramtypes",[u.RequestService,String,y.UscLogger,l.SensitiveDataFilterService,Boolean,s.Container])],g),t.CheckSafeService=g},56906:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LibStateService=void 0;const s=n(86700),c=n(18313),u=n(66969),l=n(42543),d=n(63654),h=n(24198),f=n(90392),p=n(98266);let _=class{constructor(e,t,n,i,r,o){this.bgStateService=e,this.dispatcher=t,this.usfStateService=n,this.mode=i,this.stateDataService=r,this.container=o}restoreState(){return a(this,void 0,void 0,(function*(){(yield this.stateDataService.getEnabledState())?(yield this.usfStateService.enable(),this.mode===l.MODE.FULL_NAVIGATION&&this.bgStateService.enable()):(yield this.usfStateService.disable(),this.bgStateService.disable()),(yield this.stateDataService.getNotificationEnabledState())?yield this.usfStateService.enableNotification():yield this.usfStateService.disableNotification()}))}enable(){return a(this,void 0,void 0,(function*(){const e=new c.MarioEvent(u.UrlsSafeCheckEvents.ENABLE_LIB);return this.dispatcher.emit(e)}))}disable(){return a(this,void 0,void 0,(function*(){const e=new c.MarioEvent(u.UrlsSafeCheckEvents.DISABLE_LIB);return this.dispatcher.emit(e)}))}};_=i([s.injectable(),o(0,s.inject(h.BgNavTypes.STATE_SERVICE)),o(1,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(2,s.inject(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(3,s.inject(l.UrlsSafeCheckTypes.USC_MODE)),o(4,s.inject(l.UrlsSafeCheckTypes.USC_STATE_DATA_SERVICE)),o(5,s.inject(c.MARIO_TYPES.CONTAINER)),r("design:paramtypes",[f.StateService,Object,d.StateService,String,p.StateDataService,s.Container])],_),t.LibStateService=_},76928:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.UscLogger=void 0;const a=n(86700),s=n(42543);let c=class{constructor(e){this.logging=e}log(e,t){this.logging}};c=i([a.injectable(),o(0,a.inject(s.UrlsSafeCheckTypes.USC_LOGGING)),r("design:paramtypes",[String])],c),t.UscLogger=c},59464:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestService=t.ContentTypes=t.RequestMethods=void 0;const o=n(86700);var a,s;!function(e){e.GET="GET",e.POST="POST"}(a=t.RequestMethods||(t.RequestMethods={})),function(e){e.JSON="application/json;charset=utf-8",e.OCTET_STREAM="application/octet-stream"}(s=t.ContentTypes||(t.ContentTypes={}));let c=class{fetchRequest(e,t,n){return r(this,void 0,void 0,(function*(){const i=n.method||a.GET,r=n.contentType||s.JSON,o={"Content-type":r},c=r===s.JSON?JSON.stringify(t):t,u=yield fetch(e,{method:i,headers:o,body:c});if(200!==u.status)throw u;return u.json()}))}};c=i([o.injectable()],c),t.RequestService=c},98266:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StateDataService=void 0;const s=n(86700),c=n(18313),u=n(20929),l="SAFESEARCH_STATE_DATA",d="SAFESEARCH_ENABLED",h="SAFESEARCH_NOTIFICATION_ENABLED";let f=class{constructor(e){this.storageService=e}setEnabledState(e){return a(this,void 0,void 0,(function*(){return yield this.storageService.set(d,e?"1":"0")}))}getEnabledState(){return a(this,void 0,void 0,(function*(){return"1"===(yield this.storageService.get(d))}))}setNotificationEnabledState(e){return a(this,void 0,void 0,(function*(){return yield this.storageService.set(h,e?"1":"0")}))}getNotificationEnabledState(){return a(this,void 0,void 0,(function*(){return"1"===(yield this.storageService.get(h))}))}getDomainPersistedData(e){return a(this,void 0,void 0,(function*(){const t=u.getDomain(e);return(yield this.getList()).find((e=>e.domain===t))}))}setDomainPersistedValue(e,t,n){return a(this,void 0,void 0,(function*(){const i=u.getDomain(e),r=yield this.getList(),o=r.find((e=>e.domain===i));o?o[t]=n:r.push({domain:i,[t]:n}),yield this.saveList(r)}))}getList(){return a(this,void 0,void 0,(function*(){const e=yield this.storageService.get(l);return e?JSON.parse(e):[]}))}saveList(e=[]){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);return yield this.storageService.set(l,t)}))}};f=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],f),t.StateDataService=f},63654:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StateService=void 0;const s=n(86700),c=n(71178),u=n(18313),l=n(42543),d=n(17886),h=n(98266),f=n(66969),p=n(20929),_=n(76928);let E=class{constructor(e,t,n,i,r,o,a,s,c,u){this.checkSafeService=e,this.stateDataService=t,this.internalDispatcher=n,this.externalDispatcher=i,this.tabService=r,this.enabled=o,this.logging=a,this.logger=s,this.trackLoadingState=c,this.mode=u,this.tabsState=[],this.bgNavItems=[],this.notificationEnabled=!0}enable(){return a(this,void 0,void 0,(function*(){this.enabled=!0,yield this.stateDataService.setEnabledState(this.enabled)}))}disable(){return a(this,void 0,void 0,(function*(){this.enabled=!1,yield this.stateDataService.setEnabledState(this.enabled)}))}isEnabled(){return this.enabled}setMode(e){this.mode=e}getMode(){return this.mode}enableNotification(){return a(this,void 0,void 0,(function*(){this.notificationEnabled=!0,yield this.stateDataService.setNotificationEnabledState(this.notificationEnabled)}))}disableNotification(){return a(this,void 0,void 0,(function*(){this.notificationEnabled=!1,yield this.stateDataService.setNotificationEnabledState(this.notificationEnabled)}))}isEnabledNotification(){return this.notificationEnabled}getTabState(e){return this.tabsState.find((t=>t.id===e))}getActiveTabState(){return a(this,void 0,void 0,(function*(){const e=yield this.tabService.query({active:!0,currentWindow:!0}),t=!chrome.runtime.lastError&&e[0];if(t)return this.getOrAddTabState(t.id,t.url)}))}removeTabState(e){const t=this.tabsState.findIndex((t=>t.id===e));this.tabsState.splice(t,1)}onFgNavStarted(e){return a(this,void 0,void 0,(function*(){if(p.isBlankPage(e.url))return;const t=yield this.getOrAddTabState(e.tabId,e.url);t.setUrl(e.url),t.setLoadingState(!0),t.setCheckedState(!1),this.trackLoadingState&&(t.setStatus(l.STATUS.UNKNOWN),setTimeout((()=>{this.sendSafetyNotificationStatus(t)}))),p.isWhiteListUrl(e.url)&&this.updateTabSafetyStatus(t)}))}onFgNavCommited(e){return a(this,void 0,void 0,(function*(){if(p.isBlankPage(e.url))return;const t=this.getTabState(e.tabId);t.setLoadingState(!1),t.setLastUrl(t.url),t.setFgNavData(e),e.hasData&&this.applyBgData(e),this.fixBgNavMainFramePageAttrs(t),this.updateTabSafetyStatus(t),t.clearFgNavData(),t.clearBgNavData()}))}onBgNavStarted(e){return a(this,void 0,void 0,(function*(){}))}onBgNavCommited(e){return a(this,void 0,void 0,(function*(){if("resource"===e.eventType)return void this.logger.log("[USC] StateService: Ignore a BgNav event because it's a resource");if("main_frame"===e.eventSubType&&!e.responseRedirectUrl)return void this.logger.log("[USC] StateService: ignore a BgNav event  because it's main_frame");const t=this.getTabState(e.tabId);t&&t.hasFgNavData()||this.logger.log(`[USC] StateService: BgNav postponed request: ${e.url}`),this.bgNavItems.push(e)}))}updateTabSafetyStatusByTabId(e){const t=this.getTabState(e);this.updateTabSafetyStatus(t)}updateTabSafetyStatus(e){return a(this,void 0,void 0,(function*(){if(!this.enabled)return;const t=p.isWhiteListUrl(e.url)||p.isBlankPage(e.url);if(!e)return;if(e.checked)return void this.sendSafetyNotificationStatus(e);if(e._loading)return e.setStatus(l.STATUS.UNKNOWN),void this.sendSafetyNotificationStatus(e);if(t)return e.setStatus(l.STATUS.SAFE),void this.sendSafetyNotificationStatus(e);this.logger.log(""),this.logger.log(`Senging FgNav request for: ${e.url}`),this.logger.log("BgNav entities:"),e.bgNavData.forEach((e=>{this.logger.log(` - ${e.url}${e.responseRedirectUrl?" [redirect]":""}`)})),this.logger.log("--------------------------------------------------------------------------------------");const n=this.copyTabState(e);setTimeout((()=>a(this,void 0,void 0,(function*(){const t=yield this.fetchTabSafetyStatus(n);e.setCheckedState(!0),e.setStatus(t),this.sendSafetyNotificationStatus(e)}))))}))}getTabSafetyStatus(e){return a(this,void 0,void 0,(function*(){return new Promise((t=>a(this,void 0,void 0,(function*(){const n=this.getTabState(e),i=n.checked?n.status:yield this.fetchTabSafetyStatus(n);t(i)}))))}))}sendSafetyNotificationStatus(e){if(!this.notificationEnabled)return;const t={tabId:e.id,url:e.url,status:e.status,notificationMuted:e.notificationMuted};this.externalDispatcher.emit(e.id,new u.MarioEvent(f.UrlsSafeCheckEvents.SAFE_STATUS_UPDATED,t)),this.internalDispatcher.emit(new u.MarioEvent(f.UrlsSafeCheckEvents.SAFE_STATUS_UPDATED,t))}muteTabNofitication(e,t){const n=this.getTabState(e);n.notificationMuted=!0,t&&this.stateDataService.setDomainPersistedValue(n.url,"notificationMuted",!0)}getOrAddTabState(e,t){return a(this,void 0,void 0,(function*(){let n=this.getTabState(e);n||(n=new c.TabState,n.setUrl(t),this.tabsState.push(n));const i=yield this.stateDataService.getDomainPersistedData(t),r=!!i&&i.notificationMuted;return n.setId(e),n.setNotificationMute(r),n}))}fetchTabSafetyStatus(e){return a(this,void 0,void 0,(function*(){let t;if(p.isWhiteListUrl(e.url))return p.valueToPromise(l.STATUS.SAFE);try{t=yield this.checkSafeService.checkTabUrlSafety(e,this.mode)}catch(e){t=l.STATUS.UNKNOWN}return t}))}applyBgData(e){const t=this.getTabState(e.tabId);this.bgNavItems.forEach((e=>t.addBgNavData(e))),this.bgNavItems=[]}fixBgNavMainFramePageAttrs(e){e.bgNavData.forEach((e=>{"main_frame"===e.eventSubType&&(e.pageDocumentTitle="",e.pageDocumentReferrer="",e.pageWindowName="")}))}copyTabState(e){return JSON.parse(JSON.stringify(e))}};E=i([s.injectable(),o(0,s.inject(l.UrlsSafeCheckTypes.USC_CHECK_SERVICE)),o(1,s.inject(l.UrlsSafeCheckTypes.USC_STATE_DATA_SERVICE)),o(2,s.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),o(3,s.inject(u.MARIO_TYPES.EXTERNAL_DISPATCHER)),o(4,s.inject(u.MARIO_TYPES.TAB_SERVICE)),o(5,s.inject(l.UrlsSafeCheckTypes.USC_ENABLED)),o(6,s.inject(l.UrlsSafeCheckTypes.USC_LOGGING)),o(7,s.inject(l.UrlsSafeCheckTypes.USC_LOGGER)),o(8,s.inject(l.UrlsSafeCheckTypes.USC_TRACK_LOADING_STATE)),o(9,s.inject(l.UrlsSafeCheckTypes.USC_MODE)),r("design:paramtypes",[d.CheckSafeService,h.StateDataService,Object,Object,Object,Boolean,String,_.UscLogger,Boolean,String])],E),t.StateService=E},73190:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e={}){if(this.storageSyncKey="panalyticsid",this.userKeyCacheHeader="X-PANEL-USER-KEY",this.userKeySymbolsCount=22,"string"!=typeof e.host)throw"Server host is undefined";e.storageKey&&(this.storageSyncKey=e.storageKey),this.host=e.host,this.logging=!!e.logging,this.cacheResourceUrl=this.host+"/api/identity/cache",this.cookieResourceUrl=this.host+"/api/identity/cookie"}generateKey(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;for(let i=0;i<this.userKeySymbolsCount;i++)e+=t.charAt(Math.floor(Math.random()*n));return this.log("key generated locally: "+e),e}setKey(e){return n(this,void 0,void 0,(function*(){yield this.globalSetter(e)}))}synchronize(){return n(this,void 0,void 0,(function*(){const e=yield this.loadKey();yield this.globalSetter(e)}))}loadKey(){return n(this,void 0,void 0,(function*(){return new Promise((e=>n(this,void 0,void 0,(function*(){let t;t||(t=yield this.cacheGetter()),t||(t=yield this.cookieGetter()),t||(t=this.localStorageGetter()),e(t)}))))}))}getKey(e,t){this.getKeyAsync(t).then(e)}getKeyAsync(e=!0){return n(this,void 0,void 0,(function*(){const t=(yield this.loadKey())||this.generateKey();return e&&(yield this.setKey(t)),t}))}localStorageGetter(){this.log("localStorageGetter: try to get "+this.storageSyncKey+" from localStorage.");const e=localStorage.getItem(this.storageSyncKey);return e?this.log("localStorageGetter: "+this.storageSyncKey+" has been found in localStorage. Value: "+e):this.log("localStorageGetter: "+this.storageSyncKey+" has not been found in localStorage."),e}localStorageSetter(e){this.log("localStorageSetter: "+this.storageSyncKey+" are going to be stored in localStorage."),localStorage.setItem(this.storageSyncKey,e)}cacheGetter(){return n(this,void 0,void 0,(function*(){this.log("CacheGetter: try to get "+this.storageSyncKey+" from cache.");const e=this;return new Promise((t=>{const n=new XMLHttpRequest;n.open("GET",this.cacheResourceUrl),n.timeout=1e3,n.ontimeout=function(){e.log("CacheGetter: Caching request is timed out."),t()},n.onload=function(){if(200===n.status)try{const i=JSON.parse(n.response).userKey;i?(e.log("CacheGetter: "+e.storageSyncKey+" has been found in cache. Value: "+i),t(i)):t()}catch(n){e.log("CacheGetter: Error occurred while retrieving "+e.storageSyncKey+" from cache."),t()}else e.log("CacheGetter: Caching request has been failed."),t()},n.onerror=function(){t()},n.send()}))}))}cacheSetter(e){this.log("CacheSetter: "+this.storageSyncKey+" are going to be stored in cache.");const t=this;return new Promise((n=>{const i=new XMLHttpRequest;i.open("GET",this.cacheResourceUrl),i.setRequestHeader(this.userKeyCacheHeader,e),i.setRequestHeader("Cache-Control","no-cache"),i.responseType="json",i.send(),i.onload=function(){200===i.status?(t.log("CacheSetter: Caching request to server has been succeeded."),n(e)):(t.log("CacheSetter: Caching request has been failed."),n())},i.onerror=function(){n()}}))}cookieGetter(){return n(this,void 0,void 0,(function*(){this.log("CookieGetter: try to get "+this.storageSyncKey+" from cookie.");const e=this;return new Promise((t=>{const n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET",this.cookieResourceUrl),n.timeout=5e3,n.ontimeout=function(){e.log("CookieGetter: Request is timed out."),t()},n.onload=function(){let i;if(200===n.status)try{i=JSON.parse(n.response).userKey,i?(e.log("CookieGetter: "+e.storageSyncKey+" has been found in cookie. Value:"+i),t(i)):(e.log("CookieGetter: "+e.storageSyncKey+" has not been found in cookie. "),t())}catch(n){e.log("CookieGetter: Error occurred while retrieving "+e.storageSyncKey+" from cookie."),t()}else e.log("CookieGetter: Cookie request has been failed."),t()},n.onerror=function(){t()},n.send()}))}))}cookieSetter(e){this.log("CookieSetter: "+this.storageSyncKey+" are going to be stored in cookie.");const t=this;return new Promise((n=>{const i=new XMLHttpRequest;i.withCredentials=!0,i.open("POST",this.cookieResourceUrl+"?userKey="+e),i.send(),i.onload=function(){200===i.status?(t.log("CookieSetter: cookie request has been succeeded."),n(e)):(t.log("CookieSetter: cookie request has been failed."),n())},i.onerror=function(){n()}}))}cookieClear(){return n(this,void 0,void 0,(function*(){this.log("CookieClearer: "+this.storageSyncKey+" are going to be deleted.");const e=this;return new Promise((t=>{const n=new XMLHttpRequest;n.withCredentials=!0,n.open("DELETE",this.cookieResourceUrl),n.send(),n.onload=function(){200===n.status?(e.log("CookieClearer: cookie request has been succeeded."),t()):(e.log("CookieClearer: cookie request has been failed."),t())},n.onerror=function(){t()}}))}))}globalSetter(e){return n(this,void 0,void 0,(function*(){e?(this.localStorageSetter(e),yield this.cacheSetter(e),yield this.cookieClear(),yield this.cookieSetter(e)):this.log("Value provided to global setter is invalid.")}))}log(e){this.logging}}},60707:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i="*****",r="SensitiveDataFilter:";t.default=class{constructor(e){if("string"!=typeof e.host)throw"Server host is undefined";this.host=e.host,this.logging=!!e.logging}init(){return n(this,void 0,void 0,(function*(){yield this.updateRules()}))}transformUrl(e){if(!e||!this.rules||!this.rules.filters)return e;const t=new URL(e),n=t.host;t.password.length&&(t.password=i),t.username.length&&(t.username=i);this.rules.filters.forEach((e=>{n.match(e.domain)&&(t.pathname=this.processFilterRules(e.rules,t.pathname),t.search=this.processFilterRules(e.rules,t.search),t.hash=this.processFilterRules(e.rules,t.hash))}));const o=t.toString();return this.logging&&this.log(`${r} Transformed url: ${e} -> ${o}`),o}transformTitle(e,t){if(!t||!this.rules||!this.rules.titles)return t;const n=this.rules.titles;let o=t;return n.forEach((t=>{e.match(t.domain)&&t.rules.forEach((e=>{e.value&&(o=this.applyRegexp(e.value,o,i))}))})),this.logging&&this.log(`${r} Transformed title: ${t} -> ${o}`),o}updateRules(){return n(this,void 0,void 0,(function*(){const e=this.host+"/api/privacy/data/rules/exclusions";try{const t=yield fetch(e,{headers:{"Content-type":"application/json;charset=utf-8"}});this.rules=yield t.json()}catch(e){throw new Error(e)}}))}processFilterRules(e,t){let n=t;return e.forEach((e=>{if(e.value&&e.type)switch(e.type){case"parameter":n=this.applyRegexp("([?&]"+e.value+"=)([^&]+)",n,"$1"+i);break;case"path":n=this.applyPathFilter(e.value,n,i);break;default:this.logging&&this.log(`${r} Unknown rule type: ${e.type}`)}})),n}applyPathFilter(e,t,n){const i=new RegExp(e,"i");let r;const o=t.match(i);if(!o)return t;const[a,s]=o;return r=n+s+n,0===a.indexOf(s)&&(r=s+n),a.indexOf(s)===a.length-s.length&&(r=n+s),t.replace(a,r)}applyRegexp(e,t,n){const i=new RegExp(e,"ig");return t.replace(i,n)}log(e){}}},33726:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanAnalytics=void 0;t.UrbanAnalytics=class{constructor(e){this.api=e.api,this.appName=e.appName,this.clientVersion=e.clientVersion}async track(e){const t=this.buildPayload(e),n=`${this.api}/analytics/event`,i={method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)};return await fetch(n,i),t}buildPayload(e){const t={eventSource:this.appName,eventAction:e.action,clientVersion:this.clientVersion};return"packageId"in e&&(t.userPackageId=e.packageId),"manual"in e&&(t.manualEvent=e.manual),"details"in e&&(t.eventDetails=e.details),t}}},39803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{compare:()=>o,compareVersions:()=>i,satisfies:()=>a,validate:()=>r});const i=(e,t)=>{const n=c(e),i=c(t),r=n.pop(),o=i.pop(),a=h(n,i);return 0!==a?a:r&&o?h(r.split("."),o.split(".")):r||o?r?-1:1:0},r=e=>"string"==typeof e&&/^[v\d]/.test(e)&&s.test(e),o=(e,t,n)=>{_(n);const r=i(e,t);return f[n].includes(r)},a=(e,t)=>{if(t.includes("||"))return t.split("||").some((t=>a(e,t)));if(t.includes(" "))return t.trim().replace(/\s{2,}/g," ").split(" ").every((t=>a(e,t)));const n=t.match(/^([<>=~^]+)/),i=n?n[1]:"=";if("^"!==i&&"~"!==i)return o(e,t,i);const[r,s,u,,l]=c(e),[d,f,p,,_]=c(t),E=[r,s,u],y=[d,null!=f?f:"x",null!=p?p:"x"];if(_){if(!l)return!1;if(0!==h(E,y))return!1;if(-1===h(l.split("."),_.split(".")))return!1}const v=y.findIndex((e=>"0"!==e))+1,g="~"===i?2:v>1?v:1;return 0===h(E.slice(0,g),y.slice(0,g))&&-1!==h(E.slice(g),y.slice(g))},s=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,c=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const t=e.match(s);if(!t)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return t.shift(),t},u=e=>"*"===e||"x"===e||"X"===e,l=e=>{const t=parseInt(e,10);return isNaN(t)?e:t},d=(e,t)=>{if(u(e)||u(t))return 0;const[n,i]=((e,t)=>typeof e!=typeof t?[String(e),String(t)]:[e,t])(l(e),l(t));return n>i?1:n<i?-1:0},h=(e,t)=>{for(let n=0;n<Math.max(e.length,t.length);n++){const i=d(e[n]||"0",t[n]||"0");if(0!==i)return i}return 0},f={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]},p=Object.keys(f),_=e=>{if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===p.indexOf(e))throw new Error(`Invalid operator, expected one of ${p.join("|")}`)}},63442:(e,t)=>{"use strict";t.__esModule=!0;var n=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var n=t.toString();return t&&(t instanceof e||e.validator.test(n))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=n},99934:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(6867);function o(e,t,n,r,o){var a={},s="number"==typeof o,c=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(i.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var u=a[c];if(Array.isArray(u))for(var l=0,d=u;l<d.length;l++){var h=d[l];if(h.key===r.key)throw new Error(i.DUPLICATED_METADATA+" "+h.key.toString())}else u=[];u.push(r),a[c]=u,Reflect.defineMetadata(e,a,t)}function a(e,t){Reflect.decorate(e,t)}function s(e,t){return function(n,i){t(n,i,e)}}t.tagParameter=function(e,t,n,i){o(r.TAGGED,e,t,i,n)},t.tagProperty=function(e,t,n){o(r.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"==typeof n?a([s(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):a([e],t)}},5744:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(6867),o=n(47738),a=n(99934),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=s,t.inject=function(e){return function(t,n,s){if(void 0===e)throw new Error(i.UNDEFINED_INJECT_ANNOTATION(t.name));var c=new o.Metadata(r.INJECT_TAG,e);"number"==typeof s?a.tagParameter(t,n,s,c):a.tagProperty(t,n,c)}}},64315:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(6867);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(r.PARAM_TYPES,e))throw new Error(i.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(r.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(r.PARAM_TYPES,t,e),e}}},71693:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=n(99934);t.multiInject=function(e){return function(t,n,a){var s=new r.Metadata(i.MULTI_INJECT_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},38085:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=n(99934);t.named=function(e){return function(t,n,a){var s=new r.Metadata(i.NAMED_TAG,e);"number"==typeof a?o.tagParameter(t,n,a,s):o.tagProperty(t,n,s)}}},6515:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=n(99934);t.optional=function(){return function(e,t,n){var a=new r.Metadata(i.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(e,t,n,a):o.tagProperty(e,t,a)}}},7014:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(6867),o=n(47738);t.postConstruct=function(){return function(e,t,n){var a=new o.Metadata(r.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(r.POST_CONSTRUCT,e.constructor))throw new Error(i.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(r.POST_CONSTRUCT,a,e.constructor)}}},32052:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(47738),r=n(99934);t.tagged=function(e,t){return function(n,o,a){var s=new i.Metadata(e,t);"number"==typeof a?r.tagParameter(n,o,a,s):r.tagProperty(n,o,s)}}},55638:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=n(99934);t.targetName=function(e){return function(t,n,a){var s=new r.Metadata(i.NAME_TAG,e);o.tagParameter(t,n,a,s)}}},86757:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=n(99934);t.unmanaged=function(){return function(e,t,n){var a=new r.Metadata(i.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,a)}}},44290:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28421),r=n(37791),o=function(){function e(e,t){this.id=r.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=i.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},23184:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},16674:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},6867:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},51389:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[0,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(44290),a=n(16674),s=n(28421),c=n(6867),u=n(51377),l=n(86311),d=n(31927),h=n(51860),f=n(37791),p=n(55800),_=n(85700),E=n(80175),y=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=s.BindingScopeEnum.Transient;else if(t.defaultScope!==s.BindingScopeEnum.Singleton&&t.defaultScope!==s.BindingScopeEnum.Transient&&t.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=f.id(),this._bindingDictionary=new E.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new u.MetadataReader}return e.merge=function(t,n){var i=new e,r=l.getBindingDictionary(i),o=l.getBindingDictionary(t),a=l.getBindingDictionary(n);function s(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s(o,r),s(a,r),i},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(this,void 0,void 0,(function(){var t,n,i,o,a;return r(this,(function(r){switch(r.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,r.label=1;case 1:return n<i.length?(o=i[n],a=t(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n,i=(n=t.id,function(e){return e.moduleId===n});e._bindingDictionary.removeByCondition(i)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new o.Binding(e,t);return this._bindingDictionary.add(e,n),new h.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(a.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new E.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,c.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=l.createMockRequest(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(_.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,s.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,c.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,s.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,c.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind.bind(e)(i);return t(r,n),r}};return function(i){return{bindFunction:(r=i,function(n){var i=e.bind.bind(e)(n);return t(i,r),i}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(i),unbindFunction:function(t){e.unbind.bind(e)(t)}};var r}},e.prototype._get=function(e,t,n,i,r,o){var s=null,c={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:r,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(null==(s=this._middleware(c)))throw new Error(a.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(c);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=l.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),d.resolve(n)}},e}();t.Container=y},33244:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(37791),r=function(e){this.id=i.id(),this.registry=e};t.ContainerModule=r;var o=function(e){this.id=i.id(),this.registry=e};t.AsyncContainerModule=o},85700:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.of=function(t,n){var i=new e;return i.bindings=t,i.middleware=n,i},e}();t.ContainerSnapshot=n},80175:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(i.NULL_ARGUMENT);if(null==t)throw new Error(i.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(i.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(i.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,i){var r=n.filter((function(t){return!e(t)}));r.length>0?t._map.set(i,r):t._map.delete(i)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=r},86700:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867);t.METADATA_KEY=i;var r=n(51389);t.Container=r.Container;var o=n(28421);t.BindingScopeEnum=o.BindingScopeEnum,t.BindingTypeEnum=o.BindingTypeEnum,t.TargetTypeEnum=o.TargetTypeEnum;var a=n(33244);t.AsyncContainerModule=a.AsyncContainerModule,t.ContainerModule=a.ContainerModule;var s=n(64315);t.injectable=s.injectable;var c=n(32052);t.tagged=c.tagged;var u=n(38085);t.named=u.named;var l=n(5744);t.inject=l.inject,t.LazyServiceIdentifer=l.LazyServiceIdentifer;var d=n(6515);t.optional=d.optional;var h=n(86757);t.unmanaged=h.unmanaged;var f=n(71693);t.multiInject=f.multiInject;var p=n(55638);t.targetName=p.targetName;var _=n(7014);t.postConstruct=_.postConstruct;var E=n(51377);t.MetadataReader=E.MetadataReader;var y=n(37791);t.id=y.id;var v=n(99934);t.decorate=v.decorate;var g=n(80758);t.traverseAncerstors=g.traverseAncerstors,t.taggedConstraint=g.taggedConstraint,t.namedConstraint=g.namedConstraint,t.typeConstraint=g.typeConstraint;var S=n(55800);t.getServiceIdentifierAsString=S.getServiceIdentifierAsString;var T=n(70600);t.multiBindToService=T.multiBindToService},95228:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(37791),r=function(){function e(e){this.id=i.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=r},47738:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===i.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=r},51377:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(i.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(i.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(i.TAGGED_PROP,e)||[]},e}();t.MetadataReader=r},55314:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=n},86311:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(23184),r=n(16674),o=n(28421),a=n(6867),s=n(85265),c=n(55800),u=n(95228),l=n(47738),d=n(55314),h=n(6e3),f=n(6748),p=n(18924);function _(e){return e._bindingDictionary}function E(e,t,n,o,a){var s=v(n.container,a.serviceIdentifier),u=[];return s.length===i.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&e.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),s=v(n.container,a.serviceIdentifier)),u=t?s:s.filter((function(e){var t=new f.Request(e.serviceIdentifier,n,o,e,a);return e.constraint(t)})),function(e,t,n,o){switch(t.length){case i.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var a=c.getServiceIdentifierAsString(e),s=r.NOT_REGISTERED;throw s+=c.listMetadataForTarget(a,n),s+=c.listRegisteredBindingsForServiceIdentifier(o,a,v),new Error(s);case i.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case i.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;a=c.getServiceIdentifierAsString(e),s=r.AMBIGUOUS_MATCH+" "+a;throw s+=c.listRegisteredBindingsForServiceIdentifier(o,a,v),new Error(s)}}(a.serviceIdentifier,u,a,n.container),u}function y(e,t,n,i,a,s){var c,u;if(null===a){c=E(e,t,i,null,s),u=new f.Request(n,i,null,c,s);var l=new d.Plan(i,u);i.addPlan(l)}else c=E(e,t,i,a,s),u=a.addChildRequest(s.serviceIdentifier,c,s);c.forEach((function(t){var n=null;if(s.isArray())n=u.addChildRequest(t.serviceIdentifier,t,s);else{if(t.cache)return;n=u}if(t.type===o.BindingTypeEnum.Instance&&null!==t.implementationType){var a=h.getDependencies(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var c=h.getBaseClassDependencyCount(e,t.implementationType);if(a.length<c){var l=r.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(t.implementationType));throw new Error(l)}}a.forEach((function(t){y(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function v(e,t){var n=[],i=_(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=v(e.parent,t)),n}t.getBindingDictionary=_,t.plan=function(e,t,n,i,r,o,d,h){void 0===h&&(h=!1);var f=new u.Context(t),_=function(e,t,n,i,r,o){var s=e?a.MULTI_INJECT_TAG:a.INJECT_TAG,c=new l.Metadata(s,n),u=new p.Target(t,i,n,c);if(void 0!==r){var d=new l.Metadata(r,o);u.metadata.push(d)}return u}(n,i,r,"",o,d);try{return y(e,h,r,f,null,_),f}catch(e){throw s.isStackOverflowExeption(e)&&f.plan&&c.circularDependencyToException(f.plan.rootRequest),e}},t.createMockRequest=function(e,t,n,i){var r=new p.Target(o.TargetTypeEnum.Variable,"",t,new l.Metadata(n,i)),a=new u.Context(e);return new f.Request(t,a,null,[],r)}},88460:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=n},6e3:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5744),r=n(16674),o=n(28421),a=n(6867),s=n(55800);t.getFunctionName=s.getFunctionName;var c=n(18924);function u(e,t,n,i){var o=e.getConstructorMetadata(n),a=o.compilerGeneratedMetadata;if(void 0===a){var s=r.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(s)}var c=o.userGeneratedMetadata,u=Object.keys(c),h=function(e,t,n,i,r){for(var o=[],a=0;a<r;a++){var s=l(a,e,t,n,i);null!==s&&o.push(s)}return o}(i,t,a,c,0===n.length&&u.length>0?u.length:n.length),f=d(e,n);return h.concat(f)}function l(e,t,n,a,s){var u=s[e.toString()]||[],l=h(u),d=!0!==l.unmanaged,f=a[e],p=l.inject||l.multiInject;if((f=p||f)instanceof i.LazyServiceIdentifer&&(f=f.unwrap()),d){if(!t&&(f===Object||f===Function||void 0===f)){var _=r.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(_)}var E=new c.Target(o.TargetTypeEnum.ConstructorArgument,l.targetName,f);return E.metadata=u,E}return null}function d(e,t){for(var n=e.getPropertiesMetadata(t),i=[],r=0,a=Object.keys(n);r<a.length;r++){var s=a[r],u=n[s],l=h(n[s]),f=l.targetName||s,p=l.inject||l.multiInject,_=new c.Target(o.TargetTypeEnum.ClassProperty,f,p);_.metadata=u,i.push(_)}var E=Object.getPrototypeOf(t.prototype).constructor;if(E!==Object){var y=d(e,E);i=i.concat(y)}return i}function h(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[a.INJECT_TAG],multiInject:t[a.MULTI_INJECT_TAG],targetName:t[a.NAME_TAG],unmanaged:t[a.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return u(e,s.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var r=u(t,s.getFunctionName(i),i,!0),o=r.map((function(e){return e.metadata.filter((function(e){return e.key===a.UNMANAGED_TAG}))})),c=[].concat.apply([],o).length,l=r.length-c;return l>0?l:e(t,i)}return 0}},6748:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(37791),r=function(){function e(e,t,n,r,o){this.id=i.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();t.Request=r},18924:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(37791),o=n(47738),a=n(88460),s=function(){function e(e,t,n,s){this.id=r.id(),this.type=e,this.serviceIdentifier=n,this.name=new a.QueryableString(t||""),this.metadata=new Array;var c=null;"string"==typeof s?c=new o.Metadata(i.NAMED_TAG,s):s instanceof o.Metadata&&(c=s),null!==c&&this.metadata.push(c)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(i.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(i.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(i.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==i.INJECT_TAG&&e.key!==i.MULTI_INJECT_TAG&&e.key!==i.NAME_TAG&&e.key!==i.UNMANAGED_TAG&&e.key!==i.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(i.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===i.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==i.INJECT_TAG&&e.key!==i.MULTI_INJECT_TAG&&e.key!==i.NAME_TAG&&e.key!==i.UNMANAGED_TAG&&e.key!==i.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(i.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=s},52279:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(28421),o=n(6867);t.resolveInstance=function(e,t,n){var a,s,c=null;if(t.length>0){var u=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ConstructorArgument})).map(n);s=u,c=function(e,t,n){var i=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ClassProperty})),o=i.map(n);return i.forEach((function(t,n){var i;i=t.target.name.value();var r=o[n];e[i]=r})),e}(c=new((a=e).bind.apply(a,[void 0].concat(s))),t,n)}else c=new e;return function(e,t){if(Reflect.hasMetadata(o.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(i.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,c),c}},31927:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(28421),o=n(85265),a=n(55800),s=n(52279),c=function(e,t,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(i.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},u=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,o=t.childRequests,l=t.target&&t.target.isArray(),d=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(l&&d)return o.map((function(t){return u(e)(t)}));var h=null;if(!t.target.isOptional()||0!==n.length){var f=n[0],p=f.scope===r.BindingScopeEnum.Singleton,_=f.scope===r.BindingScopeEnum.Request;if(p&&f.activated)return f.cache;if(_&&null!==e&&e.has(f.id))return e.get(f.id);if(f.type===r.BindingTypeEnum.ConstantValue)h=f.cache;else if(f.type===r.BindingTypeEnum.Function)h=f.cache;else if(f.type===r.BindingTypeEnum.Constructor)h=f.implementationType;else if(f.type===r.BindingTypeEnum.DynamicValue&&null!==f.dynamicValue)h=c("toDynamicValue",f.serviceIdentifier,(function(){return f.dynamicValue(t.parentContext)}));else if(f.type===r.BindingTypeEnum.Factory&&null!==f.factory)h=c("toFactory",f.serviceIdentifier,(function(){return f.factory(t.parentContext)}));else if(f.type===r.BindingTypeEnum.Provider&&null!==f.provider)h=c("toProvider",f.serviceIdentifier,(function(){return f.provider(t.parentContext)}));else{if(f.type!==r.BindingTypeEnum.Instance||null===f.implementationType){var E=a.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(i.INVALID_BINDING_TYPE+" "+E)}h=s.resolveInstance(f.implementationType,o,u(e))}return"function"==typeof f.onActivation&&(h=f.onActivation(t.parentContext,h)),p&&(f.cache=h,f.activated=!0),_&&null!==e&&!e.has(f.id)&&e.set(f.id,h),h}}};t.resolve=function(e){return u(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},83366:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(28421),r=n(71325),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=i.BindingScopeEnum.Request,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=i.BindingScopeEnum.Singleton,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=i.BindingScopeEnum.Transient,new r.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},99812:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(83366),r=n(51811),o=n(98370),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding),this._bindingInSyntax=new i.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=a},51811:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(98370),r=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new i.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=r},51860:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674),r=n(28421),o=n(99812),a=n(71325),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=r.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+i.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=r.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=r.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=r.BindingTypeEnum.Constructor,this._binding.implementationType=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(i.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=r.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new a.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=r.BindingTypeEnum.Provider,this._binding.provider=e,new a.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},71325:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(51811),r=n(98370),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new r.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},98370:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(51811),r=n(80758),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=r.namedConstraint(e),new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=r.taggedConstraint(e)(t),new i.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return r.typeConstraint(e)(t.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return r.namedConstraint(e)(t.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return r.taggedConstraint(e)(t)(n.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.typeConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.typeConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.namedConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.namedConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return r.traverseAncerstors(n,r.taggedConstraint(e)(t))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!r.traverseAncerstors(n,r.taggedConstraint(e)(t))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,e)},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,e)},new i.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},80758:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6867),r=n(47738),o=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||o(n,t))};t.traverseAncerstors=o;var a=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new r.Metadata(e,t),n}};t.taggedConstraint=a;var s=a(i.NAMED_TAG);t.namedConstraint=s;t.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}}},70600:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},85265:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===i.STACK_OVERFLOW}},37791:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.id=function(){return n++}},55800:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16674);function r(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||o(e.parentRequest,t))}function a(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=r,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=a(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(o(t,t.serviceIdentifier)){var n=function(e){var t=function e(t,n){void 0===n&&(n=[]);var i=r(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(t);throw new Error(i.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=a},64530:(e,t)=>{function n(e,t){var n=[],i=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(t)).join(".")+"]"}),function(r,o){if(n.length>0){var a=n.indexOf(this);~a?n.splice(a+1):n.push(this),~a?i.splice(a,1/0,r):i.push(r),~n.indexOf(o)&&(o=t.call(this,r,o))}else n.push(o);return null==e?o:e.call(this,r,o)}}(e.exports=function(e,t,i,r){return JSON.stringify(e,n(t,r),i)}).getSerialize=n},99490:(e,t)=>{"use strict";function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function s(e,t,n){return s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&a(r,n.prototype),r},s.apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return s(e,arguments,o(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),a(i,e)},c(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t}(c(Error)),h=function(e){function t(t){return e.call(this,"Invalid DateTime: "+t.toMessage())||this}return r(t,e),t}(d),f=function(e){function t(t){return e.call(this,"Invalid Interval: "+t.toMessage())||this}return r(t,e),t}(d),p=function(e){function t(t){return e.call(this,"Invalid Duration: "+t.toMessage())||this}return r(t,e),t}(d),_=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t}(d),E=function(e){function t(t){return e.call(this,"Invalid unit "+t)||this}return r(t,e),t}(d),y=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t}(d),v=function(e){function t(){return e.call(this,"Zone is an abstract class")||this}return r(t,e),t}(d),g="numeric",S="short",T="long",O={year:g,month:g,day:g},m={year:g,month:S,day:g},A={year:g,month:S,day:g,weekday:S},R={year:g,month:T,day:g},P={year:g,month:T,day:g,weekday:T},I={hour:g,minute:g},N={hour:g,minute:g,second:g},b={hour:g,minute:g,second:g,timeZoneName:S},C={hour:g,minute:g,second:g,timeZoneName:T},L={hour:g,minute:g,hour12:!1},M={hour:g,minute:g,second:g,hour12:!1},w={hour:g,minute:g,second:g,hour12:!1,timeZoneName:S},D={hour:g,minute:g,second:g,hour12:!1,timeZoneName:T},j={year:g,month:g,day:g,hour:g,minute:g},U={year:g,month:g,day:g,hour:g,minute:g,second:g},x={year:g,month:S,day:g,hour:g,minute:g},G={year:g,month:S,day:g,hour:g,minute:g,second:g},k={year:g,month:S,day:g,weekday:S,hour:g,minute:g},B={year:g,month:T,day:g,hour:g,minute:g,timeZoneName:S},V={year:g,month:T,day:g,hour:g,minute:g,second:g,timeZoneName:S},F={year:g,month:T,day:g,weekday:T,hour:g,minute:g,timeZoneName:T},Y={year:g,month:T,day:g,weekday:T,hour:g,minute:g,second:g,timeZoneName:T};function H(e){return void 0===e}function W(e){return"number"==typeof e}function K(e){return"number"==typeof e&&e%1==0}function q(){try{return"undefined"!=typeof Intl&&Intl.DateTimeFormat}catch(e){return!1}}function X(){return!H(Intl.DateTimeFormat.prototype.formatToParts)}function $(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function J(e,t,n){if(0!==e.length)return e.reduce((function(e,i){var r=[t(i),i];return e&&n(e[0],r[0])===e[0]?e:r}),null)[1]}function z(e,t){return t.reduce((function(t,n){return t[n]=e[n],t}),{})}function Z(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Q(e,t,n){return K(e)&&e>=t&&e<=n}function ee(e,t){return void 0===t&&(t=2),e.toString().length<t?("0".repeat(t)+e).slice(-t):e.toString()}function te(e){return H(e)||null===e||""===e?void 0:parseInt(e,10)}function ne(e){if(!H(e)&&null!==e&&""!==e){var t=1e3*parseFloat("0."+e);return Math.floor(t)}}function ie(e,t,n){void 0===n&&(n=!1);var i=Math.pow(10,t);return(n?Math.trunc:Math.round)(e*i)/i}function re(e){return e%4==0&&(e%100!=0||e%400==0)}function oe(e){return re(e)?366:365}function ae(e,t){var n=function(e,t){return e-t*Math.floor(e/t)}(t-1,12)+1;return 2===n?re(e+(t-n)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function se(e){var t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t)).setUTCFullYear(t.getUTCFullYear()-1900),+t}function ce(e){var t=(e+Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400))%7,n=e-1,i=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7;return 4===t||3===i?53:52}function ue(e){return e>99?e:e>60?1900+e:2e3+e}function le(e,t,n,i){void 0===i&&(i=null);var r=new Date(e),o={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(o.timeZone=i);var a=Object.assign({timeZoneName:t},o),s=q();if(s&&X()){var c=new Intl.DateTimeFormat(n,a).formatToParts(r).find((function(e){return"timezonename"===e.type.toLowerCase()}));return c?c.value:null}if(s){var u=new Intl.DateTimeFormat(n,o).format(r);return new Intl.DateTimeFormat(n,a).format(r).substring(u.length).replace(/^[, \u200e]+/,"")}return null}function de(e,t){var n=parseInt(e,10);Number.isNaN(n)&&(n=0);var i=parseInt(t,10)||0;return 60*n+(n<0||Object.is(n,-0)?-i:i)}function he(e){var t=Number(e);if("boolean"==typeof e||""===e||Number.isNaN(t))throw new y("Invalid unit value "+e);return t}function fe(e,t,n){var i={};for(var r in e)if(Z(e,r)){if(n.indexOf(r)>=0)continue;var o=e[r];if(null==o)continue;i[t(r)]=he(o)}return i}function pe(e,t){var n=Math.trunc(Math.abs(e/60)),i=Math.trunc(Math.abs(e%60)),r=e>=0?"+":"-";switch(t){case"short":return""+r+ee(n,2)+":"+ee(i,2);case"narrow":return""+r+n+(i>0?":"+i:"");case"techie":return""+r+ee(n,2)+ee(i,2);default:throw new RangeError("Value format "+t+" is out of range for property format")}}function _e(e){return z(e,["hour","minute","second","millisecond"])}var Ee=/[A-Za-z_+-]{1,256}(:?\/[A-Za-z_+-]{1,256}(\/[A-Za-z_+-]{1,256})?)?/;function ye(e){return JSON.stringify(e,Object.keys(e).sort())}var ve=["January","February","March","April","May","June","July","August","September","October","November","December"],ge=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Se=["J","F","M","A","M","J","J","A","S","O","N","D"];function Te(e){switch(e){case"narrow":return Se;case"short":return ge;case"long":return ve;case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var Oe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],me=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Ae=["M","T","W","T","F","S","S"];function Re(e){switch(e){case"narrow":return Ae;case"short":return me;case"long":return Oe;case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var Pe=["AM","PM"],Ie=["Before Christ","Anno Domini"],Ne=["BC","AD"],be=["B","A"];function Ce(e){switch(e){case"narrow":return be;case"short":return Ne;case"long":return Ie;default:return null}}function Le(e,t){for(var n,i="",r=l(e);!(n=r()).done;){var o=n.value;o.literal?i+=o.val:i+=t(o.val)}return i}var Me={D:O,DD:m,DDD:R,DDDD:P,t:I,tt:N,ttt:b,tttt:C,T:L,TT:M,TTT:w,TTTT:D,f:j,ff:x,fff:B,ffff:F,F:U,FF:G,FFF:V,FFFF:Y},we=function(){function e(e,t){this.opts=t,this.loc=e,this.systemLoc=null}e.create=function(t,n){return void 0===n&&(n={}),new e(t,n)},e.parseFormat=function(e){for(var t=null,n="",i=!1,r=[],o=0;o<e.length;o++){var a=e.charAt(o);"'"===a?(n.length>0&&r.push({literal:i,val:n}),t=null,n="",i=!i):i||a===t?n+=a:(n.length>0&&r.push({literal:!1,val:n}),n=a,t=a)}return n.length>0&&r.push({literal:i,val:n}),r},e.macroTokenToFormatOpts=function(e){return Me[e]};var t=e.prototype;return t.formatWithSystemDefault=function(e,t){return null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTime=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).format()},t.formatDateTimeParts=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).formatToParts()},t.resolvedOptions=function(e,t){return void 0===t&&(t={}),this.loc.dtFormatter(e,Object.assign({},this.opts,t)).resolvedOptions()},t.num=function(e,t){if(void 0===t&&(t=0),this.opts.forceSimple)return ee(e,t);var n=Object.assign({},this.opts);return t>0&&(n.padTo=t),this.loc.numberFormatter(n).format(e)},t.formatDateTimeFromString=function(t,n){var i=this,r="en"===this.loc.listingMode(),o=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar&&X(),a=function(e,n){return i.loc.extract(t,e,n)},s=function(e){return t.isOffsetFixed&&0===t.offset&&e.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,e.format):""},c=function(){return r?function(e){return Pe[e.hour<12?0:1]}(t):a({hour:"numeric",hour12:!0},"dayperiod")},u=function(e,n){return r?function(e,t){return Te(t)[e.month-1]}(t,e):a(n?{month:e}:{month:e,day:"numeric"},"month")},l=function(e,n){return r?function(e,t){return Re(t)[e.weekday-1]}(t,e):a(n?{weekday:e}:{weekday:e,month:"long",day:"numeric"},"weekday")},d=function(e){return r?function(e,t){return Ce(t)[e.year<0?0:1]}(t,e):a({era:e},"era")};return Le(e.parseFormat(n),(function(n){switch(n){case"S":return i.num(t.millisecond);case"u":case"SSS":return i.num(t.millisecond,3);case"s":return i.num(t.second);case"ss":return i.num(t.second,2);case"m":return i.num(t.minute);case"mm":return i.num(t.minute,2);case"h":return i.num(t.hour%12==0?12:t.hour%12);case"hh":return i.num(t.hour%12==0?12:t.hour%12,2);case"H":return i.num(t.hour);case"HH":return i.num(t.hour,2);case"Z":return s({format:"narrow",allowZ:i.opts.allowZ});case"ZZ":return s({format:"short",allowZ:i.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:i.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:i.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:i.loc.locale});case"z":return t.zoneName;case"a":return c();case"d":return o?a({day:"numeric"},"day"):i.num(t.day);case"dd":return o?a({day:"2-digit"},"day"):i.num(t.day,2);case"c":case"E":return i.num(t.weekday);case"ccc":return l("short",!0);case"cccc":return l("long",!0);case"ccccc":return l("narrow",!0);case"EEE":return l("short",!1);case"EEEE":return l("long",!1);case"EEEEE":return l("narrow",!1);case"L":return o?a({month:"numeric",day:"numeric"},"month"):i.num(t.month);case"LL":return o?a({month:"2-digit",day:"numeric"},"month"):i.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return o?a({month:"numeric"},"month"):i.num(t.month);case"MM":return o?a({month:"2-digit"},"month"):i.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return o?a({year:"numeric"},"year"):i.num(t.year);case"yy":return o?a({year:"2-digit"},"year"):i.num(t.year.toString().slice(-2),2);case"yyyy":return o?a({year:"numeric"},"year"):i.num(t.year,4);case"yyyyyy":return o?a({year:"numeric"},"year"):i.num(t.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return i.num(t.weekYear.toString().slice(-2),2);case"kkkk":return i.num(t.weekYear,4);case"W":return i.num(t.weekNumber);case"WW":return i.num(t.weekNumber,2);case"o":return i.num(t.ordinal);case"ooo":return i.num(t.ordinal,3);case"q":return i.num(t.quarter);case"qq":return i.num(t.quarter,2);case"X":return i.num(Math.floor(t.ts/1e3));case"x":return i.num(t.ts);default:return function(n){var r=e.macroTokenToFormatOpts(n);return r?i.formatWithSystemDefault(t,r):n}(n)}}))},t.formatDurationFromString=function(t,n){var i,r=this,o=function(e){switch(e[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"M":return"month";case"y":return"year";default:return null}},a=e.parseFormat(n),s=a.reduce((function(e,t){var n=t.literal,i=t.val;return n?e:e.concat(i)}),[]),c=t.shiftTo.apply(t,s.map(o).filter((function(e){return e})));return Le(a,(i=c,function(e){var t=o(e);return t?r.num(i.get(t),e.length):e}))},e}(),De=function(){function e(e,t){this.reason=e,this.explanation=t}return e.prototype.toMessage=function(){return this.explanation?this.reason+": "+this.explanation:this.reason},e}(),je=function(){function e(){}var t=e.prototype;return t.offsetName=function(e,t){throw new v},t.formatOffset=function(e,t){throw new v},t.offset=function(e){throw new v},t.equals=function(e){throw new v},i(e,[{key:"type",get:function(){throw new v}},{key:"name",get:function(){throw new v}},{key:"universal",get:function(){throw new v}},{key:"isValid",get:function(){throw new v}}]),e}(),Ue=null,xe=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.offsetName=function(e,t){return le(e,t.format,t.locale)},n.formatOffset=function(e,t){return pe(this.offset(e),t)},n.offset=function(e){return-new Date(e).getTimezoneOffset()},n.equals=function(e){return"local"===e.type},i(t,[{key:"type",get:function(){return"local"}},{key:"name",get:function(){return q()?(new Intl.DateTimeFormat).resolvedOptions().timeZone:"local"}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!0}}],[{key:"instance",get:function(){return null===Ue&&(Ue=new t),Ue}}]),t}(je),Ge=RegExp("^"+Ee.source+"$"),ke={};var Be={year:0,month:1,day:2,hour:3,minute:4,second:5};var Ve={},Fe=function(e){function t(n){var i;return(i=e.call(this)||this).zoneName=n,i.valid=t.isValidZone(n),i}r(t,e),t.create=function(e){return Ve[e]||(Ve[e]=new t(e)),Ve[e]},t.resetCache=function(){Ve={},ke={}},t.isValidSpecifier=function(e){return!(!e||!e.match(Ge))},t.isValidZone=function(e){try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch(e){return!1}},t.parseGMTOffset=function(e){if(e){var t=e.match(/^Etc\/GMT([+-]\d{1,2})$/i);if(t)return-60*parseInt(t[1])}return null};var n=t.prototype;return n.offsetName=function(e,t){return le(e,t.format,t.locale,this.name)},n.formatOffset=function(e,t){return pe(this.offset(e),t)},n.offset=function(e){var t,n=new Date(e),i=(t=this.name,ke[t]||(ke[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),ke[t]),r=i.formatToParts?function(e,t){for(var n=e.formatToParts(t),i=[],r=0;r<n.length;r++){var o=n[r],a=o.type,s=o.value,c=Be[a];H(c)||(i[c]=parseInt(s,10))}return i}(i,n):function(e,t){var n=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(n),r=i[1],o=i[2];return[i[3],r,o,i[4],i[5],i[6]]}(i,n),o=r[0],a=r[1],s=r[2],c=r[3],u=+n,l=u%1e3;return(se({year:o,month:a,day:s,hour:24===c?0:c,minute:r[4],second:r[5],millisecond:0})-(u-=l>=0?l:1e3+l))/6e4},n.equals=function(e){return"iana"===e.type&&e.name===this.name},i(t,[{key:"type",get:function(){return"iana"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return this.valid}}]),t}(je),Ye=null,He=function(e){function t(t){var n;return(n=e.call(this)||this).fixed=t,n}r(t,e),t.instance=function(e){return 0===e?t.utcInstance:new t(e)},t.parseSpecifier=function(e){if(e){var n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new t(de(n[1],n[2]))}return null},i(t,null,[{key:"utcInstance",get:function(){return null===Ye&&(Ye=new t(0)),Ye}}]);var n=t.prototype;return n.offsetName=function(){return this.name},n.formatOffset=function(e,t){return pe(this.fixed,t)},n.offset=function(){return this.fixed},n.equals=function(e){return"fixed"===e.type&&e.fixed===this.fixed},i(t,[{key:"type",get:function(){return"fixed"}},{key:"name",get:function(){return 0===this.fixed?"UTC":"UTC"+pe(this.fixed,"narrow")}},{key:"universal",get:function(){return!0}},{key:"isValid",get:function(){return!0}}]),t}(je),We=function(e){function t(t){var n;return(n=e.call(this)||this).zoneName=t,n}r(t,e);var n=t.prototype;return n.offsetName=function(){return null},n.formatOffset=function(){return""},n.offset=function(){return NaN},n.equals=function(){return!1},i(t,[{key:"type",get:function(){return"invalid"}},{key:"name",get:function(){return this.zoneName}},{key:"universal",get:function(){return!1}},{key:"isValid",get:function(){return!1}}]),t}(je);function Ke(e,t){var n;if(H(e)||null===e)return t;if(e instanceof je)return e;if("string"==typeof e){var i=e.toLowerCase();return"local"===i?t:"utc"===i||"gmt"===i?He.utcInstance:null!=(n=Fe.parseGMTOffset(e))?He.instance(n):Fe.isValidSpecifier(i)?Fe.create(e):He.parseSpecifier(i)||new We(e)}return W(e)?He.instance(e):"object"==typeof e&&e.offset&&"number"==typeof e.offset?e:new We(e)}var qe=function(){return Date.now()},Xe=null,$e=null,Je=null,ze=null,Ze=!1,Qe=function(){function e(){}return e.resetCaches=function(){lt.resetCache(),Fe.resetCache()},i(e,null,[{key:"now",get:function(){return qe},set:function(e){qe=e}},{key:"defaultZoneName",get:function(){return e.defaultZone.name},set:function(e){Xe=e?Ke(e):null}},{key:"defaultZone",get:function(){return Xe||xe.instance}},{key:"defaultLocale",get:function(){return $e},set:function(e){$e=e}},{key:"defaultNumberingSystem",get:function(){return Je},set:function(e){Je=e}},{key:"defaultOutputCalendar",get:function(){return ze},set:function(e){ze=e}},{key:"throwOnInvalid",get:function(){return Ze},set:function(e){Ze=e}}]),e}(),et={};function tt(e,t){void 0===t&&(t={});var n=JSON.stringify([e,t]),i=et[n];return i||(i=new Intl.DateTimeFormat(e,t),et[n]=i),i}var nt={};var it={};function rt(e,t){void 0===t&&(t={});var n=t,i=(n.base,function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(n,["base"])),r=JSON.stringify([e,i]),o=it[r];return o||(o=new Intl.RelativeTimeFormat(e,t),it[r]=o),o}var ot=null;function at(e,t,n,i,r){var o=e.listingMode(n);return"error"===o?null:"en"===o?i(t):r(t)}var st=function(){function e(e,t,n){if(this.padTo=n.padTo||0,this.floor=n.floor||!1,!t&&q()){var i={useGrouping:!1};n.padTo>0&&(i.minimumIntegerDigits=n.padTo),this.inf=function(e,t){void 0===t&&(t={});var n=JSON.stringify([e,t]),i=nt[n];return i||(i=new Intl.NumberFormat(e,t),nt[n]=i),i}(e,i)}}return e.prototype.format=function(e){if(this.inf){var t=this.floor?Math.floor(e):e;return this.inf.format(t)}return ee(this.floor?Math.floor(e):ie(e,3),this.padTo)},e}(),ct=function(){function e(e,t,n){var i;if(this.opts=n,this.hasIntl=q(),e.zone.universal&&this.hasIntl?(i="UTC",n.timeZoneName?this.dt=e:this.dt=0===e.offset?e:di.fromMillis(e.ts+60*e.offset*1e3)):"local"===e.zone.type?this.dt=e:(this.dt=e,i=e.zone.name),this.hasIntl){var r=Object.assign({},this.opts);i&&(r.timeZone=i),this.dtf=tt(t,r)}}var t=e.prototype;return t.format=function(){if(this.hasIntl)return this.dtf.format(this.dt.toJSDate());var e=function(e){var t="EEEE, LLLL d, yyyy, h:mm a";switch(ye(z(e,["weekday","era","year","month","day","hour","minute","second","timeZoneName","hour12"]))){case ye(O):return"M/d/yyyy";case ye(m):return"LLL d, yyyy";case ye(A):return"EEE, LLL d, yyyy";case ye(R):return"LLLL d, yyyy";case ye(P):return"EEEE, LLLL d, yyyy";case ye(I):return"h:mm a";case ye(N):return"h:mm:ss a";case ye(b):case ye(C):return"h:mm a";case ye(L):return"HH:mm";case ye(M):return"HH:mm:ss";case ye(w):case ye(D):return"HH:mm";case ye(j):return"M/d/yyyy, h:mm a";case ye(x):return"LLL d, yyyy, h:mm a";case ye(B):return"LLLL d, yyyy, h:mm a";case ye(F):return t;case ye(U):return"M/d/yyyy, h:mm:ss a";case ye(G):return"LLL d, yyyy, h:mm:ss a";case ye(k):return"EEE, d LLL yyyy, h:mm a";case ye(V):return"LLLL d, yyyy, h:mm:ss a";case ye(Y):return"EEEE, LLLL d, yyyy, h:mm:ss a";default:return t}}(this.opts),t=lt.create("en-US");return we.create(t).formatDateTimeFromString(this.dt,e)},t.formatToParts=function(){return this.hasIntl&&X()?this.dtf.formatToParts(this.dt.toJSDate()):[]},t.resolvedOptions=function(){return this.hasIntl?this.dtf.resolvedOptions():{locale:"en-US",numberingSystem:"latn",outputCalendar:"gregory"}},e}(),ut=function(){function e(e,t,n){this.opts=Object.assign({style:"long"},n),!t&&$()&&(this.rtf=rt(e,n))}var t=e.prototype;return t.format=function(e,t){return this.rtf?this.rtf.format(e,t):function(e,t,n,i){void 0===n&&(n="always"),void 0===i&&(i=!1);var r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=-1===["hours","minutes","seconds"].indexOf(e);if("auto"===n&&o){var a="days"===e;switch(t){case 1:return a?"tomorrow":"next "+r[e][0];case-1:return a?"yesterday":"last "+r[e][0];case 0:return a?"today":"this "+r[e][0]}}var s=Object.is(t,-0)||t<0,c=Math.abs(t),u=1===c,l=r[e],d=i?u?l[1]:l[2]||l[1]:u?r[e][0]:e;return s?c+" "+d+" ago":"in "+c+" "+d}(t,e,this.opts.numeric,"long"!==this.opts.style)},t.formatToParts=function(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]},e}(),lt=function(){function e(e,t,n,i){var r=function(e){var t=e.indexOf("-u-");if(-1===t)return[e];var n,i=e.substring(0,t);try{n=tt(e).resolvedOptions()}catch(e){n=tt(i).resolvedOptions()}var r=n;return[i,r.numberingSystem,r.calendar]}(e),o=r[0],a=r[1],s=r[2];this.locale=o,this.numberingSystem=t||a||null,this.outputCalendar=n||s||null,this.intl=function(e,t,n){return q()?n||t?(e+="-u",n&&(e+="-ca-"+n),t&&(e+="-nu-"+t),e):e:[]}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=i,this.fastNumbersCached=null}e.fromOpts=function(t){return e.create(t.locale,t.numberingSystem,t.outputCalendar,t.defaultToEN)},e.create=function(t,n,i,r){void 0===r&&(r=!1);var o=t||Qe.defaultLocale;return new e(o||(r?"en-US":function(){if(ot)return ot;if(q()){var e=(new Intl.DateTimeFormat).resolvedOptions().locale;return ot=e&&"und"!==e?e:"en-US"}return ot="en-US"}()),n||Qe.defaultNumberingSystem,i||Qe.defaultOutputCalendar,o)},e.resetCache=function(){ot=null,et={},nt={},it={}},e.fromObject=function(t){var n=void 0===t?{}:t,i=n.locale,r=n.numberingSystem,o=n.outputCalendar;return e.create(i,r,o)};var t=e.prototype;return t.listingMode=function(e){void 0===e&&(e=!0);var t=q()&&X(),n=this.isEnglish(),i=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return t||n&&i||e?!t||n&&i?"en":"intl":"error"},t.clone=function(t){return t&&0!==Object.getOwnPropertyNames(t).length?e.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,t.defaultToEN||!1):this},t.redefaultToEN=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!0}))},t.redefaultToSystem=function(e){return void 0===e&&(e={}),this.clone(Object.assign({},e,{defaultToEN:!1}))},t.months=function(e,t,n){var i=this;return void 0===t&&(t=!1),void 0===n&&(n=!0),at(this,e,n,Te,(function(){var n=t?{month:e,day:"numeric"}:{month:e},r=t?"format":"standalone";return i.monthsCache[r][e]||(i.monthsCache[r][e]=function(e){for(var t=[],n=1;n<=12;n++){var i=di.utc(2016,n,1);t.push(e(i))}return t}((function(e){return i.extract(e,n,"month")}))),i.monthsCache[r][e]}))},t.weekdays=function(e,t,n){var i=this;return void 0===t&&(t=!1),void 0===n&&(n=!0),at(this,e,n,Re,(function(){var n=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},r=t?"format":"standalone";return i.weekdaysCache[r][e]||(i.weekdaysCache[r][e]=function(e){for(var t=[],n=1;n<=7;n++){var i=di.utc(2016,11,13+n);t.push(e(i))}return t}((function(e){return i.extract(e,n,"weekday")}))),i.weekdaysCache[r][e]}))},t.meridiems=function(e){var t=this;return void 0===e&&(e=!0),at(this,void 0,e,(function(){return Pe}),(function(){if(!t.meridiemCache){var e={hour:"numeric",hour12:!0};t.meridiemCache=[di.utc(2016,11,13,9),di.utc(2016,11,13,19)].map((function(n){return t.extract(n,e,"dayperiod")}))}return t.meridiemCache}))},t.eras=function(e,t){var n=this;return void 0===t&&(t=!0),at(this,e,t,Ce,(function(){var t={era:e};return n.eraCache[e]||(n.eraCache[e]=[di.utc(-40,1,1),di.utc(2017,1,1)].map((function(e){return n.extract(e,t,"era")}))),n.eraCache[e]}))},t.extract=function(e,t,n){var i=this.dtFormatter(e,t).formatToParts().find((function(e){return e.type.toLowerCase()===n}));return i?i.value:null},t.numberFormatter=function(e){return void 0===e&&(e={}),new st(this.intl,e.forceSimple||this.fastNumbers,e)},t.dtFormatter=function(e,t){return void 0===t&&(t={}),new ct(e,this.intl,t)},t.relFormatter=function(e){return void 0===e&&(e={}),new ut(this.intl,this.isEnglish(),e)},t.isEnglish=function(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||q()&&new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")},t.equals=function(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar},i(e,[{key:"fastNumbers",get:function(){var e;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(e=this).numberingSystem||"latn"===e.numberingSystem)&&("latn"===e.numberingSystem||!e.locale||e.locale.startsWith("en")||q()&&"latn"===new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem)),this.fastNumbersCached}}]),e}();function dt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.reduce((function(e,t){return e+t.source}),"");return RegExp("^"+i+"$")}function ht(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){var i=t[0],r=t[1],o=t[2],a=n(e,o),s=a[0],c=a[1],u=a[2];return[Object.assign(i,s),r||c,u]}),[{},null,1]).slice(0,2)}}function ft(e){if(null==e)return[null,null];for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r],s=a[0],c=a[1],u=s.exec(e);if(u)return c(u)}return[null,null]}function pt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){var i,r={};for(i=0;i<t.length;i++)r[t[i]]=te(e[n+i]);return[r,null,n+i]}}var _t=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Et=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,yt=RegExp(""+Et.source+_t.source+"?"),vt=RegExp("(?:T"+yt.source+")?"),gt=pt("weekYear","weekNumber","weekDay"),St=pt("year","ordinal"),Tt=RegExp(Et.source+" ?(?:"+_t.source+"|("+Ee.source+"))?"),Ot=RegExp("(?: "+Tt.source+")?");function mt(e,t,n){var i=e[t];return H(i)?n:te(i)}function At(e,t){return[{year:mt(e,t),month:mt(e,t+1,1),day:mt(e,t+2,1)},null,t+3]}function Rt(e,t){return[{hour:mt(e,t,0),minute:mt(e,t+1,0),second:mt(e,t+2,0),millisecond:ne(e[t+3])},null,t+4]}function Pt(e,t){var n=!e[t]&&!e[t+1],i=de(e[t+1],e[t+2]);return[{},n?null:He.instance(i),t+3]}function It(e,t){return[{},e[t]?Fe.create(e[t]):null,t+1]}var Nt=/^-?P(?:(?:(-?\d{1,9})Y)?(?:(-?\d{1,9})M)?(?:(-?\d{1,9})W)?(?:(-?\d{1,9})D)?(?:T(?:(-?\d{1,9})H)?(?:(-?\d{1,9})M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,9}))?S)?)?)$/;function bt(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l="-"===t[0],d=function(e){return e&&l?-e:e};return[{years:d(te(n)),months:d(te(i)),weeks:d(te(r)),days:d(te(o)),hours:d(te(a)),minutes:d(te(s)),seconds:d(te(c)),milliseconds:d(ne(u))}]}var Ct={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Lt(e,t,n,i,r,o,a){var s={year:2===t.length?ue(te(t)):te(t),month:ge.indexOf(n)+1,day:te(i),hour:te(r),minute:te(o)};return a&&(s.second=te(a)),e&&(s.weekday=e.length>3?Oe.indexOf(e)+1:me.indexOf(e)+1),s}var Mt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function wt(e){var t,n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8],l=e[9],d=e[10],h=e[11],f=Lt(n,o,r,i,a,s,c);return t=u?Ct[u]:l?0:de(d,h),[f,new He(t)]}var Dt=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,jt=/^(Monday|Tuesday|Wedsday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Ut=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function xt(e){var t=e[1],n=e[2],i=e[3];return[Lt(t,e[4],i,n,e[5],e[6],e[7]),He.utcInstance]}function Gt(e){var t=e[1],n=e[2],i=e[3],r=e[4],o=e[5],a=e[6];return[Lt(t,e[7],n,i,r,o,a),He.utcInstance]}var kt=dt(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,vt),Bt=dt(/(\d{4})-?W(\d\d)(?:-?(\d))?/,vt),Vt=dt(/(\d{4})-?(\d{3})/,vt),Ft=dt(yt),Yt=ht(At,Rt,Pt),Ht=ht(gt,Rt,Pt),Wt=ht(St,Rt),Kt=ht(Rt,Pt);var qt=dt(/(\d{4})-(\d\d)-(\d\d)/,Ot),Xt=dt(Tt),$t=ht(At,Rt,Pt,It),Jt=ht(Rt,Pt,It);var zt={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},Zt=Object.assign({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},zt),Qt=365.2425,en=30.436875,tn=Object.assign({years:{quarters:4,months:12,weeks:52.1775,days:Qt,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:en,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},zt),nn=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],rn=nn.slice(0).reverse();function on(e,t,n){void 0===n&&(n=!1);var i={values:n?t.values:Object.assign({},e.values,t.values||{}),loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy};return new sn(i)}function an(e,t,n,i,r){var o=e[r][n],a=t[n]/o,s=!(Math.sign(a)===Math.sign(i[r]))&&0!==i[r]&&Math.abs(a)<=1?function(e){return e<0?Math.floor(e):Math.ceil(e)}(a):Math.trunc(a);i[r]+=s,t[n]-=s*o}var sn=function(){function e(e){var t="longterm"===e.conversionAccuracy||!1;this.values=e.values,this.loc=e.loc||lt.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=t?tn:Zt,this.isLuxonDuration=!0}e.fromMillis=function(t,n){return e.fromObject(Object.assign({milliseconds:t},n))},e.fromObject=function(t){if(null==t||"object"!=typeof t)throw new y("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new e({values:fe(t,e.normalizeUnit,["locale","numberingSystem","conversionAccuracy","zone"]),loc:lt.fromObject(t),conversionAccuracy:t.conversionAccuracy})},e.fromISO=function(t,n){var i=function(e){return ft(e,[Nt,bt])}(t),r=i[0];if(r){var o=Object.assign(r,n);return e.fromObject(o)}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new y("need to specify a reason the Duration is invalid");var i=t instanceof De?t:new De(t,n);if(Qe.throwOnInvalid)throw new p(i);return new e({invalid:i})},e.normalizeUnit=function(e){var t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e?e.toLowerCase():e];if(!t)throw new E(e);return t},e.isDuration=function(e){return e&&e.isLuxonDuration||!1};var t=e.prototype;return t.toFormat=function(e,t){void 0===t&&(t={});var n=Object.assign({},t,{floor:!1!==t.round&&!1!==t.floor});return this.isValid?we.create(this.loc,n).formatDurationFromString(this,e):"Invalid Duration"},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.values);return e.includeConfig&&(t.conversionAccuracy=this.conversionAccuracy,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toISO=function(){if(!this.isValid)return null;var e="P";return 0!==this.years&&(e+=this.years+"Y"),0===this.months&&0===this.quarters||(e+=this.months+3*this.quarters+"M"),0!==this.weeks&&(e+=this.weeks+"W"),0!==this.days&&(e+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(e+="T"),0!==this.hours&&(e+=this.hours+"H"),0!==this.minutes&&(e+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(e+=ie(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===e&&(e+="T0S"),e},t.toJSON=function(){return this.toISO()},t.toString=function(){return this.toISO()},t.valueOf=function(){return this.as("milliseconds")},t.plus=function(e){if(!this.isValid)return this;for(var t,n=cn(e),i={},r=l(nn);!(t=r()).done;){var o=t.value;(Z(n.values,o)||Z(this.values,o))&&(i[o]=n.get(o)+this.get(o))}return on(this,{values:i},!0)},t.minus=function(e){if(!this.isValid)return this;var t=cn(e);return this.plus(t.negate())},t.mapUnits=function(e){if(!this.isValid)return this;for(var t={},n=0,i=Object.keys(this.values);n<i.length;n++){var r=i[n];t[r]=he(e(this.values[r],r))}return on(this,{values:t},!0)},t.get=function(t){return this[e.normalizeUnit(t)]},t.set=function(t){return this.isValid?on(this,{values:Object.assign(this.values,fe(t,e.normalizeUnit,[]))}):this},t.reconfigure=function(e){var t=void 0===e?{}:e,n=t.locale,i=t.numberingSystem,r=t.conversionAccuracy,o={loc:this.loc.clone({locale:n,numberingSystem:i})};return r&&(o.conversionAccuracy=r),on(this,o)},t.as=function(e){return this.isValid?this.shiftTo(e).get(e):NaN},t.normalize=function(){if(!this.isValid)return this;var e=this.toObject();return function(e,t){rn.reduce((function(n,i){return H(t[i])?n:(n&&an(e,t,n,t,i),i)}),null)}(this.matrix,e),on(this,{values:e},!0)},t.shiftTo=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!this.isValid)return this;if(0===n.length)return this;n=n.map((function(t){return e.normalizeUnit(t)}));for(var r,o,a={},s={},c=this.toObject(),u=l(nn);!(o=u()).done;){var d=o.value;if(n.indexOf(d)>=0){r=d;var h=0;for(var f in s)h+=this.matrix[f][d]*s[f],s[f]=0;W(c[d])&&(h+=c[d]);var p=Math.trunc(h);for(var _ in a[d]=p,s[d]=h-p,c)nn.indexOf(_)>nn.indexOf(d)&&an(this.matrix,c,_,a,d)}else W(c[d])&&(s[d]=c[d])}for(var E in s)0!==s[E]&&(a[r]+=E===r?s[E]:s[E]/this.matrix[r][E]);return on(this,{values:a},!0).normalize()},t.negate=function(){if(!this.isValid)return this;for(var e={},t=0,n=Object.keys(this.values);t<n.length;t++){var i=n[t];e[i]=-this.values[i]}return on(this,{values:e},!0)},t.equals=function(e){if(!this.isValid||!e.isValid)return!1;if(!this.loc.equals(e.loc))return!1;for(var t,n=l(nn);!(t=n()).done;){var i=t.value;if(this.values[i]!==e.values[i])return!1}return!0},i(e,[{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"years",get:function(){return this.isValid?this.values.years||0:NaN}},{key:"quarters",get:function(){return this.isValid?this.values.quarters||0:NaN}},{key:"months",get:function(){return this.isValid?this.values.months||0:NaN}},{key:"weeks",get:function(){return this.isValid?this.values.weeks||0:NaN}},{key:"days",get:function(){return this.isValid?this.values.days||0:NaN}},{key:"hours",get:function(){return this.isValid?this.values.hours||0:NaN}},{key:"minutes",get:function(){return this.isValid?this.values.minutes||0:NaN}},{key:"seconds",get:function(){return this.isValid?this.values.seconds||0:NaN}},{key:"milliseconds",get:function(){return this.isValid?this.values.milliseconds||0:NaN}},{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}();function cn(e){if(W(e))return sn.fromMillis(e);if(sn.isDuration(e))return e;if("object"==typeof e)return sn.fromObject(e);throw new y("Unknown duration argument "+e+" of type "+typeof e)}var un="Invalid Interval";function ln(e,t){return e&&e.isValid?t&&t.isValid?t<e?dn.invalid("end before start","The end of an interval must be after its start, but you had start="+e.toISO()+" and end="+t.toISO()):null:dn.invalid("missing or invalid end"):dn.invalid("missing or invalid start")}var dn=function(){function e(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new y("need to specify a reason the Interval is invalid");var i=t instanceof De?t:new De(t,n);if(Qe.throwOnInvalid)throw new f(i);return new e({invalid:i})},e.fromDateTimes=function(t,n){var i=hi(t),r=hi(n),o=ln(i,r);return null==o?new e({start:i,end:r}):o},e.after=function(t,n){var i=cn(n),r=hi(t);return e.fromDateTimes(r,r.plus(i))},e.before=function(t,n){var i=cn(n),r=hi(t);return e.fromDateTimes(r.minus(i),r)},e.fromISO=function(t,n){var i=(t||"").split("/",2),r=i[0],o=i[1];if(r&&o){var a,s,c,u;try{s=(a=di.fromISO(r,n)).isValid}catch(o){s=!1}try{u=(c=di.fromISO(o,n)).isValid}catch(o){u=!1}if(s&&u)return e.fromDateTimes(a,c);if(s){var l=sn.fromISO(o,n);if(l.isValid)return e.after(a,l)}else if(u){var d=sn.fromISO(r,n);if(d.isValid)return e.before(c,d)}}return e.invalid("unparsable",'the input "'+t+"\" can't be parsed as ISO 8601")},e.isInterval=function(e){return e&&e.isLuxonInterval||!1};var t=e.prototype;return t.length=function(e){return void 0===e&&(e="milliseconds"),this.isValid?this.toDuration.apply(this,[e]).get(e):NaN},t.count=function(e){if(void 0===e&&(e="milliseconds"),!this.isValid)return NaN;var t=this.start.startOf(e),n=this.end.startOf(e);return Math.floor(n.diff(t,e).get(e))+1},t.hasSame=function(e){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,e))},t.isEmpty=function(){return this.s.valueOf()===this.e.valueOf()},t.isAfter=function(e){return!!this.isValid&&this.s>e},t.isBefore=function(e){return!!this.isValid&&this.e<=e},t.contains=function(e){return!!this.isValid&&(this.s<=e&&this.e>e)},t.set=function(t){var n=void 0===t?{}:t,i=n.start,r=n.end;return this.isValid?e.fromDateTimes(i||this.s,r||this.e):this},t.splitAt=function(){var t=this;if(!this.isValid)return[];for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(var o=i.map(hi).filter((function(e){return t.contains(e)})).sort(),a=[],s=this.s,c=0;s<this.e;){var u=o[c]||this.e,l=+u>+this.e?this.e:u;a.push(e.fromDateTimes(s,l)),s=l,c+=1}return a},t.splitBy=function(t){var n=cn(t);if(!this.isValid||!n.isValid||0===n.as("milliseconds"))return[];for(var i,r,o=this.s,a=[];o<this.e;)r=+(i=o.plus(n))>+this.e?this.e:i,a.push(e.fromDateTimes(o,r)),o=r;return a},t.divideEqually=function(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]},t.overlaps=function(e){return this.e>e.s&&this.s<e.e},t.abutsStart=function(e){return!!this.isValid&&+this.e==+e.s},t.abutsEnd=function(e){return!!this.isValid&&+e.e==+this.s},t.engulfs=function(e){return!!this.isValid&&(this.s<=e.s&&this.e>=e.e)},t.equals=function(e){return!(!this.isValid||!e.isValid)&&(this.s.equals(e.s)&&this.e.equals(e.e))},t.intersection=function(t){if(!this.isValid)return this;var n=this.s>t.s?this.s:t.s,i=this.e<t.e?this.e:t.e;return n>i?null:e.fromDateTimes(n,i)},t.union=function(t){if(!this.isValid)return this;var n=this.s<t.s?this.s:t.s,i=this.e>t.e?this.e:t.e;return e.fromDateTimes(n,i)},e.merge=function(e){var t=e.sort((function(e,t){return e.s-t.s})).reduce((function(e,t){var n=e[0],i=e[1];return i?i.overlaps(t)||i.abutsStart(t)?[n,i.union(t)]:[n.concat([i]),t]:[n,t]}),[[],null]),n=t[0],i=t[1];return i&&n.push(i),n},e.xor=function(t){for(var n,i,r=null,o=0,a=[],s=t.map((function(e){return[{time:e.s,type:"s"},{time:e.e,type:"e"}]})),c=l((n=Array.prototype).concat.apply(n,s).sort((function(e,t){return e.time-t.time})));!(i=c()).done;){var u=i.value;1===(o+="s"===u.type?1:-1)?r=u.time:(r&&+r!=+u.time&&a.push(e.fromDateTimes(r,u.time)),r=null)}return e.merge(a)},t.difference=function(){for(var t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.xor([this].concat(i)).map((function(e){return t.intersection(e)})).filter((function(e){return e&&!e.isEmpty()}))},t.toString=function(){return this.isValid?"["+this.s.toISO()+" – "+this.e.toISO()+")":un},t.toISO=function(e){return this.isValid?this.s.toISO(e)+"/"+this.e.toISO(e):un},t.toISODate=function(){return this.isValid?this.s.toISODate()+"/"+this.e.toISODate():un},t.toISOTime=function(e){return this.isValid?this.s.toISOTime(e)+"/"+this.e.toISOTime(e):un},t.toFormat=function(e,t){var n=(void 0===t?{}:t).separator,i=void 0===n?" – ":n;return this.isValid?""+this.s.toFormat(e)+i+this.e.toFormat(e):un},t.toDuration=function(e,t){return this.isValid?this.e.diff(this.s,e,t):sn.invalid(this.invalidReason)},t.mapEndpoints=function(t){return e.fromDateTimes(t(this.s),t(this.e))},i(e,[{key:"start",get:function(){return this.isValid?this.s:null}},{key:"end",get:function(){return this.isValid?this.e:null}},{key:"isValid",get:function(){return null===this.invalidReason}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}}]),e}(),hn=function(){function e(){}return e.hasDST=function(e){void 0===e&&(e=Qe.defaultZone);var t=di.local().setZone(e).set({month:12});return!e.universal&&t.offset!==t.set({month:6}).offset},e.isValidIANAZone=function(e){return Fe.isValidSpecifier(e)&&Fe.isValidZone(e)},e.normalizeZone=function(e){return Ke(e,Qe.defaultZone)},e.months=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,i=n.locale,r=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o,s=n.outputCalendar,c=void 0===s?"gregory":s;return lt.create(r,a,c).months(e)},e.monthsFormat=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,i=n.locale,r=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o,s=n.outputCalendar,c=void 0===s?"gregory":s;return lt.create(r,a,c).months(e,!0)},e.weekdays=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,i=n.locale,r=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o;return lt.create(r,a,null).weekdays(e)},e.weekdaysFormat=function(e,t){void 0===e&&(e="long");var n=void 0===t?{}:t,i=n.locale,r=void 0===i?null:i,o=n.numberingSystem,a=void 0===o?null:o;return lt.create(r,a,null).weekdays(e,!0)},e.meridiems=function(e){var t=(void 0===e?{}:e).locale,n=void 0===t?null:t;return lt.create(n).meridiems()},e.eras=function(e,t){void 0===e&&(e="short");var n=(void 0===t?{}:t).locale,i=void 0===n?null:n;return lt.create(i,null,"gregory").eras(e)},e.features=function(){var e=!1,t=!1,n=!1,i=!1;if(q()){e=!0,t=X(),i=$();try{n="America/New_York"===new Intl.DateTimeFormat("en",{timeZone:"America/New_York"}).resolvedOptions().timeZone}catch(e){n=!1}}return{intl:e,intlTokens:t,zones:n,relative:i}},e}();function fn(e,t){var n=function(e){return e.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf()},i=n(t)-n(e);return Math.floor(sn.fromMillis(i).as("days"))}function pn(e,t,n,i){var r=function(e,t,n){for(var i,r,o={},a=0,s=[["years",function(e,t){return t.year-e.year}],["months",function(e,t){return t.month-e.month+12*(t.year-e.year)}],["weeks",function(e,t){var n=fn(e,t);return(n-n%7)/7}],["days",fn]];a<s.length;a++){var c=s[a],u=c[0],l=c[1];if(n.indexOf(u)>=0){var d;i=u;var h,f=l(e,t);(r=e.plus(((d={})[u]=f,d)))>t?(e=e.plus(((h={})[u]=f-1,h)),f-=1):e=r,o[u]=f}}return[e,o,r,i]}(e,t,n),o=r[0],a=r[1],s=r[2],c=r[3],u=t-o,l=n.filter((function(e){return["hours","minutes","seconds","milliseconds"].indexOf(e)>=0}));if(0===l.length){var d;if(s<t)s=o.plus(((d={})[c]=1,d));s!==o&&(a[c]=(a[c]||0)+u/(s-o))}var h,f=sn.fromObject(Object.assign(a,i));return l.length>0?(h=sn.fromMillis(u,i)).shiftTo.apply(h,l).plus(f):f}var _n={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},En={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},yn=_n.hanidec.replace(/[\[|\]]/g,"").split("");function vn(e,t){var n=e.numberingSystem;return void 0===t&&(t=""),new RegExp(""+_n[n||"latn"]+t)}var gn="missing Intl.DateTimeFormat.formatToParts support";function Sn(e,t){return void 0===t&&(t=function(e){return e}),{regex:e,deser:function(e){var n=e[0];return t(function(e){var t=parseInt(e,10);if(isNaN(t)){t="";for(var n=0;n<e.length;n++){var i=e.charCodeAt(n);if(-1!==e[n].search(_n.hanidec))t+=yn.indexOf(e[n]);else for(var r in En){var o=En[r],a=o[0],s=o[1];i>=a&&i<=s&&(t+=i-a)}}return parseInt(t,10)}return t}(n))}}}var Tn="( |"+String.fromCharCode(160)+")",On=new RegExp(Tn,"g");function mn(e){return e.replace(/\./g,"\\.?").replace(On,Tn)}function An(e){return e.replace(/\./g,"").replace(On," ").toLowerCase()}function Rn(e,t){return null===e?null:{regex:RegExp(e.map(mn).join("|")),deser:function(n){var i=n[0];return e.findIndex((function(e){return An(i)===An(e)}))+t}}}function Pn(e,t){return{regex:e,deser:function(e){return de(e[1],e[2])},groups:t}}function In(e){return{regex:e,deser:function(e){return e[0]}}}var Nn={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"}};var bn=null;function Cn(e,t){if(e.literal)return e;var n=we.macroTokenToFormatOpts(e.val);if(!n)return e;var i=we.create(t,n).formatDateTimeParts((bn||(bn=di.fromMillis(1555555555555)),bn)).map((function(e){return function(e,t,n){var i=e.type,r=e.value;if("literal"===i)return{literal:!0,val:r};var o=n[i],a=Nn[i];return"object"==typeof a&&(a=a[o]),a?{literal:!1,val:a}:void 0}(e,0,n)}));return i.includes(void 0)?e:i}function Ln(e,t,n){var i=function(e,t){var n;return(n=Array.prototype).concat.apply(n,e.map((function(e){return Cn(e,t)})))}(we.parseFormat(n),e),r=i.map((function(t){return n=t,r=vn(i=e),o=vn(i,"{2}"),a=vn(i,"{3}"),s=vn(i,"{4}"),c=vn(i,"{6}"),u=vn(i,"{1,2}"),l=vn(i,"{1,3}"),d=vn(i,"{1,6}"),h=vn(i,"{1,9}"),f=vn(i,"{2,4}"),p=vn(i,"{4,6}"),_=function(e){return{regex:RegExp((t=e.val,t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:function(e){return e[0]},literal:!0};var t},E=function(e){if(n.literal)return _(e);switch(e.val){case"G":return Rn(i.eras("short",!1),0);case"GG":return Rn(i.eras("long",!1),0);case"y":return Sn(d);case"yy":case"kk":return Sn(f,ue);case"yyyy":case"kkkk":return Sn(s);case"yyyyy":return Sn(p);case"yyyyyy":return Sn(c);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return Sn(u);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return Sn(o);case"MMM":return Rn(i.months("short",!0,!1),1);case"MMMM":return Rn(i.months("long",!0,!1),1);case"LLL":return Rn(i.months("short",!1,!1),1);case"LLLL":return Rn(i.months("long",!1,!1),1);case"o":case"S":return Sn(l);case"ooo":case"SSS":return Sn(a);case"u":return In(h);case"a":return Rn(i.meridiems(),0);case"E":case"c":return Sn(r);case"EEE":return Rn(i.weekdays("short",!1,!1),1);case"EEEE":return Rn(i.weekdays("long",!1,!1),1);case"ccc":return Rn(i.weekdays("short",!0,!1),1);case"cccc":return Rn(i.weekdays("long",!0,!1),1);case"Z":case"ZZ":return Pn(new RegExp("([+-]"+u.source+")(?::("+o.source+"))?"),2);case"ZZZ":return Pn(new RegExp("([+-]"+u.source+")("+o.source+")?"),2);case"z":return In(/[a-z_+-/]{1,256}?/i);default:return _(e)}}(n)||{invalidReason:gn},E.token=n,E;var n,i,r,o,a,s,c,u,l,d,h,f,p,_,E})),o=r.find((function(e){return e.invalidReason}));if(o)return{input:t,tokens:i,invalidReason:o.invalidReason};var a=function(e){return["^"+e.map((function(e){return e.regex})).reduce((function(e,t){return e+"("+t.source+")"}),"")+"$",e]}(r),s=a[0],c=a[1],u=RegExp(s,"i"),l=function(e,t,n){var i=e.match(t);if(i){var r={},o=1;for(var a in n)if(Z(n,a)){var s=n[a],c=s.groups?s.groups+1:1;!s.literal&&s.token&&(r[s.token.val[0]]=s.deser(i.slice(o,o+c))),o+=c}return[i,r]}return[i,{}]}(t,u,c),d=l[0],h=l[1],f=h?function(e){var t;return t=H(e.Z)?H(e.z)?null:Fe.create(e.z):new He(e.Z),H(e.q)||(e.M=3*(e.q-1)+1),H(e.h)||(e.h<12&&1===e.a?e.h+=12:12===e.h&&0===e.a&&(e.h=0)),0===e.G&&e.y&&(e.y=-e.y),H(e.u)||(e.S=ne(e.u)),[Object.keys(e).reduce((function(t,n){var i=function(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}}(n);return i&&(t[i]=e[n]),t}),{}),t]}(h):[null,null],p=f[0],E=f[1];if(Z(h,"a")&&Z(h,"H"))throw new _("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:i,regex:u,rawMatches:d,matches:h,result:p,zone:E}}var Mn=[0,31,59,90,120,151,181,212,243,273,304,334],wn=[0,31,60,91,121,152,182,213,244,274,305,335];function Dn(e,t){return new De("unit out of range","you specified "+t+" (of type "+typeof t+") as a "+e+", which is invalid")}function jn(e,t,n){var i=new Date(Date.UTC(e,t-1,n)).getUTCDay();return 0===i?7:i}function Un(e,t,n){return n+(re(e)?wn:Mn)[t-1]}function xn(e,t){var n=re(e)?wn:Mn,i=n.findIndex((function(e){return e<t}));return{month:i+1,day:t-n[i]}}function Gn(e){var t,n=e.year,i=e.month,r=e.day,o=Un(n,i,r),a=jn(n,i,r),s=Math.floor((o-a+10)/7);return s<1?s=ce(t=n-1):s>ce(n)?(t=n+1,s=1):t=n,Object.assign({weekYear:t,weekNumber:s,weekday:a},_e(e))}function kn(e){var t,n=e.weekYear,i=e.weekNumber,r=e.weekday,o=jn(n,1,4),a=oe(n),s=7*i+r-o-3;s<1?s+=oe(t=n-1):s>a?(t=n+1,s-=oe(n)):t=n;var c=xn(t,s),u=c.month,l=c.day;return Object.assign({year:t,month:u,day:l},_e(e))}function Bn(e){var t=e.year,n=Un(t,e.month,e.day);return Object.assign({year:t,ordinal:n},_e(e))}function Vn(e){var t=e.year,n=xn(t,e.ordinal),i=n.month,r=n.day;return Object.assign({year:t,month:i,day:r},_e(e))}function Fn(e){var t=K(e.year),n=Q(e.month,1,12),i=Q(e.day,1,ae(e.year,e.month));return t?n?!i&&Dn("day",e.day):Dn("month",e.month):Dn("year",e.year)}function Yn(e){var t=e.hour,n=e.minute,i=e.second,r=e.millisecond,o=Q(t,0,23)||24===t&&0===n&&0===i&&0===r,a=Q(n,0,59),s=Q(i,0,59),c=Q(r,0,999);return o?a?s?!c&&Dn("millisecond",r):Dn("second",i):Dn("minute",n):Dn("hour",t)}var Hn="Invalid DateTime",Wn=864e13;function Kn(e){return new De("unsupported zone",'the zone "'+e.name+'" is not supported')}function qn(e){return null===e.weekData&&(e.weekData=Gn(e.c)),e.weekData}function Xn(e,t){var n={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new di(Object.assign({},n,t,{old:n}))}function $n(e,t,n){var i=e-60*t*1e3,r=n.offset(i);if(t===r)return[i,t];i-=60*(r-t)*1e3;var o=n.offset(i);return r===o?[i,r]:[e-60*Math.min(r,o)*1e3,Math.max(r,o)]}function Jn(e,t){var n=new Date(e+=60*t*1e3);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function zn(e,t,n){return $n(se(e),t,n)}function Zn(e,t){var n=e.o,i=e.c.year+Math.trunc(t.years),r=e.c.month+Math.trunc(t.months)+3*Math.trunc(t.quarters),o=Object.assign({},e.c,{year:i,month:r,day:Math.min(e.c.day,ae(i,r))+Math.trunc(t.days)+7*Math.trunc(t.weeks)}),a=sn.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),s=$n(se(o),n,e.zone),c=s[0],u=s[1];return 0!==a&&(c+=a,u=e.zone.offset(c)),{ts:c,o:u}}function Qn(e,t,n,i,r){var o=n.setZone,a=n.zone;if(e&&0!==Object.keys(e).length){var s=t||a,c=di.fromObject(Object.assign(e,n,{zone:s,setZone:void 0}));return o?c:c.setZone(a)}return di.invalid(new De("unparsable",'the input "'+r+"\" can't be parsed as "+i))}function ei(e,t,n){return void 0===n&&(n=!0),e.isValid?we.create(lt.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(e,t):null}function ti(e,t){var n=t.suppressSeconds,i=void 0!==n&&n,r=t.suppressMilliseconds,o=void 0!==r&&r,a=t.includeOffset,s=t.includeZone,c=void 0!==s&&s,u=t.spaceZone,l=void 0!==u&&u,d=t.format,h=void 0===d?"extended":d,f="basic"===h?"HHmm":"HH:mm";return i&&0===e.second&&0===e.millisecond||(f+="basic"===h?"ss":":ss",o&&0===e.millisecond||(f+=".SSS")),(c||a)&&l&&(f+=" "),c?f+="z":a&&(f+="basic"===h?"ZZZ":"ZZ"),ei(e,f)}var ni={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},ii={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ri={ordinal:1,hour:0,minute:0,second:0,millisecond:0},oi=["year","month","day","hour","minute","second","millisecond"],ai=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],si=["year","ordinal","hour","minute","second","millisecond"];function ci(e){var t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new E(e);return t}function ui(e,t){for(var n,i=l(oi);!(n=i()).done;){var r=n.value;H(e[r])&&(e[r]=ni[r])}var o=Fn(e)||Yn(e);if(o)return di.invalid(o);var a=Qe.now(),s=zn(e,t.offset(a),t),c=s[0],u=s[1];return new di({ts:c,zone:t,o:u})}function li(e,t,n){var i=!!H(n.round)||n.round,r=function(e,r){return e=ie(e,i||n.calendary?0:2,!0),t.loc.clone(n).relFormatter(n).format(e,r)},o=function(i){return n.calendary?t.hasSame(e,i)?0:t.startOf(i).diff(e.startOf(i),i).get(i):t.diff(e,i).get(i)};if(n.unit)return r(o(n.unit),n.unit);for(var a,s=l(n.units);!(a=s()).done;){var c=a.value,u=o(c);if(Math.abs(u)>=1)return r(u,c)}return r(0,n.units[n.units.length-1])}var di=function(){function e(e){var t=e.zone||Qe.defaultZone,n=e.invalid||(Number.isNaN(e.ts)?new De("invalid input"):null)||(t.isValid?null:Kn(t));this.ts=H(e.ts)?Qe.now():e.ts;var i=null,r=null;if(!n)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t)){var o=[e.old.c,e.old.o];i=o[0],r=o[1]}else{var a=t.offset(this.ts);i=Jn(this.ts,a),i=(n=Number.isNaN(i.year)?new De("invalid input"):null)?null:i,r=n?null:a}this._zone=t,this.loc=e.loc||lt.create(),this.invalid=n,this.weekData=null,this.c=i,this.o=r,this.isLuxonDateTime=!0}e.local=function(t,n,i,r,o,a,s){return H(t)?new e({ts:Qe.now()}):ui({year:t,month:n,day:i,hour:r,minute:o,second:a,millisecond:s},Qe.defaultZone)},e.utc=function(t,n,i,r,o,a,s){return H(t)?new e({ts:Qe.now(),zone:He.utcInstance}):ui({year:t,month:n,day:i,hour:r,minute:o,second:a,millisecond:s},He.utcInstance)},e.fromJSDate=function(t,n){void 0===n&&(n={});var i,r=(i=t,"[object Date]"===Object.prototype.toString.call(i)?t.valueOf():NaN);if(Number.isNaN(r))return e.invalid("invalid input");var o=Ke(n.zone,Qe.defaultZone);return o.isValid?new e({ts:r,zone:o,loc:lt.fromObject(n)}):e.invalid(Kn(o))},e.fromMillis=function(t,n){if(void 0===n&&(n={}),W(t))return t<-Wn||t>Wn?e.invalid("Timestamp out of range"):new e({ts:t,zone:Ke(n.zone,Qe.defaultZone),loc:lt.fromObject(n)});throw new y("fromMillis requires a numerical input, but received a "+typeof t+" with value "+t)},e.fromSeconds=function(t,n){if(void 0===n&&(n={}),W(t))return new e({ts:1e3*t,zone:Ke(n.zone,Qe.defaultZone),loc:lt.fromObject(n)});throw new y("fromSeconds requires a numerical input")},e.fromObject=function(t){var n=Ke(t.zone,Qe.defaultZone);if(!n.isValid)return e.invalid(Kn(n));var i=Qe.now(),r=n.offset(i),o=fe(t,ci,["zone","locale","outputCalendar","numberingSystem"]),a=!H(o.ordinal),s=!H(o.year),c=!H(o.month)||!H(o.day),u=s||c,d=o.weekYear||o.weekNumber,h=lt.fromObject(t);if((u||a)&&d)throw new _("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(c&&a)throw new _("Can't mix ordinal dates with month/day");var f,p,E=d||o.weekday&&!u,y=Jn(i,r);E?(f=ai,p=ii,y=Gn(y)):a?(f=si,p=ri,y=Bn(y)):(f=oi,p=ni);for(var v,g=!1,S=l(f);!(v=S()).done;){var T=v.value;H(o[T])?o[T]=g?p[T]:y[T]:g=!0}var O=E?function(e){var t=K(e.weekYear),n=Q(e.weekNumber,1,ce(e.weekYear)),i=Q(e.weekday,1,7);return t?n?!i&&Dn("weekday",e.weekday):Dn("week",e.week):Dn("weekYear",e.weekYear)}(o):a?function(e){var t=K(e.year),n=Q(e.ordinal,1,oe(e.year));return t?!n&&Dn("ordinal",e.ordinal):Dn("year",e.year)}(o):Fn(o),m=O||Yn(o);if(m)return e.invalid(m);var A=zn(E?kn(o):a?Vn(o):o,r,n),R=new e({ts:A[0],zone:n,o:A[1],loc:h});return o.weekday&&u&&t.weekday!==R.weekday?e.invalid("mismatched weekday","you can't specify both a weekday of "+o.weekday+" and a date of "+R.toISO()):R},e.fromISO=function(e,t){void 0===t&&(t={});var n=function(e){return ft(e,[kt,Yt],[Bt,Ht],[Vt,Wt],[Ft,Kt])}(e);return Qn(n[0],n[1],t,"ISO 8601",e)},e.fromRFC2822=function(e,t){void 0===t&&(t={});var n=function(e){return ft(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(e),[Mt,wt])}(e);return Qn(n[0],n[1],t,"RFC 2822",e)},e.fromHTTP=function(e,t){void 0===t&&(t={});var n=function(e){return ft(e,[Dt,xt],[jt,xt],[Ut,Gt])}(e);return Qn(n[0],n[1],t,"HTTP",t)},e.fromFormat=function(t,n,i){if(void 0===i&&(i={}),H(t)||H(n))throw new y("fromFormat requires an input string and a format");var r=i,o=r.locale,a=void 0===o?null:o,s=r.numberingSystem,c=void 0===s?null:s,u=function(e,t,n){var i=Ln(e,t,n);return[i.result,i.zone,i.invalidReason]}(lt.fromOpts({locale:a,numberingSystem:c,defaultToEN:!0}),t,n),l=u[0],d=u[1],h=u[2];return h?e.invalid(h):Qn(l,d,i,"format "+n,t)},e.fromString=function(t,n,i){return void 0===i&&(i={}),e.fromFormat(t,n,i)},e.fromSQL=function(e,t){void 0===t&&(t={});var n=function(e){return ft(e,[qt,$t],[Xt,Jt])}(e);return Qn(n[0],n[1],t,"SQL",e)},e.invalid=function(t,n){if(void 0===n&&(n=null),!t)throw new y("need to specify a reason the DateTime is invalid");var i=t instanceof De?t:new De(t,n);if(Qe.throwOnInvalid)throw new h(i);return new e({invalid:i})},e.isDateTime=function(e){return e&&e.isLuxonDateTime||!1};var t=e.prototype;return t.get=function(e){return this[e]},t.resolvedLocaleOpts=function(e){void 0===e&&(e={});var t=we.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t.locale,numberingSystem:t.numberingSystem,outputCalendar:t.calendar}},t.toUTC=function(e,t){return void 0===e&&(e=0),void 0===t&&(t={}),this.setZone(He.instance(e),t)},t.toLocal=function(){return this.setZone(Qe.defaultZone)},t.setZone=function(t,n){var i=void 0===n?{}:n,r=i.keepLocalTime,o=void 0!==r&&r,a=i.keepCalendarTime,s=void 0!==a&&a;if((t=Ke(t,Qe.defaultZone)).equals(this.zone))return this;if(t.isValid){var c=this.ts;if(o||s){var u=t.offset(this.ts);c=zn(this.toObject(),u,t)[0]}return Xn(this,{ts:c,zone:t})}return e.invalid(Kn(t))},t.reconfigure=function(e){var t=void 0===e?{}:e,n=t.locale,i=t.numberingSystem,r=t.outputCalendar;return Xn(this,{loc:this.loc.clone({locale:n,numberingSystem:i,outputCalendar:r})})},t.setLocale=function(e){return this.reconfigure({locale:e})},t.set=function(e){if(!this.isValid)return this;var t,n=fe(e,ci,[]);!H(n.weekYear)||!H(n.weekNumber)||!H(n.weekday)?t=kn(Object.assign(Gn(this.c),n)):H(n.ordinal)?(t=Object.assign(this.toObject(),n),H(n.day)&&(t.day=Math.min(ae(t.year,t.month),t.day))):t=Vn(Object.assign(Bn(this.c),n));var i=zn(t,this.o,this.zone);return Xn(this,{ts:i[0],o:i[1]})},t.plus=function(e){return this.isValid?Xn(this,Zn(this,cn(e))):this},t.minus=function(e){return this.isValid?Xn(this,Zn(this,cn(e).negate())):this},t.startOf=function(e){if(!this.isValid)return this;var t={},n=sn.normalizeUnit(e);switch(n){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0}if("weeks"===n&&(t.weekday=1),"quarters"===n){var i=Math.ceil(this.month/3);t.month=3*(i-1)+1}return this.set(t)},t.endOf=function(e){var t;return this.isValid?this.plus((t={},t[e]=1,t)).startOf(e).minus(1):this},t.toFormat=function(e,t){return void 0===t&&(t={}),this.isValid?we.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):Hn},t.toLocaleString=function(e){return void 0===e&&(e=O),this.isValid?we.create(this.loc.clone(e),e).formatDateTime(this):Hn},t.toLocaleParts=function(e){return void 0===e&&(e={}),this.isValid?we.create(this.loc.clone(e),e).formatDateTimeParts(this):[]},t.toISO=function(e){return void 0===e&&(e={}),this.isValid?this.toISODate(e)+"T"+this.toISOTime(e):null},t.toISODate=function(e){var t=(void 0===e?{}:e).format,n="basic"===(void 0===t?"extended":t)?"yyyyMMdd":"yyyy-MM-dd";return this.year>9999&&(n="+"+n),ei(this,n)},t.toISOWeekDate=function(){return ei(this,"kkkk-'W'WW-c")},t.toISOTime=function(e){var t=void 0===e?{}:e,n=t.suppressMilliseconds,i=void 0!==n&&n,r=t.suppressSeconds,o=void 0!==r&&r,a=t.includeOffset,s=void 0===a||a,c=t.format;return ti(this,{suppressSeconds:o,suppressMilliseconds:i,includeOffset:s,format:void 0===c?"extended":c})},t.toRFC2822=function(){return ei(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)},t.toHTTP=function(){return ei(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")},t.toSQLDate=function(){return ei(this,"yyyy-MM-dd")},t.toSQLTime=function(e){var t=void 0===e?{}:e,n=t.includeOffset,i=void 0===n||n,r=t.includeZone;return ti(this,{includeOffset:i,includeZone:void 0!==r&&r,spaceZone:!0})},t.toSQL=function(e){return void 0===e&&(e={}),this.isValid?this.toSQLDate()+" "+this.toSQLTime(e):null},t.toString=function(){return this.isValid?this.toISO():Hn},t.valueOf=function(){return this.toMillis()},t.toMillis=function(){return this.isValid?this.ts:NaN},t.toSeconds=function(){return this.isValid?this.ts/1e3:NaN},t.toJSON=function(){return this.toISO()},t.toBSON=function(){return this.toJSDate()},t.toObject=function(e){if(void 0===e&&(e={}),!this.isValid)return{};var t=Object.assign({},this.c);return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t},t.toJSDate=function(){return new Date(this.isValid?this.ts:NaN)},t.diff=function(e,t,n){if(void 0===t&&(t="milliseconds"),void 0===n&&(n={}),!this.isValid||!e.isValid)return sn.invalid(this.invalid||e.invalid,"created by diffing an invalid DateTime");var i,r=Object.assign({locale:this.locale,numberingSystem:this.numberingSystem},n),o=(i=t,Array.isArray(i)?i:[i]).map(sn.normalizeUnit),a=e.valueOf()>this.valueOf(),s=pn(a?this:e,a?e:this,o,r);return a?s.negate():s},t.diffNow=function(t,n){return void 0===t&&(t="milliseconds"),void 0===n&&(n={}),this.diff(e.local(),t,n)},t.until=function(e){return this.isValid?dn.fromDateTimes(this,e):this},t.hasSame=function(e,t){if(!this.isValid)return!1;if("millisecond"===t)return this.valueOf()===e.valueOf();var n=e.valueOf();return this.startOf(t)<=n&&n<=this.endOf(t)},t.equals=function(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)},t.toRelative=function(t){if(void 0===t&&(t={}),!this.isValid)return null;var n=t.base||e.fromObject({zone:this.zone}),i=t.padding?this<n?-t.padding:t.padding:0;return li(n,this.plus(i),Object.assign(t,{numeric:"always",units:["years","months","days","hours","minutes","seconds"]}))},t.toRelativeCalendar=function(t){return void 0===t&&(t={}),this.isValid?li(t.base||e.fromObject({zone:this.zone}),this,Object.assign(t,{numeric:"auto",units:["years","months","days"],calendary:!0})):null},e.min=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.every(e.isDateTime))throw new y("min requires all arguments be DateTimes");return J(n,(function(e){return e.valueOf()}),Math.min)},e.max=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.every(e.isDateTime))throw new y("max requires all arguments be DateTimes");return J(n,(function(e){return e.valueOf()}),Math.max)},e.fromFormatExplain=function(e,t,n){void 0===n&&(n={});var i=n,r=i.locale,o=void 0===r?null:r,a=i.numberingSystem,s=void 0===a?null:a;return Ln(lt.fromOpts({locale:o,numberingSystem:s,defaultToEN:!0}),e,t)},e.fromStringExplain=function(t,n,i){return void 0===i&&(i={}),e.fromFormatExplain(t,n,i)},i(e,[{key:"isValid",get:function(){return null===this.invalid}},{key:"invalidReason",get:function(){return this.invalid?this.invalid.reason:null}},{key:"invalidExplanation",get:function(){return this.invalid?this.invalid.explanation:null}},{key:"locale",get:function(){return this.isValid?this.loc.locale:null}},{key:"numberingSystem",get:function(){return this.isValid?this.loc.numberingSystem:null}},{key:"outputCalendar",get:function(){return this.isValid?this.loc.outputCalendar:null}},{key:"zone",get:function(){return this._zone}},{key:"zoneName",get:function(){return this.isValid?this.zone.name:null}},{key:"year",get:function(){return this.isValid?this.c.year:NaN}},{key:"quarter",get:function(){return this.isValid?Math.ceil(this.c.month/3):NaN}},{key:"month",get:function(){return this.isValid?this.c.month:NaN}},{key:"day",get:function(){return this.isValid?this.c.day:NaN}},{key:"hour",get:function(){return this.isValid?this.c.hour:NaN}},{key:"minute",get:function(){return this.isValid?this.c.minute:NaN}},{key:"second",get:function(){return this.isValid?this.c.second:NaN}},{key:"millisecond",get:function(){return this.isValid?this.c.millisecond:NaN}},{key:"weekYear",get:function(){return this.isValid?qn(this).weekYear:NaN}},{key:"weekNumber",get:function(){return this.isValid?qn(this).weekNumber:NaN}},{key:"weekday",get:function(){return this.isValid?qn(this).weekday:NaN}},{key:"ordinal",get:function(){return this.isValid?Bn(this.c).ordinal:NaN}},{key:"monthShort",get:function(){return this.isValid?hn.months("short",{locale:this.locale})[this.month-1]:null}},{key:"monthLong",get:function(){return this.isValid?hn.months("long",{locale:this.locale})[this.month-1]:null}},{key:"weekdayShort",get:function(){return this.isValid?hn.weekdays("short",{locale:this.locale})[this.weekday-1]:null}},{key:"weekdayLong",get:function(){return this.isValid?hn.weekdays("long",{locale:this.locale})[this.weekday-1]:null}},{key:"offset",get:function(){return this.isValid?+this.o:NaN}},{key:"offsetNameShort",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}},{key:"offsetNameLong",get:function(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}},{key:"isOffsetFixed",get:function(){return this.isValid?this.zone.universal:null}},{key:"isInDST",get:function(){return!this.isOffsetFixed&&(this.offset>this.set({month:1}).offset||this.offset>this.set({month:5}).offset)}},{key:"isInLeapYear",get:function(){return re(this.year)}},{key:"daysInMonth",get:function(){return ae(this.year,this.month)}},{key:"daysInYear",get:function(){return this.isValid?oe(this.year):NaN}},{key:"weeksInWeekYear",get:function(){return this.isValid?ce(this.weekYear):NaN}}],[{key:"DATE_SHORT",get:function(){return O}},{key:"DATE_MED",get:function(){return m}},{key:"DATE_MED_WITH_WEEKDAY",get:function(){return A}},{key:"DATE_FULL",get:function(){return R}},{key:"DATE_HUGE",get:function(){return P}},{key:"TIME_SIMPLE",get:function(){return I}},{key:"TIME_WITH_SECONDS",get:function(){return N}},{key:"TIME_WITH_SHORT_OFFSET",get:function(){return b}},{key:"TIME_WITH_LONG_OFFSET",get:function(){return C}},{key:"TIME_24_SIMPLE",get:function(){return L}},{key:"TIME_24_WITH_SECONDS",get:function(){return M}},{key:"TIME_24_WITH_SHORT_OFFSET",get:function(){return w}},{key:"TIME_24_WITH_LONG_OFFSET",get:function(){return D}},{key:"DATETIME_SHORT",get:function(){return j}},{key:"DATETIME_SHORT_WITH_SECONDS",get:function(){return U}},{key:"DATETIME_MED",get:function(){return x}},{key:"DATETIME_MED_WITH_SECONDS",get:function(){return G}},{key:"DATETIME_MED_WITH_WEEKDAY",get:function(){return k}},{key:"DATETIME_FULL",get:function(){return B}},{key:"DATETIME_FULL_WITH_SECONDS",get:function(){return V}},{key:"DATETIME_HUGE",get:function(){return F}},{key:"DATETIME_HUGE_WITH_SECONDS",get:function(){return Y}}]),e}();function hi(e){if(di.isDateTime(e))return e;if(e&&e.valueOf&&W(e.valueOf()))return di.fromJSDate(e);if(e&&"object"==typeof e)return di.fromObject(e);throw new y("Unknown datetime argument: "+e+", of type "+typeof e)}t.DateTime=di,t.Duration=sn,t.FixedOffsetZone=He,t.IANAZone=Fe,t.Info=hn,t.Interval=dn,t.InvalidZone=We,t.LocalZone=xe,t.Settings=Qe,t.Zone=je},26961:(e,t,n)=>{var i,r=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function r(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return r(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),i=0,r=t.length;i<r;i++){var a=t.charCodeAt(i);n[2*i]=a>>>8,n[2*i+1]=a%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=new Array(t.length/2),i=0,r=n.length;i<r;i++)n[i]=256*t[2*i]+t[2*i+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return r(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var i,r,o,a={},s={},c="",u="",l="",d=2,h=3,f=2,p=[],_=0,E=0;for(o=0;o<e.length;o+=1)if(c=e.charAt(o),Object.prototype.hasOwnProperty.call(a,c)||(a[c]=h++,s[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(a,u))l=u;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<f;i++)_<<=1,E==t-1?(E=0,p.push(n(_)),_=0):E++;for(r=l.charCodeAt(0),i=0;i<8;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}else{for(r=1,i=0;i<f;i++)_=_<<1|r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r=0;for(r=l.charCodeAt(0),i=0;i<16;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++),a[u]=h++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(i=0;i<f;i++)_<<=1,E==t-1?(E=0,p.push(n(_)),_=0):E++;for(r=l.charCodeAt(0),i=0;i<8;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}else{for(r=1,i=0;i<f;i++)_=_<<1|r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r=0;for(r=l.charCodeAt(0),i=0;i<16;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1}0==--d&&(d=Math.pow(2,f),f++),delete s[l]}else for(r=a[l],i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;0==--d&&(d=Math.pow(2,f),f++)}for(r=2,i=0;i<f;i++)_=_<<1|1&r,E==t-1?(E=0,p.push(n(_)),_=0):E++,r>>=1;for(;;){if(_<<=1,E==t-1){p.push(n(_));break}E++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,i){var r,o,a,s,c,u,l,d=[],h=4,f=4,p=3,_="",E=[],y={val:i(0),position:n,index:1};for(r=0;r<3;r+=1)d[r]=r;for(a=0,c=Math.pow(2,2),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 2:return""}for(d[3]=l,o=l,E.push(l);;){if(y.index>t)return"";for(a=0,c=Math.pow(2,p),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[f++]=e(a),l=f-1,h--;break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=n,y.val=i(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[f++]=e(a),l=f-1,h--;break;case 2:return E.join("")}if(0==h&&(h=Math.pow(2,p),p++),d[l])_=d[l];else{if(l!==f)return null;_=o+o.charAt(0)}E.push(_),d[f++]=o+_.charAt(0),o=_,0==--h&&(h=Math.pow(2,p),p++)}}};return o}();void 0===(i=function(){return r}.call(t,n,t,e))||(e.exports=i)},28660:(e,t,n)=>{var i;!function(e){!function(t){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===i.Reflect?i.Reflect=e:r=o(i.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,c={create:o?function(){return ie(Object.create(null))}:a?function(){return ie({__proto__:null})}:function(){return ie({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(l||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,i){if(j(n)){if(!H(e))throw new TypeError;if(!K(t))throw new TypeError;return A(e,t)}if(!H(e))throw new TypeError;if(!G(t))throw new TypeError;if(!G(i)&&!j(i)&&!U(i))throw new TypeError;return U(i)&&(i=void 0),R(e,t,n=Y(n),i)}function _(e,t){function n(n,i){if(!G(n))throw new TypeError;if(!j(i)&&!q(i))throw new TypeError;L(e,t,n,i)}return n}function E(e,t,n,i){if(!G(n))throw new TypeError;return j(i)||(i=Y(i)),L(e,t,n,i)}function y(e,t,n){if(!G(t))throw new TypeError;return j(n)||(n=Y(n)),I(e,t,n)}function v(e,t,n){if(!G(t))throw new TypeError;return j(n)||(n=Y(n)),N(e,t,n)}function g(e,t,n){if(!G(t))throw new TypeError;return j(n)||(n=Y(n)),b(e,t,n)}function S(e,t,n){if(!G(t))throw new TypeError;return j(n)||(n=Y(n)),C(e,t,n)}function T(e,t){if(!G(e))throw new TypeError;return j(t)||(t=Y(t)),M(e,t)}function O(e,t){if(!G(e))throw new TypeError;return j(t)||(t=Y(t)),w(e,t)}function m(e,t,n){if(!G(t))throw new TypeError;j(n)||(n=Y(n));var i=P(t,n,!1);if(j(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=f.get(t);return r.delete(n),r.size>0||f.delete(t),!0}function A(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!j(i)&&!U(i)){if(!K(i))throw new TypeError;t=i}}return t}function R(e,t,n,i){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,n,i);if(!j(o)&&!U(o)){if(!G(o))throw new TypeError;i=o}}return i}function P(e,t,n){var i=f.get(e);if(j(i)){if(!n)return;i=new d,f.set(e,i)}var r=i.get(t);if(j(r)){if(!n)return;r=new d,i.set(t,r)}return r}function I(e,t,n){if(N(e,t,n))return!0;var i=Q(t);return!U(i)&&I(e,i,n)}function N(e,t,n){var i=P(t,n,!1);return!j(i)&&V(i.has(e))}function b(e,t,n){if(N(e,t,n))return C(e,t,n);var i=Q(t);return U(i)?void 0:b(e,i,n)}function C(e,t,n){var i=P(t,n,!1);if(!j(i))return i.get(e)}function L(e,t,n,i){P(n,i,!0).set(e,t)}function M(e,t){var n=w(e,t),i=Q(e);if(null===i)return n;var r=M(i,t);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new h,a=[],s=0,c=n;s<c.length;s++){var u=c[s];o.has(u)||(o.add(u),a.push(u))}for(var l=0,d=r;l<d.length;l++){u=d[l];o.has(u)||(o.add(u),a.push(u))}return a}function w(e,t){var n=[],i=P(e,t,!1);if(j(i))return n;for(var r=$(i.keys()),o=0;;){var a=z(r);if(!a)return n.length=o,n;var s=J(a);try{n[o]=s}catch(e){try{Z(r)}finally{throw e}}o++}}function D(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function j(e){return void 0===e}function U(e){return null===e}function x(e){return"symbol"==typeof e}function G(e){return"object"==typeof e?null!==e:"function"==typeof e}function k(e,t){switch(D(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=X(e,i);if(void 0!==r){var o=r.call(e,n);if(G(o))throw new TypeError;return o}return B(e,"default"===n?"number":n)}function B(e,t){if("string"===t){var n=e.toString;if(W(n))if(!G(r=n.call(e)))return r;if(W(i=e.valueOf))if(!G(r=i.call(e)))return r}else{var i;if(W(i=e.valueOf))if(!G(r=i.call(e)))return r;var r,o=e.toString;if(W(o))if(!G(r=o.call(e)))return r}throw new TypeError}function V(e){return!!e}function F(e){return""+e}function Y(e){var t=k(e,3);return x(t)?t:F(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function K(e){return"function"==typeof e}function q(e){switch(D(e)){case 3:case 4:return!0;default:return!1}}function X(e,t){var n=e[t];if(null!=n){if(!W(n))throw new TypeError;return n}}function $(e){var t=X(e,r);if(!W(t))throw new TypeError;var n=t.call(e);if(!G(n))throw new TypeError;return n}function J(e){return e.value}function z(e){var t=e.next();return!t.done&&t}function Z(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[r]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[r]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[r]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function u(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var r=t[i];4!==i&&6!==i&&8!==i||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",_),e("defineMetadata",E),e("hasMetadata",y),e("hasOwnMetadata",v),e("getMetadata",g),e("getOwnMetadata",S),e("getMetadataKeys",T),e("getOwnMetadataKeys",O),e("deleteMetadata",m)}(r)}()}(i||(i={}))},5945:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentEvents=void 0,function(e){e.REDIRECT_TO_SAFE_PAGE="REDIRECT_TO_SAFE_PAGE"}(t.ContentEvents||(t.ContentEvents={}))},18364:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Counter=void 0,function(e){e.CONTINUE_AS_FREE_CLICKED="CONTINUE_AS_FREE_CLICKED",e.MAIN_PAGE_OPENED="MAIN_PAGE_OPENED"}(t.Counter||(t.Counter={}))},8291:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlagList=void 0,function(e){e.INIT="INIT",e.FORCE_LOGIN="FORCE_LOGIN"}(t.FlagList||(t.FlagList={}))},81376:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Migration_2_2_0=void 0;const r=n(18313),o=n(26012),a=n(18364);class s extends r.MarioModule{name(){return"Migration_2_2_0"}register(e){return i(this,void 0,void 0,(function*(){try{const e=this.mario().getService(r.MARIO_TYPES.STORAGE_SERVICE),t="POPUP_COUNTER";if(yield e.has(t)){const n=yield e.get(t),i=this.mario().getService(o.CounterModuleTypes.COUNTER_SERVICE);yield i.set(a.Counter.MAIN_PAGE_OPENED,Number(n)),yield e.remove([t])}}catch(e){this.mario().logger().error(e)}}))}static use(e){return i(this,void 0,void 0,(function*(){return e.registerModule(s)}))}}t.Migration_2_2_0=s},25504:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Migration_3_10_0=void 0;const r=n(18313),o=n(92750),a=n(49798),s=n(39803);class c extends r.MarioModule{constructor(){super(...arguments),this.KEY="MIGRATION_V3_10_0"}name(){return"Migration_3_10_0"}register(e){return i(this,void 0,void 0,(function*(){this.mario().extension().onInstall((e=>i(this,void 0,void 0,(function*(){"update"===e.reason&&(0,s.compareVersions)("3.10.0",e.previousVersion)&&((yield this.storage().has(this.KEY))||(yield this.migrate()))}))))}))}migrate(){return i(this,void 0,void 0,(function*(){yield this.storage().set(this.KEY,"true"),(yield this.policyService().isAgreed())&&(yield this.dataSharingManager().agree())}))}storage(){return this.mario().getService(r.MARIO_TYPES.STORAGE_SERVICE)}dataSharingManager(){return this.mario().getService(o.DataSharingModuleTypes.DATA_SHARING_MANAGER)}policyService(){return this.mario().getService(a.PolicyModuleTypes.POLICY_SERVICE)}}t.Migration_3_10_0=c},17566:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Migration_3_11_0=void 0;const r=n(18313),o=n(39803),a=n(1103);class s extends r.MarioModule{constructor(){super(...arguments),this.KEY="MIGRATION_V3_11_0"}name(){return"Migration_3_11_0"}register(e){return i(this,void 0,void 0,(function*(){this.mario().extension().onInstall((e=>i(this,void 0,void 0,(function*(){"update"===e.reason&&(0,o.compareVersions)("3.11.0",e.previousVersion)&&((yield this.storage().has(this.KEY))||(yield this.migrate()))}))))}))}migrate(){return i(this,void 0,void 0,(function*(){yield this.storage().set(this.KEY,"true"),this.mario().logger().log("run migration to v2.5.8");const e=yield this.storage().get("POLICY");e&&(yield this.storage().set(a.PoliciesKeys.AD_BLOCKER_POLICY,e),yield this.storage().set(a.PoliciesKeys.ANTI_MINING_POLICY,e))}))}storage(){return this.mario().getService(r.MARIO_TYPES.STORAGE_SERVICE)}}t.Migration_3_11_0=s},72513:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Migration_3_13_0=void 0;const r=n(18313);class o extends r.MarioModule{constructor(){super(...arguments),this.KEY="MIGRATION_3_13_0"}name(){return"Migration_3_13_0"}register(e){return i(this,void 0,void 0,(function*(){this.mario().extension().onInstall((e=>i(this,void 0,void 0,(function*(){"update"===e.reason&&((yield this.storage().has(this.KEY))||(yield this.migrate()))}))))}))}migrate(){return i(this,void 0,void 0,(function*(){yield this.storage().set(this.KEY,"true"),this.mario().logger().log("run migration to v3.13.0");const e=yield this.storage().get("POLICY");e&&(yield this.storage().set("NON_PERSONAL_DATA_COLLECTION",e))}))}storage(){return this.mario().getService(r.MARIO_TYPES.STORAGE_SERVICE)}}t.Migration_3_13_0=o},25886:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupEventsIn=void 0,function(e){e.READY="POPUP_READY",e.LOGIN_RESPONSE="POPUP_LOGIN_RESPONSE",e.LOGOUT_RESPONSE="POPUP_LOGOUT_RESPONSE",e.LOCATIONS_RESPONSE="POPUP_LOCATIONS_RESPONSE",e.DEACTIVATE_LOCATION_RESPONSE="POPUP_DEACTIVATE_LOCATION_RESPONSE",e.ACCOUNT_RESPONSE="POPUP_ACCOUNT_RESPONSE",e.RESTORE_PASSWORD_RESPONSE="POPUP_RESTORE_PASSWORD_RESPONSE",e.HANDS_SHAKE_FINISH_RESPONSE="POPUP_HANDS_SHAKE_FINISH_RESPONSE",e.SEND_TICKET_RESPONSE="SEND_TICKET_RESPONSE",e.STATE_CHANGED="STATE_CHANGED_RESPONSE",e.IS_DATA_SHARING_ENABLED_RESPONSE="IS_DATA_SHARING_ENABLED_RESPONSE",e.IS_ANTI_MALE_WARE_CONSENT_AGREED_RESPONSE="IS_ANTI_MALE_WARE_CONSENT_AGREED_RESPONSE",e.IS_AD_BLOCKER_CONSENT_AGREED_RESPONSE="IS_AD_BLOCKER_CONSENT_AGREED_RESPONSE"}(t.PopupEventsIn||(t.PopupEventsIn={}))},16437:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupEventsOut=void 0,function(e){e.INIT="POPUP_INIT",e.READY="POPUP_READY",e.POLICY_AGREED="POLICY_AGREED",e.POLICY_REJECTED="POLICY_REJECTED",e.CHANGE_EXTENSION_MODE="CHANGE_EXTENSION_MODE",e.LOGIN="LOGIN",e.LOGOUT="LOGOUT",e.GET_LOCATIONS="GET_LOCATIONS",e.GET_CURRENT_ACCOUNT="GET_CURRENT_ACCOUNT",e.DISABLE_EXTENSIONS_THAT_CAUSE_INTERRUPTION="DISABLE_EXTENSIONS_THAT_CAUSE_INTERRUPTION",e.ACTIVATE_LOCATION="ACTIVATE_LOCATION",e.DEACTIVATE_LOCATION="DEACTIVATE_LOCATION",e.AD_BLOCKER_ENABLE="AD_BLOCKER_ENABLE",e.AD_BLOCKER_DISABLE="AD_BLOCKER_DISABLE",e.ANTI_MALE_WARE_ENABLE="ANTI_MALE_WARE_ENABLE",e.ANTI_MALE_WARE_DISABLE="ANTI_MALE_WARE_DISABLE",e.PAGE_HISTORY_VISIT="PAGE_HISTORY_VISIT",e.PAGE_HISTORY_IS_VISIT="PAGE_HISTORY_IS_VISIT",e.HANDS_SHAKE_START="HANDS_SHAKE_START",e.RESTORE_PASSWORD="RESTORE_PASSWORD",e.TRACK_ACTION="TRACK_ACTION",e.COUNTER_INCREASE="COUNTER_INCREASE",e.ACTIVATE_FLAG="ACTIVATE_FLAG",e.DEACTIVATE_FLAG="DEACTIVATE_FLAG",e.CREATE_TAB="CREATE_TAB",e.SEND_TICKET="SEND_TICKET",e.CONGRATULATION_PAGE_VISITED="CONGRATULATION_PAGE_VISITED",e.OVER_PAGE_VISITED="OVER_PAGE_VISITED",e.DATA_SHARING_AGREED="DATA_SHARING_AGREED",e.DATA_SHARING_REJECTED="DATA_SHARING_REJECTED",e.IS_DATA_SHARING_ENABLED="IS_DATA_SHARING_ENABLED",e.SET_ANTI_MALE_WARE_CONSENT="SET_ANTI_MALE_WARE_CONSENT",e.IS_ANTI_MALE_WARE_CONSENT_AGREED="IS_ANTI_MALE_WARE_CONSENT_AGREED",e.SET_AD_BLOCKER_CONSENT="SET_AD_BLOCKER_CONSENT",e.IS_AD_BLOCKER_CONSENT_AGREED="IS_AD_BLOCKER_CONSENT_AGREED",e.NON_PERSONAL_DATA_COLLECTION_AGREED="NON_PERSONAL_DATA_COLLECTION_AGREED",e.NON_PERSONAL_DATA_COLLECTION_REJECTED="NON_PERSONAL_DATA_COLLECTION_REJECTED"}(t.PopupEventsOut||(t.PopupEventsOut={}))},8514:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PortList=void 0,function(e){e.POPUP="POPUP"}(t.PortList||(t.PortList={}))},81909:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(18313),o=n(83088),a=n(25266),s=n(60456),c=n(99399),u=n(99681),l=n(55312),d=n(65215),h=n(57873),f=n(43923),p=n(14962),_=n(89935),E=n(96795),y=n(25174),v=n(42543),g=n(55309),S=n(50554),T=n(49798),O=n(81505),m=n(90320),A=n(16829),R=n(21967),P=n(41785),I=n(32673),N=n(73344),b=n(8390),C=n(48258),L=n(12901),M=n(93520),w=n(98646),D=n(81376),j=n(50861),U=n(72001),x=n(16426),G=n(92323),k=n(6583),B=n(55738),V=n(63642),F=n(8622),Y=n(29187),H=n(25504),W=n(37779),K=n(17566),q=n(1103),X=n(62406),$=n(16084),J=n(70892),z=n(51407),Z=n(72030),Q=n(72513);const ee=new r.Mario("FIREFOX_BROWSER");ee.logger().disable(),i(void 0,void 0,void 0,(function*(){ee.registerService(o.UrbanTypes.URBAN_APP_SERVICE,M.AppService),ee.registerService(r.MARIO_TYPES.STORAGE_SERVICE,r.StorageService);const e=ee.getService(r.MARIO_TYPES.STORAGE_SERVICE);ee.registerService(o.UrbanTypes.URBAN_AD_BLOCKER_SERVICE,O.AdBlockerService),yield S.PolicyModule.use(ee,{storageService:e});const t=ee.getService(T.PolicyModuleTypes.POLICY_SERVICE),n=yield t.isAgreed();yield k.AdBlockerModule.use(ee,{subscribeOnProxyEvents:!1,dataCollection:n}),ee.registerService(r.MARIO_TYPES.BROWSER_ACTION,c.BrowserActionService),ee.registerService(r.MARIO_TYPES.ALARM_SERVICE,d.AlarmService),ee.registerService(r.MARIO_TYPES.MANAGEMENT,h.ManagementService),ee.registerService(o.UrbanTypes.URBAN_TOOLBAR_SERVICE,s.UrbanToolbarService),ee.registerService(o.UrbanTypes.URBAN_PAGE_HISTORY_SERVICE,g.PageHistoryService),yield p.IdentityModule.use(ee,{storageProvider:r.StorageService});const te=ee.getService(E.IdentityTypes.IDENTITY_SERVICE).getIdentityId();ee.logger().onFilterLog((e=>e.includes("PANELOS_MESSAGE"))),yield ee.registerModule(B.PanalyticsModule,{host:"https://authentication.urban-vpn.com",logging:!1});const ne=ee.getService(V.PanalyticsIdentityTypes.PANALYTICS_SERVICE).getId();yield ee.registerModule(Y.DataSharingModule,{apiUrl:"https://authentication.urban-vpn.com/rest/v1",panelistId:ne,distributorId:Number("5"),partnerId:Number("5")}),yield ee.registerModule(J.NonPersonalDataCollectionModule);const ie=ee.extension().manifest().version;yield a.BugsnagModule.use(ee,{enabled:Boolean(1),apiKey:"ca2e726fa8c539961b6721de62f80a29",releaseStage:"production",appVersion:ie,filterEvents:e=>-1===[u.ExternalDispatcherEvents.ON_ANY_MESSAGE].indexOf(e.event),filterLog:(e,t)=>!(JSON.stringify(t)+"").includes("PANELOS_MESSAGE")});const re=ee.getService(Z.NonPersonalDataCollectionModuleTypes.NON_PERSONAL_DATA_COLLECTION_SERVICE),oe=yield re.is(z.DataCollectionState.AGREE);yield i(void 0,void 0,void 0,(function*(){const n=yield e.get(q.PoliciesKeys.GA_POLICY),i=oe,r=Boolean(n)?n===q.PoliciesState.AGREE:i;yield _.GoogleAnalyticsModule.use(ee,{appVersion:ie,appName:"Urban VPN",clientId:te,trackerId:"UA-15419909-11",hostName:"extension",enabled:r,holdLastEvents:(yield t.hasAnswer())?0:100})})),yield i(void 0,void 0,void 0,(function*(){const t=yield e.get(q.PoliciesKeys.UA_POLICY),n=oe,i=Boolean(t)?t===q.PoliciesState.AGREE:n;yield x.UrbanAnalyticsModule.use(ee,{api:"https://analytics.urban-vpn.com/rest/v1",appName:"URBAN_VPN_EXTENSION",appVersion:ee.extension().manifest().version,enabled:i,holdLastEvents:n?0:100})})),yield ee.registerModule(N.ProxyLocationModule),yield G.AnalyticsModule.use(ee,{veteranPackageId:"d227f944-fe22-48a5-ae44-45af51d43d7a"}),yield y.UrlsSafeCheckModule.use(ee,{apiUrl:"https://anti-phishing-protection-toolbar.urban-vpn.com",mode:v.MODE.FULL_NAVIGATION,enabled:!1,panalyticsId:ne,pinstanceId:Number("2"),partnerId:Number("5"),distributorId:Number("5"),logging:!1,sensitiveDataCheckEnabled:!0,sensitiveDataApiUrl:"https://authentication.urban-vpn.com",compressRequest:!0}),yield ee.registerModule(P.HttpClientModule),yield b.CountryRestrictionModule.use(ee,{apiUrl:"https://api-pro.urban-vpn.com/rest/v1"}),yield ee.getService(F.CountryRestrictionModuleTypes.RESTRICTION_SERVICE).checkCountryRestriction(),yield R.AccountModule.use(ee,{accountApiUrl:"https://api-pro.urban-vpn.com/rest/v1",paymentsApiUrl:"https://api-pro.urban-vpn.com/rest/v1",supportApiUrl:"https://api-pro.urban-vpn.com/rest/v1"}),yield L.SecurityModule.use(ee,{apiUrl:"https://api-pro.urban-vpn.com/rest/v1"}),yield A.AuthModule.use(ee,{}),yield ee.registerModule(l.HideMyGeoLocationModule),yield I.StaticProxiesApiModule.use(ee,{apiUrl:"https://stats.urban-vpn.com/api/rest/v2",clientApp:"URBAN_VPN_BROWSER_EXTENSION"}),yield j.NotificationModule.use(ee),yield C.LocationModule.use(ee,{refreshTokenFallbackRetryDelayMs:6e4,refreshTokenFallbackShiftExpirationTimeSeconds:30,refreshTokenAlarmShiftExpirationTimeMinutes:Number("5"),byPass:"sessions.bugsnag.com, notify.bugsnag.com, www.ssl.google-analytics.com, www.google-analytics.com,  toolbar.urban-vpn.com, stats.urban-vpn.com, api.urban-vpn.com, api-pro.urban-vpn.com, anti-mining-protection-toolbar.urban-vpn.com, authentication.urban-vpn.com, config-toolbar.urban-vpn.com, analytics.urban-vpn.com".split(",").map((e=>e.trim()))}),yield m.UrbanPromotionModule.use(ee,{api:"https://config-toolbar.urban-vpn.com/rest/v1/configs/extensions/urban-vpn",initialFooter:{text:"Need a VPN? Download #Urban_VPN",links:{Urban_VPN:{link:"https://www.urban-vpn.com/free-products/free-windows-vpn/",style:"strong",text:"Urban VPN"}}}});const ae=(e,t)=>`https://api-pro.urban-vpn.com/rest/v1/redirect?product_id=URBAN_VPN_EXTENSION&version=${ee.extension().manifest().version}&client_version=1&panelist_id=${ne}&event_action=${e}&redirect_to=${t}`;yield $.HelloAndGoodbyeModule.use(ee,{identityId:ne,installUrl:ae("INSTALL","https://www.urban-vpn.com/thank-you-ext/"),uninstallUrl:ae("UNINSTALL","https://www.urban-vpn.com/uninstall-ext/"),trackUpdate:!0,cidKey:"cid",versionKey:"v",trackInstall:!1}),yield U.ExperimentModule.use(ee,{benefitsApi:"https://api-pro.urban-vpn.com/rest/v1",uninstallUrl:"https://www.urban-vpn.com/uninstall-ext/",veteranPackageId:"d227f944-fe22-48a5-ae44-45af51d43d7a",shiftEndCampaignTimeOn:180,pollingExperimentsEachSeconds:3600,uninstallKeepTime:43200});const se={logging:!1,safePriceCheck:{api:"http://anti-phishing-protection.urban-vpn.com/rest/v1",tracking:n},compression:!0,syncUp:{api:"http://anti-phishing-protection.urban-vpn.com/rest/v2",delayInMinutes:Number("60"),immediate:!0,token:"R2VvcmdlX01pY2hhZSE6SSdsbF9uZXZlcl9nb05OYV9kYW5jZV9hZ2Fpbg=="},track:{api:"http://anti-phishing-protection.urban-vpn.com/rest/v1",tracking:n},clientId:ne,distributorId:Number("5"),panelId:Number("3"),partnerId:Number("5")};yield W.ECommerceModule.use(ee,se),yield w.CounterModule.use(ee,{storageService:e}),yield X.FlagModule.use(ee,{storageService:e}),yield D.Migration_2_2_0.use(ee),yield ee.registerModule(H.Migration_3_10_0),yield ee.registerModule(K.Migration_3_11_0),yield ee.registerModule(Q.Migration_3_13_0),yield f.AppModule.use(ee,{veteranPackageId:"d227f944-fe22-48a5-ae44-45af51d43d7a"})})).then()},75357:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.repeater=t.isStagingEnvGoogleAnalytics=t.getBrowserName=t.delay=t.getBrowserBlankPageUrl=t.makeHost=void 0;const r=n(99490);function o(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}t.makeHost=e=>`${e.scheme}://${e.host}:${e.port}`,t.getBrowserBlankPageUrl=function(){let e="about:blank";return e},t.delay=o,t.getBrowserName=function(){return"FIREFOX"},t.isStagingEnvGoogleAnalytics=function(){return!1},t.repeater=function(e,t,n,a=!0){return i(this,void 0,void 0,(function*(){return new Promise(((s,c)=>i(this,void 0,void 0,(function*(){const i=e.minus({milliseconds:r.DateTime.local().toMillis()}).toMillis();let u=Math.floor(i/t);u=a?u-1:u,u=0===u?1:u,a&&(yield o(t));const l=u-1;for(let e=0;e<u;e++){try{const e=yield n();if(e)return void s(e)}catch(e){}l!==e&&(yield o(t))}c(new Error("Repeater: timeout"))}))))}))}},21967:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AccountModule=void 0;const r=n(18313),o=n(7009),a=n(81630),s=n(37320),c=n(92949);class u extends r.MarioModule{name(){return"AccountModule"}register(e){this.mario().container().bind(o.ACCOUNT_MODULE_TYPES.ACCOUNT_URL).toConstantValue(e.accountApiUrl),this.mario().container().bind(o.ACCOUNT_MODULE_TYPES.PAYMENTS_URL).toConstantValue(e.paymentsApiUrl),this.mario().container().bind(o.ACCOUNT_MODULE_TYPES.SUPPORT_URL).toConstantValue(e.supportApiUrl),this.mario().registerService(o.ACCOUNT_MODULE_TYPES.ACCOUNT_SERVICE,a.AccountService),this.mario().registerService(o.ACCOUNT_MODULE_TYPES.PAYMENTS_SERVICE,s.PaymentService),this.mario().registerService(o.ACCOUNT_MODULE_TYPES.SUPPORT_SERVICE,c.SupportService)}static use(e,t){return i(this,void 0,void 0,(function*(){yield e.registerModule(u,t)}))}}t.AccountModule=u},36344:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccountModuleEvents=void 0,function(e){e.RESTORE_PASSWORD_REQUEST="RESTORE_PASSWORD_REQUEST",e.SEND_TICKET_TO_SUPPORT="SEND_TICKET_TO_SUPPORT"}(t.AccountModuleEvents||(t.AccountModuleEvents={}))},7009:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ACCOUNT_MODULE_TYPES=void 0;const n={ACCOUNT_SERVICE:Symbol.for("ACCOUNT_SERVICE_JAVA"),ACCOUNT_URL:Symbol.for("ACCOUNT_URL"),PAYMENTS_SERVICE:Symbol.for("PAYMENTS_SERVICE"),PAYMENTS_URL:Symbol.for("PAYMENTS_URL"),SUPPORT_SERVICE:Symbol.for("SUPPORT_SERVICE"),SUPPORT_URL:Symbol.for("SUPPORT_URL")};t.ACCOUNT_MODULE_TYPES=n},81630:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AccountService=void 0;const s=n(86700),c=n(2975),u=n(99841),l=n(7009),d=n(82730),h=n(37050),f=n(18313),p=n(96233),_=n(36344);let E=class{constructor(e,t,n,i,r){this.api=e,this.dispatcher=t,this.httpClient=n,this.authService=i,this.browser=r}loadProfile(){return a(this,void 0,void 0,(function*(){const e=yield this.authService.getOwner(),t=this.buildEndpoint(`/users/${e.id}`);return this.httpClient.get(t)}))}registerAnonymous(){return a(this,void 0,void 0,(function*(){const e=this.buildEndpoint("/registrations/clientApps/URBAN_VPN_BROWSER_EXTENSION/users/anonymous"),t=new Headers;t.append("content-type","application/json");const n={headers:t};return this.httpClient.post(e,{clientApp:{name:"URBAN_VPN_BROWSER_EXTENSION"}},n,{skipInterceptor:!0,skipFailHandler:!0})}))}restorePassword(e){return a(this,void 0,void 0,(function*(){const t=this.buildEndpoint("/passwords/initReset"),n={email:e,userPlatform:"Extension",userBrowser:this.getBrowser()},i=new Headers;i.append("content-type","application/json");const r={headers:i},o={skipInterceptor:!0,skipFailHandler:!0};try{yield this.httpClient.request(t,"PUT",n,r,o),yield this.emitRestorePasswordRequestEvent(!0)}catch(e){throw yield this.emitRestorePasswordRequestEvent(!1),e}}))}buildEndpoint(e){return this.api+e}getBrowser(){return{[p.BrowserEnum.CHROME_BROWSER]:"chrome",[p.BrowserEnum.EDGE_BROWSER]:"edge",[p.BrowserEnum.FIREFOX_BROWSER]:"firefox"}[this.browser]}emitRestorePasswordRequestEvent(e){return a(this,void 0,void 0,(function*(){const t={success:e},n=new f.MarioEvent(_.AccountModuleEvents.RESTORE_PASSWORD_REQUEST,t);return this.dispatcher.emit(n)}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(l.ACCOUNT_MODULE_TYPES.ACCOUNT_URL)),o(1,(0,s.inject)(f.MARIO_TYPES.INTERNAL_DISPATCHER)),o(2,(0,s.inject)(h.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(3,(0,s.inject)(u.AUTH_MODULE_TYPES.AUTH_SERVICE)),o(4,(0,s.inject)(f.MARIO_TYPES.BROWSER)),r("design:paramtypes",[String,Object,d.HttpClient,c.AuthService,String])],E),t.AccountService=E},37320:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentService=t.PaymentCardType=t.PaymentType=t.SubscriptionStatus=void 0;const s=n(86700),c=n(7009),u=n(37050),l=n(82730);!function(e){e.ACTIVE="active",e.TRIALING="trialing",e.PAST_DUE="past_due",e.PAUSED="paused",e.DELETED="deleted"}(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.CARD="card",e.PAYPAL="paypal"}(t.PaymentType||(t.PaymentType={})),function(e){e.MASTER="master",e.VISA="visa",e.AMERICAN_EXPRESS="american_express",e.DISCOVER="discover",e.JCB="jcb",e.MAESTRO="maestro",e.DINERS_CLUB="diners_club",e.UNIONPAY="unionpay"}(t.PaymentCardType||(t.PaymentCardType={}));let d=class{constructor(e,t){this.api=e,this.httpClient=t}getPaymentsHistory(e){return a(this,void 0,void 0,(function*(){const t=this.buildEndpoint(`/users/${e}/payments?page=0&sort=createdAt,DESC&size=1`);return this.httpClient.get(t)}))}getSubscription(e){return a(this,void 0,void 0,(function*(){const t=this.buildEndpoint(`/users/${e}/subscriptions/effective`);return this.httpClient.get(t)}))}buildEndpoint(e){return this.api+e}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.ACCOUNT_MODULE_TYPES.PAYMENTS_URL)),o(1,(0,s.inject)(u.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),r("design:paramtypes",[String,l.HttpClient])],d),t.PaymentService=d},92949:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SupportService=void 0;const s=n(86700),c=n(37050),u=n(82730),l=n(7009),d=n(9930),h=n(96795),f=n(18313),p=n(36344);let _=class{constructor(e,t,n,i,r){this.httpClient=e,this.baseUrl=t,this.identityService=n,this.extension=i,this.dispatcher=r}sendTicket(e,t){return a(this,void 0,void 0,(function*(){const n=this.endpoint("/support/feedbacks"),i={subject:e,body:t,client:`browser "${navigator.userAgent}", extension: ${this.extension.manifest().version}`,platform:"Web",identityId:this.identityService.getIdentityId()};try{yield this.httpClient.post(n,i),this.emitSendTicketToSupportEvent(!0)}catch(e){throw this.emitSendTicketToSupportEvent(!1),e}}))}endpoint(e){return`${this.baseUrl}${e}`}emitSendTicketToSupportEvent(e){const t=new f.MarioEvent(p.AccountModuleEvents.SEND_TICKET_TO_SUPPORT);this.dispatcher.emit(t).then()}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(c.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(1,(0,s.inject)(l.ACCOUNT_MODULE_TYPES.SUPPORT_URL)),o(2,(0,s.inject)(h.IdentityTypes.IDENTITY_SERVICE)),o(3,(0,s.inject)(f.MARIO_TYPES.EXTENSION_SERVICE)),o(4,(0,s.inject)(f.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[u.HttpClient,String,d.IdentityService,Object,Object])],_),t.SupportService=_},2883:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLocationCode=t.getLocationType=void 0;const i=n(53511),r=n(18083);t.getLocationType=function(e){const t={[i.LocationProvider.GENERIC]:r.LocationType.GENERAL,[i.LocationProvider.AUTO_SERVER]:r.LocationType.AUTO_SERVER},n=e.provider();if(t[n])return t[n];if(e.isProvider(i.LocationProvider.STREAMING_SERVICE))return e.extraData().streamingServiceType;throw new Error("Could map location type")},t.getLocationCode=function(e){const t=e.isProvider(i.LocationProvider.STREAMING_SERVICE)?-2:0;return e.code().value().substr(t)}},92323:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsModule=void 0;const r=n(18313),o=n(67076),a=n(17138),s=n(17418),c=n(89816),u=n(64457);class l extends r.MarioModule{name(){return"AnalyticsModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(s.AnalyticsModuleTypes.ANALYTICS,c.Analytics),this.mario().portDispatcher().on(u.AnalyticsTrackAction),yield a.UAModule.use(this.mario(),{});const{veteranPackageId:t}=e;yield o.GAModule.use(this.mario(),{veteranPackageId:t})}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(l,t)}))}}t.AnalyticsModule=l},66044:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsModuleOutEvents=t.AnalyticsModuleEvents=void 0,function(e){e.TRACK_ACTION="TRACK_ACTION",e.IS_GA_ENABLED_EVENT="IS_GA_ENABLED_EVENT",e.IS_UA_ENABLED_EVENT="IS_UA_ENABLED_EVENT",e.SET_GA_STATE_EVENT="SET_GA_STATE_EVENT",e.SET_UA_STATE_EVENT="SET_UA_STATE_EVENT"}(t.AnalyticsModuleEvents||(t.AnalyticsModuleEvents={})),function(e){e.IS_GA_ENABLED_RESPONSE_EVENT="IS_GA_ENABLED_RESPONSE_EVENT",e.IS_UA_ENABLED_RESPONSE_EVENT="IS_UA_ENABLED_RESPONSE_EVENT"}(t.AnalyticsModuleOutEvents||(t.AnalyticsModuleOutEvents={}))},17418:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsModuleTypes=void 0;const n={ANALYTICS:Symbol.for("APP_ANALYTICS")};t.AnalyticsModuleTypes=n},18083:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationStartedType=t.LocationStartedResult=t.AuthTokenMigrationPhase=t.PromotionSyncUpStatus=t.ExperimentGiftPackagePhase=t.TicketToSupportStatus=t.LocationType=t.NonPersonalDataCollectionDecision=t.PolicyDecision=t.RepairStatus=t.ElementType=t.ActionList=t.ElementList=t.SourceList=t.EventList=void 0,function(e){e.CLICK="CLICK",e.COULD_NOT_REGISTER_ANONYMOUS="COULD_NOT_REGISTER_ANONYMOUS",e.COULD_NOT_GET_SECURITY_TOKEN="COULD_NOT_GET_SECURITY_TOKEN",e.AD_BLOCKER__ON="AD_BLOCKER__ON",e.AD_BLOCKER__OFF="AD_BLOCKER__OFF",e.ANTI_MALWARE__OFF="ANTI_MALWARE__OFF",e.ANTI_MALWARE__ON="ANTI_MALWARE__ON",e.AUTH_FAIL="AUTH_FAIL",e.AUTH_SUCCESS="AUTH_SUCCESS",e.LOCATION_SELECTED="LOCATION_SELECTED",e.LOCATION_STOPPED="LOCATION_STOPPED",e.ACTIVE_LOCATION_NOT_AVAILABLE="ACTIVE_LOCATION_NOT_AVAILABLE",e.COULD_NOT_ACTIVATE_LOCATION="COULD_NOT_ACTIVATE_LOCATION",e.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY="COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY",e.REPAIR_CONNECTION_STARTED="REPAIR_CONNECTION_STARTED",e.REPAIR_CONNECTION_RESULT="REPAIR_CONNECTION_RESULT",e.PROMOTION_LINK_CLICKED="PROMOTION_LINK_CLICKED",e.PROMOTION_SYNC_UP="PROMOTION_SYNC_UP",e.PAGE_SHOWN="PAGE_SHOWN",e.PAGE_CLOSED="PAGE_CLOSED",e.POLICY_DECISION="POLICY_DECISION",e.POLICY_DECISION_NON_PERSONAL="POLICY_DECISION_NON_PERSONAL",e.TIME_IS_SHIFTED="TIME_IS_SHIFTED",e.RESTORE_PASSWORD_REQUEST="RESTORE_PASSWORD_REQUEST",e.LOGOUT="LOGOUT",e.TICKET_TO_SUPPORT="TICKET_TO_SUPPORT",e.EXPERIMENT_GIFT_PACKAGE="EXPERIMENT_GIFT_PACKAGE",e.AUTH_TOKEN_MIGRATION="AUTH_TOKEN_MIGRATION",e.EXTENSION_UPDATED="EXTENSION_UPDATED",e.LOCATION_UI="LOCATION_UI",e.COUNTRY_RESTRICTED_PAGE_SHOWN="COUNTRY_RESTRICTED_PAGE_SHOWN",e.PRIVACY_POLICY_PAGE_SHOWN="PRIVACY_POLICY_PAGE_SHOWN",e.POLICY_INTERNAL_ANALYTICS_TOGGLE="POLICY_INTERNAL_ANALYTICS_TOGGLE",e.POLICY_ADS_ANALYTICS_TOGGLE="POLICY_ADS_ANALYTICS_TOGGLE",e.POLICY_WEB_ACCESS_LOGS_TOGGLE="POLICY_WEB_ACCESS_LOGS_TOGGLE",e.POLICY_DATA_SHARING_TOGGLE="POLICY_DATA_SHARING_TOGGLE",e.LOCATION_STARTED="LOCATION_STARTED"}(t.EventList||(t.EventList={})),function(e){e.SYSTEM="SYSTEM",e.WELCOME_CONSENT_PAGE="WELCOME_CONSENT_PAGE",e.MAIN_PAGE="MAIN_PAGE",e.PRELOGIN_1_PAGE="PRELOGIN_1_PAGE",e.PRELOGIN_2_PAGE="PRELOGIN_2_PAGE",e.PRELOGIN_3_PAGE="PRELOGIN_3_PAGE",e.LOGIN_PAGE="LOGIN_PAGE",e.LOGOUT_PAGE="LOGOUT_PAGE",e.FORGOT_PASSWORD_PAGE="FORGOT_PASSWORD_PAGE",e.OFFER_PAGE="OFFER_PAGE",e.AD_BLOCKER_CONSENT_PAGE="AD_BLOCKER_CONSENT_PAGE",e.ANTI_MALWARE_CONSENT_PAGE="ANTI_MALWARE_CONSENT_PAGE",e.RATE_US_PAGE="RATE_US_PAGE",e.INTERRUPTION_PAGE="INTERRUPTION_PAGE",e.INVITE_FRIENDS_PAGE="INVITE_FRIENDS_PAGE",e.INITIALIZING_PAGE="INITIALIZING_PAGE",e.VETERAN_PAGE="VETERAN_PAGE",e.PROFILE_PAGE="PROFILE_PAGE",e.SUPPORT_PAGE="SUPPORT_PAGE",e.GIFT_PACKAGE_CONGRATULATION_PAGE="GIFT_PACKAGE_CONGRATULATION_PAGE",e.GIFT_PACKAGE_OVER_PAGE="GIFT_PACKAGE_OVER_PAGE",e.COUNTRY_RESTRICTED_PAGE="COUNTRY_RESTRICTED_PAGE",e.DATA_SHARING_PAGE="DATA_SHARING_PAGE",e.NON_PERSONAL_DATA_COLLECTION_PAGE="NON_PERSONAL_DATA_COLLECTION_PAGE"}(t.SourceList||(t.SourceList={})),function(e){e.AD_BLOCKER_TOGGLE_BUTTON="AD_BLOCKER_TOGGLE_BUTTON",e.ANTI_MALWARE_TOGGLE_BUTTON="ANTI_MALWARE_TOGGLE_BUTTON",e.REJECT_POLICY_BUTTON="REJECT_POLICY_BUTTON",e.AGREED_POLICY_BUTTON="AGREED_POLICY_BUTTON",e.LOGIN="LOGIN",e.CONTINUE_AS_FREE_USER="CONTINUE_AS_FREE_USER",e.TRY_PREMIUM="TRY_PREMIUM",e.SLIDER_OPTION_1_BUTTON="SLIDER_OPTION_1_BUTTON",e.SLIDER_OPTION_2_BUTTON="SLIDER_OPTION_2_BUTTON",e.SLIDER_OPTION_3_BUTTON="SLIDER_OPTION_3_BUTTON",e.SUBSCRIPTION_ENDED_REVIEW="SUBSCRIPTION_ENDED_REVIEW",e.FORGOT_PASSWORD="FORGOT_PASSWORD",e.DECLINE_OFFER="DECLINE_OFFER",e.RATE_US="RATE_US",e.DISABLE_OTHER_EXTENSIONS="DISABLE_OTHER_EXTENSIONS",e.HOW_TO_DISABLE_OTHER_EXTENSIONS="HOW_TO_DISABLE_OTHER_EXTENSIONS",e.SHARE_LINK="SHARE_LINK",e.RETRY="RETRY",e.EDIT_ACCOUNT="EDIT_ACCOUNT",e.CANCEL_LOGOUT="CANCEL_LOGOUT",e.CONFIRM_LOGOUT="CONFIRM_LOGOUT",e.GIFT_OK_THANKS="GIFT_OK_THANKS",e.GIFT_SKIP="GIFT_SKIP",e.MENU_BUTTON="MENU_BUTTON",e.MENU_ITEM="MENU_ITEM",e.LOCATION_LIST="LOCATION_LIST",e.PLAY_BUTTON="PLAY_BUTTON",e.DECLINE_DATA_SHARING_BUTTON="DECLINE_DATA_SHARING_BUTTON",e.AGREED_DATA_SHARING_BUTTON="AGREED_DATA_SHARING_BUTTON",e.AGREED_NON_PERSONAL_DATA_COLLECTION_BUTTON="AGREED_NON_PERSONAL_DATA_COLLECTION_BUTTON",e.DECLINE_NON_PERSONAL_DATA_COLLECTION_BUTTON="DECLINE_NON_PERSONAL_DATA_COLLECTION_BUTTON"}(t.ElementList||(t.ElementList={})),function(e){e.CHANGE_SLIDE_ACTION="CHANGE_SLIDE_ACTION",e.LOGIN_ACTION="LOGIN_ACTION",e.ON_AD_BLOCKER_ACTION="ON_AD_BLOCKER_ACTION",e.OFF_AD_BLOCKER_ACTION="OFF_AD_BLOCKER_ACTION",e.ON_ANTI_MALWARE_ACTION="ON_ANTI_MALWARE_ACTION",e.OFF_ANTI_MALWARE_ACTION="OFF_ANTI_MALWARE_ACTION",e.COPIED_SHARE_LINK="COPIED_SHARE_LINK_ACTION",e.RETRY_ACTION="RETRY_ACTION",e.CANCEL_LOGOUT_ACTION="CANCEL_LOGOUT_ACTION",e.CONFIRM_LOGOUT_ACTION="CONFIRM_LOGOUT_ACTION",e.OPEN_MENU_ACTION="OPEN_MENU_ACTION",e.CLOSE_MENU_ACTION="CLOSE_MENU_ACTION",e.PLAY_ACTION="PLAY_ACTION",e.PAUSE_ACTION="PAUSE_ACTION"}(t.ActionList||(t.ActionList={})),function(e){e.BUTTON="BUTTON",e.LINK="LINK"}(t.ElementType||(t.ElementType={})),function(e){e.FAILURE="FAILURE",e.SUCCESS="SUCCESS"}(t.RepairStatus||(t.RepairStatus={})),function(e){e.REJECTED="REJECTED",e.AGREED="AGREED"}(t.PolicyDecision||(t.PolicyDecision={})),function(e){e.REJECTED="REJECTED",e.AGREED="AGREED"}(t.NonPersonalDataCollectionDecision||(t.NonPersonalDataCollectionDecision={})),function(e){e.GENERAL="GENERAL",e.AUTO_SERVER="AUTO_SERVER",e.NETFLIX="NETFLIX"}(t.LocationType||(t.LocationType={})),function(e){e.SENT="SENT",e.FAILURE="FAILURE"}(t.TicketToSupportStatus||(t.TicketToSupportStatus={})),function(e){e.RECEIVED="RECEIVED",e.NOT_RECEIVED="NOT_RECEIVED",e.GIFT_CONGRATULATION_SHOWN="GIFT_CONGRATULATION_SHOWN",e.GIFT_OVER_SHOWN="GIFT_OVER_SHOWN",e.GIFT_OK_THANKS_CLICKED="GIFT_OK_THANKS_CLICKED",e.GIFT_TRY_PREMIUM_CLICKED="GIFT_TRY_PREMIUM_CLICKED",e.GIFT_OFFER_SKIP_CLICKED="GIFT_OFFER_SKIP_CLICKED"}(t.ExperimentGiftPackagePhase||(t.ExperimentGiftPackagePhase={})),function(e){e.SUCCESS="SUCCESS",e.FAILURE="FAILURE"}(t.PromotionSyncUpStatus||(t.PromotionSyncUpStatus={})),function(e){e.STARTED="STARTED",e.SUCCESS="SUCCESS",e.FAILURE="FAILURE"}(t.AuthTokenMigrationPhase||(t.AuthTokenMigrationPhase={})),function(e){e.success="SUCCESS",e.fail="FAIL"}(t.LocationStartedResult||(t.LocationStartedResult={})),function(e){e.present="PRESENT",e.first="FIRST"}(t.LocationStartedType||(t.LocationStartedType={}))},67076:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GAModule=void 0;const r=n(18313),o=n(43213),a=n(49598),s=n(55402),c=n(2678);class u extends r.MarioModule{name(){return"GAModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(s.GAModuleTypes.VETERAN_PACKAGE_ID).toConstantValue(e.veteranPackageId),this.mario().registerService(s.GAModuleTypes.GA_ANALYTICS,o.GAAnalytics),this.mario().registerService(s.GAModuleTypes._GA_MAPPER,c.GAMapper),this.mario().internalDispatcher().on(a.GATrackAction)}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(u,t)}))}}t.GAModule=u},55402:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GAModuleTypes=void 0;const n={GA_ANALYTICS:Symbol.for("APP_GA_ANALYTICS"),VETERAN_PACKAGE_ID:Symbol.for("APP_GA_VETERAN_PACKAGE_ID"),_GA_MAPPER:Symbol.for("APP_GA_MAPPER")};t.GAModuleTypes=n},49598:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GATrackAction=void 0;const s=n(86700),c=n(43213),u=n(18313),l=n(55402),d=n(66044),h=n(2678);let f=class{constructor(e,t,n){this.ga=e,this.mapper=t,this.logger=n}on(){return d.AnalyticsModuleEvents.TRACK_ACTION}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data,n=this.mapper.map(t);n?this.ga.track(n):this.logger.log("Goggle Analytics: Could not map",t)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(l.GAModuleTypes.GA_ANALYTICS)),o(1,(0,s.inject)(l.GAModuleTypes._GA_MAPPER)),o(2,(0,s.inject)(u.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[c.GAAnalytics,h.GAMapper,Object])],f),t.GATrackAction=f},43213:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GAAnalytics=void 0;const s=n(86700),c=n(60175),u=n(28059),l=n(99841),d=n(55402),h=n(18313);let f=class{constructor(e,t,n,i){this.ga=e,this.container=t,this.veteranPackageId=n,this.logger=i}enable(){return a(this,void 0,void 0,(function*(){yield this.ga.enable()}))}disable(){return a(this,void 0,void 0,(function*(){yield this.ga.disable()}))}isEnabled(){return this.ga.isEnabled()}track(e){const t=this.getLabel(e),n={category:e.category,action:e.action,label:t};this.logger.log("Google Analytics: track event",n),this.ga.trackEvent(n.category,n.action,n.label)}getUserType(){if(!this.container.isBound(l.AUTH_MODULE_TYPES.CURRENT_USER))return"unknown";const e=this.container.get(l.AUTH_MODULE_TYPES.CURRENT_USER);return e.isPremiumUser()?"premium-user":e.getSecurityToken().package.id===this.veteranPackageId?"veteran":"anonymous"}getLabel(e){return e.includeUserType||-1!==["TryItForFree"].indexOf(e.action)?this.getUserType():e.label}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)),o(1,(0,s.inject)(h.MARIO_TYPES.CONTAINER)),o(2,(0,s.inject)(d.GAModuleTypes.VETERAN_PACKAGE_ID)),o(3,(0,s.inject)(h.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[u.GoogleAnalyticsService,s.Container,String,Object])],f),t.GAAnalytics=f},2678:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.GAMapper=void 0;const a=n(86700),s=n(18083),c=n(33770),u=n(15035),l=n(44170);let d=class{constructor(e){this.locationHelper=e}map(e){let t;const n={[s.EventList.PAGE_SHOWN]:e=>this.pageShown(e),[s.EventList.PAGE_CLOSED]:e=>this.pageClosed(e),[s.EventList.LOCATION_SELECTED]:e=>this.locationSelected(e),[s.EventList.COULD_NOT_ACTIVATE_LOCATION]:e=>this.couldNotActivateLocation(e),[s.EventList.ACTIVE_LOCATION_NOT_AVAILABLE]:e=>this.activateLocationNotAvailable(e),[s.EventList.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY]:e=>this.couldNotEstablishConnectionWithProxy(e),[s.EventList.REPAIR_CONNECTION_STARTED]:e=>this.repairConnectionStarted(e),[s.EventList.REPAIR_CONNECTION_RESULT]:e=>this.repairConnectionResult(e),[s.EventList.RESTORE_PASSWORD_REQUEST]:e=>this.restorePasswordRequest(e),[s.EventList.TICKET_TO_SUPPORT]:e=>this.ticketToSupport(e),[s.EventList.EXPERIMENT_GIFT_PACKAGE]:e=>this.experimentGiftPackage(e),[s.EventList.PROMOTION_SYNC_UP]:e=>this.promotionSyncUp(e),[s.EventList.PROMOTION_LINK_CLICKED]:e=>this.promotionLinkClicked(e),[s.EventList.AUTH_TOKEN_MIGRATION]:e=>this.authTokenMigration(e),[s.EventList.CLICK]:e=>this.click(e),[s.EventList.COUNTRY_RESTRICTED_PAGE_SHOWN]:e=>this.countryRestrictedPageShown(e),[s.EventList.PRIVACY_POLICY_PAGE_SHOWN]:e=>this.privacyPolicyPageShown(),[s.EventList.POLICY_INTERNAL_ANALYTICS_TOGGLE]:e=>this.privacyPolicyToggle(e,"policy_internal_analytics_toggle"),[s.EventList.POLICY_ADS_ANALYTICS_TOGGLE]:e=>this.privacyPolicyToggle(e,"policy_ads_analytics_toggle"),[s.EventList.POLICY_WEB_ACCESS_LOGS_TOGGLE]:e=>this.privacyPolicyToggle(e,"policy_web_access_logs_toggle"),[s.EventList.POLICY_DATA_SHARING_TOGGLE]:e=>this.privacyPolicyToggle(e,"policy_data_sharing_toggle")};return n[e.eventId]?t=n[e.eventId](e):l.simpleMapper[e.eventId]&&(t=l.simpleMapper[e.eventId]),t}pageShown(e){const t=e.details;return l.pageShownMapper[t.ID]}countryRestrictedPageShown(e){const t=e.details,n=l.pageShownMapper[t.ID];return n.label=t.COUNTRY,n}pageClosed(e){const t=e.details;return l.pageClosedMapper[t.ID]}locationSelected(e){const t=e.details,n=this.getCountryName(t.CODE),i={[s.LocationType.GENERAL]:"OnLocationSelected",[s.LocationType.AUTO_SERVER]:"AUTO_SERVER"};return{category:"Location",action:i[t.TYPE]?i[t.TYPE]:t.TYPE,label:n}}couldNotActivateLocation(e){const t=e.details;return{category:"could-not-activate-location",action:this.getCountryName(t.CODE),includeUserType:!0}}activateLocationNotAvailable(e){const t=e.details;return{category:"active-location-not-available",action:this.getCountryName(t.CODE),includeUserType:!0}}couldNotEstablishConnectionWithProxy(e){return{category:"proxy-error",action:"could-not-establish-connection",label:e.details.HOST}}repairConnectionStarted(e){const t=e.details;return{category:"repair-connection-started",action:t.REASON,label:t.HOST}}repairConnectionResult(e){const t=e.details;return{category:"repair-connection",action:t.RESULT===s.RepairStatus.SUCCESS?"repair-connection-succeeded":"repair-connection-failed",label:t.HOST}}restorePasswordRequest(e){return{category:"restore_password_emil",action:e.details.SUCCESS?"sent":"fail"}}ticketToSupport(e){return{category:"support-form",action:e.details.STATUS===s.TicketToSupportStatus.SENT?"ticket-sent-success":"ticket-sent-fail"}}experimentGiftPackage(e){const t=e.details,n={[s.ExperimentGiftPackagePhase.RECEIVED]:{category:"experiment",action:t.NAME,label:"gift_received"},[s.ExperimentGiftPackagePhase.NOT_RECEIVED]:{category:"experiment",action:t.NAME,label:"gift_not_received"},[s.ExperimentGiftPackagePhase.GIFT_CONGRATULATION_SHOWN]:{category:"experimental_gift_page",action:"experimental_gift_page_shown",label:t.NAME},[s.ExperimentGiftPackagePhase.GIFT_OVER_SHOWN]:{category:"experimental_gift_over_page",action:"experimental_gift_over_page_shown",label:t.NAME},[s.ExperimentGiftPackagePhase.GIFT_OK_THANKS_CLICKED]:{category:"experimental_gift_page",action:"experimental_gift_button_ok_thanks_clicked",label:t.NAME},[s.ExperimentGiftPackagePhase.GIFT_OFFER_SKIP_CLICKED]:{category:"experimental_gift_over_page",action:"experimental_gift_over_button_skip_clicked",label:t.NAME},[s.ExperimentGiftPackagePhase.GIFT_TRY_PREMIUM_CLICKED]:{category:"experimental_gift_over_page",action:"experimental_gift_over_button_get_free_trial_clicked",label:t.NAME}};if(n[t.PHASE])return n[t.PHASE]}promotionLinkClicked(e){const t=e.details;return{category:"promotion_link_clicked",action:t.LINK_TEXT,label:t.LINK_URL}}promotionSyncUp(e){const t=e.details,n={[s.PromotionSyncUpStatus.SUCCESS]:{category:"promotion_sync_footer",action:"success",label:t.TEXT},[s.PromotionSyncUpStatus.FAILURE]:{category:"promotion_sync_footer",action:"fail"}};if(n[t.STATUS])return n[t.STATUS]}authTokenMigration(e){const t=e.details,n={[s.AuthTokenMigrationPhase.STARTED]:{category:"migration-to-premium-ext-version",action:"auth-token-migration-start"},[s.AuthTokenMigrationPhase.SUCCESS]:{category:"migration-to-premium-ext-version",action:"auth-token-migration-success"},[s.AuthTokenMigrationPhase.FAILURE]:{category:"migration-to-premium-ext-version",action:"auth-token-migration-fail"}};if(n[t.PHASE])return n[t.PHASE]}click(e){const t=e.details;return l.clickGroupedByElementAndAction[t.ID]&&l.clickGroupedByElementAndAction[t.ID][t.TO]?l.clickGroupedByElementAndAction[t.ID][t.TO]:l.clickGroupedByElementAndSource[t.ID]&&l.clickGroupedByElementAndSource[t.ID][t.SOURCE]?l.clickGroupedByElementAndSource[t.ID][t.SOURCE]:void 0}getCountryName(e){return this.locationHelper.getCountryName(e,e)}privacyPolicyPageShown(){return{category:"menu",action:"opened",label:"privacy"}}privacyPolicyToggle(e,t){return{category:t,action:"toggle",label:e.details.TOGGLE}}};d=i([(0,a.injectable)(),o(0,(0,a.inject)(u.ProxyLocationTypes.LOCATION_HELPER_SERVICE)),r("design:paramtypes",[c.LocationHelper])],d),t.GAMapper=d},44170:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clickGroupedByElementAndAction=t.clickGroupedByElementAndSource=t.simpleMapper=t.pageClosedMapper=t.pageShownMapper=void 0;const i=n(18083);t.pageShownMapper={[i.SourceList.PRELOGIN_1_PAGE]:{category:"prelogin_page",action:"shown",label:"option1"},[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"shown",label:"option2"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"shown",label:"option3"},[i.SourceList.LOGIN_PAGE]:{category:"login_page",action:"shown"},[i.SourceList.WELCOME_CONSENT_PAGE]:{category:"main_consent_page",action:"shown"},[i.SourceList.OFFER_PAGE]:{category:"offer_page",action:"shown"},[i.SourceList.MAIN_PAGE]:{category:"main_page",action:"shown"},[i.SourceList.RATE_US_PAGE]:{category:"rate_us_page_shown",action:"shown"},[i.SourceList.AD_BLOCKER_CONSENT_PAGE]:{category:"ad_blocker_page",action:"shown"},[i.SourceList.ANTI_MALWARE_CONSENT_PAGE]:{category:"safe_browsing_page",action:"shown"},[i.SourceList.FORGOT_PASSWORD_PAGE]:{category:"forgot_password_page",action:"shown"},[i.SourceList.INTERRUPTION_PAGE]:{category:"interruption_page",action:"shown",includeUserType:!0},[i.SourceList.INVITE_FRIENDS_PAGE]:{category:"invite_friends_page",action:"shown"},[i.SourceList.VETERAN_PAGE]:{category:"veteran_page",action:"shown"},[i.SourceList.INVITE_FRIENDS_PAGE]:{category:"support_page",action:"shown"},[i.SourceList.LOGOUT_PAGE]:{category:"logout_page",action:"shown"},[i.SourceList.SUPPORT_PAGE]:{category:"support_page",action:"shown"},[i.SourceList.COUNTRY_RESTRICTED_PAGE]:{category:"country_restricted_page",action:"shown"},[i.SourceList.DATA_SHARING_PAGE]:{category:"data_sharing_page",action:"shown"}},t.pageClosedMapper={[i.SourceList.LOGIN_PAGE]:{category:"login_page",action:"closed"},[i.SourceList.OFFER_PAGE]:{category:"offer_page",action:"closed"},[i.SourceList.RATE_US_PAGE]:{category:"rate_us_close_button",action:"clicked"},[i.SourceList.AD_BLOCKER_CONSENT_PAGE]:{category:"ad_blocker_page",action:"closed"},[i.SourceList.ANTI_MALWARE_CONSENT_PAGE]:{category:"safe_browsing_page",action:"closed"},[i.SourceList.FORGOT_PASSWORD_PAGE]:{category:"forgot_password_page",action:"closed"},[i.SourceList.INTERRUPTION_PAGE]:{category:"interruption_page",action:"interruption_cancelled",includeUserType:!0},[i.SourceList.INVITE_FRIENDS_PAGE]:{category:"invite_friends_close_button",action:"clicked"},[i.SourceList.INVITE_FRIENDS_PAGE]:{category:"support_page",action:"closed"},[i.SourceList.SUPPORT_PAGE]:{category:"support_page",action:"closed"}},t.simpleMapper={[i.EventList.AUTH_SUCCESS]:{category:"auth",action:"success"},[i.EventList.AUTH_FAIL]:{category:"auth",action:"fail"},[i.EventList.TIME_IS_SHIFTED]:{category:"system-time",action:"system-time-is-shifted"},[i.EventList.COULD_NOT_REGISTER_ANONYMOUS]:{category:"register-anonymous",action:"could-not-register-anonymous"},[i.EventList.COULD_NOT_GET_SECURITY_TOKEN]:{category:"register-anonymous",action:"could-not-get-security-token"}},t.clickGroupedByElementAndSource={[i.ElementList.CONTINUE_AS_FREE_USER]:{[i.SourceList.PRELOGIN_1_PAGE]:{category:"prelogin_page",action:"continue_as_free_link_clicked",label:"option1"},[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"continue_as_free_link_clicked",label:"option2"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"continue_as_free_link_clicked",label:"option3"},[i.SourceList.LOGIN_PAGE]:{category:"continue-as-free-link",action:"clicked"},[i.SourceList.VETERAN_PAGE]:{category:"veteran-ok-button",action:"veteran-ok-clicked"}},[i.ElementList.TRY_PREMIUM]:{[i.SourceList.PRELOGIN_1_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked",label:"option1"},[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked",label:"option2"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked",label:"option3"},[i.SourceList.OFFER_PAGE]:{category:"try-premium-button",action:"clicked"},[i.SourceList.LOGIN_PAGE]:{category:"TryItForFree",action:"clicked",includeUserType:!0}},[i.ElementList.SLIDER_OPTION_1_BUTTON]:{[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide1"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide1"}},[i.ElementList.SLIDER_OPTION_2_BUTTON]:{[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide2"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide2"}},[i.ElementList.SLIDER_OPTION_3_BUTTON]:{[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide3"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"slide_clicked",label:"slide3"}},[i.ElementList.LOGIN]:{[i.SourceList.PRELOGIN_1_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked"},[i.SourceList.PRELOGIN_2_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked"},[i.SourceList.PRELOGIN_3_PAGE]:{category:"prelogin_page",action:"try_premium_offer_clicked"}},[i.ElementList.SUBSCRIPTION_ENDED_REVIEW]:{[i.SourceList.LOGIN_PAGE]:{category:"openLink",action:"SubscriptionReviewHere",label:"https://my.urban-vpn.com/dashboard/pricing"}},[i.ElementList.FORGOT_PASSWORD]:{[i.SourceList.LOGIN_PAGE]:{category:"forgot-password-link",action:"clicked"}},[i.ElementList.REJECT_POLICY_BUTTON]:{[i.SourceList.WELCOME_CONSENT_PAGE]:{category:"policy_cancel_button",action:"clicked"}},[i.ElementList.AGREED_POLICY_BUTTON]:{[i.SourceList.WELCOME_CONSENT_PAGE]:{category:"policy_agree_button",action:"clicked"},[i.SourceList.AD_BLOCKER_CONSENT_PAGE]:{category:"ad_blocker_agree_button",action:"clicked"},[i.SourceList.ANTI_MALWARE_CONSENT_PAGE]:{category:"safe_browsing_agree_button",action:"clicked"}},[i.ElementList.DECLINE_OFFER]:{[i.SourceList.OFFER_PAGE]:{category:"decline-offer",action:"clicked"}},[i.ElementList.RATE_US]:{[i.SourceList.RATE_US_PAGE]:{category:"rate_us_cta_button",action:"clicked"}},[i.ElementList.DISABLE_OTHER_EXTENSIONS]:{[i.SourceList.INTERRUPTION_PAGE]:{category:"interruption_page",action:"click_disable_other_extension",includeUserType:!0}},[i.ElementList.HOW_TO_DISABLE_OTHER_EXTENSIONS]:{[i.SourceList.INTERRUPTION_PAGE]:{category:"interruption_page",action:"click_how_to_disable",includeUserType:!0}},[i.ElementList.SHARE_LINK]:{[i.SourceList.INVITE_FRIENDS_PAGE]:{category:"invite_friends_copy_button",action:"clicked",includeUserType:!0}},[i.ElementList.RETRY]:{[i.SourceList.INITIALIZING_PAGE]:{category:"init-retry-button",action:"clicked"}},[i.ElementList.CANCEL_LOGOUT]:{[i.SourceList.LOGOUT_PAGE]:{category:"logout-cancel-button",action:"clicked"}},[i.ElementList.CONFIRM_LOGOUT]:{[i.SourceList.LOGOUT_PAGE]:{category:"logout-confirm-button",action:"clicked"}},[i.ElementList.AGREED_DATA_SHARING_BUTTON]:{[i.SourceList.DATA_SHARING_PAGE]:{category:"data_sharing_agree_button",action:"clicked"}},[i.ElementList.DECLINE_DATA_SHARING_BUTTON]:{[i.SourceList.DATA_SHARING_PAGE]:{category:"data_sharing_reject_button",action:"clicked"}}},t.clickGroupedByElementAndAction={[i.ElementList.AD_BLOCKER_TOGGLE_BUTTON]:{[i.ActionList.ON_AD_BLOCKER_ACTION]:{category:"ad_blocker",action:"on",includeUserType:!0},[i.ActionList.OFF_AD_BLOCKER_ACTION]:{category:"ad_blocker",action:"off",includeUserType:!0}},[i.ElementList.ANTI_MALWARE_TOGGLE_BUTTON]:{[i.ActionList.ON_ANTI_MALWARE_ACTION]:{category:"safe_browsing",action:"on",includeUserType:!0},[i.ActionList.OFF_ANTI_MALWARE_ACTION]:{category:"safe_browsing",action:"off",includeUserType:!0}},[i.ElementList.MENU_BUTTON]:{[i.ActionList.OPEN_MENU_ACTION]:{category:"Menu",action:"OnShowMenuClicked"},[i.ActionList.CLOSE_MENU_ACTION]:{category:"Menu",action:"OnCloseMenuClicked"}}}},64457:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsTrackAction=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(66044);let d=class{constructor(e,t){this.logger=e,this.dispatcher=t}on(){return u.PopupEventsOut.TRACK_ACTION}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data,n=new c.MarioEvent(l.AnalyticsModuleEvents.TRACK_ACTION,t);yield this.dispatcher.emit(n)}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.AnalyticsTrackAction=d},89816:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Analytics=void 0;const a=n(86700),s=n(18313),c=n(66044),u=n(18083);let l=class{constructor(e){this.dispatcher=e}track(e,t,n=!0){const i={eventId:e,details:t,manual:n},r=new s.MarioEvent(c.AnalyticsModuleEvents.TRACK_ACTION,i);this.dispatcher.emit(r).then()}trackClick(e,t=!0){this.track(u.EventList.CLICK,e,t)}trackAdBlockerOn(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.AD_BLOCKER__ON,e,!1)}trackAdBlockerOff(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.AD_BLOCKER__OFF,e,!1)}trackAntiMaleWareOn(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.ANTI_MALWARE__ON,e,!1)}trackAntiMaleWareOff(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.ANTI_MALWARE__OFF,e,!1)}trackLocationSelected(e,t){const n={SOURCE:u.SourceList.SYSTEM,CODE:e,TYPE:t};this.track(u.EventList.LOCATION_SELECTED,n,!1)}trackLocationStopped(e,t,n){const i={SOURCE:u.SourceList.SYSTEM,CODE:e,TYPE:t,DURATION:n};this.track(u.EventList.LOCATION_STOPPED,i,!1)}trackActiveLocationNotAvailable(e,t){const n={SOURCE:u.SourceList.SYSTEM,CODE:e,TYPE:t};this.track(u.EventList.ACTIVE_LOCATION_NOT_AVAILABLE,n,!1)}trackCouldNotActivateLocation(e,t){const n={SOURCE:u.SourceList.SYSTEM,CODE:e,TYPE:t};this.track(u.EventList.COULD_NOT_ACTIVATE_LOCATION,n,!1)}trackCouldNotEstablishConnectionWithProxy(e){const t={SOURCE:u.SourceList.SYSTEM,HOST:e};this.track(u.EventList.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY,t,!1)}trackRepairConnectionStarted(e,t){const n={SOURCE:u.SourceList.SYSTEM,HOST:e,REASON:t};this.track(u.EventList.REPAIR_CONNECTION_STARTED,n,!1)}trackRepairConnectionResult(e,t){const n={SOURCE:u.SourceList.SYSTEM,HOST:e,RESULT:t};this.track(u.EventList.REPAIR_CONNECTION_RESULT,n,!1)}trackTimeIsShifted(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.TIME_IS_SHIFTED,e,!1)}trackPageShown(e){const t={SOURCE:e,ID:e};this.track(u.EventList.PAGE_SHOWN,t,!1)}trackAuthSuccess(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.AUTH_SUCCESS,e,!1)}trackAuthFail(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.AUTH_FAIL,e,!1)}trackPolicyDecision(e){const t={SOURCE:u.SourceList.SYSTEM,DECISION:e};this.track(u.EventList.POLICY_DECISION,t,!1)}trackNonPersonalDataCollectionDecision(e){const t={SOURCE:u.SourceList.SYSTEM,DECISION:e};this.track(u.EventList.POLICY_DECISION_NON_PERSONAL,t,!1)}trackRestorePasswordRequest(e){const t={SOURCE:u.SourceList.SYSTEM,SUCCESS:e};this.track(u.EventList.RESTORE_PASSWORD_REQUEST,t,!1)}trackLogout(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.LOGOUT,e,!1)}trackTicketToSupport(e){const t={SOURCE:u.SourceList.SYSTEM,STATUS:e};this.track(u.EventList.TICKET_TO_SUPPORT,t,!1)}trackExperimentGiftPackage(e,t){const n={SOURCE:u.SourceList.SYSTEM,NAME:e,PHASE:t};this.track(u.EventList.EXPERIMENT_GIFT_PACKAGE,n,!1)}trackPromotionSyncUp(e,t){const n={SOURCE:u.SourceList.SYSTEM,STATUS:e};t&&(n.TEXT=t),this.track(u.EventList.PROMOTION_SYNC_UP,n,!1)}trackPromotionLinkClicked(e,t,n,i){const r={SOURCE:e,LINK_TEXT:n,LINK_URL:i,PROMO_TEXT:t};this.track(u.EventList.PROMOTION_LINK_CLICKED,r,!0)}trackAuthMigration(e){const t={SOURCE:u.SourceList.SYSTEM,PHASE:e};this.track(u.EventList.AUTH_TOKEN_MIGRATION,t,!1)}trackCouldNotRegisterAnonymous(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.COULD_NOT_REGISTER_ANONYMOUS,e,!1)}trackCouldNotGetSecurityToken(){const e={SOURCE:u.SourceList.SYSTEM};this.track(u.EventList.COULD_NOT_GET_SECURITY_TOKEN,e,!1)}trackExtensionUpdated(e,t){const n={SOURCE:u.SourceList.SYSTEM,CURRENT_VERSION:t,PREV_VERSION:e};this.track(u.EventList.EXTENSION_UPDATED,n,!1)}};l=i([(0,a.injectable)(),o(0,(0,a.inject)(s.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],l),t.Analytics=l},17138:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UAModule=void 0;const r=n(18313),o=n(18046),a=n(82150),s=n(47198),c=n(17418);class u extends r.MarioModule{name(){return"UAModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(s.UAModuleTypes.UA_ANALYTICS,o.UAAnalytics),this.mario().internalDispatcher().on(a.UATrackAction),this.registerOnUpdateExtensionListener()}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(u,t)}))}registerOnUpdateExtensionListener(){this.mario().extension().onInstall((e=>{if("update"===e.reason){const t=e.previousVersion,n=this.mario().extension().manifest().version;setTimeout((()=>{this.mario().getService(c.AnalyticsModuleTypes.ANALYTICS).trackExtensionUpdated(t,n)}),6e4)}}))}}t.UAModule=u},47198:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UAModuleTypes=void 0;const n={UA_ANALYTICS:Symbol.for("APP_UA_ANALYTICS")};t.UAModuleTypes=n},30810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventIgnoreList=void 0;const i=n(18083);t.EventIgnoreList=[i.EventList.COULD_NOT_GET_SECURITY_TOKEN,i.EventList.PROMOTION_SYNC_UP,i.EventList.RESTORE_PASSWORD_REQUEST,i.EventList.TICKET_TO_SUPPORT,i.EventList.TIME_IS_SHIFTED,i.EventList.COUNTRY_RESTRICTED_PAGE_SHOWN,i.EventList.PRIVACY_POLICY_PAGE_SHOWN,i.EventList.POLICY_INTERNAL_ANALYTICS_TOGGLE,i.EventList.POLICY_ADS_ANALYTICS_TOGGLE,i.EventList.POLICY_WEB_ACCESS_LOGS_TOGGLE,i.EventList.POLICY_DATA_SHARING_TOGGLE]},82150:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UATrackAction=void 0;const s=n(86700),c=n(16437),u=n(18313),l=n(18046),d=n(47198),h=n(30810);let f=class{constructor(e,t){this.logger=e,this.client=t}on(){return c.PopupEventsOut.TRACK_ACTION}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data;if(h.EventIgnoreList.includes(t.eventId))return void this.logger.log("Urban Analytics: ignore event",t);const n={action:t.eventId,details:t.details,manual:t.manual};yield this.client.track(n)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(u.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(d.UAModuleTypes.UA_ANALYTICS)),r("design:paramtypes",[Object,l.UAAnalytics])],f),t.UATrackAction=f},18046:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UAAnalytics=void 0;const s=n(86700),c=n(72233),u=n(86215),l=n(99841),d=n(18313);let h=class{constructor(e,t){this.ua=e,this.container=t}enable(){return a(this,void 0,void 0,(function*(){yield this.ua.enable()}))}disable(){return a(this,void 0,void 0,(function*(){yield this.ua.disable()}))}isEnabled(){return this.ua.isEnabled()}track(e){if(this.container.isBound(l.AUTH_MODULE_TYPES.CURRENT_USER)){const t=this.container.get(l.AUTH_MODULE_TYPES.CURRENT_USER);t.getSecurityToken()&&(e.packageId=t.getSecurityToken().package.id)}return this.ua.track(e)}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanAnalyticsTypes.CLIENT)),o(1,(0,s.inject)(d.MARIO_TYPES.CONTAINER)),r("design:paramtypes",[c.UrbanAnalyticsClient,s.Container])],h),t.UAAnalytics=h},43923:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AppModule=void 0;const r=n(18313),o=n(42543),a=n(50257),s=n(42739),c=n(62341),u=n(83088),l=n(75357),d=n(61151),h=n(37711),f=n(90986),p=n(54837),_=n(48166),E=n(33409),y=n(95813),v=n(63929),g=n(98979),S=n(14957),T=n(58026),O=n(89273),m=n(34723),A=n(71109),R=n(4761),P=n(58143),I=n(36050),N=n(71754),b=n(29392),C=n(50187),L=n(37240),M=n(81223),w=n(4213),D=n(40093),j=n(498),U=n(759),x=n(27085),G=n(60632),k=n(76251),B=n(81338),V=n(54895),F=n(22510),Y=n(30593),H=n(74568),W=n(6203),K=n(34644),q=n(64450),X=n(6770),$=n(25134),J=n(85550),z=n(70739),Z=n(26344),Q=n(80880),ee=n(2493),te=n(65310),ne=n(38981),ie=n(38112),re=n(22347),oe=n(74678),ae=n(1103),se=n(60191),ce=n(72485),ue=n(77799),le=n(34807),de=n(45318),he=n(8781),fe=n(6644),pe=n(57569);n.g;class _e extends r.MarioModule{name(){return"AppModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(u.UrbanTypes.URBAN_VETERAN_PACKAGE_ID).toConstantValue(e.veteranPackageId),this.mario().registerService(u.UrbanTypes.URBAN_INTERRUPTION_SERVICE,f.InterruptionService),this.mario().registerService(u.UrbanTypes.URBAN_POPUP_EMITTER,L.PopupEmitter),this.mario().registerService(u.UrbanTypes.URBAN_POLICIES_STORAGE,ae.PoliciesStorage),this.mario().registerService(u.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE,O.PopupProcessService),this.mario().registerService(u.UrbanTypes.URBAN_POPUP_ACCOUNT_EMITTER,M.PopupAccountEmitter),this.mario().registerService(u.UrbanTypes.URBAN_POPUP_STATE_SERVICE,D.PopupStateService),this.mario().registerService(u.UrbanTypes.URBAN_DATA_COLLECTION_SERVICE,B.DataCollectionService),this.mario().registerService(u.UrbanTypes.URBAN_BUGSNAG_SERVICE,V.UrbanBugsnagService);const t=this.mario().getService(u.UrbanTypes.URBAN_TOOLBAR_SERVICE);t.draw(t.getGreyedRoboImage()).then();const n=this.mario().getService(o.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE);this.mario().internalDispatcher().on(d.PolicyAgreedEventListener),this.mario().internalDispatcher().on(h.PolicyRejectedEventListener),yield(0,l.delay)(100),yield n.restoreState(),this.mario().externalDispatcher().on(c.RedirectToSafePageEventListener),this.mario().internalDispatcher().on(a.BeforeLocationDeactivated),this.mario().internalDispatcher().on(s.AfterLocationActivated),this.mario().internalDispatcher().on(p.AfterLogin),this.mario().internalDispatcher().on(_.AfterLogout),this.mario().internalDispatcher().on(H.TimeShifted),this.mario().internalDispatcher().on(W.BeforeLocationActivated),this.mario().internalDispatcher().on(K.CouldNotActivateLocation),this.mario().internalDispatcher().on(q.CouldNotDeliveryResponse),this.mario().internalDispatcher().on(X.RepairConnection),this.mario().internalDispatcher().on($.RepairConnectionResult),this.mario().internalDispatcher().on(J.IpAddressChanged),this.mario().internalDispatcher().on(z.AfterLocationDeactivated),this.mario().internalDispatcher().on(Z.CouldNotEstablishConnectionWithProxy),this.mario().internalDispatcher().on(Q.ActiveLocationNotAvailableListener),this.mario().internalDispatcher().on(ee.RestorePasswordRequest),this.mario().internalDispatcher().on(te.TicketToSupport),this.mario().internalDispatcher().on(ne.LoginFailed),this.mario().portDispatcher().on(E.InitPopupListener),this.mario().portDispatcher().on(y.PolicyAgreedListener),this.mario().portDispatcher().on(v.PolicyRejectedListener),this.mario().portDispatcher().on(g.LoginListener),this.mario().portDispatcher().on(T.LogoutListener),this.mario().portDispatcher().on(S.DisableExtensionsThatCauseInterruptionsListener),this.mario().portDispatcher().on(m.ActivateLocationListener),this.mario().portDispatcher().on(A.DeactivateLocationListener),this.mario().portDispatcher().on(R.AdBlockerEnableListener),this.mario().portDispatcher().on(P.AdBlockerDisableListener),this.mario().portDispatcher().on(I.AntiMaleWareEnableListener),this.mario().portDispatcher().on(N.AntiMaleWareDisableListener),this.mario().portDispatcher().on(b.PageHistoryVisitListener),this.mario().portDispatcher().on(C.GetAccountListener),this.mario().portDispatcher().on(w.HandsShakeListener),this.mario().portDispatcher().on(j.RestorePasswordListener),this.mario().portDispatcher().on(U.CounterIncreaseListener),this.mario().portDispatcher().on(x.ActivateFlagListener),this.mario().portDispatcher().on(F.DeactivateFlagListener),this.mario().portDispatcher().on(G.CreateNewTabListener),this.mario().portDispatcher().on(k.SendTicketListener),this.mario().portDispatcher().on(re.DataSharingAgreedListener),this.mario().portDispatcher().on(ie.DataSharingRejectedListener),this.mario().portDispatcher().on(oe.IsDataSharingEnabledEventListener),this.mario().portDispatcher().on(se.IsAntiMaleWareConsentAgreedListener),this.mario().portDispatcher().on(ce.AntiMaleWareConsentListener),this.mario().portDispatcher().on(ue.IsAdBlockerConsentAgreedListener),this.mario().portDispatcher().on(le.AdBlockerConsentListener),this.mario().portDispatcher().on(de.SetGAStateEventListener),this.mario().portDispatcher().on(he.IsGAEnabledEventListener),this.mario().portDispatcher().on(fe.IsUAEnabledEventListener),this.mario().portDispatcher().on(pe.SetUAStateEventListener),yield this.restoreSession(),this.mario().getService(u.UrbanTypes.URBAN_APP_SERVICE).setState(Y.AppState.DIRECT_MODE)}))}static use(e,t){return i(this,void 0,void 0,(function*(){yield e.registerModule(_e,t)}))}restoreSession(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(u.UrbanTypes.URBAN_DATA_COLLECTION_SERVICE),t=this.mario().getService(u.UrbanTypes.URBAN_BUGSNAG_SERVICE);e.restoreSession(),yield t.restoreSession()}))}}t.AppModule=_e},43425:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanInnerEvents=void 0,function(e){e.TRACK_ACTION="TRACK_ACTION",e.COULD_NOT_DELIVERY_RESPONSE_TO_POPUP="COULD_NOT_DELIVERY_RESPONSE_TO_POPUP"}(t.UrbanInnerEvents||(t.UrbanInnerEvents={}))},83088:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanTypes=void 0,t.UrbanTypes={URBAN_TOOLBAR_SERVICE:Symbol.for("URBAN_TOOLBAR_SERVICE"),URBAN_PAGE_HISTORY_SERVICE:Symbol.for("URBAN_PAGE_HISTORY_SERVICE"),URBAN_AD_BLOCKER_SERVICE:Symbol.for("URBAN_AD_BLOCKER_SERVICE"),URBAN_PANEL_OS_SERVICE:Symbol.for("URBAN_PANEL_OS_SERVICE"),URBAN_INTERRUPTION_SERVICE:Symbol.for("URBAN_INTERRUPTION_SERVICE"),URBAN_APP_SERVICE:Symbol.for("URBAN_APP_SERVICE"),URBAN_VETERAN_PACKAGE_ID:Symbol.for("URBAN_VETERAN_PACKAGE_ID"),URBAN_POPUP_PROCESS_SERVICE:Symbol.for("URBAN_POPUP_PROCESS_SERVICE"),URBAN_POPUP_STATE_SERVICE:Symbol.for("URBAN_POPUP_STATE_SERVICE"),URBAN_DATA_COLLECTION_SERVICE:Symbol.for("URBAN_DATA_COLLECTION_SERVICE"),URBAN_BUGSNAG_SERVICE:Symbol.for("URBAN_BUGSNAG_SERVICE"),URBAN_POLICIES_STORAGE:Symbol.for("URBAN_POLICIES_STORAGE"),URBAN_POPUP_EMITTER:Symbol.for("URBAN_POPUP_EMITTER"),URBAN_POPUP_ACCOUNT_EMITTER:Symbol.for("URBAN_POPUP_ACCOUNT_EMITTER")}},62341:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectToSafePageEventListener=void 0;const s=n(86700),c=n(18313),u=n(5945),l=n(2325),d=n(75357);let h=class{constructor(e){this.tabService=e}on(){return u.ContentEvents.REDIRECT_TO_SAFE_PAGE}handle(e,t,n){return a(this,void 0,void 0,(function*(){const{tab:e}=t,n=(0,d.getBrowserBlankPageUrl)();this.tabService.update({url:n},e.id)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.TAB_SERVICE)),r("design:paramtypes",[l.TabService])],h),t.RedirectToSafePageEventListener=h},80880:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveLocationNotAvailableListener=void 0;const s=n(44110),c=n(86700),u=n(39242),l=n(36723),d=n(98948),h=n(82325),f=n(47669),p=n(83088),_=n(60456),E=n(89816),y=n(17418),v=n(2883),g=n(81505);let S=class{constructor(e,t,n,i,r){this.notificationService=e,this.locationService=t,this.toolbar=n,this.adBlocker=i,this.analytics=r}on(){return s.LocationModuleEvents.ACTIVE_LOCATION_NOT_AVAILABLE}handle(e){return a(this,void 0,void 0,(function*(){this.toolbar.stopAnimation();const t=this.toolbar.getGreyedRoboImage();this.toolbar.draw(t).then();const n=e.data.location;this.notificationService.show({type:f.NotificationType.ERROR,message:`Connection to ${n.name().value()} was terminated`,duration:5e3,image:f.NotificationImage.ALERT,header:"Urban VPN",buttons:[{id:"OK",text:"Ok, thanks",style:"primary"}]}).then(),this.analytics.trackActiveLocationNotAvailable((0,v.getLocationCode)(n),(0,v.getLocationType)(n)),setTimeout((()=>this.adBlocker.updateConfig()),3e3)}))}};S=i([(0,c.injectable)(),o(0,(0,c.inject)(l.NotificationModuleTypes.NOTIFICATION_SERVICE)),o(1,(0,c.inject)(h.LocationModuleTypes.LOCATION_SERVICE)),o(2,(0,c.inject)(p.UrbanTypes.URBAN_TOOLBAR_SERVICE)),o(3,(0,c.inject)(p.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(4,(0,c.inject)(y.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[u.NotificationService,d.LocationService,_.UrbanToolbarService,g.AdBlockerService,E.Analytics])],S),t.ActiveLocationNotAvailableListener=S},42739:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AfterLocationActivated=void 0;const s=n(86700),c=n(18313),u=n(83105),l=n(95950),d=n(22934),h=n(83088),f=n(60456),p=n(72032),_=n(81505),E=n(15035),y=n(33770),v=n(53511),g=n(18083),S=n(75357),T=n(16437),O=n(82325),m=n(38107);let A=class{constructor(e,t,n,i,r,o,a){this.hideLocationService=e,this.toolbar=t,this.logger=n,this.adBlocker=i,this.locationHelper=r,this.dispatcher=o,this.tokenManager=a}on(){return u.ProxyLocationEvents.PROXY_LOCATION_AFTER_ACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){this.hideLocationService.enable();const t=e.data.location,n=t.code().value();this.toolbar.stopAnimation(),t.isType(p.LocationType.RANDOM)?yield this.toolbar.drawAutoServer():yield this.toolbar.drawFlag(n),this.adBlocker.updateConfig(),this.trackAnalytics(n)}))}trackAnalytics(e){const t=this.locationHelper.getCountryName(e,v.LocationProvider.AUTO_SERVER),n={eventId:g.EventList.LOCATION_STARTED,manual:!0,details:{SOURCE:g.SourceList.SYSTEM,CONNECTION_RESULT:g.LocationStartedResult.success,CONNECTION_TYPE:g.LocationStartedType.first,HOST:(0,S.makeHost)(this.tokenManager.getProxyServer()),COUNTRY:t,CODE:e}},i=new c.MarioEvent(T.PopupEventsOut.TRACK_ACTION,n);this.dispatcher.emit(i)}};A=i([(0,s.injectable)(),o(0,(0,s.inject)(l.HideMyLocationTypes.HIDE_MY_LOCATION_SERVICE)),o(1,(0,s.inject)(h.UrbanTypes.URBAN_TOOLBAR_SERVICE)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(h.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(4,(0,s.inject)(E.ProxyLocationTypes.LOCATION_HELPER_SERVICE)),o(5,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(6,(0,s.inject)(O.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[d.HideMyGeoLocationService,f.UrbanToolbarService,Object,_.AdBlockerService,y.LocationHelper,Object,m.ProxyAuthTokenManager])],A),t.AfterLocationActivated=A},70739:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AfterLocationDeactivated=void 0;const s=n(83105),c=n(86700),u=n(81505),l=n(83088);let d=class{constructor(e){this.adBlocker=e}on(){return s.ProxyLocationEvents.PROXY_LOCATION_AFTER_DEACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){this.adBlocker.updateConfig()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(l.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),r("design:paramtypes",[u.AdBlockerService])],d),t.AfterLocationDeactivated=d},54837:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AfterLogin=void 0;const s=n(86700),c=n(18313),u=n(48476),l=n(99841),d=n(98948),h=n(82325),f=n(45103),p=n(83088),_=n(63654),E=n(42543),y=n(89273),v=n(20466),g=n(23682),S=n(8291),T=n(81338),O=n(54895),m=n(89816),A=n(17418);let R=class{constructor(e,t,n,i,r,o,a,s,c){this.logger=e,this.locationService=t,this.currentUser=n,this.safeCheckStateService=i,this.process=r,this.flagService=o,this.bugsnag=a,this.dataCollectionsService=s,this.analytics=c}on(){return u.AuthModuleEvents.AFTER_LOGIN}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackAuthSuccess();const e=[S.FlagList.INIT,S.FlagList.FORCE_LOGIN];for(const t of e){const e=(yield this.flagService.has(t))&&(yield this.flagService.isActivated(t)),n=!(yield this.flagService.has(t));(e||n)&&(yield this.flagService.deactivate(t))}yield this.bugsnag.premiumUser(),this.currentUser.hasDisabledDataCollectionFeature()&&this.dataCollectionsService.disableDataCollection(),yield this.locationService.removeEarth(),this.process.isProcessing()&&this.process.finish().then()}))}};R=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(h.LocationModuleTypes.LOCATION_SERVICE)),o(2,(0,s.inject)(l.AUTH_MODULE_TYPES.CURRENT_USER)),o(3,(0,s.inject)(E.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(4,(0,s.inject)(p.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(5,(0,s.inject)(g.FlagModuleTypes.FLAG_SERVICE)),o(6,(0,s.inject)(p.UrbanTypes.URBAN_BUGSNAG_SERVICE)),o(7,(0,s.inject)(p.UrbanTypes.URBAN_DATA_COLLECTION_SERVICE)),o(8,(0,s.inject)(A.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[Object,d.LocationService,f.CurrentUser,_.StateService,y.PopupProcessService,v.FlagService,O.UrbanBugsnagService,T.DataCollectionService,m.Analytics])],R),t.AfterLogin=R},48166:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AfterLogout=void 0;const s=n(86700),c=n(18313),u=n(48476),l=n(83088),d=n(82325),h=n(98948),f=n(42543),p=n(63654),_=n(26656),E=n(89273),y=n(40093),v=n(46149),g=n(49798),S=n(99841),T=n(45103),O=n(81505),m=n(81338),A=n(54895),R=n(23682),P=n(20466),I=n(93520),N=n(89816),b=n(17418);let C=class{constructor(e,t,n,i,r,o,a,s,c,u,l,d,h,f){this.analytics=e,this.alarm=t,this.dataCollectionsService=n,this.locationService=i,this.safeCheckStateService=r,this.logger=o,this.process=a,this.popupStateService=s,this.policy=c,this.currentUser=u,this.adBlocker=l,this.bugsnag=d,this.flagService=h,this.appState=f}on(){return u.AuthModuleEvents.AFTER_LOGOUT}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackLogout(),yield this.bugsnag.anonymousUser(),this.currentUser.hasDisabledDataCollectionFeature()||((yield this.policy.isAgreed())?yield this.dataCollectionsService.enableDataCollection():!(yield this.policy.isRejected())&&(yield this.policy.hasAnswer())||(yield this.safeCheckStateService.disable(),yield this.adBlocker.deactivateService(),(yield this.adBlocker.isAdBlockingEnabled())&&(yield this.adBlocker.disableAdBlocking()),this.safeCheckStateService.isEnabledNotification()&&(yield this.safeCheckStateService.disableNotification()))),this.appState.isProxyConnected()&&(yield this.locationService.deactivate()),yield this.locationService.removeEarth(),yield this.alarm.clear(_.LocationAlarms.REFRESH_PROXY_TOKEN),this.process.isProcessing()&&this.process.finish().then()}))}};C=i([(0,s.injectable)(),o(0,(0,s.inject)(b.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(c.MARIO_TYPES.ALARM_SERVICE)),o(2,(0,s.inject)(l.UrbanTypes.URBAN_DATA_COLLECTION_SERVICE)),o(3,(0,s.inject)(d.LocationModuleTypes.LOCATION_SERVICE)),o(4,(0,s.inject)(f.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(5,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(7,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_STATE_SERVICE)),o(8,(0,s.inject)(g.PolicyModuleTypes.POLICY_SERVICE)),o(9,(0,s.inject)(S.AUTH_MODULE_TYPES.CURRENT_USER)),o(10,(0,s.inject)(l.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(11,(0,s.inject)(l.UrbanTypes.URBAN_BUGSNAG_SERVICE)),o(12,(0,s.inject)(R.FlagModuleTypes.FLAG_SERVICE)),o(13,(0,s.inject)(l.UrbanTypes.URBAN_APP_SERVICE)),r("design:paramtypes",[N.Analytics,Object,m.DataCollectionService,h.LocationService,p.StateService,Object,E.PopupProcessService,y.PopupStateService,v.PolicyService,T.CurrentUser,O.AdBlockerService,A.UrbanBugsnagService,P.FlagService,I.AppService])],C),t.AfterLogout=C},6203:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BeforeLocationActivated=void 0;const s=n(86700),c=n(18313),u=n(83088),l=n(83105),d=n(60456),h=n(89816),f=n(17418),p=n(2883);let _=class{constructor(e,t,n){this.analytics=e,this.logger=t,this.toolbar=n}on(){return l.ProxyLocationEvents.PROXY_LOCATION_BEFORE_ACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){this.toolbar.drawConnectionAnimation();const t=e.data.location;this.analytics.trackLocationSelected((0,p.getLocationCode)(t),(0,p.getLocationType)(t))}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(f.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(u.UrbanTypes.URBAN_TOOLBAR_SERVICE)),r("design:paramtypes",[h.Analytics,Object,d.UrbanToolbarService])],_),t.BeforeLocationActivated=_},50257:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BeforeLocationDeactivated=void 0;const s=n(86700),c=n(83088),u=n(60456),l=n(83105),d=n(89816),h=n(17418),f=n(2883),p=n(98948),_=n(82325),E=n(99490);let y=class{constructor(e,t,n){this.analytics=e,this.toolbar=t,this.locationService=n}on(){return l.ProxyLocationEvents.PROXY_LOCATION_AFTER_DEACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data,n=E.DateTime.fromSeconds(yield this.locationService.getActivationTime()),i=E.DateTime.local().diff(n,["seconds"]).seconds;this.analytics.trackLocationStopped((0,f.getLocationCode)(t),(0,f.getLocationType)(t),i);const r=this.toolbar.getGreyedRoboImage();yield this.toolbar.draw(r)}))}};y=i([(0,s.injectable)(),o(0,(0,s.inject)(h.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(c.UrbanTypes.URBAN_TOOLBAR_SERVICE)),o(2,(0,s.inject)(_.LocationModuleTypes.LOCATION_SERVICE)),r("design:paramtypes",[d.Analytics,u.UrbanToolbarService,p.LocationService])],y),t.BeforeLocationDeactivated=y},34644:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CouldNotActivateLocation=void 0;const s=n(86700),c=n(44110),u=n(83088),l=n(60456),d=n(17418),h=n(89816),f=n(2883);let p=class{constructor(e,t){this.toolbar=e,this.analytics=t}on(){return c.LocationModuleEvents.COULD_NOT_ACTIVATE_LOCATION}handle(e){return a(this,void 0,void 0,(function*(){this.toolbar.stopAnimation();const t=this.toolbar.getGreyedRoboImage();this.toolbar.draw(t).then();const{location:n}=e.data;this.analytics.trackCouldNotActivateLocation((0,f.getLocationCode)(n),(0,f.getLocationType)(n))}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanTypes.URBAN_TOOLBAR_SERVICE)),o(1,(0,s.inject)(d.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[l.UrbanToolbarService,h.Analytics])],p),t.CouldNotActivateLocation=p},64450:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CouldNotDeliveryResponse=void 0;const s=n(86700),c=n(43425),u=n(36723),l=n(39242),d=n(47669);let h=class{constructor(e){this.notificationService=e}on(){return c.UrbanInnerEvents.COULD_NOT_DELIVERY_RESPONSE_TO_POPUP}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data;["ACTIVATE_LOCATION"].includes(t.onRequest)&&this.notificationService.show({type:t.ok?d.NotificationType.SUCCESS:d.NotificationType.ERROR,message:t.message,duration:3e3,image:t.ok?d.NotificationImage.WINK:d.NotificationImage.ALERT,header:"Urban VPN",buttons:[{id:"OK",text:"Ok, thanks",style:"primary"}]}).then()}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(u.NotificationModuleTypes.NOTIFICATION_SERVICE)),r("design:paramtypes",[l.NotificationService])],h),t.CouldNotDeliveryResponse=h},26344:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CouldNotEstablishConnectionWithProxy=void 0;const s=n(86700),c=n(44110),u=n(88376),l=n(17418),d=n(89816);let h=class{constructor(e){this.analytics=e}on(){return c.LocationModuleEvents.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY}handle(e){return a(this,void 0,void 0,(function*(){const{proxy:t}=e.data,n=u.ProxySignature.buildKey(t);this.analytics.trackCouldNotEstablishConnectionWithProxy(n)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(l.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[d.Analytics])],h),t.CouldNotEstablishConnectionWithProxy=h},85550:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IpAddressChanged=void 0;const s=n(44110),c=n(86700),u=n(83088),l=n(81505);let d=class{constructor(e){this.adBlocker=e}on(){return s.LocationModuleEvents.IP_ADDRESS_CHANGED}handle(e){return a(this,void 0,void 0,(function*(){this.adBlocker.updateConfig()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(u.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),r("design:paramtypes",[l.AdBlockerService])],d),t.IpAddressChanged=d},38981:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LoginFailed=void 0;const a=n(86700),s=n(48476),c=n(89816),u=n(17418);let l=class{constructor(e){this.analytics=e}on(){return s.AuthModuleEvents.LOGIN_FAILED}handle(e){this.analytics.trackAuthFail()}};l=i([(0,a.injectable)(),o(0,(0,a.inject)(u.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[c.Analytics])],l),t.LoginFailed=l},61151:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyAgreedEventListener=void 0;const s=n(86700),c=n(86878),u=n(42543),l=n(56906),d=n(63654),h=n(83088),f=n(81505),p=n(1103),_=n(48929),E=n(89273),y=n(32410),v=n(11578);let g=class{constructor(e,t,n,i,r,o){this.adBlocker=e,this.libStateService=t,this.safeCheckStateService=n,this.urbanPolicy=i,this.process=r,this.stream=o}on(){return c.PolicyServiceEvents.POLICY_AGREED}handle(e){return a(this,void 0,void 0,(function*(){yield this.stream.tracking(!0),yield this.stream.safeCheckTracking(!0),this.safeCheckStateService.setMode(u.MODE.FULL_NAVIGATION),yield this.libStateService.enable(),this.adBlocker.activateService(),yield this.adBlocker.enableDataCollection(),yield this.urbanPolicy.agreeAntiMiningPolicy(),yield this.urbanPolicy.agreeAdBlockerPolicy(),yield this.process.updateState(_.PopupProcess.ANTI_MALE_WARE_CONSENT),yield this.process.updateState(_.PopupProcess.AD_BLOCKER_CONSENT)}))}};g=i([(0,s.injectable)(),o(0,(0,s.inject)(h.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(1,(0,s.inject)(u.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE)),o(2,(0,s.inject)(u.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(3,(0,s.inject)(h.UrbanTypes.URBAN_POLICIES_STORAGE)),o(4,(0,s.inject)(h.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(5,(0,s.inject)(y.ECommerceModuleTypes.STREAM)),r("design:paramtypes",[f.AdBlockerService,l.LibStateService,d.StateService,p.PoliciesStorage,E.PopupProcessService,v.ECommerceStream])],g),t.PolicyAgreedEventListener=g},37711:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyRejectedEventListener=void 0;const s=n(86700),c=n(86878),u=n(83088),l=n(1103),d=n(48929),h=n(89273);let f=class{constructor(e,t){this.urbanPolicy=e,this.process=t}on(){return c.PolicyServiceEvents.POLICY_REJECTED}handle(){return a(this,void 0,void 0,(function*(){yield this.urbanPolicy.rejectAdBlockerPolicy(),yield this.urbanPolicy.rejectAntiMiningPolicy(),yield this.process.updateState(d.PopupProcess.ANTI_MALE_WARE_CONSENT),yield this.process.updateState(d.PopupProcess.AD_BLOCKER_CONSENT)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanTypes.URBAN_POLICIES_STORAGE)),o(1,(0,s.inject)(u.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[l.PoliciesStorage,h.PopupProcessService])],f),t.PolicyRejectedEventListener=f},6770:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RepairConnection=void 0;const s=n(86700),c=n(44110),u=n(82325),l=n(38107),d=n(88376),h=n(17418),f=n(89816);let p=class{constructor(e,t){this.analytics=e,this.tokenManager=t}on(){return c.LocationModuleEvents.REPAIR_CONNECTION}handle(e){return a(this,void 0,void 0,(function*(){const{reason:t,proxy:n}=e.data,i=d.ProxySignature.buildKey(n);this.analytics.trackRepairConnectionStarted(i,t)}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(h.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(u.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[f.Analytics,l.ProxyAuthTokenManager])],p),t.RepairConnection=p},25134:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RepairConnectionResult=void 0;const s=n(86700),c=n(44110),u=n(83088),l=n(60456),d=n(88376),h=n(17418),f=n(89816),p=n(18083),_=n(81505),E=n(48929),y=n(89273);let v=class{constructor(e,t,n,i){this.analytics=e,this.process=t,this.toolbar=n,this.adBlocker=i}on(){return c.LocationModuleEvents.REPAIR_CONNECTION_RESULT}handle(e){return a(this,void 0,void 0,(function*(){const{status:t,proxy:n}=e.data;if(yield this.process.updateState(E.PopupProcess.REPAIR_CONNECTION),!t){this.toolbar.stopAnimation();const e=this.toolbar.getGreyedRoboImage();this.toolbar.draw(e).then()}const i=t?d.ProxySignature.buildKey(n):"",r=t?p.RepairStatus.SUCCESS:p.RepairStatus.FAILURE;this.analytics.trackRepairConnectionResult(i,r),this.adBlocker.updateConfig()}))}};v=i([(0,s.injectable)(),o(0,(0,s.inject)(h.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(u.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(2,(0,s.inject)(u.UrbanTypes.URBAN_TOOLBAR_SERVICE)),o(3,(0,s.inject)(u.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),r("design:paramtypes",[f.Analytics,y.PopupProcessService,l.UrbanToolbarService,_.AdBlockerService])],v),t.RepairConnectionResult=v},2493:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RestorePasswordRequest=void 0;const a=n(86700),s=n(36344),c=n(89816),u=n(17418);let l=class{constructor(e){this.analytics=e}on(){return s.AccountModuleEvents.RESTORE_PASSWORD_REQUEST}handle(e){const{success:t}=e.data;this.analytics.trackRestorePasswordRequest(t)}};l=i([(0,a.injectable)(),o(0,(0,a.inject)(u.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[c.Analytics])],l),t.RestorePasswordRequest=l},65310:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TicketToSupport=void 0;const s=n(86700),c=n(36344),u=n(89816),l=n(17418),d=n(18083);let h=class{constructor(e){this.analytics=e}on(){return c.AccountModuleEvents.SEND_TICKET_TO_SUPPORT}handle(e){return a(this,void 0,void 0,(function*(){const{status:t}=e.data;this.analytics.trackTicketToSupport(t?d.TicketToSupportStatus.SENT:d.TicketToSupportStatus.FAILURE)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(l.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[u.Analytics])],h),t.TicketToSupport=h},74568:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TimeShifted=void 0;const s=n(86700),c=n(44110),u=n(17418),l=n(89816);let d=class{constructor(e){this.analytics=e}on(){return c.LocationModuleEvents.TIME_SHIFTED}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackTimeIsShifted()}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(u.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[l.Analytics])],d),t.TimeShifted=d},14957:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DisableExtensionsThatCauseInterruptionsListener=void 0;const s=n(16437),c=n(86700),u=n(83088),l=n(90986);let d=class{constructor(e){this.interruptionService=e}on(){return s.PopupEventsOut.DISABLE_EXTENSIONS_THAT_CAUSE_INTERRUPTION}handle(e){return a(this,void 0,void 0,(function*(){yield this.interruptionService.disableExtensionsThatCauseInterruptions()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(u.UrbanTypes.URBAN_INTERRUPTION_SERVICE)),r("design:paramtypes",[l.InterruptionService])],d),t.DisableExtensionsThatCauseInterruptionsListener=d},4213:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.HandsShakeListener=void 0;const s=n(86700),c=n(16437),u=n(83088),l=n(89273),d=n(48929);let h=class{constructor(e){this.process=e}on(){return c.PopupEventsOut.HANDS_SHAKE_START}handle(e){return a(this,void 0,void 0,(function*(){this.process.start(d.PopupProcess.HANDS_SHAKE_START),this.process.finish().then()}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[l.PopupProcessService])],h),t.HandsShakeListener=h},33409:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InitPopupListener=void 0;const s=n(16437),c=n(18313),u=n(86700),l=n(83088),d=n(99841),h=n(45103),f=n(89273),p=n(2975),_=n(81630),E=n(7009),y=n(99093),v=n(40093),g=n(48929);let S=class{constructor(e,t,n,i,r,o,a){this.authService=e,this.accountService=t,this.authSetupService=n,this.currentUser=i,this.logger=r,this.popup=o,this.popupStateService=a}on(){return s.PopupEventsOut.INIT}handle(e){return a(this,void 0,void 0,(function*(){if(yield this.authSetupService.isAuthTokenNotReady()){this.logger.warn("Popup init: a user does not have auth token for anonymous, let's create it");let e=!1;try{(yield this.authSetupService.setupAuthToken())||(e=!0)}catch(t){e=!0}if(e)return void this.popup.updateState(g.PopupProcess.INIT,"Connection timeout",!1).then()}if(yield this.authSetupService.isSecurityTokenNotReady())try{yield this.authSetupService.setupSecurityToken()}catch(e){return this.logger.error(e),void this.popup.updateState(g.PopupProcess.INIT,"Connection timeout",!1).then()}if(this.authSetupService.isInterceptorNotReady()&&(yield this.authSetupService.setupInterceptor()),this.currentUser.isPremiumUser()&&(yield this.authService.isAuthTokenExpired()))return this.logger.log("Popup init: try to open a popup as premium user with expired auth token"),void this.authService.autoLogout().then();this.popup.updateState(g.PopupProcess.INIT).then()}))}};S=i([(0,u.injectable)(),o(0,(0,u.inject)(d.AUTH_MODULE_TYPES.AUTH_SERVICE)),o(1,(0,u.inject)(E.ACCOUNT_MODULE_TYPES.ACCOUNT_SERVICE)),o(2,(0,u.inject)(d.AUTH_MODULE_TYPES.SETUP_SERVICE)),o(3,(0,u.inject)(d.AUTH_MODULE_TYPES.CURRENT_USER)),o(4,(0,u.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(5,(0,u.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(6,(0,u.inject)(l.UrbanTypes.URBAN_POPUP_STATE_SERVICE)),r("design:paramtypes",[p.AuthService,_.AccountService,y.AuthSetupService,h.CurrentUser,Object,f.PopupProcessService,v.PopupStateService])],S),t.InitPopupListener=S},50187:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GetAccountListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(83088),d=n(81630),h=n(7009),f=n(81223),p=n(37320),_=n(45103),E=n(99841);let y=class{constructor(e,t,n,i,r){this.logger=e,this.accountEmitter=t,this.accountService=n,this.paymentsService=i,this.currentUser=r}on(){return u.PopupEventsOut.GET_CURRENT_ACCOUNT}handle(e){return a(this,void 0,void 0,(function*(){try{const e=this.currentUser.getSecurityToken().owner.id,t=yield this.paymentsService.getSubscription(e),n=yield this.paymentsService.getPaymentsHistory(e),i={lastPaymentDate:Number(n[n.length-1].createdAt),lastPaymentAmount:n[n.length-1].amount,lastPaymentCurrency:n[n.length-1].currency,paymentType:t.paymentType,packageName:t.package.name};t.paymentType===p.PaymentType.CARD&&(i.lastFourDigits=t.lastFourDigits,i.cardType=t.cardType);const r={ok:!0,content:i,onRequest:u.PopupEventsOut.GET_CURRENT_ACCOUNT};this.accountEmitter.sendAccount(r)}catch(e){}}))}};y=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_ACCOUNT_EMITTER)),o(2,(0,s.inject)(h.ACCOUNT_MODULE_TYPES.ACCOUNT_SERVICE)),o(3,(0,s.inject)(h.ACCOUNT_MODULE_TYPES.PAYMENTS_SERVICE)),o(4,(0,s.inject)(E.AUTH_MODULE_TYPES.CURRENT_USER)),r("design:paramtypes",[Object,f.PopupAccountEmitter,d.AccountService,p.PaymentService,_.CurrentUser])],y),t.GetAccountListener=y},34807:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerConsentListener=void 0;const s=n(86700),c=n(83088),u=n(81505),l=n(89273),d=n(16437),h=n(1103),f=n(48929),p=n(83379),_=n(35177);let E=class{constructor(e,t,n,i){this.urbanStorage=e,this.adBlocker=t,this.processor=n,this.adBlockerNative=i}on(){return d.PopupEventsOut.SET_AD_BLOCKER_CONSENT}handle(e){return a(this,void 0,void 0,(function*(){e.data?(this.adBlockerNative.activateAdBlocker(),yield Promise.all([this.urbanStorage.agreeAdBlockerPolicy(),this.adBlocker.enableDataCollection()])):yield Promise.all([this.urbanStorage.rejectAdBlockerPolicy(),this.adBlocker.disableAdBlocking(),this.adBlocker.disableDataCollection()]),yield this.processor.updateState(f.PopupProcess.AD_BLOCKER_CONSENT)}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(c.UrbanTypes.URBAN_POLICIES_STORAGE)),o(1,(0,s.inject)(c.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(2,(0,s.inject)(c.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(3,(0,s.inject)(p.AdBlockerTypes.AD_BLOCKER_SERVICE)),r("design:paramtypes",[h.PoliciesStorage,u.AdBlockerService,l.PopupProcessService,_.AdBlockerService])],E),t.AdBlockerConsentListener=E},58143:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerDisableListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(83088),d=n(89273),h=n(81505),f=n(99841),p=n(45103),_=n(48929),E=n(89816),y=n(17418);let v=class{constructor(e,t,n,i,r){this.adBlocker=e,this.analytics=t,this.currentUser=n,this.logger=i,this.popup=r}on(){return u.PopupEventsOut.AD_BLOCKER_DISABLE}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackAdBlockerOff(),this.currentUser.hasDisabledDataCollectionFeature()&&(yield this.adBlocker.disableDataCollection()),yield this.adBlocker.disableAdBlocking(),this.popup.updateState(_.PopupProcess.DISABLE_AD_BLOCKER).then()}))}};v=i([(0,s.injectable)(),o(0,(0,s.inject)(l.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(1,(0,s.inject)(y.AnalyticsModuleTypes.ANALYTICS)),o(2,(0,s.inject)(f.AUTH_MODULE_TYPES.CURRENT_USER)),o(3,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(4,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[h.AdBlockerService,E.Analytics,p.CurrentUser,Object,d.PopupProcessService])],v),t.AdBlockerDisableListener=v},4761:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerEnableListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(83088),d=n(89273),h=n(81505),f=n(48929),p=n(17418),_=n(89816);let E=class{constructor(e,t,n,i){this.adBlocker=e,this.analytics=t,this.logger=n,this.update=i}on(){return u.PopupEventsOut.AD_BLOCKER_ENABLE}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackAdBlockerOn(),yield this.adBlocker.activateService(),yield this.adBlocker.enableAdBlocking(),this.update.updateState(f.PopupProcess.ENABLE_AD_BLOCKER).then()}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(l.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(1,(0,s.inject)(p.AnalyticsModuleTypes.ANALYTICS)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[h.AdBlockerService,_.Analytics,Object,d.PopupProcessService])],E),t.AdBlockerEnableListener=E},77799:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IsAdBlockerConsentAgreedListener=void 0;const s=n(86700),c=n(18313),u=n(83088),l=n(1103),d=n(23961),h=n(16437),f=n(25886);let p=class{constructor(e,t){this.urbanStorage=e,this.port=t}on(){return h.PopupEventsOut.IS_AD_BLOCKER_CONSENT_AGREED}handle(){return a(this,void 0,void 0,(function*(){const e=yield this.urbanStorage.isAdBlockerAgreed(),t=new c.MarioEvent(f.PopupEventsIn.IS_AD_BLOCKER_CONSENT_AGREED_RESPONSE,e);return this.port.emit(t)}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanTypes.URBAN_POLICIES_STORAGE)),o(1,(0,s.inject)(c.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[l.PoliciesStorage,d.PortDispatcher])],p),t.IsAdBlockerConsentAgreedListener=p},8781:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IsGAEnabledEventListener=void 0;const s=n(86700),c=n(55402),u=n(18313),l=n(23961),d=n(43213),h=n(66044);let f=class{constructor(e,t){this.ga=e,this.port=t}on(){return h.AnalyticsModuleEvents.IS_GA_ENABLED_EVENT}handle(){return a(this,void 0,void 0,(function*(){const e=new u.MarioEvent(h.AnalyticsModuleOutEvents.IS_GA_ENABLED_RESPONSE_EVENT,this.ga.isEnabled());return this.port.emit(e)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.GAModuleTypes.GA_ANALYTICS)),o(1,(0,s.inject)(u.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[d.GAAnalytics,l.PortDispatcher])],f),t.IsGAEnabledEventListener=f},6644:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IsUAEnabledEventListener=void 0;const s=n(86700),c=n(47198),u=n(18313),l=n(23961),d=n(18046),h=n(66044);let f=class{constructor(e,t){this.ua=e,this.port=t}on(){return h.AnalyticsModuleEvents.IS_UA_ENABLED_EVENT}handle(){return a(this,void 0,void 0,(function*(){const e=new u.MarioEvent(h.AnalyticsModuleOutEvents.IS_UA_ENABLED_RESPONSE_EVENT,this.ua.isEnabled());return this.port.emit(e)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.UAModuleTypes.UA_ANALYTICS)),o(1,(0,s.inject)(u.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[d.UAAnalytics,l.PortDispatcher])],f),t.IsUAEnabledEventListener=f},45318:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SetGAStateEventListener=void 0;const s=n(86700),c=n(55402),u=n(43213),l=n(66044),d=n(83088),h=n(1103);let f=class{constructor(e,t){this.ga=e,this.policiesStorage=t}on(){return l.AnalyticsModuleEvents.SET_GA_STATE_EVENT}handle(e){return a(this,void 0,void 0,(function*(){e.data.isEnabled?yield Promise.all([this.ga.enable(),this.policiesStorage.agreeGAPolicy()]):yield Promise.all([this.ga.disable(),this.policiesStorage.rejectGAPolicy()])}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.GAModuleTypes.GA_ANALYTICS)),o(1,(0,s.inject)(d.UrbanTypes.URBAN_POLICIES_STORAGE)),r("design:paramtypes",[u.GAAnalytics,h.PoliciesStorage])],f),t.SetGAStateEventListener=f},57569:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SetUAStateEventListener=void 0;const s=n(86700),c=n(47198),u=n(18046),l=n(66044),d=n(83088),h=n(1103);let f=class{constructor(e,t){this.ua=e,this.policiesStorage=t}on(){return l.AnalyticsModuleEvents.SET_UA_STATE_EVENT}handle(e){return a(this,void 0,void 0,(function*(){e.data.isEnabled?yield Promise.all([this.ua.enable(),this.policiesStorage.agreeUAPolicy()]):yield Promise.all([this.ua.disable(),this.policiesStorage.rejectUAPolicy()])}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.UAModuleTypes.UA_ANALYTICS)),o(1,(0,s.inject)(d.UrbanTypes.URBAN_POLICIES_STORAGE)),r("design:paramtypes",[u.UAAnalytics,h.PoliciesStorage])],f),t.SetUAStateEventListener=f},72485:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AntiMaleWareConsentListener=void 0;const s=n(86700),c=n(83088),u=n(1103),l=n(42543),d=n(63654),h=n(56906),f=n(89273),p=n(48929),_=n(16437);let E=class{constructor(e,t,n,i){this.urbanStorage=e,this.safeCheckStateService=t,this.libStateService=n,this.processor=i}on(){return _.PopupEventsOut.SET_ANTI_MALE_WARE_CONSENT}handle(e){return a(this,void 0,void 0,(function*(){e.data?(this.safeCheckStateService.setMode(l.MODE.FULL_NAVIGATION),yield Promise.all([this.urbanStorage.agreeAntiMiningPolicy(),this.libStateService.enable()])):yield Promise.all([this.urbanStorage.rejectAntiMiningPolicy(),this.libStateService.disable(),this.safeCheckStateService.disableNotification()]),yield this.processor.updateState(p.PopupProcess.ANTI_MALE_WARE_CONSENT)}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(c.UrbanTypes.URBAN_POLICIES_STORAGE)),o(1,(0,s.inject)(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(2,(0,s.inject)(l.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE)),o(3,(0,s.inject)(c.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[u.PoliciesStorage,d.StateService,h.LibStateService,f.PopupProcessService])],E),t.AntiMaleWareConsentListener=E},71754:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AntiMaleWareDisableListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(42543),d=n(63654),h=n(99841),f=n(45103),p=n(89273),_=n(83088),E=n(48929),y=n(89816),v=n(17418);let g=class{constructor(e,t,n,i,r,o){this.analytics=e,this.currentUser=t,this.logger=n,this.safeCheckStateService=i,this.libStateService=r,this.popup=o}on(){return u.PopupEventsOut.ANTI_MALE_WARE_DISABLE}handle(e){return a(this,void 0,void 0,(function*(){this.logger.log("Anti Male Ware Disable"),this.analytics.trackAntiMaleWareOff(),yield this.safeCheckStateService.disableNotification(),this.currentUser.hasDisabledDataCollectionFeature()&&(yield this.libStateService.disable()),this.popup.updateState(E.PopupProcess.DISABLE_ANTI_MALE_WARE).then()}))}};g=i([(0,s.injectable)(),o(0,(0,s.inject)(v.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(h.AUTH_MODULE_TYPES.CURRENT_USER)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(4,(0,s.inject)(l.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE)),o(5,(0,s.inject)(_.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[y.Analytics,f.CurrentUser,Object,d.StateService,d.StateService,p.PopupProcessService])],g),t.AntiMaleWareDisableListener=g},36050:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AntiMaleWareEnableListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(83088),d=n(89273),h=n(42543),f=n(63654),p=n(99841),_=n(45103),E=n(48929),y=n(17418),v=n(89816);let g=class{constructor(e,t,n,i,r,o){this.analytics=e,this.currentUser=t,this.logger=n,this.popup=i,this.safeCheckStateService=r,this.libStateService=o}on(){return u.PopupEventsOut.ANTI_MALE_WARE_ENABLE}handle(e){return a(this,void 0,void 0,(function*(){this.analytics.trackAntiMaleWareOn(),yield this.libStateService.enable(),yield this.safeCheckStateService.enableNotification(),this.popup.updateState(E.PopupProcess.ENABLE_ANTI_MALE_WARE).then()}))}};g=i([(0,s.injectable)(),o(0,(0,s.inject)(y.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(p.AUTH_MODULE_TYPES.CURRENT_USER)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(4,(0,s.inject)(h.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(5,(0,s.inject)(h.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE)),r("design:paramtypes",[v.Analytics,_.CurrentUser,Object,d.PopupProcessService,f.StateService,f.StateService])],g),t.AntiMaleWareEnableListener=g},60191:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IsAntiMaleWareConsentAgreedListener=void 0;const s=n(86700),c=n(18313),u=n(83088),l=n(1103),d=n(23961),h=n(25886),f=n(16437);let p=class{constructor(e,t){this.urbanStorage=e,this.port=t}on(){return f.PopupEventsOut.IS_ANTI_MALE_WARE_CONSENT_AGREED}handle(){return a(this,void 0,void 0,(function*(){const e=yield this.urbanStorage.isAntiMiningAgreed(),t=new c.MarioEvent(h.PopupEventsIn.IS_ANTI_MALE_WARE_CONSENT_AGREED_RESPONSE,e);return this.port.emit(t)}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(u.UrbanTypes.URBAN_POLICIES_STORAGE)),o(1,(0,s.inject)(c.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[l.PoliciesStorage,d.PortDispatcher])],p),t.IsAntiMaleWareConsentAgreedListener=p},98979:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoginListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(2975),d=n(99841),h=n(83088),f=n(89273),p=n(48929);let _=class{constructor(e,t,n){this.logger=e,this.authService=t,this.process=n}on(){return u.PopupEventsOut.LOGIN}handle(e){return a(this,void 0,void 0,(function*(){this.process.start(p.PopupProcess.LOGIN);const{identity:t,password:n}=e.data,i=yield this.authService.login(t,n);i.ok||this.process.finishWithError(i.message,i.status)}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(d.AUTH_MODULE_TYPES.AUTH_SERVICE)),o(2,(0,s.inject)(h.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[Object,l.AuthService,f.PopupProcessService])],_),t.LoginListener=_},58026:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LogoutListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(2975),d=n(99841),h=n(83088),f=n(89273),p=n(48929);let _=class{constructor(e,t,n){this.authService=e,this.logger=t,this.process=n}on(){return u.PopupEventsOut.LOGOUT}handle(e){return a(this,void 0,void 0,(function*(){this.process.start(p.PopupProcess.LOGOUT),this.authService.logout().then()}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(d.AUTH_MODULE_TYPES.AUTH_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(h.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[l.AuthService,Object,f.PopupProcessService])],_),t.LogoutListener=_},498:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RestorePasswordListener=void 0;const s=n(86700),c=n(16437),u=n(81630),l=n(7009),d=n(18313),h=n(81223),f=n(83088);let p=class{constructor(e,t,n){this.accountService=e,this.logger=t,this.emitter=n}on(){return c.PopupEventsOut.RESTORE_PASSWORD}handle(e){return a(this,void 0,void 0,(function*(){const{identity:t}=e.data;this.logger.log("Popup: Restore password");try{yield this.accountService.restorePassword(t);this.emitter.sendRestorePassword({ok:!0,onRequest:c.PopupEventsOut.RESTORE_PASSWORD})}catch(e){this.emitter.sendRestorePassword({ok:!1,message:"Email does not exist",onRequest:c.PopupEventsOut.RESTORE_PASSWORD})}}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(l.ACCOUNT_MODULE_TYPES.ACCOUNT_SERVICE)),o(1,(0,s.inject)(d.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(f.UrbanTypes.URBAN_POPUP_ACCOUNT_EMITTER)),r("design:paramtypes",[u.AccountService,Object,h.PopupAccountEmitter])],p),t.RestorePasswordListener=p},759:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CounterIncreaseListener=void 0;const s=n(16437),c=n(86700),u=n(81413),l=n(26012);let d=class{constructor(e){this.counter=e}on(){return s.PopupEventsOut.COUNTER_INCREASE}handle(e){return a(this,void 0,void 0,(function*(){const{counter:t}=e.data;this.counter.increase(t).then()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(l.CounterModuleTypes.COUNTER_SERVICE)),r("design:paramtypes",[u.CounterService])],d),t.CounterIncreaseListener=d},22347:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataSharingAgreedListener=void 0;const s=n(86700),c=n(84160),u=n(92750),l=n(16437);let d=class{constructor(e){this.dataSharingManager=e}on(){return l.PopupEventsOut.DATA_SHARING_AGREED}handle(){return a(this,void 0,void 0,(function*(){yield this.dataSharingManager.agree()}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(u.DataSharingModuleTypes.DATA_SHARING_MANAGER)),r("design:paramtypes",[c.DataSharingManager])],d),t.DataSharingAgreedListener=d},38112:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataSharingRejectedListener=void 0;const s=n(86700),c=n(84160),u=n(92750),l=n(16437);let d=class{constructor(e){this.dataSharingManager=e}on(){return l.PopupEventsOut.DATA_SHARING_REJECTED}handle(){return a(this,void 0,void 0,(function*(){yield this.dataSharingManager.reject()}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(u.DataSharingModuleTypes.DATA_SHARING_MANAGER)),r("design:paramtypes",[c.DataSharingManager])],d),t.DataSharingRejectedListener=d},74678:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IsDataSharingEnabledEventListener=void 0;const s=n(86700),c=n(18313),u=n(23961),l=n(92750),d=n(84160),h=n(16437),f=n(25886);let p=class{constructor(e,t){this.dataSharingManager=e,this.port=t}on(){return h.PopupEventsOut.IS_DATA_SHARING_ENABLED}handle(){return a(this,void 0,void 0,(function*(){const e=new c.MarioEvent(f.PopupEventsIn.IS_DATA_SHARING_ENABLED_RESPONSE,yield this.dataSharingManager.is(d.DataSharingState.AGREE));return this.port.emit(e)}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(l.DataSharingModuleTypes.DATA_SHARING_MANAGER)),o(1,(0,s.inject)(c.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[d.DataSharingManager,u.PortDispatcher])],p),t.IsDataSharingEnabledEventListener=p},27085:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ActivateFlagListener=void 0;const s=n(16437),c=n(86700),u=n(20466),l=n(23682);let d=class{constructor(e){this.flagService=e}on(){return s.PopupEventsOut.ACTIVATE_FLAG}handle(e){return a(this,void 0,void 0,(function*(){const{flag:t}=e.data;this.flagService.activate(t).then()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(l.FlagModuleTypes.FLAG_SERVICE)),r("design:paramtypes",[u.FlagService])],d),t.ActivateFlagListener=d},22510:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DeactivateFlagListener=void 0;const s=n(16437),c=n(86700),u=n(20466),l=n(23682);let d=class{constructor(e){this.flagService=e}on(){return s.PopupEventsOut.DEACTIVATE_FLAG}handle(e){return a(this,void 0,void 0,(function*(){const{flag:t}=e.data;this.flagService.deactivate(t).then()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(l.FlagModuleTypes.FLAG_SERVICE)),r("design:paramtypes",[u.FlagService])],d),t.DeactivateFlagListener=d},34723:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ActivateLocationListener=void 0;const s=n(86700),c=n(18313),u=n(82325),l=n(16437),d=n(83088),h=n(89273),f=n(98948),p=n(93520),_=n(48929),E=n(18083),y=n(75357),v=n(38107);let g=class{constructor(e,t,n,i,r,o){this.appState=e,this.logger=t,this.popup=n,this.locationService=i,this.dispatcher=r,this.tokenManager=o}on(){return l.PopupEventsOut.ACTIVATE_LOCATION}handle(e){return a(this,void 0,void 0,(function*(){if(this.appState.isProxyConnected()&&(yield this.locationService.deactivate()),this.appState.isNotDirectMode()){const e="ActivateLocationListener: a location cannot be activated because the app is not in direct mode";return void this.logger.warn(e)}this.appState.setStateProxyConnecting();const{provider:t,code:n,name:i}=e.data;try{yield this.locationService.activate(t,n),this.appState.setStateProxyConnected();const e=`Connected to ${i}`;this.popup.updateState(_.PopupProcess.ACTIVATE_LOCATION,e).then()}catch(e){this.trackAnalytics(i,n,e.message),this.appState.setStateDirectMode(),this.popup.updateState(_.PopupProcess.ACTIVATE_LOCATION,"Connection error",!1).then()}}))}trackAnalytics(e,t,n){const i=this.tokenManager.lastProxy,r={eventId:E.EventList.LOCATION_STARTED,manual:!0,details:{SOURCE:E.SourceList.SYSTEM,CONNECTION_RESULT:E.LocationStartedResult.fail,CONNECTION_TYPE:E.LocationStartedType.first,HOST:i?(0,y.makeHost)(i):n,COUNTRY:e,CODE:t}},o=new c.MarioEvent(l.PopupEventsOut.TRACK_ACTION,r);this.dispatcher.emit(o)}};g=i([(0,s.injectable)(),o(0,(0,s.inject)(d.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(d.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(3,(0,s.inject)(u.LocationModuleTypes.LOCATION_SERVICE)),o(4,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(5,(0,s.inject)(u.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[p.AppService,Object,h.PopupProcessService,f.LocationService,Object,v.ProxyAuthTokenManager])],g),t.ActivateLocationListener=g},71109:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DeactivateLocationListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(83088),d=n(89273),h=n(82325),f=n(98948),p=n(93520),_=n(48929);let E=class{constructor(e,t,n,i){this.appState=e,this.logger=t,this.popup=n,this.locationService=i}on(){return u.PopupEventsOut.DEACTIVATE_LOCATION}handle(e){return a(this,void 0,void 0,(function*(){this.appState.setStateProxyDisconnecting(),yield this.locationService.deactivate(),this.appState.setStateDirectMode(),this.popup.updateState(_.PopupProcess.DEACTIVATE_LOCATION,"Proxy is disconnected").then()}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(l.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(3,(0,s.inject)(h.LocationModuleTypes.LOCATION_SERVICE)),r("design:paramtypes",[p.AppService,Object,d.PopupProcessService,f.LocationService])],E),t.DeactivateLocationListener=E},29392:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PageHistoryVisitListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(55309),d=n(83088);let h=class{constructor(e,t){this.logger=e,this.history=t}on(){return u.PopupEventsOut.PAGE_HISTORY_VISIT}handle(e){return a(this,void 0,void 0,(function*(){const{page:t}=e.data;yield this.history.visit(t)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(d.UrbanTypes.URBAN_PAGE_HISTORY_SERVICE)),r("design:paramtypes",[Object,l.PageHistoryService])],h),t.PageHistoryVisitListener=h},95813:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyAgreedListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(46149),d=n(49798),h=n(89273),f=n(83088),p=n(48929),_=n(89816),E=n(17418);let y=class{constructor(e,t,n,i){this.analytics=e,this.logger=t,this.policyService=n,this.popup=i}on(){return u.PopupEventsOut.POLICY_AGREED}handle(e){return a(this,void 0,void 0,(function*(){yield this.policyService.agree(),this.popup.updateState(p.PopupProcess.POLICY_AGREED).then()}))}};y=i([(0,s.injectable)(),o(0,(0,s.inject)(E.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(d.PolicyModuleTypes.POLICY_SERVICE)),o(3,(0,s.inject)(f.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),r("design:paramtypes",[_.Analytics,Object,l.PolicyService,h.PopupProcessService])],y),t.PolicyAgreedListener=y},63929:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyRejectedListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(46149),d=n(49798),h=n(83088),f=n(89273),p=n(48929),_=n(17418),E=n(89816),y=n(18083),v=n(28059),g=n(60175),S=n(89860);let T=class{constructor(e,t,n,i,r,o){this.analytics=e,this.logger=t,this.policyService=n,this.popup=i,this.ga=r,this.gStorage=o}on(){return u.PopupEventsOut.POLICY_REJECTED}handle(e){return a(this,void 0,void 0,(function*(){this.ga.setHoldLastEvents(0),yield this.gStorage.clean(),yield this.policyService.reject(),this.analytics.trackPolicyDecision(y.PolicyDecision.REJECTED),this.popup.updateState(p.PopupProcess.POLICY_REJECTED).then()}))}};T=i([(0,s.injectable)(),o(0,(0,s.inject)(_.AnalyticsModuleTypes.ANALYTICS)),o(1,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(d.PolicyModuleTypes.POLICY_SERVICE)),o(3,(0,s.inject)(h.UrbanTypes.URBAN_POPUP_PROCESS_SERVICE)),o(4,(0,s.inject)(g.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)),o(5,(0,s.inject)(g.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_STORAGE)),r("design:paramtypes",[E.Analytics,Object,l.PolicyService,f.PopupProcessService,v.GoogleAnalyticsService,S.GoogleAnalyticsStorage])],T),t.PolicyRejectedListener=T},76251:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SendTicketListener=void 0;const s=n(86700),c=n(18313),u=n(16437),l=n(92949),d=n(7009),h=n(83088),f=n(37240),p=n(25886);let _=class{constructor(e,t,n){this.logger=e,this.support=t,this.emitter=n}on(){return u.PopupEventsOut.SEND_TICKET}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data;try{yield this.support.sendTicket(t.subject,t.message),this.emitter.send(p.PopupEventsIn.SEND_TICKET_RESPONSE,{ok:!0,onRequest:u.PopupEventsOut.SEND_TICKET,message:"Email sent. Thank you for contacting us"})}catch(e){this.emitter.send(p.PopupEventsIn.SEND_TICKET_RESPONSE,{ok:!1,onRequest:u.PopupEventsOut.SEND_TICKET,message:"Something went wrong. Please try to send your email later."})}}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(d.ACCOUNT_MODULE_TYPES.SUPPORT_SERVICE)),o(2,(0,s.inject)(h.UrbanTypes.URBAN_POPUP_EMITTER)),r("design:paramtypes",[Object,l.SupportService,f.PopupEmitter])],_),t.SendTicketListener=_},60632:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateNewTabListener=void 0;const s=n(16437),c=n(86700),u=n(18313);let l=class{constructor(e){this.tabService=e}on(){return s.PopupEventsOut.CREATE_TAB}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data;this.tabService.create(t)}))}};l=i([(0,c.injectable)(),o(0,(0,c.inject)(u.MARIO_TYPES.TAB_SERVICE)),r("design:paramtypes",[Object])],l),t.CreateNewTabListener=l},81223:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupAccountEmitter=void 0;const a=n(86700),s=n(83088),c=n(37240),u=n(25886);let l=class{constructor(e){this.emitter=e}sendAccount(e){this.emitter.send(u.PopupEventsIn.ACCOUNT_RESPONSE,e)}sendRestorePassword(e){this.emitter.send(u.PopupEventsIn.RESTORE_PASSWORD_RESPONSE,e)}};l=i([(0,a.injectable)(),o(0,(0,a.inject)(s.UrbanTypes.URBAN_POPUP_EMITTER)),r("design:paramtypes",[c.PopupEmitter])],l),t.PopupAccountEmitter=l},37240:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupEmitter=void 0;const a=n(18313),s=n(8514),c=n(86700),u=n(23961),l=n(43425);let d=class{constructor(e,t){this.portDispatcher=e,this.internalDispatcher=t}send(e,t){if(this.portDispatcher.hasPort(s.PortList.POPUP)){const n=new a.MarioEvent(e,t);setTimeout((()=>this.portDispatcher.emit(n,s.PortList.POPUP)),0)}else{const e=new a.MarioEvent(l.UrbanInnerEvents.COULD_NOT_DELIVERY_RESPONSE_TO_POPUP,t);this.internalDispatcher.emit(e).then()}}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(a.MARIO_TYPES.PORT_DISPATCHER)),o(1,(0,c.inject)(a.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[u.PortDispatcher,Object])],d),t.PopupEmitter=d},22534:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupStateFields=void 0,function(e){e.appState="appState",e.activationTime="activationTime",e.adsOnPage="adsOnPage",e.adsTotal="adsTotal",e.continueAsFreeClickedCounter="continueAsFreeClickedCounter",e.mainPageCounter="mainPageCounter",e.path="path",e.location="location",e.locations="locations",e.preloginPageOption="preloginPageOption",e.promotionElements="promotionElements",e.interruptingExtensions="interruptingExtensions",e.isInit="isInit",e.isForceLoginMode="isForceLoginMode",e.isAuthenticated="isAuthenticated",e.isInterrupted="isInterrupted",e.isOtherExtensionsInterruptable="isOtherExtensionsInterruptable",e.isVeteran="isVeteran",e.isVeteranPageVisited="isVeteranPageVisited",e.isRateUsPageVisited="isRateUsPageVisited",e.isOfferPageVisited="isOfferPageVisited",e.isPreloginPageVisited="isPreloginPageVisited",e.isEnabledAdBlocker="isEnabledAdBlocker",e.isEnabledAntiMalware="isEnabledAntiMalware",e.isAdBlockerPolicyAgreed="isAdBlockerPolicyAgreed",e.isAntiMaleWarePolicyAgreed="isAntiMaleWarePolicyAgreed",e.isPolicyAgreed="isPolicyAgreed",e.isCountryRestricted="isCountryRestricted",e.restrictedCountryName="restrictedCountryName",e.identityId="identityId",e.hasPolicyAnswer="hasPolicyAnswer",e.nonPersonalDataCollection="nonPersonalDataCollection",e.email="email",e.gifts="gifts",e.dataSharing="dataSharing"}(t.PopupStateFields||(t.PopupStateFields={}))},81505:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdBlockerService=void 0;const s=n(86700),c=n(83379),u=n(35177),l=n(11149),d=n(6008);let h=class{constructor(e){this.adBlocker=e}activateService(){this.adBlocker.activateAdBlocker()}deactivateService(){this.adBlocker.deactivateAdBloker()}enableDataCollection(){return a(this,void 0,void 0,(function*(){yield this.adBlocker.enableDataCollection()}))}disableDataCollection(){return a(this,void 0,void 0,(function*(){yield this.adBlocker.disableDataCollection()}))}enableAdBlocking(){return a(this,void 0,void 0,(function*(){yield this.adBlocker.enableDisplayAdBlocker(),yield this.adBlocker.enableTwitterAdBlocker(),yield this.adBlocker.enableFacebookAdBlocker(),yield this.adBlocker.enableAdBlocker([l.AdType.REDDIT])}))}disableAdBlocking(){return a(this,void 0,void 0,(function*(){yield this.adBlocker.disableDisplayAdBlocker(),yield this.adBlocker.disableTwitterAdBlocker(),yield this.adBlocker.disableFacebookAdBlocker(),yield this.adBlocker.disableAdBlocker([l.AdType.REDDIT])}))}isAdBlockingEnabled(){return a(this,void 0,void 0,(function*(){return(yield this.adBlocker.isDisplayAdBlockerEnabled())||(yield this.adBlocker.isFacebookAdBlockerEnabled())||(yield this.adBlocker.isTwitterAdBlockerEnabled())||(yield this.isRedditAdBlockerEnabled())}))}isRedditAdBlockerEnabled(){return a(this,void 0,void 0,(function*(){return(yield this.adBlocker.getAdBlockerStatus()).REDDIT===d.AdStatus.ENABLED}))}isAdBlockingDisabled(){return a(this,void 0,void 0,(function*(){return!(yield this.isAdBlockingEnabled())}))}updateConfig(){this.adBlocker.updateConfig()}getAdBlockerCountersForActiveTab(){return a(this,void 0,void 0,(function*(){return this.adBlocker.getAdBlockerCountersForActiveTab()}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.AdBlockerTypes.AD_BLOCKER_SERVICE)),r("design:paramtypes",[u.AdBlockerService])],h),t.AdBlockerService=h},93520:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.AppService=void 0;const r=n(86700),o=n(30593);let a=class{setState(e){this.state=e}getState(){return this.state}setStateProxyConnecting(){this.setState(o.AppState.PROXY_CONNECTING)}setStateProxyConnected(){this.setState(o.AppState.PROXY_CONNECTED)}setStateProxyDisconnecting(){this.setState(o.AppState.PROXY_DISCONNECTING)}setStateProxyRepairing(){this.setState(o.AppState.PROXY_REPAIRING)}setStateDirectMode(){this.setState(o.AppState.DIRECT_MODE)}setStateRefreshingToken(){this.setState(o.AppState.REFRESHING_TOKEN)}isState(e){return e===this.state}isDirectMode(){return this.isState(o.AppState.DIRECT_MODE)}isNotDirectMode(){return!this.isDirectMode()}isProxyConnected(){return this.isState(o.AppState.PROXY_CONNECTED)}isProxyRepairing(){return this.isState(o.AppState.PROXY_REPAIRING)}};a=i([(0,r.injectable)()],a),t.AppService=a},30593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppState=void 0,function(e){e.DIRECT_MODE="DIRECT_MODE",e.PROXY_DISCONNECTING="PROXY_DISCONNECTING",e.PROXY_CONNECTING="PROXY_CONNECTING",e.PROXY_CONNECTED="PROXY_CONNECTED",e.PROXY_REPAIRING="PROXY_REPAIRING",e.REFRESHING_TOKEN="REFRESHING_TOKEN"}(t.AppState||(t.AppState={}))},54895:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanBugsnagService=void 0;const s=n(86700),c=n(6601),u=n(529),l=n(99841),d=n(45103),h=n(96795),f=n(9930);let p=class{constructor(e,t,n){this.bugsnag=e,this.currentUser=t,this.identity=n}premiumUser(){return a(this,void 0,void 0,(function*(){yield this.bugsnag.updateUser({id:this.identity.getIdentityId(),email:this.currentUser.getSecurityToken().owner.email})}))}anonymousUser(){return a(this,void 0,void 0,(function*(){yield this.bugsnag.updateUser({id:this.identity.getIdentityId()})}))}restoreSession(){return a(this,void 0,void 0,(function*(){this.currentUser.isPremiumUser()?yield this.premiumUser():yield this.anonymousUser()}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(c.BugsnagTypes.BUGSNAG_SERVICE)),o(1,(0,s.inject)(l.AUTH_MODULE_TYPES.CURRENT_USER)),o(2,(0,s.inject)(h.IdentityTypes.IDENTITY_SERVICE)),r("design:paramtypes",[u.BugsnagService,d.CurrentUser,f.IdentityService])],p),t.UrbanBugsnagService=p},81338:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataCollectionService=void 0;const s=n(86700),c=n(99841),u=n(45103),l=n(42543),d=n(63654),h=n(56906),f=n(81505),p=n(83088);let _=class{constructor(e,t,n,i){this.adBlocker=e,this.currentUser=t,this.safeCheckStateService=n,this.libStateService=i}disableDataCollection(){this.adBlocker.disableDataCollection(),this.safeCheckStateService.setMode(l.MODE.NO_NAVIGATION)}enableDataCollection(){return a(this,void 0,void 0,(function*(){yield this.adBlocker.enableDataCollection(),yield this.adBlocker.activateService(),this.safeCheckStateService.setMode(l.MODE.FULL_NAVIGATION),yield this.libStateService.enable()}))}restoreSession(){this.currentUser.hasDisabledDataCollectionFeature()&&this.disableDataCollection()}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(p.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(1,(0,s.inject)(c.AUTH_MODULE_TYPES.CURRENT_USER)),o(2,(0,s.inject)(l.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(3,(0,s.inject)(l.UrlsSafeCheckTypes.USC_LIB_STATE_SERVICE)),r("design:paramtypes",[f.AdBlockerService,u.CurrentUser,d.StateService,h.LibStateService])],_),t.DataCollectionService=_},17316:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateTimeShifter=void 0;t.DateTimeShifter=class{static shift(e,t,n=59){const i=e-t;return Math.abs(i)/1e3>n?i:0}}},90986:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InterruptionService=void 0;const s=n(86700),c=n(18313);let u=class{constructor(e){this.managementService=e,this.excludeList=["ngpampappnmepgilojfohadhhmbhlaek"]}isExtensionInterrupted(){return a(this,void 0,void 0,(function*(){return(yield this.getExtensionsThatCauseInterruptions()).length>0}))}disableExtensionsThatCauseInterruptions(){return a(this,void 0,void 0,(function*(){const e=yield this.getExtensionsThatCauseInterruptions();return e.forEach((e=>this.managementService.setEnabled(e.id,!1))),e.length}))}getExtensionsThatCauseInterruptions(){return a(this,void 0,void 0,(function*(){return(yield this.managementService.getAll()).filter((e=>this.isNoMe(e.id)&&this.isNotExcludedExtension(e.id)&&e.enabled&&e.permissions.includes("proxy")))}))}isExcludedExtension(e){return this.excludeList.includes(e)}isNotExcludedExtension(e){return!this.isExcludedExtension(e)}isItMe(e){return e===chrome.runtime.id}isNoMe(e){return!this.isItMe(e)}};u=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.MANAGEMENT)),r("design:paramtypes",[Object])],u),t.InterruptionService=u},55309:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PageHistoryService=void 0;const s=n(86700),c=n(18313);let u=class{constructor(e){this.storageService=e}visit(e){return a(this,void 0,void 0,(function*(){return this.storageService.set("PAGE_"+e,"VISITED")}))}visited(e){return a(this,void 0,void 0,(function*(){return this.storageService.has("PAGE_"+e)}))}};u=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.PageHistoryService=u},89273:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupProcessService=void 0;const s=n(86700),c=n(18313),u=n(37240),l=n(83088),d=n(40093),h=n(48929);let f=class{constructor(e,t,n){this.logger=e,this.emitter=t,this.stateService=n}start(e){this.logger.log(`PopupProcessService: start "${e}"`),this.process=e}isStarted(e){return this.process===e}isProcessing(){return!!this.process}updateState(e,t,n=!0,i){return a(this,void 0,void 0,(function*(){const r=h.ProcessingStates[e];try{const i=yield this.stateService.getCurrentState(r.fields),o={ok:n,content:i,message:t,onRequest:e};this.emitter.send(r.responseEvent,o)}catch(t){const n={ok:!1,message:t.message,errType:i,onRequest:e};this.emitter.send(r.responseEvent,n)}}))}finish(e){return a(this,void 0,void 0,(function*(){this.logger.log(`PopupProcessService: finish "${this.process}"`);const t=this.getHandlerState();try{const n={ok:!0,content:yield this.stateService.getCurrentState(t.fields),message:e,onRequest:this.process};this.emitter.send(t.responseEvent,n),this.process=null}catch(e){this.finishWithError(e.message)}}))}finishWithError(e,t){const n=this.getHandlerState(),i={ok:!1,message:e,errType:t,onRequest:this.process};this.emitter.send(n.responseEvent,i),this.process=null}getHandlerState(){return h.ProcessingStates[this.process]}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_EMITTER)),o(2,(0,s.inject)(l.UrbanTypes.URBAN_POPUP_STATE_SERVICE)),r("design:paramtypes",[Object,u.PopupEmitter,d.PopupStateService])],f),t.PopupProcessService=f},40093:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PopupStateService=void 0;const s=n(86700),c=n(2364),u=n(96233),l=n(370),d=n(82325),h=n(98948),f=n(99841),p=n(45103),_=n(18313),E=n(62854),y=n(83088),v=n(90986),g=n(55309),S=n(49798),T=n(46149),O=n(81505),m=n(42543),A=n(63654),R=n(22534),P=n(76133),I=n(26012),N=n(81413),b=n(18364),C=n(23682),L=n(20466),M=n(8291),w=n(9930),D=n(96795),j=n(72032),U=n(93520),x=n(53511),G=n(15604),k=n(80150),B=n(93158),V=n(8622),F=n(97036),Y=n(84160),H=n(92750),W=n(1103),K=n(72030),q=n(51407);let X=class{constructor(e,t,n,i,r,o,a,s,c,u,l,d,h,f,p,_,E,y,v,g,S){this.appState=e,this.adBlocker=t,this.browser=n,this.counter=i,this.currentUser=r,this.logger=o,this.locationService=a,this.promotionService=s,this.interruptionService=c,this.pageHistoryService=u,this.policyService=l,this.safeCheckStateService=d,this.restrictionService=h,this.storageService=f,this.veteranPackageId=p,this.flagService=_,this.identity=E,this.giftStorage=y,this.dataSharing=v,this.nonPersonalDataCollection=g,this.urbanStorage=S}getCurrentState(e=[]){return a(this,void 0,void 0,(function*(){const t={[R.PopupStateFields.appState]:()=>a(this,void 0,void 0,(function*(){return this.appState.getState()})),[R.PopupStateFields.activationTime]:()=>a(this,void 0,void 0,(function*(){return this.locationService.getActivationTime()})),[R.PopupStateFields.adsOnPage]:()=>a(this,void 0,void 0,(function*(){return(yield this.adBlocker.getAdBlockerCountersForActiveTab()).currentPageTotal})),[R.PopupStateFields.adsTotal]:()=>a(this,void 0,void 0,(function*(){return(yield this.adBlocker.getAdBlockerCountersForActiveTab()).currentSessionTotal})),[R.PopupStateFields.continueAsFreeClickedCounter]:()=>a(this,void 0,void 0,(function*(){return this.counter.count(b.Counter.CONTINUE_AS_FREE_CLICKED)})),[R.PopupStateFields.mainPageCounter]:()=>a(this,void 0,void 0,(function*(){return this.counter.count(b.Counter.MAIN_PAGE_OPENED)})),[R.PopupStateFields.location]:()=>a(this,void 0,void 0,(function*(){return this.getActivatedLocation()})),[R.PopupStateFields.locations]:()=>a(this,void 0,void 0,(function*(){try{const e=yield this.locationService.getEarth();return c.LocationUI_Mapper.map(e).sort(((e,t)=>e.provider===x.LocationProvider.AUTO_SERVER?-1:t.provider===x.LocationProvider.AUTO_SERVER?1:e.provider===x.LocationProvider.STREAMING_SERVICE?-1:t.provider===x.LocationProvider.STREAMING_SERVICE||e.isLocked&&!t.isLocked?1:!e.isLocked&&t.isLocked?-1:e.name===t.name?0:e.name>t.name?1:-1))}catch(e){throw this.logger.error(e),new Error("Could not load locations")}})),[R.PopupStateFields.interruptingExtensions]:()=>a(this,void 0,void 0,(function*(){return this.getInterruptingExtensions()})),[R.PopupStateFields.preloginPageOption]:()=>a(this,void 0,void 0,(function*(){return this.getPreloginPageOption()})),[R.PopupStateFields.promotionElements]:()=>a(this,void 0,void 0,(function*(){return this.promotionService.getFooter()})),[R.PopupStateFields.isForceLoginMode]:()=>a(this,void 0,void 0,(function*(){return this.isForceLoginMode()})),[R.PopupStateFields.isInterrupted]:()=>a(this,void 0,void 0,(function*(){return this.isInterrupted()})),[R.PopupStateFields.isOtherExtensionsInterruptable]:()=>a(this,void 0,void 0,(function*(){return this.isOtherExtensionsInterruptable()})),[R.PopupStateFields.isAuthenticated]:()=>a(this,void 0,void 0,(function*(){return this.currentUser.isPremiumUser()})),[R.PopupStateFields.isVeteran]:()=>a(this,void 0,void 0,(function*(){return this.isVeteran()})),[R.PopupStateFields.isVeteranPageVisited]:()=>a(this,void 0,void 0,(function*(){return this.pageHistoryService.visited(l.PATH.VETERAN)})),[R.PopupStateFields.isRateUsPageVisited]:()=>a(this,void 0,void 0,(function*(){return this.pageHistoryService.visited(l.PATH.RATE_US)})),[R.PopupStateFields.isOfferPageVisited]:()=>a(this,void 0,void 0,(function*(){return this.pageHistoryService.visited(l.PATH.OFFER)})),[R.PopupStateFields.isPreloginPageVisited]:()=>a(this,void 0,void 0,(function*(){return this.pageHistoryService.visited(l.PATH.PRELOGIN_PAGE)})),[R.PopupStateFields.isEnabledAdBlocker]:()=>a(this,void 0,void 0,(function*(){return this.adBlocker.isAdBlockingEnabled()})),[R.PopupStateFields.isEnabledAntiMalware]:()=>a(this,void 0,void 0,(function*(){return this.safeCheckStateService.isEnabledNotification()})),[R.PopupStateFields.isInit]:()=>a(this,void 0,void 0,(function*(){return this.isInitMode()})),[R.PopupStateFields.identityId]:()=>a(this,void 0,void 0,(function*(){return this.identity.getIdentityId()})),[R.PopupStateFields.isPolicyAgreed]:()=>a(this,void 0,void 0,(function*(){return this.policyService.isAgreed()})),[R.PopupStateFields.isAdBlockerPolicyAgreed]:()=>a(this,void 0,void 0,(function*(){return this.urbanStorage.isAdBlockerAgreed()})),[R.PopupStateFields.isAntiMaleWarePolicyAgreed]:()=>a(this,void 0,void 0,(function*(){return this.urbanStorage.isAntiMiningAgreed()})),[R.PopupStateFields.hasPolicyAnswer]:()=>a(this,void 0,void 0,(function*(){return this.policyService.hasAnswer()})),[R.PopupStateFields.isCountryRestricted]:()=>a(this,void 0,void 0,(function*(){return this.restrictionService.isRestricted()})),[R.PopupStateFields.restrictedCountryName]:()=>a(this,void 0,void 0,(function*(){return this.restrictionService.getRestrictedCountryName()})),[R.PopupStateFields.email]:()=>a(this,void 0,void 0,(function*(){return this.getEmail()})),[R.PopupStateFields.gifts]:()=>a(this,void 0,void 0,(function*(){return this.getGifts()})),[R.PopupStateFields.dataSharing]:()=>a(this,void 0,void 0,(function*(){return{allow:yield this.dataSharing.is(Y.DataSharingState.AGREE),hasDecision:yield this.dataSharing.hasAnswer()}})),[R.PopupStateFields.nonPersonalDataCollection]:()=>a(this,void 0,void 0,(function*(){return{allow:yield this.nonPersonalDataCollection.is(q.DataCollectionState.AGREE),hasDecision:yield this.nonPersonalDataCollection.hasAnswer()}}))},n={};for(const i of e){const e=t[i];e&&(n[i]=yield e())}return n}))}getActivatedLocation(){return a(this,void 0,void 0,(function*(){const e=yield this.locationService.getLocation();return e.isType(j.LocationType.RANDOM)?this.autoServer():c.LocationUI_Mapper.mapLocation(e)}))}getInterruptingExtensions(){return a(this,void 0,void 0,(function*(){return yield this.interruptionService.getExtensionsThatCauseInterruptions()}))}isInterrupted(){return a(this,void 0,void 0,(function*(){return yield this.interruptionService.isExtensionInterrupted()}))}isOtherExtensionsInterruptable(){return a(this,void 0,void 0,(function*(){return"FIREFOX_BROWSER"===u.BrowserEnum.CHROME_BROWSER||"Firefox"===u.BrowserEnum.EDGE_BROWSER}))}getEmail(){return this.currentUser.isPremiumUser()?this.currentUser.getSecurityToken().owner.email:""}isVeteran(){return this.currentUser.getSecurityToken().package.id===this.veteranPackageId}autoServer(){const e=G.LocationServiceHelpers.generateAutoServerLocation();return c.LocationUI_Mapper.mapLocation(e)}getPreloginPageOption(){return a(this,void 0,void 0,(function*(){const e="PRELOGIN_PAGE_OPTION",t=(yield this.storageService.has(e))?Number(yield this.storageService.get(e)):Math.floor(3*Math.random())+1;return yield this.storageService.set(e,t.toString()),t}))}isForceLoginMode(){return a(this,void 0,void 0,(function*(){return this.flagService.isActivated(M.FlagList.FORCE_LOGIN)}))}isInitMode(){return a(this,void 0,void 0,(function*(){return!(yield this.flagService.has(M.FlagList.INIT))||this.flagService.isActivated(M.FlagList.INIT)}))}getGifts(){return a(this,void 0,void 0,(function*(){return this.giftStorage.getGifts()}))}};X=i([(0,s.injectable)(),o(0,(0,s.inject)(y.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(y.UrbanTypes.URBAN_AD_BLOCKER_SERVICE)),o(2,(0,s.inject)(_.MARIO_TYPES.BROWSER)),o(3,(0,s.inject)(I.CounterModuleTypes.COUNTER_SERVICE)),o(4,(0,s.inject)(f.AUTH_MODULE_TYPES.CURRENT_USER)),o(5,(0,s.inject)(_.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,s.inject)(d.LocationModuleTypes.LOCATION_SERVICE)),o(7,(0,s.inject)(E.URBAN_PROMOTION_MODULE_TYPES.URBAN_PROMOTION_API)),o(8,(0,s.inject)(y.UrbanTypes.URBAN_INTERRUPTION_SERVICE)),o(9,(0,s.inject)(y.UrbanTypes.URBAN_PAGE_HISTORY_SERVICE)),o(10,(0,s.inject)(S.PolicyModuleTypes.POLICY_SERVICE)),o(11,(0,s.inject)(m.UrlsSafeCheckTypes.USC_STATE_SERVICE)),o(12,(0,s.inject)(V.CountryRestrictionModuleTypes.RESTRICTION_SERVICE)),o(13,(0,s.inject)(_.MARIO_TYPES.STORAGE_SERVICE)),o(14,(0,s.inject)(y.UrbanTypes.URBAN_VETERAN_PACKAGE_ID)),o(15,(0,s.inject)(C.FlagModuleTypes.FLAG_SERVICE)),o(16,(0,s.inject)(D.IdentityTypes.IDENTITY_SERVICE)),o(17,(0,s.inject)(B.ExperimentModuleTypes.GIFT_STORAGE)),o(18,(0,s.inject)(H.DataSharingModuleTypes.DATA_SHARING_MANAGER)),o(19,(0,s.inject)(K.NonPersonalDataCollectionModuleTypes.NON_PERSONAL_DATA_COLLECTION_SERVICE)),o(20,(0,s.inject)(y.UrbanTypes.URBAN_POLICIES_STORAGE)),r("design:paramtypes",[U.AppService,O.AdBlockerService,String,N.CounterService,p.CurrentUser,Object,h.LocationService,P.UrbanPromotionApi,v.InterruptionService,g.PageHistoryService,T.PolicyService,A.StateService,F.CountryRestrictionService,Object,String,L.FlagService,w.IdentityService,k.GiftStorage,Y.DataSharingManager,q.NonPersonalDataCollectionService,W.PoliciesStorage])],X),t.PopupStateService=X},48929:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProcessingStates=t.PopupProcess=void 0;const i=n(22534),r=n(25886);var o;!function(e){e.INIT="INIT",e.LOGOUT="LOGOUT",e.LOGIN="LOGIN",e.REPAIR_CONNECTION="REPAIR_CONNECTION",e.ACTIVATE_LOCATION="ACTIVATE_LOCATION",e.DEACTIVATE_LOCATION="DEACTIVATE_LOCATION",e.HANDS_SHAKE_START="HANDS_SHAKE_START",e.ENABLE_AD_BLOCKER="ENABLE_AD_BLOCKER",e.DISABLE_AD_BLOCKER="DISABLE_AD_BLOCKER",e.POLICY_AGREED="POLICY_AGREED",e.POLICY_REJECTED="POLICY_REJECTED",e.NON_PERSONAL_DATA_COLLECTION_AGREED="NON_PERSONAL_DATA_COLLECTION_AGREED",e.NON_PERSONAL_DATA_COLLECTION_REJECTED="NON_PERSONAL_DATA_COLLECTION_REJECTED",e.ENABLE_ANTI_MALE_WARE="ENABLE_ANTI_MALE_WARE",e.DISABLE_ANTI_MALE_WARE="DISABLE_ANTI_MALE_WARE",e.AD_BLOCKER_CONSENT="AD_BLOCKER_CONSENT",e.ANTI_MALE_WARE_CONSENT="ANTI_MALE_WARE_CONSENT"}(o=t.PopupProcess||(t.PopupProcess={})),t.ProcessingStates={[o.INIT]:{fields:Object.values(i.PopupStateFields),responseEvent:r.PopupEventsIn.READY},[o.LOGIN]:{fields:[i.PopupStateFields.isVeteran,i.PopupStateFields.isAuthenticated,i.PopupStateFields.location,i.PopupStateFields.locations,i.PopupStateFields.email,i.PopupStateFields.isForceLoginMode,i.PopupStateFields.isInit],responseEvent:r.PopupEventsIn.LOGIN_RESPONSE},[o.LOGOUT]:{fields:Object.values(i.PopupStateFields),responseEvent:r.PopupEventsIn.LOGOUT_RESPONSE},[o.ACTIVATE_LOCATION]:{fields:[i.PopupStateFields.appState,i.PopupStateFields.activationTime,i.PopupStateFields.location,i.PopupStateFields.locations],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.DEACTIVATE_LOCATION]:{fields:[i.PopupStateFields.appState,i.PopupStateFields.activationTime,i.PopupStateFields.location,i.PopupStateFields.locations],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.HANDS_SHAKE_START]:{fields:[i.PopupStateFields.appState],responseEvent:r.PopupEventsIn.HANDS_SHAKE_FINISH_RESPONSE},[o.REPAIR_CONNECTION]:{fields:[i.PopupStateFields.appState],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.ENABLE_AD_BLOCKER]:{fields:[i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed,i.PopupStateFields.adsTotal,i.PopupStateFields.adsOnPage],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.DISABLE_AD_BLOCKER]:{fields:[i.PopupStateFields.adsTotal,i.PopupStateFields.adsOnPage,i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.AD_BLOCKER_CONSENT]:{fields:[i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.ENABLE_ANTI_MALE_WARE]:{fields:[i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.DISABLE_ANTI_MALE_WARE]:{fields:[i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.ANTI_MALE_WARE_CONSENT]:{fields:[i.PopupStateFields.isEnabledAdBlocker,i.PopupStateFields.isEnabledAntiMalware,i.PopupStateFields.isAdBlockerPolicyAgreed,i.PopupStateFields.isAntiMaleWarePolicyAgreed,i.PopupStateFields.isPolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.POLICY_AGREED]:{fields:[i.PopupStateFields.hasPolicyAnswer,i.PopupStateFields.isPolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.POLICY_REJECTED]:{fields:[i.PopupStateFields.hasPolicyAnswer,i.PopupStateFields.isPolicyAgreed],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.NON_PERSONAL_DATA_COLLECTION_AGREED]:{fields:[i.PopupStateFields.nonPersonalDataCollection],responseEvent:r.PopupEventsIn.STATE_CHANGED},[o.NON_PERSONAL_DATA_COLLECTION_REJECTED]:{fields:[i.PopupStateFields.nonPersonalDataCollection],responseEvent:r.PopupEventsIn.STATE_CHANGED}}},60456:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanToolbarService=void 0;const s=n(86700),c=n(18313),u=n(96233);let l=class{constructor(e,t){this.browser=e,this.browserAction=t}getColoredRoboImage(){return"icons/icon.png"}getGreyedRoboImage(){return"icons/icon_grey.png"}draw(e){return a(this,void 0,void 0,(function*(){const t=yield this.loadImage(e);yield this.browserAction.setIcon({imageData:t})}))}drawAnimation(e,t=200){this.stopAnimation();this.intervalId=setInterval((e=>{let t=0;return()=>{t===e.length&&(t=0);const n=e[t];this.intervalId&&this.draw(n).then(),t+=1}})(e),t)}drawConnectionAnimation(){this.drawAnimation(["icons/icon_grey.png","icons/icon_antenna_2.png","icons/icon_antenna_3.png","icons/icon_antenna_2.png"])}stopAnimation(){this.intervalId&&clearInterval(this.intervalId)}drawFlag(e,t=this.getColoredRoboImage(),n=!1){return a(this,void 0,void 0,(function*(){let i=yield this.loadImage(t),r=yield this.loadImage(`popup/flags/png/${e.toLowerCase()}.png`),o=document.createElement("canvas").getContext("2d");o.clearRect(0,0,18,18),o.putImageData(i,0,0);let a=8;n&&(a=this.browser===u.BrowserEnum.CHROME_BROWSER?0:8),o.putImageData(r,1,a);const s=o.getImageData(0,0,18,18);yield this.browserAction.setIcon({imageData:s})}))}drawAutoServer(){return a(this,void 0,void 0,(function*(){let e=yield this.loadImage("icons/icon_auto_server.png"),t=document.createElement("canvas").getContext("2d");t.clearRect(0,0,16,16),t.putImageData(e,0,0);const n=t.getImageData(0,0,16,16);yield this.browserAction.setIcon({imageData:n})}))}loadImage(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{let i=document.createElement("canvas").getContext("2d");i.clearRect(0,0,18,18);let r=new Image;r.src=e,r.onload=function(){i.drawImage(r,0,0),i.save();const e=i.getImageData(0,0,r.naturalWidth,r.naturalHeight);t(e)},r.onerror=function(e){n(e)}}))}))}};l=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.BROWSER)),o(1,(0,s.inject)(c.MARIO_TYPES.BROWSER_ACTION)),r("design:paramtypes",[String,Object])],l),t.UrbanToolbarService=l},1103:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PoliciesStorage=t.PoliciesState=t.PoliciesKeys=void 0;const s=n(86700),c=n(18313);var u,l;!function(e){e.AD_BLOCKER_POLICY="AD_BLOCKER_POLICY",e.ANTI_MINING_POLICY="ANTI_MINING_POLICY",e.GA_POLICY="GA_POLICY",e.UA_POLICY="UA_POLICY"}(u=t.PoliciesKeys||(t.PoliciesKeys={})),function(e){e.REJECT="REJECT",e.AGREE="AGREE"}(l=t.PoliciesState||(t.PoliciesState={}));let d=class{constructor(e){this.storage=e}isAdBlockerAgreed(){return a(this,void 0,void 0,(function*(){return yield this.is(l.AGREE,u.AD_BLOCKER_POLICY)}))}isAntiMiningAgreed(){return a(this,void 0,void 0,(function*(){return yield this.is(l.AGREE,u.ANTI_MINING_POLICY)}))}agreeAdBlockerPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.AD_BLOCKER_POLICY,l.AGREE)}))}rejectAdBlockerPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.AD_BLOCKER_POLICY,l.REJECT)}))}agreeAntiMiningPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.ANTI_MINING_POLICY,l.AGREE)}))}rejectAntiMiningPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.ANTI_MINING_POLICY,l.REJECT)}))}agreeGAPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.GA_POLICY,l.AGREE)}))}rejectGAPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.GA_POLICY,l.REJECT)}))}agreeUAPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.UA_POLICY,l.AGREE)}))}rejectUAPolicy(){return a(this,void 0,void 0,(function*(){yield this.storage.set(u.UA_POLICY,l.REJECT)}))}hasAnswer(e){return a(this,void 0,void 0,(function*(){return yield this.storage.has(e)}))}is(e,t){return a(this,void 0,void 0,(function*(){if(yield this.hasAnswer(t)){return(yield this.storage.get(t))===e}return!1}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],d),t.PoliciesStorage=d},16829:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthModule=void 0;const r=n(18313),o=n(99841),a=n(2975),s=n(37209),c=n(52434),u=n(26469),l=n(44359),d=n(73744),h=n(45103),f=n(83088),p=n(99093),_=n(99769),E=n(17418),y=n(18083);class v extends r.MarioModule{name(){return"AuthModule"}register(e){return i(this,void 0,void 0,(function*(){yield this.registerServices(e),yield this.registerInternalEventListeners(),yield this.setupAuthToken(),yield this.setupSecurityToken(),yield this.setupInterceptor()}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(v,t)}))}registerServices(e){this.mario().registerService(o.AUTH_MODULE_TYPES.AUTH_SERVICE,a.AuthService),this.mario().registerService(o.AUTH_MODULE_TYPES.AUTH_MIGRATION,s.AuthMigration),this.mario().registerService(o.AUTH_MODULE_TYPES.TOKEN_STORAGE,c.TokensStorage),this.mario().registerService(o.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR,u.RequestsInterceptor),this.mario().registerService(o.AUTH_MODULE_TYPES.LOGOUT_SERVICE,l.LogoutService),this.mario().registerService(o.AUTH_MODULE_TYPES.CURRENT_USER,h.CurrentUser),this.mario().registerService(o.AUTH_MODULE_TYPES.SETUP_SERVICE,p.AuthSetupService)}registerInternalEventListeners(){this.mario().internalDispatcher().on(d.Logout),this.mario().internalDispatcher().on(_.UpdateSecurityToken)}setupAuthToken(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(o.AUTH_MODULE_TYPES.AUTH_MIGRATION),t=this.mario().getService(o.AUTH_MODULE_TYPES.SETUP_SERVICE),n=this.mario().getService(o.AUTH_MODULE_TYPES.TOKEN_STORAGE);if(yield e.hasOldToken()){this.mario().logger().log("AuthModule: migrate a token from v2.2.0 to v3.0.0"),this.analytics().trackAuthMigration(y.AuthTokenMigrationPhase.STARTED),yield e.migrate();const i=yield t.setupSecurityToken();if(i===p.SecurityTokenStatus.DONE)return this.mario().logger().log("AuthModule: an auth token from v2.2.0 is successfully migrated"),this.analytics().trackAuthMigration(y.AuthTokenMigrationPhase.SUCCESS),!0;i===p.SecurityTokenStatus.AUTH_ERROR?(this.analytics().trackAuthMigration(y.AuthTokenMigrationPhase.FAILURE),this.mario().logger().log("AuthModule: an auth token from v2.2.0 is not working [http status 401]"),this.mario().logger().log("AuthModule: remove the current anonymous user and register a new anonymous user"),yield n.removeAuthAndSecurityTokens(c.UserType.ANONYMOUS)):(this.mario().logger().log("AuthModule: unknown error with using v2.2.0 auth token"),this.analytics().trackAuthMigration(y.AuthTokenMigrationPhase.FAILURE))}return(yield t.isAuthTokenReady())?(this.mario().logger().log("AuthModule: an auth token ready"),!0):yield t.setupAuthToken()}))}setupSecurityToken(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(o.AUTH_MODULE_TYPES.SETUP_SERVICE);(yield e.isSecurityTokenReady())?this.mario().logger().log("AuthModule: a security token is already ready"):(this.mario().logger().log("AuthModule: setup a security token"),yield e.setupSecurityToken())}))}setupInterceptor(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(o.AUTH_MODULE_TYPES.SETUP_SERVICE);if((yield e.isAuthTokenReady())&&(yield e.isSecurityTokenReady()))return this.mario().logger().log("AuthModule: setup interceptor"),void(yield e.setupInterceptor());this.mario().logger().log("AuthModule: could not start setup interceptor because tokens are not ready")}))}analytics(){return this.mario().getService(E.AnalyticsModuleTypes.ANALYTICS)}app(){return this.mario().getService(f.UrbanTypes.URBAN_APP_SERVICE)}}t.AuthModule=v},48476:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthModuleEvents=void 0,function(e){e.AFTER_LOGIN="AFTER_LOGIN",e.AFTER_LOGOUT="AFTER_LOGOUT",e.REFRESH_ACCESS_SECURITY_TOKEN="REFRESH_ACCESS_SECURITY_TOKEN",e.LOGIN_FAILED="LOGIN_FAILED"}(t.AuthModuleEvents||(t.AuthModuleEvents={}))},99841:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AUTH_MODULE_TYPES=void 0,t.AUTH_MODULE_TYPES={AUTH_SERVICE:Symbol.for("AUTH_SERVICE_2"),AUTH_MIGRATION:Symbol.for("AUTH_MIGRATION"),TOKEN_STORAGE:Symbol.for("TOKEN_STORAGE"),AUTH_REQUESTS_INTERCEPTOR:Symbol.for("AUTH_REQUESTS_INTERCEPTOR"),LOGOUT_SERVICE:Symbol.for("LOGOUT_SERVICE"),CURRENT_USER:Symbol.for("CURRENT_USER"),SETUP_SERVICE:Symbol.for("SETUP_SERVICE")}},84269:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthStorageKeys=void 0,function(e){e.AUTH_ANONYMOUS_AUTH_TOKEN="AUTH_ANONYMOUS_AUTH_TOKEN",e.AUTH_ANONYMOUS_SECURITY_TOKEN="AUTH_ANONYMOUS_SECURITY_TOKEN",e.AUTH_USER_AUTH_TOKEN="AUTH_USER_AUTH_TOKEN",e.AUTH_USER_SECURITY_TOKEN="AUTH_USER_SECURITY_TOKEN"}(t.AuthStorageKeys||(t.AuthStorageKeys={}))},99475:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Features=void 0,function(e){e.AUTO_SERVER="autoserver",e.NETFLIX_FRIENDLY="netflixserver_usa",e.DISABLED_DATA_COLLECTION="disabled_data_collection"}(t.Features||(t.Features={}))},73744:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Logout=void 0;const s=n(44359),c=n(86700),u=n(99841);let l=class{constructor(e){this.logoutService=e}on(){return"LOGOUT"}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data;yield this.logoutService.logout(t)}))}};l=i([(0,c.injectable)(),o(0,(0,c.inject)(u.AUTH_MODULE_TYPES.LOGOUT_SERVICE)),r("design:paramtypes",[s.LogoutService])],l),t.Logout=l},99769:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateSecurityToken=void 0;const s=n(86700),c=n(48476),u=n(75454),l=n(99832),d=n(26469),h=n(99841),f=n(52434),p=n(45103);let _=class{constructor(e,t,n,i){this.security=e,this.storage=t,this.currentUser=n,this.interceptor=i}on(){return c.AuthModuleEvents.REFRESH_ACCESS_SECURITY_TOKEN}handle(e){return a(this,void 0,void 0,(function*(){const e=this.interceptor.getAuthToken(),t=yield this.security.getSecurityToken(e);yield this.storage.saveSecurityToken(this.currentUser.getUserType(),t),this.interceptor.setSecurityToken(t)}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(u.SecurityModuleTypes.SECURITY_SERVICE)),o(1,(0,s.inject)(h.AUTH_MODULE_TYPES.TOKEN_STORAGE)),o(2,(0,s.inject)(h.AUTH_MODULE_TYPES.CURRENT_USER)),o(3,(0,s.inject)(h.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),r("design:paramtypes",[l.SecurityService,f.TokensStorage,p.CurrentUser,d.RequestsInterceptor])],_),t.UpdateSecurityToken=_},37209:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthMigration=void 0;const s=n(86700),c=n(18313),u=n(99841),l=n(52434),d="ACCOUNT_SECURITY_TOKEN";let h=class{constructor(e,t){this.storage=e,this.tokenStorage=t}hasOldToken(){return a(this,void 0,void 0,(function*(){return this.storage.has(d)}))}migrate(){return a(this,void 0,void 0,(function*(){if(!(yield this.hasOldToken()))return;const e={value:yield this.storage.get(d)};yield this.tokenStorage.saveAuthToken(l.UserType.ANONYMOUS,e),yield this.storage.remove([d])}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),o(1,(0,s.inject)(u.AUTH_MODULE_TYPES.TOKEN_STORAGE)),r("design:paramtypes",[Object,l.TokensStorage])],h),t.AuthMigration=h},99093:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthSetupService=t.SecurityTokenStatus=void 0;const s=n(86700),c=n(52434),u=n(99841),l=n(99832),d=n(75454),h=n(18313),f=n(81630),p=n(7009),_=n(26469),E=n(89816),y=n(17418);var v;!function(e){e.AUTH_ERROR="AUTH_ERROR",e.DONE="DONE",e.UNKNOWN_ERROR="UNKNOWN_ERROR"}(v=t.SecurityTokenStatus||(t.SecurityTokenStatus={}));let g=class{constructor(e,t,n,i,r,o){this.logger=e,this.storage=t,this.security=n,this.accountService=i,this.interceptor=r,this.analytics=o,this.interceptorReady=!1}isAuthTokenReady(){return a(this,void 0,void 0,(function*(){return this.storage.hasAuthToken(c.UserType.ANONYMOUS)}))}isAuthTokenNotReady(){return a(this,void 0,void 0,(function*(){return!(yield this.isAuthTokenReady())}))}isSecurityTokenReady(){return a(this,void 0,void 0,(function*(){return this.storage.hasSecurityToken(c.UserType.ANONYMOUS)}))}isSecurityTokenNotReady(){return a(this,void 0,void 0,(function*(){return!(yield this.isSecurityTokenReady())}))}setupAuthToken(){return a(this,void 0,void 0,(function*(){if(yield this.isAuthTokenReady())return!0;try{const e=yield this.accountService.registerAnonymous();yield this.storage.saveAuthToken(c.UserType.ANONYMOUS,e)}catch(e){return this.logger.log("AuthSetupService: Could not register Anonymous"),this.analytics.trackCouldNotRegisterAnonymous(),!1}return!0}))}setupSecurityToken(){return a(this,void 0,void 0,(function*(){if(yield this.storage.hasNoAuthToken(c.UserType.ANONYMOUS))throw new Error("AuthSetupService: Could not get security token because no auth token");const e=yield this.storage.getAuthToken(c.UserType.ANONYMOUS);try{const t=yield this.security.getSecurityToken(e.value);yield this.storage.saveSecurityToken(c.UserType.ANONYMOUS,t)}catch(e){return this.analytics.trackCouldNotGetSecurityToken(),this.logger.log("Could not get security token"),this.logger.log(e),401===e.status?v.AUTH_ERROR:v.UNKNOWN_ERROR}return v.DONE}))}setupInterceptor(){return a(this,void 0,void 0,(function*(){const e=(yield this.storage.hasAuthAndSecurityTokens(c.UserType.USER))?c.UserType.USER:c.UserType.ANONYMOUS,t=yield this.storage.getAuthToken(e),n=yield this.storage.getSecurityToken(e);this.interceptor.setUserType(e),this.interceptor.setAuthToken(t),this.interceptor.setSecurityToken(n),this.interceptor.enableInterception(),this.interceptorReady=!0}))}isInterceptorReady(){return this.interceptorReady}isInterceptorNotReady(){return!this.isInterceptorReady()}};g=i([(0,s.injectable)(),o(0,(0,s.inject)(h.MARIO_TYPES.LOGGER_SERVICE)),o(1,(0,s.inject)(u.AUTH_MODULE_TYPES.TOKEN_STORAGE)),o(2,(0,s.inject)(d.SecurityModuleTypes.SECURITY_SERVICE)),o(3,(0,s.inject)(p.ACCOUNT_MODULE_TYPES.ACCOUNT_SERVICE)),o(4,(0,s.inject)(u.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),o(5,(0,s.inject)(y.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[Object,c.TokensStorage,l.SecurityService,f.AccountService,_.RequestsInterceptor,E.Analytics])],g),t.AuthSetupService=g},45103:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentUser=void 0;const a=n(86700),s=n(26469),c=n(99841),u=n(52434),l=n(99475);let d=class{constructor(e){this.interceptor=e}getUserType(){return this.interceptor.getUserType()}isPremiumUser(){return this.getUserType()===u.UserType.USER}isAnonymousUser(){return this.getUserType()===u.UserType.ANONYMOUS}getSecurityToken(){return this.interceptor.getSecurityToken()}hasFeature(e){var t;const n=this.getSecurityToken();return!!(null===(t=null==n?void 0:n.features)||void 0===t?void 0:t.length)&&!!n.features.find((t=>t.key===e))}hasDisabledDataCollectionFeature(){return this.hasFeature(l.Features.DISABLED_DATA_COLLECTION)}hasAutoServerFeature(){return this.hasFeature(l.Features.AUTO_SERVER)}hasStreamingServicesFeature(){return this.hasFeature(l.Features.NETFLIX_FRIENDLY)}};d=i([(0,a.injectable)(),o(0,(0,a.inject)(c.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),r("design:paramtypes",[s.RequestsInterceptor])],d),t.CurrentUser=d},44359:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LogoutService=t.LogoutType=void 0;const s=n(86700),c=n(52434),u=n(18313),l=n(48476),d=n(99841),h=n(26469);!function(e){e.AUTO_LOGOUT="AUTO_LOGOUT",e.MANUAL_LOGOUT="MANUAL_LOGOUT"}(t.LogoutType||(t.LogoutType={}));let f=class{constructor(e,t,n){this.storage=e,this.interceptor=t,this.internalDispatcher=n}logout(e){return a(this,void 0,void 0,(function*(){yield this.storage.removeAuthAndSecurityTokens(c.UserType.USER);const t=yield this.storage.getAuthToken(c.UserType.ANONYMOUS),n=yield this.storage.getSecurityToken(c.UserType.ANONYMOUS);this.interceptor.setAuthToken(t),this.interceptor.setSecurityToken(n),this.interceptor.setUserType(c.UserType.ANONYMOUS);const i=new u.MarioEvent(l.AuthModuleEvents.AFTER_LOGOUT,{type:e});yield this.internalDispatcher.emit(i)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(d.AUTH_MODULE_TYPES.TOKEN_STORAGE)),o(1,(0,s.inject)(d.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),o(2,(0,s.inject)(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[c.TokensStorage,h.RequestsInterceptor,Object])],f),t.LogoutService=f},26469:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RequestsInterceptor=void 0;const a=n(86700),s=n(37050),c=n(82730),u=n(99841),l=n(52434),d=n(18313),h=n(44359),f=n(99832),p=n(75454);let _=class{constructor(e,t,n,i){this.httpClient=e,this.storage=t,this.dispatcher=n,this.security=i,this.interceptionEnabled=!1,this.httpClient.intercept(this.interceptor.bind(this)),this.httpClient.onFail(this.failHandler.bind(this))}setAuthToken(e){this.authToken=e.value}getAuthToken(){return this.authToken}setSecurityToken(e){this.securityToken=e}getSecurityToken(){return this.securityToken}setUserType(e){this.userType=e}getUserType(){return this.userType}enableInterception(){this.interceptionEnabled=!0}disableInterception(){this.interceptionEnabled=!1}interceptor(e,t,n){if(!this.interceptionEnabled)return void t();const i=e.headers?e.headers:new Headers;i.has("authorization")&&i.delete("authorization"),i.append("authorization",`Bearer ${this.securityToken.value}`),i.has("content-Type")||i.append("content-Type","application/json"),e.headers=i,t()}failHandler(e,t,n){this.interceptionEnabled||n(),401!==e.status&&n();let i=!1,r=!1;this.security.getSecurityToken(this.authToken).then((e=>{if(!e.package.subscriptionAware&&this.userType===l.UserType.USER)throw new Error("do auto logout");return this.securityToken=e,this.storage.saveSecurityToken(this.userType,e)})).then((()=>{i=!0})).catch((()=>{if(this.userType===l.UserType.USER){r=!0;const e=new d.MarioEvent("LOGOUT",h.LogoutType.AUTO_LOGOUT);return this.dispatcher.emit(e)}return Promise.resolve()})).then((()=>{i||r?t():n()}))}};_=i([(0,a.injectable)(),o(0,(0,a.inject)(s.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(1,(0,a.inject)(u.AUTH_MODULE_TYPES.TOKEN_STORAGE)),o(2,(0,a.inject)(d.MARIO_TYPES.INTERNAL_DISPATCHER)),o(3,(0,a.inject)(p.SecurityModuleTypes.SECURITY_SERVICE)),r("design:paramtypes",[c.HttpClient,l.TokensStorage,Object,f.SecurityService])],_),t.RequestsInterceptor=_},52434:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TokensStorage=t.UserType=void 0;const s=n(86700),c=n(18313),u=n(84269);var l;!function(e){e.USER="USER",e.ANONYMOUS="ANONYMOUS"}(l=t.UserType||(t.UserType={}));const d={[l.ANONYMOUS]:{auth:u.AuthStorageKeys.AUTH_ANONYMOUS_AUTH_TOKEN,security:u.AuthStorageKeys.AUTH_ANONYMOUS_SECURITY_TOKEN},[l.USER]:{auth:u.AuthStorageKeys.AUTH_USER_AUTH_TOKEN,security:u.AuthStorageKeys.AUTH_USER_SECURITY_TOKEN}};let h=class{constructor(e){this.storage=e}saveAuthToken(e,t){return a(this,void 0,void 0,(function*(){const n=this.getStorageKeys(e),i=JSON.stringify(t);yield this.storage.set(n.auth,i)}))}saveSecurityToken(e,t){return a(this,void 0,void 0,(function*(){const n=this.getStorageKeys(e);yield this.storage.set(n.security,JSON.stringify(t))}))}getAuthToken(e){return a(this,void 0,void 0,(function*(){const t=this.getStorageKeys(e),n=yield this.storage.get(t.auth);return JSON.parse(n)}))}getSecurityToken(e){return a(this,void 0,void 0,(function*(){const t=this.getStorageKeys(e),n=yield this.storage.get(t.security);return JSON.parse(n)}))}hasAuthToken(e){return a(this,void 0,void 0,(function*(){const t=this.getStorageKeys(e);return this.storage.has(t.auth)}))}hasNoAuthToken(e){return a(this,void 0,void 0,(function*(){return!(yield this.hasAuthToken(e))}))}hasSecurityToken(e){return a(this,void 0,void 0,(function*(){const t=this.getStorageKeys(e);return this.storage.has(t.security)}))}hasNoSecurityToken(e){return a(this,void 0,void 0,(function*(){return!(yield this.hasSecurityToken(e))}))}hasAuthAndSecurityTokens(e){return a(this,void 0,void 0,(function*(){return(yield this.hasAuthToken(e))&&(yield this.hasSecurityToken(e))}))}removeAuthAndSecurityTokens(e){return a(this,void 0,void 0,(function*(){const t=this.getStorageKeys(e);yield this.storage.remove([t.auth,t.security])}))}getStorageKeys(e){return d[e]}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],h),t.TokensStorage=h},2975:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthService=void 0;const s=n(86700),c=n(99841),u=n(18313),l=n(82730),d=n(37050),h=n(48476),f=n(52434),p=n(44359),_=n(99832),E=n(75454),y=n(26469),v=n(99490),g=n(82416);let S=class{constructor(e,t,n,i,r,o){this.httpClient=e,this.storage=t,this.dispatcher=n,this.logger=i,this.securityService=r,this.interceptor=o}isAuthenticated(){return a(this,void 0,void 0,(function*(){return this.storage.hasAuthAndSecurityTokens(f.UserType.USER)}))}isAuthTokenExpired(){return a(this,void 0,void 0,(function*(){if(!(yield this.storage.hasAuthToken(f.UserType.USER)))throw new Error("AuthService: user is not authorized");const e=yield this.storage.getAuthToken(f.UserType.USER);return v.DateTime.fromMillis(e.expirationTime)<v.DateTime.local()}))}login(e,t){return a(this,void 0,void 0,(function*(){try{const n=yield this.securityService.getAuthToken(e,t),i=yield this.securityService.getSecurityToken(n.value);if(!i.package.subscriptionAware)return this.emitLoginFailed(e),{ok:!1,status:g.AuthStatus.SUBSCRIPTION_ENDED_ERROR,message:"Your subscription is ended"};yield this.storage.saveAuthToken(f.UserType.USER,n),yield this.storage.saveSecurityToken(f.UserType.USER,i),this.interceptor.setAuthToken(n),this.interceptor.setSecurityToken(i),this.interceptor.setUserType(f.UserType.USER);const r={identity:e},o=new u.MarioEvent(h.AuthModuleEvents.AFTER_LOGIN,r);return yield this.dispatcher.emit(o),{ok:!0,status:g.AuthStatus.SUCCESS}}catch(t){return this.emitLoginFailed(e),{ok:!1,status:g.AuthStatus.GENERAL_ERROR,message:"Incorrect email or password"}}}))}logout(){return a(this,void 0,void 0,(function*(){const e=new u.MarioEvent("LOGOUT",p.LogoutType.MANUAL_LOGOUT);yield this.dispatcher.emit(e)}))}autoLogout(){return a(this,void 0,void 0,(function*(){const e=new u.MarioEvent("LOGOUT",p.LogoutType.AUTO_LOGOUT);yield this.dispatcher.emit(e)}))}getOwner(){return a(this,void 0,void 0,(function*(){return(yield this.storage.getSecurityToken(f.UserType.USER)).owner}))}getPackage(){return a(this,void 0,void 0,(function*(){return(yield this.storage.getSecurityToken(f.UserType.USER)).package}))}emitLoginFailed(e){const t={identity:e},n=new u.MarioEvent(h.AuthModuleEvents.LOGIN_FAILED,t);this.dispatcher.emit(n).then()}};S=i([(0,s.injectable)(),o(0,(0,s.inject)(d.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(1,(0,s.inject)(c.AUTH_MODULE_TYPES.TOKEN_STORAGE)),o(2,(0,s.inject)(u.MARIO_TYPES.INTERNAL_DISPATCHER)),o(3,(0,s.inject)(u.MARIO_TYPES.LOGGER_SERVICE)),o(4,(0,s.inject)(E.SecurityModuleTypes.SECURITY_SERVICE)),o(5,(0,s.inject)(c.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),r("design:paramtypes",[l.HttpClient,f.TokensStorage,Object,Object,_.SecurityService,y.RequestsInterceptor])],S),t.AuthService=S},82416:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthStatus=void 0,function(e){e.SUCCESS="SUCCESS",e.GENERAL_ERROR="GENERAL_ERROR",e.SUBSCRIPTION_ENDED_ERROR="SUBSCRIPTION_ENDED_ERROR"}(t.AuthStatus||(t.AuthStatus={}))},29187:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataSharingModule=void 0;const r=n(18313),o=n(92750),a=n(84160);class s extends r.MarioModule{name(){return"DataSharingModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(o.DataSharingModuleTypes.DATA_SHARING_MANAGER,a.DataSharingManager),this.mario().container().bind(o.DataSharingModuleTypes.DATA_SHARING_OPTIONS).toConstantValue(e)}))}}t.DataSharingModule=s},92750:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataSharingModuleTypes=void 0,t.DataSharingModuleTypes={DATA_SHARING_MANAGER:Symbol.for("DATA_SHARING_MANAGER"),DATA_SHARING_OPTIONS:Symbol.for("DATA_SHARING_OPTIONS")}},84160:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DataSharingManager=t.DataSharingState=void 0;const s=n(86700),c=n(18313),u=n(37050),l=n(82730),d=n(92750);var h;!function(e){e.REJECT="REJECT",e.AGREE="AGREE"}(h=t.DataSharingState||(t.DataSharingState={}));let f=class{constructor(e,t,n){this.storage=e,this.httpClient=t,this.options=n,this.key="DATA_SHARING_POLICY"}hasAnswer(){return a(this,void 0,void 0,(function*(){return yield this.storage.has(this.key)}))}agree(){return a(this,void 0,void 0,(function*(){yield this.setState(!0),yield this.storage.set(this.key,h.AGREE)}))}reject(){return a(this,void 0,void 0,(function*(){yield this.setState(!1),yield this.storage.set(this.key,h.REJECT)}))}getState(){return a(this,void 0,void 0,(function*(){return yield this.storage.get(this.key)}))}is(e){return a(this,void 0,void 0,(function*(){if(!(yield this.storage.has(this.key)))return!1;return(yield this.storage.get(this.key))===e}))}setState(e){return a(this,void 0,void 0,(function*(){const t=new Headers;t.append("Content-Type","application/json"),yield this.httpClient.post(this.endpoint(),this.body(e),{headers:t},{skipInterceptor:!0})}))}endpoint(){return`${this.options.apiUrl}/panelists/${this.options.panelistId}/settings`}body(e){const{panelistId:t,partnerId:n,distributorId:i}=this.options;return{panelistId:t,partnerId:n,distributorId:i,ecommerceEnabled:e,advertisementEnabled:e,clickstreamEnabled:e}}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),o(1,(0,s.inject)(u.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(2,(0,s.inject)(d.DataSharingModuleTypes.DATA_SHARING_OPTIONS)),r("design:paramtypes",[Object,l.HttpClient,Object])],f),t.DataSharingManager=f},9878:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECommerceModuleExternalEvents=t.ECommerceModuleEvents=void 0,function(e){e.PRICE_CHANGED="E_COMMERCE_PRICE_CHANGED",e.MUTE_NOTIFICATION="E_COMMERCE_MUTE_NOTIFICATION"}(t.ECommerceModuleEvents||(t.ECommerceModuleEvents={})),function(e){e.PRICE_CHANGED="E_COMMERCE_PRICE_CHANGED"}(t.ECommerceModuleExternalEvents||(t.ECommerceModuleExternalEvents={}))},37779:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ECommerceModule=void 0;const r=n(18313),o=n(32410),a=n(11578),s=n(20564),c=n(9878),u=n(85760),l=n(62176),d=n(99189);class h extends r.MarioModule{name(){return"ECommerceModule"}register(e){return i(this,void 0,void 0,(function*(){const t=new a.ECommerceStream({logging:e.logging,version:{extension:chrome.runtime.getManifest().version},client:{distributorId:e.distributorId,id:e.clientId,panelId:e.panelId,partnerId:e.partnerId},safePriceCheck:e.safePriceCheck,syncUp:e.syncUp,compression:e.compression,track:e.track,watchers:[]});this.mario().container().bind(o.ECommerceModuleTypes.STREAM).toConstantValue(t),this.mario().registerService(o.ECommerceModuleTypes.MUTED_URLS_STORAGE,u.EcommerceMutedUrlsStorage),this.mario().internalDispatcher().on(l.PriceCheckListener),this.mario().externalDispatcher().on(d.MuteNotificationListener),t.subscribe(s.SafePriceCheckerMessages.SAFE_CHECK,(e=>{if(!e.priceChanged)return;const t=this.mario().getService(r.MARIO_TYPES.INTERNAL_DISPATCHER),n=new r.MarioEvent(c.ECommerceModuleEvents.PRICE_CHANGED);t.emit(n)}))}))}static use(e,t){return i(this,void 0,void 0,(function*(){yield e.registerModule(h,t)}))}}t.ECommerceModule=h},32410:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ECommerceModuleTypes=void 0,t.ECommerceModuleTypes={STREAM:Symbol.for("E_COMMERCE_STREAM"),MUTED_URLS_STORAGE:Symbol.for("E_COMMERCE_MUTED_URLS_STORAGE")}},99189:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MuteNotificationListener=void 0;const s=n(86700),c=n(18313),u=n(2325),l=n(9878),d=n(32410),h=n(85760);let f=class{constructor(e,t){this.tabService=e,this.storage=t}on(){return l.ECommerceModuleEvents.MUTE_NOTIFICATION}handle(e,t,n){return a(this,void 0,void 0,(function*(){const{url:e}=t.tab;yield this.storage.set(e)}))}};f=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.TAB_SERVICE)),o(1,(0,s.inject)(d.ECommerceModuleTypes.MUTED_URLS_STORAGE)),r("design:paramtypes",[u.TabService,h.EcommerceMutedUrlsStorage])],f),t.MuteNotificationListener=f},62176:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PriceCheckListener=void 0;const s=n(86700),c=n(18313),u=n(9878),l=n(32410),d=n(85760);let h=class{constructor(e,t,n,i){this.dispatcher=e,this.tabService=t,this.logger=n,this.storage=i}on(){return u.ECommerceModuleEvents.PRICE_CHANGED}handle(){return a(this,void 0,void 0,(function*(){const e=yield this.tabService.query({active:!0,currentWindow:!0});if(0===e.length)return void this.logger.log("PriceCheckListener: No active tab");const[t]=e;if(yield this.storage.isUrlMuted(t.url))return void this.logger.log(`PriceCheckListener: "${t.url} already muted"`);const n=new c.MarioEvent(u.ECommerceModuleExternalEvents.PRICE_CHANGED);this.dispatcher.emit(t.id,n)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.EXTERNAL_DISPATCHER)),o(1,(0,s.inject)(c.MARIO_TYPES.TAB_SERVICE)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(l.ECommerceModuleTypes.MUTED_URLS_STORAGE)),r("design:paramtypes",[Object,Object,Object,d.EcommerceMutedUrlsStorage])],h),t.PriceCheckListener=h},85760:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EcommerceMutedUrlsStorage=void 0;const s=n(18313),c=n(86700);let u=class{constructor(e){this.storageService=e,this.key="E_COMMERCE_SAFE_PRICE_CHECK_MUTED_URLS"}set(e){return a(this,void 0,void 0,(function*(){const t=yield this.getList(),n=JSON.stringify([...t,this.getDomain(e)]);return yield this.storageService.set(this.key,n)}))}isUrlMuted(e){return a(this,void 0,void 0,(function*(){const t=this.getDomain(e);return(yield this.getList()).includes(t)}))}getList(){return a(this,void 0,void 0,(function*(){const e=yield this.storageService.get(this.key);return e?JSON.parse(e):[]}))}getDomain(e){try{const{host:t}=new URL(e);return t}catch(t){return e}}};u=i([(0,c.injectable)(),o(0,(0,c.inject)(s.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.EcommerceMutedUrlsStorage=u},72001:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentModule=void 0;const r=n(18313),o=n(93158),a=n(36312),s=n(13104),c=n(80150),u=n(1939),l=n(1087),d=n(78472),h=n(45588);class f extends r.MarioModule{name(){return"ExperimentModule"}register(e){return i(this,void 0,void 0,(function*(){const t=e;yield this.registerServices(t),yield this.giftManager().onCampaignEnded(),yield this.giftManager().setupAlarms(),yield this.giftManager().onStartUp()}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(f,t)}))}registerServices(e){return i(this,void 0,void 0,(function*(){this.mario().container().bind(o.ExperimentModuleTypes.BENEFITS_API).toConstantValue(e.benefitsApi),this.mario().container().bind(o.ExperimentModuleTypes.VETERAN_PACKAGE_ID).toConstantValue(e.veteranPackageId),this.mario().container().bind(o.ExperimentModuleTypes.SHIFT_END_CAMPAIGN_TIME_ON).toConstantValue(e.shiftEndCampaignTimeOn),this.mario().container().bind(o.ExperimentModuleTypes.UNINSTALL_URL).toConstantValue(e.uninstallUrl),this.mario().container().bind(o.ExperimentModuleTypes.POLLING_EXPERIMENTS_EACH_SECONDS).toConstantValue(e.pollingExperimentsEachSeconds),this.mario().container().bind(o.ExperimentModuleTypes.UNINSTALL_KEEP_TIME).toConstantValue(e.uninstallKeepTime),this.mario().registerService(o.ExperimentModuleTypes.BENEFITS_CLIENT,a.BenefitsClient),this.mario().registerService(o.ExperimentModuleTypes.GIFT_MANAGER,s.GiftManager),this.mario().registerService(o.ExperimentModuleTypes.GIFT_STORAGE,c.GiftStorage),this.mario().internalDispatcher().on(u.ExperimentCampaignEnded),this.mario().internalDispatcher().on(l.PollingExperiments),this.mario().portDispatcher().on(d.CongratulationsPageVisited),this.mario().portDispatcher().on(h.OverPageVisited)}))}giftManager(){return this.mario().getService(o.ExperimentModuleTypes.GIFT_MANAGER)}}t.ExperimentModule=f},67156:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentModuleAlarms=void 0,function(e){e.EXPERIMENT_CAMPAIGN_ENDED="EXPERIMENT_CAMPAIGN_ENDED",e.EXPERIMENT_POLLING="EXPERIMENT_POLLING"}(t.ExperimentModuleAlarms||(t.ExperimentModuleAlarms={}))},93158:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentModuleTypes=void 0;const n={APP_VERSION:Symbol.for("EXPERIMENTAL_APP_"),BENEFITS_API:Symbol.for("BENEFITS_API"),BENEFITS_CLIENT:Symbol.for("BENEFITS_CLIENT"),GIFT_MANAGER:Symbol.for("GIFT_MANAGER"),GIFT_STORAGE:Symbol.for("GIFT_STORAGE"),SHIFT_END_CAMPAIGN_TIME_ON:Symbol.for("SHIFT_END_CAMPAIGN_TIME_ON"),VETERAN_PACKAGE_ID:Symbol.for("EXPERIMENTAL_VETERAN_PACKAGE_ID"),UNINSTALL_URL:Symbol.for("EXPERIMENTAL_UNINSTALL_URL"),POLLING_EXPERIMENTS_EACH_SECONDS:Symbol.for("POLLING_EXPERIMENTS_EACH_SECONDS"),UNINSTALL_KEEP_TIME:Symbol.for("EXPERIMENTS_UNINSTALL_KEEP_TIME")};t.ExperimentModuleTypes=n},1939:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentCampaignEnded=void 0;const s=n(86700),c=n(13104),u=n(93158),l=n(14874),d=n(67156);let h=class{constructor(e){this.manager=e}on(){return l.AlarmEvents.ALARM_ELAPSED}handle(e){return a(this,void 0,void 0,(function*(){const{name:t}=e.data;t===d.ExperimentModuleAlarms.EXPERIMENT_CAMPAIGN_ENDED&&this.manager.onCampaignEnded().then()}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(u.ExperimentModuleTypes.GIFT_MANAGER)),r("design:paramtypes",[c.GiftManager])],h),t.ExperimentCampaignEnded=h},1087:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PollingExperiments=void 0;const s=n(86700),c=n(14874),u=n(67156),l=n(93158),d=n(13104);let h=class{constructor(e){this.manager=e}on(){return c.AlarmEvents.ALARM_ELAPSED}handle(e){return a(this,void 0,void 0,(function*(){const{name:t}=e.data;t===u.ExperimentModuleAlarms.EXPERIMENT_POLLING&&this.manager.onStartUp().then()}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(l.ExperimentModuleTypes.GIFT_MANAGER)),r("design:paramtypes",[d.GiftManager])],h),t.PollingExperiments=h},78472:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CongratulationsPageVisited=void 0;const s=n(16437),c=n(86700),u=n(13104),l=n(93158);let d=class{constructor(e){this.manager=e}on(){return s.PopupEventsOut.CONGRATULATION_PAGE_VISITED}handle(e){return a(this,void 0,void 0,(function*(){const{giftId:t}=e.data;this.manager.congratulationsPageVisited(t).then()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(l.ExperimentModuleTypes.GIFT_MANAGER)),r("design:paramtypes",[u.GiftManager])],d),t.CongratulationsPageVisited=d},45588:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OverPageVisited=void 0;const s=n(16437),c=n(86700),u=n(93158),l=n(13104);let d=class{constructor(e){this.manager=e}on(){return s.PopupEventsOut.OVER_PAGE_VISITED}handle(e){return a(this,void 0,void 0,(function*(){const{giftId:t}=e.data;this.manager.overPageVisited(t).then()}))}};d=i([(0,c.injectable)(),o(0,(0,c.inject)(u.ExperimentModuleTypes.GIFT_MANAGER)),r("design:paramtypes",[l.GiftManager])],d),t.OverPageVisited=d},36312:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BenefitsClient=t.BenefitsList=void 0;const s=n(86700),c=n(93158),u=n(82730),l=n(37050),d=n(99490),h=n(26469),f=n(99841),p=n(18313),_=n(73266);!function(e){e.EXTENDED_COUNTRIES_LIST="extended_countries_list"}(t.BenefitsList||(t.BenefitsList={}));let E=class{constructor(e,t,n,i){this.api=e,this.httpClient=t,this.requestsInterceptor=n,this.extension=i}benefits(){return a(this,void 0,void 0,(function*(){const e=this.extension.manifest().version,t=this.endpoint(`/benefits?version=${e}`);return this.httpClient.get(t,{},{skipInterceptor:!0})}))}testMyLuckGetMeSomeGifts(){return a(this,void 0,void 0,(function*(){const e=this.extension.manifest().version,t=this.endpoint(`/benefits/get?version=${e}`),n=new Headers,i=this.requestsInterceptor.getAuthToken();n.append("authorization",`Bearer ${i}`);const r={headers:n},o=yield this.httpClient.post(t,{clientApp:{name:"URBAN_VPN_BROWSER_EXTENSION"}},r,{rawResponse:!0,skipInterceptor:!0,skipFailHandler:!0}),a=o.headers.get("Date");return{time:d.DateTime.fromHTTP(a).toMillis(),response:yield o.json()}}))}endpoint(e){return`${this.api}${e}`}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(c.ExperimentModuleTypes.BENEFITS_API)),o(1,(0,s.inject)(l.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(2,(0,s.inject)(f.AUTH_MODULE_TYPES.AUTH_REQUESTS_INTERCEPTOR)),o(3,(0,s.inject)(p.MARIO_TYPES.EXTENSION_SERVICE)),r("design:paramtypes",[String,u.HttpClient,h.RequestsInterceptor,_.Extension])],E),t.BenefitsClient=E},13104:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GiftManager=void 0;const s=n(86700),c=n(36312),u=n(93158),l=n(80150),d=n(18313),h=n(45103),f=n(99841),p=n(65215),_=n(67156),E=n(99490),y=n(17316),v=n(48476),g=n(98948),S=n(82325),T=n(89816),O=n(17418),m=n(18083),A=n(35678),R=n(63642);let P=class{constructor(e,t,n,i,r,o,a,s,c,u,l,d,h,f,p){this.alarm=e,this.client=t,this.currentUser=n,this.dispatcher=i,this.storage=r,this.logger=o,this.veteranPackageId=a,this.shiftEndCampaignTimeOn=s,this.analytics=c,this.extension=u,this.uninstallUrl=l,this.uninstallKeepTime=d,this.panalyticsId=h,this.locationService=f,this.pollingExperimentsEachSeconds=p}onCampaignEnded(){return a(this,void 0,void 0,(function*(){this.logger.log("GiftManager: onCampaignEnded");let e=!1;const t=yield this.storage.getGifts();Object.values(t).filter((e=>e.active&&this.isGiftEnded(e))).forEach((t=>{e=!0,t.active=!1,this.storage.replaceGift(t).then()})),e&&(yield this.resetState())}))}setupAlarms(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.getGifts();Object.values(e).filter((e=>e.active)).forEach((e=>this.createAlarm(e)))}))}setupUninstallUrl(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.getGifts(),t=[],n=[];Object.values(e).filter((e=>this.isGiftEndedButStillNeedForUninstall(e))).sort(((e,t)=>e.name>t.name?-1:1)).forEach((e=>{t.push(e.name),n.push(e.received?"gift_received":"gift_not_received")}));const i=this.extension.manifest().version,r=this.panalyticsId.getId();let o=`${this.uninstallUrl}?cid=${r}&v=${i}&experiments=${t.join(",")}&groups=${n.join(",")}`;this.extension.setUninstallURL(o)}))}onStartUp(){return a(this,void 0,void 0,(function*(){if(yield this.setupPolling(),!this.currentUser.isAnonymousUser()||this.isVeteran())return this.logger.log("GiftManager: gifts are skipped due a user is not anonymous"),void(yield this.setupUninstallUrl());const e=yield this.getBenefitsWithOpenRegistration();if(this.logger.log("GiftManager: benefits",e),0===e.length)return void this.logger.log("GiftManager: No benefits");let t=!1;for(const n of e){if(!(yield this.storage.hasGift(n.name))){t=!0;break}if(!(yield this.storage.getGift(n.name)).active){t=!0;break}}if(this.logger.log(`GiftManager: need test my luck: ${t}`),t){const t=yield this.client.testMyLuckGetMeSomeGifts(),{time:n,response:i}=t,r=E.DateTime.local().toMillis(),o=y.DateTimeShifter.shift(r,n);let a=!1;for(const t of e){if((yield this.storage.hasGift(t.name))&&(yield this.storage.getGift(t.name)).active){this.logger.log(`GiftManager: a gift is already active "${t.name}"`);continue}const e={active:!0,received:i.userBenefits.includes(t.name),name:t.name,campaignEndAt:t.endsAt,congratulationsPageVisited:!1,overPageVisited:!1};if(o){const t={milliseconds:o};this.logger.log(`GiftManager: time is shifted on "${o}" milliseconds`),e.campaignEndAt=E.DateTime.fromSeconds(e.campaignEndAt).plus(t).toSeconds()}yield this.storage.replaceGift(e),e.received&&(a=!0),this.createAlarm(e),this.analytics.trackExperimentGiftPackage(t.name,e.received?m.ExperimentGiftPackagePhase.RECEIVED:m.ExperimentGiftPackagePhase.NOT_RECEIVED)}a&&(yield this.resetState())}yield this.setupUninstallUrl()}))}congratulationsPageVisited(e){return a(this,void 0,void 0,(function*(){const t=yield this.storage.getGift(e);t.congratulationsPageVisited=!0,yield this.storage.replaceGift(t)}))}overPageVisited(e){return a(this,void 0,void 0,(function*(){const t=yield this.storage.getGift(e);t.overPageVisited=!0,yield this.storage.replaceGift(t)}))}resetState(){return a(this,void 0,void 0,(function*(){const e=new d.MarioEvent(v.AuthModuleEvents.REFRESH_ACCESS_SECURITY_TOKEN);yield this.dispatcher.emit(e),yield this.locationService.removeEarth()}))}getBenefitsWithOpenRegistration(){return a(this,void 0,void 0,(function*(){return(yield this.client.benefits()).items.filter((e=>e.active&&e.registrationOpen))}))}isVeteran(){return this.currentUser.getSecurityToken().package.id===this.veteranPackageId}createAlarm(e){const t={when:E.DateTime.fromSeconds(e.campaignEndAt).plus({seconds:this.shiftEndCampaignTimeOn}).toMillis()};this.logger.log("GiftManager: alarm created",t),this.alarm.create(t,_.ExperimentModuleAlarms.EXPERIMENT_CAMPAIGN_ENDED)}isGiftEnded(e){return E.DateTime.fromSeconds(e.campaignEndAt)<E.DateTime.local()}isGiftEndedButStillNeedForUninstall(e){const t={minutes:this.uninstallKeepTime};return E.DateTime.fromSeconds(e.campaignEndAt).plus(t)>E.DateTime.local()}setupPolling(){return a(this,void 0,void 0,(function*(){const e={when:E.DateTime.local().plus({seconds:this.pollingExperimentsEachSeconds}).toMillis()};this.logger.log("GiftManager: new polling at",e),this.alarm.create(e,_.ExperimentModuleAlarms.EXPERIMENT_POLLING)}))}};P=i([(0,s.injectable)(),o(0,(0,s.inject)(d.MARIO_TYPES.ALARM_SERVICE)),o(1,(0,s.inject)(u.ExperimentModuleTypes.BENEFITS_CLIENT)),o(2,(0,s.inject)(f.AUTH_MODULE_TYPES.CURRENT_USER)),o(3,(0,s.inject)(d.MARIO_TYPES.INTERNAL_DISPATCHER)),o(4,(0,s.inject)(u.ExperimentModuleTypes.GIFT_STORAGE)),o(5,(0,s.inject)(d.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,s.inject)(u.ExperimentModuleTypes.VETERAN_PACKAGE_ID)),o(7,(0,s.inject)(u.ExperimentModuleTypes.SHIFT_END_CAMPAIGN_TIME_ON)),o(8,(0,s.inject)(O.AnalyticsModuleTypes.ANALYTICS)),o(9,(0,s.inject)(d.MARIO_TYPES.EXTENSION_SERVICE)),o(10,(0,s.inject)(u.ExperimentModuleTypes.UNINSTALL_URL)),o(11,(0,s.inject)(u.ExperimentModuleTypes.UNINSTALL_KEEP_TIME)),o(12,(0,s.inject)(R.PanalyticsIdentityTypes.PANALYTICS_SERVICE)),o(13,(0,s.inject)(S.LocationModuleTypes.LOCATION_SERVICE)),o(14,(0,s.inject)(u.ExperimentModuleTypes.POLLING_EXPERIMENTS_EACH_SECONDS)),r("design:paramtypes",[p.AlarmService,c.BenefitsClient,h.CurrentUser,Object,l.GiftStorage,Object,String,Number,T.Analytics,Object,String,Number,A.PanalyticsService,g.LocationService,Number])],P),t.GiftManager=P},80150:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GiftStorage=void 0;const s=n(86700),c=n(18313),u="GIFTS";let l=class{constructor(e){this.storage=e}hasGift(e){return a(this,void 0,void 0,(function*(){return(yield this.getGifts()).hasOwnProperty(e)}))}getGift(e){return a(this,void 0,void 0,(function*(){if(!(yield this.hasGift(e)))throw new Error(`GiftStorage: a gift "${e}" is not exist`);return(yield this.getGifts())[e]}))}addGift(e){return a(this,void 0,void 0,(function*(){if(yield this.hasGift(e.name))throw new Error(`GiftStorage: a gift "${e.name}" is already exist`);const t=yield this.getGifts();t[e.name]=e,yield this.updateGifts(t)}))}replaceGift(e){return a(this,void 0,void 0,(function*(){const t=yield this.getGifts();t[e.name]=e,yield this.updateGifts(t)}))}updateGifts(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);yield this.storage.set(u,t)}))}getGifts(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(u);return e?JSON.parse(e):{}}))}};l=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],l),t.GiftStorage=l},48258:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationModule=void 0;const r=n(18313),o=n(15035),a=n(82325),s=n(98948),c=n(88960),u=n(72012),l=n(2854),d=n(942),h=n(38107),f=n(31253),p=n(95082),_=n(17183),E=n(82403),y=n(73892),v=n(75097),g=n(86286),S=n(89918),T=n(93986),O=n(27492),m=n(57960),A=n(71234),R=n(92104),P=n(39694),I=n(15530);class N extends r.MarioModule{constructor(e){super(e),this.proxyService=this.mario().getService(o.ProxyLocationTypes.LOCATION_PROXY_SERVICE)}name(){return"LocationModule"}register(e){return i(this,void 0,void 0,(function*(){this.setupProxyStrategy(),this.registerServices(e),this.registerEventListeners(),yield this.removeActiveLocation(),yield this.clearLocations()}))}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(N,t)}))}registerServices(e){this.mario().container().bind(a.LocationModuleTypes.LOCATION_BY_PASS_DOMAINS).toConstantValue(e.byPass),this.mario().container().bind(a.LocationModuleTypes.REFRESH_TOKEN_FALLBACK_RETRY_DELAY_MS).toConstantValue(e.refreshTokenFallbackRetryDelayMs),this.mario().container().bind(a.LocationModuleTypes.REFRESH_TOKEN_SHIFT_EXPIRATION_TIME_SECONDS).toConstantValue(e.refreshTokenFallbackShiftExpirationTimeSeconds),this.mario().container().bind(a.LocationModuleTypes.REFRESH_TOKEN_SHIFT_ALARM_SHIFT_EXPIRATION_TIME_MINUTES).toConstantValue(e.refreshTokenAlarmShiftExpirationTimeMinutes),this.mario().registerService(a.LocationModuleTypes.REPEATER,m.Repeater),this.mario().registerService(a.LocationModuleTypes.LOCATION_SERVICE,s.LocationService),this.mario().registerService(a.LocationModuleTypes.LOCATION_HISTORY,c.LocationHistory),this.mario().registerService(a.LocationModuleTypes.LOCATION_STORAGE,u.LocationStorage),this.mario().registerService(a.LocationModuleTypes.CREDENTIALS_HOLDER,l.CredentialsHolder),this.mario().registerService(a.LocationModuleTypes.LOCATION_SIGNATURE_HELPER,O.LocationSignatureHelper),this.setupTokenManager(),this.mario().registerService(a.LocationModuleTypes.CONNECTION_VERIFICATION_SERVICE,p.ConnectionVerificationService),this.mario().registerService(a.LocationModuleTypes.ALARM_MANAGER,v.AlarmManager)}registerEventListeners(){this.mario().internalDispatcher().on(d.RefreshProxyTokenListener),this.mario().internalDispatcher().on(f.ProxyErrorListener),this.mario().internalDispatcher().on(_.LocationActivatedBefore),this.mario().internalDispatcher().on(E.ProxyActivatedBefore),this.mario().internalDispatcher().on(T.ProxyActivatedAfter),this.mario().internalDispatcher().on(y.LocationDeactivatedAfter),this.mario().internalDispatcher().on(P.PreRepairConnection),this.mario().internalDispatcher().on(A.RepairConnection),this.mario().internalDispatcher().on(R.WebRequestErrors)}setupProxyStrategy(){const e=new I.RedundancyWeightStrategy;this.proxyService.setStrategy(e)}setupTokenManager(){const e={AUTO_SERVER:this.mario().container().resolve(g.AutoServerTokenStrategy),LOCATION:this.mario().container().resolve(S.LocationTokenStrategy)};this.mario().container().bind(a.LocationModuleTypes.TOKEN_MANAGERS).toConstantValue(e),this.mario().registerService(a.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER,h.ProxyAuthTokenManager)}removeActiveLocation(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(a.LocationModuleTypes.LOCATION_STORAGE);yield e.removeActivationTime()}))}clearLocations(){return i(this,void 0,void 0,(function*(){const e=this.mario().getService(a.LocationModuleTypes.LOCATION_STORAGE);yield e.removeEarth()}))}}t.LocationModule=N},44110:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationModuleEvents=void 0,function(e){e.ACTIVE_LOCATION_NOT_AVAILABLE="ACTIVE_LOCATION_NOT_AVAILABLE",e.COULD_NOT_ACTIVATE_LOCATION="COULD_NOT_ACTIVATE_LOCATION",e.TIME_SHIFTED="TIME_SHIFTED",e.PRE_REPAIR_CONNECTION="PRE_REPAIR_CONNECTION",e.REPAIR_CONNECTION="REPAIR_CONNECTION",e.REPAIR_CONNECTION_RESULT="REPAIR_CONNECTION_RESULT",e.IP_ADDRESS_CHANGED="IP_ADDRESS_CHANGED",e.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY="COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY"}(t.LocationModuleEvents||(t.LocationModuleEvents={}))},82325:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationModuleTypes=void 0,t.LocationModuleTypes={ALARM_MANAGER:Symbol.for("LOCATION_ALARM_MANAGER"),LOCATION_SERVICE:Symbol.for("LOCATION_SERVICE"),LOCATION_HISTORY:Symbol.for("LOCATION_HISTORY"),LOCATION_STORAGE:Symbol.for("LOCATION_STORAGE"),LOCATION_SIGNATURE_HELPER:Symbol.for("LOCATION_SIGNATURE_HELPER"),LOCATION_BY_PASS_DOMAINS:Symbol.for("LOCATION_BY_PASS_DOMAINS"),CREDENTIALS_HOLDER:Symbol.for("CREDENTIALS_HOLDER"),PROXY_AUTH_TOKEN_MANAGER:Symbol.for("PROXY_AUTH_TOKEN_MANAGER"),TOKEN_MANAGERS:Symbol.for("TOKEN_MANAGERS"),REPEATER:Symbol.for("LOCATION_MODULE_REPEATER"),REFRESH_TOKEN_FALLBACK_RETRY_DELAY_MS:Symbol.for("REFRESH_TOKEN_FALLBACK_RETRY_DELAY_MS"),REFRESH_TOKEN_SHIFT_EXPIRATION_TIME_SECONDS:Symbol.for("REFRESH_TOKEN_SHIFT_EXPIRATION_TIME_SECONDS"),REFRESH_TOKEN_SHIFT_ALARM_SHIFT_EXPIRATION_TIME_MINUTES:Symbol.for("REFRESH_TOKEN_SHIFT_ALARM_SHIFT_EXPIRATION_TIME_MINUTES"),CONNECTION_VERIFICATION_SERVICE:Symbol.for("CONNECTION_VERIFICATION_SERVICE")}},34006:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationStorageKeys=void 0,function(e){e.ACTIVE="LOCATION_STORAGE_ACTIVE",e.ACTIVATION_TIME="LOCATION_STORAGE_ACTIVATION_TIME",e.EARTH="LOCATION_STORAGE_EARTH",e.EARTH_SYNC_TIME="LOCATION_STORAGE_EARTH_SYNC_TIME",e.PREV="LOCATION_STORAGE_PREV"}(t.LocationStorageKeys||(t.LocationStorageKeys={}))},26656:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationAlarms=void 0,function(e){e.REFRESH_PROXY_TOKEN="REFRESH_PROXY_TOKEN"}(t.LocationAlarms||(t.LocationAlarms={}))},53511:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationProvider=void 0,function(e){e.GENERIC="GENERIC",e.AUTO_SERVER="AUTO_SERVER",e.STREAMING_SERVICE="STREAMING_SERVICE"}(t.LocationProvider||(t.LocationProvider={}))},72032:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationType=void 0,function(e){e.ACCESSIBLE="ACCESSIBLE",e.RANDOM="RANDOM",e.INACCESSIBLE="INACCESSIBLE"}(t.LocationType||(t.LocationType={}))},17183:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationActivatedBefore=void 0;const s=n(86700),c=n(83105),u=n(82325),l=n(38107);let d=class{constructor(e){this.tokenManager=e}on(){return c.ProxyLocationEvents.PROXY_LOCATION_BEFORE_ACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.location;this.tokenManager.setActiveLocation(t)}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(u.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[l.ProxyAuthTokenManager])],d),t.LocationActivatedBefore=d},73892:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationDeactivatedAfter=void 0;const s=n(86700),c=n(18313),u=n(83105),l=n(95950),d=n(22934),h=n(26656),f=n(2854),p=n(82325),_=n(83088),E=n(93520);let y=class{constructor(e,t,n,i){this.appState=e,this.alarm=t,this.credentials=n,this.hideLocationService=i}on(){return u.ProxyLocationEvents.PROXY_LOCATION_AFTER_DEACTIVATED}handle(e){return a(this,void 0,void 0,(function*(){this.hideLocationService.disable(),this.credentials.reset(),yield this.alarm.clear(h.LocationAlarms.REFRESH_PROXY_TOKEN),this.appState.setStateDirectMode()}))}};y=i([(0,s.injectable)(),o(0,(0,s.inject)(_.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.ALARM_SERVICE)),o(2,(0,s.inject)(p.LocationModuleTypes.CREDENTIALS_HOLDER)),o(3,(0,s.inject)(l.HideMyLocationTypes.HIDE_MY_LOCATION_SERVICE)),r("design:paramtypes",[E.AppService,Object,f.CredentialsHolder,d.HideMyGeoLocationService])],y),t.LocationDeactivatedAfter=y},93986:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyActivatedAfter=void 0;const s=n(18313),c=n(86700),u=n(38107),l=n(82325),d=n(81732),h=n(44110),f=n(95082),p=n(75097),_=n(2854);let E=class{constructor(e,t,n,i,r,o,a){this.alarmManager=e,this.connection=t,this.credentials=n,this.dispatcher=i,this.logger=r,this.tokenManager=o,this.proxy=a}on(){return d.ProxyEvents.PROXY_AFTER_CONNECT}handle(e){return a(this,void 0,void 0,(function*(){try{this.logger.log("Connection verification");if(yield this.connection.verifyProxyConnection())return this.logger.log("Connection is established"),void this.alarmManager.setup();this.logger.warn("Connection is not established"),yield this.tokenManager.tryFixConnection(),this.alarmManager.setup()}catch(e){yield this.proxy.direct(!1);const t={location:this.tokenManager.getActiveLocation()};this.credentials.reset(),this.tokenManager.reset();const n=new s.MarioEvent(h.LocationModuleEvents.COULD_NOT_ACTIVATE_LOCATION,t);throw this.dispatcher.emit(n).then(),e}}))}};E=i([(0,c.injectable)(),o(0,(0,c.inject)(l.LocationModuleTypes.ALARM_MANAGER)),o(1,(0,c.inject)(l.LocationModuleTypes.CONNECTION_VERIFICATION_SERVICE)),o(2,(0,c.inject)(l.LocationModuleTypes.CREDENTIALS_HOLDER)),o(3,(0,c.inject)(s.MARIO_TYPES.INTERNAL_DISPATCHER)),o(4,(0,c.inject)(s.MARIO_TYPES.LOGGER_SERVICE)),o(5,(0,c.inject)(l.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),o(6,(0,c.inject)(s.MARIO_TYPES.PROXY_SERVICE)),r("design:paramtypes",[p.AlarmManager,f.ConnectionVerificationService,_.CredentialsHolder,Object,Object,u.ProxyAuthTokenManager,Object])],E),t.ProxyActivatedAfter=E},82403:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyActivatedBefore=void 0;const s=n(86700),c=n(18313),u=n(81732),l=n(98948),d=n(82325),h=n(38107),f=n(44110),p=n(2854);let _=class{constructor(e,t,n,i,r,o){this.credentials=e,this.dispatcher=t,this.locationService=n,this.logger=i,this.tokenManager=r,this.proxy=o}on(){return u.ProxyEvents.PROXY_BEFORE_CONNECT}handle(e){return a(this,void 0,void 0,(function*(){const t=e.data.proxyServer;try{this.tokenManager.setProxyServer(t),yield this.tokenManager.initToken()}catch(e){this.logger.warn(e.message),yield this.proxy.direct(!1);const t={location:this.tokenManager.getActiveLocation()},n=new c.MarioEvent(f.LocationModuleEvents.COULD_NOT_ACTIVATE_LOCATION,t);throw this.dispatcher.emit(n).then(),this.credentials.reset(),this.tokenManager.reset(),yield this.locationService.cleanActivatedLocation(),e}}))}};_=i([(0,s.injectable)(),o(0,(0,s.inject)(d.LocationModuleTypes.CREDENTIALS_HOLDER)),o(1,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(2,(0,s.inject)(d.LocationModuleTypes.LOCATION_SERVICE)),o(3,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(4,(0,s.inject)(d.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),o(5,(0,s.inject)(c.MARIO_TYPES.PROXY_SERVICE)),r("design:paramtypes",[p.CredentialsHolder,Object,l.LocationService,Object,h.ProxyAuthTokenManager,Object])],_),t.ProxyActivatedBefore=_},31253:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyErrorListener=void 0;const s=n(86700),c=n(18313),u=n(81732);let l=class{constructor(e){this.logger=e}on(){return u.ProxyEvents.PROXY_ERROR}handle(e){return a(this,void 0,void 0,(function*(){e.data.error}))}};l=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object])],l),t.ProxyErrorListener=l},942:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RefreshProxyTokenListener=void 0;const s=n(18313),c=n(86700),u=n(14874),l=n(2854),d=n(82325),h=n(26656),f=n(38107),p=n(98948),_=n(44110),E=n(75097),y=n(95082),v=n(83088),g=n(93520);let S=class{constructor(e,t,n,i,r,o,a,s,c){this.appState=e,this.alarmManager=t,this.connection=n,this.credentials=i,this.dispatcher=r,this.logger=o,this.locationService=a,this.tokenManager=s,this.proxy=c}on(){return u.AlarmEvents.ALARM_ELAPSED}handle(e){return a(this,void 0,void 0,(function*(){const{name:t}=e.data;if(t===h.LocationAlarms.REFRESH_PROXY_TOKEN)try{this.appState.setStateRefreshingToken(),yield this.tokenManager.refreshToken(),this.alarmManager.setup(),this.appState.setStateProxyConnected()}catch(e){const t=this.tokenManager.getActiveLocation();yield this.proxy.direct(!1);const n=new s.MarioEvent(_.LocationModuleEvents.ACTIVE_LOCATION_NOT_AVAILABLE,{location:t});yield this.locationService.cleanActivatedLocation(),this.dispatcher.emit(n).then(),this.credentials.reset(),this.tokenManager.reset(),this.appState.setStateDirectMode(),this.logger.error(e)}}))}};S=i([(0,c.injectable)(),o(0,(0,c.inject)(v.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,c.inject)(d.LocationModuleTypes.ALARM_MANAGER)),o(2,(0,c.inject)(d.LocationModuleTypes.CONNECTION_VERIFICATION_SERVICE)),o(3,(0,c.inject)(d.LocationModuleTypes.CREDENTIALS_HOLDER)),o(4,(0,c.inject)(s.MARIO_TYPES.INTERNAL_DISPATCHER)),o(5,(0,c.inject)(s.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,c.inject)(d.LocationModuleTypes.LOCATION_SERVICE)),o(7,(0,c.inject)(d.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),o(8,(0,c.inject)(s.MARIO_TYPES.PROXY_SERVICE)),r("design:paramtypes",[g.AppService,E.AlarmManager,y.ConnectionVerificationService,l.CredentialsHolder,Object,Object,p.LocationService,f.ProxyAuthTokenManager,Object])],S),t.RefreshProxyTokenListener=S},92104:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRequestErrors=void 0;const s=n(86700),c=n(18313),u=n(76560),l=n(83088),d=n(93520),h=n(44110),f=n(57513),p=n(82325),_=n(38107);let E=class{constructor(e,t,n){this.appState=e,this.internalDispatcher=t,this.tokenManager=n}on(){return u.WebRequestServiceEvents.WEB_REQUEST_ON_ERROR_OCCURRED}handle(e){return a(this,void 0,void 0,(function*(){if(!this.appState.isProxyConnected())return;const{details:t}=e.data;if(t.error.includes("NS_ERROR_PROXY_CONNECTION_REFUSED")){const e={reason:f.RepairConnectionReason.CONNECTION_REFUSED,proxy:this.tokenManager.getProxyServer()},t=new c.MarioEvent(h.LocationModuleEvents.REPAIR_CONNECTION,e);this.internalDispatcher.emit(t).then()}}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(l.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(2,(0,s.inject)(p.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[d.AppService,Object,_.ProxyAuthTokenManager])],E),t.WebRequestErrors=E},39694:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PreRepairConnection=void 0;const s=n(18313),c=n(86700),u=n(44110),l=n(38107),d=n(82325);let h=class{constructor(e,t){this.dispatcher=e,this.tokenManager=t}on(){return u.LocationModuleEvents.PRE_REPAIR_CONNECTION}handle(e){return a(this,void 0,void 0,(function*(){const{reason:t}=e.data,n={reason:t,proxy:this.tokenManager.getProxyServer()},i=new s.MarioEvent(u.LocationModuleEvents.REPAIR_CONNECTION,n);this.dispatcher.emit(i).then()}))}};h=i([(0,c.injectable)(),o(0,(0,c.inject)(s.MARIO_TYPES.INTERNAL_DISPATCHER)),o(1,(0,c.inject)(d.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),r("design:paramtypes",[Object,l.ProxyAuthTokenManager])],h),t.PreRepairConnection=h},71234:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RepairConnection=void 0;const s=n(18313),c=n(86700),u=n(44110),l=n(38107),d=n(83088),h=n(93520),f=n(82325),p=n(75097),_=n(98948),E=n(95082),y=n(2854),v=n(15035),g=n(33770),S=n(53511),T=n(18083),O=n(75357),m=n(16437);let A=class{constructor(e,t,n,i,r,o,a,s,c,u){this.appState=e,this.alarmManager=t,this.connection=n,this.credentials=i,this.dispatcher=r,this.logger=o,this.locationService=a,this.tokenManager=s,this.proxy=c,this.locationHelper=u}on(){return u.LocationModuleEvents.REPAIR_CONNECTION}handle(e){return a(this,void 0,void 0,(function*(){if(!this.appState.isProxyConnected())return;this.appState.setStateProxyRepairing(),this.logger.log("RepairConnection: handling");const e={status:!0,proxy:null,msg:""},t=new s.MarioEvent(u.LocationModuleEvents.REPAIR_CONNECTION_RESULT,e);try{yield this.alarmManager.clear(),yield this.tokenManager.tryFixConnection(),this.alarmManager.setup(),e.proxy=this.tokenManager.getProxyServer(),this.appState.setStateProxyConnected(),this.trackAnalytics(e.proxy)}catch(t){this.logger.log("RepairConnection: Could not Repair connection"),e.status=!1,yield this.proxy.direct(!1),yield this.locationService.cleanActivatedLocation(),yield this.appState.setStateDirectMode(),yield this.alarmManager.clear(),e.msg=t.message,this.credentials.reset(),this.tokenManager.reset(),this.logger.error(t)}this.dispatcher.emit(t).then()}))}trackAnalytics(e){return a(this,void 0,void 0,(function*(){const t=this.tokenManager.getActiveLocation().code().value(),n=this.locationHelper.getCountryName(t,S.LocationProvider.AUTO_SERVER),i={eventId:T.EventList.LOCATION_STARTED,manual:!1,details:{SOURCE:T.SourceList.SYSTEM,CONNECTION_RESULT:T.LocationStartedResult.success,CONNECTION_TYPE:T.LocationStartedType.present,HOST:(0,O.makeHost)(e),COUNTRY:n,CODE:t}},r=new s.MarioEvent(m.PopupEventsOut.TRACK_ACTION,i);this.dispatcher.emit(r)}))}};A=i([(0,c.injectable)(),o(0,(0,c.inject)(d.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,c.inject)(f.LocationModuleTypes.ALARM_MANAGER)),o(2,(0,c.inject)(f.LocationModuleTypes.CONNECTION_VERIFICATION_SERVICE)),o(3,(0,c.inject)(f.LocationModuleTypes.CREDENTIALS_HOLDER)),o(4,(0,c.inject)(s.MARIO_TYPES.INTERNAL_DISPATCHER)),o(5,(0,c.inject)(s.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,c.inject)(f.LocationModuleTypes.LOCATION_SERVICE)),o(7,(0,c.inject)(f.LocationModuleTypes.PROXY_AUTH_TOKEN_MANAGER)),o(8,(0,c.inject)(s.MARIO_TYPES.PROXY_SERVICE)),o(9,(0,c.inject)(v.ProxyLocationTypes.LOCATION_HELPER_SERVICE)),r("design:paramtypes",[h.AppService,p.AlarmManager,E.ConnectionVerificationService,y.CredentialsHolder,Object,Object,_.LocationService,l.ProxyAuthTokenManager,Object,g.LocationHelper])],A),t.RepairConnection=A},57513:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepairConnectionReason=void 0,function(e){e.TOKEN_EXPIRED="TOKEN_EXPIRED",e.UNEXPECTED_AUTH_REQUEST="UNEXPECTED_AUTH_REQUEST",e.CONNECTION_REFUSED="CONNECTION_REFUSED"}(t.RepairConnectionReason||(t.RepairConnectionReason={}))},75097:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AlarmManager=void 0;const a=n(86700),s=n(99490),c=n(18313),u=n(82325),l=n(26656),d=n(2854);let h=class{constructor(e,t,n,i){this.alarm=e,this.shiftMinutes=t,this.credentialsHolder=n,this.logger=i}setup(){this.logger.log("AlarmManager: setup auto refreshing an auth proxy token");const e=this.credentialsHolder.getAuthProxyToken(),t={minutes:this.shiftMinutes},n=s.DateTime.fromMillis(e.expirationTime).minus(t);this.logger.log(`AlarmManager: refresh proxy token at ${n}`);const i={when:n.toMillis()};this.alarm.create(i,l.LocationAlarms.REFRESH_PROXY_TOKEN)}clear(){return this.alarm.clear(l.LocationAlarms.REFRESH_PROXY_TOKEN)}};h=i([(0,a.injectable)(),o(0,(0,a.inject)(c.MARIO_TYPES.ALARM_SERVICE)),o(1,(0,a.inject)(u.LocationModuleTypes.REFRESH_TOKEN_SHIFT_ALARM_SHIFT_EXPIRATION_TIME_MINUTES)),o(2,(0,a.inject)(u.LocationModuleTypes.CREDENTIALS_HOLDER)),o(3,(0,a.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object,Number,d.CredentialsHolder,Object])],h),t.AlarmManager=h},2854:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.CredentialsHolder=void 0;const s=n(86700),c=n(18313),u=n(75454),l=n(99832),d=n(44110),h=n(83088),f=n(93520),p=n(99490),_=n(57513);let E=class{constructor(e,t,n,i,r){this.appState=e,this.proxyNative=t,this.logger=n,this.securityService=i,this.internalDispatcher=r,this.hasCredentials=!1}setAuthProxyToken(e){return a(this,void 0,void 0,(function*(){this.hasCredentials=!0,this.authToken=e;this.proxyNative.onAuthRequired((()=>{var e,t;if(this.logger.log(`CredentialsHolder: App State = ${this.appState.getState()}`),this.appState.isProxyConnected()){const e=p.DateTime.local().toMillis();this.getAuthProxyToken().expirationTime<e?this.emitRepairConnectionEvent(_.RepairConnectionReason.TOKEN_EXPIRED):this.emitRepairConnectionEvent(_.RepairConnectionReason.UNEXPECTED_AUTH_REQUEST)}return this.logger.log("onAuthRequired: "+(null===(e=this.authToken)||void 0===e?void 0:e.value),this.authToken),{username:this.authToken?null===(t=this.authToken)||void 0===t?void 0:t.value:"",password:"1"}}),{urls:["<all_urls>"]},["blocking"],!0)}))}getAuthProxyToken(){return this.authToken}hasAuthProxyToken(){return this.hasCredentials}reset(){this.hasCredentials=!1,this.proxyNative.removeAuthRequiredListener()}emitRepairConnectionEvent(e){const t={reason:e},n=new c.MarioEvent(d.LocationModuleEvents.PRE_REPAIR_CONNECTION,t);this.internalDispatcher.emit(n).then()}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(h.UrbanTypes.URBAN_APP_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.PROXY_SERVICE)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(3,(0,s.inject)(u.SecurityModuleTypes.SECURITY_SERVICE)),o(4,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[f.AppService,Object,Object,l.SecurityService,Object])],E),t.CredentialsHolder=E},88960:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationHistory=void 0;const r=n(86700);let o=class{};o=i([(0,r.injectable)()],o),t.LocationHistory=o},98948:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationService=void 0;const s=n(86700),c=n(80237),u=n(15035),l=n(10674),d=n(55154),h=n(71560),f=n(82325),p=n(72012),_=n(45103),E=n(99841),y=n(72032),v=n(18313),g=n(99490),S=n(88376),T=n(53511),O=n(15604);let m=class{constructor(e,t,n,i,r,o){this.api=e,this.byPassList=t,this.currentUser=n,this.storage=i,this.logger=r,this.proxy=o}getEarth(){return a(this,void 0,void 0,(function*(){this.logger.log("LocationService: get earth");let e=!1;if(yield this.storage.hasNotEarth())this.logger.log("LocationService: earth is empty need sync"),e=!0;else{const t=yield this.storage.getEarthSyncTime(),n=g.DateTime.fromSeconds(t).plus({minutes:30});e=g.DateTime.local()>n,this.logger.log(`LocationService: last sync time: ${g.DateTime.fromSeconds(t)}`),this.logger.log(`LocationService: expiration time: ${n}`),this.logger.log(`LocationService: need sync earth: ${e}`)}if(e){yield this.storage.removeEarth();try{const e=yield this.api.getCountries(!1);if(e.isEmpty())throw new Error("LocationService: response does not have countries");const t=yield this.make(e),n=g.DateTime.local();return this.logger.log(`LocationService: earth is synced. Time: ${n}`),yield this.storage.storeEarthSyncTime(n.toSeconds()),yield this.storage.storeEarth(t),t}catch(e){this.logger.error(e)}}if(yield this.storage.hasNotEarth())throw new Error("LocationService: could not sync earth");return this.storage.getEarth()}))}hasEarth(){return this.storage.hasEarth()}removeEarth(){return a(this,void 0,void 0,(function*(){this.logger.log("LocationService: remove earth"),yield this.storage.removeEarth()}))}getLocation(){return a(this,void 0,void 0,(function*(){if(this.logger.log("LocationService: get location"),yield this.storage.hasActive()){const e=yield this.storage.getActive();if(this.logger.log(`LocationService: has prev "${e.code().value()}"`),e.isProvider(T.LocationProvider.AUTO_SERVER)){if(this.currentUser.hasAutoServerFeature())return e}else{const t=yield this.getEarth();if(t.hasLocation(e.code())&&t.getLocation(e.code()).isType(y.LocationType.ACCESSIBLE))return e}}if(this.currentUser.hasAutoServerFeature())return O.LocationServiceHelpers.generateAutoServerLocation();const e=yield this.getEarth(),t=new l.LocationCode("US");if(e.hasLocation(t)&&e.getLocation(t).isType(y.LocationType.ACCESSIBLE))return e.getLocation(t);if(!e.isEmpty())for(const t of e)if(t.isType(y.LocationType.ACCESSIBLE))return t}))}activate(e,t){return a(this,void 0,void 0,(function*(){let n;if(e===T.LocationProvider.AUTO_SERVER)n=yield this.api.getAutoServer(!1);else{const e=new l.LocationCode(t);n=(yield this.getEarth()).getLocation(e)}try{yield this.storage.storeActive(n),yield this.proxy.activate(n,this.byPassList),yield this.storage.storeActivationTime(g.DateTime.local().toSeconds())}catch(e){throw this.logger.log(`LocationService: ${e.message}`),this.logger.warn("Could not activate proxy"),e}}))}selectProxy(e){return a(this,void 0,void 0,(function*(){return this.proxy.selectProxy(e)}))}deactivate(){return a(this,void 0,void 0,(function*(){yield this.proxy.deactivate(),yield this.cleanActivatedLocation()}))}cleanActivatedLocation(){return a(this,void 0,void 0,(function*(){yield this.storage.removeActivationTime()}))}removeProxyFromLocation(e,t){return a(this,void 0,void 0,(function*(){this.logger.log(`LocationService: remove proxy from the Earth ${S.ProxySignature.buildKey(t)}`);const n=yield this.getEarth(),i=this.findLocationPos(e,n);if(-1===i)return this.logger.warn("LocationService: could not find a pos"),!1;const r=c.ProxyLocation.decode(JSON.stringify(n.pos(i)));if(r.type()!==y.LocationType.ACCESSIBLE)return!1;const o=r.configList().filter((e=>{const n={scheme:e.scheme().value(),host:e.host().value(),port:e.portRange().from()};return S.ProxySignature.buildKey(t)!==S.ProxySignature.buildKey(n)})),a=c.ProxyLocation.create(r.name().value(),r.code().value(),r.type(),r.provider(),o,r.extraData()),s=o.length>0;return s?n.replace(i,a):n.remove(i),yield this.storage.storeEarth(n),s}))}getActivationTime(){return this.storage.getActivationTime()}make(e){return a(this,void 0,void 0,(function*(){this.logger.log("LocationService: make earth");const t=c.ProxyLocation.create("ROOT","ROOT","ROOT");if(this.currentUser.hasAutoServerFeature()){this.logger.log("LocationService: attach auto server");const e=O.LocationServiceHelpers.generateAutoServerLocation();t.append(e)}else this.logger.log("LocationService: auto server is not available for current user");if(this.currentUser.hasStreamingServicesFeature()){this.logger.log("LocationService: attach streaming services");const e=yield this.api.getStreamingServices(!1);e.isEmpty()&&this.logger.log("LocationService: streaming services list is empty");for(const n of e){let e=!1;if(n.isType(y.LocationType.ACCESSIBLE)&&n.configList().length>0&&(e=!0),e){const e=c.ProxyLocation.decode(JSON.stringify(n));t.append(e)}}}else this.logger.log("LocationService: no streaming services available for current user");for(const n of e){let e=!1;if((n.isType(y.LocationType.ACCESSIBLE)&&n.configList().length>0||n.isType(y.LocationType.INACCESSIBLE)&&this.currentUser.isAnonymousUser())&&(e=!0),e){const e=c.ProxyLocation.decode(JSON.stringify(n));t.append(e)}}return t}))}findLocationPos(e,t){let n=0;for(const i of t){if(i.code().value()===e.value())return n;n++}return-1}};m=i([(0,s.injectable)(),o(0,(0,s.inject)(d.StaticProxiesApiTypes.STATIC_PROXIES_SERVICE)),o(1,(0,s.inject)(f.LocationModuleTypes.LOCATION_BY_PASS_DOMAINS)),o(2,(0,s.inject)(E.AUTH_MODULE_TYPES.CURRENT_USER)),o(3,(0,s.inject)(f.LocationModuleTypes.LOCATION_STORAGE)),o(4,(0,s.inject)(v.MARIO_TYPES.LOGGER_SERVICE)),o(5,(0,s.inject)(u.ProxyLocationTypes.LOCATION_PROXY_SERVICE)),r("design:paramtypes",[h.StaticProxiesService,Array,_.CurrentUser,p.LocationStorage,Object,Object])],m),t.LocationService=m},15604:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationServiceHelpers=void 0;const i=n(80237),r=n(53511),o=n(72032);t.LocationServiceHelpers=class{static generateAutoServerLocation(){return i.ProxyLocation.create("Auto Server","AUTO_SERVER",o.LocationType.RANDOM,r.LocationProvider.AUTO_SERVER)}}},27492:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationSignatureHelper=void 0;const r=n(86700),o=n(88376);let a=class{getSignature(e,t){var n;const i=o.ProxySignature.buildKey(t);return(null===(n=e.extraData())||void 0===n?void 0:n.signatureCollection)[i]}getSignatureWithProxy(e,t){return{signature:this.getSignature(e,t),proxy:t}}};a=i([(0,r.injectable)()],a),t.LocationSignatureHelper=a},57960:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Repeater=void 0;const a=n(86700),s=n(75357),c=n(99490),u=n(82325),l=n(2854),d=n(18313);let h=class{constructor(e,t,n,i){this.credentialsHolder=e,this.logger=t,this.retryDelayMs=n,this.fallbackShiftExpirationTimeSeconds=i}repeat(e,t){return t?(0,s.repeater)(this.expirationTime(),this.retryDelayMs,e,!1):e()}expirationTime(){return c.DateTime.fromMillis(this.credentialsHolder.getAuthProxyToken().expirationTime).minus({seconds:this.fallbackShiftExpirationTimeSeconds})}};h=i([(0,a.injectable)(),o(0,(0,a.inject)(u.LocationModuleTypes.CREDENTIALS_HOLDER)),o(1,(0,a.inject)(d.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,a.inject)(u.LocationModuleTypes.REFRESH_TOKEN_FALLBACK_RETRY_DELAY_MS)),o(3,(0,a.inject)(u.LocationModuleTypes.REFRESH_TOKEN_SHIFT_EXPIRATION_TIME_SECONDS)),r("design:paramtypes",[l.CredentialsHolder,Object,Number,Number])],h),t.Repeater=h},70002:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionVerificationError=void 0;class n extends Error{}t.ConnectionVerificationError=n},95082:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionVerificationService=void 0;const s=n(86700),c=n(18313);let u=class{constructor(e){this.logger=e}hasEthernetConnection(){return window.navigator.onLine}verifyInternetConnection(){return a(this,void 0,void 0,(function*(){return new Promise((e=>{fetch("https://www.google-analytics.com/",{headers:{method:"HEAD",pragma:"no-cache","cache-control":"no-cache, no-store"}}).then((()=>{e(!0)})).catch((()=>{e(!1)}))}))}))}verifyProxyConnection(){return new Promise((e=>{const t=new AbortController,n=t.signal,i=setTimeout((()=>{this.logger.warn("ConnectionVerificationError: timeout"),t.abort(),e(!1)}),3e3);fetch("https://www.google.com/favicon.ico",{signal:n,headers:{method:"HEAD",pragma:"no-cache","cache-control":"no-cache, no-store"}}).then((t=>{clearTimeout(i),e(200===t.status)})).catch((t=>{clearTimeout(i),e(!1)}))}))}};u=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object])],u),t.ConnectionVerificationService=u},38107:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyAuthTokenManager=t.TokenManagerType=void 0;const s=n(86700),c=n(18313),u=n(99490),l=n(2854),d=n(99832),h=n(75454),f=n(82325),p=n(72032),_=n(98948),E=n(69326),y=n(17316),v=n(88376),g=n(95082),S=n(27492),T=n(57960),O=n(44110),m=n(70002),A=n(53511),R=n(15035),P=n(33770),I=n(18083),N=n(75357),b=n(16437);!function(e){e.AUTO_SERVER="AUTO_SERVER",e.LOCATION="LOCATION"}(t.TokenManagerType||(t.TokenManagerType={}));let C=class{constructor(e,t,n,i,r,o,a,s,c,u,l,d){this.byPassList=e,this.credentials=t,this.connection=n,this.dispatcher=i,this.securityService=r,this.logger=o,this.locationService=a,this.helper=s,this.strategies=c,this.proxy=u,this.repeater=l,this.locationHelper=d}setProxyServer(e){this.proxyServer=e}getProxyServer(){return this.proxyServer}setActiveLocation(e){this.location=e}getActiveLocation(){return this.location}initToken(){return a(this,void 0,void 0,(function*(){this.logger.log("ProxyAuthTokenRefresher: init token"),yield this.validOrThrowException();const e=yield this.helper.getSignature(this.location,this.proxyServer),t=yield this.getAuthProxyToken(e,!1);yield this.credentials.setAuthProxyToken(t)}))}tryFixConnection(){return a(this,void 0,void 0,(function*(){this.logger.log("ProxyAuthTokenRefresher: trying fix connection"),yield this.setupToken(!1)}))}refreshToken(){return a(this,void 0,void 0,(function*(){this.logger.log("ProxyAuthTokenRefresher: refresh token"),yield this.setupToken(!0)}))}getAuthProxyToken(e,t){return a(this,void 0,void 0,(function*(){let n;this.logger.log(`ProxyAuthTokenRefresher: signature is "${e}"`);try{n=yield this.getTokenWithRepetition(e,t)}catch(e){throw new E.ProxyAuthTokenManagerError("ProxyAuthTokenRefresher: could not get an auth proxy token")}const{token:i,time:r}=n,o=u.DateTime.local().toMillis(),a=y.DateTimeShifter.shift(o,r);if(a){this.logger.log(`ProxyAuthTokenRefresher: time is shifted on "${a}" milliseconds`);const e={milliseconds:a};i.expirationTime=u.DateTime.fromMillis(i.expirationTime).plus(e).toMillis();const t=new c.MarioEvent(O.LocationModuleEvents.TIME_SHIFTED);this.dispatcher.emit(t).then()}else this.logger.log("ProxyAuthTokenRefresher: no need to shift time");return this.logger.log("ProxyAuthTokenRefresher: proxy token",i),i}))}reset(){this.setProxyServer(null),this.setActiveLocation(null)}setupToken(e){return a(this,void 0,void 0,(function*(){if(yield this.validOrThrowException(),!this.connection.hasEthernetConnection())throw new m.ConnectionVerificationError("ProxyAuthTokenManager: No Ethernet connection");if(!this.connection.verifyInternetConnection())throw new m.ConnectionVerificationError("ProxyAuthTokenManager: No connection with the Internet");const t=this.selectStrategy(),{signature:n,proxy:i}=yield t.refresh(this.location,this.proxyServer,e);this.lastProxy=i;const r=yield this.getAuthProxyToken(n,e);yield this.credentials.setAuthProxyToken(r);const o=v.ProxySignature.buildKey(i)!==v.ProxySignature.buildKey(this.proxyServer);o&&(yield this.proxy.connect(i,this.byPassList,!1),this.proxyServer=i);if(yield this.connection.verifyProxyConnection()){if(o){const e=new c.MarioEvent(O.LocationModuleEvents.IP_ADDRESS_CHANGED);this.dispatcher.emit(e).then()}}else{const n={proxy:this.getProxyServer()},i=new c.MarioEvent(O.LocationModuleEvents.COULD_NOT_ESTABLISH_CONNECTION_WITH_PROXY,n);this.dispatcher.emit(i).then(),this.logger.warn("ProxyAuthTokenRefresher: connection is not established. Run fix protocol");if(!(yield t.removeProxy(this.location.code(),this.proxyServer))){const e=this.location.code().value(),t=this.locationHelper.getCountryName(e,A.LocationProvider.AUTO_SERVER),n={eventId:I.EventList.LOCATION_STARTED,manual:!1,details:{SOURCE:I.SourceList.SYSTEM,CONNECTION_RESULT:I.LocationStartedResult.fail,CONNECTION_TYPE:I.LocationStartedType.present,HOST:(0,N.makeHost)(this.lastProxy),COUNTRY:t,CODE:e}},i=new c.MarioEvent(b.PopupEventsOut.TRACK_ACTION,n);throw this.dispatcher.emit(i),new E.ProxyAuthTokenManagerError("ProxyAuthTokenRefresher: location can not be activated")}yield this.setupToken(e)}}))}selectStrategy(){return this.location.isType(p.LocationType.RANDOM)?this.strategies.AUTO_SERVER:this.strategies.LOCATION}validOrThrowException(){return a(this,void 0,void 0,(function*(){if(!this.proxyServer)throw new E.ProxyAuthTokenManagerError("ProxyAuthTokenRefresher: proxy server is not set");if(!this.location)throw new E.ProxyAuthTokenManagerError("ProxyAuthTokenRefresher: location is not set")}))}getTokenWithRepetition(e,t){return a(this,void 0,void 0,(function*(){return this.repeater.repeat((()=>a(this,void 0,void 0,(function*(){return this.securityService.getAuthProxyToken(e)}))),t)}))}};C=i([(0,s.injectable)(),o(0,(0,s.inject)(f.LocationModuleTypes.LOCATION_BY_PASS_DOMAINS)),o(1,(0,s.inject)(f.LocationModuleTypes.CREDENTIALS_HOLDER)),o(2,(0,s.inject)(f.LocationModuleTypes.CONNECTION_VERIFICATION_SERVICE)),o(3,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),o(4,(0,s.inject)(h.SecurityModuleTypes.SECURITY_SERVICE)),o(5,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),o(6,(0,s.inject)(f.LocationModuleTypes.LOCATION_SERVICE)),o(7,(0,s.inject)(f.LocationModuleTypes.LOCATION_SIGNATURE_HELPER)),o(8,(0,s.inject)(f.LocationModuleTypes.TOKEN_MANAGERS)),o(9,(0,s.inject)(c.MARIO_TYPES.PROXY_SERVICE)),o(10,(0,s.inject)(f.LocationModuleTypes.REPEATER)),o(11,(0,s.inject)(R.ProxyLocationTypes.LOCATION_HELPER_SERVICE)),r("design:paramtypes",[Array,l.CredentialsHolder,g.ConnectionVerificationService,Object,d.SecurityService,Object,_.LocationService,S.LocationSignatureHelper,Object,Object,T.Repeater,P.LocationHelper])],C),t.ProxyAuthTokenManager=C},69326:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyAuthTokenManagerError=void 0;class n extends Error{}t.ProxyAuthTokenManagerError=n},86286:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoServerTokenStrategy=void 0;const s=n(86700),c=n(71560),u=n(55154),l=n(82325),d=n(98948),h=n(27492),f=n(57960);let p=class{constructor(e,t,n,i){this.staticApi=e,this.locationService=t,this.helper=n,this.repeater=i}refresh(e,t,n){return a(this,void 0,void 0,(function*(){e=yield this.getAutoServerWithRepetition(n);const t=yield this.locationService.selectProxy(e);return this.helper.getSignatureWithProxy(e,t)}))}removeProxy(e,t){return a(this,void 0,void 0,(function*(){return!0}))}getAutoServerWithRepetition(e){return a(this,void 0,void 0,(function*(){return this.repeater.repeat((()=>a(this,void 0,void 0,(function*(){return this.staticApi.getAutoServer(!1)}))),e)}))}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(u.StaticProxiesApiTypes.STATIC_PROXIES_SERVICE)),o(1,(0,s.inject)(l.LocationModuleTypes.LOCATION_SERVICE)),o(2,(0,s.inject)(l.LocationModuleTypes.LOCATION_SIGNATURE_HELPER)),o(3,(0,s.inject)(l.LocationModuleTypes.REPEATER)),r("design:paramtypes",[c.StaticProxiesService,d.LocationService,h.LocationSignatureHelper,f.Repeater])],p),t.AutoServerTokenStrategy=p},89918:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationTokenStrategy=void 0;const s=n(86700),c=n(69326),u=n(72032),l=n(82325),d=n(98948),h=n(88376),f=n(18313),p=n(27492),_=n(57960);let E=class{constructor(e,t,n,i){this.locationService=e,this.logger=t,this.helper=n,this.repeater=i}refresh(e,t,n){return a(this,void 0,void 0,(function*(){let i=t;const r=yield this.getEarthWithRepetition(n);if(!r.hasLocation(e.code()))throw new c.ProxyAuthTokenManagerError("Location is not available");const o=r.getLocation(e.code());if(!o.isType(u.LocationType.ACCESSIBLE))throw new c.ProxyAuthTokenManagerError("Location is not accessible");const a=yield this.locationService.selectProxy(o);return h.ProxySignature.buildKey(i)!==h.ProxySignature.buildKey(a)&&(i=a),this.helper.getSignatureWithProxy(o,i)}))}removeProxy(e,t){return a(this,void 0,void 0,(function*(){return this.locationService.removeProxyFromLocation(e,t)}))}getEarthWithRepetition(e){return a(this,void 0,void 0,(function*(){return this.repeater.repeat((()=>a(this,void 0,void 0,(function*(){return this.locationService.getEarth()}))),e)}))}};E=i([(0,s.injectable)(),o(0,(0,s.inject)(l.LocationModuleTypes.LOCATION_SERVICE)),o(1,(0,s.inject)(f.MARIO_TYPES.LOGGER_SERVICE)),o(2,(0,s.inject)(l.LocationModuleTypes.LOCATION_SIGNATURE_HELPER)),o(3,(0,s.inject)(l.LocationModuleTypes.REPEATER)),r("design:paramtypes",[d.LocationService,Object,p.LocationSignatureHelper,_.Repeater])],E),t.LocationTokenStrategy=E},72012:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocationStorage=void 0;const s=n(86700),c=n(18313),u=n(80237),l=n(34006);let d=class{constructor(e){this.storage=e}storeEarth(e){const t=JSON.stringify(e);return this.storage.set(l.LocationStorageKeys.EARTH,t)}getEarth(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(l.LocationStorageKeys.EARTH);return u.ProxyLocation.decode(e)}))}removeEarth(){return a(this,void 0,void 0,(function*(){yield this.storage.remove([l.LocationStorageKeys.EARTH])}))}hasEarth(){return a(this,void 0,void 0,(function*(){return this.storage.has(l.LocationStorageKeys.EARTH)}))}hasNotEarth(){return a(this,void 0,void 0,(function*(){return!(yield this.hasEarth())}))}hasActive(){return a(this,void 0,void 0,(function*(){return this.storage.has(l.LocationStorageKeys.ACTIVE)}))}storeActive(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);return this.storage.set(l.LocationStorageKeys.ACTIVE,t)}))}removeActive(){return a(this,void 0,void 0,(function*(){yield this.storage.remove([l.LocationStorageKeys.ACTIVE])}))}getActive(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(l.LocationStorageKeys.ACTIVE);return u.ProxyLocation.decode(e)}))}storeActivationTime(e){return a(this,void 0,void 0,(function*(){return this.storage.set(l.LocationStorageKeys.ACTIVATION_TIME,e.toString())}))}getActivationTime(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(l.LocationStorageKeys.ACTIVATION_TIME);return Number(e)}))}removeActivationTime(){return a(this,void 0,void 0,(function*(){yield this.storage.remove([l.LocationStorageKeys.ACTIVATION_TIME])}))}getEarthSyncTime(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(l.LocationStorageKeys.EARTH_SYNC_TIME);return Number(e)}))}storeEarthSyncTime(e){return a(this,void 0,void 0,(function*(){yield this.storage.set(l.LocationStorageKeys.EARTH_SYNC_TIME,e.toString())}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],d),t.LocationStorage=d},70892:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NonPersonalDataCollectionModule=void 0;const r=n(18313),o=n(72030),a=n(51407),s=n(8307),c=n(48757),u=n(87563),l=n(36468);class d extends r.MarioModule{name(){return"NonPersonalDataCollectionModule"}register(){return i(this,void 0,void 0,(function*(){this.mario().registerService(o.NonPersonalDataCollectionModuleTypes.NON_PERSONAL_DATA_COLLECTION_SERVICE,a.NonPersonalDataCollectionService),this.mario().portDispatcher().on(s.NonPersonalDataCollectionAgreedListener),this.mario().portDispatcher().on(c.NonPersonalDataCollectionRejectedListener),this.mario().internalDispatcher().on(u.InternalNonPersonalDataCollectionAgreedListener),this.mario().internalDispatcher().on(l.InternalNonPersonalDataCollectionRejectedListener)}))}}t.NonPersonalDataCollectionModule=d},72030:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonPersonalDataCollectionServiceEvents=t.NonPersonalDataCollectionModuleTypes=void 0,t.NonPersonalDataCollectionModuleTypes={NON_PERSONAL_DATA_COLLECTION_SERVICE:Symbol.for("NON_PERSONAL_DATA_COLLECTION_SERVICE")},function(e){e.NON_PERSONAL_DATA_COLLECTION_AGREED="NON_PERSONAL_DATA_COLLECTION_AGREED",e.NON_PERSONAL_DATA_COLLECTION_REJECTED="NON_PERSONAL_DATA_COLLECTION_REJECTED"}(t.NonPersonalDataCollectionServiceEvents||(t.NonPersonalDataCollectionServiceEvents={}))},87563:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InternalNonPersonalDataCollectionAgreedListener=void 0;const s=n(86700),c=n(60175),u=n(28059),l=n(6601),d=n(529),h=n(72233),f=n(86215),p=n(17418),_=n(89816),E=n(18083),y=n(72030);let v=class{constructor(e,t,n,i){this.ga=e,this.bagsnagService=t,this.ua=n,this.analytics=i}on(){return y.NonPersonalDataCollectionServiceEvents.NON_PERSONAL_DATA_COLLECTION_AGREED}handle(){return a(this,void 0,void 0,(function*(){this.ga.enable(),this.ua.enable(),yield this.bagsnagService.enable(),this.analytics.trackNonPersonalDataCollectionDecision(E.NonPersonalDataCollectionDecision.AGREED)}))}};v=i([(0,s.injectable)(),o(0,(0,s.inject)(c.GoogleAnalyticsTypes.GOOGLE_ANALYTICS_SERVICE)),o(1,(0,s.inject)(l.BugsnagTypes.BUGSNAG_SERVICE)),o(2,(0,s.inject)(f.UrbanAnalyticsTypes.CLIENT)),o(3,(0,s.inject)(p.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[u.GoogleAnalyticsService,d.BugsnagService,h.UrbanAnalyticsClient,_.Analytics])],v),t.InternalNonPersonalDataCollectionAgreedListener=v},36468:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InternalNonPersonalDataCollectionRejectedListener=void 0;const s=n(86700),c=n(17418),u=n(89816),l=n(18083),d=n(72030);let h=class{constructor(e){this.analytics=e}on(){return d.NonPersonalDataCollectionServiceEvents.NON_PERSONAL_DATA_COLLECTION_REJECTED}handle(){return a(this,void 0,void 0,(function*(){this.analytics.trackNonPersonalDataCollectionDecision(l.NonPersonalDataCollectionDecision.REJECTED)}))}};h=i([(0,s.injectable)(),o(0,(0,s.inject)(c.AnalyticsModuleTypes.ANALYTICS)),r("design:paramtypes",[u.Analytics])],h),t.InternalNonPersonalDataCollectionRejectedListener=h},8307:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NonPersonalDataCollectionAgreedListener=void 0;const s=n(86700),c=n(72030),u=n(51407),l=n(16437);let d=class{constructor(e){this.dataCollectionService=e}on(){return l.PopupEventsOut.NON_PERSONAL_DATA_COLLECTION_AGREED}handle(){return a(this,void 0,void 0,(function*(){yield this.dataCollectionService.agree()}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.NonPersonalDataCollectionModuleTypes.NON_PERSONAL_DATA_COLLECTION_SERVICE)),r("design:paramtypes",[u.NonPersonalDataCollectionService])],d),t.NonPersonalDataCollectionAgreedListener=d},48757:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NonPersonalDataCollectionRejectedListener=void 0;const s=n(86700),c=n(72030),u=n(51407),l=n(16437);let d=class{constructor(e){this.dataCollectionService=e}on(){return l.PopupEventsOut.NON_PERSONAL_DATA_COLLECTION_REJECTED}handle(){return a(this,void 0,void 0,(function*(){yield this.dataCollectionService.reject()}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.NonPersonalDataCollectionModuleTypes.NON_PERSONAL_DATA_COLLECTION_SERVICE)),r("design:paramtypes",[u.NonPersonalDataCollectionService])],d),t.NonPersonalDataCollectionRejectedListener=d},51407:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NonPersonalDataCollectionService=t.DataCollectionState=void 0;const s=n(86700),c=n(18313),u=n(72030);var l;!function(e){e.REJECT="REJECT",e.AGREE="AGREE"}(l=t.DataCollectionState||(t.DataCollectionState={}));let d=class{constructor(e,t){this.storage=e,this.internalDispatcher=t,this.key="NON_PERSONAL_DATA_COLLECTION"}hasAnswer(){return a(this,void 0,void 0,(function*(){return yield this.storage.has(this.key)}))}agree(){return a(this,void 0,void 0,(function*(){yield this.storage.set(this.key,l.AGREE);const e=new c.MarioEvent(u.NonPersonalDataCollectionServiceEvents.NON_PERSONAL_DATA_COLLECTION_AGREED);this.internalDispatcher.emit(e).then()}))}reject(){return a(this,void 0,void 0,(function*(){yield this.storage.set(this.key,l.REJECT);const e=new c.MarioEvent(u.NonPersonalDataCollectionServiceEvents.NON_PERSONAL_DATA_COLLECTION_REJECTED);this.internalDispatcher.emit(e).then()}))}getState(){return a(this,void 0,void 0,(function*(){return yield this.storage.get(this.key)}))}is(e){return a(this,void 0,void 0,(function*(){if(!(yield this.storage.has(this.key)))return!1;return(yield this.storage.get(this.key))===e}))}};d=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),o(1,(0,s.inject)(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.NonPersonalDataCollectionService=d},88912:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationContentIn=void 0,function(e){e.NOTIFICATION_SHOW="APP_NOTIFICATION_SHOW"}(t.NotificationContentIn||(t.NotificationContentIn={}))},50861:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationModule=void 0;const r=n(18313),o=n(39242),a=n(36723);class s extends r.MarioModule{name(){return"NotificationModule"}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(a.NotificationModuleTypes.NOTIFICATION_SERVICE,o.NotificationService)}))}static use(e){return i(this,void 0,void 0,(function*(){return e.registerModule(s)}))}}t.NotificationModule=s},36723:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationModuleTypes=void 0;const n={NOTIFICATION_SERVICE:Symbol.for("NOTIFICATION_SERVICE")};t.NotificationModuleTypes=n},47669:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationImage=t.NotificationType=void 0,function(e){e.SUCCESS="success",e.ERROR="error"}(t.NotificationType||(t.NotificationType={})),function(e){e.ALERT="ALERT",e.WINK="WINK"}(t.NotificationImage||(t.NotificationImage={}))},39242:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationService=void 0;const s=n(86700),c=n(18313),u=n(88912);let l=class{constructor(e,t,n){this.dispatcher=e,this.tabService=t,this.logger=n}show(e){return a(this,void 0,void 0,(function*(){const t=yield this.tabService.query({active:!0,currentWindow:!0});if(this.logger.log(`NotificationService: ${t.length}`,t),0===t.length)return void this.logger.log("NotificationService: no active tab");const n={notification:e},i=new c.MarioEvent(u.NotificationContentIn.NOTIFICATION_SHOW,n);this.dispatcher.emit(t[0].id,i)}))}};l=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.EXTERNAL_DISPATCHER)),o(1,(0,s.inject)(c.MARIO_TYPES.TAB_SERVICE)),o(2,(0,s.inject)(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object,Object,Object])],l),t.NotificationService=l},90320:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanPromotionModule=void 0;const r=n(18313),o=n(438),a=n(62854),s=n(46442),c=n(76133),u=n(38581);class l extends r.MarioModule{name(){return"UrbanPromotionModule"}static use(e,t){return i(this,void 0,void 0,(function*(){yield o.PromotionApiModule.use(e,t),yield e.registerModule(l,t)}))}register(e){return i(this,void 0,void 0,(function*(){this.mario().registerService(a.URBAN_PROMOTION_MODULE_TYPES.URBAN_PROMOTION_API,c.UrbanPromotionApi),this.mario().registerService(a.URBAN_PROMOTION_MODULE_TYPES.URBAN_PROMOTION_STORAGE,s.UrbanPromotionStorage);const t=this.mario().getService(a.URBAN_PROMOTION_MODULE_TYPES.URBAN_PROMOTION_STORAGE);if(!(yield t.hasFooter())){this.mario().logger().log("UrbanPromotionModule: need set initial value");try{const n=this.mario().getService(u.PromotionApiModuleTypes.PROMOTION_API_SERVICE).parse(e.initialFooter);yield t.setFooter(n)}catch(e){this.mario().logger().error(e)}}}))}}t.UrbanPromotionModule=l},62854:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URBAN_PROMOTION_MODULE_TYPES=void 0;const n={URBAN_PROMOTION_API:Symbol.for("URBAN_PROMOTION_API"),URBAN_PROMOTION_STORAGE:Symbol.for("URBAN_PROMOTION_STORAGE")};t.URBAN_PROMOTION_MODULE_TYPES=n},76133:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanPromotionApi=void 0;const s=n(86700),c=n(38581),u=n(50826),l=n(96233),d=n(18313),h=n(99490),f=n(62854),p=n(46442),_=n(89816),E=n(17418),y=n(18083);let v=class{constructor(e,t,n,i,r){this.api=e,this.browser=t,this.storage=n,this.analytics=i,this.logger=r}getFooter(){return a(this,void 0,void 0,(function*(){let e=!1;if(yield this.storage.hasSyncTime()){const t=yield this.storage.getSyncTime(),n=h.DateTime.fromSeconds(t).plus({minutes:30});e=h.DateTime.local()>n,this.logger.log(`UrbanPromotion: last sync time: ${h.DateTime.fromSeconds(t)}`),this.logger.log(`UrbanPromotion: expiration time: ${n}`),this.logger.log(`UrbanPromotion: need sync promotions: ${e}`)}else this.logger.log("UrbanPromotion: this is the first sync up"),e=!0;if(e)try{const e=yield this.api.fetch(this.getBrowser(),"footer"),t=this.api.parse(e);yield this.storage.setFooter(t),this.analytics.trackPromotionSyncUp(y.PromotionSyncUpStatus.SUCCESS,e.text);const n=h.DateTime.local().toSeconds();return yield this.storage.storeSyncTime(n),t}catch(e){this.analytics.trackPromotionSyncUp(y.PromotionSyncUpStatus.FAILURE)}return this.storage.getFooter()}))}getBrowser(){return{[l.BrowserEnum.CHROME_BROWSER]:"chrome",[l.BrowserEnum.EDGE_BROWSER]:"edge",[l.BrowserEnum.FIREFOX_BROWSER]:"firefox"}[this.browser]}};v=i([(0,s.injectable)(),o(0,(0,s.inject)(c.PromotionApiModuleTypes.PROMOTION_API_SERVICE)),o(1,(0,s.inject)(d.MARIO_TYPES.BROWSER)),o(2,(0,s.inject)(f.URBAN_PROMOTION_MODULE_TYPES.URBAN_PROMOTION_STORAGE)),o(3,(0,s.inject)(E.AnalyticsModuleTypes.ANALYTICS)),o(4,(0,s.inject)(d.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[u.PromotionService,String,p.UrbanPromotionStorage,_.Analytics,Object])],v),t.UrbanPromotionApi=v},46442:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.UrbanPromotionStorage=void 0;const s=n(86700),c=n(18313);let u=class{constructor(e){this.storage=e,this.FOOTER_KEY="PROMOTION_FOOTER",this.FOOTER_LAST_SYNC_TIME="PROMOTION_FOOTER_LAST_SYNC_TIME"}hasFooter(){return a(this,void 0,void 0,(function*(){return this.storage.has(this.FOOTER_KEY)}))}setFooter(e){return a(this,void 0,void 0,(function*(){const t=JSON.stringify(e);yield this.storage.set(this.FOOTER_KEY,t)}))}getFooter(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(this.FOOTER_KEY);return JSON.parse(e)}))}hasSyncTime(){return a(this,void 0,void 0,(function*(){return this.storage.has(this.FOOTER_LAST_SYNC_TIME)}))}getSyncTime(){return a(this,void 0,void 0,(function*(){const e=yield this.storage.get(this.FOOTER_LAST_SYNC_TIME);return Number(e)}))}storeSyncTime(e){return a(this,void 0,void 0,(function*(){yield this.storage.set(this.FOOTER_LAST_SYNC_TIME,e.toString())}))}};u=i([(0,s.injectable)(),o(0,(0,s.inject)(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.UrbanPromotionStorage=u},12901:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SecurityModule=void 0;const r=n(18313),o=n(75454),a=n(99832);class s extends r.MarioModule{name(){return"SecurityModule"}register(e){const t=e;this.mario().container().bind(o.SecurityModuleTypes.SECURITY_API_URL).toConstantValue(t.apiUrl),this.mario().registerService(o.SecurityModuleTypes.SECURITY_SERVICE,a.SecurityService)}static use(e,t){return i(this,void 0,void 0,(function*(){return e.registerModule(s,t)}))}}t.SecurityModule=s},75454:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecurityModuleTypes=void 0;const n={SECURITY_SERVICE:Symbol.for("SECURITY_SERVICE"),SECURITY_API_URL:Symbol.for("SECURITY_API_URL")};t.SecurityModuleTypes=n},99832:function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},a=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SecurityService=void 0;const s=n(86700),c=n(37050),u=n(82730),l=n(52300),d=n(75454),h=n(18313),f=n(99490);let p=class{constructor(e,t,n){this.apiUrl=e,this.httpClient=t,this.logger=n}getAuthToken(e,t){const n=this.buildEndpoint("/security/tokens/auth"),i=(0,l.encode)(`${e}:${t}`),r=new Headers;r.append("authorization",`Basic ${i}`),r.append("content-Type","application/json");const o={headers:r};return this.httpClient.post(n,{type:"auth"},o,{skipFailHandler:!0,skipInterceptor:!0,forceRequest:!0})}getSecurityToken(e){const t=this.buildEndpoint("/security/tokens/accs"),n=new Headers;n.append("authorization",`Bearer ${e}`),n.append("content-Type","application/json");const i={headers:n};return this.httpClient.post(t,{type:"accs",clientApp:{name:"URBAN_VPN_BROWSER_EXTENSION"}},i,{skipFailHandler:!0,skipInterceptor:!0,forceRequest:!0})}getAuthProxyToken(e){return a(this,void 0,void 0,(function*(){const t=this.buildEndpoint("/security/tokens/accs-proxy"),n={type:"accs-proxy",clientApp:{name:"URBAN_VPN_BROWSER_EXTENSION"},signature:e},i=yield this.httpClient.post(t,n,{},{rawResponse:!0}),r=yield i.json(),o=i.headers.get("Date");return{token:r,time:f.DateTime.fromHTTP(o).toMillis()}}))}buildEndpoint(e){return this.apiUrl+e}};p=i([(0,s.injectable)(),o(0,(0,s.inject)(d.SecurityModuleTypes.SECURITY_API_URL)),o(1,(0,s.inject)(c.HTTP_CLIENT_MODULE_TYPES.HTTP_CLIENT)),o(2,(0,s.inject)(h.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[String,u.HttpClient,Object])],p),t.SecurityService=p},2364:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocationUI_Mapper=void 0;const i=n(72032);class r{static map(e){return e.isEmpty()?[]:Array.from(e).map((e=>r.mapLocation(e)))}static mapLocation(e){var t;return{code:e.code().value(),flag:`/popup/flags/svg/${e.code().value().toLowerCase()}.svg`,name:e.name().value(),isLocked:e.isType(i.LocationType.INACCESSIBLE),provider:e.provider(),extraData:{streamingServiceType:null===(t=e.extraData())||void 0===t?void 0:t.streamingServiceType}}}}t.LocationUI_Mapper=r},370:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PATH=void 0,t.PATH={AD_BLOCKER_CONSENT:"/ad-blocker-consent",ANTI_MALE_WARE_CONSENT:"/anti-male-ware-consent",BLANK:"/",INITIALIZING:"/initializing",MAIN:"/main",COUNTRY_RESTRICTED:"/country-restricted",INTERRUPTION:"/interruption",RATE_US:"/rate-us",WELCOME_CONSENT:"/welcome-consent",INVITE:"/invite",THANK_YOU:"/thank-you",CONGRAT_TRIAL_ENDED:"/congrat-trial-ended",PRELOGIN_PAGE:"/prelogin",LOGIN_PAGE:"/login",FORGOT_PASSWORD_PAGE:"/forgot-password",PROFILE:"/profile",LOGOUT:"/logout",VETERAN:"/veteran",OFFER:"/offer",SUPPORT:"/support",EXPERIMENTAL_CONGRAT:"/experimental-congratulations",EXPERIMENTAL_END:"/experimental-end",DATA_SHARING:"/data-sharing",NON_PERSONAL_DATA_COLLECTION:"/non-personal-data-collection-module"}},52300:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Base64:()=>V,VERSION:()=>r,atob:()=>L,atobPolyfill:()=>C,btoa:()=>v,btoaPolyfill:()=>y,btou:()=>b,decode:()=>U,encode:()=>R,encodeURI:()=>P,encodeURL:()=>P,extendBuiltins:()=>B,extendString:()=>G,extendUint8Array:()=>k,fromBase64:()=>U,fromUint8Array:()=>S,toBase64:()=>R,toUint8Array:()=>w,utob:()=>m,version:()=>i});const i="3.5.2",r=i,o="function"==typeof atob,a="function"==typeof btoa,s="function"==typeof Buffer,c="function"==typeof TextDecoder?new TextDecoder:void 0,u="function"==typeof TextEncoder?new TextEncoder:void 0,l=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],d=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(l),h=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,f=String.fromCharCode.bind(String),p="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),_=e=>e.replace(/[+\/]/g,(e=>"+"==e?"-":"_")).replace(/=+$/m,""),E=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),y=e=>{let t,n,i,r,o="";const a=e.length%3;for(let a=0;a<e.length;){if((n=e.charCodeAt(a++))>255||(i=e.charCodeAt(a++))>255||(r=e.charCodeAt(a++))>255)throw new TypeError("invalid character found");t=n<<16|i<<8|r,o+=l[t>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}return a?o.slice(0,a-3)+"===".substring(a):o},v=a?e=>btoa(e):s?e=>Buffer.from(e,"binary").toString("base64"):y,g=s?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,i=e.length;n<i;n+=4096)t.push(f.apply(null,e.subarray(n,n+4096)));return v(t.join(""))},S=(e,t=!1)=>t?_(g(e)):g(e),T=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?f(192|t>>>6)+f(128|63&t):f(224|t>>>12&15)+f(128|t>>>6&63)+f(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return f(240|t>>>18&7)+f(128|t>>>12&63)+f(128|t>>>6&63)+f(128|63&t)},O=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,m=e=>e.replace(O,T),A=s?e=>Buffer.from(e,"utf8").toString("base64"):u?e=>g(u.encode(e)):e=>v(m(e)),R=(e,t=!1)=>t?_(A(e)):A(e),P=e=>R(e,!0),I=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,N=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return f(55296+(t>>>10))+f(56320+(1023&t));case 3:return f((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return f((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},b=e=>e.replace(I,N),C=e=>{if(e=e.replace(/\s+/g,""),!h.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,n,i,r="";for(let o=0;o<e.length;)t=d[e.charAt(o++)]<<18|d[e.charAt(o++)]<<12|(n=d[e.charAt(o++)])<<6|(i=d[e.charAt(o++)]),r+=64===n?f(t>>16&255):64===i?f(t>>16&255,t>>8&255):f(t>>16&255,t>>8&255,255&t);return r},L=o?e=>atob(E(e)):s?e=>Buffer.from(e,"base64").toString("binary"):C,M=s?e=>p(Buffer.from(e,"base64")):e=>p(L(e),(e=>e.charCodeAt(0))),w=e=>M(j(e)),D=s?e=>Buffer.from(e,"base64").toString("utf8"):c?e=>c.decode(M(e)):e=>b(L(e)),j=e=>E(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),U=e=>D(j(e)),x=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),G=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,x(t));e("fromBase64",(function(){return U(this)})),e("toBase64",(function(e){return R(this,e)})),e("toBase64URI",(function(){return R(this,!0)})),e("toBase64URL",(function(){return R(this,!0)})),e("toUint8Array",(function(){return w(this)}))},k=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,x(t));e("toBase64",(function(e){return S(this,e)})),e("toBase64URI",(function(){return S(this,!0)})),e("toBase64URL",(function(){return S(this,!0)}))},B=()=>{G(),k()},V={version:i,VERSION:r,atob:L,atobPolyfill:C,btoa:v,btoaPolyfill:y,fromBase64:U,toBase64:R,encode:R,encodeURI:P,encodeURL:P,utob:m,btou:b,decode:U,fromUint8Array:S,toUint8Array:w,extendString:G,extendUint8Array:k,extendBuiltins:B}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};n(81909)})();