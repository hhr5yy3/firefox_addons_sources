import{r}from"./cplx-M4JPizzD.js";import{t as s}from"./cplx-CejnDNPm.js";import{j as t}from"./cplx-DEt7CUyc.js";import{B as m}from"./cplx-CCGYIZQf.js";import{u as c,D as p,a as f,b as g,d as h,e as x}from"./cplx-BsCYqTWz.js";import{d as C}from"./cplx-CWPpH3dB.js";import{E as j}from"./cplx-CVsLL7Ku.js";import"./cplx-Cdcyb6EG.js";import"./cplx-BbAh7E-i.js";import"./cplx-DSnlyBAv.js";import"./cplx-CXGk_GMP.js";import"./cplx-BpeHHEix.js";import"./cplx-AFeO3sEC.js";import"./cplx-2ekRUlSR.js";import"./cplx-CIDXzIHh.js";import"./cplx-CzQHx1MX.js";import"./cplx-CvSOQQlQ.js";import"./cplx-Bzmv935M.js";import"./cplx-Bey00KRS.js";import"./cplx-DC-QQLj-.js";import"./cplx-B814hFp-.js";import"./cplx-wwbq-DDb.js";import"./cplx-BqwXc_LR.js";import"./cplx-D37zsf-y.js";import"./cplx-CZMWhpfy.js";import"./cplx-SsoyhRxE.js";import"./cplx-DewpVJ-0.js";import"./cplx-B42KOvrD.js";import"./cplx-km2FGkQ4.js";import"./cplx-Mn-h5XDX.js";import"./cplx-Cqfmi6PF.js";import"./cplx-CCS6eJc0.js";import"./cplx-B19A3gYQ.js";import"./cplx-DD6dUv5H.js";import"./cplx-Dy60Fcq0.js";import"./cplx-CgmVhoKz.js";import"./cplx-hUtawQMb.js";const S=o=>o.children(c());function D(){const{failureReason:o}=C(),[e,i]=r.useState(!1);r.useEffect(()=>{e||i((o==null?void 0:o.message)==="Cloudflare timeout")},[o,e]);const a=r.useCallback(()=>{console.log("Session timeout (most likely cloudflare), refreshing page"),window.location.reload()},[]);return{isSessionTimeout:e,handleReload:a}}function no(){const o=j.getCachedSync(),{isSessionTimeout:e,handleReload:i}=D(),[a,d]=r.useState(5),l=r.useRef(void 0),u=(o==null?void 0:o.plugins.onCloudflareTimeoutAutoReload.behavior)==="reload";return r.useEffect(()=>{if(!(!e||!u))return l.current=setInterval(()=>{d(n=>n<=0?(i(),clearInterval(l.current),0):n-1)},1e3),()=>clearInterval(l.current)},[i,e,u]),e?t.jsx(p,{defaultOpen:!0,closeOnInteractOutside:!1,children:t.jsx(S,{children:({setOpen:n})=>t.jsxs(f,{children:[t.jsx(g,{children:s("plugin-on-cloudflare-timeout-reload:dialog.header")}),t.jsx(h,{children:s("plugin-on-cloudflare-timeout-reload:dialog.description")}),t.jsxs(x,{children:[t.jsxs(m,{onClick:()=>{i(),n(!1)},children:[s("plugin-on-cloudflare-timeout-reload:dialog.buttons.reload"),u&&t.jsxs("span",{children:[" (",a,")"]})]}),t.jsx(m,{variant:"ghost",onClick:()=>{clearInterval(l.current),n(!1)},children:s("plugin-on-cloudflare-timeout-reload:dialog.buttons.dismiss")})]})]})})}):null}export{no as default};
