import{a as C}from"../chunks/chunk-VIJL2KGN.js";import{A as i,v as d}from"../chunks/chunk-WRHUMLYF.js";import{G as y}from"../chunks/chunk-OEPSEZ5A.js";import"../chunks/chunk-AT6M4CEW.js";import{e as s}from"../chunks/chunk-3GYLW4KZ.js";var l=s(y()),p=s(C());async function c(){try{let r=window.__wb_deferredPrograms,o=window.location.href,u="US",g=async e=>new l.default(a=>{chrome.cookies.get({name:e,url:o},m=>a(m?m.value:null))}),f=3e3,{programId:n,metrics:t}=await(0,p.applyClientRules)(r,o,u,g,{programAttemptTimeoutMs:f}),w={domain:d(),selectedProgramId:n,selectedProgramIndex:t.attempts.findIndex(e=>e.programId===n),duration:t.totalDuration,totalNumberOfAttempts:t.attempts.map(e=>e.attempts).reduce((e,a)=>e+a,0),programsTestedCount:t.programsTestedCount};i("clientSideProgramMetrics",w),chrome.runtime.sendMessage({url:o,type:"programSelected",selectedProgramId:n,referrer:document.referrer,title:document.title},e=>{})}catch(r){console.log("*** error loading program client side",r)}}document.readyState!=="loading"?c():document.addEventListener("DOMContentLoaded",c);
