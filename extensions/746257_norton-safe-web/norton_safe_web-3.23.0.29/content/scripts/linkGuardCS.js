((e,t)=>{"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("ReactDOM")):"function"==typeof define&&define.amd?define(["React","ReactDOM"],t):"object"==typeof exports?exports.LinkGuardSDK=t(require("React"),require("ReactDOM")):e.LinkGuardSDK=t(e.React,e.ReactDOM)})(this,(r,o)=>{{var u={883:e=>{e.exports=r},845:e=>{e.exports=o}},s={};function l(e){var t=s[e];return void 0!==t||(t=s[e]={exports:{}},u[e](t,t.exports,l)),t.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var S={};l.d(S,{default:()=>n}),Object.defineProperty(A,"MESSAGES",{get:function(){return{GET_RATINGS:"9f9b6830-134e-4e0f-bb08-93e6e270c90b",SHOW_ONE_TIME_SCAN_NOTIFICATION:"cf456bdf-3e0d-4660-df49-44dd5466c306",GET_TAB_URL:"d7b20955-55dd-46ac-89ea-adcad196c39e",GET_POPUP_DATA:"d09a4c06-4c14-4647-8b7d-05169eedaeb5",SEND_TELEMETRY:"911a78db-0224-4ed3-8b3f-da09387e350f",SET_DATA_IN_CACHE:"hjgkhhkjvhkd",GET_URLS_CACHE:"da55ef2a-eb87-4293-93fd-5853502c2b57"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"WEBMAIL_DOMAINS",{get:function(){return["mail.google.com","mail.yahoo.com","outlook.live.com","mail.aol.com","mail.yandex.ru","mail.protonmail.com","mail.zoho.com"]},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SOCIAL_MEDIA_DOMAINS",{get:function(){return["www.facebook.com","facebook.com","twitter.com","www.twitter.com"]},enumerable:!1,configurable:!0}),Object.defineProperty(A,"ATTRIBUTE_SCAN_LIST",{get:function(){return["href","codebase","cite","background","action","longdesc","src","profile","usemap","classid","data","formaction","icon","manifest","poster"]},enumerable:!1,configurable:!0}),Object.defineProperty(A,"ATTRIBUTE_IGNORE_LIST",{get:function(){return["download"]},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SUPPORTED_PROTOCOLS",{get:function(){return["http:","https:"]},enumerable:!1,configurable:!0}),Object.defineProperty(A,"URL_FILTER",{get:function(){return/^.*\.(JPG|JPEG|MP4|GIF|PNG|CSS|JS|XML|ICO|JSON|SVG|PDF|JPG:THUMB|PNG:THUMB)$/i},enumerable:!1,configurable:!0}),Object.defineProperty(A,"URL_FILTER_WITH_QUERY_PARAM",{get:function(){return/^.*\.(JPG\?|JPEG\?|MP4\?|GIF\?|PNG\?|CSS\?|JS\?|XML\?|ICO\?|JSON\?|SVG\?|PDF\?|JPG:THUMB\?|PNG:THUMB\?)/i},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SAFE_TLDS",{get:function(){return/^.*(FBCDN.NET|TWIMG.COM|GOOGLEUSERCONTENT.COM|GOOGLE.COM|MESSENGER.COM|GSTATIC.COM|YOUTUBE.COM|BLOGGER.COM|FACEBOOK.COM|MSN.COM|YAHOO.COM|TWITTER.COM)$/i},enumerable:!1,configurable:!0}),Object.defineProperty(A,"PROCESS_PAGE_TIMEOUT",{get:function(){return 1e3},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CHUNK_SIZE",{get:function(){return 30},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SETTINGS_MESSAGES",{get:function(){return{LINKGUARD_STORAGE_SETTINGS:"2b342ac6-cff2-40ee-d349-14b691e31e2e",SCAN_NOTIFICATION_SHOWN:"14ec3407-19c4-4fc3-8915-c23a036ab4c1"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"POPUP_WIDTH",{get:function(){return 233},enumerable:!1,configurable:!0}),Object.defineProperty(A,"POPUP_HEIGHT",{get:function(){return 120},enumerable:!1,configurable:!0}),Object.defineProperty(A,"POPUP_OFFSET",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(A,"ISO2_2_ISO3_locale",{get:function(){return{AX:"ALA",AF:"AFG",AL:"ALB",DZ:"DZA",AS:"ASM",AD:"AND",AO:"AGO",AI:"AIA",AQ:"ATA",AG:"ATG",AR:"ARG",AM:"ARM",AW:"ABW",AU:"AUS",AT:"AUT",AZ:"AZE",BS:"BHS",BH:"BHR",BD:"BGD",BB:"BRB",BY:"BLR",BE:"BEL",BZ:"BLZ",BJ:"BEN",BM:"BMU",BT:"BTN",BO:"BOL",BA:"BIH",BW:"BWA",BV:"BVT",BR:"BRA",IO:"IOT",BN:"BRN",BG:"BGR",BF:"BFA",BI:"BDI",KH:"KHM",CM:"CMR",CA:"CAN",CV:"CPV",KY:"CYM",CF:"CAF",TD:"TCD",CL:"CHL",CN:"CHN",CX:"CXR",CC:"CCK",CO:"COL",KM:"COM",CD:"COD",CG:"COG",CK:"COK",CR:"CRI",CI:"CIV",HR:"HRV",CU:"CUB",CY:"CYP",CZ:"CZE",DK:"DNK",DJ:"DJI",DM:"DMA",DO:"DOM",EC:"ECU",EG:"EGY",SV:"SLV",GQ:"GNQ",ER:"ERI",EE:"EST",ET:"ETH",FK:"FLK",FO:"FRO",FJ:"FJI",FI:"FIN",FR:"FRA",GF:"GUF",PF:"PYF",TF:"ATF",GA:"GAB",GM:"GMB",GE:"GEO",DE:"DEU",GH:"GHA",GI:"GIB",GR:"GRC",GL:"GRL",GD:"GRD",GP:"GLP",GU:"GUM",GT:"GTM",GN:"GIN",GW:"GNB",GY:"GUY",HT:"HTI",HM:"HMD",HN:"HND",HK:"HKG",HU:"HUN",IS:"ISL",IN:"IND",ID:"IDN",IR:"IRN",IQ:"IRQ",IE:"IRL",IL:"ISR",IT:"ITA",JM:"JAM",JP:"JPN",JO:"JOR",KZ:"KAZ",KE:"KEN",KI:"KIR",KP:"PRK",KR:"KOR",KW:"KWT",KG:"KGZ",LA:"LAO",LV:"LVA",LB:"LBN",LS:"LSO",LR:"LBR",LY:"LBY",LI:"LIE",LT:"LTU",LU:"LUX",MO:"MAC",MK:"MKD",MG:"MDG",MW:"MWI",MY:"MYS",MV:"MDV",ML:"MLI",MT:"MLT",MH:"MHL",MQ:"MTQ",MR:"MRT",MU:"MUS",YT:"MYT",MX:"MEX",FM:"FSM",MD:"MDA",MC:"MCO",MN:"MNG",MS:"MSR",MA:"MAR",MZ:"MOZ",MM:"MMR",NA:"NAM",NR:"NRU",NP:"NPL",NL:"NLD",AN:"ANT",NC:"NCL",NZ:"NZL",NI:"NIC",NE:"NER",NG:"NGA",NU:"NIU",NF:"NFK",MP:"MNP",NO:"NOR",OM:"OMN",PK:"PAK",PW:"PLW",PS:"PSE",PA:"PAN",PG:"PNG",PY:"PRY",PE:"PER",PH:"PHL",PN:"PCN",PL:"POL",PT:"PRT",PR:"PRI",QA:"QAT",RE:"REU",RO:"ROU",RU:"RUS",RW:"RWA",SH:"SHN",KN:"KNA",LC:"LCA",PM:"SPM",VC:"VCT",WS:"WSM",SM:"SMR",ST:"STP",SA:"SAU",SN:"SEN",CS:"SCG",SC:"SYC",SL:"SLE",SG:"SGP",SK:"SVK",SI:"SVN",SB:"SLB",SO:"SOM",ZA:"ZAF",GS:"SGS",ES:"ESP",LK:"LKA",SD:"SDN",SR:"SUR",SJ:"SJM",SZ:"SWZ",SE:"SWE",CH:"CHE",SY:"SYR",TW:"TWN",TJ:"TJK",TZ:"TZA",TH:"THA",TL:"TLS",TG:"TGO",TK:"TKL",TO:"TON",TT:"TTO",TN:"TUN",TR:"TUR",TM:"TKM",TC:"TCA",TV:"TUV",UG:"UGA",UA:"UKR",AE:"ARE",GB:"GBR",US:"USA",UM:"UMI",UY:"URY",UZ:"UZB",VU:"VUT",VA:"VAT",VE:"VEN",VN:"VNM",VG:"VGB",VI:"VIR",WF:"WLF",EH:"ESH",YE:"YEM",ZM:"ZMB",ZW:"ZWE"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"ISO2_2_ISO3_lang",{get:function(){return{AB:"ABK",AA:"AAR",AF:"AFR",AK:"AKA",SQ:"SQI",AM:"AMH",AR:"ARA",AN:"ARG",HY:"HYE",AS:"ASM",AV:"AVA",AE:"AVE",AY:"AYM",AZ:"AZE",BM:"BAM",BA:"BAK",EU:"EUS",BE:"BEL",BN:"BEN",BH:"BIH",BI:"BIS",BS:"BOS",BR:"BRE",BG:"BUL",MY:"MYA",CA:"CAT",CH:"CHA",CE:"CHE",NY:"NYA",ZH:"ZHO",CV:"CHV",KW:"COR",CO:"COS",CR:"CRE",HR:"HRV",CS:"CES",DA:"DAN",DV:"DIV",NL:"NLD",DZ:"DZO",EN:"ENG",EO:"EPO",ET:"EST",EE:"EWE",FO:"FAO",FJ:"FIJ",FI:"FIN",FR:"FRA",FF:"FUL",GL:"GLG",KA:"KAT",DE:"DEU",EL:"ELL",GN:"GRN",GU:"GUJ",HT:"HAT",HA:"HAU",HE:"HEB",HZ:"HER",HI:"HIN",HO:"HMO",HU:"HUN",IA:"INA",ID:"IND",IE:"ILE",GA:"GLE",IG:"IBO",IK:"IPK",IO:"IDO",IS:"ISL",IT:"ITA",IU:"IKU",JA:"JPN",JV:"JAV",KL:"KAL",KN:"KAN",KR:"KAU",KS:"KAS",KK:"KAZ",KM:"KHM",KI:"KIK",RW:"KIN",KY:"KIR",KV:"KOM",KG:"KON",KO:"KOR",KU:"KUR",KJ:"KUA",LA:"LAT",LB:"LTZ",LG:"LUG",LI:"LIM",LN:"LIN",LO:"LAO",LT:"LIT",LU:"LUB",LV:"LAV",GV:"GLV",MK:"MKD",MG:"MLG",MS:"MSA",ML:"MAL",MT:"MLT",MI:"MRI",MR:"MAR",MH:"MAH",MN:"MON",NA:"NAU",NV:"NAV",ND:"NDE",NE:"NEP",NG:"NDO",NB:"NOB",NN:"NNO",NO:"NOR",II:"III",NR:"NBL",OC:"OCI",OJ:"OJI",CU:"CHU",OM:"ORM",OR:"ORI",OS:"OSS",PA:"PAN",PI:"PLI",FA:"FAS",PL:"POL",PS:"PUS",PT:"POR",QU:"QUE",RM:"ROH",RN:"RUN",RO:"RON",RU:"RUS",SA:"SAN",SC:"SRD",SD:"SND",SE:"SME",SM:"SMO",SG:"SAG",SR:"SRP",GD:"GLA",SN:"SNA",SI:"SIN",SK:"SLK",SL:"SLV",SO:"SOM",ST:"SOT",ES:"SPA",SU:"SUN",SW:"SWA",SS:"SSW",SV:"SWE",TA:"TAM",TE:"TEL",TG:"TGK",TH:"THA",TI:"TIR",BO:"BOD",TK:"TUK",TL:"TGL",TN:"TSN",TO:"TON",TR:"TUR",TS:"TSO",TT:"TAT",TW:"TWI",TY:"TAH",UG:"UIG",UK:"UKR",UR:"URD",UZ:"UZB",VE:"VEN",VI:"VIE",VO:"VOL",WA:"WLN",CY:"CYM",WO:"WOL",FY:"FRY",XH:"XHO",YI:"YID",YO:"YOR",ZA:"ZHA",ZU:"ZUL"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SITE_DIRECTOR_VALUES",{get:function(){return{SITE_DIRECTOR_URL:"http://sitedirector.norton.com/932743328?ssdcat=SSDCAT_VALUE&env=prod&origin=nsss&displang=iso3:ISO3_LAN_CODE&displocale=iso3:ISO3_COUNTRY_CODE",COUNTRY_CODE:"ISO3_COUNTRY_CODE",LAN_CODE:"ISO3_LAN_CODE",SSD_CAT:"SSDCAT_VALUE"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SITE_DIRECTOR_VALUES_NOTIFICATION",{get:function(){return{SSD_CAT:"310",SSD_HELP_ID:"&helpid=suspiciouslink"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"STRINGS_LINK_GUARD",{get:function(){return{page_scan_notification:{title:"",ok_button:"suspicious.links.notification.ok",learn_more:"suspicious.links.notification.learnMore",description:"suspicious.links.notification.main"},popup:{header:"suspicious.links.popup.header",content:"suspicious.links.popup.content"}}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SUPPORTED_LANGUAGES",{get:function(){return{el:!0,en:!0,pt_br:!0,it:!0,ar:!0,cs:!0,es:!0,ru:!0,nl:!0,pt:!0,no:!0,nb:!0,tr:!0,ro:!0,pl:!0,fr:!0,zh_tw:!0,de:!0,da:!0,fi:!0,hu:!0,ja:!0,he:!0,zh_cn:!0,ko:!0,sv:!0}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"STRINGS_PATH",{get:function(){return"/content/i18n/linkGuardSDK"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"STRINGS",{get:function(){return{lg_strings:"lg_strings",page_scan_notification:"page_scan_notification",popup:"popup"}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CSS_FILE_NAME",{get:function(){return"linkGuard.css"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CS_FILE_NAME",{get:function(){return"linkGuardCS.js"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"SECURITY_POPUP",{get:function(){return"lg_security_popup"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"LINK_GUARD_ENABLED",{get:function(){return"f23c899e-785b-4579-a219-9b6484895030"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"TELEMETRY_CONSTANTS",{get:function(){return{PAGE:{SCAN_NOTIFICATION_SHOWN:"Linkguard_scan_notification_shown",RED_HIGHLIGHTS_SHOWN:"Linkguard_red_highlights_shown"},EVENTS:{EXTN_PAGE_VIEW:"extnPageview",EXTN_CLICK:"extnClick"},CATEGORY:{LG_NOTIFICATION:"lg_notification",LG_RED_HIGHLIGHTS:"lg_red_highlights",URL_REPUTATION:"url_reputation"},ACTION:{BAD_URL_CLICKED:"bad_url_clicked"},TYPE:{BAD_URL_CLICKED:"Linkguard_bad_url_clicked"}}},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CACHED_URLS",{get:function(){return"4529ede2-edc9-4d3e-9d3f-c791fece0a5c"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CACHE_CLEAR_ALARM",{get:function(){return"clear_cache_lg"},enumerable:!1,configurable:!0}),Object.defineProperty(A,"CACHE_CLEAR_INTERVAL_IN_MINS",{get:function(){return 10},enumerable:!1,configurable:!0});let c=A;function A(){}var T=globalThis.SymBfw,E=T.extensionAdapter;f.prototype.showOneTimeScanNotification=function(){E.sendMessage({id:c.MESSAGES.SHOW_ONE_TIME_SCAN_NOTIFICATION})};let e=new f;function f(){}var O=l(883),d=l.n(O),N=l(845);function I(e){var t,n,r=e.UrlRect,e=e.strings;return r&&e?(n=(r=r).left,t=r.bottom+c.POPUP_OFFSET,n={left:n=n+c.POPUP_WIDTH>window.innerWidth?window.innerWidth-c.POPUP_WIDTH-c.POPUP_OFFSET:n,top:t=t+c.POPUP_HEIGHT>window.innerHeight?r.top-c.POPUP_HEIGHT-c.POPUP_OFFSET:t},d().createElement("div",{id:"security_popup_iframe",className:"security_popup",role:"dialog",style:{left:n.left,top:n.top}},d().createElement("div",{className:"popup"},d().createElement("div",{className:"popup_header"},d().createElement("span",{className:"icon left"}),d().createElement("p",null,e.header),d().createElement("span",{className:"icon right"})),d().createElement("div",{className:"popup_description"},d().createElement("p",null,e.content))))):null}var R=T.extensionAdapter;p.prototype.showSecurityPopup=function(t){R.sendMessage({id:c.MESSAGES.GET_POPUP_DATA},function(e){N.render(O.createElement(I,{strings:null==(e=null==e?void 0:e.payload)?void 0:e.strings,UrlRect:t}),document.getElementById(c.SECURITY_POPUP))})},p.prototype.removeSecurityPopup=function(){N.render(null,document.getElementById(c.SECURITY_POPUP))};let t=new p;function p(){}var P=T.extensionAdapter,_=c.MESSAGES;L.getUrlsAndElements=function(r){var o=[];return c.ATTRIBUTE_SCAN_LIST.forEach(function(n){var e=document.querySelectorAll("[".concat(n,"]:not([fg_scanned])"));e&&0!==e.length&&e.forEach(function(t){var e;c.ATTRIBUTE_IGNORE_LIST.find(function(e){return t.hasAttribute(e)})||((e,t)=>{try{var n=new URL(e);if(!n.protocol)return;if(!c.SUPPORTED_PROTOCOLS.includes(n.protocol))return;if(e.match(c.URL_FILTER))return;if(e.match(c.URL_FILTER_WITH_QUERY_PARAM))return;var r=new URL(t).hostname,o=new URL(e).hostname;if(r===o)return;if(o.match(c.SAFE_TLDS))return}catch(e){return}return 1})(e=t.getAttribute(n),r)&&(o.push({url:e,element:t}),t.setAttribute("fg_scanned","1"))})}),o},L.addEventListeners=function(e){e.addEventListener("mouseenter",function(){t.showSecurityPopup(e.getBoundingClientRect())}),e.addEventListener("mouseleave",function(){t.removeSecurityPopup()}),e.addEventListener("click",function(){var e=c.TELEMETRY_CONSTANTS,e={category:e.CATEGORY.URL_REPUTATION,event:e.EVENTS.EXTN_CLICK,action:e.ACTION.BAD_URL_CLICKED,type:e.TYPE.BAD_URL_CLICKED};P.sendMessage({id:_.SEND_TELEMETRY,payload:{telemetryParams:e}})})},L.updateScannedUrls=function(r){c.ATTRIBUTE_SCAN_LIST.forEach(function(n){var e=document.querySelectorAll("[".concat(n,"]:not([fg_scanned])"));e&&0!==e.length&&e.forEach(function(e){var t=e.getAttribute(n);t&&r.includes(t)&&e.setAttribute("fg_scanned","1")})})},L.updateRewrittenUrls=function(r){var o=this;c.ATTRIBUTE_SCAN_LIST.forEach(function(n){var e=document.querySelectorAll("[".concat(n,"]:not([fg_rewritten])"));e&&0!==e.length&&e.forEach(function(e){var t=e.getAttribute(n);t&&r.includes(t)&&(e.setAttribute("fg_rewritten","1"),o.addEventListeners(e),i.injectSecurityPopup())})})};let a=L;function L(){}function C(e,c,a,u){return new(a=a||Promise)(function(n,t){function r(e){try{i(u.next(e))}catch(e){t(e)}}function o(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,o)}i((u=u.apply(e,c||[])).next())})}function M(r,o){var i,c,a,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=e(0),s.throw=e(1),s.return=e(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function e(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;u=s&&t[s=0]?0:u;)try{if(i=1,c&&(a=2&t[0]?c.return:t[0]?c.throw||((a=c.return)&&a.call(c),0):c.next)&&!(a=a.call(c,t[1])).done)return a;switch(c=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,c=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!((a=0<(a=u.trys).length&&a[a.length-1])||6!==t[0]&&2!==t[0])){u=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3]))u.label=t[1];else if(6===t[0]&&u.label<a[1])u.label=a[1],a=t;else{if(!(a&&u.label<a[2])){a[2]&&u.ops.pop(),u.trys.pop();continue}u.label=a[2],u.ops.push(t)}}t=o.call(r,u)}catch(e){t=[6,e],c=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}var U=c.MESSAGES,G=T.extensionAdapter,b=T.logger,g=T.utils,T;function h(){this.resetTimerAndProcessCallback=this.resetTimerAndProcessCallback.bind(this),this.processPage=this.processPage.bind(this),this.processPageTimeout=null}h.prototype.getRatingsFromBG=function(e){return new Promise(function(t){G.sendMessage({id:U.GET_RATINGS,payload:{urls:e}},function(e){t(e)})})},h.prototype.splitChunks=function(e,t){for(var n=[],r=0;r<e.length;)n.push(e.slice(r,r+=t));return n},h.prototype.injectSecurityPopup=function(){var e;document.getElementById(c.SECURITY_POPUP)||((e=document.createElement("div")).id=c.SECURITY_POPUP,document.body.append(e))},h.prototype.storeRatingsInCache=function(e,t){e=e.map(function(e){return e.url});G.sendMessage({id:c.MESSAGES.SET_DATA_IN_CACHE,payload:{scannedUrls:e,rewrittenUrls:t}})},h.prototype.getAndProcessRatings=function(n,i){return C(this,void 0,void 0,function(){var t,r,o=this;return M(this,function(e){switch(e.label){case 0:return[4,this.getRatingsFromBG(n)];case 1:return t=e.sent(),r=[],t.forEach(function(t){var e,n;t.isRewritten&&(e=i.find(function(e){return e.url===t.url}))&&(e.element.setAttribute("fg_rewritten","1"),n={event:(n=c.TELEMETRY_CONSTANTS).EVENTS.EXTN_PAGE_VIEW,category:n.CATEGORY.URL_REPUTATION,page:n.PAGE.RED_HIGHLIGHTS_SHOWN},G.sendMessage({id:U.SEND_TELEMETRY,payload:{telemetryParams:n}}),a.addEventListeners(e.element),o.showOneTimeNotification(),o.injectSecurityPopup(),r.push(e.url))}),this.storeRatingsInCache(i,r),[2]}})})},h.prototype.showOneTimeNotification=function(){this.notificationShown||(this.notificationShown=!0,e.showOneTimeScanNotification())},h.prototype.processPage=function(o){return C(this,void 0,void 0,function(){var n,t,r=this;return M(this,function(e){switch(e.label){case 0:return[4,this.getAndSetDataFromCache()];case 1:return e.sent(),this.updateScannedAndRewrittenUrls(),(n=a.getUrlsAndElements(o))&&0!==n.length&&(t=n.map(function(e){return e.url}),this.splitChunks(t,c.CHUNK_SIZE).forEach(function(t){return C(r,void 0,void 0,function(){return M(this,function(e){switch(e.label){case 0:return[4,this.getAndProcessRatings(t,n)];case 1:return e.sent(),[2]}})})})),[2]}})})},h.prototype.startDomObservation=function(e,t){try{new MutationObserver(function(e){t()}).observe(e,{attributes:!1,childList:!0,characterData:!1,subtree:!0})}catch(e){b.debug(e)}},h.prototype.sendMessageToBgAndGetResponse=function(e){return new Promise(function(t){G.sendMessage(e,function(e){t(e)})})},h.prototype.getTabUrl=function(){return C(this,void 0,void 0,function(){var t;return M(this,function(e){switch(e.label){case 0:return g.isTopLevelWindow()?[2,window.location.href]:[4,this.sendMessageToBgAndGetResponse({id:c.MESSAGES.GET_TAB_URL})];case 1:return t=e.sent(),[2,null==(t=null==t?void 0:t.payload)?void 0:t.url]}})})},h.prototype.getAndSetDataFromCache=function(){return C(this,void 0,void 0,function(){var r=this;return M(this,function(e){return[2,new Promise(function(n){G.sendMessage({id:c.MESSAGES.GET_URLS_CACHE},function(e){var t;r.scannedUrls=null==(t=null==e?void 0:e.payload)?void 0:t.scannedUrls,r.rewrittenUrls=null==(t=null==e?void 0:e.payload)?void 0:t.rewrittenUrls,n("Data set from BG")})})]})})},h.prototype.updateScannedAndRewrittenUrls=function(){this.scannedUrls&&0<this.scannedUrls.length&&a.updateScannedUrls(this.scannedUrls),this.rewrittenUrls&&0<this.rewrittenUrls.length&&a.updateRewrittenUrls(this.rewrittenUrls)},h.prototype.initPage=function(){return C(this,void 0,void 0,function(){var t,n=this;return M(this,function(e){switch(e.label){case 0:return[4,this.getTabUrl()];case 1:return t=e.sent(),this.startDomObservation(document.body,function(){n.resetTimerAndProcessCallback(t)}),document.addEventListener("click",function(){n.resetTimerAndProcessCallback(t)}),[2]}})})},h.prototype.resetTimerAndProcessCallback=function(e){var t=this;try{clearTimeout(this.processPageTimeout),this.processPageTimeout=setTimeout(function(){t.processPage(e)},c.PROCESS_PAGE_TIMEOUT)}catch(e){b.debug(e)}};let i=T=new h,n=(T.initPage(),{linkGuardCS:i,scanNotificationCS:e});return S.default}});