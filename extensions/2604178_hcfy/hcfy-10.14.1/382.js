"use strict";(self.webpackChunkbrowser_extension=self.webpackChunkbrowser_extension||[]).push([[382],{26964:(e,t,s)=>{s.d(t,{OR:()=>i});var n=s(6839),o=s(24671),r=s(72431);const i=[o.ql,n.aN];r.eA.WebSpeech,o.u8,r.eA.TencentRealtime,n.Er,r.eA.WebSpeech,o.HO,r.eA.TencentRealtime,n.AH},21060:(e,t,s)=>{s.d(t,{O:()=>o});s(10865),s(17840);const n={"中文(简体)":"zh",英语:"en",俄语:"ru",西班牙语:"es",法语:"fr",阿拉伯语:"ar",土耳其语:"tr",葡萄牙语:"pt",泰语:"th",印尼语:"id",意大利语:"it",越南语:"vi"};function o(e,t="",s=""){const o=n[s]||"auto",r=n[t]||"zh";return`https://translate.alibaba.com/#hcfy_text=${encodeURIComponent(e)}&hcfy_from=${o}&hcfy_to=${r}`}},1707:(e,t,s)=>{s.d(t,{O:()=>o});s(10865),s(17840),s(48983);const n={"":"自动识别","中文(简体)":"中文"};function o(e,t="中文",s=""){return`https://fanyi.qq.com/#hcfy_text=${encodeURIComponent(e)}&hcfy_from=${n[s]||s}&hcfy_to=${n[t]||t}`}},10469:(e,t,s)=>{s.d(t,{Z:()=>o});const n=JSON.parse('{"中文(简体)":"zh-CHS","英语":"en","日语":"ja","西班牙语":"es","阿拉伯语":"ar","法语":"fr","韩语":"ko","俄语":"ru","德语":"de","葡萄牙语":"pt","意大利语":"it","希腊语":"el","荷兰语":"nl","芬兰语":"fi","丹麦语":"da","越南语":"vi","印地语":"hi","印尼语":"id","马来语":"ms"}');s(17840);function o(e,t="",s=""){const o=n[s],r=n[t];return o&&r?`https://fanyi.youdao.com/#hcfy_text=${encodeURIComponent(e)}&hcfy_from=${o}&hcfy_to=${r}`:`http://fanyi.youdao.com/#hcfy_text=${encodeURIComponent(e)}`}},43566:(e,t,s)=>{s.d(t,{A:()=>F});s(62234),s(33873),s(69375),s(10865),s(98376),s(14293),s(47010);var n=s(51127),o=s.n(n),r=s(14041),i=s(19687),l=s(23590),a=s(10435),c=s(78220),u=s(16342),d=s(3444),p=s(63446),m=s(22067),h=s(54449),f=s(98087),x=s.n(f),g=s(79071),y=s.n(g),v=s(74874),C=s.n(v),j=s(25148),k=s(16224),b=s(62269),S=s(4225),I=s(91307),R=s(81152),N=s(20760),A=s(83813),w=s(5877),T=s(3040),E=s(96072),P=s(74703),L=s(98009),z=s(74070),$=s(66690),U=s(81215),O=s(31085);const _=C()(k.g2,"secondDestinationLatestSource","selectedAPIs","collapsedAPIs","selectedExternalLinks","source","destination","autoPlay","autoCopy","recentUseLangFrom","recentUseLangTo","sourceTransformNCaml","sourceTransformNoBr","sourceTransformNoComment","sourceLower","sourceTransformRegExps","tipPanelSettingsClosed","historyEnabled","favoritesEnabled","quickLinks","tipQuickLinksClosed","panelCustomStyle","customAPINames","panelSize","panelButtons","textAreaAuto"),M=C()(k.Ne,["user","noticesUnreadNum"]),B={small:14,middle:18,large:22},F=(0,r.forwardRef)((function(e,t){const{toaster:s,headerLeft:n,headerRight:f,extendOptions:g,showTextArea:v=!1,size:k="small",style:F,hasDragTip:H,portalContainer:q,showOptionsTip:W=!0,onTranslate:D,elementRef:K}=e,[J,Q,V]=(0,j.A)(_),[Z]=(0,j.A)(M),G=(null==Z?void 0:Z.user)||null,X=(0,r.useMemo)((()=>{const e=null==J?void 0:J.selectedAPIs,t=null==J?void 0:J.customAPINames;if(e&&t)return[...e,...t]}),[null==J?void 0:J.customAPINames,null==J?void 0:J.selectedAPIs]),Y=(0,r.useMemo)((()=>{const e=null==J?void 0:J.collapsedAPIs;return e&&e.length?(0,A.jM)(X,(t=>{t&&e.forEach((e=>{const s=t.indexOf(e);s>=0&&t.splice(s,1)}))})):X}),[X,null==J?void 0:J.collapsedAPIs]),ee=(null==J?void 0:J.quickLinks.filter((e=>e.panel)))||[],te=J||_,se=B[k],ne="small"===k,oe="large"===k,re=(null==J?void 0:J.source)||"",ie=(0,r.useCallback)((e=>{Q({source:e})}),[Q]),[le,ae]=(0,r.useState)(""),[ce,ue]=(0,r.useState)(""),de=le===ce,pe=(0,r.useRef)(null),[me,he]=(0,r.useState)(!1),{results:fe,queryResult:xe,dispatchResults:ge}=(0,R.L)(ce,Y,re,null==J?void 0:J.destination,D),[ye,ve]=(0,r.useState)([]),[,Ce]=(0,S.A)(),{isInFavorites:je,saveOrDelete:ke}=(0,N.A)(ce,ge,Y),be=(0,P.O)(s),{sourceTransformNCaml:Se,sourceTransformNoBr:Ie,sourceTransformNoComment:Re,sourceLower:Ne,sourceTransformRegExps:Ae}=C()(J||_,["sourceTransformNCaml","sourceTransformNoBr","sourceTransformNoComment","sourceLower","sourceTransformRegExps"]),we=(0,r.useRef)(""),Te=(0,r.useCallback)((e=>{if(e===we.current)return;we.current=e,ve((e=>(0,A.jM)(e,(e=>{e.splice(0)}))));const t=(0,U.W)(e,{sourceTransformNCaml:Se,sourceTransformNoBr:Ie,sourceTransformNoComment:Re,sourceLower:Ne,sourceTransformRegExps:Ae});ae(t),ue(t)}),[Se,Ie,Re,Ne,Ae]),Ee=(0,r.useRef)(Te);Ee.current=Te;const Pe=(0,w.A)(ce);(0,r.useEffect)((()=>{te.historyEnabled&&Pe!==ce&&ce&&Ce({type:"save translate record",text:ce})}),[Ce,ce,te.historyEnabled]),(0,r.useEffect)((()=>{te.secondDestinationLatestSource&&Pe!==ce&&ce&&(0,$.o)(ce).then((e=>{null!=e&&"中文(简体)"!==e&&o().storage.local.set({latestSource:e})}))}),[ce,te.secondDestinationLatestSource]),(0,r.useImperativeHandle)(t,(()=>({select(){var e;null===(e=pe.current)||void 0===e||e.select()},async play(){var e;if(!X)return;const t=X[0],s=null===(e=fe.results[t])||void 0===e?void 0:e.result;var n;return t&&(null==s?void 0:s.text)===we.current?(0,h.Z)({apiId:t,source:s.from,text:s.text,ttsURI:(null===(n=s.phonetic)||void 0===n?void 0:n[0].ttsURI)||s.ttsURI}):void 0},async setText(e){if(await V,"text"===e.type)ae(e.text);else if("image"===e.type)return be(e.dataURI).then((e=>{ae(e)}))},async translate(e,t){if(await V,"text"===e.type)Ee.current(e.text),t&&this.select();else if("image"===e.type)return be(e.dataURI).then((e=>{Ee.current(e),t&&this.select()}))}})),[be,V,fe.results,X]);const Le=(0,r.useMemo)((()=>ne?{width:6,height:6,borderRadius:3,right:3,top:1}:oe?{width:10,height:10,borderRadius:5,right:8,top:6}:{width:8,height:8,borderRadius:4,right:5,top:3}),[oe,ne]),ze=(0,O.jsx)(i.$,{icon:(0,O.jsx)(l.I,{icon:"cog",size:se}),small:ne,large:oe,minimal:!0,active:me,className:"settings",onClick:()=>{he((e=>!e))},title:"快捷设置"});return(0,O.jsxs)(O.Fragment,{children:[(null==J?void 0:J.panelCustomStyle)&&(0,O.jsx)("style",{children:J.panelCustomStyle.replace(/bp3/g,"bp4").replace(/bp4/g,"bp5")}),(0,O.jsxs)("div",{id:"translate-panel",className:"size-"+k,style:F,ref:K,children:[(0,O.jsxs)("div",{className:"fixed",children:[(0,O.jsxs)("div",{className:"header",children:[(0,O.jsxs)("div",{className:"left",children:[n,(null==J?void 0:J.panelButtons.includes("media"))&&(0,O.jsx)(L.m,{isSmall:ne,isLarge:oe,iconSize:se,onSelect:e=>{be(e).then(Te,y())},portalContainer:q}),(null==J?void 0:J.panelButtons.includes("microphone"))&&(0,O.jsx)(z.h,{isSmall:ne,isLarge:oe,iconSize:se,onSelect:Te,portalContainer:q}),(null==J?void 0:J.panelButtons.includes("folder-open"))&&(0,O.jsx)(i.$,{small:ne,large:oe,minimal:!0,icon:(0,O.jsx)(l.I,{icon:"folder-open",size:se}),onClick:()=>{o().runtime.sendMessage({action:"open options page",suffix:"#/stars"})},title:"打开收藏夹"}),(null==J?void 0:J.panelButtons.includes("history"))&&(0,O.jsx)(i.$,{small:ne,large:oe,minimal:!0,icon:(0,O.jsx)(l.I,{icon:"history",size:se}),onClick:()=>{o().runtime.sendMessage({action:"open options page",suffix:"#/history"})},title:"打开历史记录"})]}),(0,O.jsx)("div",{className:"drag-block",title:H?"按住不放可以拖动":void 0}),(0,O.jsxs)("div",{className:"right",children:[!!ye.length&&(0,O.jsx)(i.$,{icon:(0,O.jsx)(l.I,{icon:"undo",size:se}),small:ne,large:oe,minimal:!0,title:"返回上一次翻译",onClick:()=>{const e=x()(ye);e&&(ae(e),ue(e)),ve((e=>(0,A.jM)(e,(e=>{e.pop()}))))}}),!(null==Z||!Z.noticesUnreadNum)&&(0,O.jsxs)("div",{style:{fontSize:0,position:"relative"},children:[(0,O.jsx)(i.$,{icon:(0,O.jsx)(l.I,{icon:"notifications",size:se}),small:ne,large:oe,minimal:!0,title:`你有 ${Z.noticesUnreadNum} 条未读消息`,onClick:()=>{o().runtime.sendMessage({action:"open options page",suffix:"?notices"})}}),(0,O.jsx)("div",{style:{position:"absolute",background:"rgb(243,1,1)",...Le}})]}),J&&(0,O.jsxs)(O.Fragment,{children:[J.favoritesEnabled&&(0,O.jsx)(i.$,{icon:(0,O.jsx)(l.I,{icon:je?"star":"star-empty",size:se}),disabled:!ce,small:ne,large:oe,minimal:!0,title:je?"从收藏夹中删除":"添加到收藏夹",onClick:ke}),J.tipPanelSettingsClosed&&ze,!J.tipPanelSettingsClosed&&(0,O.jsx)(a.A,{enforceFocus:!1,content:(0,O.jsxs)("div",{className:c.KJG,style:{width:"200px",padding:"5px"},children:["添加 / 隐藏翻译源、语种切换、鼠标悬浮取词开关和显示翻译文本开关在这里。",(0,O.jsx)("a",{onClick:()=>{Q({tipPanelSettingsClosed:!0})},children:"不再提示"})]}),canEscapeKeyClose:!1,isOpen:!J.tipPanelSettingsClosed&&W,portalContainer:q,children:ze})]}),f]})]}),(0,O.jsx)(u.S,{isOpen:me,keepChildrenMounted:!0,children:(0,O.jsx)(I.A,{source:re,setSource:ie,options:J,setOptions:Q,user:G,size:k,portalContainer:q,children:g})}),v&&(0,O.jsx)(E.j,{isLarge:oe,isSmall:ne,iconSize:se,value:le,onChange:ae,onTranslate:e=>{Te(null==e?le:e)},ref:pe,hideBtn:de||!le,auto:(null==J?void 0:J.textAreaAuto)||!1})]}),(0,O.jsxs)("div",{className:"body",style:de?void 0:{opacity:.7},children:[!ce&&(0,O.jsx)("p",{children:"请输入需要翻译的文本。"}),ce&&J&&(null==X?void 0:X.map(((e,t)=>{const s=fe.results[e];return(0,O.jsx)(h.A,{portalContainer:q,apiId:e,result:s,size:k,queryResult:t=>{xe(ce,e,t||re)},autoPlay:J.autoPlay&&0===t,autoCopy:J.autoCopy&&0===t,setQuery:e=>{ve((e=>(0,A.jM)(e,(e=>{e.push(ce)})))),ue(e),ae(e)},collapse:J.collapsedAPIs.includes(e),onCollapseChange:()=>{Q((t=>{const s=t.collapsedAPIs.indexOf(e);s>=0?t.collapsedAPIs.splice(s,1):t.collapsedAPIs.push(e)}))}},e)}))),X&&!X.length&&(0,O.jsx)(d.I,{className:"no-api",title:"你隐藏了所有翻译源",description:"请添加一个翻译源来显示翻译结果。",action:(0,O.jsx)(a.A,{portalContainer:q,content:(0,O.jsx)(p.W,{children:(0,O.jsx)(b.A,{})}),children:(0,O.jsx)(i.$,{icon:"add",small:ne,large:oe,text:"添加翻译源"})})}),!(null==J||!J.selectedExternalLinks.length)&&(0,O.jsx)("div",{className:"external-translators",children:J.selectedExternalLinks.map((e=>{const t=T.j.find((t=>t.id===e));return t?(0,O.jsx)("div",{children:(0,O.jsx)(i.A,{small:ne,large:oe,text:t.name,target:"_blank",href:t.generateLink(ce,J.destination,re)})},e):null}))}),J&&!J.tipQuickLinksClosed&&ce&&(0,O.jsxs)(m.P,{style:{marginBottom:8,fontSize:12},children:["下方是预定义的三个快捷链接，你可以前往",(0,O.jsx)("a",{onClick:()=>{o().runtime.sendMessage({action:"open options page",suffix:"#/panel"})},children:"“设置” - “翻译面板”"})," ","- “快捷链接”中修改或删除它们。",(0,O.jsx)("a",{onClick:()=>{Q({tipQuickLinksClosed:!0})},children:"不再提示"})]}),!!ee.length&&ce&&(0,O.jsx)("div",{className:"quick-links",children:ee.map((e=>(0,O.jsx)("a",{href:e.link.replace("%s",encodeURIComponent(ce)),target:"_blank",rel:"noreferrer",children:e.name},e.name)))})]})]})]})}))},23593:(e,t,s)=>{s.d(t,{c_:()=>r});s(62234),s(33873),s(85100),s(27162),s(66403),s(94154),s(64777),s(38846),s(62896),s(47010);var n=s(30819),o=s(20124);s.n(o)()("hotkeys");const r={ctrl:n.U0?"metaKey":"ctrlKey",alt:"altKey",shift:"shiftKey"};n.U0&&n.gm},17439:(e,t,s)=>{s.d(t,{W:()=>f});s(33873),s(10865),s(47010);var n=s(14041),o=s(22067),r=s(68802),i=s(78107),l=s(19687),a=s(74874),c=s.n(a),u=s(16224),d=s(51127),p=s.n(d),m=s(31085);const h=c()(u.g2,["autoClipboard","autoClipboardImage"]);function f(e){const{onTranslate:t,onDismiss:s}=e,[a,c]=(0,n.useState)(null),[u,d]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{p().storage.local.get(h).then((async({autoClipboard:e,autoClipboardImage:s})=>{if(!1===e&&!1===s)return;const n=await p().runtime.sendMessage({action:"read clipboard"});if(n&&("text"!==n.type||n.text.trim()))if("text"===n.type)switch(e){case null:c(n);break;case!0:t(n);break;case"write-only":t(n,!0)}else if("image"===n.type)switch(s){case null:c(n);break;case!0:t(n);break;case"write-only":t(n,!0)}}))}),[t]),a?(0,m.jsxs)(o.P,{intent:"primary",children:[(0,m.jsxs)(r.H5,{children:["是否要翻译剪切板内的",(0,m.jsx)("i",{children:"text"===a.type?"文本":"图片"}),"？"]}),(0,m.jsx)(i.Sc,{label:"记住我的选择，下次不再询问",className:"ask-clipboard-checkbox",checked:u,onChange:e=>{d(e.target.checked)}}),(0,m.jsx)(l.$,{style:{marginRight:15},text:"翻译",onClick:()=>{t(a),u&&p().storage.local.set({["text"===a.type?"autoClipboard":"autoClipboardImage"]:!0}),c(null)}}),(0,m.jsx)(l.$,{text:"不翻译",onClick:()=>{u&&p().storage.local.set({["text"===a.type?"autoClipboard":"autoClipboardImage"]:!1}),c(null),s()}})]}):null}},64795:(e,t,s)=>{s.d(t,{W:()=>o});s(33873),s(47010);var n=s(14041);function o(e){const[t,s]=(0,n.useState)({v:!1,h:!1});return(0,n.useEffect)((()=>{if(!e)return;const t=()=>{s(function(e){return{h:e.scrollWidth>e.clientWidth,v:e.scrollHeight>e.clientHeight}}(e))};t();const n=new ResizeObserver(t);return n.observe(e),()=>{n.unobserve(e)}}),[e]),t}},17368:(e,t,s)=>{s.d(t,{F:()=>r});s(97107);var n=s(1783),o=s(23298);class r extends Error{constructor(e,t){super(e),null!==(null==t?void 0:t.type)&&(this.type=(null==t?void 0:t.type)||n.V.OTHER),this.link=null==t?void 0:t.link,this.context=null==t?void 0:t.context,this.errors=null==t?void 0:t.errors,this.noRetry=null==t?void 0:t.noRetry}toJSON(){var e;return{type:this.type,message:this.message,link:this.link,errors:null===(e=this.errors)||void 0===e?void 0:e.map((e=>(0,o.x)(e).toJSON()))}}clone(){return new r(this.message,{context:this.context,type:this.type,link:this.link,errors:this.errors,noRetry:this.noRetry})}}},34426:(e,t,s)=>{s.d(t,{H:()=>i});s(97107);var n=s(17368),o=s(46123),r=s.n(o);function i(e){if(e instanceof n.F)return e;if(e instanceof Error)return new n.F(e.message,{type:null});const t=r()(e,"message");return"string"==typeof t?new n.F(t,{type:null}):new n.F("划词翻译内部出现了一个预期之外的错误，如果你看到了这条消息，请反馈给我。",{type:null})}},17840:(e,t,s)=>{s(33873),s(48605),s(47010)},84848:(e,t,s)=>{s.d(t,{dU:()=>a,j_:()=>l});s(97107),s(33873),s(10865),s(47010);var n=s(31085),o=s(95805),r=s(14041),i=s(25873);function l(e,t=document.body){const s=document.createElement("div");t.appendChild(s);const r=(0,i.H)(s);return new Promise(((t,s)=>{r.render((0,n.jsx)(o.V,{...e,usePortal:!1,ref:e=>{e?t(e):s(new Error("[Blueprint] Unable to create toaster."))}}))}))}function a(e){const t=(0,r.useRef)();return(0,r.useEffect)((()=>{e.then((e=>{t.current=e}))}),[e]),t}},62337:(e,t,s)=>{s(96959)}}]);