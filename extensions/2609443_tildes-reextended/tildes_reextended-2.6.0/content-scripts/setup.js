var jn=Object.create;var vt=Object.defineProperty;var Kn=Object.getOwnPropertyDescriptor;var Xn=Object.getOwnPropertyNames;var Yn=Object.getPrototypeOf,Zn=Object.prototype.hasOwnProperty;var Ce=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Qn=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Xn(t))!Zn.call(e,s)&&s!==n&&vt(e,s,{get:()=>t[s],enumerable:!(o=Kn(t,s))||o.enumerable});return e};var oe=(e,t,n)=>(n=e!=null?jn(Yn(e)):{},Qn(t||!e||!e.__esModule?vt(n,"default",{value:e,enumerable:!0}):n,e));var Bt=Ce(($e,xe)=>{(function(){"use strict";var e={function:!0,object:!0},t=e[typeof window]&&window||this,n=t,o=e[typeof $e]&&$e,s=e[typeof xe]&&xe&&!xe.nodeType&&xe,r=o&&s&&typeof global=="object"&&global;r&&(r.global===r||r.window===r||r.self===r)&&(t=r);var a=Math.pow(2,53)-1,l=/\bOpera/,c=this,d=Object.prototype,i=d.hasOwnProperty,p=d.toString;function f(u){return u=String(u),u.charAt(0).toUpperCase()+u.slice(1)}function g(u,L,U){var M={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return L&&U&&/^Win/i.test(u)&&!/^Windows Phone /i.test(u)&&(M=M[/[\d.]+$/.exec(u)])&&(u="Windows "+M),u=String(u),L&&U&&(u=u.replace(RegExp(L,"i"),U)),u=T(u.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),u}function h(u,L){var U=-1,M=u?u.length:0;if(typeof M=="number"&&M>-1&&M<=a)for(;++U<M;)L(u[U],U,u);else _(u,L)}function T(u){return u=w(u),/^(?:webOS|i(?:OS|P))/.test(u)?u:f(u)}function _(u,L){for(var U in u)i.call(u,U)&&L(u[U],U,u)}function v(u){return u==null?f(u):p.call(u).slice(8,-1)}function E(u,L){var U=u!=null?typeof u[L]:"number";return!/^(?:boolean|number|string|undefined)$/.test(U)&&(U=="object"?!!u[L]:!0)}function O(u){return String(u).replace(/([ -])(?!$)/g,"$1?")}function y(u,L){var U=null;return h(u,function(M,J){U=L(U,M,J,u)}),U}function w(u){return String(u).replace(/^ +| +$/g,"")}function S(u){var L=t,U=u&&typeof u=="object"&&v(u)!="String";U&&(L=u,u=null);var M=L.navigator||{},J=M.userAgent||"";u||(u=J);var F=U||c==n,le=U?!!M.likeChrome:/\bChrome\b/.test(u)&&!/internal|\n/i.test(p.toString()),ae="Object",te=U?ae:"ScriptBridgingProxyObject",be=U?ae:"Environment",Rn=U&&L.java?"JavaPackage":v(L.java),Dn=U?ae:"RuntimeObject",ve=/\bJava/.test(Rn)&&L.java,Nn=ve&&v(L.environment)==be,Bn=ve?"a":"\u03B1",Fn=ve?"b":"\u03B2",Je=L.document||{},ce=L.operamini||L.opera,_e=l.test(_e=U&&ce?ce["[[Class]]"]:v(ce))?_e:ce=null,m,ke=u,$=[],Te=null,ue=u==J,C=ue&&ce&&typeof ce.version=="function"&&ce.version(),qe,z=Wn([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),x=Gn(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),I=ht([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),V=Vn({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),A=Jn(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Wn(q){return y(q,function(N,R){return N||RegExp("\\b"+(R.pattern||O(R))+"\\b","i").exec(u)&&(R.label||R)})}function Vn(q){return y(q,function(N,R,ne){return N||(R[I]||R[/^[a-z]+(?: +[a-z]+\b)*/i.exec(I)]||RegExp("\\b"+O(ne)+"(?:\\b|\\w*\\d)","i").exec(u))&&ne})}function Gn(q){return y(q,function(N,R){return N||RegExp("\\b"+(R.pattern||O(R))+"\\b","i").exec(u)&&(R.label||R)})}function Jn(q){return y(q,function(N,R){var ne=R.pattern||O(R);return!N&&(N=RegExp("\\b"+ne+"(?:/[\\d.]+|[ \\w.]*)","i").exec(u))&&(N=g(N,ne,R.label||R)),N})}function ht(q){return y(q,function(N,R){var ne=R.pattern||O(R);return!N&&(N=RegExp("\\b"+ne+" *\\d+[.\\w_]*","i").exec(u)||RegExp("\\b"+ne+" *\\w+-[\\w]*","i").exec(u)||RegExp("\\b"+ne+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(u))&&((N=String(R.label&&!RegExp(ne,"i").test(R.label)?R.label:N).split("/"))[1]&&!/[\d.]+/.test(N[0])&&(N[0]+=" "+N[1]),R=R.label||R,N=T(N[0].replace(RegExp(ne,"i"),R).replace(RegExp("; *(?:"+R+"[_-])?","i")," ").replace(RegExp("("+R+")[-_.]?(\\w)","i"),"$1 $2"))),N})}function bt(q){return y(q,function(N,R){return N||(RegExp(R+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(u)||0)[1]||null})}function qn(){return this.description||""}if(z&&(z=[z]),/\bAndroid\b/.test(A)&&!I&&(m=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(u))&&(I=w(m[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),V&&!I?I=ht([V]):V&&I&&(I=I.replace(RegExp("^("+O(V)+")[-_.\\s]","i"),V+" ").replace(RegExp("^("+O(V)+")[-_.]?(\\w)","i"),V+" $2")),(m=/\bGoogle TV\b/.exec(I))&&(I=m[0]),/\bSimulator\b/i.test(u)&&(I=(I?I+" ":"")+"Simulator"),x=="Opera Mini"&&/\bOPiOS\b/.test(u)&&$.push("running in Turbo/Uncompressed mode"),x=="IE"&&/\blike iPhone OS\b/.test(u)?(m=S(u.replace(/like iPhone OS/,"")),V=m.manufacturer,I=m.product):/^iP/.test(I)?(x||(x="Safari"),A="iOS"+((m=/ OS ([\d_]+)/i.exec(u))?" "+m[1].replace(/_/g,"."):"")):x=="Konqueror"&&/^Linux\b/i.test(A)?A="Kubuntu":V&&V!="Google"&&(/Chrome/.test(x)&&!/\bMobile Safari\b/i.test(u)||/\bVita\b/.test(I))||/\bAndroid\b/.test(A)&&/^Chrome/.test(x)&&/\bVersion\//i.test(u)?(x="Android Browser",A=/\bAndroid\b/.test(A)?A:"Android"):x=="Silk"?(/\bMobi/i.test(u)||(A="Android",$.unshift("desktop mode")),/Accelerated *= *true/i.test(u)&&$.unshift("accelerated")):x=="UC Browser"&&/\bUCWEB\b/.test(u)?$.push("speed mode"):x=="PaleMoon"&&(m=/\bFirefox\/([\d.]+)\b/.exec(u))?$.push("identifying as Firefox "+m[1]):x=="Firefox"&&(m=/\b(Mobile|Tablet|TV)\b/i.exec(u))?(A||(A="Firefox OS"),I||(I=m[1])):!x||(m=!/\bMinefield\b/i.test(u)&&/\b(?:Firefox|Safari)\b/.exec(x))?(x&&!I&&/[\/,]|^[^(]+?\)/.test(u.slice(u.indexOf(m+"/")+8))&&(x=null),(m=I||V||A)&&(I||V||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(A))&&(x=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(A)?A:m)+" Browser")):x=="Electron"&&(m=(/\bChrome\/([\d.]+)\b/.exec(u)||0)[1])&&$.push("Chromium "+m),C||(C=bt(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",O(x),"(?:Firefox|Minefield|NetFront)"])),(m=z=="iCab"&&parseFloat(C)>3&&"WebKit"||/\bOpera\b/.test(x)&&(/\bOPR\b/.test(u)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(u)&&!/^(?:Trident|EdgeHTML)$/.test(z)&&"WebKit"||!z&&/\bMSIE\b/i.test(u)&&(A=="Mac OS"?"Tasman":"Trident")||z=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(x)&&"NetFront")&&(z=[m]),x=="IE"&&(m=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(u)||0)[1])?(x+=" Mobile",A="Windows Phone "+(/\+$/.test(m)?m:m+".x"),$.unshift("desktop mode")):/\bWPDesktop\b/i.test(u)?(x="IE Mobile",A="Windows Phone 8.x",$.unshift("desktop mode"),C||(C=(/\brv:([\d.]+)/.exec(u)||0)[1])):x!="IE"&&z=="Trident"&&(m=/\brv:([\d.]+)/.exec(u))&&(x&&$.push("identifying as "+x+(C?" "+C:"")),x="IE",C=m[1]),ue){if(E(L,"global"))if(ve&&(m=ve.lang.System,ke=m.getProperty("os.arch"),A=A||m.getProperty("os.name")+" "+m.getProperty("os.version")),Nn){try{C=L.require("ringo/engine").version.join("."),x="RingoJS"}catch{(m=L.system)&&m.global.system==L.system&&(x="Narwhal",A||(A=m[0].os||null))}x||(x="Rhino")}else typeof L.process=="object"&&!L.process.browser&&(m=L.process)&&(typeof m.versions=="object"&&(typeof m.versions.electron=="string"?($.push("Node "+m.versions.node),x="Electron",C=m.versions.electron):typeof m.versions.nw=="string"&&($.push("Chromium "+C,"Node "+m.versions.node),x="NW.js",C=m.versions.nw)),x||(x="Node.js",ke=m.arch,A=m.platform,C=/[\d.]+/.exec(m.version),C=C?C[0]:null));else v(m=L.runtime)==te?(x="Adobe AIR",A=m.flash.system.Capabilities.os):v(m=L.phantom)==Dn?(x="PhantomJS",C=(m=m.version||null)&&m.major+"."+m.minor+"."+m.patch):typeof Je.documentMode=="number"&&(m=/\bTrident\/(\d+)/i.exec(u))?(C=[C,Je.documentMode],(m=+m[1]+4)!=C[1]&&($.push("IE "+C[1]+" mode"),z&&(z[1]=""),C[1]=m),C=x=="IE"?String(C[1].toFixed(1)):C[0]):typeof Je.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(x)&&($.push("masking as "+x+" "+C),x="IE",C="11.0",z=["Trident"],A="Windows");A=A&&T(A)}if(C&&(m=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(C)||/(?:alpha|beta)(?: ?\d)?/i.exec(u+";"+(ue&&M.appMinorVersion))||/\bMinefield\b/i.test(u)&&"a")&&(Te=/b/i.test(m)?"beta":"alpha",C=C.replace(RegExp(m+"\\+?$"),"")+(Te=="beta"?Fn:Bn)+(/\d+\+?/.exec(m)||"")),x=="Fennec"||x=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(A))x="Firefox Mobile";else if(x=="Maxthon"&&C)C=C.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(I))I=="Xbox 360"&&(A=null),I=="Xbox 360"&&/\bIEMobile\b/.test(u)&&$.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(x)||x&&!I&&!/Browser|Mobi/.test(x))&&(A=="Windows CE"||/Mobi/i.test(u)))x+=" Mobile";else if(x=="IE"&&ue)try{L.external===null&&$.unshift("platform preview")}catch{$.unshift("embedded")}else(/\bBlackBerry\b/.test(I)||/\bBB10\b/.test(u))&&(m=(RegExp(I.replace(/ +/g," *")+"/([.\\d]+)","i").exec(u)||0)[1]||C)?(m=[m,/BB10/.test(u)],A=(m[1]?(I=null,V="BlackBerry"):"Device Software")+" "+m[0],C=null):this!=_&&I!="Wii"&&(ue&&ce||/Opera/.test(x)&&/\b(?:MSIE|Firefox)\b/i.test(u)||x=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(A)||x=="IE"&&(A&&!/^Win/.test(A)&&C>5.5||/\bWindows XP\b/.test(A)&&C>8||C==8&&!/\bTrident\b/.test(u)))&&!l.test(m=S.call(_,u.replace(l,"")+";"))&&m.name&&(m="ing as "+m.name+((m=m.version)?" "+m:""),l.test(x)?(/\bIE\b/.test(m)&&A=="Mac OS"&&(A=null),m="identify"+m):(m="mask"+m,_e?x=T(_e.replace(/([a-z])([A-Z])/g,"$1 $2")):x="Opera",/\bIE\b/.test(m)&&(A=null),ue||(C=null)),z=["Presto"],$.push(m));(m=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(u)||0)[1])&&(m=[parseFloat(m.replace(/\.(\d)$/,".0$1")),m],x=="Safari"&&m[1].slice(-1)=="+"?(x="WebKit Nightly",Te="alpha",C=m[1].slice(0,-1)):(C==m[1]||C==(m[2]=(/\bSafari\/([\d.]+\+?)/i.exec(u)||0)[1]))&&(C=null),m[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(u)||0)[1],m[0]==537.36&&m[2]==537.36&&parseFloat(m[1])>=28&&z=="WebKit"&&(z=["Blink"]),!ue||!le&&!m[1]?(z&&(z[1]="like Safari"),m=(m=m[0],m<400?1:m<500?2:m<526?3:m<533?4:m<534?"4+":m<535?5:m<537?6:m<538?7:m<601?8:m<602?9:m<604?10:m<606?11:m<608?12:"12")):(z&&(z[1]="like Chrome"),m=m[1]||(m=m[0],m<530?1:m<532?2:m<532.05?3:m<533?4:m<534.03?5:m<534.07?6:m<534.1?7:m<534.13?8:m<534.16?9:m<534.24?10:m<534.3?11:m<535.01?12:m<535.02?"13+":m<535.07?15:m<535.11?16:m<535.19?17:m<536.05?18:m<536.1?19:m<537.01?20:m<537.11?"21+":m<537.13?23:m<537.18?24:m<537.24?25:m<537.36?26:z!="Blink"?"27":"28")),z&&(z[1]+=" "+(m+=typeof m=="number"?".x":/[.+]/.test(m)?"":"+")),x=="Safari"&&(!C||parseInt(C)>45)?C=m:x=="Chrome"&&/\bHeadlessChrome/i.test(u)&&$.unshift("headless")),x=="Opera"&&(m=/\bzbov|zvav$/.exec(A))?(x+=" ",$.unshift("desktop mode"),m=="zvav"?(x+="Mini",C=null):x+="Mobile",A=A.replace(RegExp(" *"+m+"$"),"")):x=="Safari"&&/\bChrome\b/.exec(z&&z[1])?($.unshift("desktop mode"),x="Chrome Mobile",C=null,/\bOS X\b/.test(A)?(V="Apple",A="iOS 4.3+"):A=null):/\bSRWare Iron\b/.test(x)&&!C&&(C=bt("Chrome")),C&&C.indexOf(m=/[\d.]+$/.exec(A))==0&&u.indexOf("/"+m+"-")>-1&&(A=w(A.replace(m,""))),A&&A.indexOf(x)!=-1&&!RegExp(x+" OS").test(A)&&(A=A.replace(RegExp(" *"+O(x)+" *"),"")),z&&!/\b(?:Avant|Nook)\b/.test(x)&&(/Browser|Lunascape|Maxthon/.test(x)||x!="Safari"&&/^iOS/.test(A)&&/\bSafari\b/.test(z[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(x)&&z[1])&&(m=z[z.length-1])&&$.push(m),$.length&&($=["("+$.join("; ")+")"]),V&&I&&I.indexOf(V)<0&&$.push("on "+V),I&&$.push((/^on /.test($[$.length-1])?"":"on ")+I),A&&(m=/ ([\d.+]+)$/.exec(A),qe=m&&A.charAt(A.length-m[0].length-1)=="/",A={architecture:32,family:m&&!qe?A.replace(m[0],""):A,version:m?m[1]:null,toString:function(){var q=this.version;return this.family+(q&&!qe?" "+q:"")+(this.architecture==64?" 64-bit":"")}}),(m=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(ke))&&!/\bi686\b/i.test(ke)?(A&&(A.architecture=64,A.family=A.family.replace(RegExp(" *"+m),"")),x&&(/\bWOW64\b/i.test(u)||ue&&/\w(?:86|32)$/.test(M.cpuClass||M.platform)&&!/\bWin64; x64\b/i.test(u))&&$.unshift("32-bit")):A&&/^OS X/.test(A.family)&&x=="Chrome"&&parseFloat(C)>=39&&(A.architecture=64),u||(u=null);var Y={};return Y.description=u,Y.layout=z&&z[0],Y.manufacturer=V,Y.name=x,Y.prerelease=Te,Y.product=I,Y.ua=u,Y.version=x&&C,Y.os=A||{architecture:null,family:null,version:null,toString:function(){return"null"}},Y.parse=S,Y.toString=qn,Y.version&&$.unshift(C),Y.name&&$.unshift(x),A&&x&&!(A==String(A).split(" ")[0]&&(A==x.split(" ")[0]||I))&&$.push(I?"("+A+")":"on "+A),$.length&&(Y.description=$.join(" ")),Y}var P=S();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(t.platform=P,define(function(){return P})):o&&s?_(P,function(u,L){o[L]=u}):t.platform=P}).call($e)});var pe=Ce((Ze,Vt)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof Ze<"u")t(Vt);else{var n={exports:{}};t(n),e.browser=n.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Ze,function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let t="The message port closed before a response was received.",n=o=>{let s={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(s).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(w,S=void 0){super(S),this.createItem=w}get(w){return this.has(w)||this.set(w,this.createItem(w)),super.get(w)}}let a=y=>y&&typeof y=="object"&&typeof y.then=="function",l=(y,w)=>(...S)=>{o.runtime.lastError?y.reject(new Error(o.runtime.lastError.message)):w.singleCallbackArg||S.length<=1&&w.singleCallbackArg!==!1?y.resolve(S[0]):y.resolve(S)},c=y=>y==1?"argument":"arguments",d=(y,w)=>function(P,...u){if(u.length<w.minArgs)throw new Error(`Expected at least ${w.minArgs} ${c(w.minArgs)} for ${y}(), got ${u.length}`);if(u.length>w.maxArgs)throw new Error(`Expected at most ${w.maxArgs} ${c(w.maxArgs)} for ${y}(), got ${u.length}`);return new Promise((L,U)=>{if(w.fallbackToNoCallback)try{P[y](...u,l({resolve:L,reject:U},w))}catch(M){console.warn(`${y} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,M),P[y](...u),w.fallbackToNoCallback=!1,w.noCallback=!0,L()}else w.noCallback?(P[y](...u),L()):P[y](...u,l({resolve:L,reject:U},w))})},i=(y,w,S)=>new Proxy(w,{apply(P,u,L){return S.call(u,y,...L)}}),p=Function.call.bind(Object.prototype.hasOwnProperty),f=(y,w={},S={})=>{let P=Object.create(null),u={has(U,M){return M in y||M in P},get(U,M,J){if(M in P)return P[M];if(!(M in y))return;let F=y[M];if(typeof F=="function")if(typeof w[M]=="function")F=i(y,y[M],w[M]);else if(p(S,M)){let le=d(M,S[M]);F=i(y,y[M],le)}else F=F.bind(y);else if(typeof F=="object"&&F!==null&&(p(w,M)||p(S,M)))F=f(F,w[M],S[M]);else if(p(S,"*"))F=f(F,w[M],S["*"]);else return Object.defineProperty(P,M,{configurable:!0,enumerable:!0,get(){return y[M]},set(le){y[M]=le}}),F;return P[M]=F,F},set(U,M,J,F){return M in P?P[M]=J:y[M]=J,!0},defineProperty(U,M,J){return Reflect.defineProperty(P,M,J)},deleteProperty(U,M){return Reflect.deleteProperty(P,M)}},L=Object.create(y);return new Proxy(L,u)},g=y=>({addListener(w,S,...P){w.addListener(y.get(S),...P)},hasListener(w,S){return w.hasListener(y.get(S))},removeListener(w,S){w.removeListener(y.get(S))}}),h=new r(y=>typeof y!="function"?y:function(S){let P=f(S,{},{getContent:{minArgs:0,maxArgs:0}});y(P)}),T=new r(y=>typeof y!="function"?y:function(S,P,u){let L=!1,U,M=new Promise(ae=>{U=function(te){L=!0,ae(te)}}),J;try{J=y(S,P,U)}catch(ae){J=Promise.reject(ae)}let F=J!==!0&&a(J);if(J!==!0&&!F&&!L)return!1;let le=ae=>{ae.then(te=>{u(te)},te=>{let be;te&&(te instanceof Error||typeof te.message=="string")?be=te.message:be="An unexpected error occurred",u({__mozWebExtensionPolyfillReject__:!0,message:be})}).catch(te=>{console.error("Failed to send onMessage rejected reply",te)})};return le(F?J:M),!0}),_=({reject:y,resolve:w},S)=>{o.runtime.lastError?o.runtime.lastError.message===t?w():y(new Error(o.runtime.lastError.message)):S&&S.__mozWebExtensionPolyfillReject__?y(new Error(S.message)):w(S)},v=(y,w,S,...P)=>{if(P.length<w.minArgs)throw new Error(`Expected at least ${w.minArgs} ${c(w.minArgs)} for ${y}(), got ${P.length}`);if(P.length>w.maxArgs)throw new Error(`Expected at most ${w.maxArgs} ${c(w.maxArgs)} for ${y}(), got ${P.length}`);return new Promise((u,L)=>{let U=_.bind(null,{resolve:u,reject:L});P.push(U),S.sendMessage(...P)})},E={devtools:{network:{onRequestFinished:g(h)}},runtime:{onMessage:g(T),onMessageExternal:g(T),sendMessage:v.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:v.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},O={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return s.privacy={network:{"*":O},services:{"*":O},websites:{"*":O}},f(o,E,s)};e.exports=n(chrome)}else e.exports=globalThis.browser})});var at=Ce((Es,an)=>{function it(e,t,n){var o,s,r,a,l;t==null&&(t=100);function c(){var i=Date.now()-a;i<t&&i>=0?o=setTimeout(c,t-i):(o=null,n||(l=e.apply(r,s),r=s=null))}var d=function(){r=this,s=arguments,a=Date.now();var i=n&&!o;return o||(o=setTimeout(c,t)),i&&(l=e.apply(r,s),r=s=null),l};return d.clear=function(){o&&(clearTimeout(o),o=null)},d.flush=function(){o&&(l=e.apply(r,s),r=s=null,clearTimeout(o),o=null)},d}it.debounce=it;an.exports=it});var Ln=Ce((ai,En)=>{var ee=-1,Z=1,W=0;function Ae(e,t,n,o,s){if(e===t)return e?[[W,e]]:[];if(n!=null){var r=qr(e,t,n);if(r)return r}var a=dt(e,t),l=e.substring(0,a);e=e.substring(a),t=t.substring(a),a=We(e,t);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),t=t.substring(0,t.length-a);var d=Dr(e,t);return l&&d.unshift([W,l]),c&&d.push([W,c]),pt(d,s),o&&Fr(d),d}function Dr(e,t){var n;if(!e)return[[Z,t]];if(!t)return[[ee,e]];var o=e.length>t.length?e:t,s=e.length>t.length?t:e,r=o.indexOf(s);if(r!==-1)return n=[[Z,o.substring(0,r)],[W,s],[Z,o.substring(r+s.length)]],e.length>t.length&&(n[0][0]=n[2][0]=ee),n;if(s.length===1)return[[ee,e],[Z,t]];var a=Br(e,t);if(a){var l=a[0],c=a[1],d=a[2],i=a[3],p=a[4],f=Ae(l,d),g=Ae(c,i);return f.concat([[W,p]],g)}return Nr(e,t)}function Nr(e,t){for(var n=e.length,o=t.length,s=Math.ceil((n+o)/2),r=s,a=2*s,l=new Array(a),c=new Array(a),d=0;d<a;d++)l[d]=-1,c[d]=-1;l[r+1]=0,c[r+1]=0;for(var i=n-o,p=i%2!==0,f=0,g=0,h=0,T=0,_=0;_<s;_++){for(var v=-_+f;v<=_-g;v+=2){var E=r+v,O;v===-_||v!==_&&l[E-1]<l[E+1]?O=l[E+1]:O=l[E-1]+1;for(var y=O-v;O<n&&y<o&&e.charAt(O)===t.charAt(y);)O++,y++;if(l[E]=O,O>n)g+=2;else if(y>o)f+=2;else if(p){var w=r+i-v;if(w>=0&&w<a&&c[w]!==-1){var S=n-c[w];if(O>=S)return yn(e,t,O,y)}}}for(var P=-_+h;P<=_-T;P+=2){var w=r+P,S;P===-_||P!==_&&c[w-1]<c[w+1]?S=c[w+1]:S=c[w-1]+1;for(var u=S-P;S<n&&u<o&&e.charAt(n-S-1)===t.charAt(o-u-1);)S++,u++;if(c[w]=S,S>n)T+=2;else if(u>o)h+=2;else if(!p){var E=r+i-P;if(E>=0&&E<a&&l[E]!==-1){var O=l[E],y=r+O-E;if(S=n-S,O>=S)return yn(e,t,O,y)}}}}return[[ee,e],[Z,t]]}function yn(e,t,n,o){var s=e.substring(0,n),r=t.substring(0,o),a=e.substring(n),l=t.substring(o),c=Ae(s,r),d=Ae(a,l);return c.concat(d)}function dt(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,o=Math.min(e.length,t.length),s=o,r=0;n<s;)e.substring(r,s)==t.substring(r,s)?(n=s,r=n):o=s,s=Math.floor((o-n)/2+n);return _n(e.charCodeAt(s-1))&&s--,s}function xn(e,t){var n=e.length,o=t.length;if(n==0||o==0)return 0;n>o?e=e.substring(n-o):n<o&&(t=t.substring(0,n));var s=Math.min(n,o);if(e==t)return s;for(var r=0,a=1;;){var l=e.substring(s-a),c=t.indexOf(l);if(c==-1)return r;a+=c,(c==0||e.substring(s-a)==t.substring(0,a))&&(r=a,a++)}}function We(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,o=Math.min(e.length,t.length),s=o,r=0;n<s;)e.substring(e.length-s,e.length-r)==t.substring(t.length-s,t.length-r)?(n=s,r=n):o=s,s=Math.floor((o-n)/2+n);return kn(e.charCodeAt(e.length-s))&&s--,s}function Br(e,t){var n=e.length>t.length?e:t,o=e.length>t.length?t:e;if(n.length<4||o.length*2<n.length)return null;function s(g,h,T){for(var _=g.substring(T,T+Math.floor(g.length/4)),v=-1,E="",O,y,w,S;(v=h.indexOf(_,v+1))!==-1;){var P=dt(g.substring(T),h.substring(v)),u=We(g.substring(0,T),h.substring(0,v));E.length<u+P&&(E=h.substring(v-u,v)+h.substring(v,v+P),O=g.substring(0,T-u),y=g.substring(T+P),w=h.substring(0,v-u),S=h.substring(v+P))}return E.length*2>=g.length?[O,y,w,S,E]:null}var r=s(n,o,Math.ceil(n.length/4)),a=s(n,o,Math.ceil(n.length/2)),l;if(!r&&!a)return null;a?r?l=r[4].length>a[4].length?r:a:l=a:l=r;var c,d,i,p;e.length>t.length?(c=l[0],d=l[1],i=l[2],p=l[3]):(i=l[0],p=l[1],c=l[2],d=l[3]);var f=l[4];return[c,d,i,p,f]}function Fr(e){for(var t=!1,n=[],o=0,s=null,r=0,a=0,l=0,c=0,d=0;r<e.length;)e[r][0]==W?(n[o++]=r,a=c,l=d,c=0,d=0,s=e[r][1]):(e[r][0]==Z?c+=e[r][1].length:d+=e[r][1].length,s&&s.length<=Math.max(a,l)&&s.length<=Math.max(c,d)&&(e.splice(n[o-1],0,[ee,s]),e[n[o-1]+1][0]=Z,o--,o--,r=o>0?n[o-1]:-1,a=0,l=0,c=0,d=0,s=null,t=!0)),r++;for(t&&pt(e),Gr(e),r=1;r<e.length;){if(e[r-1][0]==ee&&e[r][0]==Z){var i=e[r-1][1],p=e[r][1],f=xn(i,p),g=xn(p,i);f>=g?(f>=i.length/2||f>=p.length/2)&&(e.splice(r,0,[W,p.substring(0,f)]),e[r-1][1]=i.substring(0,i.length-f),e[r+1][1]=p.substring(f),r++):(g>=i.length/2||g>=p.length/2)&&(e.splice(r,0,[W,i.substring(0,g)]),e[r-1][0]=Z,e[r-1][1]=p.substring(0,p.length-g),e[r+1][0]=ee,e[r+1][1]=i.substring(g),r++),r++}r++}}var wn=/[^a-zA-Z0-9]/,An=/\s/,Sn=/[\r\n]/,Wr=/\n\r?\n$/,Vr=/^\r?\n\r?\n/;function Gr(e){function t(g,h){if(!g||!h)return 6;var T=g.charAt(g.length-1),_=h.charAt(0),v=T.match(wn),E=_.match(wn),O=v&&T.match(An),y=E&&_.match(An),w=O&&T.match(Sn),S=y&&_.match(Sn),P=w&&g.match(Wr),u=S&&h.match(Vr);return P||u?5:w||S?4:v&&!O&&y?3:O||y?2:v||E?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==W&&e[n+1][0]==W){var o=e[n-1][1],s=e[n][1],r=e[n+1][1],a=We(o,s);if(a){var l=s.substring(s.length-a);o=o.substring(0,o.length-a),s=l+s.substring(0,s.length-a),r=l+r}for(var c=o,d=s,i=r,p=t(o,s)+t(s,r);s.charAt(0)===r.charAt(0);){o+=s.charAt(0),s=s.substring(1)+r.charAt(0),r=r.substring(1);var f=t(o,s)+t(s,r);f>=p&&(p=f,c=o,d=s,i=r)}e[n-1][1]!=c&&(c?e[n-1][1]=c:(e.splice(n-1,1),n--),e[n][1]=d,i?e[n+1][1]=i:(e.splice(n+1,1),n--))}n++}}function pt(e,t){e.push([W,""]);for(var n=0,o=0,s=0,r="",a="",l;n<e.length;){if(n<e.length-1&&!e[n][1]){e.splice(n,1);continue}switch(e[n][0]){case Z:s++,a+=e[n][1],n++;break;case ee:o++,r+=e[n][1],n++;break;case W:var c=n-s-o-1;if(t){if(c>=0&&Cn(e[c][1])){var d=e[c][1].slice(-1);if(e[c][1]=e[c][1].slice(0,-1),r=d+r,a=d+a,!e[c][1]){e.splice(c,1),n--;var i=c-1;e[i]&&e[i][0]===Z&&(s++,a=e[i][1]+a,i--),e[i]&&e[i][0]===ee&&(o++,r=e[i][1]+r,i--),c=i}}if(Tn(e[n][1])){var d=e[n][1].charAt(0);e[n][1]=e[n][1].slice(1),r+=d,a+=d}}if(n<e.length-1&&!e[n][1]){e.splice(n,1);break}if(r.length>0||a.length>0){r.length>0&&a.length>0&&(l=dt(a,r),l!==0&&(c>=0?e[c][1]+=a.substring(0,l):(e.splice(0,0,[W,a.substring(0,l)]),n++),a=a.substring(l),r=r.substring(l)),l=We(a,r),l!==0&&(e[n][1]=a.substring(a.length-l)+e[n][1],a=a.substring(0,a.length-l),r=r.substring(0,r.length-l)));var p=s+o;r.length===0&&a.length===0?(e.splice(n-p,p),n=n-p):r.length===0?(e.splice(n-p,p,[Z,a]),n=n-p+1):a.length===0?(e.splice(n-p,p,[ee,r]),n=n-p+1):(e.splice(n-p,p,[ee,r],[Z,a]),n=n-p+2)}n!==0&&e[n-1][0]===W?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,s=0,o=0,r="",a="";break}}e[e.length-1][1]===""&&e.pop();var f=!1;for(n=1;n<e.length-1;)e[n-1][0]===W&&e[n+1][0]===W&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)===e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),f=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),f=!0)),n++;f&&pt(e,t)}function _n(e){return e>=55296&&e<=56319}function kn(e){return e>=56320&&e<=57343}function Tn(e){return kn(e.charCodeAt(0))}function Cn(e){return _n(e.charCodeAt(e.length-1))}function Jr(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}function mt(e,t,n,o){return Cn(e)||Tn(o)?null:Jr([[W,e],[ee,t],[Z,n],[W,o]])}function qr(e,t,n){var o=typeof n=="number"?{index:n,length:0}:n.oldRange,s=typeof n=="number"?null:n.newRange,r=e.length,a=t.length;if(o.length===0&&(s===null||s.length===0)){var l=o.index,c=e.slice(0,l),d=e.slice(l),i=s?s.index:null;e:{var p=l+a-r;if(i!==null&&i!==p||p<0||p>a)break e;var f=t.slice(0,p),g=t.slice(p);if(g!==d)break e;var h=Math.min(l,p),T=c.slice(0,h),_=f.slice(0,h);if(T!==_)break e;var v=c.slice(h),E=f.slice(h);return mt(T,v,E,d)}e:{if(i!==null&&i!==l)break e;var O=l,f=t.slice(0,O),g=t.slice(O);if(f!==c)break e;var y=Math.min(r-O,a-O),w=d.slice(d.length-y),S=g.slice(g.length-y);if(w!==S)break e;var v=d.slice(0,d.length-y),E=g.slice(0,g.length-y);return mt(c,v,E,w)}}if(o.length>0&&s&&s.length===0)e:{var T=e.slice(0,o.index),w=e.slice(o.index+o.length),h=T.length,y=w.length;if(a<h+y)break e;var _=t.slice(0,h),S=t.slice(a-y);if(T!==_||w!==S)break e;var v=e.slice(h,r-y),E=t.slice(h,a-y);return mt(T,v,E,w)}return null}function Ve(e,t,n,o){return Ae(e,t,n,o,!0)}Ve.INSERT=Z;Ve.DELETE=ee;Ve.EQUAL=W;En.exports=Ve});var Oe,D,_t,er,de,yt,kt,je,tr,Le={},Tt=[],nr=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ke=Array.isArray;function me(e,t){for(var n in t)e[n]=t[n];return e}function Ct(e){var t=e.parentNode;t&&t.removeChild(e)}function rr(e,t,n){var o,s,r,a={};for(r in t)r=="key"?o=t[r]:r=="ref"?s=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?Oe.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)a[r]===void 0&&(a[r]=e.defaultProps[r]);return Ee(e,a,o,s,null)}function Ee(e,t,n,o,s){var r={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++_t};return s==null&&D.vnode!=null&&D.vnode(r),r}function j(e){return e.children}function G(e,t){this.props=e,this.context=t}function ye(e,t){if(t==null)return e.__?ye(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?ye(e):null}function Et(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Et(e)}}function xt(e){(!e.__d&&(e.__d=!0)&&de.push(e)&&!Pe.__r++||yt!==D.debounceRendering)&&((yt=D.debounceRendering)||kt)(Pe)}function Pe(){var e,t,n,o,s,r,a,l;for(de.sort(je);e=de.shift();)e.__d&&(t=de.length,o=void 0,s=void 0,a=(r=(n=e).__v).__e,(l=n.__P)&&(o=[],(s=me({},r)).__v=r.__v+1,Xe(l,r,s,n.__n,l.ownerSVGElement!==void 0,r.__h!=null?[a]:null,o,a??ye(r),r.__h),Ut(o,r),r.__e!=a&&Et(r)),de.length>t&&de.sort(je));Pe.__r=0}function Lt(e,t,n,o,s,r,a,l,c,d){var i,p,f,g,h,T,_,v=o&&o.__k||Tt,E=v.length;for(n.__k=[],i=0;i<t.length;i++)if((g=n.__k[i]=(g=t[i])==null||typeof g=="boolean"||typeof g=="function"?null:typeof g=="string"||typeof g=="number"||typeof g=="bigint"?Ee(null,g,null,null,g):Ke(g)?Ee(j,{children:g},null,null,null):g.__b>0?Ee(g.type,g.props,g.key,g.ref?g.ref:null,g.__v):g)!=null){if(g.__=n,g.__b=n.__b+1,(f=v[i])===null||f&&g.key==f.key&&g.type===f.type)v[i]=void 0;else for(p=0;p<E;p++){if((f=v[p])&&g.key==f.key&&g.type===f.type){v[p]=void 0;break}f=null}Xe(e,g,f=f||Le,s,r,a,l,c,d),h=g.__e,(p=g.ref)&&f.ref!=p&&(_||(_=[]),f.ref&&_.push(f.ref,null,g),_.push(p,g.__c||h,g)),h!=null?(T==null&&(T=h),typeof g.type=="function"&&g.__k===f.__k?g.__d=c=Pt(g,c,e):c=Mt(e,g,f,v,h,c),typeof n.type=="function"&&(n.__d=c)):c&&f.__e==c&&c.parentNode!=e&&(c=ye(f))}for(n.__e=T,i=E;i--;)v[i]!=null&&(typeof n.type=="function"&&v[i].__e!=null&&v[i].__e==n.__d&&(n.__d=Ot(o).nextSibling),$t(v[i],v[i]));if(_)for(i=0;i<_.length;i++)It(_[i],_[++i],_[++i])}function Pt(e,t,n){for(var o,s=e.__k,r=0;s&&r<s.length;r++)(o=s[r])&&(o.__=e,t=typeof o.type=="function"?Pt(o,t,n):Mt(n,o,o,s,o.__e,t));return t}function Mt(e,t,n,o,s,r){var a,l,c;if(t.__d!==void 0)a=t.__d,t.__d=void 0;else if(n==null||s!=r||s.parentNode==null)e:if(r==null||r.parentNode!==e)e.appendChild(s),a=null;else{for(l=r,c=0;(l=l.nextSibling)&&c<o.length;c+=1)if(l==s)break e;e.insertBefore(s,r),a=r}return a!==void 0?a:s.nextSibling}function Ot(e){var t,n,o;if(e.type==null||typeof e.type=="string")return e.__e;if(e.__k){for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(o=Ot(n)))return o}return null}function or(e,t,n,o,s){var r;for(r in n)r==="children"||r==="key"||r in t||Me(e,r,null,n[r],o);for(r in t)s&&typeof t[r]!="function"||r==="children"||r==="key"||r==="value"||r==="checked"||n[r]===t[r]||Me(e,r,t[r],n[r],o)}function wt(e,t,n){t[0]==="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||nr.test(t)?n:n+"px"}function Me(e,t,n,o,s){var r;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||wt(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||wt(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")r=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o||e.addEventListener(t,r?St:At,r):e.removeEventListener(t,r?St:At,r);else if(t!=="dangerouslySetInnerHTML"){if(s)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!=="width"&&t!=="height"&&t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t!=="rowSpan"&&t!=="colSpan"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!=="-"?e.removeAttribute(t):e.setAttribute(t,n))}}function At(e){return this.l[e.type+!1](D.event?D.event(e):e)}function St(e){return this.l[e.type+!0](D.event?D.event(e):e)}function Xe(e,t,n,o,s,r,a,l,c){var d,i,p,f,g,h,T,_,v,E,O,y,w,S,P,u=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,l=t.__e=n.__e,t.__h=null,r=[l]),(d=D.__b)&&d(t);try{e:if(typeof u=="function"){if(_=t.props,v=(d=u.contextType)&&o[d.__c],E=d?v?v.props.value:d.__:o,n.__c?T=(i=t.__c=n.__c).__=i.__E:("prototype"in u&&u.prototype.render?t.__c=i=new u(_,E):(t.__c=i=new G(_,E),i.constructor=u,i.render=ir),v&&v.sub(i),i.props=_,i.state||(i.state={}),i.context=E,i.__n=o,p=i.__d=!0,i.__h=[],i._sb=[]),i.__s==null&&(i.__s=i.state),u.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=me({},i.__s)),me(i.__s,u.getDerivedStateFromProps(_,i.__s))),f=i.props,g=i.state,i.__v=t,p)u.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(u.getDerivedStateFromProps==null&&_!==f&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(_,E),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(_,i.__s,E)===!1||t.__v===n.__v){for(t.__v!==n.__v&&(i.props=_,i.state=i.__s,i.__d=!1),i.__e=!1,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(L){L&&(L.__=t)}),O=0;O<i._sb.length;O++)i.__h.push(i._sb[O]);i._sb=[],i.__h.length&&a.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(_,i.__s,E),i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(f,g,h)})}if(i.context=E,i.props=_,i.__P=e,y=D.__r,w=0,"prototype"in u&&u.prototype.render){for(i.state=i.__s,i.__d=!1,y&&y(t),d=i.render(i.props,i.state,i.context),S=0;S<i._sb.length;S++)i.__h.push(i._sb[S]);i._sb=[]}else do i.__d=!1,y&&y(t),d=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++w<25);i.state=i.__s,i.getChildContext!=null&&(o=me(me({},o),i.getChildContext())),p||i.getSnapshotBeforeUpdate==null||(h=i.getSnapshotBeforeUpdate(f,g)),Lt(e,Ke(P=d!=null&&d.type===j&&d.key==null?d.props.children:d)?P:[P],t,n,o,s,r,a,l,c),i.base=t.__e,t.__h=null,i.__h.length&&a.push(i),T&&(i.__E=i.__=null),i.__e=!1}else r==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=sr(n.__e,t,n,o,s,r,a,c);(d=D.diffed)&&d(t)}catch(L){t.__v=null,(c||r!=null)&&(t.__e=l,t.__h=!!c,r[r.indexOf(l)]=null),D.__e(L,t,n)}}function Ut(e,t){D.__c&&D.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(o){o.call(n)})}catch(o){D.__e(o,n.__v)}})}function sr(e,t,n,o,s,r,a,l){var c,d,i,p=n.props,f=t.props,g=t.type,h=0;if(g==="svg"&&(s=!0),r!=null){for(;h<r.length;h++)if((c=r[h])&&"setAttribute"in c==!!g&&(g?c.localName===g:c.nodeType===3)){e=c,r[h]=null;break}}if(e==null){if(g===null)return document.createTextNode(f);e=s?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,f.is&&f),r=null,l=!1}if(g===null)p===f||l&&e.data===f||(e.data=f);else{if(r=r&&Oe.call(e.childNodes),d=(p=n.props||Le).dangerouslySetInnerHTML,i=f.dangerouslySetInnerHTML,!l){if(r!=null)for(p={},h=0;h<e.attributes.length;h++)p[e.attributes[h].name]=e.attributes[h].value;(i||d)&&(i&&(d&&i.__html==d.__html||i.__html===e.innerHTML)||(e.innerHTML=i&&i.__html||""))}if(or(e,f,p,s,l),i)t.__k=[];else if(Lt(e,Ke(h=t.props.children)?h:[h],t,n,o,s&&g!=="foreignObject",r,a,r?r[0]:n.__k&&ye(n,0),l),r!=null)for(h=r.length;h--;)r[h]!=null&&Ct(r[h]);l||("value"in f&&(h=f.value)!==void 0&&(h!==e.value||g==="progress"&&!h||g==="option"&&h!==p.value)&&Me(e,"value",h,p.value,!1),"checked"in f&&(h=f.checked)!==void 0&&h!==e.checked&&Me(e,"checked",h,p.checked,!1))}return e}function It(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(o){D.__e(o,n)}}function $t(e,t,n){var o,s;if(D.unmount&&D.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||It(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){D.__e(r,t)}o.base=o.__P=null,e.__c=void 0}if(o=e.__k)for(s=0;s<o.length;s++)o[s]&&$t(o[s],t,n||typeof e.type!="function");n||e.__e==null||Ct(e.__e),e.__=e.__e=e.__d=void 0}function ir(e,t,n){return this.constructor(e,n)}function K(e,t,n){var o,s,r;D.__&&D.__(e,t),s=(o=typeof n=="function")?null:n&&n.__k||t.__k,r=[],Xe(t,e=(!o&&n||t).__k=rr(j,null,[e]),s||Le,Le,t.ownerSVGElement!==void 0,!o&&n?[n]:s?null:t.firstChild?Oe.call(t.childNodes):null,r,!o&&n?n:s?s.__e:t.firstChild,o),Ut(r,e)}Oe=Tt.slice,D={__e:function(e,t,n,o){for(var s,r,a;t=t.__;)if((s=t.__c)&&!s.__)try{if((r=s.constructor)&&r.getDerivedStateFromError!=null&&(s.setState(r.getDerivedStateFromError(e)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,o||{}),a=s.__d),a)return s.__E=s}catch(l){e=l}throw e}},_t=0,er=function(e){return e!=null&&e.constructor===void 0},G.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=me({},this.state),typeof e=="function"&&(e=e(me({},n),this.props)),e&&me(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),xt(this))},G.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),xt(this))},G.prototype.render=j,de=[],kt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,je=function(e,t){return e.__v.__b-t.__v.__b},Pe.__r=0,tr=0;function se(e,t,n){return e===1?t:n??t+"s"}async function Ue(e){let t=new window.TextEncoder().encode(e),n=await window.crypto.subtle.digest("SHA-256",t);return Array.from(new window.Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function Ht(e){return e[0].toUpperCase()+e.slice(1)}async function zt(e){let t=Number.parseInt(await Ue(e),16);return`#${Math.abs(t%16777215).toString(16)}`.padEnd(7,"0")}function ge(e){e.startsWith("#")&&(e=e.slice(1)),e.length===4&&(e=e.slice(0,3)),e.length===8&&(e=e.slice(0,6)),e.length===3&&(e=e.split("").map(r=>r.repeat(2)).join(""));let[t,n,o]=e.split(/(.{2})/).filter(r=>r!=="").map(r=>Number.parseInt(r,16));return .2126*t+.7152*n+.0722*o>128}var Ie=[{name:"Background Primary",value:"--background-primary-color"},{name:"Background Secondary",value:"--background-secondary-color"},{name:"Foreground Primary",value:"--foreground-primary-color"},{name:"Foreground Secondary",value:"--foreground-secondary-color"},{name:"Exemplary",value:"--comment-label-exemplary-color"},{name:"Off-topic",value:"--comment-label-offtopic-color"},{name:"Joke",value:"--comment-label-joke-color"},{name:"Noise",value:"--comment-label-noise-color"},{name:"Malice",value:"--comment-label-malice-color"},{name:"Mine",value:"--stripe-mine-color"},{name:"Official",value:"--alert-color"}];var ar=0;function b(e,t,n,o,s,r){var a,l,c={};for(l in t)l=="ref"?a=t[l]:c[l]=t[l];var d={type:e,props:c,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--ar,__source:s,__self:r};if(typeof e=="function"&&(a=e.defaultProps))for(l in a)c[l]===void 0&&(c[l]=a[l]);return D.vnode&&D.vnode(d),d}function fe(e){let t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstElementChild}function Rt(){window.TildesReExtended===void 0&&(window.TildesReExtended={debug:!1})}function k(e,t=!1){let n="",o="[TRX]";t&&(o="%c"+o,n="background-color: #dc322f; margin-right: 9px;"),(window.TildesReExtended?.debug||t)&&(n.length>0?console.debug(o,n,e):console.debug(o,e))}function ie(e){return document.querySelector(e)}function H(...e){return e.flatMap(t=>Array.from(document.querySelectorAll(t)))}function Dt(){if(window.location.pathname!=="/groups"){k('Not in "/groups", returning early.');return}return H(".link-group").map(e=>e.textContent??"<unknown group>")}async function Nt(e,t){if(!e.startsWith("https://tildes.net"))throw new Error(`Can't make Intercooler request to non-Tildes URL: ${e}`);let o={headers:{"User-Agent":"Tildes ReExtended (firefox, version 2.6.0)","X-CSRF-Token":document.querySelector('meta[name="csrftoken"]').content,"X-IC-Request":"true","X-TRX-Request":"true"},referrer:"https://tildes.net"};return t.headers=t.headers===void 0?o.headers:{...t.headers,...o.headers},t.referrer=t.referrer??o.referrer,k("Making Intercooler request:"),k(t),window.fetch(e,t)}var lr=oe(Bt(),1);async function He(e){return new Promise(t=>{window.setTimeout(t,e)})}function Ft(){let e=document.querySelectorAll("select#theme option");if(e.length!==0)return Array.from(e).map(t=>[t.value,(t.textContent??"<unknown>").trim()])}function Ye(e){for(let t of Array.from(document.body.classList))t.startsWith("theme-")&&document.body.classList.remove(t);document.body.classList.add(`theme-${e}`)}function ze(){return document.querySelector(".logged-in-user-username")!==null}function Wt(){let e=document.querySelector(".logged-in-user-username")??void 0;return e?.dataset.trxHideOwnUsername??e?.textContent??void 0}var Gt=oe(pe(),1);async function B(e){let t=e.storage??Gt.default.storage.local,n=(await t.get(e.key))[e.key];return new cr({key:e.key,deserialize:e.deserialize,serialize:e.serialize??JSON.stringify,storage:t,value:n===void 0?e.value:e.deserialize(n)})}var cr=class{deserialize;key;serialize;storage;inner;constructor(e){this.deserialize=e.deserialize,this.key=e.key,this.serialize=e.serialize,this.storage=e.storage,this.inner=e.value}get value(){return this.inner}set value(e){this.inner=e}async remove(){await this.storage.remove(this.key)}async save(){await this.storage.set({[this.key]:this.serialize(this.inner)})}};var Q=oe(pe(),1);var Qe=oe(pe(),1);var et=(r=>(r.DomainIncludes="domain-includes",r.TildesUsernameEquals="tildes-username-equals",r.TitleIncludes="title-includes",r.UserLabelEquals="user-label-equals",r.VotedOnTopic="voted-on-topic",r))(et||{});async function ur(e){return B({deserialize:t=>JSON.parse(t),serialize:t=>JSON.stringify(t),key:`${"hide-topics"}-${e.id}`,value:e,storage:Qe.default.storage.sync})}async function Jt(){let e=await Qe.default.storage.sync.get(),t=[];for(let[n,o]of Object.entries(e))n.startsWith("hide-topics")&&t.push(await ur(JSON.parse(o)));return t}var qt=["~anime","~arts","~books","~comp","~creative","~design","~enviro","~finance","~food","~games","~games.game_design","~games.tabletop","~health","~hobbies","~humanities","~lgbt","~life","~misc","~movies","~music","~news","~science","~space","~sports","~talk","~tech","~test","~tildes","~tildes.official","~tv"];var tt=oe(pe(),1);async function mr(e){return B({deserialize:t=>JSON.parse(t),serialize:t=>JSON.stringify(t),key:`${"username-colors"}-${e.id}`,value:e,storage:tt.default.storage.sync})}async function jt(){let e=await tt.default.storage.sync.get(),t=[];for(let[n,o]of Object.entries(e))n.startsWith("username-colors")&&t.push(await mr(JSON.parse(o)));return t}var nt=oe(pe(),1);async function Re(e){return B({deserialize:t=>JSON.parse(t),serialize:t=>JSON.stringify(t),key:`${"user-labels"}-${e.id}`,value:e,storage:nt.default.storage.sync})}async function rt(){let e=await nt.default.storage.sync.get(),t=[];for(let[n,o]of Object.entries(e))n.startsWith("user-labels")&&t.push(await Re(JSON.parse(o)));return t}async function Kt(e){for(let t of e)await t.save()}async function Xt(){let e=await rt(),t=1;return e.length>0&&(t=e.sort((n,o)=>o.value.id-n.value.id)[0].value.id+1),t}var ot=oe(pe(),1);var st=(n=>(n.Cursor="<cursor>",n.SelectedCursor="<selected-cursor>",n))(st||{}),{Cursor:re,SelectedCursor:Yt}=st,dr=[{enabled:!0,inDropdown:!1,markdown:`[${re}](${Yt})`,name:"Link"},{enabled:!0,inDropdown:!1,markdown:`\`\`\`${Yt}
${re}
\`\`\``,name:"Code"},{enabled:!0,inDropdown:!1,markdown:`~~${re}~~`,name:"Strikethrough"},{enabled:!0,inDropdown:!1,markdown:`<details>
<summary>Click to expand spoiler.</summary>

${re}
</details>`,name:"Spoilerbox"},{enabled:!0,inDropdown:!0,markdown:`**${re}**`,name:"Bold"},{enabled:!0,inDropdown:!0,markdown:`

---

${re}`,name:"Horizontal Divider"},{enabled:!0,inDropdown:!0,markdown:`\`${re}\``,name:"Inline Code"},{enabled:!0,inDropdown:!0,markdown:`*${re}*`,name:"Italic"},{enabled:!0,inDropdown:!0,markdown:`1. ${re}`,name:"Ordered List"},{enabled:!0,inDropdown:!0,markdown:`<small>${re}</small>`,name:"Small"},{enabled:!0,inDropdown:!0,markdown:`* ${re}`,name:"Unordered List"}].map((e,t)=>({...e,id:t-100,position:t+1}));async function Zt(e){return B({deserialize:t=>JSON.parse(t),serialize:t=>JSON.stringify(t),key:`${"markdown-snippet"}-${e.id}`,value:e,storage:ot.default.storage.sync})}async function en(){let e=await ot.default.storage.sync.get(),t=[];for(let[n,o]of Object.entries(e))n.startsWith("markdown-snippet")&&t.push(await Zt(JSON.parse(o)));if(t.length===0){t.push(...await Promise.all(dr.map(async n=>Zt(n))));for(let n of t)await n.save()}return pr(t)}function pr(e){return e.sort((t,n)=>{let o=t.value.position-n.value.position;return o===0?t.value.name.localeCompare(n.value.name):o})}function tn(e){let t=e.toLowerCase().split("+");return{alt:t.includes("alt"),ctrl:t.includes("ctrl"),shift:t.includes("shift"),key:t[t.length-1]}}var hr={"enabled-features":B({deserialize:e=>new Set(JSON.parse(e)),serialize:e=>JSON.stringify(Array.from(e)),key:"enabled-features",value:new Set(["back-to-top","jump-to-new-comment","markdown-toolbar","user-labels"]),storage:Q.default.storage.sync}),"known-groups":B({deserialize:e=>new Set(JSON.parse(e)),serialize:e=>JSON.stringify(Array.from(e)),key:"known-groups",value:new Set(qt),storage:Q.default.storage.sync}),"latest-active-feature-tab":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"latest-active-feature-tab",value:"debug",storage:Q.default.storage.sync}),"miscellaneous-enabled-features":B({deserialize:e=>new Set(JSON.parse(e)),serialize:e=>JSON.stringify(Array.from(e)),key:"miscellaneous-enabled-features",value:new Set(["comment-anchor-fix"]),storage:Q.default.storage.sync}),"on-site-new-label":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"on-site-new-label",value:!0,storage:Q.default.storage.sync}),"data-version":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"data-version",value:"2.0.0",storage:Q.default.storage.sync}),"randomize-username-colors":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"randomize-username-colors",value:!1,storage:Q.default.storage.sync}),"themes-list":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"themes-list",value:[["white","White"],["solarized-light","Solarized Light"],["solarized-dark","Solarized Dark"],["dracula","Dracula"],["atom-one-dark","Atom One Dark"],["black","Black"],["zenburn","Zenburn"],["gruvbox-light","Gruvbox Light"],["gruvbox-dark","Gruvbox Dark"],["love-dark","Love Dark"],["love-light","Love Light"]],storage:Q.default.storage.local}),"themes-list-updated-date":B({deserialize:e=>new Date(e),serialize:e=>e.toISOString(),key:"themes-list-updated-date",value:new Date("2023-01-01"),storage:Q.default.storage.local}),"anonymize-usernames":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"anonymize-usernames",value:{replacementType:"numerical"},storage:Q.default.storage.sync}),"hide-topics":Jt(),"hide-votes":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"hide-votes",value:{otherComments:!1,otherTopics:!1,ownComments:!0,ownTopics:!0},storage:Q.default.storage.sync}),"theme-switcher":B({deserialize:e=>JSON.parse(e),serialize:e=>JSON.stringify(e),key:"theme-switcher",value:{hourA:"09:00",hourB:"21:00",themeA:"white",themeB:"black"},storage:Q.default.storage.sync}),"user-labels":rt(),"username-colors":jt()};async function X(e){return hr[e]}async function nn(e){let t=await br(e);k(`Anonymize Usernames: Initialized for ${t} user links.`)}async function br(e){let t=H(".link-user:not(.trx-anonymized)"),n=await vr(t,e);for(let o of t){let s=rn(o),r=s.startsWith("@");r&&(s=s.slice(1));let a=n[s];o.textContent=r?`@${a}`:`${a}`,o.classList.add("trx-anonymized"),o.dataset.trxUsername=s}return t.length}async function vr(e,t){let n=new Set(e.map(s=>rn(s).replace(/@/g,""))),o={};for(let[s,r]of Array.from(n).entries())switch(t.replacementType){case"hashed":{let a=await Ue(r);o[r]=a.slice(0,10).toUpperCase();break}case"numerical":{o[r]=`Anonymous ${s+1}`;break}default:throw new Error(`Unknown ReplacementType in AnonymizeUsernamesData: ${JSON.stringify(t)}`)}return o}function rn(e){return(e.textContent??"<unknown>").trim().toLowerCase()}var on=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],yr=function(t,n){var o=document.createElement("div"),s=function(){var c={position:"absolute",left:-9999,top:0,zIndex:-2e3};return t.tagName==="TEXTAREA"&&on.push("width"),on.forEach(function(d){c[d]=getComputedStyle(t)[d]}),c},r=function(c){var d=s();Object.keys(d).forEach(function(i){o.style[i]=d[i]}),o.innerHTML=c,t.parentNode.insertBefore(o,t.nextSibling)},a=function(){var c=o.ownerDocument.getElementById("caret-position-marker"),d={left:c.offsetLeft,top:c.offsetTop,height:c.offsetHeight};return o.parentNode.removeChild(o),d};return r(n),{rect:a}};function De(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?De=function(t){return typeof t}:De=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(e)}var xr=function(t){return t.contentEditable?t.contentEditable==="true":t.getAttribute("contenteditable")==="true"},wr=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.customPos,o=t.iframe,s=t.noShadowCaret;return o?{iframe:o,window:o.contentWindow,document:o.contentDocument||o.contentWindow.document,noShadowCaret:s,customPos:n}:{window,document,noShadowCaret:s,customPos:n}},Ar=function(t,n){var o=n&&n.window||window,s=n&&n.document||document,r=t.getBoundingClientRect(),a=s.documentElement,l=o.pageXOffset||a.scrollLeft,c=o.pageYOffset||a.scrollTop;return{top:r.top+c,left:r.left+l}},Sr=function(t){return De(t)==="object"&&t!==null},_r=function(t,n){var o=function(){return t.selectionStart},s=function(c){return t.setSelectionRange(c,c),t},r=function(c){var d=Ar(t),i=a(c);return{top:d.top+i.top+n.document.body.scrollTop,left:d.left+i.left+n.document.body.scrollLeft,height:i.height}},a=function(c){var d=function(v){var E=v.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>");return E};(n.customPos||n.customPos===0)&&(c=n.customPos);var i=c===void 0?o():c,p=t.value.slice(0,i),f=t.value.slice(i),g='<span style="position: relative; display: inline;">'.concat(d(p),"</span>");g+='<span id="caret-position-marker" style="position: relative; display: inline;">|</span>',g+='<span style="position: relative; display: inline;">'.concat(d(f),"</span>");var h=yr(t,g),T=h.rect();return T.pos=o(),T};return{getPos:o,setPos:s,getOffset:r,getPosition:a}},kr=function(t,n){var o=function(d){var i=n.window.getSelection();if(i){var p=0,f=!1,g=function h(T,_){for(var v=0;v<_.childNodes.length;v++){var E=_.childNodes[v];if(f)break;if(E.nodeType===3)if(p+E.length>=T){f=!0;var O=n.document.createRange();O.setStart(E,T-p),i.removeAllRanges(),i.addRange(O);break}else p+=E.length;else h(d,E)}};g(d,t)}return t},s=function(){var d=a(),i={height:0,left:0,right:0};if(!d)return i;var p=n.customPos||n.customPos===0;if(d.endOffset-1>0&&d.endContainer!==t||p){var f=d.cloneRange(),g=p?n.customPos:d.endOffset;f.setStart(d.endContainer,g-1<0?0:g-1),f.setEnd(d.endContainer,g);var h=f.getBoundingClientRect();i={height:h.height,left:h.left+h.width,top:h.top},f.detach()}if((!i||i&&i.height===0)&&!n.noShadowCaret){var T=d.cloneRange(),_=n.document.createTextNode("|");T.insertNode(_),T.selectNode(_);var v=T.getBoundingClientRect();i={height:v.height,left:v.left,top:v.top},_.parentNode.removeChild(_),T.detach()}if(i){var E=n.document.documentElement;i.top+=n.window.pageYOffset-(E.clientTop||0),i.left+=n.window.pageXOffset-(E.clientLeft||0)}return i},r=function(){var d=s(),i=l(),p=t.getBoundingClientRect(),f={top:p.top+n.document.body.scrollTop,left:p.left+n.document.body.scrollLeft};return d.left-=f.left,d.top-=f.top,d.pos=i,d},a=function(){if(n.window.getSelection){var d=n.window.getSelection();return d.rangeCount>0?d.getRangeAt(0):null}},l=function(){var d=a(),i=d.cloneRange();i.selectNodeContents(t),i.setEnd(d.endContainer,d.endOffset);var p=i.toString().length;return i.detach(),p};return{getPos:l,setPos:o,getPosition:r,getOffset:s,getRange:a}},Tr=function(t,n){return xr(t)?kr(t,n):_r(t,n)};var sn=function(t,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=o;Sr(n)&&(s=n,n=null);var r=wr(s),a=Tr(t,r);return a.getOffset(n)};var Ne=class extends G{constructor(t){super(t);let n=Array.from(t.knownGroups).map(s=>s.startsWith("~")?s.slice(1):s),o=[...H(".link-user").map(s=>t.anonymizeUsernamesEnabled?(s.dataset.trxUsername??"<unknown>").toLowerCase():s.textContent.replace(/^@/,"").toLowerCase()),...t.userLabels.map(({value:s})=>s.username)].sort((s,r)=>s.localeCompare(r));this.state={groups:new Set(n),groupsHidden:!0,groupsMatches:new Set(n),groupsPosition:void 0,highlightedIndex:0,typingInAutocomplete:!1,usernames:new Set(o),usernamesHidden:!0,usernamesMatches:new Set(o),usernamesPosition:void 0},document.addEventListener("keydown",this.globalInputHandler),document.addEventListener("compositionupdate",this.globalInputHandler),k(`Autocomplete: Initialized with ${this.state.groups.size} groups and ${this.state.usernames.size} usernames.`)}globalInputHandler=t=>{let n=t.target;if(!(n instanceof HTMLTextAreaElement))return;let[o,s]=t instanceof KeyboardEvent?[t.key,t.shiftKey]:[t.data,!1];this.state.typingInAutocomplete&&["Enter","Tab"].includes(o)&&t.preventDefault();let r=(a,l,c)=>{let d=`data-trx-autocomplete-${l}`;o===a&&!n.getAttribute(d)&&(n.setAttribute(d,"true"),n.addEventListener("keyup",i=>{this.textareaInputHandler({key:i.key,prefix:a,shift:i.shiftKey,target:l,textarea:n,values:c})}),this.textareaInputHandler({key:o,prefix:a,shift:s,target:l,textarea:n,values:c}))};r("~","groups",this.state.groups),r("@","usernames",this.state.usernames),["~","@"].includes(o)&&this.setState({typingInAutocomplete:!0})};textareaInputHandler=t=>{let{key:n,prefix:o,shift:s,target:r,textarea:a,values:l}=t,c=a.value;if(!c.includes(o)){this.hide(r);return}let d=a.selectionStart,i=c.slice(0,d).lastIndexOf(o),p=c.slice(i+o.length,d);if(/\s/.test(p)){(n===" "||n==="Backspace")&&this.hide(r);return}let f=new Set([...l].filter(h=>h.toLowerCase().includes(p.toLowerCase())));if(f.size===0){this.hide(r);return}let{highlightedIndex:g}=this.state;if(n==="Enter"){let h=Array.from(f)[g];if(h===void 0){k(`Autocomplete: Attempted to enter undefined match with index ${g}`,!0);return}a.value=c.slice(0,i+o.length)+h+c.slice(d),this.hide(r),g=0;let T=i+o.length+h.length;a.selectionStart=T,a.selectionEnd=T}else n==="Tab"?s?g-=1:g+=1:(this.show(r,sn(a)),this.update(r,f));g<0?g=f.size-1:g>=f.size&&(g=0),this.setState({highlightedIndex:g})};update=(t,n)=>{t==="groups"?this.setState({groupsMatches:n}):t==="usernames"&&this.setState({usernamesMatches:n})};show=(t,n)=>{t==="groups"?this.setState({groupsHidden:!1,groupsPosition:n,typingInAutocomplete:!0}):t==="usernames"&&this.setState({usernamesHidden:!1,usernamesPosition:n,typingInAutocomplete:!0})};hide=t=>{t==="groups"?this.setState({groupsHidden:!0,typingInAutocomplete:!1}):t==="usernames"&&this.setState({usernamesHidden:!0,typingInAutocomplete:!1})};render(){let{groupsMatches:t,highlightedIndex:n,usernamesMatches:o}=this.state,s=[...t].map((f,g)=>b("li",{class:n===g?"highlighted":"",children:["~",f]})),r=[...o].map((f,g)=>b("li",{class:n===g?"highlighted":"",children:["@",f]})),a=this.state.groupsHidden?"trx-hidden":"",l=this.state.usernamesHidden?"trx-hidden":"",c=this.state.groupsPosition?.left??0,d=(this.state.groupsPosition?.top??0)+(this.state.groupsPosition?.height??0),i=this.state.usernamesPosition?.left??0,p=(this.state.usernamesPosition?.top??0)+(this.state.usernamesPosition?.height??0);return b(j,{children:[b("ul",{id:"trx-autocomplete-usernames",class:`trx-autocomplete ${l}`,style:`left: ${i}px; top: ${p}px`,children:r}),b("ul",{id:"trx-autocomplete-groups",class:`trx-autocomplete ${a}`,style:`left: ${c}px; top: ${d}px`,children:s})]})}};var ln=oe(at(),1);var Be=class extends G{constructor(){super(),this.state={hidden:!0},window.addEventListener("scroll",(0,ln.default)(this.scrollHandler,150)),this.scrollHandler(),k("Back To Top: Initialized.")}scrollHandler=()=>{this.setState({hidden:window.scrollY<500})};scrollToTop=()=>{window.scrollTo({behavior:"smooth",top:0})};render(){let t=this.state.hidden?"trx-hidden":"";return b("a",{id:"trx-back-to-top",class:`btn btn-primary ${t}`,onClick:this.scrollToTop,children:"Back To Top"})}};var we=et;function cn(e){e.parentElement?.nextElementSibling?.getAttribute("data-trx-hide-topics-spacer")===null&&e.parentElement.insertAdjacentElement("afterend",fe('<li class="trx-hidden" data-trx-hide-topics-spacer></li>')),e.classList.add("trx-hidden"),e.dataset.trxHideTopics=""}async function un(e){let t=ze(),n=await X("hide-topics"),o=H(".topic-listing .topic:not([data-trx-hide-topics])"),s=[],r=[],a=new Set,l=!1;for(let i of n){let{matcher:p,value:f}=i.value;switch(p){case we.DomainIncludes:{s.push(f.toLowerCase());break}case we.TildesUsernameEquals:{a.add(f.toLowerCase());break}case we.TitleIncludes:{r.push(f.toLowerCase());break}case we.UserLabelEquals:{for(let g of e)f===g.value.text&&a.add(g.value.username.toLowerCase());break}case we.VotedOnTopic:{l=!0;break}default:console.warn(`Unknown HideTopicMatcher: ${p}`)}}let c=0,d=i=>{cn(i),c++};for(let i of o){let p=(i.dataset.topicPostedBy??"<unknown>").toLowerCase();if(a.has(p)){d(i);continue}let f=(i.querySelector(".topic-title")?.textContent??"").toLowerCase();if(r.some(h=>f.includes(h))){d(i);continue}let g=new URL(i.querySelector(".topic-title a").href);if(s.some(h=>g.hostname.includes(h))){d(i);continue}if(t&&l&&i.querySelector(".btn-used.topic-voting")!==null){d(i);continue}}if(c>0&&document.querySelector("#trx-hide-topics-button")===null){let i=document.createElement("div");K(b(lt,{hiddenTopicsCount:c}),i),ie("#sidebar").insertAdjacentElement("beforeend",i)}k(`Hide Topics: Initialized for ${c} topics.`)}var lt=class extends G{constructor(t){super(t),this.state={hiddenTopicsCount:this.getHiddenTopics().length,hidden:!0}}getHiddenTopics=()=>H("[data-trx-hide-topics]");toggleHidden=()=>{let{hidden:t}=this.state;if(t)for(let n of H("[data-trx-hide-topics-spacer]"))n.remove();for(let n of this.getHiddenTopics())t?n.classList.remove("trx-hidden"):cn(n);this.setState({hidden:!t})};render(){let{hidden:t,hiddenTopicsCount:n}=this.state,o=se(n,"topic");return b("button",{id:"trx-hide-topics-button",class:"btn primary",onClick:this.toggleHidden,children:[t?"Unhide":"Hide"," ",n," ",o]})}};function mn(e){let t=Cr(e);k(`Hide Votes: Initialized for ${t} votes.`)}function Cr(e){let t=0,n=Wt()??"<logged out>";return(e.otherComments||e.ownComments)&&(t+=Er(e,n)),(e.otherTopics||e.ownTopics)&&(t+=Lr(e,n)),t}function Er(e,t){let n=0;for(let o of H(".comment-itself")){let s=o.querySelector("header .link-user")?.textContent?.trim()===t;if(e.otherComments&&!s){let r=o.querySelector('.btn-post-action[data-ic-put-to*="/vote"]:not(.trx-votes-hidden)')??o.querySelector('.btn-post-action[data-ic-delete-from*="/vote"]:not(.trx-votes-hidden)')??o.querySelector(".comment-votes:not(.trx-votes-hidden)");if(r===null)continue;if(n++,r.classList.add("trx-votes-hidden"),r.tagName==="BUTTON"){if(!r.textContent.includes(" "))continue;r.textContent=r.textContent.slice(0,r.textContent.indexOf(" "))}else r.classList.add("trx-hidden")}else if(e.ownComments&&s){let r=o.querySelector(".comment-votes:not(.trx-votes-hidden)");if(r===null)continue;n++,r.classList.add("trx-votes-hidden","trx-hidden")}}return n}function Lr(e,t){let n=0;for(let o of H(".topic",".topic-full")){let s=o.dataset.topicPostedBy;o.classList.contains("topic-full")&&(s=document.querySelector(".topic-full-byline .link-user")?.textContent??void 0);let r=s===t,a;(e.otherTopics&&!r||e.ownTopics&&r)&&(a=o.querySelector(".topic-voting-votes")??void 0),a!==void 0&&(a.classList.add("trx-votes-hidden"),a.textContent="-",n++)}return n}var Fe=class extends G{constructor(){super();let t=H(".comment.is-comment-new").length;this.state={hidden:!1,newCommentCount:t,previousComment:void 0},t===0?k("Jump To New Comment: 0 new comments found, not doing anything."):k(`Jump To New Comment: Initialized for ${t} new comments.`)}jump=()=>{this.state.previousComment?.classList.remove("is-comment-new");let t=document.querySelector(".comment.is-comment-new");if(t===null){k("Jump To New Comment: Final comment reached, hiding the button."),this.setState({hidden:!0});return}t.offsetParent===null&&ie("[data-js-comment-expand-all-button]").click(),t.scrollIntoView({behavior:"smooth"}),this.setState({previousComment:t})};render(){if(this.state.newCommentCount===0)return;let n=H(".comment.is-comment-new").length,o=this.state.hidden?"trx-hidden":"";return b("a",{id:"trx-jump-to-new-comment",class:`btn btn-primary ${o}`,onClick:this.jump,children:["Jump To New Comment (",n,"/",this.state.newCommentCount,")"]})}};function dn(e){let t=Pr(e);if(t>0){let n=e.filter(o=>o.value.shortcut!==void 0).map(o=>[o,tn(o.value.shortcut)]);!document.body.dataset.trxMarkdownToolbarKeydownListening&&n.length>0&&(document.addEventListener("keydown",async o=>{await Ur(o,n)}),document.body.dataset.trxMarkdownToolbarKeydownListening="true",k("Markdown Toolbar: Listening for keyboard shortcuts.")),k(`Markdown Toolbar: Initialized for ${t} textareas.`)}}function Pr(e){let t=H(".form-markdown:not(.trx-toolbar)");if(t.length===0)return 0;for(let n of t){n.classList.add("trx-toolbar");let o=n.querySelector(".tab-markdown-mode"),s=n.querySelector('textarea[name="markdown"]'),r=e.filter(c=>!c.value.inDropdown).map(c=>b(Mr,{allSnippets:e,snippet:c,textarea:s})),a=e.length===r.length,l=document.createElement("div");if(o.append(l),K(r,o,l),!a){let c=document.createElement("div"),d=o.parentElement;o.after(c),K(b(j,{children:b(Or,{allSnippets:e,textarea:s})}),d,c)}}return t.length}function Mr(e){return b("li",{class:"tab-item",children:b("button",{class:"btn btn-link",onClick:n=>{n.preventDefault(),ct(e)},children:e.snippet.value.name})})}function Or(e){let t=e.allSnippets,n=t?.filter(s=>s.value.inDropdown).map(s=>b("option",{value:s.value.name,children:s.value.name}));return n.length===0?null:b("select",{class:"form-select",onChange:s=>{s.preventDefault();let r=t.find(a=>a.value.name===s.target.value);ct({...e,snippet:r}),s.target.selectedIndex=0},children:[b("option",{children:"More\u2026"}),n]})}function ct(e){let{textarea:t,snippet:n}=e,{selectionStart:o,selectionEnd:s}=t;t.focus();let{markdown:r}=n.value,a=r.indexOf("<cursor>");r=r.replace("<cursor>","");let l=r.indexOf("<selected-cursor>");r=r.replace("<selected-cursor>",""),a!==-1&&l!==-1&&a>l&&(a-="<selected-cursor>".length),a===-1&&(a=0);let c=a,d=r.length;o!==s&&(r=r.slice(0,a)+t.value.slice(o,s)+r.slice(a),c=l===-1?a:l),t.value=t.value.slice(0,o)+r+t.value.slice(s),c===0&&(c=d),t.selectionEnd=s+c}async function Ur(e,t){let n=e.target;if(!(n instanceof HTMLTextAreaElement))return;let[o,s,r,a]=[e.key.toLowerCase(),e.altKey,e.ctrlKey,e.shiftKey];for(let[l,c]of t)if(c.key===o&&c.alt===s&&c.ctrl===r&&c.shift===a){e.preventDefault(),ct({snippet:l,textarea:n});break}}function pn(){let e=Ir();if(e>0){let t=`${e} ${se(e,"comment")}`;k(`Comment Anchor Fix applied, uncollapsed ${t}.`)}}function Ir(){let e=window.location.hash;if(!/^#comment-[a-z\d]+$/i.test(e))return 0;let t=document.querySelector(e)??void 0;if(t===void 0)return 0;let n=gn(t.firstElementChild??t,0);return n>0&&t.scrollIntoView({behavior:"smooth"}),n}function gn(e,t){let n=e.parentElement??void 0;if(n===void 0||n.id==="comments")return t;for(let o of["is-comment-collapsed","is-comment-collapsed-individual"])n.classList.contains(o)&&(n.classList.remove(o),t++);return gn(n,t)}function fn(){let e=$r();if(e>0){let t=`${e} ${se(e,"subscribe button")}`;k(`Added ${t} to the group list`)}}function $r(){if(window.location.pathname!=="/groups")return 0;let e=0;for(let t of H(".group-list li:not(.trx-group-list-subscribe-button)")){let n=t.querySelector(".link-group")?.textContent?.slice(1);if(n===void 0){k("Missing expected group in list item",!0),k(t,!0);continue}let o=document.createDocumentFragment();K(b(ut,{group:n,listItem:t}),o);let s=t.querySelector(".group-list-activity")??void 0;s===void 0?t.append(o):s.before(o),t.classList.add("trx-group-list-subscribe-button"),e++}return e}var ut=class extends G{constructor(t){super(t),this.state={isSubscribed:t.listItem.classList.contains("group-list-item-subscribed")}}clickHandler=async()=>{let{group:t}=this.props,{isSubscribed:n}=this.state,o=await Nt(`https://tildes.net/api/web/group/${t}/subscribe`,{method:n?"DELETE":"PUT"});if(o.status!==200){k(`Unexpected status code: ${o.status}`,!0);return}this.setState({isSubscribed:!n})};render(){let{listItem:t}=this.props,{isSubscribed:n}=this.state;return n?(t.classList.add("group-list-item-subscribed"),t.classList.remove("group-list-item-not-subscribed")):(t.classList.add("group-list-item-not-subscribed"),t.classList.remove("group-list-item-subscribed")),b("button",{class:`btn btn-sm ${n?"btn-used":""}`,onClick:this.clickHandler,children:n?"Unsubscribe":"Subscribe"})}};function hn(){Hr(),k("Username has been hidden.")}function Hr(){let e=ie(".logged-in-user-username");e.dataset.trxHideOwnUsername=e.textContent,e.textContent="Username"}function bn(){let e=zr();if(e>0){let t=`${e} ${se(e,"topic")}`;k(`Show Topic Author applied to ${t}.`)}}function zr(){let e=H(".topic-listing .topic:not([data-trx-show-topic-author])"),t=0;for(let n of e){let o=n.querySelector(".topic-info-source");if(o?.querySelector(".link-user")!==null)continue;let s=n.dataset.topicPostedBy;s!==void 0&&s.toLowerCase()!=="tildes"&&(o.insertAdjacentElement("afterbegin",fe(`<a class="link-user" href="/user/${s}">${s}</a>`)),n.dataset.trxShowTopicAuthor="true",t++)}return t}function vn(){let e=Rr();if(e>0){let t=`${e} ${se(e,"ignore button")}`;k(`Moved ${t}`)}}function Rr(){let e=0;for(let t of H("article.topic:not(.trx-topic-info-ignore)")){let n=t.querySelector(".topic-info")??void 0;if(n===void 0)continue;let o=t.querySelector('[name="topic-actions-ignore"]')??void 0;o!==void 0&&(t.classList.add("trx-topic-info-ignore"),n.append(o),e++)}return e}var Se=oe(Ln(),1);function Mn(){let e=jr();e>0&&k(`Topic Log Enhancements: Applied to ${e} topic log entries.`)}function jr(){let e=document.querySelector(".topic-log-listing:not([data-trx-topic-log-enhancements])")??void 0;if(e===void 0)return 0;ie("details.topic-log").open=!0;let t=e.querySelectorAll(".topic-log-entry"),n=[];for(let o of Array.from(t)){let s=o.querySelector(".link-user")?.textContent??void 0,r=o.textContent??void 0;if(r===void 0){k("Undefined topic log entry text encountered, this should be unreachable.",!0);continue}r=r.replace(/\s+/g," ").trim(),r=r.slice(r.indexOf(" ")+1);let a=r.lastIndexOf("("),l=r.slice(a);r=r.slice(0,a-1);let c=r.startsWith("(OP) ");c&&(r=r.slice(5)),r.startsWith("user ")&&(r=r.slice(5)),n.push(b(Kr,{editedByAuthor:c,editor:s,text:r,timestamp:l})),o.remove()}return e.dataset.trxTopicLogEnhancements="true",K(n,e),n.length}function Kr(e){let{editedByAuthor:t,editor:n,text:o,timestamp:s}=e,r=n?b("a",{class:"link-user",href:`/user/${n}`,children:n}):"Unknown user",a=t?b(j,{children:["(",b("abbr",{title:"Original Poster (of the topic)",children:"OP"}),")"]}):void 0,l=Xr(o);return b("li",{class:"topic-log-entry",children:[r," ",a," ",l.title," ",s," ",b("br",{})," ",l.body]})}function Xr(e){if(e.startsWith("added tag")||e.startsWith("removed tag")){let t=e.includes("' and removed tag")?e.split("' and "):[e],{added:n}=/^added tags? (?<added>.+)$/g.exec(t[0])?.groups??{},{removed:o}=/^removed tags? (?<removed>.+)$/g.exec(t[1]??t[0])?.groups??{},s=[],r=window.location.pathname.slice(0,window.location.pathname.indexOf("/",1));if(o!==void 0){let a=o.replace(/'/g,"").split(", ");s.push(...a.map(l=>b(j,{children:[b("span",{class:"trx-topic-log-diff-from",children:b("a",{href:`${r}?tag=${l}`,children:l})}),b("br",{})]})))}if(n!==void 0){let a=n.replace(/'/g,"").split(", ");s.push(...a.map(l=>b(j,{children:[b("span",{class:"trx-topic-log-diff-to",children:b("a",{href:`${r}?tag=${l}`,children:l})}),b("br",{})]})))}return{body:b(j,{children:s}),title:"edited the tags"}}if(e.startsWith("changed link from")){let{from:t,to:n}=/(?<from>http.+) to (?<to>http.+)$/g.exec(e).groups;return{body:b(Pn,{from:t,to:n}),title:"edited the link"}}if(e.startsWith("changed title from")){let{from:t,to:n}=/"(?<from>.+)" to "(?<to>.+)"$/g.exec(e).groups;return{body:b(Pn,{from:t,to:n}),title:"edited the title"}}if(e.includes("locked comments")){let t=e.startsWith("locked");return{body:t?"New comments can not be posted.":"New comments can be posted again.",title:`${t?"":"un"}locked the topic`}}if(e.startsWith("moved from")){let{from:t,to:n}=/(?<from>~.+) to (?<to>~.+)/g.exec(e).groups;return{body:b(j,{children:["From"," ",b("a",{class:"link-group",href:`/${t}`,children:t})," ","to"," ",b("a",{class:"link-group",href:`/${n}`,children:n})]}),title:"moved the topic"}}if(e.includes("removed")){let t=e.startsWith("removed");return{body:t?"The topic was removed by a site administrator.":"The topic has been made available again.",title:`${t?"":"un-"}removed the topic`}}return k(`Unhandled topic log entry: ${e}`,!0),{body:Ht(e),title:""}}function Pn({from:e,to:t}){let n=[],o=[];for(let[s,r]of(0,Se.default)(e,t))switch(s){case Se.default.EQUAL:{n.push(r),o.push(r);break}case Se.default.INSERT:{o.push(b("span",{class:"trx-topic-log-diff-insert",children:r}));break}case Se.default.DELETE:{n.push(b("span",{class:"trx-topic-log-diff-delete",children:r}));break}}return b(j,{children:[b("span",{class:"trx-topic-log-diff-from",children:n}),b("br",{}),b("span",{class:"trx-topic-log-diff-to",children:o})]})}function On(){Yr()&&k("Added Unignore All button.")}function Yr(){if(window.location.pathname!=="/ignored_topics"||document.querySelector("main > .empty")!==null)return!1;let e=document.querySelector(".heading-main")??void 0;if(e===void 0)return!1;let t=document.createDocumentFragment();return K(b(gt,{}),t),e.after(t),!0}var gt=class extends G{constructor(t){super(t),this.state={isRunning:!1,remaining:0,total:0,wasCanceled:!1}}click=()=>{if(this.state.isRunning){this.setState({isRunning:!1,wasCanceled:!0}),window.setTimeout(()=>{this.setState({wasCanceled:!1})},5e3);return}let t=H('button[name="topic-actions-ignore"][data-ic-delete-from]');this.setState({isRunning:!0,remaining:t.length,total:t.length}),this.unignoreAll(t)};unignoreAll=async t=>{let n=t.length;for(let o of t){if(!this.state.isRunning&&this.state.wasCanceled)return;o.click(),n--,this.setState({remaining:n}),await He(250)}this.setState({isRunning:!1})};render(){let{isRunning:t,remaining:n,total:o,wasCanceled:s}=this.state,r="Unignore All";return t?r=`Unignoring topics, ${n} out of ${o} remaining`:s&&(r="Canceled unignoring all topics"),b("button",{class:"btn",onClick:this.click,children:r})}};async function In(){let e=await X("theme-switcher"),t=await Zr(e.value);t!==void 0&&k(`Theme Switcher: Switched to ${t}`)}async function Zr(e){let[t,n,o]=[new Date,Un(e.hourA),Un(e.hourB)].map(a=>a.getTime()),s=t>n&&t<=o?e.themeA:e.themeB,r=document.querySelector("select#theme")??void 0;if(r===void 0)return Ye(s),s;if(r.value!==s)return r.value=s,Ye(s),He(2e3).then(()=>{r.dispatchEvent(new Event("change"))}),s}function Un(e){let t=e.split(":").map(Number).map(o=>Number.isNaN(o)?0:o),n=new Date;return n.setHours(t[0]),n.setMinutes(t[1]),n.setSeconds(0,0),n}function Hn(){Qr()&&k("Themed Logo: Initialized.")}var $n=`
<svg xmlns="http://www.w3.org/2000/svg" width="32px" height="32px" viewBox="0 0 100 100">
  <rect fill="var(--background-primary-color)" width="100" height="100"/>
  <rect fill="var(--comment-label-joke-color)" width="12.5" height="12.5" x="0" y="50"/>
  <rect fill="var(--comment-label-offtopic-color)" width="12.5" height="12.5" x="12.5" y="37.5"/>
  <rect fill="var(--comment-label-exemplary-color)" width="12.5" height="12.5" x="25" y="25"/>
  <rect fill="var(--stripe-mine-color)" width="12.5" height="12.5" x="37.5" y="37.5"/>
  <rect fill="var(--button-used-color)" width="12.5" height="12.5" x="50" y="50"/>
  <rect fill="var(--comment-label-malice-color)" width="12.5" height="12.5" x="62.5" y="62.5"/>
  <rect fill="var(--alert-color)" width="12.5" height="12.5" x="75" y="50"/>
  <rect fill="var(--comment-label-noise-color)" width="12.5" height="12.5" x="87.5" y="37.5"/>
</svg>
`;function Qr(){let e=ie(".site-header-logo");if(e.dataset.trxThemedLogo==="true")return!1;let t=$n;for(let o of $n.match(/var\(--.+\)/g)??[]){let s=window.getComputedStyle(document.body).getPropertyValue(o.slice(4,-1));s===""&&(s="#f0f"),t=t.replace(o,s)}let n=encodeURIComponent(t);return e.dataset.trxThemedLogo="true",e.style.backgroundImage=`url("data:image/svg+xml,${n}")`,!0}var ft=oe(at(),1);var Ge=class extends G{constructor(t){super(t);let n=window.getComputedStyle(document.body).getPropertyValue(Ie[1].value).trim();this.state={color:n,hidden:!0,id:void 0,text:"",priority:0,selectedColor:n,target:void 0,username:""};let o=this.addLabelsToUsernames(H(".link-user"));k(`User Labels: Initialized for ${o} user links.`)}hide=()=>{this.setState({hidden:!0})};addLabelsToUsernames=(t,n)=>{let{onSiteNewLabelEnabled:o,userLabels:s}=this.props,r=document.querySelector(".topic-listing")!==null,a=s.sort((l,c)=>{if(r){if(l.value.priority!==c.value.priority)return c.value.priority-l.value.priority}else if(l.value.priority!==c.value.priority)return l.value.priority-c.value.priority;return c.value.text.localeCompare(l.value.text)});for(let l of t){let c=l.textContent.replace(/@/g,"");this.props.anonymizeUsernamesEnabled&&(c=l.dataset.trxUsername??c);let d=a.filter(({value:p})=>p.username.toLowerCase()===c.toLowerCase()&&(n===void 0?!0:p.id===n)),i=b("span",{class:"trx-user-label-add",onClick:p=>{this.addLabelHandler(p,c)},children:"[+]"});if(o&&!r&&n===void 0){let p=document.createElement("span");l.after(p),K(i,l.parentElement,p)}if(d.length===0&&n===void 0){if(o&&r&&(l.nextElementSibling===null||!l.nextElementSibling.className.includes("trx-user-label"))){let p=document.createElement("span");l.after(p),K(i,l.parentElement,p)}continue}for(let p of d){let f=ge(p.value.color.trim())?"trx-bright":"",g=fe(`<span
          data-trx-label-id="${p.value.id}"
          class="trx-user-label ${f}"
        >
          ${p.value.text}
        </span>`);if(g.addEventListener("click",h=>{this.editLabelHandler(h,p.value.id)}),l.after(g),g.setAttribute("style",`background-color: ${p.value.color};`),r)break}}return t.length};addLabelHandler=(t,n)=>{t.preventDefault();let o=t.target;if(this.state.target===o&&!this.state.hidden)this.hide();else{let s=window.getComputedStyle(document.body).getPropertyValue(Ie[1].value).trim();this.setState({hidden:!1,target:o,username:n,color:s,id:void 0,text:"",priority:0,selectedColor:s})}};editLabelHandler=(t,n)=>{t.preventDefault();let o=t.target;if(this.state.target===o&&!this.state.hidden)this.hide();else{let s=this.props.userLabels.find(({value:r})=>r.id===n);if(s===void 0){k("User Labels: Tried to edit label with ID that could not be found.",!0);return}this.setState({hidden:!1,target:o,color:s.value.color,id:s.value.id,priority:s.value.priority,text:s.value.text,username:s.value.username})}};colorChange=t=>{let n=t.target.value.toLowerCase();t.target.tagName==="SELECT"?this.setState({color:n,selectedColor:n}):this.setState({color:n})};labelChange=t=>{this.setState({text:t.target.value})};priorityChange=t=>{this.setState({priority:Number(t.target.value)})};save=async t=>{t.preventDefault();let{color:n,id:o,text:s,priority:r,username:a}=this.state;if(n===""||a===""){k("Cannot save user label without all values present.");return}let{userLabels:l}=this.props;if(o===void 0){let c=await Xt();l.push(await Re({color:n,id:c,priority:r,text:s,username:a})),this.addLabelsToUsernames(H(".link-user"),c)}else{let c=l.findIndex(({value:p})=>p.id===o);await l.splice(c,1)[0].remove(),l.push(await Re({id:o,color:n,priority:r,text:s,username:a}));let d=H(`[data-trx-label-id="${o}"]`),i=ge(n);for(let p of d)p.textContent=s,p.setAttribute("style",`background-color: ${n};`),i?p.classList.add("trx-bright"):p.classList.remove("trx-bright")}await Kt(l),this.props.userLabels=l,this.hide()};remove=async t=>{t.preventDefault();let{id:n}=this.state;if(n===void 0){k("User Labels: Tried remove label when ID was undefined.");return}let{userLabels:o}=this.props,s=o.findIndex(({value:r})=>r.id===n);if(s===void 0){k(`User Labels: Tried to remove label with ID ${n} that could not be found.`,!0);return}for(let r of H(`[data-trx-label-id="${n}"]`))r.remove();for(let r of o.splice(s,1))await r.remove();this.props.userLabels=o,this.hide()};render(){let t=window.getComputedStyle(document.body),n=Ie.map(({name:T,value:_})=>b("option",{value:t.getPropertyValue(_).trim(),children:T})),o=ge(this.state.color)?"trx-bright":"",s=this.state.hidden?"trx-hidden":"",{color:r,text:a,priority:l,selectedColor:c,username:d}=this.state,i=0,p=0,f=this.state.target;if(f!==void 0){let T=f.getBoundingClientRect();i=T.y+T.height+4+window.scrollY,p=T.x+window.scrollX}let g=`left: ${p}px; top: ${i}px;`,h=`background-color: ${r}`;return b("form",{class:`trx-user-label-form ${s}`,style:g,children:[b("div",{class:"trx-label-username-priority",children:[b("label",{class:"trx-label-username",children:["Add New Label",b("input",{type:"text",class:"form-input",placeholder:"Username",value:d,required:!0})]}),b("label",{class:"trx-label-priority",children:["Priority",b("input",{type:"number",class:"form-input",value:l,onChange:this.priorityChange,required:!0})]})]}),b("div",{children:[b("label",{for:"trx-label-color-input",children:"Pick A Color"}),b("div",{class:"trx-label-grid",children:[b("input",{id:"trx-label-color-input",type:"text",class:"form-input",placeholder:"Color",value:r,onInput:(0,ft.default)(this.colorChange,250),required:!0}),b("select",{class:"form-select",value:c,onChange:this.colorChange,children:n})]})]}),b("div",{children:[b("label",{for:"trx-label-input",children:"Label"}),b("div",{class:"trx-label-grid",children:[b("input",{id:"trx-label-input",type:"text",class:"form-input",placeholder:"Text",value:a,onInput:(0,ft.default)(this.labelChange,250)}),b("div",{class:`trx-label-preview ${o}`,style:h,children:b("p",{children:a})})]})]}),b("div",{class:"trx-label-actions",children:[b("a",{class:"btn-post-action",onClick:this.save,children:"Save"}),b("a",{class:"btn-post-action",onClick:this.hide,children:"Close"}),b("a",{class:"btn-post-action",onClick:this.remove,children:"Remove"})]})]})}};async function zn(e,t,n){let o=await eo(e,t,n);k(`Username Colors: Applied ${o} colors.`)}async function eo(e,t,n){let o=new Map;for(let{value:{color:a,username:l}}of e)for(let c of l.split(","))o.set(c.trim().toLowerCase(),a);let s=0,r=H(".link-user:not(.trx-username-colors)");for(let a of r){if(a.classList.contains("trx-username-colors"))continue;let l=a.textContent?.replace(/@/g,"").trim().toLowerCase()??"<unknown>";t&&(l=a.dataset.trxUsername?.toLowerCase()??l),a.classList.add("trx-username-colors");let c=o.get(l);if(c!==void 0)a.style.color=c;else if(n){a.classList.add("trx-random-username-color");let d=await zt(l),i=ge(d)?"#000":"#FFF";a.style.setProperty("--background-color",d),a.style.setProperty("--link-color",i)}else continue;s+=1}return s}async function to(){let e=window.performance.now();Rt();let t=await X("enabled-features"),n=await X("miscellaneous-enabled-features");window.TildesReExtended.debug=t.value.has("debug");let o=new Set(["autocomplete"]),s=await X("known-groups"),r=new Set(["theme-switcher"]),a=await X("themes-list"),l=await X("themes-list-updated-date"),c=await X("user-labels"),d=ze();if(d||k("User is not logged in, running with limited features enabled.",!0),Array.from(o).some(v=>t.value.has(v))){let v=Dt();v!==void 0&&(s.value=new Set(v),await s.save())}if(Date.now()-l.value.getTime()>24*60*60*1e3&&Array.from(r).some(v=>t.value.has(v))){let v=Ft();v!==void 0&&(a.value=v,await a.save(),l.value=new Date,await l.save(),k("Updated locally saved themes list."))}let i=t.value.has("anonymize-usernames"),p=[],f=new window.MutationObserver(async()=>{k("Page mutation detected, rerunning features."),f.disconnect(),await Promise.all(p.map(async v=>v())),g()});function g(){f.observe(document.body,{attributes:!0,childList:!0,subtree:!0})}if(i){let v=await X("anonymize-usernames");p.push(async()=>{await nn(v.value)})}t.value.has("hide-topics")&&p.push(async()=>{await un(c)}),t.value.has("hide-votes")&&p.push(async()=>{let v=await X("hide-votes");mn(v.value)}),t.value.has("markdown-toolbar")&&d&&p.push(async()=>{let v=await en();dn(v)}),t.value.has("theme-switcher")&&await In(),t.value.has("themed-logo")&&p.push(()=>{Hn()}),t.value.has("username-colors")&&p.push(async()=>{let v=await X("username-colors"),E=await X("randomize-username-colors");await zn(v,i,E.value)}),await Promise.all(p.map(async v=>v()));let h={};if(t.value.has("autocomplete")&&d&&(h.autocomplete=b(Ne,{anonymizeUsernamesEnabled:i,knownGroups:s.value,userLabels:c})),t.value.has("back-to-top")&&(h.backToTop=b(Be,{})),t.value.has("jump-to-new-comment")&&d&&(h.jumpToNewComment=b(Fe,{})),t.value.has("user-labels")){let v=await X("on-site-new-label");h.userLabels=b(Ge,{anonymizeUsernamesEnabled:i,onSiteNewLabelEnabled:v.value,userLabels:c})}t.value.has("miscellaneous-features")&&(n.value.has("comment-anchor-fix")&&pn(),n.value.has("group-list-subscribe-buttons")&&d&&fn(),n.value.has("hide-own-username")&&d&&hn(),n.value.has("show-topic-author")&&bn(),n.value.has("topic-info-ignore")&&d&&vn(),n.value.has("topic-log-enhancements")&&Mn(),n.value.has("unignore-all-button")&&d&&On());let T=document.createElement("div");document.body.append(T),K(b("div",{id:"trx-container",children:[h.jumpToNewComment," ",h.backToTop,h.autocomplete," ",h.userLabels]}),document.body,T),p.length>0&&g();let _=window.performance.now()-e;k(`Initialized in approximately ${_} milliseconds.`)}document.addEventListener("DOMContentLoaded",to);
/*! Bundled license information:

platform/platform.js:
  (*!
   * Platform.js v1.3.6
   * Copyright 2014-2020 Benjamin Tan
   * Copyright 2011-2013 John-David Dalton
   * Available under MIT license
   *)
*/
