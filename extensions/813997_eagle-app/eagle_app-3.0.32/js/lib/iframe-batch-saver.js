(()=>{let i=chrome||browser;if(eagle.env.isBackground()){let n,s=[],l,r;i.runtime.onMessage.addListener((e,a,t)=>("batch-save-iframe"===e.channel&&(s=[],n=t,i.tabs.query({active:!0,currentWindow:!0},e=>{r=setTimeout(()=>{n&&(n({}),n=void 0)},2e3),i.tabs.sendMessage(e[0].id,{channel:"batch-save-iframe"},e=>{clearTimeout(r)})})),!0)),i.runtime.onMessage.addListener((e,a,t)=>("batch-save-iframe-response"===e.channel&&((e=e.data)&&0<e.length&&s.push(e),clearTimeout(l),l=setTimeout(()=>{n&&n({data:s}),s=[],n=void 0},500)),!0))}else(async()=>{class n{async getCollectableItems(){var e,a=await eagle.elementCollector.getCollectableItems();for(e of a){var t=await eagle.elementInspector.getMeta(e.element);e.elementMeta=t,delete e.element}return a}}window.self!==window.top&&jQuery(document).ready(e=>{i.runtime.onMessage.addListener((e,a,t)=>("batch-save-iframe"===e.channel&&(async()=>{var e=await(new n).getCollectableItems();i.runtime.sendMessage({channel:"batch-save-iframe-response",data:e})})(),!0))})})()})();