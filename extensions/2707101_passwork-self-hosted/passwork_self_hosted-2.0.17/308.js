"use strict";(self.webpackChunk_passwork_extension=self.webpackChunk_passwork_extension||[]).push([[308],{43953:function(e,t,n){n.d(t,{W:function(){return o}});var i=n(71090);const o=({isInFocus:e,error:t,isPopup:n})=>(0,i.k)({invisibleInput:{opacity:0,position:"fixed",top:-20,height:10,width:10},pinInputs:{display:"grid",gridTemplateColumns:"auto auto auto auto",justifyContent:n?"center":"flex-start",gridGap:12,width:n?"100%":"fit-content",margin:n?"auto":"0 auto",marginBottom:n?"25px":0},pinCell:{boxSizing:"border-box",height:70,width:45,padding:0,position:"relative",display:"grid",placeItems:"center",borderRadius:"8px",background:e=>e.palette.popup.background,border:n=>`1px solid ${t?n.palette.error.main:e?n.palette.primary.main:n.palette.elementWithHover.backgroundHover}`},dot:{height:8,width:8,borderRadius:"50%",background:e=>e.palette.inputElements.main},caretBlink:{animation:"caretAnimation 1s infinite","@keyframes caretAnimation":{"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}},caret:{background:e=>e.palette.inputElements.main,width:"1px",height:24,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",opacity:0},setAgain:{display:"flex",justifyContent:"center",marginTop:"35px","& div":{display:"flex",alignItems:"center",cursor:"pointer"}}})},90565:function(e,t,n){var i=n(52322),o=n(47746),s=n(42921),a=n(24394),r=n(79312),l=n(2784),c=n(67876),p=n(43953),u=n(18747),d=n(31611),g=n(25539),f=n(71382),h=n(51730),m=n(95025),y=n(75234),x=n(18322),P=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((i=i.apply(e,t||[])).next())}))};const v=({value:e,isInFocus:t,showError:n,isPopup:o})=>{const{pinCell:a,dot:r,caret:l,caretBlink:c}=(0,p.W)({error:n,isInFocus:t,isPopup:o});return(0,i.jsx)(s.Z,Object.assign({sx:a},{children:e?(0,i.jsx)(s.Z,{sx:r}):(0,i.jsx)(s.Z,{sx:t?Object.assign(Object.assign({},l),c):null})}))};t.Z=({extensionUnlock:e,isPopup:t=!1,close:n,setShowError:S,setCloseTimer:Z,setTitleVariant:b,pinMode:w,navigateToSettings:k,navigateToHost:j,mandatoryPin:E,openHomePage:A})=>{const[C,I]=(0,l.useState)(!1),[O,Y]=(0,l.useState)(!1),[H,F]=(0,l.useState)(""),[N,T]=(0,l.useState)(""),[G,W]=(0,l.useState)(""),[D,L]=(0,l.useState)(!1),[B,M]=(0,l.useState)(!1),z=(0,l.useRef)(null),{pinInputs:$,invisibleInput:R,setAgain:U}=(0,p.W)({isPopup:t}),_=(0,u.z)(),V=(0,o.Z)(),{t:K}=(0,y.$G)(),Q=()=>P(void 0,void 0,void 0,(function*(){if(w===g.eY.deletePin||w===g.eY.changePin)return void(N!==H?J(!0):(w===g.eY.deletePin&&(yield c.ZP.SetPin(""),k&&k(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:K("common:notification:pinRemoved")}}))),L(!0),T(""),b&&b(g.b0.changeEnterNew)));let i=yield c.ZP.GetPinEntryAttempts();if(yield c.ZP.SetPinEntryAttempts(i+1),i=yield c.ZP.GetPinEntryAttempts(),N===H){if(yield c.ZP.SetExtensionLocked(!1),yield c.ZP.SetPinEntryAttempts(0),!t){const e=yield c.ZP.GetAutoLockSettings();e.lastActive=Date.now()/1e3,yield c.ZP.SetAutoLockSettings(e)}e()}else if(Y(!0),i>=5){if(S&&S(!0),t)try{yield x.Z.passwork.logout()}catch(e){console.log(e)}else chrome.runtime.sendMessage({type:"endSession"},(()=>P(void 0,void 0,void 0,(function*(){}))));(0,f.G6)()?(yield c.ZP.SetPin(""),yield c.ZP.DeleteApiKey(),yield c.ZP.DeleteMasterPass(),yield c.ZP.DeleteApiToken(),yield c.ZP.DeleteCombinedToken(),yield c.ZP.DeleteUserInfo(),yield c.ZP.SetExtensionLocked(!1),yield c.ZP.DeleteLastOpenedPage(),yield c.ZP.DeleteVersionInfo(),yield c.ZP.SetHost(""),yield c.ZP.SetPinEntryAttempts(0),yield chrome.runtime.sendMessage({type:"removeContentScriptPresence"})):(yield c.ZP.SetHost(""),yield c.ZP.SetPinEntryAttempts(0),yield(0,f.s1)(!0)),setTimeout((()=>P(void 0,void 0,void 0,(function*(){!t&&n&&n(),t&&j&&j(),Z&&Z(!1)}))),7e3)}else J(!1)})),q=(e=!0)=>()=>{M(e),z.current&&(e?z.current.focus():z.current.blur())};const J=e=>{e&&Y(!0),setTimeout((()=>{I(!1),T(""),Y(!1)}),1e3)};return(0,l.useEffect)((()=>{P(void 0,void 0,void 0,(function*(){let e="";if(t?(e=(yield c.ZP.GetPin())||"",F(e)):chrome.runtime.sendMessage({type:"getPin"},(e=>P(void 0,void 0,void 0,(function*(){e&&F(e)})))),t){const e=yield c.ZP.GetUserInfo();_((0,d.ps)({type:g.F9.setUserInfo,userInfo:e}))}}))}),[]),(0,l.useEffect)((()=>{Y(!1);P(void 0,void 0,void 0,(function*(){switch(w){case g.eY.setPin:4===N.length&&0===G.length&&(b&&b(g.b0.setConfirmNew),W(N),T("")),4===N.length&&4===G.length&&(N===G?(yield c.ZP.SetPin(N),E?A&&A():k&&k(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:K("common:notification:pinSet")}}))):(I(!0),J(!0))),0===N.length&&q(!0)();break;case g.eY.changePin:4!==N.length||D||Q(),4===N.length&&0===G.length&&D&&(b&&b(g.b0.changeConfirmNew),W(N),T("")),4===N.length&&4===G.length&&D&&(N===G?(yield c.ZP.SetPin(N),k&&k(),_((0,d.YF)({type:g.F9.setNotificaton,notificationStatus:{type:"success",show:!0,text:K("common:notification:pinChanged")}}))):J(!0)),0===N.length&&q(!0)();break;default:0===N.length&&q(!0)(),4===N.length&&(I(!0),Q())}}))}),[N]),(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(s.Z,Object.assign({sx:$,onClick:q(!0),onBlur:q(!1)},{children:[(0,i.jsx)(a.Z,{sx:R,inputRef:z,onFocus:()=>M(!0),onBlur:()=>M(!1),autoFocus:!0,value:N,disabled:C,onChange:e=>{var t,n,i,o,s;const a=z.current;a.selectionStart=a.selectionEnd=5;const r=(null===(n=null===(t=e.target)||void 0===t?void 0:t.value)||void 0===n?void 0:n.replaceAll)?null===(o=null===(i=e.target)||void 0===i?void 0:i.value)||void 0===o?void 0:o.replaceAll("\n",""):null===(s=e.target)||void 0===s?void 0:s.value;(/^\d{0,4}$/.test(r)||""==r)&&T(r)}}),function(){const e=N.split("");return Array.from({length:4},((e,t)=>t)).map((t=>e[t]))}().map(((e,n)=>(0,i.jsx)(v,{isPopup:t,value:e,showError:O,isInFocus:B&&n===N.length},n)))]})),G&&(0,i.jsx)(s.Z,Object.assign({sx:U},{children:(0,i.jsxs)(s.Z,Object.assign({onClick:()=>{W(""),T(""),q(!0)(),b&&(w===g.eY.changePin?b(g.b0.changeEnterNew):b(g.b0.setEnterNew))}},{children:[(0,i.jsx)(h.g,{src:m.Z,width:10,height:10,fill:V.palette.primary.main,style:{transform:"rotate(180deg)"}}),(0,i.jsx)(r.Z,Object.assign({component:"span"},{children:K("popup:pinSetting:setAgain")}))]}))}))]})}},98308:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var i=n(52322),o=n(2784),s=n(42921),a=n(79312),r=n(71090),l=n(25539);var c=n(75234),p=n(90565),u=n(73557),d=n(39857),g=n(67876),f=n(38997),h=n(13297),m=n(99947),y=n(9321),x=n(71382),P=n(18322),v=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function r(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}l((i=i.apply(e,t||[])).next())}))};var S=()=>{const[e,t]=(0,o.useState)(),[n,S]=(0,o.useState)(""),[Z,b]=(0,o.useState)(),[w,k]=(0,o.useState)(""),[j,E]=(0,o.useState)(!1),{t:A}=(0,c.$G)(),C=(0,u.s0)(),I=(0,u.TH)(),{pagePinSetting:O,closeIcon:Y,header:H,user:F,userName:N,link:T}=(({mode:e})=>(0,r.k)({pagePinSetting:{display:"grid","& h1":{maxWidth:e===l.eY.setPin?"300px":"220px",maxHeight:"59px",fontSize:"24px",lineHeight:"30px",fontWeight:"700",color:e=>e.palette.inputElements.main,margin:e===l.eY.setPin?"0 auto 45px":"0 auto 20px"},"& span":{fontSize:"15px",lineHeight:"16px",fontWeight:"300",color:e=>e.palette.primary.main,paddingLeft:"3px"}},closeIcon:{display:"flex",justifyContent:"right",marginBottom:"20px"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},user:{display:"flex",flexGrow:"1",alignItems:"center",justifyContent:"flex-start",gap:"12px"},userName:{maxWidth:"180px",fontSize:"15px",lineHeight:"18px",fontWeight:"300",color:e=>e.palette.inputElements.main},link:{color:e=>e.palette.primary.main,fontSize:"15px",lineHeight:"18px",fontWeight:"300",cursor:"pointer"}}))({mode:Z}),{toggleFocus:G,setPopupHeight:W}=(0,o.useContext)(h.Q),D=(0,y.i)((e=>e.popupStore.userInfo)),L=()=>{C({pathname:"/settings",search:`?${(0,d.fW)({afterPinSetting:"true"})}`}),W(600)};return(0,o.useEffect)((()=>{W(326);v(void 0,void 0,void 0,(function*(){const e=yield g.ZP.GetPin();k(e||"");const t=yield P.Z.passwork.getPassworkSettings();E(!!(null==t?void 0:t.mandatoryPinForExtension))}))}),[]),(0,o.useEffect)((()=>{(()=>{switch(I.state.mode){case l.eY.deletePin:b(l.eY.deletePin),S(A("popup:pinSetting:remove"));break;case l.eY.changePin:b(l.eY.changePin),e===l.b0.changeConfirmNew?S(A("popup:pinSetting:enterNewAgain")):e===l.b0.changeEnterNew?S(A("popup:pinSetting:setNew")):S(A("popup:pinSetting:enterOld"));break;case l.eY.setPin:b(l.eY.setPin),e===l.b0.setConfirmNew?S(A("popup:pinSetting:confirm")):S(A("popup:pinSetting:set"))}})()}),[e,w,n]),(0,i.jsxs)(s.Z,Object.assign({sx:O},{children:[I.state.needPin?(0,i.jsxs)(s.Z,Object.assign({sx:H},{children:[(0,i.jsxs)(s.Z,Object.assign({sx:F},{children:[(0,i.jsx)(m.Z,{openSettingsPageOnClick:!1}),(0,i.jsx)(a.Z,Object.assign({component:"p",sx:N},{children:(null==D?void 0:D.fullname)||(null==D?void 0:D.name)||(null==D?void 0:D.email)||""}))]})),(0,i.jsx)(a.Z,Object.assign({onClick:()=>v(void 0,void 0,void 0,(function*(){yield g.ZP.SetHost(""),yield g.ZP.SetPinEntryAttempts(0),yield(0,x.s1)(!0),C("/"),W("fit-content")})),sx:T,component:"p"},{children:A("popup:unlockExtension:logOut")}))]})):(0,i.jsx)(s.Z,Object.assign({sx:Y},{children:(0,i.jsx)(f.Z,{close:L,showTimer:!1})})),(0,i.jsx)(a.Z,Object.assign({component:"h1"},{children:n})),(0,i.jsx)(p.Z,{extensionUnlock:()=>v(void 0,void 0,void 0,(function*(){const e=yield g.ZP.GetAutoLockSettings();e.lastActive=Math.floor(Date.now()/1e3),yield g.ZP.SetAutoLockSettings(e),C({pathname:"/",search:`?${(0,d.fW)({unlocked:"true"})}`})})),isPopup:!0,pinMode:I.state.mode,setTitleVariant:t,navigateToSettings:L,navigateToHost:()=>{C("/"),W("fit-content")},mandatoryPin:j,openHomePage:()=>v(void 0,void 0,void 0,(function*(){W(600),C("/homePage"),G()}))})]}))}}}]);