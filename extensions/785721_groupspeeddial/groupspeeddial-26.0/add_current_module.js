"use strict";(globalThis.webpackChunkgroup_speed_dial=globalThis.webpackChunkgroup_speed_dial||[]).push([[181],{9681:(e,t,a)=>{a.r(t),a.d(t,{promise:()=>ee});var i=a(4046),n=a(5296),l=a(4590),s=a(6004),o=a(910),r=a(3074),d=a(8794),c=a(4323),p=a(6683),u=a(7865),m=a(5022),h=a(2100),g=a(1879),v=a(8698),y=a(6799),w=a(6672),f=a(2801),_=a(5941),b=a(1962),k=a(9598),x=a(1181),C=a(7302),E=a(6499),I=a(5471),T=a(97),z=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("v-app",{staticStyle:{width:"100%",height:"100%"}},[t("v-main",{staticStyle:{width:"100%",height:"100%",padding:"0"}},[t("v-container",{staticStyle:{width:"100%",height:"100%"},attrs:{fluid:""}},[t("v-card",{staticStyle:{width:"100%",height:"100%"}},[t("v-card-title",{staticClass:"justify-center"},[t("h2",{directives:[{name:"tr",rawName:"v-tr",value:"label_done",expression:"'label_done'"}]})]),e._v(" "),t("v-card-text",[t("v-row",[t("v-col",{attrs:{cols:"12",sm:e.editDial?6:12}},[t("v-btn",{staticClass:"py-12",attrs:{"x-large":"",block:"",color:""},on:{click:e.closeEditor}},[t("v-icon",{attrs:{size:"24",left:""}},[e._v("fa-map-marker-alt")]),t("span",{directives:[{name:"tr",rawName:"v-tr",value:"stay_here",expression:"'stay_here'"}]})],1)],1),e._v(" "),e.editDial?t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-btn",{staticClass:"py-12",attrs:{"x-large":"",block:"",color:""},on:{click:t=>{e.editDial(),e.closeEditor()}}},[t("v-icon",{attrs:{size:"24",left:""}},[e._v("fa-pen-to-square")]),t("span",{directives:[{name:"tr",rawName:"v-tr",value:"cm_edit_dial",expression:"'cm_edit_dial'"}]})],1)],1):e._e(),e._v(" "),e.tabsClosed?e._e():t("v-col",{attrs:{cols:"12",sm:"12"}},[t("v-btn",{staticClass:"py-12",attrs:{"x-large":"",block:"",color:"red lighten-1"},on:{click:e.closePages}},[t("v-icon",{attrs:{size:"24",left:""}},[e._v("fa-file-excel")]),t("span",{directives:[{name:"tr",rawName:"v-tr",value:"close_added_pages",expression:"'close_added_pages'"}]})],1)],1),e._v(" "),t("v-col",{attrs:{cols:"12",sm:"12"}},[t("v-btn",{staticClass:"py-12",attrs:{"x-large":"",block:"",color:e.tabsClosed?"red lighten-1":"custom_blue"},on:{click:e.returnToTab}},[e.tabsClosed?[t("v-icon",{attrs:{size:"24",left:""}},[e._v("fa-times-circle")]),e._v(" "),t("span",{directives:[{name:"tr",rawName:"v-tr",value:"close_this_tab",expression:"'close_this_tab'"}]})]:[t("v-icon",{attrs:{size:"24",left:""}},[e._v("fa-arrow-alt-circle-left")]),e._v(" "),t("span",{directives:[{name:"tr",rawName:"v-tr",value:"return_to_tab",expression:"'return_to_tab'"}]})]],2)],1)],1)],1)],1)],1)],1)],1)};z._withStripped=!0;var L=a(6346);const D=I.default.extend({name:"add_current_exit_modal",props:{returnBack:{type:Function,required:!0},closeTabs:{type:Function,required:!0},editDial:{type:Function,required:!1}},components:{},data:()=>({tabsClosed:!1}),watch:{},async created(){},mounted(){},methods:{tr:l.tr,closePages(){this.tabsClosed=!0,this.closeTabs()},returnToTab(){this.returnBack()},closeEditor(){(0,L.Q)(this.$el,{type:"close"})}}});const P=(0,a(4486).A)(D,z,[],!1,null,null,null).exports;var A=a(6801),N=a(4069),S=a(2806),O=a(2846),M=a(6419),$=a(2221),B=a(5048),F=a(4257),U=a(4099),q=a(1361),H=a(6663),Q=a(4559),W=a(6664);const V=new o.F("popup_target_empty_dial",(()=>!1)),R=new o.F("popup_target_empty_dials",(()=>!1)),Z=new q.G;let j=Array(),K=!1,Y=0;const G=(0,v.U)(200),J=()=>j[0]||{url:"",title:""},X=new f.V(1),ee=async function(){d.qA.addOnChangeListener((({newValue:e})=>{j=e||[],te(j),0===j.length&&(a(),n.p.hide())})),await F.RO,j=await d.qA.get(),Y=j[0]?.returnTabId||0,K=1===j.length;const e=J().url,t=await O.M.findDuplicateDial(e);t&&await g.e.activate(t.id);j.length>0?(await u.W,te(j,!0),h._C.register(i),i()):a();function a(){m.$.setActive(!1),h._C.unregister(i),s()}async function i(e=g.e.getCurrentGroup()){const t=await e.getDials();s(),function(e,t){const a=t.map((e=>({dial:e,dialNode:(0,b.$H)(e.domId)}))).filter((e=>e.dialNode)),i=(0,B.Ty)(J().url);a.filter((({dial:e})=>e.multi?.links.map((e=>e.url)).some((e=>(0,B.Ty)(e)===i)))).forEach((({dialNode:e})=>{e.classList.add("is_duplicate"),[...e.querySelectorAll("li > a")].filter((e=>e.href.toLowerCase().includes(i))).forEach((e=>(G((()=>e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))),e.style.background="darkred")))})),a.filter((({dial:e})=>e.isSingleLinkDial()&&(0,B.Ty)(e.url)===i)).forEach((({dial:t,dialNode:a})=>{G((()=>a.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))),a.classList.add("is_duplicate"),Z.addListener(a,"click",(0,x.do)((()=>ie("updateImage",t.domId,e)))),a.firstElementChild.insertAdjacentElement("afterbegin",(0,k.z)("div",{class:"dial_float_label replace_dial",title:(0,l.tr)("replace_duplicate_dial")},[(0,k.z)("img",{src:(0,C.Z)("svg/clone (4).svg")}),(0,k.z)("span",{class:"ellipsis",textContent:(0,l.tr)("replace_duplicate_dial")})]))})),a.filter((({dial:e,dialNode:t})=>e.isUrlDial()&&!t.classList.contains("is_duplicate"))).forEach((({dial:t,dialNode:a},i)=>{Z.addListener(a,"click",(0,x.do)((()=>ie("replace",t.domId,e)))),a.title=(0,l.tr)("replace_dial")})),a.filter((({dial:e,dialNode:t})=>e.type===p.kh.MULTI)).forEach((({dial:t,dialNode:a})=>{a.title=(0,l.tr)("add_to_multi"),Z.addListener(a,"click",(0,x.do)((a=>{ae(t.domId,e,"extend")})))})),!K&&a.filter((({dial:e})=>!(0,c.Et)(e.type)||e.type===p.kh.MULTI)).forEach((({dial:t,dialNode:a})=>{const i=(0,l.tr)(t.isMultiDial()?"replace_multi_page_dial":"create_multi_page_dial");a.firstElementChild.insertAdjacentElement("afterbegin",(0,k.z)("div",{class:"dial_float_label replace_dial",title:i,handlers:{onclick:(0,x.do)((a=>ae(t.domId,e,"replace",a)))}},[(0,k.z)("img",{src:(0,C.Z)(t.isMultiDial()?"svg/move.svg":"svg/add_many.svg")}),(0,k.z)("span",{class:"ellipsis",textContent:i})]))})),a.filter((({dial:e})=>e.isEmptyDial())).forEach((({dial:t,dialNode:a})=>{Z.addListener(a,"click",(0,x.do)((a=>ie("replace",t.domId,e,a))))}))}(e.id,t);const a=e.getLastEmptyDial();if(e.grid&&a){const t=W.J.create(e);Z.addListener((0,Q.uT)(),"mousemove",(0,x.do)((e=>{let i=!1;if(e.target===e.currentTarget||e.target.closest(".is_empty_dial")){t.placeItem(a,e)&&(i=!0)}W.J.showEmptyDial(i)}))),Z.addOnClearHandler((()=>W.J.showEmptyDial(!1)))}}function s(){Z.clearAll(),document.querySelectorAll(".replace_dial").forEach(b.bf)}}();async function te(e,t=!1){if(0===e.length)return n.p.hide();const a=K?N.m0?{get:()=>!0}:V:R;if(!await a.get()){if(!t&&!n.p.isVisible)return;n.p.show(K?(0,l.tr)("add_target_dial"):(0,l.ZB)("add_target_dials",e.length),(0,s.Y6)([["div",{style:"overflow: auto; max-height: 155px;"},[["ul",{style:`list-style-type: ${1===e.length?"none":"decimal"}; padding: 0;`},[...e.map((({tab:e,title:t,url:a})=>["li",{style:"margin: 8px 0;"},[["div",{class:"flex flex-space-between"},[...e&&e.favIconUrl?[["img",{src:e.favIconUrl,style:"height: 16px; flex-shrink: 0;"}]]:[],["b",`${t.substring(0,70)}`],["a",{class:"icon-button",style:"margin: 0 5px 0 auto !important; display: flex",handlers:{onclick:e=>async function(e,t){e.stopPropagation(),await ne({removeLinks:[t],dials:[]}),(0,r.$8)()}(e,a)}},[["img",{src:"/utils/svg/trash-o.svg",style:"width: 24px; height: 24px; opacity: 0.5;"}]]]]],["i",{textContent:`${a.substring(0,70)}`}]]]))]]]],["p",(0,l.tr)("msg_add_dial_text")],...K?[["a",{class:"no-show-again",textContent:(0,l.tr)("msg_add_dial_no_show"),handlers:{onclick:()=>{n.p.hide(),V.set(!0)}}}]]:[]]),{...K?{}:{yesText:(0,l.tr)("msg_add_dials_here"),onYes:()=>(async function(){const e=await O.M.action("insertLinksToGroup",{groupId:g.e.id,links:j.map((e=>new M.O(-1,g.e.id,{name:e.title,url:e.url})))});await ne({dials:e.map((e=>e.dial))})}(),!0)}})}}async function ae(e,t,a,i){await X.addWork((async()=>{const n=J(),l=O.M.groupById(t),s=l.dialById(e);if(!s||!l)return;const o="replace"===a?S.U.fromUserInput(s.index,t,{titleAction:s.multi?.titleAction||p.C2.openAll,linkAction:s.multi?.linkAction||p.Q0.openLink,links:j.map((({title:e,url:t})=>({name:e,url:t})))},{name:s?.name&&!s.name.includes((new Date).getFullYear().toString().slice(0,3))?s.name:new Intl.DateTimeFormat(void 0,{dateStyle:"full"}).format(new Date)}):S.U.fromUserInput(s.index,t,{...s.multi,links:s.multi.links.concat({url:n.url,name:n.title})},s);await O.M.action("replaceDial",{dial:o,groupId:t,gridPlacement:i}),"replace"===a?(await o.postSaveAction(t),await d.qA.reset(),await(0,y.t1)({id:e}),await le()):((0,U.O)(t,n.url),await ne({dials:[],removeLinks:[n.url]}))}))}async function ie(e,t,a,n){await X.addWork((async()=>{const{url:l,title:s}=J(),o=O.M.groupById(a),r=o.dialById(t);if(!r||!o)return;const d=r.isAlmostSameDomain(l),c="replace"===e?new M.O(r.index,a,{...d?r.clone():{name:s||(0,w.QV)(l)},url:l}):r.clone();await O.M.action("replaceDial",{dial:c,groupId:a,gridPlacement:n});const p="replace"===e?t:"";"replace"===e&&d?(await i.h.updateDB(a,r.url,a,l),await ne({dials:[],removeLinks:[l],offerEditDialId:p})):await ne({dials:[c],offerEditDialId:p})}))}async function ne({removeLinks:e=[],dials:t=[],offerEditDialId:a}){const i=await(0,_.w)();Promise.all(t.map((async e=>{const t=j.find((t=>t.url===e.url))||j.find((t=>(0,B.Ty)(t.url)===(0,B.Ty)(e.url)));t.screenshotId?await i.reloadDial(e,void 0,{method:H.P.visit,screenshotId:t.screenshotId}):i.reloadDial(e)}))).then(r.$8);const n=new Set([...e,...t.map((e=>e.url))]),l=new Set([...n].map(B.Ty));await d.qA.set(j=j.filter((e=>!n.has(e.url)&&!l.has((0,B.Ty)(e.url))))),0===j.length&&le(K&&a||"")}async function le(e=""){const t=e?()=>(0,y.t1)({id:e}):void 0;switch($.lw.ADD_CURRENT_AFTER_ACTION){case p.Px.RETURN:return a();case p.Px.STAY:return;default:case p.Px.ASK:return async function(){new I.default({el:(0,E.Q)(document.createElement("div"),{width:500,height:444}).node,vuetify:(await(0,T.X)())(),render:e=>e(P,{props:{returnBack:a,closeTabs:i,editDial:t}})})}()}async function a(){const e=await browser.tabs.getCurrent();Y&&await browser.tabs.update(Y,{active:!0}).catch(c.lQ),await browser.tabs.remove(e.id)}function i(){(0,A._z)({type:"add_closeTabs"})}}},4257:(e,t,a)=>{a.d(t,{EK:()=>s,RO:()=>o,re:()=>l});var i=a(4323),n=a(744);const[l,s]=(0,i.Mj)(),o=Promise.all([l,n.b])},6499:(e,t,a)=>{a.d(t,{Q:()=>w});var i=a(6004),n=a(3091),l=a(4323),s=a(6690);var o=a(7302),r=a(1471),d=a(910),c=a(9598),p=a(8698),u=a(6346),m=a(1374),h=a(1181),g=a(9100),v=a(4590),y=a(4069);function w(e,{width:t=800,height:a=600,draggableStyle:w="",onClose:f=l.lQ,appendToBody:_=!0,rememberPositionKey:b="",closableOverlay:k=!0,overlayBackground:x="rgba(0, 0, 0, 0.3)",closeOnOverlayClick:C=!0,closeOnESC:E=!0}){const I={get node(){return e},get overlayNode(){return S},minimize:async function(e){Q("0"),P.style.transition="top 550ms",P.classList.add("pointer_all"),P.title=(0,v.tr)("label_restore");const t=$.getY();$.setPosition(void 0,window.innerHeight-64),P.addEventListener("mousedown",(0,h.do)(M=()=>{Q("100%"),P.classList.remove("pointer_all"),P.title="",(0,l.BK)(250).then((()=>P.style.removeProperty("transition"))),$.setPosition(void 0,t),e?.()}),{capture:!0,once:!0})},maximize:async function(){P.style.transition="top 250ms, left 250ms, width 250ms, height 250ms";$.setPosition(40,40),H.setPosition(window.innerWidth-80,window.innerHeight-80),await(0,l.BK)(250),P.style.removeProperty("transition")},closeModal:()=>{S.isConnected&&(S.remove(),f(),(0,l.XB)(O),window.removeEventListener("keydown",T),y.m0&&document.body.focus({preventScroll:!0}))}},T=(0,r.ak)(I.closeModal);E&&window.addEventListener("keydown",T);const z=`\nz-index: 20;\nwidth: ${k?"100%":"0"};\nheight: 100%;\nbackground: ${x};\nposition: fixed;\ntop: 0;\nleft: 0;\ndisplay: flex;\njustify-content: center;\nalign-items: center;\n`,L=`\ndisplay: flex;\nflex-direction: column;\nopacity: 0;\ntop: 0;\nleft: 0;\nposition: fixed;\nbackground: transparent;\nbox-shadow: rgba(0, 0, 0, 0.5) 0px 0px 5px;\nwidth: ${t}px;\nheight: ${a}px;\nmin-width: 320px;\nmin-height: 170px;\nmax-width: 100%;\nmax-height: 100%;\n/*border: 1px solid rgb(65, 65, 65);*/\n`,D=`\nz-index: 10;\ncursor: move;\nposition: absolute;\nwidth: 100%;\ntop: 0;\nleft: 0;\nheight: 15px;\n${w}\n`;let P;const A=new d.F(b,(()=>({}))),N=(0,p.U)(500),S=(0,c.z)("div",{"data-modal-overlay":1,style:z,handlers:{onmousedown:e=>{e.target===S&&(S.onclick=e=>{e.target===S&&C&&I.closeModal()})}}},[P=(0,c.z)("div",{style:L},[(0,c.z)("div",{style:"\ndisplay: flex;\noverflow: auto;\nwidth: 100%;\nheight: 100%;\n"},[e]),(0,c.z)("draggable-top",{style:D,"data-draggable-top":0,handlers:{ondblclick:()=>{I.maximize()}}}),(0,c.z)("img",{style:"\nz-index: 10;\ncursor: nw-resize;\nwidth: 16px;\nheight: 16px;\nopacity: 0.8;\npadding: 2px;\nposition: absolute;\nright: 0;\nbottom: 0;\nuser-select: none;\n",src:(0,o.Z)("utils/svg/resize-corner.svg"),"data-resize-corner":0})])]),O=Array();let M=l.lQ;(0,u.Z)(S,(e=>{switch(e.type){case"changeOpacity":S.style.opacity=e.opacity;break;case"changeTransparency":S.style.backgroundColor=e.isTransparent?"transparent":x;break;case"changeOverlayCloseOnClick":C=e.value;break;case"maximize":I.maximize();break;case"addOnCloseHandler":O.push(e.callback);break;case"removeOnCloseHandler":(0,m.E6)(O,e.callback);break;case"close":I.closeModal();break;case"minimize":I.minimize(e.restoreCallback);break;case"restore":M()}})),_&&document.body.appendChild(S);const $=(0,n.$)(P,{autoLockFrames:!0,keepInWindow:250,dontMovePredicate:e=>e.target!==P&&!e.target.hasAttribute("data-draggable-top")});$.setCallback(((e,t,a)=>{(0,i.eC)(P,"top",(0,s.px)(t)),(0,i.eC)(P,"left",(0,s.px)(e)),b&&N((()=>A.update((({w:a,h:i})=>({x:e,y:t,w:a,h:i})))))}));const B=document.documentElement.clientWidth,F=document.documentElement.clientHeight,[U,q]=[B/2-t/2,F/2-a/2];$.setPosition((0,g.n)(0,B-t-10,U),(0,g.n)(0,F-a-10,q)),(0,i.eC)(P,"opacity","1");const H=function(e,{cornerNode:t=e.querySelector("[data-resize-corner]"),originalWidth:a,originalHeight:o,callback:r=l.lQ,autoLockFrames:d=!1}){let c=a,p=o;const u=(0,n.$)(t,d?{autoLockFrames:!0,autoLockFramesContainer:e}:{});return u.setCallback(((t,n,l)=>{c=a+t,p=o+n,(0,i.eC)(e,"width",(0,s.px)(c)),(0,i.eC)(e,"height",(0,s.px)(p)),r(c,p,l)})),{setPosition:(e,t,i)=>u.setPosition(e-a,t-o,i),getWidth:()=>c,getHeight:()=>p}}(P,{autoLockFrames:!0,originalWidth:t,originalHeight:a,callback:(e,t,a)=>{b&&A.update((({x:a,y:i})=>({w:e,h:t,x:a,y:i})))}});return b&&A.get().then((({x:e,y:t,w:a,h:i})=>{[e,t].every(l.Et)&&$.setPosition(e,t,!0),[a,i].every(l.Et)&&H.setPosition(a,i,!0),$.moveToViewport()})),I;function Q(e){["width","height"].forEach((t=>S.style.setProperty(t,e)))}}},6346:(e,t,a)=>{a.d(t,{Q:()=>n,Z:()=>l});const i="__modal_window_custom_event",n=(e,t)=>e.dispatchEvent(new CustomEvent(i,{detail:t,bubbles:!0})),l=(e,t)=>e.addEventListener(i,(e=>t(e.detail)))},97:(e,t,a)=>{a.d(t,{X:()=>i});const i=()=>Promise.all([a.e(525),a.e(702)]).then(a.bind(a,6276)).then((e=>e.getVuetifyInstance))}}]);