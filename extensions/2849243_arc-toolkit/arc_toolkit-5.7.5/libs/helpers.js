!function(){"use strict";const e={applyElementBorder:()=>{for(const e of arcHelpers.items)e.helper.setAttribute("part","root outline")},applyElementTagName:()=>{for(const e of arcHelpers.items){const t=document.createElement("div");let r;if(r=e.label?e.label:e.elementType&&e.elementType.role?`<span class="tag">${e.elementType.tag}</span>[${e.elementType.role}]`:e.element.tagName,t.innerHTML=r,t.setAttribute("part","label"),t.setAttribute("aria-hidden",!0),e.type){const r=document.createElement("span");switch(r.setAttribute("part","type"),e.type){case"error":r.append("ERR");break;case"alert":r.append("WARN");break;default:r.append("BP")}t.append(r)}e.helper.append(t)}},genericHelper:(e,t,r,a,l)=>{const o=document.querySelectorAll(e),s=[],n=[];for(const c of o){const e=r?r(c):{},o=arcUtils.getXPath(c),i=arcUtils.getSource(c),p=arcUtils.getType(c),d=arcUtils.isHidden(c);if(s.push({data:e,type:p,xpath:o,hidden:d,source:i}),!d){const r=a?a(e,p):null,s=l?l(e):null;c.classList.add(...t),n.push({element:c,elementType:p,label:r,complementary:s,xpath:o})}}return arcHelpers.init(n,"helper"),arcHelpers.common.applyElementTagName(),arcHelpers.common.applyElementBorder(),s}},t={apply:async()=>arcHelpers.common.genericHelper('a, [role="link"]',["arcLinksHelper"],(e=>{let t,r,a,l;e.matches("a")&&(a=e.matches('[href^="#"]'),l=e.getAttribute("href"));const o=arcUtils.getAriaLabelledby(e);o&&""!=o&&(t=o,r="aria-labelledby");const s=arcUtils.getAriaLabel(e);s&&""!=s&&(t=s,r="aria-label");const n=arcUtils.getTitle(e);return n&&""!=n&&(t=n,r="title"),r||(t=e.innerText,r="innerText"),{text:t,textType:r,internal:a,href:l}}),null,(e=>`${e.textType}: ${e.text?e.text:"N/A"}`)),unapply:()=>{const e=document.querySelectorAll(".arcLinksHelper");for(const t of e)t.classList.remove("arcLinksHelper")}},r={apply:async()=>arcHelpers.common.genericHelper("[accesskey]",["arcAccesskeysHelper"],(e=>({accesskey:e.getAttribute("accesskey")})),null,(e=>`accesskey: ${e.accesskey?e.accesskey:"Empty"}`)),unapply:()=>{const e=document.querySelectorAll(".arcAccesskeysHelper");for(const t of e)t.classList.remove("arcAccesskeysHelper")}},a={apply:async()=>arcHelpers.common.genericHelper("[aria-hidden]",["arcAriaHiddenHelper"],(e=>({ariaHidden:e.getAttribute("aria-hidden")})),((e,t)=>`${t.role?`<span class="tag">${t.tag}</span>[${t.role}]`:`<span class="tag">${t.tag}</span>`}: ${e.ariaHidden?"Hidden":"visible"}`)),unapply:()=>{const e=document.querySelectorAll(".arcAriaHiddenHelper");for(const t of e)t.classList.remove("arcAriaHiddenHelper")}},l={apply:async()=>arcHelpers.common.genericHelper('[aria-live], [role="alert"]',["arcAriaLiveHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcAriaLiveHelper");for(const t of e)t.classList.remove("arcAriaLiveHelper")}},o={apply:async()=>arcHelpers.common.genericHelper('[role]:not([role="banner"], [role="navigation"], [role="form"], [role="main"], [role="contentinfo"], [role="complementary"], [role="search"])',["arcAriaUIHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcAriaUIHelper");for(const t of e)t.classList.remove("arcAriaUIHelper")}},s={apply:async()=>{const e=document.querySelectorAll("body *"),t=[],r=[];for(const a of e){const e=arcHelpers.tools.ariaUsage.getAriaAttributes(a);if(Object.keys(e).length>0){const l=arcUtils.getXPath(a),o=arcUtils.getSource(a),s=arcUtils.getType(a),n=arcUtils.isHidden(a);t.push({data:e,type:s,xpath:l,hidden:n,source:o}),n||(a.classList.add("arcAriaUsageHelper"),r.push({element:a,elementType:s,xpath:l}))}}return arcHelpers.init(r,"helper"),arcHelpers.common.applyElementBorder(),arcHelpers.common.applyElementTagName(),t},unapply:()=>{const e=document.querySelectorAll(".arcAriaUsageHelper");for(const t of e)t.classList.remove("arcAriaUsageHelper")},getAriaAttributes:e=>{const t={};for(const r of e.getAttributeNames())if("role"==r||r.startsWith("aria-")){const a=e.getAttribute(r);t[r]=a}return t}},n={apply:async()=>arcHelpers.common.genericHelper('button, input[type="button"], input[type="image"], input[type="reset"], input[type="submit"], [role="button"]',["arcButtonsHelper"],(e=>{let t,r;const a=arcUtils.getAriaLabelledby(e);a&&""!=a&&(t=a,r="aria-labelledby");const l=arcUtils.getAriaLabel(e);l&&""!=l&&(t=l,r="aria-label");const o=arcUtils.getAlt(e);null!=o&&(t=o,r="alt",src=e.src);const s=arcUtils.getTitle(e);return s&&""!=s&&(t=s,r="title"),r||(t=e.textContent,r="textContent"),{text:t,textType:r}}),null,(e=>e.text?e.text:"N/A")),unapply:()=>{const e=document.querySelectorAll(".arcButtonsHelper");for(const t of e)t.classList.remove("arcButtonsHelper")}},c={apply:async()=>arcHelpers.common.genericHelper('input:not([type="hidden"]):not([type="button"]):not([type="image"]):not([type="reset"]):not([type="submit"]), select, textarea, form, fieldset, legend, label, [role="radio"], [role="checkbox"], [role="combobox"], [role="searchbox"], [role="slider"], [role="spinbutton"], [role="textbox"], [role="form"], [role="listbox"]',["arcFormsHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcFormsHelper");for(const t of e)t.classList.remove("arcFormsHelper")}},i={apply:async()=>arcHelpers.common.genericHelper("iframe, frame, frameset",["arcFramesHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcFramesHelper");for(const t of e)t.classList.remove("arcFramesHelper")}},p={apply:async()=>arcHelpers.common.genericHelper("h1, h2, h3, h4, h5, h6, [role=heading]",["arcHeadingsHelper"],(e=>{let t,r=e.textContent.trim();return""===r&&(r="‼️ NON-TEXT CONTENT ‼️"),t=e.matches("[role=heading]")?e.getAttribute("aria-level"):e.tagName.substring(1),{text:r,level:t}})),unapply:()=>{const e=document.querySelectorAll(".arcHeadingsHelper");for(const t of e)t.classList.remove("arcHeadingsHelper")}},d={apply:async()=>arcHelpers.common.genericHelper("[id]",["arcIdsHelper"],(e=>({id:e.id})),(e=>e.id)),unapply:()=>{const e=document.querySelectorAll(".arcIdsHelper");for(const t of e)t.classList.remove("arcIdsHelper")}},m={apply:async()=>{const e=document.querySelectorAll("body *"),t=[],r=[];for(const a of e){const e=window.getComputedStyle(a).backgroundImage;if(e&&"none"!==e){const l={backgroundImage:e},o=arcUtils.getXPath(a),s=arcUtils.getSource(a),n=arcUtils.getType(a),c=arcUtils.isHidden(a);t.push({data:l,type:n,xpath:o,hidden:c,source:s}),c||(a.classList.add("arcImagesBgHelper"),r.push({element:a,elementType:n,xpath:o}))}}return arcHelpers.init(r,"helper"),arcHelpers.common.applyElementTagName(),arcHelpers.common.applyElementBorder(),t},unapply:()=>{const e=document.querySelectorAll(".arcImagesBgHelper");for(const t of e)t.classList.remove("arcImagesBgHelper")}},u={apply:async()=>arcHelpers.common.genericHelper("img:not([role]), svg, area, input[type=image], [role=image]",["arcImagesHelper"],(e=>{let t,r,a,l;e.matches("svg")&&(l=e.outerHTML);const o=arcUtils.getAriaLabelledby(e);o&&""!=o&&(t=o,r="aria-labelledby");const s=arcUtils.getAriaLabel(e);!r&&s&&""!=s&&(t=s,r="aria-label");const n=arcUtils.getAlt(e);r||null==n||(t=n,r="alt",a=e.src);const c=arcUtils.getTitle(e);return!r&&c&&""!=c&&(t=c,r="title"),{text:t,textType:r,src:a,svg:l}}),null,(e=>e.text?e.text:"N/A")),unapply:()=>{const e=document.querySelectorAll(".arcImagesHelper");for(const t of e)t.classList.remove("arcImagesHelper")}},y={apply:async()=>{const e=document.querySelectorAll("head > title, head > meta"),t=[];for(const r of e){const e=arcUtils.getXPath(r),a=arcUtils.getSource(r,!0),l=r.tagName;t.push({xpath:e,type:l,hidden:!0,source:a})}return t},unapply:()=>{}},g={apply:e=>{arcHelpers.init(e,"scanResult"),arcHelpers.common.applyElementBorder(),arcHelpers.common.applyElementTagName();for(const t of e){const e=document.createElement("style");e.textContent="\n            .infos {\n                position:fixed;\n                top: 10px;\n                left: 10px;\n                display: none;\n                border: 2px solid #000;\n                background-color: #fff;\n                padding: 0.5rem;\n                width: max-content;\n                box-shadow: 5px 5px 20px -1px rgba(0,0,0,0.75);\n                -webkit-box-shadow: 5px 5px 20px -1px rgba(0,0,0,0.75);\n                -moz-box-shadow: 5px 5px 20px -1px rgba(0,0,0,0.75);\n            }\n            .root:hover .infos {\n                display:block;\n            }\n            .infos .color {\n                display:inline-block;\n                border: 1px dashed #000;\n                width: 4rem;\n                height: 1.4rem;\n            }\n            ",t.shadow.append(e);const r=document.createElement("div");r.classList.add("infos"),r.innerHTML=`\n            Contrast Ratio: ${t.infos["contrast ratio"]}\n            <br/>Foreground <div class="color" style="background-color:${t.infos.foregroundColorRGB}"></div>\n            <br/>Background <div class="color" style="background-color:${t.infos.backgroundColorRGB}"></div>\n            `,t.helper.append(r)}},unapply:()=>{}},h={apply:async()=>arcHelpers.common.genericHelper('main, [role="main"], header, [role="banner"], nav, [role="navigation"], footer, [role="contentinfo"], aside, [role="complementary"], [role="form"], [role="search"], [role="region"], section[aria-label], section[title], section[aria-labelledby]',["arcLandmarksHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcLandmarksHelper");for(const t of e)t.classList.remove("arcLandmarksHelper")}},H={apply:async()=>arcHelpers.common.genericHelper("[lang]",["arcLanguagesHelper"],(e=>({lang:e.getAttribute("lang")})),((e,t)=>`lang: ${e.lang?e.lang:"Empty"}`)),unapply:()=>{const e=document.querySelectorAll(".arcLanguagesHelper");for(const t of e)t.classList.remove("arcLanguagesHelper")}},f={apply:async()=>arcHelpers.common.genericHelper("ul, ol, [role=list], [role=tablist], [role=listbox]",["arcListsHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcListsHelper");for(const t of e)t.classList.remove("arcListsHelper")}},b={apply:async()=>arcHelpers.common.genericHelper('object, embed, canvas, video, audio, math, [role="application"]',["arcRichMediasHelper"]),unapply:()=>{const e=document.querySelectorAll(".arcRichMediasHelper");for(const t of e)t.classList.remove("arcRichMediasHelper")}},x={apply:async()=>arcHelpers.common.genericHelper("[tabindex]",["arcTabindexesHelper"],(e=>({tabindex:e.getAttribute("tabindex")})),null,(e=>e.tabindex?e.tabindex:"Empty")),unapply:()=>{const e=document.querySelectorAll(".arcTabindexesHelper");for(const t of e)t.classList.remove("arcTabindexesHelper")}},A={apply:async()=>{const e=document.querySelectorAll('table, [role="grid"]'),t=document.querySelectorAll('th, [role="gridcell"], [role="columnheader"], [role="rowheader"]'),r=[],a=[];for(const s of e){const e=arcUtils.getXPath(s),t=arcUtils.getSource(s),l=arcUtils.getType(s),o=arcUtils.isHidden(s);r.push({xpath:e,type:l,hidden:o,source:t}),o||(s.classList.add("arcTablesHelper"),a.push({element:s,xpath:e}))}const l=[];for(const s of t){const e=arcUtils.isHidden(s),t=arcUtils.getXPath(s);if(!e){if(s.matches('[role="columnheader"], [role="rowheader"]')){s.getAttribute("role");s.tagName}else s.tagName;l.push({element:s,xpath:t})}}const o=a.concat(l);return arcHelpers.init(o,"helper"),arcHelpers.common.applyElementBorder(a),arcHelpers.common.applyElementTagName(o),r},unapply:()=>{const e=document.querySelectorAll(".arcTablesHelper");for(const t of e)t.classList.remove("arcTablesHelper")}},L={path:"magnet",startPlug:"disc",size:2,endPlugSize:2},T={apply:async e=>{const t=document.querySelectorAll('button:not([disabled]),a[href],area[href],input:not([disabled]):not([type="hidden"]),select:not([disabled]),textarea:not([disabled]),[tabindex]:not([tabindex="-1"]):not([disabled]),summary:not(:disabled),[contenteditable]:not([contenteditable="false"]), frame, iframe'),r=[];for(const c of t){const e=c.getAttribute("tabindex");e&&"-1"!==e&&"0"!==e&&(arcUtils.isHidden(c)||r.push({tabIndex:parseInt(e),element:c}))}r.sort(((e,t)=>e.tabIndex-t.tabIndex)),arcHelpers.items.length>0&&arcHelpers.clear();const a=[],l=[];let o,s=null!=e?e:1;for(const{tabIndex:c,element:i}of r)if(!arcUtils.isHidden(i)){let e=i.textContent.trim();""===e&&(e="‼️ NON-TEXT CONTENT ‼️"),i.classList.add("arcTabOrderHelper");const t=arcUtils.getXPath(i),r=arcUtils.getSource(i);let p={element:i,xpath:t,label:s};p=arcHelpers.initShadowElement(p,"helper"),arcHelpers.items.push(p),l.push(p),a.push({data:{tabIndex:c,order:s,text:e},xpath:t,source:r}),s++;const d=LeaderLine.pointAnchor(i,{x:p.size.width/2,y:p.size.height/2});if(o)try{new LeaderLine(o,d,L)}catch(n){console.error(n)}o=d}for(const c of t){const e=c.getAttribute("tabindex");if(!(e&&"0"!==e||arcUtils.isHidden(c)))if(c.matches("iframe, frame")){const e=await arcHelpers.sendIframe(c,{tool:"tabOrder",params:s});if(a.push(...e),s+=e.length,c.contentDocument){if(o)try{new LeaderLine(o,c.contentDocument.querySelector(".arcFirstElement"),L)}catch(n){console.error(n)}o=c.contentDocument.querySelector(".arcLastElement")}}else{let e=c.textContent.trim();""===e&&(e="‼️ NON-TEXT CONTENT ‼️"),c.classList.add("arcTabOrderHelper");const t=arcUtils.getXPath(c),r=arcUtils.getSource(c);let i={element:c,xpath:t,label:s};i=arcHelpers.initShadowElement(i,"helper"),arcHelpers.items.push(i),l.push(i),a.push({data:{order:s,text:e},xpath:t,source:r}),s++;const p=LeaderLine.pointAnchor(c,{x:i.size.width/2,y:i.size.height/2});if(o)try{new LeaderLine(o,p,L)}catch(n){console.error(n)}o=p}}l[0].element.classList.add("arcFirstElement"),l[l.length-1].element.classList.add("arcLastElement"),arcHelpers.common.applyElementTagName(),arcHelpers.common.applyElementBorder();return document.querySelector("body").classList.add("arcTabOrderShowArrows"),a},unapply:()=>{const e=document.querySelectorAll(".arcTabOrderHelper");for(const r of e)r.classList.remove("arcTabOrderHelper","arcFirstElement","arcLastElement");const t=document.querySelectorAll(".leader-line");for(const r of t)r.remove();document.querySelector("body").classList.remove("arcTabOrderShowArrows")},option:(e,t)=>{const r=document.querySelector("body");switch(e){case"showAll":r.classList.add("arcTabOrderShowArrows");break;case"hideAll":r.classList.remove("arcTabOrderShowArrows")}}},S={apply:()=>{document.querySelector("body").classList.add("arcTextSpacingHelper")},unapply:()=>{document.querySelector("body").classList.remove("arcTextSpacingHelper")}},w={apply:async()=>arcHelpers.common.genericHelper("[title]",["arcTitleHelper"],(e=>({title:e.getAttribute("title").trim()})),null,(e=>e.title?e.title:"Empty")),unapply:()=>{const e=document.querySelectorAll(".arcTitleHelper");for(const t of e)t.classList.remove("arcTitleHelper")}};var v;function E(){v=null,arcHelpers.redraw()}function U(e){var t=0,r=0;return{top:t+=e.offsetTop||0,left:r+=e.offsetLeft||0}}window.arcHelpers=window.arcHelpers||{isInFrame:!1,common:e,tools:{defaultScanResults:{apply:e=>{arcHelpers.init(e,"scanResult"),arcHelpers.common.applyElementBorder(),arcHelpers.common.applyElementTagName()},unapply:()=>{}},accesskeys:r,ariaHidden:a,ariaLive:l,ariaUI:o,ariaUsage:s,buttons:n,forms:c,frames:i,headings:p,ids:d,imagesBg:m,images:u,infos:y,insufficientNormalTextContrast:g,landmarks:h,languages:H,links:t,lists:f,richMedias:b,tabIndexe:x,tables:A,tabOrder:T,textSpacing:S,titles:w},items:[],framesList:[],init:(e,t)=>{arcHelpers.items.length>0&&arcHelpers.clear();for(const r of e){const e=arcHelpers.initShadowElement(r,t);arcHelpers.items.push(e)}},initShadowElement:(e,t)=>{const r=document.createElement("div");r.classList.add("arcToolkitElement",t),r.dataset.xpath=e.xpath.replaceAll('"',""),e.type&&r.classList.add(e.type);const a=document.createElement("div");a.setAttribute("part","root"),a.style.position="absolute";const l=U(e.element),o=e.element.getBoundingClientRect();a.style.top=l.top+"px",a.style.left=l.left+"px",a.style.width=o.width+"px",a.style.height=o.height+"px",e.offset=l,e.size=o,e.helper=a;const s=e.element.parentNode;if(s){const t=e.element.nextSibling;t?s.insertBefore(r,t):s.appendChild(r)}else document.body.appendChild(r);return e.shadow=r.attachShadow({mode:"closed"}),e.shadow.appendChild(a),e},apply:async(e,t)=>void 0!==arcHelpers.tools[e]?arcHelpers.tools[e].apply(t):Promise.reject(new Error(`tool '${e}' not found`)),applyScanHelper:async(e,t)=>{const r=[];for(const a of t)if(!arcHelpers.isInFrame&&!a.frameUrl||arcHelpers.isInFrame&&a.frameUrl==window.location.href){const e=document.evaluate(a.xpath,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(e){arcUtils.isHidden(e)||(a.element=e,r.push(a))}}return e&&void 0!==arcHelpers.tools[e]?arcHelpers.apply(e,r):arcHelpers.apply("defaultScanResults",r)},clear:e=>{arcHelpers.items=[];const t=document.querySelectorAll("[class~=arcToolkitElement]");for(const l of t)l.remove();const r=Object.keys(arcHelpers.tools),a=e||r;for(const l of a)r.includes(l)&&arcHelpers.tools[l].unapply()},redraw:()=>{if(arcHelpers.items.length)for(const e of arcHelpers.items){const t=e.element.getBoundingClientRect();e.helper.style.width=t.width+"px",e.helper.style.height=t.height+"px";const r=U(e.element);e.helper.style.top=r.top+"px",e.helper.style.left=r.left+"px"}},sendIframe:(e,t)=>new Promise(((r,a)=>{t.from="arcToolkit";const l=new MessageChannel;if(l.port1.onmessage=({data:e})=>{l.port1.close(),e.error?a(e.error):r(e.items)},l.port1.start(),l.port2.start(),e.contentWindow&&e.contentWindow.postMessage)try{e.contentWindow.postMessage(t,"*",[l.port2])}catch(o){a(o)}else a("postMessage not allowed on iframe")})),highlight:e=>{arcHelpers.unHighlight();const t=e.replaceAll('"',""),r=document.querySelector(`[data-xpath="${t}"]`);r&&r.classList.add("selected")},unHighlight:()=>{const e=document.querySelector(".arcToolkitElement.selected");e&&e.classList.remove("selected")}},window.addEventListener("resize",(function(){clearTimeout(v),v=setTimeout(E,100)})),addEventListener("message",(e=>{if(e.data&&"arcToolkit"==e.data.from){const t=e.data.tool,r=e.data.params;arcHelpers[t].apply(r).then((r=>{e.ports[0].postMessage({tool:t,items:r})}))}}),!1),window.location!==window.parent.location&&(arcHelpers.isInFrame=!0)}();
