(()=>{"use strict";var e={9074:(e,t,r)=>{},7302:(e,t,r)=>{r(9074),r(1055),r(4323)},1940:(e,t,r)=>{r.d(t,{X:()=>o});var s=r(7865),n=r(9574);class o{_style=document.createElement("style");injectToBody=(0,n.m)((async()=>{await s.W,document.head?.appendChild(this._style)}));constructor(e){e&&this.loadRule(e)}async loadRule(...e){await this.injectToBody();const t=this._style.sheet;if(t)for(const r of e)t.insertRule(r)}async unloadAll(){await this.injectToBody();const e=this._style.sheet;if(e)for(;e.cssRules.length>0;)e.deleteRule(0)}}},4896:(e,t,r)=>{r.d(t,{f:()=>n});var s=r(1055);const n=(e,t,r)=>{const n=r.value;return r.value=function(...e){if(s.x)return n.apply(this,e)},r}},9849:(e,t,r)=>{r.d(t,{p:()=>n});var s=r(2319);const n=(e,t,r)=>{let n;const o=r.value,a=new s.H((async()=>o.apply(n)));r.value=function(){return n=this,a.execute()}}},4648:(e,t,r)=>{r.d(t,{J:()=>s});const s=()=>"moz-extension:"!==self.location.protocol},9574:(e,t,r)=>{function s(e){let t,r=!1;return(...s)=>r?t:(r=!0,t=e(...s))}r.d(t,{m:()=>s})},2319:(e,t,r)=>{r.d(t,{H:()=>s});class s{_callback;promise;constructor(e){this._callback=e}execute(){return this.promise||(this.promise=this._callback().finally((()=>{this.promise=void 0}))),this.promise}}},8282:(e,t,r)=>{r.d(t,{pf:()=>s});const s="about:blank"},7865:(e,t,r)=>{r.d(t,{W:()=>n});var s=r(1055);const n=s.x?Promise.resolve():new Promise((e=>"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>e()))))},6382:(e,t,r)=>{r.d(t,{c:()=>s});class s{subscribers=[];addOnChange(e){this.subscribers.push(e)}removeOnChange(e){this.subscribers=this.subscribers.filter((t=>t!==e))}hasOnChange(e){return this.subscribers.includes(e)}notifyChange(e){this.subscribers.forEach((t=>{try{t(e)}catch(e){}}))}}},2462:(e,t,r)=>{r.d(t,{Ie:()=>s});const s=void 0},5472:(e,t,r)=>{r(4323);var s=r(4648),n=(r(7302),r(1055),r(8312),r(2790),r(5654),r(2462),r(1894),r(8282));(0,s.J)()||(browser.windows||(browser.windows={}),browser.windows.getCurrent||(browser.windows.getCurrent=async e=>{const t=await browser.tabs.query({}),r=t.find((e=>e.active));return{id:r?.windowId??1,title:r?.title??"",focused:!0,alwaysOnTop:!1,incognito:!!browser.extension.inIncognitoContext,...e?.populate?{tabs:t}:{},state:"maximized",type:"normal",height:screen.availHeight,width:screen.availWidth,top:0,left:0}}),browser.windows.getLastFocused||(browser.windows.getLastFocused=async e=>browser.windows.getCurrent(e)),browser.windows.get||(browser.windows.get=async(e,t)=>{const[r]=await browser.tabs.query({windowId:e});return{...await browser.windows.getCurrent(t),id:r?.windowId??1,title:r?.title??"",focused:r?.active}}),browser.windows.getAll||(browser.windows.getAll=async e=>!1!==e?.windowTypes?.includes("normal")?[await browser.windows.getCurrent(e)]:[]),browser.windows.update||(browser.windows.update=async(e,t)=>{if(t.focused||"maximized"===t.state){const[t]=await browser.tabs.query({windowId:e});t&&await browser.tabs.update(t.id,{active:!0})}return browser.windows.getCurrent()}),browser.windows.remove||(browser.windows.remove=async e=>{const[t]=await browser.tabs.query({windowId:e});t&&await browser.tabs.remove(t.id)}),browser.windows.create||(browser.windows.create=async e=>{const t=e?.url?Array.isArray(e.url)?e.url:[e.url]:[n.pf];for(const r of t)await browser.tabs.create({url:r,active:e?.focused});const r=await browser.windows.getCurrent({populate:!0});return r.tabs=r.tabs.filter((e=>e.windowId===r.id)),r}))},1894:(e,t,r)=>{var s=r(8312),n=r(6382),o=r(9849),a=r(4323),i=r(4896),c=r(2462);function l(e,t,r,s){var n,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}class d extends n.c{broadcast;storage;constructor(){super(),this.broadcast=new BroadcastChannel("web_ext_alarms"),this.storage=s.r.getBrowserPolyfill("_internal_alarms"),this.infiniteAlarmsCheck()}async clearAll(){return await this.storage.clear(),!0}async clear(e=""){const{[e]:t}=await this.storage.get(e);return!!t&&(await this.storage.remove(e),!0)}async create(e,t){const[r,s]="string"==typeof e?[e,t]:["",e],n=Date.now(),o={name:r,scheduledTime:s.periodInMinutes?this.computeNextRun(s.periodInMinutes):s.when||n+6e4*(s.delayInMinutes||0),periodInMinutes:s.periodInMinutes};o.scheduledTime<n?this.notifyAllContexts(o):await this.storage.set({[r]:o})}async get(e=""){const{[e]:t}=await this.storage.get(e);return t}async getAll(){const e=await this.storage.get();return Object.values(e)}async infiniteAlarmsCheck(){for(;;)await this.checkForDueAlarms(),await(0,a.BK)(12e3)}async checkForDueAlarms(){const e=Date.now(),t=(await this.getAll()).filter((t=>t.scheduledTime<=e));for(const e of t)this.notifyAllContexts(e),e.periodInMinutes?(e.scheduledTime=this.computeNextRun(e.periodInMinutes),await this.storage.set({[e.name]:e})):await this.storage.remove(e.name)}computeNextRun(e){return Date.now()+6e4*e}async notifyAllContexts(e){this.notifyChange(e),await c.Ie,this.broadcast.postMessage(e)}static getBrowserPolyfill(){const e=new d;return{get:e.get.bind(e),getAll:e.getAll.bind(e),create:e.create.bind(e),clear:e.clear.bind(e),clearAll:e.clearAll.bind(e),onAlarm:{addListener:e.addOnChange.bind(e),hasListener:e.hasOnChange.bind(e),removeListener:e.removeOnChange.bind(e)}}}}l([i.f],d.prototype,"infiniteAlarmsCheck",null),l([i.f,o.p],d.prototype,"checkForDueAlarms",null)},2790:(e,t,r)=>{r(5076),r(9574),r(4323),r(2462),r(1055)},8312:(e,t,r)=>{r.d(t,{r:()=>i});var s=r(6382),n=r(4323),o=r(1055),a=r(2462);class i extends s.c{storageArea;onChanged;constructor(e){super(),this.storageArea=e,this.onChanged=new BroadcastChannel(`web_ext_storage.${this.storageArea}.onChanged`),this.onChanged.onmessage=e=>{const t=e.data;this.notifyChange(t)},this.onChanged.onmessageerror=console.error}async notifyAllContexts(e){this.notifyChange(e),await a.Ie,this.onChanged.postMessage(e)}async withDb(e){const t=self.indexedDB.open(`web_ext_storage.${this.storageArea}`,1);return new Promise(((e,r)=>{t.onerror=()=>r(t.error),t.onsuccess=()=>e(t.result),t.onupgradeneeded=()=>{const e=t.result;e.objectStoreNames.contains("data")||e.createObjectStore("data",{keyPath:"key"})}})).then(e).finally((()=>t.result.close()))}async getMultipleItems(e,t){const r=t.map((t=>new Promise(((r,s)=>{const n=e.get(t);n.onerror=()=>s(n.error),n.onsuccess=()=>r(n.result)}))));return Object.fromEntries((await Promise.all(r)).filter(n.zz).map((e=>[e.key,e.value])))}async get(e){return this.withDb((async t=>{const r=t.transaction("data","readonly").objectStore("data");if(Array.isArray(e))return this.getMultipleItems(r,e);const s=r.getAll(e);return new Promise(((e,t)=>{s.onerror=()=>t(s.error),s.onsuccess=()=>e(s.result.reduce(((e,{key:t,value:r})=>(e[t]=r,e)),{}))}))}))}async set(e){return this.withDb((async t=>{const r=t.transaction("data","readwrite"),s=r.objectStore("data"),n=await this.getMultipleItems(s,Object.keys(e)),o={};for(const[t,r]of Object.entries(e))s.put({key:t,value:r}),o[t]={oldValue:n[t],newValue:r};return new Promise(((e,t)=>{r.onerror=()=>t(r.error),r.oncomplete=()=>{this.notifyAllContexts(o),e()}}))}))}async remove(e){return this.withDb((async t=>{const r=t.transaction("data","readwrite"),s=r.objectStore("data");e=Array.isArray(e)?e:[e];const n=await this.getMultipleItems(s,e);for(const t of e)s.delete(t);return new Promise(((t,s)=>{r.onerror=()=>s(r.error),r.oncomplete=()=>{const r={};for(const t of e)r[t]={oldValue:n[t]};this.notifyAllContexts(r),t()}}))}))}async clear(){return this.withDb((async e=>{const t=e.transaction("data","readwrite");return t.objectStore("data").clear(),new Promise(((e,r)=>{t.onerror=()=>r(t.error),t.oncomplete=()=>e()}))}))}async getBytesInUse(){return this.withDb((async e=>{const t=e.transaction("data","readonly").objectStore("data").getAll();return new Promise(((e,r)=>{t.onerror=()=>r(t.error),t.onsuccess=()=>{const r=t.result.reduce(((e,{key:t,value:r})=>e+t.length+JSON.stringify(r).length),0);e(r)}}))}))}static getBrowserPolyfill(e){const t=new i(e);return"session"===e&&o.x&&self.addEventListener("activate",(()=>t.clear())),{get:t.get.bind(t),set:t.set.bind(t),remove:t.remove.bind(t),clear:t.clear.bind(t),getBytesInUse:t.getBytesInUse.bind(t),onChanged:{addListener:t.addOnChange.bind(t),removeListener:t.removeOnChange.bind(t),hasListener:t.hasOnChange.bind(t)}}}}},5654:(e,t,r)=>{r(1055),r(2462)},5076:(e,t,r)=>{},4323:(e,t,r)=>{r.d(t,{BK:()=>n,zz:()=>s});const s=e=>!!e,n=e=>new Promise((t=>setTimeout(t,e)))},1055:(e,t,r)=>{r.d(t,{x:()=>s});const s="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);r(5472);var s=r(1940);const n=new s.X;browser.runtime.onMessage.addListener((e=>{switch(e.type){case"cs_shooting_done":n.unloadAll();break;case"cs_scale_down":t=e.scaleDown,n.loadRule(`\nhtml {\n  transform-origin: top !important;\n  transform: scale(${t}) !important;\n}`)}var t})),n.loadRule("* {scrollbar-width: none !important}","* {transition: none !important}","body {overflow: hidden !important}","body > img:only-child { margin-top: 0 !important; }"),(async()=>{"wrappedJSObject"in document&&Object.defineProperties(document.wrappedJSObject,{hidden:{value:!1},visibilityState:{value:"visible"}}),["visibilitychange","fullscreenchange"].forEach((e=>window.addEventListener(e,(e=>e.stopImmediatePropagation()),!0)))})().catch((e=>((e,t)=>{const r={type:"el_log_runtime_error",data:{context:"cs",name:e,errName:t?.name||t?.target?.error?.name,errMessage:t?.message||t?.target?.error?.message,err:String(t),time:Date.now()}};browser.runtime.sendMessage(r)})("prepare for shooting failed",e)))})();