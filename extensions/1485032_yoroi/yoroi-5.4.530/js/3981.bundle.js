(self.webpackChunkyoroi=self.webpackChunkyoroi||[]).push([[3981],{15687:(e,t,s)=>{"use strict";s.d(t,{UJ:()=>h,L4:()=>f});var r=s(59340),a=s.n(r),o=s(29828),n=s.n(o),i=s(56474),l=s.n(i),d=s(86335),c=s(17462),u=s.n(c);s(90649);const h=l()({DATA:61284,SIG:61285});function p(e){return n()(e).call(e,"0x")?e:"0x"+e}function f(e,t,s,r,o){const n=d.RustModule.WalletV4.encode_json_str_to_metadatum(a()({1:[[p(e),1]],2:p(t),3:p(s),4:r,5:0}),d.RustModule.WalletV4.MetadataJsonSchema.BasicConversions),i=d.RustModule.WalletV4.GeneralTransactionMetadata.new();i.insert(d.RustModule.WalletV4.BigNum.from_str(h.DATA.toString()),n);const l=u()(32).update(i.to_bytes()).digest("binary");i.insert(d.RustModule.WalletV4.BigNum.from_str(h.SIG.toString()),d.RustModule.WalletV4.encode_json_str_to_metadatum(a()({1:p(o(l))}),d.RustModule.WalletV4.MetadataJsonSchema.BasicConversions));const c=d.RustModule.WalletV4.MetadataList.new();return c.add(d.RustModule.WalletV4.TransactionMetadatum.from_bytes(i.to_bytes())),c.add(d.RustModule.WalletV4.TransactionMetadatum.new_list(d.RustModule.WalletV4.MetadataList.new())),d.RustModule.WalletV4.AuxiliaryData.from_bytes(c.to_bytes())}},76900:(e,t,s)=>{"use strict";s.d(t,{sn:()=>i,BT:()=>l}),s(77766),s(3649);var r=s(2153),a=(s(55835),s(86335)),o=s(90649),n=s(48764).Buffer;const i=()=>(0,r.OF)(160).split(" ");function l(e){const t=(0,r.oy)(e),s=n.from("");return a.RustModule.WalletV4.Bip32PrivateKey.from_bip39_entropy((0,o.hexToBytes)(t),s)}},86335:(e,t,s)=>{"use strict";s.d(t,{RustModule:()=>x});var r=s(93476),a=s.n(r),o=s(87672),n=s.n(o),i=s(10062),l=s.n(i),d=s(78914),c=s.n(d),u=s(54103),h=s.n(u),p=s(62734),f=s.n(p),g=s(77149),A=s.n(g),I=s(56474);function T(e){return null!=e&&"number"==typeof e.__wbg_ptr&&"function"==typeof e.free}const w=s.n(I)()([Uint8Array]),y="____is_wasm_proxy";const x=new class{constructor(){n()(this,"_wasmv2",void 0),n()(this,"_wasmv4",void 0),n()(this,"_messageSigning",void 0),n()(this,"_crossCsl",void 0)}async load(){null==this._wasmv2&&null==this._wasmv4&&null==this._messageSigning&&null==this._crossCsl&&(this._wasmv2=await s.e(4388).then(s.bind(s,82123)),this._wasmv4=await Promise.all([s.e(4351),s.e(8066)]).then(s.bind(s,4351)),this._messageSigning=await s.e(5573).then(s.bind(s,85573)),this._crossCsl=await Promise.all([s.e(4351),s.e(5560),s.e(5262)]).then(s.bind(s,75560)))}__WasmScopeInternal(e){const t=function(){const e=[];return{RustModule:function t(s){return null!=(r=s)&&function(e){return"object"==typeof e||"function"==typeof e}(r)&&!function(e){return A()(w).call(w,(t=>e instanceof t))}(r)&&function(e){return!0!==e[y]}(r)?new Proxy(s,{get(s,r,a){if(r===y)return!0;const o=f()(s,r,a);return"prototype"===r?o:"function"==typeof o&&null==o.prototype?function(...r){const a=h()(o).call(o,s)(...r);return T(a)&&e.push(a),t(a)}:t(o)}}):s;var r}(x),free:()=>{c()(e).call(e,(e=>{0!==e.__wbg_ptr&&e.free()}))},size:()=>e.length,isFree:()=>l()(e).call(e,(e=>0===e.__wbg_ptr))}}();function s(e){if(t.free(),T(e))throw new Error("A wasm object cannot be returned from wasm scope, all pointers are destroyed.");return{result:e,scopeSize:t.size(),scopeIsFree:t.isFree()}}function r(e){throw t.free(),e}let o;try{o=e(t.RustModule)}catch(e){throw r(e),e}return o instanceof a()?o.then(s,r):s(o)}WasmScope(e){const t=this.__WasmScopeInternal(e);return t instanceof a()?t.then((e=>e.result)):t.result}ScopeMonad(e){var t;const s=h()(t=this.WasmScope).call(t,this);return function e(t){return{wasmMap:s=>e((e=>s(t(e),e))),unwrap:e=>s((s=>e(t(s),s)))}}(e)}get WalletV2(){return this._wasmv2}get WalletV4(){return this._wasmv4}get CrossCsl(){return this._crossCsl}WalletV4TxBuilderFromConfig(e){return this.WalletV4TxBuilder({linearFee:x.WalletV4.LinearFee.new(x.WalletV4.BigNum.from_str(e.LinearFee.coefficient),x.WalletV4.BigNum.from_str(e.LinearFee.constant)),coinsPerUtxoByte:x.WalletV4.BigNum.from_str(e.CoinsPerUtxoByte),poolDeposit:x.WalletV4.BigNum.from_str(e.PoolDeposit),keyDeposit:x.WalletV4.BigNum.from_str(e.KeyDeposit)})}WalletV4TxBuilder(e){const{linearFee:t,coinsPerUtxoByte:s,poolDeposit:r,keyDeposit:a,maxValueBytes:o,maxTxBytes:n}=e,i=this.WalletV4;return i.TransactionBuilder.new(i.TransactionBuilderConfigBuilder.new().fee_algo(t).pool_deposit(r).key_deposit(a).coins_per_utxo_byte(s).max_value_size(null!=o?o:5e3).max_tx_size(null!=n?n:16384).ex_unit_prices(i.ExUnitPrices.new(i.UnitInterval.new(i.BigNum.from_str("577"),i.BigNum.from_str("10000")),i.UnitInterval.new(i.BigNum.from_str("721"),i.BigNum.from_str("10000000")))).prefer_pure_change(!0).build())}get MessageSigning(){return this._messageSigning}}},15476:(e,t,s)=>{"use strict";s.d(t,{n:()=>a});var r=s(2153);const a=(e,t)=>e.split(" ").length===t&&(0,r._I)(e)},24283:(e,t,s)=>{"use strict";s.d(t,{addrContainsAccountKey:()=>n,filterAddressesByStakingKey:()=>i,createCertificate:()=>c}),s(2991),s(32366),s(905);var r=s(86335),a=s(95667),o=(s(55343),s(90649));function n(e,t,s){const o=(0,a.normalizeToAddress)(e);if(null==o)throw new Error(`addrContainsAccountKey invalid address ${e}`);const n="string"==typeof t?t:t.to_hex(),i=r.RustModule.WalletV4.BaseAddress.from_address(o);if(null!=i){const e=i.stake_cred().to_hex()===n;if(i.free(),e)return!0}const l=r.RustModule.WalletV4.PointerAddress.from_address(o);return null!=l&&l.free(),o.free(),s}function i(e,t,s){const r=[];for(const a of t)n(a.address,e,s)&&r.push(a);return r}const l="ALWAYS_ABSTAIN",d="ALWAYS_NO_CONFIDENCE";function c(e,t,s,a){const n=r.RustModule.WalletV4.Credential.from_keyhash(r.RustModule.WalletV4.Ed25519KeyHash.from_hex(e));if(null==s&&null==a)return t?[r.RustModule.WalletV4.Certificate.new_stake_deregistration(r.RustModule.WalletV4.StakeDeregistration.new(n))]:[];const i=[];if(t||i.push(r.RustModule.WalletV4.Certificate.new_stake_registration(r.RustModule.WalletV4.StakeRegistration.new(n))),null!=s){const e=r.RustModule.WalletV4.Ed25519KeyHash.from_hex(s);i.push(r.RustModule.WalletV4.Certificate.new_stake_delegation(r.RustModule.WalletV4.StakeDelegation.new(n,e)))}return null!=a&&i.push(r.RustModule.WalletV4.Certificate.new_vote_delegation(r.RustModule.WalletV4.VoteDelegation.new(n,function(e){try{var t,s;const a=r.RustModule.WalletV4.DRep;if(e===l)return a.new_always_abstain();if(e===d)return a.new_always_no_confidence();const n=r.RustModule.WalletV4.Credential.from_hex(e);return null!==(t=null!==(s=(0,o.maybe)(n.to_keyhash(),(e=>a.new_key_hash(e))))&&void 0!==s?s:(0,o.maybe)(n.to_scripthash(),(e=>a.new_script_hash(e))))&&void 0!==t?t:(0,o.fail)("weird credential cannot be converted into a drep: "+n.to_hex())}catch(t){throw console.log("Fail to parse a drep credential: "+e,t),t}}(a)))),i}},54901:(e,t,s)=>{"use strict";s.d(t,{bp:()=>d,BB:()=>c});var r=s(59340),a=s.n(r),o=s(78914),n=s.n(o),i=s(86335),l=s(69875);function d(e){const t=i.RustModule.WalletV4.GeneralTransactionMetadata.new();n()(e).call(e,(e=>{const s=i.RustModule.WalletV4.encode_json_str_to_metadatum(a()(e.data),i.RustModule.WalletV4.MetadataJsonSchema.BasicConversions);t.insert(i.RustModule.WalletV4.BigNum.from_str(e.label),s)}));const s=i.RustModule.WalletV4.AuxiliaryData.new();return s.set_metadata(t),s}function c(e){return(0,l.isHex)(e)?i.RustModule.WasmScope((t=>{const s=t.WalletV4.TransactionMetadatum.from_hex(e);return t.WalletV4.decode_metadatum_to_json_str(s,t.WalletV4.MetadataJsonSchema.BasicConversions)})):a()(e)}},4922:(e,t,s)=>{"use strict";s.d(t,{_v:()=>_e,ON:()=>ve,Jr:()=>Ce,$1:()=>be,ew:()=>De,tu:()=>We,Ci:()=>Oe,pV:()=>Pe});var r=s(51938),a=s.n(r),o=s(51942),n=s.n(o),i=s(32366),l=s.n(i),d=s(78914),c=s.n(d),u=s(93476),h=s.n(u),p=s(81643),f=s.n(p),g=s(89400),A=s.n(g),I=s(3649),T=s.n(I),w=s(47302),y=s.n(w),x=s(46423),E=s.n(x),m=s(11128),k=s.n(m),S=s(2084),_=s.n(S),v=s(56474),M=s.n(v),C=s(86902),b=s.n(C),D=s(80426),W=s.n(D),O=s(20116),N=s.n(O),R=s(39392),G=s.n(R),P=s(36384),B=s.n(P),L=s(66419),U=s.n(L),V=s(2991),H=s.n(V),F=s(905),K=s(96486),q=s(40705),z=s.n(q),Y=s(57421),J=s(90691),X=s(39845),Z=s(97143),$=s(41979),j=s(17625),Q=s(44946),ee=s(82982),te=s(85339),se=s(75697),re=s(38079),ae=s(3577),oe=(s(27189),s(47908)),ne=s(81369),ie=s(7559),le=s(91811),de=s(84174),ce=s(72741),ue=s(37495),he=s(51965),pe=s(24651),fe=s(66905),ge=s(21131),Ae=s(27649),Ie=s(21636),Te=s(95667),we=s(86335),ye=s(36018),xe=s(1499),Ee=s(90649),me=s(74119);async function ke(e,t,s,r,a){const{utxoAddresses:o,accountingAddresses:n}=await(0,ue.g_)(t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,GetDerivationSpecific:s.GetDerivationSpecific},r,a),i=H()(o).call(o,(e=>e.address.AddressId)),l=H()(n).call(n,(e=>e.address.AddressId)),d=await s.GetCertificates.forAddress(e,t,{addressIds:[...l,...i]});return{txIds:U()(new(B())([...await s.AssociateTxWithAccountingIOs.getTxIdsForAddresses(e,t,{addressIds:l}),...await s.AssociateTxWithUtxoIOs.getTxIdsForAddresses(e,t,{addressIds:i}),...H()(d).call(d,(e=>e.transaction.TransactionId))])),addresses:{utxoAddresses:H()(o).call(o,(e=>e.address)),accountingAddresses:H()(n).call(n,(e=>e.address))}}}async function Se(e,t,s,r,a){var o,n;const{publicDeriver:i}=r,{addresses:l,txIds:d}=await ke(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetCertificates:s.GetCertificates},{publicDeriver:i},a),c=new(G()),u=await r.getTxAndBlock(d);for(const e of u)c.set(e.Transaction.TransactionId,e.Block);const h=[...await s.CardanoByronAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(o=H()(u).call(u,(e=>e.Transaction))).call(o,(e=>e.Type===J.iU.CardanoByron)),networkId:i.getParent().getNetworkInfo().NetworkId}),...await s.CardanoShelleyAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(n=H()(u).call(u,(e=>e.Transaction))).call(n,(e=>e.Type===J.iU.CardanoShelley)),networkId:i.getParent().getNetworkInfo().NetworkId})],p=new(G());{const s=W()(h).call(h,(e=>{var t,s,r,a;return[...H()(t=e.utxoInputs).call(t,(e=>e.AddressId)),...H()(s=e.utxoOutputs).call(s,(e=>e.AddressId)),...null==e.accountingInputs?[]:H()(r=e.accountingInputs).call(r,(e=>e.AddressId)),...null==e.certificates?[]:W()(a=e.certificates).call(a,(e=>{var t;return H()(t=e.relatedAddresses).call(t,(e=>e.AddressId))}))]})),r=await X.t9.getById(e,t,U()(new(B())(s)));for(const e of r)p.set(e.AddressId,e.Hash)}const f=i.getParent().getDefaultToken();return{addressLookupMap:p,txs:H()(h).call(h,(e=>{var t,s;return{...e,block:c.get(e.transaction.TransactionId)||null,...(0,Ae.lG)({tokens:e.tokens,utxoInputs:e.utxoInputs,utxoOutputs:e.utxoOutputs,accountingInputs:null==e.accountingInputs?void 0:e.accountingInputs,allOwnedAddressIds:new(B())(H()(t=W()(s=b()(l)).call(s,(e=>l[e]))).call(t,(e=>e.AddressId))),ownImplicitInput:i.getParent().getDefaultMultiToken(),ownImplicitOutput:(()=>{if(e.txType===J.iU.CardanoShelley){const t=i.getParent().getDefaultMultiToken();for(const s of e.certificates)s.certificate.Kind===we.RustModule.WalletV4.CertificateKind.MoveInstantaneousRewardsCert&&we.RustModule.WasmScope((e=>{const r=e.WalletV4.MoveInstantaneousRewardsCert.from_hex(s.certificate.Payload).move_instantaneous_reward().as_to_stake_creds();for(const a of s.relatedAddresses)for(const s of l.accountingAddresses)if(a.AddressId===s.AddressId){const a=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_hex(s.Hash));if(null==a)continue;const o=null==r?void 0:r.get(a.payment_cred());if(null==o)continue;const n=o.is_positive(),i=n?o.as_positive():o.as_negative();if(null==i)continue;const l=(n?"":"-")+i.to_str();t.add({identifier:f.defaultIdentifier,networkId:f.defaultNetworkId,amount:new F.Z(l)})}}));return t}return i.getParent().getDefaultMultiToken()})(),defaultToken:f})}}))}}async function _e(e){var t,s;const r=e.publicDeriver.getParent().getDerivationTables(),a=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,CardanoByronAssociateTxWithIOs:se.X,CardanoShelleyAssociateTxWithIOs:se.K,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN,GetTxAndBlock:X.Lq,GetDerivationSpecific:le.n,GetCertificates:X.CT}),o=W()(t=H()(s=b()(a)).call(s,(e=>a[e]))).call(t,(t=>(0,Y.Hz)(e.publicDeriver.getDb(),t)));return await(0,Y.zm)(e.publicDeriver.getDb(),[...o,...(0,Y.pS)(e.publicDeriver.getDb(),r)],(async t=>await Se(e.publicDeriver.getDb(),t,{GetPathWithSpecific:a.GetPathWithSpecific,GetAddress:a.GetAddress,CardanoByronAssociateTxWithIOs:a.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:a.CardanoShelleyAssociateTxWithIOs,AssociateTxWithUtxoIOs:a.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:a.AssociateTxWithAccountingIOs,GetTxAndBlock:a.GetTxAndBlock,GetDerivationSpecific:a.GetDerivationSpecific,GetCertificates:a.GetCertificates},{...e,getTxAndBlock:async s=>await a.GetTxAndBlock.byTime(e.publicDeriver.getDb(),t,{txIds:s,skip:e.skip,limit:e.limit})},r)))}async function ve(e){var t,s;const r=e.publicDeriver.getParent().getDerivationTables(),a=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,CardanoByronAssociateTxWithIOs:se.X,CardanoShelleyAssociateTxWithIOs:se.K,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN,GetTxAndBlock:X.Lq,GetDerivationSpecific:le.n,GetCertificates:X.CT}),o=W()(t=H()(s=b()(a)).call(s,(e=>a[e]))).call(t,(t=>(0,Y.Hz)(e.publicDeriver.getDb(),t)));return await(0,Y.zm)(e.publicDeriver.getDb(),[...o,...(0,Y.pS)(e.publicDeriver.getDb(),r)],(async t=>await Se(e.publicDeriver.getDb(),t,{GetPathWithSpecific:a.GetPathWithSpecific,GetAddress:a.GetAddress,CardanoByronAssociateTxWithIOs:a.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:a.CardanoShelleyAssociateTxWithIOs,AssociateTxWithUtxoIOs:a.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:a.AssociateTxWithAccountingIOs,GetTxAndBlock:a.GetTxAndBlock,GetDerivationSpecific:a.GetDerivationSpecific,GetCertificates:a.GetCertificates},{...e,getTxAndBlock:async s=>await a.GetTxAndBlock.withStatus(e.publicDeriver.getDb(),t,{txIds:s,status:[re.YM.PENDING]})},r)))}async function Me(e,t,s,r,a){var o,n;const i=await ke(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetCertificates:s.GetCertificates},{publicDeriver:a.publicDeriver},r),l=await s.GetTransaction.fromIds(e,t,{ids:i.txIds}),d=[...await s.CardanoByronAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(l).call(l,(e=>e.Type===J.iU.CardanoByron)),networkId:a.publicDeriver.getParent().getNetworkInfo().NetworkId}),...await s.CardanoShelleyAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(l).call(l,(e=>e.Type===J.iU.CardanoShelley)),networkId:a.publicDeriver.getParent().getNetworkInfo().NetworkId})],c=W()(d).call(d,(e=>{var t,s,r;return[...H()(t=e.utxoInputs).call(t,(e=>e.AddressId)),...H()(s=e.utxoOutputs).call(s,(e=>e.AddressId)),...null==e.accountingInputs?[]:H()(r=e.accountingInputs).call(r,(e=>e.AddressId))]})),u=new(B())(H()(o=W()(n=b()(i.addresses)).call(n,(e=>i.addresses[e]))).call(o,(e=>e.AddressId))),h=N()(c).call(c,(e=>!u.has(e)));return U()(new(B())(h))}async function Ce(e){var t,s;const r=e.publicDeriver.getParent().getDerivationTables(),a=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,CardanoByronAssociateTxWithIOs:se.X,CardanoShelleyAssociateTxWithIOs:se.K,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN,GetDerivationSpecific:le.n,GetTransaction:X.Ey,GetCertificates:X.CT}),o=e.publicDeriver.getDb(),n=W()(t=H()(s=b()(a)).call(s,(e=>a[e]))).call(t,(e=>(0,Y.Hz)(o,e)));return await(0,Y.zm)(o,[...o.getSchema().tables(),...n,...(0,Y.pS)(o,r)],(async t=>{const s=await Me(o,t,a,e.publicDeriver.getParent().getDerivationTables(),{publicDeriver:e.publicDeriver}),r=await X.t9.getById(o,t,s),n=[],i=new(B());for(const e of r)i.has(e.Hash)||(i.add(e.Hash),n.push({address:e.Hash,type:e.Type}));return n}))}async function be(e,t,s,r,a){const o=await Me(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,CardanoByronAssociateTxWithIOs:s.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:s.CardanoShelleyAssociateTxWithIOs,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetTransaction:s.GetTransaction,GetCertificates:s.GetCertificates},r,a),n=await ke(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetCertificates:s.GetCertificates},{publicDeriver:a.publicDeriver},r),i=await async function(e,t,s,r,a){var o;const n=await ke(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetCertificates:s.GetCertificates},{publicDeriver:a.publicDeriver},r),i=await s.GetTransaction.fromIds(e,t,{ids:n.txIds}),l=[...await s.CardanoByronAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(i).call(i,(e=>e.Type===J.iU.CardanoByron)),networkId:a.publicDeriver.getParent().getNetworkInfo().NetworkId}),...await s.CardanoShelleyAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(i).call(i,(e=>e.Type===J.iU.CardanoShelley)),networkId:a.publicDeriver.getParent().getNetworkInfo().NetworkId})];return U()(new(B())(H()(o=W()(l).call(l,(e=>e.tokens))).call(o,(e=>e.TokenList.ListId))))}(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,CardanoByronAssociateTxWithIOs:s.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:s.CardanoShelleyAssociateTxWithIOs,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetDerivationSpecific:s.GetDerivationSpecific,GetTransaction:s.GetTransaction,GetCertificates:s.GetCertificates},r,a);return await s.DeleteAllTransactions.delete(e,t,{publicDeriverId:a.publicDeriver.getPublicDeriverId(),txIds:n.txIds}),await s.ModifyAddress.remove(e,t,o),await s.FreeBlocks.free(e,t),await s.ModifyTokenList.remove(e,t,i),n}async function De(e){var t,s,r,a;const o=e.publicDeriver.getParent().getDerivationTables(),n=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,CardanoByronAssociateTxWithIOs:se.X,CardanoShelleyAssociateTxWithIOs:se.K,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN,GetDerivationSpecific:le.n,DeleteAllTransactions:ce.OQ,ModifyAddress:Z.ad,GetTransaction:X.Ey,FreeBlocks:Z.h,GetCertificates:X.CT,ModifyTokenList:Z.xx}),i=e.publicDeriver.getDb(),l=W()(t=H()(s=b()(n)).call(s,(e=>n[e]))).call(t,(e=>(0,Y.Hz)(i,e))),d=W()(r=H()(a=b()(xe.p.depsTables)).call(a,(e=>xe.p.depsTables[e]))).call(r,(e=>(0,Y.Hz)(i,e)));return await(0,Y.zm)(i,[...i.getSchema().tables(),...l,...(0,Y.pS)(i,o),...d],(async t=>(await xe.p.depsTables.ModifyUtxoAtSafePoint.remove(i,t,e.publicDeriver.getPublicDeriverId()),await xe.p.depsTables.ModifyUtxoDiffToBestBlock.removeAll(i,t,e.publicDeriver.getPublicDeriverId()),be(i,t,n,e.publicDeriver.getParent().getDerivationTables(),{publicDeriver:e.publicDeriver}))))}async function We(e,t,s,r,a,o){var n,i,l,d,c,u,h,p;const f=(0,ae.JM)(t),g=null==f?new(G()):f.getParent().getDerivationTables(),A=M()({GetKeyForPublicDeriver:oe.NX,GetAddress:X.t9,GetPathWithSpecific:X.LY,GetUtxoTxOutputsWithTx:ee.NW,ModifyAddress:Z.ad,GetPublicDeriver:oe.oR,AddDerivationTree:ie.if,ModifyDisplayCutoff:ne.J,GetDerivationsByPath:X.q8,GetDerivationSpecific:le.n,GetKeyDerivation:X.qV});await(0,Y.zm)(e,[...W()(n=H()(i=b()(A)).call(i,(e=>A[e]))).call(n,(t=>(0,Y.Hz)(e,t))),...(0,Y.pS)(e,g)],(async e=>{const r=(0,ae.hy)(t);null!=r&&await r.rawScanAddresses(e,{GetKeyForPublicDeriver:A.GetKeyForPublicDeriver,GetAddress:A.GetAddress,GetPathWithSpecific:A.GetPathWithSpecific,GetUtxoTxOutputsWithTx:A.GetUtxoTxOutputsWithTx,ModifyAddress:A.ModifyAddress,GetPublicDeriver:A.GetPublicDeriver,AddDerivationTree:A.AddDerivationTree,ModifyDisplayCutoff:A.ModifyDisplayCutoff,GetDerivationsByPath:A.GetDerivationsByPath,GetDerivationSpecific:A.GetDerivationSpecific,GetKeyDerivation:A.GetKeyDerivation},{checkAddressesInUse:s},g)}));const I=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,GetDerivationSpecific:le.n});await(0,Y.zm)(e,[...W()(l=H()(d=b()(xe.p.depsTables)).call(d,(e=>xe.p.depsTables[e]))).call(l,(t=>(0,Y.Hz)(e,t))),...W()(c=H()(u=b()(I)).call(u,(e=>I[e]))).call(c,(t=>(0,Y.Hz)(e,t)))],(async s=>{await async function(e,t,s,r,a){var o,n;const i=await(0,ue.g_)(t,{GetPathWithSpecific:r.GetPathWithSpecific,GetAddress:r.GetAddress,GetDerivationSpecific:r.GetDerivationSpecific},{publicDeriver:s},a),l=s.getUtxoStorageApi(),d=s.getUtxoService();l.setDb(e),l.setDbTx(t);const c=He({utxoAddresses:H()(o=i.utxoAddresses).call(o,(e=>e.address)),accountingAddresses:H()(n=i.accountingAddresses).call(n,(e=>e.address))});await async function(e,t){const s=new(B())(t),r=z().sha1(s),a=`TMP/UTXO_REQUEST_ADDRESSES_HASH/${e}`,o=await(0,me.Jt)(a),n=null==o||o!==r;return n&&(console.debug("/// utxo state must be cleared:",e,r,o),await(0,me.mM)(a,r)),n}(s.getPublicDeriverId(),c)&&await l.clearUtxoState(),await d.syncUtxoState(c)}(e,s,t,I,g)}));const T=(0,ae.se)(t);if(null==T)throw new Error("wallet doesn't support IGetAllUtxos");const w=await T.getAllUtxos(),y=W()(w).call(w,(e=>{var t;return H()(t=e.output.tokens).call(t,(e=>e.Token.Identifier))})),x=M()({ModifyToken:Z.$G,GetToken:X.YT});await(0,Y.zm)(e,W()(h=H()(p=b()(x)).call(p,(e=>x[e]))).call(h,(t=>(0,Y.Hz)(e,t))),(s=>Pe(e,s,x,y,r,a,o,t.getParent().getNetworkInfo())))}async function Oe(e,t,s,r,o,i,d,c,u,h,p,f){const g=(0,ae.JM)(t),I=null==g?new(G()):g.getParent().getDerivationTables();let w;try{var x,m;const s=M()({GetLastSyncForPublicDeriver:oe.tV,ModifyLastSyncInfo:ce.Ms,GetKeyForPublicDeriver:oe.NX,GetAddress:X.t9,GetPathWithSpecific:X.LY,GetUtxoTxOutputsWithTx:ee.NW,ModifyAddress:Z.ad,GetPublicDeriver:oe.oR,AddDerivationTree:ie.if,MarkUtxo:Q.t,ModifyDisplayCutoff:ne.J,GetDerivationsByPath:X.q8,GetEncryptionMeta:X.t$,GetTransaction:X.Ey,GetUtxoInputs:ee.uR,GetTxAndBlock:X.Lq,GetDerivationSpecific:le.n,ModifyTransaction:Z.BP,ModifyCardanoByronTx:$.o,ModifyCardanoShelleyTx:$.C,CardanoByronAssociateTxWithIOs:se.X,CardanoShelleyAssociateTxWithIOs:se.K,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN,GetCertificates:X.CT,GetKeyDerivation:X.qV,ModifyToken:Z.$G,GetToken:X.YT,AssociateToken:X.qr,DeleteAllTransactions:ce.OQ}),g=W()(x=H()(m=b()(s)).call(m,(e=>s[e]))).call(x,(t=>(0,Y.Hz)(e,t)));return await(0,Y.zm)(e,[...g,...(0,Y.pS)(e,I)],(async g=>{w=await s.GetLastSyncForPublicDeriver.forId(e,g,t.getPublicDeriverId());const{GetLastSyncForPublicDeriver:x,...m}=s;return await async function(e,t,s,r,o,i,d,c,u,h,p,f,g,I,w){var x,m,S;const _=r.getParent().getNetworkInfo(),v=e=>he.Z.toAbsoluteSlotNumber((0,de.getCardanoHaskellBaseConfig)(_),e);if(null!=w&&null!=I)throw new Error("Only one of `before` or `after` should be used for a resync");const M=await u({network:_}),C=null==w?M.hash:w.blockHash;if(null==w){const r=null==M.epoch||null==M.slot?null:v({epoch:M.epoch,slot:M.slot});await s.ModifyLastSyncInfo.overrideLastSyncInfo(e,t,{LastSyncInfoId:o.LastSyncInfoId,Time:new Date(k()()),SlotNum:r,BlockHash:M.hash,Height:M.height})}let D;if(null!=C){var O,R;const{txIds:o,addresses:u}=await ke(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,GetDerivationSpecific:s.GetDerivationSpecific,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetCertificates:s.GetCertificates},{publicDeriver:r},h);let x;if(null!=I)x=await i({network:_,addresses:He(u),after:{block:I.blockHash,tx:I.txHash||void 0},untilBlock:C}),D=H()(x).call(x,(e=>e.hash));else{var P,L,V;const e=await d({network:_,addresses:He(u),before:{blockHash:C,txHash:null==w?void 0:w.txHash}}),t=N()(P=E()(L=(0,Ee.listValues)(e)).call(L)).call(P,(0,Ee.createFilterUniqueBy)((e=>e.txHash)));y()(t).call(t,((e,t)=>t.epoch-e.epoch||t.slot-e.slot||t.txBlockIndex-e.txBlockIndex)),D=H()(V=T()(t).call(t,0,20)).call(V,(e=>e.txHash)),x=await c({network:_,txHashes:D})}const m=new(B())(H()(O=W()(R=b()(u)).call(R,(e=>u[e]))).call(O,(e=>e.AddressId)));await async function(e,t,s,r){const{TransactionSeed:o,BlockSeed:i}=await s.GetEncryptionMeta.get(e,t),d=new(G());{var c;const a=H()(c=r.txsFromNetwork).call(c,(e=>(0,j.a)(e.hash,o))),n=await s.GetTransaction.byDigest(e,t,{digests:a,txIds:r.txIds}),i=U()(A()(n).call(n)),l=[...await s.CardanoByronAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(i).call(i,(e=>e.Type===J.iU.CardanoByron)),networkId:r.network.NetworkId}),...await s.CardanoShelleyAssociateTxWithIOs.getIOsForTx(e,t,{txs:N()(i).call(i,(e=>e.Type===J.iU.CardanoShelley)),networkId:r.network.NetworkId})];for(const e of l)d.set(e.transaction.Hash,e)}const u=[],h=[],p=new(B());for(const a of r.txsFromNetwork){const n=d.get(a.hash);if(null==n){u.push(a);continue}const l=Ue(a,r.toAbsoluteSlotNumber,o,i);p.add(n.transaction.TransactionId);const c=await s.ModifyTransaction.updateExisting(e,t,{block:l.block,transaction:e=>({...l.transaction(e),TransactionId:n.transaction.TransactionId})});n.transaction.Status!==re.YM.IN_BLOCK&&null!==c.block&&h.push({...n,transaction:c.transaction,block:c.block})}const f=U()(new(B())(W()(u).call(u,(e=>{var t,s,a,o;return[...H()(t=W()(s=e.inputs).call(s,(e=>e.assets))).call(t,(e=>e.assetId)),...H()(a=W()(o=e.outputs).call(o,(e=>e.assets))).call(a,(e=>e.assetId)),r.defaultToken.defaultIdentifier]})))),g=await Pe(e,t,{ModifyToken:s.ModifyToken,GetToken:s.GetToken},f,r.getTokenInfo,r.getMultiAssetMetadata,r.getMultiAssetSupply,r.network),I=await(0,ee.i9)(e,t,{AssociateToken:s.AssociateToken}),{byronTxs:T,shelleyTxs:w}=await async function(e,t,s,r,o,i,d,c,u,h,p,f){const g=U()(new(B())(W()(o).call(o,(e=>{var t,s,r;return[...H()(t=e.inputs).call(t,(e=>e.address)),...H()(s=e.outputs).call(s,(e=>e.address)),...e.withdrawals?H()(r=e.withdrawals).call(r,(e=>e.address)):[]]})))),I=await i({db:e,tx:t,lockedTables:U()(A()(r).call(r)),hashes:g}),T=e=>{const t=I.get(e);if(void 0===t)throw new Error("networkTxToDbTx should never happen id === undefined");return t},w=e=>{const t=p.get(e);if(void 0===t)throw new Error("networkTxToDbTx should never happen -- asset missing");return t},y=[],x=[];for(const p of o){const{block:o,transaction:g}=Ue(p,c,u,h);if(null==p.type||p.type===Ie.p.byron)y.push({block:o,transaction:g,ioGen:Ne(p,T,s,w,f)});else{var E;if(p.type!==Ie.p.shelley)throw new Error(`networkTxToDbTx Unhandled tx type ${null!==(E=p.type)&&void 0!==E?E:""}`);{var m;const c=l()(m=(0,de.getCardanoHaskellBaseConfig)(s)).call(m,((e,t)=>n()(e,t)),{}),u=null==p.certificates?[e=>{}]:await Ve(e,t,{certificates:p.certificates,hashToIds:i,findOwnAddress:d,derivationTables:r,network:a()(c.ChainNetworkId,10)});x.push({block:o,transaction:g,certificates:u,ioGen:Re(p,T,s,w,f)})}}}return{byronTxs:y,shelleyTxs:x}}(e,t,r.network,r.derivationTables,u,r.hashToIds,r.findOwnAddress,r.toAbsoluteSlotNumber,o,i,g,I),y=new(B());for(const r of T){const a=await s.ModifyCardanoByronTx.addTxWithIOs(e,t,r);y.add(a.transaction.TransactionId),null!==a.block&&h.push({txType:a.txType,block:a.block,transaction:a.transaction,utxoInputs:a.utxoInputs,utxoOutputs:a.utxoOutputs,tokens:a.tokens})}for(const r of w){const a=await s.ModifyCardanoShelleyTx.addTxWithIOs(e,t,r);y.add(a.transaction.TransactionId),null!==a.block&&h.push({txType:a.txType,block:a.block,transaction:a.transaction,certificates:a.certificates,utxoInputs:a.utxoInputs,utxoOutputs:a.utxoOutputs,accountingInputs:a.accountingInputs,tokens:a.tokens})}const x=H()(h).call(h,(e=>e.transaction.TransactionId));await Be(e,t,{MarkUtxo:s.MarkUtxo,GetUtxoInputs:s.GetUtxoInputs,GetTransaction:s.GetTransaction},{inputTxIds:x,allTxIds:[...r.txIds,...x],isUnspent:!1,TransactionSeed:o,networkId:r.network.NetworkId});const E=await s.GetTransaction.withStatus(e,t,{txIds:r.txIds,status:[re.YM.PENDING]});for(const r of E)p.has(r.TransactionId)||y.has(r.TransactionId)||await s.ModifyTransaction.updateStatus(e,t,{transaction:r,status:re.YM.NOT_IN_REMOTE});return h}(e,t,{MarkUtxo:s.MarkUtxo,CardanoByronAssociateTxWithIOs:s.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:s.CardanoShelleyAssociateTxWithIOs,GetEncryptionMeta:s.GetEncryptionMeta,GetTransaction:s.GetTransaction,GetUtxoInputs:s.GetUtxoInputs,ModifyTransaction:s.ModifyTransaction,ModifyCardanoByronTx:s.ModifyCardanoByronTx,ModifyCardanoShelleyTx:s.ModifyCardanoShelleyTx,ModifyToken:s.ModifyToken,GetToken:s.GetToken,AssociateToken:s.AssociateToken},{network:r.getParent().getNetworkInfo(),txIds:o,txsFromNetwork:x,hashToIds:(0,pe.SL)(m,r.getParent().getNetworkInfo()),defaultToken:r.getParent().getDefaultToken(),findOwnAddress:(0,pe.K0)(m),toAbsoluteSlotNumber:v,derivationTables:h,getTokenInfo:p,getMultiAssetMetadata:f,getMultiAssetSupply:g})}else D=[];const F=await Se(e,t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,CardanoByronAssociateTxWithIOs:s.CardanoByronAssociateTxWithIOs,CardanoShelleyAssociateTxWithIOs:s.CardanoShelleyAssociateTxWithIOs,AssociateTxWithUtxoIOs:s.AssociateTxWithUtxoIOs,AssociateTxWithAccountingIOs:s.AssociateTxWithAccountingIOs,GetTxAndBlock:s.GetTxAndBlock,GetDerivationSpecific:s.GetDerivationSpecific,GetCertificates:s.GetCertificates},{publicDeriver:r,getTxAndBlock:async r=>await s.GetTxAndBlock.byTime(e,t,{txIds:r})},h),K=H()(x=T()(m=F.txs).call(m,100)).call(x,(e=>e.transaction.TransactionId));await s.DeleteAllTransactions.delete(e,t,{publicDeriverId:r.getPublicDeriverId(),txIds:K},!1);const q=new(B())(D);return{txs:N()(S=F.txs).call(S,(e=>q.has(e.transaction.Hash))),addressLookupMap:F.addressLookupMap}}(e,g,m,t,w,r,o,i,d,I,c,u,h,p,f)}))}catch(s){var S,v;if(!(s instanceof ge.zJ))throw s;if(void 0===w)throw s;const r=M()({GetPathWithSpecific:X.LY,GetAddress:X.t9,GetTxAndBlock:X.Lq,GetLastSyncForPublicDeriver:oe.tV,ModifyLastSyncInfo:ce.Ms,GetBlock:X.Ff,ModifyTransaction:Z.BP,MarkUtxo:Q.t,GetTransaction:X.Ey,GetUtxoInputs:ee.uR,GetEncryptionMeta:X.t$,GetDerivationSpecific:le.n,CardanoByronAssociateTxWithIOs:se.X,AssociateTxWithUtxoIOs:ee.zb,AssociateTxWithAccountingIOs:te.KN}),a=W()(S=H()(v=b()(r)).call(v,(e=>r[e]))).call(S,(t=>(0,Y.Hz)(e,t)));return await(0,Y.zm)(e,[...a,...(0,Y.pS)(e,I)],(async s=>{const a=await r.GetLastSyncForPublicDeriver.forId(e,s,t.getPublicDeriverId());(0,K.isEqual)(a,w)&&await async function(e,t,s,r,a){const{TransactionSeed:o}=await s.GetEncryptionMeta.get(e,t);if(null===r.lastSyncInfo.SlotNum)return;const{utxoAddresses:n,accountingAddresses:i}=await(0,ue.g_)(t,{GetPathWithSpecific:s.GetPathWithSpecific,GetAddress:s.GetAddress,GetDerivationSpecific:s.GetDerivationSpecific},{publicDeriver:r.publicDeriver},a),l=H()(n).call(n,(e=>e.address.AddressId)),d=H()(i).call(i,(e=>e.address.AddressId)),c=U()(new(B())([...await s.AssociateTxWithAccountingIOs.getTxIdsForAddresses(e,t,{addressIds:d}),...await s.AssociateTxWithUtxoIOs.getTxIdsForAddresses(e,t,{addressIds:l})])),u=await s.GetTxAndBlock.firstSuccessTxBefore(e,t,{txIds:c,height:_()});if(null==u)return;const h=await s.GetTxAndBlock.gteHeight(e,t,{txIds:c,height:u.Block.Height-fe.Q});for(const r of h)await s.ModifyTransaction.updateStatus(e,t,{status:re.YM.ROLLBACK_FAIL,transaction:r.Transaction});await Be(e,t,{MarkUtxo:s.MarkUtxo,GetUtxoInputs:s.GetUtxoInputs,GetTransaction:s.GetTransaction},{inputTxIds:H()(h).call(h,(e=>e.Transaction.TransactionId)),allTxIds:c,isUnspent:!0,TransactionSeed:o,networkId:r.publicDeriver.getParent().getNetworkInfo().NetworkId});const p=await s.GetTransaction.withStatus(e,t,{txIds:c,status:[re.YM.PENDING]});for(const r of p)await s.ModifyTransaction.updateStatus(e,t,{transaction:r,status:re.YM.ROLLBACK_FAIL});const f=await s.GetTxAndBlock.firstSuccessTxBefore(e,t,{txIds:c,height:u.Block.Height-fe.Q});await s.ModifyLastSyncInfo.overrideLastSyncInfo(e,t,{LastSyncInfoId:r.lastSyncInfo.LastSyncInfoId,Time:new Date(k()()),SlotNum:void 0===f?null:f.Block.SlotNum,Height:void 0===f?0:f.Block.Height,BlockHash:void 0===f?null:f.Block.Hash})}(e,s,r,{publicDeriver:t,lastSyncInfo:a},I)})),{addressLookupMap:new(G()),txs:[]}}}function Ne(e,t,s,r,a){if(null!=e.type&&e.type!==Ie.p.byron)throw new Error("genByronIOGen not a byron transaction");return o=>{const n=[],i=[],l=[];for(let i=0;i<e.inputs.length;i++){const d=e.inputs[i],c=a();l.push({TokenList:{Amount:d.amount,ListId:c,TokenId:r(re.hd.Cardano).TokenId},identifier:re.hd.Cardano,networkId:s.NetworkId});for(let e=0;e<d.assets.length;e++){const t=r(d.assets[e].assetId);l.push({TokenList:{Amount:d.assets[e].amount.toString(),ListId:c,TokenId:t.TokenId},identifier:d.assets[e].assetId,networkId:s.NetworkId})}n.push({TransactionId:o,AddressId:t(d.address),ParentTxHash:d.txHash,IndexInParentTx:d.index,IndexInOwnTx:i,TokenListId:c})}for(let n=0;n<e.outputs.length;n++){const d=e.outputs[n],c=a();l.push({TokenList:{Amount:d.amount,ListId:c,TokenId:r(re.hd.Cardano).TokenId},identifier:re.hd.Cardano,networkId:s.NetworkId});for(let e=0;e<d.assets.length;e++){const t=r(d.assets[e].assetId);l.push({TokenList:{Amount:d.assets[e].amount.toString(),ListId:c,TokenId:t.TokenId},identifier:d.assets[e].assetId,networkId:s.NetworkId})}i.push({TransactionId:o,AddressId:t(d.address),OutputIndex:n,IsUnspent:!0,ErgoBoxId:null,ErgoCreationHeight:null,ErgoRegisters:null,ErgoTree:null,TokenListId:c})}return{utxoInputs:n,utxoOutputs:i,tokenList:l}}}function Re(e,t,s,r,a){if(e.type!==Ie.p.shelley)throw new Error("genShelleyIOGen not a shelley transaction");return o=>{const n=[],i=[],l=[],d=[];for(let i=0;i<e.inputs.length;i++){const l=e.inputs[i],c=a();d.push({TokenList:{Amount:l.amount,ListId:c,TokenId:r(re.hd.Cardano).TokenId},identifier:re.hd.Cardano,networkId:s.NetworkId});for(let e=0;e<l.assets.length;e++){const t=r(l.assets[e].assetId);d.push({TokenList:{Amount:l.assets[e].amount.toString(),ListId:c,TokenId:t.TokenId},identifier:l.assets[e].assetId,networkId:s.NetworkId})}n.push({TransactionId:o,AddressId:t(l.address),ParentTxHash:l.txHash,IndexInParentTx:l.index,IndexInOwnTx:i,TokenListId:c})}for(let n=0;n<e.withdrawals.length;n++){const i=a();d.push({TokenList:{Amount:e.withdrawals[n].amount,ListId:i,TokenId:r(re.hd.Cardano).TokenId},identifier:re.hd.Cardano,networkId:s.NetworkId}),l.push({TransactionId:o,AddressId:t(e.withdrawals[n].address),SpendingCounter:0,IndexInOwnTx:n,TokenListId:i})}for(let n=0;n<e.outputs.length;n++){const l=e.outputs[n],c=a();d.push({TokenList:{Amount:l.amount,ListId:c,TokenId:r(re.hd.Cardano).TokenId},identifier:re.hd.Cardano,networkId:s.NetworkId});for(let e=0;e<l.assets.length;e++){const t=r(l.assets[e].assetId);d.push({TokenList:{Amount:l.assets[e].amount.toString(),ListId:c,TokenId:t.TokenId},identifier:l.assets[e].assetId,networkId:s.NetworkId})}const u=(0,Te.addressToKind)(l.address,"bytes",s);if(u!==re.dq.CARDANO_LEGACY&&u!==re.dq.CARDANO_ENTERPRISE&&u!==re.dq.CARDANO_BASE&&u!==re.dq.CARDANO_PTR)throw u===re.dq.CARDANO_REWARD?new Error("networkTxToDbTx cannot send to a reward address"):new Error("networkTxToDbTx Unhandled output type");i.push({TransactionId:o,AddressId:t(l.address),OutputIndex:n,TokenListId:c,IsUnspent:!0,ErgoBoxId:null,ErgoCreationHeight:null,ErgoRegisters:null,ErgoTree:null})}return{utxoInputs:n,utxoOutputs:i,accountingInputs:l,tokenList:d}}}const Ge=36e5;async function Pe(e,t,s,r,a,o,n,i){var l,d,u;const p=N()(l=await s.GetToken.fromIdentifier(e,t,r)).call(l,(e=>e.NetworkId===i.NetworkId)),g=new(G())(H()(p).call(p,(e=>[e.Identifier,e]))),A=new(B())(H()(d=N()(p).call(p,(e=>{if(e.IsDefault)return!0;const{lastUpdatedAt:t}=e.Metadata;return null!=t&&k()()-Date.parse(t)<Ge}))).call(d,(e=>e.Identifier))),I=N()(r).call(r,(e=>!A.has(e))),T=a({network:i,tokenIds:H()(I).call(I,(e=>e.split(".").join("")))}),w=async function(e,t,s,r){var a,o;const n=H()(a=N()(o=e||[]).call(o,(e=>-1!==f()(e).call(e,".")))).call(a,(e=>{const t=e.split("."),s=t[0];return{nameHex:t[1],policy:s}}));if(0===n.length)return[{},{}];const[i,l]=await h().all([t({network:r,assets:n}),s({network:r,assets:n})]);return[i,l]}(r,o,n,i);let y={},x={},E={};try{[y,[x,E]]=await h().all([T,w])}catch(e){console.error("Failed to query token info, metadata, or supply",e)}const m=N()(u=H()(I).call(I,(e=>{var t;const s=e.split(".").join("");let r=0,a=null,o=null,n=null,l=null;const d=y[s];var c,u,h,p;if(d)r=null!==(c=d.decimals)&&void 0!==c?c:0,o=null!==(u=d.ticker)&&void 0!==u?u:null,a=(new Date).toISOString(),n=null!==(h=d.name)&&void 0!==h?h:null,l=null!==(p=d.logo)&&void 0!==p?p:null;else if(null===d)a=(new Date).toISOString();else if(g.has(e))return null;const f=(0,Ae.PF)(e),A=(0,Ee.bytesToHex)(f.name.name()),I=f.policyId.to_hex(),T=x[e],w=E[e];let m=!1,k=[];return T&&(m=N()(T).call(T,(e=>"721"===e.key)).length>0&&"1"===w,k=H()(T).call(T,(e=>{const t={};return t[e.key]=e.metadata,t}))),{NetworkId:i.NetworkId,Identifier:e,IsDefault:!1,TokenId:null===(t=g.get(e))||void 0===t?void 0:t.TokenId,IsNFT:m,Metadata:{type:"Cardano",ticker:o,logo:l,longName:n,numberOfDecimals:r,assetName:A,policyId:I,lastUpdatedAt:a,assetMintMetadata:k}}}))).call(u,Boolean),S=await s.ModifyToken.upsert(e,t,m),_=new(G());return c()(p).call(p,(e=>_.set(e.Identifier,e))),c()(S).call(S,(e=>_.set(e.Identifier,e))),_}async function Be(e,t,s,r){const a=await s.GetUtxoInputs.fromTxIds(e,t,{ids:r.inputTxIds}),o=H()(a).call(a,(e=>(0,j.a)(e.ParentTxHash,r.TransactionSeed))),n=await s.GetTransaction.byDigest(e,t,{digests:o,txIds:r.allTxIds});for(const o of a){const a=n.get(o.ParentTxHash);void 0!==a&&await s.MarkUtxo.markAs(e,t,{txId:a.TransactionId,outputIndex:o.IndexInParentTx,isUnspent:r.isUnspent,networkId:r.networkId})}}function Le(e){if("Successful"===e)return re.YM.IN_BLOCK;if("Pending"===e)return re.YM.PENDING;if("Failed"===e)return re.YM.FAIL_RESPONSE;throw new Error("statusStringToCode unexpected status "+e)}function Ue(e,t,s,r){var a;const o=null!=e.epoch&&null!=e.slot&&null!=e.block_hash&&null!=e.time&&null!=e.height?{Hash:e.block_hash,BlockTime:new Date(e.time),Height:e.height,SlotNum:t({epoch:e.epoch,slot:e.slot}),Digest:(0,j.a)(e.hash,r)}:null,n=(0,j.a)(e.hash,s),i={Hash:e.hash,Digest:n,Ordinal:e.tx_ordinal,LastUpdateTime:null==o||null==e.time?new Date(e.last_update).getTime():new Date(e.time).getTime(),Status:Le(e.tx_state),ErrorMessage:null};if(null==e.type||e.type===Ie.p.byron)return{block:o,transaction:e=>({Type:J.iU.CardanoByron,Extra:null,BlockId:e,...i})};if(e.type===Ie.p.shelley)return{block:o,transaction:t=>{var s;return{Type:J.iU.CardanoShelley,Extra:{Fee:e.fee,Metadata:e.metadata,IsValid:null===(s=e.valid_transaction)||void 0===s||s},BlockId:t,...i}}};throw new Error(`networkTxHeaderToDb Unhandled tx type ${null!==(a=e.type)&&void 0!==a?a:""}`)}async function Ve(e,t,s){const r=async r=>{var a;return await s.findOwnAddress({db:e,tx:t,lockedTables:U()(A()(a=s.derivationTables).call(a)),hash:r})},a=async r=>{var a;const o=(await s.hashToIds({db:e,tx:t,lockedTables:U()(A()(a=s.derivationTables).call(a)),hashes:[r]})).get(r);if(void 0===o)throw new Error("certificateToDb should never happen id === undefined");return o},o=async e=>{{const t=we.RustModule.WasmScope((t=>{const r=t.WalletV4.Credential.from_bytes((0,Ee.hexToBytes)(e));return(0,Ee.bytesToHex)(t.WalletV4.RewardAddress.new(s.network,r).to_address().to_bytes())})),a=await r(t);if(null!=a)return a}{const t=we.RustModule.WasmScope((t=>{const r=t.WalletV4.Credential.from_bytes((0,Ee.hexToBytes)(e));return t.WalletV4.EnterpriseAddress.new(s.network,r).to_address().to_hex()})),a=await r(t);if(null!=a)return a}},n=[];for(let e=0;e<s.certificates.length;e++){const t=s.certificates[e];switch(t.kind){case Ie.U.StakeRegistration:{const[e,r]=we.RustModule.WasmScope((e=>{var r;const a=null===(r=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_bytes((0,Ee.hexToBytes)(t.rewardAddress))))||void 0===r?void 0:r.payment_cred();if(null==a)throw new Error("certificateToDb not a valid reward account");return[(0,Ee.bytesToHex)(e.WalletV4.RewardAddress.new(s.network,a).to_address().to_bytes()),(0,Ee.bytesToHex)(e.WalletV4.StakeRegistration.new(a).to_bytes())]})),o=await a(e);n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeRegistration,Payload:r,TransactionId:e},relatedAddresses:e=>[{CertificateId:e,AddressId:o,Relation:re.cS.SIGNER}]})));break}case Ie.U.StakeDeregistration:{const[e,r]=we.RustModule.WasmScope((e=>{var r;const a=null===(r=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_bytes((0,Ee.hexToBytes)(t.rewardAddress))))||void 0===r?void 0:r.payment_cred();if(null==a)throw new Error("certificateToDb not a valid reward account");return[(0,Ee.bytesToHex)(e.WalletV4.RewardAddress.new(s.network,a).to_address().to_bytes()),(0,Ee.bytesToHex)(e.WalletV4.StakeRegistration.new(a).to_bytes())]})),o=await a(e);n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeDeregistration,Payload:r,TransactionId:e},relatedAddresses:e=>[{CertificateId:e,AddressId:o,Relation:re.cS.SIGNER}]})));break}case Ie.U.StakeDelegation:{const e=[],[s,r,i]=we.RustModule.WasmScope((e=>{const s=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_bytes((0,Ee.hexToBytes)(t.rewardAddress)));if(null==s)throw new Error("certificateToDb not a valid reward account");const r=s.payment_cred(),a=e.WalletV4.Ed25519KeyHash.from_bytes((0,Ee.hexToBytes)(t.poolKeyHash));return[(0,Ee.bytesToHex)(s.to_address().to_bytes()),(0,Ee.bytesToHex)(e.WalletV4.StakeDelegation.new(r,a).to_bytes()),(0,Ee.bytesToHex)(e.WalletV4.Credential.from_keyhash(a).to_bytes())]}));{const t=await o(i);null!=t&&e.push({AddressId:t,Relation:re.cS.POOL_KEY})}{const t=await a(s);e.push({AddressId:t,Relation:re.cS.SIGNER})}n.push((s=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeDelegation,Payload:r,TransactionId:s},relatedAddresses:t=>H()(e).call(e,(e=>({...e,CertificateId:t})))})));break}case Ie.U.PoolRegistration:{const e=[],s=[],[r,i]=we.RustModule.WasmScope((e=>{const r=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_bytes((0,Ee.hexToBytes)(t.poolParams.rewardAccount)));if(null==r)throw new Error("certificateToDb registration address not a reward address");const a=e.WalletV4.Ed25519KeyHash.from_bytes((0,Ee.hexToBytes)(t.poolParams.operator)),o=e.WalletV4.Ed25519KeyHashes.new();for(let r=0;r<t.poolParams.poolOwners.length;r++){const a=t.poolParams.poolOwners[r],n=e.WalletV4.Ed25519KeyHash.from_hex(a);o.add(n);const i=(0,Ee.bytesToHex)(e.WalletV4.Credential.from_keyhash(n).to_bytes());s.push(i)}let n;if(null!=t.poolParams.poolMetadata){const s=t.poolParams.poolMetadata;n=e.WalletV4.PoolMetadata.new(e.WalletV4.URL.new(s.url),e.WalletV4.PoolMetadataHash.from_hex(s.metadataHash))}const i=e.WalletV4.PoolRegistration.new(e.WalletV4.PoolParams.new(a,e.WalletV4.VRFKeyHash.from_hex(t.poolParams.vrfKeyHash),e.WalletV4.BigNum.from_str(t.poolParams.pledge),e.WalletV4.BigNum.from_str(t.poolParams.cost),e.WalletV4.UnitInterval.new(e.WalletV4.BigNum.from_str("1"),e.WalletV4.BigNum.from_str("1")),r,o,e.WalletV4.Relays.new(),n));return[(0,Ee.bytesToHex)(e.WalletV4.Credential.from_keyhash(a).to_bytes()),(0,Ee.bytesToHex)(i.to_bytes())]}));for(const t of s){const s=await o(t);null!=s&&e.push({AddressId:s,Relation:re.cS.OWNER})}{const t=await o(r);null!=t&&e.push({AddressId:t,Relation:re.cS.OPERATOR})}{const s=await a(t.poolParams.rewardAccount);e.push({AddressId:s,Relation:re.cS.REWARD_ADDRESS})}n.push((s=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.PoolRegistration,Payload:i,TransactionId:s},relatedAddresses:t=>H()(e).call(e,(e=>({...e,CertificateId:t})))})));break}case Ie.U.PoolRetirement:{const e=[],[s,r]=we.RustModule.WasmScope((e=>{const s=e.WalletV4.Ed25519KeyHash.from_bytes((0,Ee.hexToBytes)(t.poolKeyHash));return[(0,Ee.bytesToHex)(e.WalletV4.Credential.from_keyhash(s).to_bytes()),(0,Ee.bytesToHex)(e.WalletV4.PoolRetirement.new(s,t.epoch).to_bytes())]}));{const t=await o(s);null!=t&&e.push({AddressId:t,Relation:re.cS.POOL_KEY})}n.push((s=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.PoolRetirement,Payload:r,TransactionId:s},relatedAddresses:t=>H()(e).call(e,(e=>({...e,CertificateId:t})))})));break}case Ie.U.GenesisKeyDelegation:{const e=we.RustModule.WasmScope((e=>(0,Ee.bytesToHex)(e.WalletV4.GenesisKeyDelegation.new(e.WalletV4.GenesisHash.from_bytes((0,Ee.hexToBytes)(t.genesishash)),e.WalletV4.GenesisDelegateHash.from_bytes((0,Ee.hexToBytes)(t.genesisDelegateHash)),e.WalletV4.VRFKeyHash.from_bytes((0,Ee.hexToBytes)(t.vrfKeyHash))).to_bytes())));n.push((s=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.GenesisKeyDelegation,Payload:e,TransactionId:s},relatedAddresses:e=>[]})));break}case Ie.U.MoveInstantaneousRewardsCert:{const e=[],s=we.RustModule.WasmScope((e=>{const s=e.WalletV4.MIRToStakeCredentials.new();for(const r of b()(t.rewards)){const a=e.WalletV4.RewardAddress.from_address(e.WalletV4.Address.from_bytes((0,Ee.hexToBytes)(r)));if(null==a)throw new Error("certificateToDb not a valid reward account");const o=a.payment_cred();if(null==o)throw new Error("certificateToDb not a valid reward account");s.insert(o,e.WalletV4.Int.new(e.WalletV4.BigNum.from_str(t.rewards[r])))}const r=e.WalletV4.MoveInstantaneousRewardsCert.new(e.WalletV4.MoveInstantaneousReward.new_to_stake_creds(t.pot,s));return(0,Ee.bytesToHex)(r.to_bytes())}));for(const s of b()(t.rewards)){const t=await r(s);null!=t&&e.push({AddressId:t,Relation:re.cS.REWARD_ADDRESS})}n.push((r=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.MoveInstantaneousRewardsCert,Payload:s,TransactionId:r},relatedAddresses:t=>H()(e).call(e,(e=>({...e,CertificateId:t})))})));break}case Ie.U.VoteDelegation:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.VoteDelegation,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.StakeVoteDelegation:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeAndVoteDelegation,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.StakeRegistrationDelegation:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeRegistrationAndDelegation,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.VoteRegistrationDelegation:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.VoteRegistrationAndDelegation,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.StakeVoteRegistrationDelegation:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.StakeVoteRegistrationAndDelegation,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.AuthCommitteeHot:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.CommitteeHotAuth,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.ResignCommitteeCold:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.CommitteeColdResign,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.RegisterDrep:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.DRepRegistration,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.UnregisterDrep:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.DRepDeregistration,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;case Ie.U.UpdateDrep:n.push((e=>({certificate:{Ordinal:t.certIndex,Kind:we.RustModule.WalletV4.CertificateKind.DRepUpdate,Payload:"",TransactionId:e},relatedAddresses:e=>[]})));break;default:throw new Error("certificateToDb unknown cert kind "+t.kind)}}return n}function He(e){var t,s,r,a,o;return[...H()(t=N()(s=e.utxoAddresses).call(s,(e=>e.Type===re.dq.CARDANO_LEGACY))).call(t,(e=>e.Hash)),...l()(r=N()(a=e.utxoAddresses).call(a,(e=>e.Type===re.dq.CARDANO_ENTERPRISE))).call(r,((e,t)=>we.RustModule.WasmScope((s=>{const r=s.WalletV4.Address.from_hex(t.Hash),a=s.WalletV4.EnterpriseAddress.from_address(r);if(null==a)return e;const o=a.payment_cred().to_keyhash();return null==o||e.push(o.to_bech32(ye.a.PAYMENT_KEY_HASH)),e}))),[]),...H()(o=e.accountingAddresses).call(o,(e=>e.Hash))]}},84174:(e,t,s)=>{"use strict";s.d(t,{networks:()=>S,isTestnet:()=>_,isCardanoHaskell:()=>v,getCardanoHaskellBaseConfig:()=>M,cardanoHaskellConfigCombine:()=>C,getCardanoHaskellBaseConfigCombined:()=>b,defaultAssets:()=>D,getNetworkById:()=>W});var r,a,o=s(94473),n=s.n(o),i=s(2991),l=s.n(i),d=s(80426),c=s.n(d),u=s(51942),h=s.n(u),p=s(32366),f=s.n(p),g=s(59340),A=s.n(g),I=(s(20116),s(86902)),T=s.n(I),w=s(56474),y=s.n(w),x=s(66905),E=s(85412),m=s(38079);const k=y()({Haskell:0}),S=y()({CardanoMainnet:{NetworkId:0,NetworkName:"Cardano Mainnet",NetworkFeatureName:"mainnet",Backend:{BackendService:E.Z.isTest()?"http://localhost:21000":"https://api.yoroiwallet.com",TokenInfoService:"https://cdn.yoroiwallet.com",BackendServiceZero:"https://zero.yoroiwallet.com"},BaseConfig:[y()({StartAt:0,ChainNetworkId:"1",ByronNetworkId:764824073,GenesisDate:"1506203091000",SlotsPerEpoch:21600,SlotDuration:20}),y()({StartAt:208,SlotsPerEpoch:432e3,SlotDuration:1,PerEpochPercentageReward:69344,LinearFee:{coefficient:"44",constant:"155381"},MinimumUtxoVal:"1000000",CoinsPerUtxoWord:"34482",PoolDeposit:"500000000",KeyDeposit:"2000000"}),y()({CoinsPerUtxoByte:"4310"})],CoinType:x.M8.CARDANO,Fork:k.Haskell,isInProduction:!0},CardanoPreprodTestnet:{NetworkId:250,NetworkName:"Cardano Preprod Testnet",NetworkFeatureName:"preprod",Backend:{BackendService:E.Z.isTest()?"http://localhost:21000":"https://preprod-backend.yoroiwallet.com",TokenInfoService:"https://stage-cdn.yoroiwallet.com",BackendServiceZero:"https://yoroi-backend-zero-preprod.emurgornd.com"},BaseConfig:[y()({StartAt:0,ChainNetworkId:"0",ByronNetworkId:1,GenesisDate:"1654041600000",SlotsPerEpoch:21600,SlotDuration:20}),y()({StartAt:0,SlotsPerEpoch:432e3,SlotDuration:1,PerEpochPercentageReward:69344,LinearFee:{coefficient:"44",constant:"155381"},CoinsPerUtxoWord:"34482",MinimumUtxoVal:"1000000",PoolDeposit:"500000000",KeyDeposit:"2000000"}),y()({CoinsPerUtxoByte:"4310"})],CoinType:x.M8.CARDANO,Fork:k.Haskell},CardanoPreviewTestnet:{NetworkId:350,NetworkName:"Cardano Preview Testnet",NetworkFeatureName:"preview",Backend:{BackendService:E.Z.isTest()?"http://localhost:21000":"https://preview-backend.emurgornd.com",TokenInfoService:"https://stage-cdn.yoroiwallet.com",BackendServiceZero:"https://yoroi-backend-zero-preview.emurgornd.com"},BaseConfig:[y()({StartAt:0,ChainNetworkId:"0",ByronNetworkId:2,GenesisDate:"1666656000000",SlotsPerEpoch:21600,SlotDuration:20}),y()({StartAt:0,SlotsPerEpoch:86400,SlotDuration:1,PerEpochPercentageReward:69344,LinearFee:{coefficient:"44",constant:"155381"},CoinsPerUtxoWord:"34482",MinimumUtxoVal:"1000000",PoolDeposit:"500000000",KeyDeposit:"2000000"}),y()({CoinsPerUtxoByte:"4310"})],CoinType:x.M8.CARDANO,Fork:k.Haskell},CardanoSanchoTestnet:{NetworkId:450,NetworkName:"Cardano Sancho Testnet",NetworkFeatureName:"sanchonet",Backend:{BackendService:E.Z.isTest()?"http://localhost:21000":"https://sanchonet-backend.yoroiwallet.com",TokenInfoService:"https://stage-cdn.yoroiwallet.com",BackendServiceZero:"https://yoroi-backend-zero-sanchonet.emurgornd.com"},BaseConfig:[y()({StartAt:0,ChainNetworkId:"0",ByronNetworkId:4,GenesisDate:"1686789000000",SlotsPerEpoch:4320,SlotDuration:20}),y()({StartAt:0,SlotsPerEpoch:86400,SlotDuration:1,PerEpochPercentageReward:69344,LinearFee:{coefficient:"44",constant:"155381"},CoinsPerUtxoWord:"34482",MinimumUtxoVal:"1000000",PoolDeposit:"500000000",KeyDeposit:"2000000"}),y()({CoinsPerUtxoByte:"4310"})],CoinType:x.M8.CARDANO,Fork:k.Haskell}});function _(e){return e.NetworkId!==S.CardanoMainnet.NetworkId}function v(e){return e.CoinType===x.M8.CARDANO&&e.Fork===k.Haskell}function M(e){if(!v(e))throw new Error(`Incorrect network type ${A()(e)}`);return e.BaseConfig}function C(e){return f()(e).call(e,((e,t)=>h()(e,t)),{})}function b(e){return C(M(e))}const D=c()(r=l()(a=T()(S)).call(a,(e=>S[e]))).call(r,(e=>{if(v(e))return[{NetworkId:e.NetworkId,Identifier:m.hd.Cardano,IsDefault:!0,IsNFT:!1,Metadata:{type:"Cardano",policyId:m.hd.Cardano,assetName:m.hd.Cardano,ticker:e===S.CardanoPreprodTestnet||e===S.CardanoPreviewTestnet||e===S.CardanoSanchoTestnet?"TADA":"ADA",logo:null,longName:null,numberOfDecimals:6}}];throw new Error(`Missing default asset for network type ${A()(e)}`)}));function W(e){var t;const s=n()(t=T()(S)).call(t,(t=>S[t].NetworkId===e));if(!s)throw new Error("network not found by id: "+e);return S[s]}},27649:(e,t,s)=>{"use strict";s.d(t,{PF:()=>y,$Z:()=>x,Dw:()=>E,Bi:()=>m,lG:()=>k,Nf:()=>S,ue:()=>v,RY:()=>M,b9:()=>C}),s(86902);var r=s(32366),a=s.n(r),o=s(20116),n=s.n(o),i=s(2991),l=s.n(i),d=s(80426),c=s.n(d),u=(s(96486),s(905)),h=s(9243),p=s(28336),f=s(55343),g=s(86335),A=s(38079),I=s(90649);const T="addr_test1qzz6hulv54gzf2suy2u5gkvmt6ysasfdlvvegy3fmf969y7r3y3kdut55a40jff00qmg74686vz44v6k363md06qkq0qy0adz0";function w(e,t){return`${e.to_hex()}.${(0,I.bytesToHex)(t.name())}`}function y(e){const t=e.split(".");return{policyId:g.RustModule.WalletV4.ScriptHash.from_hex(t[0]),name:g.RustModule.WalletV4.AssetName.new((0,I.hexToBytes)(t[1]))}}function x(e,t){const s=new f.a([],t);s.add({amount:new u.Z(e.coin().to_str()),identifier:t.defaultIdentifier,networkId:t.defaultNetworkId});for(const o of(r=e.multiasset(),void 0,c()(a=(0,I.iterateLenGetMap)(r)).call(a,(([e,t])=>{var s;return l()(s=(0,I.iterateLenGetMap)(t).nonNullValue()).call(s,(([t,s])=>({amount:s.to_str(),assetId:w(e,t),policyId:e.to_hex(),name:(0,I.bytesToHex)(t.name())})))})).toArray()))s.add({amount:new u.Z(o.amount),identifier:o.assetId,networkId:t.defaultNetworkId});var r,a;return s}function E(e){const t=g.RustModule.WalletV4.Value.new(g.RustModule.WalletV4.BigNum.from_str(e.amount));if(0===e.assets.length)return t;const s=g.RustModule.WalletV4.MultiAsset.new();for(const t of e.assets){var r;const{policyId:e,name:a}=y(t.assetId),o=null!==(r=s.get(e))&&void 0!==r?r:g.RustModule.WalletV4.Assets.new();o.insert(a,g.RustModule.WalletV4.BigNum.from_str(t.amount.toString())),s.insert(e,o)}return s.len()>0&&t.set_multiasset(s),t}function m(e,t){return function(e,t,s){const r=new f.a([],{defaultNetworkId:s,defaultIdentifier:A.hd.Cardano});r.add({identifier:A.hd.Cardano,amount:new u.Z(e),networkId:s});for(const e of t)r.add({identifier:e.assetId,amount:new u.Z(e.amount),networkId:s});return r}(e.amount,e.assets,t)}function k(e){var t,s,r,a;const o=[...e.utxoInputs,...null!==(t=e.accountingInputs)&&void 0!==t?t:[]],i=[...e.utxoOutputs,...null!==(s=e.accountingOutputs)&&void 0!==s?s:[]],l=n()(o).call(o,(t=>e.allOwnedAddressIds.has(t.AddressId))),d=n()(i).call(i,(t=>e.allOwnedAddressIds.has(t.AddressId))),c=_(o,e.tokens,e.defaultToken),u=_(i,e.tokens,e.defaultToken),p=_(l,e.tokens,e.defaultToken).joinAddCopy(null!==(r=e.ownImplicitInput)&&void 0!==r?r:new f.a([],e.defaultToken)),g=_(d,e.tokens,e.defaultToken).joinAddCopy(null!==(a=e.ownImplicitOutput)&&void 0!==a?a:new f.a([],e.defaultToken)),A=l.length===o.length,I=d.length===i.length,T=A&&I,w=l.length>0&&l.length!==o.length,y=g.joinSubtractCopy(p),x=u.joinSubtractCopy(c);return T?{type:h.s.SELF,amount:new f.a([],e.defaultToken),fee:x}:w?{type:h.s.MULTI,amount:y,fee:new f.a([],e.defaultToken)}:A?{type:h.s.EXPEND,amount:y.joinSubtractCopy(x),fee:x}:{type:h.s.INCOME,amount:y,fee:new f.a([],e.defaultToken)}}function S(e,t){const s=[];for(const i of e){var r,a,o,n;null!=i.block&&s.push({date:i.block.BlockTime,type:i.type===h.s.INCOME?"in":"out",amount:(0,p.formatBigNumberToFloatString)(null!==(r=null===(a=i.amount.get(t.Identifier))||void 0===a?void 0:a.abs().shiftedBy(-t.Metadata.numberOfDecimals))&&void 0!==r?r:new u.Z(0)),fee:(0,p.formatBigNumberToFloatString)(null!==(o=null===(n=i.fee.get(t.Identifier))||void 0===n?void 0:n.abs().shiftedBy(-t.Metadata.numberOfDecimals))&&void 0!==o?o:new u.Z(0)),id:i.transaction.Hash})}return s}function _(e,t,s){const r=a()(e).call(e,((e,s)=>{for(const r of n()(t).call(t,(e=>e.TokenList.ListId===s.TokenListId)))e.push(r);return e}),[]);return new f.a(l()(r).call(r,(e=>({identifier:e.Token.Identifier,amount:new u.Z(e.TokenList.Amount),networkId:e.Token.NetworkId}))),s)}function v(e){return l()(e).call(e,(e=>{var t,s;const r=a()(t=e.output.tokens).call(t,((e,t)=>(t.Token.Identifier===A.hd.Cardano?e.amount=e.amount.plus(t.TokenList.Amount):e.tokens.push({amount:t.TokenList.Amount,tokenId:t.Token.Identifier}),e)),{amount:new u.Z(0),tokens:[]}),o=l()(s=r.tokens).call(s,(e=>{const t=y(e.tokenId);return{amount:e.amount,assetId:e.tokenId,policyId:t.policyId.to_hex(),name:(0,I.bytesToHex)(t.name.name())}}));return{amount:r.amount.toString(),receiver:e.address,tx_hash:e.output.Transaction.Hash,tx_index:e.output.UtxoTransactionOutput.OutputIndex,utxo_id:e.output.Transaction.Hash+e.output.UtxoTransactionOutput.OutputIndex,addressing:e.addressing,assets:o}}))}function M(e,t){return g.RustModule.WasmScope((s=>{const r=s.WalletV4.TransactionOutput.new(s.WalletV4.Address.from_bech32(T),function(e,t=g.RustModule){const s=t.WalletV4.Value.new(t.WalletV4.BigNum.from_str(e.getDefaultEntry().amount.toString()));if(1===e.size())return s;const r=t.WalletV4.MultiAsset.new();for(const s of e.nonDefaultEntries()){var a;const{policyId:e,name:o}=y(s.identifier),n=null!==(a=r.get(e))&&void 0!==a?a:t.WalletV4.Assets.new();n.insert(o,t.WalletV4.BigNum.from_str(s.amount.toString())),r.insert(e,n)}return r.len()>0&&s.set_multiasset(r),s}(e,s));return function(e,t,s){const r=s.WalletV4.BigNum.from_str(t.toString()),a=s.WalletV4.DataCost.new_coins_per_byte(r),o=s.WalletV4.min_ada_for_output(e,a).to_str();return new u.Z(o)}(r,t,s)}))}function C(e,t){return g.RustModule.WasmScope((s=>{const r=s.WalletV4.TransactionWitnessSet.from_hex(e),a=s.WalletV4.TransactionWitnessSet.from_hex(t),o=s.WalletV4.TransactionWitnessSet.new();let n=r.vkeys();const i=a.vkeys();if(n&&i)for(const e of(0,I.iterateLenGet)(i))n.add(e);else i&&(n=i);n&&o.set_vkeys(n);let l=r.native_scripts();const d=a.native_scripts();if(l&&d)for(const e of(0,I.iterateLenGet)(d))l.add(e);else d&&(l=d);l&&o.set_native_scripts(l);let c=r.bootstraps();const u=a.bootstraps();if(c&&u)for(const e of(0,I.iterateLenGet)(u))c.add(e);else u&&(c=u);c&&o.set_bootstraps(c);let h=r.plutus_scripts();const p=a.plutus_scripts();if(h&&p)for(const e of(0,I.iterateLenGet)(p))h.add(e);else p&&(h=p);h&&o.set_plutus_scripts(h);let f=r.plutus_data();const g=a.plutus_data();if(f&&g)for(const e of(0,I.iterateLenGet)(g))f.add(e);else g&&(f=g);f&&o.set_plutus_data(f);let A=r.redeemers();const T=a.redeemers();if(A&&T)for(const e of(0,I.iterateLenGet)(T))A.add(e);else T&&(A=T);return A&&o.set_redeemers(A),o.to_hex()}))}},21131:(e,t,s)=>{"use strict";s.d(t,{AW:()=>n,Px:()=>i,js:()=>l,rp:()=>d,dJ:()=>c,JI:()=>u,ke:()=>h,r7:()=>p,JZ:()=>f,gC:()=>g,x:()=>A,oy:()=>I,hH:()=>T,fc:()=>w,oc:()=>y,PQ:()=>x,E8:()=>E,zJ:()=>m,k:()=>k,qH:()=>S,HH:()=>_,AH:()=>v,nW:()=>M,Dy:()=>C,XX:()=>b,kl:()=>D,Jq:()=>W,o_:()=>O});var r=s(99095),a=s(63139);const o=(0,r.defineMessages)({serverStatusError:{id:"api.errors.serverStatusError",defaultMessage:'!!!Server connection failed. Please check your internet connection or reach out to our support team <a target="_blank" href="https://emurgohelpdesk.zendesk.com/hc/en-us/requests/new?ticket_form_id=360013330335">here</a>.'},currentCoinPriceError:{id:"api.errors.currentCoinPriceError",defaultMessage:"!!!There is no current coin price data available."},historicalCoinPriceError:{id:"api.errors.histoicalCoinPriceError",defaultMessage:"!!!There is no historical coin price data available."},genericApiError:{id:"api.errors.GenericApiError",defaultMessage:"!!!An error occurred. Please retry."},incorrectWalletPasswordError:{id:"api.errors.IncorrectPasswordError",defaultMessage:"!!!Incorrect password. Please retype."},walletAlreadyRestoredError:{id:"api.errors.WalletAlreadyRestoredError",defaultMessage:"!!!The wallet you are trying to restore already exists."},reportRequestError:{id:"api.errors.ReportRequestError",defaultMessage:"!!!There was a problem sending the support request."},unusedAddressesError:{id:"api.errors.unusedAddressesError",defaultMessage:"!!!You cannot generate more than 20 consecutive unused addresses."},walletAlreadyImportedError:{id:"api.errors.WalletAlreadyImportedError",defaultMessage:"!!!Wallet you are trying to import already exists."},notEnoughMoneyToSendError:{id:"api.errors.NotEnoughMoneyToSendError",defaultMessage:"!!!Insufficient funds to complete this transaction."},cannotSendBelowMinimumValueError:{id:"api.errors.CannotSendBelowMinimumValueError",defaultMessage:"!!!A minimum of 1 ADA is required"},assetOverflowError:{id:"api.errors.assetOverflowError",defaultMessage:"!!!Maximum value of a token inside a UTXO exceeded (overflow)."},getAddressesKeysError:{id:"api.errors.getAddressesWithFundsError",defaultMessage:"!!!An error occurred while getting addresses with funds. Please retry."},noInputsError:{id:"api.errors.noInputsError",defaultMessage:"!!!Your recovered wallet is empty. Please check your recovery phrase and restore again."},rewardAddressEmptyError:{id:"api.errors.rewardAddressEmpty",defaultMessage:"!!!Reward address is not visible until users get any reward."},noOutputsError:{id:"api.errors.noOutputsError",defaultMessage:"!!!The transaction requires at least 1 output, but none was provided."},generateTransferTxError:{id:"api.errors.generateTransferTxError",defaultMessage:"!!!An error occurred while generating the transfer transaction. Please retry."},sendTransactionError:{id:"api.errors.sendTransactionError",defaultMessage:"!!!Error received from api method call while sending tx."},getAllUTXOsForAddressesError:{id:"api.errors.getAllUTXOsForAddressesError",defaultMessage:"!!!Error received from api method call while getting utxos."},discoverAddressesError:{id:"api.errors.discoverAddressesError",defaultMessage:"!!!Error received from api method call while discovering addresses."},getUtxosForAddressesApiError:{id:"api.errors.getUtxosForAddressesApiError",defaultMessage:"!!!Error received from server while getting UTXOs."},getTxHistoryForAddressesApiError:{id:"api.errors.getTxHistoryForAddressesApiError",defaultMessage:"!!!Error received from server while getting txs."},getRewardHistoryApiError:{id:"api.errors.getRewardHistoryApiError",defaultMessage:"!!!Error received from server while getting reward history."},rollbackApiError:{id:"api.errors.rollbackApiError",defaultMessage:"!!!Rollback was detected."},getBestBlockApiError:{id:"api.errors.getBestBlockApiError",defaultMessage:"!!!Error received from server while getting best block."},sendTransactionApiError:{id:"api.errors.sendTransactionApiError",defaultMessage:"!!!Error received from server while sending tx."},checkAdressesInUseApiError:{id:"api.errors.checkAdressesInUseApiError",defaultMessage:"!!!Error received from server while checking used addresses."},getMultiAssetMintMetadataApiError:{id:"api.errors.getMultiAssetMintMetadataApiError",defaultMessage:"!!!Error received from server while querying minting metadata."},assetInfoApiError:{id:"api.errors.assetInfoApiError",defaultMessage:"!!!Error received from server while getting asset info."},getAccountStateApiError:{id:"api.errors.getAccountStateApiError",defaultMessage:"!!!Error received from server while getting account state."},getPoolInfoApiError:{id:"api.errors.getPoolInfoApiError",defaultMessage:"!!!Error received from server while getting pool info."},getCatalystRoundApiError:{id:"api.errors.getCatalystRoundApiError",defaultMessage:"!!!Error received from server while getting catalyst round info."},getTokenInfoApiError:{id:"api.errors.getTokenInfoApiError",defaultMessage:"!!!Error received from server while getting token info."},poolMissingApiError:{id:"api.errors.poolMissingApiError",defaultMessage:"!!!Pool could not be found. Please check the pool ID and ensure the pool was not deregistered."},invalidWitnessError:{id:"api.errors.invalidWitnessError",defaultMessage:"!!!The signature is invalid."},invalidMnemonicError:{id:"api.errors.invalidMnemonicError",defaultMessage:"!!!Invalid phrase entered, please check."},hardwareUnsupportedError:{id:"api.errors.hardwareUnsupportedError",defaultMessage:"!!!This action is incompatible with the hardware."},getUtxoDataError:{id:"api.errors.getUtxoDataError",defaultMessage:"!!!Error received from server while getting UTXO data"},oversizedTransactionError:{id:"api.errors.oversizedTransaction",defaultMessage:"!!!Maximum transaction size exceeded."}});class n extends a.default{constructor(){super({id:o.serverStatusError.id,defaultMessage:o.serverStatusError.defaultMessage||""})}}class i extends a.default{constructor(){super({id:o.currentCoinPriceError.id,defaultMessage:o.currentCoinPriceError.defaultMessage||""})}}class l extends a.default{constructor(){super({id:o.historicalCoinPriceError.id,defaultMessage:o.historicalCoinPriceError.defaultMessage||""})}}class d extends a.default{constructor(){super({id:o.genericApiError.id,defaultMessage:o.genericApiError.defaultMessage||""})}}class c extends a.default{static get errorId(){return o.incorrectWalletPasswordError.id}constructor(){super({id:c.errorId,defaultMessage:o.incorrectWalletPasswordError.defaultMessage||""})}}class u extends a.default{constructor(){super({id:o.walletAlreadyRestoredError.id,defaultMessage:o.walletAlreadyRestoredError.defaultMessage||""})}}class h extends a.default{constructor(){super({id:o.unusedAddressesError.id,defaultMessage:o.unusedAddressesError.defaultMessage||""})}}class p extends a.default{constructor(){super({id:o.notEnoughMoneyToSendError.id,defaultMessage:o.notEnoughMoneyToSendError.defaultMessage||""})}}class f extends a.default{constructor(){super({id:o.cannotSendBelowMinimumValueError.id,defaultMessage:o.cannotSendBelowMinimumValueError.defaultMessage||""})}}class g extends a.default{constructor(){super({id:o.assetOverflowError.id,defaultMessage:o.assetOverflowError.defaultMessage||""})}}class A extends a.default{constructor(){super({id:o.noInputsError.id,defaultMessage:o.noInputsError.defaultMessage||""})}}class I extends a.default{constructor(){super({id:o.rewardAddressEmptyError.id,defaultMessage:o.rewardAddressEmptyError.defaultMessage||""})}}class T extends a.default{constructor(){super({id:o.noOutputsError.id,defaultMessage:o.noOutputsError.defaultMessage||""})}}class w extends a.default{constructor(){super({id:o.getAllUTXOsForAddressesError.id,defaultMessage:o.getAllUTXOsForAddressesError.defaultMessage||""})}}class y extends a.default{constructor(){super({id:o.getUtxosForAddressesApiError.id,defaultMessage:o.getUtxosForAddressesApiError.defaultMessage||""})}}class x extends a.default{constructor(){super({id:o.getTxHistoryForAddressesApiError.id,defaultMessage:o.getTxHistoryForAddressesApiError.defaultMessage||""})}}class E extends a.default{constructor(){super({id:o.getRewardHistoryApiError.id,defaultMessage:o.getRewardHistoryApiError.defaultMessage||""})}}class m extends a.default{constructor(){super({id:o.rollbackApiError.id,defaultMessage:o.rollbackApiError.defaultMessage||""})}}class k extends a.default{constructor(){super({id:o.getBestBlockApiError.id,defaultMessage:o.getBestBlockApiError.defaultMessage||""})}}class S extends a.default{constructor(){super({id:o.sendTransactionApiError.id,defaultMessage:o.sendTransactionApiError.defaultMessage||""})}}class _ extends a.default{constructor(){super({id:o.checkAdressesInUseApiError.id,defaultMessage:o.checkAdressesInUseApiError.defaultMessage||""})}}class v extends a.default{constructor(){super({id:o.getAccountStateApiError.id,defaultMessage:o.getAccountStateApiError.defaultMessage||""})}}class M extends a.default{constructor(){super({id:o.getPoolInfoApiError.id,defaultMessage:o.getPoolInfoApiError.defaultMessage||""})}}class C extends a.default{constructor(){super({id:o.getCatalystRoundApiError.id,defaultMessage:o.getCatalystRoundApiError.defaultMessage||""})}}class b extends a.default{constructor(){super({id:o.getTokenInfoApiError.id,defaultMessage:o.getTokenInfoApiError.defaultMessage||""})}}class D extends a.default{constructor(){super({id:o.invalidWitnessError.id,defaultMessage:o.invalidWitnessError.defaultMessage||""})}}class W extends a.default{constructor(){super({id:o.getUtxoDataError.id,defaultMessage:o.getUtxoDataError.defaultMessage||""})}}class O extends a.default{constructor(){super({id:o.oversizedTransactionError.id,defaultMessage:o.oversizedTransactionError.defaultMessage})}}},79562:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>R,dF:()=>P,_W:()=>B,Wd:()=>L});var r,a,o=s(56474),n=s.n(o),i=s(98926),l=s.n(i),d=s(31238),c=s.n(d),u=s(41511),h=s.n(u),p=s(86902),f=s.n(p),g=s(2991),A=s.n(g),I=s(20455),T=s.n(I),w=s(36384),y=s.n(w),x=s(93476),E=s.n(x),m=s(59340),k=s.n(m),S=s(87672),_=s.n(S),v=s(85412),M=s(6697),C=s(74119),b=s(61346),D=s(36231),W=s(90649);const O=String(v.Z.getNetworkName()),N={USER_LOCALE:O+"-USER-LOCALE",URI_SCHEME_ACCEPTANCE:O+"-URI-SCHEME-ACCEPTANCE",COMPLEXITY_LEVEL:O+"-COMPLEXITY-LEVEL",IS_USER_MIGRATED_TO_REVAMP:"IS_USER_MIGRATED_TO_REVAMP",IS_REVAMP_THEME_ANNOUNCED:"IS_REVAMP_THEME_ANNOUNCED",VERSION:O+"-LAST-LAUNCH-VER",HIDE_BALANCE:O+"-HIDE-BALANCE",UNIT_OF_ACCOUNT:O+"-UNIT-OF-ACCOUNT",COIN_PRICE_PUB_KEY_DATA:O+"-COIN-PRICE-PUB-KEY-DATA",EXTERNAL_STORAGE:O+"-EXTERNAL-STORAGE",TOGGLE_SIDEBAR:O+"-TOGGLE-SIDEBAR",WALLETS_NAVIGATION:O+"-WALLETS-NAVIGATION",SUBMITTED_TRANSACTIONS:"submittedTransactions",CATALYST_ROUND_INFO:O+"-CATALYST_ROUND_INFO",FLAGS:O+"-FLAGS",USER_THEME:O+"-USER-THEME",DAPP_CONNECTOR_WHITELIST:"connector_whitelist",SELECTED_WALLET:"SELECTED_WALLET",IS_ANALYTICS_ALLOWED:O+"-IS_ANALYTICS_ALLOWED",ACCEPTED_TOS_VERSION:O+"-ACCEPTED_TOS_VERSION",CUSTOM_THEME:O+"-CUSTOM-THEME",THEME:O+"-THEME"};class R{constructor(){_()(this,"getUserLocale",(()=>(0,C.Jt)(N.USER_LOCALE))),_()(this,"setUserLocale",(e=>(0,C.mM)(N.USER_LOCALE,e))),_()(this,"unsetUserLocale",(()=>(0,C.Hx)(N.USER_LOCALE))),_()(this,"getUriSchemeAcceptance",(()=>(0,C.Jt)(N.URI_SCHEME_ACCEPTANCE).then((e=>"true"===e&&JSON.parse(e))))),_()(this,"setUriSchemeAcceptance",(()=>(0,C.mM)(N.URI_SCHEME_ACCEPTANCE,k()(!0)))),_()(this,"unsetUriSchemeAcceptance",(()=>(0,C.Hx)(N.URI_SCHEME_ACCEPTANCE))),_()(this,"getComplexityLevel",(()=>(0,C.Jt)(N.COMPLEXITY_LEVEL).then((e=>null==e?null:JSON.parse(e))))),_()(this,"setComplexityLevel",(e=>(0,C.mM)(N.COMPLEXITY_LEVEL,k()(e)))),_()(this,"unsetComplexityLevel",(()=>(0,C.Hx)(N.COMPLEXITY_LEVEL))),_()(this,"getUserThemeMode",(()=>(0,C.Jt)(N.USER_THEME))),_()(this,"setUserThemeMode",(e=>(0,C.mM)(N.USER_THEME,e))),_()(this,"getUserRevampMigrationStatus",(async()=>"true"===await(0,C.Jt)(N.IS_USER_MIGRATED_TO_REVAMP))),_()(this,"setUserRevampMigrationStatus",(e=>(0,C.mM)(N.IS_USER_MIGRATED_TO_REVAMP,e.toString()))),_()(this,"getUserRevampAnnouncementStatus",(async()=>"true"===await(0,C.Jt)(N.IS_REVAMP_THEME_ANNOUNCED))),_()(this,"setUserRevampAnnouncementStatus",(e=>(0,C.mM)(N.IS_REVAMP_THEME_ANNOUNCED,e.toString()))),_()(this,"getSelectedWalletId",(async()=>{let e=await(0,C.Jt)(N.SELECTED_WALLET);var t;if(e||(e=null===(t=window)||void 0===t?void 0:t.localStorage.getItem(N.SELECTED_WALLET),/^\d+$/.test(e)&&await this.setSelectedWalletId(Number(e))),!e)return null;if(isNaN(Number(e)))throw new Error(`Invalid wallet Id: ${e}`);return Number(e)})),_()(this,"setSelectedWalletId",(async e=>{await(0,C.mM)(N.SELECTED_WALLET,e.toString())})),_()(this,"hasAnyLegacyThemeFlags",(async()=>{const[e,t]=await E().all([(0,C.Jt)(N.THEME),(0,C.Jt)(N.CUSTOM_THEME)]);return null!=e||null!=t})),_()(this,"unsetLegacyThemeFlags",(async()=>{await E().all([(0,C.Hx)(N.THEME),(0,C.Hx)(N.CUSTOM_THEME)])})),_()(this,"getLastLaunchVersion",(()=>(0,C.Jt)(N.VERSION).then((e=>null==e?"0.0.0":e)))),_()(this,"setLastLaunchVersion",(e=>(0,C.mM)(N.VERSION,e))),_()(this,"unsetLastLaunchVersion",(()=>(0,C.Hx)(N.VERSION))),_()(this,"isEmpty",(()=>(0,C.cJ)())),_()(this,"clear",(async()=>{var e;const t=JSON.parse(await this.getStorage()),s=new(y())(T()(b.sz));await E().all(A()(e=f()(t)).call(e,(async e=>{s.has(e)||await(0,C.Hx)(e)})))})),_()(this,"getHideBalance",(()=>(0,C.Jt)(N.HIDE_BALANCE).then((e=>"true"===e&&JSON.parse(e))))),_()(this,"setHideBalance",(e=>(0,C.mM)(N.HIDE_BALANCE,k()(!e)))),_()(this,"unsetHideBalance",(()=>(0,C.Hx)(N.HIDE_BALANCE))),_()(this,"getToggleSidebar",(()=>(0,C.Jt)(N.TOGGLE_SIDEBAR).then((e=>"true"===e&&JSON.parse(e))))),_()(this,"setToggleSidebar",(e=>(0,C.mM)(N.TOGGLE_SIDEBAR,k()(!e)))),_()(this,"unsetToggleSidebar",(()=>(0,C.Hx)(N.TOGGLE_SIDEBAR))),_()(this,"getExternalStorage",(()=>(0,C.Jt)(N.EXTERNAL_STORAGE).then((e=>null==e?null:JSON.parse(e))))),_()(this,"setExternalStorage",(e=>(0,C.mM)(N.EXTERNAL_STORAGE,k()(e)))),_()(this,"unsetExternalStorage",(()=>(0,C.Hx)(N.EXTERNAL_STORAGE))),_()(this,"getWhitelist",(async()=>{const e=await(0,C.Jt)(N.DAPP_CONNECTOR_WHITELIST);if(null==e)return;const t=JSON.parse(e);return await this.setWhitelist(t),t})),_()(this,"setWhitelist",(e=>(0,C.mM)(N.DAPP_CONNECTOR_WHITELIST,k()(null!=e?e:[])))),_()(this,"getUnitOfAccount",(async()=>{const e=await(0,C.Jt)(N.UNIT_OF_ACCOUNT);return null==e?M.j:JSON.parse(e)})),_()(this,"setUnitOfAccount",(async e=>{await(0,C.mM)(N.UNIT_OF_ACCOUNT,k()(e))})),_()(this,"unsetUnitOfAccount",(async()=>{await(0,C.Hx)(N.UNIT_OF_ACCOUNT)})),_()(this,"getCoinPricePubKeyData",(async()=>await(0,C.Jt)(N.COIN_PRICE_PUB_KEY_DATA))),_()(this,"setCoinPricePubKeyData",(async e=>{await(0,C.mM)(N.COIN_PRICE_PUB_KEY_DATA,e)})),_()(this,"unsetCoinPricePubKeyData",(async()=>{try{await(0,C.Hx)(N.COIN_PRICE_PUB_KEY_DATA)}catch(e){}})),_()(this,"getFlag",(e=>"true"===localStorage.getItem(`${N.FLAGS}/${e}`))),_()(this,"setFlag",((e,t)=>{localStorage.setItem(`${N.FLAGS}/${e}`,String(t))})),_()(this,"getWalletsNavigation",(async()=>{let e=await(0,C.Jt)(N.WALLETS_NAVIGATION);if(null!=e)return e=JSON.parse(e),h()(e)?{cardano:[]}:e})),_()(this,"setWalletsNavigation",(e=>(0,C.mM)(N.WALLETS_NAVIGATION,k()(e)))),_()(this,"loadAcceptedTosVersion",(async()=>{const e=await(0,C.Jt)(N.ACCEPTED_TOS_VERSION);if(!e)return;const t=c()(e);return l()(t)?void 0:t})),_()(this,"saveAcceptedTosVersion",(async e=>{await(0,C.mM)(N.ACCEPTED_TOS_VERSION,String(e))})),_()(this,"unsetAcceptedTosVersion",(()=>(0,C.Hx)(N.ACCEPTED_TOS_VERSION))),_()(this,"_getIsAnalyticsAllowedKey",(()=>{let e=N.IS_ANALYTICS_ALLOWED;return v.Z.isFirefox()&&(e+="-firefox"),e})),_()(this,"loadIsAnalyticsAllowed",(async()=>{const e=await(0,C.Jt)(this._getIsAnalyticsAllowedKey());if(e)return JSON.parse(e)})),_()(this,"saveIsAnalysticsAllowed",(async e=>{await(0,C.mM)(this._getIsAnalyticsAllowedKey(),k()(e))})),_()(this,"unsetIsAnalyticsAllowed",(()=>(0,C.Hx)(N.IS_ANALYTICS_ALLOWED))),_()(this,"getItem",(e=>(0,C.Jt)(e))),_()(this,"setItem",((e,t)=>(0,C.mM)(e,t))),_()(this,"getOldStorage",(()=>new(E())((e=>{e(localStorage)})))),_()(this,"setStorage",(async e=>{var t;const s=new(y())(T()(b.sz));await E().all(A()(t=f()(e)).call(t,(async t=>{s.has(t)||await(0,C.mM)(t,e[t])})))})),_()(this,"getStorage",(()=>(0,C.Jt)(void 0).then((e=>null==e?"{}":e))))}async reset(){await this.unsetUserLocale(),await this.unsetComplexityLevel(),await this.unsetLastLaunchVersion(),await this.unsetHideBalance(),await this.unsetUnitOfAccount(),await this.unsetCoinPricePubKeyData(),await this.unsetExternalStorage(),await this.unsetToggleSidebar(),await this.unsetAcceptedTosVersion(),await this.unsetIsAnalyticsAllowed()}}const G=(null===(r=window.browser)||void 0===r?void 0:r.storage.local)||(null===(a=window.chrome)||void 0===a?void 0:a.storage.local);async function P(e){await G.set({[N.SUBMITTED_TRANSACTIONS]:k()(e)})}async function B(){var e;const t=await new(E())((e=>G.get(N.SUBMITTED_TRANSACTIONS,e)));return null==t||null==t[N.SUBMITTED_TRANSACTIONS]?[]:A()(e=JSON.parse(t[N.SUBMITTED_TRANSACTIONS])).call(e,(({networkId:e,publicDeriverId:t,transaction:s,usedUtxos:r,isDrepDelegation:a})=>({networkId:e,publicDeriverId:t,transaction:(0,D.T)(s),usedUtxos:r,isDrepDelegation:a})))}function L(e,t,s,r){return n()({get:async()=>{var t;return null!==(t=(0,W.maybe)(await(0,C.Jt)(e),s))&&void 0!==t?t:r},set:s=>(0,C.mM)(e,t(s)),remove:()=>(0,C.Hx)(e),defaultValue:()=>r})}},66905:(e,t,s)=>{"use strict";s.d(t,{yK:()=>n,r7:()=>i,M8:()=>l,C4:()=>d,OC:()=>c,Iz:()=>u,x_:()=>h,Q:()=>p});var r=s(56474),a=s.n(r),o=s(905);new o.Z(10).pow(8);const n=2147483648,i=a()({BIP44:2147483692,CIP1852:2147485500}),l=a()({CARDANO:2147485463}),d=20,c=a()({EXTERNAL:0,INTERNAL:1,CHIMERIC_ACCOUNT:2,GOVERNANCE_DREP_KEYS:3}),u=0,h=0,p=2160;new o.Z(25e6)},41274:(e,t,s)=>{"use strict";s.d(t,{JV:()=>x,kh:()=>E,T2:()=>m,z3:()=>k,IJ:()=>S,Wx:()=>_,zq:()=>v,_4:()=>M,gO:()=>C,xP:()=>b});var r,a,o,n,i=s(34074),l=s.n(i),d=s(5838),c=s.n(d),u=s(87672),h=s.n(u),p=s(89749),f=s.n(p),g=(s(18293),s(22188)),A=s(148),I=s(96486),T=s(66905),w=s(38079);let y=(r=class{constructor(e){c()(this,"addressesRequests",a,this),h()(this,"stores",void 0),h()(this,"actions",void 0),h()(this,"request",void 0),c()(this,"refreshAddressesFromDb",o,this),h()(this,"_flowCoerceResult",(e=>(e.result,e.result))),h()(this,"_getRequest",(e=>{const t=(0,I.find)(this.addressesRequests,{publicDeriverId:e});return t&&t.cachedRequest?t.cachedRequest:new A.Z(this.request)})),c()(this,"addObservedWallet",n,this),this.stores=e.stores,this.actions=e.actions,this.request=e.request}get all(){const e=this.stores.wallets.selected;if(!e)return[];const t=this._flowCoerceResult(this._getRequest(e.publicDeriverId));return null==t?[]:t}get wasExecuted(){const e=this.stores.wallets.selected;return!!e&&this._getRequest(e.publicDeriverId).wasExecuted}},a=f()(r.prototype,"addressesRequests",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f()(r.prototype,"all",[g.computed],l()(r.prototype,"all"),r.prototype),f()(r.prototype,"wasExecuted",[g.computed],l()(r.prototype,"wasExecuted"),r.prototype),o=f()(r.prototype,"refreshAddressesFromDb",[g.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async e=>{const t=this._getRequest(e.publicDeriverId);t.invalidate({immediately:!1}),await t.execute({publicDeriver:e}).promise}}}),n=f()(r.prototype,"addObservedWallet",[g.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return({publicDeriverId:e})=>{this.addressesRequests.push({publicDeriverId:e,cachedRequest:this._getRequest(e)})}}}),r);class x extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._wrapForeign({...t,storeName:e.name})}),this}}class E extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._wrapForAllAddresses({...t,storeName:e.name,type:w.dq.CARDANO_LEGACY})}),this}}class m extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._createAddressIfNeeded({publicDeriver:t.publicDeriver,genAddresses:()=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_LEGACY,chainsRequest:{chainId:T.OC.EXTERNAL}})})}),this}}class k extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_LEGACY,chainsRequest:{chainId:T.OC.INTERNAL}})}),this}}class S extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._createAddressIfNeeded({publicDeriver:t.publicDeriver,genAddresses:()=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_BASE,chainsRequest:{chainId:T.OC.EXTERNAL}})})}),this}}class _ extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._createAddressIfNeeded({publicDeriver:t.publicDeriver,genAddresses:()=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_BASE,chainsRequest:{chainId:T.OC.INTERNAL}})})}),this}}class v extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._wrapForAllAddresses({publicDeriver:t.publicDeriver,...t,storeName:e.name,type:w.dq.CARDANO_BASE})}),this}}class M extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._createAddressIfNeeded({publicDeriver:t.publicDeriver,genAddresses:()=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_ENTERPRISE,chainsRequest:{chainId:T.OC.EXTERNAL}})})}),this}}class C extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._createAddressIfNeeded({publicDeriver:t.publicDeriver,genAddresses:()=>e.stores.addresses._wrapForChainAddresses({...t,storeName:e.name,type:w.dq.CARDANO_ENTERPRISE,chainsRequest:{chainId:T.OC.INTERNAL}})})}),this}}class b extends y{constructor(e){return super({stores:e.stores,actions:e.actions,request:t=>e.stores.addresses._wrapForAllAddresses({publicDeriver:t.publicDeriver,...t,storeName:e.name,type:w.dq.CARDANO_REWARD})}),this}}},148:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(89837);s(63139);class a extends r.Z{}},39803:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>C});var r,a,o,n,i,l=s(34074),d=s.n(l),c=s(41511),u=s.n(c),h=s(93476),p=s.n(h),f=s(33032),g=s.n(f),A=s(36384),I=s.n(A),T=s(5838),w=s.n(T),y=s(87672),x=s.n(y),E=s(89749),m=s.n(E),k=(s(18293),s(22188)),S=s(78230),_=s(99095),v=s(63139);const M=(0,_.defineMessages)({apiMethodNotYetImplementedError:{id:"api.errors.ApiMethodNotYetImplementedError",defaultMessage:"!!!This API method is not yet implemented."},promiseNotCalledYetError:{id:"api.errors.PromiseNotCalledYetError",defaultMessage:"!!!Result accessed before execution finished."}});let C=(r=class{constructor(e){w()(this,"result",a,this),w()(this,"error",o,this),w()(this,"isExecuting",n,this),w()(this,"wasExecuted",i,this),x()(this,"currentlyExecuting",new(I())),x()(this,"promise",null),x()(this,"_method",void 0),x()(this,"_isWaitingForResponse",!1),x()(this,"_currentApiCall",null),this._method=e}execute(...e){if(this._isWaitingForResponse)return this;g()((0,k.action)("Request::execute (setting this.isExecuting)",(()=>{this.isExecuting=!0})),0);const t=Math.random();return this.currentlyExecuting.add(t),this.promise=new(p())(((s,r)=>{this._method||r(new b),this._method(...e).then((e=>{if(this.currentlyExecuting.has(t))return this.currentlyExecuting.delete(t),g()((0,k.action)("Request::execute/then",(()=>{null!=this.result&&(0,k.isObservableArray)(this.result)&&u()(e)?this.result.replace(e):this.result=e,this._currentApiCall&&(this._currentApiCall.result=e),this.isExecuting=!1,this.wasExecuted=!0,this.error=null,this._isWaitingForResponse=!1,s(e)})),1),e;s(e)})).catch((0,k.action)("Request::execute/catch",(e=>{this.currentlyExecuting.has(t)?(this.currentlyExecuting.delete(t),g()((0,k.action)((()=>{this.error=e,this.result=null,this.isExecuting=!1,this.wasExecuted=!0,this._isWaitingForResponse=!1,r(e)})),1)):r(e)})))})),this._isWaitingForResponse=!0,this._currentApiCall={args:e,result:null},this}isExecutingWithArgs(...e){return this.isExecuting&&null!=this._currentApiCall&&(0,S.isEqual)(this._currentApiCall.args,e)}get isExecutingFirstTime(){return!this.wasExecuted&&this.isExecuting}then(...e){if(!this.promise)throw new D;return this.promise.then(...e)}catch(...e){if(!this.promise)throw new D;return this.promise.catch(...e)}patch(e){return new(p())((t=>{g()((0,k.action)((()=>{const s=e(this.result);void 0!==s&&(this.result=s),this._currentApiCall&&(this._currentApiCall.result=this.result),t(this)})),0)}))}cancel(){return this.isExecuting=!1,this._isWaitingForResponse=!1,this._currentApiCall=null,this}reset(){this.result=null,this.error=null,this.isExecuting=!1,this.wasExecuted=!1,this._isWaitingForResponse=!1,this._currentApiCall=null}},a=m()(r.prototype,"result",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),o=m()(r.prototype,"error",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n=m()(r.prototype,"isExecuting",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),i=m()(r.prototype,"wasExecuted",[k.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m()(r.prototype,"isExecutingFirstTime",[k.computed],d()(r.prototype,"isExecutingFirstTime"),r.prototype),m()(r.prototype,"cancel",[k.action],d()(r.prototype,"cancel"),r.prototype),m()(r.prototype,"reset",[k.action],d()(r.prototype,"reset"),r.prototype),r);class b extends v.default{constructor(){super({id:M.apiMethodNotYetImplementedError.id,defaultMessage:M.apiMethodNotYetImplementedError.defaultMessage||""})}}class D extends v.default{constructor(){super({id:M.apiMethodNotYetImplementedError.id,defaultMessage:M.apiMethodNotYetImplementedError.defaultMessage||""})}}},16885:(e,t,s)=>{"use strict";s.d(t,{CW:()=>i,m2:()=>l,DN:()=>c});var r=s(56474),a=s.n(r),o=s(99095),n=s(38043);const i=a()({all:"all",internal:"internal",external:"external",mangled:"mangled"}),l=(a()({all:n.default.allLabel,...(0,o.defineMessages)({external:{id:"wallet.receive.nav.external",defaultMessage:"!!!External"},internal:{id:"wallet.receive.nav.internal",defaultMessage:"!!!Internal"},mangled:{id:"wallet.receive.nav.mangled",defaultMessage:"!!!Mangled"}})}),a()({base:"base",enterprise:"enterprise",reward:"reward",byron:"byron",addressBook:"addressBook",group:"group"})),d=(0,o.defineMessages)({group:{id:"wallet.address.category.group",defaultMessage:"!!!Addresses formed by the combination of a spending key and a staking key"},single:{id:"wallet.address.category.single",defaultMessage:"!!!Addresses containing only a spending key and no staking key"}}),c=(a()({group:d.group,base:d.group,enterprise:d.single,...(0,o.defineMessages)({reward:{id:"wallet.address.category.reward",defaultMessage:"!!!Address for your staking key"},byron:{id:"wallet.address.category.byron",defaultMessage:"!!!Addresses created using the Byron-era address format"},addressBook:{id:"wallet.address.category.addressBook",defaultMessage:"!!!Addresses that do not belong to you, but are relevant to your wallet"}})}),a()({byron:n.default.byronLabel,...(0,o.defineMessages)({base:{id:"wallet.receive.navigation.baseLabel",defaultMessage:"!!!Base"},enterprise:{id:"wallet.receive.navigation.enterpriseLabel",defaultMessage:"!!!Enterprise"},reward:{id:"wallet.receive.navigation.rewardLabel",defaultMessage:"!!!Reward"},group:{id:"wallet.receive.navigation.groupLabel",defaultMessage:"!!!Group"},addressBook:{id:"wallet.receive.navigation.AddressBook",defaultMessage:"!!!Address book"}})}),a()({None:"None",Unused:"Unused",Used:"Used",HasBalance:"HasBalance"}));a()({None:n.default.allLabel,...(0,o.defineMessages)({Used:{id:"wallet.receive.navigation.usedLabel",defaultMessage:"!!!Used"},Unused:{id:"wallet.receive.navigation.unusedLabel",defaultMessage:"!!!Unused"},HasBalance:{id:"wallet.receive.navigation.hasBalanceLabel",defaultMessage:"!!!Has Balance"}})})}}]);