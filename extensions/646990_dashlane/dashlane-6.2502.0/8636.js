"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[8636],{82994:(e,t,a)=>{a.d(t,{s:()=>h}),a(96832);var i=a(61468),n=a(8180),s=a(51031),r=a(25792),c=a(88203);let l=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var o=a(65580),d=a(68593);const u=({reason:e,translations:t,goToSharingAccess:a,closeCantDeleteDialog:n})=>{const{translate:s}=(0,c.Z)(),r=((e,t)=>{const{groupSharingTitle:a,lastAdminTitle:i,collectionSharingTitle:n,genericErrorTitle:s}=e;switch(t){case l.LastAdmin:return i;case l.GroupSharing:return a;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,o.U)(t)}})(t,e),u=((e,t)=>{const{groupSharingSubtitle:a,lastAdminSubtitle:i,collectionSharingSubtitle:n,genericErrorSubtitle:s}=e;switch(t){case l.LastAdmin:return i;case l.GroupSharing:return a;case l.CollectionSharing:return n;case l.Generic:return s;default:return(0,o.U)(t)}})(t,e);return(0,d.tZ)(i.Vq,{isOpen:!0,onClose:n,title:null!=r?r:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===l.LastAdmin||l.GroupSharing||l.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{a(),n()}}}:void 0,children:u})};var _=a(37527);const p=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:a})=>{const{translate:n}=(0,c.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:r,confirmDeleteDismiss:l,confirmDeleteConfirm:o}=a;return(0,d.tZ)(i.Vq,{title:r,onClose:e,isOpen:!0,dialogClassName:_.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:o,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:l,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},h=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:a,itemId:o,onDeletionSuccess:_,sharingStatus:h,translations:m,vaultItemType:S,isShared:g,isSharedViaUserGroup:b,isItemInCollection:C,isLastAdmin:f})=>{const{showToast:D}=(0,i.pm)(),{translate:I}=(0,c.Z)(),{deleteVaultItem:w}=(0,n.u)(r.L);if(!a)return null;let T;return(g||h?.isShared)&&(b&&(T=l.GroupSharing),f&&(T=l.LastAdmin),C&&(T=l.CollectionSharing)),T&&t?(0,d.tZ)(u,{reason:T,translations:m,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,d.tZ)(p,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await w({id:o,vaultItemType:S})).tag===s.rq.Success?(D({description:null!=(e=m.deleteSuccessToast)?e:I("webapp_personal_info_edition_delete_success_toast")}),_()):D({description:I("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){D({description:I("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:m})}},62042:(e,t,a)=>{a.d(t,{_:()=>l});var i=a(48062),n=a(88203),s=a(1639),r=a(68593);const c=({sharing:e})=>{const{translate:t}=(0,n.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:i.Origin.ItemDetailView})},l=({id:e,isShared:t,canShare:a,isDiscontinuedUser:i,getSharing:n})=>t&&!a||i?null:(0,r.tZ)(c,{sharing:n(e)})},68636:(e,t,a)=>{a.r(t),a.d(t,{SecretEditPanel:()=>x});var i=a(96832),n=a(15192),s=a(25792),r=a(39431),c=a(89078),l=a(51031),o=a(24507),d=a(65455),u=a(48062),_=a(30894),p=a(45272),h=a(34557),m=a(92077),S=a(40577),g=a(88203),b=a(15940),C=a(62042),f=a(82994),D=a(63520),I=a(99822),w=a(78047),T=a(66098),y=a(77063),A=a(79808),v=a(8180),Z=a(14900),E=a(86498),U=a(73157),L=a(5465),O=a(99193),F=a(92730),R=a(68593);const{CONTENT:k,SHARED_ACCESS:P,DOCUMENT_STORAGE:G}=b.SecretsTabs,N=({secret:e,isShared:t,sharingCapabilities:a,isSharedViaUserGroup:n,isLastAdmin:c})=>{var o,d,u;const{translate:_}=(0,g.Z)(),{routes:p}=(0,m.Xo)(),{navigateBack:h}=(0,F.u)(),[N,V]=(0,i.useState)(k),[x,q]=(0,i.useState)(!1),[B,M]=(0,i.useState)(!1),[H,z]=(0,i.useState)(!1),[X,K]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(!1),[W,j]=(0,i.useState)({id:e.id,title:e.title,content:e.content,spaceId:null!=(o=e.spaceId)?o:"",secured:null!=(d=e.isSecured)&&d,attachments:null!=(u=e.attachments)?u:[]}),{data:Q,status:J}=(0,A.r)(e.id),ee=function(){const{translate:e}=(0,g.Z)(),{showAlert:t}=(0,E.V)(),{updateVaultItem:a}=(0,v.u)(s.L);return async(i,n)=>{try{await a({vaultItemType:r.U.Secret,content:i,id:n})}catch{t(e("_common_generic_error"),Z.BLW.ERROR)}}}(),{shouldShowFrozenStateDialog:te}=(0,y.Ub)(),ae=(0,S.o)("ace_secrets_vault_attachment")||!!e.attachments&&e.attachments.length>0,ie=t&&J===l.rq.Success&&null!=(ne=Q?.count)?ne:0;var ne;const se=()=>{h(p.userSecrets)};if(!e)return se(),null;const re=async(t=!0,a)=>{var i;K(!0),await ee({title:W.title,content:W.content,spaceId:null!=(i=W.spaceId)?i:"",isSecured:W.secured,attachments:a},e.id),K(!1),t&&se()},ce=()=>{$(!0)},le=async e=>{if($(!1),e.success){await L.C.commitSecureFile({secureFileInfo:e.secureFileInfo});const t=[...W.attachments,(0,O.w)(e.secureFileInfo)];j((e=>({...e,attachments:t}))),re(!1,t)}},oe={confirmDeleteConfirm:_("webapp_secrets_edition_delete_confirm"),confirmDeleteDismiss:_("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:_("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:_("webapp_secrets_edition_delete_title"),lastAdminActionLabel:_("webapp_credential_edition_change_permissions"),lastAdminTitle:_("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:_("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:_("webapp_secrets_edition_group_sharing_title"),groupSharingSubtitle:_("webapp_credential_edition_group_sharing_subtitle"),genericErrorTitle:"webapp_account_recovery_generic_error_title",genericErrorSubtitle:"webapp_account_recovery_generic_error_subtitle"};if(null===te)return null;const de=t||ae?[{id:"tab-secret-detail",contentId:"content-secret-detail",title:_("webapp_secrets_edition_field_tab_title_details"),onSelect:()=>V(k)}]:[];return t?de.push({id:"tab-secret-shared-access",contentId:"content-secret-shared-access",title:`${_("webapp_secure_notes_edition_field_tab_title_shared_access")} (${ie})`,onSelect:()=>V(P)}):ae&&de.push({id:"tab-secret-attachments",contentId:"content-secret-attachments",title:_("webapp_secrets_edition_field_tab_title_attachments"),onSelect:()=>V(G)}),(0,R.BX)(D.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:x,onSubmit:()=>re(),submitPending:X,secondaryActions:(()=>{switch(N){case k:return[(i=e,!i||t&&!a.canShare||i.attachments?.length?null:(0,R.tZ)(C._,{id:e.id,isShared:t,canShare:a.canShare,isDiscontinuedUser:te,getSharing:I.fl},"shareaction"))];case G:return[(0,R.tZ)(U.d,{isQuotaReached:!1,onFileUploadStarted:ce,onFileUploadDone:le,isShared:t,itemId:e.id,dataType:"KWSecret",disabled:!!te},"uploadAction")];default:return[]}var i})(),onNavigateOut:se,onClickDelete:()=>M(!0),ignoreCloseOnEscape:B||H,isSomeDialogOpen:B,formId:"edit_secret_panel",header:(0,R.tZ)(T.h,{title:W.title,tabs:de}),children:[(0,R.tZ)(w.e,{activeTab:N,sharingCapabilities:a,isSecured:e.isSecured,isAttachmentUploading:Y,isNewItem:!1,secretValues:W,handleChange:(t,a)=>{if("spaceId"===t&&a===W.spaceId)return;const i={...W,[t]:a},n=e.title!==i.title||e.content!==i.content||e.spaceId!==i.spaceId||e.isSecured!==i.secured;n!==x&&q(n),j(i)},handleFileInfoDetached:e=>{const t=W.attachments.filter((t=>t.id!==e));j((e=>({...e,attachments:t}))),re(!1,t)},onModalDisplayStateChange:z}),(0,R.tZ)(f.s,{isVisible:B,itemId:e.id,closeConfirmDeleteDialog:()=>M(!1),goToSharingAccess:()=>{V(b.SecretsTabs.SHARED_ACCESS)},onDeletionSuccess:se,translations:oe,vaultItemType:r.U.Secret,isShared:t,isLastAdmin:c,isSharedViaUserGroup:n})]})},V=e=>{const{secret:t}=e,a=(0,_.tY)();(0,i.useEffect)((()=>{(0,p.Nc)(u.PageView.ItemSecretDetails)}),[t]);const{getPermissionForItem:n,getSharingStatusForItem:s,getIsLastAdminForItem:r}=(0,c.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(n.status!==l.rq.Success||s.status!==l.rq.Success||r.status!==l.rq.Success)return null;const{isShared:o,isSharedViaUserGroup:h}=s.data,{isLastAdmin:m}=r.data;return(0,R.tZ)(N,{...e,...a,isShared:o,sharingCapabilities:n.data?.capabilities,isSharedViaUserGroup:h,isLastAdmin:m})},x=e=>{const{routes:t}=(0,m.Xo)(),{data:a,status:i}=(0,o.k)(s.L,"query",{vaultItemTypes:[r.U.Secret],ids:[`{${e.match.params.uuid}}`]});return i===l.rq.Loading?null:a?.secretsResult.items.length?(0,R.tZ)(V,{...e,secret:a.secretsResult.items[0]}):e.location?.state?(0,R.tZ)(n.l_,{to:(0,h.rF)(e.location.state,t)}):(0,R.tZ)(n.l_,{to:t.userSecrets})}},15940:(e,t,a)=>{a.d(t,{SecretsTabs:()=>i});let i=function(e){return e[e.CONTENT=0]="CONTENT",e[e.SHARED_ACCESS=1]="SHARED_ACCESS",e[e.DOCUMENT_STORAGE=2]="DOCUMENT_STORAGE",e}({})},66098:(e,t,a)=>{a.d(t,{h:()=>c});var i,n=a(61468),s=a(63520),r=a(68593);const c=({title:e,tabs:t})=>(0,r.tZ)(s.V9,{icon:i||(i=(0,r.tZ)(n.AK,{type:"secret",size:"xlarge"})),title:e,tabs:t})},78047:(e,t,a)=>{a.d(t,{e:()=>U});var i=a(96832),n=a(61468),s=a(51031),r=a(80936),c=a(88203),l=a(22061),o=a(33988),d=a(54350),u=a(68037),_=a(67406),p=a(15940),h=a(77063),m=a(53294),S=a(48062),g=a(30894),b=a(68819),C=a(82207),f=a(45272),D=a(79432),I=a(68593);const{CONTENT:w,SHARED_ACCESS:T,DOCUMENT_STORAGE:y}=p.SecretsTabs,A="webapp_secure_notes_edition_field_text_max_size_reached",v="webapp_secret_edition_action_show_secret_content",Z="webapp_secret_edition_action_hide_secret_content",E=1e4,U=({activeTab:e,sharingCapabilities:t,isSecured:a,isAttachmentUploading:p,isNewItem:U,secretValues:L,handleChange:O,handleFileInfoDetached:F,onModalDisplayStateChange:R})=>{const{translate:k}=(0,c.Z)(),[P,G]=(0,i.useState)(""),{shouldShowFrozenStateDialog:N}=(0,h.Ub)(),V=(0,o.F)(),{isMPLessUser:x}=(0,d.Z)(),q=!V&&!x,{areProtectedItemsUnlocked:B,openProtectedItemsUnlocker:M}=(0,g.tY)(),{logRevealSecretContent:H,logCopiedSecretContent:z}=(0,D.D)(),X=(0,r.I)(),K=X.status===s.rq.Success&&!X.isDisabled,{id:Y,title:$,content:W,spaceId:j,secured:Q}=L,[J,ee]=(0,i.useState)(""===W),te=a&&!B,ae=Boolean(W.length),ie=Boolean(j),ne=(0,i.useCallback)(((e,t)=>new Promise(((a,i)=>{if(e||!te||!q)return t(),a();M({action:b.P.Show,itemType:b.R.Secret,successCallback:()=>(t(),a()),cancelCallback:i})}))),[te,M]),se=()=>{ee((e=>!e)),!J&&ie&&H($)};return null===N?null:(0,I.BX)(I.HY,{children:[e===w&&(0,I.BX)("div",{"aria-labelledby":"tab-secret-detail",id:"content-secret-detail",children:[(0,I.BX)(u.u,{title:k("webapp_secrets_box_title_details"),children:[(0,I.tZ)(n.qo,{"data-name":"title",label:k("webapp_secrets_title_field"),value:$,onChange:e=>O("title",e.target.value),disabled:!t.canEdit,readOnly:N,sx:{marginBottom:"8px"}}),(0,I.tZ)(n.Kx,{"data-name":"content",label:k("webapp_secrets_content_field"),placeholder:k("webapp_secrets_content_field_placeholder"),value:J||!ae?W:"••••••••",onBeforeInput:e=>{const t=e.currentTarget.value;t.length>E&&(G(k(A,{charLeft:E-(t.length-1)})),e.preventDefault())},onPaste:e=>{const t=e.clipboardData.getData("text/plain");e.currentTarget.value.length+t.length>E&&(G(k(A,{charLeft:E-e.currentTarget.value.length})),e.preventDefault())},onChange:e=>{P&&G(""),O("content",e.target.value)},readOnly:!J&&ae||N||!t.canEdit,feedback:P?{text:P}:void 0,error:!!P,actions:[(0,I.tZ)(n.zx,{layout:"iconOnly",icon:J?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{ne(J,se).catch((()=>{ee(!1)}))},"aria-label":k(J?Z:v),tooltip:k(J?Z:v)},"secret-content-visibility"),...ae?[(0,I.tZ)(C.m,{data:W,checkProtected:()=>te,copyLabel:k("webapp_secret_edition_action_copy_secret_content"),onCopy:()=>{(0,f.Kz)(new S.UserCopyVaultItemFieldEvent({itemId:Y,itemType:S.ItemType.Secret,field:S.Field.Secret,isProtected:a})),ie&&z($)},itemType:b.R.Secret,tooltipLocation:"right"},"copy-secret-content")]:[]]})]}),K?(0,I.tZ)(_.M,{disabled:N,contentCardLabel:k("webapp_secrets_box_title_organization"),wrapInContentCard:!0,isUsingNewDesign:!0,defaultSpaceId:null!=j?j:"",spaceId:null!=j?j:"",onChange:e=>O("spaceId",e)}):null,q?(0,I.tZ)(u.u,{title:k("webapp_secrets_box_title_preferences"),additionalSx:{marginTop:"16px"},children:(0,I.tZ)(n.XZ,{readOnly:N,label:k("webapp_secrets_preferences_mp_title"),description:k("webapp_secrets_preferences_mp_description"),checked:Boolean(Q),onChange:()=>{B||U?O("secured",Boolean(!Q)):((0,g.jF)(),M({action:b.P.Show,itemType:b.R.Secret,successCallback:()=>O("secured",Boolean(!Q))}))}})}):null]}),e===y&&(0,I.tZ)("div",{"aria-labelledby":"tab-secret-attachments",id:"content-secret-attachments",children:(0,I.tZ)(m.P,{attachments:L.attachments,additionalProps:{itemId:Y,itemType:S.ItemType.Secret,handleFileInfoDetached:e=>{F(e)},onModalDisplayStateChange:R,isUploading:p}})}),e===T&&(0,I.tZ)("div",{"aria-labelledby":"tab-secret-shared-access",id:"content-secret-shared-access",children:(0,I.tZ)(l.u,{canChangeRoles:t.canChangeRoles,id:Y})})]})}}}]);