var e=globalThis,t={},n={},i=e.parcelRequire94c2;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in n){var i=n[e];delete n[e];var s={id:e,exports:{}};return t[e]=s,i.call(s.exports,s,s.exports),s.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire94c2=i),i.register,i("eme3Z");var s=i("cm1jU"),o=i("fEci9"),r=i("foKjy");const a=(0,s.iframeResize)({},"#connector-instructions")[0].iFrameResizer,c="storage.license-agreement-accepted";async function d(){document.getElementById("license-agreement").classList.add("active"),!0===(await browser.storage.local.get(c))[c]?(document.getElementById("license-agreement-view").classList.add("d-none"),await l()):document.getElementById("license-agreement-view").classList.remove("d-none")}async function l(){document.getElementById("connector-installation").classList.add("active");try{let e=await browser.runtime.sendNativeMessage("firefoxpwa",{cmd:"GetSystemVersions"});if("Error"===e.type)throw Error(e.data);if("SystemVersions"!==e.type)throw Error(`Received invalid response type: ${e.type}`);let t=browser.runtime.getManifest().version,n=e.data.firefoxpwa;t.split(".",1)[0]===n.split(".",1)[0]?(document.getElementById("connector-installation-view").classList.add("d-none"),await m(e.data)):(document.getElementById("connector-native-error").classList.add("d-none"),document.getElementById("connector-version-error").classList.remove("d-none"),document.getElementById("connector-version-error-extension").innerText=t,document.getElementById("connector-version-error-native").innerText=n,document.getElementById("connector-installation-view").classList.remove("d-none"),a.resize())}catch(e){["Attempt to postMessage on disconnected port","No such native application firefoxpwa"].includes(e.message)||(document.getElementById("connector-version-error").classList.add("d-none"),document.getElementById("connector-native-error").classList.remove("d-none"),document.getElementById("connector-native-error-text").innerText=e.message,console.error(e)),document.getElementById("connector-installation-view").classList.remove("d-none"),a.resize()}setTimeout(l,1e4)}async function m(e){document.getElementById("runtime-installation").classList.add("active"),e.firefox?(document.getElementById("runtime-installation-view").classList.add("d-none"),document.getElementById("ready").classList.add("active"),document.getElementById("ready-view").classList.remove("d-none")):(document.getElementById("runtime-installation-view").classList.remove("d-none"),e._7zip||"win"!==(await browser.runtime.getPlatformInfo()).os?document.getElementById("runtime-needs-7zip").classList.add("d-none"):document.getElementById("runtime-needs-7zip").classList.remove("d-none"),await (0,o.isAutoRuntimeInstallSupported)()||(document.getElementById("runtime-manual-install").classList.remove("d-none"),document.getElementById("runtime-auto-install").classList.add("d-none"),document.getElementById("runtime-install-start").classList.add("d-none")))}document.getElementById("license-agreement-decline").onclick=async function(){await browser.management.uninstallSelf({showConfirmDialog:!0,dialogMessage:await (0,r.getMessage)("setupPageLicenseUninstallation")+"\n"})},document.getElementById("license-agreement-accept").onclick=async function(){await browser.storage.local.set({[c]:!0}),await d()},document.getElementById("runtime-install-start").onclick=async function(){this.innerText=await (0,r.getMessage)("buttonRuntimeInstallProcessing"),this.disabled=!0;try{let e=await browser.runtime.sendNativeMessage("firefoxpwa",{cmd:"InstallRuntime"});if("Error"===e.type)throw Error(e.data);if("RuntimeInstalled"!==e.type)throw Error(`Received invalid response type: ${e.type}`);this.innerText=await (0,r.getMessage)("buttonRuntimeInstallFinished")}catch(e){console.error(e),document.getElementById("runtime-install-error").classList.remove("d-none"),document.getElementById("runtime-install-error-text").innerText=e.message}},async function(){await a.resize(),await d()}();