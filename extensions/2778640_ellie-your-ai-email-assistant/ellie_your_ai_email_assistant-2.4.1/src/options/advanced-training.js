function crawlUrl(){const e=document.querySelector("#advanced-training-url").value,t=document.querySelector("#advanced-training-file").files[0];if(!e&&!t)return updateError({message:"You must enter a URL or select a file"}),!1;(new FormData).append("file",t);crawl({url:e,excludeUrls:[...document.getElementById("exclude-url-inputs").querySelectorAll("input")].map((e=>e.value)).filter(Boolean),file:t})}async function crawl({url:e,excludeUrls:t,file:n}){updateButtons({loading:!0});let l={type:"crawl-url-for-corpus",url:e,excludeUrls:t,file:await serializeFile(n)};chrome.runtime.sendMessage(l,(function(e){}))}function updateButtons({loading:e=!1}={}){[...document.querySelectorAll(".submit-corpus")].forEach((t=>{t.disabled=e,e?(t.setAttribute("data-label",t.textContent),t.textContent="Starting crawl..."):t.textContent=t.getAttribute("data-label")}))}function updateError({message:e=""}){const t=document.getElementById("training-error");t.textContent=e,t.style.display="block"}function addExludeInput(){const e=document.getElementById("exclude-url-inputs"),t=e.querySelectorAll("input").length,n=document.createElement("input");n.type="text",n.id=`exlude-url-${t}`,n.autofocus=!0,e.appendChild(n)}async function serializeFile(e){if(!e)return null;const t=e instanceof Blob,n=t?e:await new Response(e).blob(),l=new FileReader;return new Promise((r=>{l.onload=()=>r([l.result,n.type,t,e.name]),l.readAsDataURL(n)}))}chrome.runtime.onMessage.addListener((function(e){"started-crawl"===e.type&&window.location.reload()})),document.getElementById("submit-corpus-url").addEventListener("click",crawlUrl),document.getElementById("add-exclude-url").addEventListener("click",addExludeInput);