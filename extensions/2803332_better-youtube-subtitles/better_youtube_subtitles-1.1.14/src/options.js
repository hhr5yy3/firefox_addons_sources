(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function o(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(i){if(i.ep)return;i.ep=!0;const a=o(i);fetch(i.href,a)}})();const d=async t=>new Promise(n=>chrome.storage.local.get(t,o=>{o[t]?n(o[t]):n(null)})),u=async()=>new Promise(t=>chrome.storage.local.get(null,n=>{var o;(o=Object.keys(n))!=null&&o.length?t(n):t(null)})),c=async t=>new Promise(n=>chrome.storage.local.set(t,()=>n(null))),g=(t,n)=>{const o=parseInt(t.slice(1,3),16),e=parseInt(t.slice(3,5),16),i=parseInt(t.slice(5,7),16);return typeof n<"u"&&n<1?`rgba(${o}, ${e}, ${i}, ${n})`:`rgb(${o}, ${e}, ${i})`},r=(t,n,o)=>t.push(`${n}: ${o} !important;`),h=async()=>{const t=[],n=[],o=[],e=await u();e.fontFamilyPref&&e.fontFamily&&r(t,"font-family",`${e.fontFamily}, sans-serif`),e.fontSizePref&&r(t,"font-size",`${100+parseInt(e.fontSize)*2}%`),e.fontWeightPref&&r(t,"font-weight",e.fontWeight),e.fontColorPref&&r(t,"color",e.fontColor),e.fontOpacityPref&&parseInt(e.fontOpacity)<100&&r(t,"opacity",(parseInt(e.fontOpacity)/100).toString()),e.effectLetterSpacingPref&&parseFloat(e.effectLetterSpacing)>0&&r(t,"letter-spacing",`${e.effectLetterSpacing}em`),e.effectWordSpacingPref&&parseFloat(e.effectWordSpacing)>0&&r(t,"word-spacing",`${e.effectWordSpacing}em`),e.effectLineHeightPref&&parseFloat(e.effectLineHeight)>0&&r(t,"line-height",`${e.effectLineHeight}%`),e.effectTextVertMarginPref&&(r(o,"margin-bottom",`${e.effectTextVertMargin}em`),r(o,"margin-top",`${e.effectTextVertMargin}em`)),e.effectTextHorMarginPref&&(r(o,"margin-left",`${e.effectTextHorMargin}em`),r(o,"margin-right",`${e.effectTextHorMargin}em`)),(e.effectTextVertPosition!=="default"||e.effectTextHorPosition!=="default")&&r(n,"display","flex"),e.effectTextVertPosition!=="default"&&(r(o,"bottom","unset"),e.effectTextVertMarginPref||r(o,"margin-bottom","0")),e.effectTextVertPosition==="top"?r(n,"align-items","start"):e.effectTextVertPosition==="center"?r(n,"align-items","center"):e.effectTextVertPosition==="bottom"&&r(n,"align-items","end"),e.effectTextHorPosition!=="default"&&(r(o,"left","unset"),e.effectTextHorMarginPref||r(o,"margin-left","0")),e.effectTextHorPosition==="left"?r(n,"justify-content","start"):e.effectTextHorPosition==="center"?r(n,"justify-content","center"):e.effectTextHorPosition==="right"&&r(n,"justify-content","end"),e.effectTextTransform!=="none"&&r(t,"text-transform",e.effectTextTransform),(e.effectStrokePref||e.effectShadowPref||e.effectTextBlurPref)&&r(t,"text-shadow","none"),e.effectStrokePref&&(r(t,"-webkit-text-stroke",`${e.effectStrokeWidth}em ${e.effectStrokeColor}`),r(t,"paint-order","stroke")),e.effectShadowPref&&r(t,"text-shadow",`${e.effectShadowOffsetX}em ${e.effectShadowOffsetY}em ${e.effectShadowBlur}em ${g(e.effectShadowColor,parseInt(e.effectShadowOpacity)/100)}`),e.effectTextBlurPref&&parseFloat(e.effectTextBlur)>0&&r(t,"filter",`blur(${e.effectTextBlur}em)`);const i=e.backgroundType==="window"?o:t,a=e.backgroundType==="window"?t:o;e.backgroundColorOpacityPref&&(r(i,"background-color",g(e.backgroundColor,parseInt(e.backgroundOpacity)/100)),r(a,"background-color","transparent")),e.backgroundPaddingPref&&parseFloat(e.backgroundPadding)>0&&(r(i,"padding",`${e.backgroundPadding}em`),r(a,"padding","0"),r(o,"width","unset")),e.backgroundRadiusPref&&parseFloat(e.backgroundRadius)>0&&r(i,"border-radius",`${e.backgroundRadius}em`),await c({captionSegmentStyles:t.length>0?t.join(" "):""}),await c({captionWindowContainerStyles:n.length>0?n.join(" "):""}),await c({captionWindowStyles:o.length>0?o.join(" "):""})},w=()=>{chrome.tabs.query({discarded:!1,status:"complete",url:"https://*.youtube.com/*"},t=>{if(t.length)for(const n of t)chrome.tabs.sendMessage(n.id,{action:"updateSubtitles"})})},b=Array.from(document.getElementsByClassName("option")),m=t=>{Array.from(document.querySelectorAll(`[data-parent="${t.id}"]`)).forEach(o=>{o.tagName==="TR"?o.style.display=t.checked?"":"none":o.style.visibility=t.checked?"":"hidden"})},l=t=>{const n=document.getElementById(t.id+"Output");n&&(n.textContent=t.value+n.name)},P=async t=>{t.type==="range"&&l(t),t.type==="checkbox"&&m(t),t.type==="checkbox"?await c({[t.id]:t.checked}):await c({[t.id]:t.value}),await h(),w(),y()},p=async()=>{const t=await u();b.forEach(n=>{const o=document.getElementById(n.id);if(!o)return;const e=t[n.id];e!==void 0&&(typeof e=="boolean"?o.checked=e:typeof e=="string"&&(o.value=e),n.type==="checkbox"&&m(n),n.type==="range"&&(l(o),o.oninput=()=>l(o)),o.onchange=i=>P(i.target))})};p();const S=document.getElementById("better-yt-style"),y=async()=>{const t=document.getElementById("previewContainer"),n=await d("captionSegmentStyles"),o=await d("captionWindowStyles");if(!n&&!o){t.style.display="none";return}t.style.display="",S.innerText=`${(n==null?void 0:n.length)>0?`#previewContainer .caption-segment { ${n} }`:""} ${(o==null?void 0:o.length)>0?`#previewContainer .caption-window { ${o} }`:""}`};y();const x=document.getElementById("version");x.textContent=chrome.runtime.getManifest().version;const f=chrome.i18n.getMessage,T=document.getElementById("headerInfo");T.textContent=f("headerInfo");const $=document.getElementById("previewText");$.textContent=f("previewText");const E=Array.from(document.getElementsByTagName("label"));E.forEach(t=>{if(t.textContent=t.htmlFor&&f(t.htmlFor),f(t.htmlFor+"Desc")){const n=t.parentNode;n.title=f(t.htmlFor+"Desc"),n.onmouseenter=()=>t.style.cursor="help",n.onmouseleave=()=>t.style.cursor="default"}});const k=Array.from(document.getElementsByTagName("option"));k.forEach(t=>t.id&&(t.textContent=f(t.id)));const C=Array.from(document.getElementsByTagName("h3"));C.forEach(t=>t.id&&(t.textContent=f(t.id)));if(chrome.fontSettings){const t=document.getElementById("fontList");chrome.fontSettings.getFontList(n=>{for(const o of n){const e=document.createElement("option");e.value=o.displayName,t.appendChild(e)}})}chrome.runtime.onMessage.addListener(t=>{t.action==="updateOptions"&&p()});
