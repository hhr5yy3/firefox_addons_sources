"use strict";(globalThis.webpackChunkgroup_speed_dial=globalThis.webpackChunkgroup_speed_dial||[]).push([[286],{1329:(t,e,n)=>{n.r(e),n.d(e,{ErrorHandler:()=>v});var a=n(4323),r=n(7885),o=n(4590),s=n(5296),i=n(6004),c=n(2895),l=n(2460),p=n(1755),g=n(8671),u=n(2846),h=n(2031),d=n(744),m=n(4468),w=n(9451),b=n(910),f=n(2036),$=n(779),_=n(7302),y=n(6801),O=n(9676),x=n(8794),S=n(8815),k=n(8282);(0,h.g)("non-background");const v=new class{pageStartTime=Date.now();constructor(){d.b.catch((t=>this.showCriticalErrorMessage((0,c.Nw)("Environment health-check error",t))))}async getSystemInfo(){const t=(0,O.w)(1e3,"ERR: Timeout!",(()=>(0,y._z)({type:"selfMessage",message:{type:"ping"}}).catch((t=>(0,c.Nw)("ERR: Background not responding!",t))))),e=await new b.F("_ext_started",(()=>0),{storageArea:"session"}).get(),n=(await w.g.get()).map((({context:t,name:n,err:r,errName:o,errMessage:s,data:i,time:c,stack:l},p,g)=>[`${new Date(c).toLocaleString("sk-SK")} ${(c-(0===p?e:g[p-1].time)).toString().padStart(5," ")}ms, ${t} - ${n}`,o,s,r,i,l].filter(a.zz).join("\n"))).join("\n"),o=`Stats: ${(await(0,f.wz)().catch(a.lQ)||{license:"NA"}).license} - ${u.M.GROUPS.map((t=>(t.dials||[]).filter((t=>t.isNotEmptyDial())).length)).join(",")}\n${JSON.stringify(await(0,p.U)())}`,s=Object.entries({Caches:!!self.caches,OffscreenCanvas:!!self.OffscreenCanvas,"<all_urls>":(await browser.permissions.getAll()).origins?.includes(k.P4)}).filter((([t,e])=>!e)).map((([t])=>t));return`Environment: ${await(0,r.ug)()}\nBackground script state: ${await t}\nSync status: ${await(0,S.E)((async()=>(await x.wd.get()).state),(()=>"NA"))}\nMissing API: [${s.join(", ")}]\nPixel ratio: ${window.devicePixelRatio}\nRunning time: ${(0,l.FK)((Date.now()-this.pageStartTime)/1e3)}s\n${o}\nRuntime logs:\n${n}\n`}async showCriticalErrorMessage(t="",e="",n=""){const a=[],c=await this.getSystemInfo(),l=`${t}\n${n}\n${c}`;c.includes("A mutation operation was attempted on a database that did not allow mutations.")?a.push(["b",(0,o.tr)("err_mutable_title")],["p",(0,o.tr)("err_mutable_body")]):a.push(["p",(0,o.tr)("unexpected_title")],["p",(0,o.tr)("unexpected_err_help_0")],["p",(0,o.tr)("unexpected_err_help_1"),[["a",{textContent:"Fixing broken dials page",href:"https://github.com/fastaddons/GroupSpeedDial/wiki/Fixing-broken-dials-page",style:"margin-left: 8px;",target:"_blank"}]]],["p",{style:"margin-top: 12px;"},[["b",(0,o.tr)("create_new_backup")+": "],["button",{textContent:(0,o.tr)("welcome_options_page"),handlers:{onclick:()=>(0,m.h)($.g.OptionsImportBackup)}}]]],["b",(0,o.tr)("unexpected_err_share")],["button",{style:"margin-left: 8px;"},await(async()=>["a",{href:`${await(0,r.ow)()}&body=${encodeURIComponent(`\n\n\nERROR DETAILS:\n${t}\n${c}`)}`,class:"flex flex-space-between"},[["img",{height:18,width:18,src:(0,_.Z)("/utils/svg/email(0).svg")}],["span",(0,o.tr)("email_send_me")]]])()]),a.push(["p",(0,o.tr)("err_error_details")],["textarea",{readonly:!0,rows:25,textContent:l}]),s.p.showError((0,o.tr)("err_db_err_title"),(0,i.Y6)(a),{yesText:(0,o.tr)("label_close"),noText:(0,o.tr)("label_copy"),onNo(){throw(0,g.l)(l),"don't close :)"}})}async sendRuntimeErrorLogs(){const t=await this.getSystemInfo();s.p.show((0,o.tr)("send_runtime_errors"),(0,i.Y6)([["p",0,["b",0,["a",{href:`${await(0,r.ow)()}&body=${encodeURIComponent(`${t}`)}`,class:"flex flex-space-between"},[["img",{height:18,width:18,src:(0,_.Z)("/utils/svg/email(0).svg")}],["span",(0,o.tr)("email_send_me")]]]]],["textarea",{readonly:!0,rows:25,textContent:`${t}`,handlers:{ondblclick:function(t){this.select()}}}]]),{yesText:(0,o.tr)("label_close"),noText:(0,o.tr)("label_copy"),onNo(){throw(0,g.l)(t),"don't close :)"}})}}},4468:(t,e,n)=>{n.d(e,{h:()=>s});var a=n(779),r=n(7302),o=n(8408);const s=t=>(0,o.K)(`${(0,r.Z)("popup/popup.html")}#${a.g[t]}`,{inNewTab:!0,active:!0,nextToCurrent:!0})},779:(t,e,n)=>{var a;n.d(e,{g:()=>a}),(t=>{t[t.Search=0]="Search",t[t.OptionsGeneral=1]="OptionsGeneral",t[t.OptionsDials=2]="OptionsDials",t[t.OptionsGroups=3]="OptionsGroups",t[t.OptionsBackground=4]="OptionsBackground",t[t.OptionsContextMenu=5]="OptionsContextMenu",t[t.OptionsThumbnails=6]="OptionsThumbnails",t[t.OptionsShortcuts=7]="OptionsShortcuts",t[t.OptionsSynchronization=8]="OptionsSynchronization",t[t.OptionsImportBackup=9]="OptionsImportBackup",t[t.OptionsImport3rdParty=10]="OptionsImport3rdParty",t[t.StorageInfo=11]="StorageInfo",t[t.About=12]="About",t[t.Upgrade=13]="Upgrade"})(a||(a={}))},2895:(t,e,n)=>{n.d(e,{Nw:()=>a,fF:()=>r});const a=(t,e)=>`${t}: ${e?.name}\n${e?.message}\n${e?.stack}\n${e}`,r=t=>e=>(t(e),e)},3877:(t,e,n)=>{function a(){const t=browser.runtime.getManifest();return`${t.name} ${t.version}`}n.d(e,{O:()=>a})},260:(t,e,n)=>{n.d(e,{z:()=>r});var a=n(4323);function r(t,e=1){if(!(0,a.Et)(t)||t<0)return"";if(0===t)return"0";const n=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,Math.floor(n))).toFixed(e)} ${["B","KB","MB","GB","TB","PB"][n]}`}},1755:(t,e,n)=>{n.d(e,{U:()=>i});var a=n(260),r=n(8815),o=n(4323);const s=()=>-1;async function i(){const t=await(navigator.storage?.estimate?.().catch(o.lQ))||{};return{indexedDB:(0,a.z)(t.usage||-1),storageLocal:(0,a.z)(JSON.stringify(await browser.storage.local.get().catch(s)).length),storageSync:(0,a.z)(JSON.stringify(await browser.storage.sync.get().catch(s)).length),localStorage:(0,a.z)((0,r.g)((()=>JSON.stringify(localStorage).length),s)),quota:(0,a.z)(t.quota||-1)}}},7885:(t,e,n)=>{n.d(e,{hS:()=>s,ow:()=>i,ug:()=>l});var a=n(3877),r=n(1962);const o=t=>JSON.stringify(t).replaceAll(/{"|"}/g,"").replaceAll('","',", ").replaceAll('":"',": "),s=()=>"spam_here@fastaddons.com".replace("spam_here","admin"),i=()=>l().then((t=>`${"mailto:"+s()}?subject=${encodeURIComponent(t)}`)),c=()=>navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)?.[2]||"0";async function l(){const t=await(browser.runtime?.getBrowserInfo?.().catch((t=>({err:t,name:r.$b}))))||{name:r.$b,version:c()||navigator.userAgent.match(/Version\/([\d.]+)/)?.[1]},e=await(browser.runtime?.getPlatformInfo?.().catch((t=>({err:t}))))||{os:"unknown"};return`${(0,a.O)()}; ${o(t)}; ${o(e)};`}}}]);