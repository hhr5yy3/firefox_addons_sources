(()=>{"use strict";function e(){const e=1==(void 0!==navigator.userAgentData&&void 0!==navigator.userAgentData.platform)?navigator.userAgentData:navigator.userAgent;if(!e)return null;if("string"==typeof e)switch(!0){case e.indexOf("Chrome")>-1:return"chrome";case e.indexOf("Firefox")>-1:return"firefox";case e.indexOf("Safari")>-1:return"safari"}else switch(!0){case Boolean(e.brands.find((e=>"Microsoft Edge"===e.brand))):return"edge";case Boolean(e.brands.find((e=>"Opera"===e.brand))):return"opera";case Boolean(e.brands.find((e=>"Google Chrome"===e.brand||"Chromium"===e.brand))):return"chrome";case Boolean(e.brands.find((e=>"Firefox"===e.brand||"Mozilla"===e.brand))):return"firefox";case Boolean(e.brands.find((e=>"Safari"===e.brand))):return"safari"}return null}window.location,window.parent.location;const t="firefox"===e();e();function o(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const n={addMessageListener:function(e){const t=(t,o,n)=>(e(t,o,n),!0);return chrome.runtime.onMessage.addListener(t),()=>{chrome.runtime.onMessage.removeListener(t)}},handleResponse:r,get messageCallbacks(){return window.messageCallbacks},onMessage:function(e){return function(t,o,n){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}t.name?t.name.indexOf("re:")>-1?r(t):e(t,o,n):t.cmd?(t.name="toVault",e(t,o,n)):["chromex.dispatch","chromex.patch_state","chromex.state"].includes(t.type)}},sendMessage:function(e,o,n){var s;const r=JSON.parse(JSON.stringify({name:e,params:o}));if("undefined"==typeof chrome||t)t&&Promise.resolve().then((()=>browser.runtime.sendMessage(r))).then((e=>{n&&n(e)})).catch((()=>{}));else try{chrome.runtime.sendMessage(r,(function(e){chrome.runtime.lastError,n&&n(e)}))}catch(e){}"undefined"!=typeof chrome&&null!==(s=chrome.runtime)&&void 0!==s&&s.lastError}};class s{constructor(){o(this,"bucket",new Map)}register(e){const t="k-"+Math.random().toString(36).substr(2);return this.bucket.set(t,e),t}invoke(e,...t){const o=this.bucket.get(e);o&&(this.bucket.delete(e),o(...t))}}function r(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return}e.callbackId&&window.messageCallbacks.invoke(e.callbackId,e.data)}window.messageCallbacks||(window.messageCallbacks=new s);let a=function(e){return e.GET="GET",e.SET="SET",e.ACTION="ACTION",e}({}),E=function(e){return e.ACCOUNT_SHARE_CONFIRMATION="accountShareConfirmation",e.CHANGE_PASSWORD_FORM_SUBMITTED="changePasswordFormSubmitted",e.CHANGE_PASSWORD_REPOSITION="changePasswordReposition",e.CHANGE_PASSWORD_SHOW_REVERT_SCREEN="changePasswordShowRevertScreen",e.CHANGE_TARGETED_LOCK="changeTargetedLock",e.CHECK_CHANGED_PASSWORD="checkChangedPassword",e.CHECK_IF_SSO_LOGIN_SCREEN="checkIfSSOLoginScreen",e.CHECK_SSO_PAGE_ON_PREM="checkSSOPageOnPrem",e.CHECK_SSO_PAGE_CLOUD="checkSSOPageCloud",e.CLEANUP_DETECTION_TESTS="cleanupDetectionTests",e.CLEAR_ALL_STORAGE="clearAllStorage",e.CLEAR_IDB_STORAGE="clearIDBStorage",e.CLEAR_LOCAL_STORAGE="clearLocalStorage",e.CLEAR_THROTTLE_STATE="clearThrottleState",e.CLEAR_LOCAL_STORAGE_DEVLOGS="clearLocalStorageDevlogs",e.CLOSE_EDIT_CREATE_MENU="closeEditCreateMenu",e.CLOSE_FRAME="closeFrame",e.CLOSE_HOVER_DATA="closeHoverData",e.CLOSE_INPUT_HELPER="closeInputHelper",e.CLOSE_RECORD_LIST="closeRecordList",e.CLOSE_TAB_SSO_AMH="closeTabSso",e.CONFIRM_THIS_MESSAGE="confirmThisMessage",e.DEBUG_PAGE="openDebugPage",e.DEVLOGS_ADD="devlogsAdd",e.DISABLE_LOCKS="disableLocks",e.DISPLAY_IFRAME_ERROR_MESSAGE="displayIframeErrorMessage",e.DUO_SELECTION="duoSelection",e.EDIT_DONE="editDone",e.EDIT_MODE="editMode",e.ENABLE_HUMIO_FIX="enableHumioFix",e.FILL_CUSTOM_FIELDS="fillCustomFields",e.FILL_GIVEN_AUTOFILL_RECORD="fillGivenAutofillRecord",e.FILL_NON_SECURE_SITE="fillNonSecureSite",e.FILL_BASIC_AUTH="fillBasicAuth",e.FRAME_FILL_FIELD="frameFillField",e.GET_INPUT_VALUE_FOR_LOCK="getInputValueForLock",e.GIVE_RECORD_TOTP_IN_CUSTOM_FOR_FILLING="giveRecordTotpInCustomForFilling",e.HANDLE_VAULT_MESSAGE_AMH="handleVaultMessage",e.INIT_INJECTED_SCRIPT="initInjectedScript",e.IS_POPUP_ATTACHED_TO_LOCK="isPopupAttachedToLock",e.LOAD_EXTENSION_CONTENTS="loadExtensionContents",e.MAKE_DRAGGABLE_ELEMENT_UNMOVABLE="makeDraggableElementUnmovable",e.MAKE_VOICE_OVER_ALERT="makeVoiceOverAlert",e.MASTER_PASSWORD_REENTRY_ACTION="masterPasswordReentryAction",e.MATCH_MEDIA_REQUEST="matchMediaRequest",e.MATCH_MEDIA_THEME_REQUEST="matchMediaThemeRequest",e.CHECK_DARK_MODE_META="checkDarkModeMeta",e.USE_DARK_MODE_HEADER="useDarkModeMeta",e.OPEN_PROMPT_FROM_DISABLE_TAB="openPromptFromDisableTab",e.OPEN_PROMPT_FROM_GROUPS="openPromptFromGroupsThunk",e.OPEN_PROMPT_FROM_IS_APPENDED_TO_LOCK="openPromptFromIsAppendedToLock",e.OPEN_PROMPT_FROM_OPEN_TO_SPECIFIC_SCREEN="openPromptFromOpenToSpecificScreen",e.OPEN_PROMPT_FROM_REVERT_SCREEN="openPromptFromRevertScreen",e.OPEN_PROMPT_FROM_SHOW_LOGGED_OUT_KEEPER="openPromptFromShowLoggedOutKeeper",e.OPEN_PROMPT_FROM_SHOW_PROMPT="openPromptFromShowPrompt",e.OPEN_PROMPT_FROM_EXTENSION_PAGE="openPromptFromExtensionPage",e.PING="ping",e.POST_MESSAGE_TO_ALL_IFRAMES="postMessageToAllIframes",e.REMOVE_CONTENT_SCRIPTS_V3="removeContentScripts",e.REMOVE_DO_NOT_PROMPT="remove_do_not_prompt",e.REMOVE_INPUT_OBSERVERS="removeInputObservers",e.REPOSITION_FRAME="repositionFrame",e.REPOSITION_OVERLAY="repositionOverlay",e.REQUEST_ADMIN_APPROVAL="request_admin_approval",e.REQUEST_RESPONSE="requestResponse",e.RESET_EXTENSION="resetExtension",e.RESET_INACTIVITY_TIMEOUT_AMH="resetInactivityTimeout",e.RESTORE_LOCKS="restoreLocks",e.REVERT_MOVABLE_HEADER="revertMovableHeader",e.ROLE_ENFORCEMENT_RESTRICTION="roleEnforcementRestriction",e.SAVE_PROMPT_VIEW_RECORD_SCREEN="savePromptViewRecordScreen",e.SEND_KEEPER_PUSH="send_keeper_push",e.SEND_KEY_TO_INPUT_ON_PAGE="sendKeyToInputOnPage",e.SEND_SEARCH_RESULTS="sendSearchResults",e.SHOW_CHANGE_PROMPT="showChangePrompt",e.SHOW_CHANGE_PASSWORD_FROM_CS="showChangePasswordFromCS",e.SHOW_EXTENSION_FROM_FRAME="showExtensionFromFrame",e.SHOW_EXTENSION_FROM_FRAME_BY_PROMPT="showExtensionFromFrameByPrompt",e.SHOW_HOVER_DATA="showHoverData",e.SHOW_KEEPER_NOT_APPENDED_TO_LOCK="showKeeperNotAppendedToLock",e.SHOW_INPUT_HELPER="showInputHelper",e.SHOW_LOCAL_STORAGE="showLocalStorage",e.SHOW_IDB_STORAGE="showIDBStorage",e.SHOW_MP_REENTRY_ERROR_POPUP="showMPRentryErrorPopup",e.SHOW_PASSKEY_PROMPT="showPasskeyPrompt",e.SHOW_PROMPT_FROM_FRAME="showPromptFromFrame",e.SHOW_PREVIEW="showPreview",e.SHOW_REVIEW_SAVED_RECORD="showReviewSavedRecord",e.SSO_ACCOUNT_NEEDS_RESOLUTION="ssoAccountNeedsResolution",e.SSO_LOGIN="sso_login",e.TEST_ACTION="testAction",e.TEST_REMOVE_DOMAIN="testRemoveDomain",e.TEST_REMOVE_SUBDOMAIN="testRemoveSubdomain",e.SETUP_DETECTION_TESTS="setupDetectionTests",e.START_OBSERVER="startObserver",e.START_PROMPTS="startPrompts",e.SUPPLY_TRY_TO_PROMPT="supplyTryToPrompt",e.TOGGLE_LISTENER_FOR_CHANGE_PASSWORD_SUBMISSION="toggleListenerForChangePasswordSubmission",e.TRY_SHOULD_FIXINATOR_PROMPT="tryShouldFixinatorPrompt",e.UPDATE_EXTENSION_CLASSES="updateExtensionClasses",e.UPDATE_INPUT_OBSERVER="updateInputObserver",e.UPDATE_LOCKS_PAYLOAD="updateLocksPayload",e.USE_BACKUP_2FA="useBackup2FA",e.VALIDATE_2FA="validate_2fa",e.VAULT_VERSION_CHECK="vaultVersionCheck",e.WEBAUTHN_RESPONSE="webauthnResponse",e.STEAL_FOCUS="stealFocus",e.OPEN_EXTENSION_PAGE_IN_BG="openExtensionPageInBg",e}({}),_=function(e){return e.CREATE="create",e.READ="read",e.UPDATE="update",e.DELETE="delete",e.RETRIEVE_BULK_RECORDS="retrieveBulkRecords",e.RETRIEVE_DOMAIN_ARRAY="retrieveDomainArray",e.RETRIEVE_RECORDS_BY_DOMAIN="retrieveRecordsByDomain",e.STORE_BULK_RECORDS="storeBulkRecords",e.STORE_DOMAIN_ARRAY="storeDomainArray",e.DETECTION="detection",e.THROTTLE="throttle",e.DEBUG_PAGE="debugPage",e.SYNC_TEST="sync",e.PUT_BULK_LARGE="putBulkIntoCacheAndIndexeddbLarge",e.PUT_BULK_SMALL="putBulkIntoCacheAndIndexeddbSmall",e.FILL_USER_LIST="fillUserList",e.CLEAR_LOCAL_STORAGE_DEVLOGS="clearLocalStorageDevlogs",e}({});function c(e){return`Use this button to clear ${e} of the extension:`}function i(e){return`Use this button to show ${e} of the extension:`}function O(e){const{container:t,desc:o,button:n,input:s}=e,r=document.createElement("div"),a=document.createElement("div"),E=document.createElement("button"),_=document.createElement("input");r.appendChild(a),s&&(r.appendChild(_),_.className=s.classes.join(" "),_.id=s.id),r.appendChild(E),r.className=t.classes.join(" "),r.id=t.id,a.className=o.classes.join(" "),a.textContent=o.text,E.className=n.classes.join(" "),E.textContent=n.text,E.onclick=n.buttonAction,document.body.appendChild(r)}document.addEventListener("DOMContentLoaded",(function(){const e=[{container:{classes:["clear-storage-container"],id:"local-storage"},desc:{classes:["clear-storage-desc"],text:c("the local storage")},button:{classes:["clear-storage-button"],text:"Clear Local Storage",buttonAction:()=>{n.sendMessage(E.CLEAR_LOCAL_STORAGE,{type:a.ACTION})}}},{container:{classes:["clear-storage-container"],id:"indexeddb-storage"},desc:{classes:["clear-storage-desc"],text:c("the indexeddb")},button:{classes:["clear-storage-button"],text:"Clear Indexeddb Storage",buttonAction:()=>{n.sendMessage(E.CLEAR_IDB_STORAGE,{type:a.ACTION})}}},{container:{classes:["clear-storage-container"],id:"all-storage"},desc:{classes:["clear-storage-desc"],text:c("all storage")},button:{classes:["clear-storage-button"],text:"Clear All Storage",buttonAction:()=>{n.sendMessage(E.CLEAR_ALL_STORAGE,{type:a.ACTION})}}},{container:{classes:["show-storage-container"],id:"reveal-local-storage"},desc:{classes:["show-storage-desc"],text:i("the local storage")},button:{classes:["show-storage-button"],text:"Show Local Storage",buttonAction:()=>{n.sendMessage(E.SHOW_LOCAL_STORAGE,{type:a.ACTION})}}},{container:{classes:["show-storage-container"],id:"reveal-idb-storage"},desc:{classes:["show-storage-desc"],text:i("the idb storage")},button:{classes:["show-storage-button"],text:"Show IDB Storage",buttonAction:()=>{n.sendMessage(E.SHOW_IDB_STORAGE,{type:a.ACTION})}}}];for(const t of e)O(t);const t=[];0;0;0;for(const e of t){const t=document.createElement("div"),o=document.createElement("div"),s=document.createElement("button"),r=document.createElement("div");switch(t.classList.add("clear-storage-container"),o.classList.add("clear-storage-desc"),s.classList.add("clear-storage-button"),e){case _.SYNC_TEST:case _.PUT_BULK_LARGE:case _.PUT_BULK_SMALL:o.textContent="Can only be tested while logged in";break;default:o.textContent="Test Function"}s.textContent="Test "+e,s.onclick=()=>{n.sendMessage(E.TEST_ACTION,{type:a.ACTION,data:{[e]:!0}},(e=>{r&&(r.textContent=e||"")}))},t.appendChild(o),t.appendChild(s),t.appendChild(r),document.body.appendChild(t)}}),!1)})();