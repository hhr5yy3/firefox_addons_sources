!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o=0,r=1,i="#9400ff",l="#ffe900",s=1,a=2,d=0,c=1,u=2,g=3,b="#f9f9fa",f="#38383d";const p={showNumbers:!0,roundCorners:!1,darkTheme:!1,doPageFocus:!0,newTabActive:!0,kbdnavOn:!0};Object.freeze(p);let y,m=!1,k=!1,h=!1,w=document.createElement("div");w.id="navCurtain";let C=document.createElement("div");C.id="previewRect";let v=document.createElement("img");v.id="closeBtn";let A=document.createElement("label");A.id="addressLabel";let x=document.createElement("div");x.id="miniature";let E=document.createElement("div");E.id="iconPlusCaption";let L=document.createElement("img");L.id="iconImg";let O=document.createElement("label");O.id="captionLabel";let M=document.createElement("label");M.id="hints",M.style.display="none";let I,S,P=!1;function T(){v.src="data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",C.appendChild(v),C.appendChild(A),C.appendChild(x),E.appendChild(L),E.appendChild(O),C.appendChild(E),C.appendChild(M),w.appendChild(C),document.body.appendChild(w),M.textContent=browser.i18n.getMessage("kbdNavHints"),M.innerHTML=M.innerHTML.replace(/\n/g,"<br/>"),P=!0}function j(e){if("Control"!==e.key||m?"Shift"===e.key&&m&&(k=!0):(browser.storage.local.get("structure").then(z,_),m=!0,k=!1,y="",S=null),m){if("Backspace"===e.key&&y.length>0)y=y.substring(0,y.length-1),A.textContent=y,0==y.length&&R(!1);else if("+"!==e.key&&"-"!==e.key||!h){const t=/^(Digit|Numpad|)(\d)$/;let n;if(null!==(n=t.test(e.code)?e.code.replace(t,"$2"):"/"===e.key||" "===e.key?"/":null)){let e=y+n;/^([1-9]\d{0,2}\/)*([1-9]\d{0,2}\/?)$/.test(e)&&(P||T(),h||R(!0),y=e,A.textContent=e)}}else if("/"===y[y.length-1])y+="1";else{let t=y.lastIndexOf("/"),n=y.substring(0,t+1),o=+y.substring(t+1);"+"===e.key&&o<999?y=n+(o+1):"-"===e.key&&o>1&&(y=n+(o-1))}A.textContent=y,B(S=function(e){"string"===(typeof e).toLowerCase()&&(e=e.split("/"));e=e.filter(e=>""!=e);let t=I,n=e[e.length-1];e.pop();let o=!0;for(let n=0;o&&n<e.length;++n)t=t.elements[e[n]-1],o=t&&t.type==a;let r=o?t.elements[n-1]:{type:-1};return r||{type:-1}}(y))}h&&e.preventDefault()}function H(e){if("Control"===e.key&&m&&(m=!1,R(!1),S))switch(S.type){case s:browser.runtime.sendMessage({command:o,url:S.url,newTab:k});break;case a:browser.runtime.sendMessage({command:r,folder:S,path:y,newTab:k})}}function R(e){e?(h=!0,w.style.display="flex",M.style.display="initial"):(h=!1,w.style.display="none")}function z(e){e.structure?I=e.structure:_()}function _(e){B({type:-1})}function B(e){switch(e.type){case a:if(e.isMiniatureHidden)x.style.backgroundColor=i,x.style.backgroundImage="url('"+browser.extension.getURL("icons/hidden-miniature-placeholder.svg")+"')",x.style.backgroundSize="200px";else{switch(e.bgtype){case d:(async function(){let e;return await browser.storage.local.get(["settings"]).then(function(t){t.settings&&(e=t.settings.darkTheme?f:b)}),e})().then(function(e){x.style.backgroundColor=e}),x.style.backgroundImage="";break;case c:x.style.backgroundColor=e.bgdata,x.style.backgroundImage="";break;case u:case g:x.style.backgroundColor="",x.style.backgroundImage="url('"+e.bgdata+"')"}x.style.backgroundSize="cover"}L.src=browser.extension.getURL("icons/folder.svg"),e.isCaptionHidden?O.textContent="":O.textContent=e.caption+" ("+e.cols+"x"+e.rows+")";break;case s:e.isMiniatureHidden?(x.style.backgroundColor=i,x.style.backgroundImage="url('"+browser.extension.getURL("icons/hidden-miniature-placeholder.svg")+"')",x.style.backgroundSize="200px"):(x.style.backgroundColor="",x.style.backgroundImage="url('"+e.miniature+"')",x.style.backgroundSize="cover"),L.src=e.icon,e.isCaptionHidden?O.textContent="":O.textContent=e.caption;break;default:x.style.backgroundColor=l,x.style.backgroundImage="url('"+browser.extension.getURL("icons/nothing-found.svg")+"')",x.style.backgroundSize="150px",L.src="",O.textContent=browser.i18n.getMessage("elementIsNotFound")}}browser.storage.local.get("structure").then(z,_),browser.storage.local.get(["settings"]).then(function(e){(function(e){let t={};e.settings&&(t=e.settings);let n=!1;for(let e in p)e in t||(t[e]=p[e],n=!0);return n&&browser.storage.local.set({settings:t}),t})(e).kbdnavOn&&(T(),window.addEventListener("keydown",j),window.addEventListener("keyup",H),v.onclick=function(e){window.removeEventListener("keydown",j),window.removeEventListener("keyup",H),document.body.removeChild(w)})},function(e){console.log(e)})}]);