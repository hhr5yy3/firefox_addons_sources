/*! For license information please see bundle.js.LICENSE.txt */
var source=function(t){function e(e){for(var i,a,o=e[0],l=e[1],c=e[2],h=0,d=[];h<o.length;h++)a=o[h],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&d.push(s[a][0]),s[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(u&&u(e);d.length;)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,o=1;o<n.length;o++){var l=n[o];0!==s[l]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},s={1:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var o=window.webpackJsonpsource=window.webpackJsonpsource||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;return r.push([114,0]),n()}({114:function(t,e,n){t.exports=n(135)},115:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(20)),r=n(28);class a extends r.AddonsFrameworkBrowserInterface{constructor(){super(),this.tabManager=[],this.fnCallbacks={},this.oPendingNavigates={},s.default.tabs.onActivated.addListener(t=>{this.oPendingNavigates[t.tabId]&&this.navigate(this.oPendingNavigates[t.tabId]),s.default.tabs.get(t.tabId).then(e=>{s.default.runtime.lastError||this.tabChanged({url:e&&e.url?e.url:"",id:t.tabId})})}),s.default.windows.onFocusChanged.addListener(t=>{t!==s.default.windows.WINDOW_ID_NONE&&s.default.tabs.query({windowId:t,active:!0}).then(t=>{t&&this.tabChanged(t.pop())})}),s.default.tabs.onRemoved.addListener(t=>{this.tabManager.splice(t,1),this.fireEvent(r.TabEvent.TABCLOSED,{name:r.TabEvent.TABCLOSED,tabId:t,url:this.tabManager[t]&&this.tabManager[t].url?this.tabManager[t].url:""})}),s.default.tabs.onUpdated.addListener((t,e)=>{e.url&&(this.tabManager[t]={url:e.url},this.fireEvent(r.TabEvent.TABUPDATED,{name:r.TabEvent.TABUPDATED,tabId:t,url:e.url}))}),s.default.webNavigation&&(s.default.webNavigation.onCommitted.addListener(t=>{this.fireWebNavigationEvent(r.TabEvent.NAVIGATIONCOMMITTED,t)}),s.default.webNavigation.onDOMContentLoaded.addListener(t=>{this.fireWebNavigationEvent(r.TabEvent.DOCUMENTCOMPLETE,t)})),s.default.webRequest.onBeforeRequest.addListener(t=>{0===t.frameId&&t.url&&this.fireEvent(r.TabEvent.BEFORENAVIGATE,{name:r.TabEvent.BEFORENAVIGATE,tabId:t.tabId,url:t.url})},{urls:["<all_urls>"],types:["main_frame"]})}fireWebNavigationEvent(t,e){0===e.frameId&&s.default.tabs.get(e.tabId).then(n=>{!s.default.runtime.lastError&&n&&this.fireEvent(t,{name:t,tabId:e.tabId,url:e.url,active:n.active})}).catch(()=>{})}navigate(t,e=(()=>{})){const n=new Promise(e=>{let n;n="string"==typeof t?{url:t,tabId:r.TabIdType.NEWTAB}:t;const i=n.tabId||r.TabIdType.CURRENTTAB,a={url:n.url};switch(i){case r.TabIdType.NEWTAB:a.active=!0,void 0!==n.active&&(a.active=n.active),void 0!==n.pinned&&(a.pinned=n.pinned),s.default.tabs.create(a).then(e);break;case r.TabIdType.BACKGROUNDTAB:a.active=!1,void 0!==n.pinned&&(a.pinned=n.pinned),s.default.tabs.create(a).then(e);break;case r.TabIdType.CURRENTTAB:this.redirect(n.url).then(e);break;case r.TabIdType.NEWWINDOW:a.focused=!0,s.default.windows.create(a).then(e);break;case r.TabIdType.ALLTABS:s.default.windows.getAll({populate:!0}).then(t=>{t.forEach(t=>{t.tabs&&t.tabs.forEach((function(t){s.default.tabs.update(t.id,a)}))}),e(null)});break;default:s.default.tabs.get(n.tabId).then(t=>{!s.default.runtime.lastError&&t?(s.default.tabs.update(n.tabId,a).then(e),delete this.oPendingNavigates[n.tabId]):this.oPendingNavigates[n.tabId]=n})}});return n.then(e),n}redirect(t,e=(()=>{})){const n=new Promise(e=>{const n="string"==typeof t?t:t.url;s.default.tabs.query({active:!0,currentWindow:!0}).then(t=>{t.length>0&&s.default.tabs.update(t[0].id,{url:n}),e(t[0])})});return n.then(e,e),n}attachEvent(t,e){this.fnCallbacks[t]||(this.fnCallbacks[t]=[]),this.fnCallbacks[t].push(e)}detachEvent(t,e){if(this.fnCallbacks[t])for(let n=this.fnCallbacks[t].length-1;n>=0;n--)this.fnCallbacks[t][n]&&e===this.fnCallbacks[t][n]&&(delete this.fnCallbacks[t][n],this.fnCallbacks[t].splice(n,1))}fireEvent(t,e){this.fnCallbacks[t]&&this.fnCallbacks[t].forEach(t=>{t&&t.call(this,e)})}tabChanged(t){if(t){const e={action:"event",data:{name:r.TabEvent.TABCHANGED,tabId:t.id,url:t.url}};t.url&&0!==t.url.indexOf("chrome://")&&s.default.tabs.sendMessage(t.id,e).catch(t=>{}),this.fireEvent(r.TabEvent.TABCHANGED,e.data)}}removeTab(t){s.default.tabs.remove("number"==typeof t?t:t.id)}}e.default=a,a.prototype.closeTab=a.prototype.removeTab,a.prototype.on=a.prototype.attachEvent,a.prototype.emit=a.prototype.fireEvent},116:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(20)),r=n(28);class a{constructor(t){this.fnCallbacks={},this.root=t;const e=s.default.runtime.getManifest();this.settings={name:e.name,version:e.version,optionsPage:e.options_ui},s.default.runtime.onMessage.addListener((e,n)=>new Promise(i=>{let a,o;switch(e.action){case"event":o=e.name,a={name:o,url:n.tab?n.tab.url:n.url},n.tab&&(a.tabId=n.tab.id),e.data&&(a.data=e.data.data),e.data&&e.data.tabId?(a.action="event",e.data.tabId===r.TabIdType.ALLTABS?this.broadcastEvent(a).then(i):s.default.tabs.sendMessage(e.data.tabId,a).then(i)):this.fnCallbacks[o]&&this.fnCallbacks[o].forEach(t=>{2===t.length?t.call(this,a,i):(t.call(this,a),i(null))});break;case"ci_browser_navigate":t.browser.navigate(e).then(i);break;case"ci_browser_redirect":t.browser.redirect(e).then(i);break;case"ci_extension_getSettings":i({name:this.name,version:this.version})}})),s.default.runtime.onMessageExternal&&s.default.runtime.onMessageExternal.addListener((t,e)=>new Promise(n=>{if("event"===t.action&&e.id){const i=t.name,s={name:i,url:e.tab?e.tab.url:e.url,extensionId:e.id};t.data&&(s.data=t.data.data),e.tab&&(s.tabId=e.tab.id),this.fnCallbacks[i]?this.fnCallbacks[i].forEach(t=>{2===t.length?t.call(this,s,n):(t.call(this,s),n(null))}):n(null)}else n(null)}))}attachEvent(t,e){this.fnCallbacks[t]||(this.fnCallbacks[t]=[]),this.fnCallbacks[t].push(e)}detachEvent(t,e){if(this.fnCallbacks[t])for(let n=this.fnCallbacks[t].length-1;n>=0;n--)this.fnCallbacks[t][n]&&e===this.fnCallbacks[t][n]&&(delete this.fnCallbacks[t][n],this.fnCallbacks[t].splice(n,1))}fireEvent(t,e={},n=function(){}){const i={action:"event",name:t,data:e};const a=new Promise(n=>{var a;e.extensionId?s.default.runtime.sendMessage(e.extensionId,i).then(n):e.tabId===r.TabIdType.ALLTABS?this.broadcastEvent(i).then(n):(a=e.tabId,!isNaN(parseInt(a,10))&&isFinite(a)&&e.tabId>=0?s.default.tabs.sendMessage(e.tabId,i).then(n).catch(t=>{}):s.default.tabs.query({active:!0,currentWindow:!0}).then(t=>{t&&t[0]&&t[0].id&&t[0].url&&-1===t[0].url.indexOf("chrome://")&&s.default.tabs.sendMessage(t[0].id,i).then(n).catch(t=>{})})),this.fnCallbacks[t]&&this.fnCallbacks[t].forEach(t=>{t.call(this,e,n)})});return a.then(n,n),a}getItem(t,e=(()=>{})){const n=new Promise(e=>{"string"==typeof t||Array.isArray(t)?s.default.storage.local.get(t).then(n=>{e("string"==typeof t?n?n[t]:null:n)}):e(null)});return n.then(e),n}setItem(t,e){if("string"==typeof t)if(void 0===e)s.default.storage.local.remove(t);else{const n={};n[t]=e,s.default.storage.local.set(n)}else"object"==typeof t&&s.default.storage.local.set(t)}getURL(t){return s.default.runtime.getURL(t)}broadcastEvent(t){return s.default.windows.getAll({populate:!0}).then(e=>new Promise(n=>{e.forEach(e=>{e.tabs&&e.tabs.forEach(e=>{e.id&&e.url&&-1===e.url.indexOf("chrome://")&&-1===e.url.indexOf("about:")&&s.default.tabs.sendMessage(e.id,t).then(n).catch(t=>{})})})}))}get name(){return this.settings.name}get version(){return this.settings.version}get optionsPage(){return this.settings.optionsPage}}e.default=a,a.prototype.on=a.prototype.attachEvent,a.prototype.emit=a.prototype.fireEvent},117:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(20));class r{constructor(){this.advised=!1,this.listners=[],this.CLICK="ButtonClick";const t=s.default.runtime.getManifest();t.action?this.actionReference=s.default.action:t.browser_action&&(this.actionReference=s.default.browserAction)}onButtonClick(t){for(let e=0;e<this.listners.length;e++)try{this.listners[e]({tabId:t.id,url:t.url,name:this.CLICK})}catch(t){}}attachEvent(t,e){t===this.CLICK&&(this.advised||(this.actionReference&&this.actionReference.onClicked.addListener(this.onButtonClick.bind(this)),this.advised=!0),this.listners.push(e))}detachEvent(t,e){if(t===this.CLICK){for(let t=0;t<this.listners.length;t++)this.listners[t]===e&&(this.listners.splice(t,1),t--);0===this.listners.length&&(this.advised=!1,this.actionReference&&this.actionReference.onClicked.removeListener(this.onButtonClick.bind(this)))}}setIcon(t){this.actionReference&&(this.actionReference!==s.default.browserAction&&this.actionReference!==s.default.action||this.actionReference.setIcon({path:t}))}setPopup(t){if(!this.actionReference)return;const e=t?t.url:"";this.actionReference!==s.default.browserAction&&this.actionReference!==s.default.action||this.actionReference.setPopup({popup:e})}setTitle(t){this.actionReference&&(this.actionReference!==s.default.browserAction&&this.actionReference!==s.default.action||this.actionReference.setTitle({title:t}))}setBadgeText(t){"string"!=typeof t&&(t=t.toString()),this.actionReference&&"setBadgeText"in this.actionReference&&this.actionReference.setBadgeText({text:t.toString()})}setBadgeBackgroundColor(t){this.actionReference&&"setBadgeBackgroundColor"in this.actionReference&&this.actionReference.setBadgeBackgroundColor({color:function(t){const e=/rgb\((\d+), (\d+), (\d+)\)/.exec(t);if(e)return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),255];{const e=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return[e>>16,(65280&e)>>8,255&e,255]}}(t)})}setBadgeColor(){}}e.default=r,r.prototype.on=r.prototype.attachEvent},118:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(20));e.default=class{constructor(t){this.root=t}open(){if(s.default.runtime.openOptionsPage)s.default.runtime.openOptionsPage();else{const t=this.root.extension.optionsPage;t&&this.root.browser.navigate({url:t,tabId:this.root.browser.NEWTAB})}}}},119:function(t,e,n){"use strict";var i=n(120),s=n(17),r=n(68),a=n(29),o=n(69),l=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=s.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(a[n]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var u;if(u="string"==typeof e.dictionary?r.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=i.deflateSetDictionary(this.strm,u)))throw new Error(a[n]);this._dict_set=!0}}function u(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(t,e){var n,a,o=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=r.string2buf(t):"[object ArrayBuffer]"===l.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new s.Buf8(c),o.next_out=0,o.avail_out=c),1!==(n=i.deflate(o,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(r.buf2binstring(s.shrinkBuf(o.output,o.next_out))):this.onData(s.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),o.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=c,e.deflate=u,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,u(t,e)}},120:function(t,e,n){"use strict";var i,s=n(17),r=n(121),a=n(66),o=n(67),l=n(29);function c(t,e){return t.msg=l[e],e}function u(t){return(t<<1)-(t>4?9:0)}function h(t){for(var e=t.length;--e>=0;)t[e]=0}function d(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(s.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function f(t,e){r._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,d(t.strm)}function g(t,e){t.pending_buf[t.pending++]=e}function p(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function m(t,e){var n,i,s=t.max_chain_length,r=t.strstart,a=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+258,f=c[r+a-1],g=c[r+a];t.prev_length>=t.good_match&&(s>>=2),o>t.lookahead&&(o=t.lookahead);do{if(c[(n=e)+a]===g&&c[n+a-1]===f&&c[n]===c[r]&&c[++n]===c[r+1]){r+=2,n++;do{}while(c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&r<d);if(i=258-(d-r),r=d-258,i>a){if(t.match_start=e,a=i,i>=o)break;f=c[r+a-1],g=c[r+a]}}}while((e=h[e&u])>l&&0!=--s);return a<=t.lookahead?a:t.lookahead}function v(t){var e,n,i,r,l,c,u,h,d,f,g=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=g+(g-262)){s.arraySet(t.window,t.window,g,g,0),t.match_start-=g,t.strstart-=g,t.block_start-=g,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=g?i-g:0}while(--n);e=n=g;do{i=t.prev[--e],t.prev[e]=i>=g?i-g:0}while(--n);r+=g}if(0===t.strm.avail_in)break;if(c=t.strm,u=t.window,h=t.strstart+t.lookahead,d=r,f=void 0,(f=c.avail_in)>d&&(f=d),n=0===f?0:(c.avail_in-=f,s.arraySet(u,c.input,c.next_in,f,h),1===c.state.wrap?c.adler=a(c.adler,u,f,h):2===c.state.wrap&&(c.adler=o(c.adler,u,f,h)),c.next_in+=f,c.total_in+=f,f),t.lookahead+=n,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function b(t,e){for(var n,i;;){if(t.lookahead<262){if(v(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=m(t,n)),t.match_length>=3)if(i=r._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=r._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function w(t,e){for(var n,i,s;;){if(t.lookahead<262){if(v(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=m(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-3,i=r._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=s&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(f(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=r._tr_tally(t,0,t.window[t.strstart-1]))&&f(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=r._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}function _(t,e,n,i,s){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=s}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(1146),this.dyn_dtree=new s.Buf16(122),this.bl_tree=new s.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(16),this.heap=new s.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function x(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,r._tr_init(e),0):c(t,-2)}function k(t){var e,n=x(t);return 0===n&&((e=t.state).window_size=2*e.w_size,h(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function A(t,e,n,i,r,a){if(!t)return-2;var o=1;if(-1===e&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||8!==n||i<8||i>15||e<0||e>9||a<0||a>4)return c(t,-2);8===i&&(i=9);var l=new y;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new s.Buf8(2*l.w_size),l.head=new s.Buf16(l.hash_size),l.prev=new s.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new s.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=n,k(t)}i=[new _(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(v(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,f(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(f(t,!1),t.strm.avail_out),1)})),new _(4,4,8,4,b),new _(4,5,16,8,b),new _(4,6,32,32,b),new _(4,4,16,16,w),new _(8,16,32,32,w),new _(8,16,128,128,w),new _(8,32,128,256,w),new _(32,128,258,1024,w),new _(32,258,258,4096,w)],e.deflateInit=function(t,e){return A(t,e,8,15,8,0)},e.deflateInit2=A,e.deflateReset=k,e.deflateResetKeep=x,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},e.deflate=function(t,e){var n,s,a,l;if(!t||!t.state||e>5||e<0)return t?c(t,-2):-2;if(s=t.state,!t.output||!t.input&&0!==t.avail_in||666===s.status&&4!==e)return c(t,0===t.avail_out?-5:-2);if(s.strm=t,n=s.last_flush,s.last_flush=e,42===s.status)if(2===s.wrap)t.adler=0,g(s,31),g(s,139),g(s,8),s.gzhead?(g(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),g(s,255&s.gzhead.time),g(s,s.gzhead.time>>8&255),g(s,s.gzhead.time>>16&255),g(s,s.gzhead.time>>24&255),g(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),g(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(g(s,255&s.gzhead.extra.length),g(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(t.adler=o(t.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(g(s,0),g(s,0),g(s,0),g(s,0),g(s,0),g(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),g(s,3),s.status=113);else{var m=8+(s.w_bits-8<<4)<<8;m|=(s.strategy>=2||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(m|=32),m+=31-m%31,s.status=113,p(s,m),0!==s.strstart&&(p(s,t.adler>>>16),p(s,65535&t.adler)),t.adler=1}if(69===s.status)if(s.gzhead.extra){for(a=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),d(t),a=s.pending,s.pending!==s.pending_buf_size));)g(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){a=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),d(t),a=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,g(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),0===l&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){a=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),d(t),a=s.pending,s.pending===s.pending_buf_size)){l=1;break}l=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,g(s,l)}while(0!==l);s.gzhead.hcrc&&s.pending>a&&(t.adler=o(t.adler,s.pending_buf,s.pending-a,a)),0===l&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&d(t),s.pending+2<=s.pending_buf_size&&(g(s,255&t.adler),g(s,t.adler>>8&255),t.adler=0,s.status=113)):s.status=113),0!==s.pending){if(d(t),0===t.avail_out)return s.last_flush=-1,0}else if(0===t.avail_in&&u(e)<=u(n)&&4!==e)return c(t,-5);if(666===s.status&&0!==t.avail_in)return c(t,-5);if(0!==t.avail_in||0!==s.lookahead||0!==e&&666!==s.status){var b=2===s.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(v(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=r._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(s,e):3===s.strategy?function(t,e){for(var n,i,s,a,o=t.window;;){if(t.lookahead<=258){if(v(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=o[s=t.strstart-1])===o[++s]&&i===o[++s]&&i===o[++s]){a=t.strstart+258;do{}while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<a);t.match_length=258-(a-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=r._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=r._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(f(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(f(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(f(t,!1),0===t.strm.avail_out)?1:2}(s,e):i[s.level].func(s,e);if(3!==b&&4!==b||(s.status=666),1===b||3===b)return 0===t.avail_out&&(s.last_flush=-1),0;if(2===b&&(1===e?r._tr_align(s):5!==e&&(r._tr_stored_block(s,0,0,!1),3===e&&(h(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),d(t),0===t.avail_out))return s.last_flush=-1,0}return 4!==e?0:s.wrap<=0?1:(2===s.wrap?(g(s,255&t.adler),g(s,t.adler>>8&255),g(s,t.adler>>16&255),g(s,t.adler>>24&255),g(s,255&t.total_in),g(s,t.total_in>>8&255),g(s,t.total_in>>16&255),g(s,t.total_in>>24&255)):(p(s,t.adler>>>16),p(s,65535&t.adler)),d(t),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?c(t,-2):(t.state=null,113===e?c(t,-3):0):-2},e.deflateSetDictionary=function(t,e){var n,i,r,o,l,c,u,d,f=e.length;if(!t||!t.state)return-2;if(2===(o=(n=t.state).wrap)||1===o&&42!==n.status||n.lookahead)return-2;for(1===o&&(t.adler=a(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(h(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new s.Buf8(n.w_size),s.arraySet(d,e,f-n.w_size,n.w_size,0),e=d,f=n.w_size),l=t.avail_in,c=t.next_in,u=t.input,t.avail_in=f,t.next_in=0,t.input=e,v(n);n.lookahead>=3;){i=n.strstart,r=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=2,v(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=c,t.input=u,t.avail_in=l,n.wrap=o,0},e.deflateInfo="pako deflate (from Nodeca project)"},121:function(t,e,n){"use strict";var i=n(17);function s(t){for(var e=t.length;--e>=0;)t[e]=0}var r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);s(c);var u=new Array(60);s(u);var h=new Array(512);s(h);var d=new Array(256);s(d);var f=new Array(29);s(f);var g,p,m,v=new Array(30);function b(t,e,n,i,s){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=s,this.has_stree=t&&t.length}function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function _(t){return t<256?h[t]:h[256+(t>>>7)]}function y(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function x(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,y(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function k(t,e,n){x(t,n[2*e],n[2*e+1])}function A(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function S(t,e,n){var i,s,r=new Array(16),a=0;for(i=1;i<=15;i++)r[i]=a=a+n[i-1]<<1;for(s=0;s<=e;s++){var o=t[2*s+1];0!==o&&(t[2*s]=A(r[o]++,o))}}function E(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function C(t){t.bi_valid>8?y(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function T(t,e,n,i){var s=2*e,r=2*n;return t[s]<t[r]||t[s]===t[r]&&i[e]<=i[n]}function I(t,e,n){for(var i=t.heap[n],s=n<<1;s<=t.heap_len&&(s<t.heap_len&&T(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!T(e,i,t.heap[s],t.depth));)t.heap[n]=t.heap[s],n=s,s<<=1;t.heap[n]=i}function O(t,e,n){var i,s,o,l,c=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*c]<<8|t.pending_buf[t.d_buf+2*c+1],s=t.pending_buf[t.l_buf+c],c++,0===i?k(t,s,e):(k(t,(o=d[s])+256+1,e),0!==(l=r[o])&&x(t,s-=f[o],l),k(t,o=_(--i),n),0!==(l=a[o])&&x(t,i-=v[o],l))}while(c<t.last_lit);k(t,256,e)}function B(t,e){var n,i,s,r=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<l;n++)0!==r[2*n]?(t.heap[++t.heap_len]=c=n,t.depth[n]=0):r[2*n+1]=0;for(;t.heap_len<2;)r[2*(s=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[s]=0,t.opt_len--,o&&(t.static_len-=a[2*s+1]);for(e.max_code=c,n=t.heap_len>>1;n>=1;n--)I(t,r,n);s=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],I(t,r,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,r[2*s]=r[2*n]+r[2*i],t.depth[s]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,r[2*n+1]=r[2*i+1]=s,t.heap[1]=s++,I(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,s,r,a,o,l=e.dyn_tree,c=e.max_code,u=e.stat_desc.static_tree,h=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,g=e.stat_desc.max_length,p=0;for(r=0;r<=15;r++)t.bl_count[r]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(r=l[2*l[2*(i=t.heap[n])+1]+1]+1)>g&&(r=g,p++),l[2*i+1]=r,i>c||(t.bl_count[r]++,a=0,i>=f&&(a=d[i-f]),o=l[2*i],t.opt_len+=o*(r+a),h&&(t.static_len+=o*(u[2*i+1]+a)));if(0!==p){do{for(r=g-1;0===t.bl_count[r];)r--;t.bl_count[r]--,t.bl_count[r+1]+=2,t.bl_count[g]--,p-=2}while(p>0);for(r=g;0!==r;r--)for(i=t.bl_count[r];0!==i;)(s=t.heap[--n])>c||(l[2*s+1]!==r&&(t.opt_len+=(r-l[2*s+1])*l[2*s],l[2*s+1]=r),i--)}}(t,e),S(r,c,t.bl_count)}function P(t,e,n){var i,s,r=-1,a=e[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)s=a,a=e[2*(i+1)+1],++o<l&&s===a||(o<c?t.bl_tree[2*s]+=o:0!==s?(s!==r&&t.bl_tree[2*s]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,r=s,0===a?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4))}function N(t,e,n){var i,s,r=-1,a=e[1],o=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(s=a,a=e[2*(i+1)+1],!(++o<l&&s===a)){if(o<c)do{k(t,s,t.bl_tree)}while(0!=--o);else 0!==s?(s!==r&&(k(t,s,t.bl_tree),o--),k(t,16,t.bl_tree),x(t,o-3,2)):o<=10?(k(t,17,t.bl_tree),x(t,o-3,3)):(k(t,18,t.bl_tree),x(t,o-11,7));o=0,r=s,0===a?(l=138,c=3):s===a?(l=6,c=3):(l=7,c=4)}}s(v);var R=!1;function L(t,e,n,s){x(t,0+(s?1:0),3),function(t,e,n,s){C(t),s&&(y(t,n),y(t,~n)),i.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){R||(!function(){var t,e,n,i,s,l=new Array(16);for(n=0,i=0;i<28;i++)for(f[i]=n,t=0;t<1<<r[i];t++)d[n++]=i;for(d[n-1]=i,s=0,i=0;i<16;i++)for(v[i]=s,t=0;t<1<<a[i];t++)h[s++]=i;for(s>>=7;i<30;i++)for(v[i]=s<<7,t=0;t<1<<a[i]-7;t++)h[256+s++]=i;for(e=0;e<=15;e++)l[e]=0;for(t=0;t<=143;)c[2*t+1]=8,t++,l[8]++;for(;t<=255;)c[2*t+1]=9,t++,l[9]++;for(;t<=279;)c[2*t+1]=7,t++,l[7]++;for(;t<=287;)c[2*t+1]=8,t++,l[8]++;for(S(c,287,l),t=0;t<30;t++)u[2*t+1]=5,u[2*t]=A(t,5);g=new b(c,r,257,286,15),p=new b(u,a,0,30,15),m=new b(new Array(0),o,0,19,7)}(),R=!0),t.l_desc=new w(t.dyn_ltree,g),t.d_desc=new w(t.dyn_dtree,p),t.bl_desc=new w(t.bl_tree,m),t.bi_buf=0,t.bi_valid=0,E(t)},e._tr_stored_block=L,e._tr_flush_block=function(t,e,n,i){var s,r,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),B(t,t.l_desc),B(t,t.d_desc),a=function(t){var e;for(P(t,t.dyn_ltree,t.l_desc.max_code),P(t,t.dyn_dtree,t.d_desc.max_code),B(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*l[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),s=t.opt_len+3+7>>>3,(r=t.static_len+3+7>>>3)<=s&&(s=r)):s=r=n+5,n+4<=s&&-1!==e?L(t,e,n,i):4===t.strategy||r===s?(x(t,2+(i?1:0),3),O(t,c,u)):(x(t,4+(i?1:0),3),function(t,e,n,i){var s;for(x(t,e-257,5),x(t,n-1,5),x(t,i-4,4),s=0;s<i;s++)x(t,t.bl_tree[2*l[s]+1],3);N(t,t.dyn_ltree,e-1),N(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),O(t,t.dyn_ltree,t.dyn_dtree)),E(t),i&&C(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(d[n]+256+1)]++,t.dyn_dtree[2*_(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){x(t,2,3),k(t,256,c),function(t){16===t.bi_valid?(y(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},122:function(t,e,n){"use strict";var i=n(123),s=n(17),r=n(68),a=n(70),o=n(29),l=n(69),c=n(126),u=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,e.windowBits);if(n!==a.Z_OK)throw new Error(o[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=r.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=i.inflateSetDictionary(this.strm,e.dictionary))!==a.Z_OK))throw new Error(o[n])}function d(t,e){var n=new h(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}h.prototype.push=function(t,e){var n,o,l,c,h,d=this.strm,f=this.options.chunkSize,g=this.options.dictionary,p=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?d.input=r.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new s.Buf8(f),d.next_out=0,d.avail_out=f),(n=i.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(n=i.inflateSetDictionary(this.strm,g)),n===a.Z_BUF_ERROR&&!0===p&&(n=a.Z_OK,p=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==a.Z_STREAM_END&&(0!==d.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(d.output,d.next_out),c=d.next_out-l,h=r.buf2string(d.output,l),d.next_out=c,d.avail_out=f-c,c&&s.arraySet(d.output,d.output,l,c,0),this.onData(h)):this.onData(s.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(p=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=h,e.inflate=d,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.ungzip=d},123:function(t,e,n){"use strict";var i=n(17),s=n(66),r=n(67),a=n(124),o=n(125);function l(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(852),e.distcode=e.distdyn=new i.Buf32(592),e.sane=1,e.back=-1,0):-2}function h(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,u(t)):-2}function d(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,h(t))):-2}function f(t,e){var n,i;return t?(i=new c,t.state=i,i.window=null,0!==(n=d(t,e))&&(t.state=null),n):-2}var g,p,m=!0;function v(t){if(m){var e;for(g=new i.Buf32(512),p=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(1,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(2,t.lens,0,32,p,0,t.work,{bits:5}),m=!1}t.lencode=g,t.lenbits=9,t.distcode=p,t.distbits=5}function b(t,e,n,s){var r,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),s>=a.wsize?(i.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>s&&(r=s),i.arraySet(a.window,e,n-s,r,a.wnext),(s-=r)?(i.arraySet(a.window,e,n-s,s,0),a.wnext=s,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}e.inflateReset=h,e.inflateReset2=d,e.inflateResetKeep=u,e.inflateInit=function(t){return f(t,15)},e.inflateInit2=f,e.inflate=function(t,e){var n,c,u,h,d,f,g,p,m,w,_,y,x,k,A,S,E,C,T,I,O,B,P,N,R=0,L=new i.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(n=t.state).mode&&(n.mode=13),d=t.next_out,u=t.output,g=t.avail_out,h=t.next_in,c=t.input,f=t.avail_in,p=n.hold,m=n.bits,w=f,_=g,B=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;m<16;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(2&n.wrap&&35615===p){n.check=0,L[0]=255&p,L[1]=p>>>8&255,n.check=r(n.check,L,2,0),p=0,m=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&p)<<8)+(p>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&p)){t.msg="unknown compression method",n.mode=30;break}if(m-=4,O=8+(15&(p>>>=4)),0===n.wbits)n.wbits=O;else if(O>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<O,t.adler=n.check=1,n.mode=512&p?10:12,p=0,m=0;break;case 2:for(;m<16;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(n.flags=p,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=p>>8&1),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=r(n.check,L,2,0)),p=0,m=0,n.mode=3;case 3:for(;m<32;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.head&&(n.head.time=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,L[2]=p>>>16&255,L[3]=p>>>24&255,n.check=r(n.check,L,4,0)),p=0,m=0,n.mode=4;case 4:for(;m<16;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.head&&(n.head.xflags=255&p,n.head.os=p>>8),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=r(n.check,L,2,0)),p=0,m=0,n.mode=5;case 5:if(1024&n.flags){for(;m<16;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.length=p,n.head&&(n.head.extra_len=p),512&n.flags&&(L[0]=255&p,L[1]=p>>>8&255,n.check=r(n.check,L,2,0)),p=0,m=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((y=n.length)>f&&(y=f),y&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,c,h,y,O)),512&n.flags&&(n.check=r(n.check,c,y,h)),f-=y,h+=y,n.length-=y),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===f)break t;y=0;do{O=c[h+y++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&y<f);if(512&n.flags&&(n.check=r(n.check,c,y,h)),f-=y,h+=y,O)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===f)break t;y=0;do{O=c[h+y++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&y<f);if(512&n.flags&&(n.check=r(n.check,c,y,h)),f-=y,h+=y,O)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;m<16;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(p!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}p=0,m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;m<32;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}t.adler=n.check=l(p),p=0,m=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=d,t.avail_out=g,t.next_in=h,t.avail_in=f,n.hold=p,n.bits=m,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){p>>>=7&m,m-=7&m,n.mode=27;break}for(;m<3;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}switch(n.last=1&p,m-=1,3&(p>>>=1)){case 0:n.mode=14;break;case 1:if(v(n),n.mode=20,6===e){p>>>=2,m-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}p>>>=2,m-=2;break;case 14:for(p>>>=7&m,m-=7&m;m<32;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if((65535&p)!=(p>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&p,p=0,m=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(y=n.length){if(y>f&&(y=f),y>g&&(y=g),0===y)break t;i.arraySet(u,c,h,y,d),f-=y,h+=y,g-=y,d+=y,n.length-=y;break}n.mode=12;break;case 17:for(;m<14;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(n.nlen=257+(31&p),p>>>=5,m-=5,n.ndist=1+(31&p),p>>>=5,m-=5,n.ncode=4+(15&p),p>>>=4,m-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;m<3;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.lens[M[n.have++]]=7&p,p>>>=3,m-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},B=o(0,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,B){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;S=(R=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,E=65535&R,!((A=R>>>24)<=m);){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(E<16)p>>>=A,m-=A,n.lens[n.have++]=E;else{if(16===E){for(N=A+2;m<N;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(p>>>=A,m-=A,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}O=n.lens[n.have-1],y=3+(3&p),p>>>=2,m-=2}else if(17===E){for(N=A+3;m<N;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}m-=A,O=0,y=3+(7&(p>>>=A)),p>>>=3,m-=3}else{for(N=A+7;m<N;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}m-=A,O=0,y=11+(127&(p>>>=A)),p>>>=7,m-=7}if(n.have+y>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;y--;)n.lens[n.have++]=O}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,P={bits:n.lenbits},B=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,B){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},B=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,B){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(f>=6&&g>=258){t.next_out=d,t.avail_out=g,t.next_in=h,t.avail_in=f,n.hold=p,n.bits=m,a(t,_),d=t.next_out,u=t.output,g=t.avail_out,h=t.next_in,c=t.input,f=t.avail_in,p=n.hold,m=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;S=(R=n.lencode[p&(1<<n.lenbits)-1])>>>16&255,E=65535&R,!((A=R>>>24)<=m);){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(S&&0==(240&S)){for(C=A,T=S,I=E;S=(R=n.lencode[I+((p&(1<<C+T)-1)>>C)])>>>16&255,E=65535&R,!(C+(A=R>>>24)<=m);){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}p>>>=C,m-=C,n.back+=C}if(p>>>=A,m-=A,n.back+=A,n.length=E,0===S){n.mode=26;break}if(32&S){n.back=-1,n.mode=12;break}if(64&S){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&S,n.mode=22;case 22:if(n.extra){for(N=n.extra;m<N;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.length+=p&(1<<n.extra)-1,p>>>=n.extra,m-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;S=(R=n.distcode[p&(1<<n.distbits)-1])>>>16&255,E=65535&R,!((A=R>>>24)<=m);){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(0==(240&S)){for(C=A,T=S,I=E;S=(R=n.distcode[I+((p&(1<<C+T)-1)>>C)])>>>16&255,E=65535&R,!(C+(A=R>>>24)<=m);){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}p>>>=C,m-=C,n.back+=C}if(p>>>=A,m-=A,n.back+=A,64&S){t.msg="invalid distance code",n.mode=30;break}n.offset=E,n.extra=15&S,n.mode=24;case 24:if(n.extra){for(N=n.extra;m<N;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}n.offset+=p&(1<<n.extra)-1,p>>>=n.extra,m-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===g)break t;if(y=_-g,n.offset>y){if((y=n.offset-y)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}y>n.wnext?(y-=n.wnext,x=n.wsize-y):x=n.wnext-y,y>n.length&&(y=n.length),k=n.window}else k=u,x=d-n.offset,y=n.length;y>g&&(y=g),g-=y,n.length-=y;do{u[d++]=k[x++]}while(--y);0===n.length&&(n.mode=21);break;case 26:if(0===g)break t;u[d++]=n.length,g--,n.mode=21;break;case 27:if(n.wrap){for(;m<32;){if(0===f)break t;f--,p|=c[h++]<<m,m+=8}if(_-=g,t.total_out+=_,n.total+=_,_&&(t.adler=n.check=n.flags?r(n.check,u,_,d-_):s(n.check,u,_,d-_)),_=g,(n.flags?p:l(p))!==n.check){t.msg="incorrect data check",n.mode=30;break}p=0,m=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;m<32;){if(0===f)break t;f--,p+=c[h++]<<m,m+=8}if(p!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}p=0,m=0}n.mode=29;case 29:B=1;break t;case 30:B=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=d,t.avail_out=g,t.next_in=h,t.avail_in=f,n.hold=p,n.bits=m,(n.wsize||_!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&b(t,t.output,t.next_out,_-t.avail_out)?(n.mode=31,-4):(w-=t.avail_in,_-=t.avail_out,t.total_in+=w,t.total_out+=_,n.total+=_,n.wrap&&_&&(t.adler=n.check=n.flags?r(n.check,u,_,t.next_out-_):s(n.check,u,_,t.next_out-_)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===w&&0===_||4===e)&&0===B&&(B=-5),B)},e.inflateEnd=function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?-2:(n.head=e,e.done=!1,0):-2},e.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?-2:11===n.mode&&s(1,e,i,0)!==n.check?-3:b(t,e,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},e.inflateInfo="pako inflate (from Nodeca project)"},124:function(t,e,n){"use strict";t.exports=function(t,e){var n,i,s,r,a,o,l,c,u,h,d,f,g,p,m,v,b,w,_,y,x,k,A,S,E;n=t.state,i=t.next_in,S=t.input,s=i+(t.avail_in-5),r=t.next_out,E=t.output,a=r-(e-t.avail_out),o=r+(t.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,f=n.hold,g=n.bits,p=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;t:do{g<15&&(f+=S[i++]<<g,g+=8,f+=S[i++]<<g,g+=8),w=p[f&v];e:for(;;){if(f>>>=_=w>>>24,g-=_,0===(_=w>>>16&255))E[r++]=65535&w;else{if(!(16&_)){if(0==(64&_)){w=p[(65535&w)+(f&(1<<_)-1)];continue e}if(32&_){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}y=65535&w,(_&=15)&&(g<_&&(f+=S[i++]<<g,g+=8),y+=f&(1<<_)-1,f>>>=_,g-=_),g<15&&(f+=S[i++]<<g,g+=8,f+=S[i++]<<g,g+=8),w=m[f&b];n:for(;;){if(f>>>=_=w>>>24,g-=_,!(16&(_=w>>>16&255))){if(0==(64&_)){w=m[(65535&w)+(f&(1<<_)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(x=65535&w,g<(_&=15)&&(f+=S[i++]<<g,(g+=8)<_&&(f+=S[i++]<<g,g+=8)),(x+=f&(1<<_)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=_,g-=_,x>(_=r-a)){if((_=x-_)>u&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(k=0,A=d,0===h){if(k+=c-_,_<y){y-=_;do{E[r++]=d[k++]}while(--_);k=r-x,A=E}}else if(h<_){if(k+=c+h-_,(_-=h)<y){y-=_;do{E[r++]=d[k++]}while(--_);if(k=0,h<y){y-=_=h;do{E[r++]=d[k++]}while(--_);k=r-x,A=E}}}else if(k+=h-_,_<y){y-=_;do{E[r++]=d[k++]}while(--_);k=r-x,A=E}for(;y>2;)E[r++]=A[k++],E[r++]=A[k++],E[r++]=A[k++],y-=3;y&&(E[r++]=A[k++],y>1&&(E[r++]=A[k++]))}else{k=r-x;do{E[r++]=E[k++],E[r++]=E[k++],E[r++]=E[k++],y-=3}while(y>2);y&&(E[r++]=E[k++],y>1&&(E[r++]=E[k++]))}break}}break}}while(i<s&&r<o);i-=y=g>>3,f&=(1<<(g-=y<<3))-1,t.next_in=i,t.next_out=r,t.avail_in=i<s?s-i+5:5-(i-s),t.avail_out=r<o?o-r+257:257-(r-o),n.hold=f,n.bits=g}},125:function(t,e,n){"use strict";var i=n(17),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,l,c,u,h,d){var f,g,p,m,v,b,w,_,y,x=d.bits,k=0,A=0,S=0,E=0,C=0,T=0,I=0,O=0,B=0,P=0,N=null,R=0,L=new i.Buf16(16),M=new i.Buf16(16),z=null,D=0;for(k=0;k<=15;k++)L[k]=0;for(A=0;A<l;A++)L[e[n+A]]++;for(C=x,E=15;E>=1&&0===L[E];E--);if(C>E&&(C=E),0===E)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(S=1;S<E&&0===L[S];S++);for(C<S&&(C=S),O=1,k=1;k<=15;k++)if(O<<=1,(O-=L[k])<0)return-1;if(O>0&&(0===t||1!==E))return-1;for(M[1]=0,k=1;k<15;k++)M[k+1]=M[k]+L[k];for(A=0;A<l;A++)0!==e[n+A]&&(h[M[e[n+A]]++]=A);if(0===t?(N=z=h,b=19):1===t?(N=s,R-=257,z=r,D-=257,b=256):(N=a,z=o,b=-1),P=0,A=0,k=S,v=u,T=C,I=0,p=-1,m=(B=1<<C)-1,1===t&&B>852||2===t&&B>592)return 1;for(;;){w=k-I,h[A]<b?(_=0,y=h[A]):h[A]>b?(_=z[D+h[A]],y=N[R+h[A]]):(_=96,y=0),f=1<<k-I,S=g=1<<T;do{c[v+(P>>I)+(g-=f)]=w<<24|_<<16|y|0}while(0!==g);for(f=1<<k-1;P&f;)f>>=1;if(0!==f?(P&=f-1,P+=f):P=0,A++,0==--L[k]){if(k===E)break;k=e[n+h[A]]}if(k>C&&(P&m)!==p){for(0===I&&(I=C),v+=S,O=1<<(T=k-I);T+I<E&&!((O-=L[T+I])<=0);)T++,O<<=1;if(B+=1<<T,1===t&&B>852||2===t&&B>592)return 1;c[p=P&m]=C<<24|T<<16|v-u|0}}return 0!==P&&(c[v+P]=k-I<<24|64<<16|0),d.bits=C,0}},126:function(t,e,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},135:function(t,e,n){"use strict";n.r(e);var i=n(2),s=n.n(i),r=n(1),a=n.n(r),o=n(0),l=n(9),c=n.n(l),u=n(13),h=n.n(u),d=n(75),f=n.n(d),g=n(16),p=n.n(g),m=n(15),v=n.n(m),b=n(3),w=c.a.Model.extend({url:"https://www.google-analytics.com/collect",defaults:{v:1,tid:void 0,cid:void 0,an:b.b.TENANT,ul:navigator.language,dl:"/background.html",sr:`${screen.availWidth}x${screen.availHeight}`,z:void 0},random:(t=1e7,e=2147483647)=>t+Math.floor(Math.random()*(e-t)),initialize(){const t=this;s.a.extension.attachEvent("GAEvent",e=>{window.CBSP.settings.get("loggingEnabled")&&t.send({t:"event",ec:e.data.category,ea:e.data.action,el:e.data.label,ev:e.data.value,dp:e.data.page},e.data.options)})},send(t){return a.a.ajax({url:this.url,type:"POST",data:o.default.extend(this.toJSON(),t,{z:this.random()})})},push(t){"_trackEvent"===t[0]?this.send(o.default.omit({t:"event",ec:t[1],ea:t[2],el:t[3],ev:t[4],dp:t[5]},t=>null===t)):"_trackPageview"===t[0]&&this.send({t:"pageview",dp:t[1],dt:t[2]})}});var _=function(){return(_=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function y(t,e,n,i){return new(n||(n=Promise))((function(s,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function o(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}l((i=i.apply(t,e||[])).next())}))}function x(t,e){var n,i,s,r,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(s=a.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){a.label=r[1];break}if(6===r[0]&&a.label<s[1]){a.label=s[1],s=r;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(r);break}s[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}}function k(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),s=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,o=r.length;a<o;a++,s++)i[s]=r[a];return i}function A(){var t={};return{get:function(){return t},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},set:function(e){t=e}}}var S=function(t){return Array.isArray(t)},E=function(t){return!Array.isArray(t)&&"object"==typeof t&&null!==t};function C(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=0,s=e;i<s.length;i++){var r=s[i];null!=r&&(t=I(t,r,T()))}return t}function T(){if("undefined"!=typeof WeakSet){var t=new WeakSet;return{hasAlreadyBeenSeen:function(e){var n=t.has(e);return n||t.add(e),n}}}var e=[];return{hasAlreadyBeenSeen:function(t){var n=e.indexOf(t)>=0;return n||e.push(t),n}}}function I(t,e,n){if(void 0===e)return t;if(!E(e)&&!S(e))return e;if(!n.hasAlreadyBeenSeen(e)){if(E(e)&&(void 0===t||E(t))){var i=t||{};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(i[s]=I(i[s],e[s],n));return i}if(S(e)&&(void 0===t||S(t))){(i=t||[]).length=Math.max(i.length,e.length);for(var r=0;r<e.length;r+=1)i[r]=I(i[r],e[r],n);return i}return e}}var O=/[^\u0000-\u007F]/,B=function(){function t(t,e,n){void 0===n&&(n=!1),this.endpointUrl=t,this.bytesLimit=e,this.withBatchTime=n}return t.prototype.send=function(t,e){var n=this.withBatchTime?function(t){return t+(-1===t.indexOf("?")?"?":"&")+"batch_time="+(new Date).getTime()}(this.endpointUrl):this.endpointUrl;if(navigator.sendBeacon&&e<this.bytesLimit&&navigator.sendBeacon(n,t))return;var i=new XMLHttpRequest;i.open("POST",n,!0),i.send(t)},t}();var P=function(){function t(t,e,n,i,s,r){void 0===r&&(r=et),this.request=t,this.maxSize=e,this.bytesLimit=n,this.maxMessageSize=i,this.flushTimeout=s,this.beforeUnloadCallback=r,this.pushOnlyBuffer=[],this.upsertBuffer={},this.bufferBytesSize=0,this.bufferMessageCount=0,this.flushOnVisibilityHidden(),this.flushPeriodically()}return t.prototype.add=function(t){this.addOrUpdate(t)},t.prototype.upsert=function(t,e){this.addOrUpdate(t,e)},t.prototype.flush=function(){if(0!==this.bufferMessageCount){var t=k(this.pushOnlyBuffer,(e=this.upsertBuffer,n=[],Object.keys(e).forEach((function(t){n.push(e[t])})),n));this.request.send(t.join("\n"),this.bufferBytesSize),this.pushOnlyBuffer=[],this.upsertBuffer={},this.bufferBytesSize=0,this.bufferMessageCount=0}var e,n},t.prototype.sizeInBytes=function(t){return O.test(t)?void 0!==window.TextEncoder?(new TextEncoder).encode(t).length:new Blob([t]).size:t.length},t.prototype.addOrUpdate=function(t,e){var n=this.process(t),i=n.processedMessage,s=n.messageBytesSize;s>=this.maxMessageSize||(this.hasMessageFor(e)&&this.remove(e),this.willReachedBytesLimitWith(s)&&this.flush(),this.push(i,s,e),this.isFull()&&this.flush())},t.prototype.process=function(t){var e=nt(t);return{processedMessage:e,messageBytesSize:this.sizeInBytes(e)}},t.prototype.push=function(t,e,n){this.bufferMessageCount>0&&(this.bufferBytesSize+=1),void 0!==n?this.upsertBuffer[n]=t:this.pushOnlyBuffer.push(t),this.bufferBytesSize+=e,this.bufferMessageCount+=1},t.prototype.remove=function(t){var e=this.upsertBuffer[t];delete this.upsertBuffer[t];var n=this.sizeInBytes(e);this.bufferBytesSize-=n,this.bufferMessageCount-=1,this.bufferMessageCount>0&&(this.bufferBytesSize-=1)},t.prototype.hasMessageFor=function(t){return void 0!==t&&void 0!==this.upsertBuffer[t]},t.prototype.willReachedBytesLimitWith=function(t){return this.bufferBytesSize+t+1>=this.bytesLimit},t.prototype.isFull=function(){return this.bufferMessageCount===this.maxSize||this.bufferBytesSize>=this.bytesLimit},t.prototype.flushPeriodically=function(){var t=this;setTimeout((function(){t.flush(),t.flushPeriodically()}),this.flushTimeout)},t.prototype.flushOnVisibilityHidden=function(){var t=this;navigator.sendBeacon&&(at(window,W.BEFORE_UNLOAD,this.beforeUnloadCallback),at(document,W.VISIBILITY_CHANGE,(function(){"hidden"===document.visibilityState&&t.flush()})),at(window,W.BEFORE_UNLOAD,(function(){return t.flush()})))},t}(),N=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var L,M=function(){var t,e,n,i,s,r,a=[];function o(t,e,n){var i;for(var s in a)if(R(a,s))try{a[s](t,e,n)}catch(t){i=t}if(i)throw i}function l(t,i,s,r,a){if(e)z.augmentStackTraceWithInitialElement(e,i,s,""+t),u();else if(a)o(z(a),!0,a);else{var l,c={url:i,column:r,line:s},h=t;if("[object String]"==={}.toString.call(t)){var d=h.match(N);d&&(l=d[1],h=d[2])}o({name:l,message:h,stack:[c]},!0)}return!!n&&n.apply(this,arguments)}function c(t){var e=t.reason||"Empty reason";o(z(e),!0,e)}function u(){var n=e,i=t;e=void 0,t=void 0,o(n,!1,i)}function h(n){if(e){if(t===n)return;u()}var i=z(n);throw e=i,t=n,setTimeout((function(){t===n&&u()}),i.incomplete?2e3:0),n}return h.subscribe=function(t){!function(){if(i)return;n=window.onerror,window.onerror=F(l),i=!0}(),function(){if(r)return;s=null!==window.onunhandledrejection?window.onunhandledrejection:void 0,window.onunhandledrejection=F(c),r=!0}(),a.push(t)},h.unsubscribe=function(t){for(var e=a.length-1;e>=0;e-=1)a[e]===t&&a.splice(e,1);0===a.length&&(i&&(window.onerror=n,i=!1),r&&(window.onunhandledrejection=s,r=!1))},h.traceKitWindowOnError=l,h}(),z=function(){function t(t){if(t.stack){for(var e,n,i,s,r=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,c=/\((\S*)(?::(\d+))(?::(\d+))\)/,u=t.stack.split("\n"),h=[],d=0,f=u.length;d<f;d+=1){if(r.exec(u[d])){var g=(i=r.exec(u[d]))[2]&&0===i[2].indexOf("native");e=i[2]&&0===i[2].indexOf("eval"),n=c.exec(i[2]),e&&n&&(i[2]=n[1],i[3]=n[2],i[4]=n[3]),s={args:g?[i[2]]:[],column:i[4]?+i[4]:void 0,func:i[1]||"?",line:i[3]?+i[3]:void 0,url:g?void 0:i[2]}}else if(o.exec(u[d]))s={args:[],column:(i=o.exec(u[d]))[4]?+i[4]:void 0,func:i[1]||"?",line:+i[3],url:i[2]};else{if(!a.exec(u[d]))continue;e=(i=a.exec(u[d]))[3]&&i[3].indexOf(" > eval")>-1,n=l.exec(i[3]),e&&n?(i[3]=n[1],i[4]=n[2],i[5]=void 0):0!==d||i[5]||void 0===t.columnNumber||(h[0].column=t.columnNumber+1),s={args:i[2]?i[2].split(","):[],column:i[5]?+i[5]:void 0,func:i[1]||"?",line:i[4]?+i[4]:void 0,url:i[3]}}!s.func&&s.line&&(s.func="?"),h.push(s)}if(h.length)return{stack:h,message:t.message,name:t.name}}}function e(t,e,n,i){var s={url:e,line:n?+n:void 0};if(s.url&&s.line){t.incomplete=!1;var r=t.stack;if(r.length>0&&r[0].url===s.url){if(r[0].line===s.line)return!1;if(!r[0].line&&r[0].func===s.func)return r[0].line=s.line,r[0].context=s.context,!1}return r.unshift(s),t.partial=!0,!0}return t.incomplete=!0,!1}function n(t,i){for(var s,r,a=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,o=[],l={},c=!1,u=n.caller;u&&!c;u=u.caller)u!==z&&u!==M&&(r={args:[],column:void 0,func:"?",line:void 0,url:void 0},s=a.exec(u.toString()),u.name?r.func=u.name:s&&(r.func=s[1]),void 0===r.func&&(r.func=s?s.input.substring(0,s.input.indexOf("{")):void 0),l[""+u]?c=!0:l[""+u]=!0,o.push(r));i&&o.splice(0,i);var h={stack:o,message:t.message,name:t.name};return e(h,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),h}function i(e,i){var s,r=void 0===i?0:+i;try{if(s=function(t){var e=t.stacktrace;if(e){for(var n,i=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,s=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,r=e.split("\n"),a=[],o=0;o<r.length;o+=2){var l=void 0;i.exec(r[o])?l={args:[],column:void 0,func:(n=i.exec(r[o]))[3],line:+n[1],url:n[2]}:s.exec(r[o])&&(l={args:(n=s.exec(r[o]))[5]?n[5].split(","):[],column:+n[2],func:n[3]||n[4],line:+n[1],url:n[6]}),l&&(!l.func&&l.line&&(l.func="?"),l.context=[r[o+1]],a.push(l))}if(a.length)return{stack:a,message:t.message,name:t.name}}}(e))return s}catch(t){0}try{if(s=t(e))return s}catch(t){0}try{if(s=function(t){var e=t.message.split("\n");if(!(e.length<4)){var n,i=/^\s*Line (\d+) of linked script ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,s=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?|blob)\S+)(?:: in function (\S+))?\s*$/i,r=/^\s*Line (\d+) of function script\s*$/i,a=[],o=window&&window.document&&window.document.getElementsByTagName("script"),l=[];for(var c in o)R(o,c)&&!o[c].src&&l.push(o[c]);for(var u=2;u<e.length;u+=2){var h=void 0;if(i.exec(e[u]))h={args:[],column:void 0,func:(n=i.exec(e[u]))[3],line:+n[1],url:n[2]};else if(s.exec(e[u]))h={args:[],column:void 0,func:(n=s.exec(e[u]))[4],line:+n[1],url:n[3]};else if(r.exec(e[u])){n=r.exec(e[u]),h={url:window.location.href.replace(/#.*$/,""),args:[],column:void 0,func:"",line:+n[1]}}h&&(h.func||(h.func="?"),h.context=[e[u+1]],a.push(h))}if(a.length)return{stack:a,message:e[0],name:t.name}}}(e))return s}catch(t){0}try{if(s=n(e,r+1))return s}catch(t){0}return{message:e.message,name:e.name,stack:[]}}return i.augmentStackTraceWithInitialElement=e,i.computeStackTraceFromStackProp=t,i.ofCaller=function(t){var e=1+(void 0===t?0:+t);try{throw new Error}catch(t){return z(t,e+1)}},i}();!function(t){t.info="info",t.error="error"}(L||(L={}));var D,U={maxMessagesPerPage:0,sentMessageCount:0};function j(t){if(t.internalMonitoringEndpoint){var e=function(t){var e,n=i(t.internalMonitoringEndpoint);void 0!==t.replica&&(e=i(t.replica.internalMonitoringEndpoint));function i(e){return new P(new B(e,t.batchBytesLimit),t.maxBatchSize,t.batchBytesLimit,t.maxMessageSize,t.flushTimeout)}return{add:function(t){var i=function(t){return C({date:(new Date).getTime(),view:{referrer:document.referrer,url:window.location.href}},void 0!==D?D():{},t)}(t);n.add(i),e&&e.add(i)}}}(t);!function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach((function(e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))}(U,{batch:e,maxMessagesPerPage:t.maxInternalMonitoringMessagesPerPage,sentMessageCount:0})}return{setExternalContextProvider:function(t){D=t}}}function H(t,e,n){var i=n.value;n.value=function(){var t=U.batch?F(i):i;return t.apply(this,arguments)}}function F(t){return function(){try{return t.apply(this,arguments)}catch(t){q(t);try{J(t)}catch(t){q(t)}}}}function J(t){$(_(_({},function(t){if(t instanceof Error){var e=z(t);return{error:{kind:e.name,stack:lt(e)},message:e.message}}return{error:{stack:"Not an instance of error"},message:"Uncaught "+nt(t)}}(t)),{status:L.error}))}function $(t){U.batch&&U.sentMessageCount<U.maxMessagesPerPage&&(U.sentMessageCount+=1,U.batch.add(t))}function G(t){U.debugMode=t}function q(t){U.debugMode}var W,Z,K,V,Y,X,Q;function tt(t){return t?(parseInt(t,10)^16*Math.random()>>parseInt(t,10)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,tt)}function et(){}function nt(t,e,n){if(null==t)return JSON.stringify(t);var i=[!1,void 0];it(t)&&(i=[!0,t.toJSON],delete t.toJSON);var s,r,a=[!1,void 0];"object"==typeof t&&it(s=Object.getPrototypeOf(t))&&(a=[!0,s.toJSON],delete s.toJSON);try{r=JSON.stringify(t,void 0,n)}catch(t){r="<error: unable to serialize object>"}finally{i[0]&&(t.toJSON=i[1]),a[0]&&(s.toJSON=a[1])}return r}function it(t){return"object"==typeof t&&null!==t&&t.hasOwnProperty("toJSON")}function st(){return void 0===V&&(V=performance.timing.navigationStart),V}function rt(t){if(t.origin)return t.origin;var e=t.host.replace(/(:80|:443)$/,"");return t.protocol+"//"+e}function at(t,e,n,i){return ot(t,[e],n,i)}function ot(t,e,n,i){var s=void 0===i?{}:i,r=s.once,a=s.capture,o=s.passive,l=F(r?function(t){u(),n(t)}:n),c=o?{capture:a,passive:o}:a;e.forEach((function(e){return t.addEventListener(e,l,c)}));var u=function(){return e.forEach((function(e){return t.removeEventListener(e,l,c)}))};return{stop:u}}function lt(t){var e=(t.name||"Error")+": "+t.message;return t.stack.forEach((function(t){var n="?"===t.func?"<anonymous>":t.func,i=t.args&&t.args.length>0?"("+t.args.join(", ")+")":"",s=t.line?":"+t.line:"",r=t.line&&t.column?":"+t.column:"";e+="\n  at "+n+i+" @ "+t.url+s+r})),e}!function(t){t.BEFORE_UNLOAD="beforeunload",t.CLICK="click",t.KEY_DOWN="keydown",t.LOAD="load",t.POP_STATE="popstate",t.SCROLL="scroll",t.TOUCH_START="touchstart",t.VISIBILITY_CHANGE="visibilitychange",t.DOM_CONTENT_LOADED="DOMContentLoaded",t.POINTER_DOWN="pointerdown",t.POINTER_UP="pointerup",t.POINTER_CANCEL="pointercancel",t.HASH_CHANGE="hashchange",t.PAGE_HIDE="pagehide",t.MOUSE_DOWN="mousedown"}(W||(W={})),function(t){t.DOCUMENT="document",t.XHR="xhr",t.BEACON="beacon",t.FETCH="fetch",t.CSS="css",t.JS="js",t.IMAGE="image",t.FONT="font",t.MEDIA="media",t.OTHER="other"}(Z||(Z={})),function(t){t.FETCH="fetch",t.XHR="xhr"}(K||(K={})),function(t){t.AGENT="agent",t.CONSOLE="console",t.NETWORK="network",t.SOURCE="source",t.LOGGER="logger",t.CUSTOM="custom"}(Y||(Y={})),function(t){t.debug="debug",t.info="info",t.warn="warn",t.error="error"}(Q||(Q={}));var ct,ut=((X={})[Q.debug]=0,X[Q.info]=1,X[Q.warn]=2,X[Q.error]=3,X);Object.keys(Q);!function(t){t.http="http",t.console="console",t.silent="silent"}(ct||(ct={}));var ht,dt=function(){function t(t,e,n,i){void 0===e&&(e=ct.http),void 0===n&&(n=Q.debug),void 0===i&&(i={}),this.sendLog=t,this.handlerType=e,this.level=n,this.contextManager=A(),this.contextManager.set(i)}return t.prototype.log=function(t,e,n){if(void 0===n&&(n=Q.info),ut[n]>=ut[this.level])switch(this.handlerType){case ct.http:this.sendLog(_({message:t,status:n},C(this.contextManager.get(),e)));break;case ct.console:case ct.silent:}},t.prototype.debug=function(t,e){this.log(t,e,Q.debug)},t.prototype.info=function(t,e){this.log(t,e,Q.info)},t.prototype.warn=function(t,e){this.log(t,e,Q.warn)},t.prototype.error=function(t,e){var n={error:{origin:Y.LOGGER}};this.log(t,C(n,e),Q.error)},t.prototype.setContext=function(t){this.contextManager.set(t)},t.prototype.addContext=function(t,e){this.contextManager.add(t,e)},t.prototype.removeContext=function(t){this.contextManager.remove(t)},t.prototype.setHandler=function(t){this.handlerType=t},t.prototype.setLevel=function(t){this.level=t},function(t,e,n,i){var s,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(a=(r<3?s(a):r>3?s(e,n,a):s(e,n))||a);r>3&&a&&Object.defineProperty(e,n,a)}([H],t.prototype,"log",null),t}();function ft(t,e,n,i){var s=new Date;s.setTime(s.getTime()+n);var r="expires="+s.toUTCString(),a=i&&i.crossSite?"none":"strict",o=i&&i.domain?";domain="+i.domain:"",l=i&&i.secure?";secure":"";document.cookie=t+"="+e+";"+r+";path=/;samesite="+a+o+l}function gt(t){return function(t,e){var n=t.match("(?:^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return n?n[1]:void 0}(document.cookie,t)}function pt(t){if(void 0===document.cookie||null===document.cookie)return!1;try{var e="dd_cookie_test_"+tt();return ft(e,"test",1e3,t),"test"===gt(e)}catch(t){return!1}}var mt,vt,bt={allowedTracingOrigins:[],maxErrorsByMinute:3e3,maxInternalMonitoringMessagesPerPage:15,resourceSampleRate:100,sampleRate:100,silentMultipleInit:!1,trackInteractions:!1,requestErrorResponseLengthLimit:32768,flushTimeout:3e4,maxBatchSize:50,maxMessageSize:262144,batchBytesLimit:16384},wt={alternate:{logs:"logs",rum:"rum",trace:"trace"},classic:{logs:"browser",rum:"rum",trace:"public-trace"}};function _t(t,e){var n={applicationId:t.applicationId,buildMode:e.buildMode,clientToken:t.clientToken,env:t.env,proxyHost:t.proxyHost,sdkVersion:e.sdkVersion,service:t.service,site:t.site||St[t.datacenter||e.datacenter],version:t.version},i=Array.isArray(t.enableExperimentalFeatures)?t.enableExperimentalFeatures:[],s=t.useAlternateIntakeDomains?"alternate":"classic",r=function(t,e,n){if(e.proxyHost)return["https://"+e.proxyHost+"/v1/input/"];var i=[e.site];e.buildMode===At.STAGING&&n&&i.push(St[vt.US]);for(var s=[],r=Object.keys(wt[t]),a=0,o=i;a<o.length;a++)for(var l=o[a],c=0,u=r;c<u.length;c++){var h=u[c];s.push("https://"+kt(t,h,l)+"/v1/input/")}return s}(s,n,void 0!==t.replica),a=_({cookieOptions:yt(t),isEnabled:function(t){return e=t,-1!==i.indexOf(e);var e},logsEndpoint:xt(s,"logs",n),proxyHost:t.proxyHost,rumEndpoint:xt(s,"rum",n),service:t.service,traceEndpoint:xt(s,"trace",n),isIntakeUrl:function(t){return r.some((function(e){return 0===t.indexOf(e)}))}},bt);if(t.internalMonitoringApiKey&&(a.internalMonitoringEndpoint=xt(s,"logs",n,"browser-agent-internal-monitoring")),"allowedTracingOrigins"in t&&(a.allowedTracingOrigins=t.allowedTracingOrigins),"sampleRate"in t&&(a.sampleRate=t.sampleRate),"resourceSampleRate"in t&&(a.resourceSampleRate=t.resourceSampleRate),"trackInteractions"in t&&(a.trackInteractions=!!t.trackInteractions),n.buildMode===At.E2E_TEST&&(a.internalMonitoringEndpoint="<<< E2E INTERNAL MONITORING ENDPOINT >>>",a.logsEndpoint="<<< E2E LOGS ENDPOINT >>>",a.rumEndpoint="<<< E2E RUM ENDPOINT >>>"),n.buildMode===At.STAGING&&void 0!==t.replica){var o=_(_({},n),{applicationId:t.replica.applicationId,clientToken:t.replica.clientToken,site:St[vt.US]});a.replica={applicationId:t.replica.applicationId,internalMonitoringEndpoint:xt(s,"logs",o,"browser-agent-internal-monitoring"),logsEndpoint:xt(s,"logs",o),rumEndpoint:xt(s,"rum",o)}}return a}function yt(t){var e={};return e.secure=function(t){return!!t.useSecureSessionCookie||!!t.useCrossSiteSessionCookie}(t),e.crossSite=!!t.useCrossSiteSessionCookie,t.trackSessionAcrossSubdomains&&(e.domain=function(){if(void 0===ht){for(var t="dd_site_test_"+tt(),e=window.location.hostname.split("."),n=e.pop();e.length&&!gt(t);)ft(t,"test",1e3,{domain:n=e.pop()+"."+n});ht=n}return ht}()),e}function xt(t,e,n,i){var s="sdk_version:"+n.sdkVersion+(n.env?",env:"+n.env:"")+(n.service?",service:"+n.service:"")+(n.version?",version:"+n.version:""),r=kt(t,e,n.site),a=n.proxyHost?n.proxyHost:r,o=n.proxyHost?"ddhost="+r+"&":"",l=""+(n.applicationId?"_dd.application_id="+n.applicationId+"&":"")+o+"ddsource="+(i||"browser")+"&ddtags="+s;return"https://"+a+"/v1/input/"+n.clientToken+"?"+l}function kt(t,e,n){var i=wt[t][e];if("classic"===t)return i+"-http-intake.logs."+n;var s=n.split("."),r=s.pop();return i+".browser-intake-"+(s.join("-")+"."+r)}!function(t){t.US="us",t.EU="eu"}(vt||(vt={}));var At,St=((mt={})[vt.EU]="datadoghq.eu",mt[vt.US]="datadoghq.com",mt);function Et(){return"file:"!==window.location.protocol}!function(t){t.RELEASE="release",t.STAGING="staging",t.E2E_TEST="e2e-test"}(At||(At={}));var Ct,Tt,It,Ot=function(){function t(t){void 0===t&&(t=1e4),this.limit=t,this.buffer=[]}return t.prototype.add=function(t){this.buffer.push(t)>this.limit&&this.buffer.splice(0,1)},t.prototype.drain=function(t){this.buffer.forEach((function(e){return t(e)})),this.buffer.length=0},t}();function Bt(t){return Pt(t,rt(window.location)).href}function Pt(t,e){if(function(){if(void 0!==Ct)return Ct;try{var t=new URL("http://test/path");return Ct="http://test/path"===t.href}catch(t){Ct=!1}return Ct}())return void 0!==e?new URL(t,e):new URL(t);if(void 0===e&&!/:/.test(t))throw new Error("Invalid URL: '"+t+"'");var n=document,i=n.createElement("a");if(void 0!==e){var s=(n=document.implementation.createHTMLDocument("")).createElement("base");s.href=e,n.head.appendChild(s),n.body.appendChild(i)}return i.href=t,i}var Nt,Rt=[],Lt=[];function Mt(){return Tt||(!function(){if(!window.fetch)return;It=window.fetch,window.fetch=F((function(t,e){var n=this,i=e&&e.method||"object"==typeof t&&t.method||"GET",s=Bt("object"==typeof t&&t.url||t),r={init:e,method:i,startTime:performance.now(),url:s},a=function(t){return y(n,void 0,void 0,(function(){var e,n;return x(this,(function(i){switch(i.label){case 0:return r.duration=performance.now()-r.startTime,"stack"in t||t instanceof Error?(r.status=0,r.response=lt(z(t)),Lt.forEach((function(t){return t(r)})),[3,6]):[3,1];case 1:if(!("status"in t))return[3,6];e=void 0,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.clone().text()];case 3:return e=i.sent(),[3,5];case 4:return n=i.sent(),e="Unable to retrieve response: "+n,[3,5];case 5:r.response=e,r.responseType=t.type,r.status=t.status,Lt.forEach((function(t){return t(r)})),i.label=6;case 6:return[2]}}))}))};Rt.forEach((function(t){return t(r)}));var o=It.call(this,t,r.init);return o.then(F(a),F(a)),o}))}(),Tt={beforeSend:function(t){Rt.push(t)},onRequestComplete:function(t){Lt.push(t)}}),Tt}var zt,Dt,Ut=[],jt=[];function Ht(){return Nt||(zt=XMLHttpRequest.prototype.open,Dt=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.open=F((function(t,e){return this._datadog_xhr={method:t,startTime:-1,url:Bt(e)},zt.apply(this,arguments)})),XMLHttpRequest.prototype.send=F((function(t){var e=this;if(this._datadog_xhr){this._datadog_xhr.startTime=performance.now();var n=this.onreadystatechange;this.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&F(s)(),n&&n.apply(this,arguments)};var i=!1,s=function(){i||(i=!0,e._datadog_xhr.duration=performance.now()-e._datadog_xhr.startTime,e._datadog_xhr.response=e.response,e._datadog_xhr.status=e.status,jt.forEach((function(t){return t(e._datadog_xhr)})))};this.addEventListener("loadend",F(s)),Ut.forEach((function(t){return t(e._datadog_xhr,e)}))}return Dt.apply(this,arguments)})),Nt={beforeSend:function(t){Ut.push(t)},onRequestComplete:function(t){jt.push(t)}}),Nt}var Ft,Jt,$t,Gt=function(){function t(){this.observers=[]}return t.prototype.subscribe=function(t){this.observers.push(t)},t.prototype.notify=function(t){this.observers.forEach((function(e){return e(t)}))},t}();function qt(t){if(!Ft){var e=new Gt;!function(t,e){function n(n,i){t.isIntakeUrl(i.url)||!function(t){return 0===t.status&&"opaque"!==t.responseType}(i)&&!function(t){return t.status>=500}(i)||e.notify({message:Kt(n)+" error "+i.method+" "+i.url,resource:{method:i.method,statusCode:i.status,url:i.url},source:Y.NETWORK,stack:Zt(i.response,t)||"Failed to load",startTime:i.startTime})}Ht().onRequestComplete((function(t){return n(K.XHR,t)})),Mt().onRequestComplete((function(t){return n(K.FETCH,t)}))}(t,e),function(t){Jt=console.error,console.error=F((function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Jt.apply(console,k([e],n)),t.notify({message:k(["console error:",e],n).map(Wt).join(" "),source:Y.CONSOLE,startTime:performance.now()})}))}(e),function(t){$t=function(e,n,i){var s=function(t,e,n){return t&&(void 0!==t.message||e instanceof Error)?{message:t.message||"Empty message",stack:lt(t),type:t.name}:{message:n+" "+nt(e),stack:"No stack, consider using an instance of Error",type:t&&t.name}}(e,i,"Uncaught"),r=s.stack,a=s.message,o=s.type;t.notify({message:a,stack:r,type:o,source:Y.SOURCE,startTime:performance.now()})},M.subscribe($t)}(e),Ft=function(t,e){var n=0,i=new Gt;return e.subscribe((function(e){n<t.maxErrorsByMinute?(n+=1,i.notify(e)):n===t.maxErrorsByMinute&&(n+=1,i.notify({message:"Reached max number of errors by minute: "+t.maxErrorsByMinute,source:Y.AGENT,startTime:performance.now()}))})),setInterval((function(){return n=0}),6e4),i}(t,e)}return Ft}function Wt(t){return"string"==typeof t?t:t instanceof Error?lt(z(t)):nt(t,0,2)}function Zt(t,e){return t&&t.length>e.requestErrorResponseLengthLimit?t.substring(0,e.requestErrorResponseLengthLimit)+"...":t}function Kt(t){return K.XHR===t?"XHR":"Fetch"}function Vt(t,e,n){var i=function(t,e){var n,i,s=!1,r=function(){s=!0,window.clearTimeout(n),n=window.setTimeout((function(){s=!1}),1e3)};return{get:function(){return s||(i=gt(t),r()),i},set:function(n,s){ft(t,n,s,e),i=n,r()}}}("_dd_s",t);!function(t){var e=t.get(),n=gt("_dd"),i=gt("_dd_r"),s=gt("_dd_l");if(!e){var r={};n&&(r.id=n),s&&/^[01]$/.test(s)&&(r.logs=s),i&&/^[012]$/.test(i)&&(r.rum=i),Qt(r,t)}}(i);var s=new Gt,r=Xt(i).id,a=function(t,e,n){var i,s=!n||void 0===n.leading||n.leading,r=!n||void 0===n.trailing||n.trailing,a=!1,o=!1;return{throttled:function(){var n=this;a?o=!0:(s?t.apply(this):o=!0,a=!0,i=window.setTimeout((function(){r&&o&&t.apply(n),a=!1,o=!1}),e))},cancel:function(){window.clearTimeout(i),a=!1,o=!1}}}((function(){var t=Xt(i),a=n(t[e]),o=a.trackingType,l=a.isTracked;t[e]=o,l&&!t.id&&(t.id=tt(),t.created=String(Date.now())),Qt(t,i),l&&r!==t.id&&(r=t.id,s.notify())}),1e3).throttled;return a(),function(t){var e=ot(window,[W.CLICK,W.TOUCH_START,W.KEY_DOWN,W.SCROLL],t,{capture:!0,passive:!0}).stop;ee.push(e)}(a),function(t){var e=F((function(){"visible"===document.visibilityState&&t()})),n=at(document,W.VISIBILITY_CHANGE,e).stop;ee.push(n);var i=window.setInterval(e,6e4);ee.push((function(){clearInterval(i)}))}((function(){Qt(Xt(i),i)})),{getId:function(){return Xt(i).id},getTrackingType:function(){return Xt(i)[e]},renewObservable:s}}var Yt=/^([a-z]+)=([a-z0-9-]+)$/;function Xt(t){var e=function(t){var e=t.get(),n={};(function(t){return void 0!==t&&(-1!==t.indexOf("&")||Yt.test(t))})(e)&&e.split("&").forEach((function(t){var e=Yt.exec(t);if(null!==e){var i=e[1],s=e[2];n[i]=s}}));return n}(t);return function(t){return(void 0===t.created||Date.now()-Number(t.created)<144e5)&&(void 0===t.expire||Date.now()<Number(t.expire))}(e)?e:(te(t),{})}function Qt(t,e){if(n=t,0!==Object.keys(n).length){var n;t.expire=String(Date.now()+9e5);var i=function(t){return Object.keys(t).map((function(e){return[e,t[e]]}))}(t).map((function(t){return t[0]+"="+t[1]})).join("&");e.set(i,9e5)}else te(e)}function te(t){t.set("",0)}var ee=[];var ne;function ie(t,e){if(!e){var n=se(t)===ne.TRACKED;return{getId:function(){},isTracked:function(){return n}}}var i=Vt(t.cookieOptions,"logs",(function(e){return function(t,e){var n=function(t){return t===ne.NOT_TRACKED||t===ne.TRACKED}(e)?e:se(t);return{trackingType:n,isTracked:n===ne.TRACKED}}(t,e)}));return{getId:i.getId,isTracked:function(){return i.getTrackingType()===ne.TRACKED}}}function se(t){return 0!==(e=t.sampleRate)&&100*Math.random()<=e?ne.TRACKED:ne.NOT_TRACKED;var e}!function(t){t.NOT_TRACKED="0",t.TRACKED="1"}(ne||(ne={}));var re={buildMode:"release",datacenter:"us",sdkVersion:"1.26.3"};function ae(t){var e=window.DD_RUM;return e&&e.getInternalContext?e.getInternalContext(t):void 0}var oe=function(t){var e=!1,n=A(),i={},s=new Ot,r=function(t,e){s.add([t,e])},a=new dt(c);return o={logger:a,init:F((function(i){Et()&&function(t){return e?(t.silentMultipleInit,!1):!(!t||!t.publicApiKey&&!t.clientToken)&&!!(void 0===t.sampleRate||(n=t.sampleRate,function(t){return"number"==typeof t}(n)&&n>=0&&n<=100));var n}(i)&&(i.publicApiKey&&(i.clientToken=i.publicApiKey),r=t(i,a,n.get),s.drain((function(t){var e=t[0],n=t[1];return r(e,n)})),e=!0)})),getLoggerGlobalContext:F(n.get),setLoggerGlobalContext:F(n.set),addLoggerGlobalContext:F(n.add),removeLoggerGlobalContext:F(n.remove),createLogger:F((function(t,e){return void 0===e&&(e={}),i[t]=new dt(c,e.handler,e.level,_(_({},e.context),{logger:{name:t}})),i[t]})),getLogger:F((function(t){return i[t]}))},l=_(_({},o),{onReady:function(t){t()}}),Object.defineProperty(l,"_setDebug",{get:function(){return G},enumerable:!1}),l;var o,l;function c(t){r(t,C({date:Date.now(),view:{referrer:document.referrer,url:window.location.href}},n.get()))}}((function(t,e,n){var i=function(t,e){var n=_t(t,e);return{configuration:n,internalMonitoring:j(n)}}(t,re),s=i.configuration,r=i.internalMonitoring;return function(t,e,n,i,s,r){n.setExternalContextProvider((function(){return C({session_id:i.getId()},r(),ae())}));var a=function(t,e){var n,i=s(t.logsEndpoint);void 0!==t.replica&&(n=s(t.replica.logsEndpoint));function s(e){return new P(new B(e,t.batchBytesLimit),t.maxBatchSize,t.batchBytesLimit,t.maxMessageSize,t.flushTimeout)}return{add:function(s,r){var a=function(t,e,n,i){return C(t,e,n,i)}({service:t.service,session_id:e.getId()},r,ae(),s);i.add(a),n&&n.add(a)}}}(t,i);return e.subscribe((function(t){var e;s.error(t.message,C({date:(e=t.startTime,Math.floor(st()+e)),error:{kind:t.type,origin:t.source,stack:t.stack}},t.resource?{http:{method:t.resource.method,status_code:t.resource.statusCode,url:t.resource.url}}:void 0,ae(t.startTime)))})),function(t,e){i.isTracked()&&a.add(t,e)}}(s,!1!==t.forwardErrorsToLogs?qt(s):new Gt,r,ie(s,pt(s.cookieOptions)),e,n)}));!function(t,e,n){var i=t[e];t[e]=n,i&&i.q&&i.q.forEach((function(t){return t()}))}(function(){if("object"==typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"_dd_temp_",{get:function(){return this},configurable:!0});var t=_dd_temp_;return delete Object.prototype._dd_temp_,"object"!=typeof t&&(t="object"==typeof self?self:"object"==typeof window?window:{}),t}(),"DD_LOGS",oe);const le=new w({tid:b.b.GOOGLE_ANALYTICS_ID});oe.init({clientToken:"pub5c8940d1d60d49fa1ad47b86997d8ed9",datacenter:"us",forwardErrorsToLogs:!1,sampleRate:100}),oe.addLoggerGlobalContext("service","ca-button"),window.addEventListener("error",t=>{oe.logger.error(t.message,{colno:t.colno,error:t.error,filename:t.filename,lineno:t.lineno})}),window.addEventListener("unhandledrejection",(function(t){const e=t.reason;e&&e.message&&oe.logger.warn(e.message,e)})),s.a.extension.attachEvent("datadogTrack",({data:{type:t,name:e,data:n}})=>{var i,s;null===(i=(s=oe.logger)[t])||void 0===i||i.call(s,e,n)});const ce=({status:t,url:e})=>{t>=500&&oe.logger.warn("ServerError",{reason:"response status: "+t,url:e})},ue=c.a.Model.extend({toJSON(t){const e=o.default.clone(this.attributes);return e.shoppingURL&&(e.shoppingURL=window.CBSP.substitute(b.c.SHOPPING,o.default.omit(e,"domain"),t)),e}});let he={nextUpdateTime:0,timeout:null,DEFAULT_UPDATE_INTERVAL:9e5,UPDATE_INTERVAL:null,MAX_ERROR_ATTEMPT:4,errorAttempt:0,initialize(){this.key&&s.a.extension.setItem(this.key+".busy",!1)},getCache(){return s.a.extension.getItem(this.key)},setCache(t){s.a.extension.setItem(this.key,t)},readCache(){return new Promise((t,e)=>{this.key?s.a.extension.getItem(this.key+".busy").then(n=>{n?e():(s.a.extension.setItem(this.key+".busy",!0),s.a.extension.getItem(this.key+".nextUpdateTime").then(n=>{this.getCache().then(i=>{if(i&&i.responseText&&o.default.now()<n){this.etag=i.etag;try{(this instanceof c.a.Collection&&!this.length||this instanceof c.a.Model&&!Object.keys(this.toJSON()).length)&&this.set(this.parse(a.a.parseJSON(i.responseText))),this.trigger("sync",this)}catch(e){t()}finally{window.clearInterval(this.timeout),this.timeout=window.setInterval(()=>{this.fetch()},Math.max(n-o.default.now(),1e3)),s.a.extension.setItem(this.key+".busy",!1),e()}}else t()})}))}):t()})},sync(t,e,n={}){const{success:i,error:r}=n;return new Promise((l,u)=>{const h=this;if("read"===t){window.clearInterval(e.timeout);const r=()=>{n=a.a.extend({dataType:"json"},n),!e.etag||e instanceof c.a.Collection&&!e.length||n.reset||(n.beforeSend=t=>{t.setRequestHeader("If-None-Match",e.etag)}),n.success=function(t,r,a){e.errorAttempt=0;let c=e.DEFAULT_UPDATE_INTERVAL;if(e.UPDATE_INTERVAL)c=e.UPDATE_INTERVAL;else{const t=a.getResponseHeader("Cache-Control");if(t&&t.indexOf("max-age=")>=0){const e=1e3*parseInt(t.split("max-age=").pop().split(";").shift(),10);e&&(c=e)}}a.getResponseHeader("ETag")&&(e.etag=a.getResponseHeader("ETag"),e.key&&a.responseText&&e.setCache({etag:e.etag,responseText:a.responseText.toString()})),s.a.extension.setItem(e.key+".busy",!1),window.clearInterval(e.timeout),e.timeout=window.setInterval(()=>{e.fetch(o.default.pick(n,"dataType"))},c),s.a.extension.setItem(e.key+".nextUpdateTime",o.default.now()+c),l(arguments),i&&200===a.status?i.apply(this,arguments):e.trigger("sync",e)},n.error=()=>{let t=e.ERROR_UPDATE_INTERVAL||10*Math.pow(3,e.errorAttempt>e.MAX_ERROR_ATTEMPT?e.errorAttempt:++e.errorAttempt)*1e3;e.key&&(e instanceof c.a.Collection&&!e.length||e instanceof c.a.Model&&!Object.keys(e.toJSON()).length?e.getCache().then(t=>{t&&t.responseText&&e.set(e.parse(a.a.parseJSON(t.responseText))),s.a.extension.setItem(e.key+".busy",!1)}):s.a.extension.setItem(e.key+".busy",!1)),window.clearInterval(e.timeout),e.timeout=window.setInterval(()=>{e.fetch(o.default.pick(n,"dataType"))},t),ce({status:n.xhr.status,url:"function"==typeof e.url?e.url():e.url})},c.a.Collection.prototype.sync.call(h,t,e,n)};n.reset?r():this.readCache().then(r).catch(l)}else c.a.Collection.prototype.sync.call(h,t,e,{...n,success(...t){i&&i.call(this,...t),l(...t)},error(...t){r&&r.call(this,...t),u(...t)}})})},clearSavedData(){return this.timeout&&window.clearInterval(this.timeout),this.key&&(s.a.extension.setItem(this.key,!1),s.a.extension.setItem(this.key+".busy",!1),s.a.extension.setItem(this.key+".nextUpdateTime",!1)),this instanceof c.a.Collection?c.a.Collection.prototype.reset.apply(this):c.a.Model.prototype.clear.apply(this)}};const de=c.a.Collection.extend(he),fe=c.a.Model.extend(he),ge=c.a.Collection.extend({sync(t,e,n){if("read"===t)return s.a.extension.getItem(this.key,n.success)},save(){s.a.extension.setItem(this.key,this.toJSON())},reset(){return s.a.extension.setItem(this.key),c.a.Collection.prototype.reset.apply(this,arguments)}}),pe=c.a.Model.extend({sync(t,e,n){return"read"===t?s.a.extension.getItem(this.key,n.success):"update"===t||"create"===t?(s.a.extension.setItem(this.key,this.toJSON()),Promise.resolve()):void 0}});const me=c.a.Collection.extend({timeout:6e5,nextUpdateTime:0,initialize(t,e){o.default.extend(this,e)},stop(){this.nextUpdateTime=0},sync:function(t,e,n={}){const{success:i,error:r}=n;return new Promise((l,u)=>{"read"===t&&(o.default.now()<e.nextUpdateTime&&!n.reset&&!n.force?(e.trigger("sync",e,null,n),l()):e.loading?e.once("sync",()=>{e.trigger("sync",e,null,n),l()}):(n.beforeSend=function(t){e.ETag&&t.setRequestHeader("If-None-Match",e.ETag),(n.reset||n.force)&&("Edge"===s.a.browser.name?t.setRequestHeader("strict-transport-security","max-age=0, no-cache"):t.setRequestHeader("Cache-Control","max-age=0, no-cache"),t.setRequestHeader("Pragma","no-cache")),t.setRequestHeader("token",window.CBSP.get("usertoken")),a.a.ajaxSettings.beforeSend&&a.a.ajaxSettings.beforeSend.apply(this,arguments)},this.loading=!0,n.success=function(t,s,r){e.loading=!1,e.nextUpdateTime=o.default.now()+e.timeout,e.ETag=r.getResponseHeader("ETag"),304!==r.status?i&&i.apply(e,arguments):e.trigger("sync",e,t,n),l(t,s,r)},n.error=function(...t){e.loading=!1,e.nextUpdateTime=o.default.now()+e.errorTimeout;const[,n]=t;ce({status:n.status,url:"function"==typeof e.url?e.url():e.url}),r&&r.call(e,arguments),u(...t)},c.a.sync.call(this,t,e,n)))})}}),ve=ue.extend({timeout:6e5,errorTimeout:3e3,loading:!1,nextUpdateTime:0,fetch(t={}){return new Promise((e,n)=>{if(o.default.now()<this.nextUpdateTime)t&&t.success&&t.success(this),e();else if(this.loading)this.once("sync",()=>{t&&t.success&&t.success(this),e()});else{this.loading=!0;const i=t.success,s=t.error;t.success=(...t)=>{this.loading=!1,this.nextUpdateTime=o.default.now()+this.timeout,i&&i.call(this,...t),e(...t)},t.error=(...t)=>{this.loading=!1,this.nextUpdateTime=o.default.now()+this.errorTimeout;const[,e]=t;ce({status:e.status,url:"function"==typeof this.url?this.url():this.url}),s&&s.call(this,...t),n(...t)},c.a.Model.prototype.fetch.call(this,t)}})}}),be=ue.extend({initialize(){let t;if(this.has("storeId")?t=this.get("storeId"):this.has("shoppingURL")&&(t=this.get("shoppingURL").match(/\/stores\/(\d+)/).pop()),t){const e=window.CBSP.merchants.findWhere({storeId:parseInt(t,10)});e&&this.set(e.pick("storeName","domainName","reward","totalReward"))}},toJSON(){const t=ue.prototype.toJSON.apply(this,arguments);let e="";const n=t.dealText.match(/Expiration\sDate\s*:\s*([a-zA-Z]{3}\s[\d]{1,2},\s[\d]{4})/);return n&&n[1]&&(e=n[1]),t.smallStoreLogo=window.CBSP.substitute(b.c.CDN_HOST)+t.smallStoreLogo,t.dealTextShort=t.dealText.replace(/ Expiration Date\s*:.*/,""),t.dealTextShort.match(/[^.]\.$/gi)&&(t.dealTextShort=t.dealTextShort.replace(/\.$/gi,"")),t.expDate=e,t.cashbackDisabled=window.CBSP.settings.server.get("cashbackDisabled"),t}});var we=c.a.Collection.extend({model:be,timeout:3e5,lastUpdated:0,parse:t=>t.documentElement?a()("deal",t).map((function(){return{foregroundURL:this.querySelector("foregroundURL").textContent,backgroundURL:this.querySelector("backgroundURL").textContent,dealText:this.querySelector("dropDownText").textContent,dealTextShort:this.querySelector("dropDownText").textContent.replace(/ Expiration Date\s*:.*/,""),trayText:this.querySelector("trayText").textContent,code:this.querySelector("dealCode").textContent,id:this.querySelector("dealId").textContent,link:this.querySelector('link[title="image.smallLogo"]').getAttribute("href")}})).get():t.coupons,initialize(t,e){this.url=e.url,this.merchant=e.merchant},fetch(t={}){return new Promise((e,n)=>{if(new Date-this.lastUpdated<this.timeout)t&&t.success&&t.success(this),e(this);else{const{success:i,error:s}=t;t.success=(...t)=>{i&&i(...t),e(...t)},t.error=(...t)=>{s&&s(...t),n(...t)},c.a.Collection.prototype.fetch.call(this,t)}})},sync(t,e,n){const i=this;if("read"===t)return a.a.ajax({url:this.url(),success:t=>{n.success(t),i.lastUpdated=new Date},error:n.error})}}),_e=n(14),ye=n(11);const xe=ue.extend({initialize(){this.has("storeId")&&![0,2].includes(this.get("activationCode"))?this.deals=new we([],{merchant:this,url:()=>window.CBSP.substitute(_e.a.STORE_DEALS,this.toJSON())}):this.deals=null}}),ke=xe.extend({DEFAULT_TIMEOUT:18e5,idAttribute:"storeId",defaults:{icon:!0,notification:!0,"notification-reminder":!1,activated:!1,suppressed:!1},processCode(){const t=this.get("activationCode"),e=this.get("totalReward"),n=!this.isOptOut&&e&&["None","Coupons"].indexOf(e.display)<0&&(parseFloat(e.amount)>0||e.range&&parseFloat(e.range.high)>0),i=Object(o.default)([3,5]).includes(t)&&n&&!this.isOptOut;this.set({settings_notification:3===t&&n||2===t&&!this.isOptOut,settings_confirmation:i,settings_serp:3===t&&n&&!0!==this.get("serpDisabled"),settings_popup:i,settings_icon:i,settings_deals:i,settings_recent:i,settings_caa:i,settings_purchase:Object(o.default)([3,5]).includes(t),offers_cb:n})},initialize(){return this.processCode(),this.on({"change:totalReward":this.processCode,"change:activationCode":this.processCode,"change:serpDisabled":this.processCode,"change:state":function(t,e){if("activated"===e)this.set({notification:![0,2].includes(this.get("activationCode")),"notification-reminder":!1,activated:!0,suppressed:!1}),this.resetTimeout(!0);else if("suppressed"===e){if(t.get("activated")){const t=window.tabs.active.merchant,e=t&&t.id===this.id?window.tabs.active.tabId:this.get("tabId");if(e&&this.get("offers_cb")){const t=window.CBSP.settings.links.suppresses.where({active:this.get("tabId")})&&window.CBSP.settings.links.suppresses.where({active:this.get("tabId")})[0],n=o.default.extend(this.toJSON(),t?{competitor:t.get("url")}:{},{takeoverUrl:window.tabs.get(this.get("tabId")).url,ttn:window.CBSP.trackingTicketNumber});s.a.extension.fireEvent("takeover",{tabId:e,data:n})}}this.set({activated:!1,notification:!1,"notification-reminder":!1,suppressed:!0}),this.unset("ttn"),this.unset("attribution_source_previous_click"),this.resetTimeout(!0)}else this.set({icon:!0,visit:!1,notification:!0,"notification-reminder":!0,activated:!1,suppressed:!1}),this.unset("ttn"),this.unset("attribution_source_previous_click")}}),xe.prototype.initialize.apply(this,arguments)},activate(t,e){let n;switch(this.attributes.activationCode){case 2:case 5:window.CBSP.redirect(window.CBSP.substitute(this.toJSON().storeDetailsURL,{sourceId:e}),t.tabId);break;default:n=Object(ye.c)(t.url),window.CBSP.redirect(window.CBSP.substitute(this.toJSON().shoppingURL,{sourceId:e})+(t.url?"&deepLinkUrl="+encodeURIComponent(n):""),t.tabId)}},getCashBackAmount(){const t=this.has("totalReward")?this.get("totalReward"):this.get("reward");switch(t.display){case"Percentage":return t.range&&t.range.high?`Up to ${v.a.toFixed(100*t.range.high,2).replace(/0$/,"")}%`:v.a.toFixed(100*t.amount,2).replace(/0$/,"")+"%";case"Fixed":return t.range&&t.range.high?"Up to "+v.a.formatMoney(t.range.high):v.a.formatMoney(t.amount);case"Coupons":return"Offers Only";case"None":return"Not Available"}},cashbackDisabled(){const t=this.has("totalReward")?this.get("totalReward"):this.get("reward");return"None"===t.display||window.CBSP.settings.server.get("cashbackDisabled")||!(t.amount>0||t.range&&t.range.high>0)},toJSON(t){let e=window.CBSP.user.bonuses?window.CBSP.user.bonuses.chain().filter(t=>!(!t.get("qualifyingStores")||!t.isAvailable()||t.hasExpired())&&t.get("qualifyingStores").find(t=>t.id===this.get("storeId"))).invoke("toJSON").value():[],n=ue.prototype.toJSON.call(this);return n.storeDealsURL=window.CBSP.substitute(b.c.STORE_DEALS,o.default.omit(n,"domain"),t),n.storeDetailsURL=window.CBSP.substitute(b.c.STORE_DETAILS,o.default.omit(n,"domain"),t),n.smallStoreLogo=window.CBSP.substitute(b.c.CDN_HOST)+n.images.smallLogo,n.largeStoreLogo=window.CBSP.substitute(b.c.CDN_HOST)+n.images.largeLogo,n.cashBackAmount=this.getCashBackAmount(),n.loggedIn=!!window.CBSP.get("usertoken"),n.cashbackDisabled=this.cashbackDisabled(),n.bonuses=e,n},resetTimeout(){window.clearInterval(this.timeout),this.timeout=window.setInterval(()=>{window.clearInterval(this.timeout),this.unset("state",{silent:!0}),this.unset("ttn"),this.unset("attribution_source_previous_click"),this.trigger("change:state",this),this.timeout=null},this.DEFAULT_TIMEOUT)}}),Ae=ue.extend({initialize(){".*.*"!==this.get("matchPattern")&&(this.rx=new RegExp(this.get("matchPattern"),"i")),this.set({topDomain:Object(ye.a)(this.get("domainName"))})}}),Se=c.a.Collection.extend({model:Ae,matchByTopDomain(t){const e=Object(ye.a)(t);return e?this.where({topDomain:e}):[]},match(t){return this.matchByTopDomain(t).filter(e=>e.rx&&e.rx.test(t))}}),Ee={model:ke,parse(t){var e,n;let i=o.default.flatten(o.default.map(t.domains,t=>t.stores),!0);return null===(e=window.CBSP.settings)||void 0===e||null===(n=e.domains)||void 0===n||n.forEach(t=>{const e=i.find(e=>t.storeId===e.storeId);e&&Object.assign(e,t)}),this.domains.reset(i.map(t=>o.default.pick(t,"storeId","matchPattern","domainName"))),i}};var Ce=de.extend(o.default.extend({url:null,key:"merchants",domains:new Se,wasUpdated:!1,initialize(t,e){return this.CBSP=e.CBSP,this.url=()=>e.CBSP.substitute(_e.a.STORES),this.defaultMerchant=new xe(null,e),this.on("sync",t=>{0===t.filter(t=>"None"!==t.get("totalReward").display).length&&this.CBSP.settings.server.set("cashbackDisabled",!0),this.updateRecent()}),this.once("sync",()=>{this.wasUpdated=!0}),s.a.extension.attachEvent("getMerchant",(t,e)=>{const n=window.tabs.get(t.tabId).merchant;return e&&e(n?n.toJSON():null),!0}),de.prototype.initialize.apply(this,arguments)},updateRecent(){if(this.CBSP&&this.CBSP.user){for(let t=this.CBSP.user.recent.length-1;t>=0;t--){let e=this.CBSP.user.recent.at(t),n=this.get(e.get("storeId"));if(n&&n.get("settings_recent")){let t=n.toJSON();t.cashBackAmount&&e.set({cashBackAmount:t.cashBackAmount})}else this.CBSP.user.recent.remove(e)}this.CBSP.user.recent.sort(),this.CBSP.user.recent.save()}},getCurrent(){return new Promise(t=>{let e=this.match(window.tabs.active.url);e&&e.get("settings_popup")?t(e):(this.defaultMerchant.set({domainName:Object(ye.a)(window.tabs.active.url)},{silent:!0}),t(this.defaultMerchant))})},search(t){return o.default.chain(this.filter(e=>{const n=e.get("storeName").toLowerCase();return e.get("offers_cb")&&0===n.indexOf(t)||n.indexOf("("+t)>=0})).invoke("toJSON").value()}},Ee));let Te=me.extend(o.default.extend({timeout:36e5,domains:new Se,url:()=>window.CBSP.substitute(_e.a.DEACTIVATED_STORES)},Ee));Ce.prototype.model=class extends Ce.prototype.model{get isOptOut(){var t,e,n;return null===(t=window.CBSP)||void 0===t||null===(e=t.settings)||void 0===e||null===(n=e.optOutMerchants)||void 0===n?void 0:n.contains(this.get("storeId"))}};var Ie=class extends Ce{initialize(...t){super.initialize(...t),this.nonMerchants=new Te,this.on("sync",()=>{this.nonMerchants.fetch({add:!0,remove:!1,merge:!1})})}match(t){const e=[...this.domains.match(t)||[],...this.nonMerchants.domains.match(t)||[]];if(e.length){const t=o.default.max(e,t=>t.rx.source.length).get("storeId");return this.get(t)||this.nonMerchants.get(t)}return null}};const Oe=ue.extend({idAttribute:"id",initialize(){if(this.get("expiration")){let t=Math.max(this.get("expiration")-o.default.now(),1e3);t<2147483647&&(this.expirationTimeout=window.setInterval(()=>{window.clearInterval(this.expirationTimeout),this&&this.collection.remove(this)},t))}this.on({remove:()=>{window.clearInterval(this.expirationTimeout)},error:function(t,e){Object(o.default)([401,403]).includes(e.status)&&window.CBSP.onExpiredToken()}})},hasExpired(){const t=this.get("expires");return!t||t&&1e3*t<(new Date).getTime()},isAvailable(){const t=this.get("status");return t&&"pending"===t.toLowerCase()}});var Be=de.extend({key:"bonuses",model:Oe,DEFAULT_UPDATE_INTERVAL:864e5,blacklistedBonusIds:[],blacklistedStoreIds:[],url:()=>window.CBSP.substitute(_e.a.MEMBER_BONUS),initialize(){this.on({error:function(t,e){Object(o.default)([401,403]).includes(e.status)&&window.CBSP.onExpiredToken()},add:t=>{t.get("storeIds")&&1===t.get("storeIds").length&&(window.CBSP.user.messages.find(e=>"bonus"===e.get("type")&&e.get("bonus_id")===t.id)||window.CBSP.user.messages.add({type:"bonus",bonus_id:t.id}))},sync:()=>{window.CBSP.user.bonuses.forEach(t=>{window.CBSP.user.messages.findWhere({date:t.get("date"),storeId:t.get("storeId"),amount:t.get("amount")})||("PurchaseReward"===t.get("type")&&window.CBSP.user.messages.add({storeId:t.get("storeId"),amount:t.get("amount"),amountCurrencyCode:t.get("amountCurrencyCode"),type:"cashback",title:`$${t.get("amount")} just added!`,storeName:t.get("storeName"),text:`You just earned $${t.get("amount")} Cash Back from your purchase at ${t.get("storeName")}! `,cta:"See Cash Back Activity",date:t.get("date")}),"BonusReward"===t.get("type")&&"Pending"===t.get("status")&&window.CBSP.user.messages.add({active:!0,expiration:!!t.get("expires")&&t.get("expires"),storeId:t.get("storeId"),amount:t.get("amount"),bonus:t.get("amount"),type:"bonus",storeName:t.get("storeName"),description:t.get("display"),cta:"See Cash Back Activity",date:t.get("date")}))})}})},sync(t,e,n={}){return!n.beforeSend&&window.CBSP.get("usertoken")&&(n.beforeSend=t=>{t.setRequestHeader("token",window.CBSP.get("usertoken"))}),n.type="GET",de.prototype.sync.apply(this,arguments)},parse(t){return o.default.filter(t.memberRewards,t=>0===o.default.intersection(t.storeIds,this.blacklistedStoreIds).length,this)}});const Pe=c.a.Model.extend({defaults:{created:null,removed:!1,shown:!1,text:"",storeId:void 0},initialize(){this.get("created")||this.set("created",o.default.now()),this.on("change:unread",()=>{this.collection.trigger("change")})},toJSON(){let t=c.a.Model.prototype.toJSON.apply(this,arguments);if("bonus"===this.get("type")){let e=window.CBSP.user.bonuses.get(this.get("bonus_id"));if(e&&(t.bonus=e.toJSON(),t.bonus.description=t.bonus.description.replace(/\$[\d.,]+ Cash Bonus /,""),t.bonus.storeIds&&t.bonus.storeIds.length)){let e=window.CBSP.merchants.get(t.bonus.storeIds[0]);e&&(t.bonus.store=e.toJSON())}}return t}});var Ne=ge.extend({key:"messages",model:Pe,updateBadge(){},initialize(){this.fetch({silent:!0}),this.on({"add remove change reset":function(){this.updateBadge(),this.save()},sync:function(){this.updateBadge()}})},flush(){for(let t=this.models.length-1;t>=0;t--){let e=this.models[t];e.has("created")&&e.get("shown")&&e.get("created")<h()().subtract(window.CBSP.settings.get("messageExpires"))&&e.destroy()}return Promise.resolve()},comporator:"date"});class Re extends me{constructor(...t){super(...t),this.key="trackingtickets"}url(){return window.CBSP.substitute(_e.a.TRACKING_TICKETS)}parse(t){return o.default.flatten(t.tickets)}fetch(...t){return window.CBSP.get("usertoken")?super.fetch(...t):new Promise((e,n)=>{window.CBSP.once({"change:usertoken":()=>{super.fetch(...t).then(e).catch(n)}})})}}let Le=me.extend({url:()=>window.CBSP.substitute(_e.a.FAVORITES),initialize(){return this.on("change reset",()=>{window.CBSP&&window.CBSP.recommended&&window.CBSP.recommended.length&&window.CBSP.recommended.sort()}),me.prototype.initialize.apply(this,arguments)},parse:t=>o.default.chain(t.favorites).map(t=>o.default.extend({storeId:t.id},t)).flatten().value()}),Me=pe.extend({key:"account",initialize(){this.on({"change:pendingAmount change:paidAmount":function(){const t=this.get("pendingAmount"),e=this.get("paidAmount");Number.isFinite(t)&&Number.isFinite(e)&&this.set({totalAmount:t+e})},"change:totalAmount":function(t){const e=t.get("totalAmount"),n=t.previous("totalAmount");Number.isFinite(n)&&Number.isFinite(e)&&e>n&&window.CBSP.user.trackingtickets.fetch().catch()}}),this.trigger("change:pendingAmount")}});const ze=ue.extend({idAttribute:"storeId",defaults:{cashBackDifference:0,lastVisit:(new Date).getTime()},initialize(){this.on("add change:cashBackAmount change:cashBackAmountWas",()=>{if(this.get("cashBackAmount")&&this.get("cashBackAmountWas")){let t=parseFloat(this.get("cashBackAmount").replace(/[^\d.]/g,"")),e=parseFloat(this.get("cashBackAmountWas").replace(/[^\d.]/g,""));t?this.set({cashBackDifference:t-e}):this.collection.remove(this)}})},toJSON(){let t=window.CBSP.merchants.get(this.get("storeId"));return t?o.default.extend(t.toJSON(),ue.prototype.toJSON.apply(this,arguments)):ue.prototype.toJSON.apply(this,arguments)}}),De=ge.extend({model:ze,comparator:(t,e)=>t.get("cashBackDifference")===e.get("cashBackDifference")?t.get("lastVisit")>e.get("lastVisit")?-1:1:t.get("cashBackDifference")>e.get("cashBackDifference")?-1:1,key:"recent",size:4,initialize(){this.on({add:function(){this.sort(),this.length>this.size&&this.pop(),this.save()}}),this.fetch()},visit(t){if(![0,2].includes(t.get("activationCode"))){let e=t.toJSON();this.add({storeId:e.storeId,cashBackAmount:e.cashBackAmount,cashBackAmountWas:e.cashBackAmount,rewardWas:e.totalReward||e.reward,lastVisit:(new Date).getTime()},{merge:!0})}},set(t,e){const n=o.default.isArray(t)?t.map(({storeId:t,cashBackAmount:e,cashBackAmountWas:n,rewardWas:i,lastVisit:s})=>({storeId:t,cashBackAmount:e,cashBackAmountWas:n,rewardWas:i,lastVisit:s})):t;return ge.prototype.set.call(this,n,e)}});var Ue=ve.extend({timeout:18e5,url:()=>window.CBSP.substitute(b.c.MEMBER_DETAILS),defaults:{targetSet:void 0,channelId:2,isScene:!1},initialize(t,e){this.bonuses=new Be,this.accountSummary=new Me,this.messages=new Ne,this.favorites=new Le,this.recent=new De,this.on("change",(function(t,e){e.unset&&(this.nextUpdateTime=0),this.trackingtickets||(this.trackingtickets=new Re),this.trackingtickets.fetch({reset:!0,type:"GET",contentType:"json"}).catch()})),this.on({"change:id":t=>{t.previous("id")&&(this.nextUpdateTime=0,this.recent.reset(),this.bonuses.clearSavedData()),window.CBSP._gaq.set({cd1:this.id})},"change:payableAmount":t=>{window.CBSP.get("usertoken")&&t.previous("id")===t.get("id")&&this.bonuses.fetch({reset:!0})},"change:memberGuid":()=>{window.CBSP&&window.CBSP.trigger("setUninstallPage")},change:function(t,{unset:e}){const n=t.changed;!Object.prototype.hasOwnProperty.call(n,"targetSet")&&!Object.prototype.hasOwnProperty.call(n,"channelId")||e||window.CBSP.merchants.fetch({reset:!0})}}),e.CBSP.tests&&e.CBSP.tests.on("sort change",()=>{this.messages.updateBadge()})},fetch(t={}){return window.CBSP.get("usertoken")?(t.beforeSend=t=>{t.setRequestHeader("token",window.CBSP.get("usertoken"))},ve.prototype.fetch.call(this,t)):Promise.reject()},parse(t){var e;this.accountSummary.save(o.default.reduce(t.accountSummary,(t,e,n)=>(t[n]=Number.isFinite(parseFloat(e))?parseFloat(e):e,t),{})),delete t.accountSummary;const n="true"===(null===(e=t.attributes)||void 0===e?void 0:e.isScene);return delete t.attributes,o.default.defaults({...t,isScene:n},{targetSet:"",egc:null,channelId:n?3:2})},clear(){const t=ve.prototype.clear.call(this);return this.set(this.defaults,{silent:!0}),t},toJSON(){let t=ue.prototype.toJSON.call(this);return t.usertoken=window.CBSP.get("usertoken"),t.cashbackDisabled=window.CBSP.settings.server.get("cashbackDisabled"),t.accountSummary=this.accountSummary.toJSON(),t},stop(){this.bonuses&&this.bonuses.clearSavedData()}}),je=fe.extend({key:"promo",UPDATE_INTERVAL:18e5,url:null,parse(t){if(t.campaigns&&1===t.campaigns.length)return t.campaigns[0]},initialize(){return this.url=()=>window.CBSP.substitute(_e.a.PROMO),fe.prototype.initialize.apply(this,arguments)},toJSON(){return Object(ye.b)(window.CBSP,o.default.clone(this.attributes))}});class He extends c.a.Model{constructor(t){super({url:t}),this.TIMEOUT=6e4}initialize(){this._tabs=new Map}activate(t){this._tabs.has(t)&&window.clearTimeout(this._tabs.get(t)),this._tabs.set(t,window.setTimeout(()=>{this.resetTab(t)},this.TIMEOUT))}isActive(t){return this._tabs.has(t)}resetTab(t){this._tabs.has(t)&&(window.clearTimeout(this._tabs.get(t)),this._tabs.delete(t))}}const Fe=c.a.Collection.extend({model:He,initialize(t){this.set(t)},find(t){return"string"==typeof t?c.a.Collection.prototype.find.call(this,(function(e){return"string"==typeof e.get("url")?t.indexOf(e.get("url"))>0:e.get("url").test(t)})):c.a.Collection.prototype.find.apply(this,arguments)},match(t,e){const n=this.find(t);return n&&n.activate(e),n},reset(t){const e=this.find(e=>e.isActive(t));e&&e.resetTab(t)},state(t){return this.find(e=>e.isActive(t))}}),Je=c.a.Model.extend({suppresses:new Fe,activations:new Fe(b.b.ACTIVATION_PATTERNS),confirmations:new Fe(_e.a.CONFIRMATION_PAGES),initialize(){this._tabs=new Map,s.a.extension.attachEvent("trackingTicketNumber",({tabId:t,data:e})=>{e&&this._tabs.set(t,e)}),s.a.extension.attachEvent("pauseActivation",({tabId:t})=>{this.activations.reset(t)}),s.a.extension.attachEvent("resumeActivation",({tabId:t,url:e,data:n})=>{n&&this._tabs.set(t,n),this.activations.match(e,t)})},match(t,e=0){this.activations.match(t,e),this.activations.state(e)||this.suppresses.match(t,e)},state(t=0){const e={tabId:t,activation:this.activations.state(t),suppress:this.suppresses.state(t)};return this._tabs.has(t)&&(e.ttn=this._tabs.get(t)),e},reset(t=0){this.suppresses.reset(t),this.activations.reset(t),this._tabs.delete(t)}});class $e extends c.a.Model{constructor(t){super({data:t})}toJSON(){return this.get("data")}}const Ge=ge.extend({key:"blacklist",model:$e,initialize(){s.a.extension.attachEvent("blacklist-save",t=>{this.reset(t.data),this.save()})},contains(t){return!!this.find(e=>Object(ye.a)(t)===Object(ye.a)(e.get("data")))}}),qe=ve.extend({timeout:108e5,defaults:{images:{"taf-toolbar-banner-380x130":"/images/toolbar/images/raf.png"}},url:()=>window.CBSP.substitute(_e.a.SERVER_SETTINGS),initialize(){s.a.extension.attachEvent("changeLocale",t=>{s.a.extension.setItem("locale",t.data),window.CBSP.locale=t.data,this.nextUpdateTime=0,this.fetch()}),this.timeoutInteral=window.setInterval(()=>{this.nextUpdateTime=0,this.fetch()},this.timeout)},toJSON(){const t=ve.prototype.toJSON.apply(this,arguments);return window.devicePixelRatio>1&&(t.referImageToolbar=t.referImageToolbar2x),t},parse(t,e){let n=e.xhr.getResponseHeader("Content-Language");return window.CBSP.locale=n?n.replace(/-/,"_"):"en-US",s.a.extension.getItem("locale",t=>{t||s.a.extension.setItem("locale",window.CBSP.locale)}),o.default.extend(t[b.b.SERVER_SETTINGS_SOURCE],{cashbackDisabled:t.cashbackDisabled})}});var We=pe.extend({key:"settings",blacklist:new Ge,links:new Je,server:null,serp:[],domains:[],promo:null,updateInterval:216e5,updateErrorInterval:3e5,rakutenSwitchTimeout:null,defaults:{serpEnabled:!0,loggingEnabled:!0,logging:"eligible",blacklistEnabled:!0,messageExpires:12096e5,isDisabled:!1},async initialize(t,e){const n=window.CBSP||e.CBSP;this.promo=new je,this.server=new qe,this.blacklist.fetch(),s.a.extension.attachEvent("settings-save",(t,e)=>{this.save(t.data),e()}),this.on("change",()=>{this.sync("update")});const i=await this.fetch();i&&this.save(o.default.extend(this.toJSON(),i)),this.update({CBSP:n})},update(t){if(!this.updateTime||o.default.now()>this.updateTime+this.updateInterval){window.clearInterval(this.updateTimeout);const e=window.CBSP||t.CBSP;return a.a.ajax({cache:!0,url:e.substitute(b.c.SETTINGS),dataType:"json",error:()=>{this.updateTimeout=window.setInterval(()=>this.update(),this.updateErrorInterval),this.updateTime||s.a.extension.getItem("settings.data",t=>{if(t)try{let e=JSON.parse(t);t&&this.parseResponse(e)}catch(t){}})},success:t=>{try{this.parseResponse(t),s.a.extension.setItem("settings.data",JSON.stringify(t))}finally{this.updateTime=o.default.now(),this.updateTimeout=window.setInterval(()=>this.update(),this.updateInterval)}}})}return Promise.resolve()},parseResponse(t){t&&(this.links.suppresses.set(t.paidLinks),t.paidLinkPatterns&&this.links.suppresses.add(o.default.map(t.paidLinkPatterns,t=>new RegExp(t))),this.serp=t.serp,this.domains=t.domains||[])},toJSON(){return o.default.extend(pe.prototype.toJSON.apply(this,arguments),{blacklist:this.blacklist.toJSON(),serp:this.serp,server:this.server.toJSON()})}});class Ze extends me{constructor(...t){super(...t),this.key="optOutMerchants",this.model=$e,this.timeout=108e5}url(){return window.CBSP.substitute(b.c.BLACKLIST)}async sync(...t){return window.CBSP.get("usertoken")?super.sync(...t):(await new Promise(t=>{const e=(n,i)=>{i&&(t(),window.CBSP.off("change:usertoken",e))};window.CBSP.on("change:usertoken",e)}),this.sync(...t))}parse(t){var e;return(null==t||null===(e=t.storePersonalization)||void 0===e?void 0:e.blackList)||[]}contains(t){return this.find(e=>e.get("data")===t)}}class Ke extends We{initialize(...t){const[,e]=t,n=window.CBSP||e.CBSP;this.optOutMerchants=new Ze;const i=t=>{this.optOutMerchants.fetch({force:t})};return n.user.on("change:id",()=>i(!0)),n.merchants.on("sync",()=>i()),this.optOutMerchants.on("sync",()=>{n.merchants.forEach(t=>{t.processCode()}),n.merchants.updateRecent()}),this.set({shoppingSerp:[{items:[{injection:"appendTo",pattern:".sh-sr__shop-result-group:not([data-hveid]):not(.sh-vrd__container) .sh-pr__product-results-grid.sh-pr__product-results .sh-dgr__gr-auto.sh-dgr__grid-result > div",url:'.sh-dgr__content a[href^="/aclk?sa=L&"]',comparatorSelector:'.zLPF4b[aria-hidden="true"]',serpElementHeight:b.b.SHOPPING_SERP_HEIGHT,serpAdditionalPadding:b.b.SERP_ADDITIONAL_PADDING,footerSelector:b.b.SHOPPING_TAB_FOOTER_SELECTOR,priceSelector:b.b.SHOPPING_TAB_PRICE_SELECTOR,additionalPriceSelector:b.b.SHOPPING_TAB_ADDITIONAL_PRICE_SELECTOR}]}]}),super.initialize(...t)}}var Ve=me.extend({setExpirationDate(t){if(t){const e=h()(t,"X").toDate().getTime();e<this.nextUpdateTime&&(this.nextUpdateTime=e)}}});var Ye=Ve.extend({UPDATE_INTERVAL:864e5,model:class extends ue{toJSON(...t){const e=super.toJSON(...t);if(window.CBSP.merchants&&window.CBSP.merchants.has(e.id)){const t=window.CBSP.merchants.get(e.id);return o.default.extend(e,t.toJSON())}return null}},url:()=>window.CBSP.substitute(b.c.TOP_STORES),fetch(){if(window.CBSP.merchants&&window.CBSP.merchants.length)return Ve.prototype.fetch.call(this);window.CBSP.merchants.on("sort",()=>{this.fetch()})},parse(t){if(t&&t.campaigns&&t.campaigns.length){const e=t.campaigns[0];return e.expires&&this.setExpirationDate(e.expires),o.default.compact(e.stores.filter(({id:t})=>window.CBSP.merchants.has(t)&&![0,2].includes(window.CBSP.merchants.get(t).get("activationCode"))))}},comparator(t){if(window.CBSP.user.favorites.get(t.get("id")))return t.set({section:"favorite"}),window.CBSP.user.favorites.indexOf(window.CBSP.user.favorites.get(t.get("storeId")))}}),Xe=ge.extend({key:"errorscollection",successFetch:null,maxLength:100,sendInterval:36e5,errorsSyncedTimestamp:null,initialize(){this.on({remove:this.save,add:()=>{this.length>=this.maxLength&&(this.shift({silent:!0}),this.save())}}),this.fetch({success:()=>{a()(document).ajaxError((t,e,n,i)=>{let s;i&&(s=200===e.status?i.message:e.responseJSON&&e.responseJSON.error?e.responseJSON.error.message:"",this.add({code:"Network Error: "+e.status,source:n.url,details:s,timestamp:o.default.now()}))}),a()(window).on("error",t=>{this.add({code:"javascript",source:`${t.originalEvent.filename}:${t.originalEvent.lineno}`,details:t.originalEvent.message,timestamp:o.default.now()})}),this.syncErrors()}}),this.interval=window.setInterval(()=>{this.syncErrors()},9e5)},syncErrors(){s.a.extension.getItem(this.key+".syncTimestamp",(t=0)=>{o.default.now()>t+this.sendInterval&&(this.each(t=>{window.CBSP&&window.CBSP.stat&&window.CBSP.stat(["_trackEvent",t.get("code"),t.get("source"),t.get("details")])}),this.each(t=>{this.remove(t)}),s.a.extension.setItem(this.key+".syncTimestamp",o.default.now()))})}});s.a.extension.attachEvent("openSettings",(function(){s.a.ui.settings.open()}));const Qe=async(t,e)=>{if(p.a&&p.a.cookies){if("string"==typeof e){const n=await p.a.cookies.getAll({domain:t,name:e});if(n.length>0)return n[0].value;{const n=await p.a.cookies.get({url:/^https?:\/\//.test(t)?t:"https://"+t,name:e});if(n)return n.value;throw new Error("no cookies were found")}}{let i=(await p.a.cookies.getAll({domain:t})).reduce((t,n)=>((e===n.name||e.includes(n.name))&&(t[n.name]=n.value),t),{});if(n=i,0===Object.keys(n).length&&n.constructor===Object)throw new Error("no cookies were found");return i}}throw new Error("no cookies were found");var n};Promise.allSettled||(Promise.allSettled=t=>Promise.all(t.map(t=>t.then(t=>({status:"fulfilled",value:t})).catch(t=>({status:"rejected",reason:t})))));var tn=c.a.Model.extend({defaults:{template:b.b.TEMPLATE,cdn:b.c.CDN,domain:b.c.DOMAIN,bid:{Chrome:1,Firefox:2}[s.a.browser.name]||4,uid:void 0,sourceId:1},initialize(){let t=this;this._gaq=le,this.errors=new Xe,this.user=new Ue(null,{CBSP:this}),this.merchants=new Ie(null,{CBSP:this}),this.settings=new Ke(null,{CBSP:this}),this.recommended=new Ye,this.on({"after-install":()=>{s.a.browser.isFirefox&&this.settings.set({loggingEnabled:!1,logging:"pending"}),t.stat(["_trackEvent","ExtensionInstalled",s.a.browser.name,t.get("template")],{force:!0}),Qe(this.get("domain"),b.b.COOKIE_NAME).then(t=>{t&&this.trigger("set-credentials",{data:t})}).catch(()=>{})},"after-update":()=>{s.a.browser.isFirefox&&this.stat(["_trackEvent","FF tracking","eligible"])},"before-navigate":e=>{t.settings.links.match(e.url,e.tabId)},"document-complete":function(t,e){window.clearTimeout(this.session_timeout),this.session_id&&(this.session_timeout=o.default.delay(this.logCloseSession,18e5));const n=Object(ye.a)(t.url);if(["shopathome.com","shopstyle.com","dealmoon.com","mrrebates.com","retailmenot.com","dealsplus.com"].indexOf(n)>=0&&(this.session_competition={event_type:"competitive_visit",location_flag:"competition",url:t.url}),this.set({url:t.url,tabId:t.tabId}),e){const n=window.tabs.get(t.tabId).merchant;e(n?n.toJSON():null)}if(t.url&&t.url.indexOf(this.get("domain"))>-1&&"Safari"!==s.a.browser.name){const t=this.get("usertoken");Qe(this.get("domain"),b.b.COOKIE_NAME).then(e=>{!e||t&&t===e||this.trigger("set-credentials",{data:e})}).catch(()=>{})}},"tab-change":function(e){var n;const i=null===(n=window.tabs.get(e.tabId))||void 0===n?void 0:n.merchant;this.trigger("update-icon",i,e.tabId),this.set({url:e.url,tabId:e.tabId}),i&&t.user&&t.user.recent.visit(i)},"check-merchant":function(e,n){if(!e.data.url||e.data.url.indexOf(".ebates.com/")>=0)return void n();const i=t.merchants.match(e.data.url);let s=!1,r=null;const a=window.tabs.active.tabId;if(i){const n=window.tabs.active.merchant;i.has("visit")||i.set("visit",!0),i.set("tabId",e.tabId),i.resetTimeout();const{activation:l,suppress:c,ttn:u}=t.settings.links.state(e.tabId);(l||c)&&i&&(l?(u&&i.set("ttn",u),i.set("state","activated"),a===e.tabId&&t.trigger("update-icon",i)):c&&(s=!0,i.set("state","suppressed"),t.session_competition&&(this.log(this.session_competition),this.log({event_type:"competitive_activate",location_flag:"competition",url:e.url}),t.session_competition=null),a!==e.tabId&&n&&n.id===i.id&&t.trigger("update-icon",i)),t.settings.links.reset(e.tabId)),r=o.default.extend(i.toJSON(),{confirmation:!!t.settings.links.confirmations.find(e.url),blacklisted:this.settings.get("blacklistEnabled")&&this.settings.blacklist.contains(e.data.url),showTakeover:s}),!i.get("settings_recent")||e.data.from&&"serp"===e.data.from||t.user.recent.visit(i),i.get("activated")&&e.tabId&&i.set({tabId:e.tabId}),a===e.tabId&&t.trigger("update-icon",n,e.tabId)}i&&e.data.deals&&i.deals?i.deals.fetch().finally(()=>{r.deals=i.deals.toJSON(),n(r)}):n(r)},"close-slider":e=>{t.merchants.findWhere({storeId:e.data.storeId}).set("slider",!1)},"get-settings":(t,e)=>{e(this.getSettings())},activate:t=>{const{sourceId:e,storeId:n,currentTab:i,attribution_source_previous_click:s}=t.data;t.tabId||(t.url="",i&&(t.tabId=window.tabs.active.tabId));const r=this.merchants.get(n);r&&(r.activate(t,e||1),s&&r.set({attribution_source_previous_click:s}))},stat:function({data:t=[]}){this.stat(t)},"set-merchant":function(t){if(t.data){const{storeId:e}=t.data,n=this.merchants.findWhere({storeId:e})||this.merchants.nonMerchants.findWhere({storeId:e});n&&n.set(t.data)}},login:t=>{window.login(t)},"set-credentials":function(t){this.set({usertoken:t.data})},"get-user":function(t,e){this.user.fetch({success:t=>{e(t.toJSON())}})},setUninstallPage:()=>{b.c.AFTER_UNINSTALL&&p.a.runtime.setUninstallURL(this.substitute(b.c.AFTER_UNINSTALL))},redirect:({data:{url:t,tabId:e=s.a.browser.NEWTAB}})=>{this.redirect(t,e)},"change:usertoken":(e,n)=>{n?(t.user.clear(),e.previous("usertoken")&&(t.user.messages.reset(),t.user.messages=new Ne),t.user.bonuses.fetch({reset:!0,beforeSend:t=>{t.setRequestHeader("token",n)}}),t.user.favorites.fetch({reset:!0}),this.user.fetch(),t.merchants.invoke("unset","state"),t.save(),t.ping(),s.a.ui.button.detachEvent(s.a.ui.button.CLICK,window.login),s.a.ui.button.setPopup({url:"./popup/popup.html",width:380,height:489})):(s.a.ui.button.setPopup(),s.a.ui.button.attachEvent(s.a.ui.button.CLICK,window.login))},"change:uid":(e,n)=>{this._gaq.set({cid:n}),t.trigger("setUninstallPage")},"click-number":({data:t})=>{this.getCurrentMerchant().set("click-number",t.id)},"open-settings":()=>{s.a.ui.settings.open()},"CAA-review-status":async(t,e)=>{e(await s.a.extension.getItem("CAA-reviewed"))},"CAA-reviewed":()=>{s.a.extension.setItem("CAA-reviewed",2)},"referral-link":(t,e)=>{const n=this.locale&&"fr_CA"===this.locale;e(this.substitute(`${_e.a.HOST}${n?"/fr":""}/${this.user.get("customReferralToken")?"r/"+this.user.get("customReferralToken"):"referrer?referrerid="+(this.user.get("referralToken")||"")}`))},"fb-link":(t,e)=>{e(this.substitute(b.c.FACEBOOK_REDIRECT))},substitute:({data:{url:t="",props:e={}}},n)=>{n(this.substitute(t,e))}})},getSettings(){const{serp:t,logging:e,loggingEnabled:n,isDisabled:i,serpEnabled:s}=this.settings.toJSON();return{...this.toJSON(),serpEnabled:s,serp:t,logging:e,loggingEnabled:n,isDisabled:i,installedTimestamp:this.get("installedTime"),cashbackDisabled:this.settings.server.get("cashbackDisabled")}},substitute(t){return t=Object(ye.d)(t,this.toJSON()),arguments.length>1&&(t=ye.d.call(this,t,arguments[1],arguments[2])),t.replace(/%browser%/g,(s.a.browser.isEdge?"Edge":s.a.browser.name).toLowerCase()).replace(/%username%/g,this.get("usertoken")).replace(/%userId%/,this.user.get("id")).replace(/%channelId%/,this.user.get("channelId")).replace(/(&|\?)(\w+)=%memberGuid%/,this.user.get("memberGuid")?"$1$2="+this.user.get("memberGuid"):"").replace(/(&|\?)(\w+)=%userTargetSet%/g,this.user.get("targetSet")?"$1$2="+this.user.get("targetSet"):"")},stat(t,{force:e=!1}={}){(this.settings.get("loggingEnabled")||e)&&this._gaq.push(t)},redirect(t,e=s.a.browser.NEWTAB){const n=this.substitute(t);s.a.browser.navigate({url:n,tabId:e})},sync(t){const e=this;switch(t){case"read":e.settings.fetch(),e.settings.server.fetch(),e.settings.promo.fetch(),s.a.extension.getItem("cbsp",t=>{if(t&&t.cdn&&0===t.cdn.indexOf("http")&&delete t.cdn,t){this.user.once("sync",()=>{this.merchants.fetch()}),t.installedTime||(t.installedTime=h()(20190701,"YYYYMMDD").valueOf()),Qe(t.domain,b.b.COOKIE_NAME).then(n=>{n&&t.usertoken!==n?(e.user.messages.reset(),e.set(o.default.extend(t,{usertoken:n}))):e.set(t)}).catch(()=>{e.set(t)}),e.get("version")!==s.a.extension.version&&e.trigger("after-update")}else this.merchants.fetch(),e.set({uid:Math.floor(1e9*Math.random(1)),installedTime:(new Date).getTime()}),e.trigger("after-install"),e.save();e.set({version:s.a.extension.version}),e.ping()});break;case"create":s.a.extension.setItem("cbsp",e.toJSON())}},getCurrentMerchant:()=>window.tabs.active.merchant,getCurrent(){return this.merchants.getCurrent()},async deserializePopupData(){const t=await this.getCurrent(),e={merchant:{},deals:[],recommendedStores:[],recent:[],member:{},stores:[],settings:{},promo:{}},n=t&&t.has("storeId")&&![0,2].includes(t.get("activationCode"));return e.merchant=t.toJSON(),n?e.deals=t.deals.toJSON({sourceId:5}):(e.recommendedStores=this.user.recent.length?this.recommended.map(t=>o.default.extend(t.toJSON({sourceId:6}),{store_rank:this.recommended.indexOf(t)})).filter(t=>t&&t.offers_cb&&!this.user.recent.findWhere({storeId:t.id})):this.recommended.map(t=>o.default.extend(t.toJSON({sourceId:6}),{store_rank:this.recommended.indexOf(t)})).filter(t=>t&&t.offers_cb),e.recent=this.user.recent.map(t=>o.default.extend(t.toJSON(),{store_rank:this.user.recent.indexOf(t)})).filter(t=>t),e.member=this.user.toJSON(),e.stores=this.merchants.toJSON(),e.settings=this.settings.toJSON(),e.promo=this.settings.promo.toJSON()),e},updateDataForPopup(t){let e=[];if(t){e=[this.getCurrentMerchant().deals.fetch()]}else e=[this.recommended.fetch(),this.user.fetch(),this.settings.promo.fetch()];return Promise.allSettled(e).then(()=>this.deserializePopupData())},async ping(){if(this.has("usertoken")){const e=await s.a.extension.getItem(["ga_usage","locale"]);o.default.defaults(e,{ga_usage:0,locale:"en"});let n=o.default.now();if(n-e.ga_usage>=864e5){var t;this.stat(["_trackEvent","App","Ping",`${s.a.extension.version} - ${0===e.locale.indexOf("fr")?"FR":"EN"}`]),s.a.extension.setItem("ga_usage",n),await this.user.fetch();const i=this.user;null!==(t=this.settings)&&void 0!==t&&t.get("loggingEnabled")&&a.a.ajax({url:this.substitute(_e.a.TOOLBAR_STATUS),type:"GET",data:{toolbarVersion:s.a.extension.version,osVersion:navigator.userAgent.match(/\((.*?)\)/)[1],userId:i.get("id"),browserVersion:navigator.userAgent,toolbarId:this.get("uid"),source:"toolbar"}})}window.setTimeout(()=>this.ping(),36e5)}},logCloseSession(){var t;const e=this||window.CBSP;e.session_id&&null!==(t=this.settings)&&void 0!==t&&t.get("loggingEnabled")&&a.a.ajax({method:"POST",url:b.c.INTERNAL_LOGGING,data:a.a.param({event_type:"session_end_event",session_id:e.session_id,created_ts:h()().format("DDMMYYYY HHmmss"),tenant:b.b.TENANT})+"&",success:()=>{e.session_id=null,e.session_event=null}})},log(t){if(!this.settings.get("loggingEnabled"))return;t&&t.event_type;let e=this;function n(){return h()().format("DDMMYYYY HHmmss")}return a.a.when(window.CBSP.user.fetch()).then((function(){var i;if(!(null!==(i=e.settings)&&void 0!==i&&i.get("loggingEnabled")||e.session_id))switch(t.event_type){case"icon_click_non_merchant_open":case"slider_open":case"icon_click_merchant_open":case"serp_with_button_label":return e.session_id=`${e.get("uid")}||${h()().format("YYYYMMDDhhmmss")}`,a.a.ajax({method:"POST",url:b.c.INTERNAL_LOGGING,data:a.a.param({event_type:"session_start_event",browser_agent:navigator.userAgent,user_id:window.CBSP.user.get("id"),source:"Button",button_version:s.a.extension.version,session_id:e.session_id,url:t.url||window.tabs.active.url,created_ts:n(),ip_address:null,tenant:b.b.TENANT})+"&"})}})).then((function(){switch(t.event_type){case"activate_slider":case"activate_widget":if(!t.tracking_ticket){e.session_event=o.default.extend({session_id:e.session_id,created_ts:n(),url:window.tabs.active.url,tenant:b.b.TENANT},o.default.pick(t,o.default.identity));break}default:return a.a.ajax({method:"POST",url:b.c.INTERNAL_LOGGING,data:a.a.param(o.default.extend({session_id:e.session_id,created_ts:n(),url:window.tabs.active.url,tenant:b.b.TENANT,toolbarId:e.get("uid"),user_id:window.CBSP.user.get("id")},o.default.pick(t,o.default.identity)))+"&"})}})).then((function(){t.event_type}))},captureOrderPage(t){a.a.ajax({method:"POST",contentType:"application/json",processData:!1,url:this.substitute(_e.a.CAPTURE_ORDER),data:new Uint8Array(new f.a.gzip(JSON.stringify(t))),beforeSend:t=>{t.setRequestHeader("Content-Encoding","gzip"),t.setRequestHeader("X-Button-Version",s.a.extension.version)}})},onExpiredToken(){this.unset("usertoken"),this.user&&this.user.stop()}}),en=de.extend({model:c.a.Model,UPDATE_INTERVAL:864e5,url:()=>window.CBSP.substitute(_e.a.COUPONS_CONFIG),parse:t=>t.coupons});const nn=ue.extend({DEFAULT_TIMEOUT:18e5,idAttribute:"tierId",defaults:{notification:!0},activate({sourceId:t=1}={}){const e=window.CBSP.substitute(b.c.GIFT_CARD_ACTIVATION,{storeId:this.get("tierId"),tier:_e.a.GIFT_CARD_TIER,sourceId:t});window.CBSP.redirect(e)}});var sn=class extends me{constructor(...t){super(...t),this.timeout=36e5,this.model=nn,this.key="gift_card",this.url=()=>window.CBSP.substitute(_e.a.GIFT_CARD_STORES,{tier:_e.a.GIFT_CARD_TIER})}parse(t){if(t&&t.displayTiers&&t.displayTiers.length)return t.displayTiers.filter(({tierId:t})=>b.b.giftCardIds.find(({storeId:e})=>t===e)).map(t=>{const{domain:e,logo:n}=b.b.giftCardIds.find(({storeId:e})=>t.tierId===e);return{...t,domain:e,logo:n}})}match(t){const e=Object(ye.a)(t);return this.find(t=>t.get("domain")===e)}static isAvailable(t){const e=Object(ye.a)(t);return b.b.giftCardIds.find(({domain:t})=>e===t)}};let rn=c.a.Model.extend({defaults:{value:""},initialize(){this.on("remove",(function(t){window.CBSP.log({event_type:"test_group_tracking",user_id:window.CBSP.user.get("id"),test_group:t.id+"X"})})),this.on("change:value add",(function(t){window.CBSP.log({event_type:"test_group_tracking",user_id:window.CBSP.user.get("id"),test_group:t.id+t.get("value")})}))}});var an=ge.extend({model:rn,key:"tests",reload(){window.CBSP&&window.CBSP.user&&window.CBSP.user.get("id")&&a.a.ajax({url:window.CBSP.substitute(b.c.SETTINGS_TESTS),dataType:"json",success:t=>{this.set(o.default.map(t,(function(t,e){return{id:e,value:t}})),{add:!0,merge:!0,remove:!0}),this.save()}})},initialize(){"Chrome"===s.a.browser.name&&(window.setInterval(()=>{this.reload()},144e5),this.on("sync",()=>{o.default.delay(()=>{this.reload()},1e3)}),window.CBSP&&window.CBSP.get("usertoken")&&this.fetch({silent:!0})),s.a.extension.attachEvent("tests",(t,e)=>{e(this.toJSON())})},save(){return this.get(100)&&window.CBSP.user&&window.CBSP.user.messages.updateBadge(),ge.prototype.save.call(this)}});let on,ln=0,cn=0,un="",hn=!1,dn={neutral:null,activated:null,available:null},fn=0,gn=0,pn=!1;var mn=class extends tn{initialize(...t){super.initialize(...t),this.giftCards=new sn,this.tests=new an,this.coupons=new en,this.icon=new class{constructor(t={}){CanvasRenderingContext2D.prototype.roundRect=function(t,e,n,i,s,r,a){var o={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0};if(void 0===a&&(a=!0),"object"==typeof s)for(let t in s)Object.hasOwnProperty.call(s,t)&&(o[t]=s[t]);this.beginPath(),this.moveTo(t+o.upperLeft,e),this.lineTo(t+n-o.upperRight,e),this.quadraticCurveTo(t+n,e,t+n,e+o.upperRight),this.lineTo(t+n,e+i-o.lowerRight),this.quadraticCurveTo(t+n,e+i,t+n-o.lowerRight,e+i),this.lineTo(t+o.lowerLeft,e+i),this.quadraticCurveTo(t,e+i,t,e+i-o.lowerLeft),this.lineTo(t,e+o.upperLeft),this.quadraticCurveTo(t,e,t+o.upperLeft,e),this.closePath(),a&&this.stroke(),r&&this.fill()},this.URLs=s.a.browser.isLegacyEdge?b.a.edge:b.a;const e=document.createElement("canvas");this.context=e.getContext("2d"),this.options={speed:60,count:0,callback:null,images:null,...t},t.model.on("update-icon",t=>{if(this.stop(),!t||[0,2].includes(t.get("activationCode"))||t.get("suppressed")||window.CBSP.settings.server.get("cashbackDisabled")||!t.get("settings_icon")){this.stop();let t=this.animate(0,"neutral",!1);this.set({remote:t,local:pn?this.URLs.legacy.neutral:this.URLs.neutral})}else if(un=t.get("activated")?"activated":"available",t.get("activated"))if(t.get("icon"))this.play({count:5}),t.set("icon",!1);else{const t=this.animate(fn/2,un,!0);this.set({remote:t,local:pn?this.URLs.legacy[un]:this.URLs[un]})}else this.play({count:11})});for(const t in dn)Object.hasOwnProperty.call(dn,t)&&this.setAnimatable(b.a[t],t)}animate(t,e,n){const i=this.context;try{const s=dn[e]||dn.neutral;i.clearRect(0,0,s.width,s.height),i.setLineDash([0]);let r=fn/10;if(["activated","available"].includes(e)){i.lineWidth=10,i.strokeStyle="activated"===e?"#4A90E2":"#ff3300",i.fillStyle="activated"===e?"#fff":"#ff3300";const a=4*t-2*r;i.roundRect(s.width/2-4*t/2+r,s.height/2-4*t/2+r,a,a,{upperLeft:gn,upperRight:gn,lowerLeft:gn,lowerRight:gn},!!n)}return i.drawImage(s,r,r,s.width-2*r,s.height-2*r),i.getImageData(0,0,s.width,s.height)}catch(t){}}set(t){if(t)if(!s.a.browser.isLegacyEdge&&hn)try{chrome.browserAction.setIcon({imageData:t.remote})}catch(t){if(!pn){pn=!0;for(const t in dn)Object.hasOwnProperty.call(dn,t)&&this.setAnimatable(this.URLs.legacy[t],t)}}else s.a.ui.button.setIcon(t.local)}play(t){this.stop();const e={...this.options,...t};this.options=e,this.URLs.animationSteps?on=window.setInterval(()=>{this.next()},e.speed):this.set({local:this.URLs[un]})}stop(){on&&window.clearInterval(on),ln=0,cn=0,this.options.callback=null}next(){const t=this.options;if(++ln>=this.URLs.animationSteps&&(ln=0,t.count&&++cn>t.count))return t.callback&&t.callback(),void this.stop();let e=this.animate(fn/2/t.maxValue*ln,un,!0);this.set({local:pn?this.URLs.legacy[un]:this.URLs[un],remote:e})}setAnimatable(t,e="neutral"){const n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{hn=!0,fn=n.height/2,gn=n.height/5,this.options.model.trigger("tab-change",window.tabs.active)},n.onerror=()=>{const n=this.URLs.legacy[e],i=this.URLs[e];pn?n!==t&&this.setAnimatable(n):i!==t&&this.setAnimatable(i)},n.src=t,dn[e]=n}}({minValue:1,maxValue:7,speed:80,model:this}),this.user.on({"change:id":t=>{t.id&&this.tests.reload()}}),this.on({"after-install":()=>{this.redirect(this.substitute(b.c.AFTER_INSTALL))},"get-coupons":function(t,e){e(this.coupons.toJSON())},"get-gift":async({url:t},e)=>{if(sn.isAvailable(t)){try{await this.giftCards.fetch()}catch(t){}const n=this.giftCards.match(t);e(n&&n.toJSON())}},"activate-gift":({data:t})=>{const{tierId:e}=t;this.giftCards.get(e).activate(t)},"close-gift":({data:t})=>{const{tierId:e}=t;this.giftCards.has(e)&&this.giftCards.get(e).set({notification:!1})},"check-shopping-url":async({url:t,data:e},n)=>{const i=new URL(t).origin+e.url;try{const t=await fetch(i);n(this.merchants.match(t.url))}catch(t){n(null)}}})}sync(t,...e){"read"===t&&this.coupons.fetch(),super.sync(t,...e)}getSettings(){return{...super.getSettings(),locale:this.locale?this.locale:"en",tests:this.tests.toJSON(),shoppingSerp:this.settings.toJSON().shoppingSerp}}};class vn{constructor({tabId:t,url:e}){this.tabId=t,this.url=e,this.checkMerchant();const n=()=>{this.checkMerchant()};window.CBSP.merchants.on("sync",n),this.clear=()=>{window.CBSP.merchants.off("sync",n)}}update({tabId:t,url:e}){(this.isEligibleMerchant||this.topDomain!==Object(ye.a)(e))&&this.checkMerchant(e),this.url=e,this.tabId=t}checkMerchant(t=this.url){var e,n;this.isEligibleMerchant=!![...window.CBSP.merchants.domains.matchByTopDomain(t),...(null===(e=window.CBSP.merchants.nonMerchants)||void 0===e||null===(n=e.domains)||void 0===n?void 0:n.matchByTopDomain(t))||[]].length}get merchant(){return this.isEligibleMerchant?window.CBSP.merchants.match(this.url):null}get topDomain(){return Object(ye.a)(this.url)||""}}class bn extends Map{constructor(){super(),this._currentTabId=0;let t=t=>{(t.name===s.a.browser.TABCHANGED||t.name===s.a.browser.DOCUMENTCOMPLETE&&t.active)&&(this._currentTabId=t.tabId),delete t.name,this.has(t.tabId)?this.get(t.tabId).update(t):this.set(t.tabId,new vn(t))};s.a.browser.attachEvent(s.a.browser.DOCUMENTCOMPLETE,t),s.a.browser.attachEvent(s.a.browser.TABCHANGED,t),s.a.browser.attachEvent(s.a.browser.TABCLOSED,t=>{this.has(t.tabId)&&this.get(t.tabId).clear(),this.delete(t.tabId)})}get active(){return this.get(this._currentTabId)||{tabId:0,url:"about: blank"}}}var wn=bn;window.login=(t={})=>{s.a.browser.navigate({url:window.CBSP.substitute(b.c.LOGIN)}),t.name===s.a.ui.button.CLICK&&window.CBSP.stat(["_trackEvent","Popup","Clicked","PopupLogin"])},a()(()=>{window.CBSP=new mn,window.tabs=new wn,window.CBSP.fetch(),window.CBSP.get("usertoken")||s.a.ui.button.attachEvent(s.a.ui.button.CLICK,window.login),s.a.browser.attachEvent(s.a.browser.BEFORENAVIGATE,t=>{window.CBSP.trigger("before-navigate",t)}),s.a.browser.attachEvent(s.a.browser.DOCUMENTCOMPLETE,t=>{window.clearTimeout(window.CBSP.session_timeout),window.CBSP.session_id&&(window.CBSP.session_timeout=window.setTimeout(window.CBSP.logCloseSession,18e5)),window.CBSP.trigger("document-complete",t)}),s.a.browser.attachEvent(s.a.browser.TABCHANGED,t=>{window.CBSP.trigger("tab-change",t)}),s.a.extension.attachEvent("trigger",(t,e)=>{t.data&&window.CBSP.trigger(t.data.trigger,{url:t.url,tabId:t.tabId,data:t.data.data},e)}),s.a.extension.attachEvent("InternalLoggingEvent",({url:t,data:e})=>{const{event_type:n}=e;window.CBSP.log(a.a.extend({url:t},e),{force:"FF_tracking"===n})}),s.a.extension.attachEvent("getSettings",(t,e)=>{window.CBSP&&e(window.CBSP.settings.toJSON())}),s.a.extension.attachEvent("getAccount",async(t,e)=>{var n;if(null!==(n=window.CBSP)&&void 0!==n&&n.get("usertoken"))try{await window.CBSP.user.fetch(),e(window.CBSP.user.toJSON())}catch(t){}else e(window.CBSP.user.toJSON())});let t={};s.a.extension.attachEvent("CaptureOrderPage",e=>{if(t[e.tabId]&&t[e.tabId]===e.url||!window.CBSP.settings.get("loggingEnabled"))return;t[e.tabId]=e.url;const n=e.data.merchant&&e.data.merchant.ttn;n&&window.CBSP.captureOrderPage({tenant_id:3,source_name:"toolbar",store_name:e.data.merchant.storeName,store_id:e.data.merchant.storeId,shopping_trip_id:n,content_source:e.url,content_type:"order confirmation",content_format:"html",client_type:s.a.browser.name.toLowerCase(),client_version:s.a.extension.version,content:e.data.content,load_time:e.data.load_time,javascript_error:e.data.javascript_error})});let e=e=>{t[e.tabId]&&e.url!==t[e.tabId]&&delete t[e.tabId]};s.a.browser.attachEvent(s.a.browser.DOCUMENTCOMPLETE,e),s.a.browser.attachEvent(s.a.browser.TABCLOSED,e),s.a.extension.attachEvent("trackingTicketNumber",t=>{window.CBSP.trackingTicketNumber=t.data,window.CBSP.session_event&&(window.CBSP.log(o.default.extend(window.CBSP.session_event,{tracking_ticket:window.CBSP.trackingTicketNumber})),window.CBSP.session_event=null)}),s.a.extension.attachEvent("login",window.login),s.a.extension.getItem("locale",t=>{window.CBSP.locale=t||"en"}),s.a.extension.attachEvent("getLocale",(t,e)=>{window.CBSP&&e(window.CBSP.locale||"en")})})},16:function(t,e,n){var i,s,r;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t],void 0===(r="function"==typeof(i=function(t){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const e="The message port closed before a response was received.",n=t=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class i extends WeakMap{constructor(t,e){super(e),this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}const s=(e,n)=>(...i)=>{t.runtime.lastError?e.reject(t.runtime.lastError):n.singleCallbackArg||i.length<=1&&!1!==n.singleCallbackArg?e.resolve(i[0]):e.resolve(i)},r=t=>1==t?"argument":"arguments",a=(t,e,n)=>new Proxy(e,{apply:(e,i,s)=>n.call(i,t,...s)});let o=Function.call.bind(Object.prototype.hasOwnProperty);const l=(t,e={},n={})=>{let i=Object.create(null),c={has:(e,n)=>n in t||n in i,get(c,u,h){if(u in i)return i[u];if(!(u in t))return;let d=t[u];if("function"==typeof d)if("function"==typeof e[u])d=a(t,t[u],e[u]);else if(o(n,u)){let e=((t,e)=>function(n,...i){if(i.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${r(e.minArgs)} for ${t}(), got ${i.length}`);if(i.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${r(e.maxArgs)} for ${t}(), got ${i.length}`);return new Promise((r,a)=>{if(e.fallbackToNoCallback)try{n[t](...i,s({resolve:r,reject:a},e))}catch(s){n[t](...i),e.fallbackToNoCallback=!1,e.noCallback=!0,r()}else e.noCallback?(n[t](...i),r()):n[t](...i,s({resolve:r,reject:a},e))})})(u,n[u]);d=a(t,t[u],e)}else d=d.bind(t);else if("object"==typeof d&&null!==d&&(o(e,u)||o(n,u)))d=l(d,e[u],n[u]);else{if(!o(n,"*"))return Object.defineProperty(i,u,{configurable:!0,enumerable:!0,get:()=>t[u],set(e){t[u]=e}}),d;d=l(d,e[u],n["*"])}return i[u]=d,d},set:(e,n,s,r)=>(n in i?i[n]=s:t[n]=s,!0),defineProperty:(t,e,n)=>Reflect.defineProperty(i,e,n),deleteProperty:(t,e)=>Reflect.deleteProperty(i,e)},u=Object.create(t);return new Proxy(u,c)},c=t=>({addListener(e,n,...i){e.addListener(t.get(n),...i)},hasListener:(e,n)=>e.hasListener(t.get(n)),removeListener(e,n){e.removeListener(t.get(n))}});let u=!1;const h=new i(t=>"function"!=typeof t?t:function(e,n,i){let s,r,a=!1,o=new Promise(t=>{s=function(e){u||(u=!0),a=!0,t(e)}});try{r=t(e,n,s)}catch(t){r=Promise.reject(t)}const l=!0!==r&&(c=r)&&"object"==typeof c&&"function"==typeof c.then;var c;if(!0!==r&&!l&&!a)return!1;const h=t=>{t.then(t=>{i(t)},t=>{let e;e=t&&(t instanceof Error||"string"==typeof t.message)?t.message:"An unexpected error occurred",i({__mozWebExtensionPolyfillReject__:!0,message:e})}).catch(t=>{})};return h(l?r:o),!0}),d=({reject:n,resolve:i},s)=>{t.runtime.lastError?t.runtime.lastError.message===e?i():n(t.runtime.lastError):s&&s.__mozWebExtensionPolyfillReject__?n(new Error(s.message)):i(s)},f=(t,e,n,...i)=>{if(i.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${r(e.minArgs)} for ${t}(), got ${i.length}`);if(i.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${r(e.maxArgs)} for ${t}(), got ${i.length}`);return new Promise((t,e)=>{const s=d.bind(null,{resolve:t,reject:e});i.push(s),n.sendMessage(...i)})},g={runtime:{onMessage:c(h),onMessageExternal:c(h),sendMessage:f.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:f.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},p={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":p},services:{"*":p},websites:{"*":p}},l(t,g,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");t.exports=n(chrome)}else t.exports=browser})?i.apply(e,s):i)||(t.exports=r)},17:function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)s(n,i)&&(t[i]=n[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,n,i,s){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),s);else for(var r=0;r<i;r++)t[s+r]=e[n+r]},flattenChunks:function(t){var e,n,i,s,r,a;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(a=new Uint8Array(i),s=0,e=0,n=t.length;e<n;e++)r=t[e],a.set(r,s),s+=r.length;return a}},a={arraySet:function(t,e,n,i,s){for(var r=0;r<i;r++)t[s+r]=e[n+r]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(i)},2:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(n(115)),r=i(n(116)),a=i(n(117)),o=i(n(118));e.default=new class{constructor(){this.browser=new s.default,this.extension=new r.default(this),this.ui={button:new a.default,settings:new o.default(this)}}}},29:function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},66:function(t,e,n){"use strict";t.exports=function(t,e,n,i){for(var s=65535&t|0,r=t>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{r=r+(s=s+e[i++]|0)|0}while(--a);s%=65521,r%=65521}return s|r<<16|0}},67:function(t,e,n){"use strict";var i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,s){var r=i,a=s+n;t^=-1;for(var o=s;o<a;o++)t=t>>>8^r[255&(t^e[o])];return-1^t}},68:function(t,e,n){"use strict";var i=n(17),s=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(t){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){r=!1}for(var a=new i.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&r||!t.subarray&&s))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var n="",a=0;a<e;a++)n+=String.fromCharCode(t[a]);return n}a[254]=a[254]=1,e.string2buf=function(t){var e,n,s,r,a,o=t.length,l=0;for(r=0;r<o;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<o&&56320==(64512&(s=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(s-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new i.Buf8(l),a=0,r=0;a<l;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<o&&56320==(64512&(s=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(s-56320),r++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new i.Buf8(t.length),n=0,s=e.length;n<s;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,i,s,r,o=e||t.length,c=new Array(2*o);for(i=0,n=0;n<o;)if((s=t[n++])<128)c[i++]=s;else if((r=a[s])>4)c[i++]=65533,n+=r-1;else{for(s&=2===r?31:3===r?15:7;r>1&&n<o;)s=s<<6|63&t[n++],r--;r>1?c[i++]=65533:s<65536?c[i++]=s:(s-=65536,c[i++]=55296|s>>10&1023,c[i++]=56320|1023&s)}return l(c,i)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+a[t[n]]>e?n:e}},69:function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},70:function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},75:function(t,e,n){"use strict";var i={};(0,n(17).assign)(i,n(119),n(122),n(70)),t.exports=i},9:function(t,e,n){(function(i){var s,r,a;a="object"==typeof self&&self.self===self&&self||"object"==typeof i&&i.global===i&&i,s=[n(0),n(1),e],void 0===(r=function(t,e,n){a.Backbone=function(t,e,n,i){var s=t.Backbone,r=Array.prototype.slice;e.VERSION="1.4.0",e.$=i,e.noConflict=function(){return t.Backbone=s,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a,o=e.Events={},l=/\s+/,c=function(t,e,i,s,r){var a,o=0;if(i&&"object"==typeof i){void 0!==s&&"context"in r&&void 0===r.context&&(r.context=s);for(a=n.keys(i);o<a.length;o++)e=c(t,e,a[o],i[a[o]],r)}else if(i&&l.test(i))for(a=i.split(l);o<a.length;o++)e=t(e,a[o],s,r);else e=t(e,i,s,r);return e};o.on=function(t,e,n){return this._events=c(u,this._events||{},t,e,{context:n,ctx:this,listening:a}),a&&((this._listeners||(this._listeners={}))[a.id]=a,a.interop=!1),this},o.listenTo=function(t,e,i){if(!t)return this;var s=t._listenId||(t._listenId=n.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),o=a=r[s];o||(this._listenId||(this._listenId=n.uniqueId("l")),o=a=r[s]=new m(this,t));var l=h(t,e,i,this);if(a=void 0,l)throw l;return o.interop&&o.on(e,i),this};var u=function(t,e,n,i){if(n){var s=t[e]||(t[e]=[]),r=i.context,a=i.ctx,o=i.listening;o&&o.count++,s.push({callback:n,context:r,ctx:r||a,listening:o})}return t},h=function(t,e,n,i){try{t.on(e,n,i)}catch(t){return t}};o.off=function(t,e,n){return this._events?(this._events=c(d,this._events,t,e,{context:n,listeners:this._listeners}),this):this},o.stopListening=function(t,e,i){var s=this._listeningTo;if(!s)return this;for(var r=t?[t._listenId]:n.keys(s),a=0;a<r.length;a++){var o=s[r[a]];if(!o)break;o.obj.off(e,i,this),o.interop&&o.off(e,i)}return n.isEmpty(s)&&(this._listeningTo=void 0),this};var d=function(t,e,i,s){if(t){var r,a=s.context,o=s.listeners,l=0;if(e||a||i){for(r=e?[e]:n.keys(t);l<r.length;l++){var c=t[e=r[l]];if(!c)break;for(var u=[],h=0;h<c.length;h++){var d=c[h];if(i&&i!==d.callback&&i!==d.callback._callback||a&&a!==d.context)u.push(d);else{var f=d.listening;f&&f.off(e,i)}}u.length?t[e]=u:delete t[e]}return t}for(r=n.keys(o);l<r.length;l++)o[r[l]].cleanup()}};o.once=function(t,e,n){var i=c(f,{},t,e,this.off.bind(this));return"string"==typeof t&&null==n&&(e=void 0),this.on(i,e,n)},o.listenToOnce=function(t,e,n){var i=c(f,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,i)};var f=function(t,e,i,s){if(i){var r=t[e]=n.once((function(){s(e,r),i.apply(this,arguments)}));r._callback=i}return t};o.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;i<e;i++)n[i]=arguments[i+1];return c(g,this._events,t,void 0,n),this};var g=function(t,e,n,i){if(t){var s=t[e],r=t.all;s&&r&&(r=r.slice()),s&&p(s,i),r&&p(r,[e].concat(i))}return t},p=function(t,e){var n,i=-1,s=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++i<s;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=t[i]).callback.call(n.ctx,r);return;case 2:for(;++i<s;)(n=t[i]).callback.call(n.ctx,r,a);return;case 3:for(;++i<s;)(n=t[i]).callback.call(n.ctx,r,a,o);return;default:for(;++i<s;)(n=t[i]).callback.apply(n.ctx,e);return}},m=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=o.on,m.prototype.off=function(t,e){var n;this.interop?(this._events=c(d,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},o.bind=o.on,o.unbind=o.off,n.extend(e,o);var v=e.Model=function(t,e){var i=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var s=n.result(this,"defaults");i=n.defaults(n.extend({},s,i),s),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(v.prototype,o,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var s;if("object"==typeof t?(s=t,i=e):(s={})[t]=e,i||(i={}),!this._validate(s,i))return!1;var r=i.unset,a=i.silent,o=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var d in s)e=s[d],n.isEqual(c[d],e)||o.push(d),n.isEqual(h[d],e)?delete u[d]:u[d]=e,r?delete c[d]:c[d]=e;if(this.idAttribute in s&&(this.id=this.get(this.idAttribute)),!a){o.length&&(this._pending=i);for(var f=0;f<o.length;f++)this.trigger("change:"+o[f],this,c[o[f]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,i=this._changing?this._previousAttributes:this.attributes,s={};for(var r in t){var a=t[r];n.isEqual(i[r],a)||(s[r]=a,e=!0)}return!!e&&s},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var s=t.parse?e.parse(n,t):n;if(!e.set(s,t))return!1;i&&i.call(t.context,e,n,t),e.trigger("sync",e,n,t)},$(this,t),this.sync("read",this,t)},save:function(t,e,i){var s;null==t||"object"==typeof t?(s=t,i=e):(s={})[t]=e;var r=(i=n.extend({validate:!0,parse:!0},i)).wait;if(s&&!r){if(!this.set(s,i))return!1}else if(!this._validate(s,i))return!1;var a=this,o=i.success,l=this.attributes;i.success=function(t){a.attributes=l;var e=i.parse?a.parse(t,i):t;if(r&&(e=n.extend({},s,e)),e&&!a.set(e,i))return!1;o&&o.call(i.context,a,t,i),a.trigger("sync",a,t,i)},$(this,i),s&&r&&(this.attributes=n.extend({},l,s));var c=this.isNew()?"create":i.patch?"patch":"update";"patch"!==c||i.attrs||(i.attrs=s);var u=this.sync(c,this,i);return this.attributes=l,u},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,s=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){s&&r(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var a=!1;return this.isNew()?n.defer(t.success):($(this,t),a=this.sync("delete",this,t)),s||r(),a},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||J();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return!i||(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1)}});var b=e.Collection=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},w={add:!0,remove:!0,merge:!0},_={add:!0,remove:!1},y=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i,s=Array(t.length-n),r=e.length;for(i=0;i<s.length;i++)s[i]=t[i+n];for(i=0;i<r;i++)t[i+n]=e[i];for(i=0;i<s.length;i++)t[i+r+n]=s[i]};n.extend(b.prototype,o,{model:v,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,_))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:t.slice();var s=this._removeModels(t,e);return!e.silent&&s.length&&(e.changes={added:[],merged:[],removed:s},this.trigger("update",this,e)),i?s[0]:s},set:function(t,e){if(null!=t){(e=n.extend({},w,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var i=!n.isArray(t);t=i?[t]:t.slice();var s=e.at;null!=s&&(s=+s),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);var r,a,o=[],l=[],c=[],u=[],h={},d=e.add,f=e.merge,g=e.remove,p=!1,m=this.comparator&&null==s&&!1!==e.sort,v=n.isString(this.comparator)?this.comparator:null;for(a=0;a<t.length;a++){r=t[a];var b=this.get(r);if(b){if(f&&r!==b){var _=this._isModel(r)?r.attributes:r;e.parse&&(_=b.parse(_,e)),b.set(_,e),c.push(b),m&&!p&&(p=b.hasChanged(v))}h[b.cid]||(h[b.cid]=!0,o.push(b)),t[a]=b}else d&&(r=t[a]=this._prepareModel(r,e))&&(l.push(r),this._addReference(r,e),h[r.cid]=!0,o.push(r))}if(g){for(a=0;a<this.length;a++)h[(r=this.models[a]).cid]||u.push(r);u.length&&this._removeModels(u,e)}var x=!1,k=!m&&d&&g;if(o.length&&k?(x=this.length!==o.length||n.some(this.models,(function(t,e){return t!==o[e]})),this.models.length=0,y(this.models,o,0),this.length=this.models.length):l.length&&(m&&(p=!0),y(this.models,l,null==s?this.length:s),this.length=this.models.length),p&&this.sort({silent:!0}),!e.silent){for(a=0;a<l.length;a++)null!=s&&(e.index=s+a),(r=l[a]).trigger("add",r,this,e);(p||x)&&this.trigger("sort",this,e),(l.length||u.length||c.length)&&(e.changes={added:l,removed:u,merged:c},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var i=e.length;return n.isFunction(e)&&(e=e.bind(this)),1===i||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=n.extend({parse:!0},t)).success,i=this;return t.success=function(n){var s=t.reset?"reset":"set";i[s](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},$(this,t),this.sync("read",this,t)},create:function(t,e){var i=(e=e?n.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;i||this.add(t,e);var s=this,r=e.success;return e.success=function(t,e,n){i&&s.add(t,n),r&&r.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new k(this,A)},keys:function(){return new k(this,S)},entries:function(){return new k(this,E)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?n.clone(e):{}).collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var s=this.get(t[i]);if(s){var r=this.indexOf(s);this.models.splice(r,1),this.length--,delete this._byId[s.cid];var a=this.modelId(s.attributes);null!=a&&delete this._byId[a],e.silent||(e.index=r,s.trigger("remove",s,this,e)),n.push(s),this._removeReference(s,e)}}return n},_isModel:function(t){return t instanceof v},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,i),"change"===t){var s=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);s!==r&&(null!=s&&delete this._byId[s],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}});var x="function"==typeof Symbol&&Symbol.iterator;x&&(b.prototype[x]=b.prototype.values);var k=function(t,e){this._collection=t,this._kind=e,this._index=0},A=1,S=2,E=3;x&&(k.prototype[x]=function(){return this}),k.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===A)t=e;else{var n=this._collection.modelId(e.attributes);t=this._kind===S?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var C=e.View=function(t){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(t,I)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,I=["model","collection","el","id","attributes","className","tagName","events"];n.extend(C.prototype,o,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var s=e.match(T);this.delegate(s[1],s[2],i.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var O=function(t,e,i,s){n.each(i,(function(n,i){e[i]&&(t.prototype[i]=function(t,e,n,i){switch(e){case 1:return function(){return t[n](this[i])};case 2:return function(e){return t[n](this[i],e)};case 3:return function(e,s){return t[n](this[i],B(e,this),s)};case 4:return function(e,s,r){return t[n](this[i],B(e,this),s,r)};default:return function(){var e=r.call(arguments);return e.unshift(this[i]),t[n].apply(t,e)}}}(e,n,i,s))}))},B=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?P(t):n.isString(t)?function(e){return e.get(t)}:t},P=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}};n.each([[b,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[v,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],(function(t){var e=t[0],i=t[1],s=t[2];e.mixin=function(t){var i=n.reduce(n.functions(t),(function(t,e){return t[e]=0,t}),{});O(e,t,i,s)},O(e,n,i,s)})),e.sync=function(t,i,s){var r=N[t];n.defaults(s||(s={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var a={type:r,dataType:"json"};if(s.url||(a.url=n.result(i,"url")||J()),null!=s.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){a.type="POST",s.emulateJSON&&(a.data._method=r);var o=s.beforeSend;s.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",r),o)return o.apply(this,arguments)}}"GET"===a.type||s.emulateJSON||(a.processData=!1);var l=s.error;s.error=function(t,e,n){s.textStatus=e,s.errorThrown=n,l&&l.call(s.context,t,e,n)};var c=s.xhr=e.ajax(n.extend(a,s));return i.trigger("request",i,c,s),c};var N={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var R=e.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},L=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,z=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(R.prototype,o,{preinitialize:function(){},initialize:function(){},route:function(t,i,s){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var r=this;return e.history.route(t,(function(n){var a=r._extractParameters(t,n);!1!==r.execute(s,a,i)&&(r.trigger.apply(r,["route:"+i].concat(a)),r.trigger("route",i,a),e.history.trigger("route",r,i,a))})),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(D,"\\$&").replace(L,"(?:$1)?").replace(M,(function(t,e){return e?t:"([^/?]+)"})).replace(z,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,(function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null}))}});var U=e.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,H=/^\/+|\/+$/g,F=/#.*$/;U.started=!1,n.extend(U.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(j,"")},start:function(t){if(U.started)throw new Error("Backbone.history has already been started");if(U.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(H,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,s=i.insertBefore(this.iframe,i.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),U.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),n.some(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0})))},navigate:function(t,e){if(!U.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+t;t=t.replace(F,"");var s=this.decodeFragment(t);if(this.fragment!==s){if(this.fragment=s,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;e.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new U,v.extend=b.extend=R.extend=C.extend=U.extend=function(t,e){var i,s=this;return i=t&&n.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},n.extend(i,s,e),i.prototype=n.create(s.prototype,t),i.prototype.constructor=i,i.__super__=s.prototype,i};var J=function(){throw new Error('A "url" property or function must be specified')},$=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e}(a,n,t,e)}.apply(e,s))||(t.exports=r)}).call(this,n(21))}});