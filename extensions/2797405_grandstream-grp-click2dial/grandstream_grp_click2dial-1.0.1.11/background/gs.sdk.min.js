/*! For license information please see gs.sdk.min.js.LICENSE.txt */
class GsApi{constructor(e){this.apiWebsocket=null,this.ctiWebsocket=null,this.lcdWebsocket=null,this.extWebsocket=null,this.gsCgi=new GsCgi(e),GsUtils.isNUllOrEmpty(e.wsUrl)?this.wsUrl=e.url.replace(/http/i,"ws")+"/websockify":this.wsUrl=e.wsUrl,!1===e.autoKeepAlive?this.autoKeepAlive=!1:this.autoKeepAlive=!0,this.url=e.url,this.cgiUrl=e.url+"/cgi-bin/",this.username=e.username,this.password=e.password,this.requestHeader=e.requestHeader,this.gsCgi&&(this.__proto__.__proto__=this.gsCgi.__proto__)}updateCfg(e){GsUtils.isObject(e)&&(this.apiWebsocket&&this.apiWebsocket.updateCfg(e),this.ctiWebsocket&&this.ctiWebsocket.updateCfg(e),this.lcdWebsocket&&this.lcdWebsocket.updateCfg(e),this.extWebsocket&&this.extWebsocket.updateCfg(e),this.addonWebsocket&&this.addonWebsocket.updateCfg(e),this.url=e.url,this.cgiUrl=e.url+"/cgi-bin/",this.username=e.username,this.password=e.password,this.requestHeader=e.requestHeader,this.gsCgi.updateCfg(e))}createApiWebsocket(e){if(GsUtils.isNUllOrEmpty(this.apiWebsocket)){let t=this,s={url:t.wsUrl,user:t.username,password:t.password,protocols:["gs-ws-api"],callback:e};this.apiWebsocket=new WebSocketInstance(s)}return this.apiWebsocket}closeApiWebsocket(){this.apiWebsocket&&this.apiWebsocket.close()}sendApiWebsocketData(e){this.apiWebsocket&&this.apiWebsocket.send(e)}createCTIWebsocket(e){if(GsUtils.isNUllOrEmpty(this.ctiWebsocket)){let t=this,s={url:t.wsUrl,user:t.username,password:t.password,protocols:["gs-ws-cti"],callback:e};this.ctiWebsocket=new WebSocketInstance(s)}return this.ctiWebsocket}closeCtiWebsocket(){this.ctiWebsocket&&this.ctiWebsocket.close()}sendCtiWebsocketData(e){this.ctiWebsocket&&this.ctiWebsocket.send(e)}createLcdWebsocket(e){if(GsUtils.isNUllOrEmpty(this.lcdWebsocket)){let t=this,s={url:t.wsUrl,user:t.username,password:t.password,protocols:["gs-ws-lcd"],callback:e};this.lcdWebsocket=new WebSocketInstance(s)}return this.lcdWebsocket}closeLcdWebsocket(){this.lcdWebsocket&&this.lcdWebsocket.close()}sendLcdWebsocketData(e){this.lcdWebsocket&&this.lcdWebsocket.send(e)}createExtWebsocket(e){if(GsUtils.isNUllOrEmpty(this.extWebsocket)){let t=this,s={url:t.wsUrl,user:t.username,password:t.password,protocols:["gs-ws-ext"],callback:e};this.extWebsocket=new WebSocketInstance(s)}return this.extWebsocket}closeExtWebsocket(){this.extWebsocket&&this.extWebsocket.close()}sendExtWebsocketData(e){this.extWebsocket&&this.extWebsocket.send(e)}createAddonWebsocket(e){if(GsUtils.isNUllOrEmpty(this.addonWebsocket)){let t=this,s={url:t.wsUrl,user:t.username,password:t.password,protocols:["gs-ws-addon"],callback:e};this.addonWebsocket=new WebSocketInstance(s)}return this.addonWebsocket}closeAddonWebsocket(){this.addonWebsocket&&this.addonWebsocket.close()}sendAddonWebsocketData(e){this.addonWebsocket&&this.addonWebsocket.send(e)}login(e){let t=this,s={onreturn:function(s){if((4===s.readyState||s.ok)&&200==s.status){let i={};s.responseText?i.token=JSON.parse(s.responseText).body:s.bodyInJsonFormat&&(i.token=s.bodyInJsonFormat.body),i.onreturn=function(s){if(4!==s.readyState&&!s.ok||200!=s.status||!0!==t.autoKeepAlive||t.startKeepAlive(),GsUtils.isObject(e)&&GsUtils.isFunction(e.onreturn))try{e.onreturn(s)}catch(e){console.error(e)}},i.onerror=e.onerror,t.dologin(i)}}};s.onerror=e.onerror,t.access(s)}}let apiList={access:"access",avahiStatus:"api-get_avahi_status",bsXsiLogin:"api-bs_xsi_login",bsXsiLogout:"api-bs_xsi_logout",getCallHistories:"callhistories",databaseClear:"api-database_clear",databaseDownload:"api-database_download",databaseGetStatus:"api-database_get_status",databaseRecover:"api-database_recover",delCallHistories:"callhistories",captureScreen:"api-capture_screen",checkProcess:"api-check_process_running",chooseUserfile:"api-choose_user_file",configGet:"config_get",configUpdate:"config_update",delContact:"api-delete_contact_json",delAllContact:"api-delete_all_contact",saveContact:"api-save_contact",del802Ca:"delete_802ca",del802Cl:"delete_802cl",delCa:"delete_CA",delCert:"delete_cert",delCoredumps:"api-delete_core_dumps",delPcaps:"api-delete_pcap_list",delScreens:"api-delete_screens",delSshkey:"delete_sshkey",delVPNCa:"delete_vpnca",delVPNCert:"delete_vpncert",delVPNKey:"delete_vpnkey",getDialplan:"dialplan",putDialplan:"dialplan",delDialPlan:"dialplan",dologin:"dologin",dologout:"dologout",dorefresh:"dorefresh",downloadCfg:"download_cfg",downloadPcap:"api-download_pcap",downloadUserConfig:"download_user_config",downloadUserfile:"api-download_user_file",downloadSslKey:"api-download_sslkey",forceReboot:"api-forceReboot",getAudioPath:"api-get_audiopath",getAudioVolume:"api-get_audiovolume",getBarStatus:"api-get_barstatus",getCallStatus:"api-get_call_status",getConfStatus:"api-get_conf_status",getDatabaseStatus:"api-get_database_status",getDialInNum:"api-get_dial_input_number",getDtmfInNum:"api-get_dtmf_input_number",getDumpList:"api-get_dump_list",getGuiStatus:"api-get_gui_status",getHookStatus:"api-get_hookstatus",getIconStatus:"api-get_iconstatus",getLanguageOrder:"api-get_language_order",getLedStatus:"api-get_ledstatus",getLineStatus:"api-get_line_status",getMessageStatus:"api-get_message_status",getPacketStatus:"api-get_packet_status",getPcapList:"api-get_pcap_list",getPhoneStatus:"api-get_phone_status",getPopupContent:"api-get_popup_content",getRecordList:"api-get_record_list",getRingtoneType:"api-get_ringtone_type",getRtpStatus:"api-get_rtp_status",getScreenData:"api-get_screen_data",getScreenShot:"api-get_screenshot",getSoftKey:"api-get_softkey",getSystemStatus:"api-get_system_status",getSystemTime:"api-get_time",getUserSpaceInfo:"api-get_user_space_info",addGroup:"api-add_group_json",editDelGroup:"api-edit_delete_group_json",hideruleCheck:"api-hide_rule_check",hideruleResult:"api-hide_rule_result",ldapSearch:"api-ldap_search",listAvailKeys:"api-list_avail_keys",listAvailMpks:"api-list_avail_mpks",listBsAccounts:"api-list_bs_accounts",listCustomKeyModes:"api-list_custom_key_modes",getListCustomKeys:"api-list_custom_keys",postListCustomKeys:"api-list_custom_keys",makeCall:"api-make_call",mpkDownload:"api-mpk_download",mpkSave:"api-save_mpk",pcap:"api-pcap",phonebookDownload:"phonebook_download",phonebookDownloadJson:"api-phonebook_download_json",phoneOperation:"api-phone_operation",resetCallScreen:"api-reset_call_screen",resetIdleScreen:"api-reset_idle_screen",backIdle:"api-back_idle",getRingtone:"ringtone",postRingtone:"ringtone",delRingtone:"ringtone",sendInstantMsg:"api-send_instant_message",sendExtKey:"api-send_ext_key",sendKey:"api-send_key",setKey:"api-set_key",setTime:"api-set_time",swapAccount:"api-swap_account",sysOperation:"api-sys_operation",connectWifi:"api-wifi_connect",forgetWifi:"api-wifi_forget",startWifiScan:"api-wifi_scan_start",stopWifiScan:"api-wifi_scan_stop",getWifiStatus:"api-wifi_status_get",willLogin:"api-will_login",getAccounts:"api-get_accounts"},paramList={access:["access"],getCallHistories:["type"],delCallHistories:["id","type","all"],checkProcess:["request"],chooseUserfile:["phonebook","callog","config","wallpaper","user_config"],configGet:["pvalues"],delContact:["contactId"],saveContact:["contactId","firstName","lastName","favorite","company","department","job","jobTitle","workNum","homeNum","cellNum","account","groups","ringtone","primary","image","customLabelCount","stamp"],getDialplan:["acctid"],delDialPlan:["id"],dologin:["username","password"],downloadCfg:["type"],getSoftKey:["isShow"],addGroup:["groupName","ringtone"],editDelGroup:["groupId","groupName","ringtone","account"],hideruleCheck:["rule"],hideruleResult:["rule","number"],listAvailKeys:["type"],listAvailMpks:["type"],listCustomKeyModes:["type"],postListCustomKeys:["list"],makeCall:["phonenumber","account","display"],mpkDownload:["type","page","status"],pcap:["start","method","name","rtp","ssl"],phoneOperation:["cmd","arg"],delRingtone:["id"],sendInstantMsg:["account","number","message"],sendExtKey:["key"],sendKey:["keys"],setKey:["key","press"],setTime:["date","dateStr","dateTime"],swapAccount:["account1","account2"],sysOperation:["request"],forgetWifi:["ssid"],startWifiScan:["auto"],getAccounts:["registered"]};class GsCgi{constructor(e){GsUtils.isObject(e)&&(this.url=e.url,this.cgiUrl=e.url+"/cgi-bin/",this.username=e.username,this.password=e.password,this.requestHeader=e.requestHeader)}updateCfg(e){GsUtils.isObject(e)&&(this.url=e.url,this.cgiUrl=e.url+"/cgi-bin/",this.username=e.username,this.password=e.password,this.requestHeader=e.requestHeader)}sendReq(e){if(GsUtils.isObject(e)&&GsUtils.isString(e.api)){let s="",i=e.param,a=e.header;if("application/json"===e.contentType)GsUtils.isObject(i)&&GsUtils.isObject(i.body)&&(s=JSON.stringify(i.body));else{GsUtils.isObject(i)&&!GsUtils.isNUllOrEmpty(i.update_session)&&(0!==s.length&&(s+="&"),!1===i.update_session&&(s+="update_session=false"));let a=paramList[e.api];if(Array.isArray(a)&&0!==a.length)for(var t in a){let e=a[t];GsUtils.isObject(i)&&!GsUtils.isNUllOrEmpty(i[e])&&(0!==s.length&&(s+="&"),s=s+e+"="+encodeURIComponent(i[e]))}}let o=this.cgiUrl+apiList[e.api];"GET"===e.method&&s&&(o=this.cgiUrl+apiList[e.api]+"?"+s,s="");try{if(XMLHttpRequest){let t=new XMLHttpRequest;t.timeout=5e3,t.ontimeout=function(e){console.log("请求超时"),GsUtils.isObject(i)&&GsUtils.isFunction(i.onerror)&&i.onerror(e)},t.onreadystatechange=function(){GsUtils.isObject(i)&&GsUtils.isFunction(i.onreturn)&&i.onreturn(this)},t.onerror=function(e){GsUtils.isObject(i)&&GsUtils.isFunction(i.onerror)&&i.onerror(e)},t.open(e.method||"POST",o,!0),t.setRequestHeader("Content-type",e.contentType||"application/x-www-form-urlencoded"),t.withCredentials=!0;for(let e in this.requestHeader)t.setRequestHeader(e,this.requestHeader[e]);for(let e in a)t.setRequestHeader(e,a[e]);t.send(s)}}catch(t){let n,r={method:e.method||"POST",credentials:"include",referrer:o,referrerPolicy:"no-referrer",mode:"cors",headers:{accept:"application/json, text/plain, */*","Content-type":e.contentType||"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"}};s&&(r.body=s);for(let e in this.requestHeader)r.headers[e]=this.requestHeader[e];for(let e in a)r.headers[e]=a[e];fetch(o,r).then((function(t){if(t.ok&&200===t.status)return n=t,"phonebookDownload"===e.api?t.text():t.json();GsUtils.isObject(i)&&GsUtils.isFunction(i.onerror)&&i.onerror(t)})).then((function(e){n||(n={}),n.bodyInJsonFormat=e,GsUtils.isObject(i)&&GsUtils.isFunction(i.onreturn)&&i.onreturn(n)})).catch((function(e){GsUtils.isObject(i)&&GsUtils.isFunction(i.onerror)&&i.onerror(e)}))}}}access(e){let t=this,s=sha256.create();s.update(t.username);let i={api:"access",param:{access:s.hex(),onreturn:function(s){4!==s.readyState&&!s.ok||200!==s.status||(s.responseText?t.token=JSON.parse(s.responseText).body:s.bodyInJsonFormat&&(t.token=s.bodyInJsonFormat.body)),GsUtils.isObject(e)&&GsUtils.isFunction(e.onreturn)&&e.onreturn(s)},onerror:e.onerror}};this.sendReq(i)}avahiStatus(e){let t={api:"avahiStatus",param:e};this.sendReq(t)}bsXsiLogin(e){let t={api:"bsXsiLogin",param:e};this.sendReq(t)}bsXsiLogout(e){let t={api:"bsXsiLogout",param:e};this.sendReq(t)}getCallHistories(e){let t={method:"GET",api:"getCallHistories",param:e};this.sendReq(t)}databaseClear(e){let t={api:"databaseClear",param:e};this.sendReq(t)}databaseDownload(e){let t={api:"databaseDownload",param:e};this.sendReq(t)}databaseGetStatus(e){let t={api:"databaseGetStatus",param:e};this.sendReq(t)}databaseRecover(e){let t={api:"databaseRecover",param:e};this.sendReq(t)}delCallHistories(e){let t={method:"DELETE",api:"callhistories",param:e};this.sendReq(t)}captureScreen(e){let t={method:"GET",api:"captureScreen",param:e};this.sendReq(t)}checkProcess(e){let t={api:"checkProcess",param:e};this.sendReq(t)}chooseUserfile(e){let t={api:"chooseUserfile",param:e};this.sendReq(t)}configGet(e){let t={method:"GET",api:"configGet",param:e};this.sendReq(t)}configUpdate(e){let t={method:"PUT",api:"configUpdate",contentType:"application/json",param:e};this.sendReq(t)}delContact(e){let t={api:"delContact",param:e};this.sendReq(t)}delAllContact(e){let t={api:"delAllContact",param:e};this.sendReq(t)}saveContact(e){let t={api:"saveContact",param:e};this.sendReq(t)}del802Ca(e){let t={api:"del802Ca",param:e};this.sendReq(t)}del802Cl(e){let t={api:"del802Cl",param:e};this.sendReq(t)}delCa(e){let t={api:"delCa",contentType:"application/json",param:e};this.sendReq(t)}delCert(e){let t={api:"delCert",param:e};this.sendReq(t)}delCoredumps(e){let t={api:"delCoredumps",param:e};this.sendReq(t)}delPcaps(e){let t={api:"delPcaps",param:e};this.sendReq(t)}delScreens(e){let t={api:"delScreens",param:e};this.sendReq(t)}delSshkey(e){let t={api:"delSshkey",param:e};this.sendReq(t)}delVPNCa(e){let t={api:"delVPNCa",param:e};this.sendReq(t)}delVPNCert(e){let t={api:"delVPNCert",param:e};this.sendReq(t)}delVPNKey(e){let t={api:"delVPNKey",param:e};this.sendReq(t)}getDialplan(e){let t={method:"GET",api:"getDialplan",param:e};this.sendReq(t)}putDialplan(e){let t={method:"PUT",api:"putDialplan",contentType:"application/json",param:e};this.sendReq(t)}delDialPlan(e){let t={method:"DELETE",api:"delDialPlan",param:e};this.sendReq(t)}dologin(e){let t=this,s=sha256.create();s.update(t.password+e.token);let i={api:"dologin",param:{username:t.username,password:s.hex(),onreturn:function(s){if((4===s.readyState||s.ok)&&200===s.status){let e;if(s.responseText?e=JSON.parse(s.responseText):s.bodyInJsonFormat&&(e=s.bodyInJsonFormat),"success"===e.response){console.log("login success."),t.sid=e.body.sid;try{localStorage&&localStorage.setItem("sid",t.sid)}catch(e){chrome.storage.local.set({sid:t.sid})}}}GsUtils.isFunction(e.onreturn)&&e.onreturn(s)},onerror:e.onerror}};this.sendReq(i)}dologout(e){let t={api:"dologout",param:e};this.sendReq(t)}dorefresh(e){let t={api:"dorefresh",param:e};this.sendReq(t)}downloadCfg(e){let t={method:"GET",api:"downloadCfg",param:e};this.sendReq(t)}downloadPcap(e){let t={method:"GET",api:"downloadPcap",param:e};this.sendReq(t)}downloadUserConfig(e){let t={method:"GET",api:"downloadUserConfig",param:e};this.sendReq(t)}downloadUserfile(e){let t={method:"GET",api:"downloadUserfile",param:e};this.sendReq(t)}downloadSslKey(e){let t={method:"GET",api:"downloadSslKey",param:e};this.sendReq(t)}forceReboot(e){let t={api:"forceReboot",param:e};this.sendReq(t)}getAudioPath(e){let t={api:"getAudioPath",param:e};this.sendReq(t)}getAudioVolume(e){let t={api:"getAudioVolume",param:e};this.sendReq(t)}getBarStatus(e){let t={api:"getBarStatus",param:e};this.sendReq(t)}getCallStatus(e){let t={api:"getCallStatus",param:e};this.sendReq(t)}getConfStatus(e){let t={api:"getConfStatus",param:e};this.sendReq(t)}getDatabaseStatus(e){let t={api:"getDatabaseStatus",param:e};this.sendReq(t)}getDialInNum(e){let t={api:"getDialInNum",param:e};this.sendReq(t)}getDtmfInNum(e){let t={api:"getDtmfInNum",param:e};this.sendReq(t)}getDumpList(e){let t={api:"getDumpList",param:e};this.sendReq(t)}getGuiStatus(e){let t={api:"getGuiStatus",param:e};this.sendReq(t)}getHookStatus(e){let t={api:"getHookStatus",param:e};this.sendReq(t)}getIconStatus(e){let t={api:"getIconStatus",param:e};this.sendReq(t)}getLanguageOrder(e){let t={api:"getLanguageOrder",param:e};this.sendReq(t)}getLedStatus(e){let t={api:"getLedStatus",param:e};this.sendReq(t)}getLineStatus(e){let t={api:"getLineStatus",param:e};this.sendReq(t)}getMessageStatus(e){let t={api:"getMessageStatus",param:e};this.sendReq(t)}getPacketStatus(e){let t={api:"getPacketStatus",param:e};this.sendReq(t)}getPcapList(e){let t={api:"getPcapList",param:e};this.sendReq(t)}getPhoneStatus(e){let t={api:"getPhoneStatus",param:e};this.sendReq(t)}getPopupContent(e){let t={api:"getPopupContent",param:e};this.sendReq(t)}getRecordList(e){let t={api:"getRecordList",param:e};this.sendReq(t)}getRingtoneType(e){let t={api:"getRingtoneType",param:e};this.sendReq(t)}getRtpStatus(e){let t={api:"getRtpStatus",param:e};this.sendReq(t)}getScreenData(e){let t={api:"getScreenData",param:e};this.sendReq(t)}getScreenShot(e){let t={api:"getScreenShot",param:e};this.sendReq(t)}getSoftKey(e){let t={api:"getSoftKey",param:e};this.sendReq(t)}getSystemStatus(e){let t={api:"getSystemStatus",param:e};this.sendReq(t)}getSystemTime(e){let t={api:"getSystemTime",param:e};this.sendReq(t)}getUserSpaceInfo(e){let t={api:"getUserSpaceInfo",param:e};this.sendReq(t)}addGroup(e){let t={api:"addGroup",param:e};this.sendReq(t)}editDelGroup(e){let t={api:"editDelGroup",param:e};this.sendReq(t)}hideruleCheck(e){let t={api:"hideruleCheck",param:e};this.sendReq(t)}hideruleResult(e){let t={api:"hideruleResult",param:e};this.sendReq(t)}ldapSearch(e){let t={api:"ldapSearch",contentType:"application/json",param:e};this.sendReq(t)}listAvailKeys(e){let t={api:"listAvailKeys",param:e};this.sendReq(t)}listAvailMpks(e){let t={api:"listAvailMpks",param:e};this.sendReq(t)}listBsAccounts(e){let t={api:"listBsAccounts",param:e};this.sendReq(t)}listCustomKeyModes(e){let t={api:"listCustomKeyModes",param:e};this.sendReq(t)}getListCustomKeys(e){let t={method:"GET",api:"getListCustomKeys",param:e};this.sendReq(t)}postListCustomKeys(e){let t={api:"postListCustomKeys",param:e};this.sendReq(t)}makeCall(e){let t={api:"makeCall",param:e};this.sendReq(t)}mpkDownload(e){let t={api:"mpkDownload",param:e};this.sendReq(t)}mpkSave(e){let t={api:"mpkSave",contentType:"application/json",param:e};this.sendReq(t)}pcap(e){let t={api:"pcap",param:e};this.sendReq(t)}phonebookDownloadJson(e){let t={api:"phonebookDownloadJson",param:e};this.sendReq(t)}phonebookDownload(e){let t={api:"phonebookDownload",param:e};this.sendReq(t)}phoneOperation(e){let t={api:"phoneOperation",param:e};this.sendReq(t)}resetCallScreen(e){let t={api:"resetCallScreen",param:e};this.sendReq(t)}resetIdleScreen(e){let t={api:"resetIdleScreen",param:e};this.sendReq(t)}backIdle(e){let t={api:"backIdle",param:e};this.sendReq(t)}getRingtone(e){let t={method:"GET",api:"getRingtone",param:e};this.sendReq(t)}postRingtone(e){}delRingtone(e){let t={method:"DELETE",api:"delRingtone",param:e};this.sendReq(t)}sendInstantMsg(e){let t={api:"sendInstantMsg",param:e};this.sendReq(t)}sendExtKey(e){let t={api:"sendExtKey",param:e};this.sendReq(t)}sendKey(e){let t={api:"sendKey",param:e};this.sendReq(t)}setKey(e){let t={api:"setKey",param:e};this.sendReq(t)}setTime(e){let t={api:"setTime",param:e};this.sendReq(t)}swapAccount(e){let t={api:"swapAccount",param:e};this.sendReq(t)}sysOperation(e){let t={api:"sysOperation",param:e};this.sendReq(t)}connectWifi(e){let t={api:"connectWifi",contentType:"application/json",param:e};this.sendReq(t)}forgetWifi(e){let t={api:"forgetWifi",param:e};this.sendReq(t)}startWifiScan(e){let t={api:"startWifiScan",param:e};this.sendReq(t)}stopWifiScan(e){let t={api:"stopWifiScan",param:e};this.sendReq(t)}getWifiStatus(e){let t={api:"getWifiStatus",param:e};this.sendReq(t)}willLogin(e){let t={api:"willLogin",param:e};this.sendReq(t)}getAccounts(e){let t={api:"getAccounts",param:e};this.sendReq(t)}startKeepAlive(){this.stopKeepAlive();let e=this;e.keepAliveInterval=setInterval((function(){e.getPhoneStatus()}),6e4)}stopKeepAlive(){this.keepAliveInterval&&(clearInterval(this.keepAliveInterval),this.keepAliveInterval=null)}}class GsUtils{static isNUllOrEmpty(e){return null==e||""===e}static isFunction(e){return"function"==typeof e}static isString(e){return"string"==typeof e&&""!==e}static isObject(e){return"object"==typeof e&&null!==e}}class WebSocketInstance{constructor(e){GsUtils.isObject(e)?(this.config=e,this.ws=this.createWebSocket()):this.ws=null}updateCfg(e){GsUtils.isObject(e)&&(this.config.user=e.username,this.config.password=e.password)}createWebSocket(){let e=this.config;if(GsUtils.isObject(e)){if(GsUtils.isNUllOrEmpty(e.url))throw new Error('ERR_INVALID_PARAMETER_VALUE: "'+url+'" is not valid as webSocket url value');let t=new WebSocket(e.url,e.protocols);window.onunload=window.onbeforeunload=function(){let e=JSON.stringify({closeWs:!0});t.send(e)};let s=e.callback;return t.onopen=function(e){let i=JSON.stringify({challenge:!0});t.send(i),GsUtils.isFunction(s.onopen)&&s.onopen(e)},t.onerror=function(e){GsUtils.isFunction(s.onerror)&&s.onerror(e)},t.onmessage=function(i){if("string"==typeof i.data&&"\r\n\r\n"===i.data)t.keepAliveWithoutResp=0;else if("string"==typeof i.data){let a=JSON.parse(i.data);if(a.challenge){let s=sha256.create();s.update(e.password+a.challenge);let i=JSON.stringify({user:e.user,token:s.hex()});t.send(i),t.keepAliveWithoutResp=0,t.keepAliveInterval||t.keepAlive()}else GsUtils.isFunction(s.onmessage)&&s.onmessage(i)}else GsUtils.isFunction(s.onmessage)&&s.onmessage(i)},t.onclose=function(e){t.keepAliveInterval&&(clearInterval(t.keepAliveInterval),t.keepAliveInterval=null),GsUtils.isFunction(s.onclose)&&s.onclose(e),t=null},t.keepAlive=function(){t.keepAliveInterval=setInterval((function(){if(t.keepAliveWithoutResp>=5)t.close();else{let e="\r\n";t.send(e),this.keepAliveWithoutResp+=1}}),5e3)},t}return null}close(){GsUtils.isNUllOrEmpty(this.ws)?console.error("the websocket is null"):this.ws.close()}send(e){GsUtils.isNUllOrEmpty(this.ws)?console.error("the websocket is null"):this.ws.send(e)}}!function(){"use strict";function t(e,t){t?(d[0]=d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0,this.blocks=d):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function i(e,s,i){var a,o=typeof e;if("string"===o){var n,r=[],l=e.length,p=0;for(a=0;a<l;++a)(n=e.charCodeAt(a))<128?r[p++]=n:n<2048?(r[p++]=192|n>>6,r[p++]=128|63&n):n<55296||n>=57344?(r[p++]=224|n>>12,r[p++]=128|n>>6&63,r[p++]=128|63&n):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++a)),r[p++]=240|n>>18,r[p++]=128|n>>12&63,r[p++]=128|n>>6&63,r[p++]=128|63&n);e=r}else{if("object"!==o)throw new Error(h);if(null===e)throw new Error(h);if(f&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||f&&ArrayBuffer.isView(e)))throw new Error(h)}e.length>64&&(e=new t(s,!0).update(e).array());var d=[],c=[];for(a=0;a<64;++a){var u=e[a]||0;d[a]=92^u,c[a]=54^u}t.call(this,s,i),this.update(c),this.oKeyPad=d,this.inner=!0,this.sharedMemory=i}var h="input is invalid type",r="object"==typeof window,s=r?window:{};s.JS_SHA256_NO_WINDOW&&(r=!1);var e=!r&&"object"==typeof self,n=!s.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;n?s=global:e&&(s=self);var o=!s.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,a="function"==typeof define&&define.amd,f=!s.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,u="0123456789abcdef".split(""),c=[-2147483648,8388608,32768,128],y=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=["hex","array","digest","arrayBuffer"],d=[];!s.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!f||!s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var A=function(e,s){return function(i){return new t(s,!0).update(i)[e]()}},w=function(e){var s=A("hex",e);n&&(s=b(s,e)),s.create=function(){return new t(e)},s.update=function(e){return s.create().update(e)};for(var i=0;i<l.length;++i){var a=l[i];s[a]=A(a,e)}return s},b=function(t,i){var r=eval("require('crypto')"),s=eval("require('buffer').Buffer"),e=i?"sha224":"sha256",n=function(i){if("string"==typeof i)return r.createHash(e).update(i,"utf8").digest("hex");if(null==i)throw new Error(h);return i.constructor===ArrayBuffer&&(i=new Uint8Array(i)),Array.isArray(i)||ArrayBuffer.isView(i)||i.constructor===s?r.createHash(e).update(new s(i)).digest("hex"):t(i)};return n},v=function(e,t){return function(s,a){return new i(s,t,!0).update(a)[e]()}},_=function(e){var t=v("hex",e);t.create=function(t){return new i(t,e)},t.update=function(e,s){return t.create(e).update(s)};for(var s=0;s<l.length;++s){var a=l[s];t[a]=v(a,e)}return t};t.prototype.update=function(e){if(!this.finalized){var t,s=typeof e;if("string"!==s){if("object"!==s)throw new Error(h);if(null===e)throw new Error(h);if(f&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||f&&ArrayBuffer.isView(e)))throw new Error(h);t=!0}for(var i,a,o=0,n=e.length,r=this.blocks;o<n;){if(this.hashed&&(this.hashed=!1,r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),t)for(a=this.start;o<n&&a<64;++o)r[a>>2]|=e[o]<<y[3&a++];else for(a=this.start;o<n&&a<64;++o)(i=e.charCodeAt(o))<128?r[a>>2]|=i<<y[3&a++]:i<2048?(r[a>>2]|=(192|i>>6)<<y[3&a++],r[a>>2]|=(128|63&i)<<y[3&a++]):i<55296||i>=57344?(r[a>>2]|=(224|i>>12)<<y[3&a++],r[a>>2]|=(128|i>>6&63)<<y[3&a++],r[a>>2]|=(128|63&i)<<y[3&a++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++o)),r[a>>2]|=(240|i>>18)<<y[3&a++],r[a>>2]|=(128|i>>12&63)<<y[3&a++],r[a>>2]|=(128|i>>6&63)<<y[3&a++],r[a>>2]|=(128|63&i)<<y[3&a++]);this.lastByteIndex=a,this.bytes+=a-this.start,a>=64?(this.block=r[16],this.start=a-64,this.hash(),this.hashed=!0):this.start=a}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=c[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var e,t,s,i,a,o,n,r,l,d=this.h0,h=this.h1,c=this.h2,u=this.h3,g=this.h4,m=this.h5,f=this.h6,y=this.h7,b=this.blocks;for(e=16;e<64;++e)t=((a=b[e-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,s=((a=b[e-2])>>>17|a<<15)^(a>>>19|a<<13)^a>>>10,b[e]=b[e-16]+t+b[e-7]+s<<0;for(l=h&c,e=0;e<64;e+=4)this.first?(this.is224?(o=300032,y=(a=b[0]-1413257819)-150054599<<0,u=a+24177077<<0):(o=704751109,y=(a=b[0]-210244248)-1521486534<<0,u=a+143694565<<0),this.first=!1):(t=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),i=(o=d&h)^d&c^l,y=u+(a=y+(s=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&m^~g&f)+p[e]+b[e])<<0,u=a+(t+i)<<0),t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),i=(n=u&d)^u&h^o,f=c+(a=f+(s=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&g^~y&m)+p[e+1]+b[e+1])<<0,t=((c=a+(t+i)<<0)>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),i=(r=c&u)^c&d^n,m=h+(a=m+(s=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&y^~f&g)+p[e+2]+b[e+2])<<0,t=((h=a+(t+i)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),i=(l=h&c)^h&u^r,g=d+(a=g+(s=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&f^~m&y)+p[e+3]+b[e+3])<<0,d=a+(t+i)<<0;this.h0=this.h0+d<<0,this.h1=this.h1+h<<0,this.h2=this.h2+c<<0,this.h3=this.h3+u<<0,this.h4=this.h4+g<<0,this.h5=this.h5+m<<0,this.h6=this.h6+f<<0,this.h7=this.h7+y<<0},t.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,s=this.h2,i=this.h3,a=this.h4,o=this.h5,n=this.h6,r=this.h7,l=u[e>>28&15]+u[e>>24&15]+u[e>>20&15]+u[e>>16&15]+u[e>>12&15]+u[e>>8&15]+u[e>>4&15]+u[15&e]+u[t>>28&15]+u[t>>24&15]+u[t>>20&15]+u[t>>16&15]+u[t>>12&15]+u[t>>8&15]+u[t>>4&15]+u[15&t]+u[s>>28&15]+u[s>>24&15]+u[s>>20&15]+u[s>>16&15]+u[s>>12&15]+u[s>>8&15]+u[s>>4&15]+u[15&s]+u[i>>28&15]+u[i>>24&15]+u[i>>20&15]+u[i>>16&15]+u[i>>12&15]+u[i>>8&15]+u[i>>4&15]+u[15&i]+u[a>>28&15]+u[a>>24&15]+u[a>>20&15]+u[a>>16&15]+u[a>>12&15]+u[a>>8&15]+u[a>>4&15]+u[15&a]+u[o>>28&15]+u[o>>24&15]+u[o>>20&15]+u[o>>16&15]+u[o>>12&15]+u[o>>8&15]+u[o>>4&15]+u[15&o]+u[n>>28&15]+u[n>>24&15]+u[n>>20&15]+u[n>>16&15]+u[n>>12&15]+u[n>>8&15]+u[n>>4&15]+u[15&n];return this.is224||(l+=u[r>>28&15]+u[r>>24&15]+u[r>>20&15]+u[r>>16&15]+u[r>>12&15]+u[r>>8&15]+u[r>>4&15]+u[15&r]),l},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,s=this.h2,i=this.h3,a=this.h4,o=this.h5,n=this.h6,r=this.h7,l=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,s>>24&255,s>>16&255,s>>8&255,255&s,i>>24&255,i>>16&255,i>>8&255,255&i,a>>24&255,a>>16&255,a>>8&255,255&a,o>>24&255,o>>16&255,o>>8&255,255&o,n>>24&255,n>>16&255,n>>8&255,255&n];return this.is224||l.push(r>>24&255,r>>16&255,r>>8&255,255&r),l},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},i.prototype=new t,i.prototype.finalize=function(){if(t.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();t.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),t.prototype.finalize.call(this)}};var B=w();B.sha256=B,B.sha224=w(!0),B.sha256.hmac=_(),B.sha224.hmac=_(!0),o?module.exports=B:(s.sha256=B.sha256,s.sha224=B.sha224,a&&define((function(){return B})))}();export{GsApi,GsCgi,GsUtils};