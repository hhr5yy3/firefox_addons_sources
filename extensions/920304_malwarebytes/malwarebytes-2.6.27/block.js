(()=>{var e={8132:e=>{let r,s=chrome||window.chrome||browser||window.browser;navigator.userAgent.includes("Firefox/")&&(s=browser||window.browser,console.debug("CHROME_POLY: ",s)),navigator.userAgent.includes("Edge/")&&(s=browser||window.browser);try{r=indexedDB||window.indexedDB}catch(e){r=null,console.log(`Error initializing indexedDB: ${e.message}`)}e.exports={chrome:s,indexedDB:r,performance:performance||window.performance,URL:URL||window.URL}}},r={};function s(a){var t=r[a];if(void 0!==t)return t.exports;var o=r[a]={exports:{}};return e[a](o,o.exports,s),o.exports}s.p="/",chrome||browser||(window.chrome=chrome||window.chrome||window.browser),s.p=(chrome||window.chrome).runtime.getURL(""),(()=>{"use strict";const e=(Object.freeze({LicenseStateUnknown:0,LicenseStateFree:1,LicenseStateTrial:2,LicenseStateTrialExpired:3,LicenseStateLicensed:4,LicenseStateLicenseExpired:5,LicenseStateLicenseGrace:6}),Object.freeze([2,4,6]),"enableNativeMessaging");var r=s(8132);r.chrome.i18n.getUILanguage().split("-")[0];const a=(e,s=document)=>e.forEach((({id:e,msg:a,sub:t=null})=>{const o=s.getElementById(e);o&&(o.textContent=r.chrome.i18n.getMessage(a,t))}));Object.defineProperty({},"browser",{writable:!0});Object.defineProperty({},"os",{writable:!0});Object.defineProperty({},"isMV3",{writable:!0}),console.debug("BLOCK PAGE");let t={};const o=e=>{const r=(e=>{if(!e)return console.debug("UE: Params Error: No URL passed"),null;e.includes("//")&&(e=e.substring(e.indexOf("//")+2));const r=e.lastIndexOf("/");if(-1!==r&&-1!==e.indexOf(".",r+1)){let s=r+1,a="";for(;s<e.length&&"?"!==e[s];)a+=e[s],s++;let t=a.split(".");if(t=t.filter((e=>""!==e)),t.length>1)return t[t.length-1].toLowerCase()}return null})(e),s=r&&t.params.referrer?`http://${t.params.referrer.split(/^https?:\/\//)[1]}`:`http://${t.params.url.split(/^https?:\/\//)[1]}`;console.debug("Add exclusions was successful. Will redirect to: ",s),window.location.href=s};function n(){const e=document.getElementById("continue-always").checked;console.debug("BLOCK_MV2: Continue ",{continueAlways:e,url:t.params.url});let r=t.getExclusionConst(t.params.type);e?t.updateAllowListViaMessage(t.params,r):t.excludeTemporary(r)}function i(){if(t.params.prevUrl&&t.params.prevUrl.length>0)return window.location.replace(t.params.prevUrl);if(window.history.length>1)return window.history.go(-1);let e;try{e=new URL(t.params.referrer)}catch(e){}r.chrome.tabs.query({currentWindow:!0,active:!0},(s=>{e?r.chrome.tabs.query({currentWindow:!0,url:`${e.origin}/*`},(e=>{e[0].index&&r.chrome.tabs.highlight({tabs:e[0].index},(()=>{s[0].id&&r.chrome.tabs.remove(s[0].id)}))})):s[0].id&&r.chrome.tabs.remove(s[0].id)}))}t.typesAsPlural=e=>{switch(e){case"malware":case"ads":default:return e;case"scam":case"ad":return`${e}s`}},t.templateParameters=()=>function(e){let r={},s=new URLSearchParams(e).entries();for(let e of s){const s="$"+e[0];"null"===e[1]?r[s]=null:"undefined"===e[1]?r[s]=void 0:r[s]=e[1]}return new Proxy(r,{get:(e,r)=>r.startsWith("$")?e[r]:e[`$${r}`]})}(window.location.search),t.params=t.templateParameters(),console.debug("BLOCK PAGE PARAMS: ",t.params),t.getExclusionConst=e=>{switch(e){case"malware":return"EXCLUSION_MALWARE";case"scam":return"EXCLUSION_SCAMS";case"ad":case"ads":return"EXCLUSION_ADS";default:console.error("The block page exclusion checkbox has not handled '"+t.params.type+"'")}},t.updateAllowListViaMessage=(e,s)=>{if(s){let a=["full-url-malware","malware-pattern"].includes(e.subtype)||"specific"===e.rules?e.url:e.host;$("#continue-always").is(":checked")?(console.debug("Checkbox switched on - requesting allow for "+s),r.chrome.runtime.sendMessage({type:"MSG_ADD_ALLOW",payload:{host:a,allow:s}},(function(r){!r||r.error?console.error(r?r.error:"NO RESPONSE!"):o(e.url)}))):(console.debug("Checkbox switched off - requesting block for "+s),r.chrome.runtime.sendMessage({type:"MSG_REM_ALLOW_SINGLE",payload:{host:a,exclusion:s}},(function(e){!e||e.error?console.error(e?e.error:"NO RESPONSE!"):console.debug("Remove exclusions was successful")})))}},t.excludeTemporary=e=>{if(!$("#mb-do-not-block").checked)return new Promise((e=>{null!==t.params.tabId?e(t.params.tabId):r.chrome.tabs.query({currentWindow:!0,active:!0},(function(r){e(r[0].id)}))})).then((s=>{r.chrome.runtime.sendMessage({type:"MSG_ADD_ALLOW_TEMPORARY",host:t.params.url||t.params.host,initiator:s,exclusion:e},(function(e){return!e||e.error?Promise.reject(e?e.error:null):Promise.resolve(e.success)}))})).then((()=>{o(t.params.url)})).catch((e=>{console.error(e)})),!1},t.getExplanationText=()=>{switch(t.params.subtype){case"adware":return r.chrome.i18n.getMessage("blockExplainAdware");case"compromised":return r.chrome.i18n.getMessage("blockExplainCompromised");case"exploit":return r.chrome.i18n.getMessage("blockExplainExploit");case"fraud":return r.chrome.i18n.getMessage("blockExplainFradulent");case"hijack":return r.chrome.i18n.getMessage("blockExplainHijack");case"malvertising":return r.chrome.i18n.getMessage("blockExplainMalvertising");case"malware":return r.chrome.i18n.getMessage("blockExplainMalware");case"pharma":return r.chrome.i18n.getMessage("blockExplainPharma");case"phishing":return r.chrome.i18n.getMessage("blockExplainPhishing");case"ransomware":return r.chrome.i18n.getMessage("blockExplainRansomware");case"reputation":return r.chrome.i18n.getMessage("blockExplainReputation");case"riskware":return r.chrome.i18n.getMessage("blockExplainRiskware");case"scam":return r.chrome.i18n.getMessage("blockExplainScam");case"spam":return r.chrome.i18n.getMessage("blockExplainSpam");case"spyware":return r.chrome.i18n.getMessage("blockExplainSpyware");case"trojan":return r.chrome.i18n.getMessage("blockExplainTrojan");case"worm":return r.chrome.i18n.getMessage("blockExplainWorm");default:return r.chrome.i18n.getMessage("blockExplainDefault")}},t.getExplanationLink=()=>{switch(t.params.subtype){case"adware":return"https://www.malwarebytes.com/adware/?guard=1&x-source=threatlearn";case"compromised":return"https://blog.malwarebytes.com/glossary/compromised/?guard=1&x-source=threatlearn";case"exploit":return"https://blog.malwarebytes.com/glossary/exploit/?guard=1&x-source=threatlearn";case"fraud":return"https://blog.malwarebytes.com/glossary/fraud/?guard=1&x-source=threatlearn";case"hijack":return"https://blog.malwarebytes.com/glossary/hijack/?guard=1&x-source=threatlearn";case"malvertising":return"https://blog.malwarebytes.com/glossary/malvertising/?guard=1&x-source=threatlearn";case"pharma":return"https://blog.malwarebytes.com/glossary/pharma/?guard=1&x-source=threatlearn";case"phishing":return"https://blog.malwarebytes.com/glossary/phishing/?guard=1&x-source=threatlearn";case"ransomware":return"https://www.malwarebytes.com/ransomware/?guard=1&x-source=threatlearn";case"reputation":case"malware":default:return"https://blog.malwarebytes.com/glossary/malware/?guard=1&x-source=threatlearn";case"riskware":return"https://blog.malwarebytes.com/glossary/riskware/?guard=1&x-source=threatlearn";case"scam":return"https://blog.malwarebytes.com/glossary/scam/?guard=1&x-source=threatlearn";case"spam":return"https://blog.malwarebytes.com/glossary/spam/?guard=1&x-source=threatlearn";case"spyware":return"https://www.malwarebytes.com/spyware/?guard=1&x-source=threatlearn";case"suspiciousPage":case"suspiciousDownload":case"suspiciousContent":case"suspicious":return"https://blog.malwarebytes.com/glossary/suspicious-activity/?guard=1&x-source=threatlearn";case"suspiciousTLD":return"https://blog.malwarebytes.com/glossary/TLD/?guard=1&x-source=threatlearn";case"trojan":return"https://blog.malwarebytes.com/glossary/trojan/?guard=1&x-source=threatlearn";case"worm":return"https://blog.malwarebytes.com/glossary/worm/?guard=1&x-source=threatlearn"}},t.humanReadableSubType=()=>t.params.subtype?"full-url-malware"===t.params.subtype?"malware":"suspiciousPage"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeSuspiciousPage"):"suspiciousTLD"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeSuspiciousTLD"):"suspiciousDownload"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeSuspiciousDownload"):"suspiciousContent"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeSuspiciousContent"):"malware-pattern"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeMalwarePattern"):"alertLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeAlertLoop"):"authRequiredLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeAuthRequiredLoop"):"createURLLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeCreateURLLoop"):"extensionInstall"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeExtensionInstall"):"fullScreenLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeFullScreenLoop"):"historyLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeHistoryLoop"):"notificationLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypeNotificationLoop"):"printLoop"===t.params.subtype?r.chrome.i18n.getMessage("humanReadableSubTypePrintLoop"):t.params.subtype:t.params.type;document.addEventListener("DOMContentLoaded",(function(){new Promise(((e,s)=>{r.chrome.runtime.sendMessage({type:"MSG_IS_PREMIUM"},(function(r){!r||r.error?(console.error("Failed to check if premium: "+r.error),s(r.error)):(console.debug("Is premium: "+r.success),e(r.success))}))})).then((e=>{e||(document.getElementById("upgrade-protection").style.display="inherit")})),window.addEventListener("resize",(()=>{$("#mbbgb-inf").popup({inline:!0,hoverable:!0,lastResort:"bottom center"})})),function(){$("#mbbgb-inf").popup({inline:!0,hoverable:!0,lastResort:"bottom center"}),a([{id:"blocked-by-title",msg:"blockedByTitle"},{id:"block-explanation",msg:"mv3WebsiteBlockExplanation"},{id:"block-alert-text",msg:"mv3WebsiteBlockAlert"},{id:"block-alert-link",msg:"mv3WebsiteBlockMalwarebytesSupport"},{id:"block-go-back",msg:"mv3WebsiteBlockGoBack"},{id:"continue-button",msg:"mv3WebsiteBlockContinue"},{id:"block-continue-always",msg:"mv3WebsiteBlockContinueAlways"},{id:"block-level-up",msg:"mv3WebsiteBlockLevelUp"},{id:"block-level-up-info",msg:"mv3WebsiteBlockLevelUpInfo"},{id:"block-level-up-info-link",msg:"mv3WebsiteBlockLevelUpInfoLink"},{id:"block-level-up-info-contd",msg:"mv3WebsiteBlockLevelUpInfoContd"},{id:"block-get-started",msg:"mv3WebsiteBlockGetStarted"},{id:"block-learn-more",msg:"mv3WebsiteBlockLearnMore"},{id:"block-learn-more-link",msg:"mv3WebsiteBlockLearnMoreLink"}]);const e=t.params.subtype&&""!==t.params.subtype?t.humanReadableSubType():t.typesAsPlural(t.params.type);$("#block-reason").text(r.chrome.i18n.getMessage("websiteBlockHeader")+" "+e)}(),async function(){const e=document.getElementById("app-db-version"),s=r.chrome.runtime.getManifest().version,a=await(o="lastDBused",new Promise(((e,s)=>{r.chrome.storage.local.get(o,(a=>r.chrome.runtime.lastError?s(r.chrome.runtime.lastError):e(a[o])))})));var o;const n=`Heuristics: ${t.humanReadableSubType()}`;e.textContent=`v${s} | ${null==a?n:a}`}(),function(){const e=document.querySelector("#block-url"),r=((e,r=2048)=>e.length>r?e.substr(0,r-1)+"...":e)(t.params.host);e.textContent=r}(),document.getElementById("go-back").addEventListener("click",i),document.getElementById("continue-button").addEventListener("click",n),r.chrome.runtime.sendMessage({type:"MSG_IS_NEEDING_NATIVE_MSG",parameters:{source:"blockPage"}},(s=>{r.chrome.runtime.lastError&&console.error("MBN: Chrome Runtime Failure: ",r.chrome.runtime.lastError),s&&s.needsIt&&($("#mbbgb-header-footer").animate({"max-height":"100%",opacity:1},800),a([{id:"nm-header",msg:"nativeMessagingHeader2"},{id:"nm-message",msg:"nativeMessagingMessage2"},{id:"decline-nm",msg:"buttonOptOut"},{id:"accept-nm",msg:"buttonOptIn"}]),[{id:"accept-nm",val:!0},{id:"decline-nm",val:!1}].forEach((({id:s,val:a})=>{document.getElementById(s).addEventListener("click",(async()=>{let s=a?await new Promise((e=>{r.chrome.permissions.request({permissions:["nativeMessaging"]},(r=>{console.log("MMPPNM: Permissions request resp: ",r),e(r)}))})):await new Promise((e=>{r.chrome.permissions.remove({permissions:["nativeMessaging"]},(r=>{r?(console.debug("MRNM: Successfully removed permissions"),e(!1)):(console.log("MRNM: Did not remove permissions... ",r),e(!0))}))}));r.chrome.runtime.sendMessage({type:"MSG_SETTINGS_SET",payload:{[e]:s}},(e=>{!e||e.error?console.error(e&&e.error):console.debug(`PR: Turned ${s?"on":"off"} Native Messaging`),document.getElementById("mbbgb-header-footer").style.display="none"}))}))})))}))}))})()})();