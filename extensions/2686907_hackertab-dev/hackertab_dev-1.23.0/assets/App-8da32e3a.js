import{u as h,j as e,B as p,A as S,I as E,S as N,a as y,t as D,i as A,b as R,m as j,c as k,l as w,_ as B,s as _,d as I,e as P,f as O}from"./index.js";import{i as V,r as n,R as T}from"./core-ed2e5051.js";import{S as L,a as W,b as F}from"./DNDLayout-ad7f971c.js";import"./utils-db1e3024.js";import{C as b,F as M,a as z}from"./CustomRssCard-6155a97b.js";import"./ui-e578ee10.js";const q=({selectedCard:t,setSelectedCard:r})=>{const{cards:s,userCustomCards:l}=h(),i=[...L,...l],c=V();return e.jsxs("div",{className:"bottomNavigation",children:[s.map(u=>{const o=i.find(a=>a.value===u.name);return e.jsx("button",{className:"navigationItem "+(t&&t.name===u.name?"active":""),onClick:()=>r(u),children:u.type==="supported"?o==null?void 0:o.icon:e.jsx("img",{src:o==null?void 0:o.icon,alt:""})||e.jsx(p,{className:"rss"})},u.name)}),e.jsx("button",{"aria-label":"Open settings",className:"navigationItem ",onClick:()=>{c("/settings/general")},children:e.jsx(S,{})})]})},H=()=>{const{searchEngine:t,searchEngines:r}=h(),s=r.find(l=>l.label.toLocaleLowerCase()===t.toLocaleLowerCase())||r[0];return e.jsxs("div",{className:"searchBarWithLogo",children:[s.default===!1?e.jsx("div",{className:"searchEngineLogo",children:e.jsx(E,{})}):e.jsx("img",{className:"searchEngineLogo "+s.className,src:`/searchengine_logos/${s.label.toLowerCase()}_logo.svg`}),e.jsx(N,{})]})},K=({cards:t,userCustomCards:r})=>{const s=[...L,...r],{updateCardOrder:l}=h(),i=n.useRef(null),{adsConfig:c}=y(),u=(o,a)=>{var d;l(o,a),D(),(a===0||o>3&&a<3)&&((d=i.current)==null||d.scrollTo(0,0))};return n.useLayoutEffect(()=>{i.current=document.querySelector(".Cards")},[]),e.jsx(W,{as:"div",onSortEnd:u,lockAxis:"x",customHolderRef:i,className:"Cards HorizontalScroll",draggedItemClassName:"draggedBlock",children:t.sort((o,a)=>o.id-a.id).map((o,a)=>{const d=s.find(f=>f.value===o.name);if(!d)return null;const m=(d==null?void 0:d.component)||b;return e.jsx(F,{children:e.jsx("div",{children:e.jsx(m,{meta:d,withAds:a===c.columnPosition},o.name)})},o.name)})})},U=({selectedCard:t})=>{const{userCustomCards:r}=h(),s=[...L,...r].find(l=>l.value===t.name);return s?T.createElement((s==null?void 0:s.component)||b,{key:s.value,meta:s,withAds:!0}):null},$=()=>{const{cards:t,userCustomCards:r}=h(),[s,l]=n.useState(t[0]);return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"AppContent",children:[e.jsx(J,{}),A?e.jsx(K,{cards:t,userCustomCards:r}):e.jsx("div",{className:"Cards HorizontalScroll",children:e.jsx(U,{selectedCard:s})})]}),e.jsx(q,{selectedCard:s,setSelectedCard:l})]})},G=()=>{const t=n.useRef(null);n.useLayoutEffect(()=>{t.current=document.querySelector(".AppContent")},[]);const r=()=>{var s;t.current&&((s=t.current)==null||s.scrollIntoView({behavior:"smooth"}))};return e.jsxs("section",{className:"DNDContent",children:[e.jsx("div",{className:"searchWidget",children:e.jsx(H,{})}),e.jsxs("button",{className:"scrollToCardsLayout",onClick:()=>r(),children:["Scroll for Dev News",e.jsx(R,{className:"icon"})]})]})},J=()=>{const{cards:t}=h(),[r,s]=n.useState(!1),[l,i]=n.useState(!1),c=n.useRef(null),u="Cards",o=m=>{const f=m.target;if(f.classList.contains(u))if(t.length<=j)s(!1),i(!1);else{const{scrollLeft:g,scrollWidth:x,offsetWidth:C}=f;s(g>100);const v=x-C-Math.abs(g);i(v>100)}},a=n.useCallback(m=>{m.key==="ArrowLeft"?d("left"):m.key==="ArrowRight"&&d("right")},[]);n.useLayoutEffect(()=>{c.current=document.querySelector(`.${u}`)},[]),n.useEffect(()=>{var m;return(m=c.current)==null||m.addEventListener("scroll",o,!0),window.addEventListener("keydown",a),()=>{var f;window.removeEventListener("keydown",a),(f=c.current)==null||f.removeEventListener("scroll",o)}},[a]),n.useEffect(()=>{i(t.length>j)},[t]);const d=m=>{var C,v;if(!c.current)return;k(m);const{scrollLeft:f}=c.current,{offsetWidth:g}=(v=(C=c.current)==null?void 0:C.firstChild)==null?void 0:v.firstChild,x=m==="left"?f-g:f+g;c.current.scrollTo({left:x,behavior:"smooth"})};return e.jsxs("div",{className:"scrollCardsNavigator",children:[r&&e.jsx("button",{"aria-label":"Previous cards",className:"scrollButton",onClick:()=>d("left"),style:{left:0},children:e.jsx(M,{size:32})}),l&&e.jsx("button",{"aria-label":"Next cards",className:"scrollButton",onClick:()=>d("right"),style:{right:0},children:e.jsx(z,{size:32})})]})},{OnboardingModal:Q}=w(()=>B(()=>import("./index-0b6b0c3e.js"),["assets/index-0b6b0c3e.js","assets/index.js","assets/core-ed2e5051.js","assets/ui-e578ee10.js","assets/utils-db1e3024.js","assets/index-a6b644c8.css","assets/DNDLayout-ad7f971c.js","assets/DNDLayout-cd482d4b.css","assets/index-2c235288.js","assets/index-ab4bf764.css"]),"OnboardingModal"),X=t=>{t.forEach(r=>{r.isIntersecting?document.documentElement.classList.add("dndState"):document.documentElement.classList.remove("dndState")})},re=()=>{const[t,r]=n.useState(!0),{onboardingCompleted:s,maxVisibleCards:l,isDNDModeActive:i,DNDDuration:c,setDNDDuration:u}=h();return n.useLayoutEffect(()=>{document.documentElement.style.setProperty("--max-visible-cards",l.toString())},[l]),n.useEffect(()=>{document.body.classList.remove("preload"),_(),I()},[]),n.useEffect(()=>{P("home",i()),!i()&&c!=="never"&&u("never")},[c,i,u]),n.useLayoutEffect(()=>{let o=document.querySelector(".DNDContent"),a=new IntersectionObserver(X,{threshold:.1});return o?a.observe(o):document.documentElement.classList.remove("dndState"),()=>{a.disconnect()}},[c]),e.jsxs(e.Fragment,{children:[!s&&O()==="extension"&&e.jsx(Q,{showOnboarding:t,setShowOnboarding:r}),e.jsxs("div",{className:"layoutLayers hideScrollBar",children:[i()&&e.jsx(G,{}),e.jsx($,{})]})]})};export{re as App};
