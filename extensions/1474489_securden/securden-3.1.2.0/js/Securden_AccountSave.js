window.browser=window.msBrowser||window.browser||window.chrome;var Securden_AccountSave={username:null,password:null,is_folder_needed_for_add_account:!1,folders:null,folderId:null,workText:null,defaultParam:null,dynamicParam:null,init:function(){window.addEventListener("load",(function(){SecurdenExtensionUtils.sendMessage(null,"getNewAccountDetails",{},(function(e){Securden_AccountSave.showAccountDetails(e),workText=Securden_AccountSave.workText,SecurdenExtensionUtils.initializeAccountSaveTexts(workText)})),$("#closeAddAccountButton").click((function(e){SecurdenExtensionUtils.sendMessage(null,"removeIFrame",{})})),$("#closeDivIcon").click((function(e){SecurdenExtensionUtils.sendMessage(null,"removeIFrame",{})})),$("#neverSaveUpdateAccountFormButton").click((function(e){SecurdenExtensionUtils.sendMessage(null,"neverSaveAccountDetails",{},(function(){}))})),$("#save_account_id").click((function(e){Securden_AccountSave.saveAccountDetails()})),$("input[type=radio]").on("click change",(function(e){SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.showHide([],["account_error_msg"]);var t=e.target;Securden_AccountSave.changeAccountType(t,t.getAttribute("id"))})),$("#account_type_work_parent").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.showHide([],["account_error_msg"]);var t=e.target;"account_type_work"!=t.getAttribute("id")?($("#account_type_personal").prop("checked",!1),$("#account_type_work").prop("checked",!0),Securden_AccountSave.changeAccountType(t,"account_type_work_parent")):Securden_AccountSave.changeAccountType(t,"account_type_work")})),$("#account_type_personal_parent").click((function(e){SecurdenExtensionUtils.stopEventPropagation(e),SecurdenExtensionUtils.showHide([],["account_error_msg"]);var t=e.target;"account_type_personal"!=t.getAttribute("id")?($("#account_type_work").prop("checked",!1),$("#account_type_personal").prop("checked",!0),Securden_AccountSave.changeAccountType(t,"account_type_personal_parent")):Securden_AccountSave.changeAccountType(t,"account_type_personal")}))}))},showAccountDetails:function(e){$("#account_title").val(e.data.account_title),$("#account_title").click(),Securden_AccountSave.workText=e.data.work_text,e.data.is_folder_needed_for_add_account&&e.data.folders&&(Securden_AccountSave.is_folder_needed_for_add_account=e.data.is_folder_needed_for_add_account,Securden_AccountSave.folders=e.data.folders,Securden_AccountSave.createJSTreeFoldersDiv()),e.data.only_personal_enabled?($("#account_type_personal").prop("checked",!0),$("#account_type_radio_button_div").addClass("hide"),$("#classification_text").addClass("hide"),$("#account_type_help_text").removeClass("hide").addClass("show"),$("#account_type_help_text").removeClass("account_type_help_text_with_radio").addClass("account_type_help_text_without_radio"),$("#account_type_help_text").text(browser.i18n.getMessage("save_only_as_personal"))):e.data.is_personal_enabled||($("#account_type_work").prop("checked",!0),$("#account_type_radio_button_div").addClass("hide"),$("#classification_text").addClass("hide"),$("#account_type_help_text").removeClass("hide").addClass("show"),$("#account_type_help_text").removeClass("account_type_help_text_with_radio").addClass("account_type_help_text_without_radio"),$("#account_type_help_text").text(browser.i18n.getMessage("save_only_as_work")),Securden_AccountSave.is_folder_needed_for_add_account?(SecurdenExtensionUtils.showHide(["folders_input_field_in_web_page_save"],[]),$("#securden_folders_wrappers_div").click((function(){Securden_AccountSave.createFolderDiv()}))):SecurdenExtensionUtils.showHide([],["folders_input_field_in_web_page_save"])),e.data.never_save_allowed?SecurdenExtensionUtils.showHide(["neverSaveUpdateAccountFormButton"],[]):SecurdenExtensionUtils.showHide([],["neverSaveUpdateAccountFormButton"])},closeIFrame:function(e){null!=e&&null!=e||(e=!0),SecurdenExtensionUtils.sendMessage(null,"removeIFrame",{clearValues:e})},saveAccountDetails:function(){var e=!1;if(!document.getElementById("account_type_personal").checked&&!document.getElementById("account_type_work").checked)return SecurdenExtensionUtils.showStatusMsg("account_error_msg",browser.i18n.getMessage("select_a_classification")),!1;document.getElementById("account_type_personal").checked&&(e=!0);var t={account_title:$("#account_title").val(),is_personal_account:e},n=Securden_AccountSave.folderId;if("firefox"==SecurdenExtensionUtils.getBrowserName()&&(n=$("#securden-folders-select2-div").find(":selected").data("id")),Securden_AccountSave.is_folder_needed_for_add_account){if(!e&&(null==n||null==n||0==n||"0"==n))return $("#securden_folders_selection_error_id").text(browser.i18n.getMessage("select_folder_add_account")),SecurdenExtensionUtils.showHide(["securden_folders_selection_error_id"],[]),!1;e||(t.folder_id=n)}SecurdenExtensionUtils.sendMessage(null,"saveNewAccountDetails",t,(function(){}))},textchange:function(e,t){var n=Securden_AccountSave.workText;return null!=n?e.replace(/%isan/g,n):t},changeAccountType:function(e,t){if($("#account_type_help_text").removeClass("hide").addClass("show"),"account_type_work_parent"!=t&&"account_type_work"!=t||!SecurdenExtensionUtils.checkIfIDPresentInsideElement(e,t))"account_type_personal_parent"!=t&&"account_type_personal"!=t||!SecurdenExtensionUtils.checkIfIDPresentInsideElement(e,t)?$("#account_type_help_text").text(""):($("#account_type_help_text").text(browser.i18n.getMessage("personal_account_help_text")),$("#account_type_work_parent").removeClass("whiteBgColor").addClass("greyBgColor"),$("#account_type_personal_parent").removeClass("greyBgColor").addClass("whiteBgColor"),$("body").removeClass("body-with-folder-selection"),SecurdenExtensionUtils.showHide([],["folders_input_field_in_web_page_save"]));else{defaultParam=browser.i18n.getMessage("work_account_help_text"),dynamicParam="'%isan' accounts belong to your organization and hence can be shared with your colleagues on a need basis. Super administrator of your organization can see all %isan accounts and passwords.";var n=Securden_AccountSave.textchange(dynamicParam,defaultParam);$("#account_type_help_text").text(n),$("#account_type_personal_parent").removeClass("whiteBgColor").addClass("greyBgColor"),$("#account_type_work_parent").removeClass("greyBgColor").addClass("whiteBgColor"),Securden_AccountSave.is_folder_needed_for_add_account?(SecurdenExtensionUtils.showHide(["folders_input_field_in_web_page_save"],[]),$("#securden_folders_wrappers_div").click((function(){Securden_AccountSave.createFolderDiv()}))):SecurdenExtensionUtils.showHide([],["folders_input_field_in_web_page_save"])}},hideFoldersDiv:function(){$("body").removeClass("body-with-folder-selection"),SecurdenExtensionUtils.showHide([],["securden_add_account_folders_wrap"])},createFolderDiv:function(){"firefox"!=SecurdenExtensionUtils.getBrowserName()&&Securden_AccountSave.createJsTreeFolderDiv()},createJsTreeFolderDiv:function(){$("body").addClass("body-with-folder-selection"),$("#securden_add_account_folders_wrap").empty();var e=document.getElementById("securden_add_account_folders_wrap"),t=document.createElement("div");t.className="input-group";var n=document.createElement("input");n.type="text",n.placeholder=browser.i18n.getMessage("search_node"),n.id="search_folders_text_box",n.className="sec-search-folders-text-box",t.appendChild(n),e.appendChild(t);var c=document.createElement("div");c.id="securden_add_account_folders",e.appendChild(c),SecurdenExtensionUtils.positioningDiv(document.getElementById("securden_folders_wrappers_div"),document.getElementById("securden_add_account_folders_wrap")),SecurdenExtensionUtils.showHide(["securden_add_account_folders_wrap"],[]),Securden_AccountSave.createFolderTree(),document.addEventListener("click",(function(e){var t=e.target;t.getAttribute("id")&&"search_folders_text_box"!=t.getAttribute("id")&&"securden-folders-select2-div"!=t.getAttribute("id")&&"securden_folders_wrappers_div"!=t.getAttribute("id")&&"securden_add_account_folders_wrap"!=t.getAttribute("id")&&Securden_AccountSave.hideFoldersDiv()}),!0)},createFolderTree:function(){$("#securden_add_account_folders").jstree({core:{data:Securden_AccountSave.folders},search:{case_insensitive:!0,show_only_matches:!0},types:{default:{icon:"icon-sec-folder"}},plugins:["search","sort","types","wholerow"]}),$("#search_folders_text_box").keyup((function(e){SecurdenExtensionUtils.stopEventPropagation(e);var t=$("#search_folders_text_box").val();$("#securden_add_account_folders").jstree("search",t)})),$("#securden_add_account_folders").on("select_node.jstree",(function(e,t){var n=t.node.id,c=t.node.a_attr.title;Securden_AccountSave.folderId=n,$("#securden-folders-select2-div").empty();var o=document.getElementById("securden-folders-select2-div"),a="";(a=document.createElement("option")).textContent=c,a.value=a.id=n,a.selected=!0,o.appendChild(a);var r=document.createElement("i");r.className="icon-sec-down",o.appendChild(r),Securden_AccountSave.folderId=n,Securden_AccountSave.hideFoldersDiv()}))},createJSTreeFoldersDiv(){var e=document.getElementById("securden_folders_wrappers_div");e.className="show";var t;if("firefox"==SecurdenExtensionUtils.getBrowserName())var n=document.createElement("select");else n=document.createElement("div");n.className="custom-select",n.name="securden_folder_id",n.id="securden-folders-select2-div",t=browser.i18n.getMessage("__none__"),n.innerText=t;var c=document.createElement("i");if(c.className="icon-sec-down","firefox"==SecurdenExtensionUtils.getBrowserName())for(var o=[{id:0,text:t,selected:!0},...Securden_AccountSave.folders],a=o.length,r=0;r<a;r++){var d="";d=document.createElement("option");var s=o[r].id;d.textContent=o[r].text,d.value=d.id=s,"selected"in o[r]&&o[r].selected&&(d.selected=!0),n.appendChild(d)}n.appendChild(c),e.appendChild(n),"firefox"==SecurdenExtensionUtils.getBrowserName()&&$("#securden-folders-select2-div").select2({tags:!0,templateSelection:function(e,t){return $(e.element).attr("data-id",e.element.id),e.text}})}};Securden_AccountSave.init();