"use strict";(self.webpackChunkpassit=self.webpackChunkpassit||[]).push([[356],{19356:(k,F,u)=>{u.r(F),u.d(F,{ImporterModule:()=>te});var x=u(36895),b=u(70430),N=u(90158),M=u(24006),A=u(13028),I=u(87629),e=u(94650),y=u(50807);let v=(()=>{class r{constructor(t){this.sdk=t}textToSecrets(t){return this.deserialize(t)}processImport(t){t=t.filter(o=>!0===o.doImport),this.saveSecrets(t)}saveSecrets(t){return new Promise((o,l)=>{const m=[];for(const S of t)m.push(this.sdk.create_secret(S).catch(O=>{console.error("Error creating secret",S,O)}));o(Promise.all(m))})}deserialize(t){const o=(0,A.parse)(t,{header:!0}).data,l=[];if(o.length>0)for(const m of o)if(Object.keys(m).length>0){const S=this.deserializeSecret(m);S.importable&&(S.name=this.validateName(S)),(void 0!==S.name||!S.importable)&&l.push(S)}return l}deserializeSecret(t){const o={doImport:!0,importable:!0,name:t.name,secrets:{password:t.password},type:"website",visible_data:{url:t.url,username:t.username}};return t.extra&&(o.secrets.notes=t.extra),typeof t.password>"u"&&(o.doImport=!1,o.importable=!1),o}validateName(t){const o=t.name,l=t.secrets.password,m=t.visible_data,S=m?t.visible_data.url:"",O=m?t.visible_data.username:"";return o&&""!==o?o:typeof S>"u"||""===S?!(typeof O>"u"||""===O)?`Anonymous (${O})`:!(typeof l>"u"||""===l)?"Anonymous Password":void 0:this.urlToName(S)}urlToName(t){const o=new I(t);let l="";return l=o.pathname.substr(1),""===l&&(l=o.href),l}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(y.N))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac}),r})();var _=(()=>{return(r=_||(_={})).SET_IMPORT_SECRETS="[Importer] SET_IMPORT_SECRETS",r.RESET_IMPORT_SECRETS="[Importer] RESET_IMPORT_SECRETS",r.SET_FILE_NAME="[Importer] SET_FILE_NAME",r.RESET_FILE_NAME="[Importer] RESET_FILE_NAME",_;var r})();class Z{constructor(h){this.payload=h,this.type=_.SET_IMPORT_SECRETS}}class R{constructor(){this.type=_.RESET_IMPORT_SECRETS}}class w{constructor(h){this.payload=h,this.type=_.SET_FILE_NAME}}class U{constructor(){this.type=_.RESET_FILE_NAME}}const Q={fileName:null,secrets:null};function T(r=Q,h){switch(h.type){case _.SET_FILE_NAME:return Object.assign({},r,{fileName:h.payload});case _.RESET_FILE_NAME:return Object.assign({},r,{fileName:null});case _.RESET_IMPORT_SECRETS:return Object.assign({},r,{secrets:null});case _.SET_IMPORT_SECRETS:return Object.assign({},r,{secrets:h.payload});default:return r}}const J=(0,b.ZF)("importer"),j=(0,b.P1)(J,r=>r.fileName),i=(0,b.P1)(J,r=>r.secrets);var s=u(96298),a=u(62932),n=u(81869),f=u(58410),p=u(1880),g=u(52109);const d=["fileInput"];function C(r,h){if(1&r&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.finishedSavingMessage)}}function E(r,h){1&r&&(e.TgZ(0,"span"),e._uU(1,"Importing"),e.qZA())}function q(r,h){1&r&&(e.TgZ(0,"span"),e._uU(1,"Successfully imported"),e.qZA())}function c(r,h){1&r&&(e.TgZ(0,"span"),e._uU(1,"Previewing"),e.qZA())}function P(r,h){1&r&&(e.TgZ(0,"span"),e._uU(1,"Ready to import"),e.qZA())}function D(r,h){if(1&r&&(e.TgZ(0,"h3"),e.YNc(1,E,2,0,"span",15),e.YNc(2,q,2,0,"span",15),e.YNc(3,c,2,0,"span",15),e.YNc(4,P,2,0,"span",15),e._uU(5),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.hasStartedSaving),e.xp6(1),e.Q6J("ngIf",t.hasFinishedSaving),e.xp6(1),e.Q6J("ngIf",!t.hasStartedSaving&&!t.hasFinishedSaving&&t.autoPreview),e.xp6(1),e.Q6J("ngIf",!t.hasStartedSaving&&!t.hasFinishedSaving&&!t.autoPreview),e.xp6(1),e.hij(" \u201c",t.fileName,"\u201d ")}}function G(r,h){1&r&&e._UZ(0,"div",27)}function L(r,h){if(1&r&&(e.TgZ(0,"th",28),e._uU(1),e.qZA()),2&r){const t=h.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Y(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"tr",29),e.NdJ("click",function(){const m=e.CHM(t).index,S=e.oxw(2);return e.KtG(S.toggleImport(m))}),e.TgZ(1,"td",30)(2,"label",31),e._UZ(3,"input",32),e.TgZ(4,"div",24),e._UZ(5,"div",13),e.qZA()()(),e.TgZ(6,"td",33)(7,"div",34),e.NdJ("mouseover",function(l){e.CHM(t);const m=e.oxw(2);return e.KtG(m.checkIfTooltipIsNecessary(l,250))}),e.TgZ(8,"span"),e._uU(9),e.qZA()()(),e.TgZ(10,"td",33)(11,"div",34),e.NdJ("mouseover",function(l){e.CHM(t);const m=e.oxw(2);return e.KtG(m.checkIfTooltipIsNecessary(l,250))}),e.TgZ(12,"span"),e._uU(13),e.qZA()()(),e.TgZ(14,"td",35)(15,"div",34),e.NdJ("mouseover",function(l){e.CHM(t);const m=e.oxw(2);return e.KtG(m.checkIfTooltipIsNecessary(l,500))}),e.TgZ(16,"span"),e._uU(17),e.qZA()()(),e.TgZ(18,"td",33)(19,"div",34),e.NdJ("mouseover",function(l){e.CHM(t);const m=e.oxw(2);return e.KtG(m.checkIfTooltipIsNecessary(l,250))}),e.TgZ(20,"span"),e._uU(21),e.qZA()()(),e.TgZ(22,"td",33)(23,"div",34),e.NdJ("mouseover",function(l){e.CHM(t);const m=e.oxw(2);return e.KtG(m.checkIfTooltipIsNecessary(l,250))}),e.TgZ(24,"span"),e._uU(25),e.qZA()()()()}if(2&r){const t=h.$implicit,o=h.index,l=e.oxw(2);e.ekj("import__table-row--disabled",!t.importable),e.xp6(2),e.MGl("for","doImport",o,""),e.xp6(1),e.Q6J("checked",t.doImport),e.xp6(2),e.Q6J("inlineSVG","../assets/svg/check.svg"),e.xp6(2),e.Q6J("tooltip",t.name)("display",!l.tooltipDisabled),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Q6J("tooltip",t.visible_data.username)("display",!l.tooltipDisabled),e.xp6(2),e.Oqu(t.visible_data.username),e.xp6(2),e.Q6J("tooltip",t.visible_data.url)("display",!l.tooltipDisabled),e.xp6(2),e.Oqu(t.visible_data.url),e.xp6(2),e.Q6J("tooltip",t.secrets.password)("display",!l.tooltipDisabled),e.xp6(2),e.Oqu(t.secrets.password),e.xp6(2),e.Q6J("tooltip",t.secrets.notes)("display",!l.tooltipDisabled),e.xp6(2),e.Oqu(t.secrets.notes)}}function z(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"div",19),e.YNc(1,G,1,0,"div",20),e.TgZ(2,"table",21)(3,"tr")(4,"th",22),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.toggleAll())}),e.TgZ(5,"label",23)(6,"div",24),e._UZ(7,"div",13),e.qZA()()(),e.YNc(8,L,2,1,"th",25),e.qZA(),e.YNc(9,Y,26,20,"tr",26),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.hasStartedSaving||t.hasFinishedSaving),e.xp6(5),e.ekj("form-field__checkbox__check--checked",t.toggleAllState),e.xp6(1),e.Q6J("inlineSVG",t.toggleAllUseMinus?"../assets/svg/minus.svg":"../assets/svg/check.svg"),e.xp6(1),e.Q6J("ngForOf",t.previewHeader),e.xp6(1),e.Q6J("ngForOf",t.secrets)("ngForTrackBy",t.trackSecret)}}function H(r,h){if(1&r){const t=e.EpF();e.TgZ(0,"div",36)(1,"button",37),e._uU(2," Import Selected Passwords "),e.qZA(),e.TgZ(3,"button",38),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.onReset())}),e._uU(4," Reset "),e.qZA(),e._UZ(5,"progress-indicator",39),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.hasStartedSaving||t.hasFinishedSaving),e.xp6(2),e.Q6J("disabled",t.hasStartedSaving||t.hasFinishedSaving),e.xp6(2),e.Q6J("inProgress",t.hasStartedSaving)("completed",t.hasFinishedSaving)}}const V=function(){return["/account"]};let B=(()=>{class r{constructor(t){this.importerService=t,this.previewHeader=["name","username","url","password","notes"],this.importText="",this.autoPreview=!0,this.toggleAllState=!0,this.toggleAllUseMinus=!1,this.tooltipDisabled=!1,this.resetForm=new e.vpe,this.resetFinishedMessage=new e.vpe,this.setFileName=new e.vpe,this.setImportableSecrets=new e.vpe,this.saveSecrets=new e.vpe}onReset(){this.resetForm.emit()}onSubmit(){this.saveSecrets.emit(this.secrets)}togglePreview(){this.autoPreview=!this.autoPreview}cleanFile(t){const o=t.target;o.files.length>0&&this.readThis(o)}readThis(t){const o=t.files[0];this.setFileName.emit(o.name);const l=new FileReader;l.onloadend=m=>{this.resetFinishedMessage.emit(),this.fileInput.nativeElement.value="",this.importText=l.result;const S=this.importerService.textToSecrets(this.importText);this.setImportableSecrets.emit(S)},l.readAsText(o)}toggleAll(){const t=this.secrets.slice(0);t.forEach((o,l)=>{const m=Object.assign({},o);o.importable&&(m.doImport=!this.toggleAllState,t[l]=m)}),this.toggleAllState=!this.toggleAllState,this.setImportableSecrets.emit(t),this.toggleAllUseMinus=!1}toggleImport(t){const o=this.secrets.slice(0);if(o[t].importable){const l=Object.assign({},o[t]);l.doImport=!l.doImport,o[t]=l,this.setImportableSecrets.emit(o),this.setToggleAllState(o)}}setToggleAllState(t){let o=0;t.forEach((l,m)=>{l.doImport&&o++}),t.length!==o&&0!==o?(this.toggleAllState=!0,this.toggleAllUseMinus=!0):(this.toggleAllUseMinus=!1,0===o&&(this.toggleAllState=!1))}trackSecret(t,o){return o?o.id:void 0}checkIfTooltipIsNecessary(t,o){const l=t.target,m="DIV"===l.tagName?l.firstElementChild:l;this.tooltipDisabled=!((m?m.offsetWidth:-1)>=o)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["importer-component"]],viewQuery:function(t,o){if(1&t&&e.Gf(d,7),2&t){let l;e.iGM(l=e.CRH())&&(o.fileInput=l.first)}},inputs:{fileName:"fileName",finishedSavingMessage:"finishedSavingMessage",hasStartedSaving:"hasStartedSaving",hasFinishedSaving:"hasFinishedSaving",secrets:"secrets"},outputs:{resetForm:"resetForm",resetFinishedMessage:"resetFinishedMessage",setFileName:"setFileName",setImportableSecrets:"setImportableSecrets",saveSecrets:"saveSecrets"},decls:31,vars:16,consts:[[1,"import","l-container-narrow","u-margin-tb-50"],["caret","left",1,"heading-back-link",3,"link"],["text","Import Passwords"],[1,"text--large"],["importForm","ngForm"],[1,"import__form-wrapper"],[1,"button","import__input"],["type","file","required","","accept",".csv, text/csv",1,"import__input-actual",3,"disabled","change"],["fileInput",""],[1,"button__icon",3,"inlineSVG"],["for","toggle-preview",1,"import__toggle-preview","form-field__checkbox","form-field__checkbox--inline"],["id","toggle-preview","type","checkbox",1,"form-field__checkbox__input",3,"checked","disabled","click"],[1,"form-field__checkbox__check","form-field__checkbox__check--inline"],[3,"inlineSVG"],[1,"form-field__checkbox__text"],[4,"ngIf"],[3,"ngSubmit"],["class","l-container l-container--mobile-margin import__table-container",4,"ngIf"],["class","import__actions l-container-narrow u-margin-tb-50",4,"ngIf"],[1,"l-container","l-container--mobile-margin","import__table-container"],["class","import__table-overlay",4,"ngIf"],[1,"import__table"],[1,"import__table-cell","import__table-cell--header","import__table-cell--import",3,"click"],[1,"form-field__checkbox","import__checkbox"],[1,"form-field__checkbox__check","form-field__checkbox__check--small"],["class","import__table-cell import__table-cell--header",4,"ngFor","ngForOf"],["class","import__table-row",3,"import__table-row--disabled","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"import__table-overlay"],[1,"import__table-cell","import__table-cell--header"],[1,"import__table-row",3,"click"],[1,"import__table-cell","import__table-cell--import"],[1,"form-field__checkbox","import__checkbox",3,"for"],["type","checkbox",1,"form-field__checkbox__input",3,"checked"],[1,"import__table-cell","import__table-cell--max-width-medium"],["placement","top",3,"tooltip","display","mouseover"],[1,"import__table-cell","import__table-cell--max-width-large"],[1,"import__actions","l-container-narrow","u-margin-tb-50"],["type","submit",1,"button","button--primary",3,"disabled"],["type","button",1,"button","button--text","button--text-danger",3,"disabled","click"],["inProgressText","Importing","completedText","Imported",3,"inProgress","completed"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"app-text-link",1),e._uU(2,"Account Management"),e.qZA(),e._UZ(3,"app-heading",2),e.TgZ(4,"div",3),e._uU(5," Passit can currently import CSV files and will pull data from the following\xa0columns:"),e._UZ(6,"br"),e._uU(7,"url, username, password, name, extra."),e._UZ(8,"br"),e._uU(9," Extra refers to notes. "),e.qZA(),e.TgZ(10,"div")(11,"form",null,4)(13,"div",5)(14,"label",6)(15,"input",7,8),e.NdJ("change",function(m){return o.cleanFile(m)}),e.qZA(),e.TgZ(17,"span"),e._UZ(18,"div",9),e._uU(19),e.qZA()(),e.TgZ(20,"label",10)(21,"input",11),e.NdJ("click",function(){return o.togglePreview()}),e.qZA(),e.TgZ(22,"div",12),e._UZ(23,"div",13),e.qZA(),e.TgZ(24,"div",14),e._uU(25,"Preview Import"),e.qZA()()()(),e.YNc(26,C,2,1,"h3",15),e.YNc(27,D,6,5,"h3",15),e.qZA()(),e.TgZ(28,"form",16),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.YNc(29,z,10,7,"div",17),e.YNc(30,H,6,4,"div",18),e.qZA()),2&t&&(e.xp6(1),e.Q6J("link",e.DdM(15,V)),e.xp6(13),e.ekj("button--primary",!o.fileName)("button--gray",o.fileName),e.xp6(1),e.Q6J("disabled",o.hasStartedSaving||o.hasFinishedSaving),e.xp6(3),e.Q6J("inlineSVG","../assets/svg/upload.svg"),e.xp6(1),e.hij(" ",o.fileName?"Choose a different file":"Choose a CSV file"," "),e.xp6(2),e.Q6J("checked",o.autoPreview)("disabled",o.hasStartedSaving||o.hasFinishedSaving),e.xp6(2),e.Q6J("inlineSVG","../assets/svg/check.svg"),e.xp6(3),e.Q6J("ngIf",o.finishedSavingMessage),e.xp6(1),e.Q6J("ngIf",o.fileName&&!o.finishedSavingMessage),e.xp6(2),e.Q6J("ngIf",o.autoPreview&&o.fileName),e.xp6(1),e.Q6J("ngIf",o.fileName))},dependencies:[x.sg,x.O5,s.d$,f.B,M._Y,M.JL,M.F,N.i9,p.B,g.C],styles:[".import__form-wrapper[_ngcontent-%COMP%]{display:block;margin-bottom:40px}.import__toggle-preview[_ngcontent-%COMP%]{margin-left:20px}@media (min-width: 0) and (max-width: 500px){.import__toggle-preview[_ngcontent-%COMP%]{display:block;margin:20px 0}}.import__do-import-check[_ngcontent-%COMP%]{display:none}.import__input[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.import__input-actual[_ngcontent-%COMP%]{position:fixed;top:-9999px}.import__table-container[_ngcontent-%COMP%]{position:relative;max-height:250px;border-top:1px solid #D0E6E6;border-bottom:1px solid #D0E6E6;overflow:auto}.import__table-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#ffffffab;z-index:2}.import__table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.import__table-row[_ngcontent-%COMP%]:hover   .import__table-cell[_ngcontent-%COMP%]{background-color:#f3fcf8;cursor:pointer}.import__table-row--disabled[_ngcontent-%COMP%]{background-color:#f7f7f7;color:#999}.import__table-row--disabled[_ngcontent-%COMP%]:hover   .import__table-cell[_ngcontent-%COMP%]{background-color:#f7f7f7}.import__table-cell[_ngcontent-%COMP%]{padding:13px 10px 10px;text-align:left;border-bottom:1px solid #D0E6E6;overflow:hidden;white-space:nowrap}.import__table-cell--max-width-medium[_ngcontent-%COMP%]{max-width:250px}.import__table-cell--max-width-large[_ngcontent-%COMP%]{max-width:500px}.import__table-cell--import[_ngcontent-%COMP%]{padding:4px 1px 0 7px;text-align:center;cursor:pointer}.import__checkbox[_ngcontent-%COMP%]{top:8px}.import__actions[_ngcontent-%COMP%]{position:relative}.import__tooltip[_ngcontent-%COMP%]{word-break:break-all}tr[_ngcontent-%COMP%]:last-child   .import__table-cell[_ngcontent-%COMP%]{border-bottom:0}",".change-password__actions[_ngcontent-%COMP%]{position:relative}.change-password__note[_ngcontent-%COMP%]{margin-top:25px;color:#413741;line-height:1.5}"]}),r})();const W=[{path:"",component:(()=>{class r{constructor(t,o){this.store=t,this.importerService=o,this.finishedSavingMessage=null,this.hasStartedSaving=!1,this.hasFinishedSaving=!1,t.pipe((0,b.Ys)(i)).subscribe(l=>{this.secrets=l}),t.pipe((0,b.Ys)(j)).subscribe(l=>{this.fileName=l})}ngOnDestroy(){this.resetForm()}resetForm(){this.store.dispatch(new R),this.store.dispatch(new U)}resetFinishedMessage(){this.finishedSavingMessage=null}setFileName(t){this.store.dispatch(new w(t))}setImportableSecrets(t){this.store.dispatch(new Z(t))}saveSecrets(t){this.hasStartedSaving=!0,this.hasFinishedSaving=!1,t=t.filter(o=>!0===o.doImport),setTimeout(()=>{this.importerService.saveSecrets(t).then(()=>{this.hasStartedSaving=!1,this.hasFinishedSaving=!0,this.finishedSavingMessage=`Successfully imported \u201c${this.fileName}\u201d`,setTimeout(()=>{this.hasFinishedSaving=!1,this.resetForm()},3e3)}).catch(o=>{this.hasStartedSaving=!1,this.hasFinishedSaving=!1,this.finishedSavingMessage="Something went wrong. Some secrets may not have imported."})},1e3)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(b.yh),e.Y36(v))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ng-component"]],decls:1,vars:5,consts:[[3,"fileName","finishedSavingMessage","hasStartedSaving","hasFinishedSaving","secrets","resetForm","resetFinishedMessage","setFileName","setImportableSecrets","saveSecrets"]],template:function(t,o){1&t&&(e.TgZ(0,"importer-component",0),e.NdJ("resetForm",function(){return o.resetForm()})("resetFinishedMessage",function(){return o.resetFinishedMessage()})("setFileName",function(m){return o.setFileName(m)})("setImportableSecrets",function(m){return o.setImportableSecrets(m)})("saveSecrets",function(m){return o.saveSecrets(m)}),e.qZA()),2&t&&e.Q6J("fileName",o.fileName)("finishedSavingMessage",o.finishedSavingMessage)("hasStartedSaving",o.hasStartedSaving)("hasFinishedSaving",o.hasFinishedSaving)("secrets",o.secrets)},dependencies:[B],encapsulation:2}),r})(),canActivate:[u(56695).e],data:{title:"Import Passwords"}}];let X=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[n.Bz.forChild(W),n.Bz]}),r})();var ee=u(75349);let te=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[v],imports:[x.ez,s.vi,a._,M.u5,N.z8,ee.m,X,b.Aw.forFeature("importer",T)]}),r})()},12858:(k,F)=>{var u=Object.prototype.hasOwnProperty;function b(I){try{return decodeURIComponent(I.replace(/\+/g," "))}catch{return null}}function N(I){try{return encodeURIComponent(I)}catch{return null}}F.stringify=function A(I,e){e=e||"";var v,_,y=[];for(_ in"string"!=typeof e&&(e="?"),I)if(u.call(I,_)){if(!(v=I[_])&&(null==v||isNaN(v))&&(v=""),_=N(_),v=N(v),null===_||null===v)continue;y.push(_+"="+v)}return y.length?e+y.join("&"):""},F.parse=function M(I){for(var v,e=/([^=?#&]+)=?([^&]*)/g,y={};v=e.exec(I);){var _=b(v[1]),Z=b(v[2]);null===_||null===Z||_ in y||(y[_]=Z)}return y}},28237:k=>{k.exports=function(u,x){if(x=x.split(":")[0],!(u=+u))return!1;switch(x){case"http":case"ws":return 80!==u;case"https":case"wss":return 443!==u;case"ftp":return 21!==u;case"gopher":return 70!==u;case"file":return!1}return 0!==u}},87629:(k,F,u)=>{var x=u(28237),b=u(12858),N=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,M=/[\n\r\t]/g,A=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,I=/:\d+$/,e=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,y=/^[a-zA-Z]:/;function v(i){return(i||"").toString().replace(N,"")}var _=[["#","hash"],["?","query"],function(s,a){return w(a.protocol)?s.replace(/\\/g,"/"):s},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Z={hash:1,query:1};function R(i){var s;s=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var p,n={},f=typeof(i=i||s.location||{});if("blob:"===i.protocol)n=new T(unescape(i.pathname),{});else if("string"===f)for(p in n=new T(i,{}),Z)delete n[p];else if("object"===f){for(p in i)p in Z||(n[p]=i[p]);void 0===n.slashes&&(n.slashes=A.test(i.href))}return n}function w(i){return"file:"===i||"ftp:"===i||"http:"===i||"https:"===i||"ws:"===i||"wss:"===i}function U(i,s){i=(i=v(i)).replace(M,""),s=s||{};var d,a=e.exec(i),n=a[1]?a[1].toLowerCase():"",f=!!a[2],p=!!a[3],g=0;return f?p?(d=a[2]+a[3]+a[4],g=a[2].length+a[3].length):(d=a[2]+a[4],g=a[2].length):p?(d=a[3]+a[4],g=a[3].length):d=a[4],"file:"===n?g>=2&&(d=d.slice(2)):w(n)?d=a[4]:n?f&&(d=d.slice(2)):g>=2&&w(s.protocol)&&(d=a[4]),{protocol:n,slashes:f||w(n),slashesCount:g,rest:d}}function T(i,s,a){if(i=(i=v(i)).replace(M,""),!(this instanceof T))return new T(i,s,a);var n,f,p,g,d,C,E=_.slice(),q=typeof s,c=this,P=0;for("object"!==q&&"string"!==q&&(a=s,s=null),a&&"function"!=typeof a&&(a=b.parse),n=!(f=U(i||"",s=R(s))).protocol&&!f.slashes,c.slashes=f.slashes||n&&s.slashes,c.protocol=f.protocol||s.protocol||"",i=f.rest,("file:"===f.protocol&&(2!==f.slashesCount||y.test(i))||!f.slashes&&(f.protocol||f.slashesCount<2||!w(c.protocol)))&&(E[3]=[/(.*)/,"pathname"]);P<E.length;P++)"function"!=typeof(g=E[P])?(C=g[1],(p=g[0])!=p?c[C]=i:"string"==typeof p?~(d="@"===p?i.lastIndexOf(p):i.indexOf(p))&&("number"==typeof g[2]?(c[C]=i.slice(0,d),i=i.slice(d+g[2])):(c[C]=i.slice(d),i=i.slice(0,d))):(d=p.exec(i))&&(c[C]=d[1],i=i.slice(0,d.index)),c[C]=c[C]||n&&g[3]&&s[C]||"",g[4]&&(c[C]=c[C].toLowerCase())):i=g(i,c);a&&(c.query=a(c.query)),n&&s.slashes&&"/"!==c.pathname.charAt(0)&&(""!==c.pathname||""!==s.pathname)&&(c.pathname=function Q(i,s){if(""===i)return s;for(var a=(s||"/").split("/").slice(0,-1).concat(i.split("/")),n=a.length,f=a[n-1],p=!1,g=0;n--;)"."===a[n]?a.splice(n,1):".."===a[n]?(a.splice(n,1),g++):g&&(0===n&&(p=!0),a.splice(n,1),g--);return p&&a.unshift(""),("."===f||".."===f)&&a.push(""),a.join("/")}(c.pathname,s.pathname)),"/"!==c.pathname.charAt(0)&&w(c.protocol)&&(c.pathname="/"+c.pathname),x(c.port,c.protocol)||(c.host=c.hostname,c.port=""),c.username=c.password="",c.auth&&(~(d=c.auth.indexOf(":"))?(c.username=c.auth.slice(0,d),c.username=encodeURIComponent(decodeURIComponent(c.username)),c.password=c.auth.slice(d+1),c.password=encodeURIComponent(decodeURIComponent(c.password))):c.username=encodeURIComponent(decodeURIComponent(c.auth)),c.auth=c.password?c.username+":"+c.password:c.username),c.origin="file:"!==c.protocol&&w(c.protocol)&&c.host?c.protocol+"//"+c.host:"null",c.href=c.toString()}T.prototype={set:function J(i,s,a){var n=this;switch(i){case"query":"string"==typeof s&&s.length&&(s=(a||b.parse)(s)),n[i]=s;break;case"port":n[i]=s,x(s,n.protocol)?s&&(n.host=n.hostname+":"+s):(n.host=n.hostname,n[i]="");break;case"hostname":n[i]=s,n.port&&(s+=":"+n.port),n.host=s;break;case"host":n[i]=s,I.test(s)?(s=s.split(":"),n.port=s.pop(),n.hostname=s.join(":")):(n.hostname=s,n.port="");break;case"protocol":n.protocol=s.toLowerCase(),n.slashes=!a;break;case"pathname":case"hash":if(s){var f="pathname"===i?"/":"#";n[i]=s.charAt(0)!==f?f+s:s}else n[i]=s;break;case"username":case"password":n[i]=encodeURIComponent(s);break;case"auth":var p=s.indexOf(":");~p?(n.username=s.slice(0,p),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=s.slice(p+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(s))}for(var g=0;g<_.length;g++){var d=_[g];d[4]&&(n[d[1]]=n[d[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin="file:"!==n.protocol&&w(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function j(i){(!i||"function"!=typeof i)&&(i=b.stringify);var s,a=this,n=a.host,f=a.protocol;f&&":"!==f.charAt(f.length-1)&&(f+=":");var p=f+(a.protocol&&a.slashes||w(a.protocol)?"//":"");return a.username?(p+=a.username,a.password&&(p+=":"+a.password),p+="@"):a.password?(p+=":"+a.password,p+="@"):"file:"!==a.protocol&&w(a.protocol)&&!n&&"/"!==a.pathname&&(p+="@"),(":"===n[n.length-1]||I.test(a.hostname)&&!a.port)&&(n+=":"),p+=n+a.pathname,(s="object"==typeof a.query?i(a.query):a.query)&&(p+="?"!==s.charAt(0)?"?"+s:s),a.hash&&(p+=a.hash),p}},T.extractProtocol=U,T.location=R,T.trimLeft=v,T.qs=b,k.exports=T}}]);