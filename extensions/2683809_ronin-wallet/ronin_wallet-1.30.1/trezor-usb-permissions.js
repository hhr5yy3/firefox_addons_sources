const switchToPopupTab=e=>{window.removeEventListener("beforeunload",switchToPopupTab),e?chrome.tabs.query({url:"*://connect.trezor.io/*/popup.html"},(e=>{e.length<0||chrome.tabs.update(e[0].id,{active:!0})})):chrome.tabs.query({currentWindow:!0,active:!0},(e=>{e.length<0||(chrome.tabs.query({index:e[0].index-1},(e=>{e.length<0||chrome.tabs.update(e[0].id,{active:!0})})),chrome.tabs.remove(e[0].id))}))};window.addEventListener("message",(e=>{"usb-permissions-init"===e.data?document.getElementById("trezor-usb-permissions").contentWindow.postMessage({type:"usb-permissions-init",extension:chrome.runtime.id},"*"):"usb-permissions-close"===e.data&&switchToPopupTab()})),window.addEventListener("beforeunload",switchToPopupTab);