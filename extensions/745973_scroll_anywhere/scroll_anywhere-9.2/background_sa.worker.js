(()=>{"use strict";var e={715:(e,t,r)=>{function o(e){let t,r=!1;return(...o)=>r?t:(r=!0,t=e(...o))}const n=o((()=>self.location.href===browser.runtime.getManifest().background.page));const a=(...e)=>{},s=(...e)=>!1,i=(...e)=>{},l=e=>{throw Error(e)};function c(e,t=i){try{return e()}catch(e){return t(e)}}Object.entries;const u=e=>"string"==typeof e,p=e=>(e=>!isNaN(e-parseFloat(e)))(e),h=e=>!!e,d=()=>{const e=[];return e.splice(0,0,new Promise(((t,r)=>{e.push(t,r)}))),e},f=({initialWork:e=[],canRunWithOthers:t,beforeEach:r,afterEach:o,maxConcurrentJobs:n=1}={})=>{const a=[...e],s=new Set;return{addWork:async function(e,t){return new Promise(((r,n)=>{const l={info:t,fn(){const a=e();a.finally((async()=>{s.delete(l),o&&await o(t),a.then(r,n).finally((()=>{Promise.resolve().then(i)}))}))}};a.push(l),i()}))},startWork:i,getRunningJobsCount:()=>s.size,getPendingJobsCount:()=>a.length,hasFreeSlot:()=>s.size<n};async function i(){for(;a.length>0&&s.size<n&&(0===s.size||!t||t(a[0].info,[...s].map((e=>e.info))));){const e=a.shift();s.add(e),r&&await r(e.info),e.fn()}}},w=e=>{let t=!1;return(...r)=>{t||(t=!0,e(...r))}};const{port1:g,port2:y}=new MessageChannel;class b extends class{constructor(e,t={storageArea:"local"}){this.key=e,this.options=t,this._listeners=Array(),this._listenForChangesFn=w((()=>browser.storage.onChanged.addListener(((e,t)=>{t===this.storageArea&&e[this.key]&&this._listeners.forEach((t=>t(e[this.key])))})))),this.storageArea=t.storageArea}async addOnChangeListener(e,{dummyInitValue:t}={}){var r;this._listeners.push(e),this._listenForChangesFn(),t&&e({newValue:(r=t,r instanceof Promise?await t:t)})}}{constructor(e,t,r={storageArea:"local"}){super(e,r),this.key=e,this.getDefaultValue=t,this.options=r,this._updateExecutor=f({maxConcurrentJobs:1}),this._setExecutor=f({maxConcurrentJobs:1}),this.storageArea=r.storageArea}async reset(){return this.set(await this.getDefaultValue())}async orDefault(e){return e.hasOwnProperty(this.key)?e[this.key]:await this.getDefaultValue()}async get(){const e="custom"===this.storageArea?await this.options.customDataSource.get()||await this.getDefaultValue():"remote"===this.storageArea?await(await fetch(this.options.remoteApi.url,await this.getRequestInit())).json()||await this.getDefaultValue():"localStorage"===this.storageArea?this.options.localStorageTextOnly?c((()=>self.localStorage.getItem(this.key)),(()=>""))||await this.getDefaultValue():await c((()=>JSON.parse(self.localStorage.getItem(this.key))),(()=>this.getDefaultValue())):await browser.storage[this.storageArea].get(this.key).then((e=>this.orDefault(e)));return this.options.preProcessor?await this.options.preProcessor(e):e}async remove(){return"custom"===this.storageArea?await this.options.customDataSource.remove():"remote"===this.storageArea?(await fetch(this.options.remoteApi.url,await this.getRequestInit("DELETE"))).json():"localStorage"===this.storageArea?c((()=>self.localStorage.removeItem(this.key))):browser.storage[this.storageArea].remove(this.key)}async update(e){return this._updateExecutor.addWork((()=>this.get().then(e).then((e=>this.set(e)))))}async set(e){return this._setExecutor.addWork((async()=>{this.options.onBeforeSave&&await this.options.onBeforeSave(e);return await("custom"===this.storageArea?await this.options.customDataSource.set(e):"remote"===this.storageArea?void await fetch(this.options.remoteApi.url,await this.getRequestInit("POST",JSON.stringify(e))):"localStorage"===this.storageArea?c((()=>self.localStorage.setItem(this.key,this.options.localStorageTextOnly?String(e):JSON.stringify(e)))):browser.storage[this.storageArea].set({[this.key]:e}))}))}async setWith(e,t){return"remote"===this.storageArea||"custom"===this.storageArea||"localStorage"===this.storageArea?l("missing"):browser.storage[this.storageArea].set(Object.assign({[this.key]:e},t))}async getWith(...e){const t=e.map((e=>u(e)?e:e.key)),r="remote"===this.storageArea||"custom"===this.storageArea||"localStorage"===this.storageArea?l("missing"):await browser.storage[this.storageArea].get([this.key,...t]),o=await this.orDefault(r),n=e.map((async e=>u(e)?r[e]:await e.orDefault(r)));return[o,...await Promise.all(n)]}async getRequestInit(e="GET",t){var r,o;const n=await(a=this.options.remoteApi.GET_Headers,"function"==typeof a?a():a);var a;const s=await(null===(o=(r=this.options.remoteApi).authToken)||void 0===o?void 0:o.call(r));return{method:e,body:t,...n,...s?{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json",...null==n?void 0:n.headers}}:{}}}}const m=()=>Math.floor(Date.now()/864e5);const I="sync";var A,_,O,E,S,D,v,L;browser.runtime.onInstalled.addListener((async({reason:e})=>{const t=new b("__install_date",(()=>{}),{storageArea:I});switch(e){case"install":await t.get()||await t.set([m(),m()]);break;case"update":const e=Object.entries(await browser.storage.sync.get()).filter((([e])=>e.startsWith("__install_date_")));if(e.length>0){await browser.storage.sync.remove(e.map((([e])=>e)));const[r,o]=e[0];await t.set([o,o])}}})),(e=>{e[e.TEXT=0]="TEXT",e[e.CLICKABLE=1]="CLICKABLE",e[e.LINK=2]="LINK",e[e.OTHER=3]="OTHER"})(A||(A={})),(e=>{e[e.UNIFORM=0]="UNIFORM",e[e.EXPONENTIAL=1]="EXPONENTIAL",e[e.INFINITE=2]="INFINITE"})(_||(_={})),(e=>{e[e.SCROLLBAR=0]="SCROLLBAR",e[e.GRAB_AND_DRAG=1]="GRAB_AND_DRAG",e[e.DYNAMIC_MULTIPLIER=2]="DYNAMIC_MULTIPLIER"})(O||(O={})),(e=>{e[e.SINGLE_CLICK=0]="SINGLE_CLICK",e[e.DOUBLE_CLICK=1]="DOUBLE_CLICK"})(E||(E={})),(e=>{e[e.NORMAL=0]="NORMAL",e[e.THIN=1]="THIN",e[e.HIDDEN=2]="HIDDEN"})(S||(S={})),(e=>{e[e.IF_PRESSED=0]="IF_PRESSED",e[e.NOT_PRESSED=1]="NOT_PRESSED"})(D||(D={})),(e=>{e[e.enabled=0]="enabled",e[e.userDisabled=1]="userDisabled",e[e.browserDisabled=2]="browserDisabled"})(v||(v={})),(e=>{e[e.smart=0]="smart",e[e.strict=1]="strict",e[e.none=2]="none",e[e.y_only=3]="y_only",e[e.x_only=4]="x_only"})(L||(L={}));r(576);function R(e,t){return(e=>{const t=Object.getOwnPropertyNames(e);for(let r=0;r<t.length;r++)delete e[t[r]]})(e),Object.assign(e,t)}const N={},C=async function(e){return browser.storage.onChanged.addListener((t=>{Object.entries(t).forEach((([t,{newValue:r}])=>{e[t]=r}))})),R(e,await browser.storage.local.get())}(N);browser.runtime.onInstalled.addListener((async({reason:e,previousVersion:t})=>{const r=await C;"boolean"!=typeof r.MOMENTUM&&await browser.storage.local.set({MOMENTUM:!0,DURATION_MULTIPLIER:1e3,ADDITIONAL_SPEED:0,DURATION_PLUS:0,MOMENTUM_STOP_DETECTION:50}),p(r.SCROLL_TYPE)||await browser.storage.local.set({SCROLL_TYPE:r.simple_ratio?O.GRAB_AND_DRAG:O.SCROLLBAR}),"update"===e&&parseFloat(t)<8.8&&r.CURSOR&&await browser.storage.local.set({CURSOR_X:r.CURSOR,CURSOR_Y:r.CURSOR}),"install"===e&&browser.tabs.create({url:"/options/options.html?welcome",active:!0})}));async function P(){return browser.runtime.getBrowserInfo?browser.runtime.getBrowserInfo().then((e=>parseInt(e.version))):0}let T=!1;const M=browser.runtime.getPlatformInfo?browser.runtime.getPlatformInfo().then((({os:e})=>T="android"===e)):Promise.resolve(!1);let k=!1;M.then((e=>k=!e));browser.runtime.onStartup.addListener((async()=>{if(await C,await M)return;const e=await browser.storage.managed.get().catch(s);e&&await browser.storage.local.set(e)}));const B=()=>browser.tabs.query(T?{active:!0}:{active:!0,lastFocusedWindow:!0}).then((([e])=>e));const j=n();async function x(e,t={}){const r=(o=e,Array.isArray(o)?o:[o]);var o;const{cookieStoreId:n,inNewTab:a=!1,nextToCurrent:s=!1,active:i=!1,inNewWindow:l=!1,windowId:c,forceIncognitoWindow:u=!1,stopOpenerTabId:p,_directCall:h}=t;if(!j&&!h)return function(e,t){if(t._directCall)throw Error("infinite loop???");return t._directCall=!0,browser.runtime.sendMessage(new U(e,t))}(r,t);const d=n,f=d?{cookieStoreId:n}:{},[w,...g]=r,y=await b(w,0,c);return g.forEach(((e,t)=>b(e,t+1,y.windowId))),y;async function b(e,t,r){const o=d&&!a&&!l&&0===t;if(l)return browser.windows.create({url:e,...f,...u?{incognito:!0}:{}}).then((e=>e.tabs[0]));if(a||o||t>0){const a=i&&0===t,l=await B()||{id:void 0,index:void 0},c=(n=l.index,Number.isFinite(n)?l.index+1:void 0),u=!(!T&&!p),h=t=>browser.tabs.create({url:e,...f,windowId:r,active:a,...s?{index:c}:{},...t?{}:{openerTabId:l.id}}),d=u?await h(u):await h(u).catch((()=>h(!0)));return o&&l.id&&browser.tabs.remove(l.id),d}return await browser.tabs.update({url:e});var n}}class U{constructor(e,t){this.links=e,this.options=t,this.type="openURL"}}j&&browser.runtime.onMessage.addListener((e=>{if("openURL"===e.type)return x(e.links,e.options)}));const F=async(e,t,r)=>{var o,n;return null===(n=(o=browser.tabs).sendMessage)||void 0===n?void 0:n.call(o,e||await browser.tabs.getCurrent().then((e=>e.id)),t,r)};var W;null===(W=browser.tabs.onZoomChange)||void 0===W||W.addListener((({newZoomFactor:e,tabId:t})=>{F(t,{type:"zoom",zoom:e}).catch(a)}));const[G,V]=d(),H=(Promise.resolve(),(e,t)=>e?browser.i18n.getMessage(e,t):"");new Map;new b("DISABLED_DOMAINS",(()=>({}))),new b("DISABLED_HORIZONTAL_SCROLLING_DOMAINS",(()=>({})));const $=new b("IS_DISABLED",(()=>!1)),z=()=>{const e=browser.runtime.getManifest();return`${e.name} ${e.version}`};async function K(e,t){await M||await browser.browserAction.setIcon({tabId:e,path:t===v.browserDisabled?"/128_dev.png":t===v.userDisabled?"/128_red.png":"/128.png"}),await browser.browserAction.setTitle({tabId:e,title:`${z()}\n\n${t===v.browserDisabled?H("not_working"):t===v.userDisabled?await $.get()?H("o_disabled"):H("disabled_by_user"):""}`.trimEnd()})}K(void 0,v.browserDisabled),browser.tabs.onCreated.addListener((async e=>{var t;await(t=50,new Promise((e=>setTimeout(e,t)))),await K(e.id,v.browserDisabled)}));const J="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,Z=J?Promise.resolve():new Promise((e=>"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>e()))));let Y=!1,q=!1,X=D.IF_PRESSED;async function Q(){var e,t;const r=await C,o=function(e,t=!1){try{const r=new URL(e).hostname;return t&&r.startsWith("www.")?r.substring(4):r}catch(e){return""}}(location.href,!0);var n;q=r.IS_DISABLED||(null===(e=r.DISABLED_DOMAINS)||void 0===e?void 0:e[o])||function(e={},t){const{hostname:r,pathname:o,search:n,hash:a}=new URL(t),s=(r.startsWith("www.")?r.substring(4):r)+o+n+a;return!!Object.keys(e).find((e=>e.endsWith("*")?s.startsWith(e.slice(0,-1)):s===e))}(r.DISABLED_URL,location.href)||!1,X=r.DISABLE_TYPE||D.IF_PRESSED,Y=!!(null===(t=r.DISABLED_HORIZONTAL_SCROLLING_DOMAINS)||void 0===t?void 0:t[o]),await(n={type:"updateIcon",status:q?v.userDisabled:v.enabled},browser.runtime.sendMessage(n))}"moz-extension:"!==self.location.protocol&&(C.then(Q),browser.storage.onChanged.addListener(Q));const ee="#cdcdcd",te="#f0f0f0",re=w((()=>{browser.storage.onChanged.addListener(se),se()})),oe=n(),ne=oe?null:new class{constructor(){this._style=document.createElement("style"),this.injectToBody=o((()=>this.onDomLoaded()))}async onDomLoaded(){var e;await Z,null===(e=document.head)||void 0===e||e.appendChild(this._style)}async loadRule(e){await this.injectToBody();const t=this._style.sheet;null==t||t.insertRule(e)}async unloadAll(){await this.injectToBody();const e=this._style.sheet;if(e)for(;e.cssRules.length>0;)e.deleteRule(0)}};let ae=Array();async function se(){const e=await C;if(oe){0,ae.forEach((e=>e.unregister()));const t=ie().join("\n");ae=t?[await browser.contentScripts.register({css:[{code:t}],allFrames:!0,runAt:"document_start",matches:["<all_urls>"],excludeMatches:[[...Object.keys(e.DISABLED_DOMAINS||{}).flatMap((e=>[`*://www.${e}/*`,`*://${e}/*`])),...Object.keys(e.DISABLED_URL||{}).flatMap((e=>[`*://www.${e}`,`*://${e}`]))]].find((e=>e.length>0))})]:[]}else if(ne){if(await ne.unloadAll(),e.IS_DISABLED||q)return;const t=ie();await Promise.all(t.map((e=>ne.loadRule(e))))}}function ie(){const{SCROLLBARS_WIDTH:e,SCROLLBARS_COLOR:t,SCROLLBARS_BACKGROUND:r,IS_DISABLED:o}=N;if(o)return[];const n=e||S.NORMAL,a=t||ee,s=r||te;return[n===S.THIN&&"*:not(select) {scrollbar-width: thin}",n===S.HIDDEN&&"*:not(select) {scrollbar-width: none}",(a!==ee||s!==te)&&`* {scrollbar-color: ${a} ${s}}`].filter(h)}browser.runtime.onMessage.addListener(((e,t)=>{var r;switch(e.type){case"updateIcon":return 0===t.frameId?K(null===(r=t.tab)||void 0===r?void 0:r.id,e.status):Promise.resolve();case"getZoom":!async function(e,t){if(browser.tabs.getZoom){const r=await browser.tabs.getZoom();F(e,{type:"zoom",zoom:r},{frameId:t})}}(t.tab.id,t.frameId);break;case"platformInfo":return Promise.all([browser.runtime.getPlatformInfo(),P()]).then((([{os:e},t])=>({os:e,isFission:t>=97})));case"current_tab":return B().then((({id:t})=>F(t,e.data,{frameId:e.allFrames?void 0:0})));case"forwardToParent":return F(t.tab.id,e.data,{frameId:0});case"forwardToChildren":return F(t.tab.id,e.data)}})),async function(){re()}()},576:function(e,t){var r,o=this&&this.__extends||(r=(e,t)=>(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&((e,t)=>{e.__proto__=t})||((e,t)=>{for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}),r(e,t)),function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0});var n=()=>{};t.Option=n;var a=function(e){function r(t){var r=e.call(this)||this;return r.value=t,r}return o(r,e),r.prototype.exists=function(e){return e(this.value)},r.prototype.filter=function(e){return e(this.value)?this:t.none},r.prototype.filterNot=function(e){return e(this.value)?t.none:this},r.prototype.flatMap=function(e){return e(this.value)},r.prototype.fold=function(){var e=this;return t=>t(e.value)},r.prototype.forAll=function(e){return e(this.value)},r.prototype.forComprehension=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=this,o=0;o<e.length-1;++o)r=r.flatMap(e[o]);return r.map(e[e.length-1])},r.prototype.forEach=function(e){return e(this.value)},Object.defineProperty(r.prototype,"get",{get:function(){return this.value},enumerable:!0,configurable:!0}),r.prototype.getOrElse=function(){return this.value},r.prototype.getOrElseValue=function(){return this.value},Object.defineProperty(r.prototype,"isDefined",{get:()=>!0,enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEmpty",{get:()=>!1,enumerable:!0,configurable:!0}),r.prototype.map=function(e){return i(e(this.value))},r.prototype.match=function(e){return e.some(this.value)},Object.defineProperty(r.prototype,"nonEmpty",{get:()=>!0,enumerable:!0,configurable:!0}),r.prototype.orElse=function(){return this},r.prototype.orElseValue=function(){return this},Object.defineProperty(r.prototype,"orNull",{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orUndefined",{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"toArray",{get:function(){return[this.value]},enumerable:!0,configurable:!0}),r.prototype.toString=function(){return"Some("+this.value+")"},r}(n);t.Some=a;var s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.prototype.exists=()=>!1,r.prototype.filter=function(){return this},r.prototype.filterNot=function(){return this},r.prototype.flatMap=()=>t.none,r.prototype.fold=e=>()=>e(),r.prototype.forAll=()=>!0,r.prototype.forComprehension=()=>t.none,r.prototype.forEach=()=>{},Object.defineProperty(r.prototype,"get",{get:()=>{throw new Error("No such element.")},enumerable:!0,configurable:!0}),r.prototype.getOrElse=e=>e(),r.prototype.getOrElseValue=e=>e,Object.defineProperty(r.prototype,"isDefined",{get:()=>!1,enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEmpty",{get:()=>!0,enumerable:!0,configurable:!0}),r.prototype.map=()=>t.none,r.prototype.match=e=>e.none(),Object.defineProperty(r.prototype,"nonEmpty",{get:()=>!1,enumerable:!0,configurable:!0}),r.prototype.orElse=e=>e(),r.prototype.orElseValue=e=>e,Object.defineProperty(r.prototype,"orNull",{get:()=>null,enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orUndefined",{get:()=>{},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"toArray",{get:()=>[],enumerable:!0,configurable:!0}),r.prototype.toString=()=>"None",r}(n);function i(e){return new a(e)}t.None=s,t.some=i,t.none=new s,t.option=function(e){return null==e?t.none:i(e)}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,r),a.exports}(()=>{r(715);(async()=>{})()})()})();