"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[3698],{87122:(e,t,i)=>{i.r(t),i.d(t,{CredentialEditPanel:()=>qe});var n=i(15192),a=i(24507),s=i(89078),r=i(51031),l=i(25792),o=i(39431),d=i(65455),c=i(27100),p=i(50094),u=i(18108),_=i(66424),m=i(92077),h=i(34557),g=i(30894),b=i(96832),S=i(26849),w=i(30309),k=i(8180),x=i(61468),C=i(66468),y=i(13252),f=i(46525),v=i(86342),I=i(88203),D=i(77063),Z=i(73875),L=i(63520),E=i(82994),A=i(33659),T=i(62042),U=i(99822),P=i(84885),R=i(22061),B=i(10291),q=i(98149),V=i(13134);let z=function(e){return e[e.SHARED_ACCESS=0]="SHARED_ACCESS",e[e.ACCOUNT_DETAILS=1]="ACCOUNT_DETAILS",e[e.LINKED_WEBSITES=2]="LINKED_WEBSITES",e[e.OTP_SETUP=3]="OTP_SETUP",e}({});const N={"account-details":z.ACCOUNT_DETAILS,"shared-access":z.SHARED_ACCESS,"linked-websites":z.LINKED_WEBSITES},W=(e,t)=>{var i;const n=t.find((e=>"accepted"===e.status&&e.info?.forcedDomainsEnabled));return n&&((e,t)=>{var i,n,a;let s="";var r;e.URL&&(s=null!=(r=new V.Y(e.URL).getRootDomain()?.toLowerCase())?r:"");const l=null!=(i=e.email?.toLowerCase())?i:"",o=null!=(n=e.username?.toLowerCase())?n:"",d=null!=(a=e.alternativeUsername?.toLowerCase())?a:"",c=e.linkedURLs.map((e=>e.toLowerCase()));return t.some((e=>{const t=e.toLowerCase();return s.includes(t)||l.includes(t)||o.includes(t)||d.includes(t)||c.some((e=>e.includes(t)))}))})(e,null!=(i=n.info?.teamDomains)?i:[])?n:null};var O,X=i(17534),G=i(84985),F=i(68037),M=i(68593);const H=({credential:e,onClose:t,openWithNewUrlField:i,onUpdateLinkedWebsitesAddedByUser:n,canEdit:a,dashlaneDefinedLinkedWebsites:s})=>{const{translate:r}=(0,I.Z)(),[l,o]=b.useState(e.linkedURLs),[d,c]=b.useState(i);return b.useEffect((()=>{const t=e.linkedURLs,i=!(t.length===l.length&&t.every(((e,t)=>l[t]===e)));c(i),n(l)}),[l]),(0,M.BX)("div",{"data-testid":"linked-websites-tab",children:[(0,M.tZ)(x.zx,{"data-testid":"back-button",layout:"iconLeading",mood:"neutral",intensity:"supershy",onClick:t,icon:O||(O=(0,M.tZ)(x.JO,{name:"ArrowLeftOutlined"})),children:r("webapp_credential_linked_websites_title")}),(0,M.tZ)(F.u,{title:r("webapp_credential_linked_websites_section_primary"),description:r("webapp_credential_linked_websites_section_primary_description"),additionalSx:{marginTop:"24px"},children:(0,M.tZ)(G.a,{linkedWebsitesList:[e.URL],credentialId:e.id,isEditing:!1})}),(0,M.tZ)(F.u,{title:r("webapp_credential_linked_websites_section_added_by_user"),additionalSx:{marginTop:"16px"},children:(0,M.tZ)(G.a,{linkedWebsitesList:l,credentialId:e.id,isListEditable:a,isEditing:d,showUrlProtocol:!0,updateLinkedWebsitesList:o})}),s&&s.length>1?(0,M.tZ)(F.u,{title:r("webapp_credential_linked_websites_section_added_by_dashlane"),description:r("webapp_credential_linked_websites_section_added_by_dashlane_description"),additionalSx:{marginTop:"16px"},children:(0,M.tZ)(G.a,{linkedWebsitesList:s,credentialId:e.id,isEditing:!1})}):null]})},K=b.memo(H);var j=i(14900);const Y=({onClose:e,setDisplayLinkedWebsitesDataSavedAlert:t})=>{const{translate:i}=(0,I.Z)();return(0,b.useRef)(null).current=window.setTimeout((()=>t(!1)),5e3),(0,M.tZ)(j.YcA,{children:(0,M.tZ)(j.bZj,{size:j.k3y.SMALL,severity:j.BLW.SUCCESS,closeIconName:i("_common_alert_dismiss_button"),onClose:e,children:i("_common_toast_changes_saved")})})};var J=i(17676);const $=({onCancel:e,onLeavePageWithoutSaving:t})=>{const{translate:i}=(0,I.Z)();return(0,M.tZ)(J.o,{isOpen:!0,showCloseIcon:!0,title:i("webapp_credential_linked_websites_discard_dialog_title"),onRequestClose:e,footer:(0,M.BX)(x.kC,{justifyContent:"end",gap:"8px",children:[(0,M.tZ)(j.zxk,{type:"button",nature:"secondary",onClick:e,children:i("webapp_credential_linked_websites_discard_dialog_cancel")}),(0,M.tZ)(j.zxk,{type:"button",onClick:t,children:i("webapp_credential_linked_websites_discard_dialog_discard")})]}),children:(0,M.tZ)(x.kC,{flexDirection:"column",gap:"8px",sx:{width:"576px"},children:(0,M.tZ)(j.nvN,{children:i.markup("webapp_credential_linked_websites_discard_dialog_description_markup")})})})},Q=({duplicateData:e,onCancel:t,onSave:i})=>{const{translate:n}=(0,I.Z)(),a=e.length>1,s=a?n("webapp_credential_linked_websites_duplicate_prevention_dialog_title_multiple"):n("webapp_credential_linked_websites_duplicate_prevention_dialog_title_one",{url:e[0].linkedWebsite}),r=a?n("webapp_credential_linked_websites_duplicate_prevention_dialog_description_multiple"):n("webapp_credential_linked_websites_duplicate_prevention_dialog_description_one",{credentialName:e[0].credentialName}),l=n(a?"webapp_credential_linked_websites_duplicate_prevention_dialog_add_websites_multiple":"webapp_credential_linked_websites_duplicate_prevention_dialog_add_websites_one");return(0,M.tZ)(J.o,{isOpen:!0,showCloseIcon:!0,title:s,onRequestClose:t,footer:(0,M.BX)(x.kC,{justifyContent:"end",gap:"8px",children:[(0,M.tZ)(j.zxk,{type:"button",nature:"secondary",onClick:t,children:n("webapp_credential_linked_websites_duplicate_prevention_dialog_cancel")}),(0,M.tZ)(j.zxk,{type:"button",onClick:i,children:l})]}),children:(0,M.BX)("div",{children:[(0,M.tZ)("p",{children:r}),a?(0,M.tZ)("ul",{className:"duplicatesList--SwGmL5ftwe",children:e.map((e=>(0,M.tZ)("li",{className:"duplicateItem--mPX5urdfL2",children:e.linkedWebsite},e.linkedWebsite)))}):null]})})};var ee=i(5465);const te="webapp_password_history_detailed_password_view_button",ie=({credentialId:e})=>{const{translate:t}=(0,I.Z)(),{routes:i}=(0,m.Xo)(),n=i.userPasswordHistoryFilteredByCredential(e),[a,s]=(0,b.useState)(!1);return(0,b.useEffect)((()=>{ee.C.getHasPasswordHistory(e).then((e=>{e&&s(!0)}))}),[e]),a?(0,M.tZ)("div",{children:(0,M.tZ)(m.rU,{to:n,tabIndex:-1,children:(0,M.tZ)(x.zx,{mood:"neutral",intensity:"supershy",title:t(te),icon:"HistoryBackupOutlined",layout:"iconLeading",children:t(te)})})}):null};var ne=i(72133),ae=i(24058),se=i(70923),re=i(25337),le=i(39632);const oe={exit:"exit--p4spwlkedE",exitActive:"exitActive--BIpaDF7MkX",exitDone:"exitDone--KzowOK4h4K",appear:"appear--OcvlWdq5He",appearActive:"appearActive--HVwCcEJzKz",appearDone:"appearDone--KgBJPzbyTA"},de=({onPrimaryClick:e})=>{const{translate:t}=(0,I.Z)(),[i,n]=b.useState(!1);return(0,M.tZ)(le.Z,{appear:!0,in:!i,timeout:600,classNames:oe,onExited:e,children:(0,M.tZ)("div",{sx:{backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,M.tZ)(x.ke,{title:t("webapp_credential_edition_health_box_excluded_title"),description:t("webapp_credential_edition_health_box_excluded_description"),mood:"warning",size:"large",actions:[(0,M.tZ)(x.zx,{mood:"brand",intensity:"quiet",onClick:e=>{e.preventDefault(),n(!0)},size:"small",type:"button",children:t("webapp_credential_edition_health_box_include")},"primaryAction")]})})})},ce=b.memo(de);var pe=i(20987),ue=i(65580);const _e={appear:"appear--MMCjEcRU3u",appearActive:"appearActive--LG103cUrNZ",appearDone:"appearDone--tuYaN3WTGO"},me=({onPrimaryClick:e,onSecondaryClick:t,canEdit:i,corruptionData:n})=>{const{translate:a}=(0,I.Z)();if(!n)return null;const s=((e,t)=>{const{riskType:i}=e;switch(i){case pe.gI.Compromised:return{title:t("webapp_credential_edition_health_box_compromised_title"),description:t("webapp_credential_edition_health_box_compromised_description"),secondary:t("webapp_credential_edition_health_box_view_compromised")};case pe.gI.Reused:return{title:t("webapp_credential_edition_health_box_reused_title"),description:t.markup("webapp_credential_edition_health_box_reused_description_markup",{count:e.reuseCount}),secondary:t("webapp_credential_edition_health_box_view_reused")};case pe.gI.Weak:return{title:t("webapp_credential_edition_health_box_weak_title"),description:t("webapp_credential_edition_health_box_weak_description"),secondary:t("webapp_credential_edition_health_box_view_weak")};default:return(0,ue.U)(i)}})(n,a),r=n.severity===pe.bp.STRONG?"warning":"brand";return(0,M.tZ)(le.Z,{in:!0,appear:!0,timeout:600,classNames:_e,children:(0,M.tZ)("div",{sx:{position:"relative",backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,M.tZ)(x.ke,{title:s.title,description:s.description,mood:r,size:"large",actions:[(0,M.tZ)(x.zx,{onClick:t,intensity:"quiet",size:"small",children:s.secondary},"view_health"),(0,M.tZ)(j.ua7,{passThrough:i,content:a("webapp_credential_edition_health_box_change_limited"),placement:"left",sx:{maxWidth:"312px",fontSize:2},children:(0,M.tZ)(x.zx,{size:"small",onClick:e,disabled:!i,children:a("webapp_credential_edition_health_box_change_password")})},"change_password")]})})})},he=b.memo(me),ge=JSON.parse('{"v":"5.7.0","fr":30,"ip":0,"op":26,"w":240,"h":240,"nm":"Loading Light Theme","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":3,"nm":"Null 4","sr":1,"ks":{"o":{"a":0,"k":0,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[120,122,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":150,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"load","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[0,151,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[250,250,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[88,88],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.05490196078,0.2078431373,0.2392156863,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":6,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0.5,-60.5],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.167],"y":[0.167]},"t":0,"s":[10]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.333],"y":[0]},"t":12.5,"s":[42]},{"t":25,"s":[10]}],"ix":2},"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.2],"y":[0]},"t":0,"s":[-19]},{"t":25,"s":[341]}],"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false}],"ip":0,"op":106.197876042479,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"load 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[0,151,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[250,250,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[88,88],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.9058823529,0.9215686275,0.9254901961,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":6,"ix":5},"lc":2,"lj":1,"ml":4,"bm":0,"nm":".","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0.5,-60.5],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":106.197876042479,"st":0,"bm":0}],"markers":[]}'),be=({credentialId:e,canEdit:t})=>{const i=(0,m.k6)(),{routes:n}=(0,m.Xo)(),{updateIsCredentialExcluded:s}=(0,ae.$)(),{healthData:r}=(e=>{const{data:t}=(0,a.k)(se.d,"credentialHealthData",{credentialId:e});return{healthData:t}})(e),[l,o]=(0,b.useState)(null);return null===r?null:r?(0,M.BX)("div",{sx:{position:"relative"},children:[l?(0,M.tZ)(re.R,{credentialId:l,dismissCallback:()=>o(null)}):null,r.excluded?(0,M.tZ)(ce,{onPrimaryClick:()=>{s(e,!1)}}):(0,M.tZ)(he,{onPrimaryClick:t=>{t.preventDefault(),o(e)},onSecondaryClick:e=>{e.preventDefault(),i.push(n.userPasswordHealth)},canEdit:t,corruptionData:r.corruptionData})]}):(0,M.tZ)("div",{sx:{marginBottom:"24px"},children:(0,M.tZ)("div",{sx:{display:"flex",justifyContent:"center"},children:(0,M.tZ)(ne.Z,{height:24,width:24,animationParams:{renderer:"svg",loop:!0,autoplay:!0,animationData:ge}})})})};var Se=i(26555),we=i(79808);const{SHARED_ACCESS:ke,ACCOUNT_DETAILS:xe}=z,Ce=({credential:e,displayTabs:t,changeTab:i,currentTab:n})=>{const{translate:a}=(0,I.Z)(),{data:s,status:l}=(0,we.r)(e.id),o=l===r.rq.Success?s?.count:0,d={[xe]:0,[ke]:1},c=[{id:"tab-credential-detail",contentId:"content-credential-detail",title:a("webapp_credential_edition_account_details"),onSelect:()=>i(xe)},{id:"tab-credential-shared-access",contentId:"content-credential-shared-access",title:`${a("webapp_credential_edition_shared_access")} (${o})`,onSelect:()=>i(ke)}];return(0,M.tZ)(L.V9,{icon:(0,M.tZ)(Se.h,{size:"xlarge",domainURL:new V.Y(e.URL).getRootDomain()}),title:e.itemName,tabIndex:void 0!==n?d[n]:void 0,tabs:t?Object.values(c):void 0})};var ye=i(45636),fe=i(46478),ve=i(97855);const Ie=({rank:e,content:t,title:i})=>(0,M.BX)(j.T5p,{as:"li",gap:"16px",gridTemplateColumns:"35px 1fr",alignItems:"center",justifyContent:"flex-start",sx:{width:"100%",padding:"6px 0"},children:[(0,M.tZ)(j.dDn,{alignSelf:"flex-start",children:(0,M.tZ)(ve.m,{rank:e})}),(0,M.BX)(j.dDn,{children:[(0,M.tZ)(x.nv,{sx:{a:{color:"ds.text.brand.standard"},"a:hover":{color:"ds.text.brand.standard",textDecoration:"underline"}},color:"ds.text.neutral.catchy",textStyle:"ds.title.block.medium",children:i}),t?(0,M.tZ)(x.nv,{color:"ds.text.neutral.quiet",textStyle:"ds.body.standard.regular",children:t}):null]})]});var De;const Ze=({credentialId:e,title:t,url:i,setHasDataBeenModified:n,onClose:a,onSubmit:s})=>{const{translate:l}=(0,I.Z)(),[o,d]=(0,b.useState)(""),c=(0,ye.v6)(o),{setupOtpCode:p}=(()=>{const{setupOtpCodeForCredential:e}=(0,k.u)(fe.i);return{setupOtpCode:async(t,i)=>{try{return await e({credentialId:t,otpUrl:i}),!0}catch{return!1}}}})(),{showToast:u}=(0,x.pm)(),_=!!o&&c.status===r.rq.Error,m=c.status!==r.rq.Success;return(0,M.BX)("div",{"data-testid":"linked-websites-tab",children:[(0,M.tZ)(x.zx,{"data-testid":"back-button",layout:"iconLeading",mood:"neutral",intensity:"supershy",size:"large",onClick:a,icon:De||(De=(0,M.tZ)(x.JO,{name:"ArrowLeftOutlined"})),children:(0,M.tZ)(x.nv,{textStyle:"ds.title.section.medium",color:"ds.text.neutral.catchy",children:l("webapp_credential_otp_setup_sublevel_header")})}),(0,M.BX)(F.u,{additionalSx:{marginTop:"16px"},children:[(0,M.BX)(x.kC,{as:"ol",gap:"16px",children:[(0,M.tZ)(x.X6,{as:"h3",textStyle:"ds.title.supporting.small",color:"ds.text.neutral.quiet",children:l("webapp_credential_otp_setup_title")}),(0,M.tZ)(Ie,{rank:1,content:l("webapp_credential_otp_setup_step1_description"),title:l.markup("webapp_credential_otp_setup_step1_title_markup",{title:t,url:i},{linkTarget:"_blank"})},"2fa-settings"),(0,M.tZ)(Ie,{rank:2,content:l("webapp_credential_otp_setup_step2_description"),title:l("webapp_credential_otp_setup_step2_title")},"2fa-turn-on"),(0,M.tZ)(Ie,{rank:3,content:l("webapp_credential_otp_setup_step3_description"),title:l("webapp_credential_otp_setup_step3_title")},"enter-setup-code")]}),(0,M.BX)(x.kC,{sx:{mt:"16px",backgroundColor:"ds.container.agnostic.neutral.quiet",padding:"16px",borderRadius:"8px"},gap:"8px",flexDirection:"column",children:[(0,M.tZ)(x.Kx,{error:_,feedback:_?l("webapp_credential_otp_setup_incorrect_setup_code_error"):"",label:l("webapp_credential_otp_setup_code_label"),onChange:e=>{e.preventDefault(),e.stopPropagation(),n(!0),d(e.target.value)}}),(0,M.tZ)(x.zx,{fullsize:!0,onClick:async()=>{c.status===r.rq.Success&&(await p(e,c.data.url)?(s(),u({description:l("webapp_credential_otp_code_success_toast")})):u({mood:"danger",description:l("_common_generic_error")}))},disabled:m,tooltip:l("webapp_credential_otp_setup_submit_button_disabled_tooltip"),children:l("webapp_credential_otp_setup_submit_button")})]})]}),(0,M.tZ)(x.ke,{sx:{mt:"16px"},title:l("webapp_credential_otp_code_cant_find_code_title"),description:l("webapp_credential_otp_code_cant_find_code_description")})]})},Le=()=>{const{translate:e}=(0,I.Z)();return(0,M.tZ)("div",{sx:{position:"relative",backgroundColor:"ds.background.default",marginBottom:"24px"},children:(0,M.tZ)(x.ke,{title:e("webapp_credential_edition_frozen_limited_rights_title"),description:e("webapp_credential_edition_frozen_limited_rights_description"),mood:"warning",size:"medium"})})};var Ee;const{SHARED_ACCESS:Ae,ACCOUNT_DETAILS:Te,LINKED_WEBSITES:Ue,OTP_SETUP:Pe}=z,Re=({location:e,activeSpaces:t,credential:i,credentialPreferences:n,onClose:a,protectedItemsUnlockerShown:s,dashlaneDefinedLinkedWebsites:r,areProtectedItemsUnlocked:d,openProtectedItemsUnlocker:u,isShared:_,sharingCapabilities:h,isSharedViaUserGroup:g,isItemInCollection:V,isLastAdmin:z})=>{const{translate:O}=(0,I.Z)(),{routes:G}=(0,m.Xo)(),{showToast:F}=(0,x.pm)(),H=(0,b.useRef)(!1),j=(()=>{const{updateLinkedWebsites:e}=(0,k.u)(c.G);return async(t,i)=>{e({credentialId:t,updatedLinkedWebsitesList:i})}})(),{updateVaultItem:J}=(0,k.u)(l.L),{createCollection:ee,updateCollection:te}=(0,k.u)(f.v),{addItemsToCollections:ne,removeItemFromCollections:ae}=(0,k.u)(C.a),{updateCredentialPreferences:se}=(0,k.u)(p.I),{shouldShowFrozenStateDialog:re}=(0,D.Ub)(),le=(0,Z.l)(),oe=(0,b.createRef)(),de=()=>{var e,t,a;return{alternativeUsername:null!=(e=i.alternativeUsername)?e:"",email:i.email,itemName:i.itemName,linkedURLs:i.linkedURLs,note:i.note,otpURL:null!=(t=i.otpURL)?t:"",otpSecret:null!=(a=i.otpSecret)?a:"",password:i.password,spaceId:i.spaceId,URL:i.URL,username:i.username,onlyAutofillExactDomain:n.onlyAutofillExactDomain,requireMasterPassword:n.requireMasterPassword,useAutoLogin:n.useAutoLogin}},[ce,pe]=(0,b.useState)(de()),[ue,_e]=(0,b.useState)((()=>{var e;const t=(0,m.CN)();return N[null!=(e=t.get("tab"))?e:"account-details"]})()),[me,he]=(0,b.useState)(Te),[ge,Se]=(0,b.useState)(!1),[we,ke]=(0,b.useState)(!1),[xe,ye]=(0,b.useState)(i.linkedURLs),[fe,ve]=(0,b.useState)(!1),[Ie,De]=(0,b.useState)(!1),[Re,Be]=(0,b.useState)([]),[qe,Ve]=(0,b.useState)(!1),[ze,Ne]=(0,b.useState)(!1),[We,Oe]=(0,b.useState)(!1),[Xe,Ge]=(0,b.useState)(!1),[Fe,Me]=(0,b.useState)(!1),[He,Ke]=(0,b.useState)(!1),{current:je}=(0,b.useRef)({confirmDeleteConfirm:O("webapp_credential_edition_delete_confirm"),confirmDeleteDismiss:O("webapp_credential_edition_delete_dismiss"),confirmDeleteSubtitle:O("webapp_credential_edition_confirm_delete_subtitle"),confirmDeleteTitle:O("webapp_credential_edition_confirm_delete_title"),lastAdminActionLabel:O("webapp_credential_edition_change_permissions"),lastAdminTitle:O("webapp_credential_edition_last_admin_title"),lastAdminSubtitle:O("webapp_credential_edition_last_admin_subtitle"),groupSharingTitle:O("webapp_credential_edition_group_sharing_title"),groupSharingSubtitle:O("webapp_credential_edition_group_sharing_subtitle"),collectionSharingTitle:O("webapp_credential_edition_collection_sharing_title"),collectionSharingSubtitle:O("webapp_credential_edition_collection_sharing_subtitle")});if((0,b.useEffect)((()=>{(0,X.SJ)(xe,i.linkedURLs)&&Se(!0)}),[xe,i.linkedURLs]),(0,b.useEffect)((()=>{ue===Te&&pe(de())}),[ue]),(0,b.useEffect)((()=>{const{onlyAutofillExactDomain:e,requireMasterPassword:t,useAutoLogin:i,...n}=ce,{onlyAutofillExactDomain:a,requireMasterPassword:s,useAutoLogin:r,...l}=de(),o=!(0,S.equals)(ce,de());Se(o),Ke(!(0,S.equals)(n,l))}),[ce]),null===re||null===le)return null;const Ye={id:i.id,forceCategorizedSpace:W(i,t),isDiscontinuedUser:re,canCopy:h.canCopy,canEdit:h.canEdit,canView:h.canView,linkedURLs:i.linkedURLs},Je=e=>{ge?(he(e),Ne(!0)):_e(e)},$e=()=>{Ne(!1),Ve(!1),Be([])},Qe=()=>{_e(Te),Se(!1),$e()},et=e=>{e?.preventDefault(),ge?(he(Te),Ve(!0)):Qe()},tt=()=>{j(i.id,xe),Oe(!0),(0,X.Bq)(i,xe),Qe()},it=e=>!e.initiallyExisting&&!e.hasBeenDeleted,nt=e=>e.initiallyExisting&&!e.hasBeenDeleted,at=()=>{H.current||(H.current=!0,e?.state?.entity?(({routes:e,location:t})=>{t?.state?.entity?(0,P.y)(t?.state?.entity)?(0,m.uX)(e.userSharingGroupInfo(t?.state?.entity?.groupId)):(0,m.uX)(e.userSharingUserInfo(t?.state?.entity?.alias)):(0,m.uX)(e.userSharingCenter)})({routes:G,location:e}):a())},st=()=>{if(we)return he(Te),void Ne(!0);_e(Te)},rt=Ie||s,lt=le&&!Ye.canView;return(0,M.BX)(L.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:ge,isSomeDialogOpen:qe||Re.length>0||ze||Fe||Ie,onSubmit:async()=>{if(ue===Ue)return void(async()=>{const e=await(0,X.wb)(i,xe);Be(e),ue!==Ue||e.length||tt()})();if(!oe.current?.isFormValid())return;const e=oe.current?.getVaultItemCollections();if(!ge||e){var t;Ge(!0),n&&ce.requireMasterPassword&&ce.requireMasterPassword!==n.requireMasterPassword&&(0,B.ih)(ce.requireMasterPassword,i.id,i.URL,null!=(t=ce.spaceId)?t:void 0);try{const{onlyAutofillExactDomain:t,useAutoLogin:a,requireMasterPassword:s,...r}=ce,l=t!==n.onlyAutofillExactDomain||a!==n.useAutoLogin||s!==n.requireMasterPassword;He&&await J({vaultItemType:o.U.Credential,content:r,id:i.id,shouldSkipSync:!!l}),l&&await se({credentialId:i.id,credentialUrl:i.URL,onlyAutofillExactDomain:t,useAutoLogin:a,requireMasterPassword:s,shouldSkipSync:e?.some((e=>e.isShared&&!nt(e)))}),e&&await(async(e,t,i)=>{const n=[],a=[];for(const r of t){var s;nt(r)||(r.isShared?it(r)?n.push({collectionId:r.id,permission:null!=(s=r.itemPermission)?s:y.y3.Limited}):a.push(r.id):(r.vaultItems=[{id:e,type:w.dJ.KWAuthentifiant,url:i}],r.id?await te({id:r.id,collection:r,operationType:r.hasBeenDeleted?v.C.SUBSTRACT_VAULT_ITEMS:v.C.APPEND_VAULT_ITEMS}):await ee({content:r})))}n.length&&await ne({collectionPermissions:n,itemIds:[e],shouldSkipSync:a.length>0}),a.length&&await ae({collectionIds:a,itemId:e})})(i.id,e,i.URL)}catch(e){return F({description:O("_common_generic_error"),mood:"danger"}),void a()}F({description:O("_common_toast_changes_saved")}),a()}},secondaryActions:ue===Ue?[]:[(0,M.tZ)(ie,{credentialId:i.id},"pwhist"),(0,M.tZ)(T._,{id:i.id,isShared:_,canShare:h.canShare,isDiscontinuedUser:re,getSharing:U.Ei},"shareaction")],onNavigateOut:(e,t)=>{ue!==Ue?ue!==Pe?at():st():et(t)},onClickDelete:()=>De(!0),withoutDeleteButton:ue===Ue,withoutConfirmationDialog:ue===Ue,withoutCloseButton:ue===Pe,ignoreCloseOnEscape:rt,formId:"edit_credential_panel",submitPending:Xe,header:(0,M.tZ)(Ce,{credential:i,displayTabs:_,changeTab:Je,currentTab:ue}),children:[_&&ue===Ae?(0,M.tZ)("div",{"aria-labelledby":"tab-credential-shared-access",id:"content-credential-shared-access",children:(0,M.tZ)(R.u,{canChangeRoles:h.canChangeRoles,id:i.id})}):null,ue===Te?(0,M.BX)("div",{sx:{flex:1,flexDirection:"column",position:"relative"},"aria-labelledby":"tab-credential-detail",id:"content-credential-detail",children:[lt?Ee||(Ee=(0,M.tZ)(Le,{})):(0,M.tZ)(be,{credentialId:i.id,canEdit:h.canEdit}),(0,M.tZ)("div",{sx:{overflowY:"initial",overflowX:"visible"},children:(0,M.tZ)(q.S,{ref:oe,activeSpaces:t,editableValues:ce,setEditableValues:pe,readonlyValues:Ye,signalEditedValues:e=>{Se(e)},dashlaneDefinedLinkedWebsites:r,areProtectedItemsUnlocked:d,openProtectedItemsUnlocker:u,protectedItemsUnlockerShown:s,onClickAddNewWebsite:()=>(ve(!0),void Je(Ue)),onClickSetup2FAToken:()=>{Je(Pe)},setHasOpenedDialogs:Me})})]}):null,ue===Ue?(0,M.tZ)(K,{credential:i,dashlaneDefinedLinkedWebsites:r,onClose:et,openWithNewUrlField:fe,onUpdateLinkedWebsitesAddedByUser:ye,canEdit:h.canEdit}):null,ue===Pe?(0,M.tZ)(Ze,{credentialId:i.id,title:i.itemName,url:i.URL,onClose:st,onSubmit:()=>{ke(!1),_e(Te)},setHasDataBeenModified:ke}):null,(0,M.tZ)(E.s,{isVisible:Ie,itemId:i.id,closeConfirmDeleteDialog:()=>De(!1),goToSharingAccess:()=>{Je(Ae)},onDeletionSuccess:at,isShared:_,isSharedViaUserGroup:g,translations:je,vaultItemType:o.U.Credential,isLastAdmin:z,isItemInCollection:V}),qe?(0,M.tZ)($,{onCancel:()=>Ve(!1),onLeavePageWithoutSaving:Qe}):null,Re.length>0?(0,M.tZ)(Q,{duplicateData:Re,onCancel:()=>Be([]),onSave:tt}):null,ze?(0,M.tZ)(A.a,{onDismissClick:()=>Ne(!1),onConfirmClick:()=>{_e(me),Se(!1),ke(!1),$e()}}):null,We?(0,M.tZ)(Y,{onClose:()=>Oe(!1),setDisplayLinkedWebsitesDataSavedAlert:Oe}):null]})},Be=e=>{const{credential:t}=e,i=(0,u.E)(),n=(0,g.tY)(),l=(0,_.B)([t.id]),o=(0,a.k)(c.G,"getDashlaneDefinedLinkedWebsites",{url:t.URL}),m=(0,a.k)(p.I,"getPreferencesForCredentials",{credentialIds:[t.id]}),{getPermissionForItem:h,getSharingStatusForItem:b,getIsLastAdminForItem:S}=(0,s.Y)(d.X,{getPermissionForItem:{queryParam:{itemId:t.id}},getSharingStatusForItem:{queryParam:{itemId:t.id}},getIsLastAdminForItem:{queryParam:{itemId:t.id}}},[]);if(m.status!==r.rq.Success||o.status!==r.rq.Success||h.status!==r.rq.Success||b.status!==r.rq.Success||i.status!==r.rq.Success||S.status!==r.rq.Success)return null;const{isShared:w,isSharedViaUserGroup:k}=b.data,{isLastAdmin:x}=S.data,C=!!l.length;return(0,M.tZ)(Re,{...e,...n,activeSpaces:i.data,dashlaneDefinedLinkedWebsites:o.data,credentialPreferences:m.data[0],isShared:w,sharingCapabilities:h.data.capabilities,isSharedViaUserGroup:k,isItemInCollection:C,isLastAdmin:x})},qe=e=>{const{data:t,status:i}=(0,a.k)(l.L,"query",{vaultItemTypes:[o.U.Credential],ids:[`{${e.match.params.uuid}}`]}),{routes:s}=(0,m.Xo)();return i===r.rq.Loading?null:t?.credentialsResult.items.length?(0,M.tZ)(Be,{...e,credential:t.credentialsResult.items[0]}):e.location?.state?(0,M.tZ)(n.l_,{to:(0,h.rF)(e.location?.state,s)}):(0,M.tZ)(n.l_,{to:s.userCredentials})}},82994:(e,t,i)=>{i.d(t,{s:()=>m}),i(96832);var n=i(61468),a=i(8180),s=i(51031),r=i(25792),l=i(88203);let o=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var d=i(65580),c=i(68593);const p=({reason:e,translations:t,goToSharingAccess:i,closeCantDeleteDialog:a})=>{const{translate:s}=(0,l.Z)(),r=((e,t)=>{const{groupSharingTitle:i,lastAdminTitle:n,collectionSharingTitle:a,genericErrorTitle:s}=e;switch(t){case o.LastAdmin:return n;case o.GroupSharing:return i;case o.CollectionSharing:return a;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e),p=((e,t)=>{const{groupSharingSubtitle:i,lastAdminSubtitle:n,collectionSharingSubtitle:a,genericErrorSubtitle:s}=e;switch(t){case o.LastAdmin:return n;case o.GroupSharing:return i;case o.CollectionSharing:return a;case o.Generic:return s;default:return(0,d.U)(t)}})(t,e);return(0,c.tZ)(n.Vq,{isOpen:!0,onClose:a,title:null!=r?r:"",closeActionLabel:s("_common_dialog_dismiss_button"),actions:e===o.LastAdmin||o.GroupSharing||o.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{i(),a()}}}:void 0,children:p})};var u=i(37527);const _=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:i})=>{const{translate:a}=(0,l.Z)(),{confirmDeleteSubtitle:s,confirmDeleteTitle:r,confirmDeleteDismiss:o,confirmDeleteConfirm:d}=i;return(0,c.tZ)(n.Vq,{title:r,onClose:e,isOpen:!0,dialogClassName:u.Ht,closeActionLabel:a("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:d,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:o,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:s})},m=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:i,itemId:d,onDeletionSuccess:u,sharingStatus:m,translations:h,vaultItemType:g,isShared:b,isSharedViaUserGroup:S,isItemInCollection:w,isLastAdmin:k})=>{const{showToast:x}=(0,n.pm)(),{translate:C}=(0,l.Z)(),{deleteVaultItem:y}=(0,a.u)(r.L);if(!i)return null;let f;return(b||m?.isShared)&&(S&&(f=o.GroupSharing),k&&(f=o.LastAdmin),w&&(f=o.CollectionSharing)),f&&t?(0,c.tZ)(p,{reason:f,translations:h,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,c.tZ)(_,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await y({id:d,vaultItemType:g})).tag===s.rq.Success?(x({description:null!=(e=h.deleteSuccessToast)?e:C("webapp_personal_info_edition_delete_success_toast")}),u()):x({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){x({description:C("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:h})}},62042:(e,t,i)=>{i.d(t,{_:()=>o});var n=i(48062),a=i(88203),s=i(1639),r=i(68593);const l=({sharing:e})=>{const{translate:t}=(0,a.Z)();return(0,r.tZ)(s.Z,{tooltipPlacement:"top-start",sharing:e,text:t("webapp_sharing_invite_share"),origin:n.Origin.ItemDetailView})},o=({id:e,isShared:t,canShare:i,isDiscontinuedUser:n,getSharing:a})=>t&&!i||n?null:(0,r.tZ)(l,{sharing:a(e)})},79808:(e,t,i)=>{i.d(t,{r:()=>s});var n=i(24507),a=i(65455);const s=e=>(0,n.k)(a.X,"sharedAccessForItem",{itemId:e})},22061:(e,t,i)=>{i.d(t,{u:()=>L});var n,a,s=i(96832),r=i(14900),l=i(8180),o=i(51031),d=i(66468),c=i(65455),p=i(13252),u=i(78346),_=i(88203),m=i(43194),h=i(61832),g=i(61468),b=i(32814),S=i(4967),w=i(73670),k=i(89572),x=i(58037),C=i(68593);const y=({cancelStatus:e,vaultItemId:t,setCancelStatus:i,recipientId:d})=>{const{translate:u}=(0,_.Z)(),m=e===h.V.Loading,b={type:p.IP.User,alias:d},{revokeSharedItem:S}=(0,l.u)(c.X);(0,s.useEffect)((()=>{let t;return e===h.V.Failure&&(t=window.setTimeout((()=>i(null)),2e3)),()=>{clearTimeout(t)}}),[e,i]);const w=e?()=>i(null):()=>i(h.V.Confirm);return e===h.V.Failure?(0,C.BX)("div",{sx:{color:"ds.text.danger.standard",display:"flex",alignItems:"center"},children:[n||(n=(0,C.tZ)(r.aNP,{color:"ds.text.danger.standard"}))," ",u("webapp_shared_access_cancel_failure")]}):(0,C.BX)("div",{children:[(0,C.tZ)(g.zx,{intensity:e?"quiet":"supershy",disabled:m,onClick:w,size:"small",children:u(e?"webapp_shared_access_cancel":"webapp_shared_access_cancel_invitation")}),e?(0,C.tZ)(g.zx,{mood:"danger",intensity:"catchy",sx:{ml:"16px"},disabled:m,size:"small",onClick:()=>(async()=>{i(h.V.Loading);const e=await(async()=>{try{return(await S({vaultItemId:t,recipient:b})).tag===o.rq.Success}catch(e){return!1}})();i(e?h.V.Success:h.V.Failure)})(),children:m?a||(a=(0,C.tZ)(r.HoD,{})):u("webapp_shared_access_confirm")}):null]})};var f;const v=({vaultItemId:e,onUserSelected:t,openEditPermissionsDialog:i,member:n,canChangeRoles:a})=>{const[r,l]=(0,s.useState)(null),o=(0,x.j)()?.login,{translate:d}=(0,_.Z)();if(r===h.V.Success)return null;const{permission:c,status:u,recipientType:m}=n,v=o===n.recipientId,I=a&&o!==n.recipientId,D="pending"===u?(0,C.tZ)(y,{recipientId:n.recipientId,vaultItemId:e,cancelStatus:r,setCancelStatus:l}):(0,C.tZ)(w.M,{disabled:!a,icon:"ActionEditOutlined",layout:"iconLeading",intensity:"supershy",onClick:()=>{t&&t(n.recipientId),i(n,c,m)},content:d("webapp_sharing_collection_access_description_tooltip"),tooltipSx:{textWrap:"wrap",maxWidth:"240px"},size:"small",children:d("webapp_shared_access_edit_permissions")});return(0,C.tZ)("li",{sx:{alignItems:"center",display:"flex",minHeight:"48px",position:"relative"},children:(0,C.tZ)(S.r,{infoAction:I?D:null,logo:n.recipientType===p.IP.Group?f||(f=(0,C.tZ)(k.Z,{})):(0,C.tZ)(b.q,{email:n.recipientName,size:36}),title:n.recipientName,permissionBadge:(0,C.tZ)(g.Ct,{mood:"admin"===c?"brand":"danger",label:d("admin"===c?"webapp_sharing_permissions_full_rights":"webapp_sharing_permissions_limited_rights")}),disabled:r===h.V.Loading,titleLogo:v?(0,C.tZ)(g.Ct,{label:d("webapp_shared_access_you_badge").toUpperCase(),layout:"labelOnly",sx:{marginLeft:"4px"}}):null})},n.recipientId)};var I=i(79808),D=i(68037),Z=i(14341);const L=({id:e,canChangeRoles:t})=>{const{translate:i}=(0,_.Z)(),[n,a]=(0,s.useState)(!1),[g,b]=(0,s.useState)(null),[S,w]=(0,s.useState)(void 0),{data:k,status:x}=(0,I.r)(e),{updatePermissionForCollectionItem:y,removeItemFromCollections:f}=(0,l.u)(d.a),{revokeSharedItem:L,updateSharedItemPermission:E}=(0,l.u)(c.X);if(x!==o.rq.Success)return(0,C.tZ)(r.HoD,{color:"ds.container.expressive.brand.catchy.idle",size:50,sx:{alignSelf:"center",m:"20px"}});if(!k)return null;const{users:A,groups:T,collections:U}=k,P=e=>{g&&b({...g,step:e})},R=async()=>{if(!g)return;const{recipient:t,permission:i,recipientType:n}=g;a(!0);const s="revoke"===i?await(async(t,i)=>{try{if(i===p.IP.Collection){const i=await f({collectionIds:[t.recipientId],itemId:e});return!!(0,u.d6)(i)}return(await L({vaultItemId:e,recipient:(0,Z.d)(t)})).tag===o.rq.Success}catch(e){return!1}})(t,n):await(async(t,i,n)=>{try{if(n===p.IP.Collection){const n=await y({itemId:e,collection:{collectionId:t.recipientId,permission:i}});return!!(0,u.d6)(n)}return(await E({vaultItemId:e,recipient:(0,Z.d)(t),permission:i})).tag===o.rq.Success}catch(e){return!1}})(t,i,n);if(s){const e="revoke"===i?h.PermissionDialogStep.RevokeSuccess:h.PermissionDialogStep.Success;P(e)}else P(h.PermissionDialogStep.Failure);a(!1)},B=(e,t,i)=>{const n={recipient:e,recipientType:i,permission:t,originPermission:t,step:h.PermissionDialogStep.Permission,name:e.recipientName};b(n)},q=T?.length>0,V=U?.length>0,z=A?.length>0,N=!(S&&A.find((e=>e.recipientId!==S&&e.permission===p.y3.Admin)))&&g?.recipient.recipientType===p.IP.User,W="collection"===g?.recipientType;return(0,C.BX)("div",{sx:{flex:"1",overflowY:"auto"},children:[(0,C.BX)("ul",{sx:{flex:"1"},children:[V?(0,C.tZ)(D.u,{title:i("webapp_shared_access_collections"),additionalSx:{marginBottom:"16px"},children:U.map((i=>(0,C.tZ)(v,{canChangeRoles:t,member:i,vaultItemId:e,openEditPermissionsDialog:B},i.recipientId)))}):null,q?(0,C.tZ)(D.u,{title:i("webapp_shared_access_groups_card_title"),additionalSx:{marginBottom:"16px"},children:T.map((i=>(0,C.tZ)(v,{canChangeRoles:t,member:i,vaultItemId:e,openEditPermissionsDialog:B},i.recipientId)))}):null,z?(0,C.tZ)(D.u,{title:i("webapp_shared_access_individuals_card_title"),children:A.map((i=>(0,C.tZ)(v,{canChangeRoles:t,member:i,onUserSelected:e=>w(e),vaultItemId:e,openEditPermissionsDialog:B},i.recipientId)))}):null]}),g&&(0,C.tZ)(m.E,{isOpen:!0,isCollectionItemPermission:W,shouldRevokeBeDisabled:N||void 0,loading:n,onCancelRevoke:()=>{g&&b({...g,step:h.PermissionDialogStep.Permission})},onConfirmRevoke:R,onDismiss:()=>b(null),onSelectPermission:e=>{g&&b({...g,permission:e})},onValidatePermission:()=>{"revoke"===g?.permission?b({...g,step:h.PermissionDialogStep.ConfirmRevoke}):R()},permission:g.permission,recipient:g.recipient,step:g.step})]})}}}]);