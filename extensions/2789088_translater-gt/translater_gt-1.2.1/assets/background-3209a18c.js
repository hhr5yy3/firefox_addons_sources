import"./modulepreload-polyfill-3cfb730f.js";import{g as r,a as c}from"./googleApi-7348b833.js";import{o as s,t as i}from"./browserApi-b02d1f59.js";const a=async(e,t)=>{try{await chrome.tabs.sendMessage(e,t)}catch{}};chrome.runtime.onInstalled.addListener(()=>{chrome.contextMenus.create({id:"translaterMenu",title:chrome.i18n.getMessage("context_menus_title"),contexts:["selection"]})});chrome.contextMenus.onClicked.addListener((e,t)=>{e.menuItemId==="translaterMenu"&&e.selectionText&&a(t.id,{action:"createPopup",content:e.selectionText})});const l=async()=>{const e={active:!0,lastFocusedWindow:!0,url:["*://*/*"]};let[t]=await chrome.tabs.query(e);return t},u=async e=>{const t=()=>window.getSelection().toString();try{return(await chrome.scripting.executeScript({target:{tabId:e},func:t}))[0].result}catch{return null}},o=async()=>{const e=await l();if(e){const t=await u(e.id);t!==null&&a(e.id,{action:"createPopup",content:t})}},d=e=>{i(e)},p=(e,t,n)=>{switch(e.type){case"getTranslate":c(e.content).then(n);break;case"getTranslateTTS":r(e.content).then(n);break;case"openOptionsPage":s();break;case"openURL":d(e.content);break;case"openTranslater":o();break;default:console.error(`Message type "${e.type}" not found.`);break}return!0};chrome.runtime.onMessage.addListener(p);chrome.commands.onCommand.addListener(e=>{switch(e){case"open-translater":o();break;default:console.error(`Command "${e}" not found.`);break}});
