"use strict";(globalThis.webpackChunkgroup_speed_dial=globalThis.webpackChunkgroup_speed_dial||[]).push([[141],{3015:(t,e,a)=>{a.d(e,{D:()=>n});const n=()=>Promise.all([a.e(611),a.e(900)]).then(a.bind(a,9232))},3011:(t,e,a)=>{a.r(e),a.d(e,{showHistoryModal:()=>b,undoLastAction:()=>x});var n=a(5296),o=a(4590),i=a(6004),s=a(1641),r=a(3694),c=a(9598),l=a(7552),p=a(2846),u=a(1879),d=a(1285),h=a(1305),m=a(3015),_=a(7526),w=a(5772),f=a(7319),g=a(7302),y=a(8495);async function b(){let t;const e=document.createElement("div"),a=(0,c.z)("select",{size:7,style:"min-width: 300px",handlers:{onchange:v}},[(0,c.z)("option",{textContent:(0,o.tr)("history_loading")})]),b=(0,c.z)("p",{class:"flex flex-space-between"},[(0,c.z)("label",{textContent:(0,o.tr)("label_see_also")}),(0,c.z)("a",{target:"_blank",href:(0,g.Z)("/popup/popup.html#OptionsImportBackup"),textContent:(0,y.e)("o_backup_restore",{column:!1})})]);function x(e){t=e.sort((0,w.s)("date",!1));const n=a.value;a.replaceChildren(...t.map((t=>(0,c.z)("option",{value:t.id,textContent:`${(0,r.Ib)(t.date)}: ${t.name}`})))),a.value=n}async function v(){const e=t.filter((t=>t.id===+a.value))[0];if(!e)return;const n=e.groups.map(f.$),o=n.find((t=>t.id===u.e.id));o&&await(0,s.Wx)(o),await(0,d.N)(n)}async function C(){u.e.removeOnChange(v),await(0,s.Pz)()}n.p.show((0,o.tr)("history_title"),(0,c.z)("div",{},[e,b,a]),{yesText:(0,o.tr)("history_restore"),noText:(0,o.tr)("history_cancel"),onYes:function(){const e=t.filter((t=>t.id===+a.value))[0];if(!e)return;p.M.action("importData",{replaceExisting:!0,groups:e.groups,metadata:e.metadata},(0,o.tr)("save_history_restored"))},onNo:C,onClose:C}),a.focus(),u.e.addOnChange(v),await async function(){await(0,i.$A)(e,(()=>h.i.withDB((async t=>{const e=await t.dbTransactionOperation(l.ew.DB_HISTORY,l.p0.DB_OP_READONLY,"getAll");x(e);const a=(await(await(0,m.D)()).getSyncBackups().catch((t=>[]))).map((t=>({...t,id:-(0,_.V)(),name:(0,o.tr)("automatic_backup")})));x(e.concat(a))}))))}().catch((t=>{throw e.textContent="Error: "+JSON.stringify(t),t}))}function x(){return h.i.withDB((async t=>{const[e,a]=await t.mapEachRecord(l.ew.DB_HISTORY,{direction:l.Pb.PREV,filterMode:"take_while",filter:(t,e)=>e<2});if(!a)return;const{groups:n,metadata:i,name:s,id:r,date:c}=a;return await p.M.action("importData",{replaceExisting:!0,groups:n,metadata:i},(0,o.tr)("save_history_undo",e.name)),!0}))}},8495:(t,e,a)=>{a.d(e,{e:()=>o});var n=a(4590);const o=(t,e)=>{const{column:a,capitalize:o,substitutions:i}=e||{};let s=(0,n.tr)(t,i);return!0!==a&&!1!==a||(s.endsWith(":")?a||(s=s.slice(0,-1)):a&&(s+=":")),o&&(s=s[0].toLocaleUpperCase()+s.slice(1)),s}}}]);