import{a as p}from"./cplx-Bzmv935M.js";import{s as c}from"./cplx-DNOGgzzX.js";import"./cplx-Cdcyb6EG.js";import"./cplx-BbAh7E-i.js";import"./cplx-wwbq-DDb.js";import"./cplx-B814hFp-.js";function f(){const t=window.fetch;window.fetch=async function(e,n){if((n==null?void 0:n.body)==null||typeof n.body!="string")return t.call(window,e,n);const r=await c("network-intercept:fetchEvent",{event:"request",payload:{url:i(e),data:n.body}},"content-script");r!=null&&r.data&&(n.body=r.data);const a=await t.call(window,e,n),o=await a.clone().text();return await c("network-intercept:fetchEvent",{event:"response",payload:{url:i(e),status:a.status,data:o}},"content-script"),a}}function i(t){return t instanceof URL?t.href:typeof t=="string"?t:""}const d=new Set,u=WebSocket.prototype.send;function l(t){return(t==null?void 0:t.readyState)===WebSocket.OPEN}function y(t){l(t)&&(d.add(t),w(t))}function w(t){const e=t.onmessage;t.onmessage=n=>{typeof n.data=="string"&&c("network-intercept:webSocketEvent",{event:"message",payload:{url:t.url,data:n.data}},"content-script"),e&&e.call(t,n)}}function h(){WebSocket.prototype.send=async function(t){if(d.has(this)||y(this),typeof t=="string"){const e=await c("network-intercept:webSocketEvent",{event:"send",payload:{url:this.url,data:t}},"content-script");if(e!=null&&typeof e=="object"&&"data"in e){if(e.data==="")return;t=e.data}}return u.apply(this,[t])}}function b(){h()}p();function k(){const t=window.XMLHttpRequest;window.XMLHttpRequest=function(){const e=new t;let n;const r=e.open;e.open=function(s,o){return n=o,r.apply(this,arguments)};const a=e.send;return e.send=async function(s){if(typeof s=="string"){const o=await c("network-intercept:xhrEvent",{event:"request",payload:{url:n,data:s}},"content-script");o!=null&&typeof o=="object"&&"data"in o&&(s=o.data)}return a.apply(this,[s])},e.addEventListener("load",function(){c("network-intercept:xhrEvent",{event:"response",payload:{url:this.responseURL,data:this.responseText}},"content-script")}),e}}p();f();k();b();
