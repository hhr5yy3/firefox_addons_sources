var origin="";let fullReportURL;var mouseentered=!1;let OPEN_FULLREPORT="FAAABCAF-50C5-4EE5-B18B-4E4FA9425B70";(e=>{(e.NSSS=e.NSSS||{}).annotationpopup=(u=>{let e={},i=u.utils.isntNil;return e.preparePopup=function(t){fullReportURL=t.fullReportURL;var n=null;if(t.hasOwnProperty("dir"))$("#body").attr("dir",t.dir);else{switch(origin="annotations",$("div.PopupArea").attr("lang",t.lang),$("#Domain").text(t.normalizedURL),$("#Domain").attr("title",t.normalizedURL),n="neutral",t.srcImage){case"sb_unsafeAnnotation.svg":n="red";break;case"sb_webnuisanceAnnotation.svg":n="warn";break;case"sb_unknownAnnotation.svg":n="unknown";break;case"sb_nortoncertified.svg":n="nsecured"}document.getElementById("ContentArea").setAttribute("state",n);var o,a=["resultSpan_safe","resultSpan_secure","resultSpan_caution","resultSpan_untested","resultSpan_unsafe","totalThreatLabel","untestedText","FullReportText"],r=[];for(o in a){var s=document.getElementById(a[o]).dataset.l10nId;r.push(s)}u.localizerProxy.getLocalizedStrings(r,function(e){for(var t in r){var n=r[t];$("#"+a[t]).text(e[n])}});let e=0;i(t.annoyanceFactorAttributes)&&(e+=t.annoyanceFactorAttributes),i(t.computerThreatAttributes)&&(e+=t.computerThreatAttributes),i(t.identityThreatAttributes)&&(e+=t.identityThreatAttributes),t.showFullReport?$("#FullReport").show():$("#FullReport").hide(),$("#thread_cnt_r4").text(e)}},e.closePopup=function(){!1===mouseentered&&parent.window.postMessage({name:"closeAnnotationPopup"},"*")},e})(e.SymBfw)})(this),$(document).ready(function(){$("#body").on("mouseenter",function(){mouseentered=!0}),$("#body").on("mouseleave",function(){mouseentered=!1,NSSS.annotationpopup.closePopup()}),$("#FullReport").on("click",function(){SymBfw.extensionAdapter.sendMessage({name:OPEN_FULLREPORT,message:{fullReportURL:fullReportURL}})})});var receiveMessage=function(e){switch(e.data.name){case"preparePopup":NSSS.annotationpopup.preparePopup(e.data.message);break;case"canCloseAnnotation":NSSS.annotationpopup.closePopup()}};window.addEventListener("message",receiveMessage,!1);