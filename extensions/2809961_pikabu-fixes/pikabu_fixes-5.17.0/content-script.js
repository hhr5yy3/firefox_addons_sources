/*! For license information please see content-script.js.LICENSE.txt */
(()=>{var e={7871:function(e,t,r){var n,o,i;e=r.nmd(e),o=[],void 0===(i="function"==typeof(n=function(){"use strict";var t={},n=null;function o(t){if(e&&e.exports)try{return r(6528).randomBytes(t)}catch(e){}try{var o;return(self.crypto||self.msCrypto).getRandomValues(o=new Uint32Array(t)),Array.prototype.slice.call(o)}catch(e){}if(!n)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return n(t)}try{o(1)}catch(e){}function i(e,t){for(var r=0,n=0,o=0,i=e.length;o<i;++o)e.charCodeAt(o)===t.charCodeAt(o)?++r:++n;return!(r<0)&&0===n}n=null,t.setRandomFallback=function(e){n=e},t.genSaltSync=function(e,t){if("number"!=typeof(e=e||y))throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2a$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(f(o(h),h)),r.join("")},t.genSalt=function(e,r,n){if("function"==typeof r&&(n=r,r=void 0),"function"==typeof e&&(n=e,e=void 0),void 0===e)e=y;else if("number"!=typeof e)throw Error("illegal arguments: "+typeof e);function o(r){s((function(){try{r(null,t.genSaltSync(e))}catch(e){r(e)}}))}if(!n)return new Promise((function(e,t){o((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);o(n)},t.hashSync=function(e,r){if(void 0===r&&(r=y),"number"==typeof r&&(r=t.genSaltSync(r)),"string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return x(e,r)},t.hash=function(e,r,n,o){function i(n){"string"==typeof e&&"number"==typeof r?t.genSalt(r,(function(t,r){x(e,r,n,o)})):"string"==typeof e&&"string"==typeof r?x(e,r,n,o):s(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise((function(e,t){i((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);i(n)},t.compareSync=function(e,r){if("string"!=typeof e||"string"!=typeof r)throw Error("Illegal arguments: "+typeof e+", "+typeof r);return 60===r.length&&i(t.hashSync(e,r.substr(0,r.length-31)),r)},t.compare=function(e,r,n,o){function a(n){"string"==typeof e&&"string"==typeof r?60===r.length?t.hash(e,r.substr(0,29),(function(e,t){e?n(e):n(null,i(t,r))}),o):s(n.bind(this,null,!1)):s(n.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof r)))}if(!n)return new Promise((function(e,t){a((function(r,n){r?t(r):e(n)}))}));if("function"!=typeof n)throw Error("Illegal callback: "+typeof n);a(n)},t.getRounds=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)},t.getSalt=function(e){if("string"!=typeof e)throw Error("Illegal arguments: "+typeof e);if(60!==e.length)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)};var s="undefined"!=typeof process&&process&&"function"==typeof process.nextTick?"function"==typeof setImmediate?setImmediate:process.nextTick:setTimeout;function a(e){var t=[],r=0;return p.encodeUTF16toUTF8((function(){return r>=e.length?null:e.charCodeAt(r++)}),(function(e){t.push(e)})),t}var u="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],l=String.fromCharCode;function f(e,t){var r,n,o=0,i=[];if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;o<t;){if(r=255&e[o++],i.push(u[r>>2&63]),r=(3&r)<<4,o>=t){i.push(u[63&r]);break}if(r|=(n=255&e[o++])>>4&15,i.push(u[63&r]),r=(15&n)<<2,o>=t){i.push(u[63&r]);break}r|=(n=255&e[o++])>>6&3,i.push(u[63&r]),i.push(u[63&n])}return i.join("")}function d(e,t){var r,n,o,i,s,a=0,u=e.length,f=0,d=[];if(t<=0)throw Error("Illegal len: "+t);for(;a<u-1&&f<t&&(r=(s=e.charCodeAt(a++))<c.length?c[s]:-1,n=(s=e.charCodeAt(a++))<c.length?c[s]:-1,-1!=r&&-1!=n)&&(i=r<<2>>>0,i|=(48&n)>>4,d.push(l(i)),!(++f>=t||a>=u))&&-1!=(o=(s=e.charCodeAt(a++))<c.length?c[s]:-1)&&(i=(15&n)<<4>>>0,i|=(60&o)>>2,d.push(l(i)),!(++f>=t||a>=u));)i=(3&o)<<6>>>0,i|=(s=e.charCodeAt(a++))<c.length?c[s]:-1,d.push(l(i)),++f;var p=[];for(a=0;a<f;a++)p.push(d[a].charCodeAt(0));return p}var p=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<128?t(127&r):r<2048?(t(r>>6&31|192),t(63&r|128)):r<65536?(t(r>>12&15|224),t(r>>6&63|128),t(63&r|128)):(t(r>>18&7|240),t(r>>12&63|128),t(r>>6&63|128),t(63&r|128)),r=null},decodeUTF8:function(e,t){for(var r,n,o,i,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(r=e());)if(128&r)if(192==(224&r))null===(n=e())&&s([r,n]),t((31&r)<<6|63&n);else if(224==(240&r))(null===(n=e())||null===(o=e()))&&s([r,n,o]),t((15&r)<<12|(63&n)<<6|63&o);else{if(240!=(248&r))throw RangeError("Illegal starting byte: "+r);(null===(n=e())||null===(o=e())||null===(i=e()))&&s([r,n,o,i]),t((7&r)<<18|(63&n)<<12|(63&o)<<6|63&i)}else t(r)},UTF16toUTF8:function(e,t){for(var r,n=null;null!==(r=null!==n?n:e());)r>=55296&&r<=57343&&null!==(n=e())&&n>=56320&&n<=57343?(t(1024*(r-55296)+n-56320+65536),n=null):t(r);null!==n&&t(n)},UTF8toUTF16:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)r<=65535?t(r):(t(55296+((r-=65536)>>10)),t(r%1024+56320)),r=null},encodeUTF16toUTF8:function(t,r){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,r)}))},decodeUTF8toUTF16:function(t,r){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,r)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(t){for(var r,n=0;null!==(r=t());)n+=e.calculateCodePoint(r);return n},calculateUTF16asUTF8:function(t){var r=0,n=0;return e.UTF16toUTF8(t,(function(t){++r,n+=e.calculateCodePoint(t)})),[r,n]}};return e}();Date.now=Date.now||function(){return+new Date};var h=16,y=10,v=16,g=100,b=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],m=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],w=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function S(e,t,r,n){var o,i=e[t],s=e[t+1];return o=n[(i^=r[0])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[1])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[2])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[3])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[4])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[5])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[6])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[7])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[8])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[9])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[10])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[11])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[12])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[13])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],o=n[(i^=(o+=n[768|255&s])^r[14])>>>24],o+=n[256|i>>16&255],o^=n[512|i>>8&255],o=n[(s^=(o+=n[768|255&i])^r[15])>>>24],o+=n[256|s>>16&255],o^=n[512|s>>8&255],i^=(o+=n[768|255&s])^r[16],e[t]=s^r[v+1],e[t+1]=i,e}function _(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|255&e[t],t=(t+1)%e.length;return{key:n,offp:t}}function O(e,t,r){for(var n,o=0,i=[0,0],s=t.length,a=r.length,u=0;u<s;u++)o=(n=_(e,o)).offp,t[u]=t[u]^n.key;for(u=0;u<s;u+=2)i=S(i,0,t,r),t[u]=i[0],t[u+1]=i[1];for(u=0;u<a;u+=2)i=S(i,0,t,r),r[u]=i[0],r[u+1]=i[1]}function T(e,t,r,n){for(var o,i=0,s=[0,0],a=r.length,u=n.length,c=0;c<a;c++)i=(o=_(t,i)).offp,r[c]=r[c]^o.key;for(i=0,c=0;c<a;c+=2)i=(o=_(e,i)).offp,s[0]^=o.key,i=(o=_(e,i)).offp,s[1]^=o.key,s=S(s,0,r,n),r[c]=s[0],r[c+1]=s[1];for(c=0;c<u;c+=2)i=(o=_(e,i)).offp,s[0]^=o.key,i=(o=_(e,i)).offp,s[1]^=o.key,s=S(s,0,r,n),n[c]=s[0],n[c+1]=s[1]}function C(e,t,r,n,o){var i,a=w.slice(),u=a.length;if(r<4||r>31){if(i=Error("Illegal number of rounds (4-31): "+r),n)return void s(n.bind(this,i));throw i}if(t.length!==h){if(i=Error("Illegal salt length: "+t.length+" != "+h),n)return void s(n.bind(this,i));throw i}r=1<<r>>>0;var c,l,f,d=0;function p(){if(o&&o(d/r),!(d<r)){for(d=0;d<64;d++)for(f=0;f<u>>1;f++)S(a,f<<1,c,l);var i=[];for(d=0;d<u;d++)i.push((a[d]>>24&255)>>>0),i.push((a[d]>>16&255)>>>0),i.push((a[d]>>8&255)>>>0),i.push((255&a[d])>>>0);return n?void n(null,i):i}for(var h=Date.now();d<r&&(d+=1,O(e,c,l),O(t,c,l),!(Date.now()-h>g)););n&&s(p)}if(Int32Array?(c=new Int32Array(b),l=new Int32Array(m)):(c=b.slice(),l=m.slice()),T(t,e,c,l),void 0!==n)p();else for(var y;;)if(void 0!==(y=p()))return y||[]}function x(e,t,r,n){var o,i,u;if("string"!=typeof e||"string"!=typeof t){if(o=Error("Invalid string / salt: Not a string"),r)return void s(r.bind(this,o));throw o}if("$"!==t.charAt(0)||"2"!==t.charAt(1)){if(o=Error("Invalid salt version: "+t.substring(0,2)),r)return void s(r.bind(this,o));throw o}if("$"===t.charAt(2))i=String.fromCharCode(0),u=3;else{if("a"!==(i=t.charAt(2))&&"b"!==i&&"y"!==i||"$"!==t.charAt(3)){if(o=Error("Invalid salt revision: "+t.substring(2,4)),r)return void s(r.bind(this,o));throw o}u=4}if(t.charAt(u+2)>"$"){if(o=Error("Missing salt rounds"),r)return void s(r.bind(this,o));throw o}var c=10*parseInt(t.substring(u,u+1),10)+parseInt(t.substring(u+1,u+2),10),l=t.substring(u+3,u+25),p=a(e+=i>="a"?"\0":""),y=d(l,h);function v(e){var t=[];return t.push("$2"),i>="a"&&t.push(i),t.push("$"),c<10&&t.push("0"),t.push(c.toString()),t.push("$"),t.push(f(y,y.length)),t.push(f(e,4*w.length-1)),t.join("")}if(void 0===r)return v(C(p,y,c));C(p,y,c,(function(e,t){e?r(e,null):r(null,v(t))}),n)}return t.encodeBase64=f,t.decodeBase64=d,t})?n.apply(t,o):n)||(e.exports=i)},7426:(e,t,r)=>{"use strict";function n(e,t){if(null==e)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}r.d(t,{A:()=>n})},3551:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(7426);function o(e){return(0,n.A)({},e)}},1613:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};const o=function(e,t,r){var o,i=n[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=r&&r.addSuffix?r.comparison&&r.comparison>0?"in "+o:o+" ago":o};var i=r(5047);const s={date:(0,i.A)({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:(0,i.A)({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:(0,i.A)({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})};var a={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};const u=function(e,t,r,n){return a[e]};var c=r(4797);const l={ordinalNumber:function(e,t){var r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:(0,c.A)({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:(0,c.A)({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,c.A)({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:(0,c.A)({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:(0,c.A)({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};var f=r(3091);const d={code:"en-US",formatDistance:o,formatLong:s,formatRelative:u,localize:l,match:{ordinalNumber:(0,r(6171).A)({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,f.A)({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:(0,f.A)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,f.A)({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:(0,f.A)({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:(0,f.A)({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},1858:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});var n={};function o(){return n}},7044:(e,t,r)=>{"use strict";function n(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}r.d(t,{A:()=>n})},551:(e,t,r)=>{"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}r.d(t,{A:()=>n})},4188:(e,t,r)=>{"use strict";function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}r.d(t,{A:()=>n})},7767:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(4188),o=r(123),i=r(551);function s(e,t){(0,i.A)(2,arguments);var r=(0,o.A)(e).getTime(),s=(0,n.A)(t);return new Date(r+s)}},6982:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(123),o=r(551);function i(e,t){(0,o.A)(2,arguments);var r=(0,n.A)(e),i=(0,n.A)(t),s=r.getTime()-i.getTime();return s<0?-1:s>0?1:s}},2293:(e,t,r)=>{"use strict";r.d(t,{A:()=>w});var n=r(1858),o=r(6982),i=r(123),s=r(551);function a(e){(0,s.A)(1,arguments);var t=(0,i.A)(e);return function(e){(0,s.A)(1,arguments);var t=(0,i.A)(e);return t.setHours(23,59,59,999),t}(t).getTime()===function(e){(0,s.A)(1,arguments);var t=(0,i.A)(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}(t).getTime()}function u(e,t){(0,s.A)(2,arguments);var r,n=(0,i.A)(e),u=(0,i.A)(t),c=(0,o.A)(n,u),l=Math.abs(function(e,t){(0,s.A)(2,arguments);var r=(0,i.A)(e),n=(0,i.A)(t);return 12*(r.getFullYear()-n.getFullYear())+(r.getMonth()-n.getMonth())}(n,u));if(l<1)r=0;else{1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-c*l);var f=(0,o.A)(n,u)===-c;a((0,i.A)(e))&&1===l&&1===(0,o.A)(e,u)&&(f=!1),r=c*(l-Number(f))}return 0===r?0:r}var c={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},l="trunc";function f(e,t,r){(0,s.A)(2,arguments);var n,o=function(e,t){return(0,s.A)(2,arguments),(0,i.A)(e).getTime()-(0,i.A)(t).getTime()}(e,t)/1e3;return((n=null==r?void 0:r.roundingMethod)?c[n]:c[l])(o)}var d=r(1613),p=r(3551),h=r(7426),y=r(7044),v=1440,g=2520,b=43200,m=86400;function w(e,t){return(0,s.A)(1,arguments),function(e,t,r){var a,c;(0,s.A)(2,arguments);var l=(0,n.q)(),w=null!==(a=null!==(c=null==r?void 0:r.locale)&&void 0!==c?c:l.locale)&&void 0!==a?a:d.A;if(!w.formatDistance)throw new RangeError("locale must contain formatDistance property");var S=(0,o.A)(e,t);if(isNaN(S))throw new RangeError("Invalid time value");var _,O,T=(0,h.A)((0,p.A)(r),{addSuffix:Boolean(null==r?void 0:r.addSuffix),comparison:S});S>0?(_=(0,i.A)(t),O=(0,i.A)(e)):(_=(0,i.A)(e),O=(0,i.A)(t));var C,x=f(O,_),A=((0,y.A)(O)-(0,y.A)(_))/1e3,E=Math.round((x-A)/60);if(E<2)return null!=r&&r.includeSeconds?x<5?w.formatDistance("lessThanXSeconds",5,T):x<10?w.formatDistance("lessThanXSeconds",10,T):x<20?w.formatDistance("lessThanXSeconds",20,T):x<40?w.formatDistance("halfAMinute",0,T):x<60?w.formatDistance("lessThanXMinutes",1,T):w.formatDistance("xMinutes",1,T):0===E?w.formatDistance("lessThanXMinutes",1,T):w.formatDistance("xMinutes",E,T);if(E<45)return w.formatDistance("xMinutes",E,T);if(E<90)return w.formatDistance("aboutXHours",1,T);if(E<v){var k=Math.round(E/60);return w.formatDistance("aboutXHours",k,T)}if(E<g)return w.formatDistance("xDays",1,T);if(E<b){var P=Math.round(E/v);return w.formatDistance("xDays",P,T)}if(E<m)return C=Math.round(E/b),w.formatDistance("aboutXMonths",C,T);if((C=u(O,_))<12){var j=Math.round(E/b);return w.formatDistance("xMonths",j,T)}var M=C%12,I=Math.floor(C/12);return M<3?w.formatDistance("aboutXYears",I,T):M<9?w.formatDistance("overXYears",I,T):w.formatDistance("almostXYears",I+1,T)}(e,Date.now(),t)}},5047:(e,t,r)=>{"use strict";function n(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}r.d(t,{A:()=>n})},4797:(e,t,r)=>{"use strict";function n(e){return function(t,r){var n;if("formatting"===(null!=r&&r.context?String(r.context):"standalone")&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=null!=r&&r.width?String(r.width):o;n=e.formattingValues[i]||e.formattingValues[o]}else{var s=e.defaultWidth,a=null!=r&&r.width?String(r.width):e.defaultWidth;n=e.values[a]||e.values[s]}return n[e.argumentCallback?e.argumentCallback(t):t]}}r.d(t,{A:()=>n})},3091:(e,t,r)=>{"use strict";function n(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.width,o=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;var s,a=i[0],u=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(u)?function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r;return}(u,(function(e){return e.test(a)})):function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r;return}(u,(function(e){return e.test(a)}));return s=e.valueCallback?e.valueCallback(c):c,{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(a.length)}}}r.d(t,{A:()=>n})},6171:(e,t,r)=>{"use strict";function n(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var o=n[0],i=t.match(e.parsePattern);if(!i)return null;var s=e.valueCallback?e.valueCallback(i[0]):i[0];return{value:s=r.valueCallback?r.valueCallback(s):s,rest:t.slice(o.length)}}}r.d(t,{A:()=>n})},76:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});Math.pow(10,8);var n=6e4,o=36e5,i=r(551),s=r(4188);function a(e,t){var r;(0,i.A)(1,arguments);var a=(0,s.A)(null!==(r=null==t?void 0:t.additionalDigits)&&void 0!==r?r:2);if(2!==a&&1!==a&&0!==a)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var v,g=function(e){var t,r={},n=e.split(u.dateTimeDelimiter);if(n.length>2)return r;/:/.test(n[0])?t=n[0]:(r.date=n[0],t=n[1],u.timeZoneDelimiter.test(r.date)&&(r.date=e.split(u.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length)));if(t){var o=u.timezone.exec(t);o?(r.time=t.replace(o[1],""),r.timezone=o[1]):r.time=t}return r}(e);if(g.date){var b=function(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var o=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:null===i?o:100*i,restDateString:e.slice((n[1]||n[2]).length)}}(g.date,a);v=function(e,t){if(null===t)return new Date(NaN);var r=e.match(c);if(!r)return new Date(NaN);var n=!!r[4],o=d(r[1]),i=d(r[2])-1,s=d(r[3]),a=d(r[4]),u=d(r[5])-1;if(n)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,a,u)?function(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var o=n.getUTCDay()||7,i=7*(t-1)+r+1-o;return n.setUTCDate(n.getUTCDate()+i),n}(t,a,u):new Date(NaN);var l=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(h[t]||(y(e)?29:28))}(t,i,s)&&function(e,t){return t>=1&&t<=(y(e)?366:365)}(t,o)?(l.setUTCFullYear(t,i,Math.max(o,s)),l):new Date(NaN)}(b.restDateString,b.year)}if(!v||isNaN(v.getTime()))return new Date(NaN);var m,w=v.getTime(),S=0;if(g.time&&(S=function(e){var t=e.match(l);if(!t)return NaN;var r=p(t[1]),i=p(t[2]),s=p(t[3]);if(!function(e,t,r){if(24===e)return 0===t&&0===r;return r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,i,s))return NaN;return r*o+i*n+1e3*s}(g.time),isNaN(S)))return new Date(NaN);if(!g.timezone){var _=new Date(w+S),O=new Date(0);return O.setFullYear(_.getUTCFullYear(),_.getUTCMonth(),_.getUTCDate()),O.setHours(_.getUTCHours(),_.getUTCMinutes(),_.getUTCSeconds(),_.getUTCMilliseconds()),O}return m=function(e){if("Z"===e)return 0;var t=e.match(f);if(!t)return 0;var r="+"===t[1]?-1:1,i=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,s))return NaN;return r*(i*o+s*n)}(g.timezone),isNaN(m)?new Date(NaN):new Date(w+S+m)}var u={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},c=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,f=/^([+-])(\d{2})(?::?(\d{2}))?$/;function d(e){return e?parseInt(e):1}function p(e){return e&&parseFloat(e.replace(",","."))||0}var h=[31,null,31,30,31,30,31,31,30,31,30,31];function y(e){return e%400==0||e%4==0&&e%100!=0}},123:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(2284),o=r(551);function i(e){(0,o.A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,n.A)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},7284:e=>{(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{API:()=>i,CONNECTION_STATUS:()=>l,Connection:()=>w,DATA_TYPE:()=>o,ERROR_TYPE:()=>d,EVENT:()=>s,IDB_MODE:()=>u,OCCURENCE:()=>c,QUERY_OPTION:()=>a,WORKER_STATUS:()=>n,forObj:()=>_,promise:()=>h,promiseAll:()=>S,promiseResolve:()=>y});var n,o,i,s,a,u,c,l,f=function(){function e(e,t){this.type=e,this._info=t,this.message=this.getMsg()}return e.prototype.throw=function(){throw this},e.prototype.log=function(e){this.status&&console.log(e)},e.prototype.logError=function(){console.error(this.get())},e.prototype.logWarning=function(){console.warn(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.getMsg=function(){return this.type,this.message},e}(),d={InvalidUpdateColumn:"invalid_update_column",UndefinedColumn:"undefined_column",UndefinedValue:"undefined_value",UndefinedColumnName:"undefined_column_name",UndefinedDbName:"undefined_database_name",UndefinedColumnValue:"undefined_column_value",NotArray:"not_array",NoValueSupplied:"no_value_supplied",ColumnNotExist:"column_not_exist",NoIndexFound:"no_index_found",InvalidOp:"invalid_operator",NullValue:"null_value",WrongDataType:"wrong_data_type",TableNotExist:"table_not_exist",DbNotExist:"db_not_exist",ConnectionAborted:"connection_aborted",ConnectionClosed:"connection_closed",NotObject:"not_object",InvalidConfig:"invalid_config",DbBlocked:"Db_blocked",IndexedDbNotSupported:"indexeddb_not_supported",NullValueInWhere:"null_value_in_where",InvalidJoinQuery:"invalid_join_query",InvalidQuery:"invalid_query",ImportScriptsFailed:"import_scripts_failed",MethodNotExist:"method_not_exist",Unknown:"unknown",InvalidMiddleware:"invalid_middleware",InvalidOrderQuery:"invalid_order_query",InvalidGroupQuery:"invalid_group_query",NoPrimaryKey:"no_primary_key"};!function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(n||(n={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(o||(o={})),function(e){e.InitDb="init_db",e.MapGet="map_get",e.MapSet="map_set",e.MapHas="map_has",e.MapDelete="map_delete",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts",e.Middleware="middleware"}(i||(i={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled",e.Upgrade="upgrade",e.Create="create",e.Open="open"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.List="list",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(a||(a={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(u||(u={})),function(e){e.First="f",e.Last="l",e.Any="a"}(c||(c={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(l||(l={}));var p,h=function(e){return new Promise(e)},y=function(e){return Promise.resolve(e)},v=function(){function e(e){this._events={},this._ctx=e}return e.prototype.on=function(e,t){return null==this._events[e]&&(this._events[e]=[]),this._events[e].push(t),this},e.prototype.off=function(e,t){if(this._events[e])if(t){var r=this._events[e].indexOf(t);this._events[e].splice(r,1)}else this._events[e]=[]},e.prototype.emit=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this._events[e]||[],i=0,s=o.length,a=[];return new Promise((function(e){var n=function(){i<s?function(){var e=o[i++];if(e){var n=e.call.apply(e,function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([t._ctx],r,!1));return n&&n.then?n:Promise.resolve(n)}}().then((function(e){a.push(e),n()})):e(a)};n()}))},e.prototype.destroy=function(){this._events=null,this._ctx=null},e}(),g=function(){function e(e){this.isConOpened_=!1,this.isDbIdle_=!0,this.requestQueue_=[],this.isCodeExecuting_=!1,this.inactivityTimer_=-1e3,this.middlewares=[],this.eventBus_=new v(this),this.whiteListApi_=[i.InitDb,i.OpenDb,i.MapGet,i.MapSet,i.MapHas,i.MapDelete,i.ChangeLogStatus,i.Terminate,i.DropDb],this.isWorker=!0,this.logger=new f(null),e?(this.worker_=e,this.worker_.onmessage=this.onMessageFromWorker_.bind(this)):(this.isWorker=!1,this.initQueryManager_())}return Object.defineProperty(e.prototype,"jsstoreWorker",{get:function(){return this.$worker||self.JsStoreWorker},enumerable:!1,configurable:!0}),e.prototype.initQueryManager_=function(){var e=this.jsstoreWorker;e&&(this.queryManager=new e.QueryManager(this.processFinishedQuery_.bind(this)))},e.prototype.onMessageFromWorker_=function(e){this.processFinishedQuery_(e.data)},e.prototype.processFinishedQuery_=function(e){var t=this.requestQueue_.shift();if(t){if(this.logger.log("request ".concat(t.name," finished")),e.error)t.onError(e.error);else{switch(t.name){case i.OpenDb:case i.InitDb:this.isConOpened_=!0;break;case i.Terminate:this.isConOpened_=!1,!0===this.isWorker&&this.worker_.terminate();case i.DropDb:this.isConOpened_=!1,this.requestQueue_=[],this.isDbIdle_=!0;break;case i.CloseDb:this.isDbIdle_=!0,this.eventBus_.emit(s.RequestQueueEmpty,[]),this.requestQueue_.length>0&&this.openDb_(!1)}t.onSuccess(e.result)}this.isCodeExecuting_=!1,this.executeQry_()}},e.prototype.openDb_=function(e){void 0===e&&(e=!0);var t={name:i.OpenDb,query:{name:this.database.name,version:this.database.version},onSuccess:function(){},onError:function(e){console.error(e)}};e?this.prcoessExecutionOfQry_(t,0):this.requestQueue_.splice(0,0,t)},e.prototype.executeMiddleware_=function(e){var t=this;return h((function(r){var n=0,o=t.middlewares.length-1,i=function(){if(n<=o){var s=t.middlewares[n++](e);s&&s.then||(s=y(s)),s.then((function(e){i()}))}else r()};i()}))},e.prototype.callResultMiddleware=function(e,t){return h((function(r){var n=0,o=e.length-1,i=function(){if(n<=o){var s=e[n++](t);s.then||(s=y(s)),s.then((function(e){t=e,i()}))}else r(t)};i()}))},e.prototype.pushApi=function(e){var t=this;return new Promise((function(r,n){var o=[];e.onResult=function(e){o.push((function(t){return e(t)}))},t.executeMiddleware_(e).then((function(){e.onSuccess=function(n){t.callResultMiddleware(o,n).then((function(e){r(e)})).catch((function(t){e.onError(t)}))},e.onError=function(e){o=[],n(e)},0===t.requestQueue_.length&&(t.eventBus_.emit(s.RequestQueueFilled,[]),t.isDbIdle_&&t.isConOpened_&&([i.InitDb,i.CloseDb,i.DropDb,i.OpenDb,i.Terminate].indexOf(e.name)>=0||t.openDb_()),clearTimeout(t.inactivityTimer_)),t.prcoessExecutionOfQry_(e)})).catch(n)}))},e.prototype.prcoessExecutionOfQry_=function(e,t){this.isDbIdle_=!1,null!=t?this.requestQueue_.splice(t,0,e):this.requestQueue_.push(e),this.logger.log("request pushed: "+e.name),this.executeQry_()},e.prototype.executeQry_=function(){var e=this,t=this.requestQueue_.length;if(!this.isCodeExecuting_&&t>0){if(!0===this.isConOpened_)return void this.sendRequestToWorker_(this.requestQueue_[0]);var r=this.requestQueue_.findIndex((function(t){return e.whiteListApi_.indexOf(t.name)>=0}));r>=0&&(this.requestQueue_.splice(0,0,this.requestQueue_.splice(r,1)[0]),this.sendRequestToWorker_(this.requestQueue_[0]))}else 0===t&&!1===this.isDbIdle_&&this.isConOpened_&&(this.inactivityTimer_=setTimeout((function(){e.prcoessExecutionOfQry_({name:i.CloseDb,onSuccess:function(){},onError:function(e){console.error(e)}})}),100))},e.prototype.sendRequestToWorker_=function(e){this.isCodeExecuting_=!0,this.logger.log("request executing: "+e.name);var t={name:e.name,query:e.query};!0===this.isWorker?this.worker_.postMessage(t):this.queryManager.run(t)},e}(),b=function(){function e(e){this.con=e}return e.prototype.get=function(e){return this.con.pushApi({name:i.MapGet,query:e})},e.prototype.has=function(e){return this.con.pushApi({name:i.MapHas,query:e})},e.prototype.set=function(e,t){return this.con.pushApi({name:i.MapSet,query:{key:e,value:t}})},e.prototype.delete=function(e){return this.con.pushApi({name:i.MapDelete,query:e})},e}(),m=(p=function(e,t){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},p(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),w=function(e){function t(t){var r=e.call(this,t)||this;return r.Map=new b(r),r}return m(t,e),t.prototype.initDb=function(e){var t=this;return this.database=e,this.pushApi({name:i.InitDb,query:e}).then((function(e){var r,n=e.database;return e.isCreated&&(r=e.oldVersion?t.eventBus_.emit(s.Upgrade,n,e.oldVersion,e.newVersion):t.eventBus_.emit(s.Create,n)),(r||y()).then((function(e){return t.eventBus_.emit(s.Open,n)})).then((function(t){return e.isCreated}))}))},t.prototype.dropDb=function(){return this.pushApi({name:i.DropDb})},t.prototype.select=function(e){return this.pushApi({name:i.Select,query:e})},t.prototype.count=function(e){return this.pushApi({name:i.Count,query:e})},t.prototype.insert=function(e){return this.pushApi({name:i.Insert,query:e})},t.prototype.update=function(e){return this.pushApi({name:i.Update,query:e})},t.prototype.remove=function(e){return this.pushApi({name:i.Remove,query:e})},t.prototype.clear=function(e){return this.pushApi({name:i.Clear,query:e})},Object.defineProperty(t.prototype,"logStatus",{set:function(e){this.logger.status=e,this.pushApi({name:i.ChangeLogStatus,query:e})},enumerable:!1,configurable:!0}),t.prototype.openDb=function(e,t){var r=this;return this.pushApi({name:i.OpenDb,query:{version:t,name:e}}).then((function(e){return r.database=e,e}))},t.prototype.getDbList=function(){return console.warn("Api getDbList is recommended to use for debugging only. Do not use in code."),indexedDB.databases()},t.prototype.get=function(e){return console.warn("This API is obsolete, please use Map"),this.Map.get(e)},t.prototype.set=function(e,t){return console.warn("This API is obsolete, please use Map"),this.Map.set(e,t)},t.prototype.terminate=function(){return this.pushApi({name:i.Terminate})},t.prototype.transaction=function(e){return this.pushApi({name:i.Transaction,query:e})},t.prototype.on=function(e,t){this.eventBus_.on(e,t)},t.prototype.off=function(e,t){this.eventBus_.off(e,t)},t.prototype.union=function(e){return this.pushApi({name:i.Union,query:e})},t.prototype.intersect=function(e){return this.pushApi({name:i.Intersect,query:e})},t.prototype.addPlugin=function(e,t){return e.setup(this,t)},t.prototype.addMiddleware=function(e,t){return t?this.pushApi({name:i.Middleware,query:e}):(this.middlewares.push(e),Promise.resolve())},t.prototype.importScripts=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.pushApi({name:i.ImportScripts,query:e})},t}(g),S=function(e){return Promise.all(e)},_=function(e,t){for(var r in e)t(r,e[r])};e.exports=r})()},7130:e=>{(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};t.r(r),t.d(r,{QueryManager:()=>ot});var n,o,i,s,a,u,c,l,f=function(e){return Promise.resolve(e)},d=function(e){return new Promise(e)},p="not_array",h="no_value_supplied",y="column_not_exist",v="no_index_found",g="null_value",b="wrong_data_type",m="table_not_exist",w="not_object",S="Db_blocked",_="indexeddb_not_supported",O="null_value_in_where",T="invalid_join_query",C="import_scripts_failed",x="method_not_exist",A="invalid_middleware";!function(e){e.Registered="registerd",e.Failed="failed",e.NotStarted="not_started"}(n||(n={})),function(e){e.String="string",e.Object="object",e.Array="array",e.Number="number",e.Boolean="boolean",e.Null="null",e.DateTime="date_time"}(o||(o={})),function(e){e.InitDb="init_db",e.MapGet="map_get",e.MapSet="map_set",e.MapHas="map_has",e.MapDelete="map_delete",e.Select="select",e.Insert="insert",e.Update="update",e.Remove="remove",e.OpenDb="open_db",e.Clear="clear",e.DropDb="drop_db",e.Count="count",e.ChangeLogStatus="change_log_status",e.Terminate="terminate",e.Transaction="transaction",e.CloseDb="close_db",e.Union="union",e.Intersect="intersect",e.ImportScripts="import_scripts",e.Middleware="middleware"}(i||(i={})),function(e){e.RequestQueueEmpty="requestQueueEmpty",e.RequestQueueFilled="requestQueueFilled",e.Upgrade="upgrade",e.Create="create",e.Open="open"}(s||(s={})),function(e){e.Where="where",e.Like="like",e.Regex="regex",e.In="in",e.Equal="=",e.Between="-",e.GreaterThan=">",e.LessThan="<",e.GreaterThanEqualTo=">=",e.LessThanEqualTo="<=",e.NotEqualTo="!=",e.Aggregate="aggregate",e.Max="max",e.Min="min",e.Avg="avg",e.Count="count",e.Sum="sum",e.List="list",e.Or="or",e.Skip="skip",e.Limit="limit",e.And="and",e.IgnoreCase="ignoreCase",e.Then="then"}(a||(a={})),function(e){e.ReadOnly="readonly",e.ReadWrite="readwrite"}(u||(u={})),function(e){e.First="f",e.Last="l",e.Any="a"}(c||(c={})),function(e){e.Connected="connected",e.Closed="closed",e.NotStarted="not_started",e.UnableToStart="unable_to_start",e.ClosedByJsStore="closed_by_jsstore"}(l||(l={}));var E,k=function(){function e(e){this.columns=[],this.autoIncColumnValue={},this.columns=this.setColumn(e.columns),this.name=e.name,this.alter=e.alter||{}}return e.prototype.setColumn=function(e){var t=[],r=function(r){var o=e[r];o.name=r,o.autoIncrement&&(n.autoIncColumnValue[r]=0),o.primaryKey&&(n.primaryKey=r,n.keypath=o.keyPath||r),o.enableSearch=null==o.enableSearch||o.enableSearch;var i=n.columns.indexOf((function(e){return e.name===r}));if(i<0)t.push(o);else{var s=n.columns[i];Object.assign(s,o)}},n=this;for(var o in e)r(o);return t},e}(),P=function(){function e(){}return e.autoIncrementKey=function(e,t){return"JsStore_".concat(e,"_").concat(t,"_Value")},e.getStore=function(t){return t.tx||t.createTransaction([e.tableName]),t.objectStore(e.tableName)},e.set=function(t,r,n){var o=e.getStore(n);return d((function(e,n){var i=o.put({key:t,value:r});i.onsuccess=function(){e()},i.onerror=n}))},e.get=function(t,r){var n=e.getStore(r);return d((function(e,o){var i=n.get(r.keyRange(t));i.onsuccess=function(){var t=i.result;e(t&&t.value)},i.onerror=o}))},e.remove=function(t,r){var n=e.getStore(r);return d((function(e,o){var i=n.delete(r.keyRange(t));i.onsuccess=function(){e()},i.onerror=o}))},e.has=function(t,r){var n=e.getStore(r);return d((function(e,o){var i=n.count(r.keyRange(t));i.onsuccess=function(){var t=i.result;e(t>0)},i.onerror=o}))},e.tableName="JsStore_Meta",e.dbSchema="JsStore_DbSchema",e}(),j=function(e){this.name=e.name,this.version=e.version||1,e.tables.push({name:P.tableName,columns:{key:{primaryKey:!0},value:{enableSearch:!1}}}),this.tables=e.tables.map((function(e){return new k(e)}))},M=function(e,t){for(var r in e)t(r,e[r])},I=function(){function e(e,t){this.type=e,this.info_=t,this.message=this.getMsg_()}return e.prototype.log=function(e){this.status&&console.log(e)},e.prototype.throw=function(){throw this.get()},e.prototype.logError=function(){console.error(this.get())},e.prototype.get=function(){return{message:this.message,type:this.type}},e.prototype.warn=function(){console.warn(this.get())},e.prototype.getMsg_=function(){var e,t,r=this.info_,n=((e={})[p]=function(){t="Supplied value is not an array"},e.undefined_column=function(){t="Column is undefined in Where"},e.undefined_value=function(){t="Value is undefined in Where"},e.undefined_column_name=function(){t="Column name is undefined '"+r.TableName+"'"},e.undefined_database_name=function(){t="Database name is not supplied"},e.undefined_column_value=function(){t="Column value is undefined"},e[h]=function(){t="No value is supplied"},e.invalid_operator=function(){t="Invalid Op Value '"+r.Op+"'"},e[y]=function(){var e=r.column;t=r.isOrder?"Column '".concat(e,"' in order query does not exist"):"Column '".concat(e,"' does not exist")},e[v]=function(){t="No index found for column '"+r.column+"'. Query can not be executed without index."},e[g]=function(){t="Null value is not allowed for column '"+r.ColumnName+"'"},e[b]=function(){t="Expected data type for the column ".concat(r.column," is ").concat(r.expected,", but received a ").concat(r.received,".")},e[m]=function(){t="Table '"+r.tableName+"' does not exist"},e.db_not_exist=function(){t="Database with name ".concat(r.dbName," does not exist")},e[w]=function(){t="supplied value is not object"},e.invalid_config=function(){t="Invalid Config '"+r.Config+" '"},e[S]=function(){t="database is blocked, cant be deleted right now"},e[O]=function(){t="Null/undefined is not allowed in where. Column '".concat(r.column,"' has null")},e[x]=function(){t="method '".concat(r,"' does not exist.")},e[_]=function(){t="Browser does not support indexeddb"},e.getInfo=function(){t=r},e[T]=function(){n.getInfo()},e[C]=function(){n.getInfo()},e[A]=function(){t="No function ".concat(r," is found.")},e),o=this.type,i=n[o];return i?i():(o||(this.type="unknown"),t=this.message),t},e}(),D=function(){function e(){this.logger=new I(null)}return e.prototype.emptyTx=function(){this.tx&&(this.tx.oncomplete=null,this.tx.onabort=null,this.tx.onerror=null,this.tx=null)},e.prototype.createTransactionIfNotExist=function(e,t){this.tx||this.createTransaction(e,t)},e.prototype.createTransaction=function(e,t){var r=this;return void 0===t&&(t=u.ReadWrite),this.tx=this.con.transaction(e,t),d((function(e,t){r.tx.oncomplete=e,r.tx.onabort=e,r.tx.onerror=t}))},e.prototype.keyRange=function(e,t){var r;switch(t){case a.Between:r=IDBKeyRange.bound(e.low,e.high,!1,!1);break;case a.GreaterThan:r=IDBKeyRange.lowerBound(e,!0);break;case a.GreaterThanEqualTo:r=IDBKeyRange.lowerBound(e);break;case a.LessThan:r=IDBKeyRange.upperBound(e,!0);break;case a.LessThanEqualTo:r=IDBKeyRange.upperBound(e);break;default:r=IDBKeyRange.only(e)}return r},e.prototype.objectStore=function(e){return this.tx.objectStore(e)},e.prototype.abortTransaction=function(){this.tx&&this.tx.abort()},e.prototype.close=function(){var e=this;return this.con&&this.con.close(),d((function(t){e.con=null,setTimeout(t,100)}))},e.prototype.initDb=function(e){var t,r=this,n=!1,o=e.version;return d((function(i,s){var a=indexedDB.open(e.name,o);a.onsuccess=function(){r.con=a.result,r.con.onversionchange=function(e){e.target.close()},i({isCreated:n,oldVersion:t,newVersion:o})},a.onerror=function(e){console.error("error",e),s(e)},a.onupgradeneeded=function(r){t=r.oldVersion;var i=r.target,s=i.result;n=!0;var a=i.transaction,u=s.objectStoreNames,c=function(e,t){var r=t.name;if(t.enableSearch&&!e.indexNames.contains(r)){var n=t.primaryKey?{unique:!0}:{unique:t.unique};n.multiEntry=t.multiEntry;var o=null==t.keyPath?r:t.keyPath;e.createIndex(r,o,n)}},l=function(e,t,r){var n=t.columns.findIndex((function(e){return e.name===r}));n>=0&&(t.columns.splice(n,1),e.deleteIndex(r))};e.tables.forEach((function(e){u.contains(e.name)||function(e){var t=e.primaryKey?{keyPath:e.keypath}:{autoIncrement:!0},r=s.createObjectStore(e.name,t);e.columns.forEach((function(e){c(r,e)}))}(e);for(var r=a.objectStore(e.name),n=t+1;n<=o;n++){var i=e.alter[n];i&&(i.add&&e.setColumn(i.add).forEach((function(t){c(r,t),e.columns.push(t)})),M(i.drop||{},(function(t){l(r,e,t)})),M(i.modify||{},(function(t,n){var o=n.multiEntry||n.keyPath||n.unique,i=e.columns.find((function(e){return e.name===t})),s=Object.assign(i,n);s.name=t,o&&(l(r,e,t),c(r,s),e.columns.push(s))})))}}));for(var f=function(t,r){var n=u.item(t);e.tables.findIndex((function(e){return e.name===n}))<0&&s.deleteObjectStore(n)},d=0,p=u.length;d<p;d++)f(d)}}))},e}(),R=function(e){return Promise.all(e)},N=function(e){return Promise.reject(e)},B=function(e){if(e instanceof I)return e.logError(),e.get();var t=void 0;return e.name?(t=new I(e.name)).message=e.message:(t=new I(e.target.error.name)).message=e.target.error.message,t.get()},U=function(){function e(){this.rowAffected=0,this.isTxQuery=!1,this.results=[]}return Object.defineProperty(e.prototype,"db",{get:function(){return this.util.db},enumerable:!1,configurable:!0}),e.prototype.table=function(e){var t=e||this.tableName;return this.db.tables.find((function(e){return e.name===t}))},e.prototype.primaryKey=function(e){var t=this.query;return!t.from&&t.store&&t.meta?t.meta.primaryKey:this.table(e).primaryKey},e.prototype.getColumnInfo=function(e,t){return this.table(t).columns.find((function(t){return t.name===e}))},e.prototype.onException=function(e,t){return console.error(e),this.util.abortTransaction(),N(function(e,t){return void 0===t&&(t="invalid_query"),e.name=t,B(e)}(e,t))},e}(),q=function(e){if(null==e)return o.Null;var t=typeof e;if("object"===t){if(Array.isArray(e))return o.Array;if(e instanceof Date)return o.DateTime}return t},F=function(e){return null==e||"number"==typeof e&&isNaN(e)},$=function(){function e(e,t){this.table=e,this.autoIncrementValue=t}return e.prototype.checkAndModifyValues=function(e){var t,r=this;this.query=e;var n=e.values,o=[];return n.every((function(n,i){return t=r.checkAndModifyValue(n),e.ignore&&t&&(o.push(i),t=null),!t})),o.forEach((function(e){n.splice(e,1)})),{err:t,values:n}},e.prototype.checkAndModifyValue=function(e){var t,r=this;return this.table.columns.every((function(n){return!(t=r.checkAndModifyColumnValue_(n,e))})),t},e.prototype.checkNotNullAndDataType_=function(e,t){if(e.notNull&&F(t[e.name]))return this.getError(g,{ColumnName:e.name});if(e.dataType&&!F(t[e.name])){var r=q(t[e.name]);if(r!==e.dataType)return this.getError(b,{column:e.name,expected:e.dataType,received:r})}},e.prototype.checkAndModifyColumnValue_=function(e,t){var r=t[e.name];if(e.autoIncrement?F(r)?t[e.name]=++this.autoIncrementValue[e.name]:q(r)===o.Number&&r>this.autoIncrementValue[e.name]&&(this.autoIncrementValue[e.name]=r):void 0!==e.default&&F(r)&&(t[e.name]=e.default),this.query.validation)return this.checkNotNullAndDataType_(e,t)},e.prototype.getError=function(e,t){return new I(e,t)},e}(),L=function(){function e(e){this.table=e}return e.prototype.check=function(e,t){var r,n=this;return typeof e===o.Object?this.table?this.table.columns.every((function(t){return t.name in e&&(r=n.checkByColumn_(t,e[t.name])),!r})):r=new I(m,{tableName:t}):r=new I(w),r},e.prototype.checkByColumn_=function(e,t){if(!0===e.notNull&&F(t))return new I(g,{ColumnName:e.name});var r=q(t),n=null!=t;if(e.dataType&&n&&r!==e.dataType&&"object"!==r)return new I(b,{column:e.name,expected:e.dataType,received:r});if(n&&"object"===r){var o=["+","-","*","/","{push}"];for(var i in t)if(o.indexOf(i)<0&&e.dataType&&r!==e.dataType)return new I(b,{column:e.name,expected:e.dataType,received:r})}},e}(),W=function(){function e(e){this.db=e}return e.prototype.validate=function(e,t){switch(e){case i.Select:case i.Remove:case i.Count:return this.checkSelect(t);case i.Insert:return this.checkInsertQuery(t);case i.Update:return this.checkUpdate(t)}},e.prototype.getTable_=function(e){return this.db.tables.find((function(t){return t.name===e}))},e.prototype.isInsertQryValid=function(e){var t,r=this.getTable_(e.into);if(r)switch(q(e.values)){case o.Array:break;case o.Null:t=new I(h);break;default:t=new I(p)}else t=new I(m,{tableName:e.into});return{table:r,log:t}},e.prototype.checkUpdate=function(e){var t=new L(this.getTable_(e.in)).check(e.set,e.in);if(t)return t;if(null!=e.where){if(t=this.checkForNullInWhere_(e))return t;this.addGreatAndLessToNotOp_(e)}},e.prototype.checkSelect=function(e){if(!e.store&&!this.getTable_(e.from))return new I(m,{tableName:e.from});if(e.where){var t=this.checkForNullInWhere_(e);if(t)return t;this.addGreatAndLessToNotOp_(e)}},e.prototype.checkForNullInWhere_=function(e){for(var t in e.where)if(null==e.where[t])return new I(O,{column:t})},e.prototype.addGreatAndLessToNotOp_=function(e){var t=e.where,r=function(e,t){return t.findIndex((function(t){return null!=e[t][a.NotEqualTo]}))>=0},n=function(e,t){var r;return t.forEach((function(t){null!=(r=e[t])[a.NotEqualTo]&&(e[t][a.GreaterThan]=r[a.NotEqualTo],void 0===e[a.Or]?(e[a.Or]={},e[a.Or][t]={}):void 0===e[a.Or][t]&&(e[a.Or][t]={}),e[a.Or][t][a.LessThan]=r[a.NotEqualTo],delete e[t][a.NotEqualTo])})),e};if(q(t)===o.Object){var i=Object.keys(t);if(r(t,i))if(1===i.length)e.where=n(t,i);else{var s=[];i.forEach((function(e){var r;s.push(n(((r={})[e]=t[e],r),[e]))})),e.where=s}}else{var u=[];t.forEach((function(e){var t=Object.keys(e);r(e,t)&&(e=n(e,t)),u.push(e)})),e.where=u}},e.prototype.checkInsertQuery=function(e){var t=this.isInsertQryValid(e),r=t.table,n=t.log;if(n)return n;if(!e.skipDataCheck){var o=new $(r,r.autoIncColumnValue).checkAndModifyValues(e),i=o.values,s=o.err;return e.values=i,s}},e}(),Q=(E=function(e,t){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},E(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),V=function(e){function t(t,r){var n=e.call(this)||this;return n.valuesAffected_=[],null==t.validation&&(t.validation=!0),n.query=t,n.util=r,n.tableName=t.into,n}return Q(t,e),t.prototype.execute=function(e){var t=this,r=this.db,n=new W(r).validate(i.Insert,this.query);return n?N(n):e().then((function(e){return t.insertData_(r).then((function(e){return t.query.return?t.valuesAffected_:t.rowAffected}))})).catch((function(e){return t.util.abortTransaction(),N(e)}))},t.prototype.insertData_=function(e){var t,r,n,o=this,i=this.query;return t=i.return?function(e){o.valuesAffected_.push(e)}:function(e){++o.rowAffected},n=i.upsert?"put":"add",r=i.ignore&&!o.isTxQuery?function(e){return o.util.con.transaction(i.into,u.ReadWrite).objectStore(i.into)[n](e)}:(o.isTxQuery||o.util.createTransaction([i.into,P.tableName]),o.objectStore=o.util.objectStore(o.tableName),function(e){return o.objectStore[n](e)}),R(i.values.map((function(e){return d((function(n,o){var s=r(e);s.onerror=function(e){i.ignore?n():o(e)},s.onsuccess=function(){t(e),n()}}))}))).then((function(){return P.set(P.dbSchema,e,o.util)}))},t}(U),z=void 0===self.alert&&"undefined"==typeof ServiceWorkerGlobalScope,J=function(){try{if(indexedDB||(indexedDB=self.mozIndexedDB||self.webkitIndexedDB||self.msIndexedDB),!indexedDB)return!1;IDBTransaction=IDBTransaction||self.webkitIDBTransaction||self.msIDBTransaction,self.IDBKeyRange=self.IDBKeyRange||self.webkitIDBKeyRange||self.msIDBKeyRange}catch(e){return!1}return!0}(),K=function(e){return Array.isArray(e)},H=function(e){return Object.keys(e)},G=function(e){return H(e).length},X=function(){function e(){}return e.prototype.setCaseAndValue=function(e,t){this.caseQuery_=e,this.setValue(t)},e.prototype.setCaseAndColumn=function(e,t){return this.caseQuery_=e,this.setColumn(t),this},e.prototype.setColumn=function(e){return this.columnName_=e,this.caseColumnQuery_=this.caseQuery_[this.columnName_],this.length_=this.caseColumnQuery_.length,this},e.prototype.setValue=function(e){return this.value=e,this},e.prototype.evaluate=function(){for(var e=0;e<this.length_;e++)if(!0===this.checkCase_(this.caseColumnQuery_[e]))return this.caseColumnQuery_[e].then;var t=this.caseColumnQuery_[this.length_-1].then;return null==t?this.value[this.columnName_]:t},e.prototype.checkCase_=function(e){var t;for(t in e){switch(t){case a.GreaterThan:if(this.value[this.columnName_]>e[t])return!0;break;case a.Equal:if(this.value[this.columnName_]===e[t])return!0;break;case a.LessThan:if(this.value[this.columnName_]<e[t])return!0;break;case a.GreaterThanEqualTo:if(this.value[this.columnName_]>=e[t])return!0;break;case a.LessThanEqualTo:if(this.value[this.columnName_]<=e[t])return!0;break;case a.NotEqualTo:if(this.value[this.columnName_]!==e[t])return!0;break;case a.Between:if(this.value[this.columnName_]>e[t].low&&this.value[this.columnName_]<e[t].high)return!0}return!1}},e}(),Y=function(e,t,r,n){if(!1===this.limitAtEnd&&!1===this.skipAtEnd){if(this.skipRecord)return this.limitRecord?n:r;if(this.limitRecord)return t}return e},Z=function(e){var t=this,r=!1;return function(n){var o=n.target.result;o?r&&t.results.length!==t.limitRecord?(t.shouldAddValue(o)&&t.pushResult(o.value),o.continue()):(r=!0,o.advance(t.skipRecord)):e()}},ee=function(e){var t=this,r=!1;return function(n){var o=n.target.result;o?r?(t.shouldAddValue(o)&&t.pushResult(o.value),o.continue()):(r=!0,o.advance(t.skipRecord)):e()}},te=function(e){var t=this;return function(r){var n=r.target.result;n&&t.results.length!==t.limitRecord?(t.shouldAddValue(n)&&t.pushResult(n.value),n.continue()):e()}},re=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n)&&t.pushResult(n.value),n.continue()):e()}},ne=function(e){var t,r=this,n=!1;return function(o){(t=o.target.result)?n&&r.results.length!==r.limitRecord?(r.pushResult(t.value),t.continue()):(n=!0,t.advance(r.skipRecord)):e()}},oe=function(e){var t,r=this,n=!1;return function(o){(t=o.target.result)?n?(r.pushResult(t.value),t.continue()):(n=!0,t.advance(r.skipRecord)):e()}},ie=function(e){var t,r=this;return function(n){(t=n.target.result)?(r.pushResult(t.value),t.continue()):e()}},se=function(e){var t,r=this;return function(n){(t=n.target.result)&&r.results.length!==r.limitRecord?(r.pushResult(t.value),t.continue()):e()}},ae=function(e){return e.replace(/\s/g,"")},ue=function(e){var t;if(!this.query.store)if(null==this.query.join)t=this.getColumnInfo(e);else{var r=ae(e).split("."),n=r[1];t=this.getColumnInfo(n,r[0])}if(null==t){var o=this.results[0][e];if(o)return{dataType:q(o),name:e};throw new I(y,{column:e,isOrder:!0})}return t},ce=function(e,t){return t.localeCompare(e)},le=function(e,t){return e.localeCompare(t)},fe=function(e,t){return new String(t).localeCompare(e)},de=function(e,t){return new String(e).localeCompare(t)},pe=function(e,t){return t-e},he=function(e,t){return e-t},ye=function(e,t){return t.getTime()-e.getTime()},ve=function(e,t){return e.getTime()-t.getTime()},ge=function(e,t){switch(e.dataType){case o.String:return"asc"===t.type?le:ce;case o.Number:return"asc"===t.type?he:pe;case o.DateTime:return"asc"===t.type?ve:ye;default:return"asc"===t.type?de:fe}},be=function(e){var t;e.type=me(e.type);var r=e.by,n=this.thenEvaluator;if(null!=r&&typeof r===o.Object){var i=r,s=function(e,t){return function(r,s){for(var a in i){n.setCaseAndValue(i,r);var u=n.setColumn(a).evaluate();n.setCaseAndValue(i,s);var c=n.setColumn(a).evaluate();return typeof r[u]===o.String?e(r[u],s[c]):t(r[u],s[c])}}},a="asc"===e.type?s(le,he):s(ce,pe);this.results.sort(a)}else{var u=ue.call(this,r);if(null!=u){var c=ge(u,e);r=u.name,null==e.case?this.results.sort((function(e,t){return c(e[r],t[r])})):(n.setCaseAndColumn(((t={})[r]=e.case,t),r),this.results.sort((function(e,t){return c(n.setValue(e).evaluate(),n.setValue(t).evaluate())})))}}},me=function(e){return null==e?"asc":e.toLowerCase()},we=function(e){for(var t in e)return t},Se=function(e){var t,r,n=e.split("%");switch(n[1]?(t=n[1],r=n.length>2?c.Any:c.Last):(t=n[0],r=c.First),r){case c.First:return new RegExp("^".concat(t),"i");case c.Last:return new RegExp("".concat(t,"$"),"i");default:return new RegExp("".concat(t),"i")}},_e=function(e){return"object"===q(e)&&!(e instanceof RegExp)},Oe=function(e){if(_e(e)){var t={};for(var r in e)t[r]=null!=e[r]&&_e(e[r])?Oe(e[r]):e[r];return t}return e},Te=function(e,t,r){var n=q(e);if(n!==q(t))return!1;switch(n===o.DateTime&&(e=e.getTime(),t=t.getTime()),r){case a.GreaterThan:return e>t;case a.LessThan:return e<t;case a.LessThanEqualTo:return e<=t;case a.GreaterThanEqualTo:return e>=t;case a.NotEqualTo:return e!==t;default:var i;return"array"===n?e.length===t.length&&(e.every((function(e,r){return i=e===t[r]})),i):e===t}},Ce=function(){function e(e,t){this.where=Oe(e),this.checkFlag=t}return e.prototype.remove=function(e){var t=e.pop();delete e.reduce((function(e,t){return e&&e[t]}),this.where)[t]},e.prototype.check=function(e){var t=this,r=!0;if(!this.checkFlag)return r;var n=this.where,o=function(o){if(!r)return{value:r};var i=n[o],s=e[o],u=K(s),c=K(i),l=function(e){u&&!c?s.every((function(t){return!(r=e(t))})):r=e(s)};if("object"===q(i)){var f=function(e){if(!r)return{value:r};switch(e){case a.In:l((function(e){return t.checkIn(i[a.In],e)}));break;case a.Like:l((function(e){return t.checkLike_(o,e)}));break;case a.Regex:l((function(e){return t.checkRegex(o,e)}));break;case a.Between:case a.GreaterThan:case a.LessThan:case a.GreaterThanEqualTo:case a.LessThanEqualTo:case a.NotEqualTo:l((function(r){return t.checkComparisionOp_(o,r,e)}));break;default:r=!1}};for(var d in i){var p=f(d);if("object"==typeof p)return p}}else l((function(e){return Te(i,e)}))};for(var i in n){var s=o(i);if("object"==typeof s)return s.value}return r},e.prototype.checkIn=function(e,t){return null!=e.find((function(e){return Te(e,t)}))},e.prototype.checkLike_=function(e,t){return Se(this.where[e][a.Like]).test(t)},e.prototype.checkRegex=function(e,t){return this.where[e][a.Regex].test(t)},e.prototype.checkComparisionOp_=function(e,t,r){var n=this.where[e][r];return r!=a.Between?Te(t,n,r):Te(t,n.low,">=")&&Te(t,n.high,"<=")},e}(),xe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.limitAtEnd=!1,t.skipAtEnd=!1,t}return xe(t,e),t.prototype.goToWhereLogic=function(){var e=this,t=this.query,r=t.where,n=function(){for(var t in r)if(e.objectStore.indexNames.contains(t))return t}();if(null==n&&(n=we(r),!t.store))return N(new I(v,{column:n}));var o=r[n];if("object"!==q(o))return i=G(r)>1,this.whereChecker=new Ce(r,i),this.whereChecker.remove([n]),this.executeWhereLogic(n,o,null,"next");var i=G(o)>1||G(r)>1;this.whereChecker=new Ce(r,i);var s=we(o);switch(this.whereChecker.remove([n,s]),s){case a.Like:var u=Se(o[a.Like]);return this.executeRegexLogic(n,u);case a.Regex:return this.executeRegexLogic(n,o[a.Regex]);case a.In:return this.executeInLogic(n,o[a.In]);case a.Between:case a.GreaterThan:case a.LessThan:case a.GreaterThanEqualTo:case a.LessThanEqualTo:return this.executeWhereLogic(n,o,s,"next");case a.Aggregate:break;default:return this.executeWhereLogic(n,o,null,"next")}},t}(U),Ee=function(e,t){var r=this;return function(n){var o=n.target.result;r.results.length!==r.limitRecord&&o?(r.shouldAddValue(o)&&t(o.value),o.continue()):e()}},ke=function(e,t){var r=this;return function(n){var o=n.target.result;o?(r.shouldAddValue(o)&&t(o.value),o.continue()):e()}},Pe=function(){return Pe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Pe.apply(this,arguments)},je=function(){function e(e){this.joinQueryStack_=[],this.currentQueryStackIndex_=0,this.tablesFetched=[],this.results=[],this.select=e}return Object.defineProperty(e.prototype,"query",{get:function(){return this.select.query},enumerable:!1,configurable:!0}),e.prototype.getTable=function(e){return this.select.table(e)},e.prototype.executeSelect=function(e){return new Re(e,this.select.util).execute()},e.prototype.execute=function(){var e=this,t=this.query;this.joinQueryStack_=q(t.join)===o.Object?[t.join]:t.join;var r=t.from,n=[];r&&n.push(r);for(var i=this.joinQueryStack_,s=0,a=i.length;s<a;s++){var u=i[s],c=this.getJoinTableInfo_(u.on);u.with===c.table1.table&&(c={table1:c.table2,table2:c.table1});var l=this.checkJoinQuery_(c,u);if(l)return N(l);i[s].joinTableInfo=c,u.with&&n.push(u.with)}!this.select.isTxQuery&&n.length>0&&this.select.util.createTransaction(n);var f=t.where;if(f&&!t.store){var d=this.getTable(r),p=function(e){var t;if(Array.isArray(e))t=[],e=e.filter((function(e){var r=p(e);return Object.keys(r.whereQryAfterJoin).length>0&&t.push(r.whereQryAfterJoin),!r.isWhereEmpty}));else{t={};var r=function(r){if("or"===r){var n={},o=e[r],i=function(e){d.columns.find((function(t){return t.name===e}))||(n[e]=o[e])};for(var s in o)i(s);if(G(n)>0)for(var s in t.or=n,n)delete o[s]}else d.columns.find((function(e){return e.name===r}))||(t[r]=f[r])};for(var n in e)r(n);for(var n in t)delete e[n]}return{isWhereEmpty:0===G(e),whereQryAfterJoin:t,whereQueryModified:e}},h=p(f),y=h.whereQryAfterJoin;t.where=h.whereQueryModified,h.isWhereEmpty&&delete t.where;var v=this.joinQueryStack_[0];Object.assign(v.whereJoin,y)}return this.executeSelect({from:r,where:t.where,case:t.case,flatten:t.flatten,store:t.store,meta:t.meta}).then((function(t){return e.results=t.map((function(t){var r;return(r={})[e.currentQueryStackIndex_]=t,r})),e.tablesFetched.push(i[0].joinTableInfo.table1.table),e.startExecutingJoinLogic_()}))},e.prototype.onJoinQueryFinished_=function(){if(0!==this.results.length){var e=this.select;try{var t=[],r=H(this.results[0]).length;this.results.forEach((function(e){for(var n=e[0],o=1;o<r;o++)n=Pe(Pe({},n),e[o]);t.push(n)})),e.results=t,e.setLimitAndSkipEvaluationAtEnd_(),e.query.flatten=null,e.processOrderBy()}catch(e){return console.error(e),N(new I(T,e.message))}}},e.prototype.startExecutingJoinLogic_=function(){var e=this,t=this.joinQueryStack_[this.currentQueryStackIndex_];if(!t)return this.onJoinQueryFinished_();try{var r=t.joinTableInfo;return this.executeSelect({from:t.with,where:t.where,case:t.case,flatten:t.flatten,store:t.store,meta:t.meta}).then((function(n){return e.jointables(t,r,n),e.tablesFetched.push(r.table2.table),++e.currentQueryStackIndex_,e.startExecutingJoinLogic_()}))}catch(e){return console.error(e),N(new I(T,e.message))}},e.prototype.jointables=function(e,t,r){var n,o,i,s,a=e.type,u=[],c=t.table1.column,l=t.table2.column,f=this.tablesFetched.indexOf(t.table1.table),d=this.currentQueryStackIndex_+1,p=e.as,h=p?function(e){for(var t in p){var r=p[t];void 0===e[r]&&(e[r]=e[t],delete e[t])}return e}:function(e){return e},y=0,v=Object.assign({},e.whereJoin),g=new Ce(v,G(v)>0);"left"===a?(s={},e.store?H(e.store).forEach((function(e){s[e]=null})):this.getTable(t.table2.table).columns.forEach((function(e){s[e.name]=null})),o=1===d?function(e,t){return t[f][c]===e[l]}:function(e,t){var r=t[f];return null!=r&&r[c]===e[l]},i=function(){0===n.length&&(n=[s])}):(o=function(e,t){return t[f][c]===e[l]},i=function(){}),this.results.forEach((function(e){n=[],r.forEach((function(t){o(t,e)&&n.push(Pe({},t))})),i(),n.forEach((function(t){t=h(t),g.check(t)&&(u[y]=Pe({},e),u[y++][d]=t)}))})),this.results=u},e.prototype.getJoinTableInfo_=function(e){var t=(e=ae(e)).split("="),r=t[0].split("."),n=t[1].split(".");return{table1:{table:r[0],column:r[1]},table2:{table:n[0],column:n[1]}}},e.prototype.checkJoinQuery_=function(e,t){if(t.store)return null;var r,n=e.table1,o=e.table2,i=this.getTable(n.table),s=this.getTable(o.table);t.with!==o.table&&(r=new I(T,"The 'on' condition must reference a column from the table specified in 'with'. Found '".concat(t.on,"', but '").concat(t.with,"' was provided in 'with'."))),null==i.columns.find((function(e){return e.name===n.column}))?r=new I(T,"column ".concat(n.column," does not exist in table ").concat(n.table)):null==s.columns.find((function(e){return e.name===o.column}))&&(r=new I(T,"column ".concat(o.column," does not exist in table ").concat(o.table))),null==t.as&&(t.as={}),i.columns.every((function(e){var i=s.columns.find((function(t){return t.name===e.name&&t.name!==n.column}));return null==i||null!=t.as[i.name]||(r=new I(T,"column ".concat(e.name," exist in both table ").concat(n.table," & ").concat(o.table)),!1)}));var a=t.where;if(a){var u,c=function(e,t){var r=function(r){switch(r){case"or":case"in":break;default:s.columns.find((function(e){return e.name===r}))||(t[r]=e[r],delete e[r])}};for(var n in e)r(n)};Array.isArray(a)?(u=[],a=a.filter((function(e){var t={};return c(e,t),0!==G(t)&&u.push(t),0!==G(e)}))):c(a,u={}),0===G(a)&&(t.where=null),t.whereJoin=u}else t.whereJoin={};return r},e}(),Me=function(){function e(e){this.data=e}return Object.defineProperty(e.prototype,"indexNames",{get:function(){var e=H(this.data[0]);return{contains:function(t){return e.indexOf(t)>=0}}},enumerable:!1,configurable:!0}),e.prototype.index=function(e){var t=this;return{openCursor:function(r){var n={},o=0,i={continue:function(){++o,a()}},s=function(e){n.onsuccess({target:{result:e}})},a=function(){var n=t.data[o];if(n){var a=n[e];a&&(null==r||r.includes(a))?(i.key=a,i.value=n,s(i)):i.continue()}else s(null)};return f().then(a),n}}},e}(),Ie=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),De=function(){return De=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},De.apply(this,arguments)},Re=function(e){function t(t,r){var n=e.call(this)||this;n.sorted=!1,n.isSubQuery=!1,n.thenEvaluator=new X,n.returnResult_=function(){if(n.results.length>0){var e=n.query;if(e.flatten){var t=[],r=new Map;e.flatten.forEach((function(e){n.results.forEach((function(n,o){n[e].forEach((function(r){var o;t.push(De(De({},n),((o={})[e]=r,o)))})),r.set(o,!0)}))}));var o=0;r.forEach((function(e,t){n.results.splice(t-o,1),++o})),n.results=n.results.concat(t)}n.processGroupDistinctAggr(),n.processOrderBy(),n.skipAtEnd&&n.results.splice(0,e.skip),n.limitAtEnd&&(n.results=n.results.slice(0,e.limit))}return n.results},n.query=t,n.util=r,n.tableName=t.from,n.setPushResult(),K(t.where)?(n.isArrayQry=!0,n.setLimitAndSkipEvaluationAtEnd_()):(n.skipRecord=t.skip,n.limitRecord=t.limit);var o=t.order;return o?((K(o)||o.case||"object"==typeof o.by)&&(o.idbSorting=!1),n.setLimitAndSkipEvaluationAtEnd_()):t.groupBy&&n.setLimitAndSkipEvaluationAtEnd_(),n}return Ie(t,e),t.prototype.execute=function(e){var t=this;e||(e=function(){return f(null)});var r=this.query;try{var n=new W(this.db).validate(i.Select,r);return n?N(n):e().then((function(e){return t.initTransaction_(),(null==r.join?null!=r.where?K(r.where)?t.processWhereArrayQry():t.processWhere_():t.executeWhereUndefinedLogic():t.executeJoinQuery()).then(t.returnResult_.bind(t))}))}catch(e){return this.onException(e)}},t.prototype.processWhereArrayQry=function(){var e=this;this.isArrayQry=!0;var r,n=this.query.where,o=this.primaryKey(),i=!0,s=[],u=function(){var t;return r===a.And?!0===i?s=e.results:s.length>0&&(t=[],e.results.forEach((function(e){var r;r=e[o],s.findIndex((function(e){return e[o]===r}))>=0&&t.push(e)})),s=t,t=null):(s.length>0&&e.mergeWithResults(s),s=e.results),i=!1,n.length>0?(e.results=[],l()):(e.results=s,f())},c=function(r){return new t({from:e.query.from,where:r},e.util).execute().then((function(t){return e.results=t,u()}))},l=function(){var t=n.shift(),o=t[a.Or];if(o){if(K(o))return r=a.Or,c(o);1===G(t)?(r=a.Or,t=o):r=a.And}else if(r=a.And,K(t))return c(t);return e.query.where=t,e.processWhere_().then(u)};return l()},t.prototype.initTransaction_=function(){var e=this.query.store;e?this.objectStore=new Me(e):(this.isTxQuery||this.util.createTransactionIfNotExist([this.tableName],u.ReadOnly),this.objectStore=this.util.objectStore(this.tableName))},t.prototype.processWhere_=function(){var e=this;return this.shouldAddValue=function(t){var r=t.value,n=e,o=new Proxy(r,{get:function(e,t,o){var i=r[t];if(!i){var s=n.getColumnInfo(t);if(s&&s.keyPath)return s.keyPath.map((function(e){return r[e]}))}return i}});return e.whereChecker.check(o)},this.query.where.or&&this.processOrLogic_(),this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))},t.prototype.onWhereEvaluated=function(){if(this.isOr)return this.orQuerySuccess_()},t.prototype.orQuerySuccess_=function(){var e=this,r=this.query,n=this.orInfo;return this.results.length>0&&this.mergeWithResults(n.results),new t({where:n.orQuery,from:r.from,case:r.case,store:r.store,meta:r.meta},this.util).execute().then((function(t){e.mergeWithResults(t),e.isOr=!1,e.orInfo=null}))},t.prototype.processOrLogic_=function(){this.isOr=!0;var e=this.query.where;this.orInfo={orQuery:e.or,results:[]},this.setLimitAndSkipEvaluationAtEnd_(),delete e.or},t}(Ae);function Ne(e){var t=1===G(e);if(t){var r=we(e);t=1===G(e[r])}return t}Re.prototype.executeInLogic=function(e,t){var r=this,n=this.skipRecord,o=function(e){0===n?r.pushResult(e):--n},i=Y.call(this,re,te,ke,Ee);return R(t.map((function(t){return d((function(n,s){var a=r.objectStore.index(e).openCursor(r.util.keyRange(t));a.onsuccess=i.call(r,n,o),a.onerror=s}))})))},Re.prototype.executeWhereUndefinedLogic=function(){var e,t=this,r=this.query,n=r.store;if(n)return this.results=n,this.setLimitAndSkipEvaluationAtEnd_(),f();var o=r.order,i=this.objectStore;if(o&&!1!==o.idbSorting&&o.by){if(!i.indexNames.contains(o.by))return N(new I(y,{column:o.by,isOrder:!0}));var s=o.type&&"desc"===o.type.toLowerCase()?"prev":"next";this.sorted=!0,e=i.index(o.by).openCursor(null,s)}else e=i.openCursor();var a=Y.call(this,ie,se,oe,ne);return d((function(r,n){e.onerror=n,e.onsuccess=a.call(t,r)}))},Re.prototype.executeWhereLogic=function(e,t,r,n){var o=this;t=r?t[r]:t;var i=this.objectStore.index(e).openCursor(this.util.keyRange(t,r),n),s=Y.call(this,re,te,ee,Z);return d((function(e,t){i.onerror=t,i.onsuccess=s.call(o,e)}))},Re.prototype.executeRegexLogic=function(e,t){var r=this,n=this.skipRecord,o=function(e){0===n?r.pushResult(e):--n};this.shouldAddValue=function(e){return t.test(e.key)&&r.whereChecker.check(e.value)};var i=this.objectStore.index(e).openCursor(),s=Y.call(this,re,te,ke,Ee);return d((function(e,t){i.onerror=t,i.onsuccess=s.call(r,e,o)}))},Re.prototype.setLimitAndSkipEvaluationAtEnd_=function(){this.query.limit&&(this.limitAtEnd=!0),this.query.skip&&(this.skipAtEnd=!0)},Re.prototype.setPushResult=function(){var e=this,t=this.query.case;this.pushResult=t?function(r){var n;for(n in e.thenEvaluator.setCaseAndValue(t,r),t)r[n]=e.thenEvaluator.setColumn(n).evaluate();e.results.push(r)}:function(t){e.results.push(t)}},Re.prototype.mergeWithResults=function(e){var t=this.results,r=this.primaryKey(),n=new Map;t.forEach((function(e){n.set(e[r],1)})),e.forEach((function(e){n.has(e[r])||t.push(e)}))},Re.prototype.executeJoinQuery=function(){return new je(this).execute()},Re.prototype.processGroupDistinctAggr=function(){var e=this.query;if(e.distinct){var t=[],r=this.results[0];for(var n in r)t.push(n);var o=this.primaryKey(),i=t.indexOf(o);t.splice(i,1),e.groupBy=t.length>0?t:null}e.groupBy?e.aggregate?this.executeAggregateGroupBy():this.processGroupBy():e.aggregate&&this.processAggregateQry()},Re.prototype.processOrderBy=function(){var e=this.query.order;if(e&&this.results.length>0&&!this.sorted){var t=q(e);if(t===o.Object)be.call(this,e);else if(t===o.Array){be.call(this,e[0]);for(var r=function(t,r){var o=e[t-1].by,i=e[t],s=i.by,a=ue.call(n,s);if(null!=a){s=a.name,i.type=me(i.type);var u=ge(a,i);n.results.sort((function(e,t){return e[o]===t[o]?u(e[s],t[s]):0}))}},n=this,i=1,s=e.length;i<s;i++)r(i)}}},Re.prototype.processAggregateQry=function(){var e,t=this.results,r=t.length,n={},i=function(){var r=0;for(var n in t)r+=t[n][e]?1:0;return r},s=function(){var r=0;for(var n in t)r=r>t[n][e]?r:t[n][e];return r},a=function(){var r=1/0,n=1/0;for(var o in t)r=r<(n=t[o][e]?t[o][e]:1/0)?r:n;return r},u=function(){var r=0;for(var n in t)r+=t[n][e];return r},c=function(){return u()/r},l=this.query.aggregate;for(var f in l){var d=l[f],p=q(d),h=void 0;switch(f){case"count":h=i;break;case"max":h=s;break;case"min":h=a;break;case"sum":h=u;break;case"avg":h=c}switch(p){case o.String:e=d,n["".concat(f,"(").concat(e,")")]=h();break;case o.Array:for(var y in d)e=d[y],n["".concat(f,"(").concat(e,")")]=h()}}for(var f in n)t[0][f]=n[f];this.results=[t[0]]},Re.prototype.executeAggregateGroupBy=function(){var e,t,r,n,i=this.query.groupBy,s=this.results,u=new Map,c=this.query.aggregate,l=function(){var i=function(){return r=(r=u.get(t))?r["count("+n+")"]:0,r+=s[e][n]?1:0},l=function(){return(r=(r=u.get(t))?r["list("+n+")"]:[]).push(s[e][n]),r},f=function(){return r=(r=u.get(t))?r["max("+n+")"]:0,s[e][n]=s[e][n]?s[e][n]:0,r>s[e][n]?r:s[e][n]},d=function(){return r=(r=u.get(t))?r["min("+n+")"]:1/0,s[e][n]=s[e][n]?s[e][n]:1/0,r<s[e][n]?r:s[e][n]},p=function(){return r=(r=u.get(t))?r["sum("+n+")"]:0,r+=s[e][n]?s[e][n]:0},h=function(){var o=(r=u.get(t))?r["sum("+n+")"]:0;o+=s[e][n]?s[e][n]:0,s[e]["sum("+n+")"]=o,r=r?r["count("+n+")"]:0,r+=s[e][n]?1:0,s[e]["count("+n+")"]=r};for(var y in c){var v=c[y],g=q(v),b=void 0;switch(y){case a.Count:b=i;break;case a.Max:b=f;break;case a.Min:b=d;break;case a.Sum:b=p;break;case a.Avg:b=h;break;case a.List:b=l}switch(g){case o.String:n=v,s[e]["".concat(y,"(").concat(n,")")]=b();break;case o.Array:for(var m in v)n=v[m],s[e]["".concat(y,"(").concat(n,")")]=b()}}};if(q(i)===o.String)for(e in s)t=s[e][i],l(),u.set(t,s[e]);else for(e in s){for(var f in t="",i)t+=s[e][i[f]];l(),u.set(t,s[e])}s=Array.from(u.values());var d=c.avg;if(d)if(q(d)===o.String)for(e in s){var p=s[e]["sum("+d+")"],h=s[e]["count("+d+")"];s[e]["avg("+d+")"]=p/h,c.count!==d&&delete s[e]["count("+d+")"],c.sum!==d&&delete s[e]["sum("+d+")"]}else{var y=q(c.count)===o.String,v=q(c.sum)===o.String;for(e in s)for(var f in d){var g=d[f],b=s[e]["sum("+g+")"],m=s[e]["count("+g+")"];s[e]["avg("+g+")"]=b/m,y&&(c.count!==g||-1===c.count.indexOf(g))&&delete s[e]["count("+g+")"],v&&(c.sum!==g||-1===c.sum.indexOf(g))&&delete s[e]["sum("+g+")"]}}this.results=s},Re.prototype.processGroupBy=function(){var e=this.query.groupBy,t=this.results,r=new Map,n=q(e);if(n!==o.Object)if(n===o.String)for(var i in t)r.set(t[i][e],t[i]);else{var s=void 0;for(var i in t){for(var a in s="",e)s+=t[i][e[a]];r.set(s,t[i])}}else if(1===Object.keys(e).length){var u=we(e);for(var i in this.thenEvaluator.setCaseAndColumn(e,u),t)r.set(this.thenEvaluator.setValue(t[i]).evaluate(),t[i])}else for(var i in s=void 0,t){for(var a in s="",this.thenEvaluator.setCaseAndValue(e,t[i]),e)s+=this.thenEvaluator.setColumn(a).evaluate();r.set(s,t[i])}this.results=Array.from(r.values())};var Be=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n)&&++t.resultCount,n.continue()):e()}},Ue=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qe=function(e){function t(t,r){var n=e.call(this)||this;return n.resultCount=0,n.query=t,n.util=r,n.tableName=t.from,n}return Ue(t,e),t.prototype.execute=function(e){var t=this,r=new W(this.db),n=this.query,o=r.validate(i.Count,n);return o?N(o):e().then((function(e){var r;try{var o=function(){var e=new Re(n,t.util);return e.isTxQuery=t.isTxQuery,e.execute().then((function(e){t.resultCount=e.length}))};t.initTransaction_(),null==n.join?null!=n.where?n.where.or||K(n.where)?r=o():(t.shouldAddValue=function(e){return t.whereChecker.check(e.value)},r=t.goToWhereLogic()):r=t.executeWhereUndefinedLogic():r=o()}catch(e){t.onException(e)}return r.then((function(e){return t.resultCount}))}))},t.prototype.initTransaction_=function(){var e=this.query.from;this.isTxQuery||this.util.createTransaction([e],u.ReadOnly),this.objectStore=this.util.objectStore(e)},t}(Ae);qe.prototype.executeWhereUndefinedLogic=function(){var e,t,r=this,n=this.objectStore,o=n.count?(e=n.count(),function(t){return function(){r.resultCount=e.result,t()}}):(e=n.openCursor(),function(e){return function(n){(t=n.target.result)?(++r.resultCount,t.continue()):e()}});return d((function(t,r){e.onerror=r,e.onsuccess=o(t)}))},qe.prototype.executeWhereLogic=function(e,t,r){var n,o=this;t=r?t[r]:t;var i=Ne(this.query.where),s=this.objectStore;return d((function(a,u){i&&s.count?(n=s.index(e).count(o.util.keyRange(t,r))).onsuccess=function(){o.resultCount=n.result,a()}:(n=s.index(e).openCursor(o.util.keyRange(t,r))).onsuccess=Be.call(o,a),n.onerror=u}))},qe.prototype.executeRegexLogic=function(e,t){var r=this,n=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&r.whereChecker.check(e.value)},d((function(e,t){n.onerror=t,n.onsuccess=Be.call(r,e)}))},qe.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore,o=n.index(e),i=Ne(this.query.where);return R(t.map((function(e){return t=e,s=r.util.keyRange(t),i&&n.count?d((function(e,t){var n=o.count(s);n.onsuccess=function(t){r.resultCount+=t.target.result,e()},n.onerror=t})):d((function(e,t){var n=o.openCursor(s);n.onsuccess=Be.call(r,e),n.onerror=t}));var t,s})))};var Fe=function(e){return(K(e)?e:e.split(".")).reduce((function(e,t){return e&&e[t]}),self)},$e=function(e,t){var r=e.set,n=e.mapSet;if(n){var i=n(r,t);null!=i&&(r=i)}for(var s in r){var a=r[s];if(q(a)!==o.Object)t[s]=a;else for(var u in a){var c=a[u];switch(u){case"+":t[s]+=c;break;case"-":t[s]-=c;break;case"*":t[s]*=c;break;case"/":t[s]/=c;break;case"{push}":t[s].push(c);break;default:t[s]=a}break}}return t},Le=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),We=function(e){function t(t,r){var n=e.call(this)||this;t.returnImmediate=null!=t.returnImmediate&&t.returnImmediate,n.query=t,n.util=r,n.tableName=t.in;var i=t.mapSet;if(i){var s=q(i)===o.String?Fe(i):i;if(!s)throw new I(x,i);t.mapSet=s}return n}return Le(t,e),t.prototype.execute=function(e){var t=this,r=this.query;try{var n=new W(this.db).validate(i.Update,r);return n?N(n):e().then((function(e){var n=t.initTransaction(),o=[null!=r.where?r.where.or||K(r.where)?t.executeComplexLogic_():t.goToWhereLogic():t.executeWhereUndefinedLogic()];return!1===r.returnImmediate&&n&&o.push(n),R(o).then((function(){return t.rowAffected}))}))}catch(e){return this.onException(e)}},t.prototype.executeComplexLogic_=function(){var e=this,t=this.query,r=new Re({from:t.in,where:t.where,ignoreCase:t.ignoreCase},this.util);return r.isTxQuery=this.isTxQuery,r.execute().then((function(r){var n,o,i=e.primaryKey(t.in),s=[];r.forEach((function(e){s.push(e[i])})),r=null;var u=((n={})[i]=((o={})[a.In]=s,o),n);return e.query.where=u,e.goToWhereLogic()}))},t.prototype.initTransaction=function(){var e,t=this.query.in;return this.isTxQuery||(e=this.util.createTransaction([t])),this.objectStore=this.util.objectStore(t),e},t}(Ae);We.prototype.executeWhereUndefinedLogic=function(){var e=this,t=this.objectStore.openCursor();return d((function(r,n){t.onsuccess=function(t){var o=t.target.result;if(o)try{var i=o.update($e(e.query,o.value));i.onsuccess=function(){++e.rowAffected,o.continue()},i.onerror=n}catch(e){n(e)}else r()},t.onerror=n}))},We.prototype.executeWhereLogic=function(e,t,r){var n=this,o=this.query;t=r?t[r]:t;var i=this.objectStore.index(e).openCursor(this.util.keyRange(t,r));return d((function(e,t){i.onsuccess=function(r){var i=r.target.result;if(i)if(n.whereChecker.check(i.value))try{var s=i.update($e(o,i.value));s.onsuccess=function(){++n.rowAffected,i.continue()},s.onerror=t}catch(e){t(e)}else i.continue();else e()},i.onerror=t}))},We.prototype.executeRegexLogic=function(e,t){var r,n=this,o=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&n.whereChecker.check(e.value)},d((function(e,t){o.onsuccess=function(o){if(r=o.target.result)if(n.shouldAddValue(r))try{var i=r.update($e(n.query,r.value));i.onsuccess=function(){++n.rowAffected,r.continue()},i.onerror=t}catch(e){t(e)}else r.continue();else e()},o.onerror=t}))},We.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore.index(e),o=this.query;return R(t.map((function(e){return t=e,d((function(e,i){var s=n.openCursor(r.util.keyRange(t));s.onsuccess=function(t){var n=t.target.result;if(n){var s=n.value;if(r.whereChecker.check(s))try{var a=n.update($e(o,s));a.onsuccess=function(){++r.rowAffected,n.continue()},a.onerror=i}catch(e){i(e)}else n.continue()}else e()},s.onerror=i}));var t})))};var Qe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ve=function(){return Ve=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ve.apply(this,arguments)},ze=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n}return Qe(t,e),t.prototype.execute=function(){var e,t,r=this,n=this.query,o=0,i={},s={},a=!0,u=n.queries,c=u.length;if(u.every((function(e,t){return!(t+1<c&&e.from!==u[t+1].from&&(a=!1,1))})),a){var l=this.primaryKey(u[0].from);e=function(e){return e[l]}}else e=function(e){var t="";for(var r in e)t+=e[r];return t};var f=function(){if(o<c)return(t=new Re(u[o],r.util)).execute().then((function(t){return i={},t.forEach((function(t){var r=e(t);0===o?s[r]=t:null!=s[r]&&(i[r]=t)})),o>0&&(s=Ve({},i)),++o,f()}));var a,l=[],d=void 0,p=n.skip,h=n.limit,y=!1,v=function(){l.push(i[a])},g=function(){l.length<h?v():y=!0},b=function(e){0===p?e():--p};if(d=n.skip&&n.limit?function(){b((function(){g()}))}:n.limit?g:n.skip?function(){b((function(){v()}))}:function(){v()},h){for(a in i)if(d(a),y)break}else for(a in i)d(a);return t.results=l,Object.assign(t.query,{order:n.order,join:{}}),t.processOrderBy(),t.processGroupDistinctAggr(),t.results};return f()},t}(U),Je=function(){function e(){}return e.prototype.execute=function(e){return d((function(t,r){var n=indexedDB.deleteDatabase(e);n.onblocked=function(){var e=new I(S);return r(B(e))},n.onerror=function(e){return r(B(e))},n.onsuccess=function(){t()}}))},e}(),Ke=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),He=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n}return Ke(t,e),t.prototype.execute=function(){var e,t=this,r=this.query,n=0,o=new Map,i=!0,s=r.length;if(r.every((function(e,t){return!(t+1<s&&e.from!==r[t+1].from&&(i=!1,1))})),i){var a=this.primaryKey(r[0].from);e=function(e){return e[a]}}else e=function(e){var t="";for(var r in e)t+=e[r];return t};var u=function(){return n<r.length?new Re(r[n++],t.util).execute().then((function(t){return t.forEach((function(t){o.set(e(t),t)})),u()})):Array.from(o.values())};return u()},t}(U),Ge=function(e){var t=this;return function(r){var n=r.target.result;n?(t.shouldAddValue(n.value)&&(n.delete(),++t.rowAffected),n.continue()):e()}},Xe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ye=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n.tableName=t.from,n}return Xe(t,e),t.prototype.execute=function(e){var t,r=this,n=new W(this.db),o=this.query,s=n.validate(i.Remove,o);return s?N(s):e().then((function(e){try{r.initTransaction_(),t=null!=o.where?K(o.where)?r.processWhereArrayQry():r.processWhere_():r.executeWhereUndefinedLogic()}catch(e){return r.onException(e)}return t.then((function(){return r.rowAffected}))}))},t.prototype.processWhereArrayQry=function(){var e=this,t=new Re(this.query,this.util);return t.isTxQuery=this.isTxQuery,t.execute().then((function(t){var r,n,o=[],i=e.primaryKey(e.query.from);t.forEach((function(e){o.push(e[i])})),t=null;var s=((r={})[i]=((n={})[a.In]=o,n),r);return e.query[a.Where]=s,e.processWhere_()}))},t.prototype.processWhere_=function(){var e=this;return this.shouldAddValue=function(t){return e.whereChecker.check(t)},this.query.where.or&&this.processOrLogic(),this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))},t.prototype.initTransaction_=function(){this.isTxQuery||this.util.createTransaction([this.query.from]),this.objectStore=this.util.objectStore(this.query.from)},t.prototype.onWhereEvaluated=function(){if(this.isOr)return this.orQuerySuccess_()},t.prototype.orQuerySuccess_=function(){var e=this,t=this._orInfo.OrQuery,r=we(t);if(null!=r){var n={};return n[r]=t[r],delete t[r],this.query.where=n,this.goToWhereLogic().then((function(){return e.onWhereEvaluated()}))}this.isOr=!0},t.prototype.processOrLogic=function(){this.isOr=!0;var e=this.query.where;this._orInfo={OrQuery:e.or},delete e.or},t}(Ae);Ye.prototype.executeInLogic=function(e,t){var r=this,n=this.objectStore.index(e);return R(t.map((function(e){return t=e,d((function(e,o){var i=n.openCursor(r.util.keyRange(t));i.onsuccess=Ge.call(r,e),i.onerror=o}));var t})))},Ye.prototype.executeWhereUndefinedLogic=function(){var e,t=this,r=this.objectStore.openCursor();return d((function(n,o){r.onsuccess=function(r){(e=r.target.result)?(e.delete(),++t.rowAffected,e.continue()):n()},r.onerror=o}))},Ye.prototype.executeWhereLogic=function(e,t,r){var n=this;t=r?t[r]:t;var o=this.objectStore.index(e).openCursor(this.util.keyRange(t,r));return d((function(e,t){o.onsuccess=Ge.call(n,e),o.onerror=t}))},Ye.prototype.executeRegexLogic=function(e,t){var r,n=this,o=this.objectStore.index(e).openCursor();return this.shouldAddValue=function(e){return t.test(e.key)&&n.whereChecker.check(e.value)},d((function(e,t){o.onsuccess=function(t){(r=t.target.result)?(n.shouldAddValue(r)&&(r.delete(),++n.rowAffected),r.continue()):e()},o.onerror=t}))};var Ze=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),et=function(e){function t(t,r){var n=e.call(this)||this;return n.query=t,n.util=r,n.tableName=t,n}return Ze(t,e),t.prototype.execute=function(e){var t=this,r=this.query;return this.isTxQuery||this.util.createTransaction([r,P.tableName]),e().then((function(e){var n=t.util.objectStore(r).clear();try{return d((function(e,o){n.onsuccess=function(n){var i=t.table(r);for(var s in i.autoIncColumnValue)i.autoIncColumnValue[s]=0;P.set(P.dbSchema,t.util.db,t.util).then(e).catch(o)},n.onerror=o}))}catch(e){return t.onException(e)}}))},t}(U),tt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),rt=function(e){function t(t,r){var n=e.call(this)||this;return n.results={},n.reqQueue=[],n.isQueryExecuting=!1,n.isTxStarted_=!1,n.query=t,n.util=r,n}return tt(t,e),t.prototype.execute=function(e){var t=this;this.beforeExecute=e;var r=this.validate();return r?N(r):(this.startExecution_(),d((function(e,r){t.onSuccess=e,t.onError=r})).then((function(e){return t.beforeExecute=null,t.log("transaction finished"),e})))},t.prototype.validate=function(){var e=this.query,t=this.notExistingTable_(e.tables);if(t)return new I(m,{tableName:t});var r=e.method;return Fe(r)?void 0:new I(x,r)},t.prototype.startExecution_=function(){var e=this,t=this.query,r=function(t){return function(r){return e.pushReq_({name:t,query:r})}},n=t.method,o=Fe(n);return this.log("transaction query started"),o.call(this,{data:t.data,insert:r(i.Insert),select:r(i.Select),update:r(i.Update),remove:r(i.Remove),count:r(i.Count),setResult:function(t,r){e.results[t]=r},getResult:function(t){return e.results[t]},abort:function(t){e.abortTx_(t)},start:function(){e.startTx_()}})},t.prototype.log=function(e){this.util.logger.log(e)},t.prototype.startTx_=function(){var e=this;try{this.isTxStarted_=!0;var t=this.query.tables;return t=t.concat(P.tableName),this.util.createTransaction(t).then((function(t){e.onSuccess(e.results)})).catch((function(t){e.onError(t)})),this.processExecutionOfQry_()}catch(e){this.onError(this.onException(e))}},t.prototype.onReqFinished_=function(e){var t=this.reqQueue.shift();this.log("finished request : ".concat(t.name," ")),t&&(e.error?(this.abortTx_("automatic abort of transaction due to error occured"),this.log("transaction aborted due to error occured"),this.onError(e.error)):(this.isQueryExecuting=!1,t.onSuccess&&t.onSuccess(e),this.processExecutionOfQry_()))},t.prototype.abortTx_=function(e){this.reqQueue=[],this.util.abortTransaction(),this.log("transaction aborted. Msg : ".concat(e))},t.prototype.executeRequest_=function(e){var t,r=this;this.isQueryExecuting=!0,this.log("executing request : ".concat(e.name," "));var n=this.onReqFinished_.bind(this),o=e.query,s=function(e){o.returnImmediate=!0,t=new e(o,r.util)};switch(e.name){case i.Select:s(Re);break;case i.Insert:s(V);break;case i.Update:s(We);break;case i.Remove:s(Ye);break;case i.Count:s(qe)}t.isTxQuery=!0,t.execute(this.beforeExecute).then(n).catch((function(e){n({error:e})}))},t.prototype.pushReq_=function(e){var t=d((function(t,r){e.onSuccess=function(e){t(e)},e.onError=function(e){r(e)}}));return this.reqQueue.push(e),!0===this.isTxStarted_&&this.processExecutionOfQry_(),this.log("request pushed : ".concat(e.name)),t},t.prototype.processExecutionOfQry_=function(){!1===this.isQueryExecuting&&this.reqQueue.length>0&&this.executeRequest_(this.reqQueue[0])},t.prototype.notExistingTable_=function(e){var t=this,r=null;return e.every((function(e){return null!=t.table(e)||(r=e,!1)})),r},t}(U),nt=function(e){if(null==e)throw new Error("userDbSchema db is null");var t={name:e.name,version:e.version,tables:[]};return e.tables.forEach((function(e){var r={name:e.name,columns:{}};e.columns.forEach((function(e){r.columns[e.name]=e})),t.tables.push(r)})),t},ot=function(){function e(e){this.middlewares=[],this.util=new D,this.onQryFinished=z?function(e){self.postMessage(e)}:e}return Object.defineProperty(e.prototype,"db",{get:function(){return this.util.db},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this.util.logger},enumerable:!1,configurable:!0}),e.prototype.executeMiddleware_=function(e){var t=this,r=G(this.middlewares)-1;if(r<0)return f();var n={},o=this.db;return Object.defineProperty(n,"database",{get:function(){return nt(o)}}),d((function(o){var i=0,s=function(){if(i<=r){var a=Fe(t.middlewares[i++])(e,n);a&&a.then||(a=Promise.resolve(a)),a.then((function(e){s()}))}else o()};s()}))},e.prototype.executeQuery=function(e,t){var r,n=e.query,o=this,s=o.util,a=function(e,t){r=new e(n,s).execute(t)};switch(e.name){case i.OpenDb:t(),r=o.openDb(n);break;case i.InitDb:t(),r=o.initDb(n);break;case i.CloseDb:t(),r=o.closeDb();break;case i.Insert:a(V,t);break;case i.Select:a(Re,t);break;case i.Count:a(qe,t);break;case i.Update:a(We,t);break;case i.Intersect:t(),a(ze);break;case i.DropDb:t(),r=o.dropDb();break;case i.Terminate:t(),r=o.terminate();break;case i.Union:t(),a(He);break;case i.Remove:a(Ye,t);break;case i.Clear:a(et,t);break;case i.Transaction:a(rt,t);break;case i.MapGet:t(),r=P.get(n,s);break;case i.MapSet:t(),r=P.set(n.key,n.value,s);break;case i.MapHas:t(),r=P.has(n,s);break;case i.MapDelete:t(),r=P.remove(n,s);break;case i.ImportScripts:t(),r=o.importScripts_(e);break;case i.ChangeLogStatus:t(),o.logger.status=n,r=Promise.resolve();break;case i.Middleware:return t(),Fe(n)?(o.middlewares.push(n),f()):N(new I(A,n));default:r=f()}return o.logger.log("Executing query ".concat(e.name," in web worker")),r},e.prototype.callMiddleware_=function(e,t){return d((function(r){var n=0,o=G(e)-1,i=function(){if(n<=o){var s=e[n++](t);s instanceof Promise||(s=f(s)),s.then((function(e){t=e,i()}))}else r(t)};i()}))},e.prototype.run=function(e){var t=this,r=[],n=[];e.onResult=function(e){r.push((function(t){return e(t)}))},e.beforeExecute=function(e){n.push((function(t){return e(t)}))},this.executeMiddleware_(e).then((function(o){return t.executeQuery(e,(function(){return t.callMiddleware_(n)})).then((function(e){return t.callMiddleware_(r,e).then((function(e){t.returnResult_({result:e})}))}))})).catch((function(e){r=[];var n={error:B(e)};t.returnResult_(n)}))},e.prototype.importScripts_=function(e){return d((function(t,r){try{importScripts.apply(void 0,e.query),t()}catch(e){r(new I(C,e.message))}}))},e.prototype.returnResult_=function(e){this.logger.log("Query finished inside web worker"),this.util&&this.util.emptyTx(),this.onQryFinished(e)},e.prototype.dropDb=function(){var e=this.db.name;return this.terminate().then((function(){return(new Je).execute(e)}))},e.prototype.closeDb=function(){return this.util.close()},e.prototype.terminate=function(){var e=this;return this.closeDb().then((function(){e.util.db=null}))},e.prototype.openDb=function(e){var t=this;return this.closeDb().then((function(r){return(t.db&&e.name===t.db.name?t.initDb():t.initDb({name:e.name,tables:[],version:e.version})).then((function(){return t.db}))}))},e.prototype.initDb=function(e){var t=this;if(!J)return N(new I(_));var r=e?new j(e):this.db;if(null==r)throw new Error("dbMeta is null");return this.util=new D,this.util.initDb(r).then((function(e){return P.get(P.dbSchema,t.util).then((function(n){return e.isCreated?(n&&n.tables.forEach((function(e){var t=r.tables.find((function(t){return t.name===e.name}));if(t)for(var n in e.autoIncColumnValue){var o=e.autoIncColumnValue[n];o&&(t.autoIncColumnValue[n]=o)}})),t.util.db=r,e.database=nt(t.db),P.set(P.dbSchema,r,t.util).then((function(){return e}))):P.get(P.dbSchema,t.util).then((function(r){return t.util.db=r,e.database=nt(t.db),e}))}))}))},e}();if(z){var it=new ot;self.onmessage=function(e){it.run(e.data)}}e.exports=r})()},1124:(e,t,r)=>{e.exports={setup(e,t){e.$worker=r(7130),e.initQueryManager_()}}},9426:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(1635),o=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,n=e._value;if(t)throw r;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(r(7291).B)},8483:(e,t,r)=>{"use strict";r.d(t,{c:()=>l});var n=r(5508),o=r(2616),i=r(5604),s=r(1485),a=r(4384),u=r(1209),c=r(7008),l=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var i,s=this,a=(i=e)&&i instanceof n.vU||function(e){return e&&(0,u.T)(e.next)&&(0,u.T)(e.error)&&(0,u.T)(e.complete)}(i)&&(0,o.Uv)(i)?e:new n.Ms(e,t,r);return(0,c.Y)((function(){var e=s,t=e.operator,r=e.source;a.add(t?t.call(a,r):r?s._subscribe(a):s._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=f(t))((function(t,o){var i=new n.Ms({next:function(t){try{e(t)}catch(e){o(e),i.unsubscribe()}},error:o,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[i.s]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,s.m)(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=f(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function f(e){var t;return null!==(t=null!=e?e:a.$.Promise)&&void 0!==t?t:Promise}},9741:(e,t,r)=>{"use strict";r.d(t,{m:()=>s});var n=r(1635),o=r(7291),i=r(1179),s=function(e){function t(t,r,n){void 0===t&&(t=1/0),void 0===r&&(r=1/0),void 0===n&&(n=i.U);var o=e.call(this)||this;return o._bufferSize=t,o._windowTime=r,o._timestampProvider=n,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,t),o._windowTime=Math.max(1,r),o}return(0,n.C6)(t,e),t.prototype.next=function(t){var r=this,n=r.isStopped,o=r._buffer,i=r._infiniteTimeWindow,s=r._timestampProvider,a=r._windowTime;n||(o.push(t),!i&&o.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),r=this._infiniteTimeWindow,n=this._buffer.slice(),o=0;o<n.length&&!e.closed;o+=r?1:2)e.next(n[o]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,r=e._timestampProvider,n=e._buffer,o=e._infiniteTimeWindow,i=(o?1:2)*t;if(t<1/0&&i<n.length&&n.splice(0,n.length-i),!o){for(var s=r.now(),a=0,u=1;u<n.length&&n[u]<=s;u+=2)a=u;a&&n.splice(0,a+1)}},t}(o.B)},7291:(e,t,r)=>{"use strict";r.d(t,{B:()=>c});var n=r(1635),o=r(8483),i=r(2616),s=(0,r(2947).L)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),a=r(6174),u=r(7008),c=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,n.C6)(t,e),t.prototype.lift=function(e){var t=new l(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new s},t.prototype.next=function(e){var t=this;(0,u.Y)((function(){var r,o;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,n.Ju)(t.currentObservers),s=i.next();!s.done;s=i.next()){s.value.next(e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.Y)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.Y)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,o=r.isStopped,s=r.observers;return n||o?i.Kn:(this.currentObservers=null,s.push(e),new i.yU((function(){t.currentObservers=null,(0,a.o)(s,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,o=t.isStopped;r?e.error(n):o&&e.complete()},t.prototype.asObservable=function(){var e=new o.c;return e.source=this,e},t.create=function(e,t){return new l(e,t)},t}(o.c),l=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return(0,n.C6)(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:i.Kn},t}(c)},5508:(e,t,r)=>{"use strict";r.d(t,{Ms:()=>g,vU:()=>p});var n=r(1635),o=r(1209),i=r(2616),s=r(4384),a=r(2564),u=r(2357),c=l("C",void 0,void 0);function l(e,t,r){return{kind:e,value:t,error:r}}var f=r(6744),d=r(7008),p=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,(0,i.Uv)(t)&&t.add(r)):r.destination=w,r}return(0,n.C6)(t,e),t.create=function(e,t,r){return new g(e,t,r)},t.prototype.next=function(e){this.isStopped?m(function(e){return l("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?m(l("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?m(c,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(i.yU),h=Function.prototype.bind;function y(e,t){return h.call(e,t)}var v=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){b(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){b(e)}else b(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){b(e)}},e}(),g=function(e){function t(t,r,n){var i,a,u=e.call(this)||this;(0,o.T)(t)||!t?i={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:u&&s.$.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},i={next:t.next&&y(t.next,a),error:t.error&&y(t.error,a),complete:t.complete&&y(t.complete,a)}):i=t;return u.destination=new v(i),u}return(0,n.C6)(t,e),t}(p);function b(e){s.$.useDeprecatedSynchronousErrorHandling?(0,d.l)(e):(0,a.m)(e)}function m(e,t){var r=s.$.onStoppedNotification;r&&f.f.setTimeout((function(){return r(e,t)}))}var w={closed:!0,next:u.l,error:function(e){throw e},complete:u.l}},2616:(e,t,r)=>{"use strict";r.d(t,{Kn:()=>u,yU:()=>a,Uv:()=>c});var n=r(1635),o=r(1209),i=(0,r(2947).L)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),s=r(6174),a=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,s,a;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var c=(0,n.Ju)(u),f=c.next();!f.done;f=c.next()){f.value.remove(this)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}else u.remove(this);var d=this.initialTeardown;if((0,o.T)(d))try{d()}catch(e){a=e instanceof i?e.errors:[e]}var p=this._finalizers;if(p){this._finalizers=null;try{for(var h=(0,n.Ju)(p),y=h.next();!y.done;y=h.next()){var v=y.value;try{l(v)}catch(e){a=null!=a?a:[],e instanceof i?a=(0,n.fX)((0,n.fX)([],(0,n.zs)(a)),(0,n.zs)(e.errors)):a.push(e)}}}catch(e){r={error:e}}finally{try{y&&!y.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}}if(a)throw new i(a)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,s.o)(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&(0,s.o)(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),u=a.EMPTY;function c(e){return e instanceof a||e&&"closed"in e&&(0,o.T)(e.remove)&&(0,o.T)(e.add)&&(0,o.T)(e.unsubscribe)}function l(e){(0,o.T)(e)?e():e.unsubscribe()}},4384:(e,t,r)=>{"use strict";r.d(t,{$:()=>n});var n={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},8825:(e,t,r)=>{"use strict";r.d(t,{_:()=>i});var n=(0,r(2947).L)((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}})),o=r(5508);function i(e,t){var r="object"==typeof t;return new Promise((function(i,s){var a=new o.Ms({next:function(e){i(e),a.unsubscribe()},error:s,complete:function(){r?i(t.defaultValue):s(new n)}});e.subscribe(a)}))}},2922:(e,t,r)=>{"use strict";r.d(t,{z:()=>y});var n=r(8483),o=Array.isArray,i=Object.getPrototypeOf,s=Object.prototype,a=Object.keys;function u(e){if(1===e.length){var t=e[0];if(o(t))return{args:t,keys:null};if((n=t)&&"object"==typeof n&&i(n)===s){var r=a(t);return{args:r.map((function(e){return t[e]})),keys:r}}}var n;return{args:e,keys:null}}var c=r(7968),l=r(8307),f=r(7516),d=r(2100);var p=r(4878),h=r(6315);function y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,d.lI)(e),o=(0,d.ms)(e),i=u(e),s=i.args,a=i.keys;if(0===s.length)return(0,c.H)([],r);var h=new n.c(function(e,t,r){void 0===r&&(r=l.D);return function(n){v(t,(function(){for(var o=e.length,i=new Array(o),s=o,a=o,u=function(o){v(t,(function(){var u=(0,c.H)(e[o],t),l=!1;u.subscribe((0,p._)(n,(function(e){i[o]=e,l||(l=!0,a--),a||n.next(r(i.slice()))}),(function(){--s||n.complete()})))}),n)},l=0;l<o;l++)u(l)}),n)}}(s,r,a?function(e){return function(e,t){return e.reduce((function(e,r,n){return e[r]=t[n],e}),{})}(a,e)}:l.D));return o?h.pipe((0,f.I)(o)):h}function v(e,t,r){e?(0,h.N)(r,e,t):t()}},2316:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var n=r(8483),o=r(5964);function i(e){return new n.c((function(t){(0,o.Tg)(e()).subscribe(t)}))}},1701:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var n=new(r(8483).c)((function(e){return e.complete()}))},7968:(e,t,r)=>{"use strict";r.d(t,{H:()=>S});var n=r(5964),o=r(6315),i=r(2908),s=r(4878);function a(e,t){return void 0===t&&(t=0),(0,i.N)((function(r,n){r.subscribe((0,s._)(n,(function(r){return(0,o.N)(n,e,(function(){return n.next(r)}),t)}),(function(){return(0,o.N)(n,e,(function(){return n.complete()}),t)}),(function(r){return(0,o.N)(n,e,(function(){return n.error(r)}),t)})))}))}function u(e,t){return void 0===t&&(t=0),(0,i.N)((function(r,n){n.add(e.schedule((function(){return r.subscribe(n)}),t))}))}var c=r(8483);var l=r(2059),f=r(1209);function d(e,t){if(!e)throw new Error("Iterable cannot be null");return new c.c((function(r){(0,o.N)(r,t,(function(){var n=e[Symbol.asyncIterator]();(0,o.N)(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}var p=r(7541),h=r(3440),y=r(9391),v=r(8667),g=r(2471),b=r(3465),m=r(8438);function w(e,t){if(null!=e){if((0,p.l)(e))return function(e,t){return(0,n.Tg)(e).pipe(u(t),a(t))}(e,t);if((0,y.X)(e))return function(e,t){return new c.c((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(e,t);if((0,h.y)(e))return function(e,t){return(0,n.Tg)(e).pipe(u(t),a(t))}(e,t);if((0,g.T)(e))return d(e,t);if((0,v.x)(e))return function(e,t){return new c.c((function(r){var n;return(0,o.N)(r,t,(function(){n=e[l.l](),(0,o.N)(r,t,(function(){var e,t,o;try{t=(e=n.next()).value,o=e.done}catch(e){return void r.error(e)}o?r.complete():r.next(t)}),0,!0)})),function(){return(0,f.T)(null==n?void 0:n.return)&&n.return()}}))}(e,t);if((0,m.U)(e))return function(e,t){return d((0,m.C)(e),t)}(e,t)}throw(0,b.L)(e)}function S(e,t){return t?w(e,t):(0,n.Tg)(e)}},9336:(e,t,r)=>{"use strict";r.d(t,{R:()=>p});var n=r(1635),o=r(5964),i=r(8483),s=r(8452),a=r(9391),u=r(1209),c=r(7516),l=["addListener","removeListener"],f=["addEventListener","removeEventListener"],d=["on","off"];function p(e,t,r,y){if((0,u.T)(r)&&(y=r,r=void 0),y)return p(e,t,r).pipe((0,c.I)(y));var v=(0,n.zs)(function(e){return(0,u.T)(e.addEventListener)&&(0,u.T)(e.removeEventListener)}(e)?f.map((function(n){return function(o){return e[n](t,o,r)}})):function(e){return(0,u.T)(e.addListener)&&(0,u.T)(e.removeListener)}(e)?l.map(h(e,t)):function(e){return(0,u.T)(e.on)&&(0,u.T)(e.off)}(e)?d.map(h(e,t)):[],2),g=v[0],b=v[1];if(!g&&(0,a.X)(e))return(0,s.Z)((function(e){return p(e,t,r)}))((0,o.Tg)(e));if(!g)throw new TypeError("Invalid event target");return new i.c((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return g(t),function(){return b(t)}}))}function h(e,t){return function(r){return function(n){return e[r](t,n)}}}},5964:(e,t,r)=>{"use strict";r.d(t,{Tg:()=>y});var n=r(1635),o=r(9391),i=r(3440),s=r(8483),a=r(7541),u=r(2471),c=r(3465),l=r(8667),f=r(8438),d=r(1209),p=r(2564),h=r(5604);function y(e){if(e instanceof s.c)return e;if(null!=e){if((0,a.l)(e))return b=e,new s.c((function(e){var t=b[h.s]();if((0,d.T)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,o.X)(e))return g=e,new s.c((function(e){for(var t=0;t<g.length&&!e.closed;t++)e.next(g[t]);e.complete()}));if((0,i.y)(e))return y=e,new s.c((function(e){y.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,p.m)}));if((0,u.T)(e))return v(e);if((0,l.x)(e))return r=e,new s.c((function(e){var t,o;try{for(var i=(0,n.Ju)(r),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}e.complete()}));if((0,f.U)(e))return t=e,v((0,f.C)(t))}var t,r,y,g,b;throw(0,c.L)(e)}function v(e){return new s.c((function(t){(function(e,t){var r,o,i,s;return(0,n.sH)(this,void 0,void 0,(function(){var a,u;return(0,n.YH)(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=(0,n.xN)(e),c.label=1;case 1:return[4,r.next()];case 2:if((o=c.sent()).done)return[3,4];if(a=o.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=c.sent(),i={error:u},[3,11];case 6:return c.trys.push([6,,9,10]),o&&!o.done&&(s=r.return)?[4,s.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},4240:(e,t,r)=>{"use strict";r.d(t,{h:()=>u});var n=r(3031),o=r(5964),i=r(1701),s=r(2100),a=r(7968);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,s.lI)(e),u=(0,s.R0)(e,1/0),c=e;return c.length?1===c.length?(0,o.Tg)(c[0]):(0,n.U)(u)((0,a.H)(c,r)):i.w}},1150:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(8483),o=r(2357),i=new n.c(o.l)},2467:(e,t,r)=>{"use strict";r.d(t,{of:()=>i});var n=r(2100),o=r(7968);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,n.lI)(e);return(0,o.H)(e,r)}},3288:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});var n=r(8483),o=r(1209);function i(e,t){var r=(0,o.T)(e)?e:function(){return e},i=function(e){return e.error(r())};return new n.c(t?function(e){return t.schedule(i,0,e)}:i)}},9697:(e,t,r)=>{"use strict";r.d(t,{O:()=>a});var n=r(8483),o=r(7903),i=r(8820),s=r(6577);function a(e,t,r){void 0===e&&(e=0),void 0===r&&(r=o.b);var a=-1;return null!=t&&((0,i.m)(t)?r=t:a=t),new n.c((function(t){var n=(0,s.v)(e)?+e-r.now():e;n<0&&(n=0);var o=0;return r.schedule((function(){t.closed||(t.next(o++),0<=a?this.schedule(void 0,a):t.complete())}),n)}))}},4878:(e,t,r)=>{"use strict";r.d(t,{_:()=>o});var n=r(1635);function o(e,t,r,n,o){return new i(e,t,r,n,o)}var i=function(e){function t(t,r,n,o,i,s){var a=e.call(this,t)||this;return a.onFinalize=i,a.shouldUnsubscribe=s,a._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,n.C6)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(r(5508).vU)},6847:(e,t,r)=>{"use strict";r.d(t,{W:()=>s});var n=r(5964),o=r(4878),i=r(2908);function s(e){return(0,i.N)((function(t,r){var i,a=null,u=!1;a=t.subscribe((0,o._)(r,void 0,void 0,(function(o){i=(0,n.Tg)(e(o,s(e)(t))),a?(a.unsubscribe(),a=null,i.subscribe(r)):u=!0}))),u&&(a.unsubscribe(),a=null,i.subscribe(r))}))}},6978:(e,t,r)=>{"use strict";r.d(t,{B:()=>s});var n=r(7903),o=r(2908),i=r(4878);function s(e,t){return void 0===t&&(t=n.E),(0,o.N)((function(r,n){var o=null,s=null,a=null,u=function(){if(o){o.unsubscribe(),o=null;var e=s;s=null,n.next(e)}};function c(){var r=a+e,i=t.now();if(i<r)return o=this.schedule(void 0,r-i),void n.add(o);u()}r.subscribe((0,i._)(n,(function(r){s=r,a=t.now(),o||(o=t.schedule(c,e),n.add(o))}),(function(){u(),n.complete()}),void 0,(function(){s=o=null})))}))}},1900:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});var n=r(8307),o=r(2908),i=r(4878);function s(e,t){return void 0===t&&(t=n.D),e=null!=e?e:a,(0,o.N)((function(r,n){var o,s=!0;r.subscribe((0,i._)(n,(function(r){var i=t(r);!s&&e(o,i)||(s=!1,o=i,n.next(r))})))}))}function a(e,t){return e===t}},1080:(e,t,r)=>{"use strict";r.d(t,{p:()=>a});var n=r(1160),o=r(5964),i=r(2908),s=r(4878);function a(e,t){return t?function(r){return r.pipe(a((function(r,i){return(0,o.Tg)(e(r,i)).pipe((0,n.T)((function(e,n){return t(r,e,i,n)})))})))}:(0,i.N)((function(t,r){var n=0,i=null,a=!1;t.subscribe((0,s._)(r,(function(t){i||(i=(0,s._)(r,void 0,(function(){i=null,a&&r.complete()})),(0,o.Tg)(e(t,n++)).subscribe(i))}),(function(){a=!0,!i&&r.complete()})))}))}},6126:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var n=r(2908),o=r(4878);function i(e,t){return(0,n.N)((function(r,n){var i=0;r.subscribe((0,o._)(n,(function(r){return e.call(t,r,i++)&&n.next(r)})))}))}},1160:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var n=r(2908),o=r(4878);function i(e,t){return(0,n.N)((function(r,n){var i=0;r.subscribe((0,o._)(n,(function(r){n.next(e.call(t,r,i++))})))}))}},3031:(e,t,r)=>{"use strict";r.d(t,{U:()=>i});var n=r(8452),o=r(8307);function i(e){return void 0===e&&(e=1/0),(0,n.Z)(o.D,e)}},8452:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(1160),o=r(5964),i=r(2908),s=r(6315),a=r(4878);var u=r(1209);function c(e,t,r){return void 0===r&&(r=1/0),(0,u.T)(t)?c((function(r,i){return(0,n.T)((function(e,n){return t(r,e,i,n)}))((0,o.Tg)(e(r,i)))}),r):("number"==typeof t&&(r=t),(0,i.N)((function(t,n){return function(e,t,r,n,i,u,c,l){var f=[],d=0,p=0,h=!1,y=function(){!h||f.length||d||t.complete()},v=function(e){return d<n?g(e):f.push(e)},g=function(e){u&&t.next(e),d++;var l=!1;(0,o.Tg)(r(e,p++)).subscribe((0,a._)(t,(function(e){null==i||i(e),u?v(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{d--;for(var e=function(){var e=f.shift();c?(0,s.N)(t,c,(function(){return g(e)})):g(e)};f.length&&d<n;)e();y()}catch(e){t.error(e)}})))};return e.subscribe((0,a._)(t,v,(function(){h=!0,y()}))),function(){null==l||l()}}(t,n,e,r)})))}},3160:(e,t,r)=>{"use strict";r.d(t,{L:()=>u});var n=r(2908),o=r(4878),i=r(8307),s=r(9697),a=r(5964);function u(e){var t;void 0===e&&(e=1/0);var r=(t=e&&"object"==typeof e?e:{count:e}).count,u=void 0===r?1/0:r,c=t.delay,l=t.resetOnSuccess,f=void 0!==l&&l;return u<=0?i.D:(0,n.N)((function(e,t){var r,n=0,i=function(){var l=!1;r=e.subscribe((0,o._)(t,(function(e){f&&(n=0),t.next(e)}),void 0,(function(e){if(n++<u){var f=function(){r?(r.unsubscribe(),r=null,i()):l=!0};if(null!=c){var d="number"==typeof c?(0,s.O)(c):(0,a.Tg)(c(e,n)),p=(0,o._)(t,(function(){p.unsubscribe(),f()}),(function(){t.complete()}));d.subscribe(p)}else f()}else t.error(e)}))),l&&(r.unsubscribe(),r=null,i())};i()}))}},1005:(e,t,r)=>{"use strict";r.d(t,{u:()=>u});var n=r(1635),o=r(5964),i=r(7291),s=r(5508),a=r(2908);function u(e){void 0===e&&(e={});var t=e.connector,r=void 0===t?function(){return new i.B}:t,n=e.resetOnError,u=void 0===n||n,l=e.resetOnComplete,f=void 0===l||l,d=e.resetOnRefCountZero,p=void 0===d||d;return function(e){var t,n,i,l=0,d=!1,h=!1,y=function(){null==n||n.unsubscribe(),n=void 0},v=function(){y(),t=i=void 0,d=h=!1},g=function(){var e=t;v(),null==e||e.unsubscribe()};return(0,a.N)((function(e,a){l++,h||d||y();var b=i=null!=i?i:r();a.add((function(){0!==--l||h||d||(n=c(g,p))})),b.subscribe(a),!t&&l>0&&(t=new s.Ms({next:function(e){return b.next(e)},error:function(e){h=!0,y(),n=c(v,u,e),b.error(e)},complete:function(){d=!0,y(),n=c(v,f),b.complete()}}),(0,o.Tg)(e).subscribe(t))}))(e)}}function c(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(!0!==t){if(!1!==t){var a=new s.Ms({next:function(){a.unsubscribe(),e()}});return(0,o.Tg)(t.apply(void 0,(0,n.fX)([],(0,n.zs)(r)))).subscribe(a)}}else e()}},7718:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(9741),o=r(1005);function i(e,t,r){var i,s,a,u,c=!1;return e&&"object"==typeof e?(i=e.bufferSize,u=void 0===i?1/0:i,s=e.windowTime,t=void 0===s?1/0:s,c=void 0!==(a=e.refCount)&&a,r=e.scheduler):u=null!=e?e:1/0,(0,o.u)({connector:function(){return new n.m(u,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}},9050:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(3031);var o=r(2100),i=r(7968);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,n.U)(1)((0,i.H)(e,(0,o.lI)(e)))}var a=r(2908);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(0,o.lI)(e);return(0,a.N)((function(t,n){(r?s(e,t,r):s(e,t)).subscribe(n)}))}},3720:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var n=r(5964),o=r(2908),i=r(4878);function s(e,t){return(0,o.N)((function(r,o){var s=null,a=0,u=!1,c=function(){return u&&!s&&o.complete()};r.subscribe((0,i._)(o,(function(r){null==s||s.unsubscribe();var u=0,l=a++;(0,n.Tg)(e(r,l)).subscribe(s=(0,i._)(o,(function(e){return o.next(t?t(r,e,l,u++):e)}),(function(){s=null,c()})))}),(function(){u=!0,c()})))}))}},8975:(e,t,r)=>{"use strict";r.d(t,{s:()=>s});var n=r(1701),o=r(2908),i=r(4878);function s(e){return e<=0?function(){return n.w}:(0,o.N)((function(t,r){var n=0;t.subscribe((0,i._)(r,(function(t){++n<=e&&(r.next(t),e<=n&&r.complete())})))}))}},7791:(e,t,r)=>{"use strict";r.d(t,{Q:()=>a});var n=r(2908),o=r(4878),i=r(5964),s=r(2357);function a(e){return(0,n.N)((function(t,r){(0,i.Tg)(e).subscribe((0,o._)(r,(function(){return r.complete()}),s.l)),!r.closed&&t.subscribe(r)}))}},9099:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});var n=r(1209),o=r(2908),i=r(4878),s=r(8307);function a(e,t,r){var a=(0,n.T)(e)||t||r?{next:e,error:t,complete:r}:e;return a?(0,o.N)((function(e,t){var r;null===(r=a.subscribe)||void 0===r||r.call(a);var n=!0;e.subscribe((0,i._)(t,(function(e){var r;null===(r=a.next)||void 0===r||r.call(a,e),t.next(e)}),(function(){var e;n=!1,null===(e=a.complete)||void 0===e||e.call(a),t.complete()}),(function(e){var r;n=!1,null===(r=a.error)||void 0===r||r.call(a,e),t.error(e)}),(function(){var e,t;n&&(null===(e=a.unsubscribe)||void 0===e||e.call(a)),null===(t=a.finalize)||void 0===t||t.call(a)})))})):s.D}},7903:(e,t,r)=>{"use strict";r.d(t,{b:()=>f,E:()=>l});var n=r(1635),o=function(e){function t(t,r){return e.call(this)||this}return(0,n.C6)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(r(2616).yU),i={setInterval:function(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var s=i.delegate;return(null==s?void 0:s.setInterval)?s.setInterval.apply(s,(0,n.fX)([e,t],(0,n.zs)(r))):setInterval.apply(void 0,(0,n.fX)([e,t],(0,n.zs)(r)))},clearInterval:function(e){var t=i.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},s=r(6174),a=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return(0,n.C6)(t,e),t.prototype.schedule=function(e,t){var r;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,o=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(o,n,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(o,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),i.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&i.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,s.o)(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o),u=r(1179),c=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=u.U.now,e}(),l=new(function(e){function t(t,r){void 0===r&&(r=c.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n}return(0,n.C6)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(c))(a),f=l},1179:(e,t,r)=>{"use strict";r.d(t,{U:()=>n});var n={now:function(){return(n.delegate||Date).now()},delegate:void 0}},6744:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});var n=r(1635),o={setTimeout:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var s=o.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,(0,n.fX)([e,t],(0,n.zs)(r))):setTimeout.apply(void 0,(0,n.fX)([e,t],(0,n.zs)(r)))},clearTimeout:function(e){var t=o.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},2059:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});var n="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},5604:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});var n="function"==typeof Symbol&&Symbol.observable||"@@observable"},2100:(e,t,r)=>{"use strict";r.d(t,{R0:()=>u,lI:()=>a,ms:()=>s});var n=r(1209),o=r(8820);function i(e){return e[e.length-1]}function s(e){return(0,n.T)(i(e))?e.pop():void 0}function a(e){return(0,o.m)(i(e))?e.pop():void 0}function u(e,t){return"number"==typeof i(e)?e.pop():t}},6174:(e,t,r)=>{"use strict";function n(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}r.d(t,{o:()=>n})},2947:(e,t,r)=>{"use strict";function n(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}r.d(t,{L:()=>n})},7008:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i,l:()=>s});var n=r(4384),o=null;function i(e){if(n.$.useDeprecatedSynchronousErrorHandling){var t=!o;if(t&&(o={errorThrown:!1,error:null}),e(),t){var r=o,i=r.errorThrown,s=r.error;if(o=null,i)throw s}}else e()}function s(e){n.$.useDeprecatedSynchronousErrorHandling&&o&&(o.errorThrown=!0,o.error=e)}},6315:(e,t,r)=>{"use strict";function n(e,t,r,n,o){void 0===n&&(n=0),void 0===o&&(o=!1);var i=t.schedule((function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(i),!o)return i}r.d(t,{N:()=>n})},8307:(e,t,r)=>{"use strict";function n(e){return e}r.d(t,{D:()=>n})},9391:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var n=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},2471:(e,t,r)=>{"use strict";r.d(t,{T:()=>o});var n=r(1209);function o(e){return Symbol.asyncIterator&&(0,n.T)(null==e?void 0:e[Symbol.asyncIterator])}},6577:(e,t,r)=>{"use strict";function n(e){return e instanceof Date&&!isNaN(e)}r.d(t,{v:()=>n})},1209:(e,t,r)=>{"use strict";function n(e){return"function"==typeof e}r.d(t,{T:()=>n})},7541:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});var n=r(5604),o=r(1209);function i(e){return(0,o.T)(e[n.s])}},8667:(e,t,r)=>{"use strict";r.d(t,{x:()=>i});var n=r(2059),o=r(1209);function i(e){return(0,o.T)(null==e?void 0:e[n.l])}},3440:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var n=r(1209);function o(e){return(0,n.T)(null==e?void 0:e.then)}},8438:(e,t,r)=>{"use strict";r.d(t,{C:()=>i,U:()=>s});var n=r(1635),o=r(1209);function i(e){return(0,n.AQ)(this,arguments,(function(){var t,r,o;return(0,n.YH)(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,n.N3)(t.read())];case 3:return r=i.sent(),o=r.value,r.done?[4,(0,n.N3)(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,(0,n.N3)(o)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function s(e){return(0,o.T)(null==e?void 0:e.getReader)}},8820:(e,t,r)=>{"use strict";r.d(t,{m:()=>o});var n=r(1209);function o(e){return e&&(0,n.T)(e.schedule)}},2908:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});var n=r(1209);function o(e){return function(t){if(function(e){return(0,n.T)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},7516:(e,t,r)=>{"use strict";r.d(t,{I:()=>s});var n=r(1635),o=r(1160),i=Array.isArray;function s(e){return(0,o.T)((function(t){return function(e,t){return i(t)?e.apply(void 0,(0,n.fX)([],(0,n.zs)(t))):e(t)}(e,t)}))}},2357:(e,t,r)=>{"use strict";function n(){}r.d(t,{l:()=>n})},1485:(e,t,r)=>{"use strict";r.d(t,{F:()=>o,m:()=>i});var n=r(8307);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(e)}function i(e){return 0===e.length?n.D:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}},2564:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var n=r(4384),o=r(6744);function i(e){o.f.setTimeout((function(){var t=n.$.onUnhandledError;if(!t)throw e;t(e)}))}},3465:(e,t,r)=>{"use strict";function n(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}r.d(t,{L:()=>n})},6683:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});const n="Pikabu Fixes"},8528:(e,t,r)=>{"use strict";function n(e){return console.log(e),e instanceof Error?`${e.stack}`:String(e)}r.d(t,{M:()=>n})},4365:(e,t,r)=>{"use strict";r.d(t,{$:()=>U});var n=r(3732),o=r(5140),i=r(5966),s=r(7291),a=r(4240),u=r(9050),c=r(3720),l=r(2922),f=r(1900),d=r(8825),p=r(9697),h=r(6126),y=r(1080),v=r(8483),g=r(1160),b=r(6412),m=r(5360),w=r(964),S=r(4938),_=r(7284),O=r(1124),T=r.n(O),C=r(7871);class x{static async hash(e,t=10){const r=await C.genSalt(t);return C.hash(e,r)}static async compare(e,t){return C.compare(e,t)}}var A=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};let E=class{getLastDigits(e){return Number(String(e).slice(-2))}async isCompare(e,t,r){return x.compare(`${t}-${r}`,e)}};E=A([(0,m.k)()],E);var k,P=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};const j={version:7,name:"des--booster-candidate",tables:[{name:"candidate",columns:{orderUuid:{primaryKey:!0,dataType:"string",unique:!0,notNull:!0},hash:{dataType:"string",notNull:!0},lastDigits:{dataType:"number",notNull:!0},outDate:{dataType:"string",notNull:!0},initialStoryId:{dataType:"number",default:0,notNull:!0},foundedStoryId:{dataType:"number",default:0,notNull:!0},obsolete:{dataType:"number",notNull:!0,default:0},progress:{dataType:"number",notNull:!0,default:0},success:{dataType:"number",notNull:!0,default:0},error:{dataType:"number",notNull:!0,default:0}},alter:{6:{add:{voted:{dataType:"number",notNull:!0,default:0}}},7:{add:{rejected:{dataType:"number",notNull:!0,default:0}}}}}]};let M=k=class{boosterCandidateComparatorService=b.m.get(E);_db;get db(){return this._db||(this._db=this.openDB()),this._db}async setActualCandidates(e){const t=e.map((e=>e.orderUuid));await this.markObsoleteExcept(t);const r=e.map((e=>k.toInsertStoredModel(e)));await this.insertCandidates(r)}async updateCandidate(e,t){const r=await this.db;await r.update({in:"candidate",where:{orderUuid:e},set:t})}async getCandidateByStoryId(e){const t=await this.db,r=await t.select({from:"candidate",where:{initialStoryId:e,or:{foundedStoryId:e}},limit:1});return r.length?r[0]:null}async findCandidateByStoryAndAuthorId(e,t){const r=await this.db,n=await this.getCandidateByStoryId(e);if(n)return n;const o=this.boosterCandidateComparatorService.getLastDigits(e),i=await r.select({from:"candidate",where:{lastDigits:o,initialStoryId:0,foundedStoryId:0,obsolete:0,rejected:0}});for(const r of i){if(await this.boosterCandidateComparatorService.isCompare(r.hash,e,t))return await this.updateCandidate(r.orderUuid,{foundedStoryId:e}),r}return null}async getCandidatesForUpvote(e){return(await this.db).select({from:"candidate",where:{initialStoryId:{"!=":0},obsolete:0,success:0,error:0,voted:0,rejected:0},limit:e})}async openDB(){if(S.WU!==S.Jb.Background)throw new Error("wrong runtime");const e=new _.Connection;return e.addPlugin(T()),await e.initDb(j),e}static toInsertStoredModel(e){return{orderUuid:e.orderUuid,hash:e.hash,lastDigits:e.lastDigits,outDate:e.outDate,initialStoryId:e.storyId??0,foundedStoryId:e.storyId??0,error:0,progress:0,success:0,obsolete:0,voted:0,rejected:0}}async markObsoleteExcept(e){const t=await this.db;let r;r=e.length>0?e.map((e=>({obsolete:0,orderUuid:{"!=":e}}))):{obsolete:0},await t.update({in:"candidate",where:r,set:{obsolete:1}})}async insertCandidates(e){if(!e.length)return;const t=await this.db;await t.insert({into:"candidate",values:e,ignore:!0})}};M=k=P([(0,m.k)()],M);var I=r(5825),D=r(2254),R=r(2654),N=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},B=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let U=class{boosterOrderStorageService=b.m.get(D.X);boosterCandidateStorageService=b.m.get(M);boosterCandidateApiService=w.FP;clientService=b.m.get(I.N);boosterTransactionService=b.m.get(R.E);updatedBg$=new s.B;updateOnSubscribeBg$=(0,i.n3)((()=>this.periodicUpdateOnSubscribeBg()));getCandidatesForUpvote(){return(0,a.h)(this.updateOnSubscribeBg$,this.updatedBg$).pipe((0,u.Z)(null),(0,c.n)((()=>(0,l.z)({candidates:this.boosterCandidateStorageService.getCandidatesForUpvote(),orders:this.boosterOrderStorageService.getActiveOrders()}))),(0,g.T)((({candidates:e,orders:t})=>{const r=new Set(t.map((e=>e.uuid)));return e.filter((e=>!r.has(e.orderUuid)))??null})),(0,f.F)(n.XR))}findCandidate(e,t){return(0,a.h)(this.updateOnSubscribeBg$,this.updatedBg$).pipe((0,u.Z)(null),(0,c.n)((()=>this.boosterCandidateStorageService.findCandidateByStoryAndAuthorId(e,t))),(0,f.F)(n.XR))}async markAsObsolete(e){await this.updateCandidateBg(e,{obsolete:1})}async markAsVoted(e){await this.updateCandidateBg(e,{voted:1})}async markAsRejected(e){await this.updateCandidateBg(e,{rejected:1})}async upvote(e,t,r){const n=this.boosterTransactionService.transactionClient(e,t,r);await this.updateCandidateBg(e,{progress:1});try{const t=await(0,d._)(n);await this.updateCandidateBg(e,{progress:0,success:t?1:0,error:t?0:1})}catch(t){await this.updateCandidateBg(e,{progress:0,error:1})}}periodicUpdateOnSubscribeBg(){return(0,p.O)(0,3e4).pipe((0,c.n)((()=>this.clientService.enabledUuid$)),(0,h.p)(Boolean),(0,y.p)((e=>this.updateCandidatesBg(e))),(0,i.Zm)())}async updateCandidatesBg(e){try{const t=await this.boosterCandidateApiService.boosterCandidateControllerGetCandidates(e);await this.boosterCandidateStorageService.setActualCandidates(t),this.updatedBg$.next()}catch(e){}}async updateCandidateBg(e,t){await this.boosterCandidateStorageService.updateCandidate(e,t),this.updatedBg$.next()}};N([(0,o.mM)("BoosterCandidateService.getCandidatesForUpvote"),B("design:type",Function),B("design:paramtypes",[]),B("design:returntype",v.c)],U.prototype,"getCandidatesForUpvote",null),N([(0,o.mM)("BoosterCandidateService.findCandidate"),B("design:type",Function),B("design:paramtypes",[Number,Number]),B("design:returntype",v.c)],U.prototype,"findCandidate",null),N([(0,o.mM)("BoosterCandidateService.periodicUpdateOnSubscribeBg"),B("design:type",Function),B("design:paramtypes",[]),B("design:returntype",v.c)],U.prototype,"periodicUpdateOnSubscribeBg",null),N([(0,o.up)("BoosterCandidateService.updateCandidatesBg"),B("design:type",Function),B("design:paramtypes",[String]),B("design:returntype",Promise)],U.prototype,"updateCandidatesBg",null),N([(0,o.up)("BoosterCandidateService.updateCandidateBg"),B("design:type",Function),B("design:paramtypes",[String,Object]),B("design:returntype",Promise)],U.prototype,"updateCandidateBg",null),U=N([(0,m.k)()],U)},5825:(e,t,r)=>{"use strict";r.d(t,{N:()=>_});var n=r(3732),o=r(4938),i=r(5140),s=r(5966),a=r(9426),u=r(4240),c=r(9697),l=r(3720),f=r(6126),d=r(1080),p=r(8825),h=r(8483),y=r(1160),v=r(6412),g=r(5360),b=r(964),m=r(4982),w=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let _=class{settingsService=v.m.get(m.h);boosterClientApiService=b.BN;statusBg$=new a.t(null);periodicStatusUpdateOnSubscribe$=(0,s.n3)((()=>this.periodicStatusUpdateOnSubscribeBg()));enabledUuid$=this.settingsService.settings$.pipe((0,y.T)((e=>e.booster&&e.boosterUuid||null)));status$=(0,s.n3)((()=>this.getStatusShare()));constructor(){this.firstInitializeBg()}async logout(){await this.settingsService.setKey("boosterUuid",null),await this.updateStatus()}async generateUuid(){const e=await this.boosterClientApiService.boosterClientControllerRegisterClient();if(!e.uuid)throw new Error("uuid not received");await this.settingsService.setKey("boosterUuid",e.uuid),await this.updateStatus()}async generateUuidAuto(e){const t=await this.boosterClientApiService.boosterClientControllerRegisterClientAuto(e);if(!t.uuid)throw new Error("uuid not received");await this.settingsService.setKey("boosterUuid",t.uuid),await this.updateStatus()}async setUuid(e){try{const t=await this.boosterClientApiService.boosterClientControllerGetStatus(e),r=(0,n.O9)(t.points);return await this.settingsService.setKey("boosterUuid",e),r}catch(e){return!1}}async updateStatus(){await this.updateStatusBg()}getStatusShare(){return(0,u.h)(this.statusBg$,this.periodicStatusUpdateOnSubscribe$)}async firstInitializeBg(){if(o.WU!==o.Jb.Background)return;const e=await this.settingsService.get();e.boosterFirstInitialized||(e.boosterUuid?await this.settingsService.setKey("boosterFirstInitialized",!0):(await this.settingsService.patch({booster:!0,boosterFirstInitialized:!0}),await this.generateUuidAuto(e.uuid)))}periodicStatusUpdateOnSubscribeBg(){return(0,c.O)(0,3e4).pipe((0,l.n)((()=>this.enabledUuid$)),(0,f.p)(Boolean),(0,d.p)((()=>this.updateStatusBg())),(0,s.Zm)())}async updateStatusBg(){try{const e=await(0,p._)(this.enabledUuid$);if(!e)return;const t=await this.boosterClientApiService.boosterClientControllerGetStatus(e);this.statusBg$.next(t)}catch(e){}}};w([(0,i.up)("BoosterClientService.logout"),S("design:type",Function),S("design:paramtypes",[]),S("design:returntype",Promise)],_.prototype,"logout",null),w([(0,i.up)("BoosterClientService.generateUuid"),S("design:type",Function),S("design:paramtypes",[]),S("design:returntype",Promise)],_.prototype,"generateUuid",null),w([(0,i.up)("BoosterClientService.generateUuidAuto"),S("design:type",Function),S("design:paramtypes",[String]),S("design:returntype",Promise)],_.prototype,"generateUuidAuto",null),w([(0,i.up)("BoosterClientService.setUuid"),S("design:type",Function),S("design:paramtypes",[String]),S("design:returntype",Promise)],_.prototype,"setUuid",null),w([(0,i.mM)("BoosterClientService.getStatusShare"),S("design:type",Function),S("design:paramtypes",[]),S("design:returntype",h.c)],_.prototype,"getStatusShare",null),w([(0,i.mM)("BoosterClientService.periodicStatusUpdateOnSubscribeBg"),S("design:type",Function),S("design:paramtypes",[]),S("design:returntype",h.c)],_.prototype,"periodicStatusUpdateOnSubscribeBg",null),_=w([(0,g.k)(),S("design:paramtypes",[])],_)},475:(e,t,r)=>{"use strict";r.d(t,{k:()=>m});var n=r(5140),o=r(5966),i=r(9426),s=r(4240),a=r(9697),u=r(3720),c=r(6126),l=r(1080),f=r(8825),d=r(8483),p=r(6412),h=r(5360),y=r(964),v=r(5825),g=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let m=class{boosterClientService=p.m.get(v.N);boosterClientApiService=y.Mi;conditionsBg$=new i.t(null);periodicStatusUpdateOnSubscribe$=(0,o.n3)((()=>this.periodicUpdateOnSubscribeBg()));conditions$=(0,o.n3)((()=>this.getConditionsShare()));getConditionsShare(){return(0,s.h)(this.conditionsBg$,this.periodicStatusUpdateOnSubscribe$)}periodicUpdateOnSubscribeBg(){return(0,a.O)(0,3e4).pipe((0,u.n)((()=>this.boosterClientService.enabledUuid$)),(0,c.p)(Boolean),(0,l.p)((()=>this.updateStatusBg())),(0,o.Zm)())}async updateStatusBg(){try{const e=await(0,f._)(this.boosterClientService.enabledUuid$);if(!e)return;const t=await this.boosterClientApiService.boosterOrderConditionsControllerGetOrderConditions(e);this.conditionsBg$.next(t)}catch(e){}}};g([(0,n.mM)("BoosterOrderConditionsService.getConditionsShare"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",d.c)],m.prototype,"getConditionsShare",null),g([(0,n.mM)("BoosterOrderConditionsService.periodicUpdateOnSubscribeBg"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",d.c)],m.prototype,"periodicUpdateOnSubscribeBg",null),m=g([(0,h.k)()],m)},2254:(e,t,r)=>{"use strict";r.d(t,{X:()=>f});var n,o=r(4938),i=r(7284),s=r(1124),a=r.n(s),u=r(5360),c=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};const l={version:1,name:"des--booster-order",tables:[{name:"order",columns:{uuid:{primaryKey:!0,dataType:"string",unique:!0,notNull:!0},outDate:{dataType:"string",notNull:!0},storyId:{dataType:"number",notNull:!0},storyTitle:{dataType:"string",notNull:!0},votesLimit:{dataType:"number",notNull:!0},votesRest:{dataType:"number",notNull:!0},votesSuccess:{dataType:"number",notNull:!0},active:{dataType:"number",notNull:!0},deleted:{dataType:"number",notNull:!0}}}]};let f=n=class{_db;get db(){return this._db||(this._db=this.openDB()),this._db}async setActualOrders(e){const t=e.map((e=>e.uuid));await this.markDeletedExcept(t);const r=e.map((e=>n.toInsertStoredModel(e)));await this.upsertCandidates(r)}async getActualOrders(){return(await this.db).select({from:"order",where:{deleted:0},order:[{by:"outDate",type:"desc"},{by:"active",type:"desc"}]})}async getActiveOrders(){return(await this.db).select({from:"order",where:{active:1,deleted:0}})}async getActualOrdersByStoryId(e){return(await this.db).select({from:"order",where:{storyId:e,deleted:0}})}async openDB(){if(o.WU!==o.Jb.Background)throw new Error("wrong runtime");const e=new i.Connection;return e.addPlugin(a()),await e.initDb(l),e}static toInsertStoredModel(e){return{active:e.active?1:0,deleted:e.deleted?1:0,outDate:e.outDate,storyId:e.storyId,storyTitle:e.storyTitle,uuid:e.uuid,votesLimit:e.votesLimit,votesRest:e.votesRest,votesSuccess:e.votesSuccess}}async upsertCandidates(e){if(!e.length)return;const t=await this.db;await t.insert({into:"order",values:e,upsert:!0})}async markDeletedExcept(e){const t=await this.db;let r;r=e.length>0?e.map((e=>({deleted:0,uuid:{"!=":e}}))):{deleted:0},await t.update({in:"order",where:r,set:{deleted:1,active:0}})}};f=n=c([(0,u.k)()],f)},2481:(e,t,r)=>{"use strict";r.d(t,{Q:()=>E});var n=r(3732),o=r(5140),i=r(5966),s=r(4188),a=r(7767),u=r(551);var c=r(7291),l=r(4240),f=r(9050),d=r(3720),p=r(1900),h=r(8825),y=r(9697),v=r(6126),g=r(1080),b=r(8483),m=r(1160),w=r(6412),S=r(5360),_=r(964),O=r(4365),T=r(5825),C=r(2254),x=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},A=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let E=class{boosterCandidateService=w.m.get(O.$);boosterOrderStorageService=w.m.get(C.X);boosterOrderApiService=_.Mi;clientService=w.m.get(T.N);updatedBg$=new c.B;updateOrdersOnSubscribeBg$=(0,i.n3)((()=>this.periodicUpdateOrdersOnSubscribeBg()));getActualOrders(){return(0,l.h)(this.updateOrdersOnSubscribeBg$,this.updatedBg$).pipe((0,f.Z)(null),(0,d.n)((()=>this.boosterOrderStorageService.getActualOrders())),(0,p.F)(n.XR))}getActualOrderOrNull(e){return(0,l.h)(this.updateOrdersOnSubscribeBg$,this.updatedBg$).pipe((0,f.Z)(null),(0,d.n)((()=>this.boosterOrderStorageService.getActualOrdersByStoryId(e))),(0,m.T)((e=>e[0]??null)),(0,p.F)(n.XR))}async delete(e){const t=await(0,h._)(this.clientService.enabledUuid$);t&&(await this.boosterOrderApiService.boosterOrderControllerDeleteOrder(e,t),await this.updateOrdersBg(t),await this.boosterCandidateService.markAsObsolete(e))}async deleteObsolete(){const e=await(0,h._)(this.clientService.enabledUuid$);e&&(await this.boosterOrderApiService.boosterOrderControllerDeleteObsolete(e),await this.updateOrdersBg(e),await this.boosterCandidateService.updateCandidatesBg(e))}async create(e,t,r){const n=function(e,t){(0,u.A)(2,arguments);var r=(0,s.A)(t);return(0,a.A)(e,6e4*r)}(Date.now(),r),o=await(0,h._)(this.clientService.enabledUuid$);if(!o)return Promise.reject("empty client uuid");await this.boosterOrderApiService.boosterOrderControllerCreateOrder({storyId:e,votesLimit:t,outDate:n.toISOString()},o),await this.updateOrdersBg(o)}periodicUpdateOrdersOnSubscribeBg(){return(0,y.O)(0,3e4).pipe((0,d.n)((()=>this.clientService.enabledUuid$)),(0,v.p)(Boolean),(0,g.p)((e=>this.updateOrdersBg(e))),(0,i.Zm)())}async updateOrdersBg(e){try{const t=await this.boosterOrderApiService.boosterOrderControllerGetOrders(e);await this.boosterOrderStorageService.setActualOrders(t),this.updatedBg$.next()}catch(e){}}};x([(0,o.mM)("BoosterOrderService.getActualOrders"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",b.c)],E.prototype,"getActualOrders",null),x([(0,o.mM)("BoosterOrderService.getActualOrderOrNull"),A("design:type",Function),A("design:paramtypes",[Number]),A("design:returntype",b.c)],E.prototype,"getActualOrderOrNull",null),x([(0,o.up)("BoosterOrderService.delete"),A("design:type",Function),A("design:paramtypes",[String]),A("design:returntype",Promise)],E.prototype,"delete",null),x([(0,o.up)("BoosterOrderService.deleteObsolete"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",Promise)],E.prototype,"deleteObsolete",null),x([(0,o.up)("BoosterOrderService.create"),A("design:type",Function),A("design:paramtypes",[Number,Number,Number]),A("design:returntype",Promise)],E.prototype,"create",null),x([(0,o.mM)("BoosterOrderService.periodicUpdateOrdersOnSubscribeBg"),A("design:type",Function),A("design:paramtypes",[]),A("design:returntype",b.c)],E.prototype,"periodicUpdateOrdersOnSubscribeBg",null),E=x([(0,S.k)()],E)},9444:(e,t,r)=>{"use strict";r.d(t,{d:()=>m});var n=r(5140),o=r(5966),i=r(9426),s=r(4240),a=r(9697),u=r(3720),c=r(6126),l=r(1080),f=r(8825),d=r(8483),p=r(6412),h=r(5360),y=r(964),v=r(5825),g=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},b=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let m=class{boosterClientService=p.m.get(v.N);boosterPointsTransactionApiService=y.Fd;transactionsBg$=new i.t(null);periodicUpdateOnSubscribe$=(0,o.n3)((()=>this.periodicUpdateOnSubscribeBg()));transactions$=(0,o.n3)((()=>this.getTransactionsShare()));getTransactionsShare(){return(0,s.h)(this.transactionsBg$,this.periodicUpdateOnSubscribe$)}periodicUpdateOnSubscribeBg(){return(0,a.O)(0,3e4).pipe((0,u.n)((()=>this.boosterClientService.enabledUuid$)),(0,c.p)(Boolean),(0,l.p)((()=>this.updateTransactionsBg())),(0,o.Zm)())}async updateTransactionsBg(){try{const e=await(0,f._)(this.boosterClientService.enabledUuid$);if(!e)return;const t=await this.boosterPointsTransactionApiService.boosterPointsTransactionControllerGetHistory(e);this.transactionsBg$.next(t)}catch(e){}}};g([(0,n.mM)("BoosterPointsTransactionService.getTransactionsShare"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",d.c)],m.prototype,"getTransactionsShare",null),g([(0,n.mM)("BoosterPointsTransactionService.periodicUpdateOnSubscribeBg"),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",d.c)],m.prototype,"periodicUpdateOnSubscribeBg",null),m=g([(0,h.k)()],m)},1591:(e,t,r)=>{"use strict";r.d(t,{b:()=>p});var n=r(3732),o=r(2316),i=r(3720),s=r(3288),a=r(2467),u=r(5360),c=r(9994),l=r(6789),f=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class{storyMobileApiService;constructor(e){this.storyMobileApiService=e}getRealStoryRating(e){return(0,o.v)((()=>this.storyMobileApiService.fetchStoryPageWithoutCache(e,1))).pipe((0,i.n)((e=>{if((0,c.v)(e)||!e?.story)return(0,s.$)((()=>"Не удалось получить данные поста"));const t=e.story;return(0,n.vM)(t.story_pluses)&&(0,n.vM)(t.story_minuses)?(0,a.of)({pluses:t.story_pluses,minuses:t.story_minuses}):(0,s.$)((()=>"Данные поста не содержат информацию о рейтинге"))})))}};p=f([(0,u.k)(),d("design:paramtypes",[l.L])],p)},2654:(e,t,r)=>{"use strict";r.d(t,{E:()=>B});var n=r(3732),o=r(5140),i=r(76),s=r(2293),a=r(6126),u=r(8975),c=r(3720),l=r(7968),f=r(7903),d=r(6577),p=r(2908),h=r(5964),y=r(2947),v=r(4878),g=r(6315),b=(0,y.L)((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function m(e){throw new b(e)}var w=r(3288),S=r(6847),_=r(1160),O=r(2467),T=r(9697),C=r(8483),x=r(6412),A=r(5360),E=r(8528),k=r(2316),P=r(9099);function j(e){let t;return(0,k.v)((()=>(t=e(),t))).pipe((0,P.M)({unsubscribe:()=>t.cancel()}))}var M=r(964),I=r(5825),D=r(1591),R=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},N=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let B=class{transactionApiService=M.US;clientService=x.m.get(I.N);boosterRatingService=x.m.get(D.b);transactionClient(e,t,r){return this.clientService.enabledUuid$.pipe((0,a.p)(Boolean),(0,u.s)(1),(0,c.n)((o=>this.init(o,e,t).pipe((0,c.n)((e=>(0,l.H)(r()).pipe((0,c.n)((()=>this.confirm(o,e.uuid,t))),function(e,t){var r=(0,d.v)(e)?{first:e}:"number"==typeof e?{each:e}:e,n=r.first,o=r.each,i=r.with,s=void 0===i?m:i,a=r.scheduler,u=void 0===a?null!=t?t:f.E:a,c=r.meta,l=void 0===c?null:c;if(null==n&&null==o)throw new TypeError("No timeout provided.");return(0,p.N)((function(e,t){var r,i,a=null,c=0,f=function(e){i=(0,g.N)(t,u,(function(){try{r.unsubscribe(),(0,h.Tg)(s({meta:l,lastValue:a,seen:c})).subscribe(t)}catch(e){t.error(e)}}),e)};r=e.subscribe((0,v._)(t,(function(e){null==i||i.unsubscribe(),c++,t.next(a=e),o>0&&f(o)}),void 0,void 0,(function(){(null==i?void 0:i.closed)||null==i||i.unsubscribe(),a=null}))),!c&&f(null!=n?"number"==typeof n?n:+n-u.now():o)}))}({each:20*n.Lf.Second,with:()=>(0,w.$)((()=>"Превышено время ожидания установки плюса"))}),(0,S.W)((t=>this.error(o,e.uuid,(0,E.M)(t)).pipe((0,_.T)((()=>!1)))))))),(0,S.W)((e=>(0,O.of)(!1)))))))}init(e,t,r,n=5){return this.tryInit(e,t,r).pipe((0,c.n)((o=>{if("uuid"in o)return(0,O.of)(o);if(!n)return(0,w.$)((()=>"Исчерпан лимит попыток"));const a=(0,i.A)(o.outDate),u=(0,s.A)(a);return console.log(`Ожидаем завершения другой транзакции (${u})`),(0,T.O)(a).pipe((0,c.n)((()=>this.init(e,t,r,n-1))))})))}tryInit(e,t,r){return this.boosterRatingService.getRealStoryRating(r).pipe((0,c.n)((n=>this.initTransaction(t,r,n,e))))}initTransaction(e,t,r,n){return j((()=>this.transactionApiService.boosterTransactionControllerInit(e,t,r,n)))}confirm(e,t,r){return this.boosterRatingService.getRealStoryRating(r).pipe((0,c.n)((r=>this.confirmTransaction(t,r,e).pipe((0,_.T)((()=>!0)),(0,S.W)((()=>(0,O.of)(!1)))))))}confirmTransaction(e,t,r){return j((()=>this.transactionApiService.boosterTransactionControllerConfirm(e,t,r)))}error(e,t,r){return j((()=>this.transactionApiService.boosterTransactionControllerError(t,{errorText:r},e)))}};R([(0,o.mM)("BoosterTransactionService.init"),N("design:type",Function),N("design:paramtypes",[String,String,Number,Object]),N("design:returntype",C.c)],B.prototype,"init",null),R([(0,o.mM)("BoosterTransactionService.tryInit"),N("design:type",Function),N("design:paramtypes",[String,String,Number]),N("design:returntype",C.c)],B.prototype,"tryInit",null),R([(0,o.mM)("BoosterTransactionService.initTransaction"),N("design:type",Function),N("design:paramtypes",[String,Number,Object,String]),N("design:returntype",C.c)],B.prototype,"initTransaction",null),R([(0,o.mM)("BoosterTransactionService.confirm"),N("design:type",Function),N("design:paramtypes",[String,String,Number]),N("design:returntype",C.c)],B.prototype,"confirm",null),R([(0,o.mM)("BoosterTransactionService.confirmTransaction"),N("design:type",Function),N("design:paramtypes",[String,Object,String]),N("design:returntype",C.c)],B.prototype,"confirmTransaction",null),R([(0,o.mM)("BoosterTransactionService.error"),N("design:type",Function),N("design:paramtypes",[String,String,String]),N("design:returntype",C.c)],B.prototype,"error",null),B=R([(0,A.k)()],B)},8481:(e,t,r)=>{"use strict";r.d(t,{G:()=>n});class n extends Error{}},9994:(e,t,r)=>{"use strict";r.d(t,{v:()=>o});var n=r(3732);function o(e){return(0,n.u4)(e)&&!!e.adultError}},6789:(e,t,r)=>{"use strict";r.d(t,{L:()=>b});var n=r(5419),o=r(3732),i=r(4938),s=r(5140),a=r(8825),u=r(1160),c=r(6412),l=r(5360),f=r(6683),d=r(4031),p=r(3134),h=r(8481),y=r(9994),v=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let b=class{pikabuMobileAuthApiService=c.m.get(d.o);useAuth$=this.pikabuMobileAuthApiService.useAuth$;errorReason$=this.useAuth$.pipe((0,u.T)((e=>e?"Для доступа к данным постов с NSFW необходимо подтвердить возраст и включить опцию 18+":`Для доступа к данным постов с NSFW необходимо авторизоваться в мобильном API. Подробнее в настройках расширения ${f.u}`)));async getStoryOrFail(e){const t=await this.getStory(e);if(!t)throw new h.G("Не удалось загрузить данные поста");if((0,y.v)(t)){const e=await(0,a._)(this.errorReason$);throw new h.G(`Не удалось загрузить данные поста. ${e}`)}return t}async getStoryCommentOrFail(e,t){const r=await this.getStoryComments(e);if(!r)throw new h.G("Не удалось загрузить комментарии поста");if((0,y.v)(r)){const e=await(0,a._)(this.errorReason$);throw new h.G(`Не удалось загрузить комментарии поста. ${e}`)}const n=r.get(t);if(!n)throw new h.G("Данные комментария не найдены");return n}async getStoryVideoByWebmOrNull(e,t){const r=await this.getStoryVideosMapByWebmOrNull(e),n=r?.get(t);return n??null}async getStoryVideosMapByWebmOrNull(e){const t=await this.getStoryVideosOrNull(e);return t?new Map(t.map((e=>[e.data.webm.url,e.data]))):null}async getStoryVideosOrNull(e){const t=await this.getStory(e);if(!t||(0,y.v)(t))return null;return t.story_data.filter((function(e){return"vf"===e.type}))}async getStory(e){const t=await(0,a._)(this.useAuth$),r=await this.getStoryPage(e,1,t);return(0,y.v)(r)?r:r?.story??null}async getStoryComments(e){const t=await this.getStoryAllPagesBg(e);return(0,y.v)(t)?t:t?.comments?new Map(t?.comments.map((e=>[e.comment_id,e]))):null}async getStoryAllPagesBg(e){const t=await(0,a._)(this.useAuth$),r=await this.getStoryPage(e,1,t);if(!r)return null;if((0,y.v)(r))return r;const n=r.story.comments_count??0,o=Math.ceil(n/100);if(1===o)return r;let i=r.comments;const s=[];for(let r=2;r<=o;r++)s.push(this.getStoryPage(e,r,t));const u=await Promise.all(s);for(const e of u)e&&!(0,y.v)(e)&&(i=i.concat(e.comments));return{story:r.story,comments:i}}async getStoryPage(e,t,r){return this.fetchStoryPageWithoutCache(e,t)}async fetchStoryPageWithoutCache(e,t){try{return await this.pikabuMobileAuthApiService.fetchDataWithAuthIfLogged({controller:"story.get",queries:`_story_id=${e}&_page=${t}`,body:{story_id:e,page:t}})}catch(e){return e instanceof p.T&&(console.log(e),47===e.pikabuErrorCode)?{adultError:!0}:null}}};v([(0,n.l2)(30*o.Lf.Second),g("design:type",Function),g("design:paramtypes",[Number,String]),g("design:returntype",Promise)],b.prototype,"getStoryVideoByWebmOrNull",null),v([(0,n.l2)(30*o.Lf.Second),g("design:type",Function),g("design:paramtypes",[Number]),g("design:returntype",Promise)],b.prototype,"getStoryVideosMapByWebmOrNull",null),v([(0,n.l2)(30*o.Lf.Second),g("design:type",Function),g("design:paramtypes",[Number]),g("design:returntype",Promise)],b.prototype,"getStoryVideosOrNull",null),v([(0,n.l2)(5*o.Lf.Second),(0,s.up)("PikabuStoryApiService.getStory"),g("design:type",Function),g("design:paramtypes",[Number]),g("design:returntype",Promise)],b.prototype,"getStory",null),v([(0,n.l2)(5*o.Lf.Second),(0,s.up)("PikabuStoryApiService.getStoryComments"),g("design:type",Function),g("design:paramtypes",[Number]),g("design:returntype",Promise)],b.prototype,"getStoryComments",null),v([(0,n.l2)(30*o.Lf.Second,i.Jb.Background),g("design:type",Function),g("design:paramtypes",[Number]),g("design:returntype",Promise)],b.prototype,"getStoryAllPagesBg",null),v([(0,n.l2)(30*o.Lf.Second,i.Jb.Background),(0,s.up)("PikabuStoryApiService.getStoryPage"),g("design:type",Function),g("design:paramtypes",[Number,Number,Boolean]),g("design:returntype",Promise)],b.prototype,"getStoryPage",null),v([(0,s.up)("PikabuStoryApiService.fetchStoryPageWithoutCache"),g("design:type",Function),g("design:paramtypes",[Number,Number]),g("design:returntype",Promise)],b.prototype,"fetchStoryPageWithoutCache",null),b=v([(0,l.k)()],b)},964:(e,t,r)=>{"use strict";r.d(t,{FP:()=>v,BN:()=>g,Mi:()=>b,Fd:()=>m,US:()=>w,Ds:()=>s});class n extends Error{url;status;statusText;body;request;constructor(e,t,r){super(r),this.name="ApiError",this.url=t.url,this.status=t.status,this.statusText=t.statusText,this.body=t.body,this.request=e}}class o extends Error{constructor(e){super(e),this.name="CancelError"}get isCancelled(){return!0}}class i{#e;#t;#r;#n;#o;#i;#s;constructor(e){this.#e=!1,this.#t=!1,this.#r=!1,this.#n=[],this.#o=new Promise(((t,r)=>{this.#i=t,this.#s=r;const n=e=>{this.#e||this.#t||this.#r||this.#n.push(e)};return Object.defineProperty(n,"isResolved",{get:()=>this.#e}),Object.defineProperty(n,"isRejected",{get:()=>this.#t}),Object.defineProperty(n,"isCancelled",{get:()=>this.#r}),e((e=>{this.#e||this.#t||this.#r||(this.#e=!0,this.#i?.(e))}),(e=>{this.#e||this.#t||this.#r||(this.#t=!0,this.#s?.(e))}),n)}))}get[Symbol.toStringTag](){return"Cancellable Promise"}then(e,t){return this.#o.then(e,t)}catch(e){return this.#o.catch(e)}finally(e){return this.#o.finally(e)}cancel(){if(!(this.#e||this.#t||this.#r)){if(this.#r=!0,this.#n.length)try{for(const e of this.#n)e()}catch(e){return void console.warn("Cancellation threw an error",e)}this.#n.length=0,this.#s?.(new o("Request aborted"))}}get isCancelled(){return this.#r}}const s={BASE:"",VERSION:"1.0",WITH_CREDENTIALS:!1,CREDENTIALS:"include",TOKEN:void 0,USERNAME:void 0,PASSWORD:void 0,HEADERS:void 0,ENCODE_PATH:void 0},a=e=>null!=e,u=e=>"string"==typeof e,c=e=>u(e)&&""!==e,l=e=>"object"==typeof e&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.arrayBuffer&&"function"==typeof e.constructor&&"string"==typeof e.constructor.name&&/^(Blob|File)$/.test(e.constructor.name)&&/^(Blob|File)$/.test(e[Symbol.toStringTag]),f=e=>e instanceof FormData,d=e=>{const t=[],r=(e,n)=>{a(n)&&(Array.isArray(n)?n.forEach((t=>{r(e,t)})):"object"==typeof n?Object.entries(n).forEach((([t,n])=>{r(`${e}[${t}]`,n)})):((e,r)=>{t.push(`${encodeURIComponent(e)}=${encodeURIComponent(String(r))}`)})(e,n))};return Object.entries(e).forEach((([e,t])=>{r(e,t)})),t.length>0?`?${t.join("&")}`:""},p=async(e,t)=>"function"==typeof t?t(e):t,h=async(e,t)=>{const r=await p(t,e.TOKEN),n=await p(t,e.USERNAME),o=await p(t,e.PASSWORD),i=await p(t,e.HEADERS),s=Object.entries({Accept:"application/json",...i,...t.headers}).filter((([e,t])=>a(t))).reduce(((e,[t,r])=>({...e,[t]:String(r)})),{});if(c(r)&&(s.Authorization=`Bearer ${r}`),c(n)&&c(o)){const e=(e=>{try{return btoa(e)}catch(t){return Buffer.from(e).toString("base64")}})(`${n}:${o}`);s.Authorization=`Basic ${e}`}return t.body&&(t.mediaType?s["Content-Type"]=t.mediaType:l(t.body)?s["Content-Type"]=t.body.type||"application/octet-stream":u(t.body)?s["Content-Type"]="text/plain":f(t.body)||(s["Content-Type"]="application/json")),new Headers(s)},y=(e,t)=>new i((async(r,o,i)=>{try{const o=((e,t)=>{const r=e.ENCODE_PATH||encodeURI,n=t.url.replace("{api-version}",e.VERSION).replace(/{(.*?)}/g,((e,n)=>t.path?.hasOwnProperty(n)?r(String(t.path[n])):e)),o=`${e.BASE}${n}`;return t.query?`${o}${d(t.query)}`:o})(e,t),s=(e=>{if(e.formData){const t=new FormData,r=(e,r)=>{u(r)||l(r)?t.append(e,r):t.append(e,JSON.stringify(r))};return Object.entries(e.formData).filter((([e,t])=>a(t))).forEach((([e,t])=>{Array.isArray(t)?t.forEach((t=>r(e,t))):r(e,t)})),t}})(t),c=(e=>{if(void 0!==e.body)return e.mediaType?.includes("/json")?JSON.stringify(e.body):u(e.body)||l(e.body)||f(e.body)?e.body:JSON.stringify(e.body)})(t),p=await h(e,t);if(!i.isCancelled){const a=await(async(e,t,r,n,o,i,s)=>{const a=new AbortController,u={headers:i,body:n??o,method:t.method,signal:a.signal};return e.WITH_CREDENTIALS&&(u.credentials=e.CREDENTIALS),s((()=>a.abort())),await fetch(r,u)})(e,t,o,c,s,p,i),l=await(async e=>{if(204!==e.status)try{const t=e.headers.get("Content-Type");if(t)return["application/json","application/problem+json"].some((e=>t.toLowerCase().startsWith(e)))?await e.json():await e.text()}catch(e){console.error(e)}})(a),f=((e,t)=>{if(t){const r=e.headers.get(t);if(u(r))return r}})(a,t.responseHeader),d={url:o,ok:a.ok,status:a.status,statusText:a.statusText,body:f??l};((e,t)=>{const r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",...e.errors}[t.status];if(r)throw new n(e,t,r);if(!t.ok){const r=t.status??"unknown",o=t.statusText??"unknown",i=(()=>{try{return JSON.stringify(t.body,null,2)}catch(e){return}})();throw new n(e,t,`Generic Error: status: ${r}; status text: ${o}; body: ${i}`)}})(t,d),r(d.body)}}catch(e){o(e)}}));class v{static boosterCandidateControllerGetCandidates(e){return y(s,{method:"GET",url:"/api/booster-candidate",headers:{"X-Pf-Client-Uuid":e}})}}class g{static boosterClientControllerRegisterClient(e){return y(s,{method:"POST",url:"/api/booster-client/register",headers:{"X-Pf-Client-Uuid":e}})}static boosterClientControllerRegisterClientAuto(e,t){return y(s,{method:"POST",url:"/api/booster-client/register-auto",headers:{"X-Pf-Client-Uuid":t},query:{uuid:e}})}static boosterClientControllerGetStatus(e){return y(s,{method:"GET",url:"/api/booster-client/status",headers:{"X-Pf-Client-Uuid":e}})}}class b{static boosterOrderControllerGetOrders(e){return y(s,{method:"GET",url:"/api/booster-order",headers:{"X-Pf-Client-Uuid":e}})}static boosterOrderControllerCreateOrder(e,t){return y(s,{method:"POST",url:"/api/booster-order",headers:{"X-Pf-Client-Uuid":t},body:e,mediaType:"application/json"})}static boosterOrderControllerGetOrder(e,t){return y(s,{method:"GET",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":t}})}static boosterOrderControllerUpdateOrder(e,t,r){return y(s,{method:"PUT",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}static boosterOrderControllerDeleteOrder(e,t){return y(s,{method:"DELETE",url:"/api/booster-order/{orderUuid}",path:{orderUuid:e},headers:{"X-Pf-Client-Uuid":t}})}static boosterOrderControllerDeleteObsolete(e){return y(s,{method:"DELETE",url:"/api/booster-order/obsolete",headers:{"X-Pf-Client-Uuid":e}})}static boosterOrderConditionsControllerGetOrderConditions(e){return y(s,{method:"GET",url:"/api/booster-order-conditions",headers:{"X-Pf-Client-Uuid":e}})}}class m{static boosterPointsTransactionControllerGetHistory(e){return y(s,{method:"GET",url:"/api/booster-points-transaction/history",headers:{"X-Pf-Client-Uuid":e}})}}class w{static boosterTransactionControllerInit(e,t,r,n){return y(s,{method:"POST",url:"/api/booster-transaction/{orderUuid}/{storyId}",path:{orderUuid:e,storyId:t},headers:{"X-Pf-Client-Uuid":n},body:r,mediaType:"application/json"})}static boosterTransactionControllerConfirm(e,t,r){return y(s,{method:"PUT",url:"/api/booster-transaction/{transactionUuid}/confirm",path:{transactionUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}static boosterTransactionControllerError(e,t,r){return y(s,{method:"PUT",url:"/api/booster-transaction/{transactionUuid}/error",path:{transactionUuid:e},headers:{"X-Pf-Client-Uuid":r},body:t,mediaType:"application/json"})}}},4031:(e,t,r)=>{"use strict";r.d(t,{o:()=>h});var n=r(5140),o=r(1160),i=r(8825),s=r(2922),a=r(6412),u=r(5360),c=r(4982),l=r(3134),f=r(746),d=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let h=class{settingsService=a.m.get(c.h);mobileApiAuth$=this.settingsService.getKey$("mobileApiAuth");mobileApiUserId$=this.settingsService.getKey$("mobileApiUserId");pikabuMobileApiService=a.m.get(f.e);useAuth$=(0,s.z)([this.mobileApiAuth$,this.mobileApiUserId$]).pipe((0,o.T)((([e,t])=>e&&!!t)));async fetchDataWithAuthIfLogged(e){const t=await(0,i._)(this.mobileApiAuth$),r=await(0,i._)(this.mobileApiUserId$);if(!t||!r)return this.pikabuMobileApiService.fetchData(e);try{return await this.pikabuMobileApiService.fetchData({...e,body:{...e.body,user_id:r}})}catch(e){throw e instanceof l.T&&401===e.pikabuErrorCode&&(console.log("pikabuErrorCode === 401"),await this.logout()),e}}async auth(e){console.log("auth");const t=await this.pikabuMobileApiService.fetchData({controller:"user.auth",body:e}),r=Number(t.user_id);return console.log(t),await this.settingsService.patch({mobileApiUserId:r,mobileApiUserName:t.user_name}),t}async logout(){console.log("logout"),await this.settingsService.patch({mobileApiUserId:null,mobileApiUserName:null})}async fetchSettings(e){return this.pikabuMobileApiService.fetchData({controller:"settings.get",body:{user_id:`${e}`}})}async putSettings(e){return this.pikabuMobileApiService.fetchData({controller:"settings.set",body:e})}};d([(0,n.up)("PikabuMobileAuthApiService.fetchDataWithAuthIfLogged"),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],h.prototype,"fetchDataWithAuthIfLogged",null),d([(0,n.up)("PikabuMobileAuthApiService.auth"),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],h.prototype,"auth",null),d([(0,n.up)("PikabuMobileAuthApiService.logout"),p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",Promise)],h.prototype,"logout",null),d([(0,n.up)("PikabuMobileAuthApiService.fetchSettings"),p("design:type",Function),p("design:paramtypes",[String]),p("design:returntype",Promise)],h.prototype,"fetchSettings",null),d([(0,n.up)("PikabuMobileAuthApiService.putSettings"),p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],h.prototype,"putSettings",null),h=d([(0,u.k)()],h)},3134:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});class n extends Error{pikabuErrorCode;constructor(e,t){super(e),this.pikabuErrorCode=t}static fromResponseError(e){return new n(`${e.error?.message}`,e.error?.message_code)}static fromHttpError(e){return new n(`Запрос к серверу завершился ошибкой (${e})`)}}},746:(e,t,r)=>{"use strict";r.d(t,{e:()=>f});var n=r(6891),o=r(8825);class i{constructor(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){const t=i.hexChars,r=i.hexOut;let n,o,s,a;for(a=0;a<4;a+=1)for(o=8*a,n=e[a],s=0;s<8;s+=2)r[o+1+s]=t.charAt(15&n),n>>>=4,r[o+0+s]=t.charAt(15&n),n>>>=4;return r.join("")}static _md5cycle(e,t){let r=e[0],n=e[1],o=e[2],i=e[3];r+=(n&o|~n&i)+t[0]-680876936|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[1]-389564586|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[2]+606105819|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[3]-1044525330|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[4]-176418897|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[5]+1200080426|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[6]-1473231341|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[7]-45705983|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[8]+1770035416|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[9]-1958414417|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[10]-42063|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[11]-1990404162|0,n=(n<<22|n>>>10)+o|0,r+=(n&o|~n&i)+t[12]+1804603682|0,r=(r<<7|r>>>25)+n|0,i+=(r&n|~r&o)+t[13]-40341101|0,i=(i<<12|i>>>20)+r|0,o+=(i&r|~i&n)+t[14]-1502002290|0,o=(o<<17|o>>>15)+i|0,n+=(o&i|~o&r)+t[15]+1236535329|0,n=(n<<22|n>>>10)+o|0,r+=(n&i|o&~i)+t[1]-165796510|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[6]-1069501632|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[11]+643717713|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[0]-373897302|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[5]-701558691|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[10]+38016083|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[15]-660478335|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[4]-405537848|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[9]+568446438|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[14]-1019803690|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[3]-187363961|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[8]+1163531501|0,n=(n<<20|n>>>12)+o|0,r+=(n&i|o&~i)+t[13]-1444681467|0,r=(r<<5|r>>>27)+n|0,i+=(r&o|n&~o)+t[2]-51403784|0,i=(i<<9|i>>>23)+r|0,o+=(i&n|r&~n)+t[7]+1735328473|0,o=(o<<14|o>>>18)+i|0,n+=(o&r|i&~r)+t[12]-1926607734|0,n=(n<<20|n>>>12)+o|0,r+=(n^o^i)+t[5]-378558|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[8]-2022574463|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[11]+1839030562|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[14]-35309556|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[1]-1530992060|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[4]+1272893353|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[7]-155497632|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[10]-1094730640|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[13]+681279174|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[0]-358537222|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[3]-722521979|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[6]+76029189|0,n=(n<<23|n>>>9)+o|0,r+=(n^o^i)+t[9]-640364487|0,r=(r<<4|r>>>28)+n|0,i+=(r^n^o)+t[12]-421815835|0,i=(i<<11|i>>>21)+r|0,o+=(i^r^n)+t[15]+530742520|0,o=(o<<16|o>>>16)+i|0,n+=(o^i^r)+t[2]-995338651|0,n=(n<<23|n>>>9)+o|0,r+=(o^(n|~i))+t[0]-198630844|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[7]+1126891415|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[14]-1416354905|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[5]-57434055|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[12]+1700485571|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[3]-1894986606|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[10]-1051523|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[1]-2054922799|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[8]+1873313359|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[15]-30611744|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[6]-1560198380|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[13]+1309151649|0,n=(n<<21|n>>>11)+o|0,r+=(o^(n|~i))+t[4]-145523070|0,r=(r<<6|r>>>26)+n|0,i+=(n^(r|~o))+t[11]-1120210379|0,i=(i<<10|i>>>22)+r|0,o+=(r^(i|~n))+t[2]+718787259|0,o=(o<<15|o>>>17)+i|0,n+=(i^(o|~r))+t[9]-343485551|0,n=(n<<21|n>>>11)+o|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(i.stateIdentity),this}appendStr(e){const t=this._buffer8,r=this._buffer32;let n,o,s=this._bufferLength;for(o=0;o<e.length;o+=1){if(n=e.charCodeAt(o),n<128)t[s++]=n;else if(n<2048)t[s++]=192+(n>>>6),t[s++]=63&n|128;else if(n<55296||n>56319)t[s++]=224+(n>>>12),t[s++]=n>>>6&63|128,t[s++]=63&n|128;else{if(n=1024*(n-55296)+(e.charCodeAt(++o)-56320)+65536,n>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[s++]=240+(n>>>18),t[s++]=n>>>12&63|128,t[s++]=n>>>6&63|128,t[s++]=63&n|128}s>=64&&(this._dataLength+=64,i._md5cycle(this._state,r),s-=64,r[0]=r[16])}return this._bufferLength=s,this}appendAsciiStr(e){const t=this._buffer8,r=this._buffer32;let n,o=this._bufferLength,s=0;for(;;){for(n=Math.min(e.length-s,64-o);n--;)t[o++]=e.charCodeAt(s++);if(o<64)break;this._dataLength+=64,i._md5cycle(this._state,r),o=0}return this._bufferLength=o,this}appendByteArray(e){const t=this._buffer8,r=this._buffer32;let n,o=this._bufferLength,s=0;for(;;){for(n=Math.min(e.length-s,64-o);n--;)t[o++]=e[s++];if(o<64)break;this._dataLength+=64,i._md5cycle(this._state,r),o=0}return this._bufferLength=o,this}getState(){const e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){const t=e.buffer,r=e.state,n=this._state;let o;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],o=0;o<t.length;o+=1)this._buffer8[o]=t.charCodeAt(o)}end(e=!1){const t=this._bufferLength,r=this._buffer8,n=this._buffer32,o=1+(t>>2);this._dataLength+=t;const s=8*this._dataLength;if(r[t]=128,r[t+1]=r[t+2]=r[t+3]=0,n.set(i.buffer32Identity.subarray(o),o),t>55&&(i._md5cycle(this._state,n),n.set(i.buffer32Identity)),s<=4294967295)n[14]=s;else{const e=s.toString(16).match(/(.*?)(.{0,8})$/);if(null===e)return;const t=parseInt(e[2],16),r=parseInt(e[1],16)||0;n[14]=t,n[15]=r}return i._md5cycle(this._state,n),e?this._state:i._hex(this._state)}}if(i.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),i.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),i.hexChars="0123456789abcdef",i.hexOut=[],i.onePassHasher=new i,"5d41402abc4b2a76b9719d911017c592"!==i.hashStr("hello"))throw new Error("Md5 self test failed.");var s=r(6412),a=r(5360),u=r(3134),c=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};const l="kmq4!2cPl)peZ";let f=class{httpService=s.m.get(n.k);async fetchData(e){const t=Date.now(),r={new_sort:1,...e.body},i=this.getHash({...e,body:r},t),s={...r,id:"iws",hash:i,token:t},a=e.queries?`?${e.queries}`:"";try{const t=await(0,o._)(this.httpService.postJson(`https://api.pikabu.ru/v1/${e.controller}${a}`,s,{mode:"same-origin"}));return t.error?Promise.reject(u.T.fromResponseError(t)):t.response}catch(e){return e instanceof n.j?Promise.reject(u.T.fromHttpError(e)):Promise.reject(e)}}getHash(e,t){const r=Object.values(e.body).sort().join(","),n=[l,e.controller,t,r].join(","),o=i.hashStr(n);return btoa(o)}};f=c([(0,a.k)()],f)},4982:(e,t,r)=>{"use strict";r.d(t,{h:()=>m});var n=r(3732),o=r(5140),i=r(5966),s=r(8825),a=r(6126),u=r(1900),c=r(8483),l=r(9099),f=r(5360),d=r(5279),p=r(2320);const h={version:31,addForeverIgnore:!0,showStoryVotes:!0,showUserRegistrationDateIndicator:!0,showCommentVotes:!0,showUserSummary:!0,showVideoLinks:!0,hideShortStoryDesign:!1,hideDonateButton:!1,boosterFirstInitialized:!1,booster:!1,boosterUuid:null,boosterOrderMinutes:30,boosterOrderPoints:10,changeReferralLinks:!0,sendStatistic:!0,requireOnboardingForExtensionMenuButton:!0,showCommentsExpanderButton:!0,expandCommentsAuto:!1,highlightVotedComments:!0,userNotesTool:!0,mobileApiAuth:!1,mobileApiUserId:null,mobileApiUserName:null};var y,v=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const b="pikabu-fixes.settings";let m=class{storageService;settings$=(0,i.n3)((()=>this.getSettingsWithCreate()));constructor(e){this.storageService=e}getKey$(e){return this.settings$.pipe((0,i.um)(e))}async get(){return(0,s._)(this.settings$)}async set(e){await this.storageService.set(b,e)}async patch(e){const t=await this.get(),r={...t,...e};(0,n.XR)(t,r)||await this.set(r)}async setKey(e,t){let r=await this.get();t!==r[e]&&(r={...r,[e]:t},await this.set(r))}getSettingsWithCreate(){return this.storageService.listen(b).pipe((0,l.M)((e=>this.checkSettings(e))),(0,a.p)(n.vM),(0,u.F)(n.XR))}async checkSettings(e){(!e||!e.version||e.version<h.version)&&(e={...h,...e,version:h.version,uuid:e?.uuid??(0,d.A)()},await this.set(e))}};v([(0,o.up)("SettingsService.set"),g("design:type",Function),g("design:paramtypes",[Object]),g("design:returntype",Promise)],m.prototype,"set",null),v([(0,o.up)("SettingsService.patch"),g("design:type",Function),g("design:paramtypes",[Object]),g("design:returntype",Promise)],m.prototype,"patch",null),v([(0,o.up)("SettingsService.setKey"),g("design:type",Function),g("design:paramtypes",["function"==typeof(y="undefined"!=typeof K&&K)?y:Object,Object]),g("design:returntype",Promise)],m.prototype,"setKey",null),v([(0,o.mM)("SettingsService.getSettingsWithCreate"),g("design:type",Function),g("design:paramtypes",[]),g("design:returntype",c.c)],m.prototype,"getSettingsWithCreate",null),m=v([(0,f.k)(),g("design:paramtypes",[p.n])],m)},1838:(e,t,r)=>{"use strict";r.d(t,{p:()=>d});var n=r(4938),o=r(5140),i=r(6847),s=r(1701),a=r(5360),u=r(8528),c=r(7588),l=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let d=class{usageEventService;constructor(e){this.usageEventService=e}onUnhandledError(e){console.error(e),this.saveError(e)}catchError(e){return(0,i.W)((t=>(this.saveError(t),e??s.w)))}saveError(e){const t=n.WU,r=(0,u.M)(e);this.saveErrorBg(r,t)}async saveErrorBg(e,t){this.parseAndSaveErrorBg(e,t)}async parseAndSaveErrorBg(e,t){this.usageEventService.register("error",{errorStr:e,runtime:t})}};l([(0,o.up)("UsageErrorService.saveErrorBg"),f("design:type",Function),f("design:paramtypes",[String,String]),f("design:returntype",Promise)],d.prototype,"saveErrorBg",null),d=l([(0,a.k)(),f("design:paramtypes",[c.J])],d)},7588:(e,t,r)=>{"use strict";r.d(t,{J:()=>l});var n=r(4938),o=r(5140),i=r(602),s=r(5360),a=r(4982),u=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let l=class{settingsService;_db;enabled=null;get db(){return this._db||(this._db=this.openDb()),this._db}constructor(e){this.settingsService=e;const t=n.WU===n.Jb.Background;this.settingsService.getKey$("sendStatistic").subscribe((e=>{this.enabled=e,!e&&t&&this.cleanBg()}))}async shift(e){const t=await this.db,r=await t.getAllKeys("event",null,e);if(!r.length)return[];const n=r[r.length-1],o=IDBKeyRange.upperBound(n),i=await t.getAll("event",o);return await t.delete("event",o),i}register(e,t){if(!1===this.enabled)return;const r={timestamp:Math.ceil(Date.now()/1e3),[e]:t};this.saveEvent(r)}async saveEvent(e){const t=await this.db;await t.put("event",e)}openDb(){if(n.WU!==n.Jb.Background)throw new Error("wrong runtime");return(0,i.P2)("des--usage",1,{upgrade(e){e.createObjectStore("event",{autoIncrement:!0})}})}async cleanBg(){const e=await this.db;await e.clear("event")}};u([(0,o.up)("UsageEventService.shift"),c("design:type",Function),c("design:paramtypes",[Number]),c("design:returntype",Promise)],l.prototype,"shift",null),u([(0,o.up)("UsageEventService.saveEvent"),c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"saveEvent",null),l=u([(0,s.k)(),c("design:paramtypes",[a.h])],l)},2320:(e,t,r)=>{"use strict";r.d(t,{n:()=>p});var n=r(3732),o=r(5140),i=r(5966),s=r(1900),a=r(9050),u=r(3720),c=r(8483),l=r(5360),f=function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class{listen(e){return this.listenKeyChange(e).pipe((0,s.F)(n.XR),(0,a.Z)(null),(0,u.n)((()=>this.get(e))))}async get(e){const t=this.getBgStorage();let r;try{r=await t.get([e])}catch(e){r={}}return e in r?r[e]:null}async set(e,t){const r=this.getBgStorage();await r.set({[e]:t})}async clear(){const e=this.getBgStorage();await e.clear()}listenKeyChange(e){return this.listenChanges().pipe((0,i.um)(e))}listenChanges(){const e=this.getBgStorage();return new c.c((t=>{const r=e=>t.next(e);return e.onChanged.addListener(r),()=>e.onChanged.removeListener(r)}))}getBgStorage(){return r.g.browser?browser.storage.local:chrome.storage.sync}};f([(0,o.mM)("StorageService.get$"),d("design:type",Function),d("design:paramtypes",[String]),d("design:returntype",c.c)],p.prototype,"listen",null),f([(0,o.up)("StorageService.get"),d("design:type",Function),d("design:paramtypes",[String]),d("design:returntype",Promise)],p.prototype,"get",null),f([(0,o.up)("StorageService.set"),d("design:type",Function),d("design:paramtypes",[String,Object]),d("design:returntype",Promise)],p.prototype,"set",null),f([(0,o.up)("StorageService.clear"),d("design:type",Function),d("design:paramtypes",[]),d("design:returntype",Promise)],p.prototype,"clear",null),p=f([(0,l.k)()],p)},6412:(e,t,r)=>{"use strict";r.d(t,{m:()=>p});var n,o=r(8698),i=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(t){var r,n=e.call(this)||this;return n.name="ServiceNotFoundError",n.normalizedIdentifier="<UNKNOWN_IDENTIFIER>","string"==typeof t?n.normalizedIdentifier=t:t instanceof o.o?n.normalizedIdentifier="Token<"+(t.name||"UNSET_NAME")+">":t&&(t.name||(null===(r=t.prototype)||void 0===r?void 0:r.name))&&(n.normalizedIdentifier="MaybeConstructable<"+t.name+">"||0),n}return i(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return'Service with "'+this.normalizedIdentifier+'" identifier was not found in the container. Register it before usage via explicitly calling the "Container.set" function or using the "@Service()" decorator.'},enumerable:!1,configurable:!0}),t}(Error),a=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(e){function t(t){var r,n=e.call(this)||this;return n.name="CannotInstantiateValueError",n.normalizedIdentifier="<UNKNOWN_IDENTIFIER>","string"==typeof t?n.normalizedIdentifier=t:t instanceof o.o?n.normalizedIdentifier="Token<"+(t.name||"UNSET_NAME")+">":t&&(t.name||(null===(r=t.prototype)||void 0===r?void 0:r.name))&&(n.normalizedIdentifier="MaybeConstructable<"+t.name+">"||0),n}return a(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return'Cannot instantiate the requested value for the "'+this.normalizedIdentifier+"\" identifier. The related metadata doesn't contain a factory or a type to instantiate."},enumerable:!1,configurable:!0}),t}(Error),c=r(6429),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},f=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n},d=function(){function e(e){this.services=[],this.id=e}return e.prototype.has=function(e){return!!this.findService(e)},e.prototype.get=function(e){var t=p.of(void 0),r=t.findService(e),n=this.findService(e);if(r&&!0===r.global)return this.getServiceValue(r);if(n)return this.getServiceValue(n);if(r&&this!==t){var o=l({},r);o.value=c._,this.set(o);var i=this.getServiceValue(o);return this.set(l(l({},o),{value:i})),i}if(r)return this.getServiceValue(r);throw new s(e)},e.prototype.getMany=function(e){var t=this;return this.findAllServices(e).map((function(e){return t.getServiceValue(e)}))},e.prototype.set=function(e,t){var r=this;if(e instanceof Array)return e.forEach((function(e){return r.set(e)})),this;if("string"==typeof e||e instanceof o.o)return this.set({id:e,type:null,value:t,factory:void 0,global:!1,multiple:!1,eager:!1,transient:!1});if("function"==typeof e)return this.set({id:e,type:e,value:t,factory:void 0,global:!1,multiple:!1,eager:!1,transient:!1});var n=l({id:new o.o("UNREACHABLE"),type:null,factory:void 0,value:c._,global:!1,multiple:!1,eager:!1,transient:!1},e),i=this.findService(n.id);return i&&!0!==i.multiple?Object.assign(i,n):this.services.push(n),n.eager&&this.get(n.id),this},e.prototype.remove=function(e){var t=this;return Array.isArray(e)?e.forEach((function(e){return t.remove(e)})):this.services=this.services.filter((function(r){return r.id!==e||(t.destroyServiceInstance(r),!1)})),this},e.prototype.reset=function(e){var t=this;switch(void 0===e&&(e={strategy:"resetValue"}),e.strategy){case"resetValue":this.services.forEach((function(e){return t.destroyServiceInstance(e)}));break;case"resetServices":this.services.forEach((function(e){return t.destroyServiceInstance(e)})),this.services=[];break;default:throw new Error("Received invalid reset strategy.")}return this},e.prototype.findAllServices=function(e){return this.services.filter((function(t){return t.id===e}))},e.prototype.findService=function(e){return this.services.find((function(t){return t.id===e}))},e.prototype.getServiceValue=function(e){var t,r=c._;if(e.value!==c._)return e.value;if(!e.factory&&!e.type)throw new u(e.id);if(e.factory)if(e.factory instanceof Array){var n=void 0;try{n=this.get(e.factory[0])}catch(t){if(!(t instanceof s))throw t;n=new e.factory[0]}r=n[e.factory[1]](this,e.id)}else r=e.factory(this,e.id);if(!e.factory&&e.type){var o=e.type,i=(null===(t=Reflect)||void 0===t?void 0:t.getMetadata("design:paramtypes",o))||[],a=this.initializeParams(o,i);a.push(this),r=new(o.bind.apply(o,f([void 0],a)))}if(e.transient||r===c._||(e.value=r),r===c._)throw new u(e.id);return e.type&&this.applyPropertyHandlers(e.type,r),r},e.prototype.initializeParams=function(e,t){var r=this;return t.map((function(t,n){var o=p.handlers.find((function(t){return(t.object===e||t.object===Object.getPrototypeOf(e))&&t.index===n}));return o?o.value(r):t&&t.name&&!r.isPrimitiveParamType(t.name)?r.get(t):void 0}))},e.prototype.isPrimitiveParamType=function(e){return["string","boolean","number","object"].includes(e.toLowerCase())},e.prototype.applyPropertyHandlers=function(e,t){var r=this;p.handlers.forEach((function(n){"number"!=typeof n.index&&(n.object.constructor===e||e.prototype instanceof n.object.constructor)&&n.propertyName&&(t[n.propertyName]=n.value(r))}))},e.prototype.destroyServiceInstance=function(e,t){if(void 0===t&&(t=!1),t||!!e.type||!!e.factory){if("function"==typeof(null==e?void 0:e.value).destroy)try{e.value.destroy()}catch(e){}e.value=c._}},e}(),p=function(){function e(){}return e.of=function(e){if(void 0===e&&(e="default"),"default"===e)return this.globalInstance;var t=this.instances.find((function(t){return t.id===e}));return t||(t=new d(e),this.instances.push(t)),t},e.has=function(e){return this.globalInstance.has(e)},e.get=function(e){return this.globalInstance.get(e)},e.getMany=function(e){return this.globalInstance.getMany(e)},e.set=function(e,t){return this.globalInstance.set(e,t),this},e.remove=function(e){return this.globalInstance.remove(e),this},e.reset=function(e){if(void 0===e&&(e="default"),"default"==e)this.globalInstance.reset(),this.instances.forEach((function(e){return e.reset()}));else{var t=this.instances.find((function(t){return t.id===e}));t&&(t.reset(),this.instances.splice(this.instances.indexOf(t),1))}return this},e.registerHandler=function(e){return this.handlers.push(e),this},e.import=function(e){return this},e.handlers=[],e.globalInstance=new d("default"),e.instances=[],e}()},5360:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});var n=r(6412),o=r(8698),i=r(6429);function s(e){return function(t){var r={id:t,type:t,factory:void 0,multiple:!1,global:!1,eager:!1,transient:!1,value:i._};e instanceof o.o||"string"==typeof e?r.id=e:e&&(r.id=e.id||t,r.factory=e.factory||void 0,r.multiple=e.multiple||!1,r.global=e.global||!1,r.eager=e.eager||!1,r.transient=e.transient||!1),n.m.set(r)}}},6429:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});var n=Symbol("EMPTY_VALUE")},8698:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var n=function(e){this.name=e}},6528:()=>{},8630:(e,t,r)=>{var n;!function(e){!function(){var t="object"==typeof globalThis?globalThis:"object"==typeof r.g?r.g:"object"==typeof self?self:"object"==typeof this?this:function(){try{return Function("return this;")()}catch(e){}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch(e){}}(),n=o(e);function o(e,t){return function(r,n){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0!==t.Reflect&&(n=o(t.Reflect,n)),function(e,t){var r=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,u=!s&&!a,c={create:s?function(){return fe(Object.create(null))}:a?function(){return fe({__proto__:null})}:function(){return fe({})},has:u?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),f="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:ue(),d="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:ce(),p="function"==typeof WeakMap?WeakMap:le(),h=n?Symbol.for("@reflect-metadata:registry"):void 0,y=oe(),v=ie(y);function g(e,t,r,n){if(B(r)){if(!z(e))throw new TypeError;if(!K(t))throw new TypeError;return A(e,t)}if(!z(e))throw new TypeError;if(!F(t))throw new TypeError;if(!F(n)&&!B(n)&&!U(n))throw new TypeError;return U(n)&&(n=void 0),E(e,t,r=V(r),n)}function b(e,t){function r(r,n){if(!F(r))throw new TypeError;if(!B(n)&&!H(n))throw new TypeError;I(e,t,r,n)}return r}function m(e,t,r,n){if(!F(r))throw new TypeError;return B(n)||(n=V(n)),I(e,t,r,n)}function w(e,t,r){if(!F(t))throw new TypeError;return B(r)||(r=V(r)),k(e,t,r)}function S(e,t,r){if(!F(t))throw new TypeError;return B(r)||(r=V(r)),P(e,t,r)}function _(e,t,r){if(!F(t))throw new TypeError;return B(r)||(r=V(r)),j(e,t,r)}function O(e,t,r){if(!F(t))throw new TypeError;return B(r)||(r=V(r)),M(e,t,r)}function T(e,t){if(!F(e))throw new TypeError;return B(t)||(t=V(t)),D(e,t)}function C(e,t){if(!F(e))throw new TypeError;return B(t)||(t=V(t)),R(e,t)}function x(e,t,r){if(!F(t))throw new TypeError;if(B(r)||(r=V(r)),!F(t))throw new TypeError;B(r)||(r=V(r));var n=ae(t,r,!1);return!B(n)&&n.OrdinaryDeleteMetadata(e,t,r)}function A(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!B(n)&&!U(n)){if(!K(n))throw new TypeError;t=n}}return t}function E(e,t,r,n){for(var o=e.length-1;o>=0;--o){var i=(0,e[o])(t,r,n);if(!B(i)&&!U(i)){if(!F(i))throw new TypeError;n=i}}return n}function k(e,t,r){if(P(e,t,r))return!0;var n=re(t);return!U(n)&&k(e,n,r)}function P(e,t,r){var n=ae(t,r,!1);return!B(n)&&W(n.OrdinaryHasOwnMetadata(e,t,r))}function j(e,t,r){if(P(e,t,r))return M(e,t,r);var n=re(t);return U(n)?void 0:j(e,n,r)}function M(e,t,r){var n=ae(t,r,!1);if(!B(n))return n.OrdinaryGetOwnMetadata(e,t,r)}function I(e,t,r,n){ae(r,n,!0).OrdinaryDefineOwnMetadata(e,t,r,n)}function D(e,t){var r=R(e,t),n=re(e);if(null===n)return r;var o=D(n,t);if(o.length<=0)return r;if(r.length<=0)return o;for(var i=new d,s=[],a=0,u=r;a<u.length;a++){var c=u[a];i.has(c)||(i.add(c),s.push(c))}for(var l=0,f=o;l<f.length;l++){c=f[l];i.has(c)||(i.add(c),s.push(c))}return s}function R(e,t){var r=ae(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function N(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function B(e){return void 0===e}function U(e){return null===e}function q(e){return"symbol"==typeof e}function F(e){return"object"==typeof e?null!==e:"function"==typeof e}function $(e,t){switch(N(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=X(e,o);if(void 0!==n){var i=n.call(e,r);if(F(i))throw new TypeError;return i}return L(e,"default"===r?"number":r)}function L(e,t){if("string"===t){var r=e.toString;if(J(r))if(!F(o=r.call(e)))return o;if(J(n=e.valueOf))if(!F(o=n.call(e)))return o}else{var n;if(J(n=e.valueOf))if(!F(o=n.call(e)))return o;var o,i=e.toString;if(J(i))if(!F(o=i.call(e)))return o}throw new TypeError}function W(e){return!!e}function Q(e){return""+e}function V(e){var t=$(e,3);return q(t)?t:Q(t)}function z(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function J(e){return"function"==typeof e}function K(e){return"function"==typeof e}function H(e){switch(N(e)){case 3:case 4:return!0;default:return!1}}function G(e,t){return e===t||e!=e&&t!=t}function X(e,t){var r=e[t];if(null!=r){if(!J(r))throw new TypeError;return r}}function Y(e){var t=X(e,i);if(!J(t))throw new TypeError;var r=t.call(e);if(!F(r))throw new TypeError;return r}function Z(e){return e.value}function ee(e){var t=e.next();return!t.done&&t}function te(e){var t=e.return;t&&t.call(e)}function re(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var o=n.constructor;return"function"!=typeof o||o===e?t:o}function ne(){var e,r,n,o;B(h)||void 0===t.Reflect||h in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=se(t.Reflect));var i=new p,s={registerProvider:a,getProvider:c,setProvider:y};return s;function a(t){if(!Object.isExtensible(s))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case B(r):r=t;break;case r===t:break;case B(n):n=t;break;case n===t:break;default:void 0===o&&(o=new d),o.add(t)}}function u(t,i){if(!B(r)){if(r.isProviderFor(t,i))return r;if(!B(n)){if(n.isProviderFor(t,i))return r;if(!B(o))for(var s=Y(o);;){var a=ee(s);if(!a)return;var u=Z(a);if(u.isProviderFor(t,i))return te(s),u}}}if(!B(e)&&e.isProviderFor(t,i))return e}function c(e,t){var r,n=i.get(e);return B(n)||(r=n.get(t)),B(r)?(B(r=u(e,t))||(B(n)&&(n=new f,i.set(e,n)),n.set(t,r)),r):r}function l(e){if(B(e))throw new TypeError;return r===e||n===e||!B(o)&&o.has(e)}function y(e,t,r){if(!l(r))throw new Error("Metadata provider not registered.");var n=c(e,t);if(n!==r){if(!B(n))return!1;var o=i.get(e);B(o)&&(o=new f,i.set(e,o)),o.set(t,r)}return!0}}function oe(){var e;return!B(h)&&F(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[h]),B(e)&&(e=ne()),!B(h)&&F(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,h,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}function ie(e){var t=new p,r={isProviderFor:function(e,r){var n=t.get(e);return!B(n)&&n.has(r)},OrdinaryDefineOwnMetadata:s,OrdinaryHasOwnMetadata:o,OrdinaryGetOwnMetadata:i,OrdinaryOwnMetadataKeys:a,OrdinaryDeleteMetadata:u};return y.registerProvider(r),r;function n(n,o,i){var s=t.get(n),a=!1;if(B(s)){if(!i)return;s=new f,t.set(n,s),a=!0}var u=s.get(o);if(B(u)){if(!i)return;if(u=new f,s.set(o,u),!e.setProvider(n,o,r))throw s.delete(o),a&&t.delete(n),new Error("Wrong provider for target.")}return u}function o(e,t,r){var o=n(t,r,!1);return!B(o)&&W(o.has(e))}function i(e,t,r){var o=n(t,r,!1);if(!B(o))return o.get(e)}function s(e,t,r,o){n(r,o,!0).set(e,t)}function a(e,t){var r=[],o=n(e,t,!1);if(B(o))return r;for(var i=Y(o.keys()),s=0;;){var a=ee(i);if(!a)return r.length=s,r;var u=Z(a);try{r[s]=u}catch(e){try{te(i)}finally{throw e}}s++}}function u(e,r,o){var i=n(r,o,!1);if(B(i))return!1;if(!i.delete(e))return!1;if(0===i.size){var s=t.get(r);B(s)||(s.delete(o),0===s.size&&t.delete(s))}return!0}}function se(e){var t=e.defineMetadata,r=e.hasOwnMetadata,n=e.getOwnMetadata,o=e.getOwnMetadataKeys,i=e.deleteMetadata,s=new p;return{isProviderFor:function(e,t){var r=s.get(e);return!(B(r)||!r.has(t))||!!o(e,t).length&&(B(r)&&(r=new d,s.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:r,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:i}}function ae(e,t,r){var n=y.getProvider(e,t);if(!B(n))return n;if(r){if(y.setProvider(e,t,v))return v;throw new Error("Illegal state.")}}function ue(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,o=r+1;o<n;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,G(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){if(!G(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(G(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function s(e,t){return[e,t]}}function ce(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function le(){var e=16,t=c.create(),n=o();return function(){function e(){this._key=o()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=o()},e}();function o(){var e;do{e="@@WeakMap@@"+u()}while(c.has(t,e));return t[e]=!0,e}function i(e,t){if(!r.call(e,n)){if(!t)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){if("function"==typeof Uint8Array){var t=new Uint8Array(e);return"undefined"!=typeof crypto?crypto.getRandomValues(t):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(t):s(t,e),t}return s(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var o=t[n];4!==n&&6!==n&&8!==n||(r+="-"),o<16&&(r+="0"),r+=o.toString(16).toLowerCase()}return r}}function fe(e){return e.__=void 0,delete e.__,e}e("decorate",g),e("metadata",b),e("defineMetadata",m),e("hasMetadata",w),e("hasOwnMetadata",S),e("getMetadata",_),e("getOwnMetadata",O),e("getMetadataKeys",T),e("getOwnMetadataKeys",C),e("deleteMetadata",x)}(n,t),void 0===t.Reflect&&(t.Reflect=e)}()}(n||(n={}))},2284:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{A:()=>n})},5419:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>S,l2:()=>E});var n=r(6412),o=r(5360),i=r(8698),s=r(3732),a=r(2316),u=r(3720),c=r(2467),l=r(7718),f=r(8483),d=r(9099),p=r(4938),h=r(321),y=r(602);class v{constructor(e){this.cache=e,this.waitPromises=new Map,this.waitObservables=new Map}wrapObservable(e,t,r=!1){if(this.waitObservables.has(e))return r&&console.log(`[${e}] from waiting observable cache`),this.waitObservables.get(e);const n=(0,a.v)(t).pipe((0,d.M)({next:t=>{r&&console.log(`[${e}] observable next`,t),this.cache.set(e,t)},finalize:()=>{r&&console.log(`[${e}] observable finalize`),this.waitObservables.delete(e)}})),o=(0,a.v)((()=>this.cache.get(e))).pipe((0,u.n)((t=>{if((0,s.O9)(t))return r&&console.log(`[${e}] from cache`),(0,c.of)(t);if(!this.waitObservables.has(e)){r&&console.log(`[${e}] create shared observable`);const t=n.pipe((0,l.t)({refCount:!0,bufferSize:1}));this.waitObservables.set(e,t)}return r&&console.log(`[${e}] wait shared observable`),this.waitObservables.get(e)})));return(0,a.v)((()=>this.waitObservables.get(e)??o))}async wrapPromise(e,t,r=!1){if(this.waitPromises.has(e))return r&&console.log(`[${e}] from waiting promise cache`),this.waitPromises.get(e);const n=await this.cache.get(e);if((0,s.O9)(n))return r&&console.log(`[${e}] from cache`),n;r&&console.log(`[${e}] waiting promise`);const o=t();this.waitPromises.set(e,o);try{const t=await o;return await this.cache.set(e,t),r&&console.log(`[${e}] promise success`),t}catch(t){return r&&console.error(`[${e}] promise error`),Promise.reject(t)}finally{this.waitPromises.delete(e)}}}let g=class{constructor(e,t){this.storage=e,this.params=t,this.autoPrune(!1)}get now(){return Date.now()}async get(e){const t=await this.storage.get(this.params.scope,e);if(t)return this.isValid(t)?t.value:void await this.storage.delete(this.params.scope,e)}async has(e){const t=await this.storage.get(this.params.scope,e);return!!t&&(!!this.isValid(t)||(await this.storage.delete(this.params.scope,e),!1))}async set(e,t){await this.storage.set(this.params.scope,e,{value:t,time:this.now})}async delete(e){await this.storage.delete(this.params.scope,e)}isValid(e){const t=this.now,r=this.params.lifetimeMs;return e.time+r>t}async prune(){await this.storage.prune(this.params.scope,this.now-this.params.lifetimeMs,this.params.size)}async size(){return this.storage.size(this.params.scope)}getWrapper(){return this.wrapper||(this.wrapper=new v(this)),this.wrapper}async autoPrune(e=!0){e&&await this.prune(),(0,s.lD)((()=>this.autoPrune()),this.params.autoPruneInterval??s.Lf.Minute)}};var b=Object.defineProperty,m=Object.getOwnPropertyDescriptor;let w=class{getCache(e){const t=n.m.get(e.type);return new g(t,e)}};w=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?m(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&b(t,r,i),i})([(0,o.k)()],w);const S=new i.o("IndexeddbCacheDbPrefix");var _=Object.defineProperty,O=Object.getOwnPropertyDescriptor;let T=class{constructor(){this.scopedDbMap=new Map}async get(e,t){return await(await this.getDBForScope(e)).get("cache",t)??null}async has(e,t){return await(await this.getDBForScope(e)).count("cache",t)>0}async set(e,t,r){const n=await this.getDBForScope(e);await n.delete("cache",t),await n.put("cache",r,t)}async delete(e,t){await(await this.getDBForScope(e)).delete("cache",t)}async prune(e,t,r){const n=await this.getDBForScope(e),o=await n.getAllKeysFromIndex("cache","by-time",IDBKeyRange.upperBound(t,!0));for(const e of o)await n.delete("cache",e);let i=await this.size(e)-r;if(i<=0)return;const s=await n.transaction("cache").store.index("by-time").openCursor(void 0,"next"),a=[];for(;s&&i--;)a.push(s.primaryKey);for(const e of a)await n.delete("cache",e)}async size(e){return(await this.getDBForScope(e)).count("cache")}async getDBForScope(e){return this.scopedDbMap.has(e)||this.scopedDbMap.set(e,this.getDBWithStore(e)),this.scopedDbMap.get(e)}async getDBWithStore(e){const t=n.m.get(S);return(0,y.P2)(`${t}${e}`,1,{upgrade(e){e.createObjectStore("cache").createIndex("by-time","time")}})}};T=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?O(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&_(t,r,i),i})([(0,o.k)()],T);var C=Object.defineProperty,x=Object.getOwnPropertyDescriptor;let A=class{constructor(){this.scopes=new Map}async get(e,t){return this.getScopedMap(e).get(t)??null}async has(e,t){return this.getScopedMap(e).has(t)}async set(e,t,r){const n=this.getScopedMap(e);n.delete(t),n.set(t,r)}async delete(e,t){this.getScopedMap(e).delete(t)}async prune(e,t,r){const n=this.getScopedMap(e);for(const[e,r]of n){if(r.time>=t)break;n.delete(e)}for(const e of n.keys()){if(n.size<=r)break;n.delete(e)}}async size(e){return this.getScopedMap(e).size}getScopedMap(e){return this.scopes.has(e)||this.scopes.set(e,new Map),this.scopes.get(e)}};A=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?x(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&C(t,r,i),i})([(0,o.k)()],A);const E=(e,t,r)=>(o,i,s)=>{if(t&&t!==p.WU)return;if(!r)switch(p.WU){case p.Jb.Background:case p.Jb.Popup:r=T;break;case p.Jb.ContentScript:case p.Jb.PageScript:r=A}const a=`${o.constructor.name}.${String(i)}`,u=Reflect.getMetadata("design:returntype",o,i),c=u===Promise,l=u===f.c;if(!c&&!l)return void console.error("method should return Promise or Observable");const d=new h.hE,y=n.m.get(w).getCache({type:r,scope:a,lifetimeMs:e,size:1e5}).getWrapper(),v=s.value;s.value=function(...e){const t=()=>v.apply(this,e),r=d.serialize(e);return l?y.wrapObservable(r,t):c?y.wrapPromise(r,t):void 0}}},3732:(e,t,r)=>{"use strict";r.d(t,{Lf:()=>a,M_:()=>n,O9:()=>u,XR:()=>l,lD:()=>d,u4:()=>c,vM:()=>f});const n=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),o=36e5,i=24*o,s=7*i;var a=(e=>(e[e.Second=1e3]="Second",e[e.Minute=6e4]="Minute",e[e.Hour=o]="Hour",e[e.Day=i]="Day",e[e.Week=s]="Week",e))(a||{});function u(e){return void 0!==e}function c(e){return Object(e)===e&&"[object Object]"===toString.call(e)}function l(e,t){if(Array.isArray(e)||Array.isArray(t))return!(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)&&e.every(((e,r)=>l(e,t[r])));if(c(e)&&c(t)){const r=Array.from(new Set([...Object.keys(e),...Object.keys(t)]));return 0===r.length||r.every((r=>l(e[r],t[r])))}return e===t}function f(e){return null!=e}function d(e,t){u(n.requestIdleCallback)?requestIdleCallback(e,{timeout:t}):setTimeout(e,t)}},5885:(e,t,r)=>{"use strict";r.d(t,{H:()=>f,a:()=>m});var n=r(5140),o=r(321),i=r(2467),s=r(3720),a=r(3288),u=r(8483),c=r(1160),l=r(5360);class f extends Error{constructor(e,t){super(),this.request=e,this.response=t}get statusCode(){return this.response.statusCode}get statusText(){return this.response.statusText}toString(){return`HttpError [${this.statusCode}]: ${this.statusText}`}}function d(e){const t={};for(const[r,n]of e)t[r]=n;return t}function p(e,t){return(0,i.of)(t).pipe((0,s.n)((async t=>{const r={statusCode:t.status,statusText:t.statusText,headers:d(t.headers)};if(e.parseResponseAsJson){const e=t.clone();try{r.bodyJson=await e.json()}catch(e){if(t.ok)throw e}}if(e.parseResponseAsText){const n="string"==typeof e.parseResponseAsText?e.parseResponseAsText:void 0,o=t.clone();if(!o.body)throw new Error("Response body is empty");const i=await o.body.pipeThrough(new TextDecoderStream(n)).getReader().read();r.bodyText=i.value}return r})))}const h={type:f,prefix:"HttpError",parse:function(e,t){const r=t.parse(e),n=new f(r.request,r.response);return n.stack=r.stack,n},stringify:function(e,t){return t.serialize({request:e.request,response:e.response,stack:e.stack})}};var y=Object.defineProperty,v=Object.getOwnPropertyDescriptor,g=(e,t,r,n)=>{for(var o,i=n>1?void 0:n?v(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&y(t,r,i),i};const b=[...o.dB,h];let m=class{getJson(e,t){return this.requestJson("GET",e,t)}postJson(e,t,r){return this.requestJson("POST",e,t,r)}requestJson(e,t,r,n){const o={Accept:"application/json"};let i="";return r&&(o["Content-Type"]="application/json",i=JSON.stringify(r)),this.fetchJson({...n,url:t,method:e,body:i,headers:{...null==n?void 0:n.headers,...o}})}fetchJson(e){return this.request({...e,parseResponseAsJson:!0,parseResponseAsText:!1}).pipe((0,c.T)((e=>e.bodyJson)))}fetchText(e){return this.request({...e,parseResponseAsJson:!1,parseResponseAsText:e.parseResponseAsText??!0}).pipe((0,c.T)((e=>e.bodyText)))}request(e){return this.requestThroughFetchBg(e).pipe((0,s.n)((t=>t.ok?p(e,t):p(e,t).pipe((0,s.n)((t=>(0,a.$)((()=>new f(e,t)))))))))}requestThroughFetchBg(e){return this.fetchBg(e.url,{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,referrer:e.referrer,referrerPolicy:e.referrerPolicy,redirect:e.redirect})}fetchBg(...e){return new u.c((t=>{const r=new AbortController;try{fetch(...e).then((e=>t.next(e))).catch((e=>t.error(e))).finally((()=>t.complete()))}catch(e){t.error(e)}return()=>r.abort()}))}};g([(0,n.mM)("HttpService.request",!1,b)],m.prototype,"request",1),m=g([(0,l.k)()],m)},6891:(e,t,r)=>{"use strict";r.d(t,{j:()=>n.H,k:()=>n.a});r(8630);var n=r(5885)},2891:(e,t,r)=>{"use strict";r.d(t,{B:()=>q,G:()=>A,a:()=>P,b:()=>j,c:()=>M,d:()=>I});var n=r(3732),o=r(5966),i=r(1701),s=r(2316),a=r(8483),u=r(7718),c=r(7791),l=r(1485),f=r(3720),d=r(3288),p=r(9050),h=r(6978),y=r(3160),v=r(9697),g=r(9741),b=r(2467),m=r(6126),w=r(8825),S=r(8452),_=r(1160),O=r(9099),T=r(6412),C=r(5360),x=r(4938);class A{constructor(e,t){this.sendEventType=e,this.listenEventType=t,this.disconnect$=i.w,this.message$=(0,s.v)((()=>this.listenMessage())).pipe((0,o.Vk)())}sendMessage(e){n.M_.postMessage({type:this.sendEventType,payload:e})}listenMessage(){return new a.c((e=>{const t=t=>{(0,n.u4)(t.data)&&t.data.type===this.listenEventType&&e.next(t.data.payload)};return n.M_.addEventListener("message",t),()=>{n.M_.removeEventListener("message",t)}}))}}class E{constructor(e){this.port=e,this.disconnect$=(0,s.v)((()=>this.listenDisconnect())).pipe((0,u.t)()),this.message$=(0,s.v)((()=>this.listenMessage())).pipe((0,c.Q)(this.disconnect$),(0,o.Vk)())}sendMessage(e){this.port.postMessage(e)}listenDisconnect(){return new a.c((e=>{const t=()=>{e.next(),e.complete()};return this.port.onDisconnect.addListener(t),()=>{this.port.onDisconnect.removeListener(t)}}))}listenMessage(){return new a.c((e=>{const t=t=>{e.next(t)};return this.port.onMessage.addListener(t),()=>{this.port.onMessage.removeListener(t)}}))}}class k{constructor(){this.extensionService=T.m.get(x.r7),this.runtime=this.extensionService.runtime,this.tabs=this.extensionService.tabs,this.disconnect$=i.w,this.message$=this.listenMessages()}async sendMessage(e){var t,r;const n=await(null==(t=this.tabs)?void 0:t.query({url:this.getHosts()}));for(const t of n??[])if(t.id)try{await(null==(r=this.tabs)?void 0:r.sendMessage(t.id,e))}catch(e){console.error(e)}}listenMessages(){return new a.c((e=>{var t;const r=t=>{e.next(t)};return null==(t=this.runtime)||t.onMessage.addListener(r),()=>{var e;return null==(e=this.runtime)?void 0:e.onMessage.removeListener(r)}}))}getHosts(){var e,t;const r=null==(e=this.runtime)?void 0:e.getManifest();return r?(null==(t=r.content_scripts)?void 0:t.map((e=>e.matches)).flat().filter(n.vM))??[]:[]}}const P="[FromContentToPage]",j="[FromPageToContent]",M="[GetExtensionIdRequest]",I="[GetExtensionIdResponse]";var D=Object.defineProperty,R=Object.getOwnPropertyDescriptor;let N=class{constructor(){this.extensionId$=new g.m(1),this.extensionService=T.m.get(x.r7)}setExtensionId(e){this.extensionId$.next(e)}listenConnection(){return x.WU===x.Jb.Background?this.listenConnect():this.createConnection()}listenConnect(){return(0,n.vM)(this.extensionService.contextV3)?this.listenPortConnect():this.createTabsConnection()}listenPortConnect(){const e=this.extensionService.runtime;if(!e)throw new Error("runtime not defined");return new a.c((t=>{const r=e=>{t.next(new E(e))};return e.onConnectExternal.addListener(r),()=>{e.onConnectExternal.removeListener(r)}}))}createConnection(){return(0,n.vM)(this.extensionService.contextV3)?this.createDirectConnection():this.createContentScriptConnection()}createDirectConnection(){var e;const t=null==(e=this.extensionService.contextV3)?void 0:e.runtime;if(!t)throw new Error("runtime not defined");return this.extensionId$.pipe((0,_.T)((e=>{try{return new E(t.connect(e))}catch(e){throw console.error(t.lastError),e}})),(0,l.F)((0,f.n)((e=>e.disconnect$.pipe((0,f.n)((()=>(0,d.$)((()=>new Error("Port disconnected"))))),(0,p.Z)(e),(0,h.B)(0)))),(0,y.L)({delay:(e,t)=>(console.log(e),console.log(`PF: Connect retry count: ${t}`),(0,v.O)(t*n.Lf.Second)),resetOnSuccess:!0})))}createContentScriptConnection(){return(0,b.of)(new A(j,P))}createTabsConnection(){return(0,b.of)(new k)}};N=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?R(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&D(t,r,i),i})([(0,C.k)()],N);var B=Object.defineProperty,U=Object.getOwnPropertyDescriptor;let q=class{constructor(){this.backgroundConnectionService=T.m.get(N),this.connection$=(0,s.v)((()=>this.backgroundConnectionService.listenConnection())).pipe((0,u.t)()),this.connectionMessage$=(0,s.v)((()=>this.listenConnectionMessage())).pipe((0,o.Vk)()),this.openedPorts$=(0,s.v)((()=>this.listenOpenedPorts())).pipe((0,u.t)()),this.connectorMessage$=(0,s.v)((()=>this.listenConnectorMessage())).pipe((0,o.Vk)())}listenMessage(e){return this.connectorMessage$.pipe((0,m.p)((t=>t.type===e)),(0,_.T)((e=>e.payload)))}async postMessage(e,t){const r={"[ConnectorMessage]":!0,type:e,payload:t},n=await(0,w._)(this.openedPorts$);for(const e of n)try{e.sendMessage(r)}catch(e){console.error(e)}}listenConnectionMessage(){return this.connection$.pipe((0,S.Z)((e=>e.message$)))}listenConnectorMessage(){return this.connectionMessage$.pipe((0,m.p)((e=>function(e){return(0,n.u4)(e)&&"[ConnectorMessage]"in e}(e))))}listenOpenedPorts(){const e=new Set;return this.connection$.pipe((0,O.M)((t=>e.add(t))),(0,S.Z)((t=>t.disconnect$.pipe((0,O.M)((()=>e.delete(t))),(0,p.Z)(t)))),(0,_.T)((()=>e)))}};q=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?U(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&B(t,r,i),i})([(0,C.k)()],q)},5140:(e,t,r)=>{"use strict";r.d(t,{mM:()=>Q,up:()=>V});r(8630);var n=r(2891),o=(r(8905),r(3732)),i=r(5966),s=r(321),a=r(6126),u=r(7903),c=r(9697);function l(e,t){return void 0===e&&(e=0),void 0===t&&(t=u.E),e<0&&(e=0),(0,c.O)(e,e,t)}var f=r(1160),d=r(2908),p=r(4878),h=r(2357),y=r(5964);var v=r(2316),g=r(1005),b=r(3720),m=r(8452),w=r(7968),S=r(9099),_=r(6847),O=r(1701),T=r(4240),C=r(7791),x=r(8483),A=r(3288);var E=r(9050),k=r(6978),P=r(8825),j=r(6412),M=r(5360),I=r(5279),D=r(4938);const R="MM.Event";function N(e){return(0,o.u4)(e)&&e.event===R}var B=Object.defineProperty,U=Object.getOwnPropertyDescriptor;const q="[EventsService.message]";let F=class{constructor(){this.events$=(0,i.n3)((()=>this.listenAllEvents())),this.serializer=new s.hE}listenEvent(e){return this.events$.pipe((0,a.p)((t=>t.type===e)))}async emitEvent(e,t){const r=(0,I.A)(),o={event:R,type:e,data:t,uuid:r};await j.m.get(n.B).postMessage(q,this.serializer.serialize(o))}listenAllEvents(){const e=j.m.get(n.B),t=l(10*o.Lf.Second);return e.listenMessage(q).pipe((0,f.T)((e=>this.serializer.parse(e))),(0,a.p)(N),(r=e=>e.uuid,i=t,(0,d.N)((function(e,t){var n=new Set;e.subscribe((0,p._)(t,(function(e){var o=r?r(e):e;n.has(o)||(n.add(o),t.next(e))}))),i&&(0,y.Tg)(i).subscribe((0,p._)(t,(function(){return n.clear()}),h.l))}))));var r,i}};F=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?U(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&B(t,r,i),i})([(0,M.k)()],F);var $=Object.defineProperty,L=Object.getOwnPropertyDescriptor;let W=class{constructor(){this.eventsService=j.m.get(F),this.runtime=D.WU,this.eventName="RemoteProcessorService.command",this.aliveIntervalMs=5e3,this.commandEvent$=(0,v.v)((()=>this.eventsService.listenEvent(this.eventName))),this.command$=this.commandEvent$.pipe((0,f.T)((e=>e.data)),(0,g.u)()),this.serializer=new s.hE}setMethodProcessor(e,t,r=0,n=!1){n&&this.log("setMethodProcessor",e);const o=this.getSubscribe(e);return(0,c.O)(r).pipe((0,b.n)((()=>o)),(0,m.Z)((r=>{const o=r.uuid,i=this.getUnsubscribe(o,e,n),s=this.getProcessorTapObserver(o,n),a=this.getSubscriptionAliveEmitter(o,n),u=(0,w.H)(t(r.input)).pipe((0,S.M)(s),(0,_.W)((e=>(this.emitCommand({type:"error",uuid:o,data:this.serializer.serialize(e)},n),O.w))));return(0,T.h)(a,u).pipe((0,C.Q)(i))})),(0,f.T)((()=>{})))}getMethodObservable(e,t,r=!1){return r&&this.log("getMethodObservable",e),(0,v.v)((()=>{r&&this.log("getMethodObservable.defer",e);const n=(0,I.A)(),o=new x.c((()=>{this.emitCommand({type:"subscribe",uuid:n,methodName:e,input:t},r)})),i=this.getCommandByUuid(n),s=i.pipe((0,a.p)((e=>"next"===e.type))),u=i.pipe((0,a.p)((e=>"error"===e.type))),l=s.pipe((0,S.M)((e=>r&&this.log("next",e))),(0,f.T)((e=>this.serializer.parse(e.data)))),h=u.pipe((0,b.n)((t=>(0,A.$)((()=>this.serializer.parse(t.data)??new Error(`unknown error from ${e}`)))))),v=this.getComplete(n,r),g=this.getSubscribeAliveEmitter(n,e,r),m=this.getSubscriptionTimeout(n,e,r);return(0,T.h)(o,g,l,h).pipe((0,C.Q)(m),(w={delay:this.aliveIntervalMs},k=1/0,null!=w&&("object"==typeof w?(_=w.count,k=void 0===_?1/0:_,E=w.delay):k=w),k<=0?function(){return O.w}:(0,d.N)((function(e,t){var r,n=0,o=function(){if(null==r||r.unsubscribe(),r=null,null!=E){var e="number"==typeof E?(0,c.O)(E):(0,y.Tg)(E(n)),o=(0,p._)(t,(function(){o.unsubscribe(),i()}));e.subscribe(o)}else i()},i=function(){var i=!1;r=e.subscribe((0,p._)(t,void 0,(function(){++n<k?r?o():i=!0:t.complete()}))),i&&o()};i()}))),(0,S.M)({unsubscribe:()=>this.emitCommand({type:"unsubscribe",uuid:n},r)}),(0,C.Q)(v));var w,_,E,k}))}getCommandByUuid(e){return this.command$.pipe((0,a.p)((t=>t.uuid===e)))}getUnsubscribe(e,t,r=!1){const n=this.getCommandByUuid(e),o=n.pipe((0,a.p)((e=>"unsubscribe"===e.type)),(0,S.M)((()=>r&&this.log(`${e}: unsubscribe command received`)))),i=n.pipe((0,a.p)((e=>"subscribe-alive"===e.type)),(0,E.Z)(null),(0,k.B)(3*this.aliveIntervalMs),(0,S.M)((()=>r&&this.warn(t,`${e}: subscribe-alive timeout`))));return(0,T.h)(o,i).pipe((0,f.T)((()=>{})))}getComplete(e,t=!1){return this.getCommandByUuid(e).pipe((0,a.p)((e=>"complete"===e.type)),(0,S.M)((()=>t&&this.log(`${e}: complete command received`)))).pipe((0,f.T)((()=>{})))}getSubscriptionTimeout(e,t,r=!1){return this.getCommandByUuid(e).pipe((0,a.p)((e=>"subscription-alive"===e.type)),(0,f.T)((()=>null)),(0,E.Z)(null),(0,k.B)(3*this.aliveIntervalMs),(0,S.M)((()=>r&&this.log(t,`${e}: subscription-alive timeout`))))}getSubscribe(e){return this.command$.pipe((0,a.p)((t=>"subscribe"===t.type&&t.methodName===e)))}getProcessorTapObserver(e,t=!1){return{next:r=>this.emitCommand({type:"next",uuid:e,data:this.serializer.serialize(r)},t),complete:()=>this.emitCommand({type:"complete",uuid:e},t)}}getSubscriptionAliveEmitter(e,t=!1){return l(this.aliveIntervalMs).pipe((0,f.T)((()=>this.emitCommand({type:"subscription-alive",uuid:e},t))),(0,a.p)((()=>!1)))}getSubscribeAliveEmitter(e,t,r=!1){return l(this.aliveIntervalMs).pipe((0,f.T)((()=>this.emitCommand({type:"subscribe-alive",methodName:t,uuid:e},r))),(0,a.p)((()=>!1)))}emitCommand(e,t=!1){this.eventsService.emitEvent(this.eventName,e),t&&this.log("emitCommand",e)}log(...e){console.log(this.runtime,...e)}warn(...e){console.warn(this.runtime,...e)}};W=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?L(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&$(t,r,i),i})([(0,M.k)()],W);const Q=(e,t=!1,r=s.dB)=>{const n=new s.hE(r);return(r,o,i)=>{const s=D.WU;if(D.Jb.Background===s)return t&&console.log(e,"Background runtime (register processor)",s),void j.m.get(W).setMethodProcessor(e,(e=>{var t;const o=n.parse(e);try{const e=null==(t=i.value)?void 0:t.call(function(){if(j.m.has(r.constructor))return j.m.get(r.constructor)}(),...o);return e?(0,w.H)(e):(0,A.$)((()=>new Error("expect Observable result")))}catch(e){return console.error(e),(0,A.$)((()=>e))}}),0,t).subscribe();t&&console.log(e,"other runtime (register proxy)",s),i.value=function(...r){const o=j.m.get(W),i=n.serialize(r);return o.getMethodObservable(e,i,t)}}},V=(e,t=!1,r=s.dB)=>{const n=new s.hE(r);return(r,o,i)=>{const s=D.WU;if(D.Jb.Background===s)return t&&console.log(e,"Background runtime (register processor)",s),void j.m.get(W).setMethodProcessor(e,(e=>{var t;const o=n.parse(e);try{const e=null==(t=i.value)?void 0:t.call(function(){if(j.m.has(r.constructor))return j.m.get(r.constructor)}(),...o);return e&&e instanceof Promise?(0,w.H)(e):(0,A.$)((()=>new Error("expect Promise")))}catch(e){return console.error(e),(0,A.$)((()=>e))}}),0,t).subscribe();t&&console.log(e,"other runtime (register proxy)",s),i.value=function(...r){const o=j.m.get(W),i=n.serialize(r),s=o.getMethodObservable(e,i,t);return(0,P._)(s)}}}},8905:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});var n=r(4938),o=r(1701),i=r(8483),s=r(6412);class a{constructor(){this.extensionService=s.m.get(n.r7),this.runtime=this.extensionService.runtime,this.disconnect$=o.w,this.message$=this.listenMessages()}sendMessage(e){const t=this.extensionService.contextV3;null!=t&&t.runtime&&t.runtime.sendMessage(e);const r=this.extensionService.contextV2;null!=r&&r.runtime&&r.runtime.sendMessage(e)}listenMessages(){return new i.c((e=>{var t;const r=t=>{e.next(t)};return null==(t=this.runtime)||t.onMessage.addListener(r),()=>{var e;return null==(e=this.runtime)?void 0:e.onMessage.removeListener(r)}}))}}},4938:(e,t,r)=>{"use strict";r.d(t,{Jb:()=>l,WU:()=>f,r7:()=>h,zR:()=>g});r(8630);var n=r(3732),o=r(5360),i=r(6412),s=r(9336),a=r(8975),u=r(7718),c=r(8825),l=(e=>(e.Background="background",e.Popup="popup",e.ContentScript="content-script",e.PageScript="page-script",e))(l||{});const f=(0,n.vM)(n.M_.chrome)?function(e){if(!(0,n.vM)(e.extension))return l.PageScript;const t=e.extension;return"declarativeNetRequest"in e?"getBackgroundPage"in t&&t.getBackgroundPage()!==n.M_?l.Popup:l.Background:l.ContentScript}(n.M_.chrome):(0,n.vM)(n.M_.browser)?function(e){const t=e.extension;return"declarativeNetRequest"in e?"getBackgroundPage"in t&&t.getBackgroundPage()!==n.M_?l.Popup:l.Background:l.ContentScript}(n.M_.browser):l.PageScript;var d=Object.defineProperty,p=Object.getOwnPropertyDescriptor;let h=class{constructor(){var e,t,r,o;this.contextV2=n.M_.browser??null,this.contextV3=this.contextV2?null:n.M_.chrome??null,this.context=this.contextV3??this.contextV2??null,this.runtime=(null==(e=this.context)?void 0:e.runtime)??null,this.tabs=(null==(t=this.context)?void 0:t.tabs)??null,this.notifications=(null==(r=this.context)?void 0:r.notifications)??null,this.management=(null==(o=this.context)?void 0:o.management)??null}};h=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?p(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&d(t,r,i),i})([(0,o.k)()],h);var y=Object.defineProperty,v=Object.getOwnPropertyDescriptor;let g=class{async loadResourceFile(e){const t=i.m.get(h).runtime;if(!t)throw new Error("runtime not available");await function(e,t="utf-8"){const r=document.getElementsByTagName("body")[0],n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e),n.setAttribute("charset",t);const o=(0,s.R)(n,"load").pipe((0,a.s)(1),(0,u.t)(1));return r.appendChild(n),(0,c._)(o)}(t.getURL(e))}};g=((e,t,r,n)=>{for(var o,i=n>1?void 0:n?v(t,r):t,s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n?o(t,r,i):o(i))||i);return n&&i&&y(t,r,i),i})([(0,o.k)()],g)},5966:(e,t,r)=>{"use strict";r.d(t,{n3:()=>d,Zm:()=>p,um:()=>h,Vk:()=>y});var n=r(1485),o=r(1005),i=r(9741),s=r(9697),a=r(2316),u=r(3720),c=r(1150),l=r(1900);var f=r(1160);function d(e,t=10){return(0,a.v)(e).pipe(function(e=10){return(0,n.F)((0,o.u)({connector:()=>new i.m(1),resetOnRefCountZero:()=>(0,s.O)(e)}))}(t))}function p(){return(0,n.F)((0,u.n)((()=>c.t)))}function h(e){return(0,n.F)((t=e,(0,l.F)((function(e,n){return r?r(e[t],n[t]):e[t]===n[t]}))),(0,f.T)((t=>t[e])));var t,r}function y(e=10){return(0,o.u)({resetOnRefCountZero:()=>(0,s.O)(e)})}},321:(e,t,r)=>{"use strict";r.d(t,{dB:()=>s,hE:()=>u});var n=r(3732);const o={type:Date,prefix:"Date",parse:function(e){return new Date(e)},stringify:function(e){return e.toISOString()}},i={type:Error,prefix:"Error",parse:function(e,t){const r=t.parse(e),n=new Error(r.message);return n.name=r.name,n.stack=r.stack,n},stringify:function(e,t){return t.serialize({message:e.message,name:e.name,stack:e.stack})}},s=[o,{type:FormData,prefix:"FormData",parse:function(e,t){const r=new FormData,n=t.parse(e);for(const e in n)r.set(e,n[e]);return r},stringify:function(e,t){const r={};for(const[t,n]of e.entries())r[t]=n;return t.serialize(r)}},i,{type:Map,prefix:"Map",parse:function(e,t){const r=t.parse(e);return new Map(r)},stringify:function(e,t){const r=[...e.entries()];return t.serialize(r)}}],a=class e{constructor(e=s){this.byPrefix=new Map;for(const t of e)this.byPrefix.set(t.prefix,t)}serialize(e){const t=this.prepareToSerialize(e);return JSON.stringify(t)}parse(e){try{const t=JSON.parse(e);return this.afterParse(t)}catch{return}}prepareToSerialize(t){if(!(0,n.vM)(t))return t;if((0,n.u4)(t))for(const e in t){const r=this.prepareToSerialize(t[e]);t[e]!==r&&(t={...t,[e]:r})}if(Array.isArray(t))return t.map(this.prepareToSerialize.bind(this));for(const[,r]of this.byPrefix)if(t instanceof r.type){const n=r.stringify(t,this);return`${e.MAPPER_PREFIX}${r.prefix}${e.SEPARATOR}${n}`}return t}afterParse(t){if((0,n.u4)(t))for(const e in t)t[e]=this.afterParse(t[e]);if(Array.isArray(t))return t.map(this.afterParse.bind(this));if("string"==typeof t&&t.startsWith(e.MAPPER_PREFIX)){const[r,n]=t.split(e.SEPARATOR),o=r.replace(e.MAPPER_PREFIX,""),i=this.byPrefix.get(o);if(i)return i.parse(n,this)}return t}};a.MAPPER_PREFIX="|-MAPPER-|",a.SEPARATOR="|-DATA-|";let u=a},602:(e,t,r)=>{"use strict";r.d(t,{P2:()=>y});const n=(e,t)=>t.some((t=>e instanceof t));let o,i;const s=new WeakMap,a=new WeakMap,u=new WeakMap;let c={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return s.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return p(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function l(e){c=e(c)}function f(e){return(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(h(this),t),p(this.request)}:function(...t){return p(e.apply(h(this),t))}}function d(e){return"function"==typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(s.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));s.set(e,t)}(e),n(e,o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,c):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(p(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",i)}));return u.set(t,e),t}(e);if(a.has(e))return a.get(e);const t=d(e);return t!==e&&(a.set(e,t),u.set(t,e)),t}const h=e=>u.get(e);function y(e,t,{blocked:r,upgrade:n,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=p(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(p(s.result),e.oldVersion,e.newVersion,p(s.transaction),e)})),r&&s.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}const v=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],b=new Map;function m(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(b.get(t))return b.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,o=g.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!o&&!v.includes(r))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),o&&i.done]))[0]};return b.set(t,i),i}l((e=>({...e,get:(t,r,n)=>m(t,r)||e.get(t,r,n),has:(t,r)=>!!m(t,r)||e.has(t,r)})));const w=["continue","continuePrimaryKey","advance"],S={},_=new WeakMap,O=new WeakMap,T={get(e,t){if(!w.includes(t))return e[t];let r=S[t];return r||(r=S[t]=function(...e){_.set(this,O.get(this)[t](...e))}),r}};async function*C(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const r=new Proxy(t,T);for(O.set(r,t),u.set(r,h(t));t;)yield r,t=await(_.get(r)||t.continue()),_.delete(r)}function x(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}l((e=>({...e,get:(t,r,n)=>x(t,r)?C:e.get(t,r,n),has:(t,r)=>x(t,r)||e.has(t,r)})))},1635:(e,t,r)=>{"use strict";r.d(t,{AQ:()=>f,C6:()=>o,Ju:()=>a,N3:()=>l,YH:()=>s,fX:()=>c,sH:()=>i,xN:()=>d,zs:()=>u});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function i(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}Object.create;function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function c(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function l(e){return this instanceof l?(this.v=e,this):new l(e)}function f(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||a(e,t)}))},t&&(n[e]=t(n[e])))}function a(e,t){try{(r=o[e](t)).value instanceof l?Promise.resolve(r.value.v).then(u,c):f(i[0][2],r)}catch(e){f(i[0][3],e)}var r}function u(e){a("next",e)}function c(e){a("throw",e)}function f(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function d(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=a(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}Object.create;"function"==typeof SuppressedError&&SuppressedError},5279:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function a(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}const u=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const s=(e=e||{}).random??e.rng?.()??function(){if(!o){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");o=crypto.getRandomValues.bind(crypto)}return o(i)}();if(s.length<16)throw new Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return a(s)}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";r(8630);var e=r(4938),t=r(6412),n=r(2891),o=r(8905);r(3732);t.m.get(e.r7).contextV2&&function(){const e=new o.R,t=new n.G(n.a,n.b);e.message$.subscribe((e=>t.sendMessage(e))),t.message$.subscribe((t=>e.sendMessage(t)))}(),function(){const r=new n.G(n.d,n.c);r.message$.subscribe((()=>{const n=t.m.get(e.r7).runtime;if(!n)throw new Error("runtime not available");r.sendMessage({id:n.id})}))}()})(),(()=>{"use strict";var e=r(4938);const t=e.WU;t!==e.Jb.ContentScript&&console.error(`ContentScript EXTENSION_CURRENT_RUNTIME_TYPE: ${t}`)})(),(()=>{"use strict";r(8630)})(),(()=>{"use strict";var e=r(4938);r(6412).m.get(e.zR).loadResourceFile("page-script.js")})(),(()=>{"use strict";var e=r(5419);r(6412).m.set(e.Fc,"des--cache-")})(),(()=>{"use strict";var e=r(6412),t=r(4365),n=r(5825),o=r(2481),i=r(475),s=r(9444),a=r(1591),u=r(2654);e.m.get(n.N),e.m.get(t.$),e.m.get(o.Q),e.m.get(u.E),e.m.get(a.b),e.m.get(i.k),e.m.get(s.d)})(),(()=>{"use strict";r(964).Ds.BASE="https://pikabu-fixes.ru"})(),(()=>{"use strict";var e=r(6412),t=r(4982);e.m.get(t.h)})(),(()=>{"use strict";var e=r(4384),t=r(6412),n=r(1838);e.$.onUnhandledError=e=>{t.m.get(n.p).onUnhandledError(e)}})(),(()=>{"use strict";var e=r(6412),t=r(2320);e.m.get(t.n)})()})();