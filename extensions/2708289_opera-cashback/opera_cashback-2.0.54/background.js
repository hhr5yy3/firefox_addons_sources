(()=>{var e={7757:(e,r,t)=>{e.exports=t(5666)},5666:e=>{var r=function(e){"use strict";var r,t=Object.prototype,n=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",i=a.toStringTag||"@@toStringTag";function c(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{c({},"")}catch(e){c=function(e,r,t){return e[r]=t}}function g(e,r,t,n){var a=r&&r.prototype instanceof h?r:h,o=Object.create(a.prototype),s=new L(n||[]);return o._invoke=function(e,r,t){var n=u;return function(a,o){if(n===A)throw new Error("Generator is already running");if(n===d){if("throw"===a)throw o;return O()}for(t.method=a,t.arg=o;;){var s=t.delegate;if(s){var i=_(s,t);if(i){if(i===f)continue;return i}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(n===u)throw n=d,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n=A;var c=l(e,r,t);if("normal"===c.type){if(n=t.done?d:m,c.arg===f)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(n=d,t.method="throw",t.arg=c.arg)}}}(e,t,s),o}function l(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(e){return{type:"throw",arg:e}}}e.wrap=g;var u="suspendedStart",m="suspendedYield",A="executing",d="completed",f={};function h(){}function p(){}function v(){}var b={};b[o]=function(){return this};var x=Object.getPrototypeOf,w=x&&x(x(T([])));w&&w!==t&&n.call(w,o)&&(b=w);var y=v.prototype=h.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(r){c(e,r,(function(e){return this._invoke(r,e)}))}))}function E(e,r){function t(a,o,s,i){var c=l(e[a],e,o);if("throw"!==c.type){var g=c.arg,u=g.value;return u&&"object"==typeof u&&n.call(u,"__await")?r.resolve(u.__await).then((function(e){t("next",e,s,i)}),(function(e){t("throw",e,s,i)})):r.resolve(u).then((function(e){g.value=e,s(g)}),(function(e){return t("throw",e,s,i)}))}i(c.arg)}var a;this._invoke=function(e,n){function o(){return new r((function(r,a){t(e,n,r,a)}))}return a=a?a.then(o,o):o()}}function _(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,_(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var a=l(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function k(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function I(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function t(){for(;++a<e.length;)if(n.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=r,t.done=!0,t};return s.next=s}}return{next:O}}function O(){return{value:r,done:!0}}return p.prototype=y.constructor=v,v.constructor=p,p.displayName=c(v,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===p||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},S(E.prototype),E.prototype[s]=function(){return this},e.AsyncIterator=E,e.async=function(r,t,n,a,o){void 0===o&&(o=Promise);var s=new E(g(r,t,n,a),o);return e.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(y),c(y,i,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var r=[];for(var t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(n,a){return i.type="throw",i.arg=e,t.next=n,a&&(t.method="next",t.arg=r),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),g=n.call(s,"finallyLoc");if(c&&g){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!g)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=r,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),f},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),I(t),f}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var a=n.arg;I(t)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),f}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},9416:(e,r,t)=>{"use strict";r.browser=t(3150)},3150:function(e,r){var t,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(n="function"==typeof(t=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const r="The message port closed before a response was received.",t="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(e,r){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const o=(r,t)=>(...n)=>{e.runtime.lastError?r.reject(e.runtime.lastError):t.singleCallbackArg||n.length<=1&&!1!==t.singleCallbackArg?r.resolve(n[0]):r.resolve(n)},s=e=>1==e?"argument":"arguments",i=(e,r,t)=>new Proxy(r,{apply:(r,n,a)=>t.call(n,e,...a)});let c=Function.call.bind(Object.prototype.hasOwnProperty);const g=(e,r={},t={})=>{let n=Object.create(null),a={has:(r,t)=>t in e||t in n,get(a,l,u){if(l in n)return n[l];if(!(l in e))return;let m=e[l];if("function"==typeof m)if("function"==typeof r[l])m=i(e,e[l],r[l]);else if(c(t,l)){let r=((e,r)=>function(t,...n){if(n.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${s(r.minArgs)} for ${e}(), got ${n.length}`);if(n.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${s(r.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((a,s)=>{if(r.fallbackToNoCallback)try{t[e](...n,o({resolve:a,reject:s},r))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),t[e](...n),r.fallbackToNoCallback=!1,r.noCallback=!0,a()}else r.noCallback?(t[e](...n),a()):t[e](...n,o({resolve:a,reject:s},r))}))})(l,t[l]);m=i(e,e[l],r)}else m=m.bind(e);else if("object"==typeof m&&null!==m&&(c(r,l)||c(t,l)))m=g(m,r[l],t[l]);else{if(!c(t,"*"))return Object.defineProperty(n,l,{configurable:!0,enumerable:!0,get:()=>e[l],set(r){e[l]=r}}),m;m=g(m,r[l],t["*"])}return n[l]=m,m},set:(r,t,a,o)=>(t in n?n[t]=a:e[t]=a,!0),defineProperty:(e,r,t)=>Reflect.defineProperty(n,r,t),deleteProperty:(e,r)=>Reflect.deleteProperty(n,r)},l=Object.create(e);return new Proxy(l,a)},l=e=>({addListener(r,t,...n){r.addListener(e.get(t),...n)},hasListener:(r,t)=>r.hasListener(e.get(t)),removeListener(r,t){r.removeListener(e.get(t))}});let u=!1;const m=new a((e=>"function"!=typeof e?e:function(r,n,a){let o,s,i=!1,c=new Promise((e=>{o=function(r){u||(console.warn(t,(new Error).stack),u=!0),i=!0,e(r)}}));try{s=e(r,n,o)}catch(e){s=Promise.reject(e)}const g=!0!==s&&((l=s)&&"object"==typeof l&&"function"==typeof l.then);var l;if(!0!==s&&!g&&!i)return!1;return(g?s:c).then((e=>{a(e)}),(e=>{let r;r=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",a({__mozWebExtensionPolyfillReject__:!0,message:r})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),A=({reject:t,resolve:n},a)=>{e.runtime.lastError?e.runtime.lastError.message===r?n():t(e.runtime.lastError):a&&a.__mozWebExtensionPolyfillReject__?t(new Error(a.message)):n(a)},d=(e,r,t,...n)=>{if(n.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${s(r.minArgs)} for ${e}(), got ${n.length}`);if(n.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${s(r.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,r)=>{const a=A.bind(null,{resolve:e,reject:r});n.push(a),t.sendMessage(...n)}))},f={runtime:{onMessage:l(m),onMessageExternal:l(m),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},h={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":h},services:{"*":h},websites:{"*":h}},g(e,f,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=browser})?t.apply(r,[e]):t)||(e.exports=n)}},r={};function t(n){var a=r[n];if(void 0!==a)return a.exports;var o=r[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{"use strict";function e(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function r(e,r,t,n,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void t(e)}i.done?r(c):Promise.resolve(c).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var s=e.apply(t,n);function i(e){r(s,a,o,i,c,"next",e)}function c(e){r(s,a,o,i,c,"throw",e)}i(void 0)}))}}var a,o,s=t(7757),i=t.n(s),c=t(9416),g="",l=void 0,u={5:2e3,4:4e3,3:8e3,2:16e3,1:32e3},m="https://cashback-api-staging.operacdn.com/api/public/v8",A="https://cashback-api-production.operacdn.com/api/public/v8",d=function(e){return new Promise((function(r){return setTimeout(r,e)}))},f=!1,h=function(e){return{avgPaymentTime:e.others.avgPaymentTime,avgTransactionRecognitionTime:0,cashbackTerms:e.texts.cashbackTerms,categories:e.others.categories||[],domains:e.basic.domains||[],isFeatured:e.others.isFeatured,maxCashbackNormal:e.others.maxCashbackNormal,previousMaxCashbackNormal:e.others.previousMaxCashbackNormal,floatRateNormal:e.others.floatRateNormal,merchantLogoUrl:e.basic.merchantLogoUrl,merchantLogoId:e.basic.merchantLogoId,merchantName:e.texts.merchantName,offerCountry:e.targeting.countries.toString(),offerId:e.offerId,offerLongDesc:e.texts.offerLongDesc,priority:e.targeting.priority,searchPhrase:e.texts.searchPhrase,showAsAction:e.others.showAsAction,socialProof:e.others.socialProof,validToTimestamp:e.others.validToTimestamp,activationAvailableThroughTheSiteOnly:void 0!==e.others.activationAvailableThroughTheSiteOnly&&e.others.activationAvailableThroughTheSiteOnly,activeIconVisitingShopSite:void 0===e.others.activeIconVisitingShopSite||e.others.activeIconVisitingShopSite,allowedSubdomains:void 0===e.others.allowedSubdomains?[]:e.others.allowedSubdomains,forbiddenSubdomains:void 0===e.others.forbiddenSubdomains?[]:e.others.forbiddenSubdomains,showInShopList:void 0===e.others.showInShopList||e.others.showInShopList,showPopupActivateCb:void 0===e.others.showPopupActivateCb||e.others.showPopupActivateCb,showPopupCbActivated:void 0===e.others.showPopupCbActivated||e.others.showPopupCbActivated}},p=function(){var e=n(i().mark((function e(){var r,t=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:5,!a){e.next=5;break}return e.abrupt("return",a);case 5:return a=fetch("".concat(f?m:A,"/offers?size=2000&country=").concat(localStorage.country,"&lang=").concat(localStorage.language,"&source=ext.").concat(g)).then((function(e){return e.json()})).then((function(e){a=null;var r=e.content;return l=r.map(h)})).catch(n(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>0)){e.next=7;break}return e.next=3,d(u[r]);case 3:return a=null,e.abrupt("return",p(r-1));case 7:return e.abrupt("return",l||[]);case 8:case"end":return e.stop()}}),e)})))),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=n(i().mark((function e(){var r,t,n=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>0&&void 0!==n[0]&&n[0],t=n.length>1&&void 0!==n[1]&&n[1],f=r,void 0!==l&&!t){e.next=6;break}return e.next=6,p();case 6:return e.abrupt("return",l);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();setInterval(p,144e5),function(e){e.ACTIVATE_CASHBACK="ACTIVATE_CASHBACK",e.FETCH_OFFER_DATA="FETCH_OFFER_DATA",e.OFFER_DATA="OFFER_DATA",e.SEND_STATS="SEND_STATS",e.MARK_CLOSED="MARK_CLOSED",e.SETTINGS_FOR_PAGE="SETTINGS_FOR_PAGE",e.GET_VERSION="GET_VERSION",e.VERSION="VERSION",e.SET_LANGUAGE="SET_LANGUAGE",e.SET_STAGING="SET_STAGING"}(o||(o={}));const b=36e5;var x=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?"https://cashback.op-test.net/":"https://cashback.opera.com/"},w=function(){var e=window.chrome,r=window.navigator,t=r.userAgent.toLowerCase(),n=r.vendor,a=void 0!==window.opr,o=t.indexOf("firefox")>-1,s=t.indexOf("safari")>-1,i=t.indexOf("edge")>-1;if(t.match("crios"));else{if(null!=e&&"Google Inc."===n&&!1===a&&!1===i)return"Chrome";if(a)return"Opera";if(o)return"Firefox";if(s)return"Safari"}return"Other"};function y(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function S(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){e(r,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))}))}return r}var E,_=c.browser.runtime.getManifest();E=_.version,g=E;var k,I=window.opr;!function(e){e.NEUTRAL="Neutral",e.AVAILABLE="Available",e.AVAILABLE_RED="Available_Red",e.AVAILABLE_YELLOW="Available_Yellow",e.ACTIVE="Active"}(k||(k={}));var L,T,O,P,C=!1,N={},R=function(e){var r,t,n,a,o=new XMLHttpRequest,s=Object.entries({v:1,tid:"UA-4118503-44",cid:O||"489017553.1621508293",ds:"extension",t:"event",ec:e.category,ea:e.action,el:e.label,ev:e.value}).filter((function(e){return void 0!==e[1]})).map((function(e){return e[0]+"="+encodeURIComponent(e[1])})).join("&");o.open("POST","https://www.google-analytics.com/collect",!0),o.send(s),I&&I.statsPrivate&&I.statsPrivate.recordSessionEvent("feature_events.event_cashback",JSON.stringify({action:"cashback_extension."+e.action.replace(/ |\(|\)/g,"_"),details:{category:e.category.toString(),label:null===(n=e.label)||void 0===n?void 0:n.toString(),value:null===(a=e.value)||void 0===a?void 0:a.toString()}}),I.statsPrivate.Priority.NORMAL);var i,c,g,l=window.navigator.language.substr(0,2).toUpperCase();fetch("https://cashback.opera.com/api/osp",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({action:e.action.replace(/ |\(|\)/g,"_"),application:"extension",browser:w(),browser_version:"Opera"===w()?(navigator.userAgent.match(/OPR\/([0-9\.]+)/)||[null,"Unknown"])[1]:"",declared_country:null,details:{category:e.category.toString(),label:null===(r=e.label)||void 0===r?void 0:r.toString(),value:null===(t=e.value)||void 0===t?void 0:t.toString()},device_type:"desktop",language:l,OS:(i=window.navigator.userAgent,c=window.navigator.platform,g="",-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(c)?g="Mac OS":-1!==["iPhone","iPad","iPod"].indexOf(c)?g="iOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(c)?g="Windows":/Android/.test(i)?g="Android":!g&&/Linux/.test(c)&&(g="Linux"),g),user_recorded_timestamp:Date.now()})})},j=function(e,r,t){var n=new URL(r).hostname.split(".").slice(-e.split(".").length).join(".")===e;return t.forEach((function(e){return n=n&&-1===r.indexOf(e)})),n},D=function(){var e=n(i().mark((function e(r){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(C);case 2:return t=e.sent,n=(null==t?void 0:t.filter((function(e){return e.domains.map((function(t){return j(t,r,e.forbiddenSubdomains||[])})).reduce((function(e,r){return r||e}))})))||[],e.abrupt("return",{offer:n,allOffers:t,url:r});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),F=function(e,r){localStorage.country===e&&localStorage.language===r||(localStorage.country=e,localStorage.language=r,v(C,!0))},B=function(){return window.matchMedia("(prefers-color-scheme: dark)").matches},M=function e(r,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;clearTimeout(P),t===k.AVAILABLE&&(n.length>0&&!n[0].activeIconVisitingShopSite?t=k.NEUTRAL:(a=10,t=k.AVAILABLE_RED)),c.browser.pageAction.setIcon({tabId:r,path:{32:"icons/32/Icon_".concat(B()?"Dark":"Light","_").concat(t,".png")}}).catch(console.log),a>0&&(P=setTimeout((function(){return e(r,t===k.AVAILABLE_RED?k.AVAILABLE_YELLOW:k.AVAILABLE_RED,n,a-1)}),350))},G=function(){var e=n(i().mark((function e(r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.browser.tabs.executeScript(r,{code:"[window.____dify_cashback_injected,window.____dify_cashback_injected=true]"}).then((function(e){return e&&e[0][0]})).catch(console.log));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),V=function(e,r){if(r&&r.startsWith("http")){var t=new URL(r);t.hostname.indexOf("cashback.opera.com")>-1||t.hostname.indexOf("getdify.com")>-1||t.hostname.indexOf("localhost")>-1?G(e).then((function(r){r||c.browser.tabs.executeScript(e,{runAt:"document_start",file:"./content_getdify.js"}).catch(console.log)})):D(r).then((function(t){var n,a,o,s=t.offer,i=t.allOffers;if(o=Date.now(),n=function(e){return e.expire<o},a=!1,Object.keys(L).forEach((function(e){n(L[e])&&(a=!0,delete L[e])})),a&&c.browser.storage.local.set({visitedCashbackList:L}),$(s,r,i||[],e),s.length){var g=!1;s.forEach((function(e){var r=L[e.offerId];r&&r.expire>Date.now()&&(g=!0,L[e.offerId]=S(S({},r||{}),{},{first_visited:!0}))}));var l=function(){M(e,g?k.ACTIVE:k.AVAILABLE,s)};I&&I.cashbackPrivate?c.browser.tabs.query({currentWindow:!0,active:!0}).then((function(r){r[0]&&I.cashbackPrivate.getCashbackBadgeState(r[0].windowId,(function(r){var t=!0;switch(r){case I.cashbackPrivate.BadgeState.IDLE:case I.cashbackPrivate.BadgeState.WARNING:t=!1;case I.cashbackPrivate.BadgeState.ACTIVE:M(e,t?k.ACTIVE:k.AVAILABLE,s);break;case I.cashbackPrivate.BadgeState.DISABLED:l()}}))})):l(),G(e).then((function(r){r||(c.browser.tabs.executeScript(e,{runAt:"document_start",code:'window.____dify_cashback_language="'.concat(localStorage.language,'";window.____dify_cashback_country="').concat(localStorage.country,'"')}).catch(console.log),c.browser.tabs.executeScript(e,{runAt:"document_start",file:"./content.js"}).catch(console.log))}))}else M(e,k.NEUTRAL,[])}))}},U=function(e,r){void 0!==r?c.browser.tabs.sendMessage(r,e).catch(console.log):c.browser.runtime.sendMessage(e).catch(console.log)},W=function(e){return(L[e.offerId]||{expire:0}).expire},q=function(e){void 0!==e?c.browser.tabs.get(e).then((function(r){D(r.url).then((function(r){var t=r.offer,n=r.allOffers,a=r.url;$(t,a,n||[],e)}))})):c.browser.tabs.query({currentWindow:!0,active:!0}).then((function(e){e[0]&&D(e[0].url).then((function(e){var r=e.offer,t=e.allOffers,n=e.url;$(r,n,t||[])}))}))},$=function(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,a=e.length&&e.sort((function(e,r){return W(e)<W(r)?1:-1})).find((function(e){return L[e.offerId]})),s=n&&N[n]?N[n].urls:[],i=function(i){U({type:o.OFFER_DATA,data:{offer:e.length&&e[0],allOffers:t,theme:B()?"dark":"light",activated:a&&L[a.offerId],settingsForPage:e.length&&T[e[0].offerId]||{},isActivated:i,url:r,staging:C,redirs:s}},n)},g=function(){i(!!a&&L[a.offerId].expire>Date.now())};I&&I.cashbackPrivate?c.browser.tabs.query({currentWindow:!0,active:!0}).then((function(e){e[0]&&I.cashbackPrivate.getCashbackBadgeState(e[0].windowId,(function(e){var r=!0;switch(e){case I.cashbackPrivate.BadgeState.IDLE:case I.cashbackPrivate.BadgeState.WARNING:r=!1;case I.cashbackPrivate.BadgeState.ACTIVE:i(r);break;case I.cashbackPrivate.BadgeState.DISABLED:g()}}))})):g()};c.browser.storage.local.get().then((function(e){var r,t;L=e.visitedCashbackList||{},T=e.pageSettings||{},O=e.uniqueID,C=e.staging,O||(O=(1e7.toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})),c.browser.storage.local.set({uniqueID:O}),R({category:"Click",action:"New Extension Installation"}),c.browser.tabs.create({url:"".concat(x(C),"?extensionInstalled=1&cid=").concat(encodeURIComponent(O))})),localStorage.country||F("es",navigator.language.replace(/-.*/,"")),v(C),c.browser.runtime.onMessage.addListener((function(e,n){var a,s,i;switch(e.type){case o.FETCH_OFFER_DATA:q(null===(a=n.tab)||void 0===a?void 0:a.id);break;case o.SET_STAGING:C=e.data.value,c.browser.storage.local.set({staging:C}),location.reload();break;case o.ACTIVATE_CASHBACK:v(C).then((function(r){var t,a=e.data.offerId,o=L[a],s=null==r?void 0:r.find((function(e){return e.offerId===a}));L[a]=S(S({},o||{}),{},{expire:Date.now()+b,domains:null==s?void 0:s.domains,tabId:null===(t=n.tab)||void 0===t?void 0:t.id,closed_till:void 0,first_visited:!1}),c.browser.storage.local.set({visitedCashbackList:L})}));break;case o.MARK_CLOSED:r=e.data.offerId,t=L[r],L[r]=S(S({},t||{}),{},{closed_till:Date.now()+18e5}),c.browser.storage.local.set({visitedCashbackList:L});break;case o.SETTINGS_FOR_PAGE:var g=e.data,l=T[g.offerId];for(var u in T[g.offerId]=S({},l||{}),g)"offerId"!==u&&("dont_open_again_today"===u&&(g.dont_open_again_today||0)>0?T[g.offerId].dont_open_again_today=Date.now()+864e5:T[g.offerId][u]=g[u]);c.browser.storage.local.set({pageSettings:T}),q(null===(s=n.tab)||void 0===s?void 0:s.id);break;case o.SEND_STATS:R(S({},e.data));break;case o.GET_VERSION:U({type:o.VERSION,data:{version:_.version}},null===(i=n.tab)||void 0===i?void 0:i.id);break;case o.SET_LANGUAGE:var m=e.data;F(m.country,m.language)}})),c.browser.tabs.onCreated.addListener((function(e){e.id&&(c.browser.pageAction.show(e.id),V(e.id,e.url))})),c.browser.tabs.onUpdated.addListener((function(e,r,t){c.browser.pageAction.show(e),V(e,t.url)})),c.browser.tabs.onActivated.addListener((function(e){c.browser.pageAction.show(e.tabId),c.browser.tabs.get(e.tabId).then((function(r){V(e.tabId,r.url)}))})),c.browser.runtime.setUninstallURL("".concat(x(C),"?extensionUninstalled=1&cid=").concat(encodeURIComponent(O))),c.browser.tabs.query({currentWindow:!0,active:!0}).then((function(e){e[0]&&c.browser.pageAction.show(e[0].id||0)})),c.browser.webRequest.onHeadersReceived.addListener((function(e){N[e.tabId]&&N[e.tabId].requestId===e.requestId?N[e.tabId].urls.push(e.url):N[e.tabId]={urls:[e.url],requestId:e.requestId}}),{urls:["*://*/*"],types:["main_frame"]})})),c.browser.runtime.onMessageExternal.addListener((function(e,r){switch(e.type){case o.ACTIVATE_CASHBACK:v(C).then((function(t){var n,a=e.data.offerId,o=L[a],s=null==t?void 0:t.find((function(e){return e.offerId===a}));L[a]=S(S({},o||{}),{},{expire:Date.now()+b,domains:null==s?void 0:s.domains,forbiddenSubdomains:(null==s?void 0:s.forbiddenSubdomains)||[],tabId:null===(n=r.tab)||void 0===n?void 0:n.id,closed_till:void 0,first_visited:!1}),c.browser.storage.local.set({visitedCashbackList:L})}));break;case o.GET_VERSION:return Promise.resolve({type:o.VERSION,data:{version:_.version}});case o.SET_LANGUAGE:var t=e.data;F(t.country,t.language)}}))})()})();