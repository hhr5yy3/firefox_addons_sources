"use strict";(self.webpackChunk_dashlane_leeloo=self.webpackChunk_dashlane_leeloo||[]).push([[6429],{49087:(e,t,a)=>{a.d(t,{B:()=>n});var i=a(96832);const n=()=>{const[e,t]=i.useState(""),[a,n]=i.useState(!1),r=()=>{n(!1)};return i.useEffect((()=>{if(!a)return;const e=setTimeout(r,5e3);return()=>clearTimeout(e)}),[a,e]),{isAlertVisible:a,alertMessage:e,setAlertMessage:t,hide:r,show:()=>{n(!0)}}}},6429:(e,t,a)=>{a.r(t),a.d(t,{PaymentCardEditPanel:()=>x});var i=a(96832),n=a(26849),r=a(14900),l=a(48062),o=a(25792),d=a(39431),s=a(8180),c=a(24507),_=a(78346),p=a(86498),m=a(88203),u=a(92077),y=a(45272),h=a(76376),b=a(12271),C=a(77257),g=a(49087),f=a(31605),w=a(63520),S=a(82994),v=a(30894),D=a(61468),N=a(68593);const Z=({item:e})=>{const{translate:t}=(0,m.Z)(),{routes:a}=(0,h.Xo)(),c=(0,p.V)(),Z=(0,g.B)(),{protectedItemsUnlockerShown:x}=(0,v.tY)(),{updateVaultItem:A}=(0,s.u)(o.L),[I,L]=i.useState(!1),[V,k]=i.useState(!1),[T,E]=i.useState(),[B,O]=i.useState(!1),[R,G]=i.useState(e);i.useEffect((()=>{(0,y.Nc)(l.PageView.ItemCreditCardDetails)}),[]);const P=()=>{c.showAlert(t("_common_generic_error"),r.BLW.ERROR)},U=()=>{(0,y.Nc)(l.PageView.ItemPaymentList),(0,u.uX)(a.userPayments)},X=e.itemName||t("payments_header_add_payment_card"),$=t("webapp_payment_edition_delete_text"),M={confirmDeleteConfirm:t("webapp_payment_edition_delete_confirm"),confirmDeleteDismiss:t("webapp_payment_edition_delete_dismiss"),confirmDeleteSubtitle:$,confirmDeleteTitle:t("webapp_payment_edition_delete_header"),deleteSuccessToast:e.itemName?t("webapp_payment_edition_name_delete_alert",{paymentCard:e.itemName}):t("webapp_payment_edition_generic_delete_alert")};return(0,N.BX)(w.zI,{isUsingNewDesign:!0,isViewingExistingItem:!0,itemHasBeenEdited:I,onNavigateOut:U,onSubmit:async()=>{if(V)return;const a=(0,b.u)(R);if(!a.isValid)return E(a.errorSet);k(!0);try{const a=await A({vaultItemType:d.U.PaymentCard,content:R,id:e.id});if((0,_.d6)(a)){const e=R.itemName?t("webapp_payment_edition_name_update_alert",{paymentCard:R.itemName}):t("webapp_payment_edition_generic_update_alert");c.showAlert(e,r.BLW.SUCCESS),U()}else k(!1),P()}catch(e){k(!1),P()}},onClickDelete:()=>O(!0),ignoreCloseOnEscape:B||x,formId:"edit_paymentcard_panel",header:(0,N.tZ)(w.V9,{icon:(0,N.tZ)(D.AK,{type:"payment-card",size:"xlarge",legacyColor:(0,C.Z)(R.color)}),title:X}),children:[(0,N.tZ)(b.gd,{itemId:e.id,errors:T,paymentCardContent:R,onValueChanged:t=>{G((a=>{const i={...a,...t};return L(!(0,n.equals)(i,e)),i}))},showCopyAlert:e=>{Z.setAlertMessage(e),Z.show()},variant:"edit"}),(0,N.tZ)(S.s,{isVisible:B,itemId:e.id,closeConfirmDeleteDialog:()=>O(!1),onDeletionSuccess:U,translations:M,vaultItemType:d.U.PaymentCard}),Z.isAlertVisible&&(0,N.tZ)("div",{className:f.Z.alertWrapper,children:(0,N.tZ)(r.bZj,{size:r.k3y.SMALL,severity:r.BLW.SUCCESS,closeIconName:t("_common_alert_dismiss_button"),onClose:()=>{Z.hide()},children:Z.alertMessage})})]})},x=({match:e})=>{const{data:t}=(0,c.k)(o.L,"query",{vaultItemTypes:[d.U.PaymentCard],ids:[`{${e.params.uuid}}`]});return t?.paymentCardsResult.items.length?(0,N.tZ)(Z,{item:t.paymentCardsResult.items[0]}):null}},12271:(e,t,a)=>{a.d(t,{gd:()=>I,u:()=>L});var i=a(96832),n=a(53214),r=a(48062),l=a(61468),o=a(88203),d=a(45272),s=a(77063),c=a(82207),_=a(30894),p=a(68819),m=a(67406),u=a(68037),y=a(7973),h=a(711),b=a(68593);const C=(([e,t],a="ASC")=>{const i=(new Date).getFullYear()+e,n=Math.abs(t-e)+1,r=new Array(n).fill(null).map(((e,t)=>({label:(i+t).toString(),value:i+t})));return"ASC"===a?r:r.sort((({value:e},{value:t})=>t-e))})([0,30],"ASC"),g=e=>(0,y.Z)((0,h.Z)(new Date,e),"MM"),f=new Array(12).fill(null).map(((e,t)=>g(t))).map((e=>(0,b.tZ)(l.$m,{value:e,children:e},e))),w=C.map((e=>(0,b.tZ)(l.$m,{value:JSON.stringify(e.value),children:e.label},e.value))),S=({month:e,year:t,disabled:a,onYearChange:i,onMonthChange:n})=>{const{translate:r}=(0,o.Z)();return(0,b.BX)(l.kC,{gap:"8px",children:[(0,b.tZ)(l.mg,{"data-name":"card-expiration-month",label:r("webapp_field_expiry_date_month"),value:g(Number(e)-1),onChange:e=>{n(e)},readOnly:a,sx:{flex:1},children:f}),(0,b.tZ)(l.mg,{"data-name":"card-expiration-year",label:r("webapp_field_expiry_date_year"),value:t,onChange:e=>{i(e)},readOnly:a,sx:{flex:1},children:w})]})};var v=a(79432);const D="webapp_payment_edition_field_card_action_show_note",N="webapp_payment_edition_field_card_action_hide_note",Z="webapp_payment_edition_field_cardColor_",x=e=>t=>{t&&(0,d.Kz)(new r.UserCopyVaultItemFieldEvent({itemType:r.ItemType.CreditCard,field:e,itemId:t,isProtected:!0}))},A={[n.X.Black]:`${Z}BLACK`,[n.X.Blue1]:`${Z}BLUE_1`,[n.X.Blue2]:`${Z}BLUE_2`,[n.X.Gold]:`${Z}GOLD`,[n.X.Green1]:`${Z}GREEN_1`,[n.X.Green2]:`${Z}GREEN_2`,[n.X.Orange]:`${Z}ORANGE`,[n.X.Red]:`${Z}RED`,[n.X.Silver]:`${Z}SILVER`,[n.X.White]:`${Z}WHITE`},I=({itemId:e,errors:t,paymentCardContent:a,onValueChanged:y,showCopyAlert:h,variant:C})=>{const{cardNumber:g,color:f,expireMonth:w,expireYear:Z,itemName:I,note:L,ownerName:V,securityCode:k="",spaceId:T}=a,{translate:E}=(0,o.Z)(),{shouldShowFrozenStateDialog:B}=(0,s.Ub)(),{logRevealCreditCardField:O,logCopiedCreditCardField:R}=(0,v.D)(),G=Boolean(g.length),P=Boolean(k.length),U=Boolean(L.length),X=Boolean(T),$=(0,i.useCallback)((e=>t=>{const a="string"==typeof t?t:t.target.value,i="cardNumber"===e?a.replaceAll(" ",""):a;y({[e]:i})}),[y]),{areProtectedItemsUnlocked:M,openProtectedItemsUnlocker:F}=(0,_.tY)(),[q,z]=(0,i.useState)(!G),W=(0,i.useCallback)((t=>{e&&(0,d.Kz)(new r.UserRevealVaultItemFieldEvent({field:t,isProtected:!0,itemId:e,itemType:r.ItemType.CreditCard}))}),[e]),Y=(0,i.useCallback)(((e,t)=>new Promise(((a,i)=>{if(e||M)return t(),a();F({action:p.P.Show,itemType:p.R.CreditCard,successCallback:()=>(t(),a()),cancelCallback:i})}))),[M,F]),H=(0,i.useCallback)((()=>{q||(W(r.Field.CardNumber),X&&O({field:"number",name:I})),z((e=>!e))}),[q,W,X,O,I]),K=!M,j=(t,a)=>{t(e),h&&h(E(a))},[J,Q]=(0,i.useState)(""===k),[ee,te]=(0,i.useState)(""===L),ae=(0,i.useCallback)((()=>{J||(W(r.Field.SecurityCode),X&&O({field:"cvv",name:I})),Q((e=>!e))}),[J,W,X,O,I]),ie=()=>te((e=>!e)),ne=Object.values(n.X).map((e=>({label:E(A[e]),value:e}))),re=G?q?g:"●●●● ●●●● ●●●● ●●●●":"";return(0,b.BX)("div",{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,b.BX)(u.u,{title:E("webapp_payment_edition_content_card_details_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,b.tZ)(l.qo,{"data-name":"ownerName",value:V,label:E("webapp_payment_edition_field_ownerName"),placeholder:E("webapp_payment_edition_field_placeholder_no_ownerName"),onChange:$("ownerName"),disabled:!!B}),(0,b.tZ)(l.Nc,{"data-name":"cardNumber",required:!0,formatter:q?"card":void 0,label:E("webapp_payment_edition_field_cardNumber"),placeholder:E("webapp_payment_edition_field_placeholder_no_cardNumber"),isValueInitiallyVisible:q,toggleVisibilityLabel:{hide:E("webapp_payment_edition_field_card_action_hide_card_number"),show:E("webapp_payment_edition_field_card_action_show_card_number")},onValueVisibilityChangeRequest:()=>Y(q,H),onCopy:e=>{e.preventDefault(),navigator.clipboard.writeText(re),X&&R({field:"number",name:I})},readOnly:!q&&G||!!B,value:re,actions:"edit"===C?[(0,b.tZ)(c.m,{data:g,checkProtected:()=>K,copyLabel:E("webapp_payment_edition_field_card_action_copy_card_number"),onCopy:()=>{j(x(r.Field.CardNumber),"webapp_payment_edition_field_cardNumber_copied"),X&&R({field:"number",name:I})}},"copy-card-number")]:void 0,onChange:$("cardNumber"),error:t?.has("cardNumber")},`cardNumber${q}`),(0,b.tZ)(l.Nc,{readOnly:!J&&P||!!B,value:J?k:"●●●",label:E("webapp_payment_edition_field_securityCode"),placeholder:E("webapp_payment_edition_field_placeholder_no_securityCode"),onValueVisibilityChangeRequest:()=>Y(J,ae),isValueInitiallyVisible:J,toggleVisibilityLabel:{hide:E("webapp_payment_edition_field_card_action_hide_security_code"),show:E("webapp_payment_edition_field_card_action_show_security_code")},actions:"edit"===C?[(0,b.tZ)(c.m,{checkProtected:()=>K,data:k,copyLabel:E("webapp_payment_edition_field_card_action_copy_security_code"),onCopy:()=>{j(x(r.Field.CardNumber),"webapp_payment_edition_field_securityCode_copied"),X&&R({field:"cvv",name:I})}},"copy-security-code")]:void 0,onChange:$("securityCode"),error:t?.has("securityCode")},`securityCode${J}`),(0,b.tZ)(S,{month:w,year:Z,onYearChange:$("expireYear"),onMonthChange:$("expireMonth")}),(0,b.tZ)(l.Kx,{sx:{"textarea, .readOnlyMask":{variant:"text.ds.body.standard.monospace"}},label:E("webapp_payment_edition_field_notes"),placeholder:E("webapp_payment_edition_field_placeholder_no_notes"),"data-name":"note",readOnly:!ee&&U||!!B,value:ee||!U?L:"••••",onChange:$("note"),actions:[(0,b.tZ)(l.zx,{layout:"iconOnly",icon:ee?"ActionHideOutlined":"ActionRevealOutlined",mood:"brand",intensity:"supershy",sx:{marginRight:"16px"},onClick:()=>{Y(ee,ie).catch((()=>{te(!1)}))},"aria-label":E(ee?N:D),tooltip:E(ee?N:D)},"card-note-visibility"),..."edit"===C?[(0,b.tZ)(c.m,{data:L,checkProtected:()=>K,copyLabel:E("webapp_payment_edition_field_card_action_copy_note"),onCopy:()=>j(x(r.Field.Note),"webapp_payment_edition_field_notes_copied"),itemType:p.R.CreditCard,tooltipLocation:"right"},"copy-note")]:[]],"data-testid":"credential_edit_note_value"})]}),(0,b.BX)(u.u,{title:E("webapp_payment_edition_content_card_organization_label"),additionalSx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,b.tZ)(l.qo,{value:I,label:E("webapp_payment_edition_field_cardname"),placeholder:E("webapp_payment_edition_field_placeholder_no_cardname"),onChange:$("itemName"),disabled:!!B},"cardname"),(0,b.tZ)(l.mg,{label:E("webapp_payment_edition_field_cardColor"),placeholder:E(A[f]),value:f,onChange:$("color"),disabled:!!B,children:ne.map((e=>(0,b.tZ)(l.$m,{value:e.value,children:e.label},e.value)))},`cardColor${f}`),(0,b.tZ)(m.M,{isUsingNewDesign:!0,spaceId:null!=T?T:"",labelSx:m.e,onChange:e=>$("spaceId")(e),disabled:!!B})]})]})},L=e=>{const t=new Set;return e.cardNumber&&0!==e.cardNumber.length||t.add("cardNumber"),t.size>0?{isValid:!1,errorSet:t}:{isValid:!0}}},82994:(e,t,a)=>{a.d(t,{s:()=>u}),a(96832);var i=a(61468),n=a(8180),r=a(51031),l=a(25792),o=a(88203);let d=function(e){return e.LastAdmin="LastAdmin",e.GroupSharing="GroupSharing",e.CollectionSharing="CollectionSharing",e.Generic="Generic",e}({});var s=a(65580),c=a(68593);const _=({reason:e,translations:t,goToSharingAccess:a,closeCantDeleteDialog:n})=>{const{translate:r}=(0,o.Z)(),l=((e,t)=>{const{groupSharingTitle:a,lastAdminTitle:i,collectionSharingTitle:n,genericErrorTitle:r}=e;switch(t){case d.LastAdmin:return i;case d.GroupSharing:return a;case d.CollectionSharing:return n;case d.Generic:return r;default:return(0,s.U)(t)}})(t,e),_=((e,t)=>{const{groupSharingSubtitle:a,lastAdminSubtitle:i,collectionSharingSubtitle:n,genericErrorSubtitle:r}=e;switch(t){case d.LastAdmin:return i;case d.GroupSharing:return a;case d.CollectionSharing:return n;case d.Generic:return r;default:return(0,s.U)(t)}})(t,e);return(0,c.tZ)(i.Vq,{isOpen:!0,onClose:n,title:null!=l?l:"",closeActionLabel:r("_common_dialog_dismiss_button"),actions:e===d.LastAdmin||d.GroupSharing||d.CollectionSharing?{primary:{children:t.lastAdminActionLabel,onClick:()=>{a(),n()}}}:void 0,children:_})};var p=a(37527);const m=({closeConfirmDeleteDialog:e,onDeleteConfirm:t,translations:a})=>{const{translate:n}=(0,o.Z)(),{confirmDeleteSubtitle:r,confirmDeleteTitle:l,confirmDeleteDismiss:d,confirmDeleteConfirm:s}=a;return(0,c.tZ)(i.Vq,{title:l,onClose:e,isOpen:!0,dialogClassName:p.Ht,closeActionLabel:n("_common_dialog_dismiss_button"),isDestructive:!0,actions:{primary:{children:s,onClick:t,id:"deletion-dialog-confirm-button"},secondary:{children:d,onClick:e,autoFocus:!0,id:"deletion-dialog-dismiss-button"}},children:r})},u=({closeConfirmDeleteDialog:e,goToSharingAccess:t,isVisible:a,itemId:s,onDeletionSuccess:p,sharingStatus:u,translations:y,vaultItemType:h,isShared:b,isSharedViaUserGroup:C,isItemInCollection:g,isLastAdmin:f})=>{const{showToast:w}=(0,i.pm)(),{translate:S}=(0,o.Z)(),{deleteVaultItem:v}=(0,n.u)(l.L);if(!a)return null;let D;return(b||u?.isShared)&&(C&&(D=d.GroupSharing),f&&(D=d.LastAdmin),g&&(D=d.CollectionSharing)),D&&t?(0,c.tZ)(_,{reason:D,translations:y,goToSharingAccess:t,closeCantDeleteDialog:e}):(0,c.tZ)(m,{closeConfirmDeleteDialog:e,onDeleteConfirm:async()=>{try{var e;(await v({id:s,vaultItemType:h})).tag===r.rq.Success?(w({description:null!=(e=y.deleteSuccessToast)?e:S("webapp_personal_info_edition_delete_success_toast")}),p()):w({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}catch(e){w({description:S("_common_generic_error"),mood:"danger",isManualDismiss:!0})}},translations:y})}},31605:(e,t,a)=>{a.d(t,{Z:()=>i});const i={alertWrapper:"alertWrapper--JLZLLWrHCo"}}}]);